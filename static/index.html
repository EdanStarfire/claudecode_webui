<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code WebUI</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>Claude Code WebUI</h1>
            <div class="connection-status">
                <span id="connection-indicator" class="connection-status-indicator disconnected"></span>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <button id="sidebar-collapse-btn" class="btn btn-small btn-secondary" title="Collapse sidebar">‚Äπ</button>
                    <div class="session-controls">
                        <button id="create-project-btn" class="btn btn-primary btn-icon" title="New Project">üìÅ</button>
                        <button id="refresh-sessions-btn" class="btn btn-secondary btn-icon" title="Refresh">‚Üª</button>
                    </div>
                </div>

                <div class="session-list">
                    <h3>Projects</h3>
                    <div id="sessions-container">
                        <!-- Projects and sessions will be populated here -->
                    </div>
                </div>
                <div class="sidebar-resize-handle" id="sidebar-resize-handle"></div>
            </aside>

            <!-- Chat Area -->
            <main class="chat-area">
                <div id="no-session-selected" class="no-session">
                    <h2>No Session Selected</h2>
                    <p>Create a new session or select an existing one to start chatting with Claude Code.</p>
                </div>

                <div id="chat-container" class="chat-container hidden">
                    <!-- Session Info Bar -->
                    <div class="session-info-bar" id="session-info-bar">
                        <div class="session-details">
                            <span id="current-session-state" class="session-state-indicator"></span>
                            <span id="current-session-id" class="session-id"></span>
                            <div id="session-error-message" class="session-error-message hidden"></div>
                        </div>
                        <div class="session-actions">
                            <button id="delete-session-btn" class="btn btn-small btn-danger" title="Delete Session">üóëÔ∏è</button>
                            <button id="exit-session-btn" class="btn btn-small btn-secondary">Exit Session</button>
                        </div>
                    </div>

                    <!-- Messages Area -->
                    <div class="messages-container">
                        <div class="messages-header">
                            <button id="auto-scroll-toggle" class="btn btn-small btn-secondary auto-scroll-enabled" title="Toggle auto-scroll">
                                üìú Auto-scroll: ON
                            </button>
                        </div>
                        <div id="messages-area" class="messages-area">
                            <!-- Messages will be populated here -->
                        </div>
                    </div>

                    <!-- Input Area -->
                    <div class="input-area">
                        <!-- Progress Indicator -->
                        <div id="claude-progress" class="claude-progress hidden">
                            <div class="progress-spinner"></div>
                            <span class="progress-text">Claude Code is processing...</span>
                        </div>

                        <div class="input-container">
                            <textarea id="message-input" placeholder="Type your message to Claude Code..." rows="3"></textarea>
                            <button id="send-btn" class="btn btn-primary">Send</button>
                        </div>

                        <!-- Status Bar -->
                        <div id="status-bar" class="status-bar hidden">
                            <div class="permission-mode-clickable" id="permission-mode-clickable" title="Click to cycle modes ‚Ä¢ Requires approval for most tools">
                                <span class="permission-mode-icon" id="permission-mode-icon">üîí</span>
                                <span class="permission-mode-text" id="permission-mode-text">Mode: default</span>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Session Creation Modal -->
        <div id="create-session-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Create New Session</h2>
                    <span id="close-modal" class="close">&times;</span>
                </div>
                <form id="create-session-form">
                    <div class="form-group" id="working-directory-group">
                        <label for="working-directory">Working Directory:</label>
                        <input type="text" id="working-directory" name="working_directory">
                        <button type="button" id="browse-directory" class="btn btn-small">Browse</button>
                    </div>

                    <div class="form-group">
                        <label for="permission-mode">Permission Mode:</label>
                        <select id="permission-mode" name="permission_mode">
                            <option value="default">default</option>
                            <option value="plan">plan</option>
                            <option value="acceptEdits">acceptEdits</option>
                            <option value="bypassPermissions">bypassPermissions</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="system-prompt">System Prompt (optional):</label>
                        <textarea id="system-prompt" name="system_prompt" rows="3" placeholder="Custom system prompt for Claude Code..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="tools">Allowed Tools (comma-separated, optional):</label>
                        <input type="text" id="tools" name="tools" placeholder="bash,edit,read,write">
                    </div>

                    <div class="form-group">
                        <label for="model">Model (optional):</label>
                        <input type="text" id="model" name="model">
                    </div>

                    <div class="form-actions">
                        <button type="button" id="cancel-create" class="btn btn-secondary">Cancel</button>
                        <button type="submit" class="btn btn-primary">Create Session</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Project Creation Modal -->
        <div id="create-project-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Create New Project</h2>
                    <span id="close-project-modal" class="close">&times;</span>
                </div>
                <form id="create-project-form">
                    <div class="form-group">
                        <label for="project-name">Project Name:</label>
                        <input type="text" id="project-name" name="name" required placeholder="My Project">
                    </div>

                    <div class="form-group">
                        <label for="project-working-directory">Working Directory:</label>
                        <input type="text" id="project-working-directory" name="working_directory" required placeholder="/path/to/project">
                        <button type="button" id="browse-project-directory" class="btn btn-small">Browse</button>
                        <p class="form-hint">‚ö†Ô∏è Path is immutable after project creation</p>
                    </div>

                    <div class="form-actions">
                        <button type="button" id="cancel-create-project" class="btn btn-secondary">Cancel</button>
                        <button type="submit" class="btn btn-primary">Create Project</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Delete Session Confirmation Modal -->
        <div id="delete-session-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Delete Session</h2>
                    <span id="close-delete-modal" class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this session?</p>
                    <p><strong id="delete-session-name"></strong></p>
                    <p class="warning-text">‚ö†Ô∏è This action cannot be undone. All session data, messages, and files will be permanently deleted.</p>
                </div>
                <div class="form-actions">
                    <button type="button" id="cancel-delete" class="btn btn-secondary">Cancel</button>
                    <button type="button" id="confirm-delete" class="btn btn-danger">Delete Session</button>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="spinner"></div>
            <p>Loading...</p>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>