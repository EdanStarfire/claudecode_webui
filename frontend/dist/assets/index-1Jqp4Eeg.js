const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-BK1Vt_in.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as v,a as s,o as p,d as yt,b as y,r as D,t as w,n as Ue,e as z,f as te,u as Qt,w as ce,g as fn,h as N,F as re,i as de,j as _e,k as oo,l as ne,v as me,m as Mt,p as Ee,q as ue,s as fe,x as io,y as Ns,z as he,A as Re,B as ao,C as pi,D as fi,E as ot,G as Ot,H as vi,I as hi}from"./vue-vendor-5ZBXTGrt.js";import{m as et,p as ns}from"./markdown-vendor-BRsjnVvP.js";import{c as _i}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const gi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},bi={__name:"NoSessionSelected",setup(n){return(e,t)=>(p(),v("div",gi,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},yi="modulepreload",$i=function(n){return"/"+n},vn={},ge=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let f=function(_){return Promise.all(_.map(l=>Promise.resolve(l).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),c=r?.nonce||r?.getAttribute("nonce");i=f(t.map(_=>{if(_=$i(_),_ in vn)return;vn[_]=!0;const l=_.endsWith(".css"),$=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${$}`))return;const g=document.createElement("link");if(g.rel=l?"stylesheet":yi,l||(g.as="script"),g.crossOrigin="",g.href=_,c&&g.setAttribute("nonce",c),document.head.appendChild(g),l)return new Promise((h,b)=>{g.addEventListener("load",h),g.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${_}`)))})}))}function a(r){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=r,window.dispatchEvent(c),!c.defaultPrevented)throw r}return i.then(r=>{for(const c of r||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};class ps extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function Nt(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new ps(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof ps?t:(console.error("API request failed:",t),new ps(`Network error: ${t.message}`,0,null))}}async function wi(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[c,f]of Object.entries(e.params))f!=null&&o.append(c,f);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...r}=e;return Nt(t,{...r,method:"GET"})}return Nt(t,{...e,method:"GET"})}async function Ei(n,e,t={}){return Nt(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Ci(n,e,t={}){return Nt(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Si(n,e={}){return Nt(n,{...e,method:"DELETE"})}const oe={get:wi,post:Ei,put:Ci,delete:Si},ie=yt("session",()=>{const n=D(new Map),e=D(null),t=D(new Map),o=D(new Map),i=D(new Set),a=D(!1);let r=null;const c=y(()=>n.value.get(e.value)),f=y(()=>Array.from(n.value.values()).sort((k,A)=>k.order-A.order)),_=k=>y(()=>f.value.filter(A=>A.project_id===k)),l=y({get:()=>t.value.get(e.value)||"",set:k=>{e.value&&t.value.set(e.value,k)}});async function $(){try{const k=await oe.get("/api/sessions");return n.value.clear(),k.sessions.forEach(A=>{n.value.set(A.session_id,A)}),console.log(`Loaded ${n.value.size} sessions`),k.sessions}catch(k){throw console.error("Failed to fetch sessions:",k),k}}async function g(k,A){try{const Z=(await oe.post("/api/sessions",{project_id:k,...A})).session_id,C=(await oe.get(`/api/sessions/${Z}`)).session;return n.value.set(Z,C),n.value=new Map(n.value),console.log(`Created session ${Z}`),C}catch(B){throw console.error("Failed to create session:",B),B}}async function h(k){if(e.value===k&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${k}`),r.abort(),r=null);const A=new AbortController;r=A,a.value=!0;try{if(e.value=k,A.signal.aborted){console.log(`Selection of ${k} aborted early`);return}let B=n.value.get(k);if(!B)try{const C=await oe.get(`/api/sessions/${k}`);if(A.signal.aborted){console.log(`Selection of ${k} aborted after fetch`);return}B=C.session,n.value.set(k,B),n.value=new Map(n.value),console.log(`Fetched session ${k} for deeplink`)}catch(C){console.error(`Failed to fetch session ${k}:`,C);return}if(B&&(B.state==="created"||B.state==="terminated"))try{if(await E(k),A.signal.aborted){console.log(`Selection of ${k} aborted after start`);return}console.log(`Auto-started session ${k} (was in ${B.state} state)`);const C=6e4,T=200,L=5e3;let M=0,R=0;for(;M<C;){if(A.signal.aborted){console.log(`Selection of ${k} aborted during state wait`);return}const J=n.value.get(k);if(J&&J.state==="active"){console.log(`Session ${k} is now active after ${M}ms`);break}if(M-R>=L){const ae=n.value.get(k)?.state||"unknown";console.log(`Waiting for session ${k} to become active (current: ${ae}, ${M/1e3}s elapsed)`),R=M}await new Promise(ae=>setTimeout(ae,T)),M+=T}const H=n.value.get(k);H&&H.state!=="active"&&console.warn(`Session ${k} did not become active within ${C/1e3}s (state: ${H.state}), continuing anyway`)}catch(C){console.error(`Failed to auto-start session ${k}:`,C)}if(A.signal.aborted){console.log(`Selection of ${k} aborted before message load`);return}if(await(await ge(()=>Promise.resolve().then(()=>qi),void 0)).useMessageStore().loadMessages(k),A.signal.aborted){console.log(`Selection of ${k} aborted after message load`);return}await(await ge(()=>Promise.resolve().then(()=>ma),void 0)).useWebSocketStore().connectSession(k),A.signal.aborted||console.log(`Selected session ${k}`)}finally{r===A&&(r=null),a.value=!1}}function b(k,A){const B=n.value.get(k);B?Object.assign(B,A):(n.value.set(k,A),console.log(`Added new session ${k} via WebSocket update`)),n.value=new Map(n.value)}async function d(k){i.value.add(k);try{await oe.delete(`/api/sessions/${k}`),n.value.delete(k),t.value.delete(k),o.value.delete(k),n.value=new Map(n.value),e.value===k&&(e.value=null),console.log(`Deleted session ${k}`)}catch(A){throw console.error("Failed to delete session:",A),A}finally{i.value.delete(k)}}async function u(k,A){try{await oe.put(`/api/sessions/${k}/name`,{name:A}),b(k,{name:A}),console.log(`Updated session ${k} name to "${A}"`)}catch(B){throw console.error("Failed to update session name:",B),B}}async function m(k,A){try{await oe.post(`/api/sessions/${k}/permission-mode`,{mode:A}),b(k,{current_permission_mode:A});const B=o.value.get(k);B&&(B.permissionMode=A,o.value.set(k,B)),console.log(`Set permission mode for session ${k} to ${A}`)}catch(B){throw console.error("Failed to set permission mode:",B),B}}async function E(k){try{await oe.post(`/api/sessions/${k}/start`),console.log(`Started session ${k}`)}catch(A){throw console.error("Failed to start session:",A),A}}async function S(k){try{await oe.post(`/api/sessions/${k}/pause`),console.log(`Paused session ${k}`)}catch(A){throw console.error("Failed to pause session:",A),A}}async function O(k){try{await oe.post(`/api/sessions/${k}/terminate`),console.log(`Terminated session ${k}`)}catch(A){throw console.error("Failed to terminate session:",A),A}}function I(k){return n.value.get(k)}function x(k,A){o.value.set(k,A),A.permissionMode&&b(k,{current_permission_mode:A.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:c,orderedSessions:f,sessionsInProject:_,currentInput:l,fetchSessions:$,createSession:g,selectSession:h,updateSession:b,deleteSession:d,updateSessionName:u,setPermissionMode:m,startSession:E,pauseSession:S,terminateSession:O,getSession:I,storeInitData:x}}),hn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ie},Symbol.toStringTag,{value:"Module"})),pe=yt("ui",()=>{const n=D(window.innerWidth<768),e=D(300),t=D(window.innerWidth),o=y(()=>t.value<768),i=D(!0),a=D(null),r=D(null),c=y(()=>a.value?{name:a.value,data:r.value}:null),f=D(!1),_=D("Loading...");function l(){n.value=!n.value}function $(S){n.value=S}function g(S){e.value=Math.max(200,Math.min(S,window.innerWidth*.3))}function h(S){i.value=S}function b(S,O=null){a.value=null,r.value=null,setTimeout(()=>{a.value=S,r.value=O},0)}function d(){a.value=null,r.value=null}function u(S="Loading..."){f.value=!0,_.value=S}function m(){f.value=!1}function E(){const S=t.value;t.value=window.innerWidth,t.value<768&&S>=768?n.value=!0:t.value>=768&&S<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:c,isLoading:f,loadingMessage:_,toggleSidebar:l,setSidebarCollapsed:$,setSidebarWidth:g,setAutoScroll:h,showModal:b,hideModal:d,showLoading:u,hideLoading:m,handleResize:E}}),$e=yt("project",()=>{const n=D(new Map),e=D(null),t=y(()=>n.value.get(e.value)),o=y(()=>Array.from(n.value.values()).sort((d,u)=>d.order-u.order)),i=d=>n.value.get(d)?.is_multi_agent||!1;async function a(){try{const d=await oe.get("/api/projects");return n.value.clear(),d.projects.forEach(u=>{n.value.set(u.project_id,u)}),console.log(`Loaded ${n.value.size} projects`),d.projects}catch(d){throw console.error("Failed to fetch projects:",d),d}}async function r(d,u,m=!1){try{const S=(await oe.post("/api/projects",{name:d,working_directory:u,is_multi_agent:m})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(E){throw console.error("Failed to create project:",E),E}}async function c(d,u){try{await oe.put(`/api/projects/${d}`,u),f(d,u),console.log(`Updated project ${d}`,u)}catch(m){throw console.error("Failed to update project:",m),m}}function f(d,u){const m=n.value.get(d);m&&(Object.assign(m,u),n.value=new Map(n.value))}async function _(d){try{await oe.delete(`/api/projects/${d}`),n.value.delete(d),n.value=new Map(n.value),e.value===d&&(e.value=null),console.log(`Deleted project ${d}`)}catch(u){throw console.error("Failed to delete project:",u),u}}async function l(d){try{const u=await oe.put(`/api/projects/${d}/toggle-expansion`),m=n.value.get(d);return m&&(m.is_expanded=u.is_expanded,n.value=new Map(n.value)),u.is_expanded}catch(u){throw console.error("Failed to toggle expansion:",u),u}}async function $(d){try{await oe.put("/api/projects/reorder",{project_ids:d}),d.forEach((u,m)=>{const E=n.value.get(u);E&&(E.order=m)}),n.value=new Map(n.value),console.log("Reordered projects",d)}catch(u){throw console.error("Failed to reorder projects:",u),u}}async function g(d,u){try{await oe.put(`/api/projects/${d}/sessions/reorder`,{session_ids:u});const m=n.value.get(d);m&&(m.session_ids=u,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${d}`,u)}catch(m){throw console.error("Failed to reorder sessions:",m),m}}function h(d){return n.value.get(d)}function b(d){if(!d)return"";const u=d.split(/[/\\]/).filter(m=>m);return u.length===0?"/":u.length===1?`/${u[0]}`:u.length===2?`/${u.join("/")}`:`.../${u.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:r,updateProject:c,updateProjectLocal:f,deleteProject:_,toggleExpansion:l,reorderProjects:$,reorderSessionsInProject:g,getProject:h,formatPath:b}}),G=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Ti={class:"session-header border-bottom p-3"},ki={class:"project-name"},xi=["title"],Ai={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ie(),o=$e(),i=y(()=>t.sessions.get(e.sessionId)),a=y(()=>i.value?.name||e.sessionId),r=y(()=>{for(const f of o.projects.values())if(f.session_ids?.includes(e.sessionId))return f;return null}),c=y(()=>r.value?.name||"Unknown Project");return(f,_)=>(p(),v("div",Ti,[s("div",null,[s("div",ki,w(c.value),1),s("div",{class:"session-name",title:n.sessionId},w(a.value),9,xi)])]))}},Mi=G(Ai,[["__scopeId","data-v-89e9c269"]]),Oi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ni=["title"],Di={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Li={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ie(),o=y(()=>t.sessions.get(e.sessionId)),i=y(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=y(()=>{const f=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[f]||"#d3d3d3"}),r=y(()=>{const f=i.value;return f==="starting"||f==="processing"||f==="pending-prompt"}),c=y(()=>{if(!o.value)return"No session selected";const f=i.value,_=f.charAt(0).toUpperCase()+f.slice(1).replace("-"," "),l=o.value.name||"Unnamed Session",$=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${l}${$}: ${_}`});return(f,_)=>(p(),v("div",Oi,[o.value?(p(),v("div",{key:0,class:z(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:Ue({width:"100%",backgroundColor:a.value}),title:c.value},null,14,Ni)):(p(),v("div",Di))]))}},Ii=G(Li,[["__scopeId","data-v-e8795bb7"]]),Pi={class:"session-status-bar border-top p-2 bg-light"},ji={class:"d-flex justify-content-between align-items-center gap-2"},Ri={class:"d-flex gap-2"},Hi=["disabled"],Vi={class:"mode-label"},Wi=["disabled"],Fi=["disabled"],Ui={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ie(),o=pe(),i=y(()=>t.sessions.get(e.sessionId)),a=y(()=>i.value?.current_permission_mode||"default"),r={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},c=y(()=>r[a.value]||"ðŸ”’"),f=y(()=>a.value),_=["default","acceptEdits","plan"],l=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(m){console.error("Failed to cycle permission mode:",m)}return}const d=(_.indexOf(a.value)+1)%_.length,u=_[d];try{await t.setPermissionMode(e.sessionId,u)}catch(m){console.error("Failed to cycle permission mode:",m)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},h=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(b,d)=>(p(),v("div",Pi,[s("div",ji,[s("div",Ri,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:l,disabled:!i.value},[te(w(c.value)+" ",1),s("span",Vi,w(f.value),1)],8,Hi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...d[0]||(d[0]=[te(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Wi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...d[1]||(d[1]=[te(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,Fi)]),s("div",null,[s("button",{class:z(["btn btn-sm",Qt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:h}," â¬‡ï¸ "+w(Qt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Bi=G(Ui,[["__scopeId","data-v-fdcd3535"]]),Oe=yt("message",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(new Map),c=y(()=>{const C=ie();return n.value.get(C.currentSessionId)||[]}),f=y(()=>{const C=ie();return e.value.get(C.currentSessionId)||[]});async function _(C,T=null,L=0){try{const M=T||1e4,R=await oe.get(`/api/sessions/${C}/messages?limit=${M}&offset=${L}`),H=R.messages||[],J=R.total_count||H.length,ae=R.has_more||!1;if(console.log(`Loaded ${H.length} of ${J} messages for session ${C}`),n.value.set(C,H),H.length>0){const ee=H[H.length-1];ee.timestamp&&(r.value.set(C,ee.timestamp),console.log(`Tracked last received timestamp for session ${C}: ${ee.timestamp}`))}const U=new Set;H.forEach(ee=>{ee.type==="assistant"&&ee.metadata?.tool_uses&&ee.metadata.tool_uses.forEach(q=>{U.add(q.id)}),ee.type==="user"&&ee.metadata?.tool_results&&ee.metadata.tool_results.forEach(q=>{U.delete(q.tool_use_id);const le=a.value.get(C);le&&le.delete(q.tool_use_id)}),ee.type==="system"&&ee.metadata?.subtype==="client_launched"&&(U.forEach(q=>{O(C,q,"Session was restarted")}),U.clear()),ee.type==="system"&&ee.metadata?.subtype==="interrupt"&&(U.forEach(q=>{O(C,q,"Session was interrupted")}),U.clear()),ee.metadata?.has_tool_uses&&ee.metadata.tool_uses&&ee.metadata.tool_uses.forEach(q=>{b(C,q)}),ee.metadata?.has_tool_results&&ee.metadata.tool_results&&ee.metadata.tool_results.forEach(q=>{m(C,q)}),(ee.type==="permission_request"||ee.metadata?.has_permission_requests)&&d(C,ee),ee.type==="system"&&(ee.subtype==="init"||ee.metadata?.subtype==="init")&&ee.metadata?.init_data&&ie().storeInitData(C,ee.metadata.init_data)});const se=ie().sessions.get(C);return se&&!["active","paused","starting"].includes(se.state)&&(U.forEach(ee=>{O(C,ee,"Session was terminated")}),U.clear()),i.value.set(C,U),n.value=new Map(n.value),ae&&console.warn(`Warning: Only loaded ${H.length} of ${J} messages. Some messages may be missing.`),{messages:H,totalCount:J,hasMore:ae}}catch(M){throw console.error("Failed to load messages:",M),M}}function l(C,T){const L=i.value.get(C)||new Set;T.type==="assistant"&&T.metadata?.tool_uses&&T.metadata.tool_uses.forEach(M=>{L.add(M.id)}),T.type==="user"&&T.metadata?.tool_results&&T.metadata.tool_results.forEach(M=>{L.delete(M.tool_use_id);const R=a.value.get(C);R&&R.delete(M.tool_use_id)}),T.type==="system"&&T.metadata?.subtype==="client_launched"&&(L.forEach(M=>{O(C,M,"Session was restarted")}),L.clear()),T.type==="system"&&T.metadata?.subtype==="interrupt"&&(L.forEach(M=>{O(C,M,"Session was interrupted")}),L.clear()),i.value.set(C,L)}function $(C,T){n.value.has(C)||n.value.set(C,[]);const L=n.value.get(C);if(T.id){const M=L.findIndex(R=>R.id===T.id);if(M!==-1){console.log(`Skipping duplicate message ${T.id} (already exists at index ${M})`);return}}L.push(T),T.timestamp&&r.value.set(C,T.timestamp),l(C,T),n.value=new Map(n.value)}function g(C,T){e.value.has(C)||e.value.set(C,[]),e.value.get(C).push(T),e.value=new Map(e.value)}function h(C,T,L){const M=e.value.get(C);if(M){const R=M.find(H=>H.id===T);R&&(Object.assign(R,L),e.value=new Map(e.value))}}function b(C,T){const L=S(T.name,T.input);t.value.set(L,T.id);const M={id:T.id,name:T.name,input:T.input,signature:L,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return g(C,M),console.log(`Created tool call ${M.id} for ${M.name}`),M}function d(C,T){console.log("handlePermissionRequest received:",T);const L=T.metadata?.tool_name||T.tool_name,M=T.metadata?.input_params||T.input_params,R=T.metadata?.request_id||T.request_id,H=T.metadata?.suggestions||T.suggestions||[];console.log("Extracted data:",{toolName:L,inputParams:M,requestId:R,suggestions:H});const J=S(L,M),ae=t.value.get(J);ae?(o.value.set(R,ae),h(C,ae,{status:"permission_required",permissionRequestId:R,suggestions:H}),console.log(`Permission required for tool ${ae}`,{suggestions:H})):console.warn("No tool use ID found for permission request signature:",J,{toolName:L,inputParams:M,availableSignatures:Array.from(t.value.keys())})}function u(C,T){const L=o.value.get(T.request_id);if(L){const M={permissionDecision:T.decision,appliedUpdates:T.applied_updates||[]};T.decision==="allow"?M.status="executing":(M.status="completed",M.result={error:!0,message:T.reasoning||"Permission denied"},M.isExpanded=!1),h(C,L,M),console.log(`Permission ${T.decision} for tool ${L}`)}}function m(C,T){const L=T.tool_use_id;h(C,L,{status:T.is_error?"error":"completed",result:{error:T.is_error,content:T.content},isExpanded:!1}),console.log(`Tool ${L} ${T.is_error?"failed":"completed"}`)}function E(C,T){const L=e.value.get(C);if(L){const M=L.find(R=>R.id===T);M&&(M.isExpanded=!M.isExpanded,e.value=new Map(e.value))}}function S(C,T){if(!C)return"unknown:{}";if(!T||typeof T!="object")return`${C}:{}`;const L=JSON.stringify(T,Object.keys(T).sort());return`${C}:${L}`}function O(C,T,L){const M=a.value.get(C)||new Map;M.set(T,{reason:"denied",message:L}),a.value.set(C,M);const R=e.value.get(C);if(R){const H=R.find(J=>J.id===T);H&&H.isExpanded&&(H.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${T} as orphaned: ${L}`)}function I(C,T){return a.value.get(C)?.has(T)||!1}function x(C,T){return a.value.get(C)?.get(T)}function k(C,T){const L=i.value.get(C);L&&L.size>0&&(L.forEach(M=>O(C,M,T)),L.clear())}function A(C){n.value.delete(C),e.value.delete(C),n.value=new Map(n.value),e.value=new Map(e.value)}function B(C){return r.value.get(C)}async function Z(C){const T=r.value.get(C);if(!T)return console.log(`No sync needed for session ${C} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${C} since ${T}`);const L=await oe.get(`/api/sessions/${C}/messages?limit=1000&offset=0`),M=L.messages||[],R=L.has_more||!1,H=q=>q?typeof q=="number"?q*1e3:new Date(q).getTime():0,J=H(T),ae=M.filter(q=>q.timestamp?H(q.timestamp)>J:!1);if(ae.length===0)return console.log(`No missed messages for session ${C}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ae.length} missed messages for session ${C}`);const U=n.value.get(C)||[],W=new Set(U.map(q=>q.id).filter(Boolean)),se=ae.filter(q=>!q.id||!W.has(q.id));if(console.log(`After deduplication: ${se.length} unique new messages`),se.length>0){const q=se.sort((X,Q)=>{const ve=H(X.timestamp),St=H(Q.timestamp);return ve-St}),le=n.value.get(C)||[],V=le.length>0?H(le[le.length-1].timestamp):0,F=H(q[0].timestamp),K=H(q[q.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:le.length,lastExisting:V,lastExistingDate:le.length>0?le[le.length-1].timestamp:"none",firstNew:F,firstNewDate:q[0].timestamp,lastNew:K,lastNewDate:q[q.length-1].timestamp,shouldAppend:F>V}),F>V){const X=[...le,...q];n.value.set(C,X),console.log(`âœ… Appended ${q.length} new messages (no full sort needed)`)}else{const X=[...le,...q].sort((Q,ve)=>{const St=H(Q.timestamp),Vt=H(ve.timestamp);return St-Vt});n.value.set(C,X),console.log(`âš ï¸ Merged and sorted ${q.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${U.length} messages unchanged`);se.forEach(q=>{l(C,q),q.metadata?.has_tool_uses&&q.metadata.tool_uses&&q.metadata.tool_uses.forEach(le=>{b(C,le)}),q.metadata?.has_tool_results&&q.metadata.tool_results&&q.metadata.tool_results.forEach(le=>{m(C,le)}),(q.type==="permission_request"||q.metadata?.has_permission_requests)&&d(C,q),q.type==="system"&&(q.subtype==="init"||q.metadata?.subtype==="init")&&q.metadata?.init_data&&ie().storeInitData(C,q.metadata.init_data)});const ee=n.value.get(C);if(ee&&ee.length>0){const q=ee[ee.length-1];q.timestamp&&r.value.set(C,q.timestamp)}return n.value=new Map(n.value),{syncedCount:se.length,hasMore:R}}catch(L){return console.error(`Failed to sync messages for session ${C}:`,L),{syncedCount:0,hasMore:!1,error:L.message}}}const j=ie();return ce(()=>Array.from(j.sessions.values()).map(T=>({id:T.session_id,state:T.state})),(C,T)=>{T&&C.forEach((L,M)=>{const R=T[M];if(!R||R.id!==L.id)return;const H=["active","paused","starting"].includes(R.state),J=!["active","paused","starting"].includes(L.state);H&&J&&k(L.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:fn(i),orphanedToolUses:fn(a),currentMessages:c,currentToolCalls:f,loadMessages:_,addMessage:$,addToolCall:g,updateToolCall:h,handleToolUse:b,handlePermissionRequest:d,handlePermissionResponse:u,handleToolResult:m,toggleToolExpansion:E,clearMessages:A,markToolUseOrphaned:O,isToolUseOrphaned:I,getOrphanedInfo:x,clearOrphanedToolUses:k,getLastReceivedTimestamp:B,syncMessages:Z}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Oe},Symbol.toStringTag,{value:"Module"}));function zi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Dt(n){return zi(n).toLocaleTimeString()}const Ki={class:"message-row message-row-user"},Gi=["title"],Yi={class:"message-content-column"},Ji=["innerHTML"],Xi={key:0,class:"tool-results mt-2"},Qi={class:"tool-results-header text-muted small mb-2"},Zi={class:"d-flex align-items-start gap-2"},ea={class:"flex-grow-1"},ta={class:"text-muted"},sa={key:0,class:"text-danger small"},na={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;et.setOptions({breaks:!0,gfm:!0});const t=y(()=>Dt(e.message.timestamp)),o=y(()=>`user
${t.value}`),i=y(()=>{const f=e.message.content||"";let _=et.parse(f);return _=_.replace(/\n</g,"<"),_=_.replace(/\n+$/,""),ns.sanitize(_)}),a=y(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=y(()=>e.message.metadata?.tool_results||[]);function c(f,_){return f?f.length<=_?f:f.substring(0,_)+"...":""}return(f,_)=>(p(),v("div",Ki,[s("div",{class:"message-speaker",title:o.value},[..._[0]||(_[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,Gi),s("div",Yi,[s("div",{class:"message-text",innerHTML:i.value},null,8,Ji),a.value?(p(),v("div",Xi,[s("div",Qi," ðŸ”§ Tool Results ("+w(r.value.length)+") ",1),(p(!0),v(re,null,de(r.value,(l,$)=>(p(),v("div",{key:$,class:z(["tool-result-summary p-2 mb-2 rounded",l.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",Zi,[s("span",null,w(l.is_error?"âŒ":"âœ…"),1),s("div",ea,[s("small",ta,"Tool: "+w(l.tool_use_id),1),l.is_error?(p(),v("div",sa,w(c(l.content,200)),1)):N("",!0)])])],2))),128))])):N("",!0)])]))}},oa=G(na,[["__scopeId","data-v-7665755b"]]),ia={class:"thinking-block"},aa=["aria-label"],ra={class:"text-muted ms-auto"},la={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ca=["innerHTML"],ua={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=D(!1),o=y(()=>e.thinking?.length||0),i=y(()=>{const r=e.thinking||"",c=et.parse(r);return ns.sanitize(c)});function a(){t.value=!t.value}return(r,c)=>(p(),v("div",ia,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("span",{"aria-label":t.value?"Collapse":"Expand"},w(t.value?"â–¾":"â–¸"),9,aa),c[0]||(c[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",ra,w(o.value)+" characters",1)]),t.value?(p(),v("div",la,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ca)])):N("",!0)]))}},da=G(ua,[["__scopeId","data-v-fda2352c"]]),Ve=yt("websocket",()=>{const n=D(null),e=D(!1),t=D(0),o=10,i=D(null),a=D(!1),r=D(0),c=5,f=D(null);let _=null;const l=D(0),$=D(null),g=D(new Map),h=D(null),b=D(!1),d=D(0),u=5,m=D(null),E=1e4,S=1e3,O=D(Date.now()),I=D(Date.now()),x=D(Date.now());let k=null,A=null,B=null;const Z=y(()=>e.value&&(a.value||!f.value)?"connected":e.value?"partial":"disconnected");function j(V){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${V}`}function C(V){const F={ui:{timer:()=>k,setTimer:K=>{k=K},lastPing:O,connected:e,name:"UI"},session:{timer:()=>A,setTimer:K=>{A=K},lastPing:I,connected:a,name:"Session"},legion:{timer:()=>B,setTimer:K=>{B=K},lastPing:x,connected:b,name:"Legion"}}[V];F.timer()&&clearInterval(F.timer()),F.setTimer(setInterval(()=>{if(!F.connected.value)return;const K=Date.now()-F.lastPing.value;if(K>E){console.warn(`âš ï¸ ${F.name} WebSocket heartbeat timeout (${K}ms since last ping) - forcing close to trigger reconnection`),F.connected.value=!1;const Q={ui:n,session:i,legion:h}[V];Q.value&&Q.value.readyState===WebSocket.OPEN&&Q.value.close()}},S)),console.log(`âœ… Started heartbeat monitor for ${F.name} WebSocket`)}function T(V){const F={ui:{get:()=>k,set:K=>{k=K}},session:{get:()=>A,set:K=>{A=K}},legion:{get:()=>B,set:K=>{B=K}}}[V];F.get()&&(clearInterval(F.get()),F.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${V} WebSocket`))}function L(){if(n.value)return;const V=j("/ws/ui");console.log(`Connecting to UI WebSocket: ${V}`),n.value=new WebSocket(V),n.value.onopen=()=>{e.value=!0,t.value=0,O.value=Date.now(),C("ui"),console.log("UI WebSocket connected")},n.value.onmessage=F=>{const K=JSON.parse(F.data);W(K)},n.value.onclose=()=>{if(T("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const F=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${F}ms (attempt ${t.value})`),setTimeout(L,F)}},n.value.onerror=F=>{console.error("UI WebSocket error:",F)}}function M(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function R(V){l.value++;const F=l.value;if(console.log(`[Gen ${F}] Starting connection to session ${V}`),_&&(clearTimeout(_),_=null),await H(),l.value!==F){console.log(`[Gen ${F}] Connection cancelled (current generation: ${l.value})`);return}f.value=V,$.value=F;const K=j(`/ws/session/${V}`);console.log(`[Gen ${F}] Connecting to Session WebSocket: ${K}`),i.value=new WebSocket(K),i.value.onopen=async()=>{if($.value!==F){console.log(`[Gen ${F}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}a.value=!0,r.value=0,I.value=Date.now(),C("session"),console.log(`[Gen ${F}] Session WebSocket connected for ${V}`);const X=g.value.get(V);if(g.value.set(V,!0),X){console.log(`[Gen ${F}] Reconnection detected, syncing missed messages...`);try{const ve=await Oe().syncMessages(V);ve.syncedCount>0?console.log(`[Gen ${F}] âœ… Synced ${ve.syncedCount} missed messages`):ve.error?console.warn(`[Gen ${F}] âš ï¸ Message sync failed: ${ve.error}`):console.log(`[Gen ${F}] No missed messages to sync`),ve.hasMore&&console.warn(`[Gen ${F}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(Q){console.error(`[Gen ${F}] Error during message sync:`,Q)}}else console.log(`[Gen ${F}] Initial connection, no sync needed`)},i.value.onmessage=X=>{if($.value!==F){console.log(`[Gen ${F}] Ignoring message (stale connection, current: ${$.value})`);return}const Q=JSON.parse(X.data);se(Q,V)},i.value.onclose=()=>{T("session"),a.value=!1,i.value=null,console.log(`[Gen ${F}] Session WebSocket closed for ${V}`);const X=ie();if(X.currentSessionId===V&&$.value===F&&r.value<c){r.value++;const Q=Math.min(2e3*r.value,3e4);console.log(`[Gen ${F}] Reconnecting Session WebSocket in ${Q}ms (attempt ${r.value})`),_=setTimeout(()=>{$.value===F&&X.currentSessionId===V?(_=null,R(V)):console.log(`[Gen ${F}] Skipping reconnect (generation or session changed)`)},Q)}},i.value.onerror=X=>{console.error(`[Gen ${F}] Session WebSocket error:`,X)}}function H(){return new Promise(V=>{if(_&&(clearTimeout(_),_=null,console.log("Cancelled pending session reconnect timer")),i.value){const F=f.value,K=()=>{i.value=null,a.value=!1,f.value=null,$.value=null,r.value=0,F&&g.value.delete(F),V()};if(i.value.readyState===WebSocket.CLOSED)K();else{const X=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),K()},2e3);i.value.addEventListener("close",()=>{clearTimeout(X),K()},{once:!0}),i.value.close()}}else f.value=null,$.value=null,V()})}function J(V){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:V})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function ae(V,F,K=!1,X=null){if(i.value&&a.value){const Q={type:"permission_response",request_id:V,decision:F,apply_suggestions:K,timestamp:new Date().toISOString()};X&&(Q.clarification_message=X),i.value.send(JSON.stringify(Q)),console.log(`Sent permission ${F} for request ${V}`,{applySuggestions:K,clarification:X})}}function U(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function W(V){const F=ie(),K=$e();switch(V.type){case"sessions_list":V.sessions&&Array.isArray(V.sessions)&&V.sessions.forEach(X=>{F.updateSession(X.session_id,X)});break;case"state_change":V.data&&V.data.session_id&&V.data.session&&F.updateSession(V.data.session_id,V.data.session);break;case"project_updated":if(V.data&&V.data.project){const X=V.data.project;K.updateProjectLocal(X.project_id,X)}break;case"project_deleted":V.data&&V.data.project_id&&K.projects.delete(V.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":O.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",V.type)}}function se(V,F){const K=ie();if(K.currentSessionId!==F){console.warn(`Ignoring message for session ${F} (current: ${K.currentSessionId})`);return}const X=Oe();switch(V.type){case"message":const Q=V.data;if(!Q||!Q.type){console.warn("Received message event with invalid data:",V);break}if(Q.type==="permission_request"){X.handlePermissionRequest(F,Q);break}if(Q.type==="permission_response"){X.handlePermissionResponse(F,Q);break}Q.metadata?.has_tool_uses&&Q.metadata.tool_uses.forEach(ve=>{X.handleToolUse(F,ve)}),Q.metadata?.has_tool_results&&Q.metadata.tool_results.forEach(ve=>{X.handleToolResult(F,ve)}),Q.type==="system"&&(Q.subtype==="init"||Q.metadata?.subtype==="init")&&Q.metadata?.init_data&&K.storeInitData(F,Q.metadata.init_data),X.addMessage(F,Q);break;case"permission_request":X.handlePermissionRequest(F,V);break;case"permission_response":X.handlePermissionResponse(F,V);break;case"tool_result":X.handleToolResult(F,V);break;case"state_change":K.updateSession(F,V.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${F}`);break;case"ping":I.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function ee(V){q(),m.value=V;const F=j(`/ws/legion/${V}`);console.log(`Connecting to Legion WebSocket: ${F}`),h.value=new WebSocket(F),h.value.onopen=()=>{b.value=!0,d.value=0,x.value=Date.now(),C("legion"),console.log(`Legion WebSocket connected for ${V}`)},h.value.onmessage=K=>{const X=JSON.parse(K.data);le(X,V)},h.value.onclose=()=>{if(T("legion"),b.value=!1,h.value=null,console.log(`Legion WebSocket closed for ${V}`),m.value===V&&d.value<u){d.value++;const K=Math.min(2e3*d.value,3e4);setTimeout(()=>ee(V),K)}},h.value.onerror=K=>{console.error("Legion WebSocket error:",K)}}function q(){h.value&&(h.value.close(),h.value=null,b.value=!1,m.value=null)}function le(V,F){ge(async()=>{const{useLegionStore:K}=await Promise.resolve().then(()=>i_);return{useLegionStore:K}},void 0).then(({useLegionStore:K})=>{const X=K();switch(V.type){case"comm":V.comm&&(X.addComm(F,V.comm),console.log("Legion WebSocket: Received new comm",V.comm));break;case"minion_created":V.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",V.data),ge(async()=>{const{useSessionStore:Q}=await Promise.resolve().then(()=>hn);return{useSessionStore:Q}},void 0).then(({useSessionStore:Q})=>{Q().loadSessions()}));break;case"minion_updated":V.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",V.data),ge(async()=>{const{useSessionStore:Q}=await Promise.resolve().then(()=>hn);return{useSessionStore:Q}},void 0).then(({useSessionStore:Q})=>{Q().loadSessions()}));break;case"channel_created":V.channel&&(console.log("Legion WebSocket: Channel created, updating list",V.channel),X.addChannel(F,V.channel));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${F}`);break;case"ping":x.value=Date.now(),h.value?.readyState===WebSocket.OPEN&&h.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",V.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:a,sessionRetryCount:r,legionConnected:b,legionRetryCount:d,overallStatus:Z,connectUI:L,disconnectUI:M,connectSession:R,disconnectSession:H,sendMessage:J,sendPermissionResponse:ae,interruptSession:U,connectLegion:ee,disconnectLegion:q}}),ma=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Ve},Symbol.toStringTag,{value:"Module"})),pa={class:"base-tool-handler"},fa={class:"tool-section"},va={class:"tool-parameters"},ha={class:"tool-code"},_a={key:0,class:"tool-section"},ga={class:"tool-section-label"},ba={class:"tool-code"},ya={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=y(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,c)=>(p(),v("div",pa,[s("div",fa,[c[0]||(c[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",va,[s("pre",ha,w(t.value),1)])]),o.value?(p(),v("div",_a,[s("div",ga,w(i.value?"Error:":"Result:"),1),s("div",{class:z(["tool-result",{"tool-result-error":i.value}])},[s("pre",ba,w(a.value),1)],2)])):N("",!0)]))}},$a=G(ya,[["__scopeId","data-v-1e69f57d"]]),wa={class:"read-tool-handler"},Ea={class:"tool-section"},Ca={class:"read-file-info"},Sa={class:"file-path"},Ta={key:0,class:"read-range"},ka={key:0,class:"tool-section"},xa={key:0,class:"tool-result tool-result-error"},Aa={class:"tool-code"},Ma={key:1,class:"file-content-preview"},Oa={class:"content-header"},Na={class:"line-count-badge"},Da={key:0,class:"preview-note"},La={class:"tool-code content-display"},Ia={key:0,class:"more-indicator"},fs=100,Pa={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>{const h=e.toolCall.input?.offset,b=e.toolCall.input?.limit;return h!==void 0||b!==void 0}),i=y(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),a=y(()=>{const h=e.toolCall.input?.offset||0,b=e.toolCall.input?.limit;return b!==void 0?h+b:"âˆž"}),r=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=y(()=>{if(!r.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),_=y(()=>c.value||!f.value?[]:f.value.split(`
`)),l=y(()=>_.value.length),$=y(()=>l.value>fs),g=y(()=>c.value?"":_.value.slice(0,fs).join(`
`));return(h,b)=>(p(),v("div",wa,[s("div",Ea,[s("div",Ca,[b[0]||(b[0]=s("span",{class:"file-icon"},"ðŸ“„",-1)),b[1]||(b[1]=s("strong",null,"Reading:",-1)),s("code",Sa,w(t.value),1),o.value?(p(),v("span",Ta,"Lines "+w(i.value)+"-"+w(a.value),1)):N("",!0)])]),r.value?(p(),v("div",ka,[c.value?(p(),v("div",xa,[s("pre",Aa,w(f.value),1)])):(p(),v("div",Ma,[s("div",Oa,[b[2]||(b[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Na,w(l.value)+" lines",1),$.value?(p(),v("span",Da,"(showing first "+w(fs)+")")):N("",!0)]),s("pre",La,w(g.value),1),$.value?(p(),v("div",Ia,"...")):N("",!0)]))])):N("",!0)]))}},ja=G(Pa,[["__scopeId","data-v-1f2b0569"]]),Ra={class:"write-tool-handler"},Ha={class:"tool-section"},Va={class:"write-file-info mb-2"},Wa={class:"file-path"},Fa={class:"write-content-preview"},Ua={class:"content-header"},Ba={class:"line-count-badge"},qa={key:0,class:"preview-note"},za={class:"tool-code content-display"},Ka={key:0,class:"more-indicator"},Ga={key:0,class:"tool-section"},Ya={key:0,class:"tool-result tool-result-error"},Ja={class:"tool-code"},Xa={key:1,class:"tool-result tool-result-success"},Qa={class:"success-message"},vs=100,Za={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>e.toolCall.input?.content||""),i=y(()=>o.value.split(`
`)),a=y(()=>i.value.length),r=y(()=>a.value>vs),c=y(()=>i.value.slice(0,vs).join(`
`)),f=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),_=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=y(()=>{if(!f.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,g)=>(p(),v("div",Ra,[s("div",Ha,[s("div",Va,[g[0]||(g[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=s("strong",null,"Writing:",-1)),s("code",Wa,w(t.value),1)]),s("div",Fa,[s("div",Ua,[g[2]||(g[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",Ba,w(a.value)+" lines",1),r.value?(p(),v("span",qa,"(showing first "+w(vs)+")")):N("",!0)]),s("pre",za,w(c.value),1),r.value?(p(),v("div",Ka,"...")):N("",!0)])]),f.value?(p(),v("div",Ga,[_.value?(p(),v("div",Ya,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",Ja,w(l.value),1)])):(p(),v("div",Xa,[s("div",Qa,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+w(a.value)+" lines written)",1)])]))])):N("",!0)]))}},er=G(Za,[["__scopeId","data-v-ddc24a0f"]]),tr={class:"bash-tool-handler"},sr={class:"tool-section"},nr={class:"bash-header"},or={class:"bash-header-content"},ir={key:0,class:"bash-description"},ar={key:1,class:"bash-flags"},rr={class:"bash-command-section"},lr={class:"bash-command-content"},cr={key:0,class:"tool-section"},ur={key:0,class:"bash-output"},dr={key:1,class:"bash-output-empty"},mr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.command||""),o=y(()=>e.toolCall.input?.description||""),i=y(()=>e.toolCall.input?.timeout),a=y(()=>e.toolCall.input?.run_in_background||!1),r=y(()=>i.value||a.value),c=y(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),a.value&&g.push("background"),g.join(", ")}),f=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),_=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=y(()=>_.value?"tool-result-error":"tool-result-success"),$=y(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,h)=>(p(),v("div",tr,[s("div",sr,[s("div",nr,[h[1]||(h[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",or,[o.value?(p(),v("div",ir,[h[0]||(h[0]=s("strong",null,"Description:",-1)),te(" "+w(o.value),1)])):N("",!0),r.value?(p(),v("div",ar,w(c.value),1)):N("",!0)])]),s("div",rr,[h[2]||(h[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",lr,w(t.value),1)])]),f.value?(p(),v("div",cr,[s("div",{class:z(["tool-result",l.value])},[h[3]||(h[3]=s("strong",null,"Output:",-1)),$.value?(p(),v("pre",ur,w($.value),1)):(p(),v("div",dr,"No output"))],2)])):N("",!0)]))}},pr=G(mr,[["__scopeId","data-v-ab50fe73"]]),fr={class:"todo-tool-handler"},vr={class:"tool-section"},hr={class:"todo-header"},_r={class:"todo-summary"},gr={key:0,class:"todo-count todo-count-completed"},br={key:1,class:"todo-count todo-count-in-progress"},yr={key:2,class:"todo-count todo-count-pending"},$r={class:"todo-checklist"},wr={class:"todo-checkbox"},Er={class:"todo-content"},Cr={key:0,class:"tool-section"},Sr={key:0,class:"tool-result tool-result-error"},Tr={class:"tool-code"},kr={key:1,class:"tool-result tool-result-success"},xr={class:"success-message"},Ar={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.todos||[]),o=y(()=>t.value.filter(l=>l.status==="completed").length),i=y(()=>t.value.filter(l=>l.status==="in_progress").length),a=y(()=>t.value.filter(l=>l.status==="pending").length);function r(l){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[l]||"â˜"}const c=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=y(()=>{if(!c.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,$)=>(p(),v("div",fr,[s("div",vr,[s("div",hr,[$[0]||($[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=s("strong",null,"Task List:",-1)),s("div",_r,[o.value>0?(p(),v("span",gr,w(o.value)+" completed ",1)):N("",!0),i.value>0?(p(),v("span",br,w(i.value)+" in progress ",1)):N("",!0),a.value>0?(p(),v("span",yr,w(a.value)+" pending ",1)):N("",!0)])]),s("div",$r,[(p(!0),v(re,null,de(t.value,(g,h)=>(p(),v("div",{key:h,class:z(["todo-item",`todo-${g.status}`])},[s("span",wr,w(r(g.status)),1),s("span",Er,w(g.content),1)],2))),128))])]),c.value?(p(),v("div",Cr,[f.value?(p(),v("div",Sr,[$[2]||($[2]=s("strong",null,"Error:",-1)),s("pre",Tr,w(_.value),1)])):(p(),v("div",kr,[s("div",xr,[$[3]||($[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+w(t.value.length)+" tasks)",1)])]))])):N("",!0)]))}},Mr=G(Ar,[["__scopeId","data-v-bbe55ee7"]]),Or={class:"edit-tool-handler"},Nr={class:"tool-section"},Dr={class:"edit-file-info"},Lr={class:"file-path"},Ir={key:0,class:"replace-all-badge"},Pr={class:"edit-diff-container"},jr={class:"diff-header"},Rr={class:"diff-stats"},Hr={class:"stat-removed"},Vr={class:"stat-added"},Wr={class:"unified-diff"},Fr={class:"diff-scroll-container"},Ur={class:"diff-marker"},Br={class:"diff-content"},qr={key:0,class:"tool-section"},zr={key:0,class:"tool-result tool-result-error"},Kr={class:"tool-code"},Gr={key:1,class:"tool-result tool-result-success"},Yr={class:"success-message"},Jr={key:0,class:"success-detail"},Xr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>e.toolCall.input?.old_string||""),i=y(()=>e.toolCall.input?.new_string||""),a=y(()=>e.toolCall.input?.replace_all||!1),r=y(()=>{const h=_i(t.value,o.value,i.value,"","",{context:3}).split(`
`),b=[];for(let d=4;d<h.length;d++){const u=h[d];u&&(u.startsWith("-")?b.push({type:"removed",content:u.substring(1)}):u.startsWith("+")?b.push({type:"added",content:u.substring(1)}):u.startsWith(" ")?b.push({type:"context",content:u.substring(1)}):u.startsWith("@@")&&b.push({type:"hunk",content:u}))}return b}),c=y(()=>r.value.filter(g=>g.type==="removed").length),f=y(()=>r.value.filter(g=>g.type==="added").length),_=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=y(()=>{if(!_.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,h)=>(p(),v("div",Or,[s("div",Nr,[s("div",Dr,[h[0]||(h[0]=s("span",{class:"file-icon"},"âœï¸",-1)),h[1]||(h[1]=s("strong",null,"Editing:",-1)),s("code",Lr,w(t.value),1),a.value?(p(),v("span",Ir,"Replace All")):N("",!0)]),s("div",Pr,[s("div",jr,[h[2]||(h[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Rr,[s("span",Hr,"-"+w(c.value),1),s("span",Vr,"+"+w(f.value),1)])]),s("div",Wr,[s("div",Fr,[(p(!0),v(re,null,de(r.value,(b,d)=>(p(),v("div",{key:d,class:z(["diff-line",{"diff-line-removed":b.type==="removed","diff-line-added":b.type==="added","diff-line-context":b.type==="context","diff-line-hunk":b.type==="hunk"}])},[s("span",Ur,w(b.type==="removed"?"-":b.type==="added"?"+":b.type==="hunk"?"@":" "),1),s("span",Br,w(b.content),1)],2))),128))])])])]),_.value?(p(),v("div",qr,[l.value?(p(),v("div",zr,[h[3]||(h[3]=s("strong",null,"Error:",-1)),s("pre",Kr,w($.value),1)])):(p(),v("div",Gr,[s("div",Yr,[h[4]||(h[4]=s("span",{class:"success-icon"},"âœ…",-1)),h[5]||(h[5]=s("strong",null,"File edited successfully",-1)),a.value?(p(),v("span",Jr,"(all occurrences replaced)")):N("",!0)])]))])):N("",!0)]))}},Qr=G(Xr,[["__scopeId","data-v-dd74055e"]]),Zr={class:"search-tool-handler"},el={class:"tool-section"},tl={class:"search-info"},sl={class:"search-icon"},nl={class:"search-pattern"},ol={key:0,class:"search-path"},il={key:1,class:"search-filters"},al={key:0,class:"filter-badge"},rl={key:1,class:"filter-badge"},ll={key:2,class:"filter-badge"},cl={key:0,class:"tool-section"},ul={key:0,class:"tool-result tool-result-error"},dl={class:"tool-code"},ml={key:1,class:"search-results"},pl={class:"results-header"},fl={class:"results-label"},vl={class:"results-count-badge"},hl={class:"results-content"},_l={class:"tool-code"},gl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.name==="Grep"),o=y(()=>e.toolCall.input?.pattern||"Unknown"),i=y(()=>e.toolCall.input?.path||null),a=y(()=>e.toolCall.input?.type||null),r=y(()=>e.toolCall.input?.glob||null),c=y(()=>e.toolCall.input?.["-i"]||!1),f=y(()=>a.value||r.value||c.value),_=y(()=>t.value?"ðŸ”":"ðŸ“"),l=y(()=>t.value?"Searching content":"Finding files"),$=y(()=>t.value?"Matches":"Files found"),g=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),h=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=y(()=>{if(!g.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)}),d=y(()=>!g.value||h.value||!b.value?0:b.value.split(`
`).filter(m=>m.trim()).length);return(u,m)=>(p(),v("div",Zr,[s("div",el,[s("div",tl,[s("span",sl,w(_.value),1),s("strong",null,w(l.value)+":",1),s("code",nl,w(o.value),1),i.value?(p(),v("span",ol,"in "+w(i.value),1)):N("",!0),f.value?(p(),v("span",il,[a.value?(p(),v("span",al,"type: "+w(a.value),1)):N("",!0),r.value?(p(),v("span",rl,"glob: "+w(r.value),1)):N("",!0),c.value?(p(),v("span",ll,"case-insensitive")):N("",!0)])):N("",!0)])]),g.value?(p(),v("div",cl,[h.value?(p(),v("div",ul,[m[0]||(m[0]=s("strong",null,"Error:",-1)),s("pre",dl,w(b.value),1)])):(p(),v("div",ml,[s("div",pl,[s("span",fl,w($.value)+":",1),s("span",vl,w(d.value)+" "+w(d.value===1?"match":"matches"),1)]),s("div",hl,[s("pre",_l,w(b.value),1)])]))])):N("",!0)]))}},_n=G(gl,[["__scopeId","data-v-0d272c39"]]),bl={class:"web-tool-handler"},yl={class:"tool-section"},$l={class:"web-info"},wl={class:"web-icon"},El=["href"],Cl={key:1,class:"web-query"},Sl={key:0,class:"web-prompt-container"},Tl={class:"prompt-content"},kl={key:1,class:"web-domains"},xl={class:"domains-label"},Al={key:0,class:"tool-section"},Ml={key:0,class:"tool-result tool-result-error"},Ol={class:"tool-code"},Nl={key:1,class:"web-results"},Dl={class:"results-header"},Ll={class:"results-label"},Il={class:"results-content"},Pl={class:"tool-code"},jl={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.name==="WebFetch"),o=y(()=>e.toolCall.input?.url||null),i=y(()=>e.toolCall.input?.query||null),a=y(()=>e.toolCall.input?.prompt||null),r=y(()=>e.toolCall.input?.allowed_domains||[]),c=y(()=>e.toolCall.input?.blocked_domains||[]),f=y(()=>r.value.length>0?r.value:c.value.length>0?c.value:[]),_=y(()=>r.value.length>0?"Allowed domains":c.value.length>0?"Blocked domains":"Domains"),l=y(()=>t.value?"ðŸŒ":"ðŸ”Ž"),$=y(()=>t.value?"Fetching URL":"Searching web"),g=y(()=>t.value?"Fetched content":"Search results"),h=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),b=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=y(()=>{if(!h.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,m)=>(p(),v("div",bl,[s("div",yl,[s("div",$l,[s("span",wl,w(l.value),1),s("strong",null,w($.value)+":",1),o.value?(p(),v("a",{key:0,href:o.value,target:"_blank",class:"web-url"},w(o.value),9,El)):i.value?(p(),v("code",Cl,w(i.value),1)):N("",!0)]),a.value?(p(),v("div",Sl,[m[0]||(m[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Tl,w(a.value),1)])):N("",!0),f.value.length>0?(p(),v("div",kl,[s("span",xl,w(_.value)+":",1),(p(!0),v(re,null,de(f.value,E=>(p(),v("span",{key:E,class:"domain-badge"},w(E),1))),128))])):N("",!0)]),h.value?(p(),v("div",Al,[b.value?(p(),v("div",Ml,[m[1]||(m[1]=s("strong",null,"Error:",-1)),s("pre",Ol,w(d.value),1)])):(p(),v("div",Nl,[s("div",Dl,[s("span",Ll,w(g.value)+":",1)]),s("div",Il,[s("pre",Pl,w(d.value),1)])]))])):N("",!0)]))}},gn=G(jl,[["__scopeId","data-v-62b55b55"]]),Rl={class:"task-tool-handler"},Hl={class:"tool-section"},Vl={class:"task-header"},Wl={key:0,class:"agent-type-badge"},Fl={key:0,class:"task-description"},Ul={class:"description-content"},Bl={key:1,class:"task-prompt-container"},ql={class:"prompt-header"},zl={class:"prompt-length"},Kl={class:"prompt-code"},Gl={key:0,class:"tool-section"},Yl={key:0,class:"tool-result tool-result-error"},Jl={class:"tool-code"},Xl={key:1,class:"agent-output"},Ql={class:"output-header"},Zl={key:0,class:"output-count-badge"},ec={class:"output-content"},tc={class:"tool-code"},sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.description||null),o=y(()=>e.toolCall.input?.prompt||null),i=y(()=>e.toolCall.input?.subagent_type||null),a=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=y(()=>{if(!a.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),f=y(()=>c.value?c.value.split(`
`).length:0);return(_,l)=>(p(),v("div",Rl,[s("div",Hl,[s("div",Vl,[l[0]||(l[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),l[1]||(l[1]=s("strong",null,"Agent Task:",-1)),i.value?(p(),v("span",Wl,w(i.value),1)):N("",!0)]),t.value?(p(),v("div",Fl,[l[2]||(l[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",Ul,w(t.value),1)])):N("",!0),o.value?(p(),v("div",Bl,[s("div",ql,[l[3]||(l[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",zl,w(o.value.length)+" characters",1)]),s("pre",Kl,w(o.value),1)])):N("",!0)]),a.value?(p(),v("div",Gl,[r.value?(p(),v("div",Yl,[l[4]||(l[4]=s("strong",null,"Error:",-1)),s("pre",Jl,w(c.value),1)])):(p(),v("div",Xl,[s("div",Ql,[l[5]||(l[5]=s("span",{class:"output-label"},"Agent Output:",-1)),f.value>0?(p(),v("span",Zl,w(f.value)+" lines",1)):N("",!0)]),s("div",ec,[s("pre",tc,w(c.value),1)])]))])):N("",!0)]))}},nc=G(sc,[["__scopeId","data-v-c520c244"]]),oc={class:"notebook-edit-tool-handler"},ic={class:"tool-section"},ac={class:"notebook-info"},rc={class:"file-path"},lc={class:"cell-info mt-2"},cc={class:"info-row"},uc={class:"info-row"},dc={key:0,class:"info-row"},mc={class:"badge bg-info"},pc={key:0,class:"source-preview mt-3"},fc={class:"preview-header"},vc={class:"preview-stats"},hc={class:"source-code"},_c={key:0,class:"tool-section"},gc={key:0},bc={key:1,class:"text-danger"},yc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.notebook_path||"Unknown"),o=y(()=>e.toolCall.input?.cell_id),i=y(()=>e.toolCall.input?.cell_type||"code"),a=y(()=>e.toolCall.input?.edit_mode||"replace"),r=y(()=>e.toolCall.input?.new_source||""),c=y(()=>r.value.split(`
`).length),f=y(()=>i.value==="code"?"bg-primary":"bg-secondary"),_=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),l=y(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=a.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,g)=>(p(),v("div",oc,[s("div",ic,[s("div",ac,[g[0]||(g[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=s("strong",null,"Notebook:",-1)),s("code",rc,w(t.value),1)]),s("div",lc,[s("div",cc,[g[2]||(g[2]=s("strong",null,"Cell ID:",-1)),s("code",null,w(o.value||"N/A"),1)]),s("div",uc,[g[3]||(g[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:z(["badge",f.value])},w(i.value),3)]),a.value?(p(),v("div",dc,[g[4]||(g[4]=s("strong",null,"Edit Mode:",-1)),s("span",mc,w(a.value),1)])):N("",!0)]),r.value?(p(),v("div",pc,[s("div",fc,[g[5]||(g[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",vc,w(c.value)+" lines",1)]),s("pre",hc,[s("code",null,w(r.value),1)])])):N("",!0)]),n.toolCall.result?(p(),v("div",_c,[g[6]||(g[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:z(["tool-result",_.value])},[n.toolCall.result.success!==!1?(p(),v("div",gc," âœ… "+w(l.value),1)):(p(),v("div",bc," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)])):N("",!0)]))}},$c=G(yc,[["__scopeId","data-v-c81a9bcf"]]),wc={class:"shell-tool-handler"},Ec={class:"tool-section"},Cc={class:"shell-info"},Sc={class:"shell-icon"},Tc={key:0,class:"shell-id"},kc={key:0,class:"filter-info mt-2"},xc={class:"filter-pattern"},Ac={key:0,class:"tool-section"},Mc={class:"result-header mb-2"},Oc={key:0,class:"mb-2"},Nc={class:"shell-output"},Dc={key:1,class:"mb-2"},Lc={class:"shell-output shell-output-error"},Ic={key:0},Pc={key:1,class:"text-danger"},jc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=y(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=y(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=y(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=y(()=>e.toolCall.input?.filter);function c(h,b){if(!h)return null;const d=new RegExp(`<${b}>([\\s\\S]*?)<\\/${b}>`,"i"),u=h.match(d);return u?u[1].trim():null}const f=y(()=>{const h=e.toolCall.result;if(!h)return null;let b=h;if(h.content&&(b=h.content),typeof b=="string")return{status:c(b,"status"),stdout:c(b,"stdout"),stderr:c(b,"stderr"),exit_code:c(b,"exit_code")};if(Array.isArray(b)){const d=b.find(u=>u.type==="text")?.text||"";return{status:c(d,"status"),stdout:c(d,"stdout"),stderr:c(d,"stderr"),exit_code:c(d,"exit_code")}}return{status:h.status||b.status,stdout:h.stdout||h.output||b.stdout||b.output,stderr:h.stderr||b.stderr,exit_code:h.exit_code||b.exit_code}}),_=y(()=>f.value?.status),l=y(()=>{const h=_.value;return h==="running"?"bg-success":h==="completed"?"bg-secondary":h==="killed"||h==="terminated"?"bg-danger":"bg-info"}),$=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=y(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const h=f.value;if(h?.status==="running"&&!h.stdout&&!h.stderr)return"No new output since last check";if(h?.status==="failed")return`Shell failed (exit code ${h.exit_code||"unknown"})`}return"Operation completed"});return(h,b)=>(p(),v("div",wc,[s("div",Ec,[s("div",Cc,[s("span",Sc,w(t.value),1),s("strong",null,w(o.value)+":",1),a.value?(p(),v("code",Tc,"Shell "+w(a.value),1)):N("",!0)]),n.toolCall.name==="BashOutput"&&r.value?(p(),v("div",kc,[b[0]||(b[0]=s("strong",null,"Filter:",-1)),s("code",xc,w(r.value),1)])):N("",!0)]),n.toolCall.result?(p(),v("div",Ac,[s("div",Mc,[s("strong",null,w(i.value)+":",1),_.value?(p(),v("span",{key:0,class:z(["badge",l.value])},w(_.value),3)):N("",!0)]),f.value?.stdout?(p(),v("div",Oc,[b[1]||(b[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Nc,[s("pre",null,[s("code",null,w(f.value.stdout),1)])])])):N("",!0),f.value?.stderr?(p(),v("div",Dc,[b[2]||(b[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",Lc,[s("pre",null,[s("code",null,w(f.value.stderr),1)])])])):N("",!0),!f.value?.stdout&&!f.value?.stderr?(p(),v("div",{key:2,class:z(["tool-result",$.value])},[n.toolCall.result.success!==!1?(p(),v("div",Ic," âœ… "+w(g.value),1)):(p(),v("div",Pc," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)):N("",!0)])):N("",!0)]))}},bn=G(jc,[["__scopeId","data-v-86def281"]]),Rc={class:"skill-tool-handler"},Hc={key:0,class:"tool-section"},Vc={class:"d-flex align-items-center gap-2"},Wc={class:"text-muted small"},Fc={key:0,class:"skill-content-body"},Uc={class:"skill-content-text"},Bc={key:1,class:"tool-section mt-3"},qc={class:"tool-result tool-result-error"},zc={class:"tool-code"},Kc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=ie(),i=D(!1);function a(){i.value=!i.value}const r=y(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const h=t.messagesBySession.get(g)||[],b=h.findIndex(m=>m.type==="user"&&m.metadata?.has_tool_results&&m.metadata?.tool_results?.some(E=>E.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let d=null,u=null;for(let m=b+1;m<Math.min(b+3,h.length);m++){const E=h[m];if(E.type!=="user")continue;const S=E.content||"";S.includes("<command-message>")&&S.includes("skill is running")?d=E:S.startsWith("Base directory for this skill:")&&(u=E)}return{running:d,content:u}}),c=y(()=>{const g=r.value.content;if(!g)return"";const h=g.content||"",b=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return h.replace(b,"").trim()}),f=y(()=>c.value.length>0),_=y(()=>c.value?c.value.split(`
`).length:0),l=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=y(()=>{if(!l.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,h)=>(p(),v("div",Rc,[f.value?(p(),v("div",Hc,[s("div",{class:"skill-content-header",onClick:a},[s("div",Vc,[s("i",{class:z(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),h[0]||(h[0]=s("strong",null,"Skill Content",-1)),s("span",Wc,"("+w(_.value)+" lines)",1)])]),i.value?(p(),v("div",Fc,[s("pre",Uc,w(c.value),1)])):N("",!0)])):N("",!0),l.value?(p(),v("div",Bc,[h[1]||(h[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",qc,[s("pre",zc,w($.value),1)])])):N("",!0)]))}},Gc=G(Kc,[["__scopeId","data-v-0a48ca0f"]]),Yc={class:"slashcommand-tool-handler"},Jc={key:0,class:"tool-section"},Xc={class:"d-flex align-items-center gap-2"},Qc=["aria-label"],Zc={class:"text-muted small"},eu={key:0,class:"command-content-body"},tu={class:"command-content-text"},su={key:1,class:"tool-section mt-3"},nu={class:"tool-result tool-result-error"},ou={class:"tool-code"},iu={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=ie(),i=D(!1);function a(){i.value=!i.value}const r=y(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const h=t.messagesBySession.get(g)||[],b=h.findIndex(m=>m.type==="user"&&m.metadata?.has_tool_results&&m.metadata?.tool_results?.some(E=>E.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let d=null,u=null;for(let m=b+1;m<Math.min(b+3,h.length);m++){const E=h[m];if(E.type!=="user")continue;const S=E.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?d=E:S.includes("ARGUMENTS:")&&(u=E)}return{running:d,content:u}}),c=y(()=>{const g=r.value.content;if(!g)return"";const h=g.content||"",b=/\nARGUMENTS:.*$/s;return h.replace(b,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),f=y(()=>c.value.length>0),_=y(()=>c.value?c.value.split(`
`).length:0),l=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=y(()=>{if(!l.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,h)=>(p(),v("div",Yc,[f.value?(p(),v("div",Jc,[s("div",{class:"command-content-header",onClick:a},[s("div",Xc,[s("span",{"aria-label":i.value?"Collapse":"Expand"},w(i.value?"â–¾":"â–¸"),9,Qc),h[0]||(h[0]=s("strong",null,"Command Content",-1)),s("span",Zc,"("+w(_.value)+" lines)",1)])]),i.value?(p(),v("div",eu,[s("pre",tu,w(c.value),1)])):N("",!0)])):N("",!0),l.value?(p(),v("div",su,[h[1]||(h[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",nu,[s("pre",ou,w($.value),1)])])):N("",!0)]))}},au=G(iu,[["__scopeId","data-v-15991acf"]]),ru={class:"exit-plan-mode-tool-handler"},lu={class:"tool-section"},cu={key:0,class:"plan-content mt-2"},uu={class:"plan-text"},du={key:0,class:"tool-section"},mu={key:0},pu={key:1,class:"text-danger"},fu={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.plan),o=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(p(),v("div",ru,[s("div",lu,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(p(),v("div",cu,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",uu,w(t.value),1)])):N("",!0)]),n.toolCall.result?(p(),v("div",du,[a[2]||(a[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:z(["tool-result",o.value])},[n.toolCall.result.success!==!1?(p(),v("div",mu," âœ… Permission mode reverted to default ")):(p(),v("div",pu," â— "+w(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):N("",!0)]))}},vu=G(fu,[["__scopeId","data-v-e2e3c781"]]),hu={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},_u={class:"tool-status-icon"},gu=["title"],bu={class:"d-flex align-items-center gap-2"},yu={class:"text-muted"},$u=["aria-label"],wu={key:0,class:"card-body"},Eu={key:0,class:"alert alert-warning mb-3"},Cu={class:"d-flex align-items-center"},Su={class:"mb-0 small"},Tu={key:1,class:"permission-prompt mt-3"},ku={class:"alert alert-warning mb-3"},xu={class:"mb-0"},Au={class:"tool-name"},Mu={key:0,class:"suggestions-section mb-3"},Ou={class:"alert alert-info mb-0"},Nu={class:"suggestion-details p-2 bg-white rounded"},Du={class:"permission-buttons d-flex gap-2 mb-3"},Lu=["disabled"],Iu=["disabled"],Pu=["disabled"],ju={class:"guidance-section mt-3"},Ru=["disabled"],Hu=["disabled"],Vu={key:2,class:"mt-3"},Wu={class:"alert alert-warning mb-0"},Fu={class:"d-flex align-items-center"},Uu={class:"mb-0 small"},Bu={key:3,class:"tool-section"},qu={class:"alert alert-danger mb-0"},zu={key:0},Ku={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=ie(),i=Ve(),a=D(!1),r=D(null),c=D(""),f=y(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),_=y(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),l={Read:ja,Write:er,Bash:pr,TodoWrite:Mr,Edit:Qr,Grep:_n,Glob:_n,WebFetch:gn,WebSearch:gn,Task:nc,NotebookEdit:$c,BashOutput:bn,KillShell:bn,SlashCommand:au,Skill:Gc,ExitPlanMode:vu},$=y(()=>{const j=e.toolCall.name;return l[j]?l[j]:$a}),g=y(()=>{const j=[];switch(e.toolCall.status){case"pending":j.push("border-secondary");break;case"permission_required":j.push("border-warning");break;case"executing":j.push("border-primary");break;case"completed":d.value||e.toolCall.permissionDecision==="deny"?j.push("border-danger"):j.push("border-success");break;case"error":j.push("border-danger");break}return j.join(" ")}),h=y(()=>{switch(e.toolCall.status){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":d.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),b=y(()=>Dt(e.toolCall.timestamp)),d=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=y(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function m(j){if(!j)return"";const C=j.replace(/\\/g,"/").split("/");return C[C.length-1]}function E(j){if(!j)return"";const C=j.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return C?C[1]:j}function S(j,C=200){return j?j.length<=C?j:j.substring(0,C)+"...":""}function O(j){if(!j)return null;if(j.content){const C=j.content.match(/exit code (\d+)/i);if(C)return parseInt(C[1])}return j.error?1:0}function I(j,C){const T=j?j.split(`
`).length:0;return{added:C?C.split(`
`).length:0,removed:T}}const x=y(()=>{const j=e.toolCall.name,C=e.toolCall.input||{},T=e.toolCall.result,L=e.toolCall.status;switch(j){case"Bash":case"Shell":case"Command":{const M=E(C.command),R=S(M,200);if(L==="completed"&&T){const H=O(T);return`Bash: ${R} (exit ${H})`}return`Bash: ${R}`}case"SlashCommand":{const M=S(C.command,200);return L==="completed"&&T?`SlashCommand: ${M}`:`SlashCommand: ${M}`}case"Edit":{const M=m(C.file_path);if(L==="completed"&&T&&!T.error){const{added:R,removed:H}=I(C.old_string,C.new_string);return R===H?`Edit: ${M} (${R} lines changed)`:`Edit: ${M} (${R} lines added, ${H} removed)`}return`Edit: ${M}`}case"Read":{const M=m(C.file_path);if(C.offset!==void 0||C.limit!==void 0){const H=(C.offset||0)+1,J=C.limit?(C.offset||0)+C.limit:"âˆž";return`Read: ${M} (lines ${H}-${J})`}return`Read: ${M} (full file)`}case"Write":{const M=m(C.file_path);if(L==="completed"&&T&&!T.error&&C.content){const R=C.content.split(`
`).length;return`Write: ${M} (${R} lines written)`}return`Write: ${M}`}case"Skill":{const M=C.skill||"Unknown";return L==="completed"&&T?T.error?`Skill: ${M} (error)`:`Skill: ${M} (completed)`:`Skill: ${M}`}case"Task":{const M=C.subagent_type||"general",R=C.description||"Task";return L==="completed"&&T?T.error?`Task: (${M}) ${R} (error)`:`Task: (${M}) ${R} (completed)`:`Task: (${M}) ${R}`}case"TodoWrite":{if(C.todos&&Array.isArray(C.todos)){const M=C.todos.filter(J=>J.status==="completed").length,R=C.todos.length,H=C.todos.find(J=>J.status==="in_progress");return H?`Todo: Working on "${H.content}"`:`Todo: ${M}/${R} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const M=C.pattern||"",R=j==="Grep"?"Grep":"Glob";if(L==="completed"&&T&&!T.error){let H=0;return T.content&&(H=T.content.split(`
`).filter(ae=>ae.trim()).length),`${R}: "${M}" (${H} results)`}return`${R}: "${M}"`}case"WebFetch":case"WebSearch":{const M=C.url||C.query||"";if(j==="WebSearch"){const H=C.query||"",J=H.length>50?H.substring(0,50)+"...":H;return L==="completed"&&T?T.error?`Web: ${J} (error)`:`Web: ${J} (success)`:`Web: ${J}`}let R="";try{M&&(R=new URL(M.startsWith("http")?M:`https://${M}`).hostname)}catch{R=M.length>50?M.substring(0,50)+"...":M}return L==="completed"&&T?T.error?`Web: ${R} (error)`:`Web: ${R} (success)`:`Web: ${R||M}`}case"NotebookEdit":{const M=m(C.notebook_path),R=C.cell_number!==void 0?C.cell_number:"?",H=C.edit_mode||"replace";return`NotebookEdit: ${M} cell #${R} (${H})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${C.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${C.shell_id||"unknown"}`;default:return`${j}: executed`}}),k=y(()=>{const j=e.toolCall.name,C=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(j)?C.command||j:["Edit","Read","Write","NotebookEdit"].includes(j)&&(C.file_path||C.notebook_path)||j});function A(){const j=o.currentSessionId;j&&t.toggleToolExpansion(j,e.toolCall.id)}function B(j){return j.type==="setMode"?`Set permission mode to "${j.mode}"`:j.type==="allow"?`Allow tool: ${j.tool}`:JSON.stringify(j)}async function Z(j,C,T=null){if(!a.value){a.value=!0,j==="allow"?r.value=C?"approve-apply":"approve":T?r.value="deny-guidance":r.value="deny";try{const L=o.currentSessionId;if(L){const M=C&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(L,{request_id:e.toolCall.permissionRequestId,decision:j,reasoning:j==="allow"?"User allowed permission":"User denied permission",applied_updates:M})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,j,C,T)}catch(L){console.error("Failed to send permission response:",L)}finally{a.value=!1,r.value=null}}}return(j,C)=>(p(),v("div",{class:z(["tool-call-card card",g.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:A},[s("div",hu,[s("span",_u,w(h.value),1),s("span",{class:"tool-name",title:k.value},w(x.value),9,gu)]),s("div",bu,[s("small",yu,w(b.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},w(n.toolCall.isExpanded?"â–¾":"â–¸"),9,$u)])]),n.toolCall.isExpanded?(p(),v("div",wu,[f.value?(p(),v("div",Eu,[s("div",Cu,[C[6]||(C[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[C[5]||(C[5]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Su,w(_.value?.message||"Session was terminated"),1)])])])):N("",!0),(p(),_e(oo($.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!f.value?(p(),v("div",Tu,[s("div",ku,[C[9]||(C[9]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",xu,[C[7]||(C[7]=te("Claude wants to use the ",-1)),s("code",Au,w(n.toolCall.name),1),C[8]||(C[8]=te(" tool.",-1))])]),u.value?(p(),v("div",Mu,[s("div",Ou,[C[10]||(C[10]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),C[11]||(C[11]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Nu,[(p(!0),v(re,null,de(n.toolCall.suggestions,(T,L)=>(p(),v("div",{key:L,class:"suggestion-item"},[s("code",null,w(B(T)),1)]))),128))]),C[12]||(C[12]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):N("",!0),s("div",Du,[u.value?(p(),v("button",{key:0,class:"btn btn-success",onClick:C[0]||(C[0]=T=>Z("allow",!0)),disabled:a.value},w(a.value&&r.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Lu)):N("",!0),s("button",{class:z(["btn",u.value?"btn-outline-success":"btn-success"]),onClick:C[1]||(C[1]=T=>Z("allow",!1)),disabled:a.value},w(a.value&&r.value==="approve"?"â³ Submitting...":u.value?"âœ… Approve Only":"âœ… Approve"),11,Iu),s("button",{class:"btn btn-danger",onClick:C[2]||(C[2]=T=>Z("deny",!1)),disabled:a.value}," ðŸš« "+w(a.value&&r.value==="deny"?"Submitting...":"Deny"),9,Pu)]),s("div",ju,[C[13]||(C[13]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),C[14]||(C[14]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ne(s("textarea",{"onUpdate:modelValue":C[3]||(C[3]=T=>c.value=T),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Ru),[[me,c.value]]),c.value.trim()?(p(),v("button",{key:0,class:"btn btn-warning btn-sm",onClick:C[4]||(C[4]=T=>Z("deny",!1,c.value)),disabled:a.value},w(a.value&&r.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Hu)):N("",!0)])])):N("",!0),n.toolCall.status==="permission_required"&&f.value?(p(),v("div",Vu,[s("div",Wu,[s("div",Fu,[C[16]||(C[16]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[C[15]||(C[15]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Uu,w(_.value?.message||"Session was terminated before permission could be granted"),1)])])])])):N("",!0),n.toolCall.permissionDecision==="deny"?(p(),v("div",Bu,[s("div",qu,[C[17]||(C[17]=te(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(p(),v("span",zu," - "+w(n.toolCall.result.message),1)):N("",!0)])])):N("",!0)])):N("",!0)],2))}},yn=G(Ku,[["__scopeId","data-v-a277c2a3"]]),Gu={class:"tool-footer-container"},Yu={key:0,class:"active-tools-area"},Ju=["aria-label","onKeydown"],Xu={class:"footer-left"},Qu={class:"footer-text"},Zu={class:"footer-middle"},ed={class:"footer-text"},td={class:"footer-right"},sd={class:"expand-icon"},nd={key:1,class:"tool-footer-expanded"},od={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Oe(),o=ie(),i=D(!1);function a(h){return h.map((b,d)=>({tool:b,originalIndex:d})).sort((b,d)=>{if(b.tool.timestamp&&d.tool.timestamp){const u=new Date(b.tool.timestamp).getTime(),m=new Date(d.tool.timestamp).getTime();if(u!==m)return u-m}return b.originalIndex-d.originalIndex}).map(({tool:b})=>b)}const r=y(()=>{const h=e.tools.filter(b=>b.status==="executing"||b.status==="permission_required");return a(h)}),c=y(()=>{const h=e.tools.filter(b=>b.status!=="executing"&&b.status!=="permission_required");return a(h)}),f=y(()=>{const h=new Map;e.tools.forEach(E=>{const S=h.get(E.name)||0;h.set(E.name,S+1)});const b=Array.from(h.entries()).sort((E,S)=>S[1]-E[1]),d=b.slice(0,5),u=b.length-d.length,m=d.map(([E,S])=>`${E} (${S})`).join(", ");return u>0?`${m}, +${u} more`:m}),_=y(()=>{const h=e.tools.length;let b=0,d=0,u=0;e.tools.forEach(O=>{const I=o.currentSessionId;(I?t.isToolUseOrphaned(I,O.id):!1)?u++:O.status==="completed"&&!O.result?.error&&O.permissionDecision!=="deny"?b++:(O.status==="error"||O.result?.error||O.permissionDecision==="deny")&&d++});let m=[];b>0&&m.push(`${b} âœ…`),d>0&&m.push(`${d} âŒ`),u>0&&m.push(`${u} â¹ï¸`);const E=h===1?"tool":"tools",S=m.length>0?": "+m.join(" "):"";return`${h} ${E}${S}`}),l=y(()=>i.value?"â–²":"â–¼"),$=y(()=>{const h=o.currentSessionId,b=e.tools.some(E=>E.status==="error"||E.result?.error||E.permissionDecision==="deny"),d=e.tools.some(E=>h?t.isToolUseOrphaned(h,E.id):!1),u=r.value.length>0,m=e.tools.every(E=>!(h?t.isToolUseOrphaned(h,E.id):!1)&&E.status==="completed"&&!E.result?.error&&E.permissionDecision!=="deny");return b?"footer-status-error":d?"footer-status-orphaned":u?"footer-status-in-progress":m?"footer-status-success":""});function g(){i.value=!i.value}return(h,b)=>(p(),v("div",Gu,[r.value.length>0?(p(),v("div",Yu,[(p(!0),v(re,null,de(r.value,d=>(p(),_e(yn,{key:d.id,toolCall:d},null,8,["toolCall"]))),128))])):N("",!0),s("div",{class:z(["tool-footer-summary",$.value]),onClick:g,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Mt(g,["enter"]),Mt(Ee(g,["prevent"]),["space"])]},[s("div",Xu,[s("span",Qu,"Used: "+w(f.value),1)]),s("div",Zu,[b[0]||(b[0]=s("span",{class:"footer-separator"},"|",-1)),s("span",ed,w(_.value),1)]),s("div",td,[s("span",sd,w(l.value),1)])],42,Ju),i.value?(p(),v("div",nd,[(p(!0),v(re,null,de(c.value,d=>(p(),_e(yn,{key:d.id,toolCall:d},null,8,["toolCall"]))),128))])):N("",!0)]))}},id=G(od,[["__scopeId","data-v-2d50a8e0"]]),ad={class:"message-row message-row-assistant"},rd=["title"],ld={class:"message-content-column"},cd={key:0,class:"thinking-block mb-2"},ud=["innerHTML"],dd={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Oe(),o=ie();et.setOptions({breaks:!0,gfm:!0});const i=y(()=>Dt(e.message.timestamp)),a=y(()=>e.message.metadata?.model||null),r=y(()=>{const b=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${b}`}),c=y(()=>{const b=e.message.content||"";return b.trim().length>0&&b!=="Assistant response"}),f=y(()=>{const b=e.message.content||"";let d=et.parse(b);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),ns.sanitize(d)}),_=y(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),l=y(()=>e.message.metadata?.thinking_content||""),$=y(()=>{const b=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,d=e.attachedTools&&e.attachedTools.length>0;return b||d}),g=y(()=>{const b=e.message.metadata?.tool_uses||[],d=e.attachedTools||[],u=[...b],m=new Set(b.map(E=>E.id));for(const E of d)m.has(E.id)||u.push(E);return u}),h=y(()=>{const b=o.currentSessionId;if(!b)return[];const d=t.toolCallsBySession.get(b)||[];return g.value.map(u=>{const m=d.find(E=>E.id===u.id);return m||{id:u.id,name:u.name,input:u.input,status:"pending",result:null,timestamp:u.timestamp||e.message.timestamp,isExpanded:!0}})});return(b,d)=>(p(),v("div",ad,[s("div",{class:"message-speaker",title:r.value},[...d[0]||(d[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,rd),s("div",ld,[_.value?(p(),v("div",cd,[ue(da,{thinking:l.value},null,8,["thinking"])])):N("",!0),c.value?(p(),v("div",{key:1,class:"message-text",innerHTML:f.value},null,8,ud)):N("",!0),$.value?(p(),_e(id,{key:2,tools:h.value},null,8,["tools"])):N("",!0)])]))}},md=G(dd,[["__scopeId","data-v-2e32f6ef"]]),pd={key:0,class:"message-row message-row-compaction"},fd=["title"],vd={class:"message-content-column"},hd={class:"compaction-status-content"},_d={class:"text-muted ms-auto"},gd={key:1,class:"message-row message-row-system"},bd=["title"],yd={class:"message-content-column"},$d={class:"system-text"},wd={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>Dt(e.message.timestamp)),o=y(()=>`system
${t.value}`),i=y(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,r)=>i.value?(p(),v("div",pd,[s("div",{class:"message-speaker",title:o.value},[...r[0]||(r[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,fd),s("div",vd,[s("div",hd,[r[1]||(r[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),r[2]||(r[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",_d,w(t.value),1)])])])):(p(),v("div",gd,[s("div",{class:"message-speaker",title:o.value},[...r[3]||(r[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,bd),s("div",yd,[s("span",$d,w(n.message.content),1)])]))}},$n=G(wd,[["__scopeId","data-v-a078178f"]]),Ed={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=y(()=>{switch(e.message.type){case"user":return oa;case"assistant":return md;case"system":return $n;default:return $n}});return(o,i)=>(p(),_e(oo(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Cd=G(Ed,[["__scopeId","data-v-11dff525"]]);var be="top",Ce="bottom",Se="right",ye="left",os="auto",$t=[be,Ce,Se,ye],tt="start",pt="end",ro="clippingParents",Vs="viewport",ct="popper",lo="reference",Ds=$t.reduce(function(n,e){return n.concat([e+"-"+tt,e+"-"+pt])},[]),Ws=[].concat($t,[os]).reduce(function(n,e){return n.concat([e,e+"-"+tt,e+"-"+pt])},[]),co="beforeRead",uo="read",mo="afterRead",po="beforeMain",fo="main",vo="afterMain",ho="beforeWrite",_o="write",go="afterWrite",bo=[co,uo,mo,po,fo,vo,ho,_o,go];function Ie(n){return n?(n.nodeName||"").toLowerCase():null}function Te(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function st(n){var e=Te(n).Element;return n instanceof e||n instanceof Element}function ke(n){var e=Te(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Fs(n){if(typeof ShadowRoot>"u")return!1;var e=Te(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Sd(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!ke(a)||!Ie(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var c=i[r];c===!1?a.removeAttribute(r):a.setAttribute(r,c===!0?"":c)}))})}function Td(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),c=r.reduce(function(f,_){return f[_]="",f},{});!ke(i)||!Ie(i)||(Object.assign(i.style,c),Object.keys(a).forEach(function(f){i.removeAttribute(f)}))})}}const Us={name:"applyStyles",enabled:!0,phase:"write",fn:Sd,effect:Td,requires:["computeStyles"]};function De(n){return n.split("-")[0]}var Ze=Math.max,Zt=Math.min,ft=Math.round;function Ls(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function yo(){return!/^((?!chrome|android).)*safari/i.test(Ls())}function vt(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&ke(n)&&(i=n.offsetWidth>0&&ft(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&ft(o.height)/n.offsetHeight||1);var r=st(n)?Te(n):window,c=r.visualViewport,f=!yo()&&t,_=(o.left+(f&&c?c.offsetLeft:0))/i,l=(o.top+(f&&c?c.offsetTop:0))/a,$=o.width/i,g=o.height/a;return{width:$,height:g,top:l,right:_+$,bottom:l+g,left:_,x:_,y:l}}function Bs(n){var e=vt(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function $o(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Fs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function He(n){return Te(n).getComputedStyle(n)}function kd(n){return["table","td","th"].indexOf(Ie(n))>=0}function Ke(n){return((st(n)?n.ownerDocument:n.document)||window.document).documentElement}function is(n){return Ie(n)==="html"?n:n.assignedSlot||n.parentNode||(Fs(n)?n.host:null)||Ke(n)}function wn(n){return!ke(n)||He(n).position==="fixed"?null:n.offsetParent}function xd(n){var e=/firefox/i.test(Ls()),t=/Trident/i.test(Ls());if(t&&ke(n)){var o=He(n);if(o.position==="fixed")return null}var i=is(n);for(Fs(i)&&(i=i.host);ke(i)&&["html","body"].indexOf(Ie(i))<0;){var a=He(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Lt(n){for(var e=Te(n),t=wn(n);t&&kd(t)&&He(t).position==="static";)t=wn(t);return t&&(Ie(t)==="html"||Ie(t)==="body"&&He(t).position==="static")?e:t||xd(n)||e}function qs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function xt(n,e,t){return Ze(n,Zt(e,t))}function Ad(n,e,t){var o=xt(n,e,t);return o>t?t:o}function wo(){return{top:0,right:0,bottom:0,left:0}}function Eo(n){return Object.assign({},wo(),n)}function Co(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Md=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Eo(typeof e!="number"?e:Co(e,$t))};function Od(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,r=t.modifiersData.popperOffsets,c=De(t.placement),f=qs(c),_=[ye,Se].indexOf(c)>=0,l=_?"height":"width";if(!(!a||!r)){var $=Md(i.padding,t),g=Bs(a),h=f==="y"?be:ye,b=f==="y"?Ce:Se,d=t.rects.reference[l]+t.rects.reference[f]-r[f]-t.rects.popper[l],u=r[f]-t.rects.reference[f],m=Lt(a),E=m?f==="y"?m.clientHeight||0:m.clientWidth||0:0,S=d/2-u/2,O=$[h],I=E-g[l]-$[b],x=E/2-g[l]/2+S,k=xt(O,x,I),A=f;t.modifiersData[o]=(e={},e[A]=k,e.centerOffset=k-x,e)}}function Nd(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||$o(e.elements.popper,i)&&(e.elements.arrow=i))}const So={name:"arrow",enabled:!0,phase:"main",fn:Od,effect:Nd,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ht(n){return n.split("-")[1]}var Dd={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ld(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:ft(t*i)/i||0,y:ft(o*i)/i||0}}function En(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,r=n.offsets,c=n.position,f=n.gpuAcceleration,_=n.adaptive,l=n.roundOffsets,$=n.isFixed,g=r.x,h=g===void 0?0:g,b=r.y,d=b===void 0?0:b,u=typeof l=="function"?l({x:h,y:d}):{x:h,y:d};h=u.x,d=u.y;var m=r.hasOwnProperty("x"),E=r.hasOwnProperty("y"),S=ye,O=be,I=window;if(_){var x=Lt(t),k="clientHeight",A="clientWidth";if(x===Te(t)&&(x=Ke(t),He(x).position!=="static"&&c==="absolute"&&(k="scrollHeight",A="scrollWidth")),x=x,i===be||(i===ye||i===Se)&&a===pt){O=Ce;var B=$&&x===I&&I.visualViewport?I.visualViewport.height:x[k];d-=B-o.height,d*=f?1:-1}if(i===ye||(i===be||i===Ce)&&a===pt){S=Se;var Z=$&&x===I&&I.visualViewport?I.visualViewport.width:x[A];h-=Z-o.width,h*=f?1:-1}}var j=Object.assign({position:c},_&&Dd),C=l===!0?Ld({x:h,y:d},Te(t)):{x:h,y:d};if(h=C.x,d=C.y,f){var T;return Object.assign({},j,(T={},T[O]=E?"0":"",T[S]=m?"0":"",T.transform=(I.devicePixelRatio||1)<=1?"translate("+h+"px, "+d+"px)":"translate3d("+h+"px, "+d+"px, 0)",T))}return Object.assign({},j,(e={},e[O]=E?d+"px":"",e[S]=m?h+"px":"",e.transform="",e))}function Id(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,r=a===void 0?!0:a,c=t.roundOffsets,f=c===void 0?!0:c,_={placement:De(e.placement),variation:ht(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,En(Object.assign({},_,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:f})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,En(Object.assign({},_,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const zs={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Id,data:{}};var Ft={passive:!0};function Pd(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,c=r===void 0?!0:r,f=Te(e.elements.popper),_=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&_.forEach(function(l){l.addEventListener("scroll",t.update,Ft)}),c&&f.addEventListener("resize",t.update,Ft),function(){a&&_.forEach(function(l){l.removeEventListener("scroll",t.update,Ft)}),c&&f.removeEventListener("resize",t.update,Ft)}}const Ks={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Pd,data:{}};var jd={left:"right",right:"left",bottom:"top",top:"bottom"};function Yt(n){return n.replace(/left|right|bottom|top/g,function(e){return jd[e]})}var Rd={start:"end",end:"start"};function Cn(n){return n.replace(/start|end/g,function(e){return Rd[e]})}function Gs(n){var e=Te(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Ys(n){return vt(Ke(n)).left+Gs(n).scrollLeft}function Hd(n,e){var t=Te(n),o=Ke(n),i=t.visualViewport,a=o.clientWidth,r=o.clientHeight,c=0,f=0;if(i){a=i.width,r=i.height;var _=yo();(_||!_&&e==="fixed")&&(c=i.offsetLeft,f=i.offsetTop)}return{width:a,height:r,x:c+Ys(n),y:f}}function Vd(n){var e,t=Ke(n),o=Gs(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=Ze(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=Ze(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),c=-o.scrollLeft+Ys(n),f=-o.scrollTop;return He(i||t).direction==="rtl"&&(c+=Ze(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:c,y:f}}function Js(n){var e=He(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function To(n){return["html","body","#document"].indexOf(Ie(n))>=0?n.ownerDocument.body:ke(n)&&Js(n)?n:To(is(n))}function At(n,e){var t;e===void 0&&(e=[]);var o=To(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=Te(o),r=i?[a].concat(a.visualViewport||[],Js(o)?o:[]):o,c=e.concat(r);return i?c:c.concat(At(is(r)))}function Is(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Wd(n,e){var t=vt(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Sn(n,e,t){return e===Vs?Is(Hd(n,t)):st(e)?Wd(e,t):Is(Vd(Ke(n)))}function Fd(n){var e=At(is(n)),t=["absolute","fixed"].indexOf(He(n).position)>=0,o=t&&ke(n)?Lt(n):n;return st(o)?e.filter(function(i){return st(i)&&$o(i,o)&&Ie(i)!=="body"}):[]}function Ud(n,e,t,o){var i=e==="clippingParents"?Fd(n):[].concat(e),a=[].concat(i,[t]),r=a[0],c=a.reduce(function(f,_){var l=Sn(n,_,o);return f.top=Ze(l.top,f.top),f.right=Zt(l.right,f.right),f.bottom=Zt(l.bottom,f.bottom),f.left=Ze(l.left,f.left),f},Sn(n,r,o));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function ko(n){var e=n.reference,t=n.element,o=n.placement,i=o?De(o):null,a=o?ht(o):null,r=e.x+e.width/2-t.width/2,c=e.y+e.height/2-t.height/2,f;switch(i){case be:f={x:r,y:e.y-t.height};break;case Ce:f={x:r,y:e.y+e.height};break;case Se:f={x:e.x+e.width,y:c};break;case ye:f={x:e.x-t.width,y:c};break;default:f={x:e.x,y:e.y}}var _=i?qs(i):null;if(_!=null){var l=_==="y"?"height":"width";switch(a){case tt:f[_]=f[_]-(e[l]/2-t[l]/2);break;case pt:f[_]=f[_]+(e[l]/2-t[l]/2);break}}return f}function _t(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,r=a===void 0?n.strategy:a,c=t.boundary,f=c===void 0?ro:c,_=t.rootBoundary,l=_===void 0?Vs:_,$=t.elementContext,g=$===void 0?ct:$,h=t.altBoundary,b=h===void 0?!1:h,d=t.padding,u=d===void 0?0:d,m=Eo(typeof u!="number"?u:Co(u,$t)),E=g===ct?lo:ct,S=n.rects.popper,O=n.elements[b?E:g],I=Ud(st(O)?O:O.contextElement||Ke(n.elements.popper),f,l,r),x=vt(n.elements.reference),k=ko({reference:x,element:S,placement:i}),A=Is(Object.assign({},S,k)),B=g===ct?A:x,Z={top:I.top-B.top+m.top,bottom:B.bottom-I.bottom+m.bottom,left:I.left-B.left+m.left,right:B.right-I.right+m.right},j=n.modifiersData.offset;if(g===ct&&j){var C=j[i];Object.keys(Z).forEach(function(T){var L=[Se,Ce].indexOf(T)>=0?1:-1,M=[be,Ce].indexOf(T)>=0?"y":"x";Z[T]+=C[M]*L})}return Z}function Bd(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,r=t.padding,c=t.flipVariations,f=t.allowedAutoPlacements,_=f===void 0?Ws:f,l=ht(o),$=l?c?Ds:Ds.filter(function(b){return ht(b)===l}):$t,g=$.filter(function(b){return _.indexOf(b)>=0});g.length===0&&(g=$);var h=g.reduce(function(b,d){return b[d]=_t(n,{placement:d,boundary:i,rootBoundary:a,padding:r})[De(d)],b},{});return Object.keys(h).sort(function(b,d){return h[b]-h[d]})}function qd(n){if(De(n)===os)return[];var e=Yt(n);return[Cn(n),e,Cn(e)]}function zd(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,c=r===void 0?!0:r,f=t.fallbackPlacements,_=t.padding,l=t.boundary,$=t.rootBoundary,g=t.altBoundary,h=t.flipVariations,b=h===void 0?!0:h,d=t.allowedAutoPlacements,u=e.options.placement,m=De(u),E=m===u,S=f||(E||!b?[Yt(u)]:qd(u)),O=[u].concat(S).reduce(function(q,le){return q.concat(De(le)===os?Bd(e,{placement:le,boundary:l,rootBoundary:$,padding:_,flipVariations:b,allowedAutoPlacements:d}):le)},[]),I=e.rects.reference,x=e.rects.popper,k=new Map,A=!0,B=O[0],Z=0;Z<O.length;Z++){var j=O[Z],C=De(j),T=ht(j)===tt,L=[be,Ce].indexOf(C)>=0,M=L?"width":"height",R=_t(e,{placement:j,boundary:l,rootBoundary:$,altBoundary:g,padding:_}),H=L?T?Se:ye:T?Ce:be;I[M]>x[M]&&(H=Yt(H));var J=Yt(H),ae=[];if(a&&ae.push(R[C]<=0),c&&ae.push(R[H]<=0,R[J]<=0),ae.every(function(q){return q})){B=j,A=!1;break}k.set(j,ae)}if(A)for(var U=b?3:1,W=function(le){var V=O.find(function(F){var K=k.get(F);if(K)return K.slice(0,le).every(function(X){return X})});if(V)return B=V,"break"},se=U;se>0;se--){var ee=W(se);if(ee==="break")break}e.placement!==B&&(e.modifiersData[o]._skip=!0,e.placement=B,e.reset=!0)}}const xo={name:"flip",enabled:!0,phase:"main",fn:zd,requiresIfExists:["offset"],data:{_skip:!1}};function Tn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function kn(n){return[be,Se,Ce,ye].some(function(e){return n[e]>=0})}function Kd(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=_t(e,{elementContext:"reference"}),c=_t(e,{altBoundary:!0}),f=Tn(r,o),_=Tn(c,i,a),l=kn(f),$=kn(_);e.modifiersData[t]={referenceClippingOffsets:f,popperEscapeOffsets:_,isReferenceHidden:l,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":l,"data-popper-escaped":$})}const Ao={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Kd};function Gd(n,e,t){var o=De(n),i=[ye,be].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,r=a[0],c=a[1];return r=r||0,c=(c||0)*i,[ye,Se].indexOf(o)>=0?{x:c,y:r}:{x:r,y:c}}function Yd(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,r=Ws.reduce(function(l,$){return l[$]=Gd($,e.rects,a),l},{}),c=r[e.placement],f=c.x,_=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=f,e.modifiersData.popperOffsets.y+=_),e.modifiersData[o]=r}const Mo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Yd};function Jd(n){var e=n.state,t=n.name;e.modifiersData[t]=ko({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Xs={name:"popperOffsets",enabled:!0,phase:"read",fn:Jd,data:{}};function Xd(n){return n==="x"?"y":"x"}function Qd(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,c=r===void 0?!1:r,f=t.boundary,_=t.rootBoundary,l=t.altBoundary,$=t.padding,g=t.tether,h=g===void 0?!0:g,b=t.tetherOffset,d=b===void 0?0:b,u=_t(e,{boundary:f,rootBoundary:_,padding:$,altBoundary:l}),m=De(e.placement),E=ht(e.placement),S=!E,O=qs(m),I=Xd(O),x=e.modifiersData.popperOffsets,k=e.rects.reference,A=e.rects.popper,B=typeof d=="function"?d(Object.assign({},e.rects,{placement:e.placement})):d,Z=typeof B=="number"?{mainAxis:B,altAxis:B}:Object.assign({mainAxis:0,altAxis:0},B),j=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,C={x:0,y:0};if(x){if(a){var T,L=O==="y"?be:ye,M=O==="y"?Ce:Se,R=O==="y"?"height":"width",H=x[O],J=H+u[L],ae=H-u[M],U=h?-A[R]/2:0,W=E===tt?k[R]:A[R],se=E===tt?-A[R]:-k[R],ee=e.elements.arrow,q=h&&ee?Bs(ee):{width:0,height:0},le=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:wo(),V=le[L],F=le[M],K=xt(0,k[R],q[R]),X=S?k[R]/2-U-K-V-Z.mainAxis:W-K-V-Z.mainAxis,Q=S?-k[R]/2+U+K+F+Z.mainAxis:se+K+F+Z.mainAxis,ve=e.elements.arrow&&Lt(e.elements.arrow),St=ve?O==="y"?ve.clientTop||0:ve.clientLeft||0:0,Vt=(T=j?.[O])!=null?T:0,ci=H+X-Vt-St,ui=H+Q-Vt,an=xt(h?Zt(J,ci):J,H,h?Ze(ae,ui):ae);x[O]=an,C[O]=an-H}if(c){var rn,di=O==="x"?be:ye,mi=O==="x"?Ce:Se,Je=x[I],Wt=I==="y"?"height":"width",ln=Je+u[di],cn=Je-u[mi],ms=[be,ye].indexOf(m)!==-1,un=(rn=j?.[I])!=null?rn:0,dn=ms?ln:Je-k[Wt]-A[Wt]-un+Z.altAxis,mn=ms?Je+k[Wt]+A[Wt]-un-Z.altAxis:cn,pn=h&&ms?Ad(dn,Je,mn):xt(h?dn:ln,Je,h?mn:cn);x[I]=pn,C[I]=pn-Je}e.modifiersData[o]=C}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:Qd,requiresIfExists:["offset"]};function Zd(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function em(n){return n===Te(n)||!ke(n)?Gs(n):Zd(n)}function tm(n){var e=n.getBoundingClientRect(),t=ft(e.width)/n.offsetWidth||1,o=ft(e.height)/n.offsetHeight||1;return t!==1||o!==1}function sm(n,e,t){t===void 0&&(t=!1);var o=ke(e),i=ke(e)&&tm(e),a=Ke(e),r=vt(n,i,t),c={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(o||!o&&!t)&&((Ie(e)!=="body"||Js(a))&&(c=em(e)),ke(e)?(f=vt(e,!0),f.x+=e.clientLeft,f.y+=e.clientTop):a&&(f.x=Ys(a))),{x:r.left+c.scrollLeft-f.x,y:r.top+c.scrollTop-f.y,width:r.width,height:r.height}}function nm(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(c){if(!t.has(c)){var f=e.get(c);f&&i(f)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function om(n){var e=nm(n);return bo.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function im(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function am(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var xn={placement:"bottom",modifiers:[],strategy:"absolute"};function An(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function as(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?xn:i;return function(c,f,_){_===void 0&&(_=a);var l={placement:"bottom",orderedModifiers:[],options:Object.assign({},xn,a),modifiersData:{},elements:{reference:c,popper:f},attributes:{},styles:{}},$=[],g=!1,h={state:l,setOptions:function(m){var E=typeof m=="function"?m(l.options):m;d(),l.options=Object.assign({},a,l.options,E),l.scrollParents={reference:st(c)?At(c):c.contextElement?At(c.contextElement):[],popper:At(f)};var S=om(am([].concat(o,l.options.modifiers)));return l.orderedModifiers=S.filter(function(O){return O.enabled}),b(),h.update()},forceUpdate:function(){if(!g){var m=l.elements,E=m.reference,S=m.popper;if(An(E,S)){l.rects={reference:sm(E,Lt(S),l.options.strategy==="fixed"),popper:Bs(S)},l.reset=!1,l.placement=l.options.placement,l.orderedModifiers.forEach(function(Z){return l.modifiersData[Z.name]=Object.assign({},Z.data)});for(var O=0;O<l.orderedModifiers.length;O++){if(l.reset===!0){l.reset=!1,O=-1;continue}var I=l.orderedModifiers[O],x=I.fn,k=I.options,A=k===void 0?{}:k,B=I.name;typeof x=="function"&&(l=x({state:l,options:A,name:B,instance:h})||l)}}}},update:im(function(){return new Promise(function(u){h.forceUpdate(),u(l)})}),destroy:function(){d(),g=!0}};if(!An(c,f))return h;h.setOptions(_).then(function(u){!g&&_.onFirstUpdate&&_.onFirstUpdate(u)});function b(){l.orderedModifiers.forEach(function(u){var m=u.name,E=u.options,S=E===void 0?{}:E,O=u.effect;if(typeof O=="function"){var I=O({state:l,name:m,instance:h,options:S}),x=function(){};$.push(I||x)}})}function d(){$.forEach(function(u){return u()}),$=[]}return h}}var rm=as(),lm=[Ks,Xs,zs,Us],cm=as({defaultModifiers:lm}),um=[Ks,Xs,zs,Us,Mo,xo,Oo,So,Ao],Qs=as({defaultModifiers:um});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:vo,afterRead:mo,afterWrite:go,applyStyles:Us,arrow:So,auto:os,basePlacements:$t,beforeMain:po,beforeRead:co,beforeWrite:ho,bottom:Ce,clippingParents:ro,computeStyles:zs,createPopper:Qs,createPopperBase:rm,createPopperLite:cm,detectOverflow:_t,end:pt,eventListeners:Ks,flip:xo,hide:Ao,left:ye,main:fo,modifierPhases:bo,offset:Mo,placements:Ws,popper:ct,popperGenerator:as,popperOffsets:Xs,preventOverflow:Oo,read:uo,reference:lo,right:Se,start:tt,top:be,variationPlacements:Ds,viewport:Vs,write:_o},Symbol.toStringTag,{value:"Module"}));const Fe=new Map,hs={set(n,e,t){Fe.has(n)||Fe.set(n,new Map);const o=Fe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Fe.has(n)&&Fe.get(n).get(e)||null},remove(n,e){if(!Fe.has(n))return;const t=Fe.get(n);t.delete(e),t.size===0&&Fe.delete(n)}},dm=1e6,mm=1e3,Ps="transitionend",Do=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),pm=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),fm=n=>{do n+=Math.floor(Math.random()*dm);while(document.getElementById(n));return n},vm=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*mm)},Lo=n=>{n.dispatchEvent(new Event(Ps))},Pe=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Be=n=>Pe(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Do(n)):null,wt=n=>{if(!Pe(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},qe=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Io=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Io(n.parentNode):null},es=()=>{},It=n=>{n.offsetHeight},Po=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_s=[],hm=n=>{document.readyState==="loading"?(_s.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of _s)e()}),_s.push(n)):n()},xe=()=>document.documentElement.dir==="rtl",Me=n=>{hm(()=>{const e=Po();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},we=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,jo=(n,e,t=!0)=>{if(!t){we(n);return}const i=vm(e)+5;let a=!1;const r=({target:c})=>{c===e&&(a=!0,e.removeEventListener(Ps,r),we(n))};e.addEventListener(Ps,r),setTimeout(()=>{a||Lo(e)},i)},Zs=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},_m=/[^.]*(?=\..*)\.|.*/,gm=/\..*/,bm=/::\d+$/,gs={};let Mn=1;const Ro={mouseenter:"mouseover",mouseleave:"mouseout"},ym=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ho(n,e){return e&&`${e}::${Mn++}`||n.uidEvent||Mn++}function Vo(n){const e=Ho(n);return n.uidEvent=e,gs[e]=gs[e]||{},gs[e]}function $m(n,e){return function t(o){return en(o,{delegateTarget:n}),t.oneOff&&P.off(n,o.type,e),e.apply(n,[o])}}function wm(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const c of a)if(c===r)return en(i,{delegateTarget:r}),o.oneOff&&P.off(n,i.type,e,t),t.apply(r,[i])}}function Wo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Fo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Uo(n);return ym.has(a)||(a=n),[o,i,a]}function On(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,r,c]=Fo(e,t,o);e in Ro&&(r=(b=>function(d){if(!d.relatedTarget||d.relatedTarget!==d.delegateTarget&&!d.delegateTarget.contains(d.relatedTarget))return b.call(this,d)})(r));const f=Vo(n),_=f[c]||(f[c]={}),l=Wo(_,r,a?t:null);if(l){l.oneOff=l.oneOff&&i;return}const $=Ho(r,e.replace(_m,"")),g=a?wm(n,t,r):$m(n,r);g.delegationSelector=a?t:null,g.callable=r,g.oneOff=i,g.uidEvent=$,_[$]=g,n.addEventListener(c,g,a)}function js(n,e,t,o,i){const a=Wo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function Em(n,e,t,o){const i=e[t]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&js(n,e,t,r.callable,r.delegationSelector)}function Uo(n){return n=n.replace(gm,""),Ro[n]||n}const P={on(n,e,t,o){On(n,e,t,o,!1)},one(n,e,t,o){On(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,r]=Fo(e,t,o),c=r!==e,f=Vo(n),_=f[r]||{},l=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(_).length)return;js(n,f,r,a,i?t:null);return}if(l)for(const $ of Object.keys(f))Em(n,f,$,e.slice(1));for(const[$,g]of Object.entries(_)){const h=$.replace(bm,"");(!c||e.includes(h))&&js(n,f,r,g.callable,g.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Po(),i=Uo(e),a=e!==i;let r=null,c=!0,f=!0,_=!1;a&&o&&(r=o.Event(e,t),o(n).trigger(r),c=!r.isPropagationStopped(),f=!r.isImmediatePropagationStopped(),_=r.isDefaultPrevented());const l=en(new Event(e,{bubbles:c,cancelable:!0}),t);return _&&l.preventDefault(),f&&n.dispatchEvent(l),l.defaultPrevented&&r&&r.preventDefault(),l}};function en(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function Nn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function bs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const je={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${bs(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${bs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Nn(n.dataset[o])}return e},getDataAttribute(n,e){return Nn(n.getAttribute(`data-bs-${bs(e)}`))}};class Pt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Pe(t)?je.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Pe(t)?je.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],r=Pe(a)?"element":pm(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const Cm="5.3.8";class Ne extends Pt{constructor(e,t){super(),e=Be(e),e&&(this._element=e,this._config=this._getConfig(t),hs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){hs.remove(this._element,this.constructor.DATA_KEY),P.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){jo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return hs.get(Be(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Cm}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const ys=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Do(t)).join(","):null},Y={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!qe(t)&&wt(t))},getSelectorFromElement(n){const e=ys(n);return e&&Y.findOne(e)?e:null},getElementFromSelector(n){const e=ys(n);return e?Y.findOne(e):null},getMultipleElementsFromSelector(n){const e=ys(n);return e?Y.find(e):[]}},rs=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;P.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),qe(this))return;const a=Y.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},Sm="alert",Tm="bs.alert",Bo=`.${Tm}`,km=`close${Bo}`,xm=`closed${Bo}`,Am="fade",Mm="show";class ls extends Ne{static get NAME(){return Sm}close(){if(P.trigger(this._element,km).defaultPrevented)return;this._element.classList.remove(Mm);const t=this._element.classList.contains(Am);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),P.trigger(this._element,xm),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ls.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}rs(ls,"close");Me(ls);const Om="button",Nm="bs.button",Dm=`.${Nm}`,Lm=".data-api",Im="active",Dn='[data-bs-toggle="button"]',Pm=`click${Dm}${Lm}`;class cs extends Ne{static get NAME(){return Om}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Im))}static jQueryInterface(e){return this.each(function(){const t=cs.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}P.on(document,Pm,Dn,n=>{n.preventDefault();const e=n.target.closest(Dn);cs.getOrCreateInstance(e).toggle()});Me(cs);const jm="swipe",Et=".bs.swipe",Rm=`touchstart${Et}`,Hm=`touchmove${Et}`,Vm=`touchend${Et}`,Wm=`pointerdown${Et}`,Fm=`pointerup${Et}`,Um="touch",Bm="pen",qm="pointer-event",zm=40,Km={endCallback:null,leftCallback:null,rightCallback:null},Gm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class ts extends Pt{constructor(e,t){super(),this._element=e,!(!e||!ts.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Km}static get DefaultType(){return Gm}static get NAME(){return jm}dispose(){P.off(this._element,Et)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),we(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=zm)return;const t=e/this._deltaX;this._deltaX=0,t&&we(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(P.on(this._element,Wm,e=>this._start(e)),P.on(this._element,Fm,e=>this._end(e)),this._element.classList.add(qm)):(P.on(this._element,Rm,e=>this._start(e)),P.on(this._element,Hm,e=>this._move(e)),P.on(this._element,Vm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Bm||e.pointerType===Um)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Ym="carousel",Jm="bs.carousel",Ge=`.${Jm}`,qo=".data-api",Xm="ArrowLeft",Qm="ArrowRight",Zm=500,Tt="next",rt="prev",ut="left",Jt="right",ep=`slide${Ge}`,$s=`slid${Ge}`,tp=`keydown${Ge}`,sp=`mouseenter${Ge}`,np=`mouseleave${Ge}`,op=`dragstart${Ge}`,ip=`load${Ge}${qo}`,ap=`click${Ge}${qo}`,zo="carousel",Ut="active",rp="slide",lp="carousel-item-end",cp="carousel-item-start",up="carousel-item-next",dp="carousel-item-prev",Ko=".active",Go=".carousel-item",mp=Ko+Go,pp=".carousel-item img",fp=".carousel-indicators",vp="[data-bs-slide], [data-bs-slide-to]",hp='[data-bs-ride="carousel"]',_p={[Xm]:Jt,[Qm]:ut},gp={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},bp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class jt extends Ne{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Y.findOne(fp,this._element),this._addEventListeners(),this._config.ride===zo&&this.cycle()}static get Default(){return gp}static get DefaultType(){return bp}static get NAME(){return Ym}next(){this._slide(Tt)}nextWhenVisible(){!document.hidden&&wt(this._element)&&this.next()}prev(){this._slide(rt)}pause(){this._isSliding&&Lo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){P.one(this._element,$s,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){P.one(this._element,$s,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Tt:rt;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&P.on(this._element,tp,e=>this._keydown(e)),this._config.pause==="hover"&&(P.on(this._element,sp,()=>this.pause()),P.on(this._element,np,()=>this._maybeEnableCycle())),this._config.touch&&ts.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of Y.find(pp,this._element))P.on(o,op,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(ut)),rightCallback:()=>this._slide(this._directionToOrder(Jt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Zm+this._config.interval))}};this._swipeHelper=new ts(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=_p[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=Y.findOne(Ko,this._indicatorsElement);t.classList.remove(Ut),t.removeAttribute("aria-current");const o=Y.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Ut),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===Tt,a=t||Zs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),c=h=>P.trigger(this._element,h,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(c(ep).defaultPrevented||!o||!a)return;const _=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const l=i?cp:lp,$=i?up:dp;a.classList.add($),It(a),o.classList.add(l),a.classList.add(l);const g=()=>{a.classList.remove(l,$),a.classList.add(Ut),o.classList.remove(Ut,$,l),this._isSliding=!1,c($s)};this._queueCallback(g,o,this._isAnimated()),_&&this.cycle()}_isAnimated(){return this._element.classList.contains(rp)}_getActive(){return Y.findOne(mp,this._element)}_getItems(){return Y.find(Go,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return xe()?e===ut?rt:Tt:e===ut?Tt:rt}_orderToDirection(e){return xe()?e===rt?ut:Jt:e===rt?Jt:ut}static jQueryInterface(e){return this.each(function(){const t=jt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}P.on(document,ap,vp,function(n){const e=Y.getElementFromSelector(this);if(!e||!e.classList.contains(zo))return;n.preventDefault();const t=jt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(je.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});P.on(window,ip,()=>{const n=Y.find(hp);for(const e of n)jt.getOrCreateInstance(e)});Me(jt);const yp="collapse",$p="bs.collapse",Rt=`.${$p}`,wp=".data-api",Ep=`show${Rt}`,Cp=`shown${Rt}`,Sp=`hide${Rt}`,Tp=`hidden${Rt}`,kp=`click${Rt}${wp}`,ws="show",mt="collapse",Bt="collapsing",xp="collapsed",Ap=`:scope .${mt} .${mt}`,Mp="collapse-horizontal",Op="width",Np="height",Dp=".collapse.show, .collapse.collapsing",Rs='[data-bs-toggle="collapse"]',Lp={parent:null,toggle:!0},Ip={parent:"(null|element)",toggle:"boolean"};class gt extends Ne{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=Y.find(Rs);for(const i of o){const a=Y.getSelectorFromElement(i),r=Y.find(a).filter(c=>c===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Lp}static get DefaultType(){return Ip}static get NAME(){return yp}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Dp).filter(c=>c!==this._element).map(c=>gt.getOrCreateInstance(c,{toggle:!1}))),e.length&&e[0]._isTransitioning||P.trigger(this._element,Ep).defaultPrevented)return;for(const c of e)c.hide();const o=this._getDimension();this._element.classList.remove(mt),this._element.classList.add(Bt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Bt),this._element.classList.add(mt,ws),this._element.style[o]="",P.trigger(this._element,Cp)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||P.trigger(this._element,Sp).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,It(this._element),this._element.classList.add(Bt),this._element.classList.remove(mt,ws);for(const i of this._triggerArray){const a=Y.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Bt),this._element.classList.add(mt),P.trigger(this._element,Tp)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ws)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Be(e.parent),e}_getDimension(){return this._element.classList.contains(Mp)?Op:Np}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Rs);for(const t of e){const o=Y.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=Y.find(Ap,this._config.parent);return Y.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(xp,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=gt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}P.on(document,kp,Rs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of Y.getMultipleElementsFromSelector(this))gt.getOrCreateInstance(e,{toggle:!1}).toggle()});Me(gt);const Ln="dropdown",Pp="bs.dropdown",it=`.${Pp}`,tn=".data-api",jp="Escape",In="Tab",Rp="ArrowUp",Pn="ArrowDown",Hp=2,Vp=`hide${it}`,Wp=`hidden${it}`,Fp=`show${it}`,Up=`shown${it}`,Yo=`click${it}${tn}`,Jo=`keydown${it}${tn}`,Bp=`keyup${it}${tn}`,dt="show",qp="dropup",zp="dropend",Kp="dropstart",Gp="dropup-center",Yp="dropdown-center",Xe='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Jp=`${Xe}.${dt}`,Xt=".dropdown-menu",Xp=".navbar",Qp=".navbar-nav",Zp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",ef=xe()?"top-end":"top-start",tf=xe()?"top-start":"top-end",sf=xe()?"bottom-end":"bottom-start",nf=xe()?"bottom-start":"bottom-end",of=xe()?"left-start":"right-start",af=xe()?"right-start":"left-start",rf="top",lf="bottom",cf={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},uf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Le extends Ne{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=Y.next(this._element,Xt)[0]||Y.prev(this._element,Xt)[0]||Y.findOne(Xt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return cf}static get DefaultType(){return uf}static get NAME(){return Ln}toggle(){return this._isShown()?this.hide():this.show()}show(){if(qe(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!P.trigger(this._element,Fp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Qp))for(const o of[].concat(...document.body.children))P.on(o,"mouseover",es);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(dt),this._element.classList.add(dt),P.trigger(this._element,Up,e)}}hide(){if(qe(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!P.trigger(this._element,Vp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))P.off(o,"mouseover",es);this._popper&&this._popper.destroy(),this._menu.classList.remove(dt),this._element.classList.remove(dt),this._element.setAttribute("aria-expanded","false"),je.removeDataAttribute(this._menu,"popper"),P.trigger(this._element,Wp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Pe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Ln.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Pe(this._config.reference)?e=Be(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Qs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(dt)}_getPlacement(){const e=this._parent;if(e.classList.contains(zp))return of;if(e.classList.contains(Kp))return af;if(e.classList.contains(Gp))return rf;if(e.classList.contains(Yp))return lf;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(qp)?t?tf:ef:t?nf:sf}_detectNavbar(){return this._element.closest(Xp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(je.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...we(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=Y.find(Zp,this._menu).filter(i=>wt(i));o.length&&Zs(o,t,e===Pn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Le.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===Hp||e.type==="keyup"&&e.key!==In)return;const t=Y.find(Jp);for(const o of t){const i=Le.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===In||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const c={relatedTarget:i._element};e.type==="click"&&(c.clickEvent=e),i._completeHide(c)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===jp,i=[Rp,Pn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(Xe)?this:Y.prev(this,Xe)[0]||Y.next(this,Xe)[0]||Y.findOne(Xe,e.delegateTarget.parentNode),r=Le.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}P.on(document,Jo,Xe,Le.dataApiKeydownHandler);P.on(document,Jo,Xt,Le.dataApiKeydownHandler);P.on(document,Yo,Le.clearMenus);P.on(document,Bp,Le.clearMenus);P.on(document,Yo,Xe,function(n){n.preventDefault(),Le.getOrCreateInstance(this).toggle()});Me(Le);const Xo="backdrop",df="fade",jn="show",Rn=`mousedown.bs.${Xo}`,mf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},pf={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Qo extends Pt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return mf}static get DefaultType(){return pf}static get NAME(){return Xo}show(e){if(!this._config.isVisible){we(e);return}this._append();const t=this._getElement();this._config.isAnimated&&It(t),t.classList.add(jn),this._emulateAnimation(()=>{we(e)})}hide(e){if(!this._config.isVisible){we(e);return}this._getElement().classList.remove(jn),this._emulateAnimation(()=>{this.dispose(),we(e)})}dispose(){this._isAppended&&(P.off(this._element,Rn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(df),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Be(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),P.on(e,Rn,()=>{we(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){jo(e,this._getElement(),this._config.isAnimated)}}const ff="focustrap",vf="bs.focustrap",ss=`.${vf}`,hf=`focusin${ss}`,_f=`keydown.tab${ss}`,gf="Tab",bf="forward",Hn="backward",yf={autofocus:!0,trapElement:null},$f={autofocus:"boolean",trapElement:"element"};class Zo extends Pt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return yf}static get DefaultType(){return $f}static get NAME(){return ff}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),P.off(document,ss),P.on(document,hf,e=>this._handleFocusin(e)),P.on(document,_f,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,P.off(document,ss))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=Y.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Hn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===gf&&(this._lastTabNavDirection=e.shiftKey?Hn:bf)}}const Vn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Wn=".sticky-top",qt="padding-right",Fn="margin-right";class Hs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,qt,t=>t+e),this._setElementAttributes(Vn,qt,t=>t+e),this._setElementAttributes(Wn,Fn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,qt),this._resetElementAttributes(Vn,qt),this._resetElementAttributes(Wn,Fn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const c=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(c))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&je.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=je.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}je.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Pe(e)){t(e);return}for(const o of Y.find(e,this._element))t(o)}}const wf="modal",Ef="bs.modal",Ae=`.${Ef}`,Cf=".data-api",Sf="Escape",Tf=`hide${Ae}`,kf=`hidePrevented${Ae}`,ei=`hidden${Ae}`,ti=`show${Ae}`,xf=`shown${Ae}`,Af=`resize${Ae}`,Mf=`click.dismiss${Ae}`,Of=`mousedown.dismiss${Ae}`,Nf=`keydown.dismiss${Ae}`,Df=`click${Ae}${Cf}`,Un="modal-open",Lf="fade",Bn="show",Es="modal-static",If=".modal.show",Pf=".modal-dialog",jf=".modal-body",Rf='[data-bs-toggle="modal"]',Hf={backdrop:!0,focus:!0,keyboard:!0},Vf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class nt extends Ne{constructor(e,t){super(e,t),this._dialog=Y.findOne(Pf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Hs,this._addEventListeners()}static get Default(){return Hf}static get DefaultType(){return Vf}static get NAME(){return wf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||P.trigger(this._element,ti,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Un),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||P.trigger(this._element,Tf).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Bn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){P.off(window,Ae),P.off(this._dialog,Ae),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Qo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=Y.findOne(jf,this._dialog);t&&(t.scrollTop=0),It(this._element),this._element.classList.add(Bn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,P.trigger(this._element,xf,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){P.on(this._element,Nf,e=>{if(e.key===Sf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),P.on(window,Af,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),P.on(this._element,Of,e=>{P.one(this._element,Mf,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Un),this._resetAdjustments(),this._scrollBar.reset(),P.trigger(this._element,ei)})}_isAnimated(){return this._element.classList.contains(Lf)}_triggerBackdropTransition(){if(P.trigger(this._element,kf).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Es)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Es),this._queueCallback(()=>{this._element.classList.remove(Es),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=xe()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=xe()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=nt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}P.on(document,Df,Rf,function(n){const e=Y.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),P.one(e,ti,i=>{i.defaultPrevented||P.one(e,ei,()=>{wt(this)&&this.focus()})});const t=Y.findOne(If);t&&nt.getInstance(t).hide(),nt.getOrCreateInstance(e).toggle(this)});rs(nt);Me(nt);const Wf="offcanvas",Ff="bs.offcanvas",We=`.${Ff}`,si=".data-api",Uf=`load${We}${si}`,Bf="Escape",qn="show",zn="showing",Kn="hiding",qf="offcanvas-backdrop",ni=".offcanvas.show",zf=`show${We}`,Kf=`shown${We}`,Gf=`hide${We}`,Gn=`hidePrevented${We}`,oi=`hidden${We}`,Yf=`resize${We}`,Jf=`click${We}${si}`,Xf=`keydown.dismiss${We}`,Qf='[data-bs-toggle="offcanvas"]',Zf={backdrop:!0,keyboard:!0,scroll:!1},ev={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ze extends Ne{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Zf}static get DefaultType(){return ev}static get NAME(){return Wf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||P.trigger(this._element,zf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Hs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(qn),this._element.classList.remove(zn),P.trigger(this._element,Kf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||P.trigger(this._element,Gf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Kn),this._backdrop.hide();const t=()=>{this._element.classList.remove(qn,Kn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Hs().reset(),P.trigger(this._element,oi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){P.trigger(this._element,Gn);return}this.hide()},t=!!this._config.backdrop;return new Qo({className:qf,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_addEventListeners(){P.on(this._element,Xf,e=>{if(e.key===Bf){if(this._config.keyboard){this.hide();return}P.trigger(this._element,Gn)}})}static jQueryInterface(e){return this.each(function(){const t=ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}P.on(document,Jf,Qf,function(n){const e=Y.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),qe(this))return;P.one(e,oi,()=>{wt(this)&&this.focus()});const t=Y.findOne(ni);t&&t!==e&&ze.getInstance(t).hide(),ze.getOrCreateInstance(e).toggle(this)});P.on(window,Uf,()=>{for(const n of Y.find(ni))ze.getOrCreateInstance(n).show()});P.on(window,Yf,()=>{for(const n of Y.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&ze.getOrCreateInstance(n).hide()});rs(ze);Me(ze);const tv=/^aria-[\w-]*$/i,ii={"*":["class","dir","id","lang","role",tv],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},sv=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),nv=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,ov=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?sv.has(t)?!!nv.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function iv(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const c=r.nodeName.toLowerCase();if(!Object.keys(e).includes(c)){r.remove();continue}const f=[].concat(...r.attributes),_=[].concat(e["*"]||[],e[c]||[]);for(const l of f)ov(l,_)||r.removeAttribute(l.nodeName)}return i.body.innerHTML}const av="TemplateFactory",rv={allowList:ii,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},lv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},cv={entry:"(string|element|function|null)",selector:"(string|element)"};class uv extends Pt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return rv}static get DefaultType(){return lv}static get NAME(){return av}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},cv)}_setContent(e,t,o){const i=Y.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Pe(t)){this._putElementInTemplate(Be(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?iv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return we(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const dv="tooltip",mv=new Set(["sanitize","allowList","sanitizeFn"]),Cs="fade",pv="modal",zt="show",fv=".tooltip-inner",Yn=`.${pv}`,Jn="hide.bs.modal",kt="hover",Ss="focus",Ts="click",vv="manual",hv="hide",_v="hidden",gv="show",bv="shown",yv="inserted",$v="click",wv="focusin",Ev="focusout",Cv="mouseenter",Sv="mouseleave",Tv={AUTO:"auto",TOP:"top",RIGHT:xe()?"left":"right",BOTTOM:"bottom",LEFT:xe()?"right":"left"},kv={allowList:ii,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},xv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Ct extends Ne{constructor(e,t){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return kv}static get DefaultType(){return xv}static get NAME(){return dv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),P.off(this._element.closest(Yn),Jn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=P.trigger(this._element,this.constructor.eventName(gv)),o=(Io(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),P.trigger(this._element,this.constructor.eventName(yv))),this._popper=this._createPopper(i),i.classList.add(zt),"ontouchstart"in document.documentElement)for(const c of[].concat(...document.body.children))P.on(c,"mouseover",es);const r=()=>{P.trigger(this._element,this.constructor.eventName(bv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||P.trigger(this._element,this.constructor.eventName(hv)).defaultPrevented)return;if(this._getTipElement().classList.remove(zt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))P.off(i,"mouseover",es);this._activeTrigger[Ts]=!1,this._activeTrigger[Ss]=!1,this._activeTrigger[kt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),P.trigger(this._element,this.constructor.eventName(_v)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Cs,zt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=fm(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Cs),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new uv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[fv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Cs)}_isShown(){return this.tip&&this.tip.classList.contains(zt)}_createPopper(e){const t=we(this._config.placement,[this,e,this._element]),o=Tv[t.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return we(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...we(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")P.on(this._element,this.constructor.eventName($v),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ts]=!(i._isShown()&&i._activeTrigger[Ts]),i.toggle()});else if(t!==vv){const o=t===kt?this.constructor.eventName(Cv):this.constructor.eventName(wv),i=t===kt?this.constructor.eventName(Sv):this.constructor.eventName(Ev);P.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?Ss:kt]=!0,r._enter()}),P.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?Ss:kt]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},P.on(this._element.closest(Yn),Jn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=je.getDataAttributes(this._element);for(const o of Object.keys(t))mv.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Be(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Ct.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Me(Ct);const Av="popover",Mv=".popover-header",Ov=".popover-body",Nv={...Ct.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Dv={...Ct.DefaultType,content:"(null|string|element|function)"};class sn extends Ct{static get Default(){return Nv}static get DefaultType(){return Dv}static get NAME(){return Av}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Mv]:this._getTitle(),[Ov]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Me(sn);const Lv="scrollspy",Iv="bs.scrollspy",nn=`.${Iv}`,Pv=".data-api",jv=`activate${nn}`,Xn=`click${nn}`,Rv=`load${nn}${Pv}`,Hv="dropdown-item",lt="active",Vv='[data-bs-spy="scroll"]',ks="[href]",Wv=".nav, .list-group",Qn=".nav-link",Fv=".nav-item",Uv=".list-group-item",Bv=`${Qn}, ${Fv} > ${Qn}, ${Uv}`,qv=".dropdown",zv=".dropdown-toggle",Kv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Gv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class us extends Ne{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Kv}static get DefaultType(){return Gv}static get NAME(){return Lv}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Be(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(P.off(this._config.target,Xn),P.on(this._config.target,Xn,ks,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const c=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&c){if(o(r),!i)return;continue}!a&&!c&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Y.find(ks,this._config.target);for(const t of e){if(!t.hash||qe(t))continue;const o=Y.findOne(decodeURI(t.hash),this._element);wt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(lt),this._activateParents(e),P.trigger(this._element,jv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Hv)){Y.findOne(zv,e.closest(qv)).classList.add(lt);return}for(const t of Y.parents(e,Wv))for(const o of Y.prev(t,Bv))o.classList.add(lt)}_clearActiveClass(e){e.classList.remove(lt);const t=Y.find(`${ks}.${lt}`,e);for(const o of t)o.classList.remove(lt)}static jQueryInterface(e){return this.each(function(){const t=us.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}P.on(window,Rv,()=>{for(const n of Y.find(Vv))us.getOrCreateInstance(n)});Me(us);const Yv="tab",Jv="bs.tab",at=`.${Jv}`,Xv=`hide${at}`,Qv=`hidden${at}`,Zv=`show${at}`,eh=`shown${at}`,th=`click${at}`,sh=`keydown${at}`,nh=`load${at}`,oh="ArrowLeft",Zn="ArrowRight",ih="ArrowUp",eo="ArrowDown",xs="Home",to="End",Qe="active",so="fade",As="show",ah="dropdown",ai=".dropdown-toggle",rh=".dropdown-menu",Ms=`:not(${ai})`,lh='.list-group, .nav, [role="tablist"]',ch=".nav-item, .list-group-item",uh=`.nav-link${Ms}, .list-group-item${Ms}, [role="tab"]${Ms}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Os=`${uh}, ${ri}`,dh=`.${Qe}[data-bs-toggle="tab"], .${Qe}[data-bs-toggle="pill"], .${Qe}[data-bs-toggle="list"]`;class bt extends Ne{constructor(e){super(e),this._parent=this._element.closest(lh),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),P.on(this._element,sh,t=>this._keydown(t)))}static get NAME(){return Yv}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?P.trigger(t,Xv,{relatedTarget:e}):null;P.trigger(e,Zv,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(Qe),this._activate(Y.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(As);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),P.trigger(e,eh,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(so))}_deactivate(e,t){if(!e)return;e.classList.remove(Qe),e.blur(),this._deactivate(Y.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(As);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),P.trigger(e,Qv,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(so))}_keydown(e){if(![oh,Zn,ih,eo,xs,to].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!qe(i));let o;if([xs,to].includes(e.key))o=t[e.key===xs?0:t.length-1];else{const i=[Zn,eo].includes(e.key);o=Zs(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),bt.getOrCreateInstance(o).show())}_getChildren(){return Y.find(Os,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=Y.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(ah))return;const i=(a,r)=>{const c=Y.findOne(a,o);c&&c.classList.toggle(r,t)};i(ai,Qe),i(rh,As),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(Qe)}_getInnerElement(e){return e.matches(Os)?e:Y.findOne(Os,e)}_getOuterElement(e){return e.closest(ch)||e}static jQueryInterface(e){return this.each(function(){const t=bt.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}P.on(document,th,ri,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!qe(this)&&bt.getOrCreateInstance(this).show()});P.on(window,nh,()=>{for(const n of Y.find(dh))bt.getOrCreateInstance(n)});Me(bt);const mh="toast",ph="bs.toast",Ye=`.${ph}`,fh=`mouseover${Ye}`,vh=`mouseout${Ye}`,hh=`focusin${Ye}`,_h=`focusout${Ye}`,gh=`hide${Ye}`,bh=`hidden${Ye}`,yh=`show${Ye}`,$h=`shown${Ye}`,wh="fade",no="hide",Kt="show",Gt="showing",Eh={animation:"boolean",autohide:"boolean",delay:"number"},Ch={animation:!0,autohide:!0,delay:5e3};class ds extends Ne{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Ch}static get DefaultType(){return Eh}static get NAME(){return mh}show(){if(P.trigger(this._element,yh).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(wh);const t=()=>{this._element.classList.remove(Gt),P.trigger(this._element,$h),this._maybeScheduleHide()};this._element.classList.remove(no),It(this._element),this._element.classList.add(Kt,Gt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||P.trigger(this._element,gh).defaultPrevented)return;const t=()=>{this._element.classList.add(no),this._element.classList.remove(Gt,Kt),P.trigger(this._element,bh)};this._element.classList.add(Gt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Kt),super.dispose()}isShown(){return this._element.classList.contains(Kt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){P.on(this._element,fh,e=>this._onInteraction(e,!0)),P.on(this._element,vh,e=>this._onInteraction(e,!1)),P.on(this._element,hh,e=>this._onInteraction(e,!0)),P.on(this._element,_h,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}rs(ds);Me(ds);const Sh={class:"message-content-column"},Th=["id"],kh={class:"accordion-item"},xh=["id"],Ah=["aria-controls"],Mh={class:"d-flex align-items-center w-100"},Oh={class:"badge bg-warning text-dark ms-auto me-2"},Nh={class:"text-muted"},Dh=["id","aria-labelledby"],Lh={class:"accordion-body bg-light"},Ih={class:"alert alert-warning mb-3",role:"alert"},Ph={class:"compaction-metadata"},jh={class:"metadata-row"},Rh={class:"metadata-row"},Hh={key:0,class:"metadata-row"},Vh={class:"continuation-content"},Wh={class:"continuation-text border rounded p-3 bg-white"},Fh={class:"mb-0"},Uh={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=y(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=y(()=>`heading-${t.value}`),i=y(()=>`collapse-${t.value}`),a=D(null);let r=null;fe(()=>{a.value&&(r=new gt(a.value,{toggle:!1}))}),io(()=>{r&&r.dispose()});function c(){r&&r.toggle()}const f=y(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),_=y(()=>f.value?e.messages[3]:e.messages[2]),l=y(()=>_.value?.metadata?.init_data?.compact_metadata||{}),$=y(()=>l.value.pre_tokens||0),g=y(()=>f.value?e.messages[4]:e.messages[3]),h=y(()=>g.value?.content||""),b=y(()=>{const u=e.messages[0]?.timestamp;return u?Dt(u):""});function d(u){return u?`${u.toLocaleString()} tokens`:"0 tokens"}return(u,m)=>(p(),v("div",{class:"message-row message-row-compaction",key:t.value},[m[7]||(m[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Sh,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",kh,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:c},[s("div",Mh,[m[0]||(m[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),m[1]||(m[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",Oh,w(d($.value)),1),s("small",Nh,w(b.value),1)])],8,Ah)],8,xh),s("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Lh,[s("div",Ih,[m[5]||(m[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),te(" Compaction Details ")],-1)),s("div",Ph,[s("div",jh,[m[2]||(m[2]=s("strong",null,"Trigger:",-1)),s("span",null,w(l.value.trigger||"auto"),1)]),s("div",Rh,[m[3]||(m[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,w(d($.value)),1)]),l.value.post_tokens?(p(),v("div",Hh,[m[4]||(m[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,w(d(l.value.post_tokens)),1)])):N("",!0)])]),s("div",Vh,[m[6]||(m[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),te(" Continuation Message ")],-1)),s("div",Wh,[s("pre",Fh,w(h.value),1)])])])],8,Dh)])],8,Th)])]))}},Bh=G(Uh,[["__scopeId","data-v-e0b95ba8"]]),qh={key:0,class:"text-muted text-center py-5"},zh={__name:"MessageList",setup(n){const e=Oe(),t=pe(),o=D(null),i=y(()=>{const l=e.currentMessages,$=[];let g=0;for(;g<l.length;){const h=l[g];if(r(h,l,g)){const b=l[g+2],u=b?.type==="system"&&b?.metadata?.subtype==="init"?5:4,m=l.slice(g,g+u);$.push({type:"compaction",messages:m}),g+=u;continue}f(h)&&$.push({type:"message",message:h,attachedTools:[]}),g++}return a($)});function a(l){const $=new Map,g=new Set;for(let b=0;b<l.length;b++){const d=l[b];if(d.type==="compaction")continue;const u=d.message,m=u.content&&u.content.trim().length>0&&u.content!=="Assistant response",E=u.type==="assistant"&&u.metadata?.has_tool_uses&&u.metadata?.tool_uses?.length>0;if(u.type==="assistant"&&E&&!m){let S=-1,O=!1;for(let I=b-1;I>=0;I--){const x=l[I];if(!g.has(I)){if(x.type==="message"&&x.message.type!=="assistant"){O=!0;break}if(x.type==="message"&&x.message.type==="assistant"){const k=x.message;if(k.content&&k.content.trim().length>0&&k.content!=="Assistant response"){S=I;break}else{S=I;break}}}}O&&S===-1||(O&&S>=0?($.has(S)||$.set(S,[]),$.get(S).push(...u.metadata.tool_uses),g.add(b)):!O&&S>=0&&($.has(S)||$.set(S,[]),$.get(S).push(...u.metadata.tool_uses),g.add(b)))}}const h=[];for(let b=0;b<l.length;b++){if(g.has(b))continue;const d=l[b];$.has(b)&&(d.attachedTools=[...d.attachedTools||[],...$.get(b)]),h.push(d)}return h}function r(l,$,g){if(g+3>=$.length)return!1;const h=$[g],b=$[g+1];let d=$[g+2],u=$[g+3],m=$[g+4];const E=h.type==="system"&&h.metadata?.subtype==="status"&&h.metadata?.init_data?.status==="compacting",S=b.type==="system"&&b.metadata?.subtype==="status"&&(b.metadata?.init_data?.status===null||b.metadata?.init_data?.status===void 0);if(d?.type==="system"&&d?.metadata?.subtype==="init"){if(g+4>=$.length)return!1;const I=!0,x=u?.type==="system"&&u?.metadata?.subtype==="compact_boundary",k=m?.type==="user"&&m?.content?.startsWith("This session is being continued from a previous conversation");return h.type==="system"&&h.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",E),console.log("  Msg2 (null status):",S),console.log("  Msg3 (init):",I),console.log("  Msg4 (boundary):",x),console.log("  Msg5 (continuation):",k)),E&&S&&I&&x&&k}else{const I=d?.type==="system"&&d?.metadata?.subtype==="compact_boundary",x=u?.type==="user"&&u?.content?.startsWith("This session is being continued from a previous conversation");return h.type==="system"&&h.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",E),console.log("  Msg2 (null status):",S),console.log("  Msg3 (boundary):",I),console.log("  Msg4 (continuation):",x)),E&&S&&I&&x}}async function c(){t.autoScrollEnabled&&(await Ns(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ce(()=>i.value.length,c),ce(()=>e.currentToolCalls.length,c),ce(()=>e.currentToolCalls.map(l=>`${l.id}-${l.status}`).join(","),c),fe(()=>{setTimeout(()=>{c()},100)});function f(l){const $=l.subtype||l.metadata?.subtype;if(l.type==="system"&&$==="init"||l.type==="result"||l.type==="permission_request"||l.type==="permission_response")return!1;if(l.type==="user"&&l.metadata?.has_tool_results){const g=l.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(l.type==="user"){const g=l.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(l.type==="user"){const g=l.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}return!0}function _(l){return{type:l.type||"unknown",content:l.content||"",timestamp:l.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...l.metadata}}}return(l,$)=>(p(),v("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(p(),v("div",qh," No messages yet. Start a conversation! ")):N("",!0),(p(!0),v(re,null,de(i.value,(g,h)=>(p(),v(re,{key:`item-${h}`},[g.type==="message"?(p(),_e(Cd,{key:0,message:_(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(p(),_e(Bh,{key:1,messages:g.messages},null,8,["messages"])):N("",!0)],64))),128))],512))}},Kh=G(zh,[["__scopeId","data-v-6bae0fb1"]]),Gh={class:"border-top bg-light"},Yh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Jh={class:"d-flex gap-2 align-items-end px-2 py-1"},Xh=["placeholder","disabled"],Qh=["disabled"],Zh={__name:"InputArea",setup(n){const e=ie(),t=Ve(),o=D(null),i=D(window.innerWidth),a=y({get:()=>e.currentInput,set:u=>{e.currentInput=u}}),r=y(()=>e.currentSession?.is_processing||!1),c=y(()=>t.sessionConnected),f=y(()=>e.currentSession?.state==="starting"),_=y(()=>i.value<768),l=y(()=>f.value?"Session is starting...":c.value?"Type your message to Claude Code...":"Waiting for connection...");function $(){i.value=window.innerWidth}fe(()=>{window.addEventListener("resize",$)}),he(()=>{window.removeEventListener("resize",$)});function g(u){if(u.key==="Enter"&&!u.shiftKey){if(_.value)return;u.preventDefault(),b()}}function h(){const u=o.value;if(!u)return;u.style.height="auto";const m=Math.min(u.scrollHeight,parseInt(getComputedStyle(u).maxHeight));u.style.height=m+"px"}function b(){a.value.trim()&&(t.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function d(){t.interruptSession()}return(u,m)=>(p(),v("div",Gh,[c.value?N("",!0):(p(),v("div",Yh,[...m[1]||(m[1]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",Jh,[ne(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":m[0]||(m[0]=E=>a.value=E),class:"form-control",placeholder:l.value,disabled:f.value||!c.value,rows:"1",onInput:h,onKeydown:g},null,40,Xh),[[me,a.value]]),r.value?(p(),v("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:d}," Stop ")):(p(),v("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!c.value||f.value,onClick:b}," Send ",8,Qh))])]))}},e_=G(Zh,[["__scopeId","data-v-ef1e5094"]]),t_={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},s_={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},n_={class:"text-secondary"},o_={class:"d-flex flex-column flex-grow-1 overflow-hidden"},li={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ie(),o=pe(),i=y(()=>t.currentSession),a=y(()=>o.isLoading),r=y(()=>o.loadingMessage);return fe(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ce(()=>e.sessionId,async(c,f)=>{if(c!==f&&c!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(c)}finally{o.hideLoading()}}}),he(()=>{}),(c,f)=>(p(),v("div",t_,[a.value?(p(),v("div",s_,[f[0]||(f[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",n_,w(r.value),1)])):N("",!0),i.value?(p(),_e(Mi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):N("",!0),s("div",o_,[ue(Kh)]),ue(e_),i.value?(p(),_e(Ii,{key:2,"session-id":e.sessionId},null,8,["session-id"])):N("",!0),i.value?(p(),_e(Bi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):N("",!0)]))}},Ht=yt("legion",()=>{const n=D(new Map),e=D(new Map),t=D(null),o=y(()=>n.value.get(t.value)||[]),i=y(()=>e.value.get(t.value)||[]);function a(b){t.value=b}async function r(b,d=100,u=0){try{const m=await oe.get(`/api/legions/${b}/timeline?limit=${d}&offset=${u}`),E=m.comms||[],S=m.total_count||E.length,O=m.has_more||!1;return E.sort((I,x)=>new Date(I.timestamp)-new Date(x.timestamp)),console.log(`Loaded ${E.length} of ${S} comms for legion ${b}`),n.value.set(b,E),n.value=new Map(n.value),{comms:E,totalCount:S,hasMore:O}}catch(m){throw console.error("Failed to load timeline:",m),m}}function c(b,d){n.value.has(b)||n.value.set(b,[]);const u=n.value.get(b);if(u.some(E=>E.comm_id===d.comm_id)){console.log(`Duplicate comm ${d.comm_id} prevented in timeline`);return}u.push(d),n.value=new Map(n.value)}async function f(b,d){try{const m=(await oe.post(`/api/legions/${b}/comms`,d)).comm;return console.log(`Sent comm ${m.comm_id} to legion ${b}`),m}catch(u){throw console.error("Failed to send comm:",u),u}}async function _(b){return console.log(`Minions for legion ${b} are already available in session store`),[]}async function l(b,d){try{const m=(await oe.post(`/api/legions/${b}/minions`,d)).minion;return await _(b),console.log(`Created minion ${m.minion_id} in legion ${b}`),m}catch(u){throw console.error("Failed to create minion:",u),u}}async function $(b){try{const d=await oe.post(`/api/legions/${b}/halt-all`);return console.log(`Halted ${d.halted_count} of ${d.total_minions} minions in legion ${b}`),d.failed_minions&&d.failed_minions.length>0&&console.warn("Failed to halt some minions:",d.failed_minions),d}catch(d){throw console.error("Failed to halt all minions:",d),d}}async function g(b){try{const d=await oe.post(`/api/legions/${b}/resume-all`);return console.log(`Resumed ${d.resumed_count} of ${d.total_minions} minions in legion ${b}`),d.failed_minions&&d.failed_minions.length>0&&console.warn("Failed to resume some minions:",d.failed_minions),d}catch(d){throw console.error("Failed to resume all minions:",d),d}}function h(b){n.value.delete(b),e.value.delete(b),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:r,addComm:c,sendComm:f,loadMinions:_,createMinion:l,haltAll:$,resumeAll:g,clearLegionData:h}}),i_=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Ht},Symbol.toStringTag,{value:"Module"})),a_={class:"timeline-header border-bottom p-3"},r_={class:"project-name"},l_=["title"],c_={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=$e(),o=y(()=>t.projects.get(e.legionId)),i=y(()=>o.value?.name||"Legion");return(a,r)=>(p(),v("div",a_,[s("div",null,[s("div",r_,w(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,l_)])]))}},u_=G(c_,[["__scopeId","data-v-44f386f5"]]),d_={class:"timeline-status-bar border-top p-2 bg-light"},m_={class:"d-flex justify-content-end"},p_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=pe();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(p(),v("div",d_,[s("div",m_,[s("button",{class:z(["btn btn-sm",Qt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+w(Qt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},f_=G(p_,[["__scopeId","data-v-891c73db"]]),v_={class:"comm-composer border-top p-3"},h_={key:0,class:"d-flex gap-2 mb-2"},__={class:"flex-grow-1"},g_=["disabled"],b_={label:"Minions"},y_=["value"],$_={key:0,label:"Channels"},w_=["value"],E_={style:{"min-width":"150px"}},C_=["disabled"],S_={class:"d-flex gap-2 align-items-end position-relative"},T_={class:"flex-grow-1 position-relative"},k_=["disabled"],x_=["onClick","onMouseenter"],A_=["disabled"],M_={key:0},O_={key:1},N_={__name:"CommComposer",props:{legionId:{type:String,required:!0},defaultChannelId:{type:String,default:""},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=Ht(),o=ie(),i=$e(),a=D(""),r=D("task"),c=D(""),f=D(!1),_=D(window.innerWidth),l=D(!1),$=D([]),g=D(0),h=D(-1),b=D(null),d=D(null),u=y(()=>_.value<768),m=y(()=>{const T=i.projects.get(e.legionId);return!T||!T.session_ids?[]:T.session_ids.map(L=>o.sessions.get(L)).filter(L=>L&&L.is_minion)}),E=y(()=>t.currentChannels||[]),S=y(()=>a.value&&c.value.trim().length>0);function O(T){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[T.state]||"â—‹"}function I(T){return T.is_minion&&T.role?`${T.name} (${T.role})`:T.name}function x(){const T=b.value;if(!T)return;T.style.height="auto";const L=Math.min(T.scrollHeight,parseInt(getComputedStyle(T).maxHeight));T.style.height=L+"px"}function k(){const T=b.value;if(!T)return;x();const L=c.value,M=T.selectionStart,R=L.substring(0,M),H=R.lastIndexOf("#");if(H===-1){l.value=!1;return}const J=R.substring(H+1).toLowerCase();if(J.includes(" ")){l.value=!1;return}const ae=m.value.filter(U=>U.name.toLowerCase().includes(J)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(ae.length===0){l.value=!1;return}$.value=ae,g.value=0,h.value=H,l.value=!0}function A(){if(!d.value)return;const T=d.value,L=T.children[g.value];if(!L)return;const M=L.offsetTop,R=L.offsetHeight,H=T.scrollTop,J=T.clientHeight;M<H?T.scrollTop=M:M+R>H+J&&(T.scrollTop=M+R-J)}function B(T){if(!l.value){if(T.key==="Enter"&&!T.shiftKey){if(u.value)return;S.value&&(T.preventDefault(),j())}return}if(T.key==="ArrowDown")T.preventDefault(),g.value=(g.value+1)%$.value.length,A();else if(T.key==="ArrowUp")T.preventDefault(),g.value=g.value===0?$.value.length-1:g.value-1,A();else if(T.key==="Enter"){T.preventDefault();const L=$.value[g.value];L&&Z(L)}else T.key==="Escape"&&(l.value=!1)}function Z(T){const L=b.value;if(!L)return;const M=c.value,R=L.selectionStart,H=M.substring(0,h.value)+"#"+T.name+" "+M.substring(R);c.value=H;const J=h.value+T.name.length+2;setTimeout(()=>{L.setSelectionRange(J,J),L.focus()},0),l.value=!1}async function j(){if(!(!S.value||f.value)){f.value=!0;try{const[T,L]=a.value.split(":"),M={comm_type:r.value,content:c.value.trim()};T==="minion"?M.to_minion_id=L:T==="channel"&&(M.to_channel_id=L),await t.sendComm(e.legionId,M),c.value="",x()}catch(T){console.error("Failed to send comm:",T),alert(`Failed to send comm: ${T.message}`)}finally{f.value=!1}}}function C(){_.value=window.innerWidth}return fe(()=>{window.addEventListener("resize",C)}),he(()=>{window.removeEventListener("resize",C)}),ce(()=>e.defaultChannelId,T=>{T&&(a.value=`channel:${T}`)},{immediate:!0}),ce(l,T=>{if(T){const L=M=>{M.target.closest(".comm-composer")||(l.value=!1,document.removeEventListener("click",L))};setTimeout(()=>document.addEventListener("click",L),0)}}),(T,L)=>(p(),v("div",v_,[n.hideRecipientSelector?N("",!0):(p(),v("div",h_,[s("div",__,[ne(s("select",{"onUpdate:modelValue":L[0]||(L[0]=M=>a.value=M),class:"form-select form-select-sm",disabled:f.value},[L[3]||(L[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",b_,[(p(!0),v(re,null,de(m.value,M=>(p(),v("option",{key:M.session_id,value:`minion:${M.session_id}`},w(O(M))+" "+w(I(M)),9,y_))),128))]),E.value.length>0?(p(),v("optgroup",$_,[(p(!0),v(re,null,de(E.value,M=>(p(),v("option",{key:M.channel_id,value:`channel:${M.channel_id}`}," #ï¸âƒ£ "+w(M.name),9,w_))),128))])):N("",!0)],8,g_),[[Re,a.value]])]),s("div",E_,[ne(s("select",{"onUpdate:modelValue":L[1]||(L[1]=M=>r.value=M),class:"form-select form-select-sm",disabled:f.value},[...L[4]||(L[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,C_),[[Re,r.value]])])])),s("div",S_,[s("div",T_,[ne(s("textarea",{ref_key:"contentTextarea",ref:b,"onUpdate:modelValue":L[2]||(L[2]=M=>c.value=M),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:f.value,onInput:k,onKeydown:B},null,40,k_),[[me,c.value]]),l.value?(p(),v("div",{key:0,ref_key:"autocompleteDropdown",ref:d,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(p(!0),v(re,null,de($.value,(M,R)=>(p(),v("div",{key:M.id,class:z(["autocomplete-item px-2 py-1",{"bg-light":R===g.value}]),onClick:H=>Z(M),onMouseenter:H=>g.value=R},w(M.type==="minion"?O(M):"#ï¸âƒ£")+" "+w(M.name)+w(M.role?` (${M.role})`:""),43,x_))),128))],512)):N("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!S.value||f.value,onClick:j},[f.value?(p(),v("span",M_,[...L[5]||(L[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),te(" Sending... ",-1)])])):(p(),v("span",O_,"Send"))],8,A_)])])]))}},D_=G(N_,[["__scopeId","data-v-fb6899a3"]]),L_={class:"message-content-column-full"},I_=["aria-expanded"],P_={class:"comm-sender-recipient"},j_={class:"comm-badge-summary"},R_=["title"],H_={class:"comm-summary-text text-muted ms-2"},V_=["aria-label"],W_={key:0,class:"comm-content-body"},F_=["innerHTML"],U_="ffffffff-ffff-ffff-ffff-ffffffffffff",B_={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;et.setOptions({breaks:!0,gfm:!0});const t=D(!1);function o(){t.value=!t.value}const i=y(()=>e.comm.from_minion_id===U_),a=y(()=>{const _=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${_.toLocaleString()}`}),r=y(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),c=y(()=>{if(e.comm.summary)return e.comm.summary;const _=e.comm.content||"";return _.length>100?_.substring(0,100)+"...":_}),f=y(()=>{const _=e.comm.content||"";let l=et.parse(_);return l=l.replace(/\n</g,"<"),l=l.replace(/\n+$/,""),ns.sanitize(l)});return(_,l)=>(p(),v("div",{class:z(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",L_,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",P_,[s("strong",{class:z({"system-sender":i.value})},w(n.senderName),3),n.recipientName?(p(),v(re,{key:0},[l[0]||(l[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",{class:z({"recipient-channel":n.comm.to_channel_id})},w(n.recipientName),3)],64)):N("",!0)]),s("div",j_,[s("span",{class:z(["badge",r.value]),title:a.value},w(n.comm.comm_type),11,R_),s("span",H_,w(c.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},w(t.value?"â–¾":"â–¸"),9,V_)],8,I_),t.value?(p(),v("div",W_,[s("div",{class:"message-text",innerHTML:f.value},null,8,F_)])):N("",!0)])],2))}},q_=G(B_,[["__scopeId","data-v-f0417455"]]),z_={class:"timeline-view d-flex flex-column h-100"},K_={key:0,class:"text-center text-muted"},G_={key:1,class:"text-center text-danger"},Y_={key:2,class:"text-center text-muted"},J_={key:3,class:"comm-list"},X_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Ht();$e();const o=ie(),i=Ve(),a=pe(),r=D(!0),c=D(null),f=D(null),_=y(()=>t.currentComms);function l(u){return u.from_user?"You":u.from_minion_id?u.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(u.from_minion_id)?.name||"Unknown":"Unknown"}function $(u){if(u.to_user)return"You";if(u.to_minion_id)return o.sessions.get(u.to_minion_id)?.name||"Unknown";if(u.to_channel_id){if(u.to_channel_name)return`#${u.to_channel_name}`;const m=t.channelsByLegion.get(e.legionId)?.find(E=>E.channel_id===u.to_channel_id);return m?.name?`#${m.name}`:u.to_channel_id}return"All"}async function g(){a.autoScrollEnabled&&(await Ns(),f.value&&(f.value.scrollTop=f.value.scrollHeight))}async function h(){r.value=!0,c.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await Ns(),await g(),setTimeout(()=>{g()},100)}catch(u){console.error("Failed to load timeline:",u),u.response?c.value=`${u.message} (${u.response.status})`:c.value=u.message||"Unknown error"}finally{r.value=!1}}function b(){i.connectLegion(e.legionId)}function d(){i.disconnectLegion()}return ce(()=>_.value.length,()=>{g()}),fe(()=>{h(),b(),setTimeout(()=>{g()},100)}),he(()=>{d()}),(u,m)=>(p(),v("div",z_,[ue(u_,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:f,class:"timeline-messages flex-grow-1 overflow-auto"},[r.value?(p(),v("div",K_,[...m[0]||(m[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),te(" Loading timeline... ",-1)])])):c.value?(p(),v("div",G_," Failed to load timeline: "+w(c.value),1)):_.value.length===0?(p(),v("div",Y_," No messages yet. Minions will appear here once they start communicating. ")):(p(),v("div",J_,[(p(!0),v(re,null,de(_.value,E=>(p(),_e(q_,{key:E.comm_id,comm:E,"sender-name":l(E),"recipient-name":$(E)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ue(D_,{"legion-id":n.legionId},null,8,["legion-id"]),ue(f_,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Q_=G(X_,[["__scopeId","data-v-3308d82d"]]),Z_={class:"spy-view d-flex flex-column overflow-hidden"},eg={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){const e=n,t=Ve();return fe(()=>{t.connectLegion(e.legionId)}),io(()=>{t.disconnectLegion()}),(o,i)=>(p(),v("div",Z_,[ue(li,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},tg=G(eg,[["__scopeId","data-v-21206f91"]]),sg={class:"hierarchy-header border-bottom p-3"},ng={class:"d-flex justify-content-between align-items-center"},og={class:"project-name"},ig={class:"fleet-controls d-flex gap-2"},ag=["disabled"],rg={key:0,class:"spinner-border spinner-border-sm me-1"},lg=["disabled"],cg={key:0,class:"spinner-border spinner-border-sm me-1"},ug={__name:"HierarchyHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=$e(),o=ie(),i=pe(),a=y(()=>t.projects.get(e.legionId)),r=y(()=>a.value?.name||"Legion"),c=y(()=>Array.from(o.sessions.values()).filter(b=>b.is_minion&&b.project_id===e.legionId)),f=y(()=>c.value.filter(h=>h.state==="active")),_=y(()=>c.value.length===0||f.value.length===0),l=y(()=>c.value.length===0);function $(){i.showModal("fleet-control",{legionId:e.legionId,operation:"halt",activeMinionsCount:f.value.length,totalMinionsCount:c.value.length})}function g(){i.showModal("fleet-control",{legionId:e.legionId,operation:"resume",activeMinionsCount:f.value.length,totalMinionsCount:c.value.length})}return(h,b)=>(p(),v("div",sg,[s("div",ng,[s("div",null,[s("div",og,w(r.value),1),b[0]||(b[0]=s("div",{class:"view-name"},"Minion Hierarchy",-1))]),s("div",ig,[s("button",{class:"btn btn-sm btn-outline-warning",disabled:_.value||h.isOperating,onClick:$,title:"Emergency halt all active minions"},[h.isOperating&&h.lastOperation==="halt"?(p(),v("span",rg)):N("",!0),b[1]||(b[1]=te(" Halt All ",-1))],8,ag),s("button",{class:"btn btn-sm btn-outline-success",disabled:l.value||h.isOperating,onClick:g,title:"Resume all minions"},[h.isOperating&&h.lastOperation==="resume"?(p(),v("span",cg)):N("",!0),b[2]||(b[2]=te(" Resume All ",-1))],8,lg)])])]))}},dg=G(ug,[["__scopeId","data-v-7d7fd660"]]),mg={class:"hierarchy-status-bar border-top p-2 bg-light"},pg={__name:"HierarchyStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,t)=>(p(),v("div",mg,[...t[0]||(t[0]=[s("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},fg=G(pg,[["__scopeId","data-v-d43e967b"]]),vg={class:"minion-card border-start border-2 mb-2"},hg={class:"node-row"},_g={class:"node-left"},gg={key:0,class:"me-2"},bg={key:1,class:"badge bg-secondary ms-2"},yg={class:"node-right"},$g={key:0,class:"last-comm-preview"},wg={class:"comm-direction"},Eg=["title"],Cg={key:1,class:"text-muted fst-italic small"},Sg={key:0,class:"minion-children"},Tg={key:1,class:"text-danger small ms-4"},kg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,t=y(()=>e.level*24),o=y(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=y(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=y(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),r=y(()=>{const l=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[l]||"status-dot-grey"}),c=y(()=>{const l=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[l]||"#d3d3d3"}});function f(l){return l.to_user?"User":l.to_minion_name?l.to_minion_name:l.to_channel_name?`#${l.to_channel_name}`:"unknown"}function _(l){const $=l.summary||l.content||"";return $.length>150?$.substring(0,150)+"...":$}return(l,$)=>{const g=ao("MinionTreeNode",!0);return n.minionData?(p(),v("div",{key:0,class:"minion-tree-node",style:Ue({marginLeft:`${t.value}px`})},[s("div",vg,[s("div",hg,[s("div",_g,[s("div",{class:z(["status-dot me-2",r.value]),style:Ue(c.value)},null,6),i.value?(p(),v("span",gg,"ðŸ‘‘")):N("",!0),s("strong",null,w(n.minionData.name),1),i.value?(p(),v("span",bg,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):N("",!0)]),s("div",yg,[n.minionData.last_comm?(p(),v("div",$g,[s("span",wg,[$[0]||($[0]=te(" â†’ ",-1)),s("strong",null,w(f(n.minionData.last_comm)),1),$[1]||($[1]=te(": ",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},w(_(n.minionData.last_comm)),9,Eg)])):(p(),v("div",Cg," No communications yet "))])])]),o.value?(p(),v("div",Sg,[(p(!0),v(re,null,de(n.minionData.children,h=>(p(),_e(g,{key:h.id,"minion-data":h,level:n.level+1},null,8,["minion-data","level"]))),128))])):N("",!0)],4)):(p(),v("div",Tg," âš  Minion data is missing "))}}},xg=G(kg,[["__scopeId","data-v-1cd9863f"]]),Ag={class:"modal-dialog modal-dialog-centered"},Mg={class:"modal-content"},Og={class:"modal-header"},Ng={class:"modal-title",id:"fleetControlModalLabel"},Dg={class:"modal-body"},Lg={key:0,class:"text-center py-4"},Ig={class:"text-muted"},Pg={key:1},jg={class:"text-muted"},Rg={key:2},Hg={class:"text-muted"},Vg={key:3},Wg={class:"text-muted"},Fg={class:"modal-footer"},Ug={key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},Bg={__name:"FleetControlModal",setup(n){const e=pe(),t=Ht(),o=D(!1),i=D(""),a=D(null),r=D(null),c=D(null);let f=null;const _=D(null),l=D(0),$=D(0),g=y(()=>r.value?r.value.type==="success"?"Success":"Error":a.value==="halt"?"Emergency Halt All Minions":a.value==="resume"?"Resume All Minions":"Fleet Control");fe(()=>{c.value&&(f=new nt(c.value),c.value.addEventListener("hidden.bs.modal",()=>{a.value=null,r.value=null,o.value=!1}))}),he(()=>{f&&f.dispose()}),ce(()=>e.currentModal,m=>{if(!m||m.name!=="fleet-control")return;const E=m.data;E&&(_.value=E.legionId,l.value=E.activeMinionsCount||0,$.value=E.totalMinionsCount||0,a.value=E.operation,r.value=null,f&&f.show())});function h(){a.value=null,f&&f.hide()}async function b(){a.value==="halt"?await d():a.value==="resume"&&await u()}async function d(){o.value=!0,i.value="Halting all minions...";try{const m=await t.haltAll(_.value),E=m.failed_minions&&m.failed_minions.length>0?` Failed to halt ${m.failed_minions.length} minion(s).`:"";r.value={type:"success",title:"Halt Complete",message:`Halted ${m.halted_count} of ${m.total_minions} minion(s).${E}`}}catch(m){console.error("Failed to halt all minions:",m),r.value={type:"error",title:"Halt Failed",message:`Failed to halt minions: ${m.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}async function u(){o.value=!0,i.value="Resuming all minions...";try{const m=await t.resumeAll(_.value),E=m.failed_minions&&m.failed_minions.length>0?` Failed to resume ${m.failed_minions.length} minion(s).`:"";r.value={type:"success",title:"Resume Complete",message:`Resumed ${m.resumed_count} of ${m.total_minions} minion(s).${E}`}}catch(m){console.error("Failed to resume all minions:",m),r.value={type:"error",title:"Resume Failed",message:`Failed to resume minions: ${m.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}return(m,E)=>(p(),v("div",{class:"modal fade",id:"fleetControlModal",tabindex:"-1","aria-labelledby":"fleetControlModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",Ag,[s("div",Mg,[s("div",Og,[s("h5",Ng,w(g.value),1),E[0]||(E[0]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",Dg,[o.value?(p(),v("div",Lg,[E[1]||(E[1]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Processing...")],-1)),s("p",Ig,w(i.value),1)])):r.value?(p(),v("div",Pg,[s("div",{class:z(["alert mb-3",r.value.type==="success"?"alert-success":"alert-danger"])},[s("strong",null,w(r.value.title),1)],2),s("p",jg,w(r.value.message),1)])):a.value==="halt"?(p(),v("div",Rg,[E[4]||(E[4]=s("div",{class:"alert alert-warning mb-3"},[s("strong",null,"âš ï¸ Emergency Halt")],-1)),s("p",Hg,[E[2]||(E[2]=te(" Are you sure you want to halt all ",-1)),s("strong",null,w(l.value),1),E[3]||(E[3]=te(" active minion(s) in this legion? ",-1))]),E[5]||(E[5]=s("p",{class:"text-muted"}," This will interrupt their current processing. Minions will remain in ACTIVE state but will stop processing. ",-1))])):a.value==="resume"?(p(),v("div",Vg,[E[8]||(E[8]=s("div",{class:"alert alert-info mb-3"},[s("strong",null,"Resume All Minions")],-1)),s("p",Wg,[E[6]||(E[6]=te(' This will send "continue" to all ',-1)),s("strong",null,w($.value),1),E[7]||(E[7]=te(" minion(s) in this legion. ",-1))]),E[9]||(E[9]=s("p",{class:"text-muted"}," Minions will resume processing from where they were interrupted. ",-1))])):N("",!0)]),s("div",Fg,[r.value?(p(),v("button",Ug,"OK")):a.value&&!o.value?(p(),v(re,{key:1},[s("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),s("button",{type:"button",class:z(["btn",a.value==="halt"?"btn-warning":"btn-success"]),onClick:b},w(a.value==="halt"?"Halt All":"Resume All"),3)],64)):N("",!0)])])])],512))}},qg=G(Bg,[["__scopeId","data-v-53a63f8d"]]),zg={class:"hierarchy-view d-flex flex-column h-100"},Kg={class:"hierarchy-tree-container flex-grow-1 overflow-auto p-3"},Gg={key:0,class:"text-center py-5"},Yg={key:1,class:"alert alert-danger"},Jg={class:"mb-0"},Xg={key:2,class:"hierarchy-tree"},Qg={class:"user-root-node mb-3 border rounded bg-white"},Zg={class:"node-row"},eb={class:"node-left"},tb={key:0,class:"badge bg-primary ms-2"},sb={class:"node-right"},nb={key:0,class:"last-comm-preview"},ob={class:"comm-direction"},ib=["title"],ab={key:1,class:"text-muted fst-italic"},rb={key:0,class:"alert alert-info ms-4"},lb={key:1,class:"root-minions ms-4"},cb={__name:"HierarchyView",props:{legionId:{type:String,required:!0}},setup(n){const e=n;$e();const t=ie(),o=Ve(),i=Ht(),a=D(null),r=D(!1),c=D(null),f=y(()=>a.value&&a.value.children&&a.value.children.length>0);async function _(){r.value=!0,c.value=null;try{const b=await oe.get(`/api/legions/${e.legionId}/hierarchy`);a.value=b,console.log("Loaded hierarchy:",b)}catch(b){console.error("Failed to load hierarchy:",b),c.value=b.message||"Unknown error"}finally{r.value=!1}}fe(()=>{_()}),ce(()=>e.legionId,()=>{_()});function l(b){return b.to_user?"User":b.to_minion_name?b.to_minion_name:b.to_channel_name?`#${b.to_channel_name}`:"unknown"}function $(b){const d=b.summary||b.content||"";return d.length>150?d.substring(0,150)+"...":d}function g(b,d){if(b.id===d)return b;if(b.children)for(const u of b.children){const m=g(u,d);if(m)return m}return null}function h(b){if(a.value){if(b.from_minion_id){const d=g(a.value,b.from_minion_id);d&&d.type==="minion"&&(d.last_comm=b,console.log(`Updated minion ${d.name} last_comm`))}b.from_user&&a.value.type==="user"&&(a.value.last_comm=b,console.log("Updated user last_comm"))}}return fe(()=>{_(),i.setCurrentLegion(e.legionId),o.connectLegion(e.legionId),ce(()=>t.sessions,b=>{if(a.value){for(const[d,u]of b)if(u.is_minion&&u.project_id===e.legionId){const m=g(a.value,d);m&&m.type==="minion"&&(m.state!==u.state&&(m.state=u.state,console.log(`Updated minion ${m.name} state to ${u.state}`)),m.is_processing!==u.is_processing&&(m.is_processing=u.is_processing,console.log(`Updated minion ${m.name} is_processing to ${u.is_processing}`)))}}},{deep:!0}),ce(()=>i.commsByLegion.get(e.legionId),b=>{if(b&&b.length>0){const d=b[b.length-1];h(d)}},{deep:!0}),ce(()=>t.sessions.size,(b,d)=>{b>d&&Array.from(t.sessions.values()).some(E=>E.is_minion&&E.project_id===e.legionId&&!g(a.value,E.session_id))&&(console.log("New minion detected, reloading hierarchy"),_())})}),he(()=>{console.log("HierarchyView unmounted")}),(b,d)=>(p(),v("div",zg,[ue(dg,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",Kg,[r.value?(p(),v("div",Gg,[...d[0]||(d[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):c.value?(p(),v("div",Yg,[d[1]||(d[1]=s("strong",null,"Failed to load hierarchy",-1)),s("p",Jg,w(c.value),1)])):a.value?(p(),v("div",Xg,[s("div",Qg,[s("div",Zg,[s("div",eb,[d[2]||(d[2]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,w(a.value.name),1),f.value?(p(),v("span",tb,w(a.value.children.length)+" "+w(a.value.children.length===1?"minion":"minions"),1)):N("",!0)]),s("div",sb,[a.value.last_comm?(p(),v("div",nb,[s("span",ob,[d[3]||(d[3]=te(" â†’ ",-1)),s("strong",null,w(l(a.value.last_comm)),1),d[4]||(d[4]=te(": ",-1))]),s("span",{class:"comm-content",title:a.value.last_comm.content||""},w($(a.value.last_comm)),9,ib)])):(p(),v("div",ab," No communications yet "))])])]),f.value?(p(),v("div",lb,[(p(!0),v(re,null,de(a.value.children,u=>(p(),_e(xg,{key:u.id,"minion-data":u,level:1},null,8,["minion-data"]))),128))])):(p(),v("div",rb,[...d[5]||(d[5]=[s("p",{class:"mb-2"},"No minions yet",-1),s("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):N("",!0)]),ue(fg,{"legion-id":n.legionId},null,8,["legion-id"]),ue(qg)]))}},ub=G(cb,[["__scopeId","data-v-e9184265"]]),db=[{path:"/",name:"home",component:bi},{path:"/session/:sessionId",name:"session",component:li,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Q_,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:tg,props:!0},{path:"/hierarchy/:legionId",name:"hierarchy",component:ub,props:!0}],mb=pi({history:fi(),routes:db}),pb={class:"connection-indicators"},fb=["title"],vb=["title"],hb=["title"],_b={__name:"ConnectionIndicator",setup(n){const e=Ve();function t(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:r,retryCount:c}=a[i];return c>0&&!r?"indicator-connecting":r?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},r={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},c={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:f,retryCount:_}=c[i];let l="Disconnected";return f?l="Connected":_>0&&(l=`Reconnecting (attempt ${_})`),`${a[i]}
${r[i]}
Status: ${l}`}return(i,a)=>(p(),v("div",pb,[s("div",{class:z(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,fb),s("div",{class:z(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,vb),s("div",{class:z(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,hb)]))}},gb=G(_b,[["__scopeId","data-v-d35b07c8"]]),bb={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},yb={class:"d-flex align-items-center gap-2"},$b={__name:"AppHeader",setup(n){const e=pe();function t(){e.toggleSidebar()}return(o,i)=>(p(),v("header",bb,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",yb,[ue(gb)])]))}},wb={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Eb={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Cb=["title"],Sb={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=y(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(c){return c.state==="paused"&&c.is_processing?"pending-prompt":c.is_processing?"processing":c.state}function i(c){const f=o(c);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[f]||"#d3d3d3"}function a(c){const f=o(c);return f==="starting"||f==="processing"||f==="pending-prompt"}function r(c){const f=o(c),_=f.charAt(0).toUpperCase()+f.slice(1),l=c.name||"Unnamed Session",$=c.is_minion&&c.role?` (${c.role})`:"";return`${l}${$}: ${_}`}return(c,f)=>(p(),v("div",wb,[!n.sessions||n.sessions.length===0?(p(),v("div",Eb)):(p(!0),v(re,{key:1},de(n.sessions,_=>(p(),v("div",{key:_.session_id,class:z(["progress-bar",{"progress-bar-striped progress-bar-animated":a(_)}]),style:Ue({width:t.value,backgroundColor:i(_),cursor:"help"}),title:r(_)},null,14,Cb))),128))]))}},Tb=G(Sb,[["__scopeId","data-v-a79cfeec"]]),kb={class:"flex-grow-1"},xb={key:0,class:"text-muted small ms-1"},Ab={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,t=ot(),o=ie(),i=$e(),a=pe(),r=y(()=>o.currentSessionId===e.session.session_id),c=y(()=>o.deletingSessions.has(e.session.session_id)),f=y(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),_=y(()=>{const m=f.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[m]||"status-dot-grey"}),l=y(()=>{const m=f.value,E={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},S={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:E[m]||"#d3d3d3",borderColor:S[m]||"#6c757d"}});function $(){o.selectSession(e.session.session_id),t.push(`/session/${e.session.session_id}`)}function g(){a.showModal("edit-session",{session:e.session})}function h(m){m.dataTransfer.effectAllowed="move",m.dataTransfer.setData("application/session-id",e.session.session_id),m.dataTransfer.setData("application/project-id",e.projectId),m.dataTransfer.setData("text/plain",e.session.session_id),m.target.classList.add("dragging")}function b(m){m.target.classList.remove("dragging")}function d(m){m.preventDefault(),m.dataTransfer.dropEffect="move";const E=m.currentTarget.getBoundingClientRect(),S=E.top+E.height/2;m.clientY<S?(m.currentTarget.classList.add("drop-above"),m.currentTarget.classList.remove("drop-below")):(m.currentTarget.classList.add("drop-below"),m.currentTarget.classList.remove("drop-above"))}function u(m){m.preventDefault(),m.currentTarget.classList.remove("drop-above","drop-below");const E=m.dataTransfer.getData("application/session-id")||m.dataTransfer.getData("text/plain"),S=m.dataTransfer.getData("application/project-id");if(!E||E===e.session.session_id||S!==e.projectId)return;const O=m.currentTarget.getBoundingClientRect(),I=O.top+O.height/2,x=m.clientY<I,k=i.getProject(e.projectId);if(!k||!k.session_ids)return;const A=[...k.session_ids],B=A.indexOf(e.session.session_id),Z=A.indexOf(E);if(B===-1||Z===-1)return;const j=[...A],[C]=j.splice(Z,1);let T=x?B:B+1;Z<B&&T--,j.splice(T,0,C),i.reorderSessionsInProject(e.projectId,j)}return(m,E)=>(p(),v("div",{class:z(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:r.value,"session-deleting":c.value}]),style:{cursor:"pointer"},draggable:"true",onClick:$,onDragstart:h,onDragend:b,onDragover:d,onDrop:u},[s("div",{class:z(["status-dot me-2",_.value]),style:Ue(l.value)},null,6),s("div",kb,[s("span",null,w(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(p(),v("span",xb,"("+w(n.session.role)+")",1)):N("",!0)]),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:Ee(g,["stop"])}," âœï¸ ")],34))}},Mb=G(Ab,[["__scopeId","data-v-07ecbf94"]]),Ob={class:"d-flex align-items-center gap-2"},Nb=["value"],Db={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=ot(),o=ie(),i=pe(),a=D("");ce(()=>t.currentRoute.value,d=>{!a.value&&d.name==="spy"&&d.params.minionId&&d.params.legionId===e.project.project_id&&(a.value=d.params.minionId)},{immediate:!0});const r=y(()=>a.value?e.sessions.find(d=>d.session_id===a.value):null),c=y(()=>{const d=t.currentRoute.value;return d.name==="spy"&&d.params.legionId===e.project.project_id}),f=y(()=>{if(!r.value)return"";if(r.value.state==="paused"&&r.value.is_processing)return"status-blinking";const d=r.value.is_processing?"processing":r.value.state;return d==="starting"||d==="processing"?"status-blinking":""}),_=y(()=>{if(!r.value)return{};if(r.value.state==="paused"&&r.value.is_processing)return{backgroundColor:"#ffc107"};const d=r.value.is_processing?"processing":r.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[d]||"#d3d3d3"}});function l(d){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[d.state]||"â—‹"}function $(d){return d.is_minion&&d.role?`${d.name} (${d.role})`:d.name}function g(){a.value&&t.push(`/spy/${e.project.project_id}/${a.value}`)}function h(){a.value?t.push(`/spy/${e.project.project_id}/${a.value}`):t.push("/")}function b(){r.value&&i.showModal("minion-view",{session:r.value})}return ce(()=>o.currentSessionId,d=>{if(d)e.sessions.some(u=>u.session_id===d)&&(a.value=d);else{a.value="";const u=t.currentRoute.value;u.name==="spy"&&u.params.legionId===e.project.project_id&&t.push("/")}}),(d,u)=>(p(),v("div",{class:z(["list-group-item list-group-item-action p-2",{active:c.value}])},[s("div",{class:"d-flex align-items-center justify-content-between mb-2",style:Ue({cursor:a.value?"pointer":"default"}),onClick:g},[u[1]||(u[1]=s("div",{class:"d-flex align-items-center"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ”"),s("span",{class:"fw-semibold"},"Spy"),s("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),s("div",Ob,[r.value?(p(),v("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:Ee(b,["stop"]),title:"View minion details"}," ðŸ‘ï¸ ")):N("",!0),r.value?(p(),v("span",{key:1,class:z(["minion-state-indicator",f.value]),style:Ue(_.value)}," ðŸ‘¤ ",6)):N("",!0)])],4),ne(s("select",{"onUpdate:modelValue":u[0]||(u[0]=m=>a.value=m),class:"form-select form-select-sm",onChange:h},[u[2]||(u[2]=s("option",{value:""},"-- Select Minion --",-1)),(p(!0),v(re,null,de(n.sessions,m=>(p(),v("option",{key:m.session_id,value:m.session_id},w(l(m))+" "+w($(m)),9,Nb))),128))],544),[[Re,a.value]])],2))}},Lb=G(Db,[["__scopeId","data-v-579589fb"]]),Ib=["data-project-id"],Pb=["id"],jb=["aria-expanded","aria-controls","onKeydown"],Rb={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Hb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Vb={class:"fw-semibold",style:{"flex-shrink":"0"}},Wb={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Fb={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Ub=["title"],Bb=["title"],qb=["id","aria-labelledby"],zb={class:"accordion-body p-0"},Kb={class:"list-group list-group-flush"},Gb={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=ot(),o=$e(),i=ie(),a=pe(),r=D(e.project.is_expanded||!1),c=y(()=>o.formatPath(e.project.working_directory)),f=y(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(x=>i.getSession(x)).filter(x=>x!=null)),_=y(()=>{const x=t.currentRoute.value;return x.name==="timeline"&&x.params.legionId===e.project.project_id}),l=y(()=>{const x=t.currentRoute.value;return x.name==="hierarchy"&&x.params.legionId===e.project.project_id});function $(x){const k=window.bootstrap;if(!k)return;const A=document.getElementById(`collapse-${e.project.project_id}`);if(!A)return;k.Collapse.getOrCreateInstance(A).toggle()}function g(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function h(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const x=i.currentSessionId;x&&i.getSession(x)&&e.project.session_ids?.includes(x)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function b(){a.showModal("edit-project",{project:e.project})}function d(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function u(){t.push(`/timeline/${e.project.project_id}`)}function m(){t.push(`/hierarchy/${e.project.project_id}`)}function E(x){x.dataTransfer.effectAllowed="move",x.dataTransfer.setData("application/project-id",e.project.project_id),x.dataTransfer.setData("text/plain",e.project.project_id),x.target.classList.add("dragging")}function S(x){x.target.classList.remove("dragging")}function O(x){x.preventDefault(),x.dataTransfer.dropEffect="move";const k=x.currentTarget.getBoundingClientRect(),A=k.top+k.height/2;x.clientY<A?(x.currentTarget.classList.add("drop-above"),x.currentTarget.classList.remove("drop-below")):(x.currentTarget.classList.add("drop-below"),x.currentTarget.classList.remove("drop-above"))}function I(x){x.preventDefault(),x.currentTarget.classList.remove("drop-above","drop-below");const k=x.dataTransfer.getData("application/project-id")||x.dataTransfer.getData("text/plain");if(!k||k===e.project.project_id)return;const A=x.currentTarget.getBoundingClientRect(),B=A.top+A.height/2,Z=x.clientY<B,j=o.orderedProjects,C=j.findIndex(J=>J.project_id===e.project.project_id),T=j.findIndex(J=>J.project_id===k);if(C===-1||T===-1)return;const L=[...j],[M]=L.splice(T,1);let R=Z?C:C+1;T<C&&R--,L.splice(R,0,M);const H=L.map(J=>J.project_id);o.reorderProjects(H)}return(x,k)=>(p(),v("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:E,onDragend:S,onDragover:O,onDrop:I},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:z(["accordion-button bg-white p-2",{collapsed:!r.value}]),role:"button",tabindex:"0","aria-expanded":r.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:$,onKeydown:[Mt(Ee($,["prevent"]),["enter"]),Mt(Ee($,["prevent"]),["space"])]},[s("div",Rb,[s("div",Hb,[s("div",Vb,[n.project.is_multi_agent?(p(),v("span",Wb,"ðŸ›")):N("",!0),te(" "+w(n.project.name),1)]),s("div",Fb,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:Ee(b,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:Ee(d,["stop"])}," âž• ",8,Ub)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},w(c.value),9,Bb)])],42,jb)],8,Pb),ue(Tb,{project:n.project,sessions:f.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:z(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:g,onHidden:h},[s("div",zb,[s("div",Kb,[n.project.is_multi_agent?(p(),v("div",{key:0,class:z(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:_.value}]),style:{cursor:"pointer"},onClick:u},[...k[0]||(k[0]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):N("",!0),n.project.is_multi_agent?(p(),v(re,{key:1},[s("div",{class:z(["list-group-item list-group-item-action hierarchy-item d-flex align-items-center p-2",{active:l.value}]),style:{cursor:"pointer"},onClick:m},[...k[1]||(k[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),s("span",{class:"fw-semibold"},"Hierarchy"),s("small",{class:"text-muted ms-2"},"(Minion Tree)")],-1)])],2),ue(Lb,{project:n.project,sessions:f.value},null,8,["project","sessions"])],64)):(p(!0),v(re,{key:2},de(f.value,A=>(p(),_e(Mb,{key:A.session_id,session:A,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,qb)],40,Ib))}},Yb=G(Gb,[["__scopeId","data-v-2c1065a3"]]),Jb={class:"project-list"},Xb={key:0,class:"text-muted text-center py-3"},Qb={__name:"ProjectList",setup(n){const e=$e(),t=y(()=>e.orderedProjects);return(o,i)=>(p(),v("div",Jb,[t.value.length===0?(p(),v("div",Xb,' No projects yet. Click "New" to create one. ')):N("",!0),(p(!0),v(re,null,de(t.value,a=>(p(),_e(Yb,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},Zb={class:"flex-grow-1 overflow-auto p-3"},ey={id:"sessions-container"},ty={__name:"Sidebar",setup(n){const e=pe(),t=y(()=>e.sidebarCollapsed),o=y(()=>e.isMobile),i=y(()=>{if(o.value)return{};const l=`${e.sidebarWidth}px`;return{width:l,minWidth:"200px",maxWidth:"30vw","--sidebar-width":l}});function a(){e.showModal("create-project")}const r=D(!1);function c(l){r.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",_)}function f(l){r.value&&e.setSidebarWidth(l.clientX)}function _(){r.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",_)}return(l,$)=>(p(),v("aside",{id:"sidebar",class:z(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:Ue(i.value)},[s("div",Zb,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),s("div",ey,[ue(Qb)])]),s("div",{class:"sidebar-resize-handle",onMousedown:c},null,32)],6))}},sy=G(ty,[["__scopeId","data-v-d792f0f0"]]),ny={class:"modal-dialog modal-lg"},oy={class:"modal-content"},iy={class:"modal-body"},ay={class:"mb-3"},ry={class:"input-group"},ly=["disabled"],cy={key:0,class:"text-center py-4"},uy={key:1,class:"alert alert-danger",role:"alert"},dy={key:2,class:"folder-list"},my=["onClick","onDblclick"],py={class:"d-flex align-items-center flex-grow-1"},fy=["onClick"],vy={key:1,class:"text-center text-muted py-3"},hy={class:"modal-footer"},_y=["disabled"],gy={__name:"FolderBrowserModal",setup(n){const e=pe(),t=D(""),o=D(""),i=D([]),a=D(!1),r=D(""),c=D(null);let f=null,_=null;const l=y(()=>{if(!t.value)return null;const S=t.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?S.join("/"):"/")});function $(S){if(!S)return"";const O=S.split(/[\\/]/).filter(Boolean);return O.length<=2?S:".../"+O.slice(-2).join("/")}async function g(){a.value=!0,r.value="",i.value=[],o.value="";try{const S=t.value?{path:t.value}:{},O=await oe.get("/api/filesystem/browse",{params:S});O.current_path&&(t.value=O.current_path),i.value=O.directories||[]}catch(S){console.error("Failed to load directory:",S),r.value=S.message||"Failed to load directory"}finally{a.value=!1}}function h(S){o.value=S.path}function b(S){t.value=S.path,o.value="",g()}function d(){l.value&&(t.value=l.value,o.value="",g())}function u(){const S=o.value||t.value;S&&_&&_(S),f&&f.hide()}function m(){g()}function E(){i.value=[],o.value="",r.value="",_=null,e.hideModal()}return ce(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&f){const O=S.data||{};t.value=O.defaultPath||O.currentPath||"",_=O.onSelect||null,f.show()}}),fe(()=>{c.value&&ge(async()=>{const{default:S}=await import("./modal-BK1Vt_in.js").then(O=>O.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{f=new S(c.value),c.value.addEventListener("shown.bs.modal",m),c.value.addEventListener("hidden.bs.modal",E)})}),he(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",m),c.value.removeEventListener("hidden.bs.modal",E)),f&&f.dispose()}),(S,O)=>(p(),v("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",ny,[s("div",oy,[O[6]||(O[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",iy,[s("div",ay,[O[1]||(O[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",ry,[ne(s("input",{type:"text",class:"form-control","onUpdate:modelValue":O[0]||(O[0]=I=>t.value=I),onKeyup:Mt(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[me,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:g,disabled:a.value}," ðŸ”„ Refresh ",8,ly)])]),a.value?(p(),v("div",cy,[...O[2]||(O[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(p(),v("div",uy,w(r.value),1)):(p(),v("div",dy,[l.value?(p(),v("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:d,role:"button"},[...O[3]||(O[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):N("",!0),(p(!0),v(re,null,de(i.value,I=>(p(),v("div",{key:I.path,class:z(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:I.path===o.value}]),onClick:x=>h(I),onDblclick:x=>b(I),role:"button"},[s("div",py,[O[4]||(O[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,w(I.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:Ee(x=>b(I),["stop"])}," Open ",8,fy)],42,my))),128)),i.value.length===0?(p(),v("div",vy," No subdirectories found ")):N("",!0)]))]),s("div",hy,[O[5]||(O[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:u,disabled:!o.value},' Select "'+w($(o.value||t.value))+'" ',9,_y)])])])],512))}},by=G(gy,[["__scopeId","data-v-cf79108f"]]),yy={class:"modal-dialog"},$y={class:"modal-content"},wy={class:"modal-body"},Ey={class:"mb-3"},Cy={key:0,class:"invalid-feedback"},Sy={class:"mb-3"},Ty={class:"input-group"},ky={key:0,class:"invalid-feedback"},xy={class:"mb-3 form-check"},Ay={class:"mb-3 form-check"},My={class:"form-check-label",for:"createSession"},Oy={key:0,class:"mb-3 ms-4"},Ny={for:"sessionName",class:"form-label"},Dy={key:1,class:"alert alert-danger",role:"alert"},Ly={class:"modal-footer"},Iy=["disabled"],Py={key:0,class:"spinner-border spinner-border-sm me-2"},jy={__name:"ProjectCreateModal",setup(n){const e=$e(),t=ie(),o=pe(),i=D({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=D({name:"",workingDirectory:""}),r=D(!1),c=D(""),f=D(null);let _=null;function l(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:u=>{i.value.workingDirectory=u,a.value.workingDirectory=""}})}function $(){a.value={};let u=!0;return i.value.name.trim()||(a.value.name="Project name is required",u=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",u=!1),u}async function g(){if($()){r.value=!0,c.value="";try{const u=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await t.createSession(u.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),_&&_.hide(),h()}catch(u){console.error("Failed to create project:",u),c.value=u.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function h(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},c.value=""}function b(){const u=document.getElementById("projectName");u&&u.focus()}function d(){h(),o.hideModal()}return ce(()=>o.currentModal,u=>{u?.name==="create-project"&&_&&_.show()}),fe(()=>{f.value&&ge(async()=>{const{default:u}=await import("./modal-BK1Vt_in.js").then(m=>m.m);return{default:u}},__vite__mapDeps([0,1])).then(({default:u})=>{_=new u(f.value),f.value.addEventListener("shown.bs.modal",b),f.value.addEventListener("hidden.bs.modal",d)})}),he(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",b),f.value.removeEventListener("hidden.bs.modal",d)),_&&_.dispose()}),(u,m)=>(p(),v("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[s("div",yy,[s("div",$y,[m[11]||(m[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",wy,[s("form",{onSubmit:Ee(g,["prevent"])},[s("div",Ey,[m[5]||(m[5]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ne(s("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":m[0]||(m[0]=E=>i.value.name=E),placeholder:"My Project",required:""},null,2),[[me,i.value.name]]),a.value.name?(p(),v("div",Cy,w(a.value.name),1)):N("",!0)]),s("div",Sy,[m[6]||(m[6]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Ty,[ne(s("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":m[1]||(m[1]=E=>i.value.workingDirectory=E),placeholder:"/path/to/project",required:""},null,2),[[me,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:l}," Browse... "),a.value.workingDirectory?(p(),v("div",ky,w(a.value.workingDirectory),1)):N("",!0)]),m[7]||(m[7]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",xy,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":m[2]||(m[2]=E=>i.value.isMultiAgent=E)},null,512),[[Ot,i.value.isMultiAgent]]),m[8]||(m[8]=s("label",{class:"form-check-label",for:"isMultiAgent"}," ðŸ› Multi-Agent Project (Legion) ",-1)),m[9]||(m[9]=s("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),s("div",Ay,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":m[3]||(m[3]=E=>i.value.createSession=E)},null,512),[[Ot,i.value.createSession]]),s("label",My," Create initial "+w(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(p(),v("div",Oy,[s("label",Ny," Initial "+w(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),ne(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":m[4]||(m[4]=E=>i.value.sessionName=E),placeholder:"main"},null,512),[[me,i.value.sessionName]])])):N("",!0),c.value?(p(),v("div",Dy,w(c.value),1)):N("",!0)],32)]),s("div",Ly,[m[10]||(m[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:r.value},[r.value?(p(),v("span",Py)):N("",!0),te(" "+w(r.value?"Creating...":"Create Project"),1)],8,Iy)])])])],512))}},Ry=G(jy,[["__scopeId","data-v-adf50394"]]),Hy={class:"modal-dialog"},Vy={class:"modal-content"},Wy={class:"modal-body"},Fy={class:"mb-3"},Uy={key:0,class:"invalid-feedback"},By={class:"mb-3"},qy=["value"],zy={key:0,class:"alert alert-danger",role:"alert"},Ky={class:"danger-zone"},Gy={class:"text-muted small"},Yy=["disabled"],Jy={key:0,class:"alert alert-warning mt-3",role:"alert"},Xy={class:"mb-2"},Qy={class:"d-flex gap-2"},Zy=["disabled"],e1={key:0,class:"spinner-border spinner-border-sm me-2"},t1=["disabled"],s1={class:"modal-footer"},n1=["disabled"],o1={key:0,class:"spinner-border spinner-border-sm me-2"},i1={__name:"ProjectEditModal",setup(n){const e=$e(),t=pe(),o=D(null),i=D({name:""}),a=D({name:""}),r=D(!1),c=D(!1),f=D(""),_=D(!1),l=D(null);let $=null;const g=y(()=>o.value?.session_ids?.length||0);function h(){a.value={};let S=!0;return i.value.name.trim()||(a.value.name="Project name is required",S=!1),S}async function b(){if(!(!h()||!o.value)){r.value=!0,f.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(S){console.error("Failed to update project:",S),f.value=S.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function d(){if(o.value){c.value=!0,f.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(S){console.error("Failed to delete project:",S),f.value=S.message||"Failed to delete project. Please try again."}finally{c.value=!1}}}function u(){i.value={name:""},a.value={},f.value="",_.value=!1}function m(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function E(){u(),o.value=null,t.hideModal()}return ce(()=>t.currentModal,S=>{if(S?.name==="edit-project"&&$){const O=S.data||{};o.value=O.project,o.value&&(i.value.name=o.value.name),$.show()}}),fe(()=>{l.value&&ge(async()=>{const{default:S}=await import("./modal-BK1Vt_in.js").then(O=>O.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{$=new S(l.value),l.value.addEventListener("shown.bs.modal",m),l.value.addEventListener("hidden.bs.modal",E)})}),he(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",m),l.value.removeEventListener("hidden.bs.modal",E)),$&&$.dispose()}),(S,O)=>(p(),v("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",Hy,[s("div",Vy,[O[10]||(O[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Wy,[s("form",{onSubmit:Ee(b,["prevent"])},[s("div",Fy,[O[3]||(O[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ne(s("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":O[0]||(O[0]=I=>i.value.name=I),placeholder:"My Project",required:""},null,2),[[me,i.value.name]]),a.value.name?(p(),v("div",Uy,w(a.value.name),1)):N("",!0)]),s("div",By,[O[4]||(O[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,qy),O[5]||(O[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),f.value?(p(),v("div",zy,w(f.value),1)):N("",!0)],32),O[8]||(O[8]=s("hr",null,null,-1)),s("div",Ky,[O[6]||(O[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",Gy," Deleting this project will also delete all "+w(g.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:O[1]||(O[1]=I=>_.value=!0),disabled:c.value}," ðŸ—‘ï¸ Delete Project ",8,Yy)]),_.value?(p(),v("div",Jy,[O[7]||(O[7]=s("strong",null,"Are you sure?",-1)),s("p",Xy,' This will permanently delete the project "'+w(o.value?.name)+'" and all '+w(g.value)+" session(s). ",1),s("div",Qy,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:d,disabled:c.value},[c.value?(p(),v("span",e1)):N("",!0),te(" "+w(c.value?"Deleting...":"Yes, Delete Permanently"),1)],8,Zy),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:O[2]||(O[2]=I=>_.value=!1),disabled:c.value}," Cancel ",8,t1)])])):N("",!0)]),s("div",s1,[O[9]||(O[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:r.value},[r.value?(p(),v("span",o1)):N("",!0),te(" "+w(r.value?"Saving...":"Save Changes"),1)],8,n1)])])])],512))}},a1=G(i1,[["__scopeId","data-v-52679516"]]),r1={class:"modal-dialog modal-lg"},l1={class:"modal-content"},c1={class:"modal-header"},u1={class:"modal-title",id:"createSessionModalLabel"},d1={key:0,class:"text-muted small"},m1={class:"modal-body"},p1={class:"mb-3"},f1={key:0,class:"invalid-feedback"},v1={class:"mb-3"},h1={class:"mb-3"},_1={key:0,class:"form-text text-muted"},g1={class:"mb-3"},b1={class:"form-text d-flex justify-content-between"},y1={key:0,class:"invalid-feedback"},$1={class:"mb-3 form-check"},w1={key:0,class:"form-text text-warning"},E1={class:"mb-3"},C1={class:"mb-3 form-check"},S1={key:0,class:"alert alert-danger",role:"alert"},T1={class:"modal-footer"},k1=["disabled"],x1={key:0,class:"spinner-border spinner-border-sm me-2"},A1={__name:"SessionCreateModal",setup(n){const e=ot();$e();const t=ie(),o=pe(),i=D(null),a=D({name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0}),r=D({name:""}),c=D(!1),f=D(""),_=D(null);let l=null;const $={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},g=y(()=>a.value.system_prompt.length),h=y(()=>g.value>6e3),b=y(()=>g.value>5500&&g.value<=6e3),d=y(()=>$[a.value.model]||null);function u(){r.value={};let I=!0;return a.value.name.trim()||(r.value.name="Session name is required",I=!1),h.value&&(I=!1),I}async function m(){if(!(!u()||!i.value)){c.value=!0,f.value="";try{const I=a.value.allowed_tools.split(",").map(A=>A.trim()).filter(A=>A.length>0),x={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,allowed_tools:I},k=await t.createSession(i.value.project_id,x);a.value.startImmediately&&await t.startSession(k.session_id),e.push(`/session/${k.session_id}`),l&&l.hide(),E()}catch(I){console.error("Failed to create session:",I),f.value=I.message||"Failed to create session. Please try again."}finally{c.value=!1}}}function E(){a.value={name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0},r.value={},f.value=""}function S(){const I=document.getElementById("sessionName");I&&I.focus()}function O(){E(),i.value=null,o.hideModal()}return ce(()=>o.currentModal,I=>{if(I?.name==="create-session"&&l){const x=I.data||{};i.value=x.project,l.show()}}),fe(()=>{_.value&&ge(async()=>{const{default:I}=await import("./modal-BK1Vt_in.js").then(x=>x.m);return{default:I}},__vite__mapDeps([0,1])).then(({default:I})=>{l=new I(_.value),_.value.addEventListener("shown.bs.modal",S),_.value.addEventListener("hidden.bs.modal",O)})}),he(()=>{_.value&&(_.value.removeEventListener("shown.bs.modal",S),_.value.removeEventListener("hidden.bs.modal",O)),l&&l.dispose()}),(I,x)=>(p(),v("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:_},[s("div",r1,[s("div",l1,[s("div",c1,[s("h5",u1,[x[7]||(x[7]=te(" Create New Session ",-1)),i.value?(p(),v("span",d1,"in "+w(i.value.name),1)):N("",!0)]),x[8]||(x[8]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",m1,[s("form",{onSubmit:Ee(m,["prevent"])},[s("div",p1,[x[9]||(x[9]=s("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),ne(s("input",{type:"text",class:z(["form-control",{"is-invalid":r.value.name}]),id:"sessionName","onUpdate:modelValue":x[0]||(x[0]=k=>a.value.name=k),placeholder:"main",required:""},null,2),[[me,a.value.name]]),r.value.name?(p(),v("div",f1,w(r.value.name),1)):N("",!0)]),s("div",v1,[x[11]||(x[11]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ne(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":x[1]||(x[1]=k=>a.value.permission_mode=k)},[...x[10]||(x[10]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Re,a.value.permission_mode]]),x[12]||(x[12]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",h1,[x[14]||(x[14]=s("label",{for:"model",class:"form-label"},"Model",-1)),ne(s("select",{class:"form-select",id:"model","onUpdate:modelValue":x[2]||(x[2]=k=>a.value.model=k)},[...x[13]||(x[13]=[s("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),s("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),s("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),s("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Re,a.value.model]]),d.value?(p(),v("small",_1,w(d.value.description),1)):N("",!0)]),s("div",g1,[x[15]||(x[15]=s("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),ne(s("textarea",{class:z(["form-control",{"is-invalid":h.value}]),id:"systemPrompt","onUpdate:modelValue":x[3]||(x[3]=k=>a.value.system_prompt=k),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[me,a.value.system_prompt]]),s("div",b1,[s("span",null,w(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),s("span",{class:z({"text-danger":h.value,"text-warning":b.value})},w(g.value)+" / 6000 chars ",3)]),h.value?(p(),v("div",y1," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):N("",!0)]),s("div",$1,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":x[4]||(x[4]=k=>a.value.override_system_prompt=k)},null,512),[[Ot,a.value.override_system_prompt]]),x[17]||(x[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(p(),v("div",w1,[...x[16]||(x[16]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):N("",!0)]),s("div",E1,[x[18]||(x[18]=s("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),ne(s("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":x[5]||(x[5]=k=>a.value.allowed_tools=k),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[me,a.value.allowed_tools]]),x[19]||(x[19]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",C1,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":x[6]||(x[6]=k=>a.value.startImmediately=k)},null,512),[[Ot,a.value.startImmediately]]),x[20]||(x[20]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),f.value?(p(),v("div",S1,w(f.value),1)):N("",!0)],32)]),s("div",T1,[x[21]||(x[21]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:c.value},[c.value?(p(),v("span",x1)):N("",!0),te(" "+w(c.value?"Creating...":"Create Session"),1)],8,k1)])])])],512))}},M1=G(A1,[["__scopeId","data-v-8bfe4c32"]]),O1={class:"modal-dialog"},N1={class:"modal-content"},D1={class:"modal-body"},L1={class:"mb-3"},I1={key:0,class:"invalid-feedback"},P1={class:"mb-3"},j1=["value"],R1={class:"mb-3"},H1={class:"form-control-plaintext"},V1={class:"mb-3"},W1=["disabled"],F1={key:0,value:"bypassPermissions"},U1={class:"form-text"},B1={key:0,class:"text-warning"},q1={key:1},z1={key:0,class:"mb-3"},K1={class:"card"},G1={class:"card-body"},Y1={key:0,class:"mb-2"},J1={key:1,class:"mb-2"},X1={key:2,class:"mt-2"},Q1={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},Z1={key:1,class:"alert alert-danger",role:"alert"},e$={class:"modal-footer"},t$=["disabled"],s$={key:0,class:"spinner-border spinner-border-sm me-2"},n$={__name:"SessionEditModal",setup(n){const e=ie(),t=pe(),o=D(null),i=D({name:"",permission_mode:"default"}),a=D({name:""}),r=D(!1),c=D(""),f=D(null);let _=null;const l=y(()=>o.value?.state==="active"||o.value?.state==="starting"),$=y(()=>o.value?.initial_permission_mode==="bypassPermissions");function g(E){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[E]||"bg-secondary"}function h(){a.value={};let E=!0;return i.value.name.trim()||(a.value.name="Session name is required",E=!1),E}async function b(){if(!(!h()||!o.value)){r.value=!0,c.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),_&&_.hide()}catch(E){console.error("Failed to update session:",E),c.value=E.message||"Failed to update session. Please try again."}finally{r.value=!1}}}function d(){i.value={name:"",permission_mode:"default"},a.value={},c.value=""}function u(){const E=document.getElementById("editSessionName");E&&(E.focus(),E.select())}function m(){d(),o.value=null,t.hideModal()}return ce(()=>t.currentModal,E=>{if(E?.name==="edit-session"&&_){const S=E.data||{};o.value=S.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),_.show()}}),fe(()=>{f.value&&ge(async()=>{const{default:E}=await import("./modal-BK1Vt_in.js").then(S=>S.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{_=new E(f.value),f.value.addEventListener("shown.bs.modal",u),f.value.addEventListener("hidden.bs.modal",m)})}),he(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",u),f.value.removeEventListener("hidden.bs.modal",m)),_&&_.dispose()}),(E,S)=>(p(),v("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[s("div",O1,[s("div",N1,[S[15]||(S[15]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",D1,[s("form",{onSubmit:Ee(b,["prevent"])},[s("div",L1,[S[2]||(S[2]=s("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),ne(s("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":S[0]||(S[0]=O=>i.value.name=O),placeholder:"Session Name",required:""},null,2),[[me,i.value.name]]),a.value.name?(p(),v("div",I1,w(a.value.name),1)):N("",!0)]),s("div",P1,[S[3]||(S[3]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,j1),S[4]||(S[4]=s("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),s("div",R1,[S[5]||(S[5]=s("label",{class:"form-label"},"Current State",-1)),s("div",H1,[s("span",{class:z(["badge",g(o.value?.state)])},w(o.value?.state),3)])]),s("div",V1,[S[9]||(S[9]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ne(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":S[1]||(S[1]=O=>i.value.permission_mode=O),disabled:!l.value},[S[6]||(S[6]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),S[7]||(S[7]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),S[8]||(S[8]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),$.value?(p(),v("option",F1,"âš ï¸ Bypass Permissions (No prompts)")):N("",!0)],8,W1),[[Re,i.value.permission_mode]]),s("div",U1,[l.value?(p(),v("span",q1," Controls which tool actions require permission prompts ")):(p(),v("span",B1," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(p(),v("div",z1,[S[13]||(S[13]=s("label",{class:"form-label"},"System Prompt Configuration",-1)),s("div",K1,[s("div",G1,[o.value?.override_system_prompt?(p(),v("div",Y1,[...S[10]||(S[10]=[s("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),s("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(p(),v("div",J1,[...S[11]||(S[11]=[s("span",{class:"badge bg-info"},"Append Mode",-1),s("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(p(),v("div",X1,[S[12]||(S[12]=s("strong",{class:"small"},"Custom Instructions:",-1)),s("div",Q1,w(o.value.system_prompt),1)])):N("",!0)])])])):N("",!0),c.value?(p(),v("div",Z1,w(c.value),1)):N("",!0)],32)]),s("div",e$,[S[14]||(S[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:r.value},[r.value?(p(),v("span",s$)):N("",!0),te(" "+w(r.value?"Saving...":"Save Changes"),1)],8,t$)])])])],512))}},o$=G(n$,[["__scopeId","data-v-c99ca17f"]]),i$={class:"modal-dialog modal-dialog-centered"},a$={class:"modal-content"},r$={class:"modal-header"},l$={class:"modal-title",id:"manageSessionModalLabel"},c$={class:"modal-body"},u$={key:0,class:"text-center py-4"},d$={class:"text-muted"},m$={key:1},p$={key:2},f$={class:"text-muted"},v$={key:3},h$={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},_$={class:"d-grid gap-2"},g$=["disabled"],b$=["disabled"],y$=["disabled"],$$=["disabled"],w$={class:"modal-footer"},E$={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},C$={__name:"SessionManageModal",setup(n){const e=ot(),t=ie(),o=pe(),i=Ve();Oe();const a=D(null),r=D(!1),c=D(""),f=D(""),_=D(null),l=D(null);let $=null;const g=y(()=>_.value==="reset"?"Reset Session":_.value==="delete"?"Delete Session":"Manage Session");function h(){_.value="reset"}function b(){_.value="delete"}function d(){_.value=null}async function u(){_.value==="reset"?await S():_.value==="delete"&&await O()}async function m(){if(a.value){r.value=!0,c.value="Restarting session...";try{const k=a.value.session_id,A=await oe.post(`/api/sessions/${k}/restart`);if(A.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(k),$&&$.hide();else{const B=A.error||A.detail||"Failed to restart session";console.error("Failed to restart session:",B),f.value=`Failed to restart session: ${B}`}}catch(k){console.error("Error restarting session:",k);const A=k.data?.detail||k.message||"Unknown error";f.value=`Error restarting session: ${A}`}finally{r.value=!1}}}async function E(){if(a.value)try{$&&$.hide(),console.log("Ending session",a.value.session_id);const k=a.value.session_id;await oe.post(`/api/sessions/${k}/terminate`),await i.disconnectSession(),t.currentSessionId===k&&(t.currentSessionId=null),e.push("/")}catch(k){console.error("Error ending session:",k),await i.disconnectSession(),t.currentSessionId===a.value?.session_id&&(t.currentSessionId=null),e.push("/")}}async function S(){if(a.value){r.value=!0,c.value="Resetting session...";try{const k=a.value.session_id,A=await oe.post(`/api/sessions/${k}/reset`);if(A.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(k),$&&$.hide();else{const B=A.error||A.detail||"Failed to reset session";console.error("Failed to reset session:",B),f.value=`Failed to reset session: ${B}`,_.value=null}}catch(k){console.error("Error resetting session:",k);const A=k.data?.detail||k.message||"Unknown error";f.value=`Error resetting session: ${A}`,_.value=null}finally{r.value=!1}}}async function O(){if(a.value){r.value=!0,c.value="Deleting session...";try{const k=a.value.session_id;await t.deleteSession(k),e.currentRoute.value.params.sessionId===k&&e.push("/"),$&&$.hide()}catch(k){console.error("Error deleting session:",k);const A=k.data?.detail||k.message||"Unknown error";f.value=`Error deleting session: ${A}`,_.value=null}finally{r.value=!1}}}function I(){_.value=null,r.value=!1,c.value="",f.value=""}function x(){I(),a.value=null,o.hideModal()}return ce(()=>o.currentModal,k=>{if(k?.name==="manage-session"&&$){const A=k.data||{};a.value=A.session,I(),$.show()}}),fe(()=>{l.value&&ge(async()=>{const{default:k}=await import("./modal-BK1Vt_in.js").then(A=>A.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{$=new k(l.value),l.value.addEventListener("hidden.bs.modal",x)})}),he(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",x),$&&$.dispose()}),(k,A)=>(p(),v("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",i$,[s("div",a$,[s("div",r$,[s("h5",l$,w(_.value?g.value:"Manage Session"),1),A[1]||(A[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",c$,[r.value?(p(),v("div",u$,[A[2]||(A[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",d$,w(c.value),1)])):_.value==="reset"?(p(),v("div",m$,[...A[3]||(A[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):_.value==="delete"?(p(),v("div",p$,[A[6]||(A[6]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",f$,[A[4]||(A[4]=te("This will permanently delete session ",-1)),s("strong",null,w(a.value?.name),1),A[5]||(A[5]=te(".",-1))]),A[7]||(A[7]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(p(),v("div",v$,[f.value?(p(),v("div",h$,[A[8]||(A[8]=s("strong",null,"Error:",-1)),te(" "+w(f.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:A[0]||(A[0]=B=>f.value="")})])):N("",!0),A[15]||(A[15]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",_$,[s("button",{class:"btn btn-outline-primary text-start",onClick:m,disabled:r.value},[...A[9]||(A[9]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,g$),s("button",{class:"btn btn-outline-secondary text-start",onClick:E,disabled:r.value},[...A[10]||(A[10]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,b$),A[13]||(A[13]=s("hr",{class:"my-2"},null,-1)),A[14]||(A[14]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:h,disabled:r.value},[...A[11]||(A[11]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,y$),s("button",{class:"btn btn-outline-danger text-start",onClick:b,disabled:r.value},[...A[12]||(A[12]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,$$)]),A[16]||(A[16]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),te(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",w$,[_.value&&!r.value?(p(),v(re,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:d},"Cancel"),s("button",{type:"button",class:z(["btn",_.value==="delete"?"btn-danger":"btn-warning"]),onClick:u},w(_.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?N("",!0):(p(),v("button",E$,"Cancel"))])])])],512))}},S$=G(C$,[["__scopeId","data-v-9122e4df"]]),T$={class:"modal-dialog modal-dialog-centered modal-lg"},k$={class:"modal-content"},x$={class:"modal-body"},A$={key:0,class:"text-center text-muted py-4"},M$={key:1},O$={class:"mb-3"},N$={class:"font-monospace small"},D$={class:"mb-3"},L$=["value"],I$={class:"mb-3"},P$={class:"mb-3"},j$={class:"mb-3"},R$={key:0},H$={class:"d-flex flex-wrap gap-1"},V$={key:1,class:"text-muted small"},W$={key:0,class:"mb-3"},F$={class:"d-flex flex-wrap gap-1"},U$={key:1,class:"mb-3"},B$={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},q$={class:"mb-3"},z$={class:"text-muted"},K$={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},G$={__name:"SessionInfoModal",setup(n){const e=ie(),t=Oe(),o=pe(),i=D(null),a=D(!1),r=D(null);let c=null;const f={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},_=y(()=>{if(!i.value)return null;const d=e.initData.get(i.value);return d||(t.messagesBySession.get(i.value)||[]).find(E=>E.type==="system"&&(E.subtype==="init"||E.metadata?.subtype==="init")&&E.metadata?.init_data)?.metadata?.init_data||null});function l(d){return d?f[d]||d:"Default (Sonnet 4.5)"}function $(d){return typeof d=="string"?d:typeof d=="object"&&d.type==="preset"?`Preset: ${d.preset}`:JSON.stringify(d,null,2)}function g(d){d.target.select()}function h(){i.value=null,a.value=!1}function b(){h(),o.hideModal()}return ce(()=>o.currentModal,d=>{if(d?.name==="session-info"&&c){const u=d.data||{};i.value=u.sessionId,a.value=!1,c.show()}}),fe(()=>{r.value&&ge(async()=>{const{default:d}=await import("./modal-BK1Vt_in.js").then(u=>u.m);return{default:d}},__vite__mapDeps([0,1])).then(({default:d})=>{c=new d(r.value),r.value.addEventListener("hidden.bs.modal",b)})}),he(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",b),c&&c.dispose()}),(d,u)=>(p(),v("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",T$,[s("div",k$,[u[9]||(u[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",x$,[_.value?(p(),v("div",M$,[s("div",O$,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",N$,w(i.value),1)]),s("div",D$,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:_.value.cwd||"Not specified",readonly:"",onClick:g},null,8,L$)]),s("div",I$,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,w(l(_.value.model)),1)]),s("div",P$,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,w(_.value.permissionMode||"default"),1)]),s("div",j$,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(_.value.allowed_tools||_.value.tools)&&(_.value.allowed_tools||_.value.tools).length>0?(p(),v("div",R$,[s("div",H$,[(p(!0),v(re,null,de(_.value.allowed_tools||_.value.tools,m=>(p(),v("span",{key:m,class:"badge bg-secondary"},w(m),1))),128))])])):(p(),v("div",V$,"No pre-authorized tools (will prompt for permissions)"))]),_.value.commands&&_.value.commands.length>0?(p(),v("div",W$,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",F$,[(p(!0),v(re,null,de(_.value.commands,m=>(p(),v("span",{key:m,class:"badge bg-info"},w(m),1))),128))])])):N("",!0),_.value.systemPrompt?(p(),v("div",U$,[u[7]||(u[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",B$,w($(_.value.systemPrompt)),1)])):N("",!0),s("div",q$,[s("h6",z$,[u[8]||(u[8]=te(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:u[0]||(u[0]=m=>a.value=!a.value)},w(a.value?"Hide":"Show"),1)]),a.value?(p(),v("pre",K$,w(JSON.stringify(_.value,null,2)),1)):N("",!0)])])):(p(),v("div",A$," No session configuration data available "))]),u[10]||(u[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},Y$=G(G$,[["__scopeId","data-v-b28b39b3"]]),J$={class:"modal-dialog modal-dialog-centered"},X$={class:"modal-content"},Q$={class:"modal-body"},Z$={class:"mb-3"},ew=["value"],tw={key:0,class:"form-text"},sw={class:"mb-3"},nw={class:"mb-3"},ow={for:"minion-role",class:"form-label"},iw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},aw={key:1,class:"field-indicator modified",title:"Modified from template"},rw=["placeholder","title"],lw={class:"mb-3"},cw={for:"minion-context",class:"form-label"},uw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},dw={key:1,class:"field-indicator modified",title:"Modified from template"},mw=["title"],pw={class:"form-text d-flex justify-content-between"},fw={key:0,class:"invalid-feedback"},vw={class:"mb-3 form-check"},hw={key:0,class:"form-text text-warning"},_w={class:"mb-3"},gw={class:"mb-3"},bw={class:"input-group"},yw={class:"mb-3"},$w={for:"permission-mode",class:"form-label"},ww={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Ew={key:1,class:"field-indicator modified",title:"Modified from template"},Cw=["title"],Sw={class:"mb-3"},Tw={for:"allowed-tools",class:"form-label"},kw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},xw={key:1,class:"field-indicator modified",title:"Modified from template"},Aw=["title"],Mw={key:0,class:"alert alert-danger"},Ow={class:"modal-footer"},Nw=["disabled"],Dw={key:0,class:"spinner-border spinner-border-sm me-2"},Lw={__name:"CreateMinionModal",setup(n){const e=ot(),t=$e(),o=ie(),i=pe(),a=D(null);let r=null;const c=D(null),f=D([]),_=D(null),l=D(new Set),$=D({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),g=D({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),h=D({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:""}),b=D(""),d=D(""),u=D(!1),m=y(()=>b.value.trim()?b.value.split(",").map(U=>U.trim()).filter(U=>U.length>0):[]),E=y(()=>h.value.allowed_tools.trim()?h.value.allowed_tools.split(",").map(U=>U.trim()).filter(U=>U.length>0):null),S=y(()=>h.value.initialization_context.length),O=y(()=>S.value>2e3),I=y(()=>S.value>1800&&S.value<=2e3),x=y(()=>_.value?f.value.find(U=>U.template_id===_.value):null),k=y(()=>x.value?.default_role||"e.g., Code Expert, Testing Specialist"),A=y(()=>({"field-autofilled":g.value.role==="autofilled","field-modified":g.value.role==="modified"})),B=y(()=>({"field-autofilled":g.value.initialization_context==="autofilled","field-modified":g.value.initialization_context==="modified"})),Z=y(()=>({"field-autofilled":g.value.permission_mode==="autofilled","field-modified":g.value.permission_mode==="modified"})),j=y(()=>({"field-autofilled":g.value.allowed_tools==="autofilled","field-modified":g.value.allowed_tools==="modified"})),C=U=>{const W=g.value[U];return W==="autofilled"?`Auto-filled from template: ${x.value?.name}`:W==="modified"?"Modified from template value":""};async function T(){try{console.log("[CreateMinionModal] Loading templates...");const U=await oe.get("/api/templates");console.log("[CreateMinionModal] Templates data:",U),f.value=U||[],console.log("[CreateMinionModal] Templates set to:",f.value)}catch(U){console.error("[CreateMinionModal] Failed to load templates:",U),f.value=[]}}function L(){if(l.value.clear(),!x.value){h.value.role="",h.value.initialization_context="",h.value.permission_mode="default",h.value.allowed_tools="",g.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const U=x.value;if(g.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},U.default_role?(h.value.role=U.default_role,l.value.add("role"),$.value.role=U.default_role,g.value.role="autofilled"):(h.value.role="",$.value.role=null,g.value.role="normal"),U.default_system_prompt?(h.value.initialization_context=U.default_system_prompt,l.value.add("initialization_context"),$.value.initialization_context=U.default_system_prompt,g.value.initialization_context="autofilled"):(h.value.initialization_context="",$.value.initialization_context=null,g.value.initialization_context="normal"),U.permission_mode?(h.value.permission_mode=U.permission_mode,l.value.add("permission_mode"),$.value.permission_mode=U.permission_mode,g.value.permission_mode="autofilled"):(h.value.permission_mode="default",$.value.permission_mode=null,g.value.permission_mode="normal"),U.allowed_tools&&U.allowed_tools.length>0){const W=U.allowed_tools.join(", ");h.value.allowed_tools=W,l.value.add("allowed_tools"),$.value.allowed_tools=W,g.value.allowed_tools="autofilled"}else h.value.allowed_tools="",$.value.allowed_tools=null,g.value.allowed_tools="normal"}function M(){i.showModal("template-management",{})}function R(){const W=(c.value?t.projects.get(c.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:W,currentPath:h.value.working_directory||"",onSelect:se=>{h.value.working_directory=se}})}function H(){h.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:""},b.value="",_.value=null,l.value.clear(),g.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},d.value="",u.value=!1}function J(){H(),i.hideModal()}async function ae(){if(!h.value.name.trim()){d.value="Minion name is required";return}if(h.value.name.includes(" ")){d.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(O.value){d.value="Initialization context exceeds 2000 character limit";return}if(!c.value){d.value="Legion ID is missing";return}u.value=!0,d.value="";try{const U={name:h.value.name.trim(),role:h.value.role.trim(),initialization_context:h.value.initialization_context.trim(),override_system_prompt:h.value.override_system_prompt,capabilities:m.value,permission_mode:h.value.permission_mode,allowed_tools:E.value,working_directory:h.value.working_directory.trim()||null},W=await oe.post(`/api/legions/${c.value}/minions`,U);W.success&&W.minion_id?(await t.fetchProjects(),await o.fetchSessions(),r&&r.hide(),e.push(`/spy/${c.value}/${W.minion_id}`)):d.value="Failed to create minion"}catch(U){console.error("Failed to create minion:",U),d.value=U.response?.data?.detail||"Failed to create minion"}finally{u.value=!1}}return ce(()=>i.currentModal,(U,W)=>{if(U?.name==="create-minion"&&r){const se=U.data||{};c.value=se.project?.project_id||null,H(),T(),r.show()}else W?.name==="template-management"&&r&&a.value?.classList.contains("show")&&T()}),ce(()=>h.value.role,U=>{$.value.role!==null&&(U===$.value.role?g.value.role="autofilled":g.value.role="modified")}),ce(()=>h.value.initialization_context,U=>{$.value.initialization_context!==null&&(U===$.value.initialization_context?g.value.initialization_context="autofilled":g.value.initialization_context="modified")}),ce(()=>h.value.permission_mode,U=>{$.value.permission_mode!==null&&(U===$.value.permission_mode?g.value.permission_mode="autofilled":g.value.permission_mode="modified")}),ce(()=>h.value.allowed_tools,U=>{$.value.allowed_tools!==null&&(U===$.value.allowed_tools?g.value.allowed_tools="autofilled":g.value.allowed_tools="modified")}),fe(()=>{a.value&&ge(()=>import("./modal-BK1Vt_in.js").then(U=>U.m),__vite__mapDeps([0,1])).then(U=>{const W=U.default;r=new W(a.value),a.value.addEventListener("hidden.bs.modal",J)}),T()}),he(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",J),r&&r.dispose()}),(U,W)=>(p(),v("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[s("div",J$,[s("div",X$,[W[28]||(W[28]=s("div",{class:"modal-header"},[s("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Q$,[s("form",{onSubmit:Ee(ae,["prevent"])},[s("div",Z$,[s("label",{for:"template-select",class:"form-label"},[W[9]||(W[9]=te(" Template ",-1)),s("button",{type:"button",onClick:M,class:"btn btn-link btn-sm p-0 ms-2"}," âš™ï¸ Manage Templates ")]),ne(s("select",{id:"template-select","onUpdate:modelValue":W[0]||(W[0]=se=>_.value=se),onChange:L,class:"form-select"},[W[10]||(W[10]=s("option",{value:null},"[None - Manual Configuration]",-1)),(p(!0),v(re,null,de(f.value,se=>(p(),v("option",{key:se.template_id,value:se.template_id},w(se.name),9,ew))),128))],544),[[Re,_.value]]),x.value?(p(),v("div",tw,w(x.value.description),1)):N("",!0)]),s("div",sw,[W[11]||(W[11]=s("label",{for:"minion-name",class:"form-label"},[te(" Name "),s("span",{class:"text-danger"},"*")],-1)),ne(s("input",{id:"minion-name","onUpdate:modelValue":W[1]||(W[1]=se=>h.value.name=se),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[me,h.value.name]]),W[12]||(W[12]=s("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),s("div",nw,[s("label",ow,[W[13]||(W[13]=te(" Role ",-1)),g.value.role==="autofilled"?(p(),v("span",iw," âš¡ ")):N("",!0),g.value.role==="modified"?(p(),v("span",aw," âœï¸ ")):N("",!0)]),ne(s("input",{id:"minion-role","onUpdate:modelValue":W[2]||(W[2]=se=>h.value.role=se),type:"text",class:z(["form-control",A.value]),placeholder:k.value,title:C("role")},null,10,rw),[[me,h.value.role]]),W[14]||(W[14]=s("div",{class:"form-text"}," Optional role description for the minion ",-1))]),s("div",lw,[s("label",cw,[W[15]||(W[15]=te(" Initialization Context ",-1)),g.value.initialization_context==="autofilled"?(p(),v("span",uw," âš¡ ")):N("",!0),g.value.initialization_context==="modified"?(p(),v("span",dw," âœï¸ ")):N("",!0)]),ne(s("textarea",{id:"minion-context","onUpdate:modelValue":W[3]||(W[3]=se=>h.value.initialization_context=se),class:z(["form-control",[B.value,{"is-invalid":O.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:C("initialization_context")},null,10,mw),[[me,h.value.initialization_context]]),s("div",pw,[s("span",null,w(h.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),s("span",{class:z({"text-danger":O.value,"text-warning":I.value})},w(S.value)+" / 2000 chars ",3)]),O.value?(p(),v("div",fw," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):N("",!0)]),s("div",vw,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":W[4]||(W[4]=se=>h.value.override_system_prompt=se)},null,512),[[Ot,h.value.override_system_prompt]]),W[17]||(W[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),h.value.override_system_prompt?(p(),v("div",hw,[...W[16]||(W[16]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):N("",!0)]),s("div",_w,[W[18]||(W[18]=s("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),ne(s("input",{id:"minion-capabilities","onUpdate:modelValue":W[5]||(W[5]=se=>b.value=se),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[me,b.value]]),W[19]||(W[19]=s("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),s("div",gw,[W[20]||(W[20]=s("label",{for:"working-directory",class:"form-label"}," Working Directory (Optional) ",-1)),s("div",bw,[ne(s("input",{id:"working-directory","onUpdate:modelValue":W[6]||(W[6]=se=>h.value.working_directory=se),type:"text",class:"form-control",placeholder:"Leave empty to inherit from legion"},null,512),[[me,h.value.working_directory]]),s("button",{type:"button",class:"btn btn-outline-secondary",onClick:R}," ðŸ“ Browse ")]),W[21]||(W[21]=s("div",{class:"form-text"}," Custom working directory for git worktrees or multi-repo workflows. Relative paths will be converted to absolute. ",-1))]),s("div",yw,[s("label",$w,[W[22]||(W[22]=te(" Permission Mode ",-1)),g.value.permission_mode==="autofilled"?(p(),v("span",ww," âš¡ ")):N("",!0),g.value.permission_mode==="modified"?(p(),v("span",Ew," âœï¸ ")):N("",!0)]),ne(s("select",{class:z(["form-select",Z.value]),id:"permission-mode","onUpdate:modelValue":W[7]||(W[7]=se=>h.value.permission_mode=se),title:C("permission_mode")},[...W[23]||(W[23]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,Cw),[[Re,h.value.permission_mode]]),W[24]||(W[24]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",Sw,[s("label",Tw,[W[25]||(W[25]=te(" Allowed Tools (Optional) ",-1)),g.value.allowed_tools==="autofilled"?(p(),v("span",kw," âš¡ ")):N("",!0),g.value.allowed_tools==="modified"?(p(),v("span",xw," âœï¸ ")):N("",!0)]),ne(s("input",{type:"text",class:z(["form-control",j.value]),id:"allowed-tools","onUpdate:modelValue":W[8]||(W[8]=se=>h.value.allowed_tools=se),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:C("allowed_tools")},null,10,Aw),[[me,h.value.allowed_tools]]),W[26]||(W[26]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),d.value?(p(),v("div",Mw,w(d.value),1)):N("",!0)],32)]),s("div",Ow,[W[27]||(W[27]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",disabled:!h.value.name.trim()||u.value,onClick:ae},[u.value?(p(),v("span",Dw)):N("",!0),te(" "+w(u.value?"Creating...":"Create Minion"),1)],8,Nw)])])])],512))}},Iw=G(Lw,[["__scopeId","data-v-df1241b1"]]),Pw={class:"modal-dialog modal-dialog-centered modal-lg"},jw={class:"modal-content"},Rw={class:"modal-body"},Hw={key:0,class:"text-center text-muted py-4"},Vw={key:1},Ww={class:"mb-3"},Fw={class:"mb-3"},Uw={class:"font-monospace small"},Bw={class:"mb-3"},qw={class:"mb-3"},zw={class:"mb-3"},Kw={key:0},Gw={class:"d-flex flex-wrap gap-1"},Yw={key:1,class:"text-muted small"},Jw={class:"mb-3"},Xw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},Qw={key:1,class:"text-muted small"},Zw={class:"mb-3"},eE={key:0,class:"badge bg-info"},tE={key:1,class:"badge bg-secondary"},sE={class:"mb-3"},nE={key:0,class:"font-monospace small"},oE={key:1,class:"text-muted small"},iE={key:0,class:"mb-3"},aE={key:0},rE={class:"list-unstyled mb-0"},lE={key:1,class:"text-muted small"},cE={class:"mb-3"},uE={key:0},dE={class:"d-flex flex-wrap gap-1"},mE={key:1,class:"text-muted small"},pE={class:"mb-3"},fE={class:"small"},vE={class:"mb-3"},hE={class:"small"},_E={__name:"MinionViewModal",setup(n){const e=pe(),t=D(null),o=D(null);let i=null;function a(_){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[_]||"bg-secondary"}function r(_){if(!_)return"N/A";try{const l=new Date(_);return isNaN(l.getTime())?"Invalid date":l.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(l){return console.error("Error formatting timestamp:",l),"Invalid date"}}function c(){t.value=null}function f(){c(),e.hideModal()}return ce(()=>e.currentModal,_=>{if(_?.name==="minion-view"&&i){const l=_.data||{};t.value=l.session,i.show()}}),fe(()=>{o.value&&ge(async()=>{const{default:_}=await import("./modal-BK1Vt_in.js").then(l=>l.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{i=new _(o.value),o.value.addEventListener("hidden.bs.modal",f)})}),he(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",f),i&&i.dispose()}),(_,l)=>(p(),v("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",Pw,[s("div",jw,[l[12]||(l[12]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Rw,[t.value?(p(),v("div",Vw,[s("div",Ww,[l[0]||(l[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,w(t.value.name||"Unnamed Minion"),1)]),s("div",Fw,[l[1]||(l[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",Uw,w(t.value.session_id),1)]),s("div",Bw,[l[2]||(l[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,w(t.value.role||"Not specified"),1)]),s("div",qw,[l[3]||(l[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:z(["badge",a(t.value.state)])},w(t.value.state),3)])]),s("div",zw,[l[4]||(l[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(p(),v("div",Kw,[s("div",Gw,[(p(!0),v(re,null,de(t.value.capabilities,$=>(p(),v("span",{key:$,class:"badge bg-secondary"},w($),1))),128))])])):(p(),v("div",Yw,"None"))]),s("div",Jw,[l[5]||(l[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(p(),v("div",Xw,w(t.value.initialization_context),1)):(p(),v("div",Qw,"Not specified"))]),s("div",Zw,[l[6]||(l[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(p(),v("span",eE,"Yes")):(p(),v("span",tE,"No"))])]),s("div",sE,[l[7]||(l[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(p(),v("div",nE,w(t.value.parent_overseer_id),1)):(p(),v("div",oE,w(t.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),t.value.is_overseer?(p(),v("div",iE,[l[8]||(l[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(p(),v("div",aE,[s("ul",rE,[(p(!0),v(re,null,de(t.value.child_minion_ids,$=>(p(),v("li",{key:$,class:"font-monospace small"},w($),1))),128))])])):(p(),v("div",lE,"No children"))])):N("",!0),s("div",cE,[l[9]||(l[9]=s("h6",{class:"text-muted"},"Channel Memberships",-1)),t.value.channel_ids&&t.value.channel_ids.length>0?(p(),v("div",uE,[s("div",dE,[(p(!0),v(re,null,de(t.value.channel_ids,$=>(p(),v("span",{key:$,class:"badge bg-info"},w($),1))),128))])])):(p(),v("div",mE,"No channels"))]),s("div",pE,[l[10]||(l[10]=s("h6",{class:"text-muted"},"Created",-1)),s("div",fE,w(r(t.value.created_at)),1)]),s("div",vE,[l[11]||(l[11]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",hE,w(r(t.value.updated_at)),1)])])):(p(),v("div",Hw," No minion data available "))]),l[13]||(l[13]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},gE=G(_E,[["__scopeId","data-v-e354cbd8"]]),bE={class:"modal-dialog modal-lg"},yE={class:"modal-content"},$E={class:"modal-body"},wE={key:0,class:"template-list"},EE={key:0,class:"alert alert-info"},CE={class:"card-body"},SE={class:"d-flex justify-content-between align-items-start"},TE={class:"flex-grow-1"},kE={class:"card-title mb-1"},xE={class:"card-text text-muted small mb-2"},AE={class:"template-meta"},ME={class:"badge bg-secondary me-2"},OE={class:"text-muted small"},NE={class:"btn-group btn-group-sm ms-3"},DE=["onClick"],LE=["onClick"],IE={key:1,class:"template-form"},PE={class:"mb-3"},jE={class:"mb-3"},RE={class:"mb-3"},HE={class:"mb-3"},VE={class:"mb-3"},WE={class:"mb-3"},FE={class:"mb-3"},UE={key:0,class:"alert alert-danger"},BE={class:"d-flex gap-2"},qE=["disabled"],zE={key:0,class:"spinner-border spinner-border-sm me-2"},KE={__name:"TemplateManagementModal",setup(n){const e=pe(),t=D(null);let o=null;const i=D([]),a=D(null),r=D(""),c=D(""),f=D(!1);async function _(){try{const u=await oe.get("/api/templates");i.value=u||[]}catch(u){console.error("Failed to load templates:",u),i.value=[]}}function l(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},r.value="",c.value=""}function $(u){a.value={...u},r.value=u.allowed_tools?.join(", ")||"",c.value=""}async function g(){if(!a.value.name.trim()){c.value="Template name is required";return}f.value=!0,c.value="";try{const u=r.value.split(",").map(S=>S.trim()).filter(S=>S.length>0),m={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:u.length>0?u:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await oe.post("/api/templates",m):await oe.put(`/api/templates/${a.value.template_id}`,m),await _(),a.value=null,r.value=""}catch(u){console.error("Failed to save template:",u),c.value=u.response?.data?.detail||"Failed to save template"}finally{f.value=!1}}async function h(u){if(confirm(`Delete template "${u.name}"?

This action cannot be undone.`))try{await oe.delete(`/api/templates/${u.template_id}`),await _()}catch(m){console.error("Failed to delete template:",m),alert(`Failed to delete template: ${m.response?.data?.detail||m.message}`)}}function b(){a.value=null,r.value="",c.value=""}function d(){a.value=null,r.value="",c.value="",e.hideModal()}return ce(()=>e.currentModal,u=>{u?.name==="template-management"&&o&&(_(),o.show())}),fe(()=>{t.value&&ge(()=>import("./modal-BK1Vt_in.js").then(u=>u.m),__vite__mapDeps([0,1])).then(u=>{const m=u.default;o=new m(t.value),t.value.addEventListener("hidden.bs.modal",d)})}),he(()=>{t.value&&t.value.removeEventListener("hidden.bs.modal",d),o&&o.dispose()}),(u,m)=>(p(),v("div",{ref_key:"modalElement",ref:t,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[s("div",bE,[s("div",yE,[m[15]||(m[15]=s("div",{class:"modal-header"},[s("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",$E,[a.value?N("",!0):(p(),v("div",wE,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[m[6]||(m[6]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:l,class:"btn btn-primary btn-sm"}," âž• Create New ")]),i.value.length===0?(p(),v("div",EE," No templates found. Create your first template! ")):N("",!0),(p(!0),v(re,null,de(i.value,E=>(p(),v("div",{key:E.template_id,class:"card mb-2"},[s("div",CE,[s("div",SE,[s("div",TE,[s("h6",kE,w(E.name),1),s("p",xE,w(E.description),1),s("div",AE,[s("span",ME,w(E.permission_mode),1),s("span",OE,w(E.allowed_tools?.length||0)+" tools",1)])]),s("div",NE,[s("button",{onClick:S=>$(E),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,DE),s("button",{onClick:S=>h(E),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,LE)])])])]))),128))])),a.value?(p(),v("div",IE,[s("h6",PE,w(a.value.template_id?"Edit Template":"Create Template"),1),s("div",jE,[m[7]||(m[7]=s("label",{for:"template-name",class:"form-label"},[te(" Name "),s("span",{class:"text-danger"},"*")],-1)),ne(s("input",{id:"template-name","onUpdate:modelValue":m[0]||(m[0]=E=>a.value.name=E),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[me,a.value.name]])]),s("div",RE,[m[8]||(m[8]=s("label",{for:"template-description",class:"form-label"},"Description",-1)),ne(s("textarea",{id:"template-description","onUpdate:modelValue":m[1]||(m[1]=E=>a.value.description=E),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[me,a.value.description]])]),s("div",HE,[m[10]||(m[10]=s("label",{for:"template-permission-mode",class:"form-label"},[te(" Permission Mode "),s("span",{class:"text-danger"},"*")],-1)),ne(s("select",{id:"template-permission-mode","onUpdate:modelValue":m[2]||(m[2]=E=>a.value.permission_mode=E),class:"form-select",required:""},[...m[9]||(m[9]=[s("option",{value:"default"},"Default",-1),s("option",{value:"acceptEdits"},"Accept Edits",-1),s("option",{value:"plan"},"Plan Mode",-1),s("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Re,a.value.permission_mode]])]),s("div",VE,[m[11]||(m[11]=s("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),ne(s("input",{id:"template-tools","onUpdate:modelValue":m[3]||(m[3]=E=>r.value=E),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[me,r.value]]),m[12]||(m[12]=s("div",{class:"form-text"},"Comma-separated list of tools",-1))]),s("div",WE,[m[13]||(m[13]=s("label",{for:"template-role",class:"form-label"},"Default Role",-1)),ne(s("input",{id:"template-role","onUpdate:modelValue":m[4]||(m[4]=E=>a.value.default_role=E),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[me,a.value.default_role]])]),s("div",FE,[m[14]||(m[14]=s("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),ne(s("textarea",{id:"template-prompt","onUpdate:modelValue":m[5]||(m[5]=E=>a.value.default_system_prompt=E),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[me,a.value.default_system_prompt]])]),c.value?(p(),v("div",UE,w(c.value),1)):N("",!0),s("div",BE,[s("button",{onClick:g,class:"btn btn-primary",disabled:f.value},[f.value?(p(),v("span",zE)):N("",!0),te(" "+w(f.value?"Saving...":"Save Template"),1)],8,qE),s("button",{onClick:b,class:"btn btn-secondary"},"Cancel")])])):N("",!0)])])])],512))}},GE=G(KE,[["__scopeId","data-v-81126ff4"]]),YE={class:"container-fluid vh-100 d-flex flex-column p-0"},JE={class:"d-flex flex-grow-1 overflow-hidden position-relative"},XE={class:"flex-grow-1 d-flex flex-column overflow-hidden"},QE={__name:"App",setup(n){const e=pe(),t=Ve(),o=ie(),i=$e(),a=ot(),r=y(()=>e.sidebarCollapsed),c=y(()=>e.isMobile);fe(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const l=window.location.hash;if(l.startsWith("#/session/")){const $=l.replace("#/session/","");o.sessions.has($)&&await o.selectSession($)}else if(l.startsWith("#/timeline/")){const $=l.replace("#/timeline/","");a.push(`/timeline/${$}`)}window.addEventListener("popstate",f),window.addEventListener("resize",e.handleResize)}),he(()=>{window.removeEventListener("popstate",f),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function f(){const l=window.location.hash;if(l.startsWith("#/session/")){const $=l.replace("#/session/","");o.sessions.has($)&&o.selectSession($)}}function _(){e.toggleSidebar()}return(l,$)=>{const g=ao("router-view");return p(),v("div",YE,[ue($b),s("div",{id:"sidebar-backdrop",class:z({show:!r.value&&c.value}),onClick:_},null,2),s("div",JE,[ue(sy),s("main",XE,[ue(g)])]),ue(by),ue(Ry),ue(a1),ue(M1),ue(o$),ue(S$),ue(Y$),ue(Iw),ue(gE),ue(GE)])}}},on=vi(QE);on.use(hi());on.use(mb);on.mount("#app");
