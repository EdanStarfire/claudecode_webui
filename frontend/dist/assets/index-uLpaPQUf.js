const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as s,o as a,d as st,r as P,b as h,t as y,e as M,n as te,u as $e,f as ze,g as ie,w as fe,h as bs,F as re,i as ce,j as ge,v as We,k as be,l as po,m as pe,p as qe,q as ve,s as St,x as ye,y as Si,z as fo,A as Ee,B as _n,C as vo,D as Ft,E as Ei,G as Ci,H as ho,T as Ti,I as xi,J as Ai,K as Mi,L as ys,M as ws,N as gn,O as Oi,P as Di}from"./vue-vendor-CkFj9aRq.js";import{m as dt,p as cs}from"./markdown-vendor-BRsjnVvP.js";import{c as Ni}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const Li={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ii={__name:"NoSessionSelected",setup(n){return(e,t)=>(a(),l("div",Li,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},ji="modulepreload",Pi=function(n){return"/"+n},bn={},xe=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let m=function(p){return Promise.all(p.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=c?.nonce||c?.getAttribute("nonce");i=m(t.map(p=>{if(p=Pi(p),p in bn)return;bn[p]=!0;const u=p.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":ji,u||(g.as="script"),g.crossOrigin="",g.href=p,f&&g.setAttribute("nonce",f),document.head.appendChild(g),u)return new Promise((k,$)=>{g.addEventListener("load",k),g.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${p}`)))})}))}function r(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return i.then(c=>{for(const f of c||[])f.status==="rejected"&&r(f.reason);return e().catch(r)})};class $s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function Et(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new $s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof $s?t:(console.error("API request failed:",t),new $s(`Network error: ${t.message}`,0,null))}}async function _o(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[f,m]of Object.entries(e.params))m!=null&&o.append(f,m);const i=o.toString();i&&(t=`${n}?${i}`);const{params:r,...c}=e;return Et(t,{...c,method:"GET"})}return Et(t,{...e,method:"GET"})}async function Ri(n,e,t={}){return Et(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Wi(n,e,t={}){return Et(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Bi(n,e={}){return Et(n,{...e,method:"DELETE"})}async function Fi(n,e,t={}){return Et(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const me={get:_o,post:Ri,put:Wi,delete:Bi,patch:Fi},de=st("session",()=>{const n=P(new Map),e=P(null),t=P(new Map),o=P(new Map),i=P(new Set),r=P(!1);let c=null;const f=h(()=>n.value.get(e.value)),m=h(()=>Array.from(n.value.values()).sort((O,H)=>O.order-H.order)),p=O=>h(()=>m.value.filter(H=>H.project_id===O)),u=h({get:()=>t.value.get(e.value)||"",set:O=>{e.value&&t.value.set(e.value,O)}});async function w(){try{const O=await me.get("/api/sessions");return n.value.clear(),O.sessions.forEach(H=>{n.value.set(H.session_id,H)}),console.log(`Loaded ${n.value.size} sessions`),O.sessions}catch(O){throw console.error("Failed to fetch sessions:",O),O}}async function g(O,H){try{const A=(await me.post("/api/sessions",{project_id:O,...H})).session_id,K=(await me.get(`/api/sessions/${A}`)).session;return n.value.set(A,K),n.value=new Map(n.value),console.log(`Created session ${A}`),K}catch(x){throw console.error("Failed to create session:",x),x}}async function k(O){if(e.value===O&&!r.value)return;c&&(console.log(`Aborting pending selection to switch to ${O}`),c.abort(),c=null);const H=new AbortController;c=H,r.value=!0;try{if(e.value=O,H.signal.aborted){console.log(`Selection of ${O} aborted early`);return}let x=n.value.get(O);if(!x)try{const L=await me.get(`/api/sessions/${O}`);if(H.signal.aborted){console.log(`Selection of ${O} aborted after fetch`);return}x=L.session,n.value.set(O,x),n.value=new Map(n.value),console.log(`Fetched session ${O} for deeplink`)}catch(L){console.error(`Failed to fetch session ${O}:`,L);return}if(x&&(x.state==="created"||x.state==="terminated"))try{if(await v(O),H.signal.aborted){console.log(`Selection of ${O} aborted after start`);return}console.log(`Auto-started session ${O} (was in ${x.state} state)`);const L=6e4,B=200,q=5e3;let Z=0,D=0;for(;Z<L;){if(H.signal.aborted){console.log(`Selection of ${O} aborted during state wait`);return}const S=n.value.get(O);if(S&&S.state==="active"){console.log(`Session ${O} is now active after ${Z}ms`);break}if(Z-D>=q){const C=n.value.get(O)?.state||"unknown";console.log(`Waiting for session ${O} to become active (current: ${C}, ${Z/1e3}s elapsed)`),D=Z}await new Promise(C=>setTimeout(C,B)),Z+=B}const N=n.value.get(O);N&&N.state!=="active"&&console.warn(`Session ${O} did not become active within ${L/1e3}s (state: ${N.state}), continuing anyway`)}catch(L){console.error(`Failed to auto-start session ${O}:`,L)}if(H.signal.aborted){console.log(`Selection of ${O} aborted before message load`);return}if(await(await xe(()=>Promise.resolve().then(()=>la),void 0)).useMessageStore().loadMessages(O),H.signal.aborted){console.log(`Selection of ${O} aborted after message load`);return}if(await(await xe(()=>Promise.resolve().then(()=>Ma),void 0)).useResourceStore().loadResources(O),H.signal.aborted){console.log(`Selection of ${O} aborted after resource load`);return}await(await xe(()=>Promise.resolve().then(()=>Oa),void 0)).useWebSocketStore().connectSession(O),H.signal.aborted||console.log(`Selected session ${O}`)}finally{c===H&&(c=null),r.value=!1}}function $(O,H){const x=n.value.get(O);x?Object.assign(x,H):(n.value.set(O,H),console.log(`Added new session ${O} via WebSocket update`)),n.value=new Map(n.value)}async function b(O){i.value.add(O);try{const x=(await me.delete(`/api/sessions/${O}`)).deleted_session_ids||[O];for(const A of x)n.value.delete(A),t.value.delete(A),o.value.delete(A);return n.value=new Map(n.value),x.includes(e.value)&&(e.value=null),console.log(`Deleted ${x.length} session(s): ${x.join(", ")}`),x}catch(H){throw console.error("Failed to delete session:",H),H}finally{i.value.delete(O)}}async function d(O,H){try{await me.patch(`/api/sessions/${O}`,H),$(O,H),console.log(`Updated session ${O}:`,H)}catch(x){throw console.error("Failed to update session:",x),x}}async function _(O,H){try{await me.post(`/api/sessions/${O}/permission-mode`,{mode:H}),$(O,{current_permission_mode:H});const x=o.value.get(O);x&&(x.permissionMode=H,o.value.set(O,x)),console.log(`Set permission mode for session ${O} to ${H}`)}catch(x){throw console.error("Failed to set permission mode:",x),x}}async function v(O){try{await me.post(`/api/sessions/${O}/start`),console.log(`Started session ${O}`)}catch(H){throw console.error("Failed to start session:",H),H}}async function T(O){try{await me.post(`/api/sessions/${O}/pause`),console.log(`Paused session ${O}`)}catch(H){throw console.error("Failed to pause session:",H),H}}async function E(O){try{await me.post(`/api/sessions/${O}/terminate`),console.log(`Terminated session ${O}`)}catch(H){throw console.error("Failed to terminate session:",H),H}}function R(O){return n.value.get(O)}function I(O,H){o.value.set(O,H),H.permissionMode&&$(O,{current_permission_mode:H.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:f,orderedSessions:m,sessionsInProject:p,currentInput:u,fetchSessions:w,createSession:g,selectSession:k,updateSession:$,deleteSession:b,patchSession:d,setPermissionMode:_,startSession:v,pauseSession:T,terminateSession:E,getSession:R,storeInitData:I}}),yn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:de},Symbol.toStringTag,{value:"Module"})),_e=st("ui",()=>{const n=P(window.innerWidth<768),e=P(300),t=P(!0),o=P(300),i=P(window.innerWidth),r=h(()=>i.value<768),c=P(!0),f=P(!1),m=P(null),p=P(null),u=h(()=>m.value?{name:m.value,data:p.value}:null),w=P(!1),g=P("Loading...");function k(){n.value=!n.value}function $(W){n.value=W}function b(W){e.value=Math.max(200,Math.min(W,window.innerWidth*.3))}function d(){t.value=!t.value}function _(W){t.value=W}function v(W){o.value=Math.max(200,Math.min(W,window.innerWidth*.3))}function T(W){c.value=W}function E(){const W=localStorage.getItem("webui-background-color");f.value=W==="red"}function R(){f.value=!f.value,localStorage.setItem("webui-background-color",f.value?"red":"gray")}function I(W,K=null){m.value=null,p.value=null,setTimeout(()=>{m.value=W,p.value=K},0)}function O(){m.value=null,p.value=null}function H(W="Loading..."){w.value=!0,g.value=W}function x(){w.value=!1}function A(){const W=i.value;i.value=window.innerWidth,i.value<768&&W>=768?n.value=!0:i.value>=768&&W<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:r,autoScrollEnabled:c,isRedBackground:f,activeModal:m,modalData:p,currentModal:u,isLoading:w,loadingMessage:g,toggleSidebar:k,setSidebarCollapsed:$,setSidebarWidth:b,toggleRightSidebar:d,setRightSidebarCollapsed:_,setRightSidebarWidth:v,setAutoScroll:T,initBackgroundColor:E,toggleBackgroundColor:R,showModal:I,hideModal:O,showLoading:H,hideLoading:x,handleResize:A}}),je=st("project",()=>{const n=P(new Map),e=P(null),t=h(()=>n.value.get(e.value)),o=h(()=>Array.from(n.value.values()).sort((d,_)=>d.order-_.order));async function i(){try{const d=await me.get("/api/projects");return n.value.clear(),d.projects.forEach(_=>{n.value.set(_.project_id,_)}),console.log(`Loaded ${n.value.size} projects`),d.projects}catch(d){throw console.error("Failed to fetch projects:",d),d}}async function r(d,_){try{const T=(await me.post("/api/projects",{name:d,working_directory:_})).project;return n.value.set(T.project_id,T),n.value=new Map(n.value),console.log(`Created project ${T.project_id}`),T}catch(v){throw console.error("Failed to create project:",v),v}}async function c(d,_){try{await me.put(`/api/projects/${d}`,_),f(d,_),console.log(`Updated project ${d}`,_)}catch(v){throw console.error("Failed to update project:",v),v}}function f(d,_){const v=n.value.get(d);v&&(Object.assign(v,_),n.value=new Map(n.value))}async function m(d){try{await me.delete(`/api/projects/${d}`),n.value.delete(d),n.value=new Map(n.value),e.value===d&&(e.value=null),console.log(`Deleted project ${d}`)}catch(_){throw console.error("Failed to delete project:",_),_}}async function p(d){try{const _=await me.put(`/api/projects/${d}/toggle-expansion`),v=n.value.get(d);return v&&(v.is_expanded=_.is_expanded,n.value=new Map(n.value)),_.is_expanded}catch(_){throw console.error("Failed to toggle expansion:",_),_}}async function u(d){try{await me.put("/api/projects/reorder",{project_ids:d}),d.forEach((_,v)=>{const T=n.value.get(_);T&&(T.order=v)}),n.value=new Map(n.value),console.log("Reordered projects",d)}catch(_){throw console.error("Failed to reorder projects:",_),_}}async function w(d,_){try{await me.put(`/api/projects/${d}/sessions/reorder`,{session_ids:_});const v=n.value.get(d);v&&(v.session_ids=_,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${d}`,_)}catch(v){throw console.error("Failed to reorder sessions:",v),v}}function g(d){return n.value.get(d)}function k(d){e.value=d}function $(){e.value=null}function b(d){if(!d)return"";const _=d.split(/[/\\]/).filter(v=>v);return _.length===0?"/":_.length===1?`/${_[0]}`:_.length===2?`/${_.join("/")}`:`.../${_.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:r,updateProject:c,updateProjectLocal:f,deleteProject:m,toggleExpansion:p,reorderProjects:u,reorderSessionsInProject:w,getProject:g,selectProject:k,clearProjectSelection:$,formatPath:b}}),kt=st("task",()=>{const n=P(new Map),e=P(new Set);function t(v){const T=n.value.get(v);return T?Array.from(T.values()).sort((E,R)=>{const I=parseInt(E.id.replace(/\D/g,""))||0,O=parseInt(R.id.replace(/\D/g,""))||0;return I-O}):[]}function o(v){return t(v).find(E=>E.status==="in_progress")||null}function i(v){const T=t(v);return{total:T.length,completed:T.filter(E=>E.status==="completed").length,inProgress:T.filter(E=>E.status==="in_progress").length,pending:T.filter(E=>E.status==="pending").length}}function r(v){return e.value.has(v)}const c=h(()=>{const v=de();return t(v.currentSessionId)}),f=h(()=>{const v=de();return o(v.currentSessionId)}),m=h(()=>{const v=de();return i(v.currentSessionId)}),p=h(()=>{const v=de();return r(v.currentSessionId)});function u(v,T){n.value.has(v)||n.value.set(v,new Map),n.value.get(v).set(T.id,{id:T.id,subject:T.subject||"",description:T.description||"",status:T.status||"pending",activeForm:T.activeForm||null,owner:T.owner||null,blocks:T.blocks||[],blockedBy:T.blockedBy||[],metadata:T.metadata||{}}),e.value.add(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${T.id} for session ${v}`)}function w(v,T,E){const R=n.value.get(v);if(!R){console.warn(`No tasks found for session ${v}`);return}const I=R.get(T);if(!I){u(v,{id:T,...E});return}E.subject!==void 0&&(I.subject=E.subject),E.description!==void 0&&(I.description=E.description),E.status!==void 0&&(I.status=E.status),E.activeForm!==void 0&&(I.activeForm=E.activeForm),E.owner!==void 0&&(I.owner=E.owner),E.metadata!==void 0&&(I.metadata={...I.metadata,...E.metadata}),E.addBlocks&&(I.blocks=[...new Set([...I.blocks,...E.addBlocks])]),E.addBlockedBy&&(I.blockedBy=[...new Set([...I.blockedBy,...E.addBlockedBy])]),E.status==="deleted"&&(R.delete(T),R.size===0&&(e.value.delete(v),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${T} for session ${v}`,E)}function g(v,T){return n.value.get(v)?.get(T)||null}function k(v){n.value.delete(v),e.value.delete(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${v}`)}function $(v,T){n.value.has(v)&&n.value.get(v).clear(),e.value.delete(v);const E=new Map;for(const R of T){if(R.metadata?.tool_uses)for(const I of R.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name)&&E.set(I.id,{name:I.name,input:I.input});if(R.metadata?.tool_results)for(const I of R.metadata.tool_results){const O=E.get(I.tool_use_id);O&&(b(v,O.name,O.input,{error:I.is_error,content:I.content}),E.delete(I.tool_use_id))}}console.log(`Reconstructed ${n.value.get(v)?.size||0} tasks for session ${v}`)}function b(v,T,E,R){if(R?.error){console.log(`Skipping task update - tool ${T} returned error`);return}const I=d(R);if(I)switch(T){case"TaskCreate":{const O=_(I)||E?.id;O&&u(v,{id:O,subject:E?.subject||"",description:E?.description||"",status:"pending",activeForm:E?.activeForm||null,owner:E?.owner||null,blocks:[],blockedBy:[],metadata:E?.metadata||{}});break}case"TaskUpdate":{const O=E?.taskId;O&&w(v,O,{status:E?.status,subject:E?.subject,description:E?.description,activeForm:E?.activeForm,owner:E?.owner,metadata:E?.metadata,addBlocks:E?.addBlocks,addBlockedBy:E?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{E?.taskId;break}}}function d(v){return v?typeof v=="string"?v:v.content?typeof v.content=="string"?v.content:JSON.stringify(v.content):v.message?v.message:JSON.stringify(v):null}function _(v){if(!v)return null;const T=v.match(/[Tt]ask\s*#(\d+)/i);if(T)return T[1];const E=v.match(/#(\d+)/);return E?E[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:f,currentTaskStats:m,currentHasTasks:p,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:r,getTask:g,createTask:u,updateTask:w,clearTasks:k,reconstructFromMessages:$,handleTaskToolResult:b}}),ne=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Hi={class:"project-name"},Vi=["title"],Ui=["title"],qi={class:"toggle-icon"},zi={key:0,class:"task-badge ms-1"},Ki={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=je(),i=kt(),r=_e(),c=h(()=>t.sessions.get(e.sessionId)),f=h(()=>c.value?.name||e.sessionId),m=h(()=>{for(const $ of o.projects.values())if($.session_ids?.includes(e.sessionId))return $;return null}),p=h(()=>m.value?.name||"Unknown Project"),u=h(()=>i.hasTasks(e.sessionId)),w=h(()=>i.taskStats(e.sessionId)),g=h(()=>r.rightSidebarCollapsed);function k(){r.toggleRightSidebar()}return($,b)=>(a(),l("div",{class:te(["session-header border-bottom p-3 d-flex justify-content-between align-items-center",{"theme-red-panel":$e(r).isRedBackground}])},[s("div",null,[s("div",Hi,y(p.value),1),s("div",{class:"session-name",title:n.sessionId},y(f.value),9,Vi)]),s("button",{class:te(["btn btn-sm sidebar-toggle-btn",{"btn-primary":!g.value,"btn-outline-secondary":g.value}]),onClick:k,title:g.value?"Show panel":"Hide panel"},[s("span",qi,y(g.value?"â—€":"â–¶"),1),u.value?(a(),l("span",zi,"ðŸ“‹ "+y(w.value.completed)+"/"+y(w.value.total),1)):M("",!0)],10,Ui)],2))}},Gi=ne(Ki,[["__scopeId","data-v-6be59824"]]),Yi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ji=["title"],Qi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Xi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=h(()=>t.sessions.get(e.sessionId)),i=h(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=h(()=>{const m=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),c=h(()=>{const m=i.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),f=h(()=>{if(!o.value)return"No session selected";const m=i.value,p=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${u}${w}: ${p}`});return(m,p)=>(a(),l("div",Yi,[o.value?(a(),l("div",{key:0,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:ze({width:"100%",backgroundColor:r.value}),title:f.value},null,14,Ji)):(a(),l("div",Qi))]))}},Zi=ne(Xi,[["__scopeId","data-v-63d222fe"]]),ea={class:"d-flex justify-content-between align-items-center gap-2"},ta={class:"d-flex gap-2"},sa=["disabled"],na={class:"mode-label"},oa=["disabled"],ia=["disabled"],aa={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_e(),i=h(()=>t.sessions.get(e.sessionId)),r=h(()=>i.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},f=h(()=>c[r.value]||"ðŸ”’"),m=h(()=>r.value),p=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(r.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(_){console.error("Failed to cycle permission mode:",_)}return}const b=(p.indexOf(r.value)+1)%p.length,d=p[b];try{await t.setPermissionMode(e.sessionId,d)}catch(_){console.error("Failed to cycle permission mode:",_)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},k=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return($,b)=>(a(),l("div",{class:te(["session-status-bar border-top p-2",$e(o).isRedBackground?"theme-red-panel":"bg-light"])},[s("div",ea,[s("div",ta,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[ie(y(f.value)+" ",1),s("span",na,y(m.value),1)],8,sa),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!i.value},[...b[0]||(b[0]=[ie(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,oa),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...b[1]||(b[1]=[ie(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,ia)]),s("div",null,[s("button",{class:te(["btn btn-sm",$e(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:k}," â¬‡ï¸ "+y($e(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},ra=ne(aa,[["__scopeId","data-v-ed9a4d3c"]]),Ae=st("message",()=>{const n=P(new Map),e=P(new Map),t=P(new Map),o=P(new Map),i=P(new Map),r=P(new Map),c=P(new Map),f=P(new Map),m=h(()=>{const D=de();return n.value.get(D.currentSessionId)||[]}),p=h(()=>{const D=de();return e.value.get(D.currentSessionId)||[]});async function u(D,N=null,S=0){try{const C=N||1e4,F=await me.get(`/api/sessions/${D}/messages?limit=${C}&offset=${S}`),J=F.messages||[],z=F.total_count||J.length,Q=F.has_more||!1;if(console.log(`Loaded ${J.length} of ${z} messages for session ${D}`),n.value.set(D,J),J.length>0){const j=J[J.length-1];j.timestamp&&(c.value.set(D,j.timestamp),console.log(`Tracked last received timestamp for session ${D}: ${j.timestamp}`))}const se=new Set;J.forEach(j=>{j.type==="assistant"&&j.metadata?.tool_uses&&j.metadata.tool_uses.forEach(U=>{se.add(U.id)}),j.type==="user"&&j.metadata?.tool_results&&j.metadata.tool_results.forEach(U=>{se.delete(U.tool_use_id);const ee=r.value.get(D);ee&&ee.delete(U.tool_use_id)}),j.type==="system"&&j.metadata?.subtype==="client_launched"&&(se.forEach(U=>{x(D,U,"Session was restarted")}),se.clear()),j.type==="system"&&j.metadata?.subtype==="interrupt"&&(se.forEach(U=>{x(D,U,"Session was interrupted")}),se.clear()),j.metadata?.has_tool_uses&&j.metadata.tool_uses&&j.metadata.tool_uses.forEach(U=>{b(D,U,j.timestamp)}),j.metadata?.has_tool_results&&j.metadata.tool_results&&j.metadata.tool_results.forEach(U=>{T(D,U)}),(j.type==="permission_request"||j.metadata?.has_permission_requests)&&d(D,j),j.type==="permission_response"&&_(D,{request_id:j.metadata?.request_id,decision:j.metadata?.decision,updated_input:j.metadata?.updated_input,reasoning:j.metadata?.reasoning,applied_updates:j.metadata?.applied_updates}),j.type==="system"&&(j.subtype==="init"||j.metadata?.subtype==="init")&&j.metadata?.init_data&&de().storeInitData(D,j.metadata.init_data)});const V=de().sessions.get(D);V&&!["active","paused","starting"].includes(V.state)&&(se.forEach(j=>{x(D,j,"Session was terminated")}),se.clear()),i.value.set(D,se),n.value=new Map(n.value);try{kt().reconstructFromMessages(D,J)}catch(j){console.warn("Failed to reconstruct task state:",j)}return Q&&console.warn(`Warning: Only loaded ${J.length} of ${z} messages. Some messages may be missing.`),{messages:J,totalCount:z,hasMore:Q}}catch(C){throw console.error("Failed to load messages:",C),C}}function w(D,N){const S=i.value.get(D)||new Set;N.type==="assistant"&&N.metadata?.tool_uses&&N.metadata.tool_uses.forEach(C=>{S.add(C.id)}),N.type==="user"&&N.metadata?.tool_results&&N.metadata.tool_results.forEach(C=>{S.delete(C.tool_use_id);const F=r.value.get(D);F&&F.delete(C.tool_use_id)}),N.type==="system"&&N.metadata?.subtype==="client_launched"&&(S.forEach(C=>{x(D,C,"Session was restarted")}),S.clear()),N.type==="system"&&N.metadata?.subtype==="interrupt"&&(S.forEach(C=>{x(D,C,"Session was interrupted")}),S.clear()),i.value.set(D,S)}function g(D,N){n.value.has(D)||n.value.set(D,[]);const S=n.value.get(D);if(N.id){const C=S.findIndex(F=>F.id===N.id);if(C!==-1){console.log(`Skipping duplicate message ${N.id} (already exists at index ${C})`);return}}S.push(N),N.timestamp&&c.value.set(D,N.timestamp),I(D,N),w(D,N),n.value=new Map(n.value)}function k(D,N){e.value.has(D)||e.value.set(D,[]),e.value.get(D).push(N),e.value=new Map(e.value)}function $(D,N,S){const C=e.value.get(D);if(C){const F=C.find(J=>J.id===N);F&&(Object.assign(F,S),e.value=new Map(e.value))}}function b(D,N,S=null){const C=R(N.name,N.input);t.value.set(C,N.id);const F={id:N.id,name:N.name,input:N.input,signature:C,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:S||new Date().toISOString(),isExpanded:!0};return k(D,F),console.log(`Created tool call ${F.id} for ${F.name}`),F}function d(D,N){console.log("handlePermissionRequest received:",N);const S=N.metadata?.tool_name||N.tool_name,C=N.metadata?.input_params||N.input_params,F=N.metadata?.request_id||N.request_id,J=N.metadata?.suggestions||N.suggestions||[];console.log("Extracted data:",{toolName:S,inputParams:C,requestId:F,suggestions:J});const z=R(S,C),Q=t.value.get(z);Q?(o.value.set(F,Q),$(D,Q,{status:"permission_required",permissionRequestId:F,suggestions:J}),console.log(`Permission required for tool ${Q}`,{suggestions:J})):console.warn("No tool use ID found for permission request signature:",z,{toolName:S,inputParams:C,availableSignatures:Array.from(t.value.keys())})}function _(D,N){const S=o.value.get(N.request_id);if(S){const C={permissionDecision:N.decision,appliedUpdates:N.applied_updates||[]};N.decision==="allow"?C.status="executing":(C.status="completed",C.result={error:!0,message:N.reasoning||"Permission denied"},C.isExpanded=!1),N.updated_input&&(C.input=N.updated_input),$(D,S,C),console.log(`Permission ${N.decision} for tool ${S}`)}}function v(D,N){console.log("handleToolCall received:",N);const S=N.tool_use_id;if(!S){console.warn("Received tool_call without tool_use_id:",N);return}e.value.has(D)||e.value.set(D,[]);const C=e.value.get(D),F=C.findIndex(Q=>Q.id===S),z={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[N.status]||N.status;if(F!==-1){const Q=C[F];Q.status=z,Q.backendStatus=N.status,N.permission&&(Q.suggestions=N.permission.suggestions||[],Q.permissionRequestId=N.request_id),N.permission_granted!==null&&N.permission_granted!==void 0&&(Q.permissionDecision=N.permission_granted?"allow":"deny"),N.result!==void 0&&(Q.result={error:N.status==="failed",content:N.result}),N.error&&(Q.result={error:!0,content:N.error}),N.status==="denied"&&(Q.result={error:!0,message:"Permission denied"},Q.isExpanded=!1),N.status==="interrupted"&&(x(D,S,"Session was interrupted"),Q.isExpanded=!1),(N.status==="completed"||N.status==="failed")&&(Q.isExpanded=!1),N.display&&(Q.backendState=N.display),console.log(`Updated tool call ${S} to status: ${z} (backend: ${N.status})`)}else{const Q=R(N.name,N.input);t.value.set(Q,S);const se={id:S,name:N.name,input:N.input,signature:Q,status:z,backendStatus:N.status,permissionRequestId:N.request_id,permissionDecision:N.permission_granted!==void 0?N.permission_granted?"allow":"deny":null,suggestions:N.permission?.suggestions||[],result:N.result?{error:N.status==="failed",content:N.result}:null,explanation:null,timestamp:N.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(N.status),backendState:N.display};N.error&&(se.result={error:!0,content:N.error}),C.push(se),console.log(`Created new tool call ${S} for ${N.name} with status: ${z}`)}if(e.value=new Map(e.value),["completed","failed"].includes(N.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(N.name))try{kt().handleTaskToolResult(D,N.name,N.input,{error:N.status==="failed",content:N.result})}catch(Q){console.warn("Failed to update task store:",Q)}}function T(D,N){const S=N.tool_use_id;$(D,S,{status:N.is_error?"error":"completed",result:{error:N.is_error,content:N.content},isExpanded:!1}),console.log(`Tool ${S} ${N.is_error?"failed":"completed"}`);const C=e.value.get(D);if(C){const F=C.find(J=>J.id===S);if(F&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(F.name))try{kt().handleTaskToolResult(D,F.name,F.input,{error:N.is_error,content:N.content})}catch(J){console.warn("Failed to update task store:",J)}}}function E(D,N){const S=e.value.get(D);if(S){const C=S.find(F=>F.id===N);C&&(C.isExpanded=!C.isExpanded,e.value=new Map(e.value))}}function R(D,N){if(!D)return"unknown:{}";if(!N||typeof N!="object")return`${D}:{}`;const S=JSON.stringify(N,Object.keys(N).sort());return`${D}:${S}`}function I(D,N){const S=N.metadata?.display||N.display;if(!S)return;f.value.has(D)||f.value.set(D,new Map);const C=f.value.get(D);if(S.tool_states)for(const[F,J]of Object.entries(S.tool_states)){C.set(F,J);const z=e.value.get(D);if(z){const Q=z.find(se=>se.id===F);if(Q){const se={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Q.status=se[J.state]||J.state,Q.backendState=J}}}if(S.orphaned_tools&&S.orphaned_tools.length>0){const F=r.value.get(D)||new Map;for(const J of S.orphaned_tools)F.has(J)||F.set(J,{reason:"denied",message:"Session was interrupted"});r.value.set(D,F)}if(S.linked_permissions)for(const[F,J]of Object.entries(S.linked_permissions))o.value.set(F,J);S.tool_states&&Object.keys(S.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${D}:`,{toolStates:Object.keys(S.tool_states||{}).length,orphanedTools:(S.orphaned_tools||[]).length,linkedPermissions:Object.keys(S.linked_permissions||{}).length})}function O(D,N){return f.value.get(D)?.get(N)}function H(D){const N=f.value.get(D);return N&&N.size>0}function x(D,N,S){const C=r.value.get(D)||new Map;C.set(N,{reason:"denied",message:S}),r.value.set(D,C);const F=e.value.get(D);if(F){const J=F.find(z=>z.id===N);J&&J.isExpanded&&(J.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${N} as orphaned: ${S}`)}function A(D,N){const S=O(D,N);return S&&S.state==="orphaned"?!0:r.value.get(D)?.has(N)||!1}function W(D,N){const S=O(D,N);return S&&S.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:S}:r.value.get(D)?.get(N)}function K(D,N){const S=i.value.get(D);S&&S.size>0&&(S.forEach(C=>x(D,C,N)),S.clear())}function L(D){n.value.delete(D),e.value.delete(D),n.value=new Map(n.value),e.value=new Map(e.value)}function B(D){return c.value.get(D)}async function q(D){const N=c.value.get(D);if(!N)return console.log(`No sync needed for session ${D} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${D} since ${N}`);const S=await me.get(`/api/sessions/${D}/messages?limit=1000&offset=0`),C=S.messages||[],F=S.has_more||!1,J=U=>U?typeof U=="number"?U*1e3:new Date(U).getTime():0,z=J(N),Q=C.filter(U=>U.timestamp?J(U.timestamp)>z:!1);if(Q.length===0)return console.log(`No missed messages for session ${D}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Q.length} missed messages for session ${D}`);const se=n.value.get(D)||[],X=new Set(se.map(U=>U.id).filter(Boolean)),V=Q.filter(U=>!U.id||!X.has(U.id));if(console.log(`After deduplication: ${V.length} unique new messages`),V.length>0){const U=V.sort((Fe,G)=>{const le=J(Fe.timestamp),ue=J(G.timestamp);return le-ue}),ee=n.value.get(D)||[],oe=ee.length>0?J(ee[ee.length-1].timestamp):0,he=J(U[0].timestamp),rt=J(U[U.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ee.length,lastExisting:oe,lastExistingDate:ee.length>0?ee[ee.length-1].timestamp:"none",firstNew:he,firstNewDate:U[0].timestamp,lastNew:rt,lastNewDate:U[U.length-1].timestamp,shouldAppend:he>oe}),he>oe){const Fe=[...ee,...U];n.value.set(D,Fe),console.log(`âœ… Appended ${U.length} new messages (no full sort needed)`)}else{const Fe=[...ee,...U].sort((G,le)=>{const ue=J(G.timestamp),Te=J(le.timestamp);return ue-Te});n.value.set(D,Fe),console.log(`âš ï¸ Merged and sorted ${U.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${se.length} messages unchanged`);V.forEach(U=>{w(D,U),U.metadata?.has_tool_uses&&U.metadata.tool_uses&&U.metadata.tool_uses.forEach(ee=>{b(D,ee,U.timestamp)}),U.metadata?.has_tool_results&&U.metadata.tool_results&&U.metadata.tool_results.forEach(ee=>{T(D,ee)}),(U.type==="permission_request"||U.metadata?.has_permission_requests)&&d(D,U),U.type==="permission_response"&&_(D,{request_id:U.metadata?.request_id,decision:U.metadata?.decision,updated_input:U.metadata?.updated_input,reasoning:U.metadata?.reasoning,applied_updates:U.metadata?.applied_updates}),U.type==="system"&&(U.subtype==="init"||U.metadata?.subtype==="init")&&U.metadata?.init_data&&de().storeInitData(D,U.metadata.init_data)});const j=n.value.get(D);if(j&&j.length>0){const U=j[j.length-1];U.timestamp&&c.value.set(D,U.timestamp)}return n.value=new Map(n.value),{syncedCount:V.length,hasMore:F}}catch(S){return console.error(`Failed to sync messages for session ${D}:`,S),{syncedCount:0,hasMore:!1,error:S.message}}}const Z=de();return fe(()=>Array.from(Z.sessions.values()).map(N=>({id:N.session_id,state:N.state})),(D,N)=>{N&&D.forEach((S,C)=>{const F=N[C];if(!F||F.id!==S.id)return;const J=["active","paused","starting"].includes(F.state),z=!["active","paused","starting"].includes(S.state);J&&z&&K(S.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:bs(i),orphanedToolUses:bs(r),currentMessages:m,currentToolCalls:p,loadMessages:u,addMessage:g,addToolCall:k,updateToolCall:$,handleToolCall:v,handleToolUse:b,handlePermissionRequest:d,handlePermissionResponse:_,handleToolResult:T,toggleToolExpansion:E,clearMessages:L,markToolUseOrphaned:x,isToolUseOrphaned:A,getOrphanedInfo:W,clearOrphanedToolUses:K,getLastReceivedTimestamp:B,syncMessages:q,getBackendToolState:O,hasBackendDisplayMetadata:H,backendToolStates:bs(f)}}),la=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ae},Symbol.toStringTag,{value:"Module"}));function ca(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ht(n){return ca(n).toLocaleTimeString()}const ua={class:"message-row message-row-user"},da=["title"],ma={class:"message-content-column"},pa=["innerHTML"],fa={key:0,class:"tool-results mt-2"},va={class:"tool-results-header text-muted small mb-2"},ha={class:"d-flex align-items-start gap-2"},_a={class:"flex-grow-1"},ga={class:"text-muted"},ba={key:0,class:"text-danger small"},ya={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=h(()=>Ht(e.message.timestamp)),o=h(()=>`user
${t.value}`),i=h(()=>{const m=e.message.content||"";let p=dt.parse(m);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),cs.sanitize(p)}),r=h(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=h(()=>e.message.metadata?.tool_results||[]);function f(m,p){return m?m.length<=p?m:m.substring(0,p)+"...":""}return(m,p)=>(a(),l("div",ua,[s("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,da),s("div",ma,[s("div",{class:"message-text",innerHTML:i.value},null,8,pa),r.value?(a(),l("div",fa,[s("div",va," ðŸ”§ Tool Results ("+y(c.value.length)+") ",1),(a(!0),l(re,null,ce(c.value,(u,w)=>(a(),l("div",{key:w,class:te(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",ha,[s("span",null,y(u.is_error?"âŒ":"âœ…"),1),s("div",_a,[s("small",ga,"Tool: "+y(u.tool_use_id),1),u.is_error?(a(),l("div",ba,y(f(u.content,200)),1)):M("",!0)])])],2))),128))])):M("",!0)])]))}},wa=ne(ya,[["__scopeId","data-v-7665755b"]]),$a={class:"thinking-block"},ka=["aria-label"],Sa={class:"text-muted ms-auto"},Ea={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Ca=["innerHTML"],Ta={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=P(!1),o=h(()=>e.thinking?.length||0),i=h(()=>{const c=e.thinking||"",f=dt.parse(c);return cs.sanitize(f)});function r(){t.value=!t.value}return(c,f)=>(a(),l("div",$a,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[s("span",{"aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,ka),f[0]||(f[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",Sa,y(o.value)+" characters",1)]),t.value?(a(),l("div",Ea,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,Ca)])):M("",!0)]))}},xa=ne(Ta,[["__scopeId","data-v-fda2352c"]]),wn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),ks={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Xe=st("resource",()=>{const n=P(new Map),e=P(!1),t=P(0),o=P(null),i=P(!1);function r(X){if(!X)return!1;if(X.is_image===!0||(X.mime_type||"").toLowerCase().startsWith("image/"))return!0;const j=(X.format||"").toLowerCase();if(j.startsWith("image/")||wn.has("."+j))return!0;const U=X.original_filename||X.original_name||"";if(U){const ee="."+U.split(".").pop().toLowerCase();return wn.has(ee)}return!1}function c(X){if(r(X))return"ðŸ–¼ï¸";if(X.original_filename){const V="."+X.original_filename.split(".").pop().toLowerCase();return ks[V]||ks.default}return ks.default}function f(X){return X.original_filename?"."+X.original_filename.split(".").pop().toLowerCase():""}function m(X){const V=n.value.get(X);return V||[]}function p(X){return n.value.get(X)?.length||0}function u(X){return p(X)>0}function w(X){return m(X).filter(r)}function g(X){return w(X).length}function k(X){return g(X)>0}const $=h(()=>{const X=de();return m(X.currentSessionId)}),b=h(()=>{const X=de();return p(X.currentSessionId)}),d=h(()=>b.value>0),_=h(()=>$.value.filter(r)),v=h(()=>_.value.length),T=h(()=>v.value>0),E=h(()=>!e.value||!o.value?null:m(o.value)[t.value]||null),R=E,I=h(()=>o.value?p(o.value):0),O=I;async function H(X){if(X){i.value=!0;try{const j=(await _o(`/api/sessions/${X}/resources`)).resources||[];j.sort((U,ee)=>(U.timestamp||0)-(ee.timestamp||0)),n.value.set(X,j),n.value=new Map(n.value),console.log(`Loaded ${j.length} resources for session ${X}`)}catch(V){console.error(`Failed to load resources for session ${X}:`,V),n.value.set(X,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const x=H;function A(X,V){if(!X||!V)return;let j=n.value.get(X);j||(j=[],n.value.set(X,j));const U=j.findIndex(ee=>ee.resource_id===V.resource_id);U>=0?j[U]=V:j.push(V),j.sort((ee,oe)=>(ee.timestamp||0)-(oe.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${V.resource_id} to session ${X}`)}const W=A;function K(X,V){return`/api/sessions/${X}/resources/${V}`}const L=K;function B(X,V){return`/api/sessions/${X}/resources/${V}/download`}function q(X,V=0){o.value=X,t.value=Math.max(0,Math.min(V,p(X)-1)),e.value=!0}function Z(){e.value=!1}function D(){if(!o.value)return;const X=p(o.value);X!==0&&(t.value=(t.value+1)%X)}const N=D;function S(){if(!o.value)return;const X=p(o.value);X!==0&&(t.value=(t.value-1+X)%X)}const C=S;function F(X){if(!o.value)return;const V=p(o.value);V!==0&&(t.value=Math.max(0,Math.min(X,V-1)))}const J=F;function z(X){n.value.delete(X),n.value=new Map(n.value),o.value===X&&Z(),console.log(`Cleared resources for session ${X}`)}const Q=z;function se(X,V){const j=n.value.get(X);return j&&j.find(U=>U.resource_id===V)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:t,fullViewSessionId:o,loading:i,currentResources:$,currentResourceCount:b,currentHasResources:d,currentFullViewResource:E,fullViewTotalResources:I,currentImages:_,currentImageCount:v,currentHasImages:T,currentFullViewImage:R,fullViewTotalImages:O,imagesBySession:n,resourcesForSession:m,resourceCount:p,hasResources:u,getResourceUrl:K,getDownloadUrl:B,isImageResource:r,getResourceIcon:c,getResourceExtension:f,getResourceById:se,imagesForSession:w,imageCount:g,hasImages:k,getImageUrl:L,loadResources:H,addResource:A,openFullView:q,closeFullView:Z,nextResource:D,prevResource:S,goToResource:F,clearResources:z,loadImages:x,addImage:W,nextImage:N,prevImage:C,goToImage:J,clearImages:Q}}),Aa=Xe,Ma=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Aa,useResourceStore:Xe},Symbol.toStringTag,{value:"Module"})),nt=st("websocket",()=>{const n=P(null),e=P(!1),t=P(0),o=10,i=P(null),r=P(!1),c=P(0),f=5,m=P(null);let p=null;const u=P(0),w=P(null),g=P(new Map),k=P(null),$=P(!1),b=P(0),d=5,_=P(null),v=1e4,T=1e3,E=P(Date.now()),R=P(Date.now()),I=P(Date.now());let O=null,H=null,x=null;const A=h(()=>e.value&&(r.value||!m.value)?"connected":e.value?"partial":"disconnected");function W(V){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${V}`}function K(V){const j={ui:{timer:()=>O,setTimer:U=>{O=U},lastPing:E,connected:e,name:"UI"},session:{timer:()=>H,setTimer:U=>{H=U},lastPing:R,connected:r,name:"Session"},legion:{timer:()=>x,setTimer:U=>{x=U},lastPing:I,connected:$,name:"Legion"}}[V];j.timer()&&clearInterval(j.timer()),j.setTimer(setInterval(()=>{if(!j.connected.value)return;const U=Date.now()-j.lastPing.value;if(U>v){console.warn(`âš ï¸ ${j.name} WebSocket heartbeat timeout (${U}ms since last ping) - forcing close to trigger reconnection`),j.connected.value=!1;const oe={ui:n,session:i,legion:k}[V];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},T)),console.log(`âœ… Started heartbeat monitor for ${j.name} WebSocket`)}function L(V){const j={ui:{get:()=>O,set:U=>{O=U}},session:{get:()=>H,set:U=>{H=U}},legion:{get:()=>x,set:U=>{x=U}}}[V];j.get()&&(clearInterval(j.get()),j.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${V} WebSocket`))}function B(){if(n.value)return;const V=W("/ws/ui");console.log(`Connecting to UI WebSocket: ${V}`),n.value=new WebSocket(V),n.value.onopen=()=>{e.value=!0,t.value=0,E.value=Date.now(),K("ui"),console.log("UI WebSocket connected")},n.value.onmessage=j=>{const U=JSON.parse(j.data);J(U)},n.value.onclose=()=>{if(L("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const j=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${j}ms (attempt ${t.value})`),setTimeout(B,j)}},n.value.onerror=j=>{console.error("UI WebSocket error:",j)}}function q(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Z(V){u.value++;const j=u.value;if(console.log(`[Gen ${j}] Starting connection to session ${V}`),p&&(clearTimeout(p),p=null),await D(),u.value!==j){console.log(`[Gen ${j}] Connection cancelled (current generation: ${u.value})`);return}m.value=V,w.value=j;const U=W(`/ws/session/${V}`);console.log(`[Gen ${j}] Connecting to Session WebSocket: ${U}`),i.value=new WebSocket(U),i.value.onopen=async()=>{if(w.value!==j){console.log(`[Gen ${j}] Ignoring onopen (stale connection, current: ${w.value})`),i.value.close();return}r.value=!0,c.value=0,R.value=Date.now(),K("session"),console.log(`[Gen ${j}] Session WebSocket connected for ${V}`);const ee=g.value.get(V);if(g.value.set(V,!0),ee){console.log(`[Gen ${j}] Reconnection detected, syncing missed messages...`);try{const he=await Ae().syncMessages(V);he.syncedCount>0?console.log(`[Gen ${j}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${j}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${j}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${j}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${j}] Error during message sync:`,oe)}}else console.log(`[Gen ${j}] Initial connection, no sync needed`)},i.value.onmessage=ee=>{if(w.value!==j){console.log(`[Gen ${j}] Ignoring message (stale connection, current: ${w.value})`);return}const oe=JSON.parse(ee.data);z(oe,V)},i.value.onclose=()=>{L("session"),r.value=!1,i.value=null,console.log(`[Gen ${j}] Session WebSocket closed for ${V}`);const ee=de();if(ee.currentSessionId===V&&w.value===j&&c.value<f){c.value++;const oe=Math.min(2e3*c.value,3e4);console.log(`[Gen ${j}] Reconnecting Session WebSocket in ${oe}ms (attempt ${c.value})`),p=setTimeout(()=>{w.value===j&&ee.currentSessionId===V?(p=null,Z(V)):console.log(`[Gen ${j}] Skipping reconnect (generation or session changed)`)},oe)}},i.value.onerror=ee=>{console.error(`[Gen ${j}] Session WebSocket error:`,ee)}}function D(){return new Promise(V=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),i.value){const j=m.value,U=()=>{i.value=null,r.value=!1,m.value=null,w.value=null,c.value=0,j&&g.value.delete(j),V()};if(i.value.readyState===WebSocket.CLOSED)U();else{const ee=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),U()},2e3);i.value.addEventListener("close",()=>{clearTimeout(ee),U()},{once:!0}),i.value.close()}}else m.value=null,w.value=null,V()})}function N(V){i.value&&r.value?(i.value.send(JSON.stringify({type:"send_message",content:V})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function S(V,j,U=!1,ee=null){if(i.value&&r.value){const oe={type:"permission_response",request_id:V,decision:j,apply_suggestions:U,timestamp:new Date().toISOString()};ee&&(oe.clarification_message=ee),i.value.send(JSON.stringify(oe)),console.log(`Sent permission ${j} for request ${V}`,{applySuggestions:U,clarification:ee})}}function C(V,j,U){if(i.value&&r.value){const ee={type:"permission_response",request_id:V,decision:j,updated_input:U,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(ee)),console.log(`Sent permission ${j} with updated_input for request ${V}`,U)}}function F(){i.value&&r.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function J(V){const j=de(),U=je();switch(V.type){case"sessions_list":V.sessions&&Array.isArray(V.sessions)&&V.sessions.forEach(ee=>{j.updateSession(ee.session_id,ee)});break;case"state_change":V.data&&V.data.session_id&&V.data.session&&j.updateSession(V.data.session_id,V.data.session);break;case"project_updated":if(V.data&&V.data.project){const ee=V.data.project;U.updateProjectLocal(ee.project_id,ee),j.fetchSessions()}break;case"project_deleted":V.data&&V.data.project_id&&U.projects.delete(V.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":E.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",V.type)}}function z(V,j){const U=de();if(U.currentSessionId!==j){console.warn(`Ignoring message for session ${j} (current: ${U.currentSessionId})`);return}const ee=Ae();switch(V.type){case"message":const oe=V.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",V);break}if(oe.type==="tool_call"){ee.handleToolCall(j,oe);break}if(oe.type==="permission_request"){ee.handlePermissionRequest(j,oe);break}if(oe.type==="permission_response"){ee.handlePermissionResponse(j,oe);break}oe.metadata?.has_tool_uses&&oe.metadata.tool_uses.forEach(he=>{ee.handleToolUse(j,he,oe.timestamp)}),oe.metadata?.has_tool_results&&oe.metadata.tool_results.forEach(he=>{ee.handleToolResult(j,he)}),oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&U.storeInitData(j,oe.metadata.init_data),ee.addMessage(j,oe);break;case"permission_request":ee.handlePermissionRequest(j,V);break;case"permission_response":ee.handlePermissionResponse(j,V);break;case"tool_result":ee.handleToolResult(j,V);break;case"state_change":U.updateSession(j,V.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${j}`);break;case"ping":R.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":V.resource&&(Xe().addResource(j,V.resource),console.log(`Resource registered for session ${j}:`,V.resource.resource_id));break;case"image_registered":V.image&&(Xe().addResource(j,{...V.image,resource_id:V.image.image_id}),console.log(`Image registered (legacy) for session ${j}:`,V.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",V.type)}}function Q(V){se(),_.value=V;const j=W(`/ws/legion/${V}`);console.log(`Connecting to Legion WebSocket: ${j}`),k.value=new WebSocket(j),k.value.onopen=()=>{$.value=!0,b.value=0,I.value=Date.now(),K("legion"),console.log(`Legion WebSocket connected for ${V}`)},k.value.onmessage=U=>{const ee=JSON.parse(U.data);X(ee,V)},k.value.onclose=()=>{if(L("legion"),$.value=!1,k.value=null,console.log(`Legion WebSocket closed for ${V}`),_.value===V&&b.value<d){b.value++;const U=Math.min(2e3*b.value,3e4);setTimeout(()=>Q(V),U)}},k.value.onerror=U=>{console.error("Legion WebSocket error:",U)}}function se(){k.value&&(k.value.close(),k.value=null,$.value=!1,_.value=null)}function X(V,j){xe(async()=>{const{useLegionStore:U}=await Promise.resolve().then(()=>Rb);return{useLegionStore:U}},void 0).then(({useLegionStore:U})=>{const ee=U();switch(V.type){case"comm":V.comm&&(ee.addComm(j,V.comm),console.log("Legion WebSocket: Received new comm",V.comm));break;case"minion_created":V.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",V.data),xe(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>yn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":V.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",V.data),xe(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>yn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${j}`);break;case"ping":I.value=Date.now(),k.value?.readyState===WebSocket.OPEN&&k.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",V.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:r,sessionRetryCount:c,legionConnected:$,legionRetryCount:b,overallStatus:A,connectUI:B,disconnectUI:q,connectSession:Z,disconnectSession:D,sendMessage:N,sendPermissionResponse:S,sendPermissionResponseWithInput:C,interruptSession:F,connectLegion:Q,disconnectLegion:se}}),Oa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:nt},Symbol.toStringTag,{value:"Module"})),Da={class:"base-tool-handler"},Na={class:"tool-section"},La={class:"tool-parameters"},Ia={class:"tool-code"},ja={key:0,class:"tool-section"},Pa={class:"tool-section-label"},Ra={class:"tool-code"},Wa={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=h(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,f)=>(a(),l("div",Da,[s("div",Na,[f[0]||(f[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",La,[s("pre",Ia,y(t.value),1)])]),o.value?(a(),l("div",ja,[s("div",Pa,y(i.value?"Error:":"Result:"),1),s("div",{class:te(["tool-result",{"tool-result-error":i.value}])},[s("pre",Ra,y(r.value),1)],2)])):M("",!0)]))}},Ba=ne(Wa,[["__scopeId","data-v-1e69f57d"]]),Fa={class:"read-tool-handler"},Ha={class:"tool-section"},Va={class:"read-file-info"},Ua={class:"file-icon"},qa={class:"file-path"},za={key:0,class:"read-range"},Ka={key:0,class:"tool-section"},Ga={key:0,class:"tool-result tool-result-error"},Ya={class:"tool-code"},Ja={key:1,class:"image-preview"},Qa={class:"content-header"},Xa={class:"image-badge"},Za={class:"image-container"},er=["src","alt"],tr={key:2,class:"file-content-preview"},sr={class:"content-header"},nr={class:"line-count-badge"},or={key:0,class:"preview-note"},ir={class:"tool-code content-display"},ar={key:0,class:"more-indicator"},Ss=100,rr={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>{const _=t.value;return _.split("/").pop()||_}),i=h(()=>{const _=e.toolCall.input?.offset,v=e.toolCall.input?.limit;return _!==void 0||v!==void 0}),r=h(()=>{const _=e.toolCall.input?.offset;return _!==void 0?_+1:1}),c=h(()=>{const _=e.toolCall.input?.offset||0,v=e.toolCall.input?.limit;return v!==void 0?_+v:"âˆž"}),f=h(()=>{const _=t.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(_)}),m=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>{if(!m.value||p.value)return null;const v=e.toolCall.result?.content;if(Array.isArray(v)){for(const T of v)if(T?.type==="image"&&T?.source?.type==="base64"&&T?.source?.data)return T.source.data}return null}),w=h(()=>{if(!u.value)return"";const _=t.value.toLowerCase();return _.endsWith(".png")?"image/png":_.endsWith(".jpg")||_.endsWith(".jpeg")?"image/jpeg":_.endsWith(".gif")?"image/gif":_.endsWith(".webp")?"image/webp":_.endsWith(".svg")?"image/svg+xml":_.endsWith(".bmp")?"image/bmp":_.endsWith(".ico")?"image/x-icon":"image/png"}),g=h(()=>{if(!m.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),k=h(()=>p.value||!g.value||u.value?[]:g.value.split(`
`)),$=h(()=>k.value.length),b=h(()=>$.value>Ss),d=h(()=>p.value||u.value?"":k.value.slice(0,Ss).join(`
`));return(_,v)=>(a(),l("div",Fa,[s("div",Ha,[s("div",Va,[s("span",Ua,y(f.value?"ðŸ–¼ï¸":"ðŸ“„"),1),v[0]||(v[0]=s("strong",null,"Reading:",-1)),s("code",qa,y(t.value),1),i.value?(a(),l("span",za,"Lines "+y(r.value)+"-"+y(c.value),1)):M("",!0)])]),m.value?(a(),l("div",Ka,[p.value?(a(),l("div",Ga,[s("pre",Ya,y(g.value),1)])):u.value?(a(),l("div",Ja,[s("div",Qa,[v[1]||(v[1]=s("span",{class:"content-label"},"Image Preview:",-1)),s("span",Xa,y(w.value),1)]),s("div",Za,[s("img",{src:`data:${w.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,er)])])):(a(),l("div",tr,[s("div",sr,[v[2]||(v[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",nr,y($.value)+" lines",1),b.value?(a(),l("span",or,"(showing first "+y(Ss)+")")):M("",!0)]),s("pre",ir,y(d.value),1),b.value?(a(),l("div",ar,"...")):M("",!0)]))])):M("",!0)]))}},lr=ne(rr,[["__scopeId","data-v-29b774b1"]]),cr={class:"write-tool-handler"},ur={class:"tool-section"},dr={class:"write-file-info mb-2"},mr={class:"file-path"},pr={class:"write-content-preview"},fr={class:"content-header"},vr={class:"line-count-badge"},hr={key:0,class:"preview-note"},_r={class:"tool-code content-display"},gr={key:0,class:"more-indicator"},br={key:0,class:"tool-section"},yr={key:0,class:"tool-result tool-result-error"},wr={class:"tool-code"},$r={key:1,class:"tool-result tool-result-success"},kr={class:"success-message"},Es=100,Sr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.content||""),i=h(()=>o.value.split(`
`)),r=h(()=>i.value.length),c=h(()=>r.value>Es),f=h(()=>i.value.slice(0,Es).join(`
`)),m=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>{if(!m.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,g)=>(a(),l("div",cr,[s("div",ur,[s("div",dr,[g[0]||(g[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=s("strong",null,"Writing:",-1)),s("code",mr,y(t.value),1)]),s("div",pr,[s("div",fr,[g[2]||(g[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",vr,y(r.value)+" lines",1),c.value?(a(),l("span",hr,"(showing first "+y(Es)+")")):M("",!0)]),s("pre",_r,y(f.value),1),c.value?(a(),l("div",gr,"...")):M("",!0)])]),m.value?(a(),l("div",br,[p.value?(a(),l("div",yr,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",wr,y(u.value),1)])):(a(),l("div",$r,[s("div",kr,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+y(r.value)+" lines written)",1)])]))])):M("",!0)]))}},Er=ne(Sr,[["__scopeId","data-v-ddc24a0f"]]),Cr={class:"bash-tool-handler"},Tr={class:"tool-section"},xr={class:"bash-header"},Ar={class:"bash-header-content"},Mr={key:0,class:"bash-description"},Or={key:1,class:"bash-flags"},Dr={class:"bash-command-section"},Nr={class:"bash-command-content"},Lr={key:0,class:"tool-section"},Ir={key:0,class:"bash-output"},jr={key:1,class:"bash-output-empty"},Pr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.command||""),o=h(()=>e.toolCall.input?.description||""),i=h(()=>e.toolCall.input?.timeout),r=h(()=>e.toolCall.input?.run_in_background||!1),c=h(()=>i.value||r.value),f=h(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),r.value&&g.push("background"),g.join(", ")}),m=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>p.value?"tool-result-error":"tool-result-success"),w=h(()=>{if(!m.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),l("div",Cr,[s("div",Tr,[s("div",xr,[k[1]||(k[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",Ar,[o.value?(a(),l("div",Mr,[k[0]||(k[0]=s("strong",null,"Description:",-1)),ie(" "+y(o.value),1)])):M("",!0),c.value?(a(),l("div",Or,y(f.value),1)):M("",!0)])]),s("div",Dr,[k[2]||(k[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",Nr,y(t.value),1)])]),m.value?(a(),l("div",Lr,[s("div",{class:te(["tool-result",u.value])},[k[3]||(k[3]=s("strong",null,"Output:",-1)),w.value?(a(),l("pre",Ir,y(w.value),1)):(a(),l("div",jr,"No output"))],2)])):M("",!0)]))}},Rr=ne(Pr,[["__scopeId","data-v-ab50fe73"]]),Wr={class:"todo-tool-handler"},Br={class:"tool-section"},Fr={class:"todo-header"},Hr={class:"todo-summary"},Vr={key:0,class:"todo-count todo-count-completed"},Ur={key:1,class:"todo-count todo-count-in-progress"},qr={key:2,class:"todo-count todo-count-pending"},zr={class:"todo-checklist"},Kr={class:"todo-checkbox"},Gr={class:"todo-content"},Yr={key:0,class:"tool-section"},Jr={key:0,class:"tool-result tool-result-error"},Qr={class:"tool-code"},Xr={key:1,class:"tool-result tool-result-success"},Zr={class:"success-message"},el={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.todos||[]),o=h(()=>t.value.filter(u=>u.status==="completed").length),i=h(()=>t.value.filter(u=>u.status==="in_progress").length),r=h(()=>t.value.filter(u=>u.status==="pending").length);function c(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const f=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=h(()=>{if(!f.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,w)=>(a(),l("div",Wr,[s("div",Br,[s("div",Fr,[w[0]||(w[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=s("strong",null,"Task List:",-1)),s("div",Hr,[o.value>0?(a(),l("span",Vr,y(o.value)+" completed ",1)):M("",!0),i.value>0?(a(),l("span",Ur,y(i.value)+" in progress ",1)):M("",!0),r.value>0?(a(),l("span",qr,y(r.value)+" pending ",1)):M("",!0)])]),s("div",zr,[(a(!0),l(re,null,ce(t.value,(g,k)=>(a(),l("div",{key:k,class:te(["todo-item",`todo-${g.status}`])},[s("span",Kr,y(c(g.status)),1),s("span",Gr,y(g.content),1)],2))),128))])]),f.value?(a(),l("div",Yr,[m.value?(a(),l("div",Jr,[w[2]||(w[2]=s("strong",null,"Error:",-1)),s("pre",Qr,y(p.value),1)])):(a(),l("div",Xr,[s("div",Zr,[w[3]||(w[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+y(t.value.length)+" tasks)",1)])]))])):M("",!0)]))}},tl=ne(el,[["__scopeId","data-v-bbe55ee7"]]),sl={class:"edit-tool-handler"},nl={class:"tool-section"},ol={class:"edit-file-info"},il={class:"file-path"},al={key:0,class:"replace-all-badge"},rl={class:"edit-diff-container"},ll={class:"diff-header"},cl={class:"diff-stats"},ul={class:"stat-removed"},dl={class:"stat-added"},ml={class:"unified-diff"},pl={class:"diff-scroll-container"},fl={class:"diff-marker"},vl={class:"diff-content"},hl={key:0,class:"tool-section"},_l={key:0,class:"tool-result tool-result-error"},gl={class:"tool-code"},bl={key:1,class:"tool-result tool-result-success"},yl={class:"success-message"},wl={key:0,class:"success-detail"},$l={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.old_string||""),i=h(()=>e.toolCall.input?.new_string||""),r=h(()=>e.toolCall.input?.replace_all||!1),c=h(()=>{const k=Ni(t.value,o.value,i.value,"","",{context:3}).split(`
`),$=[];for(let b=4;b<k.length;b++){const d=k[b];d&&(d.startsWith("-")?$.push({type:"removed",content:d.substring(1)}):d.startsWith("+")?$.push({type:"added",content:d.substring(1)}):d.startsWith(" ")?$.push({type:"context",content:d.substring(1)}):d.startsWith("@@")&&$.push({type:"hunk",content:d}))}return $}),f=h(()=>c.value.filter(g=>g.type==="removed").length),m=h(()=>c.value.filter(g=>g.type==="added").length),p=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!p.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),l("div",sl,[s("div",nl,[s("div",ol,[k[0]||(k[0]=s("span",{class:"file-icon"},"âœï¸",-1)),k[1]||(k[1]=s("strong",null,"Editing:",-1)),s("code",il,y(t.value),1),r.value?(a(),l("span",al,"Replace All")):M("",!0)]),s("div",rl,[s("div",ll,[k[2]||(k[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",cl,[s("span",ul,"-"+y(f.value),1),s("span",dl,"+"+y(m.value),1)])]),s("div",ml,[s("div",pl,[(a(!0),l(re,null,ce(c.value,($,b)=>(a(),l("div",{key:b,class:te(["diff-line",{"diff-line-removed":$.type==="removed","diff-line-added":$.type==="added","diff-line-context":$.type==="context","diff-line-hunk":$.type==="hunk"}])},[s("span",fl,y($.type==="removed"?"-":$.type==="added"?"+":$.type==="hunk"?"@":" "),1),s("span",vl,y($.content),1)],2))),128))])])])]),p.value?(a(),l("div",hl,[u.value?(a(),l("div",_l,[k[3]||(k[3]=s("strong",null,"Error:",-1)),s("pre",gl,y(w.value),1)])):(a(),l("div",bl,[s("div",yl,[k[4]||(k[4]=s("span",{class:"success-icon"},"âœ…",-1)),k[5]||(k[5]=s("strong",null,"File edited successfully",-1)),r.value?(a(),l("span",wl,"(all occurrences replaced)")):M("",!0)])]))])):M("",!0)]))}},kl=ne($l,[["__scopeId","data-v-dd74055e"]]),Sl={class:"search-tool-handler"},El={class:"tool-section"},Cl={class:"search-info"},Tl={class:"search-icon"},xl={class:"search-pattern"},Al={key:0,class:"search-path"},Ml={key:1,class:"search-filters"},Ol={key:0,class:"filter-badge"},Dl={key:1,class:"filter-badge"},Nl={key:2,class:"filter-badge"},Ll={key:0,class:"tool-section"},Il={key:0,class:"tool-result tool-result-error"},jl={class:"tool-code"},Pl={key:1,class:"search-results"},Rl={class:"results-header"},Wl={class:"results-label"},Bl={class:"results-count-badge"},Fl={class:"results-content"},Hl={class:"tool-code"},Vl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="Grep"),o=h(()=>e.toolCall.input?.pattern||"Unknown"),i=h(()=>e.toolCall.input?.path||null),r=h(()=>e.toolCall.input?.type||null),c=h(()=>e.toolCall.input?.glob||null),f=h(()=>e.toolCall.input?.["-i"]||!1),m=h(()=>r.value||c.value||f.value),p=h(()=>t.value?"ðŸ”":"ðŸ“"),u=h(()=>t.value?"Searching content":"Finding files"),w=h(()=>t.value?"Matches":"Files found"),g=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!g.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),b=h(()=>!g.value||k.value||!$.value?0:$.value.split(`
`).filter(_=>_.trim()).length);return(d,_)=>(a(),l("div",Sl,[s("div",El,[s("div",Cl,[s("span",Tl,y(p.value),1),s("strong",null,y(u.value)+":",1),s("code",xl,y(o.value),1),i.value?(a(),l("span",Al,"in "+y(i.value),1)):M("",!0),m.value?(a(),l("span",Ml,[r.value?(a(),l("span",Ol,"type: "+y(r.value),1)):M("",!0),c.value?(a(),l("span",Dl,"glob: "+y(c.value),1)):M("",!0),f.value?(a(),l("span",Nl,"case-insensitive")):M("",!0)])):M("",!0)])]),g.value?(a(),l("div",Ll,[k.value?(a(),l("div",Il,[_[0]||(_[0]=s("strong",null,"Error:",-1)),s("pre",jl,y($.value),1)])):(a(),l("div",Pl,[s("div",Rl,[s("span",Wl,y(w.value)+":",1),s("span",Bl,y(b.value)+" "+y(b.value===1?"match":"matches"),1)]),s("div",Fl,[s("pre",Hl,y($.value),1)])]))])):M("",!0)]))}},$n=ne(Vl,[["__scopeId","data-v-0d272c39"]]),Ul={class:"web-tool-handler"},ql={class:"tool-section"},zl={class:"web-info"},Kl={class:"web-icon"},Gl=["href"],Yl={key:1,class:"web-query"},Jl={key:0,class:"web-prompt-container"},Ql={class:"prompt-content"},Xl={key:1,class:"web-domains"},Zl={class:"domains-label"},ec={key:0,class:"tool-section"},tc={key:0,class:"tool-result tool-result-error"},sc={class:"tool-code"},nc={key:1,class:"web-results"},oc={class:"results-header"},ic={class:"results-label"},ac={class:"results-content"},rc={class:"tool-code"},lc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="WebFetch"),o=h(()=>e.toolCall.input?.url||null),i=h(()=>e.toolCall.input?.query||null),r=h(()=>e.toolCall.input?.prompt||null),c=h(()=>e.toolCall.input?.allowed_domains||[]),f=h(()=>e.toolCall.input?.blocked_domains||[]),m=h(()=>c.value.length>0?c.value:f.value.length>0?f.value:[]),p=h(()=>c.value.length>0?"Allowed domains":f.value.length>0?"Blocked domains":"Domains"),u=h(()=>t.value?"ðŸŒ":"ðŸ”Ž"),w=h(()=>t.value?"Fetching URL":"Searching web"),g=h(()=>t.value?"Fetched content":"Search results"),k=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=h(()=>{if(!k.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,_)=>(a(),l("div",Ul,[s("div",ql,[s("div",zl,[s("span",Kl,y(u.value),1),s("strong",null,y(w.value)+":",1),o.value?(a(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,Gl)):i.value?(a(),l("code",Yl,y(i.value),1)):M("",!0)]),r.value?(a(),l("div",Jl,[_[0]||(_[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Ql,y(r.value),1)])):M("",!0),m.value.length>0?(a(),l("div",Xl,[s("span",Zl,y(p.value)+":",1),(a(!0),l(re,null,ce(m.value,v=>(a(),l("span",{key:v,class:"domain-badge"},y(v),1))),128))])):M("",!0)]),k.value?(a(),l("div",ec,[$.value?(a(),l("div",tc,[_[1]||(_[1]=s("strong",null,"Error:",-1)),s("pre",sc,y(b.value),1)])):(a(),l("div",nc,[s("div",oc,[s("span",ic,y(g.value)+":",1)]),s("div",ac,[s("pre",rc,y(b.value),1)])]))])):M("",!0)]))}},kn=ne(lc,[["__scopeId","data-v-62b55b55"]]),cc={class:"task-tool-handler"},uc={class:"tool-section"},dc={class:"task-header"},mc={key:0,class:"agent-type-badge"},pc={key:0,class:"task-description"},fc={class:"description-content"},vc={key:1,class:"task-prompt-container"},hc={class:"prompt-header"},_c={class:"prompt-length"},gc={class:"prompt-code"},bc={key:0,class:"tool-section"},yc={key:0,class:"tool-result tool-result-error"},wc={class:"tool-code"},$c={key:1,class:"agent-output"},kc={class:"output-header"},Sc={key:0,class:"output-count-badge"},Ec={class:"output-content"},Cc={class:"tool-code"},Tc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.description||null),o=h(()=>e.toolCall.input?.prompt||null),i=h(()=>e.toolCall.input?.subagent_type||null),r=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=h(()=>{if(!r.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),m=h(()=>f.value?f.value.split(`
`).length:0);return(p,u)=>(a(),l("div",cc,[s("div",uc,[s("div",dc,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=s("strong",null,"Agent Task:",-1)),i.value?(a(),l("span",mc,y(i.value),1)):M("",!0)]),t.value?(a(),l("div",pc,[u[2]||(u[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",fc,y(t.value),1)])):M("",!0),o.value?(a(),l("div",vc,[s("div",hc,[u[3]||(u[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",_c,y(o.value.length)+" characters",1)]),s("pre",gc,y(o.value),1)])):M("",!0)]),r.value?(a(),l("div",bc,[c.value?(a(),l("div",yc,[u[4]||(u[4]=s("strong",null,"Error:",-1)),s("pre",wc,y(f.value),1)])):(a(),l("div",$c,[s("div",kc,[u[5]||(u[5]=s("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(a(),l("span",Sc,y(m.value)+" lines",1)):M("",!0)]),s("div",Ec,[s("pre",Cc,y(f.value),1)])]))])):M("",!0)]))}},xc=ne(Tc,[["__scopeId","data-v-c520c244"]]),Ac={class:"task-create-tool-handler"},Mc={class:"tool-section"},Oc={class:"task-details p-2"},Dc={key:0,class:"task-field mb-2"},Nc={class:"field-value subject-value"},Lc={key:1,class:"task-field mb-2"},Ic={class:"field-value description-value"},jc={key:2,class:"task-field"},Pc={class:"field-value active-form-value"},Rc={key:0,class:"tool-section mt-2"},Wc={key:0,class:"tool-result tool-result-error"},Bc={class:"tool-code"},Fc={key:1,class:"tool-result tool-result-success"},Hc={class:"result-text"},Vc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.subject||null),o=h(()=>e.toolCall.input?.description||null),i=h(()=>e.toolCall.input?.activeForm||null),r=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=h(()=>{if(!r.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,p)=>(a(),l("div",Ac,[s("div",Mc,[p[3]||(p[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",Oc,[t.value?(a(),l("div",Dc,[p[0]||(p[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Nc,y(t.value),1)])):M("",!0),o.value?(a(),l("div",Lc,[p[1]||(p[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",Ic,y(o.value),1)])):M("",!0),i.value?(a(),l("div",jc,[p[2]||(p[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Pc,y(i.value),1)])):M("",!0)])]),r.value?(a(),l("div",Rc,[c.value?(a(),l("div",Wc,[p[4]||(p[4]=s("strong",null,"Error:",-1)),s("pre",Bc,y(f.value),1)])):(a(),l("div",Fc,[p[5]||(p[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Hc,y(f.value),1)]))])):M("",!0)]))}},Uc=ne(Vc,[["__scopeId","data-v-474dd444"]]),qc={class:"task-update-tool-handler"},zc={class:"tool-section"},Kc={class:"task-header"},Gc={key:0,class:"task-id-badge"},Yc={class:"task-details p-2"},Jc={key:0,class:"task-field mb-2"},Qc={key:1,class:"task-field mb-2"},Xc={class:"field-value"},Zc={key:2,class:"task-field mb-2"},eu={class:"field-value description-value"},tu={key:3,class:"task-field mb-2"},su={class:"field-value active-form-value"},nu={key:4,class:"task-field mb-2"},ou={class:"field-value"},iu={key:5,class:"task-field mb-2"},au={class:"field-value"},ru={key:6,class:"task-field"},lu={class:"field-value"},cu={key:0,class:"tool-section mt-2"},uu={key:0,class:"tool-result tool-result-error"},du={class:"tool-code"},mu={key:1,class:"tool-result tool-result-success"},pu={class:"result-text"},fu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.taskId||null),o=h(()=>e.toolCall.input?.status||null),i=h(()=>e.toolCall.input?.subject||null),r=h(()=>e.toolCall.input?.description||null),c=h(()=>e.toolCall.input?.activeForm||null),f=h(()=>e.toolCall.input?.owner||null),m=h(()=>e.toolCall.input?.addBlockedBy||[]),p=h(()=>e.toolCall.input?.addBlocks||[]),u=h(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=h(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!g.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,d)=>(a(),l("div",qc,[s("div",zc,[s("div",Kc,[d[0]||(d[0]=s("span",{class:"task-icon"},"âœï¸",-1)),d[1]||(d[1]=s("strong",null,"Update Task",-1)),t.value?(a(),l("span",Gc,"#"+y(t.value),1)):M("",!0)]),s("div",Yc,[o.value?(a(),l("div",Jc,[d[2]||(d[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:te(["field-value status-value",w.value])},y(u.value)+" "+y(o.value),3)])):M("",!0),i.value?(a(),l("div",Qc,[d[3]||(d[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Xc,y(i.value),1)])):M("",!0),r.value?(a(),l("div",Zc,[d[4]||(d[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",eu,y(r.value),1)])):M("",!0),c.value?(a(),l("div",tu,[d[5]||(d[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",su,y(c.value),1)])):M("",!0),f.value?(a(),l("div",nu,[d[6]||(d[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",ou,y(f.value),1)])):M("",!0),m.value?.length?(a(),l("div",iu,[d[7]||(d[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",au,[(a(!0),l(re,null,ce(m.value,_=>(a(),l("span",{key:_,class:"badge bg-warning text-dark me-1"},"#"+y(_),1))),128))])])):M("",!0),p.value?.length?(a(),l("div",ru,[d[8]||(d[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",lu,[(a(!0),l(re,null,ce(p.value,_=>(a(),l("span",{key:_,class:"badge bg-info text-dark me-1"},"#"+y(_),1))),128))])])):M("",!0)])]),g.value?(a(),l("div",cu,[k.value?(a(),l("div",uu,[d[9]||(d[9]=s("strong",null,"Error:",-1)),s("pre",du,y($.value),1)])):(a(),l("div",mu,[d[10]||(d[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",pu,y($.value),1)]))])):M("",!0)]))}},vu=ne(fu,[["__scopeId","data-v-35582330"]]),hu={class:"task-list-tool-handler"},_u={key:0,class:"tool-section"},gu={key:0,class:"tool-result tool-result-error"},bu={class:"tool-code"},yu={key:1,class:"task-list-result"},wu={key:0,class:"parsed-tasks"},$u={class:"status-icon"},ku={class:"task-id text-muted"},Su={class:"task-subject flex-grow-1"},Eu={key:0,class:"task-owner badge bg-secondary"},Cu={key:1,class:"raw-result p-2"},Tu={class:"tool-code"},xu={key:1,class:"tool-section"},Au={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=h(()=>{if(!t.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),r=h(()=>{if(!i.value)return[];const f=[],p=i.value.split(`
`);for(const u of p){const w=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const g=w[2].toLowerCase();f.push({id:w[1],status:g,subject:w[3].trim(),owner:null,statusIcon:c(g)})}}return f});function c(f){switch(f){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(f,m)=>(a(),l("div",hu,[m[2]||(m[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(a(),l("div",_u,[o.value?(a(),l("div",gu,[m[0]||(m[0]=s("strong",null,"Error:",-1)),s("pre",bu,y(i.value),1)])):(a(),l("div",yu,[r.value.length>0?(a(),l("div",wu,[(a(!0),l(re,null,ce(r.value,(p,u)=>(a(),l("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",$u,y(p.statusIcon),1),s("span",ku,"#"+y(p.id),1),s("span",Su,y(p.subject),1),p.owner?(a(),l("span",Eu,y(p.owner),1)):M("",!0)]))),128))])):(a(),l("div",Cu,[s("pre",Tu,y(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),l("div",xu,[...m[1]||(m[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):M("",!0)]))}},Mu=ne(Au,[["__scopeId","data-v-4e79ba4b"]]),Ou={class:"task-get-tool-handler"},Du={class:"tool-section"},Nu={class:"task-header"},Lu={key:0,class:"task-id-badge"},Iu={key:0,class:"tool-section"},ju={key:0,class:"tool-result tool-result-error"},Pu={class:"tool-code"},Ru={key:1,class:"task-details-result p-2"},Wu={key:0,class:"parsed-task"},Bu={class:"task-field mb-2"},Fu={class:"field-value subject-value"},Hu={key:0,class:"task-field mb-2"},Vu={key:1,class:"task-field mb-2"},Uu={class:"field-value description-value"},qu={key:2,class:"task-field mb-2"},zu={class:"field-value"},Ku={key:3,class:"task-field mb-2"},Gu={class:"field-value"},Yu={key:4,class:"task-field"},Ju={class:"field-value"},Qu={key:1,class:"raw-result"},Xu={class:"tool-code"},Zu={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.taskId||null),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=h(()=>{if(!o.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),c=h(()=>{if(!r.value)return null;const p=r.value;try{const g=JSON.parse(p);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const u=p.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of u){const k=g.match(/^Subject:\s*(.+)$/i);k&&(w.subject=k[1].trim());const $=g.match(/^Status:\s*(.+)$/i);$&&(w.status=$[1].trim());const b=g.match(/^Description:\s*(.+)$/i);b&&(w.description=b[1].trim());const d=g.match(/^Owner:\s*(.+)$/i);d&&(w.owner=d[1].trim())}return w.subject?w:null}),f=h(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=h(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,u)=>(a(),l("div",Ou,[s("div",Du,[s("div",Nu,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=s("strong",null,"Get Task",-1)),t.value?(a(),l("span",Lu,"#"+y(t.value),1)):M("",!0)])]),o.value?(a(),l("div",Iu,[i.value?(a(),l("div",ju,[u[2]||(u[2]=s("strong",null,"Error:",-1)),s("pre",Pu,y(r.value),1)])):(a(),l("div",Ru,[c.value?(a(),l("div",Wu,[s("div",Bu,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Fu,y(c.value.subject),1)]),c.value.status?(a(),l("div",Hu,[u[4]||(u[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:te(["field-value",m.value])},y(f.value)+" "+y(c.value.status),3)])):M("",!0),c.value.description?(a(),l("div",Vu,[u[5]||(u[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",Uu,y(c.value.description),1)])):M("",!0),c.value.owner?(a(),l("div",qu,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",zu,y(c.value.owner),1)])):M("",!0),c.value.blockedBy?.length?(a(),l("div",Ku,[u[7]||(u[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",Gu,[(a(!0),l(re,null,ce(c.value.blockedBy,w=>(a(),l("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):M("",!0),c.value.blocks?.length?(a(),l("div",Yu,[u[8]||(u[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Ju,[(a(!0),l(re,null,ce(c.value.blocks,w=>(a(),l("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):M("",!0)])):(a(),l("div",Qu,[s("pre",Xu,y(r.value),1)]))]))])):M("",!0)]))}},ed=ne(Zu,[["__scopeId","data-v-a80d14da"]]),td={class:"notebook-edit-tool-handler"},sd={class:"tool-section"},nd={class:"notebook-info"},od={class:"file-path"},id={class:"cell-info mt-2"},ad={class:"info-row"},rd={class:"info-row"},ld={key:0,class:"info-row"},cd={class:"badge bg-info"},ud={key:0,class:"source-preview mt-3"},dd={class:"preview-header"},md={class:"preview-stats"},pd={class:"source-code"},fd={key:0,class:"tool-section"},vd={key:0},hd={key:1,class:"text-danger"},_d={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.notebook_path||"Unknown"),o=h(()=>e.toolCall.input?.cell_id),i=h(()=>e.toolCall.input?.cell_type||"code"),r=h(()=>e.toolCall.input?.edit_mode||"replace"),c=h(()=>e.toolCall.input?.new_source||""),f=h(()=>c.value.split(`
`).length),m=h(()=>i.value==="code"?"bg-primary":"bg-secondary"),p=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=r.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,g)=>(a(),l("div",td,[s("div",sd,[s("div",nd,[g[0]||(g[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=s("strong",null,"Notebook:",-1)),s("code",od,y(t.value),1)]),s("div",id,[s("div",ad,[g[2]||(g[2]=s("strong",null,"Cell ID:",-1)),s("code",null,y(o.value||"N/A"),1)]),s("div",rd,[g[3]||(g[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:te(["badge",m.value])},y(i.value),3)]),r.value?(a(),l("div",ld,[g[4]||(g[4]=s("strong",null,"Edit Mode:",-1)),s("span",cd,y(r.value),1)])):M("",!0)]),c.value?(a(),l("div",ud,[s("div",dd,[g[5]||(g[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",md,y(f.value)+" lines",1)]),s("pre",pd,[s("code",null,y(c.value),1)])])):M("",!0)]),n.toolCall.result?(a(),l("div",fd,[g[6]||(g[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:te(["tool-result",p.value])},[n.toolCall.result.success!==!1?(a(),l("div",vd," âœ… "+y(u.value),1)):(a(),l("div",hd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):M("",!0)]))}},gd=ne(_d,[["__scopeId","data-v-c81a9bcf"]]),bd={class:"shell-tool-handler"},yd={class:"tool-section"},wd={class:"shell-info"},$d={class:"shell-icon"},kd={key:0,class:"shell-id"},Sd={key:0,class:"filter-info mt-2"},Ed={class:"filter-pattern"},Cd={key:0,class:"tool-section"},Td={class:"result-header mb-2"},xd={key:0,class:"mb-2"},Ad={class:"shell-output"},Md={key:1,class:"mb-2"},Od={class:"shell-output shell-output-error"},Dd={key:0},Nd={key:1,class:"text-danger"},Ld={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=h(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=h(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=h(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=h(()=>e.toolCall.input?.filter);function f(k,$){if(!k)return null;const b=new RegExp(`<${$}>([\\s\\S]*?)<\\/${$}>`,"i"),d=k.match(b);return d?d[1].trim():null}const m=h(()=>{const k=e.toolCall.result;if(!k)return null;let $=k;if(k.content&&($=k.content),typeof $=="string")return{status:f($,"status"),stdout:f($,"stdout"),stderr:f($,"stderr"),exit_code:f($,"exit_code")};if(Array.isArray($)){const b=$.find(d=>d.type==="text")?.text||"";return{status:f(b,"status"),stdout:f(b,"stdout"),stderr:f(b,"stderr"),exit_code:f(b,"exit_code")}}return{status:k.status||$.status,stdout:k.stdout||k.output||$.stdout||$.output,stderr:k.stderr||$.stderr,exit_code:k.exit_code||$.exit_code}}),p=h(()=>m.value?.status),u=h(()=>{const k=p.value;return k==="running"?"bg-success":k==="completed"?"bg-secondary":k==="killed"||k==="terminated"?"bg-danger":"bg-info"}),w=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const k=m.value;if(k?.status==="running"&&!k.stdout&&!k.stderr)return"No new output since last check";if(k?.status==="failed")return`Shell failed (exit code ${k.exit_code||"unknown"})`}return"Operation completed"});return(k,$)=>(a(),l("div",bd,[s("div",yd,[s("div",wd,[s("span",$d,y(t.value),1),s("strong",null,y(o.value)+":",1),r.value?(a(),l("code",kd,"Shell "+y(r.value),1)):M("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(a(),l("div",Sd,[$[0]||($[0]=s("strong",null,"Filter:",-1)),s("code",Ed,y(c.value),1)])):M("",!0)]),n.toolCall.result?(a(),l("div",Cd,[s("div",Td,[s("strong",null,y(i.value)+":",1),p.value?(a(),l("span",{key:0,class:te(["badge",u.value])},y(p.value),3)):M("",!0)]),m.value?.stdout?(a(),l("div",xd,[$[1]||($[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Ad,[s("pre",null,[s("code",null,y(m.value.stdout),1)])])])):M("",!0),m.value?.stderr?(a(),l("div",Md,[$[2]||($[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",Od,[s("pre",null,[s("code",null,y(m.value.stderr),1)])])])):M("",!0),!m.value?.stdout&&!m.value?.stderr?(a(),l("div",{key:2,class:te(["tool-result",w.value])},[n.toolCall.result.success!==!1?(a(),l("div",Dd," âœ… "+y(g.value),1)):(a(),l("div",Nd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):M("",!0)])):M("",!0)]))}},Sn=ne(Ld,[["__scopeId","data-v-86def281"]]),Id={class:"skill-tool-handler"},jd={key:0,class:"tool-section"},Pd={class:"d-flex align-items-center gap-2"},Rd={class:"text-muted small"},Wd={key:0,class:"skill-content-body"},Bd={class:"skill-content-text"},Fd={key:1,class:"tool-section mt-3"},Hd={class:"tool-result tool-result-error"},Vd={class:"tool-code"},Ud={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=P(!1);function r(){i.value=!i.value}const c=h(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let b=null,d=null;for(let _=$+1;_<Math.min($+3,k.length);_++){const v=k[_];if(v.type!=="user")continue;const T=v.content||"";T.includes("<command-message>")&&T.includes("skill is running")?b=v:T.startsWith("Base directory for this skill:")&&(d=v)}return{running:b,content:d}}),f=h(()=>{const g=c.value.content;if(!g)return"";const k=g.content||"",$=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return k.replace($,"").trim()}),m=h(()=>f.value.length>0),p=h(()=>f.value?f.value.split(`
`).length:0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),l("div",Id,[m.value?(a(),l("div",jd,[s("div",{class:"skill-content-header",onClick:r},[s("div",Pd,[s("i",{class:te(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),k[0]||(k[0]=s("strong",null,"Skill Content",-1)),s("span",Rd,"("+y(p.value)+" lines)",1)])]),i.value?(a(),l("div",Wd,[s("pre",Bd,y(f.value),1)])):M("",!0)])):M("",!0),u.value?(a(),l("div",Fd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Hd,[s("pre",Vd,y(w.value),1)])])):M("",!0)]))}},qd=ne(Ud,[["__scopeId","data-v-0a48ca0f"]]),zd={class:"slashcommand-tool-handler"},Kd={key:0,class:"tool-section"},Gd={class:"d-flex align-items-center gap-2"},Yd=["aria-label"],Jd={class:"text-muted small"},Qd={key:0,class:"command-content-body"},Xd={class:"command-content-text"},Zd={key:1,class:"tool-section mt-3"},em={class:"tool-result tool-result-error"},tm={class:"tool-code"},sm={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=P(!1);function r(){i.value=!i.value}const c=h(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let b=null,d=null;for(let _=$+1;_<Math.min($+3,k.length);_++){const v=k[_];if(v.type!=="user")continue;const T=v.content||"";T.includes("<command-message>")&&T.includes("<command-name>")&&T.includes("<command-args>")?b=v:T.includes("ARGUMENTS:")&&(d=v)}return{running:b,content:d}}),f=h(()=>{const g=c.value.content;if(!g)return"";const k=g.content||"",$=/\nARGUMENTS:.*$/s;return k.replace($,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=h(()=>f.value.length>0),p=h(()=>f.value?f.value.split(`
`).length:0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),l("div",zd,[m.value?(a(),l("div",Kd,[s("div",{class:"command-content-header",onClick:r},[s("div",Gd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},y(i.value?"â–¾":"â–¸"),9,Yd),k[0]||(k[0]=s("strong",null,"Command Content",-1)),s("span",Jd,"("+y(p.value)+" lines)",1)])]),i.value?(a(),l("div",Qd,[s("pre",Xd,y(f.value),1)])):M("",!0)])):M("",!0),u.value?(a(),l("div",Zd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",em,[s("pre",tm,y(w.value),1)])])):M("",!0)]))}},nm=ne(sm,[["__scopeId","data-v-15991acf"]]),om={class:"exit-plan-mode-tool-handler"},im={class:"tool-section"},am={key:0,class:"plan-content mt-2"},rm={class:"plan-text"},lm={key:0,class:"tool-section"},cm={key:0},um={key:1,class:"text-danger"},dm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.plan),o=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,r)=>(a(),l("div",om,[s("div",im,[r[1]||(r[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(a(),l("div",am,[r[0]||(r[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",rm,y(t.value),1)])):M("",!0)]),n.toolCall.result?(a(),l("div",lm,[r[2]||(r[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:te(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),l("div",cm," âœ… Permission mode reverted to default ")):(a(),l("div",um," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):M("",!0)]))}},mm=ne(dm,[["__scopeId","data-v-e2e3c781"]]),pm={class:"ask-user-question-handler"},fm={key:0,class:"answers-summary"},vm={class:"answer-question text-muted small"},hm={class:"answer-value fw-medium"},_m={key:1,class:"text-muted small"},gm={key:0,class:"questions-container"},bm={class:"question-header d-flex align-items-center gap-2 mb-2"},ym={key:0,class:"badge bg-secondary"},wm={class:"question-text fw-medium"},$m={class:"options-list"},km=["id","checked","onChange"],Sm=["id","name","checked","onChange"],Em=["for"],Cm={class:"option-label"},Tm={key:0,class:"option-description text-muted d-block small"},xm={class:"option-item form-check other-option"},Am=["id","checked","onChange"],Mm=["id","name","checked","onChange"],Om=["for"],Dm={key:2,class:"other-input mt-2"},Nm=["onUpdate:modelValue","onInput"],Lm={key:1,class:"alert alert-info mb-0"},Im={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=h(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=h(()=>{if(!r.value)return{};const E=o.toolCall.result;if(E?.content){if(typeof E.content=="object"&&E.content.answers)return E.content.answers;if(typeof E.content=="string")try{const I=JSON.parse(E.content);if(I.answers)return I.answers}catch{}}const R=o.toolCall.input||{};return R.answers?R.answers:{}}),f=h(()=>Object.keys(c.value).length>0),m=h(()=>(o.toolCall.input||{}).questions||[]),p=P({}),u=P({});fe(m,E=>{E.forEach((R,I)=>{I in p.value||(p.value[I]=R.multiSelect?[]:null),I in u.value||(u.value[I]="")})},{immediate:!0});function w(E,R){const I=p.value[E];return Array.isArray(I)?I.includes(R):I===R}function g(E){const R=p.value[E];return Array.isArray(R)?R.includes("__OTHER__"):R==="__OTHER__"}function k(E,R){p.value[E]=R,v()}function $(E){p.value[E]="__OTHER__",v()}function b(E,R){const I=p.value[E];if(!Array.isArray(I))p.value[E]=[R];else{const O=I.indexOf(R);O===-1?I.push(R):I.splice(O,1)}v()}function d(E){const R=p.value[E];if(!Array.isArray(R))p.value[E]=["__OTHER__"];else{const I=R.indexOf("__OTHER__");I===-1?R.push("__OTHER__"):R.splice(I,1)}v()}function _(E){v()}function v(){const E={};m.value.forEach((R,I)=>{const O=p.value[I],H=R.question;if(R.multiSelect){if(Array.isArray(O)&&O.length>0){const x=O.map(A=>A==="__OTHER__"?u.value[I]||"":A).filter(A=>A);E[H]=x.join(", ")}}else O==="__OTHER__"?E[H]=u.value[I]||"":O&&(E[H]=O)}),i("answer",E)}const T=h(()=>m.value.every((E,R)=>{const I=p.value[R];if(E.multiSelect){if(!Array.isArray(I)||I.length===0||I.includes("__OTHER__")&&!u.value[R])return!1}else if(!I||I==="__OTHER__"&&!u.value[R])return!1;return!0}));return e({allQuestionsAnswered:T,getAnswers:()=>{const E={};return m.value.forEach((R,I)=>{const O=p.value[I],H=R.question;if(R.multiSelect){if(Array.isArray(O)&&O.length>0){const x=O.map(A=>A==="__OTHER__"?u.value[I]||"":A).filter(A=>A);E[H]=x.join(", ")}}else O==="__OTHER__"?E[H]=u.value[I]||"":O&&(E[H]=O)}),E}}),(E,R)=>(a(),l("div",pm,[r.value?(a(),l(re,{key:0},[f.value?(a(),l("div",fm,[(a(!0),l(re,null,ce(c.value,(I,O)=>(a(),l("div",{key:O,class:"answer-item mb-2"},[s("div",vm,y(O),1),s("div",hm,y(I),1)]))),128))])):(a(),l("div",_m," No answers recorded. "))],64)):(a(),l(re,{key:1},[m.value.length>0?(a(),l("div",gm,[(a(!0),l(re,null,ce(m.value,(I,O)=>(a(),l("div",{key:O,class:"question-block mb-3"},[s("div",bm,[I.header?(a(),l("span",ym,y(I.header),1)):M("",!0),s("span",wm,y(I.question),1)]),s("div",$m,[(a(!0),l(re,null,ce(I.options,(H,x)=>(a(),l("div",{key:x,class:te(["option-item form-check",{selected:w(O,H.label)}])},[I.multiSelect?(a(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${O}-opt${x}`,checked:w(O,H.label),onChange:A=>b(O,H.label)},null,40,km)):(a(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${O}-opt${x}`,name:`question-${O}`,checked:w(O,H.label),onChange:A=>k(O,H.label)},null,40,Sm)),s("label",{class:"form-check-label",for:`q${O}-opt${x}`},[s("span",Cm,y(H.label),1),H.description?(a(),l("span",Tm,y(H.description),1)):M("",!0)],8,Em)],2))),128)),s("div",xm,[I.multiSelect?(a(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${O}-other`,checked:g(O),onChange:H=>d(O)},null,40,Am)):(a(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${O}-other`,name:`question-${O}`,checked:g(O),onChange:H=>$(O)},null,40,Mm)),s("label",{class:"form-check-label",for:`q${O}-other`},[...R[0]||(R[0]=[s("span",{class:"option-label"},"Other",-1)])],8,Om),g(O)?(a(),l("div",Dm,[ge(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":H=>u.value[O]=H,placeholder:"Enter your custom answer...",onInput:H=>_()},null,40,Nm),[[We,u.value[O]]])])):M("",!0)])])]))),128))])):(a(),l("div",Lm," No questions to display. "))],64))]))}},En=ne(Im,[["__scopeId","data-v-75ce45b4"]]),jm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Pm={class:"tool-status-icon"},Rm=["title"],Wm={class:"d-flex align-items-center gap-2"},Bm={class:"text-muted"},Fm=["aria-label"],Hm={key:0,class:"card-body"},Vm={key:0,class:"alert alert-warning mb-3"},Um={class:"d-flex align-items-center"},qm={class:"mb-0 small"},zm={key:2,class:"permission-prompt mt-3"},Km={class:"question-buttons d-flex gap-2 mt-3"},Gm=["disabled"],Ym=["disabled"],Jm={class:"alert alert-warning mb-3"},Qm={class:"mb-0"},Xm={class:"tool-name"},Zm={key:0,class:"suggestions-section mb-3"},ep={class:"alert alert-info mb-0"},tp={class:"suggestion-details p-2 bg-white rounded"},sp={class:"permission-buttons d-flex gap-2 mb-3"},np=["disabled"],op=["disabled"],ip=["disabled"],ap={class:"guidance-section mt-3"},rp=["disabled"],lp=["disabled"],cp={key:3,class:"mt-3"},up={class:"alert alert-warning mb-0"},dp={class:"d-flex align-items-center"},mp={class:"mb-0 small"},pp={key:4,class:"tool-section"},fp={class:"alert alert-danger mb-0"},vp={key:0},hp={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=nt(),r=P(!1),c=P(null),f=P(""),m=P(null),p=P({}),u=h(()=>e.toolCall.name==="AskUserQuestion"),w=h(()=>!u.value||!m.value?!1:m.value.allQuestionsAnswered);function g(S){p.value=S}async function k(){if(!r.value&&m.value){r.value=!0,c.value="submit-answers";try{const S=o.currentSessionId,C=m.value.getAnswers(),F={questions:e.toolCall.input?.questions||[],answers:C};S&&(t.updateToolCall(S,e.toolCall.id,{input:F}),t.handlePermissionResponse(S,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",F)}catch(S){console.error("Failed to submit question answers:",S)}finally{r.value=!1,c.value=null}}}const $=h(()=>e.toolCall.backendStatus==="interrupted"?!0:t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),b=h(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),d=h(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),_=h(()=>{if(e.toolCall.backendStatus){const S=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[S]||S}if(d.value){const S=d.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[S]||S}return e.toolCall.status}),v={Read:lr,Write:Er,Bash:Rr,TodoWrite:tl,Edit:kl,Grep:$n,Glob:$n,WebFetch:kn,WebSearch:kn,Task:xc,TaskCreate:Uc,TaskUpdate:vu,TaskList:Mu,TaskGet:ed,NotebookEdit:gd,BashOutput:Sn,KillShell:Sn,SlashCommand:nm,Skill:qd,ExitPlanMode:mm,AskUserQuestion:En},T=h(()=>{const S=e.toolCall.name;return v[S]?v[S]:Ba}),E=h(()=>{const S=[];if($.value)return S.push("border-warning"),S.join(" ");switch(_.value){case"pending":S.push("border-secondary");break;case"permission_required":S.push("border-warning");break;case"executing":S.push("border-primary");break;case"completed":O.value||e.toolCall.permissionDecision==="deny"?S.push("border-danger"):S.push("border-success");break;case"error":S.push("border-danger");break}return S.join(" ")}),R=h(()=>{if($.value)return"â¹ï¸";switch(_.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":O.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),I=h(()=>Ht(e.toolCall.timestamp)),O=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),H=h(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function x(S){if(!S)return"";const C=S.replace(/\\/g,"/").split("/");return C[C.length-1]}function A(S){if(!S)return"";const C=S.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return C?C[1]:S}function W(S,C=200){return S?S.length<=C?S:S.substring(0,C)+"...":""}function K(S){if(!S)return null;if(S.content){const C=S.content.match(/exit code (\d+)/i);if(C)return parseInt(C[1])}return S.error?1:0}function L(S,C){const F=S?S.split(`
`).length:0;return{added:C?C.split(`
`).length:0,removed:F}}const B=h(()=>{const S=e.toolCall.name,C=e.toolCall.input||{},F=e.toolCall.result,J=_.value;switch(S){case"Bash":case"Shell":case"Command":{const z=A(C.command),Q=W(z,200);if(J==="completed"&&F){const se=K(F);return`Bash: ${Q} (exit ${se})`}return`Bash: ${Q}`}case"SlashCommand":{const z=W(C.command,200);return J==="completed"&&F?`SlashCommand: ${z}`:`SlashCommand: ${z}`}case"Edit":{const z=x(C.file_path);if(J==="completed"&&F&&!F.error){const{added:Q,removed:se}=L(C.old_string,C.new_string);return Q===se?`Edit: ${z} (${Q} lines changed)`:`Edit: ${z} (${Q} lines added, ${se} removed)`}return`Edit: ${z}`}case"Read":{const z=x(C.file_path);if(C.offset!==void 0||C.limit!==void 0){const se=(C.offset||0)+1,X=C.limit?(C.offset||0)+C.limit:"âˆž";return`Read: ${z} (lines ${se}-${X})`}return`Read: ${z} (full file)`}case"Write":{const z=x(C.file_path);if(J==="completed"&&F&&!F.error&&C.content){const Q=C.content.split(`
`).length;return`Write: ${z} (${Q} lines written)`}return`Write: ${z}`}case"Skill":{const z=C.skill||"Unknown";return J==="completed"&&F?F.error?`Skill: ${z} (error)`:`Skill: ${z} (completed)`:`Skill: ${z}`}case"Task":{const z=C.subagent_type||"general",Q=C.description||"Task";return J==="completed"&&F?F.error?`Task: (${z}) ${Q} (error)`:`Task: (${z}) ${Q} (completed)`:`Task: (${z}) ${Q}`}case"TodoWrite":{if(C.todos&&Array.isArray(C.todos)){const z=C.todos.filter(X=>X.status==="completed").length,Q=C.todos.length,se=C.todos.find(X=>X.status==="in_progress");return se?`Todo: Working on "${se.content}"`:`Todo: ${z}/${Q} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const z=C.pattern||"",Q=S==="Grep"?"Grep":"Glob";if(J==="completed"&&F&&!F.error){let se=0;return F.content&&(se=F.content.split(`
`).filter(V=>V.trim()).length),`${Q}: "${z}" (${se} results)`}return`${Q}: "${z}"`}case"WebFetch":case"WebSearch":{const z=C.url||C.query||"";if(S==="WebSearch"){const se=C.query||"",X=se.length>50?se.substring(0,50)+"...":se;return J==="completed"&&F?F.error?`Web: ${X} (error)`:`Web: ${X} (success)`:`Web: ${X}`}let Q="";try{z&&(Q=new URL(z.startsWith("http")?z:`https://${z}`).hostname)}catch{Q=z.length>50?z.substring(0,50)+"...":z}return J==="completed"&&F?F.error?`Web: ${Q} (error)`:`Web: ${Q} (success)`:`Web: ${Q||z}`}case"NotebookEdit":{const z=x(C.notebook_path),Q=C.cell_number!==void 0?C.cell_number:"?",se=C.edit_mode||"replace";return`NotebookEdit: ${z} cell #${Q} (${se})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${C.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${C.shell_id||"unknown"}`;case"AskUserQuestion":{const Q=(C.questions||[]).length;return J==="completed"&&F&&!F.error?`AskUserQuestion: ${Q} question(s) answered`:J==="permission_required"?`AskUserQuestion: ${Q} question(s) awaiting response`:`AskUserQuestion: ${Q} question(s)`}case"TaskCreate":{const z=C.subject||"",Q=z.length>40?z.substring(0,40)+"...":z;return J==="completed"&&F&&!F.error?`TaskCreate: "${Q}" (created)`:`TaskCreate: "${Q}"`}case"TaskUpdate":{const z=C.taskId||"?",Q=C.status||"";return Q?`TaskUpdate: #${z} -> ${Q}`:`TaskUpdate: #${z}`}case"TaskList":return J==="completed"&&F&&!F.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const z=C.taskId||"?";return J==="completed"&&F&&!F.error?`TaskGet: #${z} (retrieved)`:`TaskGet: #${z}`}default:return`${S}: executed`}}),q=h(()=>{const S=e.toolCall.name,C=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(S)?C.command||S:["Edit","Read","Write","NotebookEdit"].includes(S)&&(C.file_path||C.notebook_path)||S});function Z(){const S=o.currentSessionId;S&&t.toggleToolExpansion(S,e.toolCall.id)}function D(S){return S.type==="setMode"?`Set permission mode to "${S.mode}"`:S.type==="allow"?`Allow tool: ${S.tool}`:JSON.stringify(S)}async function N(S,C,F=null){if(!r.value){r.value=!0,S==="allow"?c.value=C?"approve-apply":"approve":F?c.value="deny-guidance":c.value="deny";try{const J=o.currentSessionId;if(J){const z=C&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(J,{request_id:e.toolCall.permissionRequestId,decision:S,reasoning:S==="allow"?"User allowed permission":"User denied permission",applied_updates:z})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,S,C,F)}catch(J){console.error("Failed to send permission response:",J)}finally{r.value=!1,c.value=null}}}return(S,C)=>(a(),l("div",{class:te(["tool-call-card card",E.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:Z},[s("div",jm,[s("span",Pm,y(R.value),1),s("span",{class:"tool-name",title:q.value},y(B.value),9,Rm)]),s("div",Wm,[s("small",Bm,y(I.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Fm)])]),n.toolCall.isExpanded?(a(),l("div",Hm,[$.value?(a(),l("div",Vm,[s("div",Um,[C[7]||(C[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[C[6]||(C[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",qm,y(b.value?.message||"Session was terminated"),1)])])])):M("",!0),u.value&&_.value==="permission_required"?M("",!0):(a(),be(po(T.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),_.value==="permission_required"&&!$.value?(a(),l("div",zm,[u.value?(a(),l(re,{key:0},[C[8]||(C[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),pe(En,{ref_key:"questionHandlerRef",ref:m,toolCall:n.toolCall,onAnswer:g},null,8,["toolCall"]),s("div",Km,[s("button",{class:"btn btn-primary",onClick:k,disabled:r.value||!w.value},y(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,Gm),s("button",{class:"btn btn-outline-secondary",onClick:C[0]||(C[0]=F=>N("deny",!1)),disabled:r.value}," Skip Question ",8,Ym)])],64)):(a(),l(re,{key:1},[s("div",Jm,[C[11]||(C[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Qm,[C[9]||(C[9]=ie("Claude wants to use the ",-1)),s("code",Xm,y(n.toolCall.name),1),C[10]||(C[10]=ie(" tool.",-1))])]),H.value?(a(),l("div",Zm,[s("div",ep,[C[12]||(C[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),C[13]||(C[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",tp,[(a(!0),l(re,null,ce(n.toolCall.suggestions,(F,J)=>(a(),l("div",{key:J,class:"suggestion-item"},[s("code",null,y(D(F)),1)]))),128))]),C[14]||(C[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):M("",!0),s("div",sp,[H.value?(a(),l("button",{key:0,class:"btn btn-success",onClick:C[1]||(C[1]=F=>N("allow",!0)),disabled:r.value},y(r.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,np)):M("",!0),s("button",{class:te(["btn",H.value?"btn-outline-success":"btn-success"]),onClick:C[2]||(C[2]=F=>N("allow",!1)),disabled:r.value},y(r.value&&c.value==="approve"?"â³ Submitting...":H.value?"âœ… Approve Only":"âœ… Approve"),11,op),s("button",{class:"btn btn-danger",onClick:C[3]||(C[3]=F=>N("deny",!1)),disabled:r.value}," ðŸš« "+y(r.value&&c.value==="deny"?"Submitting...":"Deny"),9,ip)]),s("div",ap,[C[15]||(C[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),C[16]||(C[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ge(s("textarea",{"onUpdate:modelValue":C[4]||(C[4]=F=>f.value=F),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:r.value},null,8,rp),[[We,f.value]]),f.value.trim()?(a(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:C[5]||(C[5]=F=>N("deny",!1,f.value)),disabled:r.value},y(r.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,lp)):M("",!0)])],64))])):M("",!0),_.value==="permission_required"&&$.value?(a(),l("div",cp,[s("div",up,[s("div",dp,[C[18]||(C[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[C[17]||(C[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",mp,y(b.value?.message||"Session was terminated before permission could be granted"),1)])])])])):M("",!0),n.toolCall.permissionDecision==="deny"?(a(),l("div",pp,[s("div",fp,[C[19]||(C[19]=ie(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),l("span",vp," - "+y(n.toolCall.result.message),1)):M("",!0)])])):M("",!0)])):M("",!0)],2))}},_p=ne(hp,[["__scopeId","data-v-2377ca10"]]);function Cn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function gp(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Tn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function bp(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=gp(t.command),i=Tn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Tn(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=Cn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",r=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Cn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const yp={key:0,class:"tool-timeline-bar"},wp={class:"timeline-container"},$p=["title","onClick","onKeydown"],kp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=Ae(),r=de(),c=h(()=>t.tools.map((k,$)=>({tool:k,originalIndex:$})).sort((k,$)=>{if(k.tool.timestamp&&$.tool.timestamp){const b=new Date(k.tool.timestamp).getTime(),d=new Date($.tool.timestamp).getTime();if(b!==d)return b-d}return k.originalIndex-$.originalIndex}).map(({tool:k})=>k));function f(k){const $=r.currentSessionId;if(!$)return k.status;const b=i.getBackendToolState($,k.id);return b?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[b.state]||b.state:i.isToolUseOrphaned($,k.id)?"orphaned":k.status}function m(k){return k.result?.error||k.status==="error"||k.permissionDecision==="deny"}function p(k){return f(k)==="executing"}function u(k){switch(f(k)){case"completed":return m(k)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w(k){const $=bp(k),b=f(k),d={completed:m(k)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[b]||b;return`${$} [${d}]`}function g(k,$){o("segment-click",{tool:k,index:$})}return(k,$)=>c.value.length>0?(a(),l("div",yp,[s("div",wp,[(a(!0),l(re,null,ce(c.value,(b,d)=>(a(),l("div",{key:b.id,class:te(["timeline-segment",u(b)]),style:{flex:1},title:w(b),onClick:_=>g(b,d),role:"button",tabindex:"0",onKeydown:[qe(_=>g(b,d),["enter"]),qe(ve(_=>g(b,d),["prevent"]),["space"])]},[s("span",{class:te(["segment-inner",{"executing-pulse":p(b)}])},null,2)],42,$p))),128))])])):M("",!0)}},Sp=ne(kp,[["__scopeId","data-v-4a85fba6"]]),Ep={class:"tool-footer-container"},Cp={class:"tool-cards-list"},Tp={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Ae(),o=de(),i=h(()=>e.tools.map((c,f)=>({tool:c,originalIndex:f})).sort((c,f)=>{if(c.tool.timestamp&&f.tool.timestamp){const m=new Date(c.tool.timestamp).getTime(),p=new Date(f.tool.timestamp).getTime();if(m!==p)return m-p}return c.originalIndex-f.originalIndex}).map(({tool:c})=>c));async function r({tool:c}){const f=o.currentSessionId;if(!f)return;t.toggleToolExpansion(f,c.id),await St();const m=document.querySelector(`[data-tool-id="${c.id}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,f)=>(a(),l("div",Ep,[pe(Sp,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),s("div",Cp,[(a(!0),l(re,null,ce(i.value,m=>(a(),be(_p,{key:m.id,toolCall:m,"data-tool-id":m.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},xp=ne(Tp,[["__scopeId","data-v-527d59ae"]]),Ap={class:"message-row message-row-assistant"},Mp=["title"],Op={class:"message-content-column"},Dp={key:0,class:"thinking-block mb-2"},Np=["innerHTML"],Lp={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ae(),o=de();dt.setOptions({breaks:!0,gfm:!0});const i=h(()=>Ht(e.message.timestamp)),r=h(()=>e.message.metadata?.model||null),c=h(()=>{const $=i.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${$}`}),f=h(()=>{const $=e.message.content||"";return $.trim().length>0&&$!=="Assistant response"}),m=h(()=>{const $=e.message.content||"";let b=dt.parse($);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),cs.sanitize(b)}),p=h(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=h(()=>e.message.metadata?.thinking_content||""),w=h(()=>{const $=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return $||b}),g=h(()=>{const $=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],d=[...$],_=new Set($.map(v=>v.id));for(const v of b)_.has(v.id)||d.push(v);return d}),k=h(()=>{const $=o.currentSessionId;if(!$)return[];const b=t.toolCallsBySession.get($)||[];return g.value.map(d=>{const _=b.find(v=>v.id===d.id);return _||{id:d.id,name:d.name,input:d.input,status:"pending",result:null,timestamp:d.timestamp||e.message.timestamp,isExpanded:!0}})});return($,b)=>(a(),l("div",Ap,[s("div",{class:"message-speaker",title:c.value},[...b[0]||(b[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Mp),s("div",Op,[p.value?(a(),l("div",Dp,[pe(xa,{thinking:u.value},null,8,["thinking"])])):M("",!0),f.value?(a(),l("div",{key:1,class:"message-text",innerHTML:m.value},null,8,Np)):M("",!0),w.value?(a(),be(xp,{key:2,tools:k.value},null,8,["tools"])):M("",!0)])]))}},Ip=ne(Lp,[["__scopeId","data-v-2e32f6ef"]]),jp={key:0,class:"message-row message-row-compaction"},Pp=["title"],Rp={class:"message-content-column"},Wp={class:"compaction-status-content"},Bp={class:"text-muted ms-auto"},Fp={key:1,class:"message-row message-row-system"},Hp=["title"],Vp={class:"message-content-column"},Up={class:"system-text"},qp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>Ht(e.message.timestamp)),o=h(()=>`system
${t.value}`),i=h(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,c)=>i.value?(a(),l("div",jp,[s("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Pp),s("div",Rp,[s("div",Wp,[c[1]||(c[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Bp,y(t.value),1)])])])):(a(),l("div",Fp,[s("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Hp),s("div",Vp,[s("span",Up,y(n.message.content),1)])]))}},xn=ne(qp,[["__scopeId","data-v-a078178f"]]),zp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=h(()=>{switch(e.message.type){case"user":return wa;case"assistant":return Ip;case"system":return xn;default:return xn}});return(o,i)=>(a(),be(po(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Kp=ne(zp,[["__scopeId","data-v-11dff525"]]);var ke="top",Me="bottom",Oe="right",Se="left",us="auto",Nt=[ke,Me,Oe,Se],mt="start",Ct="end",go="clippingParents",Ys="viewport",bt="popper",bo="reference",Hs=Nt.reduce(function(n,e){return n.concat([e+"-"+mt,e+"-"+Ct])},[]),Js=[].concat(Nt,[us]).reduce(function(n,e){return n.concat([e,e+"-"+mt,e+"-"+Ct])},[]),yo="beforeRead",wo="read",$o="afterRead",ko="beforeMain",So="main",Eo="afterMain",Co="beforeWrite",To="write",xo="afterWrite",Ao=[yo,wo,$o,ko,So,Eo,Co,To,xo];function Ue(n){return n?(n.nodeName||"").toLowerCase():null}function De(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function pt(n){var e=De(n).Element;return n instanceof e||n instanceof Element}function Ne(n){var e=De(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Qs(n){if(typeof ShadowRoot>"u")return!1;var e=De(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Gp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];!Ne(r)||!Ue(r)||(Object.assign(r.style,o),Object.keys(i).forEach(function(c){var f=i[c];f===!1?r.removeAttribute(c):r.setAttribute(c,f===!0?"":f)}))})}function Yp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],r=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),f=c.reduce(function(m,p){return m[p]="",m},{});!Ne(i)||!Ue(i)||(Object.assign(i.style,f),Object.keys(r).forEach(function(m){i.removeAttribute(m)}))})}}const Mo={name:"applyStyles",enabled:!0,phase:"write",fn:Gp,effect:Yp,requires:["computeStyles"]};function He(n){return n.split("-")[0]}var ut=Math.max,is=Math.min,Tt=Math.round;function Vs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Oo(){return!/^((?!chrome|android).)*safari/i.test(Vs())}function xt(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,r=1;e&&Ne(n)&&(i=n.offsetWidth>0&&Tt(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&Tt(o.height)/n.offsetHeight||1);var c=pt(n)?De(n):window,f=c.visualViewport,m=!Oo()&&t,p=(o.left+(m&&f?f.offsetLeft:0))/i,u=(o.top+(m&&f?f.offsetTop:0))/r,w=o.width/i,g=o.height/r;return{width:w,height:g,top:u,right:p+w,bottom:u+g,left:p,x:p,y:u}}function Xs(n){var e=xt(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function Do(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Qs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ye(n){return De(n).getComputedStyle(n)}function Jp(n){return["table","td","th"].indexOf(Ue(n))>=0}function ot(n){return((pt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ds(n){return Ue(n)==="html"?n:n.assignedSlot||n.parentNode||(Qs(n)?n.host:null)||ot(n)}function An(n){return!Ne(n)||Ye(n).position==="fixed"?null:n.offsetParent}function Qp(n){var e=/firefox/i.test(Vs()),t=/Trident/i.test(Vs());if(t&&Ne(n)){var o=Ye(n);if(o.position==="fixed")return null}var i=ds(n);for(Qs(i)&&(i=i.host);Ne(i)&&["html","body"].indexOf(Ue(i))<0;){var r=Ye(i);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return i;i=i.parentNode}return null}function Vt(n){for(var e=De(n),t=An(n);t&&Jp(t)&&Ye(t).position==="static";)t=An(t);return t&&(Ue(t)==="html"||Ue(t)==="body"&&Ye(t).position==="static")?e:t||Qp(n)||e}function Zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wt(n,e,t){return ut(n,is(e,t))}function Xp(n,e,t){var o=Wt(n,e,t);return o>t?t:o}function No(){return{top:0,right:0,bottom:0,left:0}}function Lo(n){return Object.assign({},No(),n)}function Io(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Zp=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Lo(typeof e!="number"?e:Io(e,Nt))};function ef(n){var e,t=n.state,o=n.name,i=n.options,r=t.elements.arrow,c=t.modifiersData.popperOffsets,f=He(t.placement),m=Zs(f),p=[Se,Oe].indexOf(f)>=0,u=p?"height":"width";if(!(!r||!c)){var w=Zp(i.padding,t),g=Xs(r),k=m==="y"?ke:Se,$=m==="y"?Me:Oe,b=t.rects.reference[u]+t.rects.reference[m]-c[m]-t.rects.popper[u],d=c[m]-t.rects.reference[m],_=Vt(r),v=_?m==="y"?_.clientHeight||0:_.clientWidth||0:0,T=b/2-d/2,E=w[k],R=v-g[u]-w[$],I=v/2-g[u]/2+T,O=Wt(E,I,R),H=m;t.modifiersData[o]=(e={},e[H]=O,e.centerOffset=O-I,e)}}function tf(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Do(e.elements.popper,i)&&(e.elements.arrow=i))}const jo={name:"arrow",enabled:!0,phase:"main",fn:ef,effect:tf,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function At(n){return n.split("-")[1]}var sf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function nf(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Tt(t*i)/i||0,y:Tt(o*i)/i||0}}function Mn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,r=n.variation,c=n.offsets,f=n.position,m=n.gpuAcceleration,p=n.adaptive,u=n.roundOffsets,w=n.isFixed,g=c.x,k=g===void 0?0:g,$=c.y,b=$===void 0?0:$,d=typeof u=="function"?u({x:k,y:b}):{x:k,y:b};k=d.x,b=d.y;var _=c.hasOwnProperty("x"),v=c.hasOwnProperty("y"),T=Se,E=ke,R=window;if(p){var I=Vt(t),O="clientHeight",H="clientWidth";if(I===De(t)&&(I=ot(t),Ye(I).position!=="static"&&f==="absolute"&&(O="scrollHeight",H="scrollWidth")),I=I,i===ke||(i===Se||i===Oe)&&r===Ct){E=Me;var x=w&&I===R&&R.visualViewport?R.visualViewport.height:I[O];b-=x-o.height,b*=m?1:-1}if(i===Se||(i===ke||i===Me)&&r===Ct){T=Oe;var A=w&&I===R&&R.visualViewport?R.visualViewport.width:I[H];k-=A-o.width,k*=m?1:-1}}var W=Object.assign({position:f},p&&sf),K=u===!0?nf({x:k,y:b},De(t)):{x:k,y:b};if(k=K.x,b=K.y,m){var L;return Object.assign({},W,(L={},L[E]=v?"0":"",L[T]=_?"0":"",L.transform=(R.devicePixelRatio||1)<=1?"translate("+k+"px, "+b+"px)":"translate3d("+k+"px, "+b+"px, 0)",L))}return Object.assign({},W,(e={},e[E]=v?b+"px":"",e[T]=_?k+"px":"",e.transform="",e))}function of(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,r=t.adaptive,c=r===void 0?!0:r,f=t.roundOffsets,m=f===void 0?!0:f,p={placement:He(e.placement),variation:At(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Mn(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Mn(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Po={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:of,data:{}};var Yt={passive:!0};function af(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,r=i===void 0?!0:i,c=o.resize,f=c===void 0?!0:c,m=De(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&p.forEach(function(u){u.addEventListener("scroll",t.update,Yt)}),f&&m.addEventListener("resize",t.update,Yt),function(){r&&p.forEach(function(u){u.removeEventListener("scroll",t.update,Yt)}),f&&m.removeEventListener("resize",t.update,Yt)}}const Ro={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:af,data:{}};var rf={left:"right",right:"left",bottom:"top",top:"bottom"};function ss(n){return n.replace(/left|right|bottom|top/g,function(e){return rf[e]})}var lf={start:"end",end:"start"};function On(n){return n.replace(/start|end/g,function(e){return lf[e]})}function en(n){var e=De(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function tn(n){return xt(ot(n)).left+en(n).scrollLeft}function cf(n,e){var t=De(n),o=ot(n),i=t.visualViewport,r=o.clientWidth,c=o.clientHeight,f=0,m=0;if(i){r=i.width,c=i.height;var p=Oo();(p||!p&&e==="fixed")&&(f=i.offsetLeft,m=i.offsetTop)}return{width:r,height:c,x:f+tn(n),y:m}}function uf(n){var e,t=ot(n),o=en(n),i=(e=n.ownerDocument)==null?void 0:e.body,r=ut(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=ut(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),f=-o.scrollLeft+tn(n),m=-o.scrollTop;return Ye(i||t).direction==="rtl"&&(f+=ut(t.clientWidth,i?i.clientWidth:0)-r),{width:r,height:c,x:f,y:m}}function sn(n){var e=Ye(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Wo(n){return["html","body","#document"].indexOf(Ue(n))>=0?n.ownerDocument.body:Ne(n)&&sn(n)?n:Wo(ds(n))}function Bt(n,e){var t;e===void 0&&(e=[]);var o=Wo(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),r=De(o),c=i?[r].concat(r.visualViewport||[],sn(o)?o:[]):o,f=e.concat(c);return i?f:f.concat(Bt(ds(c)))}function Us(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function df(n,e){var t=xt(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Dn(n,e,t){return e===Ys?Us(cf(n,t)):pt(e)?df(e,t):Us(uf(ot(n)))}function mf(n){var e=Bt(ds(n)),t=["absolute","fixed"].indexOf(Ye(n).position)>=0,o=t&&Ne(n)?Vt(n):n;return pt(o)?e.filter(function(i){return pt(i)&&Do(i,o)&&Ue(i)!=="body"}):[]}function pf(n,e,t,o){var i=e==="clippingParents"?mf(n):[].concat(e),r=[].concat(i,[t]),c=r[0],f=r.reduce(function(m,p){var u=Dn(n,p,o);return m.top=ut(u.top,m.top),m.right=is(u.right,m.right),m.bottom=is(u.bottom,m.bottom),m.left=ut(u.left,m.left),m},Dn(n,c,o));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function Bo(n){var e=n.reference,t=n.element,o=n.placement,i=o?He(o):null,r=o?At(o):null,c=e.x+e.width/2-t.width/2,f=e.y+e.height/2-t.height/2,m;switch(i){case ke:m={x:c,y:e.y-t.height};break;case Me:m={x:c,y:e.y+e.height};break;case Oe:m={x:e.x+e.width,y:f};break;case Se:m={x:e.x-t.width,y:f};break;default:m={x:e.x,y:e.y}}var p=i?Zs(i):null;if(p!=null){var u=p==="y"?"height":"width";switch(r){case mt:m[p]=m[p]-(e[u]/2-t[u]/2);break;case Ct:m[p]=m[p]+(e[u]/2-t[u]/2);break}}return m}function Mt(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,r=t.strategy,c=r===void 0?n.strategy:r,f=t.boundary,m=f===void 0?go:f,p=t.rootBoundary,u=p===void 0?Ys:p,w=t.elementContext,g=w===void 0?bt:w,k=t.altBoundary,$=k===void 0?!1:k,b=t.padding,d=b===void 0?0:b,_=Lo(typeof d!="number"?d:Io(d,Nt)),v=g===bt?bo:bt,T=n.rects.popper,E=n.elements[$?v:g],R=pf(pt(E)?E:E.contextElement||ot(n.elements.popper),m,u,c),I=xt(n.elements.reference),O=Bo({reference:I,element:T,placement:i}),H=Us(Object.assign({},T,O)),x=g===bt?H:I,A={top:R.top-x.top+_.top,bottom:x.bottom-R.bottom+_.bottom,left:R.left-x.left+_.left,right:x.right-R.right+_.right},W=n.modifiersData.offset;if(g===bt&&W){var K=W[i];Object.keys(A).forEach(function(L){var B=[Oe,Me].indexOf(L)>=0?1:-1,q=[ke,Me].indexOf(L)>=0?"y":"x";A[L]+=K[q]*B})}return A}function ff(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,r=t.rootBoundary,c=t.padding,f=t.flipVariations,m=t.allowedAutoPlacements,p=m===void 0?Js:m,u=At(o),w=u?f?Hs:Hs.filter(function($){return At($)===u}):Nt,g=w.filter(function($){return p.indexOf($)>=0});g.length===0&&(g=w);var k=g.reduce(function($,b){return $[b]=Mt(n,{placement:b,boundary:i,rootBoundary:r,padding:c})[He(b)],$},{});return Object.keys(k).sort(function($,b){return k[$]-k[b]})}function vf(n){if(He(n)===us)return[];var e=ss(n);return[On(n),e,On(e)]}function hf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,r=i===void 0?!0:i,c=t.altAxis,f=c===void 0?!0:c,m=t.fallbackPlacements,p=t.padding,u=t.boundary,w=t.rootBoundary,g=t.altBoundary,k=t.flipVariations,$=k===void 0?!0:k,b=t.allowedAutoPlacements,d=e.options.placement,_=He(d),v=_===d,T=m||(v||!$?[ss(d)]:vf(d)),E=[d].concat(T).reduce(function(Q,se){return Q.concat(He(se)===us?ff(e,{placement:se,boundary:u,rootBoundary:w,padding:p,flipVariations:$,allowedAutoPlacements:b}):se)},[]),R=e.rects.reference,I=e.rects.popper,O=new Map,H=!0,x=E[0],A=0;A<E.length;A++){var W=E[A],K=He(W),L=At(W)===mt,B=[ke,Me].indexOf(K)>=0,q=B?"width":"height",Z=Mt(e,{placement:W,boundary:u,rootBoundary:w,altBoundary:g,padding:p}),D=B?L?Oe:Se:L?Me:ke;R[q]>I[q]&&(D=ss(D));var N=ss(D),S=[];if(r&&S.push(Z[K]<=0),f&&S.push(Z[D]<=0,Z[N]<=0),S.every(function(Q){return Q})){x=W,H=!1;break}O.set(W,S)}if(H)for(var C=$?3:1,F=function(se){var X=E.find(function(V){var j=O.get(V);if(j)return j.slice(0,se).every(function(U){return U})});if(X)return x=X,"break"},J=C;J>0;J--){var z=F(J);if(z==="break")break}e.placement!==x&&(e.modifiersData[o]._skip=!0,e.placement=x,e.reset=!0)}}const Fo={name:"flip",enabled:!0,phase:"main",fn:hf,requiresIfExists:["offset"],data:{_skip:!1}};function Nn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Ln(n){return[ke,Oe,Me,Se].some(function(e){return n[e]>=0})}function _f(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,r=e.modifiersData.preventOverflow,c=Mt(e,{elementContext:"reference"}),f=Mt(e,{altBoundary:!0}),m=Nn(c,o),p=Nn(f,i,r),u=Ln(m),w=Ln(p);e.modifiersData[t]={referenceClippingOffsets:m,popperEscapeOffsets:p,isReferenceHidden:u,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":w})}const Ho={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:_f};function gf(n,e,t){var o=He(n),i=[Se,ke].indexOf(o)>=0?-1:1,r=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,c=r[0],f=r[1];return c=c||0,f=(f||0)*i,[Se,Oe].indexOf(o)>=0?{x:f,y:c}:{x:c,y:f}}function bf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,r=i===void 0?[0,0]:i,c=Js.reduce(function(u,w){return u[w]=gf(w,e.rects,r),u},{}),f=c[e.placement],m=f.x,p=f.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=c}const Vo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:bf};function yf(n){var e=n.state,t=n.name;e.modifiersData[t]=Bo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Uo={name:"popperOffsets",enabled:!0,phase:"read",fn:yf,data:{}};function wf(n){return n==="x"?"y":"x"}function $f(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,r=i===void 0?!0:i,c=t.altAxis,f=c===void 0?!1:c,m=t.boundary,p=t.rootBoundary,u=t.altBoundary,w=t.padding,g=t.tether,k=g===void 0?!0:g,$=t.tetherOffset,b=$===void 0?0:$,d=Mt(e,{boundary:m,rootBoundary:p,padding:w,altBoundary:u}),_=He(e.placement),v=At(e.placement),T=!v,E=Zs(_),R=wf(E),I=e.modifiersData.popperOffsets,O=e.rects.reference,H=e.rects.popper,x=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,A=typeof x=="number"?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),W=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,K={x:0,y:0};if(I){if(r){var L,B=E==="y"?ke:Se,q=E==="y"?Me:Oe,Z=E==="y"?"height":"width",D=I[E],N=D+d[B],S=D-d[q],C=k?-H[Z]/2:0,F=v===mt?O[Z]:H[Z],J=v===mt?-H[Z]:-O[Z],z=e.elements.arrow,Q=k&&z?Xs(z):{width:0,height:0},se=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:No(),X=se[B],V=se[q],j=Wt(0,O[Z],Q[Z]),U=T?O[Z]/2-C-j-X-A.mainAxis:F-j-X-A.mainAxis,ee=T?-O[Z]/2+C+j+V+A.mainAxis:J+j+V+A.mainAxis,oe=e.elements.arrow&&Vt(e.elements.arrow),he=oe?E==="y"?oe.clientTop||0:oe.clientLeft||0:0,rt=(L=W?.[E])!=null?L:0,Fe=D+U-rt-he,G=D+ee-rt,le=Wt(k?is(N,Fe):N,D,k?ut(S,G):S);I[E]=le,K[E]=le-D}if(f){var ue,Te=E==="x"?ke:Se,Re=E==="x"?Me:Oe,we=I[R],Gt=R==="y"?"height":"width",dn=we+d[Te],mn=we-d[Re],gs=[ke,Se].indexOf(_)!==-1,pn=(ue=W?.[R])!=null?ue:0,fn=gs?dn:we-O[Gt]-H[Gt]-pn+A.altAxis,vn=gs?we+O[Gt]+H[Gt]-pn-A.altAxis:mn,hn=k&&gs?Xp(fn,we,vn):Wt(k?fn:dn,we,k?vn:mn);I[R]=hn,K[R]=hn-we}e.modifiersData[o]=K}}const qo={name:"preventOverflow",enabled:!0,phase:"main",fn:$f,requiresIfExists:["offset"]};function kf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Sf(n){return n===De(n)||!Ne(n)?en(n):kf(n)}function Ef(n){var e=n.getBoundingClientRect(),t=Tt(e.width)/n.offsetWidth||1,o=Tt(e.height)/n.offsetHeight||1;return t!==1||o!==1}function Cf(n,e,t){t===void 0&&(t=!1);var o=Ne(e),i=Ne(e)&&Ef(e),r=ot(e),c=xt(n,i,t),f={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!t)&&((Ue(e)!=="body"||sn(r))&&(f=Sf(e)),Ne(e)?(m=xt(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):r&&(m.x=tn(r))),{x:c.left+f.scrollLeft-m.x,y:c.top+f.scrollTop-m.y,width:c.width,height:c.height}}function Tf(n){var e=new Map,t=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function i(r){t.add(r.name);var c=[].concat(r.requires||[],r.requiresIfExists||[]);c.forEach(function(f){if(!t.has(f)){var m=e.get(f);m&&i(m)}}),o.push(r)}return n.forEach(function(r){t.has(r.name)||i(r)}),o}function xf(n){var e=Tf(n);return Ao.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Af(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Mf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var In={placement:"bottom",modifiers:[],strategy:"absolute"};function jn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function zo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,r=i===void 0?In:i;return function(f,m,p){p===void 0&&(p=r);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},In,r),modifiersData:{},elements:{reference:f,popper:m},attributes:{},styles:{}},w=[],g=!1,k={state:u,setOptions:function(_){var v=typeof _=="function"?_(u.options):_;b(),u.options=Object.assign({},r,u.options,v),u.scrollParents={reference:pt(f)?Bt(f):f.contextElement?Bt(f.contextElement):[],popper:Bt(m)};var T=xf(Mf([].concat(o,u.options.modifiers)));return u.orderedModifiers=T.filter(function(E){return E.enabled}),$(),k.update()},forceUpdate:function(){if(!g){var _=u.elements,v=_.reference,T=_.popper;if(jn(v,T)){u.rects={reference:Cf(v,Vt(T),u.options.strategy==="fixed"),popper:Xs(T)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(A){return u.modifiersData[A.name]=Object.assign({},A.data)});for(var E=0;E<u.orderedModifiers.length;E++){if(u.reset===!0){u.reset=!1,E=-1;continue}var R=u.orderedModifiers[E],I=R.fn,O=R.options,H=O===void 0?{}:O,x=R.name;typeof I=="function"&&(u=I({state:u,options:H,name:x,instance:k})||u)}}}},update:Af(function(){return new Promise(function(d){k.forceUpdate(),d(u)})}),destroy:function(){b(),g=!0}};if(!jn(f,m))return k;k.setOptions(p).then(function(d){!g&&p.onFirstUpdate&&p.onFirstUpdate(d)});function $(){u.orderedModifiers.forEach(function(d){var _=d.name,v=d.options,T=v===void 0?{}:v,E=d.effect;if(typeof E=="function"){var R=E({state:u,name:_,instance:k,options:T}),I=function(){};w.push(R||I)}})}function b(){w.forEach(function(d){return d()}),w=[]}return k}}var Of=[Ro,Uo,Po,Mo,Vo,Fo,qo,jo,Ho],nn=zo({defaultModifiers:Of});const Ko=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Eo,afterRead:$o,afterWrite:xo,applyStyles:Mo,arrow:jo,auto:us,basePlacements:Nt,beforeMain:ko,beforeRead:yo,beforeWrite:Co,bottom:Me,clippingParents:go,computeStyles:Po,createPopper:nn,detectOverflow:Mt,end:Ct,eventListeners:Ro,flip:Fo,hide:Ho,left:Se,main:So,modifierPhases:Ao,offset:Vo,placements:Js,popper:bt,popperGenerator:zo,popperOffsets:Uo,preventOverflow:qo,read:wo,reference:bo,right:Oe,start:mt,top:ke,variationPlacements:Hs,viewport:Ys,write:To},Symbol.toStringTag,{value:"Module"}));const Qe=new Map,Cs={set(n,e,t){Qe.has(n)||Qe.set(n,new Map);const o=Qe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Qe.has(n)&&Qe.get(n).get(e)||null},remove(n,e){if(!Qe.has(n))return;const t=Qe.get(n);t.delete(e),t.size===0&&Qe.delete(n)}},Df=1e6,Nf=1e3,qs="transitionend",Go=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Lf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),If=n=>{do n+=Math.floor(Math.random()*Df);while(document.getElementById(n));return n},jf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Nf)},Yo=n=>{n.dispatchEvent(new Event(qs))},Ke=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Ze=n=>Ke(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Go(n)):null,Lt=n=>{if(!Ke(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},et=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Jo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Jo(n.parentNode):null},as=()=>{},Ut=n=>{n.offsetHeight},Qo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ts=[],Pf=n=>{document.readyState==="loading"?(Ts.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ts)e()}),Ts.push(n)):n()},Le=()=>document.documentElement.dir==="rtl",Pe=n=>{Pf(()=>{const e=Qo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},Ce=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Xo=(n,e,t=!0)=>{if(!t){Ce(n);return}const i=jf(e)+5;let r=!1;const c=({target:f})=>{f===e&&(r=!0,e.removeEventListener(qs,c),Ce(n))};e.addEventListener(qs,c),setTimeout(()=>{r||Yo(e)},i)},on=(n,e,t,o)=>{const i=n.length;let r=n.indexOf(e);return r===-1?!t&&o?n[i-1]:n[0]:(r+=t?1:-1,o&&(r=(r+i)%i),n[Math.max(0,Math.min(r,i-1))])},Rf=/[^.]*(?=\..*)\.|.*/,Wf=/\..*/,Bf=/::\d+$/,xs={};let Pn=1;const Zo={mouseenter:"mouseover",mouseleave:"mouseout"},Ff=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ei(n,e){return e&&`${e}::${Pn++}`||n.uidEvent||Pn++}function ti(n){const e=ei(n);return n.uidEvent=e,xs[e]=xs[e]||{},xs[e]}function Hf(n,e){return function t(o){return an(o,{delegateTarget:n}),t.oneOff&&Y.off(n,o.type,e),e.apply(n,[o])}}function Vf(n,e,t){return function o(i){const r=n.querySelectorAll(e);for(let{target:c}=i;c&&c!==this;c=c.parentNode)for(const f of r)if(f===c)return an(i,{delegateTarget:c}),o.oneOff&&Y.off(n,i.type,e,t),t.apply(c,[i])}}function si(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function ni(n,e,t){const o=typeof e=="string",i=o?t:e||t;let r=oi(n);return Ff.has(r)||(r=n),[o,i,r]}function Rn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[r,c,f]=ni(e,t,o);e in Zo&&(c=($=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return $.call(this,b)})(c));const m=ti(n),p=m[f]||(m[f]={}),u=si(p,c,r?t:null);if(u){u.oneOff=u.oneOff&&i;return}const w=ei(c,e.replace(Rf,"")),g=r?Vf(n,t,c):Hf(n,c);g.delegationSelector=r?t:null,g.callable=c,g.oneOff=i,g.uidEvent=w,p[w]=g,n.addEventListener(f,g,r)}function zs(n,e,t,o,i){const r=si(e[t],o,i);r&&(n.removeEventListener(t,r,!!i),delete e[t][r.uidEvent])}function Uf(n,e,t,o){const i=e[t]||{};for(const[r,c]of Object.entries(i))r.includes(o)&&zs(n,e,t,c.callable,c.delegationSelector)}function oi(n){return n=n.replace(Wf,""),Zo[n]||n}const Y={on(n,e,t,o){Rn(n,e,t,o,!1)},one(n,e,t,o){Rn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,r,c]=ni(e,t,o),f=c!==e,m=ti(n),p=m[c]||{},u=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(p).length)return;zs(n,m,c,r,i?t:null);return}if(u)for(const w of Object.keys(m))Uf(n,m,w,e.slice(1));for(const[w,g]of Object.entries(p)){const k=w.replace(Bf,"");(!f||e.includes(k))&&zs(n,m,c,g.callable,g.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Qo(),i=oi(e),r=e!==i;let c=null,f=!0,m=!0,p=!1;r&&o&&(c=o.Event(e,t),o(n).trigger(c),f=!c.isPropagationStopped(),m=!c.isImmediatePropagationStopped(),p=c.isDefaultPrevented());const u=an(new Event(e,{bubbles:f,cancelable:!0}),t);return p&&u.preventDefault(),m&&n.dispatchEvent(u),u.defaultPrevented&&c&&c.preventDefault(),u}};function an(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function Wn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function As(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ge={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${As(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${As(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Wn(n.dataset[o])}return e},getDataAttribute(n,e){return Wn(n.getAttribute(`data-bs-${As(e)}`))}};class qt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Ke(t)?Ge.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ke(t)?Ge.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const r=e[o],c=Ke(r)?"element":Lf(r);if(!new RegExp(i).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${i}".`)}}}const qf="5.3.8";class Be extends qt{constructor(e,t){super(),e=Ze(e),e&&(this._element=e,this._config=this._getConfig(t),Cs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Cs.remove(this._element,this.constructor.DATA_KEY),Y.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Xo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Cs.get(Ze(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return qf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ms=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Go(t)).join(","):null},ae={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!et(t)&&Lt(t))},getSelectorFromElement(n){const e=Ms(n);return e&&ae.findOne(e)?e:null},getElementFromSelector(n){const e=Ms(n);return e?ae.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ms(n);return e?ae.find(e):[]}},ms=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Y.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),et(this))return;const r=ae.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},zf="alert",Kf="bs.alert",ii=`.${Kf}`,Gf=`close${ii}`,Yf=`closed${ii}`,Jf="fade",Qf="show";class ps extends Be{static get NAME(){return zf}close(){if(Y.trigger(this._element,Gf).defaultPrevented)return;this._element.classList.remove(Qf);const t=this._element.classList.contains(Jf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),Y.trigger(this._element,Yf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(ps,"close");Pe(ps);const Xf="button",Zf="bs.button",ev=`.${Zf}`,tv=".data-api",sv="active",Bn='[data-bs-toggle="button"]',nv=`click${ev}${tv}`;class fs extends Be{static get NAME(){return Xf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(sv))}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}Y.on(document,nv,Bn,n=>{n.preventDefault();const e=n.target.closest(Bn);fs.getOrCreateInstance(e).toggle()});Pe(fs);const ov="swipe",It=".bs.swipe",iv=`touchstart${It}`,av=`touchmove${It}`,rv=`touchend${It}`,lv=`pointerdown${It}`,cv=`pointerup${It}`,uv="touch",dv="pen",mv="pointer-event",pv=40,fv={endCallback:null,leftCallback:null,rightCallback:null},vv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class rs extends qt{constructor(e,t){super(),this._element=e,!(!e||!rs.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return fv}static get DefaultType(){return vv}static get NAME(){return ov}dispose(){Y.off(this._element,It)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ce(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=pv)return;const t=e/this._deltaX;this._deltaX=0,t&&Ce(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Y.on(this._element,lv,e=>this._start(e)),Y.on(this._element,cv,e=>this._end(e)),this._element.classList.add(mv)):(Y.on(this._element,iv,e=>this._start(e)),Y.on(this._element,av,e=>this._move(e)),Y.on(this._element,rv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===dv||e.pointerType===uv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const hv="carousel",_v="bs.carousel",it=`.${_v}`,ai=".data-api",gv="ArrowLeft",bv="ArrowRight",yv=500,Pt="next",_t="prev",yt="left",ns="right",wv=`slide${it}`,Os=`slid${it}`,$v=`keydown${it}`,kv=`mouseenter${it}`,Sv=`mouseleave${it}`,Ev=`dragstart${it}`,Cv=`load${it}${ai}`,Tv=`click${it}${ai}`,ri="carousel",Jt="active",xv="slide",Av="carousel-item-end",Mv="carousel-item-start",Ov="carousel-item-next",Dv="carousel-item-prev",li=".active",ci=".carousel-item",Nv=li+ci,Lv=".carousel-item img",Iv=".carousel-indicators",jv="[data-bs-slide], [data-bs-slide-to]",Pv='[data-bs-ride="carousel"]',Rv={[gv]:ns,[bv]:yt},Wv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Bv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class zt extends Be{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ae.findOne(Iv,this._element),this._addEventListeners(),this._config.ride===ri&&this.cycle()}static get Default(){return Wv}static get DefaultType(){return Bv}static get NAME(){return hv}next(){this._slide(Pt)}nextWhenVisible(){!document.hidden&&Lt(this._element)&&this.next()}prev(){this._slide(_t)}pause(){this._isSliding&&Yo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Y.one(this._element,Os,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){Y.one(this._element,Os,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Pt:_t;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Y.on(this._element,$v,e=>this._keydown(e)),this._config.pause==="hover"&&(Y.on(this._element,kv,()=>this.pause()),Y.on(this._element,Sv,()=>this._maybeEnableCycle())),this._config.touch&&rs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ae.find(Lv,this._element))Y.on(o,Ev,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(yt)),rightCallback:()=>this._slide(this._directionToOrder(ns)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),yv+this._config.interval))}};this._swipeHelper=new rs(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Rv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=ae.findOne(li,this._indicatorsElement);t.classList.remove(Jt),t.removeAttribute("aria-current");const o=ae.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Jt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===Pt,r=t||on(this._getItems(),o,i,this._config.wrap);if(r===o)return;const c=this._getItemIndex(r),f=k=>Y.trigger(this._element,k,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(f(wv).defaultPrevented||!o||!r)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=r;const u=i?Mv:Av,w=i?Ov:Dv;r.classList.add(w),Ut(r),o.classList.add(u),r.classList.add(u);const g=()=>{r.classList.remove(u,w),r.classList.add(Jt),o.classList.remove(Jt,w,u),this._isSliding=!1,f(Os)};this._queueCallback(g,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(xv)}_getActive(){return ae.findOne(Nv,this._element)}_getItems(){return ae.find(ci,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Le()?e===yt?_t:Pt:e===yt?Pt:_t}_orderToDirection(e){return Le()?e===_t?yt:ns:e===_t?ns:yt}static jQueryInterface(e){return this.each(function(){const t=zt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(document,Tv,jv,function(n){const e=ae.getElementFromSelector(this);if(!e||!e.classList.contains(ri))return;n.preventDefault();const t=zt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Ge.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});Y.on(window,Cv,()=>{const n=ae.find(Pv);for(const e of n)zt.getOrCreateInstance(e)});Pe(zt);const Fv="collapse",Hv="bs.collapse",Kt=`.${Hv}`,Vv=".data-api",Uv=`show${Kt}`,qv=`shown${Kt}`,zv=`hide${Kt}`,Kv=`hidden${Kt}`,Gv=`click${Kt}${Vv}`,Ds="show",$t="collapse",Qt="collapsing",Yv="collapsed",Jv=`:scope .${$t} .${$t}`,Qv="collapse-horizontal",Xv="width",Zv="height",eh=".collapse.show, .collapse.collapsing",Ks='[data-bs-toggle="collapse"]',th={parent:null,toggle:!0},sh={parent:"(null|element)",toggle:"boolean"};class Ot extends Be{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=ae.find(Ks);for(const i of o){const r=ae.getSelectorFromElement(i),c=ae.find(r).filter(f=>f===this._element);r!==null&&c.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return th}static get DefaultType(){return sh}static get NAME(){return Fv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(eh).filter(f=>f!==this._element).map(f=>Ot.getOrCreateInstance(f,{toggle:!1}))),e.length&&e[0]._isTransitioning||Y.trigger(this._element,Uv).defaultPrevented)return;for(const f of e)f.hide();const o=this._getDimension();this._element.classList.remove($t),this._element.classList.add(Qt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t,Ds),this._element.style[o]="",Y.trigger(this._element,qv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||Y.trigger(this._element,zv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ut(this._element),this._element.classList.add(Qt),this._element.classList.remove($t,Ds);for(const i of this._triggerArray){const r=ae.getElementFromSelector(i);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t),Y.trigger(this._element,Kv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ds)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ze(e.parent),e}_getDimension(){return this._element.classList.contains(Qv)?Xv:Zv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ks);for(const t of e){const o=ae.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=ae.find(Jv,this._config.parent);return ae.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(Yv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Ot.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Y.on(document,Gv,Ks,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ae.getMultipleElementsFromSelector(this))Ot.getOrCreateInstance(e,{toggle:!1}).toggle()});Pe(Ot);const Fn="dropdown",nh="bs.dropdown",vt=`.${nh}`,rn=".data-api",oh="Escape",Hn="Tab",ih="ArrowUp",Vn="ArrowDown",ah=2,rh=`hide${vt}`,lh=`hidden${vt}`,ch=`show${vt}`,uh=`shown${vt}`,ui=`click${vt}${rn}`,di=`keydown${vt}${rn}`,dh=`keyup${vt}${rn}`,wt="show",mh="dropup",ph="dropend",fh="dropstart",vh="dropup-center",hh="dropdown-center",lt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',_h=`${lt}.${wt}`,os=".dropdown-menu",gh=".navbar",bh=".navbar-nav",yh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",wh=Le()?"top-end":"top-start",$h=Le()?"top-start":"top-end",kh=Le()?"bottom-end":"bottom-start",Sh=Le()?"bottom-start":"bottom-end",Eh=Le()?"left-start":"right-start",Ch=Le()?"right-start":"left-start",Th="top",xh="bottom",Ah={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Mh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ve extends Be{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=ae.next(this._element,os)[0]||ae.prev(this._element,os)[0]||ae.findOne(os,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ah}static get DefaultType(){return Mh}static get NAME(){return Fn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(et(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Y.trigger(this._element,ch,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(bh))for(const o of[].concat(...document.body.children))Y.on(o,"mouseover",as);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(wt),this._element.classList.add(wt),Y.trigger(this._element,uh,e)}}hide(){if(et(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Y.trigger(this._element,rh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Y.off(o,"mouseover",as);this._popper&&this._popper.destroy(),this._menu.classList.remove(wt),this._element.classList.remove(wt),this._element.setAttribute("aria-expanded","false"),Ge.removeDataAttribute(this._menu,"popper"),Y.trigger(this._element,lh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ke(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Fn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ko>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ke(this._config.reference)?e=Ze(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=nn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(wt)}_getPlacement(){const e=this._parent;if(e.classList.contains(ph))return Eh;if(e.classList.contains(fh))return Ch;if(e.classList.contains(vh))return Th;if(e.classList.contains(hh))return xh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(mh)?t?$h:wh:t?Sh:kh}_detectNavbar(){return this._element.closest(gh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ge.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ce(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=ae.find(yh,this._menu).filter(i=>Lt(i));o.length&&on(o,t,e===Vn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ve.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===ah||e.type==="keyup"&&e.key!==Hn)return;const t=ae.find(_h);for(const o of t){const i=Ve.getInstance(o);if(!i||i._config.autoClose===!1)continue;const r=e.composedPath(),c=r.includes(i._menu);if(r.includes(i._element)||i._config.autoClose==="inside"&&!c||i._config.autoClose==="outside"&&c||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Hn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const f={relatedTarget:i._element};e.type==="click"&&(f.clickEvent=e),i._completeHide(f)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===oh,i=[ih,Vn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const r=this.matches(lt)?this:ae.prev(this,lt)[0]||ae.next(this,lt)[0]||ae.findOne(lt,e.delegateTarget.parentNode),c=Ve.getOrCreateInstance(r);if(i){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),r.focus())}}Y.on(document,di,lt,Ve.dataApiKeydownHandler);Y.on(document,di,os,Ve.dataApiKeydownHandler);Y.on(document,ui,Ve.clearMenus);Y.on(document,dh,Ve.clearMenus);Y.on(document,ui,lt,function(n){n.preventDefault(),Ve.getOrCreateInstance(this).toggle()});Pe(Ve);const mi="backdrop",Oh="fade",Un="show",qn=`mousedown.bs.${mi}`,Dh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Nh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class pi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Dh}static get DefaultType(){return Nh}static get NAME(){return mi}show(e){if(!this._config.isVisible){Ce(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Ut(t),t.classList.add(Un),this._emulateAnimation(()=>{Ce(e)})}hide(e){if(!this._config.isVisible){Ce(e);return}this._getElement().classList.remove(Un),this._emulateAnimation(()=>{this.dispose(),Ce(e)})}dispose(){this._isAppended&&(Y.off(this._element,qn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Oh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ze(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Y.on(e,qn,()=>{Ce(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Xo(e,this._getElement(),this._config.isAnimated)}}const Lh="focustrap",Ih="bs.focustrap",ls=`.${Ih}`,jh=`focusin${ls}`,Ph=`keydown.tab${ls}`,Rh="Tab",Wh="forward",zn="backward",Bh={autofocus:!0,trapElement:null},Fh={autofocus:"boolean",trapElement:"element"};class fi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Bh}static get DefaultType(){return Fh}static get NAME(){return Lh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Y.off(document,ls),Y.on(document,jh,e=>this._handleFocusin(e)),Y.on(document,Ph,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Y.off(document,ls))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=ae.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===zn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Rh&&(this._lastTabNavDirection=e.shiftKey?zn:Wh)}}const Kn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Gn=".sticky-top",Xt="padding-right",Yn="margin-right";class Gs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Xt,t=>t+e),this._setElementAttributes(Kn,Xt,t=>t+e),this._setElementAttributes(Gn,Yn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Xt),this._resetElementAttributes(Kn,Xt),this._resetElementAttributes(Gn,Yn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),r=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+i)return;this._saveInitialAttribute(c,t);const f=window.getComputedStyle(c).getPropertyValue(t);c.style.setProperty(t,`${o(Number.parseFloat(f))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Ge.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const r=Ge.getDataAttribute(i,t);if(r===null){i.style.removeProperty(t);return}Ge.removeDataAttribute(i,t),i.style.setProperty(t,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Ke(e)){t(e);return}for(const o of ae.find(e,this._element))t(o)}}const Hh="modal",Vh="bs.modal",Ie=`.${Vh}`,Uh=".data-api",qh="Escape",zh=`hide${Ie}`,Kh=`hidePrevented${Ie}`,vi=`hidden${Ie}`,hi=`show${Ie}`,Gh=`shown${Ie}`,Yh=`resize${Ie}`,Jh=`click.dismiss${Ie}`,Qh=`mousedown.dismiss${Ie}`,Xh=`keydown.dismiss${Ie}`,Zh=`click${Ie}${Uh}`,Jn="modal-open",e_="fade",Qn="show",Ns="modal-static",t_=".modal.show",s_=".modal-dialog",n_=".modal-body",o_='[data-bs-toggle="modal"]',i_={backdrop:!0,focus:!0,keyboard:!0},a_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ft extends Be{constructor(e,t){super(e,t),this._dialog=ae.findOne(s_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Gs,this._addEventListeners()}static get Default(){return i_}static get DefaultType(){return a_}static get NAME(){return Hh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Y.trigger(this._element,hi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Jn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Y.trigger(this._element,zh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Qn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Y.off(window,Ie),Y.off(this._dialog,Ie),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new pi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=ae.findOne(n_,this._dialog);t&&(t.scrollTop=0),Ut(this._element),this._element.classList.add(Qn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Y.trigger(this._element,Gh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Y.on(this._element,Xh,e=>{if(e.key===qh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Y.on(window,Yh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Y.on(this._element,Qh,e=>{Y.one(this._element,Jh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Jn),this._resetAdjustments(),this._scrollBar.reset(),Y.trigger(this._element,vi)})}_isAnimated(){return this._element.classList.contains(e_)}_triggerBackdropTransition(){if(Y.trigger(this._element,Kh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ns)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ns),this._queueCallback(()=>{this._element.classList.remove(Ns),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Le()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Le()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=ft.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}Y.on(document,Zh,o_,function(n){const e=ae.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Y.one(e,hi,i=>{i.defaultPrevented||Y.one(e,vi,()=>{Lt(this)&&this.focus()})});const t=ae.findOne(t_);t&&ft.getInstance(t).hide(),ft.getOrCreateInstance(e).toggle(this)});ms(ft);Pe(ft);const r_="offcanvas",l_="bs.offcanvas",Je=`.${l_}`,_i=".data-api",c_=`load${Je}${_i}`,u_="Escape",Xn="show",Zn="showing",eo="hiding",d_="offcanvas-backdrop",gi=".offcanvas.show",m_=`show${Je}`,p_=`shown${Je}`,f_=`hide${Je}`,to=`hidePrevented${Je}`,bi=`hidden${Je}`,v_=`resize${Je}`,h_=`click${Je}${_i}`,__=`keydown.dismiss${Je}`,g_='[data-bs-toggle="offcanvas"]',b_={backdrop:!0,keyboard:!0,scroll:!1},y_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class tt extends Be{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return b_}static get DefaultType(){return y_}static get NAME(){return r_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Y.trigger(this._element,m_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Gs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Xn),this._element.classList.remove(Zn),Y.trigger(this._element,p_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Y.trigger(this._element,f_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(eo),this._backdrop.hide();const t=()=>{this._element.classList.remove(Xn,eo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Gs().reset(),Y.trigger(this._element,bi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Y.trigger(this._element,to);return}this.hide()},t=!!this._config.backdrop;return new pi({className:d_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_addEventListeners(){Y.on(this._element,__,e=>{if(e.key===u_){if(this._config.keyboard){this.hide();return}Y.trigger(this._element,to)}})}static jQueryInterface(e){return this.each(function(){const t=tt.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}Y.on(document,h_,g_,function(n){const e=ae.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),et(this))return;Y.one(e,bi,()=>{Lt(this)&&this.focus()});const t=ae.findOne(gi);t&&t!==e&&tt.getInstance(t).hide(),tt.getOrCreateInstance(e).toggle(this)});Y.on(window,c_,()=>{for(const n of ae.find(gi))tt.getOrCreateInstance(n).show()});Y.on(window,v_,()=>{for(const n of ae.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&tt.getOrCreateInstance(n).hide()});ms(tt);Pe(tt);const w_=/^aria-[\w-]*$/i,yi={"*":["class","dir","id","lang","role",w_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},$_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),k_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,S_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?$_.has(t)?!!k_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function E_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const c of r){const f=c.nodeName.toLowerCase();if(!Object.keys(e).includes(f)){c.remove();continue}const m=[].concat(...c.attributes),p=[].concat(e["*"]||[],e[f]||[]);for(const u of m)S_(u,p)||c.removeAttribute(u.nodeName)}return i.body.innerHTML}const C_="TemplateFactory",T_={allowList:yi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},x_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},A_={entry:"(string|element|function|null)",selector:"(string|element)"};class M_ extends qt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return T_}static get DefaultType(){return x_}static get NAME(){return C_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,r]of Object.entries(this._config.content))this._setContent(e,r,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},A_)}_setContent(e,t,o){const i=ae.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Ke(t)){this._putElementInTemplate(Ze(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?E_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ce(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const O_="tooltip",D_=new Set(["sanitize","allowList","sanitizeFn"]),Ls="fade",N_="modal",Zt="show",L_=".tooltip-inner",so=`.${N_}`,no="hide.bs.modal",Rt="hover",Is="focus",js="click",I_="manual",j_="hide",P_="hidden",R_="show",W_="shown",B_="inserted",F_="click",H_="focusin",V_="focusout",U_="mouseenter",q_="mouseleave",z_={AUTO:"auto",TOP:"top",RIGHT:Le()?"left":"right",BOTTOM:"bottom",LEFT:Le()?"right":"left"},K_={allowList:yi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},G_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class jt extends Be{constructor(e,t){if(typeof Ko>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return K_}static get DefaultType(){return G_}static get NAME(){return O_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Y.off(this._element.closest(so),no,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Y.trigger(this._element,this.constructor.eventName(R_)),o=(Jo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(i),Y.trigger(this._element,this.constructor.eventName(B_))),this._popper=this._createPopper(i),i.classList.add(Zt),"ontouchstart"in document.documentElement)for(const f of[].concat(...document.body.children))Y.on(f,"mouseover",as);const c=()=>{Y.trigger(this._element,this.constructor.eventName(W_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Y.trigger(this._element,this.constructor.eventName(j_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Zt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Y.off(i,"mouseover",as);this._activeTrigger[js]=!1,this._activeTrigger[Is]=!1,this._activeTrigger[Rt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Y.trigger(this._element,this.constructor.eventName(P_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ls,Zt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=If(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ls),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new M_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[L_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ls)}_isShown(){return this.tip&&this.tip.classList.contains(Zt)}_createPopper(e){const t=Ce(this._config.placement,[this,e,this._element]),o=z_[t.toUpperCase()];return nn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Ce(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Ce(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")Y.on(this._element,this.constructor.eventName(F_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[js]=!(i._isShown()&&i._activeTrigger[js]),i.toggle()});else if(t!==I_){const o=t===Rt?this.constructor.eventName(U_):this.constructor.eventName(H_),i=t===Rt?this.constructor.eventName(q_):this.constructor.eventName(V_);Y.on(this._element,o,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusin"?Is:Rt]=!0,c._enter()}),Y.on(this._element,i,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusout"?Is:Rt]=c._element.contains(r.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Y.on(this._element.closest(so),no,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Ge.getDataAttributes(this._element);for(const o of Object.keys(t))D_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ze(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=jt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Pe(jt);const Y_="popover",J_=".popover-header",Q_=".popover-body",X_={...jt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Z_={...jt.DefaultType,content:"(null|string|element|function)"};class ln extends jt{static get Default(){return X_}static get DefaultType(){return Z_}static get NAME(){return Y_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[J_]:this._getTitle(),[Q_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=ln.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Pe(ln);const eg="scrollspy",tg="bs.scrollspy",cn=`.${tg}`,sg=".data-api",ng=`activate${cn}`,oo=`click${cn}`,og=`load${cn}${sg}`,ig="dropdown-item",gt="active",ag='[data-bs-spy="scroll"]',Ps="[href]",rg=".nav, .list-group",io=".nav-link",lg=".nav-item",cg=".list-group-item",ug=`${io}, ${lg} > ${io}, ${cg}`,dg=".dropdown",mg=".dropdown-toggle",pg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},fg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class vs extends Be{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return pg}static get DefaultType(){return fg}static get NAME(){return eg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ze(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Y.off(this._config.target,oo),Y.on(this._config.target,oo,Ps,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(t(c))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(c));continue}const f=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&f){if(o(c),!i)return;continue}!r&&!f&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ae.find(Ps,this._config.target);for(const t of e){if(!t.hash||et(t))continue;const o=ae.findOne(decodeURI(t.hash),this._element);Lt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(gt),this._activateParents(e),Y.trigger(this._element,ng,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(ig)){ae.findOne(mg,e.closest(dg)).classList.add(gt);return}for(const t of ae.parents(e,rg))for(const o of ae.prev(t,ug))o.classList.add(gt)}_clearActiveClass(e){e.classList.remove(gt);const t=ae.find(`${Ps}.${gt}`,e);for(const o of t)o.classList.remove(gt)}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(window,og,()=>{for(const n of ae.find(ag))vs.getOrCreateInstance(n)});Pe(vs);const vg="tab",hg="bs.tab",ht=`.${hg}`,_g=`hide${ht}`,gg=`hidden${ht}`,bg=`show${ht}`,yg=`shown${ht}`,wg=`click${ht}`,$g=`keydown${ht}`,kg=`load${ht}`,Sg="ArrowLeft",ao="ArrowRight",Eg="ArrowUp",ro="ArrowDown",Rs="Home",lo="End",ct="active",co="fade",Ws="show",Cg="dropdown",wi=".dropdown-toggle",Tg=".dropdown-menu",Bs=`:not(${wi})`,xg='.list-group, .nav, [role="tablist"]',Ag=".nav-item, .list-group-item",Mg=`.nav-link${Bs}, .list-group-item${Bs}, [role="tab"]${Bs}`,$i='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Fs=`${Mg}, ${$i}`,Og=`.${ct}[data-bs-toggle="tab"], .${ct}[data-bs-toggle="pill"], .${ct}[data-bs-toggle="list"]`;class Dt extends Be{constructor(e){super(e),this._parent=this._element.closest(xg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Y.on(this._element,$g,t=>this._keydown(t)))}static get NAME(){return vg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?Y.trigger(t,_g,{relatedTarget:e}):null;Y.trigger(e,bg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(ct),this._activate(ae.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ws);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Y.trigger(e,yg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_deactivate(e,t){if(!e)return;e.classList.remove(ct),e.blur(),this._deactivate(ae.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ws);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Y.trigger(e,gg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_keydown(e){if(![Sg,ao,Eg,ro,Rs,lo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!et(i));let o;if([Rs,lo].includes(e.key))o=t[e.key===Rs?0:t.length-1];else{const i=[ao,ro].includes(e.key);o=on(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Dt.getOrCreateInstance(o).show())}_getChildren(){return ae.find(Fs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=ae.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(Cg))return;const i=(r,c)=>{const f=ae.findOne(r,o);f&&f.classList.toggle(c,t)};i(wi,ct),i(Tg,Ws),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(ct)}_getInnerElement(e){return e.matches(Fs)?e:ae.findOne(Fs,e)}_getOuterElement(e){return e.closest(Ag)||e}static jQueryInterface(e){return this.each(function(){const t=Dt.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(document,wg,$i,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!et(this)&&Dt.getOrCreateInstance(this).show()});Y.on(window,kg,()=>{for(const n of ae.find(Og))Dt.getOrCreateInstance(n)});Pe(Dt);const Dg="toast",Ng="bs.toast",at=`.${Ng}`,Lg=`mouseover${at}`,Ig=`mouseout${at}`,jg=`focusin${at}`,Pg=`focusout${at}`,Rg=`hide${at}`,Wg=`hidden${at}`,Bg=`show${at}`,Fg=`shown${at}`,Hg="fade",uo="hide",es="show",ts="showing",Vg={animation:"boolean",autohide:"boolean",delay:"number"},Ug={animation:!0,autohide:!0,delay:5e3};class hs extends Be{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Ug}static get DefaultType(){return Vg}static get NAME(){return Dg}show(){if(Y.trigger(this._element,Bg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Hg);const t=()=>{this._element.classList.remove(ts),Y.trigger(this._element,Fg),this._maybeScheduleHide()};this._element.classList.remove(uo),Ut(this._element),this._element.classList.add(es,ts),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||Y.trigger(this._element,Rg).defaultPrevented)return;const t=()=>{this._element.classList.add(uo),this._element.classList.remove(ts,es),Y.trigger(this._element,Wg)};this._element.classList.add(ts),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(es),super.dispose()}isShown(){return this._element.classList.contains(es)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Y.on(this._element,Lg,e=>this._onInteraction(e,!0)),Y.on(this._element,Ig,e=>this._onInteraction(e,!1)),Y.on(this._element,jg,e=>this._onInteraction(e,!0)),Y.on(this._element,Pg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=hs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(hs);Pe(hs);const qg={class:"message-content-column"},zg=["id"],Kg={class:"accordion-item"},Gg=["id"],Yg=["aria-controls"],Jg={class:"d-flex align-items-center w-100"},Qg={class:"badge bg-warning text-dark ms-auto me-2"},Xg={class:"text-muted"},Zg=["id","aria-labelledby"],eb={class:"accordion-body bg-light"},tb={class:"alert alert-warning mb-3",role:"alert"},sb={class:"compaction-metadata"},nb={class:"metadata-row"},ob={class:"metadata-row"},ib={key:0,class:"metadata-row"},ab={class:"continuation-content"},rb={class:"continuation-text border rounded p-3 bg-white"},lb={class:"mb-0"},cb={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=h(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=h(()=>`heading-${t.value}`),i=h(()=>`collapse-${t.value}`),r=P(null);let c=null;ye(()=>{r.value&&(c=new Ot(r.value,{toggle:!1}))}),Si(()=>{c&&c.dispose()});function f(){c&&c.toggle()}const m=h(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),p=h(()=>m.value?e.messages[3]:e.messages[2]),u=h(()=>p.value?.metadata?.init_data?.compact_metadata||{}),w=h(()=>u.value.pre_tokens||0),g=h(()=>m.value?e.messages[4]:e.messages[3]),k=h(()=>g.value?.content||""),$=h(()=>{const d=e.messages[0]?.timestamp;return d?Ht(d):""});function b(d){return d?`${d.toLocaleString()} tokens`:"0 tokens"}return(d,_)=>(a(),l("div",{class:"message-row message-row-compaction",key:t.value},[_[7]||(_[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",qg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Kg,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:f},[s("div",Jg,[_[0]||(_[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),_[1]||(_[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",Qg,y(b(w.value)),1),s("small",Xg,y($.value),1)])],8,Yg)],8,Gg),s("div",{ref_key:"collapseElement",ref:r,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",eb,[s("div",tb,[_[5]||(_[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ie(" Compaction Details ")],-1)),s("div",sb,[s("div",nb,[_[2]||(_[2]=s("strong",null,"Trigger:",-1)),s("span",null,y(u.value.trigger||"auto"),1)]),s("div",ob,[_[3]||(_[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,y(b(w.value)),1)]),u.value.post_tokens?(a(),l("div",ib,[_[4]||(_[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,y(b(u.value.post_tokens)),1)])):M("",!0)])]),s("div",ab,[_[6]||(_[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ie(" Continuation Message ")],-1)),s("div",rb,[s("pre",lb,y(k.value),1)])])])],8,Zg)])],8,zg)])]))}},ub=ne(cb,[["__scopeId","data-v-e0b95ba8"]]),db={key:0,class:"text-muted text-center py-5"},mb={__name:"MessageList",setup(n){const e=Ae(),t=_e(),o=P(null),i=h(()=>{const u=e.currentMessages,w=[];let g=0;for(;g<u.length;){const k=u[g];if(c(k,u,g)){const $=u[g+2],d=$?.type==="system"&&$?.metadata?.subtype==="init"?5:4,_=u.slice(g,g+d);w.push({type:"compaction",messages:_}),g+=d;continue}m(k)&&w.push({type:"message",message:k,attachedTools:[]}),g++}return r(w)});function r(u){const w=new Map,g=new Set;for(let $=0;$<u.length;$++){const b=u[$];if(b.type==="compaction")continue;const d=b.message,_=d.content&&d.content.trim().length>0&&d.content!=="Assistant response",v=d.type==="assistant"&&d.metadata?.has_tool_uses&&d.metadata?.tool_uses?.length>0;if(d.type==="assistant"&&v&&!_){let T=-1,E=!1;for(let R=$-1;R>=0;R--){const I=u[R];if(!g.has(R)){if(I.type==="message"&&I.message.type!=="assistant"){E=!0;break}if(I.type==="message"&&I.message.type==="assistant"){const O=I.message;if(O.content&&O.content.trim().length>0&&O.content!=="Assistant response"){T=R;break}else{T=R;break}}}}E&&T===-1||(E&&T>=0?(w.has(T)||w.set(T,[]),w.get(T).push(...d.metadata.tool_uses),g.add($)):!E&&T>=0&&(w.has(T)||w.set(T,[]),w.get(T).push(...d.metadata.tool_uses),g.add($)))}}const k=[];for(let $=0;$<u.length;$++){if(g.has($))continue;const b=u[$];w.has($)&&(b.attachedTools=[...b.attachedTools||[],...w.get($)]),k.push(b)}return k}function c(u,w,g){if(g+3>=w.length)return!1;const k=w[g],$=w[g+1];let b=w[g+2],d=w[g+3],_=w[g+4];const v=k.type==="system"&&k.metadata?.subtype==="status"&&k.metadata?.init_data?.status==="compacting",T=$.type==="system"&&$.metadata?.subtype==="status"&&($.metadata?.init_data?.status===null||$.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(g+4>=w.length)return!1;const R=!0,I=d?.type==="system"&&d?.metadata?.subtype==="compact_boundary",O=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",T),console.log("  Msg3 (init):",R),console.log("  Msg4 (boundary):",I),console.log("  Msg5 (continuation):",O)),v&&T&&R&&I&&O}else{const R=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",I=d?.type==="user"&&d?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",T),console.log("  Msg3 (boundary):",R),console.log("  Msg4 (continuation):",I)),v&&T&&R&&I}}async function f(){t.autoScrollEnabled&&(await St(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>i.value.length,f),fe(()=>e.currentToolCalls.length,f),fe(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),f),ye(()=>{setTimeout(()=>{f()},100)});function m(u){const w=u.subtype||u.metadata?.subtype;if(u.type==="system"&&w==="init"||u.type==="system"&&w==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const g=u.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const g=u.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function p(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,w)=>(a(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),l("div",db," No messages yet. Start a conversation! ")):M("",!0),(a(!0),l(re,null,ce(i.value,(g,k)=>(a(),l(re,{key:`item-${k}`},[g.type==="message"?(a(),be(Kp,{key:0,message:p(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(a(),be(ub,{key:1,messages:g.messages},null,8,["messages"])):M("",!0)],64))),128))],512))}},pb=ne(mb,[["__scopeId","data-v-bb936559"]]),fb={key:0,class:"attachment-list"},vb={key:0,class:"attachment-preview"},hb=["src","alt"],_b={key:1,class:"attachment-icon"},gb={class:"file-type-icon"},bb={class:"attachment-info"},yb=["title"],wb={class:"attachment-size"},$b=["onClick"],kb={key:2,class:"upload-progress"},Sb=["title"],Eb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const t=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const p=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(p)}function i(m){const p=m.name?.split(".").pop()?.toLowerCase()||"",u=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(p)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(p)?"âš™ï¸":["log","txt"].includes(p)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(p)?"ðŸ“":"ðŸ“"}function r(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function c(m,p=20){if(!m||m.length<=p)return m;const u=m.split(".").pop(),w=m.substring(0,m.length-u.length-1);return w.length<=p-u.length-4?m:w.substring(0,p-u.length-4)+"..."+u}function f(m){t("remove",m)}return(m,p)=>n.attachments.length>0?(a(),l("div",fb,[(a(!0),l(re,null,ce(n.attachments,(u,w)=>(a(),l("div",{key:u.id||w,class:"attachment-item"},[o(u)?(a(),l("div",vb,[s("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,hb)])):(a(),l("div",_b,[s("span",gb,y(i(u)),1)])),s("div",bb,[s("span",{class:"attachment-name",title:u.name},y(c(u.name)),9,yb),s("span",wb,y(r(u.size)),1)]),s("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>f(w)}," âœ• ",8,$b),u.uploading?(a(),l("div",kb,[s("div",{class:"progress-bar",style:ze({width:(u.progress||0)+"%"})},null,4)])):M("",!0),u.error?(a(),l("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+y(u.error),9,Sb)):M("",!0)]))),128))])):M("",!0)}},Cb=ne(Eb,[["__scopeId","data-v-0fcc4974"]]),Tb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},xb=["disabled"],Ab=["placeholder","disabled"],Mb=["disabled"],mo=5*1024*1024,Ob={__name:"InputArea",setup(n){const e=de(),t=nt(),o=Xe(),i=_e(),r=fo("pendingResourceAttachment",P(null)),c=P(null),f=P(null),m=P(window.innerWidth),p=P([]),u=P(!1),w=P(!1),g=h({get:()=>e.currentInput,set:S=>{e.currentInput=S}}),k=h(()=>e.currentSession?.is_processing||!1),$=h(()=>t.sessionConnected),b=h(()=>e.currentSession?.state==="starting"),d=h(()=>e.currentSessionId),_=h(()=>m.value<768),v=h(()=>b.value?"Session is starting...":$.value?"Type your message to Claude Code...":"Waiting for connection...");function T(){m.value=window.innerWidth}ye(()=>{window.addEventListener("resize",T)}),Ee(()=>{window.removeEventListener("resize",T)}),fe(r,S=>{S&&(D(S),r.value=null)});function E(S){if(S.key==="Enter"&&!S.shiftKey){if(_.value)return;S.preventDefault(),q()}}function R(){const S=c.value;if(!S)return;S.style.height="auto";const C=Math.min(S.scrollHeight,parseInt(getComputedStyle(S).maxHeight));S.style.height=C+"px"}function I(){f.value?.click()}function O(S){const C=Array.from(S.target.files||[]);A(C),S.target.value=""}function H(S){u.value=!1;const C=Array.from(S.dataTransfer?.files||[]);A(C)}function x(S){const C=S.clipboardData?.items;if(!C)return;const F=[];for(const J of C)if(J.type.startsWith("image/")){const z=J.getAsFile();if(z){const Q=J.type.split("/")[1]||"png",se=`clipboard-${Date.now()}.${Q}`,X=new File([z],se,{type:z.type});F.push(X)}}F.length>0&&(S.preventDefault(),A(F))}function A(S){for(const C of S){if(C.size>mo){p.value.push({id:K(),name:C.name,size:C.size,type:C.type,file:C,error:`File too large (max ${mo/(1024*1024)}MB)`});continue}let F=null;C.type.startsWith("image/")&&(F=URL.createObjectURL(C)),p.value.push({id:K(),name:C.name,size:C.size,type:C.type,file:C,preview:F,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function W(S){const C=p.value[S];C.preview&&URL.revokeObjectURL(C.preview),p.value.splice(S,1)}function K(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function L(S){const C=d.value;if(!C)return null;S.uploading=!0,S.progress=0,S.error=null;try{const F=new FormData;F.append("file",S.file);const J=await fetch(`/api/sessions/${C}/files`,{method:"POST",body:F});if(!J.ok){const Q=await J.json().catch(()=>({}));throw new Error(Q.detail||`Upload failed: ${J.status}`)}const z=await J.json();return S.uploaded=!0,S.uploadedInfo=z.file,S.progress=100,z.file}catch(F){return S.error=F.message,null}finally{S.uploading=!1}}async function B(){const S=p.value.filter(C=>!C.uploaded&&!C.error);if(S.length===0)return!0;w.value=!0;try{return(await Promise.all(S.map(L))).every(F=>F!==null)}finally{w.value=!1}}async function q(){const S=g.value.trim(),C=p.value.filter(z=>!z.error).length>0;if(!S&&!C||C&&!await B())return;let F=g.value;const J=p.value.filter(z=>z.uploaded&&z.uploadedInfo).map(z=>z.uploadedInfo);if(J.length>0){const z=J.map(Q=>{const se=(Q.size_bytes/1024).toFixed(1);return`- ${Q.original_name} (${se} KB): ${Q.stored_path}`}).join(`
`);F.trim()?F=`${F}

---
Attached files (use Read tool to access):
${z}`:F=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${z}`}t.sendMessage(F),g.value="",Z(),c.value&&(c.value.style.height="auto")}function Z(){for(const S of p.value)S.preview&&URL.revokeObjectURL(S.preview);p.value=[]}function D(S){if(!S||!S.resource_id){console.warn("Invalid resource for attachment:",S);return}const C=d.value;if(!C){console.warn("No current session for resource attachment");return}if(p.value.findIndex(Q=>Q.resourceId===S.resource_id)>=0){console.log("Resource already attached:",S.resource_id);return}const J=o.isImageResource(S);let z=null;J&&(z=o.getResourceUrl(C,S.resource_id)),p.value.push({id:K(),resourceId:S.resource_id,name:S.original_filename||S.title||"Resource",size:S.size_bytes||0,type:S.format||"application/octet-stream",file:null,preview:z,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:S.resource_id,original_name:S.original_filename||S.title,stored_path:S.file_path||`/api/sessions/${C}/resources/${S.resource_id}`,size_bytes:S.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",S.resource_id)}function N(){t.interruptSession()}return(S,C)=>(a(),l("div",{class:te(["border-top",$e(i).isRedBackground?"theme-red-panel":"bg-light"])},[$.value?M("",!0):(a(),l("div",Tb,[...C[5]||(C[5]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),pe(Cb,{attachments:p.value,onRemove:W},null,8,["attachments"]),u.value?(a(),l("div",{key:1,class:"drop-zone-overlay",onDragover:C[0]||(C[0]=ve(()=>{},["prevent"])),onDragleave:C[1]||(C[1]=F=>u.value=!1),onDrop:ve(H,["prevent"])},[...C[6]||(C[6]=[s("div",{class:"drop-zone-content"},[s("span",{class:"drop-icon"},"ðŸ“Ž"),s("span",null,"Drop files here")],-1)])],32)):M("",!0),s("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:C[3]||(C[3]=ve(F=>u.value=!0,["prevent"])),onDragenter:C[4]||(C[4]=ve(F=>u.value=!0,["prevent"]))},[s("input",{ref_key:"fileInput",ref:f,type:"file",multiple:"",class:"d-none",onChange:O},null,544),s("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:b.value||!$.value,onClick:I}," ðŸ“Ž ",8,xb),ge(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:c,"onUpdate:modelValue":C[2]||(C[2]=F=>g.value=F),class:"form-control",placeholder:v.value,disabled:b.value||!$.value,rows:"1",onInput:R,onKeydown:E,onPaste:x},null,40,Ab),[[We,g.value]]),k.value?(a(),l("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:N}," Stop ")):(a(),l("button",{key:1,class:"btn btn-primary",disabled:!g.value.trim()&&p.value.length===0||!$.value||b.value||w.value,onClick:q},y(w.value?"Uploading...":"Send"),9,Mb))],32)],2))}},Db=ne(Ob,[["__scopeId","data-v-2fee1f07"]]),Nb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Lb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Ib={class:"text-secondary"},jb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Pb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_e(),i=h(()=>t.currentSession),r=h(()=>o.isLoading),c=h(()=>o.loadingMessage);return ye(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(f,m)=>{if(f!==m&&f!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(f)}finally{o.hideLoading()}}}),Ee(()=>{}),(f,m)=>(a(),l("div",Nb,[r.value?(a(),l("div",Lb,[m[0]||(m[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",Ib,y(c.value),1)])):M("",!0),i.value?(a(),be(Gi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),s("div",jb,[pe(pb)]),pe(Db),i.value?(a(),be(Zi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),i.value?(a(),be(ra,{key:3,"session-id":e.sessionId},null,8,["session-id"])):M("",!0)]))}},_s=st("legion",()=>{const n=P(new Map),e=P(new Map),t=P(null),o=h(()=>n.value.get(t.value)||[]),i=h(()=>e.value.get(t.value)||[]);function r($){t.value=$}async function c($,b=100,d=0){try{const _=await me.get(`/api/legions/${$}/timeline?limit=${b}&offset=${d}`),v=_.comms||[],T=_.total_count||v.length,E=_.has_more||!1;return v.sort((R,I)=>new Date(R.timestamp)-new Date(I.timestamp)),console.log(`Loaded ${v.length} of ${T} comms for legion ${$}`),n.value.set($,v),n.value=new Map(n.value),{comms:v,totalCount:T,hasMore:E}}catch(_){throw console.error("Failed to load timeline:",_),_}}function f($,b){n.value.has($)||n.value.set($,[]);const d=n.value.get($);if(d.some(v=>v.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}d.push(b),n.value=new Map(n.value)}async function m($,b){try{const _=(await me.post(`/api/legions/${$}/comms`,b)).comm;return console.log(`Sent comm ${_.comm_id} to legion ${$}`),_}catch(d){throw console.error("Failed to send comm:",d),d}}async function p($){return console.log(`Minions for legion ${$} are already available in session store`),[]}async function u($,b){try{const _=(await me.post(`/api/legions/${$}/minions`,b)).minion;return await p($),console.log(`Created minion ${_.minion_id} in legion ${$}`),_}catch(d){throw console.error("Failed to create minion:",d),d}}async function w($){try{const b=await me.post(`/api/legions/${$}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${$}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function g($){try{const b=await me.post(`/api/legions/${$}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${$}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function k($){n.value.delete($),e.value.delete($),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:r,loadTimeline:c,addComm:f,sendComm:m,loadMinions:p,createMinion:u,haltAll:w,resumeAll:g,clearLegionData:k}}),Rb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:_s},Symbol.toStringTag,{value:"Module"})),Wb={class:"timeline-header border-bottom p-3"},Bb={class:"project-name"},Fb=["title"],Hb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=je(),o=h(()=>t.projects.get(e.legionId)),i=h(()=>o.value?.name||"Legion");return(r,c)=>(a(),l("div",Wb,[s("div",null,[s("div",Bb,y(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Fb)])]))}},Vb=ne(Hb,[["__scopeId","data-v-44f386f5"]]),Ub={class:"timeline-status-bar border-top p-2 bg-light"},qb={class:"d-flex justify-content-end"},zb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=_e();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),l("div",Ub,[s("div",qb,[s("button",{class:te(["btn btn-sm",$e(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+y($e(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Kb=ne(zb,[["__scopeId","data-v-891c73db"]]),Gb={class:"comm-composer border-top p-3"},Yb={key:0,class:"d-flex gap-2 mb-2"},Jb={class:"flex-grow-1"},Qb=["disabled"],Xb={label:"Minions"},Zb=["value"],ey={style:{"min-width":"150px"}},ty=["disabled"],sy={class:"d-flex gap-2 align-items-end position-relative"},ny={class:"flex-grow-1 position-relative"},oy=["disabled"],iy=["onClick","onMouseenter"],ay=["disabled"],ry={key:0},ly={key:1},cy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=_s(),o=de(),i=je(),r=P(""),c=P("task"),f=P(""),m=P(!1),p=P(window.innerWidth),u=P(!1),w=P([]),g=P(0),k=P(-1),$=P(null),b=P(null),d=h(()=>p.value<768),_=h(()=>{const K=i.projects.get(e.legionId);return!K||!K.session_ids?[]:K.session_ids.map(L=>o.sessions.get(L)).filter(L=>L)}),v=h(()=>r.value&&f.value.trim().length>0);function T(K){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[K.state]||"â—‹"}function E(K){return K.role?`${K.name} (${K.role})`:K.name}function R(){const K=$.value;if(!K)return;K.style.height="auto";const L=Math.min(K.scrollHeight,parseInt(getComputedStyle(K).maxHeight));K.style.height=L+"px"}function I(){const K=$.value;if(!K)return;R();const L=f.value,B=K.selectionStart,q=L.substring(0,B),Z=q.lastIndexOf("#");if(Z===-1){u.value=!1;return}const D=q.substring(Z+1).toLowerCase();if(D.includes(" ")){u.value=!1;return}const N=_.value.filter(S=>S.name.toLowerCase().includes(D)).map(S=>({type:"minion",name:S.name,role:S.role,id:S.session_id,state:S.state}));if(N.length===0){u.value=!1;return}w.value=N,g.value=0,k.value=Z,u.value=!0}function O(){if(!b.value)return;const K=b.value,L=K.children[g.value];if(!L)return;const B=L.offsetTop,q=L.offsetHeight,Z=K.scrollTop,D=K.clientHeight;B<Z?K.scrollTop=B:B+q>Z+D&&(K.scrollTop=B+q-D)}function H(K){if(!u.value){if(K.key==="Enter"&&!K.shiftKey){if(d.value)return;v.value&&(K.preventDefault(),A())}return}if(K.key==="ArrowDown")K.preventDefault(),g.value=(g.value+1)%w.value.length,O();else if(K.key==="ArrowUp")K.preventDefault(),g.value=g.value===0?w.value.length-1:g.value-1,O();else if(K.key==="Enter"){K.preventDefault();const L=w.value[g.value];L&&x(L)}else K.key==="Escape"&&(u.value=!1)}function x(K){const L=$.value;if(!L)return;const B=f.value,q=L.selectionStart,Z=B.substring(0,k.value)+"#"+K.name+" "+B.substring(q);f.value=Z;const D=k.value+K.name.length+2;setTimeout(()=>{L.setSelectionRange(D,D),L.focus()},0),u.value=!1}async function A(){if(!(!v.value||m.value)){m.value=!0;try{const[K,L]=r.value.split(":"),B={comm_type:c.value,content:f.value.trim()};K==="minion"&&(B.to_minion_id=L),await t.sendComm(e.legionId,B),f.value="",R()}catch(K){console.error("Failed to send comm:",K),alert(`Failed to send comm: ${K.message}`)}finally{m.value=!1}}}function W(){p.value=window.innerWidth}return ye(()=>{window.addEventListener("resize",W)}),Ee(()=>{window.removeEventListener("resize",W)}),fe(u,K=>{if(K){const L=B=>{B.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",L))};setTimeout(()=>document.addEventListener("click",L),0)}}),(K,L)=>(a(),l("div",Gb,[n.hideRecipientSelector?M("",!0):(a(),l("div",Yb,[s("div",Jb,[ge(s("select",{"onUpdate:modelValue":L[0]||(L[0]=B=>r.value=B),class:"form-select form-select-sm",disabled:m.value},[L[3]||(L[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Xb,[(a(!0),l(re,null,ce(_.value,B=>(a(),l("option",{key:B.session_id,value:`minion:${B.session_id}`},y(T(B))+" "+y(E(B)),9,Zb))),128))])],8,Qb),[[_n,r.value]])]),s("div",ey,[ge(s("select",{"onUpdate:modelValue":L[1]||(L[1]=B=>c.value=B),class:"form-select form-select-sm",disabled:m.value},[...L[4]||(L[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,ty),[[_n,c.value]])])])),s("div",sy,[s("div",ny,[ge(s("textarea",{ref_key:"contentTextarea",ref:$,"onUpdate:modelValue":L[2]||(L[2]=B=>f.value=B),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:I,onKeydown:H},null,40,oy),[[We,f.value]]),u.value?(a(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),l(re,null,ce(w.value,(B,q)=>(a(),l("div",{key:B.id,class:te(["autocomplete-item px-2 py-1",{"bg-light":q===g.value}]),onClick:Z=>x(B),onMouseenter:Z=>g.value=q},y(B.type==="minion"?T(B):"#ï¸âƒ£")+" "+y(B.name)+y(B.role?` (${B.role})`:""),43,iy))),128))],512)):M("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!v.value||m.value,onClick:A},[m.value?(a(),l("span",ry,[...L[5]||(L[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ie(" Sending... ",-1)])])):(a(),l("span",ly,"Send"))],8,ay)])])]))}},uy=ne(cy,[["__scopeId","data-v-e52b8e8f"]]),dy={class:"message-content-column-full"},my=["aria-expanded"],py={class:"comm-sender-recipient"},fy={class:"comm-badge-summary"},vy=["title"],hy={class:"comm-summary-text text-muted ms-2"},_y=["aria-label"],gy={key:0,class:"comm-content-body"},by=["innerHTML"],yy="ffffffff-ffff-ffff-ffff-ffffffffffff",wy={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=P(!1);function o(){t.value=!t.value}const i=h(()=>e.comm.from_minion_id===yy),r=h(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),c=h(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),f=h(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),m=h(()=>{const p=e.comm.content||"";let u=dt.parse(p);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),cs.sanitize(u)});return(p,u)=>(a(),l("div",{class:te(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",dy,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",py,[s("strong",{class:te({"system-sender":i.value})},y(n.senderName),3),n.recipientName?(a(),l(re,{key:0},[u[0]||(u[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,y(n.recipientName),1)],64)):M("",!0)]),s("div",fy,[s("span",{class:te(["badge",c.value]),title:r.value},y(n.comm.comm_type),11,vy),s("span",hy,y(f.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,_y)],8,my),t.value?(a(),l("div",gy,[s("div",{class:"message-text",innerHTML:m.value},null,8,by)])):M("",!0)])],2))}},$y=ne(wy,[["__scopeId","data-v-28513f64"]]),ky={class:"timeline-view d-flex flex-column h-100"},Sy={key:0,class:"text-center text-muted"},Ey={key:1,class:"text-center text-danger"},Cy={key:2,class:"text-center text-muted"},Ty={key:3,class:"comm-list"},xy={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=_s();je();const o=de(),i=nt(),r=_e(),c=P(!0),f=P(null),m=P(null),p=h(()=>t.currentComms);function u(d){return d.from_user?"You":d.from_minion_id?d.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(d.from_minion_id)?.name||"Unknown":"Unknown"}function w(d){return d.to_user?"You":d.to_minion_id?o.sessions.get(d.to_minion_id)?.name||"Unknown":"All"}async function g(){r.autoScrollEnabled&&(await St(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function k(){c.value=!0,f.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await St(),await g(),setTimeout(()=>{g()},100)}catch(d){console.error("Failed to load timeline:",d),d.response?f.value=`${d.message} (${d.response.status})`:f.value=d.message||"Unknown error"}finally{c.value=!1}}function $(){i.connectLegion(e.legionId)}function b(){i.disconnectLegion()}return fe(()=>p.value.length,()=>{g()}),ye(()=>{o.currentSessionId=null,k(),$(),setTimeout(()=>{g()},100)}),Ee(()=>{b()}),(d,_)=>(a(),l("div",ky,[pe(Vb,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(a(),l("div",Sy,[..._[0]||(_[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ie(" Loading timeline... ",-1)])])):f.value?(a(),l("div",Ey," Failed to load timeline: "+y(f.value),1)):p.value.length===0?(a(),l("div",Cy," No messages yet. Minions will appear here once they start communicating. ")):(a(),l("div",Ty,[(a(!0),l(re,null,ce(p.value,v=>(a(),be($y,{key:v.comm_id,comm:v,"sender-name":u(v),"recipient-name":w(v)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),pe(uy,{"legion-id":n.legionId},null,8,["legion-id"]),pe(Kb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Ay=ne(xy,[["__scopeId","data-v-b6752179"]]),My={class:"minion-info flex-grow-1"},Oy={class:"minion-name"},Dy={key:0,class:"me-1"},Ny={key:1,class:"badge bg-secondary ms-2"},Ly={key:0,class:"latest-activity text-muted"},Iy={key:0,class:"activity-prefix"},jy=["title"],Py={key:1,class:"activity-time ms-1"},Ry={key:1,class:"latest-activity text-muted"},Wy={class:"activity-prefix"},By=["title"],Fy={key:2,class:"latest-activity text-muted fst-italic small"},Hy={class:"node-row"},Vy={class:"node-left"},Uy={key:0,class:"me-2"},qy={key:1,class:"badge bg-secondary ms-2"},zy={class:"node-right"},Ky={key:0,class:"latest-message-preview"},Gy={key:0,class:"message-prefix"},Yy=["title"],Jy={key:1,class:"message-time ms-1"},Qy={key:1,class:"last-comm-preview"},Xy={class:"comm-direction"},Zy=["title"],e1={key:2,class:"text-muted fst-italic small"},t1={class:"node-actions"},s1={key:2,class:"minion-children"},n1={key:1,class:"text-danger small ms-4"},o1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=de(),r=Ae(),c=_e(),f=h(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),m=h(()=>{if(!t.minionData||!t.minionData.id)return null;const x=r.messagesBySession.get(t.minionData.id);if(!x||x.length===0)return null;for(let A=x.length-1;A>=0;A--){const W=x[A],K=W.subtype||W.metadata?.subtype;if(W.type!=="result"&&!(W.type==="system"&&K==="init")&&!(W.type==="system"&&K==="task_notification")&&!(W.type==="permission_request"||W.type==="permission_response")){if(W.type==="user"&&W.metadata?.has_tool_results){const L=W.content||"";if(L.match(/^Tool results?: \d+ results?$/i)||L.trim()==="")continue}if(W.type==="user"){const L=W.content||"";if(L.includes("<command-message>")&&L.includes("skill is running")||L.startsWith("Base directory for this skill:"))continue}if(W.type==="user"){const L=W.content||"";if(L.includes("<command-message>")&&L.includes("<command-name>")&&L.includes("<command-args>")||L.includes("ARGUMENTS:")&&(L.includes("<command-name>")||L.match(/\nARGUMENTS:/)))continue}if(!(W.type==="system"&&W.content==="System message")&&!(W.type==="assistant"&&W.content==="Assistant response")&&(W.type==="user"||W.type==="assistant"||W.type==="system"))return{content:W.content,type:W.type,timestamp:W.timestamp}}}return null}),p=h(()=>{if(!t.minionData)return null;const x={...t.minionData};return f.value&&(x.state=f.value.state,x.is_processing=f.value.is_processing,f.value.name&&(x.name=f.value.name),f.value.latest_message&&(x.latest_message=f.value.latest_message,x.latest_message_type=f.value.latest_message_type,x.latest_message_time=f.value.latest_message_time)),m.value&&(x.latest_message=m.value.content,x.latest_message_type=m.value.type,x.latest_message_time=m.value.timestamp),x}),u=h(()=>t.level*24),w=h(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),g=h(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),k=h(()=>t.minionData&&t.minionData.is_overseer&&g.value),$=h(()=>{const x=p.value;return x?x.state==="paused"&&x.is_processing?"pending-prompt":x.is_processing?"processing":x.state||"created":"created"}),b=h(()=>{const x=$.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[x]||"status-dot-grey"}),d=h(()=>{const x=$.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[x]||"#d3d3d3"}}),_=h(()=>{const x=p.value;if(!x||!x.latest_message_type)return"";const A=x.latest_message_type;return A==="user"?"User -->:":A==="system"?"System:":""}),v=h(()=>{const x=p.value;if(!x||!x.latest_message)return"";const A=x.latest_message,W=150;return A.length>W?A.slice(0,W)+"...":A}),T=h(()=>{const x=p.value;if(!x||!x.latest_message_time)return"";try{const A=Date.now();let W;if(typeof x.latest_message_time=="number"?W=x.latest_message_time<3250368e4?x.latest_message_time*1e3:x.latest_message_time:W=new Date(x.latest_message_time).getTime(),isNaN(W)||W<9466848e5||W>A+6e4)return console.warn("Invalid timestamp for relative time calculation:",x.latest_message_time,"parsed to:",W),"";const K=A-W;if(K<0)return"just now";const L=Math.floor(K/6e4),B=Math.floor(L/60),q=Math.floor(B/24);return q>0?`${q}d ago`:B>0?`${B}h ago`:L>0?`${L}m ago`:"just now"}catch(A){return console.error("Error calculating relative time:",A,x.latest_message_time),""}});function E(x){return x.to_user?"User":x.to_minion_name?x.to_minion_name:"unknown"}function R(x){const A=x.summary||x.content||"";return A.length>150?A.substring(0,150)+"...":A}function I(){o("minion-click",t.minionData.id)}function O(){const x=i.sessions.get(t.minionData.id);x&&c.showModal("edit-session",{session:x})}function H(){const x=i.sessions.get(t.minionData.id);x&&c.showModal("manage-session",{session:x})}return(x,A)=>{const W=vo("MinionTreeNode",!0);return n.minionData?(a(),l("div",{key:0,class:"minion-tree-node",style:ze({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),l("div",{key:0,class:te(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:I},[s("div",{class:te(["status-dot me-2",b.value]),style:ze(d.value)},null,6),s("div",My,[s("div",Oy,[k.value?(a(),l("span",Dy,"ðŸ‘‘")):M("",!0),s("strong",null,y(p.value?.name||n.minionData.name),1),k.value?(a(),l("span",Ny,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),p.value?.latest_message?(a(),l("div",Ly,[_.value?(a(),l("span",Iy,y(_.value),1)):M("",!0),s("span",{class:"activity-content",title:p.value.latest_message},y(v.value),9,jy),T.value?(a(),l("span",Py,"("+y(T.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(a(),l("div",Ry,[s("span",Wy,[A[1]||(A[1]=ie("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),A[2]||(A[2]=ie(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(R(n.minionData.last_comm)),9,By)])):(a(),l("div",Fy," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(O,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(H,["stop"])}," âš™ï¸ ")],2)):(a(),l("div",{key:1,class:te(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:I},[s("div",Hy,[s("div",Vy,[s("div",{class:te(["status-dot me-2",b.value]),style:ze(d.value)},null,6),k.value?(a(),l("span",Uy,"ðŸ‘‘")):M("",!0),s("strong",null,y(p.value?.name||n.minionData.name),1),k.value?(a(),l("span",qy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),s("div",zy,[p.value?.latest_message?(a(),l("div",Ky,[_.value?(a(),l("span",Gy,y(_.value),1)):M("",!0),s("span",{class:"message-content",title:p.value.latest_message},y(v.value),9,Yy),T.value?(a(),l("span",Jy,"("+y(T.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(a(),l("div",Qy,[s("span",Xy,[A[3]||(A[3]=ie("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),A[4]||(A[4]=ie(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(R(n.minionData.last_comm)),9,Zy)])):(a(),l("div",e1," No activity yet "))]),s("div",t1,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(O,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(H,["stop"])}," âš™ï¸ ")])])],2)),g.value?(a(),l("div",s1,[(a(!0),l(re,null,ce(n.minionData.children,K=>(a(),be(W,{key:K.id,"minion-data":K,level:n.level+1,layout:n.layout,onMinionClick:A[0]||(A[0]=L=>x.$emit("minion-click",L))},null,8,["minion-data","level","layout"]))),128))])):M("",!0)],4)):(a(),l("div",n1," âš  Minion data is missing "))}}},ki=ne(o1,[["__scopeId","data-v-64b23e0e"]]),i1={class:"project-overview d-flex flex-column h-100"},a1={class:"project-overview-header border-bottom p-3"},r1={class:"d-flex align-items-center justify-content-between"},l1={class:"mb-1"},c1={key:0,class:"me-2"},u1={class:"text-muted font-monospace"},d1={class:"d-flex gap-2"},m1=["title"],p1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},f1={key:0,class:"text-center py-5"},v1={key:1,class:"alert alert-danger"},h1={key:2,class:"text-center py-5"},_1={key:3},g1={class:"row g-3 mb-4"},b1={class:"col-md-4"},y1={class:"card h-100"},w1={class:"card-body"},$1={class:"card-title mb-0"},k1={class:"text-muted"},S1={class:"col-md-4"},E1={class:"card h-100"},C1={class:"card-body"},T1={class:"card-title mb-0"},x1={class:"text-muted"},A1={key:0,class:"card mb-4"},M1={class:"card mb-4"},O1={class:"card-header d-flex align-items-center justify-content-between"},D1={class:"mb-0"},N1={class:"badge bg-secondary"},L1={class:"card-body"},I1={key:0,class:"text-center py-4"},j1={key:1,class:"text-center text-muted py-4"},P1={key:2,class:"hierarchy-tree"},R1={class:"user-root-node mb-3 border rounded bg-white"},W1={class:"node-row"},B1={class:"node-left"},F1={class:"badge bg-primary ms-2"},H1={class:"node-right"},V1={key:0,class:"last-comm-preview"},U1={class:"comm-direction"},q1=["title"],z1={key:1,class:"text-muted fst-italic"},K1={class:"root-minions ms-4"},G1={class:"card"},Y1={class:"card-body"},J1={class:"row mb-0"},Q1={class:"col-sm-8 font-monospace text-break"},X1={class:"col-sm-8 font-monospace text-break"},Z1={class:"col-sm-8"},ew={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},tw={class:"text-muted"},sw={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Ft(),o=je(),i=de(),r=_e(),c=_s(),f=nt(),m=P(!1),p=P(null),u=P(null),w=P(!1);let g=null;const k=h(()=>o.getProject(e.projectId)),$=h(()=>k.value?.session_ids?k.value.session_ids.map(B=>i.getSession(B)).filter(B=>B!=null):[]),b=h(()=>$.value.length>0),d=h(()=>$.value.length),_=h(()=>$.value.filter(B=>B.state==="ACTIVE").length),v=h(()=>{const B=$.value.some(D=>D.state==="ACTIVE"),q=$.value.some(D=>D.is_processing);return $.value.some(D=>D.state==="ERROR")?"Error":q?"Working":B?"Active":d.value>0?"Idle":"Empty"}),T=h(()=>{switch(v.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),E=h(()=>{switch(v.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function R(){w.value=!0;try{const B=await me.get(`/api/legions/${e.projectId}/hierarchy`);u.value=B}catch(B){console.error("Failed to load minion hierarchy:",B),u.value=null}finally{w.value=!1}}function I(B,q){if(B&&B.id===q)return B;if(B&&B.children)for(const Z of B.children){const D=I(Z,q);if(D)return D}return null}function O(B){return B.to_user?"User":B.to_minion_name?B.to_minion_name:"unknown"}function H(B){const q=B.summary||B.content||"";return q.length>150?q.substring(0,150)+"...":q}function x(B){if(u.value){if(B.from_minion_id){const q=I(u.value,B.from_minion_id);q&&q.type==="minion"&&(q.last_comm=B)}B.from_user&&u.value.type==="user"&&(u.value.last_comm=B)}}function A(B){t.push(`/session/${B}`)}function W(){t.push(`/timeline/${e.projectId}`)}function K(){r.showModal("edit-project",{project:k.value})}function L(){r.showModal("create-minion",{project:k.value})}return ye(()=>{o.selectProject(e.projectId),i.currentSessionId=null,R(),c.setCurrentLegion(e.projectId),f.connectLegion(e.projectId),g=fe(()=>i.sessions,B=>{if(u.value){for(const[q,Z]of B)if(Z.project_id===e.projectId){const D=I(u.value,q);D&&D.type==="minion"&&(D.state!==Z.state&&(D.state=Z.state),D.is_processing!==Z.is_processing&&(D.is_processing=Z.is_processing),D.latest_message!==Z.latest_message&&(D.latest_message=Z.latest_message,D.latest_message_type=Z.latest_message_type,D.latest_message_time=Z.latest_message_time))}}},{deep:!0}),fe(()=>c.commsByLegion.get(e.projectId),B=>{if(B&&B.length>0){const q=B[B.length-1];x(q)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(B,q)=>{B!==q&&R()})}),fe(()=>e.projectId,B=>{o.selectProject(B),i.currentSessionId=null,R(),c.setCurrentLegion(B),f.connectLegion(B)}),Ee(()=>{g&&g()}),(B,q)=>(a(),l("div",i1,[s("div",a1,[s("div",r1,[s("div",null,[s("h4",l1,[b.value?(a(),l("span",c1,"ðŸ›")):M("",!0),ie(" "+y(k.value?.name||"Project Overview"),1)]),s("small",u1,y(k.value?.working_directory),1)]),s("div",d1,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:K}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:L}," âž• "+y(b.value?"Add Minion":"Add Session"),9,m1)])])]),s("div",p1,[m.value?(a(),l("div",f1,[...q[0]||(q[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(a(),l("div",v1,y(p.value),1)):k.value?(a(),l("div",_1,[s("div",g1,[s("div",b1,[s("div",y1,[s("div",w1,[q[2]||(q[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",$1,y(d.value),1),s("small",k1,y(_.value)+" active",1)])])]),s("div",S1,[s("div",E1,[s("div",C1,[q[3]||(q[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",T1,[s("span",{class:te(T.value)},y(v.value),3)]),s("small",x1,y(E.value),1)])])])]),b.value?(a(),l("div",A1,[q[4]||(q[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:W}," ðŸ“Š View Timeline ")])])])):M("",!0),s("div",M1,[s("div",O1,[s("h5",D1,"ðŸŒ³ "+y(b.value?"Minion Hierarchy":"Sessions"),1),s("span",N1,y($.value.length),1)]),s("div",L1,[w.value?(a(),l("div",I1,[...q[5]||(q[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),l("div",j1,' No sessions yet. Click "Add Session" to create one. ')):(a(),l("div",P1,[s("div",R1,[s("div",W1,[s("div",B1,[q[6]||(q[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,y(u.value.name),1),s("span",F1,y(u.value.children.length)+" "+y(u.value.children.length===1?"minion":"minions"),1)]),s("div",H1,[u.value.last_comm?(a(),l("div",V1,[s("span",U1,[q[7]||(q[7]=ie(" â†’ ",-1)),s("strong",null,y(O(u.value.last_comm)),1),q[8]||(q[8]=ie(": ",-1))]),s("span",{class:"comm-content",title:u.value.last_comm.content||""},y(H(u.value.last_comm)),9,q1)])):(a(),l("div",z1," No communications yet "))])])]),s("div",K1,[(a(!0),l(re,null,ce(u.value.children,Z=>(a(),be(ki,{key:Z.id,"minion-data":Z,level:1,layout:"two-column",onMinionClick:A},null,8,["minion-data"]))),128))])]))])]),s("div",G1,[q[12]||(q[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",Y1,[s("dl",J1,[q[9]||(q[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",Q1,y(k.value.working_directory),1),q[10]||(q[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",X1,y(k.value.project_id),1),q[11]||(q[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",Z1,y(b.value?"Yes (has minions)":"No"),1)])])])])):(a(),l("div",h1,[...q[1]||(q[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",ew,[q[13]||(q[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",tw,y(d.value)+" session"+y(d.value!==1?"s":""),1)])]))}},nw=ne(sw,[["__scopeId","data-v-168bf04c"]]),ow=[{path:"/",name:"home",component:Ii},{path:"/project/:projectId",name:"project",component:nw,props:!0},{path:"/session/:sessionId",name:"session",component:Pb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Ay,props:!0}],iw=Ei({history:Ci(),routes:ow}),aw={class:"connection-indicators"},rw=["title"],lw=["title"],cw=["title"],uw={__name:"ConnectionIndicator",setup(n){const e=nt();function t(i){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:c,retryCount:f}=r[i];return f>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(i){const r={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},f={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:m,retryCount:p}=f[i];let u="Disconnected";return m?u="Connected":p>0&&(u=`Reconnecting (attempt ${p})`),`${r[i]}
${c[i]}
Status: ${u}`}return(i,r)=>(a(),l("div",aw,[s("div",{class:te(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,rw),s("div",{class:te(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,lw),s("div",{class:te(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,cw)]))}},dw=ne(uw,[["__scopeId","data-v-d35b07c8"]]),mw={class:"d-flex align-items-center gap-2"},pw={__name:"AppHeader",setup(n){const e=_e();function t(){e.toggleSidebar()}return(o,i)=>(a(),l("header",{class:te(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",$e(e).isRedBackground?"theme-red-header":"bg-white"])},[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[1]||(i[1]=[s("span",null,"â˜°",-1)])]),i[2]||(i[2]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",mw,[s("button",{class:te(["btn btn-sm",$e(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:i[0]||(i[0]=r=>$e(e).toggleBackgroundColor())},[s("span",{class:"color-swatch",style:ze({backgroundColor:$e(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),pe(dw)])],2))}},fw=ne(pw,[["__scopeId","data-v-da1a7adc"]]),vw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},hw={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},_w=["title"],gw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=h(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(f){return f.state==="paused"&&f.is_processing?"pending-prompt":f.is_processing?"processing":f.state}function i(f){const m=o(f);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[m]||"#d3d3d3"}function r(f){const m=o(f);return m==="starting"||m==="processing"||m==="pending-prompt"}function c(f){const m=o(f),p=m.charAt(0).toUpperCase()+m.slice(1),u=f.name||"Unnamed Session",w=f.role?` (${f.role})`:"";return`${u}${w}: ${p}`}return(f,m)=>(a(),l("div",vw,[!n.sessions||n.sessions.length===0?(a(),l("div",hw)):(a(!0),l(re,{key:1},ce(n.sessions,p=>(a(),l("div",{key:p.session_id,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":r(p)}]),style:ze({width:t.value,backgroundColor:i(p),cursor:"help"}),title:c(p)},null,14,_w))),128))]))}},bw=ne(gw,[["__scopeId","data-v-391d77c1"]]),yw=["data-project-id"],ww=["id"],$w=["aria-expanded","aria-controls","aria-label","onKeydown"],kw=["aria-label","onKeydown"],Sw={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Ew={class:"fw-semibold",style:{"flex-shrink":"0"}},Cw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Tw={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},xw=["title"],Aw=["title"],Mw=["id","aria-labelledby"],Ow={class:"accordion-body p-0"},Dw={class:"list-group list-group-flush"},Nw={class:"minion-hierarchy-container"},Lw={key:0,class:"text-center py-2"},Iw={key:2,class:"text-muted text-center py-2 small"},jw={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ft(),o=je(),i=de(),r=_e(),c=P(e.project.is_expanded||!1),f=P(null),m=P(!1);let p=null;const u=h(()=>o.formatPath(e.project.working_directory)),w=h(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(L=>i.getSession(L)).filter(L=>L!=null)),g=h(()=>w.value.length>0),k=h(()=>{const L=t.currentRoute.value;return L.name==="timeline"&&L.params.legionId===e.project.project_id}),$=h(()=>{const L=t.currentRoute.value;return L.name==="project"&&L.params.projectId===e.project.project_id});function b(L){const B=window.bootstrap;if(!B)return;const q=document.getElementById(`collapse-${e.project.project_id}`);if(!q)return;B.Collapse.getOrCreateInstance(q).toggle(),c.value=!c.value}function d(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function _(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function v(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const L=i.currentSessionId;L&&i.getSession(L)&&e.project.session_ids?.includes(L)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function T(){r.showModal("edit-project",{project:e.project})}function E(){r.showModal("create-minion",{project:e.project})}function R(){t.push(`/timeline/${e.project.project_id}`)}async function I(){m.value=!0;try{const L=await me.get(`/api/legions/${e.project.project_id}/hierarchy`);f.value=L}catch(L){console.error("Failed to load minion hierarchy:",L),f.value=null}finally{m.value=!1}}function O(L){t.push(`/session/${L}`)}function H(L,B){if(L&&L.id===B)return L;if(L&&L.children)for(const q of L.children){const Z=H(q,B);if(Z)return Z}return null}fe(c,L=>{L&&I()}),ye(()=>{p=fe(()=>i.sessions,L=>{if(!(!f.value||!c.value)){for(const[B,q]of L)if(q.project_id===e.project.project_id){const Z=H(f.value,B);Z&&Z.type==="minion"&&(Z.state!==q.state&&(Z.state=q.state),Z.is_processing!==q.is_processing&&(Z.is_processing=q.is_processing),Z.latest_message!==q.latest_message&&(Z.latest_message=q.latest_message,Z.latest_message_type=q.latest_message_type,Z.latest_message_time=q.latest_message_time))}}},{deep:!0}),fe(()=>i.sessions.size,(L,B)=>{if(c.value&&(L>B&&Array.from(i.sessions.values()).some(D=>D.project_id===e.project.project_id&&(!f.value||!H(f.value,D.session_id)))&&(console.log("New minion detected, reloading hierarchy"),I()),L<B&&f.value)){const q=i.sessions,Z=D=>D.type==="minion"&&!q.has(D.id)?!0:D.children?D.children.some(N=>Z(N)):!1;Z(f.value)&&(console.log("Minion deletion detected, reloading hierarchy"),I())}}),c.value&&I()}),Ee(()=>{p&&p()});function x(L){L.dataTransfer.effectAllowed="move",L.dataTransfer.setData("application/project-id",e.project.project_id),L.dataTransfer.setData("text/plain",e.project.project_id),L.target.classList.add("dragging")}function A(L){L.target.classList.remove("dragging")}function W(L){L.preventDefault(),L.dataTransfer.dropEffect="move";const B=L.currentTarget.getBoundingClientRect(),q=B.top+B.height/2;L.clientY<q?(L.currentTarget.classList.add("drop-above"),L.currentTarget.classList.remove("drop-below")):(L.currentTarget.classList.add("drop-below"),L.currentTarget.classList.remove("drop-above"))}function K(L){L.preventDefault(),L.currentTarget.classList.remove("drop-above","drop-below");const B=L.dataTransfer.getData("application/project-id")||L.dataTransfer.getData("text/plain");if(!B||B===e.project.project_id)return;const q=L.currentTarget.getBoundingClientRect(),Z=q.top+q.height/2,D=L.clientY<Z,N=o.orderedProjects,S=N.findIndex(se=>se.project_id===e.project.project_id),C=N.findIndex(se=>se.project_id===B);if(S===-1||C===-1)return;const F=[...N],[J]=F.splice(C,1);let z=D?S:S+1;C<S&&z--,F.splice(z,0,J);const Q=F.map(se=>se.project_id);o.reorderProjects(Q)}return(L,B)=>(a(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:x,onDragend:A,onDragover:W,onDrop:K},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:te(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":$.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:ve(b,["stop"]),onKeydown:[qe(ve(b,["prevent"]),["enter"]),qe(ve(b,["prevent"]),["space"])]},[(a(),l("svg",{class:te(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...B[0]||(B[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,$w),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:d,onKeydown:[qe(ve(d,["prevent"]),["enter"]),qe(ve(d,["prevent"]),["space"])]},[s("div",Sw,[s("div",Ew,[g.value?(a(),l("span",Cw,"ðŸ›")):M("",!0),ie(" "+y(n.project.name),1)]),s("div",Tw,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ve(T,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:ve(E,["stop"])}," âž• ",8,xw)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(u.value),9,Aw)],40,kw)],2)],8,ww),pe(bw,{project:n.project,sessions:w.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:te(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:_,onHidden:v},[s("div",Ow,[s("div",Dw,[g.value?(a(),l("div",{key:0,class:te(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:k.value}]),style:{cursor:"pointer"},onClick:R},[...B[1]||(B[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):M("",!0),s("div",Nw,[m.value?(a(),l("div",Lw,[...B[2]||(B[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):f.value&&f.value.children&&f.value.children.length>0?(a(!0),l(re,{key:1},ce(f.value.children,q=>(a(),be(ki,{key:q.id,"minion-data":q,level:0,layout:"sidebar",onMinionClick:O},null,8,["minion-data"]))),128)):(a(),l("div",Iw," No sessions "))])])])],42,Mw)],40,yw))}},Pw=ne(jw,[["__scopeId","data-v-a15b34e8"]]),Rw={class:"project-list"},Ww={key:0,class:"text-muted text-center py-3"},Bw={__name:"ProjectList",setup(n){const e=je(),t=h(()=>e.orderedProjects);return(o,i)=>(a(),l("div",Rw,[t.value.length===0?(a(),l("div",Ww,' No projects yet. Click "New" to create one. ')):M("",!0),(a(!0),l(re,null,ce(t.value,r=>(a(),be(Pw,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},Fw={class:"flex-grow-1 overflow-auto p-3"},Hw={id:"sessions-container"},Vw={__name:"Sidebar",setup(n){const e=_e(),t=h(()=>e.sidebarCollapsed),o=h(()=>e.isMobile),i=h(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function r(){e.showModal("create-project")}const c=P(!1);function f(u){c.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",p)}function m(u){c.value&&e.setSidebarWidth(u.clientX)}function p(){c.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",p)}return(u,w)=>(a(),l("aside",{id:"sidebar",class:te(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value,"theme-red-panel":$e(e).isRedBackground,"bg-light":!$e(e).isRedBackground}]),style:ze(i.value)},[s("div",Fw,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),s("div",Hw,[pe(Bw)])]),s("div",{class:"sidebar-resize-handle",onMousedown:f},null,32)],6))}},Uw=ne(Vw,[["__scopeId","data-v-d26424cf"]]),qw={class:"task-row d-flex align-items-center gap-2"},zw={key:0,class:"status-icon"},Kw={key:1,class:"status-icon"},Gw=["title"],Yw={key:0,class:"task-details"},Jw={key:0,class:"task-description mb-2"},Qw={class:"description-content"},Xw={key:1,class:"task-owner mb-2"},Zw={class:"ms-1"},e$={key:2,class:"task-blocked-by mb-2"},t$={key:3,class:"task-blocks"},s$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=h(()=>e.task.status==="in_progress"),o=h(()=>e.task.status==="completed"?"âœ…":"â³"),i=h(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=h(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,f)=>(a(),l("div",{class:te(["task-item",r.value]),onClick:f[0]||(f[0]=m=>c.$emit("toggle"))},[s("div",qw,[t.value?(a(),l("span",zw,[...f[1]||(f[1]=[s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),l("span",Kw,y(o.value),1)),s("span",{class:"task-text flex-grow-1",title:n.task.subject},y(i.value),9,Gw),(a(),l("svg",{class:te(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),l("div",Yw,[n.task.description?(a(),l("div",Jw,[f[3]||(f[3]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",Qw,y(n.task.description),1)])):M("",!0),n.task.owner?(a(),l("div",Xw,[f[4]||(f[4]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",Zw,y(n.task.owner),1)])):M("",!0),n.task.blockedBy?.length>0?(a(),l("div",e$,[f[5]||(f[5]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),l(re,null,ce(n.task.blockedBy,m=>(a(),l("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+y(m),1))),128))])):M("",!0),n.task.blocks?.length>0?(a(),l("div",t$,[f[6]||(f[6]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),l(re,null,ce(n.task.blocks,m=>(a(),l("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+y(m),1))),128))])):M("",!0)])):M("",!0)],2))}},n$=ne(s$,[["__scopeId","data-v-0f96ae87"]]),o$={class:"task-list-panel"},i$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},a$={class:"d-flex align-items-center gap-2"},r$={key:0,class:"badge bg-secondary"},l$=["title"],c$={key:0,class:"task-list p-2"},u$={key:0,class:"text-muted text-center py-4"},d$={__name:"TaskListPanel",setup(n){const e=kt();_e();const t=P(new Set),o=P(!1),i=h(()=>e.currentTasks),r=h(()=>e.currentTaskStats);function c(){o.value=!o.value}function f(m){t.value.has(m)?t.value.delete(m):t.value.add(m),t.value=new Set(t.value)}return(m,p)=>(a(),l("div",o$,[s("div",i$,[s("div",a$,[p[0]||(p[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),p[1]||(p[1]=s("h6",{class:"mb-0"},"Tasks",-1)),r.value.total>0?(a(),l("span",r$,y(r.value.completed)+"/"+y(r.value.total),1)):M("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:c,title:o.value?"Expand":"Collapse"},[(a(),l("svg",{class:te(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...p[2]||(p[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,l$)]),o.value?M("",!0):(a(),l("div",c$,[i.value.length===0?(a(),l("div",u$,[...p[3]||(p[3]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):M("",!0),pe(Ti,{name:"task-list",tag:"div"},{default:ho(()=>[(a(!0),l(re,null,ce(i.value,u=>(a(),be(n$,{key:u.id,task:u,isExpanded:t.value.has(u.id),onToggle:w=>f(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},m$=ne(d$,[["__scopeId","data-v-c03a807a"]]),p$={class:"resource-gallery-panel"},f$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},v$={class:"d-flex align-items-center gap-2"},h$={key:0,class:"badge bg-secondary"},_$=["title"],g$={key:0,class:"resource-grid-container p-2"},b$={key:0,class:"text-muted text-center py-4"},y$={key:1,class:"resource-grid"},w$=["onClick","title"],$$=["src","alt"],k$=["title"],S$={class:"file-icon"},E$={class:"file-ext"},C$={class:"resource-info"},T$=["title"],x$={class:"resource-actions"},A$=["onClick"],M$=["href","download"],O$={__name:"ResourceGallery",setup(n){const e=Xe(),t=de(),o=fo("addAttachmentFromResource",null),i=P(!1),r=h(()=>e.currentResources),c=h(()=>e.currentResourceCount);function f(){i.value=!i.value}function m(_){return e.isImageResource(_)}function p(_){return e.getResourceIcon(_)}function u(_){const v=e.getResourceExtension(_);return v?v.toUpperCase().slice(1):""}function w(_){return e.getResourceUrl(t.currentSessionId,_)}function g(_){return e.getDownloadUrl(t.currentSessionId,_)}function k(_){e.openFullView(t.currentSessionId,_)}function $(_,v=18){return _?_.length<=v?_:_.substring(0,v-3)+"...":""}function b(_){_.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function d(_){o?o(_):console.warn("addAttachmentFromResource not provided")}return(_,v)=>(a(),l("div",p$,[s("div",f$,[s("div",v$,[v[1]||(v[1]=s("span",{class:"panel-icon"},"ðŸ“",-1)),v[2]||(v[2]=s("h6",{class:"mb-0"},"Resources",-1)),c.value>0?(a(),l("span",h$,y(c.value),1)):M("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:f,title:i.value?"Expand":"Collapse"},[(a(),l("svg",{class:te(["chevron-icon",{expanded:!i.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...v[3]||(v[3]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,_$)]),i.value?M("",!0):(a(),l("div",g$,[r.value.length===0?(a(),l("div",b$,[...v[4]||(v[4]=[s("span",{class:"empty-icon"},"ðŸ“‚",-1),s("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),l("div",y$,[(a(!0),l(re,null,ce(r.value,(T,E)=>(a(),l("div",{key:T.resource_id,class:te(["resource-item",{"is-image":m(T)}])},[m(T)?(a(),l("div",{key:0,class:"resource-thumbnail",onClick:R=>k(E),title:T.title||"Click to view"},[s("img",{src:w(T.resource_id),alt:T.title||"Image",loading:"lazy",onError:b},null,40,$$)],8,w$)):(a(),l("div",{key:1,class:"resource-placeholder",title:T.title||T.original_filename||"File"},[s("span",S$,y(p(T)),1),s("span",E$,y(u(T)),1)],8,k$)),s("div",C$,[s("div",{class:"resource-title",title:T.title||T.original_filename},y($(T.title||T.original_filename)),9,T$),s("div",x$,[s("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ve(R=>d(T),["stop"]),title:"Add to message attachments"},[...v[5]||(v[5]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,A$),s("a",{href:g(T.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:T.original_filename||T.title||"download",title:"Download",onClick:v[0]||(v[0]=ve(()=>{},["stop"]))},[...v[6]||(v[6]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),s("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,M$)])])],2))),128))]))]))]))}},D$=ne(O$,[["__scopeId","data-v-3bb063c1"]]),N$=["src","alt"],L$={key:1,class:"image-info"},I$={key:0,class:"image-title"},j$={key:1,class:"image-description"},P$={class:"image-meta"},R$={class:"meta-item"},W$={class:"meta-item"},B$={class:"meta-item"},F$={key:2,class:"position-indicator"},H$={key:3,class:"thumbnail-strip"},V$=["onClick"],U$=["src","alt"],q$={__name:"ImageFullView",setup(n){const e=Xe(),t=P(null),o=h(()=>e.fullViewOpen),i=h(()=>e.currentFullViewResource),r=h(()=>e.currentResourceIndex),c=h(()=>e.fullViewTotalResources),f=h(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]);fe(o,v=>{v?(St(()=>{t.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Ee(()=>{document.body.style.overflow=""});function m(v){return e.getResourceUrl(e.fullViewSessionId,v)}function p(){e.closeFullView()}function u(){e.nextResource()}function w(){e.prevResource()}function g(v){e.goToResource(v)}function k(v){v.target===v.currentTarget&&p()}function $(v){switch(v.key){case"Escape":p();break;case"ArrowLeft":w();break;case"ArrowRight":u();break;case"Home":g(0);break;case"End":g(c.value-1);break}}function b(v){return v?v<1024?`${v} B`:v<1024*1024?`${(v/1024).toFixed(1)} KB`:`${(v/(1024*1024)).toFixed(2)} MB`:""}function d(v){return v?new Date(v*1e3).toLocaleString():""}function _(v){v.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(v,T)=>(a(),be(Ai,{to:"body"},[pe(xi,{name:"modal"},{default:ho(()=>[o.value?(a(),l("div",{key:0,class:"image-full-view-overlay",onClick:k,onKeydown:$,tabindex:"0",ref_key:"overlayRef",ref:t},[s("button",{class:"close-btn",onClick:ve(p,["stop"]),title:"Close (Escape)"},[...T[1]||(T[1]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),c.value>1?(a(),l("button",{key:0,class:"nav-btn nav-prev",onClick:ve(w,["stop"]),title:"Previous (Left Arrow)"},[...T[2]||(T[2]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"15 18 9 12 15 6"})],-1)])])):M("",!0),s("div",{class:"image-container",onClick:T[0]||(T[0]=ve(()=>{},["stop"]))},[i.value?(a(),l("img",{key:0,src:m(i.value.resource_id||i.value.image_id),alt:i.value.title||"Image",class:"full-image",onError:_},null,40,N$)):M("",!0),i.value?(a(),l("div",L$,[i.value.title?(a(),l("h5",I$,y(i.value.title),1)):M("",!0),i.value.description?(a(),l("p",j$,y(i.value.description),1)):M("",!0),s("div",P$,[s("span",R$,y(b(i.value.size_bytes)),1),s("span",W$,y(i.value.format?.toUpperCase()),1),s("span",B$,y(d(i.value.timestamp)),1)])])):M("",!0)]),c.value>1?(a(),l("button",{key:1,class:"nav-btn nav-next",onClick:ve(u,["stop"]),title:"Next (Right Arrow)"},[...T[3]||(T[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"9 18 15 12 9 6"})],-1)])])):M("",!0),c.value>1?(a(),l("div",F$,y(r.value+1)+" / "+y(c.value),1)):M("",!0),c.value>1?(a(),l("div",H$,[(a(!0),l(re,null,ce(f.value,(E,R)=>(a(),l("div",{key:E.resource_id||E.image_id,class:te(["strip-thumbnail",{active:R===r.value}]),onClick:ve(I=>g(R),["stop"])},[s("img",{src:m(E.resource_id||E.image_id),alt:E.title||"Thumbnail",loading:"lazy"},null,8,U$)],10,V$))),128))])):M("",!0)],544)):M("",!0)]),_:1})]))}},z$=ne(q$,[["__scopeId","data-v-9bc36988"]]),K$={class:"panels-container"},G$={__name:"RightSidebar",setup(n){const e=_e(),t=h(()=>e.rightSidebarCollapsed),o=h(()=>e.isMobile),i=h(()=>{if(o.value)return{};const p=`${e.rightSidebarWidth}px`;return{width:p,minWidth:"200px",maxWidth:"30vw","--sidebar-width":p}}),r=P(!1);function c(p){p.preventDefault(),r.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",m)}function f(p){if(r.value){const u=window.innerWidth-p.clientX;e.setRightSidebarWidth(u)}}function m(){r.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",m)}return(p,u)=>(a(),l("aside",{id:"right-sidebar",class:te(["border-start d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,resizing:r.value,"theme-red-panel":$e(e).isRedBackground,"bg-light":!$e(e).isRedBackground}]),style:ze(i.value)},[s("div",K$,[pe(m$),pe(D$)]),s("div",{class:"sidebar-resize-handle",onMousedown:c},null,32),pe(z$)],6))}},Y$=ne(G$,[["__scopeId","data-v-cada6c72"]]),J$={class:"modal-dialog modal-lg"},Q$={class:"modal-content"},X$={class:"modal-body"},Z$={class:"mb-3"},ek={class:"input-group"},tk=["disabled"],sk={key:0,class:"text-center py-4"},nk={key:1,class:"alert alert-danger",role:"alert"},ok={key:2,class:"folder-list"},ik=["onClick","onDblclick"],ak={class:"d-flex align-items-center flex-grow-1"},rk=["onClick"],lk={key:1,class:"text-center text-muted py-3"},ck={class:"modal-footer"},uk=["disabled"],dk={__name:"FolderBrowserModal",setup(n){const e=_e(),t=P(""),o=P(""),i=P([]),r=P(!1),c=P(""),f=P(null);let m=null,p=null;const u=h(()=>{if(!t.value)return null;const T=t.value.split(/[\\/]/).filter(Boolean);return T.length<=1?null:(T.pop(),T.length>0?"/"+T.join("/"):"/")});function w(T){if(!T)return"";const E=T.split(/[\\/]/).filter(Boolean);return E.length<=2?T:".../"+E.slice(-2).join("/")}async function g(){r.value=!0,c.value="",i.value=[],o.value="";try{const T=t.value?{path:t.value}:{},E=await me.get("/api/filesystem/browse",{params:T});E.current_path&&(t.value=E.current_path),i.value=E.directories||[]}catch(T){console.error("Failed to load directory:",T),c.value=T.message||"Failed to load directory"}finally{r.value=!1}}function k(T){o.value=T.path}function $(T){t.value=T.path,o.value="",g()}function b(){u.value&&(t.value=u.value,o.value="",g())}function d(){const T=o.value||t.value;T&&p&&p(T),m&&m.hide()}function _(){g()}function v(){i.value=[],o.value="",c.value="",p=null,e.hideModal()}return fe(()=>e.currentModal,T=>{if(T?.name==="folder-browser"&&m){const E=T.data||{};t.value=E.defaultPath||E.currentPath||"",p=E.onSelect||null,m.show()}}),ye(()=>{f.value&&xe(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{m=new T(f.value),f.value.addEventListener("shown.bs.modal",_),f.value.addEventListener("hidden.bs.modal",v)})}),Ee(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",_),f.value.removeEventListener("hidden.bs.modal",v)),m&&m.dispose()}),(T,E)=>(a(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[s("div",J$,[s("div",Q$,[E[6]||(E[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",X$,[s("div",Z$,[E[1]||(E[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",ek,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=R=>t.value=R),onKeyup:qe(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:g,disabled:r.value}," ðŸ”„ Refresh ",8,tk)])]),r.value?(a(),l("div",sk,[...E[2]||(E[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(a(),l("div",nk,y(c.value),1)):(a(),l("div",ok,[u.value?(a(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...E[3]||(E[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):M("",!0),(a(!0),l(re,null,ce(i.value,R=>(a(),l("div",{key:R.path,class:te(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:R.path===o.value}]),onClick:I=>k(R),onDblclick:I=>$(R),role:"button"},[s("div",ak,[E[4]||(E[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,y(R.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:ve(I=>$(R),["stop"])}," Open ",8,rk)],42,ik))),128)),i.value.length===0?(a(),l("div",lk," No subdirectories found ")):M("",!0)]))]),s("div",ck,[E[5]||(E[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:d,disabled:!o.value},' Select "'+y(w(o.value||t.value))+'" ',9,uk)])])])],512))}},mk=ne(dk,[["__scopeId","data-v-0d61ed46"]]),pk={class:"modal-dialog"},fk={class:"modal-content"},vk={class:"modal-body"},hk={class:"mb-3"},_k={key:0,class:"invalid-feedback"},gk={class:"mb-3"},bk={class:"input-group"},yk={key:0,class:"invalid-feedback"},wk={class:"mb-3 form-check"},$k={key:0,class:"mb-3 ms-4"},kk={key:1,class:"alert alert-danger",role:"alert"},Sk={class:"modal-footer"},Ek=["disabled"],Ck={key:0,class:"spinner-border spinner-border-sm me-2"},Tk={__name:"ProjectCreateModal",setup(n){const e=je(),t=de(),o=_e(),i=P({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=P({name:"",workingDirectory:""}),c=P(!1),f=P(""),m=P(null);let p=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:d=>{i.value.workingDirectory=d,r.value.workingDirectory=""}})}function w(){r.value={};let d=!0;return i.value.name.trim()||(r.value.name="Project name is required",d=!1),i.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",d=!1),d}async function g(){if(w()){c.value=!0,f.value="";try{const d=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(d.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),k()}catch(d){console.error("Failed to create project:",d),f.value=d.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function k(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},f.value=""}function $(){const d=document.getElementById("projectName");d&&d.focus()}function b(){k(),o.hideModal()}return fe(()=>o.currentModal,d=>{d?.name==="create-project"&&p&&p.show()}),ye(()=>{m.value&&xe(async()=>{const{default:d}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:d}},__vite__mapDeps([0,1])).then(({default:d})=>{p=new d(m.value),m.value.addEventListener("shown.bs.modal",$),m.value.addEventListener("hidden.bs.modal",b)})}),Ee(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",$),m.value.removeEventListener("hidden.bs.modal",b)),p&&p.dispose()}),(d,_)=>(a(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[s("div",pk,[s("div",fk,[_[11]||(_[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",vk,[s("form",{onSubmit:ve(g,["prevent"])},[s("div",hk,[_[4]||(_[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":_[0]||(_[0]=v=>i.value.name=v),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),r.value.name?(a(),l("div",_k,y(r.value.name),1)):M("",!0)]),s("div",gk,[_[5]||(_[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",bk,[ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":_[1]||(_[1]=v=>i.value.workingDirectory=v),placeholder:"/path/to/project",required:""},null,2),[[We,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),r.value.workingDirectory?(a(),l("div",yk,y(r.value.workingDirectory),1)):M("",!0)]),_[6]||(_[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",wk,[ge(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":_[2]||(_[2]=v=>i.value.createSession=v)},null,512),[[Mi,i.value.createSession]]),_[7]||(_[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),_[8]||(_[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),l("div",$k,[_[9]||(_[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ge(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":_[3]||(_[3]=v=>i.value.sessionName=v),placeholder:"main"},null,512),[[We,i.value.sessionName]])])):M("",!0),f.value?(a(),l("div",kk,y(f.value),1)):M("",!0)],32)]),s("div",Sk,[_[10]||(_[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:c.value},[c.value?(a(),l("span",Ck)):M("",!0),ie(" "+y(c.value?"Creating...":"Create Project"),1)],8,Ek)])])])],512))}},xk=ne(Tk,[["__scopeId","data-v-ea55fdae"]]),Ak={class:"modal-dialog"},Mk={class:"modal-content"},Ok={class:"modal-body"},Dk={class:"mb-3"},Nk={key:0,class:"invalid-feedback"},Lk={class:"mb-3"},Ik=["value"],jk={key:0,class:"alert alert-danger",role:"alert"},Pk={class:"danger-zone"},Rk={class:"text-muted small"},Wk=["disabled"],Bk={key:0,class:"alert alert-warning mt-3",role:"alert"},Fk={class:"mb-2"},Hk={class:"d-flex gap-2"},Vk=["disabled"],Uk={key:0,class:"spinner-border spinner-border-sm me-2"},qk=["disabled"],zk={class:"modal-footer"},Kk=["disabled"],Gk={key:0,class:"spinner-border spinner-border-sm me-2"},Yk={__name:"ProjectEditModal",setup(n){const e=je(),t=_e(),o=P(null),i=P({name:""}),r=P({name:""}),c=P(!1),f=P(!1),m=P(""),p=P(!1),u=P(null);let w=null;const g=h(()=>o.value?.session_ids?.length||0);function k(){r.value={};let T=!0;return i.value.name.trim()||(r.value.name="Project name is required",T=!1),T}async function $(){if(!(!k()||!o.value)){c.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),w&&w.hide()}catch(T){console.error("Failed to update project:",T),m.value=T.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function b(){if(o.value){f.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(T){console.error("Failed to delete project:",T),m.value=T.message||"Failed to delete project. Please try again."}finally{f.value=!1}}}function d(){i.value={name:""},r.value={},m.value="",p.value=!1}function _(){const T=document.getElementById("editProjectName");T&&(T.focus(),T.select())}function v(){d(),o.value=null,t.hideModal()}return fe(()=>t.currentModal,T=>{if(T?.name==="edit-project"&&w){const E=T.data||{};o.value=E.project,o.value&&(i.value.name=o.value.name),w.show()}}),ye(()=>{u.value&&xe(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{w=new T(u.value),u.value.addEventListener("shown.bs.modal",_),u.value.addEventListener("hidden.bs.modal",v)})}),Ee(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",_),u.value.removeEventListener("hidden.bs.modal",v)),w&&w.dispose()}),(T,E)=>(a(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",Ak,[s("div",Mk,[E[10]||(E[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Ok,[s("form",{onSubmit:ve($,["prevent"])},[s("div",Dk,[E[3]||(E[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":E[0]||(E[0]=R=>i.value.name=R),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),r.value.name?(a(),l("div",Nk,y(r.value.name),1)):M("",!0)]),s("div",Lk,[E[4]||(E[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Ik),E[5]||(E[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(a(),l("div",jk,y(m.value),1)):M("",!0)],32),E[8]||(E[8]=s("hr",null,null,-1)),s("div",Pk,[E[6]||(E[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",Rk," Deleting this project will also delete all "+y(g.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:E[1]||(E[1]=R=>p.value=!0),disabled:f.value}," ðŸ—‘ï¸ Delete Project ",8,Wk)]),p.value?(a(),l("div",Bk,[E[7]||(E[7]=s("strong",null,"Are you sure?",-1)),s("p",Fk,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(g.value)+" session(s). ",1),s("div",Hk,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:f.value},[f.value?(a(),l("span",Uk)):M("",!0),ie(" "+y(f.value?"Deleting...":"Yes, Delete Permanently"),1)],8,Vk),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:E[2]||(E[2]=R=>p.value=!1),disabled:f.value}," Cancel ",8,qk)])])):M("",!0)]),s("div",zk,[E[9]||(E[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:$,disabled:c.value},[c.value?(a(),l("span",Gk)):M("",!0),ie(" "+y(c.value?"Saving...":"Save Changes"),1)],8,Kk)])])])],512))}},Jk=ne(Yk,[["__scopeId","data-v-52679516"]]),Qk={class:"general-tab"},Xk={key:0,class:"mb-3"},Zk={for:"template-select",class:"form-label"},eS=["value"],tS=["value"],sS={key:0,class:"form-text"},nS={class:"mb-3"},oS={for:"config-name",class:"form-label"},iS=["value","placeholder","pattern","title"],aS={key:0,class:"invalid-feedback"},rS={key:1,class:"form-text"},lS={key:1,class:"mb-3"},cS=["value"],uS={class:"mb-3"},dS=["value"],mS={class:"form-text"},pS={key:0,class:"text-warning"},fS={key:1},vS={class:"mb-3"},hS={for:"config-permission-mode",class:"form-label"},_S={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},gS={key:1,class:"field-indicator modified",title:"Modified from template"},bS=["value","disabled"],yS={key:0,value:"bypassPermissions"},wS={class:"form-text"},$S={key:0,class:"text-warning"},kS={key:1},SS={class:"mb-3"},ES={for:"config-role",class:"form-label"},CS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},TS={key:1,class:"field-indicator modified",title:"Modified from template"},xS=["value","placeholder"],AS={class:"form-text"},MS={key:2,class:"mb-3"},OS={class:"input-group"},DS=["value","placeholder","disabled","readonly"],NS={class:"form-text"},LS={key:3,class:"mb-3"},IS={class:"form-control-plaintext"},jS={key:4,class:"mb-3 form-check"},PS=["checked"],RS={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=h(()=>e.mode==="create-session"||e.mode==="edit-session"),o=h(()=>e.mode==="create-template"||e.mode==="edit-template"),i=h(()=>e.mode==="create-session"),r=h(()=>e.mode==="edit-session"),c=h(()=>e.session?.state==="active"||e.session?.state==="starting"),f=h(()=>{if(!e.session)return!1;const b=e.session.model||"sonnet";return e.formData.model!==b}),m=h(()=>e.session?.initial_permission_mode==="bypassPermissions"),p=h(()=>e.selectedTemplateId?e.templates.find(b=>b.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},w=h(()=>u[e.formData.model]||null),g=h(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),k=h(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function $(b){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[b]||"bg-secondary"}return(b,d)=>(a(),l("div",Qk,[i.value?(a(),l("div",Xk,[s("label",Zk,[d[10]||(d[10]=ie(" Template ",-1)),s("button",{type:"button",onClick:d[0]||(d[0]=_=>b.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:d[1]||(d[1]=_=>b.$emit("update:selected-template-id",_.target.value||null)),class:"form-select"},[d[11]||(d[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),l(re,null,ce(n.templates,_=>(a(),l("option",{key:_.template_id,value:_.template_id},y(_.name),9,tS))),128))],40,eS),p.value?(a(),l("div",sS,y(p.value.description),1)):M("",!0)])):M("",!0),s("div",nS,[s("label",oS,[ie(y(o.value?"Template Name":"Session Name")+" ",1),d[12]||(d[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:te(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:d[2]||(d[2]=_=>b.$emit("update:form-data","name",_.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,iS),n.errors.name?(a(),l("div",aS,y(n.errors.name),1)):M("",!0),t.value?(a(),l("div",rS,"Must be a single word (no spaces) for #nametag matching")):M("",!0)]),o.value?(a(),l("div",lS,[d[13]||(d[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:d[3]||(d[3]=_=>b.$emit("update:form-data","description",_.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,cS)])):M("",!0),s("div",uS,[d[16]||(d[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:d[4]||(d[4]=_=>b.$emit("update:form-data","model",_.target.value))},[...d[14]||(d[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,dS),s("div",mS,[r.value&&c.value&&f.value?(a(),l("span",pS,[...d[15]||(d[15]=[ie(" Model change requires a ",-1),s("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):w.value?(a(),l("span",fS,y(w.value.description),1)):M("",!0)])]),s("div",vS,[s("label",hS,[d[17]||(d[17]=ie(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),l("span",_S," < ")):M("",!0),n.fieldStates.permission_mode==="modified"?(a(),l("span",gS," * ")):M("",!0)]),s("select",{id:"config-permission-mode",class:te(["form-select",k.value]),value:n.formData.permission_mode,onChange:d[5]||(d[5]=_=>b.$emit("update:form-data","permission_mode",_.target.value)),disabled:r.value&&!c.value},[d[18]||(d[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),d[19]||(d[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),d[20]||(d[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||m.value?(a(),l("option",yS," Bypass Permissions (No prompts - use with caution) ")):M("",!0)],42,bS),s("div",wS,[r.value&&!c.value?(a(),l("span",$S," Session must be active to change permission mode. Start the session first. ")):(a(),l("span",kS,"Controls which tool actions require permission prompts"))])]),s("div",SS,[s("label",ES,[ie(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),l("span",CS," < ")):M("",!0),n.fieldStates.default_role==="modified"?(a(),l("span",TS," * ")):M("",!0)]),s("input",{id:"config-role",type:"text",class:te(["form-control",g.value]),value:n.formData.default_role,onInput:d[6]||(d[6]=_=>b.$emit("update:form-data","default_role",_.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,xS),s("div",AS,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(a(),l("div",MS,[d[21]||(d[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",OS,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:d[7]||(d[7]=_=>b.$emit("update:form-data","working_directory",_.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,DS),r.value?M("",!0):(a(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:d[8]||(d[8]=_=>b.$emit("open-folder-browser"))}," Browse "))]),s("div",NS,y(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):M("",!0),r.value&&n.session?(a(),l("div",LS,[d[22]||(d[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",IS,[s("span",{class:te(["badge",$(n.session.state)])},y(n.session.state),3)])])):M("",!0),i.value?(a(),l("div",jS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:d[9]||(d[9]=_=>b.$emit("update:form-data","startImmediately",_.target.checked))},null,40,PS),d[23]||(d[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):M("",!0)]))}},WS=ne(RS,[["__scopeId","data-v-b9edc342"]]),BS={class:"permissions-tab"},FS={class:"mb-3"},HS={for:"config-allowed-tools",class:"form-label"},VS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},US={key:1,class:"field-indicator modified",title:"Modified from template"},qS={key:0,class:"tools-list mb-2"},zS=["onClick"],KS={class:"input-group input-group-sm"},GS=["onKeydown"],YS=["disabled"],JS={class:"mt-2"},QS=["onClick"],XS={class:"form-text"},ZS={key:0,class:"text-warning"},eE={key:1},tE={class:"mb-3"},sE={class:"capabilities-editor"},nE={key:0,class:"capabilities-list mb-2"},oE=["onClick"],iE={class:"input-group input-group-sm"},aE=["onKeydown"],rE=["disabled"],lE={key:0,class:"mb-3"},cE={class:"settings-sources-editor"},uE={class:"form-check"},dE=["checked"],mE={class:"form-check"},pE=["checked"],fE={class:"form-check"},vE=["checked"],hE={class:"form-text"},_E={key:0,class:"text-warning"},gE={key:1},bE={key:1,class:"mb-3"},yE={class:"mb-3"},wE={key:0,class:"mt-2"},$E=["value"],kE=["value"],SE={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=P(""),r=P(""),c=P(!1),f=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=h(()=>t.mode==="create-template"||t.mode==="edit-template"),p=h(()=>t.mode==="create-session"||t.mode==="edit-session"),u=h(()=>t.mode==="edit-session"),w=h(()=>t.session?.state==="active"||t.session?.state==="starting"),g=h(()=>{if(!t.session)return!1;const x=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==x}),k=h(()=>t.formData.setting_sources||["user","project","local"]),$=h(()=>{if(!t.session)return!1;const x=t.session.setting_sources||["user","project","local"],A=t.formData.setting_sources||["user","project","local"];return JSON.stringify(x.sort())!==JSON.stringify(A.sort())}),b=h(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(x=>x.trim()).filter(x=>x.length>0)),d=h(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(x=>x.trim()).filter(x=>x.length>0)),_=h(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),v=h(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function T(){const x=i.value.trim();if(x){if(!b.value.includes(x)){const A=[...b.value,x];o("update:form-data","allowed_tools",A.join(", "))}i.value=""}}function E(x){const A=[...b.value];A.splice(x,1),o("update:form-data","allowed_tools",A.join(", "))}function R(x){if(b.value.includes(x)){const A=b.value.indexOf(x);E(A)}else{const A=[...b.value,x];o("update:form-data","allowed_tools",A.join(", "))}}function I(){const x=r.value.trim().toLowerCase();if(x){if(!d.value.includes(x)){const A=[...d.value,x];o("update:form-data","capabilities",A.join(", "))}r.value=""}}function O(x){const A=[...d.value];A.splice(x,1),o("update:form-data","capabilities",A.join(", "))}function H(x){const A=[...k.value],W=A.indexOf(x);W>=0?A.splice(W,1):A.push(x),o("update:form-data","setting_sources",A)}return(x,A)=>(a(),l("div",BS,[s("div",FS,[s("label",HS,[A[9]||(A[9]=ie(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),l("span",VS," < ")):M("",!0),n.fieldStates.allowed_tools==="modified"?(a(),l("span",US," * ")):M("",!0)]),s("div",{class:te(["allowed-tools-editor",v.value])},[b.value.length>0?(a(),l("div",qS,[(a(!0),l(re,null,ce(b.value,(W,K)=>(a(),l("span",{key:K,class:"badge bg-primary me-1 mb-1 tool-badge"},[ie(y(W)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>E(K),"aria-label":"Remove tool"},null,8,zS)]))),128))])):M("",!0),s("div",KS,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":A[0]||(A[0]=W=>i.value=W),onKeydown:qe(ve(T,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,GS),[[We,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:T,disabled:!i.value.trim()}," Add ",8,YS)]),s("div",JS,[A[10]||(A[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),l(re,null,ce(f,W=>s("button",{key:W,type:"button",class:te(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":b.value.includes(W)}]),onClick:K=>R(W)},y(W),11,QS)),64))])],2),s("div",XS,[u.value&&w.value&&g.value?(a(),l("span",ZS,[...A[11]||(A[11]=[ie(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):(a(),l("span",eE,y(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",tE,[A[12]||(A[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",sE,[d.value.length>0?(a(),l("div",nE,[(a(!0),l(re,null,ce(d.value,(W,K)=>(a(),l("span",{key:K,class:"badge bg-info me-1 mb-1 capability-badge"},[ie(y(W)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>O(K),"aria-label":"Remove capability"},null,8,oE)]))),128))])):M("",!0),s("div",iE,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":A[1]||(A[1]=W=>r.value=W),onKeydown:qe(ve(I,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,aE),[[We,r.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:I,disabled:!r.value.trim()}," Add ",8,rE)])]),A[13]||(A[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),p.value?(a(),l("div",lE,[A[18]||(A[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",cE,[s("div",uE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:k.value.includes("user"),onChange:A[2]||(A[2]=W=>H("user"))},null,40,dE),A[14]||(A[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[ie(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",mE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:k.value.includes("project"),onChange:A[3]||(A[3]=W=>H("project"))},null,40,pE),A[15]||(A[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[ie(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",fE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:k.value.includes("local"),onChange:A[4]||(A[4]=W=>H("local"))},null,40,vE),A[16]||(A[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[ie(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",hE,[u.value&&w.value&&$.value?(a(),l("span",_E,[...A[17]||(A[17]=[ie(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),ie(" to take effect. ",-1)])])):(a(),l("span",gE," Select which settings files to load permissions from "))])])):M("",!0),p.value?(a(),l("div",bE,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:A[5]||(A[5]=W=>x.$emit("preview-permissions"))}," Preview Effective Permissions ")])):M("",!0),s("div",yE,[s("a",{class:"text-muted small",role:"button",onClick:A[6]||(A[6]=W=>c.value=!c.value)},y(c.value?"Hide":"Show")+" raw input ",1),c.value?(a(),l("div",wE,[A[19]||(A[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:te(["form-control form-control-sm",_.value]),value:n.formData.allowed_tools,onInput:A[7]||(A[7]=W=>x.$emit("update:form-data","allowed_tools",W.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,$E),A[20]||(A[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:A[8]||(A[8]=W=>x.$emit("update:form-data","capabilities",W.target.value)),placeholder:"python, testing, debugging"},null,40,kE)])):M("",!0)])]))}},EE=ne(SE,[["__scopeId","data-v-e58aa2be"]]),CE={class:"advanced-tab"},TE={key:0,class:"alert alert-warning mb-3",role:"alert"},xE={class:"mb-3"},AE={for:"config-system-prompt",class:"form-label"},ME={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},OE={key:1,class:"field-indicator modified",title:"Modified from template"},DE=["value","rows","placeholder"],NE={class:"form-text"},LE={class:"mb-3 form-check"},IE=["checked"],jE={key:0,class:"form-text text-warning"},PE={key:1,class:"mb-3 form-check"},RE=["checked"],WE={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=h(()=>t.mode==="create-session"||t.mode==="edit-session"),r=h(()=>t.mode==="create-template"||t.mode==="edit-template"),c=h(()=>t.mode==="edit-session"),f=h(()=>t.session?.state==="active"||t.session?.state==="starting"),m=h(()=>{if(!t.session)return!1;const $=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),b=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),d=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return $||b||d}),p=h(()=>r.value?t.formData.system_prompt:t.formData.initialization_context),u=h(()=>r.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),w=h(()=>t.formData.override_system_prompt?r.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":r.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),g=h(()=>{const $={};return t.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$});function k($){const b=$.target.value,d=r.value?"system_prompt":"initialization_context";o("update:form-data",d,b)}return($,b)=>(a(),l("div",CE,[c.value&&f.value&&m.value?(a(),l("div",TE,[...b[2]||(b[2]=[s("small",null,[ie("Changes to these settings require a "),s("strong",null,"reset"),ie(" (not restart) to take effect.")],-1)])])):M("",!0),s("div",xE,[s("label",AE,[ie(y(r.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),l("span",ME," < ")):M("",!0),n.fieldStates.initialization_context==="modified"?(a(),l("span",OE," * ")):M("",!0)]),s("textarea",{id:"config-system-prompt",class:te(["form-control",g.value]),value:p.value,onInput:k,rows:r.value?4:5,placeholder:u.value},null,42,DE),s("div",NE,y(w.value),1)]),s("div",LE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:b[0]||(b[0]=d=>$.$emit("update:form-data","override_system_prompt",d.target.checked))},null,40,IE),b[3]||(b[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),l("div",jE,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(r.value?"":" or legion guide")+").",1)])):M("",!0)]),i.value?(a(),l("div",PE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:b[1]||(b[1]=d=>$.$emit("update:form-data","sandbox_enabled",d.target.checked))},null,40,RE),b[4]||(b[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:te(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):M("",!0)]))}},BE=ne(WE,[["__scopeId","data-v-08b1f06d"]]),FE={class:"modal-dialog modal-lg"},HE={class:"modal-content"},VE={class:"modal-body"},UE={key:0,class:"text-center py-4"},qE={key:1,class:"alert alert-danger"},zE={key:2},KE={class:"mb-3"},GE={class:"small text-muted mb-2"},YE={key:0},JE={key:0,class:"alert alert-info"},QE={key:1},XE={class:"table table-sm table-striped"},ZE={key:2,class:"mt-3"},eC={class:"modal-footer"},tC=["disabled"],sC={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=P(null);let c=null;const f=P(!1),m=P(""),p=P([]);fe(r,b=>{b&&(c=new ft(b),b.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){c&&(c.show(),g())}function w(){c&&c.hide()}async function g(){f.value=!0,m.value="",p.value=[];try{const b=await me.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});p.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),m.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{f.value=!1}}function k(){g()}function $(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:w}),(b,d)=>(a(),l("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",FE,[s("div",HE,[d[7]||(d[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",VE,[f.value?(a(),l("div",UE,[...d[0]||(d[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(a(),l("div",qE,y(m.value),1)):(a(),l("div",zE,[s("div",KE,[d[2]||(d[2]=s("h6",null,"Settings Sources",-1)),s("div",GE,[d[1]||(d[1]=ie(" Loading permissions from: ",-1)),(a(!0),l(re,null,ce(n.settingSources,(_,v)=>(a(),l("span",{key:_},[s("code",null,y(_),1),v<n.settingSources.length-1?(a(),l("span",YE,", ")):M("",!0)]))),128))])]),p.value.length===0?(a(),l("div",JE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),l("div",QE,[s("h6",null,"Pre-approved Permissions ("+y(p.value.length)+")",1),s("table",XE,[d[3]||(d[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(a(!0),l(re,null,ce(p.value,_=>(a(),l("tr",{key:_.permission},[s("td",null,[s("code",null,y(_.permission),1)]),s("td",null,[(a(!0),l(re,null,ce(_.sources,(v,T)=>(a(),l("span",{key:v,class:te(["badge me-1",$(v)])},y(v),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),l("div",ZE,[d[4]||(d[4]=s("h6",null,"Session Allowed Tools",-1)),d[5]||(d[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(a(!0),l(re,null,ce(n.sessionAllowedTools,_=>(a(),l("span",{key:_,class:"badge bg-success me-1 mb-1"},y(_),1))),128))])])):M("",!0)]))]),s("div",eC,[d[6]||(d[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:k,disabled:f.value}," Refresh ",8,tC)])])])],512))}},nC=ne(sC,[["__scopeId","data-v-988ff7c4"]]),oC={class:"modal-dialog modal-lg modal-dialog-centered"},iC={class:"modal-content"},aC={class:"modal-header"},rC={id:"configurationModalLabel",class:"modal-title"},lC={class:"modal-body"},cC={key:0,class:"template-list-view"},uC={key:0,class:"alert alert-info"},dC={class:"card-body"},mC={class:"d-flex justify-content-between align-items-start"},pC={class:"flex-grow-1"},fC={class:"card-title mb-1"},vC={key:0,class:"card-text text-muted small mb-2"},hC={class:"template-meta"},_C={class:"badge bg-secondary me-2"},gC={class:"text-muted small"},bC={class:"btn-group btn-group-sm ms-3"},yC=["onClick"],wC=["onClick"],$C={key:1},kC={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},SC={class:"nav-item",role:"presentation"},EC={key:0,class:"error-indicator",title:"This tab has validation errors"},CC={class:"nav-item",role:"presentation"},TC={key:0,class:"error-indicator",title:"This tab has validation errors"},xC={class:"nav-item",role:"presentation"},AC={key:0,class:"error-indicator",title:"This tab has validation errors"},MC={class:"tab-content"},OC={key:2,class:"alert alert-danger mt-3"},DC={class:"modal-footer"},NC={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},LC=["disabled"],IC={key:0,class:"spinner-border spinner-border-sm me-2"},jC={__name:"ConfigurationModal",setup(n){const e=Ft(),t=je(),o=de(),i=_e(),r=P(null);let c=null;const f=P(null),m=P("create-session"),p=P("general"),u=P(null),w=P(null),g=P(null),k=P([]),$=P(null),b=P(null),d=P({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),_=ws({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),v=ws({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),T=ws({name:""}),E=h(()=>({general:!!T.name,permissions:!1,advanced:!1})),R=P(!1),I=P(""),O=h(()=>m.value==="create-session"||m.value==="edit-session"),H=h(()=>m.value==="edit-session"||m.value==="edit-template"),x=h(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),A=h(()=>R.value?H.value?"Saving...":"Creating...":H.value?"Save Changes":O.value?"Create Session":"Save Template"),W=h(()=>!(!v.name.trim()||O.value&&v.name.includes(" "))),K=h(()=>w.value?.working_directory?w.value.working_directory:v.working_directory?v.working_directory:t.projects.get(u.value)?.working_directory||""),L=h(()=>!v.allowed_tools||!v.allowed_tools.trim()?[]:v.allowed_tools.split(",").map(G=>G.trim()).filter(G=>G.length>0));function B(){f.value&&f.value.show()}function q(G,le){v[G]=le,G==="name"&&(T.name="")}function Z(G){$.value=G,N()}async function D(){try{const G=await me.get("/api/templates");k.value=G||[]}catch(G){console.error("Failed to load templates:",G),k.value=[]}}function N(){if(!$.value){v.default_role="",v.initialization_context="",v.permission_mode="default",v.allowed_tools="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",d.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const G=k.value.find(le=>le.template_id===$.value);if(G)if(_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",G.default_role?(v.default_role=G.default_role,d.value.default_role=G.default_role,_.default_role="autofilled"):(v.default_role="",d.value.default_role=null),G.default_system_prompt?(v.initialization_context=G.default_system_prompt,d.value.initialization_context=G.default_system_prompt,_.initialization_context="autofilled"):(v.initialization_context="",d.value.initialization_context=null),G.permission_mode?(v.permission_mode=G.permission_mode,d.value.permission_mode=G.permission_mode,_.permission_mode="autofilled"):(v.permission_mode="default",d.value.permission_mode=null),G.allowed_tools&&G.allowed_tools.length>0){const le=G.allowed_tools.join(", ");v.allowed_tools=le,d.value.allowed_tools=le,_.allowed_tools="autofilled"}else v.allowed_tools="",d.value.allowed_tools=null}function S(){const le=(u.value?t.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:le,currentPath:v.working_directory||"",onSelect:ue=>{v.working_directory=ue}})}function C(){m.value==="create-session"&&(b.value={mode:"create-session",projectId:u.value,formData:{...v},selectedTemplateId:$.value}),m.value="template-list",ee()}function F(){m.value="create-template",ee(),p.value="general"}function J(G){m.value="edit-template",g.value=G,ee(),he(G),p.value="general"}async function z(G){if(confirm(`Delete template "${G.name}"?

This action cannot be undone.`))try{await me.delete(`/api/templates/${G.template_id}`),await D()}catch(le){console.error("Failed to delete template:",le),I.value=le.response?.data?.detail||"Failed to delete template"}}function Q(){let G=!0;return T.name="",v.name.trim()||(T.name="Name is required",G=!1),O.value&&v.name.includes(" ")&&(T.name="Session name must be a single word (no spaces)",G=!1),G}async function se(){if(!Q()){T.name&&(p.value="general");return}R.value=!0,I.value="";try{switch(m.value){case"create-session":await X(),c&&c.hide();break;case"edit-session":await V(),c&&c.hide();break;case"create-template":await j();break;case"edit-template":await U();break}}catch(G){console.error("Submit failed:",G),I.value=G.response?.data?.detail||G.message||"Operation failed. Please try again."}finally{R.value=!1}}async function X(){if(!u.value)throw new Error("Project ID is missing");const G=v.allowed_tools.split(",").map(Re=>Re.trim()).filter(Re=>Re.length>0),le=v.capabilities.split(",").map(Re=>Re.trim()).filter(Re=>Re.length>0),ue={name:v.name.trim(),model:v.model||null,role:v.default_role.trim()||null,initialization_context:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,capabilities:le.length>0?le:null,permission_mode:v.permission_mode,allowed_tools:G.length>0?G:null,working_directory:v.working_directory.trim()||null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources},Te=await me.post(`/api/legions/${u.value}/minions`,ue);if(Te.success&&Te.minion_id)await t.fetchProjects(),await o.fetchSessions(),v.startImmediately&&await o.startSession(Te.minion_id),e.push(`/session/${Te.minion_id}`);else throw new Error("Failed to create session")}async function V(){if(!w.value)throw new Error("Session data is missing");const G=w.value.session_id,le=w.value.state==="active"||w.value.state==="starting",ue=v.allowed_tools.split(",").map(we=>we.trim()).filter(we=>we.length>0),Te=v.capabilities.split(",").map(we=>we.trim()).filter(we=>we.length>0),Re={name:v.name.trim(),model:v.model,role:v.default_role.trim()||null,system_prompt:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,allowed_tools:ue.length>0?ue:null,capabilities:Te.length>0?Te:null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources};await o.patchSession(G,Re),le&&v.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(G,v.permission_mode)}async function j(){const G=v.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),le={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:G.length>0?G:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null};await me.post("/api/templates",le),await D(),m.value="template-list",ee()}async function U(){if(!g.value)throw new Error("Template data is missing");const G=v.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),le={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:G.length>0?G:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null};await me.put(`/api/templates/${g.value.template_id}`,le),await D(),m.value="template-list",g.value=null,ee()}function ee(){v.name="",v.model="sonnet",v.permission_mode="default",v.working_directory="",v.description="",v.default_role="",v.startImmediately=!0,v.allowed_tools="",v.capabilities="",v.setting_sources=["user","project","local"],v.system_prompt="",v.override_system_prompt=!1,v.initialization_context="",v.sandbox_enabled=!1,T.name="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",d.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},$.value=null,I.value="",p.value="general"}function oe(G){v.name=G.name||"",v.model=G.model||"sonnet",v.permission_mode=G.current_permission_mode||"default",v.working_directory=G.working_directory||"",v.default_role=G.role||"",v.initialization_context=G.system_prompt||"",v.override_system_prompt=G.override_system_prompt||!1,v.system_prompt="",v.allowed_tools=G.allowed_tools?.join(", ")||"",v.capabilities=G.capabilities?.join(", ")||"",v.sandbox_enabled=G.sandbox_enabled||!1,v.setting_sources=G.setting_sources||["user","project","local"]}function he(G){v.name=G.name||"",v.description=G.description||"",v.permission_mode=G.permission_mode||"default",v.default_role=G.default_role||"",v.initialization_context=G.default_system_prompt||"",v.allowed_tools=G.allowed_tools?.join(", ")||""}function rt(){St(()=>{const G=document.getElementById("config-name");G&&(G.focus(),H.value&&G.select())})}function Fe(){ee(),m.value="create-session",u.value=null,w.value=null,g.value=null,i.hideModal()}return fe(()=>i.currentModal,async(G,le)=>{if(!(!G||!c)){if(G.name==="configuration"){const ue=G.data||{};m.value=ue.mode||"create-session",u.value=ue.project?.project_id||ue.projectId||null,w.value=ue.session||null,g.value=ue.template||null,ee(),m.value==="create-session"&&await D(),m.value==="edit-session"&&w.value?oe(w.value):m.value==="edit-template"&&g.value&&he(g.value),c.show()}else if(G.name==="create-minion"||G.name==="create-session"){const ue=G.data||{};m.value="create-session",u.value=ue.project?.project_id||null,w.value=null,g.value=null,ee(),await D(),c.show()}else if(G.name==="edit-session"){const ue=G.data||{};m.value="edit-session",w.value=ue.session||null,u.value=w.value?.project_id||null,g.value=null,ee(),w.value&&oe(w.value),c.show()}else G.name==="template-management"&&(m.value="template-list",ee(),await D(),c.show());le?.name==="configuration"&&le.data?.mode?.includes("template")&&G?.name==="configuration"&&m.value==="create-session"&&await D()}}),fe(()=>v.default_role,G=>{d.value.default_role!==null&&(_.default_role=G===d.value.default_role?"autofilled":"modified")}),fe(()=>v.initialization_context,G=>{d.value.initialization_context!==null&&(_.initialization_context=G===d.value.initialization_context?"autofilled":"modified")}),fe(()=>v.permission_mode,G=>{d.value.permission_mode!==null&&(_.permission_mode=G===d.value.permission_mode?"autofilled":"modified")}),fe(()=>v.allowed_tools,G=>{d.value.allowed_tools!==null&&(_.allowed_tools=G===d.value.allowed_tools?"autofilled":"modified")}),ye(()=>{r.value&&xe(()=>import("./modal-D6mKceGM.js").then(G=>G.m),__vite__mapDeps([0,1])).then(G=>{const le=G.default;c=new le(r.value),r.value.addEventListener("shown.bs.modal",rt),r.value.addEventListener("hidden.bs.modal",Fe)})}),Ee(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",rt),r.value.removeEventListener("hidden.bs.modal",Fe)),c&&c.dispose()}),(G,le)=>(a(),l(re,null,[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",oC,[s("div",iC,[s("div",aC,[s("h5",rC,[m.value==="create-template"||m.value==="edit-template"?(a(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:C,title:"Back to template list"}," â† ")):M("",!0),ie(" "+y(x.value),1)]),le[3]||(le[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",lC,[m.value==="template-list"?(a(),l("div",cC,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[le[4]||(le[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:F,class:"btn btn-primary btn-sm"}," + Create New ")]),k.value.length===0?(a(),l("div",uC," No templates found. Create your first template! ")):M("",!0),(a(!0),l(re,null,ce(k.value,ue=>(a(),l("div",{key:ue.template_id,class:"card mb-2"},[s("div",dC,[s("div",mC,[s("div",pC,[s("h6",fC,y(ue.name),1),ue.description?(a(),l("p",vC,y(ue.description),1)):M("",!0),s("div",hC,[s("span",_C,y(ue.permission_mode),1),s("span",gC,y(ue.allowed_tools?.length||0)+" tools",1)])]),s("div",bC,[s("button",{onClick:Te=>J(ue),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,yC),s("button",{onClick:Te=>z(ue),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,wC)])])])]))),128))])):(a(),l("div",$C,[s("ul",kC,[s("li",SC,[s("button",{class:te(["nav-link",{active:p.value==="general","has-error":E.value.general}]),type:"button",onClick:le[0]||(le[0]=ue=>p.value="general")},[le[5]||(le[5]=ie(" General ",-1)),E.value.general?(a(),l("span",EC)):M("",!0)],2)]),s("li",CC,[s("button",{class:te(["nav-link",{active:p.value==="permissions","has-error":E.value.permissions}]),type:"button",onClick:le[1]||(le[1]=ue=>p.value="permissions")},[le[6]||(le[6]=ie(" Permissions ",-1)),E.value.permissions?(a(),l("span",TC)):M("",!0)],2)]),s("li",xC,[s("button",{class:te(["nav-link",{active:p.value==="advanced","has-error":E.value.advanced}]),type:"button",onClick:le[2]||(le[2]=ue=>p.value="advanced")},[le[7]||(le[7]=ie(" Advanced ",-1)),E.value.advanced?(a(),l("span",AC)):M("",!0)],2)])]),s("div",MC,[ge(pe(WS,{mode:m.value,"form-data":v,errors:T,templates:k.value,"selected-template-id":$.value,session:w.value,"field-states":_,"onUpdate:formData":q,"onUpdate:selectedTemplateId":Z,onOpenFolderBrowser:S,onOpenTemplateManager:C},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ys,p.value==="general"]]),ge(pe(EE,{mode:m.value,"form-data":v,errors:T,session:w.value,"field-states":_,"onUpdate:formData":q,onPreviewPermissions:B},null,8,["mode","form-data","errors","session","field-states"]),[[ys,p.value==="permissions"]]),ge(pe(BE,{mode:m.value,"form-data":v,errors:T,session:w.value,"field-states":_,"onUpdate:formData":q},null,8,["mode","form-data","errors","session","field-states"]),[[ys,p.value==="advanced"]])])])),I.value?(a(),l("div",OC,y(I.value),1)):M("",!0)]),s("div",DC,[s("button",NC,y(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(a(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:R.value||!W.value,onClick:se},[R.value?(a(),l("span",IC)):M("",!0),ie(" "+y(A.value),1)],8,LC)):M("",!0)])])])],512),pe(nC,{ref_key:"permissionPreviewModal",ref:f,"working-directory":K.value,"setting-sources":v.setting_sources,"session-allowed-tools":L.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},PC=ne(jC,[["__scopeId","data-v-098a9c63"]]),RC={class:"modal-dialog modal-dialog-centered"},WC={class:"modal-content"},BC={class:"modal-header"},FC={class:"modal-title",id:"manageSessionModalLabel"},HC={class:"modal-body"},VC={key:0,class:"text-center py-4"},UC={class:"text-muted"},qC={key:1},zC={key:2},KC={class:"text-muted"},GC={key:0,class:"text-center py-2"},YC={key:1,class:"alert alert-warning mt-3"},JC={class:"mb-0 mt-2"},QC={key:0,class:"text-muted"},XC={key:3},ZC={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},e0={class:"d-grid gap-2"},t0=["disabled"],s0=["disabled"],n0=["disabled"],o0=["disabled"],i0={class:"modal-footer"},a0={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},r0={__name:"SessionManageModal",setup(n){const e=Ft(),t=de(),o=_e(),i=nt();Ae();const r=P(null),c=P(!1),f=P(""),m=P(""),p=P(null),u=P(null);let w=null;const g=P([]),k=P(!1),$=h(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function b(){p.value="reset"}async function d(){if(p.value="delete",g.value=[],!!r.value){k.value=!0;try{const x=await me.get(`/api/sessions/${r.value.session_id}/descendants`);g.value=x.descendants||[]}catch(x){console.error("Failed to fetch descendants:",x),g.value=[]}finally{k.value=!1}}}function _(){p.value=null}async function v(){p.value==="reset"?await R():p.value==="delete"&&await I()}async function T(){if(r.value){c.value=!0,f.value="Restarting session...";try{const x=r.value.session_id,A=t.currentSessionId===x,W=await me.post(`/api/sessions/${x}/restart`);if(W.success)console.log("Session restarted successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(x)),w&&w.hide();else{const K=W.error||W.detail||"Failed to restart session";console.error("Failed to restart session:",K),m.value=`Failed to restart session: ${K}`}}catch(x){console.error("Error restarting session:",x);const A=x.data?.detail||x.message||"Unknown error";m.value=`Error restarting session: ${A}`}finally{c.value=!1}}}async function E(){if(r.value)try{w&&w.hide(),console.log("Ending session",r.value.session_id);const x=r.value.session_id;await me.post(`/api/sessions/${x}/terminate`),t.currentSessionId===x&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(x){console.error("Error ending session:",x),t.currentSessionId===r.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function R(){if(r.value){c.value=!0,f.value="Resetting session...";try{const x=r.value.session_id,A=t.currentSessionId===x,W=await me.post(`/api/sessions/${x}/reset`);if(W.success)console.log("Session reset successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(x)),w&&w.hide();else{const K=W.error||W.detail||"Failed to reset session";console.error("Failed to reset session:",K),m.value=`Failed to reset session: ${K}`,p.value=null}}catch(x){console.error("Error resetting session:",x);const A=x.data?.detail||x.message||"Unknown error";m.value=`Error resetting session: ${A}`,p.value=null}finally{c.value=!1}}}async function I(){if(r.value){c.value=!0,f.value="Deleting session...";try{const x=r.value.session_id;await t.deleteSession(x),e.currentRoute.value.params.sessionId===x&&e.push("/"),w&&w.hide()}catch(x){console.error("Error deleting session:",x);const A=x.data?.detail||x.message||"Unknown error";m.value=`Error deleting session: ${A}`,p.value=null}finally{c.value=!1}}}function O(){p.value=null,c.value=!1,f.value="",m.value="",g.value=[],k.value=!1}function H(){O(),r.value=null,o.hideModal()}return fe(()=>o.currentModal,x=>{if(x?.name==="manage-session"&&w){const A=x.data||{};r.value=A.session,O(),w.show()}}),ye(()=>{u.value&&xe(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(A=>A.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{w=new x(u.value),u.value.addEventListener("hidden.bs.modal",H)})}),Ee(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",H),w&&w.dispose()}),(x,A)=>(a(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",RC,[s("div",WC,[s("div",BC,[s("h5",FC,y(p.value?$.value:"Manage Session"),1),A[1]||(A[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",HC,[c.value?(a(),l("div",VC,[A[2]||(A[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",UC,y(f.value),1)])):p.value==="reset"?(a(),l("div",qC,[...A[3]||(A[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(a(),l("div",zC,[A[9]||(A[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",KC,[A[4]||(A[4]=ie("This will permanently delete session ",-1)),s("strong",null,y(r.value?.name),1),A[5]||(A[5]=ie(".",-1))]),A[10]||(A[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),k.value?(a(),l("div",GC,[...A[6]||(A[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(a(),l("div",YC,[A[7]||(A[7]=s("strong",null,"Cascading Deletion:",-1)),A[8]||(A[8]=ie(" This session has ",-1)),s("strong",null,y(g.value.length),1),ie(" child session"+y(g.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",JC,[(a(!0),l(re,null,ce(g.value,W=>(a(),l("li",{key:W.session_id,class:"small"},[s("strong",null,y(W.name||W.session_id),1),W.role?(a(),l("span",QC," ("+y(W.role)+")",1)):M("",!0)]))),128))])])):M("",!0)])):(a(),l("div",XC,[m.value?(a(),l("div",ZC,[A[11]||(A[11]=s("strong",null,"Error:",-1)),ie(" "+y(m.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:A[0]||(A[0]=W=>m.value="")})])):M("",!0),A[18]||(A[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",e0,[s("button",{class:"btn btn-outline-primary text-start",onClick:T,disabled:c.value},[...A[12]||(A[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,t0),s("button",{class:"btn btn-outline-secondary text-start",onClick:E,disabled:c.value},[...A[13]||(A[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,s0),A[16]||(A[16]=s("hr",{class:"my-2"},null,-1)),A[17]||(A[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:c.value},[...A[14]||(A[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,n0),s("button",{class:"btn btn-outline-danger text-start",onClick:d,disabled:c.value},[...A[15]||(A[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,o0)]),A[19]||(A[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ie(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",i0,[p.value&&!c.value?(a(),l(re,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),s("button",{type:"button",class:te(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:v},y(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?M("",!0):(a(),l("button",a0,"Cancel"))])])])],512))}},l0=ne(r0,[["__scopeId","data-v-6b832853"]]),c0={class:"modal-dialog modal-dialog-centered modal-lg"},u0={class:"modal-content"},d0={class:"modal-body"},m0={key:0,class:"text-center text-muted py-4"},p0={key:1},f0={class:"mb-3"},v0={class:"font-monospace small"},h0={class:"mb-3"},_0=["value"],g0={class:"mb-3"},b0={class:"mb-3"},y0={class:"mb-3"},w0={key:0},$0={class:"d-flex flex-wrap gap-1"},k0={key:1,class:"text-muted small"},S0={key:0,class:"mb-3"},E0={class:"d-flex flex-wrap gap-1"},C0={key:1,class:"mb-3"},T0={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},x0={class:"mb-3"},A0={class:"text-muted"},M0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},O0={__name:"SessionInfoModal",setup(n){const e=de(),t=Ae(),o=_e(),i=P(null),r=P(!1),c=P(null);let f=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},p=h(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(t.messagesBySession.get(i.value)||[]).find(v=>v.type==="system"&&(v.subtype==="init"||v.metadata?.subtype==="init")&&v.metadata?.init_data)?.metadata?.init_data||null});function u(b){return b?m[b]||b:"Default (Sonnet 4.5)"}function w(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function g(b){b.target.select()}function k(){i.value=null,r.value=!1}function $(){k(),o.hideModal()}return fe(()=>o.currentModal,b=>{if(b?.name==="session-info"&&f){const d=b.data||{};i.value=d.sessionId,r.value=!1,f.show()}}),ye(()=>{c.value&&xe(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{f=new b(c.value),c.value.addEventListener("hidden.bs.modal",$)})}),Ee(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",$),f&&f.dispose()}),(b,d)=>(a(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",c0,[s("div",u0,[d[9]||(d[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",d0,[p.value?(a(),l("div",p0,[s("div",f0,[d[1]||(d[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",v0,y(i.value),1)]),s("div",h0,[d[2]||(d[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:g},null,8,_0)]),s("div",g0,[d[3]||(d[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,y(u(p.value.model)),1)]),s("div",b0,[d[4]||(d[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,y(p.value.permissionMode||"default"),1)]),s("div",y0,[d[5]||(d[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(a(),l("div",w0,[s("div",$0,[(a(!0),l(re,null,ce(p.value.allowed_tools||p.value.tools,_=>(a(),l("span",{key:_,class:"badge bg-secondary"},y(_),1))),128))])])):(a(),l("div",k0,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(a(),l("div",S0,[d[6]||(d[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",E0,[(a(!0),l(re,null,ce(p.value.commands,_=>(a(),l("span",{key:_,class:"badge bg-info"},y(_),1))),128))])])):M("",!0),p.value.systemPrompt?(a(),l("div",C0,[d[7]||(d[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",T0,y(w(p.value.systemPrompt)),1)])):M("",!0),s("div",x0,[s("h6",A0,[d[8]||(d[8]=ie(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:d[0]||(d[0]=_=>r.value=!r.value)},y(r.value?"Hide":"Show"),1)]),r.value?(a(),l("pre",M0,y(JSON.stringify(p.value,null,2)),1)):M("",!0)])])):(a(),l("div",m0," No session configuration data available "))]),d[10]||(d[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},D0=ne(O0,[["__scopeId","data-v-b28b39b3"]]),N0={class:"modal-dialog modal-dialog-centered modal-lg"},L0={class:"modal-content"},I0={class:"modal-body"},j0={key:0,class:"text-center text-muted py-4"},P0={key:1},R0={class:"mb-3"},W0={class:"mb-3"},B0={class:"font-monospace small"},F0={class:"mb-3"},H0={class:"mb-3"},V0={class:"mb-3"},U0={key:0},q0={class:"d-flex flex-wrap gap-1"},z0={key:1,class:"text-muted small"},K0={class:"mb-3"},G0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},Y0={key:1,class:"text-muted small"},J0={class:"mb-3"},Q0={key:0,class:"badge bg-info"},X0={key:1,class:"badge bg-secondary"},Z0={class:"mb-3"},eT={key:0,class:"font-monospace small"},tT={key:1,class:"text-muted small"},sT={key:0,class:"mb-3"},nT={key:0},oT={class:"list-unstyled mb-0"},iT={key:1,class:"text-muted small"},aT={class:"mb-3"},rT={class:"small"},lT={class:"mb-3"},cT={class:"small"},uT={__name:"MinionViewModal",setup(n){const e=_e(),t=P(null),o=P(null);let i=null;function r(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function c(p){if(!p)return"N/A";try{const u=new Date(p);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function f(){t.value=null}function m(){f(),e.hideModal()}return fe(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&i){const u=p.data||{};t.value=u.session,i.show()}}),ye(()=>{o.value&&xe(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{i=new p(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),Ee(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),i&&i.dispose()}),(p,u)=>(a(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",N0,[s("div",L0,[u[11]||(u[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",I0,[t.value?(a(),l("div",P0,[s("div",R0,[u[0]||(u[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,y(t.value.name||"Unnamed Minion"),1)]),s("div",W0,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",B0,y(t.value.session_id),1)]),s("div",F0,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,y(t.value.role||"Not specified"),1)]),s("div",H0,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:te(["badge",r(t.value.state)])},y(t.value.state),3)])]),s("div",V0,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(a(),l("div",U0,[s("div",q0,[(a(!0),l(re,null,ce(t.value.capabilities,w=>(a(),l("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(a(),l("div",z0,"None"))]),s("div",K0,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(a(),l("div",G0,y(t.value.initialization_context),1)):(a(),l("div",Y0,"Not specified"))]),s("div",J0,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(a(),l("span",Q0,"Yes")):(a(),l("span",X0,"No"))])]),s("div",Z0,[u[7]||(u[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(a(),l("div",eT,y(t.value.parent_overseer_id),1)):(a(),l("div",tT," Root overseer (user-created) "))]),t.value.is_overseer?(a(),l("div",sT,[u[8]||(u[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(a(),l("div",nT,[s("ul",oT,[(a(!0),l(re,null,ce(t.value.child_minion_ids,w=>(a(),l("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(a(),l("div",iT,"No children"))])):M("",!0),s("div",aT,[u[9]||(u[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",rT,y(c(t.value.created_at)),1)]),s("div",lT,[u[10]||(u[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",cT,y(c(t.value.updated_at)),1)])])):(a(),l("div",j0," No minion data available "))]),u[12]||(u[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},dT=ne(uT,[["__scopeId","data-v-d996dc6f"]]),mT={class:"container-fluid vh-100 d-flex flex-column p-0"},pT={class:"d-flex flex-grow-1 overflow-hidden position-relative"},fT={class:"flex-grow-1 d-flex flex-column overflow-hidden"},vT={__name:"App",setup(n){const e=_e(),t=nt(),o=de(),i=je(),r=kt(),c=Xe(),f=Ft(),m=P(null);function p(d){m.value=d}gn("addAttachmentFromResource",p),gn("pendingResourceAttachment",m);const u=h(()=>e.sidebarCollapsed),w=h(()=>e.rightSidebarCollapsed),g=h(()=>e.isMobile);fe(()=>r.currentHasTasks,(d,_)=>{d&&!_&&e.setRightSidebarCollapsed(!1)}),fe(()=>c.currentHasResources,(d,_)=>{d&&!_&&e.setRightSidebarCollapsed(!1)}),ye(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const d=window.location.hash;if(d.startsWith("#/session/")){const _=d.replace("#/session/","");o.sessions.has(_)&&await o.selectSession(_)}else if(d.startsWith("#/timeline/")){const _=d.replace("#/timeline/","");f.push(`/timeline/${_}`)}window.addEventListener("popstate",k),window.addEventListener("resize",e.handleResize)}),Ee(()=>{window.removeEventListener("popstate",k),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function k(){const d=window.location.hash;if(d.startsWith("#/session/")){const _=d.replace("#/session/","");o.sessions.has(_)&&o.selectSession(_)}}function $(){e.toggleSidebar()}function b(){e.toggleRightSidebar()}return(d,_)=>{const v=vo("router-view");return a(),l("div",mT,[pe(fw),s("div",{id:"sidebar-backdrop",class:te({show:!u.value&&g.value}),onClick:$},null,2),s("div",{id:"right-sidebar-backdrop",class:te({show:!w.value&&g.value}),onClick:b},null,2),s("div",pT,[pe(Uw),s("main",fT,[pe(v)]),pe(Y$)]),pe(mk),pe(xk),pe(Jk),pe(PC),pe(l0),pe(D0),pe(dT)])}}},un=Oi(vT);un.use(Di());un.use(iw);un.mount("#app");
