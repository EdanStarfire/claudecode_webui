const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as p,a as s,o as u,d as ft,r as D,b as f,t as $,n as Ne,e as z,f as Y,u as qt,w as ne,g as pn,h as j,F as Z,i as se,j as _e,k as to,l as Q,v as ae,m as te,p as re,q as xs,s as zt,x as ce,y as pe,z as je,A as so,B as pi,C as mi,D as We,T as no,E as Ct,G as fi,H as vi}from"./vue-vendor-Dbs_RS4O.js";import{m as St,p as js}from"./markdown-vendor-CQ3OZdP9.js";import{c as hi}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const _i={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},gi={__name:"NoSessionSelected",setup(n){return(e,t)=>(u(),p("div",_i,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},bi="modulepreload",yi=function(n){return"/"+n},mn={},fe=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let l=function(m){return Promise.all(m.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),d=r?.nonce||r?.getAttribute("nonce");i=l(t.map(m=>{if(m=yi(m),m in mn)return;mn[m]=!0;const c=m.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${h}`))return;const v=document.createElement("link");if(v.rel=c?"stylesheet":bi,c||(v.as="script"),v.crossOrigin="",v.href=m,d&&v.setAttribute("nonce",d),document.head.appendChild(v),c)return new Promise((g,x)=>{v.addEventListener("load",g),v.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(r){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=r,window.dispatchEvent(d),!d.defaultPrevented)throw r}return i.then(r=>{for(const d of r||[])d.status==="rejected"&&a(d.reason);return e().catch(a)})};class cs extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function kt(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new cs(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof cs?t:(console.error("API request failed:",t),new cs(`Network error: ${t.message}`,0,null))}}async function $i(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[d,l]of Object.entries(e.params))l!=null&&o.append(d,l);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...r}=e;return kt(t,{...r,method:"GET"})}return kt(t,{...e,method:"GET"})}async function wi(n,e,t={}){return kt(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Ei(n,e,t={}){return kt(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ci(n,e={}){return kt(n,{...e,method:"DELETE"})}const J={get:$i,post:wi,put:Ei,delete:Ci},X=ft("session",()=>{const n=D(new Map),e=D(null),t=D(new Map),o=D(new Map),i=D(new Set),a=D(!1);let r=null;const d=f(()=>n.value.get(e.value)),l=f(()=>Array.from(n.value.values()).sort((A,T)=>A.order-T.order)),m=A=>f(()=>l.value.filter(T=>T.project_id===A)),c=f({get:()=>t.value.get(e.value)||"",set:A=>{e.value&&t.value.set(e.value,A)}});async function h(){try{const A=await J.get("/api/sessions");return n.value.clear(),A.sessions.forEach(T=>{n.value.set(T.session_id,T)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function v(A,T){try{const S=(await J.post("/api/sessions",{project_id:A,...T})).session_id,k=(await J.get(`/api/sessions/${S}`)).session;return n.value.set(S,k),n.value=new Map(n.value),console.log(`Created session ${S}`),k}catch(O){throw console.error("Failed to create session:",O),O}}async function g(A){if(e.value===A&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${A}`),r.abort(),r=null);const T=new AbortController;r=T,a.value=!0;try{if(e.value=A,T.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let O=n.value.get(A);if(!O)try{const k=await J.get(`/api/sessions/${A}`);if(T.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}O=k.session,n.value.set(A,O),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(k){console.error(`Failed to fetch session ${A}:`,k);return}if(O&&(O.state==="created"||O.state==="terminated"))try{if(await M(A),T.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${O.state} state)`);const k=6e4,N=200,I=5e3;let H=0,L=0;for(;H<k;){if(T.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const U=n.value.get(A);if(U&&U.state==="active"){console.log(`Session ${A} is now active after ${H}ms`);break}if(H-L>=I){const B=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${B}, ${H/1e3}s elapsed)`),L=H}await new Promise(B=>setTimeout(B,N)),H+=N}const P=n.value.get(A);P&&P.state!=="active"&&console.warn(`Session ${A} did not become active within ${k/1e3}s (state: ${P.state}), continuing anyway`)}catch(k){console.error(`Failed to auto-start session ${A}:`,k)}if(T.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await fe(()=>Promise.resolve().then(()=>Bi),void 0)).useMessageStore().loadMessages(A),T.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}await(await fe(()=>Promise.resolve().then(()=>da),void 0)).useWebSocketStore().connectSession(A),T.signal.aborted||console.log(`Selected session ${A}`)}finally{r===T&&(r=null),a.value=!1}}function x(A,T){const O=n.value.get(A);O?Object.assign(O,T):(n.value.set(A,T),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function _(A){i.value.add(A);try{await J.delete(`/api/sessions/${A}`),n.value.delete(A),t.value.delete(A),o.value.delete(A),n.value=new Map(n.value),e.value===A&&(e.value=null),console.log(`Deleted session ${A}`)}catch(T){throw console.error("Failed to delete session:",T),T}finally{i.value.delete(A)}}async function b(A,T){try{await J.put(`/api/sessions/${A}/name`,{name:T}),x(A,{name:T}),console.log(`Updated session ${A} name to "${T}"`)}catch(O){throw console.error("Failed to update session name:",O),O}}async function y(A,T){try{await J.post(`/api/sessions/${A}/permission-mode`,{mode:T}),x(A,{current_permission_mode:T});const O=o.value.get(A);O&&(O.permissionMode=T,o.value.set(A,O)),console.log(`Set permission mode for session ${A} to ${T}`)}catch(O){throw console.error("Failed to set permission mode:",O),O}}async function M(A){try{await J.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(T){throw console.error("Failed to start session:",T),T}}async function C(A){try{await J.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(T){throw console.error("Failed to pause session:",T),T}}async function w(A){try{await J.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(T){throw console.error("Failed to terminate session:",T),T}}function R(A){return n.value.get(A)}function V(A,T){o.value.set(A,T),T.permissionMode&&x(A,{current_permission_mode:T.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:d,orderedSessions:l,sessionsInProject:m,currentInput:c,fetchSessions:h,createSession:v,selectSession:g,updateSession:x,deleteSession:_,updateSessionName:b,setPermissionMode:y,startSession:M,pauseSession:C,terminateSession:w,getSession:R,storeInitData:V}}),fn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:X},Symbol.toStringTag,{value:"Module"})),ie=ft("ui",()=>{const n=D(window.innerWidth<768),e=D(300),t=D(window.innerWidth),o=f(()=>t.value<768),i=D(!0),a=D(null),r=D(null),d=f(()=>a.value?{name:a.value,data:r.value}:null),l=D(!1),m=D("Loading...");function c(){n.value=!n.value}function h(C){n.value=C}function v(C){e.value=Math.max(200,Math.min(C,window.innerWidth*.3))}function g(C){i.value=C}function x(C,w=null){a.value=null,r.value=null,setTimeout(()=>{a.value=C,r.value=w},0)}function _(){a.value=null,r.value=null}function b(C="Loading..."){l.value=!0,m.value=C}function y(){l.value=!1}function M(){const C=t.value;t.value=window.innerWidth,t.value<768&&C>=768?n.value=!0:t.value>=768&&C<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:d,isLoading:l,loadingMessage:m,toggleSidebar:c,setSidebarCollapsed:h,setSidebarWidth:v,setAutoScroll:g,showModal:x,hideModal:_,showLoading:b,hideLoading:y,handleResize:M}}),le=ft("project",()=>{const n=D(new Map),e=D(null),t=f(()=>n.value.get(e.value)),o=f(()=>Array.from(n.value.values()).sort((_,b)=>_.order-b.order)),i=_=>n.value.get(_)?.is_multi_agent||!1;async function a(){try{const _=await J.get("/api/projects");return n.value.clear(),_.projects.forEach(b=>{n.value.set(b.project_id,b)}),console.log(`Loaded ${n.value.size} projects`),_.projects}catch(_){throw console.error("Failed to fetch projects:",_),_}}async function r(_,b,y=!1){try{const C=(await J.post("/api/projects",{name:_,working_directory:b,is_multi_agent:y})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(M){throw console.error("Failed to create project:",M),M}}async function d(_,b){try{await J.put(`/api/projects/${_}`,b),l(_,b),console.log(`Updated project ${_}`,b)}catch(y){throw console.error("Failed to update project:",y),y}}function l(_,b){const y=n.value.get(_);y&&(Object.assign(y,b),n.value=new Map(n.value))}async function m(_){try{await J.delete(`/api/projects/${_}`),n.value.delete(_),n.value=new Map(n.value),e.value===_&&(e.value=null),console.log(`Deleted project ${_}`)}catch(b){throw console.error("Failed to delete project:",b),b}}async function c(_){try{const b=await J.put(`/api/projects/${_}/toggle-expansion`),y=n.value.get(_);return y&&(y.is_expanded=b.is_expanded,n.value=new Map(n.value)),b.is_expanded}catch(b){throw console.error("Failed to toggle expansion:",b),b}}async function h(_){try{await J.put("/api/projects/reorder",{project_ids:_}),_.forEach((b,y)=>{const M=n.value.get(b);M&&(M.order=y)}),n.value=new Map(n.value),console.log("Reordered projects",_)}catch(b){throw console.error("Failed to reorder projects:",b),b}}async function v(_,b){try{await J.put(`/api/projects/${_}/sessions/reorder`,{session_ids:b});const y=n.value.get(_);y&&(y.session_ids=b,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${_}`,b)}catch(y){throw console.error("Failed to reorder sessions:",y),y}}function g(_){return n.value.get(_)}function x(_){if(!_)return"";const b=_.split(/[/\\]/).filter(y=>y);return b.length===0?"/":b.length===1?`/${b[0]}`:b.length===2?`/${b.join("/")}`:`.../${b.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:r,updateProject:d,updateProjectLocal:l,deleteProject:m,toggleExpansion:c,reorderProjects:h,reorderSessionsInProject:v,getProject:g,formatPath:x}}),G=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Si={class:"session-header border-bottom p-3"},ki={class:"project-name"},Ti=["title"],xi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=X(),o=le(),i=f(()=>t.sessions.get(e.sessionId)),a=f(()=>i.value?.name||e.sessionId),r=f(()=>{for(const l of o.projects.values())if(l.session_ids?.includes(e.sessionId))return l;return null}),d=f(()=>r.value?.name||"Unknown Project");return(l,m)=>(u(),p("div",Si,[s("div",null,[s("div",ki,$(d.value),1),s("div",{class:"session-name",title:n.sessionId},$(a.value),9,Ti)])]))}},Ai=G(xi,[["__scopeId","data-v-89e9c269"]]),Mi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Oi=["title"],Ni={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Di={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=X(),o=f(()=>t.sessions.get(e.sessionId)),i=f(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=f(()=>{const l=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[l]||"#d3d3d3"}),r=f(()=>{const l=i.value;return l==="starting"||l==="processing"||l==="pending-prompt"}),d=f(()=>{if(!o.value)return"No session selected";const l=i.value,m=l.charAt(0).toUpperCase()+l.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",h=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${h}: ${m}`});return(l,m)=>(u(),p("div",Mi,[o.value?(u(),p("div",{key:0,class:z(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:Ne({width:"100%",backgroundColor:a.value}),title:d.value},null,14,Oi)):(u(),p("div",Ni))]))}},Li=G(Di,[["__scopeId","data-v-e8795bb7"]]),Ii={class:"session-status-bar border-top p-2 bg-light"},ji={class:"d-flex justify-content-between align-items-center gap-2"},Pi={class:"d-flex gap-2"},Ri=["disabled"],Vi={class:"mode-label"},Hi=["disabled"],Wi=["disabled"],Fi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=X(),o=ie(),i=f(()=>t.sessions.get(e.sessionId)),a=f(()=>i.value?.current_permission_mode||"default"),r={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},d=f(()=>r[a.value]||"ðŸ”’"),l=f(()=>a.value),m=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(y){console.error("Failed to cycle permission mode:",y)}return}const _=(m.indexOf(a.value)+1)%m.length,b=m[_];try{await t.setPermissionMode(e.sessionId,b)}catch(y){console.error("Failed to cycle permission mode:",y)}},h=()=>{o.showModal("session-info",{sessionId:e.sessionId})},v=()=>{o.showModal("manage-session",{session:i.value})},g=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(x,_)=>(u(),p("div",Ii,[s("div",ji,[s("div",Pi,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[Y($(d.value)+" ",1),s("span",Vi,$(l.value),1)],8,Ri),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[..._[0]||(_[0]=[Y(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Hi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:v,disabled:!i.value},[..._[1]||(_[1]=[Y(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,Wi)]),s("div",null,[s("button",{class:z(["btn btn-sm",qt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:g}," â¬‡ï¸ "+$(qt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Ui=G(Fi,[["__scopeId","data-v-fdcd3535"]]),xe=ft("message",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(new Map),d=f(()=>{const k=X();return n.value.get(k.currentSessionId)||[]}),l=f(()=>{const k=X();return e.value.get(k.currentSessionId)||[]});async function m(k,N=null,I=0){try{const H=N||1e4,L=await J.get(`/api/sessions/${k}/messages?limit=${H}&offset=${I}`),P=L.messages||[],U=L.total_count||P.length,B=L.has_more||!1;if(console.log(`Loaded ${P.length} of ${U} messages for session ${k}`),n.value.set(k,P),P.length>0){const F=P[P.length-1];F.timestamp&&(r.value.set(k,F.timestamp),console.log(`Tracked last received timestamp for session ${k}: ${F.timestamp}`))}const K=new Set;P.forEach(F=>{F.type==="assistant"&&F.metadata?.tool_uses&&F.metadata.tool_uses.forEach(ee=>{K.add(ee.id)}),F.type==="user"&&F.metadata?.tool_results&&F.metadata.tool_results.forEach(ee=>{K.delete(ee.tool_use_id);const he=a.value.get(k);he&&he.delete(ee.tool_use_id)}),F.type==="system"&&F.metadata?.subtype==="client_launched"&&(K.forEach(ee=>{w(k,ee,"Session was restarted")}),K.clear()),F.type==="system"&&F.metadata?.subtype==="interrupt"&&(K.forEach(ee=>{w(k,ee,"Session was interrupted")}),K.clear()),F.metadata?.has_tool_uses&&F.metadata.tool_uses&&F.metadata.tool_uses.forEach(ee=>{x(k,ee)}),F.metadata?.has_tool_results&&F.metadata.tool_results&&F.metadata.tool_results.forEach(ee=>{y(k,ee)}),(F.type==="permission_request"||F.metadata?.has_permission_requests)&&_(k,F),F.type==="system"&&(F.subtype==="init"||F.metadata?.subtype==="init")&&F.metadata?.init_data&&X().storeInitData(k,F.metadata.init_data)});const ve=X().sessions.get(k);return ve&&!["active","paused","starting"].includes(ve.state)&&(K.forEach(F=>{w(k,F,"Session was terminated")}),K.clear()),i.value.set(k,K),n.value=new Map(n.value),B&&console.warn(`Warning: Only loaded ${P.length} of ${U} messages. Some messages may be missing.`),{messages:P,totalCount:U,hasMore:B}}catch(H){throw console.error("Failed to load messages:",H),H}}function c(k,N){const I=i.value.get(k)||new Set;N.type==="assistant"&&N.metadata?.tool_uses&&N.metadata.tool_uses.forEach(H=>{I.add(H.id)}),N.type==="user"&&N.metadata?.tool_results&&N.metadata.tool_results.forEach(H=>{I.delete(H.tool_use_id);const L=a.value.get(k);L&&L.delete(H.tool_use_id)}),N.type==="system"&&N.metadata?.subtype==="client_launched"&&(I.forEach(H=>{w(k,H,"Session was restarted")}),I.clear()),N.type==="system"&&N.metadata?.subtype==="interrupt"&&(I.forEach(H=>{w(k,H,"Session was interrupted")}),I.clear()),i.value.set(k,I)}function h(k,N){n.value.has(k)||n.value.set(k,[]),n.value.get(k).push(N),N.timestamp&&r.value.set(k,N.timestamp),c(k,N),n.value=new Map(n.value)}function v(k,N){e.value.has(k)||e.value.set(k,[]),e.value.get(k).push(N),e.value=new Map(e.value)}function g(k,N,I){const H=e.value.get(k);if(H){const L=H.find(P=>P.id===N);L&&(Object.assign(L,I),e.value=new Map(e.value))}}function x(k,N){const I=C(N.name,N.input);t.value.set(I,N.id);const H={id:N.id,name:N.name,input:N.input,signature:I,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return v(k,H),console.log(`Created tool call ${H.id} for ${H.name}`),H}function _(k,N){console.log("handlePermissionRequest received:",N);const I=N.metadata?.tool_name||N.tool_name,H=N.metadata?.input_params||N.input_params,L=N.metadata?.request_id||N.request_id,P=N.metadata?.suggestions||N.suggestions||[];console.log("Extracted data:",{toolName:I,inputParams:H,requestId:L,suggestions:P});const U=C(I,H),B=t.value.get(U);B?(o.value.set(L,B),g(k,B,{status:"permission_required",permissionRequestId:L,suggestions:P}),console.log(`Permission required for tool ${B}`,{suggestions:P})):console.warn("No tool use ID found for permission request signature:",U,{toolName:I,inputParams:H,availableSignatures:Array.from(t.value.keys())})}function b(k,N){const I=o.value.get(N.request_id);if(I){const H={permissionDecision:N.decision,appliedUpdates:N.applied_updates||[]};N.decision==="allow"?H.status="executing":(H.status="completed",H.result={error:!0,message:N.reasoning||"Permission denied"},H.isExpanded=!1),g(k,I,H),console.log(`Permission ${N.decision} for tool ${I}`)}}function y(k,N){const I=N.tool_use_id;g(k,I,{status:N.is_error?"error":"completed",result:{error:N.is_error,content:N.content},isExpanded:!1}),console.log(`Tool ${I} ${N.is_error?"failed":"completed"}`)}function M(k,N){const I=e.value.get(k);if(I){const H=I.find(L=>L.id===N);H&&(H.isExpanded=!H.isExpanded,e.value=new Map(e.value))}}function C(k,N){if(!k)return"unknown:{}";if(!N||typeof N!="object")return`${k}:{}`;const I=JSON.stringify(N,Object.keys(N).sort());return`${k}:${I}`}function w(k,N,I){const H=a.value.get(k)||new Map;H.set(N,{reason:"denied",message:I}),a.value.set(k,H);const L=e.value.get(k);if(L){const P=L.find(U=>U.id===N);P&&P.isExpanded&&(P.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${N} as orphaned: ${I}`)}function R(k,N){return a.value.get(k)?.has(N)||!1}function V(k,N){return a.value.get(k)?.get(N)}function A(k,N){const I=i.value.get(k);I&&I.size>0&&(I.forEach(H=>w(k,H,N)),I.clear())}function T(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}function O(k){return r.value.get(k)}async function S(k){const N=r.value.get(k);if(!N)return console.log(`No sync needed for session ${k} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${k} since ${N}`);const I=await J.get(`/api/sessions/${k}/messages?limit=1000&offset=0`),H=I.messages||[],L=I.has_more||!1,P=new Date(N).getTime(),U=H.filter(F=>F.timestamp?new Date(F.timestamp).getTime()>P:!1);if(U.length===0)return console.log(`No missed messages for session ${k}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${U.length} missed messages for session ${k}`);const B=n.value.get(k)||[],K=new Set(B.map(F=>F.id).filter(Boolean)),oe=U.filter(F=>!F.id||!K.has(F.id));console.log(`After deduplication: ${oe.length} unique new messages`);const ve=[...B,...oe].sort((F,ee)=>{const he=new Date(F.timestamp||0).getTime(),ze=new Date(ee.timestamp||0).getTime();return he-ze});if(n.value.set(k,ve),oe.forEach(F=>{c(k,F),F.metadata?.has_tool_uses&&F.metadata.tool_uses&&F.metadata.tool_uses.forEach(ee=>{x(k,ee)}),F.metadata?.has_tool_results&&F.metadata.tool_results&&F.metadata.tool_results.forEach(ee=>{y(k,ee)}),(F.type==="permission_request"||F.metadata?.has_permission_requests)&&_(k,F),F.type==="system"&&(F.subtype==="init"||F.metadata?.subtype==="init")&&F.metadata?.init_data&&X().storeInitData(k,F.metadata.init_data)}),ve.length>0){const F=ve[ve.length-1];F.timestamp&&r.value.set(k,F.timestamp)}return n.value=new Map(n.value),{syncedCount:oe.length,hasMore:L}}catch(I){return console.error(`Failed to sync messages for session ${k}:`,I),{syncedCount:0,hasMore:!1,error:I.message}}}const E=X();return ne(()=>Array.from(E.sessions.values()).map(N=>({id:N.session_id,state:N.state})),(k,N)=>{N&&k.forEach((I,H)=>{const L=N[H];if(!L||L.id!==I.id)return;const P=["active","paused","starting"].includes(L.state),U=!["active","paused","starting"].includes(I.state);P&&U&&A(I.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:pn(i),orphanedToolUses:pn(a),currentMessages:d,currentToolCalls:l,loadMessages:m,addMessage:h,addToolCall:v,updateToolCall:g,handleToolUse:x,handlePermissionRequest:_,handlePermissionResponse:b,handleToolResult:y,toggleToolExpansion:M,clearMessages:T,markToolUseOrphaned:w,isToolUseOrphaned:R,getOrphanedInfo:V,clearOrphanedToolUses:A,getLastReceivedTimestamp:O,syncMessages:S}}),Bi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:xe},Symbol.toStringTag,{value:"Module"}));function qi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Xt(n){return qi(n).toLocaleTimeString()}const zi={class:"message-row message-row-user"},Ki=["title"],Yi={class:"message-content-column"},Gi=["innerHTML"],Ji={key:0,class:"tool-results mt-2"},Xi={class:"tool-results-header text-muted small mb-2"},Qi={class:"d-flex align-items-start gap-2"},Zi={class:"flex-grow-1"},ea={class:"text-muted"},ta={key:0,class:"text-danger small"},sa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;St.setOptions({breaks:!0,gfm:!0});const t=f(()=>Xt(e.message.timestamp)),o=f(()=>`user
${t.value}`),i=f(()=>{const l=e.message.content||"";let m=St.parse(l);return m=m.replace(/\n</g,"<"),m=m.replace(/\n+$/,""),js.sanitize(m)}),a=f(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=f(()=>e.message.metadata?.tool_results||[]);function d(l,m){return l?l.length<=m?l:l.substring(0,m)+"...":""}return(l,m)=>(u(),p("div",zi,[s("div",{class:"message-speaker",title:o.value},[...m[0]||(m[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,Ki),s("div",Yi,[s("div",{class:"message-text",innerHTML:i.value},null,8,Gi),a.value?(u(),p("div",Ji,[s("div",Xi,[m[1]||(m[1]=s("i",{class:"bi bi-tools"},null,-1)),Y(" Tool Results ("+$(r.value.length)+") ",1)]),(u(!0),p(Z,null,se(r.value,(c,h)=>(u(),p("div",{key:h,class:z(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",Qi,[s("span",null,$(c.is_error?"âŒ":"âœ…"),1),s("div",Zi,[s("small",ea,"Tool: "+$(c.tool_use_id),1),c.is_error?(u(),p("div",ta,$(d(c.content,200)),1)):j("",!0)])])],2))),128))])):j("",!0)])]))}},na=G(sa,[["__scopeId","data-v-09875214"]]),oa={class:"thinking-block"},ia={class:"text-muted ms-auto"},aa={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ra=["innerHTML"],la={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=D(!1),o=f(()=>e.thinking?.length||0),i=f(()=>{const r=e.thinking||"",d=St.parse(r);return js.sanitize(d)});function a(){t.value=!t.value}return(r,d)=>(u(),p("div",oa,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("i",{class:z(["bi",t.value?"bi-chevron-down":"bi-chevron-right"])},null,2),d[0]||(d[0]=s("span",{class:"thinking-label"},[s("i",{class:"bi bi-lightbulb"}),Y(" Thinking ")],-1)),s("small",ia,$(o.value)+" characters",1)]),t.value?(u(),p("div",aa,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ra)])):j("",!0)]))}},ca=G(la,[["__scopeId","data-v-619a8344"]]),Fe=ft("websocket",()=>{const n=D(null),e=D(!1),t=D(0),o=10,i=D(null),a=D(!1),r=D(0),d=5,l=D(null);let m=null;const c=D(0),h=D(null),v=D(new Map),g=D(null),x=D(!1),_=D(0),b=5,y=D(null),M=f(()=>e.value&&(a.value||!l.value)?"connected":e.value?"partial":"disconnected");function C(L){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${L}`}function w(){if(n.value)return;const L=C("/ws/ui");console.log(`Connecting to UI WebSocket: ${L}`),n.value=new WebSocket(L),n.value.onopen=()=>{e.value=!0,t.value=0,console.log("UI WebSocket connected")},n.value.onmessage=P=>{const U=JSON.parse(P.data);E(U)},n.value.onclose=()=>{if(e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const P=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${P}ms (attempt ${t.value})`),setTimeout(w,P)}},n.value.onerror=P=>{console.error("UI WebSocket error:",P)}}function R(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function V(L){c.value++;const P=c.value;if(console.log(`[Gen ${P}] Starting connection to session ${L}`),m&&(clearTimeout(m),m=null),await A(),c.value!==P){console.log(`[Gen ${P}] Connection cancelled (current generation: ${c.value})`);return}l.value=L,h.value=P;const U=C(`/ws/session/${L}`);console.log(`[Gen ${P}] Connecting to Session WebSocket: ${U}`),i.value=new WebSocket(U),i.value.onopen=async()=>{if(h.value!==P){console.log(`[Gen ${P}] Ignoring onopen (stale connection, current: ${h.value})`),i.value.close();return}a.value=!0,r.value=0,console.log(`[Gen ${P}] Session WebSocket connected for ${L}`);const B=v.value.get(L);if(v.value.set(L,!0),B){console.log(`[Gen ${P}] Reconnection detected, syncing missed messages...`);try{const oe=await xe().syncMessages(L);oe.syncedCount>0?console.log(`[Gen ${P}] âœ… Synced ${oe.syncedCount} missed messages`):oe.error?console.warn(`[Gen ${P}] âš ï¸ Message sync failed: ${oe.error}`):console.log(`[Gen ${P}] No missed messages to sync`),oe.hasMore&&console.warn(`[Gen ${P}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(K){console.error(`[Gen ${P}] Error during message sync:`,K)}}else console.log(`[Gen ${P}] Initial connection, no sync needed`)},i.value.onmessage=B=>{if(h.value!==P){console.log(`[Gen ${P}] Ignoring message (stale connection, current: ${h.value})`);return}const K=JSON.parse(B.data);k(K,L)},i.value.onclose=()=>{a.value=!1,i.value=null,console.log(`[Gen ${P}] Session WebSocket closed for ${L}`);const B=X();if(B.currentSessionId===L&&h.value===P&&r.value<d){r.value++;const K=Math.min(2e3*r.value,3e4);console.log(`[Gen ${P}] Reconnecting Session WebSocket in ${K}ms (attempt ${r.value})`),m=setTimeout(()=>{h.value===P&&B.currentSessionId===L?(m=null,V(L)):console.log(`[Gen ${P}] Skipping reconnect (generation or session changed)`)},K)}},i.value.onerror=B=>{console.error(`[Gen ${P}] Session WebSocket error:`,B)}}function A(){return new Promise(L=>{if(m&&(clearTimeout(m),m=null,console.log("Cancelled pending session reconnect timer")),i.value){const P=l.value,U=()=>{i.value=null,a.value=!1,l.value=null,h.value=null,r.value=0,P&&v.value.delete(P),L()};if(i.value.readyState===WebSocket.CLOSED)U();else{const B=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),U()},2e3);i.value.addEventListener("close",()=>{clearTimeout(B),U()},{once:!0}),i.value.close()}}else l.value=null,h.value=null,L()})}function T(L){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:L})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function O(L,P,U=!1,B=null){if(i.value&&a.value){const K={type:"permission_response",request_id:L,decision:P,apply_suggestions:U,timestamp:new Date().toISOString()};B&&(K.clarification_message=B),i.value.send(JSON.stringify(K)),console.log(`Sent permission ${P} for request ${L}`,{applySuggestions:U,clarification:B})}}function S(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function E(L){const P=X(),U=le();switch(L.type){case"sessions_list":L.sessions&&Array.isArray(L.sessions)&&L.sessions.forEach(B=>{P.updateSession(B.session_id,B)});break;case"state_change":L.data&&L.data.session_id&&L.data.session&&P.updateSession(L.data.session_id,L.data.session);break;case"project_updated":if(L.data&&L.data.project){const B=L.data.project;U.updateProjectLocal(B.project_id,B)}break;case"project_deleted":L.data&&L.data.project_id&&U.projects.delete(L.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",L.type)}}function k(L,P){const U=X();if(U.currentSessionId!==P){console.warn(`Ignoring message for session ${P} (current: ${U.currentSessionId})`);return}const B=xe();switch(L.type){case"message":const K=L.data;if(!K||!K.type){console.warn("Received message event with invalid data:",L);break}if(K.type==="permission_request"){B.handlePermissionRequest(P,K);break}if(K.type==="permission_response"){B.handlePermissionResponse(P,K);break}K.metadata?.has_tool_uses&&K.metadata.tool_uses.forEach(oe=>{B.handleToolUse(P,oe)}),K.metadata?.has_tool_results&&K.metadata.tool_results.forEach(oe=>{B.handleToolResult(P,oe)}),K.type==="system"&&(K.subtype==="init"||K.metadata?.subtype==="init")&&K.metadata?.init_data&&U.storeInitData(P,K.metadata.init_data),B.addMessage(P,K);break;case"permission_request":B.handlePermissionRequest(P,L);break;case"permission_response":B.handlePermissionResponse(P,L);break;case"tool_result":B.handleToolResult(P,L);break;case"state_change":U.updateSession(P,L.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${P}`);break;case"ping":i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function N(L){I(),y.value=L;const P=C(`/ws/legion/${L}`);console.log(`Connecting to Legion WebSocket: ${P}`),g.value=new WebSocket(P),g.value.onopen=()=>{x.value=!0,_.value=0,console.log(`Legion WebSocket connected for ${L}`)},g.value.onmessage=U=>{const B=JSON.parse(U.data);H(B,L)},g.value.onclose=()=>{if(x.value=!1,g.value=null,console.log(`Legion WebSocket closed for ${L}`),y.value===L&&_.value<b){_.value++;const U=Math.min(2e3*_.value,3e4);setTimeout(()=>N(L),U)}},g.value.onerror=U=>{console.error("Legion WebSocket error:",U)}}function I(){g.value&&(g.value.close(),g.value=null,x.value=!1,y.value=null)}function H(L,P){fe(async()=>{const{useLegionStore:U}=await Promise.resolve().then(()=>hu);return{useLegionStore:U}},void 0).then(({useLegionStore:U})=>{const B=U();switch(L.type){case"comm":L.comm&&(B.addComm(P,L.comm),console.log("Legion WebSocket: Received new comm",L.comm));break;case"minion_created":L.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",L.data),fe(async()=>{const{useSessionStore:K}=await Promise.resolve().then(()=>fn);return{useSessionStore:K}},void 0).then(({useSessionStore:K})=>{K().loadSessions()}));break;case"minion_updated":L.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",L.data),fe(async()=>{const{useSessionStore:K}=await Promise.resolve().then(()=>fn);return{useSessionStore:K}},void 0).then(({useSessionStore:K})=>{K().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${P}`);break;case"ping":g.value?.readyState===WebSocket.OPEN&&g.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",L.type)}})}return{uiConnected:e,sessionConnected:a,legionConnected:x,overallStatus:M,connectUI:w,disconnectUI:R,connectSession:V,disconnectSession:A,sendMessage:T,sendPermissionResponse:O,interruptSession:S,connectLegion:N,disconnectLegion:I}}),da=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Fe},Symbol.toStringTag,{value:"Module"})),ua={class:"base-tool-handler"},pa={class:"tool-section"},ma={class:"tool-parameters"},fa={class:"tool-code"},va={key:0,class:"tool-section"},ha={class:"tool-section-label"},_a={class:"tool-code"},ga={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=f(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,d)=>(u(),p("div",ua,[s("div",pa,[d[0]||(d[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",ma,[s("pre",fa,$(t.value),1)])]),o.value?(u(),p("div",va,[s("div",ha,$(i.value?"Error:":"Result:"),1),s("div",{class:z(["tool-result",{"tool-result-error":i.value}])},[s("pre",_a,$(a.value),1)],2)])):j("",!0)]))}},ba=G(ga,[["__scopeId","data-v-1e69f57d"]]),ya={class:"read-tool-handler"},$a={class:"tool-section"},wa={class:"read-file-info"},Ea={class:"file-path"},Ca={key:0,class:"read-range"},Sa={key:0,class:"tool-section"},ka={key:0,class:"tool-result tool-result-error"},Ta={class:"tool-code"},xa={key:1,class:"file-content-preview"},Aa={class:"content-header"},Ma={class:"line-count-badge"},Oa={key:0,class:"preview-note"},Na={class:"tool-code content-display"},Da={key:0,class:"more-indicator"},ds=100,La={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.file_path||"Unknown"),o=f(()=>{const g=e.toolCall.input?.offset,x=e.toolCall.input?.limit;return g!==void 0||x!==void 0}),i=f(()=>{const g=e.toolCall.input?.offset;return g!==void 0?g+1:1}),a=f(()=>{const g=e.toolCall.input?.offset||0,x=e.toolCall.input?.limit;return x!==void 0?g+x:"âˆž"}),r=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=f(()=>{if(!r.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),m=f(()=>d.value||!l.value?[]:l.value.split(`
`)),c=f(()=>m.value.length),h=f(()=>c.value>ds),v=f(()=>d.value?"":m.value.slice(0,ds).join(`
`));return(g,x)=>(u(),p("div",ya,[s("div",$a,[s("div",wa,[x[0]||(x[0]=s("span",{class:"file-icon"},"ðŸ“„",-1)),x[1]||(x[1]=s("strong",null,"Reading:",-1)),s("code",Ea,$(t.value),1),o.value?(u(),p("span",Ca,"Lines "+$(i.value)+"-"+$(a.value),1)):j("",!0)])]),r.value?(u(),p("div",Sa,[d.value?(u(),p("div",ka,[s("pre",Ta,$(l.value),1)])):(u(),p("div",xa,[s("div",Aa,[x[2]||(x[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Ma,$(c.value)+" lines",1),h.value?(u(),p("span",Oa,"(showing first "+$(ds)+")")):j("",!0)]),s("pre",Na,$(v.value),1),h.value?(u(),p("div",Da,"...")):j("",!0)]))])):j("",!0)]))}},Ia=G(La,[["__scopeId","data-v-1f2b0569"]]),ja={class:"write-tool-handler"},Pa={class:"tool-section"},Ra={class:"write-file-info mb-2"},Va={class:"file-path"},Ha={class:"write-content-preview"},Wa={class:"content-header"},Fa={class:"line-count-badge"},Ua={key:0,class:"preview-note"},Ba={class:"tool-code content-display"},qa={key:0,class:"more-indicator"},za={key:0,class:"tool-section"},Ka={key:0,class:"tool-result tool-result-error"},Ya={class:"tool-code"},Ga={key:1,class:"tool-result tool-result-success"},Ja={class:"success-message"},us=100,Xa={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.file_path||"Unknown"),o=f(()=>e.toolCall.input?.content||""),i=f(()=>o.value.split(`
`)),a=f(()=>i.value.length),r=f(()=>a.value>us),d=f(()=>i.value.slice(0,us).join(`
`)),l=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=f(()=>{if(!l.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,v)=>(u(),p("div",ja,[s("div",Pa,[s("div",Ra,[v[0]||(v[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),v[1]||(v[1]=s("strong",null,"Writing:",-1)),s("code",Va,$(t.value),1)]),s("div",Ha,[s("div",Wa,[v[2]||(v[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",Fa,$(a.value)+" lines",1),r.value?(u(),p("span",Ua,"(showing first "+$(us)+")")):j("",!0)]),s("pre",Ba,$(d.value),1),r.value?(u(),p("div",qa,"...")):j("",!0)])]),l.value?(u(),p("div",za,[m.value?(u(),p("div",Ka,[v[3]||(v[3]=s("strong",null,"Error:",-1)),s("pre",Ya,$(c.value),1)])):(u(),p("div",Ga,[s("div",Ja,[v[4]||(v[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):j("",!0)]))}},Qa=G(Xa,[["__scopeId","data-v-ddc24a0f"]]),Za={class:"bash-tool-handler"},er={class:"tool-section"},tr={class:"bash-header"},sr={class:"bash-header-content"},nr={key:0,class:"bash-description"},or={key:1,class:"bash-flags"},ir={class:"bash-command-section"},ar={class:"bash-command-content"},rr={key:0,class:"tool-section"},lr={key:0,class:"bash-output"},cr={key:1,class:"bash-output-empty"},dr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.command||""),o=f(()=>e.toolCall.input?.description||""),i=f(()=>e.toolCall.input?.timeout),a=f(()=>e.toolCall.input?.run_in_background||!1),r=f(()=>i.value||a.value),d=f(()=>{const v=[];return i.value&&v.push(`timeout: ${i.value}ms`),a.value&&v.push("background"),v.join(", ")}),l=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=f(()=>m.value?"tool-result-error":"tool-result-success"),h=f(()=>{if(!l.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,g)=>(u(),p("div",Za,[s("div",er,[s("div",tr,[g[1]||(g[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",sr,[o.value?(u(),p("div",nr,[g[0]||(g[0]=s("strong",null,"Description:",-1)),Y(" "+$(o.value),1)])):j("",!0),r.value?(u(),p("div",or,$(d.value),1)):j("",!0)])]),s("div",ir,[g[2]||(g[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",ar,$(t.value),1)])]),l.value?(u(),p("div",rr,[s("div",{class:z(["tool-result",c.value])},[g[3]||(g[3]=s("strong",null,"Output:",-1)),h.value?(u(),p("pre",lr,$(h.value),1)):(u(),p("div",cr,"No output"))],2)])):j("",!0)]))}},ur=G(dr,[["__scopeId","data-v-ab50fe73"]]),pr={class:"todo-tool-handler"},mr={class:"tool-section"},fr={class:"todo-header"},vr={class:"todo-summary"},hr={key:0,class:"todo-count todo-count-completed"},_r={key:1,class:"todo-count todo-count-in-progress"},gr={key:2,class:"todo-count todo-count-pending"},br={class:"todo-checklist"},yr={class:"todo-checkbox"},$r={class:"todo-content"},wr={key:0,class:"tool-section"},Er={key:0,class:"tool-result tool-result-error"},Cr={class:"tool-code"},Sr={key:1,class:"tool-result tool-result-success"},kr={class:"success-message"},Tr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.todos||[]),o=f(()=>t.value.filter(c=>c.status==="completed").length),i=f(()=>t.value.filter(c=>c.status==="in_progress").length),a=f(()=>t.value.filter(c=>c.status==="pending").length);function r(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const d=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=f(()=>{if(!d.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,h)=>(u(),p("div",pr,[s("div",mr,[s("div",fr,[h[0]||(h[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),h[1]||(h[1]=s("strong",null,"Task List:",-1)),s("div",vr,[o.value>0?(u(),p("span",hr,$(o.value)+" completed ",1)):j("",!0),i.value>0?(u(),p("span",_r,$(i.value)+" in progress ",1)):j("",!0),a.value>0?(u(),p("span",gr,$(a.value)+" pending ",1)):j("",!0)])]),s("div",br,[(u(!0),p(Z,null,se(t.value,(v,g)=>(u(),p("div",{key:g,class:z(["todo-item",`todo-${v.status}`])},[s("span",yr,$(r(v.status)),1),s("span",$r,$(v.content),1)],2))),128))])]),d.value?(u(),p("div",wr,[l.value?(u(),p("div",Er,[h[2]||(h[2]=s("strong",null,"Error:",-1)),s("pre",Cr,$(m.value),1)])):(u(),p("div",Sr,[s("div",kr,[h[3]||(h[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+$(t.value.length)+" tasks)",1)])]))])):j("",!0)]))}},xr=G(Tr,[["__scopeId","data-v-bbe55ee7"]]),Ar={class:"edit-tool-handler"},Mr={class:"tool-section"},Or={class:"edit-file-info"},Nr={class:"file-path"},Dr={key:0,class:"replace-all-badge"},Lr={class:"edit-diff-container"},Ir={class:"diff-header"},jr={class:"diff-stats"},Pr={class:"stat-removed"},Rr={class:"stat-added"},Vr={class:"unified-diff"},Hr={class:"diff-scroll-container"},Wr={class:"diff-marker"},Fr={class:"diff-content"},Ur={key:0,class:"tool-section"},Br={key:0,class:"tool-result tool-result-error"},qr={class:"tool-code"},zr={key:1,class:"tool-result tool-result-success"},Kr={class:"success-message"},Yr={key:0,class:"success-detail"},Gr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.file_path||"Unknown"),o=f(()=>e.toolCall.input?.old_string||""),i=f(()=>e.toolCall.input?.new_string||""),a=f(()=>e.toolCall.input?.replace_all||!1),r=f(()=>{const g=hi(t.value,o.value,i.value,"","",{context:3}).split(`
`),x=[];for(let _=4;_<g.length;_++){const b=g[_];b&&(b.startsWith("-")?x.push({type:"removed",content:b.substring(1)}):b.startsWith("+")?x.push({type:"added",content:b.substring(1)}):b.startsWith(" ")?x.push({type:"context",content:b.substring(1)}):b.startsWith("@@")&&x.push({type:"hunk",content:b}))}return x}),d=f(()=>r.value.filter(v=>v.type==="removed").length),l=f(()=>r.value.filter(v=>v.type==="added").length),m=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=f(()=>{if(!m.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,g)=>(u(),p("div",Ar,[s("div",Mr,[s("div",Or,[g[0]||(g[0]=s("span",{class:"file-icon"},"âœï¸",-1)),g[1]||(g[1]=s("strong",null,"Editing:",-1)),s("code",Nr,$(t.value),1),a.value?(u(),p("span",Dr,"Replace All")):j("",!0)]),s("div",Lr,[s("div",Ir,[g[2]||(g[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",jr,[s("span",Pr,"-"+$(d.value),1),s("span",Rr,"+"+$(l.value),1)])]),s("div",Vr,[s("div",Hr,[(u(!0),p(Z,null,se(r.value,(x,_)=>(u(),p("div",{key:_,class:z(["diff-line",{"diff-line-removed":x.type==="removed","diff-line-added":x.type==="added","diff-line-context":x.type==="context","diff-line-hunk":x.type==="hunk"}])},[s("span",Wr,$(x.type==="removed"?"-":x.type==="added"?"+":x.type==="hunk"?"@":" "),1),s("span",Fr,$(x.content),1)],2))),128))])])])]),m.value?(u(),p("div",Ur,[c.value?(u(),p("div",Br,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",qr,$(h.value),1)])):(u(),p("div",zr,[s("div",Kr,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),g[5]||(g[5]=s("strong",null,"File edited successfully",-1)),a.value?(u(),p("span",Yr,"(all occurrences replaced)")):j("",!0)])]))])):j("",!0)]))}},Jr=G(Gr,[["__scopeId","data-v-16b90adc"]]),Xr={class:"search-tool-handler"},Qr={class:"tool-section"},Zr={class:"search-info"},el={class:"search-icon"},tl={class:"search-pattern"},sl={key:0,class:"search-path"},nl={key:1,class:"search-filters"},ol={key:0,class:"filter-badge"},il={key:1,class:"filter-badge"},al={key:2,class:"filter-badge"},rl={key:0,class:"tool-section"},ll={key:0,class:"tool-result tool-result-error"},cl={class:"tool-code"},dl={key:1,class:"search-results"},ul={class:"results-header"},pl={class:"results-label"},ml={class:"results-count-badge"},fl={class:"results-content"},vl={class:"tool-code"},hl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.name==="Grep");f(()=>e.toolCall.name==="Glob");const o=f(()=>e.toolCall.input?.pattern||"Unknown"),i=f(()=>e.toolCall.input?.path||null),a=f(()=>e.toolCall.input?.type||null),r=f(()=>e.toolCall.input?.glob||null),d=f(()=>e.toolCall.input?.["-i"]||!1),l=f(()=>a.value||r.value||d.value),m=f(()=>t.value?"ðŸ”":"ðŸ“"),c=f(()=>t.value?"Searching content":"Finding files"),h=f(()=>t.value?"Matches":"Files found"),v=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),g=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),x=f(()=>{if(!v.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)}),_=f(()=>!v.value||g.value||!x.value?0:x.value.split(`
`).filter(y=>y.trim()).length);return(b,y)=>(u(),p("div",Xr,[s("div",Qr,[s("div",Zr,[s("span",el,$(m.value),1),s("strong",null,$(c.value)+":",1),s("code",tl,$(o.value),1),i.value?(u(),p("span",sl,"in "+$(i.value),1)):j("",!0),l.value?(u(),p("span",nl,[a.value?(u(),p("span",ol,"type: "+$(a.value),1)):j("",!0),r.value?(u(),p("span",il,"glob: "+$(r.value),1)):j("",!0),d.value?(u(),p("span",al,"case-insensitive")):j("",!0)])):j("",!0)])]),v.value?(u(),p("div",rl,[g.value?(u(),p("div",ll,[y[0]||(y[0]=s("strong",null,"Error:",-1)),s("pre",cl,$(x.value),1)])):(u(),p("div",dl,[s("div",ul,[s("span",pl,$(h.value)+":",1),s("span",ml,$(_.value)+" "+$(_.value===1?"match":"matches"),1)]),s("div",fl,[s("pre",vl,$(x.value),1)])]))])):j("",!0)]))}},vn=G(hl,[["__scopeId","data-v-0d272c39"]]),_l={class:"web-tool-handler"},gl={class:"tool-section"},bl={class:"web-info"},yl={class:"web-icon"},$l=["href"],wl={key:1,class:"web-query"},El={key:0,class:"web-prompt-container"},Cl={class:"prompt-content"},Sl={key:1,class:"web-domains"},kl={class:"domains-label"},Tl={key:0,class:"tool-section"},xl={key:0,class:"tool-result tool-result-error"},Al={class:"tool-code"},Ml={key:1,class:"web-results"},Ol={class:"results-header"},Nl={class:"results-label"},Dl={class:"results-content"},Ll={class:"tool-code"},Il={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.name==="WebFetch");f(()=>e.toolCall.name==="WebSearch");const o=f(()=>e.toolCall.input?.url||null),i=f(()=>e.toolCall.input?.query||null),a=f(()=>e.toolCall.input?.prompt||null),r=f(()=>e.toolCall.input?.allowed_domains||[]),d=f(()=>e.toolCall.input?.blocked_domains||[]),l=f(()=>r.value.length>0?r.value:d.value.length>0?d.value:[]),m=f(()=>r.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),c=f(()=>t.value?"ðŸŒ":"ðŸ”Ž"),h=f(()=>t.value?"Fetching URL":"Searching web"),v=f(()=>t.value?"Fetched content":"Search results"),g=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),x=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=f(()=>{if(!g.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,y)=>(u(),p("div",_l,[s("div",gl,[s("div",bl,[s("span",yl,$(c.value),1),s("strong",null,$(h.value)+":",1),o.value?(u(),p("a",{key:0,href:o.value,target:"_blank",class:"web-url"},$(o.value),9,$l)):i.value?(u(),p("code",wl,$(i.value),1)):j("",!0)]),a.value?(u(),p("div",El,[y[0]||(y[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Cl,$(a.value),1)])):j("",!0),l.value.length>0?(u(),p("div",Sl,[s("span",kl,$(m.value)+":",1),(u(!0),p(Z,null,se(l.value,M=>(u(),p("span",{key:M,class:"domain-badge"},$(M),1))),128))])):j("",!0)]),g.value?(u(),p("div",Tl,[x.value?(u(),p("div",xl,[y[1]||(y[1]=s("strong",null,"Error:",-1)),s("pre",Al,$(_.value),1)])):(u(),p("div",Ml,[s("div",Ol,[s("span",Nl,$(v.value)+":",1)]),s("div",Dl,[s("pre",Ll,$(_.value),1)])]))])):j("",!0)]))}},hn=G(Il,[["__scopeId","data-v-62b55b55"]]),jl={class:"task-tool-handler"},Pl={class:"tool-section"},Rl={class:"task-header"},Vl={key:0,class:"agent-type-badge"},Hl={key:0,class:"task-description"},Wl={class:"description-content"},Fl={key:1,class:"task-prompt-container"},Ul={class:"prompt-header"},Bl={class:"prompt-length"},ql={class:"prompt-code"},zl={key:0,class:"tool-section"},Kl={key:0,class:"tool-result tool-result-error"},Yl={class:"tool-code"},Gl={key:1,class:"agent-output"},Jl={class:"output-header"},Xl={key:0,class:"output-count-badge"},Ql={class:"output-content"},Zl={class:"tool-code"},ec={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.description||null),o=f(()=>e.toolCall.input?.prompt||null),i=f(()=>e.toolCall.input?.subagent_type||null),a=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=f(()=>{if(!a.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),l=f(()=>d.value?d.value.split(`
`).length:0);return(m,c)=>(u(),p("div",jl,[s("div",Pl,[s("div",Rl,[c[0]||(c[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=s("strong",null,"Agent Task:",-1)),i.value?(u(),p("span",Vl,$(i.value),1)):j("",!0)]),t.value?(u(),p("div",Hl,[c[2]||(c[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",Wl,$(t.value),1)])):j("",!0),o.value?(u(),p("div",Fl,[s("div",Ul,[c[3]||(c[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",Bl,$(o.value.length)+" characters",1)]),s("pre",ql,$(o.value),1)])):j("",!0)]),a.value?(u(),p("div",zl,[r.value?(u(),p("div",Kl,[c[4]||(c[4]=s("strong",null,"Error:",-1)),s("pre",Yl,$(d.value),1)])):(u(),p("div",Gl,[s("div",Jl,[c[5]||(c[5]=s("span",{class:"output-label"},"Agent Output:",-1)),l.value>0?(u(),p("span",Xl,$(l.value)+" lines",1)):j("",!0)]),s("div",Ql,[s("pre",Zl,$(d.value),1)])]))])):j("",!0)]))}},tc=G(ec,[["__scopeId","data-v-c520c244"]]),sc={class:"notebook-edit-tool-handler"},nc={class:"tool-section"},oc={class:"notebook-info"},ic={class:"file-path"},ac={class:"cell-info mt-2"},rc={class:"info-row"},lc={class:"info-row"},cc={key:0,class:"info-row"},dc={class:"badge bg-info"},uc={key:0,class:"source-preview mt-3"},pc={class:"preview-header"},mc={class:"preview-stats"},fc={class:"source-code"},vc={key:0,class:"tool-section"},hc={key:0},_c={key:1,class:"text-danger"},gc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.notebook_path||"Unknown"),o=f(()=>e.toolCall.input?.cell_id),i=f(()=>e.toolCall.input?.cell_type||"code"),a=f(()=>e.toolCall.input?.edit_mode||"replace"),r=f(()=>e.toolCall.input?.new_source||""),d=f(()=>r.value.split(`
`).length),l=f(()=>i.value==="code"?"bg-primary":"bg-secondary"),m=f(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=f(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const h=a.value;return h==="insert"?"Cell inserted successfully":h==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(h,v)=>(u(),p("div",sc,[s("div",nc,[s("div",oc,[v[0]||(v[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),v[1]||(v[1]=s("strong",null,"Notebook:",-1)),s("code",ic,$(t.value),1)]),s("div",ac,[s("div",rc,[v[2]||(v[2]=s("strong",null,"Cell ID:",-1)),s("code",null,$(o.value||"N/A"),1)]),s("div",lc,[v[3]||(v[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:z(["badge",l.value])},$(i.value),3)]),a.value?(u(),p("div",cc,[v[4]||(v[4]=s("strong",null,"Edit Mode:",-1)),s("span",dc,$(a.value),1)])):j("",!0)]),r.value?(u(),p("div",uc,[s("div",pc,[v[5]||(v[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",mc,$(d.value)+" lines",1)]),s("pre",fc,[s("code",null,$(r.value),1)])])):j("",!0)]),n.toolCall.result?(u(),p("div",vc,[v[8]||(v[8]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:z(["tool-result",m.value])},[n.toolCall.result.success!==!1?(u(),p("div",hc,[v[6]||(v[6]=s("i",{class:"bi bi-check-circle"},null,-1)),Y(" "+$(c.value),1)])):(u(),p("div",_c,[v[7]||(v[7]=s("i",{class:"bi bi-x-circle"},null,-1)),Y(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)])):j("",!0)]))}},bc=G(gc,[["__scopeId","data-v-bf9ef8f9"]]),yc={class:"shell-tool-handler"},$c={class:"tool-section"},wc={class:"shell-info"},Ec={class:"shell-icon"},Cc={key:0,class:"shell-id"},Sc={key:0,class:"filter-info mt-2"},kc={class:"filter-pattern"},Tc={key:0,class:"tool-section"},xc={class:"result-header mb-2"},Ac={key:0,class:"shell-output"},Mc={key:0},Oc={key:1,class:"text-danger"},Nc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=f(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=f(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=f(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=f(()=>e.toolCall.input?.filter),d=f(()=>e.toolCall.name==="BashOutput"?e.toolCall.result?.output||e.toolCall.result?.stdout:null),l=f(()=>e.toolCall.result?.status),m=f(()=>{const v=l.value;return v==="running"?"bg-success":v==="completed"?"bg-secondary":v==="killed"||v==="terminated"?"bg-danger":"bg-info"}),c=f(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=f(()=>e.toolCall.result?.message?e.toolCall.result.message:e.toolCall.name==="KillShell"?"Shell terminated successfully":"Operation completed");return(v,g)=>(u(),p("div",yc,[s("div",$c,[s("div",wc,[s("span",Ec,$(t.value),1),s("strong",null,$(o.value)+":",1),a.value?(u(),p("code",Cc,"Shell "+$(a.value),1)):j("",!0)]),n.toolCall.name==="BashOutput"&&r.value?(u(),p("div",Sc,[g[0]||(g[0]=s("strong",null,"Filter:",-1)),s("code",kc,$(r.value),1)])):j("",!0)]),n.toolCall.result?(u(),p("div",Tc,[s("div",xc,[s("strong",null,$(i.value)+":",1),l.value?(u(),p("span",{key:0,class:z(["badge",m.value])},$(l.value),3)):j("",!0)]),d.value?(u(),p("div",Ac,[s("pre",null,[s("code",null,$(d.value),1)])])):(u(),p("div",{key:1,class:z(["tool-result",c.value])},[n.toolCall.result.success!==!1?(u(),p("div",Mc,[g[1]||(g[1]=s("i",{class:"bi bi-check-circle"},null,-1)),Y(" "+$(h.value),1)])):(u(),p("div",Oc,[g[2]||(g[2]=s("i",{class:"bi bi-x-circle"},null,-1)),Y(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2))])):j("",!0)]))}},_n=G(Nc,[["__scopeId","data-v-1a461f4c"]]),Dc={class:"skill-tool-handler"},Lc={key:0,class:"tool-section"},Ic={class:"d-flex align-items-center gap-2"},jc={class:"text-muted small"},Pc={key:0,class:"skill-content-body"},Rc={class:"skill-content-text"},Vc={key:1,class:"tool-section mt-3"},Hc={class:"tool-result tool-result-error"},Wc={class:"tool-code"},Fc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=X(),i=D(!1);function a(){i.value=!i.value}f(()=>e.toolCall.input?.command||"Unknown Skill"),f(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),f(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=f(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const g=t.messagesBySession.get(v)||[],x=g.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(x===-1)return{running:null,content:null};let _=null,b=null;for(let y=x+1;y<Math.min(x+3,g.length);y++){const M=g[y];if(M.type!=="user")continue;const C=M.content||"";C.includes("<command-message>")&&C.includes("skill is running")?_=M:C.startsWith("Base directory for this skill:")&&(b=M)}return{running:_,content:b}});f(()=>{const v=r.value.content;if(!v)return null;const x=(v.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return x&&x[1]?x[1].trim():null});const d=f(()=>{const v=r.value.content;if(!v)return"";const g=v.content||"",x=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return g.replace(x,"").trim()}),l=f(()=>d.value.length>0),m=f(()=>d.value?d.value.split(`
`).length:0),c=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=f(()=>{if(!c.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,g)=>(u(),p("div",Dc,[l.value?(u(),p("div",Lc,[s("div",{class:"skill-content-header",onClick:a},[s("div",Ic,[s("i",{class:z(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),g[0]||(g[0]=s("strong",null,"Skill Content",-1)),s("span",jc,"("+$(m.value)+" lines)",1)])]),i.value?(u(),p("div",Pc,[s("pre",Rc,$(d.value),1)])):j("",!0)])):j("",!0),c.value?(u(),p("div",Vc,[g[1]||(g[1]=s("div",{class:"tool-section-label text-danger"},[s("i",{class:"bi bi-x-circle"}),Y(" Error: ")],-1)),s("div",Hc,[s("pre",Wc,$(h.value),1)])])):j("",!0)]))}},Uc=G(Fc,[["__scopeId","data-v-ba9a91da"]]),Bc={class:"slashcommand-tool-handler"},qc={key:0,class:"tool-section"},zc={class:"d-flex align-items-center gap-2"},Kc={class:"text-muted small"},Yc={key:0,class:"command-content-body"},Gc={class:"command-content-text"},Jc={key:1,class:"tool-section mt-3"},Xc={class:"tool-result tool-result-error"},Qc={class:"tool-code"},Zc={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=X(),i=D(!1);function a(){i.value=!i.value}f(()=>e.toolCall.input?.command||"Unknown Command"),f(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),f(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=f(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const g=t.messagesBySession.get(v)||[],x=g.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(x===-1)return{running:null,content:null};let _=null,b=null;for(let y=x+1;y<Math.min(x+3,g.length);y++){const M=g[y];if(M.type!=="user")continue;const C=M.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?_=M:C.includes("ARGUMENTS:")&&(b=M)}return{running:_,content:b}});f(()=>{const v=r.value.running;if(!v)return null;const x=(v.content||"").match(/<command-args>(.+?)<\/command-args>/s);return x&&x[1]?x[1].trim():null});const d=f(()=>{const v=r.value.content;if(!v)return"";const g=v.content||"",x=/\nARGUMENTS:.*$/s;return g.replace(x,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),l=f(()=>d.value.length>0),m=f(()=>d.value?d.value.split(`
`).length:0),c=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=f(()=>{if(!c.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,g)=>(u(),p("div",Bc,[l.value?(u(),p("div",qc,[s("div",{class:"command-content-header",onClick:a},[s("div",zc,[s("i",{class:z(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),g[0]||(g[0]=s("strong",null,"Command Content",-1)),s("span",Kc,"("+$(m.value)+" lines)",1)])]),i.value?(u(),p("div",Yc,[s("pre",Gc,$(d.value),1)])):j("",!0)])):j("",!0),c.value?(u(),p("div",Jc,[g[1]||(g[1]=s("div",{class:"tool-section-label text-danger"},[s("i",{class:"bi bi-x-circle"}),Y(" Error: ")],-1)),s("div",Xc,[s("pre",Qc,$(h.value),1)])])):j("",!0)]))}},ed=G(Zc,[["__scopeId","data-v-17d3444e"]]),td={class:"exit-plan-mode-tool-handler"},sd={class:"tool-section"},nd={key:0,class:"plan-content mt-2"},od={class:"plan-text"},id={key:0,class:"tool-section"},ad={key:0},rd={key:1,class:"text-danger"},ld={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.plan),o=f(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),p("div",td,[s("div",sd,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(u(),p("div",nd,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",od,$(t.value),1)])):j("",!0)]),n.toolCall.result?(u(),p("div",id,[a[4]||(a[4]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:z(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),p("div",ad,[...a[2]||(a[2]=[s("i",{class:"bi bi-check-circle"},null,-1),Y(" Permission mode reverted to default ",-1)])])):(u(),p("div",rd,[a[3]||(a[3]=s("i",{class:"bi bi-x-circle"},null,-1)),Y(" "+$(n.toolCall.result.error||"Failed to exit plan mode"),1)]))],2)])):j("",!0)]))}},cd=G(ld,[["__scopeId","data-v-bd35183e"]]),dd={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},ud={class:"tool-status-icon"},pd=["title"],md={class:"d-flex align-items-center gap-2"},fd={class:"text-muted"},vd={key:0,class:"card-body"},hd={key:0,class:"alert alert-warning mb-3"},_d={class:"d-flex align-items-center"},gd={class:"mb-0 small"},bd={key:1,class:"permission-prompt mt-3"},yd={class:"alert alert-warning mb-3"},$d={class:"mb-0"},wd={class:"tool-name"},Ed={key:0,class:"suggestions-section mb-3"},Cd={class:"alert alert-info mb-0"},Sd={class:"suggestion-details p-2 bg-white rounded"},kd={class:"permission-buttons d-flex gap-2 mb-3"},Td=["disabled"],xd=["disabled"],Ad=["disabled"],Md={class:"guidance-section mt-3"},Od=["disabled"],Nd=["disabled"],Dd={key:2,class:"mt-3"},Ld={class:"alert alert-warning mb-0"},Id={class:"d-flex align-items-center"},jd={class:"mb-0 small"},Pd={key:3,class:"tool-section"},Rd={class:"alert alert-danger mb-0"},Vd={key:0},Hd={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=X(),i=Fe(),a=D(!1),r=D(null),d=D(""),l=f(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),m=f(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c={Read:Ia,Write:Qa,Bash:ur,TodoWrite:xr,Edit:Jr,Grep:vn,Glob:vn,WebFetch:hn,WebSearch:hn,Task:tc,NotebookEdit:bc,BashOutput:_n,KillShell:_n,SlashCommand:ed,Skill:Uc,ExitPlanMode:cd},h=f(()=>{const S=e.toolCall.name;return c[S]?c[S]:ba}),v=f(()=>{const S=[];switch(e.toolCall.status){case"pending":S.push("border-secondary");break;case"permission_required":S.push("border-warning");break;case"executing":S.push("border-primary");break;case"completed":_.value||e.toolCall.permissionDecision==="deny"?S.push("border-danger"):S.push("border-success");break;case"error":S.push("border-danger");break}return S.join(" ")}),g=f(()=>{switch(e.toolCall.status){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":_.value?"ðŸ’¥":"âœ…";case"error":return"ðŸ’¥";default:return"ðŸ”§"}}),x=f(()=>Xt(e.toolCall.timestamp)),_=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=f(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function y(S){if(!S)return"";const E=S.replace(/\\/g,"/").split("/");return E[E.length-1]}function M(S,E=200){return S?S.length<=E?S:S.substring(0,E)+"...":""}function C(S){if(!S)return null;if(S.content){const E=S.content.match(/exit code (\d+)/i);if(E)return parseInt(E[1])}return S.error?1:0}function w(S,E){const k=S?S.split(`
`).length:0;return{added:E?E.split(`
`).length:0,removed:k}}const R=f(()=>{const S=e.toolCall.name,E=e.toolCall.input||{},k=e.toolCall.result,N=e.toolCall.status;switch(S){case"Bash":case"Shell":case"Command":{const I=M(E.command,200);if(N==="completed"&&k){const H=C(k);return`Bash: ${I} (exit ${H})`}return`Bash: ${I}`}case"SlashCommand":{const I=M(E.command,200);return N==="completed"&&k?`SlashCommand: ${I}`:`SlashCommand: ${I}`}case"Edit":{const I=y(E.file_path);if(N==="completed"&&k&&!k.error){const{added:H,removed:L}=w(E.old_string,E.new_string);return H===L?`Edit: ${I} (${H} lines changed)`:`Edit: ${I} (${H} lines added, ${L} removed)`}return`Edit: ${I}`}case"Read":{const I=y(E.file_path);if(E.offset!==void 0||E.limit!==void 0){const L=(E.offset||0)+1,P=E.limit?(E.offset||0)+E.limit:"âˆž";return`Read: ${I} (lines ${L}-${P})`}return`Read: ${I} (full file)`}case"Write":{const I=y(E.file_path);if(N==="completed"&&k&&!k.error&&E.content){const H=E.content.split(`
`).length;return`Write: ${I} (${H} lines written)`}return`Write: ${I}`}case"Skill":{const I=E.command||"Unknown";return N==="completed"&&k?k.error?`Skill: ${I} (error)`:`Skill: ${I} (completed)`:`Skill: ${I}`}case"Task":{const I=E.subagent_type||"general",H=E.description||"Task";return N==="completed"&&k?k.error?`Task: (${I}) ${H} (error)`:`Task: (${I}) ${H} (completed)`:`Task: (${I}) ${H}`}case"TodoWrite":{if(E.todos&&Array.isArray(E.todos)){const I=E.todos.filter(P=>P.status==="completed").length,H=E.todos.length,L=E.todos.find(P=>P.status==="in_progress");return L?`Todo: Working on "${L.content}"`:`Todo: ${I}/${H} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const I=E.pattern||"",H=S==="Grep"?"Grep":"Glob";if(N==="completed"&&k&&!k.error){let L=0;return k.content&&(L=k.content.split(`
`).filter(U=>U.trim()).length),`${H}: "${I}" (${L} results)`}return`${H}: "${I}"`}case"WebFetch":case"WebSearch":{const I=E.url||E.query||"";let H="";try{I&&(H=new URL(I.startsWith("http")?I:`https://${I}`).hostname)}catch{H=I.length>50?I.substring(0,50)+"...":I}return N==="completed"&&k?k.error?`Web: ${H} (error)`:`Web: ${H} (success)`:`Web: ${H||I}`}case"NotebookEdit":{const I=y(E.notebook_path),H=E.cell_number!==void 0?E.cell_number:"?",L=E.edit_mode||"replace";return`NotebookEdit: ${I} cell #${H} (${L})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${E.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${E.shell_id||"unknown"}`;default:return`${S}: executed`}}),V=f(()=>{const S=e.toolCall.name,E=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(S)?E.command||S:["Edit","Read","Write","NotebookEdit"].includes(S)&&(E.file_path||E.notebook_path)||S});function A(){const S=o.currentSessionId;S&&t.toggleToolExpansion(S,e.toolCall.id)}function T(S){return S.type==="setMode"?`Set permission mode to "${S.mode}"`:S.type==="allow"?`Allow tool: ${S.tool}`:JSON.stringify(S)}async function O(S,E,k=null){if(!a.value){a.value=!0,S==="allow"?r.value=E?"approve-apply":"approve":k?r.value="deny-guidance":r.value="deny";try{const N=o.currentSessionId;if(N){const I=E&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(N,{request_id:e.toolCall.permissionRequestId,decision:S,reasoning:S==="allow"?"User allowed permission":"User denied permission",applied_updates:I})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,S,E,k)}catch(N){console.error("Failed to send permission response:",N)}finally{a.value=!1,r.value=null}}}return(S,E)=>(u(),p("div",{class:z(["tool-call-card card",v.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:A},[s("div",dd,[s("span",ud,$(g.value),1),s("strong",{class:"tool-name",title:V.value},$(R.value),9,pd)]),s("div",md,[s("small",fd,$(x.value),1),s("i",{class:z(["bi",n.toolCall.isExpanded?"bi-chevron-up":"bi-chevron-down"])},null,2)])]),n.toolCall.isExpanded?(u(),p("div",vd,[l.value?(u(),p("div",hd,[s("div",_d,[E[6]||(E[6]=s("i",{class:"bi bi-x-circle me-2",style:{"font-size":"1.2rem"}},null,-1)),s("div",null,[E[5]||(E[5]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",gd,$(m.value?.message||"Session was terminated"),1)])])])):j("",!0),(u(),_e(to(h.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!l.value?(u(),p("div",bd,[s("div",yd,[E[9]||(E[9]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",$d,[E[7]||(E[7]=Y("Claude wants to use the ",-1)),s("code",wd,$(n.toolCall.name),1),E[8]||(E[8]=Y(" tool.",-1))])]),b.value?(u(),p("div",Ed,[s("div",Cd,[E[10]||(E[10]=s("h6",{class:"mb-2"},[s("i",{class:"bi bi-lightbulb me-2"}),Y(" Suggested Permission Update ")],-1)),E[11]||(E[11]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Sd,[(u(!0),p(Z,null,se(n.toolCall.suggestions,(k,N)=>(u(),p("div",{key:N,class:"suggestion-item"},[s("code",null,$(T(k)),1)]))),128))]),E[12]||(E[12]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):j("",!0),s("div",kd,[b.value?(u(),p("button",{key:0,class:"btn btn-success",onClick:E[0]||(E[0]=k=>O("allow",!0)),disabled:a.value},[E[13]||(E[13]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),Y(" "+$(a.value&&r.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),1)],8,Td)):j("",!0),s("button",{class:z(["btn",b.value?"btn-outline-success":"btn-success"]),onClick:E[1]||(E[1]=k=>O("allow",!1)),disabled:a.value},[E[14]||(E[14]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),Y(" "+$(a.value&&r.value==="approve"?"â³ Submitting...":b.value?"âœ… Approve Only":"âœ… Approve"),1)],10,xd),s("button",{class:"btn btn-danger",onClick:E[2]||(E[2]=k=>O("deny",!1)),disabled:a.value},[E[15]||(E[15]=s("i",{class:"bi bi-x-circle me-1"},null,-1)),Y(" "+$(a.value&&r.value==="deny"?"â³ Submitting...":"âŒ Deny"),1)],8,Ad)]),s("div",Md,[E[17]||(E[17]=s("label",{class:"form-label fw-bold"},[s("i",{class:"bi bi-chat-left-text me-1"}),Y(" Provide Guidance (Optional) ")],-1)),E[18]||(E[18]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),Q(s("textarea",{"onUpdate:modelValue":E[3]||(E[3]=k=>d.value=k),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Od),[[ae,d.value]]),d.value.trim()?(u(),p("button",{key:0,class:"btn btn-warning btn-sm",onClick:E[4]||(E[4]=k=>O("deny",!1,d.value)),disabled:a.value},[E[16]||(E[16]=s("i",{class:"bi bi-arrow-repeat me-1"},null,-1)),Y(" "+$(a.value&&r.value==="deny-guidance"?"â³ Submitting...":"ðŸ’¡ Provide Guidance & Continue"),1)],8,Nd)):j("",!0)])])):j("",!0),n.toolCall.status==="permission_required"&&l.value?(u(),p("div",Dd,[s("div",Ld,[s("div",Id,[E[20]||(E[20]=s("i",{class:"bi bi-shield-x me-2",style:{"font-size":"1.2rem"}},null,-1)),s("div",null,[E[19]||(E[19]=s("strong",null,"Permission Request Cancelled",-1)),s("p",jd,$(m.value?.message||"Session was terminated before permission could be granted"),1)])])])])):j("",!0),n.toolCall.permissionDecision==="deny"?(u(),p("div",Pd,[s("div",Rd,[E[21]||(E[21]=s("i",{class:"bi bi-x-circle"},null,-1)),E[22]||(E[22]=Y(" Permission denied ",-1)),n.toolCall.result?.message?(u(),p("span",Vd," - "+$(n.toolCall.result.message),1)):j("",!0)])])):j("",!0)])):j("",!0)],2))}},Wd=G(Hd,[["__scopeId","data-v-65c848bf"]]),Fd={class:"message-row message-row-assistant"},Ud=["title"],Bd={class:"message-content-column"},qd={key:0,class:"thinking-block mb-2"},zd=["innerHTML"],Kd={key:2,class:"tool-calls"},Yd={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=X();St.setOptions({breaks:!0,gfm:!0});const i=f(()=>Xt(e.message.timestamp)),a=f(()=>e.message.metadata?.model||null),r=f(()=>{const x=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${x}`}),d=f(()=>{const x=e.message.content||"";return x.trim().length>0&&x!=="Assistant response"}),l=f(()=>{const x=e.message.content||"";let _=St.parse(x);return _=_.replace(/\n</g,"<"),_=_.replace(/\n+$/,""),js.sanitize(_)}),m=f(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=f(()=>e.message.metadata?.thinking_content||""),h=f(()=>e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0),v=f(()=>e.message.metadata?.tool_uses||[]),g=f(()=>{const x=o.currentSessionId;if(!x)return[];const _=t.toolCallsBySession.get(x)||[];return v.value.map(b=>{const y=_.find(M=>M.id===b.id);return y||{id:b.id,name:b.name,input:b.input,status:"pending",result:null,timestamp:b.timestamp||e.message.timestamp,isExpanded:!0}})});return(x,_)=>(u(),p("div",Fd,[s("div",{class:"message-speaker",title:r.value},[..._[0]||(_[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Ud),s("div",Bd,[m.value?(u(),p("div",qd,[te(ca,{thinking:c.value},null,8,["thinking"])])):j("",!0),d.value?(u(),p("div",{key:1,class:"message-text",innerHTML:l.value},null,8,zd)):j("",!0),h.value?(u(),p("div",Kd,[(u(!0),p(Z,null,se(g.value,b=>(u(),_e(Wd,{key:b.id,toolCall:b},null,8,["toolCall"]))),128))])):j("",!0)])]))}},Gd=G(Yd,[["__scopeId","data-v-726a72a7"]]),Jd={class:"message-row message-row-system"},Xd=["title"],Qd={class:"message-content-column"},Zd={class:"system-text"},eu={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>Xt(e.message.timestamp)),o=f(()=>`system
${t.value}`);return(i,a)=>(u(),p("div",Jd,[s("div",{class:"message-speaker",title:o.value},[...a[0]||(a[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Xd),s("div",Qd,[s("span",Zd,$(n.message.content),1)])]))}},gn=G(eu,[["__scopeId","data-v-4999cd2b"]]),tu={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>{switch(e.message.type){case"user":return na;case"assistant":return Gd;case"system":return gn;default:return gn}});return(o,i)=>(u(),_e(to(t.value),{message:n.message},null,8,["message"]))}},su=G(tu,[["__scopeId","data-v-f283c218"]]),nu={key:0,class:"text-muted text-center py-5"},ou={__name:"MessageList",setup(n){const e=xe(),t=ie(),o=D(null),i=f(()=>e.currentMessages.filter(l=>r(l)));f(()=>e.currentToolCalls);async function a(){t.autoScrollEnabled&&(await xs(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ne(()=>e.currentMessages.length,a),ne(()=>e.currentToolCalls.length,a),ne(()=>e.currentToolCalls.map(l=>`${l.id}-${l.status}`).join(","),a),re(()=>{setTimeout(()=>{a()},100)});function r(l){const m=l.subtype||l.metadata?.subtype;if(l.type==="system"&&m==="init"||l.type==="result"||l.type==="permission_request"||l.type==="permission_response")return!1;if(l.type==="user"&&l.metadata?.has_tool_results){const c=l.content||"";if(c.match(/^Tool results?: \d+ results?$/i)||c.trim()==="")return!1}if(l.type==="user"){const c=l.content||"";if(c.includes("<command-message>")&&c.includes("skill is running")||c.startsWith("Base directory for this skill:"))return!1}if(l.type==="user"){const c=l.content||"";if(c.includes("<command-message>")&&c.includes("<command-name>")&&c.includes("<command-args>")||c.includes("ARGUMENTS:")&&(c.includes("<command-name>")||c.match(/\nARGUMENTS:/)))return!1}return!0}function d(l){return{type:l.type||"unknown",content:l.content||"",timestamp:l.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...l.metadata}}}return(l,m)=>(u(),p("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),p("div",nu," No messages yet. Start a conversation! ")):j("",!0),(u(!0),p(Z,null,se(i.value,(c,h)=>(u(),_e(su,{key:`msg-${c.timestamp}-${h}`,message:d(c)},null,8,["message"]))),128))],512))}},iu=G(ou,[["__scopeId","data-v-f94a8763"]]),au={class:"border-top bg-light"},ru={class:"d-flex gap-2 align-items-end px-2 py-1"},lu=["placeholder","disabled","onKeydown"],cu=["disabled"],du={__name:"InputArea",setup(n){const e=X(),t=Fe(),o=D(null),i=f({get:()=>e.currentInput,set:v=>{e.currentInput=v}}),a=f(()=>e.currentSession?.is_processing||!1),r=f(()=>t.sessionConnected),d=f(()=>e.currentSession?.state==="starting"),l=f(()=>d.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function m(){const v=o.value;if(!v)return;v.style.height="auto";const g=Math.min(v.scrollHeight,parseInt(getComputedStyle(v).maxHeight));v.style.height=g+"px"}function c(){i.value.trim()&&(t.sendMessage(i.value),i.value="",o.value&&(o.value.style.height="auto"))}function h(){t.interruptSession()}return(v,g)=>(u(),p("div",au,[s("div",ru,[Q(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":g[0]||(g[0]=x=>i.value=x),class:"form-control",placeholder:l.value,disabled:d.value||!r.value,rows:"1",onInput:m,onKeydown:zt(ce(c,["exact","prevent"]),["enter"])},null,40,lu),[[ae,i.value]]),a.value?(u(),p("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:h}," Stop ")):(u(),p("button",{key:1,class:"btn btn-primary",disabled:!i.value.trim()||!r.value||d.value,onClick:c}," Send ",8,cu))])]))}},uu=G(du,[["__scopeId","data-v-a72bf16a"]]),pu={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},mu={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},fu={class:"text-secondary"},vu={class:"d-flex flex-column flex-grow-1 overflow-hidden"},oo={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=X(),o=ie(),i=f(()=>t.currentSession),a=f(()=>o.isLoading),r=f(()=>o.loadingMessage);return re(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ne(()=>e.sessionId,async(d,l)=>{if(d!==l&&d!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(d)}finally{o.hideLoading()}}}),pe(()=>{}),(d,l)=>(u(),p("div",pu,[a.value?(u(),p("div",mu,[l[0]||(l[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",fu,$(r.value),1)])):j("",!0),i.value?(u(),_e(Ai,{key:1,"session-id":e.sessionId},null,8,["session-id"])):j("",!0),s("div",vu,[te(iu)]),te(uu),i.value?(u(),_e(Li,{key:2,"session-id":e.sessionId},null,8,["session-id"])):j("",!0),i.value?(u(),_e(Ui,{key:3,"session-id":e.sessionId},null,8,["session-id"])):j("",!0)]))}},vt=ft("legion",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(null),d=f(()=>n.value.get(r.value)||[]),l=f(()=>e.value.get(r.value)||[]),m=f(()=>t.value.get(r.value)||[]),c=f(()=>o.value.get(r.value)||[]);function h(T){r.value=T}async function v(T,O=100,S=0){try{const E=await J.get(`/api/legions/${T}/timeline?limit=${O}&offset=${S}`),k=E.comms||[],N=E.total_count||k.length,I=E.has_more||!1;return k.sort((H,L)=>new Date(H.timestamp)-new Date(L.timestamp)),console.log(`Loaded ${k.length} of ${N} comms for legion ${T}`),n.value.set(T,k),n.value=new Map(n.value),{comms:k,totalCount:N,hasMore:I}}catch(E){throw console.error("Failed to load timeline:",E),E}}function g(T,O){n.value.has(T)||n.value.set(T,[]),n.value.get(T).push(O),n.value=new Map(n.value)}async function x(T,O){try{const E=(await J.post(`/api/legions/${T}/comms`,O)).comm;return console.log(`Sent comm ${E.comm_id} to legion ${T}`),E}catch(S){throw console.error("Failed to send comm:",S),S}}async function _(T){return console.log(`Minions for legion ${T} are already available in session store`),[]}async function b(T,O){try{const E=(await J.post(`/api/legions/${T}/minions`,O)).minion;return await _(T),console.log(`Created minion ${E.minion_id} in legion ${T}`),E}catch(S){throw console.error("Failed to create minion:",S),S}}async function y(T){try{const S=(await J.get(`/api/legions/${T}/hordes`)).hordes||[];return console.log(`Loaded ${S.length} hordes for legion ${T}`),t.value.set(T,S),t.value=new Map(t.value),S}catch(O){throw console.error("Failed to load hordes:",O),O}}async function M(T){try{const S=(await J.get(`/api/legions/${T}/channels`)).channels||[];return console.log(`Loaded ${S.length} channels for legion ${T}`),o.value.set(T,S),o.value=new Map(o.value),S}catch(O){throw console.error("Failed to load channels:",O),O}}async function C(T){try{const O=await J.get(`/api/channels/${T}`),S=O.channel||O;return console.log(`Loaded details for channel ${T}`),i.value.set(T,S),i.value=new Map(i.value),S}catch(O){throw console.error("Failed to load channel details:",O),O}}async function w(T,O=1e3){try{const E=(await J.get(`/api/channels/${T}/comms?limit=${O}`)).comms||[];return console.log(`Loaded ${E.length} comms for channel ${T}`),E.sort((k,N)=>new Date(k.timestamp)-new Date(N.timestamp)),a.value.set(T,E),a.value=new Map(a.value),E}catch(S){throw console.error("Failed to load channel comms:",S),S}}async function R(T,O){try{await J.post(`/api/channels/${T}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:O}),console.log(`Added minion ${O} to channel ${T}`),await C(T)}catch(S){throw console.error("Failed to add member to channel:",S),S}}async function V(T,O){try{await J.post(`/api/channels/${T}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:O}),console.log(`Removed minion ${O} from channel ${T}`),await C(T)}catch(S){throw console.error("Failed to remove member from channel:",S),S}}function A(T){n.value.delete(T),e.value.delete(T),t.value.delete(T),o.value.delete(T),n.value=new Map(n.value),e.value=new Map(e.value),t.value=new Map(t.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:t,channelsByLegion:o,channelDetailsByChannel:i,channelCommsByChannel:a,currentLegionId:r,currentComms:d,currentMinions:l,currentHordes:m,currentChannels:c,setCurrentLegion:h,loadTimeline:v,addComm:g,sendComm:x,loadMinions:_,createMinion:b,loadHordes:y,loadChannels:M,loadChannelDetails:C,loadChannelComms:w,addMemberToChannel:R,removeMemberFromChannel:V,clearLegionData:A}}),hu=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:vt},Symbol.toStringTag,{value:"Module"})),_u={class:"timeline-header border-bottom p-3"},gu={class:"project-name"},bu=["title"],yu={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=le(),o=f(()=>t.projects.get(e.legionId)),i=f(()=>o.value?.name||"Legion");return(a,r)=>(u(),p("div",_u,[s("div",null,[s("div",gu,$(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,bu)])]))}},$u=G(yu,[["__scopeId","data-v-44f386f5"]]),wu={class:"timeline-status-bar border-top p-2 bg-light"},Eu={class:"d-flex justify-content-end"},Cu={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ie();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),p("div",wu,[s("div",Eu,[s("button",{class:z(["btn btn-sm",qt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+$(qt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Su=G(Cu,[["__scopeId","data-v-891c73db"]]),ku={class:"comm-composer border-top p-3"},Tu={class:"d-flex gap-2 mb-2"},xu={class:"flex-grow-1"},Au=["disabled"],Mu={label:"Minions"},Ou=["value"],Nu={key:0,label:"Channels"},Du=["value"],Lu={style:{"min-width":"150px"}},Iu=["disabled"],ju={class:"d-flex gap-2 align-items-end position-relative"},Pu={class:"flex-grow-1 position-relative"},Ru=["disabled"],Vu=["onClick","onMouseenter"],Hu=["disabled"],Wu={key:0},Fu={key:1},Uu={__name:"CommComposer",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=vt(),o=X(),i=le(),a=D(""),r=D("task"),d=D(""),l=D(!1),m=D(!1),c=D([]),h=D(0),v=D(-1),g=D(null),x=D(null),_=f(()=>{const S=i.projects.get(e.legionId);return!S||!S.session_ids?[]:S.session_ids.map(E=>o.sessions.get(E)).filter(E=>E&&E.is_minion)}),b=f(()=>t.currentChannels||[]),y=f(()=>a.value&&d.value.trim().length>0);function M(S){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[S.state]||"â—‹"}function C(S){return S.is_minion&&S.role?`${S.name} (${S.role})`:S.name}function w(){const S=g.value;if(!S)return;S.style.height="auto";const E=Math.min(S.scrollHeight,parseInt(getComputedStyle(S).maxHeight));S.style.height=E+"px"}function R(){const S=g.value;if(!S)return;w();const E=d.value,k=S.selectionStart,N=E.substring(0,k),I=N.lastIndexOf("#");if(I===-1){m.value=!1;return}const H=N.substring(I+1).toLowerCase();if(H.includes(" ")){m.value=!1;return}const L=_.value.filter(P=>P.name.toLowerCase().includes(H)).map(P=>({type:"minion",name:P.name,role:P.role,id:P.session_id,state:P.state}));if(L.length===0){m.value=!1;return}c.value=L,h.value=0,v.value=I,m.value=!0}function V(){if(!x.value)return;const S=x.value,E=S.children[h.value];if(!E)return;const k=E.offsetTop,N=E.offsetHeight,I=S.scrollTop,H=S.clientHeight;k<I?S.scrollTop=k:k+N>I+H&&(S.scrollTop=k+N-H)}function A(S){if(!m.value){S.key==="Enter"&&!S.shiftKey&&y.value&&(S.preventDefault(),O());return}if(S.key==="ArrowDown")S.preventDefault(),h.value=(h.value+1)%c.value.length,V();else if(S.key==="ArrowUp")S.preventDefault(),h.value=h.value===0?c.value.length-1:h.value-1,V();else if(S.key==="Enter"){S.preventDefault();const E=c.value[h.value];E&&T(E)}else S.key==="Escape"&&(m.value=!1)}function T(S){const E=g.value;if(!E)return;const k=d.value,N=E.selectionStart,I=k.substring(0,v.value)+"#"+S.name+" "+k.substring(N);d.value=I;const H=v.value+S.name.length+2;setTimeout(()=>{E.setSelectionRange(H,H),E.focus()},0),m.value=!1}async function O(){if(!(!y.value||l.value)){l.value=!0;try{const[S,E]=a.value.split(":"),k={comm_type:r.value,content:d.value.trim()};S==="minion"?k.to_minion_id=E:S==="channel"&&(k.to_channel_id=E),await t.sendComm(e.legionId,k),d.value="",w()}catch(S){console.error("Failed to send comm:",S),alert(`Failed to send comm: ${S.message}`)}finally{l.value=!1}}}return ne(m,S=>{if(S){const E=k=>{k.target.closest(".comm-composer")||(m.value=!1,document.removeEventListener("click",E))};setTimeout(()=>document.addEventListener("click",E),0)}}),(S,E)=>(u(),p("div",ku,[s("div",Tu,[s("div",xu,[Q(s("select",{"onUpdate:modelValue":E[0]||(E[0]=k=>a.value=k),class:"form-select form-select-sm",disabled:l.value},[E[3]||(E[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Mu,[(u(!0),p(Z,null,se(_.value,k=>(u(),p("option",{key:k.session_id,value:`minion:${k.session_id}`},$(M(k))+" "+$(C(k)),9,Ou))),128))]),b.value.length>0?(u(),p("optgroup",Nu,[(u(!0),p(Z,null,se(b.value,k=>(u(),p("option",{key:k.channel_id,value:`channel:${k.channel_id}`}," #ï¸âƒ£ "+$(k.name),9,Du))),128))])):j("",!0)],8,Au),[[je,a.value]])]),s("div",Lu,[Q(s("select",{"onUpdate:modelValue":E[1]||(E[1]=k=>r.value=k),class:"form-select form-select-sm",disabled:l.value},[...E[4]||(E[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Iu),[[je,r.value]])])]),s("div",ju,[s("div",Pu,[Q(s("textarea",{ref_key:"contentTextarea",ref:g,"onUpdate:modelValue":E[2]||(E[2]=k=>d.value=k),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:l.value,onInput:R,onKeydown:A},null,40,Ru),[[ae,d.value]]),m.value?(u(),p("div",{key:0,ref_key:"autocompleteDropdown",ref:x,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),p(Z,null,se(c.value,(k,N)=>(u(),p("div",{key:k.id,class:z(["autocomplete-item px-2 py-1",{"bg-light":N===h.value}]),onClick:I=>T(k),onMouseenter:I=>h.value=N},$(k.type==="minion"?M(k):"#ï¸âƒ£")+" "+$(k.name)+$(k.role?` (${k.role})`:""),43,Vu))),128))],512)):j("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!y.value||l.value,onClick:O},[l.value?(u(),p("span",Wu,[...E[5]||(E[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),Y(" Sending... ",-1)])])):(u(),p("span",Fu,"Send"))],8,Hu)])])]))}},Bu=G(Uu,[["__scopeId","data-v-ffa54193"]]),qu={class:"timeline-view d-flex flex-column h-100"},zu={key:0,class:"text-center text-muted"},Ku={key:1,class:"text-center text-danger"},Yu={key:2,class:"text-center text-muted"},Gu={key:3,class:"comm-list"},Ju={class:"col-auto message-speaker text-end pe-3"},Xu={class:"text-muted"},Qu={class:"col message-content-column"},Zu={class:"card-body p-2"},ep={class:"d-flex justify-content-between align-items-start mb-1"},tp={class:"comm-content"},sp="ffffffff-ffff-ffff-ffff-ffffffffffff",np={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=vt(),o=le(),i=X(),a=Fe(),r=ie(),d=D(!0),l=D(null),m=D(null),c=f(()=>o.projects.get(e.legionId));f(()=>c.value?.name||"Legion");const h=f(()=>t.currentComms);f(()=>t.currentMinions);function v(R){return R.from_minion_id===sp}function g(R){return R.from_user?"You":R.from_minion_id?v(R)?"SYSTEM":i.sessions.get(R.from_minion_id)?.name||"Unknown":"Unknown"}function x(R){return R.to_user?"You":R.to_minion_id?i.sessions.get(R.to_minion_id)?.name||"Unknown":R.to_channel_id?R.to_channel_name?`#${R.to_channel_name}`:R.to_channel_id:"All"}function _(R){return{task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success"}[R]||"bg-secondary"}function b(R){return new Date(R).toLocaleTimeString()}async function y(){r.autoScrollEnabled&&(await xs(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function M(){d.value=!0,l.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await xs(),await y(),setTimeout(()=>{y()},100)}catch(R){console.error("Failed to load timeline:",R),R.response?l.value=`${R.message} (${R.response.status})`:l.value=R.message||"Unknown error"}finally{d.value=!1}}function C(){a.connectLegion(e.legionId)}function w(){a.disconnectLegion()}return ne(()=>h.value.length,()=>{y()}),re(()=>{M(),C(),setTimeout(()=>{y()},100)}),pe(()=>{w()}),(R,V)=>(u(),p("div",qu,[te($u,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto p-3"},[d.value?(u(),p("div",zu,[...V[0]||(V[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),Y(" Loading timeline... ",-1)])])):l.value?(u(),p("div",Ku," Failed to load timeline: "+$(l.value),1)):h.value.length===0?(u(),p("div",Yu," No messages yet. Minions will appear here once they start communicating. ")):(u(),p("div",Gu,[(u(!0),p(Z,null,se(h.value,A=>(u(),p("div",{key:A.comm_id,class:z(["comm-item message-row row py-2 mb-2",{"system-comm":v(A)}])},[s("div",Ju,[s("small",Xu,$(b(A.timestamp)),1)]),s("div",Qu,[s("div",{class:z(["comm-card card",{"system-card":v(A)}])},[s("div",Zu,[s("div",ep,[s("div",null,[s("span",{class:z(["badge",_(A.comm_type)])},$(A.comm_type),3),s("strong",{class:z(["ms-2",{"system-sender":v(A)}])},$(g(A)),3),V[1]||(V[1]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",{class:z({"recipient-channel":A.to_channel_id})},$(x(A)),3)])]),s("div",tp,$(A.content),1)])],2)])],2))),128))]))],512),te(Bu,{"legion-id":n.legionId},null,8,["legion-id"]),te(Su,{"legion-id":n.legionId},null,8,["legion-id"])]))}},op=G(np,[["__scopeId","data-v-6d97bd0b"]]),ip={class:"spy-view d-flex flex-column overflow-hidden"},ap={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){return(e,t)=>(u(),p("div",ip,[te(oo,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},rp=G(ap,[["__scopeId","data-v-43a24eaf"]]),lp={class:"horde-header border-bottom p-3"},cp={class:"project-name"},dp={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=le(),o=f(()=>t.projects.get(e.legionId)),i=f(()=>o.value?.name||"Legion");return(a,r)=>(u(),p("div",lp,[s("div",null,[s("div",cp,$(i.value),1),r[0]||(r[0]=s("div",{class:"view-name"},"Minion Hierarchy",-1))])]))}},up=G(dp,[["__scopeId","data-v-0c86e2b5"]]),pp={class:"horde-status-bar border-top p-2 bg-light"},mp={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,t)=>(u(),p("div",pp,[...t[0]||(t[0]=[s("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},fp=G(mp,[["__scopeId","data-v-f0e64ab0"]]),vp={class:"minion-card border-start border-2 mb-2"},hp={class:"node-row"},_p={class:"node-left"},gp={key:0,class:"me-2"},bp={key:1,class:"badge bg-secondary ms-2"},yp={class:"node-right"},$p={key:0,class:"last-comm-preview"},wp={class:"comm-direction"},Ep=["title"],Cp={key:1,class:"text-muted fst-italic small"},Sp={key:0,class:"minion-children"},kp={key:1,class:"text-danger small ms-4"},Tp={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,t=f(()=>e.level*24),o=f(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=f(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=f(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),r=f(()=>{const c=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[c]||"status-dot-grey"}),d=f(()=>{const c=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}});function l(c){return c.to_user?"User":c.to_minion_name?c.to_minion_name:c.to_channel_name?`#${c.to_channel_name}`:"unknown"}function m(c){const h=c.summary||c.content||"";return h.length>150?h.substring(0,150)+"...":h}return(c,h)=>{const v=so("MinionTreeNode",!0);return n.minionData?(u(),p("div",{key:0,class:"minion-tree-node",style:Ne({marginLeft:`${t.value}px`})},[s("div",vp,[s("div",hp,[s("div",_p,[s("div",{class:z(["status-dot me-2",r.value]),style:Ne(d.value)},null,6),i.value?(u(),p("span",gp,"ðŸ‘‘")):j("",!0),s("strong",null,$(n.minionData.name),1),i.value?(u(),p("span",bp,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):j("",!0)]),s("div",yp,[n.minionData.last_comm?(u(),p("div",$p,[s("span",wp,[h[0]||(h[0]=Y(" â†’ ",-1)),s("strong",null,$(l(n.minionData.last_comm)),1),h[1]||(h[1]=Y(": ",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},$(m(n.minionData.last_comm)),9,Ep)])):(u(),p("div",Cp," No communications yet "))])])]),o.value?(u(),p("div",Sp,[(u(!0),p(Z,null,se(n.minionData.children,g=>(u(),_e(v,{key:g.id,"minion-data":g,level:n.level+1},null,8,["minion-data","level"]))),128))])):j("",!0)],4)):(u(),p("div",kp," âš  Minion data is missing "))}}},xp=G(Tp,[["__scopeId","data-v-1cd9863f"]]),Ap={class:"horde-view d-flex flex-column h-100"},Mp={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},Op={key:0,class:"text-center py-5"},Np={key:1,class:"alert alert-danger"},Dp={class:"mb-0"},Lp={key:2,class:"horde-tree"},Ip={class:"user-root-node mb-3 border rounded bg-white"},jp={class:"node-row"},Pp={class:"node-left"},Rp={key:0,class:"badge bg-primary ms-2"},Vp={class:"node-right"},Hp={key:0,class:"last-comm-preview"},Wp={class:"comm-direction"},Fp=["title"],Up={key:1,class:"text-muted fst-italic"},Bp={key:0,class:"alert alert-info ms-4"},qp={key:1,class:"root-minions ms-4"},zp={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=le(),o=X(),i=Fe(),a=vt(),r=D(null),d=D(!1),l=D(null);f(()=>t.projects.get(e.legionId));const m=f(()=>r.value&&r.value.children&&r.value.children.length>0);async function c(){d.value=!0,l.value=null;try{const _=await J.get(`/api/legions/${e.legionId}/hordes`);r.value=_,console.log("Loaded hierarchy:",_)}catch(_){console.error("Failed to load hierarchy:",_),l.value=_.message||"Unknown error"}finally{d.value=!1}}re(()=>{c()}),ne(()=>e.legionId,()=>{c()});function h(_){return _.to_user?"User":_.to_minion_name?_.to_minion_name:_.to_channel_name?`#${_.to_channel_name}`:"unknown"}function v(_){const b=_.summary||_.content||"";return b.length>150?b.substring(0,150)+"...":b}function g(_,b){if(_.id===b)return _;if(_.children)for(const y of _.children){const M=g(y,b);if(M)return M}return null}function x(_){if(r.value){if(_.from_minion_id){const b=g(r.value,_.from_minion_id);b&&b.type==="minion"&&(b.last_comm=_,console.log(`Updated minion ${b.name} last_comm`))}_.from_user&&r.value.type==="user"&&(r.value.last_comm=_,console.log("Updated user last_comm"))}}return re(()=>{c(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),ne(()=>o.sessions,_=>{if(r.value){for(const[b,y]of _)if(y.is_minion&&y.project_id===e.legionId){const M=g(r.value,b);M&&M.type==="minion"&&(M.state!==y.state&&(M.state=y.state,console.log(`Updated minion ${M.name} state to ${y.state}`)),M.is_processing!==y.is_processing&&(M.is_processing=y.is_processing,console.log(`Updated minion ${M.name} is_processing to ${y.is_processing}`)))}}},{deep:!0}),ne(()=>a.commsByLegion.get(e.legionId),_=>{if(_&&_.length>0){const b=_[_.length-1];x(b)}},{deep:!0}),ne(()=>o.sessions.size,(_,b)=>{_>b&&Array.from(o.sessions.values()).some(C=>C.is_minion&&C.project_id===e.legionId&&!g(r.value,C.session_id))&&(console.log("New minion detected, reloading hierarchy"),c())})}),pe(()=>{console.log("HordeView unmounted")}),(_,b)=>(u(),p("div",Ap,[te(up,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",Mp,[d.value?(u(),p("div",Op,[...b[0]||(b[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):l.value?(u(),p("div",Np,[b[1]||(b[1]=s("strong",null,"Failed to load hierarchy",-1)),s("p",Dp,$(l.value),1)])):r.value?(u(),p("div",Lp,[s("div",Ip,[s("div",jp,[s("div",Pp,[b[2]||(b[2]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,$(r.value.name),1),m.value?(u(),p("span",Rp,$(r.value.children.length)+" "+$(r.value.children.length===1?"minion":"minions"),1)):j("",!0)]),s("div",Vp,[r.value.last_comm?(u(),p("div",Hp,[s("span",Wp,[b[3]||(b[3]=Y(" â†’ ",-1)),s("strong",null,$(h(r.value.last_comm)),1),b[4]||(b[4]=Y(": ",-1))]),s("span",{class:"comm-content",title:r.value.last_comm.content||""},$(v(r.value.last_comm)),9,Fp)])):(u(),p("div",Up," No communications yet "))])])]),m.value?(u(),p("div",qp,[(u(!0),p(Z,null,se(r.value.children,y=>(u(),_e(xp,{key:y.id,"minion-data":y,level:1},null,8,["minion-data"]))),128))])):(u(),p("div",Bp,[...b[5]||(b[5]=[s("p",{class:"mb-2"},"No minions yet",-1),s("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):j("",!0)]),te(fp,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Kp=G(zp,[["__scopeId","data-v-af6338a3"]]),Yp={class:"channel-view d-flex flex-column h-100"},Gp={class:"channel-header border-bottom p-3"},Jp={class:"d-flex align-items-center justify-content-between"},Xp={class:"mb-0"},Qp={class:"text-muted"},Zp={class:"badge bg-secondary"},em={class:"channel-content flex-grow-1 overflow-auto"},tm={key:0,class:"text-center text-muted py-4"},sm={key:1,class:"text-center text-danger py-4"},nm={key:2,class:"text-center text-muted py-4"},om={key:3,class:"p-3"},im={class:"overview-section mb-4"},am={class:"row g-3"},rm={class:"col-md-6"},lm={class:"font-monospace small text-muted"},cm={class:"col-md-6"},dm={class:"text-muted"},um={class:"col-12"},pm={class:"text-muted"},mm={class:"col-12"},fm={class:"text-muted"},vm={class:"members-section mb-4"},hm={class:"text-muted border-bottom pb-2 d-flex align-items-center justify-content-between"},_m={key:0,class:"mb-3"},gm=["value"],bm={key:1,class:"text-center text-muted py-3"},ym={key:2,class:"list-group"},$m={class:"d-flex align-items-center gap-2"},wm=["title"],Em={class:"fw-semibold"},Cm={class:"text-muted"},Sm=["onClick"],km={class:"comms-section"},Tm={class:"text-muted border-bottom pb-2"},xm={key:0,class:"text-center text-muted py-4"},Am={key:1,class:"text-center text-muted py-3"},Mm={key:2,class:"comm-list"},Om={class:"card-body p-2"},Nm={class:"d-flex justify-content-between align-items-start mb-1"},Dm={class:"ms-2"},Lm={class:"text-muted ms-2"},Im={key:0,class:"text-muted small mb-1"},jm={class:"comm-content"},Pm={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,t=vt(),o=le(),i=X(),a=D(!0),r=D(null),d=D(!1),l=D(!1),m=D(""),c=f(()=>o.projects.get(e.legionId)),h=f(()=>t.channelDetailsByChannel.get(e.channelId)),v=f(()=>t.channelCommsByChannel.get(e.channelId)||[]),g=f(()=>h.value?.member_minion_ids?.length||0),x=f(()=>v.value.length),_=f(()=>h.value?.member_minion_ids?h.value.member_minion_ids.map(O=>i.sessions.get(O)).filter(Boolean):[]),b=f(()=>{if(!h.value)return[];const O=new Set(h.value.member_minion_ids||[]);return Array.from(i.sessions.values()).filter(E=>E.is_minion).filter(E=>!O.has(E.session_id))});function y(O){if(O.state==="paused"&&O.is_processing)return"status-blinking";const S=O.is_processing?"processing":O.state;return S==="starting"||S==="processing"?"status-blinking":""}function M(O){if(O.state==="paused"&&O.is_processing)return{backgroundColor:"#ffc107"};const S=O.is_processing?"processing":O.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[S]||"#d3d3d3"}}function C(O){return O.from_user?"You":O.from_minion_name?O.from_minion_name:O.from_minion_id&&i.sessions.get(O.from_minion_id)?.name||"Unknown"}function w(O){return{task:"bg-primary",question:"bg-info",report:"bg-success",info:"bg-secondary",halt:"bg-danger",pivot:"bg-warning"}[O?.toLowerCase()]||"bg-secondary"}function R(O){return O?new Date(O).toLocaleString():"N/A"}function V(O){return O?new Date(O).toLocaleString():"N/A"}async function A(){if(!(!m.value||!e.channelId))try{await t.addMemberToChannel(e.channelId,m.value),m.value="",l.value=!1}catch(O){console.error("Failed to add member:",O),alert("Failed to add member to channel")}}async function T(O){if(confirm("Remove this minion from the channel?"))try{await t.removeMemberFromChannel(e.channelId,O)}catch(E){console.error("Failed to remove member:",E),alert("Failed to remove member from channel")}}return re(async()=>{a.value=!0;try{await t.loadChannelDetails(e.channelId),d.value=!0,await t.loadChannelComms(e.channelId,1e3),d.value=!1}catch(O){console.error("Failed to load channel:",O),r.value=O.message||"Unknown error"}finally{a.value=!1}}),ne(()=>e.channelId,async O=>{if(O){a.value=!0,r.value=null;try{await t.loadChannelDetails(O),d.value=!0,await t.loadChannelComms(O,1e3),d.value=!1}catch(S){console.error("Failed to load channel:",S),r.value=S.message||"Unknown error"}finally{a.value=!1}}}),(O,S)=>(u(),p("div",Yp,[s("div",Gp,[s("div",Jp,[s("div",null,[s("h5",Xp," ðŸ’¬ "+$(h.value?.name||"Channel"),1),s("small",Qp,$(c.value?.name||"Legion"),1)]),s("span",Zp,$(g.value)+" members",1)])]),s("div",em,[a.value?(u(),p("div",tm,[...S[2]||(S[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),s("div",{class:"mt-2"},"Loading channel...",-1)])])):r.value?(u(),p("div",sm," Failed to load channel: "+$(r.value),1)):h.value?(u(),p("div",om,[s("div",im,[S[7]||(S[7]=s("h6",{class:"text-muted border-bottom pb-2"},"Overview",-1)),s("div",am,[s("div",rm,[S[3]||(S[3]=s("strong",null,"Channel ID:",-1)),s("div",lm,$(h.value.channel_id),1)]),s("div",cm,[S[4]||(S[4]=s("strong",null,"Created:",-1)),s("div",dm,$(R(h.value.created_at)),1)]),s("div",um,[S[5]||(S[5]=s("strong",null,"Purpose:",-1)),s("div",pm,$(h.value.purpose||"No purpose specified"),1)]),s("div",mm,[S[6]||(S[6]=s("strong",null,"Description:",-1)),s("div",fm,$(h.value.description||"No description provided"),1)])])]),s("div",vm,[s("h6",hm,[s("span",null,"Members ("+$(g.value)+")",1),s("button",{class:"btn btn-sm btn-primary",onClick:S[0]||(S[0]=E=>l.value=!l.value)}," âž• Add Member ")]),l.value?(u(),p("div",_m,[Q(s("select",{"onUpdate:modelValue":S[1]||(S[1]=E=>m.value=E),class:"form-select form-select-sm",onChange:A},[S[8]||(S[8]=s("option",{value:""},"-- Select Minion to Add --",-1)),(u(!0),p(Z,null,se(b.value,E=>(u(),p("option",{key:E.session_id,value:E.session_id},$(E.name)+" ("+$(E.role||"No role")+") ",9,gm))),128))],544),[[je,m.value]])])):j("",!0),_.value.length===0?(u(),p("div",bm," No members in this channel yet ")):(u(),p("div",ym,[(u(!0),p(Z,null,se(_.value,E=>(u(),p("div",{key:E.session_id,class:"list-group-item d-flex align-items-center justify-content-between"},[s("div",$m,[s("span",{class:z(["status-dot",y(E)]),style:Ne(M(E)),title:E.state},null,14,wm),s("div",null,[s("div",Em,$(E.name),1),s("small",Cm,$(E.role||"No role"),1)])]),s("button",{class:"btn btn-sm btn-outline-danger",onClick:k=>T(E.session_id),title:"Remove member from channel"}," Remove ",8,Sm)]))),128))]))]),s("div",km,[s("h6",Tm,"Communications ("+$(x.value)+")",1),d.value?(u(),p("div",xm,[...S[9]||(S[9]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),s("div",{class:"mt-2"},"Loading comms...",-1)])])):v.value.length===0?(u(),p("div",Am," No communications in this channel yet ")):(u(),p("div",Mm,[(u(!0),p(Z,null,se(v.value,E=>(u(),p("div",{key:E.comm_id,class:"comm-item card mb-2"},[s("div",Om,[s("div",Nm,[s("div",null,[s("span",{class:z(["badge",w(E.comm_type)])},$(E.comm_type),3),s("strong",Dm,$(C(E)),1),s("small",Lm,$(V(E.timestamp)),1)])]),E.summary?(u(),p("div",Im,[S[10]||(S[10]=s("strong",null,"Summary:",-1)),Y(" "+$(E.summary),1)])):j("",!0),s("div",jm,$(E.content),1)])]))),128))]))])])):(u(),p("div",nm," Channel not found "))])]))}},Rm=G(Pm,[["__scopeId","data-v-e09adf09"]]),Vm=[{path:"/",name:"home",component:gi},{path:"/session/:sessionId",name:"session",component:oo,props:!0},{path:"/timeline/:legionId",name:"timeline",component:op,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:rp,props:!0},{path:"/horde/:legionId",name:"horde",component:Kp,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:Rm,props:!0}],Hm=pi({history:mi(),routes:Vm}),Wm={__name:"ConnectionIndicator",setup(n){const e=Fe(),t=f(()=>{switch(e.overallStatus){case"connected":return"bg-success";case"partial":return"bg-warning";default:return"bg-secondary"}}),o=f(()=>{switch(e.overallStatus){case"connected":return"Connected";case"partial":return"Partial Connection";default:return"Disconnected"}});return(i,a)=>(u(),p("span",{id:"connection-indicator",class:z(["badge",t.value])},$(o.value),3))}},Fm={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Um={class:"d-flex align-items-center gap-2"},Bm={__name:"AppHeader",setup(n){const e=ie();function t(){e.toggleSidebar()}return(o,i)=>(u(),p("header",Fm,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",Um,[te(Wm)])]))}},qm={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},zm={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Km=["title"],Ym={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=f(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function i(d){const l=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[l]||"#d3d3d3"}function a(d){const l=o(d);return l==="starting"||l==="processing"||l==="pending-prompt"}function r(d){const l=o(d),m=l.charAt(0).toUpperCase()+l.slice(1),c=d.name||"Unnamed Session",h=d.is_minion&&d.role?` (${d.role})`:"";return`${c}${h}: ${m}`}return(d,l)=>(u(),p("div",qm,[!n.sessions||n.sessions.length===0?(u(),p("div",zm)):(u(!0),p(Z,{key:1},se(n.sessions,m=>(u(),p("div",{key:m.session_id,class:z(["progress-bar",{"progress-bar-striped progress-bar-animated":a(m)}]),style:Ne({width:t.value,backgroundColor:i(m),cursor:"help"}),title:r(m)},null,14,Km))),128))]))}},Gm=G(Ym,[["__scopeId","data-v-a79cfeec"]]),Jm={class:"flex-grow-1"},Xm={key:0,class:"text-muted small ms-1"},Qm={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,t=We(),o=X(),i=le(),a=ie(),r=f(()=>o.currentSessionId===e.session.session_id),d=f(()=>o.deletingSessions.has(e.session.session_id)),l=f(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),m=f(()=>{const y=l.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[y]||"status-dot-grey"}),c=f(()=>{const y=l.value,M={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},C={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:M[y]||"#d3d3d3",borderColor:C[y]||"#6c757d"}});function h(){o.selectSession(e.session.session_id),t.push(`/session/${e.session.session_id}`)}function v(){a.showModal("edit-session",{session:e.session})}function g(y){y.dataTransfer.effectAllowed="move",y.dataTransfer.setData("application/session-id",e.session.session_id),y.dataTransfer.setData("application/project-id",e.projectId),y.dataTransfer.setData("text/plain",e.session.session_id),y.target.classList.add("dragging")}function x(y){y.target.classList.remove("dragging")}function _(y){y.preventDefault(),y.dataTransfer.dropEffect="move";const M=y.currentTarget.getBoundingClientRect(),C=M.top+M.height/2;y.clientY<C?(y.currentTarget.classList.add("drop-above"),y.currentTarget.classList.remove("drop-below")):(y.currentTarget.classList.add("drop-below"),y.currentTarget.classList.remove("drop-above"))}function b(y){y.preventDefault(),y.currentTarget.classList.remove("drop-above","drop-below");const M=y.dataTransfer.getData("application/session-id")||y.dataTransfer.getData("text/plain"),C=y.dataTransfer.getData("application/project-id");if(!M||M===e.session.session_id||C!==e.projectId)return;const w=y.currentTarget.getBoundingClientRect(),R=w.top+w.height/2,V=y.clientY<R,A=i.getProject(e.projectId);if(!A||!A.session_ids)return;const T=[...A.session_ids],O=T.indexOf(e.session.session_id),S=T.indexOf(M);if(O===-1||S===-1)return;const E=[...T],[k]=E.splice(S,1);let N=V?O:O+1;S<O&&N--,E.splice(N,0,k),i.reorderSessionsInProject(e.projectId,E)}return(y,M)=>(u(),p("div",{class:z(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:r.value,"session-deleting":d.value}]),style:{cursor:"pointer"},draggable:"true",onClick:h,onDragstart:g,onDragend:x,onDragover:_,onDrop:b},[s("div",{class:z(["status-dot me-2",m.value]),style:Ne(c.value)},null,6),s("div",Jm,[s("span",null,$(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(u(),p("span",Xm,"("+$(n.session.role)+")",1)):j("",!0)]),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:ce(v,["stop"])}," âœï¸ ")],34))}},Zm=G(Qm,[["__scopeId","data-v-07ecbf94"]]),ef={class:"d-flex align-items-center gap-2"},tf=["value"],sf={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=We(),o=X(),i=ie(),a=D("");ne(()=>t.currentRoute.value,_=>{!a.value&&_.name==="spy"&&_.params.minionId&&_.params.legionId===e.project.project_id&&(a.value=_.params.minionId)},{immediate:!0});const r=f(()=>a.value?e.sessions.find(_=>_.session_id===a.value):null),d=f(()=>{const _=t.currentRoute.value;return _.name==="spy"&&_.params.legionId===e.project.project_id}),l=f(()=>{if(!r.value)return"";if(r.value.state==="paused"&&r.value.is_processing)return"status-blinking";const _=r.value.is_processing?"processing":r.value.state;return _==="starting"||_==="processing"?"status-blinking":""}),m=f(()=>{if(!r.value)return{};if(r.value.state==="paused"&&r.value.is_processing)return{backgroundColor:"#ffc107"};const _=r.value.is_processing?"processing":r.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[_]||"#d3d3d3"}});function c(_){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[_.state]||"â—‹"}function h(_){return _.is_minion&&_.role?`${_.name} (${_.role})`:_.name}function v(){a.value&&t.push(`/spy/${e.project.project_id}/${a.value}`)}function g(){a.value?t.push(`/spy/${e.project.project_id}/${a.value}`):t.push("/")}function x(){r.value&&i.showModal("minion-view",{session:r.value})}return ne(()=>o.currentSessionId,_=>{if(_)e.sessions.some(b=>b.session_id===_)&&(a.value=_);else{a.value="";const b=t.currentRoute.value;b.name==="spy"&&b.params.legionId===e.project.project_id&&t.push("/")}}),(_,b)=>(u(),p("div",{class:z(["list-group-item list-group-item-action p-2",{active:d.value}])},[s("div",{class:"d-flex align-items-center justify-content-between mb-2",style:Ne({cursor:a.value?"pointer":"default"}),onClick:v},[b[1]||(b[1]=s("div",{class:"d-flex align-items-center"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ”"),s("span",{class:"fw-semibold"},"Spy"),s("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),s("div",ef,[r.value?(u(),p("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:ce(x,["stop"]),title:"View minion details"}," ðŸ‘ï¸ ")):j("",!0),r.value?(u(),p("span",{key:1,class:z(["minion-state-indicator",l.value]),style:Ne(m.value)}," ðŸ‘¤ ",6)):j("",!0)])],4),Q(s("select",{"onUpdate:modelValue":b[0]||(b[0]=y=>a.value=y),class:"form-select form-select-sm",onChange:g},[b[2]||(b[2]=s("option",{value:""},"-- Select Minion --",-1)),(u(!0),p(Z,null,se(n.sessions,y=>(u(),p("option",{key:y.session_id,value:y.session_id},$(c(y))+" "+$(h(y)),9,tf))),128))],544),[[je,a.value]])],2))}},nf=G(sf,[["__scopeId","data-v-579589fb"]]);var de="top",ge="bottom",be="right",ue="left",Qt="auto",ht=[de,ge,be,ue],Qe="start",lt="end",io="clippingParents",Ps="viewport",ot="popper",ao="reference",As=ht.reduce(function(n,e){return n.concat([e+"-"+Qe,e+"-"+lt])},[]),Rs=[].concat(ht,[Qt]).reduce(function(n,e){return n.concat([e,e+"-"+Qe,e+"-"+lt])},[]),ro="beforeRead",lo="read",co="afterRead",uo="beforeMain",po="main",mo="afterMain",fo="beforeWrite",vo="write",ho="afterWrite",_o=[ro,lo,co,uo,po,mo,fo,vo,ho];function Ae(n){return n?(n.nodeName||"").toLowerCase():null}function ye(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Ze(n){var e=ye(n).Element;return n instanceof e||n instanceof Element}function $e(n){var e=ye(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Vs(n){if(typeof ShadowRoot>"u")return!1;var e=ye(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function of(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!$e(a)||!Ae(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var d=i[r];d===!1?a.removeAttribute(r):a.setAttribute(r,d===!0?"":d)}))})}function af(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),d=r.reduce(function(l,m){return l[m]="",l},{});!$e(i)||!Ae(i)||(Object.assign(i.style,d),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const Hs={name:"applyStyles",enabled:!0,phase:"write",fn:of,effect:af,requires:["computeStyles"]};function ke(n){return n.split("-")[0]}var Xe=Math.max,Kt=Math.min,ct=Math.round;function Ms(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function go(){return!/^((?!chrome|android).)*safari/i.test(Ms())}function dt(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&$e(n)&&(i=n.offsetWidth>0&&ct(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&ct(o.height)/n.offsetHeight||1);var r=Ze(n)?ye(n):window,d=r.visualViewport,l=!go()&&t,m=(o.left+(l&&d?d.offsetLeft:0))/i,c=(o.top+(l&&d?d.offsetTop:0))/a,h=o.width/i,v=o.height/a;return{width:h,height:v,top:c,right:m+h,bottom:c+v,left:m,x:m,y:c}}function Ws(n){var e=dt(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function bo(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Vs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function De(n){return ye(n).getComputedStyle(n)}function rf(n){return["table","td","th"].indexOf(Ae(n))>=0}function Ue(n){return((Ze(n)?n.ownerDocument:n.document)||window.document).documentElement}function Zt(n){return Ae(n)==="html"?n:n.assignedSlot||n.parentNode||(Vs(n)?n.host:null)||Ue(n)}function bn(n){return!$e(n)||De(n).position==="fixed"?null:n.offsetParent}function lf(n){var e=/firefox/i.test(Ms()),t=/Trident/i.test(Ms());if(t&&$e(n)){var o=De(n);if(o.position==="fixed")return null}var i=Zt(n);for(Vs(i)&&(i=i.host);$e(i)&&["html","body"].indexOf(Ae(i))<0;){var a=De(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function xt(n){for(var e=ye(n),t=bn(n);t&&rf(t)&&De(t).position==="static";)t=bn(t);return t&&(Ae(t)==="html"||Ae(t)==="body"&&De(t).position==="static")?e:t||lf(n)||e}function Fs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function wt(n,e,t){return Xe(n,Kt(e,t))}function cf(n,e,t){var o=wt(n,e,t);return o>t?t:o}function yo(){return{top:0,right:0,bottom:0,left:0}}function $o(n){return Object.assign({},yo(),n)}function wo(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var df=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,$o(typeof e!="number"?e:wo(e,ht))};function uf(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,r=t.modifiersData.popperOffsets,d=ke(t.placement),l=Fs(d),m=[ue,be].indexOf(d)>=0,c=m?"height":"width";if(!(!a||!r)){var h=df(i.padding,t),v=Ws(a),g=l==="y"?de:ue,x=l==="y"?ge:be,_=t.rects.reference[c]+t.rects.reference[l]-r[l]-t.rects.popper[c],b=r[l]-t.rects.reference[l],y=xt(a),M=y?l==="y"?y.clientHeight||0:y.clientWidth||0:0,C=_/2-b/2,w=h[g],R=M-v[c]-h[x],V=M/2-v[c]/2+C,A=wt(w,V,R),T=l;t.modifiersData[o]=(e={},e[T]=A,e.centerOffset=A-V,e)}}function pf(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||bo(e.elements.popper,i)&&(e.elements.arrow=i))}const Eo={name:"arrow",enabled:!0,phase:"main",fn:uf,effect:pf,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ut(n){return n.split("-")[1]}var mf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ff(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:ct(t*i)/i||0,y:ct(o*i)/i||0}}function yn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,r=n.offsets,d=n.position,l=n.gpuAcceleration,m=n.adaptive,c=n.roundOffsets,h=n.isFixed,v=r.x,g=v===void 0?0:v,x=r.y,_=x===void 0?0:x,b=typeof c=="function"?c({x:g,y:_}):{x:g,y:_};g=b.x,_=b.y;var y=r.hasOwnProperty("x"),M=r.hasOwnProperty("y"),C=ue,w=de,R=window;if(m){var V=xt(t),A="clientHeight",T="clientWidth";if(V===ye(t)&&(V=Ue(t),De(V).position!=="static"&&d==="absolute"&&(A="scrollHeight",T="scrollWidth")),V=V,i===de||(i===ue||i===be)&&a===lt){w=ge;var O=h&&V===R&&R.visualViewport?R.visualViewport.height:V[A];_-=O-o.height,_*=l?1:-1}if(i===ue||(i===de||i===ge)&&a===lt){C=be;var S=h&&V===R&&R.visualViewport?R.visualViewport.width:V[T];g-=S-o.width,g*=l?1:-1}}var E=Object.assign({position:d},m&&mf),k=c===!0?ff({x:g,y:_},ye(t)):{x:g,y:_};if(g=k.x,_=k.y,l){var N;return Object.assign({},E,(N={},N[w]=M?"0":"",N[C]=y?"0":"",N.transform=(R.devicePixelRatio||1)<=1?"translate("+g+"px, "+_+"px)":"translate3d("+g+"px, "+_+"px, 0)",N))}return Object.assign({},E,(e={},e[w]=M?_+"px":"",e[C]=y?g+"px":"",e.transform="",e))}function vf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,r=a===void 0?!0:a,d=t.roundOffsets,l=d===void 0?!0:d,m={placement:ke(e.placement),variation:ut(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,yn(Object.assign({},m,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,yn(Object.assign({},m,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Us={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:vf,data:{}};var It={passive:!0};function hf(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,d=r===void 0?!0:r,l=ye(e.elements.popper),m=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&m.forEach(function(c){c.addEventListener("scroll",t.update,It)}),d&&l.addEventListener("resize",t.update,It),function(){a&&m.forEach(function(c){c.removeEventListener("scroll",t.update,It)}),d&&l.removeEventListener("resize",t.update,It)}}const Bs={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:hf,data:{}};var _f={left:"right",right:"left",bottom:"top",top:"bottom"};function Ft(n){return n.replace(/left|right|bottom|top/g,function(e){return _f[e]})}var gf={start:"end",end:"start"};function $n(n){return n.replace(/start|end/g,function(e){return gf[e]})}function qs(n){var e=ye(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function zs(n){return dt(Ue(n)).left+qs(n).scrollLeft}function bf(n,e){var t=ye(n),o=Ue(n),i=t.visualViewport,a=o.clientWidth,r=o.clientHeight,d=0,l=0;if(i){a=i.width,r=i.height;var m=go();(m||!m&&e==="fixed")&&(d=i.offsetLeft,l=i.offsetTop)}return{width:a,height:r,x:d+zs(n),y:l}}function yf(n){var e,t=Ue(n),o=qs(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=Xe(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=Xe(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),d=-o.scrollLeft+zs(n),l=-o.scrollTop;return De(i||t).direction==="rtl"&&(d+=Xe(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:d,y:l}}function Ks(n){var e=De(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Co(n){return["html","body","#document"].indexOf(Ae(n))>=0?n.ownerDocument.body:$e(n)&&Ks(n)?n:Co(Zt(n))}function Et(n,e){var t;e===void 0&&(e=[]);var o=Co(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=ye(o),r=i?[a].concat(a.visualViewport||[],Ks(o)?o:[]):o,d=e.concat(r);return i?d:d.concat(Et(Zt(r)))}function Os(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function $f(n,e){var t=dt(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function wn(n,e,t){return e===Ps?Os(bf(n,t)):Ze(e)?$f(e,t):Os(yf(Ue(n)))}function wf(n){var e=Et(Zt(n)),t=["absolute","fixed"].indexOf(De(n).position)>=0,o=t&&$e(n)?xt(n):n;return Ze(o)?e.filter(function(i){return Ze(i)&&bo(i,o)&&Ae(i)!=="body"}):[]}function Ef(n,e,t,o){var i=e==="clippingParents"?wf(n):[].concat(e),a=[].concat(i,[t]),r=a[0],d=a.reduce(function(l,m){var c=wn(n,m,o);return l.top=Xe(c.top,l.top),l.right=Kt(c.right,l.right),l.bottom=Kt(c.bottom,l.bottom),l.left=Xe(c.left,l.left),l},wn(n,r,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function So(n){var e=n.reference,t=n.element,o=n.placement,i=o?ke(o):null,a=o?ut(o):null,r=e.x+e.width/2-t.width/2,d=e.y+e.height/2-t.height/2,l;switch(i){case de:l={x:r,y:e.y-t.height};break;case ge:l={x:r,y:e.y+e.height};break;case be:l={x:e.x+e.width,y:d};break;case ue:l={x:e.x-t.width,y:d};break;default:l={x:e.x,y:e.y}}var m=i?Fs(i):null;if(m!=null){var c=m==="y"?"height":"width";switch(a){case Qe:l[m]=l[m]-(e[c]/2-t[c]/2);break;case lt:l[m]=l[m]+(e[c]/2-t[c]/2);break}}return l}function pt(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,r=a===void 0?n.strategy:a,d=t.boundary,l=d===void 0?io:d,m=t.rootBoundary,c=m===void 0?Ps:m,h=t.elementContext,v=h===void 0?ot:h,g=t.altBoundary,x=g===void 0?!1:g,_=t.padding,b=_===void 0?0:_,y=$o(typeof b!="number"?b:wo(b,ht)),M=v===ot?ao:ot,C=n.rects.popper,w=n.elements[x?M:v],R=Ef(Ze(w)?w:w.contextElement||Ue(n.elements.popper),l,c,r),V=dt(n.elements.reference),A=So({reference:V,element:C,placement:i}),T=Os(Object.assign({},C,A)),O=v===ot?T:V,S={top:R.top-O.top+y.top,bottom:O.bottom-R.bottom+y.bottom,left:R.left-O.left+y.left,right:O.right-R.right+y.right},E=n.modifiersData.offset;if(v===ot&&E){var k=E[i];Object.keys(S).forEach(function(N){var I=[be,ge].indexOf(N)>=0?1:-1,H=[de,ge].indexOf(N)>=0?"y":"x";S[N]+=k[H]*I})}return S}function Cf(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,r=t.padding,d=t.flipVariations,l=t.allowedAutoPlacements,m=l===void 0?Rs:l,c=ut(o),h=c?d?As:As.filter(function(x){return ut(x)===c}):ht,v=h.filter(function(x){return m.indexOf(x)>=0});v.length===0&&(v=h);var g=v.reduce(function(x,_){return x[_]=pt(n,{placement:_,boundary:i,rootBoundary:a,padding:r})[ke(_)],x},{});return Object.keys(g).sort(function(x,_){return g[x]-g[_]})}function Sf(n){if(ke(n)===Qt)return[];var e=Ft(n);return[$n(n),e,$n(e)]}function kf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,d=r===void 0?!0:r,l=t.fallbackPlacements,m=t.padding,c=t.boundary,h=t.rootBoundary,v=t.altBoundary,g=t.flipVariations,x=g===void 0?!0:g,_=t.allowedAutoPlacements,b=e.options.placement,y=ke(b),M=y===b,C=l||(M||!x?[Ft(b)]:Sf(b)),w=[b].concat(C).reduce(function(ee,he){return ee.concat(ke(he)===Qt?Cf(e,{placement:he,boundary:c,rootBoundary:h,padding:m,flipVariations:x,allowedAutoPlacements:_}):he)},[]),R=e.rects.reference,V=e.rects.popper,A=new Map,T=!0,O=w[0],S=0;S<w.length;S++){var E=w[S],k=ke(E),N=ut(E)===Qe,I=[de,ge].indexOf(k)>=0,H=I?"width":"height",L=pt(e,{placement:E,boundary:c,rootBoundary:h,altBoundary:v,padding:m}),P=I?N?be:ue:N?ge:de;R[H]>V[H]&&(P=Ft(P));var U=Ft(P),B=[];if(a&&B.push(L[k]<=0),d&&B.push(L[P]<=0,L[U]<=0),B.every(function(ee){return ee})){O=E,T=!1;break}A.set(E,B)}if(T)for(var K=x?3:1,oe=function(he){var ze=w.find(function(Dt){var Ke=A.get(Dt);if(Ke)return Ke.slice(0,he).every(function(as){return as})});if(ze)return O=ze,"break"},ve=K;ve>0;ve--){var F=oe(ve);if(F==="break")break}e.placement!==O&&(e.modifiersData[o]._skip=!0,e.placement=O,e.reset=!0)}}const ko={name:"flip",enabled:!0,phase:"main",fn:kf,requiresIfExists:["offset"],data:{_skip:!1}};function En(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Cn(n){return[de,be,ge,ue].some(function(e){return n[e]>=0})}function Tf(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=pt(e,{elementContext:"reference"}),d=pt(e,{altBoundary:!0}),l=En(r,o),m=En(d,i,a),c=Cn(l),h=Cn(m);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:m,isReferenceHidden:c,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":h})}const To={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Tf};function xf(n,e,t){var o=ke(n),i=[ue,de].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,r=a[0],d=a[1];return r=r||0,d=(d||0)*i,[ue,be].indexOf(o)>=0?{x:d,y:r}:{x:r,y:d}}function Af(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,r=Rs.reduce(function(c,h){return c[h]=xf(h,e.rects,a),c},{}),d=r[e.placement],l=d.x,m=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=m),e.modifiersData[o]=r}const xo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Af};function Mf(n){var e=n.state,t=n.name;e.modifiersData[t]=So({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Ys={name:"popperOffsets",enabled:!0,phase:"read",fn:Mf,data:{}};function Of(n){return n==="x"?"y":"x"}function Nf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,d=r===void 0?!1:r,l=t.boundary,m=t.rootBoundary,c=t.altBoundary,h=t.padding,v=t.tether,g=v===void 0?!0:v,x=t.tetherOffset,_=x===void 0?0:x,b=pt(e,{boundary:l,rootBoundary:m,padding:h,altBoundary:c}),y=ke(e.placement),M=ut(e.placement),C=!M,w=Fs(y),R=Of(w),V=e.modifiersData.popperOffsets,A=e.rects.reference,T=e.rects.popper,O=typeof _=="function"?_(Object.assign({},e.rects,{placement:e.placement})):_,S=typeof O=="number"?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),E=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,k={x:0,y:0};if(V){if(a){var N,I=w==="y"?de:ue,H=w==="y"?ge:be,L=w==="y"?"height":"width",P=V[w],U=P+b[I],B=P-b[H],K=g?-T[L]/2:0,oe=M===Qe?A[L]:T[L],ve=M===Qe?-T[L]:-A[L],F=e.elements.arrow,ee=g&&F?Ws(F):{width:0,height:0},he=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:yo(),ze=he[I],Dt=he[H],Ke=wt(0,A[L],ee[L]),as=C?A[L]/2-K-Ke-ze-S.mainAxis:oe-Ke-ze-S.mainAxis,ai=C?-A[L]/2+K+Ke+Dt+S.mainAxis:ve+Ke+Dt+S.mainAxis,rs=e.elements.arrow&&xt(e.elements.arrow),ri=rs?w==="y"?rs.clientTop||0:rs.clientLeft||0:0,sn=(N=E?.[w])!=null?N:0,li=P+as-sn-ri,ci=P+ai-sn,nn=wt(g?Kt(U,li):U,P,g?Xe(B,ci):B);V[w]=nn,k[w]=nn-P}if(d){var on,di=w==="x"?de:ue,ui=w==="x"?ge:be,Ye=V[R],Lt=R==="y"?"height":"width",an=Ye+b[di],rn=Ye-b[ui],ls=[de,ue].indexOf(y)!==-1,ln=(on=E?.[R])!=null?on:0,cn=ls?an:Ye-A[Lt]-T[Lt]-ln+S.altAxis,dn=ls?Ye+A[Lt]+T[Lt]-ln-S.altAxis:rn,un=g&&ls?cf(cn,Ye,dn):wt(g?cn:an,Ye,g?dn:rn);V[R]=un,k[R]=un-Ye}e.modifiersData[o]=k}}const Ao={name:"preventOverflow",enabled:!0,phase:"main",fn:Nf,requiresIfExists:["offset"]};function Df(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Lf(n){return n===ye(n)||!$e(n)?qs(n):Df(n)}function If(n){var e=n.getBoundingClientRect(),t=ct(e.width)/n.offsetWidth||1,o=ct(e.height)/n.offsetHeight||1;return t!==1||o!==1}function jf(n,e,t){t===void 0&&(t=!1);var o=$e(e),i=$e(e)&&If(e),a=Ue(e),r=dt(n,i,t),d={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(o||!o&&!t)&&((Ae(e)!=="body"||Ks(a))&&(d=Lf(e)),$e(e)?(l=dt(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=zs(a))),{x:r.left+d.scrollLeft-l.x,y:r.top+d.scrollTop-l.y,width:r.width,height:r.height}}function Pf(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(d){if(!t.has(d)){var l=e.get(d);l&&i(l)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function Rf(n){var e=Pf(n);return _o.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Vf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Hf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var Sn={placement:"bottom",modifiers:[],strategy:"absolute"};function kn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function es(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?Sn:i;return function(d,l,m){m===void 0&&(m=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Sn,a),modifiersData:{},elements:{reference:d,popper:l},attributes:{},styles:{}},h=[],v=!1,g={state:c,setOptions:function(y){var M=typeof y=="function"?y(c.options):y;_(),c.options=Object.assign({},a,c.options,M),c.scrollParents={reference:Ze(d)?Et(d):d.contextElement?Et(d.contextElement):[],popper:Et(l)};var C=Rf(Hf([].concat(o,c.options.modifiers)));return c.orderedModifiers=C.filter(function(w){return w.enabled}),x(),g.update()},forceUpdate:function(){if(!v){var y=c.elements,M=y.reference,C=y.popper;if(kn(M,C)){c.rects={reference:jf(M,xt(C),c.options.strategy==="fixed"),popper:Ws(C)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(S){return c.modifiersData[S.name]=Object.assign({},S.data)});for(var w=0;w<c.orderedModifiers.length;w++){if(c.reset===!0){c.reset=!1,w=-1;continue}var R=c.orderedModifiers[w],V=R.fn,A=R.options,T=A===void 0?{}:A,O=R.name;typeof V=="function"&&(c=V({state:c,options:T,name:O,instance:g})||c)}}}},update:Vf(function(){return new Promise(function(b){g.forceUpdate(),b(c)})}),destroy:function(){_(),v=!0}};if(!kn(d,l))return g;g.setOptions(m).then(function(b){!v&&m.onFirstUpdate&&m.onFirstUpdate(b)});function x(){c.orderedModifiers.forEach(function(b){var y=b.name,M=b.options,C=M===void 0?{}:M,w=b.effect;if(typeof w=="function"){var R=w({state:c,name:y,instance:g,options:C}),V=function(){};h.push(R||V)}})}function _(){h.forEach(function(b){return b()}),h=[]}return g}}var Wf=es(),Ff=[Bs,Ys,Us,Hs],Uf=es({defaultModifiers:Ff}),Bf=[Bs,Ys,Us,Hs,xo,ko,Ao,Eo,To],Gs=es({defaultModifiers:Bf});const Mo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:mo,afterRead:co,afterWrite:ho,applyStyles:Hs,arrow:Eo,auto:Qt,basePlacements:ht,beforeMain:uo,beforeRead:ro,beforeWrite:fo,bottom:ge,clippingParents:io,computeStyles:Us,createPopper:Gs,createPopperBase:Wf,createPopperLite:Uf,detectOverflow:pt,end:lt,eventListeners:Bs,flip:ko,hide:To,left:ue,main:po,modifierPhases:_o,offset:xo,placements:Rs,popper:ot,popperGenerator:es,popperOffsets:Ys,preventOverflow:Ao,read:lo,reference:ao,right:be,start:Qe,top:de,variationPlacements:As,viewport:Ps,write:vo},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Ie=new Map,ps={set(n,e,t){Ie.has(n)||Ie.set(n,new Map);const o=Ie.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Ie.has(n)&&Ie.get(n).get(e)||null},remove(n,e){if(!Ie.has(n))return;const t=Ie.get(n);t.delete(e),t.size===0&&Ie.delete(n)}},qf=1e6,zf=1e3,Ns="transitionend",Oo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Kf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Yf=n=>{do n+=Math.floor(Math.random()*qf);while(document.getElementById(n));return n},Gf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*zf)},No=n=>{n.dispatchEvent(new Event(Ns))},Me=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Pe=n=>Me(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Oo(n)):null,_t=n=>{if(!Me(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Re=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Do=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Do(n.parentNode):null},Yt=()=>{},At=n=>{n.offsetHeight},Lo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,ms=[],Jf=n=>{document.readyState==="loading"?(ms.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of ms)e()}),ms.push(n)):n()},we=()=>document.documentElement.dir==="rtl",Ce=n=>{Jf(()=>{const e=Lo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},me=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Io=(n,e,t=!0)=>{if(!t){me(n);return}const i=Gf(e)+5;let a=!1;const r=({target:d})=>{d===e&&(a=!0,e.removeEventListener(Ns,r),me(n))};e.addEventListener(Ns,r),setTimeout(()=>{a||No(e)},i)},Js=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},Xf=/[^.]*(?=\..*)\.|.*/,Qf=/\..*/,Zf=/::\d+$/,fs={};let Tn=1;const jo={mouseenter:"mouseover",mouseleave:"mouseout"},ev=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Po(n,e){return e&&`${e}::${Tn++}`||n.uidEvent||Tn++}function Ro(n){const e=Po(n);return n.uidEvent=e,fs[e]=fs[e]||{},fs[e]}function tv(n,e){return function t(o){return Xs(o,{delegateTarget:n}),t.oneOff&&W.off(n,o.type,e),e.apply(n,[o])}}function sv(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const d of a)if(d===r)return Xs(i,{delegateTarget:r}),o.oneOff&&W.off(n,i.type,e,t),t.apply(r,[i])}}function Vo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Ho(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Wo(n);return ev.has(a)||(a=n),[o,i,a]}function xn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,r,d]=Ho(e,t,o);e in jo&&(r=(x=>function(_){if(!_.relatedTarget||_.relatedTarget!==_.delegateTarget&&!_.delegateTarget.contains(_.relatedTarget))return x.call(this,_)})(r));const l=Ro(n),m=l[d]||(l[d]={}),c=Vo(m,r,a?t:null);if(c){c.oneOff=c.oneOff&&i;return}const h=Po(r,e.replace(Xf,"")),v=a?sv(n,t,r):tv(n,r);v.delegationSelector=a?t:null,v.callable=r,v.oneOff=i,v.uidEvent=h,m[h]=v,n.addEventListener(d,v,a)}function Ds(n,e,t,o,i){const a=Vo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function nv(n,e,t,o){const i=e[t]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&Ds(n,e,t,r.callable,r.delegationSelector)}function Wo(n){return n=n.replace(Qf,""),jo[n]||n}const W={on(n,e,t,o){xn(n,e,t,o,!1)},one(n,e,t,o){xn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,r]=Ho(e,t,o),d=r!==e,l=Ro(n),m=l[r]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(m).length)return;Ds(n,l,r,a,i?t:null);return}if(c)for(const h of Object.keys(l))nv(n,l,h,e.slice(1));for(const[h,v]of Object.entries(m)){const g=h.replace(Zf,"");(!d||e.includes(g))&&Ds(n,l,r,v.callable,v.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Lo(),i=Wo(e),a=e!==i;let r=null,d=!0,l=!0,m=!1;a&&o&&(r=o.Event(e,t),o(n).trigger(r),d=!r.isPropagationStopped(),l=!r.isImmediatePropagationStopped(),m=r.isDefaultPrevented());const c=Xs(new Event(e,{bubbles:d,cancelable:!0}),t);return m&&c.preventDefault(),l&&n.dispatchEvent(c),c.defaultPrevented&&r&&r.preventDefault(),c}};function Xs(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function An(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function vs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Oe={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${vs(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${vs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=An(n.dataset[o])}return e},getDataAttribute(n,e){return An(n.getAttribute(`data-bs-${vs(e)}`))}};class Mt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Me(t)?Oe.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Me(t)?Oe.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],r=Me(a)?"element":Kf(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const ov="5.3.8";class Se extends Mt{constructor(e,t){super(),e=Pe(e),e&&(this._element=e,this._config=this._getConfig(t),ps.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ps.remove(this._element,this.constructor.DATA_KEY),W.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Io(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ps.get(Pe(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return ov}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const hs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Oo(t)).join(","):null},q={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Re(t)&&_t(t))},getSelectorFromElement(n){const e=hs(n);return e&&q.findOne(e)?e:null},getElementFromSelector(n){const e=hs(n);return e?q.findOne(e):null},getMultipleElementsFromSelector(n){const e=hs(n);return e?q.find(e):[]}},ts=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;W.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Re(this))return;const a=q.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},iv="alert",av="bs.alert",Fo=`.${av}`,rv=`close${Fo}`,lv=`closed${Fo}`,cv="fade",dv="show";class ss extends Se{static get NAME(){return iv}close(){if(W.trigger(this._element,rv).defaultPrevented)return;this._element.classList.remove(dv);const t=this._element.classList.contains(cv);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),W.trigger(this._element,lv),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ss.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ts(ss,"close");Ce(ss);const uv="button",pv="bs.button",mv=`.${pv}`,fv=".data-api",vv="active",Mn='[data-bs-toggle="button"]',hv=`click${mv}${fv}`;class ns extends Se{static get NAME(){return uv}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(vv))}static jQueryInterface(e){return this.each(function(){const t=ns.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}W.on(document,hv,Mn,n=>{n.preventDefault();const e=n.target.closest(Mn);ns.getOrCreateInstance(e).toggle()});Ce(ns);const _v="swipe",gt=".bs.swipe",gv=`touchstart${gt}`,bv=`touchmove${gt}`,yv=`touchend${gt}`,$v=`pointerdown${gt}`,wv=`pointerup${gt}`,Ev="touch",Cv="pen",Sv="pointer-event",kv=40,Tv={endCallback:null,leftCallback:null,rightCallback:null},xv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Gt extends Mt{constructor(e,t){super(),this._element=e,!(!e||!Gt.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Tv}static get DefaultType(){return xv}static get NAME(){return _v}dispose(){W.off(this._element,gt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),me(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=kv)return;const t=e/this._deltaX;this._deltaX=0,t&&me(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(W.on(this._element,$v,e=>this._start(e)),W.on(this._element,wv,e=>this._end(e)),this._element.classList.add(Sv)):(W.on(this._element,gv,e=>this._start(e)),W.on(this._element,bv,e=>this._move(e)),W.on(this._element,yv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Cv||e.pointerType===Ev)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Av="carousel",Mv="bs.carousel",Be=`.${Mv}`,Uo=".data-api",Ov="ArrowLeft",Nv="ArrowRight",Dv=500,yt="next",st="prev",it="left",Ut="right",Lv=`slide${Be}`,_s=`slid${Be}`,Iv=`keydown${Be}`,jv=`mouseenter${Be}`,Pv=`mouseleave${Be}`,Rv=`dragstart${Be}`,Vv=`load${Be}${Uo}`,Hv=`click${Be}${Uo}`,Bo="carousel",jt="active",Wv="slide",Fv="carousel-item-end",Uv="carousel-item-start",Bv="carousel-item-next",qv="carousel-item-prev",qo=".active",zo=".carousel-item",zv=qo+zo,Kv=".carousel-item img",Yv=".carousel-indicators",Gv="[data-bs-slide], [data-bs-slide-to]",Jv='[data-bs-ride="carousel"]',Xv={[Ov]:Ut,[Nv]:it},Qv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Zv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ot extends Se{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=q.findOne(Yv,this._element),this._addEventListeners(),this._config.ride===Bo&&this.cycle()}static get Default(){return Qv}static get DefaultType(){return Zv}static get NAME(){return Av}next(){this._slide(yt)}nextWhenVisible(){!document.hidden&&_t(this._element)&&this.next()}prev(){this._slide(st)}pause(){this._isSliding&&No(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){W.one(this._element,_s,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){W.one(this._element,_s,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?yt:st;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&W.on(this._element,Iv,e=>this._keydown(e)),this._config.pause==="hover"&&(W.on(this._element,jv,()=>this.pause()),W.on(this._element,Pv,()=>this._maybeEnableCycle())),this._config.touch&&Gt.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of q.find(Kv,this._element))W.on(o,Rv,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(it)),rightCallback:()=>this._slide(this._directionToOrder(Ut)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Dv+this._config.interval))}};this._swipeHelper=new Gt(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Xv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=q.findOne(qo,this._indicatorsElement);t.classList.remove(jt),t.removeAttribute("aria-current");const o=q.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(jt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===yt,a=t||Js(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),d=g=>W.trigger(this._element,g,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(d(Lv).defaultPrevented||!o||!a)return;const m=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const c=i?Uv:Fv,h=i?Bv:qv;a.classList.add(h),At(a),o.classList.add(c),a.classList.add(c);const v=()=>{a.classList.remove(c,h),a.classList.add(jt),o.classList.remove(jt,h,c),this._isSliding=!1,d(_s)};this._queueCallback(v,o,this._isAnimated()),m&&this.cycle()}_isAnimated(){return this._element.classList.contains(Wv)}_getActive(){return q.findOne(zv,this._element)}_getItems(){return q.find(zo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return we()?e===it?st:yt:e===it?yt:st}_orderToDirection(e){return we()?e===st?it:Ut:e===st?Ut:it}static jQueryInterface(e){return this.each(function(){const t=Ot.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}W.on(document,Hv,Gv,function(n){const e=q.getElementFromSelector(this);if(!e||!e.classList.contains(Bo))return;n.preventDefault();const t=Ot.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Oe.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});W.on(window,Vv,()=>{const n=q.find(Jv);for(const e of n)Ot.getOrCreateInstance(e)});Ce(Ot);const eh="collapse",th="bs.collapse",Nt=`.${th}`,sh=".data-api",nh=`show${Nt}`,oh=`shown${Nt}`,ih=`hide${Nt}`,ah=`hidden${Nt}`,rh=`click${Nt}${sh}`,gs="show",rt="collapse",Pt="collapsing",lh="collapsed",ch=`:scope .${rt} .${rt}`,dh="collapse-horizontal",uh="width",ph="height",mh=".collapse.show, .collapse.collapsing",Ls='[data-bs-toggle="collapse"]',fh={parent:null,toggle:!0},vh={parent:"(null|element)",toggle:"boolean"};class Tt extends Se{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=q.find(Ls);for(const i of o){const a=q.getSelectorFromElement(i),r=q.find(a).filter(d=>d===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return fh}static get DefaultType(){return vh}static get NAME(){return eh}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(mh).filter(d=>d!==this._element).map(d=>Tt.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||W.trigger(this._element,nh).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(rt),this._element.classList.add(Pt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Pt),this._element.classList.add(rt,gs),this._element.style[o]="",W.trigger(this._element,oh)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||W.trigger(this._element,ih).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,At(this._element),this._element.classList.add(Pt),this._element.classList.remove(rt,gs);for(const i of this._triggerArray){const a=q.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Pt),this._element.classList.add(rt),W.trigger(this._element,ah)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(gs)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Pe(e.parent),e}_getDimension(){return this._element.classList.contains(dh)?uh:ph}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ls);for(const t of e){const o=q.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=q.find(ch,this._config.parent);return q.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(lh,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Tt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}W.on(document,rh,Ls,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of q.getMultipleElementsFromSelector(this))Tt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ce(Tt);const On="dropdown",hh="bs.dropdown",et=`.${hh}`,Qs=".data-api",_h="Escape",Nn="Tab",gh="ArrowUp",Dn="ArrowDown",bh=2,yh=`hide${et}`,$h=`hidden${et}`,wh=`show${et}`,Eh=`shown${et}`,Ko=`click${et}${Qs}`,Yo=`keydown${et}${Qs}`,Ch=`keyup${et}${Qs}`,at="show",Sh="dropup",kh="dropend",Th="dropstart",xh="dropup-center",Ah="dropdown-center",Ge='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Mh=`${Ge}.${at}`,Bt=".dropdown-menu",Oh=".navbar",Nh=".navbar-nav",Dh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Lh=we()?"top-end":"top-start",Ih=we()?"top-start":"top-end",jh=we()?"bottom-end":"bottom-start",Ph=we()?"bottom-start":"bottom-end",Rh=we()?"left-start":"right-start",Vh=we()?"right-start":"left-start",Hh="top",Wh="bottom",Fh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Uh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Te extends Se{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=q.next(this._element,Bt)[0]||q.prev(this._element,Bt)[0]||q.findOne(Bt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Fh}static get DefaultType(){return Uh}static get NAME(){return On}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Re(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!W.trigger(this._element,wh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Nh))for(const o of[].concat(...document.body.children))W.on(o,"mouseover",Yt);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(at),this._element.classList.add(at),W.trigger(this._element,Eh,e)}}hide(){if(Re(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!W.trigger(this._element,yh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))W.off(o,"mouseover",Yt);this._popper&&this._popper.destroy(),this._menu.classList.remove(at),this._element.classList.remove(at),this._element.setAttribute("aria-expanded","false"),Oe.removeDataAttribute(this._menu,"popper"),W.trigger(this._element,$h,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Me(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${On.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Mo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Me(this._config.reference)?e=Pe(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Gs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(at)}_getPlacement(){const e=this._parent;if(e.classList.contains(kh))return Rh;if(e.classList.contains(Th))return Vh;if(e.classList.contains(xh))return Hh;if(e.classList.contains(Ah))return Wh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Sh)?t?Ih:Lh:t?Ph:jh}_detectNavbar(){return this._element.closest(Oh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Oe.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...me(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=q.find(Dh,this._menu).filter(i=>_t(i));o.length&&Js(o,t,e===Dn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Te.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===bh||e.type==="keyup"&&e.key!==Nn)return;const t=q.find(Mh);for(const o of t){const i=Te.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Nn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:i._element};e.type==="click"&&(d.clickEvent=e),i._completeHide(d)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===_h,i=[gh,Dn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(Ge)?this:q.prev(this,Ge)[0]||q.next(this,Ge)[0]||q.findOne(Ge,e.delegateTarget.parentNode),r=Te.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}W.on(document,Yo,Ge,Te.dataApiKeydownHandler);W.on(document,Yo,Bt,Te.dataApiKeydownHandler);W.on(document,Ko,Te.clearMenus);W.on(document,Ch,Te.clearMenus);W.on(document,Ko,Ge,function(n){n.preventDefault(),Te.getOrCreateInstance(this).toggle()});Ce(Te);const Go="backdrop",Bh="fade",Ln="show",In=`mousedown.bs.${Go}`,qh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},zh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Jo extends Mt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return qh}static get DefaultType(){return zh}static get NAME(){return Go}show(e){if(!this._config.isVisible){me(e);return}this._append();const t=this._getElement();this._config.isAnimated&&At(t),t.classList.add(Ln),this._emulateAnimation(()=>{me(e)})}hide(e){if(!this._config.isVisible){me(e);return}this._getElement().classList.remove(Ln),this._emulateAnimation(()=>{this.dispose(),me(e)})}dispose(){this._isAppended&&(W.off(this._element,In),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Bh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Pe(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),W.on(e,In,()=>{me(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Io(e,this._getElement(),this._config.isAnimated)}}const Kh="focustrap",Yh="bs.focustrap",Jt=`.${Yh}`,Gh=`focusin${Jt}`,Jh=`keydown.tab${Jt}`,Xh="Tab",Qh="forward",jn="backward",Zh={autofocus:!0,trapElement:null},e_={autofocus:"boolean",trapElement:"element"};class Xo extends Mt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Zh}static get DefaultType(){return e_}static get NAME(){return Kh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),W.off(document,Jt),W.on(document,Gh,e=>this._handleFocusin(e)),W.on(document,Jh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,W.off(document,Jt))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=q.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===jn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Xh&&(this._lastTabNavDirection=e.shiftKey?jn:Qh)}}const Pn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Rn=".sticky-top",Rt="padding-right",Vn="margin-right";class Is{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Rt,t=>t+e),this._setElementAttributes(Pn,Rt,t=>t+e),this._setElementAttributes(Rn,Vn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Rt),this._resetElementAttributes(Pn,Rt),this._resetElementAttributes(Rn,Vn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const d=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Oe.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=Oe.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}Oe.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Me(e)){t(e);return}for(const o of q.find(e,this._element))t(o)}}const t_="modal",s_="bs.modal",Ee=`.${s_}`,n_=".data-api",o_="Escape",i_=`hide${Ee}`,a_=`hidePrevented${Ee}`,Qo=`hidden${Ee}`,Zo=`show${Ee}`,r_=`shown${Ee}`,l_=`resize${Ee}`,c_=`click.dismiss${Ee}`,d_=`mousedown.dismiss${Ee}`,u_=`keydown.dismiss${Ee}`,p_=`click${Ee}${n_}`,Hn="modal-open",m_="fade",Wn="show",bs="modal-static",f_=".modal.show",v_=".modal-dialog",h_=".modal-body",__='[data-bs-toggle="modal"]',g_={backdrop:!0,focus:!0,keyboard:!0},b_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Ve extends Se{constructor(e,t){super(e,t),this._dialog=q.findOne(v_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Is,this._addEventListeners()}static get Default(){return g_}static get DefaultType(){return b_}static get NAME(){return t_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||W.trigger(this._element,Zo,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Hn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||W.trigger(this._element,i_).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Wn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){W.off(window,Ee),W.off(this._dialog,Ee),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Jo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Xo({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=q.findOne(h_,this._dialog);t&&(t.scrollTop=0),At(this._element),this._element.classList.add(Wn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,W.trigger(this._element,r_,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){W.on(this._element,u_,e=>{if(e.key===o_){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),W.on(window,l_,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),W.on(this._element,d_,e=>{W.one(this._element,c_,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Hn),this._resetAdjustments(),this._scrollBar.reset(),W.trigger(this._element,Qo)})}_isAnimated(){return this._element.classList.contains(m_)}_triggerBackdropTransition(){if(W.trigger(this._element,a_).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(bs)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(bs),this._queueCallback(()=>{this._element.classList.remove(bs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=we()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=we()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=Ve.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}W.on(document,p_,__,function(n){const e=q.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),W.one(e,Zo,i=>{i.defaultPrevented||W.one(e,Qo,()=>{_t(this)&&this.focus()})});const t=q.findOne(f_);t&&Ve.getInstance(t).hide(),Ve.getOrCreateInstance(e).toggle(this)});ts(Ve);Ce(Ve);const y_="offcanvas",$_="bs.offcanvas",Le=`.${$_}`,ei=".data-api",w_=`load${Le}${ei}`,E_="Escape",Fn="show",Un="showing",Bn="hiding",C_="offcanvas-backdrop",ti=".offcanvas.show",S_=`show${Le}`,k_=`shown${Le}`,T_=`hide${Le}`,qn=`hidePrevented${Le}`,si=`hidden${Le}`,x_=`resize${Le}`,A_=`click${Le}${ei}`,M_=`keydown.dismiss${Le}`,O_='[data-bs-toggle="offcanvas"]',N_={backdrop:!0,keyboard:!0,scroll:!1},D_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class He extends Se{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return N_}static get DefaultType(){return D_}static get NAME(){return y_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||W.trigger(this._element,S_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Is().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Un);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Fn),this._element.classList.remove(Un),W.trigger(this._element,k_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||W.trigger(this._element,T_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Bn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Fn,Bn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Is().reset(),W.trigger(this._element,si)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){W.trigger(this._element,qn);return}this.hide()},t=!!this._config.backdrop;return new Jo({className:C_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new Xo({trapElement:this._element})}_addEventListeners(){W.on(this._element,M_,e=>{if(e.key===E_){if(this._config.keyboard){this.hide();return}W.trigger(this._element,qn)}})}static jQueryInterface(e){return this.each(function(){const t=He.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}W.on(document,A_,O_,function(n){const e=q.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Re(this))return;W.one(e,si,()=>{_t(this)&&this.focus()});const t=q.findOne(ti);t&&t!==e&&He.getInstance(t).hide(),He.getOrCreateInstance(e).toggle(this)});W.on(window,w_,()=>{for(const n of q.find(ti))He.getOrCreateInstance(n).show()});W.on(window,x_,()=>{for(const n of q.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&He.getOrCreateInstance(n).hide()});ts(He);Ce(He);const L_=/^aria-[\w-]*$/i,ni={"*":["class","dir","id","lang","role",L_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},I_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),j_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,P_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?I_.has(t)?!!j_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function R_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const d=r.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){r.remove();continue}const l=[].concat(...r.attributes),m=[].concat(e["*"]||[],e[d]||[]);for(const c of l)P_(c,m)||r.removeAttribute(c.nodeName)}return i.body.innerHTML}const V_="TemplateFactory",H_={allowList:ni,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},W_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},F_={entry:"(string|element|function|null)",selector:"(string|element)"};class U_ extends Mt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return H_}static get DefaultType(){return W_}static get NAME(){return V_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},F_)}_setContent(e,t,o){const i=q.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Me(t)){this._putElementInTemplate(Pe(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?R_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return me(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const B_="tooltip",q_=new Set(["sanitize","allowList","sanitizeFn"]),ys="fade",z_="modal",Vt="show",K_=".tooltip-inner",zn=`.${z_}`,Kn="hide.bs.modal",$t="hover",$s="focus",ws="click",Y_="manual",G_="hide",J_="hidden",X_="show",Q_="shown",Z_="inserted",eg="click",tg="focusin",sg="focusout",ng="mouseenter",og="mouseleave",ig={AUTO:"auto",TOP:"top",RIGHT:we()?"left":"right",BOTTOM:"bottom",LEFT:we()?"right":"left"},ag={allowList:ni,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},rg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class bt extends Se{constructor(e,t){if(typeof Mo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return ag}static get DefaultType(){return rg}static get NAME(){return B_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),W.off(this._element.closest(zn),Kn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=W.trigger(this._element,this.constructor.eventName(X_)),o=(Do(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),W.trigger(this._element,this.constructor.eventName(Z_))),this._popper=this._createPopper(i),i.classList.add(Vt),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))W.on(d,"mouseover",Yt);const r=()=>{W.trigger(this._element,this.constructor.eventName(Q_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||W.trigger(this._element,this.constructor.eventName(G_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Vt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))W.off(i,"mouseover",Yt);this._activeTrigger[ws]=!1,this._activeTrigger[$s]=!1,this._activeTrigger[$t]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),W.trigger(this._element,this.constructor.eventName(J_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(ys,Vt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Yf(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(ys),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new U_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[K_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(ys)}_isShown(){return this.tip&&this.tip.classList.contains(Vt)}_createPopper(e){const t=me(this._config.placement,[this,e,this._element]),o=ig[t.toUpperCase()];return Gs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return me(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...me(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")W.on(this._element,this.constructor.eventName(eg),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[ws]=!(i._isShown()&&i._activeTrigger[ws]),i.toggle()});else if(t!==Y_){const o=t===$t?this.constructor.eventName(ng):this.constructor.eventName(tg),i=t===$t?this.constructor.eventName(og):this.constructor.eventName(sg);W.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?$s:$t]=!0,r._enter()}),W.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?$s:$t]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},W.on(this._element.closest(zn),Kn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Oe.getDataAttributes(this._element);for(const o of Object.keys(t))q_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Pe(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=bt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ce(bt);const lg="popover",cg=".popover-header",dg=".popover-body",ug={...bt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},pg={...bt.DefaultType,content:"(null|string|element|function)"};class Zs extends bt{static get Default(){return ug}static get DefaultType(){return pg}static get NAME(){return lg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[cg]:this._getTitle(),[dg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=Zs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ce(Zs);const mg="scrollspy",fg="bs.scrollspy",en=`.${fg}`,vg=".data-api",hg=`activate${en}`,Yn=`click${en}`,_g=`load${en}${vg}`,gg="dropdown-item",nt="active",bg='[data-bs-spy="scroll"]',Es="[href]",yg=".nav, .list-group",Gn=".nav-link",$g=".nav-item",wg=".list-group-item",Eg=`${Gn}, ${$g} > ${Gn}, ${wg}`,Cg=".dropdown",Sg=".dropdown-toggle",kg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Tg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class os extends Se{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return kg}static get DefaultType(){return Tg}static get NAME(){return mg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Pe(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(W.off(this._config.target,Yn),W.on(this._config.target,Yn,Es,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const d=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&d){if(o(r),!i)return;continue}!a&&!d&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=q.find(Es,this._config.target);for(const t of e){if(!t.hash||Re(t))continue;const o=q.findOne(decodeURI(t.hash),this._element);_t(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(nt),this._activateParents(e),W.trigger(this._element,hg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(gg)){q.findOne(Sg,e.closest(Cg)).classList.add(nt);return}for(const t of q.parents(e,yg))for(const o of q.prev(t,Eg))o.classList.add(nt)}_clearActiveClass(e){e.classList.remove(nt);const t=q.find(`${Es}.${nt}`,e);for(const o of t)o.classList.remove(nt)}static jQueryInterface(e){return this.each(function(){const t=os.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}W.on(window,_g,()=>{for(const n of q.find(bg))os.getOrCreateInstance(n)});Ce(os);const xg="tab",Ag="bs.tab",tt=`.${Ag}`,Mg=`hide${tt}`,Og=`hidden${tt}`,Ng=`show${tt}`,Dg=`shown${tt}`,Lg=`click${tt}`,Ig=`keydown${tt}`,jg=`load${tt}`,Pg="ArrowLeft",Jn="ArrowRight",Rg="ArrowUp",Xn="ArrowDown",Cs="Home",Qn="End",Je="active",Zn="fade",Ss="show",Vg="dropdown",oi=".dropdown-toggle",Hg=".dropdown-menu",ks=`:not(${oi})`,Wg='.list-group, .nav, [role="tablist"]',Fg=".nav-item, .list-group-item",Ug=`.nav-link${ks}, .list-group-item${ks}, [role="tab"]${ks}`,ii='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ts=`${Ug}, ${ii}`,Bg=`.${Je}[data-bs-toggle="tab"], .${Je}[data-bs-toggle="pill"], .${Je}[data-bs-toggle="list"]`;class mt extends Se{constructor(e){super(e),this._parent=this._element.closest(Wg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),W.on(this._element,Ig,t=>this._keydown(t)))}static get NAME(){return xg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?W.trigger(t,Mg,{relatedTarget:e}):null;W.trigger(e,Ng,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(Je),this._activate(q.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ss);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),W.trigger(e,Dg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(Zn))}_deactivate(e,t){if(!e)return;e.classList.remove(Je),e.blur(),this._deactivate(q.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ss);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),W.trigger(e,Og,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(Zn))}_keydown(e){if(![Pg,Jn,Rg,Xn,Cs,Qn].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Re(i));let o;if([Cs,Qn].includes(e.key))o=t[e.key===Cs?0:t.length-1];else{const i=[Jn,Xn].includes(e.key);o=Js(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),mt.getOrCreateInstance(o).show())}_getChildren(){return q.find(Ts,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=q.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(Vg))return;const i=(a,r)=>{const d=q.findOne(a,o);d&&d.classList.toggle(r,t)};i(oi,Je),i(Hg,Ss),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(Je)}_getInnerElement(e){return e.matches(Ts)?e:q.findOne(Ts,e)}_getOuterElement(e){return e.closest(Fg)||e}static jQueryInterface(e){return this.each(function(){const t=mt.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}W.on(document,Lg,ii,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Re(this)&&mt.getOrCreateInstance(this).show()});W.on(window,jg,()=>{for(const n of q.find(Bg))mt.getOrCreateInstance(n)});Ce(mt);const qg="toast",zg="bs.toast",qe=`.${zg}`,Kg=`mouseover${qe}`,Yg=`mouseout${qe}`,Gg=`focusin${qe}`,Jg=`focusout${qe}`,Xg=`hide${qe}`,Qg=`hidden${qe}`,Zg=`show${qe}`,eb=`shown${qe}`,tb="fade",eo="hide",Ht="show",Wt="showing",sb={animation:"boolean",autohide:"boolean",delay:"number"},nb={animation:!0,autohide:!0,delay:5e3};class is extends Se{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return nb}static get DefaultType(){return sb}static get NAME(){return qg}show(){if(W.trigger(this._element,Zg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(tb);const t=()=>{this._element.classList.remove(Wt),W.trigger(this._element,eb),this._maybeScheduleHide()};this._element.classList.remove(eo),At(this._element),this._element.classList.add(Ht,Wt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||W.trigger(this._element,Xg).defaultPrevented)return;const t=()=>{this._element.classList.add(eo),this._element.classList.remove(Wt,Ht),W.trigger(this._element,Qg)};this._element.classList.add(Wt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Ht),super.dispose()}isShown(){return this._element.classList.contains(Ht)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){W.on(this._element,Kg,e=>this._onInteraction(e,!0)),W.on(this._element,Yg,e=>this._onInteraction(e,!1)),W.on(this._element,Gg,e=>this._onInteraction(e,!0)),W.on(this._element,Jg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=is.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ts(is);Ce(is);const ob={class:"modal-dialog modal-dialog-centered"},ib={class:"modal-content"},ab={class:"modal-body"},rb={key:0,class:"alert alert-danger"},lb={class:"mb-3"},cb={class:"mb-3"},db={class:"form-text"},ub={class:"mb-3"},pb={class:"mb-3"},mb=["value"],fb={class:"modal-footer"},vb=["disabled"],hb={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=X(),r=D(null),d=D(null),l=D(""),m=D(!1),c=D({name:"",purpose:"",description:"",member_minion_ids:[]}),h=f(()=>{const b=[];for(const[y,M]of a.sessions.entries())M.is_minion&&M.project_id===o.legionId&&b.push(M);return b}),v=f(()=>c.value.name.trim()!==""&&c.value.purpose.trim()!==""),g=async()=>{if(!v.value){l.value="Name and purpose are required";return}m.value=!0,l.value="";try{const b=await J.post(`/api/legions/${o.legionId}/channels`,{name:c.value.name.trim(),purpose:c.value.purpose.trim(),description:c.value.description.trim()||null,member_minion_ids:c.value.member_minion_ids});i("created",b.data.channel),d.value?.hide(),c.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(b){console.error("Failed to create channel:",b),l.value=b.response?.data?.detail||"Failed to create channel"}finally{m.value=!1}},x=()=>{d.value?.show()},_=()=>{d.value?.hide()};return re(()=>{r.value&&(d.value=new Ve(r.value))}),pe(()=>{d.value?.dispose()}),e({show:x,hide:_}),(b,y)=>(u(),_e(no,{to:"body"},[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[s("div",ob,[s("div",ib,[y[11]||(y[11]=s("div",{class:"modal-header"},[s("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",ab,[l.value?(u(),p("div",rb,$(l.value),1)):j("",!0),s("form",{onSubmit:ce(g,["prevent"])},[s("div",lb,[y[4]||(y[4]=s("label",{for:"channel-name",class:"form-label"},[Y(" Channel Name "),s("span",{class:"text-danger"},"*")],-1)),Q(s("input",{id:"channel-name","onUpdate:modelValue":y[0]||(y[0]=M=>c.value.name=M),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[ae,c.value.name]]),y[5]||(y[5]=s("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),s("div",cb,[y[6]||(y[6]=s("label",{for:"channel-purpose",class:"form-label"},[Y(" Purpose "),s("span",{class:"text-danger"},"*")],-1)),Q(s("textarea",{id:"channel-purpose","onUpdate:modelValue":y[1]||(y[1]=M=>c.value.purpose=M),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[ae,c.value.purpose]]),s("div",db,$(c.value.purpose.length)+" / 500 characters",1)]),s("div",ub,[y[7]||(y[7]=s("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),Q(s("textarea",{id:"channel-description","onUpdate:modelValue":y[2]||(y[2]=M=>c.value.description=M),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[ae,c.value.description]])]),s("div",pb,[y[8]||(y[8]=s("label",{class:"form-label"},"Initial Members (Optional)",-1)),Q(s("select",{"onUpdate:modelValue":y[3]||(y[3]=M=>c.value.member_minion_ids=M),multiple:"",class:"form-select",size:"5"},[(u(!0),p(Z,null,se(h.value,M=>(u(),p("option",{key:M.session_id,value:M.session_id},$(M.name)+$(M.role?` (${M.role})`:""),9,mb))),128))],512),[[je,c.value.member_minion_ids]]),y[9]||(y[9]=s("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),s("div",fb,[y[10]||(y[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:m.value||!v.value},$(m.value?"Creating...":"Create Channel"),9,vb)])])])],512)]))}},_b=G(hb,[["__scopeId","data-v-903d53c6"]]),gb={class:"modal-dialog modal-dialog-centered"},bb={class:"modal-content"},yb={class:"modal-body"},$b={key:0,class:"alert alert-danger"},wb={class:"text-muted"},Eb={class:"modal-footer"},Cb=["disabled"],Sb={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=D(null),r=D(null),d=D(""),l=D(!1),m=f(()=>o.channel?.member_minion_ids?.length||0),c=async()=>{if(!o.channel){d.value="No channel selected";return}l.value=!0,d.value="";try{await J.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),i("deleted",o.channel.channel_id),r.value?.hide()}catch(g){console.error("Failed to delete channel:",g),d.value=g.response?.data?.detail||"Failed to delete channel"}finally{l.value=!1}},h=()=>{d.value="",r.value?.show()},v=()=>{r.value?.hide()};return re(()=>{a.value&&(r.value=new Ve(a.value))}),pe(()=>{r.value?.dispose()}),e({show:h,hide:v}),(g,x)=>(u(),_e(no,{to:"body"},[s("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[s("div",gb,[s("div",bb,[x[4]||(x[4]=s("div",{class:"modal-header"},[s("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",yb,[d.value?(u(),p("div",$b,$(d.value),1)):j("",!0),x[2]||(x[2]=s("div",{class:"alert alert-warning"},[s("strong",null,"âš ï¸ Warning:"),Y(" This action cannot be undone. ")],-1)),s("p",null,[x[0]||(x[0]=Y("Are you sure you want to delete ",-1)),s("strong",null,$(n.channel?.name),1),x[1]||(x[1]=Y("?",-1))]),s("p",wb," This channel has "+$(m.value)+" "+$(m.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),s("div",Eb,[x[3]||(x[3]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-danger",onClick:c,disabled:l.value},$(l.value?"Deleting...":"Delete Channel"),9,Cb)])])])],512)]))}},kb={class:"accordion mt-2",id:"channelsAccordion"},Tb={class:"accordion-item"},xb={class:"accordion-header"},Ab={class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#channelsCollapsePanel","aria-expanded":"false","aria-controls":"channelsCollapsePanel"},Mb={class:"text-muted ms-2"},Ob={id:"channelsCollapsePanel",class:"accordion-collapse collapse","data-bs-parent":"#channelsAccordion"},Nb={class:"accordion-body p-0"},Db={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},Lb={key:1,class:"list-group list-group-flush"},Ib={class:"d-flex align-items-center justify-content-between"},jb=["onClick"],Pb={class:"channel-name"},Rb={class:"d-flex align-items-center gap-2"},Vb={class:"badge bg-secondary member-count"},Hb=["onClick"],Wb={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=We(),o=vt(),i=D(null),a=D(null),r=D(null),d=f(()=>o.channelsByLegion.get(e.project.project_id)||[]),l=f(()=>d.value.length);function m(x){t.push(`/channel/${e.project.project_id}/${x}`)}function c(){i.value?.show()}function h(x){r.value=x,a.value?.show()}function v(x){o.loadChannels(e.project.project_id)}function g(x){const b=(o.channelsByLegion.get(e.project.project_id)||[]).filter(y=>y.channel_id!==x);o.channelsByLegion.set(e.project.project_id,b),t.currentRoute.value.path.includes(x)&&t.push(`/timeline/${e.project.project_id}`)}return re(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(x){console.error("Failed to load channels:",x)}}),(x,_)=>(u(),p(Z,null,[s("div",kb,[s("div",Tb,[s("h2",xb,[s("button",Ab,[_[0]||(_[0]=s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),_[1]||(_[1]=s("span",{class:"fw-semibold"},"Channels",-1)),s("small",Mb,"("+$(l.value)+")",1)])]),s("div",Ob,[s("div",Nb,[s("div",{class:"p-2 border-bottom"},[s("button",{class:"btn btn-sm btn-primary w-100",onClick:c}," + New Channel ")]),d.value.length===0?(u(),p("div",Db,' No channels yet. Click "New Channel" to create one. ')):(u(),p("div",Lb,[(u(!0),p(Z,null,se(d.value,b=>(u(),p("div",{key:b.channel_id,class:"list-group-item list-group-item-action channel-item"},[s("div",Ib,[s("div",{class:"d-flex align-items-center flex-grow-1",onClick:y=>m(b.channel_id)},[_[2]||(_[2]=s("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),s("span",Pb,$(b.name),1)],8,jb),s("div",Rb,[s("span",Vb,$(b.member_minion_ids?.length||0),1),s("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:ce(y=>h(b),["stop"]),title:"Delete channel"},[..._[3]||(_[3]=[s("i",{class:"bi bi-trash"},null,-1)])],8,Hb)])])]))),128))]))])])])]),te(_b,{ref_key:"createModal",ref:i,"legion-id":n.project.project_id,onCreated:v},null,8,["legion-id"]),te(Sb,{ref_key:"deleteModal",ref:a,"legion-id":n.project.project_id,channel:r.value,onDeleted:g},null,8,["legion-id","channel"])],64))}},Fb=G(Wb,[["__scopeId","data-v-9fe4211d"]]),Ub=["data-project-id"],Bb=["id"],qb=["aria-expanded","aria-controls","onKeydown"],zb={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Kb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Yb={class:"fw-semibold",style:{"flex-shrink":"0"}},Gb={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Jb={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Xb=["title"],Qb=["title"],Zb=["id","aria-labelledby"],ey={class:"accordion-body p-0"},ty={class:"list-group list-group-flush"},sy={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=We(),o=le(),i=X(),a=ie(),r=D(e.project.is_expanded||!1),d=f(()=>o.formatPath(e.project.working_directory)),l=f(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(V=>i.getSession(V)).filter(V=>V!=null)),m=f(()=>{const V=t.currentRoute.value;return V.name==="timeline"&&V.params.legionId===e.project.project_id}),c=f(()=>{const V=t.currentRoute.value;return V.name==="horde"&&V.params.legionId===e.project.project_id});function h(V){const A=window.bootstrap;if(!A)return;const T=document.getElementById(`collapse-${e.project.project_id}`);if(!T)return;A.Collapse.getOrCreateInstance(T).toggle()}function v(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function g(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const V=i.currentSessionId;V&&i.getSession(V)&&e.project.session_ids?.includes(V)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function x(){a.showModal("edit-project",{project:e.project})}function _(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function b(){t.push(`/timeline/${e.project.project_id}`)}function y(){t.push(`/horde/${e.project.project_id}`)}function M(V){V.dataTransfer.effectAllowed="move",V.dataTransfer.setData("application/project-id",e.project.project_id),V.dataTransfer.setData("text/plain",e.project.project_id),V.target.classList.add("dragging")}function C(V){V.target.classList.remove("dragging")}function w(V){V.preventDefault(),V.dataTransfer.dropEffect="move";const A=V.currentTarget.getBoundingClientRect(),T=A.top+A.height/2;V.clientY<T?(V.currentTarget.classList.add("drop-above"),V.currentTarget.classList.remove("drop-below")):(V.currentTarget.classList.add("drop-below"),V.currentTarget.classList.remove("drop-above"))}function R(V){V.preventDefault(),V.currentTarget.classList.remove("drop-above","drop-below");const A=V.dataTransfer.getData("application/project-id")||V.dataTransfer.getData("text/plain");if(!A||A===e.project.project_id)return;const T=V.currentTarget.getBoundingClientRect(),O=T.top+T.height/2,S=V.clientY<O,E=o.orderedProjects,k=E.findIndex(U=>U.project_id===e.project.project_id),N=E.findIndex(U=>U.project_id===A);if(k===-1||N===-1)return;const I=[...E],[H]=I.splice(N,1);let L=S?k:k+1;N<k&&L--,I.splice(L,0,H);const P=I.map(U=>U.project_id);o.reorderProjects(P)}return(V,A)=>(u(),p("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:M,onDragend:C,onDragover:w,onDrop:R},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:z(["accordion-button bg-white p-2",{collapsed:!r.value}]),role:"button",tabindex:"0","aria-expanded":r.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:h,onKeydown:[zt(ce(h,["prevent"]),["enter"]),zt(ce(h,["prevent"]),["space"])]},[s("div",zb,[s("div",Kb,[s("div",Yb,[n.project.is_multi_agent?(u(),p("span",Gb,"ðŸ›")):j("",!0),Y(" "+$(n.project.name),1)]),s("div",Jb,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ce(x,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:ce(_,["stop"])}," âž• ",8,Xb)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(d.value),9,Qb)])],42,qb)],8,Bb),te(Gm,{project:n.project,sessions:l.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:z(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:v,onHidden:g},[s("div",ey,[s("div",ty,[n.project.is_multi_agent?(u(),p("div",{key:0,class:z(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:m.value}]),style:{cursor:"pointer"},onClick:b},[...A[0]||(A[0]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):j("",!0),n.project.is_multi_agent?(u(),p(Z,{key:1},[s("div",{class:z(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:c.value}]),style:{cursor:"pointer"},onClick:y},[...A[1]||(A[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),s("span",{class:"fw-semibold"},"Horde"),s("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),te(nf,{project:n.project,sessions:l.value},null,8,["project","sessions"]),te(Fb,{project:n.project},null,8,["project"])],64)):(u(!0),p(Z,{key:2},se(l.value,T=>(u(),_e(Zm,{key:T.session_id,session:T,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,Zb)],40,Ub))}},ny=G(sy,[["__scopeId","data-v-04f4e534"]]),oy={class:"project-list"},iy={key:0,class:"text-muted text-center py-3"},ay={__name:"ProjectList",setup(n){const e=le(),t=f(()=>e.orderedProjects);return(o,i)=>(u(),p("div",oy,[t.value.length===0?(u(),p("div",iy,' No projects yet. Click "New" to create one. ')):j("",!0),(u(!0),p(Z,null,se(t.value,a=>(u(),_e(ny,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},ry={class:"flex-grow-1 overflow-auto p-3"},ly={id:"sessions-container"},cy={__name:"Sidebar",setup(n){const e=ie(),t=f(()=>e.sidebarCollapsed),o=f(()=>e.isMobile),i=f(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const r=D(!1);function d(c){r.value=!0,document.addEventListener("mousemove",l),document.addEventListener("mouseup",m)}function l(c){r.value&&e.setSidebarWidth(c.clientX)}function m(){r.value=!1,document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",m)}return(c,h)=>(u(),p("aside",{id:"sidebar",class:z(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:Ne(i.value)},[s("div",ry,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[h[0]||(h[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),s("div",ly,[te(ay)])]),s("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},dy=G(cy,[["__scopeId","data-v-d792f0f0"]]),uy={class:"modal-dialog modal-lg"},py={class:"modal-content"},my={class:"modal-body"},fy={class:"mb-3"},vy={class:"input-group"},hy=["disabled"],_y={key:0,class:"text-center py-4"},gy={key:1,class:"alert alert-danger",role:"alert"},by={key:2,class:"folder-list"},yy=["onClick","onDblclick"],$y={class:"d-flex align-items-center flex-grow-1"},wy=["onClick"],Ey={key:1,class:"text-center text-muted py-3"},Cy={class:"modal-footer"},Sy=["disabled"],ky={__name:"FolderBrowserModal",setup(n){const e=ie(),t=D(""),o=D(""),i=D([]),a=D(!1),r=D(""),d=D(null);let l=null,m=null;const c=f(()=>{if(!t.value)return null;const C=t.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?C.join("/"):"/")});function h(C){if(!C)return"";const w=C.split(/[\\/]/).filter(Boolean);return w.length<=2?C:".../"+w.slice(-2).join("/")}async function v(){a.value=!0,r.value="",i.value=[],o.value="";try{const C=t.value?{path:t.value}:{},w=await J.get("/api/filesystem/browse",{params:C});w.current_path&&(t.value=w.current_path),i.value=w.directories||[]}catch(C){console.error("Failed to load directory:",C),r.value=C.message||"Failed to load directory"}finally{a.value=!1}}function g(C){o.value=C.path}function x(C){t.value=C.path,o.value="",v()}function _(){c.value&&(t.value=c.value,o.value="",v())}function b(){const C=o.value||t.value;C&&m&&m(C),l&&l.hide()}function y(){v()}function M(){i.value=[],o.value="",r.value="",m=null,e.hideModal()}return ne(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&l){const w=C.data||{};t.value=w.currentPath||"",m=w.onSelect||null,l.show()}}),re(()=>{d.value&&fe(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{l=new C(d.value),d.value.addEventListener("shown.bs.modal",y),d.value.addEventListener("hidden.bs.modal",M)})}),pe(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",y),d.value.removeEventListener("hidden.bs.modal",M)),l&&l.dispose()}),(C,w)=>(u(),p("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",uy,[s("div",py,[w[7]||(w[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",my,[s("div",fy,[w[2]||(w[2]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",vy,[Q(s("input",{type:"text",class:"form-control","onUpdate:modelValue":w[0]||(w[0]=R=>t.value=R),onKeyup:zt(v,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[ae,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:v,disabled:a.value},[...w[1]||(w[1]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1),Y(" Refresh ",-1)])],8,hy)])]),a.value?(u(),p("div",_y,[...w[3]||(w[3]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(u(),p("div",gy,$(r.value),1)):(u(),p("div",by,[c.value?(u(),p("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:_,role:"button"},[...w[4]||(w[4]=[s("i",{class:"bi bi-arrow-up-circle me-2 text-secondary"},null,-1),s("span",{class:"text-secondary"},"..",-1)])])):j("",!0),(u(!0),p(Z,null,se(i.value,R=>(u(),p("div",{key:R.path,class:z(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:R.path===o.value}]),onClick:V=>g(R),onDblclick:V=>x(R),role:"button"},[s("div",$y,[w[5]||(w[5]=s("i",{class:"bi bi-folder-fill me-2 text-warning"},null,-1)),s("span",null,$(R.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:ce(V=>x(R),["stop"])}," Open ",8,wy)],42,yy))),128)),i.value.length===0?(u(),p("div",Ey," No subdirectories found ")):j("",!0)]))]),s("div",Cy,[w[6]||(w[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:!o.value},' Select "'+$(h(o.value||t.value))+'" ',9,Sy)])])])],512))}},Ty=G(ky,[["__scopeId","data-v-667c51a9"]]),xy={class:"modal-dialog"},Ay={class:"modal-content"},My={class:"modal-body"},Oy={class:"mb-3"},Ny={key:0,class:"invalid-feedback"},Dy={class:"mb-3"},Ly={class:"input-group"},Iy={key:0,class:"invalid-feedback"},jy={class:"mb-3 form-check"},Py={class:"mb-3 form-check"},Ry={class:"form-check-label",for:"createSession"},Vy={key:0,class:"mb-3 ms-4"},Hy={for:"sessionName",class:"form-label"},Wy={key:1,class:"alert alert-danger",role:"alert"},Fy={class:"modal-footer"},Uy=["disabled"],By={key:0,class:"spinner-border spinner-border-sm me-2"},qy={__name:"ProjectCreateModal",setup(n){const e=le(),t=X(),o=ie(),i=D({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=D({name:"",workingDirectory:""}),r=D(!1),d=D(""),l=D(null);let m=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:b=>{i.value.workingDirectory=b,a.value.workingDirectory=""}})}function h(){a.value={};let b=!0;return i.value.name.trim()||(a.value.name="Project name is required",b=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",b=!1),b}async function v(){if(h()){r.value=!0,d.value="";try{const b=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await t.createSession(b.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),m&&m.hide(),g()}catch(b){console.error("Failed to create project:",b),d.value=b.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function g(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},d.value=""}function x(){const b=document.getElementById("projectName");b&&b.focus()}function _(){g(),o.hideModal()}return ne(()=>o.currentModal,b=>{b?.name==="create-project"&&m&&m.show()}),re(()=>{l.value&&fe(async()=>{const{default:b}=await import("./modal-B4rHLo2F.js").then(y=>y.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{m=new b(l.value),l.value.addEventListener("shown.bs.modal",x),l.value.addEventListener("hidden.bs.modal",_)})}),pe(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",x),l.value.removeEventListener("hidden.bs.modal",_)),m&&m.dispose()}),(b,y)=>(u(),p("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",xy,[s("div",Ay,[y[11]||(y[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",My,[s("form",{onSubmit:ce(v,["prevent"])},[s("div",Oy,[y[5]||(y[5]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),Q(s("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":y[0]||(y[0]=M=>i.value.name=M),placeholder:"My Project",required:""},null,2),[[ae,i.value.name]]),a.value.name?(u(),p("div",Ny,$(a.value.name),1)):j("",!0)]),s("div",Dy,[y[6]||(y[6]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Ly,[Q(s("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":y[1]||(y[1]=M=>i.value.workingDirectory=M),placeholder:"/path/to/project",required:""},null,2),[[ae,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(u(),p("div",Iy,$(a.value.workingDirectory),1)):j("",!0)]),y[7]||(y[7]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",jy,[Q(s("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":y[2]||(y[2]=M=>i.value.isMultiAgent=M)},null,512),[[Ct,i.value.isMultiAgent]]),y[8]||(y[8]=s("label",{class:"form-check-label",for:"isMultiAgent"}," ðŸ› Multi-Agent Project (Legion) ",-1)),y[9]||(y[9]=s("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),s("div",Py,[Q(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":y[3]||(y[3]=M=>i.value.createSession=M)},null,512),[[Ct,i.value.createSession]]),s("label",Ry," Create initial "+$(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(u(),p("div",Vy,[s("label",Hy," Initial "+$(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),Q(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":y[4]||(y[4]=M=>i.value.sessionName=M),placeholder:"main"},null,512),[[ae,i.value.sessionName]])])):j("",!0),d.value?(u(),p("div",Wy,$(d.value),1)):j("",!0)],32)]),s("div",Fy,[y[10]||(y[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:r.value},[r.value?(u(),p("span",By)):j("",!0),Y(" "+$(r.value?"Creating...":"Create Project"),1)],8,Uy)])])])],512))}},zy=G(qy,[["__scopeId","data-v-adf50394"]]),Ky={class:"modal-dialog"},Yy={class:"modal-content"},Gy={class:"modal-body"},Jy={class:"mb-3"},Xy={key:0,class:"invalid-feedback"},Qy={class:"mb-3"},Zy=["value"],e1={key:0,class:"alert alert-danger",role:"alert"},t1={class:"danger-zone"},s1={class:"text-muted small"},n1=["disabled"],o1={key:0,class:"alert alert-warning mt-3",role:"alert"},i1={class:"mb-2"},a1={class:"d-flex gap-2"},r1=["disabled"],l1={key:0,class:"spinner-border spinner-border-sm me-2"},c1=["disabled"],d1={class:"modal-footer"},u1=["disabled"],p1={key:0,class:"spinner-border spinner-border-sm me-2"},m1={__name:"ProjectEditModal",setup(n){const e=le(),t=ie(),o=D(null),i=D({name:""}),a=D({name:""}),r=D(!1),d=D(!1),l=D(""),m=D(!1),c=D(null);let h=null;const v=f(()=>o.value?.session_ids?.length||0);function g(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Project name is required",C=!1),C}async function x(){if(!(!g()||!o.value)){r.value=!0,l.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),h&&h.hide()}catch(C){console.error("Failed to update project:",C),l.value=C.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function _(){if(o.value){d.value=!0,l.value="";try{await e.deleteProject(o.value.project_id),h&&h.hide()}catch(C){console.error("Failed to delete project:",C),l.value=C.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function b(){i.value={name:""},a.value={},l.value="",m.value=!1}function y(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function M(){b(),o.value=null,t.hideModal()}return ne(()=>t.currentModal,C=>{if(C?.name==="edit-project"&&h){const w=C.data||{};o.value=w.project,o.value&&(i.value.name=o.value.name),h.show()}}),re(()=>{c.value&&fe(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{h=new C(c.value),c.value.addEventListener("shown.bs.modal",y),c.value.addEventListener("hidden.bs.modal",M)})}),pe(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",y),c.value.removeEventListener("hidden.bs.modal",M)),h&&h.dispose()}),(C,w)=>(u(),p("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",Ky,[s("div",Yy,[w[11]||(w[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Gy,[s("form",{onSubmit:ce(x,["prevent"])},[s("div",Jy,[w[3]||(w[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),Q(s("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":w[0]||(w[0]=R=>i.value.name=R),placeholder:"My Project",required:""},null,2),[[ae,i.value.name]]),a.value.name?(u(),p("div",Xy,$(a.value.name),1)):j("",!0)]),s("div",Qy,[w[4]||(w[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Zy),w[5]||(w[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),l.value?(u(),p("div",e1,$(l.value),1)):j("",!0)],32),w[9]||(w[9]=s("hr",null,null,-1)),s("div",t1,[w[7]||(w[7]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",s1," Deleting this project will also delete all "+$(v.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:w[1]||(w[1]=R=>m.value=!0),disabled:d.value},[...w[6]||(w[6]=[s("i",{class:"bi bi-trash"},null,-1),Y(" Delete Project ",-1)])],8,n1)]),m.value?(u(),p("div",o1,[w[8]||(w[8]=s("strong",null,"Are you sure?",-1)),s("p",i1,' This will permanently delete the project "'+$(o.value?.name)+'" and all '+$(v.value)+" session(s). ",1),s("div",a1,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:_,disabled:d.value},[d.value?(u(),p("span",l1)):j("",!0),Y(" "+$(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,r1),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:w[2]||(w[2]=R=>m.value=!1),disabled:d.value}," Cancel ",8,c1)])])):j("",!0)]),s("div",d1,[w[10]||(w[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:x,disabled:r.value},[r.value?(u(),p("span",p1)):j("",!0),Y(" "+$(r.value?"Saving...":"Save Changes"),1)],8,u1)])])])],512))}},f1=G(m1,[["__scopeId","data-v-6f299f35"]]),v1={class:"modal-dialog modal-lg"},h1={class:"modal-content"},_1={class:"modal-header"},g1={class:"modal-title",id:"createSessionModalLabel"},b1={key:0,class:"text-muted small"},y1={class:"modal-body"},$1={class:"mb-3"},w1={key:0,class:"invalid-feedback"},E1={class:"mb-3"},C1={class:"mb-3"},S1={class:"mb-3"},k1={class:"form-text d-flex justify-content-between"},T1={key:0,class:"invalid-feedback"},x1={class:"mb-3 form-check"},A1={key:0,class:"form-text text-warning"},M1={class:"mb-3"},O1={class:"mb-3 form-check"},N1={key:0,class:"alert alert-danger",role:"alert"},D1={class:"modal-footer"},L1=["disabled"],I1={key:0,class:"spinner-border spinner-border-sm me-2"},j1={__name:"SessionCreateModal",setup(n){const e=We();le();const t=X(),o=ie(),i=D(null),a=D({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0}),r=D({name:""}),d=D(!1),l=D(""),m=D(null);let c=null;const h=f(()=>a.value.system_prompt.length),v=f(()=>h.value>6e3),g=f(()=>h.value>5500&&h.value<=6e3);function x(){r.value={};let C=!0;return a.value.name.trim()||(r.value.name="Session name is required",C=!1),v.value&&(C=!1),C}async function _(){if(!(!x()||!i.value)){d.value=!0,l.value="";try{const C=a.value.tools.split(",").map(V=>V.trim()).filter(V=>V.length>0),w={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,tools:C},R=await t.createSession(i.value.project_id,w);a.value.startImmediately&&await t.startSession(R.session_id),e.push(`/session/${R.session_id}`),c&&c.hide(),b()}catch(C){console.error("Failed to create session:",C),l.value=C.message||"Failed to create session. Please try again."}finally{d.value=!1}}}function b(){a.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0},r.value={},l.value=""}function y(){const C=document.getElementById("sessionName");C&&C.focus()}function M(){b(),i.value=null,o.hideModal()}return ne(()=>o.currentModal,C=>{if(C?.name==="create-session"&&c){const w=C.data||{};i.value=w.project,c.show()}}),re(()=>{m.value&&fe(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{c=new C(m.value),m.value.addEventListener("shown.bs.modal",y),m.value.addEventListener("hidden.bs.modal",M)})}),pe(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",y),m.value.removeEventListener("hidden.bs.modal",M)),c&&c.dispose()}),(C,w)=>(u(),p("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[s("div",v1,[s("div",h1,[s("div",_1,[s("h5",g1,[w[7]||(w[7]=Y(" Create New Session ",-1)),i.value?(u(),p("span",b1,"in "+$(i.value.name),1)):j("",!0)]),w[8]||(w[8]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",y1,[s("form",{onSubmit:ce(_,["prevent"])},[s("div",$1,[w[9]||(w[9]=s("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),Q(s("input",{type:"text",class:z(["form-control",{"is-invalid":r.value.name}]),id:"sessionName","onUpdate:modelValue":w[0]||(w[0]=R=>a.value.name=R),placeholder:"main",required:""},null,2),[[ae,a.value.name]]),r.value.name?(u(),p("div",w1,$(r.value.name),1)):j("",!0)]),s("div",E1,[w[11]||(w[11]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),Q(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":w[1]||(w[1]=R=>a.value.permission_mode=R)},[...w[10]||(w[10]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[je,a.value.permission_mode]]),w[12]||(w[12]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",C1,[w[14]||(w[14]=s("label",{for:"model",class:"form-label"},"Model",-1)),Q(s("select",{class:"form-select",id:"model","onUpdate:modelValue":w[2]||(w[2]=R=>a.value.model=R)},[...w[13]||(w[13]=[s("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),s("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),s("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[je,a.value.model]])]),s("div",S1,[w[15]||(w[15]=s("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),Q(s("textarea",{class:z(["form-control",{"is-invalid":v.value}]),id:"systemPrompt","onUpdate:modelValue":w[3]||(w[3]=R=>a.value.system_prompt=R),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[ae,a.value.system_prompt]]),s("div",k1,[s("span",null,$(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),s("span",{class:z({"text-danger":v.value,"text-warning":g.value})},$(h.value)+" / 6000 chars ",3)]),v.value?(u(),p("div",T1," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):j("",!0)]),s("div",x1,[Q(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":w[4]||(w[4]=R=>a.value.override_system_prompt=R)},null,512),[[Ct,a.value.override_system_prompt]]),w[17]||(w[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),p("div",A1,[...w[16]||(w[16]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):j("",!0)]),s("div",M1,[w[18]||(w[18]=s("label",{for:"tools",class:"form-label"},"Allowed Tools (Optional)",-1)),Q(s("input",{type:"text",class:"form-control",id:"tools","onUpdate:modelValue":w[5]||(w[5]=R=>a.value.tools=R),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[ae,a.value.tools]]),w[19]||(w[19]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",O1,[Q(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":w[6]||(w[6]=R=>a.value.startImmediately=R)},null,512),[[Ct,a.value.startImmediately]]),w[20]||(w[20]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),l.value?(u(),p("div",N1,$(l.value),1)):j("",!0)],32)]),s("div",D1,[w[21]||(w[21]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:d.value},[d.value?(u(),p("span",I1)):j("",!0),Y(" "+$(d.value?"Creating...":"Create Session"),1)],8,L1)])])])],512))}},P1=G(j1,[["__scopeId","data-v-5aef47e0"]]),R1={class:"modal-dialog"},V1={class:"modal-content"},H1={class:"modal-body"},W1={class:"mb-3"},F1={key:0,class:"invalid-feedback"},U1={class:"mb-3"},B1=["value"],q1={class:"mb-3"},z1={class:"form-control-plaintext"},K1={class:"mb-3"},Y1=["disabled"],G1={key:0,value:"bypassPermissions"},J1={class:"form-text"},X1={key:0,class:"text-warning"},Q1={key:1},Z1={key:0,class:"mb-3"},e$={class:"card"},t$={class:"card-body"},s$={key:0,class:"mb-2"},n$={key:1,class:"mb-2"},o$={key:2,class:"mt-2"},i$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},a$={key:1,class:"alert alert-danger",role:"alert"},r$={class:"modal-footer"},l$=["disabled"],c$={key:0,class:"spinner-border spinner-border-sm me-2"},d$={__name:"SessionEditModal",setup(n){const e=X(),t=ie(),o=D(null),i=D({name:"",permission_mode:"default"}),a=D({name:""}),r=D(!1),d=D(""),l=D(null);let m=null;const c=f(()=>o.value?.state==="active"||o.value?.state==="starting"),h=f(()=>o.value?.initial_permission_mode==="bypassPermissions");function v(M){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[M]||"bg-secondary"}function g(){a.value={};let M=!0;return i.value.name.trim()||(a.value.name="Session name is required",M=!1),M}async function x(){if(!(!g()||!o.value)){r.value=!0,d.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),m&&m.hide()}catch(M){console.error("Failed to update session:",M),d.value=M.message||"Failed to update session. Please try again."}finally{r.value=!1}}}function _(){i.value={name:"",permission_mode:"default"},a.value={},d.value=""}function b(){const M=document.getElementById("editSessionName");M&&(M.focus(),M.select())}function y(){_(),o.value=null,t.hideModal()}return ne(()=>t.currentModal,M=>{if(M?.name==="edit-session"&&m){const C=M.data||{};o.value=C.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),m.show()}}),re(()=>{l.value&&fe(async()=>{const{default:M}=await import("./modal-B4rHLo2F.js").then(C=>C.m);return{default:M}},__vite__mapDeps([0,1])).then(({default:M})=>{m=new M(l.value),l.value.addEventListener("shown.bs.modal",b),l.value.addEventListener("hidden.bs.modal",y)})}),pe(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",b),l.value.removeEventListener("hidden.bs.modal",y)),m&&m.dispose()}),(M,C)=>(u(),p("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",R1,[s("div",V1,[C[15]||(C[15]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",H1,[s("form",{onSubmit:ce(x,["prevent"])},[s("div",W1,[C[2]||(C[2]=s("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),Q(s("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":C[0]||(C[0]=w=>i.value.name=w),placeholder:"Session Name",required:""},null,2),[[ae,i.value.name]]),a.value.name?(u(),p("div",F1,$(a.value.name),1)):j("",!0)]),s("div",U1,[C[3]||(C[3]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,B1),C[4]||(C[4]=s("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),s("div",q1,[C[5]||(C[5]=s("label",{class:"form-label"},"Current State",-1)),s("div",z1,[s("span",{class:z(["badge",v(o.value?.state)])},$(o.value?.state),3)])]),s("div",K1,[C[9]||(C[9]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),Q(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":C[1]||(C[1]=w=>i.value.permission_mode=w),disabled:!c.value},[C[6]||(C[6]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),C[7]||(C[7]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),C[8]||(C[8]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),h.value?(u(),p("option",G1,"âš ï¸ Bypass Permissions (No prompts)")):j("",!0)],8,Y1),[[je,i.value.permission_mode]]),s("div",J1,[c.value?(u(),p("span",Q1," Controls which tool actions require permission prompts ")):(u(),p("span",X1," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),p("div",Z1,[C[13]||(C[13]=s("label",{class:"form-label"},"System Prompt Configuration",-1)),s("div",e$,[s("div",t$,[o.value?.override_system_prompt?(u(),p("div",s$,[...C[10]||(C[10]=[s("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),s("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),p("div",n$,[...C[11]||(C[11]=[s("span",{class:"badge bg-info"},"Append Mode",-1),s("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),p("div",o$,[C[12]||(C[12]=s("strong",{class:"small"},"Custom Instructions:",-1)),s("div",i$,$(o.value.system_prompt),1)])):j("",!0)])])])):j("",!0),d.value?(u(),p("div",a$,$(d.value),1)):j("",!0)],32)]),s("div",r$,[C[14]||(C[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:x,disabled:r.value},[r.value?(u(),p("span",c$)):j("",!0),Y(" "+$(r.value?"Saving...":"Save Changes"),1)],8,l$)])])])],512))}},u$=G(d$,[["__scopeId","data-v-c99ca17f"]]),p$={class:"modal-dialog modal-dialog-centered"},m$={class:"modal-content"},f$={class:"modal-header"},v$={class:"modal-title",id:"manageSessionModalLabel"},h$={class:"modal-body"},_$={key:0,class:"text-center py-4"},g$={class:"text-muted"},b$={key:1},y$={key:2},$$={class:"text-muted"},w$={key:3},E$={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},C$={class:"d-grid gap-2"},S$=["disabled"],k$=["disabled"],T$=["disabled"],x$=["disabled"],A$={class:"modal-footer"},M$={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},O$={__name:"SessionManageModal",setup(n){const e=We(),t=X(),o=ie(),i=Fe();xe();const a=D(null),r=D(!1),d=D(""),l=D(""),m=D(null),c=D(null);let h=null;const v=f(()=>m.value==="reset"?"Reset Session":m.value==="delete"?"Delete Session":"Manage Session");function g(){m.value="reset"}function x(){m.value="delete"}function _(){m.value=null}async function b(){m.value==="reset"?await C():m.value==="delete"&&await w()}async function y(){if(a.value){r.value=!0,d.value="Restarting session...";try{const A=a.value.session_id,T=await J.post(`/api/sessions/${A}/restart`);if(T.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A),h&&h.hide();else{const O=T.error||T.detail||"Failed to restart session";console.error("Failed to restart session:",O),l.value=`Failed to restart session: ${O}`}}catch(A){console.error("Error restarting session:",A);const T=A.data?.detail||A.message||"Unknown error";l.value=`Error restarting session: ${T}`}finally{r.value=!1}}}async function M(){if(a.value)try{h&&h.hide(),console.log("Ending session",a.value.session_id);const A=a.value.session_id;await J.post(`/api/sessions/${A}/terminate`),await i.disconnectSession(),t.currentSessionId===A&&(t.currentSessionId=null),e.push("/")}catch(A){console.error("Error ending session:",A),await i.disconnectSession(),t.currentSessionId===a.value?.session_id&&(t.currentSessionId=null),e.push("/")}}async function C(){if(a.value){r.value=!0,d.value="Resetting session...";try{const A=a.value.session_id,T=await J.post(`/api/sessions/${A}/reset`);if(T.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A),h&&h.hide();else{const O=T.error||T.detail||"Failed to reset session";console.error("Failed to reset session:",O),l.value=`Failed to reset session: ${O}`,m.value=null}}catch(A){console.error("Error resetting session:",A);const T=A.data?.detail||A.message||"Unknown error";l.value=`Error resetting session: ${T}`,m.value=null}finally{r.value=!1}}}async function w(){if(a.value){r.value=!0,d.value="Deleting session...";try{const A=a.value.session_id;await t.deleteSession(A),e.currentRoute.value.params.sessionId===A&&e.push("/"),h&&h.hide()}catch(A){console.error("Error deleting session:",A);const T=A.data?.detail||A.message||"Unknown error";l.value=`Error deleting session: ${T}`,m.value=null}finally{r.value=!1}}}function R(){m.value=null,r.value=!1,d.value="",l.value=""}function V(){R(),a.value=null,o.hideModal()}return ne(()=>o.currentModal,A=>{if(A?.name==="manage-session"&&h){const T=A.data||{};a.value=T.session,R(),h.show()}}),re(()=>{c.value&&fe(async()=>{const{default:A}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{h=new A(c.value),c.value.addEventListener("hidden.bs.modal",V)})}),pe(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",V),h&&h.dispose()}),(A,T)=>(u(),p("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",p$,[s("div",m$,[s("div",f$,[s("h5",v$,$(m.value?v.value:"Manage Session"),1),T[1]||(T[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",h$,[r.value?(u(),p("div",_$,[T[2]||(T[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",g$,$(d.value),1)])):m.value==="reset"?(u(),p("div",b$,[...T[3]||(T[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):m.value==="delete"?(u(),p("div",y$,[T[6]||(T[6]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",$$,[T[4]||(T[4]=Y("This will permanently delete session ",-1)),s("strong",null,$(a.value?.name),1),T[5]||(T[5]=Y(".",-1))]),T[7]||(T[7]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(u(),p("div",w$,[l.value?(u(),p("div",E$,[T[8]||(T[8]=s("strong",null,"Error:",-1)),Y(" "+$(l.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:T[0]||(T[0]=O=>l.value="")})])):j("",!0),T[15]||(T[15]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",C$,[s("button",{class:"btn btn-outline-primary text-start",onClick:y,disabled:r.value},[...T[9]||(T[9]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,S$),s("button",{class:"btn btn-outline-secondary text-start",onClick:M,disabled:r.value},[...T[10]||(T[10]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,k$),T[13]||(T[13]=s("hr",{class:"my-2"},null,-1)),T[14]||(T[14]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:g,disabled:r.value},[...T[11]||(T[11]=[s("strong",null,"ðŸ—‘ï¸ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,T$),s("button",{class:"btn btn-outline-danger text-start",onClick:x,disabled:r.value},[...T[12]||(T[12]=[s("strong",null,"âŒ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,x$)]),T[16]||(T[16]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),Y(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",A$,[m.value&&!r.value?(u(),p(Z,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),s("button",{type:"button",class:z(["btn",m.value==="delete"?"btn-danger":"btn-warning"]),onClick:b},$(m.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?j("",!0):(u(),p("button",M$,"Cancel"))])])])],512))}},N$=G(O$,[["__scopeId","data-v-de7ff18c"]]),D$={class:"modal-dialog modal-dialog-centered modal-lg"},L$={class:"modal-content"},I$={class:"modal-body"},j$={key:0,class:"text-center text-muted py-4"},P$={key:1},R$={class:"mb-3"},V$={class:"font-monospace small"},H$={class:"mb-3"},W$={class:"font-monospace small"},F$={class:"mb-3"},U$={class:"mb-3"},B$={class:"mb-3"},q$={key:0},z$={class:"d-flex flex-wrap gap-1"},K$={key:1,class:"text-muted small"},Y$={key:0,class:"mb-3"},G$={class:"d-flex flex-wrap gap-1"},J$={key:1,class:"mb-3"},X$={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},Q$={class:"mb-3"},Z$={class:"text-muted"},ew={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},tw={__name:"SessionInfoModal",setup(n){const e=X(),t=xe(),o=ie(),i=D(null),a=D(!1),r=D(null);let d=null;const l=f(()=>{if(!i.value)return null;const v=e.initData.get(i.value);return v||(t.messagesBySession.get(i.value)||[]).find(_=>_.type==="system"&&(_.subtype==="init"||_.metadata?.subtype==="init")&&_.metadata?.init_data)?.metadata?.init_data||null});function m(v){return typeof v=="string"?v:typeof v=="object"&&v.type==="preset"?`Preset: ${v.preset}`:JSON.stringify(v,null,2)}function c(){i.value=null,a.value=!1}function h(){c(),o.hideModal()}return ne(()=>o.currentModal,v=>{if(v?.name==="session-info"&&d){const g=v.data||{};i.value=g.sessionId,a.value=!1,d.show()}}),re(()=>{r.value&&fe(async()=>{const{default:v}=await import("./modal-B4rHLo2F.js").then(g=>g.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{d=new v(r.value),r.value.addEventListener("hidden.bs.modal",h)})}),pe(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",h),d&&d.dispose()}),(v,g)=>(u(),p("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",D$,[s("div",L$,[g[9]||(g[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",I$,[l.value?(u(),p("div",P$,[s("div",R$,[g[1]||(g[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",V$,$(i.value),1)]),s("div",H$,[g[2]||(g[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("div",W$,$(l.value.cwd||"Not specified"),1)]),s("div",F$,[g[3]||(g[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,$(l.value.model||"Default"),1)]),s("div",U$,[g[4]||(g[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,$(l.value.permissionMode||"default"),1)]),s("div",B$,[g[5]||(g[5]=s("h6",{class:"text-muted"},"Available Tools",-1)),l.value.tools&&l.value.tools.length>0?(u(),p("div",q$,[s("div",z$,[(u(!0),p(Z,null,se(l.value.tools,x=>(u(),p("span",{key:x,class:"badge bg-secondary"},$(x),1))),128))])])):(u(),p("div",K$,"All tools available"))]),l.value.commands&&l.value.commands.length>0?(u(),p("div",Y$,[g[6]||(g[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",G$,[(u(!0),p(Z,null,se(l.value.commands,x=>(u(),p("span",{key:x,class:"badge bg-info"},$(x),1))),128))])])):j("",!0),l.value.systemPrompt?(u(),p("div",J$,[g[7]||(g[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",X$,$(m(l.value.systemPrompt)),1)])):j("",!0),s("div",Q$,[s("h6",Z$,[g[8]||(g[8]=Y(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:g[0]||(g[0]=x=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(u(),p("pre",ew,$(JSON.stringify(l.value,null,2)),1)):j("",!0)])])):(u(),p("div",j$," No session configuration data available "))]),g[10]||(g[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},sw=G(tw,[["__scopeId","data-v-809e2099"]]),nw={class:"modal-dialog modal-dialog-centered"},ow={class:"modal-content"},iw={class:"modal-body"},aw={class:"mb-3"},rw={class:"mb-3"},lw={class:"mb-3"},cw={class:"form-text d-flex justify-content-between"},dw={key:0,class:"invalid-feedback"},uw={class:"mb-3 form-check"},pw={key:0,class:"form-text text-warning"},mw={class:"mb-3"},fw={key:0,class:"alert alert-danger"},vw={class:"modal-footer"},hw=["disabled"],_w={key:0,class:"spinner-border spinner-border-sm me-2"},gw={__name:"CreateMinionModal",setup(n){const e=We(),t=le(),o=X(),i=ie(),a=D(null);let r=null;const d=D(null),l=D({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[]}),m=D(""),c=D(""),h=D(!1),v=f(()=>m.value.trim()?m.value.split(",").map(C=>C.trim()).filter(C=>C.length>0):[]),g=f(()=>l.value.initialization_context.length),x=f(()=>g.value>2e3),_=f(()=>g.value>1800&&g.value<=2e3);function b(){l.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[]},m.value="",c.value="",h.value=!1}function y(){b(),i.hideModal()}async function M(){if(!l.value.name.trim()){c.value="Minion name is required";return}if(l.value.name.includes(" ")){c.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(x.value){c.value="Initialization context exceeds 2000 character limit";return}if(!d.value){c.value="Legion ID is missing";return}h.value=!0,c.value="";try{const C={name:l.value.name.trim(),role:l.value.role.trim(),initialization_context:l.value.initialization_context.trim(),override_system_prompt:l.value.override_system_prompt,capabilities:v.value},w=await J.post(`/api/legions/${d.value}/minions`,C);w.success&&w.minion_id?(await t.fetchProjects(),await o.fetchSessions(),r&&r.hide(),e.push(`/spy/${d.value}/${w.minion_id}`)):c.value="Failed to create minion"}catch(C){console.error("Failed to create minion:",C),c.value=C.response?.data?.detail||"Failed to create minion"}finally{h.value=!1}}return ne(()=>i.currentModal,C=>{if(C?.name==="create-minion"&&r){const w=C.data||{};d.value=w.project?.project_id||null,b(),r.show()}}),re(()=>{a.value&&fe(()=>import("./modal-B4rHLo2F.js").then(C=>C.m),__vite__mapDeps([0,1])).then(C=>{const w=C.default;r=new w(a.value),a.value.addEventListener("hidden.bs.modal",y)})}),pe(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",y),r&&r.dispose()}),(C,w)=>(u(),p("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[s("div",nw,[s("div",ow,[w[15]||(w[15]=s("div",{class:"modal-header"},[s("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",iw,[s("form",{onSubmit:ce(M,["prevent"])},[s("div",aw,[w[5]||(w[5]=s("label",{for:"minion-name",class:"form-label"},[Y(" Name "),s("span",{class:"text-danger"},"*")],-1)),Q(s("input",{id:"minion-name","onUpdate:modelValue":w[0]||(w[0]=R=>l.value.name=R),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[ae,l.value.name]]),w[6]||(w[6]=s("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),s("div",rw,[w[7]||(w[7]=s("label",{for:"minion-role",class:"form-label"},"Role",-1)),Q(s("input",{id:"minion-role","onUpdate:modelValue":w[1]||(w[1]=R=>l.value.role=R),type:"text",class:"form-control",placeholder:"e.g., Code Expert, Testing Specialist"},null,512),[[ae,l.value.role]]),w[8]||(w[8]=s("div",{class:"form-text"},"Optional role description for the minion",-1))]),s("div",lw,[w[9]||(w[9]=s("label",{for:"minion-context",class:"form-label"},"Initialization Context",-1)),Q(s("textarea",{id:"minion-context","onUpdate:modelValue":w[2]||(w[2]=R=>l.value.initialization_context=R),class:z(["form-control",{"is-invalid":x.value}]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion..."},null,2),[[ae,l.value.initialization_context]]),s("div",cw,[s("span",null,$(l.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),s("span",{class:z({"text-danger":x.value,"text-warning":_.value})},$(g.value)+" / 2000 chars ",3)]),x.value?(u(),p("div",dw," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):j("",!0)]),s("div",uw,[Q(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":w[3]||(w[3]=R=>l.value.override_system_prompt=R)},null,512),[[Ct,l.value.override_system_prompt]]),w[11]||(w[11]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),l.value.override_system_prompt?(u(),p("div",pw,[...w[10]||(w[10]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):j("",!0)]),s("div",mw,[w[12]||(w[12]=s("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),Q(s("input",{id:"minion-capabilities","onUpdate:modelValue":w[4]||(w[4]=R=>m.value=R),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[ae,m.value]]),w[13]||(w[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),c.value?(u(),p("div",fw,$(c.value),1)):j("",!0)],32)]),s("div",vw,[w[14]||(w[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",disabled:!l.value.name.trim()||h.value,onClick:M},[h.value?(u(),p("span",_w)):j("",!0),Y(" "+$(h.value?"Creating...":"Create Minion"),1)],8,hw)])])])],512))}},bw=G(gw,[["__scopeId","data-v-d7434e2a"]]),yw={class:"modal-dialog modal-dialog-centered modal-lg"},$w={class:"modal-content"},ww={class:"modal-body"},Ew={key:0,class:"text-center text-muted py-4"},Cw={key:1},Sw={class:"mb-3"},kw={class:"mb-3"},Tw={class:"font-monospace small"},xw={class:"mb-3"},Aw={class:"mb-3"},Mw={class:"mb-3"},Ow={key:0},Nw={class:"d-flex flex-wrap gap-1"},Dw={key:1,class:"text-muted small"},Lw={class:"mb-3"},Iw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},jw={key:1,class:"text-muted small"},Pw={class:"mb-3"},Rw={key:0,class:"badge bg-info"},Vw={key:1,class:"badge bg-secondary"},Hw={class:"mb-3"},Ww={key:0,class:"font-monospace small"},Fw={key:1,class:"text-muted small"},Uw={key:0,class:"mb-3"},Bw={key:0},qw={class:"list-unstyled mb-0"},zw={key:1,class:"text-muted small"},Kw={class:"mb-3"},Yw={key:0,class:"font-monospace small"},Gw={key:1,class:"text-muted small"},Jw={class:"mb-3"},Xw={key:0},Qw={class:"d-flex flex-wrap gap-1"},Zw={key:1,class:"text-muted small"},eE={class:"mb-3"},tE={class:"small"},sE={class:"mb-3"},nE={class:"small"},oE={__name:"MinionViewModal",setup(n){const e=ie(),t=D(null),o=D(null);let i=null;function a(m){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[m]||"bg-secondary"}function r(m){if(!m)return"N/A";try{const c=new Date(m);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function d(){t.value=null}function l(){d(),e.hideModal()}return ne(()=>e.currentModal,m=>{if(m?.name==="minion-view"&&i){const c=m.data||{};t.value=c.session,i.show()}}),re(()=>{o.value&&fe(async()=>{const{default:m}=await import("./modal-B4rHLo2F.js").then(c=>c.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{i=new m(o.value),o.value.addEventListener("hidden.bs.modal",l)})}),pe(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",l),i&&i.dispose()}),(m,c)=>(u(),p("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",yw,[s("div",$w,[c[13]||(c[13]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",ww,[t.value?(u(),p("div",Cw,[s("div",Sw,[c[0]||(c[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,$(t.value.name||"Unnamed Minion"),1)]),s("div",kw,[c[1]||(c[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",Tw,$(t.value.session_id),1)]),s("div",xw,[c[2]||(c[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,$(t.value.role||"Not specified"),1)]),s("div",Aw,[c[3]||(c[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:z(["badge",a(t.value.state)])},$(t.value.state),3)])]),s("div",Mw,[c[4]||(c[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(u(),p("div",Ow,[s("div",Nw,[(u(!0),p(Z,null,se(t.value.capabilities,h=>(u(),p("span",{key:h,class:"badge bg-secondary"},$(h),1))),128))])])):(u(),p("div",Dw,"None"))]),s("div",Lw,[c[5]||(c[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(u(),p("div",Iw,$(t.value.initialization_context),1)):(u(),p("div",jw,"Not specified"))]),s("div",Pw,[c[6]||(c[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(u(),p("span",Rw,"Yes")):(u(),p("span",Vw,"No"))])]),s("div",Hw,[c[7]||(c[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(u(),p("div",Ww,$(t.value.parent_overseer_id),1)):(u(),p("div",Fw,$(t.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),t.value.is_overseer?(u(),p("div",Uw,[c[8]||(c[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(u(),p("div",Bw,[s("ul",qw,[(u(!0),p(Z,null,se(t.value.child_minion_ids,h=>(u(),p("li",{key:h,class:"font-monospace small"},$(h),1))),128))])])):(u(),p("div",zw,"No children"))])):j("",!0),s("div",Kw,[c[9]||(c[9]=s("h6",{class:"text-muted"},"Horde Membership",-1)),t.value.horde_id?(u(),p("div",Yw,$(t.value.horde_id),1)):(u(),p("div",Gw,"Not in a horde"))]),s("div",Jw,[c[10]||(c[10]=s("h6",{class:"text-muted"},"Channel Memberships",-1)),t.value.channel_ids&&t.value.channel_ids.length>0?(u(),p("div",Xw,[s("div",Qw,[(u(!0),p(Z,null,se(t.value.channel_ids,h=>(u(),p("span",{key:h,class:"badge bg-info"},$(h),1))),128))])])):(u(),p("div",Zw,"No channels"))]),s("div",eE,[c[11]||(c[11]=s("h6",{class:"text-muted"},"Created",-1)),s("div",tE,$(r(t.value.created_at)),1)]),s("div",sE,[c[12]||(c[12]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",nE,$(r(t.value.updated_at)),1)])])):(u(),p("div",Ew," No minion data available "))]),c[14]||(c[14]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},iE=G(oE,[["__scopeId","data-v-c44eaee2"]]),aE={class:"container-fluid vh-100 d-flex flex-column p-0"},rE={class:"d-flex flex-grow-1 overflow-hidden position-relative"},lE={class:"flex-grow-1 d-flex flex-column overflow-hidden"},cE={__name:"App",setup(n){const e=ie(),t=Fe(),o=X(),i=le(),a=We(),r=f(()=>e.sidebarCollapsed),d=f(()=>e.isMobile);re(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const h=c.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(c.startsWith("#/timeline/")){const h=c.replace("#/timeline/","");a.push(`/timeline/${h}`)}window.addEventListener("popstate",l),window.addEventListener("resize",e.handleResize)}),pe(()=>{window.removeEventListener("popstate",l),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function l(){const c=window.location.hash;if(c.startsWith("#/session/")){const h=c.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function m(){e.toggleSidebar()}return(c,h)=>{const v=so("router-view");return u(),p("div",aE,[te(Bm),s("div",{id:"sidebar-backdrop",class:z({show:!r.value&&d.value}),onClick:m},null,2),s("div",rE,[te(dy),s("main",lE,[te(v)])]),te(Ty),te(zy),te(f1),te(P1),te(u$),te(N$),te(sw),te(bw),te(iE)])}}},tn=fi(cE);tn.use(vi());tn.use(Hm);tn.mount("#app");
