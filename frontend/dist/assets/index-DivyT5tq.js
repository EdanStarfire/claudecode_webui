const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as t,o as u,d as $t,r as M,b as y,t as S,n as He,e as K,f as X,u as Qt,w as ce,g as vn,h as N,F as ie,i as de,j as ve,k as ao,l as oe,v as pe,m as Ot,p as be,q as re,s as me,x as ns,y as Ns,z as he,A as Oe,B as io,C as ha,D as _a,E as Ge,T as lo,G as Dt,H as ga,I as ba}from"./vue-vendor-Bif8Ag3L.js";import{m as nt,p as os}from"./markdown-vendor-CQ3OZdP9.js";import{c as ya}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();const $a={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},wa={__name:"NoSessionSelected",setup(n){return(e,s)=>(u(),m("div",$a,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Ca="modulepreload",Ea=function(n){return"/"+n},hn={},ye=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let d=function(_){return Promise.all(_.map(r=>Promise.resolve(r).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");a=d(s.map(_=>{if(_=Ea(_),_ in hn)return;hn[_]=!0;const r=_.endsWith(".css"),w=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${w}`))return;const h=document.createElement("link");if(h.rel=r?"stylesheet":Ca,r||(h.as="script"),h.crossOrigin="",h.href=_,c&&h.setAttribute("nonce",c),document.head.appendChild(h),r)return new Promise((p,g)=>{h.addEventListener("load",p),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${_}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})};class fs extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Nt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new fs(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof fs?s:(console.error("API request failed:",s),new fs(`Network error: ${s.message}`,0,null))}}async function Sa(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[c,d]of Object.entries(e.params))d!=null&&o.append(c,d);const a=o.toString();a&&(s=`${n}?${a}`);const{params:i,...l}=e;return Nt(s,{...l,method:"GET"})}return Nt(s,{...e,method:"GET"})}async function ka(n,e,s={}){return Nt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ta(n,e,s={}){return Nt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function xa(n,e={}){return Nt(n,{...e,method:"DELETE"})}const se={get:Sa,post:ka,put:Ta,delete:xa},ae=$t("session",()=>{const n=M(new Map),e=M(null),s=M(new Map),o=M(new Map),a=M(new Set),i=M(!1);let l=null;const c=y(()=>n.value.get(e.value)),d=y(()=>Array.from(n.value.values()).sort((x,D)=>x.order-D.order)),_=x=>y(()=>d.value.filter(D=>D.project_id===x)),r=y({get:()=>s.value.get(e.value)||"",set:x=>{e.value&&s.value.set(e.value,x)}});async function w(){try{const x=await se.get("/api/sessions");return n.value.clear(),x.sessions.forEach(D=>{n.value.set(D.session_id,D)}),console.log(`Loaded ${n.value.size} sessions`),x.sessions}catch(x){throw console.error("Failed to fetch sessions:",x),x}}async function h(x,D){try{const Q=(await se.post("/api/sessions",{project_id:x,...D})).session_id,$=(await se.get(`/api/sessions/${Q}`)).session;return n.value.set(Q,$),n.value=new Map(n.value),console.log(`Created session ${Q}`),$}catch(B){throw console.error("Failed to create session:",B),B}}async function p(x){if(e.value===x&&!i.value)return;l&&(console.log(`Aborting pending selection to switch to ${x}`),l.abort(),l=null);const D=new AbortController;l=D,i.value=!0;try{if(e.value=x,D.signal.aborted){console.log(`Selection of ${x} aborted early`);return}let B=n.value.get(x);if(!B)try{const $=await se.get(`/api/sessions/${x}`);if(D.signal.aborted){console.log(`Selection of ${x} aborted after fetch`);return}B=$.session,n.value.set(x,B),n.value=new Map(n.value),console.log(`Fetched session ${x} for deeplink`)}catch($){console.error(`Failed to fetch session ${x}:`,$);return}if(B&&(B.state==="created"||B.state==="terminated"))try{if(await E(x),D.signal.aborted){console.log(`Selection of ${x} aborted after start`);return}console.log(`Auto-started session ${x} (was in ${B.state} state)`);const $=6e4,C=200,A=5e3;let O=0,P=0;for(;O<$;){if(D.signal.aborted){console.log(`Selection of ${x} aborted during state wait`);return}const Y=n.value.get(x);if(Y&&Y.state==="active"){console.log(`Session ${x} is now active after ${O}ms`);break}if(O-P>=A){const le=n.value.get(x)?.state||"unknown";console.log(`Waiting for session ${x} to become active (current: ${le}, ${O/1e3}s elapsed)`),P=O}await new Promise(le=>setTimeout(le,C)),O+=C}const V=n.value.get(x);V&&V.state!=="active"&&console.warn(`Session ${x} did not become active within ${$/1e3}s (state: ${V.state}), continuing anyway`)}catch($){console.error(`Failed to auto-start session ${x}:`,$)}if(D.signal.aborted){console.log(`Selection of ${x} aborted before message load`);return}if(await(await ye(()=>Promise.resolve().then(()=>Ga),void 0)).useMessageStore().loadMessages(x),D.signal.aborted){console.log(`Selection of ${x} aborted after message load`);return}await(await ye(()=>Promise.resolve().then(()=>vi),void 0)).useWebSocketStore().connectSession(x),D.signal.aborted||console.log(`Selected session ${x}`)}finally{l===D&&(l=null),i.value=!1}}function g(x,D){const B=n.value.get(x);B?Object.assign(B,D):(n.value.set(x,D),console.log(`Added new session ${x} via WebSocket update`)),n.value=new Map(n.value)}async function b(x){a.value.add(x);try{await se.delete(`/api/sessions/${x}`),n.value.delete(x),s.value.delete(x),o.value.delete(x),n.value=new Map(n.value),e.value===x&&(e.value=null),console.log(`Deleted session ${x}`)}catch(D){throw console.error("Failed to delete session:",D),D}finally{a.value.delete(x)}}async function v(x,D){try{await se.put(`/api/sessions/${x}/name`,{name:D}),g(x,{name:D}),console.log(`Updated session ${x} name to "${D}"`)}catch(B){throw console.error("Failed to update session name:",B),B}}async function f(x,D){try{await se.post(`/api/sessions/${x}/permission-mode`,{mode:D}),g(x,{current_permission_mode:D});const B=o.value.get(x);B&&(B.permissionMode=D,o.value.set(x,B)),console.log(`Set permission mode for session ${x} to ${D}`)}catch(B){throw console.error("Failed to set permission mode:",B),B}}async function E(x){try{await se.post(`/api/sessions/${x}/start`),console.log(`Started session ${x}`)}catch(D){throw console.error("Failed to start session:",D),D}}async function k(x){try{await se.post(`/api/sessions/${x}/pause`),console.log(`Paused session ${x}`)}catch(D){throw console.error("Failed to pause session:",D),D}}async function T(x){try{await se.post(`/api/sessions/${x}/terminate`),console.log(`Terminated session ${x}`)}catch(D){throw console.error("Failed to terminate session:",D),D}}function L(x){return n.value.get(x)}function I(x,D){o.value.set(x,D),D.permissionMode&&g(x,{current_permission_mode:D.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:c,orderedSessions:d,sessionsInProject:_,currentInput:r,fetchSessions:w,createSession:h,selectSession:p,updateSession:g,deleteSession:b,updateSessionName:v,setPermissionMode:f,startSession:E,pauseSession:k,terminateSession:T,getSession:L,storeInitData:I}}),_n=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ae},Symbol.toStringTag,{value:"Module"})),fe=$t("ui",()=>{const n=M(window.innerWidth<768),e=M(300),s=M(window.innerWidth),o=y(()=>s.value<768),a=M(!0),i=M(null),l=M(null),c=y(()=>i.value?{name:i.value,data:l.value}:null),d=M(!1),_=M("Loading...");function r(){n.value=!n.value}function w(k){n.value=k}function h(k){e.value=Math.max(200,Math.min(k,window.innerWidth*.3))}function p(k){a.value=k}function g(k,T=null){i.value=null,l.value=null,setTimeout(()=>{i.value=k,l.value=T},0)}function b(){i.value=null,l.value=null}function v(k="Loading..."){d.value=!0,_.value=k}function f(){d.value=!1}function E(){const k=s.value;s.value=window.innerWidth,s.value<768&&k>=768?n.value=!0:s.value>=768&&k<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:a,activeModal:i,modalData:l,currentModal:c,isLoading:d,loadingMessage:_,toggleSidebar:r,setSidebarCollapsed:w,setSidebarWidth:h,setAutoScroll:p,showModal:g,hideModal:b,showLoading:v,hideLoading:f,handleResize:E}}),ge=$t("project",()=>{const n=M(new Map),e=M(null),s=y(()=>n.value.get(e.value)),o=y(()=>Array.from(n.value.values()).sort((b,v)=>b.order-v.order)),a=b=>n.value.get(b)?.is_multi_agent||!1;async function i(){try{const b=await se.get("/api/projects");return n.value.clear(),b.projects.forEach(v=>{n.value.set(v.project_id,v)}),console.log(`Loaded ${n.value.size} projects`),b.projects}catch(b){throw console.error("Failed to fetch projects:",b),b}}async function l(b,v,f=!1){try{const k=(await se.post("/api/projects",{name:b,working_directory:v,is_multi_agent:f})).project;return n.value.set(k.project_id,k),n.value=new Map(n.value),console.log(`Created project ${k.project_id}`),k}catch(E){throw console.error("Failed to create project:",E),E}}async function c(b,v){try{await se.put(`/api/projects/${b}`,v),d(b,v),console.log(`Updated project ${b}`,v)}catch(f){throw console.error("Failed to update project:",f),f}}function d(b,v){const f=n.value.get(b);f&&(Object.assign(f,v),n.value=new Map(n.value))}async function _(b){try{await se.delete(`/api/projects/${b}`),n.value.delete(b),n.value=new Map(n.value),e.value===b&&(e.value=null),console.log(`Deleted project ${b}`)}catch(v){throw console.error("Failed to delete project:",v),v}}async function r(b){try{const v=await se.put(`/api/projects/${b}/toggle-expansion`),f=n.value.get(b);return f&&(f.is_expanded=v.is_expanded,n.value=new Map(n.value)),v.is_expanded}catch(v){throw console.error("Failed to toggle expansion:",v),v}}async function w(b){try{await se.put("/api/projects/reorder",{project_ids:b}),b.forEach((v,f)=>{const E=n.value.get(v);E&&(E.order=f)}),n.value=new Map(n.value),console.log("Reordered projects",b)}catch(v){throw console.error("Failed to reorder projects:",v),v}}async function h(b,v){try{await se.put(`/api/projects/${b}/sessions/reorder`,{session_ids:v});const f=n.value.get(b);f&&(f.session_ids=v,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${b}`,v)}catch(f){throw console.error("Failed to reorder sessions:",f),f}}function p(b){return n.value.get(b)}function g(b){if(!b)return"";const v=b.split(/[/\\]/).filter(f=>f);return v.length===0?"/":v.length===1?`/${v[0]}`:v.length===2?`/${v.join("/")}`:`.../${v.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,isMultiAgent:a,fetchProjects:i,createProject:l,updateProject:c,updateProjectLocal:d,deleteProject:_,toggleExpansion:r,reorderProjects:w,reorderSessionsInProject:h,getProject:p,formatPath:g}}),z=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},Ma={class:"session-header border-bottom p-3"},Aa={class:"project-name"},Oa=["title"],Da={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=ge(),a=y(()=>s.sessions.get(e.sessionId)),i=y(()=>a.value?.name||e.sessionId),l=y(()=>{for(const d of o.projects.values())if(d.session_ids?.includes(e.sessionId))return d;return null}),c=y(()=>l.value?.name||"Unknown Project");return(d,_)=>(u(),m("div",Ma,[t("div",null,[t("div",Aa,S(c.value),1),t("div",{class:"session-name",title:n.sessionId},S(i.value),9,Oa)])]))}},Na=z(Da,[["__scopeId","data-v-89e9c269"]]),La={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ia=["title"],Pa={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},ja={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=y(()=>s.sessions.get(e.sessionId)),a=y(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),i=y(()=>{const d=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[d]||"#d3d3d3"}),l=y(()=>{const d=a.value;return d==="starting"||d==="processing"||d==="pending-prompt"}),c=y(()=>{if(!o.value)return"No session selected";const d=a.value,_=d.charAt(0).toUpperCase()+d.slice(1).replace("-"," "),r=o.value.name||"Unnamed Session",w=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${r}${w}: ${_}`});return(d,_)=>(u(),m("div",La,[o.value?(u(),m("div",{key:0,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:He({width:"100%",backgroundColor:i.value}),title:c.value},null,14,Ia)):(u(),m("div",Pa))]))}},Ra=z(ja,[["__scopeId","data-v-e8795bb7"]]),Va={class:"session-status-bar border-top p-2 bg-light"},Ha={class:"d-flex justify-content-between align-items-center gap-2"},Wa={class:"d-flex gap-2"},Fa=["disabled"],Ua={class:"mode-label"},Ba=["disabled"],qa=["disabled"],za={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=fe(),a=y(()=>s.sessions.get(e.sessionId)),i=y(()=>a.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},c=y(()=>l[i.value]||"ðŸ”’"),d=y(()=>i.value),_=["default","acceptEdits","plan"],r=async()=>{if(!a.value)return;if(i.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(f){console.error("Failed to cycle permission mode:",f)}return}const b=(_.indexOf(i.value)+1)%_.length,v=_[b];try{await s.setPermissionMode(e.sessionId,v)}catch(f){console.error("Failed to cycle permission mode:",f)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:a.value})},p=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(g,b)=>(u(),m("div",Va,[t("div",Ha,[t("div",Wa,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:r,disabled:!a.value},[X(S(c.value)+" ",1),t("span",Ua,S(d.value),1)],8,Fa),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!a.value},[...b[0]||(b[0]=[X(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,Ba),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!a.value},[...b[1]||(b[1]=[X(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,qa)]),t("div",null,[t("button",{class:K(["btn btn-sm",Qt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:p}," â¬‡ï¸ "+S(Qt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Ka=z(za,[["__scopeId","data-v-fdcd3535"]]),De=$t("message",()=>{const n=M(new Map),e=M(new Map),s=M(new Map),o=M(new Map),a=M(new Map),i=M(new Map),l=M(new Map),c=y(()=>{const $=ae();return n.value.get($.currentSessionId)||[]}),d=y(()=>{const $=ae();return e.value.get($.currentSessionId)||[]});async function _($,C=null,A=0){try{const O=C||1e4,P=await se.get(`/api/sessions/${$}/messages?limit=${O}&offset=${A}`),V=P.messages||[],Y=P.total_count||V.length,le=P.has_more||!1;if(console.log(`Loaded ${V.length} of ${Y} messages for session ${$}`),n.value.set($,V),V.length>0){const te=V[V.length-1];te.timestamp&&(l.value.set($,te.timestamp),console.log(`Tracked last received timestamp for session ${$}: ${te.timestamp}`))}const U=new Set;V.forEach(te=>{te.type==="assistant"&&te.metadata?.tool_uses&&te.metadata.tool_uses.forEach(q=>{U.add(q.id)}),te.type==="user"&&te.metadata?.tool_results&&te.metadata.tool_results.forEach(q=>{U.delete(q.tool_use_id);const ue=i.value.get($);ue&&ue.delete(q.tool_use_id)}),te.type==="system"&&te.metadata?.subtype==="client_launched"&&(U.forEach(q=>{T($,q,"Session was restarted")}),U.clear()),te.type==="system"&&te.metadata?.subtype==="interrupt"&&(U.forEach(q=>{T($,q,"Session was interrupted")}),U.clear()),te.metadata?.has_tool_uses&&te.metadata.tool_uses&&te.metadata.tool_uses.forEach(q=>{g($,q)}),te.metadata?.has_tool_results&&te.metadata.tool_results&&te.metadata.tool_results.forEach(q=>{f($,q)}),(te.type==="permission_request"||te.metadata?.has_permission_requests)&&b($,te),te.type==="system"&&(te.subtype==="init"||te.metadata?.subtype==="init")&&te.metadata?.init_data&&ae().storeInitData($,te.metadata.init_data)});const ne=ae().sessions.get($);return ne&&!["active","paused","starting"].includes(ne.state)&&(U.forEach(te=>{T($,te,"Session was terminated")}),U.clear()),a.value.set($,U),n.value=new Map(n.value),le&&console.warn(`Warning: Only loaded ${V.length} of ${Y} messages. Some messages may be missing.`),{messages:V,totalCount:Y,hasMore:le}}catch(O){throw console.error("Failed to load messages:",O),O}}function r($,C){const A=a.value.get($)||new Set;C.type==="assistant"&&C.metadata?.tool_uses&&C.metadata.tool_uses.forEach(O=>{A.add(O.id)}),C.type==="user"&&C.metadata?.tool_results&&C.metadata.tool_results.forEach(O=>{A.delete(O.tool_use_id);const P=i.value.get($);P&&P.delete(O.tool_use_id)}),C.type==="system"&&C.metadata?.subtype==="client_launched"&&(A.forEach(O=>{T($,O,"Session was restarted")}),A.clear()),C.type==="system"&&C.metadata?.subtype==="interrupt"&&(A.forEach(O=>{T($,O,"Session was interrupted")}),A.clear()),a.value.set($,A)}function w($,C){n.value.has($)||n.value.set($,[]);const A=n.value.get($);if(C.id){const O=A.findIndex(P=>P.id===C.id);if(O!==-1){console.log(`Skipping duplicate message ${C.id} (already exists at index ${O})`);return}}A.push(C),C.timestamp&&l.value.set($,C.timestamp),r($,C),n.value=new Map(n.value)}function h($,C){e.value.has($)||e.value.set($,[]),e.value.get($).push(C),e.value=new Map(e.value)}function p($,C,A){const O=e.value.get($);if(O){const P=O.find(V=>V.id===C);P&&(Object.assign(P,A),e.value=new Map(e.value))}}function g($,C){const A=k(C.name,C.input);s.value.set(A,C.id);const O={id:C.id,name:C.name,input:C.input,signature:A,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return h($,O),console.log(`Created tool call ${O.id} for ${O.name}`),O}function b($,C){console.log("handlePermissionRequest received:",C);const A=C.metadata?.tool_name||C.tool_name,O=C.metadata?.input_params||C.input_params,P=C.metadata?.request_id||C.request_id,V=C.metadata?.suggestions||C.suggestions||[];console.log("Extracted data:",{toolName:A,inputParams:O,requestId:P,suggestions:V});const Y=k(A,O),le=s.value.get(Y);le?(o.value.set(P,le),p($,le,{status:"permission_required",permissionRequestId:P,suggestions:V}),console.log(`Permission required for tool ${le}`,{suggestions:V})):console.warn("No tool use ID found for permission request signature:",Y,{toolName:A,inputParams:O,availableSignatures:Array.from(s.value.keys())})}function v($,C){const A=o.value.get(C.request_id);if(A){const O={permissionDecision:C.decision,appliedUpdates:C.applied_updates||[]};C.decision==="allow"?O.status="executing":(O.status="completed",O.result={error:!0,message:C.reasoning||"Permission denied"},O.isExpanded=!1),p($,A,O),console.log(`Permission ${C.decision} for tool ${A}`)}}function f($,C){const A=C.tool_use_id;p($,A,{status:C.is_error?"error":"completed",result:{error:C.is_error,content:C.content},isExpanded:!1}),console.log(`Tool ${A} ${C.is_error?"failed":"completed"}`)}function E($,C){const A=e.value.get($);if(A){const O=A.find(P=>P.id===C);O&&(O.isExpanded=!O.isExpanded,e.value=new Map(e.value))}}function k($,C){if(!$)return"unknown:{}";if(!C||typeof C!="object")return`${$}:{}`;const A=JSON.stringify(C,Object.keys(C).sort());return`${$}:${A}`}function T($,C,A){const O=i.value.get($)||new Map;O.set(C,{reason:"denied",message:A}),i.value.set($,O);const P=e.value.get($);if(P){const V=P.find(Y=>Y.id===C);V&&V.isExpanded&&(V.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${C} as orphaned: ${A}`)}function L($,C){return i.value.get($)?.has(C)||!1}function I($,C){return i.value.get($)?.get(C)}function x($,C){const A=a.value.get($);A&&A.size>0&&(A.forEach(O=>T($,O,C)),A.clear())}function D($){n.value.delete($),e.value.delete($),n.value=new Map(n.value),e.value=new Map(e.value)}function B($){return l.value.get($)}async function Q($){const C=l.value.get($);if(!C)return console.log(`No sync needed for session ${$} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${$} since ${C}`);const A=await se.get(`/api/sessions/${$}/messages?limit=1000&offset=0`),O=A.messages||[],P=A.has_more||!1,V=q=>q?typeof q=="number"?q*1e3:new Date(q).getTime():0,Y=V(C),le=O.filter(q=>q.timestamp?V(q.timestamp)>Y:!1);if(le.length===0)return console.log(`No missed messages for session ${$}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${le.length} missed messages for session ${$}`);const U=n.value.get($)||[],W=new Set(U.map(q=>q.id).filter(Boolean)),ne=le.filter(q=>!q.id||!W.has(q.id));if(console.log(`After deduplication: ${ne.length} unique new messages`),ne.length>0){const q=ne.sort((Z,ee)=>{const _e=V(Z.timestamp),kt=V(ee.timestamp);return _e-kt}),ue=n.value.get($)||[],H=ue.length>0?V(ue[ue.length-1].timestamp):0,F=V(q[0].timestamp),G=V(q[q.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ue.length,lastExisting:H,lastExistingDate:ue.length>0?ue[ue.length-1].timestamp:"none",firstNew:F,firstNewDate:q[0].timestamp,lastNew:G,lastNewDate:q[q.length-1].timestamp,shouldAppend:F>H}),F>H){const Z=[...ue,...q];n.value.set($,Z),console.log(`âœ… Appended ${q.length} new messages (no full sort needed)`)}else{const Z=[...ue,...q].sort((ee,_e)=>{const kt=V(ee.timestamp),Ht=V(_e.timestamp);return kt-Ht});n.value.set($,Z),console.log(`âš ï¸ Merged and sorted ${q.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${U.length} messages unchanged`);ne.forEach(q=>{r($,q),q.metadata?.has_tool_uses&&q.metadata.tool_uses&&q.metadata.tool_uses.forEach(ue=>{g($,ue)}),q.metadata?.has_tool_results&&q.metadata.tool_results&&q.metadata.tool_results.forEach(ue=>{f($,ue)}),(q.type==="permission_request"||q.metadata?.has_permission_requests)&&b($,q),q.type==="system"&&(q.subtype==="init"||q.metadata?.subtype==="init")&&q.metadata?.init_data&&ae().storeInitData($,q.metadata.init_data)});const te=n.value.get($);if(te&&te.length>0){const q=te[te.length-1];q.timestamp&&l.value.set($,q.timestamp)}return n.value=new Map(n.value),{syncedCount:ne.length,hasMore:P}}catch(A){return console.error(`Failed to sync messages for session ${$}:`,A),{syncedCount:0,hasMore:!1,error:A.message}}}const R=ae();return ce(()=>Array.from(R.sessions.values()).map(C=>({id:C.session_id,state:C.state})),($,C)=>{C&&$.forEach((A,O)=>{const P=C[O];if(!P||P.id!==A.id)return;const V=["active","paused","starting"].includes(P.state),Y=!["active","paused","starting"].includes(A.state);V&&Y&&x(A.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:vn(a),orphanedToolUses:vn(i),currentMessages:c,currentToolCalls:d,loadMessages:_,addMessage:w,addToolCall:h,updateToolCall:p,handleToolUse:g,handlePermissionRequest:b,handlePermissionResponse:v,handleToolResult:f,toggleToolExpansion:E,clearMessages:D,markToolUseOrphaned:T,isToolUseOrphaned:L,getOrphanedInfo:I,clearOrphanedToolUses:x,getLastReceivedTimestamp:B,syncMessages:Q}}),Ga=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:De},Symbol.toStringTag,{value:"Module"}));function Ya(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Lt(n){return Ya(n).toLocaleTimeString()}const Ja={class:"message-row message-row-user"},Xa=["title"],Qa={class:"message-content-column"},Za=["innerHTML"],ei={key:0,class:"tool-results mt-2"},ti={class:"tool-results-header text-muted small mb-2"},si={class:"d-flex align-items-start gap-2"},ni={class:"flex-grow-1"},oi={class:"text-muted"},ai={key:0,class:"text-danger small"},ii={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;nt.setOptions({breaks:!0,gfm:!0});const s=y(()=>Lt(e.message.timestamp)),o=y(()=>`user
${s.value}`),a=y(()=>{const d=e.message.content||"";let _=nt.parse(d);return _=_.replace(/\n</g,"<"),_=_.replace(/\n+$/,""),os.sanitize(_)}),i=y(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=y(()=>e.message.metadata?.tool_results||[]);function c(d,_){return d?d.length<=_?d:d.substring(0,_)+"...":""}return(d,_)=>(u(),m("div",Ja,[t("div",{class:"message-speaker",title:o.value},[..._[0]||(_[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,Xa),t("div",Qa,[t("div",{class:"message-text",innerHTML:a.value},null,8,Za),i.value?(u(),m("div",ei,[t("div",ti," ðŸ”§ Tool Results ("+S(l.value.length)+") ",1),(u(!0),m(ie,null,de(l.value,(r,w)=>(u(),m("div",{key:w,class:K(["tool-result-summary p-2 mb-2 rounded",r.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",si,[t("span",null,S(r.is_error?"âŒ":"âœ…"),1),t("div",ni,[t("small",oi,"Tool: "+S(r.tool_use_id),1),r.is_error?(u(),m("div",ai,S(c(r.content,200)),1)):N("",!0)])])],2))),128))])):N("",!0)])]))}},li=z(ii,[["__scopeId","data-v-7665755b"]]),ri={class:"thinking-block"},ci=["aria-label"],di={class:"text-muted ms-auto"},ui={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},mi=["innerHTML"],pi={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=M(!1),o=y(()=>e.thinking?.length||0),a=y(()=>{const l=e.thinking||"",c=nt.parse(l);return os.sanitize(c)});function i(){s.value=!s.value}return(l,c)=>(u(),m("div",ri,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:i},[t("span",{"aria-label":s.value?"Collapse":"Expand"},S(s.value?"â–¾":"â–¸"),9,ci),c[0]||(c[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",di,S(o.value)+" characters",1)]),s.value?(u(),m("div",ui,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,mi)])):N("",!0)]))}},fi=z(pi,[["__scopeId","data-v-fda2352c"]]),je=$t("websocket",()=>{const n=M(null),e=M(!1),s=M(0),o=10,a=M(null),i=M(!1),l=M(0),c=5,d=M(null);let _=null;const r=M(0),w=M(null),h=M(new Map),p=M(null),g=M(!1),b=M(0),v=5,f=M(null),E=1e4,k=1e3,T=M(Date.now()),L=M(Date.now()),I=M(Date.now());let x=null,D=null,B=null;const Q=y(()=>e.value&&(i.value||!d.value)?"connected":e.value?"partial":"disconnected");function R(H){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${H}`}function $(H){const F={ui:{timer:()=>x,setTimer:G=>{x=G},lastPing:T,connected:e,name:"UI"},session:{timer:()=>D,setTimer:G=>{D=G},lastPing:L,connected:i,name:"Session"},legion:{timer:()=>B,setTimer:G=>{B=G},lastPing:I,connected:g,name:"Legion"}}[H];F.timer()&&clearInterval(F.timer()),F.setTimer(setInterval(()=>{if(!F.connected.value)return;const G=Date.now()-F.lastPing.value;if(G>E){console.warn(`âš ï¸ ${F.name} WebSocket heartbeat timeout (${G}ms since last ping) - forcing close to trigger reconnection`),F.connected.value=!1;const ee={ui:n,session:a,legion:p}[H];ee.value&&ee.value.readyState===WebSocket.OPEN&&ee.value.close()}},k)),console.log(`âœ… Started heartbeat monitor for ${F.name} WebSocket`)}function C(H){const F={ui:{get:()=>x,set:G=>{x=G}},session:{get:()=>D,set:G=>{D=G}},legion:{get:()=>B,set:G=>{B=G}}}[H];F.get()&&(clearInterval(F.get()),F.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${H} WebSocket`))}function A(){if(n.value)return;const H=R("/ws/ui");console.log(`Connecting to UI WebSocket: ${H}`),n.value=new WebSocket(H),n.value.onopen=()=>{e.value=!0,s.value=0,T.value=Date.now(),$("ui"),console.log("UI WebSocket connected")},n.value.onmessage=F=>{const G=JSON.parse(F.data);W(G)},n.value.onclose=()=>{if(C("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const F=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${F}ms (attempt ${s.value})`),setTimeout(A,F)}},n.value.onerror=F=>{console.error("UI WebSocket error:",F)}}function O(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function P(H){r.value++;const F=r.value;if(console.log(`[Gen ${F}] Starting connection to session ${H}`),_&&(clearTimeout(_),_=null),await V(),r.value!==F){console.log(`[Gen ${F}] Connection cancelled (current generation: ${r.value})`);return}d.value=H,w.value=F;const G=R(`/ws/session/${H}`);console.log(`[Gen ${F}] Connecting to Session WebSocket: ${G}`),a.value=new WebSocket(G),a.value.onopen=async()=>{if(w.value!==F){console.log(`[Gen ${F}] Ignoring onopen (stale connection, current: ${w.value})`),a.value.close();return}i.value=!0,l.value=0,L.value=Date.now(),$("session"),console.log(`[Gen ${F}] Session WebSocket connected for ${H}`);const Z=h.value.get(H);if(h.value.set(H,!0),Z){console.log(`[Gen ${F}] Reconnection detected, syncing missed messages...`);try{const _e=await De().syncMessages(H);_e.syncedCount>0?console.log(`[Gen ${F}] âœ… Synced ${_e.syncedCount} missed messages`):_e.error?console.warn(`[Gen ${F}] âš ï¸ Message sync failed: ${_e.error}`):console.log(`[Gen ${F}] No missed messages to sync`),_e.hasMore&&console.warn(`[Gen ${F}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ee){console.error(`[Gen ${F}] Error during message sync:`,ee)}}else console.log(`[Gen ${F}] Initial connection, no sync needed`)},a.value.onmessage=Z=>{if(w.value!==F){console.log(`[Gen ${F}] Ignoring message (stale connection, current: ${w.value})`);return}const ee=JSON.parse(Z.data);ne(ee,H)},a.value.onclose=()=>{C("session"),i.value=!1,a.value=null,console.log(`[Gen ${F}] Session WebSocket closed for ${H}`);const Z=ae();if(Z.currentSessionId===H&&w.value===F&&l.value<c){l.value++;const ee=Math.min(2e3*l.value,3e4);console.log(`[Gen ${F}] Reconnecting Session WebSocket in ${ee}ms (attempt ${l.value})`),_=setTimeout(()=>{w.value===F&&Z.currentSessionId===H?(_=null,P(H)):console.log(`[Gen ${F}] Skipping reconnect (generation or session changed)`)},ee)}},a.value.onerror=Z=>{console.error(`[Gen ${F}] Session WebSocket error:`,Z)}}function V(){return new Promise(H=>{if(_&&(clearTimeout(_),_=null,console.log("Cancelled pending session reconnect timer")),a.value){const F=d.value,G=()=>{a.value=null,i.value=!1,d.value=null,w.value=null,l.value=0,F&&h.value.delete(F),H()};if(a.value.readyState===WebSocket.CLOSED)G();else{const Z=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),G()},2e3);a.value.addEventListener("close",()=>{clearTimeout(Z),G()},{once:!0}),a.value.close()}}else d.value=null,w.value=null,H()})}function Y(H){a.value&&i.value?(a.value.send(JSON.stringify({type:"send_message",content:H})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function le(H,F,G=!1,Z=null){if(a.value&&i.value){const ee={type:"permission_response",request_id:H,decision:F,apply_suggestions:G,timestamp:new Date().toISOString()};Z&&(ee.clarification_message=Z),a.value.send(JSON.stringify(ee)),console.log(`Sent permission ${F} for request ${H}`,{applySuggestions:G,clarification:Z})}}function U(){a.value&&i.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function W(H){const F=ae(),G=ge();switch(H.type){case"sessions_list":H.sessions&&Array.isArray(H.sessions)&&H.sessions.forEach(Z=>{F.updateSession(Z.session_id,Z)});break;case"state_change":H.data&&H.data.session_id&&H.data.session&&F.updateSession(H.data.session_id,H.data.session);break;case"project_updated":if(H.data&&H.data.project){const Z=H.data.project;G.updateProjectLocal(Z.project_id,Z)}break;case"project_deleted":H.data&&H.data.project_id&&G.projects.delete(H.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":T.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",H.type)}}function ne(H,F){const G=ae();if(G.currentSessionId!==F){console.warn(`Ignoring message for session ${F} (current: ${G.currentSessionId})`);return}const Z=De();switch(H.type){case"message":const ee=H.data;if(!ee||!ee.type){console.warn("Received message event with invalid data:",H);break}if(ee.type==="permission_request"){Z.handlePermissionRequest(F,ee);break}if(ee.type==="permission_response"){Z.handlePermissionResponse(F,ee);break}ee.metadata?.has_tool_uses&&ee.metadata.tool_uses.forEach(_e=>{Z.handleToolUse(F,_e)}),ee.metadata?.has_tool_results&&ee.metadata.tool_results.forEach(_e=>{Z.handleToolResult(F,_e)}),ee.type==="system"&&(ee.subtype==="init"||ee.metadata?.subtype==="init")&&ee.metadata?.init_data&&G.storeInitData(F,ee.metadata.init_data),Z.addMessage(F,ee);break;case"permission_request":Z.handlePermissionRequest(F,H);break;case"permission_response":Z.handlePermissionResponse(F,H);break;case"tool_result":Z.handleToolResult(F,H);break;case"state_change":G.updateSession(F,H.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${F}`);break;case"ping":L.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function te(H){q(),f.value=H;const F=R(`/ws/legion/${H}`);console.log(`Connecting to Legion WebSocket: ${F}`),p.value=new WebSocket(F),p.value.onopen=()=>{g.value=!0,b.value=0,I.value=Date.now(),$("legion"),console.log(`Legion WebSocket connected for ${H}`)},p.value.onmessage=G=>{const Z=JSON.parse(G.data);ue(Z,H)},p.value.onclose=()=>{if(C("legion"),g.value=!1,p.value=null,console.log(`Legion WebSocket closed for ${H}`),f.value===H&&b.value<v){b.value++;const G=Math.min(2e3*b.value,3e4);setTimeout(()=>te(H),G)}},p.value.onerror=G=>{console.error("Legion WebSocket error:",G)}}function q(){p.value&&(p.value.close(),p.value=null,g.value=!1,f.value=null)}function ue(H,F){ye(async()=>{const{useLegionStore:G}=await Promise.resolve().then(()=>r_);return{useLegionStore:G}},void 0).then(({useLegionStore:G})=>{const Z=G();switch(H.type){case"comm":H.comm&&(Z.addComm(F,H.comm),console.log("Legion WebSocket: Received new comm",H.comm));break;case"minion_created":H.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",H.data),ye(async()=>{const{useSessionStore:ee}=await Promise.resolve().then(()=>_n);return{useSessionStore:ee}},void 0).then(({useSessionStore:ee})=>{ee().loadSessions()}));break;case"minion_updated":H.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",H.data),ye(async()=>{const{useSessionStore:ee}=await Promise.resolve().then(()=>_n);return{useSessionStore:ee}},void 0).then(({useSessionStore:ee})=>{ee().loadSessions()}));break;case"channel_created":H.channel&&(console.log("Legion WebSocket: Channel created, updating list",H.channel),Z.addChannel(F,H.channel));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${F}`);break;case"ping":I.value=Date.now(),p.value?.readyState===WebSocket.OPEN&&p.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",H.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:i,sessionRetryCount:l,legionConnected:g,legionRetryCount:b,overallStatus:Q,connectUI:A,disconnectUI:O,connectSession:P,disconnectSession:V,sendMessage:Y,sendPermissionResponse:le,interruptSession:U,connectLegion:te,disconnectLegion:q}}),vi=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:je},Symbol.toStringTag,{value:"Module"})),hi={class:"base-tool-handler"},_i={class:"tool-section"},gi={class:"tool-parameters"},bi={class:"tool-code"},yi={key:0,class:"tool-section"},$i={class:"tool-section-label"},wi={class:"tool-code"},Ci={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=y(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,c)=>(u(),m("div",hi,[t("div",_i,[c[0]||(c[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",gi,[t("pre",bi,S(s.value),1)])]),o.value?(u(),m("div",yi,[t("div",$i,S(a.value?"Error:":"Result:"),1),t("div",{class:K(["tool-result",{"tool-result-error":a.value}])},[t("pre",wi,S(i.value),1)],2)])):N("",!0)]))}},Ei=z(Ci,[["__scopeId","data-v-1e69f57d"]]),Si={class:"read-tool-handler"},ki={class:"tool-section"},Ti={class:"read-file-info"},xi={class:"file-path"},Mi={key:0,class:"read-range"},Ai={key:0,class:"tool-section"},Oi={key:0,class:"tool-result tool-result-error"},Di={class:"tool-code"},Ni={key:1,class:"file-content-preview"},Li={class:"content-header"},Ii={class:"line-count-badge"},Pi={key:0,class:"preview-note"},ji={class:"tool-code content-display"},Ri={key:0,class:"more-indicator"},vs=100,Vi={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>{const p=e.toolCall.input?.offset,g=e.toolCall.input?.limit;return p!==void 0||g!==void 0}),a=y(()=>{const p=e.toolCall.input?.offset;return p!==void 0?p+1:1}),i=y(()=>{const p=e.toolCall.input?.offset||0,g=e.toolCall.input?.limit;return g!==void 0?p+g:"âˆž"}),l=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=y(()=>{if(!l.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),_=y(()=>c.value||!d.value?[]:d.value.split(`
`)),r=y(()=>_.value.length),w=y(()=>r.value>vs),h=y(()=>c.value?"":_.value.slice(0,vs).join(`
`));return(p,g)=>(u(),m("div",Si,[t("div",ki,[t("div",Ti,[g[0]||(g[0]=t("span",{class:"file-icon"},"ðŸ“„",-1)),g[1]||(g[1]=t("strong",null,"Reading:",-1)),t("code",xi,S(s.value),1),o.value?(u(),m("span",Mi,"Lines "+S(a.value)+"-"+S(i.value),1)):N("",!0)])]),l.value?(u(),m("div",Ai,[c.value?(u(),m("div",Oi,[t("pre",Di,S(d.value),1)])):(u(),m("div",Ni,[t("div",Li,[g[2]||(g[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Ii,S(r.value)+" lines",1),w.value?(u(),m("span",Pi,"(showing first "+S(vs)+")")):N("",!0)]),t("pre",ji,S(h.value),1),w.value?(u(),m("div",Ri,"...")):N("",!0)]))])):N("",!0)]))}},Hi=z(Vi,[["__scopeId","data-v-1f2b0569"]]),Wi={class:"write-tool-handler"},Fi={class:"tool-section"},Ui={class:"write-file-info mb-2"},Bi={class:"file-path"},qi={class:"write-content-preview"},zi={class:"content-header"},Ki={class:"line-count-badge"},Gi={key:0,class:"preview-note"},Yi={class:"tool-code content-display"},Ji={key:0,class:"more-indicator"},Xi={key:0,class:"tool-section"},Qi={key:0,class:"tool-result tool-result-error"},Zi={class:"tool-code"},el={key:1,class:"tool-result tool-result-success"},tl={class:"success-message"},hs=100,sl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>e.toolCall.input?.content||""),a=y(()=>o.value.split(`
`)),i=y(()=>a.value.length),l=y(()=>i.value>hs),c=y(()=>a.value.slice(0,hs).join(`
`)),d=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),_=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=y(()=>{if(!d.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,h)=>(u(),m("div",Wi,[t("div",Fi,[t("div",Ui,[h[0]||(h[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",Bi,S(s.value),1)]),t("div",qi,[t("div",zi,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Ki,S(i.value)+" lines",1),l.value?(u(),m("span",Gi,"(showing first "+S(hs)+")")):N("",!0)]),t("pre",Yi,S(c.value),1),l.value?(u(),m("div",Ji,"...")):N("",!0)])]),d.value?(u(),m("div",Xi,[_.value?(u(),m("div",Qi,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",Zi,S(r.value),1)])):(u(),m("div",el,[t("div",tl,[h[4]||(h[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+S(i.value)+" lines written)",1)])]))])):N("",!0)]))}},nl=z(sl,[["__scopeId","data-v-ddc24a0f"]]),ol={class:"bash-tool-handler"},al={class:"tool-section"},il={class:"bash-header"},ll={class:"bash-header-content"},rl={key:0,class:"bash-description"},cl={key:1,class:"bash-flags"},dl={class:"bash-command-section"},ul={class:"bash-command-content"},ml={key:0,class:"tool-section"},pl={key:0,class:"bash-output"},fl={key:1,class:"bash-output-empty"},vl={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?.command||""),o=y(()=>e.toolCall.input?.description||""),a=y(()=>e.toolCall.input?.timeout),i=y(()=>e.toolCall.input?.run_in_background||!1),l=y(()=>a.value||i.value),c=y(()=>{const h=[];return a.value&&h.push(`timeout: ${a.value}ms`),i.value&&h.push("background"),h.join(", ")}),d=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),_=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=y(()=>_.value?"tool-result-error":"tool-result-success"),w=y(()=>{if(!d.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,p)=>(u(),m("div",ol,[t("div",al,[t("div",il,[p[1]||(p[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",ll,[o.value?(u(),m("div",rl,[p[0]||(p[0]=t("strong",null,"Description:",-1)),X(" "+S(o.value),1)])):N("",!0),l.value?(u(),m("div",cl,S(c.value),1)):N("",!0)])]),t("div",dl,[p[2]||(p[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",ul,S(s.value),1)])]),d.value?(u(),m("div",ml,[t("div",{class:K(["tool-result",r.value])},[p[3]||(p[3]=t("strong",null,"Output:",-1)),w.value?(u(),m("pre",pl,S(w.value),1)):(u(),m("div",fl,"No output"))],2)])):N("",!0)]))}},hl=z(vl,[["__scopeId","data-v-ab50fe73"]]),_l={class:"todo-tool-handler"},gl={class:"tool-section"},bl={class:"todo-header"},yl={class:"todo-summary"},$l={key:0,class:"todo-count todo-count-completed"},wl={key:1,class:"todo-count todo-count-in-progress"},Cl={key:2,class:"todo-count todo-count-pending"},El={class:"todo-checklist"},Sl={class:"todo-checkbox"},kl={class:"todo-content"},Tl={key:0,class:"tool-section"},xl={key:0,class:"tool-result tool-result-error"},Ml={class:"tool-code"},Al={key:1,class:"tool-result tool-result-success"},Ol={class:"success-message"},Dl={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?.todos||[]),o=y(()=>s.value.filter(r=>r.status==="completed").length),a=y(()=>s.value.filter(r=>r.status==="in_progress").length),i=y(()=>s.value.filter(r=>r.status==="pending").length);function l(r){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[r]||"â˜"}const c=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=y(()=>{if(!c.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,w)=>(u(),m("div",_l,[t("div",gl,[t("div",bl,[w[0]||(w[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=t("strong",null,"Task List:",-1)),t("div",yl,[o.value>0?(u(),m("span",$l,S(o.value)+" completed ",1)):N("",!0),a.value>0?(u(),m("span",wl,S(a.value)+" in progress ",1)):N("",!0),i.value>0?(u(),m("span",Cl,S(i.value)+" pending ",1)):N("",!0)])]),t("div",El,[(u(!0),m(ie,null,de(s.value,(h,p)=>(u(),m("div",{key:p,class:K(["todo-item",`todo-${h.status}`])},[t("span",Sl,S(l(h.status)),1),t("span",kl,S(h.content),1)],2))),128))])]),c.value?(u(),m("div",Tl,[d.value?(u(),m("div",xl,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",Ml,S(_.value),1)])):(u(),m("div",Al,[t("div",Ol,[w[3]||(w[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+S(s.value.length)+" tasks)",1)])]))])):N("",!0)]))}},Nl=z(Dl,[["__scopeId","data-v-bbe55ee7"]]),Ll={class:"edit-tool-handler"},Il={class:"tool-section"},Pl={class:"edit-file-info"},jl={class:"file-path"},Rl={key:0,class:"replace-all-badge"},Vl={class:"edit-diff-container"},Hl={class:"diff-header"},Wl={class:"diff-stats"},Fl={class:"stat-removed"},Ul={class:"stat-added"},Bl={class:"unified-diff"},ql={class:"diff-scroll-container"},zl={class:"diff-marker"},Kl={class:"diff-content"},Gl={key:0,class:"tool-section"},Yl={key:0,class:"tool-result tool-result-error"},Jl={class:"tool-code"},Xl={key:1,class:"tool-result tool-result-success"},Ql={class:"success-message"},Zl={key:0,class:"success-detail"},er={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>e.toolCall.input?.old_string||""),a=y(()=>e.toolCall.input?.new_string||""),i=y(()=>e.toolCall.input?.replace_all||!1),l=y(()=>{const p=ya(s.value,o.value,a.value,"","",{context:3}).split(`
`),g=[];for(let b=4;b<p.length;b++){const v=p[b];v&&(v.startsWith("-")?g.push({type:"removed",content:v.substring(1)}):v.startsWith("+")?g.push({type:"added",content:v.substring(1)}):v.startsWith(" ")?g.push({type:"context",content:v.substring(1)}):v.startsWith("@@")&&g.push({type:"hunk",content:v}))}return g}),c=y(()=>l.value.filter(h=>h.type==="removed").length),d=y(()=>l.value.filter(h=>h.type==="added").length),_=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=y(()=>{if(!_.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,p)=>(u(),m("div",Ll,[t("div",Il,[t("div",Pl,[p[0]||(p[0]=t("span",{class:"file-icon"},"âœï¸",-1)),p[1]||(p[1]=t("strong",null,"Editing:",-1)),t("code",jl,S(s.value),1),i.value?(u(),m("span",Rl,"Replace All")):N("",!0)]),t("div",Vl,[t("div",Hl,[p[2]||(p[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Wl,[t("span",Fl,"-"+S(c.value),1),t("span",Ul,"+"+S(d.value),1)])]),t("div",Bl,[t("div",ql,[(u(!0),m(ie,null,de(l.value,(g,b)=>(u(),m("div",{key:b,class:K(["diff-line",{"diff-line-removed":g.type==="removed","diff-line-added":g.type==="added","diff-line-context":g.type==="context","diff-line-hunk":g.type==="hunk"}])},[t("span",zl,S(g.type==="removed"?"-":g.type==="added"?"+":g.type==="hunk"?"@":" "),1),t("span",Kl,S(g.content),1)],2))),128))])])])]),_.value?(u(),m("div",Gl,[r.value?(u(),m("div",Yl,[p[3]||(p[3]=t("strong",null,"Error:",-1)),t("pre",Jl,S(w.value),1)])):(u(),m("div",Xl,[t("div",Ql,[p[4]||(p[4]=t("span",{class:"success-icon"},"âœ…",-1)),p[5]||(p[5]=t("strong",null,"File edited successfully",-1)),i.value?(u(),m("span",Zl,"(all occurrences replaced)")):N("",!0)])]))])):N("",!0)]))}},tr=z(er,[["__scopeId","data-v-dd74055e"]]),sr={class:"search-tool-handler"},nr={class:"tool-section"},or={class:"search-info"},ar={class:"search-icon"},ir={class:"search-pattern"},lr={key:0,class:"search-path"},rr={key:1,class:"search-filters"},cr={key:0,class:"filter-badge"},dr={key:1,class:"filter-badge"},ur={key:2,class:"filter-badge"},mr={key:0,class:"tool-section"},pr={key:0,class:"tool-result tool-result-error"},fr={class:"tool-code"},vr={key:1,class:"search-results"},hr={class:"results-header"},_r={class:"results-label"},gr={class:"results-count-badge"},br={class:"results-content"},yr={class:"tool-code"},$r={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.name==="Grep");y(()=>e.toolCall.name==="Glob");const o=y(()=>e.toolCall.input?.pattern||"Unknown"),a=y(()=>e.toolCall.input?.path||null),i=y(()=>e.toolCall.input?.type||null),l=y(()=>e.toolCall.input?.glob||null),c=y(()=>e.toolCall.input?.["-i"]||!1),d=y(()=>i.value||l.value||c.value),_=y(()=>s.value?"ðŸ”":"ðŸ“"),r=y(()=>s.value?"Searching content":"Finding files"),w=y(()=>s.value?"Matches":"Files found"),h=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=y(()=>{if(!h.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),b=y(()=>!h.value||p.value||!g.value?0:g.value.split(`
`).filter(f=>f.trim()).length);return(v,f)=>(u(),m("div",sr,[t("div",nr,[t("div",or,[t("span",ar,S(_.value),1),t("strong",null,S(r.value)+":",1),t("code",ir,S(o.value),1),a.value?(u(),m("span",lr,"in "+S(a.value),1)):N("",!0),d.value?(u(),m("span",rr,[i.value?(u(),m("span",cr,"type: "+S(i.value),1)):N("",!0),l.value?(u(),m("span",dr,"glob: "+S(l.value),1)):N("",!0),c.value?(u(),m("span",ur,"case-insensitive")):N("",!0)])):N("",!0)])]),h.value?(u(),m("div",mr,[p.value?(u(),m("div",pr,[f[0]||(f[0]=t("strong",null,"Error:",-1)),t("pre",fr,S(g.value),1)])):(u(),m("div",vr,[t("div",hr,[t("span",_r,S(w.value)+":",1),t("span",gr,S(b.value)+" "+S(b.value===1?"match":"matches"),1)]),t("div",br,[t("pre",yr,S(g.value),1)])]))])):N("",!0)]))}},gn=z($r,[["__scopeId","data-v-0d272c39"]]),wr={class:"web-tool-handler"},Cr={class:"tool-section"},Er={class:"web-info"},Sr={class:"web-icon"},kr=["href"],Tr={key:1,class:"web-query"},xr={key:0,class:"web-prompt-container"},Mr={class:"prompt-content"},Ar={key:1,class:"web-domains"},Or={class:"domains-label"},Dr={key:0,class:"tool-section"},Nr={key:0,class:"tool-result tool-result-error"},Lr={class:"tool-code"},Ir={key:1,class:"web-results"},Pr={class:"results-header"},jr={class:"results-label"},Rr={class:"results-content"},Vr={class:"tool-code"},Hr={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.name==="WebFetch");y(()=>e.toolCall.name==="WebSearch");const o=y(()=>e.toolCall.input?.url||null),a=y(()=>e.toolCall.input?.query||null),i=y(()=>e.toolCall.input?.prompt||null),l=y(()=>e.toolCall.input?.allowed_domains||[]),c=y(()=>e.toolCall.input?.blocked_domains||[]),d=y(()=>l.value.length>0?l.value:c.value.length>0?c.value:[]),_=y(()=>l.value.length>0?"Allowed domains":c.value.length>0?"Blocked domains":"Domains"),r=y(()=>s.value?"ðŸŒ":"ðŸ”Ž"),w=y(()=>s.value?"Fetching URL":"Searching web"),h=y(()=>s.value?"Fetched content":"Search results"),p=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),g=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=y(()=>{if(!p.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,f)=>(u(),m("div",wr,[t("div",Cr,[t("div",Er,[t("span",Sr,S(r.value),1),t("strong",null,S(w.value)+":",1),o.value?(u(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},S(o.value),9,kr)):a.value?(u(),m("code",Tr,S(a.value),1)):N("",!0)]),i.value?(u(),m("div",xr,[f[0]||(f[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Mr,S(i.value),1)])):N("",!0),d.value.length>0?(u(),m("div",Ar,[t("span",Or,S(_.value)+":",1),(u(!0),m(ie,null,de(d.value,E=>(u(),m("span",{key:E,class:"domain-badge"},S(E),1))),128))])):N("",!0)]),p.value?(u(),m("div",Dr,[g.value?(u(),m("div",Nr,[f[1]||(f[1]=t("strong",null,"Error:",-1)),t("pre",Lr,S(b.value),1)])):(u(),m("div",Ir,[t("div",Pr,[t("span",jr,S(h.value)+":",1)]),t("div",Rr,[t("pre",Vr,S(b.value),1)])]))])):N("",!0)]))}},bn=z(Hr,[["__scopeId","data-v-62b55b55"]]),Wr={class:"task-tool-handler"},Fr={class:"tool-section"},Ur={class:"task-header"},Br={key:0,class:"agent-type-badge"},qr={key:0,class:"task-description"},zr={class:"description-content"},Kr={key:1,class:"task-prompt-container"},Gr={class:"prompt-header"},Yr={class:"prompt-length"},Jr={class:"prompt-code"},Xr={key:0,class:"tool-section"},Qr={key:0,class:"tool-result tool-result-error"},Zr={class:"tool-code"},ec={key:1,class:"agent-output"},tc={class:"output-header"},sc={key:0,class:"output-count-badge"},nc={class:"output-content"},oc={class:"tool-code"},ac={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?.description||null),o=y(()=>e.toolCall.input?.prompt||null),a=y(()=>e.toolCall.input?.subagent_type||null),i=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=y(()=>{if(!i.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),d=y(()=>c.value?c.value.split(`
`).length:0);return(_,r)=>(u(),m("div",Wr,[t("div",Fr,[t("div",Ur,[r[0]||(r[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),r[1]||(r[1]=t("strong",null,"Agent Task:",-1)),a.value?(u(),m("span",Br,S(a.value),1)):N("",!0)]),s.value?(u(),m("div",qr,[r[2]||(r[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",zr,S(s.value),1)])):N("",!0),o.value?(u(),m("div",Kr,[t("div",Gr,[r[3]||(r[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Yr,S(o.value.length)+" characters",1)]),t("pre",Jr,S(o.value),1)])):N("",!0)]),i.value?(u(),m("div",Xr,[l.value?(u(),m("div",Qr,[r[4]||(r[4]=t("strong",null,"Error:",-1)),t("pre",Zr,S(c.value),1)])):(u(),m("div",ec,[t("div",tc,[r[5]||(r[5]=t("span",{class:"output-label"},"Agent Output:",-1)),d.value>0?(u(),m("span",sc,S(d.value)+" lines",1)):N("",!0)]),t("div",nc,[t("pre",oc,S(c.value),1)])]))])):N("",!0)]))}},ic=z(ac,[["__scopeId","data-v-c520c244"]]),lc={class:"notebook-edit-tool-handler"},rc={class:"tool-section"},cc={class:"notebook-info"},dc={class:"file-path"},uc={class:"cell-info mt-2"},mc={class:"info-row"},pc={class:"info-row"},fc={key:0,class:"info-row"},vc={class:"badge bg-info"},hc={key:0,class:"source-preview mt-3"},_c={class:"preview-header"},gc={class:"preview-stats"},bc={class:"source-code"},yc={key:0,class:"tool-section"},$c={key:0},wc={key:1,class:"text-danger"},Cc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?.notebook_path||"Unknown"),o=y(()=>e.toolCall.input?.cell_id),a=y(()=>e.toolCall.input?.cell_type||"code"),i=y(()=>e.toolCall.input?.edit_mode||"replace"),l=y(()=>e.toolCall.input?.new_source||""),c=y(()=>l.value.split(`
`).length),d=y(()=>a.value==="code"?"bg-primary":"bg-secondary"),_=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),r=y(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=i.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,h)=>(u(),m("div",lc,[t("div",rc,[t("div",cc,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",dc,S(s.value),1)]),t("div",uc,[t("div",mc,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,S(o.value||"N/A"),1)]),t("div",pc,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:K(["badge",d.value])},S(a.value),3)]),i.value?(u(),m("div",fc,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",vc,S(i.value),1)])):N("",!0)]),l.value?(u(),m("div",hc,[t("div",_c,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",gc,S(c.value)+" lines",1)]),t("pre",bc,[t("code",null,S(l.value),1)])])):N("",!0)]),n.toolCall.result?(u(),m("div",yc,[h[6]||(h[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:K(["tool-result",_.value])},[n.toolCall.result.success!==!1?(u(),m("div",$c," âœ… "+S(r.value),1)):(u(),m("div",wc," â— "+S(n.toolCall.result.error||"Operation failed"),1))],2)])):N("",!0)]))}},Ec=z(Cc,[["__scopeId","data-v-c81a9bcf"]]),Sc={class:"shell-tool-handler"},kc={class:"tool-section"},Tc={class:"shell-info"},xc={class:"shell-icon"},Mc={key:0,class:"shell-id"},Ac={key:0,class:"filter-info mt-2"},Oc={class:"filter-pattern"},Dc={key:0,class:"tool-section"},Nc={class:"result-header mb-2"},Lc={key:0,class:"mb-2"},Ic={class:"shell-output"},Pc={key:1,class:"mb-2"},jc={class:"shell-output shell-output-error"},Rc={key:0},Vc={key:1,class:"text-danger"},Hc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=y(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=y(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),i=y(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=y(()=>e.toolCall.input?.filter);function c(p,g){if(!p)return null;const b=new RegExp(`<${g}>([\\s\\S]*?)<\\/${g}>`,"i"),v=p.match(b);return v?v[1].trim():null}const d=y(()=>{const p=e.toolCall.result;if(!p)return null;let g=p;if(p.content&&(g=p.content),typeof g=="string")return{status:c(g,"status"),stdout:c(g,"stdout"),stderr:c(g,"stderr"),exit_code:c(g,"exit_code")};if(Array.isArray(g)){const b=g.find(v=>v.type==="text")?.text||"";return{status:c(b,"status"),stdout:c(b,"stdout"),stderr:c(b,"stderr"),exit_code:c(b,"exit_code")}}return{status:p.status||g.status,stdout:p.stdout||p.output||g.stdout||g.output,stderr:p.stderr||g.stderr,exit_code:p.exit_code||g.exit_code}});y(()=>{if(e.toolCall.name==="BashOutput"){const p=d.value;if(!p)return null;const g=[];return p.stdout&&g.push(p.stdout),p.stderr&&g.push(`[stderr]
${p.stderr}`),g.length>0?g.join(`

`):null}return null});const _=y(()=>d.value?.status),r=y(()=>{const p=_.value;return p==="running"?"bg-success":p==="completed"?"bg-secondary":p==="killed"||p==="terminated"?"bg-danger":"bg-info"}),w=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=y(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const p=d.value;if(p?.status==="running"&&!p.stdout&&!p.stderr)return"No new output since last check";if(p?.status==="failed")return`Shell failed (exit code ${p.exit_code||"unknown"})`}return"Operation completed"});return(p,g)=>(u(),m("div",Sc,[t("div",kc,[t("div",Tc,[t("span",xc,S(s.value),1),t("strong",null,S(o.value)+":",1),i.value?(u(),m("code",Mc,"Shell "+S(i.value),1)):N("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(u(),m("div",Ac,[g[0]||(g[0]=t("strong",null,"Filter:",-1)),t("code",Oc,S(l.value),1)])):N("",!0)]),n.toolCall.result?(u(),m("div",Dc,[t("div",Nc,[t("strong",null,S(a.value)+":",1),_.value?(u(),m("span",{key:0,class:K(["badge",r.value])},S(_.value),3)):N("",!0)]),d.value?.stdout?(u(),m("div",Lc,[g[1]||(g[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Ic,[t("pre",null,[t("code",null,S(d.value.stdout),1)])])])):N("",!0),d.value?.stderr?(u(),m("div",Pc,[g[2]||(g[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",jc,[t("pre",null,[t("code",null,S(d.value.stderr),1)])])])):N("",!0),!d.value?.stdout&&!d.value?.stderr?(u(),m("div",{key:2,class:K(["tool-result",w.value])},[n.toolCall.result.success!==!1?(u(),m("div",Rc," âœ… "+S(h.value),1)):(u(),m("div",Vc," â— "+S(n.toolCall.result.error||"Operation failed"),1))],2)):N("",!0)])):N("",!0)]))}},yn=z(Hc,[["__scopeId","data-v-86def281"]]),Wc={class:"skill-tool-handler"},Fc={key:0,class:"tool-section"},Uc={class:"d-flex align-items-center gap-2"},Bc={class:"text-muted small"},qc={key:0,class:"skill-content-body"},zc={class:"skill-content-text"},Kc={key:1,class:"tool-section mt-3"},Gc={class:"tool-result tool-result-error"},Yc={class:"tool-code"},Jc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=De(),o=ae(),a=M(!1);function i(){a.value=!a.value}y(()=>e.toolCall.input?.command||"Unknown Skill"),y(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),y(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const l=y(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const p=s.messagesBySession.get(h)||[],g=p.findIndex(f=>f.type==="user"&&f.metadata?.has_tool_results&&f.metadata?.tool_results?.some(E=>E.tool_use_id===e.toolCall.id));if(g===-1)return{running:null,content:null};let b=null,v=null;for(let f=g+1;f<Math.min(g+3,p.length);f++){const E=p[f];if(E.type!=="user")continue;const k=E.content||"";k.includes("<command-message>")&&k.includes("skill is running")?b=E:k.startsWith("Base directory for this skill:")&&(v=E)}return{running:b,content:v}});y(()=>{const h=l.value.content;if(!h)return null;const g=(h.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return g&&g[1]?g[1].trim():null});const c=y(()=>{const h=l.value.content;if(!h)return"";const p=h.content||"",g=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return p.replace(g,"").trim()}),d=y(()=>c.value.length>0),_=y(()=>c.value?c.value.split(`
`).length:0),r=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=y(()=>{if(!r.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,p)=>(u(),m("div",Wc,[d.value?(u(),m("div",Fc,[t("div",{class:"skill-content-header",onClick:i},[t("div",Uc,[t("i",{class:K(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),p[0]||(p[0]=t("strong",null,"Skill Content",-1)),t("span",Bc,"("+S(_.value)+" lines)",1)])]),a.value?(u(),m("div",qc,[t("pre",zc,S(c.value),1)])):N("",!0)])):N("",!0),r.value?(u(),m("div",Kc,[p[1]||(p[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Gc,[t("pre",Yc,S(w.value),1)])])):N("",!0)]))}},Xc=z(Jc,[["__scopeId","data-v-0a48ca0f"]]),Qc={class:"slashcommand-tool-handler"},Zc={key:0,class:"tool-section"},ed={class:"d-flex align-items-center gap-2"},td=["aria-label"],sd={class:"text-muted small"},nd={key:0,class:"command-content-body"},od={class:"command-content-text"},ad={key:1,class:"tool-section mt-3"},id={class:"tool-result tool-result-error"},ld={class:"tool-code"},rd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=De(),o=ae(),a=M(!1);function i(){a.value=!a.value}y(()=>e.toolCall.input?.command||"Unknown Command"),y(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),y(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const l=y(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const p=s.messagesBySession.get(h)||[],g=p.findIndex(f=>f.type==="user"&&f.metadata?.has_tool_results&&f.metadata?.tool_results?.some(E=>E.tool_use_id===e.toolCall.id));if(g===-1)return{running:null,content:null};let b=null,v=null;for(let f=g+1;f<Math.min(g+3,p.length);f++){const E=p[f];if(E.type!=="user")continue;const k=E.content||"";k.includes("<command-message>")&&k.includes("<command-name>")&&k.includes("<command-args>")?b=E:k.includes("ARGUMENTS:")&&(v=E)}return{running:b,content:v}});y(()=>{const h=l.value.running;if(!h)return null;const g=(h.content||"").match(/<command-args>(.+?)<\/command-args>/s);return g&&g[1]?g[1].trim():null});const c=y(()=>{const h=l.value.content;if(!h)return"";const p=h.content||"",g=/\nARGUMENTS:.*$/s;return p.replace(g,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),d=y(()=>c.value.length>0),_=y(()=>c.value?c.value.split(`
`).length:0),r=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=y(()=>{if(!r.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,p)=>(u(),m("div",Qc,[d.value?(u(),m("div",Zc,[t("div",{class:"command-content-header",onClick:i},[t("div",ed,[t("span",{"aria-label":a.value?"Collapse":"Expand"},S(a.value?"â–¾":"â–¸"),9,td),p[0]||(p[0]=t("strong",null,"Command Content",-1)),t("span",sd,"("+S(_.value)+" lines)",1)])]),a.value?(u(),m("div",nd,[t("pre",od,S(c.value),1)])):N("",!0)])):N("",!0),r.value?(u(),m("div",ad,[p[1]||(p[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",id,[t("pre",ld,S(w.value),1)])])):N("",!0)]))}},cd=z(rd,[["__scopeId","data-v-15991acf"]]),dd={class:"exit-plan-mode-tool-handler"},ud={class:"tool-section"},md={key:0,class:"plan-content mt-2"},pd={class:"plan-text"},fd={key:0,class:"tool-section"},vd={key:0},hd={key:1,class:"text-danger"},_d={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>e.toolCall.input?.plan),o=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,i)=>(u(),m("div",dd,[t("div",ud,[i[1]||(i[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(u(),m("div",md,[i[0]||(i[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",pd,S(s.value),1)])):N("",!0)]),n.toolCall.result?(u(),m("div",fd,[i[2]||(i[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:K(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),m("div",vd," âœ… Permission mode reverted to default ")):(u(),m("div",hd," â— "+S(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):N("",!0)]))}},gd=z(_d,[["__scopeId","data-v-e2e3c781"]]),bd={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},yd={class:"tool-status-icon"},$d=["title"],wd={class:"d-flex align-items-center gap-2"},Cd={class:"text-muted"},Ed=["aria-label"],Sd={key:0,class:"card-body"},kd={key:0,class:"alert alert-warning mb-3"},Td={class:"d-flex align-items-center"},xd={class:"mb-0 small"},Md={key:1,class:"permission-prompt mt-3"},Ad={class:"alert alert-warning mb-3"},Od={class:"mb-0"},Dd={class:"tool-name"},Nd={key:0,class:"suggestions-section mb-3"},Ld={class:"alert alert-info mb-0"},Id={class:"suggestion-details p-2 bg-white rounded"},Pd={class:"permission-buttons d-flex gap-2 mb-3"},jd=["disabled"],Rd=["disabled"],Vd=["disabled"],Hd={class:"guidance-section mt-3"},Wd=["disabled"],Fd=["disabled"],Ud={key:2,class:"mt-3"},Bd={class:"alert alert-warning mb-0"},qd={class:"d-flex align-items-center"},zd={class:"mb-0 small"},Kd={key:3,class:"tool-section"},Gd={class:"alert alert-danger mb-0"},Yd={key:0},Jd={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=De(),o=ae(),a=je(),i=M(!1),l=M(null),c=M(""),d=y(()=>s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),_=y(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),r={Read:Hi,Write:nl,Bash:hl,TodoWrite:Nl,Edit:tr,Grep:gn,Glob:gn,WebFetch:bn,WebSearch:bn,Task:ic,NotebookEdit:Ec,BashOutput:yn,KillShell:yn,SlashCommand:cd,Skill:Xc,ExitPlanMode:gd},w=y(()=>{const R=e.toolCall.name;return r[R]?r[R]:Ei}),h=y(()=>{const R=[];switch(e.toolCall.status){case"pending":R.push("border-secondary");break;case"permission_required":R.push("border-warning");break;case"executing":R.push("border-primary");break;case"completed":b.value||e.toolCall.permissionDecision==="deny"?R.push("border-danger"):R.push("border-success");break;case"error":R.push("border-danger");break}return R.join(" ")}),p=y(()=>{switch(e.toolCall.status){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":b.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),g=y(()=>Lt(e.toolCall.timestamp)),b=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=y(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function f(R){if(!R)return"";const $=R.replace(/\\/g,"/").split("/");return $[$.length-1]}function E(R){if(!R)return"";const $=R.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return $?$[1]:R}function k(R,$=200){return R?R.length<=$?R:R.substring(0,$)+"...":""}function T(R){if(!R)return null;if(R.content){const $=R.content.match(/exit code (\d+)/i);if($)return parseInt($[1])}return R.error?1:0}function L(R,$){const C=R?R.split(`
`).length:0;return{added:$?$.split(`
`).length:0,removed:C}}const I=y(()=>{const R=e.toolCall.name,$=e.toolCall.input||{},C=e.toolCall.result,A=e.toolCall.status;switch(R){case"Bash":case"Shell":case"Command":{const O=E($.command),P=k(O,200);if(A==="completed"&&C){const V=T(C);return`Bash: ${P} (exit ${V})`}return`Bash: ${P}`}case"SlashCommand":{const O=k($.command,200);return A==="completed"&&C?`SlashCommand: ${O}`:`SlashCommand: ${O}`}case"Edit":{const O=f($.file_path);if(A==="completed"&&C&&!C.error){const{added:P,removed:V}=L($.old_string,$.new_string);return P===V?`Edit: ${O} (${P} lines changed)`:`Edit: ${O} (${P} lines added, ${V} removed)`}return`Edit: ${O}`}case"Read":{const O=f($.file_path);if($.offset!==void 0||$.limit!==void 0){const V=($.offset||0)+1,Y=$.limit?($.offset||0)+$.limit:"âˆž";return`Read: ${O} (lines ${V}-${Y})`}return`Read: ${O} (full file)`}case"Write":{const O=f($.file_path);if(A==="completed"&&C&&!C.error&&$.content){const P=$.content.split(`
`).length;return`Write: ${O} (${P} lines written)`}return`Write: ${O}`}case"Skill":{const O=$.skill||"Unknown";return A==="completed"&&C?C.error?`Skill: ${O} (error)`:`Skill: ${O} (completed)`:`Skill: ${O}`}case"Task":{const O=$.subagent_type||"general",P=$.description||"Task";return A==="completed"&&C?C.error?`Task: (${O}) ${P} (error)`:`Task: (${O}) ${P} (completed)`:`Task: (${O}) ${P}`}case"TodoWrite":{if($.todos&&Array.isArray($.todos)){const O=$.todos.filter(Y=>Y.status==="completed").length,P=$.todos.length,V=$.todos.find(Y=>Y.status==="in_progress");return V?`Todo: Working on "${V.content}"`:`Todo: ${O}/${P} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const O=$.pattern||"",P=R==="Grep"?"Grep":"Glob";if(A==="completed"&&C&&!C.error){let V=0;return C.content&&(V=C.content.split(`
`).filter(le=>le.trim()).length),`${P}: "${O}" (${V} results)`}return`${P}: "${O}"`}case"WebFetch":case"WebSearch":{const O=$.url||$.query||"";if(R==="WebSearch"){const V=$.query||"",Y=V.length>50?V.substring(0,50)+"...":V;return A==="completed"&&C?C.error?`Web: ${Y} (error)`:`Web: ${Y} (success)`:`Web: ${Y}`}let P="";try{O&&(P=new URL(O.startsWith("http")?O:`https://${O}`).hostname)}catch{P=O.length>50?O.substring(0,50)+"...":O}return A==="completed"&&C?C.error?`Web: ${P} (error)`:`Web: ${P} (success)`:`Web: ${P||O}`}case"NotebookEdit":{const O=f($.notebook_path),P=$.cell_number!==void 0?$.cell_number:"?",V=$.edit_mode||"replace";return`NotebookEdit: ${O} cell #${P} (${V})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${$.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${$.shell_id||"unknown"}`;default:return`${R}: executed`}}),x=y(()=>{const R=e.toolCall.name,$=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(R)?$.command||R:["Edit","Read","Write","NotebookEdit"].includes(R)&&($.file_path||$.notebook_path)||R});function D(){const R=o.currentSessionId;R&&s.toggleToolExpansion(R,e.toolCall.id)}function B(R){return R.type==="setMode"?`Set permission mode to "${R.mode}"`:R.type==="allow"?`Allow tool: ${R.tool}`:JSON.stringify(R)}async function Q(R,$,C=null){if(!i.value){i.value=!0,R==="allow"?l.value=$?"approve-apply":"approve":C?l.value="deny-guidance":l.value="deny";try{const A=o.currentSessionId;if(A){const O=$&&e.toolCall.suggestions?e.toolCall.suggestions:[];s.handlePermissionResponse(A,{request_id:e.toolCall.permissionRequestId,decision:R,reasoning:R==="allow"?"User allowed permission":"User denied permission",applied_updates:O})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,R,$,C)}catch(A){console.error("Failed to send permission response:",A)}finally{i.value=!1,l.value=null}}}return(R,$)=>(u(),m("div",{class:K(["tool-call-card card",h.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:D},[t("div",bd,[t("span",yd,S(p.value),1),t("span",{class:"tool-name",title:x.value},S(I.value),9,$d)]),t("div",wd,[t("small",Cd,S(g.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},S(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Ed)])]),n.toolCall.isExpanded?(u(),m("div",Sd,[d.value?(u(),m("div",kd,[t("div",Td,[$[6]||($[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[$[5]||($[5]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",xd,S(_.value?.message||"Session was terminated"),1)])])])):N("",!0),(u(),ve(ao(w.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!d.value?(u(),m("div",Md,[t("div",Ad,[$[9]||($[9]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",Od,[$[7]||($[7]=X("Claude wants to use the ",-1)),t("code",Dd,S(n.toolCall.name),1),$[8]||($[8]=X(" tool.",-1))])]),v.value?(u(),m("div",Nd,[t("div",Ld,[$[10]||($[10]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),$[11]||($[11]=t("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),t("div",Id,[(u(!0),m(ie,null,de(n.toolCall.suggestions,(C,A)=>(u(),m("div",{key:A,class:"suggestion-item"},[t("code",null,S(B(C)),1)]))),128))]),$[12]||($[12]=t("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):N("",!0),t("div",Pd,[v.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:$[0]||($[0]=C=>Q("allow",!0)),disabled:i.value},S(i.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,jd)):N("",!0),t("button",{class:K(["btn",v.value?"btn-outline-success":"btn-success"]),onClick:$[1]||($[1]=C=>Q("allow",!1)),disabled:i.value},S(i.value&&l.value==="approve"?"â³ Submitting...":v.value?"âœ… Approve Only":"âœ… Approve"),11,Rd),t("button",{class:"btn btn-danger",onClick:$[2]||($[2]=C=>Q("deny",!1)),disabled:i.value}," ðŸš« "+S(i.value&&l.value==="deny"?"Submitting...":"Deny"),9,Vd)]),t("div",Hd,[$[13]||($[13]=t("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),$[14]||($[14]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),oe(t("textarea",{"onUpdate:modelValue":$[3]||($[3]=C=>c.value=C),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:i.value},null,8,Wd),[[pe,c.value]]),c.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:$[4]||($[4]=C=>Q("deny",!1,c.value)),disabled:i.value},S(i.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Fd)):N("",!0)])])):N("",!0),n.toolCall.status==="permission_required"&&d.value?(u(),m("div",Ud,[t("div",Bd,[t("div",qd,[$[16]||($[16]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[$[15]||($[15]=t("strong",null,"Permission Request Cancelled",-1)),t("p",zd,S(_.value?.message||"Session was terminated before permission could be granted"),1)])])])])):N("",!0),n.toolCall.permissionDecision==="deny"?(u(),m("div",Kd,[t("div",Gd,[$[17]||($[17]=X(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(u(),m("span",Yd," - "+S(n.toolCall.result.message),1)):N("",!0)])])):N("",!0)])):N("",!0)],2))}},$n=z(Jd,[["__scopeId","data-v-a277c2a3"]]),Xd={class:"tool-footer-container"},Qd={key:0,class:"active-tools-area"},Zd=["aria-label","onKeydown"],eu={class:"footer-left"},tu={class:"footer-text"},su={class:"footer-middle"},nu={class:"footer-text"},ou={class:"footer-right"},au={class:"expand-icon"},iu={key:1,class:"tool-footer-expanded"},lu={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=De(),o=ae(),a=M(!1);function i(p){return p.map((g,b)=>({tool:g,originalIndex:b})).sort((g,b)=>{if(g.tool.timestamp&&b.tool.timestamp){const v=new Date(g.tool.timestamp).getTime(),f=new Date(b.tool.timestamp).getTime();if(v!==f)return v-f}return g.originalIndex-b.originalIndex}).map(({tool:g})=>g)}const l=y(()=>{const p=e.tools.filter(g=>g.status==="executing"||g.status==="permission_required");return i(p)}),c=y(()=>{const p=e.tools.filter(g=>g.status!=="executing"&&g.status!=="permission_required");return i(p)}),d=y(()=>{const p=new Map;e.tools.forEach(E=>{const k=p.get(E.name)||0;p.set(E.name,k+1)});const g=Array.from(p.entries()).sort((E,k)=>k[1]-E[1]),b=g.slice(0,5),v=g.length-b.length,f=b.map(([E,k])=>`${E} (${k})`).join(", ");return v>0?`${f}, +${v} more`:f}),_=y(()=>{const p=e.tools.length;let g=0,b=0,v=0;e.tools.forEach(T=>{const L=o.currentSessionId;(L?s.isToolUseOrphaned(L,T.id):!1)?v++:T.status==="completed"&&!T.result?.error&&T.permissionDecision!=="deny"?g++:(T.status==="error"||T.result?.error||T.permissionDecision==="deny")&&b++});let f=[];g>0&&f.push(`${g} âœ…`),b>0&&f.push(`${b} âŒ`),v>0&&f.push(`${v} â¹ï¸`);const E=p===1?"tool":"tools",k=f.length>0?": "+f.join(" "):"";return`${p} ${E}${k}`}),r=y(()=>a.value?"â–²":"â–¼"),w=y(()=>{const p=o.currentSessionId,g=e.tools.some(E=>E.status==="error"||E.result?.error||E.permissionDecision==="deny"),b=e.tools.some(E=>p?s.isToolUseOrphaned(p,E.id):!1),v=l.value.length>0,f=e.tools.every(E=>!(p?s.isToolUseOrphaned(p,E.id):!1)&&E.status==="completed"&&!E.result?.error&&E.permissionDecision!=="deny");return g?"footer-status-error":b?"footer-status-orphaned":v?"footer-status-in-progress":f?"footer-status-success":""});function h(){a.value=!a.value}return(p,g)=>(u(),m("div",Xd,[l.value.length>0?(u(),m("div",Qd,[(u(!0),m(ie,null,de(l.value,b=>(u(),ve($n,{key:b.id,toolCall:b},null,8,["toolCall"]))),128))])):N("",!0),t("div",{class:K(["tool-footer-summary",w.value]),onClick:h,role:"button","aria-label":a.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Ot(h,["enter"]),Ot(be(h,["prevent"]),["space"])]},[t("div",eu,[t("span",tu,"Used: "+S(d.value),1)]),t("div",su,[g[0]||(g[0]=t("span",{class:"footer-separator"},"|",-1)),t("span",nu,S(_.value),1)]),t("div",ou,[t("span",au,S(r.value),1)])],42,Zd),a.value?(u(),m("div",iu,[(u(!0),m(ie,null,de(c.value,b=>(u(),ve($n,{key:b.id,toolCall:b},null,8,["toolCall"]))),128))])):N("",!0)]))}},ru=z(lu,[["__scopeId","data-v-2d50a8e0"]]),cu={class:"message-row message-row-assistant"},du=["title"],uu={class:"message-content-column"},mu={key:0,class:"thinking-block mb-2"},pu=["innerHTML"],fu={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=De(),o=ae();nt.setOptions({breaks:!0,gfm:!0});const a=y(()=>Lt(e.message.timestamp)),i=y(()=>e.message.metadata?.model||null),l=y(()=>{const g=a.value;return`assistant${i.value?`
Model: ${i.value}`:""}
${g}`}),c=y(()=>{const g=e.message.content||"";return g.trim().length>0&&g!=="Assistant response"}),d=y(()=>{const g=e.message.content||"";let b=nt.parse(g);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),os.sanitize(b)}),_=y(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),r=y(()=>e.message.metadata?.thinking_content||""),w=y(()=>{const g=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return g||b}),h=y(()=>{const g=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],v=[...g],f=new Set(g.map(E=>E.id));for(const E of b)f.has(E.id)||v.push(E);return v}),p=y(()=>{const g=o.currentSessionId;if(!g)return[];const b=s.toolCallsBySession.get(g)||[];return h.value.map(v=>{const f=b.find(E=>E.id===v.id);return f||{id:v.id,name:v.name,input:v.input,status:"pending",result:null,timestamp:v.timestamp||e.message.timestamp,isExpanded:!0}})});return(g,b)=>(u(),m("div",cu,[t("div",{class:"message-speaker",title:l.value},[...b[0]||(b[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,du),t("div",uu,[_.value?(u(),m("div",mu,[re(fi,{thinking:r.value},null,8,["thinking"])])):N("",!0),c.value?(u(),m("div",{key:1,class:"message-text",innerHTML:d.value},null,8,pu)):N("",!0),w.value?(u(),ve(ru,{key:2,tools:p.value},null,8,["tools"])):N("",!0)])]))}},vu=z(fu,[["__scopeId","data-v-2e32f6ef"]]),hu={key:0,class:"message-row message-row-compaction"},_u=["title"],gu={class:"message-content-column"},bu={class:"compaction-status-content"},yu={class:"text-muted ms-auto"},$u={key:1,class:"message-row message-row-system"},wu=["title"],Cu={class:"message-content-column"},Eu={class:"system-text"},Su={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=y(()=>Lt(e.message.timestamp)),o=y(()=>`system
${s.value}`),a=y(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(i,l)=>a.value?(u(),m("div",hu,[t("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,_u),t("div",gu,[t("div",bu,[l[1]||(l[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",yu,S(s.value),1)])])])):(u(),m("div",$u,[t("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,wu),t("div",Cu,[t("span",Eu,S(n.message.content),1)])]))}},wn=z(Su,[["__scopeId","data-v-a078178f"]]),ku={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=y(()=>{switch(e.message.type){case"user":return li;case"assistant":return vu;case"system":return wn;default:return wn}});return(o,a)=>(u(),ve(ao(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Tu=z(ku,[["__scopeId","data-v-11dff525"]]);var $e="top",Ee="bottom",Se="right",we="left",as="auto",wt=[$e,Ee,Se,we],ot="start",ft="end",ro="clippingParents",Ws="viewport",dt="popper",co="reference",Ls=wt.reduce(function(n,e){return n.concat([e+"-"+ot,e+"-"+ft])},[]),Fs=[].concat(wt,[as]).reduce(function(n,e){return n.concat([e,e+"-"+ot,e+"-"+ft])},[]),uo="beforeRead",mo="read",po="afterRead",fo="beforeMain",vo="main",ho="afterMain",_o="beforeWrite",go="write",bo="afterWrite",yo=[uo,mo,po,fo,vo,ho,_o,go,bo];function Pe(n){return n?(n.nodeName||"").toLowerCase():null}function ke(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function at(n){var e=ke(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=ke(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Us(n){if(typeof ShadowRoot>"u")return!1;var e=ke(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function xu(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},i=e.elements[s];!Te(i)||!Pe(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(l){var c=a[l];c===!1?i.removeAttribute(l):i.setAttribute(l,c===!0?"":c)}))})}function Mu(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],i=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),c=l.reduce(function(d,_){return d[_]="",d},{});!Te(a)||!Pe(a)||(Object.assign(a.style,c),Object.keys(i).forEach(function(d){a.removeAttribute(d)}))})}}const Bs={name:"applyStyles",enabled:!0,phase:"write",fn:xu,effect:Mu,requires:["computeStyles"]};function Le(n){return n.split("-")[0]}var st=Math.max,Zt=Math.min,vt=Math.round;function Is(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function $o(){return!/^((?!chrome|android).)*safari/i.test(Is())}function ht(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,i=1;e&&Te(n)&&(a=n.offsetWidth>0&&vt(o.width)/n.offsetWidth||1,i=n.offsetHeight>0&&vt(o.height)/n.offsetHeight||1);var l=at(n)?ke(n):window,c=l.visualViewport,d=!$o()&&s,_=(o.left+(d&&c?c.offsetLeft:0))/a,r=(o.top+(d&&c?c.offsetTop:0))/i,w=o.width/a,h=o.height/i;return{width:w,height:h,top:r,right:_+w,bottom:r+h,left:_,x:_,y:r}}function qs(n){var e=ht(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function wo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Us(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function We(n){return ke(n).getComputedStyle(n)}function Au(n){return["table","td","th"].indexOf(Pe(n))>=0}function Ye(n){return((at(n)?n.ownerDocument:n.document)||window.document).documentElement}function is(n){return Pe(n)==="html"?n:n.assignedSlot||n.parentNode||(Us(n)?n.host:null)||Ye(n)}function Cn(n){return!Te(n)||We(n).position==="fixed"?null:n.offsetParent}function Ou(n){var e=/firefox/i.test(Is()),s=/Trident/i.test(Is());if(s&&Te(n)){var o=We(n);if(o.position==="fixed")return null}var a=is(n);for(Us(a)&&(a=a.host);Te(a)&&["html","body"].indexOf(Pe(a))<0;){var i=We(a);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||e&&i.willChange==="filter"||e&&i.filter&&i.filter!=="none")return a;a=a.parentNode}return null}function It(n){for(var e=ke(n),s=Cn(n);s&&Au(s)&&We(s).position==="static";)s=Cn(s);return s&&(Pe(s)==="html"||Pe(s)==="body"&&We(s).position==="static")?e:s||Ou(n)||e}function zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Mt(n,e,s){return st(n,Zt(e,s))}function Du(n,e,s){var o=Mt(n,e,s);return o>s?s:o}function Co(){return{top:0,right:0,bottom:0,left:0}}function Eo(n){return Object.assign({},Co(),n)}function So(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var Nu=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Eo(typeof e!="number"?e:So(e,wt))};function Lu(n){var e,s=n.state,o=n.name,a=n.options,i=s.elements.arrow,l=s.modifiersData.popperOffsets,c=Le(s.placement),d=zs(c),_=[we,Se].indexOf(c)>=0,r=_?"height":"width";if(!(!i||!l)){var w=Nu(a.padding,s),h=qs(i),p=d==="y"?$e:we,g=d==="y"?Ee:Se,b=s.rects.reference[r]+s.rects.reference[d]-l[d]-s.rects.popper[r],v=l[d]-s.rects.reference[d],f=It(i),E=f?d==="y"?f.clientHeight||0:f.clientWidth||0:0,k=b/2-v/2,T=w[p],L=E-h[r]-w[g],I=E/2-h[r]/2+k,x=Mt(T,I,L),D=d;s.modifiersData[o]=(e={},e[D]=x,e.centerOffset=x-I,e)}}function Iu(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||wo(e.elements.popper,a)&&(e.elements.arrow=a))}const ko={name:"arrow",enabled:!0,phase:"main",fn:Lu,effect:Iu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function _t(n){return n.split("-")[1]}var Pu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ju(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:vt(s*a)/a||0,y:vt(o*a)/a||0}}function En(n){var e,s=n.popper,o=n.popperRect,a=n.placement,i=n.variation,l=n.offsets,c=n.position,d=n.gpuAcceleration,_=n.adaptive,r=n.roundOffsets,w=n.isFixed,h=l.x,p=h===void 0?0:h,g=l.y,b=g===void 0?0:g,v=typeof r=="function"?r({x:p,y:b}):{x:p,y:b};p=v.x,b=v.y;var f=l.hasOwnProperty("x"),E=l.hasOwnProperty("y"),k=we,T=$e,L=window;if(_){var I=It(s),x="clientHeight",D="clientWidth";if(I===ke(s)&&(I=Ye(s),We(I).position!=="static"&&c==="absolute"&&(x="scrollHeight",D="scrollWidth")),I=I,a===$e||(a===we||a===Se)&&i===ft){T=Ee;var B=w&&I===L&&L.visualViewport?L.visualViewport.height:I[x];b-=B-o.height,b*=d?1:-1}if(a===we||(a===$e||a===Ee)&&i===ft){k=Se;var Q=w&&I===L&&L.visualViewport?L.visualViewport.width:I[D];p-=Q-o.width,p*=d?1:-1}}var R=Object.assign({position:c},_&&Pu),$=r===!0?ju({x:p,y:b},ke(s)):{x:p,y:b};if(p=$.x,b=$.y,d){var C;return Object.assign({},R,(C={},C[T]=E?"0":"",C[k]=f?"0":"",C.transform=(L.devicePixelRatio||1)<=1?"translate("+p+"px, "+b+"px)":"translate3d("+p+"px, "+b+"px, 0)",C))}return Object.assign({},R,(e={},e[T]=E?b+"px":"",e[k]=f?p+"px":"",e.transform="",e))}function Ru(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,i=s.adaptive,l=i===void 0?!0:i,c=s.roundOffsets,d=c===void 0?!0:c,_={placement:Le(e.placement),variation:_t(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,En(Object.assign({},_,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,En(Object.assign({},_,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ks={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ru,data:{}};var Ft={passive:!0};function Vu(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,i=a===void 0?!0:a,l=o.resize,c=l===void 0?!0:l,d=ke(e.elements.popper),_=[].concat(e.scrollParents.reference,e.scrollParents.popper);return i&&_.forEach(function(r){r.addEventListener("scroll",s.update,Ft)}),c&&d.addEventListener("resize",s.update,Ft),function(){i&&_.forEach(function(r){r.removeEventListener("scroll",s.update,Ft)}),c&&d.removeEventListener("resize",s.update,Ft)}}const Gs={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Vu,data:{}};var Hu={left:"right",right:"left",bottom:"top",top:"bottom"};function Yt(n){return n.replace(/left|right|bottom|top/g,function(e){return Hu[e]})}var Wu={start:"end",end:"start"};function Sn(n){return n.replace(/start|end/g,function(e){return Wu[e]})}function Ys(n){var e=ke(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function Js(n){return ht(Ye(n)).left+Ys(n).scrollLeft}function Fu(n,e){var s=ke(n),o=Ye(n),a=s.visualViewport,i=o.clientWidth,l=o.clientHeight,c=0,d=0;if(a){i=a.width,l=a.height;var _=$o();(_||!_&&e==="fixed")&&(c=a.offsetLeft,d=a.offsetTop)}return{width:i,height:l,x:c+Js(n),y:d}}function Uu(n){var e,s=Ye(n),o=Ys(n),a=(e=n.ownerDocument)==null?void 0:e.body,i=st(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),l=st(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),c=-o.scrollLeft+Js(n),d=-o.scrollTop;return We(a||s).direction==="rtl"&&(c+=st(s.clientWidth,a?a.clientWidth:0)-i),{width:i,height:l,x:c,y:d}}function Xs(n){var e=We(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function To(n){return["html","body","#document"].indexOf(Pe(n))>=0?n.ownerDocument.body:Te(n)&&Xs(n)?n:To(is(n))}function At(n,e){var s;e===void 0&&(e=[]);var o=To(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),i=ke(o),l=a?[i].concat(i.visualViewport||[],Xs(o)?o:[]):o,c=e.concat(l);return a?c:c.concat(At(is(l)))}function Ps(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Bu(n,e){var s=ht(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function kn(n,e,s){return e===Ws?Ps(Fu(n,s)):at(e)?Bu(e,s):Ps(Uu(Ye(n)))}function qu(n){var e=At(is(n)),s=["absolute","fixed"].indexOf(We(n).position)>=0,o=s&&Te(n)?It(n):n;return at(o)?e.filter(function(a){return at(a)&&wo(a,o)&&Pe(a)!=="body"}):[]}function zu(n,e,s,o){var a=e==="clippingParents"?qu(n):[].concat(e),i=[].concat(a,[s]),l=i[0],c=i.reduce(function(d,_){var r=kn(n,_,o);return d.top=st(r.top,d.top),d.right=Zt(r.right,d.right),d.bottom=Zt(r.bottom,d.bottom),d.left=st(r.left,d.left),d},kn(n,l,o));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function xo(n){var e=n.reference,s=n.element,o=n.placement,a=o?Le(o):null,i=o?_t(o):null,l=e.x+e.width/2-s.width/2,c=e.y+e.height/2-s.height/2,d;switch(a){case $e:d={x:l,y:e.y-s.height};break;case Ee:d={x:l,y:e.y+e.height};break;case Se:d={x:e.x+e.width,y:c};break;case we:d={x:e.x-s.width,y:c};break;default:d={x:e.x,y:e.y}}var _=a?zs(a):null;if(_!=null){var r=_==="y"?"height":"width";switch(i){case ot:d[_]=d[_]-(e[r]/2-s[r]/2);break;case ft:d[_]=d[_]+(e[r]/2-s[r]/2);break}}return d}function gt(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,i=s.strategy,l=i===void 0?n.strategy:i,c=s.boundary,d=c===void 0?ro:c,_=s.rootBoundary,r=_===void 0?Ws:_,w=s.elementContext,h=w===void 0?dt:w,p=s.altBoundary,g=p===void 0?!1:p,b=s.padding,v=b===void 0?0:b,f=Eo(typeof v!="number"?v:So(v,wt)),E=h===dt?co:dt,k=n.rects.popper,T=n.elements[g?E:h],L=zu(at(T)?T:T.contextElement||Ye(n.elements.popper),d,r,l),I=ht(n.elements.reference),x=xo({reference:I,element:k,placement:a}),D=Ps(Object.assign({},k,x)),B=h===dt?D:I,Q={top:L.top-B.top+f.top,bottom:B.bottom-L.bottom+f.bottom,left:L.left-B.left+f.left,right:B.right-L.right+f.right},R=n.modifiersData.offset;if(h===dt&&R){var $=R[a];Object.keys(Q).forEach(function(C){var A=[Se,Ee].indexOf(C)>=0?1:-1,O=[$e,Ee].indexOf(C)>=0?"y":"x";Q[C]+=$[O]*A})}return Q}function Ku(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,i=s.rootBoundary,l=s.padding,c=s.flipVariations,d=s.allowedAutoPlacements,_=d===void 0?Fs:d,r=_t(o),w=r?c?Ls:Ls.filter(function(g){return _t(g)===r}):wt,h=w.filter(function(g){return _.indexOf(g)>=0});h.length===0&&(h=w);var p=h.reduce(function(g,b){return g[b]=gt(n,{placement:b,boundary:a,rootBoundary:i,padding:l})[Le(b)],g},{});return Object.keys(p).sort(function(g,b){return p[g]-p[b]})}function Gu(n){if(Le(n)===as)return[];var e=Yt(n);return[Sn(n),e,Sn(e)]}function Yu(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,i=a===void 0?!0:a,l=s.altAxis,c=l===void 0?!0:l,d=s.fallbackPlacements,_=s.padding,r=s.boundary,w=s.rootBoundary,h=s.altBoundary,p=s.flipVariations,g=p===void 0?!0:p,b=s.allowedAutoPlacements,v=e.options.placement,f=Le(v),E=f===v,k=d||(E||!g?[Yt(v)]:Gu(v)),T=[v].concat(k).reduce(function(q,ue){return q.concat(Le(ue)===as?Ku(e,{placement:ue,boundary:r,rootBoundary:w,padding:_,flipVariations:g,allowedAutoPlacements:b}):ue)},[]),L=e.rects.reference,I=e.rects.popper,x=new Map,D=!0,B=T[0],Q=0;Q<T.length;Q++){var R=T[Q],$=Le(R),C=_t(R)===ot,A=[$e,Ee].indexOf($)>=0,O=A?"width":"height",P=gt(e,{placement:R,boundary:r,rootBoundary:w,altBoundary:h,padding:_}),V=A?C?Se:we:C?Ee:$e;L[O]>I[O]&&(V=Yt(V));var Y=Yt(V),le=[];if(i&&le.push(P[$]<=0),c&&le.push(P[V]<=0,P[Y]<=0),le.every(function(q){return q})){B=R,D=!1;break}x.set(R,le)}if(D)for(var U=g?3:1,W=function(ue){var H=T.find(function(F){var G=x.get(F);if(G)return G.slice(0,ue).every(function(Z){return Z})});if(H)return B=H,"break"},ne=U;ne>0;ne--){var te=W(ne);if(te==="break")break}e.placement!==B&&(e.modifiersData[o]._skip=!0,e.placement=B,e.reset=!0)}}const Mo={name:"flip",enabled:!0,phase:"main",fn:Yu,requiresIfExists:["offset"],data:{_skip:!1}};function Tn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function xn(n){return[$e,Se,Ee,we].some(function(e){return n[e]>=0})}function Ju(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,i=e.modifiersData.preventOverflow,l=gt(e,{elementContext:"reference"}),c=gt(e,{altBoundary:!0}),d=Tn(l,o),_=Tn(c,a,i),r=xn(d),w=xn(_);e.modifiersData[s]={referenceClippingOffsets:d,popperEscapeOffsets:_,isReferenceHidden:r,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":r,"data-popper-escaped":w})}const Ao={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Ju};function Xu(n,e,s){var o=Le(n),a=[we,$e].indexOf(o)>=0?-1:1,i=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,l=i[0],c=i[1];return l=l||0,c=(c||0)*a,[we,Se].indexOf(o)>=0?{x:c,y:l}:{x:l,y:c}}function Qu(n){var e=n.state,s=n.options,o=n.name,a=s.offset,i=a===void 0?[0,0]:a,l=Fs.reduce(function(r,w){return r[w]=Xu(w,e.rects,i),r},{}),c=l[e.placement],d=c.x,_=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=_),e.modifiersData[o]=l}const Oo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Qu};function Zu(n){var e=n.state,s=n.name;e.modifiersData[s]=xo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Qs={name:"popperOffsets",enabled:!0,phase:"read",fn:Zu,data:{}};function em(n){return n==="x"?"y":"x"}function tm(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,i=a===void 0?!0:a,l=s.altAxis,c=l===void 0?!1:l,d=s.boundary,_=s.rootBoundary,r=s.altBoundary,w=s.padding,h=s.tether,p=h===void 0?!0:h,g=s.tetherOffset,b=g===void 0?0:g,v=gt(e,{boundary:d,rootBoundary:_,padding:w,altBoundary:r}),f=Le(e.placement),E=_t(e.placement),k=!E,T=zs(f),L=em(T),I=e.modifiersData.popperOffsets,x=e.rects.reference,D=e.rects.popper,B=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,Q=typeof B=="number"?{mainAxis:B,altAxis:B}:Object.assign({mainAxis:0,altAxis:0},B),R=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,$={x:0,y:0};if(I){if(i){var C,A=T==="y"?$e:we,O=T==="y"?Ee:Se,P=T==="y"?"height":"width",V=I[T],Y=V+v[A],le=V-v[O],U=p?-D[P]/2:0,W=E===ot?x[P]:D[P],ne=E===ot?-D[P]:-x[P],te=e.elements.arrow,q=p&&te?qs(te):{width:0,height:0},ue=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Co(),H=ue[A],F=ue[O],G=Mt(0,x[P],q[P]),Z=k?x[P]/2-U-G-H-Q.mainAxis:W-G-H-Q.mainAxis,ee=k?-x[P]/2+U+G+F+Q.mainAxis:ne+G+F+Q.mainAxis,_e=e.elements.arrow&&It(e.elements.arrow),kt=_e?T==="y"?_e.clientTop||0:_e.clientLeft||0:0,Ht=(C=R?.[T])!=null?C:0,ma=V+Z-Ht-kt,pa=V+ee-Ht,ln=Mt(p?Zt(Y,ma):Y,V,p?st(le,pa):le);I[T]=ln,$[T]=ln-V}if(c){var rn,fa=T==="x"?$e:we,va=T==="x"?Ee:Se,Ze=I[L],Wt=L==="y"?"height":"width",cn=Ze+v[fa],dn=Ze-v[va],ps=[$e,we].indexOf(f)!==-1,un=(rn=R?.[L])!=null?rn:0,mn=ps?cn:Ze-x[Wt]-D[Wt]-un+Q.altAxis,pn=ps?Ze+x[Wt]+D[Wt]-un-Q.altAxis:dn,fn=p&&ps?Du(mn,Ze,pn):Mt(p?mn:cn,Ze,p?pn:dn);I[L]=fn,$[L]=fn-Ze}e.modifiersData[o]=$}}const Do={name:"preventOverflow",enabled:!0,phase:"main",fn:tm,requiresIfExists:["offset"]};function sm(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function nm(n){return n===ke(n)||!Te(n)?Ys(n):sm(n)}function om(n){var e=n.getBoundingClientRect(),s=vt(e.width)/n.offsetWidth||1,o=vt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function am(n,e,s){s===void 0&&(s=!1);var o=Te(e),a=Te(e)&&om(e),i=Ye(e),l=ht(n,a,s),c={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(o||!o&&!s)&&((Pe(e)!=="body"||Xs(i))&&(c=nm(e)),Te(e)?(d=ht(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):i&&(d.x=Js(i))),{x:l.left+c.scrollLeft-d.x,y:l.top+c.scrollTop-d.y,width:l.width,height:l.height}}function im(n){var e=new Map,s=new Set,o=[];n.forEach(function(i){e.set(i.name,i)});function a(i){s.add(i.name);var l=[].concat(i.requires||[],i.requiresIfExists||[]);l.forEach(function(c){if(!s.has(c)){var d=e.get(c);d&&a(d)}}),o.push(i)}return n.forEach(function(i){s.has(i.name)||a(i)}),o}function lm(n){var e=im(n);return yo.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function rm(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function cm(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Mn={placement:"bottom",modifiers:[],strategy:"absolute"};function An(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function ls(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,i=a===void 0?Mn:a;return function(c,d,_){_===void 0&&(_=i);var r={placement:"bottom",orderedModifiers:[],options:Object.assign({},Mn,i),modifiersData:{},elements:{reference:c,popper:d},attributes:{},styles:{}},w=[],h=!1,p={state:r,setOptions:function(f){var E=typeof f=="function"?f(r.options):f;b(),r.options=Object.assign({},i,r.options,E),r.scrollParents={reference:at(c)?At(c):c.contextElement?At(c.contextElement):[],popper:At(d)};var k=lm(cm([].concat(o,r.options.modifiers)));return r.orderedModifiers=k.filter(function(T){return T.enabled}),g(),p.update()},forceUpdate:function(){if(!h){var f=r.elements,E=f.reference,k=f.popper;if(An(E,k)){r.rects={reference:am(E,It(k),r.options.strategy==="fixed"),popper:qs(k)},r.reset=!1,r.placement=r.options.placement,r.orderedModifiers.forEach(function(Q){return r.modifiersData[Q.name]=Object.assign({},Q.data)});for(var T=0;T<r.orderedModifiers.length;T++){if(r.reset===!0){r.reset=!1,T=-1;continue}var L=r.orderedModifiers[T],I=L.fn,x=L.options,D=x===void 0?{}:x,B=L.name;typeof I=="function"&&(r=I({state:r,options:D,name:B,instance:p})||r)}}}},update:rm(function(){return new Promise(function(v){p.forceUpdate(),v(r)})}),destroy:function(){b(),h=!0}};if(!An(c,d))return p;p.setOptions(_).then(function(v){!h&&_.onFirstUpdate&&_.onFirstUpdate(v)});function g(){r.orderedModifiers.forEach(function(v){var f=v.name,E=v.options,k=E===void 0?{}:E,T=v.effect;if(typeof T=="function"){var L=T({state:r,name:f,instance:p,options:k}),I=function(){};w.push(L||I)}})}function b(){w.forEach(function(v){return v()}),w=[]}return p}}var dm=ls(),um=[Gs,Qs,Ks,Bs],mm=ls({defaultModifiers:um}),pm=[Gs,Qs,Ks,Bs,Oo,Mo,Do,ko,Ao],Zs=ls({defaultModifiers:pm});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ho,afterRead:po,afterWrite:bo,applyStyles:Bs,arrow:ko,auto:as,basePlacements:wt,beforeMain:fo,beforeRead:uo,beforeWrite:_o,bottom:Ee,clippingParents:ro,computeStyles:Ks,createPopper:Zs,createPopperBase:dm,createPopperLite:mm,detectOverflow:gt,end:ft,eventListeners:Gs,flip:Mo,hide:Ao,left:we,main:vo,modifierPhases:yo,offset:Oo,placements:Fs,popper:dt,popperGenerator:ls,popperOffsets:Qs,preventOverflow:Do,read:mo,reference:co,right:Se,start:ot,top:$e,variationPlacements:Ls,viewport:Ws,write:go},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Be=new Map,_s={set(n,e,s){Be.has(n)||Be.set(n,new Map);const o=Be.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return Be.has(n)&&Be.get(n).get(e)||null},remove(n,e){if(!Be.has(n))return;const s=Be.get(n);s.delete(e),s.size===0&&Be.delete(n)}},fm=1e6,vm=1e3,js="transitionend",Lo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),hm=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),_m=n=>{do n+=Math.floor(Math.random()*fm);while(document.getElementById(n));return n},gm=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*vm)},Io=n=>{n.dispatchEvent(new Event(js))},Re=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),qe=n=>Re(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Lo(n)):null,Ct=n=>{if(!Re(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},ze=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Po=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Po(n.parentNode):null},es=()=>{},Pt=n=>{n.offsetHeight},jo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,gs=[],bm=n=>{document.readyState==="loading"?(gs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of gs)e()}),gs.push(n)):n()},xe=()=>document.documentElement.dir==="rtl",Ae=n=>{bm(()=>{const e=jo();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ce=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,Ro=(n,e,s=!0)=>{if(!s){Ce(n);return}const a=gm(e)+5;let i=!1;const l=({target:c})=>{c===e&&(i=!0,e.removeEventListener(js,l),Ce(n))};e.addEventListener(js,l),setTimeout(()=>{i||Io(e)},a)},en=(n,e,s,o)=>{const a=n.length;let i=n.indexOf(e);return i===-1?!s&&o?n[a-1]:n[0]:(i+=s?1:-1,o&&(i=(i+a)%a),n[Math.max(0,Math.min(i,a-1))])},ym=/[^.]*(?=\..*)\.|.*/,$m=/\..*/,wm=/::\d+$/,bs={};let On=1;const Vo={mouseenter:"mouseover",mouseleave:"mouseout"},Cm=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ho(n,e){return e&&`${e}::${On++}`||n.uidEvent||On++}function Wo(n){const e=Ho(n);return n.uidEvent=e,bs[e]=bs[e]||{},bs[e]}function Em(n,e){return function s(o){return tn(o,{delegateTarget:n}),s.oneOff&&j.off(n,o.type,e),e.apply(n,[o])}}function Sm(n,e,s){return function o(a){const i=n.querySelectorAll(e);for(let{target:l}=a;l&&l!==this;l=l.parentNode)for(const c of i)if(c===l)return tn(a,{delegateTarget:l}),o.oneOff&&j.off(n,a.type,e,s),s.apply(l,[a])}}function Fo(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Uo(n,e,s){const o=typeof e=="string",a=o?s:e||s;let i=Bo(n);return Cm.has(i)||(i=n),[o,a,i]}function Dn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[i,l,c]=Uo(e,s,o);e in Vo&&(l=(g=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return g.call(this,b)})(l));const d=Wo(n),_=d[c]||(d[c]={}),r=Fo(_,l,i?s:null);if(r){r.oneOff=r.oneOff&&a;return}const w=Ho(l,e.replace(ym,"")),h=i?Sm(n,s,l):Em(n,l);h.delegationSelector=i?s:null,h.callable=l,h.oneOff=a,h.uidEvent=w,_[w]=h,n.addEventListener(c,h,i)}function Rs(n,e,s,o,a){const i=Fo(e[s],o,a);i&&(n.removeEventListener(s,i,!!a),delete e[s][i.uidEvent])}function km(n,e,s,o){const a=e[s]||{};for(const[i,l]of Object.entries(a))i.includes(o)&&Rs(n,e,s,l.callable,l.delegationSelector)}function Bo(n){return n=n.replace($m,""),Vo[n]||n}const j={on(n,e,s,o){Dn(n,e,s,o,!1)},one(n,e,s,o){Dn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,i,l]=Uo(e,s,o),c=l!==e,d=Wo(n),_=d[l]||{},r=e.startsWith(".");if(typeof i<"u"){if(!Object.keys(_).length)return;Rs(n,d,l,i,a?s:null);return}if(r)for(const w of Object.keys(d))km(n,d,w,e.slice(1));for(const[w,h]of Object.entries(_)){const p=w.replace(wm,"");(!c||e.includes(p))&&Rs(n,d,l,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=jo(),a=Bo(e),i=e!==a;let l=null,c=!0,d=!0,_=!1;i&&o&&(l=o.Event(e,s),o(n).trigger(l),c=!l.isPropagationStopped(),d=!l.isImmediatePropagationStopped(),_=l.isDefaultPrevented());const r=tn(new Event(e,{bubbles:c,cancelable:!0}),s);return _&&r.preventDefault(),d&&n.dispatchEvent(r),r.defaultPrevented&&l&&l.preventDefault(),r}};function tn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Nn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function ys(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ve={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${ys(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${ys(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=Nn(n.dataset[o])}return e},getDataAttribute(n,e){return Nn(n.getAttribute(`data-bs-${ys(e)}`))}};class jt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Re(s)?Ve.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Re(s)?Ve.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const i=e[o],l=Re(i)?"element":hm(i);if(!new RegExp(a).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${a}".`)}}}const Tm="5.3.8";class Ne extends jt{constructor(e,s){super(),e=qe(e),e&&(this._element=e,this._config=this._getConfig(s),_s.set(this._element,this.constructor.DATA_KEY,this))}dispose(){_s.remove(this._element,this.constructor.DATA_KEY),j.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){Ro(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return _s.get(qe(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Tm}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const $s=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>Lo(s)).join(","):null},J={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!ze(s)&&Ct(s))},getSelectorFromElement(n){const e=$s(n);return e&&J.findOne(e)?e:null},getElementFromSelector(n){const e=$s(n);return e?J.findOne(e):null},getMultipleElementsFromSelector(n){const e=$s(n);return e?J.find(e):[]}},rs=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;j.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),ze(this))return;const i=J.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(i)[e]()})},xm="alert",Mm="bs.alert",qo=`.${Mm}`,Am=`close${qo}`,Om=`closed${qo}`,Dm="fade",Nm="show";class cs extends Ne{static get NAME(){return xm}close(){if(j.trigger(this._element,Am).defaultPrevented)return;this._element.classList.remove(Nm);const s=this._element.classList.contains(Dm);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),j.trigger(this._element,Om),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=cs.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}rs(cs,"close");Ae(cs);const Lm="button",Im="bs.button",Pm=`.${Im}`,jm=".data-api",Rm="active",Ln='[data-bs-toggle="button"]',Vm=`click${Pm}${jm}`;class ds extends Ne{static get NAME(){return Lm}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Rm))}static jQueryInterface(e){return this.each(function(){const s=ds.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}j.on(document,Vm,Ln,n=>{n.preventDefault();const e=n.target.closest(Ln);ds.getOrCreateInstance(e).toggle()});Ae(ds);const Hm="swipe",Et=".bs.swipe",Wm=`touchstart${Et}`,Fm=`touchmove${Et}`,Um=`touchend${Et}`,Bm=`pointerdown${Et}`,qm=`pointerup${Et}`,zm="touch",Km="pen",Gm="pointer-event",Ym=40,Jm={endCallback:null,leftCallback:null,rightCallback:null},Xm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class ts extends jt{constructor(e,s){super(),this._element=e,!(!e||!ts.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Jm}static get DefaultType(){return Xm}static get NAME(){return Hm}dispose(){j.off(this._element,Et)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ce(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Ym)return;const s=e/this._deltaX;this._deltaX=0,s&&Ce(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(j.on(this._element,Bm,e=>this._start(e)),j.on(this._element,qm,e=>this._end(e)),this._element.classList.add(Gm)):(j.on(this._element,Wm,e=>this._start(e)),j.on(this._element,Fm,e=>this._move(e)),j.on(this._element,Um,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Km||e.pointerType===zm)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Qm="carousel",Zm="bs.carousel",Je=`.${Zm}`,zo=".data-api",ep="ArrowLeft",tp="ArrowRight",sp=500,Tt="next",rt="prev",ut="left",Jt="right",np=`slide${Je}`,ws=`slid${Je}`,op=`keydown${Je}`,ap=`mouseenter${Je}`,ip=`mouseleave${Je}`,lp=`dragstart${Je}`,rp=`load${Je}${zo}`,cp=`click${Je}${zo}`,Ko="carousel",Ut="active",dp="slide",up="carousel-item-end",mp="carousel-item-start",pp="carousel-item-next",fp="carousel-item-prev",Go=".active",Yo=".carousel-item",vp=Go+Yo,hp=".carousel-item img",_p=".carousel-indicators",gp="[data-bs-slide], [data-bs-slide-to]",bp='[data-bs-ride="carousel"]',yp={[ep]:Jt,[tp]:ut},$p={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},wp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Rt extends Ne{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=J.findOne(_p,this._element),this._addEventListeners(),this._config.ride===Ko&&this.cycle()}static get Default(){return $p}static get DefaultType(){return wp}static get NAME(){return Qm}next(){this._slide(Tt)}nextWhenVisible(){!document.hidden&&Ct(this._element)&&this.next()}prev(){this._slide(rt)}pause(){this._isSliding&&Io(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){j.one(this._element,ws,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){j.one(this._element,ws,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?Tt:rt;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&j.on(this._element,op,e=>this._keydown(e)),this._config.pause==="hover"&&(j.on(this._element,ap,()=>this.pause()),j.on(this._element,ip,()=>this._maybeEnableCycle())),this._config.touch&&ts.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of J.find(hp,this._element))j.on(o,lp,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(ut)),rightCallback:()=>this._slide(this._directionToOrder(Jt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),sp+this._config.interval))}};this._swipeHelper=new ts(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=yp[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=J.findOne(Go,this._indicatorsElement);s.classList.remove(Ut),s.removeAttribute("aria-current");const o=J.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Ut),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===Tt,i=s||en(this._getItems(),o,a,this._config.wrap);if(i===o)return;const l=this._getItemIndex(i),c=p=>j.trigger(this._element,p,{relatedTarget:i,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(c(np).defaultPrevented||!o||!i)return;const _=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=i;const r=a?mp:up,w=a?pp:fp;i.classList.add(w),Pt(i),o.classList.add(r),i.classList.add(r);const h=()=>{i.classList.remove(r,w),i.classList.add(Ut),o.classList.remove(Ut,w,r),this._isSliding=!1,c(ws)};this._queueCallback(h,o,this._isAnimated()),_&&this.cycle()}_isAnimated(){return this._element.classList.contains(dp)}_getActive(){return J.findOne(vp,this._element)}_getItems(){return J.find(Yo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return xe()?e===ut?rt:Tt:e===ut?Tt:rt}_orderToDirection(e){return xe()?e===rt?ut:Jt:e===rt?Jt:ut}static jQueryInterface(e){return this.each(function(){const s=Rt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}j.on(document,cp,gp,function(n){const e=J.getElementFromSelector(this);if(!e||!e.classList.contains(Ko))return;n.preventDefault();const s=Rt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Ve.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});j.on(window,rp,()=>{const n=J.find(bp);for(const e of n)Rt.getOrCreateInstance(e)});Ae(Rt);const Cp="collapse",Ep="bs.collapse",Vt=`.${Ep}`,Sp=".data-api",kp=`show${Vt}`,Tp=`shown${Vt}`,xp=`hide${Vt}`,Mp=`hidden${Vt}`,Ap=`click${Vt}${Sp}`,Cs="show",pt="collapse",Bt="collapsing",Op="collapsed",Dp=`:scope .${pt} .${pt}`,Np="collapse-horizontal",Lp="width",Ip="height",Pp=".collapse.show, .collapse.collapsing",Vs='[data-bs-toggle="collapse"]',jp={parent:null,toggle:!0},Rp={parent:"(null|element)",toggle:"boolean"};class bt extends Ne{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=J.find(Vs);for(const a of o){const i=J.getSelectorFromElement(a),l=J.find(i).filter(c=>c===this._element);i!==null&&l.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return jp}static get DefaultType(){return Rp}static get NAME(){return Cp}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Pp).filter(c=>c!==this._element).map(c=>bt.getOrCreateInstance(c,{toggle:!1}))),e.length&&e[0]._isTransitioning||j.trigger(this._element,kp).defaultPrevented)return;for(const c of e)c.hide();const o=this._getDimension();this._element.classList.remove(pt),this._element.classList.add(Bt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(Bt),this._element.classList.add(pt,Cs),this._element.style[o]="",j.trigger(this._element,Tp)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||j.trigger(this._element,xp).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Pt(this._element),this._element.classList.add(Bt),this._element.classList.remove(pt,Cs);for(const a of this._triggerArray){const i=J.getElementFromSelector(a);i&&!this._isShown(i)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Bt),this._element.classList.add(pt),j.trigger(this._element,Mp)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Cs)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=qe(e.parent),e}_getDimension(){return this._element.classList.contains(Np)?Lp:Ip}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Vs);for(const s of e){const o=J.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=J.find(Dp,this._config.parent);return J.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Op,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=bt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}j.on(document,Ap,Vs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of J.getMultipleElementsFromSelector(this))bt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ae(bt);const In="dropdown",Vp="bs.dropdown",it=`.${Vp}`,sn=".data-api",Hp="Escape",Pn="Tab",Wp="ArrowUp",jn="ArrowDown",Fp=2,Up=`hide${it}`,Bp=`hidden${it}`,qp=`show${it}`,zp=`shown${it}`,Jo=`click${it}${sn}`,Xo=`keydown${it}${sn}`,Kp=`keyup${it}${sn}`,mt="show",Gp="dropup",Yp="dropend",Jp="dropstart",Xp="dropup-center",Qp="dropdown-center",et='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Zp=`${et}.${mt}`,Xt=".dropdown-menu",ef=".navbar",tf=".navbar-nav",sf=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",nf=xe()?"top-end":"top-start",of=xe()?"top-start":"top-end",af=xe()?"bottom-end":"bottom-start",lf=xe()?"bottom-start":"bottom-end",rf=xe()?"left-start":"right-start",cf=xe()?"right-start":"left-start",df="top",uf="bottom",mf={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},pf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ie extends Ne{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=J.next(this._element,Xt)[0]||J.prev(this._element,Xt)[0]||J.findOne(Xt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return mf}static get DefaultType(){return pf}static get NAME(){return In}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ze(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!j.trigger(this._element,qp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(tf))for(const o of[].concat(...document.body.children))j.on(o,"mouseover",es);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(mt),this._element.classList.add(mt),j.trigger(this._element,zp,e)}}hide(){if(ze(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!j.trigger(this._element,Up,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))j.off(o,"mouseover",es);this._popper&&this._popper.destroy(),this._menu.classList.remove(mt),this._element.classList.remove(mt),this._element.setAttribute("aria-expanded","false"),Ve.removeDataAttribute(this._menu,"popper"),j.trigger(this._element,Bp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Re(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${In.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Re(this._config.reference)?e=qe(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Zs(e,this._menu,s)}_isShown(){return this._menu.classList.contains(mt)}_getPlacement(){const e=this._parent;if(e.classList.contains(Yp))return rf;if(e.classList.contains(Jp))return cf;if(e.classList.contains(Xp))return df;if(e.classList.contains(Qp))return uf;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Gp)?s?of:nf:s?lf:af}_detectNavbar(){return this._element.closest(ef)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ve.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ce(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=J.find(sf,this._menu).filter(a=>Ct(a));o.length&&en(o,s,e===jn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Ie.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===Fp||e.type==="keyup"&&e.key!==Pn)return;const s=J.find(Zp);for(const o of s){const a=Ie.getInstance(o);if(!a||a._config.autoClose===!1)continue;const i=e.composedPath(),l=i.includes(a._menu);if(i.includes(a._element)||a._config.autoClose==="inside"&&!l||a._config.autoClose==="outside"&&l||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Pn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const c={relatedTarget:a._element};e.type==="click"&&(c.clickEvent=e),a._completeHide(c)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Hp,a=[Wp,jn].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const i=this.matches(et)?this:J.prev(this,et)[0]||J.next(this,et)[0]||J.findOne(et,e.delegateTarget.parentNode),l=Ie.getOrCreateInstance(i);if(a){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),i.focus())}}j.on(document,Xo,et,Ie.dataApiKeydownHandler);j.on(document,Xo,Xt,Ie.dataApiKeydownHandler);j.on(document,Jo,Ie.clearMenus);j.on(document,Kp,Ie.clearMenus);j.on(document,Jo,et,function(n){n.preventDefault(),Ie.getOrCreateInstance(this).toggle()});Ae(Ie);const Qo="backdrop",ff="fade",Rn="show",Vn=`mousedown.bs.${Qo}`,vf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},hf={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Zo extends jt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return vf}static get DefaultType(){return hf}static get NAME(){return Qo}show(e){if(!this._config.isVisible){Ce(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Pt(s),s.classList.add(Rn),this._emulateAnimation(()=>{Ce(e)})}hide(e){if(!this._config.isVisible){Ce(e);return}this._getElement().classList.remove(Rn),this._emulateAnimation(()=>{this.dispose(),Ce(e)})}dispose(){this._isAppended&&(j.off(this._element,Vn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(ff),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=qe(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),j.on(e,Vn,()=>{Ce(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Ro(e,this._getElement(),this._config.isAnimated)}}const _f="focustrap",gf="bs.focustrap",ss=`.${gf}`,bf=`focusin${ss}`,yf=`keydown.tab${ss}`,$f="Tab",wf="forward",Hn="backward",Cf={autofocus:!0,trapElement:null},Ef={autofocus:"boolean",trapElement:"element"};class ea extends jt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Cf}static get DefaultType(){return Ef}static get NAME(){return _f}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),j.off(document,ss),j.on(document,bf,e=>this._handleFocusin(e)),j.on(document,yf,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,j.off(document,ss))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=J.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Hn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===$f&&(this._lastTabNavDirection=e.shiftKey?Hn:wf)}}const Wn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Fn=".sticky-top",qt="padding-right",Un="margin-right";class Hs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,qt,s=>s+e),this._setElementAttributes(Wn,qt,s=>s+e),this._setElementAttributes(Fn,Un,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,qt),this._resetElementAttributes(Wn,qt),this._resetElementAttributes(Fn,Un)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),i=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+a)return;this._saveInitialAttribute(l,s);const c=window.getComputedStyle(l).getPropertyValue(s);l.style.setProperty(s,`${o(Number.parseFloat(c))}px`)};this._applyManipulationCallback(e,i)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Ve.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const i=Ve.getDataAttribute(a,s);if(i===null){a.style.removeProperty(s);return}Ve.removeDataAttribute(a,s),a.style.setProperty(s,i)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Re(e)){s(e);return}for(const o of J.find(e,this._element))s(o)}}const Sf="modal",kf="bs.modal",Me=`.${kf}`,Tf=".data-api",xf="Escape",Mf=`hide${Me}`,Af=`hidePrevented${Me}`,ta=`hidden${Me}`,sa=`show${Me}`,Of=`shown${Me}`,Df=`resize${Me}`,Nf=`click.dismiss${Me}`,Lf=`mousedown.dismiss${Me}`,If=`keydown.dismiss${Me}`,Pf=`click${Me}${Tf}`,Bn="modal-open",jf="fade",qn="show",Es="modal-static",Rf=".modal.show",Vf=".modal-dialog",Hf=".modal-body",Wf='[data-bs-toggle="modal"]',Ff={backdrop:!0,focus:!0,keyboard:!0},Uf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Fe extends Ne{constructor(e,s){super(e,s),this._dialog=J.findOne(Vf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Hs,this._addEventListeners()}static get Default(){return Ff}static get DefaultType(){return Uf}static get NAME(){return Sf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||j.trigger(this._element,sa,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Bn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||j.trigger(this._element,Mf).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(qn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){j.off(window,Me),j.off(this._dialog,Me),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Zo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ea({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=J.findOne(Hf,this._dialog);s&&(s.scrollTop=0),Pt(this._element),this._element.classList.add(qn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,j.trigger(this._element,Of,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){j.on(this._element,If,e=>{if(e.key===xf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),j.on(window,Df,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),j.on(this._element,Lf,e=>{j.one(this._element,Nf,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Bn),this._resetAdjustments(),this._scrollBar.reset(),j.trigger(this._element,ta)})}_isAnimated(){return this._element.classList.contains(jf)}_triggerBackdropTransition(){if(j.trigger(this._element,Af).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Es)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Es),this._queueCallback(()=>{this._element.classList.remove(Es),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=xe()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=xe()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=Fe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}j.on(document,Pf,Wf,function(n){const e=J.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),j.one(e,sa,a=>{a.defaultPrevented||j.one(e,ta,()=>{Ct(this)&&this.focus()})});const s=J.findOne(Rf);s&&Fe.getInstance(s).hide(),Fe.getOrCreateInstance(e).toggle(this)});rs(Fe);Ae(Fe);const Bf="offcanvas",qf="bs.offcanvas",Ue=`.${qf}`,na=".data-api",zf=`load${Ue}${na}`,Kf="Escape",zn="show",Kn="showing",Gn="hiding",Gf="offcanvas-backdrop",oa=".offcanvas.show",Yf=`show${Ue}`,Jf=`shown${Ue}`,Xf=`hide${Ue}`,Yn=`hidePrevented${Ue}`,aa=`hidden${Ue}`,Qf=`resize${Ue}`,Zf=`click${Ue}${na}`,ev=`keydown.dismiss${Ue}`,tv='[data-bs-toggle="offcanvas"]',sv={backdrop:!0,keyboard:!0,scroll:!1},nv={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ke extends Ne{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return sv}static get DefaultType(){return nv}static get NAME(){return Bf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||j.trigger(this._element,Yf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Hs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Kn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(zn),this._element.classList.remove(Kn),j.trigger(this._element,Jf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||j.trigger(this._element,Xf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Gn),this._backdrop.hide();const s=()=>{this._element.classList.remove(zn,Gn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Hs().reset(),j.trigger(this._element,aa)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){j.trigger(this._element,Yn);return}this.hide()},s=!!this._config.backdrop;return new Zo({className:Gf,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new ea({trapElement:this._element})}_addEventListeners(){j.on(this._element,ev,e=>{if(e.key===Kf){if(this._config.keyboard){this.hide();return}j.trigger(this._element,Yn)}})}static jQueryInterface(e){return this.each(function(){const s=Ke.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}j.on(document,Zf,tv,function(n){const e=J.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ze(this))return;j.one(e,aa,()=>{Ct(this)&&this.focus()});const s=J.findOne(oa);s&&s!==e&&Ke.getInstance(s).hide(),Ke.getOrCreateInstance(e).toggle(this)});j.on(window,zf,()=>{for(const n of J.find(oa))Ke.getOrCreateInstance(n).show()});j.on(window,Qf,()=>{for(const n of J.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ke.getOrCreateInstance(n).hide()});rs(Ke);Ae(Ke);const ov=/^aria-[\w-]*$/i,ia={"*":["class","dir","id","lang","role",ov],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},av=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),iv=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,lv=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?av.has(s)?!!iv.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function rv(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),i=[].concat(...a.body.querySelectorAll("*"));for(const l of i){const c=l.nodeName.toLowerCase();if(!Object.keys(e).includes(c)){l.remove();continue}const d=[].concat(...l.attributes),_=[].concat(e["*"]||[],e[c]||[]);for(const r of d)lv(r,_)||l.removeAttribute(r.nodeName)}return a.body.innerHTML}const cv="TemplateFactory",dv={allowList:ia,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},uv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},mv={entry:"(string|element|function|null)",selector:"(string|element)"};class pv extends jt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return dv}static get DefaultType(){return uv}static get NAME(){return cv}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,i]of Object.entries(this._config.content))this._setContent(e,i,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},mv)}_setContent(e,s,o){const a=J.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(Re(s)){this._putElementInTemplate(qe(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?rv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ce(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const fv="tooltip",vv=new Set(["sanitize","allowList","sanitizeFn"]),Ss="fade",hv="modal",zt="show",_v=".tooltip-inner",Jn=`.${hv}`,Xn="hide.bs.modal",xt="hover",ks="focus",Ts="click",gv="manual",bv="hide",yv="hidden",$v="show",wv="shown",Cv="inserted",Ev="click",Sv="focusin",kv="focusout",Tv="mouseenter",xv="mouseleave",Mv={AUTO:"auto",TOP:"top",RIGHT:xe()?"left":"right",BOTTOM:"bottom",LEFT:xe()?"right":"left"},Av={allowList:ia,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Ov={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class St extends Ne{constructor(e,s){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Av}static get DefaultType(){return Ov}static get NAME(){return fv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),j.off(this._element.closest(Jn),Xn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=j.trigger(this._element,this.constructor.eventName($v)),o=(Po(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:i}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(i.append(a),j.trigger(this._element,this.constructor.eventName(Cv))),this._popper=this._createPopper(a),a.classList.add(zt),"ontouchstart"in document.documentElement)for(const c of[].concat(...document.body.children))j.on(c,"mouseover",es);const l=()=>{j.trigger(this._element,this.constructor.eventName(wv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||j.trigger(this._element,this.constructor.eventName(bv)).defaultPrevented)return;if(this._getTipElement().classList.remove(zt),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))j.off(a,"mouseover",es);this._activeTrigger[Ts]=!1,this._activeTrigger[ks]=!1,this._activeTrigger[xt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),j.trigger(this._element,this.constructor.eventName(yv)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Ss,zt),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=_m(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Ss),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new pv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[_v]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ss)}_isShown(){return this.tip&&this.tip.classList.contains(zt)}_createPopper(e){const s=Ce(this._config.placement,[this,e,this._element]),o=Mv[s.toUpperCase()];return Zs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ce(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ce(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")j.on(this._element,this.constructor.eventName(Ev),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[Ts]=!(a._isShown()&&a._activeTrigger[Ts]),a.toggle()});else if(s!==gv){const o=s===xt?this.constructor.eventName(Tv):this.constructor.eventName(Sv),a=s===xt?this.constructor.eventName(xv):this.constructor.eventName(kv);j.on(this._element,o,this._config.selector,i=>{const l=this._initializeOnDelegatedTarget(i);l._activeTrigger[i.type==="focusin"?ks:xt]=!0,l._enter()}),j.on(this._element,a,this._config.selector,i=>{const l=this._initializeOnDelegatedTarget(i);l._activeTrigger[i.type==="focusout"?ks:xt]=l._element.contains(i.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},j.on(this._element.closest(Jn),Xn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Ve.getDataAttributes(this._element);for(const o of Object.keys(s))vv.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:qe(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ae(St);const Dv="popover",Nv=".popover-header",Lv=".popover-body",Iv={...St.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Pv={...St.DefaultType,content:"(null|string|element|function)"};class nn extends St{static get Default(){return Iv}static get DefaultType(){return Pv}static get NAME(){return Dv}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Nv]:this._getTitle(),[Lv]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=nn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ae(nn);const jv="scrollspy",Rv="bs.scrollspy",on=`.${Rv}`,Vv=".data-api",Hv=`activate${on}`,Qn=`click${on}`,Wv=`load${on}${Vv}`,Fv="dropdown-item",ct="active",Uv='[data-bs-spy="scroll"]',xs="[href]",Bv=".nav, .list-group",Zn=".nav-link",qv=".nav-item",zv=".list-group-item",Kv=`${Zn}, ${qv} > ${Zn}, ${zv}`,Gv=".dropdown",Yv=".dropdown-toggle",Jv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Xv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class us extends Ne{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Jv}static get DefaultType(){return Xv}static get NAME(){return jv}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=qe(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(j.off(this._config.target,Qn),j.on(this._config.target,Qn,xs,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(s(l))},a=(this._rootElement||document.documentElement).scrollTop,i=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(l));continue}const c=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(i&&c){if(o(l),!a)return;continue}!i&&!c&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=J.find(xs,this._config.target);for(const s of e){if(!s.hash||ze(s))continue;const o=J.findOne(decodeURI(s.hash),this._element);Ct(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ct),this._activateParents(e),j.trigger(this._element,Hv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Fv)){J.findOne(Yv,e.closest(Gv)).classList.add(ct);return}for(const s of J.parents(e,Bv))for(const o of J.prev(s,Kv))o.classList.add(ct)}_clearActiveClass(e){e.classList.remove(ct);const s=J.find(`${xs}.${ct}`,e);for(const o of s)o.classList.remove(ct)}static jQueryInterface(e){return this.each(function(){const s=us.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}j.on(window,Wv,()=>{for(const n of J.find(Uv))us.getOrCreateInstance(n)});Ae(us);const Qv="tab",Zv="bs.tab",lt=`.${Zv}`,eh=`hide${lt}`,th=`hidden${lt}`,sh=`show${lt}`,nh=`shown${lt}`,oh=`click${lt}`,ah=`keydown${lt}`,ih=`load${lt}`,lh="ArrowLeft",eo="ArrowRight",rh="ArrowUp",to="ArrowDown",Ms="Home",so="End",tt="active",no="fade",As="show",ch="dropdown",la=".dropdown-toggle",dh=".dropdown-menu",Os=`:not(${la})`,uh='.list-group, .nav, [role="tablist"]',mh=".nav-item, .list-group-item",ph=`.nav-link${Os}, .list-group-item${Os}, [role="tab"]${Os}`,ra='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ds=`${ph}, ${ra}`,fh=`.${tt}[data-bs-toggle="tab"], .${tt}[data-bs-toggle="pill"], .${tt}[data-bs-toggle="list"]`;class yt extends Ne{constructor(e){super(e),this._parent=this._element.closest(uh),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),j.on(this._element,ah,s=>this._keydown(s)))}static get NAME(){return Qv}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?j.trigger(s,eh,{relatedTarget:e}):null;j.trigger(e,sh,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(tt),this._activate(J.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(As);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),j.trigger(e,nh,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(no))}_deactivate(e,s){if(!e)return;e.classList.remove(tt),e.blur(),this._deactivate(J.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(As);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),j.trigger(e,th,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(no))}_keydown(e){if(![lh,eo,rh,to,Ms,so].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!ze(a));let o;if([Ms,so].includes(e.key))o=s[e.key===Ms?0:s.length-1];else{const a=[eo,to].includes(e.key);o=en(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),yt.getOrCreateInstance(o).show())}_getChildren(){return J.find(Ds,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=J.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(ch))return;const a=(i,l)=>{const c=J.findOne(i,o);c&&c.classList.toggle(l,s)};a(la,tt),a(dh,As),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(tt)}_getInnerElement(e){return e.matches(Ds)?e:J.findOne(Ds,e)}_getOuterElement(e){return e.closest(mh)||e}static jQueryInterface(e){return this.each(function(){const s=yt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}j.on(document,oh,ra,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ze(this)&&yt.getOrCreateInstance(this).show()});j.on(window,ih,()=>{for(const n of J.find(fh))yt.getOrCreateInstance(n)});Ae(yt);const vh="toast",hh="bs.toast",Xe=`.${hh}`,_h=`mouseover${Xe}`,gh=`mouseout${Xe}`,bh=`focusin${Xe}`,yh=`focusout${Xe}`,$h=`hide${Xe}`,wh=`hidden${Xe}`,Ch=`show${Xe}`,Eh=`shown${Xe}`,Sh="fade",oo="hide",Kt="show",Gt="showing",kh={animation:"boolean",autohide:"boolean",delay:"number"},Th={animation:!0,autohide:!0,delay:5e3};class ms extends Ne{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Th}static get DefaultType(){return kh}static get NAME(){return vh}show(){if(j.trigger(this._element,Ch).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Sh);const s=()=>{this._element.classList.remove(Gt),j.trigger(this._element,Eh),this._maybeScheduleHide()};this._element.classList.remove(oo),Pt(this._element),this._element.classList.add(Kt,Gt),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||j.trigger(this._element,$h).defaultPrevented)return;const s=()=>{this._element.classList.add(oo),this._element.classList.remove(Gt,Kt),j.trigger(this._element,wh)};this._element.classList.add(Gt),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Kt),super.dispose()}isShown(){return this._element.classList.contains(Kt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){j.on(this._element,_h,e=>this._onInteraction(e,!0)),j.on(this._element,gh,e=>this._onInteraction(e,!1)),j.on(this._element,bh,e=>this._onInteraction(e,!0)),j.on(this._element,yh,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=ms.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}rs(ms);Ae(ms);const xh={class:"message-content-column"},Mh=["id"],Ah={class:"accordion-item"},Oh=["id"],Dh=["aria-controls"],Nh={class:"d-flex align-items-center w-100"},Lh={class:"badge bg-warning text-dark ms-auto me-2"},Ih={class:"text-muted"},Ph=["id","aria-labelledby"],jh={class:"accordion-body bg-light"},Rh={class:"alert alert-warning mb-3",role:"alert"},Vh={class:"compaction-metadata"},Hh={class:"metadata-row"},Wh={class:"metadata-row"},Fh={key:0,class:"metadata-row"},Uh={class:"continuation-content"},Bh={class:"continuation-text border rounded p-3 bg-white"},qh={class:"mb-0"},zh={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=y(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=y(()=>`heading-${s.value}`),a=y(()=>`collapse-${s.value}`),i=M(null);let l=null;me(()=>{i.value&&(l=new bt(i.value,{toggle:!1}))}),ns(()=>{l&&l.dispose()});function c(){l&&l.toggle()}const d=y(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),_=y(()=>d.value?e.messages[3]:e.messages[2]),r=y(()=>_.value?.metadata?.init_data?.compact_metadata||{}),w=y(()=>r.value.pre_tokens||0),h=y(()=>d.value?e.messages[4]:e.messages[3]),p=y(()=>h.value?.content||""),g=y(()=>{const v=e.messages[0]?.timestamp;return v?Lt(v):""});function b(v){return v?`${v.toLocaleString()} tokens`:"0 tokens"}return(v,f)=>(u(),m("div",{class:"message-row message-row-compaction",key:s.value},[f[7]||(f[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",xh,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Ah,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":a.value,onClick:c},[t("div",Nh,[f[0]||(f[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),f[1]||(f[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",Lh,S(b(w.value)),1),t("small",Ih,S(g.value),1)])],8,Dh)],8,Oh),t("div",{ref_key:"collapseElement",ref:i,id:a.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",jh,[t("div",Rh,[f[5]||(f[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),X(" Compaction Details ")],-1)),t("div",Vh,[t("div",Hh,[f[2]||(f[2]=t("strong",null,"Trigger:",-1)),t("span",null,S(r.value.trigger||"auto"),1)]),t("div",Wh,[f[3]||(f[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,S(b(w.value)),1)]),r.value.post_tokens?(u(),m("div",Fh,[f[4]||(f[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,S(b(r.value.post_tokens)),1)])):N("",!0)])]),t("div",Uh,[f[6]||(f[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),X(" Continuation Message ")],-1)),t("div",Bh,[t("pre",qh,S(p.value),1)])])])],8,Ph)])],8,Mh)])]))}},Kh=z(zh,[["__scopeId","data-v-e0b95ba8"]]),Gh={key:0,class:"text-muted text-center py-5"},Yh={__name:"MessageList",setup(n){const e=De(),s=fe(),o=M(null),a=y(()=>{const r=e.currentMessages,w=[];let h=0;for(;h<r.length;){const p=r[h];if(l(p,r,h)){const g=r[h+2],v=g?.type==="system"&&g?.metadata?.subtype==="init"?5:4,f=r.slice(h,h+v);w.push({type:"compaction",messages:f}),h+=v;continue}d(p)&&w.push({type:"message",message:p,attachedTools:[]}),h++}return i(w)});function i(r){const w=new Map,h=new Set;for(let g=0;g<r.length;g++){const b=r[g];if(b.type==="compaction")continue;const v=b.message,f=v.content&&v.content.trim().length>0&&v.content!=="Assistant response",E=v.type==="assistant"&&v.metadata?.has_tool_uses&&v.metadata?.tool_uses?.length>0;if(v.type==="assistant"&&E&&!f){let k=-1,T=!1;for(let L=g-1;L>=0;L--){const I=r[L];if(!h.has(L)){if(I.type==="message"&&I.message.type!=="assistant"){T=!0;break}if(I.type==="message"&&I.message.type==="assistant"){const x=I.message;if(x.content&&x.content.trim().length>0&&x.content!=="Assistant response"){k=L;break}else{k=L;break}}}}T&&k===-1||(T&&k>=0?(w.has(k)||w.set(k,[]),w.get(k).push(...v.metadata.tool_uses),h.add(g)):!T&&k>=0&&(w.has(k)||w.set(k,[]),w.get(k).push(...v.metadata.tool_uses),h.add(g)))}}const p=[];for(let g=0;g<r.length;g++){if(h.has(g))continue;const b=r[g];w.has(g)&&(b.attachedTools=[...b.attachedTools||[],...w.get(g)]),p.push(b)}return p}function l(r,w,h){if(h+3>=w.length)return!1;const p=w[h],g=w[h+1];let b=w[h+2],v=w[h+3],f=w[h+4];const E=p.type==="system"&&p.metadata?.subtype==="status"&&p.metadata?.init_data?.status==="compacting",k=g.type==="system"&&g.metadata?.subtype==="status"&&(g.metadata?.init_data?.status===null||g.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(h+4>=w.length)return!1;const L=!0,I=v?.type==="system"&&v?.metadata?.subtype==="compact_boundary",x=f?.type==="user"&&f?.content?.startsWith("This session is being continued from a previous conversation");return p.type==="system"&&p.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",E),console.log("  Msg2 (null status):",k),console.log("  Msg3 (init):",L),console.log("  Msg4 (boundary):",I),console.log("  Msg5 (continuation):",x)),E&&k&&L&&I&&x}else{const L=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",I=v?.type==="user"&&v?.content?.startsWith("This session is being continued from a previous conversation");return p.type==="system"&&p.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",E),console.log("  Msg2 (null status):",k),console.log("  Msg3 (boundary):",L),console.log("  Msg4 (continuation):",I)),E&&k&&L&&I}}y(()=>e.currentToolCalls);async function c(){s.autoScrollEnabled&&(await Ns(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ce(()=>a.value.length,c),ce(()=>e.currentToolCalls.length,c),ce(()=>e.currentToolCalls.map(r=>`${r.id}-${r.status}`).join(","),c),me(()=>{setTimeout(()=>{c()},100)});function d(r){const w=r.subtype||r.metadata?.subtype;if(r.type==="system"&&w==="init"||r.type==="result"||r.type==="permission_request"||r.type==="permission_response")return!1;if(r.type==="user"&&r.metadata?.has_tool_results){const h=r.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(r.type==="user"){const h=r.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(r.type==="user"){const h=r.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}return!0}function _(r){return{type:r.type||"unknown",content:r.content||"",timestamp:r.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...r.metadata}}}return(r,w)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[a.value.length===0?(u(),m("div",Gh," No messages yet. Start a conversation! ")):N("",!0),(u(!0),m(ie,null,de(a.value,(h,p)=>(u(),m(ie,{key:`item-${p}`},[h.type==="message"?(u(),ve(Tu,{key:0,message:_(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(u(),ve(Kh,{key:1,messages:h.messages},null,8,["messages"])):N("",!0)],64))),128))],512))}},Jh=z(Yh,[["__scopeId","data-v-6bae0fb1"]]),Xh={class:"border-top bg-light"},Qh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Zh={class:"d-flex gap-2 align-items-end px-2 py-1"},e_=["placeholder","disabled"],t_=["disabled"],s_={__name:"InputArea",setup(n){const e=ae(),s=je(),o=M(null),a=M(window.innerWidth),i=y({get:()=>e.currentInput,set:v=>{e.currentInput=v}}),l=y(()=>e.currentSession?.is_processing||!1),c=y(()=>s.sessionConnected),d=y(()=>e.currentSession?.state==="starting"),_=y(()=>a.value<768),r=y(()=>d.value?"Session is starting...":c.value?"Type your message to Claude Code...":"Waiting for connection...");function w(){a.value=window.innerWidth}me(()=>{window.addEventListener("resize",w)}),he(()=>{window.removeEventListener("resize",w)});function h(v){if(v.key==="Enter"&&!v.shiftKey){if(_.value)return;v.preventDefault(),g()}}function p(){const v=o.value;if(!v)return;v.style.height="auto";const f=Math.min(v.scrollHeight,parseInt(getComputedStyle(v).maxHeight));v.style.height=f+"px"}function g(){i.value.trim()&&(s.sendMessage(i.value),i.value="",o.value&&(o.value.style.height="auto"))}function b(){s.interruptSession()}return(v,f)=>(u(),m("div",Xh,[c.value?N("",!0):(u(),m("div",Qh,[...f[1]||(f[1]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),t("div",Zh,[oe(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":f[0]||(f[0]=E=>i.value=E),class:"form-control",placeholder:r.value,disabled:d.value||!c.value,rows:"1",onInput:p,onKeydown:h},null,40,e_),[[pe,i.value]]),l.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:b}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!i.value.trim()||!c.value||d.value,onClick:g}," Send ",8,t_))])]))}},n_=z(s_,[["__scopeId","data-v-ef1e5094"]]),o_={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},a_={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},i_={class:"text-secondary"},l_={class:"d-flex flex-column flex-grow-1 overflow-hidden"},ca={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=fe(),a=y(()=>s.currentSession),i=y(()=>o.isLoading),l=y(()=>o.loadingMessage);return me(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ce(()=>e.sessionId,async(c,d)=>{if(c!==d&&c!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(c)}finally{o.hideLoading()}}}),he(()=>{}),(c,d)=>(u(),m("div",o_,[i.value?(u(),m("div",a_,[d[0]||(d[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",i_,S(l.value),1)])):N("",!0),a.value?(u(),ve(Na,{key:1,"session-id":e.sessionId},null,8,["session-id"])):N("",!0),t("div",l_,[re(Jh)]),re(n_),a.value?(u(),ve(Ra,{key:2,"session-id":e.sessionId},null,8,["session-id"])):N("",!0),a.value?(u(),ve(Ka,{key:3,"session-id":e.sessionId},null,8,["session-id"])):N("",!0)]))}},Qe=$t("legion",()=>{const n=M(new Map),e=M(new Map),s=M(new Map),o=M(new Map),a=M(new Map),i=M(new Map),l=M(null),c=y(()=>n.value.get(l.value)||[]),d=y(()=>e.value.get(l.value)||[]),_=y(()=>s.value.get(l.value)||[]),r=y(()=>o.value.get(l.value)||[]);function w($){l.value=$}async function h($,C=100,A=0){try{const O=await se.get(`/api/legions/${$}/timeline?limit=${C}&offset=${A}`),P=O.comms||[],V=O.total_count||P.length,Y=O.has_more||!1;return P.sort((le,U)=>new Date(le.timestamp)-new Date(U.timestamp)),console.log(`Loaded ${P.length} of ${V} comms for legion ${$}`),n.value.set($,P),n.value=new Map(n.value),{comms:P,totalCount:V,hasMore:Y}}catch(O){throw console.error("Failed to load timeline:",O),O}}function p($,C){n.value.has($)||n.value.set($,[]);const A=n.value.get($);if(A.some(P=>P.comm_id===C.comm_id)){console.log(`Duplicate comm ${C.comm_id} prevented in timeline`);return}A.push(C),n.value=new Map(n.value),C.to_channel_id&&g(C.to_channel_id,C)}function g($,C){i.value.has($)||i.value.set($,[]);const A=i.value.get($);if(A.some(P=>P.comm_id===C.comm_id)){console.log(`Duplicate comm ${C.comm_id} prevented in channel ${$}`);return}A.push(C),i.value=new Map(i.value)}async function b($,C){try{const O=(await se.post(`/api/legions/${$}/comms`,C)).comm;return console.log(`Sent comm ${O.comm_id} to legion ${$}`),O}catch(A){throw console.error("Failed to send comm:",A),A}}async function v($){return console.log(`Minions for legion ${$} are already available in session store`),[]}async function f($,C){try{const O=(await se.post(`/api/legions/${$}/minions`,C)).minion;return await v($),console.log(`Created minion ${O.minion_id} in legion ${$}`),O}catch(A){throw console.error("Failed to create minion:",A),A}}async function E($){try{const A=(await se.get(`/api/legions/${$}/hordes`)).hordes||[];return console.log(`Loaded ${A.length} hordes for legion ${$}`),s.value.set($,A),s.value=new Map(s.value),A}catch(C){throw console.error("Failed to load hordes:",C),C}}async function k($){try{const A=(await se.get(`/api/legions/${$}/channels`)).channels||[];return console.log(`Loaded ${A.length} channels for legion ${$}`),o.value.set($,A),o.value=new Map(o.value),A}catch(C){throw console.error("Failed to load channels:",C),C}}function T($,C){o.value.has($)||o.value.set($,[]);const A=o.value.get($);if(A.some(P=>P.channel_id===C.channel_id)){console.log(`Duplicate channel ${C.channel_id} prevented`);return}A.push(C),o.value=new Map(o.value),console.log(`Added channel ${C.name} to legion ${$}`)}async function L($){try{const C=await se.get(`/api/channels/${$}`),A=C.channel||C;return console.log(`Loaded details for channel ${$}`),a.value.set($,A),a.value=new Map(a.value),A}catch(C){throw console.error("Failed to load channel details:",C),C}}async function I($,C=1e3){try{const O=(await se.get(`/api/channels/${$}/comms?limit=${C}`)).comms||[];return console.log(`Loaded ${O.length} comms for channel ${$}`),O.sort((P,V)=>new Date(P.timestamp)-new Date(V.timestamp)),i.value.set($,O),i.value=new Map(i.value),O}catch(A){throw console.error("Failed to load channel comms:",A),A}}async function x($,C){try{await se.post(`/api/channels/${$}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:C}),console.log(`Added minion ${C} to channel ${$}`),await L($)}catch(A){throw console.error("Failed to add member to channel:",A),A}}async function D($,C){try{await se.post(`/api/channels/${$}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:C}),console.log(`Removed minion ${C} from channel ${$}`),await L($)}catch(A){throw console.error("Failed to remove member from channel:",A),A}}async function B($){try{const C=await se.post(`/api/legions/${$}/halt-all`);return console.log(`Halted ${C.halted_count} of ${C.total_minions} minions in legion ${$}`),C.failed_minions&&C.failed_minions.length>0&&console.warn("Failed to halt some minions:",C.failed_minions),C}catch(C){throw console.error("Failed to halt all minions:",C),C}}async function Q($){try{const C=await se.post(`/api/legions/${$}/resume-all`);return console.log(`Resumed ${C.resumed_count} of ${C.total_minions} minions in legion ${$}`),C.failed_minions&&C.failed_minions.length>0&&console.warn("Failed to resume some minions:",C.failed_minions),C}catch(C){throw console.error("Failed to resume all minions:",C),C}}function R($){n.value.delete($),e.value.delete($),s.value.delete($),o.value.delete($),n.value=new Map(n.value),e.value=new Map(e.value),s.value=new Map(s.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:s,channelsByLegion:o,channelDetailsByChannel:a,channelCommsByChannel:i,currentLegionId:l,currentComms:c,currentMinions:d,currentHordes:_,currentChannels:r,setCurrentLegion:w,loadTimeline:h,addComm:p,addChannelComm:g,sendComm:b,loadMinions:v,createMinion:f,loadHordes:E,loadChannels:k,addChannel:T,loadChannelDetails:L,loadChannelComms:I,addMemberToChannel:x,removeMemberFromChannel:D,haltAll:B,resumeAll:Q,clearLegionData:R}}),r_=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Qe},Symbol.toStringTag,{value:"Module"})),c_={class:"timeline-header border-bottom p-3"},d_={class:"project-name"},u_=["title"],m_={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=y(()=>s.projects.get(e.legionId)),a=y(()=>o.value?.name||"Legion");return(i,l)=>(u(),m("div",c_,[t("div",null,[t("div",d_,S(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,u_)])]))}},p_=z(m_,[["__scopeId","data-v-44f386f5"]]),f_={class:"timeline-status-bar border-top p-2 bg-light"},v_={class:"d-flex justify-content-end"},h_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=fe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(u(),m("div",f_,[t("div",v_,[t("button",{class:K(["btn btn-sm",Qt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+S(Qt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},__=z(h_,[["__scopeId","data-v-891c73db"]]),g_={class:"comm-composer border-top p-3"},b_={key:0,class:"d-flex gap-2 mb-2"},y_={class:"flex-grow-1"},$_=["disabled"],w_={label:"Minions"},C_=["value"],E_={key:0,label:"Channels"},S_=["value"],k_={style:{"min-width":"150px"}},T_=["disabled"],x_={class:"d-flex gap-2 align-items-end position-relative"},M_={class:"flex-grow-1 position-relative"},A_=["disabled"],O_=["onClick","onMouseenter"],D_=["disabled"],N_={key:0},L_={key:1},I_={__name:"CommComposer",props:{legionId:{type:String,required:!0},defaultChannelId:{type:String,default:""},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Qe(),o=ae(),a=ge(),i=M(""),l=M("task"),c=M(""),d=M(!1),_=M(window.innerWidth),r=M(!1),w=M([]),h=M(0),p=M(-1),g=M(null),b=M(null),v=y(()=>_.value<768),f=y(()=>{const C=a.projects.get(e.legionId);return!C||!C.session_ids?[]:C.session_ids.map(A=>o.sessions.get(A)).filter(A=>A&&A.is_minion)}),E=y(()=>s.currentChannels||[]),k=y(()=>i.value&&c.value.trim().length>0);function T(C){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[C.state]||"â—‹"}function L(C){return C.is_minion&&C.role?`${C.name} (${C.role})`:C.name}function I(){const C=g.value;if(!C)return;C.style.height="auto";const A=Math.min(C.scrollHeight,parseInt(getComputedStyle(C).maxHeight));C.style.height=A+"px"}function x(){const C=g.value;if(!C)return;I();const A=c.value,O=C.selectionStart,P=A.substring(0,O),V=P.lastIndexOf("#");if(V===-1){r.value=!1;return}const Y=P.substring(V+1).toLowerCase();if(Y.includes(" ")){r.value=!1;return}const le=f.value.filter(U=>U.name.toLowerCase().includes(Y)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(le.length===0){r.value=!1;return}w.value=le,h.value=0,p.value=V,r.value=!0}function D(){if(!b.value)return;const C=b.value,A=C.children[h.value];if(!A)return;const O=A.offsetTop,P=A.offsetHeight,V=C.scrollTop,Y=C.clientHeight;O<V?C.scrollTop=O:O+P>V+Y&&(C.scrollTop=O+P-Y)}function B(C){if(!r.value){if(C.key==="Enter"&&!C.shiftKey){if(v.value)return;k.value&&(C.preventDefault(),R())}return}if(C.key==="ArrowDown")C.preventDefault(),h.value=(h.value+1)%w.value.length,D();else if(C.key==="ArrowUp")C.preventDefault(),h.value=h.value===0?w.value.length-1:h.value-1,D();else if(C.key==="Enter"){C.preventDefault();const A=w.value[h.value];A&&Q(A)}else C.key==="Escape"&&(r.value=!1)}function Q(C){const A=g.value;if(!A)return;const O=c.value,P=A.selectionStart,V=O.substring(0,p.value)+"#"+C.name+" "+O.substring(P);c.value=V;const Y=p.value+C.name.length+2;setTimeout(()=>{A.setSelectionRange(Y,Y),A.focus()},0),r.value=!1}async function R(){if(!(!k.value||d.value)){d.value=!0;try{const[C,A]=i.value.split(":"),O={comm_type:l.value,content:c.value.trim()};C==="minion"?O.to_minion_id=A:C==="channel"&&(O.to_channel_id=A),await s.sendComm(e.legionId,O),c.value="",I()}catch(C){console.error("Failed to send comm:",C),alert(`Failed to send comm: ${C.message}`)}finally{d.value=!1}}}function $(){_.value=window.innerWidth}return me(()=>{window.addEventListener("resize",$)}),he(()=>{window.removeEventListener("resize",$)}),ce(()=>e.defaultChannelId,C=>{C&&(i.value=`channel:${C}`)},{immediate:!0}),ce(r,C=>{if(C){const A=O=>{O.target.closest(".comm-composer")||(r.value=!1,document.removeEventListener("click",A))};setTimeout(()=>document.addEventListener("click",A),0)}}),(C,A)=>(u(),m("div",g_,[n.hideRecipientSelector?N("",!0):(u(),m("div",b_,[t("div",y_,[oe(t("select",{"onUpdate:modelValue":A[0]||(A[0]=O=>i.value=O),class:"form-select form-select-sm",disabled:d.value},[A[3]||(A[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",w_,[(u(!0),m(ie,null,de(f.value,O=>(u(),m("option",{key:O.session_id,value:`minion:${O.session_id}`},S(T(O))+" "+S(L(O)),9,C_))),128))]),E.value.length>0?(u(),m("optgroup",E_,[(u(!0),m(ie,null,de(E.value,O=>(u(),m("option",{key:O.channel_id,value:`channel:${O.channel_id}`}," #ï¸âƒ£ "+S(O.name),9,S_))),128))])):N("",!0)],8,$_),[[Oe,i.value]])]),t("div",k_,[oe(t("select",{"onUpdate:modelValue":A[1]||(A[1]=O=>l.value=O),class:"form-select form-select-sm",disabled:d.value},[...A[4]||(A[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,T_),[[Oe,l.value]])])])),t("div",x_,[t("div",M_,[oe(t("textarea",{ref_key:"contentTextarea",ref:g,"onUpdate:modelValue":A[2]||(A[2]=O=>c.value=O),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:d.value,onInput:x,onKeydown:B},null,40,A_),[[pe,c.value]]),r.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(ie,null,de(w.value,(O,P)=>(u(),m("div",{key:O.id,class:K(["autocomplete-item px-2 py-1",{"bg-light":P===h.value}]),onClick:V=>Q(O),onMouseenter:V=>h.value=P},S(O.type==="minion"?T(O):"#ï¸âƒ£")+" "+S(O.name)+S(O.role?` (${O.role})`:""),43,O_))),128))],512)):N("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!k.value||d.value,onClick:R},[d.value?(u(),m("span",N_,[...A[5]||(A[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),X(" Sending... ",-1)])])):(u(),m("span",L_,"Send"))],8,D_)])])]))}},da=z(I_,[["__scopeId","data-v-fb6899a3"]]),P_={class:"message-content-column-full"},j_=["aria-expanded"],R_={class:"comm-sender-recipient"},V_={class:"comm-badge-summary"},H_=["title"],W_={class:"comm-summary-text text-muted ms-2"},F_=["aria-label"],U_={key:0,class:"comm-content-body"},B_=["innerHTML"],q_="ffffffff-ffff-ffff-ffff-ffffffffffff",z_={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;nt.setOptions({breaks:!0,gfm:!0});const s=M(!1);function o(){s.value=!s.value}const a=y(()=>e.comm.from_minion_id===q_);y(()=>new Date(e.comm.timestamp*1e3).toLocaleTimeString());const i=y(()=>{const _=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${_.toLocaleString()}`}),l=y(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),c=y(()=>{if(e.comm.summary)return e.comm.summary;const _=e.comm.content||"";return _.length>100?_.substring(0,100)+"...":_}),d=y(()=>{const _=e.comm.content||"";let r=nt.parse(_);return r=r.replace(/\n</g,"<"),r=r.replace(/\n+$/,""),os.sanitize(r)});return(_,r)=>(u(),m("div",{class:K(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",P_,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",R_,[t("strong",{class:K({"system-sender":a.value})},S(n.senderName),3),n.recipientName?(u(),m(ie,{key:0},[r[0]||(r[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",{class:K({"recipient-channel":n.comm.to_channel_id})},S(n.recipientName),3)],64)):N("",!0)]),t("div",V_,[t("span",{class:K(["badge",l.value]),title:i.value},S(n.comm.comm_type),11,H_),t("span",W_,S(c.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},S(s.value?"â–¾":"â–¸"),9,F_)],8,j_),s.value?(u(),m("div",U_,[t("div",{class:"message-text",innerHTML:d.value},null,8,B_)])):N("",!0)])],2))}},ua=z(z_,[["__scopeId","data-v-f0417455"]]),K_={class:"timeline-view d-flex flex-column h-100"},G_={key:0,class:"text-center text-muted"},Y_={key:1,class:"text-center text-danger"},J_={key:2,class:"text-center text-muted"},X_={key:3,class:"comm-list"},Q_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Qe(),o=ge(),a=ae(),i=je(),l=fe(),c=M(!0),d=M(null),_=M(null),r=y(()=>o.projects.get(e.legionId));y(()=>r.value?.name||"Legion");const w=y(()=>s.currentComms);y(()=>s.currentMinions);function h(E){return E.from_user?"You":E.from_minion_id?E.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":a.sessions.get(E.from_minion_id)?.name||"Unknown":"Unknown"}function p(E){if(E.to_user)return"You";if(E.to_minion_id)return a.sessions.get(E.to_minion_id)?.name||"Unknown";if(E.to_channel_id){if(E.to_channel_name)return`#${E.to_channel_name}`;const k=s.channelsByLegion.get(e.legionId)?.find(T=>T.channel_id===E.to_channel_id);return k?.name?`#${k.name}`:E.to_channel_id}return"All"}async function g(){l.autoScrollEnabled&&(await Ns(),_.value&&(_.value.scrollTop=_.value.scrollHeight))}async function b(){c.value=!0,d.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Ns(),await g(),setTimeout(()=>{g()},100)}catch(E){console.error("Failed to load timeline:",E),E.response?d.value=`${E.message} (${E.response.status})`:d.value=E.message||"Unknown error"}finally{c.value=!1}}function v(){i.connectLegion(e.legionId)}function f(){i.disconnectLegion()}return ce(()=>w.value.length,()=>{g()}),me(()=>{b(),v(),setTimeout(()=>{g()},100)}),he(()=>{f()}),(E,k)=>(u(),m("div",K_,[re(p_,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:_,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(u(),m("div",G_,[...k[0]||(k[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),X(" Loading timeline... ",-1)])])):d.value?(u(),m("div",Y_," Failed to load timeline: "+S(d.value),1)):w.value.length===0?(u(),m("div",J_," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",X_,[(u(!0),m(ie,null,de(w.value,T=>(u(),ve(ua,{key:T.comm_id,comm:T,"sender-name":h(T),"recipient-name":p(T)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),re(da,{"legion-id":n.legionId},null,8,["legion-id"]),re(__,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Z_=z(Q_,[["__scopeId","data-v-3308d82d"]]),eg={class:"spy-view d-flex flex-column overflow-hidden"},tg={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){const e=n,s=je();return me(()=>{s.connectLegion(e.legionId)}),ns(()=>{s.disconnectLegion()}),(o,a)=>(u(),m("div",eg,[re(ca,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},sg=z(tg,[["__scopeId","data-v-21206f91"]]),ng={class:"horde-header border-bottom p-3"},og={class:"d-flex justify-content-between align-items-center"},ag={class:"project-name"},ig={class:"fleet-controls d-flex gap-2"},lg=["disabled"],rg={key:0,class:"spinner-border spinner-border-sm me-1"},cg=["disabled"],dg={key:0,class:"spinner-border spinner-border-sm me-1"},ug={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=ae(),a=fe(),i=y(()=>s.projects.get(e.legionId)),l=y(()=>i.value?.name||"Legion"),c=y(()=>Array.from(o.sessions.values()).filter(g=>g.is_minion&&g.project_id===e.legionId)),d=y(()=>c.value.filter(p=>p.state==="active")),_=y(()=>c.value.length===0||d.value.length===0),r=y(()=>c.value.length===0);function w(){a.showModal("fleet-control",{legionId:e.legionId,operation:"halt",activeMinionsCount:d.value.length,totalMinionsCount:c.value.length})}function h(){a.showModal("fleet-control",{legionId:e.legionId,operation:"resume",activeMinionsCount:d.value.length,totalMinionsCount:c.value.length})}return(p,g)=>(u(),m("div",ng,[t("div",og,[t("div",null,[t("div",ag,S(l.value),1),g[0]||(g[0]=t("div",{class:"view-name"},"Minion Hierarchy",-1))]),t("div",ig,[t("button",{class:"btn btn-sm btn-outline-warning",disabled:_.value||p.isOperating,onClick:w,title:"Emergency halt all active minions"},[p.isOperating&&p.lastOperation==="halt"?(u(),m("span",rg)):N("",!0),g[1]||(g[1]=X(" Halt All ",-1))],8,lg),t("button",{class:"btn btn-sm btn-outline-success",disabled:r.value||p.isOperating,onClick:h,title:"Resume all minions"},[p.isOperating&&p.lastOperation==="resume"?(u(),m("span",dg)):N("",!0),g[2]||(g[2]=X(" Resume All ",-1))],8,cg)])])]))}},mg=z(ug,[["__scopeId","data-v-11702b07"]]),pg={class:"horde-status-bar border-top p-2 bg-light"},fg={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,s)=>(u(),m("div",pg,[...s[0]||(s[0]=[t("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},vg=z(fg,[["__scopeId","data-v-f0e64ab0"]]),hg={class:"minion-card border-start border-2 mb-2"},_g={class:"node-row"},gg={class:"node-left"},bg={key:0,class:"me-2"},yg={key:1,class:"badge bg-secondary ms-2"},$g={class:"node-right"},wg={key:0,class:"last-comm-preview"},Cg={class:"comm-direction"},Eg=["title"],Sg={key:1,class:"text-muted fst-italic small"},kg={key:0,class:"minion-children"},Tg={key:1,class:"text-danger small ms-4"},xg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,s=y(()=>e.level*24),o=y(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),a=y(()=>e.minionData&&e.minionData.is_overseer&&o.value),i=y(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),l=y(()=>{const r=i.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[r]||"status-dot-grey"}),c=y(()=>{const r=i.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[r]||"#d3d3d3"}});function d(r){return r.to_user?"User":r.to_minion_name?r.to_minion_name:r.to_channel_name?`#${r.to_channel_name}`:"unknown"}function _(r){const w=r.summary||r.content||"";return w.length>150?w.substring(0,150)+"...":w}return(r,w)=>{const h=io("MinionTreeNode",!0);return n.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:He({marginLeft:`${s.value}px`})},[t("div",hg,[t("div",_g,[t("div",gg,[t("div",{class:K(["status-dot me-2",l.value]),style:He(c.value)},null,6),a.value?(u(),m("span",bg,"ðŸ‘‘")):N("",!0),t("strong",null,S(n.minionData.name),1),a.value?(u(),m("span",yg,S(n.minionData.children.length)+" "+S(n.minionData.children.length===1?"child":"children"),1)):N("",!0)]),t("div",$g,[n.minionData.last_comm?(u(),m("div",wg,[t("span",Cg,[w[0]||(w[0]=X(" â†’ ",-1)),t("strong",null,S(d(n.minionData.last_comm)),1),w[1]||(w[1]=X(": ",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},S(_(n.minionData.last_comm)),9,Eg)])):(u(),m("div",Sg," No communications yet "))])])]),o.value?(u(),m("div",kg,[(u(!0),m(ie,null,de(n.minionData.children,p=>(u(),ve(h,{key:p.id,"minion-data":p,level:n.level+1},null,8,["minion-data","level"]))),128))])):N("",!0)],4)):(u(),m("div",Tg," âš  Minion data is missing "))}}},Mg=z(xg,[["__scopeId","data-v-1cd9863f"]]),Ag={class:"modal-dialog modal-dialog-centered"},Og={class:"modal-content"},Dg={class:"modal-header"},Ng={class:"modal-title",id:"fleetControlModalLabel"},Lg={class:"modal-body"},Ig={key:0,class:"text-center py-4"},Pg={class:"text-muted"},jg={key:1},Rg={class:"text-muted"},Vg={key:2},Hg={class:"text-muted"},Wg={key:3},Fg={class:"text-muted"},Ug={class:"modal-footer"},Bg={key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},qg={__name:"FleetControlModal",setup(n){const e=fe(),s=Qe(),o=M(!1),a=M(""),i=M(null),l=M(null),c=M(null);let d=null;const _=M(null),r=M(0),w=M(0),h=y(()=>l.value?l.value.type==="success"?"Success":"Error":i.value==="halt"?"Emergency Halt All Minions":i.value==="resume"?"Resume All Minions":"Fleet Control");me(()=>{c.value&&(d=new Fe(c.value),c.value.addEventListener("hidden.bs.modal",()=>{i.value=null,l.value=null,o.value=!1}))}),he(()=>{d&&d.dispose()}),ce(()=>e.currentModal,f=>{if(!f||f.name!=="fleet-control")return;const E=f.data;E&&(_.value=E.legionId,r.value=E.activeMinionsCount||0,w.value=E.totalMinionsCount||0,i.value=E.operation,l.value=null,d&&d.show())});function p(){i.value=null,d&&d.hide()}async function g(){i.value==="halt"?await b():i.value==="resume"&&await v()}async function b(){o.value=!0,a.value="Halting all minions...";try{const f=await s.haltAll(_.value),E=f.failed_minions&&f.failed_minions.length>0?` Failed to halt ${f.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Halt Complete",message:`Halted ${f.halted_count} of ${f.total_minions} minion(s).${E}`}}catch(f){console.error("Failed to halt all minions:",f),l.value={type:"error",title:"Halt Failed",message:`Failed to halt minions: ${f.message||"Unknown error"}`}}finally{o.value=!1,i.value=null}}async function v(){o.value=!0,a.value="Resuming all minions...";try{const f=await s.resumeAll(_.value),E=f.failed_minions&&f.failed_minions.length>0?` Failed to resume ${f.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Resume Complete",message:`Resumed ${f.resumed_count} of ${f.total_minions} minion(s).${E}`}}catch(f){console.error("Failed to resume all minions:",f),l.value={type:"error",title:"Resume Failed",message:`Failed to resume minions: ${f.message||"Unknown error"}`}}finally{o.value=!1,i.value=null}}return(f,E)=>(u(),m("div",{class:"modal fade",id:"fleetControlModal",tabindex:"-1","aria-labelledby":"fleetControlModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",Ag,[t("div",Og,[t("div",Dg,[t("h5",Ng,S(h.value),1),E[0]||(E[0]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",Lg,[o.value?(u(),m("div",Ig,[E[1]||(E[1]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Processing...")],-1)),t("p",Pg,S(a.value),1)])):l.value?(u(),m("div",jg,[t("div",{class:K(["alert mb-3",l.value.type==="success"?"alert-success":"alert-danger"])},[t("strong",null,S(l.value.title),1)],2),t("p",Rg,S(l.value.message),1)])):i.value==="halt"?(u(),m("div",Vg,[E[4]||(E[4]=t("div",{class:"alert alert-warning mb-3"},[t("strong",null,"âš ï¸ Emergency Halt")],-1)),t("p",Hg,[E[2]||(E[2]=X(" Are you sure you want to halt all ",-1)),t("strong",null,S(r.value),1),E[3]||(E[3]=X(" active minion(s) in this legion? ",-1))]),E[5]||(E[5]=t("p",{class:"text-muted"}," This will interrupt their current processing. Minions will remain in ACTIVE state but will stop processing. ",-1))])):i.value==="resume"?(u(),m("div",Wg,[E[8]||(E[8]=t("div",{class:"alert alert-info mb-3"},[t("strong",null,"Resume All Minions")],-1)),t("p",Fg,[E[6]||(E[6]=X(' This will send "continue" to all ',-1)),t("strong",null,S(w.value),1),E[7]||(E[7]=X(" minion(s) in this legion. ",-1))]),E[9]||(E[9]=t("p",{class:"text-muted"}," Minions will resume processing from where they were interrupted. ",-1))])):N("",!0)]),t("div",Ug,[l.value?(u(),m("button",Bg,"OK")):i.value&&!o.value?(u(),m(ie,{key:1},[t("button",{type:"button",class:"btn btn-secondary",onClick:p},"Cancel"),t("button",{type:"button",class:K(["btn",i.value==="halt"?"btn-warning":"btn-success"]),onClick:g},S(i.value==="halt"?"Halt All":"Resume All"),3)],64)):N("",!0)])])])],512))}},zg=z(qg,[["__scopeId","data-v-53a63f8d"]]),Kg={class:"horde-view d-flex flex-column h-100"},Gg={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},Yg={key:0,class:"text-center py-5"},Jg={key:1,class:"alert alert-danger"},Xg={class:"mb-0"},Qg={key:2,class:"horde-tree"},Zg={class:"user-root-node mb-3 border rounded bg-white"},eb={class:"node-row"},tb={class:"node-left"},sb={key:0,class:"badge bg-primary ms-2"},nb={class:"node-right"},ob={key:0,class:"last-comm-preview"},ab={class:"comm-direction"},ib=["title"],lb={key:1,class:"text-muted fst-italic"},rb={key:0,class:"alert alert-info ms-4"},cb={key:1,class:"root-minions ms-4"},db={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=ae(),a=je(),i=Qe(),l=M(null),c=M(!1),d=M(null);y(()=>s.projects.get(e.legionId));const _=y(()=>l.value&&l.value.children&&l.value.children.length>0);async function r(){c.value=!0,d.value=null;try{const b=await se.get(`/api/legions/${e.legionId}/hordes`);l.value=b,console.log("Loaded hierarchy:",b)}catch(b){console.error("Failed to load hierarchy:",b),d.value=b.message||"Unknown error"}finally{c.value=!1}}me(()=>{r()}),ce(()=>e.legionId,()=>{r()});function w(b){return b.to_user?"User":b.to_minion_name?b.to_minion_name:b.to_channel_name?`#${b.to_channel_name}`:"unknown"}function h(b){const v=b.summary||b.content||"";return v.length>150?v.substring(0,150)+"...":v}function p(b,v){if(b.id===v)return b;if(b.children)for(const f of b.children){const E=p(f,v);if(E)return E}return null}function g(b){if(l.value){if(b.from_minion_id){const v=p(l.value,b.from_minion_id);v&&v.type==="minion"&&(v.last_comm=b,console.log(`Updated minion ${v.name} last_comm`))}b.from_user&&l.value.type==="user"&&(l.value.last_comm=b,console.log("Updated user last_comm"))}}return me(()=>{r(),i.setCurrentLegion(e.legionId),a.connectLegion(e.legionId),ce(()=>o.sessions,b=>{if(l.value){for(const[v,f]of b)if(f.is_minion&&f.project_id===e.legionId){const E=p(l.value,v);E&&E.type==="minion"&&(E.state!==f.state&&(E.state=f.state,console.log(`Updated minion ${E.name} state to ${f.state}`)),E.is_processing!==f.is_processing&&(E.is_processing=f.is_processing,console.log(`Updated minion ${E.name} is_processing to ${f.is_processing}`)))}}},{deep:!0}),ce(()=>i.commsByLegion.get(e.legionId),b=>{if(b&&b.length>0){const v=b[b.length-1];g(v)}},{deep:!0}),ce(()=>o.sessions.size,(b,v)=>{b>v&&Array.from(o.sessions.values()).some(k=>k.is_minion&&k.project_id===e.legionId&&!p(l.value,k.session_id))&&(console.log("New minion detected, reloading hierarchy"),r())})}),he(()=>{console.log("HordeView unmounted")}),(b,v)=>(u(),m("div",Kg,[re(mg,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",Gg,[c.value?(u(),m("div",Yg,[...v[0]||(v[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):d.value?(u(),m("div",Jg,[v[1]||(v[1]=t("strong",null,"Failed to load hierarchy",-1)),t("p",Xg,S(d.value),1)])):l.value?(u(),m("div",Qg,[t("div",Zg,[t("div",eb,[t("div",tb,[v[2]||(v[2]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,S(l.value.name),1),_.value?(u(),m("span",sb,S(l.value.children.length)+" "+S(l.value.children.length===1?"minion":"minions"),1)):N("",!0)]),t("div",nb,[l.value.last_comm?(u(),m("div",ob,[t("span",ab,[v[3]||(v[3]=X(" â†’ ",-1)),t("strong",null,S(w(l.value.last_comm)),1),v[4]||(v[4]=X(": ",-1))]),t("span",{class:"comm-content",title:l.value.last_comm.content||""},S(h(l.value.last_comm)),9,ib)])):(u(),m("div",lb," No communications yet "))])])]),_.value?(u(),m("div",cb,[(u(!0),m(ie,null,de(l.value.children,f=>(u(),ve(Mg,{key:f.id,"minion-data":f,level:1},null,8,["minion-data"]))),128))])):(u(),m("div",rb,[...v[5]||(v[5]=[t("p",{class:"mb-2"},"No minions yet",-1),t("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):N("",!0)]),re(vg,{"legion-id":n.legionId},null,8,["legion-id"]),re(zg)]))}},ub=z(db,[["__scopeId","data-v-268a223f"]]),mb={class:"channel-status-bar d-flex gap-2"},pb={class:"button-label"},fb={__name:"ChannelStatusBar",props:{channel:{type:Object,required:!0},members:{type:Array,default:()=>[]},legionId:{type:String,required:!0}},setup(n){const e=n,s=fe(),o=y(()=>e.members?.length||0);function a(){s.showModal("channel-info",{channel:e.channel})}function i(){s.showModal("channel-members",{channel:e.channel,members:e.members,legionId:e.legionId,channelId:e.channel.channel_id})}return(l,c)=>(u(),m("div",mb,[t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:a,title:"View channel information"},[...c[0]||(c[0]=[t("span",{class:"button-icon"},"ðŸ“‹",-1),t("span",{class:"button-label"},"Info",-1)])]),t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:i,title:"View channel members"},[c[1]||(c[1]=t("span",{class:"button-icon"},"ðŸ‘¥",-1)),t("span",pb,"Members ("+S(o.value)+")",1)])]))}},vb=z(fb,[["__scopeId","data-v-f497955c"]]),hb={class:"modal-dialog modal-dialog-centered"},_b={class:"modal-content"},gb={class:"modal-body"},bb={key:0},yb={class:"info-section"},$b={class:"info-value"},wb={class:"info-section"},Cb={class:"info-value"},Eb={key:0,class:"info-section"},Sb={class:"info-value"},kb={class:"info-section"},Tb={class:"info-value"},xb={class:"info-section"},Mb={class:"info-value"},Ab={class:"info-section"},Ob={class:"info-value"},Db={style:{"font-size":"0.85rem"}},Nb={key:1,class:"text-muted text-center py-3"},Lb={__name:"ChannelInfoModal",setup(n){const e=fe(),s=M(null);let o=null;const a=M(null);ce(()=>e.currentModal,l=>{l?.name==="channel-info"&&o&&(a.value=l.data?.channel||null,o.show())});function i(l){if(!l)return"Unknown";try{return new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return l}}return me(()=>{if(s.value){const l=window.bootstrap;l&&l.Modal&&(o=new l.Modal(s.value),s.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),a.value=null}))}}),ns(()=>{o&&o.dispose()}),(l,c)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",id:"channelInfoModal",tabindex:"-1","aria-labelledby":"channelInfoModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",hb,[t("div",_b,[c[6]||(c[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelInfoModalLabel"},"Channel Information"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",gb,[a.value?(u(),m("div",bb,[t("div",yb,[c[0]||(c[0]=t("label",null,"Channel Name",-1)),t("div",$b,S(a.value.name),1)]),t("div",wb,[c[1]||(c[1]=t("label",null,"Purpose",-1)),t("div",Cb,S(a.value.purpose||"No purpose specified"),1)]),a.value.description&&a.value.description!==a.value.purpose?(u(),m("div",Eb,[c[2]||(c[2]=t("label",null,"Description",-1)),t("div",Sb,S(a.value.description),1)])):N("",!0),t("div",kb,[c[3]||(c[3]=t("label",null,"Created",-1)),t("div",Tb,S(i(a.value.created_at)),1)]),t("div",xb,[c[4]||(c[4]=t("label",null,"Members",-1)),t("div",Mb,S(a.value.member_minion_ids?.length||0)+" member(s)",1)]),t("div",Ab,[c[5]||(c[5]=t("label",null,"Channel ID",-1)),t("div",Ob,[t("code",Db,S(a.value.channel_id),1)])])])):(u(),m("div",Nb," No channel data available "))]),c[7]||(c[7]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},Ib=z(Lb,[["__scopeId","data-v-3d7eceff"]]),Pb={class:"modal-dialog modal-dialog-centered"},jb={class:"modal-content"},Rb={class:"modal-body"},Vb={class:"mb-3"},Hb=["disabled"],Wb={key:0,class:"text-muted ms-2"},Fb={key:1,class:"mt-2"},Ub=["disabled"],Bb=["value"],qb={key:0,class:"text-muted small mt-1"},zb={key:0,class:"member-count"},Kb={key:1,class:"member-list"},Gb={class:"member-info"},Yb={class:"member-name"},Jb={key:0,class:"member-role"},Xb={class:"member-state"},Qb={class:"status-text"},Zb=["onClick","disabled"],ey={key:2,class:"empty-state text-center py-4"},ty={__name:"ChannelMembersModal",setup(n){const e=fe(),s=Qe(),o=ae(),a=ge(),i=M(null);let l=null;const c=M(null),d=M([]),_=M(null),r=M(null),w=M(""),h=M(!1),p=M(!1),g=M(!1),b=y(()=>{if(!_.value)return[];const L=a.projects.get(_.value);if(!L||!L.session_ids)return[];const I=L.session_ids.map(D=>o.sessions.get(D)).filter(Boolean),x=new Set(d.value.map(D=>D.session_id));return I.filter(D=>!x.has(D.session_id))});ce(()=>e.currentModal,L=>{L?.name==="channel-members"&&l&&(c.value=L.data?.channel||null,d.value=L.data?.members||[],_.value=L.data?.legionId||null,r.value=L.data?.channelId||null,h.value=!1,w.value="",l.show())});function v(L){return L==="processing"||L==="starting"?"status-blinking":""}function f(L){return{backgroundColor:{created:"#6c757d",starting:"#28a745",active:"#28a745",processing:"#da70d6",paused:"#ffc107",error:"#dc3545",terminated:"#6c757d"}[L]||"#6c757d"}}function E(L){return L?L.charAt(0).toUpperCase()+L.slice(1).replace(/_/g," "):"Unknown"}async function k(){if(!(!w.value||!r.value)){p.value=!0;try{await s.addMemberToChannel(r.value,w.value);const L=await s.loadChannelDetails(r.value);L?.member_minion_ids&&(d.value=L.member_minion_ids.map(I=>o.sessions.get(I)).filter(Boolean)),w.value="",h.value=!1}catch(L){console.error("Failed to add member:",L),alert(`Failed to add member: ${L.message}`)}finally{p.value=!1}}}async function T(L){if(!L||!r.value)return;const I=d.value.find(x=>x.session_id===L);if(confirm(`Remove ${I?.name||"this member"} from the channel?`)){g.value=!0;try{await s.removeMemberFromChannel(r.value,L);const x=await s.loadChannelDetails(r.value);x?.member_minion_ids&&(d.value=x.member_minion_ids.map(D=>o.sessions.get(D)).filter(Boolean))}catch(x){console.error("Failed to remove member:",x),alert(`Failed to remove member: ${x.message}`)}finally{g.value=!1}}}return me(()=>{if(i.value){const L=window.bootstrap;L&&L.Modal&&(l=new L.Modal(i.value),i.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),c.value=null,d.value=[]}))}}),ns(()=>{l&&l.dispose()}),(L,I)=>(u(),m("div",{ref_key:"modalElement",ref:i,class:"modal fade",id:"channelMembersModal",tabindex:"-1","aria-labelledby":"channelMembersModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",Pb,[t("div",jb,[I[5]||(I[5]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelMembersModalLabel"},"Channel Members"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Rb,[t("div",Vb,[t("button",{class:"btn btn-sm btn-primary",onClick:I[0]||(I[0]=x=>h.value=!h.value),disabled:p.value||b.value.length===0}," âž• Add Member ",8,Hb),b.value.length===0?(u(),m("small",Wb," (All minions are already members) ")):N("",!0),h.value&&b.value.length>0?(u(),m("div",Fb,[oe(t("select",{"onUpdate:modelValue":I[1]||(I[1]=x=>w.value=x),class:"form-select form-select-sm",onChange:k,disabled:p.value},[I[2]||(I[2]=t("option",{value:""},"-- Select minion to add --",-1)),(u(!0),m(ie,null,de(b.value,x=>(u(),m("option",{key:x.session_id,value:x.session_id},S(x.name)+" "+S(x.role?`(${x.role})`:"(No role)"),9,Bb))),128))],40,Ub),[[Oe,w.value]]),p.value?(u(),m("div",qb,[...I[3]||(I[3]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),X(" Adding member... ",-1)])])):N("",!0)])):N("",!0)]),d.value&&d.value.length>0?(u(),m("p",zb,S(d.value.length)+" "+S(d.value.length===1?"member":"members"),1)):N("",!0),d.value&&d.value.length>0?(u(),m("div",Kb,[(u(!0),m(ie,null,de(d.value,x=>(u(),m("div",{key:x.session_id,class:"member-item"},[t("div",Gb,[t("div",Yb,S(x.name),1),x.role?(u(),m("div",Jb,S(x.role),1)):N("",!0),t("div",Xb,[t("span",{class:K(["status-dot",v(x.state)]),style:He(f(x.state))},null,6),t("span",Qb,S(E(x.state)),1)])]),t("button",{class:"btn btn-sm btn-outline-danger",onClick:D=>T(x.session_id),disabled:g.value,title:"Remove from channel"}," ðŸ—‘ï¸ ",8,Zb)]))),128))])):(u(),m("div",ey,[...I[4]||(I[4]=[t("p",{class:"text-muted mb-0"},"No members in this channel yet.",-1)])]))]),I[6]||(I[6]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},sy=z(ty,[["__scopeId","data-v-28fb4eaa"]]),ny={class:"channel-view d-flex flex-column h-100"},oy={class:"channel-header border-bottom p-3"},ay={class:"d-flex align-items-center justify-content-between"},iy={class:"mb-0"},ly={class:"text-muted"},ry={class:"badge bg-secondary"},cy={class:"channel-content flex-grow-1 overflow-auto"},dy={key:0,class:"text-center text-muted py-4"},uy={key:1,class:"text-center text-danger py-4"},my={key:2,class:"text-center text-muted py-4"},py={key:3,class:"pb-5"},fy={class:"comms-section"},vy={class:"text-muted border-bottom pb-2 px-3"},hy={key:0,class:"text-center text-muted py-4"},_y={key:1,class:"text-center text-muted py-3"},gy={key:2,class:"comm-list"},by={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,s=Qe(),o=ge(),a=ae(),i=je(),l=M(!0),c=M(null),d=M(!1),_=y(()=>o.projects.get(e.legionId)),r=y(()=>s.channelDetailsByChannel.get(e.channelId)),w=y(()=>s.channelCommsByChannel.get(e.channelId)||[]),h=y(()=>r.value?.member_minion_ids?.length||0),p=y(()=>w.value.length),g=y(()=>r.value?.member_minion_ids?r.value.member_minion_ids.map(k=>a.sessions.get(k)).filter(Boolean):[]);function b(k){return k.from_user?"You":k.from_minion_name?k.from_minion_name:k.from_minion_id&&a.sessions.get(k.from_minion_id)?.name||"Unknown"}function v(k){return""}function f(){i.connectLegion(e.legionId)}function E(){i.disconnectLegion()}return me(async()=>{l.value=!0;try{s.setCurrentLegion(e.legionId),await s.loadChannels(e.legionId),await s.loadChannelDetails(e.channelId),d.value=!0,await s.loadChannelComms(e.channelId,1e3),d.value=!1}catch(k){console.error("Failed to load channel:",k),c.value=k.message||"Unknown error"}finally{l.value=!1}f()}),ce(()=>e.channelId,async k=>{if(k){l.value=!0,c.value=null;try{s.setCurrentLegion(e.legionId),await s.loadChannels(e.legionId),await s.loadChannelDetails(k),d.value=!0,await s.loadChannelComms(k,1e3),d.value=!1}catch(T){console.error("Failed to load channel:",T),c.value=T.message||"Unknown error"}finally{l.value=!1}}}),he(()=>{E()}),(k,T)=>(u(),m("div",ny,[t("div",oy,[t("div",ay,[t("div",null,[t("h5",iy," ðŸ’¬ "+S(r.value?.name||"Channel"),1),t("small",ly,S(_.value?.name||"Legion"),1)]),t("span",ry,S(h.value)+" members",1)])]),t("div",cy,[l.value?(u(),m("div",dy,[...T[0]||(T[0]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading channel...",-1)])])):c.value?(u(),m("div",uy," Failed to load channel: "+S(c.value),1)):r.value?(u(),m("div",py,[t("div",fy,[t("h6",vy,"Communications ("+S(p.value)+")",1),d.value?(u(),m("div",hy,[...T[1]||(T[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading comms...",-1)])])):w.value.length===0?(u(),m("div",_y," No communications in this channel yet ")):(u(),m("div",gy,[(u(!0),m(ie,null,de(w.value,L=>(u(),ve(ua,{key:L.comm_id,comm:L,"sender-name":b(L),"recipient-name":v()},null,8,["comm","sender-name","recipient-name"]))),128))]))])])):(u(),m("div",my," Channel not found "))]),r.value?(u(),ve(da,{key:0,"legion-id":n.legionId,"default-channel-id":n.channelId,"hide-recipient-selector":!0},null,8,["legion-id","default-channel-id"])):N("",!0),r.value?(u(),ve(vb,{key:1,channel:r.value,members:g.value,"legion-id":n.legionId},null,8,["channel","members","legion-id"])):N("",!0),re(Ib),re(sy)]))}},yy=z(by,[["__scopeId","data-v-3a1df0e4"]]),$y=[{path:"/",name:"home",component:wa},{path:"/session/:sessionId",name:"session",component:ca,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Z_,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:sg,props:!0},{path:"/horde/:legionId",name:"horde",component:ub,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:yy,props:!0}],wy=ha({history:_a(),routes:$y}),Cy={class:"connection-indicators"},Ey=["title"],Sy=["title"],ky=["title"],Ty={__name:"ConnectionIndicator",setup(n){const e=je();function s(a){const i={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:c}=i[a];return c>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(a){const i={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},c={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:d,retryCount:_}=c[a];let r="Disconnected";return d?r="Connected":_>0&&(r=`Reconnecting (attempt ${_})`),`${i[a]}
${l[a]}
Status: ${r}`}return(a,i)=>(u(),m("div",Cy,[t("div",{class:K(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,Ey),t("div",{class:K(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,Sy),t("div",{class:K(["indicator",s("legion")]),title:o("legion")}," ðŸ‘¥ ",10,ky)]))}},xy=z(Ty,[["__scopeId","data-v-d35b07c8"]]),My={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Ay={class:"d-flex align-items-center gap-2"},Oy={__name:"AppHeader",setup(n){const e=fe();function s(){e.toggleSidebar()}return(o,a)=>(u(),m("header",My,[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...a[0]||(a[0]=[t("span",null,"â˜°",-1)])]),a[1]||(a[1]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",Ay,[re(xy)])]))}},Dy={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Ny={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Ly=["title"],Iy={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=y(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(c){return c.state==="paused"&&c.is_processing?"pending-prompt":c.is_processing?"processing":c.state}function a(c){const d=o(c);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[d]||"#d3d3d3"}function i(c){const d=o(c);return d==="starting"||d==="processing"||d==="pending-prompt"}function l(c){const d=o(c),_=d.charAt(0).toUpperCase()+d.slice(1),r=c.name||"Unnamed Session",w=c.is_minion&&c.role?` (${c.role})`:"";return`${r}${w}: ${_}`}return(c,d)=>(u(),m("div",Dy,[!n.sessions||n.sessions.length===0?(u(),m("div",Ny)):(u(!0),m(ie,{key:1},de(n.sessions,_=>(u(),m("div",{key:_.session_id,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":i(_)}]),style:He({width:s.value,backgroundColor:a(_),cursor:"help"}),title:l(_)},null,14,Ly))),128))]))}},Py=z(Iy,[["__scopeId","data-v-a79cfeec"]]),jy={class:"flex-grow-1"},Ry={key:0,class:"text-muted small ms-1"},Vy={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,s=Ge(),o=ae(),a=ge(),i=fe(),l=y(()=>o.currentSessionId===e.session.session_id),c=y(()=>o.deletingSessions.has(e.session.session_id)),d=y(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),_=y(()=>{const f=d.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[f]||"status-dot-grey"}),r=y(()=>{const f=d.value,E={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},k={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:E[f]||"#d3d3d3",borderColor:k[f]||"#6c757d"}});function w(){o.selectSession(e.session.session_id),s.push(`/session/${e.session.session_id}`)}function h(){i.showModal("edit-session",{session:e.session})}function p(f){f.dataTransfer.effectAllowed="move",f.dataTransfer.setData("application/session-id",e.session.session_id),f.dataTransfer.setData("application/project-id",e.projectId),f.dataTransfer.setData("text/plain",e.session.session_id),f.target.classList.add("dragging")}function g(f){f.target.classList.remove("dragging")}function b(f){f.preventDefault(),f.dataTransfer.dropEffect="move";const E=f.currentTarget.getBoundingClientRect(),k=E.top+E.height/2;f.clientY<k?(f.currentTarget.classList.add("drop-above"),f.currentTarget.classList.remove("drop-below")):(f.currentTarget.classList.add("drop-below"),f.currentTarget.classList.remove("drop-above"))}function v(f){f.preventDefault(),f.currentTarget.classList.remove("drop-above","drop-below");const E=f.dataTransfer.getData("application/session-id")||f.dataTransfer.getData("text/plain"),k=f.dataTransfer.getData("application/project-id");if(!E||E===e.session.session_id||k!==e.projectId)return;const T=f.currentTarget.getBoundingClientRect(),L=T.top+T.height/2,I=f.clientY<L,x=a.getProject(e.projectId);if(!x||!x.session_ids)return;const D=[...x.session_ids],B=D.indexOf(e.session.session_id),Q=D.indexOf(E);if(B===-1||Q===-1)return;const R=[...D],[$]=R.splice(Q,1);let C=I?B:B+1;Q<B&&C--,R.splice(C,0,$),a.reorderSessionsInProject(e.projectId,R)}return(f,E)=>(u(),m("div",{class:K(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:l.value,"session-deleting":c.value}]),style:{cursor:"pointer"},draggable:"true",onClick:w,onDragstart:p,onDragend:g,onDragover:b,onDrop:v},[t("div",{class:K(["status-dot me-2",_.value]),style:He(r.value)},null,6),t("div",jy,[t("span",null,S(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(u(),m("span",Ry,"("+S(n.session.role)+")",1)):N("",!0)]),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:be(h,["stop"])}," âœï¸ ")],34))}},Hy=z(Vy,[["__scopeId","data-v-07ecbf94"]]),Wy={class:"d-flex align-items-center gap-2"},Fy=["value"],Uy={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ge(),o=ae(),a=fe(),i=M("");ce(()=>s.currentRoute.value,b=>{!i.value&&b.name==="spy"&&b.params.minionId&&b.params.legionId===e.project.project_id&&(i.value=b.params.minionId)},{immediate:!0});const l=y(()=>i.value?e.sessions.find(b=>b.session_id===i.value):null),c=y(()=>{const b=s.currentRoute.value;return b.name==="spy"&&b.params.legionId===e.project.project_id}),d=y(()=>{if(!l.value)return"";if(l.value.state==="paused"&&l.value.is_processing)return"status-blinking";const b=l.value.is_processing?"processing":l.value.state;return b==="starting"||b==="processing"?"status-blinking":""}),_=y(()=>{if(!l.value)return{};if(l.value.state==="paused"&&l.value.is_processing)return{backgroundColor:"#ffc107"};const b=l.value.is_processing?"processing":l.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[b]||"#d3d3d3"}});function r(b){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[b.state]||"â—‹"}function w(b){return b.is_minion&&b.role?`${b.name} (${b.role})`:b.name}function h(){i.value&&s.push(`/spy/${e.project.project_id}/${i.value}`)}function p(){i.value?s.push(`/spy/${e.project.project_id}/${i.value}`):s.push("/")}function g(){l.value&&a.showModal("minion-view",{session:l.value})}return ce(()=>o.currentSessionId,b=>{if(b)e.sessions.some(v=>v.session_id===b)&&(i.value=b);else{i.value="";const v=s.currentRoute.value;v.name==="spy"&&v.params.legionId===e.project.project_id&&s.push("/")}}),(b,v)=>(u(),m("div",{class:K(["list-group-item list-group-item-action p-2",{active:c.value}])},[t("div",{class:"d-flex align-items-center justify-content-between mb-2",style:He({cursor:i.value?"pointer":"default"}),onClick:h},[v[1]||(v[1]=t("div",{class:"d-flex align-items-center"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ”"),t("span",{class:"fw-semibold"},"Spy"),t("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),t("div",Wy,[l.value?(u(),m("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:be(g,["stop"]),title:"View minion details"}," ðŸ‘ï¸ ")):N("",!0),l.value?(u(),m("span",{key:1,class:K(["minion-state-indicator",d.value]),style:He(_.value)}," ðŸ‘¤ ",6)):N("",!0)])],4),oe(t("select",{"onUpdate:modelValue":v[0]||(v[0]=f=>i.value=f),class:"form-select form-select-sm",onChange:p},[v[2]||(v[2]=t("option",{value:""},"-- Select Minion --",-1)),(u(!0),m(ie,null,de(n.sessions,f=>(u(),m("option",{key:f.session_id,value:f.session_id},S(r(f))+" "+S(w(f)),9,Fy))),128))],544),[[Oe,i.value]])],2))}},By=z(Uy,[["__scopeId","data-v-579589fb"]]),qy={class:"modal-dialog modal-dialog-centered"},zy={class:"modal-content"},Ky={class:"modal-body"},Gy={key:0,class:"alert alert-danger"},Yy={class:"mb-3"},Jy={class:"mb-3"},Xy={class:"form-text"},Qy={class:"mb-3"},Zy={class:"mb-3"},e1=["value"],t1={class:"modal-footer"},s1=["disabled"],n1={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:s}){const o=n,a=s,i=ae(),l=M(null),c=M(null),d=M(""),_=M(!1),r=M({name:"",purpose:"",description:"",member_minion_ids:[]}),w=y(()=>{const v=[];for(const[f,E]of i.sessions.entries())E.is_minion&&E.project_id===o.legionId&&v.push(E);return v}),h=y(()=>r.value.name.trim()!==""&&r.value.purpose.trim()!==""),p=async()=>{if(!h.value){d.value="Name and purpose are required";return}_.value=!0,d.value="";try{const v=await se.post(`/api/legions/${o.legionId}/channels`,{name:r.value.name.trim(),purpose:r.value.purpose.trim(),description:r.value.description.trim()||"",member_minion_ids:r.value.member_minion_ids});a("created",v.channel),c.value?.hide(),r.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(v){console.error("Failed to create channel:",v),d.value=v.response?.data?.detail||"Failed to create channel"}finally{_.value=!1}},g=()=>{c.value?.show()},b=()=>{c.value?.hide()};return me(()=>{l.value&&(c.value=new Fe(l.value))}),he(()=>{c.value?.dispose()}),e({show:g,hide:b}),(v,f)=>(u(),ve(lo,{to:"body"},[t("div",{ref_key:"modalElement",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[t("div",qy,[t("div",zy,[f[11]||(f[11]=t("div",{class:"modal-header"},[t("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ky,[d.value?(u(),m("div",Gy,S(d.value),1)):N("",!0),t("form",{onSubmit:be(p,["prevent"])},[t("div",Yy,[f[4]||(f[4]=t("label",{for:"channel-name",class:"form-label"},[X(" Channel Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"channel-name","onUpdate:modelValue":f[0]||(f[0]=E=>r.value.name=E),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[pe,r.value.name]]),f[5]||(f[5]=t("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),t("div",Jy,[f[6]||(f[6]=t("label",{for:"channel-purpose",class:"form-label"},[X(" Purpose "),t("span",{class:"text-danger"},"*")],-1)),oe(t("textarea",{id:"channel-purpose","onUpdate:modelValue":f[1]||(f[1]=E=>r.value.purpose=E),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[pe,r.value.purpose]]),t("div",Xy,S(r.value.purpose.length)+" / 500 characters",1)]),t("div",Qy,[f[7]||(f[7]=t("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),oe(t("textarea",{id:"channel-description","onUpdate:modelValue":f[2]||(f[2]=E=>r.value.description=E),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[pe,r.value.description]])]),t("div",Zy,[f[8]||(f[8]=t("label",{class:"form-label"},"Initial Members (Optional)",-1)),oe(t("select",{"onUpdate:modelValue":f[3]||(f[3]=E=>r.value.member_minion_ids=E),multiple:"",class:"form-select",size:"5"},[(u(!0),m(ie,null,de(w.value,E=>(u(),m("option",{key:E.session_id,value:E.session_id},S(E.name)+S(E.role?` (${E.role})`:""),9,e1))),128))],512),[[Oe,r.value.member_minion_ids]]),f[9]||(f[9]=t("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),t("div",t1,[f[10]||(f[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:p,disabled:_.value||!h.value},S(_.value?"Creating...":"Create Channel"),9,s1)])])])],512)]))}},o1=z(n1,[["__scopeId","data-v-573f4c01"]]),a1={class:"modal-dialog modal-dialog-centered"},i1={class:"modal-content"},l1={class:"modal-body"},r1={key:0,class:"alert alert-danger"},c1={class:"text-muted"},d1={class:"modal-footer"},u1=["disabled"],m1={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:s}){const o=n,a=s,i=M(null),l=M(null),c=M(""),d=M(!1),_=y(()=>o.channel?.member_minion_ids?.length||0),r=async()=>{if(!o.channel){c.value="No channel selected";return}d.value=!0,c.value="";try{await se.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),a("deleted",o.channel.channel_id),l.value?.hide()}catch(p){console.error("Failed to delete channel:",p),c.value=p.data?.detail||p.message||"Failed to delete channel"}finally{d.value=!1}},w=()=>{c.value="",l.value?.show()},h=()=>{l.value?.hide()};return me(()=>{i.value&&(l.value=new Fe(i.value))}),he(()=>{l.value?.dispose()}),e({show:w,hide:h}),(p,g)=>(u(),ve(lo,{to:"body"},[t("div",{ref_key:"modalElement",ref:i,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[t("div",a1,[t("div",i1,[g[4]||(g[4]=t("div",{class:"modal-header"},[t("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",l1,[c.value?(u(),m("div",r1,S(c.value),1)):N("",!0),g[2]||(g[2]=t("div",{class:"alert alert-warning"},[t("strong",null,"âš ï¸ Warning:"),X(" This action cannot be undone. ")],-1)),t("p",null,[g[0]||(g[0]=X("Are you sure you want to delete ",-1)),t("strong",null,S(n.channel?.name),1),g[1]||(g[1]=X("?",-1))]),t("p",c1," This channel has "+S(_.value)+" "+S(_.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),t("div",d1,[g[3]||(g[3]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-danger",onClick:r,disabled:d.value},S(d.value?"Deleting...":"Delete Channel"),9,u1)])])])],512)]))}},p1=["id"],f1={class:"accordion-item"},v1={class:"accordion-header"},h1=["aria-expanded","aria-controls"],_1={class:"text-muted ms-2"},g1=["id","data-bs-parent"],b1={class:"accordion-body p-0"},y1={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},$1={key:1,class:"list-group list-group-flush"},w1={class:"d-flex align-items-center justify-content-between"},C1=["onClick"],E1={class:"channel-name"},S1={class:"d-flex align-items-center gap-2"},k1={class:"badge bg-secondary member-count"},T1=["onClick"],x1={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ge(),o=Qe(),a=M(null),i=M(null),l=M(null),c=M(!0),d=y(()=>`channelsAccordion-${e.project.project_id}`),_=y(()=>`channelsCollapsePanel-${e.project.project_id}`),r=y(()=>o.channelsByLegion.get(e.project.project_id)||[]),w=y(()=>r.value.length);function h(){const T=window.bootstrap;if(!T)return;const L=document.getElementById(_.value);if(!L)return;T.Collapse.getOrCreateInstance(L).toggle()}function p(){c.value=!0}function g(){c.value=!1}function b(T){s.push(`/channel/${e.project.project_id}/${T}`)}function v(){a.value?.show()}function f(T){l.value=T,i.value?.show()}function E(T){console.log("Channel created, waiting for WebSocket update:",T)}function k(T){const I=(o.channelsByLegion.get(e.project.project_id)||[]).filter(x=>x.channel_id!==T);o.channelsByLegion.set(e.project.project_id,I),s.currentRoute.value.path.includes(T)&&s.push(`/timeline/${e.project.project_id}`)}return me(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(T){console.error("Failed to load channels:",T)}}),(T,L)=>(u(),m(ie,null,[t("div",{class:"accordion mt-2",id:d.value},[t("div",f1,[t("h2",v1,[t("button",{class:K(["accordion-button",{collapsed:!c.value}]),type:"button","aria-expanded":c.value,"aria-controls":_.value,onClick:h},[L[0]||(L[0]=t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),L[1]||(L[1]=t("span",{class:"fw-semibold"},"Channels",-1)),t("small",_1,"("+S(w.value)+")",1)],10,h1)]),t("div",{id:_.value,class:K(["accordion-collapse","collapse",{show:c.value}]),"data-bs-parent":`#${d.value}`,onShown:p,onHidden:g},[t("div",b1,[t("div",{class:"p-2 border-bottom"},[t("button",{class:"btn btn-sm btn-primary w-100",onClick:v}," + New Channel ")]),r.value.length===0?(u(),m("div",y1,' No channels yet. Click "New Channel" to create one. ')):(u(),m("div",$1,[(u(!0),m(ie,null,de(r.value,I=>(u(),m("div",{key:I.channel_id,class:"list-group-item list-group-item-action channel-item"},[t("div",w1,[t("div",{class:"d-flex align-items-center flex-grow-1",onClick:x=>b(I.channel_id)},[L[2]||(L[2]=t("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),t("span",E1,S(I.name),1)],8,C1),t("div",S1,[t("span",k1,S(I.member_minion_ids?.length||0),1),t("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:be(x=>f(I),["stop"]),title:"Delete channel",style:{"font-size":"1.1rem","line-height":"1"}}," ðŸ—‘ï¸ ",8,T1)])])]))),128))]))])],42,g1)])],8,p1),re(o1,{ref_key:"createModal",ref:a,"legion-id":n.project.project_id,onCreated:E},null,8,["legion-id"]),re(m1,{ref_key:"deleteModal",ref:i,"legion-id":n.project.project_id,channel:l.value,onDeleted:k},null,8,["legion-id","channel"])],64))}},M1=z(x1,[["__scopeId","data-v-0fd4b910"]]),A1=["data-project-id"],O1=["id"],D1=["aria-expanded","aria-controls","onKeydown"],N1={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},L1={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},I1={class:"fw-semibold",style:{"flex-shrink":"0"}},P1={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},j1={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},R1=["title"],V1=["title"],H1=["id","aria-labelledby"],W1={class:"accordion-body p-0"},F1={class:"list-group list-group-flush"},U1={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ge(),o=ge(),a=ae(),i=fe(),l=M(e.project.is_expanded||!1),c=y(()=>o.formatPath(e.project.working_directory)),d=y(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(I=>a.getSession(I)).filter(I=>I!=null)),_=y(()=>{const I=s.currentRoute.value;return I.name==="timeline"&&I.params.legionId===e.project.project_id}),r=y(()=>{const I=s.currentRoute.value;return I.name==="horde"&&I.params.legionId===e.project.project_id});function w(I){const x=window.bootstrap;if(!x)return;const D=document.getElementById(`collapse-${e.project.project_id}`);if(!D)return;x.Collapse.getOrCreateInstance(D).toggle()}function h(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function p(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const I=a.currentSessionId;I&&a.getSession(I)&&e.project.session_ids?.includes(I)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function g(){i.showModal("edit-project",{project:e.project})}function b(){e.project.is_multi_agent?i.showModal("create-minion",{project:e.project}):i.showModal("create-session",{project:e.project})}function v(){s.push(`/timeline/${e.project.project_id}`)}function f(){s.push(`/horde/${e.project.project_id}`)}function E(I){I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("application/project-id",e.project.project_id),I.dataTransfer.setData("text/plain",e.project.project_id),I.target.classList.add("dragging")}function k(I){I.target.classList.remove("dragging")}function T(I){I.preventDefault(),I.dataTransfer.dropEffect="move";const x=I.currentTarget.getBoundingClientRect(),D=x.top+x.height/2;I.clientY<D?(I.currentTarget.classList.add("drop-above"),I.currentTarget.classList.remove("drop-below")):(I.currentTarget.classList.add("drop-below"),I.currentTarget.classList.remove("drop-above"))}function L(I){I.preventDefault(),I.currentTarget.classList.remove("drop-above","drop-below");const x=I.dataTransfer.getData("application/project-id")||I.dataTransfer.getData("text/plain");if(!x||x===e.project.project_id)return;const D=I.currentTarget.getBoundingClientRect(),B=D.top+D.height/2,Q=I.clientY<B,R=o.orderedProjects,$=R.findIndex(Y=>Y.project_id===e.project.project_id),C=R.findIndex(Y=>Y.project_id===x);if($===-1||C===-1)return;const A=[...R],[O]=A.splice(C,1);let P=Q?$:$+1;C<$&&P--,A.splice(P,0,O);const V=A.map(Y=>Y.project_id);o.reorderProjects(V)}return(I,x)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:E,onDragend:k,onDragover:T,onDrop:L},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:K(["accordion-button bg-white p-2",{collapsed:!l.value}]),role:"button",tabindex:"0","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:w,onKeydown:[Ot(be(w,["prevent"]),["enter"]),Ot(be(w,["prevent"]),["space"])]},[t("div",N1,[t("div",L1,[t("div",I1,[n.project.is_multi_agent?(u(),m("span",P1,"ðŸ›")):N("",!0),X(" "+S(n.project.name),1)]),t("div",j1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:be(g,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:be(b,["stop"])}," âž• ",8,R1)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},S(c.value),9,V1)])],42,D1)],8,O1),re(Py,{project:n.project,sessions:d.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:K(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:p},[t("div",W1,[t("div",F1,[n.project.is_multi_agent?(u(),m("div",{key:0,class:K(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:_.value}]),style:{cursor:"pointer"},onClick:v},[...x[0]||(x[0]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):N("",!0),n.project.is_multi_agent?(u(),m(ie,{key:1},[t("div",{class:K(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:r.value}]),style:{cursor:"pointer"},onClick:f},[...x[1]||(x[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),t("span",{class:"fw-semibold"},"Horde"),t("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),re(By,{project:n.project,sessions:d.value},null,8,["project","sessions"]),re(M1,{project:n.project},null,8,["project"])],64)):(u(!0),m(ie,{key:2},de(d.value,D=>(u(),ve(Hy,{key:D.session_id,session:D,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,H1)],40,A1))}},B1=z(U1,[["__scopeId","data-v-04f4e534"]]),q1={class:"project-list"},z1={key:0,class:"text-muted text-center py-3"},K1={__name:"ProjectList",setup(n){const e=ge(),s=y(()=>e.orderedProjects);return(o,a)=>(u(),m("div",q1,[s.value.length===0?(u(),m("div",z1,' No projects yet. Click "New" to create one. ')):N("",!0),(u(!0),m(ie,null,de(s.value,i=>(u(),ve(B1,{key:i.project_id,project:i},null,8,["project"]))),128))]))}},G1={class:"flex-grow-1 overflow-auto p-3"},Y1={id:"sessions-container"},J1={__name:"Sidebar",setup(n){const e=fe(),s=y(()=>e.sidebarCollapsed),o=y(()=>e.isMobile),a=y(()=>{if(o.value)return{};const r=`${e.sidebarWidth}px`;return{width:r,minWidth:"200px",maxWidth:"30vw","--sidebar-width":r}});function i(){e.showModal("create-project")}const l=M(!1);function c(r){l.value=!0,document.addEventListener("mousemove",d),document.addEventListener("mouseup",_)}function d(r){l.value&&e.setSidebarWidth(r.clientX)}function _(){l.value=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",_)}return(r,w)=>(u(),m("aside",{id:"sidebar",class:K(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value}]),style:He(a.value)},[t("div",G1,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:i}," ðŸ“ New ")]),t("div",Y1,[re(K1)])]),t("div",{class:"sidebar-resize-handle",onMousedown:c},null,32)],6))}},X1=z(J1,[["__scopeId","data-v-d792f0f0"]]),Q1={class:"modal-dialog modal-lg"},Z1={class:"modal-content"},e$={class:"modal-body"},t$={class:"mb-3"},s$={class:"input-group"},n$=["disabled"],o$={key:0,class:"text-center py-4"},a$={key:1,class:"alert alert-danger",role:"alert"},i$={key:2,class:"folder-list"},l$=["onClick","onDblclick"],r$={class:"d-flex align-items-center flex-grow-1"},c$=["onClick"],d$={key:1,class:"text-center text-muted py-3"},u$={class:"modal-footer"},m$=["disabled"],p$={__name:"FolderBrowserModal",setup(n){const e=fe(),s=M(""),o=M(""),a=M([]),i=M(!1),l=M(""),c=M(null);let d=null,_=null;const r=y(()=>{if(!s.value)return null;const k=s.value.split(/[\\/]/).filter(Boolean);return k.length<=1?null:(k.pop(),k.length>0?k.join("/"):"/")});function w(k){if(!k)return"";const T=k.split(/[\\/]/).filter(Boolean);return T.length<=2?k:".../"+T.slice(-2).join("/")}async function h(){i.value=!0,l.value="",a.value=[],o.value="";try{const k=s.value?{path:s.value}:{},T=await se.get("/api/filesystem/browse",{params:k});T.current_path&&(s.value=T.current_path),a.value=T.directories||[]}catch(k){console.error("Failed to load directory:",k),l.value=k.message||"Failed to load directory"}finally{i.value=!1}}function p(k){o.value=k.path}function g(k){s.value=k.path,o.value="",h()}function b(){r.value&&(s.value=r.value,o.value="",h())}function v(){const k=o.value||s.value;k&&_&&_(k),d&&d.hide()}function f(){h()}function E(){a.value=[],o.value="",l.value="",_=null,e.hideModal()}return ce(()=>e.currentModal,k=>{if(k?.name==="folder-browser"&&d){const T=k.data||{};s.value=T.defaultPath||T.currentPath||"",_=T.onSelect||null,d.show()}}),me(()=>{c.value&&ye(async()=>{const{default:k}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{d=new k(c.value),c.value.addEventListener("shown.bs.modal",f),c.value.addEventListener("hidden.bs.modal",E)})}),he(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",f),c.value.removeEventListener("hidden.bs.modal",E)),d&&d.dispose()}),(k,T)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",Q1,[t("div",Z1,[T[6]||(T[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",e$,[t("div",t$,[T[1]||(T[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",s$,[oe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=L=>s.value=L),onKeyup:Ot(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[pe,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:i.value}," ðŸ”„ Refresh ",8,n$)])]),i.value?(u(),m("div",o$,[...T[2]||(T[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(u(),m("div",a$,S(l.value),1)):(u(),m("div",i$,[r.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...T[3]||(T[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):N("",!0),(u(!0),m(ie,null,de(a.value,L=>(u(),m("div",{key:L.path,class:K(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:L.path===o.value}]),onClick:I=>p(L),onDblclick:I=>g(L),role:"button"},[t("div",r$,[T[4]||(T[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,S(L.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:be(I=>g(L),["stop"])}," Open ",8,c$)],42,l$))),128)),a.value.length===0?(u(),m("div",d$," No subdirectories found ")):N("",!0)]))]),t("div",u$,[T[5]||(T[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:!o.value},' Select "'+S(w(o.value||s.value))+'" ',9,m$)])])])],512))}},f$=z(p$,[["__scopeId","data-v-cf79108f"]]),v$={class:"modal-dialog"},h$={class:"modal-content"},_$={class:"modal-body"},g$={class:"mb-3"},b$={key:0,class:"invalid-feedback"},y$={class:"mb-3"},$$={class:"input-group"},w$={key:0,class:"invalid-feedback"},C$={class:"mb-3 form-check"},E$={class:"mb-3 form-check"},S$={class:"form-check-label",for:"createSession"},k$={key:0,class:"mb-3 ms-4"},T$={for:"sessionName",class:"form-label"},x$={key:1,class:"alert alert-danger",role:"alert"},M$={class:"modal-footer"},A$=["disabled"],O$={key:0,class:"spinner-border spinner-border-sm me-2"},D$={__name:"ProjectCreateModal",setup(n){const e=ge(),s=ae(),o=fe(),a=M({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),i=M({name:"",workingDirectory:""}),l=M(!1),c=M(""),d=M(null);let _=null;function r(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:v=>{a.value.workingDirectory=v,i.value.workingDirectory=""}})}function w(){i.value={};let v=!0;return a.value.name.trim()||(i.value.name="Project name is required",v=!1),a.value.workingDirectory.trim()||(i.value.workingDirectory="Working directory is required",v=!1),v}async function h(){if(w()){l.value=!0,c.value="";try{const v=await e.createProject(a.value.name,a.value.workingDirectory,a.value.isMultiAgent);a.value.createSession&&await s.createSession(v.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),_&&_.hide(),p()}catch(v){console.error("Failed to create project:",v),c.value=v.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function p(){a.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},i.value={},c.value=""}function g(){const v=document.getElementById("projectName");v&&v.focus()}function b(){p(),o.hideModal()}return ce(()=>o.currentModal,v=>{v?.name==="create-project"&&_&&_.show()}),me(()=>{d.value&&ye(async()=>{const{default:v}=await import("./modal-B4rHLo2F.js").then(f=>f.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{_=new v(d.value),d.value.addEventListener("shown.bs.modal",g),d.value.addEventListener("hidden.bs.modal",b)})}),he(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",g),d.value.removeEventListener("hidden.bs.modal",b)),_&&_.dispose()}),(v,f)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",v$,[t("div",h$,[f[11]||(f[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",_$,[t("form",{onSubmit:be(h,["prevent"])},[t("div",g$,[f[5]||(f[5]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),oe(t("input",{type:"text",class:K(["form-control",{"is-invalid":i.value.name}]),id:"projectName","onUpdate:modelValue":f[0]||(f[0]=E=>a.value.name=E),placeholder:"My Project",required:""},null,2),[[pe,a.value.name]]),i.value.name?(u(),m("div",b$,S(i.value.name),1)):N("",!0)]),t("div",y$,[f[6]||(f[6]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",$$,[oe(t("input",{type:"text",class:K(["form-control",{"is-invalid":i.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":f[1]||(f[1]=E=>a.value.workingDirectory=E),placeholder:"/path/to/project",required:""},null,2),[[pe,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:r}," Browse... "),i.value.workingDirectory?(u(),m("div",w$,S(i.value.workingDirectory),1)):N("",!0)]),f[7]||(f[7]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",C$,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":f[2]||(f[2]=E=>a.value.isMultiAgent=E)},null,512),[[Dt,a.value.isMultiAgent]]),f[8]||(f[8]=t("label",{class:"form-check-label",for:"isMultiAgent"}," ðŸ› Multi-Agent Project (Legion) ",-1)),f[9]||(f[9]=t("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),t("div",E$,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":f[3]||(f[3]=E=>a.value.createSession=E)},null,512),[[Dt,a.value.createSession]]),t("label",S$," Create initial "+S(a.value.isMultiAgent?"minion":"session"),1)]),a.value.createSession?(u(),m("div",k$,[t("label",T$," Initial "+S(a.value.isMultiAgent?"Minion":"Session")+" Name ",1),oe(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":f[4]||(f[4]=E=>a.value.sessionName=E),placeholder:"main"},null,512),[[pe,a.value.sessionName]])])):N("",!0),c.value?(u(),m("div",x$,S(c.value),1)):N("",!0)],32)]),t("div",M$,[f[10]||(f[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:l.value},[l.value?(u(),m("span",O$)):N("",!0),X(" "+S(l.value?"Creating...":"Create Project"),1)],8,A$)])])])],512))}},N$=z(D$,[["__scopeId","data-v-adf50394"]]),L$={class:"modal-dialog"},I$={class:"modal-content"},P$={class:"modal-body"},j$={class:"mb-3"},R$={key:0,class:"invalid-feedback"},V$={class:"mb-3"},H$=["value"],W$={key:0,class:"alert alert-danger",role:"alert"},F$={class:"danger-zone"},U$={class:"text-muted small"},B$=["disabled"],q$={key:0,class:"alert alert-warning mt-3",role:"alert"},z$={class:"mb-2"},K$={class:"d-flex gap-2"},G$=["disabled"],Y$={key:0,class:"spinner-border spinner-border-sm me-2"},J$=["disabled"],X$={class:"modal-footer"},Q$=["disabled"],Z$={key:0,class:"spinner-border spinner-border-sm me-2"},ew={__name:"ProjectEditModal",setup(n){const e=ge(),s=fe(),o=M(null),a=M({name:""}),i=M({name:""}),l=M(!1),c=M(!1),d=M(""),_=M(!1),r=M(null);let w=null;const h=y(()=>o.value?.session_ids?.length||0);function p(){i.value={};let k=!0;return a.value.name.trim()||(i.value.name="Project name is required",k=!1),k}async function g(){if(!(!p()||!o.value)){l.value=!0,d.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),w&&w.hide()}catch(k){console.error("Failed to update project:",k),d.value=k.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function b(){if(o.value){c.value=!0,d.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(k){console.error("Failed to delete project:",k),d.value=k.message||"Failed to delete project. Please try again."}finally{c.value=!1}}}function v(){a.value={name:""},i.value={},d.value="",_.value=!1}function f(){const k=document.getElementById("editProjectName");k&&(k.focus(),k.select())}function E(){v(),o.value=null,s.hideModal()}return ce(()=>s.currentModal,k=>{if(k?.name==="edit-project"&&w){const T=k.data||{};o.value=T.project,o.value&&(a.value.name=o.value.name),w.show()}}),me(()=>{r.value&&ye(async()=>{const{default:k}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{w=new k(r.value),r.value.addEventListener("shown.bs.modal",f),r.value.addEventListener("hidden.bs.modal",E)})}),he(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",f),r.value.removeEventListener("hidden.bs.modal",E)),w&&w.dispose()}),(k,T)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",L$,[t("div",I$,[T[10]||(T[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",P$,[t("form",{onSubmit:be(g,["prevent"])},[t("div",j$,[T[3]||(T[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),oe(t("input",{type:"text",class:K(["form-control",{"is-invalid":i.value.name}]),id:"editProjectName","onUpdate:modelValue":T[0]||(T[0]=L=>a.value.name=L),placeholder:"My Project",required:""},null,2),[[pe,a.value.name]]),i.value.name?(u(),m("div",R$,S(i.value.name),1)):N("",!0)]),t("div",V$,[T[4]||(T[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,H$),T[5]||(T[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),d.value?(u(),m("div",W$,S(d.value),1)):N("",!0)],32),T[8]||(T[8]=t("hr",null,null,-1)),t("div",F$,[T[6]||(T[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",U$," Deleting this project will also delete all "+S(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:T[1]||(T[1]=L=>_.value=!0),disabled:c.value}," ðŸ—‘ï¸ Delete Project ",8,B$)]),_.value?(u(),m("div",q$,[T[7]||(T[7]=t("strong",null,"Are you sure?",-1)),t("p",z$,' This will permanently delete the project "'+S(o.value?.name)+'" and all '+S(h.value)+" session(s). ",1),t("div",K$,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:c.value},[c.value?(u(),m("span",Y$)):N("",!0),X(" "+S(c.value?"Deleting...":"Yes, Delete Permanently"),1)],8,G$),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:T[2]||(T[2]=L=>_.value=!1),disabled:c.value}," Cancel ",8,J$)])])):N("",!0)]),t("div",X$,[T[9]||(T[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:l.value},[l.value?(u(),m("span",Z$)):N("",!0),X(" "+S(l.value?"Saving...":"Save Changes"),1)],8,Q$)])])])],512))}},tw=z(ew,[["__scopeId","data-v-52679516"]]),sw={class:"modal-dialog modal-lg"},nw={class:"modal-content"},ow={class:"modal-header"},aw={class:"modal-title",id:"createSessionModalLabel"},iw={key:0,class:"text-muted small"},lw={class:"modal-body"},rw={class:"mb-3"},cw={key:0,class:"invalid-feedback"},dw={class:"mb-3"},uw={class:"mb-3"},mw={class:"mb-3"},pw={class:"form-text d-flex justify-content-between"},fw={key:0,class:"invalid-feedback"},vw={class:"mb-3 form-check"},hw={key:0,class:"form-text text-warning"},_w={class:"mb-3"},gw={class:"mb-3 form-check"},bw={key:0,class:"alert alert-danger",role:"alert"},yw={class:"modal-footer"},$w=["disabled"],ww={key:0,class:"spinner-border spinner-border-sm me-2"},Cw={__name:"SessionCreateModal",setup(n){const e=Ge();ge();const s=ae(),o=fe(),a=M(null),i=M({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0}),l=M({name:""}),c=M(!1),d=M(""),_=M(null);let r=null;const w=y(()=>i.value.system_prompt.length),h=y(()=>w.value>6e3),p=y(()=>w.value>5500&&w.value<=6e3);function g(){l.value={};let k=!0;return i.value.name.trim()||(l.value.name="Session name is required",k=!1),h.value&&(k=!1),k}async function b(){if(!(!g()||!a.value)){c.value=!0,d.value="";try{const k=i.value.allowed_tools.split(",").map(I=>I.trim()).filter(I=>I.length>0),T={name:i.value.name,permission_mode:i.value.permission_mode,model:i.value.model,system_prompt:i.value.system_prompt.trim()||null,override_system_prompt:i.value.override_system_prompt,allowed_tools:k},L=await s.createSession(a.value.project_id,T);i.value.startImmediately&&await s.startSession(L.session_id),e.push(`/session/${L.session_id}`),r&&r.hide(),v()}catch(k){console.error("Failed to create session:",k),d.value=k.message||"Failed to create session. Please try again."}finally{c.value=!1}}}function v(){i.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0},l.value={},d.value=""}function f(){const k=document.getElementById("sessionName");k&&k.focus()}function E(){v(),a.value=null,o.hideModal()}return ce(()=>o.currentModal,k=>{if(k?.name==="create-session"&&r){const T=k.data||{};a.value=T.project,r.show()}}),me(()=>{_.value&&ye(async()=>{const{default:k}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{r=new k(_.value),_.value.addEventListener("shown.bs.modal",f),_.value.addEventListener("hidden.bs.modal",E)})}),he(()=>{_.value&&(_.value.removeEventListener("shown.bs.modal",f),_.value.removeEventListener("hidden.bs.modal",E)),r&&r.dispose()}),(k,T)=>(u(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:_},[t("div",sw,[t("div",nw,[t("div",ow,[t("h5",aw,[T[7]||(T[7]=X(" Create New Session ",-1)),a.value?(u(),m("span",iw,"in "+S(a.value.name),1)):N("",!0)]),T[8]||(T[8]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",lw,[t("form",{onSubmit:be(b,["prevent"])},[t("div",rw,[T[9]||(T[9]=t("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),oe(t("input",{type:"text",class:K(["form-control",{"is-invalid":l.value.name}]),id:"sessionName","onUpdate:modelValue":T[0]||(T[0]=L=>i.value.name=L),placeholder:"main",required:""},null,2),[[pe,i.value.name]]),l.value.name?(u(),m("div",cw,S(l.value.name),1)):N("",!0)]),t("div",dw,[T[11]||(T[11]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":T[1]||(T[1]=L=>i.value.permission_mode=L)},[...T[10]||(T[10]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Oe,i.value.permission_mode]]),T[12]||(T[12]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",uw,[T[14]||(T[14]=t("label",{for:"model",class:"form-label"},"Model",-1)),oe(t("select",{class:"form-select",id:"model","onUpdate:modelValue":T[2]||(T[2]=L=>i.value.model=L)},[...T[13]||(T[13]=[t("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),t("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),t("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[Oe,i.value.model]])]),t("div",mw,[T[15]||(T[15]=t("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),oe(t("textarea",{class:K(["form-control",{"is-invalid":h.value}]),id:"systemPrompt","onUpdate:modelValue":T[3]||(T[3]=L=>i.value.system_prompt=L),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[pe,i.value.system_prompt]]),t("div",pw,[t("span",null,S(i.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),t("span",{class:K({"text-danger":h.value,"text-warning":p.value})},S(w.value)+" / 6000 chars ",3)]),h.value?(u(),m("div",fw," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):N("",!0)]),t("div",vw,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":T[4]||(T[4]=L=>i.value.override_system_prompt=L)},null,512),[[Dt,i.value.override_system_prompt]]),T[17]||(T[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),i.value.override_system_prompt?(u(),m("div",hw,[...T[16]||(T[16]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):N("",!0)]),t("div",_w,[T[18]||(T[18]=t("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),oe(t("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":T[5]||(T[5]=L=>i.value.allowed_tools=L),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[pe,i.value.allowed_tools]]),T[19]||(T[19]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",gw,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":T[6]||(T[6]=L=>i.value.startImmediately=L)},null,512),[[Dt,i.value.startImmediately]]),T[20]||(T[20]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),d.value?(u(),m("div",bw,S(d.value),1)):N("",!0)],32)]),t("div",yw,[T[21]||(T[21]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:c.value},[c.value?(u(),m("span",ww)):N("",!0),X(" "+S(c.value?"Creating...":"Create Session"),1)],8,$w)])])])],512))}},Ew=z(Cw,[["__scopeId","data-v-d74a6221"]]),Sw={class:"modal-dialog"},kw={class:"modal-content"},Tw={class:"modal-body"},xw={class:"mb-3"},Mw={key:0,class:"invalid-feedback"},Aw={class:"mb-3"},Ow=["value"],Dw={class:"mb-3"},Nw={class:"form-control-plaintext"},Lw={class:"mb-3"},Iw=["disabled"],Pw={key:0,value:"bypassPermissions"},jw={class:"form-text"},Rw={key:0,class:"text-warning"},Vw={key:1},Hw={key:0,class:"mb-3"},Ww={class:"card"},Fw={class:"card-body"},Uw={key:0,class:"mb-2"},Bw={key:1,class:"mb-2"},qw={key:2,class:"mt-2"},zw={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},Kw={key:1,class:"alert alert-danger",role:"alert"},Gw={class:"modal-footer"},Yw=["disabled"],Jw={key:0,class:"spinner-border spinner-border-sm me-2"},Xw={__name:"SessionEditModal",setup(n){const e=ae(),s=fe(),o=M(null),a=M({name:"",permission_mode:"default"}),i=M({name:""}),l=M(!1),c=M(""),d=M(null);let _=null;const r=y(()=>o.value?.state==="active"||o.value?.state==="starting"),w=y(()=>o.value?.initial_permission_mode==="bypassPermissions");function h(E){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[E]||"bg-secondary"}function p(){i.value={};let E=!0;return a.value.name.trim()||(i.value.name="Session name is required",E=!1),E}async function g(){if(!(!p()||!o.value)){l.value=!0,c.value="";try{await e.updateSessionName(o.value.session_id,a.value.name),a.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,a.value.permission_mode),_&&_.hide()}catch(E){console.error("Failed to update session:",E),c.value=E.message||"Failed to update session. Please try again."}finally{l.value=!1}}}function b(){a.value={name:"",permission_mode:"default"},i.value={},c.value=""}function v(){const E=document.getElementById("editSessionName");E&&(E.focus(),E.select())}function f(){b(),o.value=null,s.hideModal()}return ce(()=>s.currentModal,E=>{if(E?.name==="edit-session"&&_){const k=E.data||{};o.value=k.session,o.value&&(a.value.name=o.value.name,a.value.permission_mode=o.value.current_permission_mode||"default"),_.show()}}),me(()=>{d.value&&ye(async()=>{const{default:E}=await import("./modal-B4rHLo2F.js").then(k=>k.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{_=new E(d.value),d.value.addEventListener("shown.bs.modal",v),d.value.addEventListener("hidden.bs.modal",f)})}),he(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",v),d.value.removeEventListener("hidden.bs.modal",f)),_&&_.dispose()}),(E,k)=>(u(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",Sw,[t("div",kw,[k[15]||(k[15]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Tw,[t("form",{onSubmit:be(g,["prevent"])},[t("div",xw,[k[2]||(k[2]=t("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),oe(t("input",{type:"text",class:K(["form-control",{"is-invalid":i.value.name}]),id:"editSessionName","onUpdate:modelValue":k[0]||(k[0]=T=>a.value.name=T),placeholder:"Session Name",required:""},null,2),[[pe,a.value.name]]),i.value.name?(u(),m("div",Mw,S(i.value.name),1)):N("",!0)]),t("div",Aw,[k[3]||(k[3]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Ow),k[4]||(k[4]=t("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),t("div",Dw,[k[5]||(k[5]=t("label",{class:"form-label"},"Current State",-1)),t("div",Nw,[t("span",{class:K(["badge",h(o.value?.state)])},S(o.value?.state),3)])]),t("div",Lw,[k[9]||(k[9]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":k[1]||(k[1]=T=>a.value.permission_mode=T),disabled:!r.value},[k[6]||(k[6]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),k[7]||(k[7]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),k[8]||(k[8]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),w.value?(u(),m("option",Pw,"âš ï¸ Bypass Permissions (No prompts)")):N("",!0)],8,Iw),[[Oe,a.value.permission_mode]]),t("div",jw,[r.value?(u(),m("span",Vw," Controls which tool actions require permission prompts ")):(u(),m("span",Rw," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),m("div",Hw,[k[13]||(k[13]=t("label",{class:"form-label"},"System Prompt Configuration",-1)),t("div",Ww,[t("div",Fw,[o.value?.override_system_prompt?(u(),m("div",Uw,[...k[10]||(k[10]=[t("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),t("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),m("div",Bw,[...k[11]||(k[11]=[t("span",{class:"badge bg-info"},"Append Mode",-1),t("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),m("div",qw,[k[12]||(k[12]=t("strong",{class:"small"},"Custom Instructions:",-1)),t("div",zw,S(o.value.system_prompt),1)])):N("",!0)])])])):N("",!0),c.value?(u(),m("div",Kw,S(c.value),1)):N("",!0)],32)]),t("div",Gw,[k[14]||(k[14]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:l.value},[l.value?(u(),m("span",Jw)):N("",!0),X(" "+S(l.value?"Saving...":"Save Changes"),1)],8,Yw)])])])],512))}},Qw=z(Xw,[["__scopeId","data-v-c99ca17f"]]),Zw={class:"modal-dialog modal-dialog-centered"},eC={class:"modal-content"},tC={class:"modal-header"},sC={class:"modal-title",id:"manageSessionModalLabel"},nC={class:"modal-body"},oC={key:0,class:"text-center py-4"},aC={class:"text-muted"},iC={key:1},lC={key:2},rC={class:"text-muted"},cC={key:3},dC={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},uC={class:"d-grid gap-2"},mC=["disabled"],pC=["disabled"],fC=["disabled"],vC=["disabled"],hC={class:"modal-footer"},_C={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},gC={__name:"SessionManageModal",setup(n){const e=Ge(),s=ae(),o=fe(),a=je();De();const i=M(null),l=M(!1),c=M(""),d=M(""),_=M(null),r=M(null);let w=null;const h=y(()=>_.value==="reset"?"Reset Session":_.value==="delete"?"Delete Session":"Manage Session");function p(){_.value="reset"}function g(){_.value="delete"}function b(){_.value=null}async function v(){_.value==="reset"?await k():_.value==="delete"&&await T()}async function f(){if(i.value){l.value=!0,c.value="Restarting session...";try{const x=i.value.session_id,D=await se.post(`/api/sessions/${x}/restart`);if(D.success)console.log("Session restarted successfully, reconnecting"),await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(x),w&&w.hide();else{const B=D.error||D.detail||"Failed to restart session";console.error("Failed to restart session:",B),d.value=`Failed to restart session: ${B}`}}catch(x){console.error("Error restarting session:",x);const D=x.data?.detail||x.message||"Unknown error";d.value=`Error restarting session: ${D}`}finally{l.value=!1}}}async function E(){if(i.value)try{w&&w.hide(),console.log("Ending session",i.value.session_id);const x=i.value.session_id;await se.post(`/api/sessions/${x}/terminate`),await a.disconnectSession(),s.currentSessionId===x&&(s.currentSessionId=null),e.push("/")}catch(x){console.error("Error ending session:",x),await a.disconnectSession(),s.currentSessionId===i.value?.session_id&&(s.currentSessionId=null),e.push("/")}}async function k(){if(i.value){l.value=!0,c.value="Resetting session...";try{const x=i.value.session_id,D=await se.post(`/api/sessions/${x}/reset`);if(D.success)console.log("Session reset successfully, reconnecting"),await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(x),w&&w.hide();else{const B=D.error||D.detail||"Failed to reset session";console.error("Failed to reset session:",B),d.value=`Failed to reset session: ${B}`,_.value=null}}catch(x){console.error("Error resetting session:",x);const D=x.data?.detail||x.message||"Unknown error";d.value=`Error resetting session: ${D}`,_.value=null}finally{l.value=!1}}}async function T(){if(i.value){l.value=!0,c.value="Deleting session...";try{const x=i.value.session_id;await s.deleteSession(x),e.currentRoute.value.params.sessionId===x&&e.push("/"),w&&w.hide()}catch(x){console.error("Error deleting session:",x);const D=x.data?.detail||x.message||"Unknown error";d.value=`Error deleting session: ${D}`,_.value=null}finally{l.value=!1}}}function L(){_.value=null,l.value=!1,c.value="",d.value=""}function I(){L(),i.value=null,o.hideModal()}return ce(()=>o.currentModal,x=>{if(x?.name==="manage-session"&&w){const D=x.data||{};i.value=D.session,L(),w.show()}}),me(()=>{r.value&&ye(async()=>{const{default:x}=await import("./modal-B4rHLo2F.js").then(D=>D.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{w=new x(r.value),r.value.addEventListener("hidden.bs.modal",I)})}),he(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",I),w&&w.dispose()}),(x,D)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",Zw,[t("div",eC,[t("div",tC,[t("h5",sC,S(_.value?h.value:"Manage Session"),1),D[1]||(D[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",nC,[l.value?(u(),m("div",oC,[D[2]||(D[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",aC,S(c.value),1)])):_.value==="reset"?(u(),m("div",iC,[...D[3]||(D[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):_.value==="delete"?(u(),m("div",lC,[D[6]||(D[6]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",rC,[D[4]||(D[4]=X("This will permanently delete session ",-1)),t("strong",null,S(i.value?.name),1),D[5]||(D[5]=X(".",-1))]),D[7]||(D[7]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(u(),m("div",cC,[d.value?(u(),m("div",dC,[D[8]||(D[8]=t("strong",null,"Error:",-1)),X(" "+S(d.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:D[0]||(D[0]=B=>d.value="")})])):N("",!0),D[15]||(D[15]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",uC,[t("button",{class:"btn btn-outline-primary text-start",onClick:f,disabled:l.value},[...D[9]||(D[9]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,mC),t("button",{class:"btn btn-outline-secondary text-start",onClick:E,disabled:l.value},[...D[10]||(D[10]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,pC),D[13]||(D[13]=t("hr",{class:"my-2"},null,-1)),D[14]||(D[14]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:p,disabled:l.value},[...D[11]||(D[11]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,fC),t("button",{class:"btn btn-outline-danger text-start",onClick:g,disabled:l.value},[...D[12]||(D[12]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,vC)]),D[16]||(D[16]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),X(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",hC,[_.value&&!l.value?(u(),m(ie,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:b},"Cancel"),t("button",{type:"button",class:K(["btn",_.value==="delete"?"btn-danger":"btn-warning"]),onClick:v},S(_.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?N("",!0):(u(),m("button",_C,"Cancel"))])])])],512))}},bC=z(gC,[["__scopeId","data-v-9122e4df"]]),yC={class:"modal-dialog modal-dialog-centered modal-lg"},$C={class:"modal-content"},wC={class:"modal-body"},CC={key:0,class:"text-center text-muted py-4"},EC={key:1},SC={class:"mb-3"},kC={class:"font-monospace small"},TC={class:"mb-3"},xC=["value"],MC={class:"mb-3"},AC={class:"mb-3"},OC={class:"mb-3"},DC={key:0},NC={class:"d-flex flex-wrap gap-1"},LC={key:1,class:"text-muted small"},IC={key:0,class:"mb-3"},PC={class:"d-flex flex-wrap gap-1"},jC={key:1,class:"mb-3"},RC={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},VC={class:"mb-3"},HC={class:"text-muted"},WC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},FC={__name:"SessionInfoModal",setup(n){const e=ae(),s=De(),o=fe(),a=M(null),i=M(!1),l=M(null);let c=null;const d=y(()=>{if(!a.value)return null;const p=e.initData.get(a.value);return p||(s.messagesBySession.get(a.value)||[]).find(v=>v.type==="system"&&(v.subtype==="init"||v.metadata?.subtype==="init")&&v.metadata?.init_data)?.metadata?.init_data||null});function _(p){return typeof p=="string"?p:typeof p=="object"&&p.type==="preset"?`Preset: ${p.preset}`:JSON.stringify(p,null,2)}function r(p){p.target.select()}function w(){a.value=null,i.value=!1}function h(){w(),o.hideModal()}return ce(()=>o.currentModal,p=>{if(p?.name==="session-info"&&c){const g=p.data||{};a.value=g.sessionId,i.value=!1,c.show()}}),me(()=>{l.value&&ye(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(g=>g.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{c=new p(l.value),l.value.addEventListener("hidden.bs.modal",h)})}),he(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",h),c&&c.dispose()}),(p,g)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[t("div",yC,[t("div",$C,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",wC,[d.value?(u(),m("div",EC,[t("div",SC,[g[1]||(g[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",kC,S(a.value),1)]),t("div",TC,[g[2]||(g[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:d.value.cwd||"Not specified",readonly:"",onClick:r},null,8,xC)]),t("div",MC,[g[3]||(g[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,S(d.value.model||"Default"),1)]),t("div",AC,[g[4]||(g[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,S(d.value.permissionMode||"default"),1)]),t("div",OC,[g[5]||(g[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(d.value.allowed_tools||d.value.tools)&&(d.value.allowed_tools||d.value.tools).length>0?(u(),m("div",DC,[t("div",NC,[(u(!0),m(ie,null,de(d.value.allowed_tools||d.value.tools,b=>(u(),m("span",{key:b,class:"badge bg-secondary"},S(b),1))),128))])])):(u(),m("div",LC,"No pre-authorized tools (will prompt for permissions)"))]),d.value.commands&&d.value.commands.length>0?(u(),m("div",IC,[g[6]||(g[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",PC,[(u(!0),m(ie,null,de(d.value.commands,b=>(u(),m("span",{key:b,class:"badge bg-info"},S(b),1))),128))])])):N("",!0),d.value.systemPrompt?(u(),m("div",jC,[g[7]||(g[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",RC,S(_(d.value.systemPrompt)),1)])):N("",!0),t("div",VC,[t("h6",HC,[g[8]||(g[8]=X(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:g[0]||(g[0]=b=>i.value=!i.value)},S(i.value?"Hide":"Show"),1)]),i.value?(u(),m("pre",WC,S(JSON.stringify(d.value,null,2)),1)):N("",!0)])])):(u(),m("div",CC," No session configuration data available "))]),g[10]||(g[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},UC=z(FC,[["__scopeId","data-v-7b529fc9"]]),BC={class:"modal-dialog modal-dialog-centered"},qC={class:"modal-content"},zC={class:"modal-body"},KC={class:"mb-3"},GC=["value"],YC={key:0,class:"form-text"},JC={class:"mb-3"},XC={class:"mb-3"},QC={for:"minion-role",class:"form-label"},ZC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},eE={key:1,class:"field-indicator modified",title:"Modified from template"},tE=["placeholder","title"],sE={class:"mb-3"},nE={for:"minion-context",class:"form-label"},oE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},aE={key:1,class:"field-indicator modified",title:"Modified from template"},iE=["title"],lE={class:"form-text d-flex justify-content-between"},rE={key:0,class:"invalid-feedback"},cE={class:"mb-3 form-check"},dE={key:0,class:"form-text text-warning"},uE={class:"mb-3"},mE={class:"mb-3"},pE={class:"input-group"},fE={class:"mb-3"},vE={for:"permission-mode",class:"form-label"},hE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},_E={key:1,class:"field-indicator modified",title:"Modified from template"},gE=["title"],bE={class:"mb-3"},yE={for:"allowed-tools",class:"form-label"},$E={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},wE={key:1,class:"field-indicator modified",title:"Modified from template"},CE=["title"],EE={key:0,class:"alert alert-danger"},SE={class:"modal-footer"},kE=["disabled"],TE={key:0,class:"spinner-border spinner-border-sm me-2"},xE={__name:"CreateMinionModal",setup(n){const e=Ge(),s=ge(),o=ae(),a=fe(),i=M(null);let l=null;const c=M(null),d=M([]),_=M(null),r=M(new Set),w=M({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=M({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),p=M({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:""}),g=M(""),b=M(""),v=M(!1),f=y(()=>g.value.trim()?g.value.split(",").map(U=>U.trim()).filter(U=>U.length>0):[]),E=y(()=>p.value.allowed_tools.trim()?p.value.allowed_tools.split(",").map(U=>U.trim()).filter(U=>U.length>0):null),k=y(()=>p.value.initialization_context.length),T=y(()=>k.value>2e3),L=y(()=>k.value>1800&&k.value<=2e3),I=y(()=>_.value?d.value.find(U=>U.template_id===_.value):null),x=y(()=>I.value?.default_role||"e.g., Code Expert, Testing Specialist"),D=y(()=>({"field-autofilled":h.value.role==="autofilled","field-modified":h.value.role==="modified"})),B=y(()=>({"field-autofilled":h.value.initialization_context==="autofilled","field-modified":h.value.initialization_context==="modified"})),Q=y(()=>({"field-autofilled":h.value.permission_mode==="autofilled","field-modified":h.value.permission_mode==="modified"})),R=y(()=>({"field-autofilled":h.value.allowed_tools==="autofilled","field-modified":h.value.allowed_tools==="modified"})),$=U=>{const W=h.value[U];return W==="autofilled"?`Auto-filled from template: ${I.value?.name}`:W==="modified"?"Modified from template value":""};async function C(){try{console.log("[CreateMinionModal] Loading templates...");const U=await se.get("/api/templates");console.log("[CreateMinionModal] Templates data:",U),d.value=U||[],console.log("[CreateMinionModal] Templates set to:",d.value)}catch(U){console.error("[CreateMinionModal] Failed to load templates:",U),d.value=[]}}function A(){if(r.value.clear(),!I.value){p.value.role="",p.value.initialization_context="",p.value.permission_mode="default",p.value.allowed_tools="",h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},w.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const U=I.value;if(h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},U.default_role?(p.value.role=U.default_role,r.value.add("role"),w.value.role=U.default_role,h.value.role="autofilled"):(p.value.role="",w.value.role=null,h.value.role="normal"),U.default_system_prompt?(p.value.initialization_context=U.default_system_prompt,r.value.add("initialization_context"),w.value.initialization_context=U.default_system_prompt,h.value.initialization_context="autofilled"):(p.value.initialization_context="",w.value.initialization_context=null,h.value.initialization_context="normal"),U.permission_mode?(p.value.permission_mode=U.permission_mode,r.value.add("permission_mode"),w.value.permission_mode=U.permission_mode,h.value.permission_mode="autofilled"):(p.value.permission_mode="default",w.value.permission_mode=null,h.value.permission_mode="normal"),U.allowed_tools&&U.allowed_tools.length>0){const W=U.allowed_tools.join(", ");p.value.allowed_tools=W,r.value.add("allowed_tools"),w.value.allowed_tools=W,h.value.allowed_tools="autofilled"}else p.value.allowed_tools="",w.value.allowed_tools=null,h.value.allowed_tools="normal"}function O(){a.showModal("template-management",{})}function P(){const W=(c.value?s.projects.get(c.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:W,currentPath:p.value.working_directory||"",onSelect:ne=>{p.value.working_directory=ne}})}function V(){p.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:""},g.value="",_.value=null,r.value.clear(),h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},w.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},b.value="",v.value=!1}function Y(){V(),a.hideModal()}async function le(){if(!p.value.name.trim()){b.value="Minion name is required";return}if(p.value.name.includes(" ")){b.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(T.value){b.value="Initialization context exceeds 2000 character limit";return}if(!c.value){b.value="Legion ID is missing";return}v.value=!0,b.value="";try{const U={name:p.value.name.trim(),role:p.value.role.trim(),initialization_context:p.value.initialization_context.trim(),override_system_prompt:p.value.override_system_prompt,capabilities:f.value,permission_mode:p.value.permission_mode,allowed_tools:E.value,working_directory:p.value.working_directory.trim()||null},W=await se.post(`/api/legions/${c.value}/minions`,U);W.success&&W.minion_id?(await s.fetchProjects(),await o.fetchSessions(),l&&l.hide(),e.push(`/spy/${c.value}/${W.minion_id}`)):b.value="Failed to create minion"}catch(U){console.error("Failed to create minion:",U),b.value=U.response?.data?.detail||"Failed to create minion"}finally{v.value=!1}}return ce(()=>a.currentModal,(U,W)=>{if(U?.name==="create-minion"&&l){const ne=U.data||{};c.value=ne.project?.project_id||null,V(),C(),l.show()}else W?.name==="template-management"&&l&&i.value?.classList.contains("show")&&C()}),ce(()=>p.value.role,U=>{w.value.role!==null&&(U===w.value.role?h.value.role="autofilled":h.value.role="modified")}),ce(()=>p.value.initialization_context,U=>{w.value.initialization_context!==null&&(U===w.value.initialization_context?h.value.initialization_context="autofilled":h.value.initialization_context="modified")}),ce(()=>p.value.permission_mode,U=>{w.value.permission_mode!==null&&(U===w.value.permission_mode?h.value.permission_mode="autofilled":h.value.permission_mode="modified")}),ce(()=>p.value.allowed_tools,U=>{w.value.allowed_tools!==null&&(U===w.value.allowed_tools?h.value.allowed_tools="autofilled":h.value.allowed_tools="modified")}),me(()=>{i.value&&ye(()=>import("./modal-B4rHLo2F.js").then(U=>U.m),__vite__mapDeps([0,1])).then(U=>{const W=U.default;l=new W(i.value),i.value.addEventListener("hidden.bs.modal",Y)}),C()}),he(()=>{i.value&&i.value.removeEventListener("hidden.bs.modal",Y),l&&l.dispose()}),(U,W)=>(u(),m("div",{ref_key:"modalElement",ref:i,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[t("div",BC,[t("div",qC,[W[28]||(W[28]=t("div",{class:"modal-header"},[t("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",zC,[t("form",{onSubmit:be(le,["prevent"])},[t("div",KC,[t("label",{for:"template-select",class:"form-label"},[W[9]||(W[9]=X(" Template ",-1)),t("button",{type:"button",onClick:O,class:"btn btn-link btn-sm p-0 ms-2"}," âš™ï¸ Manage Templates ")]),oe(t("select",{id:"template-select","onUpdate:modelValue":W[0]||(W[0]=ne=>_.value=ne),onChange:A,class:"form-select"},[W[10]||(W[10]=t("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(ie,null,de(d.value,ne=>(u(),m("option",{key:ne.template_id,value:ne.template_id},S(ne.name),9,GC))),128))],544),[[Oe,_.value]]),I.value?(u(),m("div",YC,S(I.value.description),1)):N("",!0)]),t("div",JC,[W[11]||(W[11]=t("label",{for:"minion-name",class:"form-label"},[X(" Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"minion-name","onUpdate:modelValue":W[1]||(W[1]=ne=>p.value.name=ne),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[pe,p.value.name]]),W[12]||(W[12]=t("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),t("div",XC,[t("label",QC,[W[13]||(W[13]=X(" Role ",-1)),h.value.role==="autofilled"?(u(),m("span",ZC," âš¡ ")):N("",!0),h.value.role==="modified"?(u(),m("span",eE," âœï¸ ")):N("",!0)]),oe(t("input",{id:"minion-role","onUpdate:modelValue":W[2]||(W[2]=ne=>p.value.role=ne),type:"text",class:K(["form-control",D.value]),placeholder:x.value,title:$("role")},null,10,tE),[[pe,p.value.role]]),W[14]||(W[14]=t("div",{class:"form-text"}," Optional role description for the minion ",-1))]),t("div",sE,[t("label",nE,[W[15]||(W[15]=X(" Initialization Context ",-1)),h.value.initialization_context==="autofilled"?(u(),m("span",oE," âš¡ ")):N("",!0),h.value.initialization_context==="modified"?(u(),m("span",aE," âœï¸ ")):N("",!0)]),oe(t("textarea",{id:"minion-context","onUpdate:modelValue":W[3]||(W[3]=ne=>p.value.initialization_context=ne),class:K(["form-control",[B.value,{"is-invalid":T.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:$("initialization_context")},null,10,iE),[[pe,p.value.initialization_context]]),t("div",lE,[t("span",null,S(p.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),t("span",{class:K({"text-danger":T.value,"text-warning":L.value})},S(k.value)+" / 2000 chars ",3)]),T.value?(u(),m("div",rE," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):N("",!0)]),t("div",cE,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":W[4]||(W[4]=ne=>p.value.override_system_prompt=ne)},null,512),[[Dt,p.value.override_system_prompt]]),W[17]||(W[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),p.value.override_system_prompt?(u(),m("div",dE,[...W[16]||(W[16]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):N("",!0)]),t("div",uE,[W[18]||(W[18]=t("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),oe(t("input",{id:"minion-capabilities","onUpdate:modelValue":W[5]||(W[5]=ne=>g.value=ne),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[pe,g.value]]),W[19]||(W[19]=t("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),t("div",mE,[W[20]||(W[20]=t("label",{for:"working-directory",class:"form-label"}," Working Directory (Optional) ",-1)),t("div",pE,[oe(t("input",{id:"working-directory","onUpdate:modelValue":W[6]||(W[6]=ne=>p.value.working_directory=ne),type:"text",class:"form-control",placeholder:"Leave empty to inherit from legion"},null,512),[[pe,p.value.working_directory]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:P}," ðŸ“ Browse ")]),W[21]||(W[21]=t("div",{class:"form-text"}," Custom working directory for git worktrees or multi-repo workflows. Relative paths will be converted to absolute. ",-1))]),t("div",fE,[t("label",vE,[W[22]||(W[22]=X(" Permission Mode ",-1)),h.value.permission_mode==="autofilled"?(u(),m("span",hE," âš¡ ")):N("",!0),h.value.permission_mode==="modified"?(u(),m("span",_E," âœï¸ ")):N("",!0)]),oe(t("select",{class:K(["form-select",Q.value]),id:"permission-mode","onUpdate:modelValue":W[7]||(W[7]=ne=>p.value.permission_mode=ne),title:$("permission_mode")},[...W[23]||(W[23]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,gE),[[Oe,p.value.permission_mode]]),W[24]||(W[24]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",bE,[t("label",yE,[W[25]||(W[25]=X(" Allowed Tools (Optional) ",-1)),h.value.allowed_tools==="autofilled"?(u(),m("span",$E," âš¡ ")):N("",!0),h.value.allowed_tools==="modified"?(u(),m("span",wE," âœï¸ ")):N("",!0)]),oe(t("input",{type:"text",class:K(["form-control",R.value]),id:"allowed-tools","onUpdate:modelValue":W[8]||(W[8]=ne=>p.value.allowed_tools=ne),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:$("allowed_tools")},null,10,CE),[[pe,p.value.allowed_tools]]),W[26]||(W[26]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),b.value?(u(),m("div",EE,S(b.value),1)):N("",!0)],32)]),t("div",SE,[W[27]||(W[27]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",disabled:!p.value.name.trim()||v.value,onClick:le},[v.value?(u(),m("span",TE)):N("",!0),X(" "+S(v.value?"Creating...":"Create Minion"),1)],8,kE)])])])],512))}},ME=z(xE,[["__scopeId","data-v-df1241b1"]]),AE={class:"modal-dialog modal-dialog-centered modal-lg"},OE={class:"modal-content"},DE={class:"modal-body"},NE={key:0,class:"text-center text-muted py-4"},LE={key:1},IE={class:"mb-3"},PE={class:"mb-3"},jE={class:"font-monospace small"},RE={class:"mb-3"},VE={class:"mb-3"},HE={class:"mb-3"},WE={key:0},FE={class:"d-flex flex-wrap gap-1"},UE={key:1,class:"text-muted small"},BE={class:"mb-3"},qE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},zE={key:1,class:"text-muted small"},KE={class:"mb-3"},GE={key:0,class:"badge bg-info"},YE={key:1,class:"badge bg-secondary"},JE={class:"mb-3"},XE={key:0,class:"font-monospace small"},QE={key:1,class:"text-muted small"},ZE={key:0,class:"mb-3"},eS={key:0},tS={class:"list-unstyled mb-0"},sS={key:1,class:"text-muted small"},nS={class:"mb-3"},oS={key:0,class:"font-monospace small"},aS={key:1,class:"text-muted small"},iS={class:"mb-3"},lS={key:0},rS={class:"d-flex flex-wrap gap-1"},cS={key:1,class:"text-muted small"},dS={class:"mb-3"},uS={class:"small"},mS={class:"mb-3"},pS={class:"small"},fS={__name:"MinionViewModal",setup(n){const e=fe(),s=M(null),o=M(null);let a=null;function i(_){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[_]||"bg-secondary"}function l(_){if(!_)return"N/A";try{const r=new Date(_);return isNaN(r.getTime())?"Invalid date":r.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(r){return console.error("Error formatting timestamp:",r),"Invalid date"}}function c(){s.value=null}function d(){c(),e.hideModal()}return ce(()=>e.currentModal,_=>{if(_?.name==="minion-view"&&a){const r=_.data||{};s.value=r.session,a.show()}}),me(()=>{o.value&&ye(async()=>{const{default:_}=await import("./modal-B4rHLo2F.js").then(r=>r.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{a=new _(o.value),o.value.addEventListener("hidden.bs.modal",d)})}),he(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",d),a&&a.dispose()}),(_,r)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",AE,[t("div",OE,[r[13]||(r[13]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",DE,[s.value?(u(),m("div",LE,[t("div",IE,[r[0]||(r[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,S(s.value.name||"Unnamed Minion"),1)]),t("div",PE,[r[1]||(r[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",jE,S(s.value.session_id),1)]),t("div",RE,[r[2]||(r[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,S(s.value.role||"Not specified"),1)]),t("div",VE,[r[3]||(r[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:K(["badge",i(s.value.state)])},S(s.value.state),3)])]),t("div",HE,[r[4]||(r[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(u(),m("div",WE,[t("div",FE,[(u(!0),m(ie,null,de(s.value.capabilities,w=>(u(),m("span",{key:w,class:"badge bg-secondary"},S(w),1))),128))])])):(u(),m("div",UE,"None"))]),t("div",BE,[r[5]||(r[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(u(),m("div",qE,S(s.value.initialization_context),1)):(u(),m("div",zE,"Not specified"))]),t("div",KE,[r[6]||(r[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(u(),m("span",GE,"Yes")):(u(),m("span",YE,"No"))])]),t("div",JE,[r[7]||(r[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(u(),m("div",XE,S(s.value.parent_overseer_id),1)):(u(),m("div",QE,S(s.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),s.value.is_overseer?(u(),m("div",ZE,[r[8]||(r[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(u(),m("div",eS,[t("ul",tS,[(u(!0),m(ie,null,de(s.value.child_minion_ids,w=>(u(),m("li",{key:w,class:"font-monospace small"},S(w),1))),128))])])):(u(),m("div",sS,"No children"))])):N("",!0),t("div",nS,[r[9]||(r[9]=t("h6",{class:"text-muted"},"Horde Membership",-1)),s.value.horde_id?(u(),m("div",oS,S(s.value.horde_id),1)):(u(),m("div",aS,"Not in a horde"))]),t("div",iS,[r[10]||(r[10]=t("h6",{class:"text-muted"},"Channel Memberships",-1)),s.value.channel_ids&&s.value.channel_ids.length>0?(u(),m("div",lS,[t("div",rS,[(u(!0),m(ie,null,de(s.value.channel_ids,w=>(u(),m("span",{key:w,class:"badge bg-info"},S(w),1))),128))])])):(u(),m("div",cS,"No channels"))]),t("div",dS,[r[11]||(r[11]=t("h6",{class:"text-muted"},"Created",-1)),t("div",uS,S(l(s.value.created_at)),1)]),t("div",mS,[r[12]||(r[12]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",pS,S(l(s.value.updated_at)),1)])])):(u(),m("div",NE," No minion data available "))]),r[14]||(r[14]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},vS=z(fS,[["__scopeId","data-v-c44eaee2"]]),hS={class:"modal-dialog modal-lg"},_S={class:"modal-content"},gS={class:"modal-body"},bS={key:0,class:"template-list"},yS={key:0,class:"alert alert-info"},$S={class:"card-body"},wS={class:"d-flex justify-content-between align-items-start"},CS={class:"flex-grow-1"},ES={class:"card-title mb-1"},SS={class:"card-text text-muted small mb-2"},kS={class:"template-meta"},TS={class:"badge bg-secondary me-2"},xS={class:"text-muted small"},MS={class:"btn-group btn-group-sm ms-3"},AS=["onClick"],OS=["onClick"],DS={key:1,class:"template-form"},NS={class:"mb-3"},LS={class:"mb-3"},IS={class:"mb-3"},PS={class:"mb-3"},jS={class:"mb-3"},RS={class:"mb-3"},VS={class:"mb-3"},HS={key:0,class:"alert alert-danger"},WS={class:"d-flex gap-2"},FS=["disabled"],US={key:0,class:"spinner-border spinner-border-sm me-2"},BS={__name:"TemplateManagementModal",setup(n){const e=fe(),s=M(null);let o=null;const a=M([]),i=M(null),l=M(""),c=M(""),d=M(!1);async function _(){try{const v=await se.get("/api/templates");a.value=v||[]}catch(v){console.error("Failed to load templates:",v),a.value=[]}}function r(){i.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},l.value="",c.value=""}function w(v){i.value={...v},l.value=v.allowed_tools?.join(", ")||"",c.value=""}async function h(){if(!i.value.name.trim()){c.value="Template name is required";return}d.value=!0,c.value="";try{const v=l.value.split(",").map(k=>k.trim()).filter(k=>k.length>0),f={name:i.value.name.trim(),description:i.value.description?.trim()||null,permission_mode:i.value.permission_mode,allowed_tools:v.length>0?v:null,default_role:i.value.default_role?.trim()||null,default_system_prompt:i.value.default_system_prompt?.trim()||null};!i.value.template_id?await se.post("/api/templates",f):await se.put(`/api/templates/${i.value.template_id}`,f),await _(),i.value=null,l.value=""}catch(v){console.error("Failed to save template:",v),c.value=v.response?.data?.detail||"Failed to save template"}finally{d.value=!1}}async function p(v){if(confirm(`Delete template "${v.name}"?

This action cannot be undone.`))try{await se.delete(`/api/templates/${v.template_id}`),await _()}catch(f){console.error("Failed to delete template:",f),alert(`Failed to delete template: ${f.response?.data?.detail||f.message}`)}}function g(){i.value=null,l.value="",c.value=""}function b(){i.value=null,l.value="",c.value="",e.hideModal()}return ce(()=>e.currentModal,v=>{v?.name==="template-management"&&o&&(_(),o.show())}),me(()=>{s.value&&ye(()=>import("./modal-B4rHLo2F.js").then(v=>v.m),__vite__mapDeps([0,1])).then(v=>{const f=v.default;o=new f(s.value),s.value.addEventListener("hidden.bs.modal",b)})}),he(()=>{s.value&&s.value.removeEventListener("hidden.bs.modal",b),o&&o.dispose()}),(v,f)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[t("div",hS,[t("div",_S,[f[15]||(f[15]=t("div",{class:"modal-header"},[t("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",gS,[i.value?N("",!0):(u(),m("div",bS,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[f[6]||(f[6]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:r,class:"btn btn-primary btn-sm"}," âž• Create New ")]),a.value.length===0?(u(),m("div",yS," No templates found. Create your first template! ")):N("",!0),(u(!0),m(ie,null,de(a.value,E=>(u(),m("div",{key:E.template_id,class:"card mb-2"},[t("div",$S,[t("div",wS,[t("div",CS,[t("h6",ES,S(E.name),1),t("p",SS,S(E.description),1),t("div",kS,[t("span",TS,S(E.permission_mode),1),t("span",xS,S(E.allowed_tools?.length||0)+" tools",1)])]),t("div",MS,[t("button",{onClick:k=>w(E),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,AS),t("button",{onClick:k=>p(E),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,OS)])])])]))),128))])),i.value?(u(),m("div",DS,[t("h6",NS,S(i.value.template_id?"Edit Template":"Create Template"),1),t("div",LS,[f[7]||(f[7]=t("label",{for:"template-name",class:"form-label"},[X(" Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"template-name","onUpdate:modelValue":f[0]||(f[0]=E=>i.value.name=E),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[pe,i.value.name]])]),t("div",IS,[f[8]||(f[8]=t("label",{for:"template-description",class:"form-label"},"Description",-1)),oe(t("textarea",{id:"template-description","onUpdate:modelValue":f[1]||(f[1]=E=>i.value.description=E),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[pe,i.value.description]])]),t("div",PS,[f[10]||(f[10]=t("label",{for:"template-permission-mode",class:"form-label"},[X(" Permission Mode "),t("span",{class:"text-danger"},"*")],-1)),oe(t("select",{id:"template-permission-mode","onUpdate:modelValue":f[2]||(f[2]=E=>i.value.permission_mode=E),class:"form-select",required:""},[...f[9]||(f[9]=[t("option",{value:"default"},"Default",-1),t("option",{value:"acceptEdits"},"Accept Edits",-1),t("option",{value:"plan"},"Plan Mode",-1),t("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Oe,i.value.permission_mode]])]),t("div",jS,[f[11]||(f[11]=t("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),oe(t("input",{id:"template-tools","onUpdate:modelValue":f[3]||(f[3]=E=>l.value=E),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[pe,l.value]]),f[12]||(f[12]=t("div",{class:"form-text"},"Comma-separated list of tools",-1))]),t("div",RS,[f[13]||(f[13]=t("label",{for:"template-role",class:"form-label"},"Default Role",-1)),oe(t("input",{id:"template-role","onUpdate:modelValue":f[4]||(f[4]=E=>i.value.default_role=E),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[pe,i.value.default_role]])]),t("div",VS,[f[14]||(f[14]=t("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),oe(t("textarea",{id:"template-prompt","onUpdate:modelValue":f[5]||(f[5]=E=>i.value.default_system_prompt=E),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[pe,i.value.default_system_prompt]])]),c.value?(u(),m("div",HS,S(c.value),1)):N("",!0),t("div",WS,[t("button",{onClick:h,class:"btn btn-primary",disabled:d.value},[d.value?(u(),m("span",US)):N("",!0),X(" "+S(d.value?"Saving...":"Save Template"),1)],8,FS),t("button",{onClick:g,class:"btn btn-secondary"},"Cancel")])])):N("",!0)])])])],512))}},qS=z(BS,[["__scopeId","data-v-81126ff4"]]),zS={class:"container-fluid vh-100 d-flex flex-column p-0"},KS={class:"d-flex flex-grow-1 overflow-hidden position-relative"},GS={class:"flex-grow-1 d-flex flex-column overflow-hidden"},YS={__name:"App",setup(n){const e=fe(),s=je(),o=ae(),a=ge(),i=Ge(),l=y(()=>e.sidebarCollapsed),c=y(()=>e.isMobile);me(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const r=window.location.hash;if(r.startsWith("#/session/")){const w=r.replace("#/session/","");o.sessions.has(w)&&await o.selectSession(w)}else if(r.startsWith("#/timeline/")){const w=r.replace("#/timeline/","");i.push(`/timeline/${w}`)}window.addEventListener("popstate",d),window.addEventListener("resize",e.handleResize)}),he(()=>{window.removeEventListener("popstate",d),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function d(){const r=window.location.hash;if(r.startsWith("#/session/")){const w=r.replace("#/session/","");o.sessions.has(w)&&o.selectSession(w)}}function _(){e.toggleSidebar()}return(r,w)=>{const h=io("router-view");return u(),m("div",zS,[re(Oy),t("div",{id:"sidebar-backdrop",class:K({show:!l.value&&c.value}),onClick:_},null,2),t("div",KS,[re(X1),t("main",GS,[re(h)])]),re(f$),re(N$),re(tw),re(Ew),re(Qw),re(bC),re(UC),re(ME),re(vS),re(qS)])}}},an=ga(YS);an.use(ba());an.use(wy);an.mount("#app");
