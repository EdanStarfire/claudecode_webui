const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-BK1Vt_in.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as t,o as u,d as Ct,r as O,b as g,t as w,n as vt,e as Z,f as se,u as ts,w as le,g as _s,F as re,h as ue,i as A,j as ge,k as to,l as oe,v as de,m as Xe,p as ve,q as ce,s as pe,x as mi,y as Ps,z as _e,A as Pe,B as so,C as it,D as pi,E as fi,G as _t,H as vi,I as _i}from"./vue-vendor-CpnrLznN.js";import{m as tt,p as as}from"./markdown-vendor-BRsjnVvP.js";import{c as hi}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();const gi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},bi={__name:"NoSessionSelected",setup(n){return(e,s)=>(u(),m("div",gi,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},yi="modulepreload",$i=function(n){return"/"+n},mn={},be=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let p=function(v){return Promise.all(v.map(c=>Promise.resolve(c).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),r=l?.nonce||l?.getAttribute("nonce");i=p(s.map(v=>{if(v=$i(v),v in mn)return;mn[v]=!0;const c=v.endsWith(".css"),$=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${$}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":yi,c||(h.as="script"),h.crossOrigin="",h.href=v,r&&h.setAttribute("nonce",r),document.head.appendChild(h),c)return new Promise((f,b)=>{h.addEventListener("load",f),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${v}`)))})}))}function a(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return i.then(l=>{for(const r of l||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})};class hs extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function It(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new hs(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof hs?s:(console.error("API request failed:",s),new hs(`Network error: ${s.message}`,0,null))}}async function wi(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[r,p]of Object.entries(e.params))p!=null&&o.append(r,p);const i=o.toString();i&&(s=`${n}?${i}`);const{params:a,...l}=e;return It(s,{...l,method:"GET"})}return It(s,{...e,method:"GET"})}async function Ei(n,e,s={}){return It(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ci(n,e,s={}){return It(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Si(n,e={}){return It(n,{...e,method:"DELETE"})}const ie={get:wi,post:Ei,put:Ci,delete:Si},ae=Ct("session",()=>{const n=O(new Map),e=O(null),s=O(new Map),o=O(new Map),i=O(new Set),a=O(!1);let l=null;const r=g(()=>n.value.get(e.value)),p=g(()=>Array.from(n.value.values()).sort((N,j)=>N.order-j.order)),v=N=>g(()=>p.value.filter(j=>j.project_id===N)),c=g({get:()=>s.value.get(e.value)||"",set:N=>{e.value&&s.value.set(e.value,N)}});async function $(){try{const N=await ie.get("/api/sessions");return n.value.clear(),N.sessions.forEach(j=>{n.value.set(j.session_id,j)}),console.log(`Loaded ${n.value.size} sessions`),N.sessions}catch(N){throw console.error("Failed to fetch sessions:",N),N}}async function h(N,j){try{const D=(await ie.post("/api/sessions",{project_id:N,...j})).session_id,q=(await ie.get(`/api/sessions/${D}`)).session;return n.value.set(D,q),n.value=new Map(n.value),console.log(`Created session ${D}`),q}catch(k){throw console.error("Failed to create session:",k),k}}async function f(N){if(e.value===N&&!a.value)return;l&&(console.log(`Aborting pending selection to switch to ${N}`),l.abort(),l=null);const j=new AbortController;l=j,a.value=!0;try{if(e.value=N,j.signal.aborted){console.log(`Selection of ${N} aborted early`);return}let k=n.value.get(N);if(!k)try{const q=await ie.get(`/api/sessions/${N}`);if(j.signal.aborted){console.log(`Selection of ${N} aborted after fetch`);return}k=q.session,n.value.set(N,k),n.value=new Map(n.value),console.log(`Fetched session ${N} for deeplink`)}catch(q){console.error(`Failed to fetch session ${N}:`,q);return}if(k&&(k.state==="created"||k.state==="terminated"))try{if(await y(N),j.signal.aborted){console.log(`Selection of ${N} aborted after start`);return}console.log(`Auto-started session ${N} (was in ${k.state} state)`);const q=6e4,L=200,M=5e3;let P=0,T=0;for(;P<q;){if(j.signal.aborted){console.log(`Selection of ${N} aborted during state wait`);return}const I=n.value.get(N);if(I&&I.state==="active"){console.log(`Session ${N} is now active after ${P}ms`);break}if(P-T>=M){const U=n.value.get(N)?.state||"unknown";console.log(`Waiting for session ${N} to become active (current: ${U}, ${P/1e3}s elapsed)`),T=P}await new Promise(U=>setTimeout(U,L)),P+=L}const S=n.value.get(N);S&&S.state!=="active"&&console.warn(`Session ${N} did not become active within ${q/1e3}s (state: ${S.state}), continuing anyway`)}catch(q){console.error(`Failed to auto-start session ${N}:`,q)}if(j.signal.aborted){console.log(`Selection of ${N} aborted before message load`);return}if(await(await be(()=>Promise.resolve().then(()=>qi),void 0)).useMessageStore().loadMessages(N),j.signal.aborted){console.log(`Selection of ${N} aborted after message load`);return}await(await be(()=>Promise.resolve().then(()=>ma),void 0)).useWebSocketStore().connectSession(N),j.signal.aborted||console.log(`Selected session ${N}`)}finally{l===j&&(l=null),a.value=!1}}function b(N,j){const k=n.value.get(N);k?Object.assign(k,j):(n.value.set(N,j),console.log(`Added new session ${N} via WebSocket update`)),n.value=new Map(n.value)}async function E(N){i.value.add(N);try{const k=(await ie.delete(`/api/sessions/${N}`)).deleted_session_ids||[N];for(const D of k)n.value.delete(D),s.value.delete(D),o.value.delete(D);return n.value=new Map(n.value),k.includes(e.value)&&(e.value=null),console.log(`Deleted ${k.length} session(s): ${k.join(", ")}`),k}catch(j){throw console.error("Failed to delete session:",j),j}finally{i.value.delete(N)}}async function _(N,j){try{await ie.put(`/api/sessions/${N}/name`,{name:j}),b(N,{name:j}),console.log(`Updated session ${N} name to "${j}"`)}catch(k){throw console.error("Failed to update session name:",k),k}}async function d(N,j){try{await ie.post(`/api/sessions/${N}/permission-mode`,{mode:j}),b(N,{current_permission_mode:j});const k=o.value.get(N);k&&(k.permissionMode=j,o.value.set(N,k)),console.log(`Set permission mode for session ${N} to ${j}`)}catch(k){throw console.error("Failed to set permission mode:",k),k}}async function y(N){try{await ie.post(`/api/sessions/${N}/start`),console.log(`Started session ${N}`)}catch(j){throw console.error("Failed to start session:",j),j}}async function C(N){try{await ie.post(`/api/sessions/${N}/pause`),console.log(`Paused session ${N}`)}catch(j){throw console.error("Failed to pause session:",j),j}}async function x(N){try{await ie.post(`/api/sessions/${N}/terminate`),console.log(`Terminated session ${N}`)}catch(j){throw console.error("Failed to terminate session:",j),j}}function F(N){return n.value.get(N)}function R(N,j){o.value.set(N,j),j.permissionMode&&b(N,{current_permission_mode:j.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:r,orderedSessions:p,sessionsInProject:v,currentInput:c,fetchSessions:$,createSession:h,selectSession:f,updateSession:b,deleteSession:E,updateSessionName:_,setPermissionMode:d,startSession:y,pauseSession:C,terminateSession:x,getSession:F,storeInitData:R}}),pn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ae},Symbol.toStringTag,{value:"Module"})),me=Ct("ui",()=>{const n=O(window.innerWidth<768),e=O(300),s=O(window.innerWidth),o=g(()=>s.value<768),i=O(!0),a=O(null),l=O(null),r=g(()=>a.value?{name:a.value,data:l.value}:null),p=O(!1),v=O("Loading...");function c(){n.value=!n.value}function $(C){n.value=C}function h(C){e.value=Math.max(200,Math.min(C,window.innerWidth*.3))}function f(C){i.value=C}function b(C,x=null){a.value=null,l.value=null,setTimeout(()=>{a.value=C,l.value=x},0)}function E(){a.value=null,l.value=null}function _(C="Loading..."){p.value=!0,v.value=C}function d(){p.value=!1}function y(){const C=s.value;s.value=window.innerWidth,s.value<768&&C>=768?n.value=!0:s.value>=768&&C<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:l,currentModal:r,isLoading:p,loadingMessage:v,toggleSidebar:c,setSidebarCollapsed:$,setSidebarWidth:h,setAutoScroll:f,showModal:b,hideModal:E,showLoading:_,hideLoading:d,handleResize:y}}),we=Ct("project",()=>{const n=O(new Map),e=O(null),s=g(()=>n.value.get(e.value)),o=g(()=>Array.from(n.value.values()).sort((_,d)=>_.order-d.order));async function i(){try{const _=await ie.get("/api/projects");return n.value.clear(),_.projects.forEach(d=>{n.value.set(d.project_id,d)}),console.log(`Loaded ${n.value.size} projects`),_.projects}catch(_){throw console.error("Failed to fetch projects:",_),_}}async function a(_,d){try{const C=(await ie.post("/api/projects",{name:_,working_directory:d})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(y){throw console.error("Failed to create project:",y),y}}async function l(_,d){try{await ie.put(`/api/projects/${_}`,d),r(_,d),console.log(`Updated project ${_}`,d)}catch(y){throw console.error("Failed to update project:",y),y}}function r(_,d){const y=n.value.get(_);y&&(Object.assign(y,d),n.value=new Map(n.value))}async function p(_){try{await ie.delete(`/api/projects/${_}`),n.value.delete(_),n.value=new Map(n.value),e.value===_&&(e.value=null),console.log(`Deleted project ${_}`)}catch(d){throw console.error("Failed to delete project:",d),d}}async function v(_){try{const d=await ie.put(`/api/projects/${_}/toggle-expansion`),y=n.value.get(_);return y&&(y.is_expanded=d.is_expanded,n.value=new Map(n.value)),d.is_expanded}catch(d){throw console.error("Failed to toggle expansion:",d),d}}async function c(_){try{await ie.put("/api/projects/reorder",{project_ids:_}),_.forEach((d,y)=>{const C=n.value.get(d);C&&(C.order=y)}),n.value=new Map(n.value),console.log("Reordered projects",_)}catch(d){throw console.error("Failed to reorder projects:",d),d}}async function $(_,d){try{await ie.put(`/api/projects/${_}/sessions/reorder`,{session_ids:d});const y=n.value.get(_);y&&(y.session_ids=d,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${_}`,d)}catch(y){throw console.error("Failed to reorder sessions:",y),y}}function h(_){return n.value.get(_)}function f(_){e.value=_}function b(){e.value=null}function E(_){if(!_)return"";const d=_.split(/[/\\]/).filter(y=>y);return d.length===0?"/":d.length===1?`/${d[0]}`:d.length===2?`/${d.join("/")}`:`.../${d.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:i,createProject:a,updateProject:l,updateProjectLocal:r,deleteProject:p,toggleExpansion:v,reorderProjects:c,reorderSessionsInProject:$,getProject:h,selectProject:f,clearProjectSelection:b,formatPath:E}}),te=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},ki={class:"session-header border-bottom p-3"},Ti={class:"project-name"},xi=["title"],Ai={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=we(),i=g(()=>s.sessions.get(e.sessionId)),a=g(()=>i.value?.name||e.sessionId),l=g(()=>{for(const p of o.projects.values())if(p.session_ids?.includes(e.sessionId))return p;return null}),r=g(()=>l.value?.name||"Unknown Project");return(p,v)=>(u(),m("div",ki,[t("div",null,[t("div",Ti,w(r.value),1),t("div",{class:"session-name",title:n.sessionId},w(a.value),9,xi)])]))}},Mi=te(Ai,[["__scopeId","data-v-89e9c269"]]),Oi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ni=["title"],Di={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Li={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=g(()=>s.sessions.get(e.sessionId)),i=g(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=g(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),l=g(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),r=g(()=>{if(!o.value)return"No session selected";const p=i.value,v=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",$=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${$}: ${v}`});return(p,v)=>(u(),m("div",Oi,[o.value?(u(),m("div",{key:0,class:Z(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:vt({width:"100%",backgroundColor:a.value}),title:r.value},null,14,Ni)):(u(),m("div",Di))]))}},Ii=te(Li,[["__scopeId","data-v-e8795bb7"]]),Pi={class:"session-status-bar border-top p-2 bg-light"},ji={class:"d-flex justify-content-between align-items-center gap-2"},Ri={class:"d-flex gap-2"},Hi=["disabled"],Vi={class:"mode-label"},Wi=["disabled"],Fi=["disabled"],Ui={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=me(),i=g(()=>s.sessions.get(e.sessionId)),a=g(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},r=g(()=>l[a.value]||"ðŸ”’"),p=g(()=>a.value),v=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(d){console.error("Failed to cycle permission mode:",d)}return}const E=(v.indexOf(a.value)+1)%v.length,_=v[E];try{await s.setPermissionMode(e.sessionId,_)}catch(d){console.error("Failed to cycle permission mode:",d)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:i.value})},f=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(b,E)=>(u(),m("div",Pi,[t("div",ji,[t("div",Ri,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[se(w(r.value)+" ",1),t("span",Vi,w(p.value),1)],8,Hi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...E[0]||(E[0]=[se(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,Wi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[...E[1]||(E[1]=[se(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,Fi)]),t("div",null,[t("button",{class:Z(["btn btn-sm",ts(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:f}," â¬‡ï¸ "+w(ts(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Bi=te(Ui,[["__scopeId","data-v-fdcd3535"]]),xe=Ct("message",()=>{const n=O(new Map),e=O(new Map),s=O(new Map),o=O(new Map),i=O(new Map),a=O(new Map),l=O(new Map),r=O(new Map),p=g(()=>{const T=ae();return n.value.get(T.currentSessionId)||[]}),v=g(()=>{const T=ae();return e.value.get(T.currentSessionId)||[]});async function c(T,S=null,I=0){try{const U=S||1e4,Y=await ie.get(`/api/sessions/${T}/messages?limit=${U}&offset=${I}`),X=Y.messages||[],G=Y.total_count||X.length,H=Y.has_more||!1;if(console.log(`Loaded ${X.length} of ${G} messages for session ${T}`),n.value.set(T,X),X.length>0){const V=X[X.length-1];V.timestamp&&(l.value.set(T,V.timestamp),console.log(`Tracked last received timestamp for session ${T}: ${V.timestamp}`))}const J=new Set;X.forEach(V=>{V.type==="assistant"&&V.metadata?.tool_uses&&V.metadata.tool_uses.forEach(W=>{J.add(W.id)}),V.type==="user"&&V.metadata?.tool_results&&V.metadata.tool_results.forEach(W=>{J.delete(W.tool_use_id);const Q=a.value.get(T);Q&&Q.delete(W.tool_use_id)}),V.type==="system"&&V.metadata?.subtype==="client_launched"&&(J.forEach(W=>{j(T,W,"Session was restarted")}),J.clear()),V.type==="system"&&V.metadata?.subtype==="interrupt"&&(J.forEach(W=>{j(T,W,"Session was interrupted")}),J.clear()),V.metadata?.has_tool_uses&&V.metadata.tool_uses&&V.metadata.tool_uses.forEach(W=>{E(T,W)}),V.metadata?.has_tool_results&&V.metadata.tool_results&&V.metadata.tool_results.forEach(W=>{y(T,W)}),(V.type==="permission_request"||V.metadata?.has_permission_requests)&&_(T,V),V.type==="system"&&(V.subtype==="init"||V.metadata?.subtype==="init")&&V.metadata?.init_data&&ae().storeInitData(T,V.metadata.init_data)});const z=ae().sessions.get(T);return z&&!["active","paused","starting"].includes(z.state)&&(J.forEach(V=>{j(T,V,"Session was terminated")}),J.clear()),i.value.set(T,J),n.value=new Map(n.value),H&&console.warn(`Warning: Only loaded ${X.length} of ${G} messages. Some messages may be missing.`),{messages:X,totalCount:G,hasMore:H}}catch(U){throw console.error("Failed to load messages:",U),U}}function $(T,S){const I=i.value.get(T)||new Set;S.type==="assistant"&&S.metadata?.tool_uses&&S.metadata.tool_uses.forEach(U=>{I.add(U.id)}),S.type==="user"&&S.metadata?.tool_results&&S.metadata.tool_results.forEach(U=>{I.delete(U.tool_use_id);const Y=a.value.get(T);Y&&Y.delete(U.tool_use_id)}),S.type==="system"&&S.metadata?.subtype==="client_launched"&&(I.forEach(U=>{j(T,U,"Session was restarted")}),I.clear()),S.type==="system"&&S.metadata?.subtype==="interrupt"&&(I.forEach(U=>{j(T,U,"Session was interrupted")}),I.clear()),i.value.set(T,I)}function h(T,S){n.value.has(T)||n.value.set(T,[]);const I=n.value.get(T);if(S.id){const U=I.findIndex(Y=>Y.id===S.id);if(U!==-1){console.log(`Skipping duplicate message ${S.id} (already exists at index ${U})`);return}}I.push(S),S.timestamp&&l.value.set(T,S.timestamp),F(T,S),$(T,S),n.value=new Map(n.value)}function f(T,S){e.value.has(T)||e.value.set(T,[]),e.value.get(T).push(S),e.value=new Map(e.value)}function b(T,S,I){const U=e.value.get(T);if(U){const Y=U.find(X=>X.id===S);Y&&(Object.assign(Y,I),e.value=new Map(e.value))}}function E(T,S){const I=x(S.name,S.input);s.value.set(I,S.id);const U={id:S.id,name:S.name,input:S.input,signature:I,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return f(T,U),console.log(`Created tool call ${U.id} for ${U.name}`),U}function _(T,S){console.log("handlePermissionRequest received:",S);const I=S.metadata?.tool_name||S.tool_name,U=S.metadata?.input_params||S.input_params,Y=S.metadata?.request_id||S.request_id,X=S.metadata?.suggestions||S.suggestions||[];console.log("Extracted data:",{toolName:I,inputParams:U,requestId:Y,suggestions:X});const G=x(I,U),H=s.value.get(G);H?(o.value.set(Y,H),b(T,H,{status:"permission_required",permissionRequestId:Y,suggestions:X}),console.log(`Permission required for tool ${H}`,{suggestions:X})):console.warn("No tool use ID found for permission request signature:",G,{toolName:I,inputParams:U,availableSignatures:Array.from(s.value.keys())})}function d(T,S){const I=o.value.get(S.request_id);if(I){const U={permissionDecision:S.decision,appliedUpdates:S.applied_updates||[]};S.decision==="allow"?U.status="executing":(U.status="completed",U.result={error:!0,message:S.reasoning||"Permission denied"},U.isExpanded=!1),b(T,I,U),console.log(`Permission ${S.decision} for tool ${I}`)}}function y(T,S){const I=S.tool_use_id;b(T,I,{status:S.is_error?"error":"completed",result:{error:S.is_error,content:S.content},isExpanded:!1}),console.log(`Tool ${I} ${S.is_error?"failed":"completed"}`)}function C(T,S){const I=e.value.get(T);if(I){const U=I.find(Y=>Y.id===S);U&&(U.isExpanded=!U.isExpanded,e.value=new Map(e.value))}}function x(T,S){if(!T)return"unknown:{}";if(!S||typeof S!="object")return`${T}:{}`;const I=JSON.stringify(S,Object.keys(S).sort());return`${T}:${I}`}function F(T,S){const I=S.metadata?.display||S.display;if(!I)return;r.value.has(T)||r.value.set(T,new Map);const U=r.value.get(T);if(I.tool_states)for(const[Y,X]of Object.entries(I.tool_states)){U.set(Y,X);const G=e.value.get(T);if(G){const H=G.find(J=>J.id===Y);if(H){const J={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};H.status=J[X.state]||X.state,H.backendState=X}}}if(I.orphaned_tools&&I.orphaned_tools.length>0){const Y=a.value.get(T)||new Map;for(const X of I.orphaned_tools)Y.has(X)||Y.set(X,{reason:"denied",message:"Session was interrupted"});a.value.set(T,Y)}if(I.linked_permissions)for(const[Y,X]of Object.entries(I.linked_permissions))o.value.set(Y,X);I.tool_states&&Object.keys(I.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${T}:`,{toolStates:Object.keys(I.tool_states||{}).length,orphanedTools:(I.orphaned_tools||[]).length,linkedPermissions:Object.keys(I.linked_permissions||{}).length})}function R(T,S){return r.value.get(T)?.get(S)}function N(T){const S=r.value.get(T);return S&&S.size>0}function j(T,S,I){const U=a.value.get(T)||new Map;U.set(S,{reason:"denied",message:I}),a.value.set(T,U);const Y=e.value.get(T);if(Y){const X=Y.find(G=>G.id===S);X&&X.isExpanded&&(X.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${S} as orphaned: ${I}`)}function k(T,S){const I=R(T,S);return I&&I.state==="orphaned"?!0:a.value.get(T)?.has(S)||!1}function D(T,S){const I=R(T,S);return I&&I.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:I}:a.value.get(T)?.get(S)}function K(T,S){const I=i.value.get(T);I&&I.size>0&&(I.forEach(U=>j(T,U,S)),I.clear())}function q(T){n.value.delete(T),e.value.delete(T),n.value=new Map(n.value),e.value=new Map(e.value)}function L(T){return l.value.get(T)}async function M(T){const S=l.value.get(T);if(!S)return console.log(`No sync needed for session ${T} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${T} since ${S}`);const I=await ie.get(`/api/sessions/${T}/messages?limit=1000&offset=0`),U=I.messages||[],Y=I.has_more||!1,X=W=>W?typeof W=="number"?W*1e3:new Date(W).getTime():0,G=X(S),H=U.filter(W=>W.timestamp?X(W.timestamp)>G:!1);if(H.length===0)return console.log(`No missed messages for session ${T}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${H.length} missed messages for session ${T}`);const J=n.value.get(T)||[],he=new Set(J.map(W=>W.id).filter(Boolean)),z=H.filter(W=>!W.id||!he.has(W.id));if(console.log(`After deduplication: ${z.length} unique new messages`),z.length>0){const W=z.sort((We,At)=>{const Mt=X(We.timestamp),rt=X(At.timestamp);return Mt-rt}),Q=n.value.get(T)||[],ne=Q.length>0?X(Q[Q.length-1].timestamp):0,fe=X(W[0].timestamp),fs=X(W[W.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Q.length,lastExisting:ne,lastExistingDate:Q.length>0?Q[Q.length-1].timestamp:"none",firstNew:fe,firstNewDate:W[0].timestamp,lastNew:fs,lastNewDate:W[W.length-1].timestamp,shouldAppend:fe>ne}),fe>ne){const We=[...Q,...W];n.value.set(T,We),console.log(`âœ… Appended ${W.length} new messages (no full sort needed)`)}else{const We=[...Q,...W].sort((At,Mt)=>{const rt=X(At.timestamp),Ut=X(Mt.timestamp);return rt-Ut});n.value.set(T,We),console.log(`âš ï¸ Merged and sorted ${W.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${J.length} messages unchanged`);z.forEach(W=>{$(T,W),W.metadata?.has_tool_uses&&W.metadata.tool_uses&&W.metadata.tool_uses.forEach(Q=>{E(T,Q)}),W.metadata?.has_tool_results&&W.metadata.tool_results&&W.metadata.tool_results.forEach(Q=>{y(T,Q)}),(W.type==="permission_request"||W.metadata?.has_permission_requests)&&_(T,W),W.type==="system"&&(W.subtype==="init"||W.metadata?.subtype==="init")&&W.metadata?.init_data&&ae().storeInitData(T,W.metadata.init_data)});const V=n.value.get(T);if(V&&V.length>0){const W=V[V.length-1];W.timestamp&&l.value.set(T,W.timestamp)}return n.value=new Map(n.value),{syncedCount:z.length,hasMore:Y}}catch(I){return console.error(`Failed to sync messages for session ${T}:`,I),{syncedCount:0,hasMore:!1,error:I.message}}}const P=ae();return le(()=>Array.from(P.sessions.values()).map(S=>({id:S.session_id,state:S.state})),(T,S)=>{S&&T.forEach((I,U)=>{const Y=S[U];if(!Y||Y.id!==I.id)return;const X=["active","paused","starting"].includes(Y.state),G=!["active","paused","starting"].includes(I.state);X&&G&&K(I.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:_s(i),orphanedToolUses:_s(a),currentMessages:p,currentToolCalls:v,loadMessages:c,addMessage:h,addToolCall:f,updateToolCall:b,handleToolUse:E,handlePermissionRequest:_,handlePermissionResponse:d,handleToolResult:y,toggleToolExpansion:C,clearMessages:q,markToolUseOrphaned:j,isToolUseOrphaned:k,getOrphanedInfo:D,clearOrphanedToolUses:K,getLastReceivedTimestamp:L,syncMessages:M,getBackendToolState:R,hasBackendDisplayMetadata:N,backendToolStates:_s(r)}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:xe},Symbol.toStringTag,{value:"Module"}));function zi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Pt(n){return zi(n).toLocaleTimeString()}const Ki={class:"message-row message-row-user"},Gi=["title"],Yi={class:"message-content-column"},Ji=["innerHTML"],Xi={key:0,class:"tool-results mt-2"},Qi={class:"tool-results-header text-muted small mb-2"},Zi={class:"d-flex align-items-start gap-2"},ea={class:"flex-grow-1"},ta={class:"text-muted"},sa={key:0,class:"text-danger small"},na={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;tt.setOptions({breaks:!0,gfm:!0});const s=g(()=>Pt(e.message.timestamp)),o=g(()=>`user
${s.value}`),i=g(()=>{const p=e.message.content||"";let v=tt.parse(p);return v=v.replace(/\n</g,"<"),v=v.replace(/\n+$/,""),as.sanitize(v)}),a=g(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=g(()=>e.message.metadata?.tool_results||[]);function r(p,v){return p?p.length<=v?p:p.substring(0,v)+"...":""}return(p,v)=>(u(),m("div",Ki,[t("div",{class:"message-speaker",title:o.value},[...v[0]||(v[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,Gi),t("div",Yi,[t("div",{class:"message-text",innerHTML:i.value},null,8,Ji),a.value?(u(),m("div",Xi,[t("div",Qi," ðŸ”§ Tool Results ("+w(l.value.length)+") ",1),(u(!0),m(re,null,ue(l.value,(c,$)=>(u(),m("div",{key:$,class:Z(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",Zi,[t("span",null,w(c.is_error?"âŒ":"âœ…"),1),t("div",ea,[t("small",ta,"Tool: "+w(c.tool_use_id),1),c.is_error?(u(),m("div",sa,w(r(c.content,200)),1)):A("",!0)])])],2))),128))])):A("",!0)])]))}},oa=te(na,[["__scopeId","data-v-7665755b"]]),ia={class:"thinking-block"},aa=["aria-label"],la={class:"text-muted ms-auto"},ra={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ca=["innerHTML"],ua={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=O(!1),o=g(()=>e.thinking?.length||0),i=g(()=>{const l=e.thinking||"",r=tt.parse(l);return as.sanitize(r)});function a(){s.value=!s.value}return(l,r)=>(u(),m("div",ia,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[t("span",{"aria-label":s.value?"Collapse":"Expand"},w(s.value?"â–¾":"â–¸"),9,aa),r[0]||(r[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",la,w(o.value)+" characters",1)]),s.value?(u(),m("div",ra,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,ca)])):A("",!0)]))}},da=te(ua,[["__scopeId","data-v-fda2352c"]]),ze=Ct("websocket",()=>{const n=O(null),e=O(!1),s=O(0),o=10,i=O(null),a=O(!1),l=O(0),r=5,p=O(null);let v=null;const c=O(0),$=O(null),h=O(new Map),f=O(null),b=O(!1),E=O(0),_=5,d=O(null),y=1e4,C=1e3,x=O(Date.now()),F=O(Date.now()),R=O(Date.now());let N=null,j=null,k=null;const D=g(()=>e.value&&(a.value||!p.value)?"connected":e.value?"partial":"disconnected");function K(z){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${z}`}function q(z){const V={ui:{timer:()=>N,setTimer:W=>{N=W},lastPing:x,connected:e,name:"UI"},session:{timer:()=>j,setTimer:W=>{j=W},lastPing:F,connected:a,name:"Session"},legion:{timer:()=>k,setTimer:W=>{k=W},lastPing:R,connected:b,name:"Legion"}}[z];V.timer()&&clearInterval(V.timer()),V.setTimer(setInterval(()=>{if(!V.connected.value)return;const W=Date.now()-V.lastPing.value;if(W>y){console.warn(`âš ï¸ ${V.name} WebSocket heartbeat timeout (${W}ms since last ping) - forcing close to trigger reconnection`),V.connected.value=!1;const ne={ui:n,session:i,legion:f}[z];ne.value&&ne.value.readyState===WebSocket.OPEN&&ne.value.close()}},C)),console.log(`âœ… Started heartbeat monitor for ${V.name} WebSocket`)}function L(z){const V={ui:{get:()=>N,set:W=>{N=W}},session:{get:()=>j,set:W=>{j=W}},legion:{get:()=>k,set:W=>{k=W}}}[z];V.get()&&(clearInterval(V.get()),V.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${z} WebSocket`))}function M(){if(n.value)return;const z=K("/ws/ui");console.log(`Connecting to UI WebSocket: ${z}`),n.value=new WebSocket(z),n.value.onopen=()=>{e.value=!0,s.value=0,x.value=Date.now(),q("ui"),console.log("UI WebSocket connected")},n.value.onmessage=V=>{const W=JSON.parse(V.data);X(W)},n.value.onclose=()=>{if(L("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const V=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${V}ms (attempt ${s.value})`),setTimeout(M,V)}},n.value.onerror=V=>{console.error("UI WebSocket error:",V)}}function P(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function T(z){c.value++;const V=c.value;if(console.log(`[Gen ${V}] Starting connection to session ${z}`),v&&(clearTimeout(v),v=null),await S(),c.value!==V){console.log(`[Gen ${V}] Connection cancelled (current generation: ${c.value})`);return}p.value=z,$.value=V;const W=K(`/ws/session/${z}`);console.log(`[Gen ${V}] Connecting to Session WebSocket: ${W}`),i.value=new WebSocket(W),i.value.onopen=async()=>{if($.value!==V){console.log(`[Gen ${V}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}a.value=!0,l.value=0,F.value=Date.now(),q("session"),console.log(`[Gen ${V}] Session WebSocket connected for ${z}`);const Q=h.value.get(z);if(h.value.set(z,!0),Q){console.log(`[Gen ${V}] Reconnection detected, syncing missed messages...`);try{const fe=await xe().syncMessages(z);fe.syncedCount>0?console.log(`[Gen ${V}] âœ… Synced ${fe.syncedCount} missed messages`):fe.error?console.warn(`[Gen ${V}] âš ï¸ Message sync failed: ${fe.error}`):console.log(`[Gen ${V}] No missed messages to sync`),fe.hasMore&&console.warn(`[Gen ${V}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ne){console.error(`[Gen ${V}] Error during message sync:`,ne)}}else console.log(`[Gen ${V}] Initial connection, no sync needed`)},i.value.onmessage=Q=>{if($.value!==V){console.log(`[Gen ${V}] Ignoring message (stale connection, current: ${$.value})`);return}const ne=JSON.parse(Q.data);G(ne,z)},i.value.onclose=()=>{L("session"),a.value=!1,i.value=null,console.log(`[Gen ${V}] Session WebSocket closed for ${z}`);const Q=ae();if(Q.currentSessionId===z&&$.value===V&&l.value<r){l.value++;const ne=Math.min(2e3*l.value,3e4);console.log(`[Gen ${V}] Reconnecting Session WebSocket in ${ne}ms (attempt ${l.value})`),v=setTimeout(()=>{$.value===V&&Q.currentSessionId===z?(v=null,T(z)):console.log(`[Gen ${V}] Skipping reconnect (generation or session changed)`)},ne)}},i.value.onerror=Q=>{console.error(`[Gen ${V}] Session WebSocket error:`,Q)}}function S(){return new Promise(z=>{if(v&&(clearTimeout(v),v=null,console.log("Cancelled pending session reconnect timer")),i.value){const V=p.value,W=()=>{i.value=null,a.value=!1,p.value=null,$.value=null,l.value=0,V&&h.value.delete(V),z()};if(i.value.readyState===WebSocket.CLOSED)W();else{const Q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),W()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Q),W()},{once:!0}),i.value.close()}}else p.value=null,$.value=null,z()})}function I(z){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:z})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function U(z,V,W=!1,Q=null){if(i.value&&a.value){const ne={type:"permission_response",request_id:z,decision:V,apply_suggestions:W,timestamp:new Date().toISOString()};Q&&(ne.clarification_message=Q),i.value.send(JSON.stringify(ne)),console.log(`Sent permission ${V} for request ${z}`,{applySuggestions:W,clarification:Q})}}function Y(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function X(z){const V=ae(),W=we();switch(z.type){case"sessions_list":z.sessions&&Array.isArray(z.sessions)&&z.sessions.forEach(Q=>{V.updateSession(Q.session_id,Q)});break;case"state_change":z.data&&z.data.session_id&&z.data.session&&V.updateSession(z.data.session_id,z.data.session);break;case"project_updated":if(z.data&&z.data.project){const Q=z.data.project;W.updateProjectLocal(Q.project_id,Q),V.fetchSessions()}break;case"project_deleted":z.data&&z.data.project_id&&W.projects.delete(z.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":x.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",z.type)}}function G(z,V){const W=ae();if(W.currentSessionId!==V){console.warn(`Ignoring message for session ${V} (current: ${W.currentSessionId})`);return}const Q=xe();switch(z.type){case"message":const ne=z.data;if(!ne||!ne.type){console.warn("Received message event with invalid data:",z);break}if(ne.type==="permission_request"){Q.handlePermissionRequest(V,ne);break}if(ne.type==="permission_response"){Q.handlePermissionResponse(V,ne);break}ne.metadata?.has_tool_uses&&ne.metadata.tool_uses.forEach(fe=>{Q.handleToolUse(V,fe)}),ne.metadata?.has_tool_results&&ne.metadata.tool_results.forEach(fe=>{Q.handleToolResult(V,fe)}),ne.type==="system"&&(ne.subtype==="init"||ne.metadata?.subtype==="init")&&ne.metadata?.init_data&&W.storeInitData(V,ne.metadata.init_data),Q.addMessage(V,ne);break;case"permission_request":Q.handlePermissionRequest(V,z);break;case"permission_response":Q.handlePermissionResponse(V,z);break;case"tool_result":Q.handleToolResult(V,z);break;case"state_change":W.updateSession(V,z.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${V}`);break;case"ping":F.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function H(z){J(),d.value=z;const V=K(`/ws/legion/${z}`);console.log(`Connecting to Legion WebSocket: ${V}`),f.value=new WebSocket(V),f.value.onopen=()=>{b.value=!0,E.value=0,R.value=Date.now(),q("legion"),console.log(`Legion WebSocket connected for ${z}`)},f.value.onmessage=W=>{const Q=JSON.parse(W.data);he(Q,z)},f.value.onclose=()=>{if(L("legion"),b.value=!1,f.value=null,console.log(`Legion WebSocket closed for ${z}`),d.value===z&&E.value<_){E.value++;const W=Math.min(2e3*E.value,3e4);setTimeout(()=>H(z),W)}},f.value.onerror=W=>{console.error("Legion WebSocket error:",W)}}function J(){f.value&&(f.value.close(),f.value=null,b.value=!1,d.value=null)}function he(z,V){be(async()=>{const{useLegionStore:W}=await Promise.resolve().then(()=>nh);return{useLegionStore:W}},void 0).then(({useLegionStore:W})=>{const Q=W();switch(z.type){case"comm":z.comm&&(Q.addComm(V,z.comm),console.log("Legion WebSocket: Received new comm",z.comm));break;case"minion_created":z.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",z.data),be(async()=>{const{useSessionStore:ne}=await Promise.resolve().then(()=>pn);return{useSessionStore:ne}},void 0).then(({useSessionStore:ne})=>{ne().loadSessions()}));break;case"minion_updated":z.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",z.data),be(async()=>{const{useSessionStore:ne}=await Promise.resolve().then(()=>pn);return{useSessionStore:ne}},void 0).then(({useSessionStore:ne})=>{ne().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${V}`);break;case"ping":R.value=Date.now(),f.value?.readyState===WebSocket.OPEN&&f.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",z.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:a,sessionRetryCount:l,legionConnected:b,legionRetryCount:E,overallStatus:D,connectUI:M,disconnectUI:P,connectSession:T,disconnectSession:S,sendMessage:I,sendPermissionResponse:U,interruptSession:Y,connectLegion:H,disconnectLegion:J}}),ma=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ze},Symbol.toStringTag,{value:"Module"})),pa={class:"base-tool-handler"},fa={class:"tool-section"},va={class:"tool-parameters"},_a={class:"tool-code"},ha={key:0,class:"tool-section"},ga={class:"tool-section-label"},ba={class:"tool-code"},ya={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=g(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,r)=>(u(),m("div",pa,[t("div",fa,[r[0]||(r[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",va,[t("pre",_a,w(s.value),1)])]),o.value?(u(),m("div",ha,[t("div",ga,w(i.value?"Error:":"Result:"),1),t("div",{class:Z(["tool-result",{"tool-result-error":i.value}])},[t("pre",ba,w(a.value),1)],2)])):A("",!0)]))}},$a=te(ya,[["__scopeId","data-v-1e69f57d"]]),wa={class:"read-tool-handler"},Ea={class:"tool-section"},Ca={class:"read-file-info"},Sa={class:"file-path"},ka={key:0,class:"read-range"},Ta={key:0,class:"tool-section"},xa={key:0,class:"tool-result tool-result-error"},Aa={class:"tool-code"},Ma={key:1,class:"file-content-preview"},Oa={class:"content-header"},Na={class:"line-count-badge"},Da={key:0,class:"preview-note"},La={class:"tool-code content-display"},Ia={key:0,class:"more-indicator"},gs=100,Pa={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>{const f=e.toolCall.input?.offset,b=e.toolCall.input?.limit;return f!==void 0||b!==void 0}),i=g(()=>{const f=e.toolCall.input?.offset;return f!==void 0?f+1:1}),a=g(()=>{const f=e.toolCall.input?.offset||0,b=e.toolCall.input?.limit;return b!==void 0?f+b:"âˆž"}),l=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=g(()=>{if(!l.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),v=g(()=>r.value||!p.value?[]:p.value.split(`
`)),c=g(()=>v.value.length),$=g(()=>c.value>gs),h=g(()=>r.value?"":v.value.slice(0,gs).join(`
`));return(f,b)=>(u(),m("div",wa,[t("div",Ea,[t("div",Ca,[b[0]||(b[0]=t("span",{class:"file-icon"},"ðŸ“„",-1)),b[1]||(b[1]=t("strong",null,"Reading:",-1)),t("code",Sa,w(s.value),1),o.value?(u(),m("span",ka,"Lines "+w(i.value)+"-"+w(a.value),1)):A("",!0)])]),l.value?(u(),m("div",Ta,[r.value?(u(),m("div",xa,[t("pre",Aa,w(p.value),1)])):(u(),m("div",Ma,[t("div",Oa,[b[2]||(b[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Na,w(c.value)+" lines",1),$.value?(u(),m("span",Da,"(showing first "+w(gs)+")")):A("",!0)]),t("pre",La,w(h.value),1),$.value?(u(),m("div",Ia,"...")):A("",!0)]))])):A("",!0)]))}},ja=te(Pa,[["__scopeId","data-v-1f2b0569"]]),Ra={class:"write-tool-handler"},Ha={class:"tool-section"},Va={class:"write-file-info mb-2"},Wa={class:"file-path"},Fa={class:"write-content-preview"},Ua={class:"content-header"},Ba={class:"line-count-badge"},qa={key:0,class:"preview-note"},za={class:"tool-code content-display"},Ka={key:0,class:"more-indicator"},Ga={key:0,class:"tool-section"},Ya={key:0,class:"tool-result tool-result-error"},Ja={class:"tool-code"},Xa={key:1,class:"tool-result tool-result-success"},Qa={class:"success-message"},bs=100,Za={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.content||""),i=g(()=>o.value.split(`
`)),a=g(()=>i.value.length),l=g(()=>a.value>bs),r=g(()=>i.value.slice(0,bs).join(`
`)),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>{if(!p.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,h)=>(u(),m("div",Ra,[t("div",Ha,[t("div",Va,[h[0]||(h[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",Wa,w(s.value),1)]),t("div",Fa,[t("div",Ua,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Ba,w(a.value)+" lines",1),l.value?(u(),m("span",qa,"(showing first "+w(bs)+")")):A("",!0)]),t("pre",za,w(r.value),1),l.value?(u(),m("div",Ka,"...")):A("",!0)])]),p.value?(u(),m("div",Ga,[v.value?(u(),m("div",Ya,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",Ja,w(c.value),1)])):(u(),m("div",Xa,[t("div",Qa,[h[4]||(h[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+w(a.value)+" lines written)",1)])]))])):A("",!0)]))}},el=te(Za,[["__scopeId","data-v-ddc24a0f"]]),tl={class:"bash-tool-handler"},sl={class:"tool-section"},nl={class:"bash-header"},ol={class:"bash-header-content"},il={key:0,class:"bash-description"},al={key:1,class:"bash-flags"},ll={class:"bash-command-section"},rl={class:"bash-command-content"},cl={key:0,class:"tool-section"},ul={key:0,class:"bash-output"},dl={key:1,class:"bash-output-empty"},ml={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.command||""),o=g(()=>e.toolCall.input?.description||""),i=g(()=>e.toolCall.input?.timeout),a=g(()=>e.toolCall.input?.run_in_background||!1),l=g(()=>i.value||a.value),r=g(()=>{const h=[];return i.value&&h.push(`timeout: ${i.value}ms`),a.value&&h.push("background"),h.join(", ")}),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>v.value?"tool-result-error":"tool-result-success"),$=g(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,f)=>(u(),m("div",tl,[t("div",sl,[t("div",nl,[f[1]||(f[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",ol,[o.value?(u(),m("div",il,[f[0]||(f[0]=t("strong",null,"Description:",-1)),se(" "+w(o.value),1)])):A("",!0),l.value?(u(),m("div",al,w(r.value),1)):A("",!0)])]),t("div",ll,[f[2]||(f[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",rl,w(s.value),1)])]),p.value?(u(),m("div",cl,[t("div",{class:Z(["tool-result",c.value])},[f[3]||(f[3]=t("strong",null,"Output:",-1)),$.value?(u(),m("pre",ul,w($.value),1)):(u(),m("div",dl,"No output"))],2)])):A("",!0)]))}},pl=te(ml,[["__scopeId","data-v-ab50fe73"]]),fl={class:"todo-tool-handler"},vl={class:"tool-section"},_l={class:"todo-header"},hl={class:"todo-summary"},gl={key:0,class:"todo-count todo-count-completed"},bl={key:1,class:"todo-count todo-count-in-progress"},yl={key:2,class:"todo-count todo-count-pending"},$l={class:"todo-checklist"},wl={class:"todo-checkbox"},El={class:"todo-content"},Cl={key:0,class:"tool-section"},Sl={key:0,class:"tool-result tool-result-error"},kl={class:"tool-code"},Tl={key:1,class:"tool-result tool-result-success"},xl={class:"success-message"},Al={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.todos||[]),o=g(()=>s.value.filter(c=>c.status==="completed").length),i=g(()=>s.value.filter(c=>c.status==="in_progress").length),a=g(()=>s.value.filter(c=>c.status==="pending").length);function l(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const r=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=g(()=>{if(!r.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,$)=>(u(),m("div",fl,[t("div",vl,[t("div",_l,[$[0]||($[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=t("strong",null,"Task List:",-1)),t("div",hl,[o.value>0?(u(),m("span",gl,w(o.value)+" completed ",1)):A("",!0),i.value>0?(u(),m("span",bl,w(i.value)+" in progress ",1)):A("",!0),a.value>0?(u(),m("span",yl,w(a.value)+" pending ",1)):A("",!0)])]),t("div",$l,[(u(!0),m(re,null,ue(s.value,(h,f)=>(u(),m("div",{key:f,class:Z(["todo-item",`todo-${h.status}`])},[t("span",wl,w(l(h.status)),1),t("span",El,w(h.content),1)],2))),128))])]),r.value?(u(),m("div",Cl,[p.value?(u(),m("div",Sl,[$[2]||($[2]=t("strong",null,"Error:",-1)),t("pre",kl,w(v.value),1)])):(u(),m("div",Tl,[t("div",xl,[$[3]||($[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+w(s.value.length)+" tasks)",1)])]))])):A("",!0)]))}},Ml=te(Al,[["__scopeId","data-v-bbe55ee7"]]),Ol={class:"edit-tool-handler"},Nl={class:"tool-section"},Dl={class:"edit-file-info"},Ll={class:"file-path"},Il={key:0,class:"replace-all-badge"},Pl={class:"edit-diff-container"},jl={class:"diff-header"},Rl={class:"diff-stats"},Hl={class:"stat-removed"},Vl={class:"stat-added"},Wl={class:"unified-diff"},Fl={class:"diff-scroll-container"},Ul={class:"diff-marker"},Bl={class:"diff-content"},ql={key:0,class:"tool-section"},zl={key:0,class:"tool-result tool-result-error"},Kl={class:"tool-code"},Gl={key:1,class:"tool-result tool-result-success"},Yl={class:"success-message"},Jl={key:0,class:"success-detail"},Xl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.old_string||""),i=g(()=>e.toolCall.input?.new_string||""),a=g(()=>e.toolCall.input?.replace_all||!1),l=g(()=>{const f=hi(s.value,o.value,i.value,"","",{context:3}).split(`
`),b=[];for(let E=4;E<f.length;E++){const _=f[E];_&&(_.startsWith("-")?b.push({type:"removed",content:_.substring(1)}):_.startsWith("+")?b.push({type:"added",content:_.substring(1)}):_.startsWith(" ")?b.push({type:"context",content:_.substring(1)}):_.startsWith("@@")&&b.push({type:"hunk",content:_}))}return b}),r=g(()=>l.value.filter(h=>h.type==="removed").length),p=g(()=>l.value.filter(h=>h.type==="added").length),v=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=g(()=>{if(!v.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,f)=>(u(),m("div",Ol,[t("div",Nl,[t("div",Dl,[f[0]||(f[0]=t("span",{class:"file-icon"},"âœï¸",-1)),f[1]||(f[1]=t("strong",null,"Editing:",-1)),t("code",Ll,w(s.value),1),a.value?(u(),m("span",Il,"Replace All")):A("",!0)]),t("div",Pl,[t("div",jl,[f[2]||(f[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Rl,[t("span",Hl,"-"+w(r.value),1),t("span",Vl,"+"+w(p.value),1)])]),t("div",Wl,[t("div",Fl,[(u(!0),m(re,null,ue(l.value,(b,E)=>(u(),m("div",{key:E,class:Z(["diff-line",{"diff-line-removed":b.type==="removed","diff-line-added":b.type==="added","diff-line-context":b.type==="context","diff-line-hunk":b.type==="hunk"}])},[t("span",Ul,w(b.type==="removed"?"-":b.type==="added"?"+":b.type==="hunk"?"@":" "),1),t("span",Bl,w(b.content),1)],2))),128))])])])]),v.value?(u(),m("div",ql,[c.value?(u(),m("div",zl,[f[3]||(f[3]=t("strong",null,"Error:",-1)),t("pre",Kl,w($.value),1)])):(u(),m("div",Gl,[t("div",Yl,[f[4]||(f[4]=t("span",{class:"success-icon"},"âœ…",-1)),f[5]||(f[5]=t("strong",null,"File edited successfully",-1)),a.value?(u(),m("span",Jl,"(all occurrences replaced)")):A("",!0)])]))])):A("",!0)]))}},Ql=te(Xl,[["__scopeId","data-v-dd74055e"]]),Zl={class:"search-tool-handler"},er={class:"tool-section"},tr={class:"search-info"},sr={class:"search-icon"},nr={class:"search-pattern"},or={key:0,class:"search-path"},ir={key:1,class:"search-filters"},ar={key:0,class:"filter-badge"},lr={key:1,class:"filter-badge"},rr={key:2,class:"filter-badge"},cr={key:0,class:"tool-section"},ur={key:0,class:"tool-result tool-result-error"},dr={class:"tool-code"},mr={key:1,class:"search-results"},pr={class:"results-header"},fr={class:"results-label"},vr={class:"results-count-badge"},_r={class:"results-content"},hr={class:"tool-code"},gr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="Grep"),o=g(()=>e.toolCall.input?.pattern||"Unknown"),i=g(()=>e.toolCall.input?.path||null),a=g(()=>e.toolCall.input?.type||null),l=g(()=>e.toolCall.input?.glob||null),r=g(()=>e.toolCall.input?.["-i"]||!1),p=g(()=>a.value||l.value||r.value),v=g(()=>s.value?"ðŸ”":"ðŸ“"),c=g(()=>s.value?"Searching content":"Finding files"),$=g(()=>s.value?"Matches":"Files found"),h=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=g(()=>{if(!h.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),E=g(()=>!h.value||f.value||!b.value?0:b.value.split(`
`).filter(d=>d.trim()).length);return(_,d)=>(u(),m("div",Zl,[t("div",er,[t("div",tr,[t("span",sr,w(v.value),1),t("strong",null,w(c.value)+":",1),t("code",nr,w(o.value),1),i.value?(u(),m("span",or,"in "+w(i.value),1)):A("",!0),p.value?(u(),m("span",ir,[a.value?(u(),m("span",ar,"type: "+w(a.value),1)):A("",!0),l.value?(u(),m("span",lr,"glob: "+w(l.value),1)):A("",!0),r.value?(u(),m("span",rr,"case-insensitive")):A("",!0)])):A("",!0)])]),h.value?(u(),m("div",cr,[f.value?(u(),m("div",ur,[d[0]||(d[0]=t("strong",null,"Error:",-1)),t("pre",dr,w(b.value),1)])):(u(),m("div",mr,[t("div",pr,[t("span",fr,w($.value)+":",1),t("span",vr,w(E.value)+" "+w(E.value===1?"match":"matches"),1)]),t("div",_r,[t("pre",hr,w(b.value),1)])]))])):A("",!0)]))}},fn=te(gr,[["__scopeId","data-v-0d272c39"]]),br={class:"web-tool-handler"},yr={class:"tool-section"},$r={class:"web-info"},wr={class:"web-icon"},Er=["href"],Cr={key:1,class:"web-query"},Sr={key:0,class:"web-prompt-container"},kr={class:"prompt-content"},Tr={key:1,class:"web-domains"},xr={class:"domains-label"},Ar={key:0,class:"tool-section"},Mr={key:0,class:"tool-result tool-result-error"},Or={class:"tool-code"},Nr={key:1,class:"web-results"},Dr={class:"results-header"},Lr={class:"results-label"},Ir={class:"results-content"},Pr={class:"tool-code"},jr={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="WebFetch"),o=g(()=>e.toolCall.input?.url||null),i=g(()=>e.toolCall.input?.query||null),a=g(()=>e.toolCall.input?.prompt||null),l=g(()=>e.toolCall.input?.allowed_domains||[]),r=g(()=>e.toolCall.input?.blocked_domains||[]),p=g(()=>l.value.length>0?l.value:r.value.length>0?r.value:[]),v=g(()=>l.value.length>0?"Allowed domains":r.value.length>0?"Blocked domains":"Domains"),c=g(()=>s.value?"ðŸŒ":"ðŸ”Ž"),$=g(()=>s.value?"Fetching URL":"Searching web"),h=g(()=>s.value?"Fetched content":"Search results"),f=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),b=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),E=g(()=>{if(!f.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,d)=>(u(),m("div",br,[t("div",yr,[t("div",$r,[t("span",wr,w(c.value),1),t("strong",null,w($.value)+":",1),o.value?(u(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},w(o.value),9,Er)):i.value?(u(),m("code",Cr,w(i.value),1)):A("",!0)]),a.value?(u(),m("div",Sr,[d[0]||(d[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",kr,w(a.value),1)])):A("",!0),p.value.length>0?(u(),m("div",Tr,[t("span",xr,w(v.value)+":",1),(u(!0),m(re,null,ue(p.value,y=>(u(),m("span",{key:y,class:"domain-badge"},w(y),1))),128))])):A("",!0)]),f.value?(u(),m("div",Ar,[b.value?(u(),m("div",Mr,[d[1]||(d[1]=t("strong",null,"Error:",-1)),t("pre",Or,w(E.value),1)])):(u(),m("div",Nr,[t("div",Dr,[t("span",Lr,w(h.value)+":",1)]),t("div",Ir,[t("pre",Pr,w(E.value),1)])]))])):A("",!0)]))}},vn=te(jr,[["__scopeId","data-v-62b55b55"]]),Rr={class:"task-tool-handler"},Hr={class:"tool-section"},Vr={class:"task-header"},Wr={key:0,class:"agent-type-badge"},Fr={key:0,class:"task-description"},Ur={class:"description-content"},Br={key:1,class:"task-prompt-container"},qr={class:"prompt-header"},zr={class:"prompt-length"},Kr={class:"prompt-code"},Gr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Xr={key:1,class:"agent-output"},Qr={class:"output-header"},Zr={key:0,class:"output-count-badge"},ec={class:"output-content"},tc={class:"tool-code"},sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.description||null),o=g(()=>e.toolCall.input?.prompt||null),i=g(()=>e.toolCall.input?.subagent_type||null),a=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=g(()=>{if(!a.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),p=g(()=>r.value?r.value.split(`
`).length:0);return(v,c)=>(u(),m("div",Rr,[t("div",Hr,[t("div",Vr,[c[0]||(c[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=t("strong",null,"Agent Task:",-1)),i.value?(u(),m("span",Wr,w(i.value),1)):A("",!0)]),s.value?(u(),m("div",Fr,[c[2]||(c[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Ur,w(s.value),1)])):A("",!0),o.value?(u(),m("div",Br,[t("div",qr,[c[3]||(c[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",zr,w(o.value.length)+" characters",1)]),t("pre",Kr,w(o.value),1)])):A("",!0)]),a.value?(u(),m("div",Gr,[l.value?(u(),m("div",Yr,[c[4]||(c[4]=t("strong",null,"Error:",-1)),t("pre",Jr,w(r.value),1)])):(u(),m("div",Xr,[t("div",Qr,[c[5]||(c[5]=t("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(u(),m("span",Zr,w(p.value)+" lines",1)):A("",!0)]),t("div",ec,[t("pre",tc,w(r.value),1)])]))])):A("",!0)]))}},nc=te(sc,[["__scopeId","data-v-c520c244"]]),oc={class:"notebook-edit-tool-handler"},ic={class:"tool-section"},ac={class:"notebook-info"},lc={class:"file-path"},rc={class:"cell-info mt-2"},cc={class:"info-row"},uc={class:"info-row"},dc={key:0,class:"info-row"},mc={class:"badge bg-info"},pc={key:0,class:"source-preview mt-3"},fc={class:"preview-header"},vc={class:"preview-stats"},_c={class:"source-code"},hc={key:0,class:"tool-section"},gc={key:0},bc={key:1,class:"text-danger"},yc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.notebook_path||"Unknown"),o=g(()=>e.toolCall.input?.cell_id),i=g(()=>e.toolCall.input?.cell_type||"code"),a=g(()=>e.toolCall.input?.edit_mode||"replace"),l=g(()=>e.toolCall.input?.new_source||""),r=g(()=>l.value.split(`
`).length),p=g(()=>i.value==="code"?"bg-primary":"bg-secondary"),v=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=a.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,h)=>(u(),m("div",oc,[t("div",ic,[t("div",ac,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",lc,w(s.value),1)]),t("div",rc,[t("div",cc,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,w(o.value||"N/A"),1)]),t("div",uc,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:Z(["badge",p.value])},w(i.value),3)]),a.value?(u(),m("div",dc,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",mc,w(a.value),1)])):A("",!0)]),l.value?(u(),m("div",pc,[t("div",fc,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",vc,w(r.value)+" lines",1)]),t("pre",_c,[t("code",null,w(l.value),1)])])):A("",!0)]),n.toolCall.result?(u(),m("div",hc,[h[6]||(h[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Z(["tool-result",v.value])},[n.toolCall.result.success!==!1?(u(),m("div",gc," âœ… "+w(c.value),1)):(u(),m("div",bc," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)])):A("",!0)]))}},$c=te(yc,[["__scopeId","data-v-c81a9bcf"]]),wc={class:"shell-tool-handler"},Ec={class:"tool-section"},Cc={class:"shell-info"},Sc={class:"shell-icon"},kc={key:0,class:"shell-id"},Tc={key:0,class:"filter-info mt-2"},xc={class:"filter-pattern"},Ac={key:0,class:"tool-section"},Mc={class:"result-header mb-2"},Oc={key:0,class:"mb-2"},Nc={class:"shell-output"},Dc={key:1,class:"mb-2"},Lc={class:"shell-output shell-output-error"},Ic={key:0},Pc={key:1,class:"text-danger"},jc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=g(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=g(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=g(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=g(()=>e.toolCall.input?.filter);function r(f,b){if(!f)return null;const E=new RegExp(`<${b}>([\\s\\S]*?)<\\/${b}>`,"i"),_=f.match(E);return _?_[1].trim():null}const p=g(()=>{const f=e.toolCall.result;if(!f)return null;let b=f;if(f.content&&(b=f.content),typeof b=="string")return{status:r(b,"status"),stdout:r(b,"stdout"),stderr:r(b,"stderr"),exit_code:r(b,"exit_code")};if(Array.isArray(b)){const E=b.find(_=>_.type==="text")?.text||"";return{status:r(E,"status"),stdout:r(E,"stdout"),stderr:r(E,"stderr"),exit_code:r(E,"exit_code")}}return{status:f.status||b.status,stdout:f.stdout||f.output||b.stdout||b.output,stderr:f.stderr||b.stderr,exit_code:f.exit_code||b.exit_code}}),v=g(()=>p.value?.status),c=g(()=>{const f=v.value;return f==="running"?"bg-success":f==="completed"?"bg-secondary":f==="killed"||f==="terminated"?"bg-danger":"bg-info"}),$=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const f=p.value;if(f?.status==="running"&&!f.stdout&&!f.stderr)return"No new output since last check";if(f?.status==="failed")return`Shell failed (exit code ${f.exit_code||"unknown"})`}return"Operation completed"});return(f,b)=>(u(),m("div",wc,[t("div",Ec,[t("div",Cc,[t("span",Sc,w(s.value),1),t("strong",null,w(o.value)+":",1),a.value?(u(),m("code",kc,"Shell "+w(a.value),1)):A("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(u(),m("div",Tc,[b[0]||(b[0]=t("strong",null,"Filter:",-1)),t("code",xc,w(l.value),1)])):A("",!0)]),n.toolCall.result?(u(),m("div",Ac,[t("div",Mc,[t("strong",null,w(i.value)+":",1),v.value?(u(),m("span",{key:0,class:Z(["badge",c.value])},w(v.value),3)):A("",!0)]),p.value?.stdout?(u(),m("div",Oc,[b[1]||(b[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Nc,[t("pre",null,[t("code",null,w(p.value.stdout),1)])])])):A("",!0),p.value?.stderr?(u(),m("div",Dc,[b[2]||(b[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Lc,[t("pre",null,[t("code",null,w(p.value.stderr),1)])])])):A("",!0),!p.value?.stdout&&!p.value?.stderr?(u(),m("div",{key:2,class:Z(["tool-result",$.value])},[n.toolCall.result.success!==!1?(u(),m("div",Ic," âœ… "+w(h.value),1)):(u(),m("div",Pc," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)):A("",!0)])):A("",!0)]))}},_n=te(jc,[["__scopeId","data-v-86def281"]]),Rc={class:"skill-tool-handler"},Hc={key:0,class:"tool-section"},Vc={class:"d-flex align-items-center gap-2"},Wc={class:"text-muted small"},Fc={key:0,class:"skill-content-body"},Uc={class:"skill-content-text"},Bc={key:1,class:"tool-section mt-3"},qc={class:"tool-result tool-result-error"},zc={class:"tool-code"},Kc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=xe(),o=ae(),i=O(!1);function a(){i.value=!i.value}const l=g(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const f=s.messagesBySession.get(h)||[],b=f.findIndex(d=>d.type==="user"&&d.metadata?.has_tool_results&&d.metadata?.tool_results?.some(y=>y.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let E=null,_=null;for(let d=b+1;d<Math.min(b+3,f.length);d++){const y=f[d];if(y.type!=="user")continue;const C=y.content||"";C.includes("<command-message>")&&C.includes("skill is running")?E=y:C.startsWith("Base directory for this skill:")&&(_=y)}return{running:E,content:_}}),r=g(()=>{const h=l.value.content;if(!h)return"";const f=h.content||"",b=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return f.replace(b,"").trim()}),p=g(()=>r.value.length>0),v=g(()=>r.value?r.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=g(()=>{if(!c.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,f)=>(u(),m("div",Rc,[p.value?(u(),m("div",Hc,[t("div",{class:"skill-content-header",onClick:a},[t("div",Vc,[t("i",{class:Z(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),f[0]||(f[0]=t("strong",null,"Skill Content",-1)),t("span",Wc,"("+w(v.value)+" lines)",1)])]),i.value?(u(),m("div",Fc,[t("pre",Uc,w(r.value),1)])):A("",!0)])):A("",!0),c.value?(u(),m("div",Bc,[f[1]||(f[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",qc,[t("pre",zc,w($.value),1)])])):A("",!0)]))}},Gc=te(Kc,[["__scopeId","data-v-0a48ca0f"]]),Yc={class:"slashcommand-tool-handler"},Jc={key:0,class:"tool-section"},Xc={class:"d-flex align-items-center gap-2"},Qc=["aria-label"],Zc={class:"text-muted small"},eu={key:0,class:"command-content-body"},tu={class:"command-content-text"},su={key:1,class:"tool-section mt-3"},nu={class:"tool-result tool-result-error"},ou={class:"tool-code"},iu={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=xe(),o=ae(),i=O(!1);function a(){i.value=!i.value}const l=g(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const f=s.messagesBySession.get(h)||[],b=f.findIndex(d=>d.type==="user"&&d.metadata?.has_tool_results&&d.metadata?.tool_results?.some(y=>y.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let E=null,_=null;for(let d=b+1;d<Math.min(b+3,f.length);d++){const y=f[d];if(y.type!=="user")continue;const C=y.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?E=y:C.includes("ARGUMENTS:")&&(_=y)}return{running:E,content:_}}),r=g(()=>{const h=l.value.content;if(!h)return"";const f=h.content||"",b=/\nARGUMENTS:.*$/s;return f.replace(b,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=g(()=>r.value.length>0),v=g(()=>r.value?r.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=g(()=>{if(!c.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,f)=>(u(),m("div",Yc,[p.value?(u(),m("div",Jc,[t("div",{class:"command-content-header",onClick:a},[t("div",Xc,[t("span",{"aria-label":i.value?"Collapse":"Expand"},w(i.value?"â–¾":"â–¸"),9,Qc),f[0]||(f[0]=t("strong",null,"Command Content",-1)),t("span",Zc,"("+w(v.value)+" lines)",1)])]),i.value?(u(),m("div",eu,[t("pre",tu,w(r.value),1)])):A("",!0)])):A("",!0),c.value?(u(),m("div",su,[f[1]||(f[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",nu,[t("pre",ou,w($.value),1)])])):A("",!0)]))}},au=te(iu,[["__scopeId","data-v-15991acf"]]),lu={class:"exit-plan-mode-tool-handler"},ru={class:"tool-section"},cu={key:0,class:"plan-content mt-2"},uu={class:"plan-text"},du={key:0,class:"tool-section"},mu={key:0},pu={key:1,class:"text-danger"},fu={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.plan),o=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),m("div",lu,[t("div",ru,[a[1]||(a[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(u(),m("div",cu,[a[0]||(a[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",uu,w(s.value),1)])):A("",!0)]),n.toolCall.result?(u(),m("div",du,[a[2]||(a[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Z(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),m("div",mu," âœ… Permission mode reverted to default ")):(u(),m("div",pu," â— "+w(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):A("",!0)]))}},vu=te(fu,[["__scopeId","data-v-e2e3c781"]]),_u={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},hu={class:"tool-status-icon"},gu=["title"],bu={class:"d-flex align-items-center gap-2"},yu={class:"text-muted"},$u=["aria-label"],wu={key:0,class:"card-body"},Eu={key:0,class:"alert alert-warning mb-3"},Cu={class:"d-flex align-items-center"},Su={class:"mb-0 small"},ku={key:1,class:"permission-prompt mt-3"},Tu={class:"alert alert-warning mb-3"},xu={class:"mb-0"},Au={class:"tool-name"},Mu={key:0,class:"suggestions-section mb-3"},Ou={class:"alert alert-info mb-0"},Nu={class:"suggestion-details p-2 bg-white rounded"},Du={class:"permission-buttons d-flex gap-2 mb-3"},Lu=["disabled"],Iu=["disabled"],Pu=["disabled"],ju={class:"guidance-section mt-3"},Ru=["disabled"],Hu=["disabled"],Vu={key:2,class:"mt-3"},Wu={class:"alert alert-warning mb-0"},Fu={class:"d-flex align-items-center"},Uu={class:"mb-0 small"},Bu={key:3,class:"tool-section"},qu={class:"alert alert-danger mb-0"},zu={key:0},Ku={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=xe(),o=ae(),i=ze(),a=O(!1),l=O(null),r=O(""),p=g(()=>s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),v=g(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c=g(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),$=g(()=>{if(c.value){const L=c.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[L]||L}return e.toolCall.status}),h={Read:ja,Write:el,Bash:pl,TodoWrite:Ml,Edit:Ql,Grep:fn,Glob:fn,WebFetch:vn,WebSearch:vn,Task:nc,NotebookEdit:$c,BashOutput:_n,KillShell:_n,SlashCommand:au,Skill:Gc,ExitPlanMode:vu},f=g(()=>{const L=e.toolCall.name;return h[L]?h[L]:$a}),b=g(()=>{const L=[];if(p.value)return L.push("border-warning"),L.join(" ");switch($.value){case"pending":L.push("border-secondary");break;case"permission_required":L.push("border-warning");break;case"executing":L.push("border-primary");break;case"completed":d.value||e.toolCall.permissionDecision==="deny"?L.push("border-danger"):L.push("border-success");break;case"error":L.push("border-danger");break}return L.join(" ")}),E=g(()=>{if(p.value)return"â¹ï¸";switch($.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":d.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),_=g(()=>Pt(e.toolCall.timestamp)),d=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function C(L){if(!L)return"";const M=L.replace(/\\/g,"/").split("/");return M[M.length-1]}function x(L){if(!L)return"";const M=L.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return M?M[1]:L}function F(L,M=200){return L?L.length<=M?L:L.substring(0,M)+"...":""}function R(L){if(!L)return null;if(L.content){const M=L.content.match(/exit code (\d+)/i);if(M)return parseInt(M[1])}return L.error?1:0}function N(L,M){const P=L?L.split(`
`).length:0;return{added:M?M.split(`
`).length:0,removed:P}}const j=g(()=>{const L=e.toolCall.name,M=e.toolCall.input||{},P=e.toolCall.result,T=$.value;switch(L){case"Bash":case"Shell":case"Command":{const S=x(M.command),I=F(S,200);if(T==="completed"&&P){const U=R(P);return`Bash: ${I} (exit ${U})`}return`Bash: ${I}`}case"SlashCommand":{const S=F(M.command,200);return T==="completed"&&P?`SlashCommand: ${S}`:`SlashCommand: ${S}`}case"Edit":{const S=C(M.file_path);if(T==="completed"&&P&&!P.error){const{added:I,removed:U}=N(M.old_string,M.new_string);return I===U?`Edit: ${S} (${I} lines changed)`:`Edit: ${S} (${I} lines added, ${U} removed)`}return`Edit: ${S}`}case"Read":{const S=C(M.file_path);if(M.offset!==void 0||M.limit!==void 0){const U=(M.offset||0)+1,Y=M.limit?(M.offset||0)+M.limit:"âˆž";return`Read: ${S} (lines ${U}-${Y})`}return`Read: ${S} (full file)`}case"Write":{const S=C(M.file_path);if(T==="completed"&&P&&!P.error&&M.content){const I=M.content.split(`
`).length;return`Write: ${S} (${I} lines written)`}return`Write: ${S}`}case"Skill":{const S=M.skill||"Unknown";return T==="completed"&&P?P.error?`Skill: ${S} (error)`:`Skill: ${S} (completed)`:`Skill: ${S}`}case"Task":{const S=M.subagent_type||"general",I=M.description||"Task";return T==="completed"&&P?P.error?`Task: (${S}) ${I} (error)`:`Task: (${S}) ${I} (completed)`:`Task: (${S}) ${I}`}case"TodoWrite":{if(M.todos&&Array.isArray(M.todos)){const S=M.todos.filter(Y=>Y.status==="completed").length,I=M.todos.length,U=M.todos.find(Y=>Y.status==="in_progress");return U?`Todo: Working on "${U.content}"`:`Todo: ${S}/${I} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const S=M.pattern||"",I=L==="Grep"?"Grep":"Glob";if(T==="completed"&&P&&!P.error){let U=0;return P.content&&(U=P.content.split(`
`).filter(X=>X.trim()).length),`${I}: "${S}" (${U} results)`}return`${I}: "${S}"`}case"WebFetch":case"WebSearch":{const S=M.url||M.query||"";if(L==="WebSearch"){const U=M.query||"",Y=U.length>50?U.substring(0,50)+"...":U;return T==="completed"&&P?P.error?`Web: ${Y} (error)`:`Web: ${Y} (success)`:`Web: ${Y}`}let I="";try{S&&(I=new URL(S.startsWith("http")?S:`https://${S}`).hostname)}catch{I=S.length>50?S.substring(0,50)+"...":S}return T==="completed"&&P?P.error?`Web: ${I} (error)`:`Web: ${I} (success)`:`Web: ${I||S}`}case"NotebookEdit":{const S=C(M.notebook_path),I=M.cell_number!==void 0?M.cell_number:"?",U=M.edit_mode||"replace";return`NotebookEdit: ${S} cell #${I} (${U})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${M.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${M.shell_id||"unknown"}`;default:return`${L}: executed`}}),k=g(()=>{const L=e.toolCall.name,M=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(L)?M.command||L:["Edit","Read","Write","NotebookEdit"].includes(L)&&(M.file_path||M.notebook_path)||L});function D(){const L=o.currentSessionId;L&&s.toggleToolExpansion(L,e.toolCall.id)}function K(L){return L.type==="setMode"?`Set permission mode to "${L.mode}"`:L.type==="allow"?`Allow tool: ${L.tool}`:JSON.stringify(L)}async function q(L,M,P=null){if(!a.value){a.value=!0,L==="allow"?l.value=M?"approve-apply":"approve":P?l.value="deny-guidance":l.value="deny";try{const T=o.currentSessionId;if(T){const S=M&&e.toolCall.suggestions?e.toolCall.suggestions:[];s.handlePermissionResponse(T,{request_id:e.toolCall.permissionRequestId,decision:L,reasoning:L==="allow"?"User allowed permission":"User denied permission",applied_updates:S})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,L,M,P)}catch(T){console.error("Failed to send permission response:",T)}finally{a.value=!1,l.value=null}}}return(L,M)=>(u(),m("div",{class:Z(["tool-call-card card",b.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:D},[t("div",_u,[t("span",hu,w(E.value),1),t("span",{class:"tool-name",title:k.value},w(j.value),9,gu)]),t("div",bu,[t("small",yu,w(_.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},w(n.toolCall.isExpanded?"â–¾":"â–¸"),9,$u)])]),n.toolCall.isExpanded?(u(),m("div",wu,[p.value?(u(),m("div",Eu,[t("div",Cu,[M[6]||(M[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[M[5]||(M[5]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",Su,w(v.value?.message||"Session was terminated"),1)])])])):A("",!0),(u(),ge(to(f.value),{toolCall:n.toolCall},null,8,["toolCall"])),$.value==="permission_required"&&!p.value?(u(),m("div",ku,[t("div",Tu,[M[9]||(M[9]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",xu,[M[7]||(M[7]=se("Claude wants to use the ",-1)),t("code",Au,w(n.toolCall.name),1),M[8]||(M[8]=se(" tool.",-1))])]),y.value?(u(),m("div",Mu,[t("div",Ou,[M[10]||(M[10]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),M[11]||(M[11]=t("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),t("div",Nu,[(u(!0),m(re,null,ue(n.toolCall.suggestions,(P,T)=>(u(),m("div",{key:T,class:"suggestion-item"},[t("code",null,w(K(P)),1)]))),128))]),M[12]||(M[12]=t("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):A("",!0),t("div",Du,[y.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:M[0]||(M[0]=P=>q("allow",!0)),disabled:a.value},w(a.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Lu)):A("",!0),t("button",{class:Z(["btn",y.value?"btn-outline-success":"btn-success"]),onClick:M[1]||(M[1]=P=>q("allow",!1)),disabled:a.value},w(a.value&&l.value==="approve"?"â³ Submitting...":y.value?"âœ… Approve Only":"âœ… Approve"),11,Iu),t("button",{class:"btn btn-danger",onClick:M[2]||(M[2]=P=>q("deny",!1)),disabled:a.value}," ðŸš« "+w(a.value&&l.value==="deny"?"Submitting...":"Deny"),9,Pu)]),t("div",ju,[M[13]||(M[13]=t("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),M[14]||(M[14]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),oe(t("textarea",{"onUpdate:modelValue":M[3]||(M[3]=P=>r.value=P),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Ru),[[de,r.value]]),r.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:M[4]||(M[4]=P=>q("deny",!1,r.value)),disabled:a.value},w(a.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Hu)):A("",!0)])])):A("",!0),$.value==="permission_required"&&p.value?(u(),m("div",Vu,[t("div",Wu,[t("div",Fu,[M[16]||(M[16]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[M[15]||(M[15]=t("strong",null,"Permission Request Cancelled",-1)),t("p",Uu,w(v.value?.message||"Session was terminated before permission could be granted"),1)])])])])):A("",!0),n.toolCall.permissionDecision==="deny"?(u(),m("div",Bu,[t("div",qu,[M[17]||(M[17]=se(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(u(),m("span",zu," - "+w(n.toolCall.result.message),1)):A("",!0)])])):A("",!0)])):A("",!0)],2))}},hn=te(Ku,[["__scopeId","data-v-e339198b"]]),Gu={class:"tool-footer-container"},Yu=["aria-label","onKeydown"],Ju={class:"footer-left"},Xu={class:"footer-text"},Qu={class:"footer-middle"},Zu={class:"footer-text"},ed={class:"footer-right"},td={class:"expand-icon"},sd={key:0,class:"tool-footer-expanded"},nd={key:1,class:"active-tools-area"},od={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=xe(),o=ae(),i=O(!1);function a(f){return f.map((b,E)=>({tool:b,originalIndex:E})).sort((b,E)=>{if(b.tool.timestamp&&E.tool.timestamp){const _=new Date(b.tool.timestamp).getTime(),d=new Date(E.tool.timestamp).getTime();if(_!==d)return _-d}return b.originalIndex-E.originalIndex}).map(({tool:b})=>b)}const l=g(()=>{const f=e.tools.filter(b=>b.status==="executing"||b.status==="permission_required");return a(f)}),r=g(()=>{const f=e.tools.filter(b=>b.status!=="executing"&&b.status!=="permission_required");return a(f)}),p=g(()=>{const f=new Map;e.tools.forEach(y=>{const C=f.get(y.name)||0;f.set(y.name,C+1)});const b=Array.from(f.entries()).sort((y,C)=>C[1]-y[1]),E=b.slice(0,5),_=b.length-E.length,d=E.map(([y,C])=>`${y} (${C})`).join(", ");return _>0?`${d}, +${_} more`:d}),v=g(()=>{const f=e.tools.length;let b=0,E=0,_=0;e.tools.forEach(x=>{const F=o.currentSessionId;(F?s.isToolUseOrphaned(F,x.id):!1)?_++:x.status==="completed"&&!x.result?.error&&x.permissionDecision!=="deny"?b++:(x.status==="error"||x.result?.error||x.permissionDecision==="deny")&&E++});let d=[];b>0&&d.push(`${b} âœ…`),E>0&&d.push(`${E} âŒ`),_>0&&d.push(`${_} â¹ï¸`);const y=f===1?"tool":"tools",C=d.length>0?": "+d.join(" "):"";return`${f} ${y}${C}`}),c=g(()=>i.value?"â–²":"â–¼"),$=g(()=>{const f=o.currentSessionId,b=e.tools.some(y=>y.status==="error"||y.result?.error||y.permissionDecision==="deny"),E=e.tools.some(y=>f?s.isToolUseOrphaned(f,y.id):!1),_=l.value.length>0,d=e.tools.every(y=>!(f?s.isToolUseOrphaned(f,y.id):!1)&&y.status==="completed"&&!y.result?.error&&y.permissionDecision!=="deny");return b?"footer-status-error":E?"footer-status-orphaned":_?"footer-status-in-progress":d?"footer-status-success":""});function h(){i.value=!i.value}return(f,b)=>(u(),m("div",Gu,[t("div",{class:Z(["tool-footer-summary",$.value]),onClick:h,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Xe(h,["enter"]),Xe(ve(h,["prevent"]),["space"])]},[t("div",Ju,[t("span",Xu,"Used: "+w(p.value),1)]),t("div",Qu,[b[0]||(b[0]=t("span",{class:"footer-separator"},"|",-1)),t("span",Zu,w(v.value),1)]),t("div",ed,[t("span",td,w(c.value),1)])],42,Yu),i.value?(u(),m("div",sd,[(u(!0),m(re,null,ue(r.value,E=>(u(),ge(hn,{key:E.id,toolCall:E},null,8,["toolCall"]))),128))])):A("",!0),l.value.length>0?(u(),m("div",nd,[(u(!0),m(re,null,ue(l.value,E=>(u(),ge(hn,{key:E.id,toolCall:E},null,8,["toolCall"]))),128))])):A("",!0)]))}},id=te(od,[["__scopeId","data-v-7bae7ae1"]]),ad={class:"message-row message-row-assistant"},ld=["title"],rd={class:"message-content-column"},cd={key:0,class:"thinking-block mb-2"},ud=["innerHTML"],dd={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=xe(),o=ae();tt.setOptions({breaks:!0,gfm:!0});const i=g(()=>Pt(e.message.timestamp)),a=g(()=>e.message.metadata?.model||null),l=g(()=>{const b=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${b}`}),r=g(()=>{const b=e.message.content||"";return b.trim().length>0&&b!=="Assistant response"}),p=g(()=>{const b=e.message.content||"";let E=tt.parse(b);return E=E.replace(/\n</g,"<"),E=E.replace(/\n+$/,""),as.sanitize(E)}),v=g(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=g(()=>e.message.metadata?.thinking_content||""),$=g(()=>{const b=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,E=e.attachedTools&&e.attachedTools.length>0;return b||E}),h=g(()=>{const b=e.message.metadata?.tool_uses||[],E=e.attachedTools||[],_=[...b],d=new Set(b.map(y=>y.id));for(const y of E)d.has(y.id)||_.push(y);return _}),f=g(()=>{const b=o.currentSessionId;if(!b)return[];const E=s.toolCallsBySession.get(b)||[];return h.value.map(_=>{const d=E.find(y=>y.id===_.id);return d||{id:_.id,name:_.name,input:_.input,status:"pending",result:null,timestamp:_.timestamp||e.message.timestamp,isExpanded:!0}})});return(b,E)=>(u(),m("div",ad,[t("div",{class:"message-speaker",title:l.value},[...E[0]||(E[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,ld),t("div",rd,[v.value?(u(),m("div",cd,[ce(da,{thinking:c.value},null,8,["thinking"])])):A("",!0),r.value?(u(),m("div",{key:1,class:"message-text",innerHTML:p.value},null,8,ud)):A("",!0),$.value?(u(),ge(id,{key:2,tools:f.value},null,8,["tools"])):A("",!0)])]))}},md=te(dd,[["__scopeId","data-v-2e32f6ef"]]),pd={key:0,class:"message-row message-row-compaction"},fd=["title"],vd={class:"message-content-column"},_d={class:"compaction-status-content"},hd={class:"text-muted ms-auto"},gd={key:1,class:"message-row message-row-system"},bd=["title"],yd={class:"message-content-column"},$d={class:"system-text"},wd={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>Pt(e.message.timestamp)),o=g(()=>`system
${s.value}`),i=g(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,l)=>i.value?(u(),m("div",pd,[t("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,fd),t("div",vd,[t("div",_d,[l[1]||(l[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",hd,w(s.value),1)])])])):(u(),m("div",gd,[t("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,bd),t("div",yd,[t("span",$d,w(n.message.content),1)])]))}},gn=te(wd,[["__scopeId","data-v-a078178f"]]),Ed={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>{switch(e.message.type){case"user":return oa;case"assistant":return md;case"system":return gn;default:return gn}});return(o,i)=>(u(),ge(to(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Cd=te(Ed,[["__scopeId","data-v-11dff525"]]);var ye="top",Ce="bottom",Se="right",$e="left",ls="auto",St=[ye,Ce,Se,$e],st="start",ht="end",no="clippingParents",Bs="viewport",dt="popper",oo="reference",js=St.reduce(function(n,e){return n.concat([e+"-"+st,e+"-"+ht])},[]),qs=[].concat(St,[ls]).reduce(function(n,e){return n.concat([e,e+"-"+st,e+"-"+ht])},[]),io="beforeRead",ao="read",lo="afterRead",ro="beforeMain",co="main",uo="afterMain",mo="beforeWrite",po="write",fo="afterWrite",vo=[io,ao,lo,ro,co,uo,mo,po,fo];function Ie(n){return n?(n.nodeName||"").toLowerCase():null}function ke(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nt(n){var e=ke(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=ke(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function zs(n){if(typeof ShadowRoot>"u")return!1;var e=ke(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Sd(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},a=e.elements[s];!Te(a)||!Ie(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(l){var r=i[l];r===!1?a.removeAttribute(l):a.setAttribute(l,r===!0?"":r)}))})}function kd(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),r=l.reduce(function(p,v){return p[v]="",p},{});!Te(i)||!Ie(i)||(Object.assign(i.style,r),Object.keys(a).forEach(function(p){i.removeAttribute(p)}))})}}const _o={name:"applyStyles",enabled:!0,phase:"write",fn:Sd,effect:kd,requires:["computeStyles"]};function De(n){return n.split("-")[0]}var et=Math.max,ss=Math.min,gt=Math.round;function Rs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ho(){return!/^((?!chrome|android).)*safari/i.test(Rs())}function bt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&gt(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&gt(o.height)/n.offsetHeight||1);var l=nt(n)?ke(n):window,r=l.visualViewport,p=!ho()&&s,v=(o.left+(p&&r?r.offsetLeft:0))/i,c=(o.top+(p&&r?r.offsetTop:0))/a,$=o.width/i,h=o.height/a;return{width:$,height:h,top:c,right:v+$,bottom:c+h,left:v,x:v,y:c}}function Ks(n){var e=bt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function go(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&zs(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function He(n){return ke(n).getComputedStyle(n)}function Td(n){return["table","td","th"].indexOf(Ie(n))>=0}function Ke(n){return((nt(n)?n.ownerDocument:n.document)||window.document).documentElement}function rs(n){return Ie(n)==="html"?n:n.assignedSlot||n.parentNode||(zs(n)?n.host:null)||Ke(n)}function bn(n){return!Te(n)||He(n).position==="fixed"?null:n.offsetParent}function xd(n){var e=/firefox/i.test(Rs()),s=/Trident/i.test(Rs());if(s&&Te(n)){var o=He(n);if(o.position==="fixed")return null}var i=rs(n);for(zs(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Ie(i))<0;){var a=He(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function jt(n){for(var e=ke(n),s=bn(n);s&&Td(s)&&He(s).position==="static";)s=bn(s);return s&&(Ie(s)==="html"||Ie(s)==="body"&&He(s).position==="static")?e:s||xd(n)||e}function Gs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Dt(n,e,s){return et(n,ss(e,s))}function Ad(n,e,s){var o=Dt(n,e,s);return o>s?s:o}function bo(){return{top:0,right:0,bottom:0,left:0}}function yo(n){return Object.assign({},bo(),n)}function $o(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var Md=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,yo(typeof e!="number"?e:$o(e,St))};function Od(n){var e,s=n.state,o=n.name,i=n.options,a=s.elements.arrow,l=s.modifiersData.popperOffsets,r=De(s.placement),p=Gs(r),v=[$e,Se].indexOf(r)>=0,c=v?"height":"width";if(!(!a||!l)){var $=Md(i.padding,s),h=Ks(a),f=p==="y"?ye:$e,b=p==="y"?Ce:Se,E=s.rects.reference[c]+s.rects.reference[p]-l[p]-s.rects.popper[c],_=l[p]-s.rects.reference[p],d=jt(a),y=d?p==="y"?d.clientHeight||0:d.clientWidth||0:0,C=E/2-_/2,x=$[f],F=y-h[c]-$[b],R=y/2-h[c]/2+C,N=Dt(x,R,F),j=p;s.modifiersData[o]=(e={},e[j]=N,e.centerOffset=N-R,e)}}function Nd(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||go(e.elements.popper,i)&&(e.elements.arrow=i))}const wo={name:"arrow",enabled:!0,phase:"main",fn:Od,effect:Nd,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function yt(n){return n.split("-")[1]}var Dd={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ld(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:gt(s*i)/i||0,y:gt(o*i)/i||0}}function yn(n){var e,s=n.popper,o=n.popperRect,i=n.placement,a=n.variation,l=n.offsets,r=n.position,p=n.gpuAcceleration,v=n.adaptive,c=n.roundOffsets,$=n.isFixed,h=l.x,f=h===void 0?0:h,b=l.y,E=b===void 0?0:b,_=typeof c=="function"?c({x:f,y:E}):{x:f,y:E};f=_.x,E=_.y;var d=l.hasOwnProperty("x"),y=l.hasOwnProperty("y"),C=$e,x=ye,F=window;if(v){var R=jt(s),N="clientHeight",j="clientWidth";if(R===ke(s)&&(R=Ke(s),He(R).position!=="static"&&r==="absolute"&&(N="scrollHeight",j="scrollWidth")),R=R,i===ye||(i===$e||i===Se)&&a===ht){x=Ce;var k=$&&R===F&&F.visualViewport?F.visualViewport.height:R[N];E-=k-o.height,E*=p?1:-1}if(i===$e||(i===ye||i===Ce)&&a===ht){C=Se;var D=$&&R===F&&F.visualViewport?F.visualViewport.width:R[j];f-=D-o.width,f*=p?1:-1}}var K=Object.assign({position:r},v&&Dd),q=c===!0?Ld({x:f,y:E},ke(s)):{x:f,y:E};if(f=q.x,E=q.y,p){var L;return Object.assign({},K,(L={},L[x]=y?"0":"",L[C]=d?"0":"",L.transform=(F.devicePixelRatio||1)<=1?"translate("+f+"px, "+E+"px)":"translate3d("+f+"px, "+E+"px, 0)",L))}return Object.assign({},K,(e={},e[x]=y?E+"px":"",e[C]=d?f+"px":"",e.transform="",e))}function Id(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,a=s.adaptive,l=a===void 0?!0:a,r=s.roundOffsets,p=r===void 0?!0:r,v={placement:De(e.placement),variation:yt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,yn(Object.assign({},v,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,yn(Object.assign({},v,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Eo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Id,data:{}};var qt={passive:!0};function Pd(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,l=o.resize,r=l===void 0?!0:l,p=ke(e.elements.popper),v=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&v.forEach(function(c){c.addEventListener("scroll",s.update,qt)}),r&&p.addEventListener("resize",s.update,qt),function(){a&&v.forEach(function(c){c.removeEventListener("scroll",s.update,qt)}),r&&p.removeEventListener("resize",s.update,qt)}}const Co={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Pd,data:{}};var jd={left:"right",right:"left",bottom:"top",top:"bottom"};function Qt(n){return n.replace(/left|right|bottom|top/g,function(e){return jd[e]})}var Rd={start:"end",end:"start"};function $n(n){return n.replace(/start|end/g,function(e){return Rd[e]})}function Ys(n){var e=ke(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function Js(n){return bt(Ke(n)).left+Ys(n).scrollLeft}function Hd(n,e){var s=ke(n),o=Ke(n),i=s.visualViewport,a=o.clientWidth,l=o.clientHeight,r=0,p=0;if(i){a=i.width,l=i.height;var v=ho();(v||!v&&e==="fixed")&&(r=i.offsetLeft,p=i.offsetTop)}return{width:a,height:l,x:r+Js(n),y:p}}function Vd(n){var e,s=Ke(n),o=Ys(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=et(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=et(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),r=-o.scrollLeft+Js(n),p=-o.scrollTop;return He(i||s).direction==="rtl"&&(r+=et(s.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:r,y:p}}function Xs(n){var e=He(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function So(n){return["html","body","#document"].indexOf(Ie(n))>=0?n.ownerDocument.body:Te(n)&&Xs(n)?n:So(rs(n))}function Lt(n,e){var s;e===void 0&&(e=[]);var o=So(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),a=ke(o),l=i?[a].concat(a.visualViewport||[],Xs(o)?o:[]):o,r=e.concat(l);return i?r:r.concat(Lt(rs(l)))}function Hs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Wd(n,e){var s=bt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function wn(n,e,s){return e===Bs?Hs(Hd(n,s)):nt(e)?Wd(e,s):Hs(Vd(Ke(n)))}function Fd(n){var e=Lt(rs(n)),s=["absolute","fixed"].indexOf(He(n).position)>=0,o=s&&Te(n)?jt(n):n;return nt(o)?e.filter(function(i){return nt(i)&&go(i,o)&&Ie(i)!=="body"}):[]}function Ud(n,e,s,o){var i=e==="clippingParents"?Fd(n):[].concat(e),a=[].concat(i,[s]),l=a[0],r=a.reduce(function(p,v){var c=wn(n,v,o);return p.top=et(c.top,p.top),p.right=ss(c.right,p.right),p.bottom=ss(c.bottom,p.bottom),p.left=et(c.left,p.left),p},wn(n,l,o));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function ko(n){var e=n.reference,s=n.element,o=n.placement,i=o?De(o):null,a=o?yt(o):null,l=e.x+e.width/2-s.width/2,r=e.y+e.height/2-s.height/2,p;switch(i){case ye:p={x:l,y:e.y-s.height};break;case Ce:p={x:l,y:e.y+e.height};break;case Se:p={x:e.x+e.width,y:r};break;case $e:p={x:e.x-s.width,y:r};break;default:p={x:e.x,y:e.y}}var v=i?Gs(i):null;if(v!=null){var c=v==="y"?"height":"width";switch(a){case st:p[v]=p[v]-(e[c]/2-s[c]/2);break;case ht:p[v]=p[v]+(e[c]/2-s[c]/2);break}}return p}function $t(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,a=s.strategy,l=a===void 0?n.strategy:a,r=s.boundary,p=r===void 0?no:r,v=s.rootBoundary,c=v===void 0?Bs:v,$=s.elementContext,h=$===void 0?dt:$,f=s.altBoundary,b=f===void 0?!1:f,E=s.padding,_=E===void 0?0:E,d=yo(typeof _!="number"?_:$o(_,St)),y=h===dt?oo:dt,C=n.rects.popper,x=n.elements[b?y:h],F=Ud(nt(x)?x:x.contextElement||Ke(n.elements.popper),p,c,l),R=bt(n.elements.reference),N=ko({reference:R,element:C,placement:i}),j=Hs(Object.assign({},C,N)),k=h===dt?j:R,D={top:F.top-k.top+d.top,bottom:k.bottom-F.bottom+d.bottom,left:F.left-k.left+d.left,right:k.right-F.right+d.right},K=n.modifiersData.offset;if(h===dt&&K){var q=K[i];Object.keys(D).forEach(function(L){var M=[Se,Ce].indexOf(L)>=0?1:-1,P=[ye,Ce].indexOf(L)>=0?"y":"x";D[L]+=q[P]*M})}return D}function Bd(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,a=s.rootBoundary,l=s.padding,r=s.flipVariations,p=s.allowedAutoPlacements,v=p===void 0?qs:p,c=yt(o),$=c?r?js:js.filter(function(b){return yt(b)===c}):St,h=$.filter(function(b){return v.indexOf(b)>=0});h.length===0&&(h=$);var f=h.reduce(function(b,E){return b[E]=$t(n,{placement:E,boundary:i,rootBoundary:a,padding:l})[De(E)],b},{});return Object.keys(f).sort(function(b,E){return f[b]-f[E]})}function qd(n){if(De(n)===ls)return[];var e=Qt(n);return[$n(n),e,$n(e)]}function zd(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!0:l,p=s.fallbackPlacements,v=s.padding,c=s.boundary,$=s.rootBoundary,h=s.altBoundary,f=s.flipVariations,b=f===void 0?!0:f,E=s.allowedAutoPlacements,_=e.options.placement,d=De(_),y=d===_,C=p||(y||!b?[Qt(_)]:qd(_)),x=[_].concat(C).reduce(function(J,he){return J.concat(De(he)===ls?Bd(e,{placement:he,boundary:c,rootBoundary:$,padding:v,flipVariations:b,allowedAutoPlacements:E}):he)},[]),F=e.rects.reference,R=e.rects.popper,N=new Map,j=!0,k=x[0],D=0;D<x.length;D++){var K=x[D],q=De(K),L=yt(K)===st,M=[ye,Ce].indexOf(q)>=0,P=M?"width":"height",T=$t(e,{placement:K,boundary:c,rootBoundary:$,altBoundary:h,padding:v}),S=M?L?Se:$e:L?Ce:ye;F[P]>R[P]&&(S=Qt(S));var I=Qt(S),U=[];if(a&&U.push(T[q]<=0),r&&U.push(T[S]<=0,T[I]<=0),U.every(function(J){return J})){k=K,j=!1;break}N.set(K,U)}if(j)for(var Y=b?3:1,X=function(he){var z=x.find(function(V){var W=N.get(V);if(W)return W.slice(0,he).every(function(Q){return Q})});if(z)return k=z,"break"},G=Y;G>0;G--){var H=X(G);if(H==="break")break}e.placement!==k&&(e.modifiersData[o]._skip=!0,e.placement=k,e.reset=!0)}}const To={name:"flip",enabled:!0,phase:"main",fn:zd,requiresIfExists:["offset"],data:{_skip:!1}};function En(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Cn(n){return[ye,Se,Ce,$e].some(function(e){return n[e]>=0})}function Kd(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=$t(e,{elementContext:"reference"}),r=$t(e,{altBoundary:!0}),p=En(l,o),v=En(r,i,a),c=Cn(p),$=Cn(v);e.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:v,isReferenceHidden:c,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":$})}const xo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Kd};function Gd(n,e,s){var o=De(n),i=[$e,ye].indexOf(o)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,l=a[0],r=a[1];return l=l||0,r=(r||0)*i,[$e,Se].indexOf(o)>=0?{x:r,y:l}:{x:l,y:r}}function Yd(n){var e=n.state,s=n.options,o=n.name,i=s.offset,a=i===void 0?[0,0]:i,l=qs.reduce(function(c,$){return c[$]=Gd($,e.rects,a),c},{}),r=l[e.placement],p=r.x,v=r.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=v),e.modifiersData[o]=l}const Ao={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Yd};function Jd(n){var e=n.state,s=n.name;e.modifiersData[s]=ko({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Mo={name:"popperOffsets",enabled:!0,phase:"read",fn:Jd,data:{}};function Xd(n){return n==="x"?"y":"x"}function Qd(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!1:l,p=s.boundary,v=s.rootBoundary,c=s.altBoundary,$=s.padding,h=s.tether,f=h===void 0?!0:h,b=s.tetherOffset,E=b===void 0?0:b,_=$t(e,{boundary:p,rootBoundary:v,padding:$,altBoundary:c}),d=De(e.placement),y=yt(e.placement),C=!y,x=Gs(d),F=Xd(x),R=e.modifiersData.popperOffsets,N=e.rects.reference,j=e.rects.popper,k=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,D=typeof k=="number"?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),K=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,q={x:0,y:0};if(R){if(a){var L,M=x==="y"?ye:$e,P=x==="y"?Ce:Se,T=x==="y"?"height":"width",S=R[x],I=S+_[M],U=S-_[P],Y=f?-j[T]/2:0,X=y===st?N[T]:j[T],G=y===st?-j[T]:-N[T],H=e.elements.arrow,J=f&&H?Ks(H):{width:0,height:0},he=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:bo(),z=he[M],V=he[P],W=Dt(0,N[T],J[T]),Q=C?N[T]/2-Y-W-z-D.mainAxis:X-W-z-D.mainAxis,ne=C?-N[T]/2+Y+W+V+D.mainAxis:G+W+V+D.mainAxis,fe=e.elements.arrow&&jt(e.elements.arrow),fs=fe?x==="y"?fe.clientTop||0:fe.clientLeft||0:0,We=(L=K?.[x])!=null?L:0,At=S+Q-We-fs,Mt=S+ne-We,rt=Dt(f?ss(I,At):I,S,f?et(U,Mt):U);R[x]=rt,q[x]=rt-S}if(r){var Ut,ui=x==="x"?ye:$e,di=x==="x"?Ce:Se,Je=R[F],Bt=F==="y"?"height":"width",an=Je+_[ui],ln=Je-_[di],vs=[ye,$e].indexOf(d)!==-1,rn=(Ut=K?.[F])!=null?Ut:0,cn=vs?an:Je-N[Bt]-j[Bt]-rn+D.altAxis,un=vs?Je+N[Bt]+j[Bt]-rn-D.altAxis:ln,dn=f&&vs?Ad(cn,Je,un):Dt(f?cn:an,Je,f?un:ln);R[F]=dn,q[F]=dn-Je}e.modifiersData[o]=q}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:Qd,requiresIfExists:["offset"]};function Zd(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function em(n){return n===ke(n)||!Te(n)?Ys(n):Zd(n)}function tm(n){var e=n.getBoundingClientRect(),s=gt(e.width)/n.offsetWidth||1,o=gt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function sm(n,e,s){s===void 0&&(s=!1);var o=Te(e),i=Te(e)&&tm(e),a=Ke(e),l=bt(n,i,s),r={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!s)&&((Ie(e)!=="body"||Xs(a))&&(r=em(e)),Te(e)?(p=bt(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):a&&(p.x=Js(a))),{x:l.left+r.scrollLeft-p.x,y:l.top+r.scrollTop-p.y,width:l.width,height:l.height}}function nm(n){var e=new Map,s=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){s.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(r){if(!s.has(r)){var p=e.get(r);p&&i(p)}}),o.push(a)}return n.forEach(function(a){s.has(a.name)||i(a)}),o}function om(n){var e=nm(n);return vo.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function im(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function am(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Sn={placement:"bottom",modifiers:[],strategy:"absolute"};function kn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function No(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,a=i===void 0?Sn:i;return function(r,p,v){v===void 0&&(v=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Sn,a),modifiersData:{},elements:{reference:r,popper:p},attributes:{},styles:{}},$=[],h=!1,f={state:c,setOptions:function(d){var y=typeof d=="function"?d(c.options):d;E(),c.options=Object.assign({},a,c.options,y),c.scrollParents={reference:nt(r)?Lt(r):r.contextElement?Lt(r.contextElement):[],popper:Lt(p)};var C=om(am([].concat(o,c.options.modifiers)));return c.orderedModifiers=C.filter(function(x){return x.enabled}),b(),f.update()},forceUpdate:function(){if(!h){var d=c.elements,y=d.reference,C=d.popper;if(kn(y,C)){c.rects={reference:sm(y,jt(C),c.options.strategy==="fixed"),popper:Ks(C)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(D){return c.modifiersData[D.name]=Object.assign({},D.data)});for(var x=0;x<c.orderedModifiers.length;x++){if(c.reset===!0){c.reset=!1,x=-1;continue}var F=c.orderedModifiers[x],R=F.fn,N=F.options,j=N===void 0?{}:N,k=F.name;typeof R=="function"&&(c=R({state:c,options:j,name:k,instance:f})||c)}}}},update:im(function(){return new Promise(function(_){f.forceUpdate(),_(c)})}),destroy:function(){E(),h=!0}};if(!kn(r,p))return f;f.setOptions(v).then(function(_){!h&&v.onFirstUpdate&&v.onFirstUpdate(_)});function b(){c.orderedModifiers.forEach(function(_){var d=_.name,y=_.options,C=y===void 0?{}:y,x=_.effect;if(typeof x=="function"){var F=x({state:c,name:d,instance:f,options:C}),R=function(){};$.push(F||R)}})}function E(){$.forEach(function(_){return _()}),$=[]}return f}}var lm=[Co,Mo,Eo,_o,Ao,To,Oo,wo,xo],Qs=No({defaultModifiers:lm});const Do=Object.freeze(Object.defineProperty({__proto__:null,afterMain:uo,afterRead:lo,afterWrite:fo,applyStyles:_o,arrow:wo,auto:ls,basePlacements:St,beforeMain:ro,beforeRead:io,beforeWrite:mo,bottom:Ce,clippingParents:no,computeStyles:Eo,createPopper:Qs,detectOverflow:$t,end:ht,eventListeners:Co,flip:To,hide:xo,left:$e,main:co,modifierPhases:vo,offset:Ao,placements:qs,popper:dt,popperGenerator:No,popperOffsets:Mo,preventOverflow:Oo,read:ao,reference:oo,right:Se,start:st,top:ye,variationPlacements:js,viewport:Bs,write:po},Symbol.toStringTag,{value:"Module"}));const Fe=new Map,ys={set(n,e,s){Fe.has(n)||Fe.set(n,new Map);const o=Fe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return Fe.has(n)&&Fe.get(n).get(e)||null},remove(n,e){if(!Fe.has(n))return;const s=Fe.get(n);s.delete(e),s.size===0&&Fe.delete(n)}},rm=1e6,cm=1e3,Vs="transitionend",Lo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),um=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),dm=n=>{do n+=Math.floor(Math.random()*rm);while(document.getElementById(n));return n},mm=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*cm)},Io=n=>{n.dispatchEvent(new Event(Vs))},je=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Ue=n=>je(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Lo(n)):null,kt=n=>{if(!je(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},Be=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Po=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Po(n.parentNode):null},ns=()=>{},Rt=n=>{n.offsetHeight},jo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,$s=[],pm=n=>{document.readyState==="loading"?($s.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of $s)e()}),$s.push(n)):n()},Ae=()=>document.documentElement.dir==="rtl",Oe=n=>{pm(()=>{const e=jo();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ee=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,Ro=(n,e,s=!0)=>{if(!s){Ee(n);return}const i=mm(e)+5;let a=!1;const l=({target:r})=>{r===e&&(a=!0,e.removeEventListener(Vs,l),Ee(n))};e.addEventListener(Vs,l),setTimeout(()=>{a||Io(e)},i)},Zs=(n,e,s,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!s&&o?n[i-1]:n[0]:(a+=s?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},fm=/[^.]*(?=\..*)\.|.*/,vm=/\..*/,_m=/::\d+$/,ws={};let Tn=1;const Ho={mouseenter:"mouseover",mouseleave:"mouseout"},hm=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vo(n,e){return e&&`${e}::${Tn++}`||n.uidEvent||Tn++}function Wo(n){const e=Vo(n);return n.uidEvent=e,ws[e]=ws[e]||{},ws[e]}function gm(n,e){return function s(o){return en(o,{delegateTarget:n}),s.oneOff&&B.off(n,o.type,e),e.apply(n,[o])}}function bm(n,e,s){return function o(i){const a=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const r of a)if(r===l)return en(i,{delegateTarget:l}),o.oneOff&&B.off(n,i.type,e,s),s.apply(l,[i])}}function Fo(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Uo(n,e,s){const o=typeof e=="string",i=o?s:e||s;let a=Bo(n);return hm.has(a)||(a=n),[o,i,a]}function xn(n,e,s,o,i){if(typeof e!="string"||!n)return;let[a,l,r]=Uo(e,s,o);e in Ho&&(l=(b=>function(E){if(!E.relatedTarget||E.relatedTarget!==E.delegateTarget&&!E.delegateTarget.contains(E.relatedTarget))return b.call(this,E)})(l));const p=Wo(n),v=p[r]||(p[r]={}),c=Fo(v,l,a?s:null);if(c){c.oneOff=c.oneOff&&i;return}const $=Vo(l,e.replace(fm,"")),h=a?bm(n,s,l):gm(n,l);h.delegationSelector=a?s:null,h.callable=l,h.oneOff=i,h.uidEvent=$,v[$]=h,n.addEventListener(r,h,a)}function Ws(n,e,s,o,i){const a=Fo(e[s],o,i);a&&(n.removeEventListener(s,a,!!i),delete e[s][a.uidEvent])}function ym(n,e,s,o){const i=e[s]||{};for(const[a,l]of Object.entries(i))a.includes(o)&&Ws(n,e,s,l.callable,l.delegationSelector)}function Bo(n){return n=n.replace(vm,""),Ho[n]||n}const B={on(n,e,s,o){xn(n,e,s,o,!1)},one(n,e,s,o){xn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,a,l]=Uo(e,s,o),r=l!==e,p=Wo(n),v=p[l]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(v).length)return;Ws(n,p,l,a,i?s:null);return}if(c)for(const $ of Object.keys(p))ym(n,p,$,e.slice(1));for(const[$,h]of Object.entries(v)){const f=$.replace(_m,"");(!r||e.includes(f))&&Ws(n,p,l,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=jo(),i=Bo(e),a=e!==i;let l=null,r=!0,p=!0,v=!1;a&&o&&(l=o.Event(e,s),o(n).trigger(l),r=!l.isPropagationStopped(),p=!l.isImmediatePropagationStopped(),v=l.isDefaultPrevented());const c=en(new Event(e,{bubbles:r,cancelable:!0}),s);return v&&c.preventDefault(),p&&n.dispatchEvent(c),c.defaultPrevented&&l&&l.preventDefault(),c}};function en(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function An(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Es(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Re={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Es(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Es(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=An(n.dataset[o])}return e},getDataAttribute(n,e){return An(n.getAttribute(`data-bs-${Es(e)}`))}};class Ht{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=je(s)?Re.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...je(s)?Re.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const a=e[o],l=je(a)?"element":um(a);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const $m="5.3.8";class Ne extends Ht{constructor(e,s){super(),e=Ue(e),e&&(this._element=e,this._config=this._getConfig(s),ys.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ys.remove(this._element,this.constructor.DATA_KEY),B.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){Ro(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ys.get(Ue(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return $m}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Cs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>Lo(s)).join(","):null},ee={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!Be(s)&&kt(s))},getSelectorFromElement(n){const e=Cs(n);return e&&ee.findOne(e)?e:null},getElementFromSelector(n){const e=Cs(n);return e?ee.findOne(e):null},getMultipleElementsFromSelector(n){const e=Cs(n);return e?ee.find(e):[]}},cs=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;B.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Be(this))return;const a=ee.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},wm="alert",Em="bs.alert",qo=`.${Em}`,Cm=`close${qo}`,Sm=`closed${qo}`,km="fade",Tm="show";class us extends Ne{static get NAME(){return wm}close(){if(B.trigger(this._element,Cm).defaultPrevented)return;this._element.classList.remove(Tm);const s=this._element.classList.contains(km);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),B.trigger(this._element,Sm),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=us.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}cs(us,"close");Oe(us);const xm="button",Am="bs.button",Mm=`.${Am}`,Om=".data-api",Nm="active",Mn='[data-bs-toggle="button"]',Dm=`click${Mm}${Om}`;class ds extends Ne{static get NAME(){return xm}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Nm))}static jQueryInterface(e){return this.each(function(){const s=ds.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}B.on(document,Dm,Mn,n=>{n.preventDefault();const e=n.target.closest(Mn);ds.getOrCreateInstance(e).toggle()});Oe(ds);const Lm="swipe",Tt=".bs.swipe",Im=`touchstart${Tt}`,Pm=`touchmove${Tt}`,jm=`touchend${Tt}`,Rm=`pointerdown${Tt}`,Hm=`pointerup${Tt}`,Vm="touch",Wm="pen",Fm="pointer-event",Um=40,Bm={endCallback:null,leftCallback:null,rightCallback:null},qm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class os extends Ht{constructor(e,s){super(),this._element=e,!(!e||!os.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Bm}static get DefaultType(){return qm}static get NAME(){return Lm}dispose(){B.off(this._element,Tt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ee(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Um)return;const s=e/this._deltaX;this._deltaX=0,s&&Ee(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(B.on(this._element,Rm,e=>this._start(e)),B.on(this._element,Hm,e=>this._end(e)),this._element.classList.add(Fm)):(B.on(this._element,Im,e=>this._start(e)),B.on(this._element,Pm,e=>this._move(e)),B.on(this._element,jm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Wm||e.pointerType===Vm)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const zm="carousel",Km="bs.carousel",Ge=`.${Km}`,zo=".data-api",Gm="ArrowLeft",Ym="ArrowRight",Jm=500,Ot="next",ct="prev",mt="left",Zt="right",Xm=`slide${Ge}`,Ss=`slid${Ge}`,Qm=`keydown${Ge}`,Zm=`mouseenter${Ge}`,ep=`mouseleave${Ge}`,tp=`dragstart${Ge}`,sp=`load${Ge}${zo}`,np=`click${Ge}${zo}`,Ko="carousel",zt="active",op="slide",ip="carousel-item-end",ap="carousel-item-start",lp="carousel-item-next",rp="carousel-item-prev",Go=".active",Yo=".carousel-item",cp=Go+Yo,up=".carousel-item img",dp=".carousel-indicators",mp="[data-bs-slide], [data-bs-slide-to]",pp='[data-bs-ride="carousel"]',fp={[Gm]:Zt,[Ym]:mt},vp={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},_p={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Vt extends Ne{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ee.findOne(dp,this._element),this._addEventListeners(),this._config.ride===Ko&&this.cycle()}static get Default(){return vp}static get DefaultType(){return _p}static get NAME(){return zm}next(){this._slide(Ot)}nextWhenVisible(){!document.hidden&&kt(this._element)&&this.next()}prev(){this._slide(ct)}pause(){this._isSliding&&Io(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){B.one(this._element,Ss,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){B.one(this._element,Ss,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Ot:ct;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&B.on(this._element,Qm,e=>this._keydown(e)),this._config.pause==="hover"&&(B.on(this._element,Zm,()=>this.pause()),B.on(this._element,ep,()=>this._maybeEnableCycle())),this._config.touch&&os.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ee.find(up,this._element))B.on(o,tp,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(mt)),rightCallback:()=>this._slide(this._directionToOrder(Zt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Jm+this._config.interval))}};this._swipeHelper=new os(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=fp[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=ee.findOne(Go,this._indicatorsElement);s.classList.remove(zt),s.removeAttribute("aria-current");const o=ee.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(zt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===Ot,a=s||Zs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const l=this._getItemIndex(a),r=f=>B.trigger(this._element,f,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(r(Xm).defaultPrevented||!o||!a)return;const v=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=a;const c=i?ap:ip,$=i?lp:rp;a.classList.add($),Rt(a),o.classList.add(c),a.classList.add(c);const h=()=>{a.classList.remove(c,$),a.classList.add(zt),o.classList.remove(zt,$,c),this._isSliding=!1,r(Ss)};this._queueCallback(h,o,this._isAnimated()),v&&this.cycle()}_isAnimated(){return this._element.classList.contains(op)}_getActive(){return ee.findOne(cp,this._element)}_getItems(){return ee.find(Yo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ae()?e===mt?ct:Ot:e===mt?Ot:ct}_orderToDirection(e){return Ae()?e===ct?mt:Zt:e===ct?Zt:mt}static jQueryInterface(e){return this.each(function(){const s=Vt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}B.on(document,np,mp,function(n){const e=ee.getElementFromSelector(this);if(!e||!e.classList.contains(Ko))return;n.preventDefault();const s=Vt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Re.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});B.on(window,sp,()=>{const n=ee.find(pp);for(const e of n)Vt.getOrCreateInstance(e)});Oe(Vt);const hp="collapse",gp="bs.collapse",Wt=`.${gp}`,bp=".data-api",yp=`show${Wt}`,$p=`shown${Wt}`,wp=`hide${Wt}`,Ep=`hidden${Wt}`,Cp=`click${Wt}${bp}`,ks="show",ft="collapse",Kt="collapsing",Sp="collapsed",kp=`:scope .${ft} .${ft}`,Tp="collapse-horizontal",xp="width",Ap="height",Mp=".collapse.show, .collapse.collapsing",Fs='[data-bs-toggle="collapse"]',Op={parent:null,toggle:!0},Np={parent:"(null|element)",toggle:"boolean"};class wt extends Ne{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=ee.find(Fs);for(const i of o){const a=ee.getSelectorFromElement(i),l=ee.find(a).filter(r=>r===this._element);a!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Op}static get DefaultType(){return Np}static get NAME(){return hp}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Mp).filter(r=>r!==this._element).map(r=>wt.getOrCreateInstance(r,{toggle:!1}))),e.length&&e[0]._isTransitioning||B.trigger(this._element,yp).defaultPrevented)return;for(const r of e)r.hide();const o=this._getDimension();this._element.classList.remove(ft),this._element.classList.add(Kt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(ft,ks),this._element.style[o]="",B.trigger(this._element,$p)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||B.trigger(this._element,wp).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Rt(this._element),this._element.classList.add(Kt),this._element.classList.remove(ft,ks);for(const i of this._triggerArray){const a=ee.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(ft),B.trigger(this._element,Ep)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ks)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ue(e.parent),e}_getDimension(){return this._element.classList.contains(Tp)?xp:Ap}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Fs);for(const s of e){const o=ee.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=ee.find(kp,this._config.parent);return ee.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Sp,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=wt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}B.on(document,Cp,Fs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ee.getMultipleElementsFromSelector(this))wt.getOrCreateInstance(e,{toggle:!1}).toggle()});Oe(wt);const On="dropdown",Dp="bs.dropdown",at=`.${Dp}`,tn=".data-api",Lp="Escape",Nn="Tab",Ip="ArrowUp",Dn="ArrowDown",Pp=2,jp=`hide${at}`,Rp=`hidden${at}`,Hp=`show${at}`,Vp=`shown${at}`,Jo=`click${at}${tn}`,Xo=`keydown${at}${tn}`,Wp=`keyup${at}${tn}`,pt="show",Fp="dropup",Up="dropend",Bp="dropstart",qp="dropup-center",zp="dropdown-center",Qe='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Kp=`${Qe}.${pt}`,es=".dropdown-menu",Gp=".navbar",Yp=".navbar-nav",Jp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Xp=Ae()?"top-end":"top-start",Qp=Ae()?"top-start":"top-end",Zp=Ae()?"bottom-end":"bottom-start",ef=Ae()?"bottom-start":"bottom-end",tf=Ae()?"left-start":"right-start",sf=Ae()?"right-start":"left-start",nf="top",of="bottom",af={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},lf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Le extends Ne{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=ee.next(this._element,es)[0]||ee.prev(this._element,es)[0]||ee.findOne(es,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return af}static get DefaultType(){return lf}static get NAME(){return On}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Be(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!B.trigger(this._element,Hp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Yp))for(const o of[].concat(...document.body.children))B.on(o,"mouseover",ns);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(pt),this._element.classList.add(pt),B.trigger(this._element,Vp,e)}}hide(){if(Be(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!B.trigger(this._element,jp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))B.off(o,"mouseover",ns);this._popper&&this._popper.destroy(),this._menu.classList.remove(pt),this._element.classList.remove(pt),this._element.setAttribute("aria-expanded","false"),Re.removeDataAttribute(this._menu,"popper"),B.trigger(this._element,Rp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!je(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${On.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Do>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:je(this._config.reference)?e=Ue(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Qs(e,this._menu,s)}_isShown(){return this._menu.classList.contains(pt)}_getPlacement(){const e=this._parent;if(e.classList.contains(Up))return tf;if(e.classList.contains(Bp))return sf;if(e.classList.contains(qp))return nf;if(e.classList.contains(zp))return of;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Fp)?s?Qp:Xp:s?ef:Zp}_detectNavbar(){return this._element.closest(Gp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Re.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ee(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=ee.find(Jp,this._menu).filter(i=>kt(i));o.length&&Zs(o,s,e===Dn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Le.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===Pp||e.type==="keyup"&&e.key!==Nn)return;const s=ee.find(Kp);for(const o of s){const i=Le.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),l=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Nn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const r={relatedTarget:i._element};e.type==="click"&&(r.clickEvent=e),i._completeHide(r)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Lp,i=[Ip,Dn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const a=this.matches(Qe)?this:ee.prev(this,Qe)[0]||ee.next(this,Qe)[0]||ee.findOne(Qe,e.delegateTarget.parentNode),l=Le.getOrCreateInstance(a);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),a.focus())}}B.on(document,Xo,Qe,Le.dataApiKeydownHandler);B.on(document,Xo,es,Le.dataApiKeydownHandler);B.on(document,Jo,Le.clearMenus);B.on(document,Wp,Le.clearMenus);B.on(document,Jo,Qe,function(n){n.preventDefault(),Le.getOrCreateInstance(this).toggle()});Oe(Le);const Qo="backdrop",rf="fade",Ln="show",In=`mousedown.bs.${Qo}`,cf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},uf={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Zo extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return cf}static get DefaultType(){return uf}static get NAME(){return Qo}show(e){if(!this._config.isVisible){Ee(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Rt(s),s.classList.add(Ln),this._emulateAnimation(()=>{Ee(e)})}hide(e){if(!this._config.isVisible){Ee(e);return}this._getElement().classList.remove(Ln),this._emulateAnimation(()=>{this.dispose(),Ee(e)})}dispose(){this._isAppended&&(B.off(this._element,In),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(rf),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ue(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),B.on(e,In,()=>{Ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Ro(e,this._getElement(),this._config.isAnimated)}}const df="focustrap",mf="bs.focustrap",is=`.${mf}`,pf=`focusin${is}`,ff=`keydown.tab${is}`,vf="Tab",_f="forward",Pn="backward",hf={autofocus:!0,trapElement:null},gf={autofocus:"boolean",trapElement:"element"};class ei extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return hf}static get DefaultType(){return gf}static get NAME(){return df}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),B.off(document,is),B.on(document,pf,e=>this._handleFocusin(e)),B.on(document,ff,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,B.off(document,is))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=ee.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Pn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===vf&&(this._lastTabNavDirection=e.shiftKey?Pn:_f)}}const jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Rn=".sticky-top",Gt="padding-right",Hn="margin-right";class Us{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Gt,s=>s+e),this._setElementAttributes(jn,Gt,s=>s+e),this._setElementAttributes(Rn,Hn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Gt),this._resetElementAttributes(jn,Gt),this._resetElementAttributes(Rn,Hn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),a=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,s);const r=window.getComputedStyle(l).getPropertyValue(s);l.style.setProperty(s,`${o(Number.parseFloat(r))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Re.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const a=Re.getDataAttribute(i,s);if(a===null){i.style.removeProperty(s);return}Re.removeDataAttribute(i,s),i.style.setProperty(s,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(je(e)){s(e);return}for(const o of ee.find(e,this._element))s(o)}}const bf="modal",yf="bs.modal",Me=`.${yf}`,$f=".data-api",wf="Escape",Ef=`hide${Me}`,Cf=`hidePrevented${Me}`,ti=`hidden${Me}`,si=`show${Me}`,Sf=`shown${Me}`,kf=`resize${Me}`,Tf=`click.dismiss${Me}`,xf=`mousedown.dismiss${Me}`,Af=`keydown.dismiss${Me}`,Mf=`click${Me}${$f}`,Vn="modal-open",Of="fade",Wn="show",Ts="modal-static",Nf=".modal.show",Df=".modal-dialog",Lf=".modal-body",If='[data-bs-toggle="modal"]',Pf={backdrop:!0,focus:!0,keyboard:!0},jf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ot extends Ne{constructor(e,s){super(e,s),this._dialog=ee.findOne(Df,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Us,this._addEventListeners()}static get Default(){return Pf}static get DefaultType(){return jf}static get NAME(){return bf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||B.trigger(this._element,si,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Vn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||B.trigger(this._element,Ef).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Wn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){B.off(window,Me),B.off(this._dialog,Me),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Zo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=ee.findOne(Lf,this._dialog);s&&(s.scrollTop=0),Rt(this._element),this._element.classList.add(Wn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,B.trigger(this._element,Sf,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){B.on(this._element,Af,e=>{if(e.key===wf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),B.on(window,kf,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),B.on(this._element,xf,e=>{B.one(this._element,Tf,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Vn),this._resetAdjustments(),this._scrollBar.reset(),B.trigger(this._element,ti)})}_isAnimated(){return this._element.classList.contains(Of)}_triggerBackdropTransition(){if(B.trigger(this._element,Cf).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ts)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Ts),this._queueCallback(()=>{this._element.classList.remove(Ts),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=Ae()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=Ae()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=ot.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}B.on(document,Mf,If,function(n){const e=ee.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),B.one(e,si,i=>{i.defaultPrevented||B.one(e,ti,()=>{kt(this)&&this.focus()})});const s=ee.findOne(Nf);s&&ot.getInstance(s).hide(),ot.getOrCreateInstance(e).toggle(this)});cs(ot);Oe(ot);const Rf="offcanvas",Hf="bs.offcanvas",Ve=`.${Hf}`,ni=".data-api",Vf=`load${Ve}${ni}`,Wf="Escape",Fn="show",Un="showing",Bn="hiding",Ff="offcanvas-backdrop",oi=".offcanvas.show",Uf=`show${Ve}`,Bf=`shown${Ve}`,qf=`hide${Ve}`,qn=`hidePrevented${Ve}`,ii=`hidden${Ve}`,zf=`resize${Ve}`,Kf=`click${Ve}${ni}`,Gf=`keydown.dismiss${Ve}`,Yf='[data-bs-toggle="offcanvas"]',Jf={backdrop:!0,keyboard:!0,scroll:!1},Xf={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class qe extends Ne{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Jf}static get DefaultType(){return Xf}static get NAME(){return Rf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||B.trigger(this._element,Uf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Us().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Un);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Fn),this._element.classList.remove(Un),B.trigger(this._element,Bf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||B.trigger(this._element,qf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Bn),this._backdrop.hide();const s=()=>{this._element.classList.remove(Fn,Bn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Us().reset(),B.trigger(this._element,ii)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){B.trigger(this._element,qn);return}this.hide()},s=!!this._config.backdrop;return new Zo({className:Ff,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_addEventListeners(){B.on(this._element,Gf,e=>{if(e.key===Wf){if(this._config.keyboard){this.hide();return}B.trigger(this._element,qn)}})}static jQueryInterface(e){return this.each(function(){const s=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}B.on(document,Kf,Yf,function(n){const e=ee.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Be(this))return;B.one(e,ii,()=>{kt(this)&&this.focus()});const s=ee.findOne(oi);s&&s!==e&&qe.getInstance(s).hide(),qe.getOrCreateInstance(e).toggle(this)});B.on(window,Vf,()=>{for(const n of ee.find(oi))qe.getOrCreateInstance(n).show()});B.on(window,zf,()=>{for(const n of ee.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&qe.getOrCreateInstance(n).hide()});cs(qe);Oe(qe);const Qf=/^aria-[\w-]*$/i,ai={"*":["class","dir","id","lang","role",Qf],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Zf=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),ev=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,tv=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Zf.has(s)?!!ev.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function sv(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const l of a){const r=l.nodeName.toLowerCase();if(!Object.keys(e).includes(r)){l.remove();continue}const p=[].concat(...l.attributes),v=[].concat(e["*"]||[],e[r]||[]);for(const c of p)tv(c,v)||l.removeAttribute(c.nodeName)}return i.body.innerHTML}const nv="TemplateFactory",ov={allowList:ai,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},iv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},av={entry:"(string|element|function|null)",selector:"(string|element)"};class lv extends Ht{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return ov}static get DefaultType(){return iv}static get NAME(){return nv}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},av)}_setContent(e,s,o){const i=ee.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(je(s)){this._putElementInTemplate(Ue(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?sv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ee(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const rv="tooltip",cv=new Set(["sanitize","allowList","sanitizeFn"]),xs="fade",uv="modal",Yt="show",dv=".tooltip-inner",zn=`.${uv}`,Kn="hide.bs.modal",Nt="hover",As="focus",Ms="click",mv="manual",pv="hide",fv="hidden",vv="show",_v="shown",hv="inserted",gv="click",bv="focusin",yv="focusout",$v="mouseenter",wv="mouseleave",Ev={AUTO:"auto",TOP:"top",RIGHT:Ae()?"left":"right",BOTTOM:"bottom",LEFT:Ae()?"right":"left"},Cv={allowList:ai,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Sv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class xt extends Ne{constructor(e,s){if(typeof Do>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Cv}static get DefaultType(){return Sv}static get NAME(){return rv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),B.off(this._element.closest(zn),Kn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=B.trigger(this._element,this.constructor.eventName(vv)),o=(Po(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),B.trigger(this._element,this.constructor.eventName(hv))),this._popper=this._createPopper(i),i.classList.add(Yt),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))B.on(r,"mouseover",ns);const l=()=>{B.trigger(this._element,this.constructor.eventName(_v)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||B.trigger(this._element,this.constructor.eventName(pv)).defaultPrevented)return;if(this._getTipElement().classList.remove(Yt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))B.off(i,"mouseover",ns);this._activeTrigger[Ms]=!1,this._activeTrigger[As]=!1,this._activeTrigger[Nt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),B.trigger(this._element,this.constructor.eventName(fv)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(xs,Yt),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=dm(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(xs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new lv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[dv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(xs)}_isShown(){return this.tip&&this.tip.classList.contains(Yt)}_createPopper(e){const s=Ee(this._config.placement,[this,e,this._element]),o=Ev[s.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ee(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ee(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")B.on(this._element,this.constructor.eventName(gv),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ms]=!(i._isShown()&&i._activeTrigger[Ms]),i.toggle()});else if(s!==mv){const o=s===Nt?this.constructor.eventName($v):this.constructor.eventName(bv),i=s===Nt?this.constructor.eventName(wv):this.constructor.eventName(yv);B.on(this._element,o,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusin"?As:Nt]=!0,l._enter()}),B.on(this._element,i,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusout"?As:Nt]=l._element.contains(a.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},B.on(this._element.closest(zn),Kn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Re.getDataAttributes(this._element);for(const o of Object.keys(s))cv.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ue(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=xt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Oe(xt);const kv="popover",Tv=".popover-header",xv=".popover-body",Av={...xt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Mv={...xt.DefaultType,content:"(null|string|element|function)"};class sn extends xt{static get Default(){return Av}static get DefaultType(){return Mv}static get NAME(){return kv}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Tv]:this._getTitle(),[xv]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Oe(sn);const Ov="scrollspy",Nv="bs.scrollspy",nn=`.${Nv}`,Dv=".data-api",Lv=`activate${nn}`,Gn=`click${nn}`,Iv=`load${nn}${Dv}`,Pv="dropdown-item",ut="active",jv='[data-bs-spy="scroll"]',Os="[href]",Rv=".nav, .list-group",Yn=".nav-link",Hv=".nav-item",Vv=".list-group-item",Wv=`${Yn}, ${Hv} > ${Yn}, ${Vv}`,Fv=".dropdown",Uv=".dropdown-toggle",Bv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},qv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ms extends Ne{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Bv}static get DefaultType(){return qv}static get NAME(){return Ov}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ue(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(B.off(this._config.target,Gn),B.on(this._config.target,Gn,Os,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(s(l))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(l));continue}const r=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&r){if(o(l),!i)return;continue}!a&&!r&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ee.find(Os,this._config.target);for(const s of e){if(!s.hash||Be(s))continue;const o=ee.findOne(decodeURI(s.hash),this._element);kt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ut),this._activateParents(e),B.trigger(this._element,Lv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Pv)){ee.findOne(Uv,e.closest(Fv)).classList.add(ut);return}for(const s of ee.parents(e,Rv))for(const o of ee.prev(s,Wv))o.classList.add(ut)}_clearActiveClass(e){e.classList.remove(ut);const s=ee.find(`${Os}.${ut}`,e);for(const o of s)o.classList.remove(ut)}static jQueryInterface(e){return this.each(function(){const s=ms.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}B.on(window,Iv,()=>{for(const n of ee.find(jv))ms.getOrCreateInstance(n)});Oe(ms);const zv="tab",Kv="bs.tab",lt=`.${Kv}`,Gv=`hide${lt}`,Yv=`hidden${lt}`,Jv=`show${lt}`,Xv=`shown${lt}`,Qv=`click${lt}`,Zv=`keydown${lt}`,e_=`load${lt}`,t_="ArrowLeft",Jn="ArrowRight",s_="ArrowUp",Xn="ArrowDown",Ns="Home",Qn="End",Ze="active",Zn="fade",Ds="show",n_="dropdown",li=".dropdown-toggle",o_=".dropdown-menu",Ls=`:not(${li})`,i_='.list-group, .nav, [role="tablist"]',a_=".nav-item, .list-group-item",l_=`.nav-link${Ls}, .list-group-item${Ls}, [role="tab"]${Ls}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Is=`${l_}, ${ri}`,r_=`.${Ze}[data-bs-toggle="tab"], .${Ze}[data-bs-toggle="pill"], .${Ze}[data-bs-toggle="list"]`;class Et extends Ne{constructor(e){super(e),this._parent=this._element.closest(i_),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),B.on(this._element,Zv,s=>this._keydown(s)))}static get NAME(){return zv}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?B.trigger(s,Gv,{relatedTarget:e}):null;B.trigger(e,Jv,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(Ze),this._activate(ee.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ds);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),B.trigger(e,Xv,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Zn))}_deactivate(e,s){if(!e)return;e.classList.remove(Ze),e.blur(),this._deactivate(ee.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ds);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),B.trigger(e,Yv,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Zn))}_keydown(e){if(![t_,Jn,s_,Xn,Ns,Qn].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!Be(i));let o;if([Ns,Qn].includes(e.key))o=s[e.key===Ns?0:s.length-1];else{const i=[Jn,Xn].includes(e.key);o=Zs(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Et.getOrCreateInstance(o).show())}_getChildren(){return ee.find(Is,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=ee.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(n_))return;const i=(a,l)=>{const r=ee.findOne(a,o);r&&r.classList.toggle(l,s)};i(li,Ze),i(o_,Ds),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(Ze)}_getInnerElement(e){return e.matches(Is)?e:ee.findOne(Is,e)}_getOuterElement(e){return e.closest(a_)||e}static jQueryInterface(e){return this.each(function(){const s=Et.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}B.on(document,Qv,ri,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Be(this)&&Et.getOrCreateInstance(this).show()});B.on(window,e_,()=>{for(const n of ee.find(r_))Et.getOrCreateInstance(n)});Oe(Et);const c_="toast",u_="bs.toast",Ye=`.${u_}`,d_=`mouseover${Ye}`,m_=`mouseout${Ye}`,p_=`focusin${Ye}`,f_=`focusout${Ye}`,v_=`hide${Ye}`,__=`hidden${Ye}`,h_=`show${Ye}`,g_=`shown${Ye}`,b_="fade",eo="hide",Jt="show",Xt="showing",y_={animation:"boolean",autohide:"boolean",delay:"number"},$_={animation:!0,autohide:!0,delay:5e3};class ps extends Ne{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return $_}static get DefaultType(){return y_}static get NAME(){return c_}show(){if(B.trigger(this._element,h_).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(b_);const s=()=>{this._element.classList.remove(Xt),B.trigger(this._element,g_),this._maybeScheduleHide()};this._element.classList.remove(eo),Rt(this._element),this._element.classList.add(Jt,Xt),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||B.trigger(this._element,v_).defaultPrevented)return;const s=()=>{this._element.classList.add(eo),this._element.classList.remove(Xt,Jt),B.trigger(this._element,__)};this._element.classList.add(Xt),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Jt),super.dispose()}isShown(){return this._element.classList.contains(Jt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){B.on(this._element,d_,e=>this._onInteraction(e,!0)),B.on(this._element,m_,e=>this._onInteraction(e,!1)),B.on(this._element,p_,e=>this._onInteraction(e,!0)),B.on(this._element,f_,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=ps.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}cs(ps);Oe(ps);const w_={class:"message-content-column"},E_=["id"],C_={class:"accordion-item"},S_=["id"],k_=["aria-controls"],T_={class:"d-flex align-items-center w-100"},x_={class:"badge bg-warning text-dark ms-auto me-2"},A_={class:"text-muted"},M_=["id","aria-labelledby"],O_={class:"accordion-body bg-light"},N_={class:"alert alert-warning mb-3",role:"alert"},D_={class:"compaction-metadata"},L_={class:"metadata-row"},I_={class:"metadata-row"},P_={key:0,class:"metadata-row"},j_={class:"continuation-content"},R_={class:"continuation-text border rounded p-3 bg-white"},H_={class:"mb-0"},V_={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=g(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=g(()=>`heading-${s.value}`),i=g(()=>`collapse-${s.value}`),a=O(null);let l=null;pe(()=>{a.value&&(l=new wt(a.value,{toggle:!1}))}),mi(()=>{l&&l.dispose()});function r(){l&&l.toggle()}const p=g(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),v=g(()=>p.value?e.messages[3]:e.messages[2]),c=g(()=>v.value?.metadata?.init_data?.compact_metadata||{}),$=g(()=>c.value.pre_tokens||0),h=g(()=>p.value?e.messages[4]:e.messages[3]),f=g(()=>h.value?.content||""),b=g(()=>{const _=e.messages[0]?.timestamp;return _?Pt(_):""});function E(_){return _?`${_.toLocaleString()} tokens`:"0 tokens"}return(_,d)=>(u(),m("div",{class:"message-row message-row-compaction",key:s.value},[d[7]||(d[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",w_,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",C_,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:r},[t("div",T_,[d[0]||(d[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),d[1]||(d[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",x_,w(E($.value)),1),t("small",A_,w(b.value),1)])],8,k_)],8,S_),t("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",O_,[t("div",N_,[d[5]||(d[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),se(" Compaction Details ")],-1)),t("div",D_,[t("div",L_,[d[2]||(d[2]=t("strong",null,"Trigger:",-1)),t("span",null,w(c.value.trigger||"auto"),1)]),t("div",I_,[d[3]||(d[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,w(E($.value)),1)]),c.value.post_tokens?(u(),m("div",P_,[d[4]||(d[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,w(E(c.value.post_tokens)),1)])):A("",!0)])]),t("div",j_,[d[6]||(d[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),se(" Continuation Message ")],-1)),t("div",R_,[t("pre",H_,w(f.value),1)])])])],8,M_)])],8,E_)])]))}},W_=te(V_,[["__scopeId","data-v-e0b95ba8"]]),F_={key:0,class:"text-muted text-center py-5"},U_={__name:"MessageList",setup(n){const e=xe(),s=me(),o=O(null),i=g(()=>{const c=e.currentMessages,$=[];let h=0;for(;h<c.length;){const f=c[h];if(l(f,c,h)){const b=c[h+2],_=b?.type==="system"&&b?.metadata?.subtype==="init"?5:4,d=c.slice(h,h+_);$.push({type:"compaction",messages:d}),h+=_;continue}p(f)&&$.push({type:"message",message:f,attachedTools:[]}),h++}return a($)});function a(c){const $=new Map,h=new Set;for(let b=0;b<c.length;b++){const E=c[b];if(E.type==="compaction")continue;const _=E.message,d=_.content&&_.content.trim().length>0&&_.content!=="Assistant response",y=_.type==="assistant"&&_.metadata?.has_tool_uses&&_.metadata?.tool_uses?.length>0;if(_.type==="assistant"&&y&&!d){let C=-1,x=!1;for(let F=b-1;F>=0;F--){const R=c[F];if(!h.has(F)){if(R.type==="message"&&R.message.type!=="assistant"){x=!0;break}if(R.type==="message"&&R.message.type==="assistant"){const N=R.message;if(N.content&&N.content.trim().length>0&&N.content!=="Assistant response"){C=F;break}else{C=F;break}}}}x&&C===-1||(x&&C>=0?($.has(C)||$.set(C,[]),$.get(C).push(..._.metadata.tool_uses),h.add(b)):!x&&C>=0&&($.has(C)||$.set(C,[]),$.get(C).push(..._.metadata.tool_uses),h.add(b)))}}const f=[];for(let b=0;b<c.length;b++){if(h.has(b))continue;const E=c[b];$.has(b)&&(E.attachedTools=[...E.attachedTools||[],...$.get(b)]),f.push(E)}return f}function l(c,$,h){if(h+3>=$.length)return!1;const f=$[h],b=$[h+1];let E=$[h+2],_=$[h+3],d=$[h+4];const y=f.type==="system"&&f.metadata?.subtype==="status"&&f.metadata?.init_data?.status==="compacting",C=b.type==="system"&&b.metadata?.subtype==="status"&&(b.metadata?.init_data?.status===null||b.metadata?.init_data?.status===void 0);if(E?.type==="system"&&E?.metadata?.subtype==="init"){if(h+4>=$.length)return!1;const F=!0,R=_?.type==="system"&&_?.metadata?.subtype==="compact_boundary",N=d?.type==="user"&&d?.content?.startsWith("This session is being continued from a previous conversation");return f.type==="system"&&f.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",y),console.log("  Msg2 (null status):",C),console.log("  Msg3 (init):",F),console.log("  Msg4 (boundary):",R),console.log("  Msg5 (continuation):",N)),y&&C&&F&&R&&N}else{const F=E?.type==="system"&&E?.metadata?.subtype==="compact_boundary",R=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return f.type==="system"&&f.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",y),console.log("  Msg2 (null status):",C),console.log("  Msg3 (boundary):",F),console.log("  Msg4 (continuation):",R)),y&&C&&F&&R}}async function r(){s.autoScrollEnabled&&(await Ps(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}le(()=>i.value.length,r),le(()=>e.currentToolCalls.length,r),le(()=>e.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),r),pe(()=>{setTimeout(()=>{r()},100)});function p(c){const $=c.subtype||c.metadata?.subtype;if(c.type==="system"&&$==="init"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const h=c.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(c.type==="user"){const h=c.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(c.type==="user"){const h=c.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}return!0}function v(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,$)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),m("div",F_," No messages yet. Start a conversation! ")):A("",!0),(u(!0),m(re,null,ue(i.value,(h,f)=>(u(),m(re,{key:`item-${f}`},[h.type==="message"?(u(),ge(Cd,{key:0,message:v(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(u(),ge(W_,{key:1,messages:h.messages},null,8,["messages"])):A("",!0)],64))),128))],512))}},B_=te(U_,[["__scopeId","data-v-6bae0fb1"]]),q_={class:"border-top bg-light"},z_={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},K_={class:"d-flex gap-2 align-items-end px-2 py-1"},G_=["placeholder","disabled"],Y_=["disabled"],J_={__name:"InputArea",setup(n){const e=ae(),s=ze(),o=O(null),i=O(window.innerWidth),a=g({get:()=>e.currentInput,set:_=>{e.currentInput=_}}),l=g(()=>e.currentSession?.is_processing||!1),r=g(()=>s.sessionConnected),p=g(()=>e.currentSession?.state==="starting"),v=g(()=>i.value<768),c=g(()=>p.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function $(){i.value=window.innerWidth}pe(()=>{window.addEventListener("resize",$)}),_e(()=>{window.removeEventListener("resize",$)});function h(_){if(_.key==="Enter"&&!_.shiftKey){if(v.value)return;_.preventDefault(),b()}}function f(){const _=o.value;if(!_)return;_.style.height="auto";const d=Math.min(_.scrollHeight,parseInt(getComputedStyle(_).maxHeight));_.style.height=d+"px"}function b(){a.value.trim()&&(s.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function E(){s.interruptSession()}return(_,d)=>(u(),m("div",q_,[r.value?A("",!0):(u(),m("div",z_,[...d[1]||(d[1]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),t("div",K_,[oe(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":d[0]||(d[0]=y=>a.value=y),class:"form-control",placeholder:c.value,disabled:p.value||!r.value,rows:"1",onInput:f,onKeydown:h},null,40,G_),[[de,a.value]]),l.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:E}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!r.value||p.value,onClick:b}," Send ",8,Y_))])]))}},X_=te(J_,[["__scopeId","data-v-ef1e5094"]]),Q_={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Z_={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},eh={class:"text-secondary"},th={class:"d-flex flex-column flex-grow-1 overflow-hidden"},sh={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=me(),i=g(()=>s.currentSession),a=g(()=>o.isLoading),l=g(()=>o.loadingMessage);return pe(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),le(()=>e.sessionId,async(r,p)=>{if(r!==p&&r!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(r)}finally{o.hideLoading()}}}),_e(()=>{}),(r,p)=>(u(),m("div",Q_,[a.value?(u(),m("div",Z_,[p[0]||(p[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",eh,w(l.value),1)])):A("",!0),i.value?(u(),ge(Mi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),t("div",th,[ce(B_)]),ce(X_),i.value?(u(),ge(Ii,{key:2,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),i.value?(u(),ge(Bi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):A("",!0)]))}},Ft=Ct("legion",()=>{const n=O(new Map),e=O(new Map),s=O(null),o=g(()=>n.value.get(s.value)||[]),i=g(()=>e.value.get(s.value)||[]);function a(b){s.value=b}async function l(b,E=100,_=0){try{const d=await ie.get(`/api/legions/${b}/timeline?limit=${E}&offset=${_}`),y=d.comms||[],C=d.total_count||y.length,x=d.has_more||!1;return y.sort((F,R)=>new Date(F.timestamp)-new Date(R.timestamp)),console.log(`Loaded ${y.length} of ${C} comms for legion ${b}`),n.value.set(b,y),n.value=new Map(n.value),{comms:y,totalCount:C,hasMore:x}}catch(d){throw console.error("Failed to load timeline:",d),d}}function r(b,E){n.value.has(b)||n.value.set(b,[]);const _=n.value.get(b);if(_.some(y=>y.comm_id===E.comm_id)){console.log(`Duplicate comm ${E.comm_id} prevented in timeline`);return}_.push(E),n.value=new Map(n.value)}async function p(b,E){try{const d=(await ie.post(`/api/legions/${b}/comms`,E)).comm;return console.log(`Sent comm ${d.comm_id} to legion ${b}`),d}catch(_){throw console.error("Failed to send comm:",_),_}}async function v(b){return console.log(`Minions for legion ${b} are already available in session store`),[]}async function c(b,E){try{const d=(await ie.post(`/api/legions/${b}/minions`,E)).minion;return await v(b),console.log(`Created minion ${d.minion_id} in legion ${b}`),d}catch(_){throw console.error("Failed to create minion:",_),_}}async function $(b){try{const E=await ie.post(`/api/legions/${b}/halt-all`);return console.log(`Halted ${E.halted_count} of ${E.total_minions} minions in legion ${b}`),E.failed_minions&&E.failed_minions.length>0&&console.warn("Failed to halt some minions:",E.failed_minions),E}catch(E){throw console.error("Failed to halt all minions:",E),E}}async function h(b){try{const E=await ie.post(`/api/legions/${b}/resume-all`);return console.log(`Resumed ${E.resumed_count} of ${E.total_minions} minions in legion ${b}`),E.failed_minions&&E.failed_minions.length>0&&console.warn("Failed to resume some minions:",E.failed_minions),E}catch(E){throw console.error("Failed to resume all minions:",E),E}}function f(b){n.value.delete(b),e.value.delete(b),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:l,addComm:r,sendComm:p,loadMinions:v,createMinion:c,haltAll:$,resumeAll:h,clearLegionData:f}}),nh=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Ft},Symbol.toStringTag,{value:"Module"})),oh={class:"timeline-header border-bottom p-3"},ih={class:"project-name"},ah=["title"],lh={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=we(),o=g(()=>s.projects.get(e.legionId)),i=g(()=>o.value?.name||"Legion");return(a,l)=>(u(),m("div",oh,[t("div",null,[t("div",ih,w(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,ah)])]))}},rh=te(lh,[["__scopeId","data-v-44f386f5"]]),ch={class:"timeline-status-bar border-top p-2 bg-light"},uh={class:"d-flex justify-content-end"},dh={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=me();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),m("div",ch,[t("div",uh,[t("button",{class:Z(["btn btn-sm",ts(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+w(ts(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},mh=te(dh,[["__scopeId","data-v-891c73db"]]),ph={class:"comm-composer border-top p-3"},fh={key:0,class:"d-flex gap-2 mb-2"},vh={class:"flex-grow-1"},_h=["disabled"],hh={label:"Minions"},gh=["value"],bh={style:{"min-width":"150px"}},yh=["disabled"],$h={class:"d-flex gap-2 align-items-end position-relative"},wh={class:"flex-grow-1 position-relative"},Eh=["disabled"],Ch=["onClick","onMouseenter"],Sh=["disabled"],kh={key:0},Th={key:1},xh={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Ft(),o=ae(),i=we(),a=O(""),l=O("task"),r=O(""),p=O(!1),v=O(window.innerWidth),c=O(!1),$=O([]),h=O(0),f=O(-1),b=O(null),E=O(null),_=g(()=>v.value<768),d=g(()=>{const q=i.projects.get(e.legionId);return!q||!q.session_ids?[]:q.session_ids.map(L=>o.sessions.get(L)).filter(L=>L&&L.is_minion)}),y=g(()=>a.value&&r.value.trim().length>0);function C(q){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[q.state]||"â—‹"}function x(q){return q.is_minion&&q.role?`${q.name} (${q.role})`:q.name}function F(){const q=b.value;if(!q)return;q.style.height="auto";const L=Math.min(q.scrollHeight,parseInt(getComputedStyle(q).maxHeight));q.style.height=L+"px"}function R(){const q=b.value;if(!q)return;F();const L=r.value,M=q.selectionStart,P=L.substring(0,M),T=P.lastIndexOf("#");if(T===-1){c.value=!1;return}const S=P.substring(T+1).toLowerCase();if(S.includes(" ")){c.value=!1;return}const I=d.value.filter(U=>U.name.toLowerCase().includes(S)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(I.length===0){c.value=!1;return}$.value=I,h.value=0,f.value=T,c.value=!0}function N(){if(!E.value)return;const q=E.value,L=q.children[h.value];if(!L)return;const M=L.offsetTop,P=L.offsetHeight,T=q.scrollTop,S=q.clientHeight;M<T?q.scrollTop=M:M+P>T+S&&(q.scrollTop=M+P-S)}function j(q){if(!c.value){if(q.key==="Enter"&&!q.shiftKey){if(_.value)return;y.value&&(q.preventDefault(),D())}return}if(q.key==="ArrowDown")q.preventDefault(),h.value=(h.value+1)%$.value.length,N();else if(q.key==="ArrowUp")q.preventDefault(),h.value=h.value===0?$.value.length-1:h.value-1,N();else if(q.key==="Enter"){q.preventDefault();const L=$.value[h.value];L&&k(L)}else q.key==="Escape"&&(c.value=!1)}function k(q){const L=b.value;if(!L)return;const M=r.value,P=L.selectionStart,T=M.substring(0,f.value)+"#"+q.name+" "+M.substring(P);r.value=T;const S=f.value+q.name.length+2;setTimeout(()=>{L.setSelectionRange(S,S),L.focus()},0),c.value=!1}async function D(){if(!(!y.value||p.value)){p.value=!0;try{const[q,L]=a.value.split(":"),M={comm_type:l.value,content:r.value.trim()};q==="minion"&&(M.to_minion_id=L),await s.sendComm(e.legionId,M),r.value="",F()}catch(q){console.error("Failed to send comm:",q),alert(`Failed to send comm: ${q.message}`)}finally{p.value=!1}}}function K(){v.value=window.innerWidth}return pe(()=>{window.addEventListener("resize",K)}),_e(()=>{window.removeEventListener("resize",K)}),le(c,q=>{if(q){const L=M=>{M.target.closest(".comm-composer")||(c.value=!1,document.removeEventListener("click",L))};setTimeout(()=>document.addEventListener("click",L),0)}}),(q,L)=>(u(),m("div",ph,[n.hideRecipientSelector?A("",!0):(u(),m("div",fh,[t("div",vh,[oe(t("select",{"onUpdate:modelValue":L[0]||(L[0]=M=>a.value=M),class:"form-select form-select-sm",disabled:p.value},[L[3]||(L[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",hh,[(u(!0),m(re,null,ue(d.value,M=>(u(),m("option",{key:M.session_id,value:`minion:${M.session_id}`},w(C(M))+" "+w(x(M)),9,gh))),128))])],8,_h),[[Pe,a.value]])]),t("div",bh,[oe(t("select",{"onUpdate:modelValue":L[1]||(L[1]=M=>l.value=M),class:"form-select form-select-sm",disabled:p.value},[...L[4]||(L[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,yh),[[Pe,l.value]])])])),t("div",$h,[t("div",wh,[oe(t("textarea",{ref_key:"contentTextarea",ref:b,"onUpdate:modelValue":L[2]||(L[2]=M=>r.value=M),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:R,onKeydown:j},null,40,Eh),[[de,r.value]]),c.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:E,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(re,null,ue($.value,(M,P)=>(u(),m("div",{key:M.id,class:Z(["autocomplete-item px-2 py-1",{"bg-light":P===h.value}]),onClick:T=>k(M),onMouseenter:T=>h.value=P},w(M.type==="minion"?C(M):"#ï¸âƒ£")+" "+w(M.name)+w(M.role?` (${M.role})`:""),43,Ch))),128))],512)):A("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!y.value||p.value,onClick:D},[p.value?(u(),m("span",kh,[...L[5]||(L[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),se(" Sending... ",-1)])])):(u(),m("span",Th,"Send"))],8,Sh)])])]))}},Ah=te(xh,[["__scopeId","data-v-40f84be2"]]),Mh={class:"message-content-column-full"},Oh=["aria-expanded"],Nh={class:"comm-sender-recipient"},Dh={class:"comm-badge-summary"},Lh=["title"],Ih={class:"comm-summary-text text-muted ms-2"},Ph=["aria-label"],jh={key:0,class:"comm-content-body"},Rh=["innerHTML"],Hh="ffffffff-ffff-ffff-ffff-ffffffffffff",Vh={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;tt.setOptions({breaks:!0,gfm:!0});const s=O(!1);function o(){s.value=!s.value}const i=g(()=>e.comm.from_minion_id===Hh),a=g(()=>{const v=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${v.toLocaleString()}`}),l=g(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),r=g(()=>{if(e.comm.summary)return e.comm.summary;const v=e.comm.content||"";return v.length>100?v.substring(0,100)+"...":v}),p=g(()=>{const v=e.comm.content||"";let c=tt.parse(v);return c=c.replace(/\n</g,"<"),c=c.replace(/\n+$/,""),as.sanitize(c)});return(v,c)=>(u(),m("div",{class:Z(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",Mh,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",Nh,[t("strong",{class:Z({"system-sender":i.value})},w(n.senderName),3),n.recipientName?(u(),m(re,{key:0},[c[0]||(c[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,w(n.recipientName),1)],64)):A("",!0)]),t("div",Dh,[t("span",{class:Z(["badge",l.value]),title:a.value},w(n.comm.comm_type),11,Lh),t("span",Ih,w(r.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},w(s.value?"â–¾":"â–¸"),9,Ph)],8,Oh),s.value?(u(),m("div",jh,[t("div",{class:"message-text",innerHTML:p.value},null,8,Rh)])):A("",!0)])],2))}},Wh=te(Vh,[["__scopeId","data-v-28513f64"]]),Fh={class:"timeline-view d-flex flex-column h-100"},Uh={key:0,class:"text-center text-muted"},Bh={key:1,class:"text-center text-danger"},qh={key:2,class:"text-center text-muted"},zh={key:3,class:"comm-list"},Kh={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Ft();we();const o=ae(),i=ze(),a=me(),l=O(!0),r=O(null),p=O(null),v=g(()=>s.currentComms);function c(_){return _.from_user?"You":_.from_minion_id?_.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(_.from_minion_id)?.name||"Unknown":"Unknown"}function $(_){return _.to_user?"You":_.to_minion_id?o.sessions.get(_.to_minion_id)?.name||"Unknown":"All"}async function h(){a.autoScrollEnabled&&(await Ps(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function f(){l.value=!0,r.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Ps(),await h(),setTimeout(()=>{h()},100)}catch(_){console.error("Failed to load timeline:",_),_.response?r.value=`${_.message} (${_.response.status})`:r.value=_.message||"Unknown error"}finally{l.value=!1}}function b(){i.connectLegion(e.legionId)}function E(){i.disconnectLegion()}return le(()=>v.value.length,()=>{h()}),pe(()=>{o.currentSessionId=null,f(),b(),setTimeout(()=>{h()},100)}),_e(()=>{E()}),(_,d)=>(u(),m("div",Fh,[ce(rh,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[l.value?(u(),m("div",Uh,[...d[0]||(d[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),se(" Loading timeline... ",-1)])])):r.value?(u(),m("div",Bh," Failed to load timeline: "+w(r.value),1)):v.value.length===0?(u(),m("div",qh," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",zh,[(u(!0),m(re,null,ue(v.value,y=>(u(),ge(Wh,{key:y.comm_id,comm:y,"sender-name":c(y),"recipient-name":$(y)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ce(Ah,{"legion-id":n.legionId},null,8,["legion-id"]),ce(mh,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Gh=te(Kh,[["__scopeId","data-v-b6752179"]]),Yh={class:"hierarchy-header border-bottom p-3"},Jh={class:"d-flex justify-content-between align-items-center"},Xh={class:"project-name"},Qh={class:"fleet-controls d-flex gap-2"},Zh=["disabled"],eg={key:0,class:"spinner-border spinner-border-sm me-1"},tg=["disabled"],sg={key:0,class:"spinner-border spinner-border-sm me-1"},ng={__name:"HierarchyHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=we(),o=ae(),i=me(),a=g(()=>s.projects.get(e.legionId)),l=g(()=>a.value?.name||"Legion"),r=g(()=>Array.from(o.sessions.values()).filter(b=>b.is_minion&&b.project_id===e.legionId)),p=g(()=>r.value.filter(f=>f.state==="active")),v=g(()=>r.value.length===0||p.value.length===0),c=g(()=>r.value.length===0);function $(){i.showModal("fleet-control",{legionId:e.legionId,operation:"halt",activeMinionsCount:p.value.length,totalMinionsCount:r.value.length})}function h(){i.showModal("fleet-control",{legionId:e.legionId,operation:"resume",activeMinionsCount:p.value.length,totalMinionsCount:r.value.length})}return(f,b)=>(u(),m("div",Yh,[t("div",Jh,[t("div",null,[t("div",Xh,w(l.value),1),b[0]||(b[0]=t("div",{class:"view-name"},"Minion Hierarchy",-1))]),t("div",Qh,[t("button",{class:"btn btn-sm btn-outline-warning",disabled:v.value||f.isOperating,onClick:$,title:"Emergency halt all active minions"},[f.isOperating&&f.lastOperation==="halt"?(u(),m("span",eg)):A("",!0),b[1]||(b[1]=se(" Halt All ",-1))],8,Zh),t("button",{class:"btn btn-sm btn-outline-success",disabled:c.value||f.isOperating,onClick:h,title:"Resume all minions"},[f.isOperating&&f.lastOperation==="resume"?(u(),m("span",sg)):A("",!0),b[2]||(b[2]=se(" Resume All ",-1))],8,tg)])])]))}},og=te(ng,[["__scopeId","data-v-7d7fd660"]]),ig={class:"hierarchy-status-bar border-top p-2 bg-light"},ag={__name:"HierarchyStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,s)=>(u(),m("div",ig,[...s[0]||(s[0]=[t("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},lg=te(ag,[["__scopeId","data-v-d43e967b"]]),rg={class:"minion-info flex-grow-1"},cg={class:"minion-name"},ug={key:0,class:"me-1"},dg={key:1,class:"badge bg-secondary ms-2"},mg={key:0,class:"latest-activity text-muted"},pg={key:0,class:"activity-prefix"},fg=["title"],vg={key:1,class:"activity-time ms-1"},_g={key:1,class:"latest-activity text-muted"},hg={class:"activity-prefix"},gg=["title"],bg={key:2,class:"latest-activity text-muted fst-italic small"},yg={class:"node-row"},$g={class:"node-left"},wg={key:0,class:"me-2"},Eg={key:1,class:"badge bg-secondary ms-2"},Cg={class:"node-right"},Sg={key:0,class:"latest-message-preview"},kg={key:0,class:"message-prefix"},Tg=["title"],xg={key:1,class:"message-time ms-1"},Ag={key:1,class:"last-comm-preview"},Mg={class:"comm-direction"},Og=["title"],Ng={key:2,class:"text-muted fst-italic small"},Dg={class:"node-actions"},Lg={key:2,class:"minion-children"},Ig={key:1,class:"text-danger small ms-4"},Pg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,i=ae(),a=xe(),l=me(),r=g(()=>!s.minionData||!s.minionData.id?null:i.getSession(s.minionData.id)),p=g(()=>{if(!s.minionData||!s.minionData.id)return null;const k=a.messagesBySession.get(s.minionData.id);if(!k||k.length===0)return null;for(let D=k.length-1;D>=0;D--){const K=k[D];if(K.type!=="result"&&!(K.type==="user"&&K.content&&K.content.startsWith("Tool results:"))&&!(K.type==="system"&&K.content==="System message")&&!(K.type==="assistant"&&K.content==="Assistant response")&&(K.type==="user"||K.type==="assistant"||K.type==="system"))return{content:K.content,type:K.type,timestamp:K.timestamp}}return null}),v=g(()=>{if(!s.minionData)return null;const k={...s.minionData};return r.value&&(k.state=r.value.state,k.is_processing=r.value.is_processing,r.value.latest_message&&(k.latest_message=r.value.latest_message,k.latest_message_type=r.value.latest_message_type,k.latest_message_time=r.value.latest_message_time)),p.value&&(k.latest_message=p.value.content,k.latest_message_type=p.value.type,k.latest_message_time=p.value.timestamp),k}),c=g(()=>s.level*24),$=g(()=>!s.minionData||!s.minionData.id?!1:i.currentSessionId===s.minionData.id),h=g(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),f=g(()=>s.minionData&&s.minionData.is_overseer&&h.value),b=g(()=>{const k=v.value;return k?k.state==="paused"&&k.is_processing?"pending-prompt":k.is_processing?"processing":k.state||"created":"created"}),E=g(()=>{const k=b.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[k]||"status-dot-grey"}),_=g(()=>{const k=b.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[k]||"#d3d3d3"}}),d=g(()=>{const k=v.value;if(!k||!k.latest_message_type)return"";const D=k.latest_message_type;return D==="user"?"User -->:":D==="system"?"System:":""}),y=g(()=>{const k=v.value;if(!k||!k.latest_message)return"";const D=k.latest_message,K=150;return D.length>K?D.slice(0,K)+"...":D}),C=g(()=>{const k=v.value;if(!k||!k.latest_message_time)return"";try{const D=Date.now();let K;if(typeof k.latest_message_time=="number"?K=k.latest_message_time<3250368e4?k.latest_message_time*1e3:k.latest_message_time:K=new Date(k.latest_message_time).getTime(),isNaN(K)||K<9466848e5||K>D+6e4)return console.warn("Invalid timestamp for relative time calculation:",k.latest_message_time,"parsed to:",K),"";const q=D-K;if(q<0)return"just now";const L=Math.floor(q/6e4),M=Math.floor(L/60),P=Math.floor(M/24);return P>0?`${P}d ago`:M>0?`${M}h ago`:L>0?`${L}m ago`:"just now"}catch(D){return console.error("Error calculating relative time:",D,k.latest_message_time),""}});function x(k){return k.to_user?"User":k.to_minion_name?k.to_minion_name:"unknown"}function F(k){const D=k.summary||k.content||"";return D.length>150?D.substring(0,150)+"...":D}function R(){o("minion-click",s.minionData.id)}function N(){const k=i.sessions.get(s.minionData.id);k&&l.showModal("edit-session",{session:k})}function j(){const k=i.sessions.get(s.minionData.id);k&&l.showModal("manage-session",{session:k})}return(k,D)=>{const K=so("MinionTreeNode",!0);return n.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:vt({marginLeft:`${c.value}px`})},[n.layout==="sidebar"?(u(),m("div",{key:0,class:Z(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:R},[t("div",{class:Z(["status-dot me-2",E.value]),style:vt(_.value)},null,6),t("div",rg,[t("div",cg,[f.value?(u(),m("span",ug,"ðŸ‘‘")):A("",!0),t("strong",null,w(n.minionData.name),1),f.value?(u(),m("span",dg,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),v.value?.latest_message?(u(),m("div",mg,[d.value?(u(),m("span",pg,w(d.value),1)):A("",!0),t("span",{class:"activity-content",title:v.value.latest_message},w(y.value),9,fg),C.value?(u(),m("span",vg,"("+w(C.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(u(),m("div",_g,[t("span",hg,[D[1]||(D[1]=se("â†’ ",-1)),t("strong",null,w(x(n.minionData.last_comm)),1),D[2]||(D[2]=se(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},w(F(n.minionData.last_comm)),9,gg)])):(u(),m("div",bg," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(N,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(j,["stop"])}," âš™ï¸ ")],2)):(u(),m("div",{key:1,class:Z(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:R},[t("div",yg,[t("div",$g,[t("div",{class:Z(["status-dot me-2",E.value]),style:vt(_.value)},null,6),f.value?(u(),m("span",wg,"ðŸ‘‘")):A("",!0),t("strong",null,w(n.minionData.name),1),f.value?(u(),m("span",Eg,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),t("div",Cg,[v.value?.latest_message?(u(),m("div",Sg,[d.value?(u(),m("span",kg,w(d.value),1)):A("",!0),t("span",{class:"message-content",title:v.value.latest_message},w(y.value),9,Tg),C.value?(u(),m("span",xg,"("+w(C.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(u(),m("div",Ag,[t("span",Mg,[D[3]||(D[3]=se("â†’ ",-1)),t("strong",null,w(x(n.minionData.last_comm)),1),D[4]||(D[4]=se(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},w(F(n.minionData.last_comm)),9,Og)])):(u(),m("div",Ng," No activity yet "))]),t("div",Dg,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(N,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(j,["stop"])}," âš™ï¸ ")])])],2)),h.value?(u(),m("div",Lg,[(u(!0),m(re,null,ue(n.minionData.children,q=>(u(),ge(K,{key:q.id,"minion-data":q,level:n.level+1,layout:n.layout,onMinionClick:D[0]||(D[0]=L=>k.$emit("minion-click",L))},null,8,["minion-data","level","layout"]))),128))])):A("",!0)],4)):(u(),m("div",Ig," âš  Minion data is missing "))}}},ci=te(Pg,[["__scopeId","data-v-e940b7c4"]]),jg={class:"modal-dialog modal-dialog-centered"},Rg={class:"modal-content"},Hg={class:"modal-header"},Vg={class:"modal-title",id:"fleetControlModalLabel"},Wg={class:"modal-body"},Fg={key:0,class:"text-center py-4"},Ug={class:"text-muted"},Bg={key:1},qg={class:"text-muted"},zg={key:2},Kg={class:"text-muted"},Gg={key:3},Yg={class:"text-muted"},Jg={class:"modal-footer"},Xg={key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},Qg={__name:"FleetControlModal",setup(n){const e=me(),s=Ft(),o=O(!1),i=O(""),a=O(null),l=O(null),r=O(null);let p=null;const v=O(null),c=O(0),$=O(0),h=g(()=>l.value?l.value.type==="success"?"Success":"Error":a.value==="halt"?"Emergency Halt All Minions":a.value==="resume"?"Resume All Minions":"Fleet Control");pe(()=>{r.value&&(p=new ot(r.value),r.value.addEventListener("hidden.bs.modal",()=>{a.value=null,l.value=null,o.value=!1}))}),_e(()=>{p&&p.dispose()}),le(()=>e.currentModal,d=>{if(!d||d.name!=="fleet-control")return;const y=d.data;y&&(v.value=y.legionId,c.value=y.activeMinionsCount||0,$.value=y.totalMinionsCount||0,a.value=y.operation,l.value=null,p&&p.show())});function f(){a.value=null,p&&p.hide()}async function b(){a.value==="halt"?await E():a.value==="resume"&&await _()}async function E(){o.value=!0,i.value="Halting all minions...";try{const d=await s.haltAll(v.value),y=d.failed_minions&&d.failed_minions.length>0?` Failed to halt ${d.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Halt Complete",message:`Halted ${d.halted_count} of ${d.total_minions} minion(s).${y}`}}catch(d){console.error("Failed to halt all minions:",d),l.value={type:"error",title:"Halt Failed",message:`Failed to halt minions: ${d.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}async function _(){o.value=!0,i.value="Resuming all minions...";try{const d=await s.resumeAll(v.value),y=d.failed_minions&&d.failed_minions.length>0?` Failed to resume ${d.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Resume Complete",message:`Resumed ${d.resumed_count} of ${d.total_minions} minion(s).${y}`}}catch(d){console.error("Failed to resume all minions:",d),l.value={type:"error",title:"Resume Failed",message:`Failed to resume minions: ${d.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}return(d,y)=>(u(),m("div",{class:"modal fade",id:"fleetControlModal",tabindex:"-1","aria-labelledby":"fleetControlModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",jg,[t("div",Rg,[t("div",Hg,[t("h5",Vg,w(h.value),1),y[0]||(y[0]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",Wg,[o.value?(u(),m("div",Fg,[y[1]||(y[1]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Processing...")],-1)),t("p",Ug,w(i.value),1)])):l.value?(u(),m("div",Bg,[t("div",{class:Z(["alert mb-3",l.value.type==="success"?"alert-success":"alert-danger"])},[t("strong",null,w(l.value.title),1)],2),t("p",qg,w(l.value.message),1)])):a.value==="halt"?(u(),m("div",zg,[y[4]||(y[4]=t("div",{class:"alert alert-warning mb-3"},[t("strong",null,"âš ï¸ Emergency Halt")],-1)),t("p",Kg,[y[2]||(y[2]=se(" Are you sure you want to halt all ",-1)),t("strong",null,w(c.value),1),y[3]||(y[3]=se(" active minion(s) in this legion? ",-1))]),y[5]||(y[5]=t("p",{class:"text-muted"}," This will interrupt their current processing. Minions will remain in ACTIVE state but will stop processing. ",-1))])):a.value==="resume"?(u(),m("div",Gg,[y[8]||(y[8]=t("div",{class:"alert alert-info mb-3"},[t("strong",null,"Resume All Minions")],-1)),t("p",Yg,[y[6]||(y[6]=se(' This will send "continue" to all ',-1)),t("strong",null,w($.value),1),y[7]||(y[7]=se(" minion(s) in this legion. ",-1))]),y[9]||(y[9]=t("p",{class:"text-muted"}," Minions will resume processing from where they were interrupted. ",-1))])):A("",!0)]),t("div",Jg,[l.value?(u(),m("button",Xg,"OK")):a.value&&!o.value?(u(),m(re,{key:1},[t("button",{type:"button",class:"btn btn-secondary",onClick:f},"Cancel"),t("button",{type:"button",class:Z(["btn",a.value==="halt"?"btn-warning":"btn-success"]),onClick:b},w(a.value==="halt"?"Halt All":"Resume All"),3)],64)):A("",!0)])])])],512))}},Zg=te(Qg,[["__scopeId","data-v-53a63f8d"]]),eb={class:"hierarchy-view d-flex flex-column h-100"},tb={class:"hierarchy-tree-container flex-grow-1 overflow-auto p-3"},sb={key:0,class:"text-center py-5"},nb={key:1,class:"alert alert-danger"},ob={class:"mb-0"},ib={key:2,class:"hierarchy-tree"},ab={class:"user-root-node mb-3 border rounded bg-white"},lb={class:"node-row"},rb={class:"node-left"},cb={key:0,class:"badge bg-primary ms-2"},ub={class:"node-right"},db={key:0,class:"last-comm-preview"},mb={class:"comm-direction"},pb=["title"],fb={key:1,class:"text-muted fst-italic"},vb={key:0,class:"alert alert-info ms-4"},_b={key:1,class:"root-minions ms-4"},hb={__name:"HierarchyView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=it(),o=we(),i=ae(),a=ze(),l=Ft(),r=O(null),p=O(!1),v=O(null),c=g(()=>r.value&&r.value.children&&r.value.children.length>0);async function $(){p.value=!0,v.value=null;try{const d=await ie.get(`/api/legions/${e.legionId}/hierarchy`);r.value=d,console.log("Loaded hierarchy:",d)}catch(d){console.error("Failed to load hierarchy:",d),v.value=d.message||"Unknown error"}finally{p.value=!1}}function h(d){s.push(`/session/${d}`)}pe(()=>{$()}),le(()=>e.legionId,()=>{$()});function f(d){return d.to_user?"User":d.to_minion_name?d.to_minion_name:"unknown"}function b(d){const y=d.summary||d.content||"";return y.length>150?y.substring(0,150)+"...":y}function E(d,y){if(d.id===y)return d;if(d.children)for(const C of d.children){const x=E(C,y);if(x)return x}return null}function _(d){if(r.value){if(d.from_minion_id){const y=E(r.value,d.from_minion_id);y&&y.type==="minion"&&(y.last_comm=d,console.log(`Updated minion ${y.name} last_comm`))}d.from_user&&r.value.type==="user"&&(r.value.last_comm=d,console.log("Updated user last_comm"))}}return pe(()=>{i.currentSessionId=null,$(),l.setCurrentLegion(e.legionId),a.connectLegion(e.legionId),le(()=>i.sessions,d=>{if(r.value){for(const[y,C]of d)if(C.is_minion&&C.project_id===e.legionId){const x=E(r.value,y);x&&x.type==="minion"&&(x.state!==C.state&&(x.state=C.state,console.log(`Updated minion ${x.name} state to ${C.state}`)),x.is_processing!==C.is_processing&&(x.is_processing=C.is_processing,console.log(`Updated minion ${x.name} is_processing to ${C.is_processing}`)),x.latest_message!==C.latest_message&&(x.latest_message=C.latest_message,x.latest_message_type=C.latest_message_type,x.latest_message_time=C.latest_message_time,console.log(`Updated minion ${x.name} latest_message`)))}}},{deep:!0}),le(()=>l.commsByLegion.get(e.legionId),d=>{if(d&&d.length>0){const y=d[d.length-1];_(y)}},{deep:!0}),le(()=>o.projects.get(e.legionId)?.session_ids?.length||0,(d,y)=>{d!==y&&(console.log(`Project session_ids changed (${y} â†’ ${d}), reloading hierarchy`),$())})}),_e(()=>{console.log("HierarchyView unmounted")}),(d,y)=>(u(),m("div",eb,[ce(og,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",tb,[p.value?(u(),m("div",sb,[...y[0]||(y[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):v.value?(u(),m("div",nb,[y[1]||(y[1]=t("strong",null,"Failed to load hierarchy",-1)),t("p",ob,w(v.value),1)])):r.value?(u(),m("div",ib,[t("div",ab,[t("div",lb,[t("div",rb,[y[2]||(y[2]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,w(r.value.name),1),c.value?(u(),m("span",cb,w(r.value.children.length)+" "+w(r.value.children.length===1?"minion":"minions"),1)):A("",!0)]),t("div",ub,[r.value.last_comm?(u(),m("div",db,[t("span",mb,[y[3]||(y[3]=se(" â†’ ",-1)),t("strong",null,w(f(r.value.last_comm)),1),y[4]||(y[4]=se(": ",-1))]),t("span",{class:"comm-content",title:r.value.last_comm.content||""},w(b(r.value.last_comm)),9,pb)])):(u(),m("div",fb," No communications yet "))])])]),c.value?(u(),m("div",_b,[(u(!0),m(re,null,ue(r.value.children,C=>(u(),ge(ci,{key:C.id,"minion-data":C,level:1,onMinionClick:h},null,8,["minion-data"]))),128))])):(u(),m("div",vb,[...y[5]||(y[5]=[t("p",{class:"mb-2"},"No minions yet",-1),t("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):A("",!0)]),ce(lg,{"legion-id":n.legionId},null,8,["legion-id"]),ce(Zg)]))}},gb=te(hb,[["__scopeId","data-v-b67fbac2"]]),bb={class:"project-overview d-flex flex-column h-100"},yb={class:"project-overview-header border-bottom p-3"},$b={class:"d-flex align-items-center justify-content-between"},wb={class:"mb-1"},Eb={key:0,class:"me-2"},Cb={class:"text-muted font-monospace"},Sb={class:"d-flex gap-2"},kb=["title"],Tb={class:"project-overview-content flex-grow-1 overflow-auto p-3"},xb={key:0,class:"text-center py-5"},Ab={key:1,class:"alert alert-danger"},Mb={key:2,class:"text-center py-5"},Ob={key:3},Nb={class:"row g-3 mb-4"},Db={class:"col-md-4"},Lb={class:"card h-100"},Ib={class:"card-body"},Pb={class:"card-title mb-0"},jb={class:"text-muted"},Rb={key:0,class:"col-md-4"},Hb={class:"card h-100"},Vb={class:"card-body"},Wb={class:"card-title mb-0"},Fb={class:"text-muted"},Ub={class:"col-md-4"},Bb={class:"card h-100"},qb={class:"card-body"},zb={class:"card-title mb-0"},Kb={class:"text-muted"},Gb={key:0,class:"card mb-4"},Yb={class:"card mb-4"},Jb={class:"card-header d-flex align-items-center justify-content-between"},Xb={class:"mb-0"},Qb={class:"badge bg-secondary"},Zb={class:"card-body p-0"},ey={key:0,class:"text-center text-muted py-4"},ty={key:1,class:"list-group list-group-flush"},sy=["onClick"],ny={class:"flex-grow-1"},oy={class:"d-flex align-items-center"},iy={key:0,class:"me-2"},ay={key:1,class:"me-2"},ly={key:2,class:"badge bg-warning ms-1"},ry={class:"text-muted"},cy={class:"card"},uy={class:"card-body"},dy={class:"row mb-0"},my={class:"col-sm-8 font-monospace text-break"},py={class:"col-sm-8 font-monospace text-break"},fy={class:"col-sm-8"},vy={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},_y={class:"text-muted"},hy={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=it(),o=we(),i=ae(),a=me(),l=O(!1),r=O(null),p=g(()=>o.getProject(e.projectId)),v=g(()=>p.value?.session_ids?p.value.session_ids.map(j=>i.getSession(j)).filter(j=>j!=null):[]),c=g(()=>v.value.some(j=>j.is_minion)),$=g(()=>v.value.length),h=g(()=>v.value.filter(j=>j.state==="ACTIVE").length),f=g(()=>v.value.filter(j=>j.is_minion).length),b=g(()=>v.value.filter(j=>j.is_minion&&j.state==="ACTIVE").length),E=g(()=>{const j=v.value.some(K=>K.state==="ACTIVE"),k=v.value.some(K=>K.is_processing);return v.value.some(K=>K.state==="ERROR")?"Error":k?"Working":j?"Active":$.value>0?"Idle":"Empty"}),_=g(()=>{switch(E.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),d=g(()=>{switch(E.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});function y(j){switch(j){case"ACTIVE":return"bg-success";case"CREATED":return"bg-secondary";case"STARTING":return"bg-info";case"PAUSED":return"bg-warning";case"TERMINATED":return"bg-dark";case"ERROR":return"bg-danger";default:return"bg-secondary"}}function C(j){s.push(`/session/${j}`)}function x(){s.push(`/timeline/${e.projectId}`)}function F(){s.push(`/hierarchy/${e.projectId}`)}function R(){a.showModal("edit-project",{project:p.value})}function N(){a.showModal("create-minion",{project:p.value})}return pe(()=>{o.selectProject(e.projectId),i.currentSessionId=null}),le(()=>e.projectId,j=>{o.selectProject(j),i.currentSessionId=null}),(j,k)=>(u(),m("div",bb,[t("div",yb,[t("div",$b,[t("div",null,[t("h4",wb,[c.value?(u(),m("span",Eb,"ðŸ›")):A("",!0),se(" "+w(p.value?.name||"Project Overview"),1)]),t("small",Cb,w(p.value?.working_directory),1)]),t("div",Sb,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:R}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:c.value?"Create minion":"Add session",onClick:N}," âž• "+w(c.value?"Add Minion":"Add Session"),9,kb)])])]),t("div",Tb,[l.value?(u(),m("div",xb,[...k[0]||(k[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):r.value?(u(),m("div",Ab,w(r.value),1)):p.value?(u(),m("div",Ob,[t("div",Nb,[t("div",Db,[t("div",Lb,[t("div",Ib,[k[2]||(k[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",Pb,w($.value),1),t("small",jb,w(h.value)+" active",1)])])]),c.value?(u(),m("div",Rb,[t("div",Hb,[t("div",Vb,[k[3]||(k[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Minions",-1)),t("h3",Wb,w(f.value),1),t("small",Fb,w(b.value)+" active",1)])])])):A("",!0),t("div",Ub,[t("div",Bb,[t("div",qb,[k[4]||(k[4]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",zb,[t("span",{class:Z(_.value)},w(E.value),3)]),t("small",Kb,w(d.value),1)])])])]),c.value?(u(),m("div",Gb,[k[5]||(k[5]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:x}," ðŸ“Š View Timeline "),t("button",{class:"btn btn-outline-primary",onClick:F}," ðŸŒ³ View Hierarchy ")])])])):A("",!0),t("div",Yb,[t("div",Jb,[t("h5",Xb,w(c.value?"Sessions & Minions":"Sessions"),1),t("span",Qb,w(v.value.length),1)]),t("div",Zb,[v.value.length===0?(u(),m("div",ey,' No sessions yet. Click "Add Session" to create one. ')):(u(),m("div",ty,[(u(!0),m(re,null,ue(v.value,D=>(u(),m("div",{key:D.session_id,class:"list-group-item list-group-item-action d-flex align-items-center",style:{cursor:"pointer"},onClick:K=>C(D.session_id)},[t("div",ny,[t("div",oy,[D.is_minion?(u(),m("span",iy,"ðŸ¤–")):(u(),m("span",ay,"ðŸ’¬")),t("strong",null,w(D.name||"Unnamed Session"),1),t("span",{class:Z(["badge ms-2",y(D.state)])},w(D.state),3),D.is_processing?(u(),m("span",ly," Processing ")):A("",!0)]),t("small",ry,w(D.role||D.current_permission_mode||"default"),1)]),k[6]||(k[6]=t("span",{class:"text-muted"},"â†’",-1))],8,sy))),128))]))])]),t("div",cy,[k[10]||(k[10]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",uy,[t("dl",dy,[k[7]||(k[7]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",my,w(p.value.working_directory),1),k[8]||(k[8]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",py,w(p.value.project_id),1),k[9]||(k[9]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",fy,w(c.value?"Yes (has minions)":"No"),1)])])])])):(u(),m("div",Mb,[...k[1]||(k[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",vy,[k[11]||(k[11]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",_y,w($.value)+" session"+w($.value!==1?"s":""),1)])]))}},gy=te(hy,[["__scopeId","data-v-971c0ed7"]]),by=[{path:"/",name:"home",component:bi},{path:"/project/:projectId",name:"project",component:gy,props:!0},{path:"/session/:sessionId",name:"session",component:sh,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Gh,props:!0},{path:"/hierarchy/:legionId",name:"hierarchy",component:gb,props:!0}],yy=pi({history:fi(),routes:by}),$y={class:"connection-indicators"},wy=["title"],Ey=["title"],Cy=["title"],Sy={__name:"ConnectionIndicator",setup(n){const e=ze();function s(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:r}=a[i];return r>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:p,retryCount:v}=r[i];let c="Disconnected";return p?c="Connected":v>0&&(c=`Reconnecting (attempt ${v})`),`${a[i]}
${l[i]}
Status: ${c}`}return(i,a)=>(u(),m("div",$y,[t("div",{class:Z(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,wy),t("div",{class:Z(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,Ey),t("div",{class:Z(["indicator",s("legion")]),title:o("legion")}," ðŸ‘¥ ",10,Cy)]))}},ky=te(Sy,[["__scopeId","data-v-d35b07c8"]]),Ty={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},xy={class:"d-flex align-items-center gap-2"},Ay={__name:"AppHeader",setup(n){const e=me();function s(){e.toggleSidebar()}return(o,i)=>(u(),m("header",Ty,[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...i[0]||(i[0]=[t("span",null,"â˜°",-1)])]),i[1]||(i[1]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",xy,[ce(ky)])]))}},My={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Oy={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Ny=["title"],Dy={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(r){return r.state==="paused"&&r.is_processing?"pending-prompt":r.is_processing?"processing":r.state}function i(r){const p=o(r);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function a(r){const p=o(r);return p==="starting"||p==="processing"||p==="pending-prompt"}function l(r){const p=o(r),v=p.charAt(0).toUpperCase()+p.slice(1),c=r.name||"Unnamed Session",$=r.is_minion&&r.role?` (${r.role})`:"";return`${c}${$}: ${v}`}return(r,p)=>(u(),m("div",My,[!n.sessions||n.sessions.length===0?(u(),m("div",Oy)):(u(!0),m(re,{key:1},ue(n.sessions,v=>(u(),m("div",{key:v.session_id,class:Z(["progress-bar",{"progress-bar-striped progress-bar-animated":a(v)}]),style:vt({width:s.value,backgroundColor:i(v),cursor:"help"}),title:l(v)},null,14,Ny))),128))]))}},Ly=te(Dy,[["__scopeId","data-v-a79cfeec"]]),Iy=["data-project-id"],Py=["id"],jy=["aria-expanded","aria-controls","aria-label","onKeydown"],Ry=["aria-label","onKeydown"],Hy={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Vy={class:"fw-semibold",style:{"flex-shrink":"0"}},Wy={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Fy={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Uy=["title"],By=["title"],qy=["id","aria-labelledby"],zy={class:"accordion-body p-0"},Ky={class:"list-group list-group-flush"},Gy={class:"minion-hierarchy-container"},Yy={key:0,class:"text-center py-2"},Jy={key:2,class:"text-muted text-center py-2 small"},Xy={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=it(),o=we(),i=ae(),a=me(),l=O(e.project.is_expanded||!1),r=O(null),p=O(!1);let v=null;const c=g(()=>o.formatPath(e.project.working_directory)),$=g(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(P=>i.getSession(P)).filter(P=>P!=null)),h=g(()=>$.value.some(P=>P.is_minion)),f=g(()=>{const P=s.currentRoute.value;return P.name==="timeline"&&P.params.legionId===e.project.project_id}),b=g(()=>{const P=s.currentRoute.value;return P.name==="hierarchy"&&P.params.legionId===e.project.project_id}),E=g(()=>{const P=s.currentRoute.value;return P.name==="project"&&P.params.projectId===e.project.project_id});function _(P){const T=window.bootstrap;if(!T)return;const S=document.getElementById(`collapse-${e.project.project_id}`);if(!S)return;T.Collapse.getOrCreateInstance(S).toggle(),l.value=!l.value}function d(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function y(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function C(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const P=i.currentSessionId;P&&i.getSession(P)&&e.project.session_ids?.includes(P)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function x(){a.showModal("edit-project",{project:e.project})}function F(){a.showModal("create-minion",{project:e.project})}function R(){s.push(`/timeline/${e.project.project_id}`)}function N(){s.push(`/hierarchy/${e.project.project_id}`)}async function j(){p.value=!0;try{const P=await ie.get(`/api/legions/${e.project.project_id}/hierarchy`);r.value=P}catch(P){console.error("Failed to load minion hierarchy:",P),r.value=null}finally{p.value=!1}}function k(P){s.push(`/session/${P}`)}function D(P,T){if(P&&P.id===T)return P;if(P&&P.children)for(const S of P.children){const I=D(S,T);if(I)return I}return null}le(l,P=>{P&&j()}),pe(()=>{v=le(()=>i.sessions,P=>{if(!(!r.value||!l.value)){for(const[T,S]of P)if(S.is_minion&&S.project_id===e.project.project_id){const I=D(r.value,T);I&&I.type==="minion"&&(I.state!==S.state&&(I.state=S.state),I.is_processing!==S.is_processing&&(I.is_processing=S.is_processing),I.latest_message!==S.latest_message&&(I.latest_message=S.latest_message,I.latest_message_type=S.latest_message_type,I.latest_message_time=S.latest_message_time))}}},{deep:!0}),le(()=>i.sessions.size,(P,T)=>{if(l.value&&(P>T&&Array.from(i.sessions.values()).some(U=>U.is_minion&&U.project_id===e.project.project_id&&(!r.value||!D(r.value,U.session_id)))&&(console.log("New minion detected, reloading hierarchy"),j()),P<T&&r.value)){const S=i.sessions,I=U=>U.type==="minion"&&!S.has(U.id)?!0:U.children?U.children.some(Y=>I(Y)):!1;I(r.value)&&(console.log("Minion deletion detected, reloading hierarchy"),j())}}),l.value&&j()}),_e(()=>{v&&v()});function K(P){P.dataTransfer.effectAllowed="move",P.dataTransfer.setData("application/project-id",e.project.project_id),P.dataTransfer.setData("text/plain",e.project.project_id),P.target.classList.add("dragging")}function q(P){P.target.classList.remove("dragging")}function L(P){P.preventDefault(),P.dataTransfer.dropEffect="move";const T=P.currentTarget.getBoundingClientRect(),S=T.top+T.height/2;P.clientY<S?(P.currentTarget.classList.add("drop-above"),P.currentTarget.classList.remove("drop-below")):(P.currentTarget.classList.add("drop-below"),P.currentTarget.classList.remove("drop-above"))}function M(P){P.preventDefault(),P.currentTarget.classList.remove("drop-above","drop-below");const T=P.dataTransfer.getData("application/project-id")||P.dataTransfer.getData("text/plain");if(!T||T===e.project.project_id)return;const S=P.currentTarget.getBoundingClientRect(),I=S.top+S.height/2,U=P.clientY<I,Y=o.orderedProjects,X=Y.findIndex(V=>V.project_id===e.project.project_id),G=Y.findIndex(V=>V.project_id===T);if(X===-1||G===-1)return;const H=[...Y],[J]=H.splice(G,1);let he=U?X:X+1;G<X&&he--,H.splice(he,0,J);const z=H.map(V=>V.project_id);o.reorderProjects(z)}return(P,T)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:K,onDragend:q,onDragover:L,onDrop:M},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:Z(["accordion-button bg-white p-2 project-header-split",{collapsed:!l.value,"project-selected":E.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":l.value?"Collapse session list":"Expand session list",onClick:ve(_,["stop"]),onKeydown:[Xe(ve(_,["prevent"]),["enter"]),Xe(ve(_,["prevent"]),["space"])]},[(u(),m("svg",{class:Z(["chevron-icon",{expanded:l.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...T[0]||(T[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,jy),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:d,onKeydown:[Xe(ve(d,["prevent"]),["enter"]),Xe(ve(d,["prevent"]),["space"])]},[t("div",Hy,[t("div",Vy,[h.value?(u(),m("span",Wy,"ðŸ›")):A("",!0),se(" "+w(n.project.name),1)]),t("div",Fy,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ve(x,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:h.value?"Create minion":"Add session or minion",type:"button",onClick:ve(F,["stop"])}," âž• ",8,Uy)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},w(c.value),9,By)],40,Ry)],2)],8,Py),ce(Ly,{project:n.project,sessions:$.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:Z(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:y,onHidden:C},[t("div",zy,[t("div",Ky,[h.value?(u(),m("div",{key:0,class:Z(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:f.value}]),style:{cursor:"pointer"},onClick:R},[...T[1]||(T[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):A("",!0),h.value?(u(),m("div",{key:1,class:Z(["list-group-item list-group-item-action hierarchy-item d-flex align-items-center p-2",{active:b.value}]),style:{cursor:"pointer"},onClick:N},[...T[2]||(T[2]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),t("span",{class:"fw-semibold"},"Hierarchy"),t("small",{class:"text-muted ms-2"},"(Minion Tree)")],-1)])],2)):A("",!0),t("div",Gy,[p.value?(u(),m("div",Yy,[...T[3]||(T[3]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value&&r.value.children&&r.value.children.length>0?(u(!0),m(re,{key:1},ue(r.value.children,S=>(u(),ge(ci,{key:S.id,"minion-data":S,level:0,layout:"sidebar",onMinionClick:k},null,8,["minion-data"]))),128)):(u(),m("div",Jy," No sessions "))])])])],42,qy)],40,Iy))}},Qy=te(Xy,[["__scopeId","data-v-68ebf1fe"]]),Zy={class:"project-list"},e1={key:0,class:"text-muted text-center py-3"},t1={__name:"ProjectList",setup(n){const e=we(),s=g(()=>e.orderedProjects);return(o,i)=>(u(),m("div",Zy,[s.value.length===0?(u(),m("div",e1,' No projects yet. Click "New" to create one. ')):A("",!0),(u(!0),m(re,null,ue(s.value,a=>(u(),ge(Qy,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},s1={class:"flex-grow-1 overflow-auto p-3"},n1={id:"sessions-container"},o1={__name:"Sidebar",setup(n){const e=me(),s=g(()=>e.sidebarCollapsed),o=g(()=>e.isMobile),i=g(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const l=O(!1);function r(c){l.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",v)}function p(c){l.value&&e.setSidebarWidth(c.clientX)}function v(){l.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",v)}return(c,$)=>(u(),m("aside",{id:"sidebar",class:Z(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value}]),style:vt(i.value)},[t("div",s1,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),t("div",n1,[ce(t1)])]),t("div",{class:"sidebar-resize-handle",onMousedown:r},null,32)],6))}},i1=te(o1,[["__scopeId","data-v-d792f0f0"]]),a1={class:"modal-dialog modal-lg"},l1={class:"modal-content"},r1={class:"modal-body"},c1={class:"mb-3"},u1={class:"input-group"},d1=["disabled"],m1={key:0,class:"text-center py-4"},p1={key:1,class:"alert alert-danger",role:"alert"},f1={key:2,class:"folder-list"},v1=["onClick","onDblclick"],_1={class:"d-flex align-items-center flex-grow-1"},h1=["onClick"],g1={key:1,class:"text-center text-muted py-3"},b1={class:"modal-footer"},y1=["disabled"],$1={__name:"FolderBrowserModal",setup(n){const e=me(),s=O(""),o=O(""),i=O([]),a=O(!1),l=O(""),r=O(null);let p=null,v=null;const c=g(()=>{if(!s.value)return null;const C=s.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?"/"+C.join("/"):"/")});function $(C){if(!C)return"";const x=C.split(/[\\/]/).filter(Boolean);return x.length<=2?C:".../"+x.slice(-2).join("/")}async function h(){a.value=!0,l.value="",i.value=[],o.value="";try{const C=s.value?{path:s.value}:{},x=await ie.get("/api/filesystem/browse",{params:C});x.current_path&&(s.value=x.current_path),i.value=x.directories||[]}catch(C){console.error("Failed to load directory:",C),l.value=C.message||"Failed to load directory"}finally{a.value=!1}}function f(C){o.value=C.path}function b(C){s.value=C.path,o.value="",h()}function E(){c.value&&(s.value=c.value,o.value="",h())}function _(){const C=o.value||s.value;C&&v&&v(C),p&&p.hide()}function d(){h()}function y(){i.value=[],o.value="",l.value="",v=null,e.hideModal()}return le(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&p){const x=C.data||{};s.value=x.defaultPath||x.currentPath||"",v=x.onSelect||null,p.show()}}),pe(()=>{r.value&&be(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(x=>x.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{p=new C(r.value),r.value.addEventListener("shown.bs.modal",d),r.value.addEventListener("hidden.bs.modal",y)})}),_e(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",d),r.value.removeEventListener("hidden.bs.modal",y)),p&&p.dispose()}),(C,x)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",a1,[t("div",l1,[x[6]||(x[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",r1,[t("div",c1,[x[1]||(x[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",u1,[oe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=F=>s.value=F),onKeyup:Xe(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[de,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:a.value}," ðŸ”„ Refresh ",8,d1)])]),a.value?(u(),m("div",m1,[...x[2]||(x[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(u(),m("div",p1,w(l.value),1)):(u(),m("div",f1,[c.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:E,role:"button"},[...x[3]||(x[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):A("",!0),(u(!0),m(re,null,ue(i.value,F=>(u(),m("div",{key:F.path,class:Z(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:F.path===o.value}]),onClick:R=>f(F),onDblclick:R=>b(F),role:"button"},[t("div",_1,[x[4]||(x[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,w(F.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ve(R=>b(F),["stop"])}," Open ",8,h1)],42,v1))),128)),i.value.length===0?(u(),m("div",g1," No subdirectories found ")):A("",!0)]))]),t("div",b1,[x[5]||(x[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:!o.value},' Select "'+w($(o.value||s.value))+'" ',9,y1)])])])],512))}},w1=te($1,[["__scopeId","data-v-0d61ed46"]]),E1={class:"modal-dialog"},C1={class:"modal-content"},S1={class:"modal-body"},k1={class:"mb-3"},T1={key:0,class:"invalid-feedback"},x1={class:"mb-3"},A1={class:"input-group"},M1={key:0,class:"invalid-feedback"},O1={class:"mb-3 form-check"},N1={key:0,class:"mb-3 ms-4"},D1={key:1,class:"alert alert-danger",role:"alert"},L1={class:"modal-footer"},I1=["disabled"],P1={key:0,class:"spinner-border spinner-border-sm me-2"},j1={__name:"ProjectCreateModal",setup(n){const e=we(),s=ae(),o=me(),i=O({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),a=O({name:"",workingDirectory:""}),l=O(!1),r=O(""),p=O(null);let v=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:_=>{i.value.workingDirectory=_,a.value.workingDirectory=""}})}function $(){a.value={};let _=!0;return i.value.name.trim()||(a.value.name="Project name is required",_=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",_=!1),_}async function h(){if($()){l.value=!0,r.value="";try{const _=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await s.createSession(_.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),v&&v.hide(),f()}catch(_){console.error("Failed to create project:",_),r.value=_.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function f(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},a.value={},r.value=""}function b(){const _=document.getElementById("projectName");_&&_.focus()}function E(){f(),o.hideModal()}return le(()=>o.currentModal,_=>{_?.name==="create-project"&&v&&v.show()}),pe(()=>{p.value&&be(async()=>{const{default:_}=await import("./modal-BK1Vt_in.js").then(d=>d.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{v=new _(p.value),p.value.addEventListener("shown.bs.modal",b),p.value.addEventListener("hidden.bs.modal",E)})}),_e(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",b),p.value.removeEventListener("hidden.bs.modal",E)),v&&v.dispose()}),(_,d)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",E1,[t("div",C1,[d[11]||(d[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",S1,[t("form",{onSubmit:ve(h,["prevent"])},[t("div",k1,[d[4]||(d[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),oe(t("input",{type:"text",class:Z(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":d[0]||(d[0]=y=>i.value.name=y),placeholder:"My Project",required:""},null,2),[[de,i.value.name]]),a.value.name?(u(),m("div",T1,w(a.value.name),1)):A("",!0)]),t("div",x1,[d[5]||(d[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",A1,[oe(t("input",{type:"text",class:Z(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":d[1]||(d[1]=y=>i.value.workingDirectory=y),placeholder:"/path/to/project",required:""},null,2),[[de,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(u(),m("div",M1,w(a.value.workingDirectory),1)):A("",!0)]),d[6]||(d[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",O1,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":d[2]||(d[2]=y=>i.value.createSession=y)},null,512),[[_t,i.value.createSession]]),d[7]||(d[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),d[8]||(d[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(u(),m("div",N1,[d[9]||(d[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),oe(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":d[3]||(d[3]=y=>i.value.sessionName=y),placeholder:"main"},null,512),[[de,i.value.sessionName]])])):A("",!0),r.value?(u(),m("div",D1,w(r.value),1)):A("",!0)],32)]),t("div",L1,[d[10]||(d[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:l.value},[l.value?(u(),m("span",P1)):A("",!0),se(" "+w(l.value?"Creating...":"Create Project"),1)],8,I1)])])])],512))}},R1=te(j1,[["__scopeId","data-v-b8c9a401"]]),H1={class:"modal-dialog"},V1={class:"modal-content"},W1={class:"modal-body"},F1={class:"mb-3"},U1={key:0,class:"invalid-feedback"},B1={class:"mb-3"},q1=["value"],z1={key:0,class:"alert alert-danger",role:"alert"},K1={class:"danger-zone"},G1={class:"text-muted small"},Y1=["disabled"],J1={key:0,class:"alert alert-warning mt-3",role:"alert"},X1={class:"mb-2"},Q1={class:"d-flex gap-2"},Z1=["disabled"],e$={key:0,class:"spinner-border spinner-border-sm me-2"},t$=["disabled"],s$={class:"modal-footer"},n$=["disabled"],o$={key:0,class:"spinner-border spinner-border-sm me-2"},i$={__name:"ProjectEditModal",setup(n){const e=we(),s=me(),o=O(null),i=O({name:""}),a=O({name:""}),l=O(!1),r=O(!1),p=O(""),v=O(!1),c=O(null);let $=null;const h=g(()=>o.value?.session_ids?.length||0);function f(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Project name is required",C=!1),C}async function b(){if(!(!f()||!o.value)){l.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(C){console.error("Failed to update project:",C),p.value=C.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function E(){if(o.value){r.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(C){console.error("Failed to delete project:",C),p.value=C.message||"Failed to delete project. Please try again."}finally{r.value=!1}}}function _(){i.value={name:""},a.value={},p.value="",v.value=!1}function d(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function y(){_(),o.value=null,s.hideModal()}return le(()=>s.currentModal,C=>{if(C?.name==="edit-project"&&$){const x=C.data||{};o.value=x.project,o.value&&(i.value.name=o.value.name),$.show()}}),pe(()=>{c.value&&be(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(x=>x.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{$=new C(c.value),c.value.addEventListener("shown.bs.modal",d),c.value.addEventListener("hidden.bs.modal",y)})}),_e(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",d),c.value.removeEventListener("hidden.bs.modal",y)),$&&$.dispose()}),(C,x)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",H1,[t("div",V1,[x[10]||(x[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",W1,[t("form",{onSubmit:ve(b,["prevent"])},[t("div",F1,[x[3]||(x[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),oe(t("input",{type:"text",class:Z(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":x[0]||(x[0]=F=>i.value.name=F),placeholder:"My Project",required:""},null,2),[[de,i.value.name]]),a.value.name?(u(),m("div",U1,w(a.value.name),1)):A("",!0)]),t("div",B1,[x[4]||(x[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,q1),x[5]||(x[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(u(),m("div",z1,w(p.value),1)):A("",!0)],32),x[8]||(x[8]=t("hr",null,null,-1)),t("div",K1,[x[6]||(x[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",G1," Deleting this project will also delete all "+w(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x[1]||(x[1]=F=>v.value=!0),disabled:r.value}," ðŸ—‘ï¸ Delete Project ",8,Y1)]),v.value?(u(),m("div",J1,[x[7]||(x[7]=t("strong",null,"Are you sure?",-1)),t("p",X1,' This will permanently delete the project "'+w(o.value?.name)+'" and all '+w(h.value)+" session(s). ",1),t("div",Q1,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:E,disabled:r.value},[r.value?(u(),m("span",e$)):A("",!0),se(" "+w(r.value?"Deleting...":"Yes, Delete Permanently"),1)],8,Z1),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:x[2]||(x[2]=F=>v.value=!1),disabled:r.value}," Cancel ",8,t$)])])):A("",!0)]),t("div",s$,[x[9]||(x[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:l.value},[l.value?(u(),m("span",o$)):A("",!0),se(" "+w(l.value?"Saving...":"Save Changes"),1)],8,n$)])])])],512))}},a$=te(i$,[["__scopeId","data-v-52679516"]]),l$={class:"modal-dialog modal-lg"},r$={class:"modal-content"},c$={class:"modal-header"},u$={class:"modal-title",id:"createSessionModalLabel"},d$={key:0,class:"text-muted small"},m$={class:"modal-body"},p$={class:"mb-3"},f$={key:0,class:"invalid-feedback"},v$={class:"mb-3"},_$={class:"mb-3"},h$={key:0,class:"form-text text-muted"},g$={class:"mb-3"},b$={class:"form-text d-flex justify-content-between"},y$={key:0,class:"invalid-feedback"},$$={class:"mb-3 form-check"},w$={key:0,class:"form-text text-warning"},E$={class:"mb-3"},C$={class:"mb-3 form-check"},S$={key:0,class:"alert alert-danger",role:"alert"},k$={class:"modal-footer"},T$=["disabled"],x$={key:0,class:"spinner-border spinner-border-sm me-2"},A$={__name:"SessionCreateModal",setup(n){const e=it();we();const s=ae(),o=me(),i=O(null),a=O({name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0}),l=O({name:""}),r=O(!1),p=O(""),v=O(null);let c=null;const $={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},h=g(()=>a.value.system_prompt.length),f=g(()=>h.value>6e3),b=g(()=>h.value>5500&&h.value<=6e3),E=g(()=>$[a.value.model]||null);function _(){l.value={};let F=!0;return a.value.name.trim()||(l.value.name="Session name is required",F=!1),f.value&&(F=!1),F}async function d(){if(!(!_()||!i.value)){r.value=!0,p.value="";try{const F=a.value.allowed_tools.split(",").map(j=>j.trim()).filter(j=>j.length>0),R={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,allowed_tools:F},N=await s.createSession(i.value.project_id,R);a.value.startImmediately&&await s.startSession(N.session_id),e.push(`/session/${N.session_id}`),c&&c.hide(),y()}catch(F){console.error("Failed to create session:",F),p.value=F.message||"Failed to create session. Please try again."}finally{r.value=!1}}}function y(){a.value={name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0},l.value={},p.value=""}function C(){const F=document.getElementById("sessionName");F&&F.focus()}function x(){y(),i.value=null,o.hideModal()}return le(()=>o.currentModal,F=>{if(F?.name==="create-session"&&c){const R=F.data||{};i.value=R.project,c.show()}}),pe(()=>{v.value&&be(async()=>{const{default:F}=await import("./modal-BK1Vt_in.js").then(R=>R.m);return{default:F}},__vite__mapDeps([0,1])).then(({default:F})=>{c=new F(v.value),v.value.addEventListener("shown.bs.modal",C),v.value.addEventListener("hidden.bs.modal",x)})}),_e(()=>{v.value&&(v.value.removeEventListener("shown.bs.modal",C),v.value.removeEventListener("hidden.bs.modal",x)),c&&c.dispose()}),(F,R)=>(u(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:v},[t("div",l$,[t("div",r$,[t("div",c$,[t("h5",u$,[R[7]||(R[7]=se(" Create New Session ",-1)),i.value?(u(),m("span",d$,"in "+w(i.value.name),1)):A("",!0)]),R[8]||(R[8]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",m$,[t("form",{onSubmit:ve(d,["prevent"])},[t("div",p$,[R[9]||(R[9]=t("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),oe(t("input",{type:"text",class:Z(["form-control",{"is-invalid":l.value.name}]),id:"sessionName","onUpdate:modelValue":R[0]||(R[0]=N=>a.value.name=N),placeholder:"main",required:""},null,2),[[de,a.value.name]]),l.value.name?(u(),m("div",f$,w(l.value.name),1)):A("",!0)]),t("div",v$,[R[11]||(R[11]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":R[1]||(R[1]=N=>a.value.permission_mode=N)},[...R[10]||(R[10]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Pe,a.value.permission_mode]]),R[12]||(R[12]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",_$,[R[14]||(R[14]=t("label",{for:"model",class:"form-label"},"Model",-1)),oe(t("select",{class:"form-select",id:"model","onUpdate:modelValue":R[2]||(R[2]=N=>a.value.model=N)},[...R[13]||(R[13]=[t("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),t("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),t("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),t("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Pe,a.value.model]]),E.value?(u(),m("small",h$,w(E.value.description),1)):A("",!0)]),t("div",g$,[R[15]||(R[15]=t("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),oe(t("textarea",{class:Z(["form-control",{"is-invalid":f.value}]),id:"systemPrompt","onUpdate:modelValue":R[3]||(R[3]=N=>a.value.system_prompt=N),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[de,a.value.system_prompt]]),t("div",b$,[t("span",null,w(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),t("span",{class:Z({"text-danger":f.value,"text-warning":b.value})},w(h.value)+" / 6000 chars ",3)]),f.value?(u(),m("div",y$," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):A("",!0)]),t("div",$$,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":R[4]||(R[4]=N=>a.value.override_system_prompt=N)},null,512),[[_t,a.value.override_system_prompt]]),R[17]||(R[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),m("div",w$,[...R[16]||(R[16]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):A("",!0)]),t("div",E$,[R[18]||(R[18]=t("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),oe(t("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":R[5]||(R[5]=N=>a.value.allowed_tools=N),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[de,a.value.allowed_tools]]),R[19]||(R[19]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",C$,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":R[6]||(R[6]=N=>a.value.startImmediately=N)},null,512),[[_t,a.value.startImmediately]]),R[20]||(R[20]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),p.value?(u(),m("div",S$,w(p.value),1)):A("",!0)],32)]),t("div",k$,[R[21]||(R[21]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:d,disabled:r.value},[r.value?(u(),m("span",x$)):A("",!0),se(" "+w(r.value?"Creating...":"Create Session"),1)],8,T$)])])])],512))}},M$=te(A$,[["__scopeId","data-v-8bfe4c32"]]),O$={class:"modal-dialog"},N$={class:"modal-content"},D$={class:"modal-body"},L$={class:"mb-3"},I$={key:0,class:"invalid-feedback"},P$={class:"mb-3"},j$=["value"],R$={class:"mb-3"},H$={class:"form-control-plaintext"},V$={class:"mb-3"},W$=["disabled"],F$={key:0,value:"bypassPermissions"},U$={class:"form-text"},B$={key:0,class:"text-warning"},q$={key:1},z$={key:0,class:"mb-3"},K$={class:"card"},G$={class:"card-body"},Y$={key:0,class:"mb-2"},J$={key:1,class:"mb-2"},X$={key:2,class:"mt-2"},Q$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},Z$={key:1,class:"alert alert-danger",role:"alert"},ew={class:"modal-footer"},tw=["disabled"],sw={key:0,class:"spinner-border spinner-border-sm me-2"},nw={__name:"SessionEditModal",setup(n){const e=ae(),s=me(),o=O(null),i=O({name:"",permission_mode:"default"}),a=O({name:""}),l=O(!1),r=O(""),p=O(null);let v=null;const c=g(()=>o.value?.state==="active"||o.value?.state==="starting"),$=g(()=>o.value?.initial_permission_mode==="bypassPermissions");function h(y){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[y]||"bg-secondary"}function f(){a.value={};let y=!0;return i.value.name.trim()||(a.value.name="Session name is required",y=!1),y}async function b(){if(!(!f()||!o.value)){l.value=!0,r.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),v&&v.hide()}catch(y){console.error("Failed to update session:",y),r.value=y.message||"Failed to update session. Please try again."}finally{l.value=!1}}}function E(){i.value={name:"",permission_mode:"default"},a.value={},r.value=""}function _(){const y=document.getElementById("editSessionName");y&&(y.focus(),y.select())}function d(){E(),o.value=null,s.hideModal()}return le(()=>s.currentModal,y=>{if(y?.name==="edit-session"&&v){const C=y.data||{};o.value=C.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),v.show()}}),pe(()=>{p.value&&be(async()=>{const{default:y}=await import("./modal-BK1Vt_in.js").then(C=>C.m);return{default:y}},__vite__mapDeps([0,1])).then(({default:y})=>{v=new y(p.value),p.value.addEventListener("shown.bs.modal",_),p.value.addEventListener("hidden.bs.modal",d)})}),_e(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",_),p.value.removeEventListener("hidden.bs.modal",d)),v&&v.dispose()}),(y,C)=>(u(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",O$,[t("div",N$,[C[15]||(C[15]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",D$,[t("form",{onSubmit:ve(b,["prevent"])},[t("div",L$,[C[2]||(C[2]=t("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),oe(t("input",{type:"text",class:Z(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":C[0]||(C[0]=x=>i.value.name=x),placeholder:"Session Name",required:""},null,2),[[de,i.value.name]]),a.value.name?(u(),m("div",I$,w(a.value.name),1)):A("",!0)]),t("div",P$,[C[3]||(C[3]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,j$),C[4]||(C[4]=t("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),t("div",R$,[C[5]||(C[5]=t("label",{class:"form-label"},"Current State",-1)),t("div",H$,[t("span",{class:Z(["badge",h(o.value?.state)])},w(o.value?.state),3)])]),t("div",V$,[C[9]||(C[9]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":C[1]||(C[1]=x=>i.value.permission_mode=x),disabled:!c.value},[C[6]||(C[6]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),C[7]||(C[7]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),C[8]||(C[8]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),$.value?(u(),m("option",F$,"âš ï¸ Bypass Permissions (No prompts)")):A("",!0)],8,W$),[[Pe,i.value.permission_mode]]),t("div",U$,[c.value?(u(),m("span",q$," Controls which tool actions require permission prompts ")):(u(),m("span",B$," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),m("div",z$,[C[13]||(C[13]=t("label",{class:"form-label"},"System Prompt Configuration",-1)),t("div",K$,[t("div",G$,[o.value?.override_system_prompt?(u(),m("div",Y$,[...C[10]||(C[10]=[t("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),t("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),m("div",J$,[...C[11]||(C[11]=[t("span",{class:"badge bg-info"},"Append Mode",-1),t("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),m("div",X$,[C[12]||(C[12]=t("strong",{class:"small"},"Custom Instructions:",-1)),t("div",Q$,w(o.value.system_prompt),1)])):A("",!0)])])])):A("",!0),r.value?(u(),m("div",Z$,w(r.value),1)):A("",!0)],32)]),t("div",ew,[C[14]||(C[14]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:l.value},[l.value?(u(),m("span",sw)):A("",!0),se(" "+w(l.value?"Saving...":"Save Changes"),1)],8,tw)])])])],512))}},ow=te(nw,[["__scopeId","data-v-c99ca17f"]]),iw={class:"modal-dialog modal-dialog-centered"},aw={class:"modal-content"},lw={class:"modal-header"},rw={class:"modal-title",id:"manageSessionModalLabel"},cw={class:"modal-body"},uw={key:0,class:"text-center py-4"},dw={class:"text-muted"},mw={key:1},pw={key:2},fw={class:"text-muted"},vw={key:0,class:"text-center py-2"},_w={key:1,class:"alert alert-warning mt-3"},hw={class:"mb-0 mt-2"},gw={key:0,class:"text-muted"},bw={key:3},yw={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},$w={class:"d-grid gap-2"},ww=["disabled"],Ew=["disabled"],Cw=["disabled"],Sw=["disabled"],kw={class:"modal-footer"},Tw={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},xw={__name:"SessionManageModal",setup(n){const e=it(),s=ae(),o=me(),i=ze();xe();const a=O(null),l=O(!1),r=O(""),p=O(""),v=O(null),c=O(null);let $=null;const h=O([]),f=O(!1),b=g(()=>v.value==="reset"?"Reset Session":v.value==="delete"?"Delete Session":"Manage Session");function E(){v.value="reset"}async function _(){if(v.value="delete",h.value=[],!!a.value){f.value=!0;try{const k=await ie.get(`/api/sessions/${a.value.session_id}/descendants`);h.value=k.descendants||[]}catch(k){console.error("Failed to fetch descendants:",k),h.value=[]}finally{f.value=!1}}}function d(){v.value=null}async function y(){v.value==="reset"?await F():v.value==="delete"&&await R()}async function C(){if(a.value){l.value=!0,r.value="Restarting session...";try{const k=a.value.session_id,D=s.currentSessionId===k,K=await ie.post(`/api/sessions/${k}/restart`);if(K.success)console.log("Session restarted successfully"),D&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(k)),$&&$.hide();else{const q=K.error||K.detail||"Failed to restart session";console.error("Failed to restart session:",q),p.value=`Failed to restart session: ${q}`}}catch(k){console.error("Error restarting session:",k);const D=k.data?.detail||k.message||"Unknown error";p.value=`Error restarting session: ${D}`}finally{l.value=!1}}}async function x(){if(a.value)try{$&&$.hide(),console.log("Ending session",a.value.session_id);const k=a.value.session_id;await ie.post(`/api/sessions/${k}/terminate`),s.currentSessionId===k&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(k){console.error("Error ending session:",k),s.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function F(){if(a.value){l.value=!0,r.value="Resetting session...";try{const k=a.value.session_id,D=s.currentSessionId===k,K=await ie.post(`/api/sessions/${k}/reset`);if(K.success)console.log("Session reset successfully"),D&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(k)),$&&$.hide();else{const q=K.error||K.detail||"Failed to reset session";console.error("Failed to reset session:",q),p.value=`Failed to reset session: ${q}`,v.value=null}}catch(k){console.error("Error resetting session:",k);const D=k.data?.detail||k.message||"Unknown error";p.value=`Error resetting session: ${D}`,v.value=null}finally{l.value=!1}}}async function R(){if(a.value){l.value=!0,r.value="Deleting session...";try{const k=a.value.session_id;await s.deleteSession(k),e.currentRoute.value.params.sessionId===k&&e.push("/"),$&&$.hide()}catch(k){console.error("Error deleting session:",k);const D=k.data?.detail||k.message||"Unknown error";p.value=`Error deleting session: ${D}`,v.value=null}finally{l.value=!1}}}function N(){v.value=null,l.value=!1,r.value="",p.value="",h.value=[],f.value=!1}function j(){N(),a.value=null,o.hideModal()}return le(()=>o.currentModal,k=>{if(k?.name==="manage-session"&&$){const D=k.data||{};a.value=D.session,N(),$.show()}}),pe(()=>{c.value&&be(async()=>{const{default:k}=await import("./modal-BK1Vt_in.js").then(D=>D.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{$=new k(c.value),c.value.addEventListener("hidden.bs.modal",j)})}),_e(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",j),$&&$.dispose()}),(k,D)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",iw,[t("div",aw,[t("div",lw,[t("h5",rw,w(v.value?b.value:"Manage Session"),1),D[1]||(D[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",cw,[l.value?(u(),m("div",uw,[D[2]||(D[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",dw,w(r.value),1)])):v.value==="reset"?(u(),m("div",mw,[...D[3]||(D[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):v.value==="delete"?(u(),m("div",pw,[D[9]||(D[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",fw,[D[4]||(D[4]=se("This will permanently delete session ",-1)),t("strong",null,w(a.value?.name),1),D[5]||(D[5]=se(".",-1))]),D[10]||(D[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),f.value?(u(),m("div",vw,[...D[6]||(D[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):h.value.length>0?(u(),m("div",_w,[D[7]||(D[7]=t("strong",null,"Cascading Deletion:",-1)),D[8]||(D[8]=se(" This session has ",-1)),t("strong",null,w(h.value.length),1),se(" child session"+w(h.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",hw,[(u(!0),m(re,null,ue(h.value,K=>(u(),m("li",{key:K.session_id,class:"small"},[t("strong",null,w(K.name||K.session_id),1),K.role?(u(),m("span",gw," ("+w(K.role)+")",1)):A("",!0)]))),128))])])):A("",!0)])):(u(),m("div",bw,[p.value?(u(),m("div",yw,[D[11]||(D[11]=t("strong",null,"Error:",-1)),se(" "+w(p.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:D[0]||(D[0]=K=>p.value="")})])):A("",!0),D[18]||(D[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",$w,[t("button",{class:"btn btn-outline-primary text-start",onClick:C,disabled:l.value},[...D[12]||(D[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,ww),t("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:l.value},[...D[13]||(D[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,Ew),D[16]||(D[16]=t("hr",{class:"my-2"},null,-1)),D[17]||(D[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:E,disabled:l.value},[...D[14]||(D[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,Cw),t("button",{class:"btn btn-outline-danger text-start",onClick:_,disabled:l.value},[...D[15]||(D[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,Sw)]),D[19]||(D[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),se(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",kw,[v.value&&!l.value?(u(),m(re,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:d},"Cancel"),t("button",{type:"button",class:Z(["btn",v.value==="delete"?"btn-danger":"btn-warning"]),onClick:y},w(v.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?A("",!0):(u(),m("button",Tw,"Cancel"))])])])],512))}},Aw=te(xw,[["__scopeId","data-v-6b832853"]]),Mw={class:"modal-dialog modal-dialog-centered modal-lg"},Ow={class:"modal-content"},Nw={class:"modal-body"},Dw={key:0,class:"text-center text-muted py-4"},Lw={key:1},Iw={class:"mb-3"},Pw={class:"font-monospace small"},jw={class:"mb-3"},Rw=["value"],Hw={class:"mb-3"},Vw={class:"mb-3"},Ww={class:"mb-3"},Fw={key:0},Uw={class:"d-flex flex-wrap gap-1"},Bw={key:1,class:"text-muted small"},qw={key:0,class:"mb-3"},zw={class:"d-flex flex-wrap gap-1"},Kw={key:1,class:"mb-3"},Gw={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},Yw={class:"mb-3"},Jw={class:"text-muted"},Xw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},Qw={__name:"SessionInfoModal",setup(n){const e=ae(),s=xe(),o=me(),i=O(null),a=O(!1),l=O(null);let r=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},v=g(()=>{if(!i.value)return null;const E=e.initData.get(i.value);return E||(s.messagesBySession.get(i.value)||[]).find(y=>y.type==="system"&&(y.subtype==="init"||y.metadata?.subtype==="init")&&y.metadata?.init_data)?.metadata?.init_data||null});function c(E){return E?p[E]||E:"Default (Sonnet 4.5)"}function $(E){return typeof E=="string"?E:typeof E=="object"&&E.type==="preset"?`Preset: ${E.preset}`:JSON.stringify(E,null,2)}function h(E){E.target.select()}function f(){i.value=null,a.value=!1}function b(){f(),o.hideModal()}return le(()=>o.currentModal,E=>{if(E?.name==="session-info"&&r){const _=E.data||{};i.value=_.sessionId,a.value=!1,r.show()}}),pe(()=>{l.value&&be(async()=>{const{default:E}=await import("./modal-BK1Vt_in.js").then(_=>_.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{r=new E(l.value),l.value.addEventListener("hidden.bs.modal",b)})}),_e(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",b),r&&r.dispose()}),(E,_)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[t("div",Mw,[t("div",Ow,[_[9]||(_[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Nw,[v.value?(u(),m("div",Lw,[t("div",Iw,[_[1]||(_[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",Pw,w(i.value),1)]),t("div",jw,[_[2]||(_[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:v.value.cwd||"Not specified",readonly:"",onClick:h},null,8,Rw)]),t("div",Hw,[_[3]||(_[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,w(c(v.value.model)),1)]),t("div",Vw,[_[4]||(_[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,w(v.value.permissionMode||"default"),1)]),t("div",Ww,[_[5]||(_[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(v.value.allowed_tools||v.value.tools)&&(v.value.allowed_tools||v.value.tools).length>0?(u(),m("div",Fw,[t("div",Uw,[(u(!0),m(re,null,ue(v.value.allowed_tools||v.value.tools,d=>(u(),m("span",{key:d,class:"badge bg-secondary"},w(d),1))),128))])])):(u(),m("div",Bw,"No pre-authorized tools (will prompt for permissions)"))]),v.value.commands&&v.value.commands.length>0?(u(),m("div",qw,[_[6]||(_[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",zw,[(u(!0),m(re,null,ue(v.value.commands,d=>(u(),m("span",{key:d,class:"badge bg-info"},w(d),1))),128))])])):A("",!0),v.value.systemPrompt?(u(),m("div",Kw,[_[7]||(_[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",Gw,w($(v.value.systemPrompt)),1)])):A("",!0),t("div",Yw,[t("h6",Jw,[_[8]||(_[8]=se(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:_[0]||(_[0]=d=>a.value=!a.value)},w(a.value?"Hide":"Show"),1)]),a.value?(u(),m("pre",Xw,w(JSON.stringify(v.value,null,2)),1)):A("",!0)])])):(u(),m("div",Dw," No session configuration data available "))]),_[10]||(_[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},Zw=te(Qw,[["__scopeId","data-v-b28b39b3"]]),eE={class:"modal-dialog modal-dialog-centered"},tE={class:"modal-content"},sE={class:"modal-body"},nE={class:"mb-3"},oE=["value"],iE={key:0,class:"form-text"},aE={class:"mb-3"},lE={class:"mb-3"},rE={key:0,class:"form-text text-muted"},cE={class:"mb-3"},uE={for:"minion-role",class:"form-label"},dE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},mE={key:1,class:"field-indicator modified",title:"Modified from template"},pE=["placeholder","title"],fE={class:"mb-3"},vE={for:"minion-context",class:"form-label"},_E={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},hE={key:1,class:"field-indicator modified",title:"Modified from template"},gE=["title"],bE={class:"form-text d-flex justify-content-between"},yE={key:0,class:"invalid-feedback"},$E={class:"mb-3 form-check"},wE={key:0,class:"form-text text-warning"},EE={class:"mb-3"},CE={class:"mb-3"},SE={class:"input-group"},kE={class:"mb-3"},TE={for:"permission-mode",class:"form-label"},xE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},AE={key:1,class:"field-indicator modified",title:"Modified from template"},ME=["title"],OE={class:"mb-3"},NE={for:"allowed-tools",class:"form-label"},DE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},LE={key:1,class:"field-indicator modified",title:"Modified from template"},IE=["title"],PE={class:"mb-3 form-check"},jE={key:0,class:"form-text text-muted"},RE={key:1,class:"form-text text-info"},HE={class:"mb-3 form-check"},VE={key:0,class:"alert alert-danger"},WE={class:"modal-footer"},FE=["disabled"],UE={key:0,class:"spinner-border spinner-border-sm me-2"},BE={__name:"CreateMinionModal",setup(n){const e=it(),s=we(),o=ae(),i=me(),a=O(null);let l=null;const r=O(null),p=O([]),v=O(null),c=O(new Set),$=O({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=O({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),f=O({name:"",model:"sonnet",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:"",sandbox_enabled:!1,startImmediately:!0}),b={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},E=O(""),_=O(""),d=O(!1),y=g(()=>E.value.trim()?E.value.split(",").map(G=>G.trim()).filter(G=>G.length>0):[]),C=g(()=>f.value.allowed_tools.trim()?f.value.allowed_tools.split(",").map(G=>G.trim()).filter(G=>G.length>0):null),x=g(()=>b[f.value.model]||null),F=g(()=>f.value.initialization_context.length),R=g(()=>F.value>2e3),N=g(()=>F.value>1800&&F.value<=2e3),j=g(()=>v.value?p.value.find(G=>G.template_id===v.value):null),k=g(()=>j.value?.default_role||"e.g., Code Expert, Testing Specialist"),D=g(()=>({"field-autofilled":h.value.role==="autofilled","field-modified":h.value.role==="modified"})),K=g(()=>({"field-autofilled":h.value.initialization_context==="autofilled","field-modified":h.value.initialization_context==="modified"})),q=g(()=>({"field-autofilled":h.value.permission_mode==="autofilled","field-modified":h.value.permission_mode==="modified"})),L=g(()=>({"field-autofilled":h.value.allowed_tools==="autofilled","field-modified":h.value.allowed_tools==="modified"})),M=G=>{const H=h.value[G];return H==="autofilled"?`Auto-filled from template: ${j.value?.name}`:H==="modified"?"Modified from template value":""};async function P(){try{console.log("[CreateMinionModal] Loading templates...");const G=await ie.get("/api/templates");console.log("[CreateMinionModal] Templates data:",G),p.value=G||[],console.log("[CreateMinionModal] Templates set to:",p.value)}catch(G){console.error("[CreateMinionModal] Failed to load templates:",G),p.value=[]}}function T(){if(c.value.clear(),!j.value){f.value.role="",f.value.initialization_context="",f.value.permission_mode="default",f.value.allowed_tools="",h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const G=j.value;if(h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},G.default_role?(f.value.role=G.default_role,c.value.add("role"),$.value.role=G.default_role,h.value.role="autofilled"):(f.value.role="",$.value.role=null,h.value.role="normal"),G.default_system_prompt?(f.value.initialization_context=G.default_system_prompt,c.value.add("initialization_context"),$.value.initialization_context=G.default_system_prompt,h.value.initialization_context="autofilled"):(f.value.initialization_context="",$.value.initialization_context=null,h.value.initialization_context="normal"),G.permission_mode?(f.value.permission_mode=G.permission_mode,c.value.add("permission_mode"),$.value.permission_mode=G.permission_mode,h.value.permission_mode="autofilled"):(f.value.permission_mode="default",$.value.permission_mode=null,h.value.permission_mode="normal"),G.allowed_tools&&G.allowed_tools.length>0){const H=G.allowed_tools.join(", ");f.value.allowed_tools=H,c.value.add("allowed_tools"),$.value.allowed_tools=H,h.value.allowed_tools="autofilled"}else f.value.allowed_tools="",$.value.allowed_tools=null,h.value.allowed_tools="normal"}function S(){i.showModal("template-management",{})}function I(){const H=(r.value?s.projects.get(r.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:H,currentPath:f.value.working_directory||"",onSelect:J=>{f.value.working_directory=J}})}function U(){f.value={name:"",model:"sonnet",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:"",sandbox_enabled:!1,startImmediately:!0},E.value="",v.value=null,c.value.clear(),h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},_.value="",d.value=!1}function Y(){U(),i.hideModal()}async function X(){if(!f.value.name.trim()){_.value="Minion name is required";return}if(f.value.name.includes(" ")){_.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(R.value){_.value="Initialization context exceeds 2000 character limit";return}if(!r.value){_.value="Legion ID is missing";return}d.value=!0,_.value="";try{const G={name:f.value.name.trim(),model:f.value.model,role:f.value.role.trim(),initialization_context:f.value.initialization_context.trim(),override_system_prompt:f.value.override_system_prompt,capabilities:y.value,permission_mode:f.value.permission_mode,allowed_tools:C.value,working_directory:f.value.working_directory.trim()||null,sandbox_enabled:f.value.sandbox_enabled},H=await ie.post(`/api/legions/${r.value}/minions`,G);H.success&&H.minion_id?(await s.fetchProjects(),await o.fetchSessions(),f.value.startImmediately&&await o.startSession(H.minion_id),l&&l.hide(),e.push(`/session/${H.minion_id}`)):_.value="Failed to create minion"}catch(G){console.error("Failed to create minion:",G),_.value=G.response?.data?.detail||"Failed to create minion"}finally{d.value=!1}}return le(()=>i.currentModal,(G,H)=>{if(G?.name==="create-minion"&&l){const J=G.data||{};r.value=J.project?.project_id||null,U(),P(),l.show()}else H?.name==="template-management"&&l&&a.value?.classList.contains("show")&&P()}),le(()=>f.value.role,G=>{$.value.role!==null&&(G===$.value.role?h.value.role="autofilled":h.value.role="modified")}),le(()=>f.value.initialization_context,G=>{$.value.initialization_context!==null&&(G===$.value.initialization_context?h.value.initialization_context="autofilled":h.value.initialization_context="modified")}),le(()=>f.value.permission_mode,G=>{$.value.permission_mode!==null&&(G===$.value.permission_mode?h.value.permission_mode="autofilled":h.value.permission_mode="modified")}),le(()=>f.value.allowed_tools,G=>{$.value.allowed_tools!==null&&(G===$.value.allowed_tools?h.value.allowed_tools="autofilled":h.value.allowed_tools="modified")}),pe(()=>{a.value&&be(()=>import("./modal-BK1Vt_in.js").then(G=>G.m),__vite__mapDeps([0,1])).then(G=>{const H=G.default;l=new H(a.value),a.value.addEventListener("hidden.bs.modal",Y)}),P()}),_e(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",Y),l&&l.dispose()}),(G,H)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[t("div",eE,[t("div",tE,[H[37]||(H[37]=t("div",{class:"modal-header"},[t("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",sE,[t("form",{onSubmit:ve(X,["prevent"])},[t("div",nE,[t("label",{for:"template-select",class:"form-label"},[H[12]||(H[12]=se(" Template ",-1)),t("button",{type:"button",onClick:S,class:"btn btn-link btn-sm p-0 ms-2"}," âš™ï¸ Manage Templates ")]),oe(t("select",{id:"template-select","onUpdate:modelValue":H[0]||(H[0]=J=>v.value=J),onChange:T,class:"form-select"},[H[13]||(H[13]=t("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(re,null,ue(p.value,J=>(u(),m("option",{key:J.template_id,value:J.template_id},w(J.name),9,oE))),128))],544),[[Pe,v.value]]),j.value?(u(),m("div",iE,w(j.value.description),1)):A("",!0)]),t("div",aE,[H[14]||(H[14]=t("label",{for:"minion-name",class:"form-label"},[se(" Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"minion-name","onUpdate:modelValue":H[1]||(H[1]=J=>f.value.name=J),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[de,f.value.name]]),H[15]||(H[15]=t("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),t("div",lE,[H[17]||(H[17]=t("label",{for:"model",class:"form-label"},"Model",-1)),oe(t("select",{class:"form-select",id:"model","onUpdate:modelValue":H[2]||(H[2]=J=>f.value.model=J)},[...H[16]||(H[16]=[t("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),t("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),t("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),t("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Pe,f.value.model]]),x.value?(u(),m("small",rE,w(x.value.description),1)):A("",!0)]),t("div",cE,[t("label",uE,[H[18]||(H[18]=se(" Role ",-1)),h.value.role==="autofilled"?(u(),m("span",dE," âš¡ ")):A("",!0),h.value.role==="modified"?(u(),m("span",mE," âœï¸ ")):A("",!0)]),oe(t("input",{id:"minion-role","onUpdate:modelValue":H[3]||(H[3]=J=>f.value.role=J),type:"text",class:Z(["form-control",D.value]),placeholder:k.value,title:M("role")},null,10,pE),[[de,f.value.role]]),H[19]||(H[19]=t("div",{class:"form-text"}," Optional role description for the minion ",-1))]),t("div",fE,[t("label",vE,[H[20]||(H[20]=se(" Initialization Context ",-1)),h.value.initialization_context==="autofilled"?(u(),m("span",_E," âš¡ ")):A("",!0),h.value.initialization_context==="modified"?(u(),m("span",hE," âœï¸ ")):A("",!0)]),oe(t("textarea",{id:"minion-context","onUpdate:modelValue":H[4]||(H[4]=J=>f.value.initialization_context=J),class:Z(["form-control",[K.value,{"is-invalid":R.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:M("initialization_context")},null,10,gE),[[de,f.value.initialization_context]]),t("div",bE,[t("span",null,w(f.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),t("span",{class:Z({"text-danger":R.value,"text-warning":N.value})},w(F.value)+" / 2000 chars ",3)]),R.value?(u(),m("div",yE," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):A("",!0)]),t("div",$E,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":H[5]||(H[5]=J=>f.value.override_system_prompt=J)},null,512),[[_t,f.value.override_system_prompt]]),H[22]||(H[22]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),f.value.override_system_prompt?(u(),m("div",wE,[...H[21]||(H[21]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):A("",!0)]),t("div",EE,[H[23]||(H[23]=t("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),oe(t("input",{id:"minion-capabilities","onUpdate:modelValue":H[6]||(H[6]=J=>E.value=J),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[de,E.value]]),H[24]||(H[24]=t("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),t("div",CE,[H[25]||(H[25]=t("label",{for:"working-directory",class:"form-label"}," Working Directory (Optional) ",-1)),t("div",SE,[oe(t("input",{id:"working-directory","onUpdate:modelValue":H[7]||(H[7]=J=>f.value.working_directory=J),type:"text",class:"form-control",placeholder:"Leave empty to inherit from legion"},null,512),[[de,f.value.working_directory]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:I}," ðŸ“ Browse ")]),H[26]||(H[26]=t("div",{class:"form-text"}," Custom working directory for git worktrees or multi-repo workflows. Relative paths will be converted to absolute. ",-1))]),t("div",kE,[t("label",TE,[H[27]||(H[27]=se(" Permission Mode ",-1)),h.value.permission_mode==="autofilled"?(u(),m("span",xE," âš¡ ")):A("",!0),h.value.permission_mode==="modified"?(u(),m("span",AE," âœï¸ ")):A("",!0)]),oe(t("select",{class:Z(["form-select",q.value]),id:"permission-mode","onUpdate:modelValue":H[8]||(H[8]=J=>f.value.permission_mode=J),title:M("permission_mode")},[...H[28]||(H[28]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,ME),[[Pe,f.value.permission_mode]]),H[29]||(H[29]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",OE,[t("label",NE,[H[30]||(H[30]=se(" Allowed Tools (Optional) ",-1)),h.value.allowed_tools==="autofilled"?(u(),m("span",DE," âš¡ ")):A("",!0),h.value.allowed_tools==="modified"?(u(),m("span",LE," âœï¸ ")):A("",!0)]),oe(t("input",{type:"text",class:Z(["form-control",L.value]),id:"allowed-tools","onUpdate:modelValue":H[9]||(H[9]=J=>f.value.allowed_tools=J),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:M("allowed_tools")},null,10,IE),[[de,f.value.allowed_tools]]),H[31]||(H[31]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",PE,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"sandboxEnabled","onUpdate:modelValue":H[10]||(H[10]=J=>f.value.sandbox_enabled=J)},null,512),[[_t,f.value.sandbox_enabled]]),H[34]||(H[34]=t("label",{class:"form-check-label",for:"sandboxEnabled"}," ðŸ”’ Enable Sandbox Mode ",-1)),f.value.sandbox_enabled?A("",!0):(u(),m("div",jE,[...H[32]||(H[32]=[t("small",null,"Sandbox mode restricts file system and network access for added security.",-1)])])),f.value.sandbox_enabled?(u(),m("div",RE,[...H[33]||(H[33]=[t("small",null,"ðŸ”’ Sandbox enabled: Minion will have OS-level isolation restricting file system and network access.",-1)])])):A("",!0)]),t("div",HE,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":H[11]||(H[11]=J=>f.value.startImmediately=J)},null,512),[[_t,f.value.startImmediately]]),H[35]||(H[35]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),_.value?(u(),m("div",VE,w(_.value),1)):A("",!0)],32)]),t("div",WE,[H[36]||(H[36]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",disabled:!f.value.name.trim()||d.value,onClick:X},[d.value?(u(),m("span",UE)):A("",!0),se(" "+w(d.value?"Creating...":"Create Minion"),1)],8,FE)])])])],512))}},qE=te(BE,[["__scopeId","data-v-de94c977"]]),zE={class:"modal-dialog modal-dialog-centered modal-lg"},KE={class:"modal-content"},GE={class:"modal-body"},YE={key:0,class:"text-center text-muted py-4"},JE={key:1},XE={class:"mb-3"},QE={class:"mb-3"},ZE={class:"font-monospace small"},eC={class:"mb-3"},tC={class:"mb-3"},sC={class:"mb-3"},nC={key:0},oC={class:"d-flex flex-wrap gap-1"},iC={key:1,class:"text-muted small"},aC={class:"mb-3"},lC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},rC={key:1,class:"text-muted small"},cC={class:"mb-3"},uC={key:0,class:"badge bg-info"},dC={key:1,class:"badge bg-secondary"},mC={class:"mb-3"},pC={key:0,class:"font-monospace small"},fC={key:1,class:"text-muted small"},vC={key:0,class:"mb-3"},_C={key:0},hC={class:"list-unstyled mb-0"},gC={key:1,class:"text-muted small"},bC={class:"mb-3"},yC={class:"small"},$C={class:"mb-3"},wC={class:"small"},EC={__name:"MinionViewModal",setup(n){const e=me(),s=O(null),o=O(null);let i=null;function a(v){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[v]||"bg-secondary"}function l(v){if(!v)return"N/A";try{const c=new Date(v);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function r(){s.value=null}function p(){r(),e.hideModal()}return le(()=>e.currentModal,v=>{if(v?.name==="minion-view"&&i){const c=v.data||{};s.value=c.session,i.show()}}),pe(()=>{o.value&&be(async()=>{const{default:v}=await import("./modal-BK1Vt_in.js").then(c=>c.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{i=new v(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),_e(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(v,c)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",zE,[t("div",KE,[c[11]||(c[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",GE,[s.value?(u(),m("div",JE,[t("div",XE,[c[0]||(c[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,w(s.value.name||"Unnamed Minion"),1)]),t("div",QE,[c[1]||(c[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",ZE,w(s.value.session_id),1)]),t("div",eC,[c[2]||(c[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,w(s.value.role||"Not specified"),1)]),t("div",tC,[c[3]||(c[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:Z(["badge",a(s.value.state)])},w(s.value.state),3)])]),t("div",sC,[c[4]||(c[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(u(),m("div",nC,[t("div",oC,[(u(!0),m(re,null,ue(s.value.capabilities,$=>(u(),m("span",{key:$,class:"badge bg-secondary"},w($),1))),128))])])):(u(),m("div",iC,"None"))]),t("div",aC,[c[5]||(c[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(u(),m("div",lC,w(s.value.initialization_context),1)):(u(),m("div",rC,"Not specified"))]),t("div",cC,[c[6]||(c[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(u(),m("span",uC,"Yes")):(u(),m("span",dC,"No"))])]),t("div",mC,[c[7]||(c[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(u(),m("div",pC,w(s.value.parent_overseer_id),1)):(u(),m("div",fC,w(s.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),s.value.is_overseer?(u(),m("div",vC,[c[8]||(c[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(u(),m("div",_C,[t("ul",hC,[(u(!0),m(re,null,ue(s.value.child_minion_ids,$=>(u(),m("li",{key:$,class:"font-monospace small"},w($),1))),128))])])):(u(),m("div",gC,"No children"))])):A("",!0),t("div",bC,[c[9]||(c[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",yC,w(l(s.value.created_at)),1)]),t("div",$C,[c[10]||(c[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",wC,w(l(s.value.updated_at)),1)])])):(u(),m("div",YE," No minion data available "))]),c[12]||(c[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},CC=te(EC,[["__scopeId","data-v-488ca88f"]]),SC={class:"modal-dialog modal-lg"},kC={class:"modal-content"},TC={class:"modal-body"},xC={key:0,class:"template-list"},AC={key:0,class:"alert alert-info"},MC={class:"card-body"},OC={class:"d-flex justify-content-between align-items-start"},NC={class:"flex-grow-1"},DC={class:"card-title mb-1"},LC={class:"card-text text-muted small mb-2"},IC={class:"template-meta"},PC={class:"badge bg-secondary me-2"},jC={class:"text-muted small"},RC={class:"btn-group btn-group-sm ms-3"},HC=["onClick"],VC=["onClick"],WC={key:1,class:"template-form"},FC={class:"mb-3"},UC={class:"mb-3"},BC={class:"mb-3"},qC={class:"mb-3"},zC={class:"mb-3"},KC={class:"mb-3"},GC={class:"mb-3"},YC={key:0,class:"alert alert-danger"},JC={class:"d-flex gap-2"},XC=["disabled"],QC={key:0,class:"spinner-border spinner-border-sm me-2"},ZC={__name:"TemplateManagementModal",setup(n){const e=me(),s=O(null);let o=null;const i=O([]),a=O(null),l=O(""),r=O(""),p=O(!1);async function v(){try{const _=await ie.get("/api/templates");i.value=_||[]}catch(_){console.error("Failed to load templates:",_),i.value=[]}}function c(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},l.value="",r.value=""}function $(_){a.value={..._},l.value=_.allowed_tools?.join(", ")||"",r.value=""}async function h(){if(!a.value.name.trim()){r.value="Template name is required";return}p.value=!0,r.value="";try{const _=l.value.split(",").map(C=>C.trim()).filter(C=>C.length>0),d={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:_.length>0?_:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await ie.post("/api/templates",d):await ie.put(`/api/templates/${a.value.template_id}`,d),await v(),a.value=null,l.value=""}catch(_){console.error("Failed to save template:",_),r.value=_.response?.data?.detail||"Failed to save template"}finally{p.value=!1}}async function f(_){if(confirm(`Delete template "${_.name}"?

This action cannot be undone.`))try{await ie.delete(`/api/templates/${_.template_id}`),await v()}catch(d){console.error("Failed to delete template:",d),alert(`Failed to delete template: ${d.response?.data?.detail||d.message}`)}}function b(){a.value=null,l.value="",r.value=""}function E(){a.value=null,l.value="",r.value="",e.hideModal()}return le(()=>e.currentModal,_=>{_?.name==="template-management"&&o&&(v(),o.show())}),pe(()=>{s.value&&be(()=>import("./modal-BK1Vt_in.js").then(_=>_.m),__vite__mapDeps([0,1])).then(_=>{const d=_.default;o=new d(s.value),s.value.addEventListener("hidden.bs.modal",E)})}),_e(()=>{s.value&&s.value.removeEventListener("hidden.bs.modal",E),o&&o.dispose()}),(_,d)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[t("div",SC,[t("div",kC,[d[15]||(d[15]=t("div",{class:"modal-header"},[t("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",TC,[a.value?A("",!0):(u(),m("div",xC,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[d[6]||(d[6]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:c,class:"btn btn-primary btn-sm"}," âž• Create New ")]),i.value.length===0?(u(),m("div",AC," No templates found. Create your first template! ")):A("",!0),(u(!0),m(re,null,ue(i.value,y=>(u(),m("div",{key:y.template_id,class:"card mb-2"},[t("div",MC,[t("div",OC,[t("div",NC,[t("h6",DC,w(y.name),1),t("p",LC,w(y.description),1),t("div",IC,[t("span",PC,w(y.permission_mode),1),t("span",jC,w(y.allowed_tools?.length||0)+" tools",1)])]),t("div",RC,[t("button",{onClick:C=>$(y),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,HC),t("button",{onClick:C=>f(y),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,VC)])])])]))),128))])),a.value?(u(),m("div",WC,[t("h6",FC,w(a.value.template_id?"Edit Template":"Create Template"),1),t("div",UC,[d[7]||(d[7]=t("label",{for:"template-name",class:"form-label"},[se(" Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"template-name","onUpdate:modelValue":d[0]||(d[0]=y=>a.value.name=y),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[de,a.value.name]])]),t("div",BC,[d[8]||(d[8]=t("label",{for:"template-description",class:"form-label"},"Description",-1)),oe(t("textarea",{id:"template-description","onUpdate:modelValue":d[1]||(d[1]=y=>a.value.description=y),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[de,a.value.description]])]),t("div",qC,[d[10]||(d[10]=t("label",{for:"template-permission-mode",class:"form-label"},[se(" Permission Mode "),t("span",{class:"text-danger"},"*")],-1)),oe(t("select",{id:"template-permission-mode","onUpdate:modelValue":d[2]||(d[2]=y=>a.value.permission_mode=y),class:"form-select",required:""},[...d[9]||(d[9]=[t("option",{value:"default"},"Default",-1),t("option",{value:"acceptEdits"},"Accept Edits",-1),t("option",{value:"plan"},"Plan Mode",-1),t("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Pe,a.value.permission_mode]])]),t("div",zC,[d[11]||(d[11]=t("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),oe(t("input",{id:"template-tools","onUpdate:modelValue":d[3]||(d[3]=y=>l.value=y),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[de,l.value]]),d[12]||(d[12]=t("div",{class:"form-text"},"Comma-separated list of tools",-1))]),t("div",KC,[d[13]||(d[13]=t("label",{for:"template-role",class:"form-label"},"Default Role",-1)),oe(t("input",{id:"template-role","onUpdate:modelValue":d[4]||(d[4]=y=>a.value.default_role=y),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[de,a.value.default_role]])]),t("div",GC,[d[14]||(d[14]=t("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),oe(t("textarea",{id:"template-prompt","onUpdate:modelValue":d[5]||(d[5]=y=>a.value.default_system_prompt=y),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[de,a.value.default_system_prompt]])]),r.value?(u(),m("div",YC,w(r.value),1)):A("",!0),t("div",JC,[t("button",{onClick:h,class:"btn btn-primary",disabled:p.value},[p.value?(u(),m("span",QC)):A("",!0),se(" "+w(p.value?"Saving...":"Save Template"),1)],8,XC),t("button",{onClick:b,class:"btn btn-secondary"},"Cancel")])])):A("",!0)])])])],512))}},eS=te(ZC,[["__scopeId","data-v-81126ff4"]]),tS={class:"container-fluid vh-100 d-flex flex-column p-0"},sS={class:"d-flex flex-grow-1 overflow-hidden position-relative"},nS={class:"flex-grow-1 d-flex flex-column overflow-hidden"},oS={__name:"App",setup(n){const e=me(),s=ze(),o=ae(),i=we(),a=it(),l=g(()=>e.sidebarCollapsed),r=g(()=>e.isMobile);pe(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&await o.selectSession($)}else if(c.startsWith("#/timeline/")){const $=c.replace("#/timeline/","");a.push(`/timeline/${$}`)}window.addEventListener("popstate",p),window.addEventListener("resize",e.handleResize)}),_e(()=>{window.removeEventListener("popstate",p),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function p(){const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&o.selectSession($)}}function v(){e.toggleSidebar()}return(c,$)=>{const h=so("router-view");return u(),m("div",tS,[ce(Ay),t("div",{id:"sidebar-backdrop",class:Z({show:!l.value&&r.value}),onClick:v},null,2),t("div",sS,[ce(i1),t("main",nS,[ce(h)])]),ce(w1),ce(R1),ce(a$),ce(M$),ce(ow),ce(Aw),ce(Zw),ce(qE),ce(CC),ce(eS)])}}},on=vi(oS);on.use(_i());on.use(yy);on.mount("#app");
