const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as p,a as n,o as m,d as Ct,r as I,b as h,t as w,n as vt,e as X,f as ee,u as Zt,w as de,g as vs,F as re,h as ue,i as M,j as ye,k as so,l as he,v as Pe,m as Ve,p as ve,q as me,s as _e,x as pi,y as es,z as Ce,A as mn,B as no,C as Lt,D as fi,E as vi,G as hi,H as hs,I as _s,J as _i,K as gi}from"./vue-vendor-tGvtV_pt.js";import{m as ot,p as is}from"./markdown-vendor-BRsjnVvP.js";import{c as bi}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const yi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},wi={__name:"NoSessionSelected",setup(s){return(e,t)=>(m(),p("div",yi,[...t[0]||(t[0]=[n("h2",{class:"text-muted"},"No Session Selected",-1),n("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},$i="modulepreload",Ei=function(s){return"/"+s},pn={},Ae=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let f=function(v){return Promise.all(v.map(c=>Promise.resolve(c).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),l=r?.nonce||r?.getAttribute("nonce");i=f(t.map(v=>{if(v=Ei(v),v in pn)return;pn[v]=!0;const c=v.endsWith(".css"),$=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${$}`))return;const _=document.createElement("link");if(_.rel=c?"stylesheet":$i,c||(_.as="script"),_.crossOrigin="",_.href=v,l&&_.setAttribute("nonce",l),document.head.appendChild(_),c)return new Promise((b,y)=>{_.addEventListener("load",b),_.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${v}`)))})}))}function a(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return i.then(r=>{for(const l of r||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};class gs extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function ht(s,e={}){try{const t=await fetch(s,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new gs(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof gs?t:(console.error("API request failed:",t),new gs(`Network error: ${t.message}`,0,null))}}async function Si(s,e={}){let t=s;if(e.params){const o=new URLSearchParams;for(const[l,f]of Object.entries(e.params))f!=null&&o.append(l,f);const i=o.toString();i&&(t=`${s}?${i}`);const{params:a,...r}=e;return ht(t,{...r,method:"GET"})}return ht(t,{...e,method:"GET"})}async function Ci(s,e,t={}){return ht(s,{...t,method:"POST",body:JSON.stringify(e)})}async function ki(s,e,t={}){return ht(s,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ti(s,e={}){return ht(s,{...e,method:"DELETE"})}async function xi(s,e,t={}){return ht(s,{...t,method:"PATCH",body:JSON.stringify(e)})}const oe={get:Si,post:Ci,put:ki,delete:Ti,patch:xi},ae=Ct("session",()=>{const s=I(new Map),e=I(null),t=I(new Map),o=I(new Map),i=I(new Set),a=I(!1);let r=null;const l=h(()=>s.value.get(e.value)),f=h(()=>Array.from(s.value.values()).sort((D,F)=>D.order-F.order)),v=D=>h(()=>f.value.filter(F=>F.project_id===D)),c=h({get:()=>t.value.get(e.value)||"",set:D=>{e.value&&t.value.set(e.value,D)}});async function $(){try{const D=await oe.get("/api/sessions");return s.value.clear(),D.sessions.forEach(F=>{s.value.set(F.session_id,F)}),console.log(`Loaded ${s.value.size} sessions`),D.sessions}catch(D){throw console.error("Failed to fetch sessions:",D),D}}async function _(D,F){try{const L=(await oe.post("/api/sessions",{project_id:D,...F})).session_id,U=(await oe.get(`/api/sessions/${L}`)).session;return s.value.set(L,U),s.value=new Map(s.value),console.log(`Created session ${L}`),U}catch(A){throw console.error("Failed to create session:",A),A}}async function b(D){if(e.value===D&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${D}`),r.abort(),r=null);const F=new AbortController;r=F,a.value=!0;try{if(e.value=D,F.signal.aborted){console.log(`Selection of ${D} aborted early`);return}let A=s.value.get(D);if(!A)try{const U=await oe.get(`/api/sessions/${D}`);if(F.signal.aborted){console.log(`Selection of ${D} aborted after fetch`);return}A=U.session,s.value.set(D,A),s.value=new Map(s.value),console.log(`Fetched session ${D} for deeplink`)}catch(U){console.error(`Failed to fetch session ${D}:`,U);return}if(A&&(A.state==="created"||A.state==="terminated"))try{if(await C(D),F.signal.aborted){console.log(`Selection of ${D} aborted after start`);return}console.log(`Auto-started session ${D} (was in ${A.state} state)`);const U=6e4,S=200,E=5e3;let N=0,T=0;for(;N<U;){if(F.signal.aborted){console.log(`Selection of ${D} aborted during state wait`);return}const j=s.value.get(D);if(j&&j.state==="active"){console.log(`Session ${D} is now active after ${N}ms`);break}if(N-T>=E){const z=s.value.get(D)?.state||"unknown";console.log(`Waiting for session ${D} to become active (current: ${z}, ${N/1e3}s elapsed)`),T=N}await new Promise(z=>setTimeout(z,S)),N+=S}const k=s.value.get(D);k&&k.state!=="active"&&console.warn(`Session ${D} did not become active within ${U/1e3}s (state: ${k.state}), continuing anyway`)}catch(U){console.error(`Failed to auto-start session ${D}:`,U)}if(F.signal.aborted){console.log(`Selection of ${D} aborted before message load`);return}if(await(await Ae(()=>Promise.resolve().then(()=>Gi),void 0)).useMessageStore().loadMessages(D),F.signal.aborted){console.log(`Selection of ${D} aborted after message load`);return}await(await Ae(()=>Promise.resolve().then(()=>va),void 0)).useWebSocketStore().connectSession(D),F.signal.aborted||console.log(`Selected session ${D}`)}finally{r===F&&(r=null),a.value=!1}}function y(D,F){const A=s.value.get(D);A?Object.assign(A,F):(s.value.set(D,F),console.log(`Added new session ${D} via WebSocket update`)),s.value=new Map(s.value)}async function g(D){i.value.add(D);try{const A=(await oe.delete(`/api/sessions/${D}`)).deleted_session_ids||[D];for(const L of A)s.value.delete(L),t.value.delete(L),o.value.delete(L);return s.value=new Map(s.value),A.includes(e.value)&&(e.value=null),console.log(`Deleted ${A.length} session(s): ${A.join(", ")}`),A}catch(F){throw console.error("Failed to delete session:",F),F}finally{i.value.delete(D)}}async function u(D,F){try{await oe.patch(`/api/sessions/${D}`,F),y(D,F),console.log(`Updated session ${D}:`,F)}catch(A){throw console.error("Failed to update session:",A),A}}async function d(D,F){try{await oe.post(`/api/sessions/${D}/permission-mode`,{mode:F}),y(D,{current_permission_mode:F});const A=o.value.get(D);A&&(A.permissionMode=F,o.value.set(D,A)),console.log(`Set permission mode for session ${D} to ${F}`)}catch(A){throw console.error("Failed to set permission mode:",A),A}}async function C(D){try{await oe.post(`/api/sessions/${D}/start`),console.log(`Started session ${D}`)}catch(F){throw console.error("Failed to start session:",F),F}}async function x(D){try{await oe.post(`/api/sessions/${D}/pause`),console.log(`Paused session ${D}`)}catch(F){throw console.error("Failed to pause session:",F),F}}async function O(D){try{await oe.post(`/api/sessions/${D}/terminate`),console.log(`Terminated session ${D}`)}catch(F){throw console.error("Failed to terminate session:",F),F}}function P(D){return s.value.get(D)}function H(D,F){o.value.set(D,F),F.permissionMode&&y(D,{current_permission_mode:F.permissionMode})}return{sessions:s,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:l,orderedSessions:f,sessionsInProject:v,currentInput:c,fetchSessions:$,createSession:_,selectSession:b,updateSession:y,deleteSession:g,patchSession:u,setPermissionMode:d,startSession:C,pauseSession:x,terminateSession:O,getSession:P,storeInitData:H}}),fn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ae},Symbol.toStringTag,{value:"Module"})),fe=Ct("ui",()=>{const s=I(window.innerWidth<768),e=I(300),t=I(window.innerWidth),o=h(()=>t.value<768),i=I(!0),a=I(null),r=I(null),l=h(()=>a.value?{name:a.value,data:r.value}:null),f=I(!1),v=I("Loading...");function c(){s.value=!s.value}function $(x){s.value=x}function _(x){e.value=Math.max(200,Math.min(x,window.innerWidth*.3))}function b(x){i.value=x}function y(x,O=null){a.value=null,r.value=null,setTimeout(()=>{a.value=x,r.value=O},0)}function g(){a.value=null,r.value=null}function u(x="Loading..."){f.value=!0,v.value=x}function d(){f.value=!1}function C(){const x=t.value;t.value=window.innerWidth,t.value<768&&x>=768?s.value=!0:t.value>=768&&x<768&&(s.value=!1)}return{sidebarCollapsed:s,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:l,isLoading:f,loadingMessage:v,toggleSidebar:c,setSidebarCollapsed:$,setSidebarWidth:_,setAutoScroll:b,showModal:y,hideModal:g,showLoading:u,hideLoading:d,handleResize:C}}),Le=Ct("project",()=>{const s=I(new Map),e=I(null),t=h(()=>s.value.get(e.value)),o=h(()=>Array.from(s.value.values()).sort((u,d)=>u.order-d.order));async function i(){try{const u=await oe.get("/api/projects");return s.value.clear(),u.projects.forEach(d=>{s.value.set(d.project_id,d)}),console.log(`Loaded ${s.value.size} projects`),u.projects}catch(u){throw console.error("Failed to fetch projects:",u),u}}async function a(u,d){try{const x=(await oe.post("/api/projects",{name:u,working_directory:d})).project;return s.value.set(x.project_id,x),s.value=new Map(s.value),console.log(`Created project ${x.project_id}`),x}catch(C){throw console.error("Failed to create project:",C),C}}async function r(u,d){try{await oe.put(`/api/projects/${u}`,d),l(u,d),console.log(`Updated project ${u}`,d)}catch(C){throw console.error("Failed to update project:",C),C}}function l(u,d){const C=s.value.get(u);C&&(Object.assign(C,d),s.value=new Map(s.value))}async function f(u){try{await oe.delete(`/api/projects/${u}`),s.value.delete(u),s.value=new Map(s.value),e.value===u&&(e.value=null),console.log(`Deleted project ${u}`)}catch(d){throw console.error("Failed to delete project:",d),d}}async function v(u){try{const d=await oe.put(`/api/projects/${u}/toggle-expansion`),C=s.value.get(u);return C&&(C.is_expanded=d.is_expanded,s.value=new Map(s.value)),d.is_expanded}catch(d){throw console.error("Failed to toggle expansion:",d),d}}async function c(u){try{await oe.put("/api/projects/reorder",{project_ids:u}),u.forEach((d,C)=>{const x=s.value.get(d);x&&(x.order=C)}),s.value=new Map(s.value),console.log("Reordered projects",u)}catch(d){throw console.error("Failed to reorder projects:",d),d}}async function $(u,d){try{await oe.put(`/api/projects/${u}/sessions/reorder`,{session_ids:d});const C=s.value.get(u);C&&(C.session_ids=d,s.value=new Map(s.value)),console.log(`Reordered sessions in project ${u}`,d)}catch(C){throw console.error("Failed to reorder sessions:",C),C}}function _(u){return s.value.get(u)}function b(u){e.value=u}function y(){e.value=null}function g(u){if(!u)return"";const d=u.split(/[/\\]/).filter(C=>C);return d.length===0?"/":d.length===1?`/${d[0]}`:d.length===2?`/${d.join("/")}`:`.../${d.slice(-2).join("/")}`}return{projects:s,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:a,updateProject:r,updateProjectLocal:l,deleteProject:f,toggleExpansion:v,reorderProjects:c,reorderSessionsInProject:$,getProject:_,selectProject:b,clearProjectSelection:y,formatPath:g}}),te=(s,e)=>{const t=s.__vccOpts||s;for(const[o,i]of e)t[o]=i;return t},Ai={class:"session-header border-bottom p-3"},Mi={class:"project-name"},Oi=["title"],Di={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(s){const e=s,t=ae(),o=Le(),i=h(()=>t.sessions.get(e.sessionId)),a=h(()=>i.value?.name||e.sessionId),r=h(()=>{for(const f of o.projects.values())if(f.session_ids?.includes(e.sessionId))return f;return null}),l=h(()=>r.value?.name||"Unknown Project");return(f,v)=>(m(),p("div",Ai,[n("div",null,[n("div",Mi,w(l.value),1),n("div",{class:"session-name",title:s.sessionId},w(a.value),9,Oi)])]))}},Ni=te(Di,[["__scopeId","data-v-89e9c269"]]),Li={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ii=["title"],ji={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Pi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(s){const e=s,t=ae(),o=h(()=>t.sessions.get(e.sessionId)),i=h(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=h(()=>{const f=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[f]||"#d3d3d3"}),r=h(()=>{const f=i.value;return f==="starting"||f==="processing"||f==="pending-prompt"}),l=h(()=>{if(!o.value)return"No session selected";const f=i.value,v=f.charAt(0).toUpperCase()+f.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",$=o.value.role?` (${o.value.role})`:"";return`${c}${$}: ${v}`});return(f,v)=>(m(),p("div",Li,[o.value?(m(),p("div",{key:0,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:vt({width:"100%",backgroundColor:a.value}),title:l.value},null,14,Ii)):(m(),p("div",ji))]))}},Ri=te(Pi,[["__scopeId","data-v-63d222fe"]]),Wi={class:"session-status-bar border-top p-2 bg-light"},Hi={class:"d-flex justify-content-between align-items-center gap-2"},Vi={class:"d-flex gap-2"},Fi=["disabled"],Bi={class:"mode-label"},Ui=["disabled"],qi=["disabled"],zi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(s){const e=s,t=ae(),o=fe(),i=h(()=>t.sessions.get(e.sessionId)),a=h(()=>i.value?.current_permission_mode||"default"),r={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},l=h(()=>r[a.value]||"ðŸ”’"),f=h(()=>a.value),v=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(d){console.error("Failed to cycle permission mode:",d)}return}const g=(v.indexOf(a.value)+1)%v.length,u=v[g];try{await t.setPermissionMode(e.sessionId,u)}catch(d){console.error("Failed to cycle permission mode:",d)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},_=()=>{o.showModal("manage-session",{session:i.value})},b=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(y,g)=>(m(),p("div",Wi,[n("div",Hi,[n("div",Vi,[n("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[ee(w(l.value)+" ",1),n("span",Bi,w(f.value),1)],8,Fi),n("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...g[0]||(g[0]=[ee(" â„¹ï¸ ",-1),n("span",{class:"button-label"},"Info",-1)])],8,Ui),n("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!i.value},[...g[1]||(g[1]=[ee(" âš™ï¸ ",-1),n("span",{class:"button-label"},"Manage",-1)])],8,qi)]),n("div",null,[n("button",{class:X(["btn btn-sm",Zt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:b}," â¬‡ï¸ "+w(Zt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Ki=te(zi,[["__scopeId","data-v-fdcd3535"]]),Oe=Ct("message",()=>{const s=I(new Map),e=I(new Map),t=I(new Map),o=I(new Map),i=I(new Map),a=I(new Map),r=I(new Map),l=I(new Map),f=h(()=>{const T=ae();return s.value.get(T.currentSessionId)||[]}),v=h(()=>{const T=ae();return e.value.get(T.currentSessionId)||[]});async function c(T,k=null,j=0){try{const z=k||1e4,Y=await oe.get(`/api/sessions/${T}/messages?limit=${z}&offset=${j}`),J=Y.messages||[],ce=Y.total_count||J.length,le=Y.has_more||!1;if(console.log(`Loaded ${J.length} of ${ce} messages for session ${T}`),s.value.set(T,J),J.length>0){const W=J[J.length-1];W.timestamp&&(r.value.set(T,W.timestamp),console.log(`Tracked last received timestamp for session ${T}: ${W.timestamp}`))}const ie=new Set;J.forEach(W=>{W.type==="assistant"&&W.metadata?.tool_uses&&W.metadata.tool_uses.forEach(V=>{ie.add(V.id)}),W.type==="user"&&W.metadata?.tool_results&&W.metadata.tool_results.forEach(V=>{ie.delete(V.tool_use_id);const G=a.value.get(T);G&&G.delete(V.tool_use_id)}),W.type==="system"&&W.metadata?.subtype==="client_launched"&&(ie.forEach(V=>{F(T,V,"Session was restarted")}),ie.clear()),W.type==="system"&&W.metadata?.subtype==="interrupt"&&(ie.forEach(V=>{F(T,V,"Session was interrupted")}),ie.clear()),W.metadata?.has_tool_uses&&W.metadata.tool_uses&&W.metadata.tool_uses.forEach(V=>{g(T,V)}),W.metadata?.has_tool_results&&W.metadata.tool_results&&W.metadata.tool_results.forEach(V=>{C(T,V)}),(W.type==="permission_request"||W.metadata?.has_permission_requests)&&u(T,W),W.type==="system"&&(W.subtype==="init"||W.metadata?.subtype==="init")&&W.metadata?.init_data&&ae().storeInitData(T,W.metadata.init_data)});const B=ae().sessions.get(T);return B&&!["active","paused","starting"].includes(B.state)&&(ie.forEach(W=>{F(T,W,"Session was terminated")}),ie.clear()),i.value.set(T,ie),s.value=new Map(s.value),le&&console.warn(`Warning: Only loaded ${J.length} of ${ce} messages. Some messages may be missing.`),{messages:J,totalCount:ce,hasMore:le}}catch(z){throw console.error("Failed to load messages:",z),z}}function $(T,k){const j=i.value.get(T)||new Set;k.type==="assistant"&&k.metadata?.tool_uses&&k.metadata.tool_uses.forEach(z=>{j.add(z.id)}),k.type==="user"&&k.metadata?.tool_results&&k.metadata.tool_results.forEach(z=>{j.delete(z.tool_use_id);const Y=a.value.get(T);Y&&Y.delete(z.tool_use_id)}),k.type==="system"&&k.metadata?.subtype==="client_launched"&&(j.forEach(z=>{F(T,z,"Session was restarted")}),j.clear()),k.type==="system"&&k.metadata?.subtype==="interrupt"&&(j.forEach(z=>{F(T,z,"Session was interrupted")}),j.clear()),i.value.set(T,j)}function _(T,k){s.value.has(T)||s.value.set(T,[]);const j=s.value.get(T);if(k.id){const z=j.findIndex(Y=>Y.id===k.id);if(z!==-1){console.log(`Skipping duplicate message ${k.id} (already exists at index ${z})`);return}}j.push(k),k.timestamp&&r.value.set(T,k.timestamp),P(T,k),$(T,k),s.value=new Map(s.value)}function b(T,k){e.value.has(T)||e.value.set(T,[]),e.value.get(T).push(k),e.value=new Map(e.value)}function y(T,k,j){const z=e.value.get(T);if(z){const Y=z.find(J=>J.id===k);Y&&(Object.assign(Y,j),e.value=new Map(e.value))}}function g(T,k){const j=O(k.name,k.input);t.value.set(j,k.id);const z={id:k.id,name:k.name,input:k.input,signature:j,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return b(T,z),console.log(`Created tool call ${z.id} for ${z.name}`),z}function u(T,k){console.log("handlePermissionRequest received:",k);const j=k.metadata?.tool_name||k.tool_name,z=k.metadata?.input_params||k.input_params,Y=k.metadata?.request_id||k.request_id,J=k.metadata?.suggestions||k.suggestions||[];console.log("Extracted data:",{toolName:j,inputParams:z,requestId:Y,suggestions:J});const ce=O(j,z),le=t.value.get(ce);le?(o.value.set(Y,le),y(T,le,{status:"permission_required",permissionRequestId:Y,suggestions:J}),console.log(`Permission required for tool ${le}`,{suggestions:J})):console.warn("No tool use ID found for permission request signature:",ce,{toolName:j,inputParams:z,availableSignatures:Array.from(t.value.keys())})}function d(T,k){const j=o.value.get(k.request_id);if(j){const z={permissionDecision:k.decision,appliedUpdates:k.applied_updates||[]};k.decision==="allow"?z.status="executing":(z.status="completed",z.result={error:!0,message:k.reasoning||"Permission denied"},z.isExpanded=!1),y(T,j,z),console.log(`Permission ${k.decision} for tool ${j}`)}}function C(T,k){const j=k.tool_use_id;y(T,j,{status:k.is_error?"error":"completed",result:{error:k.is_error,content:k.content},isExpanded:!1}),console.log(`Tool ${j} ${k.is_error?"failed":"completed"}`)}function x(T,k){const j=e.value.get(T);if(j){const z=j.find(Y=>Y.id===k);z&&(z.isExpanded=!z.isExpanded,e.value=new Map(e.value))}}function O(T,k){if(!T)return"unknown:{}";if(!k||typeof k!="object")return`${T}:{}`;const j=JSON.stringify(k,Object.keys(k).sort());return`${T}:${j}`}function P(T,k){const j=k.metadata?.display||k.display;if(!j)return;l.value.has(T)||l.value.set(T,new Map);const z=l.value.get(T);if(j.tool_states)for(const[Y,J]of Object.entries(j.tool_states)){z.set(Y,J);const ce=e.value.get(T);if(ce){const le=ce.find(ie=>ie.id===Y);if(le){const ie={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};le.status=ie[J.state]||J.state,le.backendState=J}}}if(j.orphaned_tools&&j.orphaned_tools.length>0){const Y=a.value.get(T)||new Map;for(const J of j.orphaned_tools)Y.has(J)||Y.set(J,{reason:"denied",message:"Session was interrupted"});a.value.set(T,Y)}if(j.linked_permissions)for(const[Y,J]of Object.entries(j.linked_permissions))o.value.set(Y,J);j.tool_states&&Object.keys(j.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${T}:`,{toolStates:Object.keys(j.tool_states||{}).length,orphanedTools:(j.orphaned_tools||[]).length,linkedPermissions:Object.keys(j.linked_permissions||{}).length})}function H(T,k){return l.value.get(T)?.get(k)}function D(T){const k=l.value.get(T);return k&&k.size>0}function F(T,k,j){const z=a.value.get(T)||new Map;z.set(k,{reason:"denied",message:j}),a.value.set(T,z);const Y=e.value.get(T);if(Y){const J=Y.find(ce=>ce.id===k);J&&J.isExpanded&&(J.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${k} as orphaned: ${j}`)}function A(T,k){const j=H(T,k);return j&&j.state==="orphaned"?!0:a.value.get(T)?.has(k)||!1}function L(T,k){const j=H(T,k);return j&&j.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:j}:a.value.get(T)?.get(k)}function K(T,k){const j=i.value.get(T);j&&j.size>0&&(j.forEach(z=>F(T,z,k)),j.clear())}function U(T){s.value.delete(T),e.value.delete(T),s.value=new Map(s.value),e.value=new Map(e.value)}function S(T){return r.value.get(T)}async function E(T){const k=r.value.get(T);if(!k)return console.log(`No sync needed for session ${T} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${T} since ${k}`);const j=await oe.get(`/api/sessions/${T}/messages?limit=1000&offset=0`),z=j.messages||[],Y=j.has_more||!1,J=V=>V?typeof V=="number"?V*1e3:new Date(V).getTime():0,ce=J(k),le=z.filter(V=>V.timestamp?J(V.timestamp)>ce:!1);if(le.length===0)return console.log(`No missed messages for session ${T}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${le.length} missed messages for session ${T}`);const ie=s.value.get(T)||[],pe=new Set(ie.map(V=>V.id).filter(Boolean)),B=le.filter(V=>!V.id||!pe.has(V.id));if(console.log(`After deduplication: ${B.length} unique new messages`),B.length>0){const V=B.sort((ne,ge)=>{const be=J(ne.timestamp),Ee=J(ge.timestamp);return be-Ee}),G=s.value.get(T)||[],Z=G.length>0?J(G[G.length-1].timestamp):0,R=J(V[0].timestamp),se=J(V[V.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:G.length,lastExisting:Z,lastExistingDate:G.length>0?G[G.length-1].timestamp:"none",firstNew:R,firstNewDate:V[0].timestamp,lastNew:se,lastNewDate:V[V.length-1].timestamp,shouldAppend:R>Z}),R>Z){const ne=[...G,...V];s.value.set(T,ne),console.log(`âœ… Appended ${V.length} new messages (no full sort needed)`)}else{const ne=[...G,...V].sort((ge,be)=>{const Ee=J(ge.timestamp),Vt=J(be.timestamp);return Ee-Vt});s.value.set(T,ne),console.log(`âš ï¸ Merged and sorted ${V.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${ie.length} messages unchanged`);B.forEach(V=>{$(T,V),V.metadata?.has_tool_uses&&V.metadata.tool_uses&&V.metadata.tool_uses.forEach(G=>{g(T,G)}),V.metadata?.has_tool_results&&V.metadata.tool_results&&V.metadata.tool_results.forEach(G=>{C(T,G)}),(V.type==="permission_request"||V.metadata?.has_permission_requests)&&u(T,V),V.type==="system"&&(V.subtype==="init"||V.metadata?.subtype==="init")&&V.metadata?.init_data&&ae().storeInitData(T,V.metadata.init_data)});const W=s.value.get(T);if(W&&W.length>0){const V=W[W.length-1];V.timestamp&&r.value.set(T,V.timestamp)}return s.value=new Map(s.value),{syncedCount:B.length,hasMore:Y}}catch(j){return console.error(`Failed to sync messages for session ${T}:`,j),{syncedCount:0,hasMore:!1,error:j.message}}}const N=ae();return de(()=>Array.from(N.sessions.values()).map(k=>({id:k.session_id,state:k.state})),(T,k)=>{k&&T.forEach((j,z)=>{const Y=k[z];if(!Y||Y.id!==j.id)return;const J=["active","paused","starting"].includes(Y.state),ce=!["active","paused","starting"].includes(j.state);J&&ce&&K(j.id,"Session was terminated")})},{deep:!0}),{messagesBySession:s,toolCallsBySession:e,activeToolUses:vs(i),orphanedToolUses:vs(a),currentMessages:f,currentToolCalls:v,loadMessages:c,addMessage:_,addToolCall:b,updateToolCall:y,handleToolUse:g,handlePermissionRequest:u,handlePermissionResponse:d,handleToolResult:C,toggleToolExpansion:x,clearMessages:U,markToolUseOrphaned:F,isToolUseOrphaned:A,getOrphanedInfo:L,clearOrphanedToolUses:K,getLastReceivedTimestamp:S,syncMessages:E,getBackendToolState:H,hasBackendDisplayMetadata:D,backendToolStates:vs(l)}}),Gi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Oe},Symbol.toStringTag,{value:"Module"}));function Yi(s){if(!s)return new Date;if(typeof s=="string"){const e=new Date(s);return isNaN(e.getTime())?new Date:e}return typeof s=="number"?s<1e10?new Date(s*1e3):new Date(s):new Date}function It(s){return Yi(s).toLocaleTimeString()}const Ji={class:"message-row message-row-user"},Xi=["title"],Qi={class:"message-content-column"},Zi=["innerHTML"],ea={key:0,class:"tool-results mt-2"},ta={class:"tool-results-header text-muted small mb-2"},sa={class:"d-flex align-items-start gap-2"},na={class:"flex-grow-1"},oa={class:"text-muted"},ia={key:0,class:"text-danger small"},aa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(s){const e=s;ot.setOptions({breaks:!0,gfm:!0});const t=h(()=>It(e.message.timestamp)),o=h(()=>`user
${t.value}`),i=h(()=>{const f=e.message.content||"";let v=ot.parse(f);return v=v.replace(/\n</g,"<"),v=v.replace(/\n+$/,""),is.sanitize(v)}),a=h(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=h(()=>e.message.metadata?.tool_results||[]);function l(f,v){return f?f.length<=v?f:f.substring(0,v)+"...":""}return(f,v)=>(m(),p("div",Ji,[n("div",{class:"message-speaker",title:o.value},[...v[0]||(v[0]=[n("span",{class:"speaker-label"},"user",-1)])],8,Xi),n("div",Qi,[n("div",{class:"message-text",innerHTML:i.value},null,8,Zi),a.value?(m(),p("div",ea,[n("div",ta," ðŸ”§ Tool Results ("+w(r.value.length)+") ",1),(m(!0),p(re,null,ue(r.value,(c,$)=>(m(),p("div",{key:$,class:X(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[n("div",sa,[n("span",null,w(c.is_error?"âŒ":"âœ…"),1),n("div",na,[n("small",oa,"Tool: "+w(c.tool_use_id),1),c.is_error?(m(),p("div",ia,w(l(c.content,200)),1)):M("",!0)])])],2))),128))])):M("",!0)])]))}},ra=te(aa,[["__scopeId","data-v-7665755b"]]),la={class:"thinking-block"},ca=["aria-label"],ua={class:"text-muted ms-auto"},da={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ma=["innerHTML"],pa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(s){const e=s,t=I(!1),o=h(()=>e.thinking?.length||0),i=h(()=>{const r=e.thinking||"",l=ot.parse(r);return is.sanitize(l)});function a(){t.value=!t.value}return(r,l)=>(m(),p("div",la,[n("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[n("span",{"aria-label":t.value?"Collapse":"Expand"},w(t.value?"â–¾":"â–¸"),9,ca),l[0]||(l[0]=n("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),n("small",ua,w(o.value)+" characters",1)]),t.value?(m(),p("div",da,[n("div",{class:"thinking-text",innerHTML:i.value},null,8,ma)])):M("",!0)]))}},fa=te(pa,[["__scopeId","data-v-fda2352c"]]),Je=Ct("websocket",()=>{const s=I(null),e=I(!1),t=I(0),o=10,i=I(null),a=I(!1),r=I(0),l=5,f=I(null);let v=null;const c=I(0),$=I(null),_=I(new Map),b=I(null),y=I(!1),g=I(0),u=5,d=I(null),C=1e4,x=1e3,O=I(Date.now()),P=I(Date.now()),H=I(Date.now());let D=null,F=null,A=null;const L=h(()=>e.value&&(a.value||!f.value)?"connected":e.value?"partial":"disconnected");function K(B){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${B}`}function U(B){const W={ui:{timer:()=>D,setTimer:V=>{D=V},lastPing:O,connected:e,name:"UI"},session:{timer:()=>F,setTimer:V=>{F=V},lastPing:P,connected:a,name:"Session"},legion:{timer:()=>A,setTimer:V=>{A=V},lastPing:H,connected:y,name:"Legion"}}[B];W.timer()&&clearInterval(W.timer()),W.setTimer(setInterval(()=>{if(!W.connected.value)return;const V=Date.now()-W.lastPing.value;if(V>C){console.warn(`âš ï¸ ${W.name} WebSocket heartbeat timeout (${V}ms since last ping) - forcing close to trigger reconnection`),W.connected.value=!1;const Z={ui:s,session:i,legion:b}[B];Z.value&&Z.value.readyState===WebSocket.OPEN&&Z.value.close()}},x)),console.log(`âœ… Started heartbeat monitor for ${W.name} WebSocket`)}function S(B){const W={ui:{get:()=>D,set:V=>{D=V}},session:{get:()=>F,set:V=>{F=V}},legion:{get:()=>A,set:V=>{A=V}}}[B];W.get()&&(clearInterval(W.get()),W.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${B} WebSocket`))}function E(){if(s.value)return;const B=K("/ws/ui");console.log(`Connecting to UI WebSocket: ${B}`),s.value=new WebSocket(B),s.value.onopen=()=>{e.value=!0,t.value=0,O.value=Date.now(),U("ui"),console.log("UI WebSocket connected")},s.value.onmessage=W=>{const V=JSON.parse(W.data);J(V)},s.value.onclose=()=>{if(S("ui"),e.value=!1,s.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const W=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${W}ms (attempt ${t.value})`),setTimeout(E,W)}},s.value.onerror=W=>{console.error("UI WebSocket error:",W)}}function N(){s.value&&(s.value.close(),s.value=null,e.value=!1)}async function T(B){c.value++;const W=c.value;if(console.log(`[Gen ${W}] Starting connection to session ${B}`),v&&(clearTimeout(v),v=null),await k(),c.value!==W){console.log(`[Gen ${W}] Connection cancelled (current generation: ${c.value})`);return}f.value=B,$.value=W;const V=K(`/ws/session/${B}`);console.log(`[Gen ${W}] Connecting to Session WebSocket: ${V}`),i.value=new WebSocket(V),i.value.onopen=async()=>{if($.value!==W){console.log(`[Gen ${W}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}a.value=!0,r.value=0,P.value=Date.now(),U("session"),console.log(`[Gen ${W}] Session WebSocket connected for ${B}`);const G=_.value.get(B);if(_.value.set(B,!0),G){console.log(`[Gen ${W}] Reconnection detected, syncing missed messages...`);try{const R=await Oe().syncMessages(B);R.syncedCount>0?console.log(`[Gen ${W}] âœ… Synced ${R.syncedCount} missed messages`):R.error?console.warn(`[Gen ${W}] âš ï¸ Message sync failed: ${R.error}`):console.log(`[Gen ${W}] No missed messages to sync`),R.hasMore&&console.warn(`[Gen ${W}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(Z){console.error(`[Gen ${W}] Error during message sync:`,Z)}}else console.log(`[Gen ${W}] Initial connection, no sync needed`)},i.value.onmessage=G=>{if($.value!==W){console.log(`[Gen ${W}] Ignoring message (stale connection, current: ${$.value})`);return}const Z=JSON.parse(G.data);ce(Z,B)},i.value.onclose=()=>{S("session"),a.value=!1,i.value=null,console.log(`[Gen ${W}] Session WebSocket closed for ${B}`);const G=ae();if(G.currentSessionId===B&&$.value===W&&r.value<l){r.value++;const Z=Math.min(2e3*r.value,3e4);console.log(`[Gen ${W}] Reconnecting Session WebSocket in ${Z}ms (attempt ${r.value})`),v=setTimeout(()=>{$.value===W&&G.currentSessionId===B?(v=null,T(B)):console.log(`[Gen ${W}] Skipping reconnect (generation or session changed)`)},Z)}},i.value.onerror=G=>{console.error(`[Gen ${W}] Session WebSocket error:`,G)}}function k(){return new Promise(B=>{if(v&&(clearTimeout(v),v=null,console.log("Cancelled pending session reconnect timer")),i.value){const W=f.value,V=()=>{i.value=null,a.value=!1,f.value=null,$.value=null,r.value=0,W&&_.value.delete(W),B()};if(i.value.readyState===WebSocket.CLOSED)V();else{const G=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),V()},2e3);i.value.addEventListener("close",()=>{clearTimeout(G),V()},{once:!0}),i.value.close()}}else f.value=null,$.value=null,B()})}function j(B){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:B})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function z(B,W,V=!1,G=null){if(i.value&&a.value){const Z={type:"permission_response",request_id:B,decision:W,apply_suggestions:V,timestamp:new Date().toISOString()};G&&(Z.clarification_message=G),i.value.send(JSON.stringify(Z)),console.log(`Sent permission ${W} for request ${B}`,{applySuggestions:V,clarification:G})}}function Y(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function J(B){const W=ae(),V=Le();switch(B.type){case"sessions_list":B.sessions&&Array.isArray(B.sessions)&&B.sessions.forEach(G=>{W.updateSession(G.session_id,G)});break;case"state_change":B.data&&B.data.session_id&&B.data.session&&W.updateSession(B.data.session_id,B.data.session);break;case"project_updated":if(B.data&&B.data.project){const G=B.data.project;V.updateProjectLocal(G.project_id,G),W.fetchSessions()}break;case"project_deleted":B.data&&B.data.project_id&&V.projects.delete(B.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":O.value=Date.now(),s.value?.readyState===WebSocket.OPEN&&s.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",B.type)}}function ce(B,W){const V=ae();if(V.currentSessionId!==W){console.warn(`Ignoring message for session ${W} (current: ${V.currentSessionId})`);return}const G=Oe();switch(B.type){case"message":const Z=B.data;if(!Z||!Z.type){console.warn("Received message event with invalid data:",B);break}if(Z.type==="permission_request"){G.handlePermissionRequest(W,Z);break}if(Z.type==="permission_response"){G.handlePermissionResponse(W,Z);break}Z.metadata?.has_tool_uses&&Z.metadata.tool_uses.forEach(R=>{G.handleToolUse(W,R)}),Z.metadata?.has_tool_results&&Z.metadata.tool_results.forEach(R=>{G.handleToolResult(W,R)}),Z.type==="system"&&(Z.subtype==="init"||Z.metadata?.subtype==="init")&&Z.metadata?.init_data&&V.storeInitData(W,Z.metadata.init_data),G.addMessage(W,Z);break;case"permission_request":G.handlePermissionRequest(W,B);break;case"permission_response":G.handlePermissionResponse(W,B);break;case"tool_result":G.handleToolResult(W,B);break;case"state_change":V.updateSession(W,B.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${W}`);break;case"ping":P.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",B.type)}}function le(B){ie(),d.value=B;const W=K(`/ws/legion/${B}`);console.log(`Connecting to Legion WebSocket: ${W}`),b.value=new WebSocket(W),b.value.onopen=()=>{y.value=!0,g.value=0,H.value=Date.now(),U("legion"),console.log(`Legion WebSocket connected for ${B}`)},b.value.onmessage=V=>{const G=JSON.parse(V.data);pe(G,B)},b.value.onclose=()=>{if(S("legion"),y.value=!1,b.value=null,console.log(`Legion WebSocket closed for ${B}`),d.value===B&&g.value<u){g.value++;const V=Math.min(2e3*g.value,3e4);setTimeout(()=>le(B),V)}},b.value.onerror=V=>{console.error("Legion WebSocket error:",V)}}function ie(){b.value&&(b.value.close(),b.value=null,y.value=!1,d.value=null)}function pe(B,W){Ae(async()=>{const{useLegionStore:V}=await Promise.resolve().then(()=>a_);return{useLegionStore:V}},void 0).then(({useLegionStore:V})=>{const G=V();switch(B.type){case"comm":B.comm&&(G.addComm(W,B.comm),console.log("Legion WebSocket: Received new comm",B.comm));break;case"minion_created":B.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",B.data),Ae(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>fn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"minion_updated":B.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",B.data),Ae(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>fn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${W}`);break;case"ping":H.value=Date.now(),b.value?.readyState===WebSocket.OPEN&&b.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",B.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:a,sessionRetryCount:r,legionConnected:y,legionRetryCount:g,overallStatus:L,connectUI:E,disconnectUI:N,connectSession:T,disconnectSession:k,sendMessage:j,sendPermissionResponse:z,interruptSession:Y,connectLegion:le,disconnectLegion:ie}}),va=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Je},Symbol.toStringTag,{value:"Module"})),ha={class:"base-tool-handler"},_a={class:"tool-section"},ga={class:"tool-parameters"},ba={class:"tool-code"},ya={key:0,class:"tool-section"},wa={class:"tool-section-label"},$a={class:"tool-code"},Ea={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=h(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,l)=>(m(),p("div",ha,[n("div",_a,[l[0]||(l[0]=n("div",{class:"tool-section-label"},"Parameters:",-1)),n("div",ga,[n("pre",ba,w(t.value),1)])]),o.value?(m(),p("div",ya,[n("div",wa,w(i.value?"Error:":"Result:"),1),n("div",{class:X(["tool-result",{"tool-result-error":i.value}])},[n("pre",$a,w(a.value),1)],2)])):M("",!0)]))}},Sa=te(Ea,[["__scopeId","data-v-1e69f57d"]]),Ca={class:"read-tool-handler"},ka={class:"tool-section"},Ta={class:"read-file-info"},xa={class:"file-path"},Aa={key:0,class:"read-range"},Ma={key:0,class:"tool-section"},Oa={key:0,class:"tool-result tool-result-error"},Da={class:"tool-code"},Na={key:1,class:"file-content-preview"},La={class:"content-header"},Ia={class:"line-count-badge"},ja={key:0,class:"preview-note"},Pa={class:"tool-code content-display"},Ra={key:0,class:"more-indicator"},bs=100,Wa={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>{const b=e.toolCall.input?.offset,y=e.toolCall.input?.limit;return b!==void 0||y!==void 0}),i=h(()=>{const b=e.toolCall.input?.offset;return b!==void 0?b+1:1}),a=h(()=>{const b=e.toolCall.input?.offset||0,y=e.toolCall.input?.limit;return y!==void 0?b+y:"âˆž"}),r=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=h(()=>{if(!r.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)}),v=h(()=>l.value||!f.value?[]:f.value.split(`
`)),c=h(()=>v.value.length),$=h(()=>c.value>bs),_=h(()=>l.value?"":v.value.slice(0,bs).join(`
`));return(b,y)=>(m(),p("div",Ca,[n("div",ka,[n("div",Ta,[y[0]||(y[0]=n("span",{class:"file-icon"},"ðŸ“„",-1)),y[1]||(y[1]=n("strong",null,"Reading:",-1)),n("code",xa,w(t.value),1),o.value?(m(),p("span",Aa,"Lines "+w(i.value)+"-"+w(a.value),1)):M("",!0)])]),r.value?(m(),p("div",Ma,[l.value?(m(),p("div",Oa,[n("pre",Da,w(f.value),1)])):(m(),p("div",Na,[n("div",La,[y[2]||(y[2]=n("span",{class:"content-label"},"Content Preview:",-1)),n("span",Ia,w(c.value)+" lines",1),$.value?(m(),p("span",ja,"(showing first "+w(bs)+")")):M("",!0)]),n("pre",Pa,w(_.value),1),$.value?(m(),p("div",Ra,"...")):M("",!0)]))])):M("",!0)]))}},Ha=te(Wa,[["__scopeId","data-v-1f2b0569"]]),Va={class:"write-tool-handler"},Fa={class:"tool-section"},Ba={class:"write-file-info mb-2"},Ua={class:"file-path"},qa={class:"write-content-preview"},za={class:"content-header"},Ka={class:"line-count-badge"},Ga={key:0,class:"preview-note"},Ya={class:"tool-code content-display"},Ja={key:0,class:"more-indicator"},Xa={key:0,class:"tool-section"},Qa={key:0,class:"tool-result tool-result-error"},Za={class:"tool-code"},er={key:1,class:"tool-result tool-result-success"},tr={class:"success-message"},ys=100,sr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.content||""),i=h(()=>o.value.split(`
`)),a=h(()=>i.value.length),r=h(()=>a.value>ys),l=h(()=>i.value.slice(0,ys).join(`
`)),f=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=h(()=>{if(!f.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,_)=>(m(),p("div",Va,[n("div",Fa,[n("div",Ba,[_[0]||(_[0]=n("span",{class:"file-icon"},"ðŸ“",-1)),_[1]||(_[1]=n("strong",null,"Writing:",-1)),n("code",Ua,w(t.value),1)]),n("div",qa,[n("div",za,[_[2]||(_[2]=n("span",{class:"content-label"},"Content:",-1)),n("span",Ka,w(a.value)+" lines",1),r.value?(m(),p("span",Ga,"(showing first "+w(ys)+")")):M("",!0)]),n("pre",Ya,w(l.value),1),r.value?(m(),p("div",Ja,"...")):M("",!0)])]),f.value?(m(),p("div",Xa,[v.value?(m(),p("div",Qa,[_[3]||(_[3]=n("strong",null,"Error:",-1)),n("pre",Za,w(c.value),1)])):(m(),p("div",er,[n("div",tr,[_[4]||(_[4]=n("span",{class:"success-icon"},"âœ…",-1)),n("strong",null,"File created successfully ("+w(a.value)+" lines written)",1)])]))])):M("",!0)]))}},nr=te(sr,[["__scopeId","data-v-ddc24a0f"]]),or={class:"bash-tool-handler"},ir={class:"tool-section"},ar={class:"bash-header"},rr={class:"bash-header-content"},lr={key:0,class:"bash-description"},cr={key:1,class:"bash-flags"},ur={class:"bash-command-section"},dr={class:"bash-command-content"},mr={key:0,class:"tool-section"},pr={key:0,class:"bash-output"},fr={key:1,class:"bash-output-empty"},vr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?.command||""),o=h(()=>e.toolCall.input?.description||""),i=h(()=>e.toolCall.input?.timeout),a=h(()=>e.toolCall.input?.run_in_background||!1),r=h(()=>i.value||a.value),l=h(()=>{const _=[];return i.value&&_.push(`timeout: ${i.value}ms`),a.value&&_.push("background"),_.join(", ")}),f=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=h(()=>v.value?"tool-result-error":"tool-result-success"),$=h(()=>{if(!f.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,b)=>(m(),p("div",or,[n("div",ir,[n("div",ar,[b[1]||(b[1]=n("span",{class:"bash-icon"},"ðŸ’»",-1)),n("div",rr,[o.value?(m(),p("div",lr,[b[0]||(b[0]=n("strong",null,"Description:",-1)),ee(" "+w(o.value),1)])):M("",!0),r.value?(m(),p("div",cr,w(l.value),1)):M("",!0)])]),n("div",ur,[b[2]||(b[2]=n("div",{class:"bash-command-label"},[n("strong",null,"Command:")],-1)),n("div",dr,w(t.value),1)])]),f.value?(m(),p("div",mr,[n("div",{class:X(["tool-result",c.value])},[b[3]||(b[3]=n("strong",null,"Output:",-1)),$.value?(m(),p("pre",pr,w($.value),1)):(m(),p("div",fr,"No output"))],2)])):M("",!0)]))}},hr=te(vr,[["__scopeId","data-v-ab50fe73"]]),_r={class:"todo-tool-handler"},gr={class:"tool-section"},br={class:"todo-header"},yr={class:"todo-summary"},wr={key:0,class:"todo-count todo-count-completed"},$r={key:1,class:"todo-count todo-count-in-progress"},Er={key:2,class:"todo-count todo-count-pending"},Sr={class:"todo-checklist"},Cr={class:"todo-checkbox"},kr={class:"todo-content"},Tr={key:0,class:"tool-section"},xr={key:0,class:"tool-result tool-result-error"},Ar={class:"tool-code"},Mr={key:1,class:"tool-result tool-result-success"},Or={class:"success-message"},Dr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?.todos||[]),o=h(()=>t.value.filter(c=>c.status==="completed").length),i=h(()=>t.value.filter(c=>c.status==="in_progress").length),a=h(()=>t.value.filter(c=>c.status==="pending").length);function r(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const l=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=h(()=>{if(!l.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,$)=>(m(),p("div",_r,[n("div",gr,[n("div",br,[$[0]||($[0]=n("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=n("strong",null,"Task List:",-1)),n("div",yr,[o.value>0?(m(),p("span",wr,w(o.value)+" completed ",1)):M("",!0),i.value>0?(m(),p("span",$r,w(i.value)+" in progress ",1)):M("",!0),a.value>0?(m(),p("span",Er,w(a.value)+" pending ",1)):M("",!0)])]),n("div",Sr,[(m(!0),p(re,null,ue(t.value,(_,b)=>(m(),p("div",{key:b,class:X(["todo-item",`todo-${_.status}`])},[n("span",Cr,w(r(_.status)),1),n("span",kr,w(_.content),1)],2))),128))])]),l.value?(m(),p("div",Tr,[f.value?(m(),p("div",xr,[$[2]||($[2]=n("strong",null,"Error:",-1)),n("pre",Ar,w(v.value),1)])):(m(),p("div",Mr,[n("div",Or,[$[3]||($[3]=n("span",{class:"success-icon"},"âœ…",-1)),n("strong",null,"Task list updated ("+w(t.value.length)+" tasks)",1)])]))])):M("",!0)]))}},Nr=te(Dr,[["__scopeId","data-v-bbe55ee7"]]),Lr={class:"edit-tool-handler"},Ir={class:"tool-section"},jr={class:"edit-file-info"},Pr={class:"file-path"},Rr={key:0,class:"replace-all-badge"},Wr={class:"edit-diff-container"},Hr={class:"diff-header"},Vr={class:"diff-stats"},Fr={class:"stat-removed"},Br={class:"stat-added"},Ur={class:"unified-diff"},qr={class:"diff-scroll-container"},zr={class:"diff-marker"},Kr={class:"diff-content"},Gr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Xr={key:1,class:"tool-result tool-result-success"},Qr={class:"success-message"},Zr={key:0,class:"success-detail"},el={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.old_string||""),i=h(()=>e.toolCall.input?.new_string||""),a=h(()=>e.toolCall.input?.replace_all||!1),r=h(()=>{const b=bi(t.value,o.value,i.value,"","",{context:3}).split(`
`),y=[];for(let g=4;g<b.length;g++){const u=b[g];u&&(u.startsWith("-")?y.push({type:"removed",content:u.substring(1)}):u.startsWith("+")?y.push({type:"added",content:u.substring(1)}):u.startsWith(" ")?y.push({type:"context",content:u.substring(1)}):u.startsWith("@@")&&y.push({type:"hunk",content:u}))}return y}),l=h(()=>r.value.filter(_=>_.type==="removed").length),f=h(()=>r.value.filter(_=>_.type==="added").length),v=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!v.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,b)=>(m(),p("div",Lr,[n("div",Ir,[n("div",jr,[b[0]||(b[0]=n("span",{class:"file-icon"},"âœï¸",-1)),b[1]||(b[1]=n("strong",null,"Editing:",-1)),n("code",Pr,w(t.value),1),a.value?(m(),p("span",Rr,"Replace All")):M("",!0)]),n("div",Wr,[n("div",Hr,[b[2]||(b[2]=n("span",{class:"diff-label"},"Changes:",-1)),n("span",Vr,[n("span",Fr,"-"+w(l.value),1),n("span",Br,"+"+w(f.value),1)])]),n("div",Ur,[n("div",qr,[(m(!0),p(re,null,ue(r.value,(y,g)=>(m(),p("div",{key:g,class:X(["diff-line",{"diff-line-removed":y.type==="removed","diff-line-added":y.type==="added","diff-line-context":y.type==="context","diff-line-hunk":y.type==="hunk"}])},[n("span",zr,w(y.type==="removed"?"-":y.type==="added"?"+":y.type==="hunk"?"@":" "),1),n("span",Kr,w(y.content),1)],2))),128))])])])]),v.value?(m(),p("div",Gr,[c.value?(m(),p("div",Yr,[b[3]||(b[3]=n("strong",null,"Error:",-1)),n("pre",Jr,w($.value),1)])):(m(),p("div",Xr,[n("div",Qr,[b[4]||(b[4]=n("span",{class:"success-icon"},"âœ…",-1)),b[5]||(b[5]=n("strong",null,"File edited successfully",-1)),a.value?(m(),p("span",Zr,"(all occurrences replaced)")):M("",!0)])]))])):M("",!0)]))}},tl=te(el,[["__scopeId","data-v-dd74055e"]]),sl={class:"search-tool-handler"},nl={class:"tool-section"},ol={class:"search-info"},il={class:"search-icon"},al={class:"search-pattern"},rl={key:0,class:"search-path"},ll={key:1,class:"search-filters"},cl={key:0,class:"filter-badge"},ul={key:1,class:"filter-badge"},dl={key:2,class:"filter-badge"},ml={key:0,class:"tool-section"},pl={key:0,class:"tool-result tool-result-error"},fl={class:"tool-code"},vl={key:1,class:"search-results"},hl={class:"results-header"},_l={class:"results-label"},gl={class:"results-count-badge"},bl={class:"results-content"},yl={class:"tool-code"},wl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.name==="Grep"),o=h(()=>e.toolCall.input?.pattern||"Unknown"),i=h(()=>e.toolCall.input?.path||null),a=h(()=>e.toolCall.input?.type||null),r=h(()=>e.toolCall.input?.glob||null),l=h(()=>e.toolCall.input?.["-i"]||!1),f=h(()=>a.value||r.value||l.value),v=h(()=>t.value?"ðŸ”":"ðŸ“"),c=h(()=>t.value?"Searching content":"Finding files"),$=h(()=>t.value?"Matches":"Files found"),_=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),b=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=h(()=>{if(!_.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)}),g=h(()=>!_.value||b.value||!y.value?0:y.value.split(`
`).filter(d=>d.trim()).length);return(u,d)=>(m(),p("div",sl,[n("div",nl,[n("div",ol,[n("span",il,w(v.value),1),n("strong",null,w(c.value)+":",1),n("code",al,w(o.value),1),i.value?(m(),p("span",rl,"in "+w(i.value),1)):M("",!0),f.value?(m(),p("span",ll,[a.value?(m(),p("span",cl,"type: "+w(a.value),1)):M("",!0),r.value?(m(),p("span",ul,"glob: "+w(r.value),1)):M("",!0),l.value?(m(),p("span",dl,"case-insensitive")):M("",!0)])):M("",!0)])]),_.value?(m(),p("div",ml,[b.value?(m(),p("div",pl,[d[0]||(d[0]=n("strong",null,"Error:",-1)),n("pre",fl,w(y.value),1)])):(m(),p("div",vl,[n("div",hl,[n("span",_l,w($.value)+":",1),n("span",gl,w(g.value)+" "+w(g.value===1?"match":"matches"),1)]),n("div",bl,[n("pre",yl,w(y.value),1)])]))])):M("",!0)]))}},vn=te(wl,[["__scopeId","data-v-0d272c39"]]),$l={class:"web-tool-handler"},El={class:"tool-section"},Sl={class:"web-info"},Cl={class:"web-icon"},kl=["href"],Tl={key:1,class:"web-query"},xl={key:0,class:"web-prompt-container"},Al={class:"prompt-content"},Ml={key:1,class:"web-domains"},Ol={class:"domains-label"},Dl={key:0,class:"tool-section"},Nl={key:0,class:"tool-result tool-result-error"},Ll={class:"tool-code"},Il={key:1,class:"web-results"},jl={class:"results-header"},Pl={class:"results-label"},Rl={class:"results-content"},Wl={class:"tool-code"},Hl={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.name==="WebFetch"),o=h(()=>e.toolCall.input?.url||null),i=h(()=>e.toolCall.input?.query||null),a=h(()=>e.toolCall.input?.prompt||null),r=h(()=>e.toolCall.input?.allowed_domains||[]),l=h(()=>e.toolCall.input?.blocked_domains||[]),f=h(()=>r.value.length>0?r.value:l.value.length>0?l.value:[]),v=h(()=>r.value.length>0?"Allowed domains":l.value.length>0?"Blocked domains":"Domains"),c=h(()=>t.value?"ðŸŒ":"ðŸ”Ž"),$=h(()=>t.value?"Fetching URL":"Searching web"),_=h(()=>t.value?"Fetched content":"Search results"),b=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),y=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=h(()=>{if(!b.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,d)=>(m(),p("div",$l,[n("div",El,[n("div",Sl,[n("span",Cl,w(c.value),1),n("strong",null,w($.value)+":",1),o.value?(m(),p("a",{key:0,href:o.value,target:"_blank",class:"web-url"},w(o.value),9,kl)):i.value?(m(),p("code",Tl,w(i.value),1)):M("",!0)]),a.value?(m(),p("div",xl,[d[0]||(d[0]=n("div",{class:"prompt-label"},"Prompt:",-1)),n("div",Al,w(a.value),1)])):M("",!0),f.value.length>0?(m(),p("div",Ml,[n("span",Ol,w(v.value)+":",1),(m(!0),p(re,null,ue(f.value,C=>(m(),p("span",{key:C,class:"domain-badge"},w(C),1))),128))])):M("",!0)]),b.value?(m(),p("div",Dl,[y.value?(m(),p("div",Nl,[d[1]||(d[1]=n("strong",null,"Error:",-1)),n("pre",Ll,w(g.value),1)])):(m(),p("div",Il,[n("div",jl,[n("span",Pl,w(_.value)+":",1)]),n("div",Rl,[n("pre",Wl,w(g.value),1)])]))])):M("",!0)]))}},hn=te(Hl,[["__scopeId","data-v-62b55b55"]]),Vl={class:"task-tool-handler"},Fl={class:"tool-section"},Bl={class:"task-header"},Ul={key:0,class:"agent-type-badge"},ql={key:0,class:"task-description"},zl={class:"description-content"},Kl={key:1,class:"task-prompt-container"},Gl={class:"prompt-header"},Yl={class:"prompt-length"},Jl={class:"prompt-code"},Xl={key:0,class:"tool-section"},Ql={key:0,class:"tool-result tool-result-error"},Zl={class:"tool-code"},ec={key:1,class:"agent-output"},tc={class:"output-header"},sc={key:0,class:"output-count-badge"},nc={class:"output-content"},oc={class:"tool-code"},ic={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?.description||null),o=h(()=>e.toolCall.input?.prompt||null),i=h(()=>e.toolCall.input?.subagent_type||null),a=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=h(()=>{if(!a.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),f=h(()=>l.value?l.value.split(`
`).length:0);return(v,c)=>(m(),p("div",Vl,[n("div",Fl,[n("div",Bl,[c[0]||(c[0]=n("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=n("strong",null,"Agent Task:",-1)),i.value?(m(),p("span",Ul,w(i.value),1)):M("",!0)]),t.value?(m(),p("div",ql,[c[2]||(c[2]=n("div",{class:"description-label"},"Description:",-1)),n("div",zl,w(t.value),1)])):M("",!0),o.value?(m(),p("div",Kl,[n("div",Gl,[c[3]||(c[3]=n("span",{class:"prompt-label"},"Task Prompt:",-1)),n("span",Yl,w(o.value.length)+" characters",1)]),n("pre",Jl,w(o.value),1)])):M("",!0)]),a.value?(m(),p("div",Xl,[r.value?(m(),p("div",Ql,[c[4]||(c[4]=n("strong",null,"Error:",-1)),n("pre",Zl,w(l.value),1)])):(m(),p("div",ec,[n("div",tc,[c[5]||(c[5]=n("span",{class:"output-label"},"Agent Output:",-1)),f.value>0?(m(),p("span",sc,w(f.value)+" lines",1)):M("",!0)]),n("div",nc,[n("pre",oc,w(l.value),1)])]))])):M("",!0)]))}},ac=te(ic,[["__scopeId","data-v-c520c244"]]),rc={class:"notebook-edit-tool-handler"},lc={class:"tool-section"},cc={class:"notebook-info"},uc={class:"file-path"},dc={class:"cell-info mt-2"},mc={class:"info-row"},pc={class:"info-row"},fc={key:0,class:"info-row"},vc={class:"badge bg-info"},hc={key:0,class:"source-preview mt-3"},_c={class:"preview-header"},gc={class:"preview-stats"},bc={class:"source-code"},yc={key:0,class:"tool-section"},wc={key:0},$c={key:1,class:"text-danger"},Ec={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?.notebook_path||"Unknown"),o=h(()=>e.toolCall.input?.cell_id),i=h(()=>e.toolCall.input?.cell_type||"code"),a=h(()=>e.toolCall.input?.edit_mode||"replace"),r=h(()=>e.toolCall.input?.new_source||""),l=h(()=>r.value.split(`
`).length),f=h(()=>i.value==="code"?"bg-primary":"bg-secondary"),v=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=a.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,_)=>(m(),p("div",rc,[n("div",lc,[n("div",cc,[_[0]||(_[0]=n("span",{class:"notebook-icon"},"ðŸ““",-1)),_[1]||(_[1]=n("strong",null,"Notebook:",-1)),n("code",uc,w(t.value),1)]),n("div",dc,[n("div",mc,[_[2]||(_[2]=n("strong",null,"Cell ID:",-1)),n("code",null,w(o.value||"N/A"),1)]),n("div",pc,[_[3]||(_[3]=n("strong",null,"Cell Type:",-1)),n("span",{class:X(["badge",f.value])},w(i.value),3)]),a.value?(m(),p("div",fc,[_[4]||(_[4]=n("strong",null,"Edit Mode:",-1)),n("span",vc,w(a.value),1)])):M("",!0)]),r.value?(m(),p("div",hc,[n("div",_c,[_[5]||(_[5]=n("span",{class:"preview-label"},"New Source:",-1)),n("span",gc,w(l.value)+" lines",1)]),n("pre",bc,[n("code",null,w(r.value),1)])])):M("",!0)]),s.toolCall.result?(m(),p("div",yc,[_[6]||(_[6]=n("div",{class:"result-header mb-2"},[n("strong",null,"Result:")],-1)),n("div",{class:X(["tool-result",v.value])},[s.toolCall.result.success!==!1?(m(),p("div",wc," âœ… "+w(c.value),1)):(m(),p("div",$c," â— "+w(s.toolCall.result.error||"Operation failed"),1))],2)])):M("",!0)]))}},Sc=te(Ec,[["__scopeId","data-v-c81a9bcf"]]),Cc={class:"shell-tool-handler"},kc={class:"tool-section"},Tc={class:"shell-info"},xc={class:"shell-icon"},Ac={key:0,class:"shell-id"},Mc={key:0,class:"filter-info mt-2"},Oc={class:"filter-pattern"},Dc={key:0,class:"tool-section"},Nc={class:"result-header mb-2"},Lc={key:0,class:"mb-2"},Ic={class:"shell-output"},jc={key:1,class:"mb-2"},Pc={class:"shell-output shell-output-error"},Rc={key:0},Wc={key:1,class:"text-danger"},Hc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=h(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=h(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=h(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=h(()=>e.toolCall.input?.filter);function l(b,y){if(!b)return null;const g=new RegExp(`<${y}>([\\s\\S]*?)<\\/${y}>`,"i"),u=b.match(g);return u?u[1].trim():null}const f=h(()=>{const b=e.toolCall.result;if(!b)return null;let y=b;if(b.content&&(y=b.content),typeof y=="string")return{status:l(y,"status"),stdout:l(y,"stdout"),stderr:l(y,"stderr"),exit_code:l(y,"exit_code")};if(Array.isArray(y)){const g=y.find(u=>u.type==="text")?.text||"";return{status:l(g,"status"),stdout:l(g,"stdout"),stderr:l(g,"stderr"),exit_code:l(g,"exit_code")}}return{status:b.status||y.status,stdout:b.stdout||b.output||y.stdout||y.output,stderr:b.stderr||y.stderr,exit_code:b.exit_code||y.exit_code}}),v=h(()=>f.value?.status),c=h(()=>{const b=v.value;return b==="running"?"bg-success":b==="completed"?"bg-secondary":b==="killed"||b==="terminated"?"bg-danger":"bg-info"}),$=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),_=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const b=f.value;if(b?.status==="running"&&!b.stdout&&!b.stderr)return"No new output since last check";if(b?.status==="failed")return`Shell failed (exit code ${b.exit_code||"unknown"})`}return"Operation completed"});return(b,y)=>(m(),p("div",Cc,[n("div",kc,[n("div",Tc,[n("span",xc,w(t.value),1),n("strong",null,w(o.value)+":",1),a.value?(m(),p("code",Ac,"Shell "+w(a.value),1)):M("",!0)]),s.toolCall.name==="BashOutput"&&r.value?(m(),p("div",Mc,[y[0]||(y[0]=n("strong",null,"Filter:",-1)),n("code",Oc,w(r.value),1)])):M("",!0)]),s.toolCall.result?(m(),p("div",Dc,[n("div",Nc,[n("strong",null,w(i.value)+":",1),v.value?(m(),p("span",{key:0,class:X(["badge",c.value])},w(v.value),3)):M("",!0)]),f.value?.stdout?(m(),p("div",Lc,[y[1]||(y[1]=n("div",{class:"output-label"},"Output:",-1)),n("div",Ic,[n("pre",null,[n("code",null,w(f.value.stdout),1)])])])):M("",!0),f.value?.stderr?(m(),p("div",jc,[y[2]||(y[2]=n("div",{class:"output-label text-danger"}," â— Errors: ",-1)),n("div",Pc,[n("pre",null,[n("code",null,w(f.value.stderr),1)])])])):M("",!0),!f.value?.stdout&&!f.value?.stderr?(m(),p("div",{key:2,class:X(["tool-result",$.value])},[s.toolCall.result.success!==!1?(m(),p("div",Rc," âœ… "+w(_.value),1)):(m(),p("div",Wc," â— "+w(s.toolCall.result.error||"Operation failed"),1))],2)):M("",!0)])):M("",!0)]))}},_n=te(Hc,[["__scopeId","data-v-86def281"]]),Vc={class:"skill-tool-handler"},Fc={key:0,class:"tool-section"},Bc={class:"d-flex align-items-center gap-2"},Uc={class:"text-muted small"},qc={key:0,class:"skill-content-body"},zc={class:"skill-content-text"},Kc={key:1,class:"tool-section mt-3"},Gc={class:"tool-result tool-result-error"},Yc={class:"tool-code"},Jc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=Oe(),o=ae(),i=I(!1);function a(){i.value=!i.value}const r=h(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const b=t.messagesBySession.get(_)||[],y=b.findIndex(d=>d.type==="user"&&d.metadata?.has_tool_results&&d.metadata?.tool_results?.some(C=>C.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let g=null,u=null;for(let d=y+1;d<Math.min(y+3,b.length);d++){const C=b[d];if(C.type!=="user")continue;const x=C.content||"";x.includes("<command-message>")&&x.includes("skill is running")?g=C:x.startsWith("Base directory for this skill:")&&(u=C)}return{running:g,content:u}}),l=h(()=>{const _=r.value.content;if(!_)return"";const b=_.content||"",y=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return b.replace(y,"").trim()}),f=h(()=>l.value.length>0),v=h(()=>l.value?l.value.split(`
`).length:0),c=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!c.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,b)=>(m(),p("div",Vc,[f.value?(m(),p("div",Fc,[n("div",{class:"skill-content-header",onClick:a},[n("div",Bc,[n("i",{class:X(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),b[0]||(b[0]=n("strong",null,"Skill Content",-1)),n("span",Uc,"("+w(v.value)+" lines)",1)])]),i.value?(m(),p("div",qc,[n("pre",zc,w(l.value),1)])):M("",!0)])):M("",!0),c.value?(m(),p("div",Kc,[b[1]||(b[1]=n("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),n("div",Gc,[n("pre",Yc,w($.value),1)])])):M("",!0)]))}},Xc=te(Jc,[["__scopeId","data-v-0a48ca0f"]]),Qc={class:"slashcommand-tool-handler"},Zc={key:0,class:"tool-section"},eu={class:"d-flex align-items-center gap-2"},tu=["aria-label"],su={class:"text-muted small"},nu={key:0,class:"command-content-body"},ou={class:"command-content-text"},iu={key:1,class:"tool-section mt-3"},au={class:"tool-result tool-result-error"},ru={class:"tool-code"},lu={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=Oe(),o=ae(),i=I(!1);function a(){i.value=!i.value}const r=h(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const b=t.messagesBySession.get(_)||[],y=b.findIndex(d=>d.type==="user"&&d.metadata?.has_tool_results&&d.metadata?.tool_results?.some(C=>C.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let g=null,u=null;for(let d=y+1;d<Math.min(y+3,b.length);d++){const C=b[d];if(C.type!=="user")continue;const x=C.content||"";x.includes("<command-message>")&&x.includes("<command-name>")&&x.includes("<command-args>")?g=C:x.includes("ARGUMENTS:")&&(u=C)}return{running:g,content:u}}),l=h(()=>{const _=r.value.content;if(!_)return"";const b=_.content||"",y=/\nARGUMENTS:.*$/s;return b.replace(y,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),f=h(()=>l.value.length>0),v=h(()=>l.value?l.value.split(`
`).length:0),c=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!c.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,b)=>(m(),p("div",Qc,[f.value?(m(),p("div",Zc,[n("div",{class:"command-content-header",onClick:a},[n("div",eu,[n("span",{"aria-label":i.value?"Collapse":"Expand"},w(i.value?"â–¾":"â–¸"),9,tu),b[0]||(b[0]=n("strong",null,"Command Content",-1)),n("span",su,"("+w(v.value)+" lines)",1)])]),i.value?(m(),p("div",nu,[n("pre",ou,w(l.value),1)])):M("",!0)])):M("",!0),c.value?(m(),p("div",iu,[b[1]||(b[1]=n("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),n("div",au,[n("pre",ru,w($.value),1)])])):M("",!0)]))}},cu=te(lu,[["__scopeId","data-v-15991acf"]]),uu={class:"exit-plan-mode-tool-handler"},du={class:"tool-section"},mu={key:0,class:"plan-content mt-2"},pu={class:"plan-text"},fu={key:0,class:"tool-section"},vu={key:0},hu={key:1,class:"text-danger"},_u={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>e.toolCall.input?.plan),o=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(m(),p("div",uu,[n("div",du,[a[1]||(a[1]=n("div",{class:"plan-info"},[n("span",{class:"plan-icon"},"ðŸ“‹"),n("strong",null,"Exiting Plan Mode")],-1)),t.value?(m(),p("div",mu,[a[0]||(a[0]=n("div",{class:"plan-header"},[n("strong",null,"Proposed Plan:")],-1)),n("div",pu,w(t.value),1)])):M("",!0)]),s.toolCall.result?(m(),p("div",fu,[a[2]||(a[2]=n("div",{class:"result-header mb-2"},[n("strong",null,"Result:")],-1)),n("div",{class:X(["tool-result",o.value])},[s.toolCall.result.success!==!1?(m(),p("div",vu," âœ… Permission mode reverted to default ")):(m(),p("div",hu," â— "+w(s.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):M("",!0)]))}},gu=te(_u,[["__scopeId","data-v-e2e3c781"]]),bu={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},yu={class:"tool-status-icon"},wu=["title"],$u={class:"d-flex align-items-center gap-2"},Eu={class:"text-muted"},Su=["aria-label"],Cu={key:0,class:"card-body"},ku={key:0,class:"alert alert-warning mb-3"},Tu={class:"d-flex align-items-center"},xu={class:"mb-0 small"},Au={key:1,class:"permission-prompt mt-3"},Mu={class:"alert alert-warning mb-3"},Ou={class:"mb-0"},Du={class:"tool-name"},Nu={key:0,class:"suggestions-section mb-3"},Lu={class:"alert alert-info mb-0"},Iu={class:"suggestion-details p-2 bg-white rounded"},ju={class:"permission-buttons d-flex gap-2 mb-3"},Pu=["disabled"],Ru=["disabled"],Wu=["disabled"],Hu={class:"guidance-section mt-3"},Vu=["disabled"],Fu=["disabled"],Bu={key:2,class:"mt-3"},Uu={class:"alert alert-warning mb-0"},qu={class:"d-flex align-items-center"},zu={class:"mb-0 small"},Ku={key:3,class:"tool-section"},Gu={class:"alert alert-danger mb-0"},Yu={key:0},Ju={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=Oe(),o=ae(),i=Je(),a=I(!1),r=I(null),l=I(""),f=h(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),v=h(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c=h(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),$=h(()=>{if(c.value){const S=c.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[S]||S}return e.toolCall.status}),_={Read:Ha,Write:nr,Bash:hr,TodoWrite:Nr,Edit:tl,Grep:vn,Glob:vn,WebFetch:hn,WebSearch:hn,Task:ac,NotebookEdit:Sc,BashOutput:_n,KillShell:_n,SlashCommand:cu,Skill:Xc,ExitPlanMode:gu},b=h(()=>{const S=e.toolCall.name;return _[S]?_[S]:Sa}),y=h(()=>{const S=[];if(f.value)return S.push("border-warning"),S.join(" ");switch($.value){case"pending":S.push("border-secondary");break;case"permission_required":S.push("border-warning");break;case"executing":S.push("border-primary");break;case"completed":d.value||e.toolCall.permissionDecision==="deny"?S.push("border-danger"):S.push("border-success");break;case"error":S.push("border-danger");break}return S.join(" ")}),g=h(()=>{if(f.value)return"â¹ï¸";switch($.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":d.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),u=h(()=>It(e.toolCall.timestamp)),d=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),C=h(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function x(S){if(!S)return"";const E=S.replace(/\\/g,"/").split("/");return E[E.length-1]}function O(S){if(!S)return"";const E=S.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return E?E[1]:S}function P(S,E=200){return S?S.length<=E?S:S.substring(0,E)+"...":""}function H(S){if(!S)return null;if(S.content){const E=S.content.match(/exit code (\d+)/i);if(E)return parseInt(E[1])}return S.error?1:0}function D(S,E){const N=S?S.split(`
`).length:0;return{added:E?E.split(`
`).length:0,removed:N}}const F=h(()=>{const S=e.toolCall.name,E=e.toolCall.input||{},N=e.toolCall.result,T=$.value;switch(S){case"Bash":case"Shell":case"Command":{const k=O(E.command),j=P(k,200);if(T==="completed"&&N){const z=H(N);return`Bash: ${j} (exit ${z})`}return`Bash: ${j}`}case"SlashCommand":{const k=P(E.command,200);return T==="completed"&&N?`SlashCommand: ${k}`:`SlashCommand: ${k}`}case"Edit":{const k=x(E.file_path);if(T==="completed"&&N&&!N.error){const{added:j,removed:z}=D(E.old_string,E.new_string);return j===z?`Edit: ${k} (${j} lines changed)`:`Edit: ${k} (${j} lines added, ${z} removed)`}return`Edit: ${k}`}case"Read":{const k=x(E.file_path);if(E.offset!==void 0||E.limit!==void 0){const z=(E.offset||0)+1,Y=E.limit?(E.offset||0)+E.limit:"âˆž";return`Read: ${k} (lines ${z}-${Y})`}return`Read: ${k} (full file)`}case"Write":{const k=x(E.file_path);if(T==="completed"&&N&&!N.error&&E.content){const j=E.content.split(`
`).length;return`Write: ${k} (${j} lines written)`}return`Write: ${k}`}case"Skill":{const k=E.skill||"Unknown";return T==="completed"&&N?N.error?`Skill: ${k} (error)`:`Skill: ${k} (completed)`:`Skill: ${k}`}case"Task":{const k=E.subagent_type||"general",j=E.description||"Task";return T==="completed"&&N?N.error?`Task: (${k}) ${j} (error)`:`Task: (${k}) ${j} (completed)`:`Task: (${k}) ${j}`}case"TodoWrite":{if(E.todos&&Array.isArray(E.todos)){const k=E.todos.filter(Y=>Y.status==="completed").length,j=E.todos.length,z=E.todos.find(Y=>Y.status==="in_progress");return z?`Todo: Working on "${z.content}"`:`Todo: ${k}/${j} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const k=E.pattern||"",j=S==="Grep"?"Grep":"Glob";if(T==="completed"&&N&&!N.error){let z=0;return N.content&&(z=N.content.split(`
`).filter(J=>J.trim()).length),`${j}: "${k}" (${z} results)`}return`${j}: "${k}"`}case"WebFetch":case"WebSearch":{const k=E.url||E.query||"";if(S==="WebSearch"){const z=E.query||"",Y=z.length>50?z.substring(0,50)+"...":z;return T==="completed"&&N?N.error?`Web: ${Y} (error)`:`Web: ${Y} (success)`:`Web: ${Y}`}let j="";try{k&&(j=new URL(k.startsWith("http")?k:`https://${k}`).hostname)}catch{j=k.length>50?k.substring(0,50)+"...":k}return T==="completed"&&N?N.error?`Web: ${j} (error)`:`Web: ${j} (success)`:`Web: ${j||k}`}case"NotebookEdit":{const k=x(E.notebook_path),j=E.cell_number!==void 0?E.cell_number:"?",z=E.edit_mode||"replace";return`NotebookEdit: ${k} cell #${j} (${z})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${E.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${E.shell_id||"unknown"}`;default:return`${S}: executed`}}),A=h(()=>{const S=e.toolCall.name,E=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(S)?E.command||S:["Edit","Read","Write","NotebookEdit"].includes(S)&&(E.file_path||E.notebook_path)||S});function L(){const S=o.currentSessionId;S&&t.toggleToolExpansion(S,e.toolCall.id)}function K(S){return S.type==="setMode"?`Set permission mode to "${S.mode}"`:S.type==="allow"?`Allow tool: ${S.tool}`:JSON.stringify(S)}async function U(S,E,N=null){if(!a.value){a.value=!0,S==="allow"?r.value=E?"approve-apply":"approve":N?r.value="deny-guidance":r.value="deny";try{const T=o.currentSessionId;if(T){const k=E&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(T,{request_id:e.toolCall.permissionRequestId,decision:S,reasoning:S==="allow"?"User allowed permission":"User denied permission",applied_updates:k})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,S,E,N)}catch(T){console.error("Failed to send permission response:",T)}finally{a.value=!1,r.value=null}}}return(S,E)=>(m(),p("div",{class:X(["tool-call-card card",y.value])},[n("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:L},[n("div",bu,[n("span",yu,w(g.value),1),n("span",{class:"tool-name",title:A.value},w(F.value),9,wu)]),n("div",$u,[n("small",Eu,w(u.value),1),n("span",{"aria-label":s.toolCall.isExpanded?"Collapse":"Expand"},w(s.toolCall.isExpanded?"â–¾":"â–¸"),9,Su)])]),s.toolCall.isExpanded?(m(),p("div",Cu,[f.value?(m(),p("div",ku,[n("div",Tu,[E[6]||(E[6]=n("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),n("div",null,[E[5]||(E[5]=n("strong",null,"Tool Execution Cancelled",-1)),n("p",xu,w(v.value?.message||"Session was terminated"),1)])])])):M("",!0),(m(),ye(so(b.value),{toolCall:s.toolCall},null,8,["toolCall"])),$.value==="permission_required"&&!f.value?(m(),p("div",Au,[n("div",Mu,[E[9]||(E[9]=n("p",{class:"mb-2"},[n("strong",null,"ðŸ” Permission Required")],-1)),n("p",Ou,[E[7]||(E[7]=ee("Claude wants to use the ",-1)),n("code",Du,w(s.toolCall.name),1),E[8]||(E[8]=ee(" tool.",-1))])]),C.value?(m(),p("div",Nu,[n("div",Lu,[E[10]||(E[10]=n("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),E[11]||(E[11]=n("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),n("div",Iu,[(m(!0),p(re,null,ue(s.toolCall.suggestions,(N,T)=>(m(),p("div",{key:T,class:"suggestion-item"},[n("code",null,w(K(N)),1)]))),128))]),E[12]||(E[12]=n("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):M("",!0),n("div",ju,[C.value?(m(),p("button",{key:0,class:"btn btn-success",onClick:E[0]||(E[0]=N=>U("allow",!0)),disabled:a.value},w(a.value&&r.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Pu)):M("",!0),n("button",{class:X(["btn",C.value?"btn-outline-success":"btn-success"]),onClick:E[1]||(E[1]=N=>U("allow",!1)),disabled:a.value},w(a.value&&r.value==="approve"?"â³ Submitting...":C.value?"âœ… Approve Only":"âœ… Approve"),11,Ru),n("button",{class:"btn btn-danger",onClick:E[2]||(E[2]=N=>U("deny",!1)),disabled:a.value}," ðŸš« "+w(a.value&&r.value==="deny"?"Submitting...":"Deny"),9,Wu)]),n("div",Hu,[E[13]||(E[13]=n("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),E[14]||(E[14]=n("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),he(n("textarea",{"onUpdate:modelValue":E[3]||(E[3]=N=>l.value=N),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Vu),[[Pe,l.value]]),l.value.trim()?(m(),p("button",{key:0,class:"btn btn-warning btn-sm",onClick:E[4]||(E[4]=N=>U("deny",!1,l.value)),disabled:a.value},w(a.value&&r.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Fu)):M("",!0)])])):M("",!0),$.value==="permission_required"&&f.value?(m(),p("div",Bu,[n("div",Uu,[n("div",qu,[E[16]||(E[16]=n("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),n("div",null,[E[15]||(E[15]=n("strong",null,"Permission Request Cancelled",-1)),n("p",zu,w(v.value?.message||"Session was terminated before permission could be granted"),1)])])])])):M("",!0),s.toolCall.permissionDecision==="deny"?(m(),p("div",Ku,[n("div",Gu,[E[17]||(E[17]=ee(" ðŸš« Permission denied ",-1)),s.toolCall.result?.message?(m(),p("span",Yu," - "+w(s.toolCall.result.message),1)):M("",!0)])])):M("",!0)])):M("",!0)],2))}},gn=te(Ju,[["__scopeId","data-v-e339198b"]]),Xu={class:"tool-footer-container"},Qu=["aria-label","onKeydown"],Zu={class:"footer-left"},ed={class:"footer-text"},td={class:"footer-middle"},sd={class:"footer-text"},nd={class:"footer-right"},od={class:"expand-icon"},id={key:0,class:"tool-footer-expanded"},ad={key:1,class:"active-tools-area"},rd={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(s){const e=s,t=Oe(),o=ae(),i=I(!1);function a(b){return b.map((y,g)=>({tool:y,originalIndex:g})).sort((y,g)=>{if(y.tool.timestamp&&g.tool.timestamp){const u=new Date(y.tool.timestamp).getTime(),d=new Date(g.tool.timestamp).getTime();if(u!==d)return u-d}return y.originalIndex-g.originalIndex}).map(({tool:y})=>y)}const r=h(()=>{const b=e.tools.filter(y=>y.status==="executing"||y.status==="permission_required");return a(b)}),l=h(()=>{const b=e.tools.filter(y=>y.status!=="executing"&&y.status!=="permission_required");return a(b)}),f=h(()=>{const b=new Map;e.tools.forEach(C=>{const x=b.get(C.name)||0;b.set(C.name,x+1)});const y=Array.from(b.entries()).sort((C,x)=>x[1]-C[1]),g=y.slice(0,5),u=y.length-g.length,d=g.map(([C,x])=>`${C} (${x})`).join(", ");return u>0?`${d}, +${u} more`:d}),v=h(()=>{const b=e.tools.length;let y=0,g=0,u=0;e.tools.forEach(O=>{const P=o.currentSessionId;(P?t.isToolUseOrphaned(P,O.id):!1)?u++:O.status==="completed"&&!O.result?.error&&O.permissionDecision!=="deny"?y++:(O.status==="error"||O.result?.error||O.permissionDecision==="deny")&&g++});let d=[];y>0&&d.push(`${y} âœ…`),g>0&&d.push(`${g} âŒ`),u>0&&d.push(`${u} â¹ï¸`);const C=b===1?"tool":"tools",x=d.length>0?": "+d.join(" "):"";return`${b} ${C}${x}`}),c=h(()=>i.value?"â–²":"â–¼"),$=h(()=>{const b=o.currentSessionId,y=e.tools.some(C=>C.status==="error"||C.result?.error||C.permissionDecision==="deny"),g=e.tools.some(C=>b?t.isToolUseOrphaned(b,C.id):!1),u=r.value.length>0,d=e.tools.every(C=>!(b?t.isToolUseOrphaned(b,C.id):!1)&&C.status==="completed"&&!C.result?.error&&C.permissionDecision!=="deny");return y?"footer-status-error":g?"footer-status-orphaned":u?"footer-status-in-progress":d?"footer-status-success":""});function _(){i.value=!i.value}return(b,y)=>(m(),p("div",Xu,[n("div",{class:X(["tool-footer-summary",$.value]),onClick:_,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Ve(_,["enter"]),Ve(ve(_,["prevent"]),["space"])]},[n("div",Zu,[n("span",ed,"Used: "+w(f.value),1)]),n("div",td,[y[0]||(y[0]=n("span",{class:"footer-separator"},"|",-1)),n("span",sd,w(v.value),1)]),n("div",nd,[n("span",od,w(c.value),1)])],42,Qu),i.value?(m(),p("div",id,[(m(!0),p(re,null,ue(l.value,g=>(m(),ye(gn,{key:g.id,toolCall:g},null,8,["toolCall"]))),128))])):M("",!0),r.value.length>0?(m(),p("div",ad,[(m(!0),p(re,null,ue(r.value,g=>(m(),ye(gn,{key:g.id,toolCall:g},null,8,["toolCall"]))),128))])):M("",!0)]))}},ld=te(rd,[["__scopeId","data-v-7bae7ae1"]]),cd={class:"message-row message-row-assistant"},ud=["title"],dd={class:"message-content-column"},md={key:0,class:"thinking-block mb-2"},pd=["innerHTML"],fd={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(s){const e=s,t=Oe(),o=ae();ot.setOptions({breaks:!0,gfm:!0});const i=h(()=>It(e.message.timestamp)),a=h(()=>e.message.metadata?.model||null),r=h(()=>{const y=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${y}`}),l=h(()=>{const y=e.message.content||"";return y.trim().length>0&&y!=="Assistant response"}),f=h(()=>{const y=e.message.content||"";let g=ot.parse(y);return g=g.replace(/\n</g,"<"),g=g.replace(/\n+$/,""),is.sanitize(g)}),v=h(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=h(()=>e.message.metadata?.thinking_content||""),$=h(()=>{const y=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,g=e.attachedTools&&e.attachedTools.length>0;return y||g}),_=h(()=>{const y=e.message.metadata?.tool_uses||[],g=e.attachedTools||[],u=[...y],d=new Set(y.map(C=>C.id));for(const C of g)d.has(C.id)||u.push(C);return u}),b=h(()=>{const y=o.currentSessionId;if(!y)return[];const g=t.toolCallsBySession.get(y)||[];return _.value.map(u=>{const d=g.find(C=>C.id===u.id);return d||{id:u.id,name:u.name,input:u.input,status:"pending",result:null,timestamp:u.timestamp||e.message.timestamp,isExpanded:!0}})});return(y,g)=>(m(),p("div",cd,[n("div",{class:"message-speaker",title:r.value},[...g[0]||(g[0]=[n("span",{class:"speaker-label"},"assistant",-1)])],8,ud),n("div",dd,[v.value?(m(),p("div",md,[me(fa,{thinking:c.value},null,8,["thinking"])])):M("",!0),l.value?(m(),p("div",{key:1,class:"message-text",innerHTML:f.value},null,8,pd)):M("",!0),$.value?(m(),ye(ld,{key:2,tools:b.value},null,8,["tools"])):M("",!0)])]))}},vd=te(fd,[["__scopeId","data-v-2e32f6ef"]]),hd={key:0,class:"message-row message-row-compaction"},_d=["title"],gd={class:"message-content-column"},bd={class:"compaction-status-content"},yd={class:"text-muted ms-auto"},wd={key:1,class:"message-row message-row-system"},$d=["title"],Ed={class:"message-content-column"},Sd={class:"system-text"},Cd={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(s){const e=s,t=h(()=>It(e.message.timestamp)),o=h(()=>`system
${t.value}`),i=h(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,r)=>i.value?(m(),p("div",hd,[n("div",{class:"message-speaker",title:o.value},[...r[0]||(r[0]=[n("span",{class:"speaker-label"},"system",-1)])],8,_d),n("div",gd,[n("div",bd,[r[1]||(r[1]=n("span",{class:"me-2"},"ðŸ—œï¸",-1)),r[2]||(r[2]=n("strong",{class:"me-2"},"Context compaction in progress...",-1)),n("small",yd,w(t.value),1)])])])):(m(),p("div",wd,[n("div",{class:"message-speaker",title:o.value},[...r[3]||(r[3]=[n("span",{class:"speaker-label"},"system",-1)])],8,$d),n("div",Ed,[n("span",Sd,w(s.message.content),1)])]))}},bn=te(Cd,[["__scopeId","data-v-a078178f"]]),kd={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(s){const e=s,t=h(()=>{switch(e.message.type){case"user":return ra;case"assistant":return vd;case"system":return bn;default:return bn}});return(o,i)=>(m(),ye(so(t.value),{message:s.message,attachedTools:s.attachedTools},null,8,["message","attachedTools"]))}},Td=te(kd,[["__scopeId","data-v-11dff525"]]);var we="top",ke="bottom",Te="right",$e="left",as="auto",kt=[we,ke,Te,$e],it="start",_t="end",oo="clippingParents",Us="viewport",dt="popper",io="reference",Ps=kt.reduce(function(s,e){return s.concat([e+"-"+it,e+"-"+_t])},[]),qs=[].concat(kt,[as]).reduce(function(s,e){return s.concat([e,e+"-"+it,e+"-"+_t])},[]),ao="beforeRead",ro="read",lo="afterRead",co="beforeMain",uo="main",mo="afterMain",po="beforeWrite",fo="write",vo="afterWrite",ho=[ao,ro,lo,co,uo,mo,po,fo,vo];function He(s){return s?(s.nodeName||"").toLowerCase():null}function xe(s){if(s==null)return window;if(s.toString()!=="[object Window]"){var e=s.ownerDocument;return e&&e.defaultView||window}return s}function at(s){var e=xe(s).Element;return s instanceof e||s instanceof Element}function Me(s){var e=xe(s).HTMLElement;return s instanceof e||s instanceof HTMLElement}function zs(s){if(typeof ShadowRoot>"u")return!1;var e=xe(s).ShadowRoot;return s instanceof e||s instanceof ShadowRoot}function xd(s){var e=s.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Me(a)||!He(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var l=i[r];l===!1?a.removeAttribute(r):a.setAttribute(r,l===!0?"":l)}))})}function Ad(s){var e=s.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),l=r.reduce(function(f,v){return f[v]="",f},{});!Me(i)||!He(i)||(Object.assign(i.style,l),Object.keys(a).forEach(function(f){i.removeAttribute(f)}))})}}const _o={name:"applyStyles",enabled:!0,phase:"write",fn:xd,effect:Ad,requires:["computeStyles"]};function Re(s){return s.split("-")[0]}var nt=Math.max,ts=Math.min,gt=Math.round;function Rs(){var s=navigator.userAgentData;return s!=null&&s.brands&&Array.isArray(s.brands)?s.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function go(){return!/^((?!chrome|android).)*safari/i.test(Rs())}function bt(s,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=s.getBoundingClientRect(),i=1,a=1;e&&Me(s)&&(i=s.offsetWidth>0&&gt(o.width)/s.offsetWidth||1,a=s.offsetHeight>0&&gt(o.height)/s.offsetHeight||1);var r=at(s)?xe(s):window,l=r.visualViewport,f=!go()&&t,v=(o.left+(f&&l?l.offsetLeft:0))/i,c=(o.top+(f&&l?l.offsetTop:0))/a,$=o.width/i,_=o.height/a;return{width:$,height:_,top:c,right:v+$,bottom:c+_,left:v,x:v,y:c}}function Ks(s){var e=bt(s),t=s.offsetWidth,o=s.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:s.offsetLeft,y:s.offsetTop,width:t,height:o}}function bo(s,e){var t=e.getRootNode&&e.getRootNode();if(s.contains(e))return!0;if(t&&zs(t)){var o=e;do{if(o&&s.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ue(s){return xe(s).getComputedStyle(s)}function Md(s){return["table","td","th"].indexOf(He(s))>=0}function Xe(s){return((at(s)?s.ownerDocument:s.document)||window.document).documentElement}function rs(s){return He(s)==="html"?s:s.assignedSlot||s.parentNode||(zs(s)?s.host:null)||Xe(s)}function yn(s){return!Me(s)||Ue(s).position==="fixed"?null:s.offsetParent}function Od(s){var e=/firefox/i.test(Rs()),t=/Trident/i.test(Rs());if(t&&Me(s)){var o=Ue(s);if(o.position==="fixed")return null}var i=rs(s);for(zs(i)&&(i=i.host);Me(i)&&["html","body"].indexOf(He(i))<0;){var a=Ue(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function jt(s){for(var e=xe(s),t=yn(s);t&&Md(t)&&Ue(t).position==="static";)t=yn(t);return t&&(He(t)==="html"||He(t)==="body"&&Ue(t).position==="static")?e:t||Od(s)||e}function Gs(s){return["top","bottom"].indexOf(s)>=0?"x":"y"}function Dt(s,e,t){return nt(s,ts(e,t))}function Dd(s,e,t){var o=Dt(s,e,t);return o>t?t:o}function yo(){return{top:0,right:0,bottom:0,left:0}}function wo(s){return Object.assign({},yo(),s)}function $o(s,e){return e.reduce(function(t,o){return t[o]=s,t},{})}var Nd=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,wo(typeof e!="number"?e:$o(e,kt))};function Ld(s){var e,t=s.state,o=s.name,i=s.options,a=t.elements.arrow,r=t.modifiersData.popperOffsets,l=Re(t.placement),f=Gs(l),v=[$e,Te].indexOf(l)>=0,c=v?"height":"width";if(!(!a||!r)){var $=Nd(i.padding,t),_=Ks(a),b=f==="y"?we:$e,y=f==="y"?ke:Te,g=t.rects.reference[c]+t.rects.reference[f]-r[f]-t.rects.popper[c],u=r[f]-t.rects.reference[f],d=jt(a),C=d?f==="y"?d.clientHeight||0:d.clientWidth||0:0,x=g/2-u/2,O=$[b],P=C-_[c]-$[y],H=C/2-_[c]/2+x,D=Dt(O,H,P),F=f;t.modifiersData[o]=(e={},e[F]=D,e.centerOffset=D-H,e)}}function Id(s){var e=s.state,t=s.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||bo(e.elements.popper,i)&&(e.elements.arrow=i))}const Eo={name:"arrow",enabled:!0,phase:"main",fn:Ld,effect:Id,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function yt(s){return s.split("-")[1]}var jd={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Pd(s,e){var t=s.x,o=s.y,i=e.devicePixelRatio||1;return{x:gt(t*i)/i||0,y:gt(o*i)/i||0}}function wn(s){var e,t=s.popper,o=s.popperRect,i=s.placement,a=s.variation,r=s.offsets,l=s.position,f=s.gpuAcceleration,v=s.adaptive,c=s.roundOffsets,$=s.isFixed,_=r.x,b=_===void 0?0:_,y=r.y,g=y===void 0?0:y,u=typeof c=="function"?c({x:b,y:g}):{x:b,y:g};b=u.x,g=u.y;var d=r.hasOwnProperty("x"),C=r.hasOwnProperty("y"),x=$e,O=we,P=window;if(v){var H=jt(t),D="clientHeight",F="clientWidth";if(H===xe(t)&&(H=Xe(t),Ue(H).position!=="static"&&l==="absolute"&&(D="scrollHeight",F="scrollWidth")),H=H,i===we||(i===$e||i===Te)&&a===_t){O=ke;var A=$&&H===P&&P.visualViewport?P.visualViewport.height:H[D];g-=A-o.height,g*=f?1:-1}if(i===$e||(i===we||i===ke)&&a===_t){x=Te;var L=$&&H===P&&P.visualViewport?P.visualViewport.width:H[F];b-=L-o.width,b*=f?1:-1}}var K=Object.assign({position:l},v&&jd),U=c===!0?Pd({x:b,y:g},xe(t)):{x:b,y:g};if(b=U.x,g=U.y,f){var S;return Object.assign({},K,(S={},S[O]=C?"0":"",S[x]=d?"0":"",S.transform=(P.devicePixelRatio||1)<=1?"translate("+b+"px, "+g+"px)":"translate3d("+b+"px, "+g+"px, 0)",S))}return Object.assign({},K,(e={},e[O]=C?g+"px":"",e[x]=d?b+"px":"",e.transform="",e))}function Rd(s){var e=s.state,t=s.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,r=a===void 0?!0:a,l=t.roundOffsets,f=l===void 0?!0:l,v={placement:Re(e.placement),variation:yt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,wn(Object.assign({},v,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:f})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,wn(Object.assign({},v,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const So={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Rd,data:{}};var Bt={passive:!0};function Wd(s){var e=s.state,t=s.instance,o=s.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,l=r===void 0?!0:r,f=xe(e.elements.popper),v=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&v.forEach(function(c){c.addEventListener("scroll",t.update,Bt)}),l&&f.addEventListener("resize",t.update,Bt),function(){a&&v.forEach(function(c){c.removeEventListener("scroll",t.update,Bt)}),l&&f.removeEventListener("resize",t.update,Bt)}}const Co={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Wd,data:{}};var Hd={left:"right",right:"left",bottom:"top",top:"bottom"};function Jt(s){return s.replace(/left|right|bottom|top/g,function(e){return Hd[e]})}var Vd={start:"end",end:"start"};function $n(s){return s.replace(/start|end/g,function(e){return Vd[e]})}function Ys(s){var e=xe(s),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Js(s){return bt(Xe(s)).left+Ys(s).scrollLeft}function Fd(s,e){var t=xe(s),o=Xe(s),i=t.visualViewport,a=o.clientWidth,r=o.clientHeight,l=0,f=0;if(i){a=i.width,r=i.height;var v=go();(v||!v&&e==="fixed")&&(l=i.offsetLeft,f=i.offsetTop)}return{width:a,height:r,x:l+Js(s),y:f}}function Bd(s){var e,t=Xe(s),o=Ys(s),i=(e=s.ownerDocument)==null?void 0:e.body,a=nt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=nt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-o.scrollLeft+Js(s),f=-o.scrollTop;return Ue(i||t).direction==="rtl"&&(l+=nt(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:l,y:f}}function Xs(s){var e=Ue(s),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function ko(s){return["html","body","#document"].indexOf(He(s))>=0?s.ownerDocument.body:Me(s)&&Xs(s)?s:ko(rs(s))}function Nt(s,e){var t;e===void 0&&(e=[]);var o=ko(s),i=o===((t=s.ownerDocument)==null?void 0:t.body),a=xe(o),r=i?[a].concat(a.visualViewport||[],Xs(o)?o:[]):o,l=e.concat(r);return i?l:l.concat(Nt(rs(r)))}function Ws(s){return Object.assign({},s,{left:s.x,top:s.y,right:s.x+s.width,bottom:s.y+s.height})}function Ud(s,e){var t=bt(s,!1,e==="fixed");return t.top=t.top+s.clientTop,t.left=t.left+s.clientLeft,t.bottom=t.top+s.clientHeight,t.right=t.left+s.clientWidth,t.width=s.clientWidth,t.height=s.clientHeight,t.x=t.left,t.y=t.top,t}function En(s,e,t){return e===Us?Ws(Fd(s,t)):at(e)?Ud(e,t):Ws(Bd(Xe(s)))}function qd(s){var e=Nt(rs(s)),t=["absolute","fixed"].indexOf(Ue(s).position)>=0,o=t&&Me(s)?jt(s):s;return at(o)?e.filter(function(i){return at(i)&&bo(i,o)&&He(i)!=="body"}):[]}function zd(s,e,t,o){var i=e==="clippingParents"?qd(s):[].concat(e),a=[].concat(i,[t]),r=a[0],l=a.reduce(function(f,v){var c=En(s,v,o);return f.top=nt(c.top,f.top),f.right=ts(c.right,f.right),f.bottom=ts(c.bottom,f.bottom),f.left=nt(c.left,f.left),f},En(s,r,o));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function To(s){var e=s.reference,t=s.element,o=s.placement,i=o?Re(o):null,a=o?yt(o):null,r=e.x+e.width/2-t.width/2,l=e.y+e.height/2-t.height/2,f;switch(i){case we:f={x:r,y:e.y-t.height};break;case ke:f={x:r,y:e.y+e.height};break;case Te:f={x:e.x+e.width,y:l};break;case $e:f={x:e.x-t.width,y:l};break;default:f={x:e.x,y:e.y}}var v=i?Gs(i):null;if(v!=null){var c=v==="y"?"height":"width";switch(a){case it:f[v]=f[v]-(e[c]/2-t[c]/2);break;case _t:f[v]=f[v]+(e[c]/2-t[c]/2);break}}return f}function wt(s,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?s.placement:o,a=t.strategy,r=a===void 0?s.strategy:a,l=t.boundary,f=l===void 0?oo:l,v=t.rootBoundary,c=v===void 0?Us:v,$=t.elementContext,_=$===void 0?dt:$,b=t.altBoundary,y=b===void 0?!1:b,g=t.padding,u=g===void 0?0:g,d=wo(typeof u!="number"?u:$o(u,kt)),C=_===dt?io:dt,x=s.rects.popper,O=s.elements[y?C:_],P=zd(at(O)?O:O.contextElement||Xe(s.elements.popper),f,c,r),H=bt(s.elements.reference),D=To({reference:H,element:x,placement:i}),F=Ws(Object.assign({},x,D)),A=_===dt?F:H,L={top:P.top-A.top+d.top,bottom:A.bottom-P.bottom+d.bottom,left:P.left-A.left+d.left,right:A.right-P.right+d.right},K=s.modifiersData.offset;if(_===dt&&K){var U=K[i];Object.keys(L).forEach(function(S){var E=[Te,ke].indexOf(S)>=0?1:-1,N=[we,ke].indexOf(S)>=0?"y":"x";L[S]+=U[N]*E})}return L}function Kd(s,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,r=t.padding,l=t.flipVariations,f=t.allowedAutoPlacements,v=f===void 0?qs:f,c=yt(o),$=c?l?Ps:Ps.filter(function(y){return yt(y)===c}):kt,_=$.filter(function(y){return v.indexOf(y)>=0});_.length===0&&(_=$);var b=_.reduce(function(y,g){return y[g]=wt(s,{placement:g,boundary:i,rootBoundary:a,padding:r})[Re(g)],y},{});return Object.keys(b).sort(function(y,g){return b[y]-b[g]})}function Gd(s){if(Re(s)===as)return[];var e=Jt(s);return[$n(s),e,$n(e)]}function Yd(s){var e=s.state,t=s.options,o=s.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,l=r===void 0?!0:r,f=t.fallbackPlacements,v=t.padding,c=t.boundary,$=t.rootBoundary,_=t.altBoundary,b=t.flipVariations,y=b===void 0?!0:b,g=t.allowedAutoPlacements,u=e.options.placement,d=Re(u),C=d===u,x=f||(C||!y?[Jt(u)]:Gd(u)),O=[u].concat(x).reduce(function(ie,pe){return ie.concat(Re(pe)===as?Kd(e,{placement:pe,boundary:c,rootBoundary:$,padding:v,flipVariations:y,allowedAutoPlacements:g}):pe)},[]),P=e.rects.reference,H=e.rects.popper,D=new Map,F=!0,A=O[0],L=0;L<O.length;L++){var K=O[L],U=Re(K),S=yt(K)===it,E=[we,ke].indexOf(U)>=0,N=E?"width":"height",T=wt(e,{placement:K,boundary:c,rootBoundary:$,altBoundary:_,padding:v}),k=E?S?Te:$e:S?ke:we;P[N]>H[N]&&(k=Jt(k));var j=Jt(k),z=[];if(a&&z.push(T[U]<=0),l&&z.push(T[k]<=0,T[j]<=0),z.every(function(ie){return ie})){A=K,F=!1;break}D.set(K,z)}if(F)for(var Y=y?3:1,J=function(pe){var B=O.find(function(W){var V=D.get(W);if(V)return V.slice(0,pe).every(function(G){return G})});if(B)return A=B,"break"},ce=Y;ce>0;ce--){var le=J(ce);if(le==="break")break}e.placement!==A&&(e.modifiersData[o]._skip=!0,e.placement=A,e.reset=!0)}}const xo={name:"flip",enabled:!0,phase:"main",fn:Yd,requiresIfExists:["offset"],data:{_skip:!1}};function Sn(s,e,t){return t===void 0&&(t={x:0,y:0}),{top:s.top-e.height-t.y,right:s.right-e.width+t.x,bottom:s.bottom-e.height+t.y,left:s.left-e.width-t.x}}function Cn(s){return[we,Te,ke,$e].some(function(e){return s[e]>=0})}function Jd(s){var e=s.state,t=s.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=wt(e,{elementContext:"reference"}),l=wt(e,{altBoundary:!0}),f=Sn(r,o),v=Sn(l,i,a),c=Cn(f),$=Cn(v);e.modifiersData[t]={referenceClippingOffsets:f,popperEscapeOffsets:v,isReferenceHidden:c,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":$})}const Ao={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Jd};function Xd(s,e,t){var o=Re(s),i=[$e,we].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:s})):t,r=a[0],l=a[1];return r=r||0,l=(l||0)*i,[$e,Te].indexOf(o)>=0?{x:l,y:r}:{x:r,y:l}}function Qd(s){var e=s.state,t=s.options,o=s.name,i=t.offset,a=i===void 0?[0,0]:i,r=qs.reduce(function(c,$){return c[$]=Xd($,e.rects,a),c},{}),l=r[e.placement],f=l.x,v=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=f,e.modifiersData.popperOffsets.y+=v),e.modifiersData[o]=r}const Mo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Qd};function Zd(s){var e=s.state,t=s.name;e.modifiersData[t]=To({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Oo={name:"popperOffsets",enabled:!0,phase:"read",fn:Zd,data:{}};function em(s){return s==="x"?"y":"x"}function tm(s){var e=s.state,t=s.options,o=s.name,i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,l=r===void 0?!1:r,f=t.boundary,v=t.rootBoundary,c=t.altBoundary,$=t.padding,_=t.tether,b=_===void 0?!0:_,y=t.tetherOffset,g=y===void 0?0:y,u=wt(e,{boundary:f,rootBoundary:v,padding:$,altBoundary:c}),d=Re(e.placement),C=yt(e.placement),x=!C,O=Gs(d),P=em(O),H=e.modifiersData.popperOffsets,D=e.rects.reference,F=e.rects.popper,A=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,L=typeof A=="number"?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),K=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,U={x:0,y:0};if(H){if(a){var S,E=O==="y"?we:$e,N=O==="y"?ke:Te,T=O==="y"?"height":"width",k=H[O],j=k+u[E],z=k-u[N],Y=b?-F[T]/2:0,J=C===it?D[T]:F[T],ce=C===it?-F[T]:-D[T],le=e.elements.arrow,ie=b&&le?Ks(le):{width:0,height:0},pe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:yo(),B=pe[E],W=pe[N],V=Dt(0,D[T],ie[T]),G=x?D[T]/2-Y-V-B-L.mainAxis:J-V-B-L.mainAxis,Z=x?-D[T]/2+Y+V+W+L.mainAxis:ce+V+W+L.mainAxis,R=e.elements.arrow&&jt(e.elements.arrow),se=R?O==="y"?R.clientTop||0:R.clientLeft||0:0,ne=(S=K?.[O])!=null?S:0,ge=k+G-ne-se,be=k+Z-ne,Ee=Dt(b?ts(j,ge):j,k,b?nt(z,be):z);H[O]=Ee,U[O]=Ee-k}if(l){var Vt,di=O==="x"?we:$e,mi=O==="x"?ke:Te,et=H[P],Ft=P==="y"?"height":"width",an=et+u[di],rn=et-u[mi],fs=[we,$e].indexOf(d)!==-1,ln=(Vt=K?.[P])!=null?Vt:0,cn=fs?an:et-D[Ft]-F[Ft]-ln+L.altAxis,un=fs?et+D[Ft]+F[Ft]-ln-L.altAxis:rn,dn=b&&fs?Dd(cn,et,un):Dt(b?cn:an,et,b?un:rn);H[P]=dn,U[P]=dn-et}e.modifiersData[o]=U}}const Do={name:"preventOverflow",enabled:!0,phase:"main",fn:tm,requiresIfExists:["offset"]};function sm(s){return{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}}function nm(s){return s===xe(s)||!Me(s)?Ys(s):sm(s)}function om(s){var e=s.getBoundingClientRect(),t=gt(e.width)/s.offsetWidth||1,o=gt(e.height)/s.offsetHeight||1;return t!==1||o!==1}function im(s,e,t){t===void 0&&(t=!1);var o=Me(e),i=Me(e)&&om(e),a=Xe(e),r=bt(s,i,t),l={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(o||!o&&!t)&&((He(e)!=="body"||Xs(a))&&(l=nm(e)),Me(e)?(f=bt(e,!0),f.x+=e.clientLeft,f.y+=e.clientTop):a&&(f.x=Js(a))),{x:r.left+l.scrollLeft-f.x,y:r.top+l.scrollTop-f.y,width:r.width,height:r.height}}function am(s){var e=new Map,t=new Set,o=[];s.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(l){if(!t.has(l)){var f=e.get(l);f&&i(f)}}),o.push(a)}return s.forEach(function(a){t.has(a.name)||i(a)}),o}function rm(s){var e=am(s);return ho.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function lm(s){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(s())})})),e}}function cm(s){var e=s.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var kn={placement:"bottom",modifiers:[],strategy:"absolute"};function Tn(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function No(s){s===void 0&&(s={});var e=s,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?kn:i;return function(l,f,v){v===void 0&&(v=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},kn,a),modifiersData:{},elements:{reference:l,popper:f},attributes:{},styles:{}},$=[],_=!1,b={state:c,setOptions:function(d){var C=typeof d=="function"?d(c.options):d;g(),c.options=Object.assign({},a,c.options,C),c.scrollParents={reference:at(l)?Nt(l):l.contextElement?Nt(l.contextElement):[],popper:Nt(f)};var x=rm(cm([].concat(o,c.options.modifiers)));return c.orderedModifiers=x.filter(function(O){return O.enabled}),y(),b.update()},forceUpdate:function(){if(!_){var d=c.elements,C=d.reference,x=d.popper;if(Tn(C,x)){c.rects={reference:im(C,jt(x),c.options.strategy==="fixed"),popper:Ks(x)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(L){return c.modifiersData[L.name]=Object.assign({},L.data)});for(var O=0;O<c.orderedModifiers.length;O++){if(c.reset===!0){c.reset=!1,O=-1;continue}var P=c.orderedModifiers[O],H=P.fn,D=P.options,F=D===void 0?{}:D,A=P.name;typeof H=="function"&&(c=H({state:c,options:F,name:A,instance:b})||c)}}}},update:lm(function(){return new Promise(function(u){b.forceUpdate(),u(c)})}),destroy:function(){g(),_=!0}};if(!Tn(l,f))return b;b.setOptions(v).then(function(u){!_&&v.onFirstUpdate&&v.onFirstUpdate(u)});function y(){c.orderedModifiers.forEach(function(u){var d=u.name,C=u.options,x=C===void 0?{}:C,O=u.effect;if(typeof O=="function"){var P=O({state:c,name:d,instance:b,options:x}),H=function(){};$.push(P||H)}})}function g(){$.forEach(function(u){return u()}),$=[]}return b}}var um=[Co,Oo,So,_o,Mo,xo,Do,Eo,Ao],Qs=No({defaultModifiers:um});const Lo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:mo,afterRead:lo,afterWrite:vo,applyStyles:_o,arrow:Eo,auto:as,basePlacements:kt,beforeMain:co,beforeRead:ao,beforeWrite:po,bottom:ke,clippingParents:oo,computeStyles:So,createPopper:Qs,detectOverflow:wt,end:_t,eventListeners:Co,flip:xo,hide:Ao,left:$e,main:uo,modifierPhases:ho,offset:Mo,placements:qs,popper:dt,popperGenerator:No,popperOffsets:Oo,preventOverflow:Do,read:ro,reference:io,right:Te,start:it,top:we,variationPlacements:Ps,viewport:Us,write:fo},Symbol.toStringTag,{value:"Module"}));const ze=new Map,ws={set(s,e,t){ze.has(s)||ze.set(s,new Map);const o=ze.get(s);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(s,e){return ze.has(s)&&ze.get(s).get(e)||null},remove(s,e){if(!ze.has(s))return;const t=ze.get(s);t.delete(e),t.size===0&&ze.delete(s)}},dm=1e6,mm=1e3,Hs="transitionend",Io=s=>(s&&window.CSS&&window.CSS.escape&&(s=s.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),s),pm=s=>s==null?`${s}`:Object.prototype.toString.call(s).match(/\s([a-z]+)/i)[1].toLowerCase(),fm=s=>{do s+=Math.floor(Math.random()*dm);while(document.getElementById(s));return s},vm=s=>{if(!s)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(s);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*mm)},jo=s=>{s.dispatchEvent(new Event(Hs))},Fe=s=>!s||typeof s!="object"?!1:(typeof s.jquery<"u"&&(s=s[0]),typeof s.nodeType<"u"),Ke=s=>Fe(s)?s.jquery?s[0]:s:typeof s=="string"&&s.length>0?document.querySelector(Io(s)):null,Tt=s=>{if(!Fe(s)||s.getClientRects().length===0)return!1;const e=getComputedStyle(s).getPropertyValue("visibility")==="visible",t=s.closest("details:not([open])");if(!t)return e;if(t!==s){const o=s.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Ge=s=>!s||s.nodeType!==Node.ELEMENT_NODE||s.classList.contains("disabled")?!0:typeof s.disabled<"u"?s.disabled:s.hasAttribute("disabled")&&s.getAttribute("disabled")!=="false",Po=s=>{if(!document.documentElement.attachShadow)return null;if(typeof s.getRootNode=="function"){const e=s.getRootNode();return e instanceof ShadowRoot?e:null}return s instanceof ShadowRoot?s:s.parentNode?Po(s.parentNode):null},ss=()=>{},Pt=s=>{s.offsetHeight},Ro=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,$s=[],hm=s=>{document.readyState==="loading"?($s.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of $s)e()}),$s.push(s)):s()},De=()=>document.documentElement.dir==="rtl",Ie=s=>{hm(()=>{const e=Ro();if(e){const t=s.NAME,o=e.fn[t];e.fn[t]=s.jQueryInterface,e.fn[t].Constructor=s,e.fn[t].noConflict=()=>(e.fn[t]=o,s.jQueryInterface)}})},Se=(s,e=[],t=s)=>typeof s=="function"?s.call(...e):t,Wo=(s,e,t=!0)=>{if(!t){Se(s);return}const i=vm(e)+5;let a=!1;const r=({target:l})=>{l===e&&(a=!0,e.removeEventListener(Hs,r),Se(s))};e.addEventListener(Hs,r),setTimeout(()=>{a||jo(e)},i)},Zs=(s,e,t,o)=>{const i=s.length;let a=s.indexOf(e);return a===-1?!t&&o?s[i-1]:s[0]:(a+=t?1:-1,o&&(a=(a+i)%i),s[Math.max(0,Math.min(a,i-1))])},_m=/[^.]*(?=\..*)\.|.*/,gm=/\..*/,bm=/::\d+$/,Es={};let xn=1;const Ho={mouseenter:"mouseover",mouseleave:"mouseout"},ym=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vo(s,e){return e&&`${e}::${xn++}`||s.uidEvent||xn++}function Fo(s){const e=Vo(s);return s.uidEvent=e,Es[e]=Es[e]||{},Es[e]}function wm(s,e){return function t(o){return en(o,{delegateTarget:s}),t.oneOff&&q.off(s,o.type,e),e.apply(s,[o])}}function $m(s,e,t){return function o(i){const a=s.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const l of a)if(l===r)return en(i,{delegateTarget:r}),o.oneOff&&q.off(s,i.type,e,t),t.apply(r,[i])}}function Bo(s,e,t=null){return Object.values(s).find(o=>o.callable===e&&o.delegationSelector===t)}function Uo(s,e,t){const o=typeof e=="string",i=o?t:e||t;let a=qo(s);return ym.has(a)||(a=s),[o,i,a]}function An(s,e,t,o,i){if(typeof e!="string"||!s)return;let[a,r,l]=Uo(e,t,o);e in Ho&&(r=(y=>function(g){if(!g.relatedTarget||g.relatedTarget!==g.delegateTarget&&!g.delegateTarget.contains(g.relatedTarget))return y.call(this,g)})(r));const f=Fo(s),v=f[l]||(f[l]={}),c=Bo(v,r,a?t:null);if(c){c.oneOff=c.oneOff&&i;return}const $=Vo(r,e.replace(_m,"")),_=a?$m(s,t,r):wm(s,r);_.delegationSelector=a?t:null,_.callable=r,_.oneOff=i,_.uidEvent=$,v[$]=_,s.addEventListener(l,_,a)}function Vs(s,e,t,o,i){const a=Bo(e[t],o,i);a&&(s.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function Em(s,e,t,o){const i=e[t]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&Vs(s,e,t,r.callable,r.delegationSelector)}function qo(s){return s=s.replace(gm,""),Ho[s]||s}const q={on(s,e,t,o){An(s,e,t,o,!1)},one(s,e,t,o){An(s,e,t,o,!0)},off(s,e,t,o){if(typeof e!="string"||!s)return;const[i,a,r]=Uo(e,t,o),l=r!==e,f=Fo(s),v=f[r]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(v).length)return;Vs(s,f,r,a,i?t:null);return}if(c)for(const $ of Object.keys(f))Em(s,f,$,e.slice(1));for(const[$,_]of Object.entries(v)){const b=$.replace(bm,"");(!l||e.includes(b))&&Vs(s,f,r,_.callable,_.delegationSelector)}},trigger(s,e,t){if(typeof e!="string"||!s)return null;const o=Ro(),i=qo(e),a=e!==i;let r=null,l=!0,f=!0,v=!1;a&&o&&(r=o.Event(e,t),o(s).trigger(r),l=!r.isPropagationStopped(),f=!r.isImmediatePropagationStopped(),v=r.isDefaultPrevented());const c=en(new Event(e,{bubbles:l,cancelable:!0}),t);return v&&c.preventDefault(),f&&s.dispatchEvent(c),c.defaultPrevented&&r&&r.preventDefault(),c}};function en(s,e={}){for(const[t,o]of Object.entries(e))try{s[t]=o}catch{Object.defineProperty(s,t,{configurable:!0,get(){return o}})}return s}function Mn(s){if(s==="true")return!0;if(s==="false")return!1;if(s===Number(s).toString())return Number(s);if(s===""||s==="null")return null;if(typeof s!="string")return s;try{return JSON.parse(decodeURIComponent(s))}catch{return s}}function Ss(s){return s.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Be={setDataAttribute(s,e,t){s.setAttribute(`data-bs-${Ss(e)}`,t)},removeDataAttribute(s,e){s.removeAttribute(`data-bs-${Ss(e)}`)},getDataAttributes(s){if(!s)return{};const e={},t=Object.keys(s.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Mn(s.dataset[o])}return e},getDataAttribute(s,e){return Mn(s.getAttribute(`data-bs-${Ss(e)}`))}};class Rt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Fe(t)?Be.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Fe(t)?Be.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],r=Fe(a)?"element":pm(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const Sm="5.3.8";class je extends Rt{constructor(e,t){super(),e=Ke(e),e&&(this._element=e,this._config=this._getConfig(t),ws.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ws.remove(this._element,this.constructor.DATA_KEY),q.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Wo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ws.get(Ke(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Sm}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Cs=s=>{let e=s.getAttribute("data-bs-target");if(!e||e==="#"){let t=s.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Io(t)).join(","):null},Q={find(s,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,s))},findOne(s,e=document.documentElement){return Element.prototype.querySelector.call(e,s)},children(s,e){return[].concat(...s.children).filter(t=>t.matches(e))},parents(s,e){const t=[];let o=s.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(s,e){let t=s.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(s,e){let t=s.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(s){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,s).filter(t=>!Ge(t)&&Tt(t))},getSelectorFromElement(s){const e=Cs(s);return e&&Q.findOne(e)?e:null},getElementFromSelector(s){const e=Cs(s);return e?Q.findOne(e):null},getMultipleElementsFromSelector(s){const e=Cs(s);return e?Q.find(e):[]}},ls=(s,e="hide")=>{const t=`click.dismiss${s.EVENT_KEY}`,o=s.NAME;q.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Ge(this))return;const a=Q.getElementFromSelector(this)||this.closest(`.${o}`);s.getOrCreateInstance(a)[e]()})},Cm="alert",km="bs.alert",zo=`.${km}`,Tm=`close${zo}`,xm=`closed${zo}`,Am="fade",Mm="show";class cs extends je{static get NAME(){return Cm}close(){if(q.trigger(this._element,Tm).defaultPrevented)return;this._element.classList.remove(Mm);const t=this._element.classList.contains(Am);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),q.trigger(this._element,xm),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=cs.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ls(cs,"close");Ie(cs);const Om="button",Dm="bs.button",Nm=`.${Dm}`,Lm=".data-api",Im="active",On='[data-bs-toggle="button"]',jm=`click${Nm}${Lm}`;class us extends je{static get NAME(){return Om}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Im))}static jQueryInterface(e){return this.each(function(){const t=us.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}q.on(document,jm,On,s=>{s.preventDefault();const e=s.target.closest(On);us.getOrCreateInstance(e).toggle()});Ie(us);const Pm="swipe",xt=".bs.swipe",Rm=`touchstart${xt}`,Wm=`touchmove${xt}`,Hm=`touchend${xt}`,Vm=`pointerdown${xt}`,Fm=`pointerup${xt}`,Bm="touch",Um="pen",qm="pointer-event",zm=40,Km={endCallback:null,leftCallback:null,rightCallback:null},Gm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class ns extends Rt{constructor(e,t){super(),this._element=e,!(!e||!ns.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Km}static get DefaultType(){return Gm}static get NAME(){return Pm}dispose(){q.off(this._element,xt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Se(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=zm)return;const t=e/this._deltaX;this._deltaX=0,t&&Se(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(q.on(this._element,Vm,e=>this._start(e)),q.on(this._element,Fm,e=>this._end(e)),this._element.classList.add(qm)):(q.on(this._element,Rm,e=>this._start(e)),q.on(this._element,Wm,e=>this._move(e)),q.on(this._element,Hm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Um||e.pointerType===Bm)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Ym="carousel",Jm="bs.carousel",Qe=`.${Jm}`,Ko=".data-api",Xm="ArrowLeft",Qm="ArrowRight",Zm=500,Mt="next",ct="prev",mt="left",Xt="right",ep=`slide${Qe}`,ks=`slid${Qe}`,tp=`keydown${Qe}`,sp=`mouseenter${Qe}`,np=`mouseleave${Qe}`,op=`dragstart${Qe}`,ip=`load${Qe}${Ko}`,ap=`click${Qe}${Ko}`,Go="carousel",Ut="active",rp="slide",lp="carousel-item-end",cp="carousel-item-start",up="carousel-item-next",dp="carousel-item-prev",Yo=".active",Jo=".carousel-item",mp=Yo+Jo,pp=".carousel-item img",fp=".carousel-indicators",vp="[data-bs-slide], [data-bs-slide-to]",hp='[data-bs-ride="carousel"]',_p={[Xm]:Xt,[Qm]:mt},gp={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},bp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Wt extends je{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Q.findOne(fp,this._element),this._addEventListeners(),this._config.ride===Go&&this.cycle()}static get Default(){return gp}static get DefaultType(){return bp}static get NAME(){return Ym}next(){this._slide(Mt)}nextWhenVisible(){!document.hidden&&Tt(this._element)&&this.next()}prev(){this._slide(ct)}pause(){this._isSliding&&jo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){q.one(this._element,ks,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){q.one(this._element,ks,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Mt:ct;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&q.on(this._element,tp,e=>this._keydown(e)),this._config.pause==="hover"&&(q.on(this._element,sp,()=>this.pause()),q.on(this._element,np,()=>this._maybeEnableCycle())),this._config.touch&&ns.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of Q.find(pp,this._element))q.on(o,op,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(mt)),rightCallback:()=>this._slide(this._directionToOrder(Xt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Zm+this._config.interval))}};this._swipeHelper=new ns(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=_p[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=Q.findOne(Yo,this._indicatorsElement);t.classList.remove(Ut),t.removeAttribute("aria-current");const o=Q.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Ut),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===Mt,a=t||Zs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),l=b=>q.trigger(this._element,b,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(l(ep).defaultPrevented||!o||!a)return;const v=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const c=i?cp:lp,$=i?up:dp;a.classList.add($),Pt(a),o.classList.add(c),a.classList.add(c);const _=()=>{a.classList.remove(c,$),a.classList.add(Ut),o.classList.remove(Ut,$,c),this._isSliding=!1,l(ks)};this._queueCallback(_,o,this._isAnimated()),v&&this.cycle()}_isAnimated(){return this._element.classList.contains(rp)}_getActive(){return Q.findOne(mp,this._element)}_getItems(){return Q.find(Jo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return De()?e===mt?ct:Mt:e===mt?Mt:ct}_orderToDirection(e){return De()?e===ct?mt:Xt:e===ct?Xt:mt}static jQueryInterface(e){return this.each(function(){const t=Wt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}q.on(document,ap,vp,function(s){const e=Q.getElementFromSelector(this);if(!e||!e.classList.contains(Go))return;s.preventDefault();const t=Wt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Be.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});q.on(window,ip,()=>{const s=Q.find(hp);for(const e of s)Wt.getOrCreateInstance(e)});Ie(Wt);const yp="collapse",wp="bs.collapse",Ht=`.${wp}`,$p=".data-api",Ep=`show${Ht}`,Sp=`shown${Ht}`,Cp=`hide${Ht}`,kp=`hidden${Ht}`,Tp=`click${Ht}${$p}`,Ts="show",ft="collapse",qt="collapsing",xp="collapsed",Ap=`:scope .${ft} .${ft}`,Mp="collapse-horizontal",Op="width",Dp="height",Np=".collapse.show, .collapse.collapsing",Fs='[data-bs-toggle="collapse"]',Lp={parent:null,toggle:!0},Ip={parent:"(null|element)",toggle:"boolean"};class $t extends je{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=Q.find(Fs);for(const i of o){const a=Q.getSelectorFromElement(i),r=Q.find(a).filter(l=>l===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Lp}static get DefaultType(){return Ip}static get NAME(){return yp}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Np).filter(l=>l!==this._element).map(l=>$t.getOrCreateInstance(l,{toggle:!1}))),e.length&&e[0]._isTransitioning||q.trigger(this._element,Ep).defaultPrevented)return;for(const l of e)l.hide();const o=this._getDimension();this._element.classList.remove(ft),this._element.classList.add(qt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(qt),this._element.classList.add(ft,Ts),this._element.style[o]="",q.trigger(this._element,Sp)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||q.trigger(this._element,Cp).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Pt(this._element),this._element.classList.add(qt),this._element.classList.remove(ft,Ts);for(const i of this._triggerArray){const a=Q.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(qt),this._element.classList.add(ft),q.trigger(this._element,kp)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ts)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ke(e.parent),e}_getDimension(){return this._element.classList.contains(Mp)?Op:Dp}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Fs);for(const t of e){const o=Q.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=Q.find(Ap,this._config.parent);return Q.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(xp,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=$t.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}q.on(document,Tp,Fs,function(s){(s.target.tagName==="A"||s.delegateTarget&&s.delegateTarget.tagName==="A")&&s.preventDefault();for(const e of Q.getMultipleElementsFromSelector(this))$t.getOrCreateInstance(e,{toggle:!1}).toggle()});Ie($t);const Dn="dropdown",jp="bs.dropdown",rt=`.${jp}`,tn=".data-api",Pp="Escape",Nn="Tab",Rp="ArrowUp",Ln="ArrowDown",Wp=2,Hp=`hide${rt}`,Vp=`hidden${rt}`,Fp=`show${rt}`,Bp=`shown${rt}`,Xo=`click${rt}${tn}`,Qo=`keydown${rt}${tn}`,Up=`keyup${rt}${tn}`,pt="show",qp="dropup",zp="dropend",Kp="dropstart",Gp="dropup-center",Yp="dropdown-center",tt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Jp=`${tt}.${pt}`,Qt=".dropdown-menu",Xp=".navbar",Qp=".navbar-nav",Zp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",ef=De()?"top-end":"top-start",tf=De()?"top-start":"top-end",sf=De()?"bottom-end":"bottom-start",nf=De()?"bottom-start":"bottom-end",of=De()?"left-start":"right-start",af=De()?"right-start":"left-start",rf="top",lf="bottom",cf={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},uf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class We extends je{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=Q.next(this._element,Qt)[0]||Q.prev(this._element,Qt)[0]||Q.findOne(Qt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return cf}static get DefaultType(){return uf}static get NAME(){return Dn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ge(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!q.trigger(this._element,Fp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Qp))for(const o of[].concat(...document.body.children))q.on(o,"mouseover",ss);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(pt),this._element.classList.add(pt),q.trigger(this._element,Bp,e)}}hide(){if(Ge(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!q.trigger(this._element,Hp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))q.off(o,"mouseover",ss);this._popper&&this._popper.destroy(),this._menu.classList.remove(pt),this._element.classList.remove(pt),this._element.setAttribute("aria-expanded","false"),Be.removeDataAttribute(this._menu,"popper"),q.trigger(this._element,Vp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Fe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Dn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Lo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Fe(this._config.reference)?e=Ke(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Qs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(pt)}_getPlacement(){const e=this._parent;if(e.classList.contains(zp))return of;if(e.classList.contains(Kp))return af;if(e.classList.contains(Gp))return rf;if(e.classList.contains(Yp))return lf;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(qp)?t?tf:ef:t?nf:sf}_detectNavbar(){return this._element.closest(Xp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Be.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Se(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=Q.find(Zp,this._menu).filter(i=>Tt(i));o.length&&Zs(o,t,e===Ln,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=We.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===Wp||e.type==="keyup"&&e.key!==Nn)return;const t=Q.find(Jp);for(const o of t){const i=We.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Nn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const l={relatedTarget:i._element};e.type==="click"&&(l.clickEvent=e),i._completeHide(l)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===Pp,i=[Rp,Ln].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(tt)?this:Q.prev(this,tt)[0]||Q.next(this,tt)[0]||Q.findOne(tt,e.delegateTarget.parentNode),r=We.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}q.on(document,Qo,tt,We.dataApiKeydownHandler);q.on(document,Qo,Qt,We.dataApiKeydownHandler);q.on(document,Xo,We.clearMenus);q.on(document,Up,We.clearMenus);q.on(document,Xo,tt,function(s){s.preventDefault(),We.getOrCreateInstance(this).toggle()});Ie(We);const Zo="backdrop",df="fade",In="show",jn=`mousedown.bs.${Zo}`,mf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},pf={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ei extends Rt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return mf}static get DefaultType(){return pf}static get NAME(){return Zo}show(e){if(!this._config.isVisible){Se(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Pt(t),t.classList.add(In),this._emulateAnimation(()=>{Se(e)})}hide(e){if(!this._config.isVisible){Se(e);return}this._getElement().classList.remove(In),this._emulateAnimation(()=>{this.dispose(),Se(e)})}dispose(){this._isAppended&&(q.off(this._element,jn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(df),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ke(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),q.on(e,jn,()=>{Se(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Wo(e,this._getElement(),this._config.isAnimated)}}const ff="focustrap",vf="bs.focustrap",os=`.${vf}`,hf=`focusin${os}`,_f=`keydown.tab${os}`,gf="Tab",bf="forward",Pn="backward",yf={autofocus:!0,trapElement:null},wf={autofocus:"boolean",trapElement:"element"};class ti extends Rt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return yf}static get DefaultType(){return wf}static get NAME(){return ff}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),q.off(document,os),q.on(document,hf,e=>this._handleFocusin(e)),q.on(document,_f,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,q.off(document,os))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=Q.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Pn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===gf&&(this._lastTabNavDirection=e.shiftKey?Pn:bf)}}const Rn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Wn=".sticky-top",zt="padding-right",Hn="margin-right";class Bs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,zt,t=>t+e),this._setElementAttributes(Rn,zt,t=>t+e),this._setElementAttributes(Wn,Hn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,zt),this._resetElementAttributes(Rn,zt),this._resetElementAttributes(Wn,Hn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const l=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(l))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Be.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=Be.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}Be.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Fe(e)){t(e);return}for(const o of Q.find(e,this._element))t(o)}}const $f="modal",Ef="bs.modal",Ne=`.${Ef}`,Sf=".data-api",Cf="Escape",kf=`hide${Ne}`,Tf=`hidePrevented${Ne}`,si=`hidden${Ne}`,ni=`show${Ne}`,xf=`shown${Ne}`,Af=`resize${Ne}`,Mf=`click.dismiss${Ne}`,Of=`mousedown.dismiss${Ne}`,Df=`keydown.dismiss${Ne}`,Nf=`click${Ne}${Sf}`,Vn="modal-open",Lf="fade",Fn="show",xs="modal-static",If=".modal.show",jf=".modal-dialog",Pf=".modal-body",Rf='[data-bs-toggle="modal"]',Wf={backdrop:!0,focus:!0,keyboard:!0},Hf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Et extends je{constructor(e,t){super(e,t),this._dialog=Q.findOne(jf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Bs,this._addEventListeners()}static get Default(){return Wf}static get DefaultType(){return Hf}static get NAME(){return $f}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||q.trigger(this._element,ni,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Vn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||q.trigger(this._element,kf).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Fn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){q.off(window,Ne),q.off(this._dialog,Ne),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ei({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ti({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=Q.findOne(Pf,this._dialog);t&&(t.scrollTop=0),Pt(this._element),this._element.classList.add(Fn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,q.trigger(this._element,xf,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){q.on(this._element,Df,e=>{if(e.key===Cf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),q.on(window,Af,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),q.on(this._element,Of,e=>{q.one(this._element,Mf,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Vn),this._resetAdjustments(),this._scrollBar.reset(),q.trigger(this._element,si)})}_isAnimated(){return this._element.classList.contains(Lf)}_triggerBackdropTransition(){if(q.trigger(this._element,Tf).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(xs)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(xs),this._queueCallback(()=>{this._element.classList.remove(xs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=De()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=De()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=Et.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}q.on(document,Nf,Rf,function(s){const e=Q.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&s.preventDefault(),q.one(e,ni,i=>{i.defaultPrevented||q.one(e,si,()=>{Tt(this)&&this.focus()})});const t=Q.findOne(If);t&&Et.getInstance(t).hide(),Et.getOrCreateInstance(e).toggle(this)});ls(Et);Ie(Et);const Vf="offcanvas",Ff="bs.offcanvas",qe=`.${Ff}`,oi=".data-api",Bf=`load${qe}${oi}`,Uf="Escape",Bn="show",Un="showing",qn="hiding",qf="offcanvas-backdrop",ii=".offcanvas.show",zf=`show${qe}`,Kf=`shown${qe}`,Gf=`hide${qe}`,zn=`hidePrevented${qe}`,ai=`hidden${qe}`,Yf=`resize${qe}`,Jf=`click${qe}${oi}`,Xf=`keydown.dismiss${qe}`,Qf='[data-bs-toggle="offcanvas"]',Zf={backdrop:!0,keyboard:!0,scroll:!1},ev={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ye extends je{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Zf}static get DefaultType(){return ev}static get NAME(){return Vf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||q.trigger(this._element,zf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Bs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Un);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Bn),this._element.classList.remove(Un),q.trigger(this._element,Kf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||q.trigger(this._element,Gf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(qn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Bn,qn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Bs().reset(),q.trigger(this._element,ai)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){q.trigger(this._element,zn);return}this.hide()},t=!!this._config.backdrop;return new ei({className:qf,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new ti({trapElement:this._element})}_addEventListeners(){q.on(this._element,Xf,e=>{if(e.key===Uf){if(this._config.keyboard){this.hide();return}q.trigger(this._element,zn)}})}static jQueryInterface(e){return this.each(function(){const t=Ye.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}q.on(document,Jf,Qf,function(s){const e=Q.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&s.preventDefault(),Ge(this))return;q.one(e,ai,()=>{Tt(this)&&this.focus()});const t=Q.findOne(ii);t&&t!==e&&Ye.getInstance(t).hide(),Ye.getOrCreateInstance(e).toggle(this)});q.on(window,Bf,()=>{for(const s of Q.find(ii))Ye.getOrCreateInstance(s).show()});q.on(window,Yf,()=>{for(const s of Q.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(s).position!=="fixed"&&Ye.getOrCreateInstance(s).hide()});ls(Ye);Ie(Ye);const tv=/^aria-[\w-]*$/i,ri={"*":["class","dir","id","lang","role",tv],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},sv=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),nv=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,ov=(s,e)=>{const t=s.nodeName.toLowerCase();return e.includes(t)?sv.has(t)?!!nv.test(s.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function iv(s,e,t){if(!s.length)return s;if(t&&typeof t=="function")return t(s);const i=new window.DOMParser().parseFromString(s,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const l=r.nodeName.toLowerCase();if(!Object.keys(e).includes(l)){r.remove();continue}const f=[].concat(...r.attributes),v=[].concat(e["*"]||[],e[l]||[]);for(const c of f)ov(c,v)||r.removeAttribute(c.nodeName)}return i.body.innerHTML}const av="TemplateFactory",rv={allowList:ri,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},lv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},cv={entry:"(string|element|function|null)",selector:"(string|element)"};class uv extends Rt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return rv}static get DefaultType(){return lv}static get NAME(){return av}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},cv)}_setContent(e,t,o){const i=Q.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Fe(t)){this._putElementInTemplate(Ke(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?iv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Se(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const dv="tooltip",mv=new Set(["sanitize","allowList","sanitizeFn"]),As="fade",pv="modal",Kt="show",fv=".tooltip-inner",Kn=`.${pv}`,Gn="hide.bs.modal",Ot="hover",Ms="focus",Os="click",vv="manual",hv="hide",_v="hidden",gv="show",bv="shown",yv="inserted",wv="click",$v="focusin",Ev="focusout",Sv="mouseenter",Cv="mouseleave",kv={AUTO:"auto",TOP:"top",RIGHT:De()?"left":"right",BOTTOM:"bottom",LEFT:De()?"right":"left"},Tv={allowList:ri,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},xv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class At extends je{constructor(e,t){if(typeof Lo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Tv}static get DefaultType(){return xv}static get NAME(){return dv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),q.off(this._element.closest(Kn),Gn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=q.trigger(this._element,this.constructor.eventName(gv)),o=(Po(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),q.trigger(this._element,this.constructor.eventName(yv))),this._popper=this._createPopper(i),i.classList.add(Kt),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))q.on(l,"mouseover",ss);const r=()=>{q.trigger(this._element,this.constructor.eventName(bv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||q.trigger(this._element,this.constructor.eventName(hv)).defaultPrevented)return;if(this._getTipElement().classList.remove(Kt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))q.off(i,"mouseover",ss);this._activeTrigger[Os]=!1,this._activeTrigger[Ms]=!1,this._activeTrigger[Ot]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),q.trigger(this._element,this.constructor.eventName(_v)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(As,Kt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=fm(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(As),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new uv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[fv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(As)}_isShown(){return this.tip&&this.tip.classList.contains(Kt)}_createPopper(e){const t=Se(this._config.placement,[this,e,this._element]),o=kv[t.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Se(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Se(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")q.on(this._element,this.constructor.eventName(wv),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Os]=!(i._isShown()&&i._activeTrigger[Os]),i.toggle()});else if(t!==vv){const o=t===Ot?this.constructor.eventName(Sv):this.constructor.eventName($v),i=t===Ot?this.constructor.eventName(Cv):this.constructor.eventName(Ev);q.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?Ms:Ot]=!0,r._enter()}),q.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?Ms:Ot]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},q.on(this._element.closest(Kn),Gn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Be.getDataAttributes(this._element);for(const o of Object.keys(t))mv.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ke(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=At.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ie(At);const Av="popover",Mv=".popover-header",Ov=".popover-body",Dv={...At.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Nv={...At.DefaultType,content:"(null|string|element|function)"};class sn extends At{static get Default(){return Dv}static get DefaultType(){return Nv}static get NAME(){return Av}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Mv]:this._getTitle(),[Ov]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ie(sn);const Lv="scrollspy",Iv="bs.scrollspy",nn=`.${Iv}`,jv=".data-api",Pv=`activate${nn}`,Yn=`click${nn}`,Rv=`load${nn}${jv}`,Wv="dropdown-item",ut="active",Hv='[data-bs-spy="scroll"]',Ds="[href]",Vv=".nav, .list-group",Jn=".nav-link",Fv=".nav-item",Bv=".list-group-item",Uv=`${Jn}, ${Fv} > ${Jn}, ${Bv}`,qv=".dropdown",zv=".dropdown-toggle",Kv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Gv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ds extends je{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Kv}static get DefaultType(){return Gv}static get NAME(){return Lv}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ke(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(q.off(this._config.target,Yn),q.on(this._config.target,Yn,Ds,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const l=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&l){if(o(r),!i)return;continue}!a&&!l&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Q.find(Ds,this._config.target);for(const t of e){if(!t.hash||Ge(t))continue;const o=Q.findOne(decodeURI(t.hash),this._element);Tt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ut),this._activateParents(e),q.trigger(this._element,Pv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Wv)){Q.findOne(zv,e.closest(qv)).classList.add(ut);return}for(const t of Q.parents(e,Vv))for(const o of Q.prev(t,Uv))o.classList.add(ut)}_clearActiveClass(e){e.classList.remove(ut);const t=Q.find(`${Ds}.${ut}`,e);for(const o of t)o.classList.remove(ut)}static jQueryInterface(e){return this.each(function(){const t=ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}q.on(window,Rv,()=>{for(const s of Q.find(Hv))ds.getOrCreateInstance(s)});Ie(ds);const Yv="tab",Jv="bs.tab",lt=`.${Jv}`,Xv=`hide${lt}`,Qv=`hidden${lt}`,Zv=`show${lt}`,eh=`shown${lt}`,th=`click${lt}`,sh=`keydown${lt}`,nh=`load${lt}`,oh="ArrowLeft",Xn="ArrowRight",ih="ArrowUp",Qn="ArrowDown",Ns="Home",Zn="End",st="active",eo="fade",Ls="show",ah="dropdown",li=".dropdown-toggle",rh=".dropdown-menu",Is=`:not(${li})`,lh='.list-group, .nav, [role="tablist"]',ch=".nav-item, .list-group-item",uh=`.nav-link${Is}, .list-group-item${Is}, [role="tab"]${Is}`,ci='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',js=`${uh}, ${ci}`,dh=`.${st}[data-bs-toggle="tab"], .${st}[data-bs-toggle="pill"], .${st}[data-bs-toggle="list"]`;class St extends je{constructor(e){super(e),this._parent=this._element.closest(lh),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),q.on(this._element,sh,t=>this._keydown(t)))}static get NAME(){return Yv}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?q.trigger(t,Xv,{relatedTarget:e}):null;q.trigger(e,Zv,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(st),this._activate(Q.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ls);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),q.trigger(e,eh,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(eo))}_deactivate(e,t){if(!e)return;e.classList.remove(st),e.blur(),this._deactivate(Q.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ls);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),q.trigger(e,Qv,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(eo))}_keydown(e){if(![oh,Xn,ih,Qn,Ns,Zn].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Ge(i));let o;if([Ns,Zn].includes(e.key))o=t[e.key===Ns?0:t.length-1];else{const i=[Xn,Qn].includes(e.key);o=Zs(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),St.getOrCreateInstance(o).show())}_getChildren(){return Q.find(js,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=Q.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(ah))return;const i=(a,r)=>{const l=Q.findOne(a,o);l&&l.classList.toggle(r,t)};i(li,st),i(rh,Ls),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(st)}_getInnerElement(e){return e.matches(js)?e:Q.findOne(js,e)}_getOuterElement(e){return e.closest(ch)||e}static jQueryInterface(e){return this.each(function(){const t=St.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}q.on(document,th,ci,function(s){["A","AREA"].includes(this.tagName)&&s.preventDefault(),!Ge(this)&&St.getOrCreateInstance(this).show()});q.on(window,nh,()=>{for(const s of Q.find(dh))St.getOrCreateInstance(s)});Ie(St);const mh="toast",ph="bs.toast",Ze=`.${ph}`,fh=`mouseover${Ze}`,vh=`mouseout${Ze}`,hh=`focusin${Ze}`,_h=`focusout${Ze}`,gh=`hide${Ze}`,bh=`hidden${Ze}`,yh=`show${Ze}`,wh=`shown${Ze}`,$h="fade",to="hide",Gt="show",Yt="showing",Eh={animation:"boolean",autohide:"boolean",delay:"number"},Sh={animation:!0,autohide:!0,delay:5e3};class ms extends je{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Sh}static get DefaultType(){return Eh}static get NAME(){return mh}show(){if(q.trigger(this._element,yh).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add($h);const t=()=>{this._element.classList.remove(Yt),q.trigger(this._element,wh),this._maybeScheduleHide()};this._element.classList.remove(to),Pt(this._element),this._element.classList.add(Gt,Yt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||q.trigger(this._element,gh).defaultPrevented)return;const t=()=>{this._element.classList.add(to),this._element.classList.remove(Yt,Gt),q.trigger(this._element,bh)};this._element.classList.add(Yt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Gt),super.dispose()}isShown(){return this._element.classList.contains(Gt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){q.on(this._element,fh,e=>this._onInteraction(e,!0)),q.on(this._element,vh,e=>this._onInteraction(e,!1)),q.on(this._element,hh,e=>this._onInteraction(e,!0)),q.on(this._element,_h,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=ms.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ls(ms);Ie(ms);const Ch={class:"message-content-column"},kh=["id"],Th={class:"accordion-item"},xh=["id"],Ah=["aria-controls"],Mh={class:"d-flex align-items-center w-100"},Oh={class:"badge bg-warning text-dark ms-auto me-2"},Dh={class:"text-muted"},Nh=["id","aria-labelledby"],Lh={class:"accordion-body bg-light"},Ih={class:"alert alert-warning mb-3",role:"alert"},jh={class:"compaction-metadata"},Ph={class:"metadata-row"},Rh={class:"metadata-row"},Wh={key:0,class:"metadata-row"},Hh={class:"continuation-content"},Vh={class:"continuation-text border rounded p-3 bg-white"},Fh={class:"mb-0"},Bh={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:s=>s.length===4||s.length===5}},setup(s){const e=s,t=h(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=h(()=>`heading-${t.value}`),i=h(()=>`collapse-${t.value}`),a=I(null);let r=null;_e(()=>{a.value&&(r=new $t(a.value,{toggle:!1}))}),pi(()=>{r&&r.dispose()});function l(){r&&r.toggle()}const f=h(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),v=h(()=>f.value?e.messages[3]:e.messages[2]),c=h(()=>v.value?.metadata?.init_data?.compact_metadata||{}),$=h(()=>c.value.pre_tokens||0),_=h(()=>f.value?e.messages[4]:e.messages[3]),b=h(()=>_.value?.content||""),y=h(()=>{const u=e.messages[0]?.timestamp;return u?It(u):""});function g(u){return u?`${u.toLocaleString()} tokens`:"0 tokens"}return(u,d)=>(m(),p("div",{class:"message-row message-row-compaction",key:t.value},[d[7]||(d[7]=n("div",{class:"message-speaker"},[n("span",{class:"speaker-label"},"system")],-1)),n("div",Ch,[n("div",{class:"accordion compaction-accordion",id:t.value},[n("div",Th,[n("h2",{class:"accordion-header",id:o.value},[n("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:l},[n("div",Mh,[d[0]||(d[0]=n("span",{class:"me-2"},"ðŸ—œï¸",-1)),d[1]||(d[1]=n("strong",{class:"me-2"},"Context Compaction Event",-1)),n("span",Oh,w(g($.value)),1),n("small",Dh,w(y.value),1)])],8,Ah)],8,xh),n("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[n("div",Lh,[n("div",Ih,[d[5]||(d[5]=n("h6",{class:"alert-heading mb-2"},[n("span",{class:"me-2"},"â„¹ï¸"),ee(" Compaction Details ")],-1)),n("div",jh,[n("div",Ph,[d[2]||(d[2]=n("strong",null,"Trigger:",-1)),n("span",null,w(c.value.trigger||"auto"),1)]),n("div",Rh,[d[3]||(d[3]=n("strong",null,"Pre-compaction tokens:",-1)),n("span",null,w(g($.value)),1)]),c.value.post_tokens?(m(),p("div",Wh,[d[4]||(d[4]=n("strong",null,"Post-compaction tokens:",-1)),n("span",null,w(g(c.value.post_tokens)),1)])):M("",!0)])]),n("div",Hh,[d[6]||(d[6]=n("h6",{class:"text-muted mb-2"},[n("span",{class:"me-2"},"â†©ï¸"),ee(" Continuation Message ")],-1)),n("div",Vh,[n("pre",Fh,w(b.value),1)])])])],8,Nh)])],8,kh)])]))}},Uh=te(Bh,[["__scopeId","data-v-e0b95ba8"]]),qh={key:0,class:"text-muted text-center py-5"},zh={__name:"MessageList",setup(s){const e=Oe(),t=fe(),o=I(null),i=h(()=>{const c=e.currentMessages,$=[];let _=0;for(;_<c.length;){const b=c[_];if(r(b,c,_)){const y=c[_+2],u=y?.type==="system"&&y?.metadata?.subtype==="init"?5:4,d=c.slice(_,_+u);$.push({type:"compaction",messages:d}),_+=u;continue}f(b)&&$.push({type:"message",message:b,attachedTools:[]}),_++}return a($)});function a(c){const $=new Map,_=new Set;for(let y=0;y<c.length;y++){const g=c[y];if(g.type==="compaction")continue;const u=g.message,d=u.content&&u.content.trim().length>0&&u.content!=="Assistant response",C=u.type==="assistant"&&u.metadata?.has_tool_uses&&u.metadata?.tool_uses?.length>0;if(u.type==="assistant"&&C&&!d){let x=-1,O=!1;for(let P=y-1;P>=0;P--){const H=c[P];if(!_.has(P)){if(H.type==="message"&&H.message.type!=="assistant"){O=!0;break}if(H.type==="message"&&H.message.type==="assistant"){const D=H.message;if(D.content&&D.content.trim().length>0&&D.content!=="Assistant response"){x=P;break}else{x=P;break}}}}O&&x===-1||(O&&x>=0?($.has(x)||$.set(x,[]),$.get(x).push(...u.metadata.tool_uses),_.add(y)):!O&&x>=0&&($.has(x)||$.set(x,[]),$.get(x).push(...u.metadata.tool_uses),_.add(y)))}}const b=[];for(let y=0;y<c.length;y++){if(_.has(y))continue;const g=c[y];$.has(y)&&(g.attachedTools=[...g.attachedTools||[],...$.get(y)]),b.push(g)}return b}function r(c,$,_){if(_+3>=$.length)return!1;const b=$[_],y=$[_+1];let g=$[_+2],u=$[_+3],d=$[_+4];const C=b.type==="system"&&b.metadata?.subtype==="status"&&b.metadata?.init_data?.status==="compacting",x=y.type==="system"&&y.metadata?.subtype==="status"&&(y.metadata?.init_data?.status===null||y.metadata?.init_data?.status===void 0);if(g?.type==="system"&&g?.metadata?.subtype==="init"){if(_+4>=$.length)return!1;const P=!0,H=u?.type==="system"&&u?.metadata?.subtype==="compact_boundary",D=d?.type==="user"&&d?.content?.startsWith("This session is being continued from a previous conversation");return b.type==="system"&&b.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",_),console.log("  Msg1 (compacting):",C),console.log("  Msg2 (null status):",x),console.log("  Msg3 (init):",P),console.log("  Msg4 (boundary):",H),console.log("  Msg5 (continuation):",D)),C&&x&&P&&H&&D}else{const P=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",H=u?.type==="user"&&u?.content?.startsWith("This session is being continued from a previous conversation");return b.type==="system"&&b.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",_),console.log("  Msg1 (compacting):",C),console.log("  Msg2 (null status):",x),console.log("  Msg3 (boundary):",P),console.log("  Msg4 (continuation):",H)),C&&x&&P&&H}}async function l(){t.autoScrollEnabled&&(await es(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}de(()=>i.value.length,l),de(()=>e.currentToolCalls.length,l),de(()=>e.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),l),_e(()=>{setTimeout(()=>{l()},100)});function f(c){const $=c.subtype||c.metadata?.subtype;if(c.type==="system"&&$==="init"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const _=c.content||"";if(_.match(/^Tool results?: \d+ results?$/i)||_.trim()==="")return!1}if(c.type==="user"){const _=c.content||"";if(_.includes("<command-message>")&&_.includes("skill is running")||_.startsWith("Base directory for this skill:"))return!1}if(c.type==="user"){const _=c.content||"";if(_.includes("<command-message>")&&_.includes("<command-name>")&&_.includes("<command-args>")||_.includes("ARGUMENTS:")&&(_.includes("<command-name>")||_.match(/\nARGUMENTS:/)))return!1}return!0}function v(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,$)=>(m(),p("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(m(),p("div",qh," No messages yet. Start a conversation! ")):M("",!0),(m(!0),p(re,null,ue(i.value,(_,b)=>(m(),p(re,{key:`item-${b}`},[_.type==="message"?(m(),ye(Td,{key:0,message:v(_.message),attachedTools:_.attachedTools||[]},null,8,["message","attachedTools"])):_.type==="compaction"?(m(),ye(Uh,{key:1,messages:_.messages},null,8,["messages"])):M("",!0)],64))),128))],512))}},Kh=te(zh,[["__scopeId","data-v-6bae0fb1"]]),Gh={class:"border-top bg-light"},Yh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Jh={class:"d-flex gap-2 align-items-end px-2 py-1"},Xh=["placeholder","disabled"],Qh=["disabled"],Zh={__name:"InputArea",setup(s){const e=ae(),t=Je(),o=I(null),i=I(window.innerWidth),a=h({get:()=>e.currentInput,set:u=>{e.currentInput=u}}),r=h(()=>e.currentSession?.is_processing||!1),l=h(()=>t.sessionConnected),f=h(()=>e.currentSession?.state==="starting"),v=h(()=>i.value<768),c=h(()=>f.value?"Session is starting...":l.value?"Type your message to Claude Code...":"Waiting for connection...");function $(){i.value=window.innerWidth}_e(()=>{window.addEventListener("resize",$)}),Ce(()=>{window.removeEventListener("resize",$)});function _(u){if(u.key==="Enter"&&!u.shiftKey){if(v.value)return;u.preventDefault(),y()}}function b(){const u=o.value;if(!u)return;u.style.height="auto";const d=Math.min(u.scrollHeight,parseInt(getComputedStyle(u).maxHeight));u.style.height=d+"px"}function y(){a.value.trim()&&(t.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function g(){t.interruptSession()}return(u,d)=>(m(),p("div",Gh,[l.value?M("",!0):(m(),p("div",Yh,[...d[1]||(d[1]=[n("span",{class:"flex-shrink-0"},"â—",-1),n("strong",null,"Disconnected",-1),n("span",{class:"text-muted"},"â€”",-1),n("span",null,"Cannot send messages while reconnecting...",-1)])])),n("div",Jh,[he(n("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":d[0]||(d[0]=C=>a.value=C),class:"form-control",placeholder:c.value,disabled:f.value||!l.value,rows:"1",onInput:b,onKeydown:_},null,40,Xh),[[Pe,a.value]]),r.value?(m(),p("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:g}," Stop ")):(m(),p("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!l.value||f.value,onClick:y}," Send ",8,Qh))])]))}},e_=te(Zh,[["__scopeId","data-v-ef1e5094"]]),t_={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},s_={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},n_={class:"text-secondary"},o_={class:"d-flex flex-column flex-grow-1 overflow-hidden"},i_={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(s){const e=s,t=ae(),o=fe(),i=h(()=>t.currentSession),a=h(()=>o.isLoading),r=h(()=>o.loadingMessage);return _e(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),de(()=>e.sessionId,async(l,f)=>{if(l!==f&&l!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(l)}finally{o.hideLoading()}}}),Ce(()=>{}),(l,f)=>(m(),p("div",t_,[a.value?(m(),p("div",s_,[f[0]||(f[0]=n("div",{class:"spinner-border text-primary mb-3",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1)),n("p",n_,w(r.value),1)])):M("",!0),i.value?(m(),ye(Ni,{key:1,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),n("div",o_,[me(Kh)]),me(e_),i.value?(m(),ye(Ri,{key:2,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),i.value?(m(),ye(Ki,{key:3,"session-id":e.sessionId},null,8,["session-id"])):M("",!0)]))}},ps=Ct("legion",()=>{const s=I(new Map),e=I(new Map),t=I(null),o=h(()=>s.value.get(t.value)||[]),i=h(()=>e.value.get(t.value)||[]);function a(y){t.value=y}async function r(y,g=100,u=0){try{const d=await oe.get(`/api/legions/${y}/timeline?limit=${g}&offset=${u}`),C=d.comms||[],x=d.total_count||C.length,O=d.has_more||!1;return C.sort((P,H)=>new Date(P.timestamp)-new Date(H.timestamp)),console.log(`Loaded ${C.length} of ${x} comms for legion ${y}`),s.value.set(y,C),s.value=new Map(s.value),{comms:C,totalCount:x,hasMore:O}}catch(d){throw console.error("Failed to load timeline:",d),d}}function l(y,g){s.value.has(y)||s.value.set(y,[]);const u=s.value.get(y);if(u.some(C=>C.comm_id===g.comm_id)){console.log(`Duplicate comm ${g.comm_id} prevented in timeline`);return}u.push(g),s.value=new Map(s.value)}async function f(y,g){try{const d=(await oe.post(`/api/legions/${y}/comms`,g)).comm;return console.log(`Sent comm ${d.comm_id} to legion ${y}`),d}catch(u){throw console.error("Failed to send comm:",u),u}}async function v(y){return console.log(`Minions for legion ${y} are already available in session store`),[]}async function c(y,g){try{const d=(await oe.post(`/api/legions/${y}/minions`,g)).minion;return await v(y),console.log(`Created minion ${d.minion_id} in legion ${y}`),d}catch(u){throw console.error("Failed to create minion:",u),u}}async function $(y){try{const g=await oe.post(`/api/legions/${y}/halt-all`);return console.log(`Halted ${g.halted_count} of ${g.total_minions} minions in legion ${y}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to halt some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to halt all minions:",g),g}}async function _(y){try{const g=await oe.post(`/api/legions/${y}/resume-all`);return console.log(`Resumed ${g.resumed_count} of ${g.total_minions} minions in legion ${y}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to resume some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to resume all minions:",g),g}}function b(y){s.value.delete(y),e.value.delete(y),s.value=new Map(s.value),e.value=new Map(e.value)}return{commsByLegion:s,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:r,addComm:l,sendComm:f,loadMinions:v,createMinion:c,haltAll:$,resumeAll:_,clearLegionData:b}}),a_=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:ps},Symbol.toStringTag,{value:"Module"})),r_={class:"timeline-header border-bottom p-3"},l_={class:"project-name"},c_=["title"],u_={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(s){const e=s,t=Le(),o=h(()=>t.projects.get(e.legionId)),i=h(()=>o.value?.name||"Legion");return(a,r)=>(m(),p("div",r_,[n("div",null,[n("div",l_,w(i.value),1),n("div",{class:"view-name",title:s.legionId},"Timeline",8,c_)])]))}},d_=te(u_,[["__scopeId","data-v-44f386f5"]]),m_={class:"timeline-status-bar border-top p-2 bg-light"},p_={class:"d-flex justify-content-end"},f_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(s){const e=fe();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(m(),p("div",m_,[n("div",p_,[n("button",{class:X(["btn btn-sm",Zt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+w(Zt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},v_=te(f_,[["__scopeId","data-v-891c73db"]]),h_={class:"comm-composer border-top p-3"},__={key:0,class:"d-flex gap-2 mb-2"},g_={class:"flex-grow-1"},b_=["disabled"],y_={label:"Minions"},w_=["value"],$_={style:{"min-width":"150px"}},E_=["disabled"],S_={class:"d-flex gap-2 align-items-end position-relative"},C_={class:"flex-grow-1 position-relative"},k_=["disabled"],T_=["onClick","onMouseenter"],x_=["disabled"],A_={key:0},M_={key:1},O_={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(s){const e=s,t=ps(),o=ae(),i=Le(),a=I(""),r=I("task"),l=I(""),f=I(!1),v=I(window.innerWidth),c=I(!1),$=I([]),_=I(0),b=I(-1),y=I(null),g=I(null),u=h(()=>v.value<768),d=h(()=>{const U=i.projects.get(e.legionId);return!U||!U.session_ids?[]:U.session_ids.map(S=>o.sessions.get(S)).filter(S=>S)}),C=h(()=>a.value&&l.value.trim().length>0);function x(U){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[U.state]||"â—‹"}function O(U){return U.role?`${U.name} (${U.role})`:U.name}function P(){const U=y.value;if(!U)return;U.style.height="auto";const S=Math.min(U.scrollHeight,parseInt(getComputedStyle(U).maxHeight));U.style.height=S+"px"}function H(){const U=y.value;if(!U)return;P();const S=l.value,E=U.selectionStart,N=S.substring(0,E),T=N.lastIndexOf("#");if(T===-1){c.value=!1;return}const k=N.substring(T+1).toLowerCase();if(k.includes(" ")){c.value=!1;return}const j=d.value.filter(z=>z.name.toLowerCase().includes(k)).map(z=>({type:"minion",name:z.name,role:z.role,id:z.session_id,state:z.state}));if(j.length===0){c.value=!1;return}$.value=j,_.value=0,b.value=T,c.value=!0}function D(){if(!g.value)return;const U=g.value,S=U.children[_.value];if(!S)return;const E=S.offsetTop,N=S.offsetHeight,T=U.scrollTop,k=U.clientHeight;E<T?U.scrollTop=E:E+N>T+k&&(U.scrollTop=E+N-k)}function F(U){if(!c.value){if(U.key==="Enter"&&!U.shiftKey){if(u.value)return;C.value&&(U.preventDefault(),L())}return}if(U.key==="ArrowDown")U.preventDefault(),_.value=(_.value+1)%$.value.length,D();else if(U.key==="ArrowUp")U.preventDefault(),_.value=_.value===0?$.value.length-1:_.value-1,D();else if(U.key==="Enter"){U.preventDefault();const S=$.value[_.value];S&&A(S)}else U.key==="Escape"&&(c.value=!1)}function A(U){const S=y.value;if(!S)return;const E=l.value,N=S.selectionStart,T=E.substring(0,b.value)+"#"+U.name+" "+E.substring(N);l.value=T;const k=b.value+U.name.length+2;setTimeout(()=>{S.setSelectionRange(k,k),S.focus()},0),c.value=!1}async function L(){if(!(!C.value||f.value)){f.value=!0;try{const[U,S]=a.value.split(":"),E={comm_type:r.value,content:l.value.trim()};U==="minion"&&(E.to_minion_id=S),await t.sendComm(e.legionId,E),l.value="",P()}catch(U){console.error("Failed to send comm:",U),alert(`Failed to send comm: ${U.message}`)}finally{f.value=!1}}}function K(){v.value=window.innerWidth}return _e(()=>{window.addEventListener("resize",K)}),Ce(()=>{window.removeEventListener("resize",K)}),de(c,U=>{if(U){const S=E=>{E.target.closest(".comm-composer")||(c.value=!1,document.removeEventListener("click",S))};setTimeout(()=>document.addEventListener("click",S),0)}}),(U,S)=>(m(),p("div",h_,[s.hideRecipientSelector?M("",!0):(m(),p("div",__,[n("div",g_,[he(n("select",{"onUpdate:modelValue":S[0]||(S[0]=E=>a.value=E),class:"form-select form-select-sm",disabled:f.value},[S[3]||(S[3]=n("option",{value:""},"-- Select Recipient --",-1)),n("optgroup",y_,[(m(!0),p(re,null,ue(d.value,E=>(m(),p("option",{key:E.session_id,value:`minion:${E.session_id}`},w(x(E))+" "+w(O(E)),9,w_))),128))])],8,b_),[[mn,a.value]])]),n("div",$_,[he(n("select",{"onUpdate:modelValue":S[1]||(S[1]=E=>r.value=E),class:"form-select form-select-sm",disabled:f.value},[...S[4]||(S[4]=[n("option",{value:"task"},"Task",-1),n("option",{value:"question"},"Question",-1),n("option",{value:"info"},"Info",-1),n("option",{value:"report"},"Report",-1)])],8,E_),[[mn,r.value]])])])),n("div",S_,[n("div",C_,[he(n("textarea",{ref_key:"contentTextarea",ref:y,"onUpdate:modelValue":S[2]||(S[2]=E=>l.value=E),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:f.value,onInput:H,onKeydown:F},null,40,k_),[[Pe,l.value]]),c.value?(m(),p("div",{key:0,ref_key:"autocompleteDropdown",ref:g,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(m(!0),p(re,null,ue($.value,(E,N)=>(m(),p("div",{key:E.id,class:X(["autocomplete-item px-2 py-1",{"bg-light":N===_.value}]),onClick:T=>A(E),onMouseenter:T=>_.value=N},w(E.type==="minion"?x(E):"#ï¸âƒ£")+" "+w(E.name)+w(E.role?` (${E.role})`:""),43,T_))),128))],512)):M("",!0)]),n("div",null,[n("button",{class:"btn btn-primary btn-sm",disabled:!C.value||f.value,onClick:L},[f.value?(m(),p("span",A_,[...S[5]||(S[5]=[n("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ee(" Sending... ",-1)])])):(m(),p("span",M_,"Send"))],8,x_)])])]))}},D_=te(O_,[["__scopeId","data-v-e52b8e8f"]]),N_={class:"message-content-column-full"},L_=["aria-expanded"],I_={class:"comm-sender-recipient"},j_={class:"comm-badge-summary"},P_=["title"],R_={class:"comm-summary-text text-muted ms-2"},W_=["aria-label"],H_={key:0,class:"comm-content-body"},V_=["innerHTML"],F_="ffffffff-ffff-ffff-ffff-ffffffffffff",B_={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(s){const e=s;ot.setOptions({breaks:!0,gfm:!0});const t=I(!1);function o(){t.value=!t.value}const i=h(()=>e.comm.from_minion_id===F_),a=h(()=>{const v=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${v.toLocaleString()}`}),r=h(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),l=h(()=>{if(e.comm.summary)return e.comm.summary;const v=e.comm.content||"";return v.length>100?v.substring(0,100)+"...":v}),f=h(()=>{const v=e.comm.content||"";let c=ot.parse(v);return c=c.replace(/\n</g,"<"),c=c.replace(/\n+$/,""),is.sanitize(c)});return(v,c)=>(m(),p("div",{class:X(["message-row message-row-comm",{"system-comm":i.value}])},[n("div",N_,[n("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[n("div",I_,[n("strong",{class:X({"system-sender":i.value})},w(s.senderName),3),s.recipientName?(m(),p(re,{key:0},[c[0]||(c[0]=n("span",{class:"text-muted mx-1"},"â†’",-1)),n("strong",null,w(s.recipientName),1)],64)):M("",!0)]),n("div",j_,[n("span",{class:X(["badge",r.value]),title:a.value},w(s.comm.comm_type),11,P_),n("span",R_,w(l.value),1)]),n("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},w(t.value?"â–¾":"â–¸"),9,W_)],8,L_),t.value?(m(),p("div",H_,[n("div",{class:"message-text",innerHTML:f.value},null,8,V_)])):M("",!0)])],2))}},U_=te(B_,[["__scopeId","data-v-28513f64"]]),q_={class:"timeline-view d-flex flex-column h-100"},z_={key:0,class:"text-center text-muted"},K_={key:1,class:"text-center text-danger"},G_={key:2,class:"text-center text-muted"},Y_={key:3,class:"comm-list"},J_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(s){const e=s,t=ps();Le();const o=ae(),i=Je(),a=fe(),r=I(!0),l=I(null),f=I(null),v=h(()=>t.currentComms);function c(u){return u.from_user?"You":u.from_minion_id?u.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(u.from_minion_id)?.name||"Unknown":"Unknown"}function $(u){return u.to_user?"You":u.to_minion_id?o.sessions.get(u.to_minion_id)?.name||"Unknown":"All"}async function _(){a.autoScrollEnabled&&(await es(),f.value&&(f.value.scrollTop=f.value.scrollHeight))}async function b(){r.value=!0,l.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await es(),await _(),setTimeout(()=>{_()},100)}catch(u){console.error("Failed to load timeline:",u),u.response?l.value=`${u.message} (${u.response.status})`:l.value=u.message||"Unknown error"}finally{r.value=!1}}function y(){i.connectLegion(e.legionId)}function g(){i.disconnectLegion()}return de(()=>v.value.length,()=>{_()}),_e(()=>{o.currentSessionId=null,b(),y(),setTimeout(()=>{_()},100)}),Ce(()=>{g()}),(u,d)=>(m(),p("div",q_,[me(d_,{"legion-id":s.legionId},null,8,["legion-id"]),n("div",{ref_key:"messagesArea",ref:f,class:"timeline-messages flex-grow-1 overflow-auto"},[r.value?(m(),p("div",z_,[...d[0]||(d[0]=[n("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ee(" Loading timeline... ",-1)])])):l.value?(m(),p("div",K_," Failed to load timeline: "+w(l.value),1)):v.value.length===0?(m(),p("div",G_," No messages yet. Minions will appear here once they start communicating. ")):(m(),p("div",Y_,[(m(!0),p(re,null,ue(v.value,C=>(m(),ye(U_,{key:C.comm_id,comm:C,"sender-name":c(C),"recipient-name":$(C)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),me(D_,{"legion-id":s.legionId},null,8,["legion-id"]),me(v_,{"legion-id":s.legionId},null,8,["legion-id"])]))}},X_=te(J_,[["__scopeId","data-v-b6752179"]]),Q_={class:"minion-info flex-grow-1"},Z_={class:"minion-name"},eg={key:0,class:"me-1"},tg={key:1,class:"badge bg-secondary ms-2"},sg={key:0,class:"latest-activity text-muted"},ng={key:0,class:"activity-prefix"},og=["title"],ig={key:1,class:"activity-time ms-1"},ag={key:1,class:"latest-activity text-muted"},rg={class:"activity-prefix"},lg=["title"],cg={key:2,class:"latest-activity text-muted fst-italic small"},ug={class:"node-row"},dg={class:"node-left"},mg={key:0,class:"me-2"},pg={key:1,class:"badge bg-secondary ms-2"},fg={class:"node-right"},vg={key:0,class:"latest-message-preview"},hg={key:0,class:"message-prefix"},_g=["title"],gg={key:1,class:"message-time ms-1"},bg={key:1,class:"last-comm-preview"},yg={class:"comm-direction"},wg=["title"],$g={key:2,class:"text-muted fst-italic small"},Eg={class:"node-actions"},Sg={key:2,class:"minion-children"},Cg={key:1,class:"text-danger small ms-4"},kg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:s=>["two-column","sidebar"].includes(s)}},emits:["minion-click"],setup(s,{emit:e}){const t=s,o=e,i=ae(),a=Oe(),r=fe(),l=h(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),f=h(()=>{if(!t.minionData||!t.minionData.id)return null;const A=a.messagesBySession.get(t.minionData.id);if(!A||A.length===0)return null;for(let L=A.length-1;L>=0;L--){const K=A[L];if(K.type!=="result"&&!(K.type==="user"&&K.content&&K.content.startsWith("Tool results:"))&&!(K.type==="system"&&K.content==="System message")&&!(K.type==="assistant"&&K.content==="Assistant response")&&(K.type==="user"||K.type==="assistant"||K.type==="system"))return{content:K.content,type:K.type,timestamp:K.timestamp}}return null}),v=h(()=>{if(!t.minionData)return null;const A={...t.minionData};return l.value&&(A.state=l.value.state,A.is_processing=l.value.is_processing,l.value.name&&(A.name=l.value.name),l.value.latest_message&&(A.latest_message=l.value.latest_message,A.latest_message_type=l.value.latest_message_type,A.latest_message_time=l.value.latest_message_time)),f.value&&(A.latest_message=f.value.content,A.latest_message_type=f.value.type,A.latest_message_time=f.value.timestamp),A}),c=h(()=>t.level*24),$=h(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),_=h(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),b=h(()=>t.minionData&&t.minionData.is_overseer&&_.value),y=h(()=>{const A=v.value;return A?A.state==="paused"&&A.is_processing?"pending-prompt":A.is_processing?"processing":A.state||"created":"created"}),g=h(()=>{const A=y.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[A]||"status-dot-grey"}),u=h(()=>{const A=y.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[A]||"#d3d3d3"}}),d=h(()=>{const A=v.value;if(!A||!A.latest_message_type)return"";const L=A.latest_message_type;return L==="user"?"User -->:":L==="system"?"System:":""}),C=h(()=>{const A=v.value;if(!A||!A.latest_message)return"";const L=A.latest_message,K=150;return L.length>K?L.slice(0,K)+"...":L}),x=h(()=>{const A=v.value;if(!A||!A.latest_message_time)return"";try{const L=Date.now();let K;if(typeof A.latest_message_time=="number"?K=A.latest_message_time<3250368e4?A.latest_message_time*1e3:A.latest_message_time:K=new Date(A.latest_message_time).getTime(),isNaN(K)||K<9466848e5||K>L+6e4)return console.warn("Invalid timestamp for relative time calculation:",A.latest_message_time,"parsed to:",K),"";const U=L-K;if(U<0)return"just now";const S=Math.floor(U/6e4),E=Math.floor(S/60),N=Math.floor(E/24);return N>0?`${N}d ago`:E>0?`${E}h ago`:S>0?`${S}m ago`:"just now"}catch(L){return console.error("Error calculating relative time:",L,A.latest_message_time),""}});function O(A){return A.to_user?"User":A.to_minion_name?A.to_minion_name:"unknown"}function P(A){const L=A.summary||A.content||"";return L.length>150?L.substring(0,150)+"...":L}function H(){o("minion-click",t.minionData.id)}function D(){const A=i.sessions.get(t.minionData.id);A&&r.showModal("edit-session",{session:A})}function F(){const A=i.sessions.get(t.minionData.id);A&&r.showModal("manage-session",{session:A})}return(A,L)=>{const K=no("MinionTreeNode",!0);return s.minionData?(m(),p("div",{key:0,class:"minion-tree-node",style:vt({marginLeft:`${c.value}px`})},[s.layout==="sidebar"?(m(),p("div",{key:0,class:X(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:H},[n("div",{class:X(["status-dot me-2",g.value]),style:vt(u.value)},null,6),n("div",Q_,[n("div",Z_,[b.value?(m(),p("span",eg,"ðŸ‘‘")):M("",!0),n("strong",null,w(v.value?.name||s.minionData.name),1),b.value?(m(),p("span",tg,w(s.minionData.children.length)+" "+w(s.minionData.children.length===1?"child":"children"),1)):M("",!0)]),v.value?.latest_message?(m(),p("div",sg,[d.value?(m(),p("span",ng,w(d.value),1)):M("",!0),n("span",{class:"activity-content",title:v.value.latest_message},w(C.value),9,og),x.value?(m(),p("span",ig,"("+w(x.value)+")",1)):M("",!0)])):s.minionData?.last_comm?(m(),p("div",ag,[n("span",rg,[L[1]||(L[1]=ee("â†’ ",-1)),n("strong",null,w(O(s.minionData.last_comm)),1),L[2]||(L[2]=ee(": ",-1))]),n("span",{class:"activity-content",title:s.minionData.last_comm.content||""},w(P(s.minionData.last_comm)),9,lg)])):(m(),p("div",cg," No activity yet "))]),n("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(D,["stop"])}," âœï¸ "),n("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(F,["stop"])}," âš™ï¸ ")],2)):(m(),p("div",{key:1,class:X(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:H},[n("div",ug,[n("div",dg,[n("div",{class:X(["status-dot me-2",g.value]),style:vt(u.value)},null,6),b.value?(m(),p("span",mg,"ðŸ‘‘")):M("",!0),n("strong",null,w(v.value?.name||s.minionData.name),1),b.value?(m(),p("span",pg,w(s.minionData.children.length)+" "+w(s.minionData.children.length===1?"child":"children"),1)):M("",!0)]),n("div",fg,[v.value?.latest_message?(m(),p("div",vg,[d.value?(m(),p("span",hg,w(d.value),1)):M("",!0),n("span",{class:"message-content",title:v.value.latest_message},w(C.value),9,_g),x.value?(m(),p("span",gg,"("+w(x.value)+")",1)):M("",!0)])):s.minionData?.last_comm?(m(),p("div",bg,[n("span",yg,[L[3]||(L[3]=ee("â†’ ",-1)),n("strong",null,w(O(s.minionData.last_comm)),1),L[4]||(L[4]=ee(":",-1))]),n("span",{class:"comm-content",title:s.minionData.last_comm.content||""},w(P(s.minionData.last_comm)),9,wg)])):(m(),p("div",$g," No activity yet "))]),n("div",Eg,[n("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(D,["stop"])}," âœï¸ "),n("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(F,["stop"])}," âš™ï¸ ")])])],2)),_.value?(m(),p("div",Sg,[(m(!0),p(re,null,ue(s.minionData.children,U=>(m(),ye(K,{key:U.id,"minion-data":U,level:s.level+1,layout:s.layout,onMinionClick:L[0]||(L[0]=S=>A.$emit("minion-click",S))},null,8,["minion-data","level","layout"]))),128))])):M("",!0)],4)):(m(),p("div",Cg," âš  Minion data is missing "))}}},ui=te(kg,[["__scopeId","data-v-5dae8a96"]]),Tg={class:"project-overview d-flex flex-column h-100"},xg={class:"project-overview-header border-bottom p-3"},Ag={class:"d-flex align-items-center justify-content-between"},Mg={class:"mb-1"},Og={key:0,class:"me-2"},Dg={class:"text-muted font-monospace"},Ng={class:"d-flex gap-2"},Lg=["title"],Ig={class:"project-overview-content flex-grow-1 overflow-auto p-3"},jg={key:0,class:"text-center py-5"},Pg={key:1,class:"alert alert-danger"},Rg={key:2,class:"text-center py-5"},Wg={key:3},Hg={class:"row g-3 mb-4"},Vg={class:"col-md-4"},Fg={class:"card h-100"},Bg={class:"card-body"},Ug={class:"card-title mb-0"},qg={class:"text-muted"},zg={class:"col-md-4"},Kg={class:"card h-100"},Gg={class:"card-body"},Yg={class:"card-title mb-0"},Jg={class:"text-muted"},Xg={key:0,class:"card mb-4"},Qg={class:"card mb-4"},Zg={class:"card-header d-flex align-items-center justify-content-between"},eb={class:"mb-0"},tb={class:"badge bg-secondary"},sb={class:"card-body"},nb={key:0,class:"text-center py-4"},ob={key:1,class:"text-center text-muted py-4"},ib={key:2,class:"hierarchy-tree"},ab={class:"user-root-node mb-3 border rounded bg-white"},rb={class:"node-row"},lb={class:"node-left"},cb={class:"badge bg-primary ms-2"},ub={class:"node-right"},db={key:0,class:"last-comm-preview"},mb={class:"comm-direction"},pb=["title"],fb={key:1,class:"text-muted fst-italic"},vb={class:"root-minions ms-4"},hb={class:"card"},_b={class:"card-body"},gb={class:"row mb-0"},bb={class:"col-sm-8 font-monospace text-break"},yb={class:"col-sm-8 font-monospace text-break"},wb={class:"col-sm-8"},$b={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},Eb={class:"text-muted"},Sb={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(s){const e=s,t=Lt(),o=Le(),i=ae(),a=fe(),r=ps(),l=Je(),f=I(!1),v=I(null),c=I(null),$=I(!1);let _=null;const b=h(()=>o.getProject(e.projectId)),y=h(()=>b.value?.session_ids?b.value.session_ids.map(E=>i.getSession(E)).filter(E=>E!=null):[]),g=h(()=>y.value.length>0),u=h(()=>y.value.length),d=h(()=>y.value.filter(E=>E.state==="ACTIVE").length),C=h(()=>{const E=y.value.some(k=>k.state==="ACTIVE"),N=y.value.some(k=>k.is_processing);return y.value.some(k=>k.state==="ERROR")?"Error":N?"Working":E?"Active":u.value>0?"Idle":"Empty"}),x=h(()=>{switch(C.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),O=h(()=>{switch(C.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function P(){$.value=!0;try{const E=await oe.get(`/api/legions/${e.projectId}/hierarchy`);c.value=E}catch(E){console.error("Failed to load minion hierarchy:",E),c.value=null}finally{$.value=!1}}function H(E,N){if(E&&E.id===N)return E;if(E&&E.children)for(const T of E.children){const k=H(T,N);if(k)return k}return null}function D(E){return E.to_user?"User":E.to_minion_name?E.to_minion_name:"unknown"}function F(E){const N=E.summary||E.content||"";return N.length>150?N.substring(0,150)+"...":N}function A(E){if(c.value){if(E.from_minion_id){const N=H(c.value,E.from_minion_id);N&&N.type==="minion"&&(N.last_comm=E)}E.from_user&&c.value.type==="user"&&(c.value.last_comm=E)}}function L(E){t.push(`/session/${E}`)}function K(){t.push(`/timeline/${e.projectId}`)}function U(){a.showModal("edit-project",{project:b.value})}function S(){a.showModal("create-minion",{project:b.value})}return _e(()=>{o.selectProject(e.projectId),i.currentSessionId=null,P(),r.setCurrentLegion(e.projectId),l.connectLegion(e.projectId),_=de(()=>i.sessions,E=>{if(c.value){for(const[N,T]of E)if(T.project_id===e.projectId){const k=H(c.value,N);k&&k.type==="minion"&&(k.state!==T.state&&(k.state=T.state),k.is_processing!==T.is_processing&&(k.is_processing=T.is_processing),k.latest_message!==T.latest_message&&(k.latest_message=T.latest_message,k.latest_message_type=T.latest_message_type,k.latest_message_time=T.latest_message_time))}}},{deep:!0}),de(()=>r.commsByLegion.get(e.projectId),E=>{if(E&&E.length>0){const N=E[E.length-1];A(N)}},{deep:!0}),de(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(E,N)=>{E!==N&&P()})}),de(()=>e.projectId,E=>{o.selectProject(E),i.currentSessionId=null,P(),r.setCurrentLegion(E),l.connectLegion(E)}),Ce(()=>{_&&_()}),(E,N)=>(m(),p("div",Tg,[n("div",xg,[n("div",Ag,[n("div",null,[n("h4",Mg,[g.value?(m(),p("span",Og,"ðŸ›")):M("",!0),ee(" "+w(b.value?.name||"Project Overview"),1)]),n("small",Dg,w(b.value?.working_directory),1)]),n("div",Ng,[n("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:U}," âœï¸ Edit "),n("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session",onClick:S}," âž• "+w(g.value?"Add Minion":"Add Session"),9,Lg)])])]),n("div",Ig,[f.value?(m(),p("div",jg,[...N[0]||(N[0]=[n("div",{class:"spinner-border",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1),n("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):v.value?(m(),p("div",Pg,w(v.value),1)):b.value?(m(),p("div",Wg,[n("div",Hg,[n("div",Vg,[n("div",Fg,[n("div",Bg,[N[2]||(N[2]=n("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),n("h3",Ug,w(u.value),1),n("small",qg,w(d.value)+" active",1)])])]),n("div",zg,[n("div",Kg,[n("div",Gg,[N[3]||(N[3]=n("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),n("h3",Yg,[n("span",{class:X(x.value)},w(C.value),3)]),n("small",Jg,w(O.value),1)])])])]),g.value?(m(),p("div",Xg,[N[4]||(N[4]=n("div",{class:"card-header"},[n("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),n("div",{class:"card-body"},[n("div",{class:"d-flex gap-2 flex-wrap"},[n("button",{class:"btn btn-outline-primary",onClick:K}," ðŸ“Š View Timeline ")])])])):M("",!0),n("div",Qg,[n("div",Zg,[n("h5",eb,"ðŸŒ³ "+w(g.value?"Minion Hierarchy":"Sessions"),1),n("span",tb,w(y.value.length),1)]),n("div",sb,[$.value?(m(),p("div",nb,[...N[5]||(N[5]=[n("div",{class:"spinner-border spinner-border-sm",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1),n("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!c.value||!c.value.children||c.value.children.length===0?(m(),p("div",ob,' No sessions yet. Click "Add Session" to create one. ')):(m(),p("div",ib,[n("div",ab,[n("div",rb,[n("div",lb,[N[6]||(N[6]=n("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),n("strong",null,w(c.value.name),1),n("span",cb,w(c.value.children.length)+" "+w(c.value.children.length===1?"minion":"minions"),1)]),n("div",ub,[c.value.last_comm?(m(),p("div",db,[n("span",mb,[N[7]||(N[7]=ee(" â†’ ",-1)),n("strong",null,w(D(c.value.last_comm)),1),N[8]||(N[8]=ee(": ",-1))]),n("span",{class:"comm-content",title:c.value.last_comm.content||""},w(F(c.value.last_comm)),9,pb)])):(m(),p("div",fb," No communications yet "))])])]),n("div",vb,[(m(!0),p(re,null,ue(c.value.children,T=>(m(),ye(ui,{key:T.id,"minion-data":T,level:1,layout:"two-column",onMinionClick:L},null,8,["minion-data"]))),128))])]))])]),n("div",hb,[N[12]||(N[12]=n("div",{class:"card-header"},[n("h5",{class:"mb-0"},"Configuration")],-1)),n("div",_b,[n("dl",gb,[N[9]||(N[9]=n("dt",{class:"col-sm-4"},"Working Directory",-1)),n("dd",bb,w(b.value.working_directory),1),N[10]||(N[10]=n("dt",{class:"col-sm-4"},"Project ID",-1)),n("dd",yb,w(b.value.project_id),1),N[11]||(N[11]=n("dt",{class:"col-sm-4"},"Legion Mode",-1)),n("dd",wb,w(g.value?"Yes (has minions)":"No"),1)])])])])):(m(),p("div",Rg,[...N[1]||(N[1]=[n("h5",{class:"text-muted"},"Project not found",-1),n("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),n("div",$b,[N[13]||(N[13]=n("small",{class:"text-muted"}," Project Overview ",-1)),n("small",Eb,w(u.value)+" session"+w(u.value!==1?"s":""),1)])]))}},Cb=te(Sb,[["__scopeId","data-v-168bf04c"]]),kb=[{path:"/",name:"home",component:wi},{path:"/project/:projectId",name:"project",component:Cb,props:!0},{path:"/session/:sessionId",name:"session",component:i_,props:!0},{path:"/timeline/:legionId",name:"timeline",component:X_,props:!0}],Tb=fi({history:vi(),routes:kb}),xb={class:"connection-indicators"},Ab=["title"],Mb=["title"],Ob=["title"],Db={__name:"ConnectionIndicator",setup(s){const e=Je();function t(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:r,retryCount:l}=a[i];return l>0&&!r?"indicator-connecting":r?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},r={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},l={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:f,retryCount:v}=l[i];let c="Disconnected";return f?c="Connected":v>0&&(c=`Reconnecting (attempt ${v})`),`${a[i]}
${r[i]}
Status: ${c}`}return(i,a)=>(m(),p("div",xb,[n("div",{class:X(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,Ab),n("div",{class:X(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,Mb),n("div",{class:X(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,Ob)]))}},Nb=te(Db,[["__scopeId","data-v-d35b07c8"]]),Lb={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Ib={class:"d-flex align-items-center gap-2"},jb={__name:"AppHeader",setup(s){const e=fe();function t(){e.toggleSidebar()}return(o,i)=>(m(),p("header",Lb,[n("div",{class:"d-flex align-items-center gap-2"},[n("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[n("span",null,"â˜°",-1)])]),i[1]||(i[1]=n("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),n("div",Ib,[me(Nb)])]))}},Pb={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Rb={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Wb=["title"],Hb={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(s){const e=s,t=h(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(l){return l.state==="paused"&&l.is_processing?"pending-prompt":l.is_processing?"processing":l.state}function i(l){const f=o(l);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[f]||"#d3d3d3"}function a(l){const f=o(l);return f==="starting"||f==="processing"||f==="pending-prompt"}function r(l){const f=o(l),v=f.charAt(0).toUpperCase()+f.slice(1),c=l.name||"Unnamed Session",$=l.role?` (${l.role})`:"";return`${c}${$}: ${v}`}return(l,f)=>(m(),p("div",Pb,[!s.sessions||s.sessions.length===0?(m(),p("div",Rb)):(m(!0),p(re,{key:1},ue(s.sessions,v=>(m(),p("div",{key:v.session_id,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":a(v)}]),style:vt({width:t.value,backgroundColor:i(v),cursor:"help"}),title:r(v)},null,14,Wb))),128))]))}},Vb=te(Hb,[["__scopeId","data-v-391d77c1"]]),Fb=["data-project-id"],Bb=["id"],Ub=["aria-expanded","aria-controls","aria-label","onKeydown"],qb=["aria-label","onKeydown"],zb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Kb={class:"fw-semibold",style:{"flex-shrink":"0"}},Gb={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Yb={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Jb=["title"],Xb=["title"],Qb=["id","aria-labelledby"],Zb={class:"accordion-body p-0"},ey={class:"list-group list-group-flush"},ty={class:"minion-hierarchy-container"},sy={key:0,class:"text-center py-2"},ny={key:2,class:"text-muted text-center py-2 small"},oy={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(s){const e=s,t=Lt(),o=Le(),i=ae(),a=fe(),r=I(e.project.is_expanded||!1),l=I(null),f=I(!1);let v=null;const c=h(()=>o.formatPath(e.project.working_directory)),$=h(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(S=>i.getSession(S)).filter(S=>S!=null)),_=h(()=>$.value.length>0),b=h(()=>{const S=t.currentRoute.value;return S.name==="timeline"&&S.params.legionId===e.project.project_id}),y=h(()=>{const S=t.currentRoute.value;return S.name==="project"&&S.params.projectId===e.project.project_id});function g(S){const E=window.bootstrap;if(!E)return;const N=document.getElementById(`collapse-${e.project.project_id}`);if(!N)return;E.Collapse.getOrCreateInstance(N).toggle(),r.value=!r.value}function u(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function d(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function C(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const S=i.currentSessionId;S&&i.getSession(S)&&e.project.session_ids?.includes(S)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function x(){a.showModal("edit-project",{project:e.project})}function O(){a.showModal("create-minion",{project:e.project})}function P(){t.push(`/timeline/${e.project.project_id}`)}async function H(){f.value=!0;try{const S=await oe.get(`/api/legions/${e.project.project_id}/hierarchy`);l.value=S}catch(S){console.error("Failed to load minion hierarchy:",S),l.value=null}finally{f.value=!1}}function D(S){t.push(`/session/${S}`)}function F(S,E){if(S&&S.id===E)return S;if(S&&S.children)for(const N of S.children){const T=F(N,E);if(T)return T}return null}de(r,S=>{S&&H()}),_e(()=>{v=de(()=>i.sessions,S=>{if(!(!l.value||!r.value)){for(const[E,N]of S)if(N.project_id===e.project.project_id){const T=F(l.value,E);T&&T.type==="minion"&&(T.state!==N.state&&(T.state=N.state),T.is_processing!==N.is_processing&&(T.is_processing=N.is_processing),T.latest_message!==N.latest_message&&(T.latest_message=N.latest_message,T.latest_message_type=N.latest_message_type,T.latest_message_time=N.latest_message_time))}}},{deep:!0}),de(()=>i.sessions.size,(S,E)=>{if(r.value&&(S>E&&Array.from(i.sessions.values()).some(k=>k.project_id===e.project.project_id&&(!l.value||!F(l.value,k.session_id)))&&(console.log("New minion detected, reloading hierarchy"),H()),S<E&&l.value)){const N=i.sessions,T=k=>k.type==="minion"&&!N.has(k.id)?!0:k.children?k.children.some(j=>T(j)):!1;T(l.value)&&(console.log("Minion deletion detected, reloading hierarchy"),H())}}),r.value&&H()}),Ce(()=>{v&&v()});function A(S){S.dataTransfer.effectAllowed="move",S.dataTransfer.setData("application/project-id",e.project.project_id),S.dataTransfer.setData("text/plain",e.project.project_id),S.target.classList.add("dragging")}function L(S){S.target.classList.remove("dragging")}function K(S){S.preventDefault(),S.dataTransfer.dropEffect="move";const E=S.currentTarget.getBoundingClientRect(),N=E.top+E.height/2;S.clientY<N?(S.currentTarget.classList.add("drop-above"),S.currentTarget.classList.remove("drop-below")):(S.currentTarget.classList.add("drop-below"),S.currentTarget.classList.remove("drop-above"))}function U(S){S.preventDefault(),S.currentTarget.classList.remove("drop-above","drop-below");const E=S.dataTransfer.getData("application/project-id")||S.dataTransfer.getData("text/plain");if(!E||E===e.project.project_id)return;const N=S.currentTarget.getBoundingClientRect(),T=N.top+N.height/2,k=S.clientY<T,j=o.orderedProjects,z=j.findIndex(pe=>pe.project_id===e.project.project_id),Y=j.findIndex(pe=>pe.project_id===E);if(z===-1||Y===-1)return;const J=[...j],[ce]=J.splice(Y,1);let le=k?z:z+1;Y<z&&le--,J.splice(le,0,ce);const ie=J.map(pe=>pe.project_id);o.reorderProjects(ie)}return(S,E)=>(m(),p("div",{class:"accordion-item border rounded mb-2","data-project-id":s.project.project_id,draggable:"true",onDragstart:A,onDragend:L,onDragover:K,onDrop:U},[n("h2",{class:"accordion-header",id:`heading-${s.project.project_id}`},[n("div",{class:X(["accordion-button bg-white p-2 project-header-split",{collapsed:!r.value,"project-selected":y.value}])},[n("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":r.value,"aria-controls":`collapse-${s.project.project_id}`,"aria-label":r.value?"Collapse session list":"Expand session list",onClick:ve(g,["stop"]),onKeydown:[Ve(ve(g,["prevent"]),["enter"]),Ve(ve(g,["prevent"]),["space"])]},[(m(),p("svg",{class:X(["chevron-icon",{expanded:r.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...E[0]||(E[0]=[n("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,Ub),n("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${s.project.name} overview`,onClick:u,onKeydown:[Ve(ve(u,["prevent"]),["enter"]),Ve(ve(u,["prevent"]),["space"])]},[n("div",zb,[n("div",Kb,[_.value?(m(),p("span",Gb,"ðŸ›")):M("",!0),ee(" "+w(s.project.name),1)]),n("div",Yb,[n("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ve(x,["stop"])}," âœï¸ "),n("button",{class:"btn btn-sm btn-outline-primary",title:_.value?"Create minion":"Add session or minion",type:"button",onClick:ve(O,["stop"])}," âž• ",8,Jb)])]),n("small",{class:"text-muted font-monospace",title:s.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},w(c.value),9,Xb)],40,qb)],2)],8,Bb),me(Vb,{project:s.project,sessions:$.value},null,8,["project","sessions"]),n("div",{id:`collapse-${s.project.project_id}`,class:X(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${s.project.project_id}`,onShown:d,onHidden:C},[n("div",Zb,[n("div",ey,[_.value?(m(),p("div",{key:0,class:X(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:b.value}]),style:{cursor:"pointer"},onClick:P},[...E[1]||(E[1]=[n("div",{class:"flex-grow-1"},[n("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),n("span",{class:"fw-semibold"},"Timeline"),n("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):M("",!0),n("div",ty,[f.value?(m(),p("div",sy,[...E[2]||(E[2]=[n("div",{class:"spinner-border spinner-border-sm",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value&&l.value.children&&l.value.children.length>0?(m(!0),p(re,{key:1},ue(l.value.children,N=>(m(),ye(ui,{key:N.id,"minion-data":N,level:0,layout:"sidebar",onMinionClick:D},null,8,["minion-data"]))),128)):(m(),p("div",ny," No sessions "))])])])],42,Qb)],40,Fb))}},iy=te(oy,[["__scopeId","data-v-a15b34e8"]]),ay={class:"project-list"},ry={key:0,class:"text-muted text-center py-3"},ly={__name:"ProjectList",setup(s){const e=Le(),t=h(()=>e.orderedProjects);return(o,i)=>(m(),p("div",ay,[t.value.length===0?(m(),p("div",ry,' No projects yet. Click "New" to create one. ')):M("",!0),(m(!0),p(re,null,ue(t.value,a=>(m(),ye(iy,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},cy={class:"flex-grow-1 overflow-auto p-3"},uy={id:"sessions-container"},dy={__name:"Sidebar",setup(s){const e=fe(),t=h(()=>e.sidebarCollapsed),o=h(()=>e.isMobile),i=h(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const r=I(!1);function l(c){r.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",v)}function f(c){r.value&&e.setSidebarWidth(c.clientX)}function v(){r.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",v)}return(c,$)=>(m(),p("aside",{id:"sidebar",class:X(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:vt(i.value)},[n("div",cy,[n("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=n("h6",{class:"text-muted mb-0"},"Projects",-1)),n("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),n("div",uy,[me(ly)])]),n("div",{class:"sidebar-resize-handle",onMousedown:l},null,32)],6))}},my=te(dy,[["__scopeId","data-v-d792f0f0"]]),py={class:"modal-dialog modal-lg"},fy={class:"modal-content"},vy={class:"modal-body"},hy={class:"mb-3"},_y={class:"input-group"},gy=["disabled"],by={key:0,class:"text-center py-4"},yy={key:1,class:"alert alert-danger",role:"alert"},wy={key:2,class:"folder-list"},$y=["onClick","onDblclick"],Ey={class:"d-flex align-items-center flex-grow-1"},Sy=["onClick"],Cy={key:1,class:"text-center text-muted py-3"},ky={class:"modal-footer"},Ty=["disabled"],xy={__name:"FolderBrowserModal",setup(s){const e=fe(),t=I(""),o=I(""),i=I([]),a=I(!1),r=I(""),l=I(null);let f=null,v=null;const c=h(()=>{if(!t.value)return null;const x=t.value.split(/[\\/]/).filter(Boolean);return x.length<=1?null:(x.pop(),x.length>0?"/"+x.join("/"):"/")});function $(x){if(!x)return"";const O=x.split(/[\\/]/).filter(Boolean);return O.length<=2?x:".../"+O.slice(-2).join("/")}async function _(){a.value=!0,r.value="",i.value=[],o.value="";try{const x=t.value?{path:t.value}:{},O=await oe.get("/api/filesystem/browse",{params:x});O.current_path&&(t.value=O.current_path),i.value=O.directories||[]}catch(x){console.error("Failed to load directory:",x),r.value=x.message||"Failed to load directory"}finally{a.value=!1}}function b(x){o.value=x.path}function y(x){t.value=x.path,o.value="",_()}function g(){c.value&&(t.value=c.value,o.value="",_())}function u(){const x=o.value||t.value;x&&v&&v(x),f&&f.hide()}function d(){_()}function C(){i.value=[],o.value="",r.value="",v=null,e.hideModal()}return de(()=>e.currentModal,x=>{if(x?.name==="folder-browser"&&f){const O=x.data||{};t.value=O.defaultPath||O.currentPath||"",v=O.onSelect||null,f.show()}}),_e(()=>{l.value&&Ae(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(O=>O.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{f=new x(l.value),l.value.addEventListener("shown.bs.modal",d),l.value.addEventListener("hidden.bs.modal",C)})}),Ce(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",d),l.value.removeEventListener("hidden.bs.modal",C)),f&&f.dispose()}),(x,O)=>(m(),p("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[n("div",py,[n("div",fy,[O[6]||(O[6]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",vy,[n("div",hy,[O[1]||(O[1]=n("label",{class:"form-label"},"Current Path:",-1)),n("div",_y,[he(n("input",{type:"text",class:"form-control","onUpdate:modelValue":O[0]||(O[0]=P=>t.value=P),onKeyup:Ve(_,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Pe,t.value]]),n("button",{class:"btn btn-outline-secondary",onClick:_,disabled:a.value}," ðŸ”„ Refresh ",8,gy)])]),a.value?(m(),p("div",by,[...O[2]||(O[2]=[n("div",{class:"spinner-border",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(m(),p("div",yy,w(r.value),1)):(m(),p("div",wy,[c.value?(m(),p("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:g,role:"button"},[...O[3]||(O[3]=[n("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),n("span",{class:"text-secondary"},"..",-1)])])):M("",!0),(m(!0),p(re,null,ue(i.value,P=>(m(),p("div",{key:P.path,class:X(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:P.path===o.value}]),onClick:H=>b(P),onDblclick:H=>y(P),role:"button"},[n("div",Ey,[O[4]||(O[4]=n("span",{class:"me-2"},"ðŸ“",-1)),n("span",null,w(P.name),1)]),n("button",{class:"btn btn-sm btn-outline-primary",onClick:ve(H=>y(P),["stop"])}," Open ",8,Sy)],42,$y))),128)),i.value.length===0?(m(),p("div",Cy," No subdirectories found ")):M("",!0)]))]),n("div",ky,[O[5]||(O[5]=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),n("button",{type:"button",class:"btn btn-primary",onClick:u,disabled:!o.value},' Select "'+w($(o.value||t.value))+'" ',9,Ty)])])])],512))}},Ay=te(xy,[["__scopeId","data-v-0d61ed46"]]),My={class:"modal-dialog"},Oy={class:"modal-content"},Dy={class:"modal-body"},Ny={class:"mb-3"},Ly={key:0,class:"invalid-feedback"},Iy={class:"mb-3"},jy={class:"input-group"},Py={key:0,class:"invalid-feedback"},Ry={class:"mb-3 form-check"},Wy={key:0,class:"mb-3 ms-4"},Hy={key:1,class:"alert alert-danger",role:"alert"},Vy={class:"modal-footer"},Fy=["disabled"],By={key:0,class:"spinner-border spinner-border-sm me-2"},Uy={__name:"ProjectCreateModal",setup(s){const e=Le(),t=ae(),o=fe(),i=I({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),a=I({name:"",workingDirectory:""}),r=I(!1),l=I(""),f=I(null);let v=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:u=>{i.value.workingDirectory=u,a.value.workingDirectory=""}})}function $(){a.value={};let u=!0;return i.value.name.trim()||(a.value.name="Project name is required",u=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",u=!1),u}async function _(){if($()){r.value=!0,l.value="";try{const u=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(u.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),v&&v.hide(),b()}catch(u){console.error("Failed to create project:",u),l.value=u.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function b(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},a.value={},l.value=""}function y(){const u=document.getElementById("projectName");u&&u.focus()}function g(){b(),o.hideModal()}return de(()=>o.currentModal,u=>{u?.name==="create-project"&&v&&v.show()}),_e(()=>{f.value&&Ae(async()=>{const{default:u}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:u}},__vite__mapDeps([0,1])).then(({default:u})=>{v=new u(f.value),f.value.addEventListener("shown.bs.modal",y),f.value.addEventListener("hidden.bs.modal",g)})}),Ce(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",y),f.value.removeEventListener("hidden.bs.modal",g)),v&&v.dispose()}),(u,d)=>(m(),p("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[n("div",My,[n("div",Oy,[d[11]||(d[11]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",Dy,[n("form",{onSubmit:ve(_,["prevent"])},[n("div",Ny,[d[4]||(d[4]=n("label",{for:"projectName",class:"form-label"},"Project Name",-1)),he(n("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":d[0]||(d[0]=C=>i.value.name=C),placeholder:"My Project",required:""},null,2),[[Pe,i.value.name]]),a.value.name?(m(),p("div",Ly,w(a.value.name),1)):M("",!0)]),n("div",Iy,[d[5]||(d[5]=n("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),n("div",jy,[he(n("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":d[1]||(d[1]=C=>i.value.workingDirectory=C),placeholder:"/path/to/project",required:""},null,2),[[Pe,i.value.workingDirectory]]),n("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(m(),p("div",Py,w(a.value.workingDirectory),1)):M("",!0)]),d[6]||(d[6]=n("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),n("div",Ry,[he(n("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":d[2]||(d[2]=C=>i.value.createSession=C)},null,512),[[hi,i.value.createSession]]),d[7]||(d[7]=n("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),d[8]||(d[8]=n("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(m(),p("div",Wy,[d[9]||(d[9]=n("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),he(n("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":d[3]||(d[3]=C=>i.value.sessionName=C),placeholder:"main"},null,512),[[Pe,i.value.sessionName]])])):M("",!0),l.value?(m(),p("div",Hy,w(l.value),1)):M("",!0)],32)]),n("div",Vy,[d[10]||(d[10]=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),n("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:r.value},[r.value?(m(),p("span",By)):M("",!0),ee(" "+w(r.value?"Creating...":"Create Project"),1)],8,Fy)])])])],512))}},qy=te(Uy,[["__scopeId","data-v-ea55fdae"]]),zy={class:"modal-dialog"},Ky={class:"modal-content"},Gy={class:"modal-body"},Yy={class:"mb-3"},Jy={key:0,class:"invalid-feedback"},Xy={class:"mb-3"},Qy=["value"],Zy={key:0,class:"alert alert-danger",role:"alert"},ew={class:"danger-zone"},tw={class:"text-muted small"},sw=["disabled"],nw={key:0,class:"alert alert-warning mt-3",role:"alert"},ow={class:"mb-2"},iw={class:"d-flex gap-2"},aw=["disabled"],rw={key:0,class:"spinner-border spinner-border-sm me-2"},lw=["disabled"],cw={class:"modal-footer"},uw=["disabled"],dw={key:0,class:"spinner-border spinner-border-sm me-2"},mw={__name:"ProjectEditModal",setup(s){const e=Le(),t=fe(),o=I(null),i=I({name:""}),a=I({name:""}),r=I(!1),l=I(!1),f=I(""),v=I(!1),c=I(null);let $=null;const _=h(()=>o.value?.session_ids?.length||0);function b(){a.value={};let x=!0;return i.value.name.trim()||(a.value.name="Project name is required",x=!1),x}async function y(){if(!(!b()||!o.value)){r.value=!0,f.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(x){console.error("Failed to update project:",x),f.value=x.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function g(){if(o.value){l.value=!0,f.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(x){console.error("Failed to delete project:",x),f.value=x.message||"Failed to delete project. Please try again."}finally{l.value=!1}}}function u(){i.value={name:""},a.value={},f.value="",v.value=!1}function d(){const x=document.getElementById("editProjectName");x&&(x.focus(),x.select())}function C(){u(),o.value=null,t.hideModal()}return de(()=>t.currentModal,x=>{if(x?.name==="edit-project"&&$){const O=x.data||{};o.value=O.project,o.value&&(i.value.name=o.value.name),$.show()}}),_e(()=>{c.value&&Ae(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(O=>O.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{$=new x(c.value),c.value.addEventListener("shown.bs.modal",d),c.value.addEventListener("hidden.bs.modal",C)})}),Ce(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",d),c.value.removeEventListener("hidden.bs.modal",C)),$&&$.dispose()}),(x,O)=>(m(),p("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[n("div",zy,[n("div",Ky,[O[10]||(O[10]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",Gy,[n("form",{onSubmit:ve(y,["prevent"])},[n("div",Yy,[O[3]||(O[3]=n("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),he(n("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":O[0]||(O[0]=P=>i.value.name=P),placeholder:"My Project",required:""},null,2),[[Pe,i.value.name]]),a.value.name?(m(),p("div",Jy,w(a.value.name),1)):M("",!0)]),n("div",Xy,[O[4]||(O[4]=n("label",{class:"form-label"},"Working Directory",-1)),n("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Qy),O[5]||(O[5]=n("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),f.value?(m(),p("div",Zy,w(f.value),1)):M("",!0)],32),O[8]||(O[8]=n("hr",null,null,-1)),n("div",ew,[O[6]||(O[6]=n("h6",{class:"text-danger"},"Danger Zone",-1)),n("p",tw," Deleting this project will also delete all "+w(_.value)+" session(s) and their data. This action cannot be undone. ",1),n("button",{type:"button",class:"btn btn-outline-danger",onClick:O[1]||(O[1]=P=>v.value=!0),disabled:l.value}," ðŸ—‘ï¸ Delete Project ",8,sw)]),v.value?(m(),p("div",nw,[O[7]||(O[7]=n("strong",null,"Are you sure?",-1)),n("p",ow,' This will permanently delete the project "'+w(o.value?.name)+'" and all '+w(_.value)+" session(s). ",1),n("div",iw,[n("button",{type:"button",class:"btn btn-danger btn-sm",onClick:g,disabled:l.value},[l.value?(m(),p("span",rw)):M("",!0),ee(" "+w(l.value?"Deleting...":"Yes, Delete Permanently"),1)],8,aw),n("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:O[2]||(O[2]=P=>v.value=!1),disabled:l.value}," Cancel ",8,lw)])])):M("",!0)]),n("div",cw,[O[9]||(O[9]=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),n("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:r.value},[r.value?(m(),p("span",dw)):M("",!0),ee(" "+w(r.value?"Saving...":"Save Changes"),1)],8,uw)])])])],512))}},pw=te(mw,[["__scopeId","data-v-52679516"]]),fw={class:"general-tab"},vw={key:0,class:"mb-3"},hw={for:"template-select",class:"form-label"},_w=["value"],gw=["value"],bw={key:0,class:"form-text"},yw={class:"mb-3"},ww={for:"config-name",class:"form-label"},$w=["value","placeholder","pattern","title"],Ew={key:0,class:"invalid-feedback"},Sw={key:1,class:"form-text"},Cw={key:1,class:"mb-3"},kw=["value"],Tw={class:"mb-3"},xw=["value"],Aw={class:"form-text"},Mw={key:0,class:"text-warning"},Ow={key:1},Dw={class:"mb-3"},Nw={for:"config-permission-mode",class:"form-label"},Lw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Iw={key:1,class:"field-indicator modified",title:"Modified from template"},jw=["value","disabled"],Pw={key:0,value:"bypassPermissions"},Rw={class:"form-text"},Ww={key:0,class:"text-warning"},Hw={key:1},Vw={class:"mb-3"},Fw={for:"config-role",class:"form-label"},Bw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Uw={key:1,class:"field-indicator modified",title:"Modified from template"},qw=["value","placeholder"],zw={class:"form-text"},Kw={key:2,class:"mb-3"},Gw={class:"input-group"},Yw=["value","placeholder","disabled","readonly"],Jw={class:"form-text"},Xw={key:3,class:"mb-3"},Qw={class:"form-control-plaintext"},Zw={key:4,class:"mb-3 form-check"},e$=["checked"],t$={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(s){const e=s,t=h(()=>e.mode==="create-session"||e.mode==="edit-session"),o=h(()=>e.mode==="create-template"||e.mode==="edit-template"),i=h(()=>e.mode==="create-session"),a=h(()=>e.mode==="edit-session"),r=h(()=>e.session?.state==="active"||e.session?.state==="starting"),l=h(()=>{if(!e.session)return!1;const g=e.session.model||"sonnet";return e.formData.model!==g}),f=h(()=>e.session?.initial_permission_mode==="bypassPermissions"),v=h(()=>e.selectedTemplateId?e.templates.find(g=>g.template_id===e.selectedTemplateId):null),c={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},$=h(()=>c[e.formData.model]||null),_=h(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),b=h(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function y(g){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[g]||"bg-secondary"}return(g,u)=>(m(),p("div",fw,[i.value?(m(),p("div",vw,[n("label",hw,[u[10]||(u[10]=ee(" Template ",-1)),n("button",{type:"button",onClick:u[0]||(u[0]=d=>g.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),n("select",{id:"template-select",value:s.selectedTemplateId,onChange:u[1]||(u[1]=d=>g.$emit("update:selected-template-id",d.target.value||null)),class:"form-select"},[u[11]||(u[11]=n("option",{value:null},"[None - Manual Configuration]",-1)),(m(!0),p(re,null,ue(s.templates,d=>(m(),p("option",{key:d.template_id,value:d.template_id},w(d.name),9,gw))),128))],40,_w),v.value?(m(),p("div",bw,w(v.value.description),1)):M("",!0)])):M("",!0),n("div",yw,[n("label",ww,[ee(w(o.value?"Template Name":"Session Name")+" ",1),u[12]||(u[12]=n("span",{class:"text-danger"},"*",-1))]),n("input",{id:"config-name",type:"text",class:X(["form-control",{"is-invalid":s.errors.name}]),value:s.formData.name,onInput:u[2]||(u[2]=d=>g.$emit("update:form-data","name",d.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,$w),s.errors.name?(m(),p("div",Ew,w(s.errors.name),1)):M("",!0),t.value?(m(),p("div",Sw,"Must be a single word (no spaces) for #nametag matching")):M("",!0)]),o.value?(m(),p("div",Cw,[u[13]||(u[13]=n("label",{for:"config-description",class:"form-label"},"Description",-1)),n("textarea",{id:"config-description",class:"form-control",value:s.formData.description,onInput:u[3]||(u[3]=d=>g.$emit("update:form-data","description",d.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,kw)])):M("",!0),n("div",Tw,[u[16]||(u[16]=n("label",{for:"config-model",class:"form-label"},"Model",-1)),n("select",{id:"config-model",class:"form-select",value:s.formData.model,onChange:u[4]||(u[4]=d=>g.$emit("update:form-data","model",d.target.value))},[...u[14]||(u[14]=[n("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),n("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),n("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),n("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,xw),n("div",Aw,[a.value&&r.value&&l.value?(m(),p("span",Mw,[...u[15]||(u[15]=[ee(" Model change requires a ",-1),n("strong",null,"reset",-1),ee(" (not restart) to take effect. ",-1)])])):$.value?(m(),p("span",Ow,w($.value.description),1)):M("",!0)])]),n("div",Dw,[n("label",Nw,[u[17]||(u[17]=ee(" Permission Mode ",-1)),s.fieldStates.permission_mode==="autofilled"?(m(),p("span",Lw," < ")):M("",!0),s.fieldStates.permission_mode==="modified"?(m(),p("span",Iw," * ")):M("",!0)]),n("select",{id:"config-permission-mode",class:X(["form-select",b.value]),value:s.formData.permission_mode,onChange:u[5]||(u[5]=d=>g.$emit("update:form-data","permission_mode",d.target.value)),disabled:a.value&&!r.value},[u[18]||(u[18]=n("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),u[19]||(u[19]=n("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),u[20]||(u[20]=n("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!a.value||f.value?(m(),p("option",Pw," Bypass Permissions (No prompts - use with caution) ")):M("",!0)],42,jw),n("div",Rw,[a.value&&!r.value?(m(),p("span",Ww," Session must be active to change permission mode. Start the session first. ")):(m(),p("span",Hw,"Controls which tool actions require permission prompts"))])]),n("div",Vw,[n("label",Fw,[ee(w(o.value?"Default Role":"Role")+" ",1),s.fieldStates.default_role==="autofilled"?(m(),p("span",Bw," < ")):M("",!0),s.fieldStates.default_role==="modified"?(m(),p("span",Uw," * ")):M("",!0)]),n("input",{id:"config-role",type:"text",class:X(["form-control",_.value]),value:s.formData.default_role,onInput:u[6]||(u[6]=d=>g.$emit("update:form-data","default_role",d.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,qw),n("div",zw,w(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(m(),p("div",Kw,[u[21]||(u[21]=n("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),n("div",Gw,[n("input",{id:"config-working-dir",type:"text",class:"form-control",value:s.formData.working_directory,onInput:u[7]||(u[7]=d=>g.$emit("update:form-data","working_directory",d.target.value)),placeholder:a.value?"":"Leave empty to inherit from project",disabled:a.value,readonly:a.value},null,40,Yw),a.value?M("",!0):(m(),p("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:u[8]||(u[8]=d=>g.$emit("open-folder-browser"))}," Browse "))]),n("div",Jw,w(a.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):M("",!0),a.value&&s.session?(m(),p("div",Xw,[u[22]||(u[22]=n("label",{class:"form-label"},"Current State",-1)),n("div",Qw,[n("span",{class:X(["badge",y(s.session.state)])},w(s.session.state),3)])])):M("",!0),i.value?(m(),p("div",Zw,[n("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:s.formData.startImmediately,onChange:u[9]||(u[9]=d=>g.$emit("update:form-data","startImmediately",d.target.checked))},null,40,e$),u[23]||(u[23]=n("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):M("",!0)]))}},s$=te(t$,[["__scopeId","data-v-b9edc342"]]),n$={class:"permissions-tab"},o$={class:"mb-3"},i$={for:"config-allowed-tools",class:"form-label"},a$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},r$={key:1,class:"field-indicator modified",title:"Modified from template"},l$={key:0,class:"tools-list mb-2"},c$=["onClick"],u$={class:"input-group input-group-sm"},d$=["onKeydown"],m$=["disabled"],p$={class:"mt-2"},f$=["onClick"],v$={class:"form-text"},h$={key:0,class:"text-warning"},_$={key:1},g$={class:"mb-3"},b$={class:"capabilities-editor"},y$={key:0,class:"capabilities-list mb-2"},w$=["onClick"],$$={class:"input-group input-group-sm"},E$=["onKeydown"],S$=["disabled"],C$={class:"mb-3"},k$={key:0,class:"mt-2"},T$=["value"],x$=["value"],A$={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data"],setup(s,{emit:e}){const t=s,o=e,i=I(""),a=I(""),r=I(!1),l=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],f=h(()=>t.mode==="create-template"||t.mode==="edit-template"),v=h(()=>t.mode==="edit-session"),c=h(()=>t.session?.state==="active"||t.session?.state==="starting"),$=h(()=>{if(!t.session)return!1;const P=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==P}),_=h(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(P=>P.trim()).filter(P=>P.length>0)),b=h(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(P=>P.trim()).filter(P=>P.length>0)),y=h(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),g=h(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function u(){const P=i.value.trim();if(P){if(!_.value.includes(P)){const H=[..._.value,P];o("update:form-data","allowed_tools",H.join(", "))}i.value=""}}function d(P){const H=[..._.value];H.splice(P,1),o("update:form-data","allowed_tools",H.join(", "))}function C(P){if(_.value.includes(P)){const H=_.value.indexOf(P);d(H)}else{const H=[..._.value,P];o("update:form-data","allowed_tools",H.join(", "))}}function x(){const P=a.value.trim().toLowerCase();if(P){if(!b.value.includes(P)){const H=[...b.value,P];o("update:form-data","capabilities",H.join(", "))}a.value=""}}function O(P){const H=[...b.value];H.splice(P,1),o("update:form-data","capabilities",H.join(", "))}return(P,H)=>(m(),p("div",n$,[n("div",o$,[n("label",i$,[H[5]||(H[5]=ee(" Allowed Tools ",-1)),s.fieldStates.allowed_tools==="autofilled"?(m(),p("span",a$," < ")):M("",!0),s.fieldStates.allowed_tools==="modified"?(m(),p("span",r$," * ")):M("",!0)]),n("div",{class:X(["allowed-tools-editor",g.value])},[_.value.length>0?(m(),p("div",l$,[(m(!0),p(re,null,ue(_.value,(D,F)=>(m(),p("span",{key:F,class:"badge bg-primary me-1 mb-1 tool-badge"},[ee(w(D)+" ",1),n("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:A=>d(F),"aria-label":"Remove tool"},null,8,c$)]))),128))])):M("",!0),n("div",u$,[he(n("input",{type:"text",class:"form-control","onUpdate:modelValue":H[0]||(H[0]=D=>i.value=D),onKeydown:Ve(ve(u,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,d$),[[Pe,i.value]]),n("button",{type:"button",class:"btn btn-outline-primary",onClick:u,disabled:!i.value.trim()}," Add ",8,m$)]),n("div",p$,[H[6]||(H[6]=n("span",{class:"form-text me-2"},"Quick add:",-1)),(m(),p(re,null,ue(l,D=>n("button",{key:D,type:"button",class:X(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":_.value.includes(D)}]),onClick:F=>C(D)},w(D),11,f$)),64))])],2),n("div",v$,[v.value&&c.value&&$.value?(m(),p("span",h$,[...H[7]||(H[7]=[ee(" Allowed tools change requires a ",-1),n("strong",null,"reset",-1),ee(" (not restart) to take effect. ",-1)])])):(m(),p("span",_$,w(f.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),n("div",g$,[H[8]||(H[8]=n("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),n("div",b$,[b.value.length>0?(m(),p("div",y$,[(m(!0),p(re,null,ue(b.value,(D,F)=>(m(),p("span",{key:F,class:"badge bg-info me-1 mb-1 capability-badge"},[ee(w(D)+" ",1),n("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:A=>O(F),"aria-label":"Remove capability"},null,8,w$)]))),128))])):M("",!0),n("div",$$,[he(n("input",{type:"text",class:"form-control","onUpdate:modelValue":H[1]||(H[1]=D=>a.value=D),onKeydown:Ve(ve(x,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,E$),[[Pe,a.value]]),n("button",{type:"button",class:"btn btn-outline-info",onClick:x,disabled:!a.value.trim()}," Add ",8,S$)])]),H[9]||(H[9]=n("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),n("div",C$,[n("a",{class:"text-muted small",role:"button",onClick:H[2]||(H[2]=D=>r.value=!r.value)},w(r.value?"Hide":"Show")+" raw input ",1),r.value?(m(),p("div",k$,[H[10]||(H[10]=n("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),n("input",{type:"text",class:X(["form-control form-control-sm",y.value]),value:s.formData.allowed_tools,onInput:H[3]||(H[3]=D=>P.$emit("update:form-data","allowed_tools",D.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,T$),H[11]||(H[11]=n("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),n("input",{type:"text",class:"form-control form-control-sm",value:s.formData.capabilities,onInput:H[4]||(H[4]=D=>P.$emit("update:form-data","capabilities",D.target.value)),placeholder:"python, testing, debugging"},null,40,x$)])):M("",!0)])]))}},M$=te(A$,[["__scopeId","data-v-b39e7ddb"]]),O$={class:"advanced-tab"},D$={key:0,class:"alert alert-warning mb-3",role:"alert"},N$={class:"mb-3"},L$={for:"config-system-prompt",class:"form-label"},I$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},j$={key:1,class:"field-indicator modified",title:"Modified from template"},P$=["value","rows","maxlength","placeholder"],R$={class:"form-text d-flex justify-content-between"},W$={key:0,class:"invalid-feedback"},H$={class:"mb-3 form-check"},V$=["checked"],F$={key:0,class:"form-text text-warning"},B$={key:1,class:"mb-3 form-check"},U$=["checked"],q$={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(s,{emit:e}){const t=s,o=e,i=h(()=>t.mode==="create-session"||t.mode==="edit-session"),a=h(()=>t.mode==="create-template"||t.mode==="edit-template"),r=h(()=>t.mode==="edit-session"),l=h(()=>t.session?.state==="active"||t.session?.state==="starting"),f=h(()=>{if(!t.session)return!1;const C=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),x=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),O=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return C||x||O}),v=h(()=>a.value?6e3:2e3),c=h(()=>a.value?t.formData.system_prompt:t.formData.initialization_context),$=h(()=>c.value?.length||0),_=h(()=>$.value>v.value),b=h(()=>{const C=v.value*.9;return $.value>C&&$.value<=v.value}),y=h(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),g=h(()=>t.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),u=h(()=>{const C={};return _.value&&(C["is-invalid"]=!0),t.fieldStates.initialization_context==="autofilled"&&(C["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&(C["field-modified"]=!0),C});function d(C){const x=C.target.value,O=a.value?"system_prompt":"initialization_context";o("update:form-data",O,x)}return(C,x)=>(m(),p("div",O$,[r.value&&l.value&&f.value?(m(),p("div",D$,[...x[2]||(x[2]=[n("small",null,[ee("Changes to these settings require a "),n("strong",null,"reset"),ee(" (not restart) to take effect.")],-1)])])):M("",!0),n("div",N$,[n("label",L$,[ee(w(a.value?"Default System Prompt":"Initialization Context")+" ",1),s.fieldStates.initialization_context==="autofilled"?(m(),p("span",I$," < ")):M("",!0),s.fieldStates.initialization_context==="modified"?(m(),p("span",j$," * ")):M("",!0)]),n("textarea",{id:"config-system-prompt",class:X(["form-control",u.value]),value:c.value,onInput:d,rows:a.value?4:5,maxlength:v.value,placeholder:y.value},null,42,P$),n("div",R$,[n("span",null,w(g.value),1),n("span",{class:X({"text-danger":_.value,"text-warning":b.value})},w($.value)+" / "+w(v.value)+" chars ",3)]),_.value?(m(),p("div",W$,w(a.value?"System prompt":"Initialization context")+" exceeds "+w(v.value)+" character limit ",1)):M("",!0)]),n("div",H$,[n("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:s.formData.override_system_prompt,onChange:x[0]||(x[0]=O=>C.$emit("update:form-data","override_system_prompt",O.target.checked))},null,40,V$),x[3]||(x[3]=n("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),s.formData.override_system_prompt?(m(),p("div",F$,[n("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+w(a.value?"":" or legion guide")+").",1)])):M("",!0)]),i.value?(m(),p("div",B$,[n("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:s.formData.sandbox_enabled,onChange:x[1]||(x[1]=O=>C.$emit("update:form-data","sandbox_enabled",O.target.checked))},null,40,U$),x[4]||(x[4]=n("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),n("div",{class:X(["form-text",s.formData.sandbox_enabled?"text-info":"text-muted"])},[n("small",null,w(s.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):M("",!0)]))}},z$=te(q$,[["__scopeId","data-v-1909e7ae"]]),K$={class:"modal-dialog modal-lg modal-dialog-centered"},G$={class:"modal-content"},Y$={class:"modal-header"},J$={id:"configurationModalLabel",class:"modal-title"},X$={class:"modal-body"},Q$={key:0,class:"template-list-view"},Z$={key:0,class:"alert alert-info"},e1={class:"card-body"},t1={class:"d-flex justify-content-between align-items-start"},s1={class:"flex-grow-1"},n1={class:"card-title mb-1"},o1={key:0,class:"card-text text-muted small mb-2"},i1={class:"template-meta"},a1={class:"badge bg-secondary me-2"},r1={class:"text-muted small"},l1={class:"btn-group btn-group-sm ms-3"},c1=["onClick"],u1=["onClick"],d1={key:1},m1={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},p1={class:"nav-item",role:"presentation"},f1={key:0,class:"error-indicator",title:"This tab has validation errors"},v1={class:"nav-item",role:"presentation"},h1={key:0,class:"error-indicator",title:"This tab has validation errors"},_1={class:"nav-item",role:"presentation"},g1={key:0,class:"error-indicator",title:"This tab has validation errors"},b1={class:"tab-content"},y1={key:2,class:"alert alert-danger mt-3"},w1={class:"modal-footer"},$1={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},E1=["disabled"],S1={key:0,class:"spinner-border spinner-border-sm me-2"},C1={__name:"ConfigurationModal",setup(s){const e=Lt(),t=Le(),o=ae(),i=fe(),a=I(null);let r=null;const l=I("create-session"),f=I("general"),v=I(null),c=I(null),$=I(null),_=I([]),b=I(null),y=I(null),g=I({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),u=_s({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),d=_s({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),C=_s({name:"",system_prompt:"",initialization_context:""}),x=h(()=>({general:!!C.name,permissions:!1,advanced:!!C.system_prompt||!!C.initialization_context})),O=I(!1),P=I(""),H=h(()=>l.value==="create-session"||l.value==="edit-session"),D=h(()=>l.value==="edit-session"||l.value==="edit-template"),F=h(()=>{switch(l.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),A=h(()=>O.value?D.value?"Saving...":"Creating...":D.value?"Save Changes":H.value?"Create Session":"Save Template"),L=h(()=>!(!d.name.trim()||d.system_prompt.length>6e3||d.initialization_context.length>2e3||H.value&&d.name.includes(" ")));function K(R,se){d[R]=se,R==="name"&&(C.name=""),R==="system_prompt"&&(C.system_prompt=""),R==="initialization_context"&&(C.initialization_context="")}function U(R){b.value=R,E()}async function S(){try{const R=await oe.get("/api/templates");_.value=R||[]}catch(R){console.error("Failed to load templates:",R),_.value=[]}}function E(){if(!b.value){d.default_role="",d.initialization_context="",d.permission_mode="default",d.allowed_tools="",u.default_role="normal",u.initialization_context="normal",u.permission_mode="normal",u.allowed_tools="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const R=_.value.find(se=>se.template_id===b.value);if(R)if(u.default_role="normal",u.initialization_context="normal",u.permission_mode="normal",u.allowed_tools="normal",R.default_role?(d.default_role=R.default_role,g.value.default_role=R.default_role,u.default_role="autofilled"):(d.default_role="",g.value.default_role=null),R.default_system_prompt?(d.initialization_context=R.default_system_prompt,g.value.initialization_context=R.default_system_prompt,u.initialization_context="autofilled"):(d.initialization_context="",g.value.initialization_context=null),R.permission_mode?(d.permission_mode=R.permission_mode,g.value.permission_mode=R.permission_mode,u.permission_mode="autofilled"):(d.permission_mode="default",g.value.permission_mode=null),R.allowed_tools&&R.allowed_tools.length>0){const se=R.allowed_tools.join(", ");d.allowed_tools=se,g.value.allowed_tools=se,u.allowed_tools="autofilled"}else d.allowed_tools="",g.value.allowed_tools=null}function N(){const se=(v.value?t.projects.get(v.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:se,currentPath:d.working_directory||"",onSelect:ne=>{d.working_directory=ne}})}function T(){l.value==="create-session"&&(y.value={mode:"create-session",projectId:v.value,formData:{...d},selectedTemplateId:b.value}),l.value="template-list",B()}function k(){l.value="create-template",B(),f.value="general"}function j(R){l.value="edit-template",$.value=R,B(),V(R),f.value="general"}async function z(R){if(confirm(`Delete template "${R.name}"?

This action cannot be undone.`))try{await oe.delete(`/api/templates/${R.template_id}`),await S()}catch(se){console.error("Failed to delete template:",se),P.value=se.response?.data?.detail||"Failed to delete template"}}function Y(){let R=!0;return C.name="",C.system_prompt="",C.initialization_context="",d.name.trim()||(C.name="Name is required",R=!1),H.value&&d.name.includes(" ")&&(C.name="Session name must be a single word (no spaces)",R=!1),d.system_prompt.length>6e3&&(C.system_prompt="System prompt exceeds 6000 character limit",R=!1),d.initialization_context.length>2e3&&(C.initialization_context="Initialization context exceeds 2000 character limit",R=!1),R}async function J(){if(!Y()){C.name?f.value="general":(C.system_prompt||C.initialization_context)&&(f.value="advanced");return}O.value=!0,P.value="";try{switch(l.value){case"create-session":await ce(),r&&r.hide();break;case"edit-session":await le(),r&&r.hide();break;case"create-template":await ie();break;case"edit-template":await pe();break}}catch(R){console.error("Submit failed:",R),P.value=R.response?.data?.detail||R.message||"Operation failed. Please try again."}finally{O.value=!1}}async function ce(){if(!v.value)throw new Error("Project ID is missing");const R=d.allowed_tools.split(",").map(be=>be.trim()).filter(be=>be.length>0),se=d.capabilities.split(",").map(be=>be.trim()).filter(be=>be.length>0),ne={name:d.name.trim(),model:d.model||null,role:d.default_role.trim()||null,initialization_context:d.initialization_context.trim()||null,override_system_prompt:d.override_system_prompt,capabilities:se.length>0?se:null,permission_mode:d.permission_mode,allowed_tools:R.length>0?R:null,working_directory:d.working_directory.trim()||null,sandbox_enabled:d.sandbox_enabled},ge=await oe.post(`/api/legions/${v.value}/minions`,ne);if(ge.success&&ge.minion_id)await t.fetchProjects(),await o.fetchSessions(),d.startImmediately&&await o.startSession(ge.minion_id),e.push(`/session/${ge.minion_id}`);else throw new Error("Failed to create session")}async function le(){if(!c.value)throw new Error("Session data is missing");const R=c.value.session_id,se=c.value.state==="active"||c.value.state==="starting",ne=d.allowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),ge=d.capabilities.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),be={name:d.name.trim(),model:d.model,role:d.default_role.trim()||null,system_prompt:d.initialization_context.trim()||null,override_system_prompt:d.override_system_prompt,allowed_tools:ne.length>0?ne:null,capabilities:ge.length>0?ge:null,sandbox_enabled:d.sandbox_enabled};await o.patchSession(R,be),se&&d.permission_mode!==c.value.current_permission_mode&&await o.setPermissionMode(R,d.permission_mode)}async function ie(){const R=d.allowed_tools.split(",").map(ne=>ne.trim()).filter(ne=>ne.length>0),se={name:d.name.trim(),description:d.description.trim()||null,permission_mode:d.permission_mode,allowed_tools:R.length>0?R:null,default_role:d.default_role.trim()||null,default_system_prompt:d.initialization_context.trim()||null};await oe.post("/api/templates",se),await S(),l.value="template-list",B()}async function pe(){if(!$.value)throw new Error("Template data is missing");const R=d.allowed_tools.split(",").map(ne=>ne.trim()).filter(ne=>ne.length>0),se={name:d.name.trim(),description:d.description.trim()||null,permission_mode:d.permission_mode,allowed_tools:R.length>0?R:null,default_role:d.default_role.trim()||null,default_system_prompt:d.initialization_context.trim()||null};await oe.put(`/api/templates/${$.value.template_id}`,se),await S(),l.value="template-list",$.value=null,B()}function B(){d.name="",d.model="sonnet",d.permission_mode="default",d.working_directory="",d.description="",d.default_role="",d.startImmediately=!0,d.allowed_tools="",d.capabilities="",d.system_prompt="",d.override_system_prompt=!1,d.initialization_context="",d.sandbox_enabled=!1,C.name="",C.system_prompt="",C.initialization_context="",u.default_role="normal",u.initialization_context="normal",u.permission_mode="normal",u.allowed_tools="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},b.value=null,P.value="",f.value="general"}function W(R){d.name=R.name||"",d.model=R.model||"sonnet",d.permission_mode=R.current_permission_mode||"default",d.working_directory=R.working_directory||"",d.default_role=R.role||"",d.initialization_context=R.system_prompt||"",d.override_system_prompt=R.override_system_prompt||!1,d.system_prompt="",d.allowed_tools=R.allowed_tools?.join(", ")||"",d.capabilities=R.capabilities?.join(", ")||"",d.sandbox_enabled=R.sandbox_enabled||!1}function V(R){d.name=R.name||"",d.description=R.description||"",d.permission_mode=R.permission_mode||"default",d.default_role=R.default_role||"",d.initialization_context=R.default_system_prompt||"",d.allowed_tools=R.allowed_tools?.join(", ")||""}function G(){es(()=>{const R=document.getElementById("config-name");R&&(R.focus(),D.value&&R.select())})}function Z(){B(),l.value="create-session",v.value=null,c.value=null,$.value=null,i.hideModal()}return de(()=>i.currentModal,async(R,se)=>{if(!(!R||!r)){if(R.name==="configuration"){const ne=R.data||{};l.value=ne.mode||"create-session",v.value=ne.project?.project_id||ne.projectId||null,c.value=ne.session||null,$.value=ne.template||null,B(),l.value==="create-session"&&await S(),l.value==="edit-session"&&c.value?W(c.value):l.value==="edit-template"&&$.value&&V($.value),r.show()}else if(R.name==="create-minion"||R.name==="create-session"){const ne=R.data||{};l.value="create-session",v.value=ne.project?.project_id||null,c.value=null,$.value=null,B(),await S(),r.show()}else if(R.name==="edit-session"){const ne=R.data||{};l.value="edit-session",c.value=ne.session||null,v.value=c.value?.project_id||null,$.value=null,B(),c.value&&W(c.value),r.show()}else R.name==="template-management"&&(l.value="template-list",B(),await S(),r.show());se?.name==="configuration"&&se.data?.mode?.includes("template")&&R?.name==="configuration"&&l.value==="create-session"&&await S()}}),de(()=>d.default_role,R=>{g.value.default_role!==null&&(u.default_role=R===g.value.default_role?"autofilled":"modified")}),de(()=>d.initialization_context,R=>{g.value.initialization_context!==null&&(u.initialization_context=R===g.value.initialization_context?"autofilled":"modified")}),de(()=>d.permission_mode,R=>{g.value.permission_mode!==null&&(u.permission_mode=R===g.value.permission_mode?"autofilled":"modified")}),de(()=>d.allowed_tools,R=>{g.value.allowed_tools!==null&&(u.allowed_tools=R===g.value.allowed_tools?"autofilled":"modified")}),_e(()=>{a.value&&Ae(()=>import("./modal-D6mKceGM.js").then(R=>R.m),__vite__mapDeps([0,1])).then(R=>{const se=R.default;r=new se(a.value),a.value.addEventListener("shown.bs.modal",G),a.value.addEventListener("hidden.bs.modal",Z)})}),Ce(()=>{a.value&&(a.value.removeEventListener("shown.bs.modal",G),a.value.removeEventListener("hidden.bs.modal",Z)),r&&r.dispose()}),(R,se)=>(m(),p("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[n("div",K$,[n("div",G$,[n("div",Y$,[n("h5",J$,[l.value==="create-template"||l.value==="edit-template"?(m(),p("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:T,title:"Back to template list"}," â† ")):M("",!0),ee(" "+w(F.value),1)]),se[3]||(se[3]=n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),n("div",X$,[l.value==="template-list"?(m(),p("div",Q$,[n("div",{class:"d-flex justify-content-between align-items-center mb-3"},[se[4]||(se[4]=n("h6",{class:"mb-0"},"Templates",-1)),n("button",{onClick:k,class:"btn btn-primary btn-sm"}," + Create New ")]),_.value.length===0?(m(),p("div",Z$," No templates found. Create your first template! ")):M("",!0),(m(!0),p(re,null,ue(_.value,ne=>(m(),p("div",{key:ne.template_id,class:"card mb-2"},[n("div",e1,[n("div",t1,[n("div",s1,[n("h6",n1,w(ne.name),1),ne.description?(m(),p("p",o1,w(ne.description),1)):M("",!0),n("div",i1,[n("span",a1,w(ne.permission_mode),1),n("span",r1,w(ne.allowed_tools?.length||0)+" tools",1)])]),n("div",l1,[n("button",{onClick:ge=>j(ne),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,c1),n("button",{onClick:ge=>z(ne),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,u1)])])])]))),128))])):(m(),p("div",d1,[n("ul",m1,[n("li",p1,[n("button",{class:X(["nav-link",{active:f.value==="general","has-error":x.value.general}]),type:"button",onClick:se[0]||(se[0]=ne=>f.value="general")},[se[5]||(se[5]=ee(" General ",-1)),x.value.general?(m(),p("span",f1)):M("",!0)],2)]),n("li",v1,[n("button",{class:X(["nav-link",{active:f.value==="permissions","has-error":x.value.permissions}]),type:"button",onClick:se[1]||(se[1]=ne=>f.value="permissions")},[se[6]||(se[6]=ee(" Permissions ",-1)),x.value.permissions?(m(),p("span",h1)):M("",!0)],2)]),n("li",_1,[n("button",{class:X(["nav-link",{active:f.value==="advanced","has-error":x.value.advanced}]),type:"button",onClick:se[2]||(se[2]=ne=>f.value="advanced")},[se[7]||(se[7]=ee(" Advanced ",-1)),x.value.advanced?(m(),p("span",g1)):M("",!0)],2)])]),n("div",b1,[he(me(s$,{mode:l.value,"form-data":d,errors:C,templates:_.value,"selected-template-id":b.value,session:c.value,"field-states":u,"onUpdate:formData":K,"onUpdate:selectedTemplateId":U,onOpenFolderBrowser:N,onOpenTemplateManager:T},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[hs,f.value==="general"]]),he(me(M$,{mode:l.value,"form-data":d,errors:C,session:c.value,"field-states":u,"onUpdate:formData":K},null,8,["mode","form-data","errors","session","field-states"]),[[hs,f.value==="permissions"]]),he(me(z$,{mode:l.value,"form-data":d,errors:C,session:c.value,"field-states":u,"onUpdate:formData":K},null,8,["mode","form-data","errors","session","field-states"]),[[hs,f.value==="advanced"]])])])),P.value?(m(),p("div",y1,w(P.value),1)):M("",!0)]),n("div",w1,[n("button",$1,w(l.value==="template-list"?"Close":"Cancel"),1),l.value!=="template-list"?(m(),p("button",{key:0,type:"button",class:"btn btn-primary",disabled:O.value||!L.value,onClick:J},[O.value?(m(),p("span",S1)):M("",!0),ee(" "+w(A.value),1)],8,E1)):M("",!0)])])])],512))}},k1=te(C1,[["__scopeId","data-v-02e5aee7"]]),T1={class:"modal-dialog modal-dialog-centered"},x1={class:"modal-content"},A1={class:"modal-header"},M1={class:"modal-title",id:"manageSessionModalLabel"},O1={class:"modal-body"},D1={key:0,class:"text-center py-4"},N1={class:"text-muted"},L1={key:1},I1={key:2},j1={class:"text-muted"},P1={key:0,class:"text-center py-2"},R1={key:1,class:"alert alert-warning mt-3"},W1={class:"mb-0 mt-2"},H1={key:0,class:"text-muted"},V1={key:3},F1={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},B1={class:"d-grid gap-2"},U1=["disabled"],q1=["disabled"],z1=["disabled"],K1=["disabled"],G1={class:"modal-footer"},Y1={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},J1={__name:"SessionManageModal",setup(s){const e=Lt(),t=ae(),o=fe(),i=Je();Oe();const a=I(null),r=I(!1),l=I(""),f=I(""),v=I(null),c=I(null);let $=null;const _=I([]),b=I(!1),y=h(()=>v.value==="reset"?"Reset Session":v.value==="delete"?"Delete Session":"Manage Session");function g(){v.value="reset"}async function u(){if(v.value="delete",_.value=[],!!a.value){b.value=!0;try{const A=await oe.get(`/api/sessions/${a.value.session_id}/descendants`);_.value=A.descendants||[]}catch(A){console.error("Failed to fetch descendants:",A),_.value=[]}finally{b.value=!1}}}function d(){v.value=null}async function C(){v.value==="reset"?await P():v.value==="delete"&&await H()}async function x(){if(a.value){r.value=!0,l.value="Restarting session...";try{const A=a.value.session_id,L=t.currentSessionId===A,K=await oe.post(`/api/sessions/${A}/restart`);if(K.success)console.log("Session restarted successfully"),L&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A)),$&&$.hide();else{const U=K.error||K.detail||"Failed to restart session";console.error("Failed to restart session:",U),f.value=`Failed to restart session: ${U}`}}catch(A){console.error("Error restarting session:",A);const L=A.data?.detail||A.message||"Unknown error";f.value=`Error restarting session: ${L}`}finally{r.value=!1}}}async function O(){if(a.value)try{$&&$.hide(),console.log("Ending session",a.value.session_id);const A=a.value.session_id;await oe.post(`/api/sessions/${A}/terminate`),t.currentSessionId===A&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(A){console.error("Error ending session:",A),t.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function P(){if(a.value){r.value=!0,l.value="Resetting session...";try{const A=a.value.session_id,L=t.currentSessionId===A,K=await oe.post(`/api/sessions/${A}/reset`);if(K.success)console.log("Session reset successfully"),L&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A)),$&&$.hide();else{const U=K.error||K.detail||"Failed to reset session";console.error("Failed to reset session:",U),f.value=`Failed to reset session: ${U}`,v.value=null}}catch(A){console.error("Error resetting session:",A);const L=A.data?.detail||A.message||"Unknown error";f.value=`Error resetting session: ${L}`,v.value=null}finally{r.value=!1}}}async function H(){if(a.value){r.value=!0,l.value="Deleting session...";try{const A=a.value.session_id;await t.deleteSession(A),e.currentRoute.value.params.sessionId===A&&e.push("/"),$&&$.hide()}catch(A){console.error("Error deleting session:",A);const L=A.data?.detail||A.message||"Unknown error";f.value=`Error deleting session: ${L}`,v.value=null}finally{r.value=!1}}}function D(){v.value=null,r.value=!1,l.value="",f.value="",_.value=[],b.value=!1}function F(){D(),a.value=null,o.hideModal()}return de(()=>o.currentModal,A=>{if(A?.name==="manage-session"&&$){const L=A.data||{};a.value=L.session,D(),$.show()}}),_e(()=>{c.value&&Ae(async()=>{const{default:A}=await import("./modal-D6mKceGM.js").then(L=>L.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{$=new A(c.value),c.value.addEventListener("hidden.bs.modal",F)})}),Ce(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",F),$&&$.dispose()}),(A,L)=>(m(),p("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[n("div",T1,[n("div",x1,[n("div",A1,[n("h5",M1,w(v.value?y.value:"Manage Session"),1),L[1]||(L[1]=n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),n("div",O1,[r.value?(m(),p("div",D1,[L[2]||(L[2]=n("div",{class:"spinner-border text-primary mb-3",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1)),n("p",N1,w(l.value),1)])):v.value==="reset"?(m(),p("div",L1,[...L[3]||(L[3]=[n("div",{class:"alert alert-danger mb-3"},[n("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),n("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),n("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):v.value==="delete"?(m(),p("div",I1,[L[9]||(L[9]=n("div",{class:"alert alert-danger mb-3"},[n("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),n("p",j1,[L[4]||(L[4]=ee("This will permanently delete session ",-1)),n("strong",null,w(a.value?.name),1),L[5]||(L[5]=ee(".",-1))]),L[10]||(L[10]=n("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),b.value?(m(),p("div",P1,[...L[6]||(L[6]=[n("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[n("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),n("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):_.value.length>0?(m(),p("div",R1,[L[7]||(L[7]=n("strong",null,"Cascading Deletion:",-1)),L[8]||(L[8]=ee(" This session has ",-1)),n("strong",null,w(_.value.length),1),ee(" child session"+w(_.value.length===1?"":"s")+" that will also be deleted: ",1),n("ul",W1,[(m(!0),p(re,null,ue(_.value,K=>(m(),p("li",{key:K.session_id,class:"small"},[n("strong",null,w(K.name||K.session_id),1),K.role?(m(),p("span",H1," ("+w(K.role)+")",1)):M("",!0)]))),128))])])):M("",!0)])):(m(),p("div",V1,[f.value?(m(),p("div",F1,[L[11]||(L[11]=n("strong",null,"Error:",-1)),ee(" "+w(f.value)+" ",1),n("button",{type:"button",class:"btn-close",onClick:L[0]||(L[0]=K=>f.value="")})])):M("",!0),L[18]||(L[18]=n("p",{class:"text-muted"},"Choose how to manage this session:",-1)),n("div",B1,[n("button",{class:"btn btn-outline-primary text-start",onClick:x,disabled:r.value},[...L[12]||(L[12]=[n("strong",null,"ðŸ”„ Restart Agent",-1),n("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,U1),n("button",{class:"btn btn-outline-secondary text-start",onClick:O,disabled:r.value},[...L[13]||(L[13]=[n("strong",null,"ðŸšª End Session",-1),n("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,q1),L[16]||(L[16]=n("hr",{class:"my-2"},null,-1)),L[17]||(L[17]=n("div",{class:"danger-zone-header"},[n("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),n("button",{class:"btn btn-outline-warning text-start",onClick:g,disabled:r.value},[...L[14]||(L[14]=[n("strong",null,"ðŸ§¹ Reset Session",-1),n("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,z1),n("button",{class:"btn btn-outline-danger text-start",onClick:u,disabled:r.value},[...L[15]||(L[15]=[n("strong",null,"ðŸ—‘ï¸ Delete Session",-1),n("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,K1)]),L[19]||(L[19]=n("div",{class:"alert alert-warning mt-3 mb-0"},[n("small",null,[n("strong",null,"Note:"),ee(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),n("div",G1,[v.value&&!r.value?(m(),p(re,{key:0},[n("button",{type:"button",class:"btn btn-secondary",onClick:d},"Cancel"),n("button",{type:"button",class:X(["btn",v.value==="delete"?"btn-danger":"btn-warning"]),onClick:C},w(v.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?M("",!0):(m(),p("button",Y1,"Cancel"))])])])],512))}},X1=te(J1,[["__scopeId","data-v-6b832853"]]),Q1={class:"modal-dialog modal-dialog-centered modal-lg"},Z1={class:"modal-content"},eE={class:"modal-body"},tE={key:0,class:"text-center text-muted py-4"},sE={key:1},nE={class:"mb-3"},oE={class:"font-monospace small"},iE={class:"mb-3"},aE=["value"],rE={class:"mb-3"},lE={class:"mb-3"},cE={class:"mb-3"},uE={key:0},dE={class:"d-flex flex-wrap gap-1"},mE={key:1,class:"text-muted small"},pE={key:0,class:"mb-3"},fE={class:"d-flex flex-wrap gap-1"},vE={key:1,class:"mb-3"},hE={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},_E={class:"mb-3"},gE={class:"text-muted"},bE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},yE={__name:"SessionInfoModal",setup(s){const e=ae(),t=Oe(),o=fe(),i=I(null),a=I(!1),r=I(null);let l=null;const f={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},v=h(()=>{if(!i.value)return null;const g=e.initData.get(i.value);return g||(t.messagesBySession.get(i.value)||[]).find(C=>C.type==="system"&&(C.subtype==="init"||C.metadata?.subtype==="init")&&C.metadata?.init_data)?.metadata?.init_data||null});function c(g){return g?f[g]||g:"Default (Sonnet 4.5)"}function $(g){return typeof g=="string"?g:typeof g=="object"&&g.type==="preset"?`Preset: ${g.preset}`:JSON.stringify(g,null,2)}function _(g){g.target.select()}function b(){i.value=null,a.value=!1}function y(){b(),o.hideModal()}return de(()=>o.currentModal,g=>{if(g?.name==="session-info"&&l){const u=g.data||{};i.value=u.sessionId,a.value=!1,l.show()}}),_e(()=>{r.value&&Ae(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{l=new g(r.value),r.value.addEventListener("hidden.bs.modal",y)})}),Ce(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",y),l&&l.dispose()}),(g,u)=>(m(),p("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[n("div",Q1,[n("div",Z1,[u[9]||(u[9]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",eE,[v.value?(m(),p("div",sE,[n("div",nE,[u[1]||(u[1]=n("h6",{class:"text-muted"},"Session ID",-1)),n("div",oE,w(i.value),1)]),n("div",iE,[u[2]||(u[2]=n("h6",{class:"text-muted"},"Working Directory",-1)),n("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:v.value.cwd||"Not specified",readonly:"",onClick:_},null,8,aE)]),n("div",rE,[u[3]||(u[3]=n("h6",{class:"text-muted"},"Model",-1)),n("div",null,w(c(v.value.model)),1)]),n("div",lE,[u[4]||(u[4]=n("h6",{class:"text-muted"},"Permission Mode",-1)),n("div",null,w(v.value.permissionMode||"default"),1)]),n("div",cE,[u[5]||(u[5]=n("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(v.value.allowed_tools||v.value.tools)&&(v.value.allowed_tools||v.value.tools).length>0?(m(),p("div",uE,[n("div",dE,[(m(!0),p(re,null,ue(v.value.allowed_tools||v.value.tools,d=>(m(),p("span",{key:d,class:"badge bg-secondary"},w(d),1))),128))])])):(m(),p("div",mE,"No pre-authorized tools (will prompt for permissions)"))]),v.value.commands&&v.value.commands.length>0?(m(),p("div",pE,[u[6]||(u[6]=n("h6",{class:"text-muted"},"Commands",-1)),n("div",fE,[(m(!0),p(re,null,ue(v.value.commands,d=>(m(),p("span",{key:d,class:"badge bg-info"},w(d),1))),128))])])):M("",!0),v.value.systemPrompt?(m(),p("div",vE,[u[7]||(u[7]=n("h6",{class:"text-muted"},"System Prompt",-1)),n("pre",hE,w($(v.value.systemPrompt)),1)])):M("",!0),n("div",_E,[n("h6",gE,[u[8]||(u[8]=ee(" Raw Configuration ",-1)),n("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:u[0]||(u[0]=d=>a.value=!a.value)},w(a.value?"Hide":"Show"),1)]),a.value?(m(),p("pre",bE,w(JSON.stringify(v.value,null,2)),1)):M("",!0)])])):(m(),p("div",tE," No session configuration data available "))]),u[10]||(u[10]=n("div",{class:"modal-footer"},[n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},wE=te(yE,[["__scopeId","data-v-b28b39b3"]]),$E={class:"modal-dialog modal-dialog-centered modal-lg"},EE={class:"modal-content"},SE={class:"modal-body"},CE={key:0,class:"text-center text-muted py-4"},kE={key:1},TE={class:"mb-3"},xE={class:"mb-3"},AE={class:"font-monospace small"},ME={class:"mb-3"},OE={class:"mb-3"},DE={class:"mb-3"},NE={key:0},LE={class:"d-flex flex-wrap gap-1"},IE={key:1,class:"text-muted small"},jE={class:"mb-3"},PE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},RE={key:1,class:"text-muted small"},WE={class:"mb-3"},HE={key:0,class:"badge bg-info"},VE={key:1,class:"badge bg-secondary"},FE={class:"mb-3"},BE={key:0,class:"font-monospace small"},UE={key:1,class:"text-muted small"},qE={key:0,class:"mb-3"},zE={key:0},KE={class:"list-unstyled mb-0"},GE={key:1,class:"text-muted small"},YE={class:"mb-3"},JE={class:"small"},XE={class:"mb-3"},QE={class:"small"},ZE={__name:"MinionViewModal",setup(s){const e=fe(),t=I(null),o=I(null);let i=null;function a(v){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[v]||"bg-secondary"}function r(v){if(!v)return"N/A";try{const c=new Date(v);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function l(){t.value=null}function f(){l(),e.hideModal()}return de(()=>e.currentModal,v=>{if(v?.name==="minion-view"&&i){const c=v.data||{};t.value=c.session,i.show()}}),_e(()=>{o.value&&Ae(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(c=>c.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{i=new v(o.value),o.value.addEventListener("hidden.bs.modal",f)})}),Ce(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",f),i&&i.dispose()}),(v,c)=>(m(),p("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[n("div",$E,[n("div",EE,[c[11]||(c[11]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",SE,[t.value?(m(),p("div",kE,[n("div",TE,[c[0]||(c[0]=n("h6",{class:"text-muted"},"Name",-1)),n("div",null,w(t.value.name||"Unnamed Minion"),1)]),n("div",xE,[c[1]||(c[1]=n("h6",{class:"text-muted"},"Session ID",-1)),n("div",AE,w(t.value.session_id),1)]),n("div",ME,[c[2]||(c[2]=n("h6",{class:"text-muted"},"Role",-1)),n("div",null,w(t.value.role||"Not specified"),1)]),n("div",OE,[c[3]||(c[3]=n("h6",{class:"text-muted"},"Current State",-1)),n("div",null,[n("span",{class:X(["badge",a(t.value.state)])},w(t.value.state),3)])]),n("div",DE,[c[4]||(c[4]=n("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(m(),p("div",NE,[n("div",LE,[(m(!0),p(re,null,ue(t.value.capabilities,$=>(m(),p("span",{key:$,class:"badge bg-secondary"},w($),1))),128))])])):(m(),p("div",IE,"None"))]),n("div",jE,[c[5]||(c[5]=n("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(m(),p("div",PE,w(t.value.initialization_context),1)):(m(),p("div",RE,"Not specified"))]),n("div",WE,[c[6]||(c[6]=n("h6",{class:"text-muted"},"Overseer",-1)),n("div",null,[t.value.is_overseer?(m(),p("span",HE,"Yes")):(m(),p("span",VE,"No"))])]),n("div",FE,[c[7]||(c[7]=n("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(m(),p("div",BE,w(t.value.parent_overseer_id),1)):(m(),p("div",UE," Root overseer (user-created) "))]),t.value.is_overseer?(m(),p("div",qE,[c[8]||(c[8]=n("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(m(),p("div",zE,[n("ul",KE,[(m(!0),p(re,null,ue(t.value.child_minion_ids,$=>(m(),p("li",{key:$,class:"font-monospace small"},w($),1))),128))])])):(m(),p("div",GE,"No children"))])):M("",!0),n("div",YE,[c[9]||(c[9]=n("h6",{class:"text-muted"},"Created",-1)),n("div",JE,w(r(t.value.created_at)),1)]),n("div",XE,[c[10]||(c[10]=n("h6",{class:"text-muted"},"Last Active",-1)),n("div",QE,w(r(t.value.updated_at)),1)])])):(m(),p("div",CE," No minion data available "))]),c[12]||(c[12]=n("div",{class:"modal-footer"},[n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},eS=te(ZE,[["__scopeId","data-v-d996dc6f"]]),tS={class:"container-fluid vh-100 d-flex flex-column p-0"},sS={class:"d-flex flex-grow-1 overflow-hidden position-relative"},nS={class:"flex-grow-1 d-flex flex-column overflow-hidden"},oS={__name:"App",setup(s){const e=fe(),t=Je(),o=ae(),i=Le(),a=Lt(),r=h(()=>e.sidebarCollapsed),l=h(()=>e.isMobile);_e(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&await o.selectSession($)}else if(c.startsWith("#/timeline/")){const $=c.replace("#/timeline/","");a.push(`/timeline/${$}`)}window.addEventListener("popstate",f),window.addEventListener("resize",e.handleResize)}),Ce(()=>{window.removeEventListener("popstate",f),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function f(){const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&o.selectSession($)}}function v(){e.toggleSidebar()}return(c,$)=>{const _=no("router-view");return m(),p("div",tS,[me(jb),n("div",{id:"sidebar-backdrop",class:X({show:!r.value&&l.value}),onClick:v},null,2),n("div",sS,[me(my),n("main",nS,[me(_)])]),me(Ay),me(qy),me(pw),me(k1),me(X1),me(wE),me(eS)])}}},on=_i(oS);on.use(gi());on.use(Tb);on.mount("#app");
