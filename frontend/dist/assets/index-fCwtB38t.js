const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as t,o as i,d as at,r as R,b as g,t as w,n as Q,u as ie,e as et,f as re,w as be,g as xs,F as le,h as fe,i as T,j as Ce,v as qe,k as Ee,l as ho,m as ye,p as go,q as ge,s as rt,x as Ze,y as Te,z as Da,A as _o,B as Ae,C as yn,D as bo,E as Yt,G as Ma,H as Oa,I as tn,T as La,J as yo,K as wo,L as ht,M as Es,N as wn,O as Na,P as Ia}from"./vue-vendor-urrUqSeI.js";import{m as nt,p as Jt}from"./markdown-vendor-BRsjnVvP.js";import{c as ja}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();const Ra={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Pa={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),l("div",Ra,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Fa="modulepreload",Ba=function(n){return"/"+n},$n={},Le=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let m=function(p){return Promise.all(p.map(u=>Promise.resolve(u).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=c?.nonce||c?.getAttribute("nonce");a=m(s.map(p=>{if(p=Ba(p),p in $n)return;$n[p]=!0;const u=p.endsWith(".css"),y=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${y}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Fa,u||(h.as="script"),h.crossOrigin="",h.href=p,d&&h.setAttribute("nonce",d),document.head.appendChild(h),u)return new Promise(($,k)=>{h.addEventListener("load",$),h.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${p}`)))})}))}function r(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return a.then(c=>{for(const d of c||[])d.status==="rejected"&&r(d.reason);return e().catch(r)})};class Ts extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Ot(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new Ts(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Ts?s:(console.error("API request failed:",s),new Ts(`Network error: ${s.message}`,0,null))}}async function Gt(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[d,m]of Object.entries(e.params))m!=null&&o.append(d,m);const a=o.toString();a&&(s=`${n}?${a}`);const{params:r,...c}=e;return Ot(s,{...c,method:"GET"})}return Ot(s,{...e,method:"GET"})}async function $o(n,e,s={}){return Ot(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Wa(n,e,s={}){return Ot(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function ko(n,e={}){return Ot(n,{...e,method:"DELETE"})}async function Va(n,e,s={}){return Ot(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Ha(){return Gt("/api/system/git-status")}async function Ua(){return $o("/api/system/restart")}const we={get:Gt,post:$o,put:Wa,delete:ko,patch:Va},_e=at("session",()=>{const n=R(new Map),e=R(null),s=R(new Map),o=R(new Map),a=R(new Set),r=R(!1);let c=null;const d=g(()=>n.value.get(e.value)),m=g(()=>Array.from(n.value.values()).sort((E,P)=>E.order-P.order)),p=E=>g(()=>m.value.filter(P=>P.project_id===E)),u=g({get:()=>s.value.get(e.value)||"",set:E=>{e.value&&s.value.set(e.value,E)}});async function y(){try{const E=await we.get("/api/sessions");return n.value.clear(),E.sessions.forEach(P=>{n.value.set(P.session_id,P)}),console.log(`Loaded ${n.value.size} sessions`),E.sessions}catch(E){throw console.error("Failed to fetch sessions:",E),E}}async function h(E,P){try{const B=(await we.post("/api/sessions",{project_id:E,...P})).session_id,V=(await we.get(`/api/sessions/${B}`)).session;return n.value.set(B,V),n.value=new Map(n.value),console.log(`Created session ${B}`),V}catch(A){throw console.error("Failed to create session:",A),A}}async function $(E){if(e.value===E&&!r.value)return;c&&(console.log(`Aborting pending selection to switch to ${E}`),c.abort(),c=null);const P=new AbortController;c=P,r.value=!0;try{if(e.value=E,P.signal.aborted){console.log(`Selection of ${E} aborted early`);return}let A=n.value.get(E);if(!A)try{const N=await we.get(`/api/sessions/${E}`);if(P.signal.aborted){console.log(`Selection of ${E} aborted after fetch`);return}A=N.session,n.value.set(E,A),n.value=new Map(n.value),console.log(`Fetched session ${E} for deeplink`)}catch(N){console.error(`Failed to fetch session ${E}:`,N);return}if(A&&(A.state==="created"||A.state==="terminated"))try{if(await f(E),P.signal.aborted){console.log(`Selection of ${E} aborted after start`);return}console.log(`Auto-started session ${E} (was in ${A.state} state)`);const N=6e4,W=200,z=5e3;let Y=0,j=0;for(;Y<N;){if(P.signal.aborted){console.log(`Selection of ${E} aborted during state wait`);return}const K=n.value.get(E);if(K&&K.state==="active"){console.log(`Session ${E} is now active after ${Y}ms`);break}if(Y-j>=z){const ee=n.value.get(E)?.state||"unknown";console.log(`Waiting for session ${E} to become active (current: ${ee}, ${Y/1e3}s elapsed)`),j=Y}await new Promise(ee=>setTimeout(ee,W)),Y+=W}const F=n.value.get(E);F&&F.state!=="active"&&console.warn(`Session ${E} did not become active within ${N/1e3}s (state: ${F.state}), continuing anyway`)}catch(N){console.error(`Failed to auto-start session ${E}:`,N)}if(P.signal.aborted){console.log(`Selection of ${E} aborted before message load`);return}if(await(await Le(()=>Promise.resolve().then(()=>ri),void 0)).useMessageStore().loadMessages(E),P.signal.aborted){console.log(`Selection of ${E} aborted after message load`);return}if(await(await Le(()=>Promise.resolve().then(()=>Di),void 0)).useResourceStore().loadResources(E),P.signal.aborted){console.log(`Selection of ${E} aborted after resource load`);return}await(await Le(()=>Promise.resolve().then(()=>Mi),void 0)).useWebSocketStore().connectSession(E),P.signal.aborted||console.log(`Selected session ${E}`)}finally{c===P&&(c=null),r.value=!1}}function k(E,P){const A=n.value.get(E);A?Object.assign(A,P):(n.value.set(E,P),console.log(`Added new session ${E} via WebSocket update`)),n.value=new Map(n.value)}async function b(E){a.value.add(E);try{const A=(await we.delete(`/api/sessions/${E}`)).deleted_session_ids||[E];for(const B of A)n.value.delete(B),s.value.delete(B),o.value.delete(B);return n.value=new Map(n.value),A.includes(e.value)&&(e.value=null),console.log(`Deleted ${A.length} session(s): ${A.join(", ")}`),A}catch(P){throw console.error("Failed to delete session:",P),P}finally{a.value.delete(E)}}async function v(E,P){try{await we.patch(`/api/sessions/${E}`,P),k(E,P),console.log(`Updated session ${E}:`,P)}catch(A){throw console.error("Failed to update session:",A),A}}async function _(E,P){try{await we.post(`/api/sessions/${E}/permission-mode`,{mode:P}),k(E,{current_permission_mode:P});const A=o.value.get(E);A&&(A.permissionMode=P,o.value.set(E,A)),console.log(`Set permission mode for session ${E} to ${P}`)}catch(A){throw console.error("Failed to set permission mode:",A),A}}async function f(E){try{await we.post(`/api/sessions/${E}/start`),console.log(`Started session ${E}`)}catch(P){throw console.error("Failed to start session:",P),P}}async function S(E){try{await we.post(`/api/sessions/${E}/pause`),console.log(`Paused session ${E}`)}catch(P){throw console.error("Failed to pause session:",P),P}}async function C(E){try{await we.post(`/api/sessions/${E}/terminate`),console.log(`Terminated session ${E}`)}catch(P){throw console.error("Failed to terminate session:",P),P}}function O(E){return n.value.get(E)}function x(E,P){o.value.set(E,P),P.permissionMode&&k(E,{current_permission_mode:P.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:d,orderedSessions:m,sessionsInProject:p,currentInput:u,fetchSessions:y,createSession:h,selectSession:$,updateSession:k,deleteSession:b,patchSession:v,setPermissionMode:_,startSession:f,pauseSession:S,terminateSession:C,getSession:O,storeInitData:x}}),kn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:_e},Symbol.toStringTag,{value:"Module"})),xe=at("ui",()=>{const n=R(window.innerWidth<768),e=R(300),s=R(!0),o=R(300),a=R("tasks"),r=R(window.innerWidth),c=g(()=>r.value<768),d=R(!0),m=R(!1),p=R(null),u=R(null),y=g(()=>p.value?{name:p.value,data:u.value}:null),h=R(!1),$=R("Loading..."),k=R(!1),b=R("idle");function v(){n.value=!n.value}function _(Y){n.value=Y}function f(Y){e.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function S(){s.value=!s.value}function C(Y){s.value=Y}function O(Y){o.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function x(Y){a.value=Y}function E(Y){d.value=Y}function P(){const Y=localStorage.getItem("webui-background-color");m.value=Y==="red"}function A(){m.value=!m.value,localStorage.setItem("webui-background-color",m.value?"red":"gray")}function B(Y,j=null){p.value=null,u.value=null,setTimeout(()=>{p.value=Y,u.value=j},0)}function G(){p.value=null,u.value=null}function V(Y="Loading..."){h.value=!0,$.value=Y}function N(){h.value=!1}function W(){B("restart-server")}function z(){const Y=r.value;r.value=window.innerWidth,r.value<768&&Y>=768?n.value=!0:r.value>=768&&Y<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:a,isMobile:c,autoScrollEnabled:d,isRedBackground:m,activeModal:p,modalData:u,currentModal:y,isLoading:h,loadingMessage:$,restartInProgress:k,restartStatus:b,toggleSidebar:v,setSidebarCollapsed:_,setSidebarWidth:f,toggleRightSidebar:S,setRightSidebarCollapsed:C,setRightSidebarWidth:O,setRightSidebarTab:x,setAutoScroll:E,initBackgroundColor:P,toggleBackgroundColor:A,showModal:B,hideModal:G,showLoading:V,hideLoading:N,showRestartModal:W,handleResize:z}}),He=at("project",()=>{const n=R(new Map),e=R(null),s=g(()=>n.value.get(e.value)),o=g(()=>Array.from(n.value.values()).sort((v,_)=>v.order-_.order));async function a(){try{const v=await we.get("/api/projects");return n.value.clear(),v.projects.forEach(_=>{n.value.set(_.project_id,_)}),console.log(`Loaded ${n.value.size} projects`),v.projects}catch(v){throw console.error("Failed to fetch projects:",v),v}}async function r(v,_){try{const S=(await we.post("/api/projects",{name:v,working_directory:_})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(f){throw console.error("Failed to create project:",f),f}}async function c(v,_){try{await we.put(`/api/projects/${v}`,_),d(v,_),console.log(`Updated project ${v}`,_)}catch(f){throw console.error("Failed to update project:",f),f}}function d(v,_){const f=n.value.get(v);f&&(Object.assign(f,_),n.value=new Map(n.value))}async function m(v){try{await we.delete(`/api/projects/${v}`),n.value.delete(v),n.value=new Map(n.value),e.value===v&&(e.value=null),console.log(`Deleted project ${v}`)}catch(_){throw console.error("Failed to delete project:",_),_}}async function p(v){try{const _=await we.put(`/api/projects/${v}/toggle-expansion`),f=n.value.get(v);return f&&(f.is_expanded=_.is_expanded,n.value=new Map(n.value)),_.is_expanded}catch(_){throw console.error("Failed to toggle expansion:",_),_}}async function u(v){try{await we.put("/api/projects/reorder",{project_ids:v}),v.forEach((_,f)=>{const S=n.value.get(_);S&&(S.order=f)}),n.value=new Map(n.value),console.log("Reordered projects",v)}catch(_){throw console.error("Failed to reorder projects:",_),_}}async function y(v,_){try{await we.put(`/api/projects/${v}/sessions/reorder`,{session_ids:_});const f=n.value.get(v);f&&(f.session_ids=_,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${v}`,_)}catch(f){throw console.error("Failed to reorder sessions:",f),f}}function h(v){return n.value.get(v)}function $(v){e.value=v}function k(){e.value=null}function b(v){if(!v)return"";const _=v.split(/[/\\]/).filter(f=>f);return _.length===0?"/":_.length===1?`/${_[0]}`:_.length===2?`/${_.join("/")}`:`.../${_.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:a,createProject:r,updateProject:c,updateProjectLocal:d,deleteProject:m,toggleExpansion:p,reorderProjects:u,reorderSessionsInProject:y,getProject:h,selectProject:$,clearProjectSelection:k,formatPath:b}}),oe=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},qa={class:"project-name"},za=["title"],Ka={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=He(),a=xe(),r=g(()=>s.sessions.get(e.sessionId)),c=g(()=>r.value?.name||e.sessionId),d=g(()=>{for(const p of o.projects.values())if(p.session_ids?.includes(e.sessionId))return p;return null}),m=g(()=>d.value?.name||"Unknown Project");return(p,u)=>(i(),l("div",{class:Q(["session-header border-bottom p-3",{"theme-red-panel":ie(a).isRedBackground}])},[t("div",qa,w(m.value),1),t("div",{class:"session-name",title:n.sessionId},w(c.value),9,za)],2))}},Ga=oe(Ka,[["__scopeId","data-v-ba771dd8"]]),Ya={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ja=["title"],Qa={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Xa={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=g(()=>s.sessions.get(e.sessionId)),a=g(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=g(()=>{const m=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),c=g(()=>{const m=a.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),d=g(()=>{if(!o.value)return"No session selected";const m=a.value,p=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",y=o.value.role?` (${o.value.role})`:"";return`${u}${y}: ${p}`});return(m,p)=>(i(),l("div",Ya,[o.value?(i(),l("div",{key:0,class:Q(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:et({width:"100%",backgroundColor:r.value}),title:d.value},null,14,Ja)):(i(),l("div",Qa))]))}},Za=oe(Xa,[["__scopeId","data-v-63d222fe"]]),ei={class:"d-flex justify-content-between align-items-center gap-2"},ti={class:"d-flex gap-2"},si=["disabled"],ni={class:"mode-label"},oi=["disabled"],ai=["disabled"],ii={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=xe(),a=g(()=>s.sessions.get(e.sessionId)),r=g(()=>a.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},d=g(()=>c[r.value]||"ðŸ”’"),m=g(()=>r.value),p=["default","acceptEdits","plan"],u=async()=>{if(!a.value)return;if(r.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(_){console.error("Failed to cycle permission mode:",_)}return}const b=(p.indexOf(r.value)+1)%p.length,v=p[b];try{await s.setPermissionMode(e.sessionId,v)}catch(_){console.error("Failed to cycle permission mode:",_)}},y=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:a.value})},$=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(k,b)=>(i(),l("div",{class:Q(["session-status-bar border-top p-2",ie(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ei,[t("div",ti,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!a.value},[re(w(d.value)+" ",1),t("span",ni,w(m.value),1)],8,si),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:y,disabled:!a.value},[...b[0]||(b[0]=[re(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,oi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!a.value},[...b[1]||(b[1]=[re(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,ai)]),t("div",null,[t("button",{class:Q(["btn btn-sm",ie(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:$}," â¬‡ï¸ "+w(ie(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},li=oe(ii,[["__scopeId","data-v-ed9a4d3c"]]),Mt=at("task",()=>{const n=R(new Map),e=R(new Set);function s(f){const S=n.value.get(f);return S?Array.from(S.values()).sort((C,O)=>{const x=parseInt(C.id.replace(/\D/g,""))||0,E=parseInt(O.id.replace(/\D/g,""))||0;return x-E}):[]}function o(f){return s(f).find(C=>C.status==="in_progress")||null}function a(f){const S=s(f);return{total:S.length,completed:S.filter(C=>C.status==="completed").length,inProgress:S.filter(C=>C.status==="in_progress").length,pending:S.filter(C=>C.status==="pending").length}}function r(f){return e.value.has(f)}const c=g(()=>{const f=_e();return s(f.currentSessionId)}),d=g(()=>{const f=_e();return o(f.currentSessionId)}),m=g(()=>{const f=_e();return a(f.currentSessionId)}),p=g(()=>{const f=_e();return r(f.currentSessionId)});function u(f,S){n.value.has(f)||n.value.set(f,new Map),n.value.get(f).set(S.id,{id:S.id,subject:S.subject||"",description:S.description||"",status:S.status||"pending",activeForm:S.activeForm||null,owner:S.owner||null,blocks:S.blocks||[],blockedBy:S.blockedBy||[],metadata:S.metadata||{}}),e.value.add(f),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${S.id} for session ${f}`)}function y(f,S,C){const O=n.value.get(f);if(!O){console.warn(`No tasks found for session ${f}`);return}const x=O.get(S);if(!x){u(f,{id:S,...C});return}C.subject!==void 0&&(x.subject=C.subject),C.description!==void 0&&(x.description=C.description),C.status!==void 0&&(x.status=C.status),C.activeForm!==void 0&&(x.activeForm=C.activeForm),C.owner!==void 0&&(x.owner=C.owner),C.metadata!==void 0&&(x.metadata={...x.metadata,...C.metadata}),C.addBlocks&&(x.blocks=[...new Set([...x.blocks,...C.addBlocks])]),C.addBlockedBy&&(x.blockedBy=[...new Set([...x.blockedBy,...C.addBlockedBy])]),C.status==="deleted"&&(O.delete(S),O.size===0&&(e.value.delete(f),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${S} for session ${f}`,C)}function h(f,S){return n.value.get(f)?.get(S)||null}function $(f){n.value.delete(f),e.value.delete(f),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${f}`)}function k(f,S){n.value.has(f)&&n.value.get(f).clear(),e.value.delete(f);const C=new Map;for(const O of S){if(O.metadata?.tool_uses)for(const x of O.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(x.name)&&C.set(x.id,{name:x.name,input:x.input});if(O.metadata?.tool_results)for(const x of O.metadata.tool_results){const E=C.get(x.tool_use_id);E&&(b(f,E.name,E.input,{error:x.is_error,content:x.content}),C.delete(x.tool_use_id))}}console.log(`Reconstructed ${n.value.get(f)?.size||0} tasks for session ${f}`)}function b(f,S,C,O){if(O?.error){console.log(`Skipping task update - tool ${S} returned error`);return}const x=v(O);if(x)switch(S){case"TaskCreate":{const E=_(x)||C?.id;E&&u(f,{id:E,subject:C?.subject||"",description:C?.description||"",status:"pending",activeForm:C?.activeForm||null,owner:C?.owner||null,blocks:[],blockedBy:[],metadata:C?.metadata||{}});break}case"TaskUpdate":{const E=C?.taskId;E&&y(f,E,{status:C?.status,subject:C?.subject,description:C?.description,activeForm:C?.activeForm,owner:C?.owner,metadata:C?.metadata,addBlocks:C?.addBlocks,addBlockedBy:C?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{C?.taskId;break}}}function v(f){return f?typeof f=="string"?f:f.content?typeof f.content=="string"?f.content:JSON.stringify(f.content):f.message?f.message:JSON.stringify(f):null}function _(f){if(!f)return null;const S=f.match(/[Tt]ask\s*#(\d+)/i);if(S)return S[1];const C=f.match(/#(\d+)/);return C?C[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:d,currentTaskStats:m,currentHasTasks:p,tasksForSession:s,activeTask:o,taskStats:a,hasTasks:r,getTask:h,createTask:u,updateTask:y,clearTasks:$,reconstructFromMessages:k,handleTaskToolResult:b}}),Ne=at("message",()=>{const n=R(new Map),e=R(new Map),s=R(new Map),o=R(new Map),a=R(new Map),r=R(new Map),c=R(new Map),d=R(new Map),m=g(()=>{const j=_e();return n.value.get(j.currentSessionId)||[]}),p=g(()=>{const j=_e();return e.value.get(j.currentSessionId)||[]});async function u(j,F=null,K=0){try{const ee=F||1e4,se=await we.get(`/api/sessions/${j}/messages?limit=${ee}&offset=${K}`),ne=se.messages||[],ve=se.total_count||ne.length,ae=se.has_more||!1;if(console.log(`Loaded ${ne.length} of ${ve} messages for session ${j}`),n.value.set(j,ne),ne.length>0){const L=ne[ne.length-1];L.timestamp&&(c.value.set(j,L.timestamp),console.log(`Tracked last received timestamp for session ${j}: ${L.timestamp}`))}const H=new Set;ne.forEach(L=>{L.type==="assistant"&&L.metadata?.tool_uses&&L.metadata.tool_uses.forEach(I=>{H.add(I.id)}),L.type==="user"&&L.metadata?.tool_results&&L.metadata.tool_results.forEach(I=>{H.delete(I.tool_use_id);const U=r.value.get(j);U&&U.delete(I.tool_use_id)}),L.type==="system"&&L.metadata?.subtype==="client_launched"&&(H.forEach(I=>{A(j,I,"Session was restarted")}),H.clear()),L.type==="system"&&L.metadata?.subtype==="interrupt"&&(H.forEach(I=>{A(j,I,"Session was interrupted")}),H.clear()),L.metadata?.has_tool_uses&&L.metadata.tool_uses&&L.metadata.tool_uses.forEach(I=>{b(j,I,L.timestamp)}),L.metadata?.has_tool_results&&L.metadata.tool_results&&L.metadata.tool_results.forEach(I=>{S(j,I)}),(L.type==="permission_request"||L.metadata?.has_permission_requests)&&v(j,L),L.type==="permission_response"&&_(j,{request_id:L.metadata?.request_id,decision:L.metadata?.decision,updated_input:L.metadata?.updated_input,reasoning:L.metadata?.reasoning,applied_updates:L.metadata?.applied_updates}),L.type==="system"&&(L.subtype==="init"||L.metadata?.subtype==="init")&&L.metadata?.init_data&&_e().storeInitData(j,L.metadata.init_data)});const D=_e().sessions.get(j);D&&!["active","paused","starting"].includes(D.state)&&(H.forEach(L=>{A(j,L,"Session was terminated")}),H.clear()),a.value.set(j,H),n.value=new Map(n.value);try{Mt().reconstructFromMessages(j,ne)}catch(L){console.warn("Failed to reconstruct task state:",L)}return ae&&console.warn(`Warning: Only loaded ${ne.length} of ${ve} messages. Some messages may be missing.`),{messages:ne,totalCount:ve,hasMore:ae}}catch(ee){throw console.error("Failed to load messages:",ee),ee}}function y(j,F){const K=a.value.get(j)||new Set;F.type==="assistant"&&F.metadata?.tool_uses&&F.metadata.tool_uses.forEach(ee=>{K.add(ee.id)}),F.type==="user"&&F.metadata?.tool_results&&F.metadata.tool_results.forEach(ee=>{K.delete(ee.tool_use_id);const se=r.value.get(j);se&&se.delete(ee.tool_use_id)}),F.type==="system"&&F.metadata?.subtype==="client_launched"&&(K.forEach(ee=>{A(j,ee,"Session was restarted")}),K.clear()),F.type==="system"&&F.metadata?.subtype==="interrupt"&&(K.forEach(ee=>{A(j,ee,"Session was interrupted")}),K.clear()),a.value.set(j,K)}function h(j,F){n.value.has(j)||n.value.set(j,[]);const K=n.value.get(j);if(F.id){const ee=K.findIndex(se=>se.id===F.id);if(ee!==-1){console.log(`Skipping duplicate message ${F.id} (already exists at index ${ee})`);return}}K.push(F),F.timestamp&&c.value.set(j,F.timestamp),x(j,F),y(j,F),n.value=new Map(n.value)}function $(j,F){e.value.has(j)||e.value.set(j,[]),e.value.get(j).push(F),e.value=new Map(e.value)}function k(j,F,K){const ee=e.value.get(j);if(ee){const se=ee.find(ne=>ne.id===F);se&&(Object.assign(se,K),e.value=new Map(e.value))}}function b(j,F,K=null){const ee=O(F.name,F.input);s.value.set(ee,F.id);const se={id:F.id,name:F.name,input:F.input,signature:ee,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:K||new Date().toISOString(),isExpanded:!0};return $(j,se),console.log(`Created tool call ${se.id} for ${se.name}`),se}function v(j,F){console.log("handlePermissionRequest received:",F);const K=F.metadata?.tool_name||F.tool_name,ee=F.metadata?.input_params||F.input_params,se=F.metadata?.request_id||F.request_id,ne=F.metadata?.suggestions||F.suggestions||[];console.log("Extracted data:",{toolName:K,inputParams:ee,requestId:se,suggestions:ne});const ve=O(K,ee),ae=s.value.get(ve);ae?(o.value.set(se,ae),k(j,ae,{status:"permission_required",permissionRequestId:se,suggestions:ne}),console.log(`Permission required for tool ${ae}`,{suggestions:ne})):console.warn("No tool use ID found for permission request signature:",ve,{toolName:K,inputParams:ee,availableSignatures:Array.from(s.value.keys())})}function _(j,F){const K=o.value.get(F.request_id);if(K){const ee={permissionDecision:F.decision,appliedUpdates:F.applied_updates||[]};F.decision==="allow"?(ee.status="executing",ee.backendStatus="running"):(ee.status="completed",ee.backendStatus="denied",ee.result={error:!0,message:F.reasoning||"Permission denied"},ee.isExpanded=!1),F.updated_input&&(ee.input=F.updated_input),k(j,K,ee),console.log(`Permission ${F.decision} for tool ${K}`)}}function f(j,F){console.log("handleToolCall received:",F);const K=F.tool_use_id;if(!K){console.warn("Received tool_call without tool_use_id:",F);return}e.value.has(j)||e.value.set(j,[]);const ee=e.value.get(j),se=ee.findIndex(ae=>ae.id===K),ve={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[F.status]||F.status;if(se!==-1){const ae=ee[se];ae.status=ve,ae.backendStatus=F.status,F.permission&&(ae.suggestions=F.permission.suggestions||[],ae.permissionRequestId=F.request_id),F.permission_granted!==null&&F.permission_granted!==void 0&&(ae.permissionDecision=F.permission_granted?"allow":"deny"),F.result!==void 0&&(ae.result={error:F.status==="failed",content:F.result}),F.error&&(ae.result={error:!0,content:F.error}),F.status==="denied"&&(ae.result={error:!0,message:"Permission denied"},ae.isExpanded=!1),F.status==="interrupted"&&(A(j,K,"Session was interrupted"),ae.isExpanded=!1),(F.status==="completed"||F.status==="failed")&&(ae.isExpanded=!1),F.display&&(ae.backendState=F.display),console.log(`Updated tool call ${K} to status: ${ve} (backend: ${F.status})`)}else{const ae=O(F.name,F.input);s.value.set(ae,K);const H={id:K,name:F.name,input:F.input,signature:ae,status:ve,backendStatus:F.status,permissionRequestId:F.request_id,permissionDecision:F.permission_granted!==void 0?F.permission_granted?"allow":"deny":null,suggestions:F.permission?.suggestions||[],result:F.result?{error:F.status==="failed",content:F.result}:null,explanation:null,timestamp:F.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(F.status),backendState:F.display};F.error&&(H.result={error:!0,content:F.error}),ee.push(H),console.log(`Created new tool call ${K} for ${F.name} with status: ${ve}`)}if(e.value=new Map(e.value),["completed","failed"].includes(F.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(F.name))try{Mt().handleTaskToolResult(j,F.name,F.input,{error:F.status==="failed",content:F.result})}catch(ae){console.warn("Failed to update task store:",ae)}}function S(j,F){const K=F.tool_use_id;k(j,K,{status:F.is_error?"error":"completed",result:{error:F.is_error,content:F.content},isExpanded:!1}),console.log(`Tool ${K} ${F.is_error?"failed":"completed"}`);const ee=e.value.get(j);if(ee){const se=ee.find(ne=>ne.id===K);if(se&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(se.name))try{Mt().handleTaskToolResult(j,se.name,se.input,{error:F.is_error,content:F.content})}catch(ne){console.warn("Failed to update task store:",ne)}}}function C(j,F){const K=e.value.get(j);if(K){const ee=K.find(se=>se.id===F);ee&&(ee.isExpanded=!ee.isExpanded,e.value=new Map(e.value))}}function O(j,F){if(!j)return"unknown:{}";if(!F||typeof F!="object")return`${j}:{}`;const K=JSON.stringify(F,Object.keys(F).sort());return`${j}:${K}`}function x(j,F){const K=F.metadata?.display||F.display;if(!K)return;d.value.has(j)||d.value.set(j,new Map);const ee=d.value.get(j);if(K.tool_states)for(const[se,ne]of Object.entries(K.tool_states)){ee.set(se,ne);const ve=e.value.get(j);if(ve){const ae=ve.find(H=>H.id===se);if(ae){const H={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};ae.status=H[ne.state]||ne.state,ae.backendState=ne}}}if(K.orphaned_tools&&K.orphaned_tools.length>0){const se=r.value.get(j)||new Map;for(const ne of K.orphaned_tools)se.has(ne)||se.set(ne,{reason:"denied",message:"Session was interrupted"});r.value.set(j,se)}if(K.linked_permissions)for(const[se,ne]of Object.entries(K.linked_permissions))o.value.set(se,ne);K.tool_states&&Object.keys(K.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${j}:`,{toolStates:Object.keys(K.tool_states||{}).length,orphanedTools:(K.orphaned_tools||[]).length,linkedPermissions:Object.keys(K.linked_permissions||{}).length})}function E(j,F){return d.value.get(j)?.get(F)}function P(j){const F=d.value.get(j);return F&&F.size>0}function A(j,F,K){const ee=r.value.get(j)||new Map;ee.set(F,{reason:"denied",message:K}),r.value.set(j,ee);const se=e.value.get(j);if(se){const ne=se.find(ve=>ve.id===F);ne&&ne.isExpanded&&(ne.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${F} as orphaned: ${K}`)}function B(j,F){const K=E(j,F);return K&&K.state==="orphaned"?!0:r.value.get(j)?.has(F)||!1}function G(j,F){const K=E(j,F);return K&&K.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:K}:r.value.get(j)?.get(F)}function V(j,F){const K=a.value.get(j);K&&K.size>0&&(K.forEach(ee=>A(j,ee,F)),K.clear())}function N(j){n.value.delete(j),e.value.delete(j),n.value=new Map(n.value),e.value=new Map(e.value)}function W(j){return c.value.get(j)}async function z(j){const F=c.value.get(j);if(!F)return console.log(`No sync needed for session ${j} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${j} since ${F}`);const K=await we.get(`/api/sessions/${j}/messages?limit=1000&offset=0`),ee=K.messages||[],se=K.has_more||!1,ne=I=>I?typeof I=="number"?I*1e3:new Date(I).getTime():0,ve=ne(F),ae=ee.filter(I=>I.timestamp?ne(I.timestamp)>ve:!1);if(ae.length===0)return console.log(`No missed messages for session ${j}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ae.length} missed messages for session ${j}`);const H=n.value.get(j)||[],M=new Set(H.map(I=>I.id).filter(Boolean)),D=ae.filter(I=>!I.id||!M.has(I.id));if(console.log(`After deduplication: ${D.length} unique new messages`),D.length>0){const I=D.sort((X,ce)=>{const de=ne(X.timestamp),$e=ne(ce.timestamp);return de-$e}),U=n.value.get(j)||[],Z=U.length>0?ne(U[U.length-1].timestamp):0,he=ne(I[0].timestamp),Pe=ne(I[I.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:U.length,lastExisting:Z,lastExistingDate:U.length>0?U[U.length-1].timestamp:"none",firstNew:he,firstNewDate:I[0].timestamp,lastNew:Pe,lastNewDate:I[I.length-1].timestamp,shouldAppend:he>Z}),he>Z){const X=[...U,...I];n.value.set(j,X),console.log(`âœ… Appended ${I.length} new messages (no full sort needed)`)}else{const X=[...U,...I].sort((ce,de)=>{const $e=ne(ce.timestamp),Se=ne(de.timestamp);return $e-Se});n.value.set(j,X),console.log(`âš ï¸ Merged and sorted ${I.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${H.length} messages unchanged`);D.forEach(I=>{y(j,I),I.metadata?.has_tool_uses&&I.metadata.tool_uses&&I.metadata.tool_uses.forEach(U=>{b(j,U,I.timestamp)}),I.metadata?.has_tool_results&&I.metadata.tool_results&&I.metadata.tool_results.forEach(U=>{S(j,U)}),(I.type==="permission_request"||I.metadata?.has_permission_requests)&&v(j,I),I.type==="permission_response"&&_(j,{request_id:I.metadata?.request_id,decision:I.metadata?.decision,updated_input:I.metadata?.updated_input,reasoning:I.metadata?.reasoning,applied_updates:I.metadata?.applied_updates}),I.type==="system"&&(I.subtype==="init"||I.metadata?.subtype==="init")&&I.metadata?.init_data&&_e().storeInitData(j,I.metadata.init_data)});const L=n.value.get(j);if(L&&L.length>0){const I=L[L.length-1];I.timestamp&&c.value.set(j,I.timestamp)}return n.value=new Map(n.value),{syncedCount:D.length,hasMore:se}}catch(K){return console.error(`Failed to sync messages for session ${j}:`,K),{syncedCount:0,hasMore:!1,error:K.message}}}const Y=_e();return be(()=>Array.from(Y.sessions.values()).map(F=>({id:F.session_id,state:F.state})),(j,F)=>{F&&j.forEach((K,ee)=>{const se=F[ee];if(!se||se.id!==K.id)return;const ne=["active","paused","starting"].includes(se.state),ve=!["active","paused","starting"].includes(K.state);ne&&ve&&V(K.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:xs(a),orphanedToolUses:xs(r),currentMessages:m,currentToolCalls:p,loadMessages:u,addMessage:h,addToolCall:$,updateToolCall:k,handleToolCall:f,handleToolUse:b,handlePermissionRequest:v,handlePermissionResponse:_,handleToolResult:S,toggleToolExpansion:C,clearMessages:N,markToolUseOrphaned:A,isToolUseOrphaned:B,getOrphanedInfo:G,clearOrphanedToolUses:V,getLastReceivedTimestamp:W,syncMessages:z,getBackendToolState:E,hasBackendDisplayMetadata:P,backendToolStates:xs(d)}}),ri=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ne},Symbol.toStringTag,{value:"Module"}));function ci(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Qt(n){return ci(n).toLocaleTimeString()}const ui={class:"message-row message-row-user"},di=["title"],mi={class:"message-content-column"},fi=["innerHTML"],pi={key:0,class:"tool-results mt-2"},vi={class:"tool-results-header text-muted small mb-2"},hi={class:"d-flex align-items-start gap-2"},gi={class:"flex-grow-1"},_i={class:"text-muted"},bi={key:0,class:"text-danger small"},yi={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;nt.setOptions({breaks:!0,gfm:!0});const s=g(()=>Qt(e.message.timestamp)),o=g(()=>`user
${s.value}`),a=g(()=>{const m=e.message.content||"";let p=nt.parse(m);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Jt.sanitize(p)}),r=g(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=g(()=>e.message.metadata?.tool_results||[]);function d(m,p){return m?m.length<=p?m:m.substring(0,p)+"...":""}return(m,p)=>(i(),l("div",ui,[t("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,di),t("div",mi,[t("div",{class:"message-text",innerHTML:a.value},null,8,fi),r.value?(i(),l("div",pi,[t("div",vi," ðŸ”§ Tool Results ("+w(c.value.length)+") ",1),(i(!0),l(le,null,fe(c.value,(u,y)=>(i(),l("div",{key:y,class:Q(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",hi,[t("span",null,w(u.is_error?"âŒ":"âœ…"),1),t("div",gi,[t("small",_i,"Tool: "+w(u.tool_use_id),1),u.is_error?(i(),l("div",bi,w(d(u.content,200)),1)):T("",!0)])])],2))),128))])):T("",!0)])]))}},wi=oe(yi,[["__scopeId","data-v-7665755b"]]),$i={class:"thinking-block"},ki=["aria-label"],Si={class:"text-muted ms-auto"},Ci={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},xi=["innerHTML"],Ei={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=R(!1),o=g(()=>e.thinking?.length||0),a=g(()=>{const c=e.thinking||"",d=nt.parse(c);return Jt.sanitize(d)});function r(){s.value=!s.value}return(c,d)=>(i(),l("div",$i,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[t("span",{"aria-label":s.value?"Collapse":"Expand"},w(s.value?"â–¾":"â–¸"),9,ki),d[0]||(d[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Si,w(o.value)+" characters",1)]),s.value?(i(),l("div",Ci,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,xi)])):T("",!0)]))}},Ti=oe(Ei,[["__scopeId","data-v-fda2352c"]]),Sn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),As={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Ge=at("resource",()=>{const n=R(new Map),e=R(!1),s=R(0),o=R(null),a=R(!1),r=R(new Map);function c(X){if(!X)return!1;if(X.is_image===!0||(X.mime_type||"").toLowerCase().startsWith("image/"))return!0;const de=(X.format||"").toLowerCase();if(de.startsWith("image/")||Sn.has("."+de))return!0;const $e=X.original_filename||X.original_name||"";if($e){const Se="."+$e.split(".").pop().toLowerCase();return Sn.has(Se)}return!1}function d(X){if(!X||c(X))return!1;const ce=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),de=X.original_filename||X.original_name||"";if(de){const Se="."+de.split(".").pop().toLowerCase();if(ce.has(Se))return!0}const $e=(X.mime_type||X.format||"").toLowerCase();return!!($e.startsWith("text/")||$e==="application/json"||$e==="application/xml")}function m(X){if(c(X))return"ðŸ–¼ï¸";if(X.original_filename){const ce="."+X.original_filename.split(".").pop().toLowerCase();return As[ce]||As.default}return As.default}function p(X){return X.original_filename?"."+X.original_filename.split(".").pop().toLowerCase():""}function u(X){const ce=n.value.get(X);return ce||[]}function y(X){return n.value.get(X)?.length||0}function h(X){return y(X)>0}function $(X){return u(X).filter(c)}function k(X){return $(X).length}function b(X){return k(X)>0}const v=g(()=>{const X=_e();return u(X.currentSessionId)}),_=g(()=>{const X=_e();return y(X.currentSessionId)}),f=g(()=>_.value>0),S=g(()=>v.value.filter(c)),C=g(()=>S.value.length),O=g(()=>C.value>0),x=g(()=>!e.value||!o.value?null:u(o.value)[s.value]||null),E=x,P=g(()=>o.value?y(o.value):0),A=P;async function B(X){if(X){a.value=!0;try{const de=(await Gt(`/api/sessions/${X}/resources`)).resources||[];de.sort(($e,Se)=>($e.timestamp||0)-(Se.timestamp||0)),n.value.set(X,de),n.value=new Map(n.value),console.log(`Loaded ${de.length} resources for session ${X}`)}catch(ce){console.error(`Failed to load resources for session ${X}:`,ce),n.value.set(X,[]),n.value=new Map(n.value)}finally{a.value=!1}}}const G=B;function V(X,ce){if(!X||!ce)return;let de=n.value.get(X);de||(de=[],n.value.set(X,de));const $e=de.findIndex(Se=>Se.resource_id===ce.resource_id);$e>=0?de[$e]=ce:de.push(ce),de.sort((Se,Xe)=>(Se.timestamp||0)-(Xe.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${ce.resource_id} to session ${X}`)}const N=V;function W(X,ce){return`/api/sessions/${X}/resources/${ce}`}const z=W;function Y(X,ce){return`/api/sessions/${X}/resources/${ce}/download`}function j(X,ce=0){o.value=X,s.value=Math.max(0,Math.min(ce,y(X)-1)),e.value=!0}function F(){e.value=!1}function K(){if(!o.value)return;const X=y(o.value);X!==0&&(s.value=(s.value+1)%X)}const ee=K;function se(){if(!o.value)return;const X=y(o.value);X!==0&&(s.value=(s.value-1+X)%X)}const ne=se;function ve(X){if(!o.value)return;const ce=y(o.value);ce!==0&&(s.value=Math.max(0,Math.min(X,ce-1)))}const ae=ve;function H(X){n.value.delete(X),n.value=new Map(n.value),o.value===X&&F(),console.log(`Cleared resources for session ${X}`)}const M=H;async function D(X,ce){if(!(!X||!ce))try{await ko(`/api/sessions/${X}/resources/${ce}`),I(X,ce)}catch(de){console.error(`Failed to remove resource ${ce}:`,de)}}function L(X,ce){I(X,ce)}function I(X,ce){const de=n.value.get(X);if(!de)return;const $e=de.findIndex(Se=>Se.resource_id===ce);$e!==-1&&(de.splice($e,1),n.value=new Map(n.value),e.value&&o.value===X&&(de.length===0?F():s.value>=de.length&&(s.value=de.length-1)),r.value.delete(ce),r.value=new Map(r.value))}async function U(X,ce){if(!X||!ce)return null;const de=r.value.get(ce);if(de&&!de.error)return de.content;r.value.set(ce,{content:null,loading:!0,error:null}),r.value=new Map(r.value);try{const $e=W(X,ce),Se=await fetch($e);if(!Se.ok)throw new Error(`HTTP ${Se.status}`);const Xe=await Se.text();return r.value.set(ce,{content:Xe,loading:!1,error:null}),r.value=new Map(r.value),Xe}catch($e){return console.error(`Failed to fetch text content for resource ${ce}:`,$e),r.value.set(ce,{content:null,loading:!1,error:$e.message}),r.value=new Map(r.value),null}}function Z(X){return r.value.get(X)||null}function he(X){if(X){const ce=n.value.get(X);ce&&(ce.forEach(de=>r.value.delete(de.resource_id)),r.value=new Map(r.value))}else r.value=new Map}function Pe(X,ce){const de=n.value.get(X);return de&&de.find($e=>$e.resource_id===ce)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:a,textContentCache:r,currentResources:v,currentResourceCount:_,currentHasResources:f,currentFullViewResource:x,fullViewTotalResources:P,currentImages:S,currentImageCount:C,currentHasImages:O,currentFullViewImage:E,fullViewTotalImages:A,imagesBySession:n,resourcesForSession:u,resourceCount:y,hasResources:h,getResourceUrl:W,getDownloadUrl:Y,isImageResource:c,isTextResource:d,getResourceIcon:m,getResourceExtension:p,getResourceById:Pe,getTextContent:Z,imagesForSession:$,imageCount:k,hasImages:b,getImageUrl:z,loadResources:B,addResource:V,removeResource:D,handleResourceRemoved:L,openFullView:j,closeFullView:F,nextResource:K,prevResource:se,goToResource:ve,clearResources:H,fetchTextContent:U,clearTextCache:he,loadImages:G,addImage:N,nextImage:ee,prevImage:ne,goToImage:ae,clearImages:M}}),Ai=Ge,Di=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ai,useResourceStore:Ge},Symbol.toStringTag,{value:"Module"})),mt=at("websocket",()=>{const n=R(null),e=R(!1),s=R(0),o=10,a=R(null),r=R(!1),c=R(0),d=5,m=R(null);let p=null;const u=R(0),y=R(null),h=R(new Map),$=R(null),k=R(!1),b=R(0),v=5,_=R(null),f=1e4,S=1e3,C=R(Date.now()),O=R(Date.now()),x=R(Date.now());let E=null,P=null,A=null;const B=g(()=>e.value&&(r.value||!m.value)?"connected":e.value?"partial":"disconnected");function G(D){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${D}`}function V(D){const L={ui:{timer:()=>E,setTimer:I=>{E=I},lastPing:C,connected:e,name:"UI"},session:{timer:()=>P,setTimer:I=>{P=I},lastPing:O,connected:r,name:"Session"},legion:{timer:()=>A,setTimer:I=>{A=I},lastPing:x,connected:k,name:"Legion"}}[D];L.timer()&&clearInterval(L.timer()),L.setTimer(setInterval(()=>{if(!L.connected.value)return;const I=Date.now()-L.lastPing.value;if(I>f){console.warn(`âš ï¸ ${L.name} WebSocket heartbeat timeout (${I}ms since last ping) - forcing close to trigger reconnection`),L.connected.value=!1;const Z={ui:n,session:a,legion:$}[D];Z.value&&Z.value.readyState===WebSocket.OPEN&&Z.value.close()}},S)),console.log(`âœ… Started heartbeat monitor for ${L.name} WebSocket`)}function N(D){const L={ui:{get:()=>E,set:I=>{E=I}},session:{get:()=>P,set:I=>{P=I}},legion:{get:()=>A,set:I=>{A=I}}}[D];L.get()&&(clearInterval(L.get()),L.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${D} WebSocket`))}function W(){if(n.value)return;const D=G("/ws/ui");console.log(`Connecting to UI WebSocket: ${D}`),n.value=new WebSocket(D),n.value.onopen=()=>{e.value=!0,s.value=0,C.value=Date.now(),V("ui"),console.log("UI WebSocket connected")},n.value.onmessage=L=>{const I=JSON.parse(L.data);ne(I)},n.value.onclose=()=>{if(N("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const L=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${L}ms (attempt ${s.value})`),setTimeout(W,L)}},n.value.onerror=L=>{console.error("UI WebSocket error:",L)}}function z(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Y(D){u.value++;const L=u.value;if(console.log(`[Gen ${L}] Starting connection to session ${D}`),p&&(clearTimeout(p),p=null),await j(),u.value!==L){console.log(`[Gen ${L}] Connection cancelled (current generation: ${u.value})`);return}m.value=D,y.value=L;const I=G(`/ws/session/${D}`);console.log(`[Gen ${L}] Connecting to Session WebSocket: ${I}`),a.value=new WebSocket(I),a.value.onopen=async()=>{if(y.value!==L){console.log(`[Gen ${L}] Ignoring onopen (stale connection, current: ${y.value})`),a.value.close();return}r.value=!0,c.value=0,O.value=Date.now(),V("session"),console.log(`[Gen ${L}] Session WebSocket connected for ${D}`);const U=h.value.get(D);if(h.value.set(D,!0),U){console.log(`[Gen ${L}] Reconnection detected, syncing missed messages...`);try{const he=await Ne().syncMessages(D);he.syncedCount>0?console.log(`[Gen ${L}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${L}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${L}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${L}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(Z){console.error(`[Gen ${L}] Error during message sync:`,Z)}}else console.log(`[Gen ${L}] Initial connection, no sync needed`)},a.value.onmessage=U=>{if(y.value!==L){console.log(`[Gen ${L}] Ignoring message (stale connection, current: ${y.value})`);return}const Z=JSON.parse(U.data);ve(Z,D)},a.value.onclose=()=>{N("session"),r.value=!1,a.value=null,console.log(`[Gen ${L}] Session WebSocket closed for ${D}`);const U=_e();if(U.currentSessionId===D&&y.value===L&&c.value<d){c.value++;const Z=Math.min(2e3*c.value,3e4);console.log(`[Gen ${L}] Reconnecting Session WebSocket in ${Z}ms (attempt ${c.value})`),p=setTimeout(()=>{y.value===L&&U.currentSessionId===D?(p=null,Y(D)):console.log(`[Gen ${L}] Skipping reconnect (generation or session changed)`)},Z)}},a.value.onerror=U=>{console.error(`[Gen ${L}] Session WebSocket error:`,U)}}function j(){return new Promise(D=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),a.value){const L=m.value,I=()=>{a.value=null,r.value=!1,m.value=null,y.value=null,c.value=0,L&&h.value.delete(L),D()};if(a.value.readyState===WebSocket.CLOSED)I();else{const U=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),I()},2e3);a.value.addEventListener("close",()=>{clearTimeout(U),I()},{once:!0}),a.value.close()}}else m.value=null,y.value=null,D()})}function F(D){a.value&&r.value?(a.value.send(JSON.stringify({type:"send_message",content:D})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function K(D,L,I=!1,U=null,Z=null){if(a.value&&r.value){const he={type:"permission_response",request_id:D,decision:L,apply_suggestions:I,timestamp:new Date().toISOString()};U&&(he.clarification_message=U),Z&&(he.selected_suggestions=Z),a.value.send(JSON.stringify(he)),console.log(`Sent permission ${L} for request ${D}`,{applySuggestions:I,clarification:U,selectedSuggestions:Z})}}function ee(D,L,I){if(a.value&&r.value){const U={type:"permission_response",request_id:D,decision:L,updated_input:I,timestamp:new Date().toISOString()};a.value.send(JSON.stringify(U)),console.log(`Sent permission ${L} with updated_input for request ${D}`,I)}}function se(){a.value&&r.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ne(D){const L=_e(),I=He();switch(D.type){case"sessions_list":D.sessions&&Array.isArray(D.sessions)&&D.sessions.forEach(U=>{L.updateSession(U.session_id,U)});break;case"state_change":D.data&&D.data.session_id&&D.data.session&&L.updateSession(D.data.session_id,D.data.session);break;case"project_updated":if(D.data&&D.data.project){const U=D.data.project;I.updateProjectLocal(U.project_id,U),L.fetchSessions()}break;case"project_deleted":D.data&&D.data.project_id&&I.projects.delete(D.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":C.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",D.type)}}function ve(D,L){const I=_e();if(I.currentSessionId!==L){console.warn(`Ignoring message for session ${L} (current: ${I.currentSessionId})`);return}const U=Ne();switch(D.type){case"message":const Z=D.data;if(!Z||!Z.type){console.warn("Received message event with invalid data:",D);break}if(Z.type==="tool_call"){U.handleToolCall(L,Z);break}if(Z.type==="permission_request"){U.handlePermissionRequest(L,Z);break}if(Z.type==="permission_response"){U.handlePermissionResponse(L,Z);break}Z.metadata?.has_tool_uses&&Z.metadata.tool_uses.forEach(he=>{U.handleToolUse(L,he,Z.timestamp)}),Z.metadata?.has_tool_results&&Z.metadata.tool_results.forEach(he=>{U.handleToolResult(L,he)}),Z.type==="system"&&(Z.subtype==="init"||Z.metadata?.subtype==="init")&&Z.metadata?.init_data&&I.storeInitData(L,Z.metadata.init_data),U.addMessage(L,Z);break;case"permission_request":U.handlePermissionRequest(L,D);break;case"permission_response":U.handlePermissionResponse(L,D);break;case"tool_result":U.handleToolResult(L,D);break;case"state_change":I.updateSession(L,D.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${L}`);break;case"ping":O.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":D.resource&&(Ge().addResource(L,D.resource),console.log(`Resource registered for session ${L}:`,D.resource.resource_id));break;case"resource_removed":D.resource_id&&(Ge().handleResourceRemoved(L,D.resource_id),console.log(`Resource removed for session ${L}:`,D.resource_id));break;case"image_registered":D.image&&(Ge().addResource(L,{...D.image,resource_id:D.image.image_id}),console.log(`Image registered (legacy) for session ${L}:`,D.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",D.type)}}function ae(D){H(),_.value=D;const L=G(`/ws/legion/${D}`);console.log(`Connecting to Legion WebSocket: ${L}`),$.value=new WebSocket(L),$.value.onopen=()=>{k.value=!0,b.value=0,x.value=Date.now(),V("legion"),console.log(`Legion WebSocket connected for ${D}`)},$.value.onmessage=I=>{const U=JSON.parse(I.data);M(U,D)},$.value.onclose=()=>{if(N("legion"),k.value=!1,$.value=null,console.log(`Legion WebSocket closed for ${D}`),_.value===D&&b.value<v){b.value++;const I=Math.min(2e3*b.value,3e4);setTimeout(()=>ae(D),I)}},$.value.onerror=I=>{console.error("Legion WebSocket error:",I)}}function H(){$.value&&($.value.close(),$.value=null,k.value=!1,_.value=null)}function M(D,L){Le(async()=>{const{useLegionStore:I}=await Promise.resolve().then(()=>Ub);return{useLegionStore:I}},void 0).then(({useLegionStore:I})=>{const U=I();switch(D.type){case"comm":D.comm&&(U.addComm(L,D.comm),console.log("Legion WebSocket: Received new comm",D.comm));break;case"minion_created":D.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",D.data),Le(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>kn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"minion_updated":D.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",D.data),Le(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>kn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${L}`);break;case"ping":x.value=Date.now(),$.value?.readyState===WebSocket.OPEN&&$.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",D.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:r,sessionRetryCount:c,legionConnected:k,legionRetryCount:b,overallStatus:B,connectUI:W,disconnectUI:z,connectSession:Y,disconnectSession:j,sendMessage:F,sendPermissionResponse:K,sendPermissionResponseWithInput:ee,interruptSession:se,connectLegion:ae,disconnectLegion:H}}),Mi=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:mt},Symbol.toStringTag,{value:"Module"})),Oi={class:"base-tool-handler"},Li={class:"tool-section"},Ni={class:"tool-parameters"},Ii={class:"tool-code"},ji={key:0,class:"tool-section"},Ri={class:"tool-section-label"},Pi={class:"tool-code"},Fi={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=g(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,d)=>(i(),l("div",Oi,[t("div",Li,[d[0]||(d[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Ni,[t("pre",Ii,w(s.value),1)])]),o.value?(i(),l("div",ji,[t("div",Ri,w(a.value?"Error:":"Result:"),1),t("div",{class:Q(["tool-result",{"tool-result-error":a.value}])},[t("pre",Pi,w(r.value),1)],2)])):T("",!0)]))}},Bi=oe(Fi,[["__scopeId","data-v-1e69f57d"]]),Wi={class:"read-tool-handler"},Vi={class:"tool-section"},Hi={class:"read-file-info"},Ui={class:"file-icon"},qi={class:"file-path"},zi={key:0,class:"read-range"},Ki={key:0,class:"tool-section"},Gi={key:0,class:"tool-result tool-result-error"},Yi={class:"tool-code"},Ji={key:1,class:"image-preview"},Qi={class:"content-header"},Xi={class:"image-badge"},Zi={class:"image-container"},el=["src","alt"],tl={key:2,class:"file-content-preview"},sl={class:"content-header"},nl={class:"line-count-badge"},ol={key:0,class:"preview-note"},al={class:"tool-code content-display"},il={key:0,class:"more-indicator"},Ds=100,ll={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>{const _=s.value;return _.split("/").pop()||_}),a=g(()=>{const _=e.toolCall.input?.offset,f=e.toolCall.input?.limit;return _!==void 0||f!==void 0}),r=g(()=>{const _=e.toolCall.input?.offset;return _!==void 0?_+1:1}),c=g(()=>{const _=e.toolCall.input?.offset||0,f=e.toolCall.input?.limit;return f!==void 0?_+f:"âˆž"}),d=g(()=>{const _=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(_)}),m=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=g(()=>{if(!m.value||p.value)return null;const f=e.toolCall.result?.content;if(Array.isArray(f)){for(const S of f)if(S?.type==="image"&&S?.source?.type==="base64"&&S?.source?.data)return S.source.data}return null}),y=g(()=>{if(!u.value)return"";const _=s.value.toLowerCase();return _.endsWith(".png")?"image/png":_.endsWith(".jpg")||_.endsWith(".jpeg")?"image/jpeg":_.endsWith(".gif")?"image/gif":_.endsWith(".webp")?"image/webp":_.endsWith(".svg")?"image/svg+xml":_.endsWith(".bmp")?"image/bmp":_.endsWith(".ico")?"image/x-icon":"image/png"}),h=g(()=>{if(!m.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),$=g(()=>p.value||!h.value||u.value?[]:h.value.split(`
`)),k=g(()=>$.value.length),b=g(()=>k.value>Ds),v=g(()=>p.value||u.value?"":$.value.slice(0,Ds).join(`
`));return(_,f)=>(i(),l("div",Wi,[t("div",Vi,[t("div",Hi,[t("span",Ui,w(d.value?"ðŸ–¼ï¸":"ðŸ“„"),1),f[0]||(f[0]=t("strong",null,"Reading:",-1)),t("code",qi,w(s.value),1),a.value?(i(),l("span",zi,"Lines "+w(r.value)+"-"+w(c.value),1)):T("",!0)])]),m.value?(i(),l("div",Ki,[p.value?(i(),l("div",Gi,[t("pre",Yi,w(h.value),1)])):u.value?(i(),l("div",Ji,[t("div",Qi,[f[1]||(f[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",Xi,w(y.value),1)]),t("div",Zi,[t("img",{src:`data:${y.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,el)])])):(i(),l("div",tl,[t("div",sl,[f[2]||(f[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",nl,w(k.value)+" lines",1),b.value?(i(),l("span",ol,"(showing first "+w(Ds)+")")):T("",!0)]),t("pre",al,w(v.value),1),b.value?(i(),l("div",il,"...")):T("",!0)]))])):T("",!0)]))}},rl=oe(ll,[["__scopeId","data-v-29b774b1"]]),cl={class:"write-tool-handler"},ul={class:"tool-section"},dl={class:"write-file-info mb-2"},ml={class:"file-path"},fl={class:"write-content-preview"},pl={class:"content-header"},vl={class:"line-count-badge"},hl={key:0,class:"preview-note"},gl={class:"tool-code content-display"},_l={key:0,class:"more-indicator"},bl={key:0,class:"tool-section"},yl={key:0,class:"tool-result tool-result-error"},wl={class:"tool-code"},$l={key:1,class:"tool-result tool-result-success"},kl={class:"success-message"},Ms=100,Sl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.content||""),a=g(()=>o.value.split(`
`)),r=g(()=>a.value.length),c=g(()=>r.value>Ms),d=g(()=>a.value.slice(0,Ms).join(`
`)),m=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=g(()=>{if(!m.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,h)=>(i(),l("div",cl,[t("div",ul,[t("div",dl,[h[0]||(h[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",ml,w(s.value),1)]),t("div",fl,[t("div",pl,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",vl,w(r.value)+" lines",1),c.value?(i(),l("span",hl,"(showing first "+w(Ms)+")")):T("",!0)]),t("pre",gl,w(d.value),1),c.value?(i(),l("div",_l,"...")):T("",!0)])]),m.value?(i(),l("div",bl,[p.value?(i(),l("div",yl,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",wl,w(u.value),1)])):(i(),l("div",$l,[t("div",kl,[h[4]||(h[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+w(r.value)+" lines written)",1)])]))])):T("",!0)]))}},Cl=oe(Sl,[["__scopeId","data-v-ddc24a0f"]]),xl={class:"bash-tool-handler"},El={class:"tool-section"},Tl={class:"bash-header"},Al={class:"bash-header-content"},Dl={key:0,class:"bash-description"},Ml={key:1,class:"bash-flags"},Ol={class:"bash-command-section"},Ll={class:"bash-command-content"},Nl={key:0,class:"tool-section"},Il={key:0,class:"bash-output"},jl={key:1,class:"bash-output-empty"},Rl={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.command||""),o=g(()=>e.toolCall.input?.description||""),a=g(()=>e.toolCall.input?.timeout),r=g(()=>e.toolCall.input?.run_in_background||!1),c=g(()=>a.value||r.value),d=g(()=>{const h=[];return a.value&&h.push(`timeout: ${a.value}ms`),r.value&&h.push("background"),h.join(", ")}),m=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=g(()=>p.value?"tool-result-error":"tool-result-success"),y=g(()=>{if(!m.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,$)=>(i(),l("div",xl,[t("div",El,[t("div",Tl,[$[1]||($[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Al,[o.value?(i(),l("div",Dl,[$[0]||($[0]=t("strong",null,"Description:",-1)),re(" "+w(o.value),1)])):T("",!0),c.value?(i(),l("div",Ml,w(d.value),1)):T("",!0)])]),t("div",Ol,[$[2]||($[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Ll,w(s.value),1)])]),m.value?(i(),l("div",Nl,[t("div",{class:Q(["tool-result",u.value])},[$[3]||($[3]=t("strong",null,"Output:",-1)),y.value?(i(),l("pre",Il,w(y.value),1)):(i(),l("div",jl,"No output"))],2)])):T("",!0)]))}},Pl=oe(Rl,[["__scopeId","data-v-ab50fe73"]]),Fl={class:"todo-tool-handler"},Bl={class:"tool-section"},Wl={class:"todo-header"},Vl={class:"todo-summary"},Hl={key:0,class:"todo-count todo-count-completed"},Ul={key:1,class:"todo-count todo-count-in-progress"},ql={key:2,class:"todo-count todo-count-pending"},zl={class:"todo-checklist"},Kl={class:"todo-checkbox"},Gl={class:"todo-content"},Yl={key:0,class:"tool-section"},Jl={key:0,class:"tool-result tool-result-error"},Ql={class:"tool-code"},Xl={key:1,class:"tool-result tool-result-success"},Zl={class:"success-message"},er={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.todos||[]),o=g(()=>s.value.filter(u=>u.status==="completed").length),a=g(()=>s.value.filter(u=>u.status==="in_progress").length),r=g(()=>s.value.filter(u=>u.status==="pending").length);function c(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const d=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=g(()=>{if(!d.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,y)=>(i(),l("div",Fl,[t("div",Bl,[t("div",Wl,[y[0]||(y[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),y[1]||(y[1]=t("strong",null,"Task List:",-1)),t("div",Vl,[o.value>0?(i(),l("span",Hl,w(o.value)+" completed ",1)):T("",!0),a.value>0?(i(),l("span",Ul,w(a.value)+" in progress ",1)):T("",!0),r.value>0?(i(),l("span",ql,w(r.value)+" pending ",1)):T("",!0)])]),t("div",zl,[(i(!0),l(le,null,fe(s.value,(h,$)=>(i(),l("div",{key:$,class:Q(["todo-item",`todo-${h.status}`])},[t("span",Kl,w(c(h.status)),1),t("span",Gl,w(h.content),1)],2))),128))])]),d.value?(i(),l("div",Yl,[m.value?(i(),l("div",Jl,[y[2]||(y[2]=t("strong",null,"Error:",-1)),t("pre",Ql,w(p.value),1)])):(i(),l("div",Xl,[t("div",Zl,[y[3]||(y[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+w(s.value.length)+" tasks)",1)])]))])):T("",!0)]))}},tr=oe(er,[["__scopeId","data-v-bbe55ee7"]]),sr={class:"edit-tool-handler"},nr={class:"tool-section"},or={class:"edit-file-info"},ar={class:"file-path"},ir={key:0,class:"replace-all-badge"},lr={class:"edit-diff-container"},rr={class:"diff-header"},cr={class:"diff-stats"},ur={class:"stat-removed"},dr={class:"stat-added"},mr={class:"unified-diff"},fr={class:"diff-scroll-container"},pr={class:"diff-marker"},vr={class:"diff-content"},hr={key:0,class:"tool-section"},gr={key:0,class:"tool-result tool-result-error"},_r={class:"tool-code"},br={key:1,class:"tool-result tool-result-success"},yr={class:"success-message"},wr={key:0,class:"success-detail"},$r={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.old_string||""),a=g(()=>e.toolCall.input?.new_string||""),r=g(()=>e.toolCall.input?.replace_all||!1),c=g(()=>{const $=ja(s.value,o.value,a.value,"","",{context:3}).split(`
`),k=[];for(let b=4;b<$.length;b++){const v=$[b];v&&(v.startsWith("-")?k.push({type:"removed",content:v.substring(1)}):v.startsWith("+")?k.push({type:"added",content:v.substring(1)}):v.startsWith(" ")?k.push({type:"context",content:v.substring(1)}):v.startsWith("@@")&&k.push({type:"hunk",content:v}))}return k}),d=g(()=>c.value.filter(h=>h.type==="removed").length),m=g(()=>c.value.filter(h=>h.type==="added").length),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,$)=>(i(),l("div",sr,[t("div",nr,[t("div",or,[$[0]||($[0]=t("span",{class:"file-icon"},"âœï¸",-1)),$[1]||($[1]=t("strong",null,"Editing:",-1)),t("code",ar,w(s.value),1),r.value?(i(),l("span",ir,"Replace All")):T("",!0)]),t("div",lr,[t("div",rr,[$[2]||($[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",cr,[t("span",ur,"-"+w(d.value),1),t("span",dr,"+"+w(m.value),1)])]),t("div",mr,[t("div",fr,[(i(!0),l(le,null,fe(c.value,(k,b)=>(i(),l("div",{key:b,class:Q(["diff-line",{"diff-line-removed":k.type==="removed","diff-line-added":k.type==="added","diff-line-context":k.type==="context","diff-line-hunk":k.type==="hunk"}])},[t("span",pr,w(k.type==="removed"?"-":k.type==="added"?"+":k.type==="hunk"?"@":" "),1),t("span",vr,w(k.content),1)],2))),128))])])])]),p.value?(i(),l("div",hr,[u.value?(i(),l("div",gr,[$[3]||($[3]=t("strong",null,"Error:",-1)),t("pre",_r,w(y.value),1)])):(i(),l("div",br,[t("div",yr,[$[4]||($[4]=t("span",{class:"success-icon"},"âœ…",-1)),$[5]||($[5]=t("strong",null,"File edited successfully",-1)),r.value?(i(),l("span",wr,"(all occurrences replaced)")):T("",!0)])]))])):T("",!0)]))}},kr=oe($r,[["__scopeId","data-v-dd74055e"]]),Sr={class:"search-tool-handler"},Cr={class:"tool-section"},xr={class:"search-info"},Er={class:"search-icon"},Tr={class:"search-pattern"},Ar={key:0,class:"search-path"},Dr={key:1,class:"search-filters"},Mr={key:0,class:"filter-badge"},Or={key:1,class:"filter-badge"},Lr={key:2,class:"filter-badge"},Nr={key:0,class:"tool-section"},Ir={key:0,class:"tool-result tool-result-error"},jr={class:"tool-code"},Rr={key:1,class:"search-results"},Pr={class:"results-header"},Fr={class:"results-label"},Br={class:"results-count-badge"},Wr={class:"results-content"},Vr={class:"tool-code"},Hr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="Grep"),o=g(()=>e.toolCall.input?.pattern||"Unknown"),a=g(()=>e.toolCall.input?.path||null),r=g(()=>e.toolCall.input?.type||null),c=g(()=>e.toolCall.input?.glob||null),d=g(()=>e.toolCall.input?.["-i"]||!1),m=g(()=>r.value||c.value||d.value),p=g(()=>s.value?"ðŸ”":"ðŸ“"),u=g(()=>s.value?"Searching content":"Finding files"),y=g(()=>s.value?"Matches":"Files found"),h=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=g(()=>{if(!h.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),b=g(()=>!h.value||$.value||!k.value?0:k.value.split(`
`).filter(_=>_.trim()).length);return(v,_)=>(i(),l("div",Sr,[t("div",Cr,[t("div",xr,[t("span",Er,w(p.value),1),t("strong",null,w(u.value)+":",1),t("code",Tr,w(o.value),1),a.value?(i(),l("span",Ar,"in "+w(a.value),1)):T("",!0),m.value?(i(),l("span",Dr,[r.value?(i(),l("span",Mr,"type: "+w(r.value),1)):T("",!0),c.value?(i(),l("span",Or,"glob: "+w(c.value),1)):T("",!0),d.value?(i(),l("span",Lr,"case-insensitive")):T("",!0)])):T("",!0)])]),h.value?(i(),l("div",Nr,[$.value?(i(),l("div",Ir,[_[0]||(_[0]=t("strong",null,"Error:",-1)),t("pre",jr,w(k.value),1)])):(i(),l("div",Rr,[t("div",Pr,[t("span",Fr,w(y.value)+":",1),t("span",Br,w(b.value)+" "+w(b.value===1?"match":"matches"),1)]),t("div",Wr,[t("pre",Vr,w(k.value),1)])]))])):T("",!0)]))}},Cn=oe(Hr,[["__scopeId","data-v-0d272c39"]]),Ur={class:"web-tool-handler"},qr={class:"tool-section"},zr={class:"web-info"},Kr={class:"web-icon"},Gr=["href"],Yr={key:1,class:"web-query"},Jr={key:0,class:"web-prompt-container"},Qr={class:"prompt-content"},Xr={key:1,class:"web-domains"},Zr={class:"domains-label"},ec={key:0,class:"tool-section"},tc={key:0,class:"tool-result tool-result-error"},sc={class:"tool-code"},nc={key:1,class:"web-results"},oc={class:"results-header"},ac={class:"results-label"},ic={class:"results-content"},lc={class:"tool-code"},rc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="WebFetch"),o=g(()=>e.toolCall.input?.url||null),a=g(()=>e.toolCall.input?.query||null),r=g(()=>e.toolCall.input?.prompt||null),c=g(()=>e.toolCall.input?.allowed_domains||[]),d=g(()=>e.toolCall.input?.blocked_domains||[]),m=g(()=>c.value.length>0?c.value:d.value.length>0?d.value:[]),p=g(()=>c.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),u=g(()=>s.value?"ðŸŒ":"ðŸ”Ž"),y=g(()=>s.value?"Fetching URL":"Searching web"),h=g(()=>s.value?"Fetched content":"Search results"),$=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=g(()=>{if(!$.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,_)=>(i(),l("div",Ur,[t("div",qr,[t("div",zr,[t("span",Kr,w(u.value),1),t("strong",null,w(y.value)+":",1),o.value?(i(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},w(o.value),9,Gr)):a.value?(i(),l("code",Yr,w(a.value),1)):T("",!0)]),r.value?(i(),l("div",Jr,[_[0]||(_[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Qr,w(r.value),1)])):T("",!0),m.value.length>0?(i(),l("div",Xr,[t("span",Zr,w(p.value)+":",1),(i(!0),l(le,null,fe(m.value,f=>(i(),l("span",{key:f,class:"domain-badge"},w(f),1))),128))])):T("",!0)]),$.value?(i(),l("div",ec,[k.value?(i(),l("div",tc,[_[1]||(_[1]=t("strong",null,"Error:",-1)),t("pre",sc,w(b.value),1)])):(i(),l("div",nc,[t("div",oc,[t("span",ac,w(h.value)+":",1)]),t("div",ic,[t("pre",lc,w(b.value),1)])]))])):T("",!0)]))}},xn=oe(rc,[["__scopeId","data-v-62b55b55"]]),cc={class:"task-tool-handler"},uc={class:"tool-section"},dc={class:"task-header"},mc={key:0,class:"agent-type-badge"},fc={key:0,class:"task-description"},pc={class:"description-content"},vc={key:1,class:"task-prompt-container"},hc={class:"prompt-header"},gc={class:"prompt-length"},_c={class:"prompt-code"},bc={key:0,class:"tool-section"},yc={key:0,class:"tool-result tool-result-error"},wc={class:"tool-code"},$c={key:1,class:"agent-output"},kc={class:"output-header"},Sc={key:0,class:"output-count-badge"},Cc={class:"output-content"},xc={class:"tool-code"},Ec={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.description||null),o=g(()=>e.toolCall.input?.prompt||null),a=g(()=>e.toolCall.input?.subagent_type||null),r=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=g(()=>{if(!r.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),m=g(()=>d.value?d.value.split(`
`).length:0);return(p,u)=>(i(),l("div",cc,[t("div",uc,[t("div",dc,[u[0]||(u[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=t("strong",null,"Agent Task:",-1)),a.value?(i(),l("span",mc,w(a.value),1)):T("",!0)]),s.value?(i(),l("div",fc,[u[2]||(u[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",pc,w(s.value),1)])):T("",!0),o.value?(i(),l("div",vc,[t("div",hc,[u[3]||(u[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",gc,w(o.value.length)+" characters",1)]),t("pre",_c,w(o.value),1)])):T("",!0)]),r.value?(i(),l("div",bc,[c.value?(i(),l("div",yc,[u[4]||(u[4]=t("strong",null,"Error:",-1)),t("pre",wc,w(d.value),1)])):(i(),l("div",$c,[t("div",kc,[u[5]||(u[5]=t("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(i(),l("span",Sc,w(m.value)+" lines",1)):T("",!0)]),t("div",Cc,[t("pre",xc,w(d.value),1)])]))])):T("",!0)]))}},Tc=oe(Ec,[["__scopeId","data-v-c520c244"]]),Ac={class:"task-create-tool-handler"},Dc={class:"tool-section"},Mc={class:"task-details p-2"},Oc={key:0,class:"task-field mb-2"},Lc={class:"field-value subject-value"},Nc={key:1,class:"task-field mb-2"},Ic={class:"field-value description-value"},jc={key:2,class:"task-field"},Rc={class:"field-value active-form-value"},Pc={key:0,class:"tool-section mt-2"},Fc={key:0,class:"tool-result tool-result-error"},Bc={class:"tool-code"},Wc={key:1,class:"tool-result tool-result-success"},Vc={class:"result-text"},Hc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.subject||null),o=g(()=>e.toolCall.input?.description||null),a=g(()=>e.toolCall.input?.activeForm||null),r=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=g(()=>{if(!r.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,p)=>(i(),l("div",Ac,[t("div",Dc,[p[3]||(p[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Mc,[s.value?(i(),l("div",Oc,[p[0]||(p[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Lc,w(s.value),1)])):T("",!0),o.value?(i(),l("div",Nc,[p[1]||(p[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Ic,w(o.value),1)])):T("",!0),a.value?(i(),l("div",jc,[p[2]||(p[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Rc,w(a.value),1)])):T("",!0)])]),r.value?(i(),l("div",Pc,[c.value?(i(),l("div",Fc,[p[4]||(p[4]=t("strong",null,"Error:",-1)),t("pre",Bc,w(d.value),1)])):(i(),l("div",Wc,[p[5]||(p[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Vc,w(d.value),1)]))])):T("",!0)]))}},Uc=oe(Hc,[["__scopeId","data-v-474dd444"]]),qc={class:"task-update-tool-handler"},zc={class:"tool-section"},Kc={class:"task-header"},Gc={key:0,class:"task-id-badge"},Yc={class:"task-details p-2"},Jc={key:0,class:"task-field mb-2"},Qc={key:1,class:"task-field mb-2"},Xc={class:"field-value"},Zc={key:2,class:"task-field mb-2"},eu={class:"field-value description-value"},tu={key:3,class:"task-field mb-2"},su={class:"field-value active-form-value"},nu={key:4,class:"task-field mb-2"},ou={class:"field-value"},au={key:5,class:"task-field mb-2"},iu={class:"field-value"},lu={key:6,class:"task-field"},ru={class:"field-value"},cu={key:0,class:"tool-section mt-2"},uu={key:0,class:"tool-result tool-result-error"},du={class:"tool-code"},mu={key:1,class:"tool-result tool-result-success"},fu={class:"result-text"},pu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.taskId||null),o=g(()=>e.toolCall.input?.status||null),a=g(()=>e.toolCall.input?.subject||null),r=g(()=>e.toolCall.input?.description||null),c=g(()=>e.toolCall.input?.activeForm||null),d=g(()=>e.toolCall.input?.owner||null),m=g(()=>e.toolCall.input?.addBlockedBy||[]),p=g(()=>e.toolCall.input?.addBlocks||[]),u=g(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),y=g(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),h=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=g(()=>{if(!h.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,v)=>(i(),l("div",qc,[t("div",zc,[t("div",Kc,[v[0]||(v[0]=t("span",{class:"task-icon"},"âœï¸",-1)),v[1]||(v[1]=t("strong",null,"Update Task",-1)),s.value?(i(),l("span",Gc,"#"+w(s.value),1)):T("",!0)]),t("div",Yc,[o.value?(i(),l("div",Jc,[v[2]||(v[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:Q(["field-value status-value",y.value])},w(u.value)+" "+w(o.value),3)])):T("",!0),a.value?(i(),l("div",Qc,[v[3]||(v[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Xc,w(a.value),1)])):T("",!0),r.value?(i(),l("div",Zc,[v[4]||(v[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",eu,w(r.value),1)])):T("",!0),c.value?(i(),l("div",tu,[v[5]||(v[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",su,w(c.value),1)])):T("",!0),d.value?(i(),l("div",nu,[v[6]||(v[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",ou,w(d.value),1)])):T("",!0),m.value?.length?(i(),l("div",au,[v[7]||(v[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",iu,[(i(!0),l(le,null,fe(m.value,_=>(i(),l("span",{key:_,class:"badge bg-warning text-dark me-1"},"#"+w(_),1))),128))])])):T("",!0),p.value?.length?(i(),l("div",lu,[v[8]||(v[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",ru,[(i(!0),l(le,null,fe(p.value,_=>(i(),l("span",{key:_,class:"badge bg-info text-dark me-1"},"#"+w(_),1))),128))])])):T("",!0)])]),h.value?(i(),l("div",cu,[$.value?(i(),l("div",uu,[v[9]||(v[9]=t("strong",null,"Error:",-1)),t("pre",du,w(k.value),1)])):(i(),l("div",mu,[v[10]||(v[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",fu,w(k.value),1)]))])):T("",!0)]))}},vu=oe(pu,[["__scopeId","data-v-35582330"]]),hu={class:"task-list-tool-handler"},gu={key:0,class:"tool-section"},_u={key:0,class:"tool-result tool-result-error"},bu={class:"tool-code"},yu={key:1,class:"task-list-result"},wu={key:0,class:"parsed-tasks"},$u={class:"status-icon"},ku={class:"task-id text-muted"},Su={class:"task-subject flex-grow-1"},Cu={key:0,class:"task-owner badge bg-secondary"},xu={key:1,class:"raw-result p-2"},Eu={class:"tool-code"},Tu={key:1,class:"tool-section"},Au={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=g(()=>{if(!s.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),r=g(()=>{if(!a.value)return[];const d=[],p=a.value.split(`
`);for(const u of p){const y=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(y){const h=y[2].toLowerCase();d.push({id:y[1],status:h,subject:y[3].trim(),owner:null,statusIcon:c(h)})}}return d});function c(d){switch(d){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(d,m)=>(i(),l("div",hu,[m[2]||(m[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(i(),l("div",gu,[o.value?(i(),l("div",_u,[m[0]||(m[0]=t("strong",null,"Error:",-1)),t("pre",bu,w(a.value),1)])):(i(),l("div",yu,[r.value.length>0?(i(),l("div",wu,[(i(!0),l(le,null,fe(r.value,(p,u)=>(i(),l("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",$u,w(p.statusIcon),1),t("span",ku,"#"+w(p.id),1),t("span",Su,w(p.subject),1),p.owner?(i(),l("span",Cu,w(p.owner),1)):T("",!0)]))),128))])):(i(),l("div",xu,[t("pre",Eu,w(a.value),1)]))]))])):n.toolCall.status==="completed"?(i(),l("div",Tu,[...m[1]||(m[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):T("",!0)]))}},Du=oe(Au,[["__scopeId","data-v-4e79ba4b"]]),Mu={class:"task-get-tool-handler"},Ou={class:"tool-section"},Lu={class:"task-header"},Nu={key:0,class:"task-id-badge"},Iu={key:0,class:"tool-section"},ju={key:0,class:"tool-result tool-result-error"},Ru={class:"tool-code"},Pu={key:1,class:"task-details-result p-2"},Fu={key:0,class:"parsed-task"},Bu={class:"task-field mb-2"},Wu={class:"field-value subject-value"},Vu={key:0,class:"task-field mb-2"},Hu={key:1,class:"task-field mb-2"},Uu={class:"field-value description-value"},qu={key:2,class:"task-field mb-2"},zu={class:"field-value"},Ku={key:3,class:"task-field mb-2"},Gu={class:"field-value"},Yu={key:4,class:"task-field"},Ju={class:"field-value"},Qu={key:1,class:"raw-result"},Xu={class:"tool-code"},Zu={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.taskId||null),o=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=g(()=>{if(!o.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),c=g(()=>{if(!r.value)return null;const p=r.value;try{const h=JSON.parse(p);if(h&&typeof h=="object")return{subject:h.subject||h.title||"",status:h.status||"",description:h.description||"",owner:h.owner||"",blockedBy:h.blockedBy||[],blocks:h.blocks||[]}}catch{}const u=p.split(`
`),y={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const h of u){const $=h.match(/^Subject:\s*(.+)$/i);$&&(y.subject=$[1].trim());const k=h.match(/^Status:\s*(.+)$/i);k&&(y.status=k[1].trim());const b=h.match(/^Description:\s*(.+)$/i);b&&(y.description=b[1].trim());const v=h.match(/^Owner:\s*(.+)$/i);v&&(y.owner=v[1].trim())}return y.subject?y:null}),d=g(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=g(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,u)=>(i(),l("div",Mu,[t("div",Ou,[t("div",Lu,[u[0]||(u[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=t("strong",null,"Get Task",-1)),s.value?(i(),l("span",Nu,"#"+w(s.value),1)):T("",!0)])]),o.value?(i(),l("div",Iu,[a.value?(i(),l("div",ju,[u[2]||(u[2]=t("strong",null,"Error:",-1)),t("pre",Ru,w(r.value),1)])):(i(),l("div",Pu,[c.value?(i(),l("div",Fu,[t("div",Bu,[u[3]||(u[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Wu,w(c.value.subject),1)]),c.value.status?(i(),l("div",Vu,[u[4]||(u[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:Q(["field-value",m.value])},w(d.value)+" "+w(c.value.status),3)])):T("",!0),c.value.description?(i(),l("div",Hu,[u[5]||(u[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",Uu,w(c.value.description),1)])):T("",!0),c.value.owner?(i(),l("div",qu,[u[6]||(u[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",zu,w(c.value.owner),1)])):T("",!0),c.value.blockedBy?.length?(i(),l("div",Ku,[u[7]||(u[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",Gu,[(i(!0),l(le,null,fe(c.value.blockedBy,y=>(i(),l("span",{key:y,class:"badge bg-warning text-dark me-1"},"#"+w(y),1))),128))])])):T("",!0),c.value.blocks?.length?(i(),l("div",Yu,[u[8]||(u[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",Ju,[(i(!0),l(le,null,fe(c.value.blocks,y=>(i(),l("span",{key:y,class:"badge bg-info text-dark me-1"},"#"+w(y),1))),128))])])):T("",!0)])):(i(),l("div",Qu,[t("pre",Xu,w(r.value),1)]))]))])):T("",!0)]))}},ed=oe(Zu,[["__scopeId","data-v-a80d14da"]]),td={class:"notebook-edit-tool-handler"},sd={class:"tool-section"},nd={class:"notebook-info"},od={class:"file-path"},ad={class:"cell-info mt-2"},id={class:"info-row"},ld={class:"info-row"},rd={key:0,class:"info-row"},cd={class:"badge bg-info"},ud={key:0,class:"source-preview mt-3"},dd={class:"preview-header"},md={class:"preview-stats"},fd={class:"source-code"},pd={key:0,class:"tool-section"},vd={key:0},hd={key:1,class:"text-danger"},gd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.notebook_path||"Unknown"),o=g(()=>e.toolCall.input?.cell_id),a=g(()=>e.toolCall.input?.cell_type||"code"),r=g(()=>e.toolCall.input?.edit_mode||"replace"),c=g(()=>e.toolCall.input?.new_source||""),d=g(()=>c.value.split(`
`).length),m=g(()=>a.value==="code"?"bg-primary":"bg-secondary"),p=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const y=r.value;return y==="insert"?"Cell inserted successfully":y==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(y,h)=>(i(),l("div",td,[t("div",sd,[t("div",nd,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",od,w(s.value),1)]),t("div",ad,[t("div",id,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,w(o.value||"N/A"),1)]),t("div",ld,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:Q(["badge",m.value])},w(a.value),3)]),r.value?(i(),l("div",rd,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",cd,w(r.value),1)])):T("",!0)]),c.value?(i(),l("div",ud,[t("div",dd,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",md,w(d.value)+" lines",1)]),t("pre",fd,[t("code",null,w(c.value),1)])])):T("",!0)]),n.toolCall.result?(i(),l("div",pd,[h[6]||(h[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Q(["tool-result",p.value])},[n.toolCall.result.success!==!1?(i(),l("div",vd," âœ… "+w(u.value),1)):(i(),l("div",hd," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)])):T("",!0)]))}},_d=oe(gd,[["__scopeId","data-v-c81a9bcf"]]),bd={class:"shell-tool-handler"},yd={class:"tool-section"},wd={class:"shell-info"},$d={class:"shell-icon"},kd={key:0,class:"shell-id"},Sd={key:0,class:"filter-info mt-2"},Cd={class:"filter-pattern"},xd={key:0,class:"tool-section"},Ed={class:"result-header mb-2"},Td={key:0,class:"mb-2"},Ad={class:"shell-output"},Dd={key:1,class:"mb-2"},Md={class:"shell-output shell-output-error"},Od={key:0},Ld={key:1,class:"text-danger"},Nd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=g(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=g(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=g(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=g(()=>e.toolCall.input?.filter);function d($,k){if(!$)return null;const b=new RegExp(`<${k}>([\\s\\S]*?)<\\/${k}>`,"i"),v=$.match(b);return v?v[1].trim():null}const m=g(()=>{const $=e.toolCall.result;if(!$)return null;let k=$;if($.content&&(k=$.content),typeof k=="string")return{status:d(k,"status"),stdout:d(k,"stdout"),stderr:d(k,"stderr"),exit_code:d(k,"exit_code")};if(Array.isArray(k)){const b=k.find(v=>v.type==="text")?.text||"";return{status:d(b,"status"),stdout:d(b,"stdout"),stderr:d(b,"stderr"),exit_code:d(b,"exit_code")}}return{status:$.status||k.status,stdout:$.stdout||$.output||k.stdout||k.output,stderr:$.stderr||k.stderr,exit_code:$.exit_code||k.exit_code}}),p=g(()=>m.value?.status),u=g(()=>{const $=p.value;return $==="running"?"bg-success":$==="completed"?"bg-secondary":$==="killed"||$==="terminated"?"bg-danger":"bg-info"}),y=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const $=m.value;if($?.status==="running"&&!$.stdout&&!$.stderr)return"No new output since last check";if($?.status==="failed")return`Shell failed (exit code ${$.exit_code||"unknown"})`}return"Operation completed"});return($,k)=>(i(),l("div",bd,[t("div",yd,[t("div",wd,[t("span",$d,w(s.value),1),t("strong",null,w(o.value)+":",1),r.value?(i(),l("code",kd,"Shell "+w(r.value),1)):T("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(i(),l("div",Sd,[k[0]||(k[0]=t("strong",null,"Filter:",-1)),t("code",Cd,w(c.value),1)])):T("",!0)]),n.toolCall.result?(i(),l("div",xd,[t("div",Ed,[t("strong",null,w(a.value)+":",1),p.value?(i(),l("span",{key:0,class:Q(["badge",u.value])},w(p.value),3)):T("",!0)]),m.value?.stdout?(i(),l("div",Td,[k[1]||(k[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Ad,[t("pre",null,[t("code",null,w(m.value.stdout),1)])])])):T("",!0),m.value?.stderr?(i(),l("div",Dd,[k[2]||(k[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Md,[t("pre",null,[t("code",null,w(m.value.stderr),1)])])])):T("",!0),!m.value?.stdout&&!m.value?.stderr?(i(),l("div",{key:2,class:Q(["tool-result",y.value])},[n.toolCall.result.success!==!1?(i(),l("div",Od," âœ… "+w(h.value),1)):(i(),l("div",Ld," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)):T("",!0)])):T("",!0)]))}},En=oe(Nd,[["__scopeId","data-v-86def281"]]),Id={class:"skill-tool-handler"},jd={key:0,class:"tool-section"},Rd={class:"d-flex align-items-center gap-2"},Pd={class:"text-muted small"},Fd={key:0,class:"skill-content-body"},Bd={class:"skill-content-text"},Wd={key:1,class:"tool-section mt-3"},Vd={class:"tool-result tool-result-error"},Hd={class:"tool-code"},Ud={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ne(),o=_e(),a=R(!1);function r(){a.value=!a.value}const c=g(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const $=s.messagesBySession.get(h)||[],k=$.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(f=>f.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let b=null,v=null;for(let _=k+1;_<Math.min(k+3,$.length);_++){const f=$[_];if(f.type!=="user")continue;const S=f.content||"";S.includes("<command-message>")&&S.includes("skill is running")?b=f:S.startsWith("Base directory for this skill:")&&(v=f)}return{running:b,content:v}}),d=g(()=>{const h=c.value.content;if(!h)return"";const $=h.content||"",k=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return $.replace(k,"").trim()}),m=g(()=>d.value.length>0),p=g(()=>d.value?d.value.split(`
`).length:0),u=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!u.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,$)=>(i(),l("div",Id,[m.value?(i(),l("div",jd,[t("div",{class:"skill-content-header",onClick:r},[t("div",Rd,[t("i",{class:Q(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),$[0]||($[0]=t("strong",null,"Skill Content",-1)),t("span",Pd,"("+w(p.value)+" lines)",1)])]),a.value?(i(),l("div",Fd,[t("pre",Bd,w(d.value),1)])):T("",!0)])):T("",!0),u.value?(i(),l("div",Wd,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Vd,[t("pre",Hd,w(y.value),1)])])):T("",!0)]))}},qd=oe(Ud,[["__scopeId","data-v-0a48ca0f"]]),zd={class:"slashcommand-tool-handler"},Kd={key:0,class:"tool-section"},Gd={class:"d-flex align-items-center gap-2"},Yd=["aria-label"],Jd={class:"text-muted small"},Qd={key:0,class:"command-content-body"},Xd={class:"command-content-text"},Zd={key:1,class:"tool-section mt-3"},em={class:"tool-result tool-result-error"},tm={class:"tool-code"},sm={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ne(),o=_e(),a=R(!1);function r(){a.value=!a.value}const c=g(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const $=s.messagesBySession.get(h)||[],k=$.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(f=>f.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let b=null,v=null;for(let _=k+1;_<Math.min(k+3,$.length);_++){const f=$[_];if(f.type!=="user")continue;const S=f.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?b=f:S.includes("ARGUMENTS:")&&(v=f)}return{running:b,content:v}}),d=g(()=>{const h=c.value.content;if(!h)return"";const $=h.content||"",k=/\nARGUMENTS:.*$/s;return $.replace(k,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=g(()=>d.value.length>0),p=g(()=>d.value?d.value.split(`
`).length:0),u=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!u.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,$)=>(i(),l("div",zd,[m.value?(i(),l("div",Kd,[t("div",{class:"command-content-header",onClick:r},[t("div",Gd,[t("span",{"aria-label":a.value?"Collapse":"Expand"},w(a.value?"â–¾":"â–¸"),9,Yd),$[0]||($[0]=t("strong",null,"Command Content",-1)),t("span",Jd,"("+w(p.value)+" lines)",1)])]),a.value?(i(),l("div",Qd,[t("pre",Xd,w(d.value),1)])):T("",!0)])):T("",!0),u.value?(i(),l("div",Zd,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",em,[t("pre",tm,w(y.value),1)])])):T("",!0)]))}},nm=oe(sm,[["__scopeId","data-v-15991acf"]]),om={class:"exit-plan-mode-tool-handler"},am={class:"tool-section"},im={key:0,class:"plan-content mt-2"},lm={class:"plan-text"},rm={key:0,class:"tool-section"},cm={key:0},um={key:1,class:"text-danger"},dm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.plan),o=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,r)=>(i(),l("div",om,[t("div",am,[r[1]||(r[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(i(),l("div",im,[r[0]||(r[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",lm,w(s.value),1)])):T("",!0)]),n.toolCall.result?(i(),l("div",rm,[r[2]||(r[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Q(["tool-result",o.value])},[n.toolCall.result.success!==!1?(i(),l("div",cm," âœ… Permission mode reverted to default ")):(i(),l("div",um," â— "+w(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):T("",!0)]))}},mm=oe(dm,[["__scopeId","data-v-e2e3c781"]]),fm={class:"ask-user-question-handler"},pm={key:0,class:"answers-summary"},vm={class:"answer-question text-muted small"},hm={class:"answer-value fw-medium"},gm={key:1,class:"text-muted small"},_m={key:0,class:"questions-container"},bm={class:"question-header d-flex align-items-center gap-2 mb-2"},ym={key:0,class:"badge bg-secondary"},wm={class:"question-text fw-medium"},$m={class:"options-list"},km=["id","checked","disabled","onChange"],Sm=["id","name","checked","disabled","onChange"],Cm=["for"],xm={class:"option-label"},Em={key:0,class:"option-description text-muted d-block small"},Tm={class:"option-item form-check other-option"},Am=["id","checked","disabled","onChange"],Dm=["id","name","checked","disabled","onChange"],Mm=["for"],Om={key:2,class:"other-input mt-2"},Lm=["onUpdate:modelValue","disabled","onInput"],Nm={key:1,class:"alert alert-info mb-0"},Im={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,a=s,r=g(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=g(()=>{if(!r.value)return{};const C=o.toolCall.result;if(C?.content){if(typeof C.content=="object"&&C.content.answers)return C.content.answers;if(typeof C.content=="string")try{const x=JSON.parse(C.content);if(x.answers)return x.answers}catch{}}const O=o.toolCall.input||{};return O.answers?O.answers:{}}),d=g(()=>Object.keys(c.value).length>0),m=g(()=>(o.toolCall.input||{}).questions||[]),p=R({}),u=R({});be(m,C=>{C.forEach((O,x)=>{x in p.value||(p.value[x]=O.multiSelect?[]:null),x in u.value||(u.value[x]="")})},{immediate:!0});function y(C,O){const x=p.value[C];return Array.isArray(x)?x.includes(O):x===O}function h(C){const O=p.value[C];return Array.isArray(O)?O.includes("__OTHER__"):O==="__OTHER__"}function $(C,O){p.value[C]=O,f()}function k(C){p.value[C]="__OTHER__",f()}function b(C,O){const x=p.value[C];if(!Array.isArray(x))p.value[C]=[O];else{const E=x.indexOf(O);E===-1?x.push(O):x.splice(E,1)}f()}function v(C){const O=p.value[C];if(!Array.isArray(O))p.value[C]=["__OTHER__"];else{const x=O.indexOf("__OTHER__");x===-1?O.push("__OTHER__"):O.splice(x,1)}f()}function _(C){f()}function f(){const C={};m.value.forEach((O,x)=>{const E=p.value[x],P=O.question;if(O.multiSelect){if(Array.isArray(E)&&E.length>0){const A=E.map(B=>B==="__OTHER__"?u.value[x]||"":B).filter(B=>B);C[P]=A.join(", ")}}else E==="__OTHER__"?C[P]=u.value[x]||"":E&&(C[P]=E)}),a("answer",C)}const S=g(()=>m.value.every((C,O)=>{const x=p.value[O];if(C.multiSelect){if(!Array.isArray(x)||x.length===0||x.includes("__OTHER__")&&!u.value[O])return!1}else if(!x||x==="__OTHER__"&&!u.value[O])return!1;return!0}));return e({allQuestionsAnswered:S,getAnswers:()=>{const C={};return m.value.forEach((O,x)=>{const E=p.value[x],P=O.question;if(O.multiSelect){if(Array.isArray(E)&&E.length>0){const A=E.map(B=>B==="__OTHER__"?u.value[x]||"":B).filter(B=>B);C[P]=A.join(", ")}}else E==="__OTHER__"?C[P]=u.value[x]||"":E&&(C[P]=E)}),C}}),(C,O)=>(i(),l("div",fm,[r.value?(i(),l(le,{key:0},[d.value?(i(),l("div",pm,[(i(!0),l(le,null,fe(c.value,(x,E)=>(i(),l("div",{key:E,class:"answer-item mb-2"},[t("div",vm,w(E),1),t("div",hm,w(x),1)]))),128))])):(i(),l("div",gm," No answers recorded. "))],64)):(i(),l(le,{key:1},[m.value.length>0?(i(),l("div",_m,[(i(!0),l(le,null,fe(m.value,(x,E)=>(i(),l("div",{key:E,class:"question-block mb-3"},[t("div",bm,[x.header?(i(),l("span",ym,w(x.header),1)):T("",!0),t("span",wm,w(x.question),1)]),t("div",$m,[(i(!0),l(le,null,fe(x.options,(P,A)=>(i(),l("div",{key:A,class:Q(["option-item form-check",{selected:y(E,P.label)}])},[x.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${E}-opt${A}`,checked:y(E,P.label),disabled:n.disabled,onChange:B=>b(E,P.label)},null,40,km)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${E}-opt${A}`,name:`question-${E}`,checked:y(E,P.label),disabled:n.disabled,onChange:B=>$(E,P.label)},null,40,Sm)),t("label",{class:"form-check-label",for:`q${E}-opt${A}`},[t("span",xm,w(P.label),1),P.description?(i(),l("span",Em,w(P.description),1)):T("",!0)],8,Cm)],2))),128)),t("div",Tm,[x.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${E}-other`,checked:h(E),disabled:n.disabled,onChange:P=>v(E)},null,40,Am)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${E}-other`,name:`question-${E}`,checked:h(E),disabled:n.disabled,onChange:P=>k(E)},null,40,Dm)),t("label",{class:"form-check-label",for:`q${E}-other`},[...O[0]||(O[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Mm),h(E)?(i(),l("div",Om,[Ce(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":P=>u.value[E]=P,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:P=>_()},null,40,Lm),[[qe,u.value[E]]])])):T("",!0)])])]))),128))])):(i(),l("div",Nm," No questions to display. "))],64))]))}},Tn=oe(Im,[["__scopeId","data-v-ebcee33f"]]),jm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Rm={class:"tool-status-icon"},Pm=["title"],Fm={class:"d-flex align-items-center gap-2"},Bm={class:"text-muted"},Wm=["aria-label"],Vm={key:0,class:"card-body"},Hm={key:0,class:"alert alert-warning mb-3"},Um={class:"d-flex align-items-center"},qm={class:"mb-0 small"},zm={key:2,class:"permission-prompt mt-3"},Km={class:"question-buttons d-flex gap-2 mt-3"},Gm=["disabled"],Ym=["disabled"],Jm={class:"alert alert-warning mb-3"},Qm={class:"mb-0"},Xm={class:"tool-name"},Zm={key:0,class:"suggestions-section mb-3"},ef={class:"alert alert-info mb-0"},tf={class:"suggestion-checkboxes p-2 bg-white rounded"},sf=["id","onUpdate:modelValue","disabled"],nf=["for"],of={class:"permission-buttons d-flex gap-2 mb-3"},af=["disabled"],lf=["disabled"],rf=["disabled"],cf={class:"guidance-section mt-3"},uf=["disabled"],df=["disabled"],mf={key:3,class:"mt-3"},ff={class:"alert alert-warning mb-0"},pf={class:"d-flex align-items-center"},vf={class:"mb-0 small"},hf={key:4,class:"tool-section"},gf={class:"alert alert-danger mb-0"},_f={key:0},bf={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ne(),o=_e(),a=mt(),r=R(!1),c=R(null),d=R(""),m=R(!1),p=R(null),u=R({});be(()=>e.toolCall.suggestions,H=>{if(H&&H.length>0){const M={};H.forEach((D,L)=>{M[L]=!0}),u.value=M}},{immediate:!0});const y=g(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((H,M)=>u.value[M]):[]),h=R(null),$=R({}),k=g(()=>e.toolCall.name==="AskUserQuestion"),b=g(()=>!k.value||!h.value?!1:h.value.allQuestionsAnswered);function v(H){$.value=H}async function _(){if(!r.value&&h.value){r.value=!0,c.value="submit-answers";try{const H=o.currentSessionId,M=h.value.getAnswers(),D={questions:e.toolCall.input?.questions||[],answers:M};H&&(s.updateToolCall(H,e.toolCall.id,{input:D}),s.handlePermissionResponse(H,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await a.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",D)}catch(H){console.error("Failed to submit question answers:",H)}finally{r.value=!1,c.value=null}}}const f=g(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),S=g(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),C=g(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),O=g(()=>{if(e.toolCall.backendStatus){const H=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[H]||H}if(C.value){const H=C.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[H]||H}return e.toolCall.status}),x={Read:rl,Write:Cl,Bash:Pl,TodoWrite:tr,Edit:kr,Grep:Cn,Glob:Cn,WebFetch:xn,WebSearch:xn,Task:Tc,TaskCreate:Uc,TaskUpdate:vu,TaskList:Du,TaskGet:ed,NotebookEdit:_d,BashOutput:En,KillShell:En,SlashCommand:nm,Skill:qd,ExitPlanMode:mm,AskUserQuestion:Tn},E=g(()=>{const H=e.toolCall.name;return x[H]?x[H]:Bi}),P=g(()=>{const H=[];if(f.value)return H.push("border-warning"),H.join(" ");switch(O.value){case"pending":H.push("border-secondary");break;case"permission_required":H.push("border-warning");break;case"executing":H.push("border-primary");break;case"completed":G.value||e.toolCall.permissionDecision==="deny"?H.push("border-danger"):H.push("border-success");break;case"error":H.push("border-danger");break}return H.join(" ")}),A=g(()=>{if(f.value)return"â¹ï¸";switch(O.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":G.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),B=g(()=>Qt(e.toolCall.timestamp)),G=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),V=g(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function N(H){if(!H)return"";const M=H.replace(/\\/g,"/").split("/");return M[M.length-1]}function W(H){if(!H)return"";const M=H.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return M?M[1]:H}function z(H,M=200){return H?H.length<=M?H:H.substring(0,M)+"...":""}function Y(H){if(!H)return null;if(H.content){const M=H.content.match(/exit code (\d+)/i);if(M)return parseInt(M[1])}return H.error?1:0}function j(H,M){const D=H?H.split(`
`).length:0;return{added:M?M.split(`
`).length:0,removed:D}}const F=g(()=>{const H=e.toolCall.name,M=e.toolCall.input||{},D=e.toolCall.result,L=O.value;switch(H){case"Bash":case"Shell":case"Command":{const I=W(M.command),U=z(I,200);if(L==="completed"&&D){const Z=Y(D);return`Bash: ${U} (exit ${Z})`}return`Bash: ${U}`}case"SlashCommand":{const I=z(M.command,200);return L==="completed"&&D?`SlashCommand: ${I}`:`SlashCommand: ${I}`}case"Edit":{const I=N(M.file_path);if(L==="completed"&&D&&!D.error){const{added:U,removed:Z}=j(M.old_string,M.new_string);return U===Z?`Edit: ${I} (${U} lines changed)`:`Edit: ${I} (${U} lines added, ${Z} removed)`}return`Edit: ${I}`}case"Read":{const I=N(M.file_path);if(M.offset!==void 0||M.limit!==void 0){const Z=(M.offset||0)+1,he=M.limit?(M.offset||0)+M.limit:"âˆž";return`Read: ${I} (lines ${Z}-${he})`}return`Read: ${I} (full file)`}case"Write":{const I=N(M.file_path);if(L==="completed"&&D&&!D.error&&M.content){const U=M.content.split(`
`).length;return`Write: ${I} (${U} lines written)`}return`Write: ${I}`}case"Skill":{const I=M.skill||"Unknown";return L==="completed"&&D?D.error?`Skill: ${I} (error)`:`Skill: ${I} (completed)`:`Skill: ${I}`}case"Task":{const I=M.subagent_type||"general",U=M.description||"Task";return L==="completed"&&D?D.error?`Task: (${I}) ${U} (error)`:`Task: (${I}) ${U} (completed)`:`Task: (${I}) ${U}`}case"TodoWrite":{if(M.todos&&Array.isArray(M.todos)){const I=M.todos.filter(he=>he.status==="completed").length,U=M.todos.length,Z=M.todos.find(he=>he.status==="in_progress");return Z?`Todo: Working on "${Z.content}"`:`Todo: ${I}/${U} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const I=M.pattern||"",U=H==="Grep"?"Grep":"Glob";if(L==="completed"&&D&&!D.error){let Z=0;return D.content&&(Z=D.content.split(`
`).filter(Pe=>Pe.trim()).length),`${U}: "${I}" (${Z} results)`}return`${U}: "${I}"`}case"WebFetch":case"WebSearch":{const I=M.url||M.query||"";if(H==="WebSearch"){const Z=M.query||"",he=Z.length>50?Z.substring(0,50)+"...":Z;return L==="completed"&&D?D.error?`Web: ${he} (error)`:`Web: ${he} (success)`:`Web: ${he}`}let U="";try{I&&(U=new URL(I.startsWith("http")?I:`https://${I}`).hostname)}catch{U=I.length>50?I.substring(0,50)+"...":I}return L==="completed"&&D?D.error?`Web: ${U} (error)`:`Web: ${U} (success)`:`Web: ${U||I}`}case"NotebookEdit":{const I=N(M.notebook_path),U=M.cell_number!==void 0?M.cell_number:"?",Z=M.edit_mode||"replace";return`NotebookEdit: ${I} cell #${U} (${Z})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${M.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${M.shell_id||"unknown"}`;case"AskUserQuestion":{const U=(M.questions||[]).length;return L==="completed"&&D&&!D.error?`AskUserQuestion: ${U} question(s) answered`:L==="permission_required"?`AskUserQuestion: ${U} question(s) awaiting response`:`AskUserQuestion: ${U} question(s)`}case"TaskCreate":{const I=M.subject||"",U=I.length>40?I.substring(0,40)+"...":I;return L==="completed"&&D&&!D.error?`TaskCreate: "${U}" (created)`:`TaskCreate: "${U}"`}case"TaskUpdate":{const I=M.taskId||"?",U=M.status||"";return U?`TaskUpdate: #${I} -> ${U}`:`TaskUpdate: #${I}`}case"TaskList":return L==="completed"&&D&&!D.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const I=M.taskId||"?";return L==="completed"&&D&&!D.error?`TaskGet: #${I} (retrieved)`:`TaskGet: #${I}`}default:return`${H}: executed`}}),K=g(()=>{const H=e.toolCall.name,M=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(H)?M.command||H:["Edit","Read","Write","NotebookEdit"].includes(H)&&(M.file_path||M.notebook_path)||H});function ee(){const H=o.currentSessionId;H&&s.toggleToolExpansion(H,e.toolCall.id)}function se(H){return H.type==="setMode"?`Set mode: ${H.mode}`:H.type==="addRules"&&H.rules?.length?`Allow: ${H.rules.map(D=>D.ruleContent?`${D.toolName}(${D.ruleContent})`:D.toolName).join(", ")}`:H.type==="addDirectories"&&H.directories?.length?`Add directories: ${H.directories.join(", ")}`:JSON.stringify(H)}function ne(){m.value=!0,rt(()=>{p.value&&p.value.focus()})}function ve(){const H=p.value;if(!H)return;H.style.height="auto";const M=parseFloat(getComputedStyle(H).lineHeight)*6+10;H.style.height=Math.min(H.scrollHeight,M)+"px"}async function ae(H,M,D=null){if(r.value)return;r.value=!0;const L=y.value,I=M&&L.length>0;H==="allow"?c.value=I?"approve-apply":"approve":D?c.value="deny-guidance":c.value="deny";try{const U=o.currentSessionId;if(U){const Z=I?L:[];s.handlePermissionResponse(U,{request_id:e.toolCall.permissionRequestId,decision:H,reasoning:H==="allow"?"User allowed permission":"User denied permission",applied_updates:Z})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,H,I,D,I?L:null)}catch(U){console.error("Failed to send permission response:",U)}finally{r.value=!1,c.value=null}}return(H,M)=>(i(),l("div",{class:Q(["tool-call-card card",P.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:ee},[t("div",jm,[t("span",Rm,w(A.value),1),t("span",{class:"tool-name",title:K.value},w(F.value),9,Pm)]),t("div",Fm,[t("small",Bm,w(B.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},w(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Wm)])]),n.toolCall.isExpanded?(i(),l("div",Vm,[f.value?(i(),l("div",Hm,[t("div",Um,[M[7]||(M[7]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[M[6]||(M[6]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",qm,w(S.value?.message||"Session was terminated"),1)])])])):T("",!0),k.value&&O.value==="permission_required"?T("",!0):(i(),Ee(ho(E.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),O.value==="permission_required"&&!f.value?(i(),l("div",zm,[k.value?(i(),l(le,{key:0},[M[8]||(M[8]=t("div",{class:"alert alert-info mb-3"},[t("p",{class:"mb-0"},[t("strong",null,"â“ Claude is asking for your input")])],-1)),ye(Tn,{ref_key:"questionHandlerRef",ref:h,toolCall:n.toolCall,disabled:r.value,onAnswer:v},null,8,["toolCall","disabled"]),t("div",Km,[t("button",{class:"btn btn-primary",onClick:_,disabled:r.value||!b.value},w(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,Gm),t("button",{class:"btn btn-outline-secondary",onClick:M[0]||(M[0]=D=>ae("deny",!1)),disabled:r.value}," Skip Question ",8,Ym)])],64)):(i(),l(le,{key:1},[t("div",Jm,[M[11]||(M[11]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",Qm,[M[9]||(M[9]=re("Claude wants to use the ",-1)),t("code",Xm,w(n.toolCall.name),1),M[10]||(M[10]=re(" tool.",-1))])]),V.value?(i(),l("div",Zm,[t("div",ef,[M[12]||(M[12]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Updates ",-1)),M[13]||(M[13]=t("p",{class:"mb-2 small"},"Select which permissions to apply:",-1)),t("div",tf,[(i(!0),l(le,null,fe(n.toolCall.suggestions,(D,L)=>(i(),l("div",{key:L,class:"form-check suggestion-check-item"},[Ce(t("input",{class:"form-check-input",type:"checkbox",id:`suggestion-${n.toolCall.id}-${L}`,"onUpdate:modelValue":I=>u.value[L]=I,disabled:r.value},null,8,sf),[[go,u.value[L]]]),t("label",{class:"form-check-label",for:`suggestion-${n.toolCall.id}-${L}`},[t("code",null,w(se(D)),1)],8,nf)]))),128))]),M[14]||(M[14]=t("small",{class:"text-muted mt-2 d-block"}," Checked permissions will be applied to prevent future prompts. ",-1))])])):T("",!0),t("div",of,[V.value?(i(),l("button",{key:0,class:"btn btn-success",onClick:M[1]||(M[1]=D=>ae("allow",!0)),disabled:r.value},w(r.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,af)):T("",!0),t("button",{class:Q(["btn",V.value?"btn-outline-success":"btn-success"]),onClick:M[2]||(M[2]=D=>ae("allow",!1)),disabled:r.value},w(r.value&&c.value==="approve"?"â³ Submitting...":V.value?"âœ… Approve Only":"âœ… Approve"),11,lf),t("button",{class:"btn btn-danger",onClick:M[3]||(M[3]=D=>ae("deny",!1)),disabled:r.value}," ðŸš« "+w(r.value&&c.value==="deny"?"Submitting...":"Deny"),9,rf)]),t("div",cf,[m.value?T("",!0):(i(),l("a",{key:0,href:"#",class:"text-muted small",onClick:ge(ne,["prevent"])}," Add guidance... ")),m.value?(i(),l(le,{key:1},[M[15]||(M[15]=t("label",{class:"form-label fw-bold"}," Guidance (Optional) ",-1)),M[16]||(M[16]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. ",-1)),Ce(t("textarea",{ref_key:"guidanceTextarea",ref:p,"onUpdate:modelValue":M[4]||(M[4]=D=>d.value=D),class:"form-control guidance-textarea mb-2",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:r.value,onInput:ve},null,40,uf),[[qe,d.value]]),d.value.trim()?(i(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:M[5]||(M[5]=D=>ae("deny",!1,d.value)),disabled:r.value},w(r.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,df)):T("",!0)],64)):T("",!0)])],64))])):T("",!0),O.value==="permission_required"&&f.value?(i(),l("div",mf,[t("div",ff,[t("div",pf,[M[18]||(M[18]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[M[17]||(M[17]=t("strong",null,"Permission Request Cancelled",-1)),t("p",vf,w(S.value?.message||"Session was terminated before permission could be granted"),1)])])])])):T("",!0),n.toolCall.permissionDecision==="deny"?(i(),l("div",hf,[t("div",gf,[M[19]||(M[19]=re(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(i(),l("span",_f," - "+w(n.toolCall.result.message),1)):T("",!0)])])):T("",!0)])):T("",!0)],2))}},yf=oe(bf,[["__scopeId","data-v-cf42c263"]]);function An(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function wf(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Dn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function $f(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=wf(s.command),a=Dn(o,60);return`${e}: ${a}`}case"SlashCommand":return`SlashCommand: ${Dn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=An(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",a=s.description||"Task",r=a.length>40?a.substring(0,40)+"...":a;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=s.pattern||"",a=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${a}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const a=s.query||"";return`WebSearch: ${a.length>40?a.substring(0,40)+"...":a}`}let o="";try{const a=s.url||"";a&&(o=new URL(a.startsWith("http")?a:`https://${a}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${An(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const kf={key:0,class:"tool-timeline-bar"},Sf={class:"timeline-container"},Cf=["title","onClick","onKeydown"],xf={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const s=n,o=e,a=Ne(),r=_e(),c=g(()=>s.tools.map(($,k)=>({tool:$,originalIndex:k})).sort(($,k)=>{if($.tool.timestamp&&k.tool.timestamp){const b=new Date($.tool.timestamp).getTime(),v=new Date(k.tool.timestamp).getTime();if(b!==v)return b-v}return $.originalIndex-k.originalIndex}).map(({tool:$})=>$));function d($){const k=r.currentSessionId;if(!k)return $.status;const b=a.getBackendToolState(k,$.id);return b?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[b.state]||b.state:a.isToolUseOrphaned(k,$.id)?"orphaned":$.status}function m($){return $.result?.error||$.status==="error"||$.permissionDecision==="deny"}function p($){return d($)==="executing"}function u($){switch(d($)){case"completed":return m($)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function y($){const k=$f($),b=d($),v={completed:m($)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[b]||b;return`${k} [${v}]`}function h($,k){o("segment-click",{tool:$,index:k})}return($,k)=>c.value.length>0?(i(),l("div",kf,[t("div",Sf,[(i(!0),l(le,null,fe(c.value,(b,v)=>(i(),l("div",{key:b.id,class:Q(["timeline-segment",u(b)]),style:{flex:1},title:y(b),onClick:_=>h(b,v),role:"button",tabindex:"0",onKeydown:[Ze(_=>h(b,v),["enter"]),Ze(ge(_=>h(b,v),["prevent"]),["space"])]},[t("span",{class:Q(["segment-inner",{"executing-pulse":p(b)}])},null,2)],42,Cf))),128))])])):T("",!0)}},Ef=oe(xf,[["__scopeId","data-v-4a85fba6"]]),Tf={class:"tool-footer-container"},Af={class:"tool-cards-list"},Df={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=Ne(),o=_e(),a=g(()=>e.tools.map((c,d)=>({tool:c,originalIndex:d})).sort((c,d)=>{if(c.tool.timestamp&&d.tool.timestamp){const m=new Date(c.tool.timestamp).getTime(),p=new Date(d.tool.timestamp).getTime();if(m!==p)return m-p}return c.originalIndex-d.originalIndex}).map(({tool:c})=>c));async function r({tool:c}){const d=o.currentSessionId;if(!d)return;s.toggleToolExpansion(d,c.id),await rt();const m=document.querySelector(`[data-tool-id="${c.id}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,d)=>(i(),l("div",Tf,[ye(Ef,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),t("div",Af,[(i(!0),l(le,null,fe(a.value,m=>(i(),Ee(yf,{key:m.id,toolCall:m,"data-tool-id":m.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Mf=oe(Df,[["__scopeId","data-v-527d59ae"]]),Of={class:"message-row message-row-assistant"},Lf=["title"],Nf={class:"message-content-column"},If={key:0,class:"thinking-block mb-2"},jf=["innerHTML"],Rf={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ne(),o=_e();nt.setOptions({breaks:!0,gfm:!0});const a=g(()=>Qt(e.message.timestamp)),r=g(()=>e.message.metadata?.model||null),c=g(()=>{const k=a.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${k}`}),d=g(()=>{const k=e.message.content||"";return k.trim().length>0&&k!=="Assistant response"}),m=g(()=>{const k=e.message.content||"";let b=nt.parse(k);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),Jt.sanitize(b)}),p=g(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=g(()=>e.message.metadata?.thinking_content||""),y=g(()=>{const k=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return k||b}),h=g(()=>{const k=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],v=[...k],_=new Set(k.map(f=>f.id));for(const f of b)_.has(f.id)||v.push(f);return v}),$=g(()=>{const k=o.currentSessionId;if(!k)return[];const b=s.toolCallsBySession.get(k)||[];return h.value.map(v=>{const _=b.find(f=>f.id===v.id);return _||{id:v.id,name:v.name,input:v.input,status:"pending",result:null,timestamp:v.timestamp||e.message.timestamp,isExpanded:!0}})});return(k,b)=>(i(),l("div",Of,[t("div",{class:"message-speaker",title:c.value},[...b[0]||(b[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Lf),t("div",Nf,[p.value?(i(),l("div",If,[ye(Ti,{thinking:u.value},null,8,["thinking"])])):T("",!0),d.value?(i(),l("div",{key:1,class:"message-text",innerHTML:m.value},null,8,jf)):T("",!0),y.value?(i(),Ee(Mf,{key:2,tools:$.value},null,8,["tools"])):T("",!0)])]))}},Pf=oe(Rf,[["__scopeId","data-v-2e32f6ef"]]),Ff={key:0,class:"message-row message-row-compaction"},Bf=["title"],Wf={class:"message-content-column"},Vf={class:"compaction-status-content"},Hf={class:"text-muted ms-auto"},Uf={key:1,class:"message-row message-row-system"},qf=["title"],zf={class:"message-content-column"},Kf={class:"system-text"},Gf={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>Qt(e.message.timestamp)),o=g(()=>`system
${s.value}`),a=g(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,c)=>a.value?(i(),l("div",Ff,[t("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,Bf),t("div",Wf,[t("div",Vf,[c[1]||(c[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",Hf,w(s.value),1)])])])):(i(),l("div",Uf,[t("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,qf),t("div",zf,[t("span",Kf,w(n.message.content),1)])]))}},Mn=oe(Gf,[["__scopeId","data-v-a078178f"]]),Yf={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>{switch(e.message.type){case"user":return wi;case"assistant":return Pf;case"system":return Mn;default:return Mn}});return(o,a)=>(i(),Ee(ho(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Jf=oe(Yf,[["__scopeId","data-v-11dff525"]]);var De="top",Ie="bottom",je="right",Me="left",_s="auto",Bt=[De,Ie,je,Me],yt="start",Lt="end",So="clippingParents",sn="viewport",Et="popper",Co="reference",Gs=Bt.reduce(function(n,e){return n.concat([e+"-"+yt,e+"-"+Lt])},[]),nn=[].concat(Bt,[_s]).reduce(function(n,e){return n.concat([e,e+"-"+yt,e+"-"+Lt])},[]),xo="beforeRead",Eo="read",To="afterRead",Ao="beforeMain",Do="main",Mo="afterMain",Oo="beforeWrite",Lo="write",No="afterWrite",Io=[xo,Eo,To,Ao,Do,Mo,Oo,Lo,No];function Qe(n){return n?(n.nodeName||"").toLowerCase():null}function Re(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function wt(n){var e=Re(n).Element;return n instanceof e||n instanceof Element}function Be(n){var e=Re(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function on(n){if(typeof ShadowRoot>"u")return!1;var e=Re(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Qf(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},r=e.elements[s];!Be(r)||!Qe(r)||(Object.assign(r.style,o),Object.keys(a).forEach(function(c){var d=a[c];d===!1?r.removeAttribute(c):r.setAttribute(c,d===!0?"":d)}))})}function Xf(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],r=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),d=c.reduce(function(m,p){return m[p]="",m},{});!Be(a)||!Qe(a)||(Object.assign(a.style,d),Object.keys(r).forEach(function(m){a.removeAttribute(m)}))})}}const jo={name:"applyStyles",enabled:!0,phase:"write",fn:Qf,effect:Xf,requires:["computeStyles"]};function Ye(n){return n.split("-")[0]}var bt=Math.max,ps=Math.min,Nt=Math.round;function Ys(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ro(){return!/^((?!chrome|android).)*safari/i.test(Ys())}function It(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,r=1;e&&Be(n)&&(a=n.offsetWidth>0&&Nt(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&Nt(o.height)/n.offsetHeight||1);var c=wt(n)?Re(n):window,d=c.visualViewport,m=!Ro()&&s,p=(o.left+(m&&d?d.offsetLeft:0))/a,u=(o.top+(m&&d?d.offsetTop:0))/r,y=o.width/a,h=o.height/r;return{width:y,height:h,top:u,right:p+y,bottom:u+h,left:p,x:p,y:u}}function an(n){var e=It(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Po(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&on(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function ot(n){return Re(n).getComputedStyle(n)}function Zf(n){return["table","td","th"].indexOf(Qe(n))>=0}function ft(n){return((wt(n)?n.ownerDocument:n.document)||window.document).documentElement}function bs(n){return Qe(n)==="html"?n:n.assignedSlot||n.parentNode||(on(n)?n.host:null)||ft(n)}function On(n){return!Be(n)||ot(n).position==="fixed"?null:n.offsetParent}function ep(n){var e=/firefox/i.test(Ys()),s=/Trident/i.test(Ys());if(s&&Be(n)){var o=ot(n);if(o.position==="fixed")return null}var a=bs(n);for(on(a)&&(a=a.host);Be(a)&&["html","body"].indexOf(Qe(a))<0;){var r=ot(a);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return a;a=a.parentNode}return null}function Xt(n){for(var e=Re(n),s=On(n);s&&Zf(s)&&ot(s).position==="static";)s=On(s);return s&&(Qe(s)==="html"||Qe(s)==="body"&&ot(s).position==="static")?e:s||ep(n)||e}function ln(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function zt(n,e,s){return bt(n,ps(e,s))}function tp(n,e,s){var o=zt(n,e,s);return o>s?s:o}function Fo(){return{top:0,right:0,bottom:0,left:0}}function Bo(n){return Object.assign({},Fo(),n)}function Wo(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var sp=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Bo(typeof e!="number"?e:Wo(e,Bt))};function np(n){var e,s=n.state,o=n.name,a=n.options,r=s.elements.arrow,c=s.modifiersData.popperOffsets,d=Ye(s.placement),m=ln(d),p=[Me,je].indexOf(d)>=0,u=p?"height":"width";if(!(!r||!c)){var y=sp(a.padding,s),h=an(r),$=m==="y"?De:Me,k=m==="y"?Ie:je,b=s.rects.reference[u]+s.rects.reference[m]-c[m]-s.rects.popper[u],v=c[m]-s.rects.reference[m],_=Xt(r),f=_?m==="y"?_.clientHeight||0:_.clientWidth||0:0,S=b/2-v/2,C=y[$],O=f-h[u]-y[k],x=f/2-h[u]/2+S,E=zt(C,x,O),P=m;s.modifiersData[o]=(e={},e[P]=E,e.centerOffset=E-x,e)}}function op(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||Po(e.elements.popper,a)&&(e.elements.arrow=a))}const Vo={name:"arrow",enabled:!0,phase:"main",fn:np,effect:op,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function jt(n){return n.split("-")[1]}var ap={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ip(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:Nt(s*a)/a||0,y:Nt(o*a)/a||0}}function Ln(n){var e,s=n.popper,o=n.popperRect,a=n.placement,r=n.variation,c=n.offsets,d=n.position,m=n.gpuAcceleration,p=n.adaptive,u=n.roundOffsets,y=n.isFixed,h=c.x,$=h===void 0?0:h,k=c.y,b=k===void 0?0:k,v=typeof u=="function"?u({x:$,y:b}):{x:$,y:b};$=v.x,b=v.y;var _=c.hasOwnProperty("x"),f=c.hasOwnProperty("y"),S=Me,C=De,O=window;if(p){var x=Xt(s),E="clientHeight",P="clientWidth";if(x===Re(s)&&(x=ft(s),ot(x).position!=="static"&&d==="absolute"&&(E="scrollHeight",P="scrollWidth")),x=x,a===De||(a===Me||a===je)&&r===Lt){C=Ie;var A=y&&x===O&&O.visualViewport?O.visualViewport.height:x[E];b-=A-o.height,b*=m?1:-1}if(a===Me||(a===De||a===Ie)&&r===Lt){S=je;var B=y&&x===O&&O.visualViewport?O.visualViewport.width:x[P];$-=B-o.width,$*=m?1:-1}}var G=Object.assign({position:d},p&&ap),V=u===!0?ip({x:$,y:b},Re(s)):{x:$,y:b};if($=V.x,b=V.y,m){var N;return Object.assign({},G,(N={},N[C]=f?"0":"",N[S]=_?"0":"",N.transform=(O.devicePixelRatio||1)<=1?"translate("+$+"px, "+b+"px)":"translate3d("+$+"px, "+b+"px, 0)",N))}return Object.assign({},G,(e={},e[C]=f?b+"px":"",e[S]=_?$+"px":"",e.transform="",e))}function lp(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,r=s.adaptive,c=r===void 0?!0:r,d=s.roundOffsets,m=d===void 0?!0:d,p={placement:Ye(e.placement),variation:jt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ln(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ln(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ho={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:lp,data:{}};var os={passive:!0};function rp(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,r=a===void 0?!0:a,c=o.resize,d=c===void 0?!0:c,m=Re(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&p.forEach(function(u){u.addEventListener("scroll",s.update,os)}),d&&m.addEventListener("resize",s.update,os),function(){r&&p.forEach(function(u){u.removeEventListener("scroll",s.update,os)}),d&&m.removeEventListener("resize",s.update,os)}}const Uo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:rp,data:{}};var cp={left:"right",right:"left",bottom:"top",top:"bottom"};function ds(n){return n.replace(/left|right|bottom|top/g,function(e){return cp[e]})}var up={start:"end",end:"start"};function Nn(n){return n.replace(/start|end/g,function(e){return up[e]})}function rn(n){var e=Re(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function cn(n){return It(ft(n)).left+rn(n).scrollLeft}function dp(n,e){var s=Re(n),o=ft(n),a=s.visualViewport,r=o.clientWidth,c=o.clientHeight,d=0,m=0;if(a){r=a.width,c=a.height;var p=Ro();(p||!p&&e==="fixed")&&(d=a.offsetLeft,m=a.offsetTop)}return{width:r,height:c,x:d+cn(n),y:m}}function mp(n){var e,s=ft(n),o=rn(n),a=(e=n.ownerDocument)==null?void 0:e.body,r=bt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),c=bt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),d=-o.scrollLeft+cn(n),m=-o.scrollTop;return ot(a||s).direction==="rtl"&&(d+=bt(s.clientWidth,a?a.clientWidth:0)-r),{width:r,height:c,x:d,y:m}}function un(n){var e=ot(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function qo(n){return["html","body","#document"].indexOf(Qe(n))>=0?n.ownerDocument.body:Be(n)&&un(n)?n:qo(bs(n))}function Kt(n,e){var s;e===void 0&&(e=[]);var o=qo(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),r=Re(o),c=a?[r].concat(r.visualViewport||[],un(o)?o:[]):o,d=e.concat(c);return a?d:d.concat(Kt(bs(c)))}function Js(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function fp(n,e){var s=It(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function In(n,e,s){return e===sn?Js(dp(n,s)):wt(e)?fp(e,s):Js(mp(ft(n)))}function pp(n){var e=Kt(bs(n)),s=["absolute","fixed"].indexOf(ot(n).position)>=0,o=s&&Be(n)?Xt(n):n;return wt(o)?e.filter(function(a){return wt(a)&&Po(a,o)&&Qe(a)!=="body"}):[]}function vp(n,e,s,o){var a=e==="clippingParents"?pp(n):[].concat(e),r=[].concat(a,[s]),c=r[0],d=r.reduce(function(m,p){var u=In(n,p,o);return m.top=bt(u.top,m.top),m.right=ps(u.right,m.right),m.bottom=ps(u.bottom,m.bottom),m.left=bt(u.left,m.left),m},In(n,c,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function zo(n){var e=n.reference,s=n.element,o=n.placement,a=o?Ye(o):null,r=o?jt(o):null,c=e.x+e.width/2-s.width/2,d=e.y+e.height/2-s.height/2,m;switch(a){case De:m={x:c,y:e.y-s.height};break;case Ie:m={x:c,y:e.y+e.height};break;case je:m={x:e.x+e.width,y:d};break;case Me:m={x:e.x-s.width,y:d};break;default:m={x:e.x,y:e.y}}var p=a?ln(a):null;if(p!=null){var u=p==="y"?"height":"width";switch(r){case yt:m[p]=m[p]-(e[u]/2-s[u]/2);break;case Lt:m[p]=m[p]+(e[u]/2-s[u]/2);break}}return m}function Rt(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,r=s.strategy,c=r===void 0?n.strategy:r,d=s.boundary,m=d===void 0?So:d,p=s.rootBoundary,u=p===void 0?sn:p,y=s.elementContext,h=y===void 0?Et:y,$=s.altBoundary,k=$===void 0?!1:$,b=s.padding,v=b===void 0?0:b,_=Bo(typeof v!="number"?v:Wo(v,Bt)),f=h===Et?Co:Et,S=n.rects.popper,C=n.elements[k?f:h],O=vp(wt(C)?C:C.contextElement||ft(n.elements.popper),m,u,c),x=It(n.elements.reference),E=zo({reference:x,element:S,placement:a}),P=Js(Object.assign({},S,E)),A=h===Et?P:x,B={top:O.top-A.top+_.top,bottom:A.bottom-O.bottom+_.bottom,left:O.left-A.left+_.left,right:A.right-O.right+_.right},G=n.modifiersData.offset;if(h===Et&&G){var V=G[a];Object.keys(B).forEach(function(N){var W=[je,Ie].indexOf(N)>=0?1:-1,z=[De,Ie].indexOf(N)>=0?"y":"x";B[N]+=V[z]*W})}return B}function hp(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,r=s.rootBoundary,c=s.padding,d=s.flipVariations,m=s.allowedAutoPlacements,p=m===void 0?nn:m,u=jt(o),y=u?d?Gs:Gs.filter(function(k){return jt(k)===u}):Bt,h=y.filter(function(k){return p.indexOf(k)>=0});h.length===0&&(h=y);var $=h.reduce(function(k,b){return k[b]=Rt(n,{placement:b,boundary:a,rootBoundary:r,padding:c})[Ye(b)],k},{});return Object.keys($).sort(function(k,b){return $[k]-$[b]})}function gp(n){if(Ye(n)===_s)return[];var e=ds(n);return[Nn(n),e,Nn(e)]}function _p(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,r=a===void 0?!0:a,c=s.altAxis,d=c===void 0?!0:c,m=s.fallbackPlacements,p=s.padding,u=s.boundary,y=s.rootBoundary,h=s.altBoundary,$=s.flipVariations,k=$===void 0?!0:$,b=s.allowedAutoPlacements,v=e.options.placement,_=Ye(v),f=_===v,S=m||(f||!k?[ds(v)]:gp(v)),C=[v].concat(S).reduce(function(ae,H){return ae.concat(Ye(H)===_s?hp(e,{placement:H,boundary:u,rootBoundary:y,padding:p,flipVariations:k,allowedAutoPlacements:b}):H)},[]),O=e.rects.reference,x=e.rects.popper,E=new Map,P=!0,A=C[0],B=0;B<C.length;B++){var G=C[B],V=Ye(G),N=jt(G)===yt,W=[De,Ie].indexOf(V)>=0,z=W?"width":"height",Y=Rt(e,{placement:G,boundary:u,rootBoundary:y,altBoundary:h,padding:p}),j=W?N?je:Me:N?Ie:De;O[z]>x[z]&&(j=ds(j));var F=ds(j),K=[];if(r&&K.push(Y[V]<=0),d&&K.push(Y[j]<=0,Y[F]<=0),K.every(function(ae){return ae})){A=G,P=!1;break}E.set(G,K)}if(P)for(var ee=k?3:1,se=function(H){var M=C.find(function(D){var L=E.get(D);if(L)return L.slice(0,H).every(function(I){return I})});if(M)return A=M,"break"},ne=ee;ne>0;ne--){var ve=se(ne);if(ve==="break")break}e.placement!==A&&(e.modifiersData[o]._skip=!0,e.placement=A,e.reset=!0)}}const Ko={name:"flip",enabled:!0,phase:"main",fn:_p,requiresIfExists:["offset"],data:{_skip:!1}};function jn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Rn(n){return[De,je,Ie,Me].some(function(e){return n[e]>=0})}function bp(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,r=e.modifiersData.preventOverflow,c=Rt(e,{elementContext:"reference"}),d=Rt(e,{altBoundary:!0}),m=jn(c,o),p=jn(d,a,r),u=Rn(m),y=Rn(p);e.modifiersData[s]={referenceClippingOffsets:m,popperEscapeOffsets:p,isReferenceHidden:u,hasPopperEscaped:y},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":y})}const Go={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:bp};function yp(n,e,s){var o=Ye(n),a=[Me,De].indexOf(o)>=0?-1:1,r=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,c=r[0],d=r[1];return c=c||0,d=(d||0)*a,[Me,je].indexOf(o)>=0?{x:d,y:c}:{x:c,y:d}}function wp(n){var e=n.state,s=n.options,o=n.name,a=s.offset,r=a===void 0?[0,0]:a,c=nn.reduce(function(u,y){return u[y]=yp(y,e.rects,r),u},{}),d=c[e.placement],m=d.x,p=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=c}const Yo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:wp};function $p(n){var e=n.state,s=n.name;e.modifiersData[s]=zo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Jo={name:"popperOffsets",enabled:!0,phase:"read",fn:$p,data:{}};function kp(n){return n==="x"?"y":"x"}function Sp(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,r=a===void 0?!0:a,c=s.altAxis,d=c===void 0?!1:c,m=s.boundary,p=s.rootBoundary,u=s.altBoundary,y=s.padding,h=s.tether,$=h===void 0?!0:h,k=s.tetherOffset,b=k===void 0?0:k,v=Rt(e,{boundary:m,rootBoundary:p,padding:y,altBoundary:u}),_=Ye(e.placement),f=jt(e.placement),S=!f,C=ln(_),O=kp(C),x=e.modifiersData.popperOffsets,E=e.rects.reference,P=e.rects.popper,A=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,B=typeof A=="number"?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),G=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,V={x:0,y:0};if(x){if(r){var N,W=C==="y"?De:Me,z=C==="y"?Ie:je,Y=C==="y"?"height":"width",j=x[C],F=j+v[W],K=j-v[z],ee=$?-P[Y]/2:0,se=f===yt?E[Y]:P[Y],ne=f===yt?-P[Y]:-E[Y],ve=e.elements.arrow,ae=$&&ve?an(ve):{width:0,height:0},H=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Fo(),M=H[W],D=H[z],L=zt(0,E[Y],ae[Y]),I=S?E[Y]/2-ee-L-M-B.mainAxis:se-L-M-B.mainAxis,U=S?-E[Y]/2+ee+L+D+B.mainAxis:ne+L+D+B.mainAxis,Z=e.elements.arrow&&Xt(e.elements.arrow),he=Z?C==="y"?Z.clientTop||0:Z.clientLeft||0:0,Pe=(N=G?.[C])!=null?N:0,X=j+I-Pe-he,ce=j+U-Pe,de=zt($?ps(F,X):F,j,$?bt(K,ce):K);x[C]=de,V[C]=de-j}if(d){var $e,Se=C==="x"?De:Me,Xe=C==="x"?Ie:je,Ke=x[O],q=O==="y"?"height":"width",te=Ke+v[Se],ue=Ke-v[Xe],pe=[De,Me].indexOf(_)!==-1,ke=($e=G?.[O])!=null?$e:0,Fe=pe?te:Ke-E[q]-P[q]-ke+B.altAxis,ns=pe?Ke+E[q]+P[q]-ke-B.altAxis:ue,bn=$&&pe?tp(Fe,Ke,ns):zt($?Fe:te,Ke,$?ns:ue);x[O]=bn,V[O]=bn-Ke}e.modifiersData[o]=V}}const Qo={name:"preventOverflow",enabled:!0,phase:"main",fn:Sp,requiresIfExists:["offset"]};function Cp(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function xp(n){return n===Re(n)||!Be(n)?rn(n):Cp(n)}function Ep(n){var e=n.getBoundingClientRect(),s=Nt(e.width)/n.offsetWidth||1,o=Nt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Tp(n,e,s){s===void 0&&(s=!1);var o=Be(e),a=Be(e)&&Ep(e),r=ft(e),c=It(n,a,s),d={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!s)&&((Qe(e)!=="body"||un(r))&&(d=xp(e)),Be(e)?(m=It(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):r&&(m.x=cn(r))),{x:c.left+d.scrollLeft-m.x,y:c.top+d.scrollTop-m.y,width:c.width,height:c.height}}function Ap(n){var e=new Map,s=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function a(r){s.add(r.name);var c=[].concat(r.requires||[],r.requiresIfExists||[]);c.forEach(function(d){if(!s.has(d)){var m=e.get(d);m&&a(m)}}),o.push(r)}return n.forEach(function(r){s.has(r.name)||a(r)}),o}function Dp(n){var e=Ap(n);return Io.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function Mp(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Op(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Pn={placement:"bottom",modifiers:[],strategy:"absolute"};function Fn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Xo(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,r=a===void 0?Pn:a;return function(d,m,p){p===void 0&&(p=r);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pn,r),modifiersData:{},elements:{reference:d,popper:m},attributes:{},styles:{}},y=[],h=!1,$={state:u,setOptions:function(_){var f=typeof _=="function"?_(u.options):_;b(),u.options=Object.assign({},r,u.options,f),u.scrollParents={reference:wt(d)?Kt(d):d.contextElement?Kt(d.contextElement):[],popper:Kt(m)};var S=Dp(Op([].concat(o,u.options.modifiers)));return u.orderedModifiers=S.filter(function(C){return C.enabled}),k(),$.update()},forceUpdate:function(){if(!h){var _=u.elements,f=_.reference,S=_.popper;if(Fn(f,S)){u.rects={reference:Tp(f,Xt(S),u.options.strategy==="fixed"),popper:an(S)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(B){return u.modifiersData[B.name]=Object.assign({},B.data)});for(var C=0;C<u.orderedModifiers.length;C++){if(u.reset===!0){u.reset=!1,C=-1;continue}var O=u.orderedModifiers[C],x=O.fn,E=O.options,P=E===void 0?{}:E,A=O.name;typeof x=="function"&&(u=x({state:u,options:P,name:A,instance:$})||u)}}}},update:Mp(function(){return new Promise(function(v){$.forceUpdate(),v(u)})}),destroy:function(){b(),h=!0}};if(!Fn(d,m))return $;$.setOptions(p).then(function(v){!h&&p.onFirstUpdate&&p.onFirstUpdate(v)});function k(){u.orderedModifiers.forEach(function(v){var _=v.name,f=v.options,S=f===void 0?{}:f,C=v.effect;if(typeof C=="function"){var O=C({state:u,name:_,instance:$,options:S}),x=function(){};y.push(O||x)}})}function b(){y.forEach(function(v){return v()}),y=[]}return $}}var Lp=[Uo,Jo,Ho,jo,Yo,Ko,Qo,Vo,Go],dn=Xo({defaultModifiers:Lp});const Zo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Mo,afterRead:To,afterWrite:No,applyStyles:jo,arrow:Vo,auto:_s,basePlacements:Bt,beforeMain:Ao,beforeRead:xo,beforeWrite:Oo,bottom:Ie,clippingParents:So,computeStyles:Ho,createPopper:dn,detectOverflow:Rt,end:Lt,eventListeners:Uo,flip:Ko,hide:Go,left:Me,main:Do,modifierPhases:Io,offset:Yo,placements:nn,popper:Et,popperGenerator:Xo,popperOffsets:Jo,preventOverflow:Qo,read:Eo,reference:Co,right:je,start:yt,top:De,variationPlacements:Gs,viewport:sn,write:Lo},Symbol.toStringTag,{value:"Module"}));const lt=new Map,Os={set(n,e,s){lt.has(n)||lt.set(n,new Map);const o=lt.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return lt.has(n)&&lt.get(n).get(e)||null},remove(n,e){if(!lt.has(n))return;const s=lt.get(n);s.delete(e),s.size===0&&lt.delete(n)}},Np=1e6,Ip=1e3,Qs="transitionend",ea=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),jp=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Rp=n=>{do n+=Math.floor(Math.random()*Np);while(document.getElementById(n));return n},Pp=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*Ip)},ta=n=>{n.dispatchEvent(new Event(Qs))},tt=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ct=n=>tt(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ea(n)):null,Wt=n=>{if(!tt(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},ut=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",sa=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?sa(n.parentNode):null},vs=()=>{},Zt=n=>{n.offsetHeight},na=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ls=[],Fp=n=>{document.readyState==="loading"?(Ls.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ls)e()}),Ls.push(n)):n()},We=()=>document.documentElement.dir==="rtl",Ue=n=>{Fp(()=>{const e=na();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Oe=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,oa=(n,e,s=!0)=>{if(!s){Oe(n);return}const a=Pp(e)+5;let r=!1;const c=({target:d})=>{d===e&&(r=!0,e.removeEventListener(Qs,c),Oe(n))};e.addEventListener(Qs,c),setTimeout(()=>{r||ta(e)},a)},mn=(n,e,s,o)=>{const a=n.length;let r=n.indexOf(e);return r===-1?!s&&o?n[a-1]:n[0]:(r+=s?1:-1,o&&(r=(r+a)%a),n[Math.max(0,Math.min(r,a-1))])},Bp=/[^.]*(?=\..*)\.|.*/,Wp=/\..*/,Vp=/::\d+$/,Ns={};let Bn=1;const aa={mouseenter:"mouseover",mouseleave:"mouseout"},Hp=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ia(n,e){return e&&`${e}::${Bn++}`||n.uidEvent||Bn++}function la(n){const e=ia(n);return n.uidEvent=e,Ns[e]=Ns[e]||{},Ns[e]}function Up(n,e){return function s(o){return fn(o,{delegateTarget:n}),s.oneOff&&J.off(n,o.type,e),e.apply(n,[o])}}function qp(n,e,s){return function o(a){const r=n.querySelectorAll(e);for(let{target:c}=a;c&&c!==this;c=c.parentNode)for(const d of r)if(d===c)return fn(a,{delegateTarget:c}),o.oneOff&&J.off(n,a.type,e,s),s.apply(c,[a])}}function ra(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ca(n,e,s){const o=typeof e=="string",a=o?s:e||s;let r=ua(n);return Hp.has(r)||(r=n),[o,a,r]}function Wn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[r,c,d]=ca(e,s,o);e in aa&&(c=(k=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return k.call(this,b)})(c));const m=la(n),p=m[d]||(m[d]={}),u=ra(p,c,r?s:null);if(u){u.oneOff=u.oneOff&&a;return}const y=ia(c,e.replace(Bp,"")),h=r?qp(n,s,c):Up(n,c);h.delegationSelector=r?s:null,h.callable=c,h.oneOff=a,h.uidEvent=y,p[y]=h,n.addEventListener(d,h,r)}function Xs(n,e,s,o,a){const r=ra(e[s],o,a);r&&(n.removeEventListener(s,r,!!a),delete e[s][r.uidEvent])}function zp(n,e,s,o){const a=e[s]||{};for(const[r,c]of Object.entries(a))r.includes(o)&&Xs(n,e,s,c.callable,c.delegationSelector)}function ua(n){return n=n.replace(Wp,""),aa[n]||n}const J={on(n,e,s,o){Wn(n,e,s,o,!1)},one(n,e,s,o){Wn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,r,c]=ca(e,s,o),d=c!==e,m=la(n),p=m[c]||{},u=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(p).length)return;Xs(n,m,c,r,a?s:null);return}if(u)for(const y of Object.keys(m))zp(n,m,y,e.slice(1));for(const[y,h]of Object.entries(p)){const $=y.replace(Vp,"");(!d||e.includes($))&&Xs(n,m,c,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=na(),a=ua(e),r=e!==a;let c=null,d=!0,m=!0,p=!1;r&&o&&(c=o.Event(e,s),o(n).trigger(c),d=!c.isPropagationStopped(),m=!c.isImmediatePropagationStopped(),p=c.isDefaultPrevented());const u=fn(new Event(e,{bubbles:d,cancelable:!0}),s);return p&&u.preventDefault(),m&&n.dispatchEvent(u),u.defaultPrevented&&c&&c.preventDefault(),u}};function fn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Vn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Is(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const st={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Is(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Is(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=Vn(n.dataset[o])}return e},getDataAttribute(n,e){return Vn(n.getAttribute(`data-bs-${Is(e)}`))}};class es{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=tt(s)?st.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...tt(s)?st.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const r=e[o],c=tt(r)?"element":jp(r);if(!new RegExp(a).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${a}".`)}}}const Kp="5.3.8";class ze extends es{constructor(e,s){super(),e=ct(e),e&&(this._element=e,this._config=this._getConfig(s),Os.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Os.remove(this._element,this.constructor.DATA_KEY),J.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){oa(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Os.get(ct(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Kp}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const js=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ea(s)).join(","):null},me={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!ut(s)&&Wt(s))},getSelectorFromElement(n){const e=js(n);return e&&me.findOne(e)?e:null},getElementFromSelector(n){const e=js(n);return e?me.findOne(e):null},getMultipleElementsFromSelector(n){const e=js(n);return e?me.find(e):[]}},ys=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;J.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),ut(this))return;const r=me.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},Gp="alert",Yp="bs.alert",da=`.${Yp}`,Jp=`close${da}`,Qp=`closed${da}`,Xp="fade",Zp="show";class ws extends ze{static get NAME(){return Gp}close(){if(J.trigger(this._element,Jp).defaultPrevented)return;this._element.classList.remove(Zp);const s=this._element.classList.contains(Xp);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),J.trigger(this._element,Qp),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=ws.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ys(ws,"close");Ue(ws);const ev="button",tv="bs.button",sv=`.${tv}`,nv=".data-api",ov="active",Hn='[data-bs-toggle="button"]',av=`click${sv}${nv}`;class $s extends ze{static get NAME(){return ev}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(ov))}static jQueryInterface(e){return this.each(function(){const s=$s.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}J.on(document,av,Hn,n=>{n.preventDefault();const e=n.target.closest(Hn);$s.getOrCreateInstance(e).toggle()});Ue($s);const iv="swipe",Vt=".bs.swipe",lv=`touchstart${Vt}`,rv=`touchmove${Vt}`,cv=`touchend${Vt}`,uv=`pointerdown${Vt}`,dv=`pointerup${Vt}`,mv="touch",fv="pen",pv="pointer-event",vv=40,hv={endCallback:null,leftCallback:null,rightCallback:null},gv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class hs extends es{constructor(e,s){super(),this._element=e,!(!e||!hs.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return hv}static get DefaultType(){return gv}static get NAME(){return iv}dispose(){J.off(this._element,Vt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Oe(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=vv)return;const s=e/this._deltaX;this._deltaX=0,s&&Oe(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(J.on(this._element,uv,e=>this._start(e)),J.on(this._element,dv,e=>this._end(e)),this._element.classList.add(pv)):(J.on(this._element,lv,e=>this._start(e)),J.on(this._element,rv,e=>this._move(e)),J.on(this._element,cv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===fv||e.pointerType===mv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const _v="carousel",bv="bs.carousel",pt=`.${bv}`,ma=".data-api",yv="ArrowLeft",wv="ArrowRight",$v=500,Ut="next",Ct="prev",Tt="left",ms="right",kv=`slide${pt}`,Rs=`slid${pt}`,Sv=`keydown${pt}`,Cv=`mouseenter${pt}`,xv=`mouseleave${pt}`,Ev=`dragstart${pt}`,Tv=`load${pt}${ma}`,Av=`click${pt}${ma}`,fa="carousel",as="active",Dv="slide",Mv="carousel-item-end",Ov="carousel-item-start",Lv="carousel-item-next",Nv="carousel-item-prev",pa=".active",va=".carousel-item",Iv=pa+va,jv=".carousel-item img",Rv=".carousel-indicators",Pv="[data-bs-slide], [data-bs-slide-to]",Fv='[data-bs-ride="carousel"]',Bv={[yv]:ms,[wv]:Tt},Wv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Vv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class ts extends ze{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=me.findOne(Rv,this._element),this._addEventListeners(),this._config.ride===fa&&this.cycle()}static get Default(){return Wv}static get DefaultType(){return Vv}static get NAME(){return _v}next(){this._slide(Ut)}nextWhenVisible(){!document.hidden&&Wt(this._element)&&this.next()}prev(){this._slide(Ct)}pause(){this._isSliding&&ta(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){J.one(this._element,Rs,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){J.one(this._element,Rs,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?Ut:Ct;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&J.on(this._element,Sv,e=>this._keydown(e)),this._config.pause==="hover"&&(J.on(this._element,Cv,()=>this.pause()),J.on(this._element,xv,()=>this._maybeEnableCycle())),this._config.touch&&hs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of me.find(jv,this._element))J.on(o,Ev,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Tt)),rightCallback:()=>this._slide(this._directionToOrder(ms)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),$v+this._config.interval))}};this._swipeHelper=new hs(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Bv[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=me.findOne(pa,this._indicatorsElement);s.classList.remove(as),s.removeAttribute("aria-current");const o=me.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(as),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===Ut,r=s||mn(this._getItems(),o,a,this._config.wrap);if(r===o)return;const c=this._getItemIndex(r),d=$=>J.trigger(this._element,$,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(d(kv).defaultPrevented||!o||!r)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=r;const u=a?Ov:Mv,y=a?Lv:Nv;r.classList.add(y),Zt(r),o.classList.add(u),r.classList.add(u);const h=()=>{r.classList.remove(u,y),r.classList.add(as),o.classList.remove(as,y,u),this._isSliding=!1,d(Rs)};this._queueCallback(h,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(Dv)}_getActive(){return me.findOne(Iv,this._element)}_getItems(){return me.find(va,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return We()?e===Tt?Ct:Ut:e===Tt?Ut:Ct}_orderToDirection(e){return We()?e===Ct?Tt:ms:e===Ct?ms:Tt}static jQueryInterface(e){return this.each(function(){const s=ts.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,Av,Pv,function(n){const e=me.getElementFromSelector(this);if(!e||!e.classList.contains(fa))return;n.preventDefault();const s=ts.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(st.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});J.on(window,Tv,()=>{const n=me.find(Fv);for(const e of n)ts.getOrCreateInstance(e)});Ue(ts);const Hv="collapse",Uv="bs.collapse",ss=`.${Uv}`,qv=".data-api",zv=`show${ss}`,Kv=`shown${ss}`,Gv=`hide${ss}`,Yv=`hidden${ss}`,Jv=`click${ss}${qv}`,Ps="show",Dt="collapse",is="collapsing",Qv="collapsed",Xv=`:scope .${Dt} .${Dt}`,Zv="collapse-horizontal",eh="width",th="height",sh=".collapse.show, .collapse.collapsing",Zs='[data-bs-toggle="collapse"]',nh={parent:null,toggle:!0},oh={parent:"(null|element)",toggle:"boolean"};class Pt extends ze{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=me.find(Zs);for(const a of o){const r=me.getSelectorFromElement(a),c=me.find(r).filter(d=>d===this._element);r!==null&&c.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return nh}static get DefaultType(){return oh}static get NAME(){return Hv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(sh).filter(d=>d!==this._element).map(d=>Pt.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||J.trigger(this._element,zv).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(Dt),this._element.classList.add(is),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(is),this._element.classList.add(Dt,Ps),this._element.style[o]="",J.trigger(this._element,Kv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||J.trigger(this._element,Gv).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Zt(this._element),this._element.classList.add(is),this._element.classList.remove(Dt,Ps);for(const a of this._triggerArray){const r=me.getElementFromSelector(a);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(is),this._element.classList.add(Dt),J.trigger(this._element,Yv)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ps)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ct(e.parent),e}_getDimension(){return this._element.classList.contains(Zv)?eh:th}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Zs);for(const s of e){const o=me.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=me.find(Xv,this._config.parent);return me.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Qv,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Pt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}J.on(document,Jv,Zs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of me.getMultipleElementsFromSelector(this))Pt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ue(Pt);const Un="dropdown",ah="bs.dropdown",kt=`.${ah}`,pn=".data-api",ih="Escape",qn="Tab",lh="ArrowUp",zn="ArrowDown",rh=2,ch=`hide${kt}`,uh=`hidden${kt}`,dh=`show${kt}`,mh=`shown${kt}`,ha=`click${kt}${pn}`,ga=`keydown${kt}${pn}`,fh=`keyup${kt}${pn}`,At="show",ph="dropup",vh="dropend",hh="dropstart",gh="dropup-center",_h="dropdown-center",gt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',bh=`${gt}.${At}`,fs=".dropdown-menu",yh=".navbar",wh=".navbar-nav",$h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",kh=We()?"top-end":"top-start",Sh=We()?"top-start":"top-end",Ch=We()?"bottom-end":"bottom-start",xh=We()?"bottom-start":"bottom-end",Eh=We()?"left-start":"right-start",Th=We()?"right-start":"left-start",Ah="top",Dh="bottom",Mh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Oh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Je extends ze{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=me.next(this._element,fs)[0]||me.prev(this._element,fs)[0]||me.findOne(fs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Mh}static get DefaultType(){return Oh}static get NAME(){return Un}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ut(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!J.trigger(this._element,dh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(wh))for(const o of[].concat(...document.body.children))J.on(o,"mouseover",vs);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(At),this._element.classList.add(At),J.trigger(this._element,mh,e)}}hide(){if(ut(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!J.trigger(this._element,ch,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))J.off(o,"mouseover",vs);this._popper&&this._popper.destroy(),this._menu.classList.remove(At),this._element.classList.remove(At),this._element.setAttribute("aria-expanded","false"),st.removeDataAttribute(this._menu,"popper"),J.trigger(this._element,uh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!tt(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Un.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Zo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:tt(this._config.reference)?e=ct(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=dn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(At)}_getPlacement(){const e=this._parent;if(e.classList.contains(vh))return Eh;if(e.classList.contains(hh))return Th;if(e.classList.contains(gh))return Ah;if(e.classList.contains(_h))return Dh;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ph)?s?Sh:kh:s?xh:Ch}_detectNavbar(){return this._element.closest(yh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(st.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Oe(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=me.find($h,this._menu).filter(a=>Wt(a));o.length&&mn(o,s,e===zn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Je.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===rh||e.type==="keyup"&&e.key!==qn)return;const s=me.find(bh);for(const o of s){const a=Je.getInstance(o);if(!a||a._config.autoClose===!1)continue;const r=e.composedPath(),c=r.includes(a._menu);if(r.includes(a._element)||a._config.autoClose==="inside"&&!c||a._config.autoClose==="outside"&&c||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===qn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:a._element};e.type==="click"&&(d.clickEvent=e),a._completeHide(d)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===ih,a=[lh,zn].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const r=this.matches(gt)?this:me.prev(this,gt)[0]||me.next(this,gt)[0]||me.findOne(gt,e.delegateTarget.parentNode),c=Je.getOrCreateInstance(r);if(a){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),r.focus())}}J.on(document,ga,gt,Je.dataApiKeydownHandler);J.on(document,ga,fs,Je.dataApiKeydownHandler);J.on(document,ha,Je.clearMenus);J.on(document,fh,Je.clearMenus);J.on(document,ha,gt,function(n){n.preventDefault(),Je.getOrCreateInstance(this).toggle()});Ue(Je);const _a="backdrop",Lh="fade",Kn="show",Gn=`mousedown.bs.${_a}`,Nh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Ih={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ba extends es{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Nh}static get DefaultType(){return Ih}static get NAME(){return _a}show(e){if(!this._config.isVisible){Oe(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Zt(s),s.classList.add(Kn),this._emulateAnimation(()=>{Oe(e)})}hide(e){if(!this._config.isVisible){Oe(e);return}this._getElement().classList.remove(Kn),this._emulateAnimation(()=>{this.dispose(),Oe(e)})}dispose(){this._isAppended&&(J.off(this._element,Gn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Lh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ct(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),J.on(e,Gn,()=>{Oe(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){oa(e,this._getElement(),this._config.isAnimated)}}const jh="focustrap",Rh="bs.focustrap",gs=`.${Rh}`,Ph=`focusin${gs}`,Fh=`keydown.tab${gs}`,Bh="Tab",Wh="forward",Yn="backward",Vh={autofocus:!0,trapElement:null},Hh={autofocus:"boolean",trapElement:"element"};class ya extends es{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Vh}static get DefaultType(){return Hh}static get NAME(){return jh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),J.off(document,gs),J.on(document,Ph,e=>this._handleFocusin(e)),J.on(document,Fh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,J.off(document,gs))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=me.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Yn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Bh&&(this._lastTabNavDirection=e.shiftKey?Yn:Wh)}}const Jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Qn=".sticky-top",ls="padding-right",Xn="margin-right";class en{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ls,s=>s+e),this._setElementAttributes(Jn,ls,s=>s+e),this._setElementAttributes(Qn,Xn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ls),this._resetElementAttributes(Jn,ls),this._resetElementAttributes(Qn,Xn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),r=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+a)return;this._saveInitialAttribute(c,s);const d=window.getComputedStyle(c).getPropertyValue(s);c.style.setProperty(s,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&st.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const r=st.getDataAttribute(a,s);if(r===null){a.style.removeProperty(s);return}st.removeDataAttribute(a,s),a.style.setProperty(s,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(tt(e)){s(e);return}for(const o of me.find(e,this._element))s(o)}}const Uh="modal",qh="bs.modal",Ve=`.${qh}`,zh=".data-api",Kh="Escape",Gh=`hide${Ve}`,Yh=`hidePrevented${Ve}`,wa=`hidden${Ve}`,$a=`show${Ve}`,Jh=`shown${Ve}`,Qh=`resize${Ve}`,Xh=`click.dismiss${Ve}`,Zh=`mousedown.dismiss${Ve}`,eg=`keydown.dismiss${Ve}`,tg=`click${Ve}${zh}`,Zn="modal-open",sg="fade",eo="show",Fs="modal-static",ng=".modal.show",og=".modal-dialog",ag=".modal-body",ig='[data-bs-toggle="modal"]',lg={backdrop:!0,focus:!0,keyboard:!0},rg={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class $t extends ze{constructor(e,s){super(e,s),this._dialog=me.findOne(og,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new en,this._addEventListeners()}static get Default(){return lg}static get DefaultType(){return rg}static get NAME(){return Uh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||J.trigger(this._element,$a,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Zn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||J.trigger(this._element,Gh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(eo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){J.off(window,Ve),J.off(this._dialog,Ve),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ba({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ya({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=me.findOne(ag,this._dialog);s&&(s.scrollTop=0),Zt(this._element),this._element.classList.add(eo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,J.trigger(this._element,Jh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){J.on(this._element,eg,e=>{if(e.key===Kh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),J.on(window,Qh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),J.on(this._element,Zh,e=>{J.one(this._element,Xh,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Zn),this._resetAdjustments(),this._scrollBar.reset(),J.trigger(this._element,wa)})}_isAnimated(){return this._element.classList.contains(sg)}_triggerBackdropTransition(){if(J.trigger(this._element,Yh).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Fs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Fs),this._queueCallback(()=>{this._element.classList.remove(Fs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=We()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=We()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=$t.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}J.on(document,tg,ig,function(n){const e=me.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),J.one(e,$a,a=>{a.defaultPrevented||J.one(e,wa,()=>{Wt(this)&&this.focus()})});const s=me.findOne(ng);s&&$t.getInstance(s).hide(),$t.getOrCreateInstance(e).toggle(this)});ys($t);Ue($t);const cg="offcanvas",ug="bs.offcanvas",it=`.${ug}`,ka=".data-api",dg=`load${it}${ka}`,mg="Escape",to="show",so="showing",no="hiding",fg="offcanvas-backdrop",Sa=".offcanvas.show",pg=`show${it}`,vg=`shown${it}`,hg=`hide${it}`,oo=`hidePrevented${it}`,Ca=`hidden${it}`,gg=`resize${it}`,_g=`click${it}${ka}`,bg=`keydown.dismiss${it}`,yg='[data-bs-toggle="offcanvas"]',wg={backdrop:!0,keyboard:!0,scroll:!1},$g={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class dt extends ze{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return wg}static get DefaultType(){return $g}static get NAME(){return cg}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||J.trigger(this._element,pg,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new en().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(so);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(to),this._element.classList.remove(so),J.trigger(this._element,vg,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||J.trigger(this._element,hg).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(no),this._backdrop.hide();const s=()=>{this._element.classList.remove(to,no),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new en().reset(),J.trigger(this._element,Ca)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){J.trigger(this._element,oo);return}this.hide()},s=!!this._config.backdrop;return new ba({className:fg,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new ya({trapElement:this._element})}_addEventListeners(){J.on(this._element,bg,e=>{if(e.key===mg){if(this._config.keyboard){this.hide();return}J.trigger(this._element,oo)}})}static jQueryInterface(e){return this.each(function(){const s=dt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}J.on(document,_g,yg,function(n){const e=me.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ut(this))return;J.one(e,Ca,()=>{Wt(this)&&this.focus()});const s=me.findOne(Sa);s&&s!==e&&dt.getInstance(s).hide(),dt.getOrCreateInstance(e).toggle(this)});J.on(window,dg,()=>{for(const n of me.find(Sa))dt.getOrCreateInstance(n).show()});J.on(window,gg,()=>{for(const n of me.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&dt.getOrCreateInstance(n).hide()});ys(dt);Ue(dt);const kg=/^aria-[\w-]*$/i,xa={"*":["class","dir","id","lang","role",kg],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Sg=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Cg=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,xg=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Sg.has(s)?!!Cg.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Eg(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...a.body.querySelectorAll("*"));for(const c of r){const d=c.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){c.remove();continue}const m=[].concat(...c.attributes),p=[].concat(e["*"]||[],e[d]||[]);for(const u of m)xg(u,p)||c.removeAttribute(u.nodeName)}return a.body.innerHTML}const Tg="TemplateFactory",Ag={allowList:xa,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Dg={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Mg={entry:"(string|element|function|null)",selector:"(string|element)"};class Og extends es{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Ag}static get DefaultType(){return Dg}static get NAME(){return Tg}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,r]of Object.entries(this._config.content))this._setContent(e,r,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},Mg)}_setContent(e,s,o){const a=me.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(tt(s)){this._putElementInTemplate(ct(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Eg(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Oe(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Lg="tooltip",Ng=new Set(["sanitize","allowList","sanitizeFn"]),Bs="fade",Ig="modal",rs="show",jg=".tooltip-inner",ao=`.${Ig}`,io="hide.bs.modal",qt="hover",Ws="focus",Vs="click",Rg="manual",Pg="hide",Fg="hidden",Bg="show",Wg="shown",Vg="inserted",Hg="click",Ug="focusin",qg="focusout",zg="mouseenter",Kg="mouseleave",Gg={AUTO:"auto",TOP:"top",RIGHT:We()?"left":"right",BOTTOM:"bottom",LEFT:We()?"right":"left"},Yg={allowList:xa,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Jg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Ht extends ze{constructor(e,s){if(typeof Zo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Yg}static get DefaultType(){return Jg}static get NAME(){return Lg}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),J.off(this._element.closest(ao),io,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=J.trigger(this._element,this.constructor.eventName(Bg)),o=(sa(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(a),J.trigger(this._element,this.constructor.eventName(Vg))),this._popper=this._createPopper(a),a.classList.add(rs),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))J.on(d,"mouseover",vs);const c=()=>{J.trigger(this._element,this.constructor.eventName(Wg)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||J.trigger(this._element,this.constructor.eventName(Pg)).defaultPrevented)return;if(this._getTipElement().classList.remove(rs),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))J.off(a,"mouseover",vs);this._activeTrigger[Vs]=!1,this._activeTrigger[Ws]=!1,this._activeTrigger[qt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),J.trigger(this._element,this.constructor.eventName(Fg)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Bs,rs),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Rp(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Bs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Og({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[jg]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Bs)}_isShown(){return this.tip&&this.tip.classList.contains(rs)}_createPopper(e){const s=Oe(this._config.placement,[this,e,this._element]),o=Gg[s.toUpperCase()];return dn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Oe(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Oe(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")J.on(this._element,this.constructor.eventName(Hg),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[Vs]=!(a._isShown()&&a._activeTrigger[Vs]),a.toggle()});else if(s!==Rg){const o=s===qt?this.constructor.eventName(zg):this.constructor.eventName(Ug),a=s===qt?this.constructor.eventName(Kg):this.constructor.eventName(qg);J.on(this._element,o,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusin"?Ws:qt]=!0,c._enter()}),J.on(this._element,a,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusout"?Ws:qt]=c._element.contains(r.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},J.on(this._element.closest(ao),io,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=st.getDataAttributes(this._element);for(const o of Object.keys(s))Ng.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ct(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Ht.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ue(Ht);const Qg="popover",Xg=".popover-header",Zg=".popover-body",e_={...Ht.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},t_={...Ht.DefaultType,content:"(null|string|element|function)"};class vn extends Ht{static get Default(){return e_}static get DefaultType(){return t_}static get NAME(){return Qg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Xg]:this._getTitle(),[Zg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=vn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ue(vn);const s_="scrollspy",n_="bs.scrollspy",hn=`.${n_}`,o_=".data-api",a_=`activate${hn}`,lo=`click${hn}`,i_=`load${hn}${o_}`,l_="dropdown-item",xt="active",r_='[data-bs-spy="scroll"]',Hs="[href]",c_=".nav, .list-group",ro=".nav-link",u_=".nav-item",d_=".list-group-item",m_=`${ro}, ${u_} > ${ro}, ${d_}`,f_=".dropdown",p_=".dropdown-toggle",v_={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},h_={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ks extends ze{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return v_}static get DefaultType(){return h_}static get NAME(){return s_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ct(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(J.off(this._config.target,lo),J.on(this._config.target,lo,Hs,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(s(c))},a=(this._rootElement||document.documentElement).scrollTop,r=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(c));continue}const d=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&d){if(o(c),!a)return;continue}!r&&!d&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=me.find(Hs,this._config.target);for(const s of e){if(!s.hash||ut(s))continue;const o=me.findOne(decodeURI(s.hash),this._element);Wt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(xt),this._activateParents(e),J.trigger(this._element,a_,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(l_)){me.findOne(p_,e.closest(f_)).classList.add(xt);return}for(const s of me.parents(e,c_))for(const o of me.prev(s,m_))o.classList.add(xt)}_clearActiveClass(e){e.classList.remove(xt);const s=me.find(`${Hs}.${xt}`,e);for(const o of s)o.classList.remove(xt)}static jQueryInterface(e){return this.each(function(){const s=ks.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(window,i_,()=>{for(const n of me.find(r_))ks.getOrCreateInstance(n)});Ue(ks);const g_="tab",__="bs.tab",St=`.${__}`,b_=`hide${St}`,y_=`hidden${St}`,w_=`show${St}`,$_=`shown${St}`,k_=`click${St}`,S_=`keydown${St}`,C_=`load${St}`,x_="ArrowLeft",co="ArrowRight",E_="ArrowUp",uo="ArrowDown",Us="Home",mo="End",_t="active",fo="fade",qs="show",T_="dropdown",Ea=".dropdown-toggle",A_=".dropdown-menu",zs=`:not(${Ea})`,D_='.list-group, .nav, [role="tablist"]',M_=".nav-item, .list-group-item",O_=`.nav-link${zs}, .list-group-item${zs}, [role="tab"]${zs}`,Ta='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ks=`${O_}, ${Ta}`,L_=`.${_t}[data-bs-toggle="tab"], .${_t}[data-bs-toggle="pill"], .${_t}[data-bs-toggle="list"]`;class Ft extends ze{constructor(e){super(e),this._parent=this._element.closest(D_),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),J.on(this._element,S_,s=>this._keydown(s)))}static get NAME(){return g_}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?J.trigger(s,b_,{relatedTarget:e}):null;J.trigger(e,w_,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(_t),this._activate(me.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(qs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),J.trigger(e,$_,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(fo))}_deactivate(e,s){if(!e)return;e.classList.remove(_t),e.blur(),this._deactivate(me.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(qs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),J.trigger(e,y_,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(fo))}_keydown(e){if(![x_,co,E_,uo,Us,mo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!ut(a));let o;if([Us,mo].includes(e.key))o=s[e.key===Us?0:s.length-1];else{const a=[co,uo].includes(e.key);o=mn(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),Ft.getOrCreateInstance(o).show())}_getChildren(){return me.find(Ks,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=me.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(T_))return;const a=(r,c)=>{const d=me.findOne(r,o);d&&d.classList.toggle(c,s)};a(Ea,_t),a(A_,qs),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(_t)}_getInnerElement(e){return e.matches(Ks)?e:me.findOne(Ks,e)}_getOuterElement(e){return e.closest(M_)||e}static jQueryInterface(e){return this.each(function(){const s=Ft.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,k_,Ta,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ut(this)&&Ft.getOrCreateInstance(this).show()});J.on(window,C_,()=>{for(const n of me.find(L_))Ft.getOrCreateInstance(n)});Ue(Ft);const N_="toast",I_="bs.toast",vt=`.${I_}`,j_=`mouseover${vt}`,R_=`mouseout${vt}`,P_=`focusin${vt}`,F_=`focusout${vt}`,B_=`hide${vt}`,W_=`hidden${vt}`,V_=`show${vt}`,H_=`shown${vt}`,U_="fade",po="hide",cs="show",us="showing",q_={animation:"boolean",autohide:"boolean",delay:"number"},z_={animation:!0,autohide:!0,delay:5e3};class Ss extends ze{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return z_}static get DefaultType(){return q_}static get NAME(){return N_}show(){if(J.trigger(this._element,V_).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(U_);const s=()=>{this._element.classList.remove(us),J.trigger(this._element,H_),this._maybeScheduleHide()};this._element.classList.remove(po),Zt(this._element),this._element.classList.add(cs,us),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||J.trigger(this._element,B_).defaultPrevented)return;const s=()=>{this._element.classList.add(po),this._element.classList.remove(us,cs),J.trigger(this._element,W_)};this._element.classList.add(us),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(cs),super.dispose()}isShown(){return this._element.classList.contains(cs)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){J.on(this._element,j_,e=>this._onInteraction(e,!0)),J.on(this._element,R_,e=>this._onInteraction(e,!1)),J.on(this._element,P_,e=>this._onInteraction(e,!0)),J.on(this._element,F_,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Ss.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ys(Ss);Ue(Ss);const K_={class:"message-content-column"},G_=["id"],Y_={class:"accordion-item"},J_=["id"],Q_=["aria-controls"],X_={class:"d-flex align-items-center w-100"},Z_={class:"badge bg-warning text-dark ms-auto me-2"},eb={class:"text-muted"},tb=["id","aria-labelledby"],sb={class:"accordion-body bg-light"},nb={class:"alert alert-warning mb-3",role:"alert"},ob={class:"compaction-metadata"},ab={class:"metadata-row"},ib={class:"metadata-row"},lb={key:0,class:"metadata-row"},rb={class:"continuation-content"},cb={class:"continuation-text border rounded p-3 bg-white"},ub={class:"mb-0"},db={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=g(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=g(()=>`heading-${s.value}`),a=g(()=>`collapse-${s.value}`),r=R(null);let c=null;Te(()=>{r.value&&(c=new Pt(r.value,{toggle:!1}))}),Da(()=>{c&&c.dispose()});function d(){c&&c.toggle()}const m=g(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),p=g(()=>m.value?e.messages[3]:e.messages[2]),u=g(()=>p.value?.metadata?.init_data?.compact_metadata||{}),y=g(()=>u.value.pre_tokens||0),h=g(()=>m.value?e.messages[4]:e.messages[3]),$=g(()=>h.value?.content||""),k=g(()=>{const v=e.messages[0]?.timestamp;return v?Qt(v):""});function b(v){return v?`${v.toLocaleString()} tokens`:"0 tokens"}return(v,_)=>(i(),l("div",{class:"message-row message-row-compaction",key:s.value},[_[7]||(_[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",K_,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Y_,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":a.value,onClick:d},[t("div",X_,[_[0]||(_[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),_[1]||(_[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",Z_,w(b(y.value)),1),t("small",eb,w(k.value),1)])],8,Q_)],8,J_),t("div",{ref_key:"collapseElement",ref:r,id:a.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",sb,[t("div",nb,[_[5]||(_[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),re(" Compaction Details ")],-1)),t("div",ob,[t("div",ab,[_[2]||(_[2]=t("strong",null,"Trigger:",-1)),t("span",null,w(u.value.trigger||"auto"),1)]),t("div",ib,[_[3]||(_[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,w(b(y.value)),1)]),u.value.post_tokens?(i(),l("div",lb,[_[4]||(_[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,w(b(u.value.post_tokens)),1)])):T("",!0)])]),t("div",rb,[_[6]||(_[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),re(" Continuation Message ")],-1)),t("div",cb,[t("pre",ub,w($.value),1)])])])],8,tb)])],8,G_)])]))}},mb=oe(db,[["__scopeId","data-v-e0b95ba8"]]),fb={key:0,class:"text-muted text-center py-5"},pb={__name:"MessageList",setup(n){const e=Ne(),s=xe(),o=R(null),a=g(()=>{const u=e.currentMessages,y=[];let h=0;for(;h<u.length;){const $=u[h];if(c($,u,h)){const k=u[h+2],v=k?.type==="system"&&k?.metadata?.subtype==="init"?5:4,_=u.slice(h,h+v);y.push({type:"compaction",messages:_}),h+=v;continue}m($)&&y.push({type:"message",message:$,attachedTools:[]}),h++}return r(y)});function r(u){const y=new Map,h=new Set;for(let k=0;k<u.length;k++){const b=u[k];if(b.type==="compaction")continue;const v=b.message,_=v.content&&v.content.trim().length>0&&v.content!=="Assistant response",f=v.type==="assistant"&&v.metadata?.has_tool_uses&&v.metadata?.tool_uses?.length>0;if(v.type==="assistant"&&f&&!_){let S=-1,C=!1;for(let O=k-1;O>=0;O--){const x=u[O];if(!h.has(O)){if(x.type==="message"&&x.message.type!=="assistant"){C=!0;break}if(x.type==="message"&&x.message.type==="assistant"){const E=x.message;if(E.content&&E.content.trim().length>0&&E.content!=="Assistant response"){S=O;break}else{S=O;break}}}}C&&S===-1||(C&&S>=0?(y.has(S)||y.set(S,[]),y.get(S).push(...v.metadata.tool_uses),h.add(k)):!C&&S>=0&&(y.has(S)||y.set(S,[]),y.get(S).push(...v.metadata.tool_uses),h.add(k)))}}const $=[];for(let k=0;k<u.length;k++){if(h.has(k))continue;const b=u[k];y.has(k)&&(b.attachedTools=[...b.attachedTools||[],...y.get(k)]),$.push(b)}return $}function c(u,y,h){if(h+3>=y.length)return!1;const $=y[h],k=y[h+1];let b=y[h+2],v=y[h+3],_=y[h+4];const f=$.type==="system"&&$.metadata?.subtype==="status"&&$.metadata?.init_data?.status==="compacting",S=k.type==="system"&&k.metadata?.subtype==="status"&&(k.metadata?.init_data?.status===null||k.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(h+4>=y.length)return!1;const O=!0,x=v?.type==="system"&&v?.metadata?.subtype==="compact_boundary",E=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",f),console.log("  Msg2 (null status):",S),console.log("  Msg3 (init):",O),console.log("  Msg4 (boundary):",x),console.log("  Msg5 (continuation):",E)),f&&S&&O&&x&&E}else{const O=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",x=v?.type==="user"&&v?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",f),console.log("  Msg2 (null status):",S),console.log("  Msg3 (boundary):",O),console.log("  Msg4 (continuation):",x)),f&&S&&O&&x}}async function d(){s.autoScrollEnabled&&(await rt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}be(()=>a.value.length,d),be(()=>e.currentToolCalls.length,d),be(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),d),Te(()=>{setTimeout(()=>{d()},100)});function m(u){const y=u.subtype||u.metadata?.subtype;if(u.type==="system"&&y==="init"||u.type==="system"&&y==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const h=u.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(u.type==="user"){const h=u.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const h=u.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const h=u.metadata||{};if(h.parent_tool_use_id&&!h.has_tool_results)return!1}return!0}function p(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,y)=>(i(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[a.value.length===0?(i(),l("div",fb," No messages yet. Start a conversation! ")):T("",!0),(i(!0),l(le,null,fe(a.value,(h,$)=>(i(),l(le,{key:`item-${$}`},[h.type==="message"?(i(),Ee(Jf,{key:0,message:p(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(i(),Ee(mb,{key:1,messages:h.messages},null,8,["messages"])):T("",!0)],64))),128))],512))}},vb=oe(pb,[["__scopeId","data-v-bb936559"]]),hb={key:0,class:"attachment-list"},gb={key:0,class:"attachment-preview"},_b=["src","alt"],bb={key:1,class:"attachment-icon"},yb={class:"file-type-icon"},wb={class:"attachment-info"},$b=["title"],kb={class:"attachment-size"},Sb=["onClick"],Cb={key:2,class:"upload-progress"},xb=["title"],Eb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const p=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(p)}function a(m){const p=m.name?.split(".").pop()?.toLowerCase()||"",u=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(p)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(p)?"âš™ï¸":["log","txt"].includes(p)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(p)?"ðŸ“":"ðŸ“"}function r(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function c(m,p=20){if(!m||m.length<=p)return m;const u=m.split(".").pop(),y=m.substring(0,m.length-u.length-1);return y.length<=p-u.length-4?m:y.substring(0,p-u.length-4)+"..."+u}function d(m){s("remove",m)}return(m,p)=>n.attachments.length>0?(i(),l("div",hb,[(i(!0),l(le,null,fe(n.attachments,(u,y)=>(i(),l("div",{key:u.id||y,class:"attachment-item"},[o(u)?(i(),l("div",gb,[t("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,_b)])):(i(),l("div",bb,[t("span",yb,w(a(u)),1)])),t("div",wb,[t("span",{class:"attachment-name",title:u.name},w(c(u.name)),9,$b),t("span",kb,w(r(u.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:h=>d(y)}," âœ• ",8,Sb),u.uploading?(i(),l("div",Cb,[t("div",{class:"progress-bar",style:et({width:(u.progress||0)+"%"})},null,4)])):T("",!0),u.error?(i(),l("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+w(u.error),9,xb)):T("",!0)]))),128))])):T("",!0)}},Tb=oe(Eb,[["__scopeId","data-v-0fcc4974"]]),Ab=["id","aria-selected","onMousedown","onMouseenter"],Db={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=R(null);return be(()=>e.selectedIndex,o=>{if(!s.value)return;const a=s.value.children[o];a&&a.scrollIntoView({block:"nearest"})}),(o,a)=>n.commands.length>0?(i(),l("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),l(le,null,fe(n.commands,(r,c)=>(i(),l("li",{id:`slash-cmd-${c}`,key:r,role:"option",class:Q(["slash-command-item",{active:c===n.selectedIndex}]),"aria-selected":c===n.selectedIndex,onMousedown:ge(d=>o.$emit("select",r),["prevent"]),onMouseenter:d=>o.$emit("highlight",c)}," /"+w(r),43,Ab))),128))],512)):T("",!0)}},Mb=oe(Db,[["__scopeId","data-v-97c65547"]]),Ob={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Lb=["disabled"],Nb=["placeholder","disabled","aria-expanded","aria-activedescendant"],Ib=["disabled"],jb=["disabled"],vo=5*1024*1024,Rb={__name:"InputArea",setup(n){const e=_e(),s=mt(),o=Ge(),a=xe(),r=_o("pendingResourceAttachment",R(null)),c=R(null),d=R(null),m=R(window.innerWidth),p=R([]),u=R(!1),y=R(!1),h=R(!1),$=R(""),k=R(0),b=g({get:()=>e.currentInput,set:M=>{e.currentInput=M}}),v=g(()=>e.currentSession?.is_processing||!1),_=g(()=>s.sessionConnected),f=g(()=>e.currentSession?.state==="starting"),S=g(()=>e.currentSessionId),C=g(()=>!!b.value.trim()||p.value.filter(M=>!M.error).length>0),O=g(()=>m.value<768),x=g(()=>f.value?"Session is starting...":_.value?"Type your message to Claude Code...":"Waiting for connection..."),E=g(()=>{const M=S.value;return M?e.initData.get(M)?.slash_commands||[]:[]}),P=g(()=>{const M=$.value.toLowerCase();return E.value.filter(D=>D.toLowerCase().includes(M)).sort((D,L)=>D.localeCompare(L))});function A(){m.value=window.innerWidth}Te(()=>{window.addEventListener("resize",A)}),Ae(()=>{window.removeEventListener("resize",A)}),be(r,M=>{M&&(ae(M),r.value=null)});function B(M){if(h.value&&P.value.length>0){const D=P.value.length;if(M.key==="ArrowDown"){M.preventDefault(),k.value=(k.value+1)%D;return}if(M.key==="ArrowUp"){M.preventDefault(),k.value=(k.value-1+D)%D;return}if(M.key==="Enter"){M.preventDefault(),V(P.value[k.value]);return}if(M.key==="Tab"){M.preventDefault(),V(P.value[k.value]);return}}if(M.key==="Escape"&&h.value){M.preventDefault(),h.value=!1;return}if(M.key==="Enter"&&!M.shiftKey){if(O.value)return;M.preventDefault(),ne()}}function G(){const M=c.value;if(!M)return;M.style.height="auto";const D=Math.min(M.scrollHeight,parseInt(getComputedStyle(M).maxHeight));M.style.height=D+"px"}be(b,M=>{M.startsWith("/")&&E.value.length>0?($.value=M.slice(1),k.value=0,h.value=P.value.length>0):h.value=!1});function V(M){b.value=`/${M} `,h.value=!1,c.value?.focus(),G()}function N(){d.value?.click()}function W(M){const D=Array.from(M.target.files||[]);j(D),M.target.value=""}function z(M){u.value=!1;const D=Array.from(M.dataTransfer?.files||[]);j(D)}function Y(M){const D=M.clipboardData?.items;if(!D)return;const L=[];for(const I of D)if(I.type.startsWith("image/")){const U=I.getAsFile();if(U){const Z=I.type.split("/")[1]||"png",he=`clipboard-${Date.now()}.${Z}`,Pe=new File([U],he,{type:U.type});L.push(Pe)}}L.length>0&&(M.preventDefault(),j(L))}function j(M){for(const D of M){if(D.size>vo){p.value.push({id:K(),name:D.name,size:D.size,type:D.type,file:D,error:`File too large (max ${vo/(1024*1024)}MB)`});continue}let L=null;D.type.startsWith("image/")&&(L=URL.createObjectURL(D)),p.value.push({id:K(),name:D.name,size:D.size,type:D.type,file:D,preview:L,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function F(M){const D=p.value[M];D.preview&&URL.revokeObjectURL(D.preview),p.value.splice(M,1)}function K(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function ee(M){const D=S.value;if(!D)return null;M.uploading=!0,M.progress=0,M.error=null;try{const L=new FormData;L.append("file",M.file);const I=await fetch(`/api/sessions/${D}/files`,{method:"POST",body:L});if(!I.ok){const Z=await I.json().catch(()=>({}));throw new Error(Z.detail||`Upload failed: ${I.status}`)}const U=await I.json();return M.uploaded=!0,M.uploadedInfo=U.file,M.progress=100,U.file}catch(L){return M.error=L.message,null}finally{M.uploading=!1}}async function se(){const M=p.value.filter(D=>!D.uploaded&&!D.error);if(M.length===0)return!0;y.value=!0;try{return(await Promise.all(M.map(ee))).every(L=>L!==null)}finally{y.value=!1}}async function ne(){const M=b.value.trim(),D=p.value.filter(U=>!U.error).length>0;if(!M&&!D||D&&!await se())return;let L=b.value;const I=p.value.filter(U=>U.uploaded&&U.uploadedInfo).map(U=>U.uploadedInfo);if(I.length>0){const U=I.map(Z=>{const he=(Z.size_bytes/1024).toFixed(1);return`- ${Z.original_name} (${he} KB): ${Z.stored_path}`}).join(`
`);L.trim()?L=`${L}

---
Attached files (use Read tool to access):
${U}`:L=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${U}`}s.sendMessage(L),b.value="",ve(),c.value&&(c.value.style.height="auto")}function ve(){for(const M of p.value)M.preview&&URL.revokeObjectURL(M.preview);p.value=[]}function ae(M){if(!M||!M.resource_id){console.warn("Invalid resource for attachment:",M);return}const D=S.value;if(!D){console.warn("No current session for resource attachment");return}if(p.value.findIndex(Z=>Z.resourceId===M.resource_id)>=0){console.log("Resource already attached:",M.resource_id);return}const I=o.isImageResource(M);let U=null;I&&(U=o.getResourceUrl(D,M.resource_id)),p.value.push({id:K(),resourceId:M.resource_id,name:M.original_filename||M.title||"Resource",size:M.size_bytes||0,type:M.format||"application/octet-stream",file:null,preview:U,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:M.resource_id,original_name:M.original_filename||M.title,stored_path:M.file_path||`/api/sessions/${D}/resources/${M.resource_id}`,size_bytes:M.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",M.resource_id)}function H(){s.interruptSession()}return(M,D)=>(i(),l("div",{class:Q(["border-top",ie(a).isRedBackground?"theme-red-panel":"bg-light"])},[_.value?T("",!0):(i(),l("div",Ob,[...D[6]||(D[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),ye(Tb,{attachments:p.value,onRemove:F},null,8,["attachments"]),u.value?(i(),l("div",{key:1,class:"drop-zone-overlay",onDragover:D[0]||(D[0]=ge(()=>{},["prevent"])),onDragleave:D[1]||(D[1]=L=>u.value=!1),onDrop:ge(z,["prevent"])},[...D[7]||(D[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):T("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:D[4]||(D[4]=ge(L=>u.value=!0,["prevent"])),onDragenter:D[5]||(D[5]=ge(L=>u.value=!0,["prevent"]))},[h.value?(i(),Ee(Mb,{key:0,commands:P.value,"selected-index":k.value,onSelect:V,onHighlight:D[2]||(D[2]=L=>k.value=L)},null,8,["commands","selected-index"])):T("",!0),t("input",{ref_key:"fileInput",ref:d,type:"file",multiple:"",class:"d-none",onChange:W},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:f.value||!_.value,onClick:N}," ðŸ“Ž ",8,Lb),Ce(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:c,"onUpdate:modelValue":D[3]||(D[3]=L=>b.value=L),class:"form-control",placeholder:x.value,disabled:f.value||!_.value,rows:"1","aria-expanded":h.value||void 0,"aria-activedescendant":h.value?`slash-cmd-${k.value}`:void 0,onInput:G,onKeydown:B,onPaste:Y},null,40,Nb),[[qe,b.value]]),v.value&&!C.value?(i(),l("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:H}," Stop ")):v.value&&C.value?(i(),l("button",{key:2,class:"btn btn-info",disabled:!_.value||f.value||y.value,title:"Send while processing (doesn't interrupt)",onClick:ne},w(y.value?"Uploading...":"Queue"),9,Ib)):(i(),l("button",{key:3,class:"btn btn-primary",disabled:!C.value||!_.value||f.value||y.value,onClick:ne},w(y.value?"Uploading...":"Send"),9,jb))],32)],2))}},Pb=oe(Rb,[["__scopeId","data-v-5b1f250e"]]),Fb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Bb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Wb={class:"text-secondary"},Vb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Hb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=xe(),a=g(()=>s.currentSession),r=g(()=>o.isLoading),c=g(()=>o.loadingMessage);return Te(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),be(()=>e.sessionId,async(d,m)=>{if(d!==m&&d!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(d)}finally{o.hideLoading()}}}),Ae(()=>{}),(d,m)=>(i(),l("div",Fb,[r.value?(i(),l("div",Bb,[m[0]||(m[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Wb,w(c.value),1)])):T("",!0),a.value?(i(),Ee(Ga,{key:1,"session-id":e.sessionId},null,8,["session-id"])):T("",!0),t("div",Vb,[ye(vb)]),ye(Pb),a.value?(i(),Ee(Za,{key:2,"session-id":e.sessionId},null,8,["session-id"])):T("",!0),a.value?(i(),Ee(li,{key:3,"session-id":e.sessionId},null,8,["session-id"])):T("",!0)]))}},Cs=at("legion",()=>{const n=R(new Map),e=R(new Map),s=R(null),o=g(()=>n.value.get(s.value)||[]),a=g(()=>e.value.get(s.value)||[]);function r(k){s.value=k}async function c(k,b=100,v=0){try{const _=await we.get(`/api/legions/${k}/timeline?limit=${b}&offset=${v}`),f=_.comms||[],S=_.total_count||f.length,C=_.has_more||!1;return f.sort((O,x)=>new Date(O.timestamp)-new Date(x.timestamp)),console.log(`Loaded ${f.length} of ${S} comms for legion ${k}`),n.value.set(k,f),n.value=new Map(n.value),{comms:f,totalCount:S,hasMore:C}}catch(_){throw console.error("Failed to load timeline:",_),_}}function d(k,b){n.value.has(k)||n.value.set(k,[]);const v=n.value.get(k);if(v.some(f=>f.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}v.push(b),n.value=new Map(n.value)}async function m(k,b){try{const _=(await we.post(`/api/legions/${k}/comms`,b)).comm;return console.log(`Sent comm ${_.comm_id} to legion ${k}`),_}catch(v){throw console.error("Failed to send comm:",v),v}}async function p(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function u(k,b){try{const _=(await we.post(`/api/legions/${k}/minions`,b)).minion;return await p(k),console.log(`Created minion ${_.minion_id} in legion ${k}`),_}catch(v){throw console.error("Failed to create minion:",v),v}}async function y(k){try{const b=await we.post(`/api/legions/${k}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${k}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function h(k){try{const b=await we.post(`/api/legions/${k}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${k}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function $(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:a,setCurrentLegion:r,loadTimeline:c,addComm:d,sendComm:m,loadMinions:p,createMinion:u,haltAll:y,resumeAll:h,clearLegionData:$}}),Ub=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Cs},Symbol.toStringTag,{value:"Module"})),qb={class:"timeline-header border-bottom p-3"},zb={class:"project-name"},Kb=["title"],Gb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=He(),o=g(()=>s.projects.get(e.legionId)),a=g(()=>o.value?.name||"Legion");return(r,c)=>(i(),l("div",qb,[t("div",null,[t("div",zb,w(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Kb)])]))}},Yb=oe(Gb,[["__scopeId","data-v-44f386f5"]]),Jb={class:"timeline-status-bar border-top p-2 bg-light"},Qb={class:"d-flex justify-content-end"},Xb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=xe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(i(),l("div",Jb,[t("div",Qb,[t("button",{class:Q(["btn btn-sm",ie(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+w(ie(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Zb=oe(Xb,[["__scopeId","data-v-891c73db"]]),ey={class:"comm-composer border-top p-3"},ty={key:0,class:"d-flex gap-2 mb-2"},sy={class:"flex-grow-1"},ny=["disabled"],oy={label:"Minions"},ay=["value"],iy={style:{"min-width":"150px"}},ly=["disabled"],ry={class:"d-flex gap-2 align-items-end position-relative"},cy={class:"flex-grow-1 position-relative"},uy=["disabled"],dy=["onClick","onMouseenter"],my=["disabled"],fy={key:0},py={key:1},vy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Cs(),o=_e(),a=He(),r=R(""),c=R("task"),d=R(""),m=R(!1),p=R(window.innerWidth),u=R(!1),y=R([]),h=R(0),$=R(-1),k=R(null),b=R(null),v=g(()=>p.value<768),_=g(()=>{const V=a.projects.get(e.legionId);return!V||!V.session_ids?[]:V.session_ids.map(N=>o.sessions.get(N)).filter(N=>N)}),f=g(()=>r.value&&d.value.trim().length>0);function S(V){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[V.state]||"â—‹"}function C(V){return V.role?`${V.name} (${V.role})`:V.name}function O(){const V=k.value;if(!V)return;V.style.height="auto";const N=Math.min(V.scrollHeight,parseInt(getComputedStyle(V).maxHeight));V.style.height=N+"px"}function x(){const V=k.value;if(!V)return;O();const N=d.value,W=V.selectionStart,z=N.substring(0,W),Y=z.lastIndexOf("#");if(Y===-1){u.value=!1;return}const j=z.substring(Y+1).toLowerCase();if(j.includes(" ")){u.value=!1;return}const F=_.value.filter(K=>K.name.toLowerCase().includes(j)).map(K=>({type:"minion",name:K.name,role:K.role,id:K.session_id,state:K.state}));if(F.length===0){u.value=!1;return}y.value=F,h.value=0,$.value=Y,u.value=!0}function E(){if(!b.value)return;const V=b.value,N=V.children[h.value];if(!N)return;const W=N.offsetTop,z=N.offsetHeight,Y=V.scrollTop,j=V.clientHeight;W<Y?V.scrollTop=W:W+z>Y+j&&(V.scrollTop=W+z-j)}function P(V){if(!u.value){if(V.key==="Enter"&&!V.shiftKey){if(v.value)return;f.value&&(V.preventDefault(),B())}return}if(V.key==="ArrowDown")V.preventDefault(),h.value=(h.value+1)%y.value.length,E();else if(V.key==="ArrowUp")V.preventDefault(),h.value=h.value===0?y.value.length-1:h.value-1,E();else if(V.key==="Enter"){V.preventDefault();const N=y.value[h.value];N&&A(N)}else V.key==="Escape"&&(u.value=!1)}function A(V){const N=k.value;if(!N)return;const W=d.value,z=N.selectionStart,Y=W.substring(0,$.value)+"#"+V.name+" "+W.substring(z);d.value=Y;const j=$.value+V.name.length+2;setTimeout(()=>{N.setSelectionRange(j,j),N.focus()},0),u.value=!1}async function B(){if(!(!f.value||m.value)){m.value=!0;try{const[V,N]=r.value.split(":"),W={comm_type:c.value,content:d.value.trim()};V==="minion"&&(W.to_minion_id=N),await s.sendComm(e.legionId,W),d.value="",O()}catch(V){console.error("Failed to send comm:",V),alert(`Failed to send comm: ${V.message}`)}finally{m.value=!1}}}function G(){p.value=window.innerWidth}return Te(()=>{window.addEventListener("resize",G)}),Ae(()=>{window.removeEventListener("resize",G)}),be(u,V=>{if(V){const N=W=>{W.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",N))};setTimeout(()=>document.addEventListener("click",N),0)}}),(V,N)=>(i(),l("div",ey,[n.hideRecipientSelector?T("",!0):(i(),l("div",ty,[t("div",sy,[Ce(t("select",{"onUpdate:modelValue":N[0]||(N[0]=W=>r.value=W),class:"form-select form-select-sm",disabled:m.value},[N[3]||(N[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",oy,[(i(!0),l(le,null,fe(_.value,W=>(i(),l("option",{key:W.session_id,value:`minion:${W.session_id}`},w(S(W))+" "+w(C(W)),9,ay))),128))])],8,ny),[[yn,r.value]])]),t("div",iy,[Ce(t("select",{"onUpdate:modelValue":N[1]||(N[1]=W=>c.value=W),class:"form-select form-select-sm",disabled:m.value},[...N[4]||(N[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,ly),[[yn,c.value]])])])),t("div",ry,[t("div",cy,[Ce(t("textarea",{ref_key:"contentTextarea",ref:k,"onUpdate:modelValue":N[2]||(N[2]=W=>d.value=W),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:x,onKeydown:P},null,40,uy),[[qe,d.value]]),u.value?(i(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),l(le,null,fe(y.value,(W,z)=>(i(),l("div",{key:W.id,class:Q(["autocomplete-item px-2 py-1",{"bg-light":z===h.value}]),onClick:Y=>A(W),onMouseenter:Y=>h.value=z},w(W.type==="minion"?S(W):"#ï¸âƒ£")+" "+w(W.name)+w(W.role?` (${W.role})`:""),43,dy))),128))],512)):T("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!f.value||m.value,onClick:B},[m.value?(i(),l("span",fy,[...N[5]||(N[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),re(" Sending... ",-1)])])):(i(),l("span",py,"Send"))],8,my)])])]))}},hy=oe(vy,[["__scopeId","data-v-e52b8e8f"]]),gy={class:"message-content-column-full"},_y=["aria-expanded"],by={class:"comm-sender-recipient"},yy={class:"comm-badge-summary"},wy=["title"],$y={class:"comm-summary-text text-muted ms-2"},ky=["aria-label"],Sy={key:0,class:"comm-content-body"},Cy=["innerHTML"],xy="ffffffff-ffff-ffff-ffff-ffffffffffff",Ey={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;nt.setOptions({breaks:!0,gfm:!0});const s=R(!1);function o(){s.value=!s.value}const a=g(()=>e.comm.from_minion_id===xy),r=g(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),c=g(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),d=g(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),m=g(()=>{const p=e.comm.content||"";let u=nt.parse(p);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),Jt.sanitize(u)});return(p,u)=>(i(),l("div",{class:Q(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",gy,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",by,[t("strong",{class:Q({"system-sender":a.value})},w(n.senderName),3),n.recipientName?(i(),l(le,{key:0},[u[0]||(u[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,w(n.recipientName),1)],64)):T("",!0)]),t("div",yy,[t("span",{class:Q(["badge",c.value]),title:r.value},w(n.comm.comm_type),11,wy),t("span",$y,w(d.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},w(s.value?"â–¾":"â–¸"),9,ky)],8,_y),s.value?(i(),l("div",Sy,[t("div",{class:"message-text",innerHTML:m.value},null,8,Cy)])):T("",!0)])],2))}},Ty=oe(Ey,[["__scopeId","data-v-28513f64"]]),Ay={class:"timeline-view d-flex flex-column h-100"},Dy={key:0,class:"text-center text-muted"},My={key:1,class:"text-center text-danger"},Oy={key:2,class:"text-center text-muted"},Ly={key:3,class:"comm-list"},Ny={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Cs();He();const o=_e(),a=mt(),r=xe(),c=R(!0),d=R(null),m=R(null),p=g(()=>s.currentComms);function u(v){return v.from_user?"You":v.from_minion_id?v.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(v.from_minion_id)?.name||"Unknown":"Unknown"}function y(v){return v.to_user?"You":v.to_minion_id?o.sessions.get(v.to_minion_id)?.name||"Unknown":"All"}async function h(){r.autoScrollEnabled&&(await rt(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function $(){c.value=!0,d.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await rt(),await h(),setTimeout(()=>{h()},100)}catch(v){console.error("Failed to load timeline:",v),v.response?d.value=`${v.message} (${v.response.status})`:d.value=v.message||"Unknown error"}finally{c.value=!1}}function k(){a.connectLegion(e.legionId)}function b(){a.disconnectLegion()}return be(()=>p.value.length,()=>{h()}),Te(()=>{o.currentSessionId=null,$(),k(),setTimeout(()=>{h()},100)}),Ae(()=>{b()}),(v,_)=>(i(),l("div",Ay,[ye(Yb,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(i(),l("div",Dy,[..._[0]||(_[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),re(" Loading timeline... ",-1)])])):d.value?(i(),l("div",My," Failed to load timeline: "+w(d.value),1)):p.value.length===0?(i(),l("div",Oy," No messages yet. Minions will appear here once they start communicating. ")):(i(),l("div",Ly,[(i(!0),l(le,null,fe(p.value,f=>(i(),Ee(Ty,{key:f.comm_id,comm:f,"sender-name":u(f),"recipient-name":y(f)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ye(hy,{"legion-id":n.legionId},null,8,["legion-id"]),ye(Zb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Iy=oe(Ny,[["__scopeId","data-v-b6752179"]]),jy={class:"minion-info flex-grow-1"},Ry={class:"minion-name"},Py={key:0,class:"me-1"},Fy={key:1,class:"badge bg-secondary ms-2"},By={key:0,class:"latest-activity text-muted"},Wy={key:0,class:"activity-prefix"},Vy=["title"],Hy={key:1,class:"activity-time ms-1"},Uy={key:1,class:"latest-activity text-muted"},qy={class:"activity-prefix"},zy=["title"],Ky={key:2,class:"latest-activity text-muted fst-italic small"},Gy={class:"node-row"},Yy={class:"node-left"},Jy={key:0,class:"me-2"},Qy={key:1,class:"badge bg-secondary ms-2"},Xy={class:"node-right"},Zy={key:0,class:"latest-message-preview"},e1={key:0,class:"message-prefix"},t1=["title"],s1={key:1,class:"message-time ms-1"},n1={key:1,class:"last-comm-preview"},o1={class:"comm-direction"},a1=["title"],i1={key:2,class:"text-muted fst-italic small"},l1={class:"node-actions"},r1={key:2,class:"minion-children"},c1={key:1,class:"text-danger small ms-4"},u1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,a=_e(),r=Ne(),c=xe(),d=g(()=>!s.minionData||!s.minionData.id?null:a.getSession(s.minionData.id)),m=g(()=>{if(!s.minionData||!s.minionData.id)return null;const A=r.messagesBySession.get(s.minionData.id);if(!A||A.length===0)return null;for(let B=A.length-1;B>=0;B--){const G=A[B],V=G.subtype||G.metadata?.subtype;if(G.type!=="result"&&!(G.type==="system"&&V==="init")&&!(G.type==="system"&&V==="task_notification")&&!(G.type==="permission_request"||G.type==="permission_response")){if(G.type==="user"&&G.metadata?.has_tool_results){const N=G.content||"";if(N.match(/^Tool results?: \d+ results?$/i)||N.trim()==="")continue}if(G.type==="user"){const N=G.content||"";if(N.includes("<command-message>")&&N.includes("skill is running")||N.startsWith("Base directory for this skill:"))continue}if(G.type==="user"){const N=G.content||"";if(N.includes("<command-message>")&&N.includes("<command-name>")&&N.includes("<command-args>")||N.includes("ARGUMENTS:")&&(N.includes("<command-name>")||N.match(/\nARGUMENTS:/)))continue}if(!(G.type==="system"&&G.content==="System message")&&!(G.type==="assistant"&&G.content==="Assistant response")&&(G.type==="user"||G.type==="assistant"||G.type==="system"))return{content:G.content,type:G.type,timestamp:G.timestamp}}}return null}),p=g(()=>{if(!s.minionData)return null;const A={...s.minionData};return d.value&&(A.state=d.value.state,A.is_processing=d.value.is_processing,d.value.name&&(A.name=d.value.name),d.value.latest_message&&(A.latest_message=d.value.latest_message,A.latest_message_type=d.value.latest_message_type,A.latest_message_time=d.value.latest_message_time)),m.value&&(A.latest_message=m.value.content,A.latest_message_type=m.value.type,A.latest_message_time=m.value.timestamp),A}),u=g(()=>s.level*24),y=g(()=>!s.minionData||!s.minionData.id?!1:a.currentSessionId===s.minionData.id),h=g(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),$=g(()=>s.minionData&&s.minionData.is_overseer&&h.value),k=g(()=>{const A=p.value;return A?A.state==="paused"&&A.is_processing?"pending-prompt":A.is_processing?"processing":A.state||"created":"created"}),b=g(()=>{const A=k.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[A]||"status-dot-grey"}),v=g(()=>{const A=k.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[A]||"#d3d3d3"}}),_=g(()=>{const A=p.value;if(!A||!A.latest_message_type)return"";const B=A.latest_message_type;return B==="user"?"User -->:":B==="system"?"System:":""}),f=g(()=>{const A=p.value;if(!A||!A.latest_message)return"";const B=A.latest_message,G=150;return B.length>G?B.slice(0,G)+"...":B}),S=g(()=>{const A=p.value;if(!A||!A.latest_message_time)return"";try{const B=Date.now();let G;if(typeof A.latest_message_time=="number"?G=A.latest_message_time<3250368e4?A.latest_message_time*1e3:A.latest_message_time:G=new Date(A.latest_message_time).getTime(),isNaN(G)||G<9466848e5||G>B+6e4)return console.warn("Invalid timestamp for relative time calculation:",A.latest_message_time,"parsed to:",G),"";const V=B-G;if(V<0)return"just now";const N=Math.floor(V/6e4),W=Math.floor(N/60),z=Math.floor(W/24);return z>0?`${z}d ago`:W>0?`${W}h ago`:N>0?`${N}m ago`:"just now"}catch(B){return console.error("Error calculating relative time:",B,A.latest_message_time),""}});function C(A){return A.to_user?"User":A.to_minion_name?A.to_minion_name:"unknown"}function O(A){const B=A.summary||A.content||"";return B.length>150?B.substring(0,150)+"...":B}function x(){o("minion-click",s.minionData.id)}function E(){const A=a.sessions.get(s.minionData.id);A&&c.showModal("edit-session",{session:A})}function P(){const A=a.sessions.get(s.minionData.id);A&&c.showModal("manage-session",{session:A})}return(A,B)=>{const G=bo("MinionTreeNode",!0);return n.minionData?(i(),l("div",{key:0,class:"minion-tree-node",style:et({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(i(),l("div",{key:0,class:Q(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:y.value}]),onClick:x},[t("div",{class:Q(["status-dot me-2",b.value]),style:et(v.value)},null,6),t("div",jy,[t("div",Ry,[$.value?(i(),l("span",Py,"ðŸ‘‘")):T("",!0),t("strong",null,w(p.value?.name||n.minionData.name),1),$.value?(i(),l("span",Fy,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):T("",!0)]),p.value?.latest_message?(i(),l("div",By,[_.value?(i(),l("span",Wy,w(_.value),1)):T("",!0),t("span",{class:"activity-content",title:p.value.latest_message},w(f.value),9,Vy),S.value?(i(),l("span",Hy,"("+w(S.value)+")",1)):T("",!0)])):n.minionData?.last_comm?(i(),l("div",Uy,[t("span",qy,[B[1]||(B[1]=re("â†’ ",-1)),t("strong",null,w(C(n.minionData.last_comm)),1),B[2]||(B[2]=re(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},w(O(n.minionData.last_comm)),9,zy)])):(i(),l("div",Ky," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ge(E,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ge(P,["stop"])}," âš™ï¸ ")],2)):(i(),l("div",{key:1,class:Q(["minion-card minion-card-clickable border-start border-2 mb-2",{active:y.value}]),onClick:x},[t("div",Gy,[t("div",Yy,[t("div",{class:Q(["status-dot me-2",b.value]),style:et(v.value)},null,6),$.value?(i(),l("span",Jy,"ðŸ‘‘")):T("",!0),t("strong",null,w(p.value?.name||n.minionData.name),1),$.value?(i(),l("span",Qy,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):T("",!0)]),t("div",Xy,[p.value?.latest_message?(i(),l("div",Zy,[_.value?(i(),l("span",e1,w(_.value),1)):T("",!0),t("span",{class:"message-content",title:p.value.latest_message},w(f.value),9,t1),S.value?(i(),l("span",s1,"("+w(S.value)+")",1)):T("",!0)])):n.minionData?.last_comm?(i(),l("div",n1,[t("span",o1,[B[3]||(B[3]=re("â†’ ",-1)),t("strong",null,w(C(n.minionData.last_comm)),1),B[4]||(B[4]=re(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},w(O(n.minionData.last_comm)),9,a1)])):(i(),l("div",i1," No activity yet "))]),t("div",l1,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ge(E,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ge(P,["stop"])}," âš™ï¸ ")])])],2)),h.value?(i(),l("div",r1,[(i(!0),l(le,null,fe(n.minionData.children,V=>(i(),Ee(G,{key:V.id,"minion-data":V,level:n.level+1,layout:n.layout,onMinionClick:B[0]||(B[0]=N=>A.$emit("minion-click",N))},null,8,["minion-data","level","layout"]))),128))])):T("",!0)],4)):(i(),l("div",c1," âš  Minion data is missing "))}}},Aa=oe(u1,[["__scopeId","data-v-64b23e0e"]]),d1={class:"project-overview d-flex flex-column h-100"},m1={class:"project-overview-header border-bottom p-3"},f1={class:"d-flex align-items-center justify-content-between"},p1={class:"mb-1"},v1={key:0,class:"me-2"},h1={class:"text-muted font-monospace"},g1={class:"d-flex gap-2"},_1=["title"],b1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},y1={key:0,class:"text-center py-5"},w1={key:1,class:"alert alert-danger"},$1={key:2,class:"text-center py-5"},k1={key:3},S1={class:"row g-3 mb-4"},C1={class:"col-md-4"},x1={class:"card h-100"},E1={class:"card-body"},T1={class:"card-title mb-0"},A1={class:"text-muted"},D1={class:"col-md-4"},M1={class:"card h-100"},O1={class:"card-body"},L1={class:"card-title mb-0"},N1={class:"text-muted"},I1={key:0,class:"card mb-4"},j1={class:"card mb-4"},R1={class:"card-header d-flex align-items-center justify-content-between"},P1={class:"mb-0"},F1={class:"badge bg-secondary"},B1={class:"card-body"},W1={key:0,class:"text-center py-4"},V1={key:1,class:"text-center text-muted py-4"},H1={key:2,class:"hierarchy-tree"},U1={class:"user-root-node mb-3 border rounded bg-white"},q1={class:"node-row"},z1={class:"node-left"},K1={class:"badge bg-primary ms-2"},G1={class:"node-right"},Y1={key:0,class:"last-comm-preview"},J1={class:"comm-direction"},Q1=["title"],X1={key:1,class:"text-muted fst-italic"},Z1={class:"root-minions ms-4"},ew={class:"card"},tw={class:"card-body"},sw={class:"row mb-0"},nw={class:"col-sm-8 font-monospace text-break"},ow={class:"col-sm-8 font-monospace text-break"},aw={class:"col-sm-8"},iw={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},lw={class:"text-muted"},rw={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Yt(),o=He(),a=_e(),r=xe(),c=Cs(),d=mt(),m=R(!1),p=R(null),u=R(null),y=R(!1);let h=null;const $=g(()=>o.getProject(e.projectId)),k=g(()=>$.value?.session_ids?$.value.session_ids.map(W=>a.getSession(W)).filter(W=>W!=null):[]),b=g(()=>k.value.length>0),v=g(()=>k.value.length),_=g(()=>k.value.filter(W=>W.state==="ACTIVE").length),f=g(()=>{const W=k.value.some(j=>j.state==="ACTIVE"),z=k.value.some(j=>j.is_processing);return k.value.some(j=>j.state==="ERROR")?"Error":z?"Working":W?"Active":v.value>0?"Idle":"Empty"}),S=g(()=>{switch(f.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),C=g(()=>{switch(f.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function O(){y.value=!0;try{const W=await we.get(`/api/legions/${e.projectId}/hierarchy`);u.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),u.value=null}finally{y.value=!1}}function x(W,z){if(W&&W.id===z)return W;if(W&&W.children)for(const Y of W.children){const j=x(Y,z);if(j)return j}return null}function E(W){return W.to_user?"User":W.to_minion_name?W.to_minion_name:"unknown"}function P(W){const z=W.summary||W.content||"";return z.length>150?z.substring(0,150)+"...":z}function A(W){if(u.value){if(W.from_minion_id){const z=x(u.value,W.from_minion_id);z&&z.type==="minion"&&(z.last_comm=W)}W.from_user&&u.value.type==="user"&&(u.value.last_comm=W)}}function B(W){s.push(`/session/${W}`)}function G(){s.push(`/timeline/${e.projectId}`)}function V(){r.showModal("edit-project",{project:$.value})}function N(){r.showModal("create-minion",{project:$.value})}return Te(()=>{o.selectProject(e.projectId),a.currentSessionId=null,O(),c.setCurrentLegion(e.projectId),d.connectLegion(e.projectId),h=be(()=>a.sessions,W=>{if(u.value){for(const[z,Y]of W)if(Y.project_id===e.projectId){const j=x(u.value,z);j&&j.type==="minion"&&(j.state!==Y.state&&(j.state=Y.state),j.is_processing!==Y.is_processing&&(j.is_processing=Y.is_processing),j.latest_message!==Y.latest_message&&(j.latest_message=Y.latest_message,j.latest_message_type=Y.latest_message_type,j.latest_message_time=Y.latest_message_time))}}},{deep:!0}),be(()=>c.commsByLegion.get(e.projectId),W=>{if(W&&W.length>0){const z=W[W.length-1];A(z)}},{deep:!0}),be(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(W,z)=>{W!==z&&O()})}),be(()=>e.projectId,W=>{o.selectProject(W),a.currentSessionId=null,O(),c.setCurrentLegion(W),d.connectLegion(W)}),Ae(()=>{h&&h()}),(W,z)=>(i(),l("div",d1,[t("div",m1,[t("div",f1,[t("div",null,[t("h4",p1,[b.value?(i(),l("span",v1,"ðŸ›")):T("",!0),re(" "+w($.value?.name||"Project Overview"),1)]),t("small",h1,w($.value?.working_directory),1)]),t("div",g1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:V}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:N}," âž• "+w(b.value?"Add Minion":"Add Session"),9,_1)])])]),t("div",b1,[m.value?(i(),l("div",y1,[...z[0]||(z[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(i(),l("div",w1,w(p.value),1)):$.value?(i(),l("div",k1,[t("div",S1,[t("div",C1,[t("div",x1,[t("div",E1,[z[2]||(z[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",T1,w(v.value),1),t("small",A1,w(_.value)+" active",1)])])]),t("div",D1,[t("div",M1,[t("div",O1,[z[3]||(z[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",L1,[t("span",{class:Q(S.value)},w(f.value),3)]),t("small",N1,w(C.value),1)])])])]),b.value?(i(),l("div",I1,[z[4]||(z[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:G}," ðŸ“Š View Timeline ")])])])):T("",!0),t("div",j1,[t("div",R1,[t("h5",P1,"ðŸŒ³ "+w(b.value?"Minion Hierarchy":"Sessions"),1),t("span",F1,w(k.value.length),1)]),t("div",B1,[y.value?(i(),l("div",W1,[...z[5]||(z[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(i(),l("div",V1,' No sessions yet. Click "Add Session" to create one. ')):(i(),l("div",H1,[t("div",U1,[t("div",q1,[t("div",z1,[z[6]||(z[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,w(u.value.name),1),t("span",K1,w(u.value.children.length)+" "+w(u.value.children.length===1?"minion":"minions"),1)]),t("div",G1,[u.value.last_comm?(i(),l("div",Y1,[t("span",J1,[z[7]||(z[7]=re(" â†’ ",-1)),t("strong",null,w(E(u.value.last_comm)),1),z[8]||(z[8]=re(": ",-1))]),t("span",{class:"comm-content",title:u.value.last_comm.content||""},w(P(u.value.last_comm)),9,Q1)])):(i(),l("div",X1," No communications yet "))])])]),t("div",Z1,[(i(!0),l(le,null,fe(u.value.children,Y=>(i(),Ee(Aa,{key:Y.id,"minion-data":Y,level:1,layout:"two-column",onMinionClick:B},null,8,["minion-data"]))),128))])]))])]),t("div",ew,[z[12]||(z[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",tw,[t("dl",sw,[z[9]||(z[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",nw,w($.value.working_directory),1),z[10]||(z[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",ow,w($.value.project_id),1),z[11]||(z[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",aw,w(b.value?"Yes (has minions)":"No"),1)])])])])):(i(),l("div",$1,[...z[1]||(z[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",iw,[z[13]||(z[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",lw,w(v.value)+" session"+w(v.value!==1?"s":""),1)])]))}},cw=oe(rw,[["__scopeId","data-v-168bf04c"]]),uw=[{path:"/",name:"home",component:Pa},{path:"/project/:projectId",name:"project",component:cw,props:!0},{path:"/session/:sessionId",name:"session",component:Hb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Iy,props:!0}],dw=Ma({history:Oa(),routes:uw}),mw={class:"connection-indicators"},fw=["title"],pw=["title"],vw={__name:"ConnectionIndicator",setup(n){const e=mt();function s(a){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:c,retryCount:d}=r[a];return d>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(a){const r={ui:"UI WebSocket",session:"Session WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming"},d={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:m,retryCount:p}=d[a];let u="Disconnected";return m?u="Connected":p>0&&(u=`Reconnecting (attempt ${p})`),`${r[a]}
${c[a]}
Status: ${u}`}return(a,r)=>(i(),l("div",mw,[t("div",{class:Q(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,fw),t("div",{class:Q(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,pw)]))}},hw=oe(vw,[["__scopeId","data-v-a2f53fbb"]]),gw={class:"d-flex align-items-center gap-2"},_w={__name:"AppHeader",setup(n){const e=xe();function s(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(a,r)=>(i(),l("header",{class:Q(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",ie(e).isRedBackground?"theme-red-header":"bg-white"])},[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...r[2]||(r[2]=[t("span",null,"â˜°",-1)])]),r[3]||(r[3]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",gw,[t("button",{class:Q(["btn btn-sm",ie(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:r[0]||(r[0]=c=>ie(e).toggleBackgroundColor())},[t("span",{class:"color-swatch",style:et({backgroundColor:ie(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),t("button",{class:Q(["btn btn-sm",ie(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Restart server",onClick:r[1]||(r[1]=c=>ie(e).showRestartModal())},[...r[4]||(r[4]=[t("span",null,"â†»",-1)])],2),ye(hw),t("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...r[5]||(r[5]=[t("span",null,"â–¤",-1)])])])],2))}},bw=oe(_w,[["__scopeId","data-v-680c42fe"]]),yw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},ww={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},$w=["title"],kw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function a(d){const m=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[m]||"#d3d3d3"}function r(d){const m=o(d);return m==="starting"||m==="processing"||m==="pending-prompt"}function c(d){const m=o(d),p=m.charAt(0).toUpperCase()+m.slice(1),u=d.name||"Unnamed Session",y=d.role?` (${d.role})`:"";return`${u}${y}: ${p}`}return(d,m)=>(i(),l("div",yw,[!n.sessions||n.sessions.length===0?(i(),l("div",ww)):(i(!0),l(le,{key:1},fe(n.sessions,p=>(i(),l("div",{key:p.session_id,class:Q(["progress-bar",{"progress-bar-striped progress-bar-animated":r(p)}]),style:et({width:s.value,backgroundColor:a(p),cursor:"help"}),title:c(p)},null,14,$w))),128))]))}},Sw=oe(kw,[["__scopeId","data-v-391d77c1"]]),Cw=["data-project-id"],xw=["id"],Ew=["aria-expanded","aria-controls","aria-label","onKeydown"],Tw=["aria-label","onKeydown"],Aw={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Dw={class:"fw-semibold",style:{"flex-shrink":"0"}},Mw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Ow={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Lw=["title"],Nw=["title"],Iw=["id","aria-labelledby"],jw={class:"accordion-body p-0"},Rw={class:"list-group list-group-flush"},Pw={class:"minion-hierarchy-container"},Fw={key:0,class:"text-center py-2"},Bw={key:2,class:"text-muted text-center py-2 small"},Ww={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Yt(),o=He(),a=_e(),r=xe(),c=R(e.project.is_expanded||!1),d=R(null),m=R(!1);let p=null;const u=g(()=>o.formatPath(e.project.working_directory)),y=g(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(N=>a.getSession(N)).filter(N=>N!=null)),h=g(()=>y.value.length>0),$=g(()=>{const N=s.currentRoute.value;return N.name==="timeline"&&N.params.legionId===e.project.project_id}),k=g(()=>{const N=s.currentRoute.value;return N.name==="project"&&N.params.projectId===e.project.project_id});function b(N){const W=window.bootstrap;if(!W)return;const z=document.getElementById(`collapse-${e.project.project_id}`);if(!z)return;W.Collapse.getOrCreateInstance(z).toggle(),c.value=!c.value}function v(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function _(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function f(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const N=a.currentSessionId;N&&a.getSession(N)&&e.project.session_ids?.includes(N)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function S(){r.showModal("edit-project",{project:e.project})}function C(){r.showModal("create-minion",{project:e.project})}function O(){s.push(`/timeline/${e.project.project_id}`)}async function x(){m.value=!0;try{const N=await we.get(`/api/legions/${e.project.project_id}/hierarchy`);d.value=N}catch(N){console.error("Failed to load minion hierarchy:",N),d.value=null}finally{m.value=!1}}function E(N){s.push(`/session/${N}`)}function P(N,W){if(N&&N.id===W)return N;if(N&&N.children)for(const z of N.children){const Y=P(z,W);if(Y)return Y}return null}be(c,N=>{N&&x()}),Te(()=>{p=be(()=>a.sessions,N=>{if(!(!d.value||!c.value)){for(const[W,z]of N)if(z.project_id===e.project.project_id){const Y=P(d.value,W);Y&&Y.type==="minion"&&(Y.state!==z.state&&(Y.state=z.state),Y.is_processing!==z.is_processing&&(Y.is_processing=z.is_processing),Y.latest_message!==z.latest_message&&(Y.latest_message=z.latest_message,Y.latest_message_type=z.latest_message_type,Y.latest_message_time=z.latest_message_time))}}},{deep:!0}),be(()=>a.sessions.size,(N,W)=>{if(c.value&&(N>W&&Array.from(a.sessions.values()).some(j=>j.project_id===e.project.project_id&&(!d.value||!P(d.value,j.session_id)))&&(console.log("New minion detected, reloading hierarchy"),x()),N<W&&d.value)){const z=a.sessions,Y=j=>j.type==="minion"&&!z.has(j.id)?!0:j.children?j.children.some(F=>Y(F)):!1;Y(d.value)&&(console.log("Minion deletion detected, reloading hierarchy"),x())}}),c.value&&x()}),Ae(()=>{p&&p()});function A(N){N.dataTransfer.effectAllowed="move",N.dataTransfer.setData("application/project-id",e.project.project_id),N.dataTransfer.setData("text/plain",e.project.project_id),N.target.classList.add("dragging")}function B(N){N.target.classList.remove("dragging")}function G(N){N.preventDefault(),N.dataTransfer.dropEffect="move";const W=N.currentTarget.getBoundingClientRect(),z=W.top+W.height/2;N.clientY<z?(N.currentTarget.classList.add("drop-above"),N.currentTarget.classList.remove("drop-below")):(N.currentTarget.classList.add("drop-below"),N.currentTarget.classList.remove("drop-above"))}function V(N){N.preventDefault(),N.currentTarget.classList.remove("drop-above","drop-below");const W=N.dataTransfer.getData("application/project-id")||N.dataTransfer.getData("text/plain");if(!W||W===e.project.project_id)return;const z=N.currentTarget.getBoundingClientRect(),Y=z.top+z.height/2,j=N.clientY<Y,F=o.orderedProjects,K=F.findIndex(H=>H.project_id===e.project.project_id),ee=F.findIndex(H=>H.project_id===W);if(K===-1||ee===-1)return;const se=[...F],[ne]=se.splice(ee,1);let ve=j?K:K+1;ee<K&&ve--,se.splice(ve,0,ne);const ae=se.map(H=>H.project_id);o.reorderProjects(ae)}return(N,W)=>(i(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:A,onDragend:B,onDragover:G,onDrop:V},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:Q(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":k.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:ge(b,["stop"]),onKeydown:[Ze(ge(b,["prevent"]),["enter"]),Ze(ge(b,["prevent"]),["space"])]},[(i(),l("svg",{class:Q(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...W[0]||(W[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,Ew),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:v,onKeydown:[Ze(ge(v,["prevent"]),["enter"]),Ze(ge(v,["prevent"]),["space"])]},[t("div",Aw,[t("div",Dw,[h.value?(i(),l("span",Mw,"ðŸ›")):T("",!0),re(" "+w(n.project.name),1)]),t("div",Ow,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ge(S,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:h.value?"Create minion":"Add session or minion",type:"button",onClick:ge(C,["stop"])}," âž• ",8,Lw)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},w(u.value),9,Nw)],40,Tw)],2)],8,xw),ye(Sw,{project:n.project,sessions:y.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:Q(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:_,onHidden:f},[t("div",jw,[t("div",Rw,[h.value?(i(),l("div",{key:0,class:Q(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:$.value}]),style:{cursor:"pointer"},onClick:O},[...W[1]||(W[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):T("",!0),t("div",Pw,[m.value?(i(),l("div",Fw,[...W[2]||(W[2]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value&&d.value.children&&d.value.children.length>0?(i(!0),l(le,{key:1},fe(d.value.children,z=>(i(),Ee(Aa,{key:z.id,"minion-data":z,level:0,layout:"sidebar",onMinionClick:E},null,8,["minion-data"]))),128)):(i(),l("div",Bw," No sessions "))])])])],42,Iw)],40,Cw))}},Vw=oe(Ww,[["__scopeId","data-v-a15b34e8"]]),Hw={class:"project-list"},Uw={key:0,class:"text-muted text-center py-3"},qw={__name:"ProjectList",setup(n){const e=He(),s=g(()=>e.orderedProjects);return(o,a)=>(i(),l("div",Hw,[s.value.length===0?(i(),l("div",Uw,' No projects yet. Click "New" to create one. ')):T("",!0),(i(!0),l(le,null,fe(s.value,r=>(i(),Ee(Vw,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},zw={class:"flex-grow-1 overflow-auto p-3"},Kw={id:"sessions-container"},Gw={__name:"Sidebar",setup(n){const e=xe(),s=g(()=>e.sidebarCollapsed),o=g(()=>e.isMobile),a=g(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function r(){e.showModal("create-project")}const c=R(!1);function d(u){c.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",p)}function m(u){c.value&&e.setSidebarWidth(u.clientX)}function p(){c.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",p)}return(u,y)=>(i(),l("aside",{id:"sidebar",class:Q(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value,"theme-red-panel":ie(e).isRedBackground,"bg-light":!ie(e).isRedBackground}]),style:et(a.value)},[t("div",zw,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[y[0]||(y[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),t("div",Kw,[ye(qw)])]),t("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},Yw=oe(Gw,[["__scopeId","data-v-d26424cf"]]),gn=at("diff",()=>{const n=R(new Map),e=R(!1),s=R(null),o=R("total"),a=R(!1),r=R(null),c=R(null),d=R(null),m=R(new Map),p=g(()=>{const P=_e();return P.currentSessionId&&n.value.get(P.currentSessionId)||null}),u=g(()=>!p.value||!p.value.files?[]:Object.entries(p.value.files).map(([P,A])=>({path:P,...A})).sort((P,A)=>P.path.localeCompare(A.path))),y=g(()=>u.value.length),h=g(()=>!p.value||!p.value.commits?0:p.value.commits.length),$=g(()=>p.value?.is_git_repo===!0),k=g(()=>{if(!r.value||!c.value)return null;const P=d.value||"committed",A=`${r.value}:${P}:${c.value}`;return m.value.get(A)||null});async function b(P){if(P){e.value=!0,s.value=null;try{const A=await Gt(`/api/sessions/${P}/diff`);n.value.set(P,A),n.value=new Map(n.value)}catch(A){console.error(`Failed to load diff for session ${P}:`,A),s.value=A.message}finally{e.value=!1}}}async function v(P){for(const A of m.value.keys())A.startsWith(`${P}:`)&&m.value.delete(A);m.value=new Map(m.value),await b(P)}async function _(P,A,B=null){if(!P||!A)return;const V=`${P}:${B||"committed"}:${A}`,N=m.value.get(V);if(!(N&&!N.error&&N.content!==null)){m.value.set(V,{content:null,loading:!0,error:null}),m.value=new Map(m.value);try{const W={path:A};B&&(W.ref=B);const z=await Gt(`/api/sessions/${P}/diff/file`,{params:W});m.value.set(V,{content:z.diff,loading:!1,error:null})}catch(W){console.error(`Failed to load file diff for ${A}:`,W),m.value.set(V,{content:null,loading:!1,error:W.message})}m.value=new Map(m.value)}}function f(P,A,B=null){r.value=P,c.value=A,d.value=B,a.value=!0,_(P,A,B)}function S(){a.value=!1,d.value=null}function C(){if(!r.value)return;const P=u.value;if(P.length===0)return;const B=(P.findIndex(G=>G.path===c.value)+1)%P.length;c.value=P[B].path,_(r.value,c.value,d.value)}function O(){if(!r.value)return;const P=u.value;if(P.length===0)return;const B=(P.findIndex(G=>G.path===c.value)-1+P.length)%P.length;c.value=P[B].path,_(r.value,c.value,d.value)}function x(P){o.value=P}function E(P){n.value.delete(P),n.value=new Map(n.value);for(const A of m.value.keys())A.startsWith(`${P}:`)&&m.value.delete(A);m.value=new Map(m.value),r.value===P&&S()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:a,fullViewSessionId:r,currentFilePath:c,fullViewRef:d,fileDiffCache:m,currentDiff:p,currentFiles:u,fileCount:y,commitCount:h,isGitRepo:$,currentFullViewFileDiff:k,loadDiff:b,refreshDiff:v,loadFileDiff:_,openFullView:f,closeFullView:S,nextFile:C,prevFile:O,setMode:x,clearDiff:E}}),Jw={class:"task-row d-flex align-items-center gap-2"},Qw={key:0,class:"status-icon"},Xw={key:1,class:"status-icon"},Zw=["title"],e$={key:0,class:"task-details"},t$={key:0,class:"task-description mb-2"},s$={class:"description-content"},n$={key:1,class:"task-owner mb-2"},o$={class:"ms-1"},a$={key:2,class:"task-blocked-by mb-2"},i$={key:3,class:"task-blocks"},l$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=g(()=>e.task.status==="in_progress"),o=g(()=>e.task.status==="completed"?"âœ…":"â³"),a=g(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=g(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,d)=>(i(),l("div",{class:Q(["task-item",r.value]),onClick:d[0]||(d[0]=m=>c.$emit("toggle"))},[t("div",Jw,[s.value?(i(),l("span",Qw,[...d[1]||(d[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),l("span",Xw,w(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},w(a.value),9,Zw),(i(),l("svg",{class:Q(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),l("div",e$,[n.task.description?(i(),l("div",t$,[d[3]||(d[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",s$,w(n.task.description),1)])):T("",!0),n.task.owner?(i(),l("div",n$,[d[4]||(d[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",o$,w(n.task.owner),1)])):T("",!0),n.task.blockedBy?.length>0?(i(),l("div",a$,[d[5]||(d[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),l(le,null,fe(n.task.blockedBy,m=>(i(),l("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+w(m),1))),128))])):T("",!0),n.task.blocks?.length>0?(i(),l("div",i$,[d[6]||(d[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),l(le,null,fe(n.task.blocks,m=>(i(),l("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+w(m),1))),128))])):T("",!0)])):T("",!0)],2))}},r$=oe(l$,[["__scopeId","data-v-0f96ae87"]]),c$={class:"task-list-panel"},u$={class:"task-list p-2"},d$={key:0,class:"text-muted text-center py-4"},m$={__name:"TaskListPanel",setup(n){const e=Mt(),s=R(new Set),o=g(()=>e.currentTasks);function a(r){s.value.has(r)?s.value.delete(r):s.value.add(r),s.value=new Set(s.value)}return(r,c)=>(i(),l("div",c$,[t("div",u$,[o.value.length===0?(i(),l("div",d$,[...c[0]||(c[0]=[t("span",{class:"empty-icon"},"ðŸ“",-1),t("p",{class:"mb-0 small"},"No tasks yet",-1)])])):T("",!0),ye(La,{name:"task-list",tag:"div"},{default:tn(()=>[(i(!0),l(le,null,fe(o.value,d=>(i(),Ee(r$,{key:d.id,task:d,isExpanded:s.value.has(d.id),onToggle:m=>a(d.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},f$=oe(m$,[["__scopeId","data-v-e1fa565a"]]),p$={class:"resource-gallery-panel"},v$={class:"resource-grid-container p-2"},h$={key:0,class:"text-muted text-center py-4"},g$={key:1,class:"resource-grid"},_$=["onClick"],b$=["onClick","title"],y$=["src","alt"],w$=["title","onClick"],$$={class:"file-icon"},k$={class:"file-ext"},S$={class:"resource-info"},C$=["title"],x$={class:"resource-actions"},E$=["onClick"],T$=["href","download"],A$={__name:"ResourceGallery",setup(n){const e=Ge(),s=_e(),o=_o("addAttachmentFromResource",null),a=g(()=>e.currentResources);function r(b){return e.isImageResource(b)}function c(b){return e.getResourceIcon(b)}function d(b){const v=e.getResourceExtension(b);return v?v.toUpperCase().slice(1):""}function m(b){return e.getResourceUrl(s.currentSessionId,b)}function p(b){return e.getDownloadUrl(s.currentSessionId,b)}function u(b){e.openFullView(s.currentSessionId,b)}function y(b,v=18){return b?b.length<=v?b:b.substring(0,v-3)+"...":""}function h(b){b.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function $(b){e.removeResource(s.currentSessionId,b)}function k(b){o?o(b):console.warn("addAttachmentFromResource not provided")}return(b,v)=>(i(),l("div",p$,[t("div",v$,[a.value.length===0?(i(),l("div",h$,[...v[1]||(v[1]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No resources yet",-1)])])):(i(),l("div",g$,[(i(!0),l(le,null,fe(a.value,(_,f)=>(i(),l("div",{key:_.resource_id,class:Q(["resource-item",{"is-image":r(_)}])},[t("button",{class:"remove-btn",onClick:ge(S=>$(_.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...v[2]||(v[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,_$),r(_)?(i(),l("div",{key:0,class:"resource-thumbnail",onClick:S=>u(f),title:_.title||"Click to view"},[t("img",{src:m(_.resource_id),alt:_.title||"Image",loading:"lazy",onError:h},null,40,y$)],8,b$)):(i(),l("div",{key:1,class:"resource-placeholder",title:_.title||_.original_filename||"Click to view",onClick:S=>u(f)},[t("span",$$,w(c(_)),1),t("span",k$,w(d(_)),1)],8,w$)),t("div",S$,[t("div",{class:"resource-title",title:_.title||_.original_filename},w(y(_.title||_.original_filename)),9,C$),t("div",x$,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ge(S=>k(_),["stop"]),title:"Add to message attachments"},[...v[3]||(v[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,E$),t("a",{href:p(_.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:_.original_filename||_.title||"download",title:"Download",onClick:v[0]||(v[0]=ge(()=>{},["stop"]))},[...v[4]||(v[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,T$)])])],2))),128))]))])]))}},D$=oe(A$,[["__scopeId","data-v-93315470"]]),M$=["src","alt"],O$={key:1,class:"resource-info"},L$={key:0,class:"resource-title"},N$={key:1,class:"resource-description"},I$={class:"resource-meta"},j$={class:"meta-item"},R$={class:"meta-item"},P$={class:"meta-item"},F$={class:"text-header"},B$={class:"text-header-info"},W$={class:"text-filename"},V$={class:"resource-meta"},H$={key:0,class:"meta-item"},U$={key:1,class:"meta-item"},q$={key:0,class:"display-mode-toggle"},z$=["title","disabled"],K$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},G$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Y$={class:"copy-label"},J$={class:"text-body"},Q$={key:0,class:"text-loading"},X$={key:1,class:"text-error"},Z$={key:2,class:"text-content"},ek=["innerHTML"],tk={key:4,class:"text-unavailable"},sk={key:4,class:"position-indicator"},nk={key:5,class:"thumbnail-strip"},ok=["onClick"],ak=["src","alt"],ik={key:1,class:"strip-text-icon"},lk={__name:"ResourceFullView",setup(n){nt.setOptions({breaks:!0,gfm:!0});const e=Ge(),s=R(null),o=R(!1),a=R("raw");let r=null;const c=g(()=>e.fullViewOpen),d=g(()=>e.currentFullViewResource),m=g(()=>e.currentResourceIndex),p=g(()=>e.fullViewTotalResources),u=g(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),y=g(()=>e.isImageResource(d.value)),h=g(()=>d.value?e.getTextContent(d.value.resource_id):null),$=g(()=>h.value?.content||null),k=g(()=>h.value?.loading||!1),b=g(()=>h.value?.error||null),v=g(()=>{if(!$.value)return"";let V=nt.parse($.value);return V=V.replace(/\n</g,"<"),V=V.replace(/\n+$/,""),Jt.sanitize(V)});be(c,V=>{V?(rt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),be(m,()=>{a.value="raw"}),be([m,c],()=>{if(c.value&&d.value&&!y.value){const V=d.value.resource_id,N=e.getTextContent(V);(!N||N.error)&&e.fetchTextContent(e.fullViewSessionId,V)}},{immediate:!0}),Ae(()=>{document.body.style.overflow="",r&&clearTimeout(r)});function _(V){return e.getResourceUrl(e.fullViewSessionId,V)}function f(){e.closeFullView()}function S(){e.nextResource()}function C(){e.prevResource()}function O(V){e.goToResource(V)}function x(V){V.target===V.currentTarget&&f()}function E(V){switch(V.key){case"Escape":f();break;case"ArrowLeft":C();break;case"ArrowRight":S();break;case"Home":O(0);break;case"End":O(p.value-1);break;case"m":!y.value&&$.value&&(a.value=a.value==="raw"?"markdown":"raw");break}}async function P(){if($.value)try{await navigator.clipboard.writeText($.value),o.value=!0,r&&clearTimeout(r),r=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function A(V){return V?V<1024?`${V} B`:V<1024*1024?`${(V/1024).toFixed(1)} KB`:`${(V/(1024*1024)).toFixed(2)} MB`:""}function B(V){return V?new Date(V*1e3).toLocaleString():""}function G(V){V.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(V,N)=>(i(),Ee(wo,{to:"body"},[ye(yo,{name:"modal"},{default:tn(()=>[c.value?(i(),l("div",{key:0,class:"resource-full-view-overlay",onClick:x,onKeydown:E,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ge(f,["stop"]),title:"Close (Escape)"},[...N[4]||(N[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:ge(C,["stop"]),title:"Previous (Left Arrow)"},[...N[5]||(N[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):T("",!0),y.value?(i(),l("div",{key:1,class:"image-container",onClick:N[0]||(N[0]=ge(()=>{},["stop"]))},[d.value?(i(),l("img",{key:0,src:_(d.value.resource_id||d.value.image_id),alt:d.value.title||"Image",class:"full-image",onError:G},null,40,M$)):T("",!0),d.value?(i(),l("div",O$,[d.value.title?(i(),l("h5",L$,w(d.value.title),1)):T("",!0),d.value.description?(i(),l("p",N$,w(d.value.description),1)):T("",!0),t("div",I$,[t("span",j$,w(A(d.value.size_bytes)),1),t("span",R$,w(d.value.format?.toUpperCase()),1),t("span",P$,w(B(d.value.timestamp)),1)])])):T("",!0)])):(i(),l("div",{key:2,class:"text-container",onClick:N[3]||(N[3]=ge(()=>{},["stop"]))},[t("div",F$,[t("div",B$,[t("h5",W$,w(d.value?.title||d.value?.original_filename||"Text Resource"),1),t("div",V$,[d.value?.size_bytes?(i(),l("span",H$,w(A(d.value.size_bytes)),1)):T("",!0),d.value?.format?(i(),l("span",U$,w(d.value.format.toUpperCase()),1)):T("",!0)])]),$.value?(i(),l("div",q$,[t("button",{class:Q(["toggle-btn",{active:a.value==="raw"}]),onClick:N[1]||(N[1]=ge(W=>a.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:Q(["toggle-btn",{active:a.value==="markdown"}]),onClick:N[2]||(N[2]=ge(W=>a.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):T("",!0),t("button",{class:"copy-btn",onClick:ge(P,["stop"]),title:o.value?"Copied!":a.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!$.value},[o.value?(i(),l("svg",K$,[...N[6]||(N[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",G$,[...N[7]||(N[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Y$,w(o.value?"Copied!":a.value==="markdown"?"Copy raw":"Copy"),1)],8,z$)]),t("div",J$,[k.value?(i(),l("div",Q$,[...N[8]||(N[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):b.value?(i(),l("div",X$," Failed to load content: "+w(b.value),1)):$.value&&a.value==="raw"?(i(),l("pre",Z$,w($.value),1)):$.value&&a.value==="markdown"?(i(),l("div",{key:3,class:"markdown-content",innerHTML:v.value},null,8,ek)):(i(),l("div",tk," Preview not available for this file type. "))])])),p.value>1?(i(),l("button",{key:3,class:"nav-btn nav-next",onClick:ge(S,["stop"]),title:"Next (Right Arrow)"},[...N[9]||(N[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):T("",!0),p.value>1?(i(),l("div",sk,w(m.value+1)+" / "+w(p.value),1)):T("",!0),p.value>1?(i(),l("div",nk,[(i(!0),l(le,null,fe(u.value,(W,z)=>(i(),l("div",{key:W.resource_id||W.image_id,class:Q(["strip-thumbnail",{active:z===m.value,"is-text":!ie(e).isImageResource(W)}]),onClick:ge(Y=>O(z),["stop"])},[ie(e).isImageResource(W)?(i(),l("img",{key:0,src:_(W.resource_id||W.image_id),alt:W.title||"Thumbnail",loading:"lazy"},null,8,ak)):(i(),l("span",ik,w(ie(e).getResourceIcon(W)),1))],10,ok))),128))])):T("",!0)],544)):T("",!0)]),_:1})]))}},rk=oe(lk,[["__scopeId","data-v-169421b1"]]),ck={class:"diff-panel"},uk={class:"diff-body"},dk={key:0,class:"text-center py-4"},mk={key:1,class:"text-muted text-center py-4"},fk={key:2,class:"text-muted text-center py-4"},pk={class:"mb-0 small"},vk={key:3,class:"text-danger text-center py-4"},hk={class:"mb-0 small"},gk={key:4,class:"text-muted text-center py-4"},_k={key:5},bk={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},yk=["disabled"],wk={class:"stats-bar px-3 py-1 border-bottom small text-muted"},$k={class:"text-success"},kk={class:"text-danger"},Sk={class:"ms-2"},Ck={key:0,class:"ms-2"},xk={key:0,class:"file-list"},Ek=["onClick"],Tk=["title"],Ak={key:0,class:"file-stats small text-nowrap"},Dk={key:0,class:"text-success"},Mk={key:1,class:"text-muted"},Ok={key:2,class:"text-danger"},Lk={key:1,class:"file-stats small text-muted"},Nk={key:1,class:"commit-list"},Ik=["onClick"],jk={key:0,class:"wip-badge"},Rk={key:1,class:"commit-hash"},Pk=["title"],Fk={key:2,class:"commit-date small text-muted text-nowrap"},Bk={key:0,class:"commit-files"},Wk=["onClick"],Vk=["title"],Hk={key:6,class:"text-muted text-center py-4"},Uk={__name:"DiffPanel",setup(n){const e=gn(),s=_e(),o=R(new Set);function a(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function r(u,y=null){s.currentSessionId&&e.openFullView(s.currentSessionId,u,y)}function c(u){o.value.has(u)?o.value.delete(u):o.value.add(u),o.value=new Set(o.value)}function d(u){switch(u){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function m(u){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[u]?.status||"modified"}function p(u){if(!u)return"";const y=new Date(u),$=new Date-y,k=Math.floor($/6e4);if(k<1)return"just now";if(k<60)return`${k}m ago`;const b=Math.floor(k/60);return b<24?`${b}h ago`:`${Math.floor(b/24)}d ago`}return be(()=>s.currentSessionId,u=>{u&&!e.diffBySession.get(u)&&e.loadDiff(u)},{immediate:!0}),be(()=>e.currentDiff,u=>{if(u?.commits){const y=u.commits.find(h=>h.is_uncommitted);y&&(o.value.add(y.hash),o.value=new Set(o.value))}},{immediate:!0}),(u,y)=>(i(),l("div",ck,[t("div",uk,[ie(e).loading&&!ie(e).currentDiff?(i(),l("div",dk,[...y[2]||(y[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):ie(e).currentDiff&&!ie(e).isGitRepo?(i(),l("div",mk,[...y[3]||(y[3]=[t("p",{class:"mb-0 small"},"Not a git repository",-1)])])):ie(e).currentDiff&&ie(e).currentDiff.error?(i(),l("div",fk,[t("p",pk,w(ie(e).currentDiff.error),1)])):ie(e).error?(i(),l("div",vk,[t("p",hk,w(ie(e).error),1)])):ie(e).currentDiff&&ie(e).fileCount===0?(i(),l("div",gk,[...y[4]||(y[4]=[t("p",{class:"mb-0 small"},"No changes since main",-1)])])):ie(e).currentDiff&&ie(e).fileCount>0?(i(),l("div",_k,[t("div",bk,[t("button",{class:Q(["btn btn-sm",ie(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:y[0]||(y[0]=h=>ie(e).setMode("total"))}," Total Changes ",2),t("button",{class:Q(["btn btn-sm",ie(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:y[1]||(y[1]=h=>ie(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:a,title:"Refresh diff",disabled:ie(e).loading},[(i(),l("svg",{class:Q({spin:ie(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...y[5]||(y[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,yk)]),t("div",wk,[t("span",$k,"+"+w(ie(e).currentDiff.total_insertions),1),y[6]||(y[6]=t("span",{class:"mx-1"},"/",-1)),t("span",kk,"-"+w(ie(e).currentDiff.total_deletions),1),t("span",Sk,w(ie(e).fileCount)+" file"+w(ie(e).fileCount!==1?"s":""),1),ie(e).commitCount>0?(i(),l("span",Ck,w(ie(e).commitCount)+" commit"+w(ie(e).commitCount!==1?"s":""),1)):T("",!0)]),ie(e).currentMode==="total"?(i(),l("div",xk,[(i(!0),l(le,null,fe(ie(e).currentFiles,h=>(i(),l("div",{key:h.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:$=>r(h.path,"uncommitted")},[t("span",{class:Q(["status-icon","status-"+h.status])},w(d(h.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:h.path},w(h.path),9,Tk),h.is_binary?(i(),l("span",Lk,"binary")):(i(),l("span",Ak,[h.insertions>0?(i(),l("span",Dk,"+"+w(h.insertions),1)):T("",!0),h.insertions>0&&h.deletions>0?(i(),l("span",Mk,"/")):T("",!0),h.deletions>0?(i(),l("span",Ok,"-"+w(h.deletions),1)):T("",!0)]))],8,Ek))),128))])):(i(),l("div",Nk,[(i(!0),l(le,null,fe(ie(e).currentDiff.commits,h=>(i(),l("div",{key:h.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:$=>c(h.hash)},[(i(),l("svg",{class:Q(["chevron-icon",{expanded:o.value.has(h.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...y[7]||(y[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),h.is_uncommitted?(i(),l("span",jk,"WIP")):(i(),l("code",Rk,w(h.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:h.message},w(h.message),9,Pk),h.is_uncommitted?T("",!0):(i(),l("span",Fk,w(p(h.date)),1))],8,Ik),o.value.has(h.hash)?(i(),l("div",Bk,[(i(!0),l(le,null,fe(h.files,$=>(i(),l("div",{key:$,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:k=>r($,h.is_uncommitted?"uncommitted":null)},[t("span",{class:Q(["status-icon","status-"+m($)])},w(d(m($))),3),t("span",{class:"file-path text-truncate small",title:$},w($),9,Vk)],8,Wk))),128))])):T("",!0)]))),128))]))])):(i(),l("div",Hk,[...y[8]||(y[8]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No diff data",-1)])]))])]))}},qk=oe(Uk,[["__scopeId","data-v-36a8a764"]]),zk={class:"diff-header"},Kk={class:"diff-header-info"},Gk={class:"diff-filename"},Yk={class:"diff-meta"},Jk={key:1,class:"meta-item"},Qk={class:"text-success"},Xk={class:"text-danger"},Zk=["title","disabled"],eS={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},tS={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},sS={class:"copy-label"},nS={class:"diff-body"},oS={key:0,class:"diff-loading"},aS={key:1,class:"diff-error"},iS={key:2,class:"diff-content"},lS={class:"diff-table"},rS={class:"line-num line-num-old"},cS={class:"line-num line-num-new"},uS={class:"line-content"},dS={class:"line-prefix"},mS={key:3,class:"diff-empty"},fS={key:2,class:"position-indicator"},pS={__name:"DiffFullView",setup(n){const e=gn(),s=R(null),o=R(!1);let a=null;const r=g(()=>e.fullViewOpen),c=g(()=>e.currentFullViewFileDiff),d=g(()=>c.value?.content||null),m=g(()=>e.currentFiles.length),p=g(()=>e.currentFilePath?e.currentFiles.findIndex(_=>_.path===e.currentFilePath):0),u=g(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),y=g(()=>{if(!d.value)return[];const _=d.value.split(`
`),f=[];let S=0,C=0;for(const O of _){if(O.startsWith("diff --git")||O.startsWith("index ")||O.startsWith("---")||O.startsWith("+++")||O.startsWith("new file")||O.startsWith("deleted file")||O.startsWith("similarity")||O.startsWith("rename")||O.startsWith("Binary")){O.startsWith("Binary")&&f.push({type:"info",prefix:"",text:O,oldNum:null,newNum:null});continue}if(O.startsWith("@@")){const x=O.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);x&&(S=parseInt(x[1]),C=parseInt(x[2]),f.push({type:"hunk",prefix:"",text:O,oldNum:null,newNum:null}));continue}O.startsWith(" ")||O.length>0&&!O.startsWith("+")&&!O.startsWith("-")&&!O.startsWith("\\")?(f.push({type:"context",prefix:" ",text:O.substring(1),oldNum:S,newNum:C}),S++,C++):O.startsWith("+")?(f.push({type:"add",prefix:"+",text:O.substring(1),oldNum:null,newNum:C}),C++):O.startsWith("-")?(f.push({type:"remove",prefix:"-",text:O.substring(1),oldNum:S,newNum:null}),S++):O.startsWith("\\")&&f.push({type:"info",prefix:"",text:O,oldNum:null,newNum:null})}return f});function h(_){return`diff-line diff-line-${_.type}`}function $(){e.closeFullView()}function k(_){_.target===_.currentTarget&&$()}function b(_){switch(_.key){case"Escape":$();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function v(){if(d.value)try{await navigator.clipboard.writeText(d.value),o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return be(r,_=>{_?(rt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Ae(()=>{document.body.style.overflow="",a&&clearTimeout(a)}),(_,f)=>(i(),Ee(wo,{to:"body"},[ye(yo,{name:"modal"},{default:tn(()=>[r.value?(i(),l("div",{key:0,class:"diff-full-view-overlay",onClick:k,onKeydown:b,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ge($,["stop"]),title:"Close (Escape)"},[...f[3]||(f[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:f[0]||(f[0]=ge(S=>ie(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...f[4]||(f[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):T("",!0),t("div",{class:"diff-container",onClick:f[1]||(f[1]=ge(()=>{},["stop"]))},[t("div",zk,[t("div",Kk,[t("h5",Gk,w(ie(e).currentFilePath),1),t("div",Yk,[u.value?(i(),l("span",{key:0,class:Q(["meta-badge","status-"+u.value.status])},w(u.value.status),3)):T("",!0),u.value&&!u.value.is_binary?(i(),l("span",Jk,[t("span",Qk,"+"+w(u.value.insertions),1),f[5]||(f[5]=re(" / ",-1)),t("span",Xk,"-"+w(u.value.deletions),1)])):T("",!0)])]),t("button",{class:"copy-btn",onClick:ge(v,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!d.value},[o.value?(i(),l("svg",eS,[...f[6]||(f[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",tS,[...f[7]||(f[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",sS,w(o.value?"Copied!":"Copy"),1)],8,Zk)]),t("div",nS,[c.value&&c.value.loading?(i(),l("div",oS,[...f[8]||(f[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):c.value&&c.value.error?(i(),l("div",aS," Failed to load diff: "+w(c.value.error),1)):d.value?(i(),l("div",iS,[t("table",lS,[t("tbody",null,[(i(!0),l(le,null,fe(y.value,(S,C)=>(i(),l("tr",{key:C,class:Q(h(S))},[t("td",rS,w(S.oldNum||""),1),t("td",cS,w(S.newNum||""),1),t("td",uS,[t("span",dS,w(S.prefix),1),t("span",null,w(S.text),1)])],2))),128))])])])):(i(),l("div",mS," No diff available for this file. "))])]),m.value>1?(i(),l("button",{key:1,class:"nav-btn nav-next",onClick:f[2]||(f[2]=ge(S=>ie(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...f[9]||(f[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):T("",!0),m.value>1?(i(),l("div",fS,w(p.value+1)+" / "+w(m.value),1)):T("",!0)],544)):T("",!0)]),_:1})]))}},vS=oe(pS,[["__scopeId","data-v-d13809ae"]]),hS={class:"nav nav-tabs sidebar-tabs",role:"tablist"},gS={class:"nav-item",role:"presentation"},_S={key:0,class:"tab-badge"},bS={class:"nav-item",role:"presentation"},yS={key:0,class:"tab-badge"},wS={class:"nav-item",role:"presentation"},$S={key:0,class:"tab-badge"},kS={class:"tab-content-container"},SS={__name:"RightSidebar",setup(n){const e=xe(),s=Mt(),o=Ge(),a=gn(),r=g(()=>e.rightSidebarCollapsed),c=g(()=>e.isMobile),d=g(()=>e.rightSidebarActiveTab),m=g(()=>s.currentTaskStats),p=g(()=>o.currentResourceCount),u=g(()=>a.fileCount),y=g(()=>{if(c.value)return{};const v=`${e.rightSidebarWidth}px`;return{width:v,minWidth:"200px",maxWidth:"30vw","--sidebar-width":v}}),h=R(!1);function $(v){v.preventDefault(),h.value=!0,document.addEventListener("mousemove",k),document.addEventListener("mouseup",b)}function k(v){if(h.value){const _=window.innerWidth-v.clientX;e.setRightSidebarWidth(_)}}function b(){h.value=!1,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",b)}return(v,_)=>(i(),l("aside",{id:"right-sidebar",class:Q(["border-start d-flex flex-column overflow-auto",{collapsed:r.value,"mobile-open":!r.value&&c.value,resizing:h.value,"theme-red-panel":ie(e).isRedBackground,"bg-light":!ie(e).isRedBackground}]),style:et(y.value)},[t("ul",hS,[t("li",gS,[t("button",{class:Q(["nav-link",{active:d.value==="tasks"}]),type:"button",onClick:_[0]||(_[0]=f=>ie(e).setRightSidebarTab("tasks"))},[_[3]||(_[3]=re(" Tasks ",-1)),m.value.total>0?(i(),l("span",_S,w(m.value.completed)+"/"+w(m.value.total),1)):T("",!0)],2)]),t("li",bS,[t("button",{class:Q(["nav-link",{active:d.value==="diff"}]),type:"button",onClick:_[1]||(_[1]=f=>ie(e).setRightSidebarTab("diff"))},[_[4]||(_[4]=re(" Diff ",-1)),u.value>0?(i(),l("span",yS,w(u.value),1)):T("",!0)],2)]),t("li",wS,[t("button",{class:Q(["nav-link",{active:d.value==="resources"}]),type:"button",onClick:_[2]||(_[2]=f=>ie(e).setRightSidebarTab("resources"))},[_[5]||(_[5]=re(" Resources ",-1)),p.value>0?(i(),l("span",$S,w(p.value),1)):T("",!0)],2)])]),t("div",kS,[Ce(ye(f$,null,null,512),[[ht,d.value==="tasks"]]),Ce(ye(qk,null,null,512),[[ht,d.value==="diff"]]),Ce(ye(D$,null,null,512),[[ht,d.value==="resources"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:$},null,32),ye(rk),ye(vS)],6))}},CS=oe(SS,[["__scopeId","data-v-9a5f3d6b"]]),xS={class:"modal-dialog modal-lg"},ES={class:"modal-content"},TS={class:"modal-body"},AS={class:"mb-3"},DS={class:"input-group"},MS=["disabled"],OS={key:0,class:"text-center py-4"},LS={key:1,class:"alert alert-danger",role:"alert"},NS={key:2,class:"folder-list"},IS=["onClick","onDblclick"],jS={class:"d-flex align-items-center flex-grow-1"},RS=["onClick"],PS={key:1,class:"text-center text-muted py-3"},FS={class:"modal-footer"},BS=["disabled"],WS={__name:"FolderBrowserModal",setup(n){const e=xe(),s=R(""),o=R(""),a=R([]),r=R(!1),c=R(""),d=R(null);let m=null,p=null;const u=g(()=>{if(!s.value)return null;const S=s.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?"/"+S.join("/"):"/")});function y(S){if(!S)return"";const C=S.split(/[\\/]/).filter(Boolean);return C.length<=2?S:".../"+C.slice(-2).join("/")}async function h(){r.value=!0,c.value="",a.value=[],o.value="";try{const S=s.value?{path:s.value}:{},C=await we.get("/api/filesystem/browse",{params:S});C.current_path&&(s.value=C.current_path),a.value=C.directories||[]}catch(S){console.error("Failed to load directory:",S),c.value=S.message||"Failed to load directory"}finally{r.value=!1}}function $(S){o.value=S.path}function k(S){s.value=S.path,o.value="",h()}function b(){u.value&&(s.value=u.value,o.value="",h())}function v(){const S=o.value||s.value;S&&p&&p(S),m&&m.hide()}function _(){h()}function f(){a.value=[],o.value="",c.value="",p=null,e.hideModal()}return be(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&m){const C=S.data||{};s.value=C.defaultPath||C.currentPath||"",p=C.onSelect||null,m.show()}}),Te(()=>{d.value&&Le(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{m=new S(d.value),d.value.addEventListener("shown.bs.modal",_),d.value.addEventListener("hidden.bs.modal",f)})}),Ae(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",_),d.value.removeEventListener("hidden.bs.modal",f)),m&&m.dispose()}),(S,C)=>(i(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",xS,[t("div",ES,[C[6]||(C[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",TS,[t("div",AS,[C[1]||(C[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",DS,[Ce(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=O=>s.value=O),onKeyup:Ze(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[qe,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:r.value}," ðŸ”„ Refresh ",8,MS)])]),r.value?(i(),l("div",OS,[...C[2]||(C[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(i(),l("div",LS,w(c.value),1)):(i(),l("div",NS,[u.value?(i(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...C[3]||(C[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):T("",!0),(i(!0),l(le,null,fe(a.value,O=>(i(),l("div",{key:O.path,class:Q(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:O.path===o.value}]),onClick:x=>$(O),onDblclick:x=>k(O),role:"button"},[t("div",jS,[C[4]||(C[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,w(O.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ge(x=>k(O),["stop"])}," Open ",8,RS)],42,IS))),128)),a.value.length===0?(i(),l("div",PS," No subdirectories found ")):T("",!0)]))]),t("div",FS,[C[5]||(C[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:!o.value},' Select "'+w(y(o.value||s.value))+'" ',9,BS)])])])],512))}},VS=oe(WS,[["__scopeId","data-v-0d61ed46"]]),HS={class:"modal-dialog"},US={class:"modal-content"},qS={class:"modal-body"},zS={class:"mb-3"},KS={key:0,class:"invalid-feedback"},GS={class:"mb-3"},YS={class:"input-group"},JS={key:0,class:"invalid-feedback"},QS={class:"mb-3 form-check"},XS={key:0,class:"mb-3 ms-4"},ZS={key:1,class:"alert alert-danger",role:"alert"},e0={class:"modal-footer"},t0=["disabled"],s0={key:0,class:"spinner-border spinner-border-sm me-2"},n0={__name:"ProjectCreateModal",setup(n){const e=He(),s=_e(),o=xe(),a=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=R({name:"",workingDirectory:""}),c=R(!1),d=R(""),m=R(null);let p=null;function u(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:v=>{a.value.workingDirectory=v,r.value.workingDirectory=""}})}function y(){r.value={};let v=!0;return a.value.name.trim()||(r.value.name="Project name is required",v=!1),a.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",v=!1),v}async function h(){if(y()){c.value=!0,d.value="";try{const v=await e.createProject(a.value.name,a.value.workingDirectory);a.value.createSession&&await s.createSession(v.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),$()}catch(v){console.error("Failed to create project:",v),d.value=v.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function $(){a.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},d.value=""}function k(){const v=document.getElementById("projectName");v&&v.focus()}function b(){$(),o.hideModal()}return be(()=>o.currentModal,v=>{v?.name==="create-project"&&p&&p.show()}),Te(()=>{m.value&&Le(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{p=new v(m.value),m.value.addEventListener("shown.bs.modal",k),m.value.addEventListener("hidden.bs.modal",b)})}),Ae(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",k),m.value.removeEventListener("hidden.bs.modal",b)),p&&p.dispose()}),(v,_)=>(i(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",HS,[t("div",US,[_[11]||(_[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",qS,[t("form",{onSubmit:ge(h,["prevent"])},[t("div",zS,[_[4]||(_[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),Ce(t("input",{type:"text",class:Q(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":_[0]||(_[0]=f=>a.value.name=f),placeholder:"My Project",required:""},null,2),[[qe,a.value.name]]),r.value.name?(i(),l("div",KS,w(r.value.name),1)):T("",!0)]),t("div",GS,[_[5]||(_[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",YS,[Ce(t("input",{type:"text",class:Q(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":_[1]||(_[1]=f=>a.value.workingDirectory=f),placeholder:"/path/to/project",required:""},null,2),[[qe,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),r.value.workingDirectory?(i(),l("div",JS,w(r.value.workingDirectory),1)):T("",!0)]),_[6]||(_[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",QS,[Ce(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":_[2]||(_[2]=f=>a.value.createSession=f)},null,512),[[go,a.value.createSession]]),_[7]||(_[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),_[8]||(_[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),a.value.createSession?(i(),l("div",XS,[_[9]||(_[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),Ce(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":_[3]||(_[3]=f=>a.value.sessionName=f),placeholder:"main"},null,512),[[qe,a.value.sessionName]])])):T("",!0),d.value?(i(),l("div",ZS,w(d.value),1)):T("",!0)],32)]),t("div",e0,[_[10]||(_[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:c.value},[c.value?(i(),l("span",s0)):T("",!0),re(" "+w(c.value?"Creating...":"Create Project"),1)],8,t0)])])])],512))}},o0=oe(n0,[["__scopeId","data-v-ea55fdae"]]),a0={class:"modal-dialog"},i0={class:"modal-content"},l0={class:"modal-body"},r0={class:"mb-3"},c0={key:0,class:"invalid-feedback"},u0={class:"mb-3"},d0=["value"],m0={key:0,class:"alert alert-danger",role:"alert"},f0={class:"danger-zone"},p0={class:"text-muted small"},v0=["disabled"],h0={key:0,class:"alert alert-warning mt-3",role:"alert"},g0={class:"mb-2"},_0={class:"d-flex gap-2"},b0=["disabled"],y0={key:0,class:"spinner-border spinner-border-sm me-2"},w0=["disabled"],$0={class:"modal-footer"},k0=["disabled"],S0={key:0,class:"spinner-border spinner-border-sm me-2"},C0={__name:"ProjectEditModal",setup(n){const e=He(),s=xe(),o=R(null),a=R({name:""}),r=R({name:""}),c=R(!1),d=R(!1),m=R(""),p=R(!1),u=R(null);let y=null;const h=g(()=>o.value?.session_ids?.length||0);function $(){r.value={};let S=!0;return a.value.name.trim()||(r.value.name="Project name is required",S=!1),S}async function k(){if(!(!$()||!o.value)){c.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),y&&y.hide()}catch(S){console.error("Failed to update project:",S),m.value=S.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function b(){if(o.value){d.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),y&&y.hide()}catch(S){console.error("Failed to delete project:",S),m.value=S.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function v(){a.value={name:""},r.value={},m.value="",p.value=!1}function _(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function f(){v(),o.value=null,s.hideModal()}return be(()=>s.currentModal,S=>{if(S?.name==="edit-project"&&y){const C=S.data||{};o.value=C.project,o.value&&(a.value.name=o.value.name),y.show()}}),Te(()=>{u.value&&Le(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{y=new S(u.value),u.value.addEventListener("shown.bs.modal",_),u.value.addEventListener("hidden.bs.modal",f)})}),Ae(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",_),u.value.removeEventListener("hidden.bs.modal",f)),y&&y.dispose()}),(S,C)=>(i(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",a0,[t("div",i0,[C[10]||(C[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",l0,[t("form",{onSubmit:ge(k,["prevent"])},[t("div",r0,[C[3]||(C[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),Ce(t("input",{type:"text",class:Q(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":C[0]||(C[0]=O=>a.value.name=O),placeholder:"My Project",required:""},null,2),[[qe,a.value.name]]),r.value.name?(i(),l("div",c0,w(r.value.name),1)):T("",!0)]),t("div",u0,[C[4]||(C[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,d0),C[5]||(C[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(i(),l("div",m0,w(m.value),1)):T("",!0)],32),C[8]||(C[8]=t("hr",null,null,-1)),t("div",f0,[C[6]||(C[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",p0," Deleting this project will also delete all "+w(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:C[1]||(C[1]=O=>p.value=!0),disabled:d.value}," ðŸ—‘ï¸ Delete Project ",8,v0)]),p.value?(i(),l("div",h0,[C[7]||(C[7]=t("strong",null,"Are you sure?",-1)),t("p",g0,' This will permanently delete the project "'+w(o.value?.name)+'" and all '+w(h.value)+" session(s). ",1),t("div",_0,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:d.value},[d.value?(i(),l("span",y0)):T("",!0),re(" "+w(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,b0),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:C[2]||(C[2]=O=>p.value=!1),disabled:d.value}," Cancel ",8,w0)])])):T("",!0)]),t("div",$0,[C[9]||(C[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:k,disabled:c.value},[c.value?(i(),l("span",S0)):T("",!0),re(" "+w(c.value?"Saving...":"Save Changes"),1)],8,k0)])])])],512))}},x0=oe(C0,[["__scopeId","data-v-52679516"]]),E0={class:"general-tab"},T0={key:0,class:"mb-3"},A0={for:"template-select",class:"form-label"},D0=["value"],M0=["value"],O0={key:0,class:"form-text"},L0={class:"mb-3"},N0={for:"config-name",class:"form-label"},I0=["value","placeholder","pattern","title"],j0={key:0,class:"invalid-feedback"},R0={key:1,class:"form-text"},P0={key:1,class:"mb-3"},F0=["value"],B0={class:"mb-3"},W0=["value"],V0={class:"form-text"},H0={key:0},U0={class:"mb-3"},q0={for:"config-permission-mode",class:"form-label"},z0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},K0={key:1,class:"field-indicator modified",title:"Modified from template"},G0=["value","disabled"],Y0={key:0,value:"bypassPermissions"},J0={class:"form-text"},Q0={key:0,class:"text-warning"},X0={key:1},Z0={class:"mb-3"},eC={for:"config-role",class:"form-label"},tC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},sC={key:1,class:"field-indicator modified",title:"Modified from template"},nC=["value","placeholder"],oC={class:"form-text"},aC={key:2,class:"mb-3"},iC={class:"input-group"},lC=["value","placeholder","disabled","readonly"],rC={class:"form-text"},cC={key:3,class:"mb-3"},uC={class:"form-control-plaintext"},dC={key:4,class:"mb-3 form-check"},mC=["checked"],fC={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=g(()=>e.mode==="create-session"||e.mode==="edit-session"),o=g(()=>e.mode==="create-template"||e.mode==="edit-template"),a=g(()=>e.mode==="create-session"),r=g(()=>e.mode==="edit-session"),c=g(()=>e.session?.state==="active"||e.session?.state==="starting"),d=g(()=>e.session?.initial_permission_mode==="bypassPermissions"),m=g(()=>e.selectedTemplateId?e.templates.find(k=>k.template_id===e.selectedTemplateId):null),p={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},u=g(()=>p[e.formData.model]||null),y=g(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),h=g(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function $(k){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[k]||"bg-secondary"}return(k,b)=>(i(),l("div",E0,[a.value?(i(),l("div",T0,[t("label",A0,[b[10]||(b[10]=re(" Template ",-1)),t("button",{type:"button",onClick:b[0]||(b[0]=v=>k.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:b[1]||(b[1]=v=>k.$emit("update:selected-template-id",v.target.value||null)),class:"form-select"},[b[11]||(b[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),l(le,null,fe(n.templates,v=>(i(),l("option",{key:v.template_id,value:v.template_id},w(v.name),9,M0))),128))],40,D0),m.value?(i(),l("div",O0,w(m.value.description),1)):T("",!0)])):T("",!0),t("div",L0,[t("label",N0,[re(w(o.value?"Template Name":"Session Name")+" ",1),b[12]||(b[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:Q(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:b[2]||(b[2]=v=>k.$emit("update:form-data","name",v.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,I0),n.errors.name?(i(),l("div",j0,w(n.errors.name),1)):T("",!0),s.value?(i(),l("div",R0,"Must be a single word (no spaces) for #nametag matching")):T("",!0)]),o.value?(i(),l("div",P0,[b[13]||(b[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:b[3]||(b[3]=v=>k.$emit("update:form-data","description",v.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,F0)])):T("",!0),t("div",B0,[b[15]||(b[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:b[4]||(b[4]=v=>k.$emit("update:form-data","model",v.target.value))},[...b[14]||(b[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,W0),t("div",V0,[u.value?(i(),l("span",H0,w(u.value.description),1)):T("",!0)])]),t("div",U0,[t("label",q0,[b[16]||(b[16]=re(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),l("span",z0," < ")):T("",!0),n.fieldStates.permission_mode==="modified"?(i(),l("span",K0," * ")):T("",!0)]),t("select",{id:"config-permission-mode",class:Q(["form-select",h.value]),value:n.formData.permission_mode,onChange:b[5]||(b[5]=v=>k.$emit("update:form-data","permission_mode",v.target.value)),disabled:r.value&&!c.value},[b[17]||(b[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),b[18]||(b[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),b[19]||(b[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||d.value?(i(),l("option",Y0," Bypass Permissions (No prompts - use with caution) ")):T("",!0)],42,G0),t("div",J0,[r.value&&!c.value?(i(),l("span",Q0," Session must be active to change permission mode. Start the session first. ")):(i(),l("span",X0,"Controls which tool actions require permission prompts"))])]),t("div",Z0,[t("label",eC,[re(w(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),l("span",tC," < ")):T("",!0),n.fieldStates.default_role==="modified"?(i(),l("span",sC," * ")):T("",!0)]),t("input",{id:"config-role",type:"text",class:Q(["form-control",y.value]),value:n.formData.default_role,onInput:b[6]||(b[6]=v=>k.$emit("update:form-data","default_role",v.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,nC),t("div",oC,w(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),l("div",aC,[b[20]||(b[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",iC,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:b[7]||(b[7]=v=>k.$emit("update:form-data","working_directory",v.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,lC),r.value?T("",!0):(i(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:b[8]||(b[8]=v=>k.$emit("open-folder-browser"))}," Browse "))]),t("div",rC,w(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):T("",!0),r.value&&n.session?(i(),l("div",cC,[b[21]||(b[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",uC,[t("span",{class:Q(["badge",$(n.session.state)])},w(n.session.state),3)])])):T("",!0),a.value?(i(),l("div",dC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:b[9]||(b[9]=v=>k.$emit("update:form-data","startImmediately",v.target.checked))},null,40,mC),b[22]||(b[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):T("",!0)]))}},pC=oe(fC,[["__scopeId","data-v-9f0e3252"]]),vC={class:"permissions-tab"},hC={class:"mb-3"},gC={for:"config-allowed-tools",class:"form-label"},_C={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},bC={key:1,class:"field-indicator modified",title:"Modified from template"},yC={key:0,class:"tools-list mb-2"},wC=["onClick"],$C={class:"input-group input-group-sm"},kC=["onKeydown"],SC=["disabled"],CC={class:"mt-2"},xC=["onClick"],EC={class:"form-text"},TC={class:"mb-3"},AC={class:"capabilities-editor"},DC={key:0,class:"capabilities-list mb-2"},MC=["onClick"],OC={class:"input-group input-group-sm"},LC=["onKeydown"],NC=["disabled"],IC={key:0,class:"mb-3"},jC={class:"settings-sources-editor"},RC={class:"form-check"},PC=["checked"],FC={class:"form-check"},BC=["checked"],WC={class:"form-check"},VC=["checked"],HC={key:1,class:"mb-3"},UC={class:"mb-3"},qC={key:0,class:"mt-2"},zC=["value"],KC=["value"],GC={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,a=R(""),r=R(""),c=R(!1),d=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=g(()=>s.mode==="create-template"||s.mode==="edit-template"),p=g(()=>s.mode==="create-session"||s.mode==="edit-session"),u=g(()=>s.formData.setting_sources||["user","project","local"]),y=g(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(O=>O.trim()).filter(O=>O.length>0)),h=g(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(O=>O.trim()).filter(O=>O.length>0)),$=g(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),k=g(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"}));function b(){const O=a.value.trim();if(O){if(!y.value.includes(O)){const x=[...y.value,O];o("update:form-data","allowed_tools",x.join(", "))}a.value=""}}function v(O){const x=[...y.value];x.splice(O,1),o("update:form-data","allowed_tools",x.join(", "))}function _(O){if(y.value.includes(O)){const x=y.value.indexOf(O);v(x)}else{const x=[...y.value,O];o("update:form-data","allowed_tools",x.join(", "))}}function f(){const O=r.value.trim().toLowerCase();if(O){if(!h.value.includes(O)){const x=[...h.value,O];o("update:form-data","capabilities",x.join(", "))}r.value=""}}function S(O){const x=[...h.value];x.splice(O,1),o("update:form-data","capabilities",x.join(", "))}function C(O){const x=[...u.value],E=x.indexOf(O);E>=0?x.splice(E,1):x.push(O),o("update:form-data","setting_sources",x)}return(O,x)=>(i(),l("div",vC,[t("div",hC,[t("label",gC,[x[9]||(x[9]=re(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),l("span",_C," < ")):T("",!0),n.fieldStates.allowed_tools==="modified"?(i(),l("span",bC," * ")):T("",!0)]),t("div",{class:Q(["allowed-tools-editor",k.value])},[y.value.length>0?(i(),l("div",yC,[(i(!0),l(le,null,fe(y.value,(E,P)=>(i(),l("span",{key:P,class:"badge bg-primary me-1 mb-1 tool-badge"},[re(w(E)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:A=>v(P),"aria-label":"Remove tool"},null,8,wC)]))),128))])):T("",!0),t("div",$C,[Ce(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=E=>a.value=E),onKeydown:Ze(ge(b,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,kC),[[qe,a.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:b,disabled:!a.value.trim()}," Add ",8,SC)]),t("div",CC,[x[10]||(x[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),l(le,null,fe(d,E=>t("button",{key:E,type:"button",class:Q(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":y.value.includes(E)}]),onClick:P=>_(E)},w(E),11,xC)),64))])],2),t("div",EC,w(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",TC,[x[11]||(x[11]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",AC,[h.value.length>0?(i(),l("div",DC,[(i(!0),l(le,null,fe(h.value,(E,P)=>(i(),l("span",{key:P,class:"badge bg-info me-1 mb-1 capability-badge"},[re(w(E)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:A=>S(P),"aria-label":"Remove capability"},null,8,MC)]))),128))])):T("",!0),t("div",OC,[Ce(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[1]||(x[1]=E=>r.value=E),onKeydown:Ze(ge(f,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,LC),[[qe,r.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:f,disabled:!r.value.trim()}," Add ",8,NC)])]),x[12]||(x[12]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),p.value?(i(),l("div",IC,[x[16]||(x[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",jC,[t("div",RC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:u.value.includes("user"),onChange:x[2]||(x[2]=E=>C("user"))},null,40,PC),x[13]||(x[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[re(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",FC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:u.value.includes("project"),onChange:x[3]||(x[3]=E=>C("project"))},null,40,BC),x[14]||(x[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[re(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",WC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:u.value.includes("local"),onChange:x[4]||(x[4]=E=>C("local"))},null,40,VC),x[15]||(x[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[re(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),x[17]||(x[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):T("",!0),p.value?(i(),l("div",HC,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:x[5]||(x[5]=E=>O.$emit("preview-permissions"))}," Preview Effective Permissions ")])):T("",!0),t("div",UC,[t("a",{class:"text-muted small",role:"button",onClick:x[6]||(x[6]=E=>c.value=!c.value)},w(c.value?"Hide":"Show")+" raw input ",1),c.value?(i(),l("div",qC,[x[18]||(x[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:Q(["form-control form-control-sm",$.value]),value:n.formData.allowed_tools,onInput:x[7]||(x[7]=E=>O.$emit("update:form-data","allowed_tools",E.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,zC),x[19]||(x[19]=t("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),t("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:x[8]||(x[8]=E=>O.$emit("update:form-data","capabilities",E.target.value)),placeholder:"python, testing, debugging"},null,40,KC)])):T("",!0)])]))}},YC=oe(GC,[["__scopeId","data-v-20d381a4"]]),JC={class:"advanced-tab"},QC={class:"mb-3"},XC={for:"config-system-prompt",class:"form-label"},ZC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ex={key:1,class:"field-indicator modified",title:"Modified from template"},tx=["value","rows","placeholder"],sx={class:"form-text"},nx={class:"mb-3 form-check"},ox=["checked"],ax={key:0,class:"form-text text-warning"},ix={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,a=g(()=>s.mode==="create-template"||s.mode==="edit-template"),r=g(()=>s.formData.initialization_context),c=g(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),d=g(()=>s.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),m=g(()=>{const u={};return s.fieldStates.initialization_context==="autofilled"&&(u["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(u["field-modified"]=!0),u});function p(u){const y=u.target.value;o("update:form-data","initialization_context",y)}return(u,y)=>(i(),l("div",JC,[t("div",QC,[t("label",XC,[re(w(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),l("span",ZC," < ")):T("",!0),n.fieldStates.initialization_context==="modified"?(i(),l("span",ex," * ")):T("",!0)]),t("textarea",{id:"config-system-prompt",class:Q(["form-control",m.value]),value:r.value,onInput:p,rows:a.value?4:5,placeholder:c.value},null,42,tx),t("div",sx,w(d.value),1)]),t("div",nx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:y[0]||(y[0]=h=>u.$emit("update:form-data","override_system_prompt",h.target.checked))},null,40,ox),y[1]||(y[1]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),l("div",ax,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+w(a.value?"":" or legion guide")+").",1)])):T("",!0)])]))}},lx=oe(ix,[["__scopeId","data-v-33a896d8"]]),rx={class:"sandbox-tab"},cx={class:"mb-3 form-check"},ux=["checked"],dx={class:"mb-2 form-check"},mx=["checked","disabled"],fx={class:"mb-2 form-check"},px=["checked","disabled"],vx={class:"mb-2"},hx=["value","disabled"],gx={class:"mb-3 form-check"},_x=["checked","disabled"],bx={class:"mb-2"},yx=["value","disabled"],wx={class:"mb-2 form-check"},$x=["checked","disabled"],kx={class:"mb-2"},Sx=["value","disabled"],Cx={class:"mb-3 form-check"},xx=["checked","disabled"],Ex={class:"mb-2"},Tx=["value","disabled"],Ax={class:"mb-2"},Dx=["value","disabled"],Mx={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(c,d){s.formData.sandbox[c]=d}function a(c,d){s.formData.sandbox.network[c]=d}function r(c,d){s.formData.sandbox.ignoreViolations[c]=d}return(c,d)=>(i(),l("div",rx,[t("div",cx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:d[0]||(d[0]=m=>c.$emit("update:form-data","sandbox_enabled",m.target.checked))},null,40,ux),d[11]||(d[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:Q(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,w(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:Q(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",dx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:d[1]||(d[1]=m=>o("autoAllowBashIfSandboxed",m.target.checked))},null,40,mx),t("label",{class:Q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",fx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:d[2]||(d[2]=m=>o("allowUnsandboxedCommands",m.target.checked))},null,40,px),t("label",{class:Q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",vx,[t("label",{for:"config-sandbox-excluded-cmds",class:Q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:d[3]||(d[3]=m=>o("excludedCommands",m.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,hx)]),t("div",gx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:d[4]||(d[4]=m=>o("enableWeakerNestedSandbox",m.target.checked))},null,40,_x),t("label",{class:Q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:Q(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",bx,[t("label",{for:"config-sandbox-allowed-domains",class:Q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:d[5]||(d[5]=m=>a("allowedDomains",m.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,yx)]),t("div",wx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:d[6]||(d[6]=m=>a("allowLocalBinding",m.target.checked))},null,40,$x),t("label",{class:Q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",kx,[t("label",{for:"config-sandbox-unix-sockets",class:Q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:d[7]||(d[7]=m=>a("allowUnixSockets",m.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,Sx)]),t("div",Cx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:d[8]||(d[8]=m=>a("allowAllUnixSockets",m.target.checked))},null,40,xx),t("label",{class:Q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:Q(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",Ex,[t("label",{for:"config-sandbox-ignore-file",class:Q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:d[9]||(d[9]=m=>r("file",m.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,Tx)]),t("div",Ax,[t("label",{for:"config-sandbox-ignore-network",class:Q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:d[10]||(d[10]=m=>r("network",m.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,Dx)])]))}},Ox=oe(Mx,[["__scopeId","data-v-be109d12"]]),Lx={class:"modal-dialog modal-lg"},Nx={class:"modal-content"},Ix={class:"modal-body"},jx={key:0,class:"text-center py-4"},Rx={key:1,class:"alert alert-danger"},Px={key:2},Fx={class:"mb-3"},Bx={class:"small text-muted mb-2"},Wx={key:0},Vx={key:0,class:"alert alert-info"},Hx={key:1},Ux={class:"table table-sm table-striped"},qx={key:2,class:"mt-3"},zx={class:"modal-footer"},Kx=["disabled"],Gx={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,a=s,r=R(null);let c=null;const d=R(!1),m=R(""),p=R([]);be(r,b=>{b&&(c=new $t(b),b.addEventListener("hidden.bs.modal",()=>{a("close")}))});function u(){c&&(c.show(),h())}function y(){c&&c.hide()}async function h(){d.value=!0,m.value="",p.value=[];try{const b=await we.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});p.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),m.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{d.value=!1}}function $(){h()}function k(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:y}),(b,v)=>(i(),l("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",Lx,[t("div",Nx,[v[7]||(v[7]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ix,[d.value?(i(),l("div",jx,[...v[0]||(v[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(i(),l("div",Rx,w(m.value),1)):(i(),l("div",Px,[t("div",Fx,[v[2]||(v[2]=t("h6",null,"Settings Sources",-1)),t("div",Bx,[v[1]||(v[1]=re(" Loading permissions from: ",-1)),(i(!0),l(le,null,fe(n.settingSources,(_,f)=>(i(),l("span",{key:_},[t("code",null,w(_),1),f<n.settingSources.length-1?(i(),l("span",Wx,", ")):T("",!0)]))),128))])]),p.value.length===0?(i(),l("div",Vx," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),l("div",Hx,[t("h6",null,"Pre-approved Permissions ("+w(p.value.length)+")",1),t("table",Ux,[v[3]||(v[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),l(le,null,fe(p.value,_=>(i(),l("tr",{key:_.permission},[t("td",null,[t("code",null,w(_.permission),1)]),t("td",null,[(i(!0),l(le,null,fe(_.sources,(f,S)=>(i(),l("span",{key:f,class:Q(["badge me-1",k(f)])},w(f),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),l("div",qx,[v[4]||(v[4]=t("h6",null,"Session Allowed Tools",-1)),v[5]||(v[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),l(le,null,fe(n.sessionAllowedTools,_=>(i(),l("span",{key:_,class:"badge bg-success me-1 mb-1"},w(_),1))),128))])])):T("",!0)]))]),t("div",zx,[v[6]||(v[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:$,disabled:d.value}," Refresh ",8,Kx)])])])],512))}},Yx=oe(Gx,[["__scopeId","data-v-988ff7c4"]]),Jx={class:"modal-dialog modal-lg modal-dialog-centered"},Qx={class:"modal-content"},Xx={class:"modal-header"},Zx={id:"configurationModalLabel",class:"modal-title"},eE={class:"modal-body"},tE={key:0,class:"template-list-view"},sE={key:0,class:"alert alert-info"},nE={class:"card-body"},oE={class:"d-flex justify-content-between align-items-start"},aE={class:"flex-grow-1"},iE={class:"card-title mb-1"},lE={key:0,class:"card-text text-muted small mb-2"},rE={class:"template-meta"},cE={class:"badge bg-secondary me-2"},uE={class:"text-muted small"},dE={class:"btn-group btn-group-sm ms-3"},mE=["onClick"],fE=["onClick"],pE={key:1},vE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},hE={class:"nav-item",role:"presentation"},gE={key:0,class:"error-indicator",title:"This tab has validation errors"},_E={class:"nav-item",role:"presentation"},bE={key:0,class:"error-indicator",title:"This tab has validation errors"},yE={class:"nav-item",role:"presentation"},wE={key:0,class:"error-indicator",title:"This tab has validation errors"},$E={class:"nav-item",role:"presentation"},kE={class:"tab-content"},SE={key:2,class:"alert alert-danger mt-3"},CE={key:0},xE={key:1},EE={class:"modal-footer"},TE={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},AE=["disabled"],DE={key:0,class:"spinner-border spinner-border-sm me-2"},ME={__name:"ConfigurationModal",setup(n){const e=Yt(),s=He(),o=_e(),a=xe(),r=R(null);let c=null;const d=R(null),m=R("create-session"),p=R("general"),u=R(null),y=R(null),h=R(null),$=R([]),k=R(null),b=R(null),v=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),_=Es({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),f=Es({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),S=Es({name:""}),C=g(()=>({general:!!S.name,permissions:!1,advanced:!1})),O=R(!1),x=R(""),E=g(()=>m.value==="create-session"||m.value==="edit-session"),P=g(()=>m.value==="edit-session"||m.value==="edit-template"),A=g(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),B=g(()=>O.value?P.value?"Saving...":"Creating...":P.value?"Save Changes":E.value?"Create Session":"Save Template"),G=g(()=>!(!f.name.trim()||E.value&&f.name.includes(" "))),V=g(()=>y.value?.state==="active"||y.value?.state==="starting"),N=g(()=>{if(!y.value)return!1;const q=(f.initialization_context||"")!==(y.value.system_prompt||""),te=(f.override_system_prompt||!1)!==(y.value.override_system_prompt||!1),ue=(f.sandbox_enabled||!1)!==(y.value.sandbox_enabled||!1);if(q||te||ue)return!0;if(f.sandbox_enabled){const pe=y.value.sandbox_config||{},ke=f.sandbox,Fe=JSON.stringify({autoAllowBashIfSandboxed:pe.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:pe.allowUnsandboxedCommands??!1,excludedCommands:(pe.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:pe.enableWeakerNestedSandbox??!1,network:{allowedDomains:(pe.network?.allowedDomains||[]).join(", "),allowLocalBinding:pe.network?.allowLocalBinding??!1,allowUnixSockets:(pe.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:pe.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(pe.ignoreViolations?.file||[]).join(", "),network:(pe.ignoreViolations?.network||[]).join(", ")}}),ns=JSON.stringify({autoAllowBashIfSandboxed:ke.autoAllowBashIfSandboxed,allowUnsandboxedCommands:ke.allowUnsandboxedCommands,excludedCommands:ke.excludedCommands,enableWeakerNestedSandbox:ke.enableWeakerNestedSandbox,network:{allowedDomains:ke.network.allowedDomains,allowLocalBinding:ke.network.allowLocalBinding,allowUnixSockets:ke.network.allowUnixSockets,allowAllUnixSockets:ke.network.allowAllUnixSockets},ignoreViolations:{file:ke.ignoreViolations.file,network:ke.ignoreViolations.network}});if(Fe!==ns)return!0}return!1}),W=g(()=>{if(!y.value)return!1;const q=(f.model||"sonnet")!==(y.value.model||"sonnet"),te=(f.allowed_tools||"")!==(y.value.allowed_tools?.join(", ")||""),ue=y.value.setting_sources||["user","project","local"],pe=f.setting_sources||["user","project","local"],ke=JSON.stringify([...ue].sort())!==JSON.stringify([...pe].sort());return q||te||ke}),z=g(()=>N.value?"reset":W.value?"restart":null),Y=g(()=>m.value==="edit-session"&&V.value&&z.value!==null),j=g(()=>y.value?.working_directory?y.value.working_directory:f.working_directory?f.working_directory:s.projects.get(u.value)?.working_directory||""),F=g(()=>!f.allowed_tools||!f.allowed_tools.trim()?[]:f.allowed_tools.split(",").map(q=>q.trim()).filter(q=>q.length>0));function K(){d.value&&d.value.show()}function ee(){const q=te=>te.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0);return{autoAllowBashIfSandboxed:f.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:f.sandbox.allowUnsandboxedCommands,excludedCommands:q(f.sandbox.excludedCommands),enableWeakerNestedSandbox:f.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:q(f.sandbox.network.allowedDomains),allowLocalBinding:f.sandbox.network.allowLocalBinding,allowUnixSockets:q(f.sandbox.network.allowUnixSockets),allowAllUnixSockets:f.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:q(f.sandbox.ignoreViolations.file),network:q(f.sandbox.ignoreViolations.network)}}}function se(q,te){f[q]=te,q==="name"&&(S.name="")}function ne(q){k.value=q,ae()}async function ve(){try{const q=await we.get("/api/templates");$.value=q||[]}catch(q){console.error("Failed to load templates:",q),$.value=[]}}function ae(){if(!k.value){f.default_role="",f.initialization_context="",f.permission_mode="default",f.allowed_tools="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",v.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const q=$.value.find(te=>te.template_id===k.value);if(q)if(_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",q.default_role?(f.default_role=q.default_role,v.value.default_role=q.default_role,_.default_role="autofilled"):(f.default_role="",v.value.default_role=null),q.default_system_prompt?(f.initialization_context=q.default_system_prompt,v.value.initialization_context=q.default_system_prompt,_.initialization_context="autofilled"):(f.initialization_context="",v.value.initialization_context=null),q.permission_mode?(f.permission_mode=q.permission_mode,v.value.permission_mode=q.permission_mode,_.permission_mode="autofilled"):(f.permission_mode="default",v.value.permission_mode=null),q.allowed_tools&&q.allowed_tools.length>0){const te=q.allowed_tools.join(", ");f.allowed_tools=te,v.value.allowed_tools=te,_.allowed_tools="autofilled"}else f.allowed_tools="",v.value.allowed_tools=null}function H(){const te=(u.value?s.projects.get(u.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:te,currentPath:f.working_directory||"",onSelect:ue=>{f.working_directory=ue}})}function M(){m.value==="create-session"&&(b.value={mode:"create-session",projectId:u.value,formData:{...f},selectedTemplateId:k.value}),m.value="template-list",de()}function D(){m.value="create-template",de(),p.value="general"}function L(q){m.value="edit-template",h.value=q,de(),Se(q),p.value="general"}async function I(q){if(confirm(`Delete template "${q.name}"?

This action cannot be undone.`))try{await we.delete(`/api/templates/${q.template_id}`),await ve()}catch(te){console.error("Failed to delete template:",te),x.value=te.response?.data?.detail||"Failed to delete template"}}function U(){let q=!0;return S.name="",f.name.trim()||(S.name="Name is required",q=!1),E.value&&f.name.includes(" ")&&(S.name="Session name must be a single word (no spaces)",q=!1),q}async function Z(){if(!U()){S.name&&(p.value="general");return}O.value=!0,x.value="";try{switch(m.value){case"create-session":await he(),c&&c.hide();break;case"edit-session":await Pe(),c&&c.hide();break;case"create-template":await X();break;case"edit-template":await ce();break}}catch(q){console.error("Submit failed:",q),x.value=q.response?.data?.detail||q.message||"Operation failed. Please try again."}finally{O.value=!1}}async function he(){if(!u.value)throw new Error("Project ID is missing");const q=f.allowed_tools.split(",").map(ke=>ke.trim()).filter(ke=>ke.length>0),te=f.capabilities.split(",").map(ke=>ke.trim()).filter(ke=>ke.length>0),ue={name:f.name.trim(),model:f.model||null,role:f.default_role.trim()||null,initialization_context:f.initialization_context.trim()||null,override_system_prompt:f.override_system_prompt,capabilities:te.length>0?te:null,permission_mode:f.permission_mode,allowed_tools:q.length>0?q:null,working_directory:f.working_directory.trim()||null,sandbox_enabled:f.sandbox_enabled,sandbox_config:f.sandbox_enabled?ee():null,setting_sources:f.setting_sources},pe=await we.post(`/api/legions/${u.value}/minions`,ue);if(pe.success&&pe.minion_id)await s.fetchProjects(),await o.fetchSessions(),f.startImmediately&&await o.startSession(pe.minion_id),e.push(`/session/${pe.minion_id}`);else throw new Error("Failed to create session")}async function Pe(){if(!y.value)throw new Error("Session data is missing");const q=y.value.session_id,te=y.value.state==="active"||y.value.state==="starting",ue=f.allowed_tools.split(",").map(Fe=>Fe.trim()).filter(Fe=>Fe.length>0),pe=f.capabilities.split(",").map(Fe=>Fe.trim()).filter(Fe=>Fe.length>0),ke={name:f.name.trim(),model:f.model,role:f.default_role.trim()||null,system_prompt:f.initialization_context.trim()||null,override_system_prompt:f.override_system_prompt,allowed_tools:ue.length>0?ue:null,capabilities:pe.length>0?pe:null,sandbox_enabled:f.sandbox_enabled,sandbox_config:f.sandbox_enabled?ee():null,setting_sources:f.setting_sources};await o.patchSession(q,ke),te&&f.permission_mode!==y.value.current_permission_mode&&await o.setPermissionMode(q,f.permission_mode)}async function X(){const q=f.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),te=f.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ue={name:f.name.trim(),description:f.description.trim()||null,permission_mode:f.permission_mode,allowed_tools:q.length>0?q:null,default_role:f.default_role.trim()||null,default_system_prompt:f.initialization_context.trim()||null,model:f.model||null,capabilities:te.length>0?te:null,override_system_prompt:f.override_system_prompt,sandbox_enabled:f.sandbox_enabled,sandbox_config:f.sandbox_enabled?ee():null};await we.post("/api/templates",ue),await ve(),m.value="template-list",de()}async function ce(){if(!h.value)throw new Error("Template data is missing");const q=f.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),te=f.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ue={name:f.name.trim(),description:f.description.trim()||null,permission_mode:f.permission_mode,allowed_tools:q.length>0?q:null,default_role:f.default_role.trim()||null,default_system_prompt:f.initialization_context.trim()||null,model:f.model||null,capabilities:te.length>0?te:null,override_system_prompt:f.override_system_prompt,sandbox_enabled:f.sandbox_enabled,sandbox_config:f.sandbox_enabled?ee():null};await we.put(`/api/templates/${h.value.template_id}`,ue),await ve(),m.value="template-list",h.value=null,de()}function de(){f.name="",f.model="sonnet",f.permission_mode="default",f.working_directory="",f.description="",f.default_role="",f.startImmediately=!0,f.allowed_tools="",f.capabilities="",f.setting_sources=["user","project","local"],f.system_prompt="",f.override_system_prompt=!1,f.initialization_context="",f.sandbox_enabled=!1,f.sandbox.autoAllowBashIfSandboxed=!0,f.sandbox.allowUnsandboxedCommands=!1,f.sandbox.excludedCommands="",f.sandbox.enableWeakerNestedSandbox=!1,f.sandbox.network.allowedDomains="",f.sandbox.network.allowLocalBinding=!1,f.sandbox.network.allowUnixSockets="",f.sandbox.network.allowAllUnixSockets=!1,f.sandbox.ignoreViolations.file="",f.sandbox.ignoreViolations.network="",S.name="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",v.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},k.value=null,x.value="",p.value="general"}function $e(q){f.name=q.name||"",f.model=q.model||"sonnet",f.permission_mode=q.current_permission_mode||"default",f.working_directory=q.working_directory||"",f.default_role=q.role||"",f.initialization_context=q.system_prompt||"",f.override_system_prompt=q.override_system_prompt||!1,f.system_prompt="",f.allowed_tools=q.allowed_tools?.join(", ")||"",f.capabilities=q.capabilities?.join(", ")||"",f.sandbox_enabled=q.sandbox_enabled||!1,f.setting_sources=q.setting_sources||["user","project","local"];const te=q.sandbox_config||{};f.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,f.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,f.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),f.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ue=te.network||{};f.sandbox.network.allowedDomains=(ue.allowedDomains||[]).join(", "),f.sandbox.network.allowLocalBinding=ue.allowLocalBinding??!1,f.sandbox.network.allowUnixSockets=(ue.allowUnixSockets||[]).join(", "),f.sandbox.network.allowAllUnixSockets=ue.allowAllUnixSockets??!1;const pe=te.ignoreViolations||{};f.sandbox.ignoreViolations.file=(pe.file||[]).join(", "),f.sandbox.ignoreViolations.network=(pe.network||[]).join(", ")}function Se(q){f.name=q.name||"",f.description=q.description||"",f.permission_mode=q.permission_mode||"default",f.default_role=q.default_role||"",f.initialization_context=q.default_system_prompt||"",f.allowed_tools=q.allowed_tools?.join(", ")||"",f.model=q.model||"sonnet",f.capabilities=q.capabilities?.join(", ")||"",f.override_system_prompt=q.override_system_prompt||!1,f.sandbox_enabled=q.sandbox_enabled||!1;const te=q.sandbox_config||{};f.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,f.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,f.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),f.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ue=te.network||{};f.sandbox.network.allowedDomains=(ue.allowedDomains||[]).join(", "),f.sandbox.network.allowLocalBinding=ue.allowLocalBinding??!1,f.sandbox.network.allowUnixSockets=(ue.allowUnixSockets||[]).join(", "),f.sandbox.network.allowAllUnixSockets=ue.allowAllUnixSockets??!1;const pe=te.ignoreViolations||{};f.sandbox.ignoreViolations.file=(pe.file||[]).join(", "),f.sandbox.ignoreViolations.network=(pe.network||[]).join(", ")}function Xe(){rt(()=>{const q=document.getElementById("config-name");q&&(q.focus(),P.value&&q.select())})}function Ke(){de(),m.value="create-session",u.value=null,y.value=null,h.value=null,a.hideModal()}return be(()=>a.currentModal,async(q,te)=>{if(!(!q||!c)){if(q.name==="configuration"){const ue=q.data||{};m.value=ue.mode||"create-session",u.value=ue.project?.project_id||ue.projectId||null,y.value=ue.session||null,h.value=ue.template||null,de(),m.value==="create-session"&&await ve(),m.value==="edit-session"&&y.value?$e(y.value):m.value==="edit-template"&&h.value&&Se(h.value),c.show()}else if(q.name==="create-minion"||q.name==="create-session"){const ue=q.data||{};m.value="create-session",u.value=ue.project?.project_id||null,y.value=null,h.value=null,de(),await ve(),c.show()}else if(q.name==="edit-session"){const ue=q.data||{};m.value="edit-session",y.value=ue.session||null,u.value=y.value?.project_id||null,h.value=null,de(),y.value&&$e(y.value),c.show()}else q.name==="template-management"&&(m.value="template-list",de(),await ve(),c.show());te?.name==="configuration"&&te.data?.mode?.includes("template")&&q?.name==="configuration"&&m.value==="create-session"&&await ve()}}),be(()=>f.default_role,q=>{v.value.default_role!==null&&(_.default_role=q===v.value.default_role?"autofilled":"modified")}),be(()=>f.initialization_context,q=>{v.value.initialization_context!==null&&(_.initialization_context=q===v.value.initialization_context?"autofilled":"modified")}),be(()=>f.permission_mode,q=>{v.value.permission_mode!==null&&(_.permission_mode=q===v.value.permission_mode?"autofilled":"modified")}),be(()=>f.allowed_tools,q=>{v.value.allowed_tools!==null&&(_.allowed_tools=q===v.value.allowed_tools?"autofilled":"modified")}),Te(()=>{r.value&&Le(()=>import("./modal-D6mKceGM.js").then(q=>q.m),__vite__mapDeps([0,1])).then(q=>{const te=q.default;c=new te(r.value),r.value.addEventListener("shown.bs.modal",Xe),r.value.addEventListener("hidden.bs.modal",Ke)})}),Ae(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",Xe),r.value.removeEventListener("hidden.bs.modal",Ke)),c&&c.dispose()}),(q,te)=>(i(),l(le,null,[t("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",Jx,[t("div",Qx,[t("div",Xx,[t("h5",Zx,[m.value==="create-template"||m.value==="edit-template"?(i(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:M,title:"Back to template list"}," â† ")):T("",!0),re(" "+w(A.value),1)]),te[4]||(te[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",eE,[m.value==="template-list"?(i(),l("div",tE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[te[5]||(te[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:D,class:"btn btn-primary btn-sm"}," + Create New ")]),$.value.length===0?(i(),l("div",sE," No templates found. Create your first template! ")):T("",!0),(i(!0),l(le,null,fe($.value,ue=>(i(),l("div",{key:ue.template_id,class:"card mb-2"},[t("div",nE,[t("div",oE,[t("div",aE,[t("h6",iE,w(ue.name),1),ue.description?(i(),l("p",lE,w(ue.description),1)):T("",!0),t("div",rE,[t("span",cE,w(ue.permission_mode),1),t("span",uE,w(ue.allowed_tools?.length||0)+" tools",1)])]),t("div",dE,[t("button",{onClick:pe=>L(ue),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,mE),t("button",{onClick:pe=>I(ue),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,fE)])])])]))),128))])):(i(),l("div",pE,[t("ul",vE,[t("li",hE,[t("button",{class:Q(["nav-link",{active:p.value==="general","has-error":C.value.general}]),type:"button",onClick:te[0]||(te[0]=ue=>p.value="general")},[te[6]||(te[6]=re(" General ",-1)),C.value.general?(i(),l("span",gE)):T("",!0)],2)]),t("li",_E,[t("button",{class:Q(["nav-link",{active:p.value==="permissions","has-error":C.value.permissions}]),type:"button",onClick:te[1]||(te[1]=ue=>p.value="permissions")},[te[7]||(te[7]=re(" Permissions ",-1)),C.value.permissions?(i(),l("span",bE)):T("",!0)],2)]),t("li",yE,[t("button",{class:Q(["nav-link",{active:p.value==="advanced","has-error":C.value.advanced}]),type:"button",onClick:te[2]||(te[2]=ue=>p.value="advanced")},[te[8]||(te[8]=re(" Advanced ",-1)),C.value.advanced?(i(),l("span",wE)):T("",!0)],2)]),t("li",$E,[t("button",{class:Q(["nav-link",{active:p.value==="sandbox"}]),type:"button",onClick:te[3]||(te[3]=ue=>p.value="sandbox")}," Sandbox ",2)])]),t("div",kE,[Ce(ye(pC,{mode:m.value,"form-data":f,errors:S,templates:$.value,"selected-template-id":k.value,session:y.value,"field-states":_,"onUpdate:formData":se,"onUpdate:selectedTemplateId":ne,onOpenFolderBrowser:H,onOpenTemplateManager:M},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ht,p.value==="general"]]),Ce(ye(YC,{mode:m.value,"form-data":f,errors:S,session:y.value,"field-states":_,"onUpdate:formData":se,onPreviewPermissions:K},null,8,["mode","form-data","errors","session","field-states"]),[[ht,p.value==="permissions"]]),Ce(ye(lx,{mode:m.value,"form-data":f,errors:S,session:y.value,"field-states":_,"onUpdate:formData":se},null,8,["mode","form-data","errors","session","field-states"]),[[ht,p.value==="advanced"]]),Ce(ye(Ox,{mode:m.value,"form-data":f,errors:S,session:y.value,"field-states":_,"onUpdate:formData":se},null,8,["mode","form-data","errors","session","field-states"]),[[ht,p.value==="sandbox"]])])])),x.value?(i(),l("div",SE,w(x.value),1)):T("",!0)]),Y.value?(i(),l("div",{key:0,class:Q(["warning-banner","warning-banner-"+z.value])},[z.value==="reset"?(i(),l("small",CE,[...te[9]||(te[9]=[re(" Changes require a ",-1),t("strong",null,"reset",-1),re(" to take effect. This starts a new conversation. ",-1)])])):(i(),l("small",xE,[...te[10]||(te[10]=[re(" Changes require a ",-1),t("strong",null,"restart",-1),re(" to take effect. ",-1)])]))],2)):T("",!0),t("div",EE,[t("button",TE,w(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(i(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:O.value||!G.value,onClick:Z},[O.value?(i(),l("span",DE)):T("",!0),re(" "+w(B.value),1)],8,AE)):T("",!0)])])])],512),ye(Yx,{ref_key:"permissionPreviewModal",ref:d,"working-directory":j.value,"setting-sources":f.setting_sources,"session-allowed-tools":F.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},OE=oe(ME,[["__scopeId","data-v-2f6afb6b"]]),LE={class:"modal-dialog modal-dialog-centered"},NE={class:"modal-content"},IE={class:"modal-header"},jE={class:"modal-title",id:"manageSessionModalLabel"},RE={class:"modal-body"},PE={key:0,class:"text-center py-4"},FE={class:"text-muted"},BE={key:1},WE={key:2},VE={class:"text-muted"},HE={key:0,class:"text-center py-2"},UE={key:1,class:"alert alert-warning mt-3"},qE={class:"mb-0 mt-2"},zE={key:0,class:"text-muted"},KE={key:3},GE={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},YE={class:"d-grid gap-2"},JE=["disabled"],QE=["disabled"],XE=["disabled"],ZE=["disabled"],eT={class:"modal-footer"},tT={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},sT={__name:"SessionManageModal",setup(n){const e=Yt(),s=_e(),o=xe(),a=mt();Ne();const r=R(null),c=R(!1),d=R(""),m=R(""),p=R(null),u=R(null);let y=null;const h=R([]),$=R(!1),k=g(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function b(){p.value="reset"}async function v(){if(p.value="delete",h.value=[],!!r.value){$.value=!0;try{const A=await we.get(`/api/sessions/${r.value.session_id}/descendants`);h.value=A.descendants||[]}catch(A){console.error("Failed to fetch descendants:",A),h.value=[]}finally{$.value=!1}}}function _(){p.value=null}async function f(){p.value==="reset"?await O():p.value==="delete"&&await x()}async function S(){if(r.value){c.value=!0,d.value="Restarting session...";try{const A=r.value.session_id,B=s.currentSessionId===A,G=await we.post(`/api/sessions/${A}/restart`);if(G.success)console.log("Session restarted successfully"),B&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(A)),y&&y.hide();else{const V=G.error||G.detail||"Failed to restart session";console.error("Failed to restart session:",V),m.value=`Failed to restart session: ${V}`}}catch(A){console.error("Error restarting session:",A);const B=A.data?.detail||A.message||"Unknown error";m.value=`Error restarting session: ${B}`}finally{c.value=!1}}}async function C(){if(r.value)try{y&&y.hide(),console.log("Ending session",r.value.session_id);const A=r.value.session_id;await we.post(`/api/sessions/${A}/terminate`),s.currentSessionId===A&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(A){console.error("Error ending session:",A),s.currentSessionId===r.value?.session_id&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function O(){if(r.value){c.value=!0,d.value="Resetting session...";try{const A=r.value.session_id,B=s.currentSessionId===A,G=await we.post(`/api/sessions/${A}/reset`);if(G.success)console.log("Session reset successfully"),B&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(A)),y&&y.hide();else{const V=G.error||G.detail||"Failed to reset session";console.error("Failed to reset session:",V),m.value=`Failed to reset session: ${V}`,p.value=null}}catch(A){console.error("Error resetting session:",A);const B=A.data?.detail||A.message||"Unknown error";m.value=`Error resetting session: ${B}`,p.value=null}finally{c.value=!1}}}async function x(){if(r.value){c.value=!0,d.value="Deleting session...";try{const A=r.value.session_id;await s.deleteSession(A),e.currentRoute.value.params.sessionId===A&&e.push("/"),y&&y.hide()}catch(A){console.error("Error deleting session:",A);const B=A.data?.detail||A.message||"Unknown error";m.value=`Error deleting session: ${B}`,p.value=null}finally{c.value=!1}}}function E(){p.value=null,c.value=!1,d.value="",m.value="",h.value=[],$.value=!1}function P(){E(),r.value=null,o.hideModal()}return be(()=>o.currentModal,A=>{if(A?.name==="manage-session"&&y){const B=A.data||{};r.value=B.session,E(),y.show()}}),Te(()=>{u.value&&Le(async()=>{const{default:A}=await import("./modal-D6mKceGM.js").then(B=>B.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{y=new A(u.value),u.value.addEventListener("hidden.bs.modal",P)})}),Ae(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",P),y&&y.dispose()}),(A,B)=>(i(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",LE,[t("div",NE,[t("div",IE,[t("h5",jE,w(p.value?k.value:"Manage Session"),1),B[1]||(B[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",RE,[c.value?(i(),l("div",PE,[B[2]||(B[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",FE,w(d.value),1)])):p.value==="reset"?(i(),l("div",BE,[...B[3]||(B[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(i(),l("div",WE,[B[9]||(B[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",VE,[B[4]||(B[4]=re("This will permanently delete session ",-1)),t("strong",null,w(r.value?.name),1),B[5]||(B[5]=re(".",-1))]),B[10]||(B[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),$.value?(i(),l("div",HE,[...B[6]||(B[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):h.value.length>0?(i(),l("div",UE,[B[7]||(B[7]=t("strong",null,"Cascading Deletion:",-1)),B[8]||(B[8]=re(" This session has ",-1)),t("strong",null,w(h.value.length),1),re(" child session"+w(h.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",qE,[(i(!0),l(le,null,fe(h.value,G=>(i(),l("li",{key:G.session_id,class:"small"},[t("strong",null,w(G.name||G.session_id),1),G.role?(i(),l("span",zE," ("+w(G.role)+")",1)):T("",!0)]))),128))])])):T("",!0)])):(i(),l("div",KE,[m.value?(i(),l("div",GE,[B[11]||(B[11]=t("strong",null,"Error:",-1)),re(" "+w(m.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:B[0]||(B[0]=G=>m.value="")})])):T("",!0),B[18]||(B[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",YE,[t("button",{class:"btn btn-outline-primary text-start",onClick:S,disabled:c.value},[...B[12]||(B[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,JE),t("button",{class:"btn btn-outline-secondary text-start",onClick:C,disabled:c.value},[...B[13]||(B[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,QE),B[16]||(B[16]=t("hr",{class:"my-2"},null,-1)),B[17]||(B[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:c.value},[...B[14]||(B[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,XE),t("button",{class:"btn btn-outline-danger text-start",onClick:v,disabled:c.value},[...B[15]||(B[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,ZE)]),B[19]||(B[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),re(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",eT,[p.value&&!c.value?(i(),l(le,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),t("button",{type:"button",class:Q(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:f},w(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?T("",!0):(i(),l("button",tT,"Cancel"))])])])],512))}},nT=oe(sT,[["__scopeId","data-v-6b832853"]]),oT={class:"modal-dialog modal-dialog-centered modal-lg"},aT={class:"modal-content"},iT={class:"modal-body"},lT={key:0,class:"text-center text-muted py-4"},rT={key:1},cT={class:"mb-3"},uT={class:"font-monospace small"},dT={class:"mb-3"},mT=["value"],fT={class:"mb-3"},pT={class:"mb-3"},vT={class:"mb-3"},hT={key:0},gT={class:"d-flex flex-wrap gap-1"},_T={key:1,class:"text-muted small"},bT={key:0,class:"mb-3"},yT={class:"d-flex flex-wrap gap-1"},wT={key:1,class:"mb-3"},$T={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},kT={class:"mb-3"},ST={class:"text-muted"},CT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},xT={__name:"SessionInfoModal",setup(n){const e=_e(),s=Ne(),o=xe(),a=R(null),r=R(!1),c=R(null);let d=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},p=g(()=>{if(!a.value)return null;const b=e.initData.get(a.value);return b||(s.messagesBySession.get(a.value)||[]).find(f=>f.type==="system"&&(f.subtype==="init"||f.metadata?.subtype==="init")&&f.metadata?.init_data)?.metadata?.init_data||null});function u(b){return b?m[b]||b:"Default (Sonnet 4.5)"}function y(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function h(b){b.target.select()}function $(){a.value=null,r.value=!1}function k(){$(),o.hideModal()}return be(()=>o.currentModal,b=>{if(b?.name==="session-info"&&d){const v=b.data||{};a.value=v.sessionId,r.value=!1,d.show()}}),Te(()=>{c.value&&Le(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(v=>v.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{d=new b(c.value),c.value.addEventListener("hidden.bs.modal",k)})}),Ae(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",k),d&&d.dispose()}),(b,v)=>(i(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",oT,[t("div",aT,[v[9]||(v[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",iT,[p.value?(i(),l("div",rT,[t("div",cT,[v[1]||(v[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",uT,w(a.value),1)]),t("div",dT,[v[2]||(v[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:h},null,8,mT)]),t("div",fT,[v[3]||(v[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,w(u(p.value.model)),1)]),t("div",pT,[v[4]||(v[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,w(p.value.permissionMode||"default"),1)]),t("div",vT,[v[5]||(v[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(i(),l("div",hT,[t("div",gT,[(i(!0),l(le,null,fe(p.value.allowed_tools||p.value.tools,_=>(i(),l("span",{key:_,class:"badge bg-secondary"},w(_),1))),128))])])):(i(),l("div",_T,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(i(),l("div",bT,[v[6]||(v[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",yT,[(i(!0),l(le,null,fe(p.value.commands,_=>(i(),l("span",{key:_,class:"badge bg-info"},w(_),1))),128))])])):T("",!0),p.value.systemPrompt?(i(),l("div",wT,[v[7]||(v[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",$T,w(y(p.value.systemPrompt)),1)])):T("",!0),t("div",kT,[t("h6",ST,[v[8]||(v[8]=re(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:v[0]||(v[0]=_=>r.value=!r.value)},w(r.value?"Hide":"Show"),1)]),r.value?(i(),l("pre",CT,w(JSON.stringify(p.value,null,2)),1)):T("",!0)])])):(i(),l("div",lT," No session configuration data available "))]),v[10]||(v[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},ET=oe(xT,[["__scopeId","data-v-b28b39b3"]]),TT={class:"modal-dialog modal-dialog-centered modal-lg"},AT={class:"modal-content"},DT={class:"modal-body"},MT={key:0,class:"text-center text-muted py-4"},OT={key:1},LT={class:"mb-3"},NT={class:"mb-3"},IT={class:"font-monospace small"},jT={class:"mb-3"},RT={class:"mb-3"},PT={class:"mb-3"},FT={key:0},BT={class:"d-flex flex-wrap gap-1"},WT={key:1,class:"text-muted small"},VT={class:"mb-3"},HT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},UT={key:1,class:"text-muted small"},qT={class:"mb-3"},zT={key:0,class:"badge bg-info"},KT={key:1,class:"badge bg-secondary"},GT={class:"mb-3"},YT={key:0,class:"font-monospace small"},JT={key:1,class:"text-muted small"},QT={key:0,class:"mb-3"},XT={key:0},ZT={class:"list-unstyled mb-0"},e2={key:1,class:"text-muted small"},t2={class:"mb-3"},s2={class:"small"},n2={class:"mb-3"},o2={class:"small"},a2={__name:"MinionViewModal",setup(n){const e=xe(),s=R(null),o=R(null);let a=null;function r(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function c(p){if(!p)return"N/A";try{const u=new Date(p);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function d(){s.value=null}function m(){d(),e.hideModal()}return be(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&a){const u=p.data||{};s.value=u.session,a.show()}}),Te(()=>{o.value&&Le(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{a=new p(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),Ae(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),a&&a.dispose()}),(p,u)=>(i(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",TT,[t("div",AT,[u[11]||(u[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",DT,[s.value?(i(),l("div",OT,[t("div",LT,[u[0]||(u[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,w(s.value.name||"Unnamed Minion"),1)]),t("div",NT,[u[1]||(u[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",IT,w(s.value.session_id),1)]),t("div",jT,[u[2]||(u[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,w(s.value.role||"Not specified"),1)]),t("div",RT,[u[3]||(u[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:Q(["badge",r(s.value.state)])},w(s.value.state),3)])]),t("div",PT,[u[4]||(u[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),l("div",FT,[t("div",BT,[(i(!0),l(le,null,fe(s.value.capabilities,y=>(i(),l("span",{key:y,class:"badge bg-secondary"},w(y),1))),128))])])):(i(),l("div",WT,"None"))]),t("div",VT,[u[5]||(u[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),l("div",HT,w(s.value.initialization_context),1)):(i(),l("div",UT,"Not specified"))]),t("div",qT,[u[6]||(u[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),l("span",zT,"Yes")):(i(),l("span",KT,"No"))])]),t("div",GT,[u[7]||(u[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),l("div",YT,w(s.value.parent_overseer_id),1)):(i(),l("div",JT," Root overseer (user-created) "))]),s.value.is_overseer?(i(),l("div",QT,[u[8]||(u[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),l("div",XT,[t("ul",ZT,[(i(!0),l(le,null,fe(s.value.child_minion_ids,y=>(i(),l("li",{key:y,class:"font-monospace small"},w(y),1))),128))])])):(i(),l("div",e2,"No children"))])):T("",!0),t("div",t2,[u[9]||(u[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",s2,w(c(s.value.created_at)),1)]),t("div",n2,[u[10]||(u[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",o2,w(c(s.value.updated_at)),1)])])):(i(),l("div",MT," No minion data available "))]),u[12]||(u[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},i2=oe(a2,[["__scopeId","data-v-d996dc6f"]]),l2={class:"modal-dialog modal-dialog-centered"},r2={class:"modal-content"},c2={class:"modal-header"},u2={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},d2={class:"modal-body"},m2={key:0},f2={key:0,class:"text-center py-3"},p2={key:1,class:"card bg-light mb-3"},v2={class:"card-body py-2 px-3"},h2={class:"small"},g2={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},_2={key:0,class:"text-warning mt-1"},b2={key:2,class:"alert alert-warning py-2 small"},y2={key:1,class:"text-center py-3"},w2={key:0,class:"mb-3"},$2={key:1,class:"mb-3"},k2={key:2,class:"mb-3"},S2={class:"text-muted small mt-1"},C2={key:3,class:"mb-3"},x2={class:"mt-2 text-danger"},E2={class:"modal-footer"},T2=["disabled"],A2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},D2={__name:"RestartModal",setup(n){const e=xe(),s=R(null);let o=null;const a=R("confirm"),r=R(!1),c=R(null),d=R(null),m=R(""),p=R(60);let u=null,y=null;async function h(){r.value=!0,d.value=null;try{c.value=await Ha()}catch(f){d.value=f.message||"Unknown error"}finally{r.value=!1}}async function $(){a.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Ua(),e.restartStatus="restarting",k()}catch(f){e.restartStatus="error",m.value=f.message||"Restart failed",e.restartInProgress=!1}}function k(){e.restartStatus="reconnecting",p.value=60;const f=Date.now();y=setInterval(()=>{const S=Math.floor((Date.now()-f)/1e3);p.value=Math.max(0,60-S)},1e3),setTimeout(()=>{u=setInterval(async()=>{try{(await fetch("/health")).ok&&(b(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-f>6e4&&(b(),e.restartStatus="error",m.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function b(){u&&(clearInterval(u),u=null),y&&(clearInterval(y),y=null)}function v(){a.value="confirm",c.value=null,d.value=null,m.value="",p.value=60,b()}function _(){e.restartInProgress||(v(),e.restartStatus="idle"),e.hideModal()}return be(()=>e.currentModal,f=>{f?.name==="restart-server"&&o&&(v(),o.show(),h())}),Te(()=>{s.value&&Le(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{o=new f(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",_)})}),Ae(()=>{b(),s.value&&s.value.removeEventListener("hidden.bs.modal",_),o&&o.dispose()}),(f,S)=>(i(),l("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",l2,[t("div",r2,[t("div",c2,[S[0]||(S[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),a.value==="confirm"?(i(),l("button",u2)):T("",!0)]),t("div",d2,[a.value==="confirm"?(i(),l("div",m2,[S[5]||(S[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),r.value?(i(),l("div",f2,[...S[1]||(S[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):c.value?(i(),l("div",p2,[t("div",v2,[t("div",h2,[t("div",null,[S[2]||(S[2]=t("strong",null,"Branch:",-1)),re(" "+w(c.value.branch),1)]),t("div",null,[S[3]||(S[3]=t("strong",null,"Last commit:",-1)),re(" "+w(c.value.last_commit_message),1)]),t("div",g2,w(c.value.last_commit_hash?.substring(0,12)),1),c.value.has_uncommitted_changes?(i(),l("div",_2,[...S[4]||(S[4]=[t("strong",null,"Warning:",-1),re(" Uncommitted changes detected. git pull may fail. ",-1)])])):T("",!0)])])])):d.value?(i(),l("div",b2," Could not fetch git status: "+w(d.value),1)):T("",!0)])):a.value==="progress"?(i(),l("div",y2,[ie(e).restartStatus==="pulling"?(i(),l("div",w2,[...S[6]||(S[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):ie(e).restartStatus==="restarting"?(i(),l("div",$2,[...S[7]||(S[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):ie(e).restartStatus==="reconnecting"?(i(),l("div",k2,[S[8]||(S[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),S[9]||(S[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",S2,w(p.value)+"s remaining",1)])):ie(e).restartStatus==="error"?(i(),l("div",C2,[S[10]||(S[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",x2,w(m.value),1)])):T("",!0)])):T("",!0)]),t("div",E2,[a.value==="confirm"?(i(),l(le,{key:0},[S[11]||(S[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:$,disabled:r.value}," Pull & Restart ",8,T2)],64)):ie(e).restartStatus==="error"?(i(),l("button",A2,"Close")):T("",!0)])])])],512))}},M2={class:"container-fluid vh-100 d-flex flex-column p-0"},O2={class:"d-flex flex-grow-1 overflow-hidden position-relative"},L2={class:"flex-grow-1 d-flex flex-column overflow-hidden"},N2={__name:"App",setup(n){const e=xe(),s=mt(),o=_e(),a=He(),r=Mt(),c=Ge(),d=Yt(),m=R(null);function p(v){m.value=v}wn("addAttachmentFromResource",p),wn("pendingResourceAttachment",m);const u=g(()=>e.sidebarCollapsed),y=g(()=>e.rightSidebarCollapsed),h=g(()=>e.isMobile);be(()=>r.currentHasTasks,(v,_)=>{v&&!_&&e.setRightSidebarCollapsed(!1)}),be(()=>c.currentHasResources,(v,_)=>{v&&!_&&e.setRightSidebarCollapsed(!1)}),Te(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const v=window.location.hash;if(v.startsWith("#/session/")){const _=v.replace("#/session/","");o.sessions.has(_)&&await o.selectSession(_)}else if(v.startsWith("#/timeline/")){const _=v.replace("#/timeline/","");d.push(`/timeline/${_}`)}window.addEventListener("popstate",$),window.addEventListener("resize",e.handleResize)}),Ae(()=>{window.removeEventListener("popstate",$),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function $(){const v=window.location.hash;if(v.startsWith("#/session/")){const _=v.replace("#/session/","");o.sessions.has(_)&&o.selectSession(_)}}function k(){e.toggleSidebar()}function b(){e.toggleRightSidebar()}return(v,_)=>{const f=bo("router-view");return i(),l("div",M2,[ye(bw),t("div",{id:"sidebar-backdrop",class:Q({show:!u.value&&h.value}),onClick:k},null,2),t("div",{id:"right-sidebar-backdrop",class:Q({show:!y.value&&h.value}),onClick:b},null,2),t("div",O2,[ye(Yw),t("main",L2,[ye(f)]),ye(CS)]),ye(VS),ye(o0),ye(x0),ye(OE),ye(nT),ye(ET),ye(i2),ye(D2)])}}},_n=Na(N2);_n.use(Ia());_n.use(dw);_n.mount("#app");
