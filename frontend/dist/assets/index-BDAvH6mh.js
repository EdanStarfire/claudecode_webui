const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as t,o as i,d as it,r as O,b as v,t as y,n as K,u as le,e as Ve,f as ce,w as fe,g as Ds,F as ne,h as ue,i as E,j as La,k as be,l as xe,v as We,m as Ce,p as wo,q as ye,s as ko,x as wt,y as De,z as Ia,A as $o,B as Me,C as xn,D as So,E as Qt,G as ja,H as Pa,I as rn,T as Ra,J as xo,K as Co,L as ct,M as ps,N as Ms,O as Cn,P as Ba,Q as Fa}from"./vue-vendor-DafFZ7vY.js";import{m as ot,p as Xt}from"./markdown-vendor-BRsjnVvP.js";import{c as Va}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();const Wa={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ua={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),l("div",Wa,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Ha="modulepreload",qa=function(n){return"/"+n},En={},Ie=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let f=function(p){return Promise.all(p.map(d=>Promise.resolve(d).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),m=u?.nonce||u?.getAttribute("nonce");a=f(s.map(p=>{if(p=qa(p),p in En)return;En[p]=!0;const d=p.endsWith(".css"),w=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Ha,d||(h.as="script"),h.crossOrigin="",h.href=p,m&&h.setAttribute("nonce",m),document.head.appendChild(h),d)return new Promise((S,k)=>{h.addEventListener("load",S),h.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(u){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=u,window.dispatchEvent(m),!m.defaultPrevented)throw u}return a.then(u=>{for(const m of u||[])m.status==="rejected"&&c(m.reason);return e().catch(c)})};class Os extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Lt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new Os(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Os?s:(console.error("API request failed:",s),new Os(`Network error: ${s.message}`,0,null))}}async function Jt(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[m,f]of Object.entries(e.params))f!=null&&o.append(m,f);const a=o.toString();a&&(s=`${n}?${a}`);const{params:c,...u}=e;return Lt(s,{...u,method:"GET"})}return Lt(s,{...e,method:"GET"})}async function Eo(n,e,s={}){return Lt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function za(n,e,s={}){return Lt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function To(n,e={}){return Lt(n,{...e,method:"DELETE"})}async function Ka(n,e,s={}){return Lt(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Ga(){return Jt("/api/system/git-status")}async function Ya(){return Eo("/api/system/restart")}const ke={get:Jt,post:Eo,put:za,delete:To,patch:Ka},pe=it("session",()=>{const n=O(new Map),e=O(null),s=O(new Map),o=O(new Map),a=O(new Set),c=O(!1);let u=null;const m=v(()=>n.value.get(e.value)),f=v(()=>Array.from(n.value.values()).sort((D,A)=>D.order-A.order)),p=D=>v(()=>f.value.filter(A=>A.project_id===D)),d=v({get:()=>s.value.get(e.value)||"",set:D=>{e.value&&s.value.set(e.value,D)}});async function w(){try{const D=await ke.get("/api/sessions");return n.value.clear(),D.sessions.forEach(A=>{n.value.set(A.session_id,A)}),console.log(`Loaded ${n.value.size} sessions`),D.sessions}catch(D){throw console.error("Failed to fetch sessions:",D),D}}async function h(D,A){try{const M=(await ke.post("/api/sessions",{project_id:D,...A})).session_id,F=(await ke.get(`/api/sessions/${M}`)).session;return n.value.set(M,F),n.value=new Map(n.value),console.log(`Created session ${M}`),F}catch(x){throw console.error("Failed to create session:",x),x}}async function S(D){if(e.value===D&&!c.value)return;u&&(console.log(`Aborting pending selection to switch to ${D}`),u.abort(),u=null);const A=new AbortController;u=A,c.value=!0;try{if(e.value=D,A.signal.aborted){console.log(`Selection of ${D} aborted early`);return}let x=n.value.get(D);if(!x)try{const U=await ke.get(`/api/sessions/${D}`);if(A.signal.aborted){console.log(`Selection of ${D} aborted after fetch`);return}x=U.session,n.value.set(D,x),n.value=new Map(n.value),console.log(`Fetched session ${D} for deeplink`)}catch(U){console.error(`Failed to fetch session ${D}:`,U);return}if(x&&(x.state==="created"||x.state==="terminated"))try{if(await r(D),A.signal.aborted){console.log(`Selection of ${D} aborted after start`);return}console.log(`Auto-started session ${D} (was in ${x.state} state)`);const U=6e4,W=200,J=5e3;let ae=0,L=0;for(;ae<U;){if(A.signal.aborted){console.log(`Selection of ${D} aborted during state wait`);return}const R=n.value.get(D);if(R&&R.state==="active"){console.log(`Session ${D} is now active after ${ae}ms`);break}if(ae-L>=J){const H=n.value.get(D)?.state||"unknown";console.log(`Waiting for session ${D} to become active (current: ${H}, ${ae/1e3}s elapsed)`),L=ae}await new Promise(H=>setTimeout(H,W)),ae+=W}const j=n.value.get(D);j&&j.state!=="active"&&console.warn(`Session ${D} did not become active within ${U/1e3}s (state: ${j.state}), continuing anyway`)}catch(U){console.error(`Failed to auto-start session ${D}:`,U)}if(A.signal.aborted){console.log(`Selection of ${D} aborted before message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>fi),void 0)).useMessageStore().loadMessages(D),A.signal.aborted){console.log(`Selection of ${D} aborted after message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>Wi),void 0)).useResourceStore().loadResources(D),A.signal.aborted){console.log(`Selection of ${D} aborted after resource load`);return}await(await Ie(()=>Promise.resolve().then(()=>Ui),void 0)).useWebSocketStore().connectSession(D),A.signal.aborted||console.log(`Selected session ${D}`)}finally{u===A&&(u=null),c.value=!1}}function k(D,A){const x=n.value.get(D);x?Object.assign(x,A):(n.value.set(D,A),console.log(`Added new session ${D} via WebSocket update`)),n.value=new Map(n.value)}async function b(D){a.value.add(D);try{const x=(await ke.delete(`/api/sessions/${D}`)).deleted_session_ids||[D];for(const M of x)n.value.delete(M),s.value.delete(M),o.value.delete(M);return n.value=new Map(n.value),x.includes(e.value)&&(e.value=null),console.log(`Deleted ${x.length} session(s): ${x.join(", ")}`),x}catch(A){throw console.error("Failed to delete session:",A),A}finally{a.value.delete(D)}}async function g(D,A){try{await ke.patch(`/api/sessions/${D}`,A),k(D,A),console.log(`Updated session ${D}:`,A)}catch(x){throw console.error("Failed to update session:",x),x}}async function _(D,A){try{await ke.post(`/api/sessions/${D}/permission-mode`,{mode:A}),k(D,{current_permission_mode:A});const x=o.value.get(D);x&&(x.permissionMode=A,o.value.set(D,x)),console.log(`Set permission mode for session ${D} to ${A}`)}catch(x){throw console.error("Failed to set permission mode:",x),x}}async function r(D){try{await ke.post(`/api/sessions/${D}/start`),console.log(`Started session ${D}`)}catch(A){throw console.error("Failed to start session:",A),A}}async function $(D){try{await ke.post(`/api/sessions/${D}/pause`),console.log(`Paused session ${D}`)}catch(A){throw console.error("Failed to pause session:",A),A}}async function C(D){try{await ke.post(`/api/sessions/${D}/terminate`),console.log(`Terminated session ${D}`)}catch(A){throw console.error("Failed to terminate session:",A),A}}function T(D){return n.value.get(D)}function N(D,A){o.value.set(D,A),A.permissionMode&&k(D,{current_permission_mode:A.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:m,orderedSessions:f,sessionsInProject:p,currentInput:d,fetchSessions:w,createSession:h,selectSession:S,updateSession:k,deleteSession:b,patchSession:g,setPermissionMode:_,startSession:r,pauseSession:$,terminateSession:C,getSession:T,storeInitData:N}}),Tn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:pe},Symbol.toStringTag,{value:"Module"})),Se=it("ui",()=>{const n=O(window.innerWidth<768),e=O(300),s=O(!0),o=O(300),a=O("comms"),c=O(window.innerWidth>1024),u=O(null),m=O(new Set),f=O(window.innerWidth),p=v(()=>f.value<768),d=O(!0),w=O(!1),h=O(null),S=O(null),k=v(()=>h.value?{name:h.value,data:S.value}:null),b=O(!1),g=O("Loading..."),_=O(!1),r=O("idle");function $(){n.value=!n.value}function C(Q){n.value=Q}function T(Q){e.value=Math.max(200,Math.min(Q,window.innerWidth*.3))}function N(){s.value=!s.value}function D(Q){s.value=Q}function A(Q){o.value=Math.max(200,Math.min(Q,window.innerWidth*.3))}function x(Q){a.value=Q}function M(Q){d.value=Q}function q(){const Q=localStorage.getItem("webui-background-color");w.value=Q==="red"}function F(){w.value=!w.value,localStorage.setItem("webui-background-color",w.value?"red":"gray")}function U(Q,he=null){h.value=null,S.value=null,setTimeout(()=>{h.value=Q,S.value=he},0)}function W(){h.value=null,S.value=null}function J(Q="Loading..."){b.value=!0,g.value=Q}function ae(){b.value=!1}function L(){U("restart-server")}function j(Q){u.value=Q}function R(Q){m.value.has(Q)?m.value.delete(Q):m.value.add(Q),m.value=new Set(m.value)}function H(){m.value.size>0&&(m.value=new Set)}function X(){c.value=!c.value}function ee(Q){c.value=Q}function _e(){const Q=f.value;f.value=window.innerWidth,f.value<768&&Q>=768?n.value=!0:f.value>=768&&Q<768&&(n.value=!1),f.value>1024?c.value=!0:f.value<=1024&&Q>1024&&(c.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:a,rightPanelVisible:c,browsingProjectId:u,expandedStacks:m,windowWidth:f,isMobile:p,autoScrollEnabled:d,isRedBackground:w,activeModal:h,modalData:S,currentModal:k,isLoading:b,loadingMessage:g,restartInProgress:_,restartStatus:r,toggleSidebar:$,setSidebarCollapsed:C,setSidebarWidth:T,toggleRightSidebar:N,setRightSidebarCollapsed:D,setRightSidebarWidth:A,setRightSidebarTab:x,setBrowsingProject:j,toggleStack:R,collapseAllStacks:H,toggleRightPanel:X,setRightPanelVisible:ee,setAutoScroll:M,initBackgroundColor:q,toggleBackgroundColor:F,showModal:U,hideModal:W,showLoading:J,hideLoading:ae,showRestartModal:L,handleResize:_e}}),Fe=it("project",()=>{const n=O(new Map),e=O(null),s=v(()=>n.value.get(e.value)),o=v(()=>Array.from(n.value.values()).sort((_,r)=>_.order-r.order));async function a(){try{const _=await ke.get("/api/projects");return n.value.clear(),_.projects.forEach(r=>{n.value.set(r.project_id,r)}),console.log(`Loaded ${n.value.size} projects`),_.projects}catch(_){throw console.error("Failed to fetch projects:",_),_}}async function c(_,r){try{const C=(await ke.post("/api/projects",{name:_,working_directory:r})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch($){throw console.error("Failed to create project:",$),$}}async function u(_,r){try{await ke.put(`/api/projects/${_}`,r),m(_,r),console.log(`Updated project ${_}`,r)}catch($){throw console.error("Failed to update project:",$),$}}function m(_,r){const $=n.value.get(_);$&&(Object.assign($,r),n.value=new Map(n.value))}async function f(_){try{await ke.delete(`/api/projects/${_}`),n.value.delete(_),n.value=new Map(n.value),e.value===_&&(e.value=null),console.log(`Deleted project ${_}`)}catch(r){throw console.error("Failed to delete project:",r),r}}async function p(_){try{const r=await ke.put(`/api/projects/${_}/toggle-expansion`),$=n.value.get(_);return $&&($.is_expanded=r.is_expanded,n.value=new Map(n.value)),r.is_expanded}catch(r){throw console.error("Failed to toggle expansion:",r),r}}async function d(_){try{await ke.put("/api/projects/reorder",{project_ids:_}),_.forEach((r,$)=>{const C=n.value.get(r);C&&(C.order=$)}),n.value=new Map(n.value),console.log("Reordered projects",_)}catch(r){throw console.error("Failed to reorder projects:",r),r}}async function w(_,r){try{await ke.put(`/api/projects/${_}/sessions/reorder`,{session_ids:r});const $=n.value.get(_);$&&($.session_ids=r,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${_}`,r)}catch($){throw console.error("Failed to reorder sessions:",$),$}}function h(_,r){const $=n.value.get(_);return!$||!$.session_ids||$.session_ids.length===0?[{status:"none",flex:1}]:$.session_ids.map(C=>{const T=r.getSession(C);if(!T)return{status:"none",flex:1};let N="none";return T.state==="active"&&T.is_processing?N="active":T.state==="active"?N="idle":T.state==="paused"?N="waiting":T.state==="error"&&(N="error"),{status:N,flex:1}})}function S(_){return n.value.get(_)}function k(_){e.value=_}function b(){e.value=null}function g(_){if(!_)return"";const r=_.split(/[/\\]/).filter($=>$);return r.length===0?"/":r.length===1?`/${r[0]}`:r.length===2?`/${r.join("/")}`:`.../${r.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:a,createProject:c,updateProject:u,updateProjectLocal:m,deleteProject:f,toggleExpansion:p,reorderProjects:d,reorderSessionsInProject:w,getProject:S,getStatusBarSegments:h,selectProject:k,clearProjectSelection:b,formatPath:g}}),se=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},Ja={class:"project-name"},Qa=["title"],Xa={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=Fe(),a=Se(),c=v(()=>s.sessions.get(e.sessionId)),u=v(()=>c.value?.name||e.sessionId),m=v(()=>{for(const p of o.projects.values())if(p.session_ids?.includes(e.sessionId))return p;return null}),f=v(()=>m.value?.name||"Unknown Project");return(p,d)=>(i(),l("div",{class:K(["session-header border-bottom p-3",{"theme-red-panel":le(a).isRedBackground}])},[t("div",Ja,y(f.value),1),t("div",{class:"session-name",title:n.sessionId},y(u.value),9,Qa)],2))}},Za=se(Xa,[["__scopeId","data-v-ba771dd8"]]),ei={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},ti=["title"],si={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},ni={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=v(()=>s.sessions.get(e.sessionId)),a=v(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),c=v(()=>{const f=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[f]||"#d3d3d3"}),u=v(()=>{const f=a.value;return f==="starting"||f==="processing"||f==="pending-prompt"}),m=v(()=>{if(!o.value)return"No session selected";const f=a.value,p=f.charAt(0).toUpperCase()+f.slice(1).replace("-"," "),d=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${d}${w}: ${p}`});return(f,p)=>(i(),l("div",ei,[o.value?(i(),l("div",{key:0,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":u.value}]),style:Ve({width:"100%",backgroundColor:c.value}),title:m.value},null,14,ti)):(i(),l("div",si))]))}},oi=se(ni,[["__scopeId","data-v-63d222fe"]]),ai={class:"d-flex justify-content-between align-items-center gap-2"},ii={class:"d-flex gap-2"},li=["disabled"],ri={class:"mode-label"},ci=["disabled"],ui=["disabled"],di={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=Se(),a=v(()=>s.sessions.get(e.sessionId)),c=v(()=>a.value?.current_permission_mode||"default"),u={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},m=v(()=>u[c.value]||"ðŸ”’"),f=v(()=>c.value),p=["default","acceptEdits","plan"],d=async()=>{if(!a.value)return;if(c.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(_){console.error("Failed to cycle permission mode:",_)}return}const b=(p.indexOf(c.value)+1)%p.length,g=p[b];try{await s.setPermissionMode(e.sessionId,g)}catch(_){console.error("Failed to cycle permission mode:",_)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:a.value})},S=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(k,b)=>(i(),l("div",{class:K(["session-status-bar border-top p-2",le(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ai,[t("div",ii,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!a.value},[ce(y(m.value)+" ",1),t("span",ri,y(f.value),1)],8,li),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!a.value},[...b[0]||(b[0]=[ce(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,ci),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!a.value},[...b[1]||(b[1]=[ce(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,ui)]),t("div",null,[t("button",{class:K(["btn btn-sm",le(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:S}," â¬‡ï¸ "+y(le(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},mi=se(di,[["__scopeId","data-v-ed9a4d3c"]]),Nt=it("task",()=>{const n=O(new Map),e=O(new Set);function s(r){const $=n.value.get(r);return $?Array.from($.values()).sort((C,T)=>{const N=parseInt(C.id.replace(/\D/g,""))||0,D=parseInt(T.id.replace(/\D/g,""))||0;return N-D}):[]}function o(r){return s(r).find(C=>C.status==="in_progress")||null}function a(r){const $=s(r);return{total:$.length,completed:$.filter(C=>C.status==="completed").length,inProgress:$.filter(C=>C.status==="in_progress").length,pending:$.filter(C=>C.status==="pending").length}}function c(r){return e.value.has(r)}const u=v(()=>{const r=pe();return s(r.currentSessionId)}),m=v(()=>{const r=pe();return o(r.currentSessionId)}),f=v(()=>{const r=pe();return a(r.currentSessionId)}),p=v(()=>{const r=pe();return c(r.currentSessionId)});function d(r,$){n.value.has(r)||n.value.set(r,new Map),n.value.get(r).set($.id,{id:$.id,subject:$.subject||"",description:$.description||"",status:$.status||"pending",activeForm:$.activeForm||null,owner:$.owner||null,blocks:$.blocks||[],blockedBy:$.blockedBy||[],metadata:$.metadata||{}}),e.value.add(r),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${$.id} for session ${r}`)}function w(r,$,C){const T=n.value.get(r);if(!T){console.warn(`No tasks found for session ${r}`);return}const N=T.get($);if(!N){d(r,{id:$,...C});return}C.subject!==void 0&&(N.subject=C.subject),C.description!==void 0&&(N.description=C.description),C.status!==void 0&&(N.status=C.status),C.activeForm!==void 0&&(N.activeForm=C.activeForm),C.owner!==void 0&&(N.owner=C.owner),C.metadata!==void 0&&(N.metadata={...N.metadata,...C.metadata}),C.addBlocks&&(N.blocks=[...new Set([...N.blocks,...C.addBlocks])]),C.addBlockedBy&&(N.blockedBy=[...new Set([...N.blockedBy,...C.addBlockedBy])]),C.status==="deleted"&&(T.delete($),T.size===0&&(e.value.delete(r),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${$} for session ${r}`,C)}function h(r,$){return n.value.get(r)?.get($)||null}function S(r){n.value.delete(r),e.value.delete(r),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${r}`)}function k(r,$){n.value.has(r)&&n.value.get(r).clear(),e.value.delete(r);const C=new Map;for(const T of $){if(T.metadata?.tool_uses)for(const N of T.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(N.name)&&C.set(N.id,{name:N.name,input:N.input});if(T.metadata?.tool_results)for(const N of T.metadata.tool_results){const D=C.get(N.tool_use_id);D&&(b(r,D.name,D.input,{error:N.is_error,content:N.content}),C.delete(N.tool_use_id))}}console.log(`Reconstructed ${n.value.get(r)?.size||0} tasks for session ${r}`)}function b(r,$,C,T){if(T?.error){console.log(`Skipping task update - tool ${$} returned error`);return}const N=g(T);if(N)switch($){case"TaskCreate":{const D=_(N)||C?.id;D&&d(r,{id:D,subject:C?.subject||"",description:C?.description||"",status:"pending",activeForm:C?.activeForm||null,owner:C?.owner||null,blocks:[],blockedBy:[],metadata:C?.metadata||{}});break}case"TaskUpdate":{const D=C?.taskId;D&&w(r,D,{status:C?.status,subject:C?.subject,description:C?.description,activeForm:C?.activeForm,owner:C?.owner,metadata:C?.metadata,addBlocks:C?.addBlocks,addBlockedBy:C?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{C?.taskId;break}}}function g(r){return r?typeof r=="string"?r:r.content?typeof r.content=="string"?r.content:JSON.stringify(r.content):r.message?r.message:JSON.stringify(r):null}function _(r){if(!r)return null;const $=r.match(/[Tt]ask\s*#(\d+)/i);if($)return $[1];const C=r.match(/#(\d+)/);return C?C[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:u,currentActiveTask:m,currentTaskStats:f,currentHasTasks:p,tasksForSession:s,activeTask:o,taskStats:a,hasTasks:c,getTask:h,createTask:d,updateTask:w,clearTasks:S,reconstructFromMessages:k,handleTaskToolResult:b}}),je=it("message",()=>{const n=O(new Map),e=O(new Map),s=O(new Map),o=O(new Map),a=O(new Map),c=O(new Map),u=O(new Map),m=O(new Map),f=v(()=>{const L=pe();return n.value.get(L.currentSessionId)||[]}),p=v(()=>{const L=pe();return e.value.get(L.currentSessionId)||[]});async function d(L,j=null,R=0){try{const H=j||1e4,X=await ke.get(`/api/sessions/${L}/messages?limit=${H}&offset=${R}`),ee=X.messages||[],_e=X.total_count||ee.length,Q=X.has_more||!1;if(console.log(`Loaded ${ee.length} of ${_e} messages for session ${L}`),n.value.set(L,ee),ee.length>0){const I=ee[ee.length-1];I.timestamp&&(u.value.set(L,I.timestamp),console.log(`Tracked last received timestamp for session ${L}: ${I.timestamp}`))}const he=new Set;ee.forEach(I=>{I.type==="assistant"&&I.metadata?.tool_uses&&I.metadata.tool_uses.forEach(V=>{he.add(V.id)}),I.type==="user"&&I.metadata?.tool_results&&I.metadata.tool_results.forEach(V=>{he.delete(V.tool_use_id);const Z=c.value.get(L);Z&&Z.delete(V.tool_use_id)}),I.type==="system"&&I.metadata?.subtype==="client_launched"&&(he.forEach(V=>{x(L,V,"Session was restarted")}),he.clear()),I.type==="system"&&I.metadata?.subtype==="interrupt"&&(he.forEach(V=>{x(L,V,"Session was interrupted")}),he.clear()),I.metadata?.has_tool_uses&&I.metadata.tool_uses&&I.metadata.tool_uses.forEach(V=>{b(L,V,I.timestamp)}),I.metadata?.has_tool_results&&I.metadata.tool_results&&I.metadata.tool_results.forEach(V=>{$(L,V)}),(I.type==="permission_request"||I.metadata?.has_permission_requests)&&g(L,I),I.type==="permission_response"&&_(L,{request_id:I.metadata?.request_id,decision:I.metadata?.decision,updated_input:I.metadata?.updated_input,reasoning:I.metadata?.reasoning,applied_updates:I.metadata?.applied_updates}),I.type==="system"&&(I.subtype==="init"||I.metadata?.subtype==="init")&&I.metadata?.init_data&&pe().storeInitData(L,I.metadata.init_data)});const P=pe().sessions.get(L);P&&!["active","paused","starting"].includes(P.state)&&(he.forEach(I=>{x(L,I,"Session was terminated")}),he.clear()),a.value.set(L,he),n.value=new Map(n.value);try{Nt().reconstructFromMessages(L,ee)}catch(I){console.warn("Failed to reconstruct task state:",I)}return Q&&console.warn(`Warning: Only loaded ${ee.length} of ${_e} messages. Some messages may be missing.`),{messages:ee,totalCount:_e,hasMore:Q}}catch(H){throw console.error("Failed to load messages:",H),H}}function w(L,j){const R=a.value.get(L)||new Set;j.type==="assistant"&&j.metadata?.tool_uses&&j.metadata.tool_uses.forEach(H=>{R.add(H.id)}),j.type==="user"&&j.metadata?.tool_results&&j.metadata.tool_results.forEach(H=>{R.delete(H.tool_use_id);const X=c.value.get(L);X&&X.delete(H.tool_use_id)}),j.type==="system"&&j.metadata?.subtype==="client_launched"&&(R.forEach(H=>{x(L,H,"Session was restarted")}),R.clear()),j.type==="system"&&j.metadata?.subtype==="interrupt"&&(R.forEach(H=>{x(L,H,"Session was interrupted")}),R.clear()),a.value.set(L,R)}function h(L,j){n.value.has(L)||n.value.set(L,[]);const R=n.value.get(L);if(j.id){const H=R.findIndex(X=>X.id===j.id);if(H!==-1){console.log(`Skipping duplicate message ${j.id} (already exists at index ${H})`);return}}R.push(j),j.timestamp&&u.value.set(L,j.timestamp),N(L,j),w(L,j),n.value=new Map(n.value)}function S(L,j){e.value.has(L)||e.value.set(L,[]),e.value.get(L).push(j),e.value=new Map(e.value)}function k(L,j,R){const H=e.value.get(L);if(H){const X=H.find(ee=>ee.id===j);X&&(Object.assign(X,R),e.value=new Map(e.value))}}function b(L,j,R=null){const H=T(j.name,j.input);s.value.set(H,j.id);const X={id:j.id,name:j.name,input:j.input,signature:H,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:R||new Date().toISOString(),isExpanded:!0};return S(L,X),console.log(`Created tool call ${X.id} for ${X.name}`),X}function g(L,j){console.log("handlePermissionRequest received:",j);const R=j.metadata?.tool_name||j.tool_name,H=j.metadata?.input_params||j.input_params,X=j.metadata?.request_id||j.request_id,ee=j.metadata?.suggestions||j.suggestions||[];console.log("Extracted data:",{toolName:R,inputParams:H,requestId:X,suggestions:ee});const _e=T(R,H),Q=s.value.get(_e);Q?(o.value.set(X,Q),k(L,Q,{status:"permission_required",permissionRequestId:X,suggestions:ee}),console.log(`Permission required for tool ${Q}`,{suggestions:ee})):console.warn("No tool use ID found for permission request signature:",_e,{toolName:R,inputParams:H,availableSignatures:Array.from(s.value.keys())})}function _(L,j){const R=o.value.get(j.request_id);if(R){const H={permissionDecision:j.decision,appliedUpdates:j.applied_updates||[]};j.decision==="allow"?(H.status="executing",H.backendStatus="running"):(H.status="completed",H.backendStatus="denied",H.result={error:!0,message:j.reasoning||"Permission denied"},H.isExpanded=!1),j.updated_input&&(H.input=j.updated_input),k(L,R,H),console.log(`Permission ${j.decision} for tool ${R}`)}}function r(L,j){console.log("handleToolCall received:",j);const R=j.tool_use_id;if(!R){console.warn("Received tool_call without tool_use_id:",j);return}e.value.has(L)||e.value.set(L,[]);const H=e.value.get(L),X=H.findIndex(Q=>Q.id===R),_e={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[j.status]||j.status;if(X!==-1){const Q=H[X];Q.status=_e,Q.backendStatus=j.status,j.permission&&(Q.suggestions=j.permission.suggestions||[],Q.permissionRequestId=j.request_id),j.permission_granted!==null&&j.permission_granted!==void 0&&(Q.permissionDecision=j.permission_granted?"allow":"deny"),j.result!==void 0&&(Q.result={error:j.status==="failed",content:j.result}),j.error&&(Q.result={error:!0,content:j.error}),j.status==="denied"&&(Q.result={error:!0,message:"Permission denied"},Q.isExpanded=!1),j.status==="interrupted"&&(x(L,R,"Session was interrupted"),Q.isExpanded=!1),(j.status==="completed"||j.status==="failed")&&(Q.isExpanded=!1),j.display&&(Q.backendState=j.display),console.log(`Updated tool call ${R} to status: ${_e} (backend: ${j.status})`)}else{const Q=T(j.name,j.input);s.value.set(Q,R);const he={id:R,name:j.name,input:j.input,signature:Q,status:_e,backendStatus:j.status,permissionRequestId:j.request_id,permissionDecision:j.permission_granted!==void 0?j.permission_granted?"allow":"deny":null,suggestions:j.permission?.suggestions||[],result:j.result?{error:j.status==="failed",content:j.result}:null,explanation:null,timestamp:j.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(j.status),backendState:j.display};j.error&&(he.result={error:!0,content:j.error}),H.push(he),console.log(`Created new tool call ${R} for ${j.name} with status: ${_e}`)}if(e.value=new Map(e.value),["completed","failed"].includes(j.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(j.name))try{Nt().handleTaskToolResult(L,j.name,j.input,{error:j.status==="failed",content:j.result})}catch(Q){console.warn("Failed to update task store:",Q)}}function $(L,j){const R=j.tool_use_id;k(L,R,{status:j.is_error?"error":"completed",result:{error:j.is_error,content:j.content},isExpanded:!1}),console.log(`Tool ${R} ${j.is_error?"failed":"completed"}`);const H=e.value.get(L);if(H){const X=H.find(ee=>ee.id===R);if(X&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(X.name))try{Nt().handleTaskToolResult(L,X.name,X.input,{error:j.is_error,content:j.content})}catch(ee){console.warn("Failed to update task store:",ee)}}}function C(L,j){const R=e.value.get(L);if(R){const H=R.find(X=>X.id===j);H&&(H.isExpanded=!H.isExpanded,e.value=new Map(e.value))}}function T(L,j){if(!L)return"unknown:{}";if(!j||typeof j!="object")return`${L}:{}`;const R=JSON.stringify(j,Object.keys(j).sort());return`${L}:${R}`}function N(L,j){const R=j.metadata?.display||j.display;if(!R)return;m.value.has(L)||m.value.set(L,new Map);const H=m.value.get(L);if(R.tool_states)for(const[X,ee]of Object.entries(R.tool_states)){H.set(X,ee);const _e=e.value.get(L);if(_e){const Q=_e.find(he=>he.id===X);if(Q){const he={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Q.status=he[ee.state]||ee.state,Q.backendState=ee}}}if(R.orphaned_tools&&R.orphaned_tools.length>0){const X=c.value.get(L)||new Map;for(const ee of R.orphaned_tools)X.has(ee)||X.set(ee,{reason:"denied",message:"Session was interrupted"});c.value.set(L,X)}if(R.linked_permissions)for(const[X,ee]of Object.entries(R.linked_permissions))o.value.set(X,ee);R.tool_states&&Object.keys(R.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${L}:`,{toolStates:Object.keys(R.tool_states||{}).length,orphanedTools:(R.orphaned_tools||[]).length,linkedPermissions:Object.keys(R.linked_permissions||{}).length})}function D(L,j){return m.value.get(L)?.get(j)}function A(L){const j=m.value.get(L);return j&&j.size>0}function x(L,j,R){const H=c.value.get(L)||new Map;H.set(j,{reason:"denied",message:R}),c.value.set(L,H);const X=e.value.get(L);if(X){const ee=X.find(_e=>_e.id===j);ee&&ee.isExpanded&&(ee.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${j} as orphaned: ${R}`)}function M(L,j){const R=D(L,j);return R&&R.state==="orphaned"?!0:c.value.get(L)?.has(j)||!1}function q(L,j){const R=D(L,j);return R&&R.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:R}:c.value.get(L)?.get(j)}function F(L,j){const R=a.value.get(L);R&&R.size>0&&(R.forEach(H=>x(L,H,j)),R.clear())}function U(L){n.value.delete(L),e.value.delete(L),n.value=new Map(n.value),e.value=new Map(e.value)}function W(L){return u.value.get(L)}async function J(L){const j=u.value.get(L);if(!j)return console.log(`No sync needed for session ${L} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${L} since ${j}`);const R=await ke.get(`/api/sessions/${L}/messages?limit=1000&offset=0`),H=R.messages||[],X=R.has_more||!1,ee=V=>V?typeof V=="number"?V*1e3:new Date(V).getTime():0,_e=ee(j),Q=H.filter(V=>V.timestamp?ee(V.timestamp)>_e:!1);if(Q.length===0)return console.log(`No missed messages for session ${L}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Q.length} missed messages for session ${L}`);const he=n.value.get(L)||[],z=new Set(he.map(V=>V.id).filter(Boolean)),P=Q.filter(V=>!V.id||!z.has(V.id));if(console.log(`After deduplication: ${P.length} unique new messages`),P.length>0){const V=P.sort((Y,re)=>{const ve=ee(Y.timestamp),ge=ee(re.timestamp);return ve-ge}),Z=n.value.get(L)||[],oe=Z.length>0?ee(Z[Z.length-1].timestamp):0,$e=ee(V[0].timestamp),Ge=ee(V[V.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Z.length,lastExisting:oe,lastExistingDate:Z.length>0?Z[Z.length-1].timestamp:"none",firstNew:$e,firstNewDate:V[0].timestamp,lastNew:Ge,lastNewDate:V[V.length-1].timestamp,shouldAppend:$e>oe}),$e>oe){const Y=[...Z,...V];n.value.set(L,Y),console.log(`âœ… Appended ${V.length} new messages (no full sort needed)`)}else{const Y=[...Z,...V].sort((re,ve)=>{const ge=ee(re.timestamp),Ee=ee(ve.timestamp);return ge-Ee});n.value.set(L,Y),console.log(`âš ï¸ Merged and sorted ${V.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${he.length} messages unchanged`);P.forEach(V=>{w(L,V),V.metadata?.has_tool_uses&&V.metadata.tool_uses&&V.metadata.tool_uses.forEach(Z=>{b(L,Z,V.timestamp)}),V.metadata?.has_tool_results&&V.metadata.tool_results&&V.metadata.tool_results.forEach(Z=>{$(L,Z)}),(V.type==="permission_request"||V.metadata?.has_permission_requests)&&g(L,V),V.type==="permission_response"&&_(L,{request_id:V.metadata?.request_id,decision:V.metadata?.decision,updated_input:V.metadata?.updated_input,reasoning:V.metadata?.reasoning,applied_updates:V.metadata?.applied_updates}),V.type==="system"&&(V.subtype==="init"||V.metadata?.subtype==="init")&&V.metadata?.init_data&&pe().storeInitData(L,V.metadata.init_data)});const I=n.value.get(L);if(I&&I.length>0){const V=I[I.length-1];V.timestamp&&u.value.set(L,V.timestamp)}return n.value=new Map(n.value),{syncedCount:P.length,hasMore:X}}catch(R){return console.error(`Failed to sync messages for session ${L}:`,R),{syncedCount:0,hasMore:!1,error:R.message}}}const ae=pe();return fe(()=>Array.from(ae.sessions.values()).map(j=>({id:j.session_id,state:j.state})),(L,j)=>{j&&L.forEach((R,H)=>{const X=j[H];if(!X||X.id!==R.id)return;const ee=["active","paused","starting"].includes(X.state),_e=!["active","paused","starting"].includes(R.state);ee&&_e&&F(R.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:Ds(a),orphanedToolUses:Ds(c),currentMessages:f,currentToolCalls:p,loadMessages:d,addMessage:h,addToolCall:S,updateToolCall:k,handleToolCall:r,handleToolUse:b,handlePermissionRequest:g,handlePermissionResponse:_,handleToolResult:$,toggleToolExpansion:C,clearMessages:U,markToolUseOrphaned:x,isToolUseOrphaned:M,getOrphanedInfo:q,clearOrphanedToolUses:F,getLastReceivedTimestamp:W,syncMessages:J,getBackendToolState:D,hasBackendDisplayMetadata:A,backendToolStates:Ds(m)}}),fi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:je},Symbol.toStringTag,{value:"Module"}));function pi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function bs(n){return pi(n).toLocaleTimeString()}const vi={class:"message-row message-row-user"},_i=["title"],hi={class:"message-content-column"},gi=["innerHTML"],bi={key:0,class:"tool-results mt-2"},yi={class:"tool-results-header text-muted small mb-2"},wi={class:"d-flex align-items-start gap-2"},ki={class:"flex-grow-1"},$i={class:"text-muted"},Si={key:0,class:"text-danger small"},xi={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;ot.setOptions({breaks:!0,gfm:!0});const s=v(()=>bs(e.message.timestamp)),o=v(()=>`user
${s.value}`),a=v(()=>{const f=e.message.content||"";let p=ot.parse(f);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Xt.sanitize(p)}),c=v(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),u=v(()=>e.message.metadata?.tool_results||[]);function m(f,p){return f?f.length<=p?f:f.substring(0,p)+"...":""}return(f,p)=>(i(),l("div",vi,[t("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,_i),t("div",hi,[t("div",{class:"message-text",innerHTML:a.value},null,8,gi),c.value?(i(),l("div",bi,[t("div",yi," ðŸ”§ Tool Results ("+y(u.value.length)+") ",1),(i(!0),l(ne,null,ue(u.value,(d,w)=>(i(),l("div",{key:w,class:K(["tool-result-summary p-2 mb-2 rounded",d.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",wi,[t("span",null,y(d.is_error?"âŒ":"âœ…"),1),t("div",ki,[t("small",$i,"Tool: "+y(d.tool_use_id),1),d.is_error?(i(),l("div",Si,y(m(d.content,200)),1)):E("",!0)])])],2))),128))])):E("",!0)])]))}},Ci=se(xi,[["__scopeId","data-v-7665755b"]]),Ei={class:"thinking-block"},Ti=["aria-label"],Ai={class:"text-muted ms-auto"},Di={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Mi=["innerHTML"],Oi={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=O(!1),o=v(()=>e.thinking?.length||0),a=v(()=>{const u=e.thinking||"",m=ot.parse(u);return Xt.sanitize(m)});function c(){s.value=!s.value}return(u,m)=>(i(),l("div",Ei,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:c},[t("span",{"aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,Ti),m[0]||(m[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Ai,y(o.value)+" characters",1)]),s.value?(i(),l("div",Di,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,Mi)])):E("",!0)]))}},Ni=se(Oi,[["__scopeId","data-v-fda2352c"]]);function An(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function Li(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Dn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Ii(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=Li(s.command),a=Dn(o,60);return`${e}: ${a}`}case"SlashCommand":return`SlashCommand: ${Dn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=An(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",a=s.description||"Task",c=a.length>40?a.substring(0,40)+"...":a;return`Task: (${o}) ${c}`}case"Grep":case"Glob":{const o=s.pattern||"",a=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${a}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const a=s.query||"";return`WebSearch: ${a.length>40?a.substring(0,40)+"...":a}`}let o="";try{const a=s.url||"";a&&(o=new URL(a.startsWith("http")?a:`https://${a}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${An(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const ji=["title"],Pi={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){La(h=>({v7e7255c8:f.value}));const s=n,o=je(),a=pe(),c=O(!1),u=v(()=>{const h=a.currentSessionId;return h?s.tool.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[s.tool.backendStatus]||s.tool.backendStatus:o.isToolUseOrphaned(h,s.tool.id)?"orphaned":s.tool.status:s.tool.status}),m=v(()=>s.tool.result?.error||s.tool.status==="error"||s.tool.permissionDecision==="deny"),f=v(()=>{switch(u.value){case"completed":return m.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#eab308";case"permission_required":return"#f97316";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}),p=v(()=>({"node-expanded":s.isExpanded,"node-running":u.value==="executing","node-permission":u.value==="permission_required"})),d=v(()=>({"dot-running":u.value==="executing","dot-permission":u.value==="permission_required","dot-error":u.value==="error"||u.value==="completed"&&m.value})),w=v(()=>{const h=Ii(s.tool),S={completed:m.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[u.value]||u.value;return`${h} [${S}]`});return e({statusColor:f,effectiveStatus:u}),(h,S)=>(i(),l("div",{class:K(["timeline-node",p.value]),title:w.value,onClick:S[0]||(S[0]=be(k=>h.$emit("click"),["stop"])),onMouseenter:S[1]||(S[1]=k=>c.value=!0),onMouseleave:S[2]||(S[2]=k=>c.value=!1)},[t("div",{class:K(["node-dot",d.value])},null,2)],42,ji))}},Ri=se(Pi,[["__scopeId","data-v-ac79953f"]]),Bi={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"}},setup(n){const e=n,s=v(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(o,a)=>(i(),l("div",{class:"timeline-segment",style:Ve(s.value)},null,4))}},Fi=se(Bi,[["__scopeId","data-v-40450ab2"]]),Mn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Ns={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Qe=it("resource",()=>{const n=O(new Map),e=O(!1),s=O(0),o=O(null),a=O(!1),c=O(new Map);function u(Y){if(!Y)return!1;if(Y.is_image===!0||(Y.mime_type||"").toLowerCase().startsWith("image/"))return!0;const ve=(Y.format||"").toLowerCase();if(ve.startsWith("image/")||Mn.has("."+ve))return!0;const ge=Y.original_filename||Y.original_name||"";if(ge){const Ee="."+ge.split(".").pop().toLowerCase();return Mn.has(Ee)}return!1}function m(Y){if(!Y||u(Y))return!1;const re=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),ve=Y.original_filename||Y.original_name||"";if(ve){const Ee="."+ve.split(".").pop().toLowerCase();if(re.has(Ee))return!0}const ge=(Y.mime_type||Y.format||"").toLowerCase();return!!(ge.startsWith("text/")||ge==="application/json"||ge==="application/xml")}function f(Y){if(u(Y))return"ðŸ–¼ï¸";if(Y.original_filename){const re="."+Y.original_filename.split(".").pop().toLowerCase();return Ns[re]||Ns.default}return Ns.default}function p(Y){return Y.original_filename?"."+Y.original_filename.split(".").pop().toLowerCase():""}function d(Y){const re=n.value.get(Y);return re||[]}function w(Y){return n.value.get(Y)?.length||0}function h(Y){return w(Y)>0}function S(Y){return d(Y).filter(u)}function k(Y){return S(Y).length}function b(Y){return k(Y)>0}const g=v(()=>{const Y=pe();return d(Y.currentSessionId)}),_=v(()=>{const Y=pe();return w(Y.currentSessionId)}),r=v(()=>_.value>0),$=v(()=>g.value.filter(u)),C=v(()=>$.value.length),T=v(()=>C.value>0),N=v(()=>!e.value||!o.value?null:d(o.value)[s.value]||null),D=N,A=v(()=>o.value?w(o.value):0),x=A;async function M(Y){if(Y){a.value=!0;try{const ve=(await Jt(`/api/sessions/${Y}/resources`)).resources||[];ve.sort((ge,Ee)=>(ge.timestamp||0)-(Ee.timestamp||0)),n.value.set(Y,ve),n.value=new Map(n.value),console.log(`Loaded ${ve.length} resources for session ${Y}`)}catch(re){console.error(`Failed to load resources for session ${Y}:`,re),n.value.set(Y,[]),n.value=new Map(n.value)}finally{a.value=!1}}}const q=M;function F(Y,re){if(!Y||!re)return;let ve=n.value.get(Y);ve||(ve=[],n.value.set(Y,ve));const ge=ve.findIndex(Ee=>Ee.resource_id===re.resource_id);ge>=0?ve[ge]=re:ve.push(re),ve.sort((Ee,tt)=>(Ee.timestamp||0)-(tt.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${re.resource_id} to session ${Y}`)}const U=F;function W(Y,re){return`/api/sessions/${Y}/resources/${re}`}const J=W;function ae(Y,re){return`/api/sessions/${Y}/resources/${re}/download`}function L(Y,re=0){o.value=Y,s.value=Math.max(0,Math.min(re,w(Y)-1)),e.value=!0}function j(){e.value=!1}function R(){if(!o.value)return;const Y=w(o.value);Y!==0&&(s.value=(s.value+1)%Y)}const H=R;function X(){if(!o.value)return;const Y=w(o.value);Y!==0&&(s.value=(s.value-1+Y)%Y)}const ee=X;function _e(Y){if(!o.value)return;const re=w(o.value);re!==0&&(s.value=Math.max(0,Math.min(Y,re-1)))}const Q=_e;function he(Y){n.value.delete(Y),n.value=new Map(n.value),o.value===Y&&j(),console.log(`Cleared resources for session ${Y}`)}const z=he;async function P(Y,re){if(!(!Y||!re))try{await To(`/api/sessions/${Y}/resources/${re}`),V(Y,re)}catch(ve){console.error(`Failed to remove resource ${re}:`,ve)}}function I(Y,re){V(Y,re)}function V(Y,re){const ve=n.value.get(Y);if(!ve)return;const ge=ve.findIndex(Ee=>Ee.resource_id===re);ge!==-1&&(ve.splice(ge,1),n.value=new Map(n.value),e.value&&o.value===Y&&(ve.length===0?j():s.value>=ve.length&&(s.value=ve.length-1)),c.value.delete(re),c.value=new Map(c.value))}async function Z(Y,re){if(!Y||!re)return null;const ve=c.value.get(re);if(ve&&!ve.error)return ve.content;c.value.set(re,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const ge=W(Y,re),Ee=await fetch(ge);if(!Ee.ok)throw new Error(`HTTP ${Ee.status}`);const tt=await Ee.text();return c.value.set(re,{content:tt,loading:!1,error:null}),c.value=new Map(c.value),tt}catch(ge){return console.error(`Failed to fetch text content for resource ${re}:`,ge),c.value.set(re,{content:null,loading:!1,error:ge.message}),c.value=new Map(c.value),null}}function oe(Y){return c.value.get(Y)||null}function $e(Y){if(Y){const re=n.value.get(Y);re&&(re.forEach(ve=>c.value.delete(ve.resource_id)),c.value=new Map(c.value))}else c.value=new Map}function Ge(Y,re){const ve=n.value.get(Y);return ve&&ve.find(ge=>ge.resource_id===re)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:a,textContentCache:c,currentResources:g,currentResourceCount:_,currentHasResources:r,currentFullViewResource:N,fullViewTotalResources:A,currentImages:$,currentImageCount:C,currentHasImages:T,currentFullViewImage:D,fullViewTotalImages:x,imagesBySession:n,resourcesForSession:d,resourceCount:w,hasResources:h,getResourceUrl:W,getDownloadUrl:ae,isImageResource:u,isTextResource:m,getResourceIcon:f,getResourceExtension:p,getResourceById:Ge,getTextContent:oe,imagesForSession:S,imageCount:k,hasImages:b,getImageUrl:J,loadResources:M,addResource:F,removeResource:P,handleResourceRemoved:I,openFullView:L,closeFullView:j,nextResource:R,prevResource:X,goToResource:_e,clearResources:he,fetchTextContent:Z,clearTextCache:$e,loadImages:q,addImage:U,nextImage:H,prevImage:ee,goToImage:Q,clearImages:z}}),Vi=Qe,Wi=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Vi,useResourceStore:Qe},Symbol.toStringTag,{value:"Module"})),ft=it("websocket",()=>{const n=O(null),e=O(!1),s=O(0),o=10,a=O(null),c=O(!1),u=O(0),m=5,f=O(null);let p=null;const d=O(0),w=O(null),h=O(new Map),S=O(null),k=O(!1),b=O(0),g=5,_=O(null),r=1e4,$=1e3,C=O(Date.now()),T=O(Date.now()),N=O(Date.now());let D=null,A=null,x=null;const M=v(()=>e.value&&(c.value||!f.value)?"connected":e.value?"partial":"disconnected");function q(P){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${P}`}function F(P){const I={ui:{timer:()=>D,setTimer:V=>{D=V},lastPing:C,connected:e,name:"UI"},session:{timer:()=>A,setTimer:V=>{A=V},lastPing:T,connected:c,name:"Session"},legion:{timer:()=>x,setTimer:V=>{x=V},lastPing:N,connected:k,name:"Legion"}}[P];I.timer()&&clearInterval(I.timer()),I.setTimer(setInterval(()=>{if(!I.connected.value)return;const V=Date.now()-I.lastPing.value;if(V>r){console.warn(`âš ï¸ ${I.name} WebSocket heartbeat timeout (${V}ms since last ping) - forcing close to trigger reconnection`),I.connected.value=!1;const oe={ui:n,session:a,legion:S}[P];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},$)),console.log(`âœ… Started heartbeat monitor for ${I.name} WebSocket`)}function U(P){const I={ui:{get:()=>D,set:V=>{D=V}},session:{get:()=>A,set:V=>{A=V}},legion:{get:()=>x,set:V=>{x=V}}}[P];I.get()&&(clearInterval(I.get()),I.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${P} WebSocket`))}function W(){if(n.value)return;const P=q("/ws/ui");console.log(`Connecting to UI WebSocket: ${P}`),n.value=new WebSocket(P),n.value.onopen=()=>{e.value=!0,s.value=0,C.value=Date.now(),F("ui"),console.log("UI WebSocket connected")},n.value.onmessage=I=>{const V=JSON.parse(I.data);ee(V)},n.value.onclose=()=>{if(U("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const I=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${I}ms (attempt ${s.value})`),setTimeout(W,I)}},n.value.onerror=I=>{console.error("UI WebSocket error:",I)}}function J(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function ae(P){d.value++;const I=d.value;if(console.log(`[Gen ${I}] Starting connection to session ${P}`),p&&(clearTimeout(p),p=null),await L(),d.value!==I){console.log(`[Gen ${I}] Connection cancelled (current generation: ${d.value})`);return}f.value=P,w.value=I;const V=q(`/ws/session/${P}`);console.log(`[Gen ${I}] Connecting to Session WebSocket: ${V}`),a.value=new WebSocket(V),a.value.onopen=async()=>{if(w.value!==I){console.log(`[Gen ${I}] Ignoring onopen (stale connection, current: ${w.value})`),a.value.close();return}c.value=!0,u.value=0,T.value=Date.now(),F("session"),console.log(`[Gen ${I}] Session WebSocket connected for ${P}`);const Z=h.value.get(P);if(h.value.set(P,!0),Z){console.log(`[Gen ${I}] Reconnection detected, syncing missed messages...`);try{const $e=await je().syncMessages(P);$e.syncedCount>0?console.log(`[Gen ${I}] âœ… Synced ${$e.syncedCount} missed messages`):$e.error?console.warn(`[Gen ${I}] âš ï¸ Message sync failed: ${$e.error}`):console.log(`[Gen ${I}] No missed messages to sync`),$e.hasMore&&console.warn(`[Gen ${I}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${I}] Error during message sync:`,oe)}}else console.log(`[Gen ${I}] Initial connection, no sync needed`)},a.value.onmessage=Z=>{if(w.value!==I){console.log(`[Gen ${I}] Ignoring message (stale connection, current: ${w.value})`);return}const oe=JSON.parse(Z.data);_e(oe,P)},a.value.onclose=()=>{U("session"),c.value=!1,a.value=null,console.log(`[Gen ${I}] Session WebSocket closed for ${P}`);const Z=pe();if(Z.currentSessionId===P&&w.value===I&&u.value<m){u.value++;const oe=Math.min(2e3*u.value,3e4);console.log(`[Gen ${I}] Reconnecting Session WebSocket in ${oe}ms (attempt ${u.value})`),p=setTimeout(()=>{w.value===I&&Z.currentSessionId===P?(p=null,ae(P)):console.log(`[Gen ${I}] Skipping reconnect (generation or session changed)`)},oe)}},a.value.onerror=Z=>{console.error(`[Gen ${I}] Session WebSocket error:`,Z)}}function L(){return new Promise(P=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),a.value){const I=f.value,V=()=>{a.value=null,c.value=!1,f.value=null,w.value=null,u.value=0,I&&h.value.delete(I),P()};if(a.value.readyState===WebSocket.CLOSED)V();else{const Z=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),V()},2e3);a.value.addEventListener("close",()=>{clearTimeout(Z),V()},{once:!0}),a.value.close()}}else f.value=null,w.value=null,P()})}function j(P){a.value&&c.value?(a.value.send(JSON.stringify({type:"send_message",content:P})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function R(P,I,V=!1,Z=null,oe=null){if(a.value&&c.value){const $e={type:"permission_response",request_id:P,decision:I,apply_suggestions:V,timestamp:new Date().toISOString()};Z&&($e.clarification_message=Z),oe&&($e.selected_suggestions=oe),a.value.send(JSON.stringify($e)),console.log(`Sent permission ${I} for request ${P}`,{applySuggestions:V,clarification:Z,selectedSuggestions:oe})}}function H(P,I,V){if(a.value&&c.value){const Z={type:"permission_response",request_id:P,decision:I,updated_input:V,timestamp:new Date().toISOString()};a.value.send(JSON.stringify(Z)),console.log(`Sent permission ${I} with updated_input for request ${P}`,V)}}function X(){a.value&&c.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ee(P){const I=pe(),V=Fe();switch(P.type){case"sessions_list":P.sessions&&Array.isArray(P.sessions)&&P.sessions.forEach(Z=>{I.updateSession(Z.session_id,Z)});break;case"state_change":P.data&&P.data.session_id&&P.data.session&&I.updateSession(P.data.session_id,P.data.session);break;case"project_updated":if(P.data&&P.data.project){const Z=P.data.project;V.updateProjectLocal(Z.project_id,Z),I.fetchSessions()}break;case"project_deleted":P.data&&P.data.project_id&&V.projects.delete(P.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":C.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",P.type)}}function _e(P,I){const V=pe();if(V.currentSessionId!==I){console.warn(`Ignoring message for session ${I} (current: ${V.currentSessionId})`);return}const Z=je();switch(P.type){case"message":const oe=P.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",P);break}if(oe.type==="tool_call"){Z.handleToolCall(I,oe);break}if(oe.type==="permission_request"){Z.handlePermissionRequest(I,oe);break}if(oe.type==="permission_response"){Z.handlePermissionResponse(I,oe);break}oe.metadata?.has_tool_uses&&oe.metadata.tool_uses.forEach($e=>{Z.handleToolUse(I,$e,oe.timestamp)}),oe.metadata?.has_tool_results&&oe.metadata.tool_results.forEach($e=>{Z.handleToolResult(I,$e)}),oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&V.storeInitData(I,oe.metadata.init_data),Z.addMessage(I,oe);break;case"permission_request":Z.handlePermissionRequest(I,P);break;case"permission_response":Z.handlePermissionResponse(I,P);break;case"tool_result":Z.handleToolResult(I,P);break;case"state_change":V.updateSession(I,P.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${I}`);break;case"ping":T.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":P.resource&&(Qe().addResource(I,P.resource),console.log(`Resource registered for session ${I}:`,P.resource.resource_id));break;case"resource_removed":P.resource_id&&(Qe().handleResourceRemoved(I,P.resource_id),console.log(`Resource removed for session ${I}:`,P.resource_id));break;case"image_registered":P.image&&(Qe().addResource(I,{...P.image,resource_id:P.image.image_id}),console.log(`Image registered (legacy) for session ${I}:`,P.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",P.type)}}function Q(P){he(),_.value=P;const I=q(`/ws/legion/${P}`);console.log(`Connecting to Legion WebSocket: ${I}`),S.value=new WebSocket(I),S.value.onopen=()=>{k.value=!0,b.value=0,N.value=Date.now(),F("legion"),console.log(`Legion WebSocket connected for ${P}`)},S.value.onmessage=V=>{const Z=JSON.parse(V.data);z(Z,P)},S.value.onclose=()=>{if(U("legion"),k.value=!1,S.value=null,console.log(`Legion WebSocket closed for ${P}`),_.value===P&&b.value<g){b.value++;const V=Math.min(2e3*b.value,3e4);setTimeout(()=>Q(P),V)}},S.value.onerror=V=>{console.error("Legion WebSocket error:",V)}}function he(){S.value&&(S.value.close(),S.value=null,k.value=!1,_.value=null)}function z(P,I){Ie(async()=>{const{useLegionStore:V}=await Promise.resolve().then(()=>Ub);return{useLegionStore:V}},void 0).then(({useLegionStore:V})=>{const Z=V();switch(P.type){case"comm":P.comm&&(Z.addComm(I,P.comm),console.log("Legion WebSocket: Received new comm",P.comm));break;case"minion_created":P.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",P.data),Ie(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>Tn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":P.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",P.data),Ie(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>Tn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${I}`);break;case"ping":N.value=Date.now(),S.value?.readyState===WebSocket.OPEN&&S.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",P.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:c,sessionRetryCount:u,legionConnected:k,legionRetryCount:b,overallStatus:M,connectUI:W,disconnectUI:J,connectSession:ae,disconnectSession:L,sendMessage:j,sendPermissionResponse:R,sendPermissionResponseWithInput:H,interruptSession:X,connectLegion:Q,disconnectLegion:he}}),Ui=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ft},Symbol.toStringTag,{value:"Module"})),Hi={class:"base-tool-handler"},qi={class:"tool-section"},zi={class:"tool-parameters"},Ki={class:"tool-code"},Gi={key:0,class:"tool-section"},Yi={class:"tool-section-label"},Ji={class:"tool-code"},Qi={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=v(()=>{if(!o.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,m)=>(i(),l("div",Hi,[t("div",qi,[m[0]||(m[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",zi,[t("pre",Ki,y(s.value),1)])]),o.value?(i(),l("div",Gi,[t("div",Yi,y(a.value?"Error:":"Result:"),1),t("div",{class:K(["tool-result",{"tool-result-error":a.value}])},[t("pre",Ji,y(c.value),1)],2)])):E("",!0)]))}},Xi=se(Qi,[["__scopeId","data-v-1e69f57d"]]),Zi={class:"read-tool-handler"},el={class:"tool-section"},tl={class:"read-file-info"},sl={class:"file-icon"},nl={class:"file-path"},ol={key:0,class:"read-range"},al={key:0,class:"tool-section"},il={key:0,class:"tool-result tool-result-error"},ll={class:"tool-code"},rl={key:1,class:"image-preview"},cl={class:"content-header"},ul={class:"image-badge"},dl={class:"image-container"},ml=["src","alt"],fl={key:2,class:"file-content-preview"},pl={class:"content-header"},vl={class:"line-count-badge"},_l={key:0,class:"preview-note"},hl={class:"tool-code content-display"},gl={key:0,class:"more-indicator"},Ls=100,bl={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>{const _=s.value;return _.split("/").pop()||_}),a=v(()=>{const _=e.toolCall.input?.offset,r=e.toolCall.input?.limit;return _!==void 0||r!==void 0}),c=v(()=>{const _=e.toolCall.input?.offset;return _!==void 0?_+1:1}),u=v(()=>{const _=e.toolCall.input?.offset||0,r=e.toolCall.input?.limit;return r!==void 0?_+r:"âˆž"}),m=v(()=>{const _=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(_)}),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!f.value||p.value)return null;const r=e.toolCall.result?.content;if(Array.isArray(r)){for(const $ of r)if($?.type==="image"&&$?.source?.type==="base64"&&$?.source?.data)return $.source.data}return null}),w=v(()=>{if(!d.value)return"";const _=s.value.toLowerCase();return _.endsWith(".png")?"image/png":_.endsWith(".jpg")||_.endsWith(".jpeg")?"image/jpeg":_.endsWith(".gif")?"image/gif":_.endsWith(".webp")?"image/webp":_.endsWith(".svg")?"image/svg+xml":_.endsWith(".bmp")?"image/bmp":_.endsWith(".ico")?"image/x-icon":"image/png"}),h=v(()=>{if(!f.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),S=v(()=>p.value||!h.value||d.value?[]:h.value.split(`
`)),k=v(()=>S.value.length),b=v(()=>k.value>Ls),g=v(()=>p.value||d.value?"":S.value.slice(0,Ls).join(`
`));return(_,r)=>(i(),l("div",Zi,[t("div",el,[t("div",tl,[t("span",sl,y(m.value?"ðŸ–¼ï¸":"ðŸ“„"),1),r[0]||(r[0]=t("strong",null,"Reading:",-1)),t("code",nl,y(s.value),1),a.value?(i(),l("span",ol,"Lines "+y(c.value)+"-"+y(u.value),1)):E("",!0)])]),f.value?(i(),l("div",al,[p.value?(i(),l("div",il,[t("pre",ll,y(h.value),1)])):d.value?(i(),l("div",rl,[t("div",cl,[r[1]||(r[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",ul,y(w.value),1)]),t("div",dl,[t("img",{src:`data:${w.value};base64,${d.value}`,alt:o.value,class:"preview-image"},null,8,ml)])])):(i(),l("div",fl,[t("div",pl,[r[2]||(r[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",vl,y(k.value)+" lines",1),b.value?(i(),l("span",_l,"(showing first "+y(Ls)+")")):E("",!0)]),t("pre",hl,y(g.value),1),b.value?(i(),l("div",gl,"...")):E("",!0)]))])):E("",!0)]))}},yl=se(bl,[["__scopeId","data-v-29b774b1"]]),wl={class:"write-tool-handler"},kl={class:"tool-section"},$l={class:"write-file-info mb-2"},Sl={class:"file-path"},xl={class:"write-content-preview"},Cl={class:"content-header"},El={class:"line-count-badge"},Tl={key:0,class:"preview-note"},Al={class:"tool-code content-display"},Dl={key:0,class:"more-indicator"},Ml={key:0,class:"tool-section"},Ol={key:0,class:"tool-result tool-result-error"},Nl={class:"tool-code"},Ll={key:1,class:"tool-result tool-result-success"},Il={class:"success-message"},Is=100,jl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.content||""),a=v(()=>o.value.split(`
`)),c=v(()=>a.value.length),u=v(()=>c.value>Is),m=v(()=>a.value.slice(0,Is).join(`
`)),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!f.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,h)=>(i(),l("div",wl,[t("div",kl,[t("div",$l,[h[0]||(h[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",Sl,y(s.value),1)]),t("div",xl,[t("div",Cl,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",El,y(c.value)+" lines",1),u.value?(i(),l("span",Tl,"(showing first "+y(Is)+")")):E("",!0)]),t("pre",Al,y(m.value),1),u.value?(i(),l("div",Dl,"...")):E("",!0)])]),f.value?(i(),l("div",Ml,[p.value?(i(),l("div",Ol,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",Nl,y(d.value),1)])):(i(),l("div",Ll,[t("div",Il,[h[4]||(h[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+y(c.value)+" lines written)",1)])]))])):E("",!0)]))}},Pl=se(jl,[["__scopeId","data-v-ddc24a0f"]]),Rl={class:"bash-tool-handler"},Bl={class:"tool-section"},Fl={class:"bash-header"},Vl={class:"bash-header-content"},Wl={key:0,class:"bash-description"},Ul={key:1,class:"bash-flags"},Hl={class:"bash-command-section"},ql={class:"bash-command-content"},zl={key:0,class:"tool-section"},Kl={key:0,class:"bash-output"},Gl={key:1,class:"bash-output-empty"},Yl={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.command||""),o=v(()=>e.toolCall.input?.description||""),a=v(()=>e.toolCall.input?.timeout),c=v(()=>e.toolCall.input?.run_in_background||!1),u=v(()=>a.value||c.value),m=v(()=>{const h=[];return a.value&&h.push(`timeout: ${a.value}ms`),c.value&&h.push("background"),h.join(", ")}),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>p.value?"tool-result-error":"tool-result-success"),w=v(()=>{if(!f.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,S)=>(i(),l("div",Rl,[t("div",Bl,[t("div",Fl,[S[1]||(S[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Vl,[o.value?(i(),l("div",Wl,[S[0]||(S[0]=t("strong",null,"Description:",-1)),ce(" "+y(o.value),1)])):E("",!0),u.value?(i(),l("div",Ul,y(m.value),1)):E("",!0)])]),t("div",Hl,[S[2]||(S[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",ql,y(s.value),1)])]),f.value?(i(),l("div",zl,[t("div",{class:K(["tool-result",d.value])},[S[3]||(S[3]=t("strong",null,"Output:",-1)),w.value?(i(),l("pre",Kl,y(w.value),1)):(i(),l("div",Gl,"No output"))],2)])):E("",!0)]))}},Jl=se(Yl,[["__scopeId","data-v-ab50fe73"]]),Ql={class:"todo-tool-handler"},Xl={class:"tool-section"},Zl={class:"todo-header"},er={class:"todo-summary"},tr={key:0,class:"todo-count todo-count-completed"},sr={key:1,class:"todo-count todo-count-in-progress"},nr={key:2,class:"todo-count todo-count-pending"},or={class:"todo-checklist"},ar={class:"todo-checkbox"},ir={class:"todo-content"},lr={key:0,class:"tool-section"},rr={key:0,class:"tool-result tool-result-error"},cr={class:"tool-code"},ur={key:1,class:"tool-result tool-result-success"},dr={class:"success-message"},mr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.todos||[]),o=v(()=>s.value.filter(d=>d.status==="completed").length),a=v(()=>s.value.filter(d=>d.status==="in_progress").length),c=v(()=>s.value.filter(d=>d.status==="pending").length);function u(d){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[d]||"â˜"}const m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=v(()=>{if(!m.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,w)=>(i(),l("div",Ql,[t("div",Xl,[t("div",Zl,[w[0]||(w[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=t("strong",null,"Task List:",-1)),t("div",er,[o.value>0?(i(),l("span",tr,y(o.value)+" completed ",1)):E("",!0),a.value>0?(i(),l("span",sr,y(a.value)+" in progress ",1)):E("",!0),c.value>0?(i(),l("span",nr,y(c.value)+" pending ",1)):E("",!0)])]),t("div",or,[(i(!0),l(ne,null,ue(s.value,(h,S)=>(i(),l("div",{key:S,class:K(["todo-item",`todo-${h.status}`])},[t("span",ar,y(u(h.status)),1),t("span",ir,y(h.content),1)],2))),128))])]),m.value?(i(),l("div",lr,[f.value?(i(),l("div",rr,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",cr,y(p.value),1)])):(i(),l("div",ur,[t("div",dr,[w[3]||(w[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+y(s.value.length)+" tasks)",1)])]))])):E("",!0)]))}},fr=se(mr,[["__scopeId","data-v-bbe55ee7"]]),pr={class:"edit-tool-handler"},vr={class:"tool-section"},_r={class:"edit-file-info"},hr={class:"file-path"},gr={key:0,class:"replace-all-badge"},br={class:"edit-diff-container"},yr={class:"diff-header"},wr={class:"diff-stats"},kr={class:"stat-removed"},$r={class:"stat-added"},Sr={class:"unified-diff"},xr={class:"diff-scroll-container"},Cr={class:"diff-marker"},Er={class:"diff-content"},Tr={key:0,class:"tool-section"},Ar={key:0,class:"tool-result tool-result-error"},Dr={class:"tool-code"},Mr={key:1,class:"tool-result tool-result-success"},Or={class:"success-message"},Nr={key:0,class:"success-detail"},Lr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.old_string||""),a=v(()=>e.toolCall.input?.new_string||""),c=v(()=>e.toolCall.input?.replace_all||!1),u=v(()=>{const S=Va(s.value,o.value,a.value,"","",{context:3}).split(`
`),k=[];for(let b=4;b<S.length;b++){const g=S[b];g&&(g.startsWith("-")?k.push({type:"removed",content:g.substring(1)}):g.startsWith("+")?k.push({type:"added",content:g.substring(1)}):g.startsWith(" ")?k.push({type:"context",content:g.substring(1)}):g.startsWith("@@")&&k.push({type:"hunk",content:g}))}return k}),m=v(()=>u.value.filter(h=>h.type==="removed").length),f=v(()=>u.value.filter(h=>h.type==="added").length),p=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,S)=>(i(),l("div",pr,[t("div",vr,[t("div",_r,[S[0]||(S[0]=t("span",{class:"file-icon"},"âœï¸",-1)),S[1]||(S[1]=t("strong",null,"Editing:",-1)),t("code",hr,y(s.value),1),c.value?(i(),l("span",gr,"Replace All")):E("",!0)]),t("div",br,[t("div",yr,[S[2]||(S[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",wr,[t("span",kr,"-"+y(m.value),1),t("span",$r,"+"+y(f.value),1)])]),t("div",Sr,[t("div",xr,[(i(!0),l(ne,null,ue(u.value,(k,b)=>(i(),l("div",{key:b,class:K(["diff-line",{"diff-line-removed":k.type==="removed","diff-line-added":k.type==="added","diff-line-context":k.type==="context","diff-line-hunk":k.type==="hunk"}])},[t("span",Cr,y(k.type==="removed"?"-":k.type==="added"?"+":k.type==="hunk"?"@":" "),1),t("span",Er,y(k.content),1)],2))),128))])])])]),p.value?(i(),l("div",Tr,[d.value?(i(),l("div",Ar,[S[3]||(S[3]=t("strong",null,"Error:",-1)),t("pre",Dr,y(w.value),1)])):(i(),l("div",Mr,[t("div",Or,[S[4]||(S[4]=t("span",{class:"success-icon"},"âœ…",-1)),S[5]||(S[5]=t("strong",null,"File edited successfully",-1)),c.value?(i(),l("span",Nr,"(all occurrences replaced)")):E("",!0)])]))])):E("",!0)]))}},Ir=se(Lr,[["__scopeId","data-v-dd74055e"]]),jr={class:"search-tool-handler"},Pr={class:"tool-section"},Rr={class:"search-info"},Br={class:"search-icon"},Fr={class:"search-pattern"},Vr={key:0,class:"search-path"},Wr={key:1,class:"search-filters"},Ur={key:0,class:"filter-badge"},Hr={key:1,class:"filter-badge"},qr={key:2,class:"filter-badge"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Yr={key:1,class:"search-results"},Jr={class:"results-header"},Qr={class:"results-label"},Xr={class:"results-count-badge"},Zr={class:"results-content"},ec={class:"tool-code"},tc={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.name==="Grep"),o=v(()=>e.toolCall.input?.pattern||"Unknown"),a=v(()=>e.toolCall.input?.path||null),c=v(()=>e.toolCall.input?.type||null),u=v(()=>e.toolCall.input?.glob||null),m=v(()=>e.toolCall.input?.["-i"]||!1),f=v(()=>c.value||u.value||m.value),p=v(()=>s.value?"ðŸ”":"ðŸ“"),d=v(()=>s.value?"Searching content":"Finding files"),w=v(()=>s.value?"Matches":"Files found"),h=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),S=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!h.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),b=v(()=>!h.value||S.value||!k.value?0:k.value.split(`
`).filter(_=>_.trim()).length);return(g,_)=>(i(),l("div",jr,[t("div",Pr,[t("div",Rr,[t("span",Br,y(p.value),1),t("strong",null,y(d.value)+":",1),t("code",Fr,y(o.value),1),a.value?(i(),l("span",Vr,"in "+y(a.value),1)):E("",!0),f.value?(i(),l("span",Wr,[c.value?(i(),l("span",Ur,"type: "+y(c.value),1)):E("",!0),u.value?(i(),l("span",Hr,"glob: "+y(u.value),1)):E("",!0),m.value?(i(),l("span",qr,"case-insensitive")):E("",!0)])):E("",!0)])]),h.value?(i(),l("div",zr,[S.value?(i(),l("div",Kr,[_[0]||(_[0]=t("strong",null,"Error:",-1)),t("pre",Gr,y(k.value),1)])):(i(),l("div",Yr,[t("div",Jr,[t("span",Qr,y(w.value)+":",1),t("span",Xr,y(b.value)+" "+y(b.value===1?"match":"matches"),1)]),t("div",Zr,[t("pre",ec,y(k.value),1)])]))])):E("",!0)]))}},On=se(tc,[["__scopeId","data-v-0d272c39"]]),sc={class:"web-tool-handler"},nc={class:"tool-section"},oc={class:"web-info"},ac={class:"web-icon"},ic=["href"],lc={key:1,class:"web-query"},rc={key:0,class:"web-prompt-container"},cc={class:"prompt-content"},uc={key:1,class:"web-domains"},dc={class:"domains-label"},mc={key:0,class:"tool-section"},fc={key:0,class:"tool-result tool-result-error"},pc={class:"tool-code"},vc={key:1,class:"web-results"},_c={class:"results-header"},hc={class:"results-label"},gc={class:"results-content"},bc={class:"tool-code"},yc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.name==="WebFetch"),o=v(()=>e.toolCall.input?.url||null),a=v(()=>e.toolCall.input?.query||null),c=v(()=>e.toolCall.input?.prompt||null),u=v(()=>e.toolCall.input?.allowed_domains||[]),m=v(()=>e.toolCall.input?.blocked_domains||[]),f=v(()=>u.value.length>0?u.value:m.value.length>0?m.value:[]),p=v(()=>u.value.length>0?"Allowed domains":m.value.length>0?"Blocked domains":"Domains"),d=v(()=>s.value?"ðŸŒ":"ðŸ”Ž"),w=v(()=>s.value?"Fetching URL":"Searching web"),h=v(()=>s.value?"Fetched content":"Search results"),S=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!S.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,_)=>(i(),l("div",sc,[t("div",nc,[t("div",oc,[t("span",ac,y(d.value),1),t("strong",null,y(w.value)+":",1),o.value?(i(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,ic)):a.value?(i(),l("code",lc,y(a.value),1)):E("",!0)]),c.value?(i(),l("div",rc,[_[0]||(_[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",cc,y(c.value),1)])):E("",!0),f.value.length>0?(i(),l("div",uc,[t("span",dc,y(p.value)+":",1),(i(!0),l(ne,null,ue(f.value,r=>(i(),l("span",{key:r,class:"domain-badge"},y(r),1))),128))])):E("",!0)]),S.value?(i(),l("div",mc,[k.value?(i(),l("div",fc,[_[1]||(_[1]=t("strong",null,"Error:",-1)),t("pre",pc,y(b.value),1)])):(i(),l("div",vc,[t("div",_c,[t("span",hc,y(h.value)+":",1)]),t("div",gc,[t("pre",bc,y(b.value),1)])]))])):E("",!0)]))}},Nn=se(yc,[["__scopeId","data-v-62b55b55"]]),wc={class:"task-tool-handler"},kc={class:"tool-section"},$c={class:"task-header"},Sc={key:0,class:"agent-type-badge"},xc={key:0,class:"task-description"},Cc={class:"description-content"},Ec={key:1,class:"task-prompt-container"},Tc={class:"prompt-header"},Ac={class:"prompt-length"},Dc={class:"prompt-code"},Mc={key:0,class:"tool-section"},Oc={key:0,class:"tool-result tool-result-error"},Nc={class:"tool-code"},Lc={key:1,class:"agent-output"},Ic={class:"output-header"},jc={key:0,class:"output-count-badge"},Pc={class:"output-content"},Rc={class:"tool-code"},Bc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.description||null),o=v(()=>e.toolCall.input?.prompt||null),a=v(()=>e.toolCall.input?.subagent_type||null),c=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=v(()=>{if(!c.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),f=v(()=>m.value?m.value.split(`
`).length:0);return(p,d)=>(i(),l("div",wc,[t("div",kc,[t("div",$c,[d[0]||(d[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),d[1]||(d[1]=t("strong",null,"Agent Task:",-1)),a.value?(i(),l("span",Sc,y(a.value),1)):E("",!0)]),s.value?(i(),l("div",xc,[d[2]||(d[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Cc,y(s.value),1)])):E("",!0),o.value?(i(),l("div",Ec,[t("div",Tc,[d[3]||(d[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Ac,y(o.value.length)+" characters",1)]),t("pre",Dc,y(o.value),1)])):E("",!0)]),c.value?(i(),l("div",Mc,[u.value?(i(),l("div",Oc,[d[4]||(d[4]=t("strong",null,"Error:",-1)),t("pre",Nc,y(m.value),1)])):(i(),l("div",Lc,[t("div",Ic,[d[5]||(d[5]=t("span",{class:"output-label"},"Agent Output:",-1)),f.value>0?(i(),l("span",jc,y(f.value)+" lines",1)):E("",!0)]),t("div",Pc,[t("pre",Rc,y(m.value),1)])]))])):E("",!0)]))}},Fc=se(Bc,[["__scopeId","data-v-c520c244"]]),Vc={class:"task-create-tool-handler"},Wc={class:"tool-section"},Uc={class:"task-details p-2"},Hc={key:0,class:"task-field mb-2"},qc={class:"field-value subject-value"},zc={key:1,class:"task-field mb-2"},Kc={class:"field-value description-value"},Gc={key:2,class:"task-field"},Yc={class:"field-value active-form-value"},Jc={key:0,class:"tool-section mt-2"},Qc={key:0,class:"tool-result tool-result-error"},Xc={class:"tool-code"},Zc={key:1,class:"tool-result tool-result-success"},eu={class:"result-text"},tu={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.subject||null),o=v(()=>e.toolCall.input?.description||null),a=v(()=>e.toolCall.input?.activeForm||null),c=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=v(()=>{if(!c.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)});return(f,p)=>(i(),l("div",Vc,[t("div",Wc,[p[3]||(p[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Uc,[s.value?(i(),l("div",Hc,[p[0]||(p[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",qc,y(s.value),1)])):E("",!0),o.value?(i(),l("div",zc,[p[1]||(p[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Kc,y(o.value),1)])):E("",!0),a.value?(i(),l("div",Gc,[p[2]||(p[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Yc,y(a.value),1)])):E("",!0)])]),c.value?(i(),l("div",Jc,[u.value?(i(),l("div",Qc,[p[4]||(p[4]=t("strong",null,"Error:",-1)),t("pre",Xc,y(m.value),1)])):(i(),l("div",Zc,[p[5]||(p[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",eu,y(m.value),1)]))])):E("",!0)]))}},su=se(tu,[["__scopeId","data-v-474dd444"]]),nu={class:"task-update-tool-handler"},ou={class:"tool-section"},au={class:"task-header"},iu={key:0,class:"task-id-badge"},lu={class:"task-details p-2"},ru={key:0,class:"task-field mb-2"},cu={key:1,class:"task-field mb-2"},uu={class:"field-value"},du={key:2,class:"task-field mb-2"},mu={class:"field-value description-value"},fu={key:3,class:"task-field mb-2"},pu={class:"field-value active-form-value"},vu={key:4,class:"task-field mb-2"},_u={class:"field-value"},hu={key:5,class:"task-field mb-2"},gu={class:"field-value"},bu={key:6,class:"task-field"},yu={class:"field-value"},wu={key:0,class:"tool-section mt-2"},ku={key:0,class:"tool-result tool-result-error"},$u={class:"tool-code"},Su={key:1,class:"tool-result tool-result-success"},xu={class:"result-text"},Cu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.input?.status||null),a=v(()=>e.toolCall.input?.subject||null),c=v(()=>e.toolCall.input?.description||null),u=v(()=>e.toolCall.input?.activeForm||null),m=v(()=>e.toolCall.input?.owner||null),f=v(()=>e.toolCall.input?.addBlockedBy||[]),p=v(()=>e.toolCall.input?.addBlocks||[]),d=v(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=v(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),h=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),S=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!h.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,g)=>(i(),l("div",nu,[t("div",ou,[t("div",au,[g[0]||(g[0]=t("span",{class:"task-icon"},"âœï¸",-1)),g[1]||(g[1]=t("strong",null,"Update Task",-1)),s.value?(i(),l("span",iu,"#"+y(s.value),1)):E("",!0)]),t("div",lu,[o.value?(i(),l("div",ru,[g[2]||(g[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:K(["field-value status-value",w.value])},y(d.value)+" "+y(o.value),3)])):E("",!0),a.value?(i(),l("div",cu,[g[3]||(g[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",uu,y(a.value),1)])):E("",!0),c.value?(i(),l("div",du,[g[4]||(g[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",mu,y(c.value),1)])):E("",!0),u.value?(i(),l("div",fu,[g[5]||(g[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",pu,y(u.value),1)])):E("",!0),m.value?(i(),l("div",vu,[g[6]||(g[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",_u,y(m.value),1)])):E("",!0),f.value?.length?(i(),l("div",hu,[g[7]||(g[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",gu,[(i(!0),l(ne,null,ue(f.value,_=>(i(),l("span",{key:_,class:"badge bg-warning text-dark me-1"},"#"+y(_),1))),128))])])):E("",!0),p.value?.length?(i(),l("div",bu,[g[8]||(g[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",yu,[(i(!0),l(ne,null,ue(p.value,_=>(i(),l("span",{key:_,class:"badge bg-info text-dark me-1"},"#"+y(_),1))),128))])])):E("",!0)])]),h.value?(i(),l("div",wu,[S.value?(i(),l("div",ku,[g[9]||(g[9]=t("strong",null,"Error:",-1)),t("pre",$u,y(k.value),1)])):(i(),l("div",Su,[g[10]||(g[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",xu,y(k.value),1)]))])):E("",!0)]))}},Eu=se(Cu,[["__scopeId","data-v-35582330"]]),Tu={class:"task-list-tool-handler"},Au={key:0,class:"tool-section"},Du={key:0,class:"tool-result tool-result-error"},Mu={class:"tool-code"},Ou={key:1,class:"task-list-result"},Nu={key:0,class:"parsed-tasks"},Lu={class:"status-icon"},Iu={class:"task-id text-muted"},ju={class:"task-subject flex-grow-1"},Pu={key:0,class:"task-owner badge bg-secondary"},Ru={key:1,class:"raw-result p-2"},Bu={class:"tool-code"},Fu={key:1,class:"tool-section"},Vu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=v(()=>{if(!s.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),c=v(()=>{if(!a.value)return[];const m=[],p=a.value.split(`
`);for(const d of p){const w=d.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const h=w[2].toLowerCase();m.push({id:w[1],status:h,subject:w[3].trim(),owner:null,statusIcon:u(h)})}}return m});function u(m){switch(m){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(m,f)=>(i(),l("div",Tu,[f[2]||(f[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(i(),l("div",Au,[o.value?(i(),l("div",Du,[f[0]||(f[0]=t("strong",null,"Error:",-1)),t("pre",Mu,y(a.value),1)])):(i(),l("div",Ou,[c.value.length>0?(i(),l("div",Nu,[(i(!0),l(ne,null,ue(c.value,(p,d)=>(i(),l("div",{key:d,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",Lu,y(p.statusIcon),1),t("span",Iu,"#"+y(p.id),1),t("span",ju,y(p.subject),1),p.owner?(i(),l("span",Pu,y(p.owner),1)):E("",!0)]))),128))])):(i(),l("div",Ru,[t("pre",Bu,y(a.value),1)]))]))])):n.toolCall.status==="completed"?(i(),l("div",Fu,[...f[1]||(f[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):E("",!0)]))}},Wu=se(Vu,[["__scopeId","data-v-4e79ba4b"]]),Uu={class:"task-get-tool-handler"},Hu={class:"tool-section"},qu={class:"task-header"},zu={key:0,class:"task-id-badge"},Ku={key:0,class:"tool-section"},Gu={key:0,class:"tool-result tool-result-error"},Yu={class:"tool-code"},Ju={key:1,class:"task-details-result p-2"},Qu={key:0,class:"parsed-task"},Xu={class:"task-field mb-2"},Zu={class:"field-value subject-value"},ed={key:0,class:"task-field mb-2"},td={key:1,class:"task-field mb-2"},sd={class:"field-value description-value"},nd={key:2,class:"task-field mb-2"},od={class:"field-value"},ad={key:3,class:"task-field mb-2"},id={class:"field-value"},ld={key:4,class:"task-field"},rd={class:"field-value"},cd={key:1,class:"raw-result"},ud={class:"tool-code"},dd={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=v(()=>{if(!o.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),u=v(()=>{if(!c.value)return null;const p=c.value;try{const h=JSON.parse(p);if(h&&typeof h=="object")return{subject:h.subject||h.title||"",status:h.status||"",description:h.description||"",owner:h.owner||"",blockedBy:h.blockedBy||[],blocks:h.blocks||[]}}catch{}const d=p.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const h of d){const S=h.match(/^Subject:\s*(.+)$/i);S&&(w.subject=S[1].trim());const k=h.match(/^Status:\s*(.+)$/i);k&&(w.status=k[1].trim());const b=h.match(/^Description:\s*(.+)$/i);b&&(w.description=b[1].trim());const g=h.match(/^Owner:\s*(.+)$/i);g&&(w.owner=g[1].trim())}return w.subject?w:null}),m=v(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),f=v(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,d)=>(i(),l("div",Uu,[t("div",Hu,[t("div",qu,[d[0]||(d[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),d[1]||(d[1]=t("strong",null,"Get Task",-1)),s.value?(i(),l("span",zu,"#"+y(s.value),1)):E("",!0)])]),o.value?(i(),l("div",Ku,[a.value?(i(),l("div",Gu,[d[2]||(d[2]=t("strong",null,"Error:",-1)),t("pre",Yu,y(c.value),1)])):(i(),l("div",Ju,[u.value?(i(),l("div",Qu,[t("div",Xu,[d[3]||(d[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Zu,y(u.value.subject),1)]),u.value.status?(i(),l("div",ed,[d[4]||(d[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:K(["field-value",f.value])},y(m.value)+" "+y(u.value.status),3)])):E("",!0),u.value.description?(i(),l("div",td,[d[5]||(d[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",sd,y(u.value.description),1)])):E("",!0),u.value.owner?(i(),l("div",nd,[d[6]||(d[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",od,y(u.value.owner),1)])):E("",!0),u.value.blockedBy?.length?(i(),l("div",ad,[d[7]||(d[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",id,[(i(!0),l(ne,null,ue(u.value.blockedBy,w=>(i(),l("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):E("",!0),u.value.blocks?.length?(i(),l("div",ld,[d[8]||(d[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",rd,[(i(!0),l(ne,null,ue(u.value.blocks,w=>(i(),l("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):E("",!0)])):(i(),l("div",cd,[t("pre",ud,y(c.value),1)]))]))])):E("",!0)]))}},md=se(dd,[["__scopeId","data-v-a80d14da"]]),fd={class:"notebook-edit-tool-handler"},pd={class:"tool-section"},vd={class:"notebook-info"},_d={class:"file-path"},hd={class:"cell-info mt-2"},gd={class:"info-row"},bd={class:"info-row"},yd={key:0,class:"info-row"},wd={class:"badge bg-info"},kd={key:0,class:"source-preview mt-3"},$d={class:"preview-header"},Sd={class:"preview-stats"},xd={class:"source-code"},Cd={key:0,class:"tool-section"},Ed={key:0},Td={key:1,class:"text-danger"},Ad={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.notebook_path||"Unknown"),o=v(()=>e.toolCall.input?.cell_id),a=v(()=>e.toolCall.input?.cell_type||"code"),c=v(()=>e.toolCall.input?.edit_mode||"replace"),u=v(()=>e.toolCall.input?.new_source||""),m=v(()=>u.value.split(`
`).length),f=v(()=>a.value==="code"?"bg-primary":"bg-secondary"),p=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=c.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,h)=>(i(),l("div",fd,[t("div",pd,[t("div",vd,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",_d,y(s.value),1)]),t("div",hd,[t("div",gd,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,y(o.value||"N/A"),1)]),t("div",bd,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:K(["badge",f.value])},y(a.value),3)]),c.value?(i(),l("div",yd,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",wd,y(c.value),1)])):E("",!0)]),u.value?(i(),l("div",kd,[t("div",$d,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",Sd,y(m.value)+" lines",1)]),t("pre",xd,[t("code",null,y(u.value),1)])])):E("",!0)]),n.toolCall.result?(i(),l("div",Cd,[h[6]||(h[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:K(["tool-result",p.value])},[n.toolCall.result.success!==!1?(i(),l("div",Ed," âœ… "+y(d.value),1)):(i(),l("div",Td," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):E("",!0)]))}},Dd=se(Ad,[["__scopeId","data-v-c81a9bcf"]]),Md={class:"shell-tool-handler"},Od={class:"tool-section"},Nd={class:"shell-info"},Ld={class:"shell-icon"},Id={key:0,class:"shell-id"},jd={key:0,class:"filter-info mt-2"},Pd={class:"filter-pattern"},Rd={key:0,class:"tool-section"},Bd={class:"result-header mb-2"},Fd={key:0,class:"mb-2"},Vd={class:"shell-output"},Wd={key:1,class:"mb-2"},Ud={class:"shell-output shell-output-error"},Hd={key:0},qd={key:1,class:"text-danger"},zd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=v(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=v(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),c=v(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),u=v(()=>e.toolCall.input?.filter);function m(S,k){if(!S)return null;const b=new RegExp(`<${k}>([\\s\\S]*?)<\\/${k}>`,"i"),g=S.match(b);return g?g[1].trim():null}const f=v(()=>{const S=e.toolCall.result;if(!S)return null;let k=S;if(S.content&&(k=S.content),typeof k=="string")return{status:m(k,"status"),stdout:m(k,"stdout"),stderr:m(k,"stderr"),exit_code:m(k,"exit_code")};if(Array.isArray(k)){const b=k.find(g=>g.type==="text")?.text||"";return{status:m(b,"status"),stdout:m(b,"stdout"),stderr:m(b,"stderr"),exit_code:m(b,"exit_code")}}return{status:S.status||k.status,stdout:S.stdout||S.output||k.stdout||k.output,stderr:S.stderr||k.stderr,exit_code:S.exit_code||k.exit_code}}),p=v(()=>f.value?.status),d=v(()=>{const S=p.value;return S==="running"?"bg-success":S==="completed"?"bg-secondary":S==="killed"||S==="terminated"?"bg-danger":"bg-info"}),w=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const S=f.value;if(S?.status==="running"&&!S.stdout&&!S.stderr)return"No new output since last check";if(S?.status==="failed")return`Shell failed (exit code ${S.exit_code||"unknown"})`}return"Operation completed"});return(S,k)=>(i(),l("div",Md,[t("div",Od,[t("div",Nd,[t("span",Ld,y(s.value),1),t("strong",null,y(o.value)+":",1),c.value?(i(),l("code",Id,"Shell "+y(c.value),1)):E("",!0)]),n.toolCall.name==="BashOutput"&&u.value?(i(),l("div",jd,[k[0]||(k[0]=t("strong",null,"Filter:",-1)),t("code",Pd,y(u.value),1)])):E("",!0)]),n.toolCall.result?(i(),l("div",Rd,[t("div",Bd,[t("strong",null,y(a.value)+":",1),p.value?(i(),l("span",{key:0,class:K(["badge",d.value])},y(p.value),3)):E("",!0)]),f.value?.stdout?(i(),l("div",Fd,[k[1]||(k[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Vd,[t("pre",null,[t("code",null,y(f.value.stdout),1)])])])):E("",!0),f.value?.stderr?(i(),l("div",Wd,[k[2]||(k[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Ud,[t("pre",null,[t("code",null,y(f.value.stderr),1)])])])):E("",!0),!f.value?.stdout&&!f.value?.stderr?(i(),l("div",{key:2,class:K(["tool-result",w.value])},[n.toolCall.result.success!==!1?(i(),l("div",Hd," âœ… "+y(h.value),1)):(i(),l("div",qd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):E("",!0)])):E("",!0)]))}},Ln=se(zd,[["__scopeId","data-v-86def281"]]),Kd={class:"skill-tool-handler"},Gd={key:0,class:"tool-section"},Yd={class:"d-flex align-items-center gap-2"},Jd={class:"text-muted small"},Qd={key:0,class:"skill-content-body"},Xd={class:"skill-content-text"},Zd={key:1,class:"tool-section mt-3"},em={class:"tool-result tool-result-error"},tm={class:"tool-code"},sm={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=pe(),a=O(!1);function c(){a.value=!a.value}const u=v(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const S=s.messagesBySession.get(h)||[],k=S.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(r=>r.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let b=null,g=null;for(let _=k+1;_<Math.min(k+3,S.length);_++){const r=S[_];if(r.type!=="user")continue;const $=r.content||"";$.includes("<command-message>")&&$.includes("skill is running")?b=r:$.startsWith("Base directory for this skill:")&&(g=r)}return{running:b,content:g}}),m=v(()=>{const h=u.value.content;if(!h)return"";const S=h.content||"",k=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return S.replace(k,"").trim()}),f=v(()=>m.value.length>0),p=v(()=>m.value?m.value.split(`
`).length:0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!d.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,S)=>(i(),l("div",Kd,[f.value?(i(),l("div",Gd,[t("div",{class:"skill-content-header",onClick:c},[t("div",Yd,[t("i",{class:K(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),S[0]||(S[0]=t("strong",null,"Skill Content",-1)),t("span",Jd,"("+y(p.value)+" lines)",1)])]),a.value?(i(),l("div",Qd,[t("pre",Xd,y(m.value),1)])):E("",!0)])):E("",!0),d.value?(i(),l("div",Zd,[S[1]||(S[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",em,[t("pre",tm,y(w.value),1)])])):E("",!0)]))}},nm=se(sm,[["__scopeId","data-v-0a48ca0f"]]),om={class:"slashcommand-tool-handler"},am={key:0,class:"tool-section"},im={class:"d-flex align-items-center gap-2"},lm=["aria-label"],rm={class:"text-muted small"},cm={key:0,class:"command-content-body"},um={class:"command-content-text"},dm={key:1,class:"tool-section mt-3"},mm={class:"tool-result tool-result-error"},fm={class:"tool-code"},pm={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=pe(),a=O(!1);function c(){a.value=!a.value}const u=v(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const S=s.messagesBySession.get(h)||[],k=S.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(r=>r.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let b=null,g=null;for(let _=k+1;_<Math.min(k+3,S.length);_++){const r=S[_];if(r.type!=="user")continue;const $=r.content||"";$.includes("<command-message>")&&$.includes("<command-name>")&&$.includes("<command-args>")?b=r:$.includes("ARGUMENTS:")&&(g=r)}return{running:b,content:g}}),m=v(()=>{const h=u.value.content;if(!h)return"";const S=h.content||"",k=/\nARGUMENTS:.*$/s;return S.replace(k,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),f=v(()=>m.value.length>0),p=v(()=>m.value?m.value.split(`
`).length:0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!d.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,S)=>(i(),l("div",om,[f.value?(i(),l("div",am,[t("div",{class:"command-content-header",onClick:c},[t("div",im,[t("span",{"aria-label":a.value?"Collapse":"Expand"},y(a.value?"â–¾":"â–¸"),9,lm),S[0]||(S[0]=t("strong",null,"Command Content",-1)),t("span",rm,"("+y(p.value)+" lines)",1)])]),a.value?(i(),l("div",cm,[t("pre",um,y(m.value),1)])):E("",!0)])):E("",!0),d.value?(i(),l("div",dm,[S[1]||(S[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",mm,[t("pre",fm,y(w.value),1)])])):E("",!0)]))}},vm=se(pm,[["__scopeId","data-v-15991acf"]]),_m={class:"exit-plan-mode-tool-handler"},hm={class:"tool-section"},gm={key:0,class:"plan-content mt-2"},bm={class:"plan-text"},ym={key:0,class:"tool-section"},wm={key:0},km={key:1,class:"text-danger"},$m={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.plan),o=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,c)=>(i(),l("div",_m,[t("div",hm,[c[1]||(c[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(i(),l("div",gm,[c[0]||(c[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",bm,y(s.value),1)])):E("",!0)]),n.toolCall.result?(i(),l("div",ym,[c[2]||(c[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:K(["tool-result",o.value])},[n.toolCall.result.success!==!1?(i(),l("div",wm," âœ… Permission mode reverted to default ")):(i(),l("div",km," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):E("",!0)]))}},Sm=se($m,[["__scopeId","data-v-e2e3c781"]]),xm={class:"ask-user-question-handler"},Cm={key:0,class:"answers-summary"},Em={class:"answer-question text-muted small"},Tm={class:"answer-value fw-medium"},Am={key:1,class:"text-muted small"},Dm={key:0,class:"questions-container"},Mm={class:"question-header d-flex align-items-center gap-2 mb-2"},Om={key:0,class:"badge bg-secondary"},Nm={class:"question-text fw-medium"},Lm={class:"options-list"},Im=["id","checked","disabled","onChange"],jm=["id","name","checked","disabled","onChange"],Pm=["for"],Rm={class:"option-label"},Bm={key:0,class:"option-description text-muted d-block small"},Fm={class:"option-item form-check other-option"},Vm=["id","checked","disabled","onChange"],Wm=["id","name","checked","disabled","onChange"],Um=["for"],Hm={key:2,class:"other-input mt-2"},qm=["onUpdate:modelValue","disabled","onInput"],zm={key:1,class:"alert alert-info mb-0"},Km={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=v(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),u=v(()=>{if(!c.value)return{};const C=o.toolCall.result;if(C?.content){if(typeof C.content=="object"&&C.content.answers)return C.content.answers;if(typeof C.content=="string")try{const N=JSON.parse(C.content);if(N.answers)return N.answers}catch{}}const T=o.toolCall.input||{};return T.answers?T.answers:{}}),m=v(()=>Object.keys(u.value).length>0),f=v(()=>(o.toolCall.input||{}).questions||[]),p=O({}),d=O({});fe(f,C=>{C.forEach((T,N)=>{N in p.value||(p.value[N]=T.multiSelect?[]:null),N in d.value||(d.value[N]="")})},{immediate:!0});function w(C,T){const N=p.value[C];return Array.isArray(N)?N.includes(T):N===T}function h(C){const T=p.value[C];return Array.isArray(T)?T.includes("__OTHER__"):T==="__OTHER__"}function S(C,T){p.value[C]=T,r()}function k(C){p.value[C]="__OTHER__",r()}function b(C,T){const N=p.value[C];if(!Array.isArray(N))p.value[C]=[T];else{const D=N.indexOf(T);D===-1?N.push(T):N.splice(D,1)}r()}function g(C){const T=p.value[C];if(!Array.isArray(T))p.value[C]=["__OTHER__"];else{const N=T.indexOf("__OTHER__");N===-1?T.push("__OTHER__"):T.splice(N,1)}r()}function _(C){r()}function r(){const C={};f.value.forEach((T,N)=>{const D=p.value[N],A=T.question;if(T.multiSelect){if(Array.isArray(D)&&D.length>0){const x=D.map(M=>M==="__OTHER__"?d.value[N]||"":M).filter(M=>M);C[A]=x.join(", ")}}else D==="__OTHER__"?C[A]=d.value[N]||"":D&&(C[A]=D)}),a("answer",C)}const $=v(()=>f.value.every((C,T)=>{const N=p.value[T];if(C.multiSelect){if(!Array.isArray(N)||N.length===0||N.includes("__OTHER__")&&!d.value[T])return!1}else if(!N||N==="__OTHER__"&&!d.value[T])return!1;return!0}));return e({allQuestionsAnswered:$,getAnswers:()=>{const C={};return f.value.forEach((T,N)=>{const D=p.value[N],A=T.question;if(T.multiSelect){if(Array.isArray(D)&&D.length>0){const x=D.map(M=>M==="__OTHER__"?d.value[N]||"":M).filter(M=>M);C[A]=x.join(", ")}}else D==="__OTHER__"?C[A]=d.value[N]||"":D&&(C[A]=D)}),C}}),(C,T)=>(i(),l("div",xm,[c.value?(i(),l(ne,{key:0},[m.value?(i(),l("div",Cm,[(i(!0),l(ne,null,ue(u.value,(N,D)=>(i(),l("div",{key:D,class:"answer-item mb-2"},[t("div",Em,y(D),1),t("div",Tm,y(N),1)]))),128))])):(i(),l("div",Am," No answers recorded. "))],64)):(i(),l(ne,{key:1},[f.value.length>0?(i(),l("div",Dm,[(i(!0),l(ne,null,ue(f.value,(N,D)=>(i(),l("div",{key:D,class:"question-block mb-3"},[t("div",Mm,[N.header?(i(),l("span",Om,y(N.header),1)):E("",!0),t("span",Nm,y(N.question),1)]),t("div",Lm,[(i(!0),l(ne,null,ue(N.options,(A,x)=>(i(),l("div",{key:x,class:K(["option-item form-check",{selected:w(D,A.label)}])},[N.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${D}-opt${x}`,checked:w(D,A.label),disabled:n.disabled,onChange:M=>b(D,A.label)},null,40,Im)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${D}-opt${x}`,name:`question-${D}`,checked:w(D,A.label),disabled:n.disabled,onChange:M=>S(D,A.label)},null,40,jm)),t("label",{class:"form-check-label",for:`q${D}-opt${x}`},[t("span",Rm,y(A.label),1),A.description?(i(),l("span",Bm,y(A.description),1)):E("",!0)],8,Pm)],2))),128)),t("div",Fm,[N.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${D}-other`,checked:h(D),disabled:n.disabled,onChange:A=>g(D)},null,40,Vm)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${D}-other`,name:`question-${D}`,checked:h(D),disabled:n.disabled,onChange:A=>k(D)},null,40,Wm)),t("label",{class:"form-check-label",for:`q${D}-other`},[...T[0]||(T[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Um),h(D)?(i(),l("div",Hm,[xe(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":A=>d.value[D]=A,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:A=>_()},null,40,qm),[[We,d.value[D]]])])):E("",!0)])])]))),128))])):(i(),l("div",zm," No questions to display. "))],64))]))}},In=se(Km,[["__scopeId","data-v-ebcee33f"]]),Gm={class:"timeline-detail"},Ym={key:0,class:"detail-banner detail-banner-warning"},Jm={key:2,class:"permission-section"},Qm={class:"permission-buttons"},Xm=["disabled"],Zm=["disabled"],ef={class:"detail-banner detail-banner-warning"},tf={key:0,class:"suggestions-section"},sf=["id","onUpdate:modelValue","disabled"],nf=["for"],of={class:"permission-buttons"},af=["disabled"],lf=["disabled"],rf=["disabled"],cf={class:"guidance-section"},uf=["disabled"],df=["disabled"],mf={key:3,class:"detail-banner detail-banner-warning"},ff={key:4,class:"detail-banner detail-banner-error"},pf={key:0},vf={key:5,class:"detail-section"},_f={key:0,class:"detail-pre"},hf={key:6,class:"detail-section"},gf={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=pe(),a=ft(),c=O(!1),u=O(!1),m=O(!1),f=O(null),p=O(""),d=O(!1),w=O(null),h=O({}),S=O(null),k=O({});fe(()=>e.toolCall.suggestions,R=>{if(R&&R.length>0){const H={};R.forEach((X,ee)=>{H[ee]=!0}),h.value=H}},{immediate:!0});const b=v(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((R,H)=>h.value[H]):[]),g={Read:yl,Write:Pl,Bash:Jl,TodoWrite:fr,Edit:Ir,Grep:On,Glob:On,WebFetch:Nn,WebSearch:Nn,Task:Fc,TaskCreate:su,TaskUpdate:Eu,TaskList:Wu,TaskGet:md,NotebookEdit:Dd,BashOutput:Ln,KillShell:Ln,SlashCommand:vm,Skill:nm,ExitPlanMode:Sm,AskUserQuestion:In},_=v(()=>g[e.toolCall.name]||Xi),r=v(()=>{if(e.toolCall.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[e.toolCall.backendStatus]||e.toolCall.backendStatus;const R=s.getBackendToolState(o.currentSessionId,e.toolCall.id);return R?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[R.state]||R.state:e.toolCall.status}),$=v(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),C=v(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),T=v(()=>r.value==="permission_required"),N=v(()=>e.toolCall.name==="AskUserQuestion"),D=v(()=>!N.value||!S.value?!1:S.value.allQuestionsAnswered),A=v(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0),x=v(()=>e.toolCall.input&&Object.keys(e.toolCall.input).length>0),M=v(()=>e.toolCall.result!=null),q=v(()=>{try{return JSON.stringify(e.toolCall.input,null,2)}catch{return String(e.toolCall.input)}}),F=v(()=>{const R=e.toolCall.result;if(!R)return"";if(typeof R=="string")return R;if(R.content)return typeof R.content=="string"?R.content:JSON.stringify(R.content,null,2);try{return JSON.stringify(R,null,2)}catch{return String(R)}});function U(R){k.value=R}async function W(){if(!(m.value||!S.value)){m.value=!0,f.value="submit-answers";try{const R=o.currentSessionId,H=S.value.getAnswers(),X={questions:e.toolCall.input?.questions||[],answers:H};R&&(s.updateToolCall(R,e.toolCall.id,{input:X}),s.handlePermissionResponse(R,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await a.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",X)}catch(R){console.error("Failed to submit question answers:",R)}finally{m.value=!1,f.value=null}}}async function J(R,H,X=null){if(m.value)return;m.value=!0;const ee=b.value,_e=H&&ee.length>0;R==="allow"?f.value=_e?"approve-apply":"approve":X?f.value="deny-guidance":f.value="deny";try{const Q=o.currentSessionId;if(Q){const he=_e?ee:[];s.handlePermissionResponse(Q,{request_id:e.toolCall.permissionRequestId,decision:R,reasoning:R==="allow"?"User allowed permission":"User denied permission",applied_updates:he})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,R,_e,X,_e?ee:null)}catch(Q){console.error("Failed to send permission response:",Q)}finally{m.value=!1,f.value=null}}function ae(R){return R.type==="setMode"?`Set mode: ${R.mode}`:R.type==="addRules"&&R.rules?.length?`Allow: ${R.rules.map(X=>X.ruleContent?`${X.toolName}(${X.ruleContent})`:X.toolName).join(", ")}`:R.type==="addDirectories"&&R.directories?.length?`Add directories: ${R.directories.join(", ")}`:JSON.stringify(R)}function L(){d.value=!0,wt(()=>{w.value?.focus()})}function j(){const R=w.value;if(!R)return;R.style.height="auto";const H=parseFloat(getComputedStyle(R).lineHeight)*6+10;R.style.height=Math.min(R.scrollHeight,H)+"px"}return(R,H)=>(i(),l("div",Gm,[$.value?(i(),l("div",Ym,[H[9]||(H[9]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[H[8]||(H[8]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,y(C.value?.message||"Session was terminated"),1)])])):E("",!0),N.value&&r.value==="permission_required"?E("",!0):(i(),Ce(wo(_.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),r.value==="permission_required"&&!$.value?(i(),l("div",Jm,[N.value?(i(),l(ne,{key:0},[H[10]||(H[10]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),ye(In,{ref_key:"questionHandlerRef",ref:S,toolCall:n.toolCall,disabled:m.value,onAnswer:U},null,8,["toolCall","disabled"]),t("div",Qm,[t("button",{class:"btn-timeline btn-primary",onClick:W,disabled:m.value||!D.value},y(m.value?"Submitting...":"Submit Answers"),9,Xm),t("button",{class:"btn-timeline btn-secondary",onClick:H[0]||(H[0]=X=>J("deny",!1)),disabled:m.value}," Skip ",8,Zm)])],64)):(i(),l(ne,{key:1},[t("div",ef,[H[12]||(H[12]=t("strong",null,"Permission Required",-1)),t("p",null,[H[11]||(H[11]=ce("Claude wants to use ",-1)),t("code",null,y(n.toolCall.name),1)])]),A.value?(i(),l("div",tf,[H[13]||(H[13]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(i(!0),l(ne,null,ue(n.toolCall.suggestions,(X,ee)=>(i(),l("div",{key:ee,class:"suggestion-item"},[xe(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${ee}`,"onUpdate:modelValue":_e=>h.value[ee]=_e,disabled:m.value},null,8,sf),[[ko,h.value[ee]]]),t("label",{for:`sg-${n.toolCall.id}-${ee}`},[t("code",null,y(ae(X)),1)],8,nf)]))),128))])):E("",!0),t("div",of,[A.value?(i(),l("button",{key:0,class:"btn-timeline btn-approve",onClick:H[1]||(H[1]=X=>J("allow",!0)),disabled:m.value},y(m.value&&f.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,af)):E("",!0),t("button",{class:K(["btn-timeline",A.value?"btn-approve-outline":"btn-approve"]),onClick:H[2]||(H[2]=X=>J("allow",!1)),disabled:m.value},y(A.value?"Approve Only":"Approve"),11,lf),t("button",{class:"btn-timeline btn-deny",onClick:H[3]||(H[3]=X=>J("deny",!1)),disabled:m.value}," Deny ",8,rf)]),t("div",cf,[d.value?E("",!0):(i(),l("a",{key:0,href:"#",class:"guidance-link",onClick:be(L,["prevent"])}," Add guidance... ")),d.value?(i(),l(ne,{key:1},[xe(t("textarea",{ref_key:"guidanceTextarea",ref:w,"onUpdate:modelValue":H[4]||(H[4]=X=>p.value=X),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:m.value,onInput:j},null,40,uf),[[We,p.value]]),p.value.trim()?(i(),l("button",{key:0,class:"btn-timeline btn-guidance",onClick:H[5]||(H[5]=X=>J("deny",!1,p.value)),disabled:m.value}," Provide Guidance & Continue ",8,df)):E("",!0)],64)):E("",!0)])],64))])):E("",!0),r.value==="permission_required"&&$.value?(i(),l("div",mf,[H[14]||(H[14]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,y(C.value?.message||"Session was terminated before permission could be granted"),1)])):E("",!0),n.toolCall.permissionDecision==="deny"?(i(),l("div",ff,[H[15]||(H[15]=ce(" Permission denied ",-1)),n.toolCall.result?.message?(i(),l("span",pf," - "+y(n.toolCall.result.message),1)):E("",!0)])):E("",!0),x.value&&!T.value?(i(),l("div",vf,[t("div",{class:"section-header",onClick:H[6]||(H[6]=X=>c.value=!c.value)},[t("span",null,y(c.value?"â–¾":"â–¸")+" Parameters",1)]),c.value?(i(),l("pre",_f,y(q.value),1)):E("",!0)])):E("",!0),M.value&&!T.value?(i(),l("div",hf,[t("div",{class:"section-header",onClick:H[7]||(H[7]=X=>u.value=!u.value)},[t("span",null,y(u.value?"â–¾":"â–¸")+" Result",1)]),u.value?(i(),l("pre",{key:0,class:K(["detail-pre",{"result-error":n.toolCall.result?.error}])},y(F.value),3)):E("",!0)])):E("",!0)]))}},bf=se(gf,[["__scopeId","data-v-1ed79806"]]),yf=["title"],wf={__name:"TimelineOverflow",props:{count:{type:Number,required:!0}},emits:["toggle"],setup(n){return(e,s)=>(i(),l("div",{class:"timeline-overflow",title:`${n.count} earlier tool calls hidden`,onClick:s[0]||(s[0]=be(o=>e.$emit("toggle"),["stop"]))}," +"+y(n.count),9,yf))}},kf=se(wf,[["__scopeId","data-v-5df52f24"]]),$f={key:0,class:"activity-timeline"},Sf={class:"timeline-row"},xf={class:"timeline-summary"},Cf={class:"summary-count"},Ef={key:0,class:"summary-running"},Tf={key:1,class:"summary-permission"},js=10,Af={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=je(),o=pe(),a=O(null),c=O(!1),u=O({});function m($,C){C&&(u.value[$]=C)}const f=v(()=>[...e.tools].map(($,C)=>({tool:$,originalIndex:C})).sort(($,C)=>{if($.tool.timestamp&&C.tool.timestamp){const T=new Date($.tool.timestamp).getTime(),N=new Date(C.tool.timestamp).getTime();if(T!==N)return T-N}return $.originalIndex-C.originalIndex}).map(({tool:$})=>$)),p=v(()=>f.value.length>js),d=v(()=>p.value?f.value.length-js:0),w=v(()=>!p.value||c.value?f.value:f.value.slice(-js)),h=v(()=>a.value?f.value.find($=>$.id===a.value):null),S=v(()=>f.value.filter($=>b($)==="executing").length),k=v(()=>f.value.filter($=>b($)==="permission_required").length);function b($){const C=o.currentSessionId;return C?$.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[$.backendStatus]||$.backendStatus:s.isToolUseOrphaned(C,$.id)?"orphaned":$.status:$.status}function g($){const C=b($),T=$.result?.error||$.status==="error"||$.permissionDecision==="deny";switch(C){case"completed":return T?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#eab308";case"permission_required":return"#f97316";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function _($){a.value===$?a.value=null:a.value=$}function r(){c.value=!c.value}return($,C)=>f.value.length>0?(i(),l("div",$f,[t("div",Sf,[p.value&&!c.value?(i(),Ce(kf,{key:0,count:d.value,onToggle:r},null,8,["count"])):E("",!0),(i(!0),l(ne,null,ue(w.value,(T,N)=>(i(),l(ne,{key:T.id},[N>0?(i(),Ce(Fi,{key:0,leftColor:g(w.value[N-1]),rightColor:g(T)},null,8,["leftColor","rightColor"])):E("",!0),ye(Ri,{ref_for:!0,ref:D=>m(T.id,D),tool:T,isExpanded:a.value===T.id,onClick:D=>_(T.id)},null,8,["tool","isExpanded","onClick"])],64))),128))]),t("div",xf,[t("span",Cf,y(f.value.length)+" tool"+y(f.value.length!==1?"s":""),1),S.value>0?(i(),l("span",Ef,y(S.value)+" running",1)):E("",!0),k.value>0?(i(),l("span",Tf,y(k.value)+" needs permission",1)):E("",!0)]),a.value&&h.value?(i(),Ce(bf,{key:0,toolCall:h.value},null,8,["toolCall"])):E("",!0)])):E("",!0)}},Df=se(Af,[["__scopeId","data-v-d5aa8da6"]]),Mf={class:"message-row message-row-assistant"},Of=["title"],Nf={class:"message-content-column"},Lf={key:0,class:"thinking-block mb-2"},If=["innerHTML"],jf={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=je(),o=pe();ot.setOptions({breaks:!0,gfm:!0});const a=v(()=>bs(e.message.timestamp)),c=v(()=>e.message.metadata?.model||null),u=v(()=>{const k=a.value;return`assistant${c.value?`
Model: ${c.value}`:""}
${k}`}),m=v(()=>{const k=e.message.content||"";return k.trim().length>0&&k!=="Assistant response"}),f=v(()=>{const k=e.message.content||"";let b=ot.parse(k);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),Xt.sanitize(b)}),p=v(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),d=v(()=>e.message.metadata?.thinking_content||""),w=v(()=>{const k=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return k||b}),h=v(()=>{const k=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],g=[...k],_=new Set(k.map(r=>r.id));for(const r of b)_.has(r.id)||g.push(r);return g}),S=v(()=>{const k=o.currentSessionId;if(!k)return[];const b=s.toolCallsBySession.get(k)||[];return h.value.map(g=>{const _=b.find(r=>r.id===g.id);return _||{id:g.id,name:g.name,input:g.input,status:"pending",result:null,timestamp:g.timestamp||e.message.timestamp,isExpanded:!0}})});return(k,b)=>(i(),l("div",Mf,[t("div",{class:"message-speaker",title:u.value},[...b[0]||(b[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Of),t("div",Nf,[p.value?(i(),l("div",Lf,[ye(Ni,{thinking:d.value},null,8,["thinking"])])):E("",!0),m.value?(i(),l("div",{key:1,class:"message-text",innerHTML:f.value},null,8,If)):E("",!0),w.value?(i(),Ce(Df,{key:2,tools:S.value,messageId:n.message.id},null,8,["tools","messageId"])):E("",!0)])]))}},Pf=se(jf,[["__scopeId","data-v-3085e6bd"]]),Rf={key:0,class:"message-row message-row-compaction"},Bf=["title"],Ff={class:"message-content-column"},Vf={class:"compaction-status-content"},Wf={class:"text-muted ms-auto"},Uf={key:1,class:"message-row message-row-system"},Hf=["title"],qf={class:"message-content-column"},zf={class:"system-text"},Kf={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>bs(e.message.timestamp)),o=v(()=>`system
${s.value}`),a=v(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(c,u)=>a.value?(i(),l("div",Rf,[t("div",{class:"message-speaker",title:o.value},[...u[0]||(u[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,Bf),t("div",Ff,[t("div",Vf,[u[1]||(u[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),u[2]||(u[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",Wf,y(s.value),1)])])])):(i(),l("div",Uf,[t("div",{class:"message-speaker",title:o.value},[...u[3]||(u[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,Hf),t("div",qf,[t("span",zf,y(n.message.content),1)])]))}},jn=se(Kf,[["__scopeId","data-v-a078178f"]]),Gf={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=v(()=>{switch(e.message.type){case"user":return Ci;case"assistant":return Pf;case"system":return jn;default:return jn}});return(o,a)=>(i(),Ce(wo(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Yf=se(Gf,[["__scopeId","data-v-11dff525"]]);var Oe="top",Pe="bottom",Re="right",Ne="left",ys="auto",Wt=[Oe,Pe,Re,Ne],kt="start",It="end",Ao="clippingParents",cn="viewport",At="popper",Do="reference",Zs=Wt.reduce(function(n,e){return n.concat([e+"-"+kt,e+"-"+It])},[]),un=[].concat(Wt,[ys]).reduce(function(n,e){return n.concat([e,e+"-"+kt,e+"-"+It])},[]),Mo="beforeRead",Oo="read",No="afterRead",Lo="beforeMain",Io="main",jo="afterMain",Po="beforeWrite",Ro="write",Bo="afterWrite",Fo=[Mo,Oo,No,Lo,Io,jo,Po,Ro,Bo];function et(n){return n?(n.nodeName||"").toLowerCase():null}function Be(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function $t(n){var e=Be(n).Element;return n instanceof e||n instanceof Element}function Ue(n){var e=Be(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function dn(n){if(typeof ShadowRoot>"u")return!1;var e=Be(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Jf(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},c=e.elements[s];!Ue(c)||!et(c)||(Object.assign(c.style,o),Object.keys(a).forEach(function(u){var m=a[u];m===!1?c.removeAttribute(u):c.setAttribute(u,m===!0?"":m)}))})}function Qf(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],c=e.attributes[o]||{},u=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),m=u.reduce(function(f,p){return f[p]="",f},{});!Ue(a)||!et(a)||(Object.assign(a.style,m),Object.keys(c).forEach(function(f){a.removeAttribute(f)}))})}}const Vo={name:"applyStyles",enabled:!0,phase:"write",fn:Jf,effect:Qf,requires:["computeStyles"]};function Xe(n){return n.split("-")[0]}var yt=Math.max,vs=Math.min,jt=Math.round;function en(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Wo(){return!/^((?!chrome|android).)*safari/i.test(en())}function Pt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,c=1;e&&Ue(n)&&(a=n.offsetWidth>0&&jt(o.width)/n.offsetWidth||1,c=n.offsetHeight>0&&jt(o.height)/n.offsetHeight||1);var u=$t(n)?Be(n):window,m=u.visualViewport,f=!Wo()&&s,p=(o.left+(f&&m?m.offsetLeft:0))/a,d=(o.top+(f&&m?m.offsetTop:0))/c,w=o.width/a,h=o.height/c;return{width:w,height:h,top:d,right:p+w,bottom:d+h,left:p,x:p,y:d}}function mn(n){var e=Pt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Uo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&dn(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function at(n){return Be(n).getComputedStyle(n)}function Xf(n){return["table","td","th"].indexOf(et(n))>=0}function pt(n){return(($t(n)?n.ownerDocument:n.document)||window.document).documentElement}function ws(n){return et(n)==="html"?n:n.assignedSlot||n.parentNode||(dn(n)?n.host:null)||pt(n)}function Pn(n){return!Ue(n)||at(n).position==="fixed"?null:n.offsetParent}function Zf(n){var e=/firefox/i.test(en()),s=/Trident/i.test(en());if(s&&Ue(n)){var o=at(n);if(o.position==="fixed")return null}var a=ws(n);for(dn(a)&&(a=a.host);Ue(a)&&["html","body"].indexOf(et(a))<0;){var c=at(a);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return a;a=a.parentNode}return null}function Zt(n){for(var e=Be(n),s=Pn(n);s&&Xf(s)&&at(s).position==="static";)s=Pn(s);return s&&(et(s)==="html"||et(s)==="body"&&at(s).position==="static")?e:s||Zf(n)||e}function fn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Gt(n,e,s){return yt(n,vs(e,s))}function ep(n,e,s){var o=Gt(n,e,s);return o>s?s:o}function Ho(){return{top:0,right:0,bottom:0,left:0}}function qo(n){return Object.assign({},Ho(),n)}function zo(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var tp=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,qo(typeof e!="number"?e:zo(e,Wt))};function sp(n){var e,s=n.state,o=n.name,a=n.options,c=s.elements.arrow,u=s.modifiersData.popperOffsets,m=Xe(s.placement),f=fn(m),p=[Ne,Re].indexOf(m)>=0,d=p?"height":"width";if(!(!c||!u)){var w=tp(a.padding,s),h=mn(c),S=f==="y"?Oe:Ne,k=f==="y"?Pe:Re,b=s.rects.reference[d]+s.rects.reference[f]-u[f]-s.rects.popper[d],g=u[f]-s.rects.reference[f],_=Zt(c),r=_?f==="y"?_.clientHeight||0:_.clientWidth||0:0,$=b/2-g/2,C=w[S],T=r-h[d]-w[k],N=r/2-h[d]/2+$,D=Gt(C,N,T),A=f;s.modifiersData[o]=(e={},e[A]=D,e.centerOffset=D-N,e)}}function np(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||Uo(e.elements.popper,a)&&(e.elements.arrow=a))}const Ko={name:"arrow",enabled:!0,phase:"main",fn:sp,effect:np,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Rt(n){return n.split("-")[1]}var op={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ap(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:jt(s*a)/a||0,y:jt(o*a)/a||0}}function Rn(n){var e,s=n.popper,o=n.popperRect,a=n.placement,c=n.variation,u=n.offsets,m=n.position,f=n.gpuAcceleration,p=n.adaptive,d=n.roundOffsets,w=n.isFixed,h=u.x,S=h===void 0?0:h,k=u.y,b=k===void 0?0:k,g=typeof d=="function"?d({x:S,y:b}):{x:S,y:b};S=g.x,b=g.y;var _=u.hasOwnProperty("x"),r=u.hasOwnProperty("y"),$=Ne,C=Oe,T=window;if(p){var N=Zt(s),D="clientHeight",A="clientWidth";if(N===Be(s)&&(N=pt(s),at(N).position!=="static"&&m==="absolute"&&(D="scrollHeight",A="scrollWidth")),N=N,a===Oe||(a===Ne||a===Re)&&c===It){C=Pe;var x=w&&N===T&&T.visualViewport?T.visualViewport.height:N[D];b-=x-o.height,b*=f?1:-1}if(a===Ne||(a===Oe||a===Pe)&&c===It){$=Re;var M=w&&N===T&&T.visualViewport?T.visualViewport.width:N[A];S-=M-o.width,S*=f?1:-1}}var q=Object.assign({position:m},p&&op),F=d===!0?ap({x:S,y:b},Be(s)):{x:S,y:b};if(S=F.x,b=F.y,f){var U;return Object.assign({},q,(U={},U[C]=r?"0":"",U[$]=_?"0":"",U.transform=(T.devicePixelRatio||1)<=1?"translate("+S+"px, "+b+"px)":"translate3d("+S+"px, "+b+"px, 0)",U))}return Object.assign({},q,(e={},e[C]=r?b+"px":"",e[$]=_?S+"px":"",e.transform="",e))}function ip(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,c=s.adaptive,u=c===void 0?!0:c,m=s.roundOffsets,f=m===void 0?!0:m,p={placement:Xe(e.placement),variation:Rt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Rn(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:u,roundOffsets:f})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Rn(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Go={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ip,data:{}};var os={passive:!0};function lp(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,c=a===void 0?!0:a,u=o.resize,m=u===void 0?!0:u,f=Be(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&p.forEach(function(d){d.addEventListener("scroll",s.update,os)}),m&&f.addEventListener("resize",s.update,os),function(){c&&p.forEach(function(d){d.removeEventListener("scroll",s.update,os)}),m&&f.removeEventListener("resize",s.update,os)}}const Yo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:lp,data:{}};var rp={left:"right",right:"left",bottom:"top",top:"bottom"};function ds(n){return n.replace(/left|right|bottom|top/g,function(e){return rp[e]})}var cp={start:"end",end:"start"};function Bn(n){return n.replace(/start|end/g,function(e){return cp[e]})}function pn(n){var e=Be(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function vn(n){return Pt(pt(n)).left+pn(n).scrollLeft}function up(n,e){var s=Be(n),o=pt(n),a=s.visualViewport,c=o.clientWidth,u=o.clientHeight,m=0,f=0;if(a){c=a.width,u=a.height;var p=Wo();(p||!p&&e==="fixed")&&(m=a.offsetLeft,f=a.offsetTop)}return{width:c,height:u,x:m+vn(n),y:f}}function dp(n){var e,s=pt(n),o=pn(n),a=(e=n.ownerDocument)==null?void 0:e.body,c=yt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),u=yt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),m=-o.scrollLeft+vn(n),f=-o.scrollTop;return at(a||s).direction==="rtl"&&(m+=yt(s.clientWidth,a?a.clientWidth:0)-c),{width:c,height:u,x:m,y:f}}function _n(n){var e=at(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function Jo(n){return["html","body","#document"].indexOf(et(n))>=0?n.ownerDocument.body:Ue(n)&&_n(n)?n:Jo(ws(n))}function Yt(n,e){var s;e===void 0&&(e=[]);var o=Jo(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),c=Be(o),u=a?[c].concat(c.visualViewport||[],_n(o)?o:[]):o,m=e.concat(u);return a?m:m.concat(Yt(ws(u)))}function tn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function mp(n,e){var s=Pt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Fn(n,e,s){return e===cn?tn(up(n,s)):$t(e)?mp(e,s):tn(dp(pt(n)))}function fp(n){var e=Yt(ws(n)),s=["absolute","fixed"].indexOf(at(n).position)>=0,o=s&&Ue(n)?Zt(n):n;return $t(o)?e.filter(function(a){return $t(a)&&Uo(a,o)&&et(a)!=="body"}):[]}function pp(n,e,s,o){var a=e==="clippingParents"?fp(n):[].concat(e),c=[].concat(a,[s]),u=c[0],m=c.reduce(function(f,p){var d=Fn(n,p,o);return f.top=yt(d.top,f.top),f.right=vs(d.right,f.right),f.bottom=vs(d.bottom,f.bottom),f.left=yt(d.left,f.left),f},Fn(n,u,o));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m}function Qo(n){var e=n.reference,s=n.element,o=n.placement,a=o?Xe(o):null,c=o?Rt(o):null,u=e.x+e.width/2-s.width/2,m=e.y+e.height/2-s.height/2,f;switch(a){case Oe:f={x:u,y:e.y-s.height};break;case Pe:f={x:u,y:e.y+e.height};break;case Re:f={x:e.x+e.width,y:m};break;case Ne:f={x:e.x-s.width,y:m};break;default:f={x:e.x,y:e.y}}var p=a?fn(a):null;if(p!=null){var d=p==="y"?"height":"width";switch(c){case kt:f[p]=f[p]-(e[d]/2-s[d]/2);break;case It:f[p]=f[p]+(e[d]/2-s[d]/2);break}}return f}function Bt(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,c=s.strategy,u=c===void 0?n.strategy:c,m=s.boundary,f=m===void 0?Ao:m,p=s.rootBoundary,d=p===void 0?cn:p,w=s.elementContext,h=w===void 0?At:w,S=s.altBoundary,k=S===void 0?!1:S,b=s.padding,g=b===void 0?0:b,_=qo(typeof g!="number"?g:zo(g,Wt)),r=h===At?Do:At,$=n.rects.popper,C=n.elements[k?r:h],T=pp($t(C)?C:C.contextElement||pt(n.elements.popper),f,d,u),N=Pt(n.elements.reference),D=Qo({reference:N,element:$,placement:a}),A=tn(Object.assign({},$,D)),x=h===At?A:N,M={top:T.top-x.top+_.top,bottom:x.bottom-T.bottom+_.bottom,left:T.left-x.left+_.left,right:x.right-T.right+_.right},q=n.modifiersData.offset;if(h===At&&q){var F=q[a];Object.keys(M).forEach(function(U){var W=[Re,Pe].indexOf(U)>=0?1:-1,J=[Oe,Pe].indexOf(U)>=0?"y":"x";M[U]+=F[J]*W})}return M}function vp(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,c=s.rootBoundary,u=s.padding,m=s.flipVariations,f=s.allowedAutoPlacements,p=f===void 0?un:f,d=Rt(o),w=d?m?Zs:Zs.filter(function(k){return Rt(k)===d}):Wt,h=w.filter(function(k){return p.indexOf(k)>=0});h.length===0&&(h=w);var S=h.reduce(function(k,b){return k[b]=Bt(n,{placement:b,boundary:a,rootBoundary:c,padding:u})[Xe(b)],k},{});return Object.keys(S).sort(function(k,b){return S[k]-S[b]})}function _p(n){if(Xe(n)===ys)return[];var e=ds(n);return[Bn(n),e,Bn(e)]}function hp(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,c=a===void 0?!0:a,u=s.altAxis,m=u===void 0?!0:u,f=s.fallbackPlacements,p=s.padding,d=s.boundary,w=s.rootBoundary,h=s.altBoundary,S=s.flipVariations,k=S===void 0?!0:S,b=s.allowedAutoPlacements,g=e.options.placement,_=Xe(g),r=_===g,$=f||(r||!k?[ds(g)]:_p(g)),C=[g].concat($).reduce(function(Q,he){return Q.concat(Xe(he)===ys?vp(e,{placement:he,boundary:d,rootBoundary:w,padding:p,flipVariations:k,allowedAutoPlacements:b}):he)},[]),T=e.rects.reference,N=e.rects.popper,D=new Map,A=!0,x=C[0],M=0;M<C.length;M++){var q=C[M],F=Xe(q),U=Rt(q)===kt,W=[Oe,Pe].indexOf(F)>=0,J=W?"width":"height",ae=Bt(e,{placement:q,boundary:d,rootBoundary:w,altBoundary:h,padding:p}),L=W?U?Re:Ne:U?Pe:Oe;T[J]>N[J]&&(L=ds(L));var j=ds(L),R=[];if(c&&R.push(ae[F]<=0),m&&R.push(ae[L]<=0,ae[j]<=0),R.every(function(Q){return Q})){x=q,A=!1;break}D.set(q,R)}if(A)for(var H=k?3:1,X=function(he){var z=C.find(function(P){var I=D.get(P);if(I)return I.slice(0,he).every(function(V){return V})});if(z)return x=z,"break"},ee=H;ee>0;ee--){var _e=X(ee);if(_e==="break")break}e.placement!==x&&(e.modifiersData[o]._skip=!0,e.placement=x,e.reset=!0)}}const Xo={name:"flip",enabled:!0,phase:"main",fn:hp,requiresIfExists:["offset"],data:{_skip:!1}};function Vn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Wn(n){return[Oe,Re,Pe,Ne].some(function(e){return n[e]>=0})}function gp(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,c=e.modifiersData.preventOverflow,u=Bt(e,{elementContext:"reference"}),m=Bt(e,{altBoundary:!0}),f=Vn(u,o),p=Vn(m,a,c),d=Wn(f),w=Wn(p);e.modifiersData[s]={referenceClippingOffsets:f,popperEscapeOffsets:p,isReferenceHidden:d,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":w})}const Zo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:gp};function bp(n,e,s){var o=Xe(n),a=[Ne,Oe].indexOf(o)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,u=c[0],m=c[1];return u=u||0,m=(m||0)*a,[Ne,Re].indexOf(o)>=0?{x:m,y:u}:{x:u,y:m}}function yp(n){var e=n.state,s=n.options,o=n.name,a=s.offset,c=a===void 0?[0,0]:a,u=un.reduce(function(d,w){return d[w]=bp(w,e.rects,c),d},{}),m=u[e.placement],f=m.x,p=m.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=f,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=u}const ea={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:yp};function wp(n){var e=n.state,s=n.name;e.modifiersData[s]=Qo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const ta={name:"popperOffsets",enabled:!0,phase:"read",fn:wp,data:{}};function kp(n){return n==="x"?"y":"x"}function $p(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,c=a===void 0?!0:a,u=s.altAxis,m=u===void 0?!1:u,f=s.boundary,p=s.rootBoundary,d=s.altBoundary,w=s.padding,h=s.tether,S=h===void 0?!0:h,k=s.tetherOffset,b=k===void 0?0:k,g=Bt(e,{boundary:f,rootBoundary:p,padding:w,altBoundary:d}),_=Xe(e.placement),r=Rt(e.placement),$=!r,C=fn(_),T=kp(C),N=e.modifiersData.popperOffsets,D=e.rects.reference,A=e.rects.popper,x=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,M=typeof x=="number"?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,F={x:0,y:0};if(N){if(c){var U,W=C==="y"?Oe:Ne,J=C==="y"?Pe:Re,ae=C==="y"?"height":"width",L=N[C],j=L+g[W],R=L-g[J],H=S?-A[ae]/2:0,X=r===kt?D[ae]:A[ae],ee=r===kt?-A[ae]:-D[ae],_e=e.elements.arrow,Q=S&&_e?mn(_e):{width:0,height:0},he=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Ho(),z=he[W],P=he[J],I=Gt(0,D[ae],Q[ae]),V=$?D[ae]/2-H-I-z-M.mainAxis:X-I-z-M.mainAxis,Z=$?-D[ae]/2+H+I+P+M.mainAxis:ee+I+P+M.mainAxis,oe=e.elements.arrow&&Zt(e.elements.arrow),$e=oe?C==="y"?oe.clientTop||0:oe.clientLeft||0:0,Ge=(U=q?.[C])!=null?U:0,Y=L+V-Ge-$e,re=L+Z-Ge,ve=Gt(S?vs(j,Y):j,L,S?yt(R,re):R);N[C]=ve,F[C]=ve-L}if(m){var ge,Ee=C==="x"?Oe:Ne,tt=C==="x"?Pe:Re,Ye=N[T],ht=T==="y"?"height":"width",B=Ye+g[Ee],te=Ye-g[tt],ie=[Oe,Ne].indexOf(_)!==-1,we=(ge=q?.[T])!=null?ge:0,me=ie?B:Ye-D[ht]-A[ht]-we+M.altAxis,Te=ie?Ye+D[ht]+A[ht]-we-M.altAxis:te,Ae=S&&ie?ep(me,Ye,Te):Gt(S?me:B,Ye,S?Te:te);N[T]=Ae,F[T]=Ae-Ye}e.modifiersData[o]=F}}const sa={name:"preventOverflow",enabled:!0,phase:"main",fn:$p,requiresIfExists:["offset"]};function Sp(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function xp(n){return n===Be(n)||!Ue(n)?pn(n):Sp(n)}function Cp(n){var e=n.getBoundingClientRect(),s=jt(e.width)/n.offsetWidth||1,o=jt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Ep(n,e,s){s===void 0&&(s=!1);var o=Ue(e),a=Ue(e)&&Cp(e),c=pt(e),u=Pt(n,a,s),m={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(o||!o&&!s)&&((et(e)!=="body"||_n(c))&&(m=xp(e)),Ue(e)?(f=Pt(e,!0),f.x+=e.clientLeft,f.y+=e.clientTop):c&&(f.x=vn(c))),{x:u.left+m.scrollLeft-f.x,y:u.top+m.scrollTop-f.y,width:u.width,height:u.height}}function Tp(n){var e=new Map,s=new Set,o=[];n.forEach(function(c){e.set(c.name,c)});function a(c){s.add(c.name);var u=[].concat(c.requires||[],c.requiresIfExists||[]);u.forEach(function(m){if(!s.has(m)){var f=e.get(m);f&&a(f)}}),o.push(c)}return n.forEach(function(c){s.has(c.name)||a(c)}),o}function Ap(n){var e=Tp(n);return Fo.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function Dp(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Mp(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Un={placement:"bottom",modifiers:[],strategy:"absolute"};function Hn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function na(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,c=a===void 0?Un:a;return function(m,f,p){p===void 0&&(p=c);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Un,c),modifiersData:{},elements:{reference:m,popper:f},attributes:{},styles:{}},w=[],h=!1,S={state:d,setOptions:function(_){var r=typeof _=="function"?_(d.options):_;b(),d.options=Object.assign({},c,d.options,r),d.scrollParents={reference:$t(m)?Yt(m):m.contextElement?Yt(m.contextElement):[],popper:Yt(f)};var $=Ap(Mp([].concat(o,d.options.modifiers)));return d.orderedModifiers=$.filter(function(C){return C.enabled}),k(),S.update()},forceUpdate:function(){if(!h){var _=d.elements,r=_.reference,$=_.popper;if(Hn(r,$)){d.rects={reference:Ep(r,Zt($),d.options.strategy==="fixed"),popper:mn($)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(M){return d.modifiersData[M.name]=Object.assign({},M.data)});for(var C=0;C<d.orderedModifiers.length;C++){if(d.reset===!0){d.reset=!1,C=-1;continue}var T=d.orderedModifiers[C],N=T.fn,D=T.options,A=D===void 0?{}:D,x=T.name;typeof N=="function"&&(d=N({state:d,options:A,name:x,instance:S})||d)}}}},update:Dp(function(){return new Promise(function(g){S.forceUpdate(),g(d)})}),destroy:function(){b(),h=!0}};if(!Hn(m,f))return S;S.setOptions(p).then(function(g){!h&&p.onFirstUpdate&&p.onFirstUpdate(g)});function k(){d.orderedModifiers.forEach(function(g){var _=g.name,r=g.options,$=r===void 0?{}:r,C=g.effect;if(typeof C=="function"){var T=C({state:d,name:_,instance:S,options:$}),N=function(){};w.push(T||N)}})}function b(){w.forEach(function(g){return g()}),w=[]}return S}}var Op=[Yo,ta,Go,Vo,ea,Xo,sa,Ko,Zo],hn=na({defaultModifiers:Op});const oa=Object.freeze(Object.defineProperty({__proto__:null,afterMain:jo,afterRead:No,afterWrite:Bo,applyStyles:Vo,arrow:Ko,auto:ys,basePlacements:Wt,beforeMain:Lo,beforeRead:Mo,beforeWrite:Po,bottom:Pe,clippingParents:Ao,computeStyles:Go,createPopper:hn,detectOverflow:Bt,end:It,eventListeners:Yo,flip:Xo,hide:Zo,left:Ne,main:Io,modifierPhases:Fo,offset:ea,placements:un,popper:At,popperGenerator:na,popperOffsets:ta,preventOverflow:sa,read:Oo,reference:Do,right:Re,start:kt,top:Oe,variationPlacements:Zs,viewport:cn,write:Ro},Symbol.toStringTag,{value:"Module"}));const rt=new Map,Ps={set(n,e,s){rt.has(n)||rt.set(n,new Map);const o=rt.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return rt.has(n)&&rt.get(n).get(e)||null},remove(n,e){if(!rt.has(n))return;const s=rt.get(n);s.delete(e),s.size===0&&rt.delete(n)}},Np=1e6,Lp=1e3,sn="transitionend",aa=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),Ip=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),jp=n=>{do n+=Math.floor(Math.random()*Np);while(document.getElementById(n));return n},Pp=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*Lp)},ia=n=>{n.dispatchEvent(new Event(sn))},st=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ut=n=>st(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(aa(n)):null,Ut=n=>{if(!st(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},dt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",la=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?la(n.parentNode):null},_s=()=>{},es=n=>{n.offsetHeight},ra=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Rs=[],Rp=n=>{document.readyState==="loading"?(Rs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Rs)e()}),Rs.push(n)):n()},He=()=>document.documentElement.dir==="rtl",ze=n=>{Rp(()=>{const e=ra();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Le=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,ca=(n,e,s=!0)=>{if(!s){Le(n);return}const a=Pp(e)+5;let c=!1;const u=({target:m})=>{m===e&&(c=!0,e.removeEventListener(sn,u),Le(n))};e.addEventListener(sn,u),setTimeout(()=>{c||ia(e)},a)},gn=(n,e,s,o)=>{const a=n.length;let c=n.indexOf(e);return c===-1?!s&&o?n[a-1]:n[0]:(c+=s?1:-1,o&&(c=(c+a)%a),n[Math.max(0,Math.min(c,a-1))])},Bp=/[^.]*(?=\..*)\.|.*/,Fp=/\..*/,Vp=/::\d+$/,Bs={};let qn=1;const ua={mouseenter:"mouseover",mouseleave:"mouseout"},Wp=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function da(n,e){return e&&`${e}::${qn++}`||n.uidEvent||qn++}function ma(n){const e=da(n);return n.uidEvent=e,Bs[e]=Bs[e]||{},Bs[e]}function Up(n,e){return function s(o){return bn(o,{delegateTarget:n}),s.oneOff&&G.off(n,o.type,e),e.apply(n,[o])}}function Hp(n,e,s){return function o(a){const c=n.querySelectorAll(e);for(let{target:u}=a;u&&u!==this;u=u.parentNode)for(const m of c)if(m===u)return bn(a,{delegateTarget:u}),o.oneOff&&G.off(n,a.type,e,s),s.apply(u,[a])}}function fa(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function pa(n,e,s){const o=typeof e=="string",a=o?s:e||s;let c=va(n);return Wp.has(c)||(c=n),[o,a,c]}function zn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[c,u,m]=pa(e,s,o);e in ua&&(u=(k=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return k.call(this,b)})(u));const f=ma(n),p=f[m]||(f[m]={}),d=fa(p,u,c?s:null);if(d){d.oneOff=d.oneOff&&a;return}const w=da(u,e.replace(Bp,"")),h=c?Hp(n,s,u):Up(n,u);h.delegationSelector=c?s:null,h.callable=u,h.oneOff=a,h.uidEvent=w,p[w]=h,n.addEventListener(m,h,c)}function nn(n,e,s,o,a){const c=fa(e[s],o,a);c&&(n.removeEventListener(s,c,!!a),delete e[s][c.uidEvent])}function qp(n,e,s,o){const a=e[s]||{};for(const[c,u]of Object.entries(a))c.includes(o)&&nn(n,e,s,u.callable,u.delegationSelector)}function va(n){return n=n.replace(Fp,""),ua[n]||n}const G={on(n,e,s,o){zn(n,e,s,o,!1)},one(n,e,s,o){zn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,c,u]=pa(e,s,o),m=u!==e,f=ma(n),p=f[u]||{},d=e.startsWith(".");if(typeof c<"u"){if(!Object.keys(p).length)return;nn(n,f,u,c,a?s:null);return}if(d)for(const w of Object.keys(f))qp(n,f,w,e.slice(1));for(const[w,h]of Object.entries(p)){const S=w.replace(Vp,"");(!m||e.includes(S))&&nn(n,f,u,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=ra(),a=va(e),c=e!==a;let u=null,m=!0,f=!0,p=!1;c&&o&&(u=o.Event(e,s),o(n).trigger(u),m=!u.isPropagationStopped(),f=!u.isImmediatePropagationStopped(),p=u.isDefaultPrevented());const d=bn(new Event(e,{bubbles:m,cancelable:!0}),s);return p&&d.preventDefault(),f&&n.dispatchEvent(d),d.defaultPrevented&&u&&u.preventDefault(),d}};function bn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Kn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Fs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const nt={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Fs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Fs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=Kn(n.dataset[o])}return e},getDataAttribute(n,e){return Kn(n.getAttribute(`data-bs-${Fs(e)}`))}};class ts{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=st(s)?nt.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...st(s)?nt.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const c=e[o],u=st(c)?"element":Ip(c);if(!new RegExp(a).test(u))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${u}" but expected type "${a}".`)}}}const zp="5.3.8";class Ke extends ts{constructor(e,s){super(),e=ut(e),e&&(this._element=e,this._config=this._getConfig(s),Ps.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Ps.remove(this._element,this.constructor.DATA_KEY),G.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){ca(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Ps.get(ut(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return zp}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Vs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>aa(s)).join(","):null},de={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!dt(s)&&Ut(s))},getSelectorFromElement(n){const e=Vs(n);return e&&de.findOne(e)?e:null},getElementFromSelector(n){const e=Vs(n);return e?de.findOne(e):null},getMultipleElementsFromSelector(n){const e=Vs(n);return e?de.find(e):[]}},ks=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;G.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),dt(this))return;const c=de.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(c)[e]()})},Kp="alert",Gp="bs.alert",_a=`.${Gp}`,Yp=`close${_a}`,Jp=`closed${_a}`,Qp="fade",Xp="show";class $s extends Ke{static get NAME(){return Kp}close(){if(G.trigger(this._element,Yp).defaultPrevented)return;this._element.classList.remove(Xp);const s=this._element.classList.contains(Qp);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),G.trigger(this._element,Jp),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=$s.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ks($s,"close");ze($s);const Zp="button",ev="bs.button",tv=`.${ev}`,sv=".data-api",nv="active",Gn='[data-bs-toggle="button"]',ov=`click${tv}${sv}`;class Ss extends Ke{static get NAME(){return Zp}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(nv))}static jQueryInterface(e){return this.each(function(){const s=Ss.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}G.on(document,ov,Gn,n=>{n.preventDefault();const e=n.target.closest(Gn);Ss.getOrCreateInstance(e).toggle()});ze(Ss);const av="swipe",Ht=".bs.swipe",iv=`touchstart${Ht}`,lv=`touchmove${Ht}`,rv=`touchend${Ht}`,cv=`pointerdown${Ht}`,uv=`pointerup${Ht}`,dv="touch",mv="pen",fv="pointer-event",pv=40,vv={endCallback:null,leftCallback:null,rightCallback:null},_v={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class hs extends ts{constructor(e,s){super(),this._element=e,!(!e||!hs.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return vv}static get DefaultType(){return _v}static get NAME(){return av}dispose(){G.off(this._element,Ht)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Le(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=pv)return;const s=e/this._deltaX;this._deltaX=0,s&&Le(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(G.on(this._element,cv,e=>this._start(e)),G.on(this._element,uv,e=>this._end(e)),this._element.classList.add(fv)):(G.on(this._element,iv,e=>this._start(e)),G.on(this._element,lv,e=>this._move(e)),G.on(this._element,rv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===mv||e.pointerType===dv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const hv="carousel",gv="bs.carousel",vt=`.${gv}`,ha=".data-api",bv="ArrowLeft",yv="ArrowRight",wv=500,zt="next",Et="prev",Dt="left",ms="right",kv=`slide${vt}`,Ws=`slid${vt}`,$v=`keydown${vt}`,Sv=`mouseenter${vt}`,xv=`mouseleave${vt}`,Cv=`dragstart${vt}`,Ev=`load${vt}${ha}`,Tv=`click${vt}${ha}`,ga="carousel",as="active",Av="slide",Dv="carousel-item-end",Mv="carousel-item-start",Ov="carousel-item-next",Nv="carousel-item-prev",ba=".active",ya=".carousel-item",Lv=ba+ya,Iv=".carousel-item img",jv=".carousel-indicators",Pv="[data-bs-slide], [data-bs-slide-to]",Rv='[data-bs-ride="carousel"]',Bv={[bv]:ms,[yv]:Dt},Fv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Vv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class ss extends Ke{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=de.findOne(jv,this._element),this._addEventListeners(),this._config.ride===ga&&this.cycle()}static get Default(){return Fv}static get DefaultType(){return Vv}static get NAME(){return hv}next(){this._slide(zt)}nextWhenVisible(){!document.hidden&&Ut(this._element)&&this.next()}prev(){this._slide(Et)}pause(){this._isSliding&&ia(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){G.one(this._element,Ws,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){G.one(this._element,Ws,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?zt:Et;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&G.on(this._element,$v,e=>this._keydown(e)),this._config.pause==="hover"&&(G.on(this._element,Sv,()=>this.pause()),G.on(this._element,xv,()=>this._maybeEnableCycle())),this._config.touch&&hs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of de.find(Iv,this._element))G.on(o,Cv,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Dt)),rightCallback:()=>this._slide(this._directionToOrder(ms)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),wv+this._config.interval))}};this._swipeHelper=new hs(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Bv[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=de.findOne(ba,this._indicatorsElement);s.classList.remove(as),s.removeAttribute("aria-current");const o=de.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(as),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===zt,c=s||gn(this._getItems(),o,a,this._config.wrap);if(c===o)return;const u=this._getItemIndex(c),m=S=>G.trigger(this._element,S,{relatedTarget:c,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:u});if(m(kv).defaultPrevented||!o||!c)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(u),this._activeElement=c;const d=a?Mv:Dv,w=a?Ov:Nv;c.classList.add(w),es(c),o.classList.add(d),c.classList.add(d);const h=()=>{c.classList.remove(d,w),c.classList.add(as),o.classList.remove(as,w,d),this._isSliding=!1,m(Ws)};this._queueCallback(h,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(Av)}_getActive(){return de.findOne(Lv,this._element)}_getItems(){return de.find(ya,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return He()?e===Dt?Et:zt:e===Dt?zt:Et}_orderToDirection(e){return He()?e===Et?Dt:ms:e===Et?ms:Dt}static jQueryInterface(e){return this.each(function(){const s=ss.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(document,Tv,Pv,function(n){const e=de.getElementFromSelector(this);if(!e||!e.classList.contains(ga))return;n.preventDefault();const s=ss.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(nt.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});G.on(window,Ev,()=>{const n=de.find(Rv);for(const e of n)ss.getOrCreateInstance(e)});ze(ss);const Wv="collapse",Uv="bs.collapse",ns=`.${Uv}`,Hv=".data-api",qv=`show${ns}`,zv=`shown${ns}`,Kv=`hide${ns}`,Gv=`hidden${ns}`,Yv=`click${ns}${Hv}`,Us="show",Ot="collapse",is="collapsing",Jv="collapsed",Qv=`:scope .${Ot} .${Ot}`,Xv="collapse-horizontal",Zv="width",e_="height",t_=".collapse.show, .collapse.collapsing",on='[data-bs-toggle="collapse"]',s_={parent:null,toggle:!0},n_={parent:"(null|element)",toggle:"boolean"};class Ft extends Ke{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=de.find(on);for(const a of o){const c=de.getSelectorFromElement(a),u=de.find(c).filter(m=>m===this._element);c!==null&&u.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return s_}static get DefaultType(){return n_}static get NAME(){return Wv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(t_).filter(m=>m!==this._element).map(m=>Ft.getOrCreateInstance(m,{toggle:!1}))),e.length&&e[0]._isTransitioning||G.trigger(this._element,qv).defaultPrevented)return;for(const m of e)m.hide();const o=this._getDimension();this._element.classList.remove(Ot),this._element.classList.add(is),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(is),this._element.classList.add(Ot,Us),this._element.style[o]="",G.trigger(this._element,zv)},u=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[u]}px`}hide(){if(this._isTransitioning||!this._isShown()||G.trigger(this._element,Kv).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,es(this._element),this._element.classList.add(is),this._element.classList.remove(Ot,Us);for(const a of this._triggerArray){const c=de.getElementFromSelector(a);c&&!this._isShown(c)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(is),this._element.classList.add(Ot),G.trigger(this._element,Gv)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Us)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ut(e.parent),e}_getDimension(){return this._element.classList.contains(Xv)?Zv:e_}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(on);for(const s of e){const o=de.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=de.find(Qv,this._config.parent);return de.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Jv,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Ft.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}G.on(document,Yv,on,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of de.getMultipleElementsFromSelector(this))Ft.getOrCreateInstance(e,{toggle:!1}).toggle()});ze(Ft);const Yn="dropdown",o_="bs.dropdown",xt=`.${o_}`,yn=".data-api",a_="Escape",Jn="Tab",i_="ArrowUp",Qn="ArrowDown",l_=2,r_=`hide${xt}`,c_=`hidden${xt}`,u_=`show${xt}`,d_=`shown${xt}`,wa=`click${xt}${yn}`,ka=`keydown${xt}${yn}`,m_=`keyup${xt}${yn}`,Mt="show",f_="dropup",p_="dropend",v_="dropstart",__="dropup-center",h_="dropdown-center",gt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',g_=`${gt}.${Mt}`,fs=".dropdown-menu",b_=".navbar",y_=".navbar-nav",w_=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",k_=He()?"top-end":"top-start",$_=He()?"top-start":"top-end",S_=He()?"bottom-end":"bottom-start",x_=He()?"bottom-start":"bottom-end",C_=He()?"left-start":"right-start",E_=He()?"right-start":"left-start",T_="top",A_="bottom",D_={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},M_={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ze extends Ke{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=de.next(this._element,fs)[0]||de.prev(this._element,fs)[0]||de.findOne(fs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return D_}static get DefaultType(){return M_}static get NAME(){return Yn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(dt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!G.trigger(this._element,u_,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(y_))for(const o of[].concat(...document.body.children))G.on(o,"mouseover",_s);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Mt),this._element.classList.add(Mt),G.trigger(this._element,d_,e)}}hide(){if(dt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!G.trigger(this._element,r_,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))G.off(o,"mouseover",_s);this._popper&&this._popper.destroy(),this._menu.classList.remove(Mt),this._element.classList.remove(Mt),this._element.setAttribute("aria-expanded","false"),nt.removeDataAttribute(this._menu,"popper"),G.trigger(this._element,c_,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!st(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Yn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof oa>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:st(this._config.reference)?e=ut(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=hn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Mt)}_getPlacement(){const e=this._parent;if(e.classList.contains(p_))return C_;if(e.classList.contains(v_))return E_;if(e.classList.contains(__))return T_;if(e.classList.contains(h_))return A_;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(f_)?s?$_:k_:s?x_:S_}_detectNavbar(){return this._element.closest(b_)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(nt.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Le(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=de.find(w_,this._menu).filter(a=>Ut(a));o.length&&gn(o,s,e===Qn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===l_||e.type==="keyup"&&e.key!==Jn)return;const s=de.find(g_);for(const o of s){const a=Ze.getInstance(o);if(!a||a._config.autoClose===!1)continue;const c=e.composedPath(),u=c.includes(a._menu);if(c.includes(a._element)||a._config.autoClose==="inside"&&!u||a._config.autoClose==="outside"&&u||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Jn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const m={relatedTarget:a._element};e.type==="click"&&(m.clickEvent=e),a._completeHide(m)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===a_,a=[i_,Qn].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const c=this.matches(gt)?this:de.prev(this,gt)[0]||de.next(this,gt)[0]||de.findOne(gt,e.delegateTarget.parentNode),u=Ze.getOrCreateInstance(c);if(a){e.stopPropagation(),u.show(),u._selectMenuItem(e);return}u._isShown()&&(e.stopPropagation(),u.hide(),c.focus())}}G.on(document,ka,gt,Ze.dataApiKeydownHandler);G.on(document,ka,fs,Ze.dataApiKeydownHandler);G.on(document,wa,Ze.clearMenus);G.on(document,m_,Ze.clearMenus);G.on(document,wa,gt,function(n){n.preventDefault(),Ze.getOrCreateInstance(this).toggle()});ze(Ze);const $a="backdrop",O_="fade",Xn="show",Zn=`mousedown.bs.${$a}`,N_={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},L_={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Sa extends ts{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return N_}static get DefaultType(){return L_}static get NAME(){return $a}show(e){if(!this._config.isVisible){Le(e);return}this._append();const s=this._getElement();this._config.isAnimated&&es(s),s.classList.add(Xn),this._emulateAnimation(()=>{Le(e)})}hide(e){if(!this._config.isVisible){Le(e);return}this._getElement().classList.remove(Xn),this._emulateAnimation(()=>{this.dispose(),Le(e)})}dispose(){this._isAppended&&(G.off(this._element,Zn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(O_),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ut(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),G.on(e,Zn,()=>{Le(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){ca(e,this._getElement(),this._config.isAnimated)}}const I_="focustrap",j_="bs.focustrap",gs=`.${j_}`,P_=`focusin${gs}`,R_=`keydown.tab${gs}`,B_="Tab",F_="forward",eo="backward",V_={autofocus:!0,trapElement:null},W_={autofocus:"boolean",trapElement:"element"};class xa extends ts{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return V_}static get DefaultType(){return W_}static get NAME(){return I_}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),G.off(document,gs),G.on(document,P_,e=>this._handleFocusin(e)),G.on(document,R_,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,G.off(document,gs))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=de.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===eo?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===B_&&(this._lastTabNavDirection=e.shiftKey?eo:F_)}}const to=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",so=".sticky-top",ls="padding-right",no="margin-right";class an{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ls,s=>s+e),this._setElementAttributes(to,ls,s=>s+e),this._setElementAttributes(so,no,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ls),this._resetElementAttributes(to,ls),this._resetElementAttributes(so,no)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),c=u=>{if(u!==this._element&&window.innerWidth>u.clientWidth+a)return;this._saveInitialAttribute(u,s);const m=window.getComputedStyle(u).getPropertyValue(s);u.style.setProperty(s,`${o(Number.parseFloat(m))}px`)};this._applyManipulationCallback(e,c)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&nt.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const c=nt.getDataAttribute(a,s);if(c===null){a.style.removeProperty(s);return}nt.removeDataAttribute(a,s),a.style.setProperty(s,c)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(st(e)){s(e);return}for(const o of de.find(e,this._element))s(o)}}const U_="modal",H_="bs.modal",qe=`.${H_}`,q_=".data-api",z_="Escape",K_=`hide${qe}`,G_=`hidePrevented${qe}`,Ca=`hidden${qe}`,Ea=`show${qe}`,Y_=`shown${qe}`,J_=`resize${qe}`,Q_=`click.dismiss${qe}`,X_=`mousedown.dismiss${qe}`,Z_=`keydown.dismiss${qe}`,eh=`click${qe}${q_}`,oo="modal-open",th="fade",ao="show",Hs="modal-static",sh=".modal.show",nh=".modal-dialog",oh=".modal-body",ah='[data-bs-toggle="modal"]',ih={backdrop:!0,focus:!0,keyboard:!0},lh={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class St extends Ke{constructor(e,s){super(e,s),this._dialog=de.findOne(nh,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new an,this._addEventListeners()}static get Default(){return ih}static get DefaultType(){return lh}static get NAME(){return U_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||G.trigger(this._element,Ea,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(oo),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||G.trigger(this._element,K_).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(ao),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){G.off(window,qe),G.off(this._dialog,qe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Sa({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new xa({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=de.findOne(oh,this._dialog);s&&(s.scrollTop=0),es(this._element),this._element.classList.add(ao);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,G.trigger(this._element,Y_,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){G.on(this._element,Z_,e=>{if(e.key===z_){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),G.on(window,J_,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),G.on(this._element,X_,e=>{G.one(this._element,Q_,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(oo),this._resetAdjustments(),this._scrollBar.reset(),G.trigger(this._element,Ca)})}_isAnimated(){return this._element.classList.contains(th)}_triggerBackdropTransition(){if(G.trigger(this._element,G_).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Hs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Hs),this._queueCallback(()=>{this._element.classList.remove(Hs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=He()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=He()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}G.on(document,eh,ah,function(n){const e=de.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),G.one(e,Ea,a=>{a.defaultPrevented||G.one(e,Ca,()=>{Ut(this)&&this.focus()})});const s=de.findOne(sh);s&&St.getInstance(s).hide(),St.getOrCreateInstance(e).toggle(this)});ks(St);ze(St);const rh="offcanvas",ch="bs.offcanvas",lt=`.${ch}`,Ta=".data-api",uh=`load${lt}${Ta}`,dh="Escape",io="show",lo="showing",ro="hiding",mh="offcanvas-backdrop",Aa=".offcanvas.show",fh=`show${lt}`,ph=`shown${lt}`,vh=`hide${lt}`,co=`hidePrevented${lt}`,Da=`hidden${lt}`,_h=`resize${lt}`,hh=`click${lt}${Ta}`,gh=`keydown.dismiss${lt}`,bh='[data-bs-toggle="offcanvas"]',yh={backdrop:!0,keyboard:!0,scroll:!1},wh={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class mt extends Ke{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return yh}static get DefaultType(){return wh}static get NAME(){return rh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||G.trigger(this._element,fh,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new an().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(lo);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(io),this._element.classList.remove(lo),G.trigger(this._element,ph,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||G.trigger(this._element,vh).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(ro),this._backdrop.hide();const s=()=>{this._element.classList.remove(io,ro),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new an().reset(),G.trigger(this._element,Da)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){G.trigger(this._element,co);return}this.hide()},s=!!this._config.backdrop;return new Sa({className:mh,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new xa({trapElement:this._element})}_addEventListeners(){G.on(this._element,gh,e=>{if(e.key===dh){if(this._config.keyboard){this.hide();return}G.trigger(this._element,co)}})}static jQueryInterface(e){return this.each(function(){const s=mt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}G.on(document,hh,bh,function(n){const e=de.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),dt(this))return;G.one(e,Da,()=>{Ut(this)&&this.focus()});const s=de.findOne(Aa);s&&s!==e&&mt.getInstance(s).hide(),mt.getOrCreateInstance(e).toggle(this)});G.on(window,uh,()=>{for(const n of de.find(Aa))mt.getOrCreateInstance(n).show()});G.on(window,_h,()=>{for(const n of de.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&mt.getOrCreateInstance(n).hide()});ks(mt);ze(mt);const kh=/^aria-[\w-]*$/i,Ma={"*":["class","dir","id","lang","role",kh],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},$h=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Sh=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,xh=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?$h.has(s)?!!Sh.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Ch(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),c=[].concat(...a.body.querySelectorAll("*"));for(const u of c){const m=u.nodeName.toLowerCase();if(!Object.keys(e).includes(m)){u.remove();continue}const f=[].concat(...u.attributes),p=[].concat(e["*"]||[],e[m]||[]);for(const d of f)xh(d,p)||u.removeAttribute(d.nodeName)}return a.body.innerHTML}const Eh="TemplateFactory",Th={allowList:Ma,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Ah={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Dh={entry:"(string|element|function|null)",selector:"(string|element)"};class Mh extends ts{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Th}static get DefaultType(){return Ah}static get NAME(){return Eh}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,c]of Object.entries(this._config.content))this._setContent(e,c,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},Dh)}_setContent(e,s,o){const a=de.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(st(s)){this._putElementInTemplate(ut(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Ch(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Le(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Oh="tooltip",Nh=new Set(["sanitize","allowList","sanitizeFn"]),qs="fade",Lh="modal",rs="show",Ih=".tooltip-inner",uo=`.${Lh}`,mo="hide.bs.modal",Kt="hover",zs="focus",Ks="click",jh="manual",Ph="hide",Rh="hidden",Bh="show",Fh="shown",Vh="inserted",Wh="click",Uh="focusin",Hh="focusout",qh="mouseenter",zh="mouseleave",Kh={AUTO:"auto",TOP:"top",RIGHT:He()?"left":"right",BOTTOM:"bottom",LEFT:He()?"right":"left"},Gh={allowList:Ma,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Yh={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class qt extends Ke{constructor(e,s){if(typeof oa>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Gh}static get DefaultType(){return Yh}static get NAME(){return Oh}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),G.off(this._element.closest(uo),mo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=G.trigger(this._element,this.constructor.eventName(Bh)),o=(la(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:c}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(c.append(a),G.trigger(this._element,this.constructor.eventName(Vh))),this._popper=this._createPopper(a),a.classList.add(rs),"ontouchstart"in document.documentElement)for(const m of[].concat(...document.body.children))G.on(m,"mouseover",_s);const u=()=>{G.trigger(this._element,this.constructor.eventName(Fh)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(u,this.tip,this._isAnimated())}hide(){if(!this._isShown()||G.trigger(this._element,this.constructor.eventName(Ph)).defaultPrevented)return;if(this._getTipElement().classList.remove(rs),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))G.off(a,"mouseover",_s);this._activeTrigger[Ks]=!1,this._activeTrigger[zs]=!1,this._activeTrigger[Kt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),G.trigger(this._element,this.constructor.eventName(Rh)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(qs,rs),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=jp(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(qs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Mh({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Ih]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(qs)}_isShown(){return this.tip&&this.tip.classList.contains(rs)}_createPopper(e){const s=Le(this._config.placement,[this,e,this._element]),o=Kh[s.toUpperCase()];return hn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Le(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Le(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")G.on(this._element,this.constructor.eventName(Wh),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[Ks]=!(a._isShown()&&a._activeTrigger[Ks]),a.toggle()});else if(s!==jh){const o=s===Kt?this.constructor.eventName(qh):this.constructor.eventName(Uh),a=s===Kt?this.constructor.eventName(zh):this.constructor.eventName(Hh);G.on(this._element,o,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusin"?zs:Kt]=!0,u._enter()}),G.on(this._element,a,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusout"?zs:Kt]=u._element.contains(c.relatedTarget),u._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},G.on(this._element.closest(uo),mo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=nt.getDataAttributes(this._element);for(const o of Object.keys(s))Nh.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ut(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=qt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(qt);const Jh="popover",Qh=".popover-header",Xh=".popover-body",Zh={...qt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},eg={...qt.DefaultType,content:"(null|string|element|function)"};class wn extends qt{static get Default(){return Zh}static get DefaultType(){return eg}static get NAME(){return Jh}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Qh]:this._getTitle(),[Xh]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=wn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(wn);const tg="scrollspy",sg="bs.scrollspy",kn=`.${sg}`,ng=".data-api",og=`activate${kn}`,fo=`click${kn}`,ag=`load${kn}${ng}`,ig="dropdown-item",Tt="active",lg='[data-bs-spy="scroll"]',Gs="[href]",rg=".nav, .list-group",po=".nav-link",cg=".nav-item",ug=".list-group-item",dg=`${po}, ${cg} > ${po}, ${ug}`,mg=".dropdown",fg=".dropdown-toggle",pg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},vg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class xs extends Ke{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return pg}static get DefaultType(){return vg}static get NAME(){return tg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ut(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(G.off(this._config.target,fo),G.on(this._config.target,fo,Gs,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=u=>this._targetLinks.get(`#${u.target.id}`),o=u=>{this._previousScrollData.visibleEntryTop=u.target.offsetTop,this._process(s(u))},a=(this._rootElement||document.documentElement).scrollTop,c=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const u of e){if(!u.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(u));continue}const m=u.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(c&&m){if(o(u),!a)return;continue}!c&&!m&&o(u)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=de.find(Gs,this._config.target);for(const s of e){if(!s.hash||dt(s))continue;const o=de.findOne(decodeURI(s.hash),this._element);Ut(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Tt),this._activateParents(e),G.trigger(this._element,og,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(ig)){de.findOne(fg,e.closest(mg)).classList.add(Tt);return}for(const s of de.parents(e,rg))for(const o of de.prev(s,dg))o.classList.add(Tt)}_clearActiveClass(e){e.classList.remove(Tt);const s=de.find(`${Gs}.${Tt}`,e);for(const o of s)o.classList.remove(Tt)}static jQueryInterface(e){return this.each(function(){const s=xs.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(window,ag,()=>{for(const n of de.find(lg))xs.getOrCreateInstance(n)});ze(xs);const _g="tab",hg="bs.tab",Ct=`.${hg}`,gg=`hide${Ct}`,bg=`hidden${Ct}`,yg=`show${Ct}`,wg=`shown${Ct}`,kg=`click${Ct}`,$g=`keydown${Ct}`,Sg=`load${Ct}`,xg="ArrowLeft",vo="ArrowRight",Cg="ArrowUp",_o="ArrowDown",Ys="Home",ho="End",bt="active",go="fade",Js="show",Eg="dropdown",Oa=".dropdown-toggle",Tg=".dropdown-menu",Qs=`:not(${Oa})`,Ag='.list-group, .nav, [role="tablist"]',Dg=".nav-item, .list-group-item",Mg=`.nav-link${Qs}, .list-group-item${Qs}, [role="tab"]${Qs}`,Na='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Xs=`${Mg}, ${Na}`,Og=`.${bt}[data-bs-toggle="tab"], .${bt}[data-bs-toggle="pill"], .${bt}[data-bs-toggle="list"]`;class Vt extends Ke{constructor(e){super(e),this._parent=this._element.closest(Ag),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),G.on(this._element,$g,s=>this._keydown(s)))}static get NAME(){return _g}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?G.trigger(s,gg,{relatedTarget:e}):null;G.trigger(e,yg,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(bt),this._activate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Js);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),G.trigger(e,wg,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(go))}_deactivate(e,s){if(!e)return;e.classList.remove(bt),e.blur(),this._deactivate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Js);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),G.trigger(e,bg,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(go))}_keydown(e){if(![xg,vo,Cg,_o,Ys,ho].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!dt(a));let o;if([Ys,ho].includes(e.key))o=s[e.key===Ys?0:s.length-1];else{const a=[vo,_o].includes(e.key);o=gn(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),Vt.getOrCreateInstance(o).show())}_getChildren(){return de.find(Xs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=de.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(Eg))return;const a=(c,u)=>{const m=de.findOne(c,o);m&&m.classList.toggle(u,s)};a(Oa,bt),a(Tg,Js),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(bt)}_getInnerElement(e){return e.matches(Xs)?e:de.findOne(Xs,e)}_getOuterElement(e){return e.closest(Dg)||e}static jQueryInterface(e){return this.each(function(){const s=Vt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(document,kg,Na,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!dt(this)&&Vt.getOrCreateInstance(this).show()});G.on(window,Sg,()=>{for(const n of de.find(Og))Vt.getOrCreateInstance(n)});ze(Vt);const Ng="toast",Lg="bs.toast",_t=`.${Lg}`,Ig=`mouseover${_t}`,jg=`mouseout${_t}`,Pg=`focusin${_t}`,Rg=`focusout${_t}`,Bg=`hide${_t}`,Fg=`hidden${_t}`,Vg=`show${_t}`,Wg=`shown${_t}`,Ug="fade",bo="hide",cs="show",us="showing",Hg={animation:"boolean",autohide:"boolean",delay:"number"},qg={animation:!0,autohide:!0,delay:5e3};class Cs extends Ke{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return qg}static get DefaultType(){return Hg}static get NAME(){return Ng}show(){if(G.trigger(this._element,Vg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Ug);const s=()=>{this._element.classList.remove(us),G.trigger(this._element,Wg),this._maybeScheduleHide()};this._element.classList.remove(bo),es(this._element),this._element.classList.add(cs,us),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||G.trigger(this._element,Bg).defaultPrevented)return;const s=()=>{this._element.classList.add(bo),this._element.classList.remove(us,cs),G.trigger(this._element,Fg)};this._element.classList.add(us),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(cs),super.dispose()}isShown(){return this._element.classList.contains(cs)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){G.on(this._element,Ig,e=>this._onInteraction(e,!0)),G.on(this._element,jg,e=>this._onInteraction(e,!1)),G.on(this._element,Pg,e=>this._onInteraction(e,!0)),G.on(this._element,Rg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ks(Cs);ze(Cs);const zg={class:"message-content-column"},Kg=["id"],Gg={class:"accordion-item"},Yg=["id"],Jg=["aria-controls"],Qg={class:"d-flex align-items-center w-100"},Xg={class:"badge bg-warning text-dark ms-auto me-2"},Zg={class:"text-muted"},eb=["id","aria-labelledby"],tb={class:"accordion-body bg-light"},sb={class:"alert alert-warning mb-3",role:"alert"},nb={class:"compaction-metadata"},ob={class:"metadata-row"},ab={class:"metadata-row"},ib={key:0,class:"metadata-row"},lb={class:"continuation-content"},rb={class:"continuation-text border rounded p-3 bg-white"},cb={class:"mb-0"},ub={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=v(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=v(()=>`heading-${s.value}`),a=v(()=>`collapse-${s.value}`),c=O(null);let u=null;De(()=>{c.value&&(u=new Ft(c.value,{toggle:!1}))}),Ia(()=>{u&&u.dispose()});function m(){u&&u.toggle()}const f=v(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),p=v(()=>f.value?e.messages[3]:e.messages[2]),d=v(()=>p.value?.metadata?.init_data?.compact_metadata||{}),w=v(()=>d.value.pre_tokens||0),h=v(()=>f.value?e.messages[4]:e.messages[3]),S=v(()=>h.value?.content||""),k=v(()=>{const g=e.messages[0]?.timestamp;return g?bs(g):""});function b(g){return g?`${g.toLocaleString()} tokens`:"0 tokens"}return(g,_)=>(i(),l("div",{class:"message-row message-row-compaction",key:s.value},[_[7]||(_[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",zg,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Gg,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":a.value,onClick:m},[t("div",Qg,[_[0]||(_[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),_[1]||(_[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",Xg,y(b(w.value)),1),t("small",Zg,y(k.value),1)])],8,Jg)],8,Yg),t("div",{ref_key:"collapseElement",ref:c,id:a.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",tb,[t("div",sb,[_[5]||(_[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),ce(" Compaction Details ")],-1)),t("div",nb,[t("div",ob,[_[2]||(_[2]=t("strong",null,"Trigger:",-1)),t("span",null,y(d.value.trigger||"auto"),1)]),t("div",ab,[_[3]||(_[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,y(b(w.value)),1)]),d.value.post_tokens?(i(),l("div",ib,[_[4]||(_[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,y(b(d.value.post_tokens)),1)])):E("",!0)])]),t("div",lb,[_[6]||(_[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),ce(" Continuation Message ")],-1)),t("div",rb,[t("pre",cb,y(S.value),1)])])])],8,eb)])],8,Kg)])]))}},db=se(ub,[["__scopeId","data-v-e0b95ba8"]]),mb={key:0,class:"text-muted text-center py-5"},fb={__name:"MessageList",setup(n){const e=je(),s=Se(),o=O(null),a=v(()=>{const d=e.currentMessages,w=[];let h=0;for(;h<d.length;){const S=d[h];if(u(S,d,h)){const k=d[h+2],g=k?.type==="system"&&k?.metadata?.subtype==="init"?5:4,_=d.slice(h,h+g);w.push({type:"compaction",messages:_}),h+=g;continue}f(S)&&w.push({type:"message",message:S,attachedTools:[]}),h++}return c(w)});function c(d){const w=new Map,h=new Set;for(let k=0;k<d.length;k++){const b=d[k];if(b.type==="compaction")continue;const g=b.message,_=g.content&&g.content.trim().length>0&&g.content!=="Assistant response",r=g.type==="assistant"&&g.metadata?.has_tool_uses&&g.metadata?.tool_uses?.length>0;if(g.type==="assistant"&&r&&!_){let $=-1,C=!1;for(let T=k-1;T>=0;T--){const N=d[T];if(!h.has(T)){if(N.type==="message"&&N.message.type!=="assistant"){C=!0;break}if(N.type==="message"&&N.message.type==="assistant"){const D=N.message;if(D.content&&D.content.trim().length>0&&D.content!=="Assistant response"){$=T;break}else{$=T;break}}}}C&&$===-1||(C&&$>=0?(w.has($)||w.set($,[]),w.get($).push(...g.metadata.tool_uses),h.add(k)):!C&&$>=0&&(w.has($)||w.set($,[]),w.get($).push(...g.metadata.tool_uses),h.add(k)))}}const S=[];for(let k=0;k<d.length;k++){if(h.has(k))continue;const b=d[k];w.has(k)&&(b.attachedTools=[...b.attachedTools||[],...w.get(k)]),S.push(b)}return S}function u(d,w,h){if(h+3>=w.length)return!1;const S=w[h],k=w[h+1];let b=w[h+2],g=w[h+3],_=w[h+4];const r=S.type==="system"&&S.metadata?.subtype==="status"&&S.metadata?.init_data?.status==="compacting",$=k.type==="system"&&k.metadata?.subtype==="status"&&(k.metadata?.init_data?.status===null||k.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(h+4>=w.length)return!1;const T=!0,N=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",D=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return S.type==="system"&&S.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",r),console.log("  Msg2 (null status):",$),console.log("  Msg3 (init):",T),console.log("  Msg4 (boundary):",N),console.log("  Msg5 (continuation):",D)),r&&$&&T&&N&&D}else{const T=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",N=g?.type==="user"&&g?.content?.startsWith("This session is being continued from a previous conversation");return S.type==="system"&&S.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",r),console.log("  Msg2 (null status):",$),console.log("  Msg3 (boundary):",T),console.log("  Msg4 (continuation):",N)),r&&$&&T&&N}}async function m(){s.autoScrollEnabled&&(await wt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>a.value.length,m),fe(()=>e.currentToolCalls.length,m),fe(()=>e.currentToolCalls.map(d=>`${d.id}-${d.status}`).join(","),m),De(()=>{setTimeout(()=>{m()},100)});function f(d){const w=d.subtype||d.metadata?.subtype;if(d.type==="system"&&w==="init"||d.type==="system"&&w==="task_notification"||d.type==="result"||d.type==="permission_request"||d.type==="permission_response")return!1;if(d.type==="user"&&d.metadata?.has_tool_results){const h=d.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(d.type==="user"){const h=d.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(d.type==="user"){const h=d.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}if(d.type==="user"){const h=d.metadata||{};if(h.parent_tool_use_id&&!h.has_tool_results)return!1}return!0}function p(d){return{type:d.type||"unknown",content:d.content||"",timestamp:d.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...d.metadata}}}return(d,w)=>(i(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[a.value.length===0?(i(),l("div",mb," No messages yet. Start a conversation! ")):E("",!0),(i(!0),l(ne,null,ue(a.value,(h,S)=>(i(),l(ne,{key:`item-${S}`},[h.type==="message"?(i(),Ce(Yf,{key:0,message:p(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(i(),Ce(db,{key:1,messages:h.messages},null,8,["messages"])):E("",!0)],64))),128))],512))}},pb=se(fb,[["__scopeId","data-v-bb936559"]]),vb={key:0,class:"attachment-list"},_b={key:0,class:"attachment-preview"},hb=["src","alt"],gb={key:1,class:"attachment-icon"},bb={class:"file-type-icon"},yb={class:"attachment-info"},wb=["title"],kb={class:"attachment-size"},$b=["onClick"],Sb={key:2,class:"upload-progress"},xb=["title"],Cb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(f){if(f.type&&f.type.startsWith("image/"))return!0;const p=f.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(p)}function a(f){const p=f.name?.split(".").pop()?.toLowerCase()||"",d=f.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(p)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(p)?"âš™ï¸":["log","txt"].includes(p)||d==="text/plain"?"ðŸ“‹":["md","rst"].includes(p)?"ðŸ“":"ðŸ“"}function c(f){return f?f<1024?f+" B":f<1024*1024?(f/1024).toFixed(1)+" KB":(f/(1024*1024)).toFixed(1)+" MB":""}function u(f,p=20){if(!f||f.length<=p)return f;const d=f.split(".").pop(),w=f.substring(0,f.length-d.length-1);return w.length<=p-d.length-4?f:w.substring(0,p-d.length-4)+"..."+d}function m(f){s("remove",f)}return(f,p)=>n.attachments.length>0?(i(),l("div",vb,[(i(!0),l(ne,null,ue(n.attachments,(d,w)=>(i(),l("div",{key:d.id||w,class:"attachment-item"},[o(d)?(i(),l("div",_b,[t("img",{src:d.preview||d.url,alt:d.name,class:"attachment-thumbnail"},null,8,hb)])):(i(),l("div",gb,[t("span",bb,y(a(d)),1)])),t("div",yb,[t("span",{class:"attachment-name",title:d.name},y(u(d.name)),9,wb),t("span",kb,y(c(d.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:h=>m(w)}," âœ• ",8,$b),d.uploading?(i(),l("div",Sb,[t("div",{class:"progress-bar",style:Ve({width:(d.progress||0)+"%"})},null,4)])):E("",!0),d.error?(i(),l("div",{key:3,class:"upload-error",title:d.error}," âš ï¸ "+y(d.error),9,xb)):E("",!0)]))),128))])):E("",!0)}},Eb=se(Cb,[["__scopeId","data-v-0fcc4974"]]),Tb=["id","aria-selected","onMousedown","onMouseenter"],Ab={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=O(null);return fe(()=>e.selectedIndex,o=>{if(!s.value)return;const a=s.value.children[o];a&&a.scrollIntoView({block:"nearest"})}),(o,a)=>n.commands.length>0?(i(),l("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),l(ne,null,ue(n.commands,(c,u)=>(i(),l("li",{id:`slash-cmd-${u}`,key:c,role:"option",class:K(["slash-command-item",{active:u===n.selectedIndex}]),"aria-selected":u===n.selectedIndex,onMousedown:be(m=>o.$emit("select",c),["prevent"]),onMouseenter:m=>o.$emit("highlight",u)}," /"+y(c),43,Tb))),128))],512)):E("",!0)}},Db=se(Ab,[["__scopeId","data-v-97c65547"]]),Mb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Ob=["disabled"],Nb=["placeholder","disabled","aria-expanded","aria-activedescendant"],Lb=["disabled"],Ib=["disabled"],yo=5*1024*1024,jb={__name:"InputArea",setup(n){const e=pe(),s=ft(),o=Qe(),a=Se(),c=$o("pendingResourceAttachment",O(null)),u=O(null),m=O(null),f=O(window.innerWidth),p=O([]),d=O(!1),w=O(!1),h=O(!1),S=O(""),k=O(0),b=v({get:()=>e.currentInput,set:z=>{e.currentInput=z}}),g=v(()=>e.currentSession?.is_processing||!1),_=v(()=>s.sessionConnected),r=v(()=>e.currentSession?.state==="starting"),$=v(()=>e.currentSessionId),C=v(()=>!!b.value.trim()||p.value.filter(z=>!z.error).length>0),T=v(()=>f.value<768),N=v(()=>r.value?"Session is starting...":_.value?"Type your message to Claude Code...":"Waiting for connection..."),D=v(()=>{const z=$.value;return z?e.initData.get(z)?.slash_commands||[]:[]}),A=v(()=>{const z=S.value.toLowerCase();return D.value.filter(P=>P.toLowerCase().includes(z)).sort((P,I)=>P.localeCompare(I))});function x(){f.value=window.innerWidth}De(()=>{window.addEventListener("resize",x)}),Me(()=>{window.removeEventListener("resize",x)}),fe(c,z=>{z&&(Q(z),c.value=null)});function M(z){if(h.value&&A.value.length>0){const P=A.value.length;if(z.key==="ArrowDown"){z.preventDefault(),k.value=(k.value+1)%P;return}if(z.key==="ArrowUp"){z.preventDefault(),k.value=(k.value-1+P)%P;return}if(z.key==="Enter"){z.preventDefault(),F(A.value[k.value]);return}if(z.key==="Tab"){z.preventDefault(),F(A.value[k.value]);return}}if(z.key==="Escape"&&h.value){z.preventDefault(),h.value=!1;return}if(z.key==="Enter"&&!z.shiftKey){if(T.value)return;z.preventDefault(),ee()}}function q(){const z=u.value;if(!z)return;z.style.height="auto";const P=Math.min(z.scrollHeight,parseInt(getComputedStyle(z).maxHeight));z.style.height=P+"px"}fe(b,z=>{z.startsWith("/")&&D.value.length>0?(S.value=z.slice(1),k.value=0,h.value=A.value.length>0):h.value=!1});function F(z){b.value=`/${z} `,h.value=!1,u.value?.focus(),q()}function U(){m.value?.click()}function W(z){const P=Array.from(z.target.files||[]);L(P),z.target.value=""}function J(z){d.value=!1;const P=Array.from(z.dataTransfer?.files||[]);L(P)}function ae(z){const P=z.clipboardData?.items;if(!P)return;const I=[];for(const V of P)if(V.type.startsWith("image/")){const Z=V.getAsFile();if(Z){const oe=V.type.split("/")[1]||"png",$e=`clipboard-${Date.now()}.${oe}`,Ge=new File([Z],$e,{type:Z.type});I.push(Ge)}}I.length>0&&(z.preventDefault(),L(I))}function L(z){for(const P of z){if(P.size>yo){p.value.push({id:R(),name:P.name,size:P.size,type:P.type,file:P,error:`File too large (max ${yo/(1024*1024)}MB)`});continue}let I=null;P.type.startsWith("image/")&&(I=URL.createObjectURL(P)),p.value.push({id:R(),name:P.name,size:P.size,type:P.type,file:P,preview:I,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function j(z){const P=p.value[z];P.preview&&URL.revokeObjectURL(P.preview),p.value.splice(z,1)}function R(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function H(z){const P=$.value;if(!P)return null;z.uploading=!0,z.progress=0,z.error=null;try{const I=new FormData;I.append("file",z.file);const V=await fetch(`/api/sessions/${P}/files`,{method:"POST",body:I});if(!V.ok){const oe=await V.json().catch(()=>({}));throw new Error(oe.detail||`Upload failed: ${V.status}`)}const Z=await V.json();return z.uploaded=!0,z.uploadedInfo=Z.file,z.progress=100,Z.file}catch(I){return z.error=I.message,null}finally{z.uploading=!1}}async function X(){const z=p.value.filter(P=>!P.uploaded&&!P.error);if(z.length===0)return!0;w.value=!0;try{return(await Promise.all(z.map(H))).every(I=>I!==null)}finally{w.value=!1}}async function ee(){const z=b.value.trim(),P=p.value.filter(Z=>!Z.error).length>0;if(!z&&!P||P&&!await X())return;let I=b.value;const V=p.value.filter(Z=>Z.uploaded&&Z.uploadedInfo).map(Z=>Z.uploadedInfo);if(V.length>0){const Z=V.map(oe=>{const $e=(oe.size_bytes/1024).toFixed(1);return`- ${oe.original_name} (${$e} KB): ${oe.stored_path}`}).join(`
`);I.trim()?I=`${I}

---
Attached files (use Read tool to access):
${Z}`:I=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${Z}`}s.sendMessage(I),b.value="",_e(),u.value&&(u.value.style.height="auto")}function _e(){for(const z of p.value)z.preview&&URL.revokeObjectURL(z.preview);p.value=[]}function Q(z){if(!z||!z.resource_id){console.warn("Invalid resource for attachment:",z);return}const P=$.value;if(!P){console.warn("No current session for resource attachment");return}if(p.value.findIndex(oe=>oe.resourceId===z.resource_id)>=0){console.log("Resource already attached:",z.resource_id);return}const V=o.isImageResource(z);let Z=null;V&&(Z=o.getResourceUrl(P,z.resource_id)),p.value.push({id:R(),resourceId:z.resource_id,name:z.original_filename||z.title||"Resource",size:z.size_bytes||0,type:z.format||"application/octet-stream",file:null,preview:Z,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:z.resource_id,original_name:z.original_filename||z.title,stored_path:z.file_path||`/api/sessions/${P}/resources/${z.resource_id}`,size_bytes:z.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",z.resource_id)}function he(){s.interruptSession()}return(z,P)=>(i(),l("div",{class:K(["border-top",le(a).isRedBackground?"theme-red-panel":"bg-light"])},[_.value?E("",!0):(i(),l("div",Mb,[...P[6]||(P[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),ye(Eb,{attachments:p.value,onRemove:j},null,8,["attachments"]),d.value?(i(),l("div",{key:1,class:"drop-zone-overlay",onDragover:P[0]||(P[0]=be(()=>{},["prevent"])),onDragleave:P[1]||(P[1]=I=>d.value=!1),onDrop:be(J,["prevent"])},[...P[7]||(P[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):E("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:P[4]||(P[4]=be(I=>d.value=!0,["prevent"])),onDragenter:P[5]||(P[5]=be(I=>d.value=!0,["prevent"]))},[h.value?(i(),Ce(Db,{key:0,commands:A.value,"selected-index":k.value,onSelect:F,onHighlight:P[2]||(P[2]=I=>k.value=I)},null,8,["commands","selected-index"])):E("",!0),t("input",{ref_key:"fileInput",ref:m,type:"file",multiple:"",class:"d-none",onChange:W},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:r.value||!_.value,onClick:U}," ðŸ“Ž ",8,Ob),xe(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:u,"onUpdate:modelValue":P[3]||(P[3]=I=>b.value=I),class:"form-control",placeholder:N.value,disabled:r.value||!_.value,rows:"1","aria-expanded":h.value||void 0,"aria-activedescendant":h.value?`slash-cmd-${k.value}`:void 0,onInput:q,onKeydown:M,onPaste:ae},null,40,Nb),[[We,b.value]]),g.value&&!C.value?(i(),l("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:he}," Stop ")):g.value&&C.value?(i(),l("button",{key:2,class:"btn btn-info",disabled:!_.value||r.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:ee},y(w.value?"Uploading...":"Queue"),9,Lb)):(i(),l("button",{key:3,class:"btn btn-primary",disabled:!C.value||!_.value||r.value||w.value,onClick:ee},y(w.value?"Uploading...":"Send"),9,Ib))],32)],2))}},Pb=se(jb,[["__scopeId","data-v-5b1f250e"]]),Rb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Bb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Fb={class:"text-secondary"},Vb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Wb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=Se(),a=v(()=>s.currentSession),c=v(()=>o.isLoading),u=v(()=>o.loadingMessage);return De(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(m,f)=>{if(m!==f&&m!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(m)}finally{o.hideLoading()}}}),Me(()=>{}),(m,f)=>(i(),l("div",Rb,[c.value?(i(),l("div",Bb,[f[0]||(f[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Fb,y(u.value),1)])):E("",!0),a.value?(i(),Ce(Za,{key:1,"session-id":e.sessionId},null,8,["session-id"])):E("",!0),t("div",Vb,[ye(pb)]),ye(Pb),a.value?(i(),Ce(oi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):E("",!0),a.value?(i(),Ce(mi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):E("",!0)]))}},Es=it("legion",()=>{const n=O(new Map),e=O(new Map),s=O(null),o=v(()=>n.value.get(s.value)||[]),a=v(()=>e.value.get(s.value)||[]);function c(k){s.value=k}async function u(k,b=100,g=0){try{const _=await ke.get(`/api/legions/${k}/timeline?limit=${b}&offset=${g}`),r=_.comms||[],$=_.total_count||r.length,C=_.has_more||!1;return r.sort((T,N)=>new Date(T.timestamp)-new Date(N.timestamp)),console.log(`Loaded ${r.length} of ${$} comms for legion ${k}`),n.value.set(k,r),n.value=new Map(n.value),{comms:r,totalCount:$,hasMore:C}}catch(_){throw console.error("Failed to load timeline:",_),_}}function m(k,b){n.value.has(k)||n.value.set(k,[]);const g=n.value.get(k);if(g.some(r=>r.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}g.push(b),n.value=new Map(n.value)}async function f(k,b){try{const _=(await ke.post(`/api/legions/${k}/comms`,b)).comm;return console.log(`Sent comm ${_.comm_id} to legion ${k}`),_}catch(g){throw console.error("Failed to send comm:",g),g}}async function p(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function d(k,b){try{const _=(await ke.post(`/api/legions/${k}/minions`,b)).minion;return await p(k),console.log(`Created minion ${_.minion_id} in legion ${k}`),_}catch(g){throw console.error("Failed to create minion:",g),g}}async function w(k){try{const b=await ke.post(`/api/legions/${k}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${k}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function h(k){try{const b=await ke.post(`/api/legions/${k}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${k}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function S(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:a,setCurrentLegion:c,loadTimeline:u,addComm:m,sendComm:f,loadMinions:p,createMinion:d,haltAll:w,resumeAll:h,clearLegionData:S}}),Ub=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Es},Symbol.toStringTag,{value:"Module"})),Hb={class:"timeline-header border-bottom p-3"},qb={class:"project-name"},zb=["title"],Kb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Fe(),o=v(()=>s.projects.get(e.legionId)),a=v(()=>o.value?.name||"Legion");return(c,u)=>(i(),l("div",Hb,[t("div",null,[t("div",qb,y(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,zb)])]))}},Gb=se(Kb,[["__scopeId","data-v-44f386f5"]]),Yb={class:"timeline-status-bar border-top p-2 bg-light"},Jb={class:"d-flex justify-content-end"},Qb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=Se();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(i(),l("div",Yb,[t("div",Jb,[t("button",{class:K(["btn btn-sm",le(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+y(le(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Xb=se(Qb,[["__scopeId","data-v-891c73db"]]),Zb={class:"comm-composer border-top p-3"},ey={key:0,class:"d-flex gap-2 mb-2"},ty={class:"flex-grow-1"},sy=["disabled"],ny={label:"Minions"},oy=["value"],ay={style:{"min-width":"150px"}},iy=["disabled"],ly={class:"d-flex gap-2 align-items-end position-relative"},ry={class:"flex-grow-1 position-relative"},cy=["disabled"],uy=["onClick","onMouseenter"],dy=["disabled"],my={key:0},fy={key:1},py={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Es(),o=pe(),a=Fe(),c=O(""),u=O("task"),m=O(""),f=O(!1),p=O(window.innerWidth),d=O(!1),w=O([]),h=O(0),S=O(-1),k=O(null),b=O(null),g=v(()=>p.value<768),_=v(()=>{const F=a.projects.get(e.legionId);return!F||!F.session_ids?[]:F.session_ids.map(U=>o.sessions.get(U)).filter(U=>U)}),r=v(()=>c.value&&m.value.trim().length>0);function $(F){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[F.state]||"â—‹"}function C(F){return F.role?`${F.name} (${F.role})`:F.name}function T(){const F=k.value;if(!F)return;F.style.height="auto";const U=Math.min(F.scrollHeight,parseInt(getComputedStyle(F).maxHeight));F.style.height=U+"px"}function N(){const F=k.value;if(!F)return;T();const U=m.value,W=F.selectionStart,J=U.substring(0,W),ae=J.lastIndexOf("#");if(ae===-1){d.value=!1;return}const L=J.substring(ae+1).toLowerCase();if(L.includes(" ")){d.value=!1;return}const j=_.value.filter(R=>R.name.toLowerCase().includes(L)).map(R=>({type:"minion",name:R.name,role:R.role,id:R.session_id,state:R.state}));if(j.length===0){d.value=!1;return}w.value=j,h.value=0,S.value=ae,d.value=!0}function D(){if(!b.value)return;const F=b.value,U=F.children[h.value];if(!U)return;const W=U.offsetTop,J=U.offsetHeight,ae=F.scrollTop,L=F.clientHeight;W<ae?F.scrollTop=W:W+J>ae+L&&(F.scrollTop=W+J-L)}function A(F){if(!d.value){if(F.key==="Enter"&&!F.shiftKey){if(g.value)return;r.value&&(F.preventDefault(),M())}return}if(F.key==="ArrowDown")F.preventDefault(),h.value=(h.value+1)%w.value.length,D();else if(F.key==="ArrowUp")F.preventDefault(),h.value=h.value===0?w.value.length-1:h.value-1,D();else if(F.key==="Enter"){F.preventDefault();const U=w.value[h.value];U&&x(U)}else F.key==="Escape"&&(d.value=!1)}function x(F){const U=k.value;if(!U)return;const W=m.value,J=U.selectionStart,ae=W.substring(0,S.value)+"#"+F.name+" "+W.substring(J);m.value=ae;const L=S.value+F.name.length+2;setTimeout(()=>{U.setSelectionRange(L,L),U.focus()},0),d.value=!1}async function M(){if(!(!r.value||f.value)){f.value=!0;try{const[F,U]=c.value.split(":"),W={comm_type:u.value,content:m.value.trim()};F==="minion"&&(W.to_minion_id=U),await s.sendComm(e.legionId,W),m.value="",T()}catch(F){console.error("Failed to send comm:",F),alert(`Failed to send comm: ${F.message}`)}finally{f.value=!1}}}function q(){p.value=window.innerWidth}return De(()=>{window.addEventListener("resize",q)}),Me(()=>{window.removeEventListener("resize",q)}),fe(d,F=>{if(F){const U=W=>{W.target.closest(".comm-composer")||(d.value=!1,document.removeEventListener("click",U))};setTimeout(()=>document.addEventListener("click",U),0)}}),(F,U)=>(i(),l("div",Zb,[n.hideRecipientSelector?E("",!0):(i(),l("div",ey,[t("div",ty,[xe(t("select",{"onUpdate:modelValue":U[0]||(U[0]=W=>c.value=W),class:"form-select form-select-sm",disabled:f.value},[U[3]||(U[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",ny,[(i(!0),l(ne,null,ue(_.value,W=>(i(),l("option",{key:W.session_id,value:`minion:${W.session_id}`},y($(W))+" "+y(C(W)),9,oy))),128))])],8,sy),[[xn,c.value]])]),t("div",ay,[xe(t("select",{"onUpdate:modelValue":U[1]||(U[1]=W=>u.value=W),class:"form-select form-select-sm",disabled:f.value},[...U[4]||(U[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,iy),[[xn,u.value]])])])),t("div",ly,[t("div",ry,[xe(t("textarea",{ref_key:"contentTextarea",ref:k,"onUpdate:modelValue":U[2]||(U[2]=W=>m.value=W),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:f.value,onInput:N,onKeydown:A},null,40,cy),[[We,m.value]]),d.value?(i(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),l(ne,null,ue(w.value,(W,J)=>(i(),l("div",{key:W.id,class:K(["autocomplete-item px-2 py-1",{"bg-light":J===h.value}]),onClick:ae=>x(W),onMouseenter:ae=>h.value=J},y(W.type==="minion"?$(W):"#ï¸âƒ£")+" "+y(W.name)+y(W.role?` (${W.role})`:""),43,uy))),128))],512)):E("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!r.value||f.value,onClick:M},[f.value?(i(),l("span",my,[...U[5]||(U[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ce(" Sending... ",-1)])])):(i(),l("span",fy,"Send"))],8,dy)])])]))}},vy=se(py,[["__scopeId","data-v-e52b8e8f"]]),_y={class:"message-content-column-full"},hy=["aria-expanded"],gy={class:"comm-sender-recipient"},by={class:"comm-badge-summary"},yy=["title"],wy={class:"comm-summary-text text-muted ms-2"},ky=["aria-label"],$y={key:0,class:"comm-content-body"},Sy=["innerHTML"],xy="ffffffff-ffff-ffff-ffff-ffffffffffff",Cy={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;ot.setOptions({breaks:!0,gfm:!0});const s=O(!1);function o(){s.value=!s.value}const a=v(()=>e.comm.from_minion_id===xy),c=v(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),u=v(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),m=v(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),f=v(()=>{const p=e.comm.content||"";let d=ot.parse(p);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),Xt.sanitize(d)});return(p,d)=>(i(),l("div",{class:K(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",_y,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",gy,[t("strong",{class:K({"system-sender":a.value})},y(n.senderName),3),n.recipientName?(i(),l(ne,{key:0},[d[0]||(d[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,y(n.recipientName),1)],64)):E("",!0)]),t("div",by,[t("span",{class:K(["badge",u.value]),title:c.value},y(n.comm.comm_type),11,yy),t("span",wy,y(m.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,ky)],8,hy),s.value?(i(),l("div",$y,[t("div",{class:"message-text",innerHTML:f.value},null,8,Sy)])):E("",!0)])],2))}},Ey=se(Cy,[["__scopeId","data-v-28513f64"]]),Ty={class:"timeline-view d-flex flex-column h-100"},Ay={key:0,class:"text-center text-muted"},Dy={key:1,class:"text-center text-danger"},My={key:2,class:"text-center text-muted"},Oy={key:3,class:"comm-list"},Ny={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Es();Fe();const o=pe(),a=ft(),c=Se(),u=O(!0),m=O(null),f=O(null),p=v(()=>s.currentComms);function d(g){return g.from_user?"You":g.from_minion_id?g.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(g.from_minion_id)?.name||"Unknown":"Unknown"}function w(g){return g.to_user?"You":g.to_minion_id?o.sessions.get(g.to_minion_id)?.name||"Unknown":"All"}async function h(){c.autoScrollEnabled&&(await wt(),f.value&&(f.value.scrollTop=f.value.scrollHeight))}async function S(){u.value=!0,m.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await wt(),await h(),setTimeout(()=>{h()},100)}catch(g){console.error("Failed to load timeline:",g),g.response?m.value=`${g.message} (${g.response.status})`:m.value=g.message||"Unknown error"}finally{u.value=!1}}function k(){a.connectLegion(e.legionId)}function b(){a.disconnectLegion()}return fe(()=>p.value.length,()=>{h()}),De(()=>{o.currentSessionId=null,S(),k(),setTimeout(()=>{h()},100)}),Me(()=>{b()}),(g,_)=>(i(),l("div",Ty,[ye(Gb,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:f,class:"timeline-messages flex-grow-1 overflow-auto"},[u.value?(i(),l("div",Ay,[..._[0]||(_[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ce(" Loading timeline... ",-1)])])):m.value?(i(),l("div",Dy," Failed to load timeline: "+y(m.value),1)):p.value.length===0?(i(),l("div",My," No messages yet. Minions will appear here once they start communicating. ")):(i(),l("div",Oy,[(i(!0),l(ne,null,ue(p.value,r=>(i(),Ce(Ey,{key:r.comm_id,comm:r,"sender-name":d(r),"recipient-name":w(r)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ye(vy,{"legion-id":n.legionId},null,8,["legion-id"]),ye(Xb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Ly=se(Ny,[["__scopeId","data-v-b6752179"]]),Iy={class:"minion-info flex-grow-1"},jy={class:"minion-name"},Py={key:0,class:"me-1"},Ry={key:1,class:"badge bg-secondary ms-2"},By={key:0,class:"latest-activity text-muted"},Fy={key:0,class:"activity-prefix"},Vy=["title"],Wy={key:1,class:"activity-time ms-1"},Uy={key:1,class:"latest-activity text-muted"},Hy={class:"activity-prefix"},qy=["title"],zy={key:2,class:"latest-activity text-muted fst-italic small"},Ky={class:"node-row"},Gy={class:"node-left"},Yy={key:0,class:"me-2"},Jy={key:1,class:"badge bg-secondary ms-2"},Qy={class:"node-right"},Xy={key:0,class:"latest-message-preview"},Zy={key:0,class:"message-prefix"},ew=["title"],tw={key:1,class:"message-time ms-1"},sw={key:1,class:"last-comm-preview"},nw={class:"comm-direction"},ow=["title"],aw={key:2,class:"text-muted fst-italic small"},iw={class:"node-actions"},lw={key:2,class:"minion-children"},rw={key:1,class:"text-danger small ms-4"},cw={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,a=pe(),c=je(),u=Se(),m=v(()=>!s.minionData||!s.minionData.id?null:a.getSession(s.minionData.id)),f=v(()=>{if(!s.minionData||!s.minionData.id)return null;const x=c.messagesBySession.get(s.minionData.id);if(!x||x.length===0)return null;for(let M=x.length-1;M>=0;M--){const q=x[M],F=q.subtype||q.metadata?.subtype;if(q.type!=="result"&&!(q.type==="system"&&F==="init")&&!(q.type==="system"&&F==="task_notification")&&!(q.type==="permission_request"||q.type==="permission_response")){if(q.type==="user"&&q.metadata?.has_tool_results){const U=q.content||"";if(U.match(/^Tool results?: \d+ results?$/i)||U.trim()==="")continue}if(q.type==="user"){const U=q.content||"";if(U.includes("<command-message>")&&U.includes("skill is running")||U.startsWith("Base directory for this skill:"))continue}if(q.type==="user"){const U=q.content||"";if(U.includes("<command-message>")&&U.includes("<command-name>")&&U.includes("<command-args>")||U.includes("ARGUMENTS:")&&(U.includes("<command-name>")||U.match(/\nARGUMENTS:/)))continue}if(!(q.type==="system"&&q.content==="System message")&&!(q.type==="assistant"&&q.content==="Assistant response")&&(q.type==="user"||q.type==="assistant"||q.type==="system"))return{content:q.content,type:q.type,timestamp:q.timestamp}}}return null}),p=v(()=>{if(!s.minionData)return null;const x={...s.minionData};return m.value&&(x.state=m.value.state,x.is_processing=m.value.is_processing,m.value.name&&(x.name=m.value.name),m.value.latest_message&&(x.latest_message=m.value.latest_message,x.latest_message_type=m.value.latest_message_type,x.latest_message_time=m.value.latest_message_time)),f.value&&(x.latest_message=f.value.content,x.latest_message_type=f.value.type,x.latest_message_time=f.value.timestamp),x}),d=v(()=>s.level*24),w=v(()=>!s.minionData||!s.minionData.id?!1:a.currentSessionId===s.minionData.id),h=v(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),S=v(()=>s.minionData&&s.minionData.is_overseer&&h.value),k=v(()=>{const x=p.value;return x?x.state==="paused"&&x.is_processing?"pending-prompt":x.is_processing?"processing":x.state||"created":"created"}),b=v(()=>{const x=k.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[x]||"status-dot-grey"}),g=v(()=>{const x=k.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[x]||"#d3d3d3"}}),_=v(()=>{const x=p.value;if(!x||!x.latest_message_type)return"";const M=x.latest_message_type;return M==="user"?"User -->:":M==="system"?"System:":""}),r=v(()=>{const x=p.value;if(!x||!x.latest_message)return"";const M=x.latest_message,q=150;return M.length>q?M.slice(0,q)+"...":M}),$=v(()=>{const x=p.value;if(!x||!x.latest_message_time)return"";try{const M=Date.now();let q;if(typeof x.latest_message_time=="number"?q=x.latest_message_time<3250368e4?x.latest_message_time*1e3:x.latest_message_time:q=new Date(x.latest_message_time).getTime(),isNaN(q)||q<9466848e5||q>M+6e4)return console.warn("Invalid timestamp for relative time calculation:",x.latest_message_time,"parsed to:",q),"";const F=M-q;if(F<0)return"just now";const U=Math.floor(F/6e4),W=Math.floor(U/60),J=Math.floor(W/24);return J>0?`${J}d ago`:W>0?`${W}h ago`:U>0?`${U}m ago`:"just now"}catch(M){return console.error("Error calculating relative time:",M,x.latest_message_time),""}});function C(x){return x.to_user?"User":x.to_minion_name?x.to_minion_name:"unknown"}function T(x){const M=x.summary||x.content||"";return M.length>150?M.substring(0,150)+"...":M}function N(){o("minion-click",s.minionData.id)}function D(){const x=a.sessions.get(s.minionData.id);x&&u.showModal("edit-session",{session:x})}function A(){const x=a.sessions.get(s.minionData.id);x&&u.showModal("manage-session",{session:x})}return(x,M)=>{const q=So("MinionTreeNode",!0);return n.minionData?(i(),l("div",{key:0,class:"minion-tree-node",style:Ve({marginLeft:`${d.value}px`})},[n.layout==="sidebar"?(i(),l("div",{key:0,class:K(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:N},[t("div",{class:K(["status-dot me-2",b.value]),style:Ve(g.value)},null,6),t("div",Iy,[t("div",jy,[S.value?(i(),l("span",Py,"ðŸ‘‘")):E("",!0),t("strong",null,y(p.value?.name||n.minionData.name),1),S.value?(i(),l("span",Ry,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):E("",!0)]),p.value?.latest_message?(i(),l("div",By,[_.value?(i(),l("span",Fy,y(_.value),1)):E("",!0),t("span",{class:"activity-content",title:p.value.latest_message},y(r.value),9,Vy),$.value?(i(),l("span",Wy,"("+y($.value)+")",1)):E("",!0)])):n.minionData?.last_comm?(i(),l("div",Uy,[t("span",Hy,[M[1]||(M[1]=ce("â†’ ",-1)),t("strong",null,y(C(n.minionData.last_comm)),1),M[2]||(M[2]=ce(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(T(n.minionData.last_comm)),9,qy)])):(i(),l("div",zy," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:be(D,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:be(A,["stop"])}," âš™ï¸ ")],2)):(i(),l("div",{key:1,class:K(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:N},[t("div",Ky,[t("div",Gy,[t("div",{class:K(["status-dot me-2",b.value]),style:Ve(g.value)},null,6),S.value?(i(),l("span",Yy,"ðŸ‘‘")):E("",!0),t("strong",null,y(p.value?.name||n.minionData.name),1),S.value?(i(),l("span",Jy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):E("",!0)]),t("div",Qy,[p.value?.latest_message?(i(),l("div",Xy,[_.value?(i(),l("span",Zy,y(_.value),1)):E("",!0),t("span",{class:"message-content",title:p.value.latest_message},y(r.value),9,ew),$.value?(i(),l("span",tw,"("+y($.value)+")",1)):E("",!0)])):n.minionData?.last_comm?(i(),l("div",sw,[t("span",nw,[M[3]||(M[3]=ce("â†’ ",-1)),t("strong",null,y(C(n.minionData.last_comm)),1),M[4]||(M[4]=ce(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(T(n.minionData.last_comm)),9,ow)])):(i(),l("div",aw," No activity yet "))]),t("div",iw,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:be(D,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:be(A,["stop"])}," âš™ï¸ ")])])],2)),h.value?(i(),l("div",lw,[(i(!0),l(ne,null,ue(n.minionData.children,F=>(i(),Ce(q,{key:F.id,"minion-data":F,level:n.level+1,layout:n.layout,onMinionClick:M[0]||(M[0]=U=>x.$emit("minion-click",U))},null,8,["minion-data","level","layout"]))),128))])):E("",!0)],4)):(i(),l("div",rw," âš  Minion data is missing "))}}},uw=se(cw,[["__scopeId","data-v-64b23e0e"]]),dw={class:"project-overview d-flex flex-column h-100"},mw={class:"project-overview-header border-bottom p-3"},fw={class:"d-flex align-items-center justify-content-between"},pw={class:"mb-1"},vw={key:0,class:"me-2"},_w={class:"text-muted font-monospace"},hw={class:"d-flex gap-2"},gw=["title"],bw={class:"project-overview-content flex-grow-1 overflow-auto p-3"},yw={key:0,class:"text-center py-5"},ww={key:1,class:"alert alert-danger"},kw={key:2,class:"text-center py-5"},$w={key:3},Sw={class:"row g-3 mb-4"},xw={class:"col-md-4"},Cw={class:"card h-100"},Ew={class:"card-body"},Tw={class:"card-title mb-0"},Aw={class:"text-muted"},Dw={class:"col-md-4"},Mw={class:"card h-100"},Ow={class:"card-body"},Nw={class:"card-title mb-0"},Lw={class:"text-muted"},Iw={key:0,class:"card mb-4"},jw={class:"card mb-4"},Pw={class:"card-header d-flex align-items-center justify-content-between"},Rw={class:"mb-0"},Bw={class:"badge bg-secondary"},Fw={class:"card-body"},Vw={key:0,class:"text-center py-4"},Ww={key:1,class:"text-center text-muted py-4"},Uw={key:2,class:"hierarchy-tree"},Hw={class:"user-root-node mb-3 border rounded bg-white"},qw={class:"node-row"},zw={class:"node-left"},Kw={class:"badge bg-primary ms-2"},Gw={class:"node-right"},Yw={key:0,class:"last-comm-preview"},Jw={class:"comm-direction"},Qw=["title"],Xw={key:1,class:"text-muted fst-italic"},Zw={class:"root-minions ms-4"},e1={class:"card"},t1={class:"card-body"},s1={class:"row mb-0"},n1={class:"col-sm-8 font-monospace text-break"},o1={class:"col-sm-8 font-monospace text-break"},a1={class:"col-sm-8"},i1={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},l1={class:"text-muted"},r1={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Qt(),o=Fe(),a=pe(),c=Se(),u=Es(),m=ft(),f=O(!1),p=O(null),d=O(null),w=O(!1);let h=null;const S=v(()=>o.getProject(e.projectId)),k=v(()=>S.value?.session_ids?S.value.session_ids.map(W=>a.getSession(W)).filter(W=>W!=null):[]),b=v(()=>k.value.length>0),g=v(()=>k.value.length),_=v(()=>k.value.filter(W=>W.state==="ACTIVE").length),r=v(()=>{const W=k.value.some(L=>L.state==="ACTIVE"),J=k.value.some(L=>L.is_processing);return k.value.some(L=>L.state==="ERROR")?"Error":J?"Working":W?"Active":g.value>0?"Idle":"Empty"}),$=v(()=>{switch(r.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),C=v(()=>{switch(r.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function T(){w.value=!0;try{const W=await ke.get(`/api/legions/${e.projectId}/hierarchy`);d.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),d.value=null}finally{w.value=!1}}function N(W,J){if(W&&W.id===J)return W;if(W&&W.children)for(const ae of W.children){const L=N(ae,J);if(L)return L}return null}function D(W){return W.to_user?"User":W.to_minion_name?W.to_minion_name:"unknown"}function A(W){const J=W.summary||W.content||"";return J.length>150?J.substring(0,150)+"...":J}function x(W){if(d.value){if(W.from_minion_id){const J=N(d.value,W.from_minion_id);J&&J.type==="minion"&&(J.last_comm=W)}W.from_user&&d.value.type==="user"&&(d.value.last_comm=W)}}function M(W){s.push(`/session/${W}`)}function q(){s.push(`/timeline/${e.projectId}`)}function F(){c.showModal("edit-project",{project:S.value})}function U(){c.showModal("create-minion",{project:S.value})}return De(()=>{o.selectProject(e.projectId),a.currentSessionId=null,T(),u.setCurrentLegion(e.projectId),m.connectLegion(e.projectId),h=fe(()=>a.sessions,W=>{if(d.value){for(const[J,ae]of W)if(ae.project_id===e.projectId){const L=N(d.value,J);L&&L.type==="minion"&&(L.state!==ae.state&&(L.state=ae.state),L.is_processing!==ae.is_processing&&(L.is_processing=ae.is_processing),L.latest_message!==ae.latest_message&&(L.latest_message=ae.latest_message,L.latest_message_type=ae.latest_message_type,L.latest_message_time=ae.latest_message_time))}}},{deep:!0}),fe(()=>u.commsByLegion.get(e.projectId),W=>{if(W&&W.length>0){const J=W[W.length-1];x(J)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(W,J)=>{W!==J&&T()})}),fe(()=>e.projectId,W=>{o.selectProject(W),a.currentSessionId=null,T(),u.setCurrentLegion(W),m.connectLegion(W)}),Me(()=>{h&&h()}),(W,J)=>(i(),l("div",dw,[t("div",mw,[t("div",fw,[t("div",null,[t("h4",pw,[b.value?(i(),l("span",vw,"ðŸ›")):E("",!0),ce(" "+y(S.value?.name||"Project Overview"),1)]),t("small",_w,y(S.value?.working_directory),1)]),t("div",hw,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:F}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:U}," âž• "+y(b.value?"Add Minion":"Add Session"),9,gw)])])]),t("div",bw,[f.value?(i(),l("div",yw,[...J[0]||(J[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(i(),l("div",ww,y(p.value),1)):S.value?(i(),l("div",$w,[t("div",Sw,[t("div",xw,[t("div",Cw,[t("div",Ew,[J[2]||(J[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",Tw,y(g.value),1),t("small",Aw,y(_.value)+" active",1)])])]),t("div",Dw,[t("div",Mw,[t("div",Ow,[J[3]||(J[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",Nw,[t("span",{class:K($.value)},y(r.value),3)]),t("small",Lw,y(C.value),1)])])])]),b.value?(i(),l("div",Iw,[J[4]||(J[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:q}," ðŸ“Š View Timeline ")])])])):E("",!0),t("div",jw,[t("div",Pw,[t("h5",Rw,"ðŸŒ³ "+y(b.value?"Minion Hierarchy":"Sessions"),1),t("span",Bw,y(k.value.length),1)]),t("div",Fw,[w.value?(i(),l("div",Vw,[...J[5]||(J[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!d.value||!d.value.children||d.value.children.length===0?(i(),l("div",Ww,' No sessions yet. Click "Add Session" to create one. ')):(i(),l("div",Uw,[t("div",Hw,[t("div",qw,[t("div",zw,[J[6]||(J[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,y(d.value.name),1),t("span",Kw,y(d.value.children.length)+" "+y(d.value.children.length===1?"minion":"minions"),1)]),t("div",Gw,[d.value.last_comm?(i(),l("div",Yw,[t("span",Jw,[J[7]||(J[7]=ce(" â†’ ",-1)),t("strong",null,y(D(d.value.last_comm)),1),J[8]||(J[8]=ce(": ",-1))]),t("span",{class:"comm-content",title:d.value.last_comm.content||""},y(A(d.value.last_comm)),9,Qw)])):(i(),l("div",Xw," No communications yet "))])])]),t("div",Zw,[(i(!0),l(ne,null,ue(d.value.children,ae=>(i(),Ce(uw,{key:ae.id,"minion-data":ae,level:1,layout:"two-column",onMinionClick:M},null,8,["minion-data"]))),128))])]))])]),t("div",e1,[J[12]||(J[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",t1,[t("dl",s1,[J[9]||(J[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",n1,y(S.value.working_directory),1),J[10]||(J[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",o1,y(S.value.project_id),1),J[11]||(J[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",a1,y(b.value?"Yes (has minions)":"No"),1)])])])])):(i(),l("div",kw,[...J[1]||(J[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",i1,[J[13]||(J[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",l1,y(g.value)+" session"+y(g.value!==1?"s":""),1)])]))}},c1=se(r1,[["__scopeId","data-v-168bf04c"]]),u1=[{path:"/",name:"home",component:Ua},{path:"/project/:projectId",name:"project",component:c1,props:!0},{path:"/session/:sessionId",name:"session",component:Wb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Ly,props:!0}],d1=ja({history:Pa(),routes:u1}),m1={class:"header-row1"},f1={class:"header-right"},p1={__name:"HeaderRow1",setup(n){const e=Se(),s=ft(),o=v(()=>s.uiConnected);return(a,c)=>(i(),l("div",m1,[c[5]||(c[5]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",f1,[t("div",{class:K(["header-indicator",o.value?"connected":"disconnected"])},[c[4]||(c[4]=t("span",{class:"indicator-dot"},null,-1)),ce(" "+y(o.value?"Connected":"Disconnected"),1)],2),t("button",{class:K(["header-btn",{"theme-active":le(e).isRedBackground}]),onClick:c[0]||(c[0]=u=>le(e).toggleBackgroundColor()),title:"Toggle instance color"},[t("span",{class:"color-swatch",style:Ve({backgroundColor:le(e).isRedBackground?"#ef4444":"#94a3b8"})},null,4)],2),t("button",{class:"header-btn",onClick:c[1]||(c[1]=u=>le(e).showRestartModal()),title:"Restart server"}," â†» "),t("button",{class:"header-btn",onClick:c[2]||(c[2]=u=>le(e).showModal("configuration")),title:"Settings"}," âš™ "),t("button",{class:K(["header-btn panel-toggle-btn",{"panel-open":le(e).rightPanelVisible}]),onClick:c[3]||(c[3]=u=>le(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},v1=se(p1,[["__scopeId","data-v-ed5cbc21"]]),_1=["title"],h1={class:"pill-icon"},g1={class:"pill-name"},b1={key:0,class:"pill-count"},y1={class:"pill-status-bar"},w1={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=Fe(),o=pe(),a=Se(),c=v(()=>e.project.session_ids?.length||0),u=v(()=>c.value>1?"ðŸ”·":c.value===1?"ðŸ’¬":"ðŸ“"),m=v(()=>s.getStatusBarSegments(e.project.project_id,o));function f(){a.setBrowsingProject(e.project.project_id)}function p(){a.showModal("edit-project",{project:e.project})}return(d,w)=>(i(),l("div",{class:K(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:f,onContextmenu:be(p,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",h1,y(u.value),1),t("span",g1,y(n.project.name),1),c.value>0?(i(),l("span",b1,y(c.value),1)):E("",!0),t("div",y1,[(i(!0),l(ne,null,ue(m.value,(h,S)=>(i(),l("div",{key:S,class:K(["seg",h.status]),style:Ve({flex:h.flex})},null,6))),128))])],42,_1))}},k1=se(w1,[["__scopeId","data-v-78d87c4c"]]),$1={class:"project-pill-bar"},S1={__name:"ProjectPillBar",setup(n){const e=Fe(),s=pe(),o=Se(),a=v(()=>e.orderedProjects),c=v(()=>o.browsingProjectId),u=v(()=>{const f=s.currentSession;return f?f.project_id:null});fe(u,f=>{f&&o.setBrowsingProject(f)}),fe(a,f=>{!c.value&&f.length>0&&o.setBrowsingProject(f[0].project_id)},{immediate:!0});function m(){o.showModal("create-project")}return(f,p)=>(i(),l("div",$1,[(i(!0),l(ne,null,ue(a.value,d=>(i(),Ce(k1,{key:d.project_id,project:d,isActive:d.project_id===u.value,isBrowsing:d.project_id===c.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:m,title:"New project"}," + ")]))}},x1=se(S1,[["__scopeId","data-v-6d2c68a7"]]),C1=["title"],E1={class:"ac-info"},T1={class:"ac-name"},A1={class:"ac-status"},D1={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select"],setup(n,{emit:e}){const s=n,o=e;pe();const a=v(()=>s.session.name||s.session.role||"Agent"),c=v(()=>{const d=s.session.state;return d==="error"?"error":d==="paused"?"waiting":d==="active"&&s.session.is_processing?"active":d==="active"?"idle":"none"}),u=v(()=>{const d=s.session.state;return d==="active"&&s.session.is_processing?"Processing...":d==="active"?"Idle":d==="paused"?"Awaiting input":d==="error"?"Error":d==="terminated"?"Stopped":d==="starting"?"Starting...":d==="created"?"Ready":d||"Unknown"}),m=v(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),f=v(()=>{const d=[a.value];return s.session.role&&d.push(`Role: ${s.session.role}`),d.push(`Status: ${u.value}`),s.session.model&&d.push(`Model: ${s.session.model}`),d.join(`
`)});function p(){o("select",s.session.session_id)}return(d,w)=>(i(),l("div",{class:K(["agent-chip",{active:n.isActive,child:n.variant==="child"}]),onClick:p,title:f.value},[t("div",{class:K(["ac-dot",c.value])},null,2),t("div",E1,[t("div",T1,y(a.value),1),t("div",A1,y(u.value),1)]),m.value?(i(),l("div",{key:0,class:K(["ac-alert",m.value])},y(m.value==="error"?"!":"?"),3)):E("",!0)],10,C1))}},ln=se(D1,[["__scopeId","data-v-68f35b25"]]),M1=["title"],O1={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=pe(),o=v(()=>s.getSession(e.sessionId)),a=v(()=>({right:`${-16-e.index*14}px`})),c=v(()=>{if(!o.value)return"dot-none";const f=o.value.state;return f==="active"&&o.value.is_processing?"dot-active":f==="active"?"dot-idle":f==="paused"?"dot-waiting":f==="error"?"dot-error":"dot-none"}),u=v(()=>o.value?o.value.has_pending_permission||o.value.state==="error":!1),m=v(()=>o.value?o.value.state==="error"?"alert-error":"alert-permission":"");return(f,p)=>(i(),l("div",{class:"peek-card",style:Ve(a.value),title:o.value?.name||"Child agent",onClick:p[0]||(p[0]=be(d=>f.$emit("click"),["stop"]))},[t("div",{class:K(["peek-dot",c.value])},null,2),u.value?(i(),l("div",{key:0,class:K(["peek-alert",m.value])},null,2)):E("",!0)],12,M1))}},N1=se(O1,[["__scopeId","data-v-78721d0b"]]),L1={},I1={class:"chip-connector"};function j1(n,e){return i(),l("div",I1)}const P1=se(L1,[["render",j1],["__scopeId","data-v-3fcda21f"]]),R1=["title"],B1={__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1}},emits:["select"],setup(n){const e=n,s=pe(),o=Se(),a=v(()=>s.currentSessionId),c=v(()=>e.session.child_minion_ids||[]),u=v(()=>o.expandedStacks.has(e.session.session_id)),m=v(()=>c.value.slice(0,3)),f=v(()=>u.value||c.value.length===0?{}:{marginRight:`${Math.min(c.value.length,3)*14+4}px`});function p(h){return s.getSession(h)}function d(){o.toggleStack(e.session.session_id)}function w(){u.value||o.toggleStack(e.session.session_id)}return(h,S)=>(i(),l("div",{class:"stacked-chip",style:Ve(f.value)},[t("div",{class:K(["parent-wrapper",{"has-children":c.value.length>0}])},[ye(ln,{session:n.session,isActive:n.isActive,onSelect:S[0]||(S[0]=k=>h.$emit("select",n.session.session_id)),onDblclick:d},null,8,["session","isActive"]),!u.value&&c.value.length>0?(i(!0),l(ne,{key:0},ue(m.value,(k,b)=>(i(),Ce(N1,{key:k,sessionId:k,index:b,onClick:w},null,8,["sessionId","index"]))),128)):E("",!0),c.value.length>0?(i(),l("div",{key:1,class:"stack-count",onClick:be(d,["stop"]),title:`${c.value.length} child agent${c.value.length!==1?"s":""}`},y(c.value.length),9,R1)):E("",!0)],2),u.value?(i(!0),l(ne,{key:0},ue(c.value,k=>(i(),l(ne,{key:k},[ye(P1),p(k)?(i(),Ce(ln,{key:0,session:p(k),isActive:k===a.value,variant:"child",onSelect:b=>h.$emit("select",k)},null,8,["session","isActive","onSelect"])):E("",!0)],64))),128)):E("",!0)],4))}},F1=se(B1,[["__scopeId","data-v-9504b2e3"]]),V1={class:"strip-project-label"},W1={key:0,class:"strip-empty"},U1={key:1,class:"agent-strip agent-strip-empty"},H1={__name:"AgentStrip",setup(n){const e=Fe(),s=pe(),o=Se(),a=Qt(),c=v(()=>s.currentSessionId),u=v(()=>{const b=o.browsingProjectId;return b?e.getProject(b):null}),m=v(()=>{const b=u.value;return!b||!b.session_ids?[]:b.session_ids.map(g=>s.getSession(g)).filter(Boolean).sort((g,_)=>(g.order||0)-(_.order||0))}),f=v(()=>{const b=new Set;for(const g of m.value)if(g.child_minion_ids)for(const _ of g.child_minion_ids)b.add(_);return b}),p=v(()=>m.value.filter(b=>!f.value.has(b.session_id)));function d(b){return b.child_minion_ids&&b.child_minion_ids.length>0}function w(b){return b.child_minion_ids?b.child_minion_ids.includes(c.value):!1}function h(b){const g=s.getSession(b);g&&o.setBrowsingProject(g.project_id),s.selectSession(b),a.push(`/session/${b}`)}function S(b){b.target.classList.contains("agent-strip")&&o.collapseAllStacks()}function k(){const b=u.value;b&&o.showModal("create-minion",{project:b})}return(b,g)=>u.value?(i(),l("div",{key:0,class:"agent-strip",onClick:S},[t("span",V1,y(u.value.name),1),(i(!0),l(ne,null,ue(p.value,_=>(i(),l(ne,{key:_.session_id},[d(_)?(i(),Ce(F1,{key:0,session:_,isActive:_.session_id===c.value||w(_),onSelect:h},null,8,["session","isActive"])):(i(),Ce(ln,{key:1,session:_,isActive:_.session_id===c.value,onSelect:h},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:be(k,["stop"]),title:"Add agent"}," + "),p.value.length===0?(i(),l("span",W1,"No agents yet")):E("",!0)])):(i(),l("div",U1,[...g[0]||(g[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])]))}},q1=se(H1,[["__scopeId","data-v-48eec86f"]]),$n=it("diff",()=>{const n=O(new Map),e=O(!1),s=O(null),o=O("total"),a=O(!1),c=O(null),u=O(null),m=O(null),f=O(new Map),p=v(()=>{const A=pe();return A.currentSessionId&&n.value.get(A.currentSessionId)||null}),d=v(()=>!p.value||!p.value.files?[]:Object.entries(p.value.files).map(([A,x])=>({path:A,...x})).sort((A,x)=>A.path.localeCompare(x.path))),w=v(()=>d.value.length),h=v(()=>!p.value||!p.value.commits?0:p.value.commits.length),S=v(()=>p.value?.is_git_repo===!0),k=v(()=>{if(!c.value||!u.value)return null;const A=m.value||"committed",x=`${c.value}:${A}:${u.value}`;return f.value.get(x)||null});async function b(A){if(A){e.value=!0,s.value=null;try{const x=await Jt(`/api/sessions/${A}/diff`);n.value.set(A,x),n.value=new Map(n.value)}catch(x){console.error(`Failed to load diff for session ${A}:`,x),s.value=x.message}finally{e.value=!1}}}async function g(A){for(const x of f.value.keys())x.startsWith(`${A}:`)&&f.value.delete(x);f.value=new Map(f.value),await b(A)}async function _(A,x,M=null){if(!A||!x)return;const F=`${A}:${M||"committed"}:${x}`,U=f.value.get(F);if(!(U&&!U.error&&U.content!==null)){f.value.set(F,{content:null,loading:!0,error:null}),f.value=new Map(f.value);try{const W={path:x};M&&(W.ref=M);const J=await Jt(`/api/sessions/${A}/diff/file`,{params:W});f.value.set(F,{content:J.diff,loading:!1,error:null})}catch(W){console.error(`Failed to load file diff for ${x}:`,W),f.value.set(F,{content:null,loading:!1,error:W.message})}f.value=new Map(f.value)}}function r(A,x,M=null){c.value=A,u.value=x,m.value=M,a.value=!0,_(A,x,M)}function $(){a.value=!1,m.value=null}function C(){if(!c.value)return;const A=d.value;if(A.length===0)return;const M=(A.findIndex(q=>q.path===u.value)+1)%A.length;u.value=A[M].path,_(c.value,u.value,m.value)}function T(){if(!c.value)return;const A=d.value;if(A.length===0)return;const M=(A.findIndex(q=>q.path===u.value)-1+A.length)%A.length;u.value=A[M].path,_(c.value,u.value,m.value)}function N(A){o.value=A}function D(A){n.value.delete(A),n.value=new Map(n.value);for(const x of f.value.keys())x.startsWith(`${A}:`)&&f.value.delete(x);f.value=new Map(f.value),c.value===A&&$()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:a,fullViewSessionId:c,currentFilePath:u,fullViewRef:m,fileDiffCache:f,currentDiff:p,currentFiles:d,fileCount:w,commitCount:h,isGitRepo:S,currentFullViewFileDiff:k,loadDiff:b,refreshDiff:g,loadFileDiff:_,openFullView:r,closeFullView:$,nextFile:C,prevFile:T,setMode:N,clearDiff:D}}),z1={key:0,class:"agent-overview"},K1={class:"overview-identity"},G1={class:"overview-info"},Y1={class:"overview-name"},J1={key:0,class:"overview-role"},Q1={class:"overview-stats"},X1={class:"stat-item"},Z1={class:"stat-value"},ek={class:"stat-item"},tk={class:"stat-value"},sk={class:"stat-item"},nk={class:"stat-value"},ok={class:"stat-item"},ak={class:"stat-value"},ik={key:1,class:"agent-overview agent-overview-empty"},lk={__name:"AgentOverview",setup(n){const e=pe(),s=je(),o=Se(),a=O(Date.now());let c=null;De(()=>{c=setInterval(()=>{a.value=Date.now()},1e4)}),Me(()=>{c&&clearInterval(c)});const u=v(()=>{const r=e.currentSessionId;return r?e.getSession(r):null}),m=v(()=>(u.value?.name||"A").charAt(0).toUpperCase()),f=v(()=>{const r=u.value?.name||"";let $=0;for(let T=0;T<r.length;T++)$=r.charCodeAt(T)+(($<<5)-$);return`hsl(${Math.abs($%360)}, 60%, 55%)`}),p=v(()=>{if(!u.value)return"status-none";const r=u.value.state;return r==="active"&&u.value.is_processing?"status-active":r==="active"?"status-idle":r==="paused"?"status-waiting":r==="error"?"status-error":r==="terminated"?"status-terminated":"status-none"}),d=v(()=>{if(!u.value)return"None";const r=u.value.state;return r==="active"&&u.value.is_processing?"Processing":r==="active"?"Idle":r==="paused"?"Paused":r==="error"?"Error":r==="terminated"?"Terminated":r==="created"?"Created":r==="starting"?"Starting":r}),w=v(()=>{const r=e.currentSessionId;if(!r)return 0;const $=s.messagesBySession.get(r);return $?$.filter(C=>C.type==="user"||C.type==="assistant").length:0}),h=v(()=>{const r=e.currentSessionId;if(!r)return 0;const $=s.toolCallsBySession.get(r);return $?$.length:0}),S=v(()=>u.value&&u.value.child_minion_ids?.length||0),k=v(()=>{if(!u.value?.started_at)return"--";a.value;const r=new Date(u.value.started_at).getTime(),$=Date.now()-r;if($<0)return"--";const C=Math.floor($/6e4);if(C<60)return`${C}m`;const T=Math.floor(C/60);return T<24?`${T}h ${C%60}m`:`${Math.floor(T/24)}d ${T%24}h`});function b(){u.value&&o.showModal("edit-session",{session:u.value})}function g(){u.value&&o.showModal("manage-session",{session:u.value})}function _(){u.value&&o.showModal("session-info",{sessionId:u.value.session_id})}return(r,$)=>u.value?(i(),l("div",z1,[t("div",K1,[t("div",{class:"overview-avatar",style:Ve({background:f.value})},y(m.value),5),t("div",G1,[t("div",Y1,y(u.value.name||"Agent"),1),u.value.role?(i(),l("div",J1,y(u.value.role),1)):E("",!0),t("span",{class:K(["overview-status-badge",p.value])},y(d.value),3)])]),t("div",Q1,[t("div",X1,[t("span",Z1,y(w.value),1),$[0]||($[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",ek,[t("span",tk,y(h.value),1),$[1]||($[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",sk,[t("span",nk,y(S.value),1),$[2]||($[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",ok,[t("span",ak,y(k.value),1),$[3]||($[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview btn-overview-primary",onClick:b,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:g,title:"Manage session lifecycle"}," Manage "),t("button",{class:"btn-overview",onClick:_,title:"View session details"}," Info ")])])):(i(),l("div",ik,[...$[4]||($[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},rk=se(lk,[["__scopeId","data-v-ed06eb15"]]),ck={class:"task-row d-flex align-items-center gap-2"},uk={key:0,class:"status-icon"},dk={key:1,class:"status-icon"},mk=["title"],fk={key:0,class:"task-details"},pk={key:0,class:"task-description mb-2"},vk={class:"description-content"},_k={key:1,class:"task-owner mb-2"},hk={class:"ms-1"},gk={key:2,class:"task-blocked-by mb-2"},bk={key:3,class:"task-blocks"},yk={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=v(()=>e.task.status==="in_progress"),o=v(()=>e.task.status==="completed"?"âœ…":"â³"),a=v(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),c=v(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(u,m)=>(i(),l("div",{class:K(["task-item",c.value]),onClick:m[0]||(m[0]=f=>u.$emit("toggle"))},[t("div",ck,[s.value?(i(),l("span",uk,[...m[1]||(m[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),l("span",dk,y(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},y(a.value),9,mk),(i(),l("svg",{class:K(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...m[2]||(m[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),l("div",fk,[n.task.description?(i(),l("div",pk,[m[3]||(m[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",vk,y(n.task.description),1)])):E("",!0),n.task.owner?(i(),l("div",_k,[m[4]||(m[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",hk,y(n.task.owner),1)])):E("",!0),n.task.blockedBy?.length>0?(i(),l("div",gk,[m[5]||(m[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),l(ne,null,ue(n.task.blockedBy,f=>(i(),l("span",{key:f,class:"badge bg-warning text-dark me-1"}," #"+y(f),1))),128))])):E("",!0),n.task.blocks?.length>0?(i(),l("div",bk,[m[6]||(m[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),l(ne,null,ue(n.task.blocks,f=>(i(),l("span",{key:f,class:"badge bg-info text-dark me-1"}," #"+y(f),1))),128))])):E("",!0)])):E("",!0)],2))}},wk=se(yk,[["__scopeId","data-v-0f96ae87"]]),kk={class:"task-list-panel"},$k={class:"task-list p-2"},Sk={key:0,class:"text-muted text-center py-4"},xk={__name:"TaskListPanel",setup(n){const e=Nt(),s=O(new Set),o=v(()=>e.currentTasks);function a(c){s.value.has(c)?s.value.delete(c):s.value.add(c),s.value=new Set(s.value)}return(c,u)=>(i(),l("div",kk,[t("div",$k,[o.value.length===0?(i(),l("div",Sk,[...u[0]||(u[0]=[t("span",{class:"empty-icon"},"ðŸ“",-1),t("p",{class:"mb-0 small"},"No tasks yet",-1)])])):E("",!0),ye(Ra,{name:"task-list",tag:"div"},{default:rn(()=>[(i(!0),l(ne,null,ue(o.value,m=>(i(),Ce(wk,{key:m.id,task:m,isExpanded:s.value.has(m.id),onToggle:f=>a(m.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},Ck=se(xk,[["__scopeId","data-v-e1fa565a"]]),Ek={class:"resource-gallery-panel"},Tk={class:"resource-grid-container p-2"},Ak={key:0,class:"text-muted text-center py-4"},Dk={key:1,class:"resource-grid"},Mk=["onClick"],Ok=["onClick","title"],Nk=["src","alt"],Lk=["title","onClick"],Ik={class:"file-icon"},jk={class:"file-ext"},Pk={class:"resource-info"},Rk=["title"],Bk={class:"resource-actions"},Fk=["onClick"],Vk=["href","download"],Wk={__name:"ResourceGallery",setup(n){const e=Qe(),s=pe(),o=$o("addAttachmentFromResource",null),a=v(()=>e.currentResources);function c(b){return e.isImageResource(b)}function u(b){return e.getResourceIcon(b)}function m(b){const g=e.getResourceExtension(b);return g?g.toUpperCase().slice(1):""}function f(b){return e.getResourceUrl(s.currentSessionId,b)}function p(b){return e.getDownloadUrl(s.currentSessionId,b)}function d(b){e.openFullView(s.currentSessionId,b)}function w(b,g=18){return b?b.length<=g?b:b.substring(0,g-3)+"...":""}function h(b){b.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function S(b){e.removeResource(s.currentSessionId,b)}function k(b){o?o(b):console.warn("addAttachmentFromResource not provided")}return(b,g)=>(i(),l("div",Ek,[t("div",Tk,[a.value.length===0?(i(),l("div",Ak,[...g[1]||(g[1]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No resources yet",-1)])])):(i(),l("div",Dk,[(i(!0),l(ne,null,ue(a.value,(_,r)=>(i(),l("div",{key:_.resource_id,class:K(["resource-item",{"is-image":c(_)}])},[t("button",{class:"remove-btn",onClick:be($=>S(_.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...g[2]||(g[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,Mk),c(_)?(i(),l("div",{key:0,class:"resource-thumbnail",onClick:$=>d(r),title:_.title||"Click to view"},[t("img",{src:f(_.resource_id),alt:_.title||"Image",loading:"lazy",onError:h},null,40,Nk)],8,Ok)):(i(),l("div",{key:1,class:"resource-placeholder",title:_.title||_.original_filename||"Click to view",onClick:$=>d(r)},[t("span",Ik,y(u(_)),1),t("span",jk,y(m(_)),1)],8,Lk)),t("div",Pk,[t("div",{class:"resource-title",title:_.title||_.original_filename},y(w(_.title||_.original_filename)),9,Rk),t("div",Bk,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:be($=>k(_),["stop"]),title:"Add to message attachments"},[...g[3]||(g[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,Fk),t("a",{href:p(_.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:_.original_filename||_.title||"download",title:"Download",onClick:g[0]||(g[0]=be(()=>{},["stop"]))},[...g[4]||(g[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,Vk)])])],2))),128))]))])]))}},Uk=se(Wk,[["__scopeId","data-v-93315470"]]),Hk=["src","alt"],qk={key:1,class:"resource-info"},zk={key:0,class:"resource-title"},Kk={key:1,class:"resource-description"},Gk={class:"resource-meta"},Yk={class:"meta-item"},Jk={class:"meta-item"},Qk={class:"meta-item"},Xk={class:"text-header"},Zk={class:"text-header-info"},e$={class:"text-filename"},t$={class:"resource-meta"},s$={key:0,class:"meta-item"},n$={key:1,class:"meta-item"},o$={key:0,class:"display-mode-toggle"},a$=["title","disabled"],i$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},l$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},r$={class:"copy-label"},c$={class:"text-body"},u$={key:0,class:"text-loading"},d$={key:1,class:"text-error"},m$={key:2,class:"text-content"},f$=["innerHTML"],p$={key:4,class:"text-unavailable"},v$={key:4,class:"position-indicator"},_$={key:5,class:"thumbnail-strip"},h$=["onClick"],g$=["src","alt"],b$={key:1,class:"strip-text-icon"},y$={__name:"ResourceFullView",setup(n){ot.setOptions({breaks:!0,gfm:!0});const e=Qe(),s=O(null),o=O(!1),a=O("raw");let c=null;const u=v(()=>e.fullViewOpen),m=v(()=>e.currentFullViewResource),f=v(()=>e.currentResourceIndex),p=v(()=>e.fullViewTotalResources),d=v(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),w=v(()=>e.isImageResource(m.value)),h=v(()=>m.value?e.getTextContent(m.value.resource_id):null),S=v(()=>h.value?.content||null),k=v(()=>h.value?.loading||!1),b=v(()=>h.value?.error||null),g=v(()=>{if(!S.value)return"";let F=ot.parse(S.value);return F=F.replace(/\n</g,"<"),F=F.replace(/\n+$/,""),Xt.sanitize(F)});fe(u,F=>{F?(wt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),fe(f,()=>{a.value="raw"}),fe([f,u],()=>{if(u.value&&m.value&&!w.value){const F=m.value.resource_id,U=e.getTextContent(F);(!U||U.error)&&e.fetchTextContent(e.fullViewSessionId,F)}},{immediate:!0}),Me(()=>{document.body.style.overflow="",c&&clearTimeout(c)});function _(F){return e.getResourceUrl(e.fullViewSessionId,F)}function r(){e.closeFullView()}function $(){e.nextResource()}function C(){e.prevResource()}function T(F){e.goToResource(F)}function N(F){F.target===F.currentTarget&&r()}function D(F){switch(F.key){case"Escape":r();break;case"ArrowLeft":C();break;case"ArrowRight":$();break;case"Home":T(0);break;case"End":T(p.value-1);break;case"m":!w.value&&S.value&&(a.value=a.value==="raw"?"markdown":"raw");break}}async function A(){if(S.value)try{await navigator.clipboard.writeText(S.value),o.value=!0,c&&clearTimeout(c),c=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function x(F){return F?F<1024?`${F} B`:F<1024*1024?`${(F/1024).toFixed(1)} KB`:`${(F/(1024*1024)).toFixed(2)} MB`:""}function M(F){return F?new Date(F*1e3).toLocaleString():""}function q(F){F.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(F,U)=>(i(),Ce(Co,{to:"body"},[ye(xo,{name:"modal"},{default:rn(()=>[u.value?(i(),l("div",{key:0,class:"resource-full-view-overlay",onClick:N,onKeydown:D,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:be(r,["stop"]),title:"Close (Escape)"},[...U[4]||(U[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:be(C,["stop"]),title:"Previous (Left Arrow)"},[...U[5]||(U[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):E("",!0),w.value?(i(),l("div",{key:1,class:"image-container",onClick:U[0]||(U[0]=be(()=>{},["stop"]))},[m.value?(i(),l("img",{key:0,src:_(m.value.resource_id||m.value.image_id),alt:m.value.title||"Image",class:"full-image",onError:q},null,40,Hk)):E("",!0),m.value?(i(),l("div",qk,[m.value.title?(i(),l("h5",zk,y(m.value.title),1)):E("",!0),m.value.description?(i(),l("p",Kk,y(m.value.description),1)):E("",!0),t("div",Gk,[t("span",Yk,y(x(m.value.size_bytes)),1),t("span",Jk,y(m.value.format?.toUpperCase()),1),t("span",Qk,y(M(m.value.timestamp)),1)])])):E("",!0)])):(i(),l("div",{key:2,class:"text-container",onClick:U[3]||(U[3]=be(()=>{},["stop"]))},[t("div",Xk,[t("div",Zk,[t("h5",e$,y(m.value?.title||m.value?.original_filename||"Text Resource"),1),t("div",t$,[m.value?.size_bytes?(i(),l("span",s$,y(x(m.value.size_bytes)),1)):E("",!0),m.value?.format?(i(),l("span",n$,y(m.value.format.toUpperCase()),1)):E("",!0)])]),S.value?(i(),l("div",o$,[t("button",{class:K(["toggle-btn",{active:a.value==="raw"}]),onClick:U[1]||(U[1]=be(W=>a.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:K(["toggle-btn",{active:a.value==="markdown"}]),onClick:U[2]||(U[2]=be(W=>a.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):E("",!0),t("button",{class:"copy-btn",onClick:be(A,["stop"]),title:o.value?"Copied!":a.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!S.value},[o.value?(i(),l("svg",i$,[...U[6]||(U[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",l$,[...U[7]||(U[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",r$,y(o.value?"Copied!":a.value==="markdown"?"Copy raw":"Copy"),1)],8,a$)]),t("div",c$,[k.value?(i(),l("div",u$,[...U[8]||(U[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):b.value?(i(),l("div",d$," Failed to load content: "+y(b.value),1)):S.value&&a.value==="raw"?(i(),l("pre",m$,y(S.value),1)):S.value&&a.value==="markdown"?(i(),l("div",{key:3,class:"markdown-content",innerHTML:g.value},null,8,f$)):(i(),l("div",p$," Preview not available for this file type. "))])])),p.value>1?(i(),l("button",{key:3,class:"nav-btn nav-next",onClick:be($,["stop"]),title:"Next (Right Arrow)"},[...U[9]||(U[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):E("",!0),p.value>1?(i(),l("div",v$,y(f.value+1)+" / "+y(p.value),1)):E("",!0),p.value>1?(i(),l("div",_$,[(i(!0),l(ne,null,ue(d.value,(W,J)=>(i(),l("div",{key:W.resource_id||W.image_id,class:K(["strip-thumbnail",{active:J===f.value,"is-text":!le(e).isImageResource(W)}]),onClick:be(ae=>T(J),["stop"])},[le(e).isImageResource(W)?(i(),l("img",{key:0,src:_(W.resource_id||W.image_id),alt:W.title||"Thumbnail",loading:"lazy"},null,8,g$)):(i(),l("span",b$,y(le(e).getResourceIcon(W)),1))],10,h$))),128))])):E("",!0)],544)):E("",!0)]),_:1})]))}},w$=se(y$,[["__scopeId","data-v-169421b1"]]),k$={class:"diff-panel"},$$={class:"diff-body"},S$={key:0,class:"text-center py-4"},x$={key:1,class:"text-muted text-center py-4"},C$={key:2,class:"text-muted text-center py-4"},E$={class:"mb-0 small"},T$={key:3,class:"text-danger text-center py-4"},A$={class:"mb-0 small"},D$={key:4,class:"text-muted text-center py-4"},M$={key:5},O$={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},N$=["disabled"],L$={class:"stats-bar px-3 py-1 border-bottom small text-muted"},I$={class:"text-success"},j$={class:"text-danger"},P$={class:"ms-2"},R$={key:0,class:"ms-2"},B$={key:0,class:"file-list"},F$=["onClick"],V$=["title"],W$={key:0,class:"file-stats small text-nowrap"},U$={key:0,class:"text-success"},H$={key:1,class:"text-muted"},q$={key:2,class:"text-danger"},z$={key:1,class:"file-stats small text-muted"},K$={key:1,class:"commit-list"},G$=["onClick"],Y$={key:0,class:"wip-badge"},J$={key:1,class:"commit-hash"},Q$=["title"],X$={key:2,class:"commit-date small text-muted text-nowrap"},Z$={key:0,class:"commit-files"},eS=["onClick"],tS=["title"],sS={key:6,class:"text-muted text-center py-4"},nS={__name:"DiffPanel",setup(n){const e=$n(),s=pe(),o=O(new Set);function a(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function c(d,w=null){s.currentSessionId&&e.openFullView(s.currentSessionId,d,w)}function u(d){o.value.has(d)?o.value.delete(d):o.value.add(d),o.value=new Set(o.value)}function m(d){switch(d){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function f(d){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[d]?.status||"modified"}function p(d){if(!d)return"";const w=new Date(d),S=new Date-w,k=Math.floor(S/6e4);if(k<1)return"just now";if(k<60)return`${k}m ago`;const b=Math.floor(k/60);return b<24?`${b}h ago`:`${Math.floor(b/24)}d ago`}return fe(()=>s.currentSessionId,d=>{d&&!e.diffBySession.get(d)&&e.loadDiff(d)},{immediate:!0}),fe(()=>e.currentDiff,d=>{if(d?.commits){const w=d.commits.find(h=>h.is_uncommitted);w&&(o.value.add(w.hash),o.value=new Set(o.value))}},{immediate:!0}),(d,w)=>(i(),l("div",k$,[t("div",$$,[le(e).loading&&!le(e).currentDiff?(i(),l("div",S$,[...w[2]||(w[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):le(e).currentDiff&&!le(e).isGitRepo?(i(),l("div",x$,[...w[3]||(w[3]=[t("p",{class:"mb-0 small"},"Not a git repository",-1)])])):le(e).currentDiff&&le(e).currentDiff.error?(i(),l("div",C$,[t("p",E$,y(le(e).currentDiff.error),1)])):le(e).error?(i(),l("div",T$,[t("p",A$,y(le(e).error),1)])):le(e).currentDiff&&le(e).fileCount===0?(i(),l("div",D$,[...w[4]||(w[4]=[t("p",{class:"mb-0 small"},"No changes since main",-1)])])):le(e).currentDiff&&le(e).fileCount>0?(i(),l("div",M$,[t("div",O$,[t("button",{class:K(["btn btn-sm",le(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:w[0]||(w[0]=h=>le(e).setMode("total"))}," Total Changes ",2),t("button",{class:K(["btn btn-sm",le(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:w[1]||(w[1]=h=>le(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:a,title:"Refresh diff",disabled:le(e).loading},[(i(),l("svg",{class:K({spin:le(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...w[5]||(w[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,N$)]),t("div",L$,[t("span",I$,"+"+y(le(e).currentDiff.total_insertions),1),w[6]||(w[6]=t("span",{class:"mx-1"},"/",-1)),t("span",j$,"-"+y(le(e).currentDiff.total_deletions),1),t("span",P$,y(le(e).fileCount)+" file"+y(le(e).fileCount!==1?"s":""),1),le(e).commitCount>0?(i(),l("span",R$,y(le(e).commitCount)+" commit"+y(le(e).commitCount!==1?"s":""),1)):E("",!0)]),le(e).currentMode==="total"?(i(),l("div",B$,[(i(!0),l(ne,null,ue(le(e).currentFiles,h=>(i(),l("div",{key:h.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:S=>c(h.path,"uncommitted")},[t("span",{class:K(["status-icon","status-"+h.status])},y(m(h.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:h.path},y(h.path),9,V$),h.is_binary?(i(),l("span",z$,"binary")):(i(),l("span",W$,[h.insertions>0?(i(),l("span",U$,"+"+y(h.insertions),1)):E("",!0),h.insertions>0&&h.deletions>0?(i(),l("span",H$,"/")):E("",!0),h.deletions>0?(i(),l("span",q$,"-"+y(h.deletions),1)):E("",!0)]))],8,F$))),128))])):(i(),l("div",K$,[(i(!0),l(ne,null,ue(le(e).currentDiff.commits,h=>(i(),l("div",{key:h.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:S=>u(h.hash)},[(i(),l("svg",{class:K(["chevron-icon",{expanded:o.value.has(h.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...w[7]||(w[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),h.is_uncommitted?(i(),l("span",Y$,"WIP")):(i(),l("code",J$,y(h.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:h.message},y(h.message),9,Q$),h.is_uncommitted?E("",!0):(i(),l("span",X$,y(p(h.date)),1))],8,G$),o.value.has(h.hash)?(i(),l("div",Z$,[(i(!0),l(ne,null,ue(h.files,S=>(i(),l("div",{key:S,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:k=>c(S,h.is_uncommitted?"uncommitted":null)},[t("span",{class:K(["status-icon","status-"+f(S)])},y(m(f(S))),3),t("span",{class:"file-path text-truncate small",title:S},y(S),9,tS)],8,eS))),128))])):E("",!0)]))),128))]))])):(i(),l("div",sS,[...w[8]||(w[8]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No diff data",-1)])]))])]))}},oS=se(nS,[["__scopeId","data-v-36a8a764"]]),aS={class:"diff-header"},iS={class:"diff-header-info"},lS={class:"diff-filename"},rS={class:"diff-meta"},cS={key:1,class:"meta-item"},uS={class:"text-success"},dS={class:"text-danger"},mS=["title","disabled"],fS={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},pS={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},vS={class:"copy-label"},_S={class:"diff-body"},hS={key:0,class:"diff-loading"},gS={key:1,class:"diff-error"},bS={key:2,class:"diff-content"},yS={class:"diff-table"},wS={class:"line-num line-num-old"},kS={class:"line-num line-num-new"},$S={class:"line-content"},SS={class:"line-prefix"},xS={key:3,class:"diff-empty"},CS={key:2,class:"position-indicator"},ES={__name:"DiffFullView",setup(n){const e=$n(),s=O(null),o=O(!1);let a=null;const c=v(()=>e.fullViewOpen),u=v(()=>e.currentFullViewFileDiff),m=v(()=>u.value?.content||null),f=v(()=>e.currentFiles.length),p=v(()=>e.currentFilePath?e.currentFiles.findIndex(_=>_.path===e.currentFilePath):0),d=v(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),w=v(()=>{if(!m.value)return[];const _=m.value.split(`
`),r=[];let $=0,C=0;for(const T of _){if(T.startsWith("diff --git")||T.startsWith("index ")||T.startsWith("---")||T.startsWith("+++")||T.startsWith("new file")||T.startsWith("deleted file")||T.startsWith("similarity")||T.startsWith("rename")||T.startsWith("Binary")){T.startsWith("Binary")&&r.push({type:"info",prefix:"",text:T,oldNum:null,newNum:null});continue}if(T.startsWith("@@")){const N=T.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);N&&($=parseInt(N[1]),C=parseInt(N[2]),r.push({type:"hunk",prefix:"",text:T,oldNum:null,newNum:null}));continue}T.startsWith(" ")||T.length>0&&!T.startsWith("+")&&!T.startsWith("-")&&!T.startsWith("\\")?(r.push({type:"context",prefix:" ",text:T.substring(1),oldNum:$,newNum:C}),$++,C++):T.startsWith("+")?(r.push({type:"add",prefix:"+",text:T.substring(1),oldNum:null,newNum:C}),C++):T.startsWith("-")?(r.push({type:"remove",prefix:"-",text:T.substring(1),oldNum:$,newNum:null}),$++):T.startsWith("\\")&&r.push({type:"info",prefix:"",text:T,oldNum:null,newNum:null})}return r});function h(_){return`diff-line diff-line-${_.type}`}function S(){e.closeFullView()}function k(_){_.target===_.currentTarget&&S()}function b(_){switch(_.key){case"Escape":S();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function g(){if(m.value)try{await navigator.clipboard.writeText(m.value),o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return fe(c,_=>{_?(wt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Me(()=>{document.body.style.overflow="",a&&clearTimeout(a)}),(_,r)=>(i(),Ce(Co,{to:"body"},[ye(xo,{name:"modal"},{default:rn(()=>[c.value?(i(),l("div",{key:0,class:"diff-full-view-overlay",onClick:k,onKeydown:b,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:be(S,["stop"]),title:"Close (Escape)"},[...r[3]||(r[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),f.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:r[0]||(r[0]=be($=>le(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...r[4]||(r[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):E("",!0),t("div",{class:"diff-container",onClick:r[1]||(r[1]=be(()=>{},["stop"]))},[t("div",aS,[t("div",iS,[t("h5",lS,y(le(e).currentFilePath),1),t("div",rS,[d.value?(i(),l("span",{key:0,class:K(["meta-badge","status-"+d.value.status])},y(d.value.status),3)):E("",!0),d.value&&!d.value.is_binary?(i(),l("span",cS,[t("span",uS,"+"+y(d.value.insertions),1),r[5]||(r[5]=ce(" / ",-1)),t("span",dS,"-"+y(d.value.deletions),1)])):E("",!0)])]),t("button",{class:"copy-btn",onClick:be(g,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!m.value},[o.value?(i(),l("svg",fS,[...r[6]||(r[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",pS,[...r[7]||(r[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",vS,y(o.value?"Copied!":"Copy"),1)],8,mS)]),t("div",_S,[u.value&&u.value.loading?(i(),l("div",hS,[...r[8]||(r[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):u.value&&u.value.error?(i(),l("div",gS," Failed to load diff: "+y(u.value.error),1)):m.value?(i(),l("div",bS,[t("table",yS,[t("tbody",null,[(i(!0),l(ne,null,ue(w.value,($,C)=>(i(),l("tr",{key:C,class:K(h($))},[t("td",wS,y($.oldNum||""),1),t("td",kS,y($.newNum||""),1),t("td",$S,[t("span",SS,y($.prefix),1),t("span",null,y($.text),1)])],2))),128))])])])):(i(),l("div",xS," No diff available for this file. "))])]),f.value>1?(i(),l("button",{key:1,class:"nav-btn nav-next",onClick:r[2]||(r[2]=be($=>le(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...r[9]||(r[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):E("",!0),f.value>1?(i(),l("div",CS,y(p.value+1)+" / "+y(f.value),1)):E("",!0)],544)):E("",!0)]),_:1})]))}},TS=se(ES,[["__scopeId","data-v-d13809ae"]]),AS={class:"sidebar-tabs"},DS=["onClick"],MS={key:0,class:"tab-badge"},OS={class:"tab-content-container"},NS={class:"tab-pane comms-pane"},LS={__name:"RightSidebar",setup(n){const e=Se(),s=Nt(),o=Qe(),a=$n(),c=v(()=>e.rightSidebarActiveTab),u=v(()=>s.currentTaskStats),m=v(()=>o.currentResourceCount),f=v(()=>a.fileCount),p=v(()=>[{id:"comms",label:"Comms",badge:0},{id:"resources",label:"Resources",badge:m.value},{id:"tasks",label:"Tasks",badge:u.value.total>0?u.value.total:0},{id:"diff",label:"Diff",badge:f.value}]),d=v(()=>e.windowWidth<=1024),w=v(()=>d.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),h=O(!1);function S(g){g.preventDefault(),h.value=!0,document.addEventListener("mousemove",k),document.addEventListener("mouseup",b)}function k(g){if(h.value){const _=window.innerWidth-g.clientX;e.setRightSidebarWidth(_)}}function b(){h.value=!1,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",b)}return(g,_)=>(i(),l("aside",{id:"right-sidebar",class:K(["right-sidebar",{resizing:h.value,"theme-red-panel":le(e).isRedBackground}]),style:Ve(w.value)},[ye(rk),t("div",AS,[(i(!0),l(ne,null,ue(p.value,r=>(i(),l("button",{key:r.id,class:K(["sidebar-tab",{active:c.value===r.id}]),onClick:$=>le(e).setRightSidebarTab(r.id)},[ce(y(r.label)+" ",1),r.badge>0?(i(),l("span",MS,y(r.badge),1)):E("",!0)],10,DS))),128))]),t("div",OS,[xe(t("div",NS,[..._[0]||(_[0]=[t("div",{class:"comms-placeholder"},[t("span",null,"Comms will appear here when agent is part of a Legion")],-1)])],512),[[ct,c.value==="comms"]]),xe(ye(Uk,null,null,512),[[ct,c.value==="resources"]]),xe(ye(Ck,null,null,512),[[ct,c.value==="tasks"]]),xe(ye(oS,null,null,512),[[ct,c.value==="diff"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:S},null,32),ye(w$),ye(TS)],6))}},IS=se(LS,[["__scopeId","data-v-cedf5c37"]]),jS={class:"modal-dialog modal-lg"},PS={class:"modal-content"},RS={class:"modal-body"},BS={class:"mb-3"},FS={class:"input-group"},VS=["disabled"],WS={key:0,class:"text-center py-4"},US={key:1,class:"alert alert-danger",role:"alert"},HS={key:2,class:"folder-list"},qS=["onClick","onDblclick"],zS={class:"d-flex align-items-center flex-grow-1"},KS=["onClick"],GS={key:1,class:"text-center text-muted py-3"},YS={class:"modal-footer"},JS=["disabled"],QS={__name:"FolderBrowserModal",setup(n){const e=Se(),s=O(""),o=O(""),a=O([]),c=O(!1),u=O(""),m=O(null);let f=null,p=null;const d=v(()=>{if(!s.value)return null;const $=s.value.split(/[\\/]/).filter(Boolean);return $.length<=1?null:($.pop(),$.length>0?"/"+$.join("/"):"/")});function w($){if(!$)return"";const C=$.split(/[\\/]/).filter(Boolean);return C.length<=2?$:".../"+C.slice(-2).join("/")}async function h(){c.value=!0,u.value="",a.value=[],o.value="";try{const $=s.value?{path:s.value}:{},C=await ke.get("/api/filesystem/browse",{params:$});C.current_path&&(s.value=C.current_path),a.value=C.directories||[]}catch($){console.error("Failed to load directory:",$),u.value=$.message||"Failed to load directory"}finally{c.value=!1}}function S($){o.value=$.path}function k($){s.value=$.path,o.value="",h()}function b(){d.value&&(s.value=d.value,o.value="",h())}function g(){const $=o.value||s.value;$&&p&&p($),f&&f.hide()}function _(){h()}function r(){a.value=[],o.value="",u.value="",p=null,e.hideModal()}return fe(()=>e.currentModal,$=>{if($?.name==="folder-browser"&&f){const C=$.data||{};s.value=C.defaultPath||C.currentPath||"",p=C.onSelect||null,f.show()}}),De(()=>{m.value&&Ie(async()=>{const{default:$}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:$}},__vite__mapDeps([0,1])).then(({default:$})=>{f=new $(m.value),m.value.addEventListener("shown.bs.modal",_),m.value.addEventListener("hidden.bs.modal",r)})}),Me(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",_),m.value.removeEventListener("hidden.bs.modal",r)),f&&f.dispose()}),($,C)=>(i(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",jS,[t("div",PS,[C[6]||(C[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",RS,[t("div",BS,[C[1]||(C[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",FS,[xe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=T=>s.value=T),onKeyup:ps(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:c.value}," ðŸ”„ Refresh ",8,VS)])]),c.value?(i(),l("div",WS,[...C[2]||(C[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):u.value?(i(),l("div",US,y(u.value),1)):(i(),l("div",HS,[d.value?(i(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...C[3]||(C[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):E("",!0),(i(!0),l(ne,null,ue(a.value,T=>(i(),l("div",{key:T.path,class:K(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:T.path===o.value}]),onClick:N=>S(T),onDblclick:N=>k(T),role:"button"},[t("div",zS,[C[4]||(C[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,y(T.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:be(N=>k(T),["stop"])}," Open ",8,KS)],42,qS))),128)),a.value.length===0?(i(),l("div",GS," No subdirectories found ")):E("",!0)]))]),t("div",YS,[C[5]||(C[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:!o.value},' Select "'+y(w(o.value||s.value))+'" ',9,JS)])])])],512))}},XS=se(QS,[["__scopeId","data-v-0d61ed46"]]),ZS={class:"modal-dialog"},e0={class:"modal-content"},t0={class:"modal-body"},s0={class:"mb-3"},n0={key:0,class:"invalid-feedback"},o0={class:"mb-3"},a0={class:"input-group"},i0={key:0,class:"invalid-feedback"},l0={class:"mb-3 form-check"},r0={key:0,class:"mb-3 ms-4"},c0={key:1,class:"alert alert-danger",role:"alert"},u0={class:"modal-footer"},d0=["disabled"],m0={key:0,class:"spinner-border spinner-border-sm me-2"},f0={__name:"ProjectCreateModal",setup(n){const e=Fe(),s=pe(),o=Se(),a=O({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),c=O({name:"",workingDirectory:""}),u=O(!1),m=O(""),f=O(null);let p=null;function d(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:g=>{a.value.workingDirectory=g,c.value.workingDirectory=""}})}function w(){c.value={};let g=!0;return a.value.name.trim()||(c.value.name="Project name is required",g=!1),a.value.workingDirectory.trim()||(c.value.workingDirectory="Working directory is required",g=!1),g}async function h(){if(w()){u.value=!0,m.value="";try{const g=await e.createProject(a.value.name,a.value.workingDirectory);a.value.createSession&&await s.createSession(g.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),S()}catch(g){console.error("Failed to create project:",g),m.value=g.message||"Failed to create project. Please try again."}finally{u.value=!1}}}function S(){a.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},c.value={},m.value=""}function k(){const g=document.getElementById("projectName");g&&g.focus()}function b(){S(),o.hideModal()}return fe(()=>o.currentModal,g=>{g?.name==="create-project"&&p&&p.show()}),De(()=>{f.value&&Ie(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{p=new g(f.value),f.value.addEventListener("shown.bs.modal",k),f.value.addEventListener("hidden.bs.modal",b)})}),Me(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",k),f.value.removeEventListener("hidden.bs.modal",b)),p&&p.dispose()}),(g,_)=>(i(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[t("div",ZS,[t("div",e0,[_[11]||(_[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",t0,[t("form",{onSubmit:be(h,["prevent"])},[t("div",s0,[_[4]||(_[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),xe(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.name}]),id:"projectName","onUpdate:modelValue":_[0]||(_[0]=r=>a.value.name=r),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),c.value.name?(i(),l("div",n0,y(c.value.name),1)):E("",!0)]),t("div",o0,[_[5]||(_[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",a0,[xe(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":_[1]||(_[1]=r=>a.value.workingDirectory=r),placeholder:"/path/to/project",required:""},null,2),[[We,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:d}," Browse... "),c.value.workingDirectory?(i(),l("div",i0,y(c.value.workingDirectory),1)):E("",!0)]),_[6]||(_[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",l0,[xe(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":_[2]||(_[2]=r=>a.value.createSession=r)},null,512),[[ko,a.value.createSession]]),_[7]||(_[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),_[8]||(_[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),a.value.createSession?(i(),l("div",r0,[_[9]||(_[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),xe(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":_[3]||(_[3]=r=>a.value.sessionName=r),placeholder:"main"},null,512),[[We,a.value.sessionName]])])):E("",!0),m.value?(i(),l("div",c0,y(m.value),1)):E("",!0)],32)]),t("div",u0,[_[10]||(_[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:u.value},[u.value?(i(),l("span",m0)):E("",!0),ce(" "+y(u.value?"Creating...":"Create Project"),1)],8,d0)])])])],512))}},p0=se(f0,[["__scopeId","data-v-ea55fdae"]]),v0={class:"modal-dialog"},_0={class:"modal-content"},h0={class:"modal-body"},g0={class:"mb-3"},b0={key:0,class:"invalid-feedback"},y0={class:"mb-3"},w0=["value"],k0={key:0,class:"alert alert-danger",role:"alert"},$0={class:"danger-zone"},S0={class:"text-muted small"},x0=["disabled"],C0={key:0,class:"alert alert-warning mt-3",role:"alert"},E0={class:"mb-2"},T0={class:"d-flex gap-2"},A0=["disabled"],D0={key:0,class:"spinner-border spinner-border-sm me-2"},M0=["disabled"],O0={class:"modal-footer"},N0=["disabled"],L0={key:0,class:"spinner-border spinner-border-sm me-2"},I0={__name:"ProjectEditModal",setup(n){const e=Fe(),s=Se(),o=O(null),a=O({name:""}),c=O({name:""}),u=O(!1),m=O(!1),f=O(""),p=O(!1),d=O(null);let w=null;const h=v(()=>o.value?.session_ids?.length||0);function S(){c.value={};let $=!0;return a.value.name.trim()||(c.value.name="Project name is required",$=!1),$}async function k(){if(!(!S()||!o.value)){u.value=!0,f.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),w&&w.hide()}catch($){console.error("Failed to update project:",$),f.value=$.message||"Failed to update project. Please try again."}finally{u.value=!1}}}async function b(){if(o.value){m.value=!0,f.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch($){console.error("Failed to delete project:",$),f.value=$.message||"Failed to delete project. Please try again."}finally{m.value=!1}}}function g(){a.value={name:""},c.value={},f.value="",p.value=!1}function _(){const $=document.getElementById("editProjectName");$&&($.focus(),$.select())}function r(){g(),o.value=null,s.hideModal()}return fe(()=>s.currentModal,$=>{if($?.name==="edit-project"&&w){const C=$.data||{};o.value=C.project,o.value&&(a.value.name=o.value.name),w.show()}}),De(()=>{d.value&&Ie(async()=>{const{default:$}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:$}},__vite__mapDeps([0,1])).then(({default:$})=>{w=new $(d.value),d.value.addEventListener("shown.bs.modal",_),d.value.addEventListener("hidden.bs.modal",r)})}),Me(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",_),d.value.removeEventListener("hidden.bs.modal",r)),w&&w.dispose()}),($,C)=>(i(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",v0,[t("div",_0,[C[10]||(C[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",h0,[t("form",{onSubmit:be(k,["prevent"])},[t("div",g0,[C[3]||(C[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),xe(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.name}]),id:"editProjectName","onUpdate:modelValue":C[0]||(C[0]=T=>a.value.name=T),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),c.value.name?(i(),l("div",b0,y(c.value.name),1)):E("",!0)]),t("div",y0,[C[4]||(C[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,w0),C[5]||(C[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),f.value?(i(),l("div",k0,y(f.value),1)):E("",!0)],32),C[8]||(C[8]=t("hr",null,null,-1)),t("div",$0,[C[6]||(C[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",S0," Deleting this project will also delete all "+y(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:C[1]||(C[1]=T=>p.value=!0),disabled:m.value}," ðŸ—‘ï¸ Delete Project ",8,x0)]),p.value?(i(),l("div",C0,[C[7]||(C[7]=t("strong",null,"Are you sure?",-1)),t("p",E0,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(h.value)+" session(s). ",1),t("div",T0,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:m.value},[m.value?(i(),l("span",D0)):E("",!0),ce(" "+y(m.value?"Deleting...":"Yes, Delete Permanently"),1)],8,A0),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:C[2]||(C[2]=T=>p.value=!1),disabled:m.value}," Cancel ",8,M0)])])):E("",!0)]),t("div",O0,[C[9]||(C[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:k,disabled:u.value},[u.value?(i(),l("span",L0)):E("",!0),ce(" "+y(u.value?"Saving...":"Save Changes"),1)],8,N0)])])])],512))}},j0=se(I0,[["__scopeId","data-v-52679516"]]),P0={class:"general-tab"},R0={key:0,class:"mb-3"},B0={for:"template-select",class:"form-label"},F0=["value"],V0=["value"],W0={key:0,class:"form-text"},U0={class:"mb-3"},H0={for:"config-name",class:"form-label"},q0=["value","placeholder","pattern","title"],z0={key:0,class:"invalid-feedback"},K0={key:1,class:"form-text"},G0={key:1,class:"mb-3"},Y0=["value"],J0={class:"mb-3"},Q0=["value"],X0={class:"form-text"},Z0={key:0},ex={class:"mb-3"},tx={for:"config-permission-mode",class:"form-label"},sx={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},nx={key:1,class:"field-indicator modified",title:"Modified from template"},ox=["value","disabled"],ax={key:0,value:"bypassPermissions"},ix={class:"form-text"},lx={key:0,class:"text-warning"},rx={key:1},cx={class:"mb-3"},ux={for:"config-role",class:"form-label"},dx={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},mx={key:1,class:"field-indicator modified",title:"Modified from template"},fx=["value","placeholder"],px={class:"form-text"},vx={key:2,class:"mb-3"},_x={class:"input-group"},hx=["value","placeholder","disabled","readonly"],gx={class:"form-text"},bx={key:3,class:"mb-3"},yx={class:"form-control-plaintext"},wx={key:4,class:"mb-3 form-check"},kx=["checked"],$x={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=v(()=>e.mode==="create-session"||e.mode==="edit-session"),o=v(()=>e.mode==="create-template"||e.mode==="edit-template"),a=v(()=>e.mode==="create-session"),c=v(()=>e.mode==="edit-session"),u=v(()=>e.session?.state==="active"||e.session?.state==="starting"),m=v(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=v(()=>e.selectedTemplateId?e.templates.find(k=>k.template_id===e.selectedTemplateId):null),p={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},d=v(()=>p[e.formData.model]||null),w=v(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),h=v(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function S(k){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[k]||"bg-secondary"}return(k,b)=>(i(),l("div",P0,[a.value?(i(),l("div",R0,[t("label",B0,[b[10]||(b[10]=ce(" Template ",-1)),t("button",{type:"button",onClick:b[0]||(b[0]=g=>k.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:b[1]||(b[1]=g=>k.$emit("update:selected-template-id",g.target.value||null)),class:"form-select"},[b[11]||(b[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),l(ne,null,ue(n.templates,g=>(i(),l("option",{key:g.template_id,value:g.template_id},y(g.name),9,V0))),128))],40,F0),f.value?(i(),l("div",W0,y(f.value.description),1)):E("",!0)])):E("",!0),t("div",U0,[t("label",H0,[ce(y(o.value?"Template Name":"Session Name")+" ",1),b[12]||(b[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:K(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:b[2]||(b[2]=g=>k.$emit("update:form-data","name",g.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,q0),n.errors.name?(i(),l("div",z0,y(n.errors.name),1)):E("",!0),s.value?(i(),l("div",K0,"Must be a single word (no spaces) for #nametag matching")):E("",!0)]),o.value?(i(),l("div",G0,[b[13]||(b[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:b[3]||(b[3]=g=>k.$emit("update:form-data","description",g.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,Y0)])):E("",!0),t("div",J0,[b[15]||(b[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:b[4]||(b[4]=g=>k.$emit("update:form-data","model",g.target.value))},[...b[14]||(b[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,Q0),t("div",X0,[d.value?(i(),l("span",Z0,y(d.value.description),1)):E("",!0)])]),t("div",ex,[t("label",tx,[b[16]||(b[16]=ce(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),l("span",sx," < ")):E("",!0),n.fieldStates.permission_mode==="modified"?(i(),l("span",nx," * ")):E("",!0)]),t("select",{id:"config-permission-mode",class:K(["form-select",h.value]),value:n.formData.permission_mode,onChange:b[5]||(b[5]=g=>k.$emit("update:form-data","permission_mode",g.target.value)),disabled:c.value&&!u.value},[b[17]||(b[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),b[18]||(b[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),b[19]||(b[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!c.value||m.value?(i(),l("option",ax," Bypass Permissions (No prompts - use with caution) ")):E("",!0)],42,ox),t("div",ix,[c.value&&!u.value?(i(),l("span",lx," Session must be active to change permission mode. Start the session first. ")):(i(),l("span",rx,"Controls which tool actions require permission prompts"))])]),t("div",cx,[t("label",ux,[ce(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),l("span",dx," < ")):E("",!0),n.fieldStates.default_role==="modified"?(i(),l("span",mx," * ")):E("",!0)]),t("input",{id:"config-role",type:"text",class:K(["form-control",w.value]),value:n.formData.default_role,onInput:b[6]||(b[6]=g=>k.$emit("update:form-data","default_role",g.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,fx),t("div",px,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),l("div",vx,[b[20]||(b[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",_x,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:b[7]||(b[7]=g=>k.$emit("update:form-data","working_directory",g.target.value)),placeholder:c.value?"":"Leave empty to inherit from project",disabled:c.value,readonly:c.value},null,40,hx),c.value?E("",!0):(i(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:b[8]||(b[8]=g=>k.$emit("open-folder-browser"))}," Browse "))]),t("div",gx,y(c.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):E("",!0),c.value&&n.session?(i(),l("div",bx,[b[21]||(b[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",yx,[t("span",{class:K(["badge",S(n.session.state)])},y(n.session.state),3)])])):E("",!0),a.value?(i(),l("div",wx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:b[9]||(b[9]=g=>k.$emit("update:form-data","startImmediately",g.target.checked))},null,40,kx),b[22]||(b[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):E("",!0)]))}},Sx=se($x,[["__scopeId","data-v-9f0e3252"]]),xx={class:"permissions-tab"},Cx={class:"mb-3"},Ex={for:"config-allowed-tools",class:"form-label"},Tx={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Ax={key:1,class:"field-indicator modified",title:"Modified from template"},Dx={key:0,class:"tools-list mb-2"},Mx=["onClick"],Ox={class:"input-group input-group-sm"},Nx=["onKeydown"],Lx=["disabled"],Ix={class:"mt-2"},jx=["onClick"],Px={class:"form-text"},Rx={class:"mb-3"},Bx={for:"config-disallowed-tools",class:"form-label"},Fx={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Vx={key:1,class:"field-indicator modified",title:"Modified from template"},Wx={key:0,class:"tools-list mb-2"},Ux=["onClick"],Hx={class:"input-group input-group-sm"},qx=["onKeydown"],zx=["disabled"],Kx={class:"mt-2"},Gx=["onClick"],Yx={class:"form-text"},Jx={key:0,class:"mb-3"},Qx={class:"settings-sources-editor"},Xx={class:"form-check"},Zx=["checked"],eC={class:"form-check"},tC=["checked"],sC={class:"form-check"},nC=["checked"],oC={key:1,class:"mb-3"},aC={class:"mb-3"},iC={key:0,class:"mt-2"},lC=["value"],rC=["value"],cC={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,a=O(""),c=O(""),u=O(!1),m=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],f=v(()=>s.mode==="create-template"||s.mode==="edit-template"),p=v(()=>s.mode==="create-session"||s.mode==="edit-session"),d=v(()=>s.formData.setting_sources||["user","project","local"]),w=v(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(A=>A.trim()).filter(A=>A.length>0)),h=v(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(A=>A.trim()).filter(A=>A.length>0)),S=v(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),k=v(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),b=v(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),g=v(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function _(){const A=a.value.trim();if(A){if(!w.value.includes(A)){const x=[...w.value,A];o("update:form-data","allowed_tools",x.join(", "))}a.value=""}}function r(A){const x=[...w.value];x.splice(A,1),o("update:form-data","allowed_tools",x.join(", "))}function $(A){if(w.value.includes(A)){const x=w.value.indexOf(A);r(x)}else{const x=[...w.value,A];o("update:form-data","allowed_tools",x.join(", "))}}function C(){const A=c.value.trim();if(A){if(!h.value.includes(A)){const x=[...h.value,A];o("update:form-data","disallowed_tools",x.join(", "))}c.value=""}}function T(A){const x=[...h.value];x.splice(A,1),o("update:form-data","disallowed_tools",x.join(", "))}function N(A){if(h.value.includes(A)){const x=h.value.indexOf(A);T(x)}else{const x=[...h.value,A];o("update:form-data","disallowed_tools",x.join(", "))}}function D(A){const x=[...d.value],M=x.indexOf(A);M>=0?x.splice(M,1):x.push(A),o("update:form-data","setting_sources",x)}return(A,x)=>(i(),l("div",xx,[t("div",Cx,[t("label",Ex,[x[9]||(x[9]=ce(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),l("span",Tx," < ")):E("",!0),n.fieldStates.allowed_tools==="modified"?(i(),l("span",Ax," * ")):E("",!0)]),t("div",{class:K(["allowed-tools-editor",k.value])},[w.value.length>0?(i(),l("div",Dx,[(i(!0),l(ne,null,ue(w.value,(M,q)=>(i(),l("span",{key:q,class:"badge bg-primary me-1 mb-1 tool-badge"},[ce(y(M)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:F=>r(q),"aria-label":"Remove tool"},null,8,Mx)]))),128))])):E("",!0),t("div",Ox,[xe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=M=>a.value=M),onKeydown:ps(be(_,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,Nx),[[We,a.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:_,disabled:!a.value.trim()}," Add ",8,Lx)]),t("div",Ix,[x[10]||(x[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),l(ne,null,ue(m,M=>t("button",{key:M,type:"button",class:K(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":w.value.includes(M)}]),onClick:q=>$(M)},y(M),11,jx)),64))])],2),t("div",Px,y(f.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",Rx,[t("label",Bx,[x[11]||(x[11]=ce(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(i(),l("span",Fx," < ")):E("",!0),n.fieldStates.disallowed_tools==="modified"?(i(),l("span",Vx," * ")):E("",!0)]),t("div",{class:K(["disallowed-tools-editor",g.value])},[h.value.length>0?(i(),l("div",Wx,[(i(!0),l(ne,null,ue(h.value,(M,q)=>(i(),l("span",{key:q,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[ce(y(M)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:F=>T(q),"aria-label":"Remove denied tool"},null,8,Ux)]))),128))])):E("",!0),t("div",Hx,[xe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[1]||(x[1]=M=>c.value=M),onKeydown:ps(be(C,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,qx),[[We,c.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:C,disabled:!c.value.trim()}," Deny ",8,zx)]),t("div",Kx,[x[12]||(x[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(i(),l(ne,null,ue(m,M=>t("button",{key:M,type:"button",class:K(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":h.value.includes(M)}]),onClick:q=>N(M)},y(M),11,Gx)),64))])],2),t("div",Yx,y(f.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),p.value?(i(),l("div",Jx,[x[16]||(x[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",Qx,[t("div",Xx,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:d.value.includes("user"),onChange:x[2]||(x[2]=M=>D("user"))},null,40,Zx),x[13]||(x[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[ce(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",eC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:d.value.includes("project"),onChange:x[3]||(x[3]=M=>D("project"))},null,40,tC),x[14]||(x[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[ce(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",sC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:d.value.includes("local"),onChange:x[4]||(x[4]=M=>D("local"))},null,40,nC),x[15]||(x[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[ce(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),x[17]||(x[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):E("",!0),p.value?(i(),l("div",oC,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:x[5]||(x[5]=M=>A.$emit("preview-permissions"))}," Preview Effective Permissions ")])):E("",!0),t("div",aC,[t("a",{class:"text-muted small",role:"button",onClick:x[6]||(x[6]=M=>u.value=!u.value)},y(u.value?"Hide":"Show")+" raw input ",1),u.value?(i(),l("div",iC,[x[18]||(x[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:K(["form-control form-control-sm",S.value]),value:n.formData.allowed_tools,onInput:x[7]||(x[7]=M=>A.$emit("update:form-data","allowed_tools",M.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,lC),x[19]||(x[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:K(["form-control form-control-sm",b.value]),value:n.formData.disallowed_tools,onInput:x[8]||(x[8]=M=>A.$emit("update:form-data","disallowed_tools",M.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,rC)])):E("",!0)])]))}},uC=se(cC,[["__scopeId","data-v-cbec74ed"]]),dC={class:"advanced-tab"},mC={class:"mb-3"},fC={for:"config-system-prompt",class:"form-label"},pC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},vC={key:1,class:"field-indicator modified",title:"Modified from template"},_C=["value","rows","placeholder"],hC={class:"form-text"},gC={class:"mb-3 form-check"},bC=["checked"],yC={key:0,class:"form-text text-warning"},wC={class:"mb-3"},kC={class:"capabilities-editor"},$C={key:0,class:"capabilities-list mb-2"},SC=["onClick"],xC={class:"input-group input-group-sm"},CC=["onKeydown"],EC=["disabled"],TC={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,a=v(()=>s.mode==="create-template"||s.mode==="edit-template"),c=v(()=>s.formData.initialization_context),u=v(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),m=v(()=>s.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),f=v(()=>{const k={};return s.fieldStates.initialization_context==="autofilled"&&(k["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(k["field-modified"]=!0),k}),p=O(""),d=v(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(k=>k.trim()).filter(k=>k.length>0));function w(k){const b=k.target.value;o("update:form-data","initialization_context",b)}function h(){const k=p.value.trim().toLowerCase();if(k){if(!d.value.includes(k)){const b=[...d.value,k];o("update:form-data","capabilities",b.join(", "))}p.value=""}}function S(k){const b=[...d.value];b.splice(k,1),o("update:form-data","capabilities",b.join(", "))}return(k,b)=>(i(),l("div",dC,[t("div",mC,[t("label",fC,[ce(y(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),l("span",pC," < ")):E("",!0),n.fieldStates.initialization_context==="modified"?(i(),l("span",vC," * ")):E("",!0)]),t("textarea",{id:"config-system-prompt",class:K(["form-control",f.value]),value:c.value,onInput:w,rows:a.value?4:5,placeholder:u.value},null,42,_C),t("div",hC,y(m.value),1)]),t("div",gC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:b[0]||(b[0]=g=>k.$emit("update:form-data","override_system_prompt",g.target.checked))},null,40,bC),b[2]||(b[2]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),l("div",yC,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(a.value?"":" or legion guide")+").",1)])):E("",!0)]),t("div",wC,[b[3]||(b[3]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",kC,[d.value.length>0?(i(),l("div",$C,[(i(!0),l(ne,null,ue(d.value,(g,_)=>(i(),l("span",{key:_,class:"badge bg-info me-1 mb-1 capability-badge"},[ce(y(g)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:r=>S(_),"aria-label":"Remove capability"},null,8,SC)]))),128))])):E("",!0),t("div",xC,[xe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":b[1]||(b[1]=g=>p.value=g),onKeydown:ps(be(h,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,CC),[[We,p.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:h,disabled:!p.value.trim()}," Add ",8,EC)])]),b[4]||(b[4]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},AC=se(TC,[["__scopeId","data-v-9ffdae4f"]]),DC={class:"sandbox-tab"},MC={class:"mb-3 form-check"},OC=["checked"],NC={class:"mb-2 form-check"},LC=["checked","disabled"],IC={class:"mb-2 form-check"},jC=["checked","disabled"],PC={class:"mb-2"},RC=["value","disabled"],BC={class:"mb-3 form-check"},FC=["checked","disabled"],VC={class:"mb-2"},WC=["value","disabled"],UC={class:"mb-2 form-check"},HC=["checked","disabled"],qC={class:"mb-2"},zC=["value","disabled"],KC={class:"mb-3 form-check"},GC=["checked","disabled"],YC={class:"mb-2"},JC=["value","disabled"],QC={class:"mb-2"},XC=["value","disabled"],ZC={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(u,m){s.formData.sandbox[u]=m}function a(u,m){s.formData.sandbox.network[u]=m}function c(u,m){s.formData.sandbox.ignoreViolations[u]=m}return(u,m)=>(i(),l("div",DC,[t("div",MC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:m[0]||(m[0]=f=>u.$emit("update:form-data","sandbox_enabled",f.target.checked))},null,40,OC),m[11]||(m[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:K(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",NC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:m[1]||(m[1]=f=>o("autoAllowBashIfSandboxed",f.target.checked))},null,40,LC),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",IC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:m[2]||(m[2]=f=>o("allowUnsandboxedCommands",f.target.checked))},null,40,jC),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",PC,[t("label",{for:"config-sandbox-excluded-cmds",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:m[3]||(m[3]=f=>o("excludedCommands",f.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,RC)]),t("div",BC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:m[4]||(m[4]=f=>o("enableWeakerNestedSandbox",f.target.checked))},null,40,FC),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",VC,[t("label",{for:"config-sandbox-allowed-domains",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:m[5]||(m[5]=f=>a("allowedDomains",f.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,WC)]),t("div",UC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:m[6]||(m[6]=f=>a("allowLocalBinding",f.target.checked))},null,40,HC),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",qC,[t("label",{for:"config-sandbox-unix-sockets",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:m[7]||(m[7]=f=>a("allowUnixSockets",f.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,zC)]),t("div",KC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:m[8]||(m[8]=f=>a("allowAllUnixSockets",f.target.checked))},null,40,GC),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",YC,[t("label",{for:"config-sandbox-ignore-file",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:m[9]||(m[9]=f=>c("file",f.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,JC)]),t("div",QC,[t("label",{for:"config-sandbox-ignore-network",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:m[10]||(m[10]=f=>c("network",f.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,XC)])]))}},eE=se(ZC,[["__scopeId","data-v-be109d12"]]),tE={class:"modal-dialog modal-lg"},sE={class:"modal-content"},nE={class:"modal-body"},oE={key:0,class:"text-center py-4"},aE={key:1,class:"alert alert-danger"},iE={key:2},lE={class:"mb-3"},rE={class:"small text-muted mb-2"},cE={key:0},uE={key:0,class:"alert alert-info"},dE={key:1},mE={class:"table table-sm table-striped"},fE={key:2,class:"mt-3"},pE={key:3,class:"mt-3"},vE={class:"modal-footer"},_E=["disabled"],hE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=O(null);let u=null;const m=O(!1),f=O(""),p=O([]);fe(c,b=>{b&&(u=new St(b),b.addEventListener("hidden.bs.modal",()=>{a("close")}))});function d(){u&&(u.show(),h())}function w(){u&&u.hide()}async function h(){m.value=!0,f.value="",p.value=[];try{const b=await ke.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});p.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),f.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{m.value=!1}}function S(){h()}function k(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:d,hide:w}),(b,g)=>(i(),l("div",{ref_key:"modalRef",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",tE,[t("div",sE,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",nE,[m.value?(i(),l("div",oE,[...g[0]||(g[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):f.value?(i(),l("div",aE,y(f.value),1)):(i(),l("div",iE,[t("div",lE,[g[2]||(g[2]=t("h6",null,"Settings Sources",-1)),t("div",rE,[g[1]||(g[1]=ce(" Loading permissions from: ",-1)),(i(!0),l(ne,null,ue(n.settingSources,(_,r)=>(i(),l("span",{key:_},[t("code",null,y(_),1),r<n.settingSources.length-1?(i(),l("span",cE,", ")):E("",!0)]))),128))])]),p.value.length===0?(i(),l("div",uE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),l("div",dE,[t("h6",null,"Pre-approved Permissions ("+y(p.value.length)+")",1),t("table",mE,[g[3]||(g[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),l(ne,null,ue(p.value,_=>(i(),l("tr",{key:_.permission},[t("td",null,[t("code",null,y(_.permission),1)]),t("td",null,[(i(!0),l(ne,null,ue(_.sources,(r,$)=>(i(),l("span",{key:r,class:K(["badge me-1",k(r)])},y(r),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),l("div",fE,[g[4]||(g[4]=t("h6",null,"Session Allowed Tools",-1)),g[5]||(g[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),l(ne,null,ue(n.sessionAllowedTools,_=>(i(),l("span",{key:_,class:"badge bg-success me-1 mb-1"},y(_),1))),128))])])):E("",!0),n.sessionDisallowedTools.length>0?(i(),l("div",pE,[g[6]||(g[6]=t("h6",null,"Session Disallowed Tools",-1)),g[7]||(g[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(i(!0),l(ne,null,ue(n.sessionDisallowedTools,_=>(i(),l("span",{key:_,class:"badge bg-danger me-1 mb-1"},y(_),1))),128))])])):E("",!0)]))]),t("div",vE,[g[8]||(g[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:S,disabled:m.value}," Refresh ",8,_E)])])])],512))}},gE=se(hE,[["__scopeId","data-v-2078b366"]]),bE={class:"modal-dialog modal-lg modal-dialog-centered"},yE={class:"modal-content"},wE={class:"modal-header"},kE={id:"configurationModalLabel",class:"modal-title"},$E={class:"modal-body"},SE={key:0,class:"template-list-view"},xE={key:0,class:"alert alert-info"},CE={class:"card-body"},EE={class:"d-flex justify-content-between align-items-start"},TE={class:"flex-grow-1"},AE={class:"card-title mb-1"},DE={key:0,class:"card-text text-muted small mb-2"},ME={class:"template-meta"},OE={class:"badge bg-secondary me-2"},NE={class:"text-muted small"},LE={class:"btn-group btn-group-sm ms-3"},IE=["onClick"],jE=["onClick"],PE={key:1},RE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},BE={class:"nav-item",role:"presentation"},FE={key:0,class:"error-indicator",title:"This tab has validation errors"},VE={class:"nav-item",role:"presentation"},WE={key:0,class:"error-indicator",title:"This tab has validation errors"},UE={class:"nav-item",role:"presentation"},HE={key:0,class:"error-indicator",title:"This tab has validation errors"},qE={class:"nav-item",role:"presentation"},zE={class:"tab-content"},KE={key:2,class:"alert alert-danger mt-3"},GE={key:0},YE={key:1},JE={class:"modal-footer"},QE={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},XE=["disabled"],ZE={key:0,class:"spinner-border spinner-border-sm me-2"},eT={__name:"ConfigurationModal",setup(n){const e=Qt(),s=Fe(),o=pe(),a=Se(),c=O(null);let u=null;const m=O(null),f=O("create-session"),p=O("general"),d=O(null),w=O(null),h=O(null),S=O([]),k=O(null),b=O(null),g=O({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),_=Ms({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),r=Ms({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),$=Ms({name:""}),C=v(()=>({general:!!$.name,permissions:!1,advanced:!1})),T=O(!1),N=O(""),D=v(()=>f.value==="create-session"||f.value==="edit-session"),A=v(()=>f.value==="edit-session"||f.value==="edit-template"),x=v(()=>{switch(f.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),M=v(()=>T.value?A.value?"Saving...":"Creating...":A.value?"Save Changes":D.value?"Create Session":"Save Template"),q=v(()=>!(!r.name.trim()||D.value&&r.name.includes(" "))),F=v(()=>w.value?.state==="active"||w.value?.state==="starting"),U=v(()=>{if(!w.value)return!1;const B=(r.initialization_context||"")!==(w.value.system_prompt||""),te=(r.override_system_prompt||!1)!==(w.value.override_system_prompt||!1),ie=(r.sandbox_enabled||!1)!==(w.value.sandbox_enabled||!1);if(B||te||ie)return!0;if(r.sandbox_enabled){const we=w.value.sandbox_config||{},me=r.sandbox,Te=JSON.stringify({autoAllowBashIfSandboxed:we.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:we.allowUnsandboxedCommands??!1,excludedCommands:(we.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:we.enableWeakerNestedSandbox??!1,network:{allowedDomains:(we.network?.allowedDomains||[]).join(", "),allowLocalBinding:we.network?.allowLocalBinding??!1,allowUnixSockets:(we.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:we.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(we.ignoreViolations?.file||[]).join(", "),network:(we.ignoreViolations?.network||[]).join(", ")}}),Ae=JSON.stringify({autoAllowBashIfSandboxed:me.autoAllowBashIfSandboxed,allowUnsandboxedCommands:me.allowUnsandboxedCommands,excludedCommands:me.excludedCommands,enableWeakerNestedSandbox:me.enableWeakerNestedSandbox,network:{allowedDomains:me.network.allowedDomains,allowLocalBinding:me.network.allowLocalBinding,allowUnixSockets:me.network.allowUnixSockets,allowAllUnixSockets:me.network.allowAllUnixSockets},ignoreViolations:{file:me.ignoreViolations.file,network:me.ignoreViolations.network}});if(Te!==Ae)return!0}return!1}),W=v(()=>{if(!w.value)return!1;const B=(r.model||"sonnet")!==(w.value.model||"sonnet"),te=(r.allowed_tools||"")!==(w.value.allowed_tools?.join(", ")||""),ie=w.value.setting_sources||["user","project","local"],we=r.setting_sources||["user","project","local"],me=JSON.stringify([...ie].sort())!==JSON.stringify([...we].sort());return B||te||me}),J=v(()=>U.value?"reset":W.value?"restart":null),ae=v(()=>f.value==="edit-session"&&F.value&&J.value!==null),L=v(()=>w.value?.working_directory?w.value.working_directory:r.working_directory?r.working_directory:s.projects.get(d.value)?.working_directory||""),j=v(()=>!r.allowed_tools||!r.allowed_tools.trim()?[]:r.allowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0)),R=v(()=>!r.disallowed_tools||!r.disallowed_tools.trim()?[]:r.disallowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0));function H(){m.value&&m.value.show()}function X(){const B=te=>te.split(",").map(ie=>ie.trim()).filter(ie=>ie.length>0);return{autoAllowBashIfSandboxed:r.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:r.sandbox.allowUnsandboxedCommands,excludedCommands:B(r.sandbox.excludedCommands),enableWeakerNestedSandbox:r.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:B(r.sandbox.network.allowedDomains),allowLocalBinding:r.sandbox.network.allowLocalBinding,allowUnixSockets:B(r.sandbox.network.allowUnixSockets),allowAllUnixSockets:r.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:B(r.sandbox.ignoreViolations.file),network:B(r.sandbox.ignoreViolations.network)}}}function ee(B,te){r[B]=te,B==="name"&&($.name="")}function _e(B){k.value=B,he()}async function Q(){try{const B=await ke.get("/api/templates");S.value=B||[]}catch(B){console.error("Failed to load templates:",B),S.value=[]}}function he(){if(!k.value){r.default_role="",r.initialization_context="",r.permission_mode="default",r.allowed_tools="",r.disallowed_tools="",r.model="sonnet",r.capabilities="",r.override_system_prompt=!1,r.sandbox_enabled=!1,r.sandbox.autoAllowBashIfSandboxed=!0,r.sandbox.allowUnsandboxedCommands=!1,r.sandbox.excludedCommands="",r.sandbox.enableWeakerNestedSandbox=!1,r.sandbox.network.allowedDomains="",r.sandbox.network.allowLocalBinding=!1,r.sandbox.network.allowUnixSockets="",r.sandbox.network.allowAllUnixSockets=!1,r.sandbox.ignoreViolations.file="",r.sandbox.ignoreViolations.network="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",_.disallowed_tools="normal",_.model="normal",_.capabilities="normal",_.sandbox_excludedCommands="normal",_.sandbox_network_allowedDomains="normal",_.sandbox_network_allowUnixSockets="normal",_.sandbox_ignoreViolations_file="normal",_.sandbox_ignoreViolations_network="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const B=S.value.find(Je=>Je.template_id===k.value);if(!B)return;if(_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",_.disallowed_tools="normal",_.model="normal",_.capabilities="normal",_.sandbox_excludedCommands="normal",_.sandbox_network_allowedDomains="normal",_.sandbox_network_allowUnixSockets="normal",_.sandbox_ignoreViolations_file="normal",_.sandbox_ignoreViolations_network="normal",B.default_role?(r.default_role=B.default_role,g.value.default_role=B.default_role,_.default_role="autofilled"):(r.default_role="",g.value.default_role=null),B.default_system_prompt?(r.initialization_context=B.default_system_prompt,g.value.initialization_context=B.default_system_prompt,_.initialization_context="autofilled"):(r.initialization_context="",g.value.initialization_context=null),B.permission_mode?(r.permission_mode=B.permission_mode,g.value.permission_mode=B.permission_mode,_.permission_mode="autofilled"):(r.permission_mode="default",g.value.permission_mode=null),B.allowed_tools&&B.allowed_tools.length>0){const Je=B.allowed_tools.join(", ");r.allowed_tools=Je,g.value.allowed_tools=Je,_.allowed_tools="autofilled"}else r.allowed_tools="",g.value.allowed_tools=null;if(B.disallowed_tools&&B.disallowed_tools.length>0){const Je=B.disallowed_tools.join(", ");r.disallowed_tools=Je,g.value.disallowed_tools=Je,_.disallowed_tools="autofilled"}else r.disallowed_tools="",g.value.disallowed_tools=null;if(B.model?(r.model=B.model,g.value.model=B.model,_.model="autofilled"):(r.model="sonnet",g.value.model=null),B.capabilities&&B.capabilities.length>0){const Je=B.capabilities.join(", ");r.capabilities=Je,g.value.capabilities=Je,_.capabilities="autofilled"}else r.capabilities="",g.value.capabilities=null;r.override_system_prompt=B.override_system_prompt||!1,r.sandbox_enabled=B.sandbox_enabled||!1;const te=B.sandbox_config||{};r.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,r.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,r.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};r.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,r.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const we=(te.excludedCommands||[]).join(", ");r.sandbox.excludedCommands=we,g.value.sandbox_excludedCommands=we||null,we&&(_.sandbox_excludedCommands="autofilled");const me=(ie.allowedDomains||[]).join(", ");r.sandbox.network.allowedDomains=me,g.value.sandbox_network_allowedDomains=me||null,me&&(_.sandbox_network_allowedDomains="autofilled");const Te=(ie.allowUnixSockets||[]).join(", ");r.sandbox.network.allowUnixSockets=Te,g.value.sandbox_network_allowUnixSockets=Te||null,Te&&(_.sandbox_network_allowUnixSockets="autofilled");const Ae=te.ignoreViolations||{},Ts=(Ae.file||[]).join(", ");r.sandbox.ignoreViolations.file=Ts,g.value.sandbox_ignoreViolations_file=Ts||null,Ts&&(_.sandbox_ignoreViolations_file="autofilled");const As=(Ae.network||[]).join(", ");r.sandbox.ignoreViolations.network=As,g.value.sandbox_ignoreViolations_network=As||null,As&&(_.sandbox_ignoreViolations_network="autofilled")}function z(){const te=(d.value?s.projects.get(d.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:te,currentPath:r.working_directory||"",onSelect:ie=>{r.working_directory=ie}})}function P(){f.value==="create-session"&&(b.value={mode:"create-session",projectId:d.value,formData:{...r},selectedTemplateId:k.value}),f.value="template-list",ge()}function I(){f.value="create-template",ge(),p.value="general"}function V(B){f.value="edit-template",h.value=B,ge(),tt(B),p.value="general"}async function Z(B){if(confirm(`Delete template "${B.name}"?

This action cannot be undone.`))try{await ke.delete(`/api/templates/${B.template_id}`),await Q()}catch(te){console.error("Failed to delete template:",te),N.value=te.response?.data?.detail||"Failed to delete template"}}function oe(){let B=!0;return $.name="",r.name.trim()||($.name="Name is required",B=!1),D.value&&r.name.includes(" ")&&($.name="Session name must be a single word (no spaces)",B=!1),B}async function $e(){if(!oe()){$.name&&(p.value="general");return}T.value=!0,N.value="";try{switch(f.value){case"create-session":await Ge(),u&&u.hide();break;case"edit-session":await Y(),u&&u.hide();break;case"create-template":await re();break;case"edit-template":await ve();break}}catch(B){console.error("Submit failed:",B),N.value=B.response?.data?.detail||B.message||"Operation failed. Please try again."}finally{T.value=!1}}async function Ge(){if(!d.value)throw new Error("Project ID is missing");const B=r.allowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),te=r.disallowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ie=r.capabilities.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),we={name:r.name.trim(),model:r.model||null,role:r.default_role.trim()||null,initialization_context:r.initialization_context.trim()||null,override_system_prompt:r.override_system_prompt,capabilities:ie.length>0?ie:null,permission_mode:r.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:te.length>0?te:null,working_directory:r.working_directory.trim()||null,sandbox_enabled:r.sandbox_enabled,sandbox_config:r.sandbox_enabled?X():null,setting_sources:r.setting_sources},me=await ke.post(`/api/legions/${d.value}/minions`,we);if(me.success&&me.minion_id)await s.fetchProjects(),await o.fetchSessions(),r.startImmediately&&await o.startSession(me.minion_id),e.push(`/session/${me.minion_id}`);else throw new Error("Failed to create session")}async function Y(){if(!w.value)throw new Error("Session data is missing");const B=w.value.session_id,te=w.value.state==="active"||w.value.state==="starting",ie=r.allowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),we=r.disallowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),me=r.capabilities.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),Te={name:r.name.trim(),model:r.model,role:r.default_role.trim()||null,system_prompt:r.initialization_context.trim()||null,override_system_prompt:r.override_system_prompt,allowed_tools:ie.length>0?ie:null,disallowed_tools:we.length>0?we:null,capabilities:me.length>0?me:null,sandbox_enabled:r.sandbox_enabled,sandbox_config:r.sandbox_enabled?X():null,setting_sources:r.setting_sources};await o.patchSession(B,Te),te&&r.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(B,r.permission_mode)}async function re(){const B=r.allowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),te=r.disallowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),ie=r.capabilities.split(",").map(me=>me.trim()).filter(me=>me.length>0),we={name:r.name.trim(),description:r.description.trim()||null,permission_mode:r.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:te.length>0?te:null,default_role:r.default_role.trim()||null,default_system_prompt:r.initialization_context.trim()||null,model:r.model||null,capabilities:ie.length>0?ie:null,override_system_prompt:r.override_system_prompt,sandbox_enabled:r.sandbox_enabled,sandbox_config:r.sandbox_enabled?X():null};await ke.post("/api/templates",we),await Q(),f.value="template-list",ge()}async function ve(){if(!h.value)throw new Error("Template data is missing");const B=r.allowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),te=r.disallowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),ie=r.capabilities.split(",").map(me=>me.trim()).filter(me=>me.length>0),we={name:r.name.trim(),description:r.description.trim()||null,permission_mode:r.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:te.length>0?te:null,default_role:r.default_role.trim()||null,default_system_prompt:r.initialization_context.trim()||null,model:r.model||null,capabilities:ie.length>0?ie:null,override_system_prompt:r.override_system_prompt,sandbox_enabled:r.sandbox_enabled,sandbox_config:r.sandbox_enabled?X():null};await ke.put(`/api/templates/${h.value.template_id}`,we),await Q(),f.value="template-list",h.value=null,ge()}function ge(){r.name="",r.model="sonnet",r.permission_mode="default",r.working_directory="",r.description="",r.default_role="",r.startImmediately=!0,r.allowed_tools="",r.disallowed_tools="",r.capabilities="",r.setting_sources=["user","project","local"],r.system_prompt="",r.override_system_prompt=!1,r.initialization_context="",r.sandbox_enabled=!1,r.sandbox.autoAllowBashIfSandboxed=!0,r.sandbox.allowUnsandboxedCommands=!1,r.sandbox.excludedCommands="",r.sandbox.enableWeakerNestedSandbox=!1,r.sandbox.network.allowedDomains="",r.sandbox.network.allowLocalBinding=!1,r.sandbox.network.allowUnixSockets="",r.sandbox.network.allowAllUnixSockets=!1,r.sandbox.ignoreViolations.file="",r.sandbox.ignoreViolations.network="",$.name="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",_.disallowed_tools="normal",_.model="normal",_.capabilities="normal",_.sandbox_excludedCommands="normal",_.sandbox_network_allowedDomains="normal",_.sandbox_network_allowUnixSockets="normal",_.sandbox_ignoreViolations_file="normal",_.sandbox_ignoreViolations_network="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},k.value=null,N.value="",p.value="general"}function Ee(B){r.name=B.name||"",r.model=B.model||"sonnet",r.permission_mode=B.current_permission_mode||"default",r.working_directory=B.working_directory||"",r.default_role=B.role||"",r.initialization_context=B.system_prompt||"",r.override_system_prompt=B.override_system_prompt||!1,r.system_prompt="",r.allowed_tools=B.allowed_tools?.join(", ")||"",r.disallowed_tools=B.disallowed_tools?.join(", ")||"",r.capabilities=B.capabilities?.join(", ")||"",r.sandbox_enabled=B.sandbox_enabled||!1,r.setting_sources=B.setting_sources||["user","project","local"];const te=B.sandbox_config||{};r.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,r.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,r.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),r.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};r.sandbox.network.allowedDomains=(ie.allowedDomains||[]).join(", "),r.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,r.sandbox.network.allowUnixSockets=(ie.allowUnixSockets||[]).join(", "),r.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const we=te.ignoreViolations||{};r.sandbox.ignoreViolations.file=(we.file||[]).join(", "),r.sandbox.ignoreViolations.network=(we.network||[]).join(", ")}function tt(B){r.name=B.name||"",r.description=B.description||"",r.permission_mode=B.permission_mode||"default",r.default_role=B.default_role||"",r.initialization_context=B.default_system_prompt||"",r.allowed_tools=B.allowed_tools?.join(", ")||"",r.disallowed_tools=B.disallowed_tools?.join(", ")||"",r.model=B.model||"sonnet",r.capabilities=B.capabilities?.join(", ")||"",r.override_system_prompt=B.override_system_prompt||!1,r.sandbox_enabled=B.sandbox_enabled||!1;const te=B.sandbox_config||{};r.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,r.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,r.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),r.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};r.sandbox.network.allowedDomains=(ie.allowedDomains||[]).join(", "),r.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,r.sandbox.network.allowUnixSockets=(ie.allowUnixSockets||[]).join(", "),r.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const we=te.ignoreViolations||{};r.sandbox.ignoreViolations.file=(we.file||[]).join(", "),r.sandbox.ignoreViolations.network=(we.network||[]).join(", ")}function Ye(){wt(()=>{const B=document.getElementById("config-name");B&&(B.focus(),A.value&&B.select())})}function ht(){ge(),f.value="create-session",d.value=null,w.value=null,h.value=null,a.hideModal()}return fe(()=>a.currentModal,async(B,te)=>{if(!(!B||!u)){if(B.name==="configuration"){const ie=B.data||{};f.value=ie.mode||"create-session",d.value=ie.project?.project_id||ie.projectId||null,w.value=ie.session||null,h.value=ie.template||null,ge(),f.value==="create-session"&&await Q(),f.value==="edit-session"&&w.value?Ee(w.value):f.value==="edit-template"&&h.value&&tt(h.value),u.show()}else if(B.name==="create-minion"||B.name==="create-session"){const ie=B.data||{};f.value="create-session",d.value=ie.project?.project_id||null,w.value=null,h.value=null,ge(),await Q(),u.show()}else if(B.name==="edit-session"){const ie=B.data||{};f.value="edit-session",w.value=ie.session||null,d.value=w.value?.project_id||null,h.value=null,ge(),w.value&&Ee(w.value),u.show()}else B.name==="template-management"&&(f.value="template-list",ge(),await Q(),u.show());te?.name==="configuration"&&te.data?.mode?.includes("template")&&B?.name==="configuration"&&f.value==="create-session"&&await Q()}}),fe(()=>r.default_role,B=>{g.value.default_role!==null&&(_.default_role=B===g.value.default_role?"autofilled":"modified")}),fe(()=>r.initialization_context,B=>{g.value.initialization_context!==null&&(_.initialization_context=B===g.value.initialization_context?"autofilled":"modified")}),fe(()=>r.permission_mode,B=>{g.value.permission_mode!==null&&(_.permission_mode=B===g.value.permission_mode?"autofilled":"modified")}),fe(()=>r.allowed_tools,B=>{g.value.allowed_tools!==null&&(_.allowed_tools=B===g.value.allowed_tools?"autofilled":"modified")}),fe(()=>r.disallowed_tools,B=>{g.value.disallowed_tools!==null&&(_.disallowed_tools=B===g.value.disallowed_tools?"autofilled":"modified")}),fe(()=>r.model,B=>{g.value.model!==null&&(_.model=B===g.value.model?"autofilled":"modified")}),fe(()=>r.capabilities,B=>{g.value.capabilities!==null&&(_.capabilities=B===g.value.capabilities?"autofilled":"modified")}),fe(()=>r.sandbox.excludedCommands,B=>{g.value.sandbox_excludedCommands!==null&&(_.sandbox_excludedCommands=B===g.value.sandbox_excludedCommands?"autofilled":"modified")}),fe(()=>r.sandbox.network.allowedDomains,B=>{g.value.sandbox_network_allowedDomains!==null&&(_.sandbox_network_allowedDomains=B===g.value.sandbox_network_allowedDomains?"autofilled":"modified")}),fe(()=>r.sandbox.network.allowUnixSockets,B=>{g.value.sandbox_network_allowUnixSockets!==null&&(_.sandbox_network_allowUnixSockets=B===g.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),fe(()=>r.sandbox.ignoreViolations.file,B=>{g.value.sandbox_ignoreViolations_file!==null&&(_.sandbox_ignoreViolations_file=B===g.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),fe(()=>r.sandbox.ignoreViolations.network,B=>{g.value.sandbox_ignoreViolations_network!==null&&(_.sandbox_ignoreViolations_network=B===g.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),De(()=>{c.value&&Ie(()=>import("./modal-D6mKceGM.js").then(B=>B.m),__vite__mapDeps([0,1])).then(B=>{const te=B.default;u=new te(c.value),c.value.addEventListener("shown.bs.modal",Ye),c.value.addEventListener("hidden.bs.modal",ht)})}),Me(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",Ye),c.value.removeEventListener("hidden.bs.modal",ht)),u&&u.dispose()}),(B,te)=>(i(),l(ne,null,[t("div",{ref_key:"modalElement",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",bE,[t("div",yE,[t("div",wE,[t("h5",kE,[f.value==="create-template"||f.value==="edit-template"?(i(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:P,title:"Back to template list"}," â† ")):E("",!0),ce(" "+y(x.value),1)]),te[4]||(te[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",$E,[f.value==="template-list"?(i(),l("div",SE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[te[5]||(te[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:I,class:"btn btn-primary btn-sm"}," + Create New ")]),S.value.length===0?(i(),l("div",xE," No templates found. Create your first template! ")):E("",!0),(i(!0),l(ne,null,ue(S.value,ie=>(i(),l("div",{key:ie.template_id,class:"card mb-2"},[t("div",CE,[t("div",EE,[t("div",TE,[t("h6",AE,y(ie.name),1),ie.description?(i(),l("p",DE,y(ie.description),1)):E("",!0),t("div",ME,[t("span",OE,y(ie.permission_mode),1),t("span",NE,y(ie.allowed_tools?.length||0)+" tools",1)])]),t("div",LE,[t("button",{onClick:we=>V(ie),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,IE),t("button",{onClick:we=>Z(ie),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,jE)])])])]))),128))])):(i(),l("div",PE,[t("ul",RE,[t("li",BE,[t("button",{class:K(["nav-link",{active:p.value==="general","has-error":C.value.general}]),type:"button",onClick:te[0]||(te[0]=ie=>p.value="general")},[te[6]||(te[6]=ce(" General ",-1)),C.value.general?(i(),l("span",FE)):E("",!0)],2)]),t("li",VE,[t("button",{class:K(["nav-link",{active:p.value==="permissions","has-error":C.value.permissions}]),type:"button",onClick:te[1]||(te[1]=ie=>p.value="permissions")},[te[7]||(te[7]=ce(" Permissions ",-1)),C.value.permissions?(i(),l("span",WE)):E("",!0)],2)]),t("li",UE,[t("button",{class:K(["nav-link",{active:p.value==="advanced","has-error":C.value.advanced}]),type:"button",onClick:te[2]||(te[2]=ie=>p.value="advanced")},[te[8]||(te[8]=ce(" Advanced ",-1)),C.value.advanced?(i(),l("span",HE)):E("",!0)],2)]),t("li",qE,[t("button",{class:K(["nav-link",{active:p.value==="sandbox"}]),type:"button",onClick:te[3]||(te[3]=ie=>p.value="sandbox")}," Sandbox ",2)])]),t("div",zE,[xe(ye(Sx,{mode:f.value,"form-data":r,errors:$,templates:S.value,"selected-template-id":k.value,session:w.value,"field-states":_,"onUpdate:formData":ee,"onUpdate:selectedTemplateId":_e,onOpenFolderBrowser:z,onOpenTemplateManager:P},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ct,p.value==="general"]]),xe(ye(uC,{mode:f.value,"form-data":r,errors:$,session:w.value,"field-states":_,"onUpdate:formData":ee,onPreviewPermissions:H},null,8,["mode","form-data","errors","session","field-states"]),[[ct,p.value==="permissions"]]),xe(ye(AC,{mode:f.value,"form-data":r,errors:$,session:w.value,"field-states":_,"onUpdate:formData":ee},null,8,["mode","form-data","errors","session","field-states"]),[[ct,p.value==="advanced"]]),xe(ye(eE,{mode:f.value,"form-data":r,errors:$,session:w.value,"field-states":_,"onUpdate:formData":ee},null,8,["mode","form-data","errors","session","field-states"]),[[ct,p.value==="sandbox"]])])])),N.value?(i(),l("div",KE,y(N.value),1)):E("",!0)]),ae.value?(i(),l("div",{key:0,class:K(["warning-banner","warning-banner-"+J.value])},[J.value==="reset"?(i(),l("small",GE,[...te[9]||(te[9]=[ce(" Changes require a ",-1),t("strong",null,"reset",-1),ce(" to take effect. This starts a new conversation. ",-1)])])):(i(),l("small",YE,[...te[10]||(te[10]=[ce(" Changes require a ",-1),t("strong",null,"restart",-1),ce(" to take effect. ",-1)])]))],2)):E("",!0),t("div",JE,[t("button",QE,y(f.value==="template-list"?"Close":"Cancel"),1),f.value!=="template-list"?(i(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:T.value||!q.value,onClick:$e},[T.value?(i(),l("span",ZE)):E("",!0),ce(" "+y(M.value),1)],8,XE)):E("",!0)])])])],512),ye(gE,{ref_key:"permissionPreviewModal",ref:m,"working-directory":L.value,"setting-sources":r.setting_sources,"session-allowed-tools":j.value,"session-disallowed-tools":R.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},tT=se(eT,[["__scopeId","data-v-da2afdcd"]]),sT={class:"modal-dialog modal-dialog-centered"},nT={class:"modal-content"},oT={class:"modal-header"},aT={class:"modal-title",id:"manageSessionModalLabel"},iT={class:"modal-body"},lT={key:0,class:"text-center py-4"},rT={class:"text-muted"},cT={key:1},uT={key:2},dT={class:"text-muted"},mT={key:0,class:"text-center py-2"},fT={key:1,class:"alert alert-warning mt-3"},pT={class:"mb-0 mt-2"},vT={key:0,class:"text-muted"},_T={key:3},hT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},gT={class:"d-grid gap-2"},bT=["disabled"],yT=["disabled"],wT=["disabled"],kT=["disabled"],$T={class:"modal-footer"},ST={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},xT={__name:"SessionManageModal",setup(n){const e=Qt(),s=pe(),o=Se(),a=ft();je();const c=O(null),u=O(!1),m=O(""),f=O(""),p=O(null),d=O(null);let w=null;const h=O([]),S=O(!1),k=v(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function b(){p.value="reset"}async function g(){if(p.value="delete",h.value=[],!!c.value){S.value=!0;try{const x=await ke.get(`/api/sessions/${c.value.session_id}/descendants`);h.value=x.descendants||[]}catch(x){console.error("Failed to fetch descendants:",x),h.value=[]}finally{S.value=!1}}}function _(){p.value=null}async function r(){p.value==="reset"?await T():p.value==="delete"&&await N()}async function $(){if(c.value){u.value=!0,m.value="Restarting session...";try{const x=c.value.session_id,M=s.currentSessionId===x,q=await ke.post(`/api/sessions/${x}/restart`);if(q.success)console.log("Session restarted successfully"),M&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(x)),w&&w.hide();else{const F=q.error||q.detail||"Failed to restart session";console.error("Failed to restart session:",F),f.value=`Failed to restart session: ${F}`}}catch(x){console.error("Error restarting session:",x);const M=x.data?.detail||x.message||"Unknown error";f.value=`Error restarting session: ${M}`}finally{u.value=!1}}}async function C(){if(c.value)try{w&&w.hide(),console.log("Ending session",c.value.session_id);const x=c.value.session_id;await ke.post(`/api/sessions/${x}/terminate`),s.currentSessionId===x&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(x){console.error("Error ending session:",x),s.currentSessionId===c.value?.session_id&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function T(){if(c.value){u.value=!0,m.value="Resetting session...";try{const x=c.value.session_id,M=s.currentSessionId===x,q=await ke.post(`/api/sessions/${x}/reset`);if(q.success)console.log("Session reset successfully"),M&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(x)),w&&w.hide();else{const F=q.error||q.detail||"Failed to reset session";console.error("Failed to reset session:",F),f.value=`Failed to reset session: ${F}`,p.value=null}}catch(x){console.error("Error resetting session:",x);const M=x.data?.detail||x.message||"Unknown error";f.value=`Error resetting session: ${M}`,p.value=null}finally{u.value=!1}}}async function N(){if(c.value){u.value=!0,m.value="Deleting session...";try{const x=c.value.session_id;await s.deleteSession(x),e.currentRoute.value.params.sessionId===x&&e.push("/"),w&&w.hide()}catch(x){console.error("Error deleting session:",x);const M=x.data?.detail||x.message||"Unknown error";f.value=`Error deleting session: ${M}`,p.value=null}finally{u.value=!1}}}function D(){p.value=null,u.value=!1,m.value="",f.value="",h.value=[],S.value=!1}function A(){D(),c.value=null,o.hideModal()}return fe(()=>o.currentModal,x=>{if(x?.name==="manage-session"&&w){const M=x.data||{};c.value=M.session,D(),w.show()}}),De(()=>{d.value&&Ie(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(M=>M.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{w=new x(d.value),d.value.addEventListener("hidden.bs.modal",A)})}),Me(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",A),w&&w.dispose()}),(x,M)=>(i(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",sT,[t("div",nT,[t("div",oT,[t("h5",aT,y(p.value?k.value:"Manage Session"),1),M[1]||(M[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",iT,[u.value?(i(),l("div",lT,[M[2]||(M[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",rT,y(m.value),1)])):p.value==="reset"?(i(),l("div",cT,[...M[3]||(M[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(i(),l("div",uT,[M[9]||(M[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",dT,[M[4]||(M[4]=ce("This will permanently delete session ",-1)),t("strong",null,y(c.value?.name),1),M[5]||(M[5]=ce(".",-1))]),M[10]||(M[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),S.value?(i(),l("div",mT,[...M[6]||(M[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):h.value.length>0?(i(),l("div",fT,[M[7]||(M[7]=t("strong",null,"Cascading Deletion:",-1)),M[8]||(M[8]=ce(" This session has ",-1)),t("strong",null,y(h.value.length),1),ce(" child session"+y(h.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",pT,[(i(!0),l(ne,null,ue(h.value,q=>(i(),l("li",{key:q.session_id,class:"small"},[t("strong",null,y(q.name||q.session_id),1),q.role?(i(),l("span",vT," ("+y(q.role)+")",1)):E("",!0)]))),128))])])):E("",!0)])):(i(),l("div",_T,[f.value?(i(),l("div",hT,[M[11]||(M[11]=t("strong",null,"Error:",-1)),ce(" "+y(f.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:M[0]||(M[0]=q=>f.value="")})])):E("",!0),M[18]||(M[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",gT,[t("button",{class:"btn btn-outline-primary text-start",onClick:$,disabled:u.value},[...M[12]||(M[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,bT),t("button",{class:"btn btn-outline-secondary text-start",onClick:C,disabled:u.value},[...M[13]||(M[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,yT),M[16]||(M[16]=t("hr",{class:"my-2"},null,-1)),M[17]||(M[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:u.value},[...M[14]||(M[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,wT),t("button",{class:"btn btn-outline-danger text-start",onClick:g,disabled:u.value},[...M[15]||(M[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,kT)]),M[19]||(M[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ce(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",$T,[p.value&&!u.value?(i(),l(ne,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),t("button",{type:"button",class:K(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:r},y(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):u.value?E("",!0):(i(),l("button",ST,"Cancel"))])])])],512))}},CT=se(xT,[["__scopeId","data-v-6b832853"]]),ET={class:"modal-dialog modal-dialog-centered modal-lg"},TT={class:"modal-content"},AT={class:"modal-body"},DT={key:0,class:"text-center text-muted py-4"},MT={key:1},OT={class:"mb-3"},NT={class:"font-monospace small"},LT={class:"mb-3"},IT=["value"],jT={class:"mb-3"},PT={class:"mb-3"},RT={class:"mb-3"},BT={key:0},FT={class:"d-flex flex-wrap gap-1"},VT={key:1,class:"text-muted small"},WT={key:0,class:"mb-3"},UT={class:"d-flex flex-wrap gap-1"},HT={key:1,class:"mb-3"},qT={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},zT={class:"mb-3"},KT={class:"text-muted"},GT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},YT={__name:"SessionInfoModal",setup(n){const e=pe(),s=je(),o=Se(),a=O(null),c=O(!1),u=O(null);let m=null;const f={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},p=v(()=>{if(!a.value)return null;const b=e.initData.get(a.value);return b||(s.messagesBySession.get(a.value)||[]).find(r=>r.type==="system"&&(r.subtype==="init"||r.metadata?.subtype==="init")&&r.metadata?.init_data)?.metadata?.init_data||null});function d(b){return b?f[b]||b:"Default (Sonnet 4.5)"}function w(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function h(b){b.target.select()}function S(){a.value=null,c.value=!1}function k(){S(),o.hideModal()}return fe(()=>o.currentModal,b=>{if(b?.name==="session-info"&&m){const g=b.data||{};a.value=g.sessionId,c.value=!1,m.show()}}),De(()=>{u.value&&Ie(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(g=>g.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{m=new b(u.value),u.value.addEventListener("hidden.bs.modal",k)})}),Me(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",k),m&&m.dispose()}),(b,g)=>(i(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",ET,[t("div",TT,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",AT,[p.value?(i(),l("div",MT,[t("div",OT,[g[1]||(g[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",NT,y(a.value),1)]),t("div",LT,[g[2]||(g[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:h},null,8,IT)]),t("div",jT,[g[3]||(g[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,y(d(p.value.model)),1)]),t("div",PT,[g[4]||(g[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,y(p.value.permissionMode||"default"),1)]),t("div",RT,[g[5]||(g[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(i(),l("div",BT,[t("div",FT,[(i(!0),l(ne,null,ue(p.value.allowed_tools||p.value.tools,_=>(i(),l("span",{key:_,class:"badge bg-secondary"},y(_),1))),128))])])):(i(),l("div",VT,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(i(),l("div",WT,[g[6]||(g[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",UT,[(i(!0),l(ne,null,ue(p.value.commands,_=>(i(),l("span",{key:_,class:"badge bg-info"},y(_),1))),128))])])):E("",!0),p.value.systemPrompt?(i(),l("div",HT,[g[7]||(g[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",qT,y(w(p.value.systemPrompt)),1)])):E("",!0),t("div",zT,[t("h6",KT,[g[8]||(g[8]=ce(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:g[0]||(g[0]=_=>c.value=!c.value)},y(c.value?"Hide":"Show"),1)]),c.value?(i(),l("pre",GT,y(JSON.stringify(p.value,null,2)),1)):E("",!0)])])):(i(),l("div",DT," No session configuration data available "))]),g[10]||(g[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},JT=se(YT,[["__scopeId","data-v-b28b39b3"]]),QT={class:"modal-dialog modal-dialog-centered modal-lg"},XT={class:"modal-content"},ZT={class:"modal-body"},e2={key:0,class:"text-center text-muted py-4"},t2={key:1},s2={class:"mb-3"},n2={class:"mb-3"},o2={class:"font-monospace small"},a2={class:"mb-3"},i2={class:"mb-3"},l2={class:"mb-3"},r2={key:0},c2={class:"d-flex flex-wrap gap-1"},u2={key:1,class:"text-muted small"},d2={class:"mb-3"},m2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},f2={key:1,class:"text-muted small"},p2={class:"mb-3"},v2={key:0,class:"badge bg-info"},_2={key:1,class:"badge bg-secondary"},h2={class:"mb-3"},g2={key:0,class:"font-monospace small"},b2={key:1,class:"text-muted small"},y2={key:0,class:"mb-3"},w2={key:0},k2={class:"list-unstyled mb-0"},$2={key:1,class:"text-muted small"},S2={class:"mb-3"},x2={class:"small"},C2={class:"mb-3"},E2={class:"small"},T2={__name:"MinionViewModal",setup(n){const e=Se(),s=O(null),o=O(null);let a=null;function c(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function u(p){if(!p)return"N/A";try{const d=new Date(p);return isNaN(d.getTime())?"Invalid date":d.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(d){return console.error("Error formatting timestamp:",d),"Invalid date"}}function m(){s.value=null}function f(){m(),e.hideModal()}return fe(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&a){const d=p.data||{};s.value=d.session,a.show()}}),De(()=>{o.value&&Ie(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{a=new p(o.value),o.value.addEventListener("hidden.bs.modal",f)})}),Me(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",f),a&&a.dispose()}),(p,d)=>(i(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",QT,[t("div",XT,[d[11]||(d[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ZT,[s.value?(i(),l("div",t2,[t("div",s2,[d[0]||(d[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,y(s.value.name||"Unnamed Minion"),1)]),t("div",n2,[d[1]||(d[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",o2,y(s.value.session_id),1)]),t("div",a2,[d[2]||(d[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,y(s.value.role||"Not specified"),1)]),t("div",i2,[d[3]||(d[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:K(["badge",c(s.value.state)])},y(s.value.state),3)])]),t("div",l2,[d[4]||(d[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),l("div",r2,[t("div",c2,[(i(!0),l(ne,null,ue(s.value.capabilities,w=>(i(),l("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(i(),l("div",u2,"None"))]),t("div",d2,[d[5]||(d[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),l("div",m2,y(s.value.initialization_context),1)):(i(),l("div",f2,"Not specified"))]),t("div",p2,[d[6]||(d[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),l("span",v2,"Yes")):(i(),l("span",_2,"No"))])]),t("div",h2,[d[7]||(d[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),l("div",g2,y(s.value.parent_overseer_id),1)):(i(),l("div",b2," Root overseer (user-created) "))]),s.value.is_overseer?(i(),l("div",y2,[d[8]||(d[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),l("div",w2,[t("ul",k2,[(i(!0),l(ne,null,ue(s.value.child_minion_ids,w=>(i(),l("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(i(),l("div",$2,"No children"))])):E("",!0),t("div",S2,[d[9]||(d[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",x2,y(u(s.value.created_at)),1)]),t("div",C2,[d[10]||(d[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",E2,y(u(s.value.updated_at)),1)])])):(i(),l("div",e2," No minion data available "))]),d[12]||(d[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},A2=se(T2,[["__scopeId","data-v-d996dc6f"]]),D2={class:"modal-dialog modal-dialog-centered"},M2={class:"modal-content"},O2={class:"modal-header"},N2={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},L2={class:"modal-body"},I2={key:0},j2={key:0,class:"text-center py-3"},P2={key:1,class:"card bg-light mb-3"},R2={class:"card-body py-2 px-3"},B2={class:"small"},F2={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},V2={key:0,class:"text-warning mt-1"},W2={key:2,class:"alert alert-warning py-2 small"},U2={key:1,class:"text-center py-3"},H2={key:0,class:"mb-3"},q2={key:1,class:"mb-3"},z2={key:2,class:"mb-3"},K2={class:"text-muted small mt-1"},G2={key:3,class:"mb-3"},Y2={class:"mt-2 text-danger"},J2={class:"modal-footer"},Q2=["disabled"],X2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},Z2={__name:"RestartModal",setup(n){const e=Se(),s=O(null);let o=null;const a=O("confirm"),c=O(!1),u=O(null),m=O(null),f=O(""),p=O(60);let d=null,w=null;async function h(){c.value=!0,m.value=null;try{u.value=await Ga()}catch(r){m.value=r.message||"Unknown error"}finally{c.value=!1}}async function S(){a.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Ya(),e.restartStatus="restarting",k()}catch(r){e.restartStatus="error",f.value=r.message||"Restart failed",e.restartInProgress=!1}}function k(){e.restartStatus="reconnecting",p.value=60;const r=Date.now();w=setInterval(()=>{const $=Math.floor((Date.now()-r)/1e3);p.value=Math.max(0,60-$)},1e3),setTimeout(()=>{d=setInterval(async()=>{try{(await fetch("/health")).ok&&(b(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-r>6e4&&(b(),e.restartStatus="error",f.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function b(){d&&(clearInterval(d),d=null),w&&(clearInterval(w),w=null)}function g(){a.value="confirm",u.value=null,m.value=null,f.value="",p.value=60,b()}function _(){e.restartInProgress||(g(),e.restartStatus="idle"),e.hideModal()}return fe(()=>e.currentModal,r=>{r?.name==="restart-server"&&o&&(g(),o.show(),h())}),De(()=>{s.value&&Ie(async()=>{const{default:r}=await import("./modal-D6mKceGM.js").then($=>$.m);return{default:r}},__vite__mapDeps([0,1])).then(({default:r})=>{o=new r(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",_)})}),Me(()=>{b(),s.value&&s.value.removeEventListener("hidden.bs.modal",_),o&&o.dispose()}),(r,$)=>(i(),l("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",D2,[t("div",M2,[t("div",O2,[$[0]||($[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),a.value==="confirm"?(i(),l("button",N2)):E("",!0)]),t("div",L2,[a.value==="confirm"?(i(),l("div",I2,[$[5]||($[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),c.value?(i(),l("div",j2,[...$[1]||($[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):u.value?(i(),l("div",P2,[t("div",R2,[t("div",B2,[t("div",null,[$[2]||($[2]=t("strong",null,"Branch:",-1)),ce(" "+y(u.value.branch),1)]),t("div",null,[$[3]||($[3]=t("strong",null,"Last commit:",-1)),ce(" "+y(u.value.last_commit_message),1)]),t("div",F2,y(u.value.last_commit_hash?.substring(0,12)),1),u.value.has_uncommitted_changes?(i(),l("div",V2,[...$[4]||($[4]=[t("strong",null,"Warning:",-1),ce(" Uncommitted changes detected. git pull may fail. ",-1)])])):E("",!0)])])])):m.value?(i(),l("div",W2," Could not fetch git status: "+y(m.value),1)):E("",!0)])):a.value==="progress"?(i(),l("div",U2,[le(e).restartStatus==="pulling"?(i(),l("div",H2,[...$[6]||($[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):le(e).restartStatus==="restarting"?(i(),l("div",q2,[...$[7]||($[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):le(e).restartStatus==="reconnecting"?(i(),l("div",z2,[$[8]||($[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),$[9]||($[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",K2,y(p.value)+"s remaining",1)])):le(e).restartStatus==="error"?(i(),l("div",G2,[$[10]||($[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",Y2,y(f.value),1)])):E("",!0)])):E("",!0)]),t("div",J2,[a.value==="confirm"?(i(),l(ne,{key:0},[$[11]||($[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:S,disabled:c.value}," Pull & Restart ",8,Q2)],64)):le(e).restartStatus==="error"?(i(),l("button",X2,"Close")):E("",!0)])])])],512))}},eA={class:"app-shell"},tA={class:"main-layout"},sA={class:"center-panel"},nA={__name:"App",setup(n){const e=Se(),s=ft(),o=pe(),a=Fe(),c=Nt(),u=Qe(),m=Qt(),f=O(null);function p(S){f.value=S}Cn("addAttachmentFromResource",p),Cn("pendingResourceAttachment",f);const d=v(()=>e.rightPanelVisible),w=v(()=>e.windowWidth<=1024);fe(()=>c.currentHasTasks,(S,k)=>{S&&!k&&e.setRightSidebarCollapsed(!1)}),fe(()=>u.currentHasResources,(S,k)=>{S&&!k&&e.setRightSidebarCollapsed(!1)}),De(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const S=window.location.hash;if(S.startsWith("#/session/")){const k=S.replace("#/session/","");o.sessions.has(k)&&await o.selectSession(k)}else if(S.startsWith("#/timeline/")){const k=S.replace("#/timeline/","");m.push(`/timeline/${k}`)}window.addEventListener("popstate",h),window.addEventListener("resize",e.handleResize)}),Me(()=>{window.removeEventListener("popstate",h),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function h(){const S=window.location.hash;if(S.startsWith("#/session/")){const k=S.replace("#/session/","");o.sessions.has(k)&&o.selectSession(k)}}return(S,k)=>{const b=So("router-view");return i(),l("div",eA,[ye(v1),ye(x1),ye(q1),t("div",{id:"right-panel-backdrop",class:K({show:d.value&&w.value}),onClick:k[0]||(k[0]=g=>le(e).setRightPanelVisible(!1))},null,2),t("div",tA,[t("main",sA,[ye(b)]),ye(IS,{class:K({"panel-overlay":w.value,"panel-visible":d.value})},null,8,["class"])]),ye(XS),ye(p0),ye(j0),ye(tT),ye(CT),ye(JT),ye(A2),ye(Z2)])}}},Sn=Ba(nA);Sn.use(Fa());Sn.use(d1);Sn.mount("#app");
