const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-BK1Vt_in.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as p,a as s,o as u,d as wt,r as L,b,t as E,n as Ze,e as Z,f as ne,u as ts,w as le,g as hs,F as re,h as ue,i as D,j as ge,k as to,l as oe,v as de,m as Nt,p as _e,q as ce,s as pe,x as mi,y as Ps,z as he,A as Pe,B as so,C as it,D as pi,E as fi,G as Lt,H as vi,I as hi}from"./vue-vendor-CpnrLznN.js";import{m as tt,p as as}from"./markdown-vendor-BRsjnVvP.js";import{c as _i}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const gi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},bi={__name:"NoSessionSelected",setup(n){return(e,t)=>(u(),p("div",gi,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},yi="modulepreload",$i=function(n){return"/"+n},mn={},be=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let d=function(h){return Promise.all(h.map(c=>Promise.resolve(c).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),r=l?.nonce||l?.getAttribute("nonce");i=d(t.map(h=>{if(h=$i(h),h in mn)return;mn[h]=!0;const c=h.endsWith(".css"),$=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${$}`))return;const _=document.createElement("link");if(_.rel=c?"stylesheet":yi,c||(_.as="script"),_.crossOrigin="",_.href=h,r&&_.setAttribute("nonce",r),document.head.appendChild(_),c)return new Promise((v,y)=>{_.addEventListener("load",v),_.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return i.then(l=>{for(const r of l||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})};class _s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function It(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new _s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof _s?t:(console.error("API request failed:",t),new _s(`Network error: ${t.message}`,0,null))}}async function wi(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[r,d]of Object.entries(e.params))d!=null&&o.append(r,d);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...l}=e;return It(t,{...l,method:"GET"})}return It(t,{...e,method:"GET"})}async function Ei(n,e,t={}){return It(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Ci(n,e,t={}){return It(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Si(n,e={}){return It(n,{...e,method:"DELETE"})}const ie={get:wi,post:Ei,put:Ci,delete:Si},ae=wt("session",()=>{const n=L(new Map),e=L(null),t=L(new Map),o=L(new Map),i=L(new Set),a=L(!1);let l=null;const r=b(()=>n.value.get(e.value)),d=b(()=>Array.from(n.value.values()).sort((k,O)=>k.order-O.order)),h=k=>b(()=>d.value.filter(O=>O.project_id===k)),c=b({get:()=>t.value.get(e.value)||"",set:k=>{e.value&&t.value.set(e.value,k)}});async function $(){try{const k=await ie.get("/api/sessions");return n.value.clear(),k.sessions.forEach(O=>{n.value.set(O.session_id,O)}),console.log(`Loaded ${n.value.size} sessions`),k.sessions}catch(k){throw console.error("Failed to fetch sessions:",k),k}}async function _(k,O){try{const z=(await ie.post("/api/sessions",{project_id:k,...O})).session_id,B=(await ie.get(`/api/sessions/${z}`)).session;return n.value.set(z,B),n.value=new Map(n.value),console.log(`Created session ${z}`),B}catch(P){throw console.error("Failed to create session:",P),P}}async function v(k){if(e.value===k&&!a.value)return;l&&(console.log(`Aborting pending selection to switch to ${k}`),l.abort(),l=null);const O=new AbortController;l=O,a.value=!0;try{if(e.value=k,O.signal.aborted){console.log(`Selection of ${k} aborted early`);return}let P=n.value.get(k);if(!P)try{const B=await ie.get(`/api/sessions/${k}`);if(O.signal.aborted){console.log(`Selection of ${k} aborted after fetch`);return}P=B.session,n.value.set(k,P),n.value=new Map(n.value),console.log(`Fetched session ${k} for deeplink`)}catch(B){console.error(`Failed to fetch session ${k}:`,B);return}if(P&&(P.state==="created"||P.state==="terminated"))try{if(await w(k),O.signal.aborted){console.log(`Selection of ${k} aborted after start`);return}console.log(`Auto-started session ${k} (was in ${P.state} state)`);const B=6e4,S=200,T=5e3;let V=0,A=0;for(;V<B;){if(O.signal.aborted){console.log(`Selection of ${k} aborted during state wait`);return}const j=n.value.get(k);if(j&&j.state==="active"){console.log(`Session ${k} is now active after ${V}ms`);break}if(V-A>=T){const U=n.value.get(k)?.state||"unknown";console.log(`Waiting for session ${k} to become active (current: ${U}, ${V/1e3}s elapsed)`),A=V}await new Promise(U=>setTimeout(U,S)),V+=S}const x=n.value.get(k);x&&x.state!=="active"&&console.warn(`Session ${k} did not become active within ${B/1e3}s (state: ${x.state}), continuing anyway`)}catch(B){console.error(`Failed to auto-start session ${k}:`,B)}if(O.signal.aborted){console.log(`Selection of ${k} aborted before message load`);return}if(await(await be(()=>Promise.resolve().then(()=>qi),void 0)).useMessageStore().loadMessages(k),O.signal.aborted){console.log(`Selection of ${k} aborted after message load`);return}await(await be(()=>Promise.resolve().then(()=>ma),void 0)).useWebSocketStore().connectSession(k),O.signal.aborted||console.log(`Selected session ${k}`)}finally{l===O&&(l=null),a.value=!1}}function y(k,O){const P=n.value.get(k);P?Object.assign(P,O):(n.value.set(k,O),console.log(`Added new session ${k} via WebSocket update`)),n.value=new Map(n.value)}async function g(k){i.value.add(k);try{await ie.delete(`/api/sessions/${k}`),n.value.delete(k),t.value.delete(k),o.value.delete(k),n.value=new Map(n.value),e.value===k&&(e.value=null),console.log(`Deleted session ${k}`)}catch(O){throw console.error("Failed to delete session:",O),O}finally{i.value.delete(k)}}async function f(k,O){try{await ie.put(`/api/sessions/${k}/name`,{name:O}),y(k,{name:O}),console.log(`Updated session ${k} name to "${O}"`)}catch(P){throw console.error("Failed to update session name:",P),P}}async function m(k,O){try{await ie.post(`/api/sessions/${k}/permission-mode`,{mode:O}),y(k,{current_permission_mode:O});const P=o.value.get(k);P&&(P.permissionMode=O,o.value.set(k,P)),console.log(`Set permission mode for session ${k} to ${O}`)}catch(P){throw console.error("Failed to set permission mode:",P),P}}async function w(k){try{await ie.post(`/api/sessions/${k}/start`),console.log(`Started session ${k}`)}catch(O){throw console.error("Failed to start session:",O),O}}async function C(k){try{await ie.post(`/api/sessions/${k}/pause`),console.log(`Paused session ${k}`)}catch(O){throw console.error("Failed to pause session:",O),O}}async function M(k){try{await ie.post(`/api/sessions/${k}/terminate`),console.log(`Terminated session ${k}`)}catch(O){throw console.error("Failed to terminate session:",O),O}}function N(k){return n.value.get(k)}function I(k,O){o.value.set(k,O),O.permissionMode&&y(k,{current_permission_mode:O.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:r,orderedSessions:d,sessionsInProject:h,currentInput:c,fetchSessions:$,createSession:_,selectSession:v,updateSession:y,deleteSession:g,updateSessionName:f,setPermissionMode:m,startSession:w,pauseSession:C,terminateSession:M,getSession:N,storeInitData:I}}),pn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ae},Symbol.toStringTag,{value:"Module"})),me=wt("ui",()=>{const n=L(window.innerWidth<768),e=L(300),t=L(window.innerWidth),o=b(()=>t.value<768),i=L(!0),a=L(null),l=L(null),r=b(()=>a.value?{name:a.value,data:l.value}:null),d=L(!1),h=L("Loading...");function c(){n.value=!n.value}function $(C){n.value=C}function _(C){e.value=Math.max(200,Math.min(C,window.innerWidth*.3))}function v(C){i.value=C}function y(C,M=null){a.value=null,l.value=null,setTimeout(()=>{a.value=C,l.value=M},0)}function g(){a.value=null,l.value=null}function f(C="Loading..."){d.value=!0,h.value=C}function m(){d.value=!1}function w(){const C=t.value;t.value=window.innerWidth,t.value<768&&C>=768?n.value=!0:t.value>=768&&C<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:l,currentModal:r,isLoading:d,loadingMessage:h,toggleSidebar:c,setSidebarCollapsed:$,setSidebarWidth:_,setAutoScroll:v,showModal:y,hideModal:g,showLoading:f,hideLoading:m,handleResize:w}}),we=wt("project",()=>{const n=L(new Map),e=L(null),t=b(()=>n.value.get(e.value)),o=b(()=>Array.from(n.value.values()).sort((g,f)=>g.order-f.order)),i=g=>n.value.get(g)?.is_multi_agent||!1;async function a(){try{const g=await ie.get("/api/projects");return n.value.clear(),g.projects.forEach(f=>{n.value.set(f.project_id,f)}),console.log(`Loaded ${n.value.size} projects`),g.projects}catch(g){throw console.error("Failed to fetch projects:",g),g}}async function l(g,f,m=!1){try{const C=(await ie.post("/api/projects",{name:g,working_directory:f,is_multi_agent:m})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(w){throw console.error("Failed to create project:",w),w}}async function r(g,f){try{await ie.put(`/api/projects/${g}`,f),d(g,f),console.log(`Updated project ${g}`,f)}catch(m){throw console.error("Failed to update project:",m),m}}function d(g,f){const m=n.value.get(g);m&&(Object.assign(m,f),n.value=new Map(n.value))}async function h(g){try{await ie.delete(`/api/projects/${g}`),n.value.delete(g),n.value=new Map(n.value),e.value===g&&(e.value=null),console.log(`Deleted project ${g}`)}catch(f){throw console.error("Failed to delete project:",f),f}}async function c(g){try{const f=await ie.put(`/api/projects/${g}/toggle-expansion`),m=n.value.get(g);return m&&(m.is_expanded=f.is_expanded,n.value=new Map(n.value)),f.is_expanded}catch(f){throw console.error("Failed to toggle expansion:",f),f}}async function $(g){try{await ie.put("/api/projects/reorder",{project_ids:g}),g.forEach((f,m)=>{const w=n.value.get(f);w&&(w.order=m)}),n.value=new Map(n.value),console.log("Reordered projects",g)}catch(f){throw console.error("Failed to reorder projects:",f),f}}async function _(g,f){try{await ie.put(`/api/projects/${g}/sessions/reorder`,{session_ids:f});const m=n.value.get(g);m&&(m.session_ids=f,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${g}`,f)}catch(m){throw console.error("Failed to reorder sessions:",m),m}}function v(g){return n.value.get(g)}function y(g){if(!g)return"";const f=g.split(/[/\\]/).filter(m=>m);return f.length===0?"/":f.length===1?`/${f[0]}`:f.length===2?`/${f.join("/")}`:`.../${f.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:l,updateProject:r,updateProjectLocal:d,deleteProject:h,toggleExpansion:c,reorderProjects:$,reorderSessionsInProject:_,getProject:v,formatPath:y}}),te=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},ki={class:"session-header border-bottom p-3"},Ti={class:"project-name"},xi=["title"],Ai={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ae(),o=we(),i=b(()=>t.sessions.get(e.sessionId)),a=b(()=>i.value?.name||e.sessionId),l=b(()=>{for(const d of o.projects.values())if(d.session_ids?.includes(e.sessionId))return d;return null}),r=b(()=>l.value?.name||"Unknown Project");return(d,h)=>(u(),p("div",ki,[s("div",null,[s("div",Ti,E(r.value),1),s("div",{class:"session-name",title:n.sessionId},E(a.value),9,xi)])]))}},Mi=te(Ai,[["__scopeId","data-v-89e9c269"]]),Oi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Di=["title"],Ni={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Li={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ae(),o=b(()=>t.sessions.get(e.sessionId)),i=b(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=b(()=>{const d=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[d]||"#d3d3d3"}),l=b(()=>{const d=i.value;return d==="starting"||d==="processing"||d==="pending-prompt"}),r=b(()=>{if(!o.value)return"No session selected";const d=i.value,h=d.charAt(0).toUpperCase()+d.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",$=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${$}: ${h}`});return(d,h)=>(u(),p("div",Oi,[o.value?(u(),p("div",{key:0,class:Z(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:Ze({width:"100%",backgroundColor:a.value}),title:r.value},null,14,Di)):(u(),p("div",Ni))]))}},Ii=te(Li,[["__scopeId","data-v-e8795bb7"]]),Pi={class:"session-status-bar border-top p-2 bg-light"},ji={class:"d-flex justify-content-between align-items-center gap-2"},Ri={class:"d-flex gap-2"},Hi=["disabled"],Wi={class:"mode-label"},Vi=["disabled"],Fi=["disabled"],Ui={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ae(),o=me(),i=b(()=>t.sessions.get(e.sessionId)),a=b(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},r=b(()=>l[a.value]||"ðŸ”’"),d=b(()=>a.value),h=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(m){console.error("Failed to cycle permission mode:",m)}return}const g=(h.indexOf(a.value)+1)%h.length,f=h[g];try{await t.setPermissionMode(e.sessionId,f)}catch(m){console.error("Failed to cycle permission mode:",m)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},_=()=>{o.showModal("manage-session",{session:i.value})},v=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(y,g)=>(u(),p("div",Pi,[s("div",ji,[s("div",Ri,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[ne(E(r.value)+" ",1),s("span",Wi,E(d.value),1)],8,Hi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...g[0]||(g[0]=[ne(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Vi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!i.value},[...g[1]||(g[1]=[ne(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,Fi)]),s("div",null,[s("button",{class:Z(["btn btn-sm",ts(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:v}," â¬‡ï¸ "+E(ts(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Bi=te(Ui,[["__scopeId","data-v-fdcd3535"]]),xe=wt("message",()=>{const n=L(new Map),e=L(new Map),t=L(new Map),o=L(new Map),i=L(new Map),a=L(new Map),l=L(new Map),r=L(new Map),d=b(()=>{const A=ae();return n.value.get(A.currentSessionId)||[]}),h=b(()=>{const A=ae();return e.value.get(A.currentSessionId)||[]});async function c(A,x=null,j=0){try{const U=x||1e4,Y=await ie.get(`/api/sessions/${A}/messages?limit=${U}&offset=${j}`),Q=Y.messages||[],K=Y.total_count||Q.length,H=Y.has_more||!1;if(console.log(`Loaded ${Q.length} of ${K} messages for session ${A}`),n.value.set(A,Q),Q.length>0){const R=Q[Q.length-1];R.timestamp&&(l.value.set(A,R.timestamp),console.log(`Tracked last received timestamp for session ${A}: ${R.timestamp}`))}const J=new Set;Q.forEach(R=>{R.type==="assistant"&&R.metadata?.tool_uses&&R.metadata.tool_uses.forEach(W=>{J.add(W.id)}),R.type==="user"&&R.metadata?.tool_results&&R.metadata.tool_results.forEach(W=>{J.delete(W.tool_use_id);const X=a.value.get(A);X&&X.delete(W.tool_use_id)}),R.type==="system"&&R.metadata?.subtype==="client_launched"&&(J.forEach(W=>{O(A,W,"Session was restarted")}),J.clear()),R.type==="system"&&R.metadata?.subtype==="interrupt"&&(J.forEach(W=>{O(A,W,"Session was interrupted")}),J.clear()),R.metadata?.has_tool_uses&&R.metadata.tool_uses&&R.metadata.tool_uses.forEach(W=>{g(A,W)}),R.metadata?.has_tool_results&&R.metadata.tool_results&&R.metadata.tool_results.forEach(W=>{w(A,W)}),(R.type==="permission_request"||R.metadata?.has_permission_requests)&&f(A,R),R.type==="system"&&(R.subtype==="init"||R.metadata?.subtype==="init")&&R.metadata?.init_data&&ae().storeInitData(A,R.metadata.init_data)});const q=ae().sessions.get(A);return q&&!["active","paused","starting"].includes(q.state)&&(J.forEach(R=>{O(A,R,"Session was terminated")}),J.clear()),i.value.set(A,J),n.value=new Map(n.value),H&&console.warn(`Warning: Only loaded ${Q.length} of ${K} messages. Some messages may be missing.`),{messages:Q,totalCount:K,hasMore:H}}catch(U){throw console.error("Failed to load messages:",U),U}}function $(A,x){const j=i.value.get(A)||new Set;x.type==="assistant"&&x.metadata?.tool_uses&&x.metadata.tool_uses.forEach(U=>{j.add(U.id)}),x.type==="user"&&x.metadata?.tool_results&&x.metadata.tool_results.forEach(U=>{j.delete(U.tool_use_id);const Y=a.value.get(A);Y&&Y.delete(U.tool_use_id)}),x.type==="system"&&x.metadata?.subtype==="client_launched"&&(j.forEach(U=>{O(A,U,"Session was restarted")}),j.clear()),x.type==="system"&&x.metadata?.subtype==="interrupt"&&(j.forEach(U=>{O(A,U,"Session was interrupted")}),j.clear()),i.value.set(A,j)}function _(A,x){n.value.has(A)||n.value.set(A,[]);const j=n.value.get(A);if(x.id){const U=j.findIndex(Y=>Y.id===x.id);if(U!==-1){console.log(`Skipping duplicate message ${x.id} (already exists at index ${U})`);return}}j.push(x),x.timestamp&&l.value.set(A,x.timestamp),N(A,x),$(A,x),n.value=new Map(n.value)}function v(A,x){e.value.has(A)||e.value.set(A,[]),e.value.get(A).push(x),e.value=new Map(e.value)}function y(A,x,j){const U=e.value.get(A);if(U){const Y=U.find(Q=>Q.id===x);Y&&(Object.assign(Y,j),e.value=new Map(e.value))}}function g(A,x){const j=M(x.name,x.input);t.value.set(j,x.id);const U={id:x.id,name:x.name,input:x.input,signature:j,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return v(A,U),console.log(`Created tool call ${U.id} for ${U.name}`),U}function f(A,x){console.log("handlePermissionRequest received:",x);const j=x.metadata?.tool_name||x.tool_name,U=x.metadata?.input_params||x.input_params,Y=x.metadata?.request_id||x.request_id,Q=x.metadata?.suggestions||x.suggestions||[];console.log("Extracted data:",{toolName:j,inputParams:U,requestId:Y,suggestions:Q});const K=M(j,U),H=t.value.get(K);H?(o.value.set(Y,H),y(A,H,{status:"permission_required",permissionRequestId:Y,suggestions:Q}),console.log(`Permission required for tool ${H}`,{suggestions:Q})):console.warn("No tool use ID found for permission request signature:",K,{toolName:j,inputParams:U,availableSignatures:Array.from(t.value.keys())})}function m(A,x){const j=o.value.get(x.request_id);if(j){const U={permissionDecision:x.decision,appliedUpdates:x.applied_updates||[]};x.decision==="allow"?U.status="executing":(U.status="completed",U.result={error:!0,message:x.reasoning||"Permission denied"},U.isExpanded=!1),y(A,j,U),console.log(`Permission ${x.decision} for tool ${j}`)}}function w(A,x){const j=x.tool_use_id;y(A,j,{status:x.is_error?"error":"completed",result:{error:x.is_error,content:x.content},isExpanded:!1}),console.log(`Tool ${j} ${x.is_error?"failed":"completed"}`)}function C(A,x){const j=e.value.get(A);if(j){const U=j.find(Y=>Y.id===x);U&&(U.isExpanded=!U.isExpanded,e.value=new Map(e.value))}}function M(A,x){if(!A)return"unknown:{}";if(!x||typeof x!="object")return`${A}:{}`;const j=JSON.stringify(x,Object.keys(x).sort());return`${A}:${j}`}function N(A,x){const j=x.metadata?.display||x.display;if(!j)return;r.value.has(A)||r.value.set(A,new Map);const U=r.value.get(A);if(j.tool_states)for(const[Y,Q]of Object.entries(j.tool_states)){U.set(Y,Q);const K=e.value.get(A);if(K){const H=K.find(J=>J.id===Y);if(H){const J={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};H.status=J[Q.state]||Q.state,H.backendState=Q}}}if(j.orphaned_tools&&j.orphaned_tools.length>0){const Y=a.value.get(A)||new Map;for(const Q of j.orphaned_tools)Y.has(Q)||Y.set(Q,{reason:"denied",message:"Session was interrupted"});a.value.set(A,Y)}if(j.linked_permissions)for(const[Y,Q]of Object.entries(j.linked_permissions))o.value.set(Y,Q);j.tool_states&&Object.keys(j.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${A}:`,{toolStates:Object.keys(j.tool_states||{}).length,orphanedTools:(j.orphaned_tools||[]).length,linkedPermissions:Object.keys(j.linked_permissions||{}).length})}function I(A,x){return r.value.get(A)?.get(x)}function k(A){const x=r.value.get(A);return x&&x.size>0}function O(A,x,j){const U=a.value.get(A)||new Map;U.set(x,{reason:"denied",message:j}),a.value.set(A,U);const Y=e.value.get(A);if(Y){const Q=Y.find(K=>K.id===x);Q&&Q.isExpanded&&(Q.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${x} as orphaned: ${j}`)}function P(A,x){const j=I(A,x);return j&&j.state==="orphaned"?!0:a.value.get(A)?.has(x)||!1}function z(A,x){const j=I(A,x);return j&&j.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:j}:a.value.get(A)?.get(x)}function G(A,x){const j=i.value.get(A);j&&j.size>0&&(j.forEach(U=>O(A,U,x)),j.clear())}function B(A){n.value.delete(A),e.value.delete(A),n.value=new Map(n.value),e.value=new Map(e.value)}function S(A){return l.value.get(A)}async function T(A){const x=l.value.get(A);if(!x)return console.log(`No sync needed for session ${A} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${A} since ${x}`);const j=await ie.get(`/api/sessions/${A}/messages?limit=1000&offset=0`),U=j.messages||[],Y=j.has_more||!1,Q=W=>W?typeof W=="number"?W*1e3:new Date(W).getTime():0,K=Q(x),H=U.filter(W=>W.timestamp?Q(W.timestamp)>K:!1);if(H.length===0)return console.log(`No missed messages for session ${A}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${H.length} missed messages for session ${A}`);const J=n.value.get(A)||[],fe=new Set(J.map(W=>W.id).filter(Boolean)),q=H.filter(W=>!W.id||!fe.has(W.id));if(console.log(`After deduplication: ${q.length} unique new messages`),q.length>0){const W=q.sort((Ve,Tt)=>{const xt=Q(Ve.timestamp),rt=Q(Tt.timestamp);return xt-rt}),X=n.value.get(A)||[],se=X.length>0?Q(X[X.length-1].timestamp):0,ve=Q(W[0].timestamp),fs=Q(W[W.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:X.length,lastExisting:se,lastExistingDate:X.length>0?X[X.length-1].timestamp:"none",firstNew:ve,firstNewDate:W[0].timestamp,lastNew:fs,lastNewDate:W[W.length-1].timestamp,shouldAppend:ve>se}),ve>se){const Ve=[...X,...W];n.value.set(A,Ve),console.log(`âœ… Appended ${W.length} new messages (no full sort needed)`)}else{const Ve=[...X,...W].sort((Tt,xt)=>{const rt=Q(Tt.timestamp),Ut=Q(xt.timestamp);return rt-Ut});n.value.set(A,Ve),console.log(`âš ï¸ Merged and sorted ${W.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${J.length} messages unchanged`);q.forEach(W=>{$(A,W),W.metadata?.has_tool_uses&&W.metadata.tool_uses&&W.metadata.tool_uses.forEach(X=>{g(A,X)}),W.metadata?.has_tool_results&&W.metadata.tool_results&&W.metadata.tool_results.forEach(X=>{w(A,X)}),(W.type==="permission_request"||W.metadata?.has_permission_requests)&&f(A,W),W.type==="system"&&(W.subtype==="init"||W.metadata?.subtype==="init")&&W.metadata?.init_data&&ae().storeInitData(A,W.metadata.init_data)});const R=n.value.get(A);if(R&&R.length>0){const W=R[R.length-1];W.timestamp&&l.value.set(A,W.timestamp)}return n.value=new Map(n.value),{syncedCount:q.length,hasMore:Y}}catch(j){return console.error(`Failed to sync messages for session ${A}:`,j),{syncedCount:0,hasMore:!1,error:j.message}}}const V=ae();return le(()=>Array.from(V.sessions.values()).map(x=>({id:x.session_id,state:x.state})),(A,x)=>{x&&A.forEach((j,U)=>{const Y=x[U];if(!Y||Y.id!==j.id)return;const Q=["active","paused","starting"].includes(Y.state),K=!["active","paused","starting"].includes(j.state);Q&&K&&G(j.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:hs(i),orphanedToolUses:hs(a),currentMessages:d,currentToolCalls:h,loadMessages:c,addMessage:_,addToolCall:v,updateToolCall:y,handleToolUse:g,handlePermissionRequest:f,handlePermissionResponse:m,handleToolResult:w,toggleToolExpansion:C,clearMessages:B,markToolUseOrphaned:O,isToolUseOrphaned:P,getOrphanedInfo:z,clearOrphanedToolUses:G,getLastReceivedTimestamp:S,syncMessages:T,getBackendToolState:I,hasBackendDisplayMetadata:k,backendToolStates:hs(r)}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:xe},Symbol.toStringTag,{value:"Module"}));function zi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Pt(n){return zi(n).toLocaleTimeString()}const Ki={class:"message-row message-row-user"},Gi=["title"],Yi={class:"message-content-column"},Ji=["innerHTML"],Xi={key:0,class:"tool-results mt-2"},Qi={class:"tool-results-header text-muted small mb-2"},Zi={class:"d-flex align-items-start gap-2"},ea={class:"flex-grow-1"},ta={class:"text-muted"},sa={key:0,class:"text-danger small"},na={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;tt.setOptions({breaks:!0,gfm:!0});const t=b(()=>Pt(e.message.timestamp)),o=b(()=>`user
${t.value}`),i=b(()=>{const d=e.message.content||"";let h=tt.parse(d);return h=h.replace(/\n</g,"<"),h=h.replace(/\n+$/,""),as.sanitize(h)}),a=b(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=b(()=>e.message.metadata?.tool_results||[]);function r(d,h){return d?d.length<=h?d:d.substring(0,h)+"...":""}return(d,h)=>(u(),p("div",Ki,[s("div",{class:"message-speaker",title:o.value},[...h[0]||(h[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,Gi),s("div",Yi,[s("div",{class:"message-text",innerHTML:i.value},null,8,Ji),a.value?(u(),p("div",Xi,[s("div",Qi," ðŸ”§ Tool Results ("+E(l.value.length)+") ",1),(u(!0),p(re,null,ue(l.value,(c,$)=>(u(),p("div",{key:$,class:Z(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",Zi,[s("span",null,E(c.is_error?"âŒ":"âœ…"),1),s("div",ea,[s("small",ta,"Tool: "+E(c.tool_use_id),1),c.is_error?(u(),p("div",sa,E(r(c.content,200)),1)):D("",!0)])])],2))),128))])):D("",!0)])]))}},oa=te(na,[["__scopeId","data-v-7665755b"]]),ia={class:"thinking-block"},aa=["aria-label"],la={class:"text-muted ms-auto"},ra={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ca=["innerHTML"],ua={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=L(!1),o=b(()=>e.thinking?.length||0),i=b(()=>{const l=e.thinking||"",r=tt.parse(l);return as.sanitize(r)});function a(){t.value=!t.value}return(l,r)=>(u(),p("div",ia,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("span",{"aria-label":t.value?"Collapse":"Expand"},E(t.value?"â–¾":"â–¸"),9,aa),r[0]||(r[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",la,E(o.value)+" characters",1)]),t.value?(u(),p("div",ra,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ca)])):D("",!0)]))}},da=te(ua,[["__scopeId","data-v-fda2352c"]]),ze=wt("websocket",()=>{const n=L(null),e=L(!1),t=L(0),o=10,i=L(null),a=L(!1),l=L(0),r=5,d=L(null);let h=null;const c=L(0),$=L(null),_=L(new Map),v=L(null),y=L(!1),g=L(0),f=5,m=L(null),w=1e4,C=1e3,M=L(Date.now()),N=L(Date.now()),I=L(Date.now());let k=null,O=null,P=null;const z=b(()=>e.value&&(a.value||!d.value)?"connected":e.value?"partial":"disconnected");function G(q){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${q}`}function B(q){const R={ui:{timer:()=>k,setTimer:W=>{k=W},lastPing:M,connected:e,name:"UI"},session:{timer:()=>O,setTimer:W=>{O=W},lastPing:N,connected:a,name:"Session"},legion:{timer:()=>P,setTimer:W=>{P=W},lastPing:I,connected:y,name:"Legion"}}[q];R.timer()&&clearInterval(R.timer()),R.setTimer(setInterval(()=>{if(!R.connected.value)return;const W=Date.now()-R.lastPing.value;if(W>w){console.warn(`âš ï¸ ${R.name} WebSocket heartbeat timeout (${W}ms since last ping) - forcing close to trigger reconnection`),R.connected.value=!1;const se={ui:n,session:i,legion:v}[q];se.value&&se.value.readyState===WebSocket.OPEN&&se.value.close()}},C)),console.log(`âœ… Started heartbeat monitor for ${R.name} WebSocket`)}function S(q){const R={ui:{get:()=>k,set:W=>{k=W}},session:{get:()=>O,set:W=>{O=W}},legion:{get:()=>P,set:W=>{P=W}}}[q];R.get()&&(clearInterval(R.get()),R.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${q} WebSocket`))}function T(){if(n.value)return;const q=G("/ws/ui");console.log(`Connecting to UI WebSocket: ${q}`),n.value=new WebSocket(q),n.value.onopen=()=>{e.value=!0,t.value=0,M.value=Date.now(),B("ui"),console.log("UI WebSocket connected")},n.value.onmessage=R=>{const W=JSON.parse(R.data);Q(W)},n.value.onclose=()=>{if(S("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const R=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${R}ms (attempt ${t.value})`),setTimeout(T,R)}},n.value.onerror=R=>{console.error("UI WebSocket error:",R)}}function V(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function A(q){c.value++;const R=c.value;if(console.log(`[Gen ${R}] Starting connection to session ${q}`),h&&(clearTimeout(h),h=null),await x(),c.value!==R){console.log(`[Gen ${R}] Connection cancelled (current generation: ${c.value})`);return}d.value=q,$.value=R;const W=G(`/ws/session/${q}`);console.log(`[Gen ${R}] Connecting to Session WebSocket: ${W}`),i.value=new WebSocket(W),i.value.onopen=async()=>{if($.value!==R){console.log(`[Gen ${R}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}a.value=!0,l.value=0,N.value=Date.now(),B("session"),console.log(`[Gen ${R}] Session WebSocket connected for ${q}`);const X=_.value.get(q);if(_.value.set(q,!0),X){console.log(`[Gen ${R}] Reconnection detected, syncing missed messages...`);try{const ve=await xe().syncMessages(q);ve.syncedCount>0?console.log(`[Gen ${R}] âœ… Synced ${ve.syncedCount} missed messages`):ve.error?console.warn(`[Gen ${R}] âš ï¸ Message sync failed: ${ve.error}`):console.log(`[Gen ${R}] No missed messages to sync`),ve.hasMore&&console.warn(`[Gen ${R}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(se){console.error(`[Gen ${R}] Error during message sync:`,se)}}else console.log(`[Gen ${R}] Initial connection, no sync needed`)},i.value.onmessage=X=>{if($.value!==R){console.log(`[Gen ${R}] Ignoring message (stale connection, current: ${$.value})`);return}const se=JSON.parse(X.data);K(se,q)},i.value.onclose=()=>{S("session"),a.value=!1,i.value=null,console.log(`[Gen ${R}] Session WebSocket closed for ${q}`);const X=ae();if(X.currentSessionId===q&&$.value===R&&l.value<r){l.value++;const se=Math.min(2e3*l.value,3e4);console.log(`[Gen ${R}] Reconnecting Session WebSocket in ${se}ms (attempt ${l.value})`),h=setTimeout(()=>{$.value===R&&X.currentSessionId===q?(h=null,A(q)):console.log(`[Gen ${R}] Skipping reconnect (generation or session changed)`)},se)}},i.value.onerror=X=>{console.error(`[Gen ${R}] Session WebSocket error:`,X)}}function x(){return new Promise(q=>{if(h&&(clearTimeout(h),h=null,console.log("Cancelled pending session reconnect timer")),i.value){const R=d.value,W=()=>{i.value=null,a.value=!1,d.value=null,$.value=null,l.value=0,R&&_.value.delete(R),q()};if(i.value.readyState===WebSocket.CLOSED)W();else{const X=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),W()},2e3);i.value.addEventListener("close",()=>{clearTimeout(X),W()},{once:!0}),i.value.close()}}else d.value=null,$.value=null,q()})}function j(q){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:q})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function U(q,R,W=!1,X=null){if(i.value&&a.value){const se={type:"permission_response",request_id:q,decision:R,apply_suggestions:W,timestamp:new Date().toISOString()};X&&(se.clarification_message=X),i.value.send(JSON.stringify(se)),console.log(`Sent permission ${R} for request ${q}`,{applySuggestions:W,clarification:X})}}function Y(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function Q(q){const R=ae(),W=we();switch(q.type){case"sessions_list":q.sessions&&Array.isArray(q.sessions)&&q.sessions.forEach(X=>{R.updateSession(X.session_id,X)});break;case"state_change":q.data&&q.data.session_id&&q.data.session&&R.updateSession(q.data.session_id,q.data.session);break;case"project_updated":if(q.data&&q.data.project){const X=q.data.project;W.updateProjectLocal(X.project_id,X),R.fetchSessions()}break;case"project_deleted":q.data&&q.data.project_id&&W.projects.delete(q.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":M.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",q.type)}}function K(q,R){const W=ae();if(W.currentSessionId!==R){console.warn(`Ignoring message for session ${R} (current: ${W.currentSessionId})`);return}const X=xe();switch(q.type){case"message":const se=q.data;if(!se||!se.type){console.warn("Received message event with invalid data:",q);break}if(se.type==="permission_request"){X.handlePermissionRequest(R,se);break}if(se.type==="permission_response"){X.handlePermissionResponse(R,se);break}se.metadata?.has_tool_uses&&se.metadata.tool_uses.forEach(ve=>{X.handleToolUse(R,ve)}),se.metadata?.has_tool_results&&se.metadata.tool_results.forEach(ve=>{X.handleToolResult(R,ve)}),se.type==="system"&&(se.subtype==="init"||se.metadata?.subtype==="init")&&se.metadata?.init_data&&W.storeInitData(R,se.metadata.init_data),X.addMessage(R,se);break;case"permission_request":X.handlePermissionRequest(R,q);break;case"permission_response":X.handlePermissionResponse(R,q);break;case"tool_result":X.handleToolResult(R,q);break;case"state_change":W.updateSession(R,q.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${R}`);break;case"ping":N.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function H(q){J(),m.value=q;const R=G(`/ws/legion/${q}`);console.log(`Connecting to Legion WebSocket: ${R}`),v.value=new WebSocket(R),v.value.onopen=()=>{y.value=!0,g.value=0,I.value=Date.now(),B("legion"),console.log(`Legion WebSocket connected for ${q}`)},v.value.onmessage=W=>{const X=JSON.parse(W.data);fe(X,q)},v.value.onclose=()=>{if(S("legion"),y.value=!1,v.value=null,console.log(`Legion WebSocket closed for ${q}`),m.value===q&&g.value<f){g.value++;const W=Math.min(2e3*g.value,3e4);setTimeout(()=>H(q),W)}},v.value.onerror=W=>{console.error("Legion WebSocket error:",W)}}function J(){v.value&&(v.value.close(),v.value=null,y.value=!1,m.value=null)}function fe(q,R){be(async()=>{const{useLegionStore:W}=await Promise.resolve().then(()=>n_);return{useLegionStore:W}},void 0).then(({useLegionStore:W})=>{const X=W();switch(q.type){case"comm":q.comm&&(X.addComm(R,q.comm),console.log("Legion WebSocket: Received new comm",q.comm));break;case"minion_created":q.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",q.data),be(async()=>{const{useSessionStore:se}=await Promise.resolve().then(()=>pn);return{useSessionStore:se}},void 0).then(({useSessionStore:se})=>{se().loadSessions()}));break;case"minion_updated":q.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",q.data),be(async()=>{const{useSessionStore:se}=await Promise.resolve().then(()=>pn);return{useSessionStore:se}},void 0).then(({useSessionStore:se})=>{se().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${R}`);break;case"ping":I.value=Date.now(),v.value?.readyState===WebSocket.OPEN&&v.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",q.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:a,sessionRetryCount:l,legionConnected:y,legionRetryCount:g,overallStatus:z,connectUI:T,disconnectUI:V,connectSession:A,disconnectSession:x,sendMessage:j,sendPermissionResponse:U,interruptSession:Y,connectLegion:H,disconnectLegion:J}}),ma=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ze},Symbol.toStringTag,{value:"Module"})),pa={class:"base-tool-handler"},fa={class:"tool-section"},va={class:"tool-parameters"},ha={class:"tool-code"},_a={key:0,class:"tool-section"},ga={class:"tool-section-label"},ba={class:"tool-code"},ya={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=b(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,r)=>(u(),p("div",pa,[s("div",fa,[r[0]||(r[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",va,[s("pre",ha,E(t.value),1)])]),o.value?(u(),p("div",_a,[s("div",ga,E(i.value?"Error:":"Result:"),1),s("div",{class:Z(["tool-result",{"tool-result-error":i.value}])},[s("pre",ba,E(a.value),1)],2)])):D("",!0)]))}},$a=te(ya,[["__scopeId","data-v-1e69f57d"]]),wa={class:"read-tool-handler"},Ea={class:"tool-section"},Ca={class:"read-file-info"},Sa={class:"file-path"},ka={key:0,class:"read-range"},Ta={key:0,class:"tool-section"},xa={key:0,class:"tool-result tool-result-error"},Aa={class:"tool-code"},Ma={key:1,class:"file-content-preview"},Oa={class:"content-header"},Da={class:"line-count-badge"},Na={key:0,class:"preview-note"},La={class:"tool-code content-display"},Ia={key:0,class:"more-indicator"},gs=100,Pa={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>{const v=e.toolCall.input?.offset,y=e.toolCall.input?.limit;return v!==void 0||y!==void 0}),i=b(()=>{const v=e.toolCall.input?.offset;return v!==void 0?v+1:1}),a=b(()=>{const v=e.toolCall.input?.offset||0,y=e.toolCall.input?.limit;return y!==void 0?v+y:"âˆž"}),l=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=b(()=>{if(!l.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),h=b(()=>r.value||!d.value?[]:d.value.split(`
`)),c=b(()=>h.value.length),$=b(()=>c.value>gs),_=b(()=>r.value?"":h.value.slice(0,gs).join(`
`));return(v,y)=>(u(),p("div",wa,[s("div",Ea,[s("div",Ca,[y[0]||(y[0]=s("span",{class:"file-icon"},"ðŸ“„",-1)),y[1]||(y[1]=s("strong",null,"Reading:",-1)),s("code",Sa,E(t.value),1),o.value?(u(),p("span",ka,"Lines "+E(i.value)+"-"+E(a.value),1)):D("",!0)])]),l.value?(u(),p("div",Ta,[r.value?(u(),p("div",xa,[s("pre",Aa,E(d.value),1)])):(u(),p("div",Ma,[s("div",Oa,[y[2]||(y[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Da,E(c.value)+" lines",1),$.value?(u(),p("span",Na,"(showing first "+E(gs)+")")):D("",!0)]),s("pre",La,E(_.value),1),$.value?(u(),p("div",Ia,"...")):D("",!0)]))])):D("",!0)]))}},ja=te(Pa,[["__scopeId","data-v-1f2b0569"]]),Ra={class:"write-tool-handler"},Ha={class:"tool-section"},Wa={class:"write-file-info mb-2"},Va={class:"file-path"},Fa={class:"write-content-preview"},Ua={class:"content-header"},Ba={class:"line-count-badge"},qa={key:0,class:"preview-note"},za={class:"tool-code content-display"},Ka={key:0,class:"more-indicator"},Ga={key:0,class:"tool-section"},Ya={key:0,class:"tool-result tool-result-error"},Ja={class:"tool-code"},Xa={key:1,class:"tool-result tool-result-success"},Qa={class:"success-message"},bs=100,Za={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>e.toolCall.input?.content||""),i=b(()=>o.value.split(`
`)),a=b(()=>i.value.length),l=b(()=>a.value>bs),r=b(()=>i.value.slice(0,bs).join(`
`)),d=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),h=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=b(()=>{if(!d.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,_)=>(u(),p("div",Ra,[s("div",Ha,[s("div",Wa,[_[0]||(_[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),_[1]||(_[1]=s("strong",null,"Writing:",-1)),s("code",Va,E(t.value),1)]),s("div",Fa,[s("div",Ua,[_[2]||(_[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",Ba,E(a.value)+" lines",1),l.value?(u(),p("span",qa,"(showing first "+E(bs)+")")):D("",!0)]),s("pre",za,E(r.value),1),l.value?(u(),p("div",Ka,"...")):D("",!0)])]),d.value?(u(),p("div",Ga,[h.value?(u(),p("div",Ya,[_[3]||(_[3]=s("strong",null,"Error:",-1)),s("pre",Ja,E(c.value),1)])):(u(),p("div",Xa,[s("div",Qa,[_[4]||(_[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+E(a.value)+" lines written)",1)])]))])):D("",!0)]))}},el=te(Za,[["__scopeId","data-v-ddc24a0f"]]),tl={class:"bash-tool-handler"},sl={class:"tool-section"},nl={class:"bash-header"},ol={class:"bash-header-content"},il={key:0,class:"bash-description"},al={key:1,class:"bash-flags"},ll={class:"bash-command-section"},rl={class:"bash-command-content"},cl={key:0,class:"tool-section"},ul={key:0,class:"bash-output"},dl={key:1,class:"bash-output-empty"},ml={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?.command||""),o=b(()=>e.toolCall.input?.description||""),i=b(()=>e.toolCall.input?.timeout),a=b(()=>e.toolCall.input?.run_in_background||!1),l=b(()=>i.value||a.value),r=b(()=>{const _=[];return i.value&&_.push(`timeout: ${i.value}ms`),a.value&&_.push("background"),_.join(", ")}),d=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),h=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=b(()=>h.value?"tool-result-error":"tool-result-success"),$=b(()=>{if(!d.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,v)=>(u(),p("div",tl,[s("div",sl,[s("div",nl,[v[1]||(v[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",ol,[o.value?(u(),p("div",il,[v[0]||(v[0]=s("strong",null,"Description:",-1)),ne(" "+E(o.value),1)])):D("",!0),l.value?(u(),p("div",al,E(r.value),1)):D("",!0)])]),s("div",ll,[v[2]||(v[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",rl,E(t.value),1)])]),d.value?(u(),p("div",cl,[s("div",{class:Z(["tool-result",c.value])},[v[3]||(v[3]=s("strong",null,"Output:",-1)),$.value?(u(),p("pre",ul,E($.value),1)):(u(),p("div",dl,"No output"))],2)])):D("",!0)]))}},pl=te(ml,[["__scopeId","data-v-ab50fe73"]]),fl={class:"todo-tool-handler"},vl={class:"tool-section"},hl={class:"todo-header"},_l={class:"todo-summary"},gl={key:0,class:"todo-count todo-count-completed"},bl={key:1,class:"todo-count todo-count-in-progress"},yl={key:2,class:"todo-count todo-count-pending"},$l={class:"todo-checklist"},wl={class:"todo-checkbox"},El={class:"todo-content"},Cl={key:0,class:"tool-section"},Sl={key:0,class:"tool-result tool-result-error"},kl={class:"tool-code"},Tl={key:1,class:"tool-result tool-result-success"},xl={class:"success-message"},Al={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?.todos||[]),o=b(()=>t.value.filter(c=>c.status==="completed").length),i=b(()=>t.value.filter(c=>c.status==="in_progress").length),a=b(()=>t.value.filter(c=>c.status==="pending").length);function l(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const r=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=b(()=>{if(!r.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,$)=>(u(),p("div",fl,[s("div",vl,[s("div",hl,[$[0]||($[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=s("strong",null,"Task List:",-1)),s("div",_l,[o.value>0?(u(),p("span",gl,E(o.value)+" completed ",1)):D("",!0),i.value>0?(u(),p("span",bl,E(i.value)+" in progress ",1)):D("",!0),a.value>0?(u(),p("span",yl,E(a.value)+" pending ",1)):D("",!0)])]),s("div",$l,[(u(!0),p(re,null,ue(t.value,(_,v)=>(u(),p("div",{key:v,class:Z(["todo-item",`todo-${_.status}`])},[s("span",wl,E(l(_.status)),1),s("span",El,E(_.content),1)],2))),128))])]),r.value?(u(),p("div",Cl,[d.value?(u(),p("div",Sl,[$[2]||($[2]=s("strong",null,"Error:",-1)),s("pre",kl,E(h.value),1)])):(u(),p("div",Tl,[s("div",xl,[$[3]||($[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+E(t.value.length)+" tasks)",1)])]))])):D("",!0)]))}},Ml=te(Al,[["__scopeId","data-v-bbe55ee7"]]),Ol={class:"edit-tool-handler"},Dl={class:"tool-section"},Nl={class:"edit-file-info"},Ll={class:"file-path"},Il={key:0,class:"replace-all-badge"},Pl={class:"edit-diff-container"},jl={class:"diff-header"},Rl={class:"diff-stats"},Hl={class:"stat-removed"},Wl={class:"stat-added"},Vl={class:"unified-diff"},Fl={class:"diff-scroll-container"},Ul={class:"diff-marker"},Bl={class:"diff-content"},ql={key:0,class:"tool-section"},zl={key:0,class:"tool-result tool-result-error"},Kl={class:"tool-code"},Gl={key:1,class:"tool-result tool-result-success"},Yl={class:"success-message"},Jl={key:0,class:"success-detail"},Xl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>e.toolCall.input?.old_string||""),i=b(()=>e.toolCall.input?.new_string||""),a=b(()=>e.toolCall.input?.replace_all||!1),l=b(()=>{const v=_i(t.value,o.value,i.value,"","",{context:3}).split(`
`),y=[];for(let g=4;g<v.length;g++){const f=v[g];f&&(f.startsWith("-")?y.push({type:"removed",content:f.substring(1)}):f.startsWith("+")?y.push({type:"added",content:f.substring(1)}):f.startsWith(" ")?y.push({type:"context",content:f.substring(1)}):f.startsWith("@@")&&y.push({type:"hunk",content:f}))}return y}),r=b(()=>l.value.filter(_=>_.type==="removed").length),d=b(()=>l.value.filter(_=>_.type==="added").length),h=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=b(()=>{if(!h.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,v)=>(u(),p("div",Ol,[s("div",Dl,[s("div",Nl,[v[0]||(v[0]=s("span",{class:"file-icon"},"âœï¸",-1)),v[1]||(v[1]=s("strong",null,"Editing:",-1)),s("code",Ll,E(t.value),1),a.value?(u(),p("span",Il,"Replace All")):D("",!0)]),s("div",Pl,[s("div",jl,[v[2]||(v[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Rl,[s("span",Hl,"-"+E(r.value),1),s("span",Wl,"+"+E(d.value),1)])]),s("div",Vl,[s("div",Fl,[(u(!0),p(re,null,ue(l.value,(y,g)=>(u(),p("div",{key:g,class:Z(["diff-line",{"diff-line-removed":y.type==="removed","diff-line-added":y.type==="added","diff-line-context":y.type==="context","diff-line-hunk":y.type==="hunk"}])},[s("span",Ul,E(y.type==="removed"?"-":y.type==="added"?"+":y.type==="hunk"?"@":" "),1),s("span",Bl,E(y.content),1)],2))),128))])])])]),h.value?(u(),p("div",ql,[c.value?(u(),p("div",zl,[v[3]||(v[3]=s("strong",null,"Error:",-1)),s("pre",Kl,E($.value),1)])):(u(),p("div",Gl,[s("div",Yl,[v[4]||(v[4]=s("span",{class:"success-icon"},"âœ…",-1)),v[5]||(v[5]=s("strong",null,"File edited successfully",-1)),a.value?(u(),p("span",Jl,"(all occurrences replaced)")):D("",!0)])]))])):D("",!0)]))}},Ql=te(Xl,[["__scopeId","data-v-dd74055e"]]),Zl={class:"search-tool-handler"},er={class:"tool-section"},tr={class:"search-info"},sr={class:"search-icon"},nr={class:"search-pattern"},or={key:0,class:"search-path"},ir={key:1,class:"search-filters"},ar={key:0,class:"filter-badge"},lr={key:1,class:"filter-badge"},rr={key:2,class:"filter-badge"},cr={key:0,class:"tool-section"},ur={key:0,class:"tool-result tool-result-error"},dr={class:"tool-code"},mr={key:1,class:"search-results"},pr={class:"results-header"},fr={class:"results-label"},vr={class:"results-count-badge"},hr={class:"results-content"},_r={class:"tool-code"},gr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.name==="Grep"),o=b(()=>e.toolCall.input?.pattern||"Unknown"),i=b(()=>e.toolCall.input?.path||null),a=b(()=>e.toolCall.input?.type||null),l=b(()=>e.toolCall.input?.glob||null),r=b(()=>e.toolCall.input?.["-i"]||!1),d=b(()=>a.value||l.value||r.value),h=b(()=>t.value?"ðŸ”":"ðŸ“"),c=b(()=>t.value?"Searching content":"Finding files"),$=b(()=>t.value?"Matches":"Files found"),_=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=b(()=>{if(!_.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),g=b(()=>!_.value||v.value||!y.value?0:y.value.split(`
`).filter(m=>m.trim()).length);return(f,m)=>(u(),p("div",Zl,[s("div",er,[s("div",tr,[s("span",sr,E(h.value),1),s("strong",null,E(c.value)+":",1),s("code",nr,E(o.value),1),i.value?(u(),p("span",or,"in "+E(i.value),1)):D("",!0),d.value?(u(),p("span",ir,[a.value?(u(),p("span",ar,"type: "+E(a.value),1)):D("",!0),l.value?(u(),p("span",lr,"glob: "+E(l.value),1)):D("",!0),r.value?(u(),p("span",rr,"case-insensitive")):D("",!0)])):D("",!0)])]),_.value?(u(),p("div",cr,[v.value?(u(),p("div",ur,[m[0]||(m[0]=s("strong",null,"Error:",-1)),s("pre",dr,E(y.value),1)])):(u(),p("div",mr,[s("div",pr,[s("span",fr,E($.value)+":",1),s("span",vr,E(g.value)+" "+E(g.value===1?"match":"matches"),1)]),s("div",hr,[s("pre",_r,E(y.value),1)])]))])):D("",!0)]))}},fn=te(gr,[["__scopeId","data-v-0d272c39"]]),br={class:"web-tool-handler"},yr={class:"tool-section"},$r={class:"web-info"},wr={class:"web-icon"},Er=["href"],Cr={key:1,class:"web-query"},Sr={key:0,class:"web-prompt-container"},kr={class:"prompt-content"},Tr={key:1,class:"web-domains"},xr={class:"domains-label"},Ar={key:0,class:"tool-section"},Mr={key:0,class:"tool-result tool-result-error"},Or={class:"tool-code"},Dr={key:1,class:"web-results"},Nr={class:"results-header"},Lr={class:"results-label"},Ir={class:"results-content"},Pr={class:"tool-code"},jr={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.name==="WebFetch"),o=b(()=>e.toolCall.input?.url||null),i=b(()=>e.toolCall.input?.query||null),a=b(()=>e.toolCall.input?.prompt||null),l=b(()=>e.toolCall.input?.allowed_domains||[]),r=b(()=>e.toolCall.input?.blocked_domains||[]),d=b(()=>l.value.length>0?l.value:r.value.length>0?r.value:[]),h=b(()=>l.value.length>0?"Allowed domains":r.value.length>0?"Blocked domains":"Domains"),c=b(()=>t.value?"ðŸŒ":"ðŸ”Ž"),$=b(()=>t.value?"Fetching URL":"Searching web"),_=b(()=>t.value?"Fetched content":"Search results"),v=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),y=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=b(()=>{if(!v.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)});return(f,m)=>(u(),p("div",br,[s("div",yr,[s("div",$r,[s("span",wr,E(c.value),1),s("strong",null,E($.value)+":",1),o.value?(u(),p("a",{key:0,href:o.value,target:"_blank",class:"web-url"},E(o.value),9,Er)):i.value?(u(),p("code",Cr,E(i.value),1)):D("",!0)]),a.value?(u(),p("div",Sr,[m[0]||(m[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",kr,E(a.value),1)])):D("",!0),d.value.length>0?(u(),p("div",Tr,[s("span",xr,E(h.value)+":",1),(u(!0),p(re,null,ue(d.value,w=>(u(),p("span",{key:w,class:"domain-badge"},E(w),1))),128))])):D("",!0)]),v.value?(u(),p("div",Ar,[y.value?(u(),p("div",Mr,[m[1]||(m[1]=s("strong",null,"Error:",-1)),s("pre",Or,E(g.value),1)])):(u(),p("div",Dr,[s("div",Nr,[s("span",Lr,E(_.value)+":",1)]),s("div",Ir,[s("pre",Pr,E(g.value),1)])]))])):D("",!0)]))}},vn=te(jr,[["__scopeId","data-v-62b55b55"]]),Rr={class:"task-tool-handler"},Hr={class:"tool-section"},Wr={class:"task-header"},Vr={key:0,class:"agent-type-badge"},Fr={key:0,class:"task-description"},Ur={class:"description-content"},Br={key:1,class:"task-prompt-container"},qr={class:"prompt-header"},zr={class:"prompt-length"},Kr={class:"prompt-code"},Gr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Xr={key:1,class:"agent-output"},Qr={class:"output-header"},Zr={key:0,class:"output-count-badge"},ec={class:"output-content"},tc={class:"tool-code"},sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?.description||null),o=b(()=>e.toolCall.input?.prompt||null),i=b(()=>e.toolCall.input?.subagent_type||null),a=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=b(()=>{if(!a.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),d=b(()=>r.value?r.value.split(`
`).length:0);return(h,c)=>(u(),p("div",Rr,[s("div",Hr,[s("div",Wr,[c[0]||(c[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=s("strong",null,"Agent Task:",-1)),i.value?(u(),p("span",Vr,E(i.value),1)):D("",!0)]),t.value?(u(),p("div",Fr,[c[2]||(c[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",Ur,E(t.value),1)])):D("",!0),o.value?(u(),p("div",Br,[s("div",qr,[c[3]||(c[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",zr,E(o.value.length)+" characters",1)]),s("pre",Kr,E(o.value),1)])):D("",!0)]),a.value?(u(),p("div",Gr,[l.value?(u(),p("div",Yr,[c[4]||(c[4]=s("strong",null,"Error:",-1)),s("pre",Jr,E(r.value),1)])):(u(),p("div",Xr,[s("div",Qr,[c[5]||(c[5]=s("span",{class:"output-label"},"Agent Output:",-1)),d.value>0?(u(),p("span",Zr,E(d.value)+" lines",1)):D("",!0)]),s("div",ec,[s("pre",tc,E(r.value),1)])]))])):D("",!0)]))}},nc=te(sc,[["__scopeId","data-v-c520c244"]]),oc={class:"notebook-edit-tool-handler"},ic={class:"tool-section"},ac={class:"notebook-info"},lc={class:"file-path"},rc={class:"cell-info mt-2"},cc={class:"info-row"},uc={class:"info-row"},dc={key:0,class:"info-row"},mc={class:"badge bg-info"},pc={key:0,class:"source-preview mt-3"},fc={class:"preview-header"},vc={class:"preview-stats"},hc={class:"source-code"},_c={key:0,class:"tool-section"},gc={key:0},bc={key:1,class:"text-danger"},yc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?.notebook_path||"Unknown"),o=b(()=>e.toolCall.input?.cell_id),i=b(()=>e.toolCall.input?.cell_type||"code"),a=b(()=>e.toolCall.input?.edit_mode||"replace"),l=b(()=>e.toolCall.input?.new_source||""),r=b(()=>l.value.split(`
`).length),d=b(()=>i.value==="code"?"bg-primary":"bg-secondary"),h=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=b(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=a.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,_)=>(u(),p("div",oc,[s("div",ic,[s("div",ac,[_[0]||(_[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),_[1]||(_[1]=s("strong",null,"Notebook:",-1)),s("code",lc,E(t.value),1)]),s("div",rc,[s("div",cc,[_[2]||(_[2]=s("strong",null,"Cell ID:",-1)),s("code",null,E(o.value||"N/A"),1)]),s("div",uc,[_[3]||(_[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:Z(["badge",d.value])},E(i.value),3)]),a.value?(u(),p("div",dc,[_[4]||(_[4]=s("strong",null,"Edit Mode:",-1)),s("span",mc,E(a.value),1)])):D("",!0)]),l.value?(u(),p("div",pc,[s("div",fc,[_[5]||(_[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",vc,E(r.value)+" lines",1)]),s("pre",hc,[s("code",null,E(l.value),1)])])):D("",!0)]),n.toolCall.result?(u(),p("div",_c,[_[6]||(_[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:Z(["tool-result",h.value])},[n.toolCall.result.success!==!1?(u(),p("div",gc," âœ… "+E(c.value),1)):(u(),p("div",bc," â— "+E(n.toolCall.result.error||"Operation failed"),1))],2)])):D("",!0)]))}},$c=te(yc,[["__scopeId","data-v-c81a9bcf"]]),wc={class:"shell-tool-handler"},Ec={class:"tool-section"},Cc={class:"shell-info"},Sc={class:"shell-icon"},kc={key:0,class:"shell-id"},Tc={key:0,class:"filter-info mt-2"},xc={class:"filter-pattern"},Ac={key:0,class:"tool-section"},Mc={class:"result-header mb-2"},Oc={key:0,class:"mb-2"},Dc={class:"shell-output"},Nc={key:1,class:"mb-2"},Lc={class:"shell-output shell-output-error"},Ic={key:0},Pc={key:1,class:"text-danger"},jc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=b(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=b(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=b(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=b(()=>e.toolCall.input?.filter);function r(v,y){if(!v)return null;const g=new RegExp(`<${y}>([\\s\\S]*?)<\\/${y}>`,"i"),f=v.match(g);return f?f[1].trim():null}const d=b(()=>{const v=e.toolCall.result;if(!v)return null;let y=v;if(v.content&&(y=v.content),typeof y=="string")return{status:r(y,"status"),stdout:r(y,"stdout"),stderr:r(y,"stderr"),exit_code:r(y,"exit_code")};if(Array.isArray(y)){const g=y.find(f=>f.type==="text")?.text||"";return{status:r(g,"status"),stdout:r(g,"stdout"),stderr:r(g,"stderr"),exit_code:r(g,"exit_code")}}return{status:v.status||y.status,stdout:v.stdout||v.output||y.stdout||y.output,stderr:v.stderr||y.stderr,exit_code:v.exit_code||y.exit_code}}),h=b(()=>d.value?.status),c=b(()=>{const v=h.value;return v==="running"?"bg-success":v==="completed"?"bg-secondary":v==="killed"||v==="terminated"?"bg-danger":"bg-info"}),$=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),_=b(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const v=d.value;if(v?.status==="running"&&!v.stdout&&!v.stderr)return"No new output since last check";if(v?.status==="failed")return`Shell failed (exit code ${v.exit_code||"unknown"})`}return"Operation completed"});return(v,y)=>(u(),p("div",wc,[s("div",Ec,[s("div",Cc,[s("span",Sc,E(t.value),1),s("strong",null,E(o.value)+":",1),a.value?(u(),p("code",kc,"Shell "+E(a.value),1)):D("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(u(),p("div",Tc,[y[0]||(y[0]=s("strong",null,"Filter:",-1)),s("code",xc,E(l.value),1)])):D("",!0)]),n.toolCall.result?(u(),p("div",Ac,[s("div",Mc,[s("strong",null,E(i.value)+":",1),h.value?(u(),p("span",{key:0,class:Z(["badge",c.value])},E(h.value),3)):D("",!0)]),d.value?.stdout?(u(),p("div",Oc,[y[1]||(y[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Dc,[s("pre",null,[s("code",null,E(d.value.stdout),1)])])])):D("",!0),d.value?.stderr?(u(),p("div",Nc,[y[2]||(y[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",Lc,[s("pre",null,[s("code",null,E(d.value.stderr),1)])])])):D("",!0),!d.value?.stdout&&!d.value?.stderr?(u(),p("div",{key:2,class:Z(["tool-result",$.value])},[n.toolCall.result.success!==!1?(u(),p("div",Ic," âœ… "+E(_.value),1)):(u(),p("div",Pc," â— "+E(n.toolCall.result.error||"Operation failed"),1))],2)):D("",!0)])):D("",!0)]))}},hn=te(jc,[["__scopeId","data-v-86def281"]]),Rc={class:"skill-tool-handler"},Hc={key:0,class:"tool-section"},Wc={class:"d-flex align-items-center gap-2"},Vc={class:"text-muted small"},Fc={key:0,class:"skill-content-body"},Uc={class:"skill-content-text"},Bc={key:1,class:"tool-section mt-3"},qc={class:"tool-result tool-result-error"},zc={class:"tool-code"},Kc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=ae(),i=L(!1);function a(){i.value=!i.value}const l=b(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const v=t.messagesBySession.get(_)||[],y=v.findIndex(m=>m.type==="user"&&m.metadata?.has_tool_results&&m.metadata?.tool_results?.some(w=>w.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let g=null,f=null;for(let m=y+1;m<Math.min(y+3,v.length);m++){const w=v[m];if(w.type!=="user")continue;const C=w.content||"";C.includes("<command-message>")&&C.includes("skill is running")?g=w:C.startsWith("Base directory for this skill:")&&(f=w)}return{running:g,content:f}}),r=b(()=>{const _=l.value.content;if(!_)return"";const v=_.content||"",y=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return v.replace(y,"").trim()}),d=b(()=>r.value.length>0),h=b(()=>r.value?r.value.split(`
`).length:0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=b(()=>{if(!c.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,v)=>(u(),p("div",Rc,[d.value?(u(),p("div",Hc,[s("div",{class:"skill-content-header",onClick:a},[s("div",Wc,[s("i",{class:Z(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),v[0]||(v[0]=s("strong",null,"Skill Content",-1)),s("span",Vc,"("+E(h.value)+" lines)",1)])]),i.value?(u(),p("div",Fc,[s("pre",Uc,E(r.value),1)])):D("",!0)])):D("",!0),c.value?(u(),p("div",Bc,[v[1]||(v[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",qc,[s("pre",zc,E($.value),1)])])):D("",!0)]))}},Gc=te(Kc,[["__scopeId","data-v-0a48ca0f"]]),Yc={class:"slashcommand-tool-handler"},Jc={key:0,class:"tool-section"},Xc={class:"d-flex align-items-center gap-2"},Qc=["aria-label"],Zc={class:"text-muted small"},eu={key:0,class:"command-content-body"},tu={class:"command-content-text"},su={key:1,class:"tool-section mt-3"},nu={class:"tool-result tool-result-error"},ou={class:"tool-code"},iu={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=ae(),i=L(!1);function a(){i.value=!i.value}const l=b(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const v=t.messagesBySession.get(_)||[],y=v.findIndex(m=>m.type==="user"&&m.metadata?.has_tool_results&&m.metadata?.tool_results?.some(w=>w.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let g=null,f=null;for(let m=y+1;m<Math.min(y+3,v.length);m++){const w=v[m];if(w.type!=="user")continue;const C=w.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?g=w:C.includes("ARGUMENTS:")&&(f=w)}return{running:g,content:f}}),r=b(()=>{const _=l.value.content;if(!_)return"";const v=_.content||"",y=/\nARGUMENTS:.*$/s;return v.replace(y,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),d=b(()=>r.value.length>0),h=b(()=>r.value?r.value.split(`
`).length:0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=b(()=>{if(!c.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,v)=>(u(),p("div",Yc,[d.value?(u(),p("div",Jc,[s("div",{class:"command-content-header",onClick:a},[s("div",Xc,[s("span",{"aria-label":i.value?"Collapse":"Expand"},E(i.value?"â–¾":"â–¸"),9,Qc),v[0]||(v[0]=s("strong",null,"Command Content",-1)),s("span",Zc,"("+E(h.value)+" lines)",1)])]),i.value?(u(),p("div",eu,[s("pre",tu,E(r.value),1)])):D("",!0)])):D("",!0),c.value?(u(),p("div",su,[v[1]||(v[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",nu,[s("pre",ou,E($.value),1)])])):D("",!0)]))}},au=te(iu,[["__scopeId","data-v-15991acf"]]),lu={class:"exit-plan-mode-tool-handler"},ru={class:"tool-section"},cu={key:0,class:"plan-content mt-2"},uu={class:"plan-text"},du={key:0,class:"tool-section"},mu={key:0},pu={key:1,class:"text-danger"},fu={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>e.toolCall.input?.plan),o=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),p("div",lu,[s("div",ru,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(u(),p("div",cu,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",uu,E(t.value),1)])):D("",!0)]),n.toolCall.result?(u(),p("div",du,[a[2]||(a[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:Z(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),p("div",mu," âœ… Permission mode reverted to default ")):(u(),p("div",pu," â— "+E(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):D("",!0)]))}},vu=te(fu,[["__scopeId","data-v-e2e3c781"]]),hu={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},_u={class:"tool-status-icon"},gu=["title"],bu={class:"d-flex align-items-center gap-2"},yu={class:"text-muted"},$u=["aria-label"],wu={key:0,class:"card-body"},Eu={key:0,class:"alert alert-warning mb-3"},Cu={class:"d-flex align-items-center"},Su={class:"mb-0 small"},ku={key:1,class:"permission-prompt mt-3"},Tu={class:"alert alert-warning mb-3"},xu={class:"mb-0"},Au={class:"tool-name"},Mu={key:0,class:"suggestions-section mb-3"},Ou={class:"alert alert-info mb-0"},Du={class:"suggestion-details p-2 bg-white rounded"},Nu={class:"permission-buttons d-flex gap-2 mb-3"},Lu=["disabled"],Iu=["disabled"],Pu=["disabled"],ju={class:"guidance-section mt-3"},Ru=["disabled"],Hu=["disabled"],Wu={key:2,class:"mt-3"},Vu={class:"alert alert-warning mb-0"},Fu={class:"d-flex align-items-center"},Uu={class:"mb-0 small"},Bu={key:3,class:"tool-section"},qu={class:"alert alert-danger mb-0"},zu={key:0},Ku={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=ae(),i=ze(),a=L(!1),l=L(null),r=L(""),d=b(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),h=b(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c=b(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),$=b(()=>{if(c.value){const S=c.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[S]||S}return e.toolCall.status}),_={Read:ja,Write:el,Bash:pl,TodoWrite:Ml,Edit:Ql,Grep:fn,Glob:fn,WebFetch:vn,WebSearch:vn,Task:nc,NotebookEdit:$c,BashOutput:hn,KillShell:hn,SlashCommand:au,Skill:Gc,ExitPlanMode:vu},v=b(()=>{const S=e.toolCall.name;return _[S]?_[S]:$a}),y=b(()=>{const S=[];if(d.value)return S.push("border-warning"),S.join(" ");switch($.value){case"pending":S.push("border-secondary");break;case"permission_required":S.push("border-warning");break;case"executing":S.push("border-primary");break;case"completed":m.value||e.toolCall.permissionDecision==="deny"?S.push("border-danger"):S.push("border-success");break;case"error":S.push("border-danger");break}return S.join(" ")}),g=b(()=>{if(d.value)return"â¹ï¸";switch($.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":m.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),f=b(()=>Pt(e.toolCall.timestamp)),m=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=b(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function C(S){if(!S)return"";const T=S.replace(/\\/g,"/").split("/");return T[T.length-1]}function M(S){if(!S)return"";const T=S.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return T?T[1]:S}function N(S,T=200){return S?S.length<=T?S:S.substring(0,T)+"...":""}function I(S){if(!S)return null;if(S.content){const T=S.content.match(/exit code (\d+)/i);if(T)return parseInt(T[1])}return S.error?1:0}function k(S,T){const V=S?S.split(`
`).length:0;return{added:T?T.split(`
`).length:0,removed:V}}const O=b(()=>{const S=e.toolCall.name,T=e.toolCall.input||{},V=e.toolCall.result,A=$.value;switch(S){case"Bash":case"Shell":case"Command":{const x=M(T.command),j=N(x,200);if(A==="completed"&&V){const U=I(V);return`Bash: ${j} (exit ${U})`}return`Bash: ${j}`}case"SlashCommand":{const x=N(T.command,200);return A==="completed"&&V?`SlashCommand: ${x}`:`SlashCommand: ${x}`}case"Edit":{const x=C(T.file_path);if(A==="completed"&&V&&!V.error){const{added:j,removed:U}=k(T.old_string,T.new_string);return j===U?`Edit: ${x} (${j} lines changed)`:`Edit: ${x} (${j} lines added, ${U} removed)`}return`Edit: ${x}`}case"Read":{const x=C(T.file_path);if(T.offset!==void 0||T.limit!==void 0){const U=(T.offset||0)+1,Y=T.limit?(T.offset||0)+T.limit:"âˆž";return`Read: ${x} (lines ${U}-${Y})`}return`Read: ${x} (full file)`}case"Write":{const x=C(T.file_path);if(A==="completed"&&V&&!V.error&&T.content){const j=T.content.split(`
`).length;return`Write: ${x} (${j} lines written)`}return`Write: ${x}`}case"Skill":{const x=T.skill||"Unknown";return A==="completed"&&V?V.error?`Skill: ${x} (error)`:`Skill: ${x} (completed)`:`Skill: ${x}`}case"Task":{const x=T.subagent_type||"general",j=T.description||"Task";return A==="completed"&&V?V.error?`Task: (${x}) ${j} (error)`:`Task: (${x}) ${j} (completed)`:`Task: (${x}) ${j}`}case"TodoWrite":{if(T.todos&&Array.isArray(T.todos)){const x=T.todos.filter(Y=>Y.status==="completed").length,j=T.todos.length,U=T.todos.find(Y=>Y.status==="in_progress");return U?`Todo: Working on "${U.content}"`:`Todo: ${x}/${j} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const x=T.pattern||"",j=S==="Grep"?"Grep":"Glob";if(A==="completed"&&V&&!V.error){let U=0;return V.content&&(U=V.content.split(`
`).filter(Q=>Q.trim()).length),`${j}: "${x}" (${U} results)`}return`${j}: "${x}"`}case"WebFetch":case"WebSearch":{const x=T.url||T.query||"";if(S==="WebSearch"){const U=T.query||"",Y=U.length>50?U.substring(0,50)+"...":U;return A==="completed"&&V?V.error?`Web: ${Y} (error)`:`Web: ${Y} (success)`:`Web: ${Y}`}let j="";try{x&&(j=new URL(x.startsWith("http")?x:`https://${x}`).hostname)}catch{j=x.length>50?x.substring(0,50)+"...":x}return A==="completed"&&V?V.error?`Web: ${j} (error)`:`Web: ${j} (success)`:`Web: ${j||x}`}case"NotebookEdit":{const x=C(T.notebook_path),j=T.cell_number!==void 0?T.cell_number:"?",U=T.edit_mode||"replace";return`NotebookEdit: ${x} cell #${j} (${U})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${T.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${T.shell_id||"unknown"}`;default:return`${S}: executed`}}),P=b(()=>{const S=e.toolCall.name,T=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(S)?T.command||S:["Edit","Read","Write","NotebookEdit"].includes(S)&&(T.file_path||T.notebook_path)||S});function z(){const S=o.currentSessionId;S&&t.toggleToolExpansion(S,e.toolCall.id)}function G(S){return S.type==="setMode"?`Set permission mode to "${S.mode}"`:S.type==="allow"?`Allow tool: ${S.tool}`:JSON.stringify(S)}async function B(S,T,V=null){if(!a.value){a.value=!0,S==="allow"?l.value=T?"approve-apply":"approve":V?l.value="deny-guidance":l.value="deny";try{const A=o.currentSessionId;if(A){const x=T&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(A,{request_id:e.toolCall.permissionRequestId,decision:S,reasoning:S==="allow"?"User allowed permission":"User denied permission",applied_updates:x})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,S,T,V)}catch(A){console.error("Failed to send permission response:",A)}finally{a.value=!1,l.value=null}}}return(S,T)=>(u(),p("div",{class:Z(["tool-call-card card",y.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:z},[s("div",hu,[s("span",_u,E(g.value),1),s("span",{class:"tool-name",title:P.value},E(O.value),9,gu)]),s("div",bu,[s("small",yu,E(f.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},E(n.toolCall.isExpanded?"â–¾":"â–¸"),9,$u)])]),n.toolCall.isExpanded?(u(),p("div",wu,[d.value?(u(),p("div",Eu,[s("div",Cu,[T[6]||(T[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[T[5]||(T[5]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Su,E(h.value?.message||"Session was terminated"),1)])])])):D("",!0),(u(),ge(to(v.value),{toolCall:n.toolCall},null,8,["toolCall"])),$.value==="permission_required"&&!d.value?(u(),p("div",ku,[s("div",Tu,[T[9]||(T[9]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",xu,[T[7]||(T[7]=ne("Claude wants to use the ",-1)),s("code",Au,E(n.toolCall.name),1),T[8]||(T[8]=ne(" tool.",-1))])]),w.value?(u(),p("div",Mu,[s("div",Ou,[T[10]||(T[10]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),T[11]||(T[11]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Du,[(u(!0),p(re,null,ue(n.toolCall.suggestions,(V,A)=>(u(),p("div",{key:A,class:"suggestion-item"},[s("code",null,E(G(V)),1)]))),128))]),T[12]||(T[12]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):D("",!0),s("div",Nu,[w.value?(u(),p("button",{key:0,class:"btn btn-success",onClick:T[0]||(T[0]=V=>B("allow",!0)),disabled:a.value},E(a.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Lu)):D("",!0),s("button",{class:Z(["btn",w.value?"btn-outline-success":"btn-success"]),onClick:T[1]||(T[1]=V=>B("allow",!1)),disabled:a.value},E(a.value&&l.value==="approve"?"â³ Submitting...":w.value?"âœ… Approve Only":"âœ… Approve"),11,Iu),s("button",{class:"btn btn-danger",onClick:T[2]||(T[2]=V=>B("deny",!1)),disabled:a.value}," ðŸš« "+E(a.value&&l.value==="deny"?"Submitting...":"Deny"),9,Pu)]),s("div",ju,[T[13]||(T[13]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),T[14]||(T[14]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),oe(s("textarea",{"onUpdate:modelValue":T[3]||(T[3]=V=>r.value=V),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Ru),[[de,r.value]]),r.value.trim()?(u(),p("button",{key:0,class:"btn btn-warning btn-sm",onClick:T[4]||(T[4]=V=>B("deny",!1,r.value)),disabled:a.value},E(a.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Hu)):D("",!0)])])):D("",!0),$.value==="permission_required"&&d.value?(u(),p("div",Wu,[s("div",Vu,[s("div",Fu,[T[16]||(T[16]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[T[15]||(T[15]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Uu,E(h.value?.message||"Session was terminated before permission could be granted"),1)])])])])):D("",!0),n.toolCall.permissionDecision==="deny"?(u(),p("div",Bu,[s("div",qu,[T[17]||(T[17]=ne(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(u(),p("span",zu," - "+E(n.toolCall.result.message),1)):D("",!0)])])):D("",!0)])):D("",!0)],2))}},_n=te(Ku,[["__scopeId","data-v-e339198b"]]),Gu={class:"tool-footer-container"},Yu=["aria-label","onKeydown"],Ju={class:"footer-left"},Xu={class:"footer-text"},Qu={class:"footer-middle"},Zu={class:"footer-text"},ed={class:"footer-right"},td={class:"expand-icon"},sd={key:0,class:"tool-footer-expanded"},nd={key:1,class:"active-tools-area"},od={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=xe(),o=ae(),i=L(!1);function a(v){return v.map((y,g)=>({tool:y,originalIndex:g})).sort((y,g)=>{if(y.tool.timestamp&&g.tool.timestamp){const f=new Date(y.tool.timestamp).getTime(),m=new Date(g.tool.timestamp).getTime();if(f!==m)return f-m}return y.originalIndex-g.originalIndex}).map(({tool:y})=>y)}const l=b(()=>{const v=e.tools.filter(y=>y.status==="executing"||y.status==="permission_required");return a(v)}),r=b(()=>{const v=e.tools.filter(y=>y.status!=="executing"&&y.status!=="permission_required");return a(v)}),d=b(()=>{const v=new Map;e.tools.forEach(w=>{const C=v.get(w.name)||0;v.set(w.name,C+1)});const y=Array.from(v.entries()).sort((w,C)=>C[1]-w[1]),g=y.slice(0,5),f=y.length-g.length,m=g.map(([w,C])=>`${w} (${C})`).join(", ");return f>0?`${m}, +${f} more`:m}),h=b(()=>{const v=e.tools.length;let y=0,g=0,f=0;e.tools.forEach(M=>{const N=o.currentSessionId;(N?t.isToolUseOrphaned(N,M.id):!1)?f++:M.status==="completed"&&!M.result?.error&&M.permissionDecision!=="deny"?y++:(M.status==="error"||M.result?.error||M.permissionDecision==="deny")&&g++});let m=[];y>0&&m.push(`${y} âœ…`),g>0&&m.push(`${g} âŒ`),f>0&&m.push(`${f} â¹ï¸`);const w=v===1?"tool":"tools",C=m.length>0?": "+m.join(" "):"";return`${v} ${w}${C}`}),c=b(()=>i.value?"â–²":"â–¼"),$=b(()=>{const v=o.currentSessionId,y=e.tools.some(w=>w.status==="error"||w.result?.error||w.permissionDecision==="deny"),g=e.tools.some(w=>v?t.isToolUseOrphaned(v,w.id):!1),f=l.value.length>0,m=e.tools.every(w=>!(v?t.isToolUseOrphaned(v,w.id):!1)&&w.status==="completed"&&!w.result?.error&&w.permissionDecision!=="deny");return y?"footer-status-error":g?"footer-status-orphaned":f?"footer-status-in-progress":m?"footer-status-success":""});function _(){i.value=!i.value}return(v,y)=>(u(),p("div",Gu,[s("div",{class:Z(["tool-footer-summary",$.value]),onClick:_,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Nt(_,["enter"]),Nt(_e(_,["prevent"]),["space"])]},[s("div",Ju,[s("span",Xu,"Used: "+E(d.value),1)]),s("div",Qu,[y[0]||(y[0]=s("span",{class:"footer-separator"},"|",-1)),s("span",Zu,E(h.value),1)]),s("div",ed,[s("span",td,E(c.value),1)])],42,Yu),i.value?(u(),p("div",sd,[(u(!0),p(re,null,ue(r.value,g=>(u(),ge(_n,{key:g.id,toolCall:g},null,8,["toolCall"]))),128))])):D("",!0),l.value.length>0?(u(),p("div",nd,[(u(!0),p(re,null,ue(l.value,g=>(u(),ge(_n,{key:g.id,toolCall:g},null,8,["toolCall"]))),128))])):D("",!0)]))}},id=te(od,[["__scopeId","data-v-7bae7ae1"]]),ad={class:"message-row message-row-assistant"},ld=["title"],rd={class:"message-content-column"},cd={key:0,class:"thinking-block mb-2"},ud=["innerHTML"],dd={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=xe(),o=ae();tt.setOptions({breaks:!0,gfm:!0});const i=b(()=>Pt(e.message.timestamp)),a=b(()=>e.message.metadata?.model||null),l=b(()=>{const y=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${y}`}),r=b(()=>{const y=e.message.content||"";return y.trim().length>0&&y!=="Assistant response"}),d=b(()=>{const y=e.message.content||"";let g=tt.parse(y);return g=g.replace(/\n</g,"<"),g=g.replace(/\n+$/,""),as.sanitize(g)}),h=b(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=b(()=>e.message.metadata?.thinking_content||""),$=b(()=>{const y=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,g=e.attachedTools&&e.attachedTools.length>0;return y||g}),_=b(()=>{const y=e.message.metadata?.tool_uses||[],g=e.attachedTools||[],f=[...y],m=new Set(y.map(w=>w.id));for(const w of g)m.has(w.id)||f.push(w);return f}),v=b(()=>{const y=o.currentSessionId;if(!y)return[];const g=t.toolCallsBySession.get(y)||[];return _.value.map(f=>{const m=g.find(w=>w.id===f.id);return m||{id:f.id,name:f.name,input:f.input,status:"pending",result:null,timestamp:f.timestamp||e.message.timestamp,isExpanded:!0}})});return(y,g)=>(u(),p("div",ad,[s("div",{class:"message-speaker",title:l.value},[...g[0]||(g[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,ld),s("div",rd,[h.value?(u(),p("div",cd,[ce(da,{thinking:c.value},null,8,["thinking"])])):D("",!0),r.value?(u(),p("div",{key:1,class:"message-text",innerHTML:d.value},null,8,ud)):D("",!0),$.value?(u(),ge(id,{key:2,tools:v.value},null,8,["tools"])):D("",!0)])]))}},md=te(dd,[["__scopeId","data-v-2e32f6ef"]]),pd={key:0,class:"message-row message-row-compaction"},fd=["title"],vd={class:"message-content-column"},hd={class:"compaction-status-content"},_d={class:"text-muted ms-auto"},gd={key:1,class:"message-row message-row-system"},bd=["title"],yd={class:"message-content-column"},$d={class:"system-text"},wd={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=b(()=>Pt(e.message.timestamp)),o=b(()=>`system
${t.value}`),i=b(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,l)=>i.value?(u(),p("div",pd,[s("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,fd),s("div",vd,[s("div",hd,[l[1]||(l[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",_d,E(t.value),1)])])])):(u(),p("div",gd,[s("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,bd),s("div",yd,[s("span",$d,E(n.message.content),1)])]))}},gn=te(wd,[["__scopeId","data-v-a078178f"]]),Ed={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=b(()=>{switch(e.message.type){case"user":return oa;case"assistant":return md;case"system":return gn;default:return gn}});return(o,i)=>(u(),ge(to(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Cd=te(Ed,[["__scopeId","data-v-11dff525"]]);var ye="top",Ce="bottom",Se="right",$e="left",ls="auto",Et=[ye,Ce,Se,$e],st="start",vt="end",no="clippingParents",Bs="viewport",dt="popper",oo="reference",js=Et.reduce(function(n,e){return n.concat([e+"-"+st,e+"-"+vt])},[]),qs=[].concat(Et,[ls]).reduce(function(n,e){return n.concat([e,e+"-"+st,e+"-"+vt])},[]),io="beforeRead",ao="read",lo="afterRead",ro="beforeMain",co="main",uo="afterMain",mo="beforeWrite",po="write",fo="afterWrite",vo=[io,ao,lo,ro,co,uo,mo,po,fo];function Ie(n){return n?(n.nodeName||"").toLowerCase():null}function ke(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nt(n){var e=ke(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=ke(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function zs(n){if(typeof ShadowRoot>"u")return!1;var e=ke(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Sd(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Te(a)||!Ie(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(l){var r=i[l];r===!1?a.removeAttribute(l):a.setAttribute(l,r===!0?"":r)}))})}function kd(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),r=l.reduce(function(d,h){return d[h]="",d},{});!Te(i)||!Ie(i)||(Object.assign(i.style,r),Object.keys(a).forEach(function(d){i.removeAttribute(d)}))})}}const ho={name:"applyStyles",enabled:!0,phase:"write",fn:Sd,effect:kd,requires:["computeStyles"]};function Ne(n){return n.split("-")[0]}var et=Math.max,ss=Math.min,ht=Math.round;function Rs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function _o(){return!/^((?!chrome|android).)*safari/i.test(Rs())}function _t(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&ht(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&ht(o.height)/n.offsetHeight||1);var l=nt(n)?ke(n):window,r=l.visualViewport,d=!_o()&&t,h=(o.left+(d&&r?r.offsetLeft:0))/i,c=(o.top+(d&&r?r.offsetTop:0))/a,$=o.width/i,_=o.height/a;return{width:$,height:_,top:c,right:h+$,bottom:c+_,left:h,x:h,y:c}}function Ks(n){var e=_t(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function go(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&zs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function He(n){return ke(n).getComputedStyle(n)}function Td(n){return["table","td","th"].indexOf(Ie(n))>=0}function Ke(n){return((nt(n)?n.ownerDocument:n.document)||window.document).documentElement}function rs(n){return Ie(n)==="html"?n:n.assignedSlot||n.parentNode||(zs(n)?n.host:null)||Ke(n)}function bn(n){return!Te(n)||He(n).position==="fixed"?null:n.offsetParent}function xd(n){var e=/firefox/i.test(Rs()),t=/Trident/i.test(Rs());if(t&&Te(n)){var o=He(n);if(o.position==="fixed")return null}var i=rs(n);for(zs(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Ie(i))<0;){var a=He(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function jt(n){for(var e=ke(n),t=bn(n);t&&Td(t)&&He(t).position==="static";)t=bn(t);return t&&(Ie(t)==="html"||Ie(t)==="body"&&He(t).position==="static")?e:t||xd(n)||e}function Gs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Ot(n,e,t){return et(n,ss(e,t))}function Ad(n,e,t){var o=Ot(n,e,t);return o>t?t:o}function bo(){return{top:0,right:0,bottom:0,left:0}}function yo(n){return Object.assign({},bo(),n)}function $o(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Md=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,yo(typeof e!="number"?e:$o(e,Et))};function Od(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,l=t.modifiersData.popperOffsets,r=Ne(t.placement),d=Gs(r),h=[$e,Se].indexOf(r)>=0,c=h?"height":"width";if(!(!a||!l)){var $=Md(i.padding,t),_=Ks(a),v=d==="y"?ye:$e,y=d==="y"?Ce:Se,g=t.rects.reference[c]+t.rects.reference[d]-l[d]-t.rects.popper[c],f=l[d]-t.rects.reference[d],m=jt(a),w=m?d==="y"?m.clientHeight||0:m.clientWidth||0:0,C=g/2-f/2,M=$[v],N=w-_[c]-$[y],I=w/2-_[c]/2+C,k=Ot(M,I,N),O=d;t.modifiersData[o]=(e={},e[O]=k,e.centerOffset=k-I,e)}}function Dd(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||go(e.elements.popper,i)&&(e.elements.arrow=i))}const wo={name:"arrow",enabled:!0,phase:"main",fn:Od,effect:Dd,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function gt(n){return n.split("-")[1]}var Nd={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ld(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:ht(t*i)/i||0,y:ht(o*i)/i||0}}function yn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,l=n.offsets,r=n.position,d=n.gpuAcceleration,h=n.adaptive,c=n.roundOffsets,$=n.isFixed,_=l.x,v=_===void 0?0:_,y=l.y,g=y===void 0?0:y,f=typeof c=="function"?c({x:v,y:g}):{x:v,y:g};v=f.x,g=f.y;var m=l.hasOwnProperty("x"),w=l.hasOwnProperty("y"),C=$e,M=ye,N=window;if(h){var I=jt(t),k="clientHeight",O="clientWidth";if(I===ke(t)&&(I=Ke(t),He(I).position!=="static"&&r==="absolute"&&(k="scrollHeight",O="scrollWidth")),I=I,i===ye||(i===$e||i===Se)&&a===vt){M=Ce;var P=$&&I===N&&N.visualViewport?N.visualViewport.height:I[k];g-=P-o.height,g*=d?1:-1}if(i===$e||(i===ye||i===Ce)&&a===vt){C=Se;var z=$&&I===N&&N.visualViewport?N.visualViewport.width:I[O];v-=z-o.width,v*=d?1:-1}}var G=Object.assign({position:r},h&&Nd),B=c===!0?Ld({x:v,y:g},ke(t)):{x:v,y:g};if(v=B.x,g=B.y,d){var S;return Object.assign({},G,(S={},S[M]=w?"0":"",S[C]=m?"0":"",S.transform=(N.devicePixelRatio||1)<=1?"translate("+v+"px, "+g+"px)":"translate3d("+v+"px, "+g+"px, 0)",S))}return Object.assign({},G,(e={},e[M]=w?g+"px":"",e[C]=m?v+"px":"",e.transform="",e))}function Id(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,l=a===void 0?!0:a,r=t.roundOffsets,d=r===void 0?!0:r,h={placement:Ne(e.placement),variation:gt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,yn(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,yn(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Eo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Id,data:{}};var qt={passive:!0};function Pd(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,l=o.resize,r=l===void 0?!0:l,d=ke(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&h.forEach(function(c){c.addEventListener("scroll",t.update,qt)}),r&&d.addEventListener("resize",t.update,qt),function(){a&&h.forEach(function(c){c.removeEventListener("scroll",t.update,qt)}),r&&d.removeEventListener("resize",t.update,qt)}}const Co={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Pd,data:{}};var jd={left:"right",right:"left",bottom:"top",top:"bottom"};function Qt(n){return n.replace(/left|right|bottom|top/g,function(e){return jd[e]})}var Rd={start:"end",end:"start"};function $n(n){return n.replace(/start|end/g,function(e){return Rd[e]})}function Ys(n){var e=ke(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Js(n){return _t(Ke(n)).left+Ys(n).scrollLeft}function Hd(n,e){var t=ke(n),o=Ke(n),i=t.visualViewport,a=o.clientWidth,l=o.clientHeight,r=0,d=0;if(i){a=i.width,l=i.height;var h=_o();(h||!h&&e==="fixed")&&(r=i.offsetLeft,d=i.offsetTop)}return{width:a,height:l,x:r+Js(n),y:d}}function Wd(n){var e,t=Ke(n),o=Ys(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=et(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=et(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),r=-o.scrollLeft+Js(n),d=-o.scrollTop;return He(i||t).direction==="rtl"&&(r+=et(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:r,y:d}}function Xs(n){var e=He(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function So(n){return["html","body","#document"].indexOf(Ie(n))>=0?n.ownerDocument.body:Te(n)&&Xs(n)?n:So(rs(n))}function Dt(n,e){var t;e===void 0&&(e=[]);var o=So(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=ke(o),l=i?[a].concat(a.visualViewport||[],Xs(o)?o:[]):o,r=e.concat(l);return i?r:r.concat(Dt(rs(l)))}function Hs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Vd(n,e){var t=_t(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function wn(n,e,t){return e===Bs?Hs(Hd(n,t)):nt(e)?Vd(e,t):Hs(Wd(Ke(n)))}function Fd(n){var e=Dt(rs(n)),t=["absolute","fixed"].indexOf(He(n).position)>=0,o=t&&Te(n)?jt(n):n;return nt(o)?e.filter(function(i){return nt(i)&&go(i,o)&&Ie(i)!=="body"}):[]}function Ud(n,e,t,o){var i=e==="clippingParents"?Fd(n):[].concat(e),a=[].concat(i,[t]),l=a[0],r=a.reduce(function(d,h){var c=wn(n,h,o);return d.top=et(c.top,d.top),d.right=ss(c.right,d.right),d.bottom=ss(c.bottom,d.bottom),d.left=et(c.left,d.left),d},wn(n,l,o));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function ko(n){var e=n.reference,t=n.element,o=n.placement,i=o?Ne(o):null,a=o?gt(o):null,l=e.x+e.width/2-t.width/2,r=e.y+e.height/2-t.height/2,d;switch(i){case ye:d={x:l,y:e.y-t.height};break;case Ce:d={x:l,y:e.y+e.height};break;case Se:d={x:e.x+e.width,y:r};break;case $e:d={x:e.x-t.width,y:r};break;default:d={x:e.x,y:e.y}}var h=i?Gs(i):null;if(h!=null){var c=h==="y"?"height":"width";switch(a){case st:d[h]=d[h]-(e[c]/2-t[c]/2);break;case vt:d[h]=d[h]+(e[c]/2-t[c]/2);break}}return d}function bt(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,l=a===void 0?n.strategy:a,r=t.boundary,d=r===void 0?no:r,h=t.rootBoundary,c=h===void 0?Bs:h,$=t.elementContext,_=$===void 0?dt:$,v=t.altBoundary,y=v===void 0?!1:v,g=t.padding,f=g===void 0?0:g,m=yo(typeof f!="number"?f:$o(f,Et)),w=_===dt?oo:dt,C=n.rects.popper,M=n.elements[y?w:_],N=Ud(nt(M)?M:M.contextElement||Ke(n.elements.popper),d,c,l),I=_t(n.elements.reference),k=ko({reference:I,element:C,placement:i}),O=Hs(Object.assign({},C,k)),P=_===dt?O:I,z={top:N.top-P.top+m.top,bottom:P.bottom-N.bottom+m.bottom,left:N.left-P.left+m.left,right:P.right-N.right+m.right},G=n.modifiersData.offset;if(_===dt&&G){var B=G[i];Object.keys(z).forEach(function(S){var T=[Se,Ce].indexOf(S)>=0?1:-1,V=[ye,Ce].indexOf(S)>=0?"y":"x";z[S]+=B[V]*T})}return z}function Bd(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,l=t.padding,r=t.flipVariations,d=t.allowedAutoPlacements,h=d===void 0?qs:d,c=gt(o),$=c?r?js:js.filter(function(y){return gt(y)===c}):Et,_=$.filter(function(y){return h.indexOf(y)>=0});_.length===0&&(_=$);var v=_.reduce(function(y,g){return y[g]=bt(n,{placement:g,boundary:i,rootBoundary:a,padding:l})[Ne(g)],y},{});return Object.keys(v).sort(function(y,g){return v[y]-v[g]})}function qd(n){if(Ne(n)===ls)return[];var e=Qt(n);return[$n(n),e,$n(e)]}function zd(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,l=t.altAxis,r=l===void 0?!0:l,d=t.fallbackPlacements,h=t.padding,c=t.boundary,$=t.rootBoundary,_=t.altBoundary,v=t.flipVariations,y=v===void 0?!0:v,g=t.allowedAutoPlacements,f=e.options.placement,m=Ne(f),w=m===f,C=d||(w||!y?[Qt(f)]:qd(f)),M=[f].concat(C).reduce(function(J,fe){return J.concat(Ne(fe)===ls?Bd(e,{placement:fe,boundary:c,rootBoundary:$,padding:h,flipVariations:y,allowedAutoPlacements:g}):fe)},[]),N=e.rects.reference,I=e.rects.popper,k=new Map,O=!0,P=M[0],z=0;z<M.length;z++){var G=M[z],B=Ne(G),S=gt(G)===st,T=[ye,Ce].indexOf(B)>=0,V=T?"width":"height",A=bt(e,{placement:G,boundary:c,rootBoundary:$,altBoundary:_,padding:h}),x=T?S?Se:$e:S?Ce:ye;N[V]>I[V]&&(x=Qt(x));var j=Qt(x),U=[];if(a&&U.push(A[B]<=0),r&&U.push(A[x]<=0,A[j]<=0),U.every(function(J){return J})){P=G,O=!1;break}k.set(G,U)}if(O)for(var Y=y?3:1,Q=function(fe){var q=M.find(function(R){var W=k.get(R);if(W)return W.slice(0,fe).every(function(X){return X})});if(q)return P=q,"break"},K=Y;K>0;K--){var H=Q(K);if(H==="break")break}e.placement!==P&&(e.modifiersData[o]._skip=!0,e.placement=P,e.reset=!0)}}const To={name:"flip",enabled:!0,phase:"main",fn:zd,requiresIfExists:["offset"],data:{_skip:!1}};function En(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Cn(n){return[ye,Se,Ce,$e].some(function(e){return n[e]>=0})}function Kd(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=bt(e,{elementContext:"reference"}),r=bt(e,{altBoundary:!0}),d=En(l,o),h=En(r,i,a),c=Cn(d),$=Cn(h);e.modifiersData[t]={referenceClippingOffsets:d,popperEscapeOffsets:h,isReferenceHidden:c,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":$})}const xo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Kd};function Gd(n,e,t){var o=Ne(n),i=[$e,ye].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,l=a[0],r=a[1];return l=l||0,r=(r||0)*i,[$e,Se].indexOf(o)>=0?{x:r,y:l}:{x:l,y:r}}function Yd(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,l=qs.reduce(function(c,$){return c[$]=Gd($,e.rects,a),c},{}),r=l[e.placement],d=r.x,h=r.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=h),e.modifiersData[o]=l}const Ao={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Yd};function Jd(n){var e=n.state,t=n.name;e.modifiersData[t]=ko({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Mo={name:"popperOffsets",enabled:!0,phase:"read",fn:Jd,data:{}};function Xd(n){return n==="x"?"y":"x"}function Qd(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,l=t.altAxis,r=l===void 0?!1:l,d=t.boundary,h=t.rootBoundary,c=t.altBoundary,$=t.padding,_=t.tether,v=_===void 0?!0:_,y=t.tetherOffset,g=y===void 0?0:y,f=bt(e,{boundary:d,rootBoundary:h,padding:$,altBoundary:c}),m=Ne(e.placement),w=gt(e.placement),C=!w,M=Gs(m),N=Xd(M),I=e.modifiersData.popperOffsets,k=e.rects.reference,O=e.rects.popper,P=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,z=typeof P=="number"?{mainAxis:P,altAxis:P}:Object.assign({mainAxis:0,altAxis:0},P),G=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(I){if(a){var S,T=M==="y"?ye:$e,V=M==="y"?Ce:Se,A=M==="y"?"height":"width",x=I[M],j=x+f[T],U=x-f[V],Y=v?-O[A]/2:0,Q=w===st?k[A]:O[A],K=w===st?-O[A]:-k[A],H=e.elements.arrow,J=v&&H?Ks(H):{width:0,height:0},fe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:bo(),q=fe[T],R=fe[V],W=Ot(0,k[A],J[A]),X=C?k[A]/2-Y-W-q-z.mainAxis:Q-W-q-z.mainAxis,se=C?-k[A]/2+Y+W+R+z.mainAxis:K+W+R+z.mainAxis,ve=e.elements.arrow&&jt(e.elements.arrow),fs=ve?M==="y"?ve.clientTop||0:ve.clientLeft||0:0,Ve=(S=G?.[M])!=null?S:0,Tt=x+X-Ve-fs,xt=x+se-Ve,rt=Ot(v?ss(j,Tt):j,x,v?et(U,xt):U);I[M]=rt,B[M]=rt-x}if(r){var Ut,ui=M==="x"?ye:$e,di=M==="x"?Ce:Se,Je=I[N],Bt=N==="y"?"height":"width",an=Je+f[ui],ln=Je-f[di],vs=[ye,$e].indexOf(m)!==-1,rn=(Ut=G?.[N])!=null?Ut:0,cn=vs?an:Je-k[Bt]-O[Bt]-rn+z.altAxis,un=vs?Je+k[Bt]+O[Bt]-rn-z.altAxis:ln,dn=v&&vs?Ad(cn,Je,un):Ot(v?cn:an,Je,v?un:ln);I[N]=dn,B[N]=dn-Je}e.modifiersData[o]=B}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:Qd,requiresIfExists:["offset"]};function Zd(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function em(n){return n===ke(n)||!Te(n)?Ys(n):Zd(n)}function tm(n){var e=n.getBoundingClientRect(),t=ht(e.width)/n.offsetWidth||1,o=ht(e.height)/n.offsetHeight||1;return t!==1||o!==1}function sm(n,e,t){t===void 0&&(t=!1);var o=Te(e),i=Te(e)&&tm(e),a=Ke(e),l=_t(n,i,t),r={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(o||!o&&!t)&&((Ie(e)!=="body"||Xs(a))&&(r=em(e)),Te(e)?(d=_t(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):a&&(d.x=Js(a))),{x:l.left+r.scrollLeft-d.x,y:l.top+r.scrollTop-d.y,width:l.width,height:l.height}}function nm(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(r){if(!t.has(r)){var d=e.get(r);d&&i(d)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function om(n){var e=nm(n);return vo.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function im(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function am(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var Sn={placement:"bottom",modifiers:[],strategy:"absolute"};function kn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Do(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?Sn:i;return function(r,d,h){h===void 0&&(h=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Sn,a),modifiersData:{},elements:{reference:r,popper:d},attributes:{},styles:{}},$=[],_=!1,v={state:c,setOptions:function(m){var w=typeof m=="function"?m(c.options):m;g(),c.options=Object.assign({},a,c.options,w),c.scrollParents={reference:nt(r)?Dt(r):r.contextElement?Dt(r.contextElement):[],popper:Dt(d)};var C=om(am([].concat(o,c.options.modifiers)));return c.orderedModifiers=C.filter(function(M){return M.enabled}),y(),v.update()},forceUpdate:function(){if(!_){var m=c.elements,w=m.reference,C=m.popper;if(kn(w,C)){c.rects={reference:sm(w,jt(C),c.options.strategy==="fixed"),popper:Ks(C)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(z){return c.modifiersData[z.name]=Object.assign({},z.data)});for(var M=0;M<c.orderedModifiers.length;M++){if(c.reset===!0){c.reset=!1,M=-1;continue}var N=c.orderedModifiers[M],I=N.fn,k=N.options,O=k===void 0?{}:k,P=N.name;typeof I=="function"&&(c=I({state:c,options:O,name:P,instance:v})||c)}}}},update:im(function(){return new Promise(function(f){v.forceUpdate(),f(c)})}),destroy:function(){g(),_=!0}};if(!kn(r,d))return v;v.setOptions(h).then(function(f){!_&&h.onFirstUpdate&&h.onFirstUpdate(f)});function y(){c.orderedModifiers.forEach(function(f){var m=f.name,w=f.options,C=w===void 0?{}:w,M=f.effect;if(typeof M=="function"){var N=M({state:c,name:m,instance:v,options:C}),I=function(){};$.push(N||I)}})}function g(){$.forEach(function(f){return f()}),$=[]}return v}}var lm=[Co,Mo,Eo,ho,Ao,To,Oo,wo,xo],Qs=Do({defaultModifiers:lm});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:uo,afterRead:lo,afterWrite:fo,applyStyles:ho,arrow:wo,auto:ls,basePlacements:Et,beforeMain:ro,beforeRead:io,beforeWrite:mo,bottom:Ce,clippingParents:no,computeStyles:Eo,createPopper:Qs,detectOverflow:bt,end:vt,eventListeners:Co,flip:To,hide:xo,left:$e,main:co,modifierPhases:vo,offset:Ao,placements:qs,popper:dt,popperGenerator:Do,popperOffsets:Mo,preventOverflow:Oo,read:ao,reference:oo,right:Se,start:st,top:ye,variationPlacements:js,viewport:Bs,write:po},Symbol.toStringTag,{value:"Module"}));const Fe=new Map,ys={set(n,e,t){Fe.has(n)||Fe.set(n,new Map);const o=Fe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Fe.has(n)&&Fe.get(n).get(e)||null},remove(n,e){if(!Fe.has(n))return;const t=Fe.get(n);t.delete(e),t.size===0&&Fe.delete(n)}},rm=1e6,cm=1e3,Ws="transitionend",Lo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),um=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),dm=n=>{do n+=Math.floor(Math.random()*rm);while(document.getElementById(n));return n},mm=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*cm)},Io=n=>{n.dispatchEvent(new Event(Ws))},je=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Ue=n=>je(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Lo(n)):null,Ct=n=>{if(!je(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Be=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Po=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Po(n.parentNode):null},ns=()=>{},Rt=n=>{n.offsetHeight},jo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,$s=[],pm=n=>{document.readyState==="loading"?($s.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of $s)e()}),$s.push(n)):n()},Ae=()=>document.documentElement.dir==="rtl",Oe=n=>{pm(()=>{const e=jo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},Ee=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Ro=(n,e,t=!0)=>{if(!t){Ee(n);return}const i=mm(e)+5;let a=!1;const l=({target:r})=>{r===e&&(a=!0,e.removeEventListener(Ws,l),Ee(n))};e.addEventListener(Ws,l),setTimeout(()=>{a||Io(e)},i)},Zs=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},fm=/[^.]*(?=\..*)\.|.*/,vm=/\..*/,hm=/::\d+$/,ws={};let Tn=1;const Ho={mouseenter:"mouseover",mouseleave:"mouseout"},_m=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Wo(n,e){return e&&`${e}::${Tn++}`||n.uidEvent||Tn++}function Vo(n){const e=Wo(n);return n.uidEvent=e,ws[e]=ws[e]||{},ws[e]}function gm(n,e){return function t(o){return en(o,{delegateTarget:n}),t.oneOff&&F.off(n,o.type,e),e.apply(n,[o])}}function bm(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const r of a)if(r===l)return en(i,{delegateTarget:l}),o.oneOff&&F.off(n,i.type,e,t),t.apply(l,[i])}}function Fo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Uo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Bo(n);return _m.has(a)||(a=n),[o,i,a]}function xn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,l,r]=Uo(e,t,o);e in Ho&&(l=(y=>function(g){if(!g.relatedTarget||g.relatedTarget!==g.delegateTarget&&!g.delegateTarget.contains(g.relatedTarget))return y.call(this,g)})(l));const d=Vo(n),h=d[r]||(d[r]={}),c=Fo(h,l,a?t:null);if(c){c.oneOff=c.oneOff&&i;return}const $=Wo(l,e.replace(fm,"")),_=a?bm(n,t,l):gm(n,l);_.delegationSelector=a?t:null,_.callable=l,_.oneOff=i,_.uidEvent=$,h[$]=_,n.addEventListener(r,_,a)}function Vs(n,e,t,o,i){const a=Fo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function ym(n,e,t,o){const i=e[t]||{};for(const[a,l]of Object.entries(i))a.includes(o)&&Vs(n,e,t,l.callable,l.delegationSelector)}function Bo(n){return n=n.replace(vm,""),Ho[n]||n}const F={on(n,e,t,o){xn(n,e,t,o,!1)},one(n,e,t,o){xn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,l]=Uo(e,t,o),r=l!==e,d=Vo(n),h=d[l]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(h).length)return;Vs(n,d,l,a,i?t:null);return}if(c)for(const $ of Object.keys(d))ym(n,d,$,e.slice(1));for(const[$,_]of Object.entries(h)){const v=$.replace(hm,"");(!r||e.includes(v))&&Vs(n,d,l,_.callable,_.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=jo(),i=Bo(e),a=e!==i;let l=null,r=!0,d=!0,h=!1;a&&o&&(l=o.Event(e,t),o(n).trigger(l),r=!l.isPropagationStopped(),d=!l.isImmediatePropagationStopped(),h=l.isDefaultPrevented());const c=en(new Event(e,{bubbles:r,cancelable:!0}),t);return h&&c.preventDefault(),d&&n.dispatchEvent(c),c.defaultPrevented&&l&&l.preventDefault(),c}};function en(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function An(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Es(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Re={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${Es(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Es(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=An(n.dataset[o])}return e},getDataAttribute(n,e){return An(n.getAttribute(`data-bs-${Es(e)}`))}};class Ht{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=je(t)?Re.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...je(t)?Re.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],l=je(a)?"element":um(a);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const $m="5.3.8";class De extends Ht{constructor(e,t){super(),e=Ue(e),e&&(this._element=e,this._config=this._getConfig(t),ys.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ys.remove(this._element,this.constructor.DATA_KEY),F.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Ro(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ys.get(Ue(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return $m}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Cs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Lo(t)).join(","):null},ee={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Be(t)&&Ct(t))},getSelectorFromElement(n){const e=Cs(n);return e&&ee.findOne(e)?e:null},getElementFromSelector(n){const e=Cs(n);return e?ee.findOne(e):null},getMultipleElementsFromSelector(n){const e=Cs(n);return e?ee.find(e):[]}},cs=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;F.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Be(this))return;const a=ee.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},wm="alert",Em="bs.alert",qo=`.${Em}`,Cm=`close${qo}`,Sm=`closed${qo}`,km="fade",Tm="show";class us extends De{static get NAME(){return wm}close(){if(F.trigger(this._element,Cm).defaultPrevented)return;this._element.classList.remove(Tm);const t=this._element.classList.contains(km);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),F.trigger(this._element,Sm),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=us.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}cs(us,"close");Oe(us);const xm="button",Am="bs.button",Mm=`.${Am}`,Om=".data-api",Dm="active",Mn='[data-bs-toggle="button"]',Nm=`click${Mm}${Om}`;class ds extends De{static get NAME(){return xm}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Dm))}static jQueryInterface(e){return this.each(function(){const t=ds.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}F.on(document,Nm,Mn,n=>{n.preventDefault();const e=n.target.closest(Mn);ds.getOrCreateInstance(e).toggle()});Oe(ds);const Lm="swipe",St=".bs.swipe",Im=`touchstart${St}`,Pm=`touchmove${St}`,jm=`touchend${St}`,Rm=`pointerdown${St}`,Hm=`pointerup${St}`,Wm="touch",Vm="pen",Fm="pointer-event",Um=40,Bm={endCallback:null,leftCallback:null,rightCallback:null},qm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class os extends Ht{constructor(e,t){super(),this._element=e,!(!e||!os.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Bm}static get DefaultType(){return qm}static get NAME(){return Lm}dispose(){F.off(this._element,St)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ee(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Um)return;const t=e/this._deltaX;this._deltaX=0,t&&Ee(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(F.on(this._element,Rm,e=>this._start(e)),F.on(this._element,Hm,e=>this._end(e)),this._element.classList.add(Fm)):(F.on(this._element,Im,e=>this._start(e)),F.on(this._element,Pm,e=>this._move(e)),F.on(this._element,jm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Vm||e.pointerType===Wm)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const zm="carousel",Km="bs.carousel",Ge=`.${Km}`,zo=".data-api",Gm="ArrowLeft",Ym="ArrowRight",Jm=500,At="next",ct="prev",mt="left",Zt="right",Xm=`slide${Ge}`,Ss=`slid${Ge}`,Qm=`keydown${Ge}`,Zm=`mouseenter${Ge}`,ep=`mouseleave${Ge}`,tp=`dragstart${Ge}`,sp=`load${Ge}${zo}`,np=`click${Ge}${zo}`,Ko="carousel",zt="active",op="slide",ip="carousel-item-end",ap="carousel-item-start",lp="carousel-item-next",rp="carousel-item-prev",Go=".active",Yo=".carousel-item",cp=Go+Yo,up=".carousel-item img",dp=".carousel-indicators",mp="[data-bs-slide], [data-bs-slide-to]",pp='[data-bs-ride="carousel"]',fp={[Gm]:Zt,[Ym]:mt},vp={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},hp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Wt extends De{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ee.findOne(dp,this._element),this._addEventListeners(),this._config.ride===Ko&&this.cycle()}static get Default(){return vp}static get DefaultType(){return hp}static get NAME(){return zm}next(){this._slide(At)}nextWhenVisible(){!document.hidden&&Ct(this._element)&&this.next()}prev(){this._slide(ct)}pause(){this._isSliding&&Io(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){F.one(this._element,Ss,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){F.one(this._element,Ss,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?At:ct;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&F.on(this._element,Qm,e=>this._keydown(e)),this._config.pause==="hover"&&(F.on(this._element,Zm,()=>this.pause()),F.on(this._element,ep,()=>this._maybeEnableCycle())),this._config.touch&&os.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ee.find(up,this._element))F.on(o,tp,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(mt)),rightCallback:()=>this._slide(this._directionToOrder(Zt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Jm+this._config.interval))}};this._swipeHelper=new os(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=fp[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=ee.findOne(Go,this._indicatorsElement);t.classList.remove(zt),t.removeAttribute("aria-current");const o=ee.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(zt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===At,a=t||Zs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const l=this._getItemIndex(a),r=v=>F.trigger(this._element,v,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(r(Xm).defaultPrevented||!o||!a)return;const h=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=a;const c=i?ap:ip,$=i?lp:rp;a.classList.add($),Rt(a),o.classList.add(c),a.classList.add(c);const _=()=>{a.classList.remove(c,$),a.classList.add(zt),o.classList.remove(zt,$,c),this._isSliding=!1,r(Ss)};this._queueCallback(_,o,this._isAnimated()),h&&this.cycle()}_isAnimated(){return this._element.classList.contains(op)}_getActive(){return ee.findOne(cp,this._element)}_getItems(){return ee.find(Yo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ae()?e===mt?ct:At:e===mt?At:ct}_orderToDirection(e){return Ae()?e===ct?mt:Zt:e===ct?Zt:mt}static jQueryInterface(e){return this.each(function(){const t=Wt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}F.on(document,np,mp,function(n){const e=ee.getElementFromSelector(this);if(!e||!e.classList.contains(Ko))return;n.preventDefault();const t=Wt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Re.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});F.on(window,sp,()=>{const n=ee.find(pp);for(const e of n)Wt.getOrCreateInstance(e)});Oe(Wt);const _p="collapse",gp="bs.collapse",Vt=`.${gp}`,bp=".data-api",yp=`show${Vt}`,$p=`shown${Vt}`,wp=`hide${Vt}`,Ep=`hidden${Vt}`,Cp=`click${Vt}${bp}`,ks="show",ft="collapse",Kt="collapsing",Sp="collapsed",kp=`:scope .${ft} .${ft}`,Tp="collapse-horizontal",xp="width",Ap="height",Mp=".collapse.show, .collapse.collapsing",Fs='[data-bs-toggle="collapse"]',Op={parent:null,toggle:!0},Dp={parent:"(null|element)",toggle:"boolean"};class yt extends De{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=ee.find(Fs);for(const i of o){const a=ee.getSelectorFromElement(i),l=ee.find(a).filter(r=>r===this._element);a!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Op}static get DefaultType(){return Dp}static get NAME(){return _p}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Mp).filter(r=>r!==this._element).map(r=>yt.getOrCreateInstance(r,{toggle:!1}))),e.length&&e[0]._isTransitioning||F.trigger(this._element,yp).defaultPrevented)return;for(const r of e)r.hide();const o=this._getDimension();this._element.classList.remove(ft),this._element.classList.add(Kt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(ft,ks),this._element.style[o]="",F.trigger(this._element,$p)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||F.trigger(this._element,wp).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Rt(this._element),this._element.classList.add(Kt),this._element.classList.remove(ft,ks);for(const i of this._triggerArray){const a=ee.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(ft),F.trigger(this._element,Ep)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ks)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ue(e.parent),e}_getDimension(){return this._element.classList.contains(Tp)?xp:Ap}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Fs);for(const t of e){const o=ee.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=ee.find(kp,this._config.parent);return ee.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(Sp,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=yt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}F.on(document,Cp,Fs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ee.getMultipleElementsFromSelector(this))yt.getOrCreateInstance(e,{toggle:!1}).toggle()});Oe(yt);const On="dropdown",Np="bs.dropdown",at=`.${Np}`,tn=".data-api",Lp="Escape",Dn="Tab",Ip="ArrowUp",Nn="ArrowDown",Pp=2,jp=`hide${at}`,Rp=`hidden${at}`,Hp=`show${at}`,Wp=`shown${at}`,Jo=`click${at}${tn}`,Xo=`keydown${at}${tn}`,Vp=`keyup${at}${tn}`,pt="show",Fp="dropup",Up="dropend",Bp="dropstart",qp="dropup-center",zp="dropdown-center",Xe='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Kp=`${Xe}.${pt}`,es=".dropdown-menu",Gp=".navbar",Yp=".navbar-nav",Jp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Xp=Ae()?"top-end":"top-start",Qp=Ae()?"top-start":"top-end",Zp=Ae()?"bottom-end":"bottom-start",ef=Ae()?"bottom-start":"bottom-end",tf=Ae()?"left-start":"right-start",sf=Ae()?"right-start":"left-start",nf="top",of="bottom",af={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},lf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Le extends De{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=ee.next(this._element,es)[0]||ee.prev(this._element,es)[0]||ee.findOne(es,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return af}static get DefaultType(){return lf}static get NAME(){return On}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Be(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!F.trigger(this._element,Hp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Yp))for(const o of[].concat(...document.body.children))F.on(o,"mouseover",ns);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(pt),this._element.classList.add(pt),F.trigger(this._element,Wp,e)}}hide(){if(Be(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!F.trigger(this._element,jp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))F.off(o,"mouseover",ns);this._popper&&this._popper.destroy(),this._menu.classList.remove(pt),this._element.classList.remove(pt),this._element.setAttribute("aria-expanded","false"),Re.removeDataAttribute(this._menu,"popper"),F.trigger(this._element,Rp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!je(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${On.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:je(this._config.reference)?e=Ue(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Qs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(pt)}_getPlacement(){const e=this._parent;if(e.classList.contains(Up))return tf;if(e.classList.contains(Bp))return sf;if(e.classList.contains(qp))return nf;if(e.classList.contains(zp))return of;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Fp)?t?Qp:Xp:t?ef:Zp}_detectNavbar(){return this._element.closest(Gp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Re.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ee(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=ee.find(Jp,this._menu).filter(i=>Ct(i));o.length&&Zs(o,t,e===Nn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Le.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===Pp||e.type==="keyup"&&e.key!==Dn)return;const t=ee.find(Kp);for(const o of t){const i=Le.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),l=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Dn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const r={relatedTarget:i._element};e.type==="click"&&(r.clickEvent=e),i._completeHide(r)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===Lp,i=[Ip,Nn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(Xe)?this:ee.prev(this,Xe)[0]||ee.next(this,Xe)[0]||ee.findOne(Xe,e.delegateTarget.parentNode),l=Le.getOrCreateInstance(a);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),a.focus())}}F.on(document,Xo,Xe,Le.dataApiKeydownHandler);F.on(document,Xo,es,Le.dataApiKeydownHandler);F.on(document,Jo,Le.clearMenus);F.on(document,Vp,Le.clearMenus);F.on(document,Jo,Xe,function(n){n.preventDefault(),Le.getOrCreateInstance(this).toggle()});Oe(Le);const Qo="backdrop",rf="fade",Ln="show",In=`mousedown.bs.${Qo}`,cf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},uf={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Zo extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return cf}static get DefaultType(){return uf}static get NAME(){return Qo}show(e){if(!this._config.isVisible){Ee(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Rt(t),t.classList.add(Ln),this._emulateAnimation(()=>{Ee(e)})}hide(e){if(!this._config.isVisible){Ee(e);return}this._getElement().classList.remove(Ln),this._emulateAnimation(()=>{this.dispose(),Ee(e)})}dispose(){this._isAppended&&(F.off(this._element,In),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(rf),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ue(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),F.on(e,In,()=>{Ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Ro(e,this._getElement(),this._config.isAnimated)}}const df="focustrap",mf="bs.focustrap",is=`.${mf}`,pf=`focusin${is}`,ff=`keydown.tab${is}`,vf="Tab",hf="forward",Pn="backward",_f={autofocus:!0,trapElement:null},gf={autofocus:"boolean",trapElement:"element"};class ei extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return _f}static get DefaultType(){return gf}static get NAME(){return df}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),F.off(document,is),F.on(document,pf,e=>this._handleFocusin(e)),F.on(document,ff,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,F.off(document,is))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=ee.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Pn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===vf&&(this._lastTabNavDirection=e.shiftKey?Pn:hf)}}const jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Rn=".sticky-top",Gt="padding-right",Hn="margin-right";class Us{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Gt,t=>t+e),this._setElementAttributes(jn,Gt,t=>t+e),this._setElementAttributes(Rn,Hn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Gt),this._resetElementAttributes(jn,Gt),this._resetElementAttributes(Rn,Hn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,t);const r=window.getComputedStyle(l).getPropertyValue(t);l.style.setProperty(t,`${o(Number.parseFloat(r))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Re.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=Re.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}Re.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(je(e)){t(e);return}for(const o of ee.find(e,this._element))t(o)}}const bf="modal",yf="bs.modal",Me=`.${yf}`,$f=".data-api",wf="Escape",Ef=`hide${Me}`,Cf=`hidePrevented${Me}`,ti=`hidden${Me}`,si=`show${Me}`,Sf=`shown${Me}`,kf=`resize${Me}`,Tf=`click.dismiss${Me}`,xf=`mousedown.dismiss${Me}`,Af=`keydown.dismiss${Me}`,Mf=`click${Me}${$f}`,Wn="modal-open",Of="fade",Vn="show",Ts="modal-static",Df=".modal.show",Nf=".modal-dialog",Lf=".modal-body",If='[data-bs-toggle="modal"]',Pf={backdrop:!0,focus:!0,keyboard:!0},jf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ot extends De{constructor(e,t){super(e,t),this._dialog=ee.findOne(Nf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Us,this._addEventListeners()}static get Default(){return Pf}static get DefaultType(){return jf}static get NAME(){return bf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||F.trigger(this._element,si,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Wn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||F.trigger(this._element,Ef).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Vn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){F.off(window,Me),F.off(this._dialog,Me),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Zo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=ee.findOne(Lf,this._dialog);t&&(t.scrollTop=0),Rt(this._element),this._element.classList.add(Vn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,F.trigger(this._element,Sf,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){F.on(this._element,Af,e=>{if(e.key===wf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),F.on(window,kf,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),F.on(this._element,xf,e=>{F.one(this._element,Tf,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Wn),this._resetAdjustments(),this._scrollBar.reset(),F.trigger(this._element,ti)})}_isAnimated(){return this._element.classList.contains(Of)}_triggerBackdropTransition(){if(F.trigger(this._element,Cf).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ts)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ts),this._queueCallback(()=>{this._element.classList.remove(Ts),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Ae()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Ae()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=ot.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}F.on(document,Mf,If,function(n){const e=ee.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),F.one(e,si,i=>{i.defaultPrevented||F.one(e,ti,()=>{Ct(this)&&this.focus()})});const t=ee.findOne(Df);t&&ot.getInstance(t).hide(),ot.getOrCreateInstance(e).toggle(this)});cs(ot);Oe(ot);const Rf="offcanvas",Hf="bs.offcanvas",We=`.${Hf}`,ni=".data-api",Wf=`load${We}${ni}`,Vf="Escape",Fn="show",Un="showing",Bn="hiding",Ff="offcanvas-backdrop",oi=".offcanvas.show",Uf=`show${We}`,Bf=`shown${We}`,qf=`hide${We}`,qn=`hidePrevented${We}`,ii=`hidden${We}`,zf=`resize${We}`,Kf=`click${We}${ni}`,Gf=`keydown.dismiss${We}`,Yf='[data-bs-toggle="offcanvas"]',Jf={backdrop:!0,keyboard:!0,scroll:!1},Xf={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class qe extends De{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Jf}static get DefaultType(){return Xf}static get NAME(){return Rf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||F.trigger(this._element,Uf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Us().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Un);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Fn),this._element.classList.remove(Un),F.trigger(this._element,Bf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||F.trigger(this._element,qf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Bn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Fn,Bn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Us().reset(),F.trigger(this._element,ii)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){F.trigger(this._element,qn);return}this.hide()},t=!!this._config.backdrop;return new Zo({className:Ff,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_addEventListeners(){F.on(this._element,Gf,e=>{if(e.key===Vf){if(this._config.keyboard){this.hide();return}F.trigger(this._element,qn)}})}static jQueryInterface(e){return this.each(function(){const t=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}F.on(document,Kf,Yf,function(n){const e=ee.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Be(this))return;F.one(e,ii,()=>{Ct(this)&&this.focus()});const t=ee.findOne(oi);t&&t!==e&&qe.getInstance(t).hide(),qe.getOrCreateInstance(e).toggle(this)});F.on(window,Wf,()=>{for(const n of ee.find(oi))qe.getOrCreateInstance(n).show()});F.on(window,zf,()=>{for(const n of ee.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&qe.getOrCreateInstance(n).hide()});cs(qe);Oe(qe);const Qf=/^aria-[\w-]*$/i,ai={"*":["class","dir","id","lang","role",Qf],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Zf=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),ev=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,tv=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?Zf.has(t)?!!ev.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function sv(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const l of a){const r=l.nodeName.toLowerCase();if(!Object.keys(e).includes(r)){l.remove();continue}const d=[].concat(...l.attributes),h=[].concat(e["*"]||[],e[r]||[]);for(const c of d)tv(c,h)||l.removeAttribute(c.nodeName)}return i.body.innerHTML}const nv="TemplateFactory",ov={allowList:ai,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},iv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},av={entry:"(string|element|function|null)",selector:"(string|element)"};class lv extends Ht{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return ov}static get DefaultType(){return iv}static get NAME(){return nv}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},av)}_setContent(e,t,o){const i=ee.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(je(t)){this._putElementInTemplate(Ue(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?sv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ee(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const rv="tooltip",cv=new Set(["sanitize","allowList","sanitizeFn"]),xs="fade",uv="modal",Yt="show",dv=".tooltip-inner",zn=`.${uv}`,Kn="hide.bs.modal",Mt="hover",As="focus",Ms="click",mv="manual",pv="hide",fv="hidden",vv="show",hv="shown",_v="inserted",gv="click",bv="focusin",yv="focusout",$v="mouseenter",wv="mouseleave",Ev={AUTO:"auto",TOP:"top",RIGHT:Ae()?"left":"right",BOTTOM:"bottom",LEFT:Ae()?"right":"left"},Cv={allowList:ai,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Sv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class kt extends De{constructor(e,t){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Cv}static get DefaultType(){return Sv}static get NAME(){return rv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),F.off(this._element.closest(zn),Kn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=F.trigger(this._element,this.constructor.eventName(vv)),o=(Po(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),F.trigger(this._element,this.constructor.eventName(_v))),this._popper=this._createPopper(i),i.classList.add(Yt),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))F.on(r,"mouseover",ns);const l=()=>{F.trigger(this._element,this.constructor.eventName(hv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||F.trigger(this._element,this.constructor.eventName(pv)).defaultPrevented)return;if(this._getTipElement().classList.remove(Yt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))F.off(i,"mouseover",ns);this._activeTrigger[Ms]=!1,this._activeTrigger[As]=!1,this._activeTrigger[Mt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),F.trigger(this._element,this.constructor.eventName(fv)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(xs,Yt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=dm(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(xs),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new lv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[dv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(xs)}_isShown(){return this.tip&&this.tip.classList.contains(Yt)}_createPopper(e){const t=Ee(this._config.placement,[this,e,this._element]),o=Ev[t.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Ee(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Ee(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")F.on(this._element,this.constructor.eventName(gv),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ms]=!(i._isShown()&&i._activeTrigger[Ms]),i.toggle()});else if(t!==mv){const o=t===Mt?this.constructor.eventName($v):this.constructor.eventName(bv),i=t===Mt?this.constructor.eventName(wv):this.constructor.eventName(yv);F.on(this._element,o,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusin"?As:Mt]=!0,l._enter()}),F.on(this._element,i,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusout"?As:Mt]=l._element.contains(a.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},F.on(this._element.closest(zn),Kn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Re.getDataAttributes(this._element);for(const o of Object.keys(t))cv.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ue(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=kt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Oe(kt);const kv="popover",Tv=".popover-header",xv=".popover-body",Av={...kt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Mv={...kt.DefaultType,content:"(null|string|element|function)"};class sn extends kt{static get Default(){return Av}static get DefaultType(){return Mv}static get NAME(){return kv}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Tv]:this._getTitle(),[xv]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Oe(sn);const Ov="scrollspy",Dv="bs.scrollspy",nn=`.${Dv}`,Nv=".data-api",Lv=`activate${nn}`,Gn=`click${nn}`,Iv=`load${nn}${Nv}`,Pv="dropdown-item",ut="active",jv='[data-bs-spy="scroll"]',Os="[href]",Rv=".nav, .list-group",Yn=".nav-link",Hv=".nav-item",Wv=".list-group-item",Vv=`${Yn}, ${Hv} > ${Yn}, ${Wv}`,Fv=".dropdown",Uv=".dropdown-toggle",Bv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},qv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ms extends De{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Bv}static get DefaultType(){return qv}static get NAME(){return Ov}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ue(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(F.off(this._config.target,Gn),F.on(this._config.target,Gn,Os,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(t(l))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(l));continue}const r=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&r){if(o(l),!i)return;continue}!a&&!r&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ee.find(Os,this._config.target);for(const t of e){if(!t.hash||Be(t))continue;const o=ee.findOne(decodeURI(t.hash),this._element);Ct(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ut),this._activateParents(e),F.trigger(this._element,Lv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Pv)){ee.findOne(Uv,e.closest(Fv)).classList.add(ut);return}for(const t of ee.parents(e,Rv))for(const o of ee.prev(t,Vv))o.classList.add(ut)}_clearActiveClass(e){e.classList.remove(ut);const t=ee.find(`${Os}.${ut}`,e);for(const o of t)o.classList.remove(ut)}static jQueryInterface(e){return this.each(function(){const t=ms.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}F.on(window,Iv,()=>{for(const n of ee.find(jv))ms.getOrCreateInstance(n)});Oe(ms);const zv="tab",Kv="bs.tab",lt=`.${Kv}`,Gv=`hide${lt}`,Yv=`hidden${lt}`,Jv=`show${lt}`,Xv=`shown${lt}`,Qv=`click${lt}`,Zv=`keydown${lt}`,eh=`load${lt}`,th="ArrowLeft",Jn="ArrowRight",sh="ArrowUp",Xn="ArrowDown",Ds="Home",Qn="End",Qe="active",Zn="fade",Ns="show",nh="dropdown",li=".dropdown-toggle",oh=".dropdown-menu",Ls=`:not(${li})`,ih='.list-group, .nav, [role="tablist"]',ah=".nav-item, .list-group-item",lh=`.nav-link${Ls}, .list-group-item${Ls}, [role="tab"]${Ls}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Is=`${lh}, ${ri}`,rh=`.${Qe}[data-bs-toggle="tab"], .${Qe}[data-bs-toggle="pill"], .${Qe}[data-bs-toggle="list"]`;class $t extends De{constructor(e){super(e),this._parent=this._element.closest(ih),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),F.on(this._element,Zv,t=>this._keydown(t)))}static get NAME(){return zv}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?F.trigger(t,Gv,{relatedTarget:e}):null;F.trigger(e,Jv,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(Qe),this._activate(ee.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ns);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),F.trigger(e,Xv,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(Zn))}_deactivate(e,t){if(!e)return;e.classList.remove(Qe),e.blur(),this._deactivate(ee.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ns);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),F.trigger(e,Yv,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(Zn))}_keydown(e){if(![th,Jn,sh,Xn,Ds,Qn].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Be(i));let o;if([Ds,Qn].includes(e.key))o=t[e.key===Ds?0:t.length-1];else{const i=[Jn,Xn].includes(e.key);o=Zs(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),$t.getOrCreateInstance(o).show())}_getChildren(){return ee.find(Is,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=ee.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(nh))return;const i=(a,l)=>{const r=ee.findOne(a,o);r&&r.classList.toggle(l,t)};i(li,Qe),i(oh,Ns),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(Qe)}_getInnerElement(e){return e.matches(Is)?e:ee.findOne(Is,e)}_getOuterElement(e){return e.closest(ah)||e}static jQueryInterface(e){return this.each(function(){const t=$t.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}F.on(document,Qv,ri,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Be(this)&&$t.getOrCreateInstance(this).show()});F.on(window,eh,()=>{for(const n of ee.find(rh))$t.getOrCreateInstance(n)});Oe($t);const ch="toast",uh="bs.toast",Ye=`.${uh}`,dh=`mouseover${Ye}`,mh=`mouseout${Ye}`,ph=`focusin${Ye}`,fh=`focusout${Ye}`,vh=`hide${Ye}`,hh=`hidden${Ye}`,_h=`show${Ye}`,gh=`shown${Ye}`,bh="fade",eo="hide",Jt="show",Xt="showing",yh={animation:"boolean",autohide:"boolean",delay:"number"},$h={animation:!0,autohide:!0,delay:5e3};class ps extends De{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return $h}static get DefaultType(){return yh}static get NAME(){return ch}show(){if(F.trigger(this._element,_h).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(bh);const t=()=>{this._element.classList.remove(Xt),F.trigger(this._element,gh),this._maybeScheduleHide()};this._element.classList.remove(eo),Rt(this._element),this._element.classList.add(Jt,Xt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||F.trigger(this._element,vh).defaultPrevented)return;const t=()=>{this._element.classList.add(eo),this._element.classList.remove(Xt,Jt),F.trigger(this._element,hh)};this._element.classList.add(Xt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Jt),super.dispose()}isShown(){return this._element.classList.contains(Jt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){F.on(this._element,dh,e=>this._onInteraction(e,!0)),F.on(this._element,mh,e=>this._onInteraction(e,!1)),F.on(this._element,ph,e=>this._onInteraction(e,!0)),F.on(this._element,fh,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}cs(ps);Oe(ps);const wh={class:"message-content-column"},Eh=["id"],Ch={class:"accordion-item"},Sh=["id"],kh=["aria-controls"],Th={class:"d-flex align-items-center w-100"},xh={class:"badge bg-warning text-dark ms-auto me-2"},Ah={class:"text-muted"},Mh=["id","aria-labelledby"],Oh={class:"accordion-body bg-light"},Dh={class:"alert alert-warning mb-3",role:"alert"},Nh={class:"compaction-metadata"},Lh={class:"metadata-row"},Ih={class:"metadata-row"},Ph={key:0,class:"metadata-row"},jh={class:"continuation-content"},Rh={class:"continuation-text border rounded p-3 bg-white"},Hh={class:"mb-0"},Wh={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=b(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=b(()=>`heading-${t.value}`),i=b(()=>`collapse-${t.value}`),a=L(null);let l=null;pe(()=>{a.value&&(l=new yt(a.value,{toggle:!1}))}),mi(()=>{l&&l.dispose()});function r(){l&&l.toggle()}const d=b(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),h=b(()=>d.value?e.messages[3]:e.messages[2]),c=b(()=>h.value?.metadata?.init_data?.compact_metadata||{}),$=b(()=>c.value.pre_tokens||0),_=b(()=>d.value?e.messages[4]:e.messages[3]),v=b(()=>_.value?.content||""),y=b(()=>{const f=e.messages[0]?.timestamp;return f?Pt(f):""});function g(f){return f?`${f.toLocaleString()} tokens`:"0 tokens"}return(f,m)=>(u(),p("div",{class:"message-row message-row-compaction",key:t.value},[m[7]||(m[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",wh,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Ch,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:r},[s("div",Th,[m[0]||(m[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),m[1]||(m[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",xh,E(g($.value)),1),s("small",Ah,E(y.value),1)])],8,kh)],8,Sh),s("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Oh,[s("div",Dh,[m[5]||(m[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ne(" Compaction Details ")],-1)),s("div",Nh,[s("div",Lh,[m[2]||(m[2]=s("strong",null,"Trigger:",-1)),s("span",null,E(c.value.trigger||"auto"),1)]),s("div",Ih,[m[3]||(m[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,E(g($.value)),1)]),c.value.post_tokens?(u(),p("div",Ph,[m[4]||(m[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,E(g(c.value.post_tokens)),1)])):D("",!0)])]),s("div",jh,[m[6]||(m[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ne(" Continuation Message ")],-1)),s("div",Rh,[s("pre",Hh,E(v.value),1)])])])],8,Mh)])],8,Eh)])]))}},Vh=te(Wh,[["__scopeId","data-v-e0b95ba8"]]),Fh={key:0,class:"text-muted text-center py-5"},Uh={__name:"MessageList",setup(n){const e=xe(),t=me(),o=L(null),i=b(()=>{const c=e.currentMessages,$=[];let _=0;for(;_<c.length;){const v=c[_];if(l(v,c,_)){const y=c[_+2],f=y?.type==="system"&&y?.metadata?.subtype==="init"?5:4,m=c.slice(_,_+f);$.push({type:"compaction",messages:m}),_+=f;continue}d(v)&&$.push({type:"message",message:v,attachedTools:[]}),_++}return a($)});function a(c){const $=new Map,_=new Set;for(let y=0;y<c.length;y++){const g=c[y];if(g.type==="compaction")continue;const f=g.message,m=f.content&&f.content.trim().length>0&&f.content!=="Assistant response",w=f.type==="assistant"&&f.metadata?.has_tool_uses&&f.metadata?.tool_uses?.length>0;if(f.type==="assistant"&&w&&!m){let C=-1,M=!1;for(let N=y-1;N>=0;N--){const I=c[N];if(!_.has(N)){if(I.type==="message"&&I.message.type!=="assistant"){M=!0;break}if(I.type==="message"&&I.message.type==="assistant"){const k=I.message;if(k.content&&k.content.trim().length>0&&k.content!=="Assistant response"){C=N;break}else{C=N;break}}}}M&&C===-1||(M&&C>=0?($.has(C)||$.set(C,[]),$.get(C).push(...f.metadata.tool_uses),_.add(y)):!M&&C>=0&&($.has(C)||$.set(C,[]),$.get(C).push(...f.metadata.tool_uses),_.add(y)))}}const v=[];for(let y=0;y<c.length;y++){if(_.has(y))continue;const g=c[y];$.has(y)&&(g.attachedTools=[...g.attachedTools||[],...$.get(y)]),v.push(g)}return v}function l(c,$,_){if(_+3>=$.length)return!1;const v=$[_],y=$[_+1];let g=$[_+2],f=$[_+3],m=$[_+4];const w=v.type==="system"&&v.metadata?.subtype==="status"&&v.metadata?.init_data?.status==="compacting",C=y.type==="system"&&y.metadata?.subtype==="status"&&(y.metadata?.init_data?.status===null||y.metadata?.init_data?.status===void 0);if(g?.type==="system"&&g?.metadata?.subtype==="init"){if(_+4>=$.length)return!1;const N=!0,I=f?.type==="system"&&f?.metadata?.subtype==="compact_boundary",k=m?.type==="user"&&m?.content?.startsWith("This session is being continued from a previous conversation");return v.type==="system"&&v.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",_),console.log("  Msg1 (compacting):",w),console.log("  Msg2 (null status):",C),console.log("  Msg3 (init):",N),console.log("  Msg4 (boundary):",I),console.log("  Msg5 (continuation):",k)),w&&C&&N&&I&&k}else{const N=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",I=f?.type==="user"&&f?.content?.startsWith("This session is being continued from a previous conversation");return v.type==="system"&&v.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",_),console.log("  Msg1 (compacting):",w),console.log("  Msg2 (null status):",C),console.log("  Msg3 (boundary):",N),console.log("  Msg4 (continuation):",I)),w&&C&&N&&I}}async function r(){t.autoScrollEnabled&&(await Ps(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}le(()=>i.value.length,r),le(()=>e.currentToolCalls.length,r),le(()=>e.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),r),pe(()=>{setTimeout(()=>{r()},100)});function d(c){const $=c.subtype||c.metadata?.subtype;if(c.type==="system"&&$==="init"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const _=c.content||"";if(_.match(/^Tool results?: \d+ results?$/i)||_.trim()==="")return!1}if(c.type==="user"){const _=c.content||"";if(_.includes("<command-message>")&&_.includes("skill is running")||_.startsWith("Base directory for this skill:"))return!1}if(c.type==="user"){const _=c.content||"";if(_.includes("<command-message>")&&_.includes("<command-name>")&&_.includes("<command-args>")||_.includes("ARGUMENTS:")&&(_.includes("<command-name>")||_.match(/\nARGUMENTS:/)))return!1}return!0}function h(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,$)=>(u(),p("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),p("div",Fh," No messages yet. Start a conversation! ")):D("",!0),(u(!0),p(re,null,ue(i.value,(_,v)=>(u(),p(re,{key:`item-${v}`},[_.type==="message"?(u(),ge(Cd,{key:0,message:h(_.message),attachedTools:_.attachedTools||[]},null,8,["message","attachedTools"])):_.type==="compaction"?(u(),ge(Vh,{key:1,messages:_.messages},null,8,["messages"])):D("",!0)],64))),128))],512))}},Bh=te(Uh,[["__scopeId","data-v-6bae0fb1"]]),qh={class:"border-top bg-light"},zh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Kh={class:"d-flex gap-2 align-items-end px-2 py-1"},Gh=["placeholder","disabled"],Yh=["disabled"],Jh={__name:"InputArea",setup(n){const e=ae(),t=ze(),o=L(null),i=L(window.innerWidth),a=b({get:()=>e.currentInput,set:f=>{e.currentInput=f}}),l=b(()=>e.currentSession?.is_processing||!1),r=b(()=>t.sessionConnected),d=b(()=>e.currentSession?.state==="starting"),h=b(()=>i.value<768),c=b(()=>d.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function $(){i.value=window.innerWidth}pe(()=>{window.addEventListener("resize",$)}),he(()=>{window.removeEventListener("resize",$)});function _(f){if(f.key==="Enter"&&!f.shiftKey){if(h.value)return;f.preventDefault(),y()}}function v(){const f=o.value;if(!f)return;f.style.height="auto";const m=Math.min(f.scrollHeight,parseInt(getComputedStyle(f).maxHeight));f.style.height=m+"px"}function y(){a.value.trim()&&(t.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function g(){t.interruptSession()}return(f,m)=>(u(),p("div",qh,[r.value?D("",!0):(u(),p("div",zh,[...m[1]||(m[1]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",Kh,[oe(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":m[0]||(m[0]=w=>a.value=w),class:"form-control",placeholder:c.value,disabled:d.value||!r.value,rows:"1",onInput:v,onKeydown:_},null,40,Gh),[[de,a.value]]),l.value?(u(),p("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:g}," Stop ")):(u(),p("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!r.value||d.value,onClick:y}," Send ",8,Yh))])]))}},Xh=te(Jh,[["__scopeId","data-v-ef1e5094"]]),Qh={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Zh={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},e_={class:"text-secondary"},t_={class:"d-flex flex-column flex-grow-1 overflow-hidden"},s_={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ae(),o=me(),i=b(()=>t.currentSession),a=b(()=>o.isLoading),l=b(()=>o.loadingMessage);return pe(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),le(()=>e.sessionId,async(r,d)=>{if(r!==d&&r!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(r)}finally{o.hideLoading()}}}),he(()=>{}),(r,d)=>(u(),p("div",Qh,[a.value?(u(),p("div",Zh,[d[0]||(d[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",e_,E(l.value),1)])):D("",!0),i.value?(u(),ge(Mi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):D("",!0),s("div",t_,[ce(Bh)]),ce(Xh),i.value?(u(),ge(Ii,{key:2,"session-id":e.sessionId},null,8,["session-id"])):D("",!0),i.value?(u(),ge(Bi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):D("",!0)]))}},Ft=wt("legion",()=>{const n=L(new Map),e=L(new Map),t=L(null),o=b(()=>n.value.get(t.value)||[]),i=b(()=>e.value.get(t.value)||[]);function a(y){t.value=y}async function l(y,g=100,f=0){try{const m=await ie.get(`/api/legions/${y}/timeline?limit=${g}&offset=${f}`),w=m.comms||[],C=m.total_count||w.length,M=m.has_more||!1;return w.sort((N,I)=>new Date(N.timestamp)-new Date(I.timestamp)),console.log(`Loaded ${w.length} of ${C} comms for legion ${y}`),n.value.set(y,w),n.value=new Map(n.value),{comms:w,totalCount:C,hasMore:M}}catch(m){throw console.error("Failed to load timeline:",m),m}}function r(y,g){n.value.has(y)||n.value.set(y,[]);const f=n.value.get(y);if(f.some(w=>w.comm_id===g.comm_id)){console.log(`Duplicate comm ${g.comm_id} prevented in timeline`);return}f.push(g),n.value=new Map(n.value)}async function d(y,g){try{const m=(await ie.post(`/api/legions/${y}/comms`,g)).comm;return console.log(`Sent comm ${m.comm_id} to legion ${y}`),m}catch(f){throw console.error("Failed to send comm:",f),f}}async function h(y){return console.log(`Minions for legion ${y} are already available in session store`),[]}async function c(y,g){try{const m=(await ie.post(`/api/legions/${y}/minions`,g)).minion;return await h(y),console.log(`Created minion ${m.minion_id} in legion ${y}`),m}catch(f){throw console.error("Failed to create minion:",f),f}}async function $(y){try{const g=await ie.post(`/api/legions/${y}/halt-all`);return console.log(`Halted ${g.halted_count} of ${g.total_minions} minions in legion ${y}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to halt some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to halt all minions:",g),g}}async function _(y){try{const g=await ie.post(`/api/legions/${y}/resume-all`);return console.log(`Resumed ${g.resumed_count} of ${g.total_minions} minions in legion ${y}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to resume some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to resume all minions:",g),g}}function v(y){n.value.delete(y),e.value.delete(y),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:l,addComm:r,sendComm:d,loadMinions:h,createMinion:c,haltAll:$,resumeAll:_,clearLegionData:v}}),n_=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Ft},Symbol.toStringTag,{value:"Module"})),o_={class:"timeline-header border-bottom p-3"},i_={class:"project-name"},a_=["title"],l_={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=we(),o=b(()=>t.projects.get(e.legionId)),i=b(()=>o.value?.name||"Legion");return(a,l)=>(u(),p("div",o_,[s("div",null,[s("div",i_,E(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,a_)])]))}},r_=te(l_,[["__scopeId","data-v-44f386f5"]]),c_={class:"timeline-status-bar border-top p-2 bg-light"},u_={class:"d-flex justify-content-end"},d_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=me();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),p("div",c_,[s("div",u_,[s("button",{class:Z(["btn btn-sm",ts(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+E(ts(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},m_=te(d_,[["__scopeId","data-v-891c73db"]]),p_={class:"comm-composer border-top p-3"},f_={key:0,class:"d-flex gap-2 mb-2"},v_={class:"flex-grow-1"},h_=["disabled"],__={label:"Minions"},g_=["value"],b_={style:{"min-width":"150px"}},y_=["disabled"],$_={class:"d-flex gap-2 align-items-end position-relative"},w_={class:"flex-grow-1 position-relative"},E_=["disabled"],C_=["onClick","onMouseenter"],S_=["disabled"],k_={key:0},T_={key:1},x_={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=Ft(),o=ae(),i=we(),a=L(""),l=L("task"),r=L(""),d=L(!1),h=L(window.innerWidth),c=L(!1),$=L([]),_=L(0),v=L(-1),y=L(null),g=L(null),f=b(()=>h.value<768),m=b(()=>{const B=i.projects.get(e.legionId);return!B||!B.session_ids?[]:B.session_ids.map(S=>o.sessions.get(S)).filter(S=>S&&S.is_minion)}),w=b(()=>a.value&&r.value.trim().length>0);function C(B){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[B.state]||"â—‹"}function M(B){return B.is_minion&&B.role?`${B.name} (${B.role})`:B.name}function N(){const B=y.value;if(!B)return;B.style.height="auto";const S=Math.min(B.scrollHeight,parseInt(getComputedStyle(B).maxHeight));B.style.height=S+"px"}function I(){const B=y.value;if(!B)return;N();const S=r.value,T=B.selectionStart,V=S.substring(0,T),A=V.lastIndexOf("#");if(A===-1){c.value=!1;return}const x=V.substring(A+1).toLowerCase();if(x.includes(" ")){c.value=!1;return}const j=m.value.filter(U=>U.name.toLowerCase().includes(x)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(j.length===0){c.value=!1;return}$.value=j,_.value=0,v.value=A,c.value=!0}function k(){if(!g.value)return;const B=g.value,S=B.children[_.value];if(!S)return;const T=S.offsetTop,V=S.offsetHeight,A=B.scrollTop,x=B.clientHeight;T<A?B.scrollTop=T:T+V>A+x&&(B.scrollTop=T+V-x)}function O(B){if(!c.value){if(B.key==="Enter"&&!B.shiftKey){if(f.value)return;w.value&&(B.preventDefault(),z())}return}if(B.key==="ArrowDown")B.preventDefault(),_.value=(_.value+1)%$.value.length,k();else if(B.key==="ArrowUp")B.preventDefault(),_.value=_.value===0?$.value.length-1:_.value-1,k();else if(B.key==="Enter"){B.preventDefault();const S=$.value[_.value];S&&P(S)}else B.key==="Escape"&&(c.value=!1)}function P(B){const S=y.value;if(!S)return;const T=r.value,V=S.selectionStart,A=T.substring(0,v.value)+"#"+B.name+" "+T.substring(V);r.value=A;const x=v.value+B.name.length+2;setTimeout(()=>{S.setSelectionRange(x,x),S.focus()},0),c.value=!1}async function z(){if(!(!w.value||d.value)){d.value=!0;try{const[B,S]=a.value.split(":"),T={comm_type:l.value,content:r.value.trim()};B==="minion"&&(T.to_minion_id=S),await t.sendComm(e.legionId,T),r.value="",N()}catch(B){console.error("Failed to send comm:",B),alert(`Failed to send comm: ${B.message}`)}finally{d.value=!1}}}function G(){h.value=window.innerWidth}return pe(()=>{window.addEventListener("resize",G)}),he(()=>{window.removeEventListener("resize",G)}),le(c,B=>{if(B){const S=T=>{T.target.closest(".comm-composer")||(c.value=!1,document.removeEventListener("click",S))};setTimeout(()=>document.addEventListener("click",S),0)}}),(B,S)=>(u(),p("div",p_,[n.hideRecipientSelector?D("",!0):(u(),p("div",f_,[s("div",v_,[oe(s("select",{"onUpdate:modelValue":S[0]||(S[0]=T=>a.value=T),class:"form-select form-select-sm",disabled:d.value},[S[3]||(S[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",__,[(u(!0),p(re,null,ue(m.value,T=>(u(),p("option",{key:T.session_id,value:`minion:${T.session_id}`},E(C(T))+" "+E(M(T)),9,g_))),128))])],8,h_),[[Pe,a.value]])]),s("div",b_,[oe(s("select",{"onUpdate:modelValue":S[1]||(S[1]=T=>l.value=T),class:"form-select form-select-sm",disabled:d.value},[...S[4]||(S[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,y_),[[Pe,l.value]])])])),s("div",$_,[s("div",w_,[oe(s("textarea",{ref_key:"contentTextarea",ref:y,"onUpdate:modelValue":S[2]||(S[2]=T=>r.value=T),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:d.value,onInput:I,onKeydown:O},null,40,E_),[[de,r.value]]),c.value?(u(),p("div",{key:0,ref_key:"autocompleteDropdown",ref:g,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),p(re,null,ue($.value,(T,V)=>(u(),p("div",{key:T.id,class:Z(["autocomplete-item px-2 py-1",{"bg-light":V===_.value}]),onClick:A=>P(T),onMouseenter:A=>_.value=V},E(T.type==="minion"?C(T):"#ï¸âƒ£")+" "+E(T.name)+E(T.role?` (${T.role})`:""),43,C_))),128))],512)):D("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!w.value||d.value,onClick:z},[d.value?(u(),p("span",k_,[...S[5]||(S[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ne(" Sending... ",-1)])])):(u(),p("span",T_,"Send"))],8,S_)])])]))}},A_=te(x_,[["__scopeId","data-v-4b63cd3b"]]),M_={class:"message-content-column-full"},O_=["aria-expanded"],D_={class:"comm-sender-recipient"},N_={class:"comm-badge-summary"},L_=["title"],I_={class:"comm-summary-text text-muted ms-2"},P_=["aria-label"],j_={key:0,class:"comm-content-body"},R_=["innerHTML"],H_="ffffffff-ffff-ffff-ffff-ffffffffffff",W_={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;tt.setOptions({breaks:!0,gfm:!0});const t=L(!1);function o(){t.value=!t.value}const i=b(()=>e.comm.from_minion_id===H_),a=b(()=>{const h=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${h.toLocaleString()}`}),l=b(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),r=b(()=>{if(e.comm.summary)return e.comm.summary;const h=e.comm.content||"";return h.length>100?h.substring(0,100)+"...":h}),d=b(()=>{const h=e.comm.content||"";let c=tt.parse(h);return c=c.replace(/\n</g,"<"),c=c.replace(/\n+$/,""),as.sanitize(c)});return(h,c)=>(u(),p("div",{class:Z(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",M_,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",D_,[s("strong",{class:Z({"system-sender":i.value})},E(n.senderName),3),n.recipientName?(u(),p(re,{key:0},[c[0]||(c[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,E(n.recipientName),1)],64)):D("",!0)]),s("div",N_,[s("span",{class:Z(["badge",l.value]),title:a.value},E(n.comm.comm_type),11,L_),s("span",I_,E(r.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},E(t.value?"â–¾":"â–¸"),9,P_)],8,O_),t.value?(u(),p("div",j_,[s("div",{class:"message-text",innerHTML:d.value},null,8,R_)])):D("",!0)])],2))}},V_=te(W_,[["__scopeId","data-v-28513f64"]]),F_={class:"timeline-view d-flex flex-column h-100"},U_={key:0,class:"text-center text-muted"},B_={key:1,class:"text-center text-danger"},q_={key:2,class:"text-center text-muted"},z_={key:3,class:"comm-list"},K_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Ft();we();const o=ae(),i=ze(),a=me(),l=L(!0),r=L(null),d=L(null),h=b(()=>t.currentComms);function c(f){return f.from_user?"You":f.from_minion_id?f.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(f.from_minion_id)?.name||"Unknown":"Unknown"}function $(f){return f.to_user?"You":f.to_minion_id?o.sessions.get(f.to_minion_id)?.name||"Unknown":"All"}async function _(){a.autoScrollEnabled&&(await Ps(),d.value&&(d.value.scrollTop=d.value.scrollHeight))}async function v(){l.value=!0,r.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await Ps(),await _(),setTimeout(()=>{_()},100)}catch(f){console.error("Failed to load timeline:",f),f.response?r.value=`${f.message} (${f.response.status})`:r.value=f.message||"Unknown error"}finally{l.value=!1}}function y(){i.connectLegion(e.legionId)}function g(){i.disconnectLegion()}return le(()=>h.value.length,()=>{_()}),pe(()=>{o.currentSessionId=null,v(),y(),setTimeout(()=>{_()},100)}),he(()=>{g()}),(f,m)=>(u(),p("div",F_,[ce(r_,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:d,class:"timeline-messages flex-grow-1 overflow-auto"},[l.value?(u(),p("div",U_,[...m[0]||(m[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ne(" Loading timeline... ",-1)])])):r.value?(u(),p("div",B_," Failed to load timeline: "+E(r.value),1)):h.value.length===0?(u(),p("div",q_," No messages yet. Minions will appear here once they start communicating. ")):(u(),p("div",z_,[(u(!0),p(re,null,ue(h.value,w=>(u(),ge(V_,{key:w.comm_id,comm:w,"sender-name":c(w),"recipient-name":$(w)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ce(A_,{"legion-id":n.legionId},null,8,["legion-id"]),ce(m_,{"legion-id":n.legionId},null,8,["legion-id"])]))}},G_=te(K_,[["__scopeId","data-v-b6752179"]]),Y_={class:"hierarchy-header border-bottom p-3"},J_={class:"d-flex justify-content-between align-items-center"},X_={class:"project-name"},Q_={class:"fleet-controls d-flex gap-2"},Z_=["disabled"],eg={key:0,class:"spinner-border spinner-border-sm me-1"},tg=["disabled"],sg={key:0,class:"spinner-border spinner-border-sm me-1"},ng={__name:"HierarchyHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=we(),o=ae(),i=me(),a=b(()=>t.projects.get(e.legionId)),l=b(()=>a.value?.name||"Legion"),r=b(()=>Array.from(o.sessions.values()).filter(y=>y.is_minion&&y.project_id===e.legionId)),d=b(()=>r.value.filter(v=>v.state==="active")),h=b(()=>r.value.length===0||d.value.length===0),c=b(()=>r.value.length===0);function $(){i.showModal("fleet-control",{legionId:e.legionId,operation:"halt",activeMinionsCount:d.value.length,totalMinionsCount:r.value.length})}function _(){i.showModal("fleet-control",{legionId:e.legionId,operation:"resume",activeMinionsCount:d.value.length,totalMinionsCount:r.value.length})}return(v,y)=>(u(),p("div",Y_,[s("div",J_,[s("div",null,[s("div",X_,E(l.value),1),y[0]||(y[0]=s("div",{class:"view-name"},"Minion Hierarchy",-1))]),s("div",Q_,[s("button",{class:"btn btn-sm btn-outline-warning",disabled:h.value||v.isOperating,onClick:$,title:"Emergency halt all active minions"},[v.isOperating&&v.lastOperation==="halt"?(u(),p("span",eg)):D("",!0),y[1]||(y[1]=ne(" Halt All ",-1))],8,Z_),s("button",{class:"btn btn-sm btn-outline-success",disabled:c.value||v.isOperating,onClick:_,title:"Resume all minions"},[v.isOperating&&v.lastOperation==="resume"?(u(),p("span",sg)):D("",!0),y[2]||(y[2]=ne(" Resume All ",-1))],8,tg)])])]))}},og=te(ng,[["__scopeId","data-v-7d7fd660"]]),ig={class:"hierarchy-status-bar border-top p-2 bg-light"},ag={__name:"HierarchyStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,t)=>(u(),p("div",ig,[...t[0]||(t[0]=[s("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},lg=te(ag,[["__scopeId","data-v-d43e967b"]]),rg={class:"minion-info flex-grow-1"},cg={class:"minion-name"},ug={key:0,class:"me-1"},dg={key:1,class:"badge bg-secondary ms-2"},mg={key:0,class:"latest-activity text-muted"},pg={key:0,class:"activity-prefix"},fg=["title"],vg={key:1,class:"activity-time ms-1"},hg={key:1,class:"latest-activity text-muted"},_g={class:"activity-prefix"},gg=["title"],bg={key:2,class:"latest-activity text-muted fst-italic small"},yg={class:"node-row"},$g={class:"node-left"},wg={key:0,class:"me-2"},Eg={key:1,class:"badge bg-secondary ms-2"},Cg={class:"node-right"},Sg={key:0,class:"latest-message-preview"},kg={key:0,class:"message-prefix"},Tg=["title"],xg={key:1,class:"message-time ms-1"},Ag={key:1,class:"last-comm-preview"},Mg={class:"comm-direction"},Og=["title"],Dg={key:2,class:"text-muted fst-italic small"},Ng={class:"node-actions"},Lg={key:2,class:"minion-children"},Ig={key:1,class:"text-danger small ms-4"},Pg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=ae(),a=xe(),l=me(),r=b(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),d=b(()=>{if(!t.minionData||!t.minionData.id)return null;const P=a.messagesBySession.get(t.minionData.id);if(!P||P.length===0)return null;for(let z=P.length-1;z>=0;z--){const G=P[z];if(G.type!=="result"&&!(G.type==="user"&&G.content&&G.content.startsWith("Tool results:"))&&!(G.type==="system"&&G.content==="System message")&&!(G.type==="assistant"&&G.content==="Assistant response")&&(G.type==="user"||G.type==="assistant"||G.type==="system"))return{content:G.content,type:G.type,timestamp:G.timestamp}}return null}),h=b(()=>{if(!t.minionData)return null;const P={...t.minionData};return r.value&&(P.state=r.value.state,P.is_processing=r.value.is_processing),d.value&&(P.latest_message=d.value.content,P.latest_message_type=d.value.type,P.latest_message_time=d.value.timestamp),P}),c=b(()=>t.level*24),$=b(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),_=b(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),v=b(()=>t.minionData&&t.minionData.is_overseer&&_.value),y=b(()=>{const P=h.value;return P?P.state==="paused"&&P.is_processing?"pending-prompt":P.is_processing?"processing":P.state||"created":"created"}),g=b(()=>{const P=y.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[P]||"status-dot-grey"}),f=b(()=>{const P=y.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[P]||"#d3d3d3"}}),m=b(()=>{const P=h.value;if(!P||!P.latest_message_type)return"";const z=P.latest_message_type;return z==="user"?"User -->:":z==="system"?"System:":""}),w=b(()=>{const P=h.value;if(!P||!P.latest_message)return"";const z=P.latest_message,G=150;return z.length>G?z.slice(0,G)+"...":z}),C=b(()=>{const P=h.value;if(!P||!P.latest_message_time)return"";try{const z=Date.now();let G;if(typeof P.latest_message_time=="number"?G=P.latest_message_time<3250368e4?P.latest_message_time*1e3:P.latest_message_time:G=new Date(P.latest_message_time).getTime(),isNaN(G)||G<9466848e5||G>z+6e4)return console.warn("Invalid timestamp for relative time calculation:",P.latest_message_time,"parsed to:",G),"";const B=z-G;if(B<0)return"just now";const S=Math.floor(B/6e4),T=Math.floor(S/60),V=Math.floor(T/24);return V>0?`${V}d ago`:T>0?`${T}h ago`:S>0?`${S}m ago`:"just now"}catch(z){return console.error("Error calculating relative time:",z,P.latest_message_time),""}});function M(P){return P.to_user?"User":P.to_minion_name?P.to_minion_name:"unknown"}function N(P){const z=P.summary||P.content||"";return z.length>150?z.substring(0,150)+"...":z}function I(){o("minion-click",t.minionData.id)}function k(){const P=i.sessions.get(t.minionData.id);P&&l.showModal("edit-session",{session:P})}function O(){const P=i.sessions.get(t.minionData.id);P&&l.showModal("manage-session",{session:P})}return(P,z)=>{const G=so("MinionTreeNode",!0);return n.minionData?(u(),p("div",{key:0,class:"minion-tree-node",style:Ze({marginLeft:`${c.value}px`})},[n.layout==="sidebar"?(u(),p("div",{key:0,class:Z(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:I},[s("div",{class:Z(["status-dot me-2",g.value]),style:Ze(f.value)},null,6),s("div",rg,[s("div",cg,[v.value?(u(),p("span",ug,"ðŸ‘‘")):D("",!0),s("strong",null,E(n.minionData.name),1),v.value?(u(),p("span",dg,E(n.minionData.children.length)+" "+E(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),n.minionData.latest_message?(u(),p("div",mg,[m.value?(u(),p("span",pg,E(m.value),1)):D("",!0),s("span",{class:"activity-content",title:n.minionData.latest_message},E(w.value),9,fg),C.value?(u(),p("span",vg,"("+E(C.value)+")",1)):D("",!0)])):n.minionData.last_comm?(u(),p("div",hg,[s("span",_g,[z[1]||(z[1]=ne("â†’ ",-1)),s("strong",null,E(M(n.minionData.last_comm)),1),z[2]||(z[2]=ne(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},E(N(n.minionData.last_comm)),9,gg)])):(u(),p("div",bg," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(k,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(O,["stop"])}," âš™ï¸ ")],2)):(u(),p("div",{key:1,class:Z(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:I},[s("div",yg,[s("div",$g,[s("div",{class:Z(["status-dot me-2",g.value]),style:Ze(f.value)},null,6),v.value?(u(),p("span",wg,"ðŸ‘‘")):D("",!0),s("strong",null,E(n.minionData.name),1),v.value?(u(),p("span",Eg,E(n.minionData.children.length)+" "+E(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),s("div",Cg,[n.minionData.latest_message?(u(),p("div",Sg,[m.value?(u(),p("span",kg,E(m.value),1)):D("",!0),s("span",{class:"message-content",title:n.minionData.latest_message},E(w.value),9,Tg),C.value?(u(),p("span",xg,"("+E(C.value)+")",1)):D("",!0)])):n.minionData.last_comm?(u(),p("div",Ag,[s("span",Mg,[z[3]||(z[3]=ne("â†’ ",-1)),s("strong",null,E(M(n.minionData.last_comm)),1),z[4]||(z[4]=ne(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},E(N(n.minionData.last_comm)),9,Og)])):(u(),p("div",Dg," No activity yet "))]),s("div",Ng,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(k,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(O,["stop"])}," âš™ï¸ ")])])],2)),_.value?(u(),p("div",Lg,[(u(!0),p(re,null,ue(n.minionData.children,B=>(u(),ge(G,{key:B.id,"minion-data":B,level:n.level+1,layout:n.layout,onMinionClick:z[0]||(z[0]=S=>P.$emit("minion-click",S))},null,8,["minion-data","level","layout"]))),128))])):D("",!0)],4)):(u(),p("div",Ig," âš  Minion data is missing "))}}},ci=te(Pg,[["__scopeId","data-v-0b208a9a"]]),jg={class:"modal-dialog modal-dialog-centered"},Rg={class:"modal-content"},Hg={class:"modal-header"},Wg={class:"modal-title",id:"fleetControlModalLabel"},Vg={class:"modal-body"},Fg={key:0,class:"text-center py-4"},Ug={class:"text-muted"},Bg={key:1},qg={class:"text-muted"},zg={key:2},Kg={class:"text-muted"},Gg={key:3},Yg={class:"text-muted"},Jg={class:"modal-footer"},Xg={key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},Qg={__name:"FleetControlModal",setup(n){const e=me(),t=Ft(),o=L(!1),i=L(""),a=L(null),l=L(null),r=L(null);let d=null;const h=L(null),c=L(0),$=L(0),_=b(()=>l.value?l.value.type==="success"?"Success":"Error":a.value==="halt"?"Emergency Halt All Minions":a.value==="resume"?"Resume All Minions":"Fleet Control");pe(()=>{r.value&&(d=new ot(r.value),r.value.addEventListener("hidden.bs.modal",()=>{a.value=null,l.value=null,o.value=!1}))}),he(()=>{d&&d.dispose()}),le(()=>e.currentModal,m=>{if(!m||m.name!=="fleet-control")return;const w=m.data;w&&(h.value=w.legionId,c.value=w.activeMinionsCount||0,$.value=w.totalMinionsCount||0,a.value=w.operation,l.value=null,d&&d.show())});function v(){a.value=null,d&&d.hide()}async function y(){a.value==="halt"?await g():a.value==="resume"&&await f()}async function g(){o.value=!0,i.value="Halting all minions...";try{const m=await t.haltAll(h.value),w=m.failed_minions&&m.failed_minions.length>0?` Failed to halt ${m.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Halt Complete",message:`Halted ${m.halted_count} of ${m.total_minions} minion(s).${w}`}}catch(m){console.error("Failed to halt all minions:",m),l.value={type:"error",title:"Halt Failed",message:`Failed to halt minions: ${m.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}async function f(){o.value=!0,i.value="Resuming all minions...";try{const m=await t.resumeAll(h.value),w=m.failed_minions&&m.failed_minions.length>0?` Failed to resume ${m.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Resume Complete",message:`Resumed ${m.resumed_count} of ${m.total_minions} minion(s).${w}`}}catch(m){console.error("Failed to resume all minions:",m),l.value={type:"error",title:"Resume Failed",message:`Failed to resume minions: ${m.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}return(m,w)=>(u(),p("div",{class:"modal fade",id:"fleetControlModal",tabindex:"-1","aria-labelledby":"fleetControlModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",jg,[s("div",Rg,[s("div",Hg,[s("h5",Wg,E(_.value),1),w[0]||(w[0]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",Vg,[o.value?(u(),p("div",Fg,[w[1]||(w[1]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Processing...")],-1)),s("p",Ug,E(i.value),1)])):l.value?(u(),p("div",Bg,[s("div",{class:Z(["alert mb-3",l.value.type==="success"?"alert-success":"alert-danger"])},[s("strong",null,E(l.value.title),1)],2),s("p",qg,E(l.value.message),1)])):a.value==="halt"?(u(),p("div",zg,[w[4]||(w[4]=s("div",{class:"alert alert-warning mb-3"},[s("strong",null,"âš ï¸ Emergency Halt")],-1)),s("p",Kg,[w[2]||(w[2]=ne(" Are you sure you want to halt all ",-1)),s("strong",null,E(c.value),1),w[3]||(w[3]=ne(" active minion(s) in this legion? ",-1))]),w[5]||(w[5]=s("p",{class:"text-muted"}," This will interrupt their current processing. Minions will remain in ACTIVE state but will stop processing. ",-1))])):a.value==="resume"?(u(),p("div",Gg,[w[8]||(w[8]=s("div",{class:"alert alert-info mb-3"},[s("strong",null,"Resume All Minions")],-1)),s("p",Yg,[w[6]||(w[6]=ne(' This will send "continue" to all ',-1)),s("strong",null,E($.value),1),w[7]||(w[7]=ne(" minion(s) in this legion. ",-1))]),w[9]||(w[9]=s("p",{class:"text-muted"}," Minions will resume processing from where they were interrupted. ",-1))])):D("",!0)]),s("div",Jg,[l.value?(u(),p("button",Xg,"OK")):a.value&&!o.value?(u(),p(re,{key:1},[s("button",{type:"button",class:"btn btn-secondary",onClick:v},"Cancel"),s("button",{type:"button",class:Z(["btn",a.value==="halt"?"btn-warning":"btn-success"]),onClick:y},E(a.value==="halt"?"Halt All":"Resume All"),3)],64)):D("",!0)])])])],512))}},Zg=te(Qg,[["__scopeId","data-v-53a63f8d"]]),eb={class:"hierarchy-view d-flex flex-column h-100"},tb={class:"hierarchy-tree-container flex-grow-1 overflow-auto p-3"},sb={key:0,class:"text-center py-5"},nb={key:1,class:"alert alert-danger"},ob={class:"mb-0"},ib={key:2,class:"hierarchy-tree"},ab={class:"user-root-node mb-3 border rounded bg-white"},lb={class:"node-row"},rb={class:"node-left"},cb={key:0,class:"badge bg-primary ms-2"},ub={class:"node-right"},db={key:0,class:"last-comm-preview"},mb={class:"comm-direction"},pb=["title"],fb={key:1,class:"text-muted fst-italic"},vb={key:0,class:"alert alert-info ms-4"},hb={key:1,class:"root-minions ms-4"},_b={__name:"HierarchyView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=it(),o=we(),i=ae(),a=ze(),l=Ft(),r=L(null),d=L(!1),h=L(null),c=b(()=>r.value&&r.value.children&&r.value.children.length>0);async function $(){d.value=!0,h.value=null;try{const m=await ie.get(`/api/legions/${e.legionId}/hierarchy`);r.value=m,console.log("Loaded hierarchy:",m)}catch(m){console.error("Failed to load hierarchy:",m),h.value=m.message||"Unknown error"}finally{d.value=!1}}function _(m){t.push(`/session/${m}`)}pe(()=>{$()}),le(()=>e.legionId,()=>{$()});function v(m){return m.to_user?"User":m.to_minion_name?m.to_minion_name:"unknown"}function y(m){const w=m.summary||m.content||"";return w.length>150?w.substring(0,150)+"...":w}function g(m,w){if(m.id===w)return m;if(m.children)for(const C of m.children){const M=g(C,w);if(M)return M}return null}function f(m){if(r.value){if(m.from_minion_id){const w=g(r.value,m.from_minion_id);w&&w.type==="minion"&&(w.last_comm=m,console.log(`Updated minion ${w.name} last_comm`))}m.from_user&&r.value.type==="user"&&(r.value.last_comm=m,console.log("Updated user last_comm"))}}return pe(()=>{i.currentSessionId=null,$(),l.setCurrentLegion(e.legionId),a.connectLegion(e.legionId),le(()=>i.sessions,m=>{if(r.value){for(const[w,C]of m)if(C.is_minion&&C.project_id===e.legionId){const M=g(r.value,w);M&&M.type==="minion"&&(M.state!==C.state&&(M.state=C.state,console.log(`Updated minion ${M.name} state to ${C.state}`)),M.is_processing!==C.is_processing&&(M.is_processing=C.is_processing,console.log(`Updated minion ${M.name} is_processing to ${C.is_processing}`)),M.latest_message!==C.latest_message&&(M.latest_message=C.latest_message,M.latest_message_type=C.latest_message_type,M.latest_message_time=C.latest_message_time,console.log(`Updated minion ${M.name} latest_message`)))}}},{deep:!0}),le(()=>l.commsByLegion.get(e.legionId),m=>{if(m&&m.length>0){const w=m[m.length-1];f(w)}},{deep:!0}),le(()=>o.projects.get(e.legionId)?.session_ids?.length||0,(m,w)=>{m!==w&&(console.log(`Project session_ids changed (${w} â†’ ${m}), reloading hierarchy`),$())})}),he(()=>{console.log("HierarchyView unmounted")}),(m,w)=>(u(),p("div",eb,[ce(og,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",tb,[d.value?(u(),p("div",sb,[...w[0]||(w[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):h.value?(u(),p("div",nb,[w[1]||(w[1]=s("strong",null,"Failed to load hierarchy",-1)),s("p",ob,E(h.value),1)])):r.value?(u(),p("div",ib,[s("div",ab,[s("div",lb,[s("div",rb,[w[2]||(w[2]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,E(r.value.name),1),c.value?(u(),p("span",cb,E(r.value.children.length)+" "+E(r.value.children.length===1?"minion":"minions"),1)):D("",!0)]),s("div",ub,[r.value.last_comm?(u(),p("div",db,[s("span",mb,[w[3]||(w[3]=ne(" â†’ ",-1)),s("strong",null,E(v(r.value.last_comm)),1),w[4]||(w[4]=ne(": ",-1))]),s("span",{class:"comm-content",title:r.value.last_comm.content||""},E(y(r.value.last_comm)),9,pb)])):(u(),p("div",fb," No communications yet "))])])]),c.value?(u(),p("div",hb,[(u(!0),p(re,null,ue(r.value.children,C=>(u(),ge(ci,{key:C.id,"minion-data":C,level:1,onMinionClick:_},null,8,["minion-data"]))),128))])):(u(),p("div",vb,[...w[5]||(w[5]=[s("p",{class:"mb-2"},"No minions yet",-1),s("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):D("",!0)]),ce(lg,{"legion-id":n.legionId},null,8,["legion-id"]),ce(Zg)]))}},gb=te(_b,[["__scopeId","data-v-b67fbac2"]]),bb=[{path:"/",name:"home",component:bi},{path:"/session/:sessionId",name:"session",component:s_,props:!0},{path:"/timeline/:legionId",name:"timeline",component:G_,props:!0},{path:"/hierarchy/:legionId",name:"hierarchy",component:gb,props:!0}],yb=pi({history:fi(),routes:bb}),$b={class:"connection-indicators"},wb=["title"],Eb=["title"],Cb=["title"],Sb={__name:"ConnectionIndicator",setup(n){const e=ze();function t(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:r}=a[i];return r>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:d,retryCount:h}=r[i];let c="Disconnected";return d?c="Connected":h>0&&(c=`Reconnecting (attempt ${h})`),`${a[i]}
${l[i]}
Status: ${c}`}return(i,a)=>(u(),p("div",$b,[s("div",{class:Z(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,wb),s("div",{class:Z(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,Eb),s("div",{class:Z(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,Cb)]))}},kb=te(Sb,[["__scopeId","data-v-d35b07c8"]]),Tb={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},xb={class:"d-flex align-items-center gap-2"},Ab={__name:"AppHeader",setup(n){const e=me();function t(){e.toggleSidebar()}return(o,i)=>(u(),p("header",Tb,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",xb,[ce(kb)])]))}},Mb={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Ob={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Db=["title"],Nb={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=b(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(r){return r.state==="paused"&&r.is_processing?"pending-prompt":r.is_processing?"processing":r.state}function i(r){const d=o(r);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[d]||"#d3d3d3"}function a(r){const d=o(r);return d==="starting"||d==="processing"||d==="pending-prompt"}function l(r){const d=o(r),h=d.charAt(0).toUpperCase()+d.slice(1),c=r.name||"Unnamed Session",$=r.is_minion&&r.role?` (${r.role})`:"";return`${c}${$}: ${h}`}return(r,d)=>(u(),p("div",Mb,[!n.sessions||n.sessions.length===0?(u(),p("div",Ob)):(u(!0),p(re,{key:1},ue(n.sessions,h=>(u(),p("div",{key:h.session_id,class:Z(["progress-bar",{"progress-bar-striped progress-bar-animated":a(h)}]),style:Ze({width:t.value,backgroundColor:i(h),cursor:"help"}),title:l(h)},null,14,Db))),128))]))}},Lb=te(Nb,[["__scopeId","data-v-a79cfeec"]]),Ib={class:"session-info flex-grow-1"},Pb={class:"session-name"},jb={key:0,class:"text-muted small ms-1"},Rb={key:0,class:"latest-activity text-muted"},Hb={key:0,class:"activity-prefix"},Wb={class:"activity-content"},Vb={key:1,class:"activity-time ms-1"},Fb={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,t=it(),o=ae(),i=we(),a=me(),l=b(()=>o.currentSessionId===e.session.session_id),r=b(()=>o.deletingSessions.has(e.session.session_id)),d=b(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),h=b(()=>{const N=d.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[N]||"status-dot-grey"}),c=b(()=>{const N=d.value,I={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},k={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:I[N]||"#d3d3d3",borderColor:k[N]||"#6c757d"}}),$=b(()=>{const N=e.session.latest_message_type;return N==="user"?"User -->:":N==="system"?"System:":""}),_=b(()=>{const N=e.session.latest_message||"",I=100;return N.length>I?N.slice(0,I)+"...":N}),v=b(()=>{if(!e.session.latest_message_time)return"";const N=Date.now(),I=new Date(e.session.latest_message_time).getTime(),k=N-I,O=Math.floor(k/6e4),P=Math.floor(O/60),z=Math.floor(P/24);return z>0?`${z}d ago`:P>0?`${P}h ago`:O>0?`${O}m ago`:"just now"});function y(){o.selectSession(e.session.session_id),t.push(`/session/${e.session.session_id}`)}function g(){a.showModal("edit-session",{session:e.session})}function f(){a.showModal("manage-session",{session:e.session})}function m(N){N.dataTransfer.effectAllowed="move",N.dataTransfer.setData("application/session-id",e.session.session_id),N.dataTransfer.setData("application/project-id",e.projectId),N.dataTransfer.setData("text/plain",e.session.session_id),N.target.classList.add("dragging")}function w(N){N.target.classList.remove("dragging")}function C(N){N.preventDefault(),N.dataTransfer.dropEffect="move";const I=N.currentTarget.getBoundingClientRect(),k=I.top+I.height/2;N.clientY<k?(N.currentTarget.classList.add("drop-above"),N.currentTarget.classList.remove("drop-below")):(N.currentTarget.classList.add("drop-below"),N.currentTarget.classList.remove("drop-above"))}function M(N){N.preventDefault(),N.currentTarget.classList.remove("drop-above","drop-below");const I=N.dataTransfer.getData("application/session-id")||N.dataTransfer.getData("text/plain"),k=N.dataTransfer.getData("application/project-id");if(!I||I===e.session.session_id||k!==e.projectId)return;const O=N.currentTarget.getBoundingClientRect(),P=O.top+O.height/2,z=N.clientY<P,G=i.getProject(e.projectId);if(!G||!G.session_ids)return;const B=[...G.session_ids],S=B.indexOf(e.session.session_id),T=B.indexOf(I);if(S===-1||T===-1)return;const V=[...B],[A]=V.splice(T,1);let x=z?S:S+1;T<S&&x--,V.splice(x,0,A),i.reorderSessionsInProject(e.projectId,V)}return(N,I)=>(u(),p("div",{class:Z(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:l.value,"session-deleting":r.value}]),style:{cursor:"pointer"},draggable:"true",onClick:y,onDragstart:m,onDragend:w,onDragover:C,onDrop:M},[s("div",{class:Z(["status-dot me-2",h.value]),style:Ze(c.value)},null,6),s("div",Ib,[s("div",Pb,[s("span",null,E(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(u(),p("span",jb,"("+E(n.session.role)+")",1)):D("",!0)]),n.session.latest_message?(u(),p("div",Rb,[$.value?(u(),p("span",Hb,E($.value),1)):D("",!0),s("span",Wb,E(_.value),1),v.value?(u(),p("span",Vb,"("+E(v.value)+")",1)):D("",!0)])):D("",!0)]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit session",onClick:_e(g,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:_e(f,["stop"])}," âš™ï¸ ")],34))}},Ub=te(Fb,[["__scopeId","data-v-1102489c"]]),Bb=["data-project-id"],qb=["id"],zb=["aria-expanded","aria-controls","onKeydown"],Kb={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Gb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Yb={class:"fw-semibold",style:{"flex-shrink":"0"}},Jb={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Xb={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Qb=["title"],Zb=["title"],ey=["id","aria-labelledby"],ty={class:"accordion-body p-0"},sy={class:"list-group list-group-flush"},ny={class:"minion-hierarchy-container"},oy={key:0,class:"text-center py-2"},iy={key:1},ay={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=it(),o=we(),i=ae(),a=me(),l=L(e.project.is_expanded||!1),r=L(null),d=L(!1);let h=null;const c=b(()=>o.formatPath(e.project.working_directory)),$=b(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(S=>i.getSession(S)).filter(S=>S!=null)),_=b(()=>$.value.some(S=>S.is_minion)),v=b(()=>{const S=t.currentRoute.value;return S.name==="timeline"&&S.params.legionId===e.project.project_id}),y=b(()=>{const S=t.currentRoute.value;return S.name==="hierarchy"&&S.params.legionId===e.project.project_id});function g(S){const T=window.bootstrap;if(!T)return;const V=document.getElementById(`collapse-${e.project.project_id}`);if(!V)return;T.Collapse.getOrCreateInstance(V).toggle()}function f(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function m(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const S=i.currentSessionId;S&&i.getSession(S)&&e.project.session_ids?.includes(S)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function w(){a.showModal("edit-project",{project:e.project})}function C(){a.showModal("create-minion",{project:e.project})}function M(){t.push(`/timeline/${e.project.project_id}`)}function N(){t.push(`/hierarchy/${e.project.project_id}`)}async function I(){d.value=!0;try{const S=await ie.get(`/api/legions/${e.project.project_id}/hierarchy`);r.value=S}catch(S){console.error("Failed to load minion hierarchy:",S),r.value=null}finally{d.value=!1}}function k(S){t.push(`/session/${S}`)}function O(S,T){if(S&&S.id===T)return S;if(S&&S.children)for(const V of S.children){const A=O(V,T);if(A)return A}return null}le(l,S=>{S&&I()}),pe(()=>{h=le(()=>i.sessions,S=>{if(!(!r.value||!l.value)){for(const[T,V]of S)if(V.is_minion&&V.project_id===e.project.project_id){const A=O(r.value,T);A&&A.type==="minion"&&(A.state!==V.state&&(A.state=V.state),A.is_processing!==V.is_processing&&(A.is_processing=V.is_processing),A.latest_message!==V.latest_message&&(A.latest_message=V.latest_message,A.latest_message_type=V.latest_message_type,A.latest_message_time=V.latest_message_time))}}},{deep:!0}),le(()=>i.sessions.size,(S,T)=>{if(l.value&&(S>T&&Array.from(i.sessions.values()).some(x=>x.is_minion&&x.project_id===e.project.project_id&&(!r.value||!O(r.value,x.session_id)))&&(console.log("New minion detected, reloading hierarchy"),I()),S<T&&r.value)){const V=i.sessions,A=x=>x.type==="minion"&&!V.has(x.id)?!0:x.children?x.children.some(j=>A(j)):!1;A(r.value)&&(console.log("Minion deletion detected, reloading hierarchy"),I())}}),l.value&&I()}),he(()=>{h&&h()});function P(S){S.dataTransfer.effectAllowed="move",S.dataTransfer.setData("application/project-id",e.project.project_id),S.dataTransfer.setData("text/plain",e.project.project_id),S.target.classList.add("dragging")}function z(S){S.target.classList.remove("dragging")}function G(S){S.preventDefault(),S.dataTransfer.dropEffect="move";const T=S.currentTarget.getBoundingClientRect(),V=T.top+T.height/2;S.clientY<V?(S.currentTarget.classList.add("drop-above"),S.currentTarget.classList.remove("drop-below")):(S.currentTarget.classList.add("drop-below"),S.currentTarget.classList.remove("drop-above"))}function B(S){S.preventDefault(),S.currentTarget.classList.remove("drop-above","drop-below");const T=S.dataTransfer.getData("application/project-id")||S.dataTransfer.getData("text/plain");if(!T||T===e.project.project_id)return;const V=S.currentTarget.getBoundingClientRect(),A=V.top+V.height/2,x=S.clientY<A,j=o.orderedProjects,U=j.findIndex(fe=>fe.project_id===e.project.project_id),Y=j.findIndex(fe=>fe.project_id===T);if(U===-1||Y===-1)return;const Q=[...j],[K]=Q.splice(Y,1);let H=x?U:U+1;Y<U&&H--,Q.splice(H,0,K);const J=Q.map(fe=>fe.project_id);o.reorderProjects(J)}return(S,T)=>(u(),p("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:P,onDragend:z,onDragover:G,onDrop:B},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:Z(["accordion-button bg-white p-2",{collapsed:!l.value}]),role:"button",tabindex:"0","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:g,onKeydown:[Nt(_e(g,["prevent"]),["enter"]),Nt(_e(g,["prevent"]),["space"])]},[s("div",Kb,[s("div",Gb,[s("div",Yb,[_.value?(u(),p("span",Jb,"ðŸ›")):D("",!0),ne(" "+E(n.project.name),1)]),s("div",Xb,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:_e(w,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:_.value?"Create minion":"Add session or minion",type:"button",onClick:_e(C,["stop"])}," âž• ",8,Qb)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},E(c.value),9,Zb)])],42,zb)],8,qb),ce(Lb,{project:n.project,sessions:$.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:Z(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:f,onHidden:m},[s("div",ty,[s("div",sy,[_.value?(u(),p("div",{key:0,class:Z(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:v.value}]),style:{cursor:"pointer"},onClick:M},[...T[0]||(T[0]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):D("",!0),_.value?(u(),p("div",{key:1,class:Z(["list-group-item list-group-item-action hierarchy-item d-flex align-items-center p-2",{active:y.value}]),style:{cursor:"pointer"},onClick:N},[...T[1]||(T[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),s("span",{class:"fw-semibold"},"Hierarchy"),s("small",{class:"text-muted ms-2"},"(Minion Tree)")],-1)])],2)):D("",!0),s("div",ny,[d.value?(u(),p("div",oy,[...T[2]||(T[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value&&r.value.children&&r.value.children.length>0?(u(),p("div",iy,[(u(!0),p(re,null,ue(r.value.children,V=>(u(),ge(ci,{key:V.id,"minion-data":V,level:0,layout:"sidebar",onMinionClick:k},null,8,["minion-data"]))),128))])):(u(!0),p(re,{key:2},ue($.value,V=>(u(),ge(Ub,{key:V.session_id,session:V,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])])],42,ey)],40,Bb))}},ly=te(ay,[["__scopeId","data-v-fa088312"]]),ry={class:"project-list"},cy={key:0,class:"text-muted text-center py-3"},uy={__name:"ProjectList",setup(n){const e=we(),t=b(()=>e.orderedProjects);return(o,i)=>(u(),p("div",ry,[t.value.length===0?(u(),p("div",cy,' No projects yet. Click "New" to create one. ')):D("",!0),(u(!0),p(re,null,ue(t.value,a=>(u(),ge(ly,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},dy={class:"flex-grow-1 overflow-auto p-3"},my={id:"sessions-container"},py={__name:"Sidebar",setup(n){const e=me(),t=b(()=>e.sidebarCollapsed),o=b(()=>e.isMobile),i=b(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const l=L(!1);function r(c){l.value=!0,document.addEventListener("mousemove",d),document.addEventListener("mouseup",h)}function d(c){l.value&&e.setSidebarWidth(c.clientX)}function h(){l.value=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",h)}return(c,$)=>(u(),p("aside",{id:"sidebar",class:Z(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:Ze(i.value)},[s("div",dy,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),s("div",my,[ce(uy)])]),s("div",{class:"sidebar-resize-handle",onMousedown:r},null,32)],6))}},fy=te(py,[["__scopeId","data-v-d792f0f0"]]),vy={class:"modal-dialog modal-lg"},hy={class:"modal-content"},_y={class:"modal-body"},gy={class:"mb-3"},by={class:"input-group"},yy=["disabled"],$y={key:0,class:"text-center py-4"},wy={key:1,class:"alert alert-danger",role:"alert"},Ey={key:2,class:"folder-list"},Cy=["onClick","onDblclick"],Sy={class:"d-flex align-items-center flex-grow-1"},ky=["onClick"],Ty={key:1,class:"text-center text-muted py-3"},xy={class:"modal-footer"},Ay=["disabled"],My={__name:"FolderBrowserModal",setup(n){const e=me(),t=L(""),o=L(""),i=L([]),a=L(!1),l=L(""),r=L(null);let d=null,h=null;const c=b(()=>{if(!t.value)return null;const C=t.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?"/"+C.join("/"):"/")});function $(C){if(!C)return"";const M=C.split(/[\\/]/).filter(Boolean);return M.length<=2?C:".../"+M.slice(-2).join("/")}async function _(){a.value=!0,l.value="",i.value=[],o.value="";try{const C=t.value?{path:t.value}:{},M=await ie.get("/api/filesystem/browse",{params:C});M.current_path&&(t.value=M.current_path),i.value=M.directories||[]}catch(C){console.error("Failed to load directory:",C),l.value=C.message||"Failed to load directory"}finally{a.value=!1}}function v(C){o.value=C.path}function y(C){t.value=C.path,o.value="",_()}function g(){c.value&&(t.value=c.value,o.value="",_())}function f(){const C=o.value||t.value;C&&h&&h(C),d&&d.hide()}function m(){_()}function w(){i.value=[],o.value="",l.value="",h=null,e.hideModal()}return le(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&d){const M=C.data||{};t.value=M.defaultPath||M.currentPath||"",h=M.onSelect||null,d.show()}}),pe(()=>{r.value&&be(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(M=>M.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{d=new C(r.value),r.value.addEventListener("shown.bs.modal",m),r.value.addEventListener("hidden.bs.modal",w)})}),he(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",m),r.value.removeEventListener("hidden.bs.modal",w)),d&&d.dispose()}),(C,M)=>(u(),p("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",vy,[s("div",hy,[M[6]||(M[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",_y,[s("div",gy,[M[1]||(M[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",by,[oe(s("input",{type:"text",class:"form-control","onUpdate:modelValue":M[0]||(M[0]=N=>t.value=N),onKeyup:Nt(_,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[de,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:_,disabled:a.value}," ðŸ”„ Refresh ",8,yy)])]),a.value?(u(),p("div",$y,[...M[2]||(M[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(u(),p("div",wy,E(l.value),1)):(u(),p("div",Ey,[c.value?(u(),p("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:g,role:"button"},[...M[3]||(M[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):D("",!0),(u(!0),p(re,null,ue(i.value,N=>(u(),p("div",{key:N.path,class:Z(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:N.path===o.value}]),onClick:I=>v(N),onDblclick:I=>y(N),role:"button"},[s("div",Sy,[M[4]||(M[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,E(N.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:_e(I=>y(N),["stop"])}," Open ",8,ky)],42,Cy))),128)),i.value.length===0?(u(),p("div",Ty," No subdirectories found ")):D("",!0)]))]),s("div",xy,[M[5]||(M[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:f,disabled:!o.value},' Select "'+E($(o.value||t.value))+'" ',9,Ay)])])])],512))}},Oy=te(My,[["__scopeId","data-v-0d61ed46"]]),Dy={class:"modal-dialog"},Ny={class:"modal-content"},Ly={class:"modal-body"},Iy={class:"mb-3"},Py={key:0,class:"invalid-feedback"},jy={class:"mb-3"},Ry={class:"input-group"},Hy={key:0,class:"invalid-feedback"},Wy={class:"mb-3 form-check"},Vy={key:0,class:"mb-3 ms-4"},Fy={key:1,class:"alert alert-danger",role:"alert"},Uy={class:"modal-footer"},By=["disabled"],qy={key:0,class:"spinner-border spinner-border-sm me-2"},zy={__name:"ProjectCreateModal",setup(n){const e=we(),t=ae(),o=me(),i=L({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),a=L({name:"",workingDirectory:""}),l=L(!1),r=L(""),d=L(null);let h=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:f=>{i.value.workingDirectory=f,a.value.workingDirectory=""}})}function $(){a.value={};let f=!0;return i.value.name.trim()||(a.value.name="Project name is required",f=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",f=!1),f}async function _(){if($()){l.value=!0,r.value="";try{const f=await e.createProject(i.value.name,i.value.workingDirectory,!1);i.value.createSession&&await t.createSession(f.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),h&&h.hide(),v()}catch(f){console.error("Failed to create project:",f),r.value=f.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function v(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},a.value={},r.value=""}function y(){const f=document.getElementById("projectName");f&&f.focus()}function g(){v(),o.hideModal()}return le(()=>o.currentModal,f=>{f?.name==="create-project"&&h&&h.show()}),pe(()=>{d.value&&be(async()=>{const{default:f}=await import("./modal-BK1Vt_in.js").then(m=>m.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{h=new f(d.value),d.value.addEventListener("shown.bs.modal",y),d.value.addEventListener("hidden.bs.modal",g)})}),he(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",y),d.value.removeEventListener("hidden.bs.modal",g)),h&&h.dispose()}),(f,m)=>(u(),p("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",Dy,[s("div",Ny,[m[11]||(m[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Ly,[s("form",{onSubmit:_e(_,["prevent"])},[s("div",Iy,[m[4]||(m[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),oe(s("input",{type:"text",class:Z(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":m[0]||(m[0]=w=>i.value.name=w),placeholder:"My Project",required:""},null,2),[[de,i.value.name]]),a.value.name?(u(),p("div",Py,E(a.value.name),1)):D("",!0)]),s("div",jy,[m[5]||(m[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Ry,[oe(s("input",{type:"text",class:Z(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":m[1]||(m[1]=w=>i.value.workingDirectory=w),placeholder:"/path/to/project",required:""},null,2),[[de,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(u(),p("div",Hy,E(a.value.workingDirectory),1)):D("",!0)]),m[6]||(m[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",Wy,[oe(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":m[2]||(m[2]=w=>i.value.createSession=w)},null,512),[[Lt,i.value.createSession]]),m[7]||(m[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),m[8]||(m[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(u(),p("div",Vy,[m[9]||(m[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),oe(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":m[3]||(m[3]=w=>i.value.sessionName=w),placeholder:"main"},null,512),[[de,i.value.sessionName]])])):D("",!0),r.value?(u(),p("div",Fy,E(r.value),1)):D("",!0)],32)]),s("div",Uy,[m[10]||(m[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:l.value},[l.value?(u(),p("span",qy)):D("",!0),ne(" "+E(l.value?"Creating...":"Create Project"),1)],8,By)])])])],512))}},Ky=te(zy,[["__scopeId","data-v-2d796d78"]]),Gy={class:"modal-dialog"},Yy={class:"modal-content"},Jy={class:"modal-body"},Xy={class:"mb-3"},Qy={key:0,class:"invalid-feedback"},Zy={class:"mb-3"},e1=["value"],t1={key:0,class:"alert alert-danger",role:"alert"},s1={class:"danger-zone"},n1={class:"text-muted small"},o1=["disabled"],i1={key:0,class:"alert alert-warning mt-3",role:"alert"},a1={class:"mb-2"},l1={class:"d-flex gap-2"},r1=["disabled"],c1={key:0,class:"spinner-border spinner-border-sm me-2"},u1=["disabled"],d1={class:"modal-footer"},m1=["disabled"],p1={key:0,class:"spinner-border spinner-border-sm me-2"},f1={__name:"ProjectEditModal",setup(n){const e=we(),t=me(),o=L(null),i=L({name:""}),a=L({name:""}),l=L(!1),r=L(!1),d=L(""),h=L(!1),c=L(null);let $=null;const _=b(()=>o.value?.session_ids?.length||0);function v(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Project name is required",C=!1),C}async function y(){if(!(!v()||!o.value)){l.value=!0,d.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(C){console.error("Failed to update project:",C),d.value=C.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function g(){if(o.value){r.value=!0,d.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(C){console.error("Failed to delete project:",C),d.value=C.message||"Failed to delete project. Please try again."}finally{r.value=!1}}}function f(){i.value={name:""},a.value={},d.value="",h.value=!1}function m(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function w(){f(),o.value=null,t.hideModal()}return le(()=>t.currentModal,C=>{if(C?.name==="edit-project"&&$){const M=C.data||{};o.value=M.project,o.value&&(i.value.name=o.value.name),$.show()}}),pe(()=>{c.value&&be(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(M=>M.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{$=new C(c.value),c.value.addEventListener("shown.bs.modal",m),c.value.addEventListener("hidden.bs.modal",w)})}),he(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",m),c.value.removeEventListener("hidden.bs.modal",w)),$&&$.dispose()}),(C,M)=>(u(),p("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",Gy,[s("div",Yy,[M[10]||(M[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Jy,[s("form",{onSubmit:_e(y,["prevent"])},[s("div",Xy,[M[3]||(M[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),oe(s("input",{type:"text",class:Z(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":M[0]||(M[0]=N=>i.value.name=N),placeholder:"My Project",required:""},null,2),[[de,i.value.name]]),a.value.name?(u(),p("div",Qy,E(a.value.name),1)):D("",!0)]),s("div",Zy,[M[4]||(M[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,e1),M[5]||(M[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),d.value?(u(),p("div",t1,E(d.value),1)):D("",!0)],32),M[8]||(M[8]=s("hr",null,null,-1)),s("div",s1,[M[6]||(M[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",n1," Deleting this project will also delete all "+E(_.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:M[1]||(M[1]=N=>h.value=!0),disabled:r.value}," ðŸ—‘ï¸ Delete Project ",8,o1)]),h.value?(u(),p("div",i1,[M[7]||(M[7]=s("strong",null,"Are you sure?",-1)),s("p",a1,' This will permanently delete the project "'+E(o.value?.name)+'" and all '+E(_.value)+" session(s). ",1),s("div",l1,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:g,disabled:r.value},[r.value?(u(),p("span",c1)):D("",!0),ne(" "+E(r.value?"Deleting...":"Yes, Delete Permanently"),1)],8,r1),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:M[2]||(M[2]=N=>h.value=!1),disabled:r.value}," Cancel ",8,u1)])])):D("",!0)]),s("div",d1,[M[9]||(M[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:l.value},[l.value?(u(),p("span",p1)):D("",!0),ne(" "+E(l.value?"Saving...":"Save Changes"),1)],8,m1)])])])],512))}},v1=te(f1,[["__scopeId","data-v-52679516"]]),h1={class:"modal-dialog modal-lg"},_1={class:"modal-content"},g1={class:"modal-header"},b1={class:"modal-title",id:"createSessionModalLabel"},y1={key:0,class:"text-muted small"},$1={class:"modal-body"},w1={class:"mb-3"},E1={key:0,class:"invalid-feedback"},C1={class:"mb-3"},S1={class:"mb-3"},k1={key:0,class:"form-text text-muted"},T1={class:"mb-3"},x1={class:"form-text d-flex justify-content-between"},A1={key:0,class:"invalid-feedback"},M1={class:"mb-3 form-check"},O1={key:0,class:"form-text text-warning"},D1={class:"mb-3"},N1={class:"mb-3 form-check"},L1={key:0,class:"alert alert-danger",role:"alert"},I1={class:"modal-footer"},P1=["disabled"],j1={key:0,class:"spinner-border spinner-border-sm me-2"},R1={__name:"SessionCreateModal",setup(n){const e=it();we();const t=ae(),o=me(),i=L(null),a=L({name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0}),l=L({name:""}),r=L(!1),d=L(""),h=L(null);let c=null;const $={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},_=b(()=>a.value.system_prompt.length),v=b(()=>_.value>6e3),y=b(()=>_.value>5500&&_.value<=6e3),g=b(()=>$[a.value.model]||null);function f(){l.value={};let N=!0;return a.value.name.trim()||(l.value.name="Session name is required",N=!1),v.value&&(N=!1),N}async function m(){if(!(!f()||!i.value)){r.value=!0,d.value="";try{const N=a.value.allowed_tools.split(",").map(O=>O.trim()).filter(O=>O.length>0),I={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,allowed_tools:N},k=await t.createSession(i.value.project_id,I);a.value.startImmediately&&await t.startSession(k.session_id),e.push(`/session/${k.session_id}`),c&&c.hide(),w()}catch(N){console.error("Failed to create session:",N),d.value=N.message||"Failed to create session. Please try again."}finally{r.value=!1}}}function w(){a.value={name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0},l.value={},d.value=""}function C(){const N=document.getElementById("sessionName");N&&N.focus()}function M(){w(),i.value=null,o.hideModal()}return le(()=>o.currentModal,N=>{if(N?.name==="create-session"&&c){const I=N.data||{};i.value=I.project,c.show()}}),pe(()=>{h.value&&be(async()=>{const{default:N}=await import("./modal-BK1Vt_in.js").then(I=>I.m);return{default:N}},__vite__mapDeps([0,1])).then(({default:N})=>{c=new N(h.value),h.value.addEventListener("shown.bs.modal",C),h.value.addEventListener("hidden.bs.modal",M)})}),he(()=>{h.value&&(h.value.removeEventListener("shown.bs.modal",C),h.value.removeEventListener("hidden.bs.modal",M)),c&&c.dispose()}),(N,I)=>(u(),p("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[s("div",h1,[s("div",_1,[s("div",g1,[s("h5",b1,[I[7]||(I[7]=ne(" Create New Session ",-1)),i.value?(u(),p("span",y1,"in "+E(i.value.name),1)):D("",!0)]),I[8]||(I[8]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",$1,[s("form",{onSubmit:_e(m,["prevent"])},[s("div",w1,[I[9]||(I[9]=s("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),oe(s("input",{type:"text",class:Z(["form-control",{"is-invalid":l.value.name}]),id:"sessionName","onUpdate:modelValue":I[0]||(I[0]=k=>a.value.name=k),placeholder:"main",required:""},null,2),[[de,a.value.name]]),l.value.name?(u(),p("div",E1,E(l.value.name),1)):D("",!0)]),s("div",C1,[I[11]||(I[11]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":I[1]||(I[1]=k=>a.value.permission_mode=k)},[...I[10]||(I[10]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Pe,a.value.permission_mode]]),I[12]||(I[12]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",S1,[I[14]||(I[14]=s("label",{for:"model",class:"form-label"},"Model",-1)),oe(s("select",{class:"form-select",id:"model","onUpdate:modelValue":I[2]||(I[2]=k=>a.value.model=k)},[...I[13]||(I[13]=[s("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),s("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),s("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),s("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Pe,a.value.model]]),g.value?(u(),p("small",k1,E(g.value.description),1)):D("",!0)]),s("div",T1,[I[15]||(I[15]=s("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),oe(s("textarea",{class:Z(["form-control",{"is-invalid":v.value}]),id:"systemPrompt","onUpdate:modelValue":I[3]||(I[3]=k=>a.value.system_prompt=k),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[de,a.value.system_prompt]]),s("div",x1,[s("span",null,E(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),s("span",{class:Z({"text-danger":v.value,"text-warning":y.value})},E(_.value)+" / 6000 chars ",3)]),v.value?(u(),p("div",A1," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):D("",!0)]),s("div",M1,[oe(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":I[4]||(I[4]=k=>a.value.override_system_prompt=k)},null,512),[[Lt,a.value.override_system_prompt]]),I[17]||(I[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),p("div",O1,[...I[16]||(I[16]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):D("",!0)]),s("div",D1,[I[18]||(I[18]=s("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),oe(s("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":I[5]||(I[5]=k=>a.value.allowed_tools=k),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[de,a.value.allowed_tools]]),I[19]||(I[19]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",N1,[oe(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":I[6]||(I[6]=k=>a.value.startImmediately=k)},null,512),[[Lt,a.value.startImmediately]]),I[20]||(I[20]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),d.value?(u(),p("div",L1,E(d.value),1)):D("",!0)],32)]),s("div",I1,[I[21]||(I[21]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:r.value},[r.value?(u(),p("span",j1)):D("",!0),ne(" "+E(r.value?"Creating...":"Create Session"),1)],8,P1)])])])],512))}},H1=te(R1,[["__scopeId","data-v-8bfe4c32"]]),W1={class:"modal-dialog"},V1={class:"modal-content"},F1={class:"modal-body"},U1={class:"mb-3"},B1={key:0,class:"invalid-feedback"},q1={class:"mb-3"},z1=["value"],K1={class:"mb-3"},G1={class:"form-control-plaintext"},Y1={class:"mb-3"},J1=["disabled"],X1={key:0,value:"bypassPermissions"},Q1={class:"form-text"},Z1={key:0,class:"text-warning"},e$={key:1},t$={key:0,class:"mb-3"},s$={class:"card"},n$={class:"card-body"},o$={key:0,class:"mb-2"},i$={key:1,class:"mb-2"},a$={key:2,class:"mt-2"},l$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},r$={key:1,class:"alert alert-danger",role:"alert"},c$={class:"modal-footer"},u$=["disabled"],d$={key:0,class:"spinner-border spinner-border-sm me-2"},m$={__name:"SessionEditModal",setup(n){const e=ae(),t=me(),o=L(null),i=L({name:"",permission_mode:"default"}),a=L({name:""}),l=L(!1),r=L(""),d=L(null);let h=null;const c=b(()=>o.value?.state==="active"||o.value?.state==="starting"),$=b(()=>o.value?.initial_permission_mode==="bypassPermissions");function _(w){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[w]||"bg-secondary"}function v(){a.value={};let w=!0;return i.value.name.trim()||(a.value.name="Session name is required",w=!1),w}async function y(){if(!(!v()||!o.value)){l.value=!0,r.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),h&&h.hide()}catch(w){console.error("Failed to update session:",w),r.value=w.message||"Failed to update session. Please try again."}finally{l.value=!1}}}function g(){i.value={name:"",permission_mode:"default"},a.value={},r.value=""}function f(){const w=document.getElementById("editSessionName");w&&(w.focus(),w.select())}function m(){g(),o.value=null,t.hideModal()}return le(()=>t.currentModal,w=>{if(w?.name==="edit-session"&&h){const C=w.data||{};o.value=C.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),h.show()}}),pe(()=>{d.value&&be(async()=>{const{default:w}=await import("./modal-BK1Vt_in.js").then(C=>C.m);return{default:w}},__vite__mapDeps([0,1])).then(({default:w})=>{h=new w(d.value),d.value.addEventListener("shown.bs.modal",f),d.value.addEventListener("hidden.bs.modal",m)})}),he(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",f),d.value.removeEventListener("hidden.bs.modal",m)),h&&h.dispose()}),(w,C)=>(u(),p("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",W1,[s("div",V1,[C[15]||(C[15]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",F1,[s("form",{onSubmit:_e(y,["prevent"])},[s("div",U1,[C[2]||(C[2]=s("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),oe(s("input",{type:"text",class:Z(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":C[0]||(C[0]=M=>i.value.name=M),placeholder:"Session Name",required:""},null,2),[[de,i.value.name]]),a.value.name?(u(),p("div",B1,E(a.value.name),1)):D("",!0)]),s("div",q1,[C[3]||(C[3]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,z1),C[4]||(C[4]=s("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),s("div",K1,[C[5]||(C[5]=s("label",{class:"form-label"},"Current State",-1)),s("div",G1,[s("span",{class:Z(["badge",_(o.value?.state)])},E(o.value?.state),3)])]),s("div",Y1,[C[9]||(C[9]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":C[1]||(C[1]=M=>i.value.permission_mode=M),disabled:!c.value},[C[6]||(C[6]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),C[7]||(C[7]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),C[8]||(C[8]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),$.value?(u(),p("option",X1,"âš ï¸ Bypass Permissions (No prompts)")):D("",!0)],8,J1),[[Pe,i.value.permission_mode]]),s("div",Q1,[c.value?(u(),p("span",e$," Controls which tool actions require permission prompts ")):(u(),p("span",Z1," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),p("div",t$,[C[13]||(C[13]=s("label",{class:"form-label"},"System Prompt Configuration",-1)),s("div",s$,[s("div",n$,[o.value?.override_system_prompt?(u(),p("div",o$,[...C[10]||(C[10]=[s("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),s("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),p("div",i$,[...C[11]||(C[11]=[s("span",{class:"badge bg-info"},"Append Mode",-1),s("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),p("div",a$,[C[12]||(C[12]=s("strong",{class:"small"},"Custom Instructions:",-1)),s("div",l$,E(o.value.system_prompt),1)])):D("",!0)])])])):D("",!0),r.value?(u(),p("div",r$,E(r.value),1)):D("",!0)],32)]),s("div",c$,[C[14]||(C[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:l.value},[l.value?(u(),p("span",d$)):D("",!0),ne(" "+E(l.value?"Saving...":"Save Changes"),1)],8,u$)])])])],512))}},p$=te(m$,[["__scopeId","data-v-c99ca17f"]]),f$={class:"modal-dialog modal-dialog-centered"},v$={class:"modal-content"},h$={class:"modal-header"},_$={class:"modal-title",id:"manageSessionModalLabel"},g$={class:"modal-body"},b$={key:0,class:"text-center py-4"},y$={class:"text-muted"},$$={key:1},w$={key:2},E$={class:"text-muted"},C$={key:3},S$={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},k$={class:"d-grid gap-2"},T$=["disabled"],x$=["disabled"],A$=["disabled"],M$=["disabled"],O$={class:"modal-footer"},D$={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},N$={__name:"SessionManageModal",setup(n){const e=it(),t=ae(),o=me(),i=ze();xe();const a=L(null),l=L(!1),r=L(""),d=L(""),h=L(null),c=L(null);let $=null;const _=b(()=>h.value==="reset"?"Reset Session":h.value==="delete"?"Delete Session":"Manage Session");function v(){h.value="reset"}function y(){h.value="delete"}function g(){h.value=null}async function f(){h.value==="reset"?await C():h.value==="delete"&&await M()}async function m(){if(a.value){l.value=!0,r.value="Restarting session...";try{const k=a.value.session_id,O=t.currentSessionId===k,P=await ie.post(`/api/sessions/${k}/restart`);if(P.success)console.log("Session restarted successfully"),O&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(k)),$&&$.hide();else{const z=P.error||P.detail||"Failed to restart session";console.error("Failed to restart session:",z),d.value=`Failed to restart session: ${z}`}}catch(k){console.error("Error restarting session:",k);const O=k.data?.detail||k.message||"Unknown error";d.value=`Error restarting session: ${O}`}finally{l.value=!1}}}async function w(){if(a.value)try{$&&$.hide(),console.log("Ending session",a.value.session_id);const k=a.value.session_id;await ie.post(`/api/sessions/${k}/terminate`),t.currentSessionId===k&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(k){console.error("Error ending session:",k),t.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function C(){if(a.value){l.value=!0,r.value="Resetting session...";try{const k=a.value.session_id,O=t.currentSessionId===k,P=await ie.post(`/api/sessions/${k}/reset`);if(P.success)console.log("Session reset successfully"),O&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(k)),$&&$.hide();else{const z=P.error||P.detail||"Failed to reset session";console.error("Failed to reset session:",z),d.value=`Failed to reset session: ${z}`,h.value=null}}catch(k){console.error("Error resetting session:",k);const O=k.data?.detail||k.message||"Unknown error";d.value=`Error resetting session: ${O}`,h.value=null}finally{l.value=!1}}}async function M(){if(a.value){l.value=!0,r.value="Deleting session...";try{const k=a.value.session_id;await t.deleteSession(k),e.currentRoute.value.params.sessionId===k&&e.push("/"),$&&$.hide()}catch(k){console.error("Error deleting session:",k);const O=k.data?.detail||k.message||"Unknown error";d.value=`Error deleting session: ${O}`,h.value=null}finally{l.value=!1}}}function N(){h.value=null,l.value=!1,r.value="",d.value=""}function I(){N(),a.value=null,o.hideModal()}return le(()=>o.currentModal,k=>{if(k?.name==="manage-session"&&$){const O=k.data||{};a.value=O.session,N(),$.show()}}),pe(()=>{c.value&&be(async()=>{const{default:k}=await import("./modal-BK1Vt_in.js").then(O=>O.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{$=new k(c.value),c.value.addEventListener("hidden.bs.modal",I)})}),he(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",I),$&&$.dispose()}),(k,O)=>(u(),p("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",f$,[s("div",v$,[s("div",h$,[s("h5",_$,E(h.value?_.value:"Manage Session"),1),O[1]||(O[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",g$,[l.value?(u(),p("div",b$,[O[2]||(O[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",y$,E(r.value),1)])):h.value==="reset"?(u(),p("div",$$,[...O[3]||(O[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):h.value==="delete"?(u(),p("div",w$,[O[6]||(O[6]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",E$,[O[4]||(O[4]=ne("This will permanently delete session ",-1)),s("strong",null,E(a.value?.name),1),O[5]||(O[5]=ne(".",-1))]),O[7]||(O[7]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(u(),p("div",C$,[d.value?(u(),p("div",S$,[O[8]||(O[8]=s("strong",null,"Error:",-1)),ne(" "+E(d.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:O[0]||(O[0]=P=>d.value="")})])):D("",!0),O[15]||(O[15]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",k$,[s("button",{class:"btn btn-outline-primary text-start",onClick:m,disabled:l.value},[...O[9]||(O[9]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,T$),s("button",{class:"btn btn-outline-secondary text-start",onClick:w,disabled:l.value},[...O[10]||(O[10]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,x$),O[13]||(O[13]=s("hr",{class:"my-2"},null,-1)),O[14]||(O[14]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:v,disabled:l.value},[...O[11]||(O[11]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,A$),s("button",{class:"btn btn-outline-danger text-start",onClick:y,disabled:l.value},[...O[12]||(O[12]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,M$)]),O[16]||(O[16]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ne(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",O$,[h.value&&!l.value?(u(),p(re,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:g},"Cancel"),s("button",{type:"button",class:Z(["btn",h.value==="delete"?"btn-danger":"btn-warning"]),onClick:f},E(h.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?D("",!0):(u(),p("button",D$,"Cancel"))])])])],512))}},L$=te(N$,[["__scopeId","data-v-a70a7063"]]),I$={class:"modal-dialog modal-dialog-centered modal-lg"},P$={class:"modal-content"},j$={class:"modal-body"},R$={key:0,class:"text-center text-muted py-4"},H$={key:1},W$={class:"mb-3"},V$={class:"font-monospace small"},F$={class:"mb-3"},U$=["value"],B$={class:"mb-3"},q$={class:"mb-3"},z$={class:"mb-3"},K$={key:0},G$={class:"d-flex flex-wrap gap-1"},Y$={key:1,class:"text-muted small"},J$={key:0,class:"mb-3"},X$={class:"d-flex flex-wrap gap-1"},Q$={key:1,class:"mb-3"},Z$={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},ew={class:"mb-3"},tw={class:"text-muted"},sw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},nw={__name:"SessionInfoModal",setup(n){const e=ae(),t=xe(),o=me(),i=L(null),a=L(!1),l=L(null);let r=null;const d={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},h=b(()=>{if(!i.value)return null;const g=e.initData.get(i.value);return g||(t.messagesBySession.get(i.value)||[]).find(w=>w.type==="system"&&(w.subtype==="init"||w.metadata?.subtype==="init")&&w.metadata?.init_data)?.metadata?.init_data||null});function c(g){return g?d[g]||g:"Default (Sonnet 4.5)"}function $(g){return typeof g=="string"?g:typeof g=="object"&&g.type==="preset"?`Preset: ${g.preset}`:JSON.stringify(g,null,2)}function _(g){g.target.select()}function v(){i.value=null,a.value=!1}function y(){v(),o.hideModal()}return le(()=>o.currentModal,g=>{if(g?.name==="session-info"&&r){const f=g.data||{};i.value=f.sessionId,a.value=!1,r.show()}}),pe(()=>{l.value&&be(async()=>{const{default:g}=await import("./modal-BK1Vt_in.js").then(f=>f.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{r=new g(l.value),l.value.addEventListener("hidden.bs.modal",y)})}),he(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",y),r&&r.dispose()}),(g,f)=>(u(),p("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",I$,[s("div",P$,[f[9]||(f[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",j$,[h.value?(u(),p("div",H$,[s("div",W$,[f[1]||(f[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",V$,E(i.value),1)]),s("div",F$,[f[2]||(f[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:h.value.cwd||"Not specified",readonly:"",onClick:_},null,8,U$)]),s("div",B$,[f[3]||(f[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,E(c(h.value.model)),1)]),s("div",q$,[f[4]||(f[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,E(h.value.permissionMode||"default"),1)]),s("div",z$,[f[5]||(f[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(h.value.allowed_tools||h.value.tools)&&(h.value.allowed_tools||h.value.tools).length>0?(u(),p("div",K$,[s("div",G$,[(u(!0),p(re,null,ue(h.value.allowed_tools||h.value.tools,m=>(u(),p("span",{key:m,class:"badge bg-secondary"},E(m),1))),128))])])):(u(),p("div",Y$,"No pre-authorized tools (will prompt for permissions)"))]),h.value.commands&&h.value.commands.length>0?(u(),p("div",J$,[f[6]||(f[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",X$,[(u(!0),p(re,null,ue(h.value.commands,m=>(u(),p("span",{key:m,class:"badge bg-info"},E(m),1))),128))])])):D("",!0),h.value.systemPrompt?(u(),p("div",Q$,[f[7]||(f[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",Z$,E($(h.value.systemPrompt)),1)])):D("",!0),s("div",ew,[s("h6",tw,[f[8]||(f[8]=ne(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:f[0]||(f[0]=m=>a.value=!a.value)},E(a.value?"Hide":"Show"),1)]),a.value?(u(),p("pre",sw,E(JSON.stringify(h.value,null,2)),1)):D("",!0)])])):(u(),p("div",R$," No session configuration data available "))]),f[10]||(f[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},ow=te(nw,[["__scopeId","data-v-b28b39b3"]]),iw={class:"modal-dialog modal-dialog-centered"},aw={class:"modal-content"},lw={class:"modal-body"},rw={class:"mb-3"},cw=["value"],uw={key:0,class:"form-text"},dw={class:"mb-3"},mw={class:"mb-3"},pw={key:0,class:"form-text text-muted"},fw={class:"mb-3"},vw={for:"minion-role",class:"form-label"},hw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},_w={key:1,class:"field-indicator modified",title:"Modified from template"},gw=["placeholder","title"],bw={class:"mb-3"},yw={for:"minion-context",class:"form-label"},$w={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ww={key:1,class:"field-indicator modified",title:"Modified from template"},Ew=["title"],Cw={class:"form-text d-flex justify-content-between"},Sw={key:0,class:"invalid-feedback"},kw={class:"mb-3 form-check"},Tw={key:0,class:"form-text text-warning"},xw={class:"mb-3"},Aw={class:"mb-3"},Mw={class:"input-group"},Ow={class:"mb-3"},Dw={for:"permission-mode",class:"form-label"},Nw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Lw={key:1,class:"field-indicator modified",title:"Modified from template"},Iw=["title"],Pw={class:"mb-3"},jw={for:"allowed-tools",class:"form-label"},Rw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Hw={key:1,class:"field-indicator modified",title:"Modified from template"},Ww=["title"],Vw={class:"mb-3 form-check"},Fw={key:0,class:"alert alert-danger"},Uw={class:"modal-footer"},Bw=["disabled"],qw={key:0,class:"spinner-border spinner-border-sm me-2"},zw={__name:"CreateMinionModal",setup(n){const e=it(),t=we(),o=ae(),i=me(),a=L(null);let l=null;const r=L(null),d=L([]),h=L(null),c=L(new Set),$=L({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),_=L({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),v=L({name:"",model:"sonnet",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:"",startImmediately:!0}),y={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},g=L(""),f=L(""),m=L(!1),w=b(()=>g.value.trim()?g.value.split(",").map(K=>K.trim()).filter(K=>K.length>0):[]),C=b(()=>v.value.allowed_tools.trim()?v.value.allowed_tools.split(",").map(K=>K.trim()).filter(K=>K.length>0):null),M=b(()=>y[v.value.model]||null),N=b(()=>v.value.initialization_context.length),I=b(()=>N.value>2e3),k=b(()=>N.value>1800&&N.value<=2e3),O=b(()=>h.value?d.value.find(K=>K.template_id===h.value):null),P=b(()=>O.value?.default_role||"e.g., Code Expert, Testing Specialist"),z=b(()=>({"field-autofilled":_.value.role==="autofilled","field-modified":_.value.role==="modified"})),G=b(()=>({"field-autofilled":_.value.initialization_context==="autofilled","field-modified":_.value.initialization_context==="modified"})),B=b(()=>({"field-autofilled":_.value.permission_mode==="autofilled","field-modified":_.value.permission_mode==="modified"})),S=b(()=>({"field-autofilled":_.value.allowed_tools==="autofilled","field-modified":_.value.allowed_tools==="modified"})),T=K=>{const H=_.value[K];return H==="autofilled"?`Auto-filled from template: ${O.value?.name}`:H==="modified"?"Modified from template value":""};async function V(){try{console.log("[CreateMinionModal] Loading templates...");const K=await ie.get("/api/templates");console.log("[CreateMinionModal] Templates data:",K),d.value=K||[],console.log("[CreateMinionModal] Templates set to:",d.value)}catch(K){console.error("[CreateMinionModal] Failed to load templates:",K),d.value=[]}}function A(){if(c.value.clear(),!O.value){v.value.role="",v.value.initialization_context="",v.value.permission_mode="default",v.value.allowed_tools="",_.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const K=O.value;if(_.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},K.default_role?(v.value.role=K.default_role,c.value.add("role"),$.value.role=K.default_role,_.value.role="autofilled"):(v.value.role="",$.value.role=null,_.value.role="normal"),K.default_system_prompt?(v.value.initialization_context=K.default_system_prompt,c.value.add("initialization_context"),$.value.initialization_context=K.default_system_prompt,_.value.initialization_context="autofilled"):(v.value.initialization_context="",$.value.initialization_context=null,_.value.initialization_context="normal"),K.permission_mode?(v.value.permission_mode=K.permission_mode,c.value.add("permission_mode"),$.value.permission_mode=K.permission_mode,_.value.permission_mode="autofilled"):(v.value.permission_mode="default",$.value.permission_mode=null,_.value.permission_mode="normal"),K.allowed_tools&&K.allowed_tools.length>0){const H=K.allowed_tools.join(", ");v.value.allowed_tools=H,c.value.add("allowed_tools"),$.value.allowed_tools=H,_.value.allowed_tools="autofilled"}else v.value.allowed_tools="",$.value.allowed_tools=null,_.value.allowed_tools="normal"}function x(){i.showModal("template-management",{})}function j(){const H=(r.value?t.projects.get(r.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:H,currentPath:v.value.working_directory||"",onSelect:J=>{v.value.working_directory=J}})}function U(){v.value={name:"",model:"sonnet",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:"",startImmediately:!0},g.value="",h.value=null,c.value.clear(),_.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},f.value="",m.value=!1}function Y(){U(),i.hideModal()}async function Q(){if(!v.value.name.trim()){f.value="Minion name is required";return}if(v.value.name.includes(" ")){f.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(I.value){f.value="Initialization context exceeds 2000 character limit";return}if(!r.value){f.value="Legion ID is missing";return}m.value=!0,f.value="";try{const K={name:v.value.name.trim(),model:v.value.model,role:v.value.role.trim(),initialization_context:v.value.initialization_context.trim(),override_system_prompt:v.value.override_system_prompt,capabilities:w.value,permission_mode:v.value.permission_mode,allowed_tools:C.value,working_directory:v.value.working_directory.trim()||null},H=await ie.post(`/api/legions/${r.value}/minions`,K);H.success&&H.minion_id?(await t.fetchProjects(),await o.fetchSessions(),v.value.startImmediately&&await o.startSession(H.minion_id),l&&l.hide(),e.push(`/session/${H.minion_id}`)):f.value="Failed to create minion"}catch(K){console.error("Failed to create minion:",K),f.value=K.response?.data?.detail||"Failed to create minion"}finally{m.value=!1}}return le(()=>i.currentModal,(K,H)=>{if(K?.name==="create-minion"&&l){const J=K.data||{};r.value=J.project?.project_id||null,U(),V(),l.show()}else H?.name==="template-management"&&l&&a.value?.classList.contains("show")&&V()}),le(()=>v.value.role,K=>{$.value.role!==null&&(K===$.value.role?_.value.role="autofilled":_.value.role="modified")}),le(()=>v.value.initialization_context,K=>{$.value.initialization_context!==null&&(K===$.value.initialization_context?_.value.initialization_context="autofilled":_.value.initialization_context="modified")}),le(()=>v.value.permission_mode,K=>{$.value.permission_mode!==null&&(K===$.value.permission_mode?_.value.permission_mode="autofilled":_.value.permission_mode="modified")}),le(()=>v.value.allowed_tools,K=>{$.value.allowed_tools!==null&&(K===$.value.allowed_tools?_.value.allowed_tools="autofilled":_.value.allowed_tools="modified")}),pe(()=>{a.value&&be(()=>import("./modal-BK1Vt_in.js").then(K=>K.m),__vite__mapDeps([0,1])).then(K=>{const H=K.default;l=new H(a.value),a.value.addEventListener("hidden.bs.modal",Y)}),V()}),he(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",Y),l&&l.dispose()}),(K,H)=>(u(),p("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[s("div",iw,[s("div",aw,[H[33]||(H[33]=s("div",{class:"modal-header"},[s("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",lw,[s("form",{onSubmit:_e(Q,["prevent"])},[s("div",rw,[s("label",{for:"template-select",class:"form-label"},[H[11]||(H[11]=ne(" Template ",-1)),s("button",{type:"button",onClick:x,class:"btn btn-link btn-sm p-0 ms-2"}," âš™ï¸ Manage Templates ")]),oe(s("select",{id:"template-select","onUpdate:modelValue":H[0]||(H[0]=J=>h.value=J),onChange:A,class:"form-select"},[H[12]||(H[12]=s("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),p(re,null,ue(d.value,J=>(u(),p("option",{key:J.template_id,value:J.template_id},E(J.name),9,cw))),128))],544),[[Pe,h.value]]),O.value?(u(),p("div",uw,E(O.value.description),1)):D("",!0)]),s("div",dw,[H[13]||(H[13]=s("label",{for:"minion-name",class:"form-label"},[ne(" Name "),s("span",{class:"text-danger"},"*")],-1)),oe(s("input",{id:"minion-name","onUpdate:modelValue":H[1]||(H[1]=J=>v.value.name=J),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[de,v.value.name]]),H[14]||(H[14]=s("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),s("div",mw,[H[16]||(H[16]=s("label",{for:"model",class:"form-label"},"Model",-1)),oe(s("select",{class:"form-select",id:"model","onUpdate:modelValue":H[2]||(H[2]=J=>v.value.model=J)},[...H[15]||(H[15]=[s("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),s("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),s("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),s("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Pe,v.value.model]]),M.value?(u(),p("small",pw,E(M.value.description),1)):D("",!0)]),s("div",fw,[s("label",vw,[H[17]||(H[17]=ne(" Role ",-1)),_.value.role==="autofilled"?(u(),p("span",hw," âš¡ ")):D("",!0),_.value.role==="modified"?(u(),p("span",_w," âœï¸ ")):D("",!0)]),oe(s("input",{id:"minion-role","onUpdate:modelValue":H[3]||(H[3]=J=>v.value.role=J),type:"text",class:Z(["form-control",z.value]),placeholder:P.value,title:T("role")},null,10,gw),[[de,v.value.role]]),H[18]||(H[18]=s("div",{class:"form-text"}," Optional role description for the minion ",-1))]),s("div",bw,[s("label",yw,[H[19]||(H[19]=ne(" Initialization Context ",-1)),_.value.initialization_context==="autofilled"?(u(),p("span",$w," âš¡ ")):D("",!0),_.value.initialization_context==="modified"?(u(),p("span",ww," âœï¸ ")):D("",!0)]),oe(s("textarea",{id:"minion-context","onUpdate:modelValue":H[4]||(H[4]=J=>v.value.initialization_context=J),class:Z(["form-control",[G.value,{"is-invalid":I.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:T("initialization_context")},null,10,Ew),[[de,v.value.initialization_context]]),s("div",Cw,[s("span",null,E(v.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),s("span",{class:Z({"text-danger":I.value,"text-warning":k.value})},E(N.value)+" / 2000 chars ",3)]),I.value?(u(),p("div",Sw," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):D("",!0)]),s("div",kw,[oe(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":H[5]||(H[5]=J=>v.value.override_system_prompt=J)},null,512),[[Lt,v.value.override_system_prompt]]),H[21]||(H[21]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),v.value.override_system_prompt?(u(),p("div",Tw,[...H[20]||(H[20]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):D("",!0)]),s("div",xw,[H[22]||(H[22]=s("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),oe(s("input",{id:"minion-capabilities","onUpdate:modelValue":H[6]||(H[6]=J=>g.value=J),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[de,g.value]]),H[23]||(H[23]=s("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),s("div",Aw,[H[24]||(H[24]=s("label",{for:"working-directory",class:"form-label"}," Working Directory (Optional) ",-1)),s("div",Mw,[oe(s("input",{id:"working-directory","onUpdate:modelValue":H[7]||(H[7]=J=>v.value.working_directory=J),type:"text",class:"form-control",placeholder:"Leave empty to inherit from legion"},null,512),[[de,v.value.working_directory]]),s("button",{type:"button",class:"btn btn-outline-secondary",onClick:j}," ðŸ“ Browse ")]),H[25]||(H[25]=s("div",{class:"form-text"}," Custom working directory for git worktrees or multi-repo workflows. Relative paths will be converted to absolute. ",-1))]),s("div",Ow,[s("label",Dw,[H[26]||(H[26]=ne(" Permission Mode ",-1)),_.value.permission_mode==="autofilled"?(u(),p("span",Nw," âš¡ ")):D("",!0),_.value.permission_mode==="modified"?(u(),p("span",Lw," âœï¸ ")):D("",!0)]),oe(s("select",{class:Z(["form-select",B.value]),id:"permission-mode","onUpdate:modelValue":H[8]||(H[8]=J=>v.value.permission_mode=J),title:T("permission_mode")},[...H[27]||(H[27]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,Iw),[[Pe,v.value.permission_mode]]),H[28]||(H[28]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",Pw,[s("label",jw,[H[29]||(H[29]=ne(" Allowed Tools (Optional) ",-1)),_.value.allowed_tools==="autofilled"?(u(),p("span",Rw," âš¡ ")):D("",!0),_.value.allowed_tools==="modified"?(u(),p("span",Hw," âœï¸ ")):D("",!0)]),oe(s("input",{type:"text",class:Z(["form-control",S.value]),id:"allowed-tools","onUpdate:modelValue":H[9]||(H[9]=J=>v.value.allowed_tools=J),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:T("allowed_tools")},null,10,Ww),[[de,v.value.allowed_tools]]),H[30]||(H[30]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",Vw,[oe(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":H[10]||(H[10]=J=>v.value.startImmediately=J)},null,512),[[Lt,v.value.startImmediately]]),H[31]||(H[31]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),f.value?(u(),p("div",Fw,E(f.value),1)):D("",!0)],32)]),s("div",Uw,[H[32]||(H[32]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",disabled:!v.value.name.trim()||m.value,onClick:Q},[m.value?(u(),p("span",qw)):D("",!0),ne(" "+E(m.value?"Creating...":"Create Minion"),1)],8,Bw)])])])],512))}},Kw=te(zw,[["__scopeId","data-v-9432a89b"]]),Gw={class:"modal-dialog modal-dialog-centered modal-lg"},Yw={class:"modal-content"},Jw={class:"modal-body"},Xw={key:0,class:"text-center text-muted py-4"},Qw={key:1},Zw={class:"mb-3"},eE={class:"mb-3"},tE={class:"font-monospace small"},sE={class:"mb-3"},nE={class:"mb-3"},oE={class:"mb-3"},iE={key:0},aE={class:"d-flex flex-wrap gap-1"},lE={key:1,class:"text-muted small"},rE={class:"mb-3"},cE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},uE={key:1,class:"text-muted small"},dE={class:"mb-3"},mE={key:0,class:"badge bg-info"},pE={key:1,class:"badge bg-secondary"},fE={class:"mb-3"},vE={key:0,class:"font-monospace small"},hE={key:1,class:"text-muted small"},_E={key:0,class:"mb-3"},gE={key:0},bE={class:"list-unstyled mb-0"},yE={key:1,class:"text-muted small"},$E={class:"mb-3"},wE={class:"small"},EE={class:"mb-3"},CE={class:"small"},SE={__name:"MinionViewModal",setup(n){const e=me(),t=L(null),o=L(null);let i=null;function a(h){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[h]||"bg-secondary"}function l(h){if(!h)return"N/A";try{const c=new Date(h);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function r(){t.value=null}function d(){r(),e.hideModal()}return le(()=>e.currentModal,h=>{if(h?.name==="minion-view"&&i){const c=h.data||{};t.value=c.session,i.show()}}),pe(()=>{o.value&&be(async()=>{const{default:h}=await import("./modal-BK1Vt_in.js").then(c=>c.m);return{default:h}},__vite__mapDeps([0,1])).then(({default:h})=>{i=new h(o.value),o.value.addEventListener("hidden.bs.modal",d)})}),he(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",d),i&&i.dispose()}),(h,c)=>(u(),p("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",Gw,[s("div",Yw,[c[11]||(c[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Jw,[t.value?(u(),p("div",Qw,[s("div",Zw,[c[0]||(c[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,E(t.value.name||"Unnamed Minion"),1)]),s("div",eE,[c[1]||(c[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",tE,E(t.value.session_id),1)]),s("div",sE,[c[2]||(c[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,E(t.value.role||"Not specified"),1)]),s("div",nE,[c[3]||(c[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:Z(["badge",a(t.value.state)])},E(t.value.state),3)])]),s("div",oE,[c[4]||(c[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(u(),p("div",iE,[s("div",aE,[(u(!0),p(re,null,ue(t.value.capabilities,$=>(u(),p("span",{key:$,class:"badge bg-secondary"},E($),1))),128))])])):(u(),p("div",lE,"None"))]),s("div",rE,[c[5]||(c[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(u(),p("div",cE,E(t.value.initialization_context),1)):(u(),p("div",uE,"Not specified"))]),s("div",dE,[c[6]||(c[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(u(),p("span",mE,"Yes")):(u(),p("span",pE,"No"))])]),s("div",fE,[c[7]||(c[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(u(),p("div",vE,E(t.value.parent_overseer_id),1)):(u(),p("div",hE,E(t.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),t.value.is_overseer?(u(),p("div",_E,[c[8]||(c[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(u(),p("div",gE,[s("ul",bE,[(u(!0),p(re,null,ue(t.value.child_minion_ids,$=>(u(),p("li",{key:$,class:"font-monospace small"},E($),1))),128))])])):(u(),p("div",yE,"No children"))])):D("",!0),s("div",$E,[c[9]||(c[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",wE,E(l(t.value.created_at)),1)]),s("div",EE,[c[10]||(c[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",CE,E(l(t.value.updated_at)),1)])])):(u(),p("div",Xw," No minion data available "))]),c[12]||(c[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},kE=te(SE,[["__scopeId","data-v-488ca88f"]]),TE={class:"modal-dialog modal-lg"},xE={class:"modal-content"},AE={class:"modal-body"},ME={key:0,class:"template-list"},OE={key:0,class:"alert alert-info"},DE={class:"card-body"},NE={class:"d-flex justify-content-between align-items-start"},LE={class:"flex-grow-1"},IE={class:"card-title mb-1"},PE={class:"card-text text-muted small mb-2"},jE={class:"template-meta"},RE={class:"badge bg-secondary me-2"},HE={class:"text-muted small"},WE={class:"btn-group btn-group-sm ms-3"},VE=["onClick"],FE=["onClick"],UE={key:1,class:"template-form"},BE={class:"mb-3"},qE={class:"mb-3"},zE={class:"mb-3"},KE={class:"mb-3"},GE={class:"mb-3"},YE={class:"mb-3"},JE={class:"mb-3"},XE={key:0,class:"alert alert-danger"},QE={class:"d-flex gap-2"},ZE=["disabled"],eC={key:0,class:"spinner-border spinner-border-sm me-2"},tC={__name:"TemplateManagementModal",setup(n){const e=me(),t=L(null);let o=null;const i=L([]),a=L(null),l=L(""),r=L(""),d=L(!1);async function h(){try{const f=await ie.get("/api/templates");i.value=f||[]}catch(f){console.error("Failed to load templates:",f),i.value=[]}}function c(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},l.value="",r.value=""}function $(f){a.value={...f},l.value=f.allowed_tools?.join(", ")||"",r.value=""}async function _(){if(!a.value.name.trim()){r.value="Template name is required";return}d.value=!0,r.value="";try{const f=l.value.split(",").map(C=>C.trim()).filter(C=>C.length>0),m={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:f.length>0?f:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await ie.post("/api/templates",m):await ie.put(`/api/templates/${a.value.template_id}`,m),await h(),a.value=null,l.value=""}catch(f){console.error("Failed to save template:",f),r.value=f.response?.data?.detail||"Failed to save template"}finally{d.value=!1}}async function v(f){if(confirm(`Delete template "${f.name}"?

This action cannot be undone.`))try{await ie.delete(`/api/templates/${f.template_id}`),await h()}catch(m){console.error("Failed to delete template:",m),alert(`Failed to delete template: ${m.response?.data?.detail||m.message}`)}}function y(){a.value=null,l.value="",r.value=""}function g(){a.value=null,l.value="",r.value="",e.hideModal()}return le(()=>e.currentModal,f=>{f?.name==="template-management"&&o&&(h(),o.show())}),pe(()=>{t.value&&be(()=>import("./modal-BK1Vt_in.js").then(f=>f.m),__vite__mapDeps([0,1])).then(f=>{const m=f.default;o=new m(t.value),t.value.addEventListener("hidden.bs.modal",g)})}),he(()=>{t.value&&t.value.removeEventListener("hidden.bs.modal",g),o&&o.dispose()}),(f,m)=>(u(),p("div",{ref_key:"modalElement",ref:t,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[s("div",TE,[s("div",xE,[m[15]||(m[15]=s("div",{class:"modal-header"},[s("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",AE,[a.value?D("",!0):(u(),p("div",ME,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[m[6]||(m[6]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:c,class:"btn btn-primary btn-sm"}," âž• Create New ")]),i.value.length===0?(u(),p("div",OE," No templates found. Create your first template! ")):D("",!0),(u(!0),p(re,null,ue(i.value,w=>(u(),p("div",{key:w.template_id,class:"card mb-2"},[s("div",DE,[s("div",NE,[s("div",LE,[s("h6",IE,E(w.name),1),s("p",PE,E(w.description),1),s("div",jE,[s("span",RE,E(w.permission_mode),1),s("span",HE,E(w.allowed_tools?.length||0)+" tools",1)])]),s("div",WE,[s("button",{onClick:C=>$(w),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,VE),s("button",{onClick:C=>v(w),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,FE)])])])]))),128))])),a.value?(u(),p("div",UE,[s("h6",BE,E(a.value.template_id?"Edit Template":"Create Template"),1),s("div",qE,[m[7]||(m[7]=s("label",{for:"template-name",class:"form-label"},[ne(" Name "),s("span",{class:"text-danger"},"*")],-1)),oe(s("input",{id:"template-name","onUpdate:modelValue":m[0]||(m[0]=w=>a.value.name=w),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[de,a.value.name]])]),s("div",zE,[m[8]||(m[8]=s("label",{for:"template-description",class:"form-label"},"Description",-1)),oe(s("textarea",{id:"template-description","onUpdate:modelValue":m[1]||(m[1]=w=>a.value.description=w),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[de,a.value.description]])]),s("div",KE,[m[10]||(m[10]=s("label",{for:"template-permission-mode",class:"form-label"},[ne(" Permission Mode "),s("span",{class:"text-danger"},"*")],-1)),oe(s("select",{id:"template-permission-mode","onUpdate:modelValue":m[2]||(m[2]=w=>a.value.permission_mode=w),class:"form-select",required:""},[...m[9]||(m[9]=[s("option",{value:"default"},"Default",-1),s("option",{value:"acceptEdits"},"Accept Edits",-1),s("option",{value:"plan"},"Plan Mode",-1),s("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Pe,a.value.permission_mode]])]),s("div",GE,[m[11]||(m[11]=s("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),oe(s("input",{id:"template-tools","onUpdate:modelValue":m[3]||(m[3]=w=>l.value=w),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[de,l.value]]),m[12]||(m[12]=s("div",{class:"form-text"},"Comma-separated list of tools",-1))]),s("div",YE,[m[13]||(m[13]=s("label",{for:"template-role",class:"form-label"},"Default Role",-1)),oe(s("input",{id:"template-role","onUpdate:modelValue":m[4]||(m[4]=w=>a.value.default_role=w),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[de,a.value.default_role]])]),s("div",JE,[m[14]||(m[14]=s("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),oe(s("textarea",{id:"template-prompt","onUpdate:modelValue":m[5]||(m[5]=w=>a.value.default_system_prompt=w),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[de,a.value.default_system_prompt]])]),r.value?(u(),p("div",XE,E(r.value),1)):D("",!0),s("div",QE,[s("button",{onClick:_,class:"btn btn-primary",disabled:d.value},[d.value?(u(),p("span",eC)):D("",!0),ne(" "+E(d.value?"Saving...":"Save Template"),1)],8,ZE),s("button",{onClick:y,class:"btn btn-secondary"},"Cancel")])])):D("",!0)])])])],512))}},sC=te(tC,[["__scopeId","data-v-81126ff4"]]),nC={class:"container-fluid vh-100 d-flex flex-column p-0"},oC={class:"d-flex flex-grow-1 overflow-hidden position-relative"},iC={class:"flex-grow-1 d-flex flex-column overflow-hidden"},aC={__name:"App",setup(n){const e=me(),t=ze(),o=ae(),i=we(),a=it(),l=b(()=>e.sidebarCollapsed),r=b(()=>e.isMobile);pe(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&await o.selectSession($)}else if(c.startsWith("#/timeline/")){const $=c.replace("#/timeline/","");a.push(`/timeline/${$}`)}window.addEventListener("popstate",d),window.addEventListener("resize",e.handleResize)}),he(()=>{window.removeEventListener("popstate",d),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function d(){const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&o.selectSession($)}}function h(){e.toggleSidebar()}return(c,$)=>{const _=so("router-view");return u(),p("div",nC,[ce(Ab),s("div",{id:"sidebar-backdrop",class:Z({show:!l.value&&r.value}),onClick:h},null,2),s("div",oC,[ce(fy),s("main",iC,[ce(_)])]),ce(Oy),ce(Ky),ce(v1),ce(H1),ce(p$),ce(L$),ce(ow),ce(Kw),ce(kE),ce(sC)])}}},on=vi(aC);on.use(hi());on.use(yb);on.mount("#app");
