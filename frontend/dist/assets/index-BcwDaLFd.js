const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c,a as s,o as r,d as mt,r as R,b as v,t as $,e as x,n as X,f as at,g as ee,u as ns,w as fe,h as gs,F as ne,i as le,j as ge,v as He,k as be,l as lo,m as pe,p as We,q as _e,s as $t,x as ye,y as _i,z as Se,A as vn,B as co,C as Wt,D as gi,E as bi,G as yi,T as $i,H as wi,I as bs,J as ys,K as ki,L as Ei}from"./vue-vendor-Bf49-igW.js";import{m as lt,p as ls}from"./markdown-vendor-BRsjnVvP.js";import{c as Si}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const Ci={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ti={__name:"NoSessionSelected",setup(n){return(e,t)=>(r(),c("div",Ci,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},xi="modulepreload",Ai=function(n){return"/"+n},hn={},Oe=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let f=function(p){return Promise.all(p.map(d=>Promise.resolve(d).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),m=l?.nonce||l?.getAttribute("nonce");i=f(t.map(p=>{if(p=Ai(p),p in hn)return;hn[p]=!0;const d=p.endsWith(".css"),k=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${k}`))return;const _=document.createElement("link");if(_.rel=d?"stylesheet":xi,d||(_.as="script"),_.crossOrigin="",_.href=p,m&&_.setAttribute("nonce",m),document.head.appendChild(_),d)return new Promise((w,b)=>{_.addEventListener("load",w),_.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=l,window.dispatchEvent(m),!m.defaultPrevented)throw l}return i.then(l=>{for(const m of l||[])m.status==="rejected"&&a(m.reason);return e().catch(a)})};class $s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function wt(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new $s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof $s?t:(console.error("API request failed:",t),new $s(`Network error: ${t.message}`,0,null))}}async function Oi(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[m,f]of Object.entries(e.params))f!=null&&o.append(m,f);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...l}=e;return wt(t,{...l,method:"GET"})}return wt(t,{...e,method:"GET"})}async function Mi(n,e,t={}){return wt(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Di(n,e,t={}){return wt(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ni(n,e={}){return wt(n,{...e,method:"DELETE"})}async function Li(n,e,t={}){return wt(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const ue={get:Oi,post:Mi,put:Di,delete:Ni,patch:Li},de=mt("session",()=>{const n=R(new Map),e=R(null),t=R(new Map),o=R(new Map),i=R(new Set),a=R(!1);let l=null;const m=v(()=>n.value.get(e.value)),f=v(()=>Array.from(n.value.values()).sort((A,P)=>A.order-P.order)),p=A=>v(()=>f.value.filter(P=>P.project_id===A)),d=v({get:()=>t.value.get(e.value)||"",set:A=>{e.value&&t.value.set(e.value,A)}});async function k(){try{const A=await ue.get("/api/sessions");return n.value.clear(),A.sessions.forEach(P=>{n.value.set(P.session_id,P)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function _(A,P){try{const T=(await ue.post("/api/sessions",{project_id:A,...P})).session_id,q=(await ue.get(`/api/sessions/${T}`)).session;return n.value.set(T,q),n.value=new Map(n.value),console.log(`Created session ${T}`),q}catch(C){throw console.error("Failed to create session:",C),C}}async function w(A){if(e.value===A&&!a.value)return;l&&(console.log(`Aborting pending selection to switch to ${A}`),l.abort(),l=null);const P=new AbortController;l=P,a.value=!0;try{if(e.value=A,P.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let C=n.value.get(A);if(!C)try{const q=await ue.get(`/api/sessions/${A}`);if(P.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}C=q.session,n.value.set(A,C),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(q){console.error(`Failed to fetch session ${A}:`,q);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await h(A),P.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${C.state} state)`);const q=6e4,W=200,H=5e3;let F=0,O=0;for(;F<q;){if(P.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const K=n.value.get(A);if(K&&K.state==="active"){console.log(`Session ${A} is now active after ${F}ms`);break}if(F-O>=H){const L=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${L}, ${F/1e3}s elapsed)`),O=F}await new Promise(L=>setTimeout(L,W)),F+=W}const M=n.value.get(A);M&&M.state!=="active"&&console.warn(`Session ${A} did not become active within ${q/1e3}s (state: ${M.state}), continuing anyway`)}catch(q){console.error(`Failed to auto-start session ${A}:`,q)}if(P.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await Oe(()=>Promise.resolve().then(()=>na),void 0)).useMessageStore().loadMessages(A),P.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}await(await Oe(()=>Promise.resolve().then(()=>Ea),void 0)).useWebSocketStore().connectSession(A),P.signal.aborted||console.log(`Selected session ${A}`)}finally{l===P&&(l=null),a.value=!1}}function b(A,P){const C=n.value.get(A);C?Object.assign(C,P):(n.value.set(A,P),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function g(A){i.value.add(A);try{const C=(await ue.delete(`/api/sessions/${A}`)).deleted_session_ids||[A];for(const T of C)n.value.delete(T),t.value.delete(T),o.value.delete(T);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(P){throw console.error("Failed to delete session:",P),P}finally{i.value.delete(A)}}async function u(A,P){try{await ue.patch(`/api/sessions/${A}`,P),b(A,P),console.log(`Updated session ${A}:`,P)}catch(C){throw console.error("Failed to update session:",C),C}}async function y(A,P){try{await ue.post(`/api/sessions/${A}/permission-mode`,{mode:P}),b(A,{current_permission_mode:P});const C=o.value.get(A);C&&(C.permissionMode=P,o.value.set(A,C)),console.log(`Set permission mode for session ${A} to ${P}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function h(A){try{await ue.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(P){throw console.error("Failed to start session:",P),P}}async function S(A){try{await ue.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(P){throw console.error("Failed to pause session:",P),P}}async function E(A){try{await ue.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(P){throw console.error("Failed to terminate session:",P),P}}function I(A){return n.value.get(A)}function N(A,P){o.value.set(A,P),P.permissionMode&&b(A,{current_permission_mode:P.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:m,orderedSessions:f,sessionsInProject:p,currentInput:d,fetchSessions:k,createSession:_,selectSession:w,updateSession:b,deleteSession:g,patchSession:u,setPermissionMode:y,startSession:h,pauseSession:S,terminateSession:E,getSession:I,storeInitData:N}}),_n=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:de},Symbol.toStringTag,{value:"Module"})),ve=mt("ui",()=>{const n=R(window.innerWidth<768),e=R(300),t=R(!0),o=R(300),i=R(window.innerWidth),a=v(()=>i.value<768),l=R(!0),m=R(null),f=R(null),p=v(()=>m.value?{name:m.value,data:f.value}:null),d=R(!1),k=R("Loading...");function _(){n.value=!n.value}function w(P){n.value=P}function b(P){e.value=Math.max(200,Math.min(P,window.innerWidth*.3))}function g(){t.value=!t.value}function u(P){t.value=P}function y(P){o.value=Math.max(200,Math.min(P,window.innerWidth*.3))}function h(P){l.value=P}function S(P,C=null){m.value=null,f.value=null,setTimeout(()=>{m.value=P,f.value=C},0)}function E(){m.value=null,f.value=null}function I(P="Loading..."){d.value=!0,k.value=P}function N(){d.value=!1}function A(){const P=i.value;i.value=window.innerWidth,i.value<768&&P>=768?n.value=!0:i.value>=768&&P<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:a,autoScrollEnabled:l,activeModal:m,modalData:f,currentModal:p,isLoading:d,loadingMessage:k,toggleSidebar:_,setSidebarCollapsed:w,setSidebarWidth:b,toggleRightSidebar:g,setRightSidebarCollapsed:u,setRightSidebarWidth:y,setAutoScroll:h,showModal:S,hideModal:E,showLoading:I,hideLoading:N,handleResize:A}}),Le=mt("project",()=>{const n=R(new Map),e=R(null),t=v(()=>n.value.get(e.value)),o=v(()=>Array.from(n.value.values()).sort((u,y)=>u.order-y.order));async function i(){try{const u=await ue.get("/api/projects");return n.value.clear(),u.projects.forEach(y=>{n.value.set(y.project_id,y)}),console.log(`Loaded ${n.value.size} projects`),u.projects}catch(u){throw console.error("Failed to fetch projects:",u),u}}async function a(u,y){try{const S=(await ue.post("/api/projects",{name:u,working_directory:y})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(h){throw console.error("Failed to create project:",h),h}}async function l(u,y){try{await ue.put(`/api/projects/${u}`,y),m(u,y),console.log(`Updated project ${u}`,y)}catch(h){throw console.error("Failed to update project:",h),h}}function m(u,y){const h=n.value.get(u);h&&(Object.assign(h,y),n.value=new Map(n.value))}async function f(u){try{await ue.delete(`/api/projects/${u}`),n.value.delete(u),n.value=new Map(n.value),e.value===u&&(e.value=null),console.log(`Deleted project ${u}`)}catch(y){throw console.error("Failed to delete project:",y),y}}async function p(u){try{const y=await ue.put(`/api/projects/${u}/toggle-expansion`),h=n.value.get(u);return h&&(h.is_expanded=y.is_expanded,n.value=new Map(n.value)),y.is_expanded}catch(y){throw console.error("Failed to toggle expansion:",y),y}}async function d(u){try{await ue.put("/api/projects/reorder",{project_ids:u}),u.forEach((y,h)=>{const S=n.value.get(y);S&&(S.order=h)}),n.value=new Map(n.value),console.log("Reordered projects",u)}catch(y){throw console.error("Failed to reorder projects:",y),y}}async function k(u,y){try{await ue.put(`/api/projects/${u}/sessions/reorder`,{session_ids:y});const h=n.value.get(u);h&&(h.session_ids=y,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${u}`,y)}catch(h){throw console.error("Failed to reorder sessions:",h),h}}function _(u){return n.value.get(u)}function w(u){e.value=u}function b(){e.value=null}function g(u){if(!u)return"";const y=u.split(/[/\\]/).filter(h=>h);return y.length===0?"/":y.length===1?`/${y[0]}`:y.length===2?`/${y.join("/")}`:`.../${y.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:a,updateProject:l,updateProjectLocal:m,deleteProject:f,toggleExpansion:p,reorderProjects:d,reorderSessionsInProject:k,getProject:_,selectProject:w,clearProjectSelection:b,formatPath:g}}),Rt=mt("task",()=>{const n=R(new Map),e=R(new Set);function t(h){const S=n.value.get(h);return S?Array.from(S.values()).sort((E,I)=>{const N=parseInt(E.id.replace(/\D/g,""))||0,A=parseInt(I.id.replace(/\D/g,""))||0;return N-A}):[]}function o(h){return t(h).find(E=>E.status==="in_progress")||null}function i(h){const S=t(h);return{total:S.length,completed:S.filter(E=>E.status==="completed").length,inProgress:S.filter(E=>E.status==="in_progress").length,pending:S.filter(E=>E.status==="pending").length}}function a(h){return e.value.has(h)}const l=v(()=>{const h=de();return t(h.currentSessionId)}),m=v(()=>{const h=de();return o(h.currentSessionId)}),f=v(()=>{const h=de();return i(h.currentSessionId)}),p=v(()=>{const h=de();return a(h.currentSessionId)});function d(h,S){n.value.has(h)||n.value.set(h,new Map),n.value.get(h).set(S.id,{id:S.id,subject:S.subject||"",description:S.description||"",status:S.status||"pending",activeForm:S.activeForm||null,owner:S.owner||null,blocks:S.blocks||[],blockedBy:S.blockedBy||[],metadata:S.metadata||{}}),e.value.add(h),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${S.id} for session ${h}`)}function k(h,S,E){const I=n.value.get(h);if(!I){console.warn(`No tasks found for session ${h}`);return}const N=I.get(S);if(!N){d(h,{id:S,...E});return}E.subject!==void 0&&(N.subject=E.subject),E.description!==void 0&&(N.description=E.description),E.status!==void 0&&(N.status=E.status),E.activeForm!==void 0&&(N.activeForm=E.activeForm),E.owner!==void 0&&(N.owner=E.owner),E.metadata!==void 0&&(N.metadata={...N.metadata,...E.metadata}),E.addBlocks&&(N.blocks=[...new Set([...N.blocks,...E.addBlocks])]),E.addBlockedBy&&(N.blockedBy=[...new Set([...N.blockedBy,...E.addBlockedBy])]),E.status==="deleted"&&(I.delete(S),I.size===0&&(e.value.delete(h),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${S} for session ${h}`,E)}function _(h,S){return n.value.get(h)?.get(S)||null}function w(h){n.value.delete(h),e.value.delete(h),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${h}`)}function b(h,S){n.value.has(h)&&n.value.get(h).clear(),e.value.delete(h);const E=new Map;for(const I of S){if(I.metadata?.tool_uses)for(const N of I.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(N.name)&&E.set(N.id,{name:N.name,input:N.input});if(I.metadata?.tool_results)for(const N of I.metadata.tool_results){const A=E.get(N.tool_use_id);A&&(g(h,A.name,A.input,{error:N.is_error,content:N.content}),E.delete(N.tool_use_id))}}console.log(`Reconstructed ${n.value.get(h)?.size||0} tasks for session ${h}`)}function g(h,S,E,I){if(I?.error){console.log(`Skipping task update - tool ${S} returned error`);return}const N=u(I);if(N)switch(S){case"TaskCreate":{const A=y(N)||E?.id;A&&d(h,{id:A,subject:E?.subject||"",description:E?.description||"",status:"pending",activeForm:E?.activeForm||null,owner:E?.owner||null,blocks:[],blockedBy:[],metadata:E?.metadata||{}});break}case"TaskUpdate":{const A=E?.taskId;A&&k(h,A,{status:E?.status,subject:E?.subject,description:E?.description,activeForm:E?.activeForm,owner:E?.owner,metadata:E?.metadata,addBlocks:E?.addBlocks,addBlockedBy:E?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{E?.taskId;break}}}function u(h){return h?typeof h=="string"?h:h.content?typeof h.content=="string"?h.content:JSON.stringify(h.content):h.message?h.message:JSON.stringify(h):null}function y(h){if(!h)return null;const S=h.match(/[Tt]ask\s*#(\d+)/i);if(S)return S[1];const E=h.match(/#(\d+)/);return E?E[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:l,currentActiveTask:m,currentTaskStats:f,currentHasTasks:p,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:a,getTask:_,createTask:d,updateTask:k,clearTasks:w,reconstructFromMessages:b,handleTaskToolResult:g}}),Z=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},ji={class:"session-header border-bottom p-3 d-flex justify-content-between align-items-center"},Ii={class:"project-name"},Pi=["title"],Ri=["title"],Wi={class:"toggle-icon"},Hi={key:0,class:"task-badge ms-1"},Bi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=Le(),i=Rt(),a=ve(),l=v(()=>t.sessions.get(e.sessionId)),m=v(()=>l.value?.name||e.sessionId),f=v(()=>{for(const b of o.projects.values())if(b.session_ids?.includes(e.sessionId))return b;return null}),p=v(()=>f.value?.name||"Unknown Project"),d=v(()=>i.hasTasks(e.sessionId)),k=v(()=>i.taskStats(e.sessionId)),_=v(()=>a.rightSidebarCollapsed);function w(){a.toggleRightSidebar()}return(b,g)=>(r(),c("div",ji,[s("div",null,[s("div",Ii,$(p.value),1),s("div",{class:"session-name",title:n.sessionId},$(m.value),9,Pi)]),s("button",{class:X(["btn btn-sm sidebar-toggle-btn",{"btn-primary":!_.value,"btn-outline-secondary":_.value}]),onClick:w,title:_.value?"Show panel":"Hide panel"},[s("span",Wi,$(_.value?"â—€":"â–¶"),1),d.value?(r(),c("span",Hi,"ðŸ“‹ "+$(k.value.completed)+"/"+$(k.value.total),1)):x("",!0)],10,Ri)]))}},Fi=Z(Bi,[["__scopeId","data-v-9406aba2"]]),Vi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ui=["title"],qi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},zi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=v(()=>t.sessions.get(e.sessionId)),i=v(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=v(()=>{const f=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[f]||"#d3d3d3"}),l=v(()=>{const f=i.value;return f==="starting"||f==="processing"||f==="pending-prompt"}),m=v(()=>{if(!o.value)return"No session selected";const f=i.value,p=f.charAt(0).toUpperCase()+f.slice(1).replace("-"," "),d=o.value.name||"Unnamed Session",k=o.value.role?` (${o.value.role})`:"";return`${d}${k}: ${p}`});return(f,p)=>(r(),c("div",Vi,[o.value?(r(),c("div",{key:0,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:at({width:"100%",backgroundColor:a.value}),title:m.value},null,14,Ui)):(r(),c("div",qi))]))}},Ki=Z(zi,[["__scopeId","data-v-63d222fe"]]),Gi={class:"session-status-bar border-top p-2 bg-light"},Yi={class:"d-flex justify-content-between align-items-center gap-2"},Ji={class:"d-flex gap-2"},Qi=["disabled"],Xi={class:"mode-label"},Zi=["disabled"],ea=["disabled"],ta={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=ve(),i=v(()=>t.sessions.get(e.sessionId)),a=v(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},m=v(()=>l[a.value]||"ðŸ”’"),f=v(()=>a.value),p=["default","acceptEdits","plan"],d=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(y){console.error("Failed to cycle permission mode:",y)}return}const g=(p.indexOf(a.value)+1)%p.length,u=p[g];try{await t.setPermissionMode(e.sessionId,u)}catch(y){console.error("Failed to cycle permission mode:",y)}},k=()=>{o.showModal("session-info",{sessionId:e.sessionId})},_=()=>{o.showModal("manage-session",{session:i.value})},w=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(b,g)=>(r(),c("div",Gi,[s("div",Yi,[s("div",Ji,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!i.value},[ee($(m.value)+" ",1),s("span",Xi,$(f.value),1)],8,Qi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:k,disabled:!i.value},[...g[0]||(g[0]=[ee(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Zi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!i.value},[...g[1]||(g[1]=[ee(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,ea)]),s("div",null,[s("button",{class:X(["btn btn-sm",ns(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:w}," â¬‡ï¸ "+$(ns(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},sa=Z(ta,[["__scopeId","data-v-fdcd3535"]]),Ce=mt("message",()=>{const n=R(new Map),e=R(new Map),t=R(new Map),o=R(new Map),i=R(new Map),a=R(new Map),l=R(new Map),m=R(new Map),f=v(()=>{const O=de();return n.value.get(O.currentSessionId)||[]}),p=v(()=>{const O=de();return e.value.get(O.currentSessionId)||[]});async function d(O,M=null,K=0){try{const L=M||1e4,D=await ue.get(`/api/sessions/${O}/messages?limit=${L}&offset=${K}`),z=D.messages||[],oe=D.total_count||z.length,Y=D.has_more||!1;if(console.log(`Loaded ${z.length} of ${oe} messages for session ${O}`),n.value.set(O,z),z.length>0){const B=z[z.length-1];B.timestamp&&(l.value.set(O,B.timestamp),console.log(`Tracked last received timestamp for session ${O}: ${B.timestamp}`))}const Q=new Set;z.forEach(B=>{B.type==="assistant"&&B.metadata?.tool_uses&&B.metadata.tool_uses.forEach(j=>{Q.add(j.id)}),B.type==="user"&&B.metadata?.tool_results&&B.metadata.tool_results.forEach(j=>{Q.delete(j.tool_use_id);const J=a.value.get(O);J&&J.delete(j.tool_use_id)}),B.type==="system"&&B.metadata?.subtype==="client_launched"&&(Q.forEach(j=>{P(O,j,"Session was restarted")}),Q.clear()),B.type==="system"&&B.metadata?.subtype==="interrupt"&&(Q.forEach(j=>{P(O,j,"Session was interrupted")}),Q.clear()),B.metadata?.has_tool_uses&&B.metadata.tool_uses&&B.metadata.tool_uses.forEach(j=>{g(O,j)}),B.metadata?.has_tool_results&&B.metadata.tool_results&&B.metadata.tool_results.forEach(j=>{h(O,j)}),(B.type==="permission_request"||B.metadata?.has_permission_requests)&&u(O,B),B.type==="permission_response"&&y(O,{request_id:B.metadata?.request_id,decision:B.metadata?.decision,updated_input:B.metadata?.updated_input,reasoning:B.metadata?.reasoning,applied_updates:B.metadata?.applied_updates}),B.type==="system"&&(B.subtype==="init"||B.metadata?.subtype==="init")&&B.metadata?.init_data&&de().storeInitData(O,B.metadata.init_data)});const me=de().sessions.get(O);me&&!["active","paused","starting"].includes(me.state)&&(Q.forEach(B=>{P(O,B,"Session was terminated")}),Q.clear()),i.value.set(O,Q),n.value=new Map(n.value);try{Rt().reconstructFromMessages(O,z)}catch(B){console.warn("Failed to reconstruct task state:",B)}return Y&&console.warn(`Warning: Only loaded ${z.length} of ${oe} messages. Some messages may be missing.`),{messages:z,totalCount:oe,hasMore:Y}}catch(L){throw console.error("Failed to load messages:",L),L}}function k(O,M){const K=i.value.get(O)||new Set;M.type==="assistant"&&M.metadata?.tool_uses&&M.metadata.tool_uses.forEach(L=>{K.add(L.id)}),M.type==="user"&&M.metadata?.tool_results&&M.metadata.tool_results.forEach(L=>{K.delete(L.tool_use_id);const D=a.value.get(O);D&&D.delete(L.tool_use_id)}),M.type==="system"&&M.metadata?.subtype==="client_launched"&&(K.forEach(L=>{P(O,L,"Session was restarted")}),K.clear()),M.type==="system"&&M.metadata?.subtype==="interrupt"&&(K.forEach(L=>{P(O,L,"Session was interrupted")}),K.clear()),i.value.set(O,K)}function _(O,M){n.value.has(O)||n.value.set(O,[]);const K=n.value.get(O);if(M.id){const L=K.findIndex(D=>D.id===M.id);if(L!==-1){console.log(`Skipping duplicate message ${M.id} (already exists at index ${L})`);return}}K.push(M),M.timestamp&&l.value.set(O,M.timestamp),I(O,M),k(O,M),n.value=new Map(n.value)}function w(O,M){e.value.has(O)||e.value.set(O,[]),e.value.get(O).push(M),e.value=new Map(e.value)}function b(O,M,K){const L=e.value.get(O);if(L){const D=L.find(z=>z.id===M);D&&(Object.assign(D,K),e.value=new Map(e.value))}}function g(O,M){const K=E(M.name,M.input);t.value.set(K,M.id);const L={id:M.id,name:M.name,input:M.input,signature:K,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return w(O,L),console.log(`Created tool call ${L.id} for ${L.name}`),L}function u(O,M){console.log("handlePermissionRequest received:",M);const K=M.metadata?.tool_name||M.tool_name,L=M.metadata?.input_params||M.input_params,D=M.metadata?.request_id||M.request_id,z=M.metadata?.suggestions||M.suggestions||[];console.log("Extracted data:",{toolName:K,inputParams:L,requestId:D,suggestions:z});const oe=E(K,L),Y=t.value.get(oe);Y?(o.value.set(D,Y),b(O,Y,{status:"permission_required",permissionRequestId:D,suggestions:z}),console.log(`Permission required for tool ${Y}`,{suggestions:z})):console.warn("No tool use ID found for permission request signature:",oe,{toolName:K,inputParams:L,availableSignatures:Array.from(t.value.keys())})}function y(O,M){const K=o.value.get(M.request_id);if(K){const L={permissionDecision:M.decision,appliedUpdates:M.applied_updates||[]};M.decision==="allow"?L.status="executing":(L.status="completed",L.result={error:!0,message:M.reasoning||"Permission denied"},L.isExpanded=!1),M.updated_input&&(L.input=M.updated_input),b(O,K,L),console.log(`Permission ${M.decision} for tool ${K}`)}}function h(O,M){const K=M.tool_use_id;b(O,K,{status:M.is_error?"error":"completed",result:{error:M.is_error,content:M.content},isExpanded:!1}),console.log(`Tool ${K} ${M.is_error?"failed":"completed"}`);const L=e.value.get(O);if(L){const D=L.find(z=>z.id===K);if(D&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(D.name))try{Rt().handleTaskToolResult(O,D.name,D.input,{error:M.is_error,content:M.content})}catch(z){console.warn("Failed to update task store:",z)}}}function S(O,M){const K=e.value.get(O);if(K){const L=K.find(D=>D.id===M);L&&(L.isExpanded=!L.isExpanded,e.value=new Map(e.value))}}function E(O,M){if(!O)return"unknown:{}";if(!M||typeof M!="object")return`${O}:{}`;const K=JSON.stringify(M,Object.keys(M).sort());return`${O}:${K}`}function I(O,M){const K=M.metadata?.display||M.display;if(!K)return;m.value.has(O)||m.value.set(O,new Map);const L=m.value.get(O);if(K.tool_states)for(const[D,z]of Object.entries(K.tool_states)){L.set(D,z);const oe=e.value.get(O);if(oe){const Y=oe.find(Q=>Q.id===D);if(Y){const Q={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Y.status=Q[z.state]||z.state,Y.backendState=z}}}if(K.orphaned_tools&&K.orphaned_tools.length>0){const D=a.value.get(O)||new Map;for(const z of K.orphaned_tools)D.has(z)||D.set(z,{reason:"denied",message:"Session was interrupted"});a.value.set(O,D)}if(K.linked_permissions)for(const[D,z]of Object.entries(K.linked_permissions))o.value.set(D,z);K.tool_states&&Object.keys(K.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${O}:`,{toolStates:Object.keys(K.tool_states||{}).length,orphanedTools:(K.orphaned_tools||[]).length,linkedPermissions:Object.keys(K.linked_permissions||{}).length})}function N(O,M){return m.value.get(O)?.get(M)}function A(O){const M=m.value.get(O);return M&&M.size>0}function P(O,M,K){const L=a.value.get(O)||new Map;L.set(M,{reason:"denied",message:K}),a.value.set(O,L);const D=e.value.get(O);if(D){const z=D.find(oe=>oe.id===M);z&&z.isExpanded&&(z.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${M} as orphaned: ${K}`)}function C(O,M){const K=N(O,M);return K&&K.state==="orphaned"?!0:a.value.get(O)?.has(M)||!1}function T(O,M){const K=N(O,M);return K&&K.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:K}:a.value.get(O)?.get(M)}function U(O,M){const K=i.value.get(O);K&&K.size>0&&(K.forEach(L=>P(O,L,M)),K.clear())}function q(O){n.value.delete(O),e.value.delete(O),n.value=new Map(n.value),e.value=new Map(e.value)}function W(O){return l.value.get(O)}async function H(O){const M=l.value.get(O);if(!M)return console.log(`No sync needed for session ${O} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${O} since ${M}`);const K=await ue.get(`/api/sessions/${O}/messages?limit=1000&offset=0`),L=K.messages||[],D=K.has_more||!1,z=j=>j?typeof j=="number"?j*1e3:new Date(j).getTime():0,oe=z(M),Y=L.filter(j=>j.timestamp?z(j.timestamp)>oe:!1);if(Y.length===0)return console.log(`No missed messages for session ${O}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Y.length} missed messages for session ${O}`);const Q=n.value.get(O)||[],re=new Set(Q.map(j=>j.id).filter(Boolean)),me=Y.filter(j=>!j.id||!re.has(j.id));if(console.log(`After deduplication: ${me.length} unique new messages`),me.length>0){const j=me.sort((Ie,Ye)=>{const V=z(Ie.timestamp),ae=z(Ye.timestamp);return V-ae}),J=n.value.get(O)||[],te=J.length>0?z(J[J.length-1].timestamp):0,ie=z(j[0].timestamp),he=z(j[j.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:J.length,lastExisting:te,lastExistingDate:J.length>0?J[J.length-1].timestamp:"none",firstNew:ie,firstNewDate:j[0].timestamp,lastNew:he,lastNewDate:j[j.length-1].timestamp,shouldAppend:ie>te}),ie>te){const Ie=[...J,...j];n.value.set(O,Ie),console.log(`âœ… Appended ${j.length} new messages (no full sort needed)`)}else{const Ie=[...J,...j].sort((Ye,V)=>{const ae=z(Ye.timestamp),ce=z(V.timestamp);return ae-ce});n.value.set(O,Ie),console.log(`âš ï¸ Merged and sorted ${j.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${Q.length} messages unchanged`);me.forEach(j=>{k(O,j),j.metadata?.has_tool_uses&&j.metadata.tool_uses&&j.metadata.tool_uses.forEach(J=>{g(O,J)}),j.metadata?.has_tool_results&&j.metadata.tool_results&&j.metadata.tool_results.forEach(J=>{h(O,J)}),(j.type==="permission_request"||j.metadata?.has_permission_requests)&&u(O,j),j.type==="permission_response"&&y(O,{request_id:j.metadata?.request_id,decision:j.metadata?.decision,updated_input:j.metadata?.updated_input,reasoning:j.metadata?.reasoning,applied_updates:j.metadata?.applied_updates}),j.type==="system"&&(j.subtype==="init"||j.metadata?.subtype==="init")&&j.metadata?.init_data&&de().storeInitData(O,j.metadata.init_data)});const B=n.value.get(O);if(B&&B.length>0){const j=B[B.length-1];j.timestamp&&l.value.set(O,j.timestamp)}return n.value=new Map(n.value),{syncedCount:me.length,hasMore:D}}catch(K){return console.error(`Failed to sync messages for session ${O}:`,K),{syncedCount:0,hasMore:!1,error:K.message}}}const F=de();return fe(()=>Array.from(F.sessions.values()).map(M=>({id:M.session_id,state:M.state})),(O,M)=>{M&&O.forEach((K,L)=>{const D=M[L];if(!D||D.id!==K.id)return;const z=["active","paused","starting"].includes(D.state),oe=!["active","paused","starting"].includes(K.state);z&&oe&&U(K.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:gs(i),orphanedToolUses:gs(a),currentMessages:f,currentToolCalls:p,loadMessages:d,addMessage:_,addToolCall:w,updateToolCall:b,handleToolUse:g,handlePermissionRequest:u,handlePermissionResponse:y,handleToolResult:h,toggleToolExpansion:S,clearMessages:q,markToolUseOrphaned:P,isToolUseOrphaned:C,getOrphanedInfo:T,clearOrphanedToolUses:U,getLastReceivedTimestamp:W,syncMessages:H,getBackendToolState:N,hasBackendDisplayMetadata:A,backendToolStates:gs(m)}}),na=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ce},Symbol.toStringTag,{value:"Module"}));function oa(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ht(n){return oa(n).toLocaleTimeString()}const ia={class:"message-row message-row-user"},aa=["title"],ra={class:"message-content-column"},la=["innerHTML"],ca={key:0,class:"tool-results mt-2"},ua={class:"tool-results-header text-muted small mb-2"},da={class:"d-flex align-items-start gap-2"},ma={class:"flex-grow-1"},pa={class:"text-muted"},fa={key:0,class:"text-danger small"},va={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;lt.setOptions({breaks:!0,gfm:!0});const t=v(()=>Ht(e.message.timestamp)),o=v(()=>`user
${t.value}`),i=v(()=>{const f=e.message.content||"";let p=lt.parse(f);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),ls.sanitize(p)}),a=v(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=v(()=>e.message.metadata?.tool_results||[]);function m(f,p){return f?f.length<=p?f:f.substring(0,p)+"...":""}return(f,p)=>(r(),c("div",ia,[s("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,aa),s("div",ra,[s("div",{class:"message-text",innerHTML:i.value},null,8,la),a.value?(r(),c("div",ca,[s("div",ua," ðŸ”§ Tool Results ("+$(l.value.length)+") ",1),(r(!0),c(ne,null,le(l.value,(d,k)=>(r(),c("div",{key:k,class:X(["tool-result-summary p-2 mb-2 rounded",d.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",da,[s("span",null,$(d.is_error?"âŒ":"âœ…"),1),s("div",ma,[s("small",pa,"Tool: "+$(d.tool_use_id),1),d.is_error?(r(),c("div",fa,$(m(d.content,200)),1)):x("",!0)])])],2))),128))])):x("",!0)])]))}},ha=Z(va,[["__scopeId","data-v-7665755b"]]),_a={class:"thinking-block"},ga=["aria-label"],ba={class:"text-muted ms-auto"},ya={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},$a=["innerHTML"],wa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=R(!1),o=v(()=>e.thinking?.length||0),i=v(()=>{const l=e.thinking||"",m=lt.parse(l);return ls.sanitize(m)});function a(){t.value=!t.value}return(l,m)=>(r(),c("div",_a,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("span",{"aria-label":t.value?"Collapse":"Expand"},$(t.value?"â–¾":"â–¸"),9,ga),m[0]||(m[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",ba,$(o.value)+" characters",1)]),t.value?(r(),c("div",ya,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,$a)])):x("",!0)]))}},ka=Z(wa,[["__scopeId","data-v-fda2352c"]]),et=mt("websocket",()=>{const n=R(null),e=R(!1),t=R(0),o=10,i=R(null),a=R(!1),l=R(0),m=5,f=R(null);let p=null;const d=R(0),k=R(null),_=R(new Map),w=R(null),b=R(!1),g=R(0),u=5,y=R(null),h=1e4,S=1e3,E=R(Date.now()),I=R(Date.now()),N=R(Date.now());let A=null,P=null,C=null;const T=v(()=>e.value&&(a.value||!f.value)?"connected":e.value?"partial":"disconnected");function U(B){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${B}`}function q(B){const j={ui:{timer:()=>A,setTimer:J=>{A=J},lastPing:E,connected:e,name:"UI"},session:{timer:()=>P,setTimer:J=>{P=J},lastPing:I,connected:a,name:"Session"},legion:{timer:()=>C,setTimer:J=>{C=J},lastPing:N,connected:b,name:"Legion"}}[B];j.timer()&&clearInterval(j.timer()),j.setTimer(setInterval(()=>{if(!j.connected.value)return;const J=Date.now()-j.lastPing.value;if(J>h){console.warn(`âš ï¸ ${j.name} WebSocket heartbeat timeout (${J}ms since last ping) - forcing close to trigger reconnection`),j.connected.value=!1;const ie={ui:n,session:i,legion:w}[B];ie.value&&ie.value.readyState===WebSocket.OPEN&&ie.value.close()}},S)),console.log(`âœ… Started heartbeat monitor for ${j.name} WebSocket`)}function W(B){const j={ui:{get:()=>A,set:J=>{A=J}},session:{get:()=>P,set:J=>{P=J}},legion:{get:()=>C,set:J=>{C=J}}}[B];j.get()&&(clearInterval(j.get()),j.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${B} WebSocket`))}function H(){if(n.value)return;const B=U("/ws/ui");console.log(`Connecting to UI WebSocket: ${B}`),n.value=new WebSocket(B),n.value.onopen=()=>{e.value=!0,t.value=0,E.value=Date.now(),q("ui"),console.log("UI WebSocket connected")},n.value.onmessage=j=>{const J=JSON.parse(j.data);oe(J)},n.value.onclose=()=>{if(W("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const j=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${j}ms (attempt ${t.value})`),setTimeout(H,j)}},n.value.onerror=j=>{console.error("UI WebSocket error:",j)}}function F(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function O(B){d.value++;const j=d.value;if(console.log(`[Gen ${j}] Starting connection to session ${B}`),p&&(clearTimeout(p),p=null),await M(),d.value!==j){console.log(`[Gen ${j}] Connection cancelled (current generation: ${d.value})`);return}f.value=B,k.value=j;const J=U(`/ws/session/${B}`);console.log(`[Gen ${j}] Connecting to Session WebSocket: ${J}`),i.value=new WebSocket(J),i.value.onopen=async()=>{if(k.value!==j){console.log(`[Gen ${j}] Ignoring onopen (stale connection, current: ${k.value})`),i.value.close();return}a.value=!0,l.value=0,I.value=Date.now(),q("session"),console.log(`[Gen ${j}] Session WebSocket connected for ${B}`);const te=_.value.get(B);if(_.value.set(B,!0),te){console.log(`[Gen ${j}] Reconnection detected, syncing missed messages...`);try{const he=await Ce().syncMessages(B);he.syncedCount>0?console.log(`[Gen ${j}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${j}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${j}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${j}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ie){console.error(`[Gen ${j}] Error during message sync:`,ie)}}else console.log(`[Gen ${j}] Initial connection, no sync needed`)},i.value.onmessage=te=>{if(k.value!==j){console.log(`[Gen ${j}] Ignoring message (stale connection, current: ${k.value})`);return}const ie=JSON.parse(te.data);Y(ie,B)},i.value.onclose=()=>{W("session"),a.value=!1,i.value=null,console.log(`[Gen ${j}] Session WebSocket closed for ${B}`);const te=de();if(te.currentSessionId===B&&k.value===j&&l.value<m){l.value++;const ie=Math.min(2e3*l.value,3e4);console.log(`[Gen ${j}] Reconnecting Session WebSocket in ${ie}ms (attempt ${l.value})`),p=setTimeout(()=>{k.value===j&&te.currentSessionId===B?(p=null,O(B)):console.log(`[Gen ${j}] Skipping reconnect (generation or session changed)`)},ie)}},i.value.onerror=te=>{console.error(`[Gen ${j}] Session WebSocket error:`,te)}}function M(){return new Promise(B=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),i.value){const j=f.value,J=()=>{i.value=null,a.value=!1,f.value=null,k.value=null,l.value=0,j&&_.value.delete(j),B()};if(i.value.readyState===WebSocket.CLOSED)J();else{const te=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),J()},2e3);i.value.addEventListener("close",()=>{clearTimeout(te),J()},{once:!0}),i.value.close()}}else f.value=null,k.value=null,B()})}function K(B){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:B})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function L(B,j,J=!1,te=null){if(i.value&&a.value){const ie={type:"permission_response",request_id:B,decision:j,apply_suggestions:J,timestamp:new Date().toISOString()};te&&(ie.clarification_message=te),i.value.send(JSON.stringify(ie)),console.log(`Sent permission ${j} for request ${B}`,{applySuggestions:J,clarification:te})}}function D(B,j,J){if(i.value&&a.value){const te={type:"permission_response",request_id:B,decision:j,updated_input:J,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(te)),console.log(`Sent permission ${j} with updated_input for request ${B}`,J)}}function z(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function oe(B){const j=de(),J=Le();switch(B.type){case"sessions_list":B.sessions&&Array.isArray(B.sessions)&&B.sessions.forEach(te=>{j.updateSession(te.session_id,te)});break;case"state_change":B.data&&B.data.session_id&&B.data.session&&j.updateSession(B.data.session_id,B.data.session);break;case"project_updated":if(B.data&&B.data.project){const te=B.data.project;J.updateProjectLocal(te.project_id,te),j.fetchSessions()}break;case"project_deleted":B.data&&B.data.project_id&&J.projects.delete(B.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":E.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",B.type)}}function Y(B,j){const J=de();if(J.currentSessionId!==j){console.warn(`Ignoring message for session ${j} (current: ${J.currentSessionId})`);return}const te=Ce();switch(B.type){case"message":const ie=B.data;if(!ie||!ie.type){console.warn("Received message event with invalid data:",B);break}if(ie.type==="permission_request"){te.handlePermissionRequest(j,ie);break}if(ie.type==="permission_response"){te.handlePermissionResponse(j,ie);break}ie.metadata?.has_tool_uses&&ie.metadata.tool_uses.forEach(he=>{te.handleToolUse(j,he)}),ie.metadata?.has_tool_results&&ie.metadata.tool_results.forEach(he=>{te.handleToolResult(j,he)}),ie.type==="system"&&(ie.subtype==="init"||ie.metadata?.subtype==="init")&&ie.metadata?.init_data&&J.storeInitData(j,ie.metadata.init_data),te.addMessage(j,ie);break;case"permission_request":te.handlePermissionRequest(j,B);break;case"permission_response":te.handlePermissionResponse(j,B);break;case"tool_result":te.handleToolResult(j,B);break;case"state_change":J.updateSession(j,B.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${j}`);break;case"ping":I.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",B.type)}}function Q(B){re(),y.value=B;const j=U(`/ws/legion/${B}`);console.log(`Connecting to Legion WebSocket: ${j}`),w.value=new WebSocket(j),w.value.onopen=()=>{b.value=!0,g.value=0,N.value=Date.now(),q("legion"),console.log(`Legion WebSocket connected for ${B}`)},w.value.onmessage=J=>{const te=JSON.parse(J.data);me(te,B)},w.value.onclose=()=>{if(W("legion"),b.value=!1,w.value=null,console.log(`Legion WebSocket closed for ${B}`),y.value===B&&g.value<u){g.value++;const J=Math.min(2e3*g.value,3e4);setTimeout(()=>Q(B),J)}},w.value.onerror=J=>{console.error("Legion WebSocket error:",J)}}function re(){w.value&&(w.value.close(),w.value=null,b.value=!1,y.value=null)}function me(B,j){Oe(async()=>{const{useLegionStore:J}=await Promise.resolve().then(()=>yb);return{useLegionStore:J}},void 0).then(({useLegionStore:J})=>{const te=J();switch(B.type){case"comm":B.comm&&(te.addComm(j,B.comm),console.log("Legion WebSocket: Received new comm",B.comm));break;case"minion_created":B.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",B.data),Oe(async()=>{const{useSessionStore:ie}=await Promise.resolve().then(()=>_n);return{useSessionStore:ie}},void 0).then(({useSessionStore:ie})=>{ie().loadSessions()}));break;case"minion_updated":B.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",B.data),Oe(async()=>{const{useSessionStore:ie}=await Promise.resolve().then(()=>_n);return{useSessionStore:ie}},void 0).then(({useSessionStore:ie})=>{ie().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${j}`);break;case"ping":N.value=Date.now(),w.value?.readyState===WebSocket.OPEN&&w.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",B.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:a,sessionRetryCount:l,legionConnected:b,legionRetryCount:g,overallStatus:T,connectUI:H,disconnectUI:F,connectSession:O,disconnectSession:M,sendMessage:K,sendPermissionResponse:L,sendPermissionResponseWithInput:D,interruptSession:z,connectLegion:Q,disconnectLegion:re}}),Ea=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:et},Symbol.toStringTag,{value:"Module"})),Sa={class:"base-tool-handler"},Ca={class:"tool-section"},Ta={class:"tool-parameters"},xa={class:"tool-code"},Aa={key:0,class:"tool-section"},Oa={class:"tool-section-label"},Ma={class:"tool-code"},Da={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=v(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,m)=>(r(),c("div",Sa,[s("div",Ca,[m[0]||(m[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",Ta,[s("pre",xa,$(t.value),1)])]),o.value?(r(),c("div",Aa,[s("div",Oa,$(i.value?"Error:":"Result:"),1),s("div",{class:X(["tool-result",{"tool-result-error":i.value}])},[s("pre",Ma,$(a.value),1)],2)])):x("",!0)]))}},Na=Z(Da,[["__scopeId","data-v-1e69f57d"]]),La={class:"read-tool-handler"},ja={class:"tool-section"},Ia={class:"read-file-info"},Pa={class:"file-path"},Ra={key:0,class:"read-range"},Wa={key:0,class:"tool-section"},Ha={key:0,class:"tool-result tool-result-error"},Ba={class:"tool-code"},Fa={key:1,class:"file-content-preview"},Va={class:"content-header"},Ua={class:"line-count-badge"},qa={key:0,class:"preview-note"},za={class:"tool-code content-display"},Ka={key:0,class:"more-indicator"},ws=100,Ga={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>{const w=e.toolCall.input?.offset,b=e.toolCall.input?.limit;return w!==void 0||b!==void 0}),i=v(()=>{const w=e.toolCall.input?.offset;return w!==void 0?w+1:1}),a=v(()=>{const w=e.toolCall.input?.offset||0,b=e.toolCall.input?.limit;return b!==void 0?w+b:"âˆž"}),l=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=v(()=>{if(!l.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)}),p=v(()=>m.value||!f.value?[]:f.value.split(`
`)),d=v(()=>p.value.length),k=v(()=>d.value>ws),_=v(()=>m.value?"":p.value.slice(0,ws).join(`
`));return(w,b)=>(r(),c("div",La,[s("div",ja,[s("div",Ia,[b[0]||(b[0]=s("span",{class:"file-icon"},"ðŸ“„",-1)),b[1]||(b[1]=s("strong",null,"Reading:",-1)),s("code",Pa,$(t.value),1),o.value?(r(),c("span",Ra,"Lines "+$(i.value)+"-"+$(a.value),1)):x("",!0)])]),l.value?(r(),c("div",Wa,[m.value?(r(),c("div",Ha,[s("pre",Ba,$(f.value),1)])):(r(),c("div",Fa,[s("div",Va,[b[2]||(b[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Ua,$(d.value)+" lines",1),k.value?(r(),c("span",qa,"(showing first "+$(ws)+")")):x("",!0)]),s("pre",za,$(_.value),1),k.value?(r(),c("div",Ka,"...")):x("",!0)]))])):x("",!0)]))}},Ya=Z(Ga,[["__scopeId","data-v-1f2b0569"]]),Ja={class:"write-tool-handler"},Qa={class:"tool-section"},Xa={class:"write-file-info mb-2"},Za={class:"file-path"},er={class:"write-content-preview"},tr={class:"content-header"},sr={class:"line-count-badge"},nr={key:0,class:"preview-note"},or={class:"tool-code content-display"},ir={key:0,class:"more-indicator"},ar={key:0,class:"tool-section"},rr={key:0,class:"tool-result tool-result-error"},lr={class:"tool-code"},cr={key:1,class:"tool-result tool-result-success"},ur={class:"success-message"},ks=100,dr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.content||""),i=v(()=>o.value.split(`
`)),a=v(()=>i.value.length),l=v(()=>a.value>ks),m=v(()=>i.value.slice(0,ks).join(`
`)),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!f.value)return"";const k=e.toolCall.result;return k.content!==void 0?typeof k.content=="string"?k.content:JSON.stringify(k.content,null,2):k.message?k.message:JSON.stringify(k,null,2)});return(k,_)=>(r(),c("div",Ja,[s("div",Qa,[s("div",Xa,[_[0]||(_[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),_[1]||(_[1]=s("strong",null,"Writing:",-1)),s("code",Za,$(t.value),1)]),s("div",er,[s("div",tr,[_[2]||(_[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",sr,$(a.value)+" lines",1),l.value?(r(),c("span",nr,"(showing first "+$(ks)+")")):x("",!0)]),s("pre",or,$(m.value),1),l.value?(r(),c("div",ir,"...")):x("",!0)])]),f.value?(r(),c("div",ar,[p.value?(r(),c("div",rr,[_[3]||(_[3]=s("strong",null,"Error:",-1)),s("pre",lr,$(d.value),1)])):(r(),c("div",cr,[s("div",ur,[_[4]||(_[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):x("",!0)]))}},mr=Z(dr,[["__scopeId","data-v-ddc24a0f"]]),pr={class:"bash-tool-handler"},fr={class:"tool-section"},vr={class:"bash-header"},hr={class:"bash-header-content"},_r={key:0,class:"bash-description"},gr={key:1,class:"bash-flags"},br={class:"bash-command-section"},yr={class:"bash-command-content"},$r={key:0,class:"tool-section"},wr={key:0,class:"bash-output"},kr={key:1,class:"bash-output-empty"},Er={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.command||""),o=v(()=>e.toolCall.input?.description||""),i=v(()=>e.toolCall.input?.timeout),a=v(()=>e.toolCall.input?.run_in_background||!1),l=v(()=>i.value||a.value),m=v(()=>{const _=[];return i.value&&_.push(`timeout: ${i.value}ms`),a.value&&_.push("background"),_.join(", ")}),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>p.value?"tool-result-error":"tool-result-success"),k=v(()=>{if(!f.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,w)=>(r(),c("div",pr,[s("div",fr,[s("div",vr,[w[1]||(w[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",hr,[o.value?(r(),c("div",_r,[w[0]||(w[0]=s("strong",null,"Description:",-1)),ee(" "+$(o.value),1)])):x("",!0),l.value?(r(),c("div",gr,$(m.value),1)):x("",!0)])]),s("div",br,[w[2]||(w[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",yr,$(t.value),1)])]),f.value?(r(),c("div",$r,[s("div",{class:X(["tool-result",d.value])},[w[3]||(w[3]=s("strong",null,"Output:",-1)),k.value?(r(),c("pre",wr,$(k.value),1)):(r(),c("div",kr,"No output"))],2)])):x("",!0)]))}},Sr=Z(Er,[["__scopeId","data-v-ab50fe73"]]),Cr={class:"todo-tool-handler"},Tr={class:"tool-section"},xr={class:"todo-header"},Ar={class:"todo-summary"},Or={key:0,class:"todo-count todo-count-completed"},Mr={key:1,class:"todo-count todo-count-in-progress"},Dr={key:2,class:"todo-count todo-count-pending"},Nr={class:"todo-checklist"},Lr={class:"todo-checkbox"},jr={class:"todo-content"},Ir={key:0,class:"tool-section"},Pr={key:0,class:"tool-result tool-result-error"},Rr={class:"tool-code"},Wr={key:1,class:"tool-result tool-result-success"},Hr={class:"success-message"},Br={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.todos||[]),o=v(()=>t.value.filter(d=>d.status==="completed").length),i=v(()=>t.value.filter(d=>d.status==="in_progress").length),a=v(()=>t.value.filter(d=>d.status==="pending").length);function l(d){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[d]||"â˜"}const m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=v(()=>{if(!m.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,k)=>(r(),c("div",Cr,[s("div",Tr,[s("div",xr,[k[0]||(k[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),k[1]||(k[1]=s("strong",null,"Task List:",-1)),s("div",Ar,[o.value>0?(r(),c("span",Or,$(o.value)+" completed ",1)):x("",!0),i.value>0?(r(),c("span",Mr,$(i.value)+" in progress ",1)):x("",!0),a.value>0?(r(),c("span",Dr,$(a.value)+" pending ",1)):x("",!0)])]),s("div",Nr,[(r(!0),c(ne,null,le(t.value,(_,w)=>(r(),c("div",{key:w,class:X(["todo-item",`todo-${_.status}`])},[s("span",Lr,$(l(_.status)),1),s("span",jr,$(_.content),1)],2))),128))])]),m.value?(r(),c("div",Ir,[f.value?(r(),c("div",Pr,[k[2]||(k[2]=s("strong",null,"Error:",-1)),s("pre",Rr,$(p.value),1)])):(r(),c("div",Wr,[s("div",Hr,[k[3]||(k[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+$(t.value.length)+" tasks)",1)])]))])):x("",!0)]))}},Fr=Z(Br,[["__scopeId","data-v-bbe55ee7"]]),Vr={class:"edit-tool-handler"},Ur={class:"tool-section"},qr={class:"edit-file-info"},zr={class:"file-path"},Kr={key:0,class:"replace-all-badge"},Gr={class:"edit-diff-container"},Yr={class:"diff-header"},Jr={class:"diff-stats"},Qr={class:"stat-removed"},Xr={class:"stat-added"},Zr={class:"unified-diff"},el={class:"diff-scroll-container"},tl={class:"diff-marker"},sl={class:"diff-content"},nl={key:0,class:"tool-section"},ol={key:0,class:"tool-result tool-result-error"},il={class:"tool-code"},al={key:1,class:"tool-result tool-result-success"},rl={class:"success-message"},ll={key:0,class:"success-detail"},cl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.old_string||""),i=v(()=>e.toolCall.input?.new_string||""),a=v(()=>e.toolCall.input?.replace_all||!1),l=v(()=>{const w=Si(t.value,o.value,i.value,"","",{context:3}).split(`
`),b=[];for(let g=4;g<w.length;g++){const u=w[g];u&&(u.startsWith("-")?b.push({type:"removed",content:u.substring(1)}):u.startsWith("+")?b.push({type:"added",content:u.substring(1)}):u.startsWith(" ")?b.push({type:"context",content:u.substring(1)}):u.startsWith("@@")&&b.push({type:"hunk",content:u}))}return b}),m=v(()=>l.value.filter(_=>_.type==="removed").length),f=v(()=>l.value.filter(_=>_.type==="added").length),p=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!p.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,w)=>(r(),c("div",Vr,[s("div",Ur,[s("div",qr,[w[0]||(w[0]=s("span",{class:"file-icon"},"âœï¸",-1)),w[1]||(w[1]=s("strong",null,"Editing:",-1)),s("code",zr,$(t.value),1),a.value?(r(),c("span",Kr,"Replace All")):x("",!0)]),s("div",Gr,[s("div",Yr,[w[2]||(w[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Jr,[s("span",Qr,"-"+$(m.value),1),s("span",Xr,"+"+$(f.value),1)])]),s("div",Zr,[s("div",el,[(r(!0),c(ne,null,le(l.value,(b,g)=>(r(),c("div",{key:g,class:X(["diff-line",{"diff-line-removed":b.type==="removed","diff-line-added":b.type==="added","diff-line-context":b.type==="context","diff-line-hunk":b.type==="hunk"}])},[s("span",tl,$(b.type==="removed"?"-":b.type==="added"?"+":b.type==="hunk"?"@":" "),1),s("span",sl,$(b.content),1)],2))),128))])])])]),p.value?(r(),c("div",nl,[d.value?(r(),c("div",ol,[w[3]||(w[3]=s("strong",null,"Error:",-1)),s("pre",il,$(k.value),1)])):(r(),c("div",al,[s("div",rl,[w[4]||(w[4]=s("span",{class:"success-icon"},"âœ…",-1)),w[5]||(w[5]=s("strong",null,"File edited successfully",-1)),a.value?(r(),c("span",ll,"(all occurrences replaced)")):x("",!0)])]))])):x("",!0)]))}},ul=Z(cl,[["__scopeId","data-v-dd74055e"]]),dl={class:"search-tool-handler"},ml={class:"tool-section"},pl={class:"search-info"},fl={class:"search-icon"},vl={class:"search-pattern"},hl={key:0,class:"search-path"},_l={key:1,class:"search-filters"},gl={key:0,class:"filter-badge"},bl={key:1,class:"filter-badge"},yl={key:2,class:"filter-badge"},$l={key:0,class:"tool-section"},wl={key:0,class:"tool-result tool-result-error"},kl={class:"tool-code"},El={key:1,class:"search-results"},Sl={class:"results-header"},Cl={class:"results-label"},Tl={class:"results-count-badge"},xl={class:"results-content"},Al={class:"tool-code"},Ol={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="Grep"),o=v(()=>e.toolCall.input?.pattern||"Unknown"),i=v(()=>e.toolCall.input?.path||null),a=v(()=>e.toolCall.input?.type||null),l=v(()=>e.toolCall.input?.glob||null),m=v(()=>e.toolCall.input?.["-i"]||!1),f=v(()=>a.value||l.value||m.value),p=v(()=>t.value?"ðŸ”":"ðŸ“"),d=v(()=>t.value?"Searching content":"Finding files"),k=v(()=>t.value?"Matches":"Files found"),_=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!_.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)}),g=v(()=>!_.value||w.value||!b.value?0:b.value.split(`
`).filter(y=>y.trim()).length);return(u,y)=>(r(),c("div",dl,[s("div",ml,[s("div",pl,[s("span",fl,$(p.value),1),s("strong",null,$(d.value)+":",1),s("code",vl,$(o.value),1),i.value?(r(),c("span",hl,"in "+$(i.value),1)):x("",!0),f.value?(r(),c("span",_l,[a.value?(r(),c("span",gl,"type: "+$(a.value),1)):x("",!0),l.value?(r(),c("span",bl,"glob: "+$(l.value),1)):x("",!0),m.value?(r(),c("span",yl,"case-insensitive")):x("",!0)])):x("",!0)])]),_.value?(r(),c("div",$l,[w.value?(r(),c("div",wl,[y[0]||(y[0]=s("strong",null,"Error:",-1)),s("pre",kl,$(b.value),1)])):(r(),c("div",El,[s("div",Sl,[s("span",Cl,$(k.value)+":",1),s("span",Tl,$(g.value)+" "+$(g.value===1?"match":"matches"),1)]),s("div",xl,[s("pre",Al,$(b.value),1)])]))])):x("",!0)]))}},gn=Z(Ol,[["__scopeId","data-v-0d272c39"]]),Ml={class:"web-tool-handler"},Dl={class:"tool-section"},Nl={class:"web-info"},Ll={class:"web-icon"},jl=["href"],Il={key:1,class:"web-query"},Pl={key:0,class:"web-prompt-container"},Rl={class:"prompt-content"},Wl={key:1,class:"web-domains"},Hl={class:"domains-label"},Bl={key:0,class:"tool-section"},Fl={key:0,class:"tool-result tool-result-error"},Vl={class:"tool-code"},Ul={key:1,class:"web-results"},ql={class:"results-header"},zl={class:"results-label"},Kl={class:"results-content"},Gl={class:"tool-code"},Yl={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="WebFetch"),o=v(()=>e.toolCall.input?.url||null),i=v(()=>e.toolCall.input?.query||null),a=v(()=>e.toolCall.input?.prompt||null),l=v(()=>e.toolCall.input?.allowed_domains||[]),m=v(()=>e.toolCall.input?.blocked_domains||[]),f=v(()=>l.value.length>0?l.value:m.value.length>0?m.value:[]),p=v(()=>l.value.length>0?"Allowed domains":m.value.length>0?"Blocked domains":"Domains"),d=v(()=>t.value?"ðŸŒ":"ðŸ”Ž"),k=v(()=>t.value?"Fetching URL":"Searching web"),_=v(()=>t.value?"Fetched content":"Search results"),w=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),b=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=v(()=>{if(!w.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,y)=>(r(),c("div",Ml,[s("div",Dl,[s("div",Nl,[s("span",Ll,$(d.value),1),s("strong",null,$(k.value)+":",1),o.value?(r(),c("a",{key:0,href:o.value,target:"_blank",class:"web-url"},$(o.value),9,jl)):i.value?(r(),c("code",Il,$(i.value),1)):x("",!0)]),a.value?(r(),c("div",Pl,[y[0]||(y[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Rl,$(a.value),1)])):x("",!0),f.value.length>0?(r(),c("div",Wl,[s("span",Hl,$(p.value)+":",1),(r(!0),c(ne,null,le(f.value,h=>(r(),c("span",{key:h,class:"domain-badge"},$(h),1))),128))])):x("",!0)]),w.value?(r(),c("div",Bl,[b.value?(r(),c("div",Fl,[y[1]||(y[1]=s("strong",null,"Error:",-1)),s("pre",Vl,$(g.value),1)])):(r(),c("div",Ul,[s("div",ql,[s("span",zl,$(_.value)+":",1)]),s("div",Kl,[s("pre",Gl,$(g.value),1)])]))])):x("",!0)]))}},bn=Z(Yl,[["__scopeId","data-v-62b55b55"]]),Jl={class:"task-tool-handler"},Ql={class:"tool-section"},Xl={class:"task-header"},Zl={key:0,class:"agent-type-badge"},ec={key:0,class:"task-description"},tc={class:"description-content"},sc={key:1,class:"task-prompt-container"},nc={class:"prompt-header"},oc={class:"prompt-length"},ic={class:"prompt-code"},ac={key:0,class:"tool-section"},rc={key:0,class:"tool-result tool-result-error"},lc={class:"tool-code"},cc={key:1,class:"agent-output"},uc={class:"output-header"},dc={key:0,class:"output-count-badge"},mc={class:"output-content"},pc={class:"tool-code"},fc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.description||null),o=v(()=>e.toolCall.input?.prompt||null),i=v(()=>e.toolCall.input?.subagent_type||null),a=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=v(()=>{if(!a.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),f=v(()=>m.value?m.value.split(`
`).length:0);return(p,d)=>(r(),c("div",Jl,[s("div",Ql,[s("div",Xl,[d[0]||(d[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),d[1]||(d[1]=s("strong",null,"Agent Task:",-1)),i.value?(r(),c("span",Zl,$(i.value),1)):x("",!0)]),t.value?(r(),c("div",ec,[d[2]||(d[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",tc,$(t.value),1)])):x("",!0),o.value?(r(),c("div",sc,[s("div",nc,[d[3]||(d[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",oc,$(o.value.length)+" characters",1)]),s("pre",ic,$(o.value),1)])):x("",!0)]),a.value?(r(),c("div",ac,[l.value?(r(),c("div",rc,[d[4]||(d[4]=s("strong",null,"Error:",-1)),s("pre",lc,$(m.value),1)])):(r(),c("div",cc,[s("div",uc,[d[5]||(d[5]=s("span",{class:"output-label"},"Agent Output:",-1)),f.value>0?(r(),c("span",dc,$(f.value)+" lines",1)):x("",!0)]),s("div",mc,[s("pre",pc,$(m.value),1)])]))])):x("",!0)]))}},vc=Z(fc,[["__scopeId","data-v-c520c244"]]),hc={class:"task-create-tool-handler"},_c={class:"tool-section"},gc={class:"task-details p-2"},bc={key:0,class:"task-field mb-2"},yc={class:"field-value subject-value"},$c={key:1,class:"task-field mb-2"},wc={class:"field-value description-value"},kc={key:2,class:"task-field"},Ec={class:"field-value active-form-value"},Sc={key:0,class:"tool-section mt-2"},Cc={key:0,class:"tool-result tool-result-error"},Tc={class:"tool-code"},xc={key:1,class:"tool-result tool-result-success"},Ac={class:"result-text"},Oc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.subject||null),o=v(()=>e.toolCall.input?.description||null),i=v(()=>e.toolCall.input?.activeForm||null),a=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=v(()=>{if(!a.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)});return(f,p)=>(r(),c("div",hc,[s("div",_c,[p[3]||(p[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",gc,[t.value?(r(),c("div",bc,[p[0]||(p[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",yc,$(t.value),1)])):x("",!0),o.value?(r(),c("div",$c,[p[1]||(p[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",wc,$(o.value),1)])):x("",!0),i.value?(r(),c("div",kc,[p[2]||(p[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Ec,$(i.value),1)])):x("",!0)])]),a.value?(r(),c("div",Sc,[l.value?(r(),c("div",Cc,[p[4]||(p[4]=s("strong",null,"Error:",-1)),s("pre",Tc,$(m.value),1)])):(r(),c("div",xc,[p[5]||(p[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Ac,$(m.value),1)]))])):x("",!0)]))}},Mc=Z(Oc,[["__scopeId","data-v-474dd444"]]),Dc={class:"task-update-tool-handler"},Nc={class:"tool-section"},Lc={class:"task-header"},jc={key:0,class:"task-id-badge"},Ic={class:"task-details p-2"},Pc={key:0,class:"task-field mb-2"},Rc={key:1,class:"task-field mb-2"},Wc={class:"field-value"},Hc={key:2,class:"task-field mb-2"},Bc={class:"field-value description-value"},Fc={key:3,class:"task-field mb-2"},Vc={class:"field-value active-form-value"},Uc={key:4,class:"task-field mb-2"},qc={class:"field-value"},zc={key:5,class:"task-field mb-2"},Kc={class:"field-value"},Gc={key:6,class:"task-field"},Yc={class:"field-value"},Jc={key:0,class:"tool-section mt-2"},Qc={key:0,class:"tool-result tool-result-error"},Xc={class:"tool-code"},Zc={key:1,class:"tool-result tool-result-success"},eu={class:"result-text"},tu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.input?.status||null),i=v(()=>e.toolCall.input?.subject||null),a=v(()=>e.toolCall.input?.description||null),l=v(()=>e.toolCall.input?.activeForm||null),m=v(()=>e.toolCall.input?.owner||null),f=v(()=>e.toolCall.input?.addBlockedBy||[]),p=v(()=>e.toolCall.input?.addBlocks||[]),d=v(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),k=v(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),_=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!_.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,u)=>(r(),c("div",Dc,[s("div",Nc,[s("div",Lc,[u[0]||(u[0]=s("span",{class:"task-icon"},"âœï¸",-1)),u[1]||(u[1]=s("strong",null,"Update Task",-1)),t.value?(r(),c("span",jc,"#"+$(t.value),1)):x("",!0)]),s("div",Ic,[o.value?(r(),c("div",Pc,[u[2]||(u[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:X(["field-value status-value",k.value])},$(d.value)+" "+$(o.value),3)])):x("",!0),i.value?(r(),c("div",Rc,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Wc,$(i.value),1)])):x("",!0),a.value?(r(),c("div",Hc,[u[4]||(u[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",Bc,$(a.value),1)])):x("",!0),l.value?(r(),c("div",Fc,[u[5]||(u[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Vc,$(l.value),1)])):x("",!0),m.value?(r(),c("div",Uc,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",qc,$(m.value),1)])):x("",!0),f.value?.length?(r(),c("div",zc,[u[7]||(u[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",Kc,[(r(!0),c(ne,null,le(f.value,y=>(r(),c("span",{key:y,class:"badge bg-warning text-dark me-1"},"#"+$(y),1))),128))])])):x("",!0),p.value?.length?(r(),c("div",Gc,[u[8]||(u[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",Yc,[(r(!0),c(ne,null,le(p.value,y=>(r(),c("span",{key:y,class:"badge bg-info text-dark me-1"},"#"+$(y),1))),128))])])):x("",!0)])]),_.value?(r(),c("div",Jc,[w.value?(r(),c("div",Qc,[u[9]||(u[9]=s("strong",null,"Error:",-1)),s("pre",Xc,$(b.value),1)])):(r(),c("div",Zc,[u[10]||(u[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",eu,$(b.value),1)]))])):x("",!0)]))}},su=Z(tu,[["__scopeId","data-v-35582330"]]),nu={class:"task-list-tool-handler"},ou={key:0,class:"tool-section"},iu={key:0,class:"tool-result tool-result-error"},au={class:"tool-code"},ru={key:1,class:"task-list-result"},lu={key:0,class:"parsed-tasks"},cu={class:"status-icon"},uu={class:"task-id text-muted"},du={class:"task-subject flex-grow-1"},mu={key:0,class:"task-owner badge bg-secondary"},pu={key:1,class:"raw-result p-2"},fu={class:"tool-code"},vu={key:1,class:"tool-section"},hu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=v(()=>{if(!t.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),a=v(()=>{if(!i.value)return[];const m=[],p=i.value.split(`
`);for(const d of p){const k=d.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(k){const _=k[2].toLowerCase();m.push({id:k[1],status:_,subject:k[3].trim(),owner:null,statusIcon:l(_)})}}return m});function l(m){switch(m){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(m,f)=>(r(),c("div",nu,[f[2]||(f[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(r(),c("div",ou,[o.value?(r(),c("div",iu,[f[0]||(f[0]=s("strong",null,"Error:",-1)),s("pre",au,$(i.value),1)])):(r(),c("div",ru,[a.value.length>0?(r(),c("div",lu,[(r(!0),c(ne,null,le(a.value,(p,d)=>(r(),c("div",{key:d,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",cu,$(p.statusIcon),1),s("span",uu,"#"+$(p.id),1),s("span",du,$(p.subject),1),p.owner?(r(),c("span",mu,$(p.owner),1)):x("",!0)]))),128))])):(r(),c("div",pu,[s("pre",fu,$(i.value),1)]))]))])):n.toolCall.status==="completed"?(r(),c("div",vu,[...f[1]||(f[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):x("",!0)]))}},_u=Z(hu,[["__scopeId","data-v-4e79ba4b"]]),gu={class:"task-get-tool-handler"},bu={class:"tool-section"},yu={class:"task-header"},$u={key:0,class:"task-id-badge"},wu={key:0,class:"tool-section"},ku={key:0,class:"tool-result tool-result-error"},Eu={class:"tool-code"},Su={key:1,class:"task-details-result p-2"},Cu={key:0,class:"parsed-task"},Tu={class:"task-field mb-2"},xu={class:"field-value subject-value"},Au={key:0,class:"task-field mb-2"},Ou={key:1,class:"task-field mb-2"},Mu={class:"field-value description-value"},Du={key:2,class:"task-field mb-2"},Nu={class:"field-value"},Lu={key:3,class:"task-field mb-2"},ju={class:"field-value"},Iu={key:4,class:"task-field"},Pu={class:"field-value"},Ru={key:1,class:"raw-result"},Wu={class:"tool-code"},Hu={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=v(()=>{if(!o.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),l=v(()=>{if(!a.value)return null;const p=a.value;try{const _=JSON.parse(p);if(_&&typeof _=="object")return{subject:_.subject||_.title||"",status:_.status||"",description:_.description||"",owner:_.owner||"",blockedBy:_.blockedBy||[],blocks:_.blocks||[]}}catch{}const d=p.split(`
`),k={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const _ of d){const w=_.match(/^Subject:\s*(.+)$/i);w&&(k.subject=w[1].trim());const b=_.match(/^Status:\s*(.+)$/i);b&&(k.status=b[1].trim());const g=_.match(/^Description:\s*(.+)$/i);g&&(k.description=g[1].trim());const u=_.match(/^Owner:\s*(.+)$/i);u&&(k.owner=u[1].trim())}return k.subject?k:null}),m=v(()=>{if(!l.value)return"";switch(l.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),f=v(()=>{if(!l.value)return"";switch(l.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,d)=>(r(),c("div",gu,[s("div",bu,[s("div",yu,[d[0]||(d[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),d[1]||(d[1]=s("strong",null,"Get Task",-1)),t.value?(r(),c("span",$u,"#"+$(t.value),1)):x("",!0)])]),o.value?(r(),c("div",wu,[i.value?(r(),c("div",ku,[d[2]||(d[2]=s("strong",null,"Error:",-1)),s("pre",Eu,$(a.value),1)])):(r(),c("div",Su,[l.value?(r(),c("div",Cu,[s("div",Tu,[d[3]||(d[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",xu,$(l.value.subject),1)]),l.value.status?(r(),c("div",Au,[d[4]||(d[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:X(["field-value",f.value])},$(m.value)+" "+$(l.value.status),3)])):x("",!0),l.value.description?(r(),c("div",Ou,[d[5]||(d[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",Mu,$(l.value.description),1)])):x("",!0),l.value.owner?(r(),c("div",Du,[d[6]||(d[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",Nu,$(l.value.owner),1)])):x("",!0),l.value.blockedBy?.length?(r(),c("div",Lu,[d[7]||(d[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",ju,[(r(!0),c(ne,null,le(l.value.blockedBy,k=>(r(),c("span",{key:k,class:"badge bg-warning text-dark me-1"},"#"+$(k),1))),128))])])):x("",!0),l.value.blocks?.length?(r(),c("div",Iu,[d[8]||(d[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Pu,[(r(!0),c(ne,null,le(l.value.blocks,k=>(r(),c("span",{key:k,class:"badge bg-info text-dark me-1"},"#"+$(k),1))),128))])])):x("",!0)])):(r(),c("div",Ru,[s("pre",Wu,$(a.value),1)]))]))])):x("",!0)]))}},Bu=Z(Hu,[["__scopeId","data-v-a80d14da"]]),Fu={class:"notebook-edit-tool-handler"},Vu={class:"tool-section"},Uu={class:"notebook-info"},qu={class:"file-path"},zu={class:"cell-info mt-2"},Ku={class:"info-row"},Gu={class:"info-row"},Yu={key:0,class:"info-row"},Ju={class:"badge bg-info"},Qu={key:0,class:"source-preview mt-3"},Xu={class:"preview-header"},Zu={class:"preview-stats"},ed={class:"source-code"},td={key:0,class:"tool-section"},sd={key:0},nd={key:1,class:"text-danger"},od={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.notebook_path||"Unknown"),o=v(()=>e.toolCall.input?.cell_id),i=v(()=>e.toolCall.input?.cell_type||"code"),a=v(()=>e.toolCall.input?.edit_mode||"replace"),l=v(()=>e.toolCall.input?.new_source||""),m=v(()=>l.value.split(`
`).length),f=v(()=>i.value==="code"?"bg-primary":"bg-secondary"),p=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const k=a.value;return k==="insert"?"Cell inserted successfully":k==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(k,_)=>(r(),c("div",Fu,[s("div",Vu,[s("div",Uu,[_[0]||(_[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),_[1]||(_[1]=s("strong",null,"Notebook:",-1)),s("code",qu,$(t.value),1)]),s("div",zu,[s("div",Ku,[_[2]||(_[2]=s("strong",null,"Cell ID:",-1)),s("code",null,$(o.value||"N/A"),1)]),s("div",Gu,[_[3]||(_[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:X(["badge",f.value])},$(i.value),3)]),a.value?(r(),c("div",Yu,[_[4]||(_[4]=s("strong",null,"Edit Mode:",-1)),s("span",Ju,$(a.value),1)])):x("",!0)]),l.value?(r(),c("div",Qu,[s("div",Xu,[_[5]||(_[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",Zu,$(m.value)+" lines",1)]),s("pre",ed,[s("code",null,$(l.value),1)])])):x("",!0)]),n.toolCall.result?(r(),c("div",td,[_[6]||(_[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:X(["tool-result",p.value])},[n.toolCall.result.success!==!1?(r(),c("div",sd," âœ… "+$(d.value),1)):(r(),c("div",nd," â— "+$(n.toolCall.result.error||"Operation failed"),1))],2)])):x("",!0)]))}},id=Z(od,[["__scopeId","data-v-c81a9bcf"]]),ad={class:"shell-tool-handler"},rd={class:"tool-section"},ld={class:"shell-info"},cd={class:"shell-icon"},ud={key:0,class:"shell-id"},dd={key:0,class:"filter-info mt-2"},md={class:"filter-pattern"},pd={key:0,class:"tool-section"},fd={class:"result-header mb-2"},vd={key:0,class:"mb-2"},hd={class:"shell-output"},_d={key:1,class:"mb-2"},gd={class:"shell-output shell-output-error"},bd={key:0},yd={key:1,class:"text-danger"},$d={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=v(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=v(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=v(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=v(()=>e.toolCall.input?.filter);function m(w,b){if(!w)return null;const g=new RegExp(`<${b}>([\\s\\S]*?)<\\/${b}>`,"i"),u=w.match(g);return u?u[1].trim():null}const f=v(()=>{const w=e.toolCall.result;if(!w)return null;let b=w;if(w.content&&(b=w.content),typeof b=="string")return{status:m(b,"status"),stdout:m(b,"stdout"),stderr:m(b,"stderr"),exit_code:m(b,"exit_code")};if(Array.isArray(b)){const g=b.find(u=>u.type==="text")?.text||"";return{status:m(g,"status"),stdout:m(g,"stdout"),stderr:m(g,"stderr"),exit_code:m(g,"exit_code")}}return{status:w.status||b.status,stdout:w.stdout||w.output||b.stdout||b.output,stderr:w.stderr||b.stderr,exit_code:w.exit_code||b.exit_code}}),p=v(()=>f.value?.status),d=v(()=>{const w=p.value;return w==="running"?"bg-success":w==="completed"?"bg-secondary":w==="killed"||w==="terminated"?"bg-danger":"bg-info"}),k=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),_=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const w=f.value;if(w?.status==="running"&&!w.stdout&&!w.stderr)return"No new output since last check";if(w?.status==="failed")return`Shell failed (exit code ${w.exit_code||"unknown"})`}return"Operation completed"});return(w,b)=>(r(),c("div",ad,[s("div",rd,[s("div",ld,[s("span",cd,$(t.value),1),s("strong",null,$(o.value)+":",1),a.value?(r(),c("code",ud,"Shell "+$(a.value),1)):x("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(r(),c("div",dd,[b[0]||(b[0]=s("strong",null,"Filter:",-1)),s("code",md,$(l.value),1)])):x("",!0)]),n.toolCall.result?(r(),c("div",pd,[s("div",fd,[s("strong",null,$(i.value)+":",1),p.value?(r(),c("span",{key:0,class:X(["badge",d.value])},$(p.value),3)):x("",!0)]),f.value?.stdout?(r(),c("div",vd,[b[1]||(b[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",hd,[s("pre",null,[s("code",null,$(f.value.stdout),1)])])])):x("",!0),f.value?.stderr?(r(),c("div",_d,[b[2]||(b[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",gd,[s("pre",null,[s("code",null,$(f.value.stderr),1)])])])):x("",!0),!f.value?.stdout&&!f.value?.stderr?(r(),c("div",{key:2,class:X(["tool-result",k.value])},[n.toolCall.result.success!==!1?(r(),c("div",bd," âœ… "+$(_.value),1)):(r(),c("div",yd," â— "+$(n.toolCall.result.error||"Operation failed"),1))],2)):x("",!0)])):x("",!0)]))}},yn=Z($d,[["__scopeId","data-v-86def281"]]),wd={class:"skill-tool-handler"},kd={key:0,class:"tool-section"},Ed={class:"d-flex align-items-center gap-2"},Sd={class:"text-muted small"},Cd={key:0,class:"skill-content-body"},Td={class:"skill-content-text"},xd={key:1,class:"tool-section mt-3"},Ad={class:"tool-result tool-result-error"},Od={class:"tool-code"},Md={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ce(),o=de(),i=R(!1);function a(){i.value=!i.value}const l=v(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const w=t.messagesBySession.get(_)||[],b=w.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(h=>h.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let g=null,u=null;for(let y=b+1;y<Math.min(b+3,w.length);y++){const h=w[y];if(h.type!=="user")continue;const S=h.content||"";S.includes("<command-message>")&&S.includes("skill is running")?g=h:S.startsWith("Base directory for this skill:")&&(u=h)}return{running:g,content:u}}),m=v(()=>{const _=l.value.content;if(!_)return"";const w=_.content||"",b=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return w.replace(b,"").trim()}),f=v(()=>m.value.length>0),p=v(()=>m.value?m.value.split(`
`).length:0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!d.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,w)=>(r(),c("div",wd,[f.value?(r(),c("div",kd,[s("div",{class:"skill-content-header",onClick:a},[s("div",Ed,[s("i",{class:X(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),w[0]||(w[0]=s("strong",null,"Skill Content",-1)),s("span",Sd,"("+$(p.value)+" lines)",1)])]),i.value?(r(),c("div",Cd,[s("pre",Td,$(m.value),1)])):x("",!0)])):x("",!0),d.value?(r(),c("div",xd,[w[1]||(w[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Ad,[s("pre",Od,$(k.value),1)])])):x("",!0)]))}},Dd=Z(Md,[["__scopeId","data-v-0a48ca0f"]]),Nd={class:"slashcommand-tool-handler"},Ld={key:0,class:"tool-section"},jd={class:"d-flex align-items-center gap-2"},Id=["aria-label"],Pd={class:"text-muted small"},Rd={key:0,class:"command-content-body"},Wd={class:"command-content-text"},Hd={key:1,class:"tool-section mt-3"},Bd={class:"tool-result tool-result-error"},Fd={class:"tool-code"},Vd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ce(),o=de(),i=R(!1);function a(){i.value=!i.value}const l=v(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const w=t.messagesBySession.get(_)||[],b=w.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(h=>h.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let g=null,u=null;for(let y=b+1;y<Math.min(b+3,w.length);y++){const h=w[y];if(h.type!=="user")continue;const S=h.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?g=h:S.includes("ARGUMENTS:")&&(u=h)}return{running:g,content:u}}),m=v(()=>{const _=l.value.content;if(!_)return"";const w=_.content||"",b=/\nARGUMENTS:.*$/s;return w.replace(b,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),f=v(()=>m.value.length>0),p=v(()=>m.value?m.value.split(`
`).length:0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!d.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,w)=>(r(),c("div",Nd,[f.value?(r(),c("div",Ld,[s("div",{class:"command-content-header",onClick:a},[s("div",jd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},$(i.value?"â–¾":"â–¸"),9,Id),w[0]||(w[0]=s("strong",null,"Command Content",-1)),s("span",Pd,"("+$(p.value)+" lines)",1)])]),i.value?(r(),c("div",Rd,[s("pre",Wd,$(m.value),1)])):x("",!0)])):x("",!0),d.value?(r(),c("div",Hd,[w[1]||(w[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Bd,[s("pre",Fd,$(k.value),1)])])):x("",!0)]))}},Ud=Z(Vd,[["__scopeId","data-v-15991acf"]]),qd={class:"exit-plan-mode-tool-handler"},zd={class:"tool-section"},Kd={key:0,class:"plan-content mt-2"},Gd={class:"plan-text"},Yd={key:0,class:"tool-section"},Jd={key:0},Qd={key:1,class:"text-danger"},Xd={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.plan),o=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(r(),c("div",qd,[s("div",zd,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(r(),c("div",Kd,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",Gd,$(t.value),1)])):x("",!0)]),n.toolCall.result?(r(),c("div",Yd,[a[2]||(a[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:X(["tool-result",o.value])},[n.toolCall.result.success!==!1?(r(),c("div",Jd," âœ… Permission mode reverted to default ")):(r(),c("div",Qd," â— "+$(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):x("",!0)]))}},Zd=Z(Xd,[["__scopeId","data-v-e2e3c781"]]),em={class:"ask-user-question-handler"},tm={key:0,class:"answers-summary"},sm={class:"answer-question text-muted small"},nm={class:"answer-value fw-medium"},om={key:1,class:"text-muted small"},im={key:0,class:"questions-container"},am={class:"question-header d-flex align-items-center gap-2 mb-2"},rm={key:0,class:"badge bg-secondary"},lm={class:"question-text fw-medium"},cm={class:"options-list"},um=["id","checked","onChange"],dm=["id","name","checked","onChange"],mm=["for"],pm={class:"option-label"},fm={key:0,class:"option-description text-muted d-block small"},vm={class:"option-item form-check other-option"},hm=["id","checked","onChange"],_m=["id","name","checked","onChange"],gm=["for"],bm={key:2,class:"other-input mt-2"},ym=["onUpdate:modelValue","onInput"],$m={key:1,class:"alert alert-info mb-0"},wm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=v(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),l=v(()=>{if(!a.value)return{};const E=o.toolCall.result;if(E?.content){if(typeof E.content=="object"&&E.content.answers)return E.content.answers;if(typeof E.content=="string")try{const N=JSON.parse(E.content);if(N.answers)return N.answers}catch{}}const I=o.toolCall.input||{};return I.answers?I.answers:{}}),m=v(()=>Object.keys(l.value).length>0),f=v(()=>(o.toolCall.input||{}).questions||[]),p=R({}),d=R({});fe(f,E=>{E.forEach((I,N)=>{N in p.value||(p.value[N]=I.multiSelect?[]:null),N in d.value||(d.value[N]="")})},{immediate:!0});function k(E,I){const N=p.value[E];return Array.isArray(N)?N.includes(I):N===I}function _(E){const I=p.value[E];return Array.isArray(I)?I.includes("__OTHER__"):I==="__OTHER__"}function w(E,I){p.value[E]=I,h()}function b(E){p.value[E]="__OTHER__",h()}function g(E,I){const N=p.value[E];if(!Array.isArray(N))p.value[E]=[I];else{const A=N.indexOf(I);A===-1?N.push(I):N.splice(A,1)}h()}function u(E){const I=p.value[E];if(!Array.isArray(I))p.value[E]=["__OTHER__"];else{const N=I.indexOf("__OTHER__");N===-1?I.push("__OTHER__"):I.splice(N,1)}h()}function y(E){h()}function h(){const E={};f.value.forEach((I,N)=>{const A=p.value[N],P=I.question;if(I.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(T=>T==="__OTHER__"?d.value[N]||"":T).filter(T=>T);E[P]=C.join(", ")}}else A==="__OTHER__"?E[P]=d.value[N]||"":A&&(E[P]=A)}),i("answer",E)}const S=v(()=>f.value.every((E,I)=>{const N=p.value[I];if(E.multiSelect){if(!Array.isArray(N)||N.length===0||N.includes("__OTHER__")&&!d.value[I])return!1}else if(!N||N==="__OTHER__"&&!d.value[I])return!1;return!0}));return e({allQuestionsAnswered:S,getAnswers:()=>{const E={};return f.value.forEach((I,N)=>{const A=p.value[N],P=I.question;if(I.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(T=>T==="__OTHER__"?d.value[N]||"":T).filter(T=>T);E[P]=C.join(", ")}}else A==="__OTHER__"?E[P]=d.value[N]||"":A&&(E[P]=A)}),E}}),(E,I)=>(r(),c("div",em,[a.value?(r(),c(ne,{key:0},[m.value?(r(),c("div",tm,[(r(!0),c(ne,null,le(l.value,(N,A)=>(r(),c("div",{key:A,class:"answer-item mb-2"},[s("div",sm,$(A),1),s("div",nm,$(N),1)]))),128))])):(r(),c("div",om," No answers recorded. "))],64)):(r(),c(ne,{key:1},[f.value.length>0?(r(),c("div",im,[(r(!0),c(ne,null,le(f.value,(N,A)=>(r(),c("div",{key:A,class:"question-block mb-3"},[s("div",am,[N.header?(r(),c("span",rm,$(N.header),1)):x("",!0),s("span",lm,$(N.question),1)]),s("div",cm,[(r(!0),c(ne,null,le(N.options,(P,C)=>(r(),c("div",{key:C,class:X(["option-item form-check",{selected:k(A,P.label)}])},[N.multiSelect?(r(),c("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-opt${C}`,checked:k(A,P.label),onChange:T=>g(A,P.label)},null,40,um)):(r(),c("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-opt${C}`,name:`question-${A}`,checked:k(A,P.label),onChange:T=>w(A,P.label)},null,40,dm)),s("label",{class:"form-check-label",for:`q${A}-opt${C}`},[s("span",pm,$(P.label),1),P.description?(r(),c("span",fm,$(P.description),1)):x("",!0)],8,mm)],2))),128)),s("div",vm,[N.multiSelect?(r(),c("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-other`,checked:_(A),onChange:P=>u(A)},null,40,hm)):(r(),c("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-other`,name:`question-${A}`,checked:_(A),onChange:P=>b(A)},null,40,_m)),s("label",{class:"form-check-label",for:`q${A}-other`},[...I[0]||(I[0]=[s("span",{class:"option-label"},"Other",-1)])],8,gm),_(A)?(r(),c("div",bm,[ge(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":P=>d.value[A]=P,placeholder:"Enter your custom answer...",onInput:P=>y()},null,40,ym),[[He,d.value[A]]])])):x("",!0)])])]))),128))])):(r(),c("div",$m," No questions to display. "))],64))]))}},$n=Z(wm,[["__scopeId","data-v-75ce45b4"]]),km={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Em={class:"tool-status-icon"},Sm=["title"],Cm={class:"d-flex align-items-center gap-2"},Tm={class:"text-muted"},xm=["aria-label"],Am={key:0,class:"card-body"},Om={key:0,class:"alert alert-warning mb-3"},Mm={class:"d-flex align-items-center"},Dm={class:"mb-0 small"},Nm={key:2,class:"permission-prompt mt-3"},Lm={class:"question-buttons d-flex gap-2 mt-3"},jm=["disabled"],Im=["disabled"],Pm={class:"alert alert-warning mb-3"},Rm={class:"mb-0"},Wm={class:"tool-name"},Hm={key:0,class:"suggestions-section mb-3"},Bm={class:"alert alert-info mb-0"},Fm={class:"suggestion-details p-2 bg-white rounded"},Vm={class:"permission-buttons d-flex gap-2 mb-3"},Um=["disabled"],qm=["disabled"],zm=["disabled"],Km={class:"guidance-section mt-3"},Gm=["disabled"],Ym=["disabled"],Jm={key:3,class:"mt-3"},Qm={class:"alert alert-warning mb-0"},Xm={class:"d-flex align-items-center"},Zm={class:"mb-0 small"},ep={key:4,class:"tool-section"},tp={class:"alert alert-danger mb-0"},sp={key:0},np={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ce(),o=de(),i=et(),a=R(!1),l=R(null),m=R(""),f=R(null),p=R({}),d=v(()=>e.toolCall.name==="AskUserQuestion"),k=v(()=>!d.value||!f.value?!1:f.value.allQuestionsAnswered);function _(L){p.value=L}async function w(){if(!a.value&&f.value){a.value=!0,l.value="submit-answers";try{const L=o.currentSessionId,D=f.value.getAnswers(),z={questions:e.toolCall.input?.questions||[],answers:D};L&&(t.updateToolCall(L,e.toolCall.id,{input:z}),t.handlePermissionResponse(L,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",z)}catch(L){console.error("Failed to submit question answers:",L)}finally{a.value=!1,l.value=null}}}const b=v(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),g=v(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),u=v(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),y=v(()=>{if(u.value){const L=u.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[L]||L}return e.toolCall.status}),h={Read:Ya,Write:mr,Bash:Sr,TodoWrite:Fr,Edit:ul,Grep:gn,Glob:gn,WebFetch:bn,WebSearch:bn,Task:vc,TaskCreate:Mc,TaskUpdate:su,TaskList:_u,TaskGet:Bu,NotebookEdit:id,BashOutput:yn,KillShell:yn,SlashCommand:Ud,Skill:Dd,ExitPlanMode:Zd,AskUserQuestion:$n},S=v(()=>{const L=e.toolCall.name;return h[L]?h[L]:Na}),E=v(()=>{const L=[];if(b.value)return L.push("border-warning"),L.join(" ");switch(y.value){case"pending":L.push("border-secondary");break;case"permission_required":L.push("border-warning");break;case"executing":L.push("border-primary");break;case"completed":A.value||e.toolCall.permissionDecision==="deny"?L.push("border-danger"):L.push("border-success");break;case"error":L.push("border-danger");break}return L.join(" ")}),I=v(()=>{if(b.value)return"â¹ï¸";switch(y.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":A.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),N=v(()=>Ht(e.toolCall.timestamp)),A=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),P=v(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function C(L){if(!L)return"";const D=L.replace(/\\/g,"/").split("/");return D[D.length-1]}function T(L){if(!L)return"";const D=L.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return D?D[1]:L}function U(L,D=200){return L?L.length<=D?L:L.substring(0,D)+"...":""}function q(L){if(!L)return null;if(L.content){const D=L.content.match(/exit code (\d+)/i);if(D)return parseInt(D[1])}return L.error?1:0}function W(L,D){const z=L?L.split(`
`).length:0;return{added:D?D.split(`
`).length:0,removed:z}}const H=v(()=>{const L=e.toolCall.name,D=e.toolCall.input||{},z=e.toolCall.result,oe=y.value;switch(L){case"Bash":case"Shell":case"Command":{const Y=T(D.command),Q=U(Y,200);if(oe==="completed"&&z){const re=q(z);return`Bash: ${Q} (exit ${re})`}return`Bash: ${Q}`}case"SlashCommand":{const Y=U(D.command,200);return oe==="completed"&&z?`SlashCommand: ${Y}`:`SlashCommand: ${Y}`}case"Edit":{const Y=C(D.file_path);if(oe==="completed"&&z&&!z.error){const{added:Q,removed:re}=W(D.old_string,D.new_string);return Q===re?`Edit: ${Y} (${Q} lines changed)`:`Edit: ${Y} (${Q} lines added, ${re} removed)`}return`Edit: ${Y}`}case"Read":{const Y=C(D.file_path);if(D.offset!==void 0||D.limit!==void 0){const re=(D.offset||0)+1,me=D.limit?(D.offset||0)+D.limit:"âˆž";return`Read: ${Y} (lines ${re}-${me})`}return`Read: ${Y} (full file)`}case"Write":{const Y=C(D.file_path);if(oe==="completed"&&z&&!z.error&&D.content){const Q=D.content.split(`
`).length;return`Write: ${Y} (${Q} lines written)`}return`Write: ${Y}`}case"Skill":{const Y=D.skill||"Unknown";return oe==="completed"&&z?z.error?`Skill: ${Y} (error)`:`Skill: ${Y} (completed)`:`Skill: ${Y}`}case"Task":{const Y=D.subagent_type||"general",Q=D.description||"Task";return oe==="completed"&&z?z.error?`Task: (${Y}) ${Q} (error)`:`Task: (${Y}) ${Q} (completed)`:`Task: (${Y}) ${Q}`}case"TodoWrite":{if(D.todos&&Array.isArray(D.todos)){const Y=D.todos.filter(me=>me.status==="completed").length,Q=D.todos.length,re=D.todos.find(me=>me.status==="in_progress");return re?`Todo: Working on "${re.content}"`:`Todo: ${Y}/${Q} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const Y=D.pattern||"",Q=L==="Grep"?"Grep":"Glob";if(oe==="completed"&&z&&!z.error){let re=0;return z.content&&(re=z.content.split(`
`).filter(B=>B.trim()).length),`${Q}: "${Y}" (${re} results)`}return`${Q}: "${Y}"`}case"WebFetch":case"WebSearch":{const Y=D.url||D.query||"";if(L==="WebSearch"){const re=D.query||"",me=re.length>50?re.substring(0,50)+"...":re;return oe==="completed"&&z?z.error?`Web: ${me} (error)`:`Web: ${me} (success)`:`Web: ${me}`}let Q="";try{Y&&(Q=new URL(Y.startsWith("http")?Y:`https://${Y}`).hostname)}catch{Q=Y.length>50?Y.substring(0,50)+"...":Y}return oe==="completed"&&z?z.error?`Web: ${Q} (error)`:`Web: ${Q} (success)`:`Web: ${Q||Y}`}case"NotebookEdit":{const Y=C(D.notebook_path),Q=D.cell_number!==void 0?D.cell_number:"?",re=D.edit_mode||"replace";return`NotebookEdit: ${Y} cell #${Q} (${re})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${D.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${D.shell_id||"unknown"}`;case"AskUserQuestion":{const Q=(D.questions||[]).length;return oe==="completed"&&z&&!z.error?`AskUserQuestion: ${Q} question(s) answered`:oe==="permission_required"?`AskUserQuestion: ${Q} question(s) awaiting response`:`AskUserQuestion: ${Q} question(s)`}case"TaskCreate":{const Y=D.subject||"",Q=Y.length>40?Y.substring(0,40)+"...":Y;return oe==="completed"&&z&&!z.error?`TaskCreate: "${Q}" (created)`:`TaskCreate: "${Q}"`}case"TaskUpdate":{const Y=D.taskId||"?",Q=D.status||"";return Q?`TaskUpdate: #${Y} -> ${Q}`:`TaskUpdate: #${Y}`}case"TaskList":return oe==="completed"&&z&&!z.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const Y=D.taskId||"?";return oe==="completed"&&z&&!z.error?`TaskGet: #${Y} (retrieved)`:`TaskGet: #${Y}`}default:return`${L}: executed`}}),F=v(()=>{const L=e.toolCall.name,D=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(L)?D.command||L:["Edit","Read","Write","NotebookEdit"].includes(L)&&(D.file_path||D.notebook_path)||L});function O(){const L=o.currentSessionId;L&&t.toggleToolExpansion(L,e.toolCall.id)}function M(L){return L.type==="setMode"?`Set permission mode to "${L.mode}"`:L.type==="allow"?`Allow tool: ${L.tool}`:JSON.stringify(L)}async function K(L,D,z=null){if(!a.value){a.value=!0,L==="allow"?l.value=D?"approve-apply":"approve":z?l.value="deny-guidance":l.value="deny";try{const oe=o.currentSessionId;if(oe){const Y=D&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(oe,{request_id:e.toolCall.permissionRequestId,decision:L,reasoning:L==="allow"?"User allowed permission":"User denied permission",applied_updates:Y})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,L,D,z)}catch(oe){console.error("Failed to send permission response:",oe)}finally{a.value=!1,l.value=null}}}return(L,D)=>(r(),c("div",{class:X(["tool-call-card card",E.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:O},[s("div",km,[s("span",Em,$(I.value),1),s("span",{class:"tool-name",title:F.value},$(H.value),9,Sm)]),s("div",Cm,[s("small",Tm,$(N.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},$(n.toolCall.isExpanded?"â–¾":"â–¸"),9,xm)])]),n.toolCall.isExpanded?(r(),c("div",Am,[b.value?(r(),c("div",Om,[s("div",Mm,[D[7]||(D[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[D[6]||(D[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Dm,$(g.value?.message||"Session was terminated"),1)])])])):x("",!0),d.value&&y.value==="permission_required"?x("",!0):(r(),be(lo(S.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),y.value==="permission_required"&&!b.value?(r(),c("div",Nm,[d.value?(r(),c(ne,{key:0},[D[8]||(D[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),pe($n,{ref_key:"questionHandlerRef",ref:f,toolCall:n.toolCall,onAnswer:_},null,8,["toolCall"]),s("div",Lm,[s("button",{class:"btn btn-primary",onClick:w,disabled:a.value||!k.value},$(a.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,jm),s("button",{class:"btn btn-outline-secondary",onClick:D[0]||(D[0]=z=>K("deny",!1)),disabled:a.value}," Skip Question ",8,Im)])],64)):(r(),c(ne,{key:1},[s("div",Pm,[D[11]||(D[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Rm,[D[9]||(D[9]=ee("Claude wants to use the ",-1)),s("code",Wm,$(n.toolCall.name),1),D[10]||(D[10]=ee(" tool.",-1))])]),P.value?(r(),c("div",Hm,[s("div",Bm,[D[12]||(D[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),D[13]||(D[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Fm,[(r(!0),c(ne,null,le(n.toolCall.suggestions,(z,oe)=>(r(),c("div",{key:oe,class:"suggestion-item"},[s("code",null,$(M(z)),1)]))),128))]),D[14]||(D[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):x("",!0),s("div",Vm,[P.value?(r(),c("button",{key:0,class:"btn btn-success",onClick:D[1]||(D[1]=z=>K("allow",!0)),disabled:a.value},$(a.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Um)):x("",!0),s("button",{class:X(["btn",P.value?"btn-outline-success":"btn-success"]),onClick:D[2]||(D[2]=z=>K("allow",!1)),disabled:a.value},$(a.value&&l.value==="approve"?"â³ Submitting...":P.value?"âœ… Approve Only":"âœ… Approve"),11,qm),s("button",{class:"btn btn-danger",onClick:D[3]||(D[3]=z=>K("deny",!1)),disabled:a.value}," ðŸš« "+$(a.value&&l.value==="deny"?"Submitting...":"Deny"),9,zm)]),s("div",Km,[D[15]||(D[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),D[16]||(D[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ge(s("textarea",{"onUpdate:modelValue":D[4]||(D[4]=z=>m.value=z),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Gm),[[He,m.value]]),m.value.trim()?(r(),c("button",{key:0,class:"btn btn-warning btn-sm",onClick:D[5]||(D[5]=z=>K("deny",!1,m.value)),disabled:a.value},$(a.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Ym)):x("",!0)])],64))])):x("",!0),y.value==="permission_required"&&b.value?(r(),c("div",Jm,[s("div",Qm,[s("div",Xm,[D[18]||(D[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[D[17]||(D[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Zm,$(g.value?.message||"Session was terminated before permission could be granted"),1)])])])])):x("",!0),n.toolCall.permissionDecision==="deny"?(r(),c("div",ep,[s("div",tp,[D[19]||(D[19]=ee(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(r(),c("span",sp," - "+$(n.toolCall.result.message),1)):x("",!0)])])):x("",!0)])):x("",!0)],2))}},wn=Z(np,[["__scopeId","data-v-843f35ac"]]);function kn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function op(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function En(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function ip(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=op(t.command),i=En(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${En(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=kn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",a=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${a}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${kn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const ap={key:0,class:"tool-timeline-bar"},rp={class:"timeline-container"},lp=["title","onClick","onKeydown"],cp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=Ce(),a=de(),l=v(()=>t.tools.map((w,b)=>({tool:w,originalIndex:b})).sort((w,b)=>{if(w.tool.timestamp&&b.tool.timestamp){const g=new Date(w.tool.timestamp).getTime(),u=new Date(b.tool.timestamp).getTime();if(g!==u)return g-u}return w.originalIndex-b.originalIndex}).map(({tool:w})=>w));function m(w){const b=a.currentSessionId;if(!b)return w.status;const g=i.getBackendToolState(b,w.id);return g?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[g.state]||g.state:i.isToolUseOrphaned(b,w.id)?"orphaned":w.status}function f(w){return w.result?.error||w.status==="error"||w.permissionDecision==="deny"}function p(w){return m(w)==="executing"}function d(w){switch(m(w)){case"completed":return f(w)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function k(w){const b=ip(w),g=m(w),u={completed:f(w)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[g]||g;return`${b} [${u}]`}function _(w,b){o("segment-click",{tool:w,index:b})}return(w,b)=>l.value.length>1?(r(),c("div",ap,[s("div",rp,[(r(!0),c(ne,null,le(l.value,(g,u)=>(r(),c("div",{key:g.id,class:X(["timeline-segment",d(g)]),style:{flex:1},title:k(g),onClick:y=>_(g,u),role:"button",tabindex:"0",onKeydown:[We(y=>_(g,u),["enter"]),We(_e(y=>_(g,u),["prevent"]),["space"])]},[s("span",{class:X(["segment-inner",{"executing-pulse":p(g)}])},null,2)],42,lp))),128))])])):x("",!0)}},up=Z(cp,[["__scopeId","data-v-26c45a04"]]),dp={class:"tool-footer-container"},mp=["aria-label","onKeydown"],pp={class:"footer-left"},fp={class:"footer-text"},vp={class:"footer-middle"},hp={class:"footer-text"},_p={class:"footer-right"},gp={class:"expand-icon"},bp={key:0,class:"tool-footer-expanded"},yp={key:1,class:"active-tools-area"},$p={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Ce(),o=de(),i=R(!1);function a(b){return b.map((g,u)=>({tool:g,originalIndex:u})).sort((g,u)=>{if(g.tool.timestamp&&u.tool.timestamp){const y=new Date(g.tool.timestamp).getTime(),h=new Date(u.tool.timestamp).getTime();if(y!==h)return y-h}return g.originalIndex-u.originalIndex}).map(({tool:g})=>g)}const l=v(()=>{const b=e.tools.filter(g=>g.status==="executing"||g.status==="permission_required");return a(b)}),m=v(()=>{const b=e.tools.filter(g=>g.status!=="executing"&&g.status!=="permission_required");return a(b)}),f=v(()=>{const b=new Map;e.tools.forEach(S=>{const E=b.get(S.name)||0;b.set(S.name,E+1)});const g=Array.from(b.entries()).sort((S,E)=>E[1]-S[1]),u=g.slice(0,5),y=g.length-u.length,h=u.map(([S,E])=>`${S} (${E})`).join(", ");return y>0?`${h}, +${y} more`:h}),p=v(()=>{const b=e.tools.length;let g=0,u=0,y=0;e.tools.forEach(I=>{const N=o.currentSessionId;(N?t.isToolUseOrphaned(N,I.id):!1)?y++:I.status==="completed"&&!I.result?.error&&I.permissionDecision!=="deny"?g++:(I.status==="error"||I.result?.error||I.permissionDecision==="deny")&&u++});let h=[];g>0&&h.push(`${g} âœ…`),u>0&&h.push(`${u} âŒ`),y>0&&h.push(`${y} â¹ï¸`);const S=b===1?"tool":"tools",E=h.length>0?": "+h.join(" "):"";return`${b} ${S}${E}`}),d=v(()=>i.value?"â–²":"â–¼"),k=v(()=>{const b=o.currentSessionId,g=e.tools.some(S=>S.status==="error"||S.result?.error||S.permissionDecision==="deny"),u=e.tools.some(S=>b?t.isToolUseOrphaned(b,S.id):!1),y=l.value.length>0,h=e.tools.every(S=>!(b?t.isToolUseOrphaned(b,S.id):!1)&&S.status==="completed"&&!S.result?.error&&S.permissionDecision!=="deny");return g?"footer-status-error":u?"footer-status-orphaned":y?"footer-status-in-progress":h?"footer-status-success":""});function _(){i.value=!i.value}async function w({tool:b}){const g=o.currentSessionId;if(!g)return;i.value||(i.value=!0,await $t()),t.toggleToolExpansion(g,b.id),await $t();const u=document.querySelector(`[data-tool-id="${b.id}"]`);u&&u.scrollIntoView({behavior:"smooth",block:"nearest"})}return(b,g)=>(r(),c("div",dp,[pe(up,{tools:n.tools,onSegmentClick:w},null,8,["tools"]),s("div",{class:X(["tool-footer-summary",k.value]),onClick:_,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[We(_,["enter"]),We(_e(_,["prevent"]),["space"])]},[s("div",pp,[s("span",fp,"Used: "+$(f.value),1)]),s("div",vp,[g[0]||(g[0]=s("span",{class:"footer-separator"},"|",-1)),s("span",hp,$(p.value),1)]),s("div",_p,[s("span",gp,$(d.value),1)])],42,mp),i.value?(r(),c("div",bp,[(r(!0),c(ne,null,le(m.value,u=>(r(),be(wn,{key:u.id,toolCall:u,"data-tool-id":u.id},null,8,["toolCall","data-tool-id"]))),128))])):x("",!0),l.value.length>0?(r(),c("div",yp,[(r(!0),c(ne,null,le(l.value,u=>(r(),be(wn,{key:u.id,toolCall:u,"data-tool-id":u.id},null,8,["toolCall","data-tool-id"]))),128))])):x("",!0)]))}},wp=Z($p,[["__scopeId","data-v-f80c8c6c"]]),kp={class:"message-row message-row-assistant"},Ep=["title"],Sp={class:"message-content-column"},Cp={key:0,class:"thinking-block mb-2"},Tp=["innerHTML"],xp={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ce(),o=de();lt.setOptions({breaks:!0,gfm:!0});const i=v(()=>Ht(e.message.timestamp)),a=v(()=>e.message.metadata?.model||null),l=v(()=>{const b=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${b}`}),m=v(()=>{const b=e.message.content||"";return b.trim().length>0&&b!=="Assistant response"}),f=v(()=>{const b=e.message.content||"";let g=lt.parse(b);return g=g.replace(/\n</g,"<"),g=g.replace(/\n+$/,""),ls.sanitize(g)}),p=v(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),d=v(()=>e.message.metadata?.thinking_content||""),k=v(()=>{const b=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,g=e.attachedTools&&e.attachedTools.length>0;return b||g}),_=v(()=>{const b=e.message.metadata?.tool_uses||[],g=e.attachedTools||[],u=[...b],y=new Set(b.map(h=>h.id));for(const h of g)y.has(h.id)||u.push(h);return u}),w=v(()=>{const b=o.currentSessionId;if(!b)return[];const g=t.toolCallsBySession.get(b)||[];return _.value.map(u=>{const y=g.find(h=>h.id===u.id);return y||{id:u.id,name:u.name,input:u.input,status:"pending",result:null,timestamp:u.timestamp||e.message.timestamp,isExpanded:!0}})});return(b,g)=>(r(),c("div",kp,[s("div",{class:"message-speaker",title:l.value},[...g[0]||(g[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Ep),s("div",Sp,[p.value?(r(),c("div",Cp,[pe(ka,{thinking:d.value},null,8,["thinking"])])):x("",!0),m.value?(r(),c("div",{key:1,class:"message-text",innerHTML:f.value},null,8,Tp)):x("",!0),k.value?(r(),be(wp,{key:2,tools:w.value},null,8,["tools"])):x("",!0)])]))}},Ap=Z(xp,[["__scopeId","data-v-2e32f6ef"]]),Op={key:0,class:"message-row message-row-compaction"},Mp=["title"],Dp={class:"message-content-column"},Np={class:"compaction-status-content"},Lp={class:"text-muted ms-auto"},jp={key:1,class:"message-row message-row-system"},Ip=["title"],Pp={class:"message-content-column"},Rp={class:"system-text"},Wp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>Ht(e.message.timestamp)),o=v(()=>`system
${t.value}`),i=v(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,l)=>i.value?(r(),c("div",Op,[s("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Mp),s("div",Dp,[s("div",Np,[l[1]||(l[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Lp,$(t.value),1)])])])):(r(),c("div",jp,[s("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Ip),s("div",Pp,[s("span",Rp,$(n.message.content),1)])]))}},Sn=Z(Wp,[["__scopeId","data-v-a078178f"]]),Hp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>{switch(e.message.type){case"user":return ha;case"assistant":return Ap;case"system":return Sn;default:return Sn}});return(o,i)=>(r(),be(lo(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Bp=Z(Hp,[["__scopeId","data-v-11dff525"]]);var we="top",Te="bottom",xe="right",ke="left",cs="auto",Ot=[we,Te,xe,ke],ct="start",kt="end",uo="clippingParents",Ks="viewport",_t="popper",mo="reference",Hs=Ot.reduce(function(n,e){return n.concat([e+"-"+ct,e+"-"+kt])},[]),Gs=[].concat(Ot,[cs]).reduce(function(n,e){return n.concat([e,e+"-"+ct,e+"-"+kt])},[]),po="beforeRead",fo="read",vo="afterRead",ho="beforeMain",_o="main",go="afterMain",bo="beforeWrite",yo="write",$o="afterWrite",wo=[po,fo,vo,ho,_o,go,bo,yo,$o];function Ue(n){return n?(n.nodeName||"").toLowerCase():null}function Ae(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ut(n){var e=Ae(n).Element;return n instanceof e||n instanceof Element}function Me(n){var e=Ae(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Ys(n){if(typeof ShadowRoot>"u")return!1;var e=Ae(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Fp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Me(a)||!Ue(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(l){var m=i[l];m===!1?a.removeAttribute(l):a.setAttribute(l,m===!0?"":m)}))})}function Vp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),m=l.reduce(function(f,p){return f[p]="",f},{});!Me(i)||!Ue(i)||(Object.assign(i.style,m),Object.keys(a).forEach(function(f){i.removeAttribute(f)}))})}}const ko={name:"applyStyles",enabled:!0,phase:"write",fn:Fp,effect:Vp,requires:["computeStyles"]};function Fe(n){return n.split("-")[0]}var rt=Math.max,os=Math.min,Et=Math.round;function Bs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Eo(){return!/^((?!chrome|android).)*safari/i.test(Bs())}function St(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Me(n)&&(i=n.offsetWidth>0&&Et(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&Et(o.height)/n.offsetHeight||1);var l=ut(n)?Ae(n):window,m=l.visualViewport,f=!Eo()&&t,p=(o.left+(f&&m?m.offsetLeft:0))/i,d=(o.top+(f&&m?m.offsetTop:0))/a,k=o.width/i,_=o.height/a;return{width:k,height:_,top:d,right:p+k,bottom:d+_,left:p,x:p,y:d}}function Js(n){var e=St(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function So(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Ys(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ke(n){return Ae(n).getComputedStyle(n)}function Up(n){return["table","td","th"].indexOf(Ue(n))>=0}function tt(n){return((ut(n)?n.ownerDocument:n.document)||window.document).documentElement}function us(n){return Ue(n)==="html"?n:n.assignedSlot||n.parentNode||(Ys(n)?n.host:null)||tt(n)}function Cn(n){return!Me(n)||Ke(n).position==="fixed"?null:n.offsetParent}function qp(n){var e=/firefox/i.test(Bs()),t=/Trident/i.test(Bs());if(t&&Me(n)){var o=Ke(n);if(o.position==="fixed")return null}var i=us(n);for(Ys(i)&&(i=i.host);Me(i)&&["html","body"].indexOf(Ue(i))<0;){var a=Ke(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Bt(n){for(var e=Ae(n),t=Cn(n);t&&Up(t)&&Ke(t).position==="static";)t=Cn(t);return t&&(Ue(t)==="html"||Ue(t)==="body"&&Ke(t).position==="static")?e:t||qp(n)||e}function Qs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function It(n,e,t){return rt(n,os(e,t))}function zp(n,e,t){var o=It(n,e,t);return o>t?t:o}function Co(){return{top:0,right:0,bottom:0,left:0}}function To(n){return Object.assign({},Co(),n)}function xo(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Kp=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,To(typeof e!="number"?e:xo(e,Ot))};function Gp(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,l=t.modifiersData.popperOffsets,m=Fe(t.placement),f=Qs(m),p=[ke,xe].indexOf(m)>=0,d=p?"height":"width";if(!(!a||!l)){var k=Kp(i.padding,t),_=Js(a),w=f==="y"?we:ke,b=f==="y"?Te:xe,g=t.rects.reference[d]+t.rects.reference[f]-l[f]-t.rects.popper[d],u=l[f]-t.rects.reference[f],y=Bt(a),h=y?f==="y"?y.clientHeight||0:y.clientWidth||0:0,S=g/2-u/2,E=k[w],I=h-_[d]-k[b],N=h/2-_[d]/2+S,A=It(E,N,I),P=f;t.modifiersData[o]=(e={},e[P]=A,e.centerOffset=A-N,e)}}function Yp(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||So(e.elements.popper,i)&&(e.elements.arrow=i))}const Ao={name:"arrow",enabled:!0,phase:"main",fn:Gp,effect:Yp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ct(n){return n.split("-")[1]}var Jp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qp(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Et(t*i)/i||0,y:Et(o*i)/i||0}}function Tn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,l=n.offsets,m=n.position,f=n.gpuAcceleration,p=n.adaptive,d=n.roundOffsets,k=n.isFixed,_=l.x,w=_===void 0?0:_,b=l.y,g=b===void 0?0:b,u=typeof d=="function"?d({x:w,y:g}):{x:w,y:g};w=u.x,g=u.y;var y=l.hasOwnProperty("x"),h=l.hasOwnProperty("y"),S=ke,E=we,I=window;if(p){var N=Bt(t),A="clientHeight",P="clientWidth";if(N===Ae(t)&&(N=tt(t),Ke(N).position!=="static"&&m==="absolute"&&(A="scrollHeight",P="scrollWidth")),N=N,i===we||(i===ke||i===xe)&&a===kt){E=Te;var C=k&&N===I&&I.visualViewport?I.visualViewport.height:N[A];g-=C-o.height,g*=f?1:-1}if(i===ke||(i===we||i===Te)&&a===kt){S=xe;var T=k&&N===I&&I.visualViewport?I.visualViewport.width:N[P];w-=T-o.width,w*=f?1:-1}}var U=Object.assign({position:m},p&&Jp),q=d===!0?Qp({x:w,y:g},Ae(t)):{x:w,y:g};if(w=q.x,g=q.y,f){var W;return Object.assign({},U,(W={},W[E]=h?"0":"",W[S]=y?"0":"",W.transform=(I.devicePixelRatio||1)<=1?"translate("+w+"px, "+g+"px)":"translate3d("+w+"px, "+g+"px, 0)",W))}return Object.assign({},U,(e={},e[E]=h?g+"px":"",e[S]=y?w+"px":"",e.transform="",e))}function Xp(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,l=a===void 0?!0:a,m=t.roundOffsets,f=m===void 0?!0:m,p={placement:Fe(e.placement),variation:Ct(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Tn(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:f})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Tn(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Oo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Xp,data:{}};var Kt={passive:!0};function Zp(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,l=o.resize,m=l===void 0?!0:l,f=Ae(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&p.forEach(function(d){d.addEventListener("scroll",t.update,Kt)}),m&&f.addEventListener("resize",t.update,Kt),function(){a&&p.forEach(function(d){d.removeEventListener("scroll",t.update,Kt)}),m&&f.removeEventListener("resize",t.update,Kt)}}const Mo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Zp,data:{}};var ef={left:"right",right:"left",bottom:"top",top:"bottom"};function es(n){return n.replace(/left|right|bottom|top/g,function(e){return ef[e]})}var tf={start:"end",end:"start"};function xn(n){return n.replace(/start|end/g,function(e){return tf[e]})}function Xs(n){var e=Ae(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Zs(n){return St(tt(n)).left+Xs(n).scrollLeft}function sf(n,e){var t=Ae(n),o=tt(n),i=t.visualViewport,a=o.clientWidth,l=o.clientHeight,m=0,f=0;if(i){a=i.width,l=i.height;var p=Eo();(p||!p&&e==="fixed")&&(m=i.offsetLeft,f=i.offsetTop)}return{width:a,height:l,x:m+Zs(n),y:f}}function nf(n){var e,t=tt(n),o=Xs(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=rt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=rt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),m=-o.scrollLeft+Zs(n),f=-o.scrollTop;return Ke(i||t).direction==="rtl"&&(m+=rt(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:m,y:f}}function en(n){var e=Ke(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Do(n){return["html","body","#document"].indexOf(Ue(n))>=0?n.ownerDocument.body:Me(n)&&en(n)?n:Do(us(n))}function Pt(n,e){var t;e===void 0&&(e=[]);var o=Do(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=Ae(o),l=i?[a].concat(a.visualViewport||[],en(o)?o:[]):o,m=e.concat(l);return i?m:m.concat(Pt(us(l)))}function Fs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function of(n,e){var t=St(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function An(n,e,t){return e===Ks?Fs(sf(n,t)):ut(e)?of(e,t):Fs(nf(tt(n)))}function af(n){var e=Pt(us(n)),t=["absolute","fixed"].indexOf(Ke(n).position)>=0,o=t&&Me(n)?Bt(n):n;return ut(o)?e.filter(function(i){return ut(i)&&So(i,o)&&Ue(i)!=="body"}):[]}function rf(n,e,t,o){var i=e==="clippingParents"?af(n):[].concat(e),a=[].concat(i,[t]),l=a[0],m=a.reduce(function(f,p){var d=An(n,p,o);return f.top=rt(d.top,f.top),f.right=os(d.right,f.right),f.bottom=os(d.bottom,f.bottom),f.left=rt(d.left,f.left),f},An(n,l,o));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m}function No(n){var e=n.reference,t=n.element,o=n.placement,i=o?Fe(o):null,a=o?Ct(o):null,l=e.x+e.width/2-t.width/2,m=e.y+e.height/2-t.height/2,f;switch(i){case we:f={x:l,y:e.y-t.height};break;case Te:f={x:l,y:e.y+e.height};break;case xe:f={x:e.x+e.width,y:m};break;case ke:f={x:e.x-t.width,y:m};break;default:f={x:e.x,y:e.y}}var p=i?Qs(i):null;if(p!=null){var d=p==="y"?"height":"width";switch(a){case ct:f[p]=f[p]-(e[d]/2-t[d]/2);break;case kt:f[p]=f[p]+(e[d]/2-t[d]/2);break}}return f}function Tt(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,l=a===void 0?n.strategy:a,m=t.boundary,f=m===void 0?uo:m,p=t.rootBoundary,d=p===void 0?Ks:p,k=t.elementContext,_=k===void 0?_t:k,w=t.altBoundary,b=w===void 0?!1:w,g=t.padding,u=g===void 0?0:g,y=To(typeof u!="number"?u:xo(u,Ot)),h=_===_t?mo:_t,S=n.rects.popper,E=n.elements[b?h:_],I=rf(ut(E)?E:E.contextElement||tt(n.elements.popper),f,d,l),N=St(n.elements.reference),A=No({reference:N,element:S,placement:i}),P=Fs(Object.assign({},S,A)),C=_===_t?P:N,T={top:I.top-C.top+y.top,bottom:C.bottom-I.bottom+y.bottom,left:I.left-C.left+y.left,right:C.right-I.right+y.right},U=n.modifiersData.offset;if(_===_t&&U){var q=U[i];Object.keys(T).forEach(function(W){var H=[xe,Te].indexOf(W)>=0?1:-1,F=[we,Te].indexOf(W)>=0?"y":"x";T[W]+=q[F]*H})}return T}function lf(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,l=t.padding,m=t.flipVariations,f=t.allowedAutoPlacements,p=f===void 0?Gs:f,d=Ct(o),k=d?m?Hs:Hs.filter(function(b){return Ct(b)===d}):Ot,_=k.filter(function(b){return p.indexOf(b)>=0});_.length===0&&(_=k);var w=_.reduce(function(b,g){return b[g]=Tt(n,{placement:g,boundary:i,rootBoundary:a,padding:l})[Fe(g)],b},{});return Object.keys(w).sort(function(b,g){return w[b]-w[g]})}function cf(n){if(Fe(n)===cs)return[];var e=es(n);return[xn(n),e,xn(e)]}function uf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,l=t.altAxis,m=l===void 0?!0:l,f=t.fallbackPlacements,p=t.padding,d=t.boundary,k=t.rootBoundary,_=t.altBoundary,w=t.flipVariations,b=w===void 0?!0:w,g=t.allowedAutoPlacements,u=e.options.placement,y=Fe(u),h=y===u,S=f||(h||!b?[es(u)]:cf(u)),E=[u].concat(S).reduce(function(Q,re){return Q.concat(Fe(re)===cs?lf(e,{placement:re,boundary:d,rootBoundary:k,padding:p,flipVariations:b,allowedAutoPlacements:g}):re)},[]),I=e.rects.reference,N=e.rects.popper,A=new Map,P=!0,C=E[0],T=0;T<E.length;T++){var U=E[T],q=Fe(U),W=Ct(U)===ct,H=[we,Te].indexOf(q)>=0,F=H?"width":"height",O=Tt(e,{placement:U,boundary:d,rootBoundary:k,altBoundary:_,padding:p}),M=H?W?xe:ke:W?Te:we;I[F]>N[F]&&(M=es(M));var K=es(M),L=[];if(a&&L.push(O[q]<=0),m&&L.push(O[M]<=0,O[K]<=0),L.every(function(Q){return Q})){C=U,P=!1;break}A.set(U,L)}if(P)for(var D=b?3:1,z=function(re){var me=E.find(function(B){var j=A.get(B);if(j)return j.slice(0,re).every(function(J){return J})});if(me)return C=me,"break"},oe=D;oe>0;oe--){var Y=z(oe);if(Y==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const Lo={name:"flip",enabled:!0,phase:"main",fn:uf,requiresIfExists:["offset"],data:{_skip:!1}};function On(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Mn(n){return[we,xe,Te,ke].some(function(e){return n[e]>=0})}function df(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=Tt(e,{elementContext:"reference"}),m=Tt(e,{altBoundary:!0}),f=On(l,o),p=On(m,i,a),d=Mn(f),k=Mn(p);e.modifiersData[t]={referenceClippingOffsets:f,popperEscapeOffsets:p,isReferenceHidden:d,hasPopperEscaped:k},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":k})}const jo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:df};function mf(n,e,t){var o=Fe(n),i=[ke,we].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,l=a[0],m=a[1];return l=l||0,m=(m||0)*i,[ke,xe].indexOf(o)>=0?{x:m,y:l}:{x:l,y:m}}function pf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,l=Gs.reduce(function(d,k){return d[k]=mf(k,e.rects,a),d},{}),m=l[e.placement],f=m.x,p=m.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=f,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=l}const Io={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:pf};function ff(n){var e=n.state,t=n.name;e.modifiersData[t]=No({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Po={name:"popperOffsets",enabled:!0,phase:"read",fn:ff,data:{}};function vf(n){return n==="x"?"y":"x"}function hf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,l=t.altAxis,m=l===void 0?!1:l,f=t.boundary,p=t.rootBoundary,d=t.altBoundary,k=t.padding,_=t.tether,w=_===void 0?!0:_,b=t.tetherOffset,g=b===void 0?0:b,u=Tt(e,{boundary:f,rootBoundary:p,padding:k,altBoundary:d}),y=Fe(e.placement),h=Ct(e.placement),S=!h,E=Qs(y),I=vf(E),N=e.modifiersData.popperOffsets,A=e.rects.reference,P=e.rects.popper,C=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,T=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),U=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,q={x:0,y:0};if(N){if(a){var W,H=E==="y"?we:ke,F=E==="y"?Te:xe,O=E==="y"?"height":"width",M=N[E],K=M+u[H],L=M-u[F],D=w?-P[O]/2:0,z=h===ct?A[O]:P[O],oe=h===ct?-P[O]:-A[O],Y=e.elements.arrow,Q=w&&Y?Js(Y):{width:0,height:0},re=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Co(),me=re[H],B=re[F],j=It(0,A[O],Q[O]),J=S?A[O]/2-D-j-me-T.mainAxis:z-j-me-T.mainAxis,te=S?-A[O]/2+D+j+B+T.mainAxis:oe+j+B+T.mainAxis,ie=e.elements.arrow&&Bt(e.elements.arrow),he=ie?E==="y"?ie.clientTop||0:ie.clientLeft||0:0,Ie=(W=U?.[E])!=null?W:0,Ye=M+J-Ie-he,V=M+te-Ie,ae=It(w?os(K,Ye):K,M,w?rt(L,V):L);N[E]=ae,q[E]=ae-M}if(m){var ce,Pe=E==="x"?we:ke,Re=E==="x"?Te:xe,$e=N[I],zt=I==="y"?"height":"width",cn=$e+u[Pe],un=$e-u[Re],_s=[we,ke].indexOf(y)!==-1,dn=(ce=U?.[I])!=null?ce:0,mn=_s?cn:$e-A[zt]-P[zt]-dn+T.altAxis,pn=_s?$e+A[zt]+P[zt]-dn-T.altAxis:un,fn=w&&_s?zp(mn,$e,pn):It(w?mn:cn,$e,w?pn:un);N[I]=fn,q[I]=fn-$e}e.modifiersData[o]=q}}const Ro={name:"preventOverflow",enabled:!0,phase:"main",fn:hf,requiresIfExists:["offset"]};function _f(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function gf(n){return n===Ae(n)||!Me(n)?Xs(n):_f(n)}function bf(n){var e=n.getBoundingClientRect(),t=Et(e.width)/n.offsetWidth||1,o=Et(e.height)/n.offsetHeight||1;return t!==1||o!==1}function yf(n,e,t){t===void 0&&(t=!1);var o=Me(e),i=Me(e)&&bf(e),a=tt(e),l=St(n,i,t),m={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(o||!o&&!t)&&((Ue(e)!=="body"||en(a))&&(m=gf(e)),Me(e)?(f=St(e,!0),f.x+=e.clientLeft,f.y+=e.clientTop):a&&(f.x=Zs(a))),{x:l.left+m.scrollLeft-f.x,y:l.top+m.scrollTop-f.y,width:l.width,height:l.height}}function $f(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(m){if(!t.has(m)){var f=e.get(m);f&&i(f)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function wf(n){var e=$f(n);return wo.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function kf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Ef(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var Dn={placement:"bottom",modifiers:[],strategy:"absolute"};function Nn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Wo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?Dn:i;return function(m,f,p){p===void 0&&(p=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Dn,a),modifiersData:{},elements:{reference:m,popper:f},attributes:{},styles:{}},k=[],_=!1,w={state:d,setOptions:function(y){var h=typeof y=="function"?y(d.options):y;g(),d.options=Object.assign({},a,d.options,h),d.scrollParents={reference:ut(m)?Pt(m):m.contextElement?Pt(m.contextElement):[],popper:Pt(f)};var S=wf(Ef([].concat(o,d.options.modifiers)));return d.orderedModifiers=S.filter(function(E){return E.enabled}),b(),w.update()},forceUpdate:function(){if(!_){var y=d.elements,h=y.reference,S=y.popper;if(Nn(h,S)){d.rects={reference:yf(h,Bt(S),d.options.strategy==="fixed"),popper:Js(S)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(T){return d.modifiersData[T.name]=Object.assign({},T.data)});for(var E=0;E<d.orderedModifiers.length;E++){if(d.reset===!0){d.reset=!1,E=-1;continue}var I=d.orderedModifiers[E],N=I.fn,A=I.options,P=A===void 0?{}:A,C=I.name;typeof N=="function"&&(d=N({state:d,options:P,name:C,instance:w})||d)}}}},update:kf(function(){return new Promise(function(u){w.forceUpdate(),u(d)})}),destroy:function(){g(),_=!0}};if(!Nn(m,f))return w;w.setOptions(p).then(function(u){!_&&p.onFirstUpdate&&p.onFirstUpdate(u)});function b(){d.orderedModifiers.forEach(function(u){var y=u.name,h=u.options,S=h===void 0?{}:h,E=u.effect;if(typeof E=="function"){var I=E({state:d,name:y,instance:w,options:S}),N=function(){};k.push(I||N)}})}function g(){k.forEach(function(u){return u()}),k=[]}return w}}var Sf=[Mo,Po,Oo,ko,Io,Lo,Ro,Ao,jo],tn=Wo({defaultModifiers:Sf});const Ho=Object.freeze(Object.defineProperty({__proto__:null,afterMain:go,afterRead:vo,afterWrite:$o,applyStyles:ko,arrow:Ao,auto:cs,basePlacements:Ot,beforeMain:ho,beforeRead:po,beforeWrite:bo,bottom:Te,clippingParents:uo,computeStyles:Oo,createPopper:tn,detectOverflow:Tt,end:kt,eventListeners:Mo,flip:Lo,hide:jo,left:ke,main:_o,modifierPhases:wo,offset:Io,placements:Gs,popper:_t,popperGenerator:Wo,popperOffsets:Po,preventOverflow:Ro,read:fo,reference:mo,right:xe,start:ct,top:we,variationPlacements:Hs,viewport:Ks,write:yo},Symbol.toStringTag,{value:"Module"}));const Je=new Map,Es={set(n,e,t){Je.has(n)||Je.set(n,new Map);const o=Je.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Je.has(n)&&Je.get(n).get(e)||null},remove(n,e){if(!Je.has(n))return;const t=Je.get(n);t.delete(e),t.size===0&&Je.delete(n)}},Cf=1e6,Tf=1e3,Vs="transitionend",Bo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),xf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Af=n=>{do n+=Math.floor(Math.random()*Cf);while(document.getElementById(n));return n},Of=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Tf)},Fo=n=>{n.dispatchEvent(new Event(Vs))},qe=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Qe=n=>qe(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Bo(n)):null,Mt=n=>{if(!qe(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Xe=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Vo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Vo(n.parentNode):null},is=()=>{},Ft=n=>{n.offsetHeight},Uo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ss=[],Mf=n=>{document.readyState==="loading"?(Ss.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ss)e()}),Ss.push(n)):n()},De=()=>document.documentElement.dir==="rtl",je=n=>{Mf(()=>{const e=Uo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},Ee=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,qo=(n,e,t=!0)=>{if(!t){Ee(n);return}const i=Of(e)+5;let a=!1;const l=({target:m})=>{m===e&&(a=!0,e.removeEventListener(Vs,l),Ee(n))};e.addEventListener(Vs,l),setTimeout(()=>{a||Fo(e)},i)},sn=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},Df=/[^.]*(?=\..*)\.|.*/,Nf=/\..*/,Lf=/::\d+$/,Cs={};let Ln=1;const zo={mouseenter:"mouseover",mouseleave:"mouseout"},jf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ko(n,e){return e&&`${e}::${Ln++}`||n.uidEvent||Ln++}function Go(n){const e=Ko(n);return n.uidEvent=e,Cs[e]=Cs[e]||{},Cs[e]}function If(n,e){return function t(o){return nn(o,{delegateTarget:n}),t.oneOff&&G.off(n,o.type,e),e.apply(n,[o])}}function Pf(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const m of a)if(m===l)return nn(i,{delegateTarget:l}),o.oneOff&&G.off(n,i.type,e,t),t.apply(l,[i])}}function Yo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Jo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Qo(n);return jf.has(a)||(a=n),[o,i,a]}function jn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,l,m]=Jo(e,t,o);e in zo&&(l=(b=>function(g){if(!g.relatedTarget||g.relatedTarget!==g.delegateTarget&&!g.delegateTarget.contains(g.relatedTarget))return b.call(this,g)})(l));const f=Go(n),p=f[m]||(f[m]={}),d=Yo(p,l,a?t:null);if(d){d.oneOff=d.oneOff&&i;return}const k=Ko(l,e.replace(Df,"")),_=a?Pf(n,t,l):If(n,l);_.delegationSelector=a?t:null,_.callable=l,_.oneOff=i,_.uidEvent=k,p[k]=_,n.addEventListener(m,_,a)}function Us(n,e,t,o,i){const a=Yo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function Rf(n,e,t,o){const i=e[t]||{};for(const[a,l]of Object.entries(i))a.includes(o)&&Us(n,e,t,l.callable,l.delegationSelector)}function Qo(n){return n=n.replace(Nf,""),zo[n]||n}const G={on(n,e,t,o){jn(n,e,t,o,!1)},one(n,e,t,o){jn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,l]=Jo(e,t,o),m=l!==e,f=Go(n),p=f[l]||{},d=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(p).length)return;Us(n,f,l,a,i?t:null);return}if(d)for(const k of Object.keys(f))Rf(n,f,k,e.slice(1));for(const[k,_]of Object.entries(p)){const w=k.replace(Lf,"");(!m||e.includes(w))&&Us(n,f,l,_.callable,_.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Uo(),i=Qo(e),a=e!==i;let l=null,m=!0,f=!0,p=!1;a&&o&&(l=o.Event(e,t),o(n).trigger(l),m=!l.isPropagationStopped(),f=!l.isImmediatePropagationStopped(),p=l.isDefaultPrevented());const d=nn(new Event(e,{bubbles:m,cancelable:!0}),t);return p&&d.preventDefault(),f&&n.dispatchEvent(d),d.defaultPrevented&&l&&l.preventDefault(),d}};function nn(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function In(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Ts(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const ze={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${Ts(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Ts(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=In(n.dataset[o])}return e},getDataAttribute(n,e){return In(n.getAttribute(`data-bs-${Ts(e)}`))}};class Vt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=qe(t)?ze.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...qe(t)?ze.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],l=qe(a)?"element":xf(a);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const Wf="5.3.8";class Be extends Vt{constructor(e,t){super(),e=Qe(e),e&&(this._element=e,this._config=this._getConfig(t),Es.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Es.remove(this._element,this.constructor.DATA_KEY),G.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){qo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Es.get(Qe(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Wf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const xs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Bo(t)).join(","):null},se={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Xe(t)&&Mt(t))},getSelectorFromElement(n){const e=xs(n);return e&&se.findOne(e)?e:null},getElementFromSelector(n){const e=xs(n);return e?se.findOne(e):null},getMultipleElementsFromSelector(n){const e=xs(n);return e?se.find(e):[]}},ds=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;G.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Xe(this))return;const a=se.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},Hf="alert",Bf="bs.alert",Xo=`.${Bf}`,Ff=`close${Xo}`,Vf=`closed${Xo}`,Uf="fade",qf="show";class ms extends Be{static get NAME(){return Hf}close(){if(G.trigger(this._element,Ff).defaultPrevented)return;this._element.classList.remove(qf);const t=this._element.classList.contains(Uf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),G.trigger(this._element,Vf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ms.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ds(ms,"close");je(ms);const zf="button",Kf="bs.button",Gf=`.${Kf}`,Yf=".data-api",Jf="active",Pn='[data-bs-toggle="button"]',Qf=`click${Gf}${Yf}`;class ps extends Be{static get NAME(){return zf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Jf))}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}G.on(document,Qf,Pn,n=>{n.preventDefault();const e=n.target.closest(Pn);ps.getOrCreateInstance(e).toggle()});je(ps);const Xf="swipe",Dt=".bs.swipe",Zf=`touchstart${Dt}`,ev=`touchmove${Dt}`,tv=`touchend${Dt}`,sv=`pointerdown${Dt}`,nv=`pointerup${Dt}`,ov="touch",iv="pen",av="pointer-event",rv=40,lv={endCallback:null,leftCallback:null,rightCallback:null},cv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class as extends Vt{constructor(e,t){super(),this._element=e,!(!e||!as.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return lv}static get DefaultType(){return cv}static get NAME(){return Xf}dispose(){G.off(this._element,Dt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ee(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=rv)return;const t=e/this._deltaX;this._deltaX=0,t&&Ee(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(G.on(this._element,sv,e=>this._start(e)),G.on(this._element,nv,e=>this._end(e)),this._element.classList.add(av)):(G.on(this._element,Zf,e=>this._start(e)),G.on(this._element,ev,e=>this._move(e)),G.on(this._element,tv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===iv||e.pointerType===ov)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const uv="carousel",dv="bs.carousel",st=`.${dv}`,Zo=".data-api",mv="ArrowLeft",pv="ArrowRight",fv=500,Lt="next",vt="prev",gt="left",ts="right",vv=`slide${st}`,As=`slid${st}`,hv=`keydown${st}`,_v=`mouseenter${st}`,gv=`mouseleave${st}`,bv=`dragstart${st}`,yv=`load${st}${Zo}`,$v=`click${st}${Zo}`,ei="carousel",Gt="active",wv="slide",kv="carousel-item-end",Ev="carousel-item-start",Sv="carousel-item-next",Cv="carousel-item-prev",ti=".active",si=".carousel-item",Tv=ti+si,xv=".carousel-item img",Av=".carousel-indicators",Ov="[data-bs-slide], [data-bs-slide-to]",Mv='[data-bs-ride="carousel"]',Dv={[mv]:ts,[pv]:gt},Nv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Lv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ut extends Be{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=se.findOne(Av,this._element),this._addEventListeners(),this._config.ride===ei&&this.cycle()}static get Default(){return Nv}static get DefaultType(){return Lv}static get NAME(){return uv}next(){this._slide(Lt)}nextWhenVisible(){!document.hidden&&Mt(this._element)&&this.next()}prev(){this._slide(vt)}pause(){this._isSliding&&Fo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){G.one(this._element,As,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){G.one(this._element,As,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Lt:vt;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&G.on(this._element,hv,e=>this._keydown(e)),this._config.pause==="hover"&&(G.on(this._element,_v,()=>this.pause()),G.on(this._element,gv,()=>this._maybeEnableCycle())),this._config.touch&&as.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of se.find(xv,this._element))G.on(o,bv,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(gt)),rightCallback:()=>this._slide(this._directionToOrder(ts)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),fv+this._config.interval))}};this._swipeHelper=new as(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Dv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=se.findOne(ti,this._indicatorsElement);t.classList.remove(Gt),t.removeAttribute("aria-current");const o=se.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Gt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===Lt,a=t||sn(this._getItems(),o,i,this._config.wrap);if(a===o)return;const l=this._getItemIndex(a),m=w=>G.trigger(this._element,w,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(m(vv).defaultPrevented||!o||!a)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=a;const d=i?Ev:kv,k=i?Sv:Cv;a.classList.add(k),Ft(a),o.classList.add(d),a.classList.add(d);const _=()=>{a.classList.remove(d,k),a.classList.add(Gt),o.classList.remove(Gt,k,d),this._isSliding=!1,m(As)};this._queueCallback(_,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(wv)}_getActive(){return se.findOne(Tv,this._element)}_getItems(){return se.find(si,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return De()?e===gt?vt:Lt:e===gt?Lt:vt}_orderToDirection(e){return De()?e===vt?gt:ts:e===vt?ts:gt}static jQueryInterface(e){return this.each(function(){const t=Ut.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}G.on(document,$v,Ov,function(n){const e=se.getElementFromSelector(this);if(!e||!e.classList.contains(ei))return;n.preventDefault();const t=Ut.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(ze.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});G.on(window,yv,()=>{const n=se.find(Mv);for(const e of n)Ut.getOrCreateInstance(e)});je(Ut);const jv="collapse",Iv="bs.collapse",qt=`.${Iv}`,Pv=".data-api",Rv=`show${qt}`,Wv=`shown${qt}`,Hv=`hide${qt}`,Bv=`hidden${qt}`,Fv=`click${qt}${Pv}`,Os="show",yt="collapse",Yt="collapsing",Vv="collapsed",Uv=`:scope .${yt} .${yt}`,qv="collapse-horizontal",zv="width",Kv="height",Gv=".collapse.show, .collapse.collapsing",qs='[data-bs-toggle="collapse"]',Yv={parent:null,toggle:!0},Jv={parent:"(null|element)",toggle:"boolean"};class xt extends Be{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=se.find(qs);for(const i of o){const a=se.getSelectorFromElement(i),l=se.find(a).filter(m=>m===this._element);a!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Yv}static get DefaultType(){return Jv}static get NAME(){return jv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Gv).filter(m=>m!==this._element).map(m=>xt.getOrCreateInstance(m,{toggle:!1}))),e.length&&e[0]._isTransitioning||G.trigger(this._element,Rv).defaultPrevented)return;for(const m of e)m.hide();const o=this._getDimension();this._element.classList.remove(yt),this._element.classList.add(Yt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Yt),this._element.classList.add(yt,Os),this._element.style[o]="",G.trigger(this._element,Wv)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||G.trigger(this._element,Hv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ft(this._element),this._element.classList.add(Yt),this._element.classList.remove(yt,Os);for(const i of this._triggerArray){const a=se.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Yt),this._element.classList.add(yt),G.trigger(this._element,Bv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Os)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Qe(e.parent),e}_getDimension(){return this._element.classList.contains(qv)?zv:Kv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(qs);for(const t of e){const o=se.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=se.find(Uv,this._config.parent);return se.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(Vv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=xt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}G.on(document,Fv,qs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of se.getMultipleElementsFromSelector(this))xt.getOrCreateInstance(e,{toggle:!1}).toggle()});je(xt);const Rn="dropdown",Qv="bs.dropdown",pt=`.${Qv}`,on=".data-api",Xv="Escape",Wn="Tab",Zv="ArrowUp",Hn="ArrowDown",eh=2,th=`hide${pt}`,sh=`hidden${pt}`,nh=`show${pt}`,oh=`shown${pt}`,ni=`click${pt}${on}`,oi=`keydown${pt}${on}`,ih=`keyup${pt}${on}`,bt="show",ah="dropup",rh="dropend",lh="dropstart",ch="dropup-center",uh="dropdown-center",ot='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',dh=`${ot}.${bt}`,ss=".dropdown-menu",mh=".navbar",ph=".navbar-nav",fh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",vh=De()?"top-end":"top-start",hh=De()?"top-start":"top-end",_h=De()?"bottom-end":"bottom-start",gh=De()?"bottom-start":"bottom-end",bh=De()?"left-start":"right-start",yh=De()?"right-start":"left-start",$h="top",wh="bottom",kh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Eh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ve extends Be{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=se.next(this._element,ss)[0]||se.prev(this._element,ss)[0]||se.findOne(ss,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return kh}static get DefaultType(){return Eh}static get NAME(){return Rn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Xe(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!G.trigger(this._element,nh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(ph))for(const o of[].concat(...document.body.children))G.on(o,"mouseover",is);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(bt),this._element.classList.add(bt),G.trigger(this._element,oh,e)}}hide(){if(Xe(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!G.trigger(this._element,th,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))G.off(o,"mouseover",is);this._popper&&this._popper.destroy(),this._menu.classList.remove(bt),this._element.classList.remove(bt),this._element.setAttribute("aria-expanded","false"),ze.removeDataAttribute(this._menu,"popper"),G.trigger(this._element,sh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!qe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Rn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ho>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:qe(this._config.reference)?e=Qe(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=tn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(bt)}_getPlacement(){const e=this._parent;if(e.classList.contains(rh))return bh;if(e.classList.contains(lh))return yh;if(e.classList.contains(ch))return $h;if(e.classList.contains(uh))return wh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ah)?t?hh:vh:t?gh:_h}_detectNavbar(){return this._element.closest(mh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ze.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ee(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=se.find(fh,this._menu).filter(i=>Mt(i));o.length&&sn(o,t,e===Hn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ve.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===eh||e.type==="keyup"&&e.key!==Wn)return;const t=se.find(dh);for(const o of t){const i=Ve.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),l=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Wn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const m={relatedTarget:i._element};e.type==="click"&&(m.clickEvent=e),i._completeHide(m)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===Xv,i=[Zv,Hn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(ot)?this:se.prev(this,ot)[0]||se.next(this,ot)[0]||se.findOne(ot,e.delegateTarget.parentNode),l=Ve.getOrCreateInstance(a);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),a.focus())}}G.on(document,oi,ot,Ve.dataApiKeydownHandler);G.on(document,oi,ss,Ve.dataApiKeydownHandler);G.on(document,ni,Ve.clearMenus);G.on(document,ih,Ve.clearMenus);G.on(document,ni,ot,function(n){n.preventDefault(),Ve.getOrCreateInstance(this).toggle()});je(Ve);const ii="backdrop",Sh="fade",Bn="show",Fn=`mousedown.bs.${ii}`,Ch={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Th={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ai extends Vt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ch}static get DefaultType(){return Th}static get NAME(){return ii}show(e){if(!this._config.isVisible){Ee(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Ft(t),t.classList.add(Bn),this._emulateAnimation(()=>{Ee(e)})}hide(e){if(!this._config.isVisible){Ee(e);return}this._getElement().classList.remove(Bn),this._emulateAnimation(()=>{this.dispose(),Ee(e)})}dispose(){this._isAppended&&(G.off(this._element,Fn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Sh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Qe(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),G.on(e,Fn,()=>{Ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){qo(e,this._getElement(),this._config.isAnimated)}}const xh="focustrap",Ah="bs.focustrap",rs=`.${Ah}`,Oh=`focusin${rs}`,Mh=`keydown.tab${rs}`,Dh="Tab",Nh="forward",Vn="backward",Lh={autofocus:!0,trapElement:null},jh={autofocus:"boolean",trapElement:"element"};class ri extends Vt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Lh}static get DefaultType(){return jh}static get NAME(){return xh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),G.off(document,rs),G.on(document,Oh,e=>this._handleFocusin(e)),G.on(document,Mh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,G.off(document,rs))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=se.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Vn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Dh&&(this._lastTabNavDirection=e.shiftKey?Vn:Nh)}}const Un=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",qn=".sticky-top",Jt="padding-right",zn="margin-right";class zs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Jt,t=>t+e),this._setElementAttributes(Un,Jt,t=>t+e),this._setElementAttributes(qn,zn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Jt),this._resetElementAttributes(Un,Jt),this._resetElementAttributes(qn,zn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,t);const m=window.getComputedStyle(l).getPropertyValue(t);l.style.setProperty(t,`${o(Number.parseFloat(m))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&ze.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=ze.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}ze.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(qe(e)){t(e);return}for(const o of se.find(e,this._element))t(o)}}const Ih="modal",Ph="bs.modal",Ne=`.${Ph}`,Rh=".data-api",Wh="Escape",Hh=`hide${Ne}`,Bh=`hidePrevented${Ne}`,li=`hidden${Ne}`,ci=`show${Ne}`,Fh=`shown${Ne}`,Vh=`resize${Ne}`,Uh=`click.dismiss${Ne}`,qh=`mousedown.dismiss${Ne}`,zh=`keydown.dismiss${Ne}`,Kh=`click${Ne}${Rh}`,Kn="modal-open",Gh="fade",Gn="show",Ms="modal-static",Yh=".modal.show",Jh=".modal-dialog",Qh=".modal-body",Xh='[data-bs-toggle="modal"]',Zh={backdrop:!0,focus:!0,keyboard:!0},e_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class dt extends Be{constructor(e,t){super(e,t),this._dialog=se.findOne(Jh,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new zs,this._addEventListeners()}static get Default(){return Zh}static get DefaultType(){return e_}static get NAME(){return Ih}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||G.trigger(this._element,ci,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Kn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||G.trigger(this._element,Hh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Gn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){G.off(window,Ne),G.off(this._dialog,Ne),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ai({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ri({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=se.findOne(Qh,this._dialog);t&&(t.scrollTop=0),Ft(this._element),this._element.classList.add(Gn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,G.trigger(this._element,Fh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){G.on(this._element,zh,e=>{if(e.key===Wh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),G.on(window,Vh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),G.on(this._element,qh,e=>{G.one(this._element,Uh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Kn),this._resetAdjustments(),this._scrollBar.reset(),G.trigger(this._element,li)})}_isAnimated(){return this._element.classList.contains(Gh)}_triggerBackdropTransition(){if(G.trigger(this._element,Bh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ms)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ms),this._queueCallback(()=>{this._element.classList.remove(Ms),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=De()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=De()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=dt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}G.on(document,Kh,Xh,function(n){const e=se.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),G.one(e,ci,i=>{i.defaultPrevented||G.one(e,li,()=>{Mt(this)&&this.focus()})});const t=se.findOne(Yh);t&&dt.getInstance(t).hide(),dt.getOrCreateInstance(e).toggle(this)});ds(dt);je(dt);const t_="offcanvas",s_="bs.offcanvas",Ge=`.${s_}`,ui=".data-api",n_=`load${Ge}${ui}`,o_="Escape",Yn="show",Jn="showing",Qn="hiding",i_="offcanvas-backdrop",di=".offcanvas.show",a_=`show${Ge}`,r_=`shown${Ge}`,l_=`hide${Ge}`,Xn=`hidePrevented${Ge}`,mi=`hidden${Ge}`,c_=`resize${Ge}`,u_=`click${Ge}${ui}`,d_=`keydown.dismiss${Ge}`,m_='[data-bs-toggle="offcanvas"]',p_={backdrop:!0,keyboard:!0,scroll:!1},f_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ze extends Be{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return p_}static get DefaultType(){return f_}static get NAME(){return t_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||G.trigger(this._element,a_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new zs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Jn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Yn),this._element.classList.remove(Jn),G.trigger(this._element,r_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||G.trigger(this._element,l_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Qn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Yn,Qn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new zs().reset(),G.trigger(this._element,mi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){G.trigger(this._element,Xn);return}this.hide()},t=!!this._config.backdrop;return new ai({className:i_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new ri({trapElement:this._element})}_addEventListeners(){G.on(this._element,d_,e=>{if(e.key===o_){if(this._config.keyboard){this.hide();return}G.trigger(this._element,Xn)}})}static jQueryInterface(e){return this.each(function(){const t=Ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}G.on(document,u_,m_,function(n){const e=se.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Xe(this))return;G.one(e,mi,()=>{Mt(this)&&this.focus()});const t=se.findOne(di);t&&t!==e&&Ze.getInstance(t).hide(),Ze.getOrCreateInstance(e).toggle(this)});G.on(window,n_,()=>{for(const n of se.find(di))Ze.getOrCreateInstance(n).show()});G.on(window,c_,()=>{for(const n of se.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ze.getOrCreateInstance(n).hide()});ds(Ze);je(Ze);const v_=/^aria-[\w-]*$/i,pi={"*":["class","dir","id","lang","role",v_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},h_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),__=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,g_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?h_.has(t)?!!__.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function b_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const l of a){const m=l.nodeName.toLowerCase();if(!Object.keys(e).includes(m)){l.remove();continue}const f=[].concat(...l.attributes),p=[].concat(e["*"]||[],e[m]||[]);for(const d of f)g_(d,p)||l.removeAttribute(d.nodeName)}return i.body.innerHTML}const y_="TemplateFactory",$_={allowList:pi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},w_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},k_={entry:"(string|element|function|null)",selector:"(string|element)"};class E_ extends Vt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return $_}static get DefaultType(){return w_}static get NAME(){return y_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},k_)}_setContent(e,t,o){const i=se.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(qe(t)){this._putElementInTemplate(Qe(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?b_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ee(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const S_="tooltip",C_=new Set(["sanitize","allowList","sanitizeFn"]),Ds="fade",T_="modal",Qt="show",x_=".tooltip-inner",Zn=`.${T_}`,eo="hide.bs.modal",jt="hover",Ns="focus",Ls="click",A_="manual",O_="hide",M_="hidden",D_="show",N_="shown",L_="inserted",j_="click",I_="focusin",P_="focusout",R_="mouseenter",W_="mouseleave",H_={AUTO:"auto",TOP:"top",RIGHT:De()?"left":"right",BOTTOM:"bottom",LEFT:De()?"right":"left"},B_={allowList:pi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},F_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Nt extends Be{constructor(e,t){if(typeof Ho>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return B_}static get DefaultType(){return F_}static get NAME(){return S_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),G.off(this._element.closest(Zn),eo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=G.trigger(this._element,this.constructor.eventName(D_)),o=(Vo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),G.trigger(this._element,this.constructor.eventName(L_))),this._popper=this._createPopper(i),i.classList.add(Qt),"ontouchstart"in document.documentElement)for(const m of[].concat(...document.body.children))G.on(m,"mouseover",is);const l=()=>{G.trigger(this._element,this.constructor.eventName(N_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||G.trigger(this._element,this.constructor.eventName(O_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Qt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))G.off(i,"mouseover",is);this._activeTrigger[Ls]=!1,this._activeTrigger[Ns]=!1,this._activeTrigger[jt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),G.trigger(this._element,this.constructor.eventName(M_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ds,Qt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Af(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ds),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new E_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[x_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ds)}_isShown(){return this.tip&&this.tip.classList.contains(Qt)}_createPopper(e){const t=Ee(this._config.placement,[this,e,this._element]),o=H_[t.toUpperCase()];return tn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Ee(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Ee(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")G.on(this._element,this.constructor.eventName(j_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ls]=!(i._isShown()&&i._activeTrigger[Ls]),i.toggle()});else if(t!==A_){const o=t===jt?this.constructor.eventName(R_):this.constructor.eventName(I_),i=t===jt?this.constructor.eventName(W_):this.constructor.eventName(P_);G.on(this._element,o,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusin"?Ns:jt]=!0,l._enter()}),G.on(this._element,i,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusout"?Ns:jt]=l._element.contains(a.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},G.on(this._element.closest(Zn),eo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=ze.getDataAttributes(this._element);for(const o of Object.keys(t))C_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Qe(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Nt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}je(Nt);const V_="popover",U_=".popover-header",q_=".popover-body",z_={...Nt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},K_={...Nt.DefaultType,content:"(null|string|element|function)"};class an extends Nt{static get Default(){return z_}static get DefaultType(){return K_}static get NAME(){return V_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[U_]:this._getTitle(),[q_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=an.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}je(an);const G_="scrollspy",Y_="bs.scrollspy",rn=`.${Y_}`,J_=".data-api",Q_=`activate${rn}`,to=`click${rn}`,X_=`load${rn}${J_}`,Z_="dropdown-item",ht="active",eg='[data-bs-spy="scroll"]',js="[href]",tg=".nav, .list-group",so=".nav-link",sg=".nav-item",ng=".list-group-item",og=`${so}, ${sg} > ${so}, ${ng}`,ig=".dropdown",ag=".dropdown-toggle",rg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},lg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class fs extends Be{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return rg}static get DefaultType(){return lg}static get NAME(){return G_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Qe(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(G.off(this._config.target,to),G.on(this._config.target,to,js,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(t(l))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(l));continue}const m=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&m){if(o(l),!i)return;continue}!a&&!m&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=se.find(js,this._config.target);for(const t of e){if(!t.hash||Xe(t))continue;const o=se.findOne(decodeURI(t.hash),this._element);Mt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ht),this._activateParents(e),G.trigger(this._element,Q_,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Z_)){se.findOne(ag,e.closest(ig)).classList.add(ht);return}for(const t of se.parents(e,tg))for(const o of se.prev(t,og))o.classList.add(ht)}_clearActiveClass(e){e.classList.remove(ht);const t=se.find(`${js}.${ht}`,e);for(const o of t)o.classList.remove(ht)}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}G.on(window,X_,()=>{for(const n of se.find(eg))fs.getOrCreateInstance(n)});je(fs);const cg="tab",ug="bs.tab",ft=`.${ug}`,dg=`hide${ft}`,mg=`hidden${ft}`,pg=`show${ft}`,fg=`shown${ft}`,vg=`click${ft}`,hg=`keydown${ft}`,_g=`load${ft}`,gg="ArrowLeft",no="ArrowRight",bg="ArrowUp",oo="ArrowDown",Is="Home",io="End",it="active",ao="fade",Ps="show",yg="dropdown",fi=".dropdown-toggle",$g=".dropdown-menu",Rs=`:not(${fi})`,wg='.list-group, .nav, [role="tablist"]',kg=".nav-item, .list-group-item",Eg=`.nav-link${Rs}, .list-group-item${Rs}, [role="tab"]${Rs}`,vi='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ws=`${Eg}, ${vi}`,Sg=`.${it}[data-bs-toggle="tab"], .${it}[data-bs-toggle="pill"], .${it}[data-bs-toggle="list"]`;class At extends Be{constructor(e){super(e),this._parent=this._element.closest(wg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),G.on(this._element,hg,t=>this._keydown(t)))}static get NAME(){return cg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?G.trigger(t,dg,{relatedTarget:e}):null;G.trigger(e,pg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(it),this._activate(se.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ps);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),G.trigger(e,fg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(ao))}_deactivate(e,t){if(!e)return;e.classList.remove(it),e.blur(),this._deactivate(se.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ps);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),G.trigger(e,mg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(ao))}_keydown(e){if(![gg,no,bg,oo,Is,io].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Xe(i));let o;if([Is,io].includes(e.key))o=t[e.key===Is?0:t.length-1];else{const i=[no,oo].includes(e.key);o=sn(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),At.getOrCreateInstance(o).show())}_getChildren(){return se.find(Ws,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=se.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(yg))return;const i=(a,l)=>{const m=se.findOne(a,o);m&&m.classList.toggle(l,t)};i(fi,it),i($g,Ps),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(it)}_getInnerElement(e){return e.matches(Ws)?e:se.findOne(Ws,e)}_getOuterElement(e){return e.closest(kg)||e}static jQueryInterface(e){return this.each(function(){const t=At.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}G.on(document,vg,vi,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Xe(this)&&At.getOrCreateInstance(this).show()});G.on(window,_g,()=>{for(const n of se.find(Sg))At.getOrCreateInstance(n)});je(At);const Cg="toast",Tg="bs.toast",nt=`.${Tg}`,xg=`mouseover${nt}`,Ag=`mouseout${nt}`,Og=`focusin${nt}`,Mg=`focusout${nt}`,Dg=`hide${nt}`,Ng=`hidden${nt}`,Lg=`show${nt}`,jg=`shown${nt}`,Ig="fade",ro="hide",Xt="show",Zt="showing",Pg={animation:"boolean",autohide:"boolean",delay:"number"},Rg={animation:!0,autohide:!0,delay:5e3};class vs extends Be{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Rg}static get DefaultType(){return Pg}static get NAME(){return Cg}show(){if(G.trigger(this._element,Lg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Ig);const t=()=>{this._element.classList.remove(Zt),G.trigger(this._element,jg),this._maybeScheduleHide()};this._element.classList.remove(ro),Ft(this._element),this._element.classList.add(Xt,Zt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||G.trigger(this._element,Dg).defaultPrevented)return;const t=()=>{this._element.classList.add(ro),this._element.classList.remove(Zt,Xt),G.trigger(this._element,Ng)};this._element.classList.add(Zt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Xt),super.dispose()}isShown(){return this._element.classList.contains(Xt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){G.on(this._element,xg,e=>this._onInteraction(e,!0)),G.on(this._element,Ag,e=>this._onInteraction(e,!1)),G.on(this._element,Og,e=>this._onInteraction(e,!0)),G.on(this._element,Mg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ds(vs);je(vs);const Wg={class:"message-content-column"},Hg=["id"],Bg={class:"accordion-item"},Fg=["id"],Vg=["aria-controls"],Ug={class:"d-flex align-items-center w-100"},qg={class:"badge bg-warning text-dark ms-auto me-2"},zg={class:"text-muted"},Kg=["id","aria-labelledby"],Gg={class:"accordion-body bg-light"},Yg={class:"alert alert-warning mb-3",role:"alert"},Jg={class:"compaction-metadata"},Qg={class:"metadata-row"},Xg={class:"metadata-row"},Zg={key:0,class:"metadata-row"},eb={class:"continuation-content"},tb={class:"continuation-text border rounded p-3 bg-white"},sb={class:"mb-0"},nb={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=v(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=v(()=>`heading-${t.value}`),i=v(()=>`collapse-${t.value}`),a=R(null);let l=null;ye(()=>{a.value&&(l=new xt(a.value,{toggle:!1}))}),_i(()=>{l&&l.dispose()});function m(){l&&l.toggle()}const f=v(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),p=v(()=>f.value?e.messages[3]:e.messages[2]),d=v(()=>p.value?.metadata?.init_data?.compact_metadata||{}),k=v(()=>d.value.pre_tokens||0),_=v(()=>f.value?e.messages[4]:e.messages[3]),w=v(()=>_.value?.content||""),b=v(()=>{const u=e.messages[0]?.timestamp;return u?Ht(u):""});function g(u){return u?`${u.toLocaleString()} tokens`:"0 tokens"}return(u,y)=>(r(),c("div",{class:"message-row message-row-compaction",key:t.value},[y[7]||(y[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Wg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Bg,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:m},[s("div",Ug,[y[0]||(y[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),y[1]||(y[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",qg,$(g(k.value)),1),s("small",zg,$(b.value),1)])],8,Vg)],8,Fg),s("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Gg,[s("div",Yg,[y[5]||(y[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ee(" Compaction Details ")],-1)),s("div",Jg,[s("div",Qg,[y[2]||(y[2]=s("strong",null,"Trigger:",-1)),s("span",null,$(d.value.trigger||"auto"),1)]),s("div",Xg,[y[3]||(y[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,$(g(k.value)),1)]),d.value.post_tokens?(r(),c("div",Zg,[y[4]||(y[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,$(g(d.value.post_tokens)),1)])):x("",!0)])]),s("div",eb,[y[6]||(y[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ee(" Continuation Message ")],-1)),s("div",tb,[s("pre",sb,$(w.value),1)])])])],8,Kg)])],8,Hg)])]))}},ob=Z(nb,[["__scopeId","data-v-e0b95ba8"]]),ib={key:0,class:"text-muted text-center py-5"},ab={__name:"MessageList",setup(n){const e=Ce(),t=ve(),o=R(null),i=v(()=>{const d=e.currentMessages,k=[];let _=0;for(;_<d.length;){const w=d[_];if(l(w,d,_)){const b=d[_+2],u=b?.type==="system"&&b?.metadata?.subtype==="init"?5:4,y=d.slice(_,_+u);k.push({type:"compaction",messages:y}),_+=u;continue}f(w)&&k.push({type:"message",message:w,attachedTools:[]}),_++}return a(k)});function a(d){const k=new Map,_=new Set;for(let b=0;b<d.length;b++){const g=d[b];if(g.type==="compaction")continue;const u=g.message,y=u.content&&u.content.trim().length>0&&u.content!=="Assistant response",h=u.type==="assistant"&&u.metadata?.has_tool_uses&&u.metadata?.tool_uses?.length>0;if(u.type==="assistant"&&h&&!y){let S=-1,E=!1;for(let I=b-1;I>=0;I--){const N=d[I];if(!_.has(I)){if(N.type==="message"&&N.message.type!=="assistant"){E=!0;break}if(N.type==="message"&&N.message.type==="assistant"){const A=N.message;if(A.content&&A.content.trim().length>0&&A.content!=="Assistant response"){S=I;break}else{S=I;break}}}}E&&S===-1||(E&&S>=0?(k.has(S)||k.set(S,[]),k.get(S).push(...u.metadata.tool_uses),_.add(b)):!E&&S>=0&&(k.has(S)||k.set(S,[]),k.get(S).push(...u.metadata.tool_uses),_.add(b)))}}const w=[];for(let b=0;b<d.length;b++){if(_.has(b))continue;const g=d[b];k.has(b)&&(g.attachedTools=[...g.attachedTools||[],...k.get(b)]),w.push(g)}return w}function l(d,k,_){if(_+3>=k.length)return!1;const w=k[_],b=k[_+1];let g=k[_+2],u=k[_+3],y=k[_+4];const h=w.type==="system"&&w.metadata?.subtype==="status"&&w.metadata?.init_data?.status==="compacting",S=b.type==="system"&&b.metadata?.subtype==="status"&&(b.metadata?.init_data?.status===null||b.metadata?.init_data?.status===void 0);if(g?.type==="system"&&g?.metadata?.subtype==="init"){if(_+4>=k.length)return!1;const I=!0,N=u?.type==="system"&&u?.metadata?.subtype==="compact_boundary",A=y?.type==="user"&&y?.content?.startsWith("This session is being continued from a previous conversation");return w.type==="system"&&w.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",_),console.log("  Msg1 (compacting):",h),console.log("  Msg2 (null status):",S),console.log("  Msg3 (init):",I),console.log("  Msg4 (boundary):",N),console.log("  Msg5 (continuation):",A)),h&&S&&I&&N&&A}else{const I=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",N=u?.type==="user"&&u?.content?.startsWith("This session is being continued from a previous conversation");return w.type==="system"&&w.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",_),console.log("  Msg1 (compacting):",h),console.log("  Msg2 (null status):",S),console.log("  Msg3 (boundary):",I),console.log("  Msg4 (continuation):",N)),h&&S&&I&&N}}async function m(){t.autoScrollEnabled&&(await $t(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>i.value.length,m),fe(()=>e.currentToolCalls.length,m),fe(()=>e.currentToolCalls.map(d=>`${d.id}-${d.status}`).join(","),m),ye(()=>{setTimeout(()=>{m()},100)});function f(d){const k=d.subtype||d.metadata?.subtype;if(d.type==="system"&&k==="init"||d.type==="result"||d.type==="permission_request"||d.type==="permission_response")return!1;if(d.type==="user"&&d.metadata?.has_tool_results){const _=d.content||"";if(_.match(/^Tool results?: \d+ results?$/i)||_.trim()==="")return!1}if(d.type==="user"){const _=d.content||"";if(_.includes("<command-message>")&&_.includes("skill is running")||_.startsWith("Base directory for this skill:"))return!1}if(d.type==="user"){const _=d.content||"";if(_.includes("<command-message>")&&_.includes("<command-name>")&&_.includes("<command-args>")||_.includes("ARGUMENTS:")&&(_.includes("<command-name>")||_.match(/\nARGUMENTS:/)))return!1}return!0}function p(d){return{type:d.type||"unknown",content:d.content||"",timestamp:d.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...d.metadata}}}return(d,k)=>(r(),c("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(r(),c("div",ib," No messages yet. Start a conversation! ")):x("",!0),(r(!0),c(ne,null,le(i.value,(_,w)=>(r(),c(ne,{key:`item-${w}`},[_.type==="message"?(r(),be(Bp,{key:0,message:p(_.message),attachedTools:_.attachedTools||[]},null,8,["message","attachedTools"])):_.type==="compaction"?(r(),be(ob,{key:1,messages:_.messages},null,8,["messages"])):x("",!0)],64))),128))],512))}},rb=Z(ab,[["__scopeId","data-v-6bae0fb1"]]),lb={class:"border-top bg-light"},cb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},ub={class:"d-flex gap-2 align-items-end px-2 py-1"},db=["placeholder","disabled"],mb=["disabled"],pb={__name:"InputArea",setup(n){const e=de(),t=et(),o=R(null),i=R(window.innerWidth),a=v({get:()=>e.currentInput,set:u=>{e.currentInput=u}}),l=v(()=>e.currentSession?.is_processing||!1),m=v(()=>t.sessionConnected),f=v(()=>e.currentSession?.state==="starting"),p=v(()=>i.value<768),d=v(()=>f.value?"Session is starting...":m.value?"Type your message to Claude Code...":"Waiting for connection...");function k(){i.value=window.innerWidth}ye(()=>{window.addEventListener("resize",k)}),Se(()=>{window.removeEventListener("resize",k)});function _(u){if(u.key==="Enter"&&!u.shiftKey){if(p.value)return;u.preventDefault(),b()}}function w(){const u=o.value;if(!u)return;u.style.height="auto";const y=Math.min(u.scrollHeight,parseInt(getComputedStyle(u).maxHeight));u.style.height=y+"px"}function b(){a.value.trim()&&(t.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function g(){t.interruptSession()}return(u,y)=>(r(),c("div",lb,[m.value?x("",!0):(r(),c("div",cb,[...y[1]||(y[1]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",ub,[ge(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":y[0]||(y[0]=h=>a.value=h),class:"form-control",placeholder:d.value,disabled:f.value||!m.value,rows:"1",onInput:w,onKeydown:_},null,40,db),[[He,a.value]]),l.value?(r(),c("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:g}," Stop ")):(r(),c("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!m.value||f.value,onClick:b}," Send ",8,mb))])]))}},fb=Z(pb,[["__scopeId","data-v-ef1e5094"]]),vb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},hb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},_b={class:"text-secondary"},gb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},bb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=ve(),i=v(()=>t.currentSession),a=v(()=>o.isLoading),l=v(()=>o.loadingMessage);return ye(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(m,f)=>{if(m!==f&&m!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(m)}finally{o.hideLoading()}}}),Se(()=>{}),(m,f)=>(r(),c("div",vb,[a.value?(r(),c("div",hb,[f[0]||(f[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",_b,$(l.value),1)])):x("",!0),i.value?(r(),be(Fi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):x("",!0),s("div",gb,[pe(rb)]),pe(fb),i.value?(r(),be(Ki,{key:2,"session-id":e.sessionId},null,8,["session-id"])):x("",!0),i.value?(r(),be(sa,{key:3,"session-id":e.sessionId},null,8,["session-id"])):x("",!0)]))}},hs=mt("legion",()=>{const n=R(new Map),e=R(new Map),t=R(null),o=v(()=>n.value.get(t.value)||[]),i=v(()=>e.value.get(t.value)||[]);function a(b){t.value=b}async function l(b,g=100,u=0){try{const y=await ue.get(`/api/legions/${b}/timeline?limit=${g}&offset=${u}`),h=y.comms||[],S=y.total_count||h.length,E=y.has_more||!1;return h.sort((I,N)=>new Date(I.timestamp)-new Date(N.timestamp)),console.log(`Loaded ${h.length} of ${S} comms for legion ${b}`),n.value.set(b,h),n.value=new Map(n.value),{comms:h,totalCount:S,hasMore:E}}catch(y){throw console.error("Failed to load timeline:",y),y}}function m(b,g){n.value.has(b)||n.value.set(b,[]);const u=n.value.get(b);if(u.some(h=>h.comm_id===g.comm_id)){console.log(`Duplicate comm ${g.comm_id} prevented in timeline`);return}u.push(g),n.value=new Map(n.value)}async function f(b,g){try{const y=(await ue.post(`/api/legions/${b}/comms`,g)).comm;return console.log(`Sent comm ${y.comm_id} to legion ${b}`),y}catch(u){throw console.error("Failed to send comm:",u),u}}async function p(b){return console.log(`Minions for legion ${b} are already available in session store`),[]}async function d(b,g){try{const y=(await ue.post(`/api/legions/${b}/minions`,g)).minion;return await p(b),console.log(`Created minion ${y.minion_id} in legion ${b}`),y}catch(u){throw console.error("Failed to create minion:",u),u}}async function k(b){try{const g=await ue.post(`/api/legions/${b}/halt-all`);return console.log(`Halted ${g.halted_count} of ${g.total_minions} minions in legion ${b}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to halt some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to halt all minions:",g),g}}async function _(b){try{const g=await ue.post(`/api/legions/${b}/resume-all`);return console.log(`Resumed ${g.resumed_count} of ${g.total_minions} minions in legion ${b}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to resume some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to resume all minions:",g),g}}function w(b){n.value.delete(b),e.value.delete(b),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:l,addComm:m,sendComm:f,loadMinions:p,createMinion:d,haltAll:k,resumeAll:_,clearLegionData:w}}),yb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:hs},Symbol.toStringTag,{value:"Module"})),$b={class:"timeline-header border-bottom p-3"},wb={class:"project-name"},kb=["title"],Eb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Le(),o=v(()=>t.projects.get(e.legionId)),i=v(()=>o.value?.name||"Legion");return(a,l)=>(r(),c("div",$b,[s("div",null,[s("div",wb,$(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,kb)])]))}},Sb=Z(Eb,[["__scopeId","data-v-44f386f5"]]),Cb={class:"timeline-status-bar border-top p-2 bg-light"},Tb={class:"d-flex justify-content-end"},xb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ve();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(r(),c("div",Cb,[s("div",Tb,[s("button",{class:X(["btn btn-sm",ns(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+$(ns(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Ab=Z(xb,[["__scopeId","data-v-891c73db"]]),Ob={class:"comm-composer border-top p-3"},Mb={key:0,class:"d-flex gap-2 mb-2"},Db={class:"flex-grow-1"},Nb=["disabled"],Lb={label:"Minions"},jb=["value"],Ib={style:{"min-width":"150px"}},Pb=["disabled"],Rb={class:"d-flex gap-2 align-items-end position-relative"},Wb={class:"flex-grow-1 position-relative"},Hb=["disabled"],Bb=["onClick","onMouseenter"],Fb=["disabled"],Vb={key:0},Ub={key:1},qb={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=hs(),o=de(),i=Le(),a=R(""),l=R("task"),m=R(""),f=R(!1),p=R(window.innerWidth),d=R(!1),k=R([]),_=R(0),w=R(-1),b=R(null),g=R(null),u=v(()=>p.value<768),y=v(()=>{const q=i.projects.get(e.legionId);return!q||!q.session_ids?[]:q.session_ids.map(W=>o.sessions.get(W)).filter(W=>W)}),h=v(()=>a.value&&m.value.trim().length>0);function S(q){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[q.state]||"â—‹"}function E(q){return q.role?`${q.name} (${q.role})`:q.name}function I(){const q=b.value;if(!q)return;q.style.height="auto";const W=Math.min(q.scrollHeight,parseInt(getComputedStyle(q).maxHeight));q.style.height=W+"px"}function N(){const q=b.value;if(!q)return;I();const W=m.value,H=q.selectionStart,F=W.substring(0,H),O=F.lastIndexOf("#");if(O===-1){d.value=!1;return}const M=F.substring(O+1).toLowerCase();if(M.includes(" ")){d.value=!1;return}const K=y.value.filter(L=>L.name.toLowerCase().includes(M)).map(L=>({type:"minion",name:L.name,role:L.role,id:L.session_id,state:L.state}));if(K.length===0){d.value=!1;return}k.value=K,_.value=0,w.value=O,d.value=!0}function A(){if(!g.value)return;const q=g.value,W=q.children[_.value];if(!W)return;const H=W.offsetTop,F=W.offsetHeight,O=q.scrollTop,M=q.clientHeight;H<O?q.scrollTop=H:H+F>O+M&&(q.scrollTop=H+F-M)}function P(q){if(!d.value){if(q.key==="Enter"&&!q.shiftKey){if(u.value)return;h.value&&(q.preventDefault(),T())}return}if(q.key==="ArrowDown")q.preventDefault(),_.value=(_.value+1)%k.value.length,A();else if(q.key==="ArrowUp")q.preventDefault(),_.value=_.value===0?k.value.length-1:_.value-1,A();else if(q.key==="Enter"){q.preventDefault();const W=k.value[_.value];W&&C(W)}else q.key==="Escape"&&(d.value=!1)}function C(q){const W=b.value;if(!W)return;const H=m.value,F=W.selectionStart,O=H.substring(0,w.value)+"#"+q.name+" "+H.substring(F);m.value=O;const M=w.value+q.name.length+2;setTimeout(()=>{W.setSelectionRange(M,M),W.focus()},0),d.value=!1}async function T(){if(!(!h.value||f.value)){f.value=!0;try{const[q,W]=a.value.split(":"),H={comm_type:l.value,content:m.value.trim()};q==="minion"&&(H.to_minion_id=W),await t.sendComm(e.legionId,H),m.value="",I()}catch(q){console.error("Failed to send comm:",q),alert(`Failed to send comm: ${q.message}`)}finally{f.value=!1}}}function U(){p.value=window.innerWidth}return ye(()=>{window.addEventListener("resize",U)}),Se(()=>{window.removeEventListener("resize",U)}),fe(d,q=>{if(q){const W=H=>{H.target.closest(".comm-composer")||(d.value=!1,document.removeEventListener("click",W))};setTimeout(()=>document.addEventListener("click",W),0)}}),(q,W)=>(r(),c("div",Ob,[n.hideRecipientSelector?x("",!0):(r(),c("div",Mb,[s("div",Db,[ge(s("select",{"onUpdate:modelValue":W[0]||(W[0]=H=>a.value=H),class:"form-select form-select-sm",disabled:f.value},[W[3]||(W[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Lb,[(r(!0),c(ne,null,le(y.value,H=>(r(),c("option",{key:H.session_id,value:`minion:${H.session_id}`},$(S(H))+" "+$(E(H)),9,jb))),128))])],8,Nb),[[vn,a.value]])]),s("div",Ib,[ge(s("select",{"onUpdate:modelValue":W[1]||(W[1]=H=>l.value=H),class:"form-select form-select-sm",disabled:f.value},[...W[4]||(W[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Pb),[[vn,l.value]])])])),s("div",Rb,[s("div",Wb,[ge(s("textarea",{ref_key:"contentTextarea",ref:b,"onUpdate:modelValue":W[2]||(W[2]=H=>m.value=H),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:f.value,onInput:N,onKeydown:P},null,40,Hb),[[He,m.value]]),d.value?(r(),c("div",{key:0,ref_key:"autocompleteDropdown",ref:g,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(r(!0),c(ne,null,le(k.value,(H,F)=>(r(),c("div",{key:H.id,class:X(["autocomplete-item px-2 py-1",{"bg-light":F===_.value}]),onClick:O=>C(H),onMouseenter:O=>_.value=F},$(H.type==="minion"?S(H):"#ï¸âƒ£")+" "+$(H.name)+$(H.role?` (${H.role})`:""),43,Bb))),128))],512)):x("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!h.value||f.value,onClick:T},[f.value?(r(),c("span",Vb,[...W[5]||(W[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ee(" Sending... ",-1)])])):(r(),c("span",Ub,"Send"))],8,Fb)])])]))}},zb=Z(qb,[["__scopeId","data-v-e52b8e8f"]]),Kb={class:"message-content-column-full"},Gb=["aria-expanded"],Yb={class:"comm-sender-recipient"},Jb={class:"comm-badge-summary"},Qb=["title"],Xb={class:"comm-summary-text text-muted ms-2"},Zb=["aria-label"],ey={key:0,class:"comm-content-body"},ty=["innerHTML"],sy="ffffffff-ffff-ffff-ffff-ffffffffffff",ny={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;lt.setOptions({breaks:!0,gfm:!0});const t=R(!1);function o(){t.value=!t.value}const i=v(()=>e.comm.from_minion_id===sy),a=v(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),l=v(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),m=v(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),f=v(()=>{const p=e.comm.content||"";let d=lt.parse(p);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),ls.sanitize(d)});return(p,d)=>(r(),c("div",{class:X(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",Kb,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",Yb,[s("strong",{class:X({"system-sender":i.value})},$(n.senderName),3),n.recipientName?(r(),c(ne,{key:0},[d[0]||(d[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,$(n.recipientName),1)],64)):x("",!0)]),s("div",Jb,[s("span",{class:X(["badge",l.value]),title:a.value},$(n.comm.comm_type),11,Qb),s("span",Xb,$(m.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},$(t.value?"â–¾":"â–¸"),9,Zb)],8,Gb),t.value?(r(),c("div",ey,[s("div",{class:"message-text",innerHTML:f.value},null,8,ty)])):x("",!0)])],2))}},oy=Z(ny,[["__scopeId","data-v-28513f64"]]),iy={class:"timeline-view d-flex flex-column h-100"},ay={key:0,class:"text-center text-muted"},ry={key:1,class:"text-center text-danger"},ly={key:2,class:"text-center text-muted"},cy={key:3,class:"comm-list"},uy={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=hs();Le();const o=de(),i=et(),a=ve(),l=R(!0),m=R(null),f=R(null),p=v(()=>t.currentComms);function d(u){return u.from_user?"You":u.from_minion_id?u.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(u.from_minion_id)?.name||"Unknown":"Unknown"}function k(u){return u.to_user?"You":u.to_minion_id?o.sessions.get(u.to_minion_id)?.name||"Unknown":"All"}async function _(){a.autoScrollEnabled&&(await $t(),f.value&&(f.value.scrollTop=f.value.scrollHeight))}async function w(){l.value=!0,m.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await $t(),await _(),setTimeout(()=>{_()},100)}catch(u){console.error("Failed to load timeline:",u),u.response?m.value=`${u.message} (${u.response.status})`:m.value=u.message||"Unknown error"}finally{l.value=!1}}function b(){i.connectLegion(e.legionId)}function g(){i.disconnectLegion()}return fe(()=>p.value.length,()=>{_()}),ye(()=>{o.currentSessionId=null,w(),b(),setTimeout(()=>{_()},100)}),Se(()=>{g()}),(u,y)=>(r(),c("div",iy,[pe(Sb,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:f,class:"timeline-messages flex-grow-1 overflow-auto"},[l.value?(r(),c("div",ay,[...y[0]||(y[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ee(" Loading timeline... ",-1)])])):m.value?(r(),c("div",ry," Failed to load timeline: "+$(m.value),1)):p.value.length===0?(r(),c("div",ly," No messages yet. Minions will appear here once they start communicating. ")):(r(),c("div",cy,[(r(!0),c(ne,null,le(p.value,h=>(r(),be(oy,{key:h.comm_id,comm:h,"sender-name":d(h),"recipient-name":k(h)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),pe(zb,{"legion-id":n.legionId},null,8,["legion-id"]),pe(Ab,{"legion-id":n.legionId},null,8,["legion-id"])]))}},dy=Z(uy,[["__scopeId","data-v-b6752179"]]),my={class:"minion-info flex-grow-1"},py={class:"minion-name"},fy={key:0,class:"me-1"},vy={key:1,class:"badge bg-secondary ms-2"},hy={key:0,class:"latest-activity text-muted"},_y={key:0,class:"activity-prefix"},gy=["title"],by={key:1,class:"activity-time ms-1"},yy={key:1,class:"latest-activity text-muted"},$y={class:"activity-prefix"},wy=["title"],ky={key:2,class:"latest-activity text-muted fst-italic small"},Ey={class:"node-row"},Sy={class:"node-left"},Cy={key:0,class:"me-2"},Ty={key:1,class:"badge bg-secondary ms-2"},xy={class:"node-right"},Ay={key:0,class:"latest-message-preview"},Oy={key:0,class:"message-prefix"},My=["title"],Dy={key:1,class:"message-time ms-1"},Ny={key:1,class:"last-comm-preview"},Ly={class:"comm-direction"},jy=["title"],Iy={key:2,class:"text-muted fst-italic small"},Py={class:"node-actions"},Ry={key:2,class:"minion-children"},Wy={key:1,class:"text-danger small ms-4"},Hy={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=de(),a=Ce(),l=ve(),m=v(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),f=v(()=>{if(!t.minionData||!t.minionData.id)return null;const C=a.messagesBySession.get(t.minionData.id);if(!C||C.length===0)return null;for(let T=C.length-1;T>=0;T--){const U=C[T];if(U.type!=="result"&&!(U.type==="user"&&U.content&&U.content.startsWith("Tool results:"))&&!(U.type==="system"&&U.content==="System message")&&!(U.type==="assistant"&&U.content==="Assistant response")&&(U.type==="user"||U.type==="assistant"||U.type==="system"))return{content:U.content,type:U.type,timestamp:U.timestamp}}return null}),p=v(()=>{if(!t.minionData)return null;const C={...t.minionData};return m.value&&(C.state=m.value.state,C.is_processing=m.value.is_processing,m.value.name&&(C.name=m.value.name),m.value.latest_message&&(C.latest_message=m.value.latest_message,C.latest_message_type=m.value.latest_message_type,C.latest_message_time=m.value.latest_message_time)),f.value&&(C.latest_message=f.value.content,C.latest_message_type=f.value.type,C.latest_message_time=f.value.timestamp),C}),d=v(()=>t.level*24),k=v(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),_=v(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),w=v(()=>t.minionData&&t.minionData.is_overseer&&_.value),b=v(()=>{const C=p.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),g=v(()=>{const C=b.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),u=v(()=>{const C=b.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),y=v(()=>{const C=p.value;if(!C||!C.latest_message_type)return"";const T=C.latest_message_type;return T==="user"?"User -->:":T==="system"?"System:":""}),h=v(()=>{const C=p.value;if(!C||!C.latest_message)return"";const T=C.latest_message,U=150;return T.length>U?T.slice(0,U)+"...":T}),S=v(()=>{const C=p.value;if(!C||!C.latest_message_time)return"";try{const T=Date.now();let U;if(typeof C.latest_message_time=="number"?U=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:U=new Date(C.latest_message_time).getTime(),isNaN(U)||U<9466848e5||U>T+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",U),"";const q=T-U;if(q<0)return"just now";const W=Math.floor(q/6e4),H=Math.floor(W/60),F=Math.floor(H/24);return F>0?`${F}d ago`:H>0?`${H}h ago`:W>0?`${W}m ago`:"just now"}catch(T){return console.error("Error calculating relative time:",T,C.latest_message_time),""}});function E(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function I(C){const T=C.summary||C.content||"";return T.length>150?T.substring(0,150)+"...":T}function N(){o("minion-click",t.minionData.id)}function A(){const C=i.sessions.get(t.minionData.id);C&&l.showModal("edit-session",{session:C})}function P(){const C=i.sessions.get(t.minionData.id);C&&l.showModal("manage-session",{session:C})}return(C,T)=>{const U=co("MinionTreeNode",!0);return n.minionData?(r(),c("div",{key:0,class:"minion-tree-node",style:at({marginLeft:`${d.value}px`})},[n.layout==="sidebar"?(r(),c("div",{key:0,class:X(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:k.value}]),onClick:N},[s("div",{class:X(["status-dot me-2",g.value]),style:at(u.value)},null,6),s("div",my,[s("div",py,[w.value?(r(),c("span",fy,"ðŸ‘‘")):x("",!0),s("strong",null,$(p.value?.name||n.minionData.name),1),w.value?(r(),c("span",vy,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):x("",!0)]),p.value?.latest_message?(r(),c("div",hy,[y.value?(r(),c("span",_y,$(y.value),1)):x("",!0),s("span",{class:"activity-content",title:p.value.latest_message},$(h.value),9,gy),S.value?(r(),c("span",by,"("+$(S.value)+")",1)):x("",!0)])):n.minionData?.last_comm?(r(),c("div",yy,[s("span",$y,[T[1]||(T[1]=ee("â†’ ",-1)),s("strong",null,$(E(n.minionData.last_comm)),1),T[2]||(T[2]=ee(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},$(I(n.minionData.last_comm)),9,wy)])):(r(),c("div",ky," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(A,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(P,["stop"])}," âš™ï¸ ")],2)):(r(),c("div",{key:1,class:X(["minion-card minion-card-clickable border-start border-2 mb-2",{active:k.value}]),onClick:N},[s("div",Ey,[s("div",Sy,[s("div",{class:X(["status-dot me-2",g.value]),style:at(u.value)},null,6),w.value?(r(),c("span",Cy,"ðŸ‘‘")):x("",!0),s("strong",null,$(p.value?.name||n.minionData.name),1),w.value?(r(),c("span",Ty,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):x("",!0)]),s("div",xy,[p.value?.latest_message?(r(),c("div",Ay,[y.value?(r(),c("span",Oy,$(y.value),1)):x("",!0),s("span",{class:"message-content",title:p.value.latest_message},$(h.value),9,My),S.value?(r(),c("span",Dy,"("+$(S.value)+")",1)):x("",!0)])):n.minionData?.last_comm?(r(),c("div",Ny,[s("span",Ly,[T[3]||(T[3]=ee("â†’ ",-1)),s("strong",null,$(E(n.minionData.last_comm)),1),T[4]||(T[4]=ee(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},$(I(n.minionData.last_comm)),9,jy)])):(r(),c("div",Iy," No activity yet "))]),s("div",Py,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(A,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(P,["stop"])}," âš™ï¸ ")])])],2)),_.value?(r(),c("div",Ry,[(r(!0),c(ne,null,le(n.minionData.children,q=>(r(),be(U,{key:q.id,"minion-data":q,level:n.level+1,layout:n.layout,onMinionClick:T[0]||(T[0]=W=>C.$emit("minion-click",W))},null,8,["minion-data","level","layout"]))),128))])):x("",!0)],4)):(r(),c("div",Wy," âš  Minion data is missing "))}}},hi=Z(Hy,[["__scopeId","data-v-5dae8a96"]]),By={class:"project-overview d-flex flex-column h-100"},Fy={class:"project-overview-header border-bottom p-3"},Vy={class:"d-flex align-items-center justify-content-between"},Uy={class:"mb-1"},qy={key:0,class:"me-2"},zy={class:"text-muted font-monospace"},Ky={class:"d-flex gap-2"},Gy=["title"],Yy={class:"project-overview-content flex-grow-1 overflow-auto p-3"},Jy={key:0,class:"text-center py-5"},Qy={key:1,class:"alert alert-danger"},Xy={key:2,class:"text-center py-5"},Zy={key:3},e1={class:"row g-3 mb-4"},t1={class:"col-md-4"},s1={class:"card h-100"},n1={class:"card-body"},o1={class:"card-title mb-0"},i1={class:"text-muted"},a1={class:"col-md-4"},r1={class:"card h-100"},l1={class:"card-body"},c1={class:"card-title mb-0"},u1={class:"text-muted"},d1={key:0,class:"card mb-4"},m1={class:"card mb-4"},p1={class:"card-header d-flex align-items-center justify-content-between"},f1={class:"mb-0"},v1={class:"badge bg-secondary"},h1={class:"card-body"},_1={key:0,class:"text-center py-4"},g1={key:1,class:"text-center text-muted py-4"},b1={key:2,class:"hierarchy-tree"},y1={class:"user-root-node mb-3 border rounded bg-white"},$1={class:"node-row"},w1={class:"node-left"},k1={class:"badge bg-primary ms-2"},E1={class:"node-right"},S1={key:0,class:"last-comm-preview"},C1={class:"comm-direction"},T1=["title"],x1={key:1,class:"text-muted fst-italic"},A1={class:"root-minions ms-4"},O1={class:"card"},M1={class:"card-body"},D1={class:"row mb-0"},N1={class:"col-sm-8 font-monospace text-break"},L1={class:"col-sm-8 font-monospace text-break"},j1={class:"col-sm-8"},I1={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},P1={class:"text-muted"},R1={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Wt(),o=Le(),i=de(),a=ve(),l=hs(),m=et(),f=R(!1),p=R(null),d=R(null),k=R(!1);let _=null;const w=v(()=>o.getProject(e.projectId)),b=v(()=>w.value?.session_ids?w.value.session_ids.map(H=>i.getSession(H)).filter(H=>H!=null):[]),g=v(()=>b.value.length>0),u=v(()=>b.value.length),y=v(()=>b.value.filter(H=>H.state==="ACTIVE").length),h=v(()=>{const H=b.value.some(M=>M.state==="ACTIVE"),F=b.value.some(M=>M.is_processing);return b.value.some(M=>M.state==="ERROR")?"Error":F?"Working":H?"Active":u.value>0?"Idle":"Empty"}),S=v(()=>{switch(h.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),E=v(()=>{switch(h.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function I(){k.value=!0;try{const H=await ue.get(`/api/legions/${e.projectId}/hierarchy`);d.value=H}catch(H){console.error("Failed to load minion hierarchy:",H),d.value=null}finally{k.value=!1}}function N(H,F){if(H&&H.id===F)return H;if(H&&H.children)for(const O of H.children){const M=N(O,F);if(M)return M}return null}function A(H){return H.to_user?"User":H.to_minion_name?H.to_minion_name:"unknown"}function P(H){const F=H.summary||H.content||"";return F.length>150?F.substring(0,150)+"...":F}function C(H){if(d.value){if(H.from_minion_id){const F=N(d.value,H.from_minion_id);F&&F.type==="minion"&&(F.last_comm=H)}H.from_user&&d.value.type==="user"&&(d.value.last_comm=H)}}function T(H){t.push(`/session/${H}`)}function U(){t.push(`/timeline/${e.projectId}`)}function q(){a.showModal("edit-project",{project:w.value})}function W(){a.showModal("create-minion",{project:w.value})}return ye(()=>{o.selectProject(e.projectId),i.currentSessionId=null,I(),l.setCurrentLegion(e.projectId),m.connectLegion(e.projectId),_=fe(()=>i.sessions,H=>{if(d.value){for(const[F,O]of H)if(O.project_id===e.projectId){const M=N(d.value,F);M&&M.type==="minion"&&(M.state!==O.state&&(M.state=O.state),M.is_processing!==O.is_processing&&(M.is_processing=O.is_processing),M.latest_message!==O.latest_message&&(M.latest_message=O.latest_message,M.latest_message_type=O.latest_message_type,M.latest_message_time=O.latest_message_time))}}},{deep:!0}),fe(()=>l.commsByLegion.get(e.projectId),H=>{if(H&&H.length>0){const F=H[H.length-1];C(F)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(H,F)=>{H!==F&&I()})}),fe(()=>e.projectId,H=>{o.selectProject(H),i.currentSessionId=null,I(),l.setCurrentLegion(H),m.connectLegion(H)}),Se(()=>{_&&_()}),(H,F)=>(r(),c("div",By,[s("div",Fy,[s("div",Vy,[s("div",null,[s("h4",Uy,[g.value?(r(),c("span",qy,"ðŸ›")):x("",!0),ee(" "+$(w.value?.name||"Project Overview"),1)]),s("small",zy,$(w.value?.working_directory),1)]),s("div",Ky,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:q}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session",onClick:W}," âž• "+$(g.value?"Add Minion":"Add Session"),9,Gy)])])]),s("div",Yy,[f.value?(r(),c("div",Jy,[...F[0]||(F[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(r(),c("div",Qy,$(p.value),1)):w.value?(r(),c("div",Zy,[s("div",e1,[s("div",t1,[s("div",s1,[s("div",n1,[F[2]||(F[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",o1,$(u.value),1),s("small",i1,$(y.value)+" active",1)])])]),s("div",a1,[s("div",r1,[s("div",l1,[F[3]||(F[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",c1,[s("span",{class:X(S.value)},$(h.value),3)]),s("small",u1,$(E.value),1)])])])]),g.value?(r(),c("div",d1,[F[4]||(F[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:U}," ðŸ“Š View Timeline ")])])])):x("",!0),s("div",m1,[s("div",p1,[s("h5",f1,"ðŸŒ³ "+$(g.value?"Minion Hierarchy":"Sessions"),1),s("span",v1,$(b.value.length),1)]),s("div",h1,[k.value?(r(),c("div",_1,[...F[5]||(F[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!d.value||!d.value.children||d.value.children.length===0?(r(),c("div",g1,' No sessions yet. Click "Add Session" to create one. ')):(r(),c("div",b1,[s("div",y1,[s("div",$1,[s("div",w1,[F[6]||(F[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,$(d.value.name),1),s("span",k1,$(d.value.children.length)+" "+$(d.value.children.length===1?"minion":"minions"),1)]),s("div",E1,[d.value.last_comm?(r(),c("div",S1,[s("span",C1,[F[7]||(F[7]=ee(" â†’ ",-1)),s("strong",null,$(A(d.value.last_comm)),1),F[8]||(F[8]=ee(": ",-1))]),s("span",{class:"comm-content",title:d.value.last_comm.content||""},$(P(d.value.last_comm)),9,T1)])):(r(),c("div",x1," No communications yet "))])])]),s("div",A1,[(r(!0),c(ne,null,le(d.value.children,O=>(r(),be(hi,{key:O.id,"minion-data":O,level:1,layout:"two-column",onMinionClick:T},null,8,["minion-data"]))),128))])]))])]),s("div",O1,[F[12]||(F[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",M1,[s("dl",D1,[F[9]||(F[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",N1,$(w.value.working_directory),1),F[10]||(F[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",L1,$(w.value.project_id),1),F[11]||(F[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",j1,$(g.value?"Yes (has minions)":"No"),1)])])])])):(r(),c("div",Xy,[...F[1]||(F[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",I1,[F[13]||(F[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",P1,$(u.value)+" session"+$(u.value!==1?"s":""),1)])]))}},W1=Z(R1,[["__scopeId","data-v-168bf04c"]]),H1=[{path:"/",name:"home",component:Ti},{path:"/project/:projectId",name:"project",component:W1,props:!0},{path:"/session/:sessionId",name:"session",component:bb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:dy,props:!0}],B1=gi({history:bi(),routes:H1}),F1={class:"connection-indicators"},V1=["title"],U1=["title"],q1=["title"],z1={__name:"ConnectionIndicator",setup(n){const e=et();function t(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:m}=a[i];return m>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},m={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:f,retryCount:p}=m[i];let d="Disconnected";return f?d="Connected":p>0&&(d=`Reconnecting (attempt ${p})`),`${a[i]}
${l[i]}
Status: ${d}`}return(i,a)=>(r(),c("div",F1,[s("div",{class:X(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,V1),s("div",{class:X(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,U1),s("div",{class:X(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,q1)]))}},K1=Z(z1,[["__scopeId","data-v-d35b07c8"]]),G1={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Y1={class:"d-flex align-items-center gap-2"},J1={__name:"AppHeader",setup(n){const e=ve();function t(){e.toggleSidebar()}return(o,i)=>(r(),c("header",G1,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",Y1,[pe(K1)])]))}},Q1={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},X1={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Z1=["title"],e$={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(m){return m.state==="paused"&&m.is_processing?"pending-prompt":m.is_processing?"processing":m.state}function i(m){const f=o(m);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[f]||"#d3d3d3"}function a(m){const f=o(m);return f==="starting"||f==="processing"||f==="pending-prompt"}function l(m){const f=o(m),p=f.charAt(0).toUpperCase()+f.slice(1),d=m.name||"Unnamed Session",k=m.role?` (${m.role})`:"";return`${d}${k}: ${p}`}return(m,f)=>(r(),c("div",Q1,[!n.sessions||n.sessions.length===0?(r(),c("div",X1)):(r(!0),c(ne,{key:1},le(n.sessions,p=>(r(),c("div",{key:p.session_id,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":a(p)}]),style:at({width:t.value,backgroundColor:i(p),cursor:"help"}),title:l(p)},null,14,Z1))),128))]))}},t$=Z(e$,[["__scopeId","data-v-391d77c1"]]),s$=["data-project-id"],n$=["id"],o$=["aria-expanded","aria-controls","aria-label","onKeydown"],i$=["aria-label","onKeydown"],a$={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},r$={class:"fw-semibold",style:{"flex-shrink":"0"}},l$={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},c$={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},u$=["title"],d$=["title"],m$=["id","aria-labelledby"],p$={class:"accordion-body p-0"},f$={class:"list-group list-group-flush"},v$={class:"minion-hierarchy-container"},h$={key:0,class:"text-center py-2"},_$={key:2,class:"text-muted text-center py-2 small"},g$={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Wt(),o=Le(),i=de(),a=ve(),l=R(e.project.is_expanded||!1),m=R(null),f=R(!1);let p=null;const d=v(()=>o.formatPath(e.project.working_directory)),k=v(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(W=>i.getSession(W)).filter(W=>W!=null)),_=v(()=>k.value.length>0),w=v(()=>{const W=t.currentRoute.value;return W.name==="timeline"&&W.params.legionId===e.project.project_id}),b=v(()=>{const W=t.currentRoute.value;return W.name==="project"&&W.params.projectId===e.project.project_id});function g(W){const H=window.bootstrap;if(!H)return;const F=document.getElementById(`collapse-${e.project.project_id}`);if(!F)return;H.Collapse.getOrCreateInstance(F).toggle(),l.value=!l.value}function u(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function y(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function h(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const W=i.currentSessionId;W&&i.getSession(W)&&e.project.session_ids?.includes(W)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function S(){a.showModal("edit-project",{project:e.project})}function E(){a.showModal("create-minion",{project:e.project})}function I(){t.push(`/timeline/${e.project.project_id}`)}async function N(){f.value=!0;try{const W=await ue.get(`/api/legions/${e.project.project_id}/hierarchy`);m.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),m.value=null}finally{f.value=!1}}function A(W){t.push(`/session/${W}`)}function P(W,H){if(W&&W.id===H)return W;if(W&&W.children)for(const F of W.children){const O=P(F,H);if(O)return O}return null}fe(l,W=>{W&&N()}),ye(()=>{p=fe(()=>i.sessions,W=>{if(!(!m.value||!l.value)){for(const[H,F]of W)if(F.project_id===e.project.project_id){const O=P(m.value,H);O&&O.type==="minion"&&(O.state!==F.state&&(O.state=F.state),O.is_processing!==F.is_processing&&(O.is_processing=F.is_processing),O.latest_message!==F.latest_message&&(O.latest_message=F.latest_message,O.latest_message_type=F.latest_message_type,O.latest_message_time=F.latest_message_time))}}},{deep:!0}),fe(()=>i.sessions.size,(W,H)=>{if(l.value&&(W>H&&Array.from(i.sessions.values()).some(M=>M.project_id===e.project.project_id&&(!m.value||!P(m.value,M.session_id)))&&(console.log("New minion detected, reloading hierarchy"),N()),W<H&&m.value)){const F=i.sessions,O=M=>M.type==="minion"&&!F.has(M.id)?!0:M.children?M.children.some(K=>O(K)):!1;O(m.value)&&(console.log("Minion deletion detected, reloading hierarchy"),N())}}),l.value&&N()}),Se(()=>{p&&p()});function C(W){W.dataTransfer.effectAllowed="move",W.dataTransfer.setData("application/project-id",e.project.project_id),W.dataTransfer.setData("text/plain",e.project.project_id),W.target.classList.add("dragging")}function T(W){W.target.classList.remove("dragging")}function U(W){W.preventDefault(),W.dataTransfer.dropEffect="move";const H=W.currentTarget.getBoundingClientRect(),F=H.top+H.height/2;W.clientY<F?(W.currentTarget.classList.add("drop-above"),W.currentTarget.classList.remove("drop-below")):(W.currentTarget.classList.add("drop-below"),W.currentTarget.classList.remove("drop-above"))}function q(W){W.preventDefault(),W.currentTarget.classList.remove("drop-above","drop-below");const H=W.dataTransfer.getData("application/project-id")||W.dataTransfer.getData("text/plain");if(!H||H===e.project.project_id)return;const F=W.currentTarget.getBoundingClientRect(),O=F.top+F.height/2,M=W.clientY<O,K=o.orderedProjects,L=K.findIndex(re=>re.project_id===e.project.project_id),D=K.findIndex(re=>re.project_id===H);if(L===-1||D===-1)return;const z=[...K],[oe]=z.splice(D,1);let Y=M?L:L+1;D<L&&Y--,z.splice(Y,0,oe);const Q=z.map(re=>re.project_id);o.reorderProjects(Q)}return(W,H)=>(r(),c("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:C,onDragend:T,onDragover:U,onDrop:q},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:X(["accordion-button bg-white p-2 project-header-split",{collapsed:!l.value,"project-selected":b.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":l.value?"Collapse session list":"Expand session list",onClick:_e(g,["stop"]),onKeydown:[We(_e(g,["prevent"]),["enter"]),We(_e(g,["prevent"]),["space"])]},[(r(),c("svg",{class:X(["chevron-icon",{expanded:l.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...H[0]||(H[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,o$),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:u,onKeydown:[We(_e(u,["prevent"]),["enter"]),We(_e(u,["prevent"]),["space"])]},[s("div",a$,[s("div",r$,[_.value?(r(),c("span",l$,"ðŸ›")):x("",!0),ee(" "+$(n.project.name),1)]),s("div",c$,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:_e(S,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:_.value?"Create minion":"Add session or minion",type:"button",onClick:_e(E,["stop"])}," âž• ",8,u$)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(d.value),9,d$)],40,i$)],2)],8,n$),pe(t$,{project:n.project,sessions:k.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:X(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:y,onHidden:h},[s("div",p$,[s("div",f$,[_.value?(r(),c("div",{key:0,class:X(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:w.value}]),style:{cursor:"pointer"},onClick:I},[...H[1]||(H[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):x("",!0),s("div",v$,[f.value?(r(),c("div",h$,[...H[2]||(H[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):m.value&&m.value.children&&m.value.children.length>0?(r(!0),c(ne,{key:1},le(m.value.children,F=>(r(),be(hi,{key:F.id,"minion-data":F,level:0,layout:"sidebar",onMinionClick:A},null,8,["minion-data"]))),128)):(r(),c("div",_$," No sessions "))])])])],42,m$)],40,s$))}},b$=Z(g$,[["__scopeId","data-v-a15b34e8"]]),y$={class:"project-list"},$$={key:0,class:"text-muted text-center py-3"},w$={__name:"ProjectList",setup(n){const e=Le(),t=v(()=>e.orderedProjects);return(o,i)=>(r(),c("div",y$,[t.value.length===0?(r(),c("div",$$,' No projects yet. Click "New" to create one. ')):x("",!0),(r(!0),c(ne,null,le(t.value,a=>(r(),be(b$,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},k$={class:"flex-grow-1 overflow-auto p-3"},E$={id:"sessions-container"},S$={__name:"Sidebar",setup(n){const e=ve(),t=v(()=>e.sidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const d=`${e.sidebarWidth}px`;return{width:d,minWidth:"200px",maxWidth:"30vw","--sidebar-width":d}});function a(){e.showModal("create-project")}const l=R(!1);function m(d){l.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",p)}function f(d){l.value&&e.setSidebarWidth(d.clientX)}function p(){l.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",p)}return(d,k)=>(r(),c("aside",{id:"sidebar",class:X(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:at(i.value)},[s("div",k$,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[k[0]||(k[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),s("div",E$,[pe(w$)])]),s("div",{class:"sidebar-resize-handle",onMousedown:m},null,32)],6))}},C$=Z(S$,[["__scopeId","data-v-d792f0f0"]]),T$={class:"task-header d-flex align-items-center gap-2 p-2"},x$={class:"status-icon"},A$=["title"],O$={class:"expand-icon"},M$={key:0,class:"active-form px-2 pb-2"},D$={class:"active-form-text"},N$={key:1,class:"task-details p-2 border-top"},L$={key:0,class:"task-description mb-2"},j$={class:"description-content"},I$={key:1,class:"task-owner mb-2"},P$={class:"ms-1"},R$={key:2,class:"task-blocked-by mb-2"},W$={key:3,class:"task-blocks"},H$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=v(()=>{switch(e.task.status){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}),o=v(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(i,a)=>(r(),c("div",{class:X(["task-item mb-2 rounded border",o.value]),onClick:a[0]||(a[0]=l=>i.$emit("toggle"))},[s("div",T$,[s("span",x$,$(t.value),1),s("span",{class:"task-subject flex-grow-1",title:n.task.subject},$(n.task.subject),9,A$),s("span",O$,$(n.isExpanded?"â–¾":"â–¸"),1)]),n.task.status==="in_progress"&&n.task.activeForm?(r(),c("div",M$,[a[1]||(a[1]=s("span",{class:"spinner-border spinner-border-sm me-1",role:"status"},null,-1)),s("span",D$,$(n.task.activeForm),1)])):x("",!0),n.isExpanded?(r(),c("div",N$,[n.task.description?(r(),c("div",L$,[a[2]||(a[2]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",j$,$(n.task.description),1)])):x("",!0),n.task.owner?(r(),c("div",I$,[a[3]||(a[3]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",P$,$(n.task.owner),1)])):x("",!0),n.task.blockedBy?.length>0?(r(),c("div",R$,[a[4]||(a[4]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(r(!0),c(ne,null,le(n.task.blockedBy,l=>(r(),c("span",{key:l,class:"badge bg-warning text-dark me-1"}," #"+$(l),1))),128))])):x("",!0),n.task.blocks?.length>0?(r(),c("div",W$,[a[5]||(a[5]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(r(!0),c(ne,null,le(n.task.blocks,l=>(r(),c("span",{key:l,class:"badge bg-info text-dark me-1"}," #"+$(l),1))),128))])):x("",!0)])):x("",!0)],2))}},B$=Z(H$,[["__scopeId","data-v-94cf89e6"]]),F$={class:"task-list-panel"},V$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},U$={class:"d-flex align-items-center gap-2"},q$={key:0,class:"badge bg-secondary"},z$=["title"],K$={key:0,class:"active-task-banner p-2 bg-primary text-white"},G$={class:"d-flex align-items-center gap-2"},Y$={class:"active-text"},J$={key:1,class:"task-list p-2"},Q$={key:0,class:"text-muted text-center py-4"},X$={__name:"TaskListPanel",setup(n){const e=Rt();ve();const t=R(new Set),o=R(!1),i=v(()=>e.currentTasks),a=v(()=>e.currentActiveTask),l=v(()=>e.currentTaskStats);function m(){o.value=!o.value}function f(p){t.value.has(p)?t.value.delete(p):t.value.add(p),t.value=new Set(t.value)}return(p,d)=>(r(),c("div",F$,[s("div",V$,[s("div",U$,[d[0]||(d[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),d[1]||(d[1]=s("h6",{class:"mb-0"},"Tasks",-1)),l.value.total>0?(r(),c("span",q$,$(l.value.completed)+"/"+$(l.value.total),1)):x("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:m,title:o.value?"Expand":"Collapse"},[(r(),c("svg",{class:X(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,z$)]),a.value&&!o.value?(r(),c("div",K$,[s("div",G$,[d[3]||(d[3]=s("span",{class:"spinner-border spinner-border-sm",role:"status"},null,-1)),s("span",Y$,$(a.value.activeForm||a.value.subject),1)])])):x("",!0),o.value?x("",!0):(r(),c("div",J$,[i.value.length===0?(r(),c("div",Q$,[...d[4]||(d[4]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):x("",!0),pe($i,{name:"task-list",tag:"div"},{default:yi(()=>[(r(!0),c(ne,null,le(i.value,k=>(r(),be(B$,{key:k.id,task:k,isExpanded:t.value.has(k.id),onToggle:_=>f(k.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},Z$=Z(X$,[["__scopeId","data-v-99f2cb78"]]),ew={class:"flex-grow-1 overflow-auto"},tw={__name:"RightSidebar",setup(n){const e=ve(),t=v(()=>e.rightSidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const p=`${e.rightSidebarWidth}px`;return{width:p,minWidth:"200px",maxWidth:"30vw","--sidebar-width":p}}),a=R(!1);function l(p){a.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)}function m(p){if(a.value){const d=window.innerWidth-p.clientX;e.setRightSidebarWidth(d)}}function f(){a.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}return(p,d)=>(r(),c("aside",{id:"right-sidebar",class:X(["bg-light border-start d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value}]),style:at(i.value)},[s("div",ew,[pe(Z$)]),s("div",{class:"sidebar-resize-handle",onMousedown:l},null,32)],6))}},sw=Z(tw,[["__scopeId","data-v-eb35d606"]]),nw={class:"modal-dialog modal-lg"},ow={class:"modal-content"},iw={class:"modal-body"},aw={class:"mb-3"},rw={class:"input-group"},lw=["disabled"],cw={key:0,class:"text-center py-4"},uw={key:1,class:"alert alert-danger",role:"alert"},dw={key:2,class:"folder-list"},mw=["onClick","onDblclick"],pw={class:"d-flex align-items-center flex-grow-1"},fw=["onClick"],vw={key:1,class:"text-center text-muted py-3"},hw={class:"modal-footer"},_w=["disabled"],gw={__name:"FolderBrowserModal",setup(n){const e=ve(),t=R(""),o=R(""),i=R([]),a=R(!1),l=R(""),m=R(null);let f=null,p=null;const d=v(()=>{if(!t.value)return null;const S=t.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?"/"+S.join("/"):"/")});function k(S){if(!S)return"";const E=S.split(/[\\/]/).filter(Boolean);return E.length<=2?S:".../"+E.slice(-2).join("/")}async function _(){a.value=!0,l.value="",i.value=[],o.value="";try{const S=t.value?{path:t.value}:{},E=await ue.get("/api/filesystem/browse",{params:S});E.current_path&&(t.value=E.current_path),i.value=E.directories||[]}catch(S){console.error("Failed to load directory:",S),l.value=S.message||"Failed to load directory"}finally{a.value=!1}}function w(S){o.value=S.path}function b(S){t.value=S.path,o.value="",_()}function g(){d.value&&(t.value=d.value,o.value="",_())}function u(){const S=o.value||t.value;S&&p&&p(S),f&&f.hide()}function y(){_()}function h(){i.value=[],o.value="",l.value="",p=null,e.hideModal()}return fe(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&f){const E=S.data||{};t.value=E.defaultPath||E.currentPath||"",p=E.onSelect||null,f.show()}}),ye(()=>{m.value&&Oe(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{f=new S(m.value),m.value.addEventListener("shown.bs.modal",y),m.value.addEventListener("hidden.bs.modal",h)})}),Se(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",y),m.value.removeEventListener("hidden.bs.modal",h)),f&&f.dispose()}),(S,E)=>(r(),c("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[s("div",nw,[s("div",ow,[E[6]||(E[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",iw,[s("div",aw,[E[1]||(E[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",rw,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=I=>t.value=I),onKeyup:We(_,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[He,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:_,disabled:a.value}," ðŸ”„ Refresh ",8,lw)])]),a.value?(r(),c("div",cw,[...E[2]||(E[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(r(),c("div",uw,$(l.value),1)):(r(),c("div",dw,[d.value?(r(),c("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:g,role:"button"},[...E[3]||(E[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):x("",!0),(r(!0),c(ne,null,le(i.value,I=>(r(),c("div",{key:I.path,class:X(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:I.path===o.value}]),onClick:N=>w(I),onDblclick:N=>b(I),role:"button"},[s("div",pw,[E[4]||(E[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,$(I.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:_e(N=>b(I),["stop"])}," Open ",8,fw)],42,mw))),128)),i.value.length===0?(r(),c("div",vw," No subdirectories found ")):x("",!0)]))]),s("div",hw,[E[5]||(E[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:u,disabled:!o.value},' Select "'+$(k(o.value||t.value))+'" ',9,_w)])])])],512))}},bw=Z(gw,[["__scopeId","data-v-0d61ed46"]]),yw={class:"modal-dialog"},$w={class:"modal-content"},ww={class:"modal-body"},kw={class:"mb-3"},Ew={key:0,class:"invalid-feedback"},Sw={class:"mb-3"},Cw={class:"input-group"},Tw={key:0,class:"invalid-feedback"},xw={class:"mb-3 form-check"},Aw={key:0,class:"mb-3 ms-4"},Ow={key:1,class:"alert alert-danger",role:"alert"},Mw={class:"modal-footer"},Dw=["disabled"],Nw={key:0,class:"spinner-border spinner-border-sm me-2"},Lw={__name:"ProjectCreateModal",setup(n){const e=Le(),t=de(),o=ve(),i=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),a=R({name:"",workingDirectory:""}),l=R(!1),m=R(""),f=R(null);let p=null;function d(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:u=>{i.value.workingDirectory=u,a.value.workingDirectory=""}})}function k(){a.value={};let u=!0;return i.value.name.trim()||(a.value.name="Project name is required",u=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",u=!1),u}async function _(){if(k()){l.value=!0,m.value="";try{const u=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(u.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),w()}catch(u){console.error("Failed to create project:",u),m.value=u.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function w(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},a.value={},m.value=""}function b(){const u=document.getElementById("projectName");u&&u.focus()}function g(){w(),o.hideModal()}return fe(()=>o.currentModal,u=>{u?.name==="create-project"&&p&&p.show()}),ye(()=>{f.value&&Oe(async()=>{const{default:u}=await import("./modal-D6mKceGM.js").then(y=>y.m);return{default:u}},__vite__mapDeps([0,1])).then(({default:u})=>{p=new u(f.value),f.value.addEventListener("shown.bs.modal",b),f.value.addEventListener("hidden.bs.modal",g)})}),Se(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",b),f.value.removeEventListener("hidden.bs.modal",g)),p&&p.dispose()}),(u,y)=>(r(),c("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[s("div",yw,[s("div",$w,[y[11]||(y[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",ww,[s("form",{onSubmit:_e(_,["prevent"])},[s("div",kw,[y[4]||(y[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":y[0]||(y[0]=h=>i.value.name=h),placeholder:"My Project",required:""},null,2),[[He,i.value.name]]),a.value.name?(r(),c("div",Ew,$(a.value.name),1)):x("",!0)]),s("div",Sw,[y[5]||(y[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Cw,[ge(s("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":y[1]||(y[1]=h=>i.value.workingDirectory=h),placeholder:"/path/to/project",required:""},null,2),[[He,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:d}," Browse... "),a.value.workingDirectory?(r(),c("div",Tw,$(a.value.workingDirectory),1)):x("",!0)]),y[6]||(y[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",xw,[ge(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":y[2]||(y[2]=h=>i.value.createSession=h)},null,512),[[wi,i.value.createSession]]),y[7]||(y[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),y[8]||(y[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(r(),c("div",Aw,[y[9]||(y[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ge(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":y[3]||(y[3]=h=>i.value.sessionName=h),placeholder:"main"},null,512),[[He,i.value.sessionName]])])):x("",!0),m.value?(r(),c("div",Ow,$(m.value),1)):x("",!0)],32)]),s("div",Mw,[y[10]||(y[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:l.value},[l.value?(r(),c("span",Nw)):x("",!0),ee(" "+$(l.value?"Creating...":"Create Project"),1)],8,Dw)])])])],512))}},jw=Z(Lw,[["__scopeId","data-v-ea55fdae"]]),Iw={class:"modal-dialog"},Pw={class:"modal-content"},Rw={class:"modal-body"},Ww={class:"mb-3"},Hw={key:0,class:"invalid-feedback"},Bw={class:"mb-3"},Fw=["value"],Vw={key:0,class:"alert alert-danger",role:"alert"},Uw={class:"danger-zone"},qw={class:"text-muted small"},zw=["disabled"],Kw={key:0,class:"alert alert-warning mt-3",role:"alert"},Gw={class:"mb-2"},Yw={class:"d-flex gap-2"},Jw=["disabled"],Qw={key:0,class:"spinner-border spinner-border-sm me-2"},Xw=["disabled"],Zw={class:"modal-footer"},ek=["disabled"],tk={key:0,class:"spinner-border spinner-border-sm me-2"},sk={__name:"ProjectEditModal",setup(n){const e=Le(),t=ve(),o=R(null),i=R({name:""}),a=R({name:""}),l=R(!1),m=R(!1),f=R(""),p=R(!1),d=R(null);let k=null;const _=v(()=>o.value?.session_ids?.length||0);function w(){a.value={};let S=!0;return i.value.name.trim()||(a.value.name="Project name is required",S=!1),S}async function b(){if(!(!w()||!o.value)){l.value=!0,f.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),k&&k.hide()}catch(S){console.error("Failed to update project:",S),f.value=S.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function g(){if(o.value){m.value=!0,f.value="";try{await e.deleteProject(o.value.project_id),k&&k.hide()}catch(S){console.error("Failed to delete project:",S),f.value=S.message||"Failed to delete project. Please try again."}finally{m.value=!1}}}function u(){i.value={name:""},a.value={},f.value="",p.value=!1}function y(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function h(){u(),o.value=null,t.hideModal()}return fe(()=>t.currentModal,S=>{if(S?.name==="edit-project"&&k){const E=S.data||{};o.value=E.project,o.value&&(i.value.name=o.value.name),k.show()}}),ye(()=>{d.value&&Oe(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{k=new S(d.value),d.value.addEventListener("shown.bs.modal",y),d.value.addEventListener("hidden.bs.modal",h)})}),Se(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",y),d.value.removeEventListener("hidden.bs.modal",h)),k&&k.dispose()}),(S,E)=>(r(),c("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",Iw,[s("div",Pw,[E[10]||(E[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Rw,[s("form",{onSubmit:_e(b,["prevent"])},[s("div",Ww,[E[3]||(E[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":E[0]||(E[0]=I=>i.value.name=I),placeholder:"My Project",required:""},null,2),[[He,i.value.name]]),a.value.name?(r(),c("div",Hw,$(a.value.name),1)):x("",!0)]),s("div",Bw,[E[4]||(E[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Fw),E[5]||(E[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),f.value?(r(),c("div",Vw,$(f.value),1)):x("",!0)],32),E[8]||(E[8]=s("hr",null,null,-1)),s("div",Uw,[E[6]||(E[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",qw," Deleting this project will also delete all "+$(_.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:E[1]||(E[1]=I=>p.value=!0),disabled:m.value}," ðŸ—‘ï¸ Delete Project ",8,zw)]),p.value?(r(),c("div",Kw,[E[7]||(E[7]=s("strong",null,"Are you sure?",-1)),s("p",Gw,' This will permanently delete the project "'+$(o.value?.name)+'" and all '+$(_.value)+" session(s). ",1),s("div",Yw,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:g,disabled:m.value},[m.value?(r(),c("span",Qw)):x("",!0),ee(" "+$(m.value?"Deleting...":"Yes, Delete Permanently"),1)],8,Jw),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:E[2]||(E[2]=I=>p.value=!1),disabled:m.value}," Cancel ",8,Xw)])])):x("",!0)]),s("div",Zw,[E[9]||(E[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:l.value},[l.value?(r(),c("span",tk)):x("",!0),ee(" "+$(l.value?"Saving...":"Save Changes"),1)],8,ek)])])])],512))}},nk=Z(sk,[["__scopeId","data-v-52679516"]]),ok={class:"general-tab"},ik={key:0,class:"mb-3"},ak={for:"template-select",class:"form-label"},rk=["value"],lk=["value"],ck={key:0,class:"form-text"},uk={class:"mb-3"},dk={for:"config-name",class:"form-label"},mk=["value","placeholder","pattern","title"],pk={key:0,class:"invalid-feedback"},fk={key:1,class:"form-text"},vk={key:1,class:"mb-3"},hk=["value"],_k={class:"mb-3"},gk=["value"],bk={class:"form-text"},yk={key:0,class:"text-warning"},$k={key:1},wk={class:"mb-3"},kk={for:"config-permission-mode",class:"form-label"},Ek={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Sk={key:1,class:"field-indicator modified",title:"Modified from template"},Ck=["value","disabled"],Tk={key:0,value:"bypassPermissions"},xk={class:"form-text"},Ak={key:0,class:"text-warning"},Ok={key:1},Mk={class:"mb-3"},Dk={for:"config-role",class:"form-label"},Nk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Lk={key:1,class:"field-indicator modified",title:"Modified from template"},jk=["value","placeholder"],Ik={class:"form-text"},Pk={key:2,class:"mb-3"},Rk={class:"input-group"},Wk=["value","placeholder","disabled","readonly"],Hk={class:"form-text"},Bk={key:3,class:"mb-3"},Fk={class:"form-control-plaintext"},Vk={key:4,class:"mb-3 form-check"},Uk=["checked"],qk={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=v(()=>e.mode==="create-session"||e.mode==="edit-session"),o=v(()=>e.mode==="create-template"||e.mode==="edit-template"),i=v(()=>e.mode==="create-session"),a=v(()=>e.mode==="edit-session"),l=v(()=>e.session?.state==="active"||e.session?.state==="starting"),m=v(()=>{if(!e.session)return!1;const g=e.session.model||"sonnet";return e.formData.model!==g}),f=v(()=>e.session?.initial_permission_mode==="bypassPermissions"),p=v(()=>e.selectedTemplateId?e.templates.find(g=>g.template_id===e.selectedTemplateId):null),d={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},k=v(()=>d[e.formData.model]||null),_=v(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),w=v(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function b(g){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[g]||"bg-secondary"}return(g,u)=>(r(),c("div",ok,[i.value?(r(),c("div",ik,[s("label",ak,[u[10]||(u[10]=ee(" Template ",-1)),s("button",{type:"button",onClick:u[0]||(u[0]=y=>g.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:u[1]||(u[1]=y=>g.$emit("update:selected-template-id",y.target.value||null)),class:"form-select"},[u[11]||(u[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(r(!0),c(ne,null,le(n.templates,y=>(r(),c("option",{key:y.template_id,value:y.template_id},$(y.name),9,lk))),128))],40,rk),p.value?(r(),c("div",ck,$(p.value.description),1)):x("",!0)])):x("",!0),s("div",uk,[s("label",dk,[ee($(o.value?"Template Name":"Session Name")+" ",1),u[12]||(u[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:X(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:u[2]||(u[2]=y=>g.$emit("update:form-data","name",y.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,mk),n.errors.name?(r(),c("div",pk,$(n.errors.name),1)):x("",!0),t.value?(r(),c("div",fk,"Must be a single word (no spaces) for #nametag matching")):x("",!0)]),o.value?(r(),c("div",vk,[u[13]||(u[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:u[3]||(u[3]=y=>g.$emit("update:form-data","description",y.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,hk)])):x("",!0),s("div",_k,[u[16]||(u[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:u[4]||(u[4]=y=>g.$emit("update:form-data","model",y.target.value))},[...u[14]||(u[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,gk),s("div",bk,[a.value&&l.value&&m.value?(r(),c("span",yk,[...u[15]||(u[15]=[ee(" Model change requires a ",-1),s("strong",null,"reset",-1),ee(" (not restart) to take effect. ",-1)])])):k.value?(r(),c("span",$k,$(k.value.description),1)):x("",!0)])]),s("div",wk,[s("label",kk,[u[17]||(u[17]=ee(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(r(),c("span",Ek," < ")):x("",!0),n.fieldStates.permission_mode==="modified"?(r(),c("span",Sk," * ")):x("",!0)]),s("select",{id:"config-permission-mode",class:X(["form-select",w.value]),value:n.formData.permission_mode,onChange:u[5]||(u[5]=y=>g.$emit("update:form-data","permission_mode",y.target.value)),disabled:a.value&&!l.value},[u[18]||(u[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),u[19]||(u[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),u[20]||(u[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!a.value||f.value?(r(),c("option",Tk," Bypass Permissions (No prompts - use with caution) ")):x("",!0)],42,Ck),s("div",xk,[a.value&&!l.value?(r(),c("span",Ak," Session must be active to change permission mode. Start the session first. ")):(r(),c("span",Ok,"Controls which tool actions require permission prompts"))])]),s("div",Mk,[s("label",Dk,[ee($(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(r(),c("span",Nk," < ")):x("",!0),n.fieldStates.default_role==="modified"?(r(),c("span",Lk," * ")):x("",!0)]),s("input",{id:"config-role",type:"text",class:X(["form-control",_.value]),value:n.formData.default_role,onInput:u[6]||(u[6]=y=>g.$emit("update:form-data","default_role",y.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,jk),s("div",Ik,$(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(r(),c("div",Pk,[u[21]||(u[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",Rk,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:u[7]||(u[7]=y=>g.$emit("update:form-data","working_directory",y.target.value)),placeholder:a.value?"":"Leave empty to inherit from project",disabled:a.value,readonly:a.value},null,40,Wk),a.value?x("",!0):(r(),c("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:u[8]||(u[8]=y=>g.$emit("open-folder-browser"))}," Browse "))]),s("div",Hk,$(a.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):x("",!0),a.value&&n.session?(r(),c("div",Bk,[u[22]||(u[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",Fk,[s("span",{class:X(["badge",b(n.session.state)])},$(n.session.state),3)])])):x("",!0),i.value?(r(),c("div",Vk,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:u[9]||(u[9]=y=>g.$emit("update:form-data","startImmediately",y.target.checked))},null,40,Uk),u[23]||(u[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):x("",!0)]))}},zk=Z(qk,[["__scopeId","data-v-b9edc342"]]),Kk={class:"permissions-tab"},Gk={class:"mb-3"},Yk={for:"config-allowed-tools",class:"form-label"},Jk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Qk={key:1,class:"field-indicator modified",title:"Modified from template"},Xk={key:0,class:"tools-list mb-2"},Zk=["onClick"],eE={class:"input-group input-group-sm"},tE=["onKeydown"],sE=["disabled"],nE={class:"mt-2"},oE=["onClick"],iE={class:"form-text"},aE={key:0,class:"text-warning"},rE={key:1},lE={class:"mb-3"},cE={class:"capabilities-editor"},uE={key:0,class:"capabilities-list mb-2"},dE=["onClick"],mE={class:"input-group input-group-sm"},pE=["onKeydown"],fE=["disabled"],vE={key:0,class:"mb-3"},hE={class:"settings-sources-editor"},_E={class:"form-check"},gE=["checked"],bE={class:"form-check"},yE=["checked"],$E={class:"form-check"},wE=["checked"],kE={class:"form-text"},EE={key:0,class:"text-warning"},SE={key:1},CE={key:1,class:"mb-3"},TE={class:"mb-3"},xE={key:0,class:"mt-2"},AE=["value"],OE=["value"],ME={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=R(""),a=R(""),l=R(!1),m=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],f=v(()=>t.mode==="create-template"||t.mode==="edit-template"),p=v(()=>t.mode==="create-session"||t.mode==="edit-session"),d=v(()=>t.mode==="edit-session"),k=v(()=>t.session?.state==="active"||t.session?.state==="starting"),_=v(()=>{if(!t.session)return!1;const C=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==C}),w=v(()=>t.formData.setting_sources||["user","project","local"]),b=v(()=>{if(!t.session)return!1;const C=t.session.setting_sources||["user","project","local"],T=t.formData.setting_sources||["user","project","local"];return JSON.stringify(C.sort())!==JSON.stringify(T.sort())}),g=v(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(C=>C.trim()).filter(C=>C.length>0)),u=v(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(C=>C.trim()).filter(C=>C.length>0)),y=v(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),h=v(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function S(){const C=i.value.trim();if(C){if(!g.value.includes(C)){const T=[...g.value,C];o("update:form-data","allowed_tools",T.join(", "))}i.value=""}}function E(C){const T=[...g.value];T.splice(C,1),o("update:form-data","allowed_tools",T.join(", "))}function I(C){if(g.value.includes(C)){const T=g.value.indexOf(C);E(T)}else{const T=[...g.value,C];o("update:form-data","allowed_tools",T.join(", "))}}function N(){const C=a.value.trim().toLowerCase();if(C){if(!u.value.includes(C)){const T=[...u.value,C];o("update:form-data","capabilities",T.join(", "))}a.value=""}}function A(C){const T=[...u.value];T.splice(C,1),o("update:form-data","capabilities",T.join(", "))}function P(C){const T=[...w.value],U=T.indexOf(C);U>=0?T.splice(U,1):T.push(C),o("update:form-data","setting_sources",T)}return(C,T)=>(r(),c("div",Kk,[s("div",Gk,[s("label",Yk,[T[9]||(T[9]=ee(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(r(),c("span",Jk," < ")):x("",!0),n.fieldStates.allowed_tools==="modified"?(r(),c("span",Qk," * ")):x("",!0)]),s("div",{class:X(["allowed-tools-editor",h.value])},[g.value.length>0?(r(),c("div",Xk,[(r(!0),c(ne,null,le(g.value,(U,q)=>(r(),c("span",{key:q,class:"badge bg-primary me-1 mb-1 tool-badge"},[ee($(U)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:W=>E(q),"aria-label":"Remove tool"},null,8,Zk)]))),128))])):x("",!0),s("div",eE,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=U=>i.value=U),onKeydown:We(_e(S,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,tE),[[He,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:S,disabled:!i.value.trim()}," Add ",8,sE)]),s("div",nE,[T[10]||(T[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(r(),c(ne,null,le(m,U=>s("button",{key:U,type:"button",class:X(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":g.value.includes(U)}]),onClick:q=>I(U)},$(U),11,oE)),64))])],2),s("div",iE,[d.value&&k.value&&_.value?(r(),c("span",aE,[...T[11]||(T[11]=[ee(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),ee(" (not restart) to take effect. ",-1)])])):(r(),c("span",rE,$(f.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",lE,[T[12]||(T[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",cE,[u.value.length>0?(r(),c("div",uE,[(r(!0),c(ne,null,le(u.value,(U,q)=>(r(),c("span",{key:q,class:"badge bg-info me-1 mb-1 capability-badge"},[ee($(U)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:W=>A(q),"aria-label":"Remove capability"},null,8,dE)]))),128))])):x("",!0),s("div",mE,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":T[1]||(T[1]=U=>a.value=U),onKeydown:We(_e(N,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,pE),[[He,a.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:N,disabled:!a.value.trim()}," Add ",8,fE)])]),T[13]||(T[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),p.value?(r(),c("div",vE,[T[18]||(T[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",hE,[s("div",_E,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:w.value.includes("user"),onChange:T[2]||(T[2]=U=>P("user"))},null,40,gE),T[14]||(T[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[ee(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",bE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:w.value.includes("project"),onChange:T[3]||(T[3]=U=>P("project"))},null,40,yE),T[15]||(T[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[ee(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",$E,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:w.value.includes("local"),onChange:T[4]||(T[4]=U=>P("local"))},null,40,wE),T[16]||(T[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[ee(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",kE,[d.value&&k.value&&b.value?(r(),c("span",EE,[...T[17]||(T[17]=[ee(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),ee(" to take effect. ",-1)])])):(r(),c("span",SE," Select which settings files to load permissions from "))])])):x("",!0),p.value?(r(),c("div",CE,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:T[5]||(T[5]=U=>C.$emit("preview-permissions"))}," Preview Effective Permissions ")])):x("",!0),s("div",TE,[s("a",{class:"text-muted small",role:"button",onClick:T[6]||(T[6]=U=>l.value=!l.value)},$(l.value?"Hide":"Show")+" raw input ",1),l.value?(r(),c("div",xE,[T[19]||(T[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:X(["form-control form-control-sm",y.value]),value:n.formData.allowed_tools,onInput:T[7]||(T[7]=U=>C.$emit("update:form-data","allowed_tools",U.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,AE),T[20]||(T[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:T[8]||(T[8]=U=>C.$emit("update:form-data","capabilities",U.target.value)),placeholder:"python, testing, debugging"},null,40,OE)])):x("",!0)])]))}},DE=Z(ME,[["__scopeId","data-v-e58aa2be"]]),NE={class:"advanced-tab"},LE={key:0,class:"alert alert-warning mb-3",role:"alert"},jE={class:"mb-3"},IE={for:"config-system-prompt",class:"form-label"},PE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},RE={key:1,class:"field-indicator modified",title:"Modified from template"},WE=["value","rows","maxlength","placeholder"],HE={class:"form-text d-flex justify-content-between"},BE={key:0,class:"invalid-feedback"},FE={class:"mb-3 form-check"},VE=["checked"],UE={key:0,class:"form-text text-warning"},qE={key:1,class:"mb-3 form-check"},zE=["checked"],KE={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=v(()=>t.mode==="create-session"||t.mode==="edit-session"),a=v(()=>t.mode==="create-template"||t.mode==="edit-template"),l=v(()=>t.mode==="edit-session"),m=v(()=>t.session?.state==="active"||t.session?.state==="starting"),f=v(()=>{if(!t.session)return!1;const h=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),S=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),E=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return h||S||E}),p=v(()=>a.value?6e3:2e3),d=v(()=>a.value?t.formData.system_prompt:t.formData.initialization_context),k=v(()=>d.value?.length||0),_=v(()=>k.value>p.value),w=v(()=>{const h=p.value*.9;return k.value>h&&k.value<=p.value}),b=v(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),g=v(()=>t.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),u=v(()=>{const h={};return _.value&&(h["is-invalid"]=!0),t.fieldStates.initialization_context==="autofilled"&&(h["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&(h["field-modified"]=!0),h});function y(h){const S=h.target.value,E=a.value?"system_prompt":"initialization_context";o("update:form-data",E,S)}return(h,S)=>(r(),c("div",NE,[l.value&&m.value&&f.value?(r(),c("div",LE,[...S[2]||(S[2]=[s("small",null,[ee("Changes to these settings require a "),s("strong",null,"reset"),ee(" (not restart) to take effect.")],-1)])])):x("",!0),s("div",jE,[s("label",IE,[ee($(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(r(),c("span",PE," < ")):x("",!0),n.fieldStates.initialization_context==="modified"?(r(),c("span",RE," * ")):x("",!0)]),s("textarea",{id:"config-system-prompt",class:X(["form-control",u.value]),value:d.value,onInput:y,rows:a.value?4:5,maxlength:p.value,placeholder:b.value},null,42,WE),s("div",HE,[s("span",null,$(g.value),1),s("span",{class:X({"text-danger":_.value,"text-warning":w.value})},$(k.value)+" / "+$(p.value)+" chars ",3)]),_.value?(r(),c("div",BE,$(a.value?"System prompt":"Initialization context")+" exceeds "+$(p.value)+" character limit ",1)):x("",!0)]),s("div",FE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:S[0]||(S[0]=E=>h.$emit("update:form-data","override_system_prompt",E.target.checked))},null,40,VE),S[3]||(S[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(r(),c("div",UE,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+$(a.value?"":" or legion guide")+").",1)])):x("",!0)]),i.value?(r(),c("div",qE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:S[1]||(S[1]=E=>h.$emit("update:form-data","sandbox_enabled",E.target.checked))},null,40,zE),S[4]||(S[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:X(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,$(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):x("",!0)]))}},GE=Z(KE,[["__scopeId","data-v-1909e7ae"]]),YE={class:"modal-dialog modal-lg"},JE={class:"modal-content"},QE={class:"modal-body"},XE={key:0,class:"text-center py-4"},ZE={key:1,class:"alert alert-danger"},eS={key:2},tS={class:"mb-3"},sS={class:"small text-muted mb-2"},nS={key:0},oS={key:0,class:"alert alert-info"},iS={key:1},aS={class:"table table-sm table-striped"},rS={key:2,class:"mt-3"},lS={class:"modal-footer"},cS=["disabled"],uS={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=R(null);let l=null;const m=R(!1),f=R(""),p=R([]);fe(a,g=>{g&&(l=new dt(g),g.addEventListener("hidden.bs.modal",()=>{i("close")}))});function d(){l&&(l.show(),_())}function k(){l&&l.hide()}async function _(){m.value=!0,f.value="",p.value=[];try{const g=await ue.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});p.value=g.permissions||[]}catch(g){console.error("Failed to load permissions:",g),f.value=g.response?.data?.detail||g.message||"Failed to load permissions"}finally{m.value=!1}}function w(){_()}function b(g){switch(g){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:d,hide:k}),(g,u)=>(r(),c("div",{ref_key:"modalRef",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",YE,[s("div",JE,[u[7]||(u[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",QE,[m.value?(r(),c("div",XE,[...u[0]||(u[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):f.value?(r(),c("div",ZE,$(f.value),1)):(r(),c("div",eS,[s("div",tS,[u[2]||(u[2]=s("h6",null,"Settings Sources",-1)),s("div",sS,[u[1]||(u[1]=ee(" Loading permissions from: ",-1)),(r(!0),c(ne,null,le(n.settingSources,(y,h)=>(r(),c("span",{key:y},[s("code",null,$(y),1),h<n.settingSources.length-1?(r(),c("span",nS,", ")):x("",!0)]))),128))])]),p.value.length===0?(r(),c("div",oS," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(r(),c("div",iS,[s("h6",null,"Pre-approved Permissions ("+$(p.value.length)+")",1),s("table",aS,[u[3]||(u[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(r(!0),c(ne,null,le(p.value,y=>(r(),c("tr",{key:y.permission},[s("td",null,[s("code",null,$(y.permission),1)]),s("td",null,[(r(!0),c(ne,null,le(y.sources,(h,S)=>(r(),c("span",{key:h,class:X(["badge me-1",b(h)])},$(h),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(r(),c("div",rS,[u[4]||(u[4]=s("h6",null,"Session Allowed Tools",-1)),u[5]||(u[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(r(!0),c(ne,null,le(n.sessionAllowedTools,y=>(r(),c("span",{key:y,class:"badge bg-success me-1 mb-1"},$(y),1))),128))])])):x("",!0)]))]),s("div",lS,[u[6]||(u[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:w,disabled:m.value}," Refresh ",8,cS)])])])],512))}},dS=Z(uS,[["__scopeId","data-v-988ff7c4"]]),mS={class:"modal-dialog modal-lg modal-dialog-centered"},pS={class:"modal-content"},fS={class:"modal-header"},vS={id:"configurationModalLabel",class:"modal-title"},hS={class:"modal-body"},_S={key:0,class:"template-list-view"},gS={key:0,class:"alert alert-info"},bS={class:"card-body"},yS={class:"d-flex justify-content-between align-items-start"},$S={class:"flex-grow-1"},wS={class:"card-title mb-1"},kS={key:0,class:"card-text text-muted small mb-2"},ES={class:"template-meta"},SS={class:"badge bg-secondary me-2"},CS={class:"text-muted small"},TS={class:"btn-group btn-group-sm ms-3"},xS=["onClick"],AS=["onClick"],OS={key:1},MS={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},DS={class:"nav-item",role:"presentation"},NS={key:0,class:"error-indicator",title:"This tab has validation errors"},LS={class:"nav-item",role:"presentation"},jS={key:0,class:"error-indicator",title:"This tab has validation errors"},IS={class:"nav-item",role:"presentation"},PS={key:0,class:"error-indicator",title:"This tab has validation errors"},RS={class:"tab-content"},WS={key:2,class:"alert alert-danger mt-3"},HS={class:"modal-footer"},BS={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},FS=["disabled"],VS={key:0,class:"spinner-border spinner-border-sm me-2"},US={__name:"ConfigurationModal",setup(n){const e=Wt(),t=Le(),o=de(),i=ve(),a=R(null);let l=null;const m=R(null),f=R("create-session"),p=R("general"),d=R(null),k=R(null),_=R(null),w=R([]),b=R(null),g=R(null),u=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),y=ys({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),h=ys({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),S=ys({name:"",system_prompt:"",initialization_context:""}),E=v(()=>({general:!!S.name,permissions:!1,advanced:!!S.system_prompt||!!S.initialization_context})),I=R(!1),N=R(""),A=v(()=>f.value==="create-session"||f.value==="edit-session"),P=v(()=>f.value==="edit-session"||f.value==="edit-template"),C=v(()=>{switch(f.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),T=v(()=>I.value?P.value?"Saving...":"Creating...":P.value?"Save Changes":A.value?"Create Session":"Save Template"),U=v(()=>!(!h.name.trim()||h.system_prompt.length>6e3||h.initialization_context.length>2e3||A.value&&h.name.includes(" "))),q=v(()=>k.value?.working_directory?k.value.working_directory:h.working_directory?h.working_directory:t.projects.get(d.value)?.working_directory||""),W=v(()=>!h.allowed_tools||!h.allowed_tools.trim()?[]:h.allowed_tools.split(",").map(V=>V.trim()).filter(V=>V.length>0));function H(){m.value&&m.value.show()}function F(V,ae){h[V]=ae,V==="name"&&(S.name=""),V==="system_prompt"&&(S.system_prompt=""),V==="initialization_context"&&(S.initialization_context="")}function O(V){b.value=V,K()}async function M(){try{const V=await ue.get("/api/templates");w.value=V||[]}catch(V){console.error("Failed to load templates:",V),w.value=[]}}function K(){if(!b.value){h.default_role="",h.initialization_context="",h.permission_mode="default",h.allowed_tools="",y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",u.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const V=w.value.find(ae=>ae.template_id===b.value);if(V)if(y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",V.default_role?(h.default_role=V.default_role,u.value.default_role=V.default_role,y.default_role="autofilled"):(h.default_role="",u.value.default_role=null),V.default_system_prompt?(h.initialization_context=V.default_system_prompt,u.value.initialization_context=V.default_system_prompt,y.initialization_context="autofilled"):(h.initialization_context="",u.value.initialization_context=null),V.permission_mode?(h.permission_mode=V.permission_mode,u.value.permission_mode=V.permission_mode,y.permission_mode="autofilled"):(h.permission_mode="default",u.value.permission_mode=null),V.allowed_tools&&V.allowed_tools.length>0){const ae=V.allowed_tools.join(", ");h.allowed_tools=ae,u.value.allowed_tools=ae,y.allowed_tools="autofilled"}else h.allowed_tools="",u.value.allowed_tools=null}function L(){const ae=(d.value?t.projects.get(d.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:ae,currentPath:h.working_directory||"",onSelect:ce=>{h.working_directory=ce}})}function D(){f.value==="create-session"&&(g.value={mode:"create-session",projectId:d.value,formData:{...h},selectedTemplateId:b.value}),f.value="template-list",te()}function z(){f.value="create-template",te(),p.value="general"}function oe(V){f.value="edit-template",_.value=V,te(),he(V),p.value="general"}async function Y(V){if(confirm(`Delete template "${V.name}"?

This action cannot be undone.`))try{await ue.delete(`/api/templates/${V.template_id}`),await M()}catch(ae){console.error("Failed to delete template:",ae),N.value=ae.response?.data?.detail||"Failed to delete template"}}function Q(){let V=!0;return S.name="",S.system_prompt="",S.initialization_context="",h.name.trim()||(S.name="Name is required",V=!1),A.value&&h.name.includes(" ")&&(S.name="Session name must be a single word (no spaces)",V=!1),h.system_prompt.length>6e3&&(S.system_prompt="System prompt exceeds 6000 character limit",V=!1),h.initialization_context.length>2e3&&(S.initialization_context="Initialization context exceeds 2000 character limit",V=!1),V}async function re(){if(!Q()){S.name?p.value="general":(S.system_prompt||S.initialization_context)&&(p.value="advanced");return}I.value=!0,N.value="";try{switch(f.value){case"create-session":await me(),l&&l.hide();break;case"edit-session":await B(),l&&l.hide();break;case"create-template":await j();break;case"edit-template":await J();break}}catch(V){console.error("Submit failed:",V),N.value=V.response?.data?.detail||V.message||"Operation failed. Please try again."}finally{I.value=!1}}async function me(){if(!d.value)throw new Error("Project ID is missing");const V=h.allowed_tools.split(",").map(Re=>Re.trim()).filter(Re=>Re.length>0),ae=h.capabilities.split(",").map(Re=>Re.trim()).filter(Re=>Re.length>0),ce={name:h.name.trim(),model:h.model||null,role:h.default_role.trim()||null,initialization_context:h.initialization_context.trim()||null,override_system_prompt:h.override_system_prompt,capabilities:ae.length>0?ae:null,permission_mode:h.permission_mode,allowed_tools:V.length>0?V:null,working_directory:h.working_directory.trim()||null,sandbox_enabled:h.sandbox_enabled,setting_sources:h.setting_sources},Pe=await ue.post(`/api/legions/${d.value}/minions`,ce);if(Pe.success&&Pe.minion_id)await t.fetchProjects(),await o.fetchSessions(),h.startImmediately&&await o.startSession(Pe.minion_id),e.push(`/session/${Pe.minion_id}`);else throw new Error("Failed to create session")}async function B(){if(!k.value)throw new Error("Session data is missing");const V=k.value.session_id,ae=k.value.state==="active"||k.value.state==="starting",ce=h.allowed_tools.split(",").map($e=>$e.trim()).filter($e=>$e.length>0),Pe=h.capabilities.split(",").map($e=>$e.trim()).filter($e=>$e.length>0),Re={name:h.name.trim(),model:h.model,role:h.default_role.trim()||null,system_prompt:h.initialization_context.trim()||null,override_system_prompt:h.override_system_prompt,allowed_tools:ce.length>0?ce:null,capabilities:Pe.length>0?Pe:null,sandbox_enabled:h.sandbox_enabled,setting_sources:h.setting_sources};await o.patchSession(V,Re),ae&&h.permission_mode!==k.value.current_permission_mode&&await o.setPermissionMode(V,h.permission_mode)}async function j(){const V=h.allowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ae={name:h.name.trim(),description:h.description.trim()||null,permission_mode:h.permission_mode,allowed_tools:V.length>0?V:null,default_role:h.default_role.trim()||null,default_system_prompt:h.initialization_context.trim()||null};await ue.post("/api/templates",ae),await M(),f.value="template-list",te()}async function J(){if(!_.value)throw new Error("Template data is missing");const V=h.allowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ae={name:h.name.trim(),description:h.description.trim()||null,permission_mode:h.permission_mode,allowed_tools:V.length>0?V:null,default_role:h.default_role.trim()||null,default_system_prompt:h.initialization_context.trim()||null};await ue.put(`/api/templates/${_.value.template_id}`,ae),await M(),f.value="template-list",_.value=null,te()}function te(){h.name="",h.model="sonnet",h.permission_mode="default",h.working_directory="",h.description="",h.default_role="",h.startImmediately=!0,h.allowed_tools="",h.capabilities="",h.setting_sources=["user","project","local"],h.system_prompt="",h.override_system_prompt=!1,h.initialization_context="",h.sandbox_enabled=!1,S.name="",S.system_prompt="",S.initialization_context="",y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",u.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},b.value=null,N.value="",p.value="general"}function ie(V){h.name=V.name||"",h.model=V.model||"sonnet",h.permission_mode=V.current_permission_mode||"default",h.working_directory=V.working_directory||"",h.default_role=V.role||"",h.initialization_context=V.system_prompt||"",h.override_system_prompt=V.override_system_prompt||!1,h.system_prompt="",h.allowed_tools=V.allowed_tools?.join(", ")||"",h.capabilities=V.capabilities?.join(", ")||"",h.sandbox_enabled=V.sandbox_enabled||!1,h.setting_sources=V.setting_sources||["user","project","local"]}function he(V){h.name=V.name||"",h.description=V.description||"",h.permission_mode=V.permission_mode||"default",h.default_role=V.default_role||"",h.initialization_context=V.default_system_prompt||"",h.allowed_tools=V.allowed_tools?.join(", ")||""}function Ie(){$t(()=>{const V=document.getElementById("config-name");V&&(V.focus(),P.value&&V.select())})}function Ye(){te(),f.value="create-session",d.value=null,k.value=null,_.value=null,i.hideModal()}return fe(()=>i.currentModal,async(V,ae)=>{if(!(!V||!l)){if(V.name==="configuration"){const ce=V.data||{};f.value=ce.mode||"create-session",d.value=ce.project?.project_id||ce.projectId||null,k.value=ce.session||null,_.value=ce.template||null,te(),f.value==="create-session"&&await M(),f.value==="edit-session"&&k.value?ie(k.value):f.value==="edit-template"&&_.value&&he(_.value),l.show()}else if(V.name==="create-minion"||V.name==="create-session"){const ce=V.data||{};f.value="create-session",d.value=ce.project?.project_id||null,k.value=null,_.value=null,te(),await M(),l.show()}else if(V.name==="edit-session"){const ce=V.data||{};f.value="edit-session",k.value=ce.session||null,d.value=k.value?.project_id||null,_.value=null,te(),k.value&&ie(k.value),l.show()}else V.name==="template-management"&&(f.value="template-list",te(),await M(),l.show());ae?.name==="configuration"&&ae.data?.mode?.includes("template")&&V?.name==="configuration"&&f.value==="create-session"&&await M()}}),fe(()=>h.default_role,V=>{u.value.default_role!==null&&(y.default_role=V===u.value.default_role?"autofilled":"modified")}),fe(()=>h.initialization_context,V=>{u.value.initialization_context!==null&&(y.initialization_context=V===u.value.initialization_context?"autofilled":"modified")}),fe(()=>h.permission_mode,V=>{u.value.permission_mode!==null&&(y.permission_mode=V===u.value.permission_mode?"autofilled":"modified")}),fe(()=>h.allowed_tools,V=>{u.value.allowed_tools!==null&&(y.allowed_tools=V===u.value.allowed_tools?"autofilled":"modified")}),ye(()=>{a.value&&Oe(()=>import("./modal-D6mKceGM.js").then(V=>V.m),__vite__mapDeps([0,1])).then(V=>{const ae=V.default;l=new ae(a.value),a.value.addEventListener("shown.bs.modal",Ie),a.value.addEventListener("hidden.bs.modal",Ye)})}),Se(()=>{a.value&&(a.value.removeEventListener("shown.bs.modal",Ie),a.value.removeEventListener("hidden.bs.modal",Ye)),l&&l.dispose()}),(V,ae)=>(r(),c(ne,null,[s("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",mS,[s("div",pS,[s("div",fS,[s("h5",vS,[f.value==="create-template"||f.value==="edit-template"?(r(),c("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:D,title:"Back to template list"}," â† ")):x("",!0),ee(" "+$(C.value),1)]),ae[3]||(ae[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",hS,[f.value==="template-list"?(r(),c("div",_S,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[ae[4]||(ae[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:z,class:"btn btn-primary btn-sm"}," + Create New ")]),w.value.length===0?(r(),c("div",gS," No templates found. Create your first template! ")):x("",!0),(r(!0),c(ne,null,le(w.value,ce=>(r(),c("div",{key:ce.template_id,class:"card mb-2"},[s("div",bS,[s("div",yS,[s("div",$S,[s("h6",wS,$(ce.name),1),ce.description?(r(),c("p",kS,$(ce.description),1)):x("",!0),s("div",ES,[s("span",SS,$(ce.permission_mode),1),s("span",CS,$(ce.allowed_tools?.length||0)+" tools",1)])]),s("div",TS,[s("button",{onClick:Pe=>oe(ce),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,xS),s("button",{onClick:Pe=>Y(ce),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,AS)])])])]))),128))])):(r(),c("div",OS,[s("ul",MS,[s("li",DS,[s("button",{class:X(["nav-link",{active:p.value==="general","has-error":E.value.general}]),type:"button",onClick:ae[0]||(ae[0]=ce=>p.value="general")},[ae[5]||(ae[5]=ee(" General ",-1)),E.value.general?(r(),c("span",NS)):x("",!0)],2)]),s("li",LS,[s("button",{class:X(["nav-link",{active:p.value==="permissions","has-error":E.value.permissions}]),type:"button",onClick:ae[1]||(ae[1]=ce=>p.value="permissions")},[ae[6]||(ae[6]=ee(" Permissions ",-1)),E.value.permissions?(r(),c("span",jS)):x("",!0)],2)]),s("li",IS,[s("button",{class:X(["nav-link",{active:p.value==="advanced","has-error":E.value.advanced}]),type:"button",onClick:ae[2]||(ae[2]=ce=>p.value="advanced")},[ae[7]||(ae[7]=ee(" Advanced ",-1)),E.value.advanced?(r(),c("span",PS)):x("",!0)],2)])]),s("div",RS,[ge(pe(zk,{mode:f.value,"form-data":h,errors:S,templates:w.value,"selected-template-id":b.value,session:k.value,"field-states":y,"onUpdate:formData":F,"onUpdate:selectedTemplateId":O,onOpenFolderBrowser:L,onOpenTemplateManager:D},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[bs,p.value==="general"]]),ge(pe(DE,{mode:f.value,"form-data":h,errors:S,session:k.value,"field-states":y,"onUpdate:formData":F,onPreviewPermissions:H},null,8,["mode","form-data","errors","session","field-states"]),[[bs,p.value==="permissions"]]),ge(pe(GE,{mode:f.value,"form-data":h,errors:S,session:k.value,"field-states":y,"onUpdate:formData":F},null,8,["mode","form-data","errors","session","field-states"]),[[bs,p.value==="advanced"]])])])),N.value?(r(),c("div",WS,$(N.value),1)):x("",!0)]),s("div",HS,[s("button",BS,$(f.value==="template-list"?"Close":"Cancel"),1),f.value!=="template-list"?(r(),c("button",{key:0,type:"button",class:"btn btn-primary",disabled:I.value||!U.value,onClick:re},[I.value?(r(),c("span",VS)):x("",!0),ee(" "+$(T.value),1)],8,FS)):x("",!0)])])])],512),pe(dS,{ref_key:"permissionPreviewModal",ref:m,"working-directory":q.value,"setting-sources":h.setting_sources,"session-allowed-tools":W.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},qS=Z(US,[["__scopeId","data-v-bb54bc71"]]),zS={class:"modal-dialog modal-dialog-centered"},KS={class:"modal-content"},GS={class:"modal-header"},YS={class:"modal-title",id:"manageSessionModalLabel"},JS={class:"modal-body"},QS={key:0,class:"text-center py-4"},XS={class:"text-muted"},ZS={key:1},eC={key:2},tC={class:"text-muted"},sC={key:0,class:"text-center py-2"},nC={key:1,class:"alert alert-warning mt-3"},oC={class:"mb-0 mt-2"},iC={key:0,class:"text-muted"},aC={key:3},rC={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},lC={class:"d-grid gap-2"},cC=["disabled"],uC=["disabled"],dC=["disabled"],mC=["disabled"],pC={class:"modal-footer"},fC={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},vC={__name:"SessionManageModal",setup(n){const e=Wt(),t=de(),o=ve(),i=et();Ce();const a=R(null),l=R(!1),m=R(""),f=R(""),p=R(null),d=R(null);let k=null;const _=R([]),w=R(!1),b=v(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function g(){p.value="reset"}async function u(){if(p.value="delete",_.value=[],!!a.value){w.value=!0;try{const C=await ue.get(`/api/sessions/${a.value.session_id}/descendants`);_.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),_.value=[]}finally{w.value=!1}}}function y(){p.value=null}async function h(){p.value==="reset"?await I():p.value==="delete"&&await N()}async function S(){if(a.value){l.value=!0,m.value="Restarting session...";try{const C=a.value.session_id,T=t.currentSessionId===C,U=await ue.post(`/api/sessions/${C}/restart`);if(U.success)console.log("Session restarted successfully"),T&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(C)),k&&k.hide();else{const q=U.error||U.detail||"Failed to restart session";console.error("Failed to restart session:",q),f.value=`Failed to restart session: ${q}`}}catch(C){console.error("Error restarting session:",C);const T=C.data?.detail||C.message||"Unknown error";f.value=`Error restarting session: ${T}`}finally{l.value=!1}}}async function E(){if(a.value)try{k&&k.hide(),console.log("Ending session",a.value.session_id);const C=a.value.session_id;await ue.post(`/api/sessions/${C}/terminate`),t.currentSessionId===C&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),t.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function I(){if(a.value){l.value=!0,m.value="Resetting session...";try{const C=a.value.session_id,T=t.currentSessionId===C,U=await ue.post(`/api/sessions/${C}/reset`);if(U.success)console.log("Session reset successfully"),T&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(C)),k&&k.hide();else{const q=U.error||U.detail||"Failed to reset session";console.error("Failed to reset session:",q),f.value=`Failed to reset session: ${q}`,p.value=null}}catch(C){console.error("Error resetting session:",C);const T=C.data?.detail||C.message||"Unknown error";f.value=`Error resetting session: ${T}`,p.value=null}finally{l.value=!1}}}async function N(){if(a.value){l.value=!0,m.value="Deleting session...";try{const C=a.value.session_id;await t.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),k&&k.hide()}catch(C){console.error("Error deleting session:",C);const T=C.data?.detail||C.message||"Unknown error";f.value=`Error deleting session: ${T}`,p.value=null}finally{l.value=!1}}}function A(){p.value=null,l.value=!1,m.value="",f.value="",_.value=[],w.value=!1}function P(){A(),a.value=null,o.hideModal()}return fe(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&k){const T=C.data||{};a.value=T.session,A(),k.show()}}),ye(()=>{d.value&&Oe(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{k=new C(d.value),d.value.addEventListener("hidden.bs.modal",P)})}),Se(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",P),k&&k.dispose()}),(C,T)=>(r(),c("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",zS,[s("div",KS,[s("div",GS,[s("h5",YS,$(p.value?b.value:"Manage Session"),1),T[1]||(T[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",JS,[l.value?(r(),c("div",QS,[T[2]||(T[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",XS,$(m.value),1)])):p.value==="reset"?(r(),c("div",ZS,[...T[3]||(T[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(r(),c("div",eC,[T[9]||(T[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",tC,[T[4]||(T[4]=ee("This will permanently delete session ",-1)),s("strong",null,$(a.value?.name),1),T[5]||(T[5]=ee(".",-1))]),T[10]||(T[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),w.value?(r(),c("div",sC,[...T[6]||(T[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):_.value.length>0?(r(),c("div",nC,[T[7]||(T[7]=s("strong",null,"Cascading Deletion:",-1)),T[8]||(T[8]=ee(" This session has ",-1)),s("strong",null,$(_.value.length),1),ee(" child session"+$(_.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",oC,[(r(!0),c(ne,null,le(_.value,U=>(r(),c("li",{key:U.session_id,class:"small"},[s("strong",null,$(U.name||U.session_id),1),U.role?(r(),c("span",iC," ("+$(U.role)+")",1)):x("",!0)]))),128))])])):x("",!0)])):(r(),c("div",aC,[f.value?(r(),c("div",rC,[T[11]||(T[11]=s("strong",null,"Error:",-1)),ee(" "+$(f.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:T[0]||(T[0]=U=>f.value="")})])):x("",!0),T[18]||(T[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",lC,[s("button",{class:"btn btn-outline-primary text-start",onClick:S,disabled:l.value},[...T[12]||(T[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,cC),s("button",{class:"btn btn-outline-secondary text-start",onClick:E,disabled:l.value},[...T[13]||(T[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,uC),T[16]||(T[16]=s("hr",{class:"my-2"},null,-1)),T[17]||(T[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:g,disabled:l.value},[...T[14]||(T[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,dC),s("button",{class:"btn btn-outline-danger text-start",onClick:u,disabled:l.value},[...T[15]||(T[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,mC)]),T[19]||(T[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ee(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",pC,[p.value&&!l.value?(r(),c(ne,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancel"),s("button",{type:"button",class:X(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:h},$(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?x("",!0):(r(),c("button",fC,"Cancel"))])])])],512))}},hC=Z(vC,[["__scopeId","data-v-6b832853"]]),_C={class:"modal-dialog modal-dialog-centered modal-lg"},gC={class:"modal-content"},bC={class:"modal-body"},yC={key:0,class:"text-center text-muted py-4"},$C={key:1},wC={class:"mb-3"},kC={class:"font-monospace small"},EC={class:"mb-3"},SC=["value"],CC={class:"mb-3"},TC={class:"mb-3"},xC={class:"mb-3"},AC={key:0},OC={class:"d-flex flex-wrap gap-1"},MC={key:1,class:"text-muted small"},DC={key:0,class:"mb-3"},NC={class:"d-flex flex-wrap gap-1"},LC={key:1,class:"mb-3"},jC={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},IC={class:"mb-3"},PC={class:"text-muted"},RC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},WC={__name:"SessionInfoModal",setup(n){const e=de(),t=Ce(),o=ve(),i=R(null),a=R(!1),l=R(null);let m=null;const f={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},p=v(()=>{if(!i.value)return null;const g=e.initData.get(i.value);return g||(t.messagesBySession.get(i.value)||[]).find(h=>h.type==="system"&&(h.subtype==="init"||h.metadata?.subtype==="init")&&h.metadata?.init_data)?.metadata?.init_data||null});function d(g){return g?f[g]||g:"Default (Sonnet 4.5)"}function k(g){return typeof g=="string"?g:typeof g=="object"&&g.type==="preset"?`Preset: ${g.preset}`:JSON.stringify(g,null,2)}function _(g){g.target.select()}function w(){i.value=null,a.value=!1}function b(){w(),o.hideModal()}return fe(()=>o.currentModal,g=>{if(g?.name==="session-info"&&m){const u=g.data||{};i.value=u.sessionId,a.value=!1,m.show()}}),ye(()=>{l.value&&Oe(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{m=new g(l.value),l.value.addEventListener("hidden.bs.modal",b)})}),Se(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",b),m&&m.dispose()}),(g,u)=>(r(),c("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",_C,[s("div",gC,[u[9]||(u[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",bC,[p.value?(r(),c("div",$C,[s("div",wC,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",kC,$(i.value),1)]),s("div",EC,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:_},null,8,SC)]),s("div",CC,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,$(d(p.value.model)),1)]),s("div",TC,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,$(p.value.permissionMode||"default"),1)]),s("div",xC,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(r(),c("div",AC,[s("div",OC,[(r(!0),c(ne,null,le(p.value.allowed_tools||p.value.tools,y=>(r(),c("span",{key:y,class:"badge bg-secondary"},$(y),1))),128))])])):(r(),c("div",MC,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(r(),c("div",DC,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",NC,[(r(!0),c(ne,null,le(p.value.commands,y=>(r(),c("span",{key:y,class:"badge bg-info"},$(y),1))),128))])])):x("",!0),p.value.systemPrompt?(r(),c("div",LC,[u[7]||(u[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",jC,$(k(p.value.systemPrompt)),1)])):x("",!0),s("div",IC,[s("h6",PC,[u[8]||(u[8]=ee(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:u[0]||(u[0]=y=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(r(),c("pre",RC,$(JSON.stringify(p.value,null,2)),1)):x("",!0)])])):(r(),c("div",yC," No session configuration data available "))]),u[10]||(u[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},HC=Z(WC,[["__scopeId","data-v-b28b39b3"]]),BC={class:"modal-dialog modal-dialog-centered modal-lg"},FC={class:"modal-content"},VC={class:"modal-body"},UC={key:0,class:"text-center text-muted py-4"},qC={key:1},zC={class:"mb-3"},KC={class:"mb-3"},GC={class:"font-monospace small"},YC={class:"mb-3"},JC={class:"mb-3"},QC={class:"mb-3"},XC={key:0},ZC={class:"d-flex flex-wrap gap-1"},eT={key:1,class:"text-muted small"},tT={class:"mb-3"},sT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},nT={key:1,class:"text-muted small"},oT={class:"mb-3"},iT={key:0,class:"badge bg-info"},aT={key:1,class:"badge bg-secondary"},rT={class:"mb-3"},lT={key:0,class:"font-monospace small"},cT={key:1,class:"text-muted small"},uT={key:0,class:"mb-3"},dT={key:0},mT={class:"list-unstyled mb-0"},pT={key:1,class:"text-muted small"},fT={class:"mb-3"},vT={class:"small"},hT={class:"mb-3"},_T={class:"small"},gT={__name:"MinionViewModal",setup(n){const e=ve(),t=R(null),o=R(null);let i=null;function a(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function l(p){if(!p)return"N/A";try{const d=new Date(p);return isNaN(d.getTime())?"Invalid date":d.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(d){return console.error("Error formatting timestamp:",d),"Invalid date"}}function m(){t.value=null}function f(){m(),e.hideModal()}return fe(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&i){const d=p.data||{};t.value=d.session,i.show()}}),ye(()=>{o.value&&Oe(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{i=new p(o.value),o.value.addEventListener("hidden.bs.modal",f)})}),Se(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",f),i&&i.dispose()}),(p,d)=>(r(),c("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",BC,[s("div",FC,[d[11]||(d[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",VC,[t.value?(r(),c("div",qC,[s("div",zC,[d[0]||(d[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,$(t.value.name||"Unnamed Minion"),1)]),s("div",KC,[d[1]||(d[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",GC,$(t.value.session_id),1)]),s("div",YC,[d[2]||(d[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,$(t.value.role||"Not specified"),1)]),s("div",JC,[d[3]||(d[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:X(["badge",a(t.value.state)])},$(t.value.state),3)])]),s("div",QC,[d[4]||(d[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(r(),c("div",XC,[s("div",ZC,[(r(!0),c(ne,null,le(t.value.capabilities,k=>(r(),c("span",{key:k,class:"badge bg-secondary"},$(k),1))),128))])])):(r(),c("div",eT,"None"))]),s("div",tT,[d[5]||(d[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(r(),c("div",sT,$(t.value.initialization_context),1)):(r(),c("div",nT,"Not specified"))]),s("div",oT,[d[6]||(d[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(r(),c("span",iT,"Yes")):(r(),c("span",aT,"No"))])]),s("div",rT,[d[7]||(d[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(r(),c("div",lT,$(t.value.parent_overseer_id),1)):(r(),c("div",cT," Root overseer (user-created) "))]),t.value.is_overseer?(r(),c("div",uT,[d[8]||(d[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(r(),c("div",dT,[s("ul",mT,[(r(!0),c(ne,null,le(t.value.child_minion_ids,k=>(r(),c("li",{key:k,class:"font-monospace small"},$(k),1))),128))])])):(r(),c("div",pT,"No children"))])):x("",!0),s("div",fT,[d[9]||(d[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",vT,$(l(t.value.created_at)),1)]),s("div",hT,[d[10]||(d[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",_T,$(l(t.value.updated_at)),1)])])):(r(),c("div",UC," No minion data available "))]),d[12]||(d[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},bT=Z(gT,[["__scopeId","data-v-d996dc6f"]]),yT={class:"container-fluid vh-100 d-flex flex-column p-0"},$T={class:"d-flex flex-grow-1 overflow-hidden position-relative"},wT={class:"flex-grow-1 d-flex flex-column overflow-hidden"},kT={__name:"App",setup(n){const e=ve(),t=et(),o=de(),i=Le(),a=Rt(),l=Wt(),m=v(()=>e.sidebarCollapsed),f=v(()=>e.rightSidebarCollapsed),p=v(()=>e.isMobile);fe(()=>a.currentHasTasks,(w,b)=>{w&&!b&&e.setRightSidebarCollapsed(!1)}),ye(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const w=window.location.hash;if(w.startsWith("#/session/")){const b=w.replace("#/session/","");o.sessions.has(b)&&await o.selectSession(b)}else if(w.startsWith("#/timeline/")){const b=w.replace("#/timeline/","");l.push(`/timeline/${b}`)}window.addEventListener("popstate",d),window.addEventListener("resize",e.handleResize)}),Se(()=>{window.removeEventListener("popstate",d),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function d(){const w=window.location.hash;if(w.startsWith("#/session/")){const b=w.replace("#/session/","");o.sessions.has(b)&&o.selectSession(b)}}function k(){e.toggleSidebar()}function _(){e.toggleRightSidebar()}return(w,b)=>{const g=co("router-view");return r(),c("div",yT,[pe(J1),s("div",{id:"sidebar-backdrop",class:X({show:!m.value&&p.value}),onClick:k},null,2),s("div",{id:"right-sidebar-backdrop",class:X({show:!f.value&&p.value}),onClick:_},null,2),s("div",$T,[pe(C$),s("main",wT,[pe(g)]),pe(sw)]),pe(bw),pe(jw),pe(nk),pe(qS),pe(hC),pe(HC),pe(bT)])}}},ln=ki(kT);ln.use(Ei());ln.use(B1);ln.mount("#app");
