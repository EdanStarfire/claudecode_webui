const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-BK1Vt_in.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as s,o as u,d as Et,r as L,b as g,t as $,n as pt,e as ee,f as oe,u as es,w as le,g as hs,F as re,h as ce,i as M,j as ge,k as tn,l as ne,v as ue,m as Xe,p as he,q as de,s as ve,x as mi,y as Ps,z as _e,A as Pe,B as sn,C as Ct,D as pi,E as fi,G as ft,H as vi,I as hi}from"./vue-vendor-CpnrLznN.js";import{m as tt,p as is}from"./markdown-vendor-BRsjnVvP.js";import{c as _i}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const gi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},bi={__name:"NoSessionSelected",setup(o){return(e,t)=>(u(),m("div",gi,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},yi="modulepreload",wi=function(o){return"/"+o},mo={},be=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let f=function(h){return Promise.all(h.map(r=>Promise.resolve(r).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=f(t.map(h=>{if(h=wi(h),h in mo)return;mo[h]=!0;const r=h.endsWith(".css"),y=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const v=document.createElement("link");if(v.rel=r?"stylesheet":yi,r||(v.as="script"),v.crossOrigin="",v.href=h,c&&v.setAttribute("nonce",c),document.head.appendChild(v),r)return new Promise((p,b)=>{v.addEventListener("load",p),v.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};class _s extends Error{constructor(e,t,n){super(e),this.name="APIError",this.status=t,this.data=n}}async function It(o,e={}){try{const t=await fetch(o,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new _s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const n=t.headers.get("content-type");return n&&n.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof _s?t:(console.error("API request failed:",t),new _s(`Network error: ${t.message}`,0,null))}}async function $i(o,e={}){let t=o;if(e.params){const n=new URLSearchParams;for(const[c,f]of Object.entries(e.params))f!=null&&n.append(c,f);const i=n.toString();i&&(t=`${o}?${i}`);const{params:a,...l}=e;return It(t,{...l,method:"GET"})}return It(t,{...e,method:"GET"})}async function Ei(o,e,t={}){return It(o,{...t,method:"POST",body:JSON.stringify(e)})}async function Ci(o,e,t={}){return It(o,{...t,method:"PUT",body:JSON.stringify(e)})}async function Si(o,e={}){return It(o,{...e,method:"DELETE"})}const ie={get:$i,post:Ei,put:Ci,delete:Si},ae=Et("session",()=>{const o=L(new Map),e=L(null),t=L(new Map),n=L(new Map),i=L(new Set),a=L(!1);let l=null;const c=g(()=>o.value.get(e.value)),f=g(()=>Array.from(o.value.values()).sort((O,F)=>O.order-F.order)),h=O=>g(()=>f.value.filter(F=>F.project_id===O)),r=g({get:()=>t.value.get(e.value)||"",set:O=>{e.value&&t.value.set(e.value,O)}});async function y(){try{const O=await ie.get("/api/sessions");return o.value.clear(),O.sessions.forEach(F=>{o.value.set(F.session_id,F)}),console.log(`Loaded ${o.value.size} sessions`),O.sessions}catch(O){throw console.error("Failed to fetch sessions:",O),O}}async function v(O,F){try{const I=(await ie.post("/api/sessions",{project_id:O,...F})).session_id,B=(await ie.get(`/api/sessions/${I}`)).session;return o.value.set(I,B),o.value=new Map(o.value),console.log(`Created session ${I}`),B}catch(A){throw console.error("Failed to create session:",A),A}}async function p(O){if(e.value===O&&!a.value)return;l&&(console.log(`Aborting pending selection to switch to ${O}`),l.abort(),l=null);const F=new AbortController;l=F,a.value=!0;try{if(e.value=O,F.signal.aborted){console.log(`Selection of ${O} aborted early`);return}let A=o.value.get(O);if(!A)try{const B=await ie.get(`/api/sessions/${O}`);if(F.signal.aborted){console.log(`Selection of ${O} aborted after fetch`);return}A=B.session,o.value.set(O,A),o.value=new Map(o.value),console.log(`Fetched session ${O} for deeplink`)}catch(B){console.error(`Failed to fetch session ${O}:`,B);return}if(A&&(A.state==="created"||A.state==="terminated"))try{if(await C(O),F.signal.aborted){console.log(`Selection of ${O} aborted after start`);return}console.log(`Auto-started session ${O} (was in ${A.state} state)`);const B=6e4,k=200,E=5e3;let N=0,x=0;for(;N<B;){if(F.signal.aborted){console.log(`Selection of ${O} aborted during state wait`);return}const j=o.value.get(O);if(j&&j.state==="active"){console.log(`Session ${O} is now active after ${N}ms`);break}if(N-x>=E){const q=o.value.get(O)?.state||"unknown";console.log(`Waiting for session ${O} to become active (current: ${q}, ${N/1e3}s elapsed)`),x=N}await new Promise(q=>setTimeout(q,k)),N+=k}const T=o.value.get(O);T&&T.state!=="active"&&console.warn(`Session ${O} did not become active within ${B/1e3}s (state: ${T.state}), continuing anyway`)}catch(B){console.error(`Failed to auto-start session ${O}:`,B)}if(F.signal.aborted){console.log(`Selection of ${O} aborted before message load`);return}if(await(await be(()=>Promise.resolve().then(()=>qi),void 0)).useMessageStore().loadMessages(O),F.signal.aborted){console.log(`Selection of ${O} aborted after message load`);return}await(await be(()=>Promise.resolve().then(()=>ma),void 0)).useWebSocketStore().connectSession(O),F.signal.aborted||console.log(`Selected session ${O}`)}finally{l===F&&(l=null),a.value=!1}}function b(O,F){const A=o.value.get(O);A?Object.assign(A,F):(o.value.set(O,F),console.log(`Added new session ${O} via WebSocket update`)),o.value=new Map(o.value)}async function w(O){i.value.add(O);try{const A=(await ie.delete(`/api/sessions/${O}`)).deleted_session_ids||[O];for(const I of A)o.value.delete(I),t.value.delete(I),n.value.delete(I);return o.value=new Map(o.value),A.includes(e.value)&&(e.value=null),console.log(`Deleted ${A.length} session(s): ${A.join(", ")}`),A}catch(F){throw console.error("Failed to delete session:",F),F}finally{i.value.delete(O)}}async function d(O,F){try{await ie.put(`/api/sessions/${O}/name`,{name:F}),b(O,{name:F}),console.log(`Updated session ${O} name to "${F}"`)}catch(A){throw console.error("Failed to update session name:",A),A}}async function _(O,F){try{await ie.post(`/api/sessions/${O}/permission-mode`,{mode:F}),b(O,{current_permission_mode:F});const A=n.value.get(O);A&&(A.permissionMode=F,n.value.set(O,A)),console.log(`Set permission mode for session ${O} to ${F}`)}catch(A){throw console.error("Failed to set permission mode:",A),A}}async function C(O){try{await ie.post(`/api/sessions/${O}/start`),console.log(`Started session ${O}`)}catch(F){throw console.error("Failed to start session:",F),F}}async function S(O){try{await ie.post(`/api/sessions/${O}/pause`),console.log(`Paused session ${O}`)}catch(F){throw console.error("Failed to pause session:",F),F}}async function D(O){try{await ie.post(`/api/sessions/${O}/terminate`),console.log(`Terminated session ${O}`)}catch(F){throw console.error("Failed to terminate session:",F),F}}function V(O){return o.value.get(O)}function P(O,F){n.value.set(O,F),F.permissionMode&&b(O,{current_permission_mode:F.permissionMode})}return{sessions:o,currentSessionId:e,inputCache:t,initData:n,deletingSessions:i,currentSession:c,orderedSessions:f,sessionsInProject:h,currentInput:r,fetchSessions:y,createSession:v,selectSession:p,updateSession:b,deleteSession:w,updateSessionName:d,setPermissionMode:_,startSession:C,pauseSession:S,terminateSession:D,getSession:V,storeInitData:P}}),po=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ae},Symbol.toStringTag,{value:"Module"})),me=Et("ui",()=>{const o=L(window.innerWidth<768),e=L(300),t=L(window.innerWidth),n=g(()=>t.value<768),i=L(!0),a=L(null),l=L(null),c=g(()=>a.value?{name:a.value,data:l.value}:null),f=L(!1),h=L("Loading...");function r(){o.value=!o.value}function y(S){o.value=S}function v(S){e.value=Math.max(200,Math.min(S,window.innerWidth*.3))}function p(S){i.value=S}function b(S,D=null){a.value=null,l.value=null,setTimeout(()=>{a.value=S,l.value=D},0)}function w(){a.value=null,l.value=null}function d(S="Loading..."){f.value=!0,h.value=S}function _(){f.value=!1}function C(){const S=t.value;t.value=window.innerWidth,t.value<768&&S>=768?o.value=!0:t.value>=768&&S<768&&(o.value=!1)}return{sidebarCollapsed:o,sidebarWidth:e,isMobile:n,autoScrollEnabled:i,activeModal:a,modalData:l,currentModal:c,isLoading:f,loadingMessage:h,toggleSidebar:r,setSidebarCollapsed:y,setSidebarWidth:v,setAutoScroll:p,showModal:b,hideModal:w,showLoading:d,hideLoading:_,handleResize:C}}),ke=Et("project",()=>{const o=L(new Map),e=L(null),t=g(()=>o.value.get(e.value)),n=g(()=>Array.from(o.value.values()).sort((d,_)=>d.order-_.order));async function i(){try{const d=await ie.get("/api/projects");return o.value.clear(),d.projects.forEach(_=>{o.value.set(_.project_id,_)}),console.log(`Loaded ${o.value.size} projects`),d.projects}catch(d){throw console.error("Failed to fetch projects:",d),d}}async function a(d,_){try{const S=(await ie.post("/api/projects",{name:d,working_directory:_})).project;return o.value.set(S.project_id,S),o.value=new Map(o.value),console.log(`Created project ${S.project_id}`),S}catch(C){throw console.error("Failed to create project:",C),C}}async function l(d,_){try{await ie.put(`/api/projects/${d}`,_),c(d,_),console.log(`Updated project ${d}`,_)}catch(C){throw console.error("Failed to update project:",C),C}}function c(d,_){const C=o.value.get(d);C&&(Object.assign(C,_),o.value=new Map(o.value))}async function f(d){try{await ie.delete(`/api/projects/${d}`),o.value.delete(d),o.value=new Map(o.value),e.value===d&&(e.value=null),console.log(`Deleted project ${d}`)}catch(_){throw console.error("Failed to delete project:",_),_}}async function h(d){try{const _=await ie.put(`/api/projects/${d}/toggle-expansion`),C=o.value.get(d);return C&&(C.is_expanded=_.is_expanded,o.value=new Map(o.value)),_.is_expanded}catch(_){throw console.error("Failed to toggle expansion:",_),_}}async function r(d){try{await ie.put("/api/projects/reorder",{project_ids:d}),d.forEach((_,C)=>{const S=o.value.get(_);S&&(S.order=C)}),o.value=new Map(o.value),console.log("Reordered projects",d)}catch(_){throw console.error("Failed to reorder projects:",_),_}}async function y(d,_){try{await ie.put(`/api/projects/${d}/sessions/reorder`,{session_ids:_});const C=o.value.get(d);C&&(C.session_ids=_,o.value=new Map(o.value)),console.log(`Reordered sessions in project ${d}`,_)}catch(C){throw console.error("Failed to reorder sessions:",C),C}}function v(d){return o.value.get(d)}function p(d){e.value=d}function b(){e.value=null}function w(d){if(!d)return"";const _=d.split(/[/\\]/).filter(C=>C);return _.length===0?"/":_.length===1?`/${_[0]}`:_.length===2?`/${_.join("/")}`:`.../${_.slice(-2).join("/")}`}return{projects:o,currentProjectId:e,currentProject:t,orderedProjects:n,fetchProjects:i,createProject:a,updateProject:l,updateProjectLocal:c,deleteProject:f,toggleExpansion:h,reorderProjects:r,reorderSessionsInProject:y,getProject:v,selectProject:p,clearProjectSelection:b,formatPath:w}}),te=(o,e)=>{const t=o.__vccOpts||o;for(const[n,i]of e)t[n]=i;return t},ki={class:"session-header border-bottom p-3"},Ti={class:"project-name"},xi=["title"],Ai={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(o){const e=o,t=ae(),n=ke(),i=g(()=>t.sessions.get(e.sessionId)),a=g(()=>i.value?.name||e.sessionId),l=g(()=>{for(const f of n.projects.values())if(f.session_ids?.includes(e.sessionId))return f;return null}),c=g(()=>l.value?.name||"Unknown Project");return(f,h)=>(u(),m("div",ki,[s("div",null,[s("div",Ti,$(c.value),1),s("div",{class:"session-name",title:o.sessionId},$(a.value),9,xi)])]))}},Mi=te(Ai,[["__scopeId","data-v-89e9c269"]]),Oi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ni=["title"],Di={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Li={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(o){const e=o,t=ae(),n=g(()=>t.sessions.get(e.sessionId)),i=g(()=>n.value?n.value.state==="paused"&&n.value.is_processing?"pending-prompt":n.value.is_processing?"processing":n.value.state:"unknown"),a=g(()=>{const f=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[f]||"#d3d3d3"}),l=g(()=>{const f=i.value;return f==="starting"||f==="processing"||f==="pending-prompt"}),c=g(()=>{if(!n.value)return"No session selected";const f=i.value,h=f.charAt(0).toUpperCase()+f.slice(1).replace("-"," "),r=n.value.name||"Unnamed Session",y=n.value.role?` (${n.value.role})`:"";return`${r}${y}: ${h}`});return(f,h)=>(u(),m("div",Oi,[n.value?(u(),m("div",{key:0,class:ee(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:pt({width:"100%",backgroundColor:a.value}),title:c.value},null,14,Ni)):(u(),m("div",Di))]))}},Ii=te(Li,[["__scopeId","data-v-63d222fe"]]),Pi={class:"session-status-bar border-top p-2 bg-light"},ji={class:"d-flex justify-content-between align-items-center gap-2"},Ri={class:"d-flex gap-2"},Wi=["disabled"],Vi={class:"mode-label"},Hi=["disabled"],Fi=["disabled"],Bi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(o){const e=o,t=ae(),n=me(),i=g(()=>t.sessions.get(e.sessionId)),a=g(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},c=g(()=>l[a.value]||"ðŸ”’"),f=g(()=>a.value),h=["default","acceptEdits","plan"],r=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(_){console.error("Failed to cycle permission mode:",_)}return}const w=(h.indexOf(a.value)+1)%h.length,d=h[w];try{await t.setPermissionMode(e.sessionId,d)}catch(_){console.error("Failed to cycle permission mode:",_)}},y=()=>{n.showModal("session-info",{sessionId:e.sessionId})},v=()=>{n.showModal("manage-session",{session:i.value})},p=()=>{n.setAutoScroll(!n.autoScrollEnabled)};return(b,w)=>(u(),m("div",Pi,[s("div",ji,[s("div",Ri,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:r,disabled:!i.value},[oe($(c.value)+" ",1),s("span",Vi,$(f.value),1)],8,Wi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:y,disabled:!i.value},[...w[0]||(w[0]=[oe(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Hi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:v,disabled:!i.value},[...w[1]||(w[1]=[oe(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,Fi)]),s("div",null,[s("button",{class:ee(["btn btn-sm",es(n).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:p}," â¬‡ï¸ "+$(es(n).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Ui=te(Bi,[["__scopeId","data-v-fdcd3535"]]),xe=Et("message",()=>{const o=L(new Map),e=L(new Map),t=L(new Map),n=L(new Map),i=L(new Map),a=L(new Map),l=L(new Map),c=L(new Map),f=g(()=>{const x=ae();return o.value.get(x.currentSessionId)||[]}),h=g(()=>{const x=ae();return e.value.get(x.currentSessionId)||[]});async function r(x,T=null,j=0){try{const q=T||1e4,Y=await ie.get(`/api/sessions/${x}/messages?limit=${q}&offset=${j}`),Q=Y.messages||[],G=Y.total_count||Q.length,R=Y.has_more||!1;if(console.log(`Loaded ${Q.length} of ${G} messages for session ${x}`),o.value.set(x,Q),Q.length>0){const W=Q[Q.length-1];W.timestamp&&(l.value.set(x,W.timestamp),console.log(`Tracked last received timestamp for session ${x}: ${W.timestamp}`))}const J=new Set;Q.forEach(W=>{W.type==="assistant"&&W.metadata?.tool_uses&&W.metadata.tool_uses.forEach(H=>{J.add(H.id)}),W.type==="user"&&W.metadata?.tool_results&&W.metadata.tool_results.forEach(H=>{J.delete(H.tool_use_id);const X=a.value.get(x);X&&X.delete(H.tool_use_id)}),W.type==="system"&&W.metadata?.subtype==="client_launched"&&(J.forEach(H=>{F(x,H,"Session was restarted")}),J.clear()),W.type==="system"&&W.metadata?.subtype==="interrupt"&&(J.forEach(H=>{F(x,H,"Session was interrupted")}),J.clear()),W.metadata?.has_tool_uses&&W.metadata.tool_uses&&W.metadata.tool_uses.forEach(H=>{w(x,H)}),W.metadata?.has_tool_results&&W.metadata.tool_results&&W.metadata.tool_results.forEach(H=>{C(x,H)}),(W.type==="permission_request"||W.metadata?.has_permission_requests)&&d(x,W),W.type==="system"&&(W.subtype==="init"||W.metadata?.subtype==="init")&&W.metadata?.init_data&&ae().storeInitData(x,W.metadata.init_data)});const z=ae().sessions.get(x);return z&&!["active","paused","starting"].includes(z.state)&&(J.forEach(W=>{F(x,W,"Session was terminated")}),J.clear()),i.value.set(x,J),o.value=new Map(o.value),R&&console.warn(`Warning: Only loaded ${Q.length} of ${G} messages. Some messages may be missing.`),{messages:Q,totalCount:G,hasMore:R}}catch(q){throw console.error("Failed to load messages:",q),q}}function y(x,T){const j=i.value.get(x)||new Set;T.type==="assistant"&&T.metadata?.tool_uses&&T.metadata.tool_uses.forEach(q=>{j.add(q.id)}),T.type==="user"&&T.metadata?.tool_results&&T.metadata.tool_results.forEach(q=>{j.delete(q.tool_use_id);const Y=a.value.get(x);Y&&Y.delete(q.tool_use_id)}),T.type==="system"&&T.metadata?.subtype==="client_launched"&&(j.forEach(q=>{F(x,q,"Session was restarted")}),j.clear()),T.type==="system"&&T.metadata?.subtype==="interrupt"&&(j.forEach(q=>{F(x,q,"Session was interrupted")}),j.clear()),i.value.set(x,j)}function v(x,T){o.value.has(x)||o.value.set(x,[]);const j=o.value.get(x);if(T.id){const q=j.findIndex(Y=>Y.id===T.id);if(q!==-1){console.log(`Skipping duplicate message ${T.id} (already exists at index ${q})`);return}}j.push(T),T.timestamp&&l.value.set(x,T.timestamp),V(x,T),y(x,T),o.value=new Map(o.value)}function p(x,T){e.value.has(x)||e.value.set(x,[]),e.value.get(x).push(T),e.value=new Map(e.value)}function b(x,T,j){const q=e.value.get(x);if(q){const Y=q.find(Q=>Q.id===T);Y&&(Object.assign(Y,j),e.value=new Map(e.value))}}function w(x,T){const j=D(T.name,T.input);t.value.set(j,T.id);const q={id:T.id,name:T.name,input:T.input,signature:j,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return p(x,q),console.log(`Created tool call ${q.id} for ${q.name}`),q}function d(x,T){console.log("handlePermissionRequest received:",T);const j=T.metadata?.tool_name||T.tool_name,q=T.metadata?.input_params||T.input_params,Y=T.metadata?.request_id||T.request_id,Q=T.metadata?.suggestions||T.suggestions||[];console.log("Extracted data:",{toolName:j,inputParams:q,requestId:Y,suggestions:Q});const G=D(j,q),R=t.value.get(G);R?(n.value.set(Y,R),b(x,R,{status:"permission_required",permissionRequestId:Y,suggestions:Q}),console.log(`Permission required for tool ${R}`,{suggestions:Q})):console.warn("No tool use ID found for permission request signature:",G,{toolName:j,inputParams:q,availableSignatures:Array.from(t.value.keys())})}function _(x,T){const j=n.value.get(T.request_id);if(j){const q={permissionDecision:T.decision,appliedUpdates:T.applied_updates||[]};T.decision==="allow"?q.status="executing":(q.status="completed",q.result={error:!0,message:T.reasoning||"Permission denied"},q.isExpanded=!1),b(x,j,q),console.log(`Permission ${T.decision} for tool ${j}`)}}function C(x,T){const j=T.tool_use_id;b(x,j,{status:T.is_error?"error":"completed",result:{error:T.is_error,content:T.content},isExpanded:!1}),console.log(`Tool ${j} ${T.is_error?"failed":"completed"}`)}function S(x,T){const j=e.value.get(x);if(j){const q=j.find(Y=>Y.id===T);q&&(q.isExpanded=!q.isExpanded,e.value=new Map(e.value))}}function D(x,T){if(!x)return"unknown:{}";if(!T||typeof T!="object")return`${x}:{}`;const j=JSON.stringify(T,Object.keys(T).sort());return`${x}:${j}`}function V(x,T){const j=T.metadata?.display||T.display;if(!j)return;c.value.has(x)||c.value.set(x,new Map);const q=c.value.get(x);if(j.tool_states)for(const[Y,Q]of Object.entries(j.tool_states)){q.set(Y,Q);const G=e.value.get(x);if(G){const R=G.find(J=>J.id===Y);if(R){const J={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};R.status=J[Q.state]||Q.state,R.backendState=Q}}}if(j.orphaned_tools&&j.orphaned_tools.length>0){const Y=a.value.get(x)||new Map;for(const Q of j.orphaned_tools)Y.has(Q)||Y.set(Q,{reason:"denied",message:"Session was interrupted"});a.value.set(x,Y)}if(j.linked_permissions)for(const[Y,Q]of Object.entries(j.linked_permissions))n.value.set(Y,Q);j.tool_states&&Object.keys(j.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${x}:`,{toolStates:Object.keys(j.tool_states||{}).length,orphanedTools:(j.orphaned_tools||[]).length,linkedPermissions:Object.keys(j.linked_permissions||{}).length})}function P(x,T){return c.value.get(x)?.get(T)}function O(x){const T=c.value.get(x);return T&&T.size>0}function F(x,T,j){const q=a.value.get(x)||new Map;q.set(T,{reason:"denied",message:j}),a.value.set(x,q);const Y=e.value.get(x);if(Y){const Q=Y.find(G=>G.id===T);Q&&Q.isExpanded&&(Q.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${T} as orphaned: ${j}`)}function A(x,T){const j=P(x,T);return j&&j.state==="orphaned"?!0:a.value.get(x)?.has(T)||!1}function I(x,T){const j=P(x,T);return j&&j.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:j}:a.value.get(x)?.get(T)}function K(x,T){const j=i.value.get(x);j&&j.size>0&&(j.forEach(q=>F(x,q,T)),j.clear())}function B(x){o.value.delete(x),e.value.delete(x),o.value=new Map(o.value),e.value=new Map(e.value)}function k(x){return l.value.get(x)}async function E(x){const T=l.value.get(x);if(!T)return console.log(`No sync needed for session ${x} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${x} since ${T}`);const j=await ie.get(`/api/sessions/${x}/messages?limit=1000&offset=0`),q=j.messages||[],Y=j.has_more||!1,Q=H=>H?typeof H=="number"?H*1e3:new Date(H).getTime():0,G=Q(T),R=q.filter(H=>H.timestamp?Q(H.timestamp)>G:!1);if(R.length===0)return console.log(`No missed messages for session ${x}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${R.length} missed messages for session ${x}`);const J=o.value.get(x)||[],pe=new Set(J.map(H=>H.id).filter(Boolean)),z=R.filter(H=>!H.id||!pe.has(H.id));if(console.log(`After deduplication: ${z.length} unique new messages`),z.length>0){const H=z.sort((He,At)=>{const Mt=Q(He.timestamp),at=Q(At.timestamp);return Mt-at}),X=o.value.get(x)||[],se=X.length>0?Q(X[X.length-1].timestamp):0,fe=Q(H[0].timestamp),fs=Q(H[H.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:X.length,lastExisting:se,lastExistingDate:X.length>0?X[X.length-1].timestamp:"none",firstNew:fe,firstNewDate:H[0].timestamp,lastNew:fs,lastNewDate:H[H.length-1].timestamp,shouldAppend:fe>se}),fe>se){const He=[...X,...H];o.value.set(x,He),console.log(`âœ… Appended ${H.length} new messages (no full sort needed)`)}else{const He=[...X,...H].sort((At,Mt)=>{const at=Q(At.timestamp),Ft=Q(Mt.timestamp);return at-Ft});o.value.set(x,He),console.log(`âš ï¸ Merged and sorted ${H.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${J.length} messages unchanged`);z.forEach(H=>{y(x,H),H.metadata?.has_tool_uses&&H.metadata.tool_uses&&H.metadata.tool_uses.forEach(X=>{w(x,X)}),H.metadata?.has_tool_results&&H.metadata.tool_results&&H.metadata.tool_results.forEach(X=>{C(x,X)}),(H.type==="permission_request"||H.metadata?.has_permission_requests)&&d(x,H),H.type==="system"&&(H.subtype==="init"||H.metadata?.subtype==="init")&&H.metadata?.init_data&&ae().storeInitData(x,H.metadata.init_data)});const W=o.value.get(x);if(W&&W.length>0){const H=W[W.length-1];H.timestamp&&l.value.set(x,H.timestamp)}return o.value=new Map(o.value),{syncedCount:z.length,hasMore:Y}}catch(j){return console.error(`Failed to sync messages for session ${x}:`,j),{syncedCount:0,hasMore:!1,error:j.message}}}const N=ae();return le(()=>Array.from(N.sessions.values()).map(T=>({id:T.session_id,state:T.state})),(x,T)=>{T&&x.forEach((j,q)=>{const Y=T[q];if(!Y||Y.id!==j.id)return;const Q=["active","paused","starting"].includes(Y.state),G=!["active","paused","starting"].includes(j.state);Q&&G&&K(j.id,"Session was terminated")})},{deep:!0}),{messagesBySession:o,toolCallsBySession:e,activeToolUses:hs(i),orphanedToolUses:hs(a),currentMessages:f,currentToolCalls:h,loadMessages:r,addMessage:v,addToolCall:p,updateToolCall:b,handleToolUse:w,handlePermissionRequest:d,handlePermissionResponse:_,handleToolResult:C,toggleToolExpansion:S,clearMessages:B,markToolUseOrphaned:F,isToolUseOrphaned:A,getOrphanedInfo:I,clearOrphanedToolUses:K,getLastReceivedTimestamp:k,syncMessages:E,getBackendToolState:P,hasBackendDisplayMetadata:O,backendToolStates:hs(c)}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:xe},Symbol.toStringTag,{value:"Module"}));function zi(o){if(!o)return new Date;if(typeof o=="string"){const e=new Date(o);return isNaN(e.getTime())?new Date:e}return typeof o=="number"?o<1e10?new Date(o*1e3):new Date(o):new Date}function Pt(o){return zi(o).toLocaleTimeString()}const Ki={class:"message-row message-row-user"},Gi=["title"],Yi={class:"message-content-column"},Ji=["innerHTML"],Xi={key:0,class:"tool-results mt-2"},Qi={class:"tool-results-header text-muted small mb-2"},Zi={class:"d-flex align-items-start gap-2"},ea={class:"flex-grow-1"},ta={class:"text-muted"},sa={key:0,class:"text-danger small"},oa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(o){const e=o;tt.setOptions({breaks:!0,gfm:!0});const t=g(()=>Pt(e.message.timestamp)),n=g(()=>`user
${t.value}`),i=g(()=>{const f=e.message.content||"";let h=tt.parse(f);return h=h.replace(/\n</g,"<"),h=h.replace(/\n+$/,""),is.sanitize(h)}),a=g(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=g(()=>e.message.metadata?.tool_results||[]);function c(f,h){return f?f.length<=h?f:f.substring(0,h)+"...":""}return(f,h)=>(u(),m("div",Ki,[s("div",{class:"message-speaker",title:n.value},[...h[0]||(h[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,Gi),s("div",Yi,[s("div",{class:"message-text",innerHTML:i.value},null,8,Ji),a.value?(u(),m("div",Xi,[s("div",Qi," ðŸ”§ Tool Results ("+$(l.value.length)+") ",1),(u(!0),m(re,null,ce(l.value,(r,y)=>(u(),m("div",{key:y,class:ee(["tool-result-summary p-2 mb-2 rounded",r.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",Zi,[s("span",null,$(r.is_error?"âŒ":"âœ…"),1),s("div",ea,[s("small",ta,"Tool: "+$(r.tool_use_id),1),r.is_error?(u(),m("div",sa,$(c(r.content,200)),1)):M("",!0)])])],2))),128))])):M("",!0)])]))}},na=te(oa,[["__scopeId","data-v-7665755b"]]),ia={class:"thinking-block"},aa=["aria-label"],la={class:"text-muted ms-auto"},ra={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ca=["innerHTML"],ua={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(o){const e=o,t=L(!1),n=g(()=>e.thinking?.length||0),i=g(()=>{const l=e.thinking||"",c=tt.parse(l);return is.sanitize(c)});function a(){t.value=!t.value}return(l,c)=>(u(),m("div",ia,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("span",{"aria-label":t.value?"Collapse":"Expand"},$(t.value?"â–¾":"â–¸"),9,aa),c[0]||(c[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",la,$(n.value)+" characters",1)]),t.value?(u(),m("div",ra,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ca)])):M("",!0)]))}},da=te(ua,[["__scopeId","data-v-fda2352c"]]),ze=Et("websocket",()=>{const o=L(null),e=L(!1),t=L(0),n=10,i=L(null),a=L(!1),l=L(0),c=5,f=L(null);let h=null;const r=L(0),y=L(null),v=L(new Map),p=L(null),b=L(!1),w=L(0),d=5,_=L(null),C=1e4,S=1e3,D=L(Date.now()),V=L(Date.now()),P=L(Date.now());let O=null,F=null,A=null;const I=g(()=>e.value&&(a.value||!f.value)?"connected":e.value?"partial":"disconnected");function K(z){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${z}`}function B(z){const W={ui:{timer:()=>O,setTimer:H=>{O=H},lastPing:D,connected:e,name:"UI"},session:{timer:()=>F,setTimer:H=>{F=H},lastPing:V,connected:a,name:"Session"},legion:{timer:()=>A,setTimer:H=>{A=H},lastPing:P,connected:b,name:"Legion"}}[z];W.timer()&&clearInterval(W.timer()),W.setTimer(setInterval(()=>{if(!W.connected.value)return;const H=Date.now()-W.lastPing.value;if(H>C){console.warn(`âš ï¸ ${W.name} WebSocket heartbeat timeout (${H}ms since last ping) - forcing close to trigger reconnection`),W.connected.value=!1;const se={ui:o,session:i,legion:p}[z];se.value&&se.value.readyState===WebSocket.OPEN&&se.value.close()}},S)),console.log(`âœ… Started heartbeat monitor for ${W.name} WebSocket`)}function k(z){const W={ui:{get:()=>O,set:H=>{O=H}},session:{get:()=>F,set:H=>{F=H}},legion:{get:()=>A,set:H=>{A=H}}}[z];W.get()&&(clearInterval(W.get()),W.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${z} WebSocket`))}function E(){if(o.value)return;const z=K("/ws/ui");console.log(`Connecting to UI WebSocket: ${z}`),o.value=new WebSocket(z),o.value.onopen=()=>{e.value=!0,t.value=0,D.value=Date.now(),B("ui"),console.log("UI WebSocket connected")},o.value.onmessage=W=>{const H=JSON.parse(W.data);Q(H)},o.value.onclose=()=>{if(k("ui"),e.value=!1,o.value=null,console.log("UI WebSocket closed"),t.value<n){t.value++;const W=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${W}ms (attempt ${t.value})`),setTimeout(E,W)}},o.value.onerror=W=>{console.error("UI WebSocket error:",W)}}function N(){o.value&&(o.value.close(),o.value=null,e.value=!1)}async function x(z){r.value++;const W=r.value;if(console.log(`[Gen ${W}] Starting connection to session ${z}`),h&&(clearTimeout(h),h=null),await T(),r.value!==W){console.log(`[Gen ${W}] Connection cancelled (current generation: ${r.value})`);return}f.value=z,y.value=W;const H=K(`/ws/session/${z}`);console.log(`[Gen ${W}] Connecting to Session WebSocket: ${H}`),i.value=new WebSocket(H),i.value.onopen=async()=>{if(y.value!==W){console.log(`[Gen ${W}] Ignoring onopen (stale connection, current: ${y.value})`),i.value.close();return}a.value=!0,l.value=0,V.value=Date.now(),B("session"),console.log(`[Gen ${W}] Session WebSocket connected for ${z}`);const X=v.value.get(z);if(v.value.set(z,!0),X){console.log(`[Gen ${W}] Reconnection detected, syncing missed messages...`);try{const fe=await xe().syncMessages(z);fe.syncedCount>0?console.log(`[Gen ${W}] âœ… Synced ${fe.syncedCount} missed messages`):fe.error?console.warn(`[Gen ${W}] âš ï¸ Message sync failed: ${fe.error}`):console.log(`[Gen ${W}] No missed messages to sync`),fe.hasMore&&console.warn(`[Gen ${W}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(se){console.error(`[Gen ${W}] Error during message sync:`,se)}}else console.log(`[Gen ${W}] Initial connection, no sync needed`)},i.value.onmessage=X=>{if(y.value!==W){console.log(`[Gen ${W}] Ignoring message (stale connection, current: ${y.value})`);return}const se=JSON.parse(X.data);G(se,z)},i.value.onclose=()=>{k("session"),a.value=!1,i.value=null,console.log(`[Gen ${W}] Session WebSocket closed for ${z}`);const X=ae();if(X.currentSessionId===z&&y.value===W&&l.value<c){l.value++;const se=Math.min(2e3*l.value,3e4);console.log(`[Gen ${W}] Reconnecting Session WebSocket in ${se}ms (attempt ${l.value})`),h=setTimeout(()=>{y.value===W&&X.currentSessionId===z?(h=null,x(z)):console.log(`[Gen ${W}] Skipping reconnect (generation or session changed)`)},se)}},i.value.onerror=X=>{console.error(`[Gen ${W}] Session WebSocket error:`,X)}}function T(){return new Promise(z=>{if(h&&(clearTimeout(h),h=null,console.log("Cancelled pending session reconnect timer")),i.value){const W=f.value,H=()=>{i.value=null,a.value=!1,f.value=null,y.value=null,l.value=0,W&&v.value.delete(W),z()};if(i.value.readyState===WebSocket.CLOSED)H();else{const X=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),H()},2e3);i.value.addEventListener("close",()=>{clearTimeout(X),H()},{once:!0}),i.value.close()}}else f.value=null,y.value=null,z()})}function j(z){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:z})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function q(z,W,H=!1,X=null){if(i.value&&a.value){const se={type:"permission_response",request_id:z,decision:W,apply_suggestions:H,timestamp:new Date().toISOString()};X&&(se.clarification_message=X),i.value.send(JSON.stringify(se)),console.log(`Sent permission ${W} for request ${z}`,{applySuggestions:H,clarification:X})}}function Y(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function Q(z){const W=ae(),H=ke();switch(z.type){case"sessions_list":z.sessions&&Array.isArray(z.sessions)&&z.sessions.forEach(X=>{W.updateSession(X.session_id,X)});break;case"state_change":z.data&&z.data.session_id&&z.data.session&&W.updateSession(z.data.session_id,z.data.session);break;case"project_updated":if(z.data&&z.data.project){const X=z.data.project;H.updateProjectLocal(X.project_id,X),W.fetchSessions()}break;case"project_deleted":z.data&&z.data.project_id&&H.projects.delete(z.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":D.value=Date.now(),o.value?.readyState===WebSocket.OPEN&&o.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",z.type)}}function G(z,W){const H=ae();if(H.currentSessionId!==W){console.warn(`Ignoring message for session ${W} (current: ${H.currentSessionId})`);return}const X=xe();switch(z.type){case"message":const se=z.data;if(!se||!se.type){console.warn("Received message event with invalid data:",z);break}if(se.type==="permission_request"){X.handlePermissionRequest(W,se);break}if(se.type==="permission_response"){X.handlePermissionResponse(W,se);break}se.metadata?.has_tool_uses&&se.metadata.tool_uses.forEach(fe=>{X.handleToolUse(W,fe)}),se.metadata?.has_tool_results&&se.metadata.tool_results.forEach(fe=>{X.handleToolResult(W,fe)}),se.type==="system"&&(se.subtype==="init"||se.metadata?.subtype==="init")&&se.metadata?.init_data&&H.storeInitData(W,se.metadata.init_data),X.addMessage(W,se);break;case"permission_request":X.handlePermissionRequest(W,z);break;case"permission_response":X.handlePermissionResponse(W,z);break;case"tool_result":X.handleToolResult(W,z);break;case"state_change":H.updateSession(W,z.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${W}`);break;case"ping":V.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",z.type)}}function R(z){J(),_.value=z;const W=K(`/ws/legion/${z}`);console.log(`Connecting to Legion WebSocket: ${W}`),p.value=new WebSocket(W),p.value.onopen=()=>{b.value=!0,w.value=0,P.value=Date.now(),B("legion"),console.log(`Legion WebSocket connected for ${z}`)},p.value.onmessage=H=>{const X=JSON.parse(H.data);pe(X,z)},p.value.onclose=()=>{if(k("legion"),b.value=!1,p.value=null,console.log(`Legion WebSocket closed for ${z}`),_.value===z&&w.value<d){w.value++;const H=Math.min(2e3*w.value,3e4);setTimeout(()=>R(z),H)}},p.value.onerror=H=>{console.error("Legion WebSocket error:",H)}}function J(){p.value&&(p.value.close(),p.value=null,b.value=!1,_.value=null)}function pe(z,W){be(async()=>{const{useLegionStore:H}=await Promise.resolve().then(()=>o_);return{useLegionStore:H}},void 0).then(({useLegionStore:H})=>{const X=H();switch(z.type){case"comm":z.comm&&(X.addComm(W,z.comm),console.log("Legion WebSocket: Received new comm",z.comm));break;case"minion_created":z.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",z.data),be(async()=>{const{useSessionStore:se}=await Promise.resolve().then(()=>po);return{useSessionStore:se}},void 0).then(({useSessionStore:se})=>{se().loadSessions()}));break;case"minion_updated":z.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",z.data),be(async()=>{const{useSessionStore:se}=await Promise.resolve().then(()=>po);return{useSessionStore:se}},void 0).then(({useSessionStore:se})=>{se().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${W}`);break;case"ping":P.value=Date.now(),p.value?.readyState===WebSocket.OPEN&&p.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",z.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:a,sessionRetryCount:l,legionConnected:b,legionRetryCount:w,overallStatus:I,connectUI:E,disconnectUI:N,connectSession:x,disconnectSession:T,sendMessage:j,sendPermissionResponse:q,interruptSession:Y,connectLegion:R,disconnectLegion:J}}),ma=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ze},Symbol.toStringTag,{value:"Module"})),pa={class:"base-tool-handler"},fa={class:"tool-section"},va={class:"tool-parameters"},ha={class:"tool-code"},_a={key:0,class:"tool-section"},ga={class:"tool-section-label"},ba={class:"tool-code"},ya={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),n=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=g(()=>{if(!n.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,c)=>(u(),m("div",pa,[s("div",fa,[c[0]||(c[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",va,[s("pre",ha,$(t.value),1)])]),n.value?(u(),m("div",_a,[s("div",ga,$(i.value?"Error:":"Result:"),1),s("div",{class:ee(["tool-result",{"tool-result-error":i.value}])},[s("pre",ba,$(a.value),1)],2)])):M("",!0)]))}},wa=te(ya,[["__scopeId","data-v-1e69f57d"]]),$a={class:"read-tool-handler"},Ea={class:"tool-section"},Ca={class:"read-file-info"},Sa={class:"file-path"},ka={key:0,class:"read-range"},Ta={key:0,class:"tool-section"},xa={key:0,class:"tool-result tool-result-error"},Aa={class:"tool-code"},Ma={key:1,class:"file-content-preview"},Oa={class:"content-header"},Na={class:"line-count-badge"},Da={key:0,class:"preview-note"},La={class:"tool-code content-display"},Ia={key:0,class:"more-indicator"},gs=100,Pa={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?.file_path||"Unknown"),n=g(()=>{const p=e.toolCall.input?.offset,b=e.toolCall.input?.limit;return p!==void 0||b!==void 0}),i=g(()=>{const p=e.toolCall.input?.offset;return p!==void 0?p+1:1}),a=g(()=>{const p=e.toolCall.input?.offset||0,b=e.toolCall.input?.limit;return b!==void 0?p+b:"âˆž"}),l=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=g(()=>{if(!l.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),h=g(()=>c.value||!f.value?[]:f.value.split(`
`)),r=g(()=>h.value.length),y=g(()=>r.value>gs),v=g(()=>c.value?"":h.value.slice(0,gs).join(`
`));return(p,b)=>(u(),m("div",$a,[s("div",Ea,[s("div",Ca,[b[0]||(b[0]=s("span",{class:"file-icon"},"ðŸ“„",-1)),b[1]||(b[1]=s("strong",null,"Reading:",-1)),s("code",Sa,$(t.value),1),n.value?(u(),m("span",ka,"Lines "+$(i.value)+"-"+$(a.value),1)):M("",!0)])]),l.value?(u(),m("div",Ta,[c.value?(u(),m("div",xa,[s("pre",Aa,$(f.value),1)])):(u(),m("div",Ma,[s("div",Oa,[b[2]||(b[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Na,$(r.value)+" lines",1),y.value?(u(),m("span",Da,"(showing first "+$(gs)+")")):M("",!0)]),s("pre",La,$(v.value),1),y.value?(u(),m("div",Ia,"...")):M("",!0)]))])):M("",!0)]))}},ja=te(Pa,[["__scopeId","data-v-1f2b0569"]]),Ra={class:"write-tool-handler"},Wa={class:"tool-section"},Va={class:"write-file-info mb-2"},Ha={class:"file-path"},Fa={class:"write-content-preview"},Ba={class:"content-header"},Ua={class:"line-count-badge"},qa={key:0,class:"preview-note"},za={class:"tool-code content-display"},Ka={key:0,class:"more-indicator"},Ga={key:0,class:"tool-section"},Ya={key:0,class:"tool-result tool-result-error"},Ja={class:"tool-code"},Xa={key:1,class:"tool-result tool-result-success"},Qa={class:"success-message"},bs=100,Za={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?.file_path||"Unknown"),n=g(()=>e.toolCall.input?.content||""),i=g(()=>n.value.split(`
`)),a=g(()=>i.value.length),l=g(()=>a.value>bs),c=g(()=>i.value.slice(0,bs).join(`
`)),f=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),h=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=g(()=>{if(!f.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,v)=>(u(),m("div",Ra,[s("div",Wa,[s("div",Va,[v[0]||(v[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),v[1]||(v[1]=s("strong",null,"Writing:",-1)),s("code",Ha,$(t.value),1)]),s("div",Fa,[s("div",Ba,[v[2]||(v[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",Ua,$(a.value)+" lines",1),l.value?(u(),m("span",qa,"(showing first "+$(bs)+")")):M("",!0)]),s("pre",za,$(c.value),1),l.value?(u(),m("div",Ka,"...")):M("",!0)])]),f.value?(u(),m("div",Ga,[h.value?(u(),m("div",Ya,[v[3]||(v[3]=s("strong",null,"Error:",-1)),s("pre",Ja,$(r.value),1)])):(u(),m("div",Xa,[s("div",Qa,[v[4]||(v[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):M("",!0)]))}},el=te(Za,[["__scopeId","data-v-ddc24a0f"]]),tl={class:"bash-tool-handler"},sl={class:"tool-section"},ol={class:"bash-header"},nl={class:"bash-header-content"},il={key:0,class:"bash-description"},al={key:1,class:"bash-flags"},ll={class:"bash-command-section"},rl={class:"bash-command-content"},cl={key:0,class:"tool-section"},ul={key:0,class:"bash-output"},dl={key:1,class:"bash-output-empty"},ml={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?.command||""),n=g(()=>e.toolCall.input?.description||""),i=g(()=>e.toolCall.input?.timeout),a=g(()=>e.toolCall.input?.run_in_background||!1),l=g(()=>i.value||a.value),c=g(()=>{const v=[];return i.value&&v.push(`timeout: ${i.value}ms`),a.value&&v.push("background"),v.join(", ")}),f=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),h=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=g(()=>h.value?"tool-result-error":"tool-result-success"),y=g(()=>{if(!f.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,p)=>(u(),m("div",tl,[s("div",sl,[s("div",ol,[p[1]||(p[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",nl,[n.value?(u(),m("div",il,[p[0]||(p[0]=s("strong",null,"Description:",-1)),oe(" "+$(n.value),1)])):M("",!0),l.value?(u(),m("div",al,$(c.value),1)):M("",!0)])]),s("div",ll,[p[2]||(p[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",rl,$(t.value),1)])]),f.value?(u(),m("div",cl,[s("div",{class:ee(["tool-result",r.value])},[p[3]||(p[3]=s("strong",null,"Output:",-1)),y.value?(u(),m("pre",ul,$(y.value),1)):(u(),m("div",dl,"No output"))],2)])):M("",!0)]))}},pl=te(ml,[["__scopeId","data-v-ab50fe73"]]),fl={class:"todo-tool-handler"},vl={class:"tool-section"},hl={class:"todo-header"},_l={class:"todo-summary"},gl={key:0,class:"todo-count todo-count-completed"},bl={key:1,class:"todo-count todo-count-in-progress"},yl={key:2,class:"todo-count todo-count-pending"},wl={class:"todo-checklist"},$l={class:"todo-checkbox"},El={class:"todo-content"},Cl={key:0,class:"tool-section"},Sl={key:0,class:"tool-result tool-result-error"},kl={class:"tool-code"},Tl={key:1,class:"tool-result tool-result-success"},xl={class:"success-message"},Al={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?.todos||[]),n=g(()=>t.value.filter(r=>r.status==="completed").length),i=g(()=>t.value.filter(r=>r.status==="in_progress").length),a=g(()=>t.value.filter(r=>r.status==="pending").length);function l(r){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[r]||"â˜"}const c=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=g(()=>{if(!c.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,y)=>(u(),m("div",fl,[s("div",vl,[s("div",hl,[y[0]||(y[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),y[1]||(y[1]=s("strong",null,"Task List:",-1)),s("div",_l,[n.value>0?(u(),m("span",gl,$(n.value)+" completed ",1)):M("",!0),i.value>0?(u(),m("span",bl,$(i.value)+" in progress ",1)):M("",!0),a.value>0?(u(),m("span",yl,$(a.value)+" pending ",1)):M("",!0)])]),s("div",wl,[(u(!0),m(re,null,ce(t.value,(v,p)=>(u(),m("div",{key:p,class:ee(["todo-item",`todo-${v.status}`])},[s("span",$l,$(l(v.status)),1),s("span",El,$(v.content),1)],2))),128))])]),c.value?(u(),m("div",Cl,[f.value?(u(),m("div",Sl,[y[2]||(y[2]=s("strong",null,"Error:",-1)),s("pre",kl,$(h.value),1)])):(u(),m("div",Tl,[s("div",xl,[y[3]||(y[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+$(t.value.length)+" tasks)",1)])]))])):M("",!0)]))}},Ml=te(Al,[["__scopeId","data-v-bbe55ee7"]]),Ol={class:"edit-tool-handler"},Nl={class:"tool-section"},Dl={class:"edit-file-info"},Ll={class:"file-path"},Il={key:0,class:"replace-all-badge"},Pl={class:"edit-diff-container"},jl={class:"diff-header"},Rl={class:"diff-stats"},Wl={class:"stat-removed"},Vl={class:"stat-added"},Hl={class:"unified-diff"},Fl={class:"diff-scroll-container"},Bl={class:"diff-marker"},Ul={class:"diff-content"},ql={key:0,class:"tool-section"},zl={key:0,class:"tool-result tool-result-error"},Kl={class:"tool-code"},Gl={key:1,class:"tool-result tool-result-success"},Yl={class:"success-message"},Jl={key:0,class:"success-detail"},Xl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?.file_path||"Unknown"),n=g(()=>e.toolCall.input?.old_string||""),i=g(()=>e.toolCall.input?.new_string||""),a=g(()=>e.toolCall.input?.replace_all||!1),l=g(()=>{const p=_i(t.value,n.value,i.value,"","",{context:3}).split(`
`),b=[];for(let w=4;w<p.length;w++){const d=p[w];d&&(d.startsWith("-")?b.push({type:"removed",content:d.substring(1)}):d.startsWith("+")?b.push({type:"added",content:d.substring(1)}):d.startsWith(" ")?b.push({type:"context",content:d.substring(1)}):d.startsWith("@@")&&b.push({type:"hunk",content:d}))}return b}),c=g(()=>l.value.filter(v=>v.type==="removed").length),f=g(()=>l.value.filter(v=>v.type==="added").length),h=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!h.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,p)=>(u(),m("div",Ol,[s("div",Nl,[s("div",Dl,[p[0]||(p[0]=s("span",{class:"file-icon"},"âœï¸",-1)),p[1]||(p[1]=s("strong",null,"Editing:",-1)),s("code",Ll,$(t.value),1),a.value?(u(),m("span",Il,"Replace All")):M("",!0)]),s("div",Pl,[s("div",jl,[p[2]||(p[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Rl,[s("span",Wl,"-"+$(c.value),1),s("span",Vl,"+"+$(f.value),1)])]),s("div",Hl,[s("div",Fl,[(u(!0),m(re,null,ce(l.value,(b,w)=>(u(),m("div",{key:w,class:ee(["diff-line",{"diff-line-removed":b.type==="removed","diff-line-added":b.type==="added","diff-line-context":b.type==="context","diff-line-hunk":b.type==="hunk"}])},[s("span",Bl,$(b.type==="removed"?"-":b.type==="added"?"+":b.type==="hunk"?"@":" "),1),s("span",Ul,$(b.content),1)],2))),128))])])])]),h.value?(u(),m("div",ql,[r.value?(u(),m("div",zl,[p[3]||(p[3]=s("strong",null,"Error:",-1)),s("pre",Kl,$(y.value),1)])):(u(),m("div",Gl,[s("div",Yl,[p[4]||(p[4]=s("span",{class:"success-icon"},"âœ…",-1)),p[5]||(p[5]=s("strong",null,"File edited successfully",-1)),a.value?(u(),m("span",Jl,"(all occurrences replaced)")):M("",!0)])]))])):M("",!0)]))}},Ql=te(Xl,[["__scopeId","data-v-dd74055e"]]),Zl={class:"search-tool-handler"},er={class:"tool-section"},tr={class:"search-info"},sr={class:"search-icon"},or={class:"search-pattern"},nr={key:0,class:"search-path"},ir={key:1,class:"search-filters"},ar={key:0,class:"filter-badge"},lr={key:1,class:"filter-badge"},rr={key:2,class:"filter-badge"},cr={key:0,class:"tool-section"},ur={key:0,class:"tool-result tool-result-error"},dr={class:"tool-code"},mr={key:1,class:"search-results"},pr={class:"results-header"},fr={class:"results-label"},vr={class:"results-count-badge"},hr={class:"results-content"},_r={class:"tool-code"},gr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.name==="Grep"),n=g(()=>e.toolCall.input?.pattern||"Unknown"),i=g(()=>e.toolCall.input?.path||null),a=g(()=>e.toolCall.input?.type||null),l=g(()=>e.toolCall.input?.glob||null),c=g(()=>e.toolCall.input?.["-i"]||!1),f=g(()=>a.value||l.value||c.value),h=g(()=>t.value?"ðŸ”":"ðŸ“"),r=g(()=>t.value?"Searching content":"Finding files"),y=g(()=>t.value?"Matches":"Files found"),v=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=g(()=>{if(!v.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),w=g(()=>!v.value||p.value||!b.value?0:b.value.split(`
`).filter(_=>_.trim()).length);return(d,_)=>(u(),m("div",Zl,[s("div",er,[s("div",tr,[s("span",sr,$(h.value),1),s("strong",null,$(r.value)+":",1),s("code",or,$(n.value),1),i.value?(u(),m("span",nr,"in "+$(i.value),1)):M("",!0),f.value?(u(),m("span",ir,[a.value?(u(),m("span",ar,"type: "+$(a.value),1)):M("",!0),l.value?(u(),m("span",lr,"glob: "+$(l.value),1)):M("",!0),c.value?(u(),m("span",rr,"case-insensitive")):M("",!0)])):M("",!0)])]),v.value?(u(),m("div",cr,[p.value?(u(),m("div",ur,[_[0]||(_[0]=s("strong",null,"Error:",-1)),s("pre",dr,$(b.value),1)])):(u(),m("div",mr,[s("div",pr,[s("span",fr,$(y.value)+":",1),s("span",vr,$(w.value)+" "+$(w.value===1?"match":"matches"),1)]),s("div",hr,[s("pre",_r,$(b.value),1)])]))])):M("",!0)]))}},fo=te(gr,[["__scopeId","data-v-0d272c39"]]),br={class:"web-tool-handler"},yr={class:"tool-section"},wr={class:"web-info"},$r={class:"web-icon"},Er=["href"],Cr={key:1,class:"web-query"},Sr={key:0,class:"web-prompt-container"},kr={class:"prompt-content"},Tr={key:1,class:"web-domains"},xr={class:"domains-label"},Ar={key:0,class:"tool-section"},Mr={key:0,class:"tool-result tool-result-error"},Or={class:"tool-code"},Nr={key:1,class:"web-results"},Dr={class:"results-header"},Lr={class:"results-label"},Ir={class:"results-content"},Pr={class:"tool-code"},jr={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.name==="WebFetch"),n=g(()=>e.toolCall.input?.url||null),i=g(()=>e.toolCall.input?.query||null),a=g(()=>e.toolCall.input?.prompt||null),l=g(()=>e.toolCall.input?.allowed_domains||[]),c=g(()=>e.toolCall.input?.blocked_domains||[]),f=g(()=>l.value.length>0?l.value:c.value.length>0?c.value:[]),h=g(()=>l.value.length>0?"Allowed domains":c.value.length>0?"Blocked domains":"Domains"),r=g(()=>t.value?"ðŸŒ":"ðŸ”Ž"),y=g(()=>t.value?"Fetching URL":"Searching web"),v=g(()=>t.value?"Fetched content":"Search results"),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),b=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=g(()=>{if(!p.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,_)=>(u(),m("div",br,[s("div",yr,[s("div",wr,[s("span",$r,$(r.value),1),s("strong",null,$(y.value)+":",1),n.value?(u(),m("a",{key:0,href:n.value,target:"_blank",class:"web-url"},$(n.value),9,Er)):i.value?(u(),m("code",Cr,$(i.value),1)):M("",!0)]),a.value?(u(),m("div",Sr,[_[0]||(_[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",kr,$(a.value),1)])):M("",!0),f.value.length>0?(u(),m("div",Tr,[s("span",xr,$(h.value)+":",1),(u(!0),m(re,null,ce(f.value,C=>(u(),m("span",{key:C,class:"domain-badge"},$(C),1))),128))])):M("",!0)]),p.value?(u(),m("div",Ar,[b.value?(u(),m("div",Mr,[_[1]||(_[1]=s("strong",null,"Error:",-1)),s("pre",Or,$(w.value),1)])):(u(),m("div",Nr,[s("div",Dr,[s("span",Lr,$(v.value)+":",1)]),s("div",Ir,[s("pre",Pr,$(w.value),1)])]))])):M("",!0)]))}},vo=te(jr,[["__scopeId","data-v-62b55b55"]]),Rr={class:"task-tool-handler"},Wr={class:"tool-section"},Vr={class:"task-header"},Hr={key:0,class:"agent-type-badge"},Fr={key:0,class:"task-description"},Br={class:"description-content"},Ur={key:1,class:"task-prompt-container"},qr={class:"prompt-header"},zr={class:"prompt-length"},Kr={class:"prompt-code"},Gr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Xr={key:1,class:"agent-output"},Qr={class:"output-header"},Zr={key:0,class:"output-count-badge"},ec={class:"output-content"},tc={class:"tool-code"},sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?.description||null),n=g(()=>e.toolCall.input?.prompt||null),i=g(()=>e.toolCall.input?.subagent_type||null),a=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>{if(!a.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),f=g(()=>c.value?c.value.split(`
`).length:0);return(h,r)=>(u(),m("div",Rr,[s("div",Wr,[s("div",Vr,[r[0]||(r[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),r[1]||(r[1]=s("strong",null,"Agent Task:",-1)),i.value?(u(),m("span",Hr,$(i.value),1)):M("",!0)]),t.value?(u(),m("div",Fr,[r[2]||(r[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",Br,$(t.value),1)])):M("",!0),n.value?(u(),m("div",Ur,[s("div",qr,[r[3]||(r[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",zr,$(n.value.length)+" characters",1)]),s("pre",Kr,$(n.value),1)])):M("",!0)]),a.value?(u(),m("div",Gr,[l.value?(u(),m("div",Yr,[r[4]||(r[4]=s("strong",null,"Error:",-1)),s("pre",Jr,$(c.value),1)])):(u(),m("div",Xr,[s("div",Qr,[r[5]||(r[5]=s("span",{class:"output-label"},"Agent Output:",-1)),f.value>0?(u(),m("span",Zr,$(f.value)+" lines",1)):M("",!0)]),s("div",ec,[s("pre",tc,$(c.value),1)])]))])):M("",!0)]))}},oc=te(sc,[["__scopeId","data-v-c520c244"]]),nc={class:"notebook-edit-tool-handler"},ic={class:"tool-section"},ac={class:"notebook-info"},lc={class:"file-path"},rc={class:"cell-info mt-2"},cc={class:"info-row"},uc={class:"info-row"},dc={key:0,class:"info-row"},mc={class:"badge bg-info"},pc={key:0,class:"source-preview mt-3"},fc={class:"preview-header"},vc={class:"preview-stats"},hc={class:"source-code"},_c={key:0,class:"tool-section"},gc={key:0},bc={key:1,class:"text-danger"},yc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?.notebook_path||"Unknown"),n=g(()=>e.toolCall.input?.cell_id),i=g(()=>e.toolCall.input?.cell_type||"code"),a=g(()=>e.toolCall.input?.edit_mode||"replace"),l=g(()=>e.toolCall.input?.new_source||""),c=g(()=>l.value.split(`
`).length),f=g(()=>i.value==="code"?"bg-primary":"bg-secondary"),h=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),r=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const y=a.value;return y==="insert"?"Cell inserted successfully":y==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(y,v)=>(u(),m("div",nc,[s("div",ic,[s("div",ac,[v[0]||(v[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),v[1]||(v[1]=s("strong",null,"Notebook:",-1)),s("code",lc,$(t.value),1)]),s("div",rc,[s("div",cc,[v[2]||(v[2]=s("strong",null,"Cell ID:",-1)),s("code",null,$(n.value||"N/A"),1)]),s("div",uc,[v[3]||(v[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:ee(["badge",f.value])},$(i.value),3)]),a.value?(u(),m("div",dc,[v[4]||(v[4]=s("strong",null,"Edit Mode:",-1)),s("span",mc,$(a.value),1)])):M("",!0)]),l.value?(u(),m("div",pc,[s("div",fc,[v[5]||(v[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",vc,$(c.value)+" lines",1)]),s("pre",hc,[s("code",null,$(l.value),1)])])):M("",!0)]),o.toolCall.result?(u(),m("div",_c,[v[6]||(v[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:ee(["tool-result",h.value])},[o.toolCall.result.success!==!1?(u(),m("div",gc," âœ… "+$(r.value),1)):(u(),m("div",bc," â— "+$(o.toolCall.result.error||"Operation failed"),1))],2)])):M("",!0)]))}},wc=te(yc,[["__scopeId","data-v-c81a9bcf"]]),$c={class:"shell-tool-handler"},Ec={class:"tool-section"},Cc={class:"shell-info"},Sc={class:"shell-icon"},kc={key:0,class:"shell-id"},Tc={key:0,class:"filter-info mt-2"},xc={class:"filter-pattern"},Ac={key:0,class:"tool-section"},Mc={class:"result-header mb-2"},Oc={key:0,class:"mb-2"},Nc={class:"shell-output"},Dc={key:1,class:"mb-2"},Lc={class:"shell-output shell-output-error"},Ic={key:0},Pc={key:1,class:"text-danger"},jc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),n=g(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=g(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=g(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=g(()=>e.toolCall.input?.filter);function c(p,b){if(!p)return null;const w=new RegExp(`<${b}>([\\s\\S]*?)<\\/${b}>`,"i"),d=p.match(w);return d?d[1].trim():null}const f=g(()=>{const p=e.toolCall.result;if(!p)return null;let b=p;if(p.content&&(b=p.content),typeof b=="string")return{status:c(b,"status"),stdout:c(b,"stdout"),stderr:c(b,"stderr"),exit_code:c(b,"exit_code")};if(Array.isArray(b)){const w=b.find(d=>d.type==="text")?.text||"";return{status:c(w,"status"),stdout:c(w,"stdout"),stderr:c(w,"stderr"),exit_code:c(w,"exit_code")}}return{status:p.status||b.status,stdout:p.stdout||p.output||b.stdout||b.output,stderr:p.stderr||b.stderr,exit_code:p.exit_code||b.exit_code}}),h=g(()=>f.value?.status),r=g(()=>{const p=h.value;return p==="running"?"bg-success":p==="completed"?"bg-secondary":p==="killed"||p==="terminated"?"bg-danger":"bg-info"}),y=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),v=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const p=f.value;if(p?.status==="running"&&!p.stdout&&!p.stderr)return"No new output since last check";if(p?.status==="failed")return`Shell failed (exit code ${p.exit_code||"unknown"})`}return"Operation completed"});return(p,b)=>(u(),m("div",$c,[s("div",Ec,[s("div",Cc,[s("span",Sc,$(t.value),1),s("strong",null,$(n.value)+":",1),a.value?(u(),m("code",kc,"Shell "+$(a.value),1)):M("",!0)]),o.toolCall.name==="BashOutput"&&l.value?(u(),m("div",Tc,[b[0]||(b[0]=s("strong",null,"Filter:",-1)),s("code",xc,$(l.value),1)])):M("",!0)]),o.toolCall.result?(u(),m("div",Ac,[s("div",Mc,[s("strong",null,$(i.value)+":",1),h.value?(u(),m("span",{key:0,class:ee(["badge",r.value])},$(h.value),3)):M("",!0)]),f.value?.stdout?(u(),m("div",Oc,[b[1]||(b[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Nc,[s("pre",null,[s("code",null,$(f.value.stdout),1)])])])):M("",!0),f.value?.stderr?(u(),m("div",Dc,[b[2]||(b[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",Lc,[s("pre",null,[s("code",null,$(f.value.stderr),1)])])])):M("",!0),!f.value?.stdout&&!f.value?.stderr?(u(),m("div",{key:2,class:ee(["tool-result",y.value])},[o.toolCall.result.success!==!1?(u(),m("div",Ic," âœ… "+$(v.value),1)):(u(),m("div",Pc," â— "+$(o.toolCall.result.error||"Operation failed"),1))],2)):M("",!0)])):M("",!0)]))}},ho=te(jc,[["__scopeId","data-v-86def281"]]),Rc={class:"skill-tool-handler"},Wc={key:0,class:"tool-section"},Vc={class:"d-flex align-items-center gap-2"},Hc={class:"text-muted small"},Fc={key:0,class:"skill-content-body"},Bc={class:"skill-content-text"},Uc={key:1,class:"tool-section mt-3"},qc={class:"tool-result tool-result-error"},zc={class:"tool-code"},Kc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=xe(),n=ae(),i=L(!1);function a(){i.value=!i.value}const l=g(()=>{const v=n.currentSessionId;if(!v)return{running:null,content:null};const p=t.messagesBySession.get(v)||[],b=p.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(C=>C.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let w=null,d=null;for(let _=b+1;_<Math.min(b+3,p.length);_++){const C=p[_];if(C.type!=="user")continue;const S=C.content||"";S.includes("<command-message>")&&S.includes("skill is running")?w=C:S.startsWith("Base directory for this skill:")&&(d=C)}return{running:w,content:d}}),c=g(()=>{const v=l.value.content;if(!v)return"";const p=v.content||"",b=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return p.replace(b,"").trim()}),f=g(()=>c.value.length>0),h=g(()=>c.value?c.value.split(`
`).length:0),r=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!r.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,p)=>(u(),m("div",Rc,[f.value?(u(),m("div",Wc,[s("div",{class:"skill-content-header",onClick:a},[s("div",Vc,[s("i",{class:ee(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),p[0]||(p[0]=s("strong",null,"Skill Content",-1)),s("span",Hc,"("+$(h.value)+" lines)",1)])]),i.value?(u(),m("div",Fc,[s("pre",Bc,$(c.value),1)])):M("",!0)])):M("",!0),r.value?(u(),m("div",Uc,[p[1]||(p[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",qc,[s("pre",zc,$(y.value),1)])])):M("",!0)]))}},Gc=te(Kc,[["__scopeId","data-v-0a48ca0f"]]),Yc={class:"slashcommand-tool-handler"},Jc={key:0,class:"tool-section"},Xc={class:"d-flex align-items-center gap-2"},Qc=["aria-label"],Zc={class:"text-muted small"},eu={key:0,class:"command-content-body"},tu={class:"command-content-text"},su={key:1,class:"tool-section mt-3"},ou={class:"tool-result tool-result-error"},nu={class:"tool-code"},iu={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=xe(),n=ae(),i=L(!1);function a(){i.value=!i.value}const l=g(()=>{const v=n.currentSessionId;if(!v)return{running:null,content:null};const p=t.messagesBySession.get(v)||[],b=p.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(C=>C.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let w=null,d=null;for(let _=b+1;_<Math.min(b+3,p.length);_++){const C=p[_];if(C.type!=="user")continue;const S=C.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?w=C:S.includes("ARGUMENTS:")&&(d=C)}return{running:w,content:d}}),c=g(()=>{const v=l.value.content;if(!v)return"";const p=v.content||"",b=/\nARGUMENTS:.*$/s;return p.replace(b,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),f=g(()=>c.value.length>0),h=g(()=>c.value?c.value.split(`
`).length:0),r=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!r.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,p)=>(u(),m("div",Yc,[f.value?(u(),m("div",Jc,[s("div",{class:"command-content-header",onClick:a},[s("div",Xc,[s("span",{"aria-label":i.value?"Collapse":"Expand"},$(i.value?"â–¾":"â–¸"),9,Qc),p[0]||(p[0]=s("strong",null,"Command Content",-1)),s("span",Zc,"("+$(h.value)+" lines)",1)])]),i.value?(u(),m("div",eu,[s("pre",tu,$(c.value),1)])):M("",!0)])):M("",!0),r.value?(u(),m("div",su,[p[1]||(p[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",ou,[s("pre",nu,$(y.value),1)])])):M("",!0)]))}},au=te(iu,[["__scopeId","data-v-15991acf"]]),lu={class:"exit-plan-mode-tool-handler"},ru={class:"tool-section"},cu={key:0,class:"plan-content mt-2"},uu={class:"plan-text"},du={key:0,class:"tool-section"},mu={key:0},pu={key:1,class:"text-danger"},fu={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>e.toolCall.input?.plan),n=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),m("div",lu,[s("div",ru,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(u(),m("div",cu,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",uu,$(t.value),1)])):M("",!0)]),o.toolCall.result?(u(),m("div",du,[a[2]||(a[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:ee(["tool-result",n.value])},[o.toolCall.result.success!==!1?(u(),m("div",mu," âœ… Permission mode reverted to default ")):(u(),m("div",pu," â— "+$(o.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):M("",!0)]))}},vu=te(fu,[["__scopeId","data-v-e2e3c781"]]),hu={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},_u={class:"tool-status-icon"},gu=["title"],bu={class:"d-flex align-items-center gap-2"},yu={class:"text-muted"},wu=["aria-label"],$u={key:0,class:"card-body"},Eu={key:0,class:"alert alert-warning mb-3"},Cu={class:"d-flex align-items-center"},Su={class:"mb-0 small"},ku={key:1,class:"permission-prompt mt-3"},Tu={class:"alert alert-warning mb-3"},xu={class:"mb-0"},Au={class:"tool-name"},Mu={key:0,class:"suggestions-section mb-3"},Ou={class:"alert alert-info mb-0"},Nu={class:"suggestion-details p-2 bg-white rounded"},Du={class:"permission-buttons d-flex gap-2 mb-3"},Lu=["disabled"],Iu=["disabled"],Pu=["disabled"],ju={class:"guidance-section mt-3"},Ru=["disabled"],Wu=["disabled"],Vu={key:2,class:"mt-3"},Hu={class:"alert alert-warning mb-0"},Fu={class:"d-flex align-items-center"},Bu={class:"mb-0 small"},Uu={key:3,class:"tool-section"},qu={class:"alert alert-danger mb-0"},zu={key:0},Ku={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(o){const e=o,t=xe(),n=ae(),i=ze(),a=L(!1),l=L(null),c=L(""),f=g(()=>t.isToolUseOrphaned(n.currentSessionId,e.toolCall.id)),h=g(()=>t.getOrphanedInfo(n.currentSessionId,e.toolCall.id)),r=g(()=>t.getBackendToolState(n.currentSessionId,e.toolCall.id)),y=g(()=>{if(r.value){const k=r.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[k]||k}return e.toolCall.status}),v={Read:ja,Write:el,Bash:pl,TodoWrite:Ml,Edit:Ql,Grep:fo,Glob:fo,WebFetch:vo,WebSearch:vo,Task:oc,NotebookEdit:wc,BashOutput:ho,KillShell:ho,SlashCommand:au,Skill:Gc,ExitPlanMode:vu},p=g(()=>{const k=e.toolCall.name;return v[k]?v[k]:wa}),b=g(()=>{const k=[];if(f.value)return k.push("border-warning"),k.join(" ");switch(y.value){case"pending":k.push("border-secondary");break;case"permission_required":k.push("border-warning");break;case"executing":k.push("border-primary");break;case"completed":_.value||e.toolCall.permissionDecision==="deny"?k.push("border-danger"):k.push("border-success");break;case"error":k.push("border-danger");break}return k.join(" ")}),w=g(()=>{if(f.value)return"â¹ï¸";switch(y.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":_.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),d=g(()=>Pt(e.toolCall.timestamp)),_=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),C=g(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function S(k){if(!k)return"";const E=k.replace(/\\/g,"/").split("/");return E[E.length-1]}function D(k){if(!k)return"";const E=k.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return E?E[1]:k}function V(k,E=200){return k?k.length<=E?k:k.substring(0,E)+"...":""}function P(k){if(!k)return null;if(k.content){const E=k.content.match(/exit code (\d+)/i);if(E)return parseInt(E[1])}return k.error?1:0}function O(k,E){const N=k?k.split(`
`).length:0;return{added:E?E.split(`
`).length:0,removed:N}}const F=g(()=>{const k=e.toolCall.name,E=e.toolCall.input||{},N=e.toolCall.result,x=y.value;switch(k){case"Bash":case"Shell":case"Command":{const T=D(E.command),j=V(T,200);if(x==="completed"&&N){const q=P(N);return`Bash: ${j} (exit ${q})`}return`Bash: ${j}`}case"SlashCommand":{const T=V(E.command,200);return x==="completed"&&N?`SlashCommand: ${T}`:`SlashCommand: ${T}`}case"Edit":{const T=S(E.file_path);if(x==="completed"&&N&&!N.error){const{added:j,removed:q}=O(E.old_string,E.new_string);return j===q?`Edit: ${T} (${j} lines changed)`:`Edit: ${T} (${j} lines added, ${q} removed)`}return`Edit: ${T}`}case"Read":{const T=S(E.file_path);if(E.offset!==void 0||E.limit!==void 0){const q=(E.offset||0)+1,Y=E.limit?(E.offset||0)+E.limit:"âˆž";return`Read: ${T} (lines ${q}-${Y})`}return`Read: ${T} (full file)`}case"Write":{const T=S(E.file_path);if(x==="completed"&&N&&!N.error&&E.content){const j=E.content.split(`
`).length;return`Write: ${T} (${j} lines written)`}return`Write: ${T}`}case"Skill":{const T=E.skill||"Unknown";return x==="completed"&&N?N.error?`Skill: ${T} (error)`:`Skill: ${T} (completed)`:`Skill: ${T}`}case"Task":{const T=E.subagent_type||"general",j=E.description||"Task";return x==="completed"&&N?N.error?`Task: (${T}) ${j} (error)`:`Task: (${T}) ${j} (completed)`:`Task: (${T}) ${j}`}case"TodoWrite":{if(E.todos&&Array.isArray(E.todos)){const T=E.todos.filter(Y=>Y.status==="completed").length,j=E.todos.length,q=E.todos.find(Y=>Y.status==="in_progress");return q?`Todo: Working on "${q.content}"`:`Todo: ${T}/${j} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const T=E.pattern||"",j=k==="Grep"?"Grep":"Glob";if(x==="completed"&&N&&!N.error){let q=0;return N.content&&(q=N.content.split(`
`).filter(Q=>Q.trim()).length),`${j}: "${T}" (${q} results)`}return`${j}: "${T}"`}case"WebFetch":case"WebSearch":{const T=E.url||E.query||"";if(k==="WebSearch"){const q=E.query||"",Y=q.length>50?q.substring(0,50)+"...":q;return x==="completed"&&N?N.error?`Web: ${Y} (error)`:`Web: ${Y} (success)`:`Web: ${Y}`}let j="";try{T&&(j=new URL(T.startsWith("http")?T:`https://${T}`).hostname)}catch{j=T.length>50?T.substring(0,50)+"...":T}return x==="completed"&&N?N.error?`Web: ${j} (error)`:`Web: ${j} (success)`:`Web: ${j||T}`}case"NotebookEdit":{const T=S(E.notebook_path),j=E.cell_number!==void 0?E.cell_number:"?",q=E.edit_mode||"replace";return`NotebookEdit: ${T} cell #${j} (${q})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${E.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${E.shell_id||"unknown"}`;default:return`${k}: executed`}}),A=g(()=>{const k=e.toolCall.name,E=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(k)?E.command||k:["Edit","Read","Write","NotebookEdit"].includes(k)&&(E.file_path||E.notebook_path)||k});function I(){const k=n.currentSessionId;k&&t.toggleToolExpansion(k,e.toolCall.id)}function K(k){return k.type==="setMode"?`Set permission mode to "${k.mode}"`:k.type==="allow"?`Allow tool: ${k.tool}`:JSON.stringify(k)}async function B(k,E,N=null){if(!a.value){a.value=!0,k==="allow"?l.value=E?"approve-apply":"approve":N?l.value="deny-guidance":l.value="deny";try{const x=n.currentSessionId;if(x){const T=E&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(x,{request_id:e.toolCall.permissionRequestId,decision:k,reasoning:k==="allow"?"User allowed permission":"User denied permission",applied_updates:T})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,k,E,N)}catch(x){console.error("Failed to send permission response:",x)}finally{a.value=!1,l.value=null}}}return(k,E)=>(u(),m("div",{class:ee(["tool-call-card card",b.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:I},[s("div",hu,[s("span",_u,$(w.value),1),s("span",{class:"tool-name",title:A.value},$(F.value),9,gu)]),s("div",bu,[s("small",yu,$(d.value),1),s("span",{"aria-label":o.toolCall.isExpanded?"Collapse":"Expand"},$(o.toolCall.isExpanded?"â–¾":"â–¸"),9,wu)])]),o.toolCall.isExpanded?(u(),m("div",$u,[f.value?(u(),m("div",Eu,[s("div",Cu,[E[6]||(E[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[E[5]||(E[5]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Su,$(h.value?.message||"Session was terminated"),1)])])])):M("",!0),(u(),ge(tn(p.value),{toolCall:o.toolCall},null,8,["toolCall"])),y.value==="permission_required"&&!f.value?(u(),m("div",ku,[s("div",Tu,[E[9]||(E[9]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",xu,[E[7]||(E[7]=oe("Claude wants to use the ",-1)),s("code",Au,$(o.toolCall.name),1),E[8]||(E[8]=oe(" tool.",-1))])]),C.value?(u(),m("div",Mu,[s("div",Ou,[E[10]||(E[10]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),E[11]||(E[11]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Nu,[(u(!0),m(re,null,ce(o.toolCall.suggestions,(N,x)=>(u(),m("div",{key:x,class:"suggestion-item"},[s("code",null,$(K(N)),1)]))),128))]),E[12]||(E[12]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):M("",!0),s("div",Du,[C.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:E[0]||(E[0]=N=>B("allow",!0)),disabled:a.value},$(a.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Lu)):M("",!0),s("button",{class:ee(["btn",C.value?"btn-outline-success":"btn-success"]),onClick:E[1]||(E[1]=N=>B("allow",!1)),disabled:a.value},$(a.value&&l.value==="approve"?"â³ Submitting...":C.value?"âœ… Approve Only":"âœ… Approve"),11,Iu),s("button",{class:"btn btn-danger",onClick:E[2]||(E[2]=N=>B("deny",!1)),disabled:a.value}," ðŸš« "+$(a.value&&l.value==="deny"?"Submitting...":"Deny"),9,Pu)]),s("div",ju,[E[13]||(E[13]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),E[14]||(E[14]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ne(s("textarea",{"onUpdate:modelValue":E[3]||(E[3]=N=>c.value=N),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Ru),[[ue,c.value]]),c.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:E[4]||(E[4]=N=>B("deny",!1,c.value)),disabled:a.value},$(a.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Wu)):M("",!0)])])):M("",!0),y.value==="permission_required"&&f.value?(u(),m("div",Vu,[s("div",Hu,[s("div",Fu,[E[16]||(E[16]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[E[15]||(E[15]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Bu,$(h.value?.message||"Session was terminated before permission could be granted"),1)])])])])):M("",!0),o.toolCall.permissionDecision==="deny"?(u(),m("div",Uu,[s("div",qu,[E[17]||(E[17]=oe(" ðŸš« Permission denied ",-1)),o.toolCall.result?.message?(u(),m("span",zu," - "+$(o.toolCall.result.message),1)):M("",!0)])])):M("",!0)])):M("",!0)],2))}},_o=te(Ku,[["__scopeId","data-v-e339198b"]]),Gu={class:"tool-footer-container"},Yu=["aria-label","onKeydown"],Ju={class:"footer-left"},Xu={class:"footer-text"},Qu={class:"footer-middle"},Zu={class:"footer-text"},ed={class:"footer-right"},td={class:"expand-icon"},sd={key:0,class:"tool-footer-expanded"},od={key:1,class:"active-tools-area"},nd={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(o){const e=o,t=xe(),n=ae(),i=L(!1);function a(p){return p.map((b,w)=>({tool:b,originalIndex:w})).sort((b,w)=>{if(b.tool.timestamp&&w.tool.timestamp){const d=new Date(b.tool.timestamp).getTime(),_=new Date(w.tool.timestamp).getTime();if(d!==_)return d-_}return b.originalIndex-w.originalIndex}).map(({tool:b})=>b)}const l=g(()=>{const p=e.tools.filter(b=>b.status==="executing"||b.status==="permission_required");return a(p)}),c=g(()=>{const p=e.tools.filter(b=>b.status!=="executing"&&b.status!=="permission_required");return a(p)}),f=g(()=>{const p=new Map;e.tools.forEach(C=>{const S=p.get(C.name)||0;p.set(C.name,S+1)});const b=Array.from(p.entries()).sort((C,S)=>S[1]-C[1]),w=b.slice(0,5),d=b.length-w.length,_=w.map(([C,S])=>`${C} (${S})`).join(", ");return d>0?`${_}, +${d} more`:_}),h=g(()=>{const p=e.tools.length;let b=0,w=0,d=0;e.tools.forEach(D=>{const V=n.currentSessionId;(V?t.isToolUseOrphaned(V,D.id):!1)?d++:D.status==="completed"&&!D.result?.error&&D.permissionDecision!=="deny"?b++:(D.status==="error"||D.result?.error||D.permissionDecision==="deny")&&w++});let _=[];b>0&&_.push(`${b} âœ…`),w>0&&_.push(`${w} âŒ`),d>0&&_.push(`${d} â¹ï¸`);const C=p===1?"tool":"tools",S=_.length>0?": "+_.join(" "):"";return`${p} ${C}${S}`}),r=g(()=>i.value?"â–²":"â–¼"),y=g(()=>{const p=n.currentSessionId,b=e.tools.some(C=>C.status==="error"||C.result?.error||C.permissionDecision==="deny"),w=e.tools.some(C=>p?t.isToolUseOrphaned(p,C.id):!1),d=l.value.length>0,_=e.tools.every(C=>!(p?t.isToolUseOrphaned(p,C.id):!1)&&C.status==="completed"&&!C.result?.error&&C.permissionDecision!=="deny");return b?"footer-status-error":w?"footer-status-orphaned":d?"footer-status-in-progress":_?"footer-status-success":""});function v(){i.value=!i.value}return(p,b)=>(u(),m("div",Gu,[s("div",{class:ee(["tool-footer-summary",y.value]),onClick:v,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Xe(v,["enter"]),Xe(he(v,["prevent"]),["space"])]},[s("div",Ju,[s("span",Xu,"Used: "+$(f.value),1)]),s("div",Qu,[b[0]||(b[0]=s("span",{class:"footer-separator"},"|",-1)),s("span",Zu,$(h.value),1)]),s("div",ed,[s("span",td,$(r.value),1)])],42,Yu),i.value?(u(),m("div",sd,[(u(!0),m(re,null,ce(c.value,w=>(u(),ge(_o,{key:w.id,toolCall:w},null,8,["toolCall"]))),128))])):M("",!0),l.value.length>0?(u(),m("div",od,[(u(!0),m(re,null,ce(l.value,w=>(u(),ge(_o,{key:w.id,toolCall:w},null,8,["toolCall"]))),128))])):M("",!0)]))}},id=te(nd,[["__scopeId","data-v-7bae7ae1"]]),ad={class:"message-row message-row-assistant"},ld=["title"],rd={class:"message-content-column"},cd={key:0,class:"thinking-block mb-2"},ud=["innerHTML"],dd={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(o){const e=o,t=xe(),n=ae();tt.setOptions({breaks:!0,gfm:!0});const i=g(()=>Pt(e.message.timestamp)),a=g(()=>e.message.metadata?.model||null),l=g(()=>{const b=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${b}`}),c=g(()=>{const b=e.message.content||"";return b.trim().length>0&&b!=="Assistant response"}),f=g(()=>{const b=e.message.content||"";let w=tt.parse(b);return w=w.replace(/\n</g,"<"),w=w.replace(/\n+$/,""),is.sanitize(w)}),h=g(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),r=g(()=>e.message.metadata?.thinking_content||""),y=g(()=>{const b=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,w=e.attachedTools&&e.attachedTools.length>0;return b||w}),v=g(()=>{const b=e.message.metadata?.tool_uses||[],w=e.attachedTools||[],d=[...b],_=new Set(b.map(C=>C.id));for(const C of w)_.has(C.id)||d.push(C);return d}),p=g(()=>{const b=n.currentSessionId;if(!b)return[];const w=t.toolCallsBySession.get(b)||[];return v.value.map(d=>{const _=w.find(C=>C.id===d.id);return _||{id:d.id,name:d.name,input:d.input,status:"pending",result:null,timestamp:d.timestamp||e.message.timestamp,isExpanded:!0}})});return(b,w)=>(u(),m("div",ad,[s("div",{class:"message-speaker",title:l.value},[...w[0]||(w[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,ld),s("div",rd,[h.value?(u(),m("div",cd,[de(da,{thinking:r.value},null,8,["thinking"])])):M("",!0),c.value?(u(),m("div",{key:1,class:"message-text",innerHTML:f.value},null,8,ud)):M("",!0),y.value?(u(),ge(id,{key:2,tools:p.value},null,8,["tools"])):M("",!0)])]))}},md=te(dd,[["__scopeId","data-v-2e32f6ef"]]),pd={key:0,class:"message-row message-row-compaction"},fd=["title"],vd={class:"message-content-column"},hd={class:"compaction-status-content"},_d={class:"text-muted ms-auto"},gd={key:1,class:"message-row message-row-system"},bd=["title"],yd={class:"message-content-column"},wd={class:"system-text"},$d={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(o){const e=o,t=g(()=>Pt(e.message.timestamp)),n=g(()=>`system
${t.value}`),i=g(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,l)=>i.value?(u(),m("div",pd,[s("div",{class:"message-speaker",title:n.value},[...l[0]||(l[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,fd),s("div",vd,[s("div",hd,[l[1]||(l[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",_d,$(t.value),1)])])])):(u(),m("div",gd,[s("div",{class:"message-speaker",title:n.value},[...l[3]||(l[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,bd),s("div",yd,[s("span",wd,$(o.message.content),1)])]))}},go=te($d,[["__scopeId","data-v-a078178f"]]),Ed={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(o){const e=o,t=g(()=>{switch(e.message.type){case"user":return na;case"assistant":return md;case"system":return go;default:return go}});return(n,i)=>(u(),ge(tn(t.value),{message:o.message,attachedTools:o.attachedTools},null,8,["message","attachedTools"]))}},Cd=te(Ed,[["__scopeId","data-v-11dff525"]]);var ye="top",Ee="bottom",Ce="right",we="left",as="auto",St=[ye,Ee,Ce,we],st="start",vt="end",on="clippingParents",Us="viewport",ct="popper",nn="reference",js=St.reduce(function(o,e){return o.concat([e+"-"+st,e+"-"+vt])},[]),qs=[].concat(St,[as]).reduce(function(o,e){return o.concat([e,e+"-"+st,e+"-"+vt])},[]),an="beforeRead",ln="read",rn="afterRead",cn="beforeMain",un="main",dn="afterMain",mn="beforeWrite",pn="write",fn="afterWrite",vn=[an,ln,rn,cn,un,dn,mn,pn,fn];function Ie(o){return o?(o.nodeName||"").toLowerCase():null}function Se(o){if(o==null)return window;if(o.toString()!=="[object Window]"){var e=o.ownerDocument;return e&&e.defaultView||window}return o}function ot(o){var e=Se(o).Element;return o instanceof e||o instanceof Element}function Te(o){var e=Se(o).HTMLElement;return o instanceof e||o instanceof HTMLElement}function zs(o){if(typeof ShadowRoot>"u")return!1;var e=Se(o).ShadowRoot;return o instanceof e||o instanceof ShadowRoot}function Sd(o){var e=o.state;Object.keys(e.elements).forEach(function(t){var n=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Te(a)||!Ie(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(l){var c=i[l];c===!1?a.removeAttribute(l):a.setAttribute(l,c===!0?"":c)}))})}function kd(o){var e=o.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},l=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:t[n]),c=l.reduce(function(f,h){return f[h]="",f},{});!Te(i)||!Ie(i)||(Object.assign(i.style,c),Object.keys(a).forEach(function(f){i.removeAttribute(f)}))})}}const hn={name:"applyStyles",enabled:!0,phase:"write",fn:Sd,effect:kd,requires:["computeStyles"]};function De(o){return o.split("-")[0]}var et=Math.max,ts=Math.min,ht=Math.round;function Rs(){var o=navigator.userAgentData;return o!=null&&o.brands&&Array.isArray(o.brands)?o.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function _n(){return!/^((?!chrome|android).)*safari/i.test(Rs())}function _t(o,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var n=o.getBoundingClientRect(),i=1,a=1;e&&Te(o)&&(i=o.offsetWidth>0&&ht(n.width)/o.offsetWidth||1,a=o.offsetHeight>0&&ht(n.height)/o.offsetHeight||1);var l=ot(o)?Se(o):window,c=l.visualViewport,f=!_n()&&t,h=(n.left+(f&&c?c.offsetLeft:0))/i,r=(n.top+(f&&c?c.offsetTop:0))/a,y=n.width/i,v=n.height/a;return{width:y,height:v,top:r,right:h+y,bottom:r+v,left:h,x:h,y:r}}function Ks(o){var e=_t(o),t=o.offsetWidth,n=o.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:o.offsetLeft,y:o.offsetTop,width:t,height:n}}function gn(o,e){var t=e.getRootNode&&e.getRootNode();if(o.contains(e))return!0;if(t&&zs(t)){var n=e;do{if(n&&o.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function We(o){return Se(o).getComputedStyle(o)}function Td(o){return["table","td","th"].indexOf(Ie(o))>=0}function Ke(o){return((ot(o)?o.ownerDocument:o.document)||window.document).documentElement}function ls(o){return Ie(o)==="html"?o:o.assignedSlot||o.parentNode||(zs(o)?o.host:null)||Ke(o)}function bo(o){return!Te(o)||We(o).position==="fixed"?null:o.offsetParent}function xd(o){var e=/firefox/i.test(Rs()),t=/Trident/i.test(Rs());if(t&&Te(o)){var n=We(o);if(n.position==="fixed")return null}var i=ls(o);for(zs(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Ie(i))<0;){var a=We(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function jt(o){for(var e=Se(o),t=bo(o);t&&Td(t)&&We(t).position==="static";)t=bo(t);return t&&(Ie(t)==="html"||Ie(t)==="body"&&We(t).position==="static")?e:t||xd(o)||e}function Gs(o){return["top","bottom"].indexOf(o)>=0?"x":"y"}function Dt(o,e,t){return et(o,ts(e,t))}function Ad(o,e,t){var n=Dt(o,e,t);return n>t?t:n}function bn(){return{top:0,right:0,bottom:0,left:0}}function yn(o){return Object.assign({},bn(),o)}function wn(o,e){return e.reduce(function(t,n){return t[n]=o,t},{})}var Md=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,yn(typeof e!="number"?e:wn(e,St))};function Od(o){var e,t=o.state,n=o.name,i=o.options,a=t.elements.arrow,l=t.modifiersData.popperOffsets,c=De(t.placement),f=Gs(c),h=[we,Ce].indexOf(c)>=0,r=h?"height":"width";if(!(!a||!l)){var y=Md(i.padding,t),v=Ks(a),p=f==="y"?ye:we,b=f==="y"?Ee:Ce,w=t.rects.reference[r]+t.rects.reference[f]-l[f]-t.rects.popper[r],d=l[f]-t.rects.reference[f],_=jt(a),C=_?f==="y"?_.clientHeight||0:_.clientWidth||0:0,S=w/2-d/2,D=y[p],V=C-v[r]-y[b],P=C/2-v[r]/2+S,O=Dt(D,P,V),F=f;t.modifiersData[n]=(e={},e[F]=O,e.centerOffset=O-P,e)}}function Nd(o){var e=o.state,t=o.options,n=t.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||gn(e.elements.popper,i)&&(e.elements.arrow=i))}const $n={name:"arrow",enabled:!0,phase:"main",fn:Od,effect:Nd,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function gt(o){return o.split("-")[1]}var Dd={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ld(o,e){var t=o.x,n=o.y,i=e.devicePixelRatio||1;return{x:ht(t*i)/i||0,y:ht(n*i)/i||0}}function yo(o){var e,t=o.popper,n=o.popperRect,i=o.placement,a=o.variation,l=o.offsets,c=o.position,f=o.gpuAcceleration,h=o.adaptive,r=o.roundOffsets,y=o.isFixed,v=l.x,p=v===void 0?0:v,b=l.y,w=b===void 0?0:b,d=typeof r=="function"?r({x:p,y:w}):{x:p,y:w};p=d.x,w=d.y;var _=l.hasOwnProperty("x"),C=l.hasOwnProperty("y"),S=we,D=ye,V=window;if(h){var P=jt(t),O="clientHeight",F="clientWidth";if(P===Se(t)&&(P=Ke(t),We(P).position!=="static"&&c==="absolute"&&(O="scrollHeight",F="scrollWidth")),P=P,i===ye||(i===we||i===Ce)&&a===vt){D=Ee;var A=y&&P===V&&V.visualViewport?V.visualViewport.height:P[O];w-=A-n.height,w*=f?1:-1}if(i===we||(i===ye||i===Ee)&&a===vt){S=Ce;var I=y&&P===V&&V.visualViewport?V.visualViewport.width:P[F];p-=I-n.width,p*=f?1:-1}}var K=Object.assign({position:c},h&&Dd),B=r===!0?Ld({x:p,y:w},Se(t)):{x:p,y:w};if(p=B.x,w=B.y,f){var k;return Object.assign({},K,(k={},k[D]=C?"0":"",k[S]=_?"0":"",k.transform=(V.devicePixelRatio||1)<=1?"translate("+p+"px, "+w+"px)":"translate3d("+p+"px, "+w+"px, 0)",k))}return Object.assign({},K,(e={},e[D]=C?w+"px":"",e[S]=_?p+"px":"",e.transform="",e))}function Id(o){var e=o.state,t=o.options,n=t.gpuAcceleration,i=n===void 0?!0:n,a=t.adaptive,l=a===void 0?!0:a,c=t.roundOffsets,f=c===void 0?!0:c,h={placement:De(e.placement),variation:gt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,yo(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:f})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,yo(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const En={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Id,data:{}};var Ut={passive:!0};function Pd(o){var e=o.state,t=o.instance,n=o.options,i=n.scroll,a=i===void 0?!0:i,l=n.resize,c=l===void 0?!0:l,f=Se(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&h.forEach(function(r){r.addEventListener("scroll",t.update,Ut)}),c&&f.addEventListener("resize",t.update,Ut),function(){a&&h.forEach(function(r){r.removeEventListener("scroll",t.update,Ut)}),c&&f.removeEventListener("resize",t.update,Ut)}}const Cn={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Pd,data:{}};var jd={left:"right",right:"left",bottom:"top",top:"bottom"};function Xt(o){return o.replace(/left|right|bottom|top/g,function(e){return jd[e]})}var Rd={start:"end",end:"start"};function wo(o){return o.replace(/start|end/g,function(e){return Rd[e]})}function Ys(o){var e=Se(o),t=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:t,scrollTop:n}}function Js(o){return _t(Ke(o)).left+Ys(o).scrollLeft}function Wd(o,e){var t=Se(o),n=Ke(o),i=t.visualViewport,a=n.clientWidth,l=n.clientHeight,c=0,f=0;if(i){a=i.width,l=i.height;var h=_n();(h||!h&&e==="fixed")&&(c=i.offsetLeft,f=i.offsetTop)}return{width:a,height:l,x:c+Js(o),y:f}}function Vd(o){var e,t=Ke(o),n=Ys(o),i=(e=o.ownerDocument)==null?void 0:e.body,a=et(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=et(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),c=-n.scrollLeft+Js(o),f=-n.scrollTop;return We(i||t).direction==="rtl"&&(c+=et(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:c,y:f}}function Xs(o){var e=We(o),t=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+n)}function Sn(o){return["html","body","#document"].indexOf(Ie(o))>=0?o.ownerDocument.body:Te(o)&&Xs(o)?o:Sn(ls(o))}function Lt(o,e){var t;e===void 0&&(e=[]);var n=Sn(o),i=n===((t=o.ownerDocument)==null?void 0:t.body),a=Se(n),l=i?[a].concat(a.visualViewport||[],Xs(n)?n:[]):n,c=e.concat(l);return i?c:c.concat(Lt(ls(l)))}function Ws(o){return Object.assign({},o,{left:o.x,top:o.y,right:o.x+o.width,bottom:o.y+o.height})}function Hd(o,e){var t=_t(o,!1,e==="fixed");return t.top=t.top+o.clientTop,t.left=t.left+o.clientLeft,t.bottom=t.top+o.clientHeight,t.right=t.left+o.clientWidth,t.width=o.clientWidth,t.height=o.clientHeight,t.x=t.left,t.y=t.top,t}function $o(o,e,t){return e===Us?Ws(Wd(o,t)):ot(e)?Hd(e,t):Ws(Vd(Ke(o)))}function Fd(o){var e=Lt(ls(o)),t=["absolute","fixed"].indexOf(We(o).position)>=0,n=t&&Te(o)?jt(o):o;return ot(n)?e.filter(function(i){return ot(i)&&gn(i,n)&&Ie(i)!=="body"}):[]}function Bd(o,e,t,n){var i=e==="clippingParents"?Fd(o):[].concat(e),a=[].concat(i,[t]),l=a[0],c=a.reduce(function(f,h){var r=$o(o,h,n);return f.top=et(r.top,f.top),f.right=ts(r.right,f.right),f.bottom=ts(r.bottom,f.bottom),f.left=et(r.left,f.left),f},$o(o,l,n));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function kn(o){var e=o.reference,t=o.element,n=o.placement,i=n?De(n):null,a=n?gt(n):null,l=e.x+e.width/2-t.width/2,c=e.y+e.height/2-t.height/2,f;switch(i){case ye:f={x:l,y:e.y-t.height};break;case Ee:f={x:l,y:e.y+e.height};break;case Ce:f={x:e.x+e.width,y:c};break;case we:f={x:e.x-t.width,y:c};break;default:f={x:e.x,y:e.y}}var h=i?Gs(i):null;if(h!=null){var r=h==="y"?"height":"width";switch(a){case st:f[h]=f[h]-(e[r]/2-t[r]/2);break;case vt:f[h]=f[h]+(e[r]/2-t[r]/2);break}}return f}function bt(o,e){e===void 0&&(e={});var t=e,n=t.placement,i=n===void 0?o.placement:n,a=t.strategy,l=a===void 0?o.strategy:a,c=t.boundary,f=c===void 0?on:c,h=t.rootBoundary,r=h===void 0?Us:h,y=t.elementContext,v=y===void 0?ct:y,p=t.altBoundary,b=p===void 0?!1:p,w=t.padding,d=w===void 0?0:w,_=yn(typeof d!="number"?d:wn(d,St)),C=v===ct?nn:ct,S=o.rects.popper,D=o.elements[b?C:v],V=Bd(ot(D)?D:D.contextElement||Ke(o.elements.popper),f,r,l),P=_t(o.elements.reference),O=kn({reference:P,element:S,placement:i}),F=Ws(Object.assign({},S,O)),A=v===ct?F:P,I={top:V.top-A.top+_.top,bottom:A.bottom-V.bottom+_.bottom,left:V.left-A.left+_.left,right:A.right-V.right+_.right},K=o.modifiersData.offset;if(v===ct&&K){var B=K[i];Object.keys(I).forEach(function(k){var E=[Ce,Ee].indexOf(k)>=0?1:-1,N=[ye,Ee].indexOf(k)>=0?"y":"x";I[k]+=B[N]*E})}return I}function Ud(o,e){e===void 0&&(e={});var t=e,n=t.placement,i=t.boundary,a=t.rootBoundary,l=t.padding,c=t.flipVariations,f=t.allowedAutoPlacements,h=f===void 0?qs:f,r=gt(n),y=r?c?js:js.filter(function(b){return gt(b)===r}):St,v=y.filter(function(b){return h.indexOf(b)>=0});v.length===0&&(v=y);var p=v.reduce(function(b,w){return b[w]=bt(o,{placement:w,boundary:i,rootBoundary:a,padding:l})[De(w)],b},{});return Object.keys(p).sort(function(b,w){return p[b]-p[w]})}function qd(o){if(De(o)===as)return[];var e=Xt(o);return[wo(o),e,wo(e)]}function zd(o){var e=o.state,t=o.options,n=o.name;if(!e.modifiersData[n]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,l=t.altAxis,c=l===void 0?!0:l,f=t.fallbackPlacements,h=t.padding,r=t.boundary,y=t.rootBoundary,v=t.altBoundary,p=t.flipVariations,b=p===void 0?!0:p,w=t.allowedAutoPlacements,d=e.options.placement,_=De(d),C=_===d,S=f||(C||!b?[Xt(d)]:qd(d)),D=[d].concat(S).reduce(function(J,pe){return J.concat(De(pe)===as?Ud(e,{placement:pe,boundary:r,rootBoundary:y,padding:h,flipVariations:b,allowedAutoPlacements:w}):pe)},[]),V=e.rects.reference,P=e.rects.popper,O=new Map,F=!0,A=D[0],I=0;I<D.length;I++){var K=D[I],B=De(K),k=gt(K)===st,E=[ye,Ee].indexOf(B)>=0,N=E?"width":"height",x=bt(e,{placement:K,boundary:r,rootBoundary:y,altBoundary:v,padding:h}),T=E?k?Ce:we:k?Ee:ye;V[N]>P[N]&&(T=Xt(T));var j=Xt(T),q=[];if(a&&q.push(x[B]<=0),c&&q.push(x[T]<=0,x[j]<=0),q.every(function(J){return J})){A=K,F=!1;break}O.set(K,q)}if(F)for(var Y=b?3:1,Q=function(pe){var z=D.find(function(W){var H=O.get(W);if(H)return H.slice(0,pe).every(function(X){return X})});if(z)return A=z,"break"},G=Y;G>0;G--){var R=Q(G);if(R==="break")break}e.placement!==A&&(e.modifiersData[n]._skip=!0,e.placement=A,e.reset=!0)}}const Tn={name:"flip",enabled:!0,phase:"main",fn:zd,requiresIfExists:["offset"],data:{_skip:!1}};function Eo(o,e,t){return t===void 0&&(t={x:0,y:0}),{top:o.top-e.height-t.y,right:o.right-e.width+t.x,bottom:o.bottom-e.height+t.y,left:o.left-e.width-t.x}}function Co(o){return[ye,Ce,Ee,we].some(function(e){return o[e]>=0})}function Kd(o){var e=o.state,t=o.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=bt(e,{elementContext:"reference"}),c=bt(e,{altBoundary:!0}),f=Eo(l,n),h=Eo(c,i,a),r=Co(f),y=Co(h);e.modifiersData[t]={referenceClippingOffsets:f,popperEscapeOffsets:h,isReferenceHidden:r,hasPopperEscaped:y},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":r,"data-popper-escaped":y})}const xn={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Kd};function Gd(o,e,t){var n=De(o),i=[we,ye].indexOf(n)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:o})):t,l=a[0],c=a[1];return l=l||0,c=(c||0)*i,[we,Ce].indexOf(n)>=0?{x:c,y:l}:{x:l,y:c}}function Yd(o){var e=o.state,t=o.options,n=o.name,i=t.offset,a=i===void 0?[0,0]:i,l=qs.reduce(function(r,y){return r[y]=Gd(y,e.rects,a),r},{}),c=l[e.placement],f=c.x,h=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=f,e.modifiersData.popperOffsets.y+=h),e.modifiersData[n]=l}const An={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Yd};function Jd(o){var e=o.state,t=o.name;e.modifiersData[t]=kn({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Mn={name:"popperOffsets",enabled:!0,phase:"read",fn:Jd,data:{}};function Xd(o){return o==="x"?"y":"x"}function Qd(o){var e=o.state,t=o.options,n=o.name,i=t.mainAxis,a=i===void 0?!0:i,l=t.altAxis,c=l===void 0?!1:l,f=t.boundary,h=t.rootBoundary,r=t.altBoundary,y=t.padding,v=t.tether,p=v===void 0?!0:v,b=t.tetherOffset,w=b===void 0?0:b,d=bt(e,{boundary:f,rootBoundary:h,padding:y,altBoundary:r}),_=De(e.placement),C=gt(e.placement),S=!C,D=Gs(_),V=Xd(D),P=e.modifiersData.popperOffsets,O=e.rects.reference,F=e.rects.popper,A=typeof w=="function"?w(Object.assign({},e.rects,{placement:e.placement})):w,I=typeof A=="number"?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),K=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(P){if(a){var k,E=D==="y"?ye:we,N=D==="y"?Ee:Ce,x=D==="y"?"height":"width",T=P[D],j=T+d[E],q=T-d[N],Y=p?-F[x]/2:0,Q=C===st?O[x]:F[x],G=C===st?-F[x]:-O[x],R=e.elements.arrow,J=p&&R?Ks(R):{width:0,height:0},pe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:bn(),z=pe[E],W=pe[N],H=Dt(0,O[x],J[x]),X=S?O[x]/2-Y-H-z-I.mainAxis:Q-H-z-I.mainAxis,se=S?-O[x]/2+Y+H+W+I.mainAxis:G+H+W+I.mainAxis,fe=e.elements.arrow&&jt(e.elements.arrow),fs=fe?D==="y"?fe.clientTop||0:fe.clientLeft||0:0,He=(k=K?.[D])!=null?k:0,At=T+X-He-fs,Mt=T+se-He,at=Dt(p?ts(j,At):j,T,p?et(q,Mt):q);P[D]=at,B[D]=at-T}if(c){var Ft,ui=D==="x"?ye:we,di=D==="x"?Ee:Ce,Je=P[V],Bt=V==="y"?"height":"width",io=Je+d[ui],ao=Je-d[di],vs=[ye,we].indexOf(_)!==-1,lo=(Ft=K?.[V])!=null?Ft:0,ro=vs?io:Je-O[Bt]-F[Bt]-lo+I.altAxis,co=vs?Je+O[Bt]+F[Bt]-lo-I.altAxis:ao,uo=p&&vs?Ad(ro,Je,co):Dt(p?ro:io,Je,p?co:ao);P[V]=uo,B[V]=uo-Je}e.modifiersData[n]=B}}const On={name:"preventOverflow",enabled:!0,phase:"main",fn:Qd,requiresIfExists:["offset"]};function Zd(o){return{scrollLeft:o.scrollLeft,scrollTop:o.scrollTop}}function em(o){return o===Se(o)||!Te(o)?Ys(o):Zd(o)}function tm(o){var e=o.getBoundingClientRect(),t=ht(e.width)/o.offsetWidth||1,n=ht(e.height)/o.offsetHeight||1;return t!==1||n!==1}function sm(o,e,t){t===void 0&&(t=!1);var n=Te(e),i=Te(e)&&tm(e),a=Ke(e),l=_t(o,i,t),c={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(n||!n&&!t)&&((Ie(e)!=="body"||Xs(a))&&(c=em(e)),Te(e)?(f=_t(e,!0),f.x+=e.clientLeft,f.y+=e.clientTop):a&&(f.x=Js(a))),{x:l.left+c.scrollLeft-f.x,y:l.top+c.scrollTop-f.y,width:l.width,height:l.height}}function om(o){var e=new Map,t=new Set,n=[];o.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(c){if(!t.has(c)){var f=e.get(c);f&&i(f)}}),n.push(a)}return o.forEach(function(a){t.has(a.name)||i(a)}),n}function nm(o){var e=om(o);return vn.reduce(function(t,n){return t.concat(e.filter(function(i){return i.phase===n}))},[])}function im(o){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(o())})})),e}}function am(o){var e=o.reduce(function(t,n){var i=t[n.name];return t[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,t},{});return Object.keys(e).map(function(t){return e[t]})}var So={placement:"bottom",modifiers:[],strategy:"absolute"};function ko(){for(var o=arguments.length,e=new Array(o),t=0;t<o;t++)e[t]=arguments[t];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Nn(o){o===void 0&&(o={});var e=o,t=e.defaultModifiers,n=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?So:i;return function(c,f,h){h===void 0&&(h=a);var r={placement:"bottom",orderedModifiers:[],options:Object.assign({},So,a),modifiersData:{},elements:{reference:c,popper:f},attributes:{},styles:{}},y=[],v=!1,p={state:r,setOptions:function(_){var C=typeof _=="function"?_(r.options):_;w(),r.options=Object.assign({},a,r.options,C),r.scrollParents={reference:ot(c)?Lt(c):c.contextElement?Lt(c.contextElement):[],popper:Lt(f)};var S=nm(am([].concat(n,r.options.modifiers)));return r.orderedModifiers=S.filter(function(D){return D.enabled}),b(),p.update()},forceUpdate:function(){if(!v){var _=r.elements,C=_.reference,S=_.popper;if(ko(C,S)){r.rects={reference:sm(C,jt(S),r.options.strategy==="fixed"),popper:Ks(S)},r.reset=!1,r.placement=r.options.placement,r.orderedModifiers.forEach(function(I){return r.modifiersData[I.name]=Object.assign({},I.data)});for(var D=0;D<r.orderedModifiers.length;D++){if(r.reset===!0){r.reset=!1,D=-1;continue}var V=r.orderedModifiers[D],P=V.fn,O=V.options,F=O===void 0?{}:O,A=V.name;typeof P=="function"&&(r=P({state:r,options:F,name:A,instance:p})||r)}}}},update:im(function(){return new Promise(function(d){p.forceUpdate(),d(r)})}),destroy:function(){w(),v=!0}};if(!ko(c,f))return p;p.setOptions(h).then(function(d){!v&&h.onFirstUpdate&&h.onFirstUpdate(d)});function b(){r.orderedModifiers.forEach(function(d){var _=d.name,C=d.options,S=C===void 0?{}:C,D=d.effect;if(typeof D=="function"){var V=D({state:r,name:_,instance:p,options:S}),P=function(){};y.push(V||P)}})}function w(){y.forEach(function(d){return d()}),y=[]}return p}}var lm=[Cn,Mn,En,hn,An,Tn,On,$n,xn],Qs=Nn({defaultModifiers:lm});const Dn=Object.freeze(Object.defineProperty({__proto__:null,afterMain:dn,afterRead:rn,afterWrite:fn,applyStyles:hn,arrow:$n,auto:as,basePlacements:St,beforeMain:cn,beforeRead:an,beforeWrite:mn,bottom:Ee,clippingParents:on,computeStyles:En,createPopper:Qs,detectOverflow:bt,end:vt,eventListeners:Cn,flip:Tn,hide:xn,left:we,main:un,modifierPhases:vn,offset:An,placements:qs,popper:ct,popperGenerator:Nn,popperOffsets:Mn,preventOverflow:On,read:ln,reference:nn,right:Ce,start:st,top:ye,variationPlacements:js,viewport:Us,write:pn},Symbol.toStringTag,{value:"Module"}));const Fe=new Map,ys={set(o,e,t){Fe.has(o)||Fe.set(o,new Map);const n=Fe.get(o);if(!n.has(e)&&n.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`);return}n.set(e,t)},get(o,e){return Fe.has(o)&&Fe.get(o).get(e)||null},remove(o,e){if(!Fe.has(o))return;const t=Fe.get(o);t.delete(e),t.size===0&&Fe.delete(o)}},rm=1e6,cm=1e3,Vs="transitionend",Ln=o=>(o&&window.CSS&&window.CSS.escape&&(o=o.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),o),um=o=>o==null?`${o}`:Object.prototype.toString.call(o).match(/\s([a-z]+)/i)[1].toLowerCase(),dm=o=>{do o+=Math.floor(Math.random()*rm);while(document.getElementById(o));return o},mm=o=>{if(!o)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(o);const n=Number.parseFloat(e),i=Number.parseFloat(t);return!n&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*cm)},In=o=>{o.dispatchEvent(new Event(Vs))},je=o=>!o||typeof o!="object"?!1:(typeof o.jquery<"u"&&(o=o[0]),typeof o.nodeType<"u"),Be=o=>je(o)?o.jquery?o[0]:o:typeof o=="string"&&o.length>0?document.querySelector(Ln(o)):null,kt=o=>{if(!je(o)||o.getClientRects().length===0)return!1;const e=getComputedStyle(o).getPropertyValue("visibility")==="visible",t=o.closest("details:not([open])");if(!t)return e;if(t!==o){const n=o.closest("summary");if(n&&n.parentNode!==t||n===null)return!1}return e},Ue=o=>!o||o.nodeType!==Node.ELEMENT_NODE||o.classList.contains("disabled")?!0:typeof o.disabled<"u"?o.disabled:o.hasAttribute("disabled")&&o.getAttribute("disabled")!=="false",Pn=o=>{if(!document.documentElement.attachShadow)return null;if(typeof o.getRootNode=="function"){const e=o.getRootNode();return e instanceof ShadowRoot?e:null}return o instanceof ShadowRoot?o:o.parentNode?Pn(o.parentNode):null},ss=()=>{},Rt=o=>{o.offsetHeight},jn=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,ws=[],pm=o=>{document.readyState==="loading"?(ws.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of ws)e()}),ws.push(o)):o()},Ae=()=>document.documentElement.dir==="rtl",Oe=o=>{pm(()=>{const e=jn();if(e){const t=o.NAME,n=e.fn[t];e.fn[t]=o.jQueryInterface,e.fn[t].Constructor=o,e.fn[t].noConflict=()=>(e.fn[t]=n,o.jQueryInterface)}})},$e=(o,e=[],t=o)=>typeof o=="function"?o.call(...e):t,Rn=(o,e,t=!0)=>{if(!t){$e(o);return}const i=mm(e)+5;let a=!1;const l=({target:c})=>{c===e&&(a=!0,e.removeEventListener(Vs,l),$e(o))};e.addEventListener(Vs,l),setTimeout(()=>{a||In(e)},i)},Zs=(o,e,t,n)=>{const i=o.length;let a=o.indexOf(e);return a===-1?!t&&n?o[i-1]:o[0]:(a+=t?1:-1,n&&(a=(a+i)%i),o[Math.max(0,Math.min(a,i-1))])},fm=/[^.]*(?=\..*)\.|.*/,vm=/\..*/,hm=/::\d+$/,$s={};let To=1;const Wn={mouseenter:"mouseover",mouseleave:"mouseout"},_m=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vn(o,e){return e&&`${e}::${To++}`||o.uidEvent||To++}function Hn(o){const e=Vn(o);return o.uidEvent=e,$s[e]=$s[e]||{},$s[e]}function gm(o,e){return function t(n){return eo(n,{delegateTarget:o}),t.oneOff&&U.off(o,n.type,e),e.apply(o,[n])}}function bm(o,e,t){return function n(i){const a=o.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const c of a)if(c===l)return eo(i,{delegateTarget:l}),n.oneOff&&U.off(o,i.type,e,t),t.apply(l,[i])}}function Fn(o,e,t=null){return Object.values(o).find(n=>n.callable===e&&n.delegationSelector===t)}function Bn(o,e,t){const n=typeof e=="string",i=n?t:e||t;let a=Un(o);return _m.has(a)||(a=o),[n,i,a]}function xo(o,e,t,n,i){if(typeof e!="string"||!o)return;let[a,l,c]=Bn(e,t,n);e in Wn&&(l=(b=>function(w){if(!w.relatedTarget||w.relatedTarget!==w.delegateTarget&&!w.delegateTarget.contains(w.relatedTarget))return b.call(this,w)})(l));const f=Hn(o),h=f[c]||(f[c]={}),r=Fn(h,l,a?t:null);if(r){r.oneOff=r.oneOff&&i;return}const y=Vn(l,e.replace(fm,"")),v=a?bm(o,t,l):gm(o,l);v.delegationSelector=a?t:null,v.callable=l,v.oneOff=i,v.uidEvent=y,h[y]=v,o.addEventListener(c,v,a)}function Hs(o,e,t,n,i){const a=Fn(e[t],n,i);a&&(o.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function ym(o,e,t,n){const i=e[t]||{};for(const[a,l]of Object.entries(i))a.includes(n)&&Hs(o,e,t,l.callable,l.delegationSelector)}function Un(o){return o=o.replace(vm,""),Wn[o]||o}const U={on(o,e,t,n){xo(o,e,t,n,!1)},one(o,e,t,n){xo(o,e,t,n,!0)},off(o,e,t,n){if(typeof e!="string"||!o)return;const[i,a,l]=Bn(e,t,n),c=l!==e,f=Hn(o),h=f[l]||{},r=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(h).length)return;Hs(o,f,l,a,i?t:null);return}if(r)for(const y of Object.keys(f))ym(o,f,y,e.slice(1));for(const[y,v]of Object.entries(h)){const p=y.replace(hm,"");(!c||e.includes(p))&&Hs(o,f,l,v.callable,v.delegationSelector)}},trigger(o,e,t){if(typeof e!="string"||!o)return null;const n=jn(),i=Un(e),a=e!==i;let l=null,c=!0,f=!0,h=!1;a&&n&&(l=n.Event(e,t),n(o).trigger(l),c=!l.isPropagationStopped(),f=!l.isImmediatePropagationStopped(),h=l.isDefaultPrevented());const r=eo(new Event(e,{bubbles:c,cancelable:!0}),t);return h&&r.preventDefault(),f&&o.dispatchEvent(r),r.defaultPrevented&&l&&l.preventDefault(),r}};function eo(o,e={}){for(const[t,n]of Object.entries(e))try{o[t]=n}catch{Object.defineProperty(o,t,{configurable:!0,get(){return n}})}return o}function Ao(o){if(o==="true")return!0;if(o==="false")return!1;if(o===Number(o).toString())return Number(o);if(o===""||o==="null")return null;if(typeof o!="string")return o;try{return JSON.parse(decodeURIComponent(o))}catch{return o}}function Es(o){return o.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Re={setDataAttribute(o,e,t){o.setAttribute(`data-bs-${Es(e)}`,t)},removeDataAttribute(o,e){o.removeAttribute(`data-bs-${Es(e)}`)},getDataAttributes(o){if(!o)return{};const e={},t=Object.keys(o.dataset).filter(n=>n.startsWith("bs")&&!n.startsWith("bsConfig"));for(const n of t){let i=n.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Ao(o.dataset[n])}return e},getDataAttribute(o,e){return Ao(o.getAttribute(`data-bs-${Es(e)}`))}};class Wt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const n=je(t)?Re.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof n=="object"?n:{},...je(t)?Re.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[n,i]of Object.entries(t)){const a=e[n],l=je(a)?"element":um(a);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${l}" but expected type "${i}".`)}}}const wm="5.3.8";class Ne extends Wt{constructor(e,t){super(),e=Be(e),e&&(this._element=e,this._config=this._getConfig(t),ys.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ys.remove(this._element,this.constructor.DATA_KEY),U.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,n=!0){Rn(e,t,n)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ys.get(Be(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return wm}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Cs=o=>{let e=o.getAttribute("data-bs-target");if(!e||e==="#"){let t=o.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Ln(t)).join(","):null},Z={find(o,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,o))},findOne(o,e=document.documentElement){return Element.prototype.querySelector.call(e,o)},children(o,e){return[].concat(...o.children).filter(t=>t.matches(e))},parents(o,e){const t=[];let n=o.parentNode.closest(e);for(;n;)t.push(n),n=n.parentNode.closest(e);return t},prev(o,e){let t=o.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(o,e){let t=o.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(o){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,o).filter(t=>!Ue(t)&&kt(t))},getSelectorFromElement(o){const e=Cs(o);return e&&Z.findOne(e)?e:null},getElementFromSelector(o){const e=Cs(o);return e?Z.findOne(e):null},getMultipleElementsFromSelector(o){const e=Cs(o);return e?Z.find(e):[]}},rs=(o,e="hide")=>{const t=`click.dismiss${o.EVENT_KEY}`,n=o.NAME;U.on(document,t,`[data-bs-dismiss="${n}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Ue(this))return;const a=Z.getElementFromSelector(this)||this.closest(`.${n}`);o.getOrCreateInstance(a)[e]()})},$m="alert",Em="bs.alert",qn=`.${Em}`,Cm=`close${qn}`,Sm=`closed${qn}`,km="fade",Tm="show";class cs extends Ne{static get NAME(){return $m}close(){if(U.trigger(this._element,Cm).defaultPrevented)return;this._element.classList.remove(Tm);const t=this._element.classList.contains(km);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),U.trigger(this._element,Sm),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=cs.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}rs(cs,"close");Oe(cs);const xm="button",Am="bs.button",Mm=`.${Am}`,Om=".data-api",Nm="active",Mo='[data-bs-toggle="button"]',Dm=`click${Mm}${Om}`;class us extends Ne{static get NAME(){return xm}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Nm))}static jQueryInterface(e){return this.each(function(){const t=us.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}U.on(document,Dm,Mo,o=>{o.preventDefault();const e=o.target.closest(Mo);us.getOrCreateInstance(e).toggle()});Oe(us);const Lm="swipe",Tt=".bs.swipe",Im=`touchstart${Tt}`,Pm=`touchmove${Tt}`,jm=`touchend${Tt}`,Rm=`pointerdown${Tt}`,Wm=`pointerup${Tt}`,Vm="touch",Hm="pen",Fm="pointer-event",Bm=40,Um={endCallback:null,leftCallback:null,rightCallback:null},qm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class os extends Wt{constructor(e,t){super(),this._element=e,!(!e||!os.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Um}static get DefaultType(){return qm}static get NAME(){return Lm}dispose(){U.off(this._element,Tt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),$e(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Bm)return;const t=e/this._deltaX;this._deltaX=0,t&&$e(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(U.on(this._element,Rm,e=>this._start(e)),U.on(this._element,Wm,e=>this._end(e)),this._element.classList.add(Fm)):(U.on(this._element,Im,e=>this._start(e)),U.on(this._element,Pm,e=>this._move(e)),U.on(this._element,jm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Hm||e.pointerType===Vm)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const zm="carousel",Km="bs.carousel",Ge=`.${Km}`,zn=".data-api",Gm="ArrowLeft",Ym="ArrowRight",Jm=500,Ot="next",lt="prev",ut="left",Qt="right",Xm=`slide${Ge}`,Ss=`slid${Ge}`,Qm=`keydown${Ge}`,Zm=`mouseenter${Ge}`,ep=`mouseleave${Ge}`,tp=`dragstart${Ge}`,sp=`load${Ge}${zn}`,op=`click${Ge}${zn}`,Kn="carousel",qt="active",np="slide",ip="carousel-item-end",ap="carousel-item-start",lp="carousel-item-next",rp="carousel-item-prev",Gn=".active",Yn=".carousel-item",cp=Gn+Yn,up=".carousel-item img",dp=".carousel-indicators",mp="[data-bs-slide], [data-bs-slide-to]",pp='[data-bs-ride="carousel"]',fp={[Gm]:Qt,[Ym]:ut},vp={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},hp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Vt extends Ne{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Z.findOne(dp,this._element),this._addEventListeners(),this._config.ride===Kn&&this.cycle()}static get Default(){return vp}static get DefaultType(){return hp}static get NAME(){return zm}next(){this._slide(Ot)}nextWhenVisible(){!document.hidden&&kt(this._element)&&this.next()}prev(){this._slide(lt)}pause(){this._isSliding&&In(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){U.one(this._element,Ss,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){U.one(this._element,Ss,()=>this.to(e));return}const n=this._getItemIndex(this._getActive());if(n===e)return;const i=e>n?Ot:lt;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&U.on(this._element,Qm,e=>this._keydown(e)),this._config.pause==="hover"&&(U.on(this._element,Zm,()=>this.pause()),U.on(this._element,ep,()=>this._maybeEnableCycle())),this._config.touch&&os.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const n of Z.find(up,this._element))U.on(n,tp,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(ut)),rightCallback:()=>this._slide(this._directionToOrder(Qt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Jm+this._config.interval))}};this._swipeHelper=new os(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=fp[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=Z.findOne(Gn,this._indicatorsElement);t.classList.remove(qt),t.removeAttribute("aria-current");const n=Z.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);n&&(n.classList.add(qt),n.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const n=this._getActive(),i=e===Ot,a=t||Zs(this._getItems(),n,i,this._config.wrap);if(a===n)return;const l=this._getItemIndex(a),c=p=>U.trigger(this._element,p,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(n),to:l});if(c(Xm).defaultPrevented||!n||!a)return;const h=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=a;const r=i?ap:ip,y=i?lp:rp;a.classList.add(y),Rt(a),n.classList.add(r),a.classList.add(r);const v=()=>{a.classList.remove(r,y),a.classList.add(qt),n.classList.remove(qt,y,r),this._isSliding=!1,c(Ss)};this._queueCallback(v,n,this._isAnimated()),h&&this.cycle()}_isAnimated(){return this._element.classList.contains(np)}_getActive(){return Z.findOne(cp,this._element)}_getItems(){return Z.find(Yn,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ae()?e===ut?lt:Ot:e===ut?Ot:lt}_orderToDirection(e){return Ae()?e===lt?ut:Qt:e===lt?Qt:ut}static jQueryInterface(e){return this.each(function(){const t=Vt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}U.on(document,op,mp,function(o){const e=Z.getElementFromSelector(this);if(!e||!e.classList.contains(Kn))return;o.preventDefault();const t=Vt.getOrCreateInstance(e),n=this.getAttribute("data-bs-slide-to");if(n){t.to(n),t._maybeEnableCycle();return}if(Re.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});U.on(window,sp,()=>{const o=Z.find(pp);for(const e of o)Vt.getOrCreateInstance(e)});Oe(Vt);const _p="collapse",gp="bs.collapse",Ht=`.${gp}`,bp=".data-api",yp=`show${Ht}`,wp=`shown${Ht}`,$p=`hide${Ht}`,Ep=`hidden${Ht}`,Cp=`click${Ht}${bp}`,ks="show",mt="collapse",zt="collapsing",Sp="collapsed",kp=`:scope .${mt} .${mt}`,Tp="collapse-horizontal",xp="width",Ap="height",Mp=".collapse.show, .collapse.collapsing",Fs='[data-bs-toggle="collapse"]',Op={parent:null,toggle:!0},Np={parent:"(null|element)",toggle:"boolean"};class yt extends Ne{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const n=Z.find(Fs);for(const i of n){const a=Z.getSelectorFromElement(i),l=Z.find(a).filter(c=>c===this._element);a!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Op}static get DefaultType(){return Np}static get NAME(){return _p}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Mp).filter(c=>c!==this._element).map(c=>yt.getOrCreateInstance(c,{toggle:!1}))),e.length&&e[0]._isTransitioning||U.trigger(this._element,yp).defaultPrevented)return;for(const c of e)c.hide();const n=this._getDimension();this._element.classList.remove(mt),this._element.classList.add(zt),this._element.style[n]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(zt),this._element.classList.add(mt,ks),this._element.style[n]="",U.trigger(this._element,wp)},l=`scroll${n[0].toUpperCase()+n.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[n]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||U.trigger(this._element,$p).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Rt(this._element),this._element.classList.add(zt),this._element.classList.remove(mt,ks);for(const i of this._triggerArray){const a=Z.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const n=()=>{this._isTransitioning=!1,this._element.classList.remove(zt),this._element.classList.add(mt),U.trigger(this._element,Ep)};this._element.style[t]="",this._queueCallback(n,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ks)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Be(e.parent),e}_getDimension(){return this._element.classList.contains(Tp)?xp:Ap}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Fs);for(const t of e){const n=Z.getElementFromSelector(t);n&&this._addAriaAndCollapsedClass([t],this._isShown(n))}}_getFirstLevelChildren(e){const t=Z.find(kp,this._config.parent);return Z.find(e,this._config.parent).filter(n=>!t.includes(n))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const n of e)n.classList.toggle(Sp,!t),n.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const n=yt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e]()}})}}U.on(document,Cp,Fs,function(o){(o.target.tagName==="A"||o.delegateTarget&&o.delegateTarget.tagName==="A")&&o.preventDefault();for(const e of Z.getMultipleElementsFromSelector(this))yt.getOrCreateInstance(e,{toggle:!1}).toggle()});Oe(yt);const Oo="dropdown",Dp="bs.dropdown",nt=`.${Dp}`,to=".data-api",Lp="Escape",No="Tab",Ip="ArrowUp",Do="ArrowDown",Pp=2,jp=`hide${nt}`,Rp=`hidden${nt}`,Wp=`show${nt}`,Vp=`shown${nt}`,Jn=`click${nt}${to}`,Xn=`keydown${nt}${to}`,Hp=`keyup${nt}${to}`,dt="show",Fp="dropup",Bp="dropend",Up="dropstart",qp="dropup-center",zp="dropdown-center",Qe='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Kp=`${Qe}.${dt}`,Zt=".dropdown-menu",Gp=".navbar",Yp=".navbar-nav",Jp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Xp=Ae()?"top-end":"top-start",Qp=Ae()?"top-start":"top-end",Zp=Ae()?"bottom-end":"bottom-start",ef=Ae()?"bottom-start":"bottom-end",tf=Ae()?"left-start":"right-start",sf=Ae()?"right-start":"left-start",of="top",nf="bottom",af={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},lf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Le extends Ne{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=Z.next(this._element,Zt)[0]||Z.prev(this._element,Zt)[0]||Z.findOne(Zt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return af}static get DefaultType(){return lf}static get NAME(){return Oo}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ue(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!U.trigger(this._element,Wp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Yp))for(const n of[].concat(...document.body.children))U.on(n,"mouseover",ss);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(dt),this._element.classList.add(dt),U.trigger(this._element,Vp,e)}}hide(){if(Ue(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!U.trigger(this._element,jp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const n of[].concat(...document.body.children))U.off(n,"mouseover",ss);this._popper&&this._popper.destroy(),this._menu.classList.remove(dt),this._element.classList.remove(dt),this._element.setAttribute("aria-expanded","false"),Re.removeDataAttribute(this._menu,"popper"),U.trigger(this._element,Rp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!je(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Oo.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Dn>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:je(this._config.reference)?e=Be(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Qs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(dt)}_getPlacement(){const e=this._parent;if(e.classList.contains(Bp))return tf;if(e.classList.contains(Up))return sf;if(e.classList.contains(qp))return of;if(e.classList.contains(zp))return nf;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Fp)?t?Qp:Xp:t?ef:Zp}_detectNavbar(){return this._element.closest(Gp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Re.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...$e(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const n=Z.find(Jp,this._menu).filter(i=>kt(i));n.length&&Zs(n,t,e===Do,!n.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Le.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===Pp||e.type==="keyup"&&e.key!==No)return;const t=Z.find(Kp);for(const n of t){const i=Le.getInstance(n);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),l=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===No||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const c={relatedTarget:i._element};e.type==="click"&&(c.clickEvent=e),i._completeHide(c)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),n=e.key===Lp,i=[Ip,Do].includes(e.key);if(!i&&!n||t&&!n)return;e.preventDefault();const a=this.matches(Qe)?this:Z.prev(this,Qe)[0]||Z.next(this,Qe)[0]||Z.findOne(Qe,e.delegateTarget.parentNode),l=Le.getOrCreateInstance(a);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),a.focus())}}U.on(document,Xn,Qe,Le.dataApiKeydownHandler);U.on(document,Xn,Zt,Le.dataApiKeydownHandler);U.on(document,Jn,Le.clearMenus);U.on(document,Hp,Le.clearMenus);U.on(document,Jn,Qe,function(o){o.preventDefault(),Le.getOrCreateInstance(this).toggle()});Oe(Le);const Qn="backdrop",rf="fade",Lo="show",Io=`mousedown.bs.${Qn}`,cf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},uf={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Zn extends Wt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return cf}static get DefaultType(){return uf}static get NAME(){return Qn}show(e){if(!this._config.isVisible){$e(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Rt(t),t.classList.add(Lo),this._emulateAnimation(()=>{$e(e)})}hide(e){if(!this._config.isVisible){$e(e);return}this._getElement().classList.remove(Lo),this._emulateAnimation(()=>{this.dispose(),$e(e)})}dispose(){this._isAppended&&(U.off(this._element,Io),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(rf),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Be(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),U.on(e,Io,()=>{$e(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Rn(e,this._getElement(),this._config.isAnimated)}}const df="focustrap",mf="bs.focustrap",ns=`.${mf}`,pf=`focusin${ns}`,ff=`keydown.tab${ns}`,vf="Tab",hf="forward",Po="backward",_f={autofocus:!0,trapElement:null},gf={autofocus:"boolean",trapElement:"element"};class ei extends Wt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return _f}static get DefaultType(){return gf}static get NAME(){return df}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),U.off(document,ns),U.on(document,pf,e=>this._handleFocusin(e)),U.on(document,ff,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,U.off(document,ns))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const n=Z.focusableChildren(t);n.length===0?t.focus():this._lastTabNavDirection===Po?n[n.length-1].focus():n[0].focus()}_handleKeydown(e){e.key===vf&&(this._lastTabNavDirection=e.shiftKey?Po:hf)}}const jo=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Ro=".sticky-top",Kt="padding-right",Wo="margin-right";class Bs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Kt,t=>t+e),this._setElementAttributes(jo,Kt,t=>t+e),this._setElementAttributes(Ro,Wo,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Kt),this._resetElementAttributes(jo,Kt),this._resetElementAttributes(Ro,Wo)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,n){const i=this.getWidth(),a=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,t);const c=window.getComputedStyle(l).getPropertyValue(t);l.style.setProperty(t,`${n(Number.parseFloat(c))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const n=e.style.getPropertyValue(t);n&&Re.setDataAttribute(e,t,n)}_resetElementAttributes(e,t){const n=i=>{const a=Re.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}Re.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,n)}_applyManipulationCallback(e,t){if(je(e)){t(e);return}for(const n of Z.find(e,this._element))t(n)}}const bf="modal",yf="bs.modal",Me=`.${yf}`,wf=".data-api",$f="Escape",Ef=`hide${Me}`,Cf=`hidePrevented${Me}`,ti=`hidden${Me}`,si=`show${Me}`,Sf=`shown${Me}`,kf=`resize${Me}`,Tf=`click.dismiss${Me}`,xf=`mousedown.dismiss${Me}`,Af=`keydown.dismiss${Me}`,Mf=`click${Me}${wf}`,Vo="modal-open",Of="fade",Ho="show",Ts="modal-static",Nf=".modal.show",Df=".modal-dialog",Lf=".modal-body",If='[data-bs-toggle="modal"]',Pf={backdrop:!0,focus:!0,keyboard:!0},jf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class wt extends Ne{constructor(e,t){super(e,t),this._dialog=Z.findOne(Df,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Bs,this._addEventListeners()}static get Default(){return Pf}static get DefaultType(){return jf}static get NAME(){return bf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||U.trigger(this._element,si,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Vo),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||U.trigger(this._element,Ef).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Ho),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){U.off(window,Me),U.off(this._dialog,Me),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Zn({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=Z.findOne(Lf,this._dialog);t&&(t.scrollTop=0),Rt(this._element),this._element.classList.add(Ho);const n=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,U.trigger(this._element,Sf,{relatedTarget:e})};this._queueCallback(n,this._dialog,this._isAnimated())}_addEventListeners(){U.on(this._element,Af,e=>{if(e.key===$f){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),U.on(window,kf,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),U.on(this._element,xf,e=>{U.one(this._element,Tf,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Vo),this._resetAdjustments(),this._scrollBar.reset(),U.trigger(this._element,ti)})}_isAnimated(){return this._element.classList.contains(Of)}_triggerBackdropTransition(){if(U.trigger(this._element,Cf).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,n=this._element.style.overflowY;n==="hidden"||this._element.classList.contains(Ts)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ts),this._queueCallback(()=>{this._element.classList.remove(Ts),this._queueCallback(()=>{this._element.style.overflowY=n},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),n=t>0;if(n&&!e){const i=Ae()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!n&&e){const i=Ae()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const n=wt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e](t)}})}}U.on(document,Mf,If,function(o){const e=Z.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&o.preventDefault(),U.one(e,si,i=>{i.defaultPrevented||U.one(e,ti,()=>{kt(this)&&this.focus()})});const t=Z.findOne(Nf);t&&wt.getInstance(t).hide(),wt.getOrCreateInstance(e).toggle(this)});rs(wt);Oe(wt);const Rf="offcanvas",Wf="bs.offcanvas",Ve=`.${Wf}`,oi=".data-api",Vf=`load${Ve}${oi}`,Hf="Escape",Fo="show",Bo="showing",Uo="hiding",Ff="offcanvas-backdrop",ni=".offcanvas.show",Bf=`show${Ve}`,Uf=`shown${Ve}`,qf=`hide${Ve}`,qo=`hidePrevented${Ve}`,ii=`hidden${Ve}`,zf=`resize${Ve}`,Kf=`click${Ve}${oi}`,Gf=`keydown.dismiss${Ve}`,Yf='[data-bs-toggle="offcanvas"]',Jf={backdrop:!0,keyboard:!0,scroll:!1},Xf={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class qe extends Ne{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Jf}static get DefaultType(){return Xf}static get NAME(){return Rf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||U.trigger(this._element,Bf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Bs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Bo);const n=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Fo),this._element.classList.remove(Bo),U.trigger(this._element,Uf,{relatedTarget:e})};this._queueCallback(n,this._element,!0)}hide(){if(!this._isShown||U.trigger(this._element,qf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Uo),this._backdrop.hide();const t=()=>{this._element.classList.remove(Fo,Uo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Bs().reset(),U.trigger(this._element,ii)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){U.trigger(this._element,qo);return}this.hide()},t=!!this._config.backdrop;return new Zn({className:Ff,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_addEventListeners(){U.on(this._element,Gf,e=>{if(e.key===Hf){if(this._config.keyboard){this.hide();return}U.trigger(this._element,qo)}})}static jQueryInterface(e){return this.each(function(){const t=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}U.on(document,Kf,Yf,function(o){const e=Z.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&o.preventDefault(),Ue(this))return;U.one(e,ii,()=>{kt(this)&&this.focus()});const t=Z.findOne(ni);t&&t!==e&&qe.getInstance(t).hide(),qe.getOrCreateInstance(e).toggle(this)});U.on(window,Vf,()=>{for(const o of Z.find(ni))qe.getOrCreateInstance(o).show()});U.on(window,zf,()=>{for(const o of Z.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(o).position!=="fixed"&&qe.getOrCreateInstance(o).hide()});rs(qe);Oe(qe);const Qf=/^aria-[\w-]*$/i,ai={"*":["class","dir","id","lang","role",Qf],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Zf=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),ev=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,tv=(o,e)=>{const t=o.nodeName.toLowerCase();return e.includes(t)?Zf.has(t)?!!ev.test(o.nodeValue):!0:e.filter(n=>n instanceof RegExp).some(n=>n.test(t))};function sv(o,e,t){if(!o.length)return o;if(t&&typeof t=="function")return t(o);const i=new window.DOMParser().parseFromString(o,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const l of a){const c=l.nodeName.toLowerCase();if(!Object.keys(e).includes(c)){l.remove();continue}const f=[].concat(...l.attributes),h=[].concat(e["*"]||[],e[c]||[]);for(const r of f)tv(r,h)||l.removeAttribute(r.nodeName)}return i.body.innerHTML}const ov="TemplateFactory",nv={allowList:ai,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},iv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},av={entry:"(string|element|function|null)",selector:"(string|element)"};class lv extends Wt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return nv}static get DefaultType(){return iv}static get NAME(){return ov}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&t.classList.add(...n.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,n]of Object.entries(e))super._typeCheckConfig({selector:t,entry:n},av)}_setContent(e,t,n){const i=Z.findOne(n,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(je(t)){this._putElementInTemplate(Be(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?sv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return $e(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const rv="tooltip",cv=new Set(["sanitize","allowList","sanitizeFn"]),xs="fade",uv="modal",Gt="show",dv=".tooltip-inner",zo=`.${uv}`,Ko="hide.bs.modal",Nt="hover",As="focus",Ms="click",mv="manual",pv="hide",fv="hidden",vv="show",hv="shown",_v="inserted",gv="click",bv="focusin",yv="focusout",wv="mouseenter",$v="mouseleave",Ev={AUTO:"auto",TOP:"top",RIGHT:Ae()?"left":"right",BOTTOM:"bottom",LEFT:Ae()?"right":"left"},Cv={allowList:ai,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Sv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class xt extends Ne{constructor(e,t){if(typeof Dn>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Cv}static get DefaultType(){return Sv}static get NAME(){return rv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),U.off(this._element.closest(zo),Ko,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=U.trigger(this._element,this.constructor.eventName(vv)),n=(Pn(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!n)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),U.trigger(this._element,this.constructor.eventName(_v))),this._popper=this._createPopper(i),i.classList.add(Gt),"ontouchstart"in document.documentElement)for(const c of[].concat(...document.body.children))U.on(c,"mouseover",ss);const l=()=>{U.trigger(this._element,this.constructor.eventName(hv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||U.trigger(this._element,this.constructor.eventName(pv)).defaultPrevented)return;if(this._getTipElement().classList.remove(Gt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))U.off(i,"mouseover",ss);this._activeTrigger[Ms]=!1,this._activeTrigger[As]=!1,this._activeTrigger[Nt]=!1,this._isHovered=null;const n=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),U.trigger(this._element,this.constructor.eventName(fv)))};this._queueCallback(n,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(xs,Gt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const n=dm(this.constructor.NAME).toString();return t.setAttribute("id",n),this._isAnimated()&&t.classList.add(xs),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new lv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[dv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(xs)}_isShown(){return this.tip&&this.tip.classList.contains(Gt)}_createPopper(e){const t=$e(this._config.placement,[this,e,this._element]),n=Ev[t.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(n))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return $e(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:n=>{this._getTipElement().setAttribute("data-popper-placement",n.state.placement)}}]};return{...t,...$e(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")U.on(this._element,this.constructor.eventName(gv),this._config.selector,n=>{const i=this._initializeOnDelegatedTarget(n);i._activeTrigger[Ms]=!(i._isShown()&&i._activeTrigger[Ms]),i.toggle()});else if(t!==mv){const n=t===Nt?this.constructor.eventName(wv):this.constructor.eventName(bv),i=t===Nt?this.constructor.eventName($v):this.constructor.eventName(yv);U.on(this._element,n,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusin"?As:Nt]=!0,l._enter()}),U.on(this._element,i,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusout"?As:Nt]=l._element.contains(a.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},U.on(this._element.closest(zo),Ko,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Re.getDataAttributes(this._element);for(const n of Object.keys(t))cv.has(n)&&delete t[n];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Be(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,n]of Object.entries(this._config))this.constructor.Default[t]!==n&&(e[t]=n);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=xt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Oe(xt);const kv="popover",Tv=".popover-header",xv=".popover-body",Av={...xt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Mv={...xt.DefaultType,content:"(null|string|element|function)"};class so extends xt{static get Default(){return Av}static get DefaultType(){return Mv}static get NAME(){return kv}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Tv]:this._getTitle(),[xv]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=so.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Oe(so);const Ov="scrollspy",Nv="bs.scrollspy",oo=`.${Nv}`,Dv=".data-api",Lv=`activate${oo}`,Go=`click${oo}`,Iv=`load${oo}${Dv}`,Pv="dropdown-item",rt="active",jv='[data-bs-spy="scroll"]',Os="[href]",Rv=".nav, .list-group",Yo=".nav-link",Wv=".nav-item",Vv=".list-group-item",Hv=`${Yo}, ${Wv} > ${Yo}, ${Vv}`,Fv=".dropdown",Bv=".dropdown-toggle",Uv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},qv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ds extends Ne{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Uv}static get DefaultType(){return qv}static get NAME(){return Ov}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Be(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(U.off(this._config.target,Go),U.on(this._config.target,Go,Os,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const n=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(n.scrollTo){n.scrollTo({top:i,behavior:"smooth"});return}n.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=l=>this._targetLinks.get(`#${l.target.id}`),n=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(t(l))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(l));continue}const c=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&c){if(n(l),!i)return;continue}!a&&!c&&n(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Z.find(Os,this._config.target);for(const t of e){if(!t.hash||Ue(t))continue;const n=Z.findOne(decodeURI(t.hash),this._element);kt(n)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,n))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(rt),this._activateParents(e),U.trigger(this._element,Lv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Pv)){Z.findOne(Bv,e.closest(Fv)).classList.add(rt);return}for(const t of Z.parents(e,Rv))for(const n of Z.prev(t,Hv))n.classList.add(rt)}_clearActiveClass(e){e.classList.remove(rt);const t=Z.find(`${Os}.${rt}`,e);for(const n of t)n.classList.remove(rt)}static jQueryInterface(e){return this.each(function(){const t=ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}U.on(window,Iv,()=>{for(const o of Z.find(jv))ds.getOrCreateInstance(o)});Oe(ds);const zv="tab",Kv="bs.tab",it=`.${Kv}`,Gv=`hide${it}`,Yv=`hidden${it}`,Jv=`show${it}`,Xv=`shown${it}`,Qv=`click${it}`,Zv=`keydown${it}`,eh=`load${it}`,th="ArrowLeft",Jo="ArrowRight",sh="ArrowUp",Xo="ArrowDown",Ns="Home",Qo="End",Ze="active",Zo="fade",Ds="show",oh="dropdown",li=".dropdown-toggle",nh=".dropdown-menu",Ls=`:not(${li})`,ih='.list-group, .nav, [role="tablist"]',ah=".nav-item, .list-group-item",lh=`.nav-link${Ls}, .list-group-item${Ls}, [role="tab"]${Ls}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Is=`${lh}, ${ri}`,rh=`.${Ze}[data-bs-toggle="tab"], .${Ze}[data-bs-toggle="pill"], .${Ze}[data-bs-toggle="list"]`;class $t extends Ne{constructor(e){super(e),this._parent=this._element.closest(ih),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),U.on(this._element,Zv,t=>this._keydown(t)))}static get NAME(){return zv}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),n=t?U.trigger(t,Gv,{relatedTarget:e}):null;U.trigger(e,Jv,{relatedTarget:t}).defaultPrevented||n&&n.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(Ze),this._activate(Z.getElementFromSelector(e));const n=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ds);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),U.trigger(e,Xv,{relatedTarget:t})};this._queueCallback(n,e,e.classList.contains(Zo))}_deactivate(e,t){if(!e)return;e.classList.remove(Ze),e.blur(),this._deactivate(Z.getElementFromSelector(e));const n=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ds);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),U.trigger(e,Yv,{relatedTarget:t})};this._queueCallback(n,e,e.classList.contains(Zo))}_keydown(e){if(![th,Jo,sh,Xo,Ns,Qo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Ue(i));let n;if([Ns,Qo].includes(e.key))n=t[e.key===Ns?0:t.length-1];else{const i=[Jo,Xo].includes(e.key);n=Zs(t,e.target,i,!0)}n&&(n.focus({preventScroll:!0}),$t.getOrCreateInstance(n).show())}_getChildren(){return Z.find(Is,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const n of t)this._setInitialAttributesOnChild(n)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),n=this._getOuterElement(e);e.setAttribute("aria-selected",t),n!==e&&this._setAttributeIfNotExists(n,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=Z.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const n=this._getOuterElement(e);if(!n.classList.contains(oh))return;const i=(a,l)=>{const c=Z.findOne(a,n);c&&c.classList.toggle(l,t)};i(li,Ze),i(nh,Ds),n.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,n){e.hasAttribute(t)||e.setAttribute(t,n)}_elemIsActive(e){return e.classList.contains(Ze)}_getInnerElement(e){return e.matches(Is)?e:Z.findOne(Is,e)}_getOuterElement(e){return e.closest(ah)||e}static jQueryInterface(e){return this.each(function(){const t=$t.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}U.on(document,Qv,ri,function(o){["A","AREA"].includes(this.tagName)&&o.preventDefault(),!Ue(this)&&$t.getOrCreateInstance(this).show()});U.on(window,eh,()=>{for(const o of Z.find(rh))$t.getOrCreateInstance(o)});Oe($t);const ch="toast",uh="bs.toast",Ye=`.${uh}`,dh=`mouseover${Ye}`,mh=`mouseout${Ye}`,ph=`focusin${Ye}`,fh=`focusout${Ye}`,vh=`hide${Ye}`,hh=`hidden${Ye}`,_h=`show${Ye}`,gh=`shown${Ye}`,bh="fade",en="hide",Yt="show",Jt="showing",yh={animation:"boolean",autohide:"boolean",delay:"number"},wh={animation:!0,autohide:!0,delay:5e3};class ms extends Ne{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return wh}static get DefaultType(){return yh}static get NAME(){return ch}show(){if(U.trigger(this._element,_h).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(bh);const t=()=>{this._element.classList.remove(Jt),U.trigger(this._element,gh),this._maybeScheduleHide()};this._element.classList.remove(en),Rt(this._element),this._element.classList.add(Yt,Jt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||U.trigger(this._element,vh).defaultPrevented)return;const t=()=>{this._element.classList.add(en),this._element.classList.remove(Jt,Yt),U.trigger(this._element,hh)};this._element.classList.add(Jt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Yt),super.dispose()}isShown(){return this._element.classList.contains(Yt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const n=e.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){U.on(this._element,dh,e=>this._onInteraction(e,!0)),U.on(this._element,mh,e=>this._onInteraction(e,!1)),U.on(this._element,ph,e=>this._onInteraction(e,!0)),U.on(this._element,fh,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=ms.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}rs(ms);Oe(ms);const $h={class:"message-content-column"},Eh=["id"],Ch={class:"accordion-item"},Sh=["id"],kh=["aria-controls"],Th={class:"d-flex align-items-center w-100"},xh={class:"badge bg-warning text-dark ms-auto me-2"},Ah={class:"text-muted"},Mh=["id","aria-labelledby"],Oh={class:"accordion-body bg-light"},Nh={class:"alert alert-warning mb-3",role:"alert"},Dh={class:"compaction-metadata"},Lh={class:"metadata-row"},Ih={class:"metadata-row"},Ph={key:0,class:"metadata-row"},jh={class:"continuation-content"},Rh={class:"continuation-text border rounded p-3 bg-white"},Wh={class:"mb-0"},Vh={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:o=>o.length===4||o.length===5}},setup(o){const e=o,t=g(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),n=g(()=>`heading-${t.value}`),i=g(()=>`collapse-${t.value}`),a=L(null);let l=null;ve(()=>{a.value&&(l=new yt(a.value,{toggle:!1}))}),mi(()=>{l&&l.dispose()});function c(){l&&l.toggle()}const f=g(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),h=g(()=>f.value?e.messages[3]:e.messages[2]),r=g(()=>h.value?.metadata?.init_data?.compact_metadata||{}),y=g(()=>r.value.pre_tokens||0),v=g(()=>f.value?e.messages[4]:e.messages[3]),p=g(()=>v.value?.content||""),b=g(()=>{const d=e.messages[0]?.timestamp;return d?Pt(d):""});function w(d){return d?`${d.toLocaleString()} tokens`:"0 tokens"}return(d,_)=>(u(),m("div",{class:"message-row message-row-compaction",key:t.value},[_[7]||(_[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",$h,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Ch,[s("h2",{class:"accordion-header",id:n.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:c},[s("div",Th,[_[0]||(_[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),_[1]||(_[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",xh,$(w(y.value)),1),s("small",Ah,$(b.value),1)])],8,kh)],8,Sh),s("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":n.value},[s("div",Oh,[s("div",Nh,[_[5]||(_[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),oe(" Compaction Details ")],-1)),s("div",Dh,[s("div",Lh,[_[2]||(_[2]=s("strong",null,"Trigger:",-1)),s("span",null,$(r.value.trigger||"auto"),1)]),s("div",Ih,[_[3]||(_[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,$(w(y.value)),1)]),r.value.post_tokens?(u(),m("div",Ph,[_[4]||(_[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,$(w(r.value.post_tokens)),1)])):M("",!0)])]),s("div",jh,[_[6]||(_[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),oe(" Continuation Message ")],-1)),s("div",Rh,[s("pre",Wh,$(p.value),1)])])])],8,Mh)])],8,Eh)])]))}},Hh=te(Vh,[["__scopeId","data-v-e0b95ba8"]]),Fh={key:0,class:"text-muted text-center py-5"},Bh={__name:"MessageList",setup(o){const e=xe(),t=me(),n=L(null),i=g(()=>{const r=e.currentMessages,y=[];let v=0;for(;v<r.length;){const p=r[v];if(l(p,r,v)){const b=r[v+2],d=b?.type==="system"&&b?.metadata?.subtype==="init"?5:4,_=r.slice(v,v+d);y.push({type:"compaction",messages:_}),v+=d;continue}f(p)&&y.push({type:"message",message:p,attachedTools:[]}),v++}return a(y)});function a(r){const y=new Map,v=new Set;for(let b=0;b<r.length;b++){const w=r[b];if(w.type==="compaction")continue;const d=w.message,_=d.content&&d.content.trim().length>0&&d.content!=="Assistant response",C=d.type==="assistant"&&d.metadata?.has_tool_uses&&d.metadata?.tool_uses?.length>0;if(d.type==="assistant"&&C&&!_){let S=-1,D=!1;for(let V=b-1;V>=0;V--){const P=r[V];if(!v.has(V)){if(P.type==="message"&&P.message.type!=="assistant"){D=!0;break}if(P.type==="message"&&P.message.type==="assistant"){const O=P.message;if(O.content&&O.content.trim().length>0&&O.content!=="Assistant response"){S=V;break}else{S=V;break}}}}D&&S===-1||(D&&S>=0?(y.has(S)||y.set(S,[]),y.get(S).push(...d.metadata.tool_uses),v.add(b)):!D&&S>=0&&(y.has(S)||y.set(S,[]),y.get(S).push(...d.metadata.tool_uses),v.add(b)))}}const p=[];for(let b=0;b<r.length;b++){if(v.has(b))continue;const w=r[b];y.has(b)&&(w.attachedTools=[...w.attachedTools||[],...y.get(b)]),p.push(w)}return p}function l(r,y,v){if(v+3>=y.length)return!1;const p=y[v],b=y[v+1];let w=y[v+2],d=y[v+3],_=y[v+4];const C=p.type==="system"&&p.metadata?.subtype==="status"&&p.metadata?.init_data?.status==="compacting",S=b.type==="system"&&b.metadata?.subtype==="status"&&(b.metadata?.init_data?.status===null||b.metadata?.init_data?.status===void 0);if(w?.type==="system"&&w?.metadata?.subtype==="init"){if(v+4>=y.length)return!1;const V=!0,P=d?.type==="system"&&d?.metadata?.subtype==="compact_boundary",O=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return p.type==="system"&&p.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",v),console.log("  Msg1 (compacting):",C),console.log("  Msg2 (null status):",S),console.log("  Msg3 (init):",V),console.log("  Msg4 (boundary):",P),console.log("  Msg5 (continuation):",O)),C&&S&&V&&P&&O}else{const V=w?.type==="system"&&w?.metadata?.subtype==="compact_boundary",P=d?.type==="user"&&d?.content?.startsWith("This session is being continued from a previous conversation");return p.type==="system"&&p.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",v),console.log("  Msg1 (compacting):",C),console.log("  Msg2 (null status):",S),console.log("  Msg3 (boundary):",V),console.log("  Msg4 (continuation):",P)),C&&S&&V&&P}}async function c(){t.autoScrollEnabled&&(await Ps(),n.value&&(n.value.scrollTop=n.value.scrollHeight))}le(()=>i.value.length,c),le(()=>e.currentToolCalls.length,c),le(()=>e.currentToolCalls.map(r=>`${r.id}-${r.status}`).join(","),c),ve(()=>{setTimeout(()=>{c()},100)});function f(r){const y=r.subtype||r.metadata?.subtype;if(r.type==="system"&&y==="init"||r.type==="result"||r.type==="permission_request"||r.type==="permission_response")return!1;if(r.type==="user"&&r.metadata?.has_tool_results){const v=r.content||"";if(v.match(/^Tool results?: \d+ results?$/i)||v.trim()==="")return!1}if(r.type==="user"){const v=r.content||"";if(v.includes("<command-message>")&&v.includes("skill is running")||v.startsWith("Base directory for this skill:"))return!1}if(r.type==="user"){const v=r.content||"";if(v.includes("<command-message>")&&v.includes("<command-name>")&&v.includes("<command-args>")||v.includes("ARGUMENTS:")&&(v.includes("<command-name>")||v.match(/\nARGUMENTS:/)))return!1}return!0}function h(r){return{type:r.type||"unknown",content:r.content||"",timestamp:r.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...r.metadata}}}return(r,y)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:n},[i.value.length===0?(u(),m("div",Fh," No messages yet. Start a conversation! ")):M("",!0),(u(!0),m(re,null,ce(i.value,(v,p)=>(u(),m(re,{key:`item-${p}`},[v.type==="message"?(u(),ge(Cd,{key:0,message:h(v.message),attachedTools:v.attachedTools||[]},null,8,["message","attachedTools"])):v.type==="compaction"?(u(),ge(Hh,{key:1,messages:v.messages},null,8,["messages"])):M("",!0)],64))),128))],512))}},Uh=te(Bh,[["__scopeId","data-v-6bae0fb1"]]),qh={class:"border-top bg-light"},zh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Kh={class:"d-flex gap-2 align-items-end px-2 py-1"},Gh=["placeholder","disabled"],Yh=["disabled"],Jh={__name:"InputArea",setup(o){const e=ae(),t=ze(),n=L(null),i=L(window.innerWidth),a=g({get:()=>e.currentInput,set:d=>{e.currentInput=d}}),l=g(()=>e.currentSession?.is_processing||!1),c=g(()=>t.sessionConnected),f=g(()=>e.currentSession?.state==="starting"),h=g(()=>i.value<768),r=g(()=>f.value?"Session is starting...":c.value?"Type your message to Claude Code...":"Waiting for connection...");function y(){i.value=window.innerWidth}ve(()=>{window.addEventListener("resize",y)}),_e(()=>{window.removeEventListener("resize",y)});function v(d){if(d.key==="Enter"&&!d.shiftKey){if(h.value)return;d.preventDefault(),b()}}function p(){const d=n.value;if(!d)return;d.style.height="auto";const _=Math.min(d.scrollHeight,parseInt(getComputedStyle(d).maxHeight));d.style.height=_+"px"}function b(){a.value.trim()&&(t.sendMessage(a.value),a.value="",n.value&&(n.value.style.height="auto"))}function w(){t.interruptSession()}return(d,_)=>(u(),m("div",qh,[c.value?M("",!0):(u(),m("div",zh,[..._[1]||(_[1]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",Kh,[ne(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:n,"onUpdate:modelValue":_[0]||(_[0]=C=>a.value=C),class:"form-control",placeholder:r.value,disabled:f.value||!c.value,rows:"1",onInput:p,onKeydown:v},null,40,Gh),[[ue,a.value]]),l.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:w}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!c.value||f.value,onClick:b}," Send ",8,Yh))])]))}},Xh=te(Jh,[["__scopeId","data-v-ef1e5094"]]),Qh={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Zh={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},e_={class:"text-secondary"},t_={class:"d-flex flex-column flex-grow-1 overflow-hidden"},s_={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(o){const e=o,t=ae(),n=me(),i=g(()=>t.currentSession),a=g(()=>n.isLoading),l=g(()=>n.loadingMessage);return ve(async()=>{if(e.sessionId!==t.currentSessionId){n.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{n.hideLoading()}}}),le(()=>e.sessionId,async(c,f)=>{if(c!==f&&c!==t.currentSessionId){n.showLoading("Loading session...");try{await t.selectSession(c)}finally{n.hideLoading()}}}),_e(()=>{}),(c,f)=>(u(),m("div",Qh,[a.value?(u(),m("div",Zh,[f[0]||(f[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",e_,$(l.value),1)])):M("",!0),i.value?(u(),ge(Mi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),s("div",t_,[de(Uh)]),de(Xh),i.value?(u(),ge(Ii,{key:2,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),i.value?(u(),ge(Ui,{key:3,"session-id":e.sessionId},null,8,["session-id"])):M("",!0)]))}},ps=Et("legion",()=>{const o=L(new Map),e=L(new Map),t=L(null),n=g(()=>o.value.get(t.value)||[]),i=g(()=>e.value.get(t.value)||[]);function a(b){t.value=b}async function l(b,w=100,d=0){try{const _=await ie.get(`/api/legions/${b}/timeline?limit=${w}&offset=${d}`),C=_.comms||[],S=_.total_count||C.length,D=_.has_more||!1;return C.sort((V,P)=>new Date(V.timestamp)-new Date(P.timestamp)),console.log(`Loaded ${C.length} of ${S} comms for legion ${b}`),o.value.set(b,C),o.value=new Map(o.value),{comms:C,totalCount:S,hasMore:D}}catch(_){throw console.error("Failed to load timeline:",_),_}}function c(b,w){o.value.has(b)||o.value.set(b,[]);const d=o.value.get(b);if(d.some(C=>C.comm_id===w.comm_id)){console.log(`Duplicate comm ${w.comm_id} prevented in timeline`);return}d.push(w),o.value=new Map(o.value)}async function f(b,w){try{const _=(await ie.post(`/api/legions/${b}/comms`,w)).comm;return console.log(`Sent comm ${_.comm_id} to legion ${b}`),_}catch(d){throw console.error("Failed to send comm:",d),d}}async function h(b){return console.log(`Minions for legion ${b} are already available in session store`),[]}async function r(b,w){try{const _=(await ie.post(`/api/legions/${b}/minions`,w)).minion;return await h(b),console.log(`Created minion ${_.minion_id} in legion ${b}`),_}catch(d){throw console.error("Failed to create minion:",d),d}}async function y(b){try{const w=await ie.post(`/api/legions/${b}/halt-all`);return console.log(`Halted ${w.halted_count} of ${w.total_minions} minions in legion ${b}`),w.failed_minions&&w.failed_minions.length>0&&console.warn("Failed to halt some minions:",w.failed_minions),w}catch(w){throw console.error("Failed to halt all minions:",w),w}}async function v(b){try{const w=await ie.post(`/api/legions/${b}/resume-all`);return console.log(`Resumed ${w.resumed_count} of ${w.total_minions} minions in legion ${b}`),w.failed_minions&&w.failed_minions.length>0&&console.warn("Failed to resume some minions:",w.failed_minions),w}catch(w){throw console.error("Failed to resume all minions:",w),w}}function p(b){o.value.delete(b),e.value.delete(b),o.value=new Map(o.value),e.value=new Map(e.value)}return{commsByLegion:o,minionsByLegion:e,currentLegionId:t,currentComms:n,currentMinions:i,setCurrentLegion:a,loadTimeline:l,addComm:c,sendComm:f,loadMinions:h,createMinion:r,haltAll:y,resumeAll:v,clearLegionData:p}}),o_=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:ps},Symbol.toStringTag,{value:"Module"})),n_={class:"timeline-header border-bottom p-3"},i_={class:"project-name"},a_=["title"],l_={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(o){const e=o,t=ke(),n=g(()=>t.projects.get(e.legionId)),i=g(()=>n.value?.name||"Legion");return(a,l)=>(u(),m("div",n_,[s("div",null,[s("div",i_,$(i.value),1),s("div",{class:"view-name",title:o.legionId},"Timeline",8,a_)])]))}},r_=te(l_,[["__scopeId","data-v-44f386f5"]]),c_={class:"timeline-status-bar border-top p-2 bg-light"},u_={class:"d-flex justify-content-end"},d_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(o){const e=me();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(n,i)=>(u(),m("div",c_,[s("div",u_,[s("button",{class:ee(["btn btn-sm",es(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+$(es(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},m_=te(d_,[["__scopeId","data-v-891c73db"]]),p_={class:"comm-composer border-top p-3"},f_={key:0,class:"d-flex gap-2 mb-2"},v_={class:"flex-grow-1"},h_=["disabled"],__={label:"Minions"},g_=["value"],b_={style:{"min-width":"150px"}},y_=["disabled"],w_={class:"d-flex gap-2 align-items-end position-relative"},$_={class:"flex-grow-1 position-relative"},E_=["disabled"],C_=["onClick","onMouseenter"],S_=["disabled"],k_={key:0},T_={key:1},x_={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(o){const e=o,t=ps(),n=ae(),i=ke(),a=L(""),l=L("task"),c=L(""),f=L(!1),h=L(window.innerWidth),r=L(!1),y=L([]),v=L(0),p=L(-1),b=L(null),w=L(null),d=g(()=>h.value<768),_=g(()=>{const B=i.projects.get(e.legionId);return!B||!B.session_ids?[]:B.session_ids.map(k=>n.sessions.get(k)).filter(k=>k)}),C=g(()=>a.value&&c.value.trim().length>0);function S(B){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[B.state]||"â—‹"}function D(B){return B.role?`${B.name} (${B.role})`:B.name}function V(){const B=b.value;if(!B)return;B.style.height="auto";const k=Math.min(B.scrollHeight,parseInt(getComputedStyle(B).maxHeight));B.style.height=k+"px"}function P(){const B=b.value;if(!B)return;V();const k=c.value,E=B.selectionStart,N=k.substring(0,E),x=N.lastIndexOf("#");if(x===-1){r.value=!1;return}const T=N.substring(x+1).toLowerCase();if(T.includes(" ")){r.value=!1;return}const j=_.value.filter(q=>q.name.toLowerCase().includes(T)).map(q=>({type:"minion",name:q.name,role:q.role,id:q.session_id,state:q.state}));if(j.length===0){r.value=!1;return}y.value=j,v.value=0,p.value=x,r.value=!0}function O(){if(!w.value)return;const B=w.value,k=B.children[v.value];if(!k)return;const E=k.offsetTop,N=k.offsetHeight,x=B.scrollTop,T=B.clientHeight;E<x?B.scrollTop=E:E+N>x+T&&(B.scrollTop=E+N-T)}function F(B){if(!r.value){if(B.key==="Enter"&&!B.shiftKey){if(d.value)return;C.value&&(B.preventDefault(),I())}return}if(B.key==="ArrowDown")B.preventDefault(),v.value=(v.value+1)%y.value.length,O();else if(B.key==="ArrowUp")B.preventDefault(),v.value=v.value===0?y.value.length-1:v.value-1,O();else if(B.key==="Enter"){B.preventDefault();const k=y.value[v.value];k&&A(k)}else B.key==="Escape"&&(r.value=!1)}function A(B){const k=b.value;if(!k)return;const E=c.value,N=k.selectionStart,x=E.substring(0,p.value)+"#"+B.name+" "+E.substring(N);c.value=x;const T=p.value+B.name.length+2;setTimeout(()=>{k.setSelectionRange(T,T),k.focus()},0),r.value=!1}async function I(){if(!(!C.value||f.value)){f.value=!0;try{const[B,k]=a.value.split(":"),E={comm_type:l.value,content:c.value.trim()};B==="minion"&&(E.to_minion_id=k),await t.sendComm(e.legionId,E),c.value="",V()}catch(B){console.error("Failed to send comm:",B),alert(`Failed to send comm: ${B.message}`)}finally{f.value=!1}}}function K(){h.value=window.innerWidth}return ve(()=>{window.addEventListener("resize",K)}),_e(()=>{window.removeEventListener("resize",K)}),le(r,B=>{if(B){const k=E=>{E.target.closest(".comm-composer")||(r.value=!1,document.removeEventListener("click",k))};setTimeout(()=>document.addEventListener("click",k),0)}}),(B,k)=>(u(),m("div",p_,[o.hideRecipientSelector?M("",!0):(u(),m("div",f_,[s("div",v_,[ne(s("select",{"onUpdate:modelValue":k[0]||(k[0]=E=>a.value=E),class:"form-select form-select-sm",disabled:f.value},[k[3]||(k[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",__,[(u(!0),m(re,null,ce(_.value,E=>(u(),m("option",{key:E.session_id,value:`minion:${E.session_id}`},$(S(E))+" "+$(D(E)),9,g_))),128))])],8,h_),[[Pe,a.value]])]),s("div",b_,[ne(s("select",{"onUpdate:modelValue":k[1]||(k[1]=E=>l.value=E),class:"form-select form-select-sm",disabled:f.value},[...k[4]||(k[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,y_),[[Pe,l.value]])])])),s("div",w_,[s("div",$_,[ne(s("textarea",{ref_key:"contentTextarea",ref:b,"onUpdate:modelValue":k[2]||(k[2]=E=>c.value=E),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:f.value,onInput:P,onKeydown:F},null,40,E_),[[ue,c.value]]),r.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:w,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(re,null,ce(y.value,(E,N)=>(u(),m("div",{key:E.id,class:ee(["autocomplete-item px-2 py-1",{"bg-light":N===v.value}]),onClick:x=>A(E),onMouseenter:x=>v.value=N},$(E.type==="minion"?S(E):"#ï¸âƒ£")+" "+$(E.name)+$(E.role?` (${E.role})`:""),43,C_))),128))],512)):M("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!C.value||f.value,onClick:I},[f.value?(u(),m("span",k_,[...k[5]||(k[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),oe(" Sending... ",-1)])])):(u(),m("span",T_,"Send"))],8,S_)])])]))}},A_=te(x_,[["__scopeId","data-v-e52b8e8f"]]),M_={class:"message-content-column-full"},O_=["aria-expanded"],N_={class:"comm-sender-recipient"},D_={class:"comm-badge-summary"},L_=["title"],I_={class:"comm-summary-text text-muted ms-2"},P_=["aria-label"],j_={key:0,class:"comm-content-body"},R_=["innerHTML"],W_="ffffffff-ffff-ffff-ffff-ffffffffffff",V_={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(o){const e=o;tt.setOptions({breaks:!0,gfm:!0});const t=L(!1);function n(){t.value=!t.value}const i=g(()=>e.comm.from_minion_id===W_),a=g(()=>{const h=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${h.toLocaleString()}`}),l=g(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),c=g(()=>{if(e.comm.summary)return e.comm.summary;const h=e.comm.content||"";return h.length>100?h.substring(0,100)+"...":h}),f=g(()=>{const h=e.comm.content||"";let r=tt.parse(h);return r=r.replace(/\n</g,"<"),r=r.replace(/\n+$/,""),is.sanitize(r)});return(h,r)=>(u(),m("div",{class:ee(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",M_,[s("div",{class:"comm-header-accordion",onClick:n,role:"button","aria-expanded":t.value},[s("div",N_,[s("strong",{class:ee({"system-sender":i.value})},$(o.senderName),3),o.recipientName?(u(),m(re,{key:0},[r[0]||(r[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,$(o.recipientName),1)],64)):M("",!0)]),s("div",D_,[s("span",{class:ee(["badge",l.value]),title:a.value},$(o.comm.comm_type),11,L_),s("span",I_,$(c.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},$(t.value?"â–¾":"â–¸"),9,P_)],8,O_),t.value?(u(),m("div",j_,[s("div",{class:"message-text",innerHTML:f.value},null,8,R_)])):M("",!0)])],2))}},H_=te(V_,[["__scopeId","data-v-28513f64"]]),F_={class:"timeline-view d-flex flex-column h-100"},B_={key:0,class:"text-center text-muted"},U_={key:1,class:"text-center text-danger"},q_={key:2,class:"text-center text-muted"},z_={key:3,class:"comm-list"},K_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(o){const e=o,t=ps();ke();const n=ae(),i=ze(),a=me(),l=L(!0),c=L(null),f=L(null),h=g(()=>t.currentComms);function r(d){return d.from_user?"You":d.from_minion_id?d.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":n.sessions.get(d.from_minion_id)?.name||"Unknown":"Unknown"}function y(d){return d.to_user?"You":d.to_minion_id?n.sessions.get(d.to_minion_id)?.name||"Unknown":"All"}async function v(){a.autoScrollEnabled&&(await Ps(),f.value&&(f.value.scrollTop=f.value.scrollHeight))}async function p(){l.value=!0,c.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await Ps(),await v(),setTimeout(()=>{v()},100)}catch(d){console.error("Failed to load timeline:",d),d.response?c.value=`${d.message} (${d.response.status})`:c.value=d.message||"Unknown error"}finally{l.value=!1}}function b(){i.connectLegion(e.legionId)}function w(){i.disconnectLegion()}return le(()=>h.value.length,()=>{v()}),ve(()=>{n.currentSessionId=null,p(),b(),setTimeout(()=>{v()},100)}),_e(()=>{w()}),(d,_)=>(u(),m("div",F_,[de(r_,{"legion-id":o.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:f,class:"timeline-messages flex-grow-1 overflow-auto"},[l.value?(u(),m("div",B_,[..._[0]||(_[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),oe(" Loading timeline... ",-1)])])):c.value?(u(),m("div",U_," Failed to load timeline: "+$(c.value),1)):h.value.length===0?(u(),m("div",q_," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",z_,[(u(!0),m(re,null,ce(h.value,C=>(u(),ge(H_,{key:C.comm_id,comm:C,"sender-name":r(C),"recipient-name":y(C)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),de(A_,{"legion-id":o.legionId},null,8,["legion-id"]),de(m_,{"legion-id":o.legionId},null,8,["legion-id"])]))}},G_=te(K_,[["__scopeId","data-v-b6752179"]]),Y_={class:"minion-info flex-grow-1"},J_={class:"minion-name"},X_={key:0,class:"me-1"},Q_={key:1,class:"badge bg-secondary ms-2"},Z_={key:0,class:"latest-activity text-muted"},eg={key:0,class:"activity-prefix"},tg=["title"],sg={key:1,class:"activity-time ms-1"},og={key:1,class:"latest-activity text-muted"},ng={class:"activity-prefix"},ig=["title"],ag={key:2,class:"latest-activity text-muted fst-italic small"},lg={class:"node-row"},rg={class:"node-left"},cg={key:0,class:"me-2"},ug={key:1,class:"badge bg-secondary ms-2"},dg={class:"node-right"},mg={key:0,class:"latest-message-preview"},pg={key:0,class:"message-prefix"},fg=["title"],vg={key:1,class:"message-time ms-1"},hg={key:1,class:"last-comm-preview"},_g={class:"comm-direction"},gg=["title"],bg={key:2,class:"text-muted fst-italic small"},yg={class:"node-actions"},wg={key:2,class:"minion-children"},$g={key:1,class:"text-danger small ms-4"},Eg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:o=>["two-column","sidebar"].includes(o)}},emits:["minion-click"],setup(o,{emit:e}){const t=o,n=e,i=ae(),a=xe(),l=me(),c=g(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),f=g(()=>{if(!t.minionData||!t.minionData.id)return null;const A=a.messagesBySession.get(t.minionData.id);if(!A||A.length===0)return null;for(let I=A.length-1;I>=0;I--){const K=A[I];if(K.type!=="result"&&!(K.type==="user"&&K.content&&K.content.startsWith("Tool results:"))&&!(K.type==="system"&&K.content==="System message")&&!(K.type==="assistant"&&K.content==="Assistant response")&&(K.type==="user"||K.type==="assistant"||K.type==="system"))return{content:K.content,type:K.type,timestamp:K.timestamp}}return null}),h=g(()=>{if(!t.minionData)return null;const A={...t.minionData};return c.value&&(A.state=c.value.state,A.is_processing=c.value.is_processing,c.value.latest_message&&(A.latest_message=c.value.latest_message,A.latest_message_type=c.value.latest_message_type,A.latest_message_time=c.value.latest_message_time)),f.value&&(A.latest_message=f.value.content,A.latest_message_type=f.value.type,A.latest_message_time=f.value.timestamp),A}),r=g(()=>t.level*24),y=g(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),v=g(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),p=g(()=>t.minionData&&t.minionData.is_overseer&&v.value),b=g(()=>{const A=h.value;return A?A.state==="paused"&&A.is_processing?"pending-prompt":A.is_processing?"processing":A.state||"created":"created"}),w=g(()=>{const A=b.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[A]||"status-dot-grey"}),d=g(()=>{const A=b.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[A]||"#d3d3d3"}}),_=g(()=>{const A=h.value;if(!A||!A.latest_message_type)return"";const I=A.latest_message_type;return I==="user"?"User -->:":I==="system"?"System:":""}),C=g(()=>{const A=h.value;if(!A||!A.latest_message)return"";const I=A.latest_message,K=150;return I.length>K?I.slice(0,K)+"...":I}),S=g(()=>{const A=h.value;if(!A||!A.latest_message_time)return"";try{const I=Date.now();let K;if(typeof A.latest_message_time=="number"?K=A.latest_message_time<3250368e4?A.latest_message_time*1e3:A.latest_message_time:K=new Date(A.latest_message_time).getTime(),isNaN(K)||K<9466848e5||K>I+6e4)return console.warn("Invalid timestamp for relative time calculation:",A.latest_message_time,"parsed to:",K),"";const B=I-K;if(B<0)return"just now";const k=Math.floor(B/6e4),E=Math.floor(k/60),N=Math.floor(E/24);return N>0?`${N}d ago`:E>0?`${E}h ago`:k>0?`${k}m ago`:"just now"}catch(I){return console.error("Error calculating relative time:",I,A.latest_message_time),""}});function D(A){return A.to_user?"User":A.to_minion_name?A.to_minion_name:"unknown"}function V(A){const I=A.summary||A.content||"";return I.length>150?I.substring(0,150)+"...":I}function P(){n("minion-click",t.minionData.id)}function O(){const A=i.sessions.get(t.minionData.id);A&&l.showModal("edit-session",{session:A})}function F(){const A=i.sessions.get(t.minionData.id);A&&l.showModal("manage-session",{session:A})}return(A,I)=>{const K=sn("MinionTreeNode",!0);return o.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:pt({marginLeft:`${r.value}px`})},[o.layout==="sidebar"?(u(),m("div",{key:0,class:ee(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:y.value}]),onClick:P},[s("div",{class:ee(["status-dot me-2",w.value]),style:pt(d.value)},null,6),s("div",Y_,[s("div",J_,[p.value?(u(),m("span",X_,"ðŸ‘‘")):M("",!0),s("strong",null,$(o.minionData.name),1),p.value?(u(),m("span",Q_,$(o.minionData.children.length)+" "+$(o.minionData.children.length===1?"child":"children"),1)):M("",!0)]),h.value?.latest_message?(u(),m("div",Z_,[_.value?(u(),m("span",eg,$(_.value),1)):M("",!0),s("span",{class:"activity-content",title:h.value.latest_message},$(C.value),9,tg),S.value?(u(),m("span",sg,"("+$(S.value)+")",1)):M("",!0)])):o.minionData?.last_comm?(u(),m("div",og,[s("span",ng,[I[1]||(I[1]=oe("â†’ ",-1)),s("strong",null,$(D(o.minionData.last_comm)),1),I[2]||(I[2]=oe(": ",-1))]),s("span",{class:"activity-content",title:o.minionData.last_comm.content||""},$(V(o.minionData.last_comm)),9,ig)])):(u(),m("div",ag," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:he(O,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:he(F,["stop"])}," âš™ï¸ ")],2)):(u(),m("div",{key:1,class:ee(["minion-card minion-card-clickable border-start border-2 mb-2",{active:y.value}]),onClick:P},[s("div",lg,[s("div",rg,[s("div",{class:ee(["status-dot me-2",w.value]),style:pt(d.value)},null,6),p.value?(u(),m("span",cg,"ðŸ‘‘")):M("",!0),s("strong",null,$(o.minionData.name),1),p.value?(u(),m("span",ug,$(o.minionData.children.length)+" "+$(o.minionData.children.length===1?"child":"children"),1)):M("",!0)]),s("div",dg,[h.value?.latest_message?(u(),m("div",mg,[_.value?(u(),m("span",pg,$(_.value),1)):M("",!0),s("span",{class:"message-content",title:h.value.latest_message},$(C.value),9,fg),S.value?(u(),m("span",vg,"("+$(S.value)+")",1)):M("",!0)])):o.minionData?.last_comm?(u(),m("div",hg,[s("span",_g,[I[3]||(I[3]=oe("â†’ ",-1)),s("strong",null,$(D(o.minionData.last_comm)),1),I[4]||(I[4]=oe(":",-1))]),s("span",{class:"comm-content",title:o.minionData.last_comm.content||""},$(V(o.minionData.last_comm)),9,gg)])):(u(),m("div",bg," No activity yet "))]),s("div",yg,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:he(O,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:he(F,["stop"])}," âš™ï¸ ")])])],2)),v.value?(u(),m("div",wg,[(u(!0),m(re,null,ce(o.minionData.children,B=>(u(),ge(K,{key:B.id,"minion-data":B,level:o.level+1,layout:o.layout,onMinionClick:I[0]||(I[0]=k=>A.$emit("minion-click",k))},null,8,["minion-data","level","layout"]))),128))])):M("",!0)],4)):(u(),m("div",$g," âš  Minion data is missing "))}}},ci=te(Eg,[["__scopeId","data-v-e940b7c4"]]),Cg={class:"project-overview d-flex flex-column h-100"},Sg={class:"project-overview-header border-bottom p-3"},kg={class:"d-flex align-items-center justify-content-between"},Tg={class:"mb-1"},xg={key:0,class:"me-2"},Ag={class:"text-muted font-monospace"},Mg={class:"d-flex gap-2"},Og=["title"],Ng={class:"project-overview-content flex-grow-1 overflow-auto p-3"},Dg={key:0,class:"text-center py-5"},Lg={key:1,class:"alert alert-danger"},Ig={key:2,class:"text-center py-5"},Pg={key:3},jg={class:"row g-3 mb-4"},Rg={class:"col-md-4"},Wg={class:"card h-100"},Vg={class:"card-body"},Hg={class:"card-title mb-0"},Fg={class:"text-muted"},Bg={class:"col-md-4"},Ug={class:"card h-100"},qg={class:"card-body"},zg={class:"card-title mb-0"},Kg={class:"text-muted"},Gg={key:0,class:"card mb-4"},Yg={class:"card mb-4"},Jg={class:"card-header d-flex align-items-center justify-content-between"},Xg={class:"mb-0"},Qg={class:"badge bg-secondary"},Zg={class:"card-body"},eb={key:0,class:"text-center py-4"},tb={key:1,class:"text-center text-muted py-4"},sb={key:2,class:"hierarchy-tree"},ob={class:"user-root-node mb-3 border rounded bg-white"},nb={class:"node-row"},ib={class:"node-left"},ab={class:"badge bg-primary ms-2"},lb={class:"node-right"},rb={key:0,class:"last-comm-preview"},cb={class:"comm-direction"},ub=["title"],db={key:1,class:"text-muted fst-italic"},mb={class:"root-minions ms-4"},pb={class:"card"},fb={class:"card-body"},vb={class:"row mb-0"},hb={class:"col-sm-8 font-monospace text-break"},_b={class:"col-sm-8 font-monospace text-break"},gb={class:"col-sm-8"},bb={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},yb={class:"text-muted"},wb={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(o){const e=o,t=Ct(),n=ke(),i=ae(),a=me(),l=ps(),c=ze(),f=L(!1),h=L(null),r=L(null),y=L(!1);let v=null;const p=g(()=>n.getProject(e.projectId)),b=g(()=>p.value?.session_ids?p.value.session_ids.map(E=>i.getSession(E)).filter(E=>E!=null):[]),w=g(()=>b.value.length>0),d=g(()=>b.value.length),_=g(()=>b.value.filter(E=>E.state==="ACTIVE").length),C=g(()=>{const E=b.value.some(T=>T.state==="ACTIVE"),N=b.value.some(T=>T.is_processing);return b.value.some(T=>T.state==="ERROR")?"Error":N?"Working":E?"Active":d.value>0?"Idle":"Empty"}),S=g(()=>{switch(C.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),D=g(()=>{switch(C.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function V(){y.value=!0;try{const E=await ie.get(`/api/legions/${e.projectId}/hierarchy`);r.value=E}catch(E){console.error("Failed to load minion hierarchy:",E),r.value=null}finally{y.value=!1}}function P(E,N){if(E&&E.id===N)return E;if(E&&E.children)for(const x of E.children){const T=P(x,N);if(T)return T}return null}function O(E){return E.to_user?"User":E.to_minion_name?E.to_minion_name:"unknown"}function F(E){const N=E.summary||E.content||"";return N.length>150?N.substring(0,150)+"...":N}function A(E){if(r.value){if(E.from_minion_id){const N=P(r.value,E.from_minion_id);N&&N.type==="minion"&&(N.last_comm=E)}E.from_user&&r.value.type==="user"&&(r.value.last_comm=E)}}function I(E){t.push(`/session/${E}`)}function K(){t.push(`/timeline/${e.projectId}`)}function B(){a.showModal("edit-project",{project:p.value})}function k(){a.showModal("create-minion",{project:p.value})}return ve(()=>{n.selectProject(e.projectId),i.currentSessionId=null,V(),l.setCurrentLegion(e.projectId),c.connectLegion(e.projectId),v=le(()=>i.sessions,E=>{if(r.value){for(const[N,x]of E)if(x.project_id===e.projectId){const T=P(r.value,N);T&&T.type==="minion"&&(T.state!==x.state&&(T.state=x.state),T.is_processing!==x.is_processing&&(T.is_processing=x.is_processing),T.latest_message!==x.latest_message&&(T.latest_message=x.latest_message,T.latest_message_type=x.latest_message_type,T.latest_message_time=x.latest_message_time))}}},{deep:!0}),le(()=>l.commsByLegion.get(e.projectId),E=>{if(E&&E.length>0){const N=E[E.length-1];A(N)}},{deep:!0}),le(()=>n.projects.get(e.projectId)?.session_ids?.length||0,(E,N)=>{E!==N&&V()})}),le(()=>e.projectId,E=>{n.selectProject(E),i.currentSessionId=null,V(),l.setCurrentLegion(E),c.connectLegion(E)}),_e(()=>{v&&v()}),(E,N)=>(u(),m("div",Cg,[s("div",Sg,[s("div",kg,[s("div",null,[s("h4",Tg,[w.value?(u(),m("span",xg,"ðŸ›")):M("",!0),oe(" "+$(p.value?.name||"Project Overview"),1)]),s("small",Ag,$(p.value?.working_directory),1)]),s("div",Mg,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:B}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:w.value?"Create minion":"Add session",onClick:k}," âž• "+$(w.value?"Add Minion":"Add Session"),9,Og)])])]),s("div",Ng,[f.value?(u(),m("div",Dg,[...N[0]||(N[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):h.value?(u(),m("div",Lg,$(h.value),1)):p.value?(u(),m("div",Pg,[s("div",jg,[s("div",Rg,[s("div",Wg,[s("div",Vg,[N[2]||(N[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",Hg,$(d.value),1),s("small",Fg,$(_.value)+" active",1)])])]),s("div",Bg,[s("div",Ug,[s("div",qg,[N[3]||(N[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",zg,[s("span",{class:ee(S.value)},$(C.value),3)]),s("small",Kg,$(D.value),1)])])])]),w.value?(u(),m("div",Gg,[N[4]||(N[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:K}," ðŸ“Š View Timeline ")])])])):M("",!0),s("div",Yg,[s("div",Jg,[s("h5",Xg,"ðŸŒ³ "+$(w.value?"Minion Hierarchy":"Sessions"),1),s("span",Qg,$(b.value.length),1)]),s("div",Zg,[y.value?(u(),m("div",eb,[...N[5]||(N[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!r.value||!r.value.children||r.value.children.length===0?(u(),m("div",tb,' No sessions yet. Click "Add Session" to create one. ')):(u(),m("div",sb,[s("div",ob,[s("div",nb,[s("div",ib,[N[6]||(N[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,$(r.value.name),1),s("span",ab,$(r.value.children.length)+" "+$(r.value.children.length===1?"minion":"minions"),1)]),s("div",lb,[r.value.last_comm?(u(),m("div",rb,[s("span",cb,[N[7]||(N[7]=oe(" â†’ ",-1)),s("strong",null,$(O(r.value.last_comm)),1),N[8]||(N[8]=oe(": ",-1))]),s("span",{class:"comm-content",title:r.value.last_comm.content||""},$(F(r.value.last_comm)),9,ub)])):(u(),m("div",db," No communications yet "))])])]),s("div",mb,[(u(!0),m(re,null,ce(r.value.children,x=>(u(),ge(ci,{key:x.id,"minion-data":x,level:1,layout:"two-column",onMinionClick:I},null,8,["minion-data"]))),128))])]))])]),s("div",pb,[N[12]||(N[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",fb,[s("dl",vb,[N[9]||(N[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",hb,$(p.value.working_directory),1),N[10]||(N[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",_b,$(p.value.project_id),1),N[11]||(N[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",gb,$(w.value?"Yes (has minions)":"No"),1)])])])])):(u(),m("div",Ig,[...N[1]||(N[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",bb,[N[13]||(N[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",yb,$(d.value)+" session"+$(d.value!==1?"s":""),1)])]))}},$b=te(wb,[["__scopeId","data-v-168bf04c"]]),Eb=[{path:"/",name:"home",component:bi},{path:"/project/:projectId",name:"project",component:$b,props:!0},{path:"/session/:sessionId",name:"session",component:s_,props:!0},{path:"/timeline/:legionId",name:"timeline",component:G_,props:!0}],Cb=pi({history:fi(),routes:Eb}),Sb={class:"connection-indicators"},kb=["title"],Tb=["title"],xb=["title"],Ab={__name:"ConnectionIndicator",setup(o){const e=ze();function t(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:c}=a[i];return c>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function n(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},c={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:f,retryCount:h}=c[i];let r="Disconnected";return f?r="Connected":h>0&&(r=`Reconnecting (attempt ${h})`),`${a[i]}
${l[i]}
Status: ${r}`}return(i,a)=>(u(),m("div",Sb,[s("div",{class:ee(["indicator",t("ui")]),title:n("ui")}," ðŸŒ ",10,kb),s("div",{class:ee(["indicator",t("session")]),title:n("session")}," ðŸ’¬ ",10,Tb),s("div",{class:ee(["indicator",t("legion")]),title:n("legion")}," ðŸ‘¥ ",10,xb)]))}},Mb=te(Ab,[["__scopeId","data-v-d35b07c8"]]),Ob={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Nb={class:"d-flex align-items-center gap-2"},Db={__name:"AppHeader",setup(o){const e=me();function t(){e.toggleSidebar()}return(n,i)=>(u(),m("header",Ob,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",Nb,[de(Mb)])]))}},Lb={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Ib={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Pb=["title"],jb={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(o){const e=o,t=g(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function n(c){return c.state==="paused"&&c.is_processing?"pending-prompt":c.is_processing?"processing":c.state}function i(c){const f=n(c);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[f]||"#d3d3d3"}function a(c){const f=n(c);return f==="starting"||f==="processing"||f==="pending-prompt"}function l(c){const f=n(c),h=f.charAt(0).toUpperCase()+f.slice(1),r=c.name||"Unnamed Session",y=c.role?` (${c.role})`:"";return`${r}${y}: ${h}`}return(c,f)=>(u(),m("div",Lb,[!o.sessions||o.sessions.length===0?(u(),m("div",Ib)):(u(!0),m(re,{key:1},ce(o.sessions,h=>(u(),m("div",{key:h.session_id,class:ee(["progress-bar",{"progress-bar-striped progress-bar-animated":a(h)}]),style:pt({width:t.value,backgroundColor:i(h),cursor:"help"}),title:l(h)},null,14,Pb))),128))]))}},Rb=te(jb,[["__scopeId","data-v-391d77c1"]]),Wb=["data-project-id"],Vb=["id"],Hb=["aria-expanded","aria-controls","aria-label","onKeydown"],Fb=["aria-label","onKeydown"],Bb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Ub={class:"fw-semibold",style:{"flex-shrink":"0"}},qb={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},zb={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Kb=["title"],Gb=["title"],Yb=["id","aria-labelledby"],Jb={class:"accordion-body p-0"},Xb={class:"list-group list-group-flush"},Qb={class:"minion-hierarchy-container"},Zb={key:0,class:"text-center py-2"},ey={key:2,class:"text-muted text-center py-2 small"},ty={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(o){const e=o,t=Ct(),n=ke(),i=ae(),a=me(),l=L(e.project.is_expanded||!1),c=L(null),f=L(!1);let h=null;const r=g(()=>n.formatPath(e.project.working_directory)),y=g(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(k=>i.getSession(k)).filter(k=>k!=null)),v=g(()=>y.value.length>0),p=g(()=>{const k=t.currentRoute.value;return k.name==="timeline"&&k.params.legionId===e.project.project_id}),b=g(()=>{const k=t.currentRoute.value;return k.name==="project"&&k.params.projectId===e.project.project_id});function w(k){const E=window.bootstrap;if(!E)return;const N=document.getElementById(`collapse-${e.project.project_id}`);if(!N)return;E.Collapse.getOrCreateInstance(N).toggle(),l.value=!l.value}function d(){n.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function _(){l.value||(n.toggleExpansion(e.project.project_id),l.value=!0)}function C(){if(l.value){n.toggleExpansion(e.project.project_id),l.value=!1;const k=i.currentSessionId;k&&i.getSession(k)&&e.project.session_ids?.includes(k)&&t.push("/"),n.currentProjectId===e.project.project_id&&t.push("/")}}function S(){a.showModal("edit-project",{project:e.project})}function D(){a.showModal("create-minion",{project:e.project})}function V(){t.push(`/timeline/${e.project.project_id}`)}async function P(){f.value=!0;try{const k=await ie.get(`/api/legions/${e.project.project_id}/hierarchy`);c.value=k}catch(k){console.error("Failed to load minion hierarchy:",k),c.value=null}finally{f.value=!1}}function O(k){t.push(`/session/${k}`)}function F(k,E){if(k&&k.id===E)return k;if(k&&k.children)for(const N of k.children){const x=F(N,E);if(x)return x}return null}le(l,k=>{k&&P()}),ve(()=>{h=le(()=>i.sessions,k=>{if(!(!c.value||!l.value)){for(const[E,N]of k)if(N.project_id===e.project.project_id){const x=F(c.value,E);x&&x.type==="minion"&&(x.state!==N.state&&(x.state=N.state),x.is_processing!==N.is_processing&&(x.is_processing=N.is_processing),x.latest_message!==N.latest_message&&(x.latest_message=N.latest_message,x.latest_message_type=N.latest_message_type,x.latest_message_time=N.latest_message_time))}}},{deep:!0}),le(()=>i.sessions.size,(k,E)=>{if(l.value&&(k>E&&Array.from(i.sessions.values()).some(T=>T.project_id===e.project.project_id&&(!c.value||!F(c.value,T.session_id)))&&(console.log("New minion detected, reloading hierarchy"),P()),k<E&&c.value)){const N=i.sessions,x=T=>T.type==="minion"&&!N.has(T.id)?!0:T.children?T.children.some(j=>x(j)):!1;x(c.value)&&(console.log("Minion deletion detected, reloading hierarchy"),P())}}),l.value&&P()}),_e(()=>{h&&h()});function A(k){k.dataTransfer.effectAllowed="move",k.dataTransfer.setData("application/project-id",e.project.project_id),k.dataTransfer.setData("text/plain",e.project.project_id),k.target.classList.add("dragging")}function I(k){k.target.classList.remove("dragging")}function K(k){k.preventDefault(),k.dataTransfer.dropEffect="move";const E=k.currentTarget.getBoundingClientRect(),N=E.top+E.height/2;k.clientY<N?(k.currentTarget.classList.add("drop-above"),k.currentTarget.classList.remove("drop-below")):(k.currentTarget.classList.add("drop-below"),k.currentTarget.classList.remove("drop-above"))}function B(k){k.preventDefault(),k.currentTarget.classList.remove("drop-above","drop-below");const E=k.dataTransfer.getData("application/project-id")||k.dataTransfer.getData("text/plain");if(!E||E===e.project.project_id)return;const N=k.currentTarget.getBoundingClientRect(),x=N.top+N.height/2,T=k.clientY<x,j=n.orderedProjects,q=j.findIndex(pe=>pe.project_id===e.project.project_id),Y=j.findIndex(pe=>pe.project_id===E);if(q===-1||Y===-1)return;const Q=[...j],[G]=Q.splice(Y,1);let R=T?q:q+1;Y<q&&R--,Q.splice(R,0,G);const J=Q.map(pe=>pe.project_id);n.reorderProjects(J)}return(k,E)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":o.project.project_id,draggable:"true",onDragstart:A,onDragend:I,onDragover:K,onDrop:B},[s("h2",{class:"accordion-header",id:`heading-${o.project.project_id}`},[s("div",{class:ee(["accordion-button bg-white p-2 project-header-split",{collapsed:!l.value,"project-selected":b.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":l.value,"aria-controls":`collapse-${o.project.project_id}`,"aria-label":l.value?"Collapse session list":"Expand session list",onClick:he(w,["stop"]),onKeydown:[Xe(he(w,["prevent"]),["enter"]),Xe(he(w,["prevent"]),["space"])]},[(u(),m("svg",{class:ee(["chevron-icon",{expanded:l.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...E[0]||(E[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,Hb),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${o.project.name} overview`,onClick:d,onKeydown:[Xe(he(d,["prevent"]),["enter"]),Xe(he(d,["prevent"]),["space"])]},[s("div",Bb,[s("div",Ub,[v.value?(u(),m("span",qb,"ðŸ›")):M("",!0),oe(" "+$(o.project.name),1)]),s("div",zb,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:he(S,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:v.value?"Create minion":"Add session or minion",type:"button",onClick:he(D,["stop"])}," âž• ",8,Kb)])]),s("small",{class:"text-muted font-monospace",title:o.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(r.value),9,Gb)],40,Fb)],2)],8,Vb),de(Rb,{project:o.project,sessions:y.value},null,8,["project","sessions"]),s("div",{id:`collapse-${o.project.project_id}`,class:ee(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${o.project.project_id}`,onShown:_,onHidden:C},[s("div",Jb,[s("div",Xb,[v.value?(u(),m("div",{key:0,class:ee(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:p.value}]),style:{cursor:"pointer"},onClick:V},[...E[1]||(E[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):M("",!0),s("div",Qb,[f.value?(u(),m("div",Zb,[...E[2]||(E[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value&&c.value.children&&c.value.children.length>0?(u(!0),m(re,{key:1},ce(c.value.children,N=>(u(),ge(ci,{key:N.id,"minion-data":N,level:0,layout:"sidebar",onMinionClick:O},null,8,["minion-data"]))),128)):(u(),m("div",ey," No sessions "))])])])],42,Yb)],40,Wb))}},sy=te(ty,[["__scopeId","data-v-a15b34e8"]]),oy={class:"project-list"},ny={key:0,class:"text-muted text-center py-3"},iy={__name:"ProjectList",setup(o){const e=ke(),t=g(()=>e.orderedProjects);return(n,i)=>(u(),m("div",oy,[t.value.length===0?(u(),m("div",ny,' No projects yet. Click "New" to create one. ')):M("",!0),(u(!0),m(re,null,ce(t.value,a=>(u(),ge(sy,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},ay={class:"flex-grow-1 overflow-auto p-3"},ly={id:"sessions-container"},ry={__name:"Sidebar",setup(o){const e=me(),t=g(()=>e.sidebarCollapsed),n=g(()=>e.isMobile),i=g(()=>{if(n.value)return{};const r=`${e.sidebarWidth}px`;return{width:r,minWidth:"200px",maxWidth:"30vw","--sidebar-width":r}});function a(){e.showModal("create-project")}const l=L(!1);function c(r){l.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",h)}function f(r){l.value&&e.setSidebarWidth(r.clientX)}function h(){l.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",h)}return(r,y)=>(u(),m("aside",{id:"sidebar",class:ee(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&n.value,"desktop-collapsed":t.value&&!n.value}]),style:pt(i.value)},[s("div",ay,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[y[0]||(y[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),s("div",ly,[de(iy)])]),s("div",{class:"sidebar-resize-handle",onMousedown:c},null,32)],6))}},cy=te(ry,[["__scopeId","data-v-d792f0f0"]]),uy={class:"modal-dialog modal-lg"},dy={class:"modal-content"},my={class:"modal-body"},py={class:"mb-3"},fy={class:"input-group"},vy=["disabled"],hy={key:0,class:"text-center py-4"},_y={key:1,class:"alert alert-danger",role:"alert"},gy={key:2,class:"folder-list"},by=["onClick","onDblclick"],yy={class:"d-flex align-items-center flex-grow-1"},wy=["onClick"],$y={key:1,class:"text-center text-muted py-3"},Ey={class:"modal-footer"},Cy=["disabled"],Sy={__name:"FolderBrowserModal",setup(o){const e=me(),t=L(""),n=L(""),i=L([]),a=L(!1),l=L(""),c=L(null);let f=null,h=null;const r=g(()=>{if(!t.value)return null;const S=t.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?"/"+S.join("/"):"/")});function y(S){if(!S)return"";const D=S.split(/[\\/]/).filter(Boolean);return D.length<=2?S:".../"+D.slice(-2).join("/")}async function v(){a.value=!0,l.value="",i.value=[],n.value="";try{const S=t.value?{path:t.value}:{},D=await ie.get("/api/filesystem/browse",{params:S});D.current_path&&(t.value=D.current_path),i.value=D.directories||[]}catch(S){console.error("Failed to load directory:",S),l.value=S.message||"Failed to load directory"}finally{a.value=!1}}function p(S){n.value=S.path}function b(S){t.value=S.path,n.value="",v()}function w(){r.value&&(t.value=r.value,n.value="",v())}function d(){const S=n.value||t.value;S&&h&&h(S),f&&f.hide()}function _(){v()}function C(){i.value=[],n.value="",l.value="",h=null,e.hideModal()}return le(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&f){const D=S.data||{};t.value=D.defaultPath||D.currentPath||"",h=D.onSelect||null,f.show()}}),ve(()=>{c.value&&be(async()=>{const{default:S}=await import("./modal-BK1Vt_in.js").then(D=>D.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{f=new S(c.value),c.value.addEventListener("shown.bs.modal",_),c.value.addEventListener("hidden.bs.modal",C)})}),_e(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",_),c.value.removeEventListener("hidden.bs.modal",C)),f&&f.dispose()}),(S,D)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",uy,[s("div",dy,[D[6]||(D[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",my,[s("div",py,[D[1]||(D[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",fy,[ne(s("input",{type:"text",class:"form-control","onUpdate:modelValue":D[0]||(D[0]=V=>t.value=V),onKeyup:Xe(v,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[ue,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:v,disabled:a.value}," ðŸ”„ Refresh ",8,vy)])]),a.value?(u(),m("div",hy,[...D[2]||(D[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(u(),m("div",_y,$(l.value),1)):(u(),m("div",gy,[r.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:w,role:"button"},[...D[3]||(D[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):M("",!0),(u(!0),m(re,null,ce(i.value,V=>(u(),m("div",{key:V.path,class:ee(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:V.path===n.value}]),onClick:P=>p(V),onDblclick:P=>b(V),role:"button"},[s("div",yy,[D[4]||(D[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,$(V.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:he(P=>b(V),["stop"])}," Open ",8,wy)],42,by))),128)),i.value.length===0?(u(),m("div",$y," No subdirectories found ")):M("",!0)]))]),s("div",Ey,[D[5]||(D[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:d,disabled:!n.value},' Select "'+$(y(n.value||t.value))+'" ',9,Cy)])])])],512))}},ky=te(Sy,[["__scopeId","data-v-0d61ed46"]]),Ty={class:"modal-dialog"},xy={class:"modal-content"},Ay={class:"modal-body"},My={class:"mb-3"},Oy={key:0,class:"invalid-feedback"},Ny={class:"mb-3"},Dy={class:"input-group"},Ly={key:0,class:"invalid-feedback"},Iy={class:"mb-3 form-check"},Py={key:0,class:"mb-3 ms-4"},jy={key:1,class:"alert alert-danger",role:"alert"},Ry={class:"modal-footer"},Wy=["disabled"],Vy={key:0,class:"spinner-border spinner-border-sm me-2"},Hy={__name:"ProjectCreateModal",setup(o){const e=ke(),t=ae(),n=me(),i=L({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),a=L({name:"",workingDirectory:""}),l=L(!1),c=L(""),f=L(null);let h=null;function r(){n.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:d=>{i.value.workingDirectory=d,a.value.workingDirectory=""}})}function y(){a.value={};let d=!0;return i.value.name.trim()||(a.value.name="Project name is required",d=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",d=!1),d}async function v(){if(y()){l.value=!0,c.value="";try{const d=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(d.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),h&&h.hide(),p()}catch(d){console.error("Failed to create project:",d),c.value=d.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function p(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},a.value={},c.value=""}function b(){const d=document.getElementById("projectName");d&&d.focus()}function w(){p(),n.hideModal()}return le(()=>n.currentModal,d=>{d?.name==="create-project"&&h&&h.show()}),ve(()=>{f.value&&be(async()=>{const{default:d}=await import("./modal-BK1Vt_in.js").then(_=>_.m);return{default:d}},__vite__mapDeps([0,1])).then(({default:d})=>{h=new d(f.value),f.value.addEventListener("shown.bs.modal",b),f.value.addEventListener("hidden.bs.modal",w)})}),_e(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",b),f.value.removeEventListener("hidden.bs.modal",w)),h&&h.dispose()}),(d,_)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[s("div",Ty,[s("div",xy,[_[11]||(_[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Ay,[s("form",{onSubmit:he(v,["prevent"])},[s("div",My,[_[4]||(_[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ne(s("input",{type:"text",class:ee(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":_[0]||(_[0]=C=>i.value.name=C),placeholder:"My Project",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",Oy,$(a.value.name),1)):M("",!0)]),s("div",Ny,[_[5]||(_[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Dy,[ne(s("input",{type:"text",class:ee(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":_[1]||(_[1]=C=>i.value.workingDirectory=C),placeholder:"/path/to/project",required:""},null,2),[[ue,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:r}," Browse... "),a.value.workingDirectory?(u(),m("div",Ly,$(a.value.workingDirectory),1)):M("",!0)]),_[6]||(_[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",Iy,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":_[2]||(_[2]=C=>i.value.createSession=C)},null,512),[[ft,i.value.createSession]]),_[7]||(_[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),_[8]||(_[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(u(),m("div",Py,[_[9]||(_[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ne(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":_[3]||(_[3]=C=>i.value.sessionName=C),placeholder:"main"},null,512),[[ue,i.value.sessionName]])])):M("",!0),c.value?(u(),m("div",jy,$(c.value),1)):M("",!0)],32)]),s("div",Ry,[_[10]||(_[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:l.value},[l.value?(u(),m("span",Vy)):M("",!0),oe(" "+$(l.value?"Creating...":"Create Project"),1)],8,Wy)])])])],512))}},Fy=te(Hy,[["__scopeId","data-v-b8c9a401"]]),By={class:"modal-dialog"},Uy={class:"modal-content"},qy={class:"modal-body"},zy={class:"mb-3"},Ky={key:0,class:"invalid-feedback"},Gy={class:"mb-3"},Yy=["value"],Jy={key:0,class:"alert alert-danger",role:"alert"},Xy={class:"danger-zone"},Qy={class:"text-muted small"},Zy=["disabled"],e1={key:0,class:"alert alert-warning mt-3",role:"alert"},t1={class:"mb-2"},s1={class:"d-flex gap-2"},o1=["disabled"],n1={key:0,class:"spinner-border spinner-border-sm me-2"},i1=["disabled"],a1={class:"modal-footer"},l1=["disabled"],r1={key:0,class:"spinner-border spinner-border-sm me-2"},c1={__name:"ProjectEditModal",setup(o){const e=ke(),t=me(),n=L(null),i=L({name:""}),a=L({name:""}),l=L(!1),c=L(!1),f=L(""),h=L(!1),r=L(null);let y=null;const v=g(()=>n.value?.session_ids?.length||0);function p(){a.value={};let S=!0;return i.value.name.trim()||(a.value.name="Project name is required",S=!1),S}async function b(){if(!(!p()||!n.value)){l.value=!0,f.value="";try{await e.updateProject(n.value.project_id,{name:i.value.name}),y&&y.hide()}catch(S){console.error("Failed to update project:",S),f.value=S.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function w(){if(n.value){c.value=!0,f.value="";try{await e.deleteProject(n.value.project_id),y&&y.hide()}catch(S){console.error("Failed to delete project:",S),f.value=S.message||"Failed to delete project. Please try again."}finally{c.value=!1}}}function d(){i.value={name:""},a.value={},f.value="",h.value=!1}function _(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function C(){d(),n.value=null,t.hideModal()}return le(()=>t.currentModal,S=>{if(S?.name==="edit-project"&&y){const D=S.data||{};n.value=D.project,n.value&&(i.value.name=n.value.name),y.show()}}),ve(()=>{r.value&&be(async()=>{const{default:S}=await import("./modal-BK1Vt_in.js").then(D=>D.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{y=new S(r.value),r.value.addEventListener("shown.bs.modal",_),r.value.addEventListener("hidden.bs.modal",C)})}),_e(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",_),r.value.removeEventListener("hidden.bs.modal",C)),y&&y.dispose()}),(S,D)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",By,[s("div",Uy,[D[10]||(D[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",qy,[s("form",{onSubmit:he(b,["prevent"])},[s("div",zy,[D[3]||(D[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ne(s("input",{type:"text",class:ee(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":D[0]||(D[0]=V=>i.value.name=V),placeholder:"My Project",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",Ky,$(a.value.name),1)):M("",!0)]),s("div",Gy,[D[4]||(D[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:n.value?.working_directory,disabled:"",readonly:""},null,8,Yy),D[5]||(D[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),f.value?(u(),m("div",Jy,$(f.value),1)):M("",!0)],32),D[8]||(D[8]=s("hr",null,null,-1)),s("div",Xy,[D[6]||(D[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",Qy," Deleting this project will also delete all "+$(v.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:D[1]||(D[1]=V=>h.value=!0),disabled:c.value}," ðŸ—‘ï¸ Delete Project ",8,Zy)]),h.value?(u(),m("div",e1,[D[7]||(D[7]=s("strong",null,"Are you sure?",-1)),s("p",t1,' This will permanently delete the project "'+$(n.value?.name)+'" and all '+$(v.value)+" session(s). ",1),s("div",s1,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:w,disabled:c.value},[c.value?(u(),m("span",n1)):M("",!0),oe(" "+$(c.value?"Deleting...":"Yes, Delete Permanently"),1)],8,o1),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:D[2]||(D[2]=V=>h.value=!1),disabled:c.value}," Cancel ",8,i1)])])):M("",!0)]),s("div",a1,[D[9]||(D[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:l.value},[l.value?(u(),m("span",r1)):M("",!0),oe(" "+$(l.value?"Saving...":"Save Changes"),1)],8,l1)])])])],512))}},u1=te(c1,[["__scopeId","data-v-52679516"]]),d1={class:"modal-dialog modal-lg"},m1={class:"modal-content"},p1={class:"modal-header"},f1={class:"modal-title",id:"createSessionModalLabel"},v1={key:0,class:"text-muted small"},h1={class:"modal-body"},_1={class:"mb-3"},g1={key:0,class:"invalid-feedback"},b1={class:"mb-3"},y1={class:"mb-3"},w1={key:0,class:"form-text text-muted"},$1={class:"mb-3"},E1={class:"form-text d-flex justify-content-between"},C1={key:0,class:"invalid-feedback"},S1={class:"mb-3 form-check"},k1={key:0,class:"form-text text-warning"},T1={class:"mb-3"},x1={class:"mb-3 form-check"},A1={key:0,class:"alert alert-danger",role:"alert"},M1={class:"modal-footer"},O1=["disabled"],N1={key:0,class:"spinner-border spinner-border-sm me-2"},D1={__name:"SessionCreateModal",setup(o){const e=Ct();ke();const t=ae(),n=me(),i=L(null),a=L({name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0}),l=L({name:""}),c=L(!1),f=L(""),h=L(null);let r=null;const y={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},v=g(()=>a.value.system_prompt.length),p=g(()=>v.value>6e3),b=g(()=>v.value>5500&&v.value<=6e3),w=g(()=>y[a.value.model]||null);function d(){l.value={};let V=!0;return a.value.name.trim()||(l.value.name="Session name is required",V=!1),p.value&&(V=!1),V}async function _(){if(!(!d()||!i.value)){c.value=!0,f.value="";try{const V=a.value.allowed_tools.split(",").map(F=>F.trim()).filter(F=>F.length>0),P={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,allowed_tools:V},O=await t.createSession(i.value.project_id,P);a.value.startImmediately&&await t.startSession(O.session_id),e.push(`/session/${O.session_id}`),r&&r.hide(),C()}catch(V){console.error("Failed to create session:",V),f.value=V.message||"Failed to create session. Please try again."}finally{c.value=!1}}}function C(){a.value={name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0},l.value={},f.value=""}function S(){const V=document.getElementById("sessionName");V&&V.focus()}function D(){C(),i.value=null,n.hideModal()}return le(()=>n.currentModal,V=>{if(V?.name==="create-session"&&r){const P=V.data||{};i.value=P.project,r.show()}}),ve(()=>{h.value&&be(async()=>{const{default:V}=await import("./modal-BK1Vt_in.js").then(P=>P.m);return{default:V}},__vite__mapDeps([0,1])).then(({default:V})=>{r=new V(h.value),h.value.addEventListener("shown.bs.modal",S),h.value.addEventListener("hidden.bs.modal",D)})}),_e(()=>{h.value&&(h.value.removeEventListener("shown.bs.modal",S),h.value.removeEventListener("hidden.bs.modal",D)),r&&r.dispose()}),(V,P)=>(u(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[s("div",d1,[s("div",m1,[s("div",p1,[s("h5",f1,[P[7]||(P[7]=oe(" Create New Session ",-1)),i.value?(u(),m("span",v1,"in "+$(i.value.name),1)):M("",!0)]),P[8]||(P[8]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",h1,[s("form",{onSubmit:he(_,["prevent"])},[s("div",_1,[P[9]||(P[9]=s("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),ne(s("input",{type:"text",class:ee(["form-control",{"is-invalid":l.value.name}]),id:"sessionName","onUpdate:modelValue":P[0]||(P[0]=O=>a.value.name=O),placeholder:"main",required:""},null,2),[[ue,a.value.name]]),l.value.name?(u(),m("div",g1,$(l.value.name),1)):M("",!0)]),s("div",b1,[P[11]||(P[11]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ne(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":P[1]||(P[1]=O=>a.value.permission_mode=O)},[...P[10]||(P[10]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Pe,a.value.permission_mode]]),P[12]||(P[12]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",y1,[P[14]||(P[14]=s("label",{for:"model",class:"form-label"},"Model",-1)),ne(s("select",{class:"form-select",id:"model","onUpdate:modelValue":P[2]||(P[2]=O=>a.value.model=O)},[...P[13]||(P[13]=[s("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),s("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),s("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),s("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Pe,a.value.model]]),w.value?(u(),m("small",w1,$(w.value.description),1)):M("",!0)]),s("div",$1,[P[15]||(P[15]=s("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),ne(s("textarea",{class:ee(["form-control",{"is-invalid":p.value}]),id:"systemPrompt","onUpdate:modelValue":P[3]||(P[3]=O=>a.value.system_prompt=O),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[ue,a.value.system_prompt]]),s("div",E1,[s("span",null,$(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),s("span",{class:ee({"text-danger":p.value,"text-warning":b.value})},$(v.value)+" / 6000 chars ",3)]),p.value?(u(),m("div",C1," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):M("",!0)]),s("div",S1,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":P[4]||(P[4]=O=>a.value.override_system_prompt=O)},null,512),[[ft,a.value.override_system_prompt]]),P[17]||(P[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),m("div",k1,[...P[16]||(P[16]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):M("",!0)]),s("div",T1,[P[18]||(P[18]=s("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),ne(s("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":P[5]||(P[5]=O=>a.value.allowed_tools=O),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[ue,a.value.allowed_tools]]),P[19]||(P[19]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",x1,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":P[6]||(P[6]=O=>a.value.startImmediately=O)},null,512),[[ft,a.value.startImmediately]]),P[20]||(P[20]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),f.value?(u(),m("div",A1,$(f.value),1)):M("",!0)],32)]),s("div",M1,[P[21]||(P[21]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:c.value},[c.value?(u(),m("span",N1)):M("",!0),oe(" "+$(c.value?"Creating...":"Create Session"),1)],8,O1)])])])],512))}},L1=te(D1,[["__scopeId","data-v-8bfe4c32"]]),I1={class:"modal-dialog"},P1={class:"modal-content"},j1={class:"modal-body"},R1={class:"mb-3"},W1={key:0,class:"invalid-feedback"},V1={class:"mb-3"},H1=["value"],F1={class:"mb-3"},B1={class:"form-control-plaintext"},U1={class:"mb-3"},q1=["disabled"],z1={key:0,value:"bypassPermissions"},K1={class:"form-text"},G1={key:0,class:"text-warning"},Y1={key:1},J1={key:0,class:"mb-3"},X1={class:"card"},Q1={class:"card-body"},Z1={key:0,class:"mb-2"},ew={key:1,class:"mb-2"},tw={key:2,class:"mt-2"},sw={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},ow={key:1,class:"alert alert-danger",role:"alert"},nw={class:"modal-footer"},iw=["disabled"],aw={key:0,class:"spinner-border spinner-border-sm me-2"},lw={__name:"SessionEditModal",setup(o){const e=ae(),t=me(),n=L(null),i=L({name:"",permission_mode:"default"}),a=L({name:""}),l=L(!1),c=L(""),f=L(null);let h=null;const r=g(()=>n.value?.state==="active"||n.value?.state==="starting"),y=g(()=>n.value?.initial_permission_mode==="bypassPermissions");function v(C){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[C]||"bg-secondary"}function p(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Session name is required",C=!1),C}async function b(){if(!(!p()||!n.value)){l.value=!0,c.value="";try{await e.updateSessionName(n.value.session_id,i.value.name),i.value.permission_mode!==n.value.current_permission_mode&&await e.setPermissionMode(n.value.session_id,i.value.permission_mode),h&&h.hide()}catch(C){console.error("Failed to update session:",C),c.value=C.message||"Failed to update session. Please try again."}finally{l.value=!1}}}function w(){i.value={name:"",permission_mode:"default"},a.value={},c.value=""}function d(){const C=document.getElementById("editSessionName");C&&(C.focus(),C.select())}function _(){w(),n.value=null,t.hideModal()}return le(()=>t.currentModal,C=>{if(C?.name==="edit-session"&&h){const S=C.data||{};n.value=S.session,n.value&&(i.value.name=n.value.name,i.value.permission_mode=n.value.current_permission_mode||"default"),h.show()}}),ve(()=>{f.value&&be(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(S=>S.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{h=new C(f.value),f.value.addEventListener("shown.bs.modal",d),f.value.addEventListener("hidden.bs.modal",_)})}),_e(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",d),f.value.removeEventListener("hidden.bs.modal",_)),h&&h.dispose()}),(C,S)=>(u(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[s("div",I1,[s("div",P1,[S[15]||(S[15]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",j1,[s("form",{onSubmit:he(b,["prevent"])},[s("div",R1,[S[2]||(S[2]=s("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),ne(s("input",{type:"text",class:ee(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":S[0]||(S[0]=D=>i.value.name=D),placeholder:"Session Name",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",W1,$(a.value.name),1)):M("",!0)]),s("div",V1,[S[3]||(S[3]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:n.value?.working_directory,disabled:"",readonly:""},null,8,H1),S[4]||(S[4]=s("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),s("div",F1,[S[5]||(S[5]=s("label",{class:"form-label"},"Current State",-1)),s("div",B1,[s("span",{class:ee(["badge",v(n.value?.state)])},$(n.value?.state),3)])]),s("div",U1,[S[9]||(S[9]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ne(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":S[1]||(S[1]=D=>i.value.permission_mode=D),disabled:!r.value},[S[6]||(S[6]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),S[7]||(S[7]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),S[8]||(S[8]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),y.value?(u(),m("option",z1,"âš ï¸ Bypass Permissions (No prompts)")):M("",!0)],8,q1),[[Pe,i.value.permission_mode]]),s("div",K1,[r.value?(u(),m("span",Y1," Controls which tool actions require permission prompts ")):(u(),m("span",G1," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),n.value?.system_prompt||n.value?.override_system_prompt?(u(),m("div",J1,[S[13]||(S[13]=s("label",{class:"form-label"},"System Prompt Configuration",-1)),s("div",X1,[s("div",Q1,[n.value?.override_system_prompt?(u(),m("div",Z1,[...S[10]||(S[10]=[s("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),s("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),m("div",ew,[...S[11]||(S[11]=[s("span",{class:"badge bg-info"},"Append Mode",-1),s("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),n.value?.system_prompt?(u(),m("div",tw,[S[12]||(S[12]=s("strong",{class:"small"},"Custom Instructions:",-1)),s("div",sw,$(n.value.system_prompt),1)])):M("",!0)])])])):M("",!0),c.value?(u(),m("div",ow,$(c.value),1)):M("",!0)],32)]),s("div",nw,[S[14]||(S[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:l.value},[l.value?(u(),m("span",aw)):M("",!0),oe(" "+$(l.value?"Saving...":"Save Changes"),1)],8,iw)])])])],512))}},rw=te(lw,[["__scopeId","data-v-c99ca17f"]]),cw={class:"modal-dialog modal-dialog-centered"},uw={class:"modal-content"},dw={class:"modal-header"},mw={class:"modal-title",id:"manageSessionModalLabel"},pw={class:"modal-body"},fw={key:0,class:"text-center py-4"},vw={class:"text-muted"},hw={key:1},_w={key:2},gw={class:"text-muted"},bw={key:0,class:"text-center py-2"},yw={key:1,class:"alert alert-warning mt-3"},ww={class:"mb-0 mt-2"},$w={key:0,class:"text-muted"},Ew={key:3},Cw={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},Sw={class:"d-grid gap-2"},kw=["disabled"],Tw=["disabled"],xw=["disabled"],Aw=["disabled"],Mw={class:"modal-footer"},Ow={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},Nw={__name:"SessionManageModal",setup(o){const e=Ct(),t=ae(),n=me(),i=ze();xe();const a=L(null),l=L(!1),c=L(""),f=L(""),h=L(null),r=L(null);let y=null;const v=L([]),p=L(!1),b=g(()=>h.value==="reset"?"Reset Session":h.value==="delete"?"Delete Session":"Manage Session");function w(){h.value="reset"}async function d(){if(h.value="delete",v.value=[],!!a.value){p.value=!0;try{const A=await ie.get(`/api/sessions/${a.value.session_id}/descendants`);v.value=A.descendants||[]}catch(A){console.error("Failed to fetch descendants:",A),v.value=[]}finally{p.value=!1}}}function _(){h.value=null}async function C(){h.value==="reset"?await V():h.value==="delete"&&await P()}async function S(){if(a.value){l.value=!0,c.value="Restarting session...";try{const A=a.value.session_id,I=t.currentSessionId===A,K=await ie.post(`/api/sessions/${A}/restart`);if(K.success)console.log("Session restarted successfully"),I&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A)),y&&y.hide();else{const B=K.error||K.detail||"Failed to restart session";console.error("Failed to restart session:",B),f.value=`Failed to restart session: ${B}`}}catch(A){console.error("Error restarting session:",A);const I=A.data?.detail||A.message||"Unknown error";f.value=`Error restarting session: ${I}`}finally{l.value=!1}}}async function D(){if(a.value)try{y&&y.hide(),console.log("Ending session",a.value.session_id);const A=a.value.session_id;await ie.post(`/api/sessions/${A}/terminate`),t.currentSessionId===A&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(A){console.error("Error ending session:",A),t.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function V(){if(a.value){l.value=!0,c.value="Resetting session...";try{const A=a.value.session_id,I=t.currentSessionId===A,K=await ie.post(`/api/sessions/${A}/reset`);if(K.success)console.log("Session reset successfully"),I&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A)),y&&y.hide();else{const B=K.error||K.detail||"Failed to reset session";console.error("Failed to reset session:",B),f.value=`Failed to reset session: ${B}`,h.value=null}}catch(A){console.error("Error resetting session:",A);const I=A.data?.detail||A.message||"Unknown error";f.value=`Error resetting session: ${I}`,h.value=null}finally{l.value=!1}}}async function P(){if(a.value){l.value=!0,c.value="Deleting session...";try{const A=a.value.session_id;await t.deleteSession(A),e.currentRoute.value.params.sessionId===A&&e.push("/"),y&&y.hide()}catch(A){console.error("Error deleting session:",A);const I=A.data?.detail||A.message||"Unknown error";f.value=`Error deleting session: ${I}`,h.value=null}finally{l.value=!1}}}function O(){h.value=null,l.value=!1,c.value="",f.value="",v.value=[],p.value=!1}function F(){O(),a.value=null,n.hideModal()}return le(()=>n.currentModal,A=>{if(A?.name==="manage-session"&&y){const I=A.data||{};a.value=I.session,O(),y.show()}}),ve(()=>{r.value&&be(async()=>{const{default:A}=await import("./modal-BK1Vt_in.js").then(I=>I.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{y=new A(r.value),r.value.addEventListener("hidden.bs.modal",F)})}),_e(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",F),y&&y.dispose()}),(A,I)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",cw,[s("div",uw,[s("div",dw,[s("h5",mw,$(h.value?b.value:"Manage Session"),1),I[1]||(I[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",pw,[l.value?(u(),m("div",fw,[I[2]||(I[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",vw,$(c.value),1)])):h.value==="reset"?(u(),m("div",hw,[...I[3]||(I[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):h.value==="delete"?(u(),m("div",_w,[I[9]||(I[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",gw,[I[4]||(I[4]=oe("This will permanently delete session ",-1)),s("strong",null,$(a.value?.name),1),I[5]||(I[5]=oe(".",-1))]),I[10]||(I[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),p.value?(u(),m("div",bw,[...I[6]||(I[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):v.value.length>0?(u(),m("div",yw,[I[7]||(I[7]=s("strong",null,"Cascading Deletion:",-1)),I[8]||(I[8]=oe(" This session has ",-1)),s("strong",null,$(v.value.length),1),oe(" child session"+$(v.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",ww,[(u(!0),m(re,null,ce(v.value,K=>(u(),m("li",{key:K.session_id,class:"small"},[s("strong",null,$(K.name||K.session_id),1),K.role?(u(),m("span",$w," ("+$(K.role)+")",1)):M("",!0)]))),128))])])):M("",!0)])):(u(),m("div",Ew,[f.value?(u(),m("div",Cw,[I[11]||(I[11]=s("strong",null,"Error:",-1)),oe(" "+$(f.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:I[0]||(I[0]=K=>f.value="")})])):M("",!0),I[18]||(I[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",Sw,[s("button",{class:"btn btn-outline-primary text-start",onClick:S,disabled:l.value},[...I[12]||(I[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,kw),s("button",{class:"btn btn-outline-secondary text-start",onClick:D,disabled:l.value},[...I[13]||(I[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,Tw),I[16]||(I[16]=s("hr",{class:"my-2"},null,-1)),I[17]||(I[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:w,disabled:l.value},[...I[14]||(I[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,xw),s("button",{class:"btn btn-outline-danger text-start",onClick:d,disabled:l.value},[...I[15]||(I[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,Aw)]),I[19]||(I[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),oe(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",Mw,[h.value&&!l.value?(u(),m(re,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),s("button",{type:"button",class:ee(["btn",h.value==="delete"?"btn-danger":"btn-warning"]),onClick:C},$(h.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?M("",!0):(u(),m("button",Ow,"Cancel"))])])])],512))}},Dw=te(Nw,[["__scopeId","data-v-6b832853"]]),Lw={class:"modal-dialog modal-dialog-centered modal-lg"},Iw={class:"modal-content"},Pw={class:"modal-body"},jw={key:0,class:"text-center text-muted py-4"},Rw={key:1},Ww={class:"mb-3"},Vw={class:"font-monospace small"},Hw={class:"mb-3"},Fw=["value"],Bw={class:"mb-3"},Uw={class:"mb-3"},qw={class:"mb-3"},zw={key:0},Kw={class:"d-flex flex-wrap gap-1"},Gw={key:1,class:"text-muted small"},Yw={key:0,class:"mb-3"},Jw={class:"d-flex flex-wrap gap-1"},Xw={key:1,class:"mb-3"},Qw={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},Zw={class:"mb-3"},e$={class:"text-muted"},t$={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},s$={__name:"SessionInfoModal",setup(o){const e=ae(),t=xe(),n=me(),i=L(null),a=L(!1),l=L(null);let c=null;const f={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},h=g(()=>{if(!i.value)return null;const w=e.initData.get(i.value);return w||(t.messagesBySession.get(i.value)||[]).find(C=>C.type==="system"&&(C.subtype==="init"||C.metadata?.subtype==="init")&&C.metadata?.init_data)?.metadata?.init_data||null});function r(w){return w?f[w]||w:"Default (Sonnet 4.5)"}function y(w){return typeof w=="string"?w:typeof w=="object"&&w.type==="preset"?`Preset: ${w.preset}`:JSON.stringify(w,null,2)}function v(w){w.target.select()}function p(){i.value=null,a.value=!1}function b(){p(),n.hideModal()}return le(()=>n.currentModal,w=>{if(w?.name==="session-info"&&c){const d=w.data||{};i.value=d.sessionId,a.value=!1,c.show()}}),ve(()=>{l.value&&be(async()=>{const{default:w}=await import("./modal-BK1Vt_in.js").then(d=>d.m);return{default:w}},__vite__mapDeps([0,1])).then(({default:w})=>{c=new w(l.value),l.value.addEventListener("hidden.bs.modal",b)})}),_e(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",b),c&&c.dispose()}),(w,d)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",Lw,[s("div",Iw,[d[9]||(d[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Pw,[h.value?(u(),m("div",Rw,[s("div",Ww,[d[1]||(d[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",Vw,$(i.value),1)]),s("div",Hw,[d[2]||(d[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:h.value.cwd||"Not specified",readonly:"",onClick:v},null,8,Fw)]),s("div",Bw,[d[3]||(d[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,$(r(h.value.model)),1)]),s("div",Uw,[d[4]||(d[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,$(h.value.permissionMode||"default"),1)]),s("div",qw,[d[5]||(d[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(h.value.allowed_tools||h.value.tools)&&(h.value.allowed_tools||h.value.tools).length>0?(u(),m("div",zw,[s("div",Kw,[(u(!0),m(re,null,ce(h.value.allowed_tools||h.value.tools,_=>(u(),m("span",{key:_,class:"badge bg-secondary"},$(_),1))),128))])])):(u(),m("div",Gw,"No pre-authorized tools (will prompt for permissions)"))]),h.value.commands&&h.value.commands.length>0?(u(),m("div",Yw,[d[6]||(d[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",Jw,[(u(!0),m(re,null,ce(h.value.commands,_=>(u(),m("span",{key:_,class:"badge bg-info"},$(_),1))),128))])])):M("",!0),h.value.systemPrompt?(u(),m("div",Xw,[d[7]||(d[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",Qw,$(y(h.value.systemPrompt)),1)])):M("",!0),s("div",Zw,[s("h6",e$,[d[8]||(d[8]=oe(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:d[0]||(d[0]=_=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(u(),m("pre",t$,$(JSON.stringify(h.value,null,2)),1)):M("",!0)])])):(u(),m("div",jw," No session configuration data available "))]),d[10]||(d[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},o$=te(s$,[["__scopeId","data-v-b28b39b3"]]),n$={class:"modal-dialog modal-dialog-centered"},i$={class:"modal-content"},a$={class:"modal-body"},l$={class:"mb-3"},r$=["value"],c$={key:0,class:"form-text"},u$={class:"mb-3"},d$={class:"mb-3"},m$={key:0,class:"form-text text-muted"},p$={class:"mb-3"},f$={for:"minion-role",class:"form-label"},v$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},h$={key:1,class:"field-indicator modified",title:"Modified from template"},_$=["placeholder","title"],g$={class:"mb-3"},b$={for:"minion-context",class:"form-label"},y$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},w$={key:1,class:"field-indicator modified",title:"Modified from template"},$$=["title"],E$={class:"form-text d-flex justify-content-between"},C$={key:0,class:"invalid-feedback"},S$={class:"mb-3 form-check"},k$={key:0,class:"form-text text-warning"},T$={class:"mb-3"},x$={class:"mb-3"},A$={class:"input-group"},M$={class:"mb-3"},O$={for:"permission-mode",class:"form-label"},N$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},D$={key:1,class:"field-indicator modified",title:"Modified from template"},L$=["title"],I$={class:"mb-3"},P$={for:"allowed-tools",class:"form-label"},j$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},R$={key:1,class:"field-indicator modified",title:"Modified from template"},W$=["title"],V$={class:"mb-3 form-check"},H$={key:0,class:"form-text text-muted"},F$={key:1,class:"form-text text-info"},B$={class:"mb-3 form-check"},U$={key:0,class:"alert alert-danger"},q$={class:"modal-footer"},z$=["disabled"],K$={key:0,class:"spinner-border spinner-border-sm me-2"},G$={__name:"CreateMinionModal",setup(o){const e=Ct(),t=ke(),n=ae(),i=me(),a=L(null);let l=null;const c=L(null),f=L([]),h=L(null),r=L(new Set),y=L({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),v=L({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),p=L({name:"",model:"sonnet",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:"",sandbox_enabled:!1,startImmediately:!0}),b={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},w=L(""),d=L(""),_=L(!1),C=g(()=>w.value.trim()?w.value.split(",").map(G=>G.trim()).filter(G=>G.length>0):[]),S=g(()=>p.value.allowed_tools.trim()?p.value.allowed_tools.split(",").map(G=>G.trim()).filter(G=>G.length>0):null),D=g(()=>b[p.value.model]||null),V=g(()=>p.value.initialization_context.length),P=g(()=>V.value>2e3),O=g(()=>V.value>1800&&V.value<=2e3),F=g(()=>h.value?f.value.find(G=>G.template_id===h.value):null),A=g(()=>F.value?.default_role||"e.g., Code Expert, Testing Specialist"),I=g(()=>({"field-autofilled":v.value.role==="autofilled","field-modified":v.value.role==="modified"})),K=g(()=>({"field-autofilled":v.value.initialization_context==="autofilled","field-modified":v.value.initialization_context==="modified"})),B=g(()=>({"field-autofilled":v.value.permission_mode==="autofilled","field-modified":v.value.permission_mode==="modified"})),k=g(()=>({"field-autofilled":v.value.allowed_tools==="autofilled","field-modified":v.value.allowed_tools==="modified"})),E=G=>{const R=v.value[G];return R==="autofilled"?`Auto-filled from template: ${F.value?.name}`:R==="modified"?"Modified from template value":""};async function N(){try{console.log("[CreateMinionModal] Loading templates...");const G=await ie.get("/api/templates");console.log("[CreateMinionModal] Templates data:",G),f.value=G||[],console.log("[CreateMinionModal] Templates set to:",f.value)}catch(G){console.error("[CreateMinionModal] Failed to load templates:",G),f.value=[]}}function x(){if(r.value.clear(),!F.value){p.value.role="",p.value.initialization_context="",p.value.permission_mode="default",p.value.allowed_tools="",v.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},y.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const G=F.value;if(v.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},G.default_role?(p.value.role=G.default_role,r.value.add("role"),y.value.role=G.default_role,v.value.role="autofilled"):(p.value.role="",y.value.role=null,v.value.role="normal"),G.default_system_prompt?(p.value.initialization_context=G.default_system_prompt,r.value.add("initialization_context"),y.value.initialization_context=G.default_system_prompt,v.value.initialization_context="autofilled"):(p.value.initialization_context="",y.value.initialization_context=null,v.value.initialization_context="normal"),G.permission_mode?(p.value.permission_mode=G.permission_mode,r.value.add("permission_mode"),y.value.permission_mode=G.permission_mode,v.value.permission_mode="autofilled"):(p.value.permission_mode="default",y.value.permission_mode=null,v.value.permission_mode="normal"),G.allowed_tools&&G.allowed_tools.length>0){const R=G.allowed_tools.join(", ");p.value.allowed_tools=R,r.value.add("allowed_tools"),y.value.allowed_tools=R,v.value.allowed_tools="autofilled"}else p.value.allowed_tools="",y.value.allowed_tools=null,v.value.allowed_tools="normal"}function T(){i.showModal("template-management",{})}function j(){const R=(c.value?t.projects.get(c.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:R,currentPath:p.value.working_directory||"",onSelect:J=>{p.value.working_directory=J}})}function q(){p.value={name:"",model:"sonnet",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:"",sandbox_enabled:!1,startImmediately:!0},w.value="",h.value=null,r.value.clear(),v.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},y.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},d.value="",_.value=!1}function Y(){q(),i.hideModal()}async function Q(){if(!p.value.name.trim()){d.value="Minion name is required";return}if(p.value.name.includes(" ")){d.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(P.value){d.value="Initialization context exceeds 2000 character limit";return}if(!c.value){d.value="Legion ID is missing";return}_.value=!0,d.value="";try{const G={name:p.value.name.trim(),model:p.value.model,role:p.value.role.trim(),initialization_context:p.value.initialization_context.trim(),override_system_prompt:p.value.override_system_prompt,capabilities:C.value,permission_mode:p.value.permission_mode,allowed_tools:S.value,working_directory:p.value.working_directory.trim()||null,sandbox_enabled:p.value.sandbox_enabled},R=await ie.post(`/api/legions/${c.value}/minions`,G);R.success&&R.minion_id?(await t.fetchProjects(),await n.fetchSessions(),p.value.startImmediately&&await n.startSession(R.minion_id),l&&l.hide(),e.push(`/session/${R.minion_id}`)):d.value="Failed to create minion"}catch(G){console.error("Failed to create minion:",G),d.value=G.response?.data?.detail||"Failed to create minion"}finally{_.value=!1}}return le(()=>i.currentModal,(G,R)=>{if(G?.name==="create-minion"&&l){const J=G.data||{};c.value=J.project?.project_id||null,q(),N(),l.show()}else R?.name==="template-management"&&l&&a.value?.classList.contains("show")&&N()}),le(()=>p.value.role,G=>{y.value.role!==null&&(G===y.value.role?v.value.role="autofilled":v.value.role="modified")}),le(()=>p.value.initialization_context,G=>{y.value.initialization_context!==null&&(G===y.value.initialization_context?v.value.initialization_context="autofilled":v.value.initialization_context="modified")}),le(()=>p.value.permission_mode,G=>{y.value.permission_mode!==null&&(G===y.value.permission_mode?v.value.permission_mode="autofilled":v.value.permission_mode="modified")}),le(()=>p.value.allowed_tools,G=>{y.value.allowed_tools!==null&&(G===y.value.allowed_tools?v.value.allowed_tools="autofilled":v.value.allowed_tools="modified")}),ve(()=>{a.value&&be(()=>import("./modal-BK1Vt_in.js").then(G=>G.m),__vite__mapDeps([0,1])).then(G=>{const R=G.default;l=new R(a.value),a.value.addEventListener("hidden.bs.modal",Y)}),N()}),_e(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",Y),l&&l.dispose()}),(G,R)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[s("div",n$,[s("div",i$,[R[37]||(R[37]=s("div",{class:"modal-header"},[s("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",a$,[s("form",{onSubmit:he(Q,["prevent"])},[s("div",l$,[s("label",{for:"template-select",class:"form-label"},[R[12]||(R[12]=oe(" Template ",-1)),s("button",{type:"button",onClick:T,class:"btn btn-link btn-sm p-0 ms-2"}," âš™ï¸ Manage Templates ")]),ne(s("select",{id:"template-select","onUpdate:modelValue":R[0]||(R[0]=J=>h.value=J),onChange:x,class:"form-select"},[R[13]||(R[13]=s("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(re,null,ce(f.value,J=>(u(),m("option",{key:J.template_id,value:J.template_id},$(J.name),9,r$))),128))],544),[[Pe,h.value]]),F.value?(u(),m("div",c$,$(F.value.description),1)):M("",!0)]),s("div",u$,[R[14]||(R[14]=s("label",{for:"minion-name",class:"form-label"},[oe(" Name "),s("span",{class:"text-danger"},"*")],-1)),ne(s("input",{id:"minion-name","onUpdate:modelValue":R[1]||(R[1]=J=>p.value.name=J),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[ue,p.value.name]]),R[15]||(R[15]=s("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),s("div",d$,[R[17]||(R[17]=s("label",{for:"model",class:"form-label"},"Model",-1)),ne(s("select",{class:"form-select",id:"model","onUpdate:modelValue":R[2]||(R[2]=J=>p.value.model=J)},[...R[16]||(R[16]=[s("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),s("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),s("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),s("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Pe,p.value.model]]),D.value?(u(),m("small",m$,$(D.value.description),1)):M("",!0)]),s("div",p$,[s("label",f$,[R[18]||(R[18]=oe(" Role ",-1)),v.value.role==="autofilled"?(u(),m("span",v$," âš¡ ")):M("",!0),v.value.role==="modified"?(u(),m("span",h$," âœï¸ ")):M("",!0)]),ne(s("input",{id:"minion-role","onUpdate:modelValue":R[3]||(R[3]=J=>p.value.role=J),type:"text",class:ee(["form-control",I.value]),placeholder:A.value,title:E("role")},null,10,_$),[[ue,p.value.role]]),R[19]||(R[19]=s("div",{class:"form-text"}," Optional role description for the minion ",-1))]),s("div",g$,[s("label",b$,[R[20]||(R[20]=oe(" Initialization Context ",-1)),v.value.initialization_context==="autofilled"?(u(),m("span",y$," âš¡ ")):M("",!0),v.value.initialization_context==="modified"?(u(),m("span",w$," âœï¸ ")):M("",!0)]),ne(s("textarea",{id:"minion-context","onUpdate:modelValue":R[4]||(R[4]=J=>p.value.initialization_context=J),class:ee(["form-control",[K.value,{"is-invalid":P.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:E("initialization_context")},null,10,$$),[[ue,p.value.initialization_context]]),s("div",E$,[s("span",null,$(p.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),s("span",{class:ee({"text-danger":P.value,"text-warning":O.value})},$(V.value)+" / 2000 chars ",3)]),P.value?(u(),m("div",C$," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):M("",!0)]),s("div",S$,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":R[5]||(R[5]=J=>p.value.override_system_prompt=J)},null,512),[[ft,p.value.override_system_prompt]]),R[22]||(R[22]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),p.value.override_system_prompt?(u(),m("div",k$,[...R[21]||(R[21]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):M("",!0)]),s("div",T$,[R[23]||(R[23]=s("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),ne(s("input",{id:"minion-capabilities","onUpdate:modelValue":R[6]||(R[6]=J=>w.value=J),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[ue,w.value]]),R[24]||(R[24]=s("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),s("div",x$,[R[25]||(R[25]=s("label",{for:"working-directory",class:"form-label"}," Working Directory (Optional) ",-1)),s("div",A$,[ne(s("input",{id:"working-directory","onUpdate:modelValue":R[7]||(R[7]=J=>p.value.working_directory=J),type:"text",class:"form-control",placeholder:"Leave empty to inherit from legion"},null,512),[[ue,p.value.working_directory]]),s("button",{type:"button",class:"btn btn-outline-secondary",onClick:j}," ðŸ“ Browse ")]),R[26]||(R[26]=s("div",{class:"form-text"}," Custom working directory for git worktrees or multi-repo workflows. Relative paths will be converted to absolute. ",-1))]),s("div",M$,[s("label",O$,[R[27]||(R[27]=oe(" Permission Mode ",-1)),v.value.permission_mode==="autofilled"?(u(),m("span",N$," âš¡ ")):M("",!0),v.value.permission_mode==="modified"?(u(),m("span",D$," âœï¸ ")):M("",!0)]),ne(s("select",{class:ee(["form-select",B.value]),id:"permission-mode","onUpdate:modelValue":R[8]||(R[8]=J=>p.value.permission_mode=J),title:E("permission_mode")},[...R[28]||(R[28]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,L$),[[Pe,p.value.permission_mode]]),R[29]||(R[29]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",I$,[s("label",P$,[R[30]||(R[30]=oe(" Allowed Tools (Optional) ",-1)),v.value.allowed_tools==="autofilled"?(u(),m("span",j$," âš¡ ")):M("",!0),v.value.allowed_tools==="modified"?(u(),m("span",R$," âœï¸ ")):M("",!0)]),ne(s("input",{type:"text",class:ee(["form-control",k.value]),id:"allowed-tools","onUpdate:modelValue":R[9]||(R[9]=J=>p.value.allowed_tools=J),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:E("allowed_tools")},null,10,W$),[[ue,p.value.allowed_tools]]),R[31]||(R[31]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",V$,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"sandboxEnabled","onUpdate:modelValue":R[10]||(R[10]=J=>p.value.sandbox_enabled=J)},null,512),[[ft,p.value.sandbox_enabled]]),R[34]||(R[34]=s("label",{class:"form-check-label",for:"sandboxEnabled"}," ðŸ”’ Enable Sandbox Mode ",-1)),p.value.sandbox_enabled?M("",!0):(u(),m("div",H$,[...R[32]||(R[32]=[s("small",null,"Sandbox mode restricts file system and network access for added security.",-1)])])),p.value.sandbox_enabled?(u(),m("div",F$,[...R[33]||(R[33]=[s("small",null,"ðŸ”’ Sandbox enabled: Minion will have OS-level isolation restricting file system and network access.",-1)])])):M("",!0)]),s("div",B$,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":R[11]||(R[11]=J=>p.value.startImmediately=J)},null,512),[[ft,p.value.startImmediately]]),R[35]||(R[35]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),d.value?(u(),m("div",U$,$(d.value),1)):M("",!0)],32)]),s("div",q$,[R[36]||(R[36]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",disabled:!p.value.name.trim()||_.value,onClick:Q},[_.value?(u(),m("span",K$)):M("",!0),oe(" "+$(_.value?"Creating...":"Create Minion"),1)],8,z$)])])])],512))}},Y$=te(G$,[["__scopeId","data-v-de94c977"]]),J$={class:"modal-dialog modal-dialog-centered modal-lg"},X$={class:"modal-content"},Q$={class:"modal-body"},Z$={key:0,class:"text-center text-muted py-4"},eE={key:1},tE={class:"mb-3"},sE={class:"mb-3"},oE={class:"font-monospace small"},nE={class:"mb-3"},iE={class:"mb-3"},aE={class:"mb-3"},lE={key:0},rE={class:"d-flex flex-wrap gap-1"},cE={key:1,class:"text-muted small"},uE={class:"mb-3"},dE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},mE={key:1,class:"text-muted small"},pE={class:"mb-3"},fE={key:0,class:"badge bg-info"},vE={key:1,class:"badge bg-secondary"},hE={class:"mb-3"},_E={key:0,class:"font-monospace small"},gE={key:1,class:"text-muted small"},bE={key:0,class:"mb-3"},yE={key:0},wE={class:"list-unstyled mb-0"},$E={key:1,class:"text-muted small"},EE={class:"mb-3"},CE={class:"small"},SE={class:"mb-3"},kE={class:"small"},TE={__name:"MinionViewModal",setup(o){const e=me(),t=L(null),n=L(null);let i=null;function a(h){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[h]||"bg-secondary"}function l(h){if(!h)return"N/A";try{const r=new Date(h);return isNaN(r.getTime())?"Invalid date":r.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(r){return console.error("Error formatting timestamp:",r),"Invalid date"}}function c(){t.value=null}function f(){c(),e.hideModal()}return le(()=>e.currentModal,h=>{if(h?.name==="minion-view"&&i){const r=h.data||{};t.value=r.session,i.show()}}),ve(()=>{n.value&&be(async()=>{const{default:h}=await import("./modal-BK1Vt_in.js").then(r=>r.m);return{default:h}},__vite__mapDeps([0,1])).then(({default:h})=>{i=new h(n.value),n.value.addEventListener("hidden.bs.modal",f)})}),_e(()=>{n.value&&n.value.removeEventListener("hidden.bs.modal",f),i&&i.dispose()}),(h,r)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:n},[s("div",J$,[s("div",X$,[r[11]||(r[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Q$,[t.value?(u(),m("div",eE,[s("div",tE,[r[0]||(r[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,$(t.value.name||"Unnamed Minion"),1)]),s("div",sE,[r[1]||(r[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",oE,$(t.value.session_id),1)]),s("div",nE,[r[2]||(r[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,$(t.value.role||"Not specified"),1)]),s("div",iE,[r[3]||(r[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:ee(["badge",a(t.value.state)])},$(t.value.state),3)])]),s("div",aE,[r[4]||(r[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(u(),m("div",lE,[s("div",rE,[(u(!0),m(re,null,ce(t.value.capabilities,y=>(u(),m("span",{key:y,class:"badge bg-secondary"},$(y),1))),128))])])):(u(),m("div",cE,"None"))]),s("div",uE,[r[5]||(r[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(u(),m("div",dE,$(t.value.initialization_context),1)):(u(),m("div",mE,"Not specified"))]),s("div",pE,[r[6]||(r[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(u(),m("span",fE,"Yes")):(u(),m("span",vE,"No"))])]),s("div",hE,[r[7]||(r[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(u(),m("div",_E,$(t.value.parent_overseer_id),1)):(u(),m("div",gE," Root overseer (user-created) "))]),t.value.is_overseer?(u(),m("div",bE,[r[8]||(r[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(u(),m("div",yE,[s("ul",wE,[(u(!0),m(re,null,ce(t.value.child_minion_ids,y=>(u(),m("li",{key:y,class:"font-monospace small"},$(y),1))),128))])])):(u(),m("div",$E,"No children"))])):M("",!0),s("div",EE,[r[9]||(r[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",CE,$(l(t.value.created_at)),1)]),s("div",SE,[r[10]||(r[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",kE,$(l(t.value.updated_at)),1)])])):(u(),m("div",Z$," No minion data available "))]),r[12]||(r[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},xE=te(TE,[["__scopeId","data-v-d996dc6f"]]),AE={class:"modal-dialog modal-lg"},ME={class:"modal-content"},OE={class:"modal-body"},NE={key:0,class:"template-list"},DE={key:0,class:"alert alert-info"},LE={class:"card-body"},IE={class:"d-flex justify-content-between align-items-start"},PE={class:"flex-grow-1"},jE={class:"card-title mb-1"},RE={class:"card-text text-muted small mb-2"},WE={class:"template-meta"},VE={class:"badge bg-secondary me-2"},HE={class:"text-muted small"},FE={class:"btn-group btn-group-sm ms-3"},BE=["onClick"],UE=["onClick"],qE={key:1,class:"template-form"},zE={class:"mb-3"},KE={class:"mb-3"},GE={class:"mb-3"},YE={class:"mb-3"},JE={class:"mb-3"},XE={class:"mb-3"},QE={class:"mb-3"},ZE={key:0,class:"alert alert-danger"},eC={class:"d-flex gap-2"},tC=["disabled"],sC={key:0,class:"spinner-border spinner-border-sm me-2"},oC={__name:"TemplateManagementModal",setup(o){const e=me(),t=L(null);let n=null;const i=L([]),a=L(null),l=L(""),c=L(""),f=L(!1);async function h(){try{const d=await ie.get("/api/templates");i.value=d||[]}catch(d){console.error("Failed to load templates:",d),i.value=[]}}function r(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},l.value="",c.value=""}function y(d){a.value={...d},l.value=d.allowed_tools?.join(", ")||"",c.value=""}async function v(){if(!a.value.name.trim()){c.value="Template name is required";return}f.value=!0,c.value="";try{const d=l.value.split(",").map(S=>S.trim()).filter(S=>S.length>0),_={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:d.length>0?d:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await ie.post("/api/templates",_):await ie.put(`/api/templates/${a.value.template_id}`,_),await h(),a.value=null,l.value=""}catch(d){console.error("Failed to save template:",d),c.value=d.response?.data?.detail||"Failed to save template"}finally{f.value=!1}}async function p(d){if(confirm(`Delete template "${d.name}"?

This action cannot be undone.`))try{await ie.delete(`/api/templates/${d.template_id}`),await h()}catch(_){console.error("Failed to delete template:",_),alert(`Failed to delete template: ${_.response?.data?.detail||_.message}`)}}function b(){a.value=null,l.value="",c.value=""}function w(){a.value=null,l.value="",c.value="",e.hideModal()}return le(()=>e.currentModal,d=>{d?.name==="template-management"&&n&&(h(),n.show())}),ve(()=>{t.value&&be(()=>import("./modal-BK1Vt_in.js").then(d=>d.m),__vite__mapDeps([0,1])).then(d=>{const _=d.default;n=new _(t.value),t.value.addEventListener("hidden.bs.modal",w)})}),_e(()=>{t.value&&t.value.removeEventListener("hidden.bs.modal",w),n&&n.dispose()}),(d,_)=>(u(),m("div",{ref_key:"modalElement",ref:t,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[s("div",AE,[s("div",ME,[_[15]||(_[15]=s("div",{class:"modal-header"},[s("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",OE,[a.value?M("",!0):(u(),m("div",NE,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[_[6]||(_[6]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:r,class:"btn btn-primary btn-sm"}," âž• Create New ")]),i.value.length===0?(u(),m("div",DE," No templates found. Create your first template! ")):M("",!0),(u(!0),m(re,null,ce(i.value,C=>(u(),m("div",{key:C.template_id,class:"card mb-2"},[s("div",LE,[s("div",IE,[s("div",PE,[s("h6",jE,$(C.name),1),s("p",RE,$(C.description),1),s("div",WE,[s("span",VE,$(C.permission_mode),1),s("span",HE,$(C.allowed_tools?.length||0)+" tools",1)])]),s("div",FE,[s("button",{onClick:S=>y(C),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,BE),s("button",{onClick:S=>p(C),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,UE)])])])]))),128))])),a.value?(u(),m("div",qE,[s("h6",zE,$(a.value.template_id?"Edit Template":"Create Template"),1),s("div",KE,[_[7]||(_[7]=s("label",{for:"template-name",class:"form-label"},[oe(" Name "),s("span",{class:"text-danger"},"*")],-1)),ne(s("input",{id:"template-name","onUpdate:modelValue":_[0]||(_[0]=C=>a.value.name=C),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[ue,a.value.name]])]),s("div",GE,[_[8]||(_[8]=s("label",{for:"template-description",class:"form-label"},"Description",-1)),ne(s("textarea",{id:"template-description","onUpdate:modelValue":_[1]||(_[1]=C=>a.value.description=C),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[ue,a.value.description]])]),s("div",YE,[_[10]||(_[10]=s("label",{for:"template-permission-mode",class:"form-label"},[oe(" Permission Mode "),s("span",{class:"text-danger"},"*")],-1)),ne(s("select",{id:"template-permission-mode","onUpdate:modelValue":_[2]||(_[2]=C=>a.value.permission_mode=C),class:"form-select",required:""},[..._[9]||(_[9]=[s("option",{value:"default"},"Default",-1),s("option",{value:"acceptEdits"},"Accept Edits",-1),s("option",{value:"plan"},"Plan Mode",-1),s("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Pe,a.value.permission_mode]])]),s("div",JE,[_[11]||(_[11]=s("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),ne(s("input",{id:"template-tools","onUpdate:modelValue":_[3]||(_[3]=C=>l.value=C),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[ue,l.value]]),_[12]||(_[12]=s("div",{class:"form-text"},"Comma-separated list of tools",-1))]),s("div",XE,[_[13]||(_[13]=s("label",{for:"template-role",class:"form-label"},"Default Role",-1)),ne(s("input",{id:"template-role","onUpdate:modelValue":_[4]||(_[4]=C=>a.value.default_role=C),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[ue,a.value.default_role]])]),s("div",QE,[_[14]||(_[14]=s("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),ne(s("textarea",{id:"template-prompt","onUpdate:modelValue":_[5]||(_[5]=C=>a.value.default_system_prompt=C),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[ue,a.value.default_system_prompt]])]),c.value?(u(),m("div",ZE,$(c.value),1)):M("",!0),s("div",eC,[s("button",{onClick:v,class:"btn btn-primary",disabled:f.value},[f.value?(u(),m("span",sC)):M("",!0),oe(" "+$(f.value?"Saving...":"Save Template"),1)],8,tC),s("button",{onClick:b,class:"btn btn-secondary"},"Cancel")])])):M("",!0)])])])],512))}},nC=te(oC,[["__scopeId","data-v-81126ff4"]]),iC={class:"container-fluid vh-100 d-flex flex-column p-0"},aC={class:"d-flex flex-grow-1 overflow-hidden position-relative"},lC={class:"flex-grow-1 d-flex flex-column overflow-hidden"},rC={__name:"App",setup(o){const e=me(),t=ze(),n=ae(),i=ke(),a=Ct(),l=g(()=>e.sidebarCollapsed),c=g(()=>e.isMobile);ve(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),n.fetchSessions()]);const r=window.location.hash;if(r.startsWith("#/session/")){const y=r.replace("#/session/","");n.sessions.has(y)&&await n.selectSession(y)}else if(r.startsWith("#/timeline/")){const y=r.replace("#/timeline/","");a.push(`/timeline/${y}`)}window.addEventListener("popstate",f),window.addEventListener("resize",e.handleResize)}),_e(()=>{window.removeEventListener("popstate",f),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function f(){const r=window.location.hash;if(r.startsWith("#/session/")){const y=r.replace("#/session/","");n.sessions.has(y)&&n.selectSession(y)}}function h(){e.toggleSidebar()}return(r,y)=>{const v=sn("router-view");return u(),m("div",iC,[de(Db),s("div",{id:"sidebar-backdrop",class:ee({show:!l.value&&c.value}),onClick:h},null,2),s("div",aC,[de(cy),s("main",lC,[de(v)])]),de(ky),de(Fy),de(u1),de(L1),de(rw),de(Dw),de(o$),de(Y$),de(xE),de(nC)])}}},no=vi(rC);no.use(hi());no.use(Cb);no.mount("#app");
