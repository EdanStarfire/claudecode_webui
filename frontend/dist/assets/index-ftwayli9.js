const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as i,d as Qe,r as L,b as k,n as Fe,e as Pe,f as H,g as ue,t as x,u as W,w as fe,h as ps,F as ee,i as le,j as M,k as Xa,l as ae,m as Le,p as he,q as $e,v as De,s as Ee,x as No,y as _n,z as Me,A as Po,B as Oe,C as Cs,D as gn,E as ls,G as Ya,H as Qa,I as bn,T as Ja,J as jo,K as Ro,L as ct,M as tt,N as Fs,O as jn,P as Za,Q as ei}from"./vue-vendor-05ziUB1P.js";import{m as Ye,p as qt}from"./markdown-vendor-BRsjnVvP.js";import{c as ti,g as si}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(l){if(l.ep)return;l.ep=!0;const c=s(l);fetch(l.href,c)}})();const ni={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},oi={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),r("div",ni,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},ai="modulepreload",ii=function(n){return"/"+n},Rn={},Ie=function(e,s,a){let l=Promise.resolve();if(s&&s.length>0){let u=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=d?.nonce||d?.getAttribute("nonce");l=u(s.map(f=>{if(f=ii(f),f in Rn)return;Rn[f]=!0;const h=f.endsWith(".css"),S=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${S}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":ai,h||(m.as="script"),m.crossOrigin="",m.href=f,g&&m.setAttribute("nonce",g),document.head.appendChild(m),h)return new Promise((p,w)=>{m.addEventListener("load",p),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function c(d){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=d,window.dispatchEvent(g),!g.defaultPrevented)throw d}return l.then(d=>{for(const g of d||[])g.status==="rejected"&&c(g.reason);return e().catch(c)})};class Vs extends Error{constructor(e,s,a){super(e),this.name="APIError",this.status=s,this.data=a}}async function Rt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let l;try{l=await s.json()}catch{l={detail:s.statusText}}throw new Vs(l.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,l)}const a=s.headers.get("content-type");return a&&a.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Vs?s:(console.error("API request failed:",s),new Vs(`Network error: ${s.message}`,0,null))}}async function os(n,e={}){let s=n;if(e.params){const a=new URLSearchParams;for(const[g,u]of Object.entries(e.params))u!=null&&a.append(g,u);const l=a.toString();l&&(s=`${n}?${l}`);const{params:c,...d}=e;return Rt(s,{...d,method:"GET"})}return Rt(s,{...e,method:"GET"})}async function Bo(n,e,s={}){return Rt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function li(n,e,s={}){return Rt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Fo(n,e={}){return Rt(n,{...e,method:"DELETE"})}async function ri(n,e,s={}){return Rt(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function ci(){return os("/api/system/git-status")}async function ui(){return Bo("/api/system/restart")}const ve={get:os,post:Bo,put:li,delete:Fo,patch:ri},Vo="webui-sidebar-";function Jt(n,e){try{const s=localStorage.getItem(Vo+n);return s!==null?JSON.parse(s):e}catch{return e}}function Mt(n,e){try{localStorage.setItem(Vo+n,JSON.stringify(e))}catch{}}const Ce=Qe("ui",()=>{const n=L(Jt("rightCollapsed",!0)),e=L(Jt("rightWidth",300)),s=L(Jt("activeTab","diff")),a=L(window.innerWidth>=768?Jt("rightVisible",!0):!1),l=L(null),c=L(new Set),d=L(window.innerWidth),g=k(()=>d.value<768),u=L(!0),f=L(!1),h=L(null),S=L(null),m=k(()=>h.value?{name:h.value,data:S.value}:null),p=L(!1),w=L("Loading..."),b=L(!1),v=L("idle"),_=L(!1);function o(){n.value=!n.value,Mt("rightCollapsed",n.value)}function y(K){n.value=K,Mt("rightCollapsed",K)}function $(K){e.value=Math.max(200,Math.min(K,window.innerWidth*.3)),Mt("rightWidth",e.value)}function E(K){s.value=K,Mt("activeTab",K)}function D(K){u.value=K}function T(K){_.value=K}function O(){const K=localStorage.getItem("webui-background-color");f.value=K==="red"}function C(){f.value=!f.value,localStorage.setItem("webui-background-color",f.value?"red":"gray")}function A(K,pe=null){h.value=null,S.value=null,setTimeout(()=>{h.value=K,S.value=pe},0)}function N(){h.value=null,S.value=null}function P(K="Loading..."){p.value=!0,w.value=K}function F(){p.value=!1}function V(){A("restart-server")}function X(K){l.value=K}function j(K){c.value.has(K)?c.value.delete(K):c.value.add(K),c.value=new Set(c.value)}function I(){c.value.size>0&&(c.value=new Set)}function G(){a.value=!a.value,Mt("rightVisible",a.value)}function q(K){a.value=K,Mt("rightVisible",K)}function Z(){const K=d.value;d.value=window.innerWidth,d.value>=768&&K<768?a.value=Jt("rightVisible",!0):d.value<768&&K>=768&&(a.value=!1)}return{rightSidebarCollapsed:n,rightSidebarWidth:e,rightSidebarActiveTab:s,rightPanelVisible:a,browsingProjectId:l,expandedStacks:c,windowWidth:d,isMobile:g,autoScrollEnabled:u,isRedBackground:f,activeModal:h,modalData:S,currentModal:m,isLoading:p,loadingMessage:w,restartInProgress:b,restartStatus:v,suppressAutoShow:_,toggleRightSidebar:o,setRightSidebarCollapsed:y,setRightSidebarWidth:$,setRightSidebarTab:E,setBrowsingProject:X,toggleStack:j,collapseAllStacks:I,toggleRightPanel:G,setRightPanelVisible:q,setAutoScroll:D,setSuppressAutoShow:T,initBackgroundColor:O,toggleBackgroundColor:C,showModal:A,hideModal:N,showLoading:P,hideLoading:F,showRestartModal:V,handleResize:Z}}),_e=Qe("session",()=>{const n=L(new Map),e=L(null),s=L(new Map),a=L(new Map),l=L(new Set),c=L(!1);let d=null;const g=k(()=>n.value.get(e.value)),u=k(()=>Array.from(n.value.values()).sort((T,O)=>T.order-O.order)),f=T=>k(()=>u.value.filter(O=>O.project_id===T)),h=k({get:()=>s.value.get(e.value)||"",set:T=>{e.value&&s.value.set(e.value,T)}});async function S(){try{const T=await ve.get("/api/sessions");return n.value.clear(),T.sessions.forEach(O=>{n.value.set(O.session_id,O)}),console.log(`Loaded ${n.value.size} sessions`),T.sessions}catch(T){throw console.error("Failed to fetch sessions:",T),T}}async function m(T,O){try{const A=(await ve.post("/api/sessions",{project_id:T,...O})).session_id,P=(await ve.get(`/api/sessions/${A}`)).session;return n.value.set(A,P),n.value=new Map(n.value),console.log(`Created session ${A}`),P}catch(C){throw console.error("Failed to create session:",C),C}}async function p(T){if(e.value===T&&!c.value)return;d&&(console.log(`Aborting pending selection to switch to ${T}`),d.abort(),d=null);const O=new AbortController;d=O,c.value=!0;const C=Ce();C.setSuppressAutoShow(!0);try{if(e.value=T,O.signal.aborted){console.log(`Selection of ${T} aborted early`);return}let A=n.value.get(T);if(!A)try{const V=await ve.get(`/api/sessions/${T}`);if(O.signal.aborted){console.log(`Selection of ${T} aborted after fetch`);return}A=V.session,n.value.set(T,A),n.value=new Map(n.value),console.log(`Fetched session ${T} for deeplink`)}catch(V){console.error(`Failed to fetch session ${T}:`,V);return}if(A&&(A.state==="created"||A.state==="terminated"))try{if(await o(T),O.signal.aborted){console.log(`Selection of ${T} aborted after start`);return}console.log(`Auto-started session ${T} (was in ${A.state} state)`);const V=6e4,X=200,j=5e3;let I=0,G=0;for(;I<V;){if(O.signal.aborted){console.log(`Selection of ${T} aborted during state wait`);return}const Z=n.value.get(T);if(Z&&Z.state==="active"){console.log(`Session ${T} is now active after ${I}ms`);break}if(Z&&Z.state==="error"){console.log(`Session ${T} entered error state after ${I}ms, stopping wait`);break}if(I-G>=j){const K=n.value.get(T)?.state||"unknown";console.log(`Waiting for session ${T} to become active (current: ${K}, ${I/1e3}s elapsed)`),G=I}await new Promise(K=>setTimeout(K,X)),I+=X}const q=n.value.get(T);q&&q.state!=="active"&&console.warn(`Session ${T} did not become active within ${V/1e3}s (state: ${q.state}), continuing anyway`)}catch(V){console.error(`Failed to auto-start session ${T}:`,V)}if(O.signal.aborted){console.log(`Selection of ${T} aborted before message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>Si),void 0)).useMessageStore().loadMessages(T),O.signal.aborted){console.log(`Selection of ${T} aborted after message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>pm),void 0)).useResourceStore().loadResources(T),O.signal.aborted){console.log(`Selection of ${T} aborted after resource load`);return}await(await Ie(()=>Promise.resolve().then(()=>vm),void 0)).useWebSocketStore().connectSession(T),O.signal.aborted||console.log(`Selected session ${T}`)}finally{d===O&&(d=null),c.value=!1,Fe(()=>C.setSuppressAutoShow(!1))}}function w(T,O){const C=n.value.get(T);C?Object.assign(C,O):(n.value.set(T,O),console.log(`Added new session ${T} via WebSocket update`)),n.value=new Map(n.value)}async function b(T){l.value.add(T);try{const C=(await ve.delete(`/api/sessions/${T}`)).deleted_session_ids||[T];for(const A of C)n.value.delete(A),s.value.delete(A),a.value.delete(A);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(O){throw console.error("Failed to delete session:",O),O}finally{l.value.delete(T)}}async function v(T,O){try{await ve.patch(`/api/sessions/${T}`,O),w(T,O),console.log(`Updated session ${T}:`,O)}catch(C){throw console.error("Failed to update session:",C),C}}async function _(T,O){try{await ve.post(`/api/sessions/${T}/permission-mode`,{mode:O}),w(T,{current_permission_mode:O});const C=a.value.get(T);C&&(C.permissionMode=O,a.value.set(T,C)),console.log(`Set permission mode for session ${T} to ${O}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function o(T){try{await ve.post(`/api/sessions/${T}/start`),console.log(`Started session ${T}`)}catch(O){throw console.error("Failed to start session:",O),O}}async function y(T){try{await ve.post(`/api/sessions/${T}/pause`),console.log(`Paused session ${T}`)}catch(O){throw console.error("Failed to pause session:",O),O}}async function $(T){try{await ve.post(`/api/sessions/${T}/terminate`),console.log(`Terminated session ${T}`)}catch(O){throw console.error("Failed to terminate session:",O),O}}function E(T){return n.value.get(T)}function D(T,O){a.value.set(T,O),O.permissionMode&&w(T,{current_permission_mode:O.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:a,deletingSessions:l,currentSession:g,orderedSessions:u,sessionsInProject:f,currentInput:h,fetchSessions:S,createSession:m,selectSession:p,updateSession:w,deleteSession:b,patchSession:v,setPermissionMode:_,startSession:o,pauseSession:y,terminateSession:$,getSession:E,storeInitData:D}}),Bn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:_e},Symbol.toStringTag,{value:"Module"})),te=(n,e)=>{const s=n.__vccOpts||n;for(const[a,l]of e)s[a]=l;return s},di={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},fi=["title"],mi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},pi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),a=k(()=>s.sessions.get(e.sessionId)),l=k(()=>a.value?a.value.state==="paused"&&a.value.is_processing?"pending-prompt":a.value.is_processing?"processing":a.value.state:"unknown"),c=k(()=>{const u=l.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[u]||"#d3d3d3"}),d=k(()=>{const u=l.value;return u==="starting"||u==="processing"||u==="pending-prompt"}),g=k(()=>{if(!a.value)return"No session selected";const u=l.value,f=u.charAt(0).toUpperCase()+u.slice(1).replace("-"," "),h=a.value.name||"Unnamed Session",S=a.value.role?` (${a.value.role})`:"";return`${h}${S}: ${f}`});return(u,f)=>(i(),r("div",di,[a.value?(i(),r("div",{key:0,class:H(["progress-bar",{"progress-bar-striped progress-bar-animated":d.value}]),style:Pe({width:"100%",backgroundColor:c.value}),title:g.value},null,14,fi)):(i(),r("div",mi))]))}},vi=te(pi,[["__scopeId","data-v-63d222fe"]]),hi={class:"d-flex justify-content-between align-items-center gap-2"},_i={class:"d-flex gap-2"},gi=["disabled"],bi={class:"mode-label"},yi=["disabled"],wi=["disabled"],ki={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),a=Ce(),l=k(()=>s.sessions.get(e.sessionId)),c=k(()=>l.value?.current_permission_mode||"default"),d={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},g=k(()=>d[c.value]||"ðŸ”’"),u=k(()=>c.value),f=["default","acceptEdits","plan"],h=async()=>{if(!l.value)return;if(c.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(_){console.error("Failed to cycle permission mode:",_)}return}const b=(f.indexOf(c.value)+1)%f.length,v=f[b];try{await s.setPermissionMode(e.sessionId,v)}catch(_){console.error("Failed to cycle permission mode:",_)}},S=()=>{a.showModal("session-info",{sessionId:e.sessionId})},m=()=>{a.showModal("manage-session",{session:l.value})},p=()=>{a.setAutoScroll(!a.autoScrollEnabled)};return(w,b)=>(i(),r("div",{class:H(["session-status-bar border-top p-2",W(a).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",hi,[t("div",_i,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!l.value},[ue(x(g.value)+" ",1),t("span",bi,x(u.value),1)],8,gi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:S,disabled:!l.value},[...b[0]||(b[0]=[ue(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,yi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:m,disabled:!l.value},[...b[1]||(b[1]=[ue(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,wi)]),t("div",null,[t("button",{class:H(["btn btn-sm",W(a).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:p}," â¬‡ï¸ "+x(W(a).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},$i=te(ki,[["__scopeId","data-v-ed9a4d3c"]]),as=Qe("task",()=>{const n=L(new Map),e=L(new Set);function s(o){const y=n.value.get(o);return y?Array.from(y.values()).filter($=>$.status!=="deleted").sort(($,E)=>{const D=parseInt($.id.replace(/\D/g,""))||0,T=parseInt(E.id.replace(/\D/g,""))||0;return D-T}):[]}function a(o){return s(o).find($=>$.status==="in_progress")||null}function l(o){const y=s(o);return{total:y.length,completed:y.filter($=>$.status==="completed").length,inProgress:y.filter($=>$.status==="in_progress").length,pending:y.filter($=>$.status==="pending").length}}function c(o){return e.value.has(o)}const d=k(()=>{const o=_e();return s(o.currentSessionId)}),g=k(()=>{const o=_e();return a(o.currentSessionId)}),u=k(()=>{const o=_e();return l(o.currentSessionId)}),f=k(()=>{const o=_e();return c(o.currentSessionId)});function h(o,y){n.value.has(o)||n.value.set(o,new Map),n.value.get(o).set(y.id,{id:y.id,subject:y.subject||"",description:y.description||"",status:y.status||"pending",activeForm:y.activeForm||null,owner:y.owner||null,blocks:y.blocks||[],blockedBy:y.blockedBy||[],metadata:y.metadata||{}}),e.value.add(o),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${y.id} for session ${o}`)}function S(o,y,$){const E=n.value.get(o);if(!E){console.warn(`No tasks found for session ${o}`);return}const D=E.get(y);if(!D){if($.status==="deleted")return;h(o,{id:y,...$});return}$.subject!==void 0&&(D.subject=$.subject),$.description!==void 0&&(D.description=$.description),$.status!==void 0&&(D.status=$.status),$.activeForm!==void 0&&(D.activeForm=$.activeForm),$.owner!==void 0&&(D.owner=$.owner),$.metadata!==void 0&&(D.metadata={...D.metadata,...$.metadata}),$.addBlocks&&(D.blocks=[...new Set([...D.blocks,...$.addBlocks])]),$.addBlockedBy&&(D.blockedBy=[...new Set([...D.blockedBy,...$.addBlockedBy])]),$.status==="deleted"&&(E.delete(y),E.size===0&&(e.value.delete(o),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${y} for session ${o}`,$)}function m(o,y){return n.value.get(o)?.get(y)||null}function p(o){n.value.delete(o),e.value.delete(o),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${o}`)}function w(o,y){n.value.has(o)&&n.value.get(o).clear(),e.value.delete(o);const $=new Map;for(const E of y){if(E.metadata?.tool_uses)for(const D of E.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(D.name)&&$.set(D.id,{name:D.name,input:D.input});if(E.metadata?.tool_results)for(const D of E.metadata.tool_results){const T=$.get(D.tool_use_id);T&&(b(o,T.name,T.input,{error:D.is_error,content:D.content}),$.delete(D.tool_use_id))}}console.log(`Reconstructed ${n.value.get(o)?.size||0} tasks for session ${o}`)}function b(o,y,$,E){if(E?.error){console.log(`Skipping task update - tool ${y} returned error`);return}const D=v(E);if(D)switch(y){case"TaskCreate":{const T=_(D)||$?.id;T&&h(o,{id:T,subject:$?.subject||"",description:$?.description||"",status:"pending",activeForm:$?.activeForm||null,owner:$?.owner||null,blocks:[],blockedBy:[],metadata:$?.metadata||{}});break}case"TaskUpdate":{const T=$?.taskId;T&&S(o,T,{status:$?.status,subject:$?.subject,description:$?.description,activeForm:$?.activeForm,owner:$?.owner,metadata:$?.metadata,addBlocks:$?.addBlocks,addBlockedBy:$?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{$?.taskId;break}}}function v(o){return o?typeof o=="string"?o:o.content?typeof o.content=="string"?o.content:JSON.stringify(o.content):o.message?o.message:JSON.stringify(o):null}function _(o){if(!o)return null;const y=o.match(/[Tt]ask\s*#(\d+)/i);if(y)return y[1];const $=o.match(/#(\d+)/);return $?$[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:d,currentActiveTask:g,currentTaskStats:u,currentHasTasks:f,tasksForSession:s,activeTask:a,taskStats:l,hasTasks:c,getTask:m,createTask:h,updateTask:S,clearTasks:p,reconstructFromMessages:w,handleTaskToolResult:b}}),Ne=Qe("message",()=>{const n=L(new Map),e=L(new Map),s=L(new Map),a=L(new Map),l=L(new Map),c=L(new Map),d=L(new Map),g=L(new Map),u=L(new Map),f=k(()=>{const j=_e();return n.value.get(j.currentSessionId)||[]}),h=k(()=>{const j=_e();return e.value.get(j.currentSessionId)||[]});async function S(j,I=null,G=0){try{const q=I||1e4,Z=await ve.get(`/api/sessions/${j}/messages?limit=${q}&offset=${G}`),K=Z.messages||[],pe=Z.total_count||K.length,re=Z.has_more||!1;console.log(`Loaded ${K.length} of ${pe} messages for session ${j}`);const ge=[];if(K.forEach(be=>{if(be.type==="tool_call"){o(j,be);return}if(be.type==="system"&&be.metadata?.subtype==="client_launched"&&be.timestamp){const z=typeof be.timestamp=="number"?be.timestamp:new Date(be.timestamp).getTime()/1e3;g.value.set(j,z)}be.type==="system"&&(be.subtype==="init"||be.metadata?.subtype==="init")&&be.metadata?.init_data&&_e().storeInitData(j,be.metadata.init_data),ge.push(be)}),n.value.set(j,ge),ge.length>0){const be=ge[ge.length-1];be.timestamp&&d.value.set(j,be.timestamp)}n.value=new Map(n.value);try{as().reconstructFromMessages(j,ge)}catch(be){console.warn("Failed to reconstruct task state:",be)}return re&&console.warn(`Warning: Only loaded ${ge.length} of ${pe} messages. Some messages may be missing.`),{messages:ge,totalCount:pe,hasMore:re}}catch(q){throw console.error("Failed to load messages:",q),q}}function m(j,I){const G=l.value.get(j)||new Set;if(I.type==="assistant"&&I.metadata?.tool_uses&&I.metadata.tool_uses.forEach(q=>{G.add(q.id)}),I.type==="user"&&I.metadata?.tool_results&&I.metadata.tool_results.forEach(q=>{G.delete(q.tool_use_id);const Z=c.value.get(j);Z&&Z.delete(q.tool_use_id)}),I.type==="system"&&I.metadata?.subtype==="client_launched"&&(G.forEach(q=>{O(j,q,"Session was restarted")}),G.clear(),I.timestamp)){const q=typeof I.timestamp=="number"?I.timestamp:new Date(I.timestamp).getTime()/1e3;g.value.set(j,q)}I.type==="system"&&I.metadata?.subtype==="interrupt"&&(G.forEach(q=>{O(j,q,"Session was interrupted")}),G.clear()),l.value.set(j,G)}function p(j,I){n.value.has(j)||n.value.set(j,[]);const G=n.value.get(j);if(I.id){const q=G.findIndex(Z=>Z.id===I.id);if(q!==-1){console.log(`Skipping duplicate message ${I.id} (already exists at index ${q})`);return}}G.push(I),I.timestamp&&d.value.set(j,I.timestamp),E(j,I),m(j,I),n.value=new Map(n.value)}function w(j,I){e.value.has(j)||e.value.set(j,[]),e.value.get(j).push(I),e.value=new Map(e.value)}function b(j,I,G){const q=e.value.get(j);if(q){const Z=q.find(K=>K.id===I);Z&&(Object.assign(Z,G),e.value=new Map(e.value))}}function v(j,I){console.log("handlePermissionRequest received:",I);const G=I.metadata?.tool_name||I.tool_name,q=I.metadata?.input_params||I.input_params,Z=I.metadata?.request_id||I.request_id,K=I.metadata?.suggestions||I.suggestions||[];console.log("Extracted data:",{toolName:G,inputParams:q,requestId:Z,suggestions:K});const pe=$(G,q),re=s.value.get(j)?.get(pe);re?(a.value.set(Z,re),b(j,re,{status:"permission_required",permissionRequestId:Z,suggestions:K}),console.log(`Permission required for tool ${re}`,{suggestions:K})):console.warn("No tool use ID found for permission request signature:",pe,{toolName:G,inputParams:q,availableSignatures:Array.from(s.value.keys())})}function _(j,I){const G=a.value.get(I.request_id);if(G){const q={permissionDecision:I.decision,appliedUpdates:I.applied_updates||[]};I.decision==="allow"?(q.status="executing",q.backendStatus="running"):(q.status="completed",q.backendStatus="denied",q.result={error:!0,message:I.reasoning||"Permission denied"},q.isExpanded=!1),I.updated_input&&(q.input=I.updated_input),b(j,G,q),console.log(`Permission ${I.decision} for tool ${G}`)}}function o(j,I){console.log("handleToolCall received:",I);const G=I.tool_use_id;if(!G){console.warn("Received tool_call without tool_use_id:",I);return}e.value.has(j)||e.value.set(j,[]);const q=e.value.get(j),Z=q.findIndex(re=>re.id===G),pe={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[I.status]||I.status;if(Z!==-1){const re=q[Z],ge=["completed","error"],be=["pending","executing","permission_required"];if(ge.includes(re.status)&&be.includes(pe)){console.warn(`Ignoring status regression for tool ${G}: ${re.status} â†’ ${pe}`);return}re.status=pe,re.backendStatus=I.status,I.permission&&(re.suggestions=I.permission.suggestions||[],re.permissionRequestId=I.request_id),I.request_id&&I.status==="awaiting_permission"&&a.value.set(I.request_id,G),I.permission_granted!==null&&I.permission_granted!==void 0&&(re.permissionDecision=I.permission_granted?"allow":"deny"),I.applied_updates&&I.applied_updates.length>0&&(re.appliedUpdates=I.applied_updates),I.result!==void 0&&(re.result={error:I.status==="failed",content:I.result}),I.error&&(re.result={error:!0,content:I.error}),I.status==="denied"&&(re.result={error:!0,message:"Permission denied"},re.isExpanded=!1),I.status==="interrupted"&&(O(j,G,"Session was interrupted"),re.isExpanded=!1),(I.status==="completed"||I.status==="failed")&&(re.isExpanded=!1),I.display&&(re.backendState=I.display),console.log(`Updated tool call ${G} to status: ${pe} (backend: ${I.status})`)}else{const re=$(I.name,I.input);s.value.has(j)||s.value.set(j,new Map),s.value.get(j).set(re,G);const ge={id:G,name:I.name,input:I.input,signature:re,status:pe,backendStatus:I.status,permissionRequestId:I.request_id,permissionDecision:I.permission_granted!=null?I.permission_granted?"allow":"deny":null,appliedUpdates:I.applied_updates||[],suggestions:I.permission?.suggestions||[],result:I.result?{error:I.status==="failed",content:I.result}:null,explanation:null,timestamp:I.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(I.status),backendState:I.display};I.error&&(ge.result={error:!0,content:I.error}),q.push(ge),I.request_id&&I.status==="awaiting_permission"&&a.value.set(I.request_id,G),console.log(`Created new tool call ${G} for ${I.name} with status: ${pe}`)}if(e.value=new Map(e.value),["completed","failed"].includes(I.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name))try{as().handleTaskToolResult(j,I.name,I.input,{error:I.status==="failed",content:I.result})}catch(re){console.warn("Failed to update task store:",re)}}function y(j,I){const G=e.value.get(j);if(G){const q=G.find(Z=>Z.id===I);q&&(q.isExpanded=!q.isExpanded,e.value=new Map(e.value))}}function $(j,I){if(!j)return"unknown:{}";if(!I||typeof I!="object")return`${j}:{}`;const G=JSON.stringify(I,Object.keys(I).sort());return`${j}:${G}`}function E(j,I){const G=I.metadata?.display||I.display;if(!G)return;u.value.has(j)||u.value.set(j,new Map);const q=u.value.get(j);if(G.tool_states)for(const[Z,K]of Object.entries(G.tool_states)){q.set(Z,K);const pe=e.value.get(j);if(pe){const re=pe.find(ge=>ge.id===Z);if(re){const ge={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};re.status=ge[K.state]||K.state,re.backendState=K}}}if(G.orphaned_tools&&G.orphaned_tools.length>0){const Z=c.value.get(j)||new Map;for(const K of G.orphaned_tools)Z.has(K)||Z.set(K,{reason:"denied",message:"Session was interrupted"});c.value.set(j,Z)}if(G.linked_permissions)for(const[Z,K]of Object.entries(G.linked_permissions))a.value.set(Z,K);G.tool_states&&Object.keys(G.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${j}:`,{toolStates:Object.keys(G.tool_states||{}).length,orphanedTools:(G.orphaned_tools||[]).length,linkedPermissions:Object.keys(G.linked_permissions||{}).length})}function D(j,I){return u.value.get(j)?.get(I)}function T(j){const I=u.value.get(j);return I&&I.size>0}function O(j,I,G){const q={reason:"denied",message:G},Z=c.value.get(j)||new Map;Z.set(I,q),c.value.set(j,Z);const K=e.value.get(j);if(K){const pe=K.find(re=>re.id===I);pe&&(pe._isOrphaned=!0,pe._orphanedInfo=q,pe.isExpanded=!1)}e.value=new Map(e.value),console.log(`Marked tool use ${I} as orphaned: ${G}`)}function C(j,I){const G=D(j,I);return G&&G.state==="orphaned"?!0:c.value.get(j)?.has(I)||!1}function A(j,I){const G=D(j,I);return G&&G.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:G}:c.value.get(j)?.get(I)}function N(j,I){const G=l.value.get(j);G&&G.size>0&&(G.forEach(q=>O(j,q,I)),G.clear())}function P(j){n.value.delete(j),e.value.delete(j),s.value.delete(j),d.value.delete(j),n.value=new Map(n.value),e.value=new Map(e.value)}function F(j){return d.value.get(j)}async function V(j){const I=d.value.get(j);if(!I)return console.log(`No sync needed for session ${j} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${j} since ${I}`);const G=await ve.get(`/api/sessions/${j}/messages?limit=1000&offset=0`),q=G.messages||[],Z=G.has_more||!1,K=Y=>Y?typeof Y=="number"?Y*1e3:new Date(Y).getTime():0,pe=K(I),re=q.filter(Y=>Y.timestamp?K(Y.timestamp)>pe:!1);if(re.length===0)return console.log(`No missed messages for session ${j}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${re.length} missed messages for session ${j}`);const ge=n.value.get(j)||[],be=new Set(ge.map(Y=>Y.id).filter(Boolean)),z=re.filter(Y=>!Y.id||!be.has(Y.id));console.log(`After deduplication: ${z.length} unique new messages`);const R=[],U=[];if(z.forEach(Y=>{Y.type==="tool_call"?R.push(Y):U.push(Y)}),R.forEach(Y=>{o(j,Y)}),U.length>0){const Y=U.sort((J,de)=>{const ye=K(J.timestamp),we=K(de.timestamp);return ye-we}),oe=n.value.get(j)||[],Se=oe.length>0?K(oe[oe.length-1].timestamp):0;if(K(Y[0].timestamp)>Se){const J=[...oe,...Y];n.value.set(j,J)}else{const J=[...oe,...Y].sort((de,ye)=>{const we=K(de.timestamp),Ae=K(ye.timestamp);return we-Ae});n.value.set(j,J)}}U.forEach(Y=>{m(j,Y),Y.type==="system"&&(Y.subtype==="init"||Y.metadata?.subtype==="init")&&Y.metadata?.init_data&&_e().storeInitData(j,Y.metadata.init_data)});const se=n.value.get(j);if(se&&se.length>0){const Y=se[se.length-1];Y.timestamp&&d.value.set(j,Y.timestamp)}return n.value=new Map(n.value),{syncedCount:z.length,hasMore:Z}}catch(G){return console.error(`Failed to sync messages for session ${j}:`,G),{syncedCount:0,hasMore:!1,error:G.message}}}const X=_e();return fe(()=>Array.from(X.sessions.values()).map(I=>({id:I.session_id,state:I.state})),(j,I)=>{I&&j.forEach((G,q)=>{const Z=I[q];if(!Z||Z.id!==G.id)return;const K=["active","paused","starting"].includes(Z.state),pe=!["active","paused","starting"].includes(G.state);K&&pe&&N(G.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:ps(l),orphanedToolUses:ps(c),currentMessages:f,currentToolCalls:h,loadMessages:S,addMessage:p,addToolCall:w,updateToolCall:b,handleToolCall:o,handlePermissionRequest:v,handlePermissionResponse:_,toggleToolExpansion:y,clearMessages:P,markToolUseOrphaned:O,isToolUseOrphaned:C,getOrphanedInfo:A,clearOrphanedToolUses:N,getLastReceivedTimestamp:F,syncMessages:V,getBackendToolState:D,hasBackendDisplayMetadata:T,backendToolStates:ps(u),launchTimestampBySession:ps(g)}}),Si=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ne},Symbol.toStringTag,{value:"Module"}));function xi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function rs(n){return xi(n).toLocaleTimeString()}const Ci={class:"msg-wrapper msg-user"},Ei={class:"msg-meta"},Ti={class:"msg-time"},Ai={class:"msg-bubble msg-bubble-user"},Di=["innerHTML"],Mi={key:0,class:"tool-results mt-2"},Oi={class:"tool-results-header text-muted small mb-2"},Li={class:"d-flex align-items-start gap-2"},Ii={class:"flex-grow-1"},Ni={class:"text-muted"},Pi={key:0,class:"text-danger small"},ji={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ye.setOptions({breaks:!0,gfm:!0});const s=k(()=>rs(e.message.timestamp)),a=k(()=>{const g=e.message.content||"";let u=Ye.parse(g);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),qt.sanitize(u)}),l=k(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=k(()=>e.message.metadata?.tool_results||[]);function d(g,u){return g?g.length<=u?g:g.substring(0,u)+"...":""}return(g,u)=>(i(),r("div",Ci,[t("div",Ei,[u[0]||(u[0]=t("span",{class:"msg-role"},"user",-1)),t("span",Ti,x(s.value),1)]),t("div",Ai,[t("div",{class:"msg-text",innerHTML:a.value},null,8,Di),l.value?(i(),r("div",Mi,[t("div",Oi," Tool Results ("+x(c.value.length)+") ",1),(i(!0),r(ee,null,le(c.value,(f,h)=>(i(),r("div",{key:h,class:H(["tool-result-summary",f.is_error?"result-error":"result-success"])},[t("div",Li,[t("span",null,x(f.is_error?"âœ—":"âœ“"),1),t("div",Ii,[t("small",Ni,"Tool: "+x(f.tool_use_id),1),f.is_error?(i(),r("div",Pi,x(d(f.content,200)),1)):M("",!0)])])],2))),128))])):M("",!0)])]))}},Ri=te(ji,[["__scopeId","data-v-c5db10e0"]]),Bi={class:"thinking-block"},Fi=["aria-label"],Vi={class:"text-muted ms-auto"},Ui={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Wi=["innerHTML"],Hi={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=L(!1),a=k(()=>e.thinking?.length||0),l=k(()=>{const d=e.thinking||"",g=Ye.parse(d);return qt.sanitize(g)});function c(){s.value=!s.value}return(d,g)=>(i(),r("div",Bi,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:c},[t("span",{"aria-label":s.value?"Collapse":"Expand"},x(s.value?"â–¾":"â–¸"),9,Fi),g[0]||(g[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Vi,x(a.value)+" characters",1)]),s.value?(i(),r("div",Ui,[t("div",{class:"thinking-text",innerHTML:l.value},null,8,Wi)])):M("",!0)]))}},qi=te(Hi,[["__scopeId","data-v-fda2352c"]]);function yn(n){const e=Ne(),s=_e(),a=k(()=>{const u=n.value;return u?.result?.error||u?.status==="error"||u?.permissionDecision==="deny"}),l=k(()=>{const u=n.value;if(!u)return"pending";const f=s.currentSessionId;if(!f)return u.status;if(u.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[u.backendStatus]||u.backendStatus;const h=e.getBackendToolState(f,u.id);return h?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[h.state]||h.state:e.isToolUseOrphaned(f,u.id)?"orphaned":u.status}),c=k(()=>{const u=n.value;if(!u)return!1;if(u._isOrphaned||u.backendStatus==="interrupted")return!0;const f=s.currentSessionId;return f?e.isToolUseOrphaned(f,u.id):!1}),d=k(()=>{const u=n.value;if(!u)return null;if(u._orphanedInfo)return u._orphanedInfo;const f=s.currentSessionId;return f?e.getOrphanedInfo(f,u.id):null}),g=k(()=>{switch(l.value){case"completed":return a.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}});return{effectiveStatus:l,isOrphaned:c,orphanedInfo:d,statusColor:g,hasError:a}}const zi={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"};function vs(n){return n?n.backendStatus?zi[n.backendStatus]||n.backendStatus:n.status:"pending"}function Ki(n,e){const s=e?.result?.error||e?.status==="error"||e?.permissionDecision==="deny";switch(n){case"completed":return s?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function Fn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function Gi(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Vn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Xi(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const a=Gi(s.command),l=Vn(a,60);return`${e}: ${l}`}case"SlashCommand":return`SlashCommand: ${Vn(s.command,60)}`;case"Edit":case"Read":case"Write":{const a=Fn(s.file_path);return`${e}: ${a}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const a=s.subagent_type||"general",l=s.description||"Task",c=l.length>40?l.substring(0,40)+"...":l;return`Task: (${a}) ${c}`}case"Grep":case"Glob":{const a=s.pattern||"",l=a.length>40?a.substring(0,40)+"...":a;return`${e}: "${l}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const l=s.query||"";return`WebSearch: ${l.length>40?l.substring(0,40)+"...":l}`}let a="";try{const l=s.url||"";l&&(a=new URL(l.startsWith("http")?l:`https://${l}`).hostname)}catch{a="URL"}return`WebFetch: ${a}`}case"NotebookEdit":return`NotebookEdit: ${Fn(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const Yi=["title"],Qi={class:"node-label"},Ji=["aria-label"],Zi={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){Xa(p=>({e88b3240:W(c)}));const s=n,a=L(!1),{effectiveStatus:l,statusColor:c,hasError:d,isOrphaned:g}=yn(Le(s,"tool")),u=k(()=>g.value?{icon:"âš ",color:"#f97316",ariaLabel:"Orphaned - tool execution was interrupted"}:s.tool.permissionDecision==="allow"?{icon:"âœ“",color:"#22c55e",ariaLabel:"Approved by user"}:s.tool.permissionDecision==="deny"?{icon:"âœ—",color:"#ef4444",ariaLabel:"Denied by user"}:null),f=k(()=>({"node-expanded":s.isExpanded,"node-running":l.value==="executing","node-permission":l.value==="permission_required"})),h=k(()=>({"dot-running":l.value==="executing","dot-permission":l.value==="permission_required","dot-error":l.value==="error"||l.value==="completed"&&d.value})),S=k(()=>{const p=Xi(s.tool),w={completed:d.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[l.value]||l.value;return`${p} [${w}]`}),m=k(()=>{const p=s.tool.name||"";if(p.startsWith("mcp__")){const w=p.lastIndexOf("__");if(w>4)return p.slice(w+2)}return p.replace(/Tool$/,"")});return e({statusColor:c,effectiveStatus:l}),(p,w)=>(i(),r("div",{class:H(["timeline-node",[f.value,{"node-compact":n.compact}]]),title:S.value,onClick:w[0]||(w[0]=ae(b=>p.$emit("click"),["stop"])),onMouseenter:w[1]||(w[1]=b=>a.value=!0),onMouseleave:w[2]||(w[2]=b=>a.value=!1)},[t("div",{class:H(["node-dot",h.value])},null,2),t("span",Qi,[ue(x(m.value)+" ",1),u.value?(i(),r("span",{key:0,class:"approval-icon",style:Pe({color:u.value.color}),"aria-label":u.value.ariaLabel,role:"img"},x(u.value.icon),13,Ji)):M("",!0)])],42,Yi))}},el=te(Zi,[["__scopeId","data-v-eec2e012"]]),tl={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"},compact:{type:Boolean,default:!1}},setup(n){const e=n,s=k(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(a,l)=>(i(),r("div",{class:H(["timeline-segment",{"segment-compact":n.compact}]),style:Pe(s.value)},null,6))}},sl=te(tl,[["__scopeId","data-v-40110c30"]]);function He(n){const e=k(()=>n.value?.result!==null&&n.value?.result!==void 0),s=k(()=>n.value?.result?.error||n.value?.status==="error"),a=k(()=>{if(!e.value)return"";const c=n.value.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)}),l=k(()=>n.value?.input?JSON.stringify(n.value.input,null,2):"{}");return{hasResult:e,isError:s,resultContent:a,formattedInput:l}}const nl={class:"base-tool-handler"},ol={class:"tool-section"},al={class:"tool-code-block"},il={class:"tool-code"},ll={key:0,class:"tool-section"},rl={class:"tool-label"},cl={class:"tool-code"},ul={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:l,resultContent:c,formattedInput:d}=He(Le(s,"toolCall")),g=k(()=>s.toolCall.name||"Tool"),u=k(()=>s.toolCall.input||{}),f=k(()=>s.toolCall.result||null);return e({summary:g,params:u,result:f}),(h,S)=>(i(),r("div",nl,[t("div",ol,[S[0]||(S[0]=t("div",{class:"tool-label"},"Parameters:",-1)),t("div",al,[t("pre",il,x(W(d)),1)])]),W(a)?(i(),r("div",ll,[t("div",rl,x(W(l)?"Error:":"Result:"),1),t("div",{class:H(["tool-code-block",{"tool-error":W(l)}])},[t("pre",cl,x(W(c)),1)],2)])):M("",!0)]))}},dl=te(ul,[["__scopeId","data-v-8c631459"]]),fl={class:"read-tool-handler"},ml={class:"tool-section"},pl={class:"read-file-info"},vl={class:"file-icon"},hl={class:"file-path"},_l={key:0,class:"read-range"},gl={key:0,class:"tool-section"},bl={key:0,class:"tool-result tool-result-error"},yl={class:"tool-code"},wl={key:1,class:"image-preview"},kl={class:"content-header"},$l={class:"image-badge"},Sl={class:"image-container"},xl=["src","alt"],Cl={key:2,class:"file-content-preview"},El={class:"content-header"},Tl={class:"line-count-badge"},Al={key:0,class:"preview-note"},Dl={class:"tool-code content-display"},Ml={key:0,class:"more-indicator"},Us=100,Ol={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:l,resultContent:c}=He(Le(s,"toolCall")),d=k(()=>s.toolCall.input?.file_path||"Unknown"),g=k(()=>{const E=d.value;return E.split("/").pop()||E}),u=k(()=>{const E=s.toolCall.input?.offset,D=s.toolCall.input?.limit;return E!==void 0||D!==void 0}),f=k(()=>{const E=s.toolCall.input?.offset;return E!==void 0?E+1:1}),h=k(()=>{const E=s.toolCall.input?.offset||0,D=s.toolCall.input?.limit;return D!==void 0?E+D:"âˆž"}),S=k(()=>{const E=d.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(E)}),m=k(()=>{if(!a.value||l.value)return null;const D=s.toolCall.result?.content;if(Array.isArray(D)){for(const T of D)if(T?.type==="image"&&T?.source?.type==="base64"&&T?.source?.data)return T.source.data}return null}),p=k(()=>{if(!m.value)return"";const E=d.value.toLowerCase();return E.endsWith(".png")?"image/png":E.endsWith(".jpg")||E.endsWith(".jpeg")?"image/jpeg":E.endsWith(".gif")?"image/gif":E.endsWith(".webp")?"image/webp":E.endsWith(".svg")?"image/svg+xml":E.endsWith(".bmp")?"image/bmp":E.endsWith(".ico")?"image/x-icon":"image/png"}),w=k(()=>l.value||!c.value||m.value?[]:c.value.split(`
`)),b=k(()=>w.value.length),v=k(()=>b.value>Us),_=k(()=>l.value||m.value?"":w.value.slice(0,Us).join(`
`)),o=k(()=>`Read: ${d.value}`),y=k(()=>({file_path:d.value,range:u.value?`${f.value}-${h.value}`:null})),$=k(()=>s.toolCall.result||null);return e({summary:o,params:y,result:$}),(E,D)=>(i(),r("div",fl,[t("div",ml,[t("div",pl,[t("span",vl,x(S.value?"ðŸ–¼ï¸":"ðŸ“„"),1),D[0]||(D[0]=t("strong",null,"Reading:",-1)),t("code",hl,x(d.value),1),u.value?(i(),r("span",_l,"Lines "+x(f.value)+"-"+x(h.value),1)):M("",!0)])]),W(a)?(i(),r("div",gl,[W(l)?(i(),r("div",bl,[t("pre",yl,x(W(c)),1)])):m.value?(i(),r("div",wl,[t("div",kl,[D[1]||(D[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",$l,x(p.value),1)]),t("div",Sl,[t("img",{src:`data:${p.value};base64,${m.value}`,alt:g.value,class:"preview-image"},null,8,xl)])])):(i(),r("div",Cl,[t("div",El,[D[2]||(D[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Tl,x(b.value)+" lines",1),v.value?(i(),r("span",Al,"(showing first "+x(Us)+")")):M("",!0)]),t("pre",Dl,x(_.value),1),v.value?(i(),r("div",Ml,"...")):M("",!0)]))])):M("",!0)]))}},Ll=te(Ol,[["__scopeId","data-v-48c7a097"]]),Il={class:"tool-success"},Nl={class:"success-icon"},Pl={key:0,class:"success-detail"},jl={__name:"ToolSuccessMessage",props:{message:{type:String,required:!0},icon:{type:String,default:"âœ…"},detail:{type:String,default:null}},setup(n){return(e,s)=>(i(),r("div",Il,[t("span",Nl,x(n.icon),1),t("strong",null,x(n.message),1),n.detail?(i(),r("span",Pl,x(n.detail),1)):M("",!0)]))}},gt=te(jl,[["__scopeId","data-v-46a18f70"]]),Rl={class:"write-tool-handler"},Bl={class:"tool-section"},Fl={class:"write-file-info mb-2"},Vl={class:"file-path"},Ul={class:"write-content-preview"},Wl={class:"content-header"},Hl={class:"line-count-badge"},ql={key:0,class:"preview-note"},zl={class:"tool-code-block content-display"},Kl={key:0,class:"more-indicator"},Gl={key:0,class:"tool-section"},Xl={key:0,class:"tool-result tool-result-error"},Yl={class:"tool-code-block"},Ql={key:1},Ws=100,Jl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.input?.file_path||"Unknown"),l=k(()=>s.toolCall.input?.content||""),c=k(()=>l.value.split(`
`)),d=k(()=>c.value.length),g=k(()=>d.value>Ws),u=k(()=>c.value.slice(0,Ws).join(`
`)),{hasResult:f,isError:h,resultContent:S}=He(Le(s,"toolCall")),m=k(()=>`Write: ${a.value}`),p=k(()=>({file_path:a.value,lines:d.value})),w=k(()=>s.toolCall.result||null);return e({summary:m,params:p,result:w}),(b,v)=>(i(),r("div",Rl,[t("div",Bl,[t("div",Fl,[v[0]||(v[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),v[1]||(v[1]=t("strong",null,"Writing:",-1)),t("code",Vl,x(a.value),1)]),t("div",Ul,[t("div",Wl,[v[2]||(v[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Hl,x(d.value)+" lines",1),g.value?(i(),r("span",ql,"(showing first "+x(Ws)+")")):M("",!0)]),t("pre",zl,x(u.value),1),g.value?(i(),r("div",Kl,"...")):M("",!0)])]),W(f)?(i(),r("div",Gl,[W(h)?(i(),r("div",Xl,[v[3]||(v[3]=t("strong",null,"Error:",-1)),t("pre",Yl,x(W(S)),1)])):(i(),r("div",Ql,[he(gt,{message:`File created successfully (${d.value} lines written)`},null,8,["message"])]))])):M("",!0)]))}},Zl=te(Jl,[["__scopeId","data-v-c0a79af9"]]),er={class:"bash-tool-handler"},tr={class:"tool-section"},sr={class:"bash-header"},nr={class:"bash-header-content"},or={key:0,class:"bash-description"},ar={key:1,class:"bash-flags"},ir={class:"bash-command-section"},lr={class:"bash-command-content"},rr={key:0,class:"tool-section"},cr={key:0,class:"bash-output"},ur={key:1,class:"bash-output-empty"},dr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.input?.command||""),l=k(()=>s.toolCall.input?.description||""),c=k(()=>s.toolCall.input?.timeout),d=k(()=>s.toolCall.input?.run_in_background||!1),g=k(()=>c.value||d.value),u=k(()=>{const v=[];return c.value&&v.push(`timeout: ${c.value}ms`),d.value&&v.push("background"),v.join(", ")}),{hasResult:f,isError:h,resultContent:S}=He(Le(s,"toolCall")),m=k(()=>h.value?"tool-result-error":"tool-result-success"),p=k(()=>`Bash: ${a.value?.substring(0,60)||""}`),w=k(()=>({command:a.value,description:l.value})),b=k(()=>s.toolCall.result||null);return e({summary:p,params:w,result:b}),(v,_)=>(i(),r("div",er,[t("div",tr,[t("div",sr,[_[1]||(_[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",nr,[l.value?(i(),r("div",or,[_[0]||(_[0]=t("strong",null,"Description:",-1)),ue(" "+x(l.value),1)])):M("",!0),g.value?(i(),r("div",ar,x(u.value),1)):M("",!0)])]),t("div",ir,[_[2]||(_[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",lr,x(a.value),1)])]),W(f)?(i(),r("div",rr,[t("div",{class:H(["tool-result",m.value])},[_[3]||(_[3]=t("strong",null,"Output:",-1)),W(S)?(i(),r("pre",cr,x(W(S)),1)):(i(),r("div",ur,"No output"))],2)])):M("",!0)]))}},fr=te(dr,[["__scopeId","data-v-b2e7e2cb"]]),mr={class:"todo-tool-handler"},pr={class:"tool-section"},vr={class:"todo-header"},hr={class:"todo-summary"},_r={key:0,class:"todo-count todo-count-completed"},gr={key:1,class:"todo-count todo-count-in-progress"},br={key:2,class:"todo-count todo-count-pending"},yr={class:"todo-checklist"},wr={class:"todo-checkbox"},kr={class:"todo-content"},$r={key:0,class:"tool-section"},Sr={key:0,class:"tool-result tool-result-error"},xr={class:"tool-code"},Cr={key:1},Er={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:l,resultContent:c}=He(Le(s,"toolCall")),d=k(()=>s.toolCall.input?.todos||[]),g=k(()=>d.value.filter(w=>w.status==="completed").length),u=k(()=>d.value.filter(w=>w.status==="in_progress").length),f=k(()=>d.value.filter(w=>w.status==="pending").length);function h(w){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[w]||"â˜"}const S=k(()=>`Todo: ${d.value.length} tasks`),m=k(()=>({count:d.value.length,completed:g.value,pending:f.value})),p=k(()=>s.toolCall.result||null);return e({summary:S,params:m,result:p}),(w,b)=>(i(),r("div",mr,[t("div",pr,[t("div",vr,[b[0]||(b[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),b[1]||(b[1]=t("strong",null,"Task List:",-1)),t("div",hr,[g.value>0?(i(),r("span",_r,x(g.value)+" completed ",1)):M("",!0),u.value>0?(i(),r("span",gr,x(u.value)+" in progress ",1)):M("",!0),f.value>0?(i(),r("span",br,x(f.value)+" pending ",1)):M("",!0)])]),t("div",yr,[(i(!0),r(ee,null,le(d.value,(v,_)=>(i(),r("div",{key:_,class:H(["todo-item",`todo-${v.status}`])},[t("span",wr,x(h(v.status)),1),t("span",kr,x(v.content),1)],2))),128))])]),W(a)?(i(),r("div",$r,[W(l)?(i(),r("div",Sr,[b[2]||(b[2]=t("strong",null,"Error:",-1)),t("pre",xr,x(W(c)),1)])):(i(),r("div",Cr,[he(gt,{message:`Task list updated (${d.value.length} tasks)`},null,8,["message"])]))])):M("",!0)]))}},Tr=te(Er,[["__scopeId","data-v-67ee16af"]]),Ar={class:"edit-tool-handler"},Dr={class:"tool-section"},Mr={class:"edit-file-info"},Or={class:"file-path"},Lr={key:0,class:"replace-all-badge"},Ir={class:"edit-diff-container"},Nr={class:"diff-header"},Pr={class:"diff-stats"},jr={class:"stat-removed"},Rr={class:"stat-added"},Br={class:"unified-diff"},Fr={class:"diff-scroll-container"},Vr={class:"diff-marker"},Ur={class:"diff-content"},Wr={key:0,class:"tool-section"},Hr={key:0,class:"tool-result tool-result-error"},qr={class:"tool-code"},zr={key:1},Kr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.input?.file_path||"Unknown"),l=k(()=>s.toolCall.input?.old_string||""),c=k(()=>s.toolCall.input?.new_string||""),d=k(()=>s.toolCall.input?.replace_all||!1),g=k(()=>{const _=ti(a.value,l.value,c.value,"","",{context:3}).split(`
`),o=[];for(let y=4;y<_.length;y++){const $=_[y];$&&($.startsWith("-")?o.push({type:"removed",content:$.substring(1)}):$.startsWith("+")?o.push({type:"added",content:$.substring(1)}):$.startsWith(" ")?o.push({type:"context",content:$.substring(1)}):$.startsWith("@@")&&o.push({type:"hunk",content:$}))}return o}),u=k(()=>g.value.filter(v=>v.type==="removed").length),f=k(()=>g.value.filter(v=>v.type==="added").length),{hasResult:h,isError:S,resultContent:m}=He(Le(s,"toolCall")),p=k(()=>`Edit: ${a.value}`),w=k(()=>({file_path:a.value,replace_all:d.value})),b=k(()=>s.toolCall.result||null);return e({summary:p,params:w,result:b}),(v,_)=>(i(),r("div",Ar,[t("div",Dr,[t("div",Mr,[_[0]||(_[0]=t("span",{class:"file-icon"},"âœï¸",-1)),_[1]||(_[1]=t("strong",null,"Editing:",-1)),t("code",Or,x(a.value),1),d.value?(i(),r("span",Lr,"Replace All")):M("",!0)]),t("div",Ir,[t("div",Nr,[_[2]||(_[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Pr,[t("span",jr,"-"+x(u.value),1),t("span",Rr,"+"+x(f.value),1)])]),t("div",Br,[t("div",Fr,[(i(!0),r(ee,null,le(g.value,(o,y)=>(i(),r("div",{key:y,class:H(["diff-line",{"diff-line-removed":o.type==="removed","diff-line-added":o.type==="added","diff-line-context":o.type==="context","diff-line-hunk":o.type==="hunk"}])},[t("span",Vr,x(o.type==="removed"?"-":o.type==="added"?"+":o.type==="hunk"?"@":" "),1),t("span",Ur,x(o.content),1)],2))),128))])])])]),W(h)?(i(),r("div",Wr,[W(S)?(i(),r("div",Hr,[_[3]||(_[3]=t("strong",null,"Error:",-1)),t("pre",qr,x(W(m)),1)])):(i(),r("div",zr,[he(gt,{message:"File edited successfully",detail:d.value?"(all occurrences replaced)":null},null,8,["detail"])]))])):M("",!0)]))}},Gr=te(Kr,[["__scopeId","data-v-b924c8f6"]]),Xr={class:"search-tool-handler"},Yr={class:"tool-section"},Qr={class:"search-info"},Jr={class:"search-icon"},Zr={class:"search-pattern"},ec={key:0,class:"search-path"},tc={key:1,class:"search-filters"},sc={key:0,class:"filter-badge"},nc={key:1,class:"filter-badge"},oc={key:2,class:"filter-badge"},ac={key:0,class:"tool-section"},ic={key:0,class:"tool-result tool-result-error"},lc={class:"tool-code"},rc={key:1,class:"search-results"},cc={class:"results-header"},uc={class:"results-label"},dc={class:"results-count-badge"},fc={class:"results-content"},mc={class:"tool-code"},pc={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:l,resultContent:c}=He(Le(s,"toolCall")),d=k(()=>s.toolCall.name==="Grep"),g=k(()=>s.toolCall.input?.pattern||"Unknown"),u=k(()=>s.toolCall.input?.path||null),f=k(()=>s.toolCall.input?.type||null),h=k(()=>s.toolCall.input?.glob||null),S=k(()=>s.toolCall.input?.["-i"]||!1),m=k(()=>f.value||h.value||S.value),p=k(()=>d.value?"ðŸ”":"ðŸ“"),w=k(()=>d.value?"Searching content":"Finding files"),b=k(()=>d.value?"Matches":"Files found"),v=k(()=>!a.value||l.value||!c.value?0:c.value.split(`
`).filter(E=>E.trim()).length),_=k(()=>`${w.value}: ${g.value}`),o=k(()=>({pattern:g.value,path:u.value})),y=k(()=>s.toolCall.result||null);return e({summary:_,params:o,result:y}),($,E)=>(i(),r("div",Xr,[t("div",Yr,[t("div",Qr,[t("span",Jr,x(p.value),1),t("strong",null,x(w.value)+":",1),t("code",Zr,x(g.value),1),u.value?(i(),r("span",ec,"in "+x(u.value),1)):M("",!0),m.value?(i(),r("span",tc,[f.value?(i(),r("span",sc,"type: "+x(f.value),1)):M("",!0),h.value?(i(),r("span",nc,"glob: "+x(h.value),1)):M("",!0),S.value?(i(),r("span",oc,"case-insensitive")):M("",!0)])):M("",!0)])]),W(a)?(i(),r("div",ac,[W(l)?(i(),r("div",ic,[E[0]||(E[0]=t("strong",null,"Error:",-1)),t("pre",lc,x(W(c)),1)])):(i(),r("div",rc,[t("div",cc,[t("span",uc,x(b.value)+":",1),t("span",dc,x(v.value)+" "+x(v.value===1?"match":"matches"),1)]),t("div",fc,[t("pre",mc,x(W(c)),1)])]))])):M("",!0)]))}},Un=te(pc,[["__scopeId","data-v-644b2308"]]),vc={class:"web-tool-handler"},hc={class:"tool-section"},_c={class:"web-info"},gc={class:"web-icon"},bc=["href"],yc={key:1,class:"web-query"},wc={key:0,class:"web-prompt-container"},kc={class:"prompt-content"},$c={key:1,class:"web-domains"},Sc={class:"domains-label"},xc={key:0,class:"tool-section"},Cc={key:0,class:"tool-result tool-result-error"},Ec={class:"tool-code"},Tc={key:1,class:"web-results"},Ac={class:"results-header"},Dc={class:"results-label"},Mc={class:"results-content"},Oc={class:"tool-code"},Lc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:l,resultContent:c}=He(Le(s,"toolCall")),d=k(()=>s.toolCall.name==="WebFetch"),g=k(()=>s.toolCall.input?.url||null),u=k(()=>s.toolCall.input?.query||null),f=k(()=>s.toolCall.input?.prompt||null),h=k(()=>s.toolCall.input?.allowed_domains||[]),S=k(()=>s.toolCall.input?.blocked_domains||[]),m=k(()=>h.value.length>0?h.value:S.value.length>0?S.value:[]),p=k(()=>h.value.length>0?"Allowed domains":S.value.length>0?"Blocked domains":"Domains"),w=k(()=>d.value?"ðŸŒ":"ðŸ”Ž"),b=k(()=>d.value?"Fetching URL":"Searching web"),v=k(()=>d.value?"Fetched content":"Search results"),_=k(()=>`${b.value}: ${g.value||u.value||""}`),o=k(()=>({url:g.value,query:u.value,prompt:f.value})),y=k(()=>s.toolCall.result||null);return e({summary:_,params:o,result:y}),($,E)=>(i(),r("div",vc,[t("div",hc,[t("div",_c,[t("span",gc,x(w.value),1),t("strong",null,x(b.value)+":",1),g.value?(i(),r("a",{key:0,href:g.value,target:"_blank",class:"web-url"},x(g.value),9,bc)):u.value?(i(),r("code",yc,x(u.value),1)):M("",!0)]),f.value?(i(),r("div",wc,[E[0]||(E[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",kc,x(f.value),1)])):M("",!0),m.value.length>0?(i(),r("div",$c,[t("span",Sc,x(p.value)+":",1),(i(!0),r(ee,null,le(m.value,D=>(i(),r("span",{key:D,class:"domain-badge"},x(D),1))),128))])):M("",!0)]),W(a)?(i(),r("div",xc,[W(l)?(i(),r("div",Cc,[E[1]||(E[1]=t("strong",null,"Error:",-1)),t("pre",Ec,x(W(c)),1)])):(i(),r("div",Tc,[t("div",Ac,[t("span",Dc,x(v.value)+":",1)]),t("div",Mc,[t("pre",Oc,x(W(c)),1)])]))])):M("",!0)]))}},Wn=te(Lc,[["__scopeId","data-v-2a56a86d"]]),Ic={class:"task-tool-handler"},Nc={class:"tool-section"},Pc={class:"task-header"},jc={key:0,class:"agent-type-badge"},Rc={key:0,class:"task-description"},Bc={class:"description-content"},Fc={key:1,class:"task-prompt-container"},Vc={class:"prompt-header"},Uc={class:"prompt-length"},Wc={class:"prompt-code"},Hc={key:0,class:"tool-section"},qc={key:0,class:"tool-result tool-result-error"},zc={class:"tool-code"},Kc={key:1,class:"agent-output"},Gc={class:"output-header"},Xc={key:0,class:"output-count-badge"},Yc={class:"output-content"},Qc={class:"tool-code"},Jc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.input?.description||null),l=k(()=>s.toolCall.input?.prompt||null),c=k(()=>s.toolCall.input?.subagent_type||null),{hasResult:d,isError:g,resultContent:u}=He(Le(s,"toolCall")),f=k(()=>u.value?u.value.split(`
`).length:0),h=k(()=>`Task: ${a.value||c.value||"agent"}`),S=k(()=>({description:a.value,subagent_type:c.value})),m=k(()=>s.toolCall.result||null);return e({summary:h,params:S,result:m}),(p,w)=>(i(),r("div",Ic,[t("div",Nc,[t("div",Pc,[w[0]||(w[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),w[1]||(w[1]=t("strong",null,"Agent Task:",-1)),c.value?(i(),r("span",jc,x(c.value),1)):M("",!0)]),a.value?(i(),r("div",Rc,[w[2]||(w[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Bc,x(a.value),1)])):M("",!0),l.value?(i(),r("div",Fc,[t("div",Vc,[w[3]||(w[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Uc,x(l.value.length)+" characters",1)]),t("pre",Wc,x(l.value),1)])):M("",!0)]),W(d)?(i(),r("div",Hc,[W(g)?(i(),r("div",qc,[w[4]||(w[4]=t("strong",null,"Error:",-1)),t("pre",zc,x(W(u)),1)])):(i(),r("div",Kc,[t("div",Gc,[w[5]||(w[5]=t("span",{class:"output-label"},"Agent Output:",-1)),f.value>0?(i(),r("span",Xc,x(f.value)+" lines",1)):M("",!0)]),t("div",Yc,[t("pre",Qc,x(W(u)),1)])]))])):M("",!0)]))}},Zc=te(Jc,[["__scopeId","data-v-6f0d8579"]]),eu={class:"task-create-tool-handler"},tu={class:"tool-section"},su={class:"task-details p-2"},nu={key:0,class:"task-field mb-2"},ou={class:"field-value subject-value"},au={key:1,class:"task-field mb-2"},iu={class:"field-value description-value"},lu={key:2,class:"task-field"},ru={class:"field-value active-form-value"},cu={key:0,class:"tool-section mt-2"},uu={key:0,class:"tool-result tool-result-error"},du={class:"tool-code"},fu={key:1},mu={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.input?.subject||null),l=k(()=>s.toolCall.input?.description||null),c=k(()=>s.toolCall.input?.activeForm||null),{hasResult:d,isError:g,resultContent:u}=He(Le(s,"toolCall")),f=k(()=>`Create Task: ${a.value||""}`),h=k(()=>({subject:a.value,description:l.value})),S=k(()=>s.toolCall.result||null);return e({summary:f,params:h,result:S}),(m,p)=>(i(),r("div",eu,[t("div",tu,[p[3]||(p[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",su,[a.value?(i(),r("div",nu,[p[0]||(p[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",ou,x(a.value),1)])):M("",!0),l.value?(i(),r("div",au,[p[1]||(p[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",iu,x(l.value),1)])):M("",!0),c.value?(i(),r("div",lu,[p[2]||(p[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",ru,x(c.value),1)])):M("",!0)])]),W(d)?(i(),r("div",cu,[W(g)?(i(),r("div",uu,[p[4]||(p[4]=t("strong",null,"Error:",-1)),t("pre",du,x(W(u)),1)])):(i(),r("div",fu,[he(gt,{message:W(u)},null,8,["message"])]))])):M("",!0)]))}},pu=te(mu,[["__scopeId","data-v-2d64ff43"]]),vu={class:"task-update-tool-handler"},hu={class:"tool-section"},_u={class:"task-header"},gu={key:0,class:"task-id-badge"},bu={class:"task-details p-2"},yu={key:0,class:"task-field mb-2"},wu={key:1,class:"task-field mb-2"},ku={class:"field-value"},$u={key:2,class:"task-field mb-2"},Su={class:"field-value description-value"},xu={key:3,class:"task-field mb-2"},Cu={class:"field-value active-form-value"},Eu={key:4,class:"task-field mb-2"},Tu={class:"field-value"},Au={key:5,class:"task-field mb-2"},Du={class:"field-value"},Mu={key:6,class:"task-field"},Ou={class:"field-value"},Lu={key:0,class:"tool-section mt-2"},Iu={key:0,class:"tool-result tool-result-error"},Nu={class:"tool-code"},Pu={key:1},ju={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.input?.taskId||null),l=k(()=>s.toolCall.input?.status||null),c=k(()=>s.toolCall.input?.subject||null),d=k(()=>s.toolCall.input?.description||null),g=k(()=>s.toolCall.input?.activeForm||null),u=k(()=>s.toolCall.input?.owner||null),f=k(()=>s.toolCall.input?.addBlockedBy||[]),h=k(()=>s.toolCall.input?.addBlocks||[]),S=k(()=>{switch(l.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),m=k(()=>{switch(l.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),{hasResult:p,isError:w,resultContent:b}=He(Le(s,"toolCall")),v=k(()=>`Update Task #${a.value}: ${l.value||""}`),_=k(()=>({taskId:a.value,status:l.value})),o=k(()=>s.toolCall.result||null);return e({summary:v,params:_,result:o}),(y,$)=>(i(),r("div",vu,[t("div",hu,[t("div",_u,[$[0]||($[0]=t("span",{class:"task-icon"},"âœï¸",-1)),$[1]||($[1]=t("strong",null,"Update Task",-1)),a.value?(i(),r("span",gu,"#"+x(a.value),1)):M("",!0)]),t("div",bu,[l.value?(i(),r("div",yu,[$[2]||($[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:H(["field-value status-value",m.value])},x(S.value)+" "+x(l.value),3)])):M("",!0),c.value?(i(),r("div",wu,[$[3]||($[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",ku,x(c.value),1)])):M("",!0),d.value?(i(),r("div",$u,[$[4]||($[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",Su,x(d.value),1)])):M("",!0),g.value?(i(),r("div",xu,[$[5]||($[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Cu,x(g.value),1)])):M("",!0),u.value?(i(),r("div",Eu,[$[6]||($[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",Tu,x(u.value),1)])):M("",!0),f.value?.length?(i(),r("div",Au,[$[7]||($[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",Du,[(i(!0),r(ee,null,le(f.value,E=>(i(),r("span",{key:E,class:"badge bg-warning text-dark me-1"},"#"+x(E),1))),128))])])):M("",!0),h.value?.length?(i(),r("div",Mu,[$[8]||($[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",Ou,[(i(!0),r(ee,null,le(h.value,E=>(i(),r("span",{key:E,class:"badge bg-info text-dark me-1"},"#"+x(E),1))),128))])])):M("",!0)])]),W(p)?(i(),r("div",Lu,[W(w)?(i(),r("div",Iu,[$[9]||($[9]=t("strong",null,"Error:",-1)),t("pre",Nu,x(W(b)),1)])):(i(),r("div",Pu,[he(gt,{message:W(b)},null,8,["message"])]))])):M("",!0)]))}},Ru=te(ju,[["__scopeId","data-v-294f9c15"]]),Bu={class:"task-list-tool-handler"},Fu={key:0,class:"tool-section"},Vu={key:0,class:"tool-result tool-result-error"},Uu={class:"tool-code"},Wu={key:1,class:"task-list-result"},Hu={key:0,class:"parsed-tasks"},qu={class:"status-icon"},zu={class:"task-id text-muted"},Ku={class:"task-subject flex-grow-1"},Gu={key:0,class:"task-owner badge bg-secondary"},Xu={key:1,class:"raw-result p-2"},Yu={class:"tool-code"},Qu={key:1,class:"tool-section"},Ju={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:l,resultContent:c}=He(Le(s,"toolCall")),d=k(()=>{if(!c.value)return[];const S=[],p=c.value.split(`
`);for(const w of p){const b=w.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(b){const v=b[2].toLowerCase();S.push({id:b[1],status:v,subject:b[3].trim(),owner:null,statusIcon:g(v)})}}return S});function g(S){switch(S){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}const u=k(()=>"List Tasks"),f=k(()=>({})),h=k(()=>s.toolCall.result||null);return e({summary:u,params:f,result:h}),(S,m)=>(i(),r("div",Bu,[m[2]||(m[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),W(a)?(i(),r("div",Fu,[W(l)?(i(),r("div",Vu,[m[0]||(m[0]=t("strong",null,"Error:",-1)),t("pre",Uu,x(W(c)),1)])):(i(),r("div",Wu,[d.value.length>0?(i(),r("div",Hu,[(i(!0),r(ee,null,le(d.value,(p,w)=>(i(),r("div",{key:w,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",qu,x(p.statusIcon),1),t("span",zu,"#"+x(p.id),1),t("span",Ku,x(p.subject),1),p.owner?(i(),r("span",Gu,x(p.owner),1)):M("",!0)]))),128))])):(i(),r("div",Xu,[t("pre",Yu,x(W(c)),1)]))]))])):n.toolCall.status==="completed"?(i(),r("div",Qu,[...m[1]||(m[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):M("",!0)]))}},Zu=te(Ju,[["__scopeId","data-v-11faa667"]]),ed={class:"task-get-tool-handler"},td={class:"tool-section"},sd={class:"task-header"},nd={key:0,class:"task-id-badge"},od={key:0,class:"tool-section"},ad={key:0,class:"tool-result tool-result-error"},id={class:"tool-code"},ld={key:1,class:"task-details-result p-2"},rd={key:0,class:"parsed-task"},cd={class:"task-field mb-2"},ud={class:"field-value subject-value"},dd={key:0,class:"task-field mb-2"},fd={key:1,class:"task-field mb-2"},md={class:"field-value description-value"},pd={key:2,class:"task-field mb-2"},vd={class:"field-value"},hd={key:3,class:"task-field mb-2"},_d={class:"field-value"},gd={key:4,class:"task-field"},bd={class:"field-value"},yd={key:1,class:"raw-result"},wd={class:"tool-code"},kd={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:l,resultContent:c}=He(Le(s,"toolCall")),d=k(()=>s.toolCall.input?.taskId||null),g=k(()=>d.value?`Get Task #${d.value}`:"Get Task"),u=k(()=>({taskId:d.value})),f=k(()=>s.toolCall.result||null);e({summary:g,params:u,result:f});const h=k(()=>{if(!c.value)return null;const p=c.value;try{const v=JSON.parse(p);if(v&&typeof v=="object")return{subject:v.subject||v.title||"",status:v.status||"",description:v.description||"",owner:v.owner||"",blockedBy:v.blockedBy||[],blocks:v.blocks||[]}}catch{}const w=p.split(`
`),b={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const v of w){const _=v.match(/^Subject:\s*(.+)$/i);_&&(b.subject=_[1].trim());const o=v.match(/^Status:\s*(.+)$/i);o&&(b.status=o[1].trim());const y=v.match(/^Description:\s*(.+)$/i);y&&(b.description=y[1].trim());const $=v.match(/^Owner:\s*(.+)$/i);$&&(b.owner=$[1].trim())}return b.subject?b:null}),S=k(()=>{if(!h.value)return"";switch(h.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=k(()=>{if(!h.value)return"";switch(h.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,w)=>(i(),r("div",ed,[t("div",td,[t("div",sd,[w[0]||(w[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),w[1]||(w[1]=t("strong",null,"Get Task",-1)),d.value?(i(),r("span",nd,"#"+x(d.value),1)):M("",!0)])]),W(a)?(i(),r("div",od,[W(l)?(i(),r("div",ad,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",id,x(W(c)),1)])):(i(),r("div",ld,[h.value?(i(),r("div",rd,[t("div",cd,[w[3]||(w[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",ud,x(h.value.subject),1)]),h.value.status?(i(),r("div",dd,[w[4]||(w[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:H(["field-value",m.value])},x(S.value)+" "+x(h.value.status),3)])):M("",!0),h.value.description?(i(),r("div",fd,[w[5]||(w[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",md,x(h.value.description),1)])):M("",!0),h.value.owner?(i(),r("div",pd,[w[6]||(w[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",vd,x(h.value.owner),1)])):M("",!0),h.value.blockedBy?.length?(i(),r("div",hd,[w[7]||(w[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",_d,[(i(!0),r(ee,null,le(h.value.blockedBy,b=>(i(),r("span",{key:b,class:"badge bg-warning text-dark me-1"},"#"+x(b),1))),128))])])):M("",!0),h.value.blocks?.length?(i(),r("div",gd,[w[8]||(w[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",bd,[(i(!0),r(ee,null,le(h.value.blocks,b=>(i(),r("span",{key:b,class:"badge bg-info text-dark me-1"},"#"+x(b),1))),128))])])):M("",!0)])):(i(),r("div",yd,[t("pre",wd,x(W(c)),1)]))]))])):M("",!0)]))}},$d=te(kd,[["__scopeId","data-v-0b257175"]]),Sd={class:"notebook-edit-tool-handler"},xd={class:"tool-section"},Cd={class:"notebook-info"},Ed={class:"file-path"},Td={class:"cell-info mt-2"},Ad={class:"info-row"},Dd={class:"info-row"},Md={key:0,class:"info-row"},Od={class:"badge bg-info"},Ld={key:0,class:"source-preview mt-3"},Id={class:"preview-header"},Nd={class:"preview-stats"},Pd={class:"source-code"},jd={key:0,class:"tool-section"},Rd={key:0},Bd={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},Fd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.input?.notebook_path||"Unknown"),l=k(()=>s.toolCall.input?.cell_id),c=k(()=>s.toolCall.input?.cell_type||"code"),d=k(()=>s.toolCall.input?.edit_mode||"replace"),g=k(()=>s.toolCall.input?.new_source||""),u=k(()=>g.value.split(`
`).length),f=k(()=>c.value==="code"?"bg-primary":"bg-secondary"),h=k(()=>{if(s.toolCall.result?.message)return s.toolCall.result.message;const w=d.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"}),S=k(()=>`Notebook: ${d.value} cell in ${a.value}`),m=k(()=>({notebook_path:a.value,cell_id:l.value,edit_mode:d.value})),p=k(()=>s.toolCall.result||null);return e({summary:S,params:m,result:p}),(w,b)=>(i(),r("div",Sd,[t("div",xd,[t("div",Cd,[b[0]||(b[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),b[1]||(b[1]=t("strong",null,"Notebook:",-1)),t("code",Ed,x(a.value),1)]),t("div",Td,[t("div",Ad,[b[2]||(b[2]=t("strong",null,"Cell ID:",-1)),t("code",null,x(l.value||"N/A"),1)]),t("div",Dd,[b[3]||(b[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:H(["badge",f.value])},x(c.value),3)]),d.value?(i(),r("div",Md,[b[4]||(b[4]=t("strong",null,"Edit Mode:",-1)),t("span",Od,x(d.value),1)])):M("",!0)]),g.value?(i(),r("div",Ld,[t("div",Id,[b[5]||(b[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",Nd,x(u.value)+" lines",1)]),t("pre",Pd,[t("code",null,x(g.value),1)])])):M("",!0)]),n.toolCall.result?(i(),r("div",jd,[n.toolCall.result.success!==!1?(i(),r("div",Rd,[he(gt,{message:h.value},null,8,["message"])])):(i(),r("div",Bd," â— "+x(n.toolCall.result.error||"Operation failed"),1))])):M("",!0)]))}},Vd=te(Fd,[["__scopeId","data-v-36ad5b7a"]]),Ud={class:"shell-tool-handler"},Wd={class:"tool-section"},Hd={class:"shell-info"},qd={class:"shell-icon"},zd={key:0,class:"shell-id"},Kd={key:0,class:"filter-info mt-2"},Gd={class:"filter-pattern"},Xd={key:0,class:"tool-section"},Yd={class:"result-header mb-2"},Qd={key:0,class:"mb-2"},Jd={class:"shell-output"},Zd={key:1,class:"mb-2"},ef={class:"shell-output shell-output-error"},tf={key:2},sf={key:0},nf={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},of={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.name==="BashOutput"?"ðŸ“¤":s.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),l=k(()=>s.toolCall.name==="BashOutput"?"Reading Shell Output":s.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),c=k(()=>s.toolCall.name==="BashOutput"?"Output":s.toolCall.name==="KillShell"?"Status":"Result"),d=k(()=>s.toolCall.input?.bash_id||s.toolCall.input?.shell_id),g=k(()=>s.toolCall.input?.filter);function u(v,_){if(!v)return null;const o=new RegExp(`<${_}>([\\s\\S]*?)<\\/${_}>`,"i"),y=v.match(o);return y?y[1].trim():null}const f=k(()=>{const v=s.toolCall.result;if(!v)return null;let _=v;if(v.content&&(_=v.content),typeof _=="string")return{status:u(_,"status"),stdout:u(_,"stdout"),stderr:u(_,"stderr"),exit_code:u(_,"exit_code")};if(Array.isArray(_)){const o=_.find(y=>y.type==="text")?.text||"";return{status:u(o,"status"),stdout:u(o,"stdout"),stderr:u(o,"stderr"),exit_code:u(o,"exit_code")}}return{status:v.status||_.status,stdout:v.stdout||v.output||_.stdout||_.output,stderr:v.stderr||_.stderr,exit_code:v.exit_code||_.exit_code}}),h=k(()=>f.value?.status),S=k(()=>{const v=h.value;return v==="running"?"bg-success":v==="completed"?"bg-secondary":v==="killed"||v==="terminated"?"bg-danger":"bg-info"}),m=k(()=>{if(s.toolCall.result?.message)return s.toolCall.result.message;if(s.toolCall.name==="KillShell")return"Shell terminated successfully";if(s.toolCall.name==="BashOutput"){const v=f.value;if(v?.status==="running"&&!v.stdout&&!v.stderr)return"No new output since last check";if(v?.status==="failed")return`Shell failed (exit code ${v.exit_code||"unknown"})`}return"Operation completed"}),p=k(()=>`${l.value}: Shell ${d.value||""}`),w=k(()=>({shell_id:d.value,filter:g.value})),b=k(()=>s.toolCall.result||null);return e({summary:p,params:w,result:b}),(v,_)=>(i(),r("div",Ud,[t("div",Wd,[t("div",Hd,[t("span",qd,x(a.value),1),t("strong",null,x(l.value)+":",1),d.value?(i(),r("code",zd,"Shell "+x(d.value),1)):M("",!0)]),n.toolCall.name==="BashOutput"&&g.value?(i(),r("div",Kd,[_[0]||(_[0]=t("strong",null,"Filter:",-1)),t("code",Gd,x(g.value),1)])):M("",!0)]),n.toolCall.result?(i(),r("div",Xd,[t("div",Yd,[t("strong",null,x(c.value)+":",1),h.value?(i(),r("span",{key:0,class:H(["badge",S.value])},x(h.value),3)):M("",!0)]),f.value?.stdout?(i(),r("div",Qd,[_[1]||(_[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Jd,[t("pre",null,[t("code",null,x(f.value.stdout),1)])])])):M("",!0),f.value?.stderr?(i(),r("div",Zd,[_[2]||(_[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",ef,[t("pre",null,[t("code",null,x(f.value.stderr),1)])])])):M("",!0),!f.value?.stdout&&!f.value?.stderr?(i(),r("div",tf,[n.toolCall.result.success!==!1?(i(),r("div",sf,[he(gt,{message:m.value},null,8,["message"])])):(i(),r("div",nf," â— "+x(n.toolCall.result.error||"Operation failed"),1))])):M("",!0)])):M("",!0)]))}},Hn=te(of,[["__scopeId","data-v-aa113f41"]]),af={class:"skill-tool-handler"},lf={key:0,class:"tool-section"},rf={class:"d-flex align-items-center gap-2"},cf={class:"text-muted small"},uf={key:0,class:"skill-content-body"},df={class:"skill-content-text"},ff={key:1,class:"tool-section mt-3"},mf={class:"tool-result tool-result-error"},pf={class:"tool-code"},vf={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=Ne(),l=_e(),c=L(!1);function d(){c.value=!c.value}const g=k(()=>s.toolCall.input?.command||"Unknown Skill"),u=k(()=>{const _=l.currentSessionId;if(!_)return{running:null,content:null};const o=a.messagesBySession.get(_)||[],y=o.findIndex(D=>D.type==="user"&&D.metadata?.has_tool_results&&D.metadata?.tool_results?.some(T=>T.tool_use_id===s.toolCall.id));if(y===-1)return{running:null,content:null};let $=null,E=null;for(let D=y+1;D<Math.min(y+3,o.length);D++){const T=o[D];if(T.type!=="user")continue;const O=T.content||"";O.includes("<command-message>")&&O.includes("skill is running")?$=T:O.startsWith("Base directory for this skill:")&&(E=T)}return{running:$,content:E}}),f=k(()=>{const _=u.value.content;if(!_)return"";const o=_.content||"",y=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return o.replace(y,"").trim()}),h=k(()=>f.value.length>0),S=k(()=>f.value?f.value.split(`
`).length:0),m=k(()=>s.toolCall.result?.error||s.toolCall.status==="error"),p=k(()=>{if(!m.value)return"";const _=s.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"}),w=k(()=>`Skill: ${g.value}`),b=k(()=>({skill:g.value})),v=k(()=>s.toolCall.result||null);return e({summary:w,params:b,result:v}),(_,o)=>(i(),r("div",af,[h.value?(i(),r("div",lf,[t("div",{class:"skill-content-header",onClick:d},[t("div",rf,[t("i",{class:H(["bi",c.value?"bi-chevron-down":"bi-chevron-right"])},null,2),o[0]||(o[0]=t("strong",null,"Skill Content",-1)),t("span",cf,"("+x(S.value)+" lines)",1)])]),c.value?(i(),r("div",uf,[t("pre",df,x(f.value),1)])):M("",!0)])):M("",!0),m.value?(i(),r("div",ff,[o[1]||(o[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",mf,[t("pre",pf,x(p.value),1)])])):M("",!0)]))}},hf=te(vf,[["__scopeId","data-v-a314693b"]]),_f={class:"slashcommand-tool-handler"},gf={key:0,class:"tool-section"},bf={class:"d-flex align-items-center gap-2"},yf=["aria-label"],wf={class:"text-muted small"},kf={key:0,class:"command-content-body"},$f={class:"command-content-text"},Sf={key:1,class:"tool-section mt-3"},xf={class:"tool-result tool-result-error"},Cf={class:"tool-code"},Ef={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=Ne(),l=_e(),c=L(!1);function d(){c.value=!c.value}const g=k(()=>s.toolCall.input?.command||"Unknown Command"),u=k(()=>{const _=l.currentSessionId;if(!_)return{running:null,content:null};const o=a.messagesBySession.get(_)||[],y=o.findIndex(D=>D.type==="user"&&D.metadata?.has_tool_results&&D.metadata?.tool_results?.some(T=>T.tool_use_id===s.toolCall.id));if(y===-1)return{running:null,content:null};let $=null,E=null;for(let D=y+1;D<Math.min(y+3,o.length);D++){const T=o[D];if(T.type!=="user")continue;const O=T.content||"";O.includes("<command-message>")&&O.includes("<command-name>")&&O.includes("<command-args>")?$=T:O.includes("ARGUMENTS:")&&(E=T)}return{running:$,content:E}}),f=k(()=>{const _=u.value.content;if(!_)return"";const o=_.content||"",y=/\nARGUMENTS:.*$/s;return o.replace(y,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),h=k(()=>f.value.length>0),S=k(()=>f.value?f.value.split(`
`).length:0),m=k(()=>s.toolCall.result?.error||s.toolCall.status==="error"),p=k(()=>{if(!m.value)return"";const _=s.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"}),w=k(()=>`Slash Command: ${g.value}`),b=k(()=>({command:g.value})),v=k(()=>s.toolCall.result||null);return e({summary:w,params:b,result:v}),(_,o)=>(i(),r("div",_f,[h.value?(i(),r("div",gf,[t("div",{class:"command-content-header",onClick:d},[t("div",bf,[t("span",{"aria-label":c.value?"Collapse":"Expand"},x(c.value?"â–¾":"â–¸"),9,yf),o[0]||(o[0]=t("strong",null,"Command Content",-1)),t("span",wf,"("+x(S.value)+" lines)",1)])]),c.value?(i(),r("div",kf,[t("pre",$f,x(f.value),1)])):M("",!0)])):M("",!0),m.value?(i(),r("div",Sf,[o[1]||(o[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",xf,[t("pre",Cf,x(p.value),1)])])):M("",!0)]))}},Tf=te(Ef,[["__scopeId","data-v-c19378b1"]]),Af={class:"exit-plan-mode-tool-handler"},Df={class:"tool-section"},Mf={key:0,class:"plan-content"},Of={class:"plan-text"},Lf={key:0,class:"tool-section"},If={key:0},Nf={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},Pf={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=k(()=>s.toolCall.input?.plan),l=k(()=>"Exit Plan Mode"),c=k(()=>({plan:a.value})),d=k(()=>s.toolCall.result||null);return e({summary:l,params:c,result:d}),(g,u)=>(i(),r("div",Af,[t("div",Df,[u[1]||(u[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),a.value?(i(),r("div",Mf,[u[0]||(u[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",Of,x(a.value),1)])):M("",!0)]),n.toolCall.result?(i(),r("div",Lf,[n.toolCall.result.success!==!1?(i(),r("div",If,[he(gt,{message:"Permission mode reverted to default"})])):(i(),r("div",Nf," â— "+x(n.toolCall.result.error||"Failed to exit plan mode"),1))])):M("",!0)]))}},jf=te(Pf,[["__scopeId","data-v-fbddfba3"]]),Rf={class:"ask-user-question-handler"},Bf={key:0,class:"answers-summary"},Ff={class:"answer-question text-muted small"},Vf={class:"answer-value fw-medium"},Uf={key:1,class:"text-muted small"},Wf={key:0,class:"questions-container"},Hf={class:"question-header d-flex align-items-center gap-2 mb-2"},qf={key:0,class:"badge bg-secondary"},zf={class:"question-text fw-medium"},Kf={class:"options-list"},Gf=["id","checked","disabled","onChange"],Xf=["id","name","checked","disabled","onChange"],Yf=["for"],Qf={class:"option-label"},Jf={key:0,class:"option-description text-muted d-block small"},Zf={class:"option-item form-check other-option"},em=["id","checked","disabled","onChange"],tm=["id","name","checked","disabled","onChange"],sm=["for"],nm={key:2,class:"other-input mt-2"},om=["onUpdate:modelValue","disabled","onInput"],am={key:1,class:"alert alert-info mb-0"},im={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const a=n,l=s,c=k(()=>a.toolCall.status==="completed"||a.toolCall.result!=null),d=k(()=>{if(!c.value)return{};const T=a.toolCall.result;if(T?.content){if(typeof T.content=="object"&&T.content.answers)return T.content.answers;if(typeof T.content=="string")try{const C=JSON.parse(T.content);if(C.answers)return C.answers}catch{}}const O=a.toolCall.input||{};return O.answers?O.answers:{}}),g=k(()=>Object.keys(d.value).length>0),u=k(()=>(a.toolCall.input||{}).questions||[]),f=L({}),h=L({});fe(u,T=>{T.forEach((O,C)=>{C in f.value||(f.value[C]=O.multiSelect?[]:null),C in h.value||(h.value[C]="")})},{immediate:!0});function S(T,O){const C=f.value[T];return Array.isArray(C)?C.includes(O):C===O}function m(T){const O=f.value[T];return Array.isArray(O)?O.includes("__OTHER__"):O==="__OTHER__"}function p(T,O){f.value[T]=O,o()}function w(T){f.value[T]="__OTHER__",o()}function b(T,O){const C=f.value[T];if(!Array.isArray(C))f.value[T]=[O];else{const A=C.indexOf(O);A===-1?C.push(O):C.splice(A,1)}o()}function v(T){const O=f.value[T];if(!Array.isArray(O))f.value[T]=["__OTHER__"];else{const C=O.indexOf("__OTHER__");C===-1?O.push("__OTHER__"):O.splice(C,1)}o()}function _(T){o()}function o(){const T={};u.value.forEach((O,C)=>{const A=f.value[C],N=O.question;if(O.multiSelect){if(Array.isArray(A)&&A.length>0){const P=A.map(F=>F==="__OTHER__"?h.value[C]||"":F).filter(F=>F);T[N]=P.join(", ")}}else A==="__OTHER__"?T[N]=h.value[C]||"":A&&(T[N]=A)}),l("answer",T)}const y=k(()=>u.value.every((T,O)=>{const C=f.value[O];if(T.multiSelect){if(!Array.isArray(C)||C.length===0||C.includes("__OTHER__")&&!h.value[O])return!1}else if(!C||C==="__OTHER__"&&!h.value[O])return!1;return!0})),$=k(()=>{const T=u.value.length;return T>0?`Question (${T})`:"Question"}),E=k(()=>({questions:u.value.map(T=>T.question)})),D=k(()=>a.toolCall.result||null);return e({allQuestionsAnswered:y,getAnswers:()=>{const T={};return u.value.forEach((O,C)=>{const A=f.value[C],N=O.question;if(O.multiSelect){if(Array.isArray(A)&&A.length>0){const P=A.map(F=>F==="__OTHER__"?h.value[C]||"":F).filter(F=>F);T[N]=P.join(", ")}}else A==="__OTHER__"?T[N]=h.value[C]||"":A&&(T[N]=A)}),T},summary:$,params:E,result:D}),(T,O)=>(i(),r("div",Rf,[c.value?(i(),r(ee,{key:0},[g.value?(i(),r("div",Bf,[(i(!0),r(ee,null,le(d.value,(C,A)=>(i(),r("div",{key:A,class:"answer-item mb-2"},[t("div",Ff,x(A),1),t("div",Vf,x(C),1)]))),128))])):(i(),r("div",Uf," No answers recorded. "))],64)):(i(),r(ee,{key:1},[u.value.length>0?(i(),r("div",Wf,[(i(!0),r(ee,null,le(u.value,(C,A)=>(i(),r("div",{key:A,class:"question-block mb-3"},[t("div",Hf,[C.header?(i(),r("span",qf,x(C.header),1)):M("",!0),t("span",zf,x(C.question),1)]),t("div",Kf,[(i(!0),r(ee,null,le(C.options,(N,P)=>(i(),r("div",{key:P,class:H(["option-item form-check",{selected:S(A,N.label)}])},[C.multiSelect?(i(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-opt${P}`,checked:S(A,N.label),disabled:n.disabled,onChange:F=>b(A,N.label)},null,40,Gf)):(i(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-opt${P}`,name:`question-${A}`,checked:S(A,N.label),disabled:n.disabled,onChange:F=>p(A,N.label)},null,40,Xf)),t("label",{class:"form-check-label",for:`q${A}-opt${P}`},[t("span",Qf,x(N.label),1),N.description?(i(),r("span",Jf,x(N.description),1)):M("",!0)],8,Yf)],2))),128)),t("div",Zf,[C.multiSelect?(i(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-other`,checked:m(A),disabled:n.disabled,onChange:N=>v(A)},null,40,em)):(i(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-other`,name:`question-${A}`,checked:m(A),disabled:n.disabled,onChange:N=>w(A)},null,40,tm)),t("label",{class:"form-check-label",for:`q${A}-other`},[...O[0]||(O[0]=[t("span",{class:"option-label"},"Other",-1)])],8,sm),m(A)?(i(),r("div",nm,[$e(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":N=>h.value[A]=N,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:N=>_()},null,40,om),[[De,h.value[A]]])])):M("",!0)])])]))),128))])):(i(),r("div",am," No questions to display. "))],64))]))}},Uo=te(im,[["__scopeId","data-v-95a4b4e5"]]),lm={class:"timeline-detail"},rm={key:0,class:"detail-banner detail-banner-warning"},cm={class:"permission-status"},um={key:0,class:"permission-changes"},dm={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,{effectiveStatus:s,isOrphaned:a,orphanedInfo:l}=yn(Le(e,"toolCall")),c=L(null),d={Read:Ll,Write:Zl,Bash:fr,TodoWrite:Tr,Edit:Gr,Grep:Un,Glob:Un,WebFetch:Wn,WebSearch:Wn,Task:Zc,TaskCreate:pu,TaskUpdate:Ru,TaskList:Zu,TaskGet:$d,NotebookEdit:Vd,BashOutput:Hn,KillShell:Hn,SlashCommand:Tf,Skill:hf,ExitPlanMode:jf,AskUserQuestion:Uo},g=k(()=>d[e.toolCall.name]||dl),u=k(()=>e.toolCall.name==="AskUserQuestion"),f=k(()=>e.toolCall.permissionDecision!=null&&s.value!=="permission_required"),h=k(()=>e.toolCall.appliedUpdates&&e.toolCall.appliedUpdates.length>0),S=k(()=>e.toolCall.permissionDecision==="allow"?"âœ“":"âœ—"),m=k(()=>e.toolCall.permissionDecision==="allow"?"#22c55e":"#ef4444"),p=k(()=>e.toolCall.permissionDecision==="allow"?"Approved by user":"Denied by user"),w=k(()=>e.toolCall.permissionDecision==="allow"?"permission-approved":"permission-denied");function b(v){return v.type==="setMode"?`Set mode: ${v.mode}`:v.type==="addRules"&&v.rules?.length?`Allow: ${v.rules.map(o=>o.ruleContent?`${o.toolName}(${o.ruleContent})`:o.toolName).join(", ")}`:v.type==="addDirectories"&&v.directories?.length?`Add directories: ${v.directories.join(", ")}`:JSON.stringify(v)}return(v,_)=>(i(),r("div",lm,[W(a)?(i(),r("div",rm,[_[1]||(_[1]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[_[0]||(_[0]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,x(W(l)?.message||"Session was terminated"),1)])])):M("",!0),f.value?(i(),r("div",{key:1,class:H(["permission-details",w.value])},[t("div",cm,[t("span",{class:"permission-status-icon",style:Pe({color:m.value})},x(S.value),5),t("span",null,x(p.value),1)]),h.value?(i(),r("div",um,[_[2]||(_[2]=t("span",{class:"changes-label"},"Permission rules added:",-1)),t("ul",null,[(i(!0),r(ee,null,le(n.toolCall.appliedUpdates,(o,y)=>(i(),r("li",{key:y},x(b(o)),1))),128))])])):M("",!0)],2)):M("",!0),u.value&&W(s)==="permission_required"?M("",!0):(i(),Ee(No(g.value),{key:2,ref_key:"handlerRef",ref:c,toolCall:n.toolCall},null,8,["toolCall"]))]))}},fm=te(dm,[["__scopeId","data-v-8662cc99"]]),Ge=Qe("project",()=>{const n=L(new Map),e=L(null),s=k(()=>n.value.get(e.value)),a=k(()=>Array.from(n.value.values()).sort((_,o)=>_.order-o.order));async function l(){try{const _=await ve.get("/api/projects");return n.value.clear(),_.projects.forEach(o=>{n.value.set(o.project_id,o)}),console.log(`Loaded ${n.value.size} projects`),_.projects}catch(_){throw console.error("Failed to fetch projects:",_),_}}async function c(_,o){try{const $=(await ve.post("/api/projects",{name:_,working_directory:o})).project;return n.value.set($.project_id,$),n.value=new Map(n.value),console.log(`Created project ${$.project_id}`),$}catch(y){throw console.error("Failed to create project:",y),y}}async function d(_,o){try{await ve.put(`/api/projects/${_}`,o),g(_,o),console.log(`Updated project ${_}`,o)}catch(y){throw console.error("Failed to update project:",y),y}}function g(_,o){const y=n.value.get(_);y&&(Object.assign(y,o),n.value=new Map(n.value))}async function u(_){try{await ve.delete(`/api/projects/${_}`),n.value.delete(_),n.value=new Map(n.value),e.value===_&&(e.value=null),console.log(`Deleted project ${_}`)}catch(o){throw console.error("Failed to delete project:",o),o}}async function f(_){try{const o=await ve.put(`/api/projects/${_}/toggle-expansion`),y=n.value.get(_);return y&&(y.is_expanded=o.is_expanded,n.value=new Map(n.value)),o.is_expanded}catch(o){throw console.error("Failed to toggle expansion:",o),o}}async function h(_){try{await ve.put("/api/projects/reorder",{project_ids:_}),_.forEach((o,y)=>{const $=n.value.get(o);$&&($.order=y)}),n.value=new Map(n.value),console.log("Reordered projects",_)}catch(o){throw console.error("Failed to reorder projects:",o),o}}async function S(_,o){try{await ve.put(`/api/projects/${_}/sessions/reorder`,{session_ids:o});const y=n.value.get(_);y&&(y.session_ids=o,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${_}`,o)}catch(y){throw console.error("Failed to reorder sessions:",y),y}}function m(_,o){const y=n.value.get(_);if(!y||!y.session_ids||y.session_ids.length===0)return[{status:"none",flex:1}];const $=new Set,E=new Map;for(const A of y.session_ids){const N=o.getSession(A);if(N&&(E.set(A,N),N.child_minion_ids))for(const P of N.child_minion_ids)$.add(P)}const D=Array.from(E.values()).filter(A=>!$.has(A.session_id)).sort((A,N)=>(A.order||0)-(N.order||0));if(D.length===0&&E.size===0)return[{status:"none",flex:1}];function T(A){return A.state==="active"&&A.is_processing?"active":A.state==="active"?"idle":A.state==="paused"?"waiting":A.state==="error"?"error":"none"}function O(A,N){if(N.push({status:T(A),flex:1}),A.child_minion_ids)for(const P of A.child_minion_ids){const F=E.get(P);F&&O(F,N)}}const C=[];for(const A of D)O(A,C);return C.length>0?C:[{status:"none",flex:1}]}function p(_){return n.value.get(_)}function w(_){e.value=_}function b(){e.value=null}function v(_){if(!_)return"";const o=_.split(/[/\\]/).filter(y=>y);return o.length===0?"/":o.length===1?`/${o[0]}`:o.length===2?`/${o.join("/")}`:`.../${o.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:a,fetchProjects:l,createProject:c,updateProject:d,updateProjectLocal:g,deleteProject:u,toggleExpansion:f,reorderProjects:h,reorderSessionsInProject:S,getProject:p,getStatusBarSegments:m,selectProject:w,clearProjectSelection:b,formatPath:v}}),qn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Hs={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},st=Qe("resource",()=>{const n=L(new Map),e=L(!1),s=L(0),a=L(null),l=L(!1),c=L(new Map);function d(J){if(!J)return!1;if(J.is_image===!0||(J.mime_type||"").toLowerCase().startsWith("image/"))return!0;const ye=(J.format||"").toLowerCase();if(ye.startsWith("image/")||qn.has("."+ye))return!0;const we=J.original_filename||J.original_name||"";if(we){const Ae="."+we.split(".").pop().toLowerCase();return qn.has(Ae)}return!1}function g(J){if(!J||d(J))return!1;const de=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),ye=J.original_filename||J.original_name||"";if(ye){const Ae="."+ye.split(".").pop().toLowerCase();if(de.has(Ae))return!0}const we=(J.mime_type||J.format||"").toLowerCase();return!!(we.startsWith("text/")||we==="application/json"||we==="application/xml")}function u(J){if(d(J))return"ðŸ–¼ï¸";if(J.original_filename){const de="."+J.original_filename.split(".").pop().toLowerCase();return Hs[de]||Hs.default}return Hs.default}function f(J){return J.original_filename?"."+J.original_filename.split(".").pop().toLowerCase():""}function h(J){const de=n.value.get(J);return de||[]}function S(J){return n.value.get(J)?.length||0}function m(J){return S(J)>0}function p(J){return h(J).filter(d)}function w(J){return p(J).length}function b(J){return w(J)>0}const v=k(()=>{const J=_e();return h(J.currentSessionId)}),_=k(()=>{const J=_e();return S(J.currentSessionId)}),o=k(()=>_.value>0),y=k(()=>v.value.filter(d)),$=k(()=>y.value.length),E=k(()=>$.value>0),D=k(()=>!e.value||!a.value?null:h(a.value)[s.value]||null),T=D,O=k(()=>a.value?S(a.value):0),C=O;async function A(J){if(J){l.value=!0;try{const ye=(await os(`/api/sessions/${J}/resources`)).resources||[];ye.sort((we,Ae)=>(we.timestamp||0)-(Ae.timestamp||0)),n.value.set(J,ye),n.value=new Map(n.value),console.log(`Loaded ${ye.length} resources for session ${J}`)}catch(de){console.error(`Failed to load resources for session ${J}:`,de),n.value.set(J,[]),n.value=new Map(n.value)}finally{l.value=!1}}}const N=A;function P(J,de){if(!J||!de)return;let ye=n.value.get(J);ye||(ye=[],n.value.set(J,ye));const we=ye.findIndex(Ae=>Ae.resource_id===de.resource_id);we>=0?ye[we]=de:ye.push(de),ye.sort((Ae,rt)=>(Ae.timestamp||0)-(rt.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${de.resource_id} to session ${J}`)}const F=P;function V(J,de){return`/api/sessions/${J}/resources/${de}`}const X=V;function j(J,de){return`/api/sessions/${J}/resources/${de}/download`}function I(J,de=0){a.value=J,s.value=Math.max(0,Math.min(de,S(J)-1)),e.value=!0}function G(){e.value=!1}function q(){if(!a.value)return;const J=S(a.value);J!==0&&(s.value=(s.value+1)%J)}const Z=q;function K(){if(!a.value)return;const J=S(a.value);J!==0&&(s.value=(s.value-1+J)%J)}const pe=K;function re(J){if(!a.value)return;const de=S(a.value);de!==0&&(s.value=Math.max(0,Math.min(J,de-1)))}const ge=re;function be(J){n.value.delete(J),n.value=new Map(n.value),a.value===J&&G(),console.log(`Cleared resources for session ${J}`)}const z=be;async function R(J,de){if(!(!J||!de))try{await Fo(`/api/sessions/${J}/resources/${de}`),se(J,de)}catch(ye){console.error(`Failed to remove resource ${de}:`,ye)}}function U(J,de){se(J,de)}function se(J,de){const ye=n.value.get(J);if(!ye)return;const we=ye.findIndex(Ae=>Ae.resource_id===de);we!==-1&&(ye.splice(we,1),n.value=new Map(n.value),e.value&&a.value===J&&(ye.length===0?G():s.value>=ye.length&&(s.value=ye.length-1)),c.value.delete(de),c.value=new Map(c.value))}async function Y(J,de){if(!J||!de)return null;const ye=c.value.get(de);if(ye&&!ye.error)return ye.content;c.value.set(de,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const we=V(J,de),Ae=await fetch(we);if(!Ae.ok)throw new Error(`HTTP ${Ae.status}`);const rt=await Ae.text();return c.value.set(de,{content:rt,loading:!1,error:null}),c.value=new Map(c.value),rt}catch(we){return console.error(`Failed to fetch text content for resource ${de}:`,we),c.value.set(de,{content:null,loading:!1,error:we.message}),c.value=new Map(c.value),null}}function oe(J){return c.value.get(J)||null}function Se(J){if(J){const de=n.value.get(J);de&&(de.forEach(ye=>c.value.delete(ye.resource_id)),c.value=new Map(c.value))}else c.value=new Map}function lt(J,de){const ye=n.value.get(J);return ye&&ye.find(we=>we.resource_id===de)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:a,loading:l,textContentCache:c,currentResources:v,currentResourceCount:_,currentHasResources:o,currentFullViewResource:D,fullViewTotalResources:O,currentImages:y,currentImageCount:$,currentHasImages:E,currentFullViewImage:T,fullViewTotalImages:C,imagesBySession:n,resourcesForSession:h,resourceCount:S,hasResources:m,getResourceUrl:V,getDownloadUrl:j,isImageResource:d,isTextResource:g,getResourceIcon:u,getResourceExtension:f,getResourceById:lt,getTextContent:oe,imagesForSession:p,imageCount:w,hasImages:b,getImageUrl:X,loadResources:A,addResource:P,removeResource:R,handleResourceRemoved:U,openFullView:I,closeFullView:G,nextResource:q,prevResource:K,goToResource:re,clearResources:be,fetchTextContent:Y,clearTextCache:Se,loadImages:N,addImage:F,nextImage:Z,prevImage:pe,goToImage:ge,clearImages:z}}),mm=st,pm=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:mm,useResourceStore:st},Symbol.toStringTag,{value:"Module"})),Wo=Qe("queue",()=>{const n=L(new Map),e=L(new Map);function s(p){return n.value.get(p)||[]}function a(p){return s(p).filter(w=>w.status==="pending").length}function l(p){return e.value.get(p)||!1}async function c(p){try{const w=await ve.get(`/api/sessions/${p}/queue`);return n.value.set(p,w.items||[]),n.value=new Map(n.value),w.items}catch(w){return console.error("Failed to fetch queue:",w),[]}}async function d(p,w,b=null,v=null){try{const _={content:w};return b!==null&&(_.reset_session=b),v!==null&&(_.metadata=v),(await ve.post(`/api/sessions/${p}/queue-message`,_)).item}catch(_){throw console.error("Failed to enqueue message:",_),_}}async function g(p,w){try{return(await ve.delete(`/api/sessions/${p}/queue/${w}`)).item}catch(b){throw console.error("Failed to cancel queue item:",b),b}}async function u(p,w){try{return(await ve.post(`/api/sessions/${p}/queue/${w}/requeue`)).item}catch(b){throw console.error("Failed to requeue item:",b),b}}async function f(p){try{return(await ve.delete(`/api/sessions/${p}/queue`)).cancelled_count}catch(w){throw console.error("Failed to clear queue:",w),w}}async function h(p,w){try{const b=await ve.put(`/api/sessions/${p}/queue/pause`,{paused:w});return e.value.set(p,w),e.value=new Map(e.value),b}catch(b){throw console.error("Failed to pause/resume queue:",b),b}}function S(p,w){const b=w.action;w.item,w.pending_count,c(p),b==="paused"?(e.value.set(p,!0),e.value=new Map(e.value)):b==="resumed"&&(e.value.set(p,!1),e.value=new Map(e.value))}function m(p,w){e.value.set(p,w),e.value=new Map(e.value)}return{queuesBySession:n,pausedBySession:e,getItems:s,getPendingCount:a,isPaused:l,fetchQueue:c,enqueueMessage:d,cancelItem:g,requeueItem:u,clearQueue:f,pauseQueue:h,handleQueueUpdate:S,updatePauseState:m}}),it=Qe("websocket",()=>{const n=L(null),e=L(!1),s=L(0),a=10,l=L(null),c=L(!1),d=L(0),g=5,u=L(null);let f=null;const h=L(0),S=L(null),m=L(new Map),p=L(null),w=L(!1),b=L(0),v=5,_=L(null),o=1e4,y=1e3,$=L(Date.now()),E=L(Date.now()),D=L(Date.now());let T=null,O=null,C=null;const A=k(()=>e.value&&(c.value||!u.value)?"connected":e.value?"partial":"disconnected");function N(R){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${R}`}function P(R){const U={ui:{timer:()=>T,setTimer:se=>{T=se},lastPing:$,connected:e,name:"UI"},session:{timer:()=>O,setTimer:se=>{O=se},lastPing:E,connected:c,name:"Session"},legion:{timer:()=>C,setTimer:se=>{C=se},lastPing:D,connected:w,name:"Legion"}}[R];U.timer()&&clearInterval(U.timer()),U.setTimer(setInterval(()=>{if(!U.connected.value)return;const se=Date.now()-U.lastPing.value;if(se>o){console.warn(`âš ï¸ ${U.name} WebSocket heartbeat timeout (${se}ms since last ping) - forcing close to trigger reconnection`),U.connected.value=!1;const oe={ui:n,session:l,legion:p}[R];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},y)),console.log(`âœ… Started heartbeat monitor for ${U.name} WebSocket`)}function F(R){const U={ui:{get:()=>T,set:se=>{T=se}},session:{get:()=>O,set:se=>{O=se}},legion:{get:()=>C,set:se=>{C=se}}}[R];U.get()&&(clearInterval(U.get()),U.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${R} WebSocket`))}function V(){if(n.value)return;const R=N("/ws/ui");console.log(`Connecting to UI WebSocket: ${R}`),n.value=new WebSocket(R),n.value.onopen=()=>{e.value=!0,s.value=0,$.value=Date.now(),P("ui"),console.log("UI WebSocket connected")},n.value.onmessage=U=>{const se=JSON.parse(U.data);pe(se)},n.value.onclose=()=>{if(F("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<a){s.value++;const U=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${U}ms (attempt ${s.value})`),setTimeout(V,U)}},n.value.onerror=U=>{console.error("UI WebSocket error:",U)}}function X(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function j(R){h.value++;const U=h.value;if(console.log(`[Gen ${U}] Starting connection to session ${R}`),f&&(clearTimeout(f),f=null),await I(),h.value!==U){console.log(`[Gen ${U}] Connection cancelled (current generation: ${h.value})`);return}u.value=R,S.value=U;const se=N(`/ws/session/${R}`);console.log(`[Gen ${U}] Connecting to Session WebSocket: ${se}`),l.value=new WebSocket(se),l.value.onopen=async()=>{if(S.value!==U){console.log(`[Gen ${U}] Ignoring onopen (stale connection, current: ${S.value})`),l.value.close();return}c.value=!0,d.value=0,E.value=Date.now(),P("session"),console.log(`[Gen ${U}] Session WebSocket connected for ${R}`);const Y=m.value.get(R);if(m.value.set(R,!0),Y){console.log(`[Gen ${U}] Reconnection detected, syncing missed messages...`);try{const Se=await Ne().syncMessages(R);Se.syncedCount>0?console.log(`[Gen ${U}] âœ… Synced ${Se.syncedCount} missed messages`):Se.error?console.warn(`[Gen ${U}] âš ï¸ Message sync failed: ${Se.error}`):console.log(`[Gen ${U}] No missed messages to sync`),Se.hasMore&&console.warn(`[Gen ${U}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${U}] Error during message sync:`,oe)}}else console.log(`[Gen ${U}] Initial connection, no sync needed`)},l.value.onmessage=Y=>{if(S.value!==U){console.log(`[Gen ${U}] Ignoring message (stale connection, current: ${S.value})`);return}const oe=JSON.parse(Y.data);re(oe,R)},l.value.onclose=()=>{F("session"),c.value=!1,l.value=null,console.log(`[Gen ${U}] Session WebSocket closed for ${R}`);const Y=_e();if(Y.currentSessionId===R&&S.value===U&&d.value<g){d.value++;const oe=Math.min(2e3*d.value,3e4);console.log(`[Gen ${U}] Reconnecting Session WebSocket in ${oe}ms (attempt ${d.value})`),f=setTimeout(()=>{S.value===U&&Y.currentSessionId===R?(f=null,j(R)):console.log(`[Gen ${U}] Skipping reconnect (generation or session changed)`)},oe)}},l.value.onerror=Y=>{console.error(`[Gen ${U}] Session WebSocket error:`,Y)}}function I(){return new Promise(R=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),l.value){const U=u.value,se=()=>{l.value=null,c.value=!1,u.value=null,S.value=null,d.value=0,U&&m.value.delete(U),R()};if(l.value.readyState===WebSocket.CLOSED)se();else{const Y=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),se()},2e3);l.value.addEventListener("close",()=>{clearTimeout(Y),se()},{once:!0}),l.value.close()}}else u.value=null,S.value=null,R()})}function G(R){l.value&&c.value?(l.value.send(JSON.stringify({type:"send_message",content:R})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function q(R,U,se=!1,Y=null,oe=null){if(l.value&&c.value){const Se={type:"permission_response",request_id:R,decision:U,apply_suggestions:se,timestamp:new Date().toISOString()};Y&&(Se.clarification_message=Y),oe&&(Se.selected_suggestions=oe),l.value.send(JSON.stringify(Se)),console.log(`Sent permission ${U} for request ${R}`,{applySuggestions:se,clarification:Y,selectedSuggestions:oe})}}function Z(R,U,se){if(l.value&&c.value){const Y={type:"permission_response",request_id:R,decision:U,updated_input:se,timestamp:new Date().toISOString()};l.value.send(JSON.stringify(Y)),console.log(`Sent permission ${U} with updated_input for request ${R}`,se)}}function K(){l.value&&c.value&&(l.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function pe(R){const U=_e(),se=Ge();switch(R.type){case"sessions_list":R.sessions&&Array.isArray(R.sessions)&&R.sessions.forEach(Y=>{U.updateSession(Y.session_id,Y)});break;case"state_change":if(R.data&&R.data.session_id&&R.data.session){U.updateSession(R.data.session_id,R.data.session);const Y=R.data.session_id,oe=R.data.session.state;Y===U.currentSessionId&&oe==="active"&&!c.value&&(console.log(`[UI state_change] Session ${Y} became active, reconnecting session WebSocket`),d.value=0,j(Y)),Y===U.currentSessionId&&oe==="error"&&(console.log(`[UI state_change] Session ${Y} entered error state, reloading messages`),Ne().loadMessages(Y))}break;case"session_reset":{const Y=R.data?.session_id;Y&&(console.log(`[UI session_reset] Clearing messages for session ${Y}`),Ne().clearMessages(Y));break}case"project_updated":if(R.data&&R.data.project){const Y=R.data.project;se.updateProjectLocal(Y.project_id,Y),U.fetchSessions()}break;case"project_deleted":R.data&&R.data.project_id&&se.projects.delete(R.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":$.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",R.type)}}function re(R,U){const se=_e();if(se.currentSessionId!==U){console.warn(`Ignoring message for session ${U} (current: ${se.currentSessionId})`);return}const Y=Ne();switch(R.type){case"message":const oe=R.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",R);break}if(oe.type==="tool_call"){Y.handleToolCall(U,oe);break}oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&se.storeInitData(U,oe.metadata.init_data),Y.addMessage(U,oe);break;case"state_change":se.updateSession(U,R.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${U}`);break;case"ping":E.value=Date.now(),l.value?.readyState===WebSocket.OPEN&&l.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":R.resource&&(st().addResource(U,R.resource),console.log(`Resource registered for session ${U}:`,R.resource.resource_id));break;case"resource_removed":R.resource_id&&(st().handleResourceRemoved(U,R.resource_id),console.log(`Resource removed for session ${U}:`,R.resource_id));break;case"image_registered":R.image&&(st().addResource(U,{...R.image,resource_id:R.image.image_id}),console.log(`Image registered (legacy) for session ${U}:`,R.image.image_id));break;case"queue_update":{Wo().handleQueueUpdate(U,R);break}default:console.warn("Unknown Session WebSocket message type:",R.type)}}function ge(R){be(),_.value=R;const U=N(`/ws/legion/${R}`);console.log(`Connecting to Legion WebSocket: ${U}`),p.value=new WebSocket(U),p.value.onopen=()=>{w.value=!0,b.value=0,D.value=Date.now(),P("legion"),console.log(`Legion WebSocket connected for ${R}`)},p.value.onmessage=se=>{const Y=JSON.parse(se.data);z(Y,R)},p.value.onclose=()=>{if(F("legion"),w.value=!1,p.value=null,console.log(`Legion WebSocket closed for ${R}`),_.value===R&&b.value<v){b.value++;const se=Math.min(2e3*b.value,3e4);setTimeout(()=>ge(R),se)}},p.value.onerror=se=>{console.error("Legion WebSocket error:",se)}}function be(){p.value&&(p.value.close(),p.value=null,w.value=!1,_.value=null)}function z(R,U){Ie(async()=>{const{useLegionStore:se}=await Promise.resolve().then(()=>qp);return{useLegionStore:se}},void 0).then(({useLegionStore:se})=>{const Y=se();switch(R.type){case"comm":R.comm&&(Y.addComm(U,R.comm),console.log("Legion WebSocket: Received new comm",R.comm));break;case"minion_created":R.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",R.data),Ie(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>Bn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":R.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",R.data),Ie(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>Bn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"schedule_updated":Ie(async()=>{const{useScheduleStore:oe}=await Promise.resolve().then(()=>T_);return{useScheduleStore:oe}},void 0).then(({useScheduleStore:oe})=>{oe().handleScheduleEvent(U,R)});break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${U}`);break;case"ping":D.value=Date.now(),p.value?.readyState===WebSocket.OPEN&&p.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",R.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:c,sessionRetryCount:d,legionConnected:w,legionRetryCount:b,currentLegionId:_,overallStatus:A,connectUI:V,disconnectUI:X,connectSession:j,disconnectSession:I,sendMessage:G,sendPermissionResponse:q,sendPermissionResponseWithInput:Z,interruptSession:K,connectLegion:ge,disconnectLegion:be}}),vm=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:it},Symbol.toStringTag,{value:"Module"})),hm={class:"permission-prompt"},_m={key:0,class:"permission-section"},gm={class:"permission-buttons"},bm=["disabled"],ym=["disabled"],wm={class:"detail-banner detail-banner-warning"},km={key:0,class:"suggestions-section"},$m=["id","onUpdate:modelValue","disabled"],Sm=["for"],xm={class:"permission-buttons"},Cm=["disabled"],Em=["disabled"],Tm=["disabled"],Am={class:"guidance-section"},Dm=["disabled"],Mm=["disabled"],Om={key:1,class:"detail-banner detail-banner-warning"},Lm={__name:"PermissionPrompt",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ne(),a=_e(),l=it(),{effectiveStatus:c,isOrphaned:d,orphanedInfo:g}=yn(Le(e,"toolCall")),u=L(!1),f=L(null),h=L(""),S=L(!1),m=L(null),p=L({}),w=L(null),b=L({});fe(()=>e.toolCall.suggestions,A=>{if(A&&A.length>0){const N={};A.forEach((P,F)=>{N[F]=!0}),p.value=N}},{immediate:!0});const v=k(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((A,N)=>p.value[N]):[]),_=k(()=>e.toolCall.name==="AskUserQuestion"),o=k(()=>!_.value||!w.value?!1:w.value.allQuestionsAnswered),y=k(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function $(A){b.value=A}async function E(){if(!(u.value||!w.value)){u.value=!0,f.value="submit-answers";try{const A=a.currentSessionId,N=w.value.getAnswers(),P={questions:e.toolCall.input?.questions||[],answers:N};A&&(s.updateToolCall(A,e.toolCall.id,{input:P}),s.handlePermissionResponse(A,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await l.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",P)}catch(A){console.error("Failed to submit question answers:",A)}finally{u.value=!1,f.value=null}}}async function D(A,N,P=null){if(u.value)return;u.value=!0;const F=v.value,V=N&&F.length>0;A==="allow"?f.value=V?"approve-apply":"approve":P?f.value="deny-guidance":f.value="deny";try{const X=a.currentSessionId;if(X){const j=V?F:[];s.handlePermissionResponse(X,{request_id:e.toolCall.permissionRequestId,decision:A,reasoning:A==="allow"?"User allowed permission":"User denied permission",applied_updates:j})}await l.sendPermissionResponse(e.toolCall.permissionRequestId,A,V,P,V?F:null)}catch(X){console.error("Failed to send permission response:",X)}finally{u.value=!1,f.value=null}}function T(A){return A.type==="setMode"?`Set mode: ${A.mode}`:A.type==="addRules"&&A.rules?.length?`Allow: ${A.rules.map(P=>P.ruleContent?`${P.toolName}(${P.ruleContent})`:P.toolName).join(", ")}`:A.type==="addDirectories"&&A.directories?.length?`Add directories: ${A.directories.join(", ")}`:JSON.stringify(A)}function O(){S.value=!0,Fe(()=>{m.value?.focus()})}function C(){const A=m.value;if(!A)return;A.style.height="auto";const N=parseFloat(getComputedStyle(A).lineHeight)*6+10;A.style.height=Math.min(A.scrollHeight,N)+"px"}return(A,N)=>(i(),r("div",hm,[W(c)==="permission_required"&&!W(d)?(i(),r("div",_m,[_.value?(i(),r(ee,{key:0},[N[6]||(N[6]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),he(Uo,{ref_key:"questionHandlerRef",ref:w,toolCall:n.toolCall,disabled:u.value,onAnswer:$},null,8,["toolCall","disabled"]),t("div",gm,[t("button",{class:"btn-timeline btn-primary",onClick:E,disabled:u.value||!o.value},x(u.value?"Submitting...":"Submit Answers"),9,bm),t("button",{class:"btn-timeline btn-secondary",onClick:N[0]||(N[0]=P=>D("deny",!1)),disabled:u.value}," Skip ",8,ym)])],64)):(i(),r(ee,{key:1},[t("div",wm,[N[8]||(N[8]=t("strong",null,"Permission Required",-1)),t("p",null,[N[7]||(N[7]=ue("Claude wants to use ",-1)),t("code",null,x(n.toolCall.name),1)])]),y.value?(i(),r("div",km,[N[9]||(N[9]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(i(!0),r(ee,null,le(n.toolCall.suggestions,(P,F)=>(i(),r("div",{key:F,class:"suggestion-item"},[$e(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${F}`,"onUpdate:modelValue":V=>p.value[F]=V,disabled:u.value},null,8,$m),[[_n,p.value[F]]]),t("label",{for:`sg-${n.toolCall.id}-${F}`},[t("code",null,x(T(P)),1)],8,Sm)]))),128))])):M("",!0),t("div",xm,[y.value?(i(),r("button",{key:0,class:"btn-timeline btn-approve",onClick:N[1]||(N[1]=P=>D("allow",!0)),disabled:u.value},x(u.value&&f.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,Cm)):M("",!0),t("button",{class:H(["btn-timeline",y.value?"btn-approve-outline":"btn-approve"]),onClick:N[2]||(N[2]=P=>D("allow",!1)),disabled:u.value},x(y.value?"Approve Only":"Approve"),11,Em),t("button",{class:"btn-timeline btn-deny",onClick:N[3]||(N[3]=P=>D("deny",!1)),disabled:u.value}," Deny ",8,Tm)]),t("div",Am,[S.value?M("",!0):(i(),r("a",{key:0,href:"#",class:"guidance-link",onClick:ae(O,["prevent"])}," Add guidance... ")),S.value?(i(),r(ee,{key:1},[$e(t("textarea",{ref_key:"guidanceTextarea",ref:m,"onUpdate:modelValue":N[4]||(N[4]=P=>h.value=P),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:u.value,onInput:C},null,40,Dm),[[De,h.value]]),h.value.trim()?(i(),r("button",{key:0,class:"btn-timeline btn-guidance",onClick:N[5]||(N[5]=P=>D("deny",!1,h.value)),disabled:u.value}," Provide Guidance & Continue ",8,Mm)):M("",!0)],64)):M("",!0)])],64))])):M("",!0),W(c)==="permission_required"&&W(d)?(i(),r("div",Om,[N[10]||(N[10]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,x(W(g)?.message||"Session was terminated before permission could be granted"),1)])):M("",!0)]))}},Im=te(Lm,[["__scopeId","data-v-3c811f61"]]),Nm={class:"timeline-row"},Pm={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=Ce(),a=L(null),l=L({}),c=L(null);function d(m,p){p&&(l.value[m]=p)}const g=k(()=>[...e.tools].map((m,p)=>({tool:m,originalIndex:p})).sort((m,p)=>{if(m.tool.timestamp&&p.tool.timestamp){const w=new Date(m.tool.timestamp).getTime(),b=new Date(p.tool.timestamp).getTime();if(w!==b)return w-b}return m.originalIndex-p.originalIndex}).map(({tool:m})=>m)),u=k(()=>a.value?g.value.find(m=>m.id===a.value):null),f=k(()=>u.value?vs(u.value)==="permission_required":!1);fe(f,m=>{m&&s.autoScrollEnabled&&Fe(()=>{c.value?.$el?.scrollIntoView({block:"nearest",behavior:"smooth"})})}),fe(g,m=>{const p=m.find(w=>vs(w)==="permission_required");if(p)a.value=p.id;else if(a.value){const w=m.find(b=>b.id===a.value);w&&vs(w)!=="permission_required"&&(a.value=null)}},{deep:!0,immediate:!0});function h(m){const p=l.value[m.id];if(p?.statusColor)return p.statusColor;const w=vs(m);return Ki(w,m)}function S(m){a.value===m?a.value=null:a.value=m}return(m,p)=>g.value.length>0?(i(),r("div",{key:0,class:H(["activity-timeline",{"timeline-mobile":W(s).isMobile}])},[t("div",Nm,[(i(!0),r(ee,null,le(g.value,(w,b)=>(i(),r(ee,{key:w.id},[b>0?(i(),Ee(sl,{key:0,leftColor:h(g.value[b-1]),rightColor:h(w),compact:W(s).isMobile},null,8,["leftColor","rightColor","compact"])):M("",!0),he(el,{ref_for:!0,ref:v=>d(w.id,v),tool:w,isExpanded:a.value===w.id,compact:W(s).isMobile,onClick:v=>S(w.id)},null,8,["tool","isExpanded","compact","onClick"])],64))),128))]),a.value&&u.value?(i(),Ee(fm,{key:0,toolCall:u.value},null,8,["toolCall"])):M("",!0),u.value&&f.value?(i(),Ee(Im,{key:1,ref_key:"permissionRef",ref:c,toolCall:u.value},null,8,["toolCall"])):M("",!0)],2)):M("",!0)}},jm=te(Pm,[["__scopeId","data-v-c81452fc"]]),Rm={class:"msg-wrapper msg-assistant"},Bm={class:"msg-meta"},Fm={class:"msg-time"},Vm={class:"msg-bubble msg-bubble-assistant"},Um={key:0,class:"thinking-block mb-2"},Wm=["innerHTML"],Hm={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ne(),a=_e();Ye.setOptions({breaks:!0,gfm:!0});const l=k(()=>rs(e.message.timestamp)),c=k(()=>{const m=e.message.content||"";return m.trim().length>0&&m!=="Assistant response"}),d=k(()=>{const m=e.message.content||"";let p=Ye.parse(m);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),qt.sanitize(p)}),g=k(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=k(()=>e.message.metadata?.thinking_content||""),f=k(()=>{const m=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,p=e.attachedTools&&e.attachedTools.length>0;return m||p}),h=k(()=>{const m=e.message.metadata?.tool_uses||[],p=e.attachedTools||[],w=[...m],b=new Set(m.map(v=>v.id));for(const v of p)b.has(v.id)||w.push(v);return w}),S=k(()=>{const m=a.currentSessionId;if(!m)return[];const p=s.toolCallsBySession.get(m)||[];return h.value.map(w=>{const b=p.find(v=>v.id===w.id);return b||{id:w.id,name:w.name,input:w.input,status:"pending",result:null,timestamp:w.timestamp||e.message.timestamp,isExpanded:!0}})});return(m,p)=>(i(),r("div",Rm,[t("div",Bm,[p[0]||(p[0]=t("span",{class:"msg-role"},"assistant",-1)),t("span",Fm,x(l.value),1)]),t("div",Vm,[g.value?(i(),r("div",Um,[he(qi,{thinking:u.value},null,8,["thinking"])])):M("",!0),c.value?(i(),r("div",{key:1,class:"msg-text",innerHTML:d.value},null,8,Wm)):M("",!0),f.value?(i(),Ee(jm,{key:2,tools:S.value,messageId:n.message.id},null,8,["tools","messageId"])):M("",!0)])]))}},qm=te(Hm,[["__scopeId","data-v-2f57d076"]]),zm={class:"msg-wrapper msg-system"},Km={key:0,class:"pill-icon"},Gm={key:1,class:"pill-icon"},Xm={class:"pill-text"},Ym={class:"pill-time"},Qm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>rs(e.message.timestamp)),a=k(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting"),l=k(()=>{const d=e.message.metadata?.subtype;return d==="stderr"||d==="session_failed"}),c=k(()=>{if(a.value)return"Context compaction in progress...";const d=e.message.content||"",g=l.value?200:80;return d.length>g?d.substring(0,g-3)+"...":d});return(d,g)=>(i(),r("div",zm,[t("div",{class:H(["msg-pill",{"pill-compaction":a.value,"pill-stderr":l.value}])},[l.value?(i(),r("span",Km,"âš ï¸")):a.value?(i(),r("span",Gm,"ðŸ—œï¸")):M("",!0),t("span",Xm,x(c.value),1),g[0]||(g[0]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Ym,x(s.value),1)],2)]))}},zn=te(Qm,[["__scopeId","data-v-dc354df9"]]),Jm={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=k(()=>{switch(e.message.type){case"user":return Ri;case"assistant":return qm;case"system":return zn;default:return zn}});return(a,l)=>(i(),Ee(No(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Zm=te(Jm,[["__scopeId","data-v-11dff525"]]),ep={class:"msg-wrapper msg-system"},tp={class:"pill-badge"},sp={class:"pill-time"},np={key:0,class:"compaction-detail"},op={class:"detail-section"},ap={class:"detail-value"},ip={class:"detail-section"},lp={class:"detail-value"},rp={key:0,class:"detail-section"},cp={class:"detail-value"},up={class:"continuation-section"},dp={class:"continuation-text"},fp={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=L(!1);function a(){s.value=!s.value}const l=k(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),c=k(()=>l.value?e.messages[3]:e.messages[2]),d=k(()=>c.value?.metadata?.init_data?.compact_metadata||{}),g=k(()=>d.value.pre_tokens||0),u=k(()=>l.value?e.messages[4]:e.messages[3]),f=k(()=>u.value?.content||""),h=k(()=>{const m=e.messages[0]?.timestamp;return m?rs(m):""});function S(m){return m?`${m.toLocaleString()} tokens`:"0 tokens"}return(m,p)=>(i(),r("div",ep,[t("div",{class:"msg-pill pill-compaction",onClick:a,style:{cursor:"pointer"}},[p[0]||(p[0]=t("span",{class:"pill-icon"},"ðŸ—œï¸",-1)),p[1]||(p[1]=t("span",{class:"pill-text"},"Context Compaction Event",-1)),t("span",tp,x(S(g.value)),1),p[2]||(p[2]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",sp,x(h.value),1),t("span",{class:H(["pill-chevron",{expanded:s.value}])},"â–¶",2)]),s.value?(i(),r("div",np,[t("div",op,[p[3]||(p[3]=t("div",{class:"detail-label"},"Trigger",-1)),t("div",ap,x(d.value.trigger||"auto"),1)]),t("div",ip,[p[4]||(p[4]=t("div",{class:"detail-label"},"Pre-compaction",-1)),t("div",lp,x(S(g.value)),1)]),d.value.post_tokens?(i(),r("div",rp,[p[5]||(p[5]=t("div",{class:"detail-label"},"Post-compaction",-1)),t("div",cp,x(S(d.value.post_tokens)),1)])):M("",!0),t("div",up,[p[6]||(p[6]=t("div",{class:"detail-label"},"Continuation Message",-1)),t("pre",dp,x(f.value),1)])])):M("",!0)]))}},mp=te(fp,[["__scopeId","data-v-6b5b6a98"]]),pp={key:0,class:"text-muted text-center py-5"},vp={__name:"MessageList",setup(n){const e=Ne(),s=Ce(),a=L(null),l=k(()=>{const h=e.currentMessages,S=[];let m=0;for(;m<h.length;){const p=h[m];if(d(p,h,m)){const w=h[m+2],v=w?.type==="system"&&w?.metadata?.subtype==="init"?5:4,_=h.slice(m,m+v);S.push({type:"compaction",messages:_}),m+=v;continue}u(p)&&S.push({type:"message",message:p,attachedTools:[]}),m++}return c(S)});function c(h){const S=new Map,m=new Set;for(let w=0;w<h.length;w++){const b=h[w];if(b.type==="compaction")continue;const v=b.message,_=v.content&&v.content.trim().length>0&&v.content!=="Assistant response",o=v.type==="assistant"&&v.metadata?.has_tool_uses&&v.metadata?.tool_uses?.length>0;if(v.type==="assistant"&&o&&!_){let y=-1,$=!1;for(let E=w-1;E>=0;E--){const D=h[E];if(!m.has(E)){if(D.type==="message"&&D.message.type!=="assistant"){$=!0;break}if(D.type==="message"&&D.message.type==="assistant"){const T=D.message;if(T.content&&T.content.trim().length>0&&T.content!=="Assistant response"){y=E;break}else{y=E;break}}}}$&&y===-1||($&&y>=0?(S.has(y)||S.set(y,[]),S.get(y).push(...v.metadata.tool_uses),m.add(w)):!$&&y>=0&&(S.has(y)||S.set(y,[]),S.get(y).push(...v.metadata.tool_uses),m.add(w)))}}const p=[];for(let w=0;w<h.length;w++){if(m.has(w))continue;const b=h[w];S.has(w)&&(b.attachedTools=[...b.attachedTools||[],...S.get(w)]),p.push(b)}return p}function d(h,S,m){if(m+3>=S.length)return!1;const p=S[m],w=S[m+1];let b=S[m+2],v=S[m+3],_=S[m+4];const o=p.type==="system"&&p.metadata?.subtype==="status"&&p.metadata?.init_data?.status==="compacting",y=w.type==="system"&&w.metadata?.subtype==="status"&&(w.metadata?.init_data?.status===null||w.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(m+4>=S.length)return!1;const E=!0,D=v?.type==="system"&&v?.metadata?.subtype==="compact_boundary",T=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return p.type==="system"&&p.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",m),console.log("  Msg1 (compacting):",o),console.log("  Msg2 (null status):",y),console.log("  Msg3 (init):",E),console.log("  Msg4 (boundary):",D),console.log("  Msg5 (continuation):",T)),o&&y&&E&&D&&T}else{const E=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",D=v?.type==="user"&&v?.content?.startsWith("This session is being continued from a previous conversation");return p.type==="system"&&p.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",m),console.log("  Msg1 (compacting):",o),console.log("  Msg2 (null status):",y),console.log("  Msg3 (boundary):",E),console.log("  Msg4 (continuation):",D)),o&&y&&E&&D}}async function g(){s.autoScrollEnabled&&(await Fe(),a.value&&(a.value.scrollTop=a.value.scrollHeight))}fe(()=>l.value.length,g),fe(()=>e.currentToolCalls.length,g),fe(()=>e.currentToolCalls.map(h=>`${h.id}-${h.status}`).join(","),g),Me(()=>{setTimeout(()=>{g()},100)});function u(h){const S=h.subtype||h.metadata?.subtype;if(h.type==="system"&&S==="init"||h.type==="system"&&S==="task_notification"||h.type==="result"||h.type==="permission_request"||h.type==="permission_response")return!1;if(h.type==="user"&&h.metadata?.has_tool_results){const m=h.content||"";if(m.match(/^Tool results?: \d+ results?$/i)||m.trim()==="")return!1}if(h.type==="user"){const m=h.content||"";if(m.includes("<command-message>")&&m.includes("skill is running")||m.startsWith("Base directory for this skill:"))return!1}if(h.type==="user"){const m=h.content||"";if(m.includes("<command-message>")&&m.includes("<command-name>")&&m.includes("<command-args>")||m.includes("ARGUMENTS:")&&(m.includes("<command-name>")||m.match(/\nARGUMENTS:/)))return!1}if(h.type==="user"){const m=h.metadata||{};if(m.parent_tool_use_id&&!m.has_tool_results)return!1}return!0}function f(h){return{type:h.type||"unknown",content:h.content||"",timestamp:h.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...h.metadata}}}return(h,S)=>(i(),r("div",{class:H(["messages-area flex-grow-1 overflow-auto",{"theme-red":W(s).isRedBackground}]),ref_key:"messagesArea",ref:a},[l.value.length===0?(i(),r("div",pp," No messages yet. Start a conversation! ")):M("",!0),(i(!0),r(ee,null,le(l.value,(m,p)=>(i(),r(ee,{key:`item-${p}`},[m.type==="message"?(i(),Ee(Zm,{key:0,message:f(m.message),attachedTools:m.attachedTools||[]},null,8,["message","attachedTools"])):m.type==="compaction"?(i(),Ee(mp,{key:1,messages:m.messages},null,8,["messages"])):M("",!0)],64))),128))],2))}},hp=te(vp,[["__scopeId","data-v-7aa43476"]]),_p={key:0,class:"attachment-list"},gp={key:0,class:"attachment-preview"},bp=["src","alt"],yp={key:1,class:"attachment-icon"},wp={class:"file-type-icon"},kp={class:"attachment-info"},$p=["title"],Sp={class:"attachment-size"},xp=["onClick"],Cp={key:2,class:"upload-progress"},Ep=["title"],Tp={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function a(u){if(u.type&&u.type.startsWith("image/"))return!0;const f=u.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function l(u){const f=u.name?.split(".").pop()?.toLowerCase()||"",h=u.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||h==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function c(u){return u?u<1024?u+" B":u<1024*1024?(u/1024).toFixed(1)+" KB":(u/(1024*1024)).toFixed(1)+" MB":""}function d(u,f=20){if(!u||u.length<=f)return u;const h=u.split(".").pop(),S=u.substring(0,u.length-h.length-1);return S.length<=f-h.length-4?u:S.substring(0,f-h.length-4)+"..."+h}function g(u){s("remove",u)}return(u,f)=>n.attachments.length>0?(i(),r("div",_p,[(i(!0),r(ee,null,le(n.attachments,(h,S)=>(i(),r("div",{key:h.id||S,class:"attachment-item"},[a(h)?(i(),r("div",gp,[t("img",{src:h.preview||h.url,alt:h.name,class:"attachment-thumbnail"},null,8,bp)])):(i(),r("div",yp,[t("span",wp,x(l(h)),1)])),t("div",kp,[t("span",{class:"attachment-name",title:h.name},x(d(h.name)),9,$p),t("span",Sp,x(c(h.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:m=>g(S)}," âœ• ",8,xp),h.uploading?(i(),r("div",Cp,[t("div",{class:"progress-bar",style:Pe({width:(h.progress||0)+"%"})},null,4)])):M("",!0),h.error?(i(),r("div",{key:3,class:"upload-error",title:h.error}," âš ï¸ "+x(h.error),9,Ep)):M("",!0)]))),128))])):M("",!0)}},Ap=te(Tp,[["__scopeId","data-v-0fcc4974"]]),Dp=["id","aria-selected","onMousedown","onMouseenter"],Mp={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=L(null);return fe(()=>e.selectedIndex,a=>{if(!s.value)return;const l=s.value.children[a];l&&l.scrollIntoView({block:"nearest"})}),(a,l)=>n.commands.length>0?(i(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),r(ee,null,le(n.commands,(c,d)=>(i(),r("li",{id:`slash-cmd-${d}`,key:c,role:"option",class:H(["slash-command-item",{active:d===n.selectedIndex}]),"aria-selected":d===n.selectedIndex,onMousedown:ae(g=>a.$emit("select",c),["prevent"]),onMouseenter:g=>a.$emit("highlight",d)}," /"+x(c),43,Dp))),128))],512)):M("",!0)}},Op=te(Mp,[["__scopeId","data-v-97c65547"]]),Lp={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Ip=["disabled"],Np=["placeholder","disabled","aria-expanded","aria-activedescendant"],Pp=["disabled"],jp=["disabled"],Kn=5*1024*1024,Rp={__name:"InputArea",setup(n){const e=_e(),s=it(),a=st(),l=Ce(),c=Po("pendingResourceAttachment",L(null)),d=L(null),g=L(null),u=L(window.innerWidth),f=L([]),h=L(!1),S=L(!1),m=L(!1),p=L(""),w=L(0),b=k({get:()=>e.currentInput,set:z=>{e.currentInput=z}}),v=k(()=>e.currentSession?.is_processing||!1),_=k(()=>s.sessionConnected),o=k(()=>e.currentSession?.state==="starting"),y=k(()=>e.currentSessionId),$=k(()=>!!b.value.trim()||f.value.filter(z=>!z.error).length>0),E=k(()=>u.value<768),D=k(()=>o.value?"Session is starting...":_.value?"Type your message to Claude Code...":"Waiting for connection..."),T=k(()=>{const z=y.value;return z?e.initData.get(z)?.slash_commands||[]:[]}),O=k(()=>{const z=p.value.toLowerCase();return T.value.filter(R=>R.toLowerCase().includes(z)).sort((R,U)=>R.localeCompare(U))});function C(){u.value=window.innerWidth}Me(()=>{window.addEventListener("resize",C)}),Oe(()=>{window.removeEventListener("resize",C)}),fe(c,z=>{z&&(ge(z),c.value=null)});function A(z){if(m.value&&O.value.length>0){const R=O.value.length;if(z.key==="ArrowDown"){z.preventDefault(),w.value=(w.value+1)%R;return}if(z.key==="ArrowUp"){z.preventDefault(),w.value=(w.value-1+R)%R;return}if(z.key==="Enter"){z.preventDefault(),P(O.value[w.value]);return}if(z.key==="Tab"){z.preventDefault(),P(O.value[w.value]);return}}if(z.key==="Escape"&&m.value){z.preventDefault(),m.value=!1;return}if(z.key==="Enter"&&!z.shiftKey){if(E.value)return;z.preventDefault(),pe()}}function N(){const z=d.value;if(!z)return;z.style.height="auto";const R=Math.min(z.scrollHeight,parseInt(getComputedStyle(z).maxHeight));z.style.height=R+"px"}fe(b,z=>{z.startsWith("/")&&T.value.length>0?(p.value=z.slice(1),w.value=0,m.value=O.value.length>0):m.value=!1});function P(z){b.value=`/${z} `,m.value=!1,d.value?.focus(),N()}function F(){g.value?.click()}function V(z){const R=Array.from(z.target.files||[]);I(R),z.target.value=""}function X(z){h.value=!1;const R=Array.from(z.dataTransfer?.files||[]);I(R)}function j(z){const R=z.clipboardData?.items;if(!R)return;const U=[];for(const se of R)if(se.type.startsWith("image/")){const Y=se.getAsFile();if(Y){const oe=se.type.split("/")[1]||"png",Se=`clipboard-${Date.now()}.${oe}`,lt=new File([Y],Se,{type:Y.type});U.push(lt)}}U.length>0&&(z.preventDefault(),I(U))}function I(z){for(const R of z){if(R.size>Kn){f.value.push({id:q(),name:R.name,size:R.size,type:R.type,file:R,error:`File too large (max ${Kn/(1024*1024)}MB)`});continue}let U=null;R.type.startsWith("image/")&&(U=URL.createObjectURL(R)),f.value.push({id:q(),name:R.name,size:R.size,type:R.type,file:R,preview:U,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function G(z){const R=f.value[z];R.preview&&URL.revokeObjectURL(R.preview),f.value.splice(z,1)}function q(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function Z(z){const R=y.value;if(!R)return null;z.uploading=!0,z.progress=0,z.error=null;try{const U=new FormData;U.append("file",z.file);const se=await fetch(`/api/sessions/${R}/files`,{method:"POST",body:U});if(!se.ok){const oe=await se.json().catch(()=>({}));throw new Error(oe.detail||`Upload failed: ${se.status}`)}const Y=await se.json();return z.uploaded=!0,z.uploadedInfo=Y.file,z.progress=100,Y.file}catch(U){return z.error=U.message,null}finally{z.uploading=!1}}async function K(){const z=f.value.filter(R=>!R.uploaded&&!R.error);if(z.length===0)return!0;S.value=!0;try{return(await Promise.all(z.map(Z))).every(U=>U!==null)}finally{S.value=!1}}async function pe(){const z=b.value.trim(),R=f.value.filter(Y=>!Y.error).length>0;if(!z&&!R||R&&!await K())return;let U=b.value;const se=f.value.filter(Y=>Y.uploaded&&Y.uploadedInfo).map(Y=>Y.uploadedInfo);if(se.length>0){const Y=se.map(oe=>{const Se=(oe.size_bytes/1024).toFixed(1);return`- ${oe.original_name} (${Se} KB): ${oe.stored_path}`}).join(`
`);U.trim()?U=`${U}

---
Attached files (use Read tool to access):
${Y}`:U=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${Y}`}s.sendMessage(U),b.value="",re(),d.value&&(d.value.style.height="auto")}function re(){for(const z of f.value)z.preview&&URL.revokeObjectURL(z.preview);f.value=[]}function ge(z){if(!z||!z.resource_id){console.warn("Invalid resource for attachment:",z);return}const R=y.value;if(!R){console.warn("No current session for resource attachment");return}if(f.value.findIndex(oe=>oe.resourceId===z.resource_id)>=0){console.log("Resource already attached:",z.resource_id);return}const se=a.isImageResource(z);let Y=null;se&&(Y=a.getResourceUrl(R,z.resource_id)),f.value.push({id:q(),resourceId:z.resource_id,name:z.original_filename||z.title||"Resource",size:z.size_bytes||0,type:z.format||"application/octet-stream",file:null,preview:Y,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:z.resource_id,original_name:z.original_filename||z.title,stored_path:z.file_path||`/api/sessions/${R}/resources/${z.resource_id}`,size_bytes:z.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",z.resource_id)}function be(){s.interruptSession()}return(z,R)=>(i(),r("div",{class:H(["border-top",W(l).isRedBackground?"theme-red-panel":"bg-light"])},[_.value?M("",!0):(i(),r("div",Lp,[...R[6]||(R[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),he(Ap,{attachments:f.value,onRemove:G},null,8,["attachments"]),h.value?(i(),r("div",{key:1,class:"drop-zone-overlay",onDragover:R[0]||(R[0]=ae(()=>{},["prevent"])),onDragleave:R[1]||(R[1]=U=>h.value=!1),onDrop:ae(X,["prevent"])},[...R[7]||(R[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):M("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:R[4]||(R[4]=ae(U=>h.value=!0,["prevent"])),onDragenter:R[5]||(R[5]=ae(U=>h.value=!0,["prevent"]))},[m.value?(i(),Ee(Op,{key:0,commands:O.value,"selected-index":w.value,onSelect:P,onHighlight:R[2]||(R[2]=U=>w.value=U)},null,8,["commands","selected-index"])):M("",!0),t("input",{ref_key:"fileInput",ref:g,type:"file",multiple:"",class:"d-none",onChange:V},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:o.value||!_.value,onClick:F}," ðŸ“Ž ",8,Ip),$e(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:d,"onUpdate:modelValue":R[3]||(R[3]=U=>b.value=U),class:"form-control",placeholder:D.value,disabled:o.value||!_.value,rows:"1","aria-expanded":m.value||void 0,"aria-activedescendant":m.value?`slash-cmd-${w.value}`:void 0,onInput:N,onKeydown:A,onPaste:j},null,40,Np),[[De,b.value]]),v.value&&!$.value?(i(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:be}," Stop ")):v.value&&$.value?(i(),r("button",{key:2,class:"btn btn-info",disabled:!_.value||o.value||S.value,title:"Send while processing (doesn't interrupt)",onClick:pe},x(S.value?"Uploading...":"Queue"),9,Pp)):(i(),r("button",{key:3,class:"btn btn-primary",disabled:!$.value||!_.value||o.value||S.value,onClick:pe},x(S.value?"Uploading...":"Send"),9,jp))],32)],2))}},Bp=te(Rp,[["__scopeId","data-v-5b1f250e"]]),Fp={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Vp={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Up={class:"text-secondary"},Wp={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Hp={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),a=Ce(),l=k(()=>s.currentSession),c=k(()=>a.isLoading),d=k(()=>a.loadingMessage);return Me(async()=>{if(e.sessionId!==s.currentSessionId){a.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{a.hideLoading()}}}),fe(()=>e.sessionId,async(g,u)=>{if(g!==u&&g!==s.currentSessionId){a.showLoading("Loading session...");try{await s.selectSession(g)}finally{a.hideLoading()}}}),Oe(()=>{}),(g,u)=>(i(),r("div",Fp,[c.value?(i(),r("div",Vp,[u[0]||(u[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Up,x(d.value),1)])):M("",!0),t("div",Wp,[he(hp)]),he(Bp),l.value?(i(),Ee(vi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),l.value?(i(),Ee($i,{key:2,"session-id":e.sessionId},null,8,["session-id"])):M("",!0)]))}},zt=Qe("legion",()=>{const n=L(new Map),e=L(new Map),s=L(null),a=k(()=>n.value.get(s.value)||[]),l=k(()=>e.value.get(s.value)||[]);function c(w){s.value=w}async function d(w,b=100,v=0){try{const _=await ve.get(`/api/legions/${w}/timeline?limit=${b}&offset=${v}`),o=_.comms||[],y=_.total_count||o.length,$=_.has_more||!1;return o.sort((E,D)=>new Date(E.timestamp)-new Date(D.timestamp)),console.log(`Loaded ${o.length} of ${y} comms for legion ${w}`),n.value.set(w,o),n.value=new Map(n.value),{comms:o,totalCount:y,hasMore:$}}catch(_){throw console.error("Failed to load timeline:",_),_}}function g(w,b){n.value.has(w)||n.value.set(w,[]);const v=n.value.get(w);if(v.some(o=>o.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}v.push(b),n.value=new Map(n.value)}async function u(w,b){try{const _=(await ve.post(`/api/legions/${w}/comms`,b)).comm;return console.log(`Sent comm ${_.comm_id} to legion ${w}`),_}catch(v){throw console.error("Failed to send comm:",v),v}}async function f(w){return console.log(`Minions for legion ${w} are already available in session store`),[]}async function h(w,b){try{const _=(await ve.post(`/api/legions/${w}/minions`,b)).minion;return await f(w),console.log(`Created minion ${_.minion_id} in legion ${w}`),_}catch(v){throw console.error("Failed to create minion:",v),v}}async function S(w){try{const b=await ve.post(`/api/legions/${w}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${w}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function m(w){try{const b=await ve.post(`/api/legions/${w}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${w}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function p(w){n.value.delete(w),e.value.delete(w),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:a,currentMinions:l,setCurrentLegion:c,loadTimeline:d,addComm:g,sendComm:u,loadMinions:f,createMinion:h,haltAll:S,resumeAll:m,clearLegionData:p}}),qp=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:zt},Symbol.toStringTag,{value:"Module"})),zp={class:"timeline-header border-bottom p-3"},Kp={class:"project-name"},Gp=["title"],Xp={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Ge(),a=k(()=>s.projects.get(e.legionId)),l=k(()=>a.value?.name||"Legion");return(c,d)=>(i(),r("div",zp,[t("div",null,[t("div",Kp,x(l.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Gp)])]))}},Yp=te(Xp,[["__scopeId","data-v-44f386f5"]]),Qp={class:"timeline-status-bar border-top p-2 bg-light"},Jp={class:"d-flex justify-content-end"},Zp={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=Ce();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(a,l)=>(i(),r("div",Qp,[t("div",Jp,[t("button",{class:H(["btn btn-sm",W(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+x(W(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},ev=te(Zp,[["__scopeId","data-v-891c73db"]]),tv={class:"comm-composer border-top p-3"},sv={key:0,class:"d-flex gap-2 mb-2"},nv={class:"flex-grow-1"},ov=["disabled"],av={label:"Minions"},iv=["value"],lv={style:{"min-width":"150px"}},rv=["disabled"],cv={class:"d-flex gap-2 align-items-end position-relative"},uv={class:"flex-grow-1 position-relative"},dv=["disabled"],fv=["onClick","onMouseenter"],mv=["disabled"],pv={key:0},vv={key:1},hv={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=zt(),a=_e(),l=Ge(),c=L(""),d=L("task"),g=L(""),u=L(!1),f=L(window.innerWidth),h=L(!1),S=L([]),m=L(0),p=L(-1),w=L(null),b=L(null),v=k(()=>f.value<768),_=k(()=>{const P=l.projects.get(e.legionId);return!P||!P.session_ids?[]:P.session_ids.map(F=>a.sessions.get(F)).filter(F=>F)}),o=k(()=>c.value&&g.value.trim().length>0);function y(P){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[P.state]||"â—‹"}function $(P){return P.role?`${P.name} (${P.role})`:P.name}function E(){const P=w.value;if(!P)return;P.style.height="auto";const F=Math.min(P.scrollHeight,parseInt(getComputedStyle(P).maxHeight));P.style.height=F+"px"}function D(){const P=w.value;if(!P)return;E();const F=g.value,V=P.selectionStart,X=F.substring(0,V),j=X.lastIndexOf("#");if(j===-1){h.value=!1;return}const I=X.substring(j+1).toLowerCase();if(I.includes(" ")){h.value=!1;return}const G=_.value.filter(q=>q.name.toLowerCase().includes(I)).map(q=>({type:"minion",name:q.name,role:q.role,id:q.session_id,state:q.state}));if(G.length===0){h.value=!1;return}S.value=G,m.value=0,p.value=j,h.value=!0}function T(){if(!b.value)return;const P=b.value,F=P.children[m.value];if(!F)return;const V=F.offsetTop,X=F.offsetHeight,j=P.scrollTop,I=P.clientHeight;V<j?P.scrollTop=V:V+X>j+I&&(P.scrollTop=V+X-I)}function O(P){if(!h.value){if(P.key==="Enter"&&!P.shiftKey){if(v.value)return;o.value&&(P.preventDefault(),A())}return}if(P.key==="ArrowDown")P.preventDefault(),m.value=(m.value+1)%S.value.length,T();else if(P.key==="ArrowUp")P.preventDefault(),m.value=m.value===0?S.value.length-1:m.value-1,T();else if(P.key==="Enter"){P.preventDefault();const F=S.value[m.value];F&&C(F)}else P.key==="Escape"&&(h.value=!1)}function C(P){const F=w.value;if(!F)return;const V=g.value,X=F.selectionStart,j=V.substring(0,p.value)+"#"+P.name+" "+V.substring(X);g.value=j;const I=p.value+P.name.length+2;setTimeout(()=>{F.setSelectionRange(I,I),F.focus()},0),h.value=!1}async function A(){if(!(!o.value||u.value)){u.value=!0;try{const[P,F]=c.value.split(":"),V={comm_type:d.value,content:g.value.trim()};P==="minion"&&(V.to_minion_id=F),await s.sendComm(e.legionId,V),g.value="",E()}catch(P){console.error("Failed to send comm:",P),alert(`Failed to send comm: ${P.message}`)}finally{u.value=!1}}}function N(){f.value=window.innerWidth}return Me(()=>{window.addEventListener("resize",N)}),Oe(()=>{window.removeEventListener("resize",N)}),fe(h,P=>{if(P){const F=V=>{V.target.closest(".comm-composer")||(h.value=!1,document.removeEventListener("click",F))};setTimeout(()=>document.addEventListener("click",F),0)}}),(P,F)=>(i(),r("div",tv,[n.hideRecipientSelector?M("",!0):(i(),r("div",sv,[t("div",nv,[$e(t("select",{"onUpdate:modelValue":F[0]||(F[0]=V=>c.value=V),class:"form-select form-select-sm",disabled:u.value},[F[3]||(F[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",av,[(i(!0),r(ee,null,le(_.value,V=>(i(),r("option",{key:V.session_id,value:`minion:${V.session_id}`},x(y(V))+" "+x($(V)),9,iv))),128))])],8,ov),[[Cs,c.value]])]),t("div",lv,[$e(t("select",{"onUpdate:modelValue":F[1]||(F[1]=V=>d.value=V),class:"form-select form-select-sm",disabled:u.value},[...F[4]||(F[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,rv),[[Cs,d.value]])])])),t("div",cv,[t("div",uv,[$e(t("textarea",{ref_key:"contentTextarea",ref:w,"onUpdate:modelValue":F[2]||(F[2]=V=>g.value=V),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:u.value,onInput:D,onKeydown:O},null,40,dv),[[De,g.value]]),h.value?(i(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),r(ee,null,le(S.value,(V,X)=>(i(),r("div",{key:V.id,class:H(["autocomplete-item px-2 py-1",{"bg-light":X===m.value}]),onClick:j=>C(V),onMouseenter:j=>m.value=X},x(V.type==="minion"?y(V):"#ï¸âƒ£")+" "+x(V.name)+x(V.role?` (${V.role})`:""),43,fv))),128))],512)):M("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!o.value||u.value,onClick:A},[u.value?(i(),r("span",pv,[...F[5]||(F[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ue(" Sending... ",-1)])])):(i(),r("span",vv,"Send"))],8,mv)])])]))}},_v=te(hv,[["__scopeId","data-v-e52b8e8f"]]),gv={class:"message-content-column-full"},bv=["aria-expanded"],yv={class:"comm-sender-recipient"},wv={class:"comm-badge-summary"},kv=["title"],$v={class:"comm-summary-text text-muted ms-2"},Sv=["aria-label"],xv={key:0,class:"comm-content-body"},Cv=["innerHTML"],Ev="ffffffff-ffff-ffff-ffff-ffffffffffff",Tv={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ye.setOptions({breaks:!0,gfm:!0});const s=L(!1);function a(){s.value=!s.value}const l=k(()=>e.comm.from_minion_id===Ev),c=k(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),d=k(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),g=k(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),u=k(()=>{const f=e.comm.content||"";let h=Ye.parse(f);return h=h.replace(/\n</g,"<"),h=h.replace(/\n+$/,""),qt.sanitize(h)});return(f,h)=>(i(),r("div",{class:H(["message-row message-row-comm",{"system-comm":l.value}])},[t("div",gv,[t("div",{class:"comm-header-accordion",onClick:a,role:"button","aria-expanded":s.value},[t("div",yv,[t("strong",{class:H({"system-sender":l.value})},x(n.senderName),3),n.recipientName?(i(),r(ee,{key:0},[h[0]||(h[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,x(n.recipientName),1)],64)):M("",!0)]),t("div",wv,[t("span",{class:H(["badge",d.value]),title:c.value},x(n.comm.comm_type),11,kv),t("span",$v,x(g.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},x(s.value?"â–¾":"â–¸"),9,Sv)],8,bv),s.value?(i(),r("div",xv,[t("div",{class:"message-text",innerHTML:u.value},null,8,Cv)])):M("",!0)])],2))}},Av=te(Tv,[["__scopeId","data-v-28513f64"]]),Dv={class:"timeline-view d-flex flex-column h-100"},Mv={key:0,class:"text-center text-muted"},Ov={key:1,class:"text-center text-danger"},Lv={key:2,class:"text-center text-muted"},Iv={key:3,class:"comm-list"},Nv={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=zt();Ge();const a=_e(),l=it(),c=Ce(),d=L(!0),g=L(null),u=L(null),f=k(()=>s.currentComms);function h(v){return v.from_user?"You":v.from_minion_id?v.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":a.sessions.get(v.from_minion_id)?.name||"Unknown":"Unknown"}function S(v){return v.to_user?"You":v.to_minion_id?a.sessions.get(v.to_minion_id)?.name||"Unknown":"All"}async function m(){c.autoScrollEnabled&&(await Fe(),u.value&&(u.value.scrollTop=u.value.scrollHeight))}async function p(){d.value=!0,g.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Fe(),await m(),setTimeout(()=>{m()},100)}catch(v){console.error("Failed to load timeline:",v),v.response?g.value=`${v.message} (${v.response.status})`:g.value=v.message||"Unknown error"}finally{d.value=!1}}function w(){l.connectLegion(e.legionId)}function b(){l.disconnectLegion()}return fe(()=>f.value.length,()=>{m()}),Me(()=>{a.currentSessionId=null,p(),w(),setTimeout(()=>{m()},100)}),Oe(()=>{b()}),(v,_)=>(i(),r("div",Dv,[he(Yp,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:u,class:"timeline-messages flex-grow-1 overflow-auto"},[d.value?(i(),r("div",Mv,[..._[0]||(_[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ue(" Loading timeline... ",-1)])])):g.value?(i(),r("div",Ov," Failed to load timeline: "+x(g.value),1)):f.value.length===0?(i(),r("div",Lv," No messages yet. Minions will appear here once they start communicating. ")):(i(),r("div",Iv,[(i(!0),r(ee,null,le(f.value,o=>(i(),Ee(Av,{key:o.comm_id,comm:o,"sender-name":h(o),"recipient-name":S(o)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),he(_v,{"legion-id":n.legionId},null,8,["legion-id"]),he(ev,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Pv=te(Nv,[["__scopeId","data-v-b6752179"]]),jv={class:"minion-info flex-grow-1"},Rv={class:"minion-name"},Bv={key:0,class:"me-1"},Fv={key:1,class:"badge bg-secondary ms-2"},Vv={key:0,class:"latest-activity text-muted"},Uv={key:0,class:"activity-prefix"},Wv=["title"],Hv={key:1,class:"activity-time ms-1"},qv={key:1,class:"latest-activity text-muted"},zv={class:"activity-prefix"},Kv=["title"],Gv={key:2,class:"latest-activity text-muted fst-italic small"},Xv={class:"node-row"},Yv={class:"node-left"},Qv={key:0,class:"me-2"},Jv={key:1,class:"badge bg-secondary ms-2"},Zv={class:"node-right"},eh={key:0,class:"latest-message-preview"},th={key:0,class:"message-prefix"},sh=["title"],nh={key:1,class:"message-time ms-1"},oh={key:1,class:"last-comm-preview"},ah={class:"comm-direction"},ih=["title"],lh={key:2,class:"text-muted fst-italic small"},rh={class:"node-actions"},ch={key:2,class:"minion-children"},uh={key:1,class:"text-danger small ms-4"},dh={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,a=e,l=_e(),c=Ne(),d=Ce(),g=k(()=>!s.minionData||!s.minionData.id?null:l.getSession(s.minionData.id)),u=k(()=>{if(!s.minionData||!s.minionData.id)return null;const C=c.messagesBySession.get(s.minionData.id);if(!C||C.length===0)return null;for(let A=C.length-1;A>=0;A--){const N=C[A],P=N.subtype||N.metadata?.subtype;if(N.type!=="result"&&!(N.type==="system"&&P==="init")&&!(N.type==="system"&&P==="task_notification")&&!(N.type==="permission_request"||N.type==="permission_response")){if(N.type==="user"&&N.metadata?.has_tool_results){const F=N.content||"";if(F.match(/^Tool results?: \d+ results?$/i)||F.trim()==="")continue}if(N.type==="user"){const F=N.content||"";if(F.includes("<command-message>")&&F.includes("skill is running")||F.startsWith("Base directory for this skill:"))continue}if(N.type==="user"){const F=N.content||"";if(F.includes("<command-message>")&&F.includes("<command-name>")&&F.includes("<command-args>")||F.includes("ARGUMENTS:")&&(F.includes("<command-name>")||F.match(/\nARGUMENTS:/)))continue}if(!(N.type==="system"&&N.content==="System message")&&!(N.type==="assistant"&&N.content==="Assistant response")&&(N.type==="user"||N.type==="assistant"||N.type==="system"))return{content:N.content,type:N.type,timestamp:N.timestamp}}}return null}),f=k(()=>{if(!s.minionData)return null;const C={...s.minionData};return g.value&&(C.state=g.value.state,C.is_processing=g.value.is_processing,g.value.name&&(C.name=g.value.name),g.value.latest_message&&(C.latest_message=g.value.latest_message,C.latest_message_type=g.value.latest_message_type,C.latest_message_time=g.value.latest_message_time)),u.value&&(C.latest_message=u.value.content,C.latest_message_type=u.value.type,C.latest_message_time=u.value.timestamp),C}),h=k(()=>s.level*24),S=k(()=>!s.minionData||!s.minionData.id?!1:l.currentSessionId===s.minionData.id),m=k(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),p=k(()=>s.minionData&&s.minionData.is_overseer&&m.value),w=k(()=>{const C=f.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),b=k(()=>{const C=w.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),v=k(()=>{const C=w.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),_=k(()=>{const C=f.value;if(!C||!C.latest_message_type)return"";const A=C.latest_message_type;return A==="user"?"User -->:":A==="system"?"System:":""}),o=k(()=>{const C=f.value;if(!C||!C.latest_message)return"";const A=C.latest_message,N=150;return A.length>N?A.slice(0,N)+"...":A}),y=k(()=>{const C=f.value;if(!C||!C.latest_message_time)return"";try{const A=Date.now();let N;if(typeof C.latest_message_time=="number"?N=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:N=new Date(C.latest_message_time).getTime(),isNaN(N)||N<9466848e5||N>A+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",N),"";const P=A-N;if(P<0)return"just now";const F=Math.floor(P/6e4),V=Math.floor(F/60),X=Math.floor(V/24);return X>0?`${X}d ago`:V>0?`${V}h ago`:F>0?`${F}m ago`:"just now"}catch(A){return console.error("Error calculating relative time:",A,C.latest_message_time),""}});function $(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function E(C){const A=C.summary||C.content||"";return A.length>150?A.substring(0,150)+"...":A}function D(){a("minion-click",s.minionData.id)}function T(){const C=l.sessions.get(s.minionData.id);C&&d.showModal("edit-session",{session:C})}function O(){const C=l.sessions.get(s.minionData.id);C&&d.showModal("manage-session",{session:C})}return(C,A)=>{const N=gn("MinionTreeNode",!0);return n.minionData?(i(),r("div",{key:0,class:"minion-tree-node",style:Pe({marginLeft:`${h.value}px`})},[n.layout==="sidebar"?(i(),r("div",{key:0,class:H(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:S.value}]),onClick:D},[t("div",{class:H(["status-dot me-2",b.value]),style:Pe(v.value)},null,6),t("div",jv,[t("div",Rv,[p.value?(i(),r("span",Bv,"ðŸ‘‘")):M("",!0),t("strong",null,x(f.value?.name||n.minionData.name),1),p.value?(i(),r("span",Fv,x(n.minionData.children.length)+" "+x(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),f.value?.latest_message?(i(),r("div",Vv,[_.value?(i(),r("span",Uv,x(_.value),1)):M("",!0),t("span",{class:"activity-content",title:f.value.latest_message},x(o.value),9,Wv),y.value?(i(),r("span",Hv,"("+x(y.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(i(),r("div",qv,[t("span",zv,[A[1]||(A[1]=ue("â†’ ",-1)),t("strong",null,x($(n.minionData.last_comm)),1),A[2]||(A[2]=ue(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},x(E(n.minionData.last_comm)),9,Kv)])):(i(),r("div",Gv," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ae(T,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ae(O,["stop"])}," âš™ï¸ ")],2)):(i(),r("div",{key:1,class:H(["minion-card minion-card-clickable border-start border-2 mb-2",{active:S.value}]),onClick:D},[t("div",Xv,[t("div",Yv,[t("div",{class:H(["status-dot me-2",b.value]),style:Pe(v.value)},null,6),p.value?(i(),r("span",Qv,"ðŸ‘‘")):M("",!0),t("strong",null,x(f.value?.name||n.minionData.name),1),p.value?(i(),r("span",Jv,x(n.minionData.children.length)+" "+x(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),t("div",Zv,[f.value?.latest_message?(i(),r("div",eh,[_.value?(i(),r("span",th,x(_.value),1)):M("",!0),t("span",{class:"message-content",title:f.value.latest_message},x(o.value),9,sh),y.value?(i(),r("span",nh,"("+x(y.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(i(),r("div",oh,[t("span",ah,[A[3]||(A[3]=ue("â†’ ",-1)),t("strong",null,x($(n.minionData.last_comm)),1),A[4]||(A[4]=ue(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},x(E(n.minionData.last_comm)),9,ih)])):(i(),r("div",lh," No activity yet "))]),t("div",rh,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ae(T,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ae(O,["stop"])}," âš™ï¸ ")])])],2)),m.value?(i(),r("div",ch,[(i(!0),r(ee,null,le(n.minionData.children,P=>(i(),Ee(N,{key:P.id,"minion-data":P,level:n.level+1,layout:n.layout,onMinionClick:A[0]||(A[0]=F=>C.$emit("minion-click",F))},null,8,["minion-data","level","layout"]))),128))])):M("",!0)],4)):(i(),r("div",uh," âš  Minion data is missing "))}}},fh=te(dh,[["__scopeId","data-v-64b23e0e"]]),mh={class:"project-overview d-flex flex-column h-100"},ph={class:"project-overview-header border-bottom p-3"},vh={class:"d-flex align-items-center justify-content-between"},hh={class:"mb-1"},_h={key:0,class:"me-2"},gh={class:"text-muted font-monospace"},bh={class:"d-flex gap-2"},yh=["title"],wh={class:"project-overview-content flex-grow-1 overflow-auto p-3"},kh={key:0,class:"text-center py-5"},$h={key:1,class:"alert alert-danger"},Sh={key:2,class:"text-center py-5"},xh={key:3},Ch={class:"row g-3 mb-4"},Eh={class:"col-md-4"},Th={class:"card h-100"},Ah={class:"card-body"},Dh={class:"card-title mb-0"},Mh={class:"text-muted"},Oh={class:"col-md-4"},Lh={class:"card h-100"},Ih={class:"card-body"},Nh={class:"card-title mb-0"},Ph={class:"text-muted"},jh={key:0,class:"card mb-4"},Rh={class:"card mb-4"},Bh={class:"card-header d-flex align-items-center justify-content-between"},Fh={class:"mb-0"},Vh={class:"badge bg-secondary"},Uh={class:"card-body"},Wh={key:0,class:"text-center py-4"},Hh={key:1,class:"text-center text-muted py-4"},qh={key:2,class:"hierarchy-tree"},zh={class:"user-root-node mb-3 border rounded bg-white"},Kh={class:"node-row"},Gh={class:"node-left"},Xh={class:"badge bg-primary ms-2"},Yh={class:"node-right"},Qh={key:0,class:"last-comm-preview"},Jh={class:"comm-direction"},Zh=["title"],e_={key:1,class:"text-muted fst-italic"},t_={class:"root-minions ms-4"},s_={class:"card"},n_={class:"card-body"},o_={class:"row mb-0"},a_={class:"col-sm-8 font-monospace text-break"},i_={class:"col-sm-8 font-monospace text-break"},l_={class:"col-sm-8"},r_={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},c_={class:"text-muted"},u_={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=ls(),a=Ge(),l=_e(),c=Ce(),d=zt(),g=it(),u=L(!1),f=L(null),h=L(null),S=L(!1);let m=null;const p=k(()=>a.getProject(e.projectId)),w=k(()=>p.value?.session_ids?p.value.session_ids.map(V=>l.getSession(V)).filter(V=>V!=null):[]),b=k(()=>w.value.length>0),v=k(()=>w.value.length),_=k(()=>w.value.filter(V=>V.state==="ACTIVE").length),o=k(()=>{const V=w.value.some(I=>I.state==="ACTIVE"),X=w.value.some(I=>I.is_processing);return w.value.some(I=>I.state==="ERROR")?"Error":X?"Working":V?"Active":v.value>0?"Idle":"Empty"}),y=k(()=>{switch(o.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),$=k(()=>{switch(o.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function E(){S.value=!0;try{const V=await ve.get(`/api/legions/${e.projectId}/hierarchy`);h.value=V}catch(V){console.error("Failed to load minion hierarchy:",V),h.value=null}finally{S.value=!1}}function D(V,X){if(V&&V.id===X)return V;if(V&&V.children)for(const j of V.children){const I=D(j,X);if(I)return I}return null}function T(V){return V.to_user?"User":V.to_minion_name?V.to_minion_name:"unknown"}function O(V){const X=V.summary||V.content||"";return X.length>150?X.substring(0,150)+"...":X}function C(V){if(h.value){if(V.from_minion_id){const X=D(h.value,V.from_minion_id);X&&X.type==="minion"&&(X.last_comm=V)}V.from_user&&h.value.type==="user"&&(h.value.last_comm=V)}}function A(V){s.push(`/session/${V}`)}function N(){s.push(`/timeline/${e.projectId}`)}function P(){c.showModal("edit-project",{project:p.value})}function F(){c.showModal("create-minion",{project:p.value})}return Me(()=>{a.selectProject(e.projectId),l.currentSessionId=null,E(),d.setCurrentLegion(e.projectId),g.connectLegion(e.projectId),m=fe(()=>l.sessions,V=>{if(h.value){for(const[X,j]of V)if(j.project_id===e.projectId){const I=D(h.value,X);I&&I.type==="minion"&&(I.state!==j.state&&(I.state=j.state),I.is_processing!==j.is_processing&&(I.is_processing=j.is_processing),I.latest_message!==j.latest_message&&(I.latest_message=j.latest_message,I.latest_message_type=j.latest_message_type,I.latest_message_time=j.latest_message_time))}}},{deep:!0}),fe(()=>d.commsByLegion.get(e.projectId),V=>{if(V&&V.length>0){const X=V[V.length-1];C(X)}},{deep:!0}),fe(()=>a.projects.get(e.projectId)?.session_ids?.length||0,(V,X)=>{V!==X&&E()})}),fe(()=>e.projectId,V=>{a.selectProject(V),l.currentSessionId=null,E(),d.setCurrentLegion(V),g.connectLegion(V)}),Oe(()=>{m&&m()}),(V,X)=>(i(),r("div",mh,[t("div",ph,[t("div",vh,[t("div",null,[t("h4",hh,[b.value?(i(),r("span",_h,"ðŸ›")):M("",!0),ue(" "+x(p.value?.name||"Project Overview"),1)]),t("small",gh,x(p.value?.working_directory),1)]),t("div",bh,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:P}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:F}," âž• "+x(b.value?"Add Minion":"Add Session"),9,yh)])])]),t("div",wh,[u.value?(i(),r("div",kh,[...X[0]||(X[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(i(),r("div",$h,x(f.value),1)):p.value?(i(),r("div",xh,[t("div",Ch,[t("div",Eh,[t("div",Th,[t("div",Ah,[X[2]||(X[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",Dh,x(v.value),1),t("small",Mh,x(_.value)+" active",1)])])]),t("div",Oh,[t("div",Lh,[t("div",Ih,[X[3]||(X[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",Nh,[t("span",{class:H(y.value)},x(o.value),3)]),t("small",Ph,x($.value),1)])])])]),b.value?(i(),r("div",jh,[X[4]||(X[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:N}," ðŸ“Š View Timeline ")])])])):M("",!0),t("div",Rh,[t("div",Bh,[t("h5",Fh,"ðŸŒ³ "+x(b.value?"Minion Hierarchy":"Sessions"),1),t("span",Vh,x(w.value.length),1)]),t("div",Uh,[S.value?(i(),r("div",Wh,[...X[5]||(X[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!h.value||!h.value.children||h.value.children.length===0?(i(),r("div",Hh,' No sessions yet. Click "Add Session" to create one. ')):(i(),r("div",qh,[t("div",zh,[t("div",Kh,[t("div",Gh,[X[6]||(X[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,x(h.value.name),1),t("span",Xh,x(h.value.children.length)+" "+x(h.value.children.length===1?"minion":"minions"),1)]),t("div",Yh,[h.value.last_comm?(i(),r("div",Qh,[t("span",Jh,[X[7]||(X[7]=ue(" â†’ ",-1)),t("strong",null,x(T(h.value.last_comm)),1),X[8]||(X[8]=ue(": ",-1))]),t("span",{class:"comm-content",title:h.value.last_comm.content||""},x(O(h.value.last_comm)),9,Zh)])):(i(),r("div",e_," No communications yet "))])])]),t("div",t_,[(i(!0),r(ee,null,le(h.value.children,j=>(i(),Ee(fh,{key:j.id,"minion-data":j,level:1,layout:"two-column",onMinionClick:A},null,8,["minion-data"]))),128))])]))])]),t("div",s_,[X[12]||(X[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",n_,[t("dl",o_,[X[9]||(X[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",a_,x(p.value.working_directory),1),X[10]||(X[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",i_,x(p.value.project_id),1),X[11]||(X[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",l_,x(b.value?"Yes (has minions)":"No"),1)])])])])):(i(),r("div",Sh,[...X[1]||(X[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",r_,[X[13]||(X[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",c_,x(v.value)+" session"+x(v.value!==1?"s":""),1)])]))}},d_=te(u_,[["__scopeId","data-v-168bf04c"]]),f_=[{path:"/",name:"home",component:oi},{path:"/project/:projectId",name:"project",component:d_,props:!0},{path:"/session/:sessionId",name:"session",component:Hp,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Pv,props:!0}],m_=Ya({history:Qa(),routes:f_}),p_={class:"header-row1"},v_={class:"header-right"},h_=["title"],__={__name:"HeaderRow1",setup(n){const e=Ce(),s=it(),a=k(()=>s.uiConnected);return(l,c)=>(i(),r("div",p_,[c[6]||(c[6]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",v_,[t("div",{class:H(["header-indicator",a.value?"connected":"disconnected"])},[c[3]||(c[3]=t("span",{class:"indicator-dot"},null,-1)),ue(" "+x(a.value?"Connected":"Disconnected"),1)],2),t("button",{class:H(["header-btn theme-toggle-btn",{"theme-active":W(e).isRedBackground}]),onClick:c[0]||(c[0]=d=>W(e).toggleBackgroundColor()),title:W(e).isRedBackground?"Disable sensitive environment mode":"Enable sensitive environment mode"},[...c[4]||(c[4]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})],-1)])],10,h_),t("button",{class:"header-btn",onClick:c[1]||(c[1]=d=>W(e).showRestartModal()),title:"Restart server"}," â†» "),c[5]||(c[5]=t("button",{class:"header-btn",disabled:"",title:"Settings (coming soon)",style:{opacity:"0.4",cursor:"default"}}," âš™ ",-1)),t("button",{class:H(["header-btn panel-toggle-btn",{"panel-open":W(e).rightPanelVisible}]),onClick:c[2]||(c[2]=d=>W(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},g_=te(__,[["__scopeId","data-v-2d22058c"]]),b_=["title"],y_={class:"pill-icon"},w_={class:"pill-name"},k_={key:0,class:"pill-count"},$_={class:"pill-status-bar"},S_={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=Ge(),a=_e(),l=Ce(),c=k(()=>e.project.session_ids?.length||0),d=k(()=>c.value>1?"ðŸ”·":c.value===1?"ðŸ’¬":"ðŸ“"),g=k(()=>s.getStatusBarSegments(e.project.project_id,a));function u(){l.setBrowsingProject(e.project.project_id)}function f(){l.showModal("edit-project",{project:e.project})}return(h,S)=>(i(),r("div",{class:H(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:u,onContextmenu:ae(f,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",y_,x(d.value),1),t("span",w_,x(n.project.name),1),c.value>0?(i(),r("span",k_,x(c.value),1)):M("",!0),t("div",$_,[(i(!0),r(ee,null,le(g.value,(m,p)=>(i(),r("div",{key:p,class:H(["seg",m.status]),style:Pe({flex:m.flex})},null,6))),128))])],42,b_))}},x_=te(S_,[["__scopeId","data-v-ecccd6e9"]]),C_={__name:"ProjectPillBar",setup(n){const e=Ge(),s=_e(),a=Ce(),l=k(()=>e.orderedProjects),c=k(()=>a.browsingProjectId),d=k(()=>{const u=s.currentSession;return u?u.project_id:null});fe(d,u=>{u&&a.setBrowsingProject(u)}),fe(l,u=>{!c.value&&u.length>0&&a.setBrowsingProject(u[0].project_id)},{immediate:!0});function g(){a.showModal("create-project")}return(u,f)=>(i(),r("div",{class:H(["project-pill-bar",{"theme-red":W(a).isRedBackground}])},[(i(!0),r(ee,null,le(l.value,h=>(i(),Ee(x_,{key:h.project_id,project:h,isActive:h.project_id===d.value,isBrowsing:h.project_id===c.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:g,title:"New project"}," + ")],2))}},E_=te(C_,[["__scopeId","data-v-fcc3f866"]]),Kt=Qe("schedule",()=>{const n=L(new Map),e=L(new Map),s=L(null),a=L([]);function l(o){return n.value.get(o)||[]}function c(o){return e.value.get(o)||0}async function d(o){try{const $=(await ve.get(`/api/legions/${o}/schedules`)).schedules||[];return n.value.set(o,$),_(o,null),$}catch(y){return console.error("Failed to load schedules:",y),[]}}async function g(o,y){const E=(await ve.post(`/api/legions/${o}/schedules`,y)).schedule;return b(o,E),E}async function u(o,y,$){const D=(await ve.put(`/api/legions/${o}/schedules/${y}`,$)).schedule;return b(o,D),D}async function f(o,y){const $=await ve.post(`/api/legions/${o}/schedules/${y}/pause`);return b(o,$.schedule),$.schedule}async function h(o,y){const $=await ve.post(`/api/legions/${o}/schedules/${y}/resume`);return b(o,$.schedule),$.schedule}async function S(o,y){const $=await ve.post(`/api/legions/${o}/schedules/${y}/cancel`);return b(o,$.schedule),$.schedule}async function m(o,y){await ve.delete(`/api/legions/${o}/schedules/${y}`),v(o,y)}async function p(o,y,$=50,E=0){try{const D=await ve.get(`/api/legions/${o}/schedules/${y}/history?limit=${$}&offset=${E}`);return a.value=D.executions||[],a.value}catch(D){return console.error("Failed to load schedule history:",D),a.value=[],[]}}function w(o,y){!y||!y.schedule||(y.deleted?v(o,y.schedule.schedule_id):b(o,y.schedule))}function b(o,y){const $=n.value.get(o)||[],E=$.findIndex(D=>D.schedule_id===y.schedule_id);E>=0?$[E]=y:$.push(y),n.value.set(o,[...$]),_(o,null)}function v(o,y){const $=n.value.get(o)||[],E=new Set($.map(T=>T.minion_id)),D=$.filter(T=>T.schedule_id!==y);n.value.set(o,D),_(o,E),s.value===y&&(s.value=null,a.value=[])}function _(o,y){const $=n.value.get(o)||[],E=new Map;for(const O of $)O.status==="active"&&E.set(O.minion_id,(E.get(O.minion_id)||0)+1);const D=new Set($.map(O=>O.minion_id));if(y)for(const O of y)D.add(O);const T=new Map(e.value);for(const O of D)E.has(O)?T.set(O,E.get(O)):T.delete(O);e.value=T}return{schedulesByLegion:n,scheduleCountByMinion:e,selectedScheduleId:s,executionHistory:a,getSchedules:l,getScheduleCount:c,loadSchedules:d,createSchedule:g,updateSchedule:u,pauseSchedule:f,resumeSchedule:h,cancelSchedule:S,deleteSchedule:m,loadHistory:p,handleScheduleEvent:w}}),T_=Object.freeze(Object.defineProperty({__proto__:null,useScheduleStore:Kt},Symbol.toStringTag,{value:"Module"})),A_=["title"],D_={class:"ac-info"},M_={class:"ac-name"},O_={class:"ac-status"},L_={key:1,class:"ac-schedule-badge",title:"Has active schedules"},I_={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isParentOfActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select"],setup(n,{emit:e}){const s=n,a=e;_e();const l=Kt(),c=k(()=>l.getScheduleCount(s.session.session_id)>0),d=k(()=>s.session.name||s.session.role||"Agent"),g=k(()=>{const m=s.session.state;return m==="error"?"error":m==="paused"?"waiting":m==="active"&&s.session.is_processing?"active":m==="active"?"idle":"none"}),u=k(()=>{const m=s.session.state;return m==="active"&&s.session.is_processing?"Processing...":m==="active"?"Idle":m==="paused"?"Awaiting input":m==="error"?"Error":m==="terminated"?"Stopped":m==="starting"?"Starting...":m==="created"?"Ready":m||"Unknown"}),f=k(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),h=k(()=>{const m=[d.value];return s.session.role&&m.push(`Role: ${s.session.role}`),m.push(`Status: ${u.value}`),s.session.model&&m.push(`Model: ${s.session.model}`),m.join(`
`)});function S(){a("select",s.session.session_id)}return(m,p)=>(i(),r("div",{class:H(["agent-chip",{active:n.isActive,child:n.variant==="child","parent-of-active":n.isParentOfActive}]),onClick:S,title:h.value},[t("div",{class:H(["ac-dot",g.value])},null,2),t("div",D_,[t("div",M_,x(d.value),1),t("div",O_,x(u.value),1)]),f.value?(i(),r("div",{key:0,class:H(["ac-alert",f.value])},x(f.value==="error"?"!":"?"),3)):M("",!0),c.value?(i(),r("div",L_,[...p[0]||(p[0]=[t("svg",{width:"10",height:"10",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm0 14.5A6.5 6.5 0 1 1 8 1.5a6.5 6.5 0 0 1 0 13zM8.5 4H7v5l4.25 2.55.75-1.23L8.5 8.25V4z"})],-1)])])):M("",!0)],10,A_))}},cn=te(I_,[["__scopeId","data-v-a5533642"]]),N_=["title"],P_={class:"peek-letter"},j_={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=_e(),a=k(()=>s.getSession(e.sessionId)),l=k(()=>(a.value?.name||a.value?.role||"?").charAt(0).toUpperCase()),c=k(()=>({right:`${-22-e.index*22}px`,zIndex:20-e.index})),d=k(()=>{if(!a.value)return"dot-none";const f=a.value.state;return f==="active"&&a.value.is_processing?"dot-active":f==="active"?"dot-idle":f==="paused"?"dot-waiting":f==="error"?"dot-error":"dot-none"}),g=k(()=>a.value?a.value.has_pending_permission||a.value.state==="error":!1),u=k(()=>a.value?a.value.state==="error"?"alert-error":"alert-permission":"");return(f,h)=>(i(),r("div",{class:"peek-card",style:Pe(c.value),title:a.value?.name||"Child agent",onClick:h[0]||(h[0]=ae(S=>f.$emit("click"),["stop"]))},[t("div",{class:H(["peek-dot",d.value])},null,2),t("span",P_,x(l.value),1),g.value?(i(),r("div",{key:0,class:H(["peek-alert",u.value])},null,2)):M("",!0)],12,N_))}},R_=te(j_,[["__scopeId","data-v-7f1d4c1b"]]),Gn=44,Xn=12,B_={__name:"ChipConnector",props:{depth:{type:Number,default:1},maxDepth:{type:Number,default:1}},setup(n){const e=n,s=Gn-Xn*2,a=k(()=>{const l=e.maxDepth;let c;if(l<=1)c=Gn/2;else{const d=(e.depth-1)/(l-1);c=Xn+d*s}return{alignSelf:"flex-start",marginTop:`${Math.round(c)}px`}});return(l,c)=>(i(),r("div",{class:"chip-connector",style:Pe(a.value)},null,4))}},F_=te(B_,[["__scopeId","data-v-08d20738"]]),V_=["title"],U_=Object.assign({name:"StackedChip"},{__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},depth:{type:Number,default:1},maxDepth:{type:Number,default:0}},emits:["select"],setup(n){const e=n,s=_e(),a=Ce(),l=k(()=>s.currentSessionId),c=k(()=>e.session.child_minion_ids||[]);function d(o,y){if(!o?.child_minion_ids?.length)return y;let $=y;for(const E of o.child_minion_ids){const D=s.getSession(E);D&&($=Math.max($,d(D,y+1)))}return $}const g=k(()=>e.maxDepth>0?e.maxDepth:d(e.session,0)),u=k(()=>{if(!l.value)return!1;function o(y){if(!y)return!1;for(const $ of y){if($===l.value)return!0;const E=s.getSession($);if(E?.child_minion_ids&&o(E.child_minion_ids))return!0}return!1}return o(c.value)}),f=k(()=>!l.value||e.session.session_id===l.value?!1:u.value),h=k(()=>a.expandedStacks.has(e.session.session_id)||u.value),S=k(()=>c.value),m=k(()=>h.value||c.value.length===0?{}:{marginRight:`${c.value.length*22}px`});function p(o){return s.getSession(o)}function w(o){return s.getSession(o)?.child_minion_ids?.length>0}function b(o){const y=s.getSession(o);return y?.child_minion_ids?y.child_minion_ids.includes(l.value):!1}function v(){a.toggleStack(e.session.session_id)}function _(){h.value||a.toggleStack(e.session.session_id)}return(o,y)=>{const $=gn("StackedChip",!0);return i(),r("div",{class:"stacked-chip",style:Pe(m.value)},[t("div",{class:H(["parent-wrapper",{"has-children":c.value.length>0}])},[he(cn,{session:n.session,isActive:n.isActive,isParentOfActive:f.value,onSelect:y[0]||(y[0]=E=>o.$emit("select",n.session.session_id)),onDblclick:v},null,8,["session","isActive","isParentOfActive"]),!h.value&&c.value.length>0?(i(!0),r(ee,{key:0},le(S.value,(E,D)=>(i(),Ee(R_,{key:E,sessionId:E,index:D,onClick:_},null,8,["sessionId","index"]))),128)):M("",!0),c.value.length>0?(i(),r("div",{key:1,class:"stack-count",onClick:ae(v,["stop"]),title:`${c.value.length} child agent${c.value.length!==1?"s":""}`},x(c.value.length),9,V_)):M("",!0)],2),h.value?(i(!0),r(ee,{key:0},le(c.value,E=>(i(),r(ee,{key:E},[he(F_,{depth:n.depth,maxDepth:g.value},null,8,["depth","maxDepth"]),p(E)&&w(E)?(i(),Ee($,{key:0,session:p(E),isActive:E===l.value||b(E),depth:n.depth+1,maxDepth:g.value,onSelect:y[1]||(y[1]=D=>o.$emit("select",D))},null,8,["session","isActive","depth","maxDepth"])):p(E)?(i(),Ee(cn,{key:1,session:p(E),isActive:E===l.value,variant:"child",onSelect:D=>o.$emit("select",E)},null,8,["session","isActive","onSelect"])):M("",!0)],64))),128)):M("",!0)],4)}}}),W_=te(U_,[["__scopeId","data-v-9fa1837d"]]),H_={class:"strip-project-label"},q_={key:0,class:"strip-viewing-badge","aria-label":"Temporarily viewing this project"},z_={key:1,class:"strip-empty"},K_={__name:"AgentStrip",setup(n){const e=Ge(),s=_e(),a=Ce(),l=ls(),c=L(null),d=k(()=>{const y=s.currentSession;return y?y.project_id:null}),g=k(()=>d.value&&a.browsingProjectId!==d.value);function u(y){const $=c.value&&c.value.contains(y.target),E=y.target.closest(".project-pill-bar");!$&&!E&&(a.collapseAllStacks(),d.value&&a.browsingProjectId!==d.value&&a.setBrowsingProject(d.value))}Me(()=>{document.addEventListener("click",u,!0)}),Oe(()=>{document.removeEventListener("click",u,!0)});const f=k(()=>s.currentSessionId),h=k(()=>{const y=a.browsingProjectId;return y?e.getProject(y):null}),S=k(()=>{const y=h.value;return!y||!y.session_ids?[]:y.session_ids.map($=>s.getSession($)).filter(Boolean).sort(($,E)=>($.order||0)-(E.order||0))}),m=k(()=>{const y=new Set;for(const $ of S.value)if($.child_minion_ids)for(const E of $.child_minion_ids)y.add(E);return y}),p=k(()=>S.value.filter(y=>!m.value.has(y.session_id)));function w(y){return y.child_minion_ids&&y.child_minion_ids.length>0}function b(y){return y.child_minion_ids?y.child_minion_ids.includes(f.value):!1}function v(y){const $=s.getSession(y);$&&a.setBrowsingProject($.project_id),s.selectSession(y),l.push(`/session/${y}`)}function _(y){y.target.classList.contains("agent-strip")&&a.collapseAllStacks()}function o(){const y=h.value;y&&a.showModal("create-minion",{project:y})}return(y,$)=>h.value?(i(),r("div",{key:0,class:H(["agent-strip",{"theme-red":W(a).isRedBackground}]),ref_key:"stripEl",ref:c,onClick:_},[t("span",H_,x(h.value.name),1),g.value?(i(),r("span",q_,"VIEWING")):M("",!0),(i(!0),r(ee,null,le(p.value,E=>(i(),r(ee,{key:E.session_id},[w(E)?(i(),Ee(W_,{key:0,session:E,isActive:E.session_id===f.value||b(E),onSelect:v},null,8,["session","isActive"])):(i(),Ee(cn,{key:1,session:E,isActive:E.session_id===f.value,onSelect:v},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:ae(o,["stop"]),title:"Add agent"}," + "),p.value.length===0?(i(),r("span",z_,"No agents yet")):M("",!0)],2)):(i(),r("div",{key:1,class:H(["agent-strip agent-strip-empty",{"theme-red":W(a).isRedBackground}])},[...$[0]||($[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])],2))}},G_=te(K_,[["__scopeId","data-v-467721d6"]]),wn=Qe("diff",()=>{const n=L(new Map),e=L(!1),s=L(null),a=L("total"),l=L(!1),c=L(null),d=L(null),g=L(null),u=L(new Map),f=k(()=>{const C=_e();return C.currentSessionId&&n.value.get(C.currentSessionId)||null}),h=k(()=>!f.value||!f.value.files?[]:Object.entries(f.value.files).map(([C,A])=>({path:C,...A})).sort((C,A)=>C.path.localeCompare(A.path))),S=k(()=>h.value.length),m=k(()=>!f.value||!f.value.commits?0:f.value.commits.length),p=k(()=>f.value?.is_git_repo===!0),w=k(()=>{const C=g.value;if(C&&C!=="uncommitted"){const A=f.value;if(A?.commits){const N=A.commits.find(P=>P.hash===C);if(N?.files)return N.files.map(P=>({path:P})).sort((P,F)=>P.path.localeCompare(F.path))}return[]}return h.value}),b=k(()=>{if(!c.value||!d.value)return null;const C=g.value||"committed",A=`${c.value}:${C}:${d.value}`;return u.value.get(A)||null});async function v(C){if(C){e.value=!0,s.value=null;try{const A=await os(`/api/sessions/${C}/diff`);n.value.set(C,A),n.value=new Map(n.value)}catch(A){console.error(`Failed to load diff for session ${C}:`,A),s.value=A.message}finally{e.value=!1}}}async function _(C){for(const A of u.value.keys())A.startsWith(`${C}:`)&&u.value.delete(A);u.value=new Map(u.value),await v(C)}async function o(C,A,N=null){if(!C||!A)return;const F=`${C}:${N||"committed"}:${A}`,V=u.value.get(F);if(!(V&&!V.error&&V.content!==null)){u.value.set(F,{content:null,loading:!0,error:null}),u.value=new Map(u.value);try{const X={path:A};N&&(X.ref=N);const j=await os(`/api/sessions/${C}/diff/file`,{params:X});u.value.set(F,{content:j.diff,loading:!1,error:null})}catch(X){console.error(`Failed to load file diff for ${A}:`,X),u.value.set(F,{content:null,loading:!1,error:X.message})}u.value=new Map(u.value)}}function y(C,A,N=null){c.value=C,d.value=A,g.value=N,l.value=!0,o(C,A,N)}function $(){l.value=!1,g.value=null}function E(){if(!c.value)return;const C=w.value;if(C.length===0)return;const N=(C.findIndex(P=>P.path===d.value)+1)%C.length;d.value=C[N].path,o(c.value,d.value,g.value)}function D(){if(!c.value)return;const C=w.value;if(C.length===0)return;const N=(C.findIndex(P=>P.path===d.value)-1+C.length)%C.length;d.value=C[N].path,o(c.value,d.value,g.value)}function T(C){a.value=C}function O(C){n.value.delete(C),n.value=new Map(n.value);for(const A of u.value.keys())A.startsWith(`${C}:`)&&u.value.delete(A);u.value=new Map(u.value),c.value===C&&$()}return{diffBySession:n,loading:e,error:s,currentMode:a,fullViewOpen:l,fullViewSessionId:c,currentFilePath:d,fullViewRef:g,fileDiffCache:u,currentDiff:f,currentFiles:h,fileCount:S,commitCount:m,isGitRepo:p,fullViewFiles:w,currentFullViewFileDiff:b,loadDiff:v,refreshDiff:_,loadFileDiff:o,openFullView:y,closeFullView:$,nextFile:E,prevFile:D,setMode:T,clearDiff:O}}),X_={key:0,class:"agent-overview"},Y_={class:"overview-identity"},Q_={class:"overview-info"},J_={class:"overview-name"},Z_={key:0,class:"overview-role"},eg={class:"overview-stats"},tg={class:"stat-item"},sg={class:"stat-value"},ng={class:"stat-item"},og={class:"stat-value"},ag={class:"stat-item"},ig={class:"stat-value"},lg={class:"stat-item"},rg={class:"stat-value"},cg={key:1,class:"agent-overview agent-overview-empty"},ug={__name:"AgentOverview",setup(n){const e=_e(),s=Ne(),a=Ce(),l=L(Date.now());let c=null;Me(()=>{c=setInterval(()=>{l.value=Date.now()},1e4)}),Oe(()=>{c&&clearInterval(c)});const d=k(()=>{const o=e.currentSessionId;return o?e.getSession(o):null}),g=k(()=>(d.value?.name||"A").charAt(0).toUpperCase()),u=k(()=>{const o=d.value?.name||"";let y=0;for(let E=0;E<o.length;E++)y=o.charCodeAt(E)+((y<<5)-y);return`hsl(${Math.abs(y%360)}, 60%, 55%)`}),f=k(()=>{if(!d.value)return"status-none";const o=d.value.state;return o==="active"&&d.value.is_processing?"status-active":o==="active"?"status-idle":o==="paused"?"status-waiting":o==="error"?"status-error":o==="terminated"?"status-terminated":"status-none"}),h=k(()=>{if(!d.value)return"None";const o=d.value.state;return o==="active"&&d.value.is_processing?"Processing":o==="active"?"Idle":o==="paused"?"Paused":o==="error"?"Error":o==="terminated"?"Terminated":o==="created"?"Created":o==="starting"?"Starting":o}),S=k(()=>{const o=e.currentSessionId;if(!o)return 0;const y=s.messagesBySession.get(o);return y?y.filter($=>$.type==="user"||$.type==="assistant").length:0}),m=k(()=>{const o=e.currentSessionId;if(!o)return 0;const y=s.toolCallsBySession.get(o);return y?y.length:0}),p=k(()=>d.value&&d.value.child_minion_ids?.length||0),w=k(()=>{const o=e.currentSessionId;if(!o)return"--";const y=s.launchTimestampBySession.get(o);if(!y)return"--";const $=y*1e3;l.value;let E;const D=d.value?.state;D==="terminated"||D==="error"?E=d.value?.updated_at?new Date(d.value.updated_at).getTime():Date.now():E=Date.now();const T=E-$;if(T<0)return"--";if(T<6e4)return"< 1m";const O=Math.floor(T/6e4);if(O<60)return`${O}m`;const C=Math.floor(O/60);return C<24?`${C}h ${O%60}m`:`${Math.floor(C/24)}d ${C%24}h`});function b(){d.value&&a.showModal("edit-session",{session:d.value})}function v(){d.value&&a.showModal("manage-session",{session:d.value})}function _(){d.value&&a.showModal("session-info",{sessionId:d.value.session_id})}return(o,y)=>d.value?(i(),r("div",X_,[t("div",Y_,[t("div",{class:"overview-avatar",style:Pe({background:u.value})},x(g.value),5),t("div",Q_,[t("div",J_,x(d.value.name||"Agent"),1),d.value.role?(i(),r("div",Z_,x(d.value.role),1)):M("",!0),t("span",{class:H(["overview-status-badge",f.value])},x(h.value),3)])]),t("div",eg,[t("div",tg,[t("span",sg,x(S.value),1),y[0]||(y[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",ng,[t("span",og,x(m.value),1),y[1]||(y[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",ag,[t("span",ig,x(p.value),1),y[2]||(y[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",lg,[t("span",rg,x(w.value),1),y[3]||(y[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview",onClick:_,title:"View session details"}," Info "),t("button",{class:"btn-overview",onClick:b,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:v,title:"Manage session lifecycle"}," Manage ")])])):(i(),r("div",cg,[...y[4]||(y[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},dg=te(ug,[["__scopeId","data-v-4ef00321"]]),fg={class:"task-row d-flex align-items-center gap-2"},mg={key:0,class:"status-icon"},pg={key:1,class:"status-icon"},vg=["title"],hg={key:0,class:"task-details"},_g={key:0,class:"task-description mb-2"},gg={class:"description-content"},bg={key:1,class:"task-owner mb-2"},yg={class:"ms-1"},wg={key:2,class:"task-blocked-by mb-2"},kg={key:3,class:"task-blocks"},$g={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=k(()=>e.task.status==="in_progress"),a=k(()=>e.task.status==="completed"?"âœ…":"â³"),l=k(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),c=k(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(d,g)=>(i(),r("div",{class:H(["task-item",c.value]),onClick:g[0]||(g[0]=u=>d.$emit("toggle"))},[t("div",fg,[s.value?(i(),r("span",mg,[...g[1]||(g[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),r("span",pg,x(a.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},x(l.value),9,vg),(i(),r("svg",{class:H(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...g[2]||(g[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),r("div",hg,[n.task.description?(i(),r("div",_g,[g[3]||(g[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",gg,x(n.task.description),1)])):M("",!0),n.task.owner?(i(),r("div",bg,[g[4]||(g[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",yg,x(n.task.owner),1)])):M("",!0),n.task.blockedBy?.length>0?(i(),r("div",wg,[g[5]||(g[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),r(ee,null,le(n.task.blockedBy,u=>(i(),r("span",{key:u,class:"badge bg-warning text-dark me-1"}," #"+x(u),1))),128))])):M("",!0),n.task.blocks?.length>0?(i(),r("div",kg,[g[6]||(g[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),r(ee,null,le(n.task.blocks,u=>(i(),r("span",{key:u,class:"badge bg-info text-dark me-1"}," #"+x(u),1))),128))])):M("",!0)])):M("",!0)],2))}},Sg=te($g,[["__scopeId","data-v-0f96ae87"]]),xg={key:0,class:"queue-section"},Cg={key:0,class:"badge bg-primary"},Eg={class:"ms-auto d-flex align-items-center gap-1"},Tg=["title"],Ag={class:"history-count"},Dg={key:0,class:"queue-items"},Mg=["title"],Og={key:0,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},Lg={key:1,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},Ig={key:2,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},Ng={key:3,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},Pg=["title"],jg=["onClick"],Rg=["onClick"],Bg={__name:"QueueSection",setup(n){const e=Wo(),s=_e(),a=L(!1),l=L(!1),c=k(()=>s.currentSessionId);fe(c,v=>{v&&e.fetchQueue(v)},{immediate:!0});const d=k(()=>c.value?e.getItems(c.value):[]),g=k(()=>d.value.filter(v=>v.status==="sent"||v.status==="failed"||v.status==="cancelled").length),u=k(()=>l.value?d.value:d.value.filter(v=>v.status==="pending")),f=k(()=>c.value?e.getPendingCount(c.value):0),h=k(()=>c.value?e.isPaused(c.value)?!0:s.sessions.get(c.value)?.queue_paused||!1:!1);function S(v,_){return v?v.length>_?v.slice(0,_)+"...":v:""}async function m(v){c.value&&await e.cancelItem(c.value,v)}async function p(v){c.value&&await e.requeueItem(c.value,v)}async function w(){c.value&&await e.pauseQueue(c.value,!0)}async function b(){c.value&&await e.pauseQueue(c.value,!1)}return(v,_)=>d.value.length>0||h.value?(i(),r("div",xg,[t("div",{class:"queue-header d-flex align-items-center gap-2 px-3 py-2",onClick:_[1]||(_[1]=o=>a.value=!a.value)},[(i(),r("svg",{class:H(["chevron-icon",{expanded:!a.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[..._[2]||(_[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),_[4]||(_[4]=t("span",{class:"section-title"},"Message Queue",-1)),f.value>0?(i(),r("span",Cg,x(f.value),1)):M("",!0),t("div",Eg,[g.value>0?(i(),r("button",{key:0,class:"btn btn-sm btn-link text-muted p-0 history-toggle",title:l.value?"Hide history":`Show history (${g.value})`,onClick:_[0]||(_[0]=ae(o=>l.value=!l.value,["stop"]))},[_[3]||(_[3]=t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"}),t("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"}),t("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"})],-1)),t("span",Ag,x(g.value),1)],8,Tg)):M("",!0),h.value?(i(),r("button",{key:1,class:"btn btn-sm btn-outline-success",title:"Resume queue",onClick:ae(b,["stop"])}," Resume ")):f.value>0?(i(),r("button",{key:2,class:"btn btn-sm btn-outline-warning",title:"Pause queue",onClick:ae(w,["stop"])}," Pause ")):M("",!0)])]),a.value?M("",!0):(i(),r("div",Dg,[(i(!0),r(ee,null,le(u.value,o=>(i(),r("div",{key:o.queue_id,class:H(["queue-item d-flex align-items-center gap-2 px-3 py-1","status-"+o.status])},[t("span",{class:H(["status-icon","icon-"+o.status]),title:o.status},[o.status==="sent"?(i(),r("svg",Og,[..._[5]||(_[5]=[t("path",{d:"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm3.78 4.97a.75.75 0 0 0-1.06 0L7 8.69 5.28 6.97a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.06 0l4.25-4.25a.75.75 0 0 0 0-1.06z"},null,-1)])])):o.status==="pending"?(i(),r("svg",Lg,[..._[6]||(_[6]=[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm.5 4.5v3.793l2.354 2.353a.5.5 0 0 1-.708.708l-2.5-2.5A.5.5 0 0 1 7.5 8.5V4.5a.5.5 0 0 1 1 0z"},null,-1)])])):o.status==="failed"?(i(),r("svg",Ig,[..._[7]||(_[7]=[t("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"},null,-1)])])):(i(),r("svg",Ng,[..._[8]||(_[8]=[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.354 4.646a.5.5 0 0 1 0 .708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708L8 7.293l2.646-2.647a.5.5 0 0 1 .708 0z"},null,-1)])]))],10,Mg),t("span",{class:"item-content flex-grow-1",title:o.content},x(S(o.content,60)),9,Pg),o.status==="pending"?(i(),r("button",{key:0,class:"btn btn-sm btn-link text-danger p-0 action-btn",title:"Cancel",onClick:y=>m(o.queue_id)},[..._[9]||(_[9]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,jg)):M("",!0),o.status==="sent"||o.status==="failed"?(i(),r("button",{key:1,class:"btn btn-sm btn-link text-primary p-0 action-btn",title:"Re-queue",onClick:y=>p(o.queue_id)},[..._[10]||(_[10]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"}),t("path",{"fill-rule":"evenodd",d:"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"})],-1)])],8,Rg)):M("",!0)],2))),128))]))])):M("",!0)}},Fg=te(Bg,[["__scopeId","data-v-2929e705"]]),Vg={class:"task-list-panel"},Ug={class:"task-list p-2"},Wg={key:0,class:"empty-placeholder"},Hg={__name:"TaskListPanel",setup(n){const e=as(),s=L(new Set),a=k(()=>e.currentTasks);function l(c){s.value.has(c)?s.value.delete(c):s.value.add(c),s.value=new Set(s.value)}return(c,d)=>(i(),r("div",Vg,[t("div",Ug,[a.value.length===0?(i(),r("div",Wg,[...d[0]||(d[0]=[t("span",null,"Tasks will appear here as the agent works",-1)])])):M("",!0),he(Ja,{name:"task-list",tag:"div"},{default:bn(()=>[(i(!0),r(ee,null,le(a.value,g=>(i(),Ee(Sg,{key:g.id,task:g,isExpanded:s.value.has(g.id),onToggle:u=>l(g.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]),he(Fg)]))}},qg=te(Hg,[["__scopeId","data-v-d63cd00c"]]),zg={class:"resource-gallery-panel"},Kg={key:0,class:"view-toggle"},Gg={class:"resource-grid-container p-2"},Xg={key:0,class:"empty-placeholder"},Yg={key:1,class:"resource-grid"},Qg=["onClick"],Jg=["onClick","title"],Zg=["src","alt"],eb=["title","onClick"],tb={class:"file-icon"},sb={class:"file-ext"},nb={class:"resource-info"},ob=["title"],ab={class:"resource-actions"},ib=["onClick"],lb=["href","download"],rb={key:2,class:"resource-list"},cb=["onClick"],ub={class:"list-item-icon"},db=["title"],fb={class:"list-item-actions"},mb=["onClick"],pb=["href","download"],vb=["onClick"],Yn="resource-view-preference",hb={__name:"ResourceGallery",setup(n,{expose:e}){const s=st(),a=_e(),l=Po("addAttachmentFromResource",null),c=L(localStorage.getItem(Yn)||"gallery");function d(o){c.value=o}fe(c,o=>{localStorage.setItem(Yn,o)}),e({viewMode:c,setViewMode:d});const g=k(()=>s.currentResources);function u(o){return s.isImageResource(o)}function f(o){return s.getResourceIcon(o)}function h(o){const y=s.getResourceExtension(o);return y?y.toUpperCase().slice(1):""}function S(o){return s.getResourceUrl(a.currentSessionId,o)}function m(o){return s.getDownloadUrl(a.currentSessionId,o)}function p(o){s.openFullView(a.currentSessionId,o)}function w(o,y=18){return o?o.length<=y?o:o.substring(0,y-3)+"...":""}function b(o){o.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function v(o){s.removeResource(a.currentSessionId,o)}function _(o){l?l(o):console.warn("addAttachmentFromResource not provided")}return(o,y)=>(i(),r("div",zg,[g.value.length>0?(i(),r("div",Kg,[t("button",{class:H(["toggle-btn",{active:c.value==="gallery"}]),onClick:y[0]||(y[0]=$=>d("gallery")),title:"Gallery view","aria-label":"Gallery view"},[...y[4]||(y[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zm8 0A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm-8 8A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm8 0A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3z"})],-1)])],2),t("button",{class:H(["toggle-btn",{active:c.value==="list"}]),onClick:y[1]||(y[1]=$=>d("list")),title:"List view","aria-label":"List view"},[...y[5]||(y[5]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})],-1)])],2)])):M("",!0),t("div",Gg,[g.value.length===0?(i(),r("div",Xg,[...y[6]||(y[6]=[t("span",null,"Resources shared by the agent will appear here",-1)])])):c.value==="gallery"?(i(),r("div",Yg,[(i(!0),r(ee,null,le(g.value,($,E)=>(i(),r("div",{key:$.resource_id,class:H(["resource-item",{"is-image":u($)}])},[t("button",{class:"remove-btn",onClick:ae(D=>v($.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...y[7]||(y[7]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,Qg),u($)?(i(),r("div",{key:0,class:"resource-thumbnail",onClick:D=>p(E),title:$.title||"Click to view"},[t("img",{src:S($.resource_id),alt:$.title||"Image",loading:"lazy",onError:b},null,40,Zg)],8,Jg)):(i(),r("div",{key:1,class:"resource-placeholder",title:$.title||$.original_filename||"Click to view",onClick:D=>p(E)},[t("span",tb,x(f($)),1),t("span",sb,x(h($)),1)],8,eb)),t("div",nb,[t("div",{class:"resource-title",title:$.title||$.original_filename},x(w($.title||$.original_filename)),9,ob),t("div",ab,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ae(D=>_($),["stop"]),title:"Add to message attachments"},[...y[8]||(y[8]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,ib),t("a",{href:m($.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:$.original_filename||$.title||"download",title:"Download",onClick:y[2]||(y[2]=ae(()=>{},["stop"]))},[...y[9]||(y[9]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,lb)])])],2))),128))])):(i(),r("div",rb,[(i(!0),r(ee,null,le(g.value,($,E)=>(i(),r("div",{key:$.resource_id,class:"resource-list-item",onClick:D=>p(E)},[t("span",ub,x(f($)),1),t("span",{class:"list-item-title",title:$.title||$.original_filename},x($.title||$.original_filename||"Untitled"),9,db),t("div",fb,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ae(D=>_($),["stop"]),title:"Add to message attachments"},[...y[10]||(y[10]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,mb),t("a",{href:m($.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:$.original_filename||$.title||"download",title:"Download",onClick:y[3]||(y[3]=ae(()=>{},["stop"]))},[...y[11]||(y[11]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,pb),t("button",{class:"btn btn-sm btn-outline-danger action-btn",onClick:ae(D=>v($.resource_id),["stop"]),title:"Remove from panel"},[...y[12]||(y[12]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,vb)])],8,cb))),128))]))])]))}},_b=te(hb,[["__scopeId","data-v-4acc54e9"]]),gb=["src","alt"],bb={key:1,class:"resource-info"},yb={key:0,class:"resource-title"},wb={key:1,class:"resource-description"},kb={class:"resource-meta"},$b={class:"meta-item"},Sb={class:"meta-item"},xb={class:"meta-item"},Cb={class:"text-header"},Eb={class:"text-header-info"},Tb={class:"text-filename"},Ab={class:"resource-meta"},Db={key:0,class:"meta-item"},Mb={key:1,class:"meta-item"},Ob={key:0,class:"display-mode-toggle"},Lb=["title","disabled"],Ib={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Nb={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Pb={class:"copy-label"},jb={class:"text-body"},Rb={key:0,class:"text-loading"},Bb={key:1,class:"text-error"},Fb={key:2,class:"text-content"},Vb=["innerHTML"],Ub={key:4,class:"text-unavailable"},Wb={key:4,class:"position-indicator"},Hb={key:5,class:"thumbnail-strip"},qb=["onClick"],zb=["src","alt"],Kb={key:1,class:"strip-text-icon"},Gb={__name:"ResourceFullView",setup(n){Ye.setOptions({breaks:!0,gfm:!0});const e=st(),s=L(null),a=L(!1),l=L("raw");let c=null;const d=k(()=>e.fullViewOpen),g=k(()=>e.currentFullViewResource),u=k(()=>e.currentResourceIndex),f=k(()=>e.fullViewTotalResources),h=k(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),S=k(()=>e.isImageResource(g.value)),m=k(()=>g.value?e.getTextContent(g.value.resource_id):null),p=k(()=>m.value?.content||null),w=k(()=>m.value?.loading||!1),b=k(()=>m.value?.error||null),v=k(()=>{if(!p.value)return"";let P=Ye.parse(p.value);return P=P.replace(/\n</g,"<"),P=P.replace(/\n+$/,""),qt.sanitize(P)});fe(d,P=>{P?(Fe(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),fe(u,()=>{l.value="raw"}),fe([u,d],()=>{if(d.value&&g.value&&!S.value){const P=g.value.resource_id,F=e.getTextContent(P);(!F||F.error)&&e.fetchTextContent(e.fullViewSessionId,P)}},{immediate:!0}),Oe(()=>{document.body.style.overflow="",c&&clearTimeout(c)});function _(P){return e.getResourceUrl(e.fullViewSessionId,P)}function o(){e.closeFullView()}function y(){e.nextResource()}function $(){e.prevResource()}function E(P){e.goToResource(P)}function D(P){P.target===P.currentTarget&&o()}function T(P){switch(P.key){case"Escape":o();break;case"ArrowLeft":$();break;case"ArrowRight":y();break;case"Home":E(0);break;case"End":E(f.value-1);break;case"m":!S.value&&p.value&&(l.value=l.value==="raw"?"markdown":"raw");break}}async function O(){if(p.value)try{await navigator.clipboard.writeText(p.value),a.value=!0,c&&clearTimeout(c),c=setTimeout(()=>{a.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function C(P){return P?P<1024?`${P} B`:P<1024*1024?`${(P/1024).toFixed(1)} KB`:`${(P/(1024*1024)).toFixed(2)} MB`:""}function A(P){return P?new Date(P*1e3).toLocaleString():""}function N(P){P.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(P,F)=>(i(),Ee(Ro,{to:"body"},[he(jo,{name:"modal"},{default:bn(()=>[d.value?(i(),r("div",{key:0,class:"resource-full-view-overlay",onClick:D,onKeydown:T,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ae(o,["stop"]),title:"Close (Escape)"},[...F[4]||(F[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),f.value>1?(i(),r("button",{key:0,class:"nav-btn nav-prev",onClick:ae($,["stop"]),title:"Previous (Left Arrow)"},[...F[5]||(F[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):M("",!0),S.value?(i(),r("div",{key:1,class:"image-container",onClick:F[0]||(F[0]=ae(()=>{},["stop"]))},[g.value?(i(),r("img",{key:0,src:_(g.value.resource_id||g.value.image_id),alt:g.value.title||"Image",class:"full-image",onError:N},null,40,gb)):M("",!0),g.value?(i(),r("div",bb,[g.value.title?(i(),r("h5",yb,x(g.value.title),1)):M("",!0),g.value.description?(i(),r("p",wb,x(g.value.description),1)):M("",!0),t("div",kb,[t("span",$b,x(C(g.value.size_bytes)),1),t("span",Sb,x(g.value.format?.toUpperCase()),1),t("span",xb,x(A(g.value.timestamp)),1)])])):M("",!0)])):(i(),r("div",{key:2,class:"text-container",onClick:F[3]||(F[3]=ae(()=>{},["stop"]))},[t("div",Cb,[t("div",Eb,[t("h5",Tb,x(g.value?.title||g.value?.original_filename||"Text Resource"),1),t("div",Ab,[g.value?.size_bytes?(i(),r("span",Db,x(C(g.value.size_bytes)),1)):M("",!0),g.value?.format?(i(),r("span",Mb,x(g.value.format.toUpperCase()),1)):M("",!0)])]),p.value?(i(),r("div",Ob,[t("button",{class:H(["toggle-btn",{active:l.value==="raw"}]),onClick:F[1]||(F[1]=ae(V=>l.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:H(["toggle-btn",{active:l.value==="markdown"}]),onClick:F[2]||(F[2]=ae(V=>l.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):M("",!0),t("button",{class:"copy-btn",onClick:ae(O,["stop"]),title:a.value?"Copied!":l.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!p.value},[a.value?(i(),r("svg",Ib,[...F[6]||(F[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),r("svg",Nb,[...F[7]||(F[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Pb,x(a.value?"Copied!":l.value==="markdown"?"Copy raw":"Copy"),1)],8,Lb)]),t("div",jb,[w.value?(i(),r("div",Rb,[...F[8]||(F[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):b.value?(i(),r("div",Bb," Failed to load content: "+x(b.value),1)):p.value&&l.value==="raw"?(i(),r("pre",Fb,x(p.value),1)):p.value&&l.value==="markdown"?(i(),r("div",{key:3,class:"markdown-content",innerHTML:v.value},null,8,Vb)):(i(),r("div",Ub," Preview not available for this file type. "))])])),f.value>1?(i(),r("button",{key:3,class:"nav-btn nav-next",onClick:ae(y,["stop"]),title:"Next (Right Arrow)"},[...F[9]||(F[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):M("",!0),f.value>1?(i(),r("div",Wb,x(u.value+1)+" / "+x(f.value),1)):M("",!0),f.value>1?(i(),r("div",Hb,[(i(!0),r(ee,null,le(h.value,(V,X)=>(i(),r("div",{key:V.resource_id||V.image_id,class:H(["strip-thumbnail",{active:X===u.value,"is-text":!W(e).isImageResource(V)}]),onClick:ae(j=>E(X),["stop"])},[W(e).isImageResource(V)?(i(),r("img",{key:0,src:_(V.resource_id||V.image_id),alt:V.title||"Thumbnail",loading:"lazy"},null,8,zb)):(i(),r("span",Kb,x(W(e).getResourceIcon(V)),1))],10,qb))),128))])):M("",!0)],544)):M("",!0)]),_:1})]))}},Xb=te(Gb,[["__scopeId","data-v-169421b1"]]),Yb={class:"diff-panel"},Qb={class:"diff-body"},Jb={key:0,class:"text-center py-4"},Zb={key:1,class:"empty-placeholder"},ey={key:2,class:"empty-placeholder"},ty={key:3,class:"text-danger text-center py-4"},sy={class:"mb-0 small"},ny={key:4,class:"empty-placeholder"},oy=["disabled"],ay={key:5},iy={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},ly=["disabled"],ry={class:"stats-bar px-3 py-1 border-bottom small text-muted"},cy={class:"text-success"},uy={class:"text-danger"},dy={class:"ms-2"},fy={key:0,class:"ms-2"},my={key:0,class:"file-list"},py=["onClick"],vy=["title"],hy={key:0,class:"file-stats small text-nowrap"},_y={key:0,class:"text-success"},gy={key:1,class:"text-muted"},by={key:2,class:"text-danger"},yy={key:1,class:"file-stats small text-muted"},wy={key:1,class:"commit-list"},ky=["onClick"],$y={key:0,class:"wip-badge"},Sy={key:1,class:"commit-hash"},xy=["title"],Cy={key:2,class:"commit-date small text-muted text-nowrap"},Ey={key:0,class:"commit-files"},Ty=["onClick"],Ay=["title"],Dy={key:6,class:"empty-placeholder"},My={__name:"DiffPanel",setup(n){const e=wn(),s=_e(),a=L(new Set);function l(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function c(h,S=null){s.currentSessionId&&e.openFullView(s.currentSessionId,h,S)}function d(h){a.value.has(h)?a.value.delete(h):a.value.add(h),a.value=new Set(a.value)}function g(h){switch(h){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function u(h){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[h]?.status||"modified"}function f(h){if(!h)return"";const S=new Date(h),p=new Date-S,w=Math.floor(p/6e4);if(w<1)return"just now";if(w<60)return`${w}m ago`;const b=Math.floor(w/60);return b<24?`${b}h ago`:`${Math.floor(b/24)}d ago`}return fe(()=>s.currentSessionId,h=>{h&&!e.diffBySession.get(h)&&e.loadDiff(h)},{immediate:!0}),fe(()=>e.currentDiff,h=>{if(h?.commits){const S=h.commits.find(m=>m.is_uncommitted);S&&(a.value.add(S.hash),a.value=new Set(a.value))}},{immediate:!0}),(h,S)=>(i(),r("div",Yb,[t("div",Qb,[W(e).loading&&!W(e).currentDiff?(i(),r("div",Jb,[...S[2]||(S[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):W(e).currentDiff&&!W(e).isGitRepo?(i(),r("div",Zb,[...S[3]||(S[3]=[t("span",null,"Not a git repository",-1)])])):W(e).currentDiff&&W(e).currentDiff.error?(i(),r("div",ey,[t("span",null,x(W(e).currentDiff.error),1)])):W(e).error?(i(),r("div",ty,[t("p",sy,x(W(e).error),1)])):W(e).currentDiff&&W(e).fileCount===0?(i(),r("div",ny,[S[6]||(S[6]=t("span",null,"No changes since main",-1)),t("button",{class:"refresh-inline",onClick:l,disabled:W(e).loading,title:"Refresh diff"},[(i(),r("svg",{class:H({spin:W(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...S[4]||(S[4]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2)),S[5]||(S[5]=ue(" Refresh ",-1))],8,oy)])):W(e).currentDiff&&W(e).fileCount>0?(i(),r("div",ay,[t("div",iy,[t("button",{class:H(["btn btn-sm",W(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:S[0]||(S[0]=m=>W(e).setMode("total"))}," Total Changes ",2),t("button",{class:H(["btn btn-sm",W(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:S[1]||(S[1]=m=>W(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:l,title:"Refresh diff",disabled:W(e).loading},[(i(),r("svg",{class:H({spin:W(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...S[7]||(S[7]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,ly)]),t("div",ry,[t("span",cy,"+"+x(W(e).currentDiff.total_insertions),1),S[8]||(S[8]=t("span",{class:"mx-1"},"/",-1)),t("span",uy,"-"+x(W(e).currentDiff.total_deletions),1),t("span",dy,x(W(e).fileCount)+" file"+x(W(e).fileCount!==1?"s":""),1),W(e).commitCount>0?(i(),r("span",fy,x(W(e).commitCount)+" commit"+x(W(e).commitCount!==1?"s":""),1)):M("",!0)]),W(e).currentMode==="total"?(i(),r("div",my,[(i(!0),r(ee,null,le(W(e).currentFiles,m=>(i(),r("div",{key:m.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:p=>c(m.path,null)},[t("span",{class:H(["status-icon","status-"+m.status])},x(g(m.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:m.path},x(m.path),9,vy),m.is_binary?(i(),r("span",yy,"binary")):(i(),r("span",hy,[m.insertions>0?(i(),r("span",_y,"+"+x(m.insertions),1)):M("",!0),m.insertions>0&&m.deletions>0?(i(),r("span",gy,"/")):M("",!0),m.deletions>0?(i(),r("span",by,"-"+x(m.deletions),1)):M("",!0)]))],8,py))),128))])):(i(),r("div",wy,[(i(!0),r(ee,null,le(W(e).currentDiff.commits,m=>(i(),r("div",{key:m.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:p=>d(m.hash)},[(i(),r("svg",{class:H(["chevron-icon",{expanded:a.value.has(m.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...S[9]||(S[9]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),m.is_uncommitted?(i(),r("span",$y,"WIP")):(i(),r("code",Sy,x(m.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:m.message},x(m.message),9,xy),m.is_uncommitted?M("",!0):(i(),r("span",Cy,x(f(m.date)),1))],8,ky),a.value.has(m.hash)?(i(),r("div",Ey,[(i(!0),r(ee,null,le(m.files,p=>(i(),r("div",{key:p,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:w=>c(p,m.is_uncommitted?"uncommitted":m.hash)},[t("span",{class:H(["status-icon","status-"+u(p)])},x(g(u(p))),3),t("span",{class:"file-path text-truncate small",title:p},x(p),9,Ay)],8,Ty))),128))])):M("",!0)]))),128))]))])):(i(),r("div",Dy,[...S[10]||(S[10]=[t("span",null,"No diff data available",-1)])]))])]))}},Oy=te(My,[["__scopeId","data-v-164fd7bb"]]),Ly={class:"diff-header"},Iy={class:"diff-header-info"},Ny={class:"diff-filename"},Py={class:"diff-meta"},jy={key:0,class:"commit-ref-badge"},Ry={class:"commit-ref-msg"},By={key:2,class:"meta-item"},Fy={class:"text-success"},Vy={class:"text-danger"},Uy=["title","disabled"],Wy={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Hy={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},qy={class:"copy-label"},zy={class:"diff-body"},Ky={key:0,class:"diff-loading"},Gy={key:1,class:"diff-error"},Xy={key:2,class:"diff-content"},Yy={class:"diff-table"},Qy={class:"line-num line-num-old"},Jy={class:"line-num line-num-new"},Zy={class:"line-content"},e1={class:"line-prefix"},t1={key:3,class:"diff-empty"},s1={key:2,class:"position-indicator"},n1={__name:"DiffFullView",setup(n){const e=wn(),s=L(null),a=L(!1);let l=null;const c=k(()=>e.fullViewOpen),d=k(()=>e.currentFullViewFileDiff),g=k(()=>d.value?.content||null),u=k(()=>e.fullViewFiles.length),f=k(()=>e.currentFilePath?e.fullViewFiles.findIndex(o=>o.path===e.currentFilePath):0),h=k(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),S=k(()=>{const o=e.fullViewRef;if(!o||o==="uncommitted")return null;const y=e.currentDiff;return y?.commits&&y.commits.find($=>$.hash===o)||null}),m=k(()=>{if(!g.value)return[];const o=g.value.split(`
`),y=[];let $=0,E=0;for(const D of o){if(D.startsWith("diff --git")||D.startsWith("index ")||D.startsWith("---")||D.startsWith("+++")||D.startsWith("new file")||D.startsWith("deleted file")||D.startsWith("similarity")||D.startsWith("rename")||D.startsWith("Binary")){D.startsWith("Binary")&&y.push({type:"info",prefix:"",text:D,oldNum:null,newNum:null});continue}if(D.startsWith("@@")){const T=D.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);T&&($=parseInt(T[1]),E=parseInt(T[2]),y.push({type:"hunk",prefix:"",text:D,oldNum:null,newNum:null}));continue}D.startsWith(" ")||D.length>0&&!D.startsWith("+")&&!D.startsWith("-")&&!D.startsWith("\\")?(y.push({type:"context",prefix:" ",text:D.substring(1),oldNum:$,newNum:E}),$++,E++):D.startsWith("+")?(y.push({type:"add",prefix:"+",text:D.substring(1),oldNum:null,newNum:E}),E++):D.startsWith("-")?(y.push({type:"remove",prefix:"-",text:D.substring(1),oldNum:$,newNum:null}),$++):D.startsWith("\\")&&y.push({type:"info",prefix:"",text:D,oldNum:null,newNum:null})}return y});function p(o){return`diff-line diff-line-${o.type}`}function w(){e.closeFullView()}function b(o){o.target===o.currentTarget&&w()}function v(o){switch(o.key){case"Escape":w();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function _(){if(g.value)try{await navigator.clipboard.writeText(g.value),a.value=!0,l&&clearTimeout(l),l=setTimeout(()=>{a.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return fe(c,o=>{o?(Fe(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Oe(()=>{document.body.style.overflow="",l&&clearTimeout(l)}),(o,y)=>(i(),Ee(Ro,{to:"body"},[he(jo,{name:"modal"},{default:bn(()=>[c.value?(i(),r("div",{key:0,class:"diff-full-view-overlay",onClick:b,onKeydown:v,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ae(w,["stop"]),title:"Close (Escape)"},[...y[3]||(y[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),u.value>1?(i(),r("button",{key:0,class:"nav-btn nav-prev",onClick:y[0]||(y[0]=ae($=>W(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...y[4]||(y[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):M("",!0),t("div",{class:"diff-container",onClick:y[1]||(y[1]=ae(()=>{},["stop"]))},[t("div",Ly,[t("div",Iy,[t("h5",Ny,x(W(e).currentFilePath),1),t("div",Py,[S.value?(i(),r("span",jy,[t("code",null,x(S.value.short_hash),1),t("span",Ry,x(S.value.message),1)])):M("",!0),h.value?(i(),r("span",{key:1,class:H(["meta-badge","status-"+h.value.status])},x(h.value.status),3)):M("",!0),h.value&&!h.value.is_binary?(i(),r("span",By,[t("span",Fy,"+"+x(h.value.insertions),1),y[5]||(y[5]=ue(" / ",-1)),t("span",Vy,"-"+x(h.value.deletions),1)])):M("",!0)])]),t("button",{class:"copy-btn",onClick:ae(_,["stop"]),title:a.value?"Copied!":"Copy diff to clipboard",disabled:!g.value},[a.value?(i(),r("svg",Wy,[...y[6]||(y[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),r("svg",Hy,[...y[7]||(y[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",qy,x(a.value?"Copied!":"Copy"),1)],8,Uy)]),t("div",zy,[d.value&&d.value.loading?(i(),r("div",Ky,[...y[8]||(y[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):d.value&&d.value.error?(i(),r("div",Gy," Failed to load diff: "+x(d.value.error),1)):g.value?(i(),r("div",Xy,[t("table",Yy,[t("tbody",null,[(i(!0),r(ee,null,le(m.value,($,E)=>(i(),r("tr",{key:E,class:H(p($))},[t("td",Qy,x($.oldNum||""),1),t("td",Jy,x($.newNum||""),1),t("td",Zy,[t("span",e1,x($.prefix),1),t("span",null,x($.text),1)])],2))),128))])])])):(i(),r("div",t1," No diff available for this file. "))])]),u.value>1?(i(),r("button",{key:1,class:"nav-btn nav-next",onClick:y[2]||(y[2]=ae($=>W(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...y[9]||(y[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):M("",!0),u.value>1?(i(),r("div",s1,x(f.value+1)+" / "+x(u.value),1)):M("",!0)],544)):M("",!0)]),_:1})]))}},o1=te(n1,[["__scopeId","data-v-1c2aa9a4"]]),a1={class:"comms-panel"},i1={key:0,class:"empty-placeholder"},l1=["onClick"],r1={class:"comm-meta"},c1={class:"comm-icon"},u1={class:"comm-type"},d1={class:"comm-direction"},f1={class:"comm-time"},m1={class:"comm-summary"},p1=["innerHTML"],v1="ffffffff-ffff-ffff-ffff-ffffffffffff",h1="00000000-0000-0000-0000-000000000000",_1={__name:"CommsPanel",setup(n){const e=_e(),s=zt(),a=it(),l=L(null),c=L(new Set);Ye.setOptions({breaks:!0,gfm:!0});const d=k(()=>e.currentSession?.project_id||null),g=k(()=>e.currentSessionId),u=k(()=>{if(!d.value)return[];const E=s.commsByLegion.get(d.value)||[],D=g.value;return D?E.filter(T=>T.from_minion_id===D||T.to_minion_id===D):[]}),f=[{bg:"#fef3c7",border:"#fde68a"},{bg:"#fce7f3",border:"#fbcfe8"},{bg:"#e0e7ff",border:"#c7d2fe"},{bg:"#d1fae5",border:"#a7f3d0"},{bg:"#ede9fe",border:"#ddd6fe"},{bg:"#fee2e2",border:"#fecaca"},{bg:"#cffafe",border:"#a5f3fc"},{bg:"#fef9c3",border:"#fef08a"}],h=new Map;function S(E){if(!E)return null;if(h.has(E))return h.get(E);let D=0;for(let C=0;C<E.length;C++)D=(D<<5)-D+E.charCodeAt(C)|0;const T=Math.abs(D)%f.length,O=f[T];return h.set(E,O),O}function m(E){const D=E.from_minion_id;if(D===v1)return{background:"#f1f5f9",borderColor:"#e2e8f0",opacity:.8};if(E.from_user||D===h1)return{background:"#eef2ff",borderColor:"#e0e7ff"};if(D===g.value)return{background:"#f8fafc",borderColor:"#e2e8f0"};const T=S(D);return T?{background:T.bg,borderColor:T.border}:{background:"#f8fafc",borderColor:"#e2e8f0"}}function p(E){return{task:"ðŸ“‹",question:"â“",report:"ðŸ“Š",info:"ðŸ’¡",system:"âš™ï¸",halt:"ðŸ›‘",pivot:"ðŸ›‘",spawn:"ðŸŒŸ",dispose:"ðŸ—‘ï¸",thought:"ðŸ’­"}[E]||"ðŸ’¬"}function w(E){return E?E.charAt(0).toUpperCase()+E.slice(1):""}function b(E){const D=E.from_minion_name||(E.from_user?"User":"System"),T=E.to_minion_name||(E.to_user?"User":"Unknown");return`${D} â†’ ${T}`}function v(E){return E.content&&E.content!==E.summary}function _(E,D){return E?E.length<=D?E:E.substring(0,D)+"...":""}function o(E){c.value.has(E)?c.value.delete(E):c.value.add(E),c.value=new Set(c.value)}function y(E){if(!E)return"";let D=Ye.parse(E);return D=D.replace(/\n</g,"<"),D=D.replace(/\n+$/,""),qt.sanitize(D)}fe(()=>u.value.length,async()=>{await Fe(),l.value&&(l.value.scrollTop=l.value.scrollHeight)});function $(E){if(!E)return;s.setCurrentLegion(E),s.commsByLegion.get(E)||s.loadTimeline(E),(!a.legionConnected||a.currentLegionId!==E)&&a.connectLegion(E)}return fe(d,E=>{E&&$(E)},{immediate:!0}),fe(()=>a.legionConnected,E=>{E&&d.value&&s.loadTimeline(d.value)}),(E,D)=>(i(),r("div",a1,[u.value.length===0?(i(),r("div",i1,[...D[0]||(D[0]=[t("span",null,"Communication between this session's minions will appear here",-1)])])):(i(),r("div",{key:1,class:"comms-list",ref_key:"commsList",ref:l},[(i(!0),r(ee,null,le(u.value,T=>(i(),r("div",{key:T.comm_id,class:H(["comm-item",{expandable:v(T)}]),style:Pe(m(T)),onClick:O=>v(T)&&o(T.comm_id)},[t("div",r1,[t("span",c1,x(p(T.comm_type)),1),t("span",u1,x(w(T.comm_type)),1),t("span",d1,x(b(T)),1),t("span",f1,x(W(rs)(T.timestamp)),1),v(T)?(i(),r("svg",{key:0,class:H(["expand-chevron",{expanded:c.value.has(T.comm_id)}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[...D[1]||(D[1]=[t("path",{d:"M4.5 2.5L8 6L4.5 9.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)):M("",!0)]),t("div",m1,x(T.summary||_(T.content,120)),1),c.value.has(T.comm_id)?(i(),r("div",{key:0,class:"comm-content",innerHTML:y(T.content)},null,8,p1)):M("",!0)],14,l1))),128))],512))]))}},g1=te(_1,[["__scopeId","data-v-fa8a184a"]]);var qs={exports:{}},Qn;function b1(){return Qn||(Qn=1,(function(n,e){(function(a,l){n.exports=l()})(globalThis,()=>(()=>{var s={949(d,g,u){Object.defineProperty(g,"__esModule",{value:!0}),g.CronParser=void 0;var f=u(515),h=(function(){function S(m,p,w){p===void 0&&(p=!0),w===void 0&&(w=!1),this.expression=m,this.dayOfWeekStartIndexZero=p,this.monthStartIndexZero=w}return S.prototype.parse=function(){var m,p,w=(m=this.expression)!==null&&m!==void 0?m:"";if(w==="@reboot")return p=["@reboot","","","","","",""],p;if(w.startsWith("@")){var b=this.parseSpecial(this.expression);p=this.extractParts(b)}else p=this.extractParts(this.expression);return this.normalize(p),this.validate(p),p},S.prototype.parseSpecial=function(m){var p={"@yearly":"0 0 1 1 *","@annually":"0 0 1 1 *","@monthly":"0 0 1 * *","@weekly":"0 0 * * 0","@daily":"0 0 * * *","@midnight":"0 0 * * *","@hourly":"0 * * * *","@reboot":"@reboot"},w=p[m];if(!w)throw new Error("Unknown special expression.");return w},S.prototype.extractParts=function(m){if(!this.expression)throw new Error("cron expression is empty");for(var p=m.trim().split(/[ ]+/),w=0;w<p.length;w++)if(p[w].includes(",")){var b=p[w].split(",").map(function(_){return _.trim()}).filter(function(_){return _!==""}).map(function(_){return isNaN(Number(_))?_:Number(_)}).filter(function(_){return _!==null&&_!==""});b.length===0&&b.push("*"),b.sort(function(_,o){return _!==null&&o!==null?_-o:0}),p[w]=b.map(function(_){return _!==null?_.toString():""}).join(",")}if(p.length<5)throw new Error("Expression has only ".concat(p.length," part").concat(p.length==1?"":"s",". At least 5 parts are required."));if(p.length==5)p.unshift(""),p.push("");else if(p.length==6){var v=/\d{4}$/.test(p[5])||p[4]=="?"||p[2]=="?";v?p.unshift(""):p.push("")}else if(p.length>7)throw new Error("Expression has ".concat(p.length," parts; too many!"));return p},S.prototype.normalize=function(m){var p=this;if(m[3]=m[3].replace("?","*"),m[5]=m[5].replace("?","*"),m[2]=m[2].replace("?","*"),m[0].indexOf("0/")==0&&(m[0]=m[0].replace("0/","*/")),m[1].indexOf("0/")==0&&(m[1]=m[1].replace("0/","*/")),m[2].indexOf("0/")==0&&(m[2]=m[2].replace("0/","*/")),m[3].indexOf("1/")==0&&(m[3]=m[3].replace("1/","*/")),m[4].indexOf("1/")==0&&(m[4]=m[4].replace("1/","*/")),m[6].indexOf("1/")==0&&(m[6]=m[6].replace("1/","*/")),m[5]=m[5].replace(/(^\d)|([^#/\s]\d)/g,function(E){var D=E.replace(/\D/,""),T=D;return p.dayOfWeekStartIndexZero?D=="7"&&(T="0"):T=(parseInt(D)-1).toString(),E.replace(D,T)}),m[5]=="L"&&(m[5]="6"),m[3]=="?"&&(m[3]="*"),m[3].indexOf("W")>-1&&(m[3].indexOf(",")>-1||m[3].indexOf("-")>-1))throw new Error("The 'W' character can be specified only when the day-of-month is a single day, not a range or list of days.");var w={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6};for(var b in w)m[5]=m[5].replace(new RegExp(b,"gi"),w[b].toString());m[4]=m[4].replace(/(^\d{1,2})|([^#/\s]\d{1,2})/g,function(E){var D=E.replace(/\D/,""),T=D;return p.monthStartIndexZero&&(T=(parseInt(D)+1).toString()),E.replace(D,T)});var v={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};for(var _ in v)m[4]=m[4].replace(new RegExp(_,"gi"),v[_].toString());m[0]=="0"&&(m[0]=""),!/\*|\-|\,|\//.test(m[2])&&(/\*|\//.test(m[1])||/\*|\//.test(m[0]))&&(m[2]+="-".concat(m[2]));for(var o=0;o<m.length;o++)if(m[o].indexOf(",")!=-1&&(m[o]=m[o].split(",").filter(function(E){return E!==""}).join(",")||"*"),m[o]=="*/1"&&(m[o]="*"),m[o].indexOf("/")>-1&&!/^\*|\-|\,/.test(m[o])){var y=null;switch(o){case 4:y="12";break;case 5:y="6";break;case 6:y="9999";break;default:y=null;break}if(y!==null){var $=m[o].split("/");m[o]="".concat($[0],"-").concat(y,"/").concat($[1])}}},S.prototype.validate=function(m){var p="0-9,\\-*/";this.validateOnlyExpectedCharactersFound(m[0],p),this.validateOnlyExpectedCharactersFound(m[1],p),this.validateOnlyExpectedCharactersFound(m[2],p),this.validateOnlyExpectedCharactersFound(m[3],"0-9,\\-*/LW"),this.validateOnlyExpectedCharactersFound(m[4],p),this.validateOnlyExpectedCharactersFound(m[5],"0-9,\\-*/L#"),this.validateOnlyExpectedCharactersFound(m[6],p),this.validateAnyRanges(m)},S.prototype.validateAnyRanges=function(m){f.default.secondRange(m[0]),f.default.minuteRange(m[1]),f.default.hourRange(m[2]),f.default.dayOfMonthRange(m[3]),f.default.monthRange(m[4],this.monthStartIndexZero),f.default.dayOfWeekRange(m[5],this.dayOfWeekStartIndexZero)},S.prototype.validateOnlyExpectedCharactersFound=function(m,p){var w=m.match(new RegExp("[^".concat(p,"]+"),"gi"));if(w&&w.length)throw new Error("Expression contains invalid values: '".concat(w.toString(),"'"))},S})();g.CronParser=h},333(d,g,u){Object.defineProperty(g,"__esModule",{value:!0}),g.ExpressionDescriptor=void 0;var f=u(823),h=u(949),S=(function(){function m(p,w){if(this.expression=p,this.options=w,this.expressionParts=new Array(5),!this.options.locale&&m.defaultLocale&&(this.options.locale=m.defaultLocale),!m.locales[this.options.locale]){var b=Object.keys(m.locales)[0];console.warn("Locale '".concat(this.options.locale,"' could not be found; falling back to '").concat(b,"'.")),this.options.locale=b}this.i18n=m.locales[this.options.locale],w.use24HourTimeFormat===void 0&&(w.use24HourTimeFormat=this.i18n.use24HourTimeFormatByDefault())}return m.toString=function(p,w){var b=w===void 0?{}:w,v=b.throwExceptionOnParseError,_=v===void 0?!0:v,o=b.verbose,y=o===void 0?!1:o,$=b.dayOfWeekStartIndexZero,E=$===void 0?!0:$,D=b.monthStartIndexZero,T=D===void 0?!1:D,O=b.use24HourTimeFormat,C=b.locale,A=C===void 0?null:C,N=b.logicalAndDayFields,P=N===void 0?!1:N,F={throwExceptionOnParseError:_,verbose:y,dayOfWeekStartIndexZero:E,monthStartIndexZero:T,use24HourTimeFormat:O,locale:A,logicalAndDayFields:P};F.tzOffset&&console.warn("'tzOffset' option has been deprecated and is no longer supported.");var V=new m(p,F);return V.getFullDescription()},m.initialize=function(p,w){w===void 0&&(w="en"),m.specialCharacters=["/","-",",","*"],m.defaultLocale=w,p.load(m.locales)},m.prototype.getFullDescription=function(){var p,w,b="";try{var v=new h.CronParser(this.expression,this.options.dayOfWeekStartIndexZero,this.options.monthStartIndexZero);if(this.expressionParts=v.parse(),this.expressionParts[0]==="@reboot")return((w=(p=this.i18n).atReboot)===null||w===void 0?void 0:w.call(p))||"Run once, at startup";var _=this.getTimeOfDayDescription(),o=this.getDayOfMonthDescription(),y=this.getMonthDescription(),$=this.getDayOfWeekDescription(),E=this.getYearDescription();b+=_+o+$+y+E,b=this.transformVerbosity(b,!!this.options.verbose),b=b.charAt(0).toLocaleUpperCase()+b.substr(1)}catch(D){if(!this.options.throwExceptionOnParseError)b=this.i18n.anErrorOccuredWhenGeneratingTheExpressionD();else throw"".concat(D)}return b},m.prototype.getTimeOfDayDescription=function(){var p=this.expressionParts[0],w=this.expressionParts[1],b=this.expressionParts[2],v="";if(!f.StringUtilities.containsAny(w,m.specialCharacters)&&!f.StringUtilities.containsAny(b,m.specialCharacters)&&!f.StringUtilities.containsAny(p,m.specialCharacters))v+=this.i18n.atSpace()+this.formatTime(b,w,p);else if(!p&&w.indexOf("-")>-1&&!(w.indexOf(",")>-1)&&!(w.indexOf("/")>-1)&&!f.StringUtilities.containsAny(b,m.specialCharacters)){var _=w.split("-");v+=f.StringUtilities.format(this.i18n.everyMinuteBetweenX0AndX1(),this.formatTime(b,_[0],""),this.formatTime(b,_[1],""))}else if(!p&&b.indexOf(",")>-1&&b.indexOf("-")==-1&&b.indexOf("/")==-1&&!f.StringUtilities.containsAny(w,m.specialCharacters)){var o=b.split(",");v+=this.i18n.at();for(var y=0;y<o.length;y++)v+=" ",v+=this.formatTime(o[y],w,""),y<o.length-2&&(v+=","),y==o.length-2&&(v+=this.i18n.spaceAnd())}else{var $=this.getSecondsDescription(),E=this.getMinutesDescription(),D=this.getHoursDescription();if(v+=$,v&&E&&(v+=", "),v+=E,E===D)return v;v&&D&&(v+=", "),v+=D}return v},m.prototype.getSecondsDescription=function(){var p=this,w=this.getSegmentDescription(this.expressionParts[0],this.i18n.everySecond(),function(b){return b},function(b){return f.StringUtilities.format(p.i18n.everyX0Seconds(b),b)},function(b){return p.i18n.secondsX0ThroughX1PastTheMinute()},function(b){return b=="0"?"":parseInt(b)<20?p.i18n.atX0SecondsPastTheMinute(b):p.i18n.atX0SecondsPastTheMinuteGt20()||p.i18n.atX0SecondsPastTheMinute(b)});return w},m.prototype.getMinutesDescription=function(){var p=this,w=this.expressionParts[0],b=this.expressionParts[2],v=this.getSegmentDescription(this.expressionParts[1],this.i18n.everyMinute(),function(_){return _},function(_){return f.StringUtilities.format(p.i18n.everyX0Minutes(_),_)},function(_){return p.i18n.minutesX0ThroughX1PastTheHour()},function(_){var o,y;try{return _=="0"&&b.indexOf("/")==-1&&w==""?p.i18n.everyHour():_=="0"?((y=(o=p.i18n).onTheHour)===null||y===void 0?void 0:y.call(o))||p.i18n.atX0MinutesPastTheHour(_):parseInt(_)<20?p.i18n.atX0MinutesPastTheHour(_):p.i18n.atX0MinutesPastTheHourGt20()||p.i18n.atX0MinutesPastTheHour(_)}catch{return p.i18n.atX0MinutesPastTheHour(_)}});return v},m.prototype.getHoursDescription=function(){var p=this,w=this.expressionParts[2],b=0,v=[];w.split("/")[0].split(",").forEach(function(y){var $=y.split("-");$.length===2&&v.push({value:$[1],index:b+1}),b+=$.length});var _=0,o=this.getSegmentDescription(w,this.i18n.everyHour(),function(y){var $=v.find(function(D){return D.value===y&&D.index===_}),E=$&&p.expressionParts[1]!=="0";return _++,E?p.formatTime(y,"59",""):p.formatTime(y,"0","")},function(y){return f.StringUtilities.format(p.i18n.everyX0Hours(y),y)},function(y){return p.i18n.betweenX0AndX1()},function(y){return p.i18n.atX0()});return o},m.prototype.getDayOfWeekDescription=function(){var p=this,w=this.i18n.daysOfTheWeek(),b=null;return this.expressionParts[5]=="*"?b="":b=this.getSegmentDescription(this.expressionParts[5],this.i18n.commaEveryDay(),function(v,_){var o=v;v.indexOf("#")>-1?o=v.substring(0,v.indexOf("#")):v.indexOf("L")>-1&&(o=o.replace("L",""));var y=parseInt(o),$=p.i18n.daysOfTheWeekInCase?p.i18n.daysOfTheWeekInCase(_)[y]:w[y];if(v.indexOf("#")>-1){var E=null,D=v.substring(v.indexOf("#")+1),T=v.substring(0,v.indexOf("#"));switch(D){case"1":E=p.i18n.first(T);break;case"2":E=p.i18n.second(T);break;case"3":E=p.i18n.third(T);break;case"4":E=p.i18n.fourth(T);break;case"5":E=p.i18n.fifth(T);break}$=E+" "+$}return $},function(v){return parseInt(v)==1?"":f.StringUtilities.format(p.i18n.commaEveryX0DaysOfTheWeek(v),v)},function(v){var _=v.substring(0,v.indexOf("-")),o=p.expressionParts[3]!="*";return o?p.i18n.commaAndX0ThroughX1(_):p.i18n.commaX0ThroughX1(_)},function(v){var _=null;if(v.indexOf("#")>-1){var o=v.substring(v.indexOf("#")+1),y=v.substring(0,v.indexOf("#"));_=p.i18n.commaOnThe(o,y).trim()+p.i18n.spaceX0OfTheMonth()}else if(v.indexOf("L")>-1)_=p.i18n.commaOnTheLastX0OfTheMonth(v.replace("L",""));else{var $=p.expressionParts[3]!="*";$?p.options.logicalAndDayFields?_=p.i18n.commaOnlyOnX0(v):_=p.i18n.commaAndOnX0():_=p.i18n.commaOnlyOnX0(v)}return _}),b},m.prototype.getMonthDescription=function(){var p=this,w=this.i18n.monthsOfTheYear(),b=this.getSegmentDescription(this.expressionParts[4],"",function(v,_){return _&&p.i18n.monthsOfTheYearInCase?p.i18n.monthsOfTheYearInCase(_)[parseInt(v)-1]:w[parseInt(v)-1]},function(v){return parseInt(v)==1?"":f.StringUtilities.format(p.i18n.commaEveryX0Months(v),v)},function(v){return p.i18n.commaMonthX0ThroughMonthX1()||p.i18n.commaX0ThroughX1()},function(v){return p.i18n.commaOnlyInMonthX0?p.i18n.commaOnlyInMonthX0():p.i18n.commaOnlyInX0()});return b},m.prototype.getDayOfMonthDescription=function(){var p=this,w=null,b=this.expressionParts[3];switch(b){case"L":w=this.i18n.commaOnTheLastDayOfTheMonth();break;case"WL":case"LW":w=this.i18n.commaOnTheLastWeekdayOfTheMonth();break;default:var v=b.match(/(\d{1,2}W)|(W\d{1,2})/);if(v){var _=parseInt(v[0].replace("W","")),o=_==1?this.i18n.firstWeekday():f.StringUtilities.format(this.i18n.weekdayNearestDayX0(),_.toString());w=f.StringUtilities.format(this.i18n.commaOnTheX0OfTheMonth(),o);break}else{var y=b.match(/L-(\d{1,2})/);if(y){var $=y[1];w=f.StringUtilities.format(this.i18n.commaDaysBeforeTheLastDayOfTheMonth($),$);break}else{if(b=="*"&&this.expressionParts[5]!="*")return"";w=this.getSegmentDescription(b,this.i18n.commaEveryDay(),function(E){return E=="L"?p.i18n.lastDay():p.i18n.dayX0?f.StringUtilities.format(p.i18n.dayX0(),E):E},function(E){return E=="1"?p.i18n.commaEveryDay():p.i18n.commaEveryX0Days(E)},function(E){return p.i18n.commaBetweenDayX0AndX1OfTheMonth(E)},function(E){return p.i18n.commaOnDayX0OfTheMonth(E)})}break}}return w},m.prototype.getYearDescription=function(){var p=this,w=this.getSegmentDescription(this.expressionParts[6],"",function(b){return/^\d+$/.test(b)?new Date(parseInt(b),1).getFullYear().toString():b},function(b){return f.StringUtilities.format(p.i18n.commaEveryX0Years(b),b)},function(b){return p.i18n.commaYearX0ThroughYearX1()||p.i18n.commaX0ThroughX1()},function(b){return p.i18n.commaOnlyInYearX0?p.i18n.commaOnlyInYearX0():p.i18n.commaOnlyInX0()});return w},m.prototype.getSegmentDescription=function(p,w,b,v,_,o){var y=null,$=p.indexOf("/")>-1,E=p.indexOf("-")>-1,D=p.indexOf(",")>-1;if(!p)y="";else if(p==="*")y=w;else if(!$&&!E&&!D)y=f.StringUtilities.format(o(p),b(p));else if(D){for(var T=p.split(","),O="",C=0;C<T.length;C++)if(C>0&&T.length>2&&(O+=",",C<T.length-1&&(O+=" ")),C>0&&T.length>1&&(C==T.length-1||T.length==2)&&(O+="".concat(this.i18n.spaceAnd()," ")),T[C].indexOf("/")>-1||T[C].indexOf("-")>-1){var A=T[C].indexOf("-")>-1&&T[C].indexOf("/")==-1,N=this.getSegmentDescription(T[C],w,b,v,A?this.i18n.commaX0ThroughX1:_,o);A&&(N=N.replace(", ","")),O+=N}else if(!$)O+=b(T[C]);else{var P=this.getSegmentDescription(T[C],w,b,v,_,o);P&&P.startsWith(", ")&&(P=P.substring(2)),O+=P}$?y=O:y=f.StringUtilities.format(o(p),O)}else if($){var T=p.split("/");if(y=f.StringUtilities.format(v(T[1]),T[1]),T[0].indexOf("-")>-1){var F=this.generateRangeSegmentDescription(T[0],_,b);F.indexOf(", ")!=0&&(y+=", "),y+=F}else if(T[0].indexOf("*")==-1){var V=f.StringUtilities.format(o(T[0]),b(T[0]));V=V.replace(", ",""),y+=f.StringUtilities.format(this.i18n.commaStartingX0(),V)}}else E&&(y=this.generateRangeSegmentDescription(p,_,b));return y},m.prototype.generateRangeSegmentDescription=function(p,w,b){var v="",_=p.split("-"),o=b(_[0],1),y=b(_[1],2),$=w(p);return v+=f.StringUtilities.format($,o,y),v},m.prototype.formatTime=function(p,w,b){var v=0,_=0,o=parseInt(p)+v,y=parseInt(w)+_;y>=60?(y-=60,o+=1):y<0&&(y+=60,o-=1),o>=24?o=o-24:o<0&&(o=24+o);var $="",E=!1;this.options.use24HourTimeFormat||(E=!!(this.i18n.setPeriodBeforeTime&&this.i18n.setPeriodBeforeTime()),$=E?"".concat(this.getPeriod(o)," "):" ".concat(this.getPeriod(o)),o>12&&(o-=12),o===0&&(o=12));var D="";return b&&(D=":".concat(("00"+b).substring(b.length))),"".concat(E?$:"").concat(("00"+o.toString()).substring(o.toString().length),":").concat(("00"+y.toString()).substring(y.toString().length)).concat(D).concat(E?"":$)},m.prototype.transformVerbosity=function(p,w){if(!w&&(p=p.replace(new RegExp(", ".concat(this.i18n.everyMinute()),"g"),""),p=p.replace(new RegExp(", ".concat(this.i18n.everyHour()),"g"),""),p=p.replace(new RegExp(this.i18n.commaEveryDay(),"g"),""),p=p.replace(/\, ?$/,""),this.i18n.conciseVerbosityReplacements))for(var b=0,v=Object.entries(this.i18n.conciseVerbosityReplacements());b<v.length;b++){var _=v[b],o=_[0],y=_[1];p=p.replace(new RegExp(o,"g"),y)}return p},m.prototype.getPeriod=function(p){return p>=12?this.i18n.pm&&this.i18n.pm()||"PM":this.i18n.am&&this.i18n.am()||"AM"},m.locales={},m})();g.ExpressionDescriptor=S},747(d,g,u){Object.defineProperty(g,"__esModule",{value:!0}),g.enLocaleLoader=void 0;var f=u(486),h=(function(){function S(){}return S.prototype.load=function(m){m.en=new f.en},S})();g.enLocaleLoader=h},486(d,g){Object.defineProperty(g,"__esModule",{value:!0}),g.en=void 0;var u=(function(){function f(){}return f.prototype.atX0SecondsPastTheMinuteGt20=function(){return null},f.prototype.atX0MinutesPastTheHourGt20=function(){return null},f.prototype.commaMonthX0ThroughMonthX1=function(){return null},f.prototype.commaYearX0ThroughYearX1=function(){return null},f.prototype.use24HourTimeFormatByDefault=function(){return!1},f.prototype.anErrorOccuredWhenGeneratingTheExpressionD=function(){return"An error occurred when generating the expression description. Check the cron expression syntax."},f.prototype.everyMinute=function(){return"every minute"},f.prototype.everyHour=function(){return"every hour"},f.prototype.atSpace=function(){return"At "},f.prototype.everyMinuteBetweenX0AndX1=function(){return"Every minute between %s and %s"},f.prototype.at=function(){return"At"},f.prototype.spaceAnd=function(){return" and"},f.prototype.everySecond=function(){return"every second"},f.prototype.everyX0Seconds=function(){return"every %s seconds"},f.prototype.secondsX0ThroughX1PastTheMinute=function(){return"seconds %s through %s past the minute"},f.prototype.atX0SecondsPastTheMinute=function(){return"at %s seconds past the minute"},f.prototype.everyX0Minutes=function(){return"every %s minutes"},f.prototype.minutesX0ThroughX1PastTheHour=function(){return"minutes %s through %s past the hour"},f.prototype.atX0MinutesPastTheHour=function(){return"at %s minutes past the hour"},f.prototype.everyX0Hours=function(){return"every %s hours"},f.prototype.betweenX0AndX1=function(){return"between %s and %s"},f.prototype.atX0=function(){return"at %s"},f.prototype.commaEveryDay=function(){return", every day"},f.prototype.commaEveryX0DaysOfTheWeek=function(){return", every %s days of the week"},f.prototype.commaX0ThroughX1=function(){return", %s through %s"},f.prototype.commaAndX0ThroughX1=function(){return", %s through %s"},f.prototype.first=function(){return"first"},f.prototype.second=function(){return"second"},f.prototype.third=function(){return"third"},f.prototype.fourth=function(){return"fourth"},f.prototype.fifth=function(){return"fifth"},f.prototype.commaOnThe=function(){return", on the "},f.prototype.spaceX0OfTheMonth=function(){return" %s of the month"},f.prototype.lastDay=function(){return"the last day"},f.prototype.commaOnTheLastX0OfTheMonth=function(){return", on the last %s of the month"},f.prototype.commaOnlyOnX0=function(){return", only on %s"},f.prototype.commaAndOnX0=function(){return", and on %s"},f.prototype.commaEveryX0Months=function(){return", every %s months"},f.prototype.commaOnlyInX0=function(){return", only in %s"},f.prototype.commaOnTheLastDayOfTheMonth=function(){return", on the last day of the month"},f.prototype.commaOnTheLastWeekdayOfTheMonth=function(){return", on the last weekday of the month"},f.prototype.commaDaysBeforeTheLastDayOfTheMonth=function(){return", %s days before the last day of the month"},f.prototype.firstWeekday=function(){return"first weekday"},f.prototype.weekdayNearestDayX0=function(){return"weekday nearest day %s"},f.prototype.commaOnTheX0OfTheMonth=function(){return", on the %s of the month"},f.prototype.commaEveryX0Days=function(){return", every %s days in a month"},f.prototype.commaBetweenDayX0AndX1OfTheMonth=function(){return", between day %s and %s of the month"},f.prototype.commaOnDayX0OfTheMonth=function(){return", on day %s of the month"},f.prototype.commaEveryHour=function(){return", every hour"},f.prototype.commaEveryX0Years=function(){return", every %s years"},f.prototype.commaStartingX0=function(){return", starting %s"},f.prototype.daysOfTheWeek=function(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},f.prototype.monthsOfTheYear=function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]},f.prototype.atReboot=function(){return"Run once, at startup"},f.prototype.onTheHour=function(){return"on the hour"},f})();g.en=u},515(d,g){Object.defineProperty(g,"__esModule",{value:!0});function u(h,S){if(!h)throw new Error(S)}var f=(function(){function h(){}return h.secondRange=function(S){for(var m=S.split(","),p=0;p<m.length;p++)if(!isNaN(parseInt(m[p],10))){var w=parseInt(m[p],10);u(w>=0&&w<=59,"seconds part must be >= 0 and <= 59")}},h.minuteRange=function(S){for(var m=S.split(","),p=0;p<m.length;p++)if(!isNaN(parseInt(m[p],10))){var w=parseInt(m[p],10);u(w>=0&&w<=59,"minutes part must be >= 0 and <= 59")}},h.hourRange=function(S){for(var m=S.split(","),p=0;p<m.length;p++)if(!isNaN(parseInt(m[p],10))){var w=parseInt(m[p],10);u(w>=0&&w<=23,"hours part must be >= 0 and <= 23")}},h.dayOfMonthRange=function(S){for(var m=S.split(","),p=0;p<m.length;p++)if(!isNaN(parseInt(m[p],10))){var w=parseInt(m[p],10);u(w>=1&&w<=31,"DOM part must be >= 1 and <= 31")}},h.monthRange=function(S,m){for(var p=S.split(","),w=0;w<p.length;w++)if(!isNaN(parseInt(p[w],10))){var b=parseInt(p[w],10);u(b>=1&&b<=12,m?"month part must be >= 0 and <= 11":"month part must be >= 1 and <= 12")}},h.dayOfWeekRange=function(S,m){for(var p=S.split(","),w=0;w<p.length;w++)if(!isNaN(parseInt(p[w],10))){var b=parseInt(p[w],10);u(b>=0&&b<=6,m?"DOW part must be >= 0 and <= 6":"DOW part must be >= 1 and <= 7")}},h})();g.default=f},823(d,g){Object.defineProperty(g,"__esModule",{value:!0}),g.StringUtilities=void 0;var u=(function(){function f(){}return f.format=function(h){for(var S=[],m=1;m<arguments.length;m++)S[m-1]=arguments[m];return h.replace(/%s/g,function(p){return S.shift()})},f.containsAny=function(h,S){return S.some(function(m){return h.indexOf(m)>-1})},f})();g.StringUtilities=u}},a={};function l(d){var g=a[d];if(g!==void 0)return g.exports;var u=a[d]={exports:{}};return s[d](u,u.exports,l),u.exports}var c={};return(()=>{var d=c;Object.defineProperty(d,"__esModule",{value:!0}),d.toString=void 0;var g=l(333),u=l(747);g.ExpressionDescriptor.initialize(new u.enLocaleLoader),d.default=g.ExpressionDescriptor;var f=g.ExpressionDescriptor.toString;d.toString=f})(),c})())})(qs)),qs.exports}var y1=b1();const ts=si(y1),w1={class:"schedule-header"},k1=["title"],$1=["onKeydown"],S1={class:"schedule-meta"},x1=["title"],C1={class:"cron-edit-row"},E1=["onKeydown"],T1=["disabled"],A1={class:"schedule-timing"},D1={key:0,class:"next-run"},M1={key:1,class:"last-run"},O1={class:"schedule-stats"},L1={key:0,class:"failures"},I1={key:1,class:"reset-badge",title:"Session resets before each execution"},N1={class:"prompt-section"},P1={class:"prompt-arrow"},j1={key:0,class:"prompt-body"},R1={class:"prompt-text"},B1=["onKeydown"],F1={class:"prompt-edit-controls"},V1=["disabled"],U1={class:"schedule-controls"},W1={key:0,class:"schedule-history"},H1={key:0,class:"history-empty"},q1={class:"history-time"},z1={class:"history-status"},K1={key:0,class:"history-error"},G1={__name:"ScheduleItem",props:{schedule:{type:Object,required:!0},legionId:{type:String,required:!0}},setup(n){const e=n,s=Kt(),a=L(!1),l=L([]),c=L(!1),d=L(!1),g=L(""),u=L(!1),f=L(null),h=L(!1),S=L(""),m=L(null),p=L(!1),w=L(""),b=L(null),v=k(()=>{try{return ts.toString(e.schedule.cron_expression)}catch{return e.schedule.cron_expression}}),_=k(()=>{if(!w.value.trim())return"Enter a cron expression";try{return ts.toString(w.value.trim())}catch{return"Invalid cron expression"}}),o=k(()=>{if(!w.value.trim())return!1;try{return ts.toString(w.value.trim()),!0}catch{return!1}});function y(q){if(!q)return"";const Z=Date.now()/1e3,K=q-Z;if(Math.abs(K)<60)return"just now";const pe=Math.abs(K),re=K>0?"in ":"",ge=K<0?" ago":"";if(pe<3600){const z=Math.round(pe/60);return`${re}${z}m${ge}`}if(pe<86400){const z=Math.round(pe/3600);return`${re}${z}h${ge}`}const be=Math.round(pe/86400);return`${re}${be}d${ge}`}function $(q){return q?new Date(q*1e3).toLocaleString():""}async function E(){try{await s.pauseSchedule(e.legionId,e.schedule.schedule_id)}catch(q){console.error("Failed to pause schedule:",q)}}async function D(){try{await s.resumeSchedule(e.legionId,e.schedule.schedule_id)}catch(q){console.error("Failed to resume schedule:",q)}}async function T(){if(confirm(`Cancel schedule "${e.schedule.name}" permanently?`))try{await s.cancelSchedule(e.legionId,e.schedule.schedule_id)}catch(q){console.error("Failed to cancel schedule:",q)}}async function O(){if(confirm(`Delete schedule "${e.schedule.name}"?`))try{await s.deleteSchedule(e.legionId,e.schedule.schedule_id)}catch(q){console.error("Failed to delete schedule:",q)}}function C(){S.value=e.schedule.name,h.value=!0,Fe(()=>{m.value&&(m.value.focus(),m.value.select())})}function A(){h.value=!1,S.value=""}async function N(){const q=S.value.trim();if(!q||q===e.schedule.name){A();return}try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{name:q})}catch(Z){console.error("Failed to update name:",Z)}h.value=!1,S.value=""}function P(){w.value=e.schedule.cron_expression,p.value=!0,Fe(()=>{b.value&&(b.value.focus(),b.value.select())})}function F(){p.value=!1,w.value=""}async function V(){const q=w.value.trim();if(!q||q===e.schedule.cron_expression||!o.value){F();return}try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{cron_expression:q})}catch(Z){console.error("Failed to update cron expression:",Z)}p.value=!1,w.value=""}function X(){g.value=e.schedule.prompt,d.value=!0,Fe(()=>{f.value&&f.value.focus()})}function j(){d.value=!1,g.value=""}async function I(){const q=g.value.trim();if(!q||q===e.schedule.prompt){j();return}u.value=!0;try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{prompt:q}),d.value=!1,g.value=""}catch(Z){console.error("Failed to update prompt:",Z)}finally{u.value=!1}}async function G(){a.value=!a.value,a.value&&l.value.length===0&&(l.value=await s.loadHistory(e.legionId,e.schedule.schedule_id))}return(q,Z)=>(i(),r("div",{class:H(["schedule-item",n.schedule.status])},[t("div",w1,[h.value?$e((i(),r("input",{key:1,ref_key:"nameInput",ref:m,"onUpdate:modelValue":Z[1]||(Z[1]=K=>S.value=K),class:"inline-edit-input name-input",onKeydown:[ct(ae(N,["stop"]),["enter"]),ct(ae(A,["stop"]),["escape"])],onBlur:N},null,40,$1)),[[De,S.value]]):(i(),r("span",{key:0,class:H(["schedule-name",{editable:n.schedule.status!=="cancelled"}]),title:n.schedule.status!=="cancelled"?"Click to edit name":"",onClick:Z[0]||(Z[0]=ae(K=>n.schedule.status!=="cancelled"&&C(),["stop"]))},x(n.schedule.name),11,k1)),t("span",{class:H(["status-badge",n.schedule.status])},x(n.schedule.status),3)]),t("div",S1,[p.value?(i(),r(ee,{key:1},[t("div",C1,[$e(t("input",{ref_key:"cronInput",ref:b,"onUpdate:modelValue":Z[3]||(Z[3]=K=>w.value=K),class:"inline-edit-input cron-input",placeholder:"e.g. */5 * * * *",onKeydown:[ct(ae(V,["stop"]),["enter"]),ct(ae(F,["stop"]),["escape"])]},null,40,E1),[[De,w.value]]),t("button",{class:"ctrl-btn save",onClick:ae(V,["stop"]),disabled:!o.value},"Save",8,T1),t("button",{class:"ctrl-btn",onClick:ae(F,["stop"])},"Cancel")]),t("div",{class:H(["cron-preview",{invalid:!o.value}])},x(_.value),3)],64)):(i(),r("span",{key:0,class:H(["cron-desc",{editable:n.schedule.status!=="cancelled"}]),title:n.schedule.status!=="cancelled"?`${n.schedule.cron_expression} â€” click to edit`:n.schedule.cron_expression,onClick:Z[2]||(Z[2]=ae(K=>n.schedule.status!=="cancelled"&&P(),["stop"]))},x(v.value),11,x1))]),t("div",A1,[n.schedule.next_run?(i(),r("span",D1," Next: "+x(y(n.schedule.next_run)),1)):M("",!0),n.schedule.last_run?(i(),r("span",M1,[ue(" Last: "+x(y(n.schedule.last_run))+" ",1),n.schedule.last_status?(i(),r("span",{key:0,class:H(["last-status",n.schedule.last_status])}," ("+x(n.schedule.last_status)+") ",3)):M("",!0)])):M("",!0)]),t("div",O1,[t("span",null,x(n.schedule.execution_count)+" runs",1),n.schedule.failure_count>0?(i(),r("span",L1,x(n.schedule.failure_count)+" consecutive failures ",1)):M("",!0),n.schedule.reset_session?(i(),r("span",I1,"reset")):M("",!0)]),t("div",N1,[t("div",{class:"prompt-toggle",onClick:Z[4]||(Z[4]=ae(K=>c.value=!c.value,["stop"]))},[Z[6]||(Z[6]=t("span",{class:"prompt-label"},"Prompt",-1)),t("span",P1,x(c.value?"â–¾":"â–¸"),1)]),c.value?(i(),r("div",j1,[d.value?(i(),r(ee,{key:1},[$e(t("textarea",{ref_key:"promptInput",ref:f,"onUpdate:modelValue":Z[5]||(Z[5]=K=>g.value=K),class:"prompt-editor",rows:"5",onKeydown:ct(ae(j,["stop"]),["escape"])},null,40,B1),[[De,g.value]]),t("div",F1,[t("button",{class:"ctrl-btn save",onClick:ae(I,["stop"]),disabled:u.value},x(u.value?"Saving...":"Save"),9,V1),t("button",{class:"ctrl-btn",onClick:ae(j,["stop"])},"Cancel")])],64)):(i(),r(ee,{key:0},[t("pre",R1,x(n.schedule.prompt),1),n.schedule.status!=="cancelled"?(i(),r("button",{key:0,class:"ctrl-btn edit-prompt",onClick:ae(X,["stop"])},"Edit")):M("",!0)],64))])):M("",!0)]),t("div",U1,[n.schedule.status==="active"?(i(),r("button",{key:0,class:"ctrl-btn pause",onClick:ae(E,["stop"]),title:"Pause"},"Pause")):M("",!0),n.schedule.status==="paused"?(i(),r("button",{key:1,class:"ctrl-btn resume",onClick:ae(D,["stop"]),title:"Resume"},"Resume")):M("",!0),n.schedule.status!=="cancelled"?(i(),r("button",{key:2,class:"ctrl-btn cancel",onClick:ae(T,["stop"]),title:"Cancel permanently"},"Cancel")):M("",!0),t("button",{class:"ctrl-btn delete",onClick:ae(O,["stop"]),title:"Delete"},"Delete")]),a.value?(i(),r("div",W1,[Z[7]||(Z[7]=t("div",{class:"history-header"},"Execution History",-1)),l.value.length===0?(i(),r("div",H1,"No executions yet")):M("",!0),(i(!0),r(ee,null,le(l.value,K=>(i(),r("div",{key:K.execution_id,class:H(["history-item",K.status])},[t("span",q1,x($(K.actual_time)),1),t("span",z1,x(K.status),1),K.error_message?(i(),r("span",K1,x(K.error_message),1)):M("",!0)],2))),128))])):M("",!0),t("button",{class:"toggle-history",onClick:ae(G,["stop"])},x(a.value?"Hide history":"Show history"),1)],2))}},X1=te(G1,[["__scopeId","data-v-0ef66a16"]]),Y1={class:"modal-content"},Q1={class:"modal-header"},J1={class:"form-group"},Z1=["value"],ew={class:"form-group"},tw={class:"form-group"},sw={class:"cron-presets"},nw={class:"form-group"},ow={class:"form-group toggle-group"},aw={class:"toggle-label"},iw={key:0,class:"error-msg"},lw={class:"modal-actions"},rw=["disabled"],cw={__name:"ScheduleCreateModal",props:{legionId:{type:String,required:!0}},emits:["close","created"],setup(n,{emit:e}){const s=n,a=e,l=_e(),c=Kt(),d=L(!1),g=L(""),u=L({minion_id:"",name:"",cron_expression:"",prompt:"",reset_session:!1}),f=k(()=>l.sessionsInProject(s.legionId).value),h=k(()=>{if(!u.value.cron_expression)return"Enter a cron expression (min hour dom mon dow)";try{return ts.toString(u.value.cron_expression)}catch{return"Invalid cron expression"}}),S=k(()=>{if(!u.value.cron_expression)return!1;try{return ts.toString(u.value.cron_expression),!1}catch{return!0}});function m(w){u.value.cron_expression=w}async function p(){if(!(d.value||S.value)){g.value="",d.value=!0;try{const w=await c.createSchedule(s.legionId,{minion_id:u.value.minion_id,name:u.value.name,cron_expression:u.value.cron_expression,prompt:u.value.prompt,reset_session:u.value.reset_session});a("created",w)}catch(w){g.value=w.message||"Failed to create schedule"}finally{d.value=!1}}}return(w,b)=>(i(),r("div",{class:"modal-overlay",onClick:b[11]||(b[11]=ae(v=>w.$emit("close"),["self"]))},[t("div",Y1,[t("div",Q1,[b[12]||(b[12]=t("h3",null,"Create Schedule",-1)),t("button",{class:"close-btn",onClick:b[0]||(b[0]=v=>w.$emit("close"))},"Ã—")]),t("form",{onSubmit:ae(p,["prevent"])},[t("div",J1,[b[14]||(b[14]=t("label",null,"Agent",-1)),$e(t("select",{"onUpdate:modelValue":b[1]||(b[1]=v=>u.value.minion_id=v),required:""},[b[13]||(b[13]=t("option",{value:"",disabled:""},"Select an agent...",-1)),(i(!0),r(ee,null,le(f.value,v=>(i(),r("option",{key:v.session_id,value:v.session_id},x(v.name||v.session_id.substring(0,8)),9,Z1))),128))],512),[[Cs,u.value.minion_id]])]),t("div",ew,[b[15]||(b[15]=t("label",null,"Schedule Name",-1)),$e(t("input",{"onUpdate:modelValue":b[2]||(b[2]=v=>u.value.name=v),type:"text",placeholder:"Daily status report",required:""},null,512),[[De,u.value.name]])]),t("div",tw,[b[16]||(b[16]=t("label",null,"Cron Expression",-1)),$e(t("input",{"onUpdate:modelValue":b[3]||(b[3]=v=>u.value.cron_expression=v),type:"text",placeholder:"0 8 * * 1-5",required:""},null,512),[[De,u.value.cron_expression]]),t("div",{class:H(["cron-preview",{error:S.value}])},x(h.value),3),t("div",sw,[t("button",{type:"button",onClick:b[4]||(b[4]=v=>m("0 * * * *"))},"Every hour"),t("button",{type:"button",onClick:b[5]||(b[5]=v=>m("0 8 * * 1-5"))},"Weekdays 8am"),t("button",{type:"button",onClick:b[6]||(b[6]=v=>m("0 9 * * *"))},"Daily 9am"),t("button",{type:"button",onClick:b[7]||(b[7]=v=>m("0 0 * * 0"))},"Weekly Sun")])]),t("div",nw,[b[17]||(b[17]=t("label",null,"Prompt",-1)),$e(t("textarea",{"onUpdate:modelValue":b[8]||(b[8]=v=>u.value.prompt=v),rows:"4",placeholder:"What should the agent do when this schedule fires?",required:""},null,512),[[De,u.value.prompt]])]),t("div",ow,[t("label",aw,[$e(t("input",{type:"checkbox","onUpdate:modelValue":b[9]||(b[9]=v=>u.value.reset_session=v)},null,512),[[_n,u.value.reset_session]]),b[18]||(b[18]=t("span",null,"Reset session before each execution",-1))]),b[19]||(b[19]=t("div",{class:"toggle-hint"},"When enabled, the agent's session is reset for a clean context each time the schedule fires.",-1))]),g.value?(i(),r("div",iw,x(g.value),1)):M("",!0),t("div",lw,[t("button",{type:"button",class:"btn-secondary",onClick:b[10]||(b[10]=v=>w.$emit("close"))},"Cancel"),t("button",{type:"submit",class:"btn-primary",disabled:d.value||S.value},x(d.value?"Creating...":"Create Schedule"),9,rw)])],32)])]))}},uw=te(cw,[["__scopeId","data-v-de2a9e04"]]),dw={class:"schedule-panel"},fw={class:"schedule-toolbar"},mw={key:0,class:"empty-placeholder"},pw={key:0},vw={key:1},hw={key:1,class:"schedule-list"},_w={__name:"SchedulePanel",setup(n){const e=_e(),s=Kt(),a=it(),l=L(!1),c=L(""),d=k(()=>e.currentSession?.project_id||null),g=k(()=>{if(!d.value)return[];const u=s.getSchedules(d.value);return c.value?u.filter(f=>f.status===c.value):u});return fe(d,u=>{u&&s.loadSchedules(u)},{immediate:!0}),fe(()=>a.legionConnected,u=>{u&&d.value&&s.loadSchedules(d.value)}),(u,f)=>(i(),r("div",dw,[t("div",fw,[$e(t("select",{"onUpdate:modelValue":f[0]||(f[0]=h=>c.value=h),class:"filter-select"},[...f[4]||(f[4]=[t("option",{value:""},"All",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"paused"},"Paused",-1),t("option",{value:"cancelled"},"Cancelled",-1)])],512),[[Cs,c.value]]),t("button",{class:"create-btn",onClick:f[1]||(f[1]=h=>l.value=!0),title:"Create Schedule"},"+ New")]),g.value.length===0?(i(),r("div",mw,[d.value?(i(),r("span",vw,"No schedules found. Create one to automate recurring tasks.")):(i(),r("span",pw,"Select a session to view schedules"))])):(i(),r("div",hw,[(i(!0),r(ee,null,le(g.value,h=>(i(),Ee(X1,{key:h.schedule_id,schedule:h,"legion-id":d.value},null,8,["schedule","legion-id"]))),128))])),l.value?(i(),Ee(uw,{key:2,"legion-id":d.value,onClose:f[2]||(f[2]=h=>l.value=!1),onCreated:f[3]||(f[3]=h=>l.value=!1)},null,8,["legion-id"])):M("",!0)]))}},gw=te(_w,[["__scopeId","data-v-0afee8a8"]]),bw={class:"sidebar-tabs"},yw=["onClick"],ww={key:0,class:"tab-badge"},kw={class:"tab-content-container"},$w={__name:"RightSidebar",setup(n){const e=Ce(),s=as(),a=st(),l=wn(),c=zt(),d=_e(),g=Kt(),u=k(()=>e.rightSidebarActiveTab),f=k(()=>s.currentTaskStats),h=k(()=>a.currentResourceCount),S=k(()=>l.fileCount),m=k(()=>{const E=d.currentSession?.project_id,D=d.currentSessionId;return!E||!D?0:(c.commsByLegion.get(E)||[]).filter(O=>O.from_minion_id===D||O.to_minion_id===D).length}),p=k(()=>{const E=d.currentSession?.project_id;return E?g.getSchedules(E).filter(T=>T.status==="active").length:0}),w=k(()=>[{id:"diff",label:"Diff",badge:S.value},{id:"tasks",label:"Tasks",badge:f.value.total>0?f.value.total:0},{id:"resources",label:"Resources",badge:h.value},{id:"comms",label:"Comms",badge:m.value},{id:"schedules",label:"Sched",badge:p.value}]),b=k(()=>e.windowWidth<768),v=k(()=>b.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),_=L(!1);function o(E){E.preventDefault(),_.value=!0,document.addEventListener("mousemove",y),document.addEventListener("mouseup",$)}function y(E){if(_.value){const D=window.innerWidth-E.clientX;e.setRightSidebarWidth(D)}}function $(){_.value=!1,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",$)}return(E,D)=>(i(),r("aside",{id:"right-sidebar",class:H(["right-sidebar",{resizing:_.value,"theme-red-panel":W(e).isRedBackground}]),style:Pe(v.value)},[he(dg),t("div",bw,[(i(!0),r(ee,null,le(w.value,T=>(i(),r("button",{key:T.id,class:H(["sidebar-tab",{active:u.value===T.id}]),onClick:O=>W(e).setRightSidebarTab(T.id)},[ue(x(T.label)+" ",1),T.badge>0?(i(),r("span",ww,x(T.badge),1)):M("",!0)],10,yw))),128))]),t("div",kw,[$e(he(Oy,null,null,512),[[tt,u.value==="diff"]]),$e(he(qg,null,null,512),[[tt,u.value==="tasks"]]),$e(he(_b,null,null,512),[[tt,u.value==="resources"]]),$e(he(g1,null,null,512),[[tt,u.value==="comms"]]),$e(he(gw,null,null,512),[[tt,u.value==="schedules"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:o},null,32),he(Xb),he(o1)],6))}},Sw=te($w,[["__scopeId","data-v-d8a8d63a"]]),xw={class:"modal-dialog modal-lg"},Cw={class:"modal-content"},Ew={class:"modal-body"},Tw={class:"mb-3"},Aw={class:"input-group"},Dw=["disabled"],Mw={key:0,class:"text-center py-4"},Ow={key:1,class:"alert alert-danger",role:"alert"},Lw={key:2,class:"folder-list"},Iw=["onClick","onDblclick"],Nw={class:"d-flex align-items-center flex-grow-1"},Pw=["onClick"],jw={key:1,class:"text-center text-muted py-3"},Rw={class:"modal-footer"},Bw=["disabled"],Fw={__name:"FolderBrowserModal",setup(n){const e=Ce(),s=L(""),a=L(""),l=L([]),c=L(!1),d=L(""),g=L(null);let u=null,f=null;const h=k(()=>{if(!s.value)return null;const y=s.value.split(/[\\/]/).filter(Boolean);return y.length<=1?null:(y.pop(),y.length>0?"/"+y.join("/"):"/")});function S(y){if(!y)return"";const $=y.split(/[\\/]/).filter(Boolean);return $.length<=2?y:".../"+$.slice(-2).join("/")}async function m(){c.value=!0,d.value="",l.value=[],a.value="";try{const y=s.value?{path:s.value}:{},$=await ve.get("/api/filesystem/browse",{params:y});$.current_path&&(s.value=$.current_path),l.value=$.directories||[]}catch(y){console.error("Failed to load directory:",y),d.value=y.message||"Failed to load directory"}finally{c.value=!1}}function p(y){a.value=y.path}function w(y){s.value=y.path,a.value="",m()}function b(){h.value&&(s.value=h.value,a.value="",m())}function v(){const y=a.value||s.value;y&&f&&f(y),u&&u.hide()}function _(){m()}function o(){l.value=[],a.value="",d.value="",f=null,e.hideModal()}return fe(()=>e.currentModal,y=>{if(y?.name==="folder-browser"&&u){const $=y.data||{};s.value=$.defaultPath||$.currentPath||"",f=$.onSelect||null,u.show()}}),Me(()=>{g.value&&Ie(async()=>{const{default:y}=await import("./modal-D6mKceGM.js").then($=>$.m);return{default:y}},__vite__mapDeps([0,1])).then(({default:y})=>{u=new y(g.value),g.value.addEventListener("shown.bs.modal",_),g.value.addEventListener("hidden.bs.modal",o)})}),Oe(()=>{g.value&&(g.value.removeEventListener("shown.bs.modal",_),g.value.removeEventListener("hidden.bs.modal",o)),u&&u.dispose()}),(y,$)=>(i(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:g},[t("div",xw,[t("div",Cw,[$[6]||($[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ew,[t("div",Tw,[$[1]||($[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Aw,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":$[0]||($[0]=E=>s.value=E),onKeyup:ct(m,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[De,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:m,disabled:c.value}," ðŸ”„ Refresh ",8,Dw)])]),c.value?(i(),r("div",Mw,[...$[2]||($[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value?(i(),r("div",Ow,x(d.value),1)):(i(),r("div",Lw,[h.value?(i(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...$[3]||($[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):M("",!0),(i(!0),r(ee,null,le(l.value,E=>(i(),r("div",{key:E.path,class:H(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:E.path===a.value}]),onClick:D=>p(E),onDblclick:D=>w(E),role:"button"},[t("div",Nw,[$[4]||($[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,x(E.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ae(D=>w(E),["stop"])}," Open ",8,Pw)],42,Iw))),128)),l.value.length===0?(i(),r("div",jw," No subdirectories found ")):M("",!0)]))]),t("div",Rw,[$[5]||($[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:!a.value},' Select "'+x(S(a.value||s.value))+'" ',9,Bw)])])])],512))}},Vw=te(Fw,[["__scopeId","data-v-0d61ed46"]]),Uw={class:"modal-dialog"},Ww={class:"modal-content"},Hw={class:"modal-body"},qw={class:"mb-3"},zw={key:0,class:"invalid-feedback"},Kw={class:"mb-3"},Gw={class:"input-group"},Xw={key:0,class:"invalid-feedback"},Yw={class:"mb-3 form-check"},Qw={key:0,class:"mb-3 ms-4"},Jw={key:1,class:"alert alert-danger",role:"alert"},Zw={class:"modal-footer"},e0=["disabled"],t0={key:0,class:"spinner-border spinner-border-sm me-2"},s0={__name:"ProjectCreateModal",setup(n){const e=Ge(),s=_e(),a=Ce(),l=L({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),c=L({name:"",workingDirectory:""}),d=L(!1),g=L(""),u=L(null);let f=null;function h(){a.showModal("folder-browser",{currentPath:l.value.workingDirectory||"",onSelect:v=>{l.value.workingDirectory=v,c.value.workingDirectory=""}})}function S(){c.value={};let v=!0;return l.value.name.trim()||(c.value.name="Project name is required",v=!1),l.value.workingDirectory.trim()||(c.value.workingDirectory="Working directory is required",v=!1),v}async function m(){if(S()){d.value=!0,g.value="";try{const v=await e.createProject(l.value.name,l.value.workingDirectory);l.value.createSession&&await s.createSession(v.project_id,{name:l.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),p()}catch(v){console.error("Failed to create project:",v),g.value=v.message||"Failed to create project. Please try again."}finally{d.value=!1}}}function p(){l.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},c.value={},g.value=""}function w(){const v=document.getElementById("projectName");v&&v.focus()}function b(){p(),a.hideModal()}return fe(()=>a.currentModal,v=>{v?.name==="create-project"&&f&&f.show()}),Me(()=>{u.value&&Ie(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{f=new v(u.value),u.value.addEventListener("shown.bs.modal",w),u.value.addEventListener("hidden.bs.modal",b)})}),Oe(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",w),u.value.removeEventListener("hidden.bs.modal",b)),f&&f.dispose()}),(v,_)=>(i(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",Uw,[t("div",Ww,[_[11]||(_[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Hw,[t("form",{onSubmit:ae(m,["prevent"])},[t("div",qw,[_[4]||(_[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":c.value.name}]),id:"projectName","onUpdate:modelValue":_[0]||(_[0]=o=>l.value.name=o),placeholder:"My Project",required:""},null,2),[[De,l.value.name]]),c.value.name?(i(),r("div",zw,x(c.value.name),1)):M("",!0)]),t("div",Kw,[_[5]||(_[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",Gw,[$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":c.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":_[1]||(_[1]=o=>l.value.workingDirectory=o),placeholder:"/path/to/project",required:""},null,2),[[De,l.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:h}," Browse... "),c.value.workingDirectory?(i(),r("div",Xw,x(c.value.workingDirectory),1)):M("",!0)]),_[6]||(_[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",Yw,[$e(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":_[2]||(_[2]=o=>l.value.createSession=o)},null,512),[[_n,l.value.createSession]]),_[7]||(_[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),_[8]||(_[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),l.value.createSession?(i(),r("div",Qw,[_[9]||(_[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),$e(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":_[3]||(_[3]=o=>l.value.sessionName=o),placeholder:"main"},null,512),[[De,l.value.sessionName]])])):M("",!0),g.value?(i(),r("div",Jw,x(g.value),1)):M("",!0)],32)]),t("div",Zw,[_[10]||(_[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:d.value},[d.value?(i(),r("span",t0)):M("",!0),ue(" "+x(d.value?"Creating...":"Create Project"),1)],8,e0)])])])],512))}},n0=te(s0,[["__scopeId","data-v-ea55fdae"]]),o0={class:"modal-dialog"},a0={class:"modal-content"},i0={class:"modal-body"},l0={class:"mb-3"},r0={key:0,class:"invalid-feedback"},c0={class:"mb-3"},u0=["value"],d0={key:0,class:"alert alert-danger",role:"alert"},f0={class:"danger-zone"},m0={class:"text-muted small"},p0=["disabled"],v0={key:0,class:"alert alert-warning mt-3",role:"alert"},h0={class:"mb-2"},_0={class:"d-flex gap-2"},g0=["disabled"],b0={key:0,class:"spinner-border spinner-border-sm me-2"},y0=["disabled"],w0={class:"modal-footer"},k0=["disabled"],$0={key:0,class:"spinner-border spinner-border-sm me-2"},S0={__name:"ProjectEditModal",setup(n){const e=Ge(),s=Ce(),a=L(null),l=L({name:""}),c=L({name:""}),d=L(!1),g=L(!1),u=L(""),f=L(!1),h=L(null);let S=null;const m=k(()=>a.value?.session_ids?.length||0);function p(){c.value={};let y=!0;return l.value.name.trim()||(c.value.name="Project name is required",y=!1),y}async function w(){if(!(!p()||!a.value)){d.value=!0,u.value="";try{await e.updateProject(a.value.project_id,{name:l.value.name}),S&&S.hide()}catch(y){console.error("Failed to update project:",y),u.value=y.message||"Failed to update project. Please try again."}finally{d.value=!1}}}async function b(){if(a.value){g.value=!0,u.value="";try{await e.deleteProject(a.value.project_id),S&&S.hide()}catch(y){console.error("Failed to delete project:",y),u.value=y.message||"Failed to delete project. Please try again."}finally{g.value=!1}}}function v(){l.value={name:""},c.value={},u.value="",f.value=!1}function _(){const y=document.getElementById("editProjectName");y&&(y.focus(),y.select())}function o(){v(),a.value=null,s.hideModal()}return fe(()=>s.currentModal,y=>{if(y?.name==="edit-project"&&S){const $=y.data||{};a.value=$.project,a.value&&(l.value.name=a.value.name),S.show()}}),Me(()=>{h.value&&Ie(async()=>{const{default:y}=await import("./modal-D6mKceGM.js").then($=>$.m);return{default:y}},__vite__mapDeps([0,1])).then(({default:y})=>{S=new y(h.value),h.value.addEventListener("shown.bs.modal",_),h.value.addEventListener("hidden.bs.modal",o)})}),Oe(()=>{h.value&&(h.value.removeEventListener("shown.bs.modal",_),h.value.removeEventListener("hidden.bs.modal",o)),S&&S.dispose()}),(y,$)=>(i(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[t("div",o0,[t("div",a0,[$[10]||($[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",i0,[t("form",{onSubmit:ae(w,["prevent"])},[t("div",l0,[$[3]||($[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":c.value.name}]),id:"editProjectName","onUpdate:modelValue":$[0]||($[0]=E=>l.value.name=E),placeholder:"My Project",required:""},null,2),[[De,l.value.name]]),c.value.name?(i(),r("div",r0,x(c.value.name),1)):M("",!0)]),t("div",c0,[$[4]||($[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:a.value?.working_directory,disabled:"",readonly:""},null,8,u0),$[5]||($[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),u.value?(i(),r("div",d0,x(u.value),1)):M("",!0)],32),$[8]||($[8]=t("hr",null,null,-1)),t("div",f0,[$[6]||($[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",m0," Deleting this project will also delete all "+x(m.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:$[1]||($[1]=E=>f.value=!0),disabled:g.value}," ðŸ—‘ï¸ Delete Project ",8,p0)]),f.value?(i(),r("div",v0,[$[7]||($[7]=t("strong",null,"Are you sure?",-1)),t("p",h0,' This will permanently delete the project "'+x(a.value?.name)+'" and all '+x(m.value)+" session(s). ",1),t("div",_0,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:g.value},[g.value?(i(),r("span",b0)):M("",!0),ue(" "+x(g.value?"Deleting...":"Yes, Delete Permanently"),1)],8,g0),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:$[2]||($[2]=E=>f.value=!1),disabled:g.value}," Cancel ",8,y0)])])):M("",!0)]),t("div",w0,[$[9]||($[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:d.value},[d.value?(i(),r("span",$0)):M("",!0),ue(" "+x(d.value?"Saving...":"Save Changes"),1)],8,k0)])])])],512))}},x0=te(S0,[["__scopeId","data-v-52679516"]]),C0={class:"general-tab"},E0={key:0,class:"mb-3"},T0={for:"template-select",class:"form-label"},A0=["value"],D0=["value"],M0={key:0,class:"form-text"},O0={class:"mb-3"},L0={for:"config-name",class:"form-label"},I0=["value","placeholder","pattern","title"],N0={key:0,class:"invalid-feedback"},P0={key:1,class:"form-text"},j0={key:1,class:"mb-3"},R0=["value"],B0={class:"mb-3"},F0=["value"],V0={class:"form-text"},U0={key:0},W0={class:"mb-3"},H0={for:"config-permission-mode",class:"form-label"},q0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},z0={key:1,class:"field-indicator modified",title:"Modified from template"},K0=["value","disabled"],G0={key:0,value:"bypassPermissions"},X0={class:"form-text"},Y0={key:0,class:"text-warning"},Q0={key:1},J0={class:"mb-3"},Z0={for:"config-role",class:"form-label"},ek={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},tk={key:1,class:"field-indicator modified",title:"Modified from template"},sk=["value","placeholder"],nk={class:"form-text"},ok={key:2,class:"mb-3"},ak={class:"input-group"},ik=["value","placeholder","disabled","readonly"],lk={class:"form-text"},rk={key:3,class:"mb-3"},ck={class:"form-control-plaintext"},uk={key:4,class:"mb-3 form-check"},dk=["checked"],fk={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=k(()=>e.mode==="create-session"||e.mode==="edit-session"),a=k(()=>e.mode==="create-template"||e.mode==="edit-template"),l=k(()=>e.mode==="create-session"),c=k(()=>e.mode==="edit-session"),d=k(()=>e.session?.state==="active"||e.session?.state==="starting"),g=k(()=>e.session?.initial_permission_mode==="bypassPermissions"),u=k(()=>e.selectedTemplateId?e.templates.find(w=>w.template_id===e.selectedTemplateId):null),f={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},h=k(()=>f[e.formData.model]||null),S=k(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),m=k(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function p(w){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[w]||"bg-secondary"}return(w,b)=>(i(),r("div",C0,[l.value?(i(),r("div",E0,[t("label",T0,[b[10]||(b[10]=ue(" Template ",-1)),t("button",{type:"button",onClick:b[0]||(b[0]=v=>w.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:b[1]||(b[1]=v=>w.$emit("update:selected-template-id",v.target.value||null)),class:"form-select"},[b[11]||(b[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),r(ee,null,le(n.templates,v=>(i(),r("option",{key:v.template_id,value:v.template_id},x(v.name),9,D0))),128))],40,A0),u.value?(i(),r("div",M0,x(u.value.description),1)):M("",!0)])):M("",!0),t("div",O0,[t("label",L0,[ue(x(a.value?"Template Name":"Session Name")+" ",1),b[12]||(b[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:H(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:b[2]||(b[2]=v=>w.$emit("update:form-data","name",v.target.value)),placeholder:a.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,I0),n.errors.name?(i(),r("div",N0,x(n.errors.name),1)):M("",!0),s.value?(i(),r("div",P0,"Must be a single word (no spaces) for #nametag matching")):M("",!0)]),a.value?(i(),r("div",j0,[b[13]||(b[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:b[3]||(b[3]=v=>w.$emit("update:form-data","description",v.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,R0)])):M("",!0),t("div",B0,[b[15]||(b[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:b[4]||(b[4]=v=>w.$emit("update:form-data","model",v.target.value))},[...b[14]||(b[14]=[t("option",{value:"sonnet"},"Sonnet (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,F0),t("div",V0,[h.value?(i(),r("span",U0,x(h.value.description),1)):M("",!0)])]),t("div",W0,[t("label",H0,[b[16]||(b[16]=ue(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),r("span",q0," < ")):M("",!0),n.fieldStates.permission_mode==="modified"?(i(),r("span",z0," * ")):M("",!0)]),t("select",{id:"config-permission-mode",class:H(["form-select",m.value]),value:n.formData.permission_mode,onChange:b[5]||(b[5]=v=>w.$emit("update:form-data","permission_mode",v.target.value)),disabled:c.value&&!d.value},[b[17]||(b[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),b[18]||(b[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),b[19]||(b[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!c.value||g.value?(i(),r("option",G0," Bypass Permissions (No prompts - use with caution) ")):M("",!0)],42,K0),t("div",X0,[c.value&&!d.value?(i(),r("span",Y0," Session must be active to change permission mode. Start the session first. ")):(i(),r("span",Q0,"Controls which tool actions require permission prompts"))])]),t("div",J0,[t("label",Z0,[ue(x(a.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),r("span",ek," < ")):M("",!0),n.fieldStates.default_role==="modified"?(i(),r("span",tk," * ")):M("",!0)]),t("input",{id:"config-role",type:"text",class:H(["form-control",S.value]),value:n.formData.default_role,onInput:b[6]||(b[6]=v=>w.$emit("update:form-data","default_role",v.target.value)),placeholder:a.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,sk),t("div",nk,x(a.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),r("div",ok,[b[20]||(b[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",ak,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:b[7]||(b[7]=v=>w.$emit("update:form-data","working_directory",v.target.value)),placeholder:c.value?"":"Leave empty to inherit from project",disabled:c.value,readonly:c.value},null,40,ik),c.value?M("",!0):(i(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:b[8]||(b[8]=v=>w.$emit("open-folder-browser"))}," Browse "))]),t("div",lk,x(c.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):M("",!0),c.value&&n.session?(i(),r("div",rk,[b[21]||(b[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",ck,[t("span",{class:H(["badge",p(n.session.state)])},x(n.session.state),3)])])):M("",!0),l.value?(i(),r("div",uk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:b[9]||(b[9]=v=>w.$emit("update:form-data","startImmediately",v.target.checked))},null,40,dk),b[22]||(b[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):M("",!0)]))}},mk=te(fk,[["__scopeId","data-v-3e37d806"]]),pk={class:"permissions-tab"},vk={class:"mb-3"},hk={for:"config-allowed-tools",class:"form-label"},_k={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},gk={key:1,class:"field-indicator modified",title:"Modified from template"},bk={key:0,class:"tools-list mb-2"},yk=["onClick"],wk={class:"input-group input-group-sm"},kk=["onKeydown"],$k=["disabled"],Sk={class:"mt-2"},xk=["onClick"],Ck={class:"form-text"},Ek={class:"mb-3"},Tk={for:"config-disallowed-tools",class:"form-label"},Ak={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Dk={key:1,class:"field-indicator modified",title:"Modified from template"},Mk={key:0,class:"tools-list mb-2"},Ok=["onClick"],Lk={class:"input-group input-group-sm"},Ik=["onKeydown"],Nk=["disabled"],Pk={class:"mt-2"},jk=["onClick"],Rk={class:"form-text"},Bk={key:0,class:"mb-3"},Fk={class:"settings-sources-editor"},Vk={class:"form-check"},Uk=["checked"],Wk={class:"form-check"},Hk=["checked"],qk={class:"form-check"},zk=["checked"],Kk={key:1,class:"mb-3"},Gk={class:"mb-3"},Xk={key:0,class:"mt-2"},Yk=["value"],Qk=["value"],Jk={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,a=e,l=L(""),c=L(""),d=L(!1),g=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],u=k(()=>s.mode==="create-template"||s.mode==="edit-template"),f=k(()=>s.mode==="create-session"||s.mode==="edit-session"),h=k(()=>s.formData.setting_sources||["user","project","local"]),S=k(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(O=>O.trim()).filter(O=>O.length>0)),m=k(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(O=>O.trim()).filter(O=>O.length>0)),p=k(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),w=k(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),b=k(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),v=k(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function _(){const O=l.value.trim();if(O){if(!S.value.includes(O)){const C=[...S.value,O];a("update:form-data","allowed_tools",C.join(", "))}l.value=""}}function o(O){const C=[...S.value];C.splice(O,1),a("update:form-data","allowed_tools",C.join(", "))}function y(O){if(S.value.includes(O)){const C=S.value.indexOf(O);o(C)}else{const C=[...S.value,O];a("update:form-data","allowed_tools",C.join(", "))}}function $(){const O=c.value.trim();if(O){if(!m.value.includes(O)){const C=[...m.value,O];a("update:form-data","disallowed_tools",C.join(", "))}c.value=""}}function E(O){const C=[...m.value];C.splice(O,1),a("update:form-data","disallowed_tools",C.join(", "))}function D(O){if(m.value.includes(O)){const C=m.value.indexOf(O);E(C)}else{const C=[...m.value,O];a("update:form-data","disallowed_tools",C.join(", "))}}function T(O){const C=[...h.value],A=C.indexOf(O);A>=0?C.splice(A,1):C.push(O),a("update:form-data","setting_sources",C)}return(O,C)=>(i(),r("div",pk,[t("div",vk,[t("label",hk,[C[9]||(C[9]=ue(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),r("span",_k," < ")):M("",!0),n.fieldStates.allowed_tools==="modified"?(i(),r("span",gk," * ")):M("",!0)]),t("div",{class:H(["allowed-tools-editor",w.value])},[S.value.length>0?(i(),r("div",bk,[(i(!0),r(ee,null,le(S.value,(A,N)=>(i(),r("span",{key:N,class:"badge bg-primary me-1 mb-1 tool-badge"},[ue(x(A)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:P=>o(N),"aria-label":"Remove tool"},null,8,yk)]))),128))])):M("",!0),t("div",wk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=A=>l.value=A),onKeydown:ct(ae(_,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,kk),[[De,l.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:_,disabled:!l.value.trim()}," Add ",8,$k)]),t("div",Sk,[C[10]||(C[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),r(ee,null,le(g,A=>t("button",{key:A,type:"button",class:H(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":S.value.includes(A)}]),onClick:N=>y(A)},x(A),11,xk)),64))])],2),t("div",Ck,x(u.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",Ek,[t("label",Tk,[C[11]||(C[11]=ue(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(i(),r("span",Ak," < ")):M("",!0),n.fieldStates.disallowed_tools==="modified"?(i(),r("span",Dk," * ")):M("",!0)]),t("div",{class:H(["disallowed-tools-editor",v.value])},[m.value.length>0?(i(),r("div",Mk,[(i(!0),r(ee,null,le(m.value,(A,N)=>(i(),r("span",{key:N,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[ue(x(A)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:P=>E(N),"aria-label":"Remove denied tool"},null,8,Ok)]))),128))])):M("",!0),t("div",Lk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[1]||(C[1]=A=>c.value=A),onKeydown:ct(ae($,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,Ik),[[De,c.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:$,disabled:!c.value.trim()}," Deny ",8,Nk)]),t("div",Pk,[C[12]||(C[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(i(),r(ee,null,le(g,A=>t("button",{key:A,type:"button",class:H(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":m.value.includes(A)}]),onClick:N=>D(A)},x(A),11,jk)),64))])],2),t("div",Rk,x(u.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),f.value?(i(),r("div",Bk,[C[16]||(C[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",Fk,[t("div",Vk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:h.value.includes("user"),onChange:C[2]||(C[2]=A=>T("user"))},null,40,Uk),C[13]||(C[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[ue(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",Wk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:h.value.includes("project"),onChange:C[3]||(C[3]=A=>T("project"))},null,40,Hk),C[14]||(C[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[ue(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",qk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:h.value.includes("local"),onChange:C[4]||(C[4]=A=>T("local"))},null,40,zk),C[15]||(C[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[ue(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),C[17]||(C[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):M("",!0),f.value?(i(),r("div",Kk,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C[5]||(C[5]=A=>O.$emit("preview-permissions"))}," Preview Effective Permissions ")])):M("",!0),t("div",Gk,[t("a",{class:"text-muted small",role:"button",onClick:C[6]||(C[6]=A=>d.value=!d.value)},x(d.value?"Hide":"Show")+" raw input ",1),d.value?(i(),r("div",Xk,[C[18]||(C[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:H(["form-control form-control-sm",p.value]),value:n.formData.allowed_tools,onInput:C[7]||(C[7]=A=>O.$emit("update:form-data","allowed_tools",A.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,Yk),C[19]||(C[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:H(["form-control form-control-sm",b.value]),value:n.formData.disallowed_tools,onInput:C[8]||(C[8]=A=>O.$emit("update:form-data","disallowed_tools",A.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,Qk)])):M("",!0)])]))}},Zk=te(Jk,[["__scopeId","data-v-cbec74ed"]]),e$={class:"advanced-tab"},t$={class:"mb-3"},s$={for:"config-system-prompt",class:"form-label"},n$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},o$={key:1,class:"field-indicator modified",title:"Modified from template"},a$=["value","rows","placeholder"],i$={class:"form-text"},l$={class:"mb-3 form-check"},r$=["checked"],c$={key:0,class:"form-text text-warning"},u$={class:"mb-3"},d$={class:"docker-section"},f$={class:"form-check mb-2"},m$=["checked"],p$={key:0,class:"alert alert-warning py-2 mb-2"},v$={key:1,class:"alert alert-info py-2 mb-2"},h$={key:2,class:"docker-config ms-4"},_$={class:"mb-2"},g$=["value"],b$={class:"mb-2"},y$=["value"],w$={class:"mb-3"},k$=["value","disabled"],$$={class:"form-text"},S$={key:0,class:"text-muted"},x$={class:"mb-3"},C$={class:"capabilities-editor"},E$={key:0,class:"capabilities-list mb-2"},T$=["onClick"],A$={class:"input-group input-group-sm"},D$=["onKeydown"],M$=["disabled"],O$={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,a=e,l=k(()=>s.mode==="create-template"||s.mode==="edit-template"),c=k(()=>s.formData.initialization_context),d=k(()=>l.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),g=k(()=>s.formData.override_system_prompt?l.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":l.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),u=k(()=>{const v={};return s.fieldStates.initialization_context==="autofilled"&&(v["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(v["field-modified"]=!0),v}),f=L(""),h=L(null);Me(async()=>{try{h.value=await ve.get("/api/system/docker-status")}catch{h.value={available:!1,error:"Failed to check Docker status"}}});function S(v){a("update:form-data","docker_enabled",v),v&&a("update:form-data","cli_path","")}const m=k(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(v=>v.trim()).filter(v=>v.length>0));function p(v){const _=v.target.value;a("update:form-data","initialization_context",_)}function w(){const v=f.value.trim().toLowerCase();if(v){if(!m.value.includes(v)){const _=[...m.value,v];a("update:form-data","capabilities",_.join(", "))}f.value=""}}function b(v){const _=[...m.value];_.splice(v,1),a("update:form-data","capabilities",_.join(", "))}return(v,_)=>(i(),r("div",e$,[t("div",t$,[t("label",s$,[ue(x(l.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),r("span",n$," < ")):M("",!0),n.fieldStates.initialization_context==="modified"?(i(),r("span",o$," * ")):M("",!0)]),t("textarea",{id:"config-system-prompt",class:H(["form-control",u.value]),value:c.value,onInput:p,rows:l.value?4:5,placeholder:d.value},null,42,a$),t("div",i$,x(g.value),1)]),t("div",l$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:_[0]||(_[0]=o=>v.$emit("update:form-data","override_system_prompt",o.target.checked))},null,40,r$),_[6]||(_[6]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),r("div",c$,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+x(l.value?"":" or legion guide")+").",1)])):M("",!0)]),t("div",u$,[t("div",d$,[t("div",f$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-docker-enabled",checked:n.formData.docker_enabled,onChange:_[1]||(_[1]=o=>S(o.target.checked))},null,40,m$),_[7]||(_[7]=t("label",{class:"form-check-label",for:"config-docker-enabled"}," Enable Docker Isolation ",-1))]),n.formData.docker_enabled&&h.value&&!h.value.available?(i(),r("div",p$,[..._[8]||(_[8]=[t("small",null,"Docker is not available on this system. Sessions will fail to start.",-1)])])):M("",!0),n.formData.docker_enabled&&h.value&&h.value.available&&!h.value.image_exists?(i(),r("div",v$,[..._[9]||(_[9]=[t("small",null,"Docker image not yet built. It will be built automatically on first session start (~50s).",-1)])])):M("",!0),n.formData.docker_enabled?(i(),r("div",h$,[t("div",_$,[_[10]||(_[10]=t("label",{for:"config-docker-image",class:"form-label form-label-sm"},"Docker Image",-1)),t("input",{type:"text",class:"form-control form-control-sm",id:"config-docker-image",value:n.formData.docker_image,onInput:_[2]||(_[2]=o=>v.$emit("update:form-data","docker_image",o.target.value)),placeholder:"claude-code:local"},null,40,g$)]),t("div",b$,[_[11]||(_[11]=t("label",{for:"config-docker-mounts",class:"form-label form-label-sm"},"Extra Mounts",-1)),t("textarea",{id:"config-docker-mounts",class:"form-control form-control-sm",value:n.formData.docker_extra_mounts,onInput:_[3]||(_[3]=o=>v.$emit("update:form-data","docker_extra_mounts",o.target.value)),rows:"2",placeholder:"/host/path:/container/path:ro (one per line)"},null,40,y$),_[12]||(_[12]=t("div",{class:"form-text"},[t("small",null,"Additional volume mounts, one per line.")],-1))])])):M("",!0),_[13]||(_[13]=t("div",{class:"form-text"}," Run the Claude CLI inside a disposable Docker container. Tool execution (Bash, Read, Write, Edit) runs inside the container. ",-1))])]),t("div",w$,[_[14]||(_[14]=t("label",{for:"config-cli-path",class:"form-label"},"CLI Path",-1)),t("input",{type:"text",class:"form-control",id:"config-cli-path",value:n.formData.cli_path,onInput:_[4]||(_[4]=o=>v.$emit("update:form-data","cli_path",o.target.value)),disabled:n.formData.docker_enabled,placeholder:"/path/to/claude-cli"},null,40,k$),t("div",$$,[n.formData.docker_enabled?(i(),r("small",S$,"Managed automatically by Docker mode.")):(i(),r(ee,{key:1},[ue(" Path to a custom CLI executable. When set, the SDK uses this instead of the default Claude Code CLI. Leave empty for default behavior. ")],64))])]),t("div",x$,[_[15]||(_[15]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",C$,[m.value.length>0?(i(),r("div",E$,[(i(!0),r(ee,null,le(m.value,(o,y)=>(i(),r("span",{key:y,class:"badge bg-info me-1 mb-1 capability-badge"},[ue(x(o)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:$=>b(y),"aria-label":"Remove capability"},null,8,T$)]))),128))])):M("",!0),t("div",A$,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":_[5]||(_[5]=o=>f.value=o),onKeydown:ct(ae(w,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,D$),[[De,f.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:w,disabled:!f.value.trim()}," Add ",8,M$)])]),_[16]||(_[16]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},L$=te(O$,[["__scopeId","data-v-ecf08e60"]]),I$={class:"sandbox-tab"},N$={class:"mb-3 form-check"},P$=["checked"],j$={class:"mb-2 form-check"},R$=["checked","disabled"],B$={class:"mb-2 form-check"},F$=["checked","disabled"],V$={class:"mb-2"},U$=["value","disabled"],W$={class:"mb-3 form-check"},H$=["checked","disabled"],q$={class:"mb-2"},z$=["value","disabled"],K$={class:"mb-2 form-check"},G$=["checked","disabled"],X$={class:"mb-2"},Y$=["value","disabled"],Q$={class:"mb-3 form-check"},J$=["checked","disabled"],Z$={class:"mb-2"},eS=["value","disabled"],tS={class:"mb-2"},sS=["value","disabled"],nS={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function a(d,g){s.formData.sandbox[d]=g}function l(d,g){s.formData.sandbox.network[d]=g}function c(d,g){s.formData.sandbox.ignoreViolations[d]=g}return(d,g)=>(i(),r("div",I$,[t("div",N$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:g[0]||(g[0]=u=>d.$emit("update:form-data","sandbox_enabled",u.target.checked))},null,40,P$),g[11]||(g[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:H(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,x(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",j$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:g[1]||(g[1]=u=>a("autoAllowBashIfSandboxed",u.target.checked))},null,40,R$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",B$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:g[2]||(g[2]=u=>a("allowUnsandboxedCommands",u.target.checked))},null,40,F$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",V$,[t("label",{for:"config-sandbox-excluded-cmds",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:g[3]||(g[3]=u=>a("excludedCommands",u.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,U$)]),t("div",W$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:g[4]||(g[4]=u=>a("enableWeakerNestedSandbox",u.target.checked))},null,40,H$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",q$,[t("label",{for:"config-sandbox-allowed-domains",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:g[5]||(g[5]=u=>l("allowedDomains",u.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,z$)]),t("div",K$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:g[6]||(g[6]=u=>l("allowLocalBinding",u.target.checked))},null,40,G$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",X$,[t("label",{for:"config-sandbox-unix-sockets",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:g[7]||(g[7]=u=>l("allowUnixSockets",u.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,Y$)]),t("div",Q$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:g[8]||(g[8]=u=>l("allowAllUnixSockets",u.target.checked))},null,40,J$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",Z$,[t("label",{for:"config-sandbox-ignore-file",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:g[9]||(g[9]=u=>c("file",u.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,eS)]),t("div",tS,[t("label",{for:"config-sandbox-ignore-network",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:g[10]||(g[10]=u=>c("network",u.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,sS)])]))}},oS=te(nS,[["__scopeId","data-v-be109d12"]]);var je="top",Ve="bottom",Ue="right",Re="left",Ms="auto",Gt=[je,Ve,Ue,Re],Ct="start",Bt="end",Ho="clippingParents",kn="viewport",It="popper",qo="reference",un=Gt.reduce(function(n,e){return n.concat([e+"-"+Ct,e+"-"+Bt])},[]),$n=[].concat(Gt,[Ms]).reduce(function(n,e){return n.concat([e,e+"-"+Ct,e+"-"+Bt])},[]),zo="beforeRead",Ko="read",Go="afterRead",Xo="beforeMain",Yo="main",Qo="afterMain",Jo="beforeWrite",Zo="write",ea="afterWrite",ta=[zo,Ko,Go,Xo,Yo,Qo,Jo,Zo,ea];function at(n){return n?(n.nodeName||"").toLowerCase():null}function We(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Et(n){var e=We(n).Element;return n instanceof e||n instanceof Element}function qe(n){var e=We(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Sn(n){if(typeof ShadowRoot>"u")return!1;var e=We(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function aS(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var a=e.styles[s]||{},l=e.attributes[s]||{},c=e.elements[s];!qe(c)||!at(c)||(Object.assign(c.style,a),Object.keys(l).forEach(function(d){var g=l[d];g===!1?c.removeAttribute(d):c.setAttribute(d,g===!0?"":g)}))})}function iS(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(a){var l=e.elements[a],c=e.attributes[a]||{},d=Object.keys(e.styles.hasOwnProperty(a)?e.styles[a]:s[a]),g=d.reduce(function(u,f){return u[f]="",u},{});!qe(l)||!at(l)||(Object.assign(l.style,g),Object.keys(c).forEach(function(u){l.removeAttribute(u)}))})}}const sa={name:"applyStyles",enabled:!0,phase:"write",fn:aS,effect:iS,requires:["computeStyles"]};function nt(n){return n.split("-")[0]}var xt=Math.max,Es=Math.min,Ft=Math.round;function dn(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function na(){return!/^((?!chrome|android).)*safari/i.test(dn())}function Vt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var a=n.getBoundingClientRect(),l=1,c=1;e&&qe(n)&&(l=n.offsetWidth>0&&Ft(a.width)/n.offsetWidth||1,c=n.offsetHeight>0&&Ft(a.height)/n.offsetHeight||1);var d=Et(n)?We(n):window,g=d.visualViewport,u=!na()&&s,f=(a.left+(u&&g?g.offsetLeft:0))/l,h=(a.top+(u&&g?g.offsetTop:0))/c,S=a.width/l,m=a.height/c;return{width:S,height:m,top:h,right:f+S,bottom:h+m,left:f,x:f,y:h}}function xn(n){var e=Vt(n),s=n.offsetWidth,a=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-a)<=1&&(a=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:a}}function oa(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Sn(s)){var a=e;do{if(a&&n.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function ft(n){return We(n).getComputedStyle(n)}function lS(n){return["table","td","th"].indexOf(at(n))>=0}function bt(n){return((Et(n)?n.ownerDocument:n.document)||window.document).documentElement}function Os(n){return at(n)==="html"?n:n.assignedSlot||n.parentNode||(Sn(n)?n.host:null)||bt(n)}function Jn(n){return!qe(n)||ft(n).position==="fixed"?null:n.offsetParent}function rS(n){var e=/firefox/i.test(dn()),s=/Trident/i.test(dn());if(s&&qe(n)){var a=ft(n);if(a.position==="fixed")return null}var l=Os(n);for(Sn(l)&&(l=l.host);qe(l)&&["html","body"].indexOf(at(l))<0;){var c=ft(l);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return l;l=l.parentNode}return null}function cs(n){for(var e=We(n),s=Jn(n);s&&lS(s)&&ft(s).position==="static";)s=Jn(s);return s&&(at(s)==="html"||at(s)==="body"&&ft(s).position==="static")?e:s||rS(n)||e}function Cn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function ss(n,e,s){return xt(n,Es(e,s))}function cS(n,e,s){var a=ss(n,e,s);return a>s?s:a}function aa(){return{top:0,right:0,bottom:0,left:0}}function ia(n){return Object.assign({},aa(),n)}function la(n,e){return e.reduce(function(s,a){return s[a]=n,s},{})}var uS=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,ia(typeof e!="number"?e:la(e,Gt))};function dS(n){var e,s=n.state,a=n.name,l=n.options,c=s.elements.arrow,d=s.modifiersData.popperOffsets,g=nt(s.placement),u=Cn(g),f=[Re,Ue].indexOf(g)>=0,h=f?"height":"width";if(!(!c||!d)){var S=uS(l.padding,s),m=xn(c),p=u==="y"?je:Re,w=u==="y"?Ve:Ue,b=s.rects.reference[h]+s.rects.reference[u]-d[u]-s.rects.popper[h],v=d[u]-s.rects.reference[u],_=cs(c),o=_?u==="y"?_.clientHeight||0:_.clientWidth||0:0,y=b/2-v/2,$=S[p],E=o-m[h]-S[w],D=o/2-m[h]/2+y,T=ss($,D,E),O=u;s.modifiersData[a]=(e={},e[O]=T,e.centerOffset=T-D,e)}}function fS(n){var e=n.state,s=n.options,a=s.element,l=a===void 0?"[data-popper-arrow]":a;l!=null&&(typeof l=="string"&&(l=e.elements.popper.querySelector(l),!l)||oa(e.elements.popper,l)&&(e.elements.arrow=l))}const ra={name:"arrow",enabled:!0,phase:"main",fn:dS,effect:fS,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ut(n){return n.split("-")[1]}var mS={top:"auto",right:"auto",bottom:"auto",left:"auto"};function pS(n,e){var s=n.x,a=n.y,l=e.devicePixelRatio||1;return{x:Ft(s*l)/l||0,y:Ft(a*l)/l||0}}function Zn(n){var e,s=n.popper,a=n.popperRect,l=n.placement,c=n.variation,d=n.offsets,g=n.position,u=n.gpuAcceleration,f=n.adaptive,h=n.roundOffsets,S=n.isFixed,m=d.x,p=m===void 0?0:m,w=d.y,b=w===void 0?0:w,v=typeof h=="function"?h({x:p,y:b}):{x:p,y:b};p=v.x,b=v.y;var _=d.hasOwnProperty("x"),o=d.hasOwnProperty("y"),y=Re,$=je,E=window;if(f){var D=cs(s),T="clientHeight",O="clientWidth";if(D===We(s)&&(D=bt(s),ft(D).position!=="static"&&g==="absolute"&&(T="scrollHeight",O="scrollWidth")),D=D,l===je||(l===Re||l===Ue)&&c===Bt){$=Ve;var C=S&&D===E&&E.visualViewport?E.visualViewport.height:D[T];b-=C-a.height,b*=u?1:-1}if(l===Re||(l===je||l===Ve)&&c===Bt){y=Ue;var A=S&&D===E&&E.visualViewport?E.visualViewport.width:D[O];p-=A-a.width,p*=u?1:-1}}var N=Object.assign({position:g},f&&mS),P=h===!0?pS({x:p,y:b},We(s)):{x:p,y:b};if(p=P.x,b=P.y,u){var F;return Object.assign({},N,(F={},F[$]=o?"0":"",F[y]=_?"0":"",F.transform=(E.devicePixelRatio||1)<=1?"translate("+p+"px, "+b+"px)":"translate3d("+p+"px, "+b+"px, 0)",F))}return Object.assign({},N,(e={},e[$]=o?b+"px":"",e[y]=_?p+"px":"",e.transform="",e))}function vS(n){var e=n.state,s=n.options,a=s.gpuAcceleration,l=a===void 0?!0:a,c=s.adaptive,d=c===void 0?!0:c,g=s.roundOffsets,u=g===void 0?!0:g,f={placement:nt(e.placement),variation:Ut(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:l,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Zn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:d,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Zn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const ca={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:vS,data:{}};var hs={passive:!0};function hS(n){var e=n.state,s=n.instance,a=n.options,l=a.scroll,c=l===void 0?!0:l,d=a.resize,g=d===void 0?!0:d,u=We(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&f.forEach(function(h){h.addEventListener("scroll",s.update,hs)}),g&&u.addEventListener("resize",s.update,hs),function(){c&&f.forEach(function(h){h.removeEventListener("scroll",s.update,hs)}),g&&u.removeEventListener("resize",s.update,hs)}}const ua={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:hS,data:{}};var _S={left:"right",right:"left",bottom:"top",top:"bottom"};function $s(n){return n.replace(/left|right|bottom|top/g,function(e){return _S[e]})}var gS={start:"end",end:"start"};function eo(n){return n.replace(/start|end/g,function(e){return gS[e]})}function En(n){var e=We(n),s=e.pageXOffset,a=e.pageYOffset;return{scrollLeft:s,scrollTop:a}}function Tn(n){return Vt(bt(n)).left+En(n).scrollLeft}function bS(n,e){var s=We(n),a=bt(n),l=s.visualViewport,c=a.clientWidth,d=a.clientHeight,g=0,u=0;if(l){c=l.width,d=l.height;var f=na();(f||!f&&e==="fixed")&&(g=l.offsetLeft,u=l.offsetTop)}return{width:c,height:d,x:g+Tn(n),y:u}}function yS(n){var e,s=bt(n),a=En(n),l=(e=n.ownerDocument)==null?void 0:e.body,c=xt(s.scrollWidth,s.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),d=xt(s.scrollHeight,s.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),g=-a.scrollLeft+Tn(n),u=-a.scrollTop;return ft(l||s).direction==="rtl"&&(g+=xt(s.clientWidth,l?l.clientWidth:0)-c),{width:c,height:d,x:g,y:u}}function An(n){var e=ft(n),s=e.overflow,a=e.overflowX,l=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+l+a)}function da(n){return["html","body","#document"].indexOf(at(n))>=0?n.ownerDocument.body:qe(n)&&An(n)?n:da(Os(n))}function ns(n,e){var s;e===void 0&&(e=[]);var a=da(n),l=a===((s=n.ownerDocument)==null?void 0:s.body),c=We(a),d=l?[c].concat(c.visualViewport||[],An(a)?a:[]):a,g=e.concat(d);return l?g:g.concat(ns(Os(d)))}function fn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function wS(n,e){var s=Vt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function to(n,e,s){return e===kn?fn(bS(n,s)):Et(e)?wS(e,s):fn(yS(bt(n)))}function kS(n){var e=ns(Os(n)),s=["absolute","fixed"].indexOf(ft(n).position)>=0,a=s&&qe(n)?cs(n):n;return Et(a)?e.filter(function(l){return Et(l)&&oa(l,a)&&at(l)!=="body"}):[]}function $S(n,e,s,a){var l=e==="clippingParents"?kS(n):[].concat(e),c=[].concat(l,[s]),d=c[0],g=c.reduce(function(u,f){var h=to(n,f,a);return u.top=xt(h.top,u.top),u.right=Es(h.right,u.right),u.bottom=Es(h.bottom,u.bottom),u.left=xt(h.left,u.left),u},to(n,d,a));return g.width=g.right-g.left,g.height=g.bottom-g.top,g.x=g.left,g.y=g.top,g}function fa(n){var e=n.reference,s=n.element,a=n.placement,l=a?nt(a):null,c=a?Ut(a):null,d=e.x+e.width/2-s.width/2,g=e.y+e.height/2-s.height/2,u;switch(l){case je:u={x:d,y:e.y-s.height};break;case Ve:u={x:d,y:e.y+e.height};break;case Ue:u={x:e.x+e.width,y:g};break;case Re:u={x:e.x-s.width,y:g};break;default:u={x:e.x,y:e.y}}var f=l?Cn(l):null;if(f!=null){var h=f==="y"?"height":"width";switch(c){case Ct:u[f]=u[f]-(e[h]/2-s[h]/2);break;case Bt:u[f]=u[f]+(e[h]/2-s[h]/2);break}}return u}function Wt(n,e){e===void 0&&(e={});var s=e,a=s.placement,l=a===void 0?n.placement:a,c=s.strategy,d=c===void 0?n.strategy:c,g=s.boundary,u=g===void 0?Ho:g,f=s.rootBoundary,h=f===void 0?kn:f,S=s.elementContext,m=S===void 0?It:S,p=s.altBoundary,w=p===void 0?!1:p,b=s.padding,v=b===void 0?0:b,_=ia(typeof v!="number"?v:la(v,Gt)),o=m===It?qo:It,y=n.rects.popper,$=n.elements[w?o:m],E=$S(Et($)?$:$.contextElement||bt(n.elements.popper),u,h,d),D=Vt(n.elements.reference),T=fa({reference:D,element:y,placement:l}),O=fn(Object.assign({},y,T)),C=m===It?O:D,A={top:E.top-C.top+_.top,bottom:C.bottom-E.bottom+_.bottom,left:E.left-C.left+_.left,right:C.right-E.right+_.right},N=n.modifiersData.offset;if(m===It&&N){var P=N[l];Object.keys(A).forEach(function(F){var V=[Ue,Ve].indexOf(F)>=0?1:-1,X=[je,Ve].indexOf(F)>=0?"y":"x";A[F]+=P[X]*V})}return A}function SS(n,e){e===void 0&&(e={});var s=e,a=s.placement,l=s.boundary,c=s.rootBoundary,d=s.padding,g=s.flipVariations,u=s.allowedAutoPlacements,f=u===void 0?$n:u,h=Ut(a),S=h?g?un:un.filter(function(w){return Ut(w)===h}):Gt,m=S.filter(function(w){return f.indexOf(w)>=0});m.length===0&&(m=S);var p=m.reduce(function(w,b){return w[b]=Wt(n,{placement:b,boundary:l,rootBoundary:c,padding:d})[nt(b)],w},{});return Object.keys(p).sort(function(w,b){return p[w]-p[b]})}function xS(n){if(nt(n)===Ms)return[];var e=$s(n);return[eo(n),e,eo(e)]}function CS(n){var e=n.state,s=n.options,a=n.name;if(!e.modifiersData[a]._skip){for(var l=s.mainAxis,c=l===void 0?!0:l,d=s.altAxis,g=d===void 0?!0:d,u=s.fallbackPlacements,f=s.padding,h=s.boundary,S=s.rootBoundary,m=s.altBoundary,p=s.flipVariations,w=p===void 0?!0:p,b=s.allowedAutoPlacements,v=e.options.placement,_=nt(v),o=_===v,y=u||(o||!w?[$s(v)]:xS(v)),$=[v].concat(y).reduce(function(ge,be){return ge.concat(nt(be)===Ms?SS(e,{placement:be,boundary:h,rootBoundary:S,padding:f,flipVariations:w,allowedAutoPlacements:b}):be)},[]),E=e.rects.reference,D=e.rects.popper,T=new Map,O=!0,C=$[0],A=0;A<$.length;A++){var N=$[A],P=nt(N),F=Ut(N)===Ct,V=[je,Ve].indexOf(P)>=0,X=V?"width":"height",j=Wt(e,{placement:N,boundary:h,rootBoundary:S,altBoundary:m,padding:f}),I=V?F?Ue:Re:F?Ve:je;E[X]>D[X]&&(I=$s(I));var G=$s(I),q=[];if(c&&q.push(j[P]<=0),g&&q.push(j[I]<=0,j[G]<=0),q.every(function(ge){return ge})){C=N,O=!1;break}T.set(N,q)}if(O)for(var Z=w?3:1,K=function(be){var z=$.find(function(R){var U=T.get(R);if(U)return U.slice(0,be).every(function(se){return se})});if(z)return C=z,"break"},pe=Z;pe>0;pe--){var re=K(pe);if(re==="break")break}e.placement!==C&&(e.modifiersData[a]._skip=!0,e.placement=C,e.reset=!0)}}const ma={name:"flip",enabled:!0,phase:"main",fn:CS,requiresIfExists:["offset"],data:{_skip:!1}};function so(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function no(n){return[je,Ue,Ve,Re].some(function(e){return n[e]>=0})}function ES(n){var e=n.state,s=n.name,a=e.rects.reference,l=e.rects.popper,c=e.modifiersData.preventOverflow,d=Wt(e,{elementContext:"reference"}),g=Wt(e,{altBoundary:!0}),u=so(d,a),f=so(g,l,c),h=no(u),S=no(f);e.modifiersData[s]={referenceClippingOffsets:u,popperEscapeOffsets:f,isReferenceHidden:h,hasPopperEscaped:S},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":S})}const pa={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ES};function TS(n,e,s){var a=nt(n),l=[Re,je].indexOf(a)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,d=c[0],g=c[1];return d=d||0,g=(g||0)*l,[Re,Ue].indexOf(a)>=0?{x:g,y:d}:{x:d,y:g}}function AS(n){var e=n.state,s=n.options,a=n.name,l=s.offset,c=l===void 0?[0,0]:l,d=$n.reduce(function(h,S){return h[S]=TS(S,e.rects,c),h},{}),g=d[e.placement],u=g.x,f=g.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=f),e.modifiersData[a]=d}const va={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:AS};function DS(n){var e=n.state,s=n.name;e.modifiersData[s]=fa({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const ha={name:"popperOffsets",enabled:!0,phase:"read",fn:DS,data:{}};function MS(n){return n==="x"?"y":"x"}function OS(n){var e=n.state,s=n.options,a=n.name,l=s.mainAxis,c=l===void 0?!0:l,d=s.altAxis,g=d===void 0?!1:d,u=s.boundary,f=s.rootBoundary,h=s.altBoundary,S=s.padding,m=s.tether,p=m===void 0?!0:m,w=s.tetherOffset,b=w===void 0?0:w,v=Wt(e,{boundary:u,rootBoundary:f,padding:S,altBoundary:h}),_=nt(e.placement),o=Ut(e.placement),y=!o,$=Cn(_),E=MS($),D=e.modifiersData.popperOffsets,T=e.rects.reference,O=e.rects.popper,C=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,A=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),N=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,P={x:0,y:0};if(D){if(c){var F,V=$==="y"?je:Re,X=$==="y"?Ve:Ue,j=$==="y"?"height":"width",I=D[$],G=I+v[V],q=I-v[X],Z=p?-O[j]/2:0,K=o===Ct?T[j]:O[j],pe=o===Ct?-O[j]:-T[j],re=e.elements.arrow,ge=p&&re?xn(re):{width:0,height:0},be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:aa(),z=be[V],R=be[X],U=ss(0,T[j],ge[j]),se=y?T[j]/2-Z-U-z-A.mainAxis:K-U-z-A.mainAxis,Y=y?-T[j]/2+Z+U+R+A.mainAxis:pe+U+R+A.mainAxis,oe=e.elements.arrow&&cs(e.elements.arrow),Se=oe?$==="y"?oe.clientTop||0:oe.clientLeft||0:0,lt=(F=N?.[$])!=null?F:0,J=I+se-lt-Se,de=I+Y-lt,ye=ss(p?Es(G,J):G,I,p?xt(q,de):q);D[$]=ye,P[$]=ye-I}if(g){var we,Ae=$==="x"?je:Re,rt=$==="x"?Ve:Ue,Ze=D[E],kt=E==="y"?"height":"width",B=Ze+v[Ae],ne=Ze-v[rt],ie=[je,Re].indexOf(_)!==-1,ke=(we=N?.[E])!=null?we:0,ce=ie?B:Ze-T[kt]-O[kt]-ke+A.altAxis,xe=ie?Ze+T[kt]+O[kt]-ke-A.altAxis:ne,Te=p&&ie?cS(ce,Ze,xe):ss(p?ce:B,Ze,p?xe:ne);D[E]=Te,P[E]=Te-Ze}e.modifiersData[a]=P}}const _a={name:"preventOverflow",enabled:!0,phase:"main",fn:OS,requiresIfExists:["offset"]};function LS(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function IS(n){return n===We(n)||!qe(n)?En(n):LS(n)}function NS(n){var e=n.getBoundingClientRect(),s=Ft(e.width)/n.offsetWidth||1,a=Ft(e.height)/n.offsetHeight||1;return s!==1||a!==1}function PS(n,e,s){s===void 0&&(s=!1);var a=qe(e),l=qe(e)&&NS(e),c=bt(e),d=Vt(n,l,s),g={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(a||!a&&!s)&&((at(e)!=="body"||An(c))&&(g=IS(e)),qe(e)?(u=Vt(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):c&&(u.x=Tn(c))),{x:d.left+g.scrollLeft-u.x,y:d.top+g.scrollTop-u.y,width:d.width,height:d.height}}function jS(n){var e=new Map,s=new Set,a=[];n.forEach(function(c){e.set(c.name,c)});function l(c){s.add(c.name);var d=[].concat(c.requires||[],c.requiresIfExists||[]);d.forEach(function(g){if(!s.has(g)){var u=e.get(g);u&&l(u)}}),a.push(c)}return n.forEach(function(c){s.has(c.name)||l(c)}),a}function RS(n){var e=jS(n);return ta.reduce(function(s,a){return s.concat(e.filter(function(l){return l.phase===a}))},[])}function BS(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function FS(n){var e=n.reduce(function(s,a){var l=s[a.name];return s[a.name]=l?Object.assign({},l,a,{options:Object.assign({},l.options,a.options),data:Object.assign({},l.data,a.data)}):a,s},{});return Object.keys(e).map(function(s){return e[s]})}var oo={placement:"bottom",modifiers:[],strategy:"absolute"};function ao(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function ga(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,a=s===void 0?[]:s,l=e.defaultOptions,c=l===void 0?oo:l;return function(g,u,f){f===void 0&&(f=c);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},oo,c),modifiersData:{},elements:{reference:g,popper:u},attributes:{},styles:{}},S=[],m=!1,p={state:h,setOptions:function(_){var o=typeof _=="function"?_(h.options):_;b(),h.options=Object.assign({},c,h.options,o),h.scrollParents={reference:Et(g)?ns(g):g.contextElement?ns(g.contextElement):[],popper:ns(u)};var y=RS(FS([].concat(a,h.options.modifiers)));return h.orderedModifiers=y.filter(function($){return $.enabled}),w(),p.update()},forceUpdate:function(){if(!m){var _=h.elements,o=_.reference,y=_.popper;if(ao(o,y)){h.rects={reference:PS(o,cs(y),h.options.strategy==="fixed"),popper:xn(y)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(A){return h.modifiersData[A.name]=Object.assign({},A.data)});for(var $=0;$<h.orderedModifiers.length;$++){if(h.reset===!0){h.reset=!1,$=-1;continue}var E=h.orderedModifiers[$],D=E.fn,T=E.options,O=T===void 0?{}:T,C=E.name;typeof D=="function"&&(h=D({state:h,options:O,name:C,instance:p})||h)}}}},update:BS(function(){return new Promise(function(v){p.forceUpdate(),v(h)})}),destroy:function(){b(),m=!0}};if(!ao(g,u))return p;p.setOptions(f).then(function(v){!m&&f.onFirstUpdate&&f.onFirstUpdate(v)});function w(){h.orderedModifiers.forEach(function(v){var _=v.name,o=v.options,y=o===void 0?{}:o,$=v.effect;if(typeof $=="function"){var E=$({state:h,name:_,instance:p,options:y}),D=function(){};S.push(E||D)}})}function b(){S.forEach(function(v){return v()}),S=[]}return p}}var VS=[ua,ha,ca,sa,va,ma,_a,ra,pa],Dn=ga({defaultModifiers:VS});const ba=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Qo,afterRead:Go,afterWrite:ea,applyStyles:sa,arrow:ra,auto:Ms,basePlacements:Gt,beforeMain:Xo,beforeRead:zo,beforeWrite:Jo,bottom:Ve,clippingParents:Ho,computeStyles:ca,createPopper:Dn,detectOverflow:Wt,end:Bt,eventListeners:ua,flip:ma,hide:pa,left:Re,main:Yo,modifierPhases:ta,offset:va,placements:$n,popper:It,popperGenerator:ga,popperOffsets:ha,preventOverflow:_a,read:Ko,reference:qo,right:Ue,start:Ct,top:je,variationPlacements:un,viewport:kn,write:Zo},Symbol.toStringTag,{value:"Module"}));const pt=new Map,zs={set(n,e,s){pt.has(n)||pt.set(n,new Map);const a=pt.get(n);if(!a.has(e)&&a.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(a.keys())[0]}.`);return}a.set(e,s)},get(n,e){return pt.has(n)&&pt.get(n).get(e)||null},remove(n,e){if(!pt.has(n))return;const s=pt.get(n);s.delete(e),s.size===0&&pt.delete(n)}},US=1e6,WS=1e3,mn="transitionend",ya=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),HS=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),qS=n=>{do n+=Math.floor(Math.random()*US);while(document.getElementById(n));return n},zS=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const a=Number.parseFloat(e),l=Number.parseFloat(s);return!a&&!l?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*WS)},wa=n=>{n.dispatchEvent(new Event(mn))},ut=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),vt=n=>ut(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ya(n)):null,Xt=n=>{if(!ut(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const a=n.closest("summary");if(a&&a.parentNode!==s||a===null)return!1}return e},ht=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",ka=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?ka(n.parentNode):null},Ts=()=>{},us=n=>{n.offsetHeight},$a=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ks=[],KS=n=>{document.readyState==="loading"?(Ks.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ks)e()}),Ks.push(n)):n()},ze=()=>document.documentElement.dir==="rtl",Xe=n=>{KS(()=>{const e=$a();if(e){const s=n.NAME,a=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=a,n.jQueryInterface)}})},Be=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,Sa=(n,e,s=!0)=>{if(!s){Be(n);return}const l=zS(e)+5;let c=!1;const d=({target:g})=>{g===e&&(c=!0,e.removeEventListener(mn,d),Be(n))};e.addEventListener(mn,d),setTimeout(()=>{c||wa(e)},l)},Mn=(n,e,s,a)=>{const l=n.length;let c=n.indexOf(e);return c===-1?!s&&a?n[l-1]:n[0]:(c+=s?1:-1,a&&(c=(c+l)%l),n[Math.max(0,Math.min(c,l-1))])},GS=/[^.]*(?=\..*)\.|.*/,XS=/\..*/,YS=/::\d+$/,Gs={};let io=1;const xa={mouseenter:"mouseover",mouseleave:"mouseout"},QS=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ca(n,e){return e&&`${e}::${io++}`||n.uidEvent||io++}function Ea(n){const e=Ca(n);return n.uidEvent=e,Gs[e]=Gs[e]||{},Gs[e]}function JS(n,e){return function s(a){return On(a,{delegateTarget:n}),s.oneOff&&Q.off(n,a.type,e),e.apply(n,[a])}}function ZS(n,e,s){return function a(l){const c=n.querySelectorAll(e);for(let{target:d}=l;d&&d!==this;d=d.parentNode)for(const g of c)if(g===d)return On(l,{delegateTarget:d}),a.oneOff&&Q.off(n,l.type,e,s),s.apply(d,[l])}}function Ta(n,e,s=null){return Object.values(n).find(a=>a.callable===e&&a.delegationSelector===s)}function Aa(n,e,s){const a=typeof e=="string",l=a?s:e||s;let c=Da(n);return QS.has(c)||(c=n),[a,l,c]}function lo(n,e,s,a,l){if(typeof e!="string"||!n)return;let[c,d,g]=Aa(e,s,a);e in xa&&(d=(w=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return w.call(this,b)})(d));const u=Ea(n),f=u[g]||(u[g]={}),h=Ta(f,d,c?s:null);if(h){h.oneOff=h.oneOff&&l;return}const S=Ca(d,e.replace(GS,"")),m=c?ZS(n,s,d):JS(n,d);m.delegationSelector=c?s:null,m.callable=d,m.oneOff=l,m.uidEvent=S,f[S]=m,n.addEventListener(g,m,c)}function pn(n,e,s,a,l){const c=Ta(e[s],a,l);c&&(n.removeEventListener(s,c,!!l),delete e[s][c.uidEvent])}function ex(n,e,s,a){const l=e[s]||{};for(const[c,d]of Object.entries(l))c.includes(a)&&pn(n,e,s,d.callable,d.delegationSelector)}function Da(n){return n=n.replace(XS,""),xa[n]||n}const Q={on(n,e,s,a){lo(n,e,s,a,!1)},one(n,e,s,a){lo(n,e,s,a,!0)},off(n,e,s,a){if(typeof e!="string"||!n)return;const[l,c,d]=Aa(e,s,a),g=d!==e,u=Ea(n),f=u[d]||{},h=e.startsWith(".");if(typeof c<"u"){if(!Object.keys(f).length)return;pn(n,u,d,c,l?s:null);return}if(h)for(const S of Object.keys(u))ex(n,u,S,e.slice(1));for(const[S,m]of Object.entries(f)){const p=S.replace(YS,"");(!g||e.includes(p))&&pn(n,u,d,m.callable,m.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const a=$a(),l=Da(e),c=e!==l;let d=null,g=!0,u=!0,f=!1;c&&a&&(d=a.Event(e,s),a(n).trigger(d),g=!d.isPropagationStopped(),u=!d.isImmediatePropagationStopped(),f=d.isDefaultPrevented());const h=On(new Event(e,{bubbles:g,cancelable:!0}),s);return f&&h.preventDefault(),u&&n.dispatchEvent(h),h.defaultPrevented&&d&&d.preventDefault(),h}};function On(n,e={}){for(const[s,a]of Object.entries(e))try{n[s]=a}catch{Object.defineProperty(n,s,{configurable:!0,get(){return a}})}return n}function ro(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Xs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const dt={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Xs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Xs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(a=>a.startsWith("bs")&&!a.startsWith("bsConfig"));for(const a of s){let l=a.replace(/^bs/,"");l=l.charAt(0).toLowerCase()+l.slice(1),e[l]=ro(n.dataset[a])}return e},getDataAttribute(n,e){return ro(n.getAttribute(`data-bs-${Xs(e)}`))}};class ds{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const a=ut(s)?dt.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof a=="object"?a:{},...ut(s)?dt.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[a,l]of Object.entries(s)){const c=e[a],d=ut(c)?"element":HS(c);if(!new RegExp(l).test(d))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${a}" provided type "${d}" but expected type "${l}".`)}}}const tx="5.3.8";class Je extends ds{constructor(e,s){super(),e=vt(e),e&&(this._element=e,this._config=this._getConfig(s),zs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){zs.remove(this._element,this.constructor.DATA_KEY),Q.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,a=!0){Sa(e,s,a)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return zs.get(vt(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return tx}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ys=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ya(s)).join(","):null},me={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let a=n.parentNode.closest(e);for(;a;)s.push(a),a=a.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!ht(s)&&Xt(s))},getSelectorFromElement(n){const e=Ys(n);return e&&me.findOne(e)?e:null},getElementFromSelector(n){const e=Ys(n);return e?me.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ys(n);return e?me.find(e):[]}},Ls=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,a=n.NAME;Q.on(document,s,`[data-bs-dismiss="${a}"]`,function(l){if(["A","AREA"].includes(this.tagName)&&l.preventDefault(),ht(this))return;const c=me.getElementFromSelector(this)||this.closest(`.${a}`);n.getOrCreateInstance(c)[e]()})},sx="alert",nx="bs.alert",Ma=`.${nx}`,ox=`close${Ma}`,ax=`closed${Ma}`,ix="fade",lx="show";class Is extends Je{static get NAME(){return sx}close(){if(Q.trigger(this._element,ox).defaultPrevented)return;this._element.classList.remove(lx);const s=this._element.classList.contains(ix);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),Q.trigger(this._element,ax),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Is.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Ls(Is,"close");Xe(Is);const rx="button",cx="bs.button",ux=`.${cx}`,dx=".data-api",fx="active",co='[data-bs-toggle="button"]',mx=`click${ux}${dx}`;class Ns extends Je{static get NAME(){return rx}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(fx))}static jQueryInterface(e){return this.each(function(){const s=Ns.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}Q.on(document,mx,co,n=>{n.preventDefault();const e=n.target.closest(co);Ns.getOrCreateInstance(e).toggle()});Xe(Ns);const px="swipe",Yt=".bs.swipe",vx=`touchstart${Yt}`,hx=`touchmove${Yt}`,_x=`touchend${Yt}`,gx=`pointerdown${Yt}`,bx=`pointerup${Yt}`,yx="touch",wx="pen",kx="pointer-event",$x=40,Sx={endCallback:null,leftCallback:null,rightCallback:null},xx={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class As extends ds{constructor(e,s){super(),this._element=e,!(!e||!As.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Sx}static get DefaultType(){return xx}static get NAME(){return px}dispose(){Q.off(this._element,Yt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Be(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=$x)return;const s=e/this._deltaX;this._deltaX=0,s&&Be(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Q.on(this._element,gx,e=>this._start(e)),Q.on(this._element,bx,e=>this._end(e)),this._element.classList.add(kx)):(Q.on(this._element,vx,e=>this._start(e)),Q.on(this._element,hx,e=>this._move(e)),Q.on(this._element,_x,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===wx||e.pointerType===yx)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Cx="carousel",Ex="bs.carousel",yt=`.${Ex}`,Oa=".data-api",Tx="ArrowLeft",Ax="ArrowRight",Dx=500,Zt="next",Ot="prev",Nt="left",Ss="right",Mx=`slide${yt}`,Qs=`slid${yt}`,Ox=`keydown${yt}`,Lx=`mouseenter${yt}`,Ix=`mouseleave${yt}`,Nx=`dragstart${yt}`,Px=`load${yt}${Oa}`,jx=`click${yt}${Oa}`,La="carousel",_s="active",Rx="slide",Bx="carousel-item-end",Fx="carousel-item-start",Vx="carousel-item-next",Ux="carousel-item-prev",Ia=".active",Na=".carousel-item",Wx=Ia+Na,Hx=".carousel-item img",qx=".carousel-indicators",zx="[data-bs-slide], [data-bs-slide-to]",Kx='[data-bs-ride="carousel"]',Gx={[Tx]:Ss,[Ax]:Nt},Xx={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Yx={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class fs extends Je{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=me.findOne(qx,this._element),this._addEventListeners(),this._config.ride===La&&this.cycle()}static get Default(){return Xx}static get DefaultType(){return Yx}static get NAME(){return Cx}next(){this._slide(Zt)}nextWhenVisible(){!document.hidden&&Xt(this._element)&&this.next()}prev(){this._slide(Ot)}pause(){this._isSliding&&wa(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Q.one(this._element,Qs,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){Q.one(this._element,Qs,()=>this.to(e));return}const a=this._getItemIndex(this._getActive());if(a===e)return;const l=e>a?Zt:Ot;this._slide(l,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Q.on(this._element,Ox,e=>this._keydown(e)),this._config.pause==="hover"&&(Q.on(this._element,Lx,()=>this.pause()),Q.on(this._element,Ix,()=>this._maybeEnableCycle())),this._config.touch&&As.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const a of me.find(Hx,this._element))Q.on(a,Nx,l=>l.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Nt)),rightCallback:()=>this._slide(this._directionToOrder(Ss)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Dx+this._config.interval))}};this._swipeHelper=new As(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Gx[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=me.findOne(Ia,this._indicatorsElement);s.classList.remove(_s),s.removeAttribute("aria-current");const a=me.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);a&&(a.classList.add(_s),a.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const a=this._getActive(),l=e===Zt,c=s||Mn(this._getItems(),a,l,this._config.wrap);if(c===a)return;const d=this._getItemIndex(c),g=p=>Q.trigger(this._element,p,{relatedTarget:c,direction:this._orderToDirection(e),from:this._getItemIndex(a),to:d});if(g(Mx).defaultPrevented||!a||!c)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(d),this._activeElement=c;const h=l?Fx:Bx,S=l?Vx:Ux;c.classList.add(S),us(c),a.classList.add(h),c.classList.add(h);const m=()=>{c.classList.remove(h,S),c.classList.add(_s),a.classList.remove(_s,S,h),this._isSliding=!1,g(Qs)};this._queueCallback(m,a,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(Rx)}_getActive(){return me.findOne(Wx,this._element)}_getItems(){return me.find(Na,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return ze()?e===Nt?Ot:Zt:e===Nt?Zt:Ot}_orderToDirection(e){return ze()?e===Ot?Nt:Ss:e===Ot?Ss:Nt}static jQueryInterface(e){return this.each(function(){const s=fs.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(document,jx,zx,function(n){const e=me.getElementFromSelector(this);if(!e||!e.classList.contains(La))return;n.preventDefault();const s=fs.getOrCreateInstance(e),a=this.getAttribute("data-bs-slide-to");if(a){s.to(a),s._maybeEnableCycle();return}if(dt.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});Q.on(window,Px,()=>{const n=me.find(Kx);for(const e of n)fs.getOrCreateInstance(e)});Xe(fs);const Qx="collapse",Jx="bs.collapse",ms=`.${Jx}`,Zx=".data-api",eC=`show${ms}`,tC=`shown${ms}`,sC=`hide${ms}`,nC=`hidden${ms}`,oC=`click${ms}${Zx}`,Js="show",jt="collapse",gs="collapsing",aC="collapsed",iC=`:scope .${jt} .${jt}`,lC="collapse-horizontal",rC="width",cC="height",uC=".collapse.show, .collapse.collapsing",vn='[data-bs-toggle="collapse"]',dC={parent:null,toggle:!0},fC={parent:"(null|element)",toggle:"boolean"};class is extends Je{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const a=me.find(vn);for(const l of a){const c=me.getSelectorFromElement(l),d=me.find(c).filter(g=>g===this._element);c!==null&&d.length&&this._triggerArray.push(l)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return dC}static get DefaultType(){return fC}static get NAME(){return Qx}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(uC).filter(g=>g!==this._element).map(g=>is.getOrCreateInstance(g,{toggle:!1}))),e.length&&e[0]._isTransitioning||Q.trigger(this._element,eC).defaultPrevented)return;for(const g of e)g.hide();const a=this._getDimension();this._element.classList.remove(jt),this._element.classList.add(gs),this._element.style[a]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const l=()=>{this._isTransitioning=!1,this._element.classList.remove(gs),this._element.classList.add(jt,Js),this._element.style[a]="",Q.trigger(this._element,tC)},d=`scroll${a[0].toUpperCase()+a.slice(1)}`;this._queueCallback(l,this._element,!0),this._element.style[a]=`${this._element[d]}px`}hide(){if(this._isTransitioning||!this._isShown()||Q.trigger(this._element,sC).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,us(this._element),this._element.classList.add(gs),this._element.classList.remove(jt,Js);for(const l of this._triggerArray){const c=me.getElementFromSelector(l);c&&!this._isShown(c)&&this._addAriaAndCollapsedClass([l],!1)}this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(gs),this._element.classList.add(jt),Q.trigger(this._element,nC)};this._element.style[s]="",this._queueCallback(a,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Js)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=vt(e.parent),e}_getDimension(){return this._element.classList.contains(lC)?rC:cC}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(vn);for(const s of e){const a=me.getElementFromSelector(s);a&&this._addAriaAndCollapsedClass([s],this._isShown(a))}}_getFirstLevelChildren(e){const s=me.find(iC,this._config.parent);return me.find(e,this._config.parent).filter(a=>!s.includes(a))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const a of e)a.classList.toggle(aC,!s),a.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const a=is.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof a[e]>"u")throw new TypeError(`No method named "${e}"`);a[e]()}})}}Q.on(document,oC,vn,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of me.getMultipleElementsFromSelector(this))is.getOrCreateInstance(e,{toggle:!1}).toggle()});Xe(is);const uo="dropdown",mC="bs.dropdown",At=`.${mC}`,Ln=".data-api",pC="Escape",fo="Tab",vC="ArrowUp",mo="ArrowDown",hC=2,_C=`hide${At}`,gC=`hidden${At}`,bC=`show${At}`,yC=`shown${At}`,Pa=`click${At}${Ln}`,ja=`keydown${At}${Ln}`,wC=`keyup${At}${Ln}`,Pt="show",kC="dropup",$C="dropend",SC="dropstart",xC="dropup-center",CC="dropdown-center",$t='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',EC=`${$t}.${Pt}`,xs=".dropdown-menu",TC=".navbar",AC=".navbar-nav",DC=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",MC=ze()?"top-end":"top-start",OC=ze()?"top-start":"top-end",LC=ze()?"bottom-end":"bottom-start",IC=ze()?"bottom-start":"bottom-end",NC=ze()?"left-start":"right-start",PC=ze()?"right-start":"left-start",jC="top",RC="bottom",BC={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},FC={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ot extends Je{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=me.next(this._element,xs)[0]||me.prev(this._element,xs)[0]||me.findOne(xs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return BC}static get DefaultType(){return FC}static get NAME(){return uo}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ht(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Q.trigger(this._element,bC,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(AC))for(const a of[].concat(...document.body.children))Q.on(a,"mouseover",Ts);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Pt),this._element.classList.add(Pt),Q.trigger(this._element,yC,e)}}hide(){if(ht(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Q.trigger(this._element,_C,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))Q.off(a,"mouseover",Ts);this._popper&&this._popper.destroy(),this._menu.classList.remove(Pt),this._element.classList.remove(Pt),this._element.setAttribute("aria-expanded","false"),dt.removeDataAttribute(this._menu,"popper"),Q.trigger(this._element,gC,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!ut(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${uo.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof ba>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:ut(this._config.reference)?e=vt(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Dn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Pt)}_getPlacement(){const e=this._parent;if(e.classList.contains($C))return NC;if(e.classList.contains(SC))return PC;if(e.classList.contains(xC))return jC;if(e.classList.contains(CC))return RC;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(kC)?s?OC:MC:s?IC:LC}_detectNavbar(){return this._element.closest(TC)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(dt.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Be(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const a=me.find(DC,this._menu).filter(l=>Xt(l));a.length&&Mn(a,s,e===mo,!a.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=ot.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===hC||e.type==="keyup"&&e.key!==fo)return;const s=me.find(EC);for(const a of s){const l=ot.getInstance(a);if(!l||l._config.autoClose===!1)continue;const c=e.composedPath(),d=c.includes(l._menu);if(c.includes(l._element)||l._config.autoClose==="inside"&&!d||l._config.autoClose==="outside"&&d||l._menu.contains(e.target)&&(e.type==="keyup"&&e.key===fo||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const g={relatedTarget:l._element};e.type==="click"&&(g.clickEvent=e),l._completeHide(g)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),a=e.key===pC,l=[vC,mo].includes(e.key);if(!l&&!a||s&&!a)return;e.preventDefault();const c=this.matches($t)?this:me.prev(this,$t)[0]||me.next(this,$t)[0]||me.findOne($t,e.delegateTarget.parentNode),d=ot.getOrCreateInstance(c);if(l){e.stopPropagation(),d.show(),d._selectMenuItem(e);return}d._isShown()&&(e.stopPropagation(),d.hide(),c.focus())}}Q.on(document,ja,$t,ot.dataApiKeydownHandler);Q.on(document,ja,xs,ot.dataApiKeydownHandler);Q.on(document,Pa,ot.clearMenus);Q.on(document,wC,ot.clearMenus);Q.on(document,Pa,$t,function(n){n.preventDefault(),ot.getOrCreateInstance(this).toggle()});Xe(ot);const Ra="backdrop",VC="fade",po="show",vo=`mousedown.bs.${Ra}`,UC={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},WC={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Ba extends ds{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return UC}static get DefaultType(){return WC}static get NAME(){return Ra}show(e){if(!this._config.isVisible){Be(e);return}this._append();const s=this._getElement();this._config.isAnimated&&us(s),s.classList.add(po),this._emulateAnimation(()=>{Be(e)})}hide(e){if(!this._config.isVisible){Be(e);return}this._getElement().classList.remove(po),this._emulateAnimation(()=>{this.dispose(),Be(e)})}dispose(){this._isAppended&&(Q.off(this._element,vo),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(VC),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=vt(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Q.on(e,vo,()=>{Be(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Sa(e,this._getElement(),this._config.isAnimated)}}const HC="focustrap",qC="bs.focustrap",Ds=`.${qC}`,zC=`focusin${Ds}`,KC=`keydown.tab${Ds}`,GC="Tab",XC="forward",ho="backward",YC={autofocus:!0,trapElement:null},QC={autofocus:"boolean",trapElement:"element"};class Fa extends ds{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return YC}static get DefaultType(){return QC}static get NAME(){return HC}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Q.off(document,Ds),Q.on(document,zC,e=>this._handleFocusin(e)),Q.on(document,KC,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Q.off(document,Ds))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const a=me.focusableChildren(s);a.length===0?s.focus():this._lastTabNavDirection===ho?a[a.length-1].focus():a[0].focus()}_handleKeydown(e){e.key===GC&&(this._lastTabNavDirection=e.shiftKey?ho:XC)}}const _o=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",go=".sticky-top",bs="padding-right",bo="margin-right";class hn{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,bs,s=>s+e),this._setElementAttributes(_o,bs,s=>s+e),this._setElementAttributes(go,bo,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,bs),this._resetElementAttributes(_o,bs),this._resetElementAttributes(go,bo)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,a){const l=this.getWidth(),c=d=>{if(d!==this._element&&window.innerWidth>d.clientWidth+l)return;this._saveInitialAttribute(d,s);const g=window.getComputedStyle(d).getPropertyValue(s);d.style.setProperty(s,`${a(Number.parseFloat(g))}px`)};this._applyManipulationCallback(e,c)}_saveInitialAttribute(e,s){const a=e.style.getPropertyValue(s);a&&dt.setDataAttribute(e,s,a)}_resetElementAttributes(e,s){const a=l=>{const c=dt.getDataAttribute(l,s);if(c===null){l.style.removeProperty(s);return}dt.removeDataAttribute(l,s),l.style.setProperty(s,c)};this._applyManipulationCallback(e,a)}_applyManipulationCallback(e,s){if(ut(e)){s(e);return}for(const a of me.find(e,this._element))s(a)}}const JC="modal",ZC="bs.modal",Ke=`.${ZC}`,eE=".data-api",tE="Escape",sE=`hide${Ke}`,nE=`hidePrevented${Ke}`,Va=`hidden${Ke}`,Ua=`show${Ke}`,oE=`shown${Ke}`,aE=`resize${Ke}`,iE=`click.dismiss${Ke}`,lE=`mousedown.dismiss${Ke}`,rE=`keydown.dismiss${Ke}`,cE=`click${Ke}${eE}`,yo="modal-open",uE="fade",wo="show",Zs="modal-static",dE=".modal.show",fE=".modal-dialog",mE=".modal-body",pE='[data-bs-toggle="modal"]',vE={backdrop:!0,focus:!0,keyboard:!0},hE={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Tt extends Je{constructor(e,s){super(e,s),this._dialog=me.findOne(fE,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new hn,this._addEventListeners()}static get Default(){return vE}static get DefaultType(){return hE}static get NAME(){return JC}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Q.trigger(this._element,Ua,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(yo),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Q.trigger(this._element,sE).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(wo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Q.off(window,Ke),Q.off(this._dialog,Ke),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ba({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Fa({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=me.findOne(mE,this._dialog);s&&(s.scrollTop=0),us(this._element),this._element.classList.add(wo);const a=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Q.trigger(this._element,oE,{relatedTarget:e})};this._queueCallback(a,this._dialog,this._isAnimated())}_addEventListeners(){Q.on(this._element,rE,e=>{if(e.key===tE){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Q.on(window,aE,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Q.on(this._element,lE,e=>{Q.one(this._element,iE,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(yo),this._resetAdjustments(),this._scrollBar.reset(),Q.trigger(this._element,Va)})}_isAnimated(){return this._element.classList.contains(uE)}_triggerBackdropTransition(){if(Q.trigger(this._element,nE).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,a=this._element.style.overflowY;a==="hidden"||this._element.classList.contains(Zs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Zs),this._queueCallback(()=>{this._element.classList.remove(Zs),this._queueCallback(()=>{this._element.style.overflowY=a},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),a=s>0;if(a&&!e){const l=ze()?"paddingLeft":"paddingRight";this._element.style[l]=`${s}px`}if(!a&&e){const l=ze()?"paddingRight":"paddingLeft";this._element.style[l]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const a=Tt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof a[e]>"u")throw new TypeError(`No method named "${e}"`);a[e](s)}})}}Q.on(document,cE,pE,function(n){const e=me.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Q.one(e,Ua,l=>{l.defaultPrevented||Q.one(e,Va,()=>{Xt(this)&&this.focus()})});const s=me.findOne(dE);s&&Tt.getInstance(s).hide(),Tt.getOrCreateInstance(e).toggle(this)});Ls(Tt);Xe(Tt);const _E="offcanvas",gE="bs.offcanvas",mt=`.${gE}`,Wa=".data-api",bE=`load${mt}${Wa}`,yE="Escape",ko="show",$o="showing",So="hiding",wE="offcanvas-backdrop",Ha=".offcanvas.show",kE=`show${mt}`,$E=`shown${mt}`,SE=`hide${mt}`,xo=`hidePrevented${mt}`,qa=`hidden${mt}`,xE=`resize${mt}`,CE=`click${mt}${Wa}`,EE=`keydown.dismiss${mt}`,TE='[data-bs-toggle="offcanvas"]',AE={backdrop:!0,keyboard:!0,scroll:!1},DE={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class _t extends Je{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return AE}static get DefaultType(){return DE}static get NAME(){return _E}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Q.trigger(this._element,kE,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new hn().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add($o);const a=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(ko),this._element.classList.remove($o),Q.trigger(this._element,$E,{relatedTarget:e})};this._queueCallback(a,this._element,!0)}hide(){if(!this._isShown||Q.trigger(this._element,SE).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(So),this._backdrop.hide();const s=()=>{this._element.classList.remove(ko,So),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new hn().reset(),Q.trigger(this._element,qa)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Q.trigger(this._element,xo);return}this.hide()},s=!!this._config.backdrop;return new Ba({className:wE,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Fa({trapElement:this._element})}_addEventListeners(){Q.on(this._element,EE,e=>{if(e.key===yE){if(this._config.keyboard){this.hide();return}Q.trigger(this._element,xo)}})}static jQueryInterface(e){return this.each(function(){const s=_t.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Q.on(document,CE,TE,function(n){const e=me.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ht(this))return;Q.one(e,qa,()=>{Xt(this)&&this.focus()});const s=me.findOne(Ha);s&&s!==e&&_t.getInstance(s).hide(),_t.getOrCreateInstance(e).toggle(this)});Q.on(window,bE,()=>{for(const n of me.find(Ha))_t.getOrCreateInstance(n).show()});Q.on(window,xE,()=>{for(const n of me.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&_t.getOrCreateInstance(n).hide()});Ls(_t);Xe(_t);const ME=/^aria-[\w-]*$/i,za={"*":["class","dir","id","lang","role",ME],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},OE=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),LE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,IE=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?OE.has(s)?!!LE.test(n.nodeValue):!0:e.filter(a=>a instanceof RegExp).some(a=>a.test(s))};function NE(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const l=new window.DOMParser().parseFromString(n,"text/html"),c=[].concat(...l.body.querySelectorAll("*"));for(const d of c){const g=d.nodeName.toLowerCase();if(!Object.keys(e).includes(g)){d.remove();continue}const u=[].concat(...d.attributes),f=[].concat(e["*"]||[],e[g]||[]);for(const h of u)IE(h,f)||d.removeAttribute(h.nodeName)}return l.body.innerHTML}const PE="TemplateFactory",jE={allowList:za,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},RE={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},BE={entry:"(string|element|function|null)",selector:"(string|element)"};class FE extends ds{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return jE}static get DefaultType(){return RE}static get NAME(){return PE}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[l,c]of Object.entries(this._config.content))this._setContent(e,c,l);const s=e.children[0],a=this._resolvePossibleFunction(this._config.extraClass);return a&&s.classList.add(...a.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,a]of Object.entries(e))super._typeCheckConfig({selector:s,entry:a},BE)}_setContent(e,s,a){const l=me.findOne(a,e);if(l){if(s=this._resolvePossibleFunction(s),!s){l.remove();return}if(ut(s)){this._putElementInTemplate(vt(s),l);return}if(this._config.html){l.innerHTML=this._maybeSanitize(s);return}l.textContent=s}}_maybeSanitize(e){return this._config.sanitize?NE(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Be(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const VE="tooltip",UE=new Set(["sanitize","allowList","sanitizeFn"]),en="fade",WE="modal",ys="show",HE=".tooltip-inner",Co=`.${WE}`,Eo="hide.bs.modal",es="hover",tn="focus",sn="click",qE="manual",zE="hide",KE="hidden",GE="show",XE="shown",YE="inserted",QE="click",JE="focusin",ZE="focusout",e2="mouseenter",t2="mouseleave",s2={AUTO:"auto",TOP:"top",RIGHT:ze()?"left":"right",BOTTOM:"bottom",LEFT:ze()?"right":"left"},n2={allowList:za,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},o2={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Qt extends Je{constructor(e,s){if(typeof ba>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return n2}static get DefaultType(){return o2}static get NAME(){return VE}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Q.off(this._element.closest(Co),Eo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Q.trigger(this._element,this.constructor.eventName(GE)),a=(ka(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!a)return;this._disposePopper();const l=this._getTipElement();this._element.setAttribute("aria-describedby",l.getAttribute("id"));const{container:c}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(c.append(l),Q.trigger(this._element,this.constructor.eventName(YE))),this._popper=this._createPopper(l),l.classList.add(ys),"ontouchstart"in document.documentElement)for(const g of[].concat(...document.body.children))Q.on(g,"mouseover",Ts);const d=()=>{Q.trigger(this._element,this.constructor.eventName(XE)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(d,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Q.trigger(this._element,this.constructor.eventName(zE)).defaultPrevented)return;if(this._getTipElement().classList.remove(ys),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))Q.off(l,"mouseover",Ts);this._activeTrigger[sn]=!1,this._activeTrigger[tn]=!1,this._activeTrigger[es]=!1,this._isHovered=null;const a=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Q.trigger(this._element,this.constructor.eventName(KE)))};this._queueCallback(a,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(en,ys),s.classList.add(`bs-${this.constructor.NAME}-auto`);const a=qS(this.constructor.NAME).toString();return s.setAttribute("id",a),this._isAnimated()&&s.classList.add(en),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new FE({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[HE]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(en)}_isShown(){return this.tip&&this.tip.classList.contains(ys)}_createPopper(e){const s=Be(this._config.placement,[this,e,this._element]),a=s2[s.toUpperCase()];return Dn(this._element,e,this._getPopperConfig(a))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Be(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:a=>{this._getTipElement().setAttribute("data-popper-placement",a.state.placement)}}]};return{...s,...Be(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")Q.on(this._element,this.constructor.eventName(QE),this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[sn]=!(l._isShown()&&l._activeTrigger[sn]),l.toggle()});else if(s!==qE){const a=s===es?this.constructor.eventName(e2):this.constructor.eventName(JE),l=s===es?this.constructor.eventName(t2):this.constructor.eventName(ZE);Q.on(this._element,a,this._config.selector,c=>{const d=this._initializeOnDelegatedTarget(c);d._activeTrigger[c.type==="focusin"?tn:es]=!0,d._enter()}),Q.on(this._element,l,this._config.selector,c=>{const d=this._initializeOnDelegatedTarget(c);d._activeTrigger[c.type==="focusout"?tn:es]=d._element.contains(c.relatedTarget),d._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Q.on(this._element.closest(Co),Eo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=dt.getDataAttributes(this._element);for(const a of Object.keys(s))UE.has(a)&&delete s[a];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:vt(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,a]of Object.entries(this._config))this.constructor.Default[s]!==a&&(e[s]=a);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Qt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Xe(Qt);const a2="popover",i2=".popover-header",l2=".popover-body",r2={...Qt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},c2={...Qt.DefaultType,content:"(null|string|element|function)"};class In extends Qt{static get Default(){return r2}static get DefaultType(){return c2}static get NAME(){return a2}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[i2]:this._getTitle(),[l2]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=In.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Xe(In);const u2="scrollspy",d2="bs.scrollspy",Nn=`.${d2}`,f2=".data-api",m2=`activate${Nn}`,To=`click${Nn}`,p2=`load${Nn}${f2}`,v2="dropdown-item",Lt="active",h2='[data-bs-spy="scroll"]',nn="[href]",_2=".nav, .list-group",Ao=".nav-link",g2=".nav-item",b2=".list-group-item",y2=`${Ao}, ${g2} > ${Ao}, ${b2}`,w2=".dropdown",k2=".dropdown-toggle",$2={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},S2={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Ps extends Je{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return $2}static get DefaultType(){return S2}static get NAME(){return u2}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=vt(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Q.off(this._config.target,To),Q.on(this._config.target,To,nn,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const a=this._rootElement||window,l=s.offsetTop-this._element.offsetTop;if(a.scrollTo){a.scrollTo({top:l,behavior:"smooth"});return}a.scrollTop=l}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=d=>this._targetLinks.get(`#${d.target.id}`),a=d=>{this._previousScrollData.visibleEntryTop=d.target.offsetTop,this._process(s(d))},l=(this._rootElement||document.documentElement).scrollTop,c=l>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=l;for(const d of e){if(!d.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(d));continue}const g=d.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(c&&g){if(a(d),!l)return;continue}!c&&!g&&a(d)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=me.find(nn,this._config.target);for(const s of e){if(!s.hash||ht(s))continue;const a=me.findOne(decodeURI(s.hash),this._element);Xt(a)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,a))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Lt),this._activateParents(e),Q.trigger(this._element,m2,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(v2)){me.findOne(k2,e.closest(w2)).classList.add(Lt);return}for(const s of me.parents(e,_2))for(const a of me.prev(s,y2))a.classList.add(Lt)}_clearActiveClass(e){e.classList.remove(Lt);const s=me.find(`${nn}.${Lt}`,e);for(const a of s)a.classList.remove(Lt)}static jQueryInterface(e){return this.each(function(){const s=Ps.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(window,p2,()=>{for(const n of me.find(h2))Ps.getOrCreateInstance(n)});Xe(Ps);const x2="tab",C2="bs.tab",Dt=`.${C2}`,E2=`hide${Dt}`,T2=`hidden${Dt}`,A2=`show${Dt}`,D2=`shown${Dt}`,M2=`click${Dt}`,O2=`keydown${Dt}`,L2=`load${Dt}`,I2="ArrowLeft",Do="ArrowRight",N2="ArrowUp",Mo="ArrowDown",on="Home",Oo="End",St="active",Lo="fade",an="show",P2="dropdown",Ka=".dropdown-toggle",j2=".dropdown-menu",ln=`:not(${Ka})`,R2='.list-group, .nav, [role="tablist"]',B2=".nav-item, .list-group-item",F2=`.nav-link${ln}, .list-group-item${ln}, [role="tab"]${ln}`,Ga='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',rn=`${F2}, ${Ga}`,V2=`.${St}[data-bs-toggle="tab"], .${St}[data-bs-toggle="pill"], .${St}[data-bs-toggle="list"]`;class Ht extends Je{constructor(e){super(e),this._parent=this._element.closest(R2),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Q.on(this._element,O2,s=>this._keydown(s)))}static get NAME(){return x2}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),a=s?Q.trigger(s,E2,{relatedTarget:e}):null;Q.trigger(e,A2,{relatedTarget:s}).defaultPrevented||a&&a.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(St),this._activate(me.getElementFromSelector(e));const a=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(an);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Q.trigger(e,D2,{relatedTarget:s})};this._queueCallback(a,e,e.classList.contains(Lo))}_deactivate(e,s){if(!e)return;e.classList.remove(St),e.blur(),this._deactivate(me.getElementFromSelector(e));const a=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(an);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Q.trigger(e,T2,{relatedTarget:s})};this._queueCallback(a,e,e.classList.contains(Lo))}_keydown(e){if(![I2,Do,N2,Mo,on,Oo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(l=>!ht(l));let a;if([on,Oo].includes(e.key))a=s[e.key===on?0:s.length-1];else{const l=[Do,Mo].includes(e.key);a=Mn(s,e.target,l,!0)}a&&(a.focus({preventScroll:!0}),Ht.getOrCreateInstance(a).show())}_getChildren(){return me.find(rn,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const a of s)this._setInitialAttributesOnChild(a)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),a=this._getOuterElement(e);e.setAttribute("aria-selected",s),a!==e&&this._setAttributeIfNotExists(a,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=me.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const a=this._getOuterElement(e);if(!a.classList.contains(P2))return;const l=(c,d)=>{const g=me.findOne(c,a);g&&g.classList.toggle(d,s)};l(Ka,St),l(j2,an),a.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,a){e.hasAttribute(s)||e.setAttribute(s,a)}_elemIsActive(e){return e.classList.contains(St)}_getInnerElement(e){return e.matches(rn)?e:me.findOne(rn,e)}_getOuterElement(e){return e.closest(B2)||e}static jQueryInterface(e){return this.each(function(){const s=Ht.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(document,M2,Ga,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ht(this)&&Ht.getOrCreateInstance(this).show()});Q.on(window,L2,()=>{for(const n of me.find(V2))Ht.getOrCreateInstance(n)});Xe(Ht);const U2="toast",W2="bs.toast",wt=`.${W2}`,H2=`mouseover${wt}`,q2=`mouseout${wt}`,z2=`focusin${wt}`,K2=`focusout${wt}`,G2=`hide${wt}`,X2=`hidden${wt}`,Y2=`show${wt}`,Q2=`shown${wt}`,J2="fade",Io="hide",ws="show",ks="showing",Z2={animation:"boolean",autohide:"boolean",delay:"number"},eT={animation:!0,autohide:!0,delay:5e3};class js extends Je{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return eT}static get DefaultType(){return Z2}static get NAME(){return U2}show(){if(Q.trigger(this._element,Y2).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(J2);const s=()=>{this._element.classList.remove(ks),Q.trigger(this._element,Q2),this._maybeScheduleHide()};this._element.classList.remove(Io),us(this._element),this._element.classList.add(ws,ks),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||Q.trigger(this._element,G2).defaultPrevented)return;const s=()=>{this._element.classList.add(Io),this._element.classList.remove(ks,ws),Q.trigger(this._element,X2)};this._element.classList.add(ks),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ws),super.dispose()}isShown(){return this._element.classList.contains(ws)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const a=e.relatedTarget;this._element===a||this._element.contains(a)||this._maybeScheduleHide()}_setListeners(){Q.on(this._element,H2,e=>this._onInteraction(e,!0)),Q.on(this._element,q2,e=>this._onInteraction(e,!1)),Q.on(this._element,z2,e=>this._onInteraction(e,!0)),Q.on(this._element,K2,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=js.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Ls(js);Xe(js);const tT={class:"modal-dialog modal-lg"},sT={class:"modal-content"},nT={class:"modal-body"},oT={key:0,class:"text-center py-4"},aT={key:1,class:"alert alert-danger"},iT={key:2},lT={class:"mb-3"},rT={class:"small text-muted mb-2"},cT={key:0},uT={key:0,class:"alert alert-info"},dT={key:1},fT={class:"table table-sm table-striped"},mT={key:2,class:"mt-3"},pT={key:3,class:"mt-3"},vT={class:"modal-footer"},hT=["disabled"],_T={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const a=n,l=s,c=L(null);let d=null;const g=L(!1),u=L(""),f=L([]);fe(c,b=>{b&&(d=new Tt(b),b.addEventListener("hidden.bs.modal",()=>{l("close")}))});function h(){d&&(d.show(),m())}function S(){d&&d.hide()}async function m(){g.value=!0,u.value="",f.value=[];try{const b=await ve.post("/api/permissions/preview",{working_directory:a.workingDirectory,setting_sources:a.settingSources,session_allowed_tools:a.sessionAllowedTools});f.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),u.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{g.value=!1}}function p(){m()}function w(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:h,hide:S}),(b,v)=>(i(),r("div",{ref_key:"modalRef",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",tT,[t("div",sT,[v[9]||(v[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",nT,[g.value?(i(),r("div",oT,[...v[0]||(v[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):u.value?(i(),r("div",aT,x(u.value),1)):(i(),r("div",iT,[t("div",lT,[v[2]||(v[2]=t("h6",null,"Settings Sources",-1)),t("div",rT,[v[1]||(v[1]=ue(" Loading permissions from: ",-1)),(i(!0),r(ee,null,le(n.settingSources,(_,o)=>(i(),r("span",{key:_},[t("code",null,x(_),1),o<n.settingSources.length-1?(i(),r("span",cT,", ")):M("",!0)]))),128))])]),f.value.length===0?(i(),r("div",uT," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),r("div",dT,[t("h6",null,"Pre-approved Permissions ("+x(f.value.length)+")",1),t("table",fT,[v[3]||(v[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),r(ee,null,le(f.value,_=>(i(),r("tr",{key:_.permission},[t("td",null,[t("code",null,x(_.permission),1)]),t("td",null,[(i(!0),r(ee,null,le(_.sources,(o,y)=>(i(),r("span",{key:o,class:H(["badge me-1",w(o)])},x(o),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),r("div",mT,[v[4]||(v[4]=t("h6",null,"Session Allowed Tools",-1)),v[5]||(v[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),r(ee,null,le(n.sessionAllowedTools,_=>(i(),r("span",{key:_,class:"badge bg-success me-1 mb-1"},x(_),1))),128))])])):M("",!0),n.sessionDisallowedTools.length>0?(i(),r("div",pT,[v[6]||(v[6]=t("h6",null,"Session Disallowed Tools",-1)),v[7]||(v[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(i(!0),r(ee,null,le(n.sessionDisallowedTools,_=>(i(),r("span",{key:_,class:"badge bg-danger me-1 mb-1"},x(_),1))),128))])])):M("",!0)]))]),t("div",vT,[v[8]||(v[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:p,disabled:g.value}," Refresh ",8,hT)])])])],512))}},gT=te(_T,[["__scopeId","data-v-2078b366"]]),bT={class:"modal-dialog modal-lg modal-dialog-centered"},yT={class:"modal-content"},wT={class:"modal-header"},kT={id:"configurationModalLabel",class:"modal-title"},$T={class:"modal-body"},ST={key:0,class:"template-list-view"},xT={key:0,class:"alert alert-info"},CT={class:"card-body"},ET={class:"d-flex justify-content-between align-items-start"},TT={class:"flex-grow-1"},AT={class:"card-title mb-1"},DT={key:0,class:"card-text text-muted small mb-2"},MT={class:"template-meta"},OT={class:"badge bg-secondary me-2"},LT={class:"text-muted small"},IT={class:"btn-group btn-group-sm ms-3"},NT=["onClick"],PT=["onClick"],jT={key:1},RT={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},BT={class:"nav-item",role:"presentation"},FT={key:0,class:"error-indicator",title:"This tab has validation errors"},VT={class:"nav-item",role:"presentation"},UT={key:0,class:"error-indicator",title:"This tab has validation errors"},WT={class:"nav-item",role:"presentation"},HT={key:0,class:"error-indicator",title:"This tab has validation errors"},qT={class:"nav-item",role:"presentation"},zT={class:"tab-content"},KT={key:2,class:"alert alert-danger mt-3"},GT={key:0},XT={key:1},YT={class:"modal-footer"},QT={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},JT=["disabled"],ZT={key:0,class:"spinner-border spinner-border-sm me-2"},eA={__name:"ConfigurationModal",setup(n){const e=ls(),s=Ge(),a=_e(),l=Ce(),c=L(null);let d=null;const g=L(null),u=L("create-session"),f=L("general"),h=L(null),S=L(null),m=L(null),p=L([]),w=L(null),b=L(null),v=L({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),_=Fs({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),o=Fs({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,cli_path:"",docker_enabled:!1,docker_image:"",docker_extra_mounts:"",sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),y=Fs({name:""}),$=k(()=>({general:!!y.name,permissions:!1,advanced:!1})),E=L(!1),D=L(""),T=k(()=>u.value==="create-session"||u.value==="edit-session"),O=k(()=>u.value==="edit-session"||u.value==="edit-template"),C=k(()=>{switch(u.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),A=k(()=>E.value?O.value?"Saving...":"Creating...":O.value?"Save Changes":T.value?"Create Session":"Save Template"),N=k(()=>!(!o.name.trim()||T.value&&o.name.includes(" "))),P=k(()=>S.value?.state==="active"||S.value?.state==="starting"),F=k(()=>{if(!S.value)return!1;const B=(o.initialization_context||"")!==(S.value.system_prompt||""),ne=(o.override_system_prompt||!1)!==(S.value.override_system_prompt||!1),ie=(o.sandbox_enabled||!1)!==(S.value.sandbox_enabled||!1);if(B||ne||ie)return!0;if(o.sandbox_enabled){const ke=S.value.sandbox_config||{},ce=o.sandbox,xe=JSON.stringify({autoAllowBashIfSandboxed:ke.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:ke.allowUnsandboxedCommands??!1,excludedCommands:(ke.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:ke.enableWeakerNestedSandbox??!1,network:{allowedDomains:(ke.network?.allowedDomains||[]).join(", "),allowLocalBinding:ke.network?.allowLocalBinding??!1,allowUnixSockets:(ke.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:ke.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(ke.ignoreViolations?.file||[]).join(", "),network:(ke.ignoreViolations?.network||[]).join(", ")}}),Te=JSON.stringify({autoAllowBashIfSandboxed:ce.autoAllowBashIfSandboxed,allowUnsandboxedCommands:ce.allowUnsandboxedCommands,excludedCommands:ce.excludedCommands,enableWeakerNestedSandbox:ce.enableWeakerNestedSandbox,network:{allowedDomains:ce.network.allowedDomains,allowLocalBinding:ce.network.allowLocalBinding,allowUnixSockets:ce.network.allowUnixSockets,allowAllUnixSockets:ce.network.allowAllUnixSockets},ignoreViolations:{file:ce.ignoreViolations.file,network:ce.ignoreViolations.network}});if(xe!==Te)return!0}return!1}),V=k(()=>{if(!S.value)return!1;const B=(o.model||"sonnet")!==(S.value.model||"sonnet"),ne=(o.allowed_tools||"")!==(S.value.allowed_tools?.join(", ")||""),ie=S.value.setting_sources||["user","project","local"],ke=o.setting_sources||["user","project","local"],ce=JSON.stringify([...ie].sort())!==JSON.stringify([...ke].sort());return B||ne||ce}),X=k(()=>F.value?"reset":V.value?"restart":null),j=k(()=>u.value==="edit-session"&&P.value&&X.value!==null),I=k(()=>S.value?.working_directory?S.value.working_directory:o.working_directory?o.working_directory:s.projects.get(h.value)?.working_directory||""),G=k(()=>!o.allowed_tools||!o.allowed_tools.trim()?[]:o.allowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0)),q=k(()=>!o.disallowed_tools||!o.disallowed_tools.trim()?[]:o.disallowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0));function Z(){g.value&&g.value.show()}function K(){const B=ne=>ne.split(",").map(ie=>ie.trim()).filter(ie=>ie.length>0);return{autoAllowBashIfSandboxed:o.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:o.sandbox.allowUnsandboxedCommands,excludedCommands:B(o.sandbox.excludedCommands),enableWeakerNestedSandbox:o.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:B(o.sandbox.network.allowedDomains),allowLocalBinding:o.sandbox.network.allowLocalBinding,allowUnixSockets:B(o.sandbox.network.allowUnixSockets),allowAllUnixSockets:o.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:B(o.sandbox.ignoreViolations.file),network:B(o.sandbox.ignoreViolations.network)}}}function pe(B,ne){o[B]=ne,B==="name"&&(y.name="")}function re(B){w.value=B,be()}async function ge(){try{const B=await ve.get("/api/templates");p.value=B||[]}catch(B){console.error("Failed to load templates:",B),p.value=[]}}function be(){if(!w.value){o.default_role="",o.initialization_context="",o.permission_mode="default",o.allowed_tools="",o.disallowed_tools="",o.model="sonnet",o.capabilities="",o.override_system_prompt=!1,o.sandbox_enabled=!1,o.cli_path="",o.docker_enabled=!1,o.docker_image="",o.docker_extra_mounts="",o.sandbox.autoAllowBashIfSandboxed=!0,o.sandbox.allowUnsandboxedCommands=!1,o.sandbox.excludedCommands="",o.sandbox.enableWeakerNestedSandbox=!1,o.sandbox.network.allowedDomains="",o.sandbox.network.allowLocalBinding=!1,o.sandbox.network.allowUnixSockets="",o.sandbox.network.allowAllUnixSockets=!1,o.sandbox.ignoreViolations.file="",o.sandbox.ignoreViolations.network="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",_.disallowed_tools="normal",_.model="normal",_.capabilities="normal",_.sandbox_excludedCommands="normal",_.sandbox_network_allowedDomains="normal",_.sandbox_network_allowUnixSockets="normal",_.sandbox_ignoreViolations_file="normal",_.sandbox_ignoreViolations_network="normal",v.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const B=p.value.find(et=>et.template_id===w.value);if(!B)return;if(_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",_.disallowed_tools="normal",_.model="normal",_.capabilities="normal",_.sandbox_excludedCommands="normal",_.sandbox_network_allowedDomains="normal",_.sandbox_network_allowUnixSockets="normal",_.sandbox_ignoreViolations_file="normal",_.sandbox_ignoreViolations_network="normal",B.default_role?(o.default_role=B.default_role,v.value.default_role=B.default_role,_.default_role="autofilled"):(o.default_role="",v.value.default_role=null),B.default_system_prompt?(o.initialization_context=B.default_system_prompt,v.value.initialization_context=B.default_system_prompt,_.initialization_context="autofilled"):(o.initialization_context="",v.value.initialization_context=null),B.permission_mode?(o.permission_mode=B.permission_mode,v.value.permission_mode=B.permission_mode,_.permission_mode="autofilled"):(o.permission_mode="default",v.value.permission_mode=null),B.allowed_tools&&B.allowed_tools.length>0){const et=B.allowed_tools.join(", ");o.allowed_tools=et,v.value.allowed_tools=et,_.allowed_tools="autofilled"}else o.allowed_tools="",v.value.allowed_tools=null;if(B.disallowed_tools&&B.disallowed_tools.length>0){const et=B.disallowed_tools.join(", ");o.disallowed_tools=et,v.value.disallowed_tools=et,_.disallowed_tools="autofilled"}else o.disallowed_tools="",v.value.disallowed_tools=null;if(B.model?(o.model=B.model,v.value.model=B.model,_.model="autofilled"):(o.model="sonnet",v.value.model=null),B.capabilities&&B.capabilities.length>0){const et=B.capabilities.join(", ");o.capabilities=et,v.value.capabilities=et,_.capabilities="autofilled"}else o.capabilities="",v.value.capabilities=null;o.override_system_prompt=B.override_system_prompt||!1,o.sandbox_enabled=B.sandbox_enabled||!1,o.cli_path=B.cli_path||"",o.docker_enabled=B.docker_enabled||!1,o.docker_image=B.docker_image||"",o.docker_extra_mounts=(B.docker_extra_mounts||[]).join(`
`);const ne=B.sandbox_config||{};o.sandbox.autoAllowBashIfSandboxed=ne.autoAllowBashIfSandboxed??!0,o.sandbox.allowUnsandboxedCommands=ne.allowUnsandboxedCommands??!1,o.sandbox.enableWeakerNestedSandbox=ne.enableWeakerNestedSandbox??!1;const ie=ne.network||{};o.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,o.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const ke=(ne.excludedCommands||[]).join(", ");o.sandbox.excludedCommands=ke,v.value.sandbox_excludedCommands=ke||null,ke&&(_.sandbox_excludedCommands="autofilled");const ce=(ie.allowedDomains||[]).join(", ");o.sandbox.network.allowedDomains=ce,v.value.sandbox_network_allowedDomains=ce||null,ce&&(_.sandbox_network_allowedDomains="autofilled");const xe=(ie.allowUnixSockets||[]).join(", ");o.sandbox.network.allowUnixSockets=xe,v.value.sandbox_network_allowUnixSockets=xe||null,xe&&(_.sandbox_network_allowUnixSockets="autofilled");const Te=ne.ignoreViolations||{},Rs=(Te.file||[]).join(", ");o.sandbox.ignoreViolations.file=Rs,v.value.sandbox_ignoreViolations_file=Rs||null,Rs&&(_.sandbox_ignoreViolations_file="autofilled");const Bs=(Te.network||[]).join(", ");o.sandbox.ignoreViolations.network=Bs,v.value.sandbox_ignoreViolations_network=Bs||null,Bs&&(_.sandbox_ignoreViolations_network="autofilled")}function z(){const ne=(h.value?s.projects.get(h.value):null)?.working_directory||"";l.showModal("folder-browser",{defaultPath:ne,currentPath:o.working_directory||"",onSelect:ie=>{o.working_directory=ie}})}function R(){u.value==="create-session"&&(b.value={mode:"create-session",projectId:h.value,formData:{...o},selectedTemplateId:w.value}),u.value="template-list",we()}function U(){u.value="create-template",we(),f.value="general"}function se(B){u.value="edit-template",m.value=B,we(),rt(B),f.value="general"}async function Y(B){if(confirm(`Delete template "${B.name}"?

This action cannot be undone.`))try{await ve.delete(`/api/templates/${B.template_id}`),await ge()}catch(ne){console.error("Failed to delete template:",ne),D.value=ne.response?.data?.detail||"Failed to delete template"}}function oe(){let B=!0;return y.name="",o.name.trim()||(y.name="Name is required",B=!1),T.value&&o.name.includes(" ")&&(y.name="Session name must be a single word (no spaces)",B=!1),B}async function Se(){if(!oe()){y.name&&(f.value="general");return}E.value=!0,D.value="";try{switch(u.value){case"create-session":await lt(),d&&d.hide();break;case"edit-session":await J(),d&&d.hide();break;case"create-template":await de();break;case"edit-template":await ye();break}}catch(B){console.error("Submit failed:",B),D.value=B.response?.data?.detail||B.message||"Operation failed. Please try again."}finally{E.value=!1}}async function lt(){if(!h.value)throw new Error("Project ID is missing");const B=o.allowed_tools.split(",").map(xe=>xe.trim()).filter(xe=>xe.length>0),ne=o.disallowed_tools.split(",").map(xe=>xe.trim()).filter(xe=>xe.length>0),ie=o.capabilities.split(",").map(xe=>xe.trim()).filter(xe=>xe.length>0),ke={name:o.name.trim(),model:o.model||null,role:o.default_role.trim()||null,initialization_context:o.initialization_context.trim()||null,override_system_prompt:o.override_system_prompt,capabilities:ie.length>0?ie:null,permission_mode:o.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:ne.length>0?ne:null,working_directory:o.working_directory.trim()||null,sandbox_enabled:o.sandbox_enabled,sandbox_config:o.sandbox_enabled?K():null,setting_sources:o.setting_sources,cli_path:o.cli_path.trim()||null,docker_enabled:o.docker_enabled,docker_image:o.docker_image.trim()||null,docker_extra_mounts:o.docker_extra_mounts.trim()?o.docker_extra_mounts.trim().split(`
`).map(xe=>xe.trim()).filter(xe=>xe):null},ce=await ve.post(`/api/legions/${h.value}/minions`,ke);if(ce.success&&ce.minion_id)await s.fetchProjects(),await a.fetchSessions(),o.startImmediately&&await a.startSession(ce.minion_id),e.push(`/session/${ce.minion_id}`);else throw new Error("Failed to create session")}async function J(){if(!S.value)throw new Error("Session data is missing");const B=S.value.session_id,ne=S.value.state==="active"||S.value.state==="starting",ie=o.allowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ke=o.disallowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ce=o.capabilities.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),xe={name:o.name.trim(),model:o.model,role:o.default_role.trim()||null,system_prompt:o.initialization_context.trim()||null,override_system_prompt:o.override_system_prompt,allowed_tools:ie.length>0?ie:null,disallowed_tools:ke.length>0?ke:null,capabilities:ce.length>0?ce:null,sandbox_enabled:o.sandbox_enabled,sandbox_config:o.sandbox_enabled?K():null,setting_sources:o.setting_sources,cli_path:o.cli_path.trim(),docker_enabled:o.docker_enabled,docker_image:o.docker_image.trim()||null,docker_extra_mounts:o.docker_extra_mounts.trim()?o.docker_extra_mounts.trim().split(`
`).map(Te=>Te.trim()).filter(Te=>Te):null};await a.patchSession(B,xe),ne&&o.permission_mode!==S.value.current_permission_mode&&await a.setPermissionMode(B,o.permission_mode)}async function de(){const B=o.allowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ne=o.disallowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ie=o.capabilities.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ke={name:o.name.trim(),description:o.description.trim()||null,permission_mode:o.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:ne.length>0?ne:null,default_role:o.default_role.trim()||null,default_system_prompt:o.initialization_context.trim()||null,model:o.model||null,capabilities:ie.length>0?ie:null,override_system_prompt:o.override_system_prompt,sandbox_enabled:o.sandbox_enabled,sandbox_config:o.sandbox_enabled?K():null,cli_path:o.cli_path.trim()||null,docker_enabled:o.docker_enabled,docker_image:o.docker_image.trim()||null,docker_extra_mounts:o.docker_extra_mounts.trim()?o.docker_extra_mounts.trim().split(`
`).map(ce=>ce.trim()).filter(ce=>ce):null};await ve.post("/api/templates",ke),await ge(),u.value="template-list",we()}async function ye(){if(!m.value)throw new Error("Template data is missing");const B=o.allowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ne=o.disallowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ie=o.capabilities.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ke={name:o.name.trim(),description:o.description.trim()||null,permission_mode:o.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:ne.length>0?ne:null,default_role:o.default_role.trim()||null,default_system_prompt:o.initialization_context.trim()||null,model:o.model||null,capabilities:ie.length>0?ie:null,override_system_prompt:o.override_system_prompt,sandbox_enabled:o.sandbox_enabled,sandbox_config:o.sandbox_enabled?K():null,cli_path:o.cli_path.trim()||null,docker_enabled:o.docker_enabled,docker_image:o.docker_image.trim()||null,docker_extra_mounts:o.docker_extra_mounts.trim()?o.docker_extra_mounts.trim().split(`
`).map(ce=>ce.trim()).filter(ce=>ce):null};await ve.put(`/api/templates/${m.value.template_id}`,ke),await ge(),u.value="template-list",m.value=null,we()}function we(){o.name="",o.model="sonnet",o.permission_mode="default",o.working_directory="",o.description="",o.default_role="",o.startImmediately=!0,o.allowed_tools="",o.disallowed_tools="",o.capabilities="",o.setting_sources=["user","project","local"],o.system_prompt="",o.override_system_prompt=!1,o.initialization_context="",o.sandbox_enabled=!1,o.cli_path="",o.docker_enabled=!1,o.docker_image="",o.docker_extra_mounts="",o.sandbox.autoAllowBashIfSandboxed=!0,o.sandbox.allowUnsandboxedCommands=!1,o.sandbox.excludedCommands="",o.sandbox.enableWeakerNestedSandbox=!1,o.sandbox.network.allowedDomains="",o.sandbox.network.allowLocalBinding=!1,o.sandbox.network.allowUnixSockets="",o.sandbox.network.allowAllUnixSockets=!1,o.sandbox.ignoreViolations.file="",o.sandbox.ignoreViolations.network="",y.name="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",_.disallowed_tools="normal",_.model="normal",_.capabilities="normal",_.sandbox_excludedCommands="normal",_.sandbox_network_allowedDomains="normal",_.sandbox_network_allowUnixSockets="normal",_.sandbox_ignoreViolations_file="normal",_.sandbox_ignoreViolations_network="normal",v.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},w.value=null,D.value="",f.value="general"}function Ae(B){o.name=B.name||"",o.model=B.model||"sonnet",o.permission_mode=B.current_permission_mode||"default",o.working_directory=B.working_directory||"",o.default_role=B.role||"",o.initialization_context=B.system_prompt||"",o.override_system_prompt=B.override_system_prompt||!1,o.system_prompt="",o.allowed_tools=B.allowed_tools?.join(", ")||"",o.disallowed_tools=B.disallowed_tools?.join(", ")||"",o.capabilities=B.capabilities?.join(", ")||"",o.sandbox_enabled=B.sandbox_enabled||!1,o.cli_path=B.cli_path||"",o.docker_enabled=B.docker_enabled||!1,o.docker_image=B.docker_image||"",o.docker_extra_mounts=(B.docker_extra_mounts||[]).join(`
`),o.setting_sources=B.setting_sources||["user","project","local"];const ne=B.sandbox_config||{};o.sandbox.autoAllowBashIfSandboxed=ne.autoAllowBashIfSandboxed??!0,o.sandbox.allowUnsandboxedCommands=ne.allowUnsandboxedCommands??!1,o.sandbox.excludedCommands=(ne.excludedCommands||[]).join(", "),o.sandbox.enableWeakerNestedSandbox=ne.enableWeakerNestedSandbox??!1;const ie=ne.network||{};o.sandbox.network.allowedDomains=(ie.allowedDomains||[]).join(", "),o.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,o.sandbox.network.allowUnixSockets=(ie.allowUnixSockets||[]).join(", "),o.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const ke=ne.ignoreViolations||{};o.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),o.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function rt(B){o.name=B.name||"",o.description=B.description||"",o.permission_mode=B.permission_mode||"default",o.default_role=B.default_role||"",o.initialization_context=B.default_system_prompt||"",o.allowed_tools=B.allowed_tools?.join(", ")||"",o.disallowed_tools=B.disallowed_tools?.join(", ")||"",o.model=B.model||"sonnet",o.capabilities=B.capabilities?.join(", ")||"",o.override_system_prompt=B.override_system_prompt||!1,o.sandbox_enabled=B.sandbox_enabled||!1,o.cli_path=B.cli_path||"",o.docker_enabled=B.docker_enabled||!1,o.docker_image=B.docker_image||"",o.docker_extra_mounts=(B.docker_extra_mounts||[]).join(`
`);const ne=B.sandbox_config||{};o.sandbox.autoAllowBashIfSandboxed=ne.autoAllowBashIfSandboxed??!0,o.sandbox.allowUnsandboxedCommands=ne.allowUnsandboxedCommands??!1,o.sandbox.excludedCommands=(ne.excludedCommands||[]).join(", "),o.sandbox.enableWeakerNestedSandbox=ne.enableWeakerNestedSandbox??!1;const ie=ne.network||{};o.sandbox.network.allowedDomains=(ie.allowedDomains||[]).join(", "),o.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,o.sandbox.network.allowUnixSockets=(ie.allowUnixSockets||[]).join(", "),o.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const ke=ne.ignoreViolations||{};o.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),o.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function Ze(){Fe(()=>{const B=document.getElementById("config-name");B&&(B.focus(),O.value&&B.select())})}function kt(){we(),u.value="create-session",h.value=null,S.value=null,m.value=null,l.hideModal()}return fe(()=>l.currentModal,async(B,ne)=>{if(!(!B||!d)){if(B.name==="configuration"){const ie=B.data||{};u.value=ie.mode||"create-session",h.value=ie.project?.project_id||ie.projectId||null,S.value=ie.session||null,m.value=ie.template||null,we(),u.value==="create-session"&&await ge(),u.value==="edit-session"&&S.value?Ae(S.value):u.value==="edit-template"&&m.value&&rt(m.value),d.show()}else if(B.name==="create-minion"||B.name==="create-session"){const ie=B.data||{};u.value="create-session",h.value=ie.project?.project_id||null,S.value=null,m.value=null,we(),await ge(),d.show()}else if(B.name==="edit-session"){const ie=B.data||{};u.value="edit-session",S.value=ie.session||null,h.value=S.value?.project_id||null,m.value=null,we(),S.value&&Ae(S.value),d.show()}else B.name==="template-management"&&(u.value="template-list",we(),await ge(),d.show());ne?.name==="configuration"&&ne.data?.mode?.includes("template")&&B?.name==="configuration"&&u.value==="create-session"&&await ge()}}),fe(()=>o.default_role,B=>{v.value.default_role!==null&&(_.default_role=B===v.value.default_role?"autofilled":"modified")}),fe(()=>o.initialization_context,B=>{v.value.initialization_context!==null&&(_.initialization_context=B===v.value.initialization_context?"autofilled":"modified")}),fe(()=>o.permission_mode,B=>{v.value.permission_mode!==null&&(_.permission_mode=B===v.value.permission_mode?"autofilled":"modified")}),fe(()=>o.allowed_tools,B=>{v.value.allowed_tools!==null&&(_.allowed_tools=B===v.value.allowed_tools?"autofilled":"modified")}),fe(()=>o.disallowed_tools,B=>{v.value.disallowed_tools!==null&&(_.disallowed_tools=B===v.value.disallowed_tools?"autofilled":"modified")}),fe(()=>o.model,B=>{v.value.model!==null&&(_.model=B===v.value.model?"autofilled":"modified")}),fe(()=>o.capabilities,B=>{v.value.capabilities!==null&&(_.capabilities=B===v.value.capabilities?"autofilled":"modified")}),fe(()=>o.sandbox.excludedCommands,B=>{v.value.sandbox_excludedCommands!==null&&(_.sandbox_excludedCommands=B===v.value.sandbox_excludedCommands?"autofilled":"modified")}),fe(()=>o.sandbox.network.allowedDomains,B=>{v.value.sandbox_network_allowedDomains!==null&&(_.sandbox_network_allowedDomains=B===v.value.sandbox_network_allowedDomains?"autofilled":"modified")}),fe(()=>o.sandbox.network.allowUnixSockets,B=>{v.value.sandbox_network_allowUnixSockets!==null&&(_.sandbox_network_allowUnixSockets=B===v.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),fe(()=>o.sandbox.ignoreViolations.file,B=>{v.value.sandbox_ignoreViolations_file!==null&&(_.sandbox_ignoreViolations_file=B===v.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),fe(()=>o.sandbox.ignoreViolations.network,B=>{v.value.sandbox_ignoreViolations_network!==null&&(_.sandbox_ignoreViolations_network=B===v.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),Me(()=>{c.value&&Ie(()=>import("./modal-D6mKceGM.js").then(B=>B.m),__vite__mapDeps([0,1])).then(B=>{const ne=B.default;d=new ne(c.value),c.value.addEventListener("shown.bs.modal",Ze),c.value.addEventListener("hidden.bs.modal",kt)})}),Oe(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",Ze),c.value.removeEventListener("hidden.bs.modal",kt)),d&&d.dispose()}),(B,ne)=>(i(),r(ee,null,[t("div",{ref_key:"modalElement",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",bT,[t("div",yT,[t("div",wT,[t("h5",kT,[u.value==="create-template"||u.value==="edit-template"?(i(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:R,title:"Back to template list"}," â† ")):M("",!0),ue(" "+x(C.value),1)]),ne[4]||(ne[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",$T,[u.value==="template-list"?(i(),r("div",ST,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[ne[5]||(ne[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:U,class:"btn btn-primary btn-sm"}," + Create New ")]),p.value.length===0?(i(),r("div",xT," No templates found. Create your first template! ")):M("",!0),(i(!0),r(ee,null,le(p.value,ie=>(i(),r("div",{key:ie.template_id,class:"card mb-2"},[t("div",CT,[t("div",ET,[t("div",TT,[t("h6",AT,x(ie.name),1),ie.description?(i(),r("p",DT,x(ie.description),1)):M("",!0),t("div",MT,[t("span",OT,x(ie.permission_mode),1),t("span",LT,x(ie.allowed_tools?.length||0)+" tools",1)])]),t("div",IT,[t("button",{onClick:ke=>se(ie),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,NT),t("button",{onClick:ke=>Y(ie),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,PT)])])])]))),128))])):(i(),r("div",jT,[t("ul",RT,[t("li",BT,[t("button",{class:H(["nav-link",{active:f.value==="general","has-error":$.value.general}]),type:"button",onClick:ne[0]||(ne[0]=ie=>f.value="general")},[ne[6]||(ne[6]=ue(" General ",-1)),$.value.general?(i(),r("span",FT)):M("",!0)],2)]),t("li",VT,[t("button",{class:H(["nav-link",{active:f.value==="permissions","has-error":$.value.permissions}]),type:"button",onClick:ne[1]||(ne[1]=ie=>f.value="permissions")},[ne[7]||(ne[7]=ue(" Permissions ",-1)),$.value.permissions?(i(),r("span",UT)):M("",!0)],2)]),t("li",WT,[t("button",{class:H(["nav-link",{active:f.value==="advanced","has-error":$.value.advanced}]),type:"button",onClick:ne[2]||(ne[2]=ie=>f.value="advanced")},[ne[8]||(ne[8]=ue(" Advanced ",-1)),$.value.advanced?(i(),r("span",HT)):M("",!0)],2)]),t("li",qT,[t("button",{class:H(["nav-link",{active:f.value==="sandbox"}]),type:"button",onClick:ne[3]||(ne[3]=ie=>f.value="sandbox")}," Sandbox ",2)])]),t("div",zT,[$e(he(mk,{mode:u.value,"form-data":o,errors:y,templates:p.value,"selected-template-id":w.value,session:S.value,"field-states":_,"onUpdate:formData":pe,"onUpdate:selectedTemplateId":re,onOpenFolderBrowser:z,onOpenTemplateManager:R},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[tt,f.value==="general"]]),$e(he(Zk,{mode:u.value,"form-data":o,errors:y,session:S.value,"field-states":_,"onUpdate:formData":pe,onPreviewPermissions:Z},null,8,["mode","form-data","errors","session","field-states"]),[[tt,f.value==="permissions"]]),$e(he(L$,{mode:u.value,"form-data":o,errors:y,session:S.value,"field-states":_,"onUpdate:formData":pe},null,8,["mode","form-data","errors","session","field-states"]),[[tt,f.value==="advanced"]]),$e(he(oS,{mode:u.value,"form-data":o,errors:y,session:S.value,"field-states":_,"onUpdate:formData":pe},null,8,["mode","form-data","errors","session","field-states"]),[[tt,f.value==="sandbox"]])])])),D.value?(i(),r("div",KT,x(D.value),1)):M("",!0)]),j.value?(i(),r("div",{key:0,class:H(["warning-banner","warning-banner-"+X.value])},[X.value==="reset"?(i(),r("small",GT,[...ne[9]||(ne[9]=[ue(" Changes require a ",-1),t("strong",null,"reset",-1),ue(" to take effect. This starts a new conversation. ",-1)])])):(i(),r("small",XT,[...ne[10]||(ne[10]=[ue(" Changes require a ",-1),t("strong",null,"restart",-1),ue(" to take effect. ",-1)])]))],2)):M("",!0),t("div",YT,[t("button",QT,x(u.value==="template-list"?"Close":"Cancel"),1),u.value!=="template-list"?(i(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:E.value||!N.value,onClick:Se},[E.value?(i(),r("span",ZT)):M("",!0),ue(" "+x(A.value),1)],8,JT)):M("",!0)])])])],512),he(gT,{ref_key:"permissionPreviewModal",ref:g,"working-directory":I.value,"setting-sources":o.setting_sources,"session-allowed-tools":G.value,"session-disallowed-tools":q.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},tA=te(eA,[["__scopeId","data-v-0c4c0d5c"]]),sA={class:"modal-dialog modal-dialog-centered"},nA={class:"modal-content"},oA={class:"modal-header"},aA={class:"modal-title",id:"manageSessionModalLabel"},iA={class:"modal-body"},lA={key:0,class:"text-center py-4"},rA={class:"text-muted"},cA={key:1},uA={key:2},dA={class:"text-muted"},fA={key:0,class:"text-center py-2"},mA={key:1,class:"alert alert-warning mt-3"},pA={class:"mb-0 mt-2"},vA={key:0,class:"text-muted"},hA={key:3},_A={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},gA={class:"d-grid gap-2"},bA=["disabled"],yA=["disabled"],wA=["disabled"],kA=["disabled"],$A={class:"modal-footer"},SA={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},xA={__name:"SessionManageModal",setup(n){const e=ls(),s=_e(),a=Ce(),l=it();Ne();const c=L(null),d=L(!1),g=L(""),u=L(""),f=L(null),h=L(null);let S=null;const m=L([]),p=L(!1),w=k(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function b(){f.value="reset"}async function v(){if(f.value="delete",m.value=[],!!c.value){p.value=!0;try{const C=await ve.get(`/api/sessions/${c.value.session_id}/descendants`);m.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),m.value=[]}finally{p.value=!1}}}function _(){f.value=null}async function o(){f.value==="reset"?await E():f.value==="delete"&&await D()}async function y(){if(c.value){d.value=!0,g.value="Restarting session...";try{const C=c.value.session_id,A=s.currentSessionId===C,N=await ve.post(`/api/sessions/${C}/restart`);if(N.success)console.log("Session restarted successfully"),A&&(await l.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),S&&S.hide();else{const P=N.error||N.detail||"Failed to restart session";console.error("Failed to restart session:",P),u.value=`Failed to restart session: ${P}`}}catch(C){console.error("Error restarting session:",C);const A=C.data?.detail||C.message||"Unknown error";u.value=`Error restarting session: ${A}`}finally{d.value=!1}}}async function $(){if(c.value)try{S&&S.hide(),console.log("Ending session",c.value.session_id);const C=c.value.session_id;await ve.post(`/api/sessions/${C}/terminate`),s.currentSessionId===C&&(await l.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),s.currentSessionId===c.value?.session_id&&(await l.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function E(){if(c.value){d.value=!0,g.value="Resetting session...";try{const C=c.value.session_id,A=s.currentSessionId===C,N=await ve.post(`/api/sessions/${C}/reset`);if(N.success)console.log("Session reset successfully"),A&&(await l.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),S&&S.hide();else{const P=N.error||N.detail||"Failed to reset session";console.error("Failed to reset session:",P),u.value=`Failed to reset session: ${P}`,f.value=null}}catch(C){console.error("Error resetting session:",C);const A=C.data?.detail||C.message||"Unknown error";u.value=`Error resetting session: ${A}`,f.value=null}finally{d.value=!1}}}async function D(){if(c.value){d.value=!0,g.value="Deleting session...";try{const C=c.value.session_id;await s.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),S&&S.hide()}catch(C){console.error("Error deleting session:",C);const A=C.data?.detail||C.message||"Unknown error";u.value=`Error deleting session: ${A}`,f.value=null}finally{d.value=!1}}}function T(){f.value=null,d.value=!1,g.value="",u.value="",m.value=[],p.value=!1}function O(){T(),c.value=null,a.hideModal()}return fe(()=>a.currentModal,C=>{if(C?.name==="manage-session"&&S){const A=C.data||{};c.value=A.session,T(),S.show()}}),Me(()=>{h.value&&Ie(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(A=>A.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{S=new C(h.value),h.value.addEventListener("hidden.bs.modal",O)})}),Oe(()=>{h.value&&h.value.removeEventListener("hidden.bs.modal",O),S&&S.dispose()}),(C,A)=>(i(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[t("div",sA,[t("div",nA,[t("div",oA,[t("h5",aA,x(f.value?w.value:"Manage Session"),1),A[1]||(A[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",iA,[d.value?(i(),r("div",lA,[A[2]||(A[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",rA,x(g.value),1)])):f.value==="reset"?(i(),r("div",cA,[...A[3]||(A[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(i(),r("div",uA,[A[9]||(A[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",dA,[A[4]||(A[4]=ue("This will permanently delete session ",-1)),t("strong",null,x(c.value?.name),1),A[5]||(A[5]=ue(".",-1))]),A[10]||(A[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),p.value?(i(),r("div",fA,[...A[6]||(A[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):m.value.length>0?(i(),r("div",mA,[A[7]||(A[7]=t("strong",null,"Cascading Deletion:",-1)),A[8]||(A[8]=ue(" This session has ",-1)),t("strong",null,x(m.value.length),1),ue(" child session"+x(m.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",pA,[(i(!0),r(ee,null,le(m.value,N=>(i(),r("li",{key:N.session_id,class:"small"},[t("strong",null,x(N.name||N.session_id),1),N.role?(i(),r("span",vA," ("+x(N.role)+")",1)):M("",!0)]))),128))])])):M("",!0)])):(i(),r("div",hA,[u.value?(i(),r("div",_A,[A[11]||(A[11]=t("strong",null,"Error:",-1)),ue(" "+x(u.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:A[0]||(A[0]=N=>u.value="")})])):M("",!0),A[18]||(A[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",gA,[t("button",{class:"btn btn-outline-primary text-start",onClick:y,disabled:d.value},[...A[12]||(A[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,bA),t("button",{class:"btn btn-outline-secondary text-start",onClick:$,disabled:d.value},[...A[13]||(A[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,yA),A[16]||(A[16]=t("hr",{class:"my-2"},null,-1)),A[17]||(A[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:d.value},[...A[14]||(A[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,wA),t("button",{class:"btn btn-outline-danger text-start",onClick:v,disabled:d.value},[...A[15]||(A[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,kA)]),A[19]||(A[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ue(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",$A,[f.value&&!d.value?(i(),r(ee,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),t("button",{type:"button",class:H(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:o},x(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):d.value?M("",!0):(i(),r("button",SA,"Cancel"))])])])],512))}},CA=te(xA,[["__scopeId","data-v-6b832853"]]),EA={class:"modal-dialog modal-dialog-centered modal-lg"},TA={class:"modal-content"},AA={class:"modal-body"},DA={key:0,class:"text-center text-muted py-4"},MA={key:1},OA={class:"mb-3"},LA={class:"font-monospace small"},IA={class:"mb-3"},NA=["value"],PA={class:"mb-3"},jA={class:"mb-3"},RA={class:"mb-3"},BA={key:0},FA={class:"d-flex flex-wrap gap-1"},VA={key:1,class:"text-muted small"},UA={key:0,class:"mb-3"},WA={class:"d-flex flex-wrap gap-1"},HA={key:1,class:"mb-3"},qA={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},zA={class:"mb-3"},KA={class:"text-muted"},GA={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},XA={__name:"SessionInfoModal",setup(n){const e=_e(),s=Ne(),a=Ce(),l=L(null),c=L(!1),d=L(null);let g=null;const u={sonnet:"Sonnet",opus:"Opus",haiku:"Haiku",opusplan:"OpusPlan (Opus + Sonnet)"},f=k(()=>{if(!l.value)return null;const b=e.initData.get(l.value);return b||(s.messagesBySession.get(l.value)||[]).find(o=>o.type==="system"&&(o.subtype==="init"||o.metadata?.subtype==="init")&&o.metadata?.init_data)?.metadata?.init_data||null});function h(b){return b?u[b]||b:"Default (Sonnet)"}function S(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function m(b){b.target.select()}function p(){l.value=null,c.value=!1}function w(){p(),a.hideModal()}return fe(()=>a.currentModal,b=>{if(b?.name==="session-info"&&g){const v=b.data||{};l.value=v.sessionId,c.value=!1,g.show()}}),Me(()=>{d.value&&Ie(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(v=>v.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{g=new b(d.value),d.value.addEventListener("hidden.bs.modal",w)})}),Oe(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",w),g&&g.dispose()}),(b,v)=>(i(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",EA,[t("div",TA,[v[9]||(v[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",AA,[f.value?(i(),r("div",MA,[t("div",OA,[v[1]||(v[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",LA,x(l.value),1)]),t("div",IA,[v[2]||(v[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:m},null,8,NA)]),t("div",PA,[v[3]||(v[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,x(h(f.value.model)),1)]),t("div",jA,[v[4]||(v[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,x(f.value.permissionMode||"default"),1)]),t("div",RA,[v[5]||(v[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(i(),r("div",BA,[t("div",FA,[(i(!0),r(ee,null,le(f.value.allowed_tools||f.value.tools,_=>(i(),r("span",{key:_,class:"badge bg-secondary"},x(_),1))),128))])])):(i(),r("div",VA,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(i(),r("div",UA,[v[6]||(v[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",WA,[(i(!0),r(ee,null,le(f.value.commands,_=>(i(),r("span",{key:_,class:"badge bg-info"},x(_),1))),128))])])):M("",!0),f.value.systemPrompt?(i(),r("div",HA,[v[7]||(v[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",qA,x(S(f.value.systemPrompt)),1)])):M("",!0),t("div",zA,[t("h6",KA,[v[8]||(v[8]=ue(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:v[0]||(v[0]=_=>c.value=!c.value)},x(c.value?"Hide":"Show"),1)]),c.value?(i(),r("pre",GA,x(JSON.stringify(f.value,null,2)),1)):M("",!0)])])):(i(),r("div",DA," No session configuration data available "))]),v[10]||(v[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},YA=te(XA,[["__scopeId","data-v-4b480291"]]),QA={class:"modal-dialog modal-dialog-centered modal-lg"},JA={class:"modal-content"},ZA={class:"modal-body"},eD={key:0,class:"text-center text-muted py-4"},tD={key:1},sD={class:"mb-3"},nD={class:"mb-3"},oD={class:"font-monospace small"},aD={class:"mb-3"},iD={class:"mb-3"},lD={class:"mb-3"},rD={key:0},cD={class:"d-flex flex-wrap gap-1"},uD={key:1,class:"text-muted small"},dD={class:"mb-3"},fD={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},mD={key:1,class:"text-muted small"},pD={class:"mb-3"},vD={key:0,class:"badge bg-info"},hD={key:1,class:"badge bg-secondary"},_D={class:"mb-3"},gD={key:0,class:"font-monospace small"},bD={key:1,class:"text-muted small"},yD={key:0,class:"mb-3"},wD={key:0},kD={class:"list-unstyled mb-0"},$D={key:1,class:"text-muted small"},SD={class:"mb-3"},xD={class:"small"},CD={class:"mb-3"},ED={class:"small"},TD={__name:"MinionViewModal",setup(n){const e=Ce(),s=L(null),a=L(null);let l=null;function c(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function d(f){if(!f)return"N/A";try{const h=new Date(f);return isNaN(h.getTime())?"Invalid date":h.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(h){return console.error("Error formatting timestamp:",h),"Invalid date"}}function g(){s.value=null}function u(){g(),e.hideModal()}return fe(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&l){const h=f.data||{};s.value=h.session,l.show()}}),Me(()=>{a.value&&Ie(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{l=new f(a.value),a.value.addEventListener("hidden.bs.modal",u)})}),Oe(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",u),l&&l.dispose()}),(f,h)=>(i(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:a},[t("div",QA,[t("div",JA,[h[11]||(h[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ZA,[s.value?(i(),r("div",tD,[t("div",sD,[h[0]||(h[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,x(s.value.name||"Unnamed Minion"),1)]),t("div",nD,[h[1]||(h[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",oD,x(s.value.session_id),1)]),t("div",aD,[h[2]||(h[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,x(s.value.role||"Not specified"),1)]),t("div",iD,[h[3]||(h[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:H(["badge",c(s.value.state)])},x(s.value.state),3)])]),t("div",lD,[h[4]||(h[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),r("div",rD,[t("div",cD,[(i(!0),r(ee,null,le(s.value.capabilities,S=>(i(),r("span",{key:S,class:"badge bg-secondary"},x(S),1))),128))])])):(i(),r("div",uD,"None"))]),t("div",dD,[h[5]||(h[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),r("div",fD,x(s.value.initialization_context),1)):(i(),r("div",mD,"Not specified"))]),t("div",pD,[h[6]||(h[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),r("span",vD,"Yes")):(i(),r("span",hD,"No"))])]),t("div",_D,[h[7]||(h[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),r("div",gD,x(s.value.parent_overseer_id),1)):(i(),r("div",bD," Root overseer (user-created) "))]),s.value.is_overseer?(i(),r("div",yD,[h[8]||(h[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),r("div",wD,[t("ul",kD,[(i(!0),r(ee,null,le(s.value.child_minion_ids,S=>(i(),r("li",{key:S,class:"font-monospace small"},x(S),1))),128))])])):(i(),r("div",$D,"No children"))])):M("",!0),t("div",SD,[h[9]||(h[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",xD,x(d(s.value.created_at)),1)]),t("div",CD,[h[10]||(h[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",ED,x(d(s.value.updated_at)),1)])])):(i(),r("div",eD," No minion data available "))]),h[12]||(h[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},AD=te(TD,[["__scopeId","data-v-d996dc6f"]]),DD={class:"modal-dialog modal-dialog-centered"},MD={class:"modal-content"},OD={class:"modal-header"},LD={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},ID={class:"modal-body"},ND={key:0},PD={key:0,class:"text-center py-3"},jD={key:1,class:"card bg-light mb-3"},RD={class:"card-body py-2 px-3"},BD={class:"small"},FD={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},VD={key:0,class:"text-warning mt-1"},UD={key:2,class:"alert alert-warning py-2 small"},WD={key:1,class:"text-center py-3"},HD={key:0,class:"mb-3"},qD={key:1,class:"mb-3"},zD={key:2,class:"mb-3"},KD={class:"text-muted small mt-1"},GD={key:3,class:"mb-3"},XD={class:"mt-2 text-danger"},YD={class:"modal-footer"},QD=["disabled"],JD={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},ZD={__name:"RestartModal",setup(n){const e=Ce(),s=L(null);let a=null;const l=L("confirm"),c=L(!1),d=L(null),g=L(null),u=L(""),f=L(60);let h=null,S=null;async function m(){c.value=!0,g.value=null;try{d.value=await ci()}catch(o){g.value=o.message||"Unknown error"}finally{c.value=!1}}async function p(){l.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await ui(),e.restartStatus="restarting",w()}catch(o){e.restartStatus="error",u.value=o.message||"Restart failed",e.restartInProgress=!1}}function w(){e.restartStatus="reconnecting",f.value=60;const o=Date.now();S=setInterval(()=>{const y=Math.floor((Date.now()-o)/1e3);f.value=Math.max(0,60-y)},1e3),setTimeout(()=>{h=setInterval(async()=>{try{(await fetch("/health")).ok&&(b(),e.restartInProgress=!1,e.restartStatus="idle",a&&a.hide(),window.location.reload())}catch{}Date.now()-o>6e4&&(b(),e.restartStatus="error",u.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function b(){h&&(clearInterval(h),h=null),S&&(clearInterval(S),S=null)}function v(){l.value="confirm",d.value=null,g.value=null,u.value="",f.value=60,b()}function _(){e.restartInProgress||(v(),e.restartStatus="idle"),e.hideModal()}return fe(()=>e.currentModal,o=>{o?.name==="restart-server"&&a&&(v(),a.show(),m())}),Me(()=>{s.value&&Ie(async()=>{const{default:o}=await import("./modal-D6mKceGM.js").then(y=>y.m);return{default:o}},__vite__mapDeps([0,1])).then(({default:o})=>{a=new o(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",_)})}),Oe(()=>{b(),s.value&&s.value.removeEventListener("hidden.bs.modal",_),a&&a.dispose()}),(o,y)=>(i(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",DD,[t("div",MD,[t("div",OD,[y[0]||(y[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),l.value==="confirm"?(i(),r("button",LD)):M("",!0)]),t("div",ID,[l.value==="confirm"?(i(),r("div",ND,[y[5]||(y[5]=t("p",null,"This will pull the latest code, sync dependencies, and restart the backend server. All active sessions will be interrupted.",-1)),c.value?(i(),r("div",PD,[...y[1]||(y[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):d.value?(i(),r("div",jD,[t("div",RD,[t("div",BD,[t("div",null,[y[2]||(y[2]=t("strong",null,"Branch:",-1)),ue(" "+x(d.value.branch),1)]),t("div",null,[y[3]||(y[3]=t("strong",null,"Last commit:",-1)),ue(" "+x(d.value.last_commit_message),1)]),t("div",FD,x(d.value.last_commit_hash?.substring(0,12)),1),d.value.has_uncommitted_changes?(i(),r("div",VD,[...y[4]||(y[4]=[t("strong",null,"Warning:",-1),ue(" Uncommitted changes detected. git pull may fail. ",-1)])])):M("",!0)])])])):g.value?(i(),r("div",UD," Could not fetch git status: "+x(g.value),1)):M("",!0)])):l.value==="progress"?(i(),r("div",WD,[W(e).restartStatus==="pulling"?(i(),r("div",HD,[...y[6]||(y[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling code & syncing dependencies...",-1)])])):W(e).restartStatus==="restarting"?(i(),r("div",qD,[...y[7]||(y[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):W(e).restartStatus==="reconnecting"?(i(),r("div",zD,[y[8]||(y[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),y[9]||(y[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",KD,x(f.value)+"s remaining",1)])):W(e).restartStatus==="error"?(i(),r("div",GD,[y[10]||(y[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",XD,x(u.value),1)])):M("",!0)])):M("",!0)]),t("div",YD,[l.value==="confirm"?(i(),r(ee,{key:0},[y[11]||(y[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:p,disabled:c.value}," Pull & Restart ",8,QD)],64)):W(e).restartStatus==="error"?(i(),r("button",JD,"Close")):M("",!0)])])])],512))}},eM={class:"app-shell"},tM={class:"main-layout"},sM={class:"center-panel"},nM={__name:"App",setup(n){const e=Ce(),s=it(),a=_e(),l=Ge(),c=as(),d=st(),g=ls(),u=L(null);function f(p){u.value=p}jn("addAttachmentFromResource",f),jn("pendingResourceAttachment",u);const h=k(()=>e.rightPanelVisible),S=k(()=>e.windowWidth<768);fe(()=>c.currentHasTasks,(p,w)=>{p&&!w&&!e.suppressAutoShow&&(e.setRightSidebarTab("tasks"),e.setRightPanelVisible(!0))}),fe(()=>d.currentHasResources,(p,w)=>{p&&!w&&!e.suppressAutoShow&&(e.setRightSidebarTab("resources"),e.setRightPanelVisible(!0))}),Me(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([l.fetchProjects(),a.fetchSessions()]);const p=window.location.hash;if(p.startsWith("#/session/")){const w=p.replace("#/session/","");a.sessions.has(w)&&await a.selectSession(w)}else if(p.startsWith("#/timeline/")){const w=p.replace("#/timeline/","");g.push(`/timeline/${w}`)}window.addEventListener("popstate",m),window.addEventListener("resize",e.handleResize)}),Oe(()=>{window.removeEventListener("popstate",m),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function m(){const p=window.location.hash;if(p.startsWith("#/session/")){const w=p.replace("#/session/","");a.sessions.has(w)&&a.selectSession(w)}}return(p,w)=>{const b=gn("router-view");return i(),r("div",eM,[he(g_),he(E_),he(G_),t("div",{id:"right-panel-backdrop",class:H({show:h.value&&S.value}),onClick:w[0]||(w[0]=v=>W(e).setRightPanelVisible(!1))},null,2),t("div",tM,[t("main",sM,[he(b)]),$e(he(Sw,{class:H({"panel-overlay":S.value,"panel-visible":h.value})},null,8,["class"]),[[tt,h.value||S.value]])]),he(Vw),he(n0),he(x0),he(tA),he(CA),he(YA),he(AD),he(ZD)])}}},Pn=Za(nM);Pn.use(ei());Pn.use(m_);Pn.mount("#app");
