const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as s,o as a,d as st,r as R,b as _,t as y,n as se,u as $e,e as ze,f as ie,w as fe,g as bs,F as re,h as ce,i as A,j as ge,v as We,k as be,l as po,m as pe,p as qe,q as ve,s as kt,x as ye,y as Si,z as fo,A as Ee,B as _n,C as vo,D as Ft,E as Ei,G as Ci,H as ho,T as Ti,I as xi,J as Ai,K as Mi,L as ys,M as ws,N as gn,O as Oi,P as Di}from"./vue-vendor-P3Jw5Y9s.js";import{m as dt,p as cs}from"./markdown-vendor-BRsjnVvP.js";import{c as Ni}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const Li={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ii={__name:"NoSessionSelected",setup(n){return(e,t)=>(a(),l("div",Li,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},ji="modulepreload",Pi=function(n){return"/"+n},bn={},xe=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let p=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=c?.nonce||c?.getAttribute("nonce");i=p(t.map(d=>{if(d=Pi(d),d in bn)return;bn[d]=!0;const u=d.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${w}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":ji,u||(g.as="script"),g.crossOrigin="",g.href=d,f&&g.setAttribute("nonce",f),document.head.appendChild(g),u)return new Promise((k,$)=>{g.addEventListener("load",k),g.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${d}`)))})}))}function r(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return i.then(c=>{for(const f of c||[])f.status==="rejected"&&r(f.reason);return e().catch(r)})};class $s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function St(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new $s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof $s?t:(console.error("API request failed:",t),new $s(`Network error: ${t.message}`,0,null))}}async function _o(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[f,p]of Object.entries(e.params))p!=null&&o.append(f,p);const i=o.toString();i&&(t=`${n}?${i}`);const{params:r,...c}=e;return St(t,{...c,method:"GET"})}return St(t,{...e,method:"GET"})}async function Ri(n,e,t={}){return St(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Wi(n,e,t={}){return St(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Bi(n,e={}){return St(n,{...e,method:"DELETE"})}async function Fi(n,e,t={}){return St(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const me={get:_o,post:Ri,put:Wi,delete:Bi,patch:Fi},de=st("session",()=>{const n=R(new Map),e=R(null),t=R(new Map),o=R(new Map),i=R(new Set),r=R(!1);let c=null;const f=_(()=>n.value.get(e.value)),p=_(()=>Array.from(n.value.values()).sort((M,V)=>M.order-V.order)),d=M=>_(()=>p.value.filter(V=>V.project_id===M)),u=_({get:()=>t.value.get(e.value)||"",set:M=>{e.value&&t.value.set(e.value,M)}});async function w(){try{const M=await me.get("/api/sessions");return n.value.clear(),M.sessions.forEach(V=>{n.value.set(V.session_id,V)}),console.log(`Loaded ${n.value.size} sessions`),M.sessions}catch(M){throw console.error("Failed to fetch sessions:",M),M}}async function g(M,V){try{const x=(await me.post("/api/sessions",{project_id:M,...V})).session_id,G=(await me.get(`/api/sessions/${x}`)).session;return n.value.set(x,G),n.value=new Map(n.value),console.log(`Created session ${x}`),G}catch(C){throw console.error("Failed to create session:",C),C}}async function k(M){if(e.value===M&&!r.value)return;c&&(console.log(`Aborting pending selection to switch to ${M}`),c.abort(),c=null);const V=new AbortController;c=V,r.value=!0;try{if(e.value=M,V.signal.aborted){console.log(`Selection of ${M} aborted early`);return}let C=n.value.get(M);if(!C)try{const L=await me.get(`/api/sessions/${M}`);if(V.signal.aborted){console.log(`Selection of ${M} aborted after fetch`);return}C=L.session,n.value.set(M,C),n.value=new Map(n.value),console.log(`Fetched session ${M} for deeplink`)}catch(L){console.error(`Failed to fetch session ${M}:`,L);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await v(M),V.signal.aborted){console.log(`Selection of ${M} aborted after start`);return}console.log(`Auto-started session ${M} (was in ${C.state} state)`);const L=6e4,F=200,q=5e3;let Z=0,O=0;for(;Z<L;){if(V.signal.aborted){console.log(`Selection of ${M} aborted during state wait`);return}const D=n.value.get(M);if(D&&D.state==="active"){console.log(`Session ${M} is now active after ${Z}ms`);break}if(Z-O>=q){const S=n.value.get(M)?.state||"unknown";console.log(`Waiting for session ${M} to become active (current: ${S}, ${Z/1e3}s elapsed)`),O=Z}await new Promise(S=>setTimeout(S,F)),Z+=F}const N=n.value.get(M);N&&N.state!=="active"&&console.warn(`Session ${M} did not become active within ${L/1e3}s (state: ${N.state}), continuing anyway`)}catch(L){console.error(`Failed to auto-start session ${M}:`,L)}if(V.signal.aborted){console.log(`Selection of ${M} aborted before message load`);return}if(await(await xe(()=>Promise.resolve().then(()=>ia),void 0)).useMessageStore().loadMessages(M),V.signal.aborted){console.log(`Selection of ${M} aborted after message load`);return}if(await(await xe(()=>Promise.resolve().then(()=>Ta),void 0)).useResourceStore().loadResources(M),V.signal.aborted){console.log(`Selection of ${M} aborted after resource load`);return}await(await xe(()=>Promise.resolve().then(()=>xa),void 0)).useWebSocketStore().connectSession(M),V.signal.aborted||console.log(`Selected session ${M}`)}finally{c===V&&(c=null),r.value=!1}}function $(M,V){const C=n.value.get(M);C?Object.assign(C,V):(n.value.set(M,V),console.log(`Added new session ${M} via WebSocket update`)),n.value=new Map(n.value)}async function b(M){i.value.add(M);try{const C=(await me.delete(`/api/sessions/${M}`)).deleted_session_ids||[M];for(const x of C)n.value.delete(x),t.value.delete(x),o.value.delete(x);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(V){throw console.error("Failed to delete session:",V),V}finally{i.value.delete(M)}}async function m(M,V){try{await me.patch(`/api/sessions/${M}`,V),$(M,V),console.log(`Updated session ${M}:`,V)}catch(C){throw console.error("Failed to update session:",C),C}}async function h(M,V){try{await me.post(`/api/sessions/${M}/permission-mode`,{mode:V}),$(M,{current_permission_mode:V});const C=o.value.get(M);C&&(C.permissionMode=V,o.value.set(M,C)),console.log(`Set permission mode for session ${M} to ${V}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function v(M){try{await me.post(`/api/sessions/${M}/start`),console.log(`Started session ${M}`)}catch(V){throw console.error("Failed to start session:",V),V}}async function T(M){try{await me.post(`/api/sessions/${M}/pause`),console.log(`Paused session ${M}`)}catch(V){throw console.error("Failed to pause session:",V),V}}async function E(M){try{await me.post(`/api/sessions/${M}/terminate`),console.log(`Terminated session ${M}`)}catch(V){throw console.error("Failed to terminate session:",V),V}}function W(M){return n.value.get(M)}function j(M,V){o.value.set(M,V),V.permissionMode&&$(M,{current_permission_mode:V.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:f,orderedSessions:p,sessionsInProject:d,currentInput:u,fetchSessions:w,createSession:g,selectSession:k,updateSession:$,deleteSession:b,patchSession:m,setPermissionMode:h,startSession:v,pauseSession:T,terminateSession:E,getSession:W,storeInitData:j}}),yn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:de},Symbol.toStringTag,{value:"Module"})),_e=st("ui",()=>{const n=R(window.innerWidth<768),e=R(300),t=R(!0),o=R(300),i=R(window.innerWidth),r=_(()=>i.value<768),c=R(!0),f=R(!1),p=R(null),d=R(null),u=_(()=>p.value?{name:p.value,data:d.value}:null),w=R(!1),g=R("Loading...");function k(){n.value=!n.value}function $(B){n.value=B}function b(B){e.value=Math.max(200,Math.min(B,window.innerWidth*.3))}function m(){t.value=!t.value}function h(B){t.value=B}function v(B){o.value=Math.max(200,Math.min(B,window.innerWidth*.3))}function T(B){c.value=B}function E(){const B=localStorage.getItem("webui-background-color");f.value=B==="red"}function W(){f.value=!f.value,localStorage.setItem("webui-background-color",f.value?"red":"gray")}function j(B,G=null){p.value=null,d.value=null,setTimeout(()=>{p.value=B,d.value=G},0)}function M(){p.value=null,d.value=null}function V(B="Loading..."){w.value=!0,g.value=B}function C(){w.value=!1}function x(){const B=i.value;i.value=window.innerWidth,i.value<768&&B>=768?n.value=!0:i.value>=768&&B<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:r,autoScrollEnabled:c,isRedBackground:f,activeModal:p,modalData:d,currentModal:u,isLoading:w,loadingMessage:g,toggleSidebar:k,setSidebarCollapsed:$,setSidebarWidth:b,toggleRightSidebar:m,setRightSidebarCollapsed:h,setRightSidebarWidth:v,setAutoScroll:T,initBackgroundColor:E,toggleBackgroundColor:W,showModal:j,hideModal:M,showLoading:V,hideLoading:C,handleResize:x}}),je=st("project",()=>{const n=R(new Map),e=R(null),t=_(()=>n.value.get(e.value)),o=_(()=>Array.from(n.value.values()).sort((m,h)=>m.order-h.order));async function i(){try{const m=await me.get("/api/projects");return n.value.clear(),m.projects.forEach(h=>{n.value.set(h.project_id,h)}),console.log(`Loaded ${n.value.size} projects`),m.projects}catch(m){throw console.error("Failed to fetch projects:",m),m}}async function r(m,h){try{const T=(await me.post("/api/projects",{name:m,working_directory:h})).project;return n.value.set(T.project_id,T),n.value=new Map(n.value),console.log(`Created project ${T.project_id}`),T}catch(v){throw console.error("Failed to create project:",v),v}}async function c(m,h){try{await me.put(`/api/projects/${m}`,h),f(m,h),console.log(`Updated project ${m}`,h)}catch(v){throw console.error("Failed to update project:",v),v}}function f(m,h){const v=n.value.get(m);v&&(Object.assign(v,h),n.value=new Map(n.value))}async function p(m){try{await me.delete(`/api/projects/${m}`),n.value.delete(m),n.value=new Map(n.value),e.value===m&&(e.value=null),console.log(`Deleted project ${m}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function d(m){try{const h=await me.put(`/api/projects/${m}/toggle-expansion`),v=n.value.get(m);return v&&(v.is_expanded=h.is_expanded,n.value=new Map(n.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function u(m){try{await me.put("/api/projects/reorder",{project_ids:m}),m.forEach((h,v)=>{const T=n.value.get(h);T&&(T.order=v)}),n.value=new Map(n.value),console.log("Reordered projects",m)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function w(m,h){try{await me.put(`/api/projects/${m}/sessions/reorder`,{session_ids:h});const v=n.value.get(m);v&&(v.session_ids=h,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${m}`,h)}catch(v){throw console.error("Failed to reorder sessions:",v),v}}function g(m){return n.value.get(m)}function k(m){e.value=m}function $(){e.value=null}function b(m){if(!m)return"";const h=m.split(/[/\\]/).filter(v=>v);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:r,updateProject:c,updateProjectLocal:f,deleteProject:p,toggleExpansion:d,reorderProjects:u,reorderSessionsInProject:w,getProject:g,selectProject:k,clearProjectSelection:$,formatPath:b}}),ne=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Hi={class:"project-name"},Vi=["title"],Ui={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=je(),i=_e(),r=_(()=>t.sessions.get(e.sessionId)),c=_(()=>r.value?.name||e.sessionId),f=_(()=>{for(const d of o.projects.values())if(d.session_ids?.includes(e.sessionId))return d;return null}),p=_(()=>f.value?.name||"Unknown Project");return(d,u)=>(a(),l("div",{class:se(["session-header border-bottom p-3",{"theme-red-panel":$e(i).isRedBackground}])},[s("div",Hi,y(p.value),1),s("div",{class:"session-name",title:n.sessionId},y(c.value),9,Vi)],2))}},qi=ne(Ui,[["__scopeId","data-v-ba771dd8"]]),zi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ki=["title"],Gi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Yi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_(()=>t.sessions.get(e.sessionId)),i=_(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=_(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),c=_(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),f=_(()=>{if(!o.value)return"No session selected";const p=i.value,d=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${u}${w}: ${d}`});return(p,d)=>(a(),l("div",zi,[o.value?(a(),l("div",{key:0,class:se(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:ze({width:"100%",backgroundColor:r.value}),title:f.value},null,14,Ki)):(a(),l("div",Gi))]))}},Ji=ne(Yi,[["__scopeId","data-v-63d222fe"]]),Qi={class:"d-flex justify-content-between align-items-center gap-2"},Xi={class:"d-flex gap-2"},Zi=["disabled"],ea={class:"mode-label"},ta=["disabled"],sa=["disabled"],na={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_e(),i=_(()=>t.sessions.get(e.sessionId)),r=_(()=>i.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},f=_(()=>c[r.value]||"ðŸ”’"),p=_(()=>r.value),d=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(r.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const b=(d.indexOf(r.value)+1)%d.length,m=d[b];try{await t.setPermissionMode(e.sessionId,m)}catch(h){console.error("Failed to cycle permission mode:",h)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},k=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return($,b)=>(a(),l("div",{class:se(["session-status-bar border-top p-2",$e(o).isRedBackground?"theme-red-panel":"bg-light"])},[s("div",Qi,[s("div",Xi,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[ie(y(f.value)+" ",1),s("span",ea,y(p.value),1)],8,Zi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!i.value},[...b[0]||(b[0]=[ie(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,ta),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...b[1]||(b[1]=[ie(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,sa)]),s("div",null,[s("button",{class:se(["btn btn-sm",$e(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:k}," â¬‡ï¸ "+y($e(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},oa=ne(na,[["__scopeId","data-v-ed9a4d3c"]]),Rt=st("task",()=>{const n=R(new Map),e=R(new Set);function t(v){const T=n.value.get(v);return T?Array.from(T.values()).sort((E,W)=>{const j=parseInt(E.id.replace(/\D/g,""))||0,M=parseInt(W.id.replace(/\D/g,""))||0;return j-M}):[]}function o(v){return t(v).find(E=>E.status==="in_progress")||null}function i(v){const T=t(v);return{total:T.length,completed:T.filter(E=>E.status==="completed").length,inProgress:T.filter(E=>E.status==="in_progress").length,pending:T.filter(E=>E.status==="pending").length}}function r(v){return e.value.has(v)}const c=_(()=>{const v=de();return t(v.currentSessionId)}),f=_(()=>{const v=de();return o(v.currentSessionId)}),p=_(()=>{const v=de();return i(v.currentSessionId)}),d=_(()=>{const v=de();return r(v.currentSessionId)});function u(v,T){n.value.has(v)||n.value.set(v,new Map),n.value.get(v).set(T.id,{id:T.id,subject:T.subject||"",description:T.description||"",status:T.status||"pending",activeForm:T.activeForm||null,owner:T.owner||null,blocks:T.blocks||[],blockedBy:T.blockedBy||[],metadata:T.metadata||{}}),e.value.add(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${T.id} for session ${v}`)}function w(v,T,E){const W=n.value.get(v);if(!W){console.warn(`No tasks found for session ${v}`);return}const j=W.get(T);if(!j){u(v,{id:T,...E});return}E.subject!==void 0&&(j.subject=E.subject),E.description!==void 0&&(j.description=E.description),E.status!==void 0&&(j.status=E.status),E.activeForm!==void 0&&(j.activeForm=E.activeForm),E.owner!==void 0&&(j.owner=E.owner),E.metadata!==void 0&&(j.metadata={...j.metadata,...E.metadata}),E.addBlocks&&(j.blocks=[...new Set([...j.blocks,...E.addBlocks])]),E.addBlockedBy&&(j.blockedBy=[...new Set([...j.blockedBy,...E.addBlockedBy])]),E.status==="deleted"&&(W.delete(T),W.size===0&&(e.value.delete(v),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${T} for session ${v}`,E)}function g(v,T){return n.value.get(v)?.get(T)||null}function k(v){n.value.delete(v),e.value.delete(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${v}`)}function $(v,T){n.value.has(v)&&n.value.get(v).clear(),e.value.delete(v);const E=new Map;for(const W of T){if(W.metadata?.tool_uses)for(const j of W.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(j.name)&&E.set(j.id,{name:j.name,input:j.input});if(W.metadata?.tool_results)for(const j of W.metadata.tool_results){const M=E.get(j.tool_use_id);M&&(b(v,M.name,M.input,{error:j.is_error,content:j.content}),E.delete(j.tool_use_id))}}console.log(`Reconstructed ${n.value.get(v)?.size||0} tasks for session ${v}`)}function b(v,T,E,W){if(W?.error){console.log(`Skipping task update - tool ${T} returned error`);return}const j=m(W);if(j)switch(T){case"TaskCreate":{const M=h(j)||E?.id;M&&u(v,{id:M,subject:E?.subject||"",description:E?.description||"",status:"pending",activeForm:E?.activeForm||null,owner:E?.owner||null,blocks:[],blockedBy:[],metadata:E?.metadata||{}});break}case"TaskUpdate":{const M=E?.taskId;M&&w(v,M,{status:E?.status,subject:E?.subject,description:E?.description,activeForm:E?.activeForm,owner:E?.owner,metadata:E?.metadata,addBlocks:E?.addBlocks,addBlockedBy:E?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{E?.taskId;break}}}function m(v){return v?typeof v=="string"?v:v.content?typeof v.content=="string"?v.content:JSON.stringify(v.content):v.message?v.message:JSON.stringify(v):null}function h(v){if(!v)return null;const T=v.match(/[Tt]ask\s*#(\d+)/i);if(T)return T[1];const E=v.match(/#(\d+)/);return E?E[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:f,currentTaskStats:p,currentHasTasks:d,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:r,getTask:g,createTask:u,updateTask:w,clearTasks:k,reconstructFromMessages:$,handleTaskToolResult:b}}),Ae=st("message",()=>{const n=R(new Map),e=R(new Map),t=R(new Map),o=R(new Map),i=R(new Map),r=R(new Map),c=R(new Map),f=R(new Map),p=_(()=>{const O=de();return n.value.get(O.currentSessionId)||[]}),d=_(()=>{const O=de();return e.value.get(O.currentSessionId)||[]});async function u(O,N=null,D=0){try{const S=N||1e4,I=await me.get(`/api/sessions/${O}/messages?limit=${S}&offset=${D}`),z=I.messages||[],J=I.total_count||z.length,K=I.has_more||!1;if(console.log(`Loaded ${z.length} of ${J} messages for session ${O}`),n.value.set(O,z),z.length>0){const P=z[z.length-1];P.timestamp&&(c.value.set(O,P.timestamp),console.log(`Tracked last received timestamp for session ${O}: ${P.timestamp}`))}const te=new Set;z.forEach(P=>{P.type==="assistant"&&P.metadata?.tool_uses&&P.metadata.tool_uses.forEach(U=>{te.add(U.id)}),P.type==="user"&&P.metadata?.tool_results&&P.metadata.tool_results.forEach(U=>{te.delete(U.tool_use_id);const ee=r.value.get(O);ee&&ee.delete(U.tool_use_id)}),P.type==="system"&&P.metadata?.subtype==="client_launched"&&(te.forEach(U=>{C(O,U,"Session was restarted")}),te.clear()),P.type==="system"&&P.metadata?.subtype==="interrupt"&&(te.forEach(U=>{C(O,U,"Session was interrupted")}),te.clear()),P.metadata?.has_tool_uses&&P.metadata.tool_uses&&P.metadata.tool_uses.forEach(U=>{b(O,U,P.timestamp)}),P.metadata?.has_tool_results&&P.metadata.tool_results&&P.metadata.tool_results.forEach(U=>{T(O,U)}),(P.type==="permission_request"||P.metadata?.has_permission_requests)&&m(O,P),P.type==="permission_response"&&h(O,{request_id:P.metadata?.request_id,decision:P.metadata?.decision,updated_input:P.metadata?.updated_input,reasoning:P.metadata?.reasoning,applied_updates:P.metadata?.applied_updates}),P.type==="system"&&(P.subtype==="init"||P.metadata?.subtype==="init")&&P.metadata?.init_data&&de().storeInitData(O,P.metadata.init_data)});const H=de().sessions.get(O);H&&!["active","paused","starting"].includes(H.state)&&(te.forEach(P=>{C(O,P,"Session was terminated")}),te.clear()),i.value.set(O,te),n.value=new Map(n.value);try{Rt().reconstructFromMessages(O,z)}catch(P){console.warn("Failed to reconstruct task state:",P)}return K&&console.warn(`Warning: Only loaded ${z.length} of ${J} messages. Some messages may be missing.`),{messages:z,totalCount:J,hasMore:K}}catch(S){throw console.error("Failed to load messages:",S),S}}function w(O,N){const D=i.value.get(O)||new Set;N.type==="assistant"&&N.metadata?.tool_uses&&N.metadata.tool_uses.forEach(S=>{D.add(S.id)}),N.type==="user"&&N.metadata?.tool_results&&N.metadata.tool_results.forEach(S=>{D.delete(S.tool_use_id);const I=r.value.get(O);I&&I.delete(S.tool_use_id)}),N.type==="system"&&N.metadata?.subtype==="client_launched"&&(D.forEach(S=>{C(O,S,"Session was restarted")}),D.clear()),N.type==="system"&&N.metadata?.subtype==="interrupt"&&(D.forEach(S=>{C(O,S,"Session was interrupted")}),D.clear()),i.value.set(O,D)}function g(O,N){n.value.has(O)||n.value.set(O,[]);const D=n.value.get(O);if(N.id){const S=D.findIndex(I=>I.id===N.id);if(S!==-1){console.log(`Skipping duplicate message ${N.id} (already exists at index ${S})`);return}}D.push(N),N.timestamp&&c.value.set(O,N.timestamp),j(O,N),w(O,N),n.value=new Map(n.value)}function k(O,N){e.value.has(O)||e.value.set(O,[]),e.value.get(O).push(N),e.value=new Map(e.value)}function $(O,N,D){const S=e.value.get(O);if(S){const I=S.find(z=>z.id===N);I&&(Object.assign(I,D),e.value=new Map(e.value))}}function b(O,N,D=null){const S=W(N.name,N.input);t.value.set(S,N.id);const I={id:N.id,name:N.name,input:N.input,signature:S,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:D||new Date().toISOString(),isExpanded:!0};return k(O,I),console.log(`Created tool call ${I.id} for ${I.name}`),I}function m(O,N){console.log("handlePermissionRequest received:",N);const D=N.metadata?.tool_name||N.tool_name,S=N.metadata?.input_params||N.input_params,I=N.metadata?.request_id||N.request_id,z=N.metadata?.suggestions||N.suggestions||[];console.log("Extracted data:",{toolName:D,inputParams:S,requestId:I,suggestions:z});const J=W(D,S),K=t.value.get(J);K?(o.value.set(I,K),$(O,K,{status:"permission_required",permissionRequestId:I,suggestions:z}),console.log(`Permission required for tool ${K}`,{suggestions:z})):console.warn("No tool use ID found for permission request signature:",J,{toolName:D,inputParams:S,availableSignatures:Array.from(t.value.keys())})}function h(O,N){const D=o.value.get(N.request_id);if(D){const S={permissionDecision:N.decision,appliedUpdates:N.applied_updates||[]};N.decision==="allow"?S.status="executing":(S.status="completed",S.result={error:!0,message:N.reasoning||"Permission denied"},S.isExpanded=!1),N.updated_input&&(S.input=N.updated_input),$(O,D,S),console.log(`Permission ${N.decision} for tool ${D}`)}}function v(O,N){console.log("handleToolCall received:",N);const D=N.tool_use_id;if(!D){console.warn("Received tool_call without tool_use_id:",N);return}e.value.has(O)||e.value.set(O,[]);const S=e.value.get(O),I=S.findIndex(K=>K.id===D),J={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[N.status]||N.status;if(I!==-1){const K=S[I];K.status=J,K.backendStatus=N.status,N.permission&&(K.suggestions=N.permission.suggestions||[],K.permissionRequestId=N.request_id),N.permission_granted!==null&&N.permission_granted!==void 0&&(K.permissionDecision=N.permission_granted?"allow":"deny"),N.result!==void 0&&(K.result={error:N.status==="failed",content:N.result}),N.error&&(K.result={error:!0,content:N.error}),N.status==="denied"&&(K.result={error:!0,message:"Permission denied"},K.isExpanded=!1),N.status==="interrupted"&&(C(O,D,"Session was interrupted"),K.isExpanded=!1),(N.status==="completed"||N.status==="failed")&&(K.isExpanded=!1),N.display&&(K.backendState=N.display),console.log(`Updated tool call ${D} to status: ${J} (backend: ${N.status})`)}else{const K=W(N.name,N.input);t.value.set(K,D);const te={id:D,name:N.name,input:N.input,signature:K,status:J,backendStatus:N.status,permissionRequestId:N.request_id,permissionDecision:N.permission_granted!==void 0?N.permission_granted?"allow":"deny":null,suggestions:N.permission?.suggestions||[],result:N.result?{error:N.status==="failed",content:N.result}:null,explanation:null,timestamp:N.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(N.status),backendState:N.display};N.error&&(te.result={error:!0,content:N.error}),S.push(te),console.log(`Created new tool call ${D} for ${N.name} with status: ${J}`)}if(e.value=new Map(e.value),["completed","failed"].includes(N.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(N.name))try{Rt().handleTaskToolResult(O,N.name,N.input,{error:N.status==="failed",content:N.result})}catch(K){console.warn("Failed to update task store:",K)}}function T(O,N){const D=N.tool_use_id;$(O,D,{status:N.is_error?"error":"completed",result:{error:N.is_error,content:N.content},isExpanded:!1}),console.log(`Tool ${D} ${N.is_error?"failed":"completed"}`);const S=e.value.get(O);if(S){const I=S.find(z=>z.id===D);if(I&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name))try{Rt().handleTaskToolResult(O,I.name,I.input,{error:N.is_error,content:N.content})}catch(z){console.warn("Failed to update task store:",z)}}}function E(O,N){const D=e.value.get(O);if(D){const S=D.find(I=>I.id===N);S&&(S.isExpanded=!S.isExpanded,e.value=new Map(e.value))}}function W(O,N){if(!O)return"unknown:{}";if(!N||typeof N!="object")return`${O}:{}`;const D=JSON.stringify(N,Object.keys(N).sort());return`${O}:${D}`}function j(O,N){const D=N.metadata?.display||N.display;if(!D)return;f.value.has(O)||f.value.set(O,new Map);const S=f.value.get(O);if(D.tool_states)for(const[I,z]of Object.entries(D.tool_states)){S.set(I,z);const J=e.value.get(O);if(J){const K=J.find(te=>te.id===I);if(K){const te={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};K.status=te[z.state]||z.state,K.backendState=z}}}if(D.orphaned_tools&&D.orphaned_tools.length>0){const I=r.value.get(O)||new Map;for(const z of D.orphaned_tools)I.has(z)||I.set(z,{reason:"denied",message:"Session was interrupted"});r.value.set(O,I)}if(D.linked_permissions)for(const[I,z]of Object.entries(D.linked_permissions))o.value.set(I,z);D.tool_states&&Object.keys(D.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${O}:`,{toolStates:Object.keys(D.tool_states||{}).length,orphanedTools:(D.orphaned_tools||[]).length,linkedPermissions:Object.keys(D.linked_permissions||{}).length})}function M(O,N){return f.value.get(O)?.get(N)}function V(O){const N=f.value.get(O);return N&&N.size>0}function C(O,N,D){const S=r.value.get(O)||new Map;S.set(N,{reason:"denied",message:D}),r.value.set(O,S);const I=e.value.get(O);if(I){const z=I.find(J=>J.id===N);z&&z.isExpanded&&(z.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${N} as orphaned: ${D}`)}function x(O,N){const D=M(O,N);return D&&D.state==="orphaned"?!0:r.value.get(O)?.has(N)||!1}function B(O,N){const D=M(O,N);return D&&D.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:D}:r.value.get(O)?.get(N)}function G(O,N){const D=i.value.get(O);D&&D.size>0&&(D.forEach(S=>C(O,S,N)),D.clear())}function L(O){n.value.delete(O),e.value.delete(O),n.value=new Map(n.value),e.value=new Map(e.value)}function F(O){return c.value.get(O)}async function q(O){const N=c.value.get(O);if(!N)return console.log(`No sync needed for session ${O} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${O} since ${N}`);const D=await me.get(`/api/sessions/${O}/messages?limit=1000&offset=0`),S=D.messages||[],I=D.has_more||!1,z=U=>U?typeof U=="number"?U*1e3:new Date(U).getTime():0,J=z(N),K=S.filter(U=>U.timestamp?z(U.timestamp)>J:!1);if(K.length===0)return console.log(`No missed messages for session ${O}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${K.length} missed messages for session ${O}`);const te=n.value.get(O)||[],X=new Set(te.map(U=>U.id).filter(Boolean)),H=K.filter(U=>!U.id||!X.has(U.id));if(console.log(`After deduplication: ${H.length} unique new messages`),H.length>0){const U=H.sort((Fe,Y)=>{const le=z(Fe.timestamp),ue=z(Y.timestamp);return le-ue}),ee=n.value.get(O)||[],oe=ee.length>0?z(ee[ee.length-1].timestamp):0,he=z(U[0].timestamp),rt=z(U[U.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ee.length,lastExisting:oe,lastExistingDate:ee.length>0?ee[ee.length-1].timestamp:"none",firstNew:he,firstNewDate:U[0].timestamp,lastNew:rt,lastNewDate:U[U.length-1].timestamp,shouldAppend:he>oe}),he>oe){const Fe=[...ee,...U];n.value.set(O,Fe),console.log(`âœ… Appended ${U.length} new messages (no full sort needed)`)}else{const Fe=[...ee,...U].sort((Y,le)=>{const ue=z(Y.timestamp),Te=z(le.timestamp);return ue-Te});n.value.set(O,Fe),console.log(`âš ï¸ Merged and sorted ${U.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${te.length} messages unchanged`);H.forEach(U=>{w(O,U),U.metadata?.has_tool_uses&&U.metadata.tool_uses&&U.metadata.tool_uses.forEach(ee=>{b(O,ee,U.timestamp)}),U.metadata?.has_tool_results&&U.metadata.tool_results&&U.metadata.tool_results.forEach(ee=>{T(O,ee)}),(U.type==="permission_request"||U.metadata?.has_permission_requests)&&m(O,U),U.type==="permission_response"&&h(O,{request_id:U.metadata?.request_id,decision:U.metadata?.decision,updated_input:U.metadata?.updated_input,reasoning:U.metadata?.reasoning,applied_updates:U.metadata?.applied_updates}),U.type==="system"&&(U.subtype==="init"||U.metadata?.subtype==="init")&&U.metadata?.init_data&&de().storeInitData(O,U.metadata.init_data)});const P=n.value.get(O);if(P&&P.length>0){const U=P[P.length-1];U.timestamp&&c.value.set(O,U.timestamp)}return n.value=new Map(n.value),{syncedCount:H.length,hasMore:I}}catch(D){return console.error(`Failed to sync messages for session ${O}:`,D),{syncedCount:0,hasMore:!1,error:D.message}}}const Z=de();return fe(()=>Array.from(Z.sessions.values()).map(N=>({id:N.session_id,state:N.state})),(O,N)=>{N&&O.forEach((D,S)=>{const I=N[S];if(!I||I.id!==D.id)return;const z=["active","paused","starting"].includes(I.state),J=!["active","paused","starting"].includes(D.state);z&&J&&G(D.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:bs(i),orphanedToolUses:bs(r),currentMessages:p,currentToolCalls:d,loadMessages:u,addMessage:g,addToolCall:k,updateToolCall:$,handleToolCall:v,handleToolUse:b,handlePermissionRequest:m,handlePermissionResponse:h,handleToolResult:T,toggleToolExpansion:E,clearMessages:L,markToolUseOrphaned:C,isToolUseOrphaned:x,getOrphanedInfo:B,clearOrphanedToolUses:G,getLastReceivedTimestamp:F,syncMessages:q,getBackendToolState:M,hasBackendDisplayMetadata:V,backendToolStates:bs(f)}}),ia=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ae},Symbol.toStringTag,{value:"Module"}));function aa(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ht(n){return aa(n).toLocaleTimeString()}const ra={class:"message-row message-row-user"},la=["title"],ca={class:"message-content-column"},ua=["innerHTML"],da={key:0,class:"tool-results mt-2"},ma={class:"tool-results-header text-muted small mb-2"},pa={class:"d-flex align-items-start gap-2"},fa={class:"flex-grow-1"},va={class:"text-muted"},ha={key:0,class:"text-danger small"},_a={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=_(()=>Ht(e.message.timestamp)),o=_(()=>`user
${t.value}`),i=_(()=>{const p=e.message.content||"";let d=dt.parse(p);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),cs.sanitize(d)}),r=_(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=_(()=>e.message.metadata?.tool_results||[]);function f(p,d){return p?p.length<=d?p:p.substring(0,d)+"...":""}return(p,d)=>(a(),l("div",ra,[s("div",{class:"message-speaker",title:o.value},[...d[0]||(d[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,la),s("div",ca,[s("div",{class:"message-text",innerHTML:i.value},null,8,ua),r.value?(a(),l("div",da,[s("div",ma," ðŸ”§ Tool Results ("+y(c.value.length)+") ",1),(a(!0),l(re,null,ce(c.value,(u,w)=>(a(),l("div",{key:w,class:se(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",pa,[s("span",null,y(u.is_error?"âŒ":"âœ…"),1),s("div",fa,[s("small",va,"Tool: "+y(u.tool_use_id),1),u.is_error?(a(),l("div",ha,y(f(u.content,200)),1)):A("",!0)])])],2))),128))])):A("",!0)])]))}},ga=ne(_a,[["__scopeId","data-v-7665755b"]]),ba={class:"thinking-block"},ya=["aria-label"],wa={class:"text-muted ms-auto"},$a={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ka=["innerHTML"],Sa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=R(!1),o=_(()=>e.thinking?.length||0),i=_(()=>{const c=e.thinking||"",f=dt.parse(c);return cs.sanitize(f)});function r(){t.value=!t.value}return(c,f)=>(a(),l("div",ba,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[s("span",{"aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,ya),f[0]||(f[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",wa,y(o.value)+" characters",1)]),t.value?(a(),l("div",$a,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ka)])):A("",!0)]))}},Ea=ne(Sa,[["__scopeId","data-v-fda2352c"]]),wn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),ks={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Xe=st("resource",()=>{const n=R(new Map),e=R(!1),t=R(0),o=R(null),i=R(!1);function r(X){if(!X)return!1;if(X.is_image===!0||(X.mime_type||"").toLowerCase().startsWith("image/"))return!0;const P=(X.format||"").toLowerCase();if(P.startsWith("image/")||wn.has("."+P))return!0;const U=X.original_filename||X.original_name||"";if(U){const ee="."+U.split(".").pop().toLowerCase();return wn.has(ee)}return!1}function c(X){if(r(X))return"ðŸ–¼ï¸";if(X.original_filename){const H="."+X.original_filename.split(".").pop().toLowerCase();return ks[H]||ks.default}return ks.default}function f(X){return X.original_filename?"."+X.original_filename.split(".").pop().toLowerCase():""}function p(X){const H=n.value.get(X);return H||[]}function d(X){return n.value.get(X)?.length||0}function u(X){return d(X)>0}function w(X){return p(X).filter(r)}function g(X){return w(X).length}function k(X){return g(X)>0}const $=_(()=>{const X=de();return p(X.currentSessionId)}),b=_(()=>{const X=de();return d(X.currentSessionId)}),m=_(()=>b.value>0),h=_(()=>$.value.filter(r)),v=_(()=>h.value.length),T=_(()=>v.value>0),E=_(()=>!e.value||!o.value?null:p(o.value)[t.value]||null),W=E,j=_(()=>o.value?d(o.value):0),M=j;async function V(X){if(X){i.value=!0;try{const P=(await _o(`/api/sessions/${X}/resources`)).resources||[];P.sort((U,ee)=>(U.timestamp||0)-(ee.timestamp||0)),n.value.set(X,P),n.value=new Map(n.value),console.log(`Loaded ${P.length} resources for session ${X}`)}catch(H){console.error(`Failed to load resources for session ${X}:`,H),n.value.set(X,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const C=V;function x(X,H){if(!X||!H)return;let P=n.value.get(X);P||(P=[],n.value.set(X,P));const U=P.findIndex(ee=>ee.resource_id===H.resource_id);U>=0?P[U]=H:P.push(H),P.sort((ee,oe)=>(ee.timestamp||0)-(oe.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${H.resource_id} to session ${X}`)}const B=x;function G(X,H){return`/api/sessions/${X}/resources/${H}`}const L=G;function F(X,H){return`/api/sessions/${X}/resources/${H}/download`}function q(X,H=0){o.value=X,t.value=Math.max(0,Math.min(H,d(X)-1)),e.value=!0}function Z(){e.value=!1}function O(){if(!o.value)return;const X=d(o.value);X!==0&&(t.value=(t.value+1)%X)}const N=O;function D(){if(!o.value)return;const X=d(o.value);X!==0&&(t.value=(t.value-1+X)%X)}const S=D;function I(X){if(!o.value)return;const H=d(o.value);H!==0&&(t.value=Math.max(0,Math.min(X,H-1)))}const z=I;function J(X){n.value.delete(X),n.value=new Map(n.value),o.value===X&&Z(),console.log(`Cleared resources for session ${X}`)}const K=J;function te(X,H){const P=n.value.get(X);return P&&P.find(U=>U.resource_id===H)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:t,fullViewSessionId:o,loading:i,currentResources:$,currentResourceCount:b,currentHasResources:m,currentFullViewResource:E,fullViewTotalResources:j,currentImages:h,currentImageCount:v,currentHasImages:T,currentFullViewImage:W,fullViewTotalImages:M,imagesBySession:n,resourcesForSession:p,resourceCount:d,hasResources:u,getResourceUrl:G,getDownloadUrl:F,isImageResource:r,getResourceIcon:c,getResourceExtension:f,getResourceById:te,imagesForSession:w,imageCount:g,hasImages:k,getImageUrl:L,loadResources:V,addResource:x,openFullView:q,closeFullView:Z,nextResource:O,prevResource:D,goToResource:I,clearResources:J,loadImages:C,addImage:B,nextImage:N,prevImage:S,goToImage:z,clearImages:K}}),Ca=Xe,Ta=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ca,useResourceStore:Xe},Symbol.toStringTag,{value:"Module"})),nt=st("websocket",()=>{const n=R(null),e=R(!1),t=R(0),o=10,i=R(null),r=R(!1),c=R(0),f=5,p=R(null);let d=null;const u=R(0),w=R(null),g=R(new Map),k=R(null),$=R(!1),b=R(0),m=5,h=R(null),v=1e4,T=1e3,E=R(Date.now()),W=R(Date.now()),j=R(Date.now());let M=null,V=null,C=null;const x=_(()=>e.value&&(r.value||!p.value)?"connected":e.value?"partial":"disconnected");function B(H){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${H}`}function G(H){const P={ui:{timer:()=>M,setTimer:U=>{M=U},lastPing:E,connected:e,name:"UI"},session:{timer:()=>V,setTimer:U=>{V=U},lastPing:W,connected:r,name:"Session"},legion:{timer:()=>C,setTimer:U=>{C=U},lastPing:j,connected:$,name:"Legion"}}[H];P.timer()&&clearInterval(P.timer()),P.setTimer(setInterval(()=>{if(!P.connected.value)return;const U=Date.now()-P.lastPing.value;if(U>v){console.warn(`âš ï¸ ${P.name} WebSocket heartbeat timeout (${U}ms since last ping) - forcing close to trigger reconnection`),P.connected.value=!1;const oe={ui:n,session:i,legion:k}[H];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},T)),console.log(`âœ… Started heartbeat monitor for ${P.name} WebSocket`)}function L(H){const P={ui:{get:()=>M,set:U=>{M=U}},session:{get:()=>V,set:U=>{V=U}},legion:{get:()=>C,set:U=>{C=U}}}[H];P.get()&&(clearInterval(P.get()),P.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${H} WebSocket`))}function F(){if(n.value)return;const H=B("/ws/ui");console.log(`Connecting to UI WebSocket: ${H}`),n.value=new WebSocket(H),n.value.onopen=()=>{e.value=!0,t.value=0,E.value=Date.now(),G("ui"),console.log("UI WebSocket connected")},n.value.onmessage=P=>{const U=JSON.parse(P.data);z(U)},n.value.onclose=()=>{if(L("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const P=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${P}ms (attempt ${t.value})`),setTimeout(F,P)}},n.value.onerror=P=>{console.error("UI WebSocket error:",P)}}function q(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Z(H){u.value++;const P=u.value;if(console.log(`[Gen ${P}] Starting connection to session ${H}`),d&&(clearTimeout(d),d=null),await O(),u.value!==P){console.log(`[Gen ${P}] Connection cancelled (current generation: ${u.value})`);return}p.value=H,w.value=P;const U=B(`/ws/session/${H}`);console.log(`[Gen ${P}] Connecting to Session WebSocket: ${U}`),i.value=new WebSocket(U),i.value.onopen=async()=>{if(w.value!==P){console.log(`[Gen ${P}] Ignoring onopen (stale connection, current: ${w.value})`),i.value.close();return}r.value=!0,c.value=0,W.value=Date.now(),G("session"),console.log(`[Gen ${P}] Session WebSocket connected for ${H}`);const ee=g.value.get(H);if(g.value.set(H,!0),ee){console.log(`[Gen ${P}] Reconnection detected, syncing missed messages...`);try{const he=await Ae().syncMessages(H);he.syncedCount>0?console.log(`[Gen ${P}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${P}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${P}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${P}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${P}] Error during message sync:`,oe)}}else console.log(`[Gen ${P}] Initial connection, no sync needed`)},i.value.onmessage=ee=>{if(w.value!==P){console.log(`[Gen ${P}] Ignoring message (stale connection, current: ${w.value})`);return}const oe=JSON.parse(ee.data);J(oe,H)},i.value.onclose=()=>{L("session"),r.value=!1,i.value=null,console.log(`[Gen ${P}] Session WebSocket closed for ${H}`);const ee=de();if(ee.currentSessionId===H&&w.value===P&&c.value<f){c.value++;const oe=Math.min(2e3*c.value,3e4);console.log(`[Gen ${P}] Reconnecting Session WebSocket in ${oe}ms (attempt ${c.value})`),d=setTimeout(()=>{w.value===P&&ee.currentSessionId===H?(d=null,Z(H)):console.log(`[Gen ${P}] Skipping reconnect (generation or session changed)`)},oe)}},i.value.onerror=ee=>{console.error(`[Gen ${P}] Session WebSocket error:`,ee)}}function O(){return new Promise(H=>{if(d&&(clearTimeout(d),d=null,console.log("Cancelled pending session reconnect timer")),i.value){const P=p.value,U=()=>{i.value=null,r.value=!1,p.value=null,w.value=null,c.value=0,P&&g.value.delete(P),H()};if(i.value.readyState===WebSocket.CLOSED)U();else{const ee=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),U()},2e3);i.value.addEventListener("close",()=>{clearTimeout(ee),U()},{once:!0}),i.value.close()}}else p.value=null,w.value=null,H()})}function N(H){i.value&&r.value?(i.value.send(JSON.stringify({type:"send_message",content:H})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function D(H,P,U=!1,ee=null){if(i.value&&r.value){const oe={type:"permission_response",request_id:H,decision:P,apply_suggestions:U,timestamp:new Date().toISOString()};ee&&(oe.clarification_message=ee),i.value.send(JSON.stringify(oe)),console.log(`Sent permission ${P} for request ${H}`,{applySuggestions:U,clarification:ee})}}function S(H,P,U){if(i.value&&r.value){const ee={type:"permission_response",request_id:H,decision:P,updated_input:U,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(ee)),console.log(`Sent permission ${P} with updated_input for request ${H}`,U)}}function I(){i.value&&r.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function z(H){const P=de(),U=je();switch(H.type){case"sessions_list":H.sessions&&Array.isArray(H.sessions)&&H.sessions.forEach(ee=>{P.updateSession(ee.session_id,ee)});break;case"state_change":H.data&&H.data.session_id&&H.data.session&&P.updateSession(H.data.session_id,H.data.session);break;case"project_updated":if(H.data&&H.data.project){const ee=H.data.project;U.updateProjectLocal(ee.project_id,ee),P.fetchSessions()}break;case"project_deleted":H.data&&H.data.project_id&&U.projects.delete(H.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":E.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",H.type)}}function J(H,P){const U=de();if(U.currentSessionId!==P){console.warn(`Ignoring message for session ${P} (current: ${U.currentSessionId})`);return}const ee=Ae();switch(H.type){case"message":const oe=H.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",H);break}if(oe.type==="tool_call"){ee.handleToolCall(P,oe);break}if(oe.type==="permission_request"){ee.handlePermissionRequest(P,oe);break}if(oe.type==="permission_response"){ee.handlePermissionResponse(P,oe);break}oe.metadata?.has_tool_uses&&oe.metadata.tool_uses.forEach(he=>{ee.handleToolUse(P,he,oe.timestamp)}),oe.metadata?.has_tool_results&&oe.metadata.tool_results.forEach(he=>{ee.handleToolResult(P,he)}),oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&U.storeInitData(P,oe.metadata.init_data),ee.addMessage(P,oe);break;case"permission_request":ee.handlePermissionRequest(P,H);break;case"permission_response":ee.handlePermissionResponse(P,H);break;case"tool_result":ee.handleToolResult(P,H);break;case"state_change":U.updateSession(P,H.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${P}`);break;case"ping":W.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":H.resource&&(Xe().addResource(P,H.resource),console.log(`Resource registered for session ${P}:`,H.resource.resource_id));break;case"image_registered":H.image&&(Xe().addResource(P,{...H.image,resource_id:H.image.image_id}),console.log(`Image registered (legacy) for session ${P}:`,H.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",H.type)}}function K(H){te(),h.value=H;const P=B(`/ws/legion/${H}`);console.log(`Connecting to Legion WebSocket: ${P}`),k.value=new WebSocket(P),k.value.onopen=()=>{$.value=!0,b.value=0,j.value=Date.now(),G("legion"),console.log(`Legion WebSocket connected for ${H}`)},k.value.onmessage=U=>{const ee=JSON.parse(U.data);X(ee,H)},k.value.onclose=()=>{if(L("legion"),$.value=!1,k.value=null,console.log(`Legion WebSocket closed for ${H}`),h.value===H&&b.value<m){b.value++;const U=Math.min(2e3*b.value,3e4);setTimeout(()=>K(H),U)}},k.value.onerror=U=>{console.error("Legion WebSocket error:",U)}}function te(){k.value&&(k.value.close(),k.value=null,$.value=!1,h.value=null)}function X(H,P){xe(async()=>{const{useLegionStore:U}=await Promise.resolve().then(()=>jb);return{useLegionStore:U}},void 0).then(({useLegionStore:U})=>{const ee=U();switch(H.type){case"comm":H.comm&&(ee.addComm(P,H.comm),console.log("Legion WebSocket: Received new comm",H.comm));break;case"minion_created":H.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",H.data),xe(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>yn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":H.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",H.data),xe(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>yn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${P}`);break;case"ping":j.value=Date.now(),k.value?.readyState===WebSocket.OPEN&&k.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",H.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:r,sessionRetryCount:c,legionConnected:$,legionRetryCount:b,overallStatus:x,connectUI:F,disconnectUI:q,connectSession:Z,disconnectSession:O,sendMessage:N,sendPermissionResponse:D,sendPermissionResponseWithInput:S,interruptSession:I,connectLegion:K,disconnectLegion:te}}),xa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:nt},Symbol.toStringTag,{value:"Module"})),Aa={class:"base-tool-handler"},Ma={class:"tool-section"},Oa={class:"tool-parameters"},Da={class:"tool-code"},Na={key:0,class:"tool-section"},La={class:"tool-section-label"},Ia={class:"tool-code"},ja={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=_(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,f)=>(a(),l("div",Aa,[s("div",Ma,[f[0]||(f[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",Oa,[s("pre",Da,y(t.value),1)])]),o.value?(a(),l("div",Na,[s("div",La,y(i.value?"Error:":"Result:"),1),s("div",{class:se(["tool-result",{"tool-result-error":i.value}])},[s("pre",Ia,y(r.value),1)],2)])):A("",!0)]))}},Pa=ne(ja,[["__scopeId","data-v-1e69f57d"]]),Ra={class:"read-tool-handler"},Wa={class:"tool-section"},Ba={class:"read-file-info"},Fa={class:"file-icon"},Ha={class:"file-path"},Va={key:0,class:"read-range"},Ua={key:0,class:"tool-section"},qa={key:0,class:"tool-result tool-result-error"},za={class:"tool-code"},Ka={key:1,class:"image-preview"},Ga={class:"content-header"},Ya={class:"image-badge"},Ja={class:"image-container"},Qa=["src","alt"],Xa={key:2,class:"file-content-preview"},Za={class:"content-header"},er={class:"line-count-badge"},tr={key:0,class:"preview-note"},sr={class:"tool-code content-display"},nr={key:0,class:"more-indicator"},Ss=100,or={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>{const h=t.value;return h.split("/").pop()||h}),i=_(()=>{const h=e.toolCall.input?.offset,v=e.toolCall.input?.limit;return h!==void 0||v!==void 0}),r=_(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),c=_(()=>{const h=e.toolCall.input?.offset||0,v=e.toolCall.input?.limit;return v!==void 0?h+v:"âˆž"}),f=_(()=>{const h=t.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(h)}),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>{if(!p.value||d.value)return null;const v=e.toolCall.result?.content;if(Array.isArray(v)){for(const T of v)if(T?.type==="image"&&T?.source?.type==="base64"&&T?.source?.data)return T.source.data}return null}),w=_(()=>{if(!u.value)return"";const h=t.value.toLowerCase();return h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".gif")?"image/gif":h.endsWith(".webp")?"image/webp":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".bmp")?"image/bmp":h.endsWith(".ico")?"image/x-icon":"image/png"}),g=_(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),k=_(()=>d.value||!g.value||u.value?[]:g.value.split(`
`)),$=_(()=>k.value.length),b=_(()=>$.value>Ss),m=_(()=>d.value||u.value?"":k.value.slice(0,Ss).join(`
`));return(h,v)=>(a(),l("div",Ra,[s("div",Wa,[s("div",Ba,[s("span",Fa,y(f.value?"ðŸ–¼ï¸":"ðŸ“„"),1),v[0]||(v[0]=s("strong",null,"Reading:",-1)),s("code",Ha,y(t.value),1),i.value?(a(),l("span",Va,"Lines "+y(r.value)+"-"+y(c.value),1)):A("",!0)])]),p.value?(a(),l("div",Ua,[d.value?(a(),l("div",qa,[s("pre",za,y(g.value),1)])):u.value?(a(),l("div",Ka,[s("div",Ga,[v[1]||(v[1]=s("span",{class:"content-label"},"Image Preview:",-1)),s("span",Ya,y(w.value),1)]),s("div",Ja,[s("img",{src:`data:${w.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,Qa)])])):(a(),l("div",Xa,[s("div",Za,[v[2]||(v[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",er,y($.value)+" lines",1),b.value?(a(),l("span",tr,"(showing first "+y(Ss)+")")):A("",!0)]),s("pre",sr,y(m.value),1),b.value?(a(),l("div",nr,"...")):A("",!0)]))])):A("",!0)]))}},ir=ne(or,[["__scopeId","data-v-29b774b1"]]),ar={class:"write-tool-handler"},rr={class:"tool-section"},lr={class:"write-file-info mb-2"},cr={class:"file-path"},ur={class:"write-content-preview"},dr={class:"content-header"},mr={class:"line-count-badge"},pr={key:0,class:"preview-note"},fr={class:"tool-code content-display"},vr={key:0,class:"more-indicator"},hr={key:0,class:"tool-section"},_r={key:0,class:"tool-result tool-result-error"},gr={class:"tool-code"},br={key:1,class:"tool-result tool-result-success"},yr={class:"success-message"},Es=100,wr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.content||""),i=_(()=>o.value.split(`
`)),r=_(()=>i.value.length),c=_(()=>r.value>Es),f=_(()=>i.value.slice(0,Es).join(`
`)),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>{if(!p.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,g)=>(a(),l("div",ar,[s("div",rr,[s("div",lr,[g[0]||(g[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=s("strong",null,"Writing:",-1)),s("code",cr,y(t.value),1)]),s("div",ur,[s("div",dr,[g[2]||(g[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",mr,y(r.value)+" lines",1),c.value?(a(),l("span",pr,"(showing first "+y(Es)+")")):A("",!0)]),s("pre",fr,y(f.value),1),c.value?(a(),l("div",vr,"...")):A("",!0)])]),p.value?(a(),l("div",hr,[d.value?(a(),l("div",_r,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",gr,y(u.value),1)])):(a(),l("div",br,[s("div",yr,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+y(r.value)+" lines written)",1)])]))])):A("",!0)]))}},$r=ne(wr,[["__scopeId","data-v-ddc24a0f"]]),kr={class:"bash-tool-handler"},Sr={class:"tool-section"},Er={class:"bash-header"},Cr={class:"bash-header-content"},Tr={key:0,class:"bash-description"},xr={key:1,class:"bash-flags"},Ar={class:"bash-command-section"},Mr={class:"bash-command-content"},Or={key:0,class:"tool-section"},Dr={key:0,class:"bash-output"},Nr={key:1,class:"bash-output-empty"},Lr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.command||""),o=_(()=>e.toolCall.input?.description||""),i=_(()=>e.toolCall.input?.timeout),r=_(()=>e.toolCall.input?.run_in_background||!1),c=_(()=>i.value||r.value),f=_(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),r.value&&g.push("background"),g.join(", ")}),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>d.value?"tool-result-error":"tool-result-success"),w=_(()=>{if(!p.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),l("div",kr,[s("div",Sr,[s("div",Er,[k[1]||(k[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",Cr,[o.value?(a(),l("div",Tr,[k[0]||(k[0]=s("strong",null,"Description:",-1)),ie(" "+y(o.value),1)])):A("",!0),c.value?(a(),l("div",xr,y(f.value),1)):A("",!0)])]),s("div",Ar,[k[2]||(k[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",Mr,y(t.value),1)])]),p.value?(a(),l("div",Or,[s("div",{class:se(["tool-result",u.value])},[k[3]||(k[3]=s("strong",null,"Output:",-1)),w.value?(a(),l("pre",Dr,y(w.value),1)):(a(),l("div",Nr,"No output"))],2)])):A("",!0)]))}},Ir=ne(Lr,[["__scopeId","data-v-ab50fe73"]]),jr={class:"todo-tool-handler"},Pr={class:"tool-section"},Rr={class:"todo-header"},Wr={class:"todo-summary"},Br={key:0,class:"todo-count todo-count-completed"},Fr={key:1,class:"todo-count todo-count-in-progress"},Hr={key:2,class:"todo-count todo-count-pending"},Vr={class:"todo-checklist"},Ur={class:"todo-checkbox"},qr={class:"todo-content"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Yr={key:1,class:"tool-result tool-result-success"},Jr={class:"success-message"},Qr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.todos||[]),o=_(()=>t.value.filter(u=>u.status==="completed").length),i=_(()=>t.value.filter(u=>u.status==="in_progress").length),r=_(()=>t.value.filter(u=>u.status==="pending").length);function c(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const f=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!f.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,w)=>(a(),l("div",jr,[s("div",Pr,[s("div",Rr,[w[0]||(w[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=s("strong",null,"Task List:",-1)),s("div",Wr,[o.value>0?(a(),l("span",Br,y(o.value)+" completed ",1)):A("",!0),i.value>0?(a(),l("span",Fr,y(i.value)+" in progress ",1)):A("",!0),r.value>0?(a(),l("span",Hr,y(r.value)+" pending ",1)):A("",!0)])]),s("div",Vr,[(a(!0),l(re,null,ce(t.value,(g,k)=>(a(),l("div",{key:k,class:se(["todo-item",`todo-${g.status}`])},[s("span",Ur,y(c(g.status)),1),s("span",qr,y(g.content),1)],2))),128))])]),f.value?(a(),l("div",zr,[p.value?(a(),l("div",Kr,[w[2]||(w[2]=s("strong",null,"Error:",-1)),s("pre",Gr,y(d.value),1)])):(a(),l("div",Yr,[s("div",Jr,[w[3]||(w[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+y(t.value.length)+" tasks)",1)])]))])):A("",!0)]))}},Xr=ne(Qr,[["__scopeId","data-v-bbe55ee7"]]),Zr={class:"edit-tool-handler"},el={class:"tool-section"},tl={class:"edit-file-info"},sl={class:"file-path"},nl={key:0,class:"replace-all-badge"},ol={class:"edit-diff-container"},il={class:"diff-header"},al={class:"diff-stats"},rl={class:"stat-removed"},ll={class:"stat-added"},cl={class:"unified-diff"},ul={class:"diff-scroll-container"},dl={class:"diff-marker"},ml={class:"diff-content"},pl={key:0,class:"tool-section"},fl={key:0,class:"tool-result tool-result-error"},vl={class:"tool-code"},hl={key:1,class:"tool-result tool-result-success"},_l={class:"success-message"},gl={key:0,class:"success-detail"},bl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.old_string||""),i=_(()=>e.toolCall.input?.new_string||""),r=_(()=>e.toolCall.input?.replace_all||!1),c=_(()=>{const k=Ni(t.value,o.value,i.value,"","",{context:3}).split(`
`),$=[];for(let b=4;b<k.length;b++){const m=k[b];m&&(m.startsWith("-")?$.push({type:"removed",content:m.substring(1)}):m.startsWith("+")?$.push({type:"added",content:m.substring(1)}):m.startsWith(" ")?$.push({type:"context",content:m.substring(1)}):m.startsWith("@@")&&$.push({type:"hunk",content:m}))}return $}),f=_(()=>c.value.filter(g=>g.type==="removed").length),p=_(()=>c.value.filter(g=>g.type==="added").length),d=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!d.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),l("div",Zr,[s("div",el,[s("div",tl,[k[0]||(k[0]=s("span",{class:"file-icon"},"âœï¸",-1)),k[1]||(k[1]=s("strong",null,"Editing:",-1)),s("code",sl,y(t.value),1),r.value?(a(),l("span",nl,"Replace All")):A("",!0)]),s("div",ol,[s("div",il,[k[2]||(k[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",al,[s("span",rl,"-"+y(f.value),1),s("span",ll,"+"+y(p.value),1)])]),s("div",cl,[s("div",ul,[(a(!0),l(re,null,ce(c.value,($,b)=>(a(),l("div",{key:b,class:se(["diff-line",{"diff-line-removed":$.type==="removed","diff-line-added":$.type==="added","diff-line-context":$.type==="context","diff-line-hunk":$.type==="hunk"}])},[s("span",dl,y($.type==="removed"?"-":$.type==="added"?"+":$.type==="hunk"?"@":" "),1),s("span",ml,y($.content),1)],2))),128))])])])]),d.value?(a(),l("div",pl,[u.value?(a(),l("div",fl,[k[3]||(k[3]=s("strong",null,"Error:",-1)),s("pre",vl,y(w.value),1)])):(a(),l("div",hl,[s("div",_l,[k[4]||(k[4]=s("span",{class:"success-icon"},"âœ…",-1)),k[5]||(k[5]=s("strong",null,"File edited successfully",-1)),r.value?(a(),l("span",gl,"(all occurrences replaced)")):A("",!0)])]))])):A("",!0)]))}},yl=ne(bl,[["__scopeId","data-v-dd74055e"]]),wl={class:"search-tool-handler"},$l={class:"tool-section"},kl={class:"search-info"},Sl={class:"search-icon"},El={class:"search-pattern"},Cl={key:0,class:"search-path"},Tl={key:1,class:"search-filters"},xl={key:0,class:"filter-badge"},Al={key:1,class:"filter-badge"},Ml={key:2,class:"filter-badge"},Ol={key:0,class:"tool-section"},Dl={key:0,class:"tool-result tool-result-error"},Nl={class:"tool-code"},Ll={key:1,class:"search-results"},Il={class:"results-header"},jl={class:"results-label"},Pl={class:"results-count-badge"},Rl={class:"results-content"},Wl={class:"tool-code"},Bl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.name==="Grep"),o=_(()=>e.toolCall.input?.pattern||"Unknown"),i=_(()=>e.toolCall.input?.path||null),r=_(()=>e.toolCall.input?.type||null),c=_(()=>e.toolCall.input?.glob||null),f=_(()=>e.toolCall.input?.["-i"]||!1),p=_(()=>r.value||c.value||f.value),d=_(()=>t.value?"ðŸ”":"ðŸ“"),u=_(()=>t.value?"Searching content":"Finding files"),w=_(()=>t.value?"Matches":"Files found"),g=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=_(()=>{if(!g.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),b=_(()=>!g.value||k.value||!$.value?0:$.value.split(`
`).filter(h=>h.trim()).length);return(m,h)=>(a(),l("div",wl,[s("div",$l,[s("div",kl,[s("span",Sl,y(d.value),1),s("strong",null,y(u.value)+":",1),s("code",El,y(o.value),1),i.value?(a(),l("span",Cl,"in "+y(i.value),1)):A("",!0),p.value?(a(),l("span",Tl,[r.value?(a(),l("span",xl,"type: "+y(r.value),1)):A("",!0),c.value?(a(),l("span",Al,"glob: "+y(c.value),1)):A("",!0),f.value?(a(),l("span",Ml,"case-insensitive")):A("",!0)])):A("",!0)])]),g.value?(a(),l("div",Ol,[k.value?(a(),l("div",Dl,[h[0]||(h[0]=s("strong",null,"Error:",-1)),s("pre",Nl,y($.value),1)])):(a(),l("div",Ll,[s("div",Il,[s("span",jl,y(w.value)+":",1),s("span",Pl,y(b.value)+" "+y(b.value===1?"match":"matches"),1)]),s("div",Rl,[s("pre",Wl,y($.value),1)])]))])):A("",!0)]))}},$n=ne(Bl,[["__scopeId","data-v-0d272c39"]]),Fl={class:"web-tool-handler"},Hl={class:"tool-section"},Vl={class:"web-info"},Ul={class:"web-icon"},ql=["href"],zl={key:1,class:"web-query"},Kl={key:0,class:"web-prompt-container"},Gl={class:"prompt-content"},Yl={key:1,class:"web-domains"},Jl={class:"domains-label"},Ql={key:0,class:"tool-section"},Xl={key:0,class:"tool-result tool-result-error"},Zl={class:"tool-code"},ec={key:1,class:"web-results"},tc={class:"results-header"},sc={class:"results-label"},nc={class:"results-content"},oc={class:"tool-code"},ic={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.name==="WebFetch"),o=_(()=>e.toolCall.input?.url||null),i=_(()=>e.toolCall.input?.query||null),r=_(()=>e.toolCall.input?.prompt||null),c=_(()=>e.toolCall.input?.allowed_domains||[]),f=_(()=>e.toolCall.input?.blocked_domains||[]),p=_(()=>c.value.length>0?c.value:f.value.length>0?f.value:[]),d=_(()=>c.value.length>0?"Allowed domains":f.value.length>0?"Blocked domains":"Domains"),u=_(()=>t.value?"ðŸŒ":"ðŸ”Ž"),w=_(()=>t.value?"Fetching URL":"Searching web"),g=_(()=>t.value?"Fetched content":"Search results"),k=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=_(()=>{if(!k.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,h)=>(a(),l("div",Fl,[s("div",Hl,[s("div",Vl,[s("span",Ul,y(u.value),1),s("strong",null,y(w.value)+":",1),o.value?(a(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,ql)):i.value?(a(),l("code",zl,y(i.value),1)):A("",!0)]),r.value?(a(),l("div",Kl,[h[0]||(h[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Gl,y(r.value),1)])):A("",!0),p.value.length>0?(a(),l("div",Yl,[s("span",Jl,y(d.value)+":",1),(a(!0),l(re,null,ce(p.value,v=>(a(),l("span",{key:v,class:"domain-badge"},y(v),1))),128))])):A("",!0)]),k.value?(a(),l("div",Ql,[$.value?(a(),l("div",Xl,[h[1]||(h[1]=s("strong",null,"Error:",-1)),s("pre",Zl,y(b.value),1)])):(a(),l("div",ec,[s("div",tc,[s("span",sc,y(g.value)+":",1)]),s("div",nc,[s("pre",oc,y(b.value),1)])]))])):A("",!0)]))}},kn=ne(ic,[["__scopeId","data-v-62b55b55"]]),ac={class:"task-tool-handler"},rc={class:"tool-section"},lc={class:"task-header"},cc={key:0,class:"agent-type-badge"},uc={key:0,class:"task-description"},dc={class:"description-content"},mc={key:1,class:"task-prompt-container"},pc={class:"prompt-header"},fc={class:"prompt-length"},vc={class:"prompt-code"},hc={key:0,class:"tool-section"},_c={key:0,class:"tool-result tool-result-error"},gc={class:"tool-code"},bc={key:1,class:"agent-output"},yc={class:"output-header"},wc={key:0,class:"output-count-badge"},$c={class:"output-content"},kc={class:"tool-code"},Sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.description||null),o=_(()=>e.toolCall.input?.prompt||null),i=_(()=>e.toolCall.input?.subagent_type||null),r=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!r.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),p=_(()=>f.value?f.value.split(`
`).length:0);return(d,u)=>(a(),l("div",ac,[s("div",rc,[s("div",lc,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=s("strong",null,"Agent Task:",-1)),i.value?(a(),l("span",cc,y(i.value),1)):A("",!0)]),t.value?(a(),l("div",uc,[u[2]||(u[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",dc,y(t.value),1)])):A("",!0),o.value?(a(),l("div",mc,[s("div",pc,[u[3]||(u[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",fc,y(o.value.length)+" characters",1)]),s("pre",vc,y(o.value),1)])):A("",!0)]),r.value?(a(),l("div",hc,[c.value?(a(),l("div",_c,[u[4]||(u[4]=s("strong",null,"Error:",-1)),s("pre",gc,y(f.value),1)])):(a(),l("div",bc,[s("div",yc,[u[5]||(u[5]=s("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(a(),l("span",wc,y(p.value)+" lines",1)):A("",!0)]),s("div",$c,[s("pre",kc,y(f.value),1)])]))])):A("",!0)]))}},Ec=ne(Sc,[["__scopeId","data-v-c520c244"]]),Cc={class:"task-create-tool-handler"},Tc={class:"tool-section"},xc={class:"task-details p-2"},Ac={key:0,class:"task-field mb-2"},Mc={class:"field-value subject-value"},Oc={key:1,class:"task-field mb-2"},Dc={class:"field-value description-value"},Nc={key:2,class:"task-field"},Lc={class:"field-value active-form-value"},Ic={key:0,class:"tool-section mt-2"},jc={key:0,class:"tool-result tool-result-error"},Pc={class:"tool-code"},Rc={key:1,class:"tool-result tool-result-success"},Wc={class:"result-text"},Bc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.subject||null),o=_(()=>e.toolCall.input?.description||null),i=_(()=>e.toolCall.input?.activeForm||null),r=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!r.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,d)=>(a(),l("div",Cc,[s("div",Tc,[d[3]||(d[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",xc,[t.value?(a(),l("div",Ac,[d[0]||(d[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Mc,y(t.value),1)])):A("",!0),o.value?(a(),l("div",Oc,[d[1]||(d[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",Dc,y(o.value),1)])):A("",!0),i.value?(a(),l("div",Nc,[d[2]||(d[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Lc,y(i.value),1)])):A("",!0)])]),r.value?(a(),l("div",Ic,[c.value?(a(),l("div",jc,[d[4]||(d[4]=s("strong",null,"Error:",-1)),s("pre",Pc,y(f.value),1)])):(a(),l("div",Rc,[d[5]||(d[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Wc,y(f.value),1)]))])):A("",!0)]))}},Fc=ne(Bc,[["__scopeId","data-v-474dd444"]]),Hc={class:"task-update-tool-handler"},Vc={class:"tool-section"},Uc={class:"task-header"},qc={key:0,class:"task-id-badge"},zc={class:"task-details p-2"},Kc={key:0,class:"task-field mb-2"},Gc={key:1,class:"task-field mb-2"},Yc={class:"field-value"},Jc={key:2,class:"task-field mb-2"},Qc={class:"field-value description-value"},Xc={key:3,class:"task-field mb-2"},Zc={class:"field-value active-form-value"},eu={key:4,class:"task-field mb-2"},tu={class:"field-value"},su={key:5,class:"task-field mb-2"},nu={class:"field-value"},ou={key:6,class:"task-field"},iu={class:"field-value"},au={key:0,class:"tool-section mt-2"},ru={key:0,class:"tool-result tool-result-error"},lu={class:"tool-code"},cu={key:1,class:"tool-result tool-result-success"},uu={class:"result-text"},du={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.input?.status||null),i=_(()=>e.toolCall.input?.subject||null),r=_(()=>e.toolCall.input?.description||null),c=_(()=>e.toolCall.input?.activeForm||null),f=_(()=>e.toolCall.input?.owner||null),p=_(()=>e.toolCall.input?.addBlockedBy||[]),d=_(()=>e.toolCall.input?.addBlocks||[]),u=_(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=_(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=_(()=>{if(!g.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,m)=>(a(),l("div",Hc,[s("div",Vc,[s("div",Uc,[m[0]||(m[0]=s("span",{class:"task-icon"},"âœï¸",-1)),m[1]||(m[1]=s("strong",null,"Update Task",-1)),t.value?(a(),l("span",qc,"#"+y(t.value),1)):A("",!0)]),s("div",zc,[o.value?(a(),l("div",Kc,[m[2]||(m[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:se(["field-value status-value",w.value])},y(u.value)+" "+y(o.value),3)])):A("",!0),i.value?(a(),l("div",Gc,[m[3]||(m[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Yc,y(i.value),1)])):A("",!0),r.value?(a(),l("div",Jc,[m[4]||(m[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",Qc,y(r.value),1)])):A("",!0),c.value?(a(),l("div",Xc,[m[5]||(m[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Zc,y(c.value),1)])):A("",!0),f.value?(a(),l("div",eu,[m[6]||(m[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",tu,y(f.value),1)])):A("",!0),p.value?.length?(a(),l("div",su,[m[7]||(m[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",nu,[(a(!0),l(re,null,ce(p.value,h=>(a(),l("span",{key:h,class:"badge bg-warning text-dark me-1"},"#"+y(h),1))),128))])])):A("",!0),d.value?.length?(a(),l("div",ou,[m[8]||(m[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",iu,[(a(!0),l(re,null,ce(d.value,h=>(a(),l("span",{key:h,class:"badge bg-info text-dark me-1"},"#"+y(h),1))),128))])])):A("",!0)])]),g.value?(a(),l("div",au,[k.value?(a(),l("div",ru,[m[9]||(m[9]=s("strong",null,"Error:",-1)),s("pre",lu,y($.value),1)])):(a(),l("div",cu,[m[10]||(m[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",uu,y($.value),1)]))])):A("",!0)]))}},mu=ne(du,[["__scopeId","data-v-35582330"]]),pu={class:"task-list-tool-handler"},fu={key:0,class:"tool-section"},vu={key:0,class:"tool-result tool-result-error"},hu={class:"tool-code"},_u={key:1,class:"task-list-result"},gu={key:0,class:"parsed-tasks"},bu={class:"status-icon"},yu={class:"task-id text-muted"},wu={class:"task-subject flex-grow-1"},$u={key:0,class:"task-owner badge bg-secondary"},ku={key:1,class:"raw-result p-2"},Su={class:"tool-code"},Eu={key:1,class:"tool-section"},Cu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=_(()=>{if(!t.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),r=_(()=>{if(!i.value)return[];const f=[],d=i.value.split(`
`);for(const u of d){const w=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const g=w[2].toLowerCase();f.push({id:w[1],status:g,subject:w[3].trim(),owner:null,statusIcon:c(g)})}}return f});function c(f){switch(f){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(f,p)=>(a(),l("div",pu,[p[2]||(p[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(a(),l("div",fu,[o.value?(a(),l("div",vu,[p[0]||(p[0]=s("strong",null,"Error:",-1)),s("pre",hu,y(i.value),1)])):(a(),l("div",_u,[r.value.length>0?(a(),l("div",gu,[(a(!0),l(re,null,ce(r.value,(d,u)=>(a(),l("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",bu,y(d.statusIcon),1),s("span",yu,"#"+y(d.id),1),s("span",wu,y(d.subject),1),d.owner?(a(),l("span",$u,y(d.owner),1)):A("",!0)]))),128))])):(a(),l("div",ku,[s("pre",Su,y(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),l("div",Eu,[...p[1]||(p[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):A("",!0)]))}},Tu=ne(Cu,[["__scopeId","data-v-4e79ba4b"]]),xu={class:"task-get-tool-handler"},Au={class:"tool-section"},Mu={class:"task-header"},Ou={key:0,class:"task-id-badge"},Du={key:0,class:"tool-section"},Nu={key:0,class:"tool-result tool-result-error"},Lu={class:"tool-code"},Iu={key:1,class:"task-details-result p-2"},ju={key:0,class:"parsed-task"},Pu={class:"task-field mb-2"},Ru={class:"field-value subject-value"},Wu={key:0,class:"task-field mb-2"},Bu={key:1,class:"task-field mb-2"},Fu={class:"field-value description-value"},Hu={key:2,class:"task-field mb-2"},Vu={class:"field-value"},Uu={key:3,class:"task-field mb-2"},qu={class:"field-value"},zu={key:4,class:"task-field"},Ku={class:"field-value"},Gu={key:1,class:"raw-result"},Yu={class:"tool-code"},Ju={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=_(()=>{if(!o.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),c=_(()=>{if(!r.value)return null;const d=r.value;try{const g=JSON.parse(d);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const u=d.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of u){const k=g.match(/^Subject:\s*(.+)$/i);k&&(w.subject=k[1].trim());const $=g.match(/^Status:\s*(.+)$/i);$&&(w.status=$[1].trim());const b=g.match(/^Description:\s*(.+)$/i);b&&(w.description=b[1].trim());const m=g.match(/^Owner:\s*(.+)$/i);m&&(w.owner=m[1].trim())}return w.subject?w:null}),f=_(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),p=_(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(d,u)=>(a(),l("div",xu,[s("div",Au,[s("div",Mu,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=s("strong",null,"Get Task",-1)),t.value?(a(),l("span",Ou,"#"+y(t.value),1)):A("",!0)])]),o.value?(a(),l("div",Du,[i.value?(a(),l("div",Nu,[u[2]||(u[2]=s("strong",null,"Error:",-1)),s("pre",Lu,y(r.value),1)])):(a(),l("div",Iu,[c.value?(a(),l("div",ju,[s("div",Pu,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Ru,y(c.value.subject),1)]),c.value.status?(a(),l("div",Wu,[u[4]||(u[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:se(["field-value",p.value])},y(f.value)+" "+y(c.value.status),3)])):A("",!0),c.value.description?(a(),l("div",Bu,[u[5]||(u[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",Fu,y(c.value.description),1)])):A("",!0),c.value.owner?(a(),l("div",Hu,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",Vu,y(c.value.owner),1)])):A("",!0),c.value.blockedBy?.length?(a(),l("div",Uu,[u[7]||(u[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",qu,[(a(!0),l(re,null,ce(c.value.blockedBy,w=>(a(),l("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):A("",!0),c.value.blocks?.length?(a(),l("div",zu,[u[8]||(u[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Ku,[(a(!0),l(re,null,ce(c.value.blocks,w=>(a(),l("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):A("",!0)])):(a(),l("div",Gu,[s("pre",Yu,y(r.value),1)]))]))])):A("",!0)]))}},Qu=ne(Ju,[["__scopeId","data-v-a80d14da"]]),Xu={class:"notebook-edit-tool-handler"},Zu={class:"tool-section"},ed={class:"notebook-info"},td={class:"file-path"},sd={class:"cell-info mt-2"},nd={class:"info-row"},od={class:"info-row"},id={key:0,class:"info-row"},ad={class:"badge bg-info"},rd={key:0,class:"source-preview mt-3"},ld={class:"preview-header"},cd={class:"preview-stats"},ud={class:"source-code"},dd={key:0,class:"tool-section"},md={key:0},pd={key:1,class:"text-danger"},fd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.notebook_path||"Unknown"),o=_(()=>e.toolCall.input?.cell_id),i=_(()=>e.toolCall.input?.cell_type||"code"),r=_(()=>e.toolCall.input?.edit_mode||"replace"),c=_(()=>e.toolCall.input?.new_source||""),f=_(()=>c.value.split(`
`).length),p=_(()=>i.value==="code"?"bg-primary":"bg-secondary"),d=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=r.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,g)=>(a(),l("div",Xu,[s("div",Zu,[s("div",ed,[g[0]||(g[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=s("strong",null,"Notebook:",-1)),s("code",td,y(t.value),1)]),s("div",sd,[s("div",nd,[g[2]||(g[2]=s("strong",null,"Cell ID:",-1)),s("code",null,y(o.value||"N/A"),1)]),s("div",od,[g[3]||(g[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:se(["badge",p.value])},y(i.value),3)]),r.value?(a(),l("div",id,[g[4]||(g[4]=s("strong",null,"Edit Mode:",-1)),s("span",ad,y(r.value),1)])):A("",!0)]),c.value?(a(),l("div",rd,[s("div",ld,[g[5]||(g[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",cd,y(f.value)+" lines",1)]),s("pre",ud,[s("code",null,y(c.value),1)])])):A("",!0)]),n.toolCall.result?(a(),l("div",dd,[g[6]||(g[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:se(["tool-result",d.value])},[n.toolCall.result.success!==!1?(a(),l("div",md," âœ… "+y(u.value),1)):(a(),l("div",pd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):A("",!0)]))}},vd=ne(fd,[["__scopeId","data-v-c81a9bcf"]]),hd={class:"shell-tool-handler"},_d={class:"tool-section"},gd={class:"shell-info"},bd={class:"shell-icon"},yd={key:0,class:"shell-id"},wd={key:0,class:"filter-info mt-2"},$d={class:"filter-pattern"},kd={key:0,class:"tool-section"},Sd={class:"result-header mb-2"},Ed={key:0,class:"mb-2"},Cd={class:"shell-output"},Td={key:1,class:"mb-2"},xd={class:"shell-output shell-output-error"},Ad={key:0},Md={key:1,class:"text-danger"},Od={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=_(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=_(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=_(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=_(()=>e.toolCall.input?.filter);function f(k,$){if(!k)return null;const b=new RegExp(`<${$}>([\\s\\S]*?)<\\/${$}>`,"i"),m=k.match(b);return m?m[1].trim():null}const p=_(()=>{const k=e.toolCall.result;if(!k)return null;let $=k;if(k.content&&($=k.content),typeof $=="string")return{status:f($,"status"),stdout:f($,"stdout"),stderr:f($,"stderr"),exit_code:f($,"exit_code")};if(Array.isArray($)){const b=$.find(m=>m.type==="text")?.text||"";return{status:f(b,"status"),stdout:f(b,"stdout"),stderr:f(b,"stderr"),exit_code:f(b,"exit_code")}}return{status:k.status||$.status,stdout:k.stdout||k.output||$.stdout||$.output,stderr:k.stderr||$.stderr,exit_code:k.exit_code||$.exit_code}}),d=_(()=>p.value?.status),u=_(()=>{const k=d.value;return k==="running"?"bg-success":k==="completed"?"bg-secondary":k==="killed"||k==="terminated"?"bg-danger":"bg-info"}),w=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const k=p.value;if(k?.status==="running"&&!k.stdout&&!k.stderr)return"No new output since last check";if(k?.status==="failed")return`Shell failed (exit code ${k.exit_code||"unknown"})`}return"Operation completed"});return(k,$)=>(a(),l("div",hd,[s("div",_d,[s("div",gd,[s("span",bd,y(t.value),1),s("strong",null,y(o.value)+":",1),r.value?(a(),l("code",yd,"Shell "+y(r.value),1)):A("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(a(),l("div",wd,[$[0]||($[0]=s("strong",null,"Filter:",-1)),s("code",$d,y(c.value),1)])):A("",!0)]),n.toolCall.result?(a(),l("div",kd,[s("div",Sd,[s("strong",null,y(i.value)+":",1),d.value?(a(),l("span",{key:0,class:se(["badge",u.value])},y(d.value),3)):A("",!0)]),p.value?.stdout?(a(),l("div",Ed,[$[1]||($[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Cd,[s("pre",null,[s("code",null,y(p.value.stdout),1)])])])):A("",!0),p.value?.stderr?(a(),l("div",Td,[$[2]||($[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",xd,[s("pre",null,[s("code",null,y(p.value.stderr),1)])])])):A("",!0),!p.value?.stdout&&!p.value?.stderr?(a(),l("div",{key:2,class:se(["tool-result",w.value])},[n.toolCall.result.success!==!1?(a(),l("div",Ad," âœ… "+y(g.value),1)):(a(),l("div",Md," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):A("",!0)])):A("",!0)]))}},Sn=ne(Od,[["__scopeId","data-v-86def281"]]),Dd={class:"skill-tool-handler"},Nd={key:0,class:"tool-section"},Ld={class:"d-flex align-items-center gap-2"},Id={class:"text-muted small"},jd={key:0,class:"skill-content-body"},Pd={class:"skill-content-text"},Rd={key:1,class:"tool-section mt-3"},Wd={class:"tool-result tool-result-error"},Bd={class:"tool-code"},Fd={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=R(!1);function r(){i.value=!i.value}const c=_(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let b=null,m=null;for(let h=$+1;h<Math.min($+3,k.length);h++){const v=k[h];if(v.type!=="user")continue;const T=v.content||"";T.includes("<command-message>")&&T.includes("skill is running")?b=v:T.startsWith("Base directory for this skill:")&&(m=v)}return{running:b,content:m}}),f=_(()=>{const g=c.value.content;if(!g)return"";const k=g.content||"",$=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return k.replace($,"").trim()}),p=_(()=>f.value.length>0),d=_(()=>f.value?f.value.split(`
`).length:0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),l("div",Dd,[p.value?(a(),l("div",Nd,[s("div",{class:"skill-content-header",onClick:r},[s("div",Ld,[s("i",{class:se(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),k[0]||(k[0]=s("strong",null,"Skill Content",-1)),s("span",Id,"("+y(d.value)+" lines)",1)])]),i.value?(a(),l("div",jd,[s("pre",Pd,y(f.value),1)])):A("",!0)])):A("",!0),u.value?(a(),l("div",Rd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Wd,[s("pre",Bd,y(w.value),1)])])):A("",!0)]))}},Hd=ne(Fd,[["__scopeId","data-v-0a48ca0f"]]),Vd={class:"slashcommand-tool-handler"},Ud={key:0,class:"tool-section"},qd={class:"d-flex align-items-center gap-2"},zd=["aria-label"],Kd={class:"text-muted small"},Gd={key:0,class:"command-content-body"},Yd={class:"command-content-text"},Jd={key:1,class:"tool-section mt-3"},Qd={class:"tool-result tool-result-error"},Xd={class:"tool-code"},Zd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=R(!1);function r(){i.value=!i.value}const c=_(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let b=null,m=null;for(let h=$+1;h<Math.min($+3,k.length);h++){const v=k[h];if(v.type!=="user")continue;const T=v.content||"";T.includes("<command-message>")&&T.includes("<command-name>")&&T.includes("<command-args>")?b=v:T.includes("ARGUMENTS:")&&(m=v)}return{running:b,content:m}}),f=_(()=>{const g=c.value.content;if(!g)return"";const k=g.content||"",$=/\nARGUMENTS:.*$/s;return k.replace($,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=_(()=>f.value.length>0),d=_(()=>f.value?f.value.split(`
`).length:0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),l("div",Vd,[p.value?(a(),l("div",Ud,[s("div",{class:"command-content-header",onClick:r},[s("div",qd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},y(i.value?"â–¾":"â–¸"),9,zd),k[0]||(k[0]=s("strong",null,"Command Content",-1)),s("span",Kd,"("+y(d.value)+" lines)",1)])]),i.value?(a(),l("div",Gd,[s("pre",Yd,y(f.value),1)])):A("",!0)])):A("",!0),u.value?(a(),l("div",Jd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Qd,[s("pre",Xd,y(w.value),1)])])):A("",!0)]))}},em=ne(Zd,[["__scopeId","data-v-15991acf"]]),tm={class:"exit-plan-mode-tool-handler"},sm={class:"tool-section"},nm={key:0,class:"plan-content mt-2"},om={class:"plan-text"},im={key:0,class:"tool-section"},am={key:0},rm={key:1,class:"text-danger"},lm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.plan),o=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,r)=>(a(),l("div",tm,[s("div",sm,[r[1]||(r[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(a(),l("div",nm,[r[0]||(r[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",om,y(t.value),1)])):A("",!0)]),n.toolCall.result?(a(),l("div",im,[r[2]||(r[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:se(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),l("div",am," âœ… Permission mode reverted to default ")):(a(),l("div",rm," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):A("",!0)]))}},cm=ne(lm,[["__scopeId","data-v-e2e3c781"]]),um={class:"ask-user-question-handler"},dm={key:0,class:"answers-summary"},mm={class:"answer-question text-muted small"},pm={class:"answer-value fw-medium"},fm={key:1,class:"text-muted small"},vm={key:0,class:"questions-container"},hm={class:"question-header d-flex align-items-center gap-2 mb-2"},_m={key:0,class:"badge bg-secondary"},gm={class:"question-text fw-medium"},bm={class:"options-list"},ym=["id","checked","onChange"],wm=["id","name","checked","onChange"],$m=["for"],km={class:"option-label"},Sm={key:0,class:"option-description text-muted d-block small"},Em={class:"option-item form-check other-option"},Cm=["id","checked","onChange"],Tm=["id","name","checked","onChange"],xm=["for"],Am={key:2,class:"other-input mt-2"},Mm=["onUpdate:modelValue","onInput"],Om={key:1,class:"alert alert-info mb-0"},Dm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=_(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=_(()=>{if(!r.value)return{};const E=o.toolCall.result;if(E?.content){if(typeof E.content=="object"&&E.content.answers)return E.content.answers;if(typeof E.content=="string")try{const j=JSON.parse(E.content);if(j.answers)return j.answers}catch{}}const W=o.toolCall.input||{};return W.answers?W.answers:{}}),f=_(()=>Object.keys(c.value).length>0),p=_(()=>(o.toolCall.input||{}).questions||[]),d=R({}),u=R({});fe(p,E=>{E.forEach((W,j)=>{j in d.value||(d.value[j]=W.multiSelect?[]:null),j in u.value||(u.value[j]="")})},{immediate:!0});function w(E,W){const j=d.value[E];return Array.isArray(j)?j.includes(W):j===W}function g(E){const W=d.value[E];return Array.isArray(W)?W.includes("__OTHER__"):W==="__OTHER__"}function k(E,W){d.value[E]=W,v()}function $(E){d.value[E]="__OTHER__",v()}function b(E,W){const j=d.value[E];if(!Array.isArray(j))d.value[E]=[W];else{const M=j.indexOf(W);M===-1?j.push(W):j.splice(M,1)}v()}function m(E){const W=d.value[E];if(!Array.isArray(W))d.value[E]=["__OTHER__"];else{const j=W.indexOf("__OTHER__");j===-1?W.push("__OTHER__"):W.splice(j,1)}v()}function h(E){v()}function v(){const E={};p.value.forEach((W,j)=>{const M=d.value[j],V=W.question;if(W.multiSelect){if(Array.isArray(M)&&M.length>0){const C=M.map(x=>x==="__OTHER__"?u.value[j]||"":x).filter(x=>x);E[V]=C.join(", ")}}else M==="__OTHER__"?E[V]=u.value[j]||"":M&&(E[V]=M)}),i("answer",E)}const T=_(()=>p.value.every((E,W)=>{const j=d.value[W];if(E.multiSelect){if(!Array.isArray(j)||j.length===0||j.includes("__OTHER__")&&!u.value[W])return!1}else if(!j||j==="__OTHER__"&&!u.value[W])return!1;return!0}));return e({allQuestionsAnswered:T,getAnswers:()=>{const E={};return p.value.forEach((W,j)=>{const M=d.value[j],V=W.question;if(W.multiSelect){if(Array.isArray(M)&&M.length>0){const C=M.map(x=>x==="__OTHER__"?u.value[j]||"":x).filter(x=>x);E[V]=C.join(", ")}}else M==="__OTHER__"?E[V]=u.value[j]||"":M&&(E[V]=M)}),E}}),(E,W)=>(a(),l("div",um,[r.value?(a(),l(re,{key:0},[f.value?(a(),l("div",dm,[(a(!0),l(re,null,ce(c.value,(j,M)=>(a(),l("div",{key:M,class:"answer-item mb-2"},[s("div",mm,y(M),1),s("div",pm,y(j),1)]))),128))])):(a(),l("div",fm," No answers recorded. "))],64)):(a(),l(re,{key:1},[p.value.length>0?(a(),l("div",vm,[(a(!0),l(re,null,ce(p.value,(j,M)=>(a(),l("div",{key:M,class:"question-block mb-3"},[s("div",hm,[j.header?(a(),l("span",_m,y(j.header),1)):A("",!0),s("span",gm,y(j.question),1)]),s("div",bm,[(a(!0),l(re,null,ce(j.options,(V,C)=>(a(),l("div",{key:C,class:se(["option-item form-check",{selected:w(M,V.label)}])},[j.multiSelect?(a(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-opt${C}`,checked:w(M,V.label),onChange:x=>b(M,V.label)},null,40,ym)):(a(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-opt${C}`,name:`question-${M}`,checked:w(M,V.label),onChange:x=>k(M,V.label)},null,40,wm)),s("label",{class:"form-check-label",for:`q${M}-opt${C}`},[s("span",km,y(V.label),1),V.description?(a(),l("span",Sm,y(V.description),1)):A("",!0)],8,$m)],2))),128)),s("div",Em,[j.multiSelect?(a(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-other`,checked:g(M),onChange:V=>m(M)},null,40,Cm)):(a(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-other`,name:`question-${M}`,checked:g(M),onChange:V=>$(M)},null,40,Tm)),s("label",{class:"form-check-label",for:`q${M}-other`},[...W[0]||(W[0]=[s("span",{class:"option-label"},"Other",-1)])],8,xm),g(M)?(a(),l("div",Am,[ge(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":V=>u.value[M]=V,placeholder:"Enter your custom answer...",onInput:V=>h()},null,40,Mm),[[We,u.value[M]]])])):A("",!0)])])]))),128))])):(a(),l("div",Om," No questions to display. "))],64))]))}},En=ne(Dm,[["__scopeId","data-v-75ce45b4"]]),Nm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Lm={class:"tool-status-icon"},Im=["title"],jm={class:"d-flex align-items-center gap-2"},Pm={class:"text-muted"},Rm=["aria-label"],Wm={key:0,class:"card-body"},Bm={key:0,class:"alert alert-warning mb-3"},Fm={class:"d-flex align-items-center"},Hm={class:"mb-0 small"},Vm={key:2,class:"permission-prompt mt-3"},Um={class:"question-buttons d-flex gap-2 mt-3"},qm=["disabled"],zm=["disabled"],Km={class:"alert alert-warning mb-3"},Gm={class:"mb-0"},Ym={class:"tool-name"},Jm={key:0,class:"suggestions-section mb-3"},Qm={class:"alert alert-info mb-0"},Xm={class:"suggestion-details p-2 bg-white rounded"},Zm={class:"permission-buttons d-flex gap-2 mb-3"},ep=["disabled"],tp=["disabled"],sp=["disabled"],np={class:"guidance-section mt-3"},op=["disabled"],ip=["disabled"],ap={key:3,class:"mt-3"},rp={class:"alert alert-warning mb-0"},lp={class:"d-flex align-items-center"},cp={class:"mb-0 small"},up={key:4,class:"tool-section"},dp={class:"alert alert-danger mb-0"},mp={key:0},pp={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=nt(),r=R(!1),c=R(null),f=R(""),p=R(null),d=R({}),u=_(()=>e.toolCall.name==="AskUserQuestion"),w=_(()=>!u.value||!p.value?!1:p.value.allQuestionsAnswered);function g(D){d.value=D}async function k(){if(!r.value&&p.value){r.value=!0,c.value="submit-answers";try{const D=o.currentSessionId,S=p.value.getAnswers(),I={questions:e.toolCall.input?.questions||[],answers:S};D&&(t.updateToolCall(D,e.toolCall.id,{input:I}),t.handlePermissionResponse(D,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",I)}catch(D){console.error("Failed to submit question answers:",D)}finally{r.value=!1,c.value=null}}}const $=_(()=>e.toolCall.backendStatus==="interrupted"?!0:t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),b=_(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),m=_(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),h=_(()=>{if(e.toolCall.backendStatus){const D=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[D]||D}if(m.value){const D=m.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[D]||D}return e.toolCall.status}),v={Read:ir,Write:$r,Bash:Ir,TodoWrite:Xr,Edit:yl,Grep:$n,Glob:$n,WebFetch:kn,WebSearch:kn,Task:Ec,TaskCreate:Fc,TaskUpdate:mu,TaskList:Tu,TaskGet:Qu,NotebookEdit:vd,BashOutput:Sn,KillShell:Sn,SlashCommand:em,Skill:Hd,ExitPlanMode:cm,AskUserQuestion:En},T=_(()=>{const D=e.toolCall.name;return v[D]?v[D]:Pa}),E=_(()=>{const D=[];if($.value)return D.push("border-warning"),D.join(" ");switch(h.value){case"pending":D.push("border-secondary");break;case"permission_required":D.push("border-warning");break;case"executing":D.push("border-primary");break;case"completed":M.value||e.toolCall.permissionDecision==="deny"?D.push("border-danger"):D.push("border-success");break;case"error":D.push("border-danger");break}return D.join(" ")}),W=_(()=>{if($.value)return"â¹ï¸";switch(h.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":M.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),j=_(()=>Ht(e.toolCall.timestamp)),M=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),V=_(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function C(D){if(!D)return"";const S=D.replace(/\\/g,"/").split("/");return S[S.length-1]}function x(D){if(!D)return"";const S=D.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return S?S[1]:D}function B(D,S=200){return D?D.length<=S?D:D.substring(0,S)+"...":""}function G(D){if(!D)return null;if(D.content){const S=D.content.match(/exit code (\d+)/i);if(S)return parseInt(S[1])}return D.error?1:0}function L(D,S){const I=D?D.split(`
`).length:0;return{added:S?S.split(`
`).length:0,removed:I}}const F=_(()=>{const D=e.toolCall.name,S=e.toolCall.input||{},I=e.toolCall.result,z=h.value;switch(D){case"Bash":case"Shell":case"Command":{const J=x(S.command),K=B(J,200);if(z==="completed"&&I){const te=G(I);return`Bash: ${K} (exit ${te})`}return`Bash: ${K}`}case"SlashCommand":{const J=B(S.command,200);return z==="completed"&&I?`SlashCommand: ${J}`:`SlashCommand: ${J}`}case"Edit":{const J=C(S.file_path);if(z==="completed"&&I&&!I.error){const{added:K,removed:te}=L(S.old_string,S.new_string);return K===te?`Edit: ${J} (${K} lines changed)`:`Edit: ${J} (${K} lines added, ${te} removed)`}return`Edit: ${J}`}case"Read":{const J=C(S.file_path);if(S.offset!==void 0||S.limit!==void 0){const te=(S.offset||0)+1,X=S.limit?(S.offset||0)+S.limit:"âˆž";return`Read: ${J} (lines ${te}-${X})`}return`Read: ${J} (full file)`}case"Write":{const J=C(S.file_path);if(z==="completed"&&I&&!I.error&&S.content){const K=S.content.split(`
`).length;return`Write: ${J} (${K} lines written)`}return`Write: ${J}`}case"Skill":{const J=S.skill||"Unknown";return z==="completed"&&I?I.error?`Skill: ${J} (error)`:`Skill: ${J} (completed)`:`Skill: ${J}`}case"Task":{const J=S.subagent_type||"general",K=S.description||"Task";return z==="completed"&&I?I.error?`Task: (${J}) ${K} (error)`:`Task: (${J}) ${K} (completed)`:`Task: (${J}) ${K}`}case"TodoWrite":{if(S.todos&&Array.isArray(S.todos)){const J=S.todos.filter(X=>X.status==="completed").length,K=S.todos.length,te=S.todos.find(X=>X.status==="in_progress");return te?`Todo: Working on "${te.content}"`:`Todo: ${J}/${K} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const J=S.pattern||"",K=D==="Grep"?"Grep":"Glob";if(z==="completed"&&I&&!I.error){let te=0;return I.content&&(te=I.content.split(`
`).filter(H=>H.trim()).length),`${K}: "${J}" (${te} results)`}return`${K}: "${J}"`}case"WebFetch":case"WebSearch":{const J=S.url||S.query||"";if(D==="WebSearch"){const te=S.query||"",X=te.length>50?te.substring(0,50)+"...":te;return z==="completed"&&I?I.error?`Web: ${X} (error)`:`Web: ${X} (success)`:`Web: ${X}`}let K="";try{J&&(K=new URL(J.startsWith("http")?J:`https://${J}`).hostname)}catch{K=J.length>50?J.substring(0,50)+"...":J}return z==="completed"&&I?I.error?`Web: ${K} (error)`:`Web: ${K} (success)`:`Web: ${K||J}`}case"NotebookEdit":{const J=C(S.notebook_path),K=S.cell_number!==void 0?S.cell_number:"?",te=S.edit_mode||"replace";return`NotebookEdit: ${J} cell #${K} (${te})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${S.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${S.shell_id||"unknown"}`;case"AskUserQuestion":{const K=(S.questions||[]).length;return z==="completed"&&I&&!I.error?`AskUserQuestion: ${K} question(s) answered`:z==="permission_required"?`AskUserQuestion: ${K} question(s) awaiting response`:`AskUserQuestion: ${K} question(s)`}case"TaskCreate":{const J=S.subject||"",K=J.length>40?J.substring(0,40)+"...":J;return z==="completed"&&I&&!I.error?`TaskCreate: "${K}" (created)`:`TaskCreate: "${K}"`}case"TaskUpdate":{const J=S.taskId||"?",K=S.status||"";return K?`TaskUpdate: #${J} -> ${K}`:`TaskUpdate: #${J}`}case"TaskList":return z==="completed"&&I&&!I.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const J=S.taskId||"?";return z==="completed"&&I&&!I.error?`TaskGet: #${J} (retrieved)`:`TaskGet: #${J}`}default:return`${D}: executed`}}),q=_(()=>{const D=e.toolCall.name,S=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(D)?S.command||D:["Edit","Read","Write","NotebookEdit"].includes(D)&&(S.file_path||S.notebook_path)||D});function Z(){const D=o.currentSessionId;D&&t.toggleToolExpansion(D,e.toolCall.id)}function O(D){return D.type==="setMode"?`Set permission mode to "${D.mode}"`:D.type==="allow"?`Allow tool: ${D.tool}`:JSON.stringify(D)}async function N(D,S,I=null){if(!r.value){r.value=!0,D==="allow"?c.value=S?"approve-apply":"approve":I?c.value="deny-guidance":c.value="deny";try{const z=o.currentSessionId;if(z){const J=S&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(z,{request_id:e.toolCall.permissionRequestId,decision:D,reasoning:D==="allow"?"User allowed permission":"User denied permission",applied_updates:J})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,D,S,I)}catch(z){console.error("Failed to send permission response:",z)}finally{r.value=!1,c.value=null}}}return(D,S)=>(a(),l("div",{class:se(["tool-call-card card",E.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:Z},[s("div",Nm,[s("span",Lm,y(W.value),1),s("span",{class:"tool-name",title:q.value},y(F.value),9,Im)]),s("div",jm,[s("small",Pm,y(j.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Rm)])]),n.toolCall.isExpanded?(a(),l("div",Wm,[$.value?(a(),l("div",Bm,[s("div",Fm,[S[7]||(S[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[S[6]||(S[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Hm,y(b.value?.message||"Session was terminated"),1)])])])):A("",!0),u.value&&h.value==="permission_required"?A("",!0):(a(),be(po(T.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),h.value==="permission_required"&&!$.value?(a(),l("div",Vm,[u.value?(a(),l(re,{key:0},[S[8]||(S[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),pe(En,{ref_key:"questionHandlerRef",ref:p,toolCall:n.toolCall,onAnswer:g},null,8,["toolCall"]),s("div",Um,[s("button",{class:"btn btn-primary",onClick:k,disabled:r.value||!w.value},y(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,qm),s("button",{class:"btn btn-outline-secondary",onClick:S[0]||(S[0]=I=>N("deny",!1)),disabled:r.value}," Skip Question ",8,zm)])],64)):(a(),l(re,{key:1},[s("div",Km,[S[11]||(S[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Gm,[S[9]||(S[9]=ie("Claude wants to use the ",-1)),s("code",Ym,y(n.toolCall.name),1),S[10]||(S[10]=ie(" tool.",-1))])]),V.value?(a(),l("div",Jm,[s("div",Qm,[S[12]||(S[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),S[13]||(S[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Xm,[(a(!0),l(re,null,ce(n.toolCall.suggestions,(I,z)=>(a(),l("div",{key:z,class:"suggestion-item"},[s("code",null,y(O(I)),1)]))),128))]),S[14]||(S[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):A("",!0),s("div",Zm,[V.value?(a(),l("button",{key:0,class:"btn btn-success",onClick:S[1]||(S[1]=I=>N("allow",!0)),disabled:r.value},y(r.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,ep)):A("",!0),s("button",{class:se(["btn",V.value?"btn-outline-success":"btn-success"]),onClick:S[2]||(S[2]=I=>N("allow",!1)),disabled:r.value},y(r.value&&c.value==="approve"?"â³ Submitting...":V.value?"âœ… Approve Only":"âœ… Approve"),11,tp),s("button",{class:"btn btn-danger",onClick:S[3]||(S[3]=I=>N("deny",!1)),disabled:r.value}," ðŸš« "+y(r.value&&c.value==="deny"?"Submitting...":"Deny"),9,sp)]),s("div",np,[S[15]||(S[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),S[16]||(S[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ge(s("textarea",{"onUpdate:modelValue":S[4]||(S[4]=I=>f.value=I),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:r.value},null,8,op),[[We,f.value]]),f.value.trim()?(a(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:S[5]||(S[5]=I=>N("deny",!1,f.value)),disabled:r.value},y(r.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,ip)):A("",!0)])],64))])):A("",!0),h.value==="permission_required"&&$.value?(a(),l("div",ap,[s("div",rp,[s("div",lp,[S[18]||(S[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[S[17]||(S[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",cp,y(b.value?.message||"Session was terminated before permission could be granted"),1)])])])])):A("",!0),n.toolCall.permissionDecision==="deny"?(a(),l("div",up,[s("div",dp,[S[19]||(S[19]=ie(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),l("span",mp," - "+y(n.toolCall.result.message),1)):A("",!0)])])):A("",!0)])):A("",!0)],2))}},fp=ne(pp,[["__scopeId","data-v-2377ca10"]]);function Cn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function vp(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Tn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function hp(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=vp(t.command),i=Tn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Tn(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=Cn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",r=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Cn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const _p={key:0,class:"tool-timeline-bar"},gp={class:"timeline-container"},bp=["title","onClick","onKeydown"],yp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=Ae(),r=de(),c=_(()=>t.tools.map((k,$)=>({tool:k,originalIndex:$})).sort((k,$)=>{if(k.tool.timestamp&&$.tool.timestamp){const b=new Date(k.tool.timestamp).getTime(),m=new Date($.tool.timestamp).getTime();if(b!==m)return b-m}return k.originalIndex-$.originalIndex}).map(({tool:k})=>k));function f(k){const $=r.currentSessionId;if(!$)return k.status;const b=i.getBackendToolState($,k.id);return b?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[b.state]||b.state:i.isToolUseOrphaned($,k.id)?"orphaned":k.status}function p(k){return k.result?.error||k.status==="error"||k.permissionDecision==="deny"}function d(k){return f(k)==="executing"}function u(k){switch(f(k)){case"completed":return p(k)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w(k){const $=hp(k),b=f(k),m={completed:p(k)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[b]||b;return`${$} [${m}]`}function g(k,$){o("segment-click",{tool:k,index:$})}return(k,$)=>c.value.length>0?(a(),l("div",_p,[s("div",gp,[(a(!0),l(re,null,ce(c.value,(b,m)=>(a(),l("div",{key:b.id,class:se(["timeline-segment",u(b)]),style:{flex:1},title:w(b),onClick:h=>g(b,m),role:"button",tabindex:"0",onKeydown:[qe(h=>g(b,m),["enter"]),qe(ve(h=>g(b,m),["prevent"]),["space"])]},[s("span",{class:se(["segment-inner",{"executing-pulse":d(b)}])},null,2)],42,bp))),128))])])):A("",!0)}},wp=ne(yp,[["__scopeId","data-v-4a85fba6"]]),$p={class:"tool-footer-container"},kp={class:"tool-cards-list"},Sp={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Ae(),o=de(),i=_(()=>e.tools.map((c,f)=>({tool:c,originalIndex:f})).sort((c,f)=>{if(c.tool.timestamp&&f.tool.timestamp){const p=new Date(c.tool.timestamp).getTime(),d=new Date(f.tool.timestamp).getTime();if(p!==d)return p-d}return c.originalIndex-f.originalIndex}).map(({tool:c})=>c));async function r({tool:c}){const f=o.currentSessionId;if(!f)return;t.toggleToolExpansion(f,c.id),await kt();const p=document.querySelector(`[data-tool-id="${c.id}"]`);p&&p.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,f)=>(a(),l("div",$p,[pe(wp,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),s("div",kp,[(a(!0),l(re,null,ce(i.value,p=>(a(),be(fp,{key:p.id,toolCall:p,"data-tool-id":p.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Ep=ne(Sp,[["__scopeId","data-v-527d59ae"]]),Cp={class:"message-row message-row-assistant"},Tp=["title"],xp={class:"message-content-column"},Ap={key:0,class:"thinking-block mb-2"},Mp=["innerHTML"],Op={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ae(),o=de();dt.setOptions({breaks:!0,gfm:!0});const i=_(()=>Ht(e.message.timestamp)),r=_(()=>e.message.metadata?.model||null),c=_(()=>{const $=i.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${$}`}),f=_(()=>{const $=e.message.content||"";return $.trim().length>0&&$!=="Assistant response"}),p=_(()=>{const $=e.message.content||"";let b=dt.parse($);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),cs.sanitize(b)}),d=_(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=_(()=>e.message.metadata?.thinking_content||""),w=_(()=>{const $=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return $||b}),g=_(()=>{const $=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],m=[...$],h=new Set($.map(v=>v.id));for(const v of b)h.has(v.id)||m.push(v);return m}),k=_(()=>{const $=o.currentSessionId;if(!$)return[];const b=t.toolCallsBySession.get($)||[];return g.value.map(m=>{const h=b.find(v=>v.id===m.id);return h||{id:m.id,name:m.name,input:m.input,status:"pending",result:null,timestamp:m.timestamp||e.message.timestamp,isExpanded:!0}})});return($,b)=>(a(),l("div",Cp,[s("div",{class:"message-speaker",title:c.value},[...b[0]||(b[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Tp),s("div",xp,[d.value?(a(),l("div",Ap,[pe(Ea,{thinking:u.value},null,8,["thinking"])])):A("",!0),f.value?(a(),l("div",{key:1,class:"message-text",innerHTML:p.value},null,8,Mp)):A("",!0),w.value?(a(),be(Ep,{key:2,tools:k.value},null,8,["tools"])):A("",!0)])]))}},Dp=ne(Op,[["__scopeId","data-v-2e32f6ef"]]),Np={key:0,class:"message-row message-row-compaction"},Lp=["title"],Ip={class:"message-content-column"},jp={class:"compaction-status-content"},Pp={class:"text-muted ms-auto"},Rp={key:1,class:"message-row message-row-system"},Wp=["title"],Bp={class:"message-content-column"},Fp={class:"system-text"},Hp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>Ht(e.message.timestamp)),o=_(()=>`system
${t.value}`),i=_(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,c)=>i.value?(a(),l("div",Np,[s("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Lp),s("div",Ip,[s("div",jp,[c[1]||(c[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Pp,y(t.value),1)])])])):(a(),l("div",Rp,[s("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Wp),s("div",Bp,[s("span",Fp,y(n.message.content),1)])]))}},xn=ne(Hp,[["__scopeId","data-v-a078178f"]]),Vp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=_(()=>{switch(e.message.type){case"user":return ga;case"assistant":return Dp;case"system":return xn;default:return xn}});return(o,i)=>(a(),be(po(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Up=ne(Vp,[["__scopeId","data-v-11dff525"]]);var ke="top",Me="bottom",Oe="right",Se="left",us="auto",Dt=[ke,Me,Oe,Se],mt="start",Et="end",go="clippingParents",Ys="viewport",bt="popper",bo="reference",Hs=Dt.reduce(function(n,e){return n.concat([e+"-"+mt,e+"-"+Et])},[]),Js=[].concat(Dt,[us]).reduce(function(n,e){return n.concat([e,e+"-"+mt,e+"-"+Et])},[]),yo="beforeRead",wo="read",$o="afterRead",ko="beforeMain",So="main",Eo="afterMain",Co="beforeWrite",To="write",xo="afterWrite",Ao=[yo,wo,$o,ko,So,Eo,Co,To,xo];function Ue(n){return n?(n.nodeName||"").toLowerCase():null}function De(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function pt(n){var e=De(n).Element;return n instanceof e||n instanceof Element}function Ne(n){var e=De(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Qs(n){if(typeof ShadowRoot>"u")return!1;var e=De(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function qp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];!Ne(r)||!Ue(r)||(Object.assign(r.style,o),Object.keys(i).forEach(function(c){var f=i[c];f===!1?r.removeAttribute(c):r.setAttribute(c,f===!0?"":f)}))})}function zp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],r=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),f=c.reduce(function(p,d){return p[d]="",p},{});!Ne(i)||!Ue(i)||(Object.assign(i.style,f),Object.keys(r).forEach(function(p){i.removeAttribute(p)}))})}}const Mo={name:"applyStyles",enabled:!0,phase:"write",fn:qp,effect:zp,requires:["computeStyles"]};function He(n){return n.split("-")[0]}var ut=Math.max,is=Math.min,Ct=Math.round;function Vs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Oo(){return!/^((?!chrome|android).)*safari/i.test(Vs())}function Tt(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,r=1;e&&Ne(n)&&(i=n.offsetWidth>0&&Ct(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&Ct(o.height)/n.offsetHeight||1);var c=pt(n)?De(n):window,f=c.visualViewport,p=!Oo()&&t,d=(o.left+(p&&f?f.offsetLeft:0))/i,u=(o.top+(p&&f?f.offsetTop:0))/r,w=o.width/i,g=o.height/r;return{width:w,height:g,top:u,right:d+w,bottom:u+g,left:d,x:d,y:u}}function Xs(n){var e=Tt(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function Do(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Qs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ye(n){return De(n).getComputedStyle(n)}function Kp(n){return["table","td","th"].indexOf(Ue(n))>=0}function ot(n){return((pt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ds(n){return Ue(n)==="html"?n:n.assignedSlot||n.parentNode||(Qs(n)?n.host:null)||ot(n)}function An(n){return!Ne(n)||Ye(n).position==="fixed"?null:n.offsetParent}function Gp(n){var e=/firefox/i.test(Vs()),t=/Trident/i.test(Vs());if(t&&Ne(n)){var o=Ye(n);if(o.position==="fixed")return null}var i=ds(n);for(Qs(i)&&(i=i.host);Ne(i)&&["html","body"].indexOf(Ue(i))<0;){var r=Ye(i);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return i;i=i.parentNode}return null}function Vt(n){for(var e=De(n),t=An(n);t&&Kp(t)&&Ye(t).position==="static";)t=An(t);return t&&(Ue(t)==="html"||Ue(t)==="body"&&Ye(t).position==="static")?e:t||Gp(n)||e}function Zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wt(n,e,t){return ut(n,is(e,t))}function Yp(n,e,t){var o=Wt(n,e,t);return o>t?t:o}function No(){return{top:0,right:0,bottom:0,left:0}}function Lo(n){return Object.assign({},No(),n)}function Io(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Jp=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Lo(typeof e!="number"?e:Io(e,Dt))};function Qp(n){var e,t=n.state,o=n.name,i=n.options,r=t.elements.arrow,c=t.modifiersData.popperOffsets,f=He(t.placement),p=Zs(f),d=[Se,Oe].indexOf(f)>=0,u=d?"height":"width";if(!(!r||!c)){var w=Jp(i.padding,t),g=Xs(r),k=p==="y"?ke:Se,$=p==="y"?Me:Oe,b=t.rects.reference[u]+t.rects.reference[p]-c[p]-t.rects.popper[u],m=c[p]-t.rects.reference[p],h=Vt(r),v=h?p==="y"?h.clientHeight||0:h.clientWidth||0:0,T=b/2-m/2,E=w[k],W=v-g[u]-w[$],j=v/2-g[u]/2+T,M=Wt(E,j,W),V=p;t.modifiersData[o]=(e={},e[V]=M,e.centerOffset=M-j,e)}}function Xp(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Do(e.elements.popper,i)&&(e.elements.arrow=i))}const jo={name:"arrow",enabled:!0,phase:"main",fn:Qp,effect:Xp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function xt(n){return n.split("-")[1]}var Zp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ef(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Ct(t*i)/i||0,y:Ct(o*i)/i||0}}function Mn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,r=n.variation,c=n.offsets,f=n.position,p=n.gpuAcceleration,d=n.adaptive,u=n.roundOffsets,w=n.isFixed,g=c.x,k=g===void 0?0:g,$=c.y,b=$===void 0?0:$,m=typeof u=="function"?u({x:k,y:b}):{x:k,y:b};k=m.x,b=m.y;var h=c.hasOwnProperty("x"),v=c.hasOwnProperty("y"),T=Se,E=ke,W=window;if(d){var j=Vt(t),M="clientHeight",V="clientWidth";if(j===De(t)&&(j=ot(t),Ye(j).position!=="static"&&f==="absolute"&&(M="scrollHeight",V="scrollWidth")),j=j,i===ke||(i===Se||i===Oe)&&r===Et){E=Me;var C=w&&j===W&&W.visualViewport?W.visualViewport.height:j[M];b-=C-o.height,b*=p?1:-1}if(i===Se||(i===ke||i===Me)&&r===Et){T=Oe;var x=w&&j===W&&W.visualViewport?W.visualViewport.width:j[V];k-=x-o.width,k*=p?1:-1}}var B=Object.assign({position:f},d&&Zp),G=u===!0?ef({x:k,y:b},De(t)):{x:k,y:b};if(k=G.x,b=G.y,p){var L;return Object.assign({},B,(L={},L[E]=v?"0":"",L[T]=h?"0":"",L.transform=(W.devicePixelRatio||1)<=1?"translate("+k+"px, "+b+"px)":"translate3d("+k+"px, "+b+"px, 0)",L))}return Object.assign({},B,(e={},e[E]=v?b+"px":"",e[T]=h?k+"px":"",e.transform="",e))}function tf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,r=t.adaptive,c=r===void 0?!0:r,f=t.roundOffsets,p=f===void 0?!0:f,d={placement:He(e.placement),variation:xt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Mn(Object.assign({},d,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Mn(Object.assign({},d,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Po={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:tf,data:{}};var Yt={passive:!0};function sf(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,r=i===void 0?!0:i,c=o.resize,f=c===void 0?!0:c,p=De(e.elements.popper),d=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&d.forEach(function(u){u.addEventListener("scroll",t.update,Yt)}),f&&p.addEventListener("resize",t.update,Yt),function(){r&&d.forEach(function(u){u.removeEventListener("scroll",t.update,Yt)}),f&&p.removeEventListener("resize",t.update,Yt)}}const Ro={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sf,data:{}};var nf={left:"right",right:"left",bottom:"top",top:"bottom"};function ss(n){return n.replace(/left|right|bottom|top/g,function(e){return nf[e]})}var of={start:"end",end:"start"};function On(n){return n.replace(/start|end/g,function(e){return of[e]})}function en(n){var e=De(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function tn(n){return Tt(ot(n)).left+en(n).scrollLeft}function af(n,e){var t=De(n),o=ot(n),i=t.visualViewport,r=o.clientWidth,c=o.clientHeight,f=0,p=0;if(i){r=i.width,c=i.height;var d=Oo();(d||!d&&e==="fixed")&&(f=i.offsetLeft,p=i.offsetTop)}return{width:r,height:c,x:f+tn(n),y:p}}function rf(n){var e,t=ot(n),o=en(n),i=(e=n.ownerDocument)==null?void 0:e.body,r=ut(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=ut(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),f=-o.scrollLeft+tn(n),p=-o.scrollTop;return Ye(i||t).direction==="rtl"&&(f+=ut(t.clientWidth,i?i.clientWidth:0)-r),{width:r,height:c,x:f,y:p}}function sn(n){var e=Ye(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Wo(n){return["html","body","#document"].indexOf(Ue(n))>=0?n.ownerDocument.body:Ne(n)&&sn(n)?n:Wo(ds(n))}function Bt(n,e){var t;e===void 0&&(e=[]);var o=Wo(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),r=De(o),c=i?[r].concat(r.visualViewport||[],sn(o)?o:[]):o,f=e.concat(c);return i?f:f.concat(Bt(ds(c)))}function Us(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function lf(n,e){var t=Tt(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Dn(n,e,t){return e===Ys?Us(af(n,t)):pt(e)?lf(e,t):Us(rf(ot(n)))}function cf(n){var e=Bt(ds(n)),t=["absolute","fixed"].indexOf(Ye(n).position)>=0,o=t&&Ne(n)?Vt(n):n;return pt(o)?e.filter(function(i){return pt(i)&&Do(i,o)&&Ue(i)!=="body"}):[]}function uf(n,e,t,o){var i=e==="clippingParents"?cf(n):[].concat(e),r=[].concat(i,[t]),c=r[0],f=r.reduce(function(p,d){var u=Dn(n,d,o);return p.top=ut(u.top,p.top),p.right=is(u.right,p.right),p.bottom=is(u.bottom,p.bottom),p.left=ut(u.left,p.left),p},Dn(n,c,o));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function Bo(n){var e=n.reference,t=n.element,o=n.placement,i=o?He(o):null,r=o?xt(o):null,c=e.x+e.width/2-t.width/2,f=e.y+e.height/2-t.height/2,p;switch(i){case ke:p={x:c,y:e.y-t.height};break;case Me:p={x:c,y:e.y+e.height};break;case Oe:p={x:e.x+e.width,y:f};break;case Se:p={x:e.x-t.width,y:f};break;default:p={x:e.x,y:e.y}}var d=i?Zs(i):null;if(d!=null){var u=d==="y"?"height":"width";switch(r){case mt:p[d]=p[d]-(e[u]/2-t[u]/2);break;case Et:p[d]=p[d]+(e[u]/2-t[u]/2);break}}return p}function At(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,r=t.strategy,c=r===void 0?n.strategy:r,f=t.boundary,p=f===void 0?go:f,d=t.rootBoundary,u=d===void 0?Ys:d,w=t.elementContext,g=w===void 0?bt:w,k=t.altBoundary,$=k===void 0?!1:k,b=t.padding,m=b===void 0?0:b,h=Lo(typeof m!="number"?m:Io(m,Dt)),v=g===bt?bo:bt,T=n.rects.popper,E=n.elements[$?v:g],W=uf(pt(E)?E:E.contextElement||ot(n.elements.popper),p,u,c),j=Tt(n.elements.reference),M=Bo({reference:j,element:T,placement:i}),V=Us(Object.assign({},T,M)),C=g===bt?V:j,x={top:W.top-C.top+h.top,bottom:C.bottom-W.bottom+h.bottom,left:W.left-C.left+h.left,right:C.right-W.right+h.right},B=n.modifiersData.offset;if(g===bt&&B){var G=B[i];Object.keys(x).forEach(function(L){var F=[Oe,Me].indexOf(L)>=0?1:-1,q=[ke,Me].indexOf(L)>=0?"y":"x";x[L]+=G[q]*F})}return x}function df(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,r=t.rootBoundary,c=t.padding,f=t.flipVariations,p=t.allowedAutoPlacements,d=p===void 0?Js:p,u=xt(o),w=u?f?Hs:Hs.filter(function($){return xt($)===u}):Dt,g=w.filter(function($){return d.indexOf($)>=0});g.length===0&&(g=w);var k=g.reduce(function($,b){return $[b]=At(n,{placement:b,boundary:i,rootBoundary:r,padding:c})[He(b)],$},{});return Object.keys(k).sort(function($,b){return k[$]-k[b]})}function mf(n){if(He(n)===us)return[];var e=ss(n);return[On(n),e,On(e)]}function pf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,r=i===void 0?!0:i,c=t.altAxis,f=c===void 0?!0:c,p=t.fallbackPlacements,d=t.padding,u=t.boundary,w=t.rootBoundary,g=t.altBoundary,k=t.flipVariations,$=k===void 0?!0:k,b=t.allowedAutoPlacements,m=e.options.placement,h=He(m),v=h===m,T=p||(v||!$?[ss(m)]:mf(m)),E=[m].concat(T).reduce(function(K,te){return K.concat(He(te)===us?df(e,{placement:te,boundary:u,rootBoundary:w,padding:d,flipVariations:$,allowedAutoPlacements:b}):te)},[]),W=e.rects.reference,j=e.rects.popper,M=new Map,V=!0,C=E[0],x=0;x<E.length;x++){var B=E[x],G=He(B),L=xt(B)===mt,F=[ke,Me].indexOf(G)>=0,q=F?"width":"height",Z=At(e,{placement:B,boundary:u,rootBoundary:w,altBoundary:g,padding:d}),O=F?L?Oe:Se:L?Me:ke;W[q]>j[q]&&(O=ss(O));var N=ss(O),D=[];if(r&&D.push(Z[G]<=0),f&&D.push(Z[O]<=0,Z[N]<=0),D.every(function(K){return K})){C=B,V=!1;break}M.set(B,D)}if(V)for(var S=$?3:1,I=function(te){var X=E.find(function(H){var P=M.get(H);if(P)return P.slice(0,te).every(function(U){return U})});if(X)return C=X,"break"},z=S;z>0;z--){var J=I(z);if(J==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const Fo={name:"flip",enabled:!0,phase:"main",fn:pf,requiresIfExists:["offset"],data:{_skip:!1}};function Nn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Ln(n){return[ke,Oe,Me,Se].some(function(e){return n[e]>=0})}function ff(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,r=e.modifiersData.preventOverflow,c=At(e,{elementContext:"reference"}),f=At(e,{altBoundary:!0}),p=Nn(c,o),d=Nn(f,i,r),u=Ln(p),w=Ln(d);e.modifiersData[t]={referenceClippingOffsets:p,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":w})}const Ho={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ff};function vf(n,e,t){var o=He(n),i=[Se,ke].indexOf(o)>=0?-1:1,r=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,c=r[0],f=r[1];return c=c||0,f=(f||0)*i,[Se,Oe].indexOf(o)>=0?{x:f,y:c}:{x:c,y:f}}function hf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,r=i===void 0?[0,0]:i,c=Js.reduce(function(u,w){return u[w]=vf(w,e.rects,r),u},{}),f=c[e.placement],p=f.x,d=f.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=d),e.modifiersData[o]=c}const Vo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:hf};function _f(n){var e=n.state,t=n.name;e.modifiersData[t]=Bo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Uo={name:"popperOffsets",enabled:!0,phase:"read",fn:_f,data:{}};function gf(n){return n==="x"?"y":"x"}function bf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,r=i===void 0?!0:i,c=t.altAxis,f=c===void 0?!1:c,p=t.boundary,d=t.rootBoundary,u=t.altBoundary,w=t.padding,g=t.tether,k=g===void 0?!0:g,$=t.tetherOffset,b=$===void 0?0:$,m=At(e,{boundary:p,rootBoundary:d,padding:w,altBoundary:u}),h=He(e.placement),v=xt(e.placement),T=!v,E=Zs(h),W=gf(E),j=e.modifiersData.popperOffsets,M=e.rects.reference,V=e.rects.popper,C=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,x=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),B=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,G={x:0,y:0};if(j){if(r){var L,F=E==="y"?ke:Se,q=E==="y"?Me:Oe,Z=E==="y"?"height":"width",O=j[E],N=O+m[F],D=O-m[q],S=k?-V[Z]/2:0,I=v===mt?M[Z]:V[Z],z=v===mt?-V[Z]:-M[Z],J=e.elements.arrow,K=k&&J?Xs(J):{width:0,height:0},te=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:No(),X=te[F],H=te[q],P=Wt(0,M[Z],K[Z]),U=T?M[Z]/2-S-P-X-x.mainAxis:I-P-X-x.mainAxis,ee=T?-M[Z]/2+S+P+H+x.mainAxis:z+P+H+x.mainAxis,oe=e.elements.arrow&&Vt(e.elements.arrow),he=oe?E==="y"?oe.clientTop||0:oe.clientLeft||0:0,rt=(L=B?.[E])!=null?L:0,Fe=O+U-rt-he,Y=O+ee-rt,le=Wt(k?is(N,Fe):N,O,k?ut(D,Y):D);j[E]=le,G[E]=le-O}if(f){var ue,Te=E==="x"?ke:Se,Re=E==="x"?Me:Oe,we=j[W],Gt=W==="y"?"height":"width",dn=we+m[Te],mn=we-m[Re],gs=[ke,Se].indexOf(h)!==-1,pn=(ue=B?.[W])!=null?ue:0,fn=gs?dn:we-M[Gt]-V[Gt]-pn+x.altAxis,vn=gs?we+M[Gt]+V[Gt]-pn-x.altAxis:mn,hn=k&&gs?Yp(fn,we,vn):Wt(k?fn:dn,we,k?vn:mn);j[W]=hn,G[W]=hn-we}e.modifiersData[o]=G}}const qo={name:"preventOverflow",enabled:!0,phase:"main",fn:bf,requiresIfExists:["offset"]};function yf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function wf(n){return n===De(n)||!Ne(n)?en(n):yf(n)}function $f(n){var e=n.getBoundingClientRect(),t=Ct(e.width)/n.offsetWidth||1,o=Ct(e.height)/n.offsetHeight||1;return t!==1||o!==1}function kf(n,e,t){t===void 0&&(t=!1);var o=Ne(e),i=Ne(e)&&$f(e),r=ot(e),c=Tt(n,i,t),f={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!t)&&((Ue(e)!=="body"||sn(r))&&(f=wf(e)),Ne(e)?(p=Tt(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):r&&(p.x=tn(r))),{x:c.left+f.scrollLeft-p.x,y:c.top+f.scrollTop-p.y,width:c.width,height:c.height}}function Sf(n){var e=new Map,t=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function i(r){t.add(r.name);var c=[].concat(r.requires||[],r.requiresIfExists||[]);c.forEach(function(f){if(!t.has(f)){var p=e.get(f);p&&i(p)}}),o.push(r)}return n.forEach(function(r){t.has(r.name)||i(r)}),o}function Ef(n){var e=Sf(n);return Ao.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Cf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Tf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var In={placement:"bottom",modifiers:[],strategy:"absolute"};function jn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function zo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,r=i===void 0?In:i;return function(f,p,d){d===void 0&&(d=r);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},In,r),modifiersData:{},elements:{reference:f,popper:p},attributes:{},styles:{}},w=[],g=!1,k={state:u,setOptions:function(h){var v=typeof h=="function"?h(u.options):h;b(),u.options=Object.assign({},r,u.options,v),u.scrollParents={reference:pt(f)?Bt(f):f.contextElement?Bt(f.contextElement):[],popper:Bt(p)};var T=Ef(Tf([].concat(o,u.options.modifiers)));return u.orderedModifiers=T.filter(function(E){return E.enabled}),$(),k.update()},forceUpdate:function(){if(!g){var h=u.elements,v=h.reference,T=h.popper;if(jn(v,T)){u.rects={reference:kf(v,Vt(T),u.options.strategy==="fixed"),popper:Xs(T)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(x){return u.modifiersData[x.name]=Object.assign({},x.data)});for(var E=0;E<u.orderedModifiers.length;E++){if(u.reset===!0){u.reset=!1,E=-1;continue}var W=u.orderedModifiers[E],j=W.fn,M=W.options,V=M===void 0?{}:M,C=W.name;typeof j=="function"&&(u=j({state:u,options:V,name:C,instance:k})||u)}}}},update:Cf(function(){return new Promise(function(m){k.forceUpdate(),m(u)})}),destroy:function(){b(),g=!0}};if(!jn(f,p))return k;k.setOptions(d).then(function(m){!g&&d.onFirstUpdate&&d.onFirstUpdate(m)});function $(){u.orderedModifiers.forEach(function(m){var h=m.name,v=m.options,T=v===void 0?{}:v,E=m.effect;if(typeof E=="function"){var W=E({state:u,name:h,instance:k,options:T}),j=function(){};w.push(W||j)}})}function b(){w.forEach(function(m){return m()}),w=[]}return k}}var xf=[Ro,Uo,Po,Mo,Vo,Fo,qo,jo,Ho],nn=zo({defaultModifiers:xf});const Ko=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Eo,afterRead:$o,afterWrite:xo,applyStyles:Mo,arrow:jo,auto:us,basePlacements:Dt,beforeMain:ko,beforeRead:yo,beforeWrite:Co,bottom:Me,clippingParents:go,computeStyles:Po,createPopper:nn,detectOverflow:At,end:Et,eventListeners:Ro,flip:Fo,hide:Ho,left:Se,main:So,modifierPhases:Ao,offset:Vo,placements:Js,popper:bt,popperGenerator:zo,popperOffsets:Uo,preventOverflow:qo,read:wo,reference:bo,right:Oe,start:mt,top:ke,variationPlacements:Hs,viewport:Ys,write:To},Symbol.toStringTag,{value:"Module"}));const Qe=new Map,Cs={set(n,e,t){Qe.has(n)||Qe.set(n,new Map);const o=Qe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Qe.has(n)&&Qe.get(n).get(e)||null},remove(n,e){if(!Qe.has(n))return;const t=Qe.get(n);t.delete(e),t.size===0&&Qe.delete(n)}},Af=1e6,Mf=1e3,qs="transitionend",Go=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Of=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Df=n=>{do n+=Math.floor(Math.random()*Af);while(document.getElementById(n));return n},Nf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Mf)},Yo=n=>{n.dispatchEvent(new Event(qs))},Ke=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Ze=n=>Ke(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Go(n)):null,Nt=n=>{if(!Ke(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},et=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Jo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Jo(n.parentNode):null},as=()=>{},Ut=n=>{n.offsetHeight},Qo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ts=[],Lf=n=>{document.readyState==="loading"?(Ts.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ts)e()}),Ts.push(n)):n()},Le=()=>document.documentElement.dir==="rtl",Pe=n=>{Lf(()=>{const e=Qo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},Ce=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Xo=(n,e,t=!0)=>{if(!t){Ce(n);return}const i=Nf(e)+5;let r=!1;const c=({target:f})=>{f===e&&(r=!0,e.removeEventListener(qs,c),Ce(n))};e.addEventListener(qs,c),setTimeout(()=>{r||Yo(e)},i)},on=(n,e,t,o)=>{const i=n.length;let r=n.indexOf(e);return r===-1?!t&&o?n[i-1]:n[0]:(r+=t?1:-1,o&&(r=(r+i)%i),n[Math.max(0,Math.min(r,i-1))])},If=/[^.]*(?=\..*)\.|.*/,jf=/\..*/,Pf=/::\d+$/,xs={};let Pn=1;const Zo={mouseenter:"mouseover",mouseleave:"mouseout"},Rf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ei(n,e){return e&&`${e}::${Pn++}`||n.uidEvent||Pn++}function ti(n){const e=ei(n);return n.uidEvent=e,xs[e]=xs[e]||{},xs[e]}function Wf(n,e){return function t(o){return an(o,{delegateTarget:n}),t.oneOff&&Q.off(n,o.type,e),e.apply(n,[o])}}function Bf(n,e,t){return function o(i){const r=n.querySelectorAll(e);for(let{target:c}=i;c&&c!==this;c=c.parentNode)for(const f of r)if(f===c)return an(i,{delegateTarget:c}),o.oneOff&&Q.off(n,i.type,e,t),t.apply(c,[i])}}function si(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function ni(n,e,t){const o=typeof e=="string",i=o?t:e||t;let r=oi(n);return Rf.has(r)||(r=n),[o,i,r]}function Rn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[r,c,f]=ni(e,t,o);e in Zo&&(c=($=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return $.call(this,b)})(c));const p=ti(n),d=p[f]||(p[f]={}),u=si(d,c,r?t:null);if(u){u.oneOff=u.oneOff&&i;return}const w=ei(c,e.replace(If,"")),g=r?Bf(n,t,c):Wf(n,c);g.delegationSelector=r?t:null,g.callable=c,g.oneOff=i,g.uidEvent=w,d[w]=g,n.addEventListener(f,g,r)}function zs(n,e,t,o,i){const r=si(e[t],o,i);r&&(n.removeEventListener(t,r,!!i),delete e[t][r.uidEvent])}function Ff(n,e,t,o){const i=e[t]||{};for(const[r,c]of Object.entries(i))r.includes(o)&&zs(n,e,t,c.callable,c.delegationSelector)}function oi(n){return n=n.replace(jf,""),Zo[n]||n}const Q={on(n,e,t,o){Rn(n,e,t,o,!1)},one(n,e,t,o){Rn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,r,c]=ni(e,t,o),f=c!==e,p=ti(n),d=p[c]||{},u=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(d).length)return;zs(n,p,c,r,i?t:null);return}if(u)for(const w of Object.keys(p))Ff(n,p,w,e.slice(1));for(const[w,g]of Object.entries(d)){const k=w.replace(Pf,"");(!f||e.includes(k))&&zs(n,p,c,g.callable,g.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Qo(),i=oi(e),r=e!==i;let c=null,f=!0,p=!0,d=!1;r&&o&&(c=o.Event(e,t),o(n).trigger(c),f=!c.isPropagationStopped(),p=!c.isImmediatePropagationStopped(),d=c.isDefaultPrevented());const u=an(new Event(e,{bubbles:f,cancelable:!0}),t);return d&&u.preventDefault(),p&&n.dispatchEvent(u),u.defaultPrevented&&c&&c.preventDefault(),u}};function an(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function Wn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function As(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ge={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${As(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${As(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Wn(n.dataset[o])}return e},getDataAttribute(n,e){return Wn(n.getAttribute(`data-bs-${As(e)}`))}};class qt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Ke(t)?Ge.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ke(t)?Ge.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const r=e[o],c=Ke(r)?"element":Of(r);if(!new RegExp(i).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${i}".`)}}}const Hf="5.3.8";class Be extends qt{constructor(e,t){super(),e=Ze(e),e&&(this._element=e,this._config=this._getConfig(t),Cs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Cs.remove(this._element,this.constructor.DATA_KEY),Q.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Xo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Cs.get(Ze(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Hf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ms=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Go(t)).join(","):null},ae={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!et(t)&&Nt(t))},getSelectorFromElement(n){const e=Ms(n);return e&&ae.findOne(e)?e:null},getElementFromSelector(n){const e=Ms(n);return e?ae.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ms(n);return e?ae.find(e):[]}},ms=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Q.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),et(this))return;const r=ae.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},Vf="alert",Uf="bs.alert",ii=`.${Uf}`,qf=`close${ii}`,zf=`closed${ii}`,Kf="fade",Gf="show";class ps extends Be{static get NAME(){return Vf}close(){if(Q.trigger(this._element,qf).defaultPrevented)return;this._element.classList.remove(Gf);const t=this._element.classList.contains(Kf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),Q.trigger(this._element,zf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(ps,"close");Pe(ps);const Yf="button",Jf="bs.button",Qf=`.${Jf}`,Xf=".data-api",Zf="active",Bn='[data-bs-toggle="button"]',ev=`click${Qf}${Xf}`;class fs extends Be{static get NAME(){return Yf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Zf))}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}Q.on(document,ev,Bn,n=>{n.preventDefault();const e=n.target.closest(Bn);fs.getOrCreateInstance(e).toggle()});Pe(fs);const tv="swipe",Lt=".bs.swipe",sv=`touchstart${Lt}`,nv=`touchmove${Lt}`,ov=`touchend${Lt}`,iv=`pointerdown${Lt}`,av=`pointerup${Lt}`,rv="touch",lv="pen",cv="pointer-event",uv=40,dv={endCallback:null,leftCallback:null,rightCallback:null},mv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class rs extends qt{constructor(e,t){super(),this._element=e,!(!e||!rs.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return dv}static get DefaultType(){return mv}static get NAME(){return tv}dispose(){Q.off(this._element,Lt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ce(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=uv)return;const t=e/this._deltaX;this._deltaX=0,t&&Ce(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Q.on(this._element,iv,e=>this._start(e)),Q.on(this._element,av,e=>this._end(e)),this._element.classList.add(cv)):(Q.on(this._element,sv,e=>this._start(e)),Q.on(this._element,nv,e=>this._move(e)),Q.on(this._element,ov,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===lv||e.pointerType===rv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const pv="carousel",fv="bs.carousel",it=`.${fv}`,ai=".data-api",vv="ArrowLeft",hv="ArrowRight",_v=500,jt="next",_t="prev",yt="left",ns="right",gv=`slide${it}`,Os=`slid${it}`,bv=`keydown${it}`,yv=`mouseenter${it}`,wv=`mouseleave${it}`,$v=`dragstart${it}`,kv=`load${it}${ai}`,Sv=`click${it}${ai}`,ri="carousel",Jt="active",Ev="slide",Cv="carousel-item-end",Tv="carousel-item-start",xv="carousel-item-next",Av="carousel-item-prev",li=".active",ci=".carousel-item",Mv=li+ci,Ov=".carousel-item img",Dv=".carousel-indicators",Nv="[data-bs-slide], [data-bs-slide-to]",Lv='[data-bs-ride="carousel"]',Iv={[vv]:ns,[hv]:yt},jv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Pv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class zt extends Be{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ae.findOne(Dv,this._element),this._addEventListeners(),this._config.ride===ri&&this.cycle()}static get Default(){return jv}static get DefaultType(){return Pv}static get NAME(){return pv}next(){this._slide(jt)}nextWhenVisible(){!document.hidden&&Nt(this._element)&&this.next()}prev(){this._slide(_t)}pause(){this._isSliding&&Yo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Q.one(this._element,Os,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){Q.one(this._element,Os,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?jt:_t;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Q.on(this._element,bv,e=>this._keydown(e)),this._config.pause==="hover"&&(Q.on(this._element,yv,()=>this.pause()),Q.on(this._element,wv,()=>this._maybeEnableCycle())),this._config.touch&&rs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ae.find(Ov,this._element))Q.on(o,$v,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(yt)),rightCallback:()=>this._slide(this._directionToOrder(ns)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),_v+this._config.interval))}};this._swipeHelper=new rs(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Iv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=ae.findOne(li,this._indicatorsElement);t.classList.remove(Jt),t.removeAttribute("aria-current");const o=ae.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Jt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===jt,r=t||on(this._getItems(),o,i,this._config.wrap);if(r===o)return;const c=this._getItemIndex(r),f=k=>Q.trigger(this._element,k,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(f(gv).defaultPrevented||!o||!r)return;const d=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=r;const u=i?Tv:Cv,w=i?xv:Av;r.classList.add(w),Ut(r),o.classList.add(u),r.classList.add(u);const g=()=>{r.classList.remove(u,w),r.classList.add(Jt),o.classList.remove(Jt,w,u),this._isSliding=!1,f(Os)};this._queueCallback(g,o,this._isAnimated()),d&&this.cycle()}_isAnimated(){return this._element.classList.contains(Ev)}_getActive(){return ae.findOne(Mv,this._element)}_getItems(){return ae.find(ci,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Le()?e===yt?_t:jt:e===yt?jt:_t}_orderToDirection(e){return Le()?e===_t?yt:ns:e===_t?ns:yt}static jQueryInterface(e){return this.each(function(){const t=zt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Q.on(document,Sv,Nv,function(n){const e=ae.getElementFromSelector(this);if(!e||!e.classList.contains(ri))return;n.preventDefault();const t=zt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Ge.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});Q.on(window,kv,()=>{const n=ae.find(Lv);for(const e of n)zt.getOrCreateInstance(e)});Pe(zt);const Rv="collapse",Wv="bs.collapse",Kt=`.${Wv}`,Bv=".data-api",Fv=`show${Kt}`,Hv=`shown${Kt}`,Vv=`hide${Kt}`,Uv=`hidden${Kt}`,qv=`click${Kt}${Bv}`,Ds="show",$t="collapse",Qt="collapsing",zv="collapsed",Kv=`:scope .${$t} .${$t}`,Gv="collapse-horizontal",Yv="width",Jv="height",Qv=".collapse.show, .collapse.collapsing",Ks='[data-bs-toggle="collapse"]',Xv={parent:null,toggle:!0},Zv={parent:"(null|element)",toggle:"boolean"};class Mt extends Be{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=ae.find(Ks);for(const i of o){const r=ae.getSelectorFromElement(i),c=ae.find(r).filter(f=>f===this._element);r!==null&&c.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Xv}static get DefaultType(){return Zv}static get NAME(){return Rv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Qv).filter(f=>f!==this._element).map(f=>Mt.getOrCreateInstance(f,{toggle:!1}))),e.length&&e[0]._isTransitioning||Q.trigger(this._element,Fv).defaultPrevented)return;for(const f of e)f.hide();const o=this._getDimension();this._element.classList.remove($t),this._element.classList.add(Qt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t,Ds),this._element.style[o]="",Q.trigger(this._element,Hv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||Q.trigger(this._element,Vv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ut(this._element),this._element.classList.add(Qt),this._element.classList.remove($t,Ds);for(const i of this._triggerArray){const r=ae.getElementFromSelector(i);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t),Q.trigger(this._element,Uv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ds)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ze(e.parent),e}_getDimension(){return this._element.classList.contains(Gv)?Yv:Jv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ks);for(const t of e){const o=ae.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=ae.find(Kv,this._config.parent);return ae.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(zv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Mt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Q.on(document,qv,Ks,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ae.getMultipleElementsFromSelector(this))Mt.getOrCreateInstance(e,{toggle:!1}).toggle()});Pe(Mt);const Fn="dropdown",eh="bs.dropdown",vt=`.${eh}`,rn=".data-api",th="Escape",Hn="Tab",sh="ArrowUp",Vn="ArrowDown",nh=2,oh=`hide${vt}`,ih=`hidden${vt}`,ah=`show${vt}`,rh=`shown${vt}`,ui=`click${vt}${rn}`,di=`keydown${vt}${rn}`,lh=`keyup${vt}${rn}`,wt="show",ch="dropup",uh="dropend",dh="dropstart",mh="dropup-center",ph="dropdown-center",lt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',fh=`${lt}.${wt}`,os=".dropdown-menu",vh=".navbar",hh=".navbar-nav",_h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",gh=Le()?"top-end":"top-start",bh=Le()?"top-start":"top-end",yh=Le()?"bottom-end":"bottom-start",wh=Le()?"bottom-start":"bottom-end",$h=Le()?"left-start":"right-start",kh=Le()?"right-start":"left-start",Sh="top",Eh="bottom",Ch={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Th={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ve extends Be{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=ae.next(this._element,os)[0]||ae.prev(this._element,os)[0]||ae.findOne(os,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ch}static get DefaultType(){return Th}static get NAME(){return Fn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(et(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Q.trigger(this._element,ah,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(hh))for(const o of[].concat(...document.body.children))Q.on(o,"mouseover",as);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(wt),this._element.classList.add(wt),Q.trigger(this._element,rh,e)}}hide(){if(et(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Q.trigger(this._element,oh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Q.off(o,"mouseover",as);this._popper&&this._popper.destroy(),this._menu.classList.remove(wt),this._element.classList.remove(wt),this._element.setAttribute("aria-expanded","false"),Ge.removeDataAttribute(this._menu,"popper"),Q.trigger(this._element,ih,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ke(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Fn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ko>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ke(this._config.reference)?e=Ze(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=nn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(wt)}_getPlacement(){const e=this._parent;if(e.classList.contains(uh))return $h;if(e.classList.contains(dh))return kh;if(e.classList.contains(mh))return Sh;if(e.classList.contains(ph))return Eh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ch)?t?bh:gh:t?wh:yh}_detectNavbar(){return this._element.closest(vh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ge.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ce(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=ae.find(_h,this._menu).filter(i=>Nt(i));o.length&&on(o,t,e===Vn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ve.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===nh||e.type==="keyup"&&e.key!==Hn)return;const t=ae.find(fh);for(const o of t){const i=Ve.getInstance(o);if(!i||i._config.autoClose===!1)continue;const r=e.composedPath(),c=r.includes(i._menu);if(r.includes(i._element)||i._config.autoClose==="inside"&&!c||i._config.autoClose==="outside"&&c||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Hn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const f={relatedTarget:i._element};e.type==="click"&&(f.clickEvent=e),i._completeHide(f)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===th,i=[sh,Vn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const r=this.matches(lt)?this:ae.prev(this,lt)[0]||ae.next(this,lt)[0]||ae.findOne(lt,e.delegateTarget.parentNode),c=Ve.getOrCreateInstance(r);if(i){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),r.focus())}}Q.on(document,di,lt,Ve.dataApiKeydownHandler);Q.on(document,di,os,Ve.dataApiKeydownHandler);Q.on(document,ui,Ve.clearMenus);Q.on(document,lh,Ve.clearMenus);Q.on(document,ui,lt,function(n){n.preventDefault(),Ve.getOrCreateInstance(this).toggle()});Pe(Ve);const mi="backdrop",xh="fade",Un="show",qn=`mousedown.bs.${mi}`,Ah={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Mh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class pi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ah}static get DefaultType(){return Mh}static get NAME(){return mi}show(e){if(!this._config.isVisible){Ce(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Ut(t),t.classList.add(Un),this._emulateAnimation(()=>{Ce(e)})}hide(e){if(!this._config.isVisible){Ce(e);return}this._getElement().classList.remove(Un),this._emulateAnimation(()=>{this.dispose(),Ce(e)})}dispose(){this._isAppended&&(Q.off(this._element,qn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(xh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ze(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Q.on(e,qn,()=>{Ce(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Xo(e,this._getElement(),this._config.isAnimated)}}const Oh="focustrap",Dh="bs.focustrap",ls=`.${Dh}`,Nh=`focusin${ls}`,Lh=`keydown.tab${ls}`,Ih="Tab",jh="forward",zn="backward",Ph={autofocus:!0,trapElement:null},Rh={autofocus:"boolean",trapElement:"element"};class fi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ph}static get DefaultType(){return Rh}static get NAME(){return Oh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Q.off(document,ls),Q.on(document,Nh,e=>this._handleFocusin(e)),Q.on(document,Lh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Q.off(document,ls))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=ae.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===zn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Ih&&(this._lastTabNavDirection=e.shiftKey?zn:jh)}}const Kn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Gn=".sticky-top",Xt="padding-right",Yn="margin-right";class Gs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Xt,t=>t+e),this._setElementAttributes(Kn,Xt,t=>t+e),this._setElementAttributes(Gn,Yn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Xt),this._resetElementAttributes(Kn,Xt),this._resetElementAttributes(Gn,Yn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),r=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+i)return;this._saveInitialAttribute(c,t);const f=window.getComputedStyle(c).getPropertyValue(t);c.style.setProperty(t,`${o(Number.parseFloat(f))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Ge.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const r=Ge.getDataAttribute(i,t);if(r===null){i.style.removeProperty(t);return}Ge.removeDataAttribute(i,t),i.style.setProperty(t,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Ke(e)){t(e);return}for(const o of ae.find(e,this._element))t(o)}}const Wh="modal",Bh="bs.modal",Ie=`.${Bh}`,Fh=".data-api",Hh="Escape",Vh=`hide${Ie}`,Uh=`hidePrevented${Ie}`,vi=`hidden${Ie}`,hi=`show${Ie}`,qh=`shown${Ie}`,zh=`resize${Ie}`,Kh=`click.dismiss${Ie}`,Gh=`mousedown.dismiss${Ie}`,Yh=`keydown.dismiss${Ie}`,Jh=`click${Ie}${Fh}`,Jn="modal-open",Qh="fade",Qn="show",Ns="modal-static",Xh=".modal.show",Zh=".modal-dialog",e_=".modal-body",t_='[data-bs-toggle="modal"]',s_={backdrop:!0,focus:!0,keyboard:!0},n_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ft extends Be{constructor(e,t){super(e,t),this._dialog=ae.findOne(Zh,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Gs,this._addEventListeners()}static get Default(){return s_}static get DefaultType(){return n_}static get NAME(){return Wh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Q.trigger(this._element,hi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Jn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Q.trigger(this._element,Vh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Qn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Q.off(window,Ie),Q.off(this._dialog,Ie),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new pi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=ae.findOne(e_,this._dialog);t&&(t.scrollTop=0),Ut(this._element),this._element.classList.add(Qn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Q.trigger(this._element,qh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Q.on(this._element,Yh,e=>{if(e.key===Hh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Q.on(window,zh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Q.on(this._element,Gh,e=>{Q.one(this._element,Kh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Jn),this._resetAdjustments(),this._scrollBar.reset(),Q.trigger(this._element,vi)})}_isAnimated(){return this._element.classList.contains(Qh)}_triggerBackdropTransition(){if(Q.trigger(this._element,Uh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ns)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ns),this._queueCallback(()=>{this._element.classList.remove(Ns),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Le()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Le()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=ft.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}Q.on(document,Jh,t_,function(n){const e=ae.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Q.one(e,hi,i=>{i.defaultPrevented||Q.one(e,vi,()=>{Nt(this)&&this.focus()})});const t=ae.findOne(Xh);t&&ft.getInstance(t).hide(),ft.getOrCreateInstance(e).toggle(this)});ms(ft);Pe(ft);const o_="offcanvas",i_="bs.offcanvas",Je=`.${i_}`,_i=".data-api",a_=`load${Je}${_i}`,r_="Escape",Xn="show",Zn="showing",eo="hiding",l_="offcanvas-backdrop",gi=".offcanvas.show",c_=`show${Je}`,u_=`shown${Je}`,d_=`hide${Je}`,to=`hidePrevented${Je}`,bi=`hidden${Je}`,m_=`resize${Je}`,p_=`click${Je}${_i}`,f_=`keydown.dismiss${Je}`,v_='[data-bs-toggle="offcanvas"]',h_={backdrop:!0,keyboard:!0,scroll:!1},__={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class tt extends Be{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return h_}static get DefaultType(){return __}static get NAME(){return o_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Q.trigger(this._element,c_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Gs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Xn),this._element.classList.remove(Zn),Q.trigger(this._element,u_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Q.trigger(this._element,d_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(eo),this._backdrop.hide();const t=()=>{this._element.classList.remove(Xn,eo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Gs().reset(),Q.trigger(this._element,bi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Q.trigger(this._element,to);return}this.hide()},t=!!this._config.backdrop;return new pi({className:l_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_addEventListeners(){Q.on(this._element,f_,e=>{if(e.key===r_){if(this._config.keyboard){this.hide();return}Q.trigger(this._element,to)}})}static jQueryInterface(e){return this.each(function(){const t=tt.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}Q.on(document,p_,v_,function(n){const e=ae.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),et(this))return;Q.one(e,bi,()=>{Nt(this)&&this.focus()});const t=ae.findOne(gi);t&&t!==e&&tt.getInstance(t).hide(),tt.getOrCreateInstance(e).toggle(this)});Q.on(window,a_,()=>{for(const n of ae.find(gi))tt.getOrCreateInstance(n).show()});Q.on(window,m_,()=>{for(const n of ae.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&tt.getOrCreateInstance(n).hide()});ms(tt);Pe(tt);const g_=/^aria-[\w-]*$/i,yi={"*":["class","dir","id","lang","role",g_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},b_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),y_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,w_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?b_.has(t)?!!y_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function $_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const c of r){const f=c.nodeName.toLowerCase();if(!Object.keys(e).includes(f)){c.remove();continue}const p=[].concat(...c.attributes),d=[].concat(e["*"]||[],e[f]||[]);for(const u of p)w_(u,d)||c.removeAttribute(u.nodeName)}return i.body.innerHTML}const k_="TemplateFactory",S_={allowList:yi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},E_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},C_={entry:"(string|element|function|null)",selector:"(string|element)"};class T_ extends qt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return S_}static get DefaultType(){return E_}static get NAME(){return k_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,r]of Object.entries(this._config.content))this._setContent(e,r,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},C_)}_setContent(e,t,o){const i=ae.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Ke(t)){this._putElementInTemplate(Ze(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?$_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ce(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const x_="tooltip",A_=new Set(["sanitize","allowList","sanitizeFn"]),Ls="fade",M_="modal",Zt="show",O_=".tooltip-inner",so=`.${M_}`,no="hide.bs.modal",Pt="hover",Is="focus",js="click",D_="manual",N_="hide",L_="hidden",I_="show",j_="shown",P_="inserted",R_="click",W_="focusin",B_="focusout",F_="mouseenter",H_="mouseleave",V_={AUTO:"auto",TOP:"top",RIGHT:Le()?"left":"right",BOTTOM:"bottom",LEFT:Le()?"right":"left"},U_={allowList:yi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},q_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class It extends Be{constructor(e,t){if(typeof Ko>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return U_}static get DefaultType(){return q_}static get NAME(){return x_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Q.off(this._element.closest(so),no,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Q.trigger(this._element,this.constructor.eventName(I_)),o=(Jo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(i),Q.trigger(this._element,this.constructor.eventName(P_))),this._popper=this._createPopper(i),i.classList.add(Zt),"ontouchstart"in document.documentElement)for(const f of[].concat(...document.body.children))Q.on(f,"mouseover",as);const c=()=>{Q.trigger(this._element,this.constructor.eventName(j_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Q.trigger(this._element,this.constructor.eventName(N_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Zt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Q.off(i,"mouseover",as);this._activeTrigger[js]=!1,this._activeTrigger[Is]=!1,this._activeTrigger[Pt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Q.trigger(this._element,this.constructor.eventName(L_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ls,Zt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Df(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ls),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new T_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[O_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ls)}_isShown(){return this.tip&&this.tip.classList.contains(Zt)}_createPopper(e){const t=Ce(this._config.placement,[this,e,this._element]),o=V_[t.toUpperCase()];return nn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Ce(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Ce(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")Q.on(this._element,this.constructor.eventName(R_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[js]=!(i._isShown()&&i._activeTrigger[js]),i.toggle()});else if(t!==D_){const o=t===Pt?this.constructor.eventName(F_):this.constructor.eventName(W_),i=t===Pt?this.constructor.eventName(H_):this.constructor.eventName(B_);Q.on(this._element,o,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusin"?Is:Pt]=!0,c._enter()}),Q.on(this._element,i,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusout"?Is:Pt]=c._element.contains(r.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Q.on(this._element.closest(so),no,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Ge.getDataAttributes(this._element);for(const o of Object.keys(t))A_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ze(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=It.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Pe(It);const z_="popover",K_=".popover-header",G_=".popover-body",Y_={...It.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},J_={...It.DefaultType,content:"(null|string|element|function)"};class ln extends It{static get Default(){return Y_}static get DefaultType(){return J_}static get NAME(){return z_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[K_]:this._getTitle(),[G_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=ln.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Pe(ln);const Q_="scrollspy",X_="bs.scrollspy",cn=`.${X_}`,Z_=".data-api",eg=`activate${cn}`,oo=`click${cn}`,tg=`load${cn}${Z_}`,sg="dropdown-item",gt="active",ng='[data-bs-spy="scroll"]',Ps="[href]",og=".nav, .list-group",io=".nav-link",ig=".nav-item",ag=".list-group-item",rg=`${io}, ${ig} > ${io}, ${ag}`,lg=".dropdown",cg=".dropdown-toggle",ug={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},dg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class vs extends Be{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ug}static get DefaultType(){return dg}static get NAME(){return Q_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ze(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Q.off(this._config.target,oo),Q.on(this._config.target,oo,Ps,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(t(c))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(c));continue}const f=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&f){if(o(c),!i)return;continue}!r&&!f&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ae.find(Ps,this._config.target);for(const t of e){if(!t.hash||et(t))continue;const o=ae.findOne(decodeURI(t.hash),this._element);Nt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(gt),this._activateParents(e),Q.trigger(this._element,eg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(sg)){ae.findOne(cg,e.closest(lg)).classList.add(gt);return}for(const t of ae.parents(e,og))for(const o of ae.prev(t,rg))o.classList.add(gt)}_clearActiveClass(e){e.classList.remove(gt);const t=ae.find(`${Ps}.${gt}`,e);for(const o of t)o.classList.remove(gt)}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Q.on(window,tg,()=>{for(const n of ae.find(ng))vs.getOrCreateInstance(n)});Pe(vs);const mg="tab",pg="bs.tab",ht=`.${pg}`,fg=`hide${ht}`,vg=`hidden${ht}`,hg=`show${ht}`,_g=`shown${ht}`,gg=`click${ht}`,bg=`keydown${ht}`,yg=`load${ht}`,wg="ArrowLeft",ao="ArrowRight",$g="ArrowUp",ro="ArrowDown",Rs="Home",lo="End",ct="active",co="fade",Ws="show",kg="dropdown",wi=".dropdown-toggle",Sg=".dropdown-menu",Bs=`:not(${wi})`,Eg='.list-group, .nav, [role="tablist"]',Cg=".nav-item, .list-group-item",Tg=`.nav-link${Bs}, .list-group-item${Bs}, [role="tab"]${Bs}`,$i='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Fs=`${Tg}, ${$i}`,xg=`.${ct}[data-bs-toggle="tab"], .${ct}[data-bs-toggle="pill"], .${ct}[data-bs-toggle="list"]`;class Ot extends Be{constructor(e){super(e),this._parent=this._element.closest(Eg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Q.on(this._element,bg,t=>this._keydown(t)))}static get NAME(){return mg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?Q.trigger(t,fg,{relatedTarget:e}):null;Q.trigger(e,hg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(ct),this._activate(ae.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ws);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Q.trigger(e,_g,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_deactivate(e,t){if(!e)return;e.classList.remove(ct),e.blur(),this._deactivate(ae.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ws);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Q.trigger(e,vg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_keydown(e){if(![wg,ao,$g,ro,Rs,lo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!et(i));let o;if([Rs,lo].includes(e.key))o=t[e.key===Rs?0:t.length-1];else{const i=[ao,ro].includes(e.key);o=on(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Ot.getOrCreateInstance(o).show())}_getChildren(){return ae.find(Fs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=ae.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(kg))return;const i=(r,c)=>{const f=ae.findOne(r,o);f&&f.classList.toggle(c,t)};i(wi,ct),i(Sg,Ws),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(ct)}_getInnerElement(e){return e.matches(Fs)?e:ae.findOne(Fs,e)}_getOuterElement(e){return e.closest(Cg)||e}static jQueryInterface(e){return this.each(function(){const t=Ot.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Q.on(document,gg,$i,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!et(this)&&Ot.getOrCreateInstance(this).show()});Q.on(window,yg,()=>{for(const n of ae.find(xg))Ot.getOrCreateInstance(n)});Pe(Ot);const Ag="toast",Mg="bs.toast",at=`.${Mg}`,Og=`mouseover${at}`,Dg=`mouseout${at}`,Ng=`focusin${at}`,Lg=`focusout${at}`,Ig=`hide${at}`,jg=`hidden${at}`,Pg=`show${at}`,Rg=`shown${at}`,Wg="fade",uo="hide",es="show",ts="showing",Bg={animation:"boolean",autohide:"boolean",delay:"number"},Fg={animation:!0,autohide:!0,delay:5e3};class hs extends Be{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Fg}static get DefaultType(){return Bg}static get NAME(){return Ag}show(){if(Q.trigger(this._element,Pg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Wg);const t=()=>{this._element.classList.remove(ts),Q.trigger(this._element,Rg),this._maybeScheduleHide()};this._element.classList.remove(uo),Ut(this._element),this._element.classList.add(es,ts),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||Q.trigger(this._element,Ig).defaultPrevented)return;const t=()=>{this._element.classList.add(uo),this._element.classList.remove(ts,es),Q.trigger(this._element,jg)};this._element.classList.add(ts),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(es),super.dispose()}isShown(){return this._element.classList.contains(es)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Q.on(this._element,Og,e=>this._onInteraction(e,!0)),Q.on(this._element,Dg,e=>this._onInteraction(e,!1)),Q.on(this._element,Ng,e=>this._onInteraction(e,!0)),Q.on(this._element,Lg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=hs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(hs);Pe(hs);const Hg={class:"message-content-column"},Vg=["id"],Ug={class:"accordion-item"},qg=["id"],zg=["aria-controls"],Kg={class:"d-flex align-items-center w-100"},Gg={class:"badge bg-warning text-dark ms-auto me-2"},Yg={class:"text-muted"},Jg=["id","aria-labelledby"],Qg={class:"accordion-body bg-light"},Xg={class:"alert alert-warning mb-3",role:"alert"},Zg={class:"compaction-metadata"},eb={class:"metadata-row"},tb={class:"metadata-row"},sb={key:0,class:"metadata-row"},nb={class:"continuation-content"},ob={class:"continuation-text border rounded p-3 bg-white"},ib={class:"mb-0"},ab={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=_(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=_(()=>`heading-${t.value}`),i=_(()=>`collapse-${t.value}`),r=R(null);let c=null;ye(()=>{r.value&&(c=new Mt(r.value,{toggle:!1}))}),Si(()=>{c&&c.dispose()});function f(){c&&c.toggle()}const p=_(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),d=_(()=>p.value?e.messages[3]:e.messages[2]),u=_(()=>d.value?.metadata?.init_data?.compact_metadata||{}),w=_(()=>u.value.pre_tokens||0),g=_(()=>p.value?e.messages[4]:e.messages[3]),k=_(()=>g.value?.content||""),$=_(()=>{const m=e.messages[0]?.timestamp;return m?Ht(m):""});function b(m){return m?`${m.toLocaleString()} tokens`:"0 tokens"}return(m,h)=>(a(),l("div",{class:"message-row message-row-compaction",key:t.value},[h[7]||(h[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Hg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Ug,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:f},[s("div",Kg,[h[0]||(h[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",Gg,y(b(w.value)),1),s("small",Yg,y($.value),1)])],8,zg)],8,qg),s("div",{ref_key:"collapseElement",ref:r,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Qg,[s("div",Xg,[h[5]||(h[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ie(" Compaction Details ")],-1)),s("div",Zg,[s("div",eb,[h[2]||(h[2]=s("strong",null,"Trigger:",-1)),s("span",null,y(u.value.trigger||"auto"),1)]),s("div",tb,[h[3]||(h[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,y(b(w.value)),1)]),u.value.post_tokens?(a(),l("div",sb,[h[4]||(h[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,y(b(u.value.post_tokens)),1)])):A("",!0)])]),s("div",nb,[h[6]||(h[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ie(" Continuation Message ")],-1)),s("div",ob,[s("pre",ib,y(k.value),1)])])])],8,Jg)])],8,Vg)])]))}},rb=ne(ab,[["__scopeId","data-v-e0b95ba8"]]),lb={key:0,class:"text-muted text-center py-5"},cb={__name:"MessageList",setup(n){const e=Ae(),t=_e(),o=R(null),i=_(()=>{const u=e.currentMessages,w=[];let g=0;for(;g<u.length;){const k=u[g];if(c(k,u,g)){const $=u[g+2],m=$?.type==="system"&&$?.metadata?.subtype==="init"?5:4,h=u.slice(g,g+m);w.push({type:"compaction",messages:h}),g+=m;continue}p(k)&&w.push({type:"message",message:k,attachedTools:[]}),g++}return r(w)});function r(u){const w=new Map,g=new Set;for(let $=0;$<u.length;$++){const b=u[$];if(b.type==="compaction")continue;const m=b.message,h=m.content&&m.content.trim().length>0&&m.content!=="Assistant response",v=m.type==="assistant"&&m.metadata?.has_tool_uses&&m.metadata?.tool_uses?.length>0;if(m.type==="assistant"&&v&&!h){let T=-1,E=!1;for(let W=$-1;W>=0;W--){const j=u[W];if(!g.has(W)){if(j.type==="message"&&j.message.type!=="assistant"){E=!0;break}if(j.type==="message"&&j.message.type==="assistant"){const M=j.message;if(M.content&&M.content.trim().length>0&&M.content!=="Assistant response"){T=W;break}else{T=W;break}}}}E&&T===-1||(E&&T>=0?(w.has(T)||w.set(T,[]),w.get(T).push(...m.metadata.tool_uses),g.add($)):!E&&T>=0&&(w.has(T)||w.set(T,[]),w.get(T).push(...m.metadata.tool_uses),g.add($)))}}const k=[];for(let $=0;$<u.length;$++){if(g.has($))continue;const b=u[$];w.has($)&&(b.attachedTools=[...b.attachedTools||[],...w.get($)]),k.push(b)}return k}function c(u,w,g){if(g+3>=w.length)return!1;const k=w[g],$=w[g+1];let b=w[g+2],m=w[g+3],h=w[g+4];const v=k.type==="system"&&k.metadata?.subtype==="status"&&k.metadata?.init_data?.status==="compacting",T=$.type==="system"&&$.metadata?.subtype==="status"&&($.metadata?.init_data?.status===null||$.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(g+4>=w.length)return!1;const W=!0,j=m?.type==="system"&&m?.metadata?.subtype==="compact_boundary",M=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",T),console.log("  Msg3 (init):",W),console.log("  Msg4 (boundary):",j),console.log("  Msg5 (continuation):",M)),v&&T&&W&&j&&M}else{const W=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",j=m?.type==="user"&&m?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",T),console.log("  Msg3 (boundary):",W),console.log("  Msg4 (continuation):",j)),v&&T&&W&&j}}async function f(){t.autoScrollEnabled&&(await kt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>i.value.length,f),fe(()=>e.currentToolCalls.length,f),fe(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),f),ye(()=>{setTimeout(()=>{f()},100)});function p(u){const w=u.subtype||u.metadata?.subtype;if(u.type==="system"&&w==="init"||u.type==="system"&&w==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const g=u.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const g=u.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function d(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,w)=>(a(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),l("div",lb," No messages yet. Start a conversation! ")):A("",!0),(a(!0),l(re,null,ce(i.value,(g,k)=>(a(),l(re,{key:`item-${k}`},[g.type==="message"?(a(),be(Up,{key:0,message:d(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(a(),be(rb,{key:1,messages:g.messages},null,8,["messages"])):A("",!0)],64))),128))],512))}},ub=ne(cb,[["__scopeId","data-v-bb936559"]]),db={key:0,class:"attachment-list"},mb={key:0,class:"attachment-preview"},pb=["src","alt"],fb={key:1,class:"attachment-icon"},vb={class:"file-type-icon"},hb={class:"attachment-info"},_b=["title"],gb={class:"attachment-size"},bb=["onClick"],yb={key:2,class:"upload-progress"},wb=["title"],$b={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const t=e;function o(p){if(p.type&&p.type.startsWith("image/"))return!0;const d=p.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(d)}function i(p){const d=p.name?.split(".").pop()?.toLowerCase()||"",u=p.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(d)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(d)?"âš™ï¸":["log","txt"].includes(d)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(d)?"ðŸ“":"ðŸ“"}function r(p){return p?p<1024?p+" B":p<1024*1024?(p/1024).toFixed(1)+" KB":(p/(1024*1024)).toFixed(1)+" MB":""}function c(p,d=20){if(!p||p.length<=d)return p;const u=p.split(".").pop(),w=p.substring(0,p.length-u.length-1);return w.length<=d-u.length-4?p:w.substring(0,d-u.length-4)+"..."+u}function f(p){t("remove",p)}return(p,d)=>n.attachments.length>0?(a(),l("div",db,[(a(!0),l(re,null,ce(n.attachments,(u,w)=>(a(),l("div",{key:u.id||w,class:"attachment-item"},[o(u)?(a(),l("div",mb,[s("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,pb)])):(a(),l("div",fb,[s("span",vb,y(i(u)),1)])),s("div",hb,[s("span",{class:"attachment-name",title:u.name},y(c(u.name)),9,_b),s("span",gb,y(r(u.size)),1)]),s("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>f(w)}," âœ• ",8,bb),u.uploading?(a(),l("div",yb,[s("div",{class:"progress-bar",style:ze({width:(u.progress||0)+"%"})},null,4)])):A("",!0),u.error?(a(),l("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+y(u.error),9,wb)):A("",!0)]))),128))])):A("",!0)}},kb=ne($b,[["__scopeId","data-v-0fcc4974"]]),Sb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Eb=["disabled"],Cb=["placeholder","disabled"],Tb=["disabled"],xb=["disabled"],mo=5*1024*1024,Ab={__name:"InputArea",setup(n){const e=de(),t=nt(),o=Xe(),i=_e(),r=fo("pendingResourceAttachment",R(null)),c=R(null),f=R(null),p=R(window.innerWidth),d=R([]),u=R(!1),w=R(!1),g=_({get:()=>e.currentInput,set:S=>{e.currentInput=S}}),k=_(()=>e.currentSession?.is_processing||!1),$=_(()=>t.sessionConnected),b=_(()=>e.currentSession?.state==="starting"),m=_(()=>e.currentSessionId),h=_(()=>!!g.value.trim()||d.value.filter(S=>!S.error).length>0),v=_(()=>p.value<768),T=_(()=>b.value?"Session is starting...":$.value?"Type your message to Claude Code...":"Waiting for connection...");function E(){p.value=window.innerWidth}ye(()=>{window.addEventListener("resize",E)}),Ee(()=>{window.removeEventListener("resize",E)}),fe(r,S=>{S&&(N(S),r.value=null)});function W(S){if(S.key==="Enter"&&!S.shiftKey){if(v.value)return;S.preventDefault(),Z()}}function j(){const S=c.value;if(!S)return;S.style.height="auto";const I=Math.min(S.scrollHeight,parseInt(getComputedStyle(S).maxHeight));S.style.height=I+"px"}function M(){f.value?.click()}function V(S){const I=Array.from(S.target.files||[]);B(I),S.target.value=""}function C(S){u.value=!1;const I=Array.from(S.dataTransfer?.files||[]);B(I)}function x(S){const I=S.clipboardData?.items;if(!I)return;const z=[];for(const J of I)if(J.type.startsWith("image/")){const K=J.getAsFile();if(K){const te=J.type.split("/")[1]||"png",X=`clipboard-${Date.now()}.${te}`,H=new File([K],X,{type:K.type});z.push(H)}}z.length>0&&(S.preventDefault(),B(z))}function B(S){for(const I of S){if(I.size>mo){d.value.push({id:L(),name:I.name,size:I.size,type:I.type,file:I,error:`File too large (max ${mo/(1024*1024)}MB)`});continue}let z=null;I.type.startsWith("image/")&&(z=URL.createObjectURL(I)),d.value.push({id:L(),name:I.name,size:I.size,type:I.type,file:I,preview:z,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function G(S){const I=d.value[S];I.preview&&URL.revokeObjectURL(I.preview),d.value.splice(S,1)}function L(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function F(S){const I=m.value;if(!I)return null;S.uploading=!0,S.progress=0,S.error=null;try{const z=new FormData;z.append("file",S.file);const J=await fetch(`/api/sessions/${I}/files`,{method:"POST",body:z});if(!J.ok){const te=await J.json().catch(()=>({}));throw new Error(te.detail||`Upload failed: ${J.status}`)}const K=await J.json();return S.uploaded=!0,S.uploadedInfo=K.file,S.progress=100,K.file}catch(z){return S.error=z.message,null}finally{S.uploading=!1}}async function q(){const S=d.value.filter(I=>!I.uploaded&&!I.error);if(S.length===0)return!0;w.value=!0;try{return(await Promise.all(S.map(F))).every(z=>z!==null)}finally{w.value=!1}}async function Z(){const S=g.value.trim(),I=d.value.filter(K=>!K.error).length>0;if(!S&&!I||I&&!await q())return;let z=g.value;const J=d.value.filter(K=>K.uploaded&&K.uploadedInfo).map(K=>K.uploadedInfo);if(J.length>0){const K=J.map(te=>{const X=(te.size_bytes/1024).toFixed(1);return`- ${te.original_name} (${X} KB): ${te.stored_path}`}).join(`
`);z.trim()?z=`${z}

---
Attached files (use Read tool to access):
${K}`:z=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${K}`}t.sendMessage(z),g.value="",O(),c.value&&(c.value.style.height="auto")}function O(){for(const S of d.value)S.preview&&URL.revokeObjectURL(S.preview);d.value=[]}function N(S){if(!S||!S.resource_id){console.warn("Invalid resource for attachment:",S);return}const I=m.value;if(!I){console.warn("No current session for resource attachment");return}if(d.value.findIndex(te=>te.resourceId===S.resource_id)>=0){console.log("Resource already attached:",S.resource_id);return}const J=o.isImageResource(S);let K=null;J&&(K=o.getResourceUrl(I,S.resource_id)),d.value.push({id:L(),resourceId:S.resource_id,name:S.original_filename||S.title||"Resource",size:S.size_bytes||0,type:S.format||"application/octet-stream",file:null,preview:K,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:S.resource_id,original_name:S.original_filename||S.title,stored_path:S.file_path||`/api/sessions/${I}/resources/${S.resource_id}`,size_bytes:S.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",S.resource_id)}function D(){t.interruptSession()}return(S,I)=>(a(),l("div",{class:se(["border-top",$e(i).isRedBackground?"theme-red-panel":"bg-light"])},[$.value?A("",!0):(a(),l("div",Sb,[...I[5]||(I[5]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),pe(kb,{attachments:d.value,onRemove:G},null,8,["attachments"]),u.value?(a(),l("div",{key:1,class:"drop-zone-overlay",onDragover:I[0]||(I[0]=ve(()=>{},["prevent"])),onDragleave:I[1]||(I[1]=z=>u.value=!1),onDrop:ve(C,["prevent"])},[...I[6]||(I[6]=[s("div",{class:"drop-zone-content"},[s("span",{class:"drop-icon"},"ðŸ“Ž"),s("span",null,"Drop files here")],-1)])],32)):A("",!0),s("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:I[3]||(I[3]=ve(z=>u.value=!0,["prevent"])),onDragenter:I[4]||(I[4]=ve(z=>u.value=!0,["prevent"]))},[s("input",{ref_key:"fileInput",ref:f,type:"file",multiple:"",class:"d-none",onChange:V},null,544),s("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:b.value||!$.value,onClick:M}," ðŸ“Ž ",8,Eb),ge(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:c,"onUpdate:modelValue":I[2]||(I[2]=z=>g.value=z),class:"form-control",placeholder:T.value,disabled:b.value||!$.value,rows:"1",onInput:j,onKeydown:W,onPaste:x},null,40,Cb),[[We,g.value]]),k.value&&!h.value?(a(),l("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:D}," Stop ")):k.value&&h.value?(a(),l("button",{key:1,class:"btn btn-info",disabled:!$.value||b.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:Z},y(w.value?"Uploading...":"Queue"),9,Tb)):(a(),l("button",{key:2,class:"btn btn-primary",disabled:!h.value||!$.value||b.value||w.value,onClick:Z},y(w.value?"Uploading...":"Send"),9,xb))],32)],2))}},Mb=ne(Ab,[["__scopeId","data-v-d366c5ec"]]),Ob={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Db={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Nb={class:"text-secondary"},Lb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Ib={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_e(),i=_(()=>t.currentSession),r=_(()=>o.isLoading),c=_(()=>o.loadingMessage);return ye(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(f,p)=>{if(f!==p&&f!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(f)}finally{o.hideLoading()}}}),Ee(()=>{}),(f,p)=>(a(),l("div",Ob,[r.value?(a(),l("div",Db,[p[0]||(p[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",Nb,y(c.value),1)])):A("",!0),i.value?(a(),be(qi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),s("div",Lb,[pe(ub)]),pe(Mb),i.value?(a(),be(Ji,{key:2,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),i.value?(a(),be(oa,{key:3,"session-id":e.sessionId},null,8,["session-id"])):A("",!0)]))}},_s=st("legion",()=>{const n=R(new Map),e=R(new Map),t=R(null),o=_(()=>n.value.get(t.value)||[]),i=_(()=>e.value.get(t.value)||[]);function r($){t.value=$}async function c($,b=100,m=0){try{const h=await me.get(`/api/legions/${$}/timeline?limit=${b}&offset=${m}`),v=h.comms||[],T=h.total_count||v.length,E=h.has_more||!1;return v.sort((W,j)=>new Date(W.timestamp)-new Date(j.timestamp)),console.log(`Loaded ${v.length} of ${T} comms for legion ${$}`),n.value.set($,v),n.value=new Map(n.value),{comms:v,totalCount:T,hasMore:E}}catch(h){throw console.error("Failed to load timeline:",h),h}}function f($,b){n.value.has($)||n.value.set($,[]);const m=n.value.get($);if(m.some(v=>v.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}m.push(b),n.value=new Map(n.value)}async function p($,b){try{const h=(await me.post(`/api/legions/${$}/comms`,b)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${$}`),h}catch(m){throw console.error("Failed to send comm:",m),m}}async function d($){return console.log(`Minions for legion ${$} are already available in session store`),[]}async function u($,b){try{const h=(await me.post(`/api/legions/${$}/minions`,b)).minion;return await d($),console.log(`Created minion ${h.minion_id} in legion ${$}`),h}catch(m){throw console.error("Failed to create minion:",m),m}}async function w($){try{const b=await me.post(`/api/legions/${$}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${$}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function g($){try{const b=await me.post(`/api/legions/${$}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${$}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function k($){n.value.delete($),e.value.delete($),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:r,loadTimeline:c,addComm:f,sendComm:p,loadMinions:d,createMinion:u,haltAll:w,resumeAll:g,clearLegionData:k}}),jb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:_s},Symbol.toStringTag,{value:"Module"})),Pb={class:"timeline-header border-bottom p-3"},Rb={class:"project-name"},Wb=["title"],Bb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=je(),o=_(()=>t.projects.get(e.legionId)),i=_(()=>o.value?.name||"Legion");return(r,c)=>(a(),l("div",Pb,[s("div",null,[s("div",Rb,y(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Wb)])]))}},Fb=ne(Bb,[["__scopeId","data-v-44f386f5"]]),Hb={class:"timeline-status-bar border-top p-2 bg-light"},Vb={class:"d-flex justify-content-end"},Ub={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=_e();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),l("div",Hb,[s("div",Vb,[s("button",{class:se(["btn btn-sm",$e(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+y($e(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},qb=ne(Ub,[["__scopeId","data-v-891c73db"]]),zb={class:"comm-composer border-top p-3"},Kb={key:0,class:"d-flex gap-2 mb-2"},Gb={class:"flex-grow-1"},Yb=["disabled"],Jb={label:"Minions"},Qb=["value"],Xb={style:{"min-width":"150px"}},Zb=["disabled"],ey={class:"d-flex gap-2 align-items-end position-relative"},ty={class:"flex-grow-1 position-relative"},sy=["disabled"],ny=["onClick","onMouseenter"],oy=["disabled"],iy={key:0},ay={key:1},ry={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=_s(),o=de(),i=je(),r=R(""),c=R("task"),f=R(""),p=R(!1),d=R(window.innerWidth),u=R(!1),w=R([]),g=R(0),k=R(-1),$=R(null),b=R(null),m=_(()=>d.value<768),h=_(()=>{const G=i.projects.get(e.legionId);return!G||!G.session_ids?[]:G.session_ids.map(L=>o.sessions.get(L)).filter(L=>L)}),v=_(()=>r.value&&f.value.trim().length>0);function T(G){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[G.state]||"â—‹"}function E(G){return G.role?`${G.name} (${G.role})`:G.name}function W(){const G=$.value;if(!G)return;G.style.height="auto";const L=Math.min(G.scrollHeight,parseInt(getComputedStyle(G).maxHeight));G.style.height=L+"px"}function j(){const G=$.value;if(!G)return;W();const L=f.value,F=G.selectionStart,q=L.substring(0,F),Z=q.lastIndexOf("#");if(Z===-1){u.value=!1;return}const O=q.substring(Z+1).toLowerCase();if(O.includes(" ")){u.value=!1;return}const N=h.value.filter(D=>D.name.toLowerCase().includes(O)).map(D=>({type:"minion",name:D.name,role:D.role,id:D.session_id,state:D.state}));if(N.length===0){u.value=!1;return}w.value=N,g.value=0,k.value=Z,u.value=!0}function M(){if(!b.value)return;const G=b.value,L=G.children[g.value];if(!L)return;const F=L.offsetTop,q=L.offsetHeight,Z=G.scrollTop,O=G.clientHeight;F<Z?G.scrollTop=F:F+q>Z+O&&(G.scrollTop=F+q-O)}function V(G){if(!u.value){if(G.key==="Enter"&&!G.shiftKey){if(m.value)return;v.value&&(G.preventDefault(),x())}return}if(G.key==="ArrowDown")G.preventDefault(),g.value=(g.value+1)%w.value.length,M();else if(G.key==="ArrowUp")G.preventDefault(),g.value=g.value===0?w.value.length-1:g.value-1,M();else if(G.key==="Enter"){G.preventDefault();const L=w.value[g.value];L&&C(L)}else G.key==="Escape"&&(u.value=!1)}function C(G){const L=$.value;if(!L)return;const F=f.value,q=L.selectionStart,Z=F.substring(0,k.value)+"#"+G.name+" "+F.substring(q);f.value=Z;const O=k.value+G.name.length+2;setTimeout(()=>{L.setSelectionRange(O,O),L.focus()},0),u.value=!1}async function x(){if(!(!v.value||p.value)){p.value=!0;try{const[G,L]=r.value.split(":"),F={comm_type:c.value,content:f.value.trim()};G==="minion"&&(F.to_minion_id=L),await t.sendComm(e.legionId,F),f.value="",W()}catch(G){console.error("Failed to send comm:",G),alert(`Failed to send comm: ${G.message}`)}finally{p.value=!1}}}function B(){d.value=window.innerWidth}return ye(()=>{window.addEventListener("resize",B)}),Ee(()=>{window.removeEventListener("resize",B)}),fe(u,G=>{if(G){const L=F=>{F.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",L))};setTimeout(()=>document.addEventListener("click",L),0)}}),(G,L)=>(a(),l("div",zb,[n.hideRecipientSelector?A("",!0):(a(),l("div",Kb,[s("div",Gb,[ge(s("select",{"onUpdate:modelValue":L[0]||(L[0]=F=>r.value=F),class:"form-select form-select-sm",disabled:p.value},[L[3]||(L[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Jb,[(a(!0),l(re,null,ce(h.value,F=>(a(),l("option",{key:F.session_id,value:`minion:${F.session_id}`},y(T(F))+" "+y(E(F)),9,Qb))),128))])],8,Yb),[[_n,r.value]])]),s("div",Xb,[ge(s("select",{"onUpdate:modelValue":L[1]||(L[1]=F=>c.value=F),class:"form-select form-select-sm",disabled:p.value},[...L[4]||(L[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Zb),[[_n,c.value]])])])),s("div",ey,[s("div",ty,[ge(s("textarea",{ref_key:"contentTextarea",ref:$,"onUpdate:modelValue":L[2]||(L[2]=F=>f.value=F),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:j,onKeydown:V},null,40,sy),[[We,f.value]]),u.value?(a(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),l(re,null,ce(w.value,(F,q)=>(a(),l("div",{key:F.id,class:se(["autocomplete-item px-2 py-1",{"bg-light":q===g.value}]),onClick:Z=>C(F),onMouseenter:Z=>g.value=q},y(F.type==="minion"?T(F):"#ï¸âƒ£")+" "+y(F.name)+y(F.role?` (${F.role})`:""),43,ny))),128))],512)):A("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!v.value||p.value,onClick:x},[p.value?(a(),l("span",iy,[...L[5]||(L[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ie(" Sending... ",-1)])])):(a(),l("span",ay,"Send"))],8,oy)])])]))}},ly=ne(ry,[["__scopeId","data-v-e52b8e8f"]]),cy={class:"message-content-column-full"},uy=["aria-expanded"],dy={class:"comm-sender-recipient"},my={class:"comm-badge-summary"},py=["title"],fy={class:"comm-summary-text text-muted ms-2"},vy=["aria-label"],hy={key:0,class:"comm-content-body"},_y=["innerHTML"],gy="ffffffff-ffff-ffff-ffff-ffffffffffff",by={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=R(!1);function o(){t.value=!t.value}const i=_(()=>e.comm.from_minion_id===gy),r=_(()=>{const d=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${d.toLocaleString()}`}),c=_(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),f=_(()=>{if(e.comm.summary)return e.comm.summary;const d=e.comm.content||"";return d.length>100?d.substring(0,100)+"...":d}),p=_(()=>{const d=e.comm.content||"";let u=dt.parse(d);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),cs.sanitize(u)});return(d,u)=>(a(),l("div",{class:se(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",cy,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",dy,[s("strong",{class:se({"system-sender":i.value})},y(n.senderName),3),n.recipientName?(a(),l(re,{key:0},[u[0]||(u[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,y(n.recipientName),1)],64)):A("",!0)]),s("div",my,[s("span",{class:se(["badge",c.value]),title:r.value},y(n.comm.comm_type),11,py),s("span",fy,y(f.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,vy)],8,uy),t.value?(a(),l("div",hy,[s("div",{class:"message-text",innerHTML:p.value},null,8,_y)])):A("",!0)])],2))}},yy=ne(by,[["__scopeId","data-v-28513f64"]]),wy={class:"timeline-view d-flex flex-column h-100"},$y={key:0,class:"text-center text-muted"},ky={key:1,class:"text-center text-danger"},Sy={key:2,class:"text-center text-muted"},Ey={key:3,class:"comm-list"},Cy={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=_s();je();const o=de(),i=nt(),r=_e(),c=R(!0),f=R(null),p=R(null),d=_(()=>t.currentComms);function u(m){return m.from_user?"You":m.from_minion_id?m.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(m.from_minion_id)?.name||"Unknown":"Unknown"}function w(m){return m.to_user?"You":m.to_minion_id?o.sessions.get(m.to_minion_id)?.name||"Unknown":"All"}async function g(){r.autoScrollEnabled&&(await kt(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function k(){c.value=!0,f.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await kt(),await g(),setTimeout(()=>{g()},100)}catch(m){console.error("Failed to load timeline:",m),m.response?f.value=`${m.message} (${m.response.status})`:f.value=m.message||"Unknown error"}finally{c.value=!1}}function $(){i.connectLegion(e.legionId)}function b(){i.disconnectLegion()}return fe(()=>d.value.length,()=>{g()}),ye(()=>{o.currentSessionId=null,k(),$(),setTimeout(()=>{g()},100)}),Ee(()=>{b()}),(m,h)=>(a(),l("div",wy,[pe(Fb,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(a(),l("div",$y,[...h[0]||(h[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ie(" Loading timeline... ",-1)])])):f.value?(a(),l("div",ky," Failed to load timeline: "+y(f.value),1)):d.value.length===0?(a(),l("div",Sy," No messages yet. Minions will appear here once they start communicating. ")):(a(),l("div",Ey,[(a(!0),l(re,null,ce(d.value,v=>(a(),be(yy,{key:v.comm_id,comm:v,"sender-name":u(v),"recipient-name":w(v)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),pe(ly,{"legion-id":n.legionId},null,8,["legion-id"]),pe(qb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Ty=ne(Cy,[["__scopeId","data-v-b6752179"]]),xy={class:"minion-info flex-grow-1"},Ay={class:"minion-name"},My={key:0,class:"me-1"},Oy={key:1,class:"badge bg-secondary ms-2"},Dy={key:0,class:"latest-activity text-muted"},Ny={key:0,class:"activity-prefix"},Ly=["title"],Iy={key:1,class:"activity-time ms-1"},jy={key:1,class:"latest-activity text-muted"},Py={class:"activity-prefix"},Ry=["title"],Wy={key:2,class:"latest-activity text-muted fst-italic small"},By={class:"node-row"},Fy={class:"node-left"},Hy={key:0,class:"me-2"},Vy={key:1,class:"badge bg-secondary ms-2"},Uy={class:"node-right"},qy={key:0,class:"latest-message-preview"},zy={key:0,class:"message-prefix"},Ky=["title"],Gy={key:1,class:"message-time ms-1"},Yy={key:1,class:"last-comm-preview"},Jy={class:"comm-direction"},Qy=["title"],Xy={key:2,class:"text-muted fst-italic small"},Zy={class:"node-actions"},e1={key:2,class:"minion-children"},t1={key:1,class:"text-danger small ms-4"},s1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=de(),r=Ae(),c=_e(),f=_(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),p=_(()=>{if(!t.minionData||!t.minionData.id)return null;const C=r.messagesBySession.get(t.minionData.id);if(!C||C.length===0)return null;for(let x=C.length-1;x>=0;x--){const B=C[x],G=B.subtype||B.metadata?.subtype;if(B.type!=="result"&&!(B.type==="system"&&G==="init")&&!(B.type==="system"&&G==="task_notification")&&!(B.type==="permission_request"||B.type==="permission_response")){if(B.type==="user"&&B.metadata?.has_tool_results){const L=B.content||"";if(L.match(/^Tool results?: \d+ results?$/i)||L.trim()==="")continue}if(B.type==="user"){const L=B.content||"";if(L.includes("<command-message>")&&L.includes("skill is running")||L.startsWith("Base directory for this skill:"))continue}if(B.type==="user"){const L=B.content||"";if(L.includes("<command-message>")&&L.includes("<command-name>")&&L.includes("<command-args>")||L.includes("ARGUMENTS:")&&(L.includes("<command-name>")||L.match(/\nARGUMENTS:/)))continue}if(!(B.type==="system"&&B.content==="System message")&&!(B.type==="assistant"&&B.content==="Assistant response")&&(B.type==="user"||B.type==="assistant"||B.type==="system"))return{content:B.content,type:B.type,timestamp:B.timestamp}}}return null}),d=_(()=>{if(!t.minionData)return null;const C={...t.minionData};return f.value&&(C.state=f.value.state,C.is_processing=f.value.is_processing,f.value.name&&(C.name=f.value.name),f.value.latest_message&&(C.latest_message=f.value.latest_message,C.latest_message_type=f.value.latest_message_type,C.latest_message_time=f.value.latest_message_time)),p.value&&(C.latest_message=p.value.content,C.latest_message_type=p.value.type,C.latest_message_time=p.value.timestamp),C}),u=_(()=>t.level*24),w=_(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),g=_(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),k=_(()=>t.minionData&&t.minionData.is_overseer&&g.value),$=_(()=>{const C=d.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),b=_(()=>{const C=$.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),m=_(()=>{const C=$.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),h=_(()=>{const C=d.value;if(!C||!C.latest_message_type)return"";const x=C.latest_message_type;return x==="user"?"User -->:":x==="system"?"System:":""}),v=_(()=>{const C=d.value;if(!C||!C.latest_message)return"";const x=C.latest_message,B=150;return x.length>B?x.slice(0,B)+"...":x}),T=_(()=>{const C=d.value;if(!C||!C.latest_message_time)return"";try{const x=Date.now();let B;if(typeof C.latest_message_time=="number"?B=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:B=new Date(C.latest_message_time).getTime(),isNaN(B)||B<9466848e5||B>x+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",B),"";const G=x-B;if(G<0)return"just now";const L=Math.floor(G/6e4),F=Math.floor(L/60),q=Math.floor(F/24);return q>0?`${q}d ago`:F>0?`${F}h ago`:L>0?`${L}m ago`:"just now"}catch(x){return console.error("Error calculating relative time:",x,C.latest_message_time),""}});function E(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function W(C){const x=C.summary||C.content||"";return x.length>150?x.substring(0,150)+"...":x}function j(){o("minion-click",t.minionData.id)}function M(){const C=i.sessions.get(t.minionData.id);C&&c.showModal("edit-session",{session:C})}function V(){const C=i.sessions.get(t.minionData.id);C&&c.showModal("manage-session",{session:C})}return(C,x)=>{const B=vo("MinionTreeNode",!0);return n.minionData?(a(),l("div",{key:0,class:"minion-tree-node",style:ze({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),l("div",{key:0,class:se(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:j},[s("div",{class:se(["status-dot me-2",b.value]),style:ze(m.value)},null,6),s("div",xy,[s("div",Ay,[k.value?(a(),l("span",My,"ðŸ‘‘")):A("",!0),s("strong",null,y(d.value?.name||n.minionData.name),1),k.value?(a(),l("span",Oy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),d.value?.latest_message?(a(),l("div",Dy,[h.value?(a(),l("span",Ny,y(h.value),1)):A("",!0),s("span",{class:"activity-content",title:d.value.latest_message},y(v.value),9,Ly),T.value?(a(),l("span",Iy,"("+y(T.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(a(),l("div",jy,[s("span",Py,[x[1]||(x[1]=ie("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),x[2]||(x[2]=ie(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(W(n.minionData.last_comm)),9,Ry)])):(a(),l("div",Wy," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(M,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(V,["stop"])}," âš™ï¸ ")],2)):(a(),l("div",{key:1,class:se(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:j},[s("div",By,[s("div",Fy,[s("div",{class:se(["status-dot me-2",b.value]),style:ze(m.value)},null,6),k.value?(a(),l("span",Hy,"ðŸ‘‘")):A("",!0),s("strong",null,y(d.value?.name||n.minionData.name),1),k.value?(a(),l("span",Vy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),s("div",Uy,[d.value?.latest_message?(a(),l("div",qy,[h.value?(a(),l("span",zy,y(h.value),1)):A("",!0),s("span",{class:"message-content",title:d.value.latest_message},y(v.value),9,Ky),T.value?(a(),l("span",Gy,"("+y(T.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(a(),l("div",Yy,[s("span",Jy,[x[3]||(x[3]=ie("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),x[4]||(x[4]=ie(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(W(n.minionData.last_comm)),9,Qy)])):(a(),l("div",Xy," No activity yet "))]),s("div",Zy,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(M,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(V,["stop"])}," âš™ï¸ ")])])],2)),g.value?(a(),l("div",e1,[(a(!0),l(re,null,ce(n.minionData.children,G=>(a(),be(B,{key:G.id,"minion-data":G,level:n.level+1,layout:n.layout,onMinionClick:x[0]||(x[0]=L=>C.$emit("minion-click",L))},null,8,["minion-data","level","layout"]))),128))])):A("",!0)],4)):(a(),l("div",t1," âš  Minion data is missing "))}}},ki=ne(s1,[["__scopeId","data-v-64b23e0e"]]),n1={class:"project-overview d-flex flex-column h-100"},o1={class:"project-overview-header border-bottom p-3"},i1={class:"d-flex align-items-center justify-content-between"},a1={class:"mb-1"},r1={key:0,class:"me-2"},l1={class:"text-muted font-monospace"},c1={class:"d-flex gap-2"},u1=["title"],d1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},m1={key:0,class:"text-center py-5"},p1={key:1,class:"alert alert-danger"},f1={key:2,class:"text-center py-5"},v1={key:3},h1={class:"row g-3 mb-4"},_1={class:"col-md-4"},g1={class:"card h-100"},b1={class:"card-body"},y1={class:"card-title mb-0"},w1={class:"text-muted"},$1={class:"col-md-4"},k1={class:"card h-100"},S1={class:"card-body"},E1={class:"card-title mb-0"},C1={class:"text-muted"},T1={key:0,class:"card mb-4"},x1={class:"card mb-4"},A1={class:"card-header d-flex align-items-center justify-content-between"},M1={class:"mb-0"},O1={class:"badge bg-secondary"},D1={class:"card-body"},N1={key:0,class:"text-center py-4"},L1={key:1,class:"text-center text-muted py-4"},I1={key:2,class:"hierarchy-tree"},j1={class:"user-root-node mb-3 border rounded bg-white"},P1={class:"node-row"},R1={class:"node-left"},W1={class:"badge bg-primary ms-2"},B1={class:"node-right"},F1={key:0,class:"last-comm-preview"},H1={class:"comm-direction"},V1=["title"],U1={key:1,class:"text-muted fst-italic"},q1={class:"root-minions ms-4"},z1={class:"card"},K1={class:"card-body"},G1={class:"row mb-0"},Y1={class:"col-sm-8 font-monospace text-break"},J1={class:"col-sm-8 font-monospace text-break"},Q1={class:"col-sm-8"},X1={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},Z1={class:"text-muted"},ew={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Ft(),o=je(),i=de(),r=_e(),c=_s(),f=nt(),p=R(!1),d=R(null),u=R(null),w=R(!1);let g=null;const k=_(()=>o.getProject(e.projectId)),$=_(()=>k.value?.session_ids?k.value.session_ids.map(F=>i.getSession(F)).filter(F=>F!=null):[]),b=_(()=>$.value.length>0),m=_(()=>$.value.length),h=_(()=>$.value.filter(F=>F.state==="ACTIVE").length),v=_(()=>{const F=$.value.some(O=>O.state==="ACTIVE"),q=$.value.some(O=>O.is_processing);return $.value.some(O=>O.state==="ERROR")?"Error":q?"Working":F?"Active":m.value>0?"Idle":"Empty"}),T=_(()=>{switch(v.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),E=_(()=>{switch(v.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function W(){w.value=!0;try{const F=await me.get(`/api/legions/${e.projectId}/hierarchy`);u.value=F}catch(F){console.error("Failed to load minion hierarchy:",F),u.value=null}finally{w.value=!1}}function j(F,q){if(F&&F.id===q)return F;if(F&&F.children)for(const Z of F.children){const O=j(Z,q);if(O)return O}return null}function M(F){return F.to_user?"User":F.to_minion_name?F.to_minion_name:"unknown"}function V(F){const q=F.summary||F.content||"";return q.length>150?q.substring(0,150)+"...":q}function C(F){if(u.value){if(F.from_minion_id){const q=j(u.value,F.from_minion_id);q&&q.type==="minion"&&(q.last_comm=F)}F.from_user&&u.value.type==="user"&&(u.value.last_comm=F)}}function x(F){t.push(`/session/${F}`)}function B(){t.push(`/timeline/${e.projectId}`)}function G(){r.showModal("edit-project",{project:k.value})}function L(){r.showModal("create-minion",{project:k.value})}return ye(()=>{o.selectProject(e.projectId),i.currentSessionId=null,W(),c.setCurrentLegion(e.projectId),f.connectLegion(e.projectId),g=fe(()=>i.sessions,F=>{if(u.value){for(const[q,Z]of F)if(Z.project_id===e.projectId){const O=j(u.value,q);O&&O.type==="minion"&&(O.state!==Z.state&&(O.state=Z.state),O.is_processing!==Z.is_processing&&(O.is_processing=Z.is_processing),O.latest_message!==Z.latest_message&&(O.latest_message=Z.latest_message,O.latest_message_type=Z.latest_message_type,O.latest_message_time=Z.latest_message_time))}}},{deep:!0}),fe(()=>c.commsByLegion.get(e.projectId),F=>{if(F&&F.length>0){const q=F[F.length-1];C(q)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(F,q)=>{F!==q&&W()})}),fe(()=>e.projectId,F=>{o.selectProject(F),i.currentSessionId=null,W(),c.setCurrentLegion(F),f.connectLegion(F)}),Ee(()=>{g&&g()}),(F,q)=>(a(),l("div",n1,[s("div",o1,[s("div",i1,[s("div",null,[s("h4",a1,[b.value?(a(),l("span",r1,"ðŸ›")):A("",!0),ie(" "+y(k.value?.name||"Project Overview"),1)]),s("small",l1,y(k.value?.working_directory),1)]),s("div",c1,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:G}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:L}," âž• "+y(b.value?"Add Minion":"Add Session"),9,u1)])])]),s("div",d1,[p.value?(a(),l("div",m1,[...q[0]||(q[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):d.value?(a(),l("div",p1,y(d.value),1)):k.value?(a(),l("div",v1,[s("div",h1,[s("div",_1,[s("div",g1,[s("div",b1,[q[2]||(q[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",y1,y(m.value),1),s("small",w1,y(h.value)+" active",1)])])]),s("div",$1,[s("div",k1,[s("div",S1,[q[3]||(q[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",E1,[s("span",{class:se(T.value)},y(v.value),3)]),s("small",C1,y(E.value),1)])])])]),b.value?(a(),l("div",T1,[q[4]||(q[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:B}," ðŸ“Š View Timeline ")])])])):A("",!0),s("div",x1,[s("div",A1,[s("h5",M1,"ðŸŒ³ "+y(b.value?"Minion Hierarchy":"Sessions"),1),s("span",O1,y($.value.length),1)]),s("div",D1,[w.value?(a(),l("div",N1,[...q[5]||(q[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),l("div",L1,' No sessions yet. Click "Add Session" to create one. ')):(a(),l("div",I1,[s("div",j1,[s("div",P1,[s("div",R1,[q[6]||(q[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,y(u.value.name),1),s("span",W1,y(u.value.children.length)+" "+y(u.value.children.length===1?"minion":"minions"),1)]),s("div",B1,[u.value.last_comm?(a(),l("div",F1,[s("span",H1,[q[7]||(q[7]=ie(" â†’ ",-1)),s("strong",null,y(M(u.value.last_comm)),1),q[8]||(q[8]=ie(": ",-1))]),s("span",{class:"comm-content",title:u.value.last_comm.content||""},y(V(u.value.last_comm)),9,V1)])):(a(),l("div",U1," No communications yet "))])])]),s("div",q1,[(a(!0),l(re,null,ce(u.value.children,Z=>(a(),be(ki,{key:Z.id,"minion-data":Z,level:1,layout:"two-column",onMinionClick:x},null,8,["minion-data"]))),128))])]))])]),s("div",z1,[q[12]||(q[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",K1,[s("dl",G1,[q[9]||(q[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",Y1,y(k.value.working_directory),1),q[10]||(q[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",J1,y(k.value.project_id),1),q[11]||(q[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",Q1,y(b.value?"Yes (has minions)":"No"),1)])])])])):(a(),l("div",f1,[...q[1]||(q[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",X1,[q[13]||(q[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",Z1,y(m.value)+" session"+y(m.value!==1?"s":""),1)])]))}},tw=ne(ew,[["__scopeId","data-v-168bf04c"]]),sw=[{path:"/",name:"home",component:Ii},{path:"/project/:projectId",name:"project",component:tw,props:!0},{path:"/session/:sessionId",name:"session",component:Ib,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Ty,props:!0}],nw=Ei({history:Ci(),routes:sw}),ow={class:"connection-indicators"},iw=["title"],aw=["title"],rw=["title"],lw={__name:"ConnectionIndicator",setup(n){const e=nt();function t(i){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:c,retryCount:f}=r[i];return f>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(i){const r={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},f={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:p,retryCount:d}=f[i];let u="Disconnected";return p?u="Connected":d>0&&(u=`Reconnecting (attempt ${d})`),`${r[i]}
${c[i]}
Status: ${u}`}return(i,r)=>(a(),l("div",ow,[s("div",{class:se(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,iw),s("div",{class:se(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,aw),s("div",{class:se(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,rw)]))}},cw=ne(lw,[["__scopeId","data-v-d35b07c8"]]),uw={class:"d-flex align-items-center gap-2"},dw={__name:"AppHeader",setup(n){const e=_e();function t(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(i,r)=>(a(),l("header",{class:se(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",$e(e).isRedBackground?"theme-red-header":"bg-white"])},[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...r[1]||(r[1]=[s("span",null,"â˜°",-1)])]),r[2]||(r[2]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",uw,[s("button",{class:se(["btn btn-sm",$e(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:r[0]||(r[0]=c=>$e(e).toggleBackgroundColor())},[s("span",{class:"color-swatch",style:ze({backgroundColor:$e(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),pe(cw),s("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...r[3]||(r[3]=[s("span",null,"â–¤",-1)])])])],2))}},mw=ne(dw,[["__scopeId","data-v-1c36e730"]]),pw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},fw={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},vw=["title"],hw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=_(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(f){return f.state==="paused"&&f.is_processing?"pending-prompt":f.is_processing?"processing":f.state}function i(f){const p=o(f);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function r(f){const p=o(f);return p==="starting"||p==="processing"||p==="pending-prompt"}function c(f){const p=o(f),d=p.charAt(0).toUpperCase()+p.slice(1),u=f.name||"Unnamed Session",w=f.role?` (${f.role})`:"";return`${u}${w}: ${d}`}return(f,p)=>(a(),l("div",pw,[!n.sessions||n.sessions.length===0?(a(),l("div",fw)):(a(!0),l(re,{key:1},ce(n.sessions,d=>(a(),l("div",{key:d.session_id,class:se(["progress-bar",{"progress-bar-striped progress-bar-animated":r(d)}]),style:ze({width:t.value,backgroundColor:i(d),cursor:"help"}),title:c(d)},null,14,vw))),128))]))}},_w=ne(hw,[["__scopeId","data-v-391d77c1"]]),gw=["data-project-id"],bw=["id"],yw=["aria-expanded","aria-controls","aria-label","onKeydown"],ww=["aria-label","onKeydown"],$w={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},kw={class:"fw-semibold",style:{"flex-shrink":"0"}},Sw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Ew={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Cw=["title"],Tw=["title"],xw=["id","aria-labelledby"],Aw={class:"accordion-body p-0"},Mw={class:"list-group list-group-flush"},Ow={class:"minion-hierarchy-container"},Dw={key:0,class:"text-center py-2"},Nw={key:2,class:"text-muted text-center py-2 small"},Lw={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ft(),o=je(),i=de(),r=_e(),c=R(e.project.is_expanded||!1),f=R(null),p=R(!1);let d=null;const u=_(()=>o.formatPath(e.project.working_directory)),w=_(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(L=>i.getSession(L)).filter(L=>L!=null)),g=_(()=>w.value.length>0),k=_(()=>{const L=t.currentRoute.value;return L.name==="timeline"&&L.params.legionId===e.project.project_id}),$=_(()=>{const L=t.currentRoute.value;return L.name==="project"&&L.params.projectId===e.project.project_id});function b(L){const F=window.bootstrap;if(!F)return;const q=document.getElementById(`collapse-${e.project.project_id}`);if(!q)return;F.Collapse.getOrCreateInstance(q).toggle(),c.value=!c.value}function m(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function h(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function v(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const L=i.currentSessionId;L&&i.getSession(L)&&e.project.session_ids?.includes(L)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function T(){r.showModal("edit-project",{project:e.project})}function E(){r.showModal("create-minion",{project:e.project})}function W(){t.push(`/timeline/${e.project.project_id}`)}async function j(){p.value=!0;try{const L=await me.get(`/api/legions/${e.project.project_id}/hierarchy`);f.value=L}catch(L){console.error("Failed to load minion hierarchy:",L),f.value=null}finally{p.value=!1}}function M(L){t.push(`/session/${L}`)}function V(L,F){if(L&&L.id===F)return L;if(L&&L.children)for(const q of L.children){const Z=V(q,F);if(Z)return Z}return null}fe(c,L=>{L&&j()}),ye(()=>{d=fe(()=>i.sessions,L=>{if(!(!f.value||!c.value)){for(const[F,q]of L)if(q.project_id===e.project.project_id){const Z=V(f.value,F);Z&&Z.type==="minion"&&(Z.state!==q.state&&(Z.state=q.state),Z.is_processing!==q.is_processing&&(Z.is_processing=q.is_processing),Z.latest_message!==q.latest_message&&(Z.latest_message=q.latest_message,Z.latest_message_type=q.latest_message_type,Z.latest_message_time=q.latest_message_time))}}},{deep:!0}),fe(()=>i.sessions.size,(L,F)=>{if(c.value&&(L>F&&Array.from(i.sessions.values()).some(O=>O.project_id===e.project.project_id&&(!f.value||!V(f.value,O.session_id)))&&(console.log("New minion detected, reloading hierarchy"),j()),L<F&&f.value)){const q=i.sessions,Z=O=>O.type==="minion"&&!q.has(O.id)?!0:O.children?O.children.some(N=>Z(N)):!1;Z(f.value)&&(console.log("Minion deletion detected, reloading hierarchy"),j())}}),c.value&&j()}),Ee(()=>{d&&d()});function C(L){L.dataTransfer.effectAllowed="move",L.dataTransfer.setData("application/project-id",e.project.project_id),L.dataTransfer.setData("text/plain",e.project.project_id),L.target.classList.add("dragging")}function x(L){L.target.classList.remove("dragging")}function B(L){L.preventDefault(),L.dataTransfer.dropEffect="move";const F=L.currentTarget.getBoundingClientRect(),q=F.top+F.height/2;L.clientY<q?(L.currentTarget.classList.add("drop-above"),L.currentTarget.classList.remove("drop-below")):(L.currentTarget.classList.add("drop-below"),L.currentTarget.classList.remove("drop-above"))}function G(L){L.preventDefault(),L.currentTarget.classList.remove("drop-above","drop-below");const F=L.dataTransfer.getData("application/project-id")||L.dataTransfer.getData("text/plain");if(!F||F===e.project.project_id)return;const q=L.currentTarget.getBoundingClientRect(),Z=q.top+q.height/2,O=L.clientY<Z,N=o.orderedProjects,D=N.findIndex(te=>te.project_id===e.project.project_id),S=N.findIndex(te=>te.project_id===F);if(D===-1||S===-1)return;const I=[...N],[z]=I.splice(S,1);let J=O?D:D+1;S<D&&J--,I.splice(J,0,z);const K=I.map(te=>te.project_id);o.reorderProjects(K)}return(L,F)=>(a(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:C,onDragend:x,onDragover:B,onDrop:G},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:se(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":$.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:ve(b,["stop"]),onKeydown:[qe(ve(b,["prevent"]),["enter"]),qe(ve(b,["prevent"]),["space"])]},[(a(),l("svg",{class:se(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...F[0]||(F[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,yw),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:m,onKeydown:[qe(ve(m,["prevent"]),["enter"]),qe(ve(m,["prevent"]),["space"])]},[s("div",$w,[s("div",kw,[g.value?(a(),l("span",Sw,"ðŸ›")):A("",!0),ie(" "+y(n.project.name),1)]),s("div",Ew,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ve(T,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:ve(E,["stop"])}," âž• ",8,Cw)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(u.value),9,Tw)],40,ww)],2)],8,bw),pe(_w,{project:n.project,sessions:w.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:se(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:v},[s("div",Aw,[s("div",Mw,[g.value?(a(),l("div",{key:0,class:se(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:k.value}]),style:{cursor:"pointer"},onClick:W},[...F[1]||(F[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):A("",!0),s("div",Ow,[p.value?(a(),l("div",Dw,[...F[2]||(F[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):f.value&&f.value.children&&f.value.children.length>0?(a(!0),l(re,{key:1},ce(f.value.children,q=>(a(),be(ki,{key:q.id,"minion-data":q,level:0,layout:"sidebar",onMinionClick:M},null,8,["minion-data"]))),128)):(a(),l("div",Nw," No sessions "))])])])],42,xw)],40,gw))}},Iw=ne(Lw,[["__scopeId","data-v-a15b34e8"]]),jw={class:"project-list"},Pw={key:0,class:"text-muted text-center py-3"},Rw={__name:"ProjectList",setup(n){const e=je(),t=_(()=>e.orderedProjects);return(o,i)=>(a(),l("div",jw,[t.value.length===0?(a(),l("div",Pw,' No projects yet. Click "New" to create one. ')):A("",!0),(a(!0),l(re,null,ce(t.value,r=>(a(),be(Iw,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},Ww={class:"flex-grow-1 overflow-auto p-3"},Bw={id:"sessions-container"},Fw={__name:"Sidebar",setup(n){const e=_e(),t=_(()=>e.sidebarCollapsed),o=_(()=>e.isMobile),i=_(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function r(){e.showModal("create-project")}const c=R(!1);function f(u){c.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",d)}function p(u){c.value&&e.setSidebarWidth(u.clientX)}function d(){c.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",d)}return(u,w)=>(a(),l("aside",{id:"sidebar",class:se(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value,"theme-red-panel":$e(e).isRedBackground,"bg-light":!$e(e).isRedBackground}]),style:ze(i.value)},[s("div",Ww,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),s("div",Bw,[pe(Rw)])]),s("div",{class:"sidebar-resize-handle",onMousedown:f},null,32)],6))}},Hw=ne(Fw,[["__scopeId","data-v-d26424cf"]]),Vw={class:"task-row d-flex align-items-center gap-2"},Uw={key:0,class:"status-icon"},qw={key:1,class:"status-icon"},zw=["title"],Kw={key:0,class:"task-details"},Gw={key:0,class:"task-description mb-2"},Yw={class:"description-content"},Jw={key:1,class:"task-owner mb-2"},Qw={class:"ms-1"},Xw={key:2,class:"task-blocked-by mb-2"},Zw={key:3,class:"task-blocks"},e$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=_(()=>e.task.status==="in_progress"),o=_(()=>e.task.status==="completed"?"âœ…":"â³"),i=_(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=_(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,f)=>(a(),l("div",{class:se(["task-item",r.value]),onClick:f[0]||(f[0]=p=>c.$emit("toggle"))},[s("div",Vw,[t.value?(a(),l("span",Uw,[...f[1]||(f[1]=[s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),l("span",qw,y(o.value),1)),s("span",{class:"task-text flex-grow-1",title:n.task.subject},y(i.value),9,zw),(a(),l("svg",{class:se(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),l("div",Kw,[n.task.description?(a(),l("div",Gw,[f[3]||(f[3]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",Yw,y(n.task.description),1)])):A("",!0),n.task.owner?(a(),l("div",Jw,[f[4]||(f[4]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",Qw,y(n.task.owner),1)])):A("",!0),n.task.blockedBy?.length>0?(a(),l("div",Xw,[f[5]||(f[5]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),l(re,null,ce(n.task.blockedBy,p=>(a(),l("span",{key:p,class:"badge bg-warning text-dark me-1"}," #"+y(p),1))),128))])):A("",!0),n.task.blocks?.length>0?(a(),l("div",Zw,[f[6]||(f[6]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),l(re,null,ce(n.task.blocks,p=>(a(),l("span",{key:p,class:"badge bg-info text-dark me-1"}," #"+y(p),1))),128))])):A("",!0)])):A("",!0)],2))}},t$=ne(e$,[["__scopeId","data-v-0f96ae87"]]),s$={class:"task-list-panel"},n$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},o$={class:"d-flex align-items-center gap-2"},i$={key:0,class:"badge bg-secondary"},a$=["title"],r$={key:0,class:"task-list p-2"},l$={key:0,class:"text-muted text-center py-4"},c$={__name:"TaskListPanel",setup(n){const e=Rt();_e();const t=R(new Set),o=R(!1),i=_(()=>e.currentTasks),r=_(()=>e.currentTaskStats);function c(){o.value=!o.value}function f(p){t.value.has(p)?t.value.delete(p):t.value.add(p),t.value=new Set(t.value)}return(p,d)=>(a(),l("div",s$,[s("div",n$,[s("div",o$,[d[0]||(d[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),d[1]||(d[1]=s("h6",{class:"mb-0"},"Tasks",-1)),r.value.total>0?(a(),l("span",i$,y(r.value.completed)+"/"+y(r.value.total),1)):A("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:c,title:o.value?"Expand":"Collapse"},[(a(),l("svg",{class:se(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,a$)]),o.value?A("",!0):(a(),l("div",r$,[i.value.length===0?(a(),l("div",l$,[...d[3]||(d[3]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):A("",!0),pe(Ti,{name:"task-list",tag:"div"},{default:ho(()=>[(a(!0),l(re,null,ce(i.value,u=>(a(),be(t$,{key:u.id,task:u,isExpanded:t.value.has(u.id),onToggle:w=>f(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},u$=ne(c$,[["__scopeId","data-v-c03a807a"]]),d$={class:"resource-gallery-panel"},m$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},p$={class:"d-flex align-items-center gap-2"},f$={key:0,class:"badge bg-secondary"},v$=["title"],h$={key:0,class:"resource-grid-container p-2"},_$={key:0,class:"text-muted text-center py-4"},g$={key:1,class:"resource-grid"},b$=["onClick","title"],y$=["src","alt"],w$=["title"],$$={class:"file-icon"},k$={class:"file-ext"},S$={class:"resource-info"},E$=["title"],C$={class:"resource-actions"},T$=["onClick"],x$=["href","download"],A$={__name:"ResourceGallery",setup(n){const e=Xe(),t=de(),o=fo("addAttachmentFromResource",null),i=R(!1),r=_(()=>e.currentResources),c=_(()=>e.currentResourceCount);function f(){i.value=!i.value}function p(h){return e.isImageResource(h)}function d(h){return e.getResourceIcon(h)}function u(h){const v=e.getResourceExtension(h);return v?v.toUpperCase().slice(1):""}function w(h){return e.getResourceUrl(t.currentSessionId,h)}function g(h){return e.getDownloadUrl(t.currentSessionId,h)}function k(h){e.openFullView(t.currentSessionId,h)}function $(h,v=18){return h?h.length<=v?h:h.substring(0,v-3)+"...":""}function b(h){h.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function m(h){o?o(h):console.warn("addAttachmentFromResource not provided")}return(h,v)=>(a(),l("div",d$,[s("div",m$,[s("div",p$,[v[1]||(v[1]=s("span",{class:"panel-icon"},"ðŸ“",-1)),v[2]||(v[2]=s("h6",{class:"mb-0"},"Resources",-1)),c.value>0?(a(),l("span",f$,y(c.value),1)):A("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:f,title:i.value?"Expand":"Collapse"},[(a(),l("svg",{class:se(["chevron-icon",{expanded:!i.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...v[3]||(v[3]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,v$)]),i.value?A("",!0):(a(),l("div",h$,[r.value.length===0?(a(),l("div",_$,[...v[4]||(v[4]=[s("span",{class:"empty-icon"},"ðŸ“‚",-1),s("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),l("div",g$,[(a(!0),l(re,null,ce(r.value,(T,E)=>(a(),l("div",{key:T.resource_id,class:se(["resource-item",{"is-image":p(T)}])},[p(T)?(a(),l("div",{key:0,class:"resource-thumbnail",onClick:W=>k(E),title:T.title||"Click to view"},[s("img",{src:w(T.resource_id),alt:T.title||"Image",loading:"lazy",onError:b},null,40,y$)],8,b$)):(a(),l("div",{key:1,class:"resource-placeholder",title:T.title||T.original_filename||"File"},[s("span",$$,y(d(T)),1),s("span",k$,y(u(T)),1)],8,w$)),s("div",S$,[s("div",{class:"resource-title",title:T.title||T.original_filename},y($(T.title||T.original_filename)),9,E$),s("div",C$,[s("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ve(W=>m(T),["stop"]),title:"Add to message attachments"},[...v[5]||(v[5]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,T$),s("a",{href:g(T.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:T.original_filename||T.title||"download",title:"Download",onClick:v[0]||(v[0]=ve(()=>{},["stop"]))},[...v[6]||(v[6]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),s("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,x$)])])],2))),128))]))]))]))}},M$=ne(A$,[["__scopeId","data-v-3bb063c1"]]),O$=["src","alt"],D$={key:1,class:"image-info"},N$={key:0,class:"image-title"},L$={key:1,class:"image-description"},I$={class:"image-meta"},j$={class:"meta-item"},P$={class:"meta-item"},R$={class:"meta-item"},W$={key:2,class:"position-indicator"},B$={key:3,class:"thumbnail-strip"},F$=["onClick"],H$=["src","alt"],V$={__name:"ImageFullView",setup(n){const e=Xe(),t=R(null),o=_(()=>e.fullViewOpen),i=_(()=>e.currentFullViewResource),r=_(()=>e.currentResourceIndex),c=_(()=>e.fullViewTotalResources),f=_(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]);fe(o,v=>{v?(kt(()=>{t.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Ee(()=>{document.body.style.overflow=""});function p(v){return e.getResourceUrl(e.fullViewSessionId,v)}function d(){e.closeFullView()}function u(){e.nextResource()}function w(){e.prevResource()}function g(v){e.goToResource(v)}function k(v){v.target===v.currentTarget&&d()}function $(v){switch(v.key){case"Escape":d();break;case"ArrowLeft":w();break;case"ArrowRight":u();break;case"Home":g(0);break;case"End":g(c.value-1);break}}function b(v){return v?v<1024?`${v} B`:v<1024*1024?`${(v/1024).toFixed(1)} KB`:`${(v/(1024*1024)).toFixed(2)} MB`:""}function m(v){return v?new Date(v*1e3).toLocaleString():""}function h(v){v.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(v,T)=>(a(),be(Ai,{to:"body"},[pe(xi,{name:"modal"},{default:ho(()=>[o.value?(a(),l("div",{key:0,class:"image-full-view-overlay",onClick:k,onKeydown:$,tabindex:"0",ref_key:"overlayRef",ref:t},[s("button",{class:"close-btn",onClick:ve(d,["stop"]),title:"Close (Escape)"},[...T[1]||(T[1]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),c.value>1?(a(),l("button",{key:0,class:"nav-btn nav-prev",onClick:ve(w,["stop"]),title:"Previous (Left Arrow)"},[...T[2]||(T[2]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"15 18 9 12 15 6"})],-1)])])):A("",!0),s("div",{class:"image-container",onClick:T[0]||(T[0]=ve(()=>{},["stop"]))},[i.value?(a(),l("img",{key:0,src:p(i.value.resource_id||i.value.image_id),alt:i.value.title||"Image",class:"full-image",onError:h},null,40,O$)):A("",!0),i.value?(a(),l("div",D$,[i.value.title?(a(),l("h5",N$,y(i.value.title),1)):A("",!0),i.value.description?(a(),l("p",L$,y(i.value.description),1)):A("",!0),s("div",I$,[s("span",j$,y(b(i.value.size_bytes)),1),s("span",P$,y(i.value.format?.toUpperCase()),1),s("span",R$,y(m(i.value.timestamp)),1)])])):A("",!0)]),c.value>1?(a(),l("button",{key:1,class:"nav-btn nav-next",onClick:ve(u,["stop"]),title:"Next (Right Arrow)"},[...T[3]||(T[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"9 18 15 12 9 6"})],-1)])])):A("",!0),c.value>1?(a(),l("div",W$,y(r.value+1)+" / "+y(c.value),1)):A("",!0),c.value>1?(a(),l("div",B$,[(a(!0),l(re,null,ce(f.value,(E,W)=>(a(),l("div",{key:E.resource_id||E.image_id,class:se(["strip-thumbnail",{active:W===r.value}]),onClick:ve(j=>g(W),["stop"])},[s("img",{src:p(E.resource_id||E.image_id),alt:E.title||"Thumbnail",loading:"lazy"},null,8,H$)],10,F$))),128))])):A("",!0)],544)):A("",!0)]),_:1})]))}},U$=ne(V$,[["__scopeId","data-v-9bc36988"]]),q$={class:"panels-container"},z$={__name:"RightSidebar",setup(n){const e=_e(),t=_(()=>e.rightSidebarCollapsed),o=_(()=>e.isMobile),i=_(()=>{if(o.value)return{};const d=`${e.rightSidebarWidth}px`;return{width:d,minWidth:"200px",maxWidth:"30vw","--sidebar-width":d}}),r=R(!1);function c(d){d.preventDefault(),r.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",p)}function f(d){if(r.value){const u=window.innerWidth-d.clientX;e.setRightSidebarWidth(u)}}function p(){r.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",p)}return(d,u)=>(a(),l("aside",{id:"right-sidebar",class:se(["border-start d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,resizing:r.value,"theme-red-panel":$e(e).isRedBackground,"bg-light":!$e(e).isRedBackground}]),style:ze(i.value)},[s("div",q$,[pe(u$),pe(M$)]),s("div",{class:"sidebar-resize-handle",onMousedown:c},null,32),pe(U$)],6))}},K$=ne(z$,[["__scopeId","data-v-94ca15d2"]]),G$={class:"modal-dialog modal-lg"},Y$={class:"modal-content"},J$={class:"modal-body"},Q$={class:"mb-3"},X$={class:"input-group"},Z$=["disabled"],ek={key:0,class:"text-center py-4"},tk={key:1,class:"alert alert-danger",role:"alert"},sk={key:2,class:"folder-list"},nk=["onClick","onDblclick"],ok={class:"d-flex align-items-center flex-grow-1"},ik=["onClick"],ak={key:1,class:"text-center text-muted py-3"},rk={class:"modal-footer"},lk=["disabled"],ck={__name:"FolderBrowserModal",setup(n){const e=_e(),t=R(""),o=R(""),i=R([]),r=R(!1),c=R(""),f=R(null);let p=null,d=null;const u=_(()=>{if(!t.value)return null;const T=t.value.split(/[\\/]/).filter(Boolean);return T.length<=1?null:(T.pop(),T.length>0?"/"+T.join("/"):"/")});function w(T){if(!T)return"";const E=T.split(/[\\/]/).filter(Boolean);return E.length<=2?T:".../"+E.slice(-2).join("/")}async function g(){r.value=!0,c.value="",i.value=[],o.value="";try{const T=t.value?{path:t.value}:{},E=await me.get("/api/filesystem/browse",{params:T});E.current_path&&(t.value=E.current_path),i.value=E.directories||[]}catch(T){console.error("Failed to load directory:",T),c.value=T.message||"Failed to load directory"}finally{r.value=!1}}function k(T){o.value=T.path}function $(T){t.value=T.path,o.value="",g()}function b(){u.value&&(t.value=u.value,o.value="",g())}function m(){const T=o.value||t.value;T&&d&&d(T),p&&p.hide()}function h(){g()}function v(){i.value=[],o.value="",c.value="",d=null,e.hideModal()}return fe(()=>e.currentModal,T=>{if(T?.name==="folder-browser"&&p){const E=T.data||{};t.value=E.defaultPath||E.currentPath||"",d=E.onSelect||null,p.show()}}),ye(()=>{f.value&&xe(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{p=new T(f.value),f.value.addEventListener("shown.bs.modal",h),f.value.addEventListener("hidden.bs.modal",v)})}),Ee(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",h),f.value.removeEventListener("hidden.bs.modal",v)),p&&p.dispose()}),(T,E)=>(a(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[s("div",G$,[s("div",Y$,[E[6]||(E[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",J$,[s("div",Q$,[E[1]||(E[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",X$,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=W=>t.value=W),onKeyup:qe(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:g,disabled:r.value}," ðŸ”„ Refresh ",8,Z$)])]),r.value?(a(),l("div",ek,[...E[2]||(E[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(a(),l("div",tk,y(c.value),1)):(a(),l("div",sk,[u.value?(a(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...E[3]||(E[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):A("",!0),(a(!0),l(re,null,ce(i.value,W=>(a(),l("div",{key:W.path,class:se(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:W.path===o.value}]),onClick:j=>k(W),onDblclick:j=>$(W),role:"button"},[s("div",ok,[E[4]||(E[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,y(W.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:ve(j=>$(W),["stop"])}," Open ",8,ik)],42,nk))),128)),i.value.length===0?(a(),l("div",ak," No subdirectories found ")):A("",!0)]))]),s("div",rk,[E[5]||(E[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:!o.value},' Select "'+y(w(o.value||t.value))+'" ',9,lk)])])])],512))}},uk=ne(ck,[["__scopeId","data-v-0d61ed46"]]),dk={class:"modal-dialog"},mk={class:"modal-content"},pk={class:"modal-body"},fk={class:"mb-3"},vk={key:0,class:"invalid-feedback"},hk={class:"mb-3"},_k={class:"input-group"},gk={key:0,class:"invalid-feedback"},bk={class:"mb-3 form-check"},yk={key:0,class:"mb-3 ms-4"},wk={key:1,class:"alert alert-danger",role:"alert"},$k={class:"modal-footer"},kk=["disabled"],Sk={key:0,class:"spinner-border spinner-border-sm me-2"},Ek={__name:"ProjectCreateModal",setup(n){const e=je(),t=de(),o=_e(),i=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=R({name:"",workingDirectory:""}),c=R(!1),f=R(""),p=R(null);let d=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:m=>{i.value.workingDirectory=m,r.value.workingDirectory=""}})}function w(){r.value={};let m=!0;return i.value.name.trim()||(r.value.name="Project name is required",m=!1),i.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",m=!1),m}async function g(){if(w()){c.value=!0,f.value="";try{const m=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(m.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),d&&d.hide(),k()}catch(m){console.error("Failed to create project:",m),f.value=m.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function k(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},f.value=""}function $(){const m=document.getElementById("projectName");m&&m.focus()}function b(){k(),o.hideModal()}return fe(()=>o.currentModal,m=>{m?.name==="create-project"&&d&&d.show()}),ye(()=>{p.value&&xe(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{d=new m(p.value),p.value.addEventListener("shown.bs.modal",$),p.value.addEventListener("hidden.bs.modal",b)})}),Ee(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",$),p.value.removeEventListener("hidden.bs.modal",b)),d&&d.dispose()}),(m,h)=>(a(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",dk,[s("div",mk,[h[11]||(h[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",pk,[s("form",{onSubmit:ve(g,["prevent"])},[s("div",fk,[h[4]||(h[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:se(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=v=>i.value.name=v),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),r.value.name?(a(),l("div",vk,y(r.value.name),1)):A("",!0)]),s("div",hk,[h[5]||(h[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",_k,[ge(s("input",{type:"text",class:se(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=v=>i.value.workingDirectory=v),placeholder:"/path/to/project",required:""},null,2),[[We,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),r.value.workingDirectory?(a(),l("div",gk,y(r.value.workingDirectory),1)):A("",!0)]),h[6]||(h[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",bk,[ge(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=v=>i.value.createSession=v)},null,512),[[Mi,i.value.createSession]]),h[7]||(h[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),l("div",yk,[h[9]||(h[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ge(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=v=>i.value.sessionName=v),placeholder:"main"},null,512),[[We,i.value.sessionName]])])):A("",!0),f.value?(a(),l("div",wk,y(f.value),1)):A("",!0)],32)]),s("div",$k,[h[10]||(h[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:c.value},[c.value?(a(),l("span",Sk)):A("",!0),ie(" "+y(c.value?"Creating...":"Create Project"),1)],8,kk)])])])],512))}},Ck=ne(Ek,[["__scopeId","data-v-ea55fdae"]]),Tk={class:"modal-dialog"},xk={class:"modal-content"},Ak={class:"modal-body"},Mk={class:"mb-3"},Ok={key:0,class:"invalid-feedback"},Dk={class:"mb-3"},Nk=["value"],Lk={key:0,class:"alert alert-danger",role:"alert"},Ik={class:"danger-zone"},jk={class:"text-muted small"},Pk=["disabled"],Rk={key:0,class:"alert alert-warning mt-3",role:"alert"},Wk={class:"mb-2"},Bk={class:"d-flex gap-2"},Fk=["disabled"],Hk={key:0,class:"spinner-border spinner-border-sm me-2"},Vk=["disabled"],Uk={class:"modal-footer"},qk=["disabled"],zk={key:0,class:"spinner-border spinner-border-sm me-2"},Kk={__name:"ProjectEditModal",setup(n){const e=je(),t=_e(),o=R(null),i=R({name:""}),r=R({name:""}),c=R(!1),f=R(!1),p=R(""),d=R(!1),u=R(null);let w=null;const g=_(()=>o.value?.session_ids?.length||0);function k(){r.value={};let T=!0;return i.value.name.trim()||(r.value.name="Project name is required",T=!1),T}async function $(){if(!(!k()||!o.value)){c.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),w&&w.hide()}catch(T){console.error("Failed to update project:",T),p.value=T.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function b(){if(o.value){f.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(T){console.error("Failed to delete project:",T),p.value=T.message||"Failed to delete project. Please try again."}finally{f.value=!1}}}function m(){i.value={name:""},r.value={},p.value="",d.value=!1}function h(){const T=document.getElementById("editProjectName");T&&(T.focus(),T.select())}function v(){m(),o.value=null,t.hideModal()}return fe(()=>t.currentModal,T=>{if(T?.name==="edit-project"&&w){const E=T.data||{};o.value=E.project,o.value&&(i.value.name=o.value.name),w.show()}}),ye(()=>{u.value&&xe(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{w=new T(u.value),u.value.addEventListener("shown.bs.modal",h),u.value.addEventListener("hidden.bs.modal",v)})}),Ee(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",h),u.value.removeEventListener("hidden.bs.modal",v)),w&&w.dispose()}),(T,E)=>(a(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",Tk,[s("div",xk,[E[10]||(E[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Ak,[s("form",{onSubmit:ve($,["prevent"])},[s("div",Mk,[E[3]||(E[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:se(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":E[0]||(E[0]=W=>i.value.name=W),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),r.value.name?(a(),l("div",Ok,y(r.value.name),1)):A("",!0)]),s("div",Dk,[E[4]||(E[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Nk),E[5]||(E[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(a(),l("div",Lk,y(p.value),1)):A("",!0)],32),E[8]||(E[8]=s("hr",null,null,-1)),s("div",Ik,[E[6]||(E[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",jk," Deleting this project will also delete all "+y(g.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:E[1]||(E[1]=W=>d.value=!0),disabled:f.value}," ðŸ—‘ï¸ Delete Project ",8,Pk)]),d.value?(a(),l("div",Rk,[E[7]||(E[7]=s("strong",null,"Are you sure?",-1)),s("p",Wk,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(g.value)+" session(s). ",1),s("div",Bk,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:f.value},[f.value?(a(),l("span",Hk)):A("",!0),ie(" "+y(f.value?"Deleting...":"Yes, Delete Permanently"),1)],8,Fk),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:E[2]||(E[2]=W=>d.value=!1),disabled:f.value}," Cancel ",8,Vk)])])):A("",!0)]),s("div",Uk,[E[9]||(E[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:$,disabled:c.value},[c.value?(a(),l("span",zk)):A("",!0),ie(" "+y(c.value?"Saving...":"Save Changes"),1)],8,qk)])])])],512))}},Gk=ne(Kk,[["__scopeId","data-v-52679516"]]),Yk={class:"general-tab"},Jk={key:0,class:"mb-3"},Qk={for:"template-select",class:"form-label"},Xk=["value"],Zk=["value"],eS={key:0,class:"form-text"},tS={class:"mb-3"},sS={for:"config-name",class:"form-label"},nS=["value","placeholder","pattern","title"],oS={key:0,class:"invalid-feedback"},iS={key:1,class:"form-text"},aS={key:1,class:"mb-3"},rS=["value"],lS={class:"mb-3"},cS=["value"],uS={class:"form-text"},dS={key:0,class:"text-warning"},mS={key:1},pS={class:"mb-3"},fS={for:"config-permission-mode",class:"form-label"},vS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},hS={key:1,class:"field-indicator modified",title:"Modified from template"},_S=["value","disabled"],gS={key:0,value:"bypassPermissions"},bS={class:"form-text"},yS={key:0,class:"text-warning"},wS={key:1},$S={class:"mb-3"},kS={for:"config-role",class:"form-label"},SS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ES={key:1,class:"field-indicator modified",title:"Modified from template"},CS=["value","placeholder"],TS={class:"form-text"},xS={key:2,class:"mb-3"},AS={class:"input-group"},MS=["value","placeholder","disabled","readonly"],OS={class:"form-text"},DS={key:3,class:"mb-3"},NS={class:"form-control-plaintext"},LS={key:4,class:"mb-3 form-check"},IS=["checked"],jS={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=_(()=>e.mode==="create-session"||e.mode==="edit-session"),o=_(()=>e.mode==="create-template"||e.mode==="edit-template"),i=_(()=>e.mode==="create-session"),r=_(()=>e.mode==="edit-session"),c=_(()=>e.session?.state==="active"||e.session?.state==="starting"),f=_(()=>{if(!e.session)return!1;const b=e.session.model||"sonnet";return e.formData.model!==b}),p=_(()=>e.session?.initial_permission_mode==="bypassPermissions"),d=_(()=>e.selectedTemplateId?e.templates.find(b=>b.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},w=_(()=>u[e.formData.model]||null),g=_(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),k=_(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function $(b){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[b]||"bg-secondary"}return(b,m)=>(a(),l("div",Yk,[i.value?(a(),l("div",Jk,[s("label",Qk,[m[10]||(m[10]=ie(" Template ",-1)),s("button",{type:"button",onClick:m[0]||(m[0]=h=>b.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:m[1]||(m[1]=h=>b.$emit("update:selected-template-id",h.target.value||null)),class:"form-select"},[m[11]||(m[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),l(re,null,ce(n.templates,h=>(a(),l("option",{key:h.template_id,value:h.template_id},y(h.name),9,Zk))),128))],40,Xk),d.value?(a(),l("div",eS,y(d.value.description),1)):A("",!0)])):A("",!0),s("div",tS,[s("label",sS,[ie(y(o.value?"Template Name":"Session Name")+" ",1),m[12]||(m[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:se(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:m[2]||(m[2]=h=>b.$emit("update:form-data","name",h.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,nS),n.errors.name?(a(),l("div",oS,y(n.errors.name),1)):A("",!0),t.value?(a(),l("div",iS,"Must be a single word (no spaces) for #nametag matching")):A("",!0)]),o.value?(a(),l("div",aS,[m[13]||(m[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:m[3]||(m[3]=h=>b.$emit("update:form-data","description",h.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,rS)])):A("",!0),s("div",lS,[m[16]||(m[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:m[4]||(m[4]=h=>b.$emit("update:form-data","model",h.target.value))},[...m[14]||(m[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,cS),s("div",uS,[r.value&&c.value&&f.value?(a(),l("span",dS,[...m[15]||(m[15]=[ie(" Model change requires a ",-1),s("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):w.value?(a(),l("span",mS,y(w.value.description),1)):A("",!0)])]),s("div",pS,[s("label",fS,[m[17]||(m[17]=ie(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),l("span",vS," < ")):A("",!0),n.fieldStates.permission_mode==="modified"?(a(),l("span",hS," * ")):A("",!0)]),s("select",{id:"config-permission-mode",class:se(["form-select",k.value]),value:n.formData.permission_mode,onChange:m[5]||(m[5]=h=>b.$emit("update:form-data","permission_mode",h.target.value)),disabled:r.value&&!c.value},[m[18]||(m[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),m[19]||(m[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),m[20]||(m[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||p.value?(a(),l("option",gS," Bypass Permissions (No prompts - use with caution) ")):A("",!0)],42,_S),s("div",bS,[r.value&&!c.value?(a(),l("span",yS," Session must be active to change permission mode. Start the session first. ")):(a(),l("span",wS,"Controls which tool actions require permission prompts"))])]),s("div",$S,[s("label",kS,[ie(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),l("span",SS," < ")):A("",!0),n.fieldStates.default_role==="modified"?(a(),l("span",ES," * ")):A("",!0)]),s("input",{id:"config-role",type:"text",class:se(["form-control",g.value]),value:n.formData.default_role,onInput:m[6]||(m[6]=h=>b.$emit("update:form-data","default_role",h.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,CS),s("div",TS,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(a(),l("div",xS,[m[21]||(m[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",AS,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:m[7]||(m[7]=h=>b.$emit("update:form-data","working_directory",h.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,MS),r.value?A("",!0):(a(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:m[8]||(m[8]=h=>b.$emit("open-folder-browser"))}," Browse "))]),s("div",OS,y(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):A("",!0),r.value&&n.session?(a(),l("div",DS,[m[22]||(m[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",NS,[s("span",{class:se(["badge",$(n.session.state)])},y(n.session.state),3)])])):A("",!0),i.value?(a(),l("div",LS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:m[9]||(m[9]=h=>b.$emit("update:form-data","startImmediately",h.target.checked))},null,40,IS),m[23]||(m[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):A("",!0)]))}},PS=ne(jS,[["__scopeId","data-v-b9edc342"]]),RS={class:"permissions-tab"},WS={class:"mb-3"},BS={for:"config-allowed-tools",class:"form-label"},FS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},HS={key:1,class:"field-indicator modified",title:"Modified from template"},VS={key:0,class:"tools-list mb-2"},US=["onClick"],qS={class:"input-group input-group-sm"},zS=["onKeydown"],KS=["disabled"],GS={class:"mt-2"},YS=["onClick"],JS={class:"form-text"},QS={key:0,class:"text-warning"},XS={key:1},ZS={class:"mb-3"},eE={class:"capabilities-editor"},tE={key:0,class:"capabilities-list mb-2"},sE=["onClick"],nE={class:"input-group input-group-sm"},oE=["onKeydown"],iE=["disabled"],aE={key:0,class:"mb-3"},rE={class:"settings-sources-editor"},lE={class:"form-check"},cE=["checked"],uE={class:"form-check"},dE=["checked"],mE={class:"form-check"},pE=["checked"],fE={class:"form-text"},vE={key:0,class:"text-warning"},hE={key:1},_E={key:1,class:"mb-3"},gE={class:"mb-3"},bE={key:0,class:"mt-2"},yE=["value"],wE=["value"],$E={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=R(""),r=R(""),c=R(!1),f=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=_(()=>t.mode==="create-template"||t.mode==="edit-template"),d=_(()=>t.mode==="create-session"||t.mode==="edit-session"),u=_(()=>t.mode==="edit-session"),w=_(()=>t.session?.state==="active"||t.session?.state==="starting"),g=_(()=>{if(!t.session)return!1;const C=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==C}),k=_(()=>t.formData.setting_sources||["user","project","local"]),$=_(()=>{if(!t.session)return!1;const C=t.session.setting_sources||["user","project","local"],x=t.formData.setting_sources||["user","project","local"];return JSON.stringify(C.sort())!==JSON.stringify(x.sort())}),b=_(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(C=>C.trim()).filter(C=>C.length>0)),m=_(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(C=>C.trim()).filter(C=>C.length>0)),h=_(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),v=_(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function T(){const C=i.value.trim();if(C){if(!b.value.includes(C)){const x=[...b.value,C];o("update:form-data","allowed_tools",x.join(", "))}i.value=""}}function E(C){const x=[...b.value];x.splice(C,1),o("update:form-data","allowed_tools",x.join(", "))}function W(C){if(b.value.includes(C)){const x=b.value.indexOf(C);E(x)}else{const x=[...b.value,C];o("update:form-data","allowed_tools",x.join(", "))}}function j(){const C=r.value.trim().toLowerCase();if(C){if(!m.value.includes(C)){const x=[...m.value,C];o("update:form-data","capabilities",x.join(", "))}r.value=""}}function M(C){const x=[...m.value];x.splice(C,1),o("update:form-data","capabilities",x.join(", "))}function V(C){const x=[...k.value],B=x.indexOf(C);B>=0?x.splice(B,1):x.push(C),o("update:form-data","setting_sources",x)}return(C,x)=>(a(),l("div",RS,[s("div",WS,[s("label",BS,[x[9]||(x[9]=ie(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),l("span",FS," < ")):A("",!0),n.fieldStates.allowed_tools==="modified"?(a(),l("span",HS," * ")):A("",!0)]),s("div",{class:se(["allowed-tools-editor",v.value])},[b.value.length>0?(a(),l("div",VS,[(a(!0),l(re,null,ce(b.value,(B,G)=>(a(),l("span",{key:G,class:"badge bg-primary me-1 mb-1 tool-badge"},[ie(y(B)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>E(G),"aria-label":"Remove tool"},null,8,US)]))),128))])):A("",!0),s("div",qS,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=B=>i.value=B),onKeydown:qe(ve(T,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,zS),[[We,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:T,disabled:!i.value.trim()}," Add ",8,KS)]),s("div",GS,[x[10]||(x[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),l(re,null,ce(f,B=>s("button",{key:B,type:"button",class:se(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":b.value.includes(B)}]),onClick:G=>W(B)},y(B),11,YS)),64))])],2),s("div",JS,[u.value&&w.value&&g.value?(a(),l("span",QS,[...x[11]||(x[11]=[ie(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):(a(),l("span",XS,y(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",ZS,[x[12]||(x[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",eE,[m.value.length>0?(a(),l("div",tE,[(a(!0),l(re,null,ce(m.value,(B,G)=>(a(),l("span",{key:G,class:"badge bg-info me-1 mb-1 capability-badge"},[ie(y(B)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>M(G),"aria-label":"Remove capability"},null,8,sE)]))),128))])):A("",!0),s("div",nE,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":x[1]||(x[1]=B=>r.value=B),onKeydown:qe(ve(j,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,oE),[[We,r.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:j,disabled:!r.value.trim()}," Add ",8,iE)])]),x[13]||(x[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),d.value?(a(),l("div",aE,[x[18]||(x[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",rE,[s("div",lE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:k.value.includes("user"),onChange:x[2]||(x[2]=B=>V("user"))},null,40,cE),x[14]||(x[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[ie(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",uE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:k.value.includes("project"),onChange:x[3]||(x[3]=B=>V("project"))},null,40,dE),x[15]||(x[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[ie(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",mE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:k.value.includes("local"),onChange:x[4]||(x[4]=B=>V("local"))},null,40,pE),x[16]||(x[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[ie(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",fE,[u.value&&w.value&&$.value?(a(),l("span",vE,[...x[17]||(x[17]=[ie(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),ie(" to take effect. ",-1)])])):(a(),l("span",hE," Select which settings files to load permissions from "))])])):A("",!0),d.value?(a(),l("div",_E,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:x[5]||(x[5]=B=>C.$emit("preview-permissions"))}," Preview Effective Permissions ")])):A("",!0),s("div",gE,[s("a",{class:"text-muted small",role:"button",onClick:x[6]||(x[6]=B=>c.value=!c.value)},y(c.value?"Hide":"Show")+" raw input ",1),c.value?(a(),l("div",bE,[x[19]||(x[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:se(["form-control form-control-sm",h.value]),value:n.formData.allowed_tools,onInput:x[7]||(x[7]=B=>C.$emit("update:form-data","allowed_tools",B.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,yE),x[20]||(x[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:x[8]||(x[8]=B=>C.$emit("update:form-data","capabilities",B.target.value)),placeholder:"python, testing, debugging"},null,40,wE)])):A("",!0)])]))}},kE=ne($E,[["__scopeId","data-v-e58aa2be"]]),SE={class:"advanced-tab"},EE={key:0,class:"alert alert-warning mb-3",role:"alert"},CE={class:"mb-3"},TE={for:"config-system-prompt",class:"form-label"},xE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},AE={key:1,class:"field-indicator modified",title:"Modified from template"},ME=["value","rows","placeholder"],OE={class:"form-text"},DE={class:"mb-3 form-check"},NE=["checked"],LE={key:0,class:"form-text text-warning"},IE={key:1,class:"mb-3 form-check"},jE=["checked"],PE={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=_(()=>t.mode==="create-session"||t.mode==="edit-session"),r=_(()=>t.mode==="create-template"||t.mode==="edit-template"),c=_(()=>t.mode==="edit-session"),f=_(()=>t.session?.state==="active"||t.session?.state==="starting"),p=_(()=>{if(!t.session)return!1;const $=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),b=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),m=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return $||b||m}),d=_(()=>r.value?t.formData.system_prompt:t.formData.initialization_context),u=_(()=>r.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),w=_(()=>t.formData.override_system_prompt?r.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":r.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),g=_(()=>{const $={};return t.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$});function k($){const b=$.target.value,m=r.value?"system_prompt":"initialization_context";o("update:form-data",m,b)}return($,b)=>(a(),l("div",SE,[c.value&&f.value&&p.value?(a(),l("div",EE,[...b[2]||(b[2]=[s("small",null,[ie("Changes to these settings require a "),s("strong",null,"reset"),ie(" (not restart) to take effect.")],-1)])])):A("",!0),s("div",CE,[s("label",TE,[ie(y(r.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),l("span",xE," < ")):A("",!0),n.fieldStates.initialization_context==="modified"?(a(),l("span",AE," * ")):A("",!0)]),s("textarea",{id:"config-system-prompt",class:se(["form-control",g.value]),value:d.value,onInput:k,rows:r.value?4:5,placeholder:u.value},null,42,ME),s("div",OE,y(w.value),1)]),s("div",DE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:b[0]||(b[0]=m=>$.$emit("update:form-data","override_system_prompt",m.target.checked))},null,40,NE),b[3]||(b[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),l("div",LE,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(r.value?"":" or legion guide")+").",1)])):A("",!0)]),i.value?(a(),l("div",IE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:b[1]||(b[1]=m=>$.$emit("update:form-data","sandbox_enabled",m.target.checked))},null,40,jE),b[4]||(b[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:se(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):A("",!0)]))}},RE=ne(PE,[["__scopeId","data-v-08b1f06d"]]),WE={class:"modal-dialog modal-lg"},BE={class:"modal-content"},FE={class:"modal-body"},HE={key:0,class:"text-center py-4"},VE={key:1,class:"alert alert-danger"},UE={key:2},qE={class:"mb-3"},zE={class:"small text-muted mb-2"},KE={key:0},GE={key:0,class:"alert alert-info"},YE={key:1},JE={class:"table table-sm table-striped"},QE={key:2,class:"mt-3"},XE={class:"modal-footer"},ZE=["disabled"],eC={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=R(null);let c=null;const f=R(!1),p=R(""),d=R([]);fe(r,b=>{b&&(c=new ft(b),b.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){c&&(c.show(),g())}function w(){c&&c.hide()}async function g(){f.value=!0,p.value="",d.value=[];try{const b=await me.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});d.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),p.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{f.value=!1}}function k(){g()}function $(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:w}),(b,m)=>(a(),l("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",WE,[s("div",BE,[m[7]||(m[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",FE,[f.value?(a(),l("div",HE,[...m[0]||(m[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(a(),l("div",VE,y(p.value),1)):(a(),l("div",UE,[s("div",qE,[m[2]||(m[2]=s("h6",null,"Settings Sources",-1)),s("div",zE,[m[1]||(m[1]=ie(" Loading permissions from: ",-1)),(a(!0),l(re,null,ce(n.settingSources,(h,v)=>(a(),l("span",{key:h},[s("code",null,y(h),1),v<n.settingSources.length-1?(a(),l("span",KE,", ")):A("",!0)]))),128))])]),d.value.length===0?(a(),l("div",GE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),l("div",YE,[s("h6",null,"Pre-approved Permissions ("+y(d.value.length)+")",1),s("table",JE,[m[3]||(m[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(a(!0),l(re,null,ce(d.value,h=>(a(),l("tr",{key:h.permission},[s("td",null,[s("code",null,y(h.permission),1)]),s("td",null,[(a(!0),l(re,null,ce(h.sources,(v,T)=>(a(),l("span",{key:v,class:se(["badge me-1",$(v)])},y(v),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),l("div",QE,[m[4]||(m[4]=s("h6",null,"Session Allowed Tools",-1)),m[5]||(m[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(a(!0),l(re,null,ce(n.sessionAllowedTools,h=>(a(),l("span",{key:h,class:"badge bg-success me-1 mb-1"},y(h),1))),128))])])):A("",!0)]))]),s("div",XE,[m[6]||(m[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:k,disabled:f.value}," Refresh ",8,ZE)])])])],512))}},tC=ne(eC,[["__scopeId","data-v-988ff7c4"]]),sC={class:"modal-dialog modal-lg modal-dialog-centered"},nC={class:"modal-content"},oC={class:"modal-header"},iC={id:"configurationModalLabel",class:"modal-title"},aC={class:"modal-body"},rC={key:0,class:"template-list-view"},lC={key:0,class:"alert alert-info"},cC={class:"card-body"},uC={class:"d-flex justify-content-between align-items-start"},dC={class:"flex-grow-1"},mC={class:"card-title mb-1"},pC={key:0,class:"card-text text-muted small mb-2"},fC={class:"template-meta"},vC={class:"badge bg-secondary me-2"},hC={class:"text-muted small"},_C={class:"btn-group btn-group-sm ms-3"},gC=["onClick"],bC=["onClick"],yC={key:1},wC={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},$C={class:"nav-item",role:"presentation"},kC={key:0,class:"error-indicator",title:"This tab has validation errors"},SC={class:"nav-item",role:"presentation"},EC={key:0,class:"error-indicator",title:"This tab has validation errors"},CC={class:"nav-item",role:"presentation"},TC={key:0,class:"error-indicator",title:"This tab has validation errors"},xC={class:"tab-content"},AC={key:2,class:"alert alert-danger mt-3"},MC={class:"modal-footer"},OC={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},DC=["disabled"],NC={key:0,class:"spinner-border spinner-border-sm me-2"},LC={__name:"ConfigurationModal",setup(n){const e=Ft(),t=je(),o=de(),i=_e(),r=R(null);let c=null;const f=R(null),p=R("create-session"),d=R("general"),u=R(null),w=R(null),g=R(null),k=R([]),$=R(null),b=R(null),m=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=ws({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),v=ws({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),T=ws({name:""}),E=_(()=>({general:!!T.name,permissions:!1,advanced:!1})),W=R(!1),j=R(""),M=_(()=>p.value==="create-session"||p.value==="edit-session"),V=_(()=>p.value==="edit-session"||p.value==="edit-template"),C=_(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),x=_(()=>W.value?V.value?"Saving...":"Creating...":V.value?"Save Changes":M.value?"Create Session":"Save Template"),B=_(()=>!(!v.name.trim()||M.value&&v.name.includes(" "))),G=_(()=>w.value?.working_directory?w.value.working_directory:v.working_directory?v.working_directory:t.projects.get(u.value)?.working_directory||""),L=_(()=>!v.allowed_tools||!v.allowed_tools.trim()?[]:v.allowed_tools.split(",").map(Y=>Y.trim()).filter(Y=>Y.length>0));function F(){f.value&&f.value.show()}function q(Y,le){v[Y]=le,Y==="name"&&(T.name="")}function Z(Y){$.value=Y,N()}async function O(){try{const Y=await me.get("/api/templates");k.value=Y||[]}catch(Y){console.error("Failed to load templates:",Y),k.value=[]}}function N(){if(!$.value){v.default_role="",v.initialization_context="",v.permission_mode="default",v.allowed_tools="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const Y=k.value.find(le=>le.template_id===$.value);if(Y)if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",Y.default_role?(v.default_role=Y.default_role,m.value.default_role=Y.default_role,h.default_role="autofilled"):(v.default_role="",m.value.default_role=null),Y.default_system_prompt?(v.initialization_context=Y.default_system_prompt,m.value.initialization_context=Y.default_system_prompt,h.initialization_context="autofilled"):(v.initialization_context="",m.value.initialization_context=null),Y.permission_mode?(v.permission_mode=Y.permission_mode,m.value.permission_mode=Y.permission_mode,h.permission_mode="autofilled"):(v.permission_mode="default",m.value.permission_mode=null),Y.allowed_tools&&Y.allowed_tools.length>0){const le=Y.allowed_tools.join(", ");v.allowed_tools=le,m.value.allowed_tools=le,h.allowed_tools="autofilled"}else v.allowed_tools="",m.value.allowed_tools=null}function D(){const le=(u.value?t.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:le,currentPath:v.working_directory||"",onSelect:ue=>{v.working_directory=ue}})}function S(){p.value==="create-session"&&(b.value={mode:"create-session",projectId:u.value,formData:{...v},selectedTemplateId:$.value}),p.value="template-list",ee()}function I(){p.value="create-template",ee(),d.value="general"}function z(Y){p.value="edit-template",g.value=Y,ee(),he(Y),d.value="general"}async function J(Y){if(confirm(`Delete template "${Y.name}"?

This action cannot be undone.`))try{await me.delete(`/api/templates/${Y.template_id}`),await O()}catch(le){console.error("Failed to delete template:",le),j.value=le.response?.data?.detail||"Failed to delete template"}}function K(){let Y=!0;return T.name="",v.name.trim()||(T.name="Name is required",Y=!1),M.value&&v.name.includes(" ")&&(T.name="Session name must be a single word (no spaces)",Y=!1),Y}async function te(){if(!K()){T.name&&(d.value="general");return}W.value=!0,j.value="";try{switch(p.value){case"create-session":await X(),c&&c.hide();break;case"edit-session":await H(),c&&c.hide();break;case"create-template":await P();break;case"edit-template":await U();break}}catch(Y){console.error("Submit failed:",Y),j.value=Y.response?.data?.detail||Y.message||"Operation failed. Please try again."}finally{W.value=!1}}async function X(){if(!u.value)throw new Error("Project ID is missing");const Y=v.allowed_tools.split(",").map(Re=>Re.trim()).filter(Re=>Re.length>0),le=v.capabilities.split(",").map(Re=>Re.trim()).filter(Re=>Re.length>0),ue={name:v.name.trim(),model:v.model||null,role:v.default_role.trim()||null,initialization_context:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,capabilities:le.length>0?le:null,permission_mode:v.permission_mode,allowed_tools:Y.length>0?Y:null,working_directory:v.working_directory.trim()||null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources},Te=await me.post(`/api/legions/${u.value}/minions`,ue);if(Te.success&&Te.minion_id)await t.fetchProjects(),await o.fetchSessions(),v.startImmediately&&await o.startSession(Te.minion_id),e.push(`/session/${Te.minion_id}`);else throw new Error("Failed to create session")}async function H(){if(!w.value)throw new Error("Session data is missing");const Y=w.value.session_id,le=w.value.state==="active"||w.value.state==="starting",ue=v.allowed_tools.split(",").map(we=>we.trim()).filter(we=>we.length>0),Te=v.capabilities.split(",").map(we=>we.trim()).filter(we=>we.length>0),Re={name:v.name.trim(),model:v.model,role:v.default_role.trim()||null,system_prompt:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,allowed_tools:ue.length>0?ue:null,capabilities:Te.length>0?Te:null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources};await o.patchSession(Y,Re),le&&v.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(Y,v.permission_mode)}async function P(){const Y=v.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),le={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:Y.length>0?Y:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null};await me.post("/api/templates",le),await O(),p.value="template-list",ee()}async function U(){if(!g.value)throw new Error("Template data is missing");const Y=v.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),le={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:Y.length>0?Y:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null};await me.put(`/api/templates/${g.value.template_id}`,le),await O(),p.value="template-list",g.value=null,ee()}function ee(){v.name="",v.model="sonnet",v.permission_mode="default",v.working_directory="",v.description="",v.default_role="",v.startImmediately=!0,v.allowed_tools="",v.capabilities="",v.setting_sources=["user","project","local"],v.system_prompt="",v.override_system_prompt=!1,v.initialization_context="",v.sandbox_enabled=!1,T.name="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},$.value=null,j.value="",d.value="general"}function oe(Y){v.name=Y.name||"",v.model=Y.model||"sonnet",v.permission_mode=Y.current_permission_mode||"default",v.working_directory=Y.working_directory||"",v.default_role=Y.role||"",v.initialization_context=Y.system_prompt||"",v.override_system_prompt=Y.override_system_prompt||!1,v.system_prompt="",v.allowed_tools=Y.allowed_tools?.join(", ")||"",v.capabilities=Y.capabilities?.join(", ")||"",v.sandbox_enabled=Y.sandbox_enabled||!1,v.setting_sources=Y.setting_sources||["user","project","local"]}function he(Y){v.name=Y.name||"",v.description=Y.description||"",v.permission_mode=Y.permission_mode||"default",v.default_role=Y.default_role||"",v.initialization_context=Y.default_system_prompt||"",v.allowed_tools=Y.allowed_tools?.join(", ")||""}function rt(){kt(()=>{const Y=document.getElementById("config-name");Y&&(Y.focus(),V.value&&Y.select())})}function Fe(){ee(),p.value="create-session",u.value=null,w.value=null,g.value=null,i.hideModal()}return fe(()=>i.currentModal,async(Y,le)=>{if(!(!Y||!c)){if(Y.name==="configuration"){const ue=Y.data||{};p.value=ue.mode||"create-session",u.value=ue.project?.project_id||ue.projectId||null,w.value=ue.session||null,g.value=ue.template||null,ee(),p.value==="create-session"&&await O(),p.value==="edit-session"&&w.value?oe(w.value):p.value==="edit-template"&&g.value&&he(g.value),c.show()}else if(Y.name==="create-minion"||Y.name==="create-session"){const ue=Y.data||{};p.value="create-session",u.value=ue.project?.project_id||null,w.value=null,g.value=null,ee(),await O(),c.show()}else if(Y.name==="edit-session"){const ue=Y.data||{};p.value="edit-session",w.value=ue.session||null,u.value=w.value?.project_id||null,g.value=null,ee(),w.value&&oe(w.value),c.show()}else Y.name==="template-management"&&(p.value="template-list",ee(),await O(),c.show());le?.name==="configuration"&&le.data?.mode?.includes("template")&&Y?.name==="configuration"&&p.value==="create-session"&&await O()}}),fe(()=>v.default_role,Y=>{m.value.default_role!==null&&(h.default_role=Y===m.value.default_role?"autofilled":"modified")}),fe(()=>v.initialization_context,Y=>{m.value.initialization_context!==null&&(h.initialization_context=Y===m.value.initialization_context?"autofilled":"modified")}),fe(()=>v.permission_mode,Y=>{m.value.permission_mode!==null&&(h.permission_mode=Y===m.value.permission_mode?"autofilled":"modified")}),fe(()=>v.allowed_tools,Y=>{m.value.allowed_tools!==null&&(h.allowed_tools=Y===m.value.allowed_tools?"autofilled":"modified")}),ye(()=>{r.value&&xe(()=>import("./modal-D6mKceGM.js").then(Y=>Y.m),__vite__mapDeps([0,1])).then(Y=>{const le=Y.default;c=new le(r.value),r.value.addEventListener("shown.bs.modal",rt),r.value.addEventListener("hidden.bs.modal",Fe)})}),Ee(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",rt),r.value.removeEventListener("hidden.bs.modal",Fe)),c&&c.dispose()}),(Y,le)=>(a(),l(re,null,[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",sC,[s("div",nC,[s("div",oC,[s("h5",iC,[p.value==="create-template"||p.value==="edit-template"?(a(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:S,title:"Back to template list"}," â† ")):A("",!0),ie(" "+y(C.value),1)]),le[3]||(le[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",aC,[p.value==="template-list"?(a(),l("div",rC,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[le[4]||(le[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:I,class:"btn btn-primary btn-sm"}," + Create New ")]),k.value.length===0?(a(),l("div",lC," No templates found. Create your first template! ")):A("",!0),(a(!0),l(re,null,ce(k.value,ue=>(a(),l("div",{key:ue.template_id,class:"card mb-2"},[s("div",cC,[s("div",uC,[s("div",dC,[s("h6",mC,y(ue.name),1),ue.description?(a(),l("p",pC,y(ue.description),1)):A("",!0),s("div",fC,[s("span",vC,y(ue.permission_mode),1),s("span",hC,y(ue.allowed_tools?.length||0)+" tools",1)])]),s("div",_C,[s("button",{onClick:Te=>z(ue),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,gC),s("button",{onClick:Te=>J(ue),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,bC)])])])]))),128))])):(a(),l("div",yC,[s("ul",wC,[s("li",$C,[s("button",{class:se(["nav-link",{active:d.value==="general","has-error":E.value.general}]),type:"button",onClick:le[0]||(le[0]=ue=>d.value="general")},[le[5]||(le[5]=ie(" General ",-1)),E.value.general?(a(),l("span",kC)):A("",!0)],2)]),s("li",SC,[s("button",{class:se(["nav-link",{active:d.value==="permissions","has-error":E.value.permissions}]),type:"button",onClick:le[1]||(le[1]=ue=>d.value="permissions")},[le[6]||(le[6]=ie(" Permissions ",-1)),E.value.permissions?(a(),l("span",EC)):A("",!0)],2)]),s("li",CC,[s("button",{class:se(["nav-link",{active:d.value==="advanced","has-error":E.value.advanced}]),type:"button",onClick:le[2]||(le[2]=ue=>d.value="advanced")},[le[7]||(le[7]=ie(" Advanced ",-1)),E.value.advanced?(a(),l("span",TC)):A("",!0)],2)])]),s("div",xC,[ge(pe(PS,{mode:p.value,"form-data":v,errors:T,templates:k.value,"selected-template-id":$.value,session:w.value,"field-states":h,"onUpdate:formData":q,"onUpdate:selectedTemplateId":Z,onOpenFolderBrowser:D,onOpenTemplateManager:S},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ys,d.value==="general"]]),ge(pe(kE,{mode:p.value,"form-data":v,errors:T,session:w.value,"field-states":h,"onUpdate:formData":q,onPreviewPermissions:F},null,8,["mode","form-data","errors","session","field-states"]),[[ys,d.value==="permissions"]]),ge(pe(RE,{mode:p.value,"form-data":v,errors:T,session:w.value,"field-states":h,"onUpdate:formData":q},null,8,["mode","form-data","errors","session","field-states"]),[[ys,d.value==="advanced"]])])])),j.value?(a(),l("div",AC,y(j.value),1)):A("",!0)]),s("div",MC,[s("button",OC,y(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(a(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:W.value||!B.value,onClick:te},[W.value?(a(),l("span",NC)):A("",!0),ie(" "+y(x.value),1)],8,DC)):A("",!0)])])])],512),pe(tC,{ref_key:"permissionPreviewModal",ref:f,"working-directory":G.value,"setting-sources":v.setting_sources,"session-allowed-tools":L.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},IC=ne(LC,[["__scopeId","data-v-098a9c63"]]),jC={class:"modal-dialog modal-dialog-centered"},PC={class:"modal-content"},RC={class:"modal-header"},WC={class:"modal-title",id:"manageSessionModalLabel"},BC={class:"modal-body"},FC={key:0,class:"text-center py-4"},HC={class:"text-muted"},VC={key:1},UC={key:2},qC={class:"text-muted"},zC={key:0,class:"text-center py-2"},KC={key:1,class:"alert alert-warning mt-3"},GC={class:"mb-0 mt-2"},YC={key:0,class:"text-muted"},JC={key:3},QC={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},XC={class:"d-grid gap-2"},ZC=["disabled"],e0=["disabled"],t0=["disabled"],s0=["disabled"],n0={class:"modal-footer"},o0={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},i0={__name:"SessionManageModal",setup(n){const e=Ft(),t=de(),o=_e(),i=nt();Ae();const r=R(null),c=R(!1),f=R(""),p=R(""),d=R(null),u=R(null);let w=null;const g=R([]),k=R(!1),$=_(()=>d.value==="reset"?"Reset Session":d.value==="delete"?"Delete Session":"Manage Session");function b(){d.value="reset"}async function m(){if(d.value="delete",g.value=[],!!r.value){k.value=!0;try{const C=await me.get(`/api/sessions/${r.value.session_id}/descendants`);g.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),g.value=[]}finally{k.value=!1}}}function h(){d.value=null}async function v(){d.value==="reset"?await W():d.value==="delete"&&await j()}async function T(){if(r.value){c.value=!0,f.value="Restarting session...";try{const C=r.value.session_id,x=t.currentSessionId===C,B=await me.post(`/api/sessions/${C}/restart`);if(B.success)console.log("Session restarted successfully"),x&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(C)),w&&w.hide();else{const G=B.error||B.detail||"Failed to restart session";console.error("Failed to restart session:",G),p.value=`Failed to restart session: ${G}`}}catch(C){console.error("Error restarting session:",C);const x=C.data?.detail||C.message||"Unknown error";p.value=`Error restarting session: ${x}`}finally{c.value=!1}}}async function E(){if(r.value)try{w&&w.hide(),console.log("Ending session",r.value.session_id);const C=r.value.session_id;await me.post(`/api/sessions/${C}/terminate`),t.currentSessionId===C&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),t.currentSessionId===r.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function W(){if(r.value){c.value=!0,f.value="Resetting session...";try{const C=r.value.session_id,x=t.currentSessionId===C,B=await me.post(`/api/sessions/${C}/reset`);if(B.success)console.log("Session reset successfully"),x&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(C)),w&&w.hide();else{const G=B.error||B.detail||"Failed to reset session";console.error("Failed to reset session:",G),p.value=`Failed to reset session: ${G}`,d.value=null}}catch(C){console.error("Error resetting session:",C);const x=C.data?.detail||C.message||"Unknown error";p.value=`Error resetting session: ${x}`,d.value=null}finally{c.value=!1}}}async function j(){if(r.value){c.value=!0,f.value="Deleting session...";try{const C=r.value.session_id;await t.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),w&&w.hide()}catch(C){console.error("Error deleting session:",C);const x=C.data?.detail||C.message||"Unknown error";p.value=`Error deleting session: ${x}`,d.value=null}finally{c.value=!1}}}function M(){d.value=null,c.value=!1,f.value="",p.value="",g.value=[],k.value=!1}function V(){M(),r.value=null,o.hideModal()}return fe(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&w){const x=C.data||{};r.value=x.session,M(),w.show()}}),ye(()=>{u.value&&xe(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{w=new C(u.value),u.value.addEventListener("hidden.bs.modal",V)})}),Ee(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",V),w&&w.dispose()}),(C,x)=>(a(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",jC,[s("div",PC,[s("div",RC,[s("h5",WC,y(d.value?$.value:"Manage Session"),1),x[1]||(x[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",BC,[c.value?(a(),l("div",FC,[x[2]||(x[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",HC,y(f.value),1)])):d.value==="reset"?(a(),l("div",VC,[...x[3]||(x[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):d.value==="delete"?(a(),l("div",UC,[x[9]||(x[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",qC,[x[4]||(x[4]=ie("This will permanently delete session ",-1)),s("strong",null,y(r.value?.name),1),x[5]||(x[5]=ie(".",-1))]),x[10]||(x[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),k.value?(a(),l("div",zC,[...x[6]||(x[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(a(),l("div",KC,[x[7]||(x[7]=s("strong",null,"Cascading Deletion:",-1)),x[8]||(x[8]=ie(" This session has ",-1)),s("strong",null,y(g.value.length),1),ie(" child session"+y(g.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",GC,[(a(!0),l(re,null,ce(g.value,B=>(a(),l("li",{key:B.session_id,class:"small"},[s("strong",null,y(B.name||B.session_id),1),B.role?(a(),l("span",YC," ("+y(B.role)+")",1)):A("",!0)]))),128))])])):A("",!0)])):(a(),l("div",JC,[p.value?(a(),l("div",QC,[x[11]||(x[11]=s("strong",null,"Error:",-1)),ie(" "+y(p.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:x[0]||(x[0]=B=>p.value="")})])):A("",!0),x[18]||(x[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",XC,[s("button",{class:"btn btn-outline-primary text-start",onClick:T,disabled:c.value},[...x[12]||(x[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,ZC),s("button",{class:"btn btn-outline-secondary text-start",onClick:E,disabled:c.value},[...x[13]||(x[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,e0),x[16]||(x[16]=s("hr",{class:"my-2"},null,-1)),x[17]||(x[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:c.value},[...x[14]||(x[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,t0),s("button",{class:"btn btn-outline-danger text-start",onClick:m,disabled:c.value},[...x[15]||(x[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,s0)]),x[19]||(x[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ie(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",n0,[d.value&&!c.value?(a(),l(re,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),s("button",{type:"button",class:se(["btn",d.value==="delete"?"btn-danger":"btn-warning"]),onClick:v},y(d.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?A("",!0):(a(),l("button",o0,"Cancel"))])])])],512))}},a0=ne(i0,[["__scopeId","data-v-6b832853"]]),r0={class:"modal-dialog modal-dialog-centered modal-lg"},l0={class:"modal-content"},c0={class:"modal-body"},u0={key:0,class:"text-center text-muted py-4"},d0={key:1},m0={class:"mb-3"},p0={class:"font-monospace small"},f0={class:"mb-3"},v0=["value"],h0={class:"mb-3"},_0={class:"mb-3"},g0={class:"mb-3"},b0={key:0},y0={class:"d-flex flex-wrap gap-1"},w0={key:1,class:"text-muted small"},$0={key:0,class:"mb-3"},k0={class:"d-flex flex-wrap gap-1"},S0={key:1,class:"mb-3"},E0={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},C0={class:"mb-3"},T0={class:"text-muted"},x0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},A0={__name:"SessionInfoModal",setup(n){const e=de(),t=Ae(),o=_e(),i=R(null),r=R(!1),c=R(null);let f=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},d=_(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(t.messagesBySession.get(i.value)||[]).find(v=>v.type==="system"&&(v.subtype==="init"||v.metadata?.subtype==="init")&&v.metadata?.init_data)?.metadata?.init_data||null});function u(b){return b?p[b]||b:"Default (Sonnet 4.5)"}function w(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function g(b){b.target.select()}function k(){i.value=null,r.value=!1}function $(){k(),o.hideModal()}return fe(()=>o.currentModal,b=>{if(b?.name==="session-info"&&f){const m=b.data||{};i.value=m.sessionId,r.value=!1,f.show()}}),ye(()=>{c.value&&xe(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(m=>m.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{f=new b(c.value),c.value.addEventListener("hidden.bs.modal",$)})}),Ee(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",$),f&&f.dispose()}),(b,m)=>(a(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",r0,[s("div",l0,[m[9]||(m[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",c0,[d.value?(a(),l("div",d0,[s("div",m0,[m[1]||(m[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",p0,y(i.value),1)]),s("div",f0,[m[2]||(m[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:d.value.cwd||"Not specified",readonly:"",onClick:g},null,8,v0)]),s("div",h0,[m[3]||(m[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,y(u(d.value.model)),1)]),s("div",_0,[m[4]||(m[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,y(d.value.permissionMode||"default"),1)]),s("div",g0,[m[5]||(m[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(d.value.allowed_tools||d.value.tools)&&(d.value.allowed_tools||d.value.tools).length>0?(a(),l("div",b0,[s("div",y0,[(a(!0),l(re,null,ce(d.value.allowed_tools||d.value.tools,h=>(a(),l("span",{key:h,class:"badge bg-secondary"},y(h),1))),128))])])):(a(),l("div",w0,"No pre-authorized tools (will prompt for permissions)"))]),d.value.commands&&d.value.commands.length>0?(a(),l("div",$0,[m[6]||(m[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",k0,[(a(!0),l(re,null,ce(d.value.commands,h=>(a(),l("span",{key:h,class:"badge bg-info"},y(h),1))),128))])])):A("",!0),d.value.systemPrompt?(a(),l("div",S0,[m[7]||(m[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",E0,y(w(d.value.systemPrompt)),1)])):A("",!0),s("div",C0,[s("h6",T0,[m[8]||(m[8]=ie(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:m[0]||(m[0]=h=>r.value=!r.value)},y(r.value?"Hide":"Show"),1)]),r.value?(a(),l("pre",x0,y(JSON.stringify(d.value,null,2)),1)):A("",!0)])])):(a(),l("div",u0," No session configuration data available "))]),m[10]||(m[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},M0=ne(A0,[["__scopeId","data-v-b28b39b3"]]),O0={class:"modal-dialog modal-dialog-centered modal-lg"},D0={class:"modal-content"},N0={class:"modal-body"},L0={key:0,class:"text-center text-muted py-4"},I0={key:1},j0={class:"mb-3"},P0={class:"mb-3"},R0={class:"font-monospace small"},W0={class:"mb-3"},B0={class:"mb-3"},F0={class:"mb-3"},H0={key:0},V0={class:"d-flex flex-wrap gap-1"},U0={key:1,class:"text-muted small"},q0={class:"mb-3"},z0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},K0={key:1,class:"text-muted small"},G0={class:"mb-3"},Y0={key:0,class:"badge bg-info"},J0={key:1,class:"badge bg-secondary"},Q0={class:"mb-3"},X0={key:0,class:"font-monospace small"},Z0={key:1,class:"text-muted small"},eT={key:0,class:"mb-3"},tT={key:0},sT={class:"list-unstyled mb-0"},nT={key:1,class:"text-muted small"},oT={class:"mb-3"},iT={class:"small"},aT={class:"mb-3"},rT={class:"small"},lT={__name:"MinionViewModal",setup(n){const e=_e(),t=R(null),o=R(null);let i=null;function r(d){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[d]||"bg-secondary"}function c(d){if(!d)return"N/A";try{const u=new Date(d);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function f(){t.value=null}function p(){f(),e.hideModal()}return fe(()=>e.currentModal,d=>{if(d?.name==="minion-view"&&i){const u=d.data||{};t.value=u.session,i.show()}}),ye(()=>{o.value&&xe(async()=>{const{default:d}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:d}},__vite__mapDeps([0,1])).then(({default:d})=>{i=new d(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),Ee(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(d,u)=>(a(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",O0,[s("div",D0,[u[11]||(u[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",N0,[t.value?(a(),l("div",I0,[s("div",j0,[u[0]||(u[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,y(t.value.name||"Unnamed Minion"),1)]),s("div",P0,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",R0,y(t.value.session_id),1)]),s("div",W0,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,y(t.value.role||"Not specified"),1)]),s("div",B0,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:se(["badge",r(t.value.state)])},y(t.value.state),3)])]),s("div",F0,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(a(),l("div",H0,[s("div",V0,[(a(!0),l(re,null,ce(t.value.capabilities,w=>(a(),l("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(a(),l("div",U0,"None"))]),s("div",q0,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(a(),l("div",z0,y(t.value.initialization_context),1)):(a(),l("div",K0,"Not specified"))]),s("div",G0,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(a(),l("span",Y0,"Yes")):(a(),l("span",J0,"No"))])]),s("div",Q0,[u[7]||(u[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(a(),l("div",X0,y(t.value.parent_overseer_id),1)):(a(),l("div",Z0," Root overseer (user-created) "))]),t.value.is_overseer?(a(),l("div",eT,[u[8]||(u[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(a(),l("div",tT,[s("ul",sT,[(a(!0),l(re,null,ce(t.value.child_minion_ids,w=>(a(),l("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(a(),l("div",nT,"No children"))])):A("",!0),s("div",oT,[u[9]||(u[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",iT,y(c(t.value.created_at)),1)]),s("div",aT,[u[10]||(u[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",rT,y(c(t.value.updated_at)),1)])])):(a(),l("div",L0," No minion data available "))]),u[12]||(u[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},cT=ne(lT,[["__scopeId","data-v-d996dc6f"]]),uT={class:"container-fluid vh-100 d-flex flex-column p-0"},dT={class:"d-flex flex-grow-1 overflow-hidden position-relative"},mT={class:"flex-grow-1 d-flex flex-column overflow-hidden"},pT={__name:"App",setup(n){const e=_e(),t=nt(),o=de(),i=je(),r=Rt(),c=Xe(),f=Ft(),p=R(null);function d(m){p.value=m}gn("addAttachmentFromResource",d),gn("pendingResourceAttachment",p);const u=_(()=>e.sidebarCollapsed),w=_(()=>e.rightSidebarCollapsed),g=_(()=>e.isMobile);fe(()=>r.currentHasTasks,(m,h)=>{m&&!h&&e.setRightSidebarCollapsed(!1)}),fe(()=>c.currentHasResources,(m,h)=>{m&&!h&&e.setRightSidebarCollapsed(!1)}),ye(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const m=window.location.hash;if(m.startsWith("#/session/")){const h=m.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(m.startsWith("#/timeline/")){const h=m.replace("#/timeline/","");f.push(`/timeline/${h}`)}window.addEventListener("popstate",k),window.addEventListener("resize",e.handleResize)}),Ee(()=>{window.removeEventListener("popstate",k),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function k(){const m=window.location.hash;if(m.startsWith("#/session/")){const h=m.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function $(){e.toggleSidebar()}function b(){e.toggleRightSidebar()}return(m,h)=>{const v=vo("router-view");return a(),l("div",uT,[pe(mw),s("div",{id:"sidebar-backdrop",class:se({show:!u.value&&g.value}),onClick:$},null,2),s("div",{id:"right-sidebar-backdrop",class:se({show:!w.value&&g.value}),onClick:b},null,2),s("div",dT,[pe(Hw),s("main",mT,[pe(v)]),pe(K$)]),pe(uk),pe(Ck),pe(Gk),pe(IC),pe(a0),pe(M0),pe(cT)])}}},un=Oi(pT);un.use(Di());un.use(nw);un.mount("#app");
