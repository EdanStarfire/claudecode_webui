const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as s,o as r,d as mt,r as P,b as v,t as w,e as A,n as ee,f as at,g as ne,u as ns,w as pe,h as gs,F as ae,i as ce,j as ge,v as We,k as be,l as lo,m as me,p as Re,q as _e,s as wt,x as ye,y as _i,z as Ee,A as vn,B as co,C as Wt,D as gi,E as bi,G as yi,T as $i,H as wi,I as bs,J as ys,K as ki,L as Si}from"./vue-vendor-Bf49-igW.js";import{m as lt,p as ls}from"./markdown-vendor-BRsjnVvP.js";import{c as Ei}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const Ci={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ti={__name:"NoSessionSelected",setup(n){return(e,t)=>(r(),l("div",Ci,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},xi="modulepreload",Ai=function(n){return"/"+n},hn={},Me=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let p=function(f){return Promise.all(f.map(d=>Promise.resolve(d).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),m=c?.nonce||c?.getAttribute("nonce");i=p(t.map(f=>{if(f=Ai(f),f in hn)return;hn[f]=!0;const d=f.endsWith(".css"),k=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${k}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":xi,d||(g.as="script"),g.crossOrigin="",g.href=f,m&&g.setAttribute("nonce",m),document.head.appendChild(g),d)return new Promise(($,b)=>{g.addEventListener("load",$),g.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(c){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=c,window.dispatchEvent(m),!m.defaultPrevented)throw c}return i.then(c=>{for(const m of c||[])m.status==="rejected"&&a(m.reason);return e().catch(a)})};class $s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function kt(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new $s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof $s?t:(console.error("API request failed:",t),new $s(`Network error: ${t.message}`,0,null))}}async function Oi(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[m,p]of Object.entries(e.params))p!=null&&o.append(m,p);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...c}=e;return kt(t,{...c,method:"GET"})}return kt(t,{...e,method:"GET"})}async function Mi(n,e,t={}){return kt(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Di(n,e,t={}){return kt(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ni(n,e={}){return kt(n,{...e,method:"DELETE"})}async function Li(n,e,t={}){return kt(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const ue={get:Oi,post:Mi,put:Di,delete:Ni,patch:Li},de=mt("session",()=>{const n=P(new Map),e=P(null),t=P(new Map),o=P(new Map),i=P(new Set),a=P(!1);let c=null;const m=v(()=>n.value.get(e.value)),p=v(()=>Array.from(n.value.values()).sort((x,R)=>x.order-R.order)),f=x=>v(()=>p.value.filter(R=>R.project_id===x)),d=v({get:()=>t.value.get(e.value)||"",set:x=>{e.value&&t.value.set(e.value,x)}});async function k(){try{const x=await ue.get("/api/sessions");return n.value.clear(),x.sessions.forEach(R=>{n.value.set(R.session_id,R)}),console.log(`Loaded ${n.value.size} sessions`),x.sessions}catch(x){throw console.error("Failed to fetch sessions:",x),x}}async function g(x,R){try{const T=(await ue.post("/api/sessions",{project_id:x,...R})).session_id,U=(await ue.get(`/api/sessions/${T}`)).session;return n.value.set(T,U),n.value=new Map(n.value),console.log(`Created session ${T}`),U}catch(E){throw console.error("Failed to create session:",E),E}}async function $(x){if(e.value===x&&!a.value)return;c&&(console.log(`Aborting pending selection to switch to ${x}`),c.abort(),c=null);const R=new AbortController;c=R,a.value=!0;try{if(e.value=x,R.signal.aborted){console.log(`Selection of ${x} aborted early`);return}let E=n.value.get(x);if(!E)try{const U=await ue.get(`/api/sessions/${x}`);if(R.signal.aborted){console.log(`Selection of ${x} aborted after fetch`);return}E=U.session,n.value.set(x,E),n.value=new Map(n.value),console.log(`Fetched session ${x} for deeplink`)}catch(U){console.error(`Failed to fetch session ${x}:`,U);return}if(E&&(E.state==="created"||E.state==="terminated"))try{if(await _(x),R.signal.aborted){console.log(`Selection of ${x} aborted after start`);return}console.log(`Auto-started session ${x} (was in ${E.state} state)`);const U=6e4,I=200,H=5e3;let V=0,X=0;for(;V<U;){if(R.signal.aborted){console.log(`Selection of ${x} aborted during state wait`);return}const N=n.value.get(x);if(N&&N.state==="active"){console.log(`Session ${x} is now active after ${V}ms`);break}if(V-X>=H){const O=n.value.get(x)?.state||"unknown";console.log(`Waiting for session ${x} to become active (current: ${O}, ${V/1e3}s elapsed)`),X=V}await new Promise(O=>setTimeout(O,I)),V+=I}const M=n.value.get(x);M&&M.state!=="active"&&console.warn(`Session ${x} did not become active within ${U/1e3}s (state: ${M.state}), continuing anyway`)}catch(U){console.error(`Failed to auto-start session ${x}:`,U)}if(R.signal.aborted){console.log(`Selection of ${x} aborted before message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>na),void 0)).useMessageStore().loadMessages(x),R.signal.aborted){console.log(`Selection of ${x} aborted after message load`);return}await(await Me(()=>Promise.resolve().then(()=>Sa),void 0)).useWebSocketStore().connectSession(x),R.signal.aborted||console.log(`Selected session ${x}`)}finally{c===R&&(c=null),a.value=!1}}function b(x,R){const E=n.value.get(x);E?Object.assign(E,R):(n.value.set(x,R),console.log(`Added new session ${x} via WebSocket update`)),n.value=new Map(n.value)}async function h(x){i.value.add(x);try{const E=(await ue.delete(`/api/sessions/${x}`)).deleted_session_ids||[x];for(const T of E)n.value.delete(T),t.value.delete(T),o.value.delete(T);return n.value=new Map(n.value),E.includes(e.value)&&(e.value=null),console.log(`Deleted ${E.length} session(s): ${E.join(", ")}`),E}catch(R){throw console.error("Failed to delete session:",R),R}finally{i.value.delete(x)}}async function u(x,R){try{await ue.patch(`/api/sessions/${x}`,R),b(x,R),console.log(`Updated session ${x}:`,R)}catch(E){throw console.error("Failed to update session:",E),E}}async function y(x,R){try{await ue.post(`/api/sessions/${x}/permission-mode`,{mode:R}),b(x,{current_permission_mode:R});const E=o.value.get(x);E&&(E.permissionMode=R,o.value.set(x,E)),console.log(`Set permission mode for session ${x} to ${R}`)}catch(E){throw console.error("Failed to set permission mode:",E),E}}async function _(x){try{await ue.post(`/api/sessions/${x}/start`),console.log(`Started session ${x}`)}catch(R){throw console.error("Failed to start session:",R),R}}async function C(x){try{await ue.post(`/api/sessions/${x}/pause`),console.log(`Paused session ${x}`)}catch(R){throw console.error("Failed to pause session:",R),R}}async function S(x){try{await ue.post(`/api/sessions/${x}/terminate`),console.log(`Terminated session ${x}`)}catch(R){throw console.error("Failed to terminate session:",R),R}}function j(x){return n.value.get(x)}function L(x,R){o.value.set(x,R),R.permissionMode&&b(x,{current_permission_mode:R.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:m,orderedSessions:p,sessionsInProject:f,currentInput:d,fetchSessions:k,createSession:g,selectSession:$,updateSession:b,deleteSession:h,patchSession:u,setPermissionMode:y,startSession:_,pauseSession:C,terminateSession:S,getSession:j,storeInitData:L}}),_n=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:de},Symbol.toStringTag,{value:"Module"})),ve=mt("ui",()=>{const n=P(window.innerWidth<768),e=P(300),t=P(!0),o=P(300),i=P(window.innerWidth),a=v(()=>i.value<768),c=P(!0),m=P(null),p=P(null),f=v(()=>m.value?{name:m.value,data:p.value}:null),d=P(!1),k=P("Loading...");function g(){n.value=!n.value}function $(R){n.value=R}function b(R){e.value=Math.max(200,Math.min(R,window.innerWidth*.3))}function h(){t.value=!t.value}function u(R){t.value=R}function y(R){o.value=Math.max(200,Math.min(R,window.innerWidth*.3))}function _(R){c.value=R}function C(R,E=null){m.value=null,p.value=null,setTimeout(()=>{m.value=R,p.value=E},0)}function S(){m.value=null,p.value=null}function j(R="Loading..."){d.value=!0,k.value=R}function L(){d.value=!1}function x(){const R=i.value;i.value=window.innerWidth,i.value<768&&R>=768?n.value=!0:i.value>=768&&R<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:a,autoScrollEnabled:c,activeModal:m,modalData:p,currentModal:f,isLoading:d,loadingMessage:k,toggleSidebar:g,setSidebarCollapsed:$,setSidebarWidth:b,toggleRightSidebar:h,setRightSidebarCollapsed:u,setRightSidebarWidth:y,setAutoScroll:_,showModal:C,hideModal:S,showLoading:j,hideLoading:L,handleResize:x}}),je=mt("project",()=>{const n=P(new Map),e=P(null),t=v(()=>n.value.get(e.value)),o=v(()=>Array.from(n.value.values()).sort((u,y)=>u.order-y.order));async function i(){try{const u=await ue.get("/api/projects");return n.value.clear(),u.projects.forEach(y=>{n.value.set(y.project_id,y)}),console.log(`Loaded ${n.value.size} projects`),u.projects}catch(u){throw console.error("Failed to fetch projects:",u),u}}async function a(u,y){try{const C=(await ue.post("/api/projects",{name:u,working_directory:y})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(_){throw console.error("Failed to create project:",_),_}}async function c(u,y){try{await ue.put(`/api/projects/${u}`,y),m(u,y),console.log(`Updated project ${u}`,y)}catch(_){throw console.error("Failed to update project:",_),_}}function m(u,y){const _=n.value.get(u);_&&(Object.assign(_,y),n.value=new Map(n.value))}async function p(u){try{await ue.delete(`/api/projects/${u}`),n.value.delete(u),n.value=new Map(n.value),e.value===u&&(e.value=null),console.log(`Deleted project ${u}`)}catch(y){throw console.error("Failed to delete project:",y),y}}async function f(u){try{const y=await ue.put(`/api/projects/${u}/toggle-expansion`),_=n.value.get(u);return _&&(_.is_expanded=y.is_expanded,n.value=new Map(n.value)),y.is_expanded}catch(y){throw console.error("Failed to toggle expansion:",y),y}}async function d(u){try{await ue.put("/api/projects/reorder",{project_ids:u}),u.forEach((y,_)=>{const C=n.value.get(y);C&&(C.order=_)}),n.value=new Map(n.value),console.log("Reordered projects",u)}catch(y){throw console.error("Failed to reorder projects:",y),y}}async function k(u,y){try{await ue.put(`/api/projects/${u}/sessions/reorder`,{session_ids:y});const _=n.value.get(u);_&&(_.session_ids=y,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${u}`,y)}catch(_){throw console.error("Failed to reorder sessions:",_),_}}function g(u){return n.value.get(u)}function $(u){e.value=u}function b(){e.value=null}function h(u){if(!u)return"";const y=u.split(/[/\\]/).filter(_=>_);return y.length===0?"/":y.length===1?`/${y[0]}`:y.length===2?`/${y.join("/")}`:`.../${y.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:a,updateProject:c,updateProjectLocal:m,deleteProject:p,toggleExpansion:f,reorderProjects:d,reorderSessionsInProject:k,getProject:g,selectProject:$,clearProjectSelection:b,formatPath:h}}),$t=mt("task",()=>{const n=P(new Map),e=P(new Set);function t(_){const C=n.value.get(_);return C?Array.from(C.values()).sort((S,j)=>{const L=parseInt(S.id.replace(/\D/g,""))||0,x=parseInt(j.id.replace(/\D/g,""))||0;return L-x}):[]}function o(_){return t(_).find(S=>S.status==="in_progress")||null}function i(_){const C=t(_);return{total:C.length,completed:C.filter(S=>S.status==="completed").length,inProgress:C.filter(S=>S.status==="in_progress").length,pending:C.filter(S=>S.status==="pending").length}}function a(_){return e.value.has(_)}const c=v(()=>{const _=de();return t(_.currentSessionId)}),m=v(()=>{const _=de();return o(_.currentSessionId)}),p=v(()=>{const _=de();return i(_.currentSessionId)}),f=v(()=>{const _=de();return a(_.currentSessionId)});function d(_,C){n.value.has(_)||n.value.set(_,new Map),n.value.get(_).set(C.id,{id:C.id,subject:C.subject||"",description:C.description||"",status:C.status||"pending",activeForm:C.activeForm||null,owner:C.owner||null,blocks:C.blocks||[],blockedBy:C.blockedBy||[],metadata:C.metadata||{}}),e.value.add(_),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${C.id} for session ${_}`)}function k(_,C,S){const j=n.value.get(_);if(!j){console.warn(`No tasks found for session ${_}`);return}const L=j.get(C);if(!L){d(_,{id:C,...S});return}S.subject!==void 0&&(L.subject=S.subject),S.description!==void 0&&(L.description=S.description),S.status!==void 0&&(L.status=S.status),S.activeForm!==void 0&&(L.activeForm=S.activeForm),S.owner!==void 0&&(L.owner=S.owner),S.metadata!==void 0&&(L.metadata={...L.metadata,...S.metadata}),S.addBlocks&&(L.blocks=[...new Set([...L.blocks,...S.addBlocks])]),S.addBlockedBy&&(L.blockedBy=[...new Set([...L.blockedBy,...S.addBlockedBy])]),S.status==="deleted"&&(j.delete(C),j.size===0&&(e.value.delete(_),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${C} for session ${_}`,S)}function g(_,C){return n.value.get(_)?.get(C)||null}function $(_){n.value.delete(_),e.value.delete(_),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${_}`)}function b(_,C){n.value.has(_)&&n.value.get(_).clear(),e.value.delete(_);const S=new Map;for(const j of C){if(j.metadata?.tool_uses)for(const L of j.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(L.name)&&S.set(L.id,{name:L.name,input:L.input});if(j.metadata?.tool_results)for(const L of j.metadata.tool_results){const x=S.get(L.tool_use_id);x&&(h(_,x.name,x.input,{error:L.is_error,content:L.content}),S.delete(L.tool_use_id))}}console.log(`Reconstructed ${n.value.get(_)?.size||0} tasks for session ${_}`)}function h(_,C,S,j){if(j?.error){console.log(`Skipping task update - tool ${C} returned error`);return}const L=u(j);if(L)switch(C){case"TaskCreate":{const x=y(L)||S?.id;x&&d(_,{id:x,subject:S?.subject||"",description:S?.description||"",status:"pending",activeForm:S?.activeForm||null,owner:S?.owner||null,blocks:[],blockedBy:[],metadata:S?.metadata||{}});break}case"TaskUpdate":{const x=S?.taskId;x&&k(_,x,{status:S?.status,subject:S?.subject,description:S?.description,activeForm:S?.activeForm,owner:S?.owner,metadata:S?.metadata,addBlocks:S?.addBlocks,addBlockedBy:S?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{S?.taskId;break}}}function u(_){return _?typeof _=="string"?_:_.content?typeof _.content=="string"?_.content:JSON.stringify(_.content):_.message?_.message:JSON.stringify(_):null}function y(_){if(!_)return null;const C=_.match(/[Tt]ask\s*#(\d+)/i);if(C)return C[1];const S=_.match(/#(\d+)/);return S?S[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:m,currentTaskStats:p,currentHasTasks:f,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:a,getTask:g,createTask:d,updateTask:k,clearTasks:$,reconstructFromMessages:b,handleTaskToolResult:h}}),se=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},ji={class:"session-header border-bottom p-3 d-flex justify-content-between align-items-center"},Ii={class:"project-name"},Pi=["title"],Ri=["title"],Wi={class:"toggle-icon"},Hi={key:0,class:"task-badge ms-1"},Bi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=je(),i=$t(),a=ve(),c=v(()=>t.sessions.get(e.sessionId)),m=v(()=>c.value?.name||e.sessionId),p=v(()=>{for(const b of o.projects.values())if(b.session_ids?.includes(e.sessionId))return b;return null}),f=v(()=>p.value?.name||"Unknown Project"),d=v(()=>i.hasTasks(e.sessionId)),k=v(()=>i.taskStats(e.sessionId)),g=v(()=>a.rightSidebarCollapsed);function $(){a.toggleRightSidebar()}return(b,h)=>(r(),l("div",ji,[s("div",null,[s("div",Ii,w(f.value),1),s("div",{class:"session-name",title:n.sessionId},w(m.value),9,Pi)]),s("button",{class:ee(["btn btn-sm sidebar-toggle-btn",{"btn-primary":!g.value,"btn-outline-secondary":g.value}]),onClick:$,title:g.value?"Show panel":"Hide panel"},[s("span",Wi,w(g.value?"â—€":"â–¶"),1),d.value?(r(),l("span",Hi,"ðŸ“‹ "+w(k.value.completed)+"/"+w(k.value.total),1)):A("",!0)],10,Ri)]))}},Fi=se(Bi,[["__scopeId","data-v-9406aba2"]]),Vi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ui=["title"],qi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},zi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=v(()=>t.sessions.get(e.sessionId)),i=v(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=v(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),c=v(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),m=v(()=>{if(!o.value)return"No session selected";const p=i.value,f=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),d=o.value.name||"Unnamed Session",k=o.value.role?` (${o.value.role})`:"";return`${d}${k}: ${f}`});return(p,f)=>(r(),l("div",Vi,[o.value?(r(),l("div",{key:0,class:ee(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:at({width:"100%",backgroundColor:a.value}),title:m.value},null,14,Ui)):(r(),l("div",qi))]))}},Ki=se(zi,[["__scopeId","data-v-63d222fe"]]),Gi={class:"session-status-bar border-top p-2 bg-light"},Yi={class:"d-flex justify-content-between align-items-center gap-2"},Ji={class:"d-flex gap-2"},Qi=["disabled"],Xi={class:"mode-label"},Zi=["disabled"],ea=["disabled"],ta={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=ve(),i=v(()=>t.sessions.get(e.sessionId)),a=v(()=>i.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},m=v(()=>c[a.value]||"ðŸ”’"),p=v(()=>a.value),f=["default","acceptEdits","plan"],d=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(y){console.error("Failed to cycle permission mode:",y)}return}const h=(f.indexOf(a.value)+1)%f.length,u=f[h];try{await t.setPermissionMode(e.sessionId,u)}catch(y){console.error("Failed to cycle permission mode:",y)}},k=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},$=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(b,h)=>(r(),l("div",Gi,[s("div",Yi,[s("div",Ji,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!i.value},[ne(w(m.value)+" ",1),s("span",Xi,w(p.value),1)],8,Qi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:k,disabled:!i.value},[...h[0]||(h[0]=[ne(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Zi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...h[1]||(h[1]=[ne(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,ea)]),s("div",null,[s("button",{class:ee(["btn btn-sm",ns(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:$}," â¬‡ï¸ "+w(ns(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},sa=se(ta,[["__scopeId","data-v-fdcd3535"]]),Te=mt("message",()=>{const n=P(new Map),e=P(new Map),t=P(new Map),o=P(new Map),i=P(new Map),a=P(new Map),c=P(new Map),m=P(new Map),p=v(()=>{const M=de();return n.value.get(M.currentSessionId)||[]}),f=v(()=>{const M=de();return e.value.get(M.currentSessionId)||[]});async function d(M,N=null,O=0){try{const D=N||1e4,z=await ue.get(`/api/sessions/${M}/messages?limit=${D}&offset=${O}`),Q=z.messages||[],J=z.total_count||Q.length,Y=z.has_more||!1;if(console.log(`Loaded ${Q.length} of ${J} messages for session ${M}`),n.value.set(M,Q),Q.length>0){const W=Q[Q.length-1];W.timestamp&&(c.value.set(M,W.timestamp),console.log(`Tracked last received timestamp for session ${M}: ${W.timestamp}`))}const te=new Set;Q.forEach(W=>{W.type==="assistant"&&W.metadata?.tool_uses&&W.metadata.tool_uses.forEach(B=>{te.add(B.id)}),W.type==="user"&&W.metadata?.tool_results&&W.metadata.tool_results.forEach(B=>{te.delete(B.tool_use_id);const Z=a.value.get(M);Z&&Z.delete(B.tool_use_id)}),W.type==="system"&&W.metadata?.subtype==="client_launched"&&(te.forEach(B=>{E(M,B,"Session was restarted")}),te.clear()),W.type==="system"&&W.metadata?.subtype==="interrupt"&&(te.forEach(B=>{E(M,B,"Session was interrupted")}),te.clear()),W.metadata?.has_tool_uses&&W.metadata.tool_uses&&W.metadata.tool_uses.forEach(B=>{h(M,B)}),W.metadata?.has_tool_results&&W.metadata.tool_results&&W.metadata.tool_results.forEach(B=>{C(M,B)}),(W.type==="permission_request"||W.metadata?.has_permission_requests)&&u(M,W),W.type==="permission_response"&&y(M,{request_id:W.metadata?.request_id,decision:W.metadata?.decision,updated_input:W.metadata?.updated_input,reasoning:W.metadata?.reasoning,applied_updates:W.metadata?.applied_updates}),W.type==="system"&&(W.subtype==="init"||W.metadata?.subtype==="init")&&W.metadata?.init_data&&de().storeInitData(M,W.metadata.init_data)});const G=de().sessions.get(M);G&&!["active","paused","starting"].includes(G.state)&&(te.forEach(W=>{E(M,W,"Session was terminated")}),te.clear()),i.value.set(M,te),n.value=new Map(n.value);try{$t().reconstructFromMessages(M,Q)}catch(W){console.warn("Failed to reconstruct task state:",W)}return Y&&console.warn(`Warning: Only loaded ${Q.length} of ${J} messages. Some messages may be missing.`),{messages:Q,totalCount:J,hasMore:Y}}catch(D){throw console.error("Failed to load messages:",D),D}}function k(M,N){const O=i.value.get(M)||new Set;N.type==="assistant"&&N.metadata?.tool_uses&&N.metadata.tool_uses.forEach(D=>{O.add(D.id)}),N.type==="user"&&N.metadata?.tool_results&&N.metadata.tool_results.forEach(D=>{O.delete(D.tool_use_id);const z=a.value.get(M);z&&z.delete(D.tool_use_id)}),N.type==="system"&&N.metadata?.subtype==="client_launched"&&(O.forEach(D=>{E(M,D,"Session was restarted")}),O.clear()),N.type==="system"&&N.metadata?.subtype==="interrupt"&&(O.forEach(D=>{E(M,D,"Session was interrupted")}),O.clear()),i.value.set(M,O)}function g(M,N){n.value.has(M)||n.value.set(M,[]);const O=n.value.get(M);if(N.id){const D=O.findIndex(z=>z.id===N.id);if(D!==-1){console.log(`Skipping duplicate message ${N.id} (already exists at index ${D})`);return}}O.push(N),N.timestamp&&c.value.set(M,N.timestamp),L(M,N),k(M,N),n.value=new Map(n.value)}function $(M,N){e.value.has(M)||e.value.set(M,[]),e.value.get(M).push(N),e.value=new Map(e.value)}function b(M,N,O){const D=e.value.get(M);if(D){const z=D.find(Q=>Q.id===N);z&&(Object.assign(z,O),e.value=new Map(e.value))}}function h(M,N){const O=j(N.name,N.input);t.value.set(O,N.id);const D={id:N.id,name:N.name,input:N.input,signature:O,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return $(M,D),console.log(`Created tool call ${D.id} for ${D.name}`),D}function u(M,N){console.log("handlePermissionRequest received:",N);const O=N.metadata?.tool_name||N.tool_name,D=N.metadata?.input_params||N.input_params,z=N.metadata?.request_id||N.request_id,Q=N.metadata?.suggestions||N.suggestions||[];console.log("Extracted data:",{toolName:O,inputParams:D,requestId:z,suggestions:Q});const J=j(O,D),Y=t.value.get(J);Y?(o.value.set(z,Y),b(M,Y,{status:"permission_required",permissionRequestId:z,suggestions:Q}),console.log(`Permission required for tool ${Y}`,{suggestions:Q})):console.warn("No tool use ID found for permission request signature:",J,{toolName:O,inputParams:D,availableSignatures:Array.from(t.value.keys())})}function y(M,N){const O=o.value.get(N.request_id);if(O){const D={permissionDecision:N.decision,appliedUpdates:N.applied_updates||[]};N.decision==="allow"?D.status="executing":(D.status="completed",D.result={error:!0,message:N.reasoning||"Permission denied"},D.isExpanded=!1),N.updated_input&&(D.input=N.updated_input),b(M,O,D),console.log(`Permission ${N.decision} for tool ${O}`)}}function _(M,N){console.log("handleToolCall received:",N);const O=N.tool_use_id;if(!O){console.warn("Received tool_call without tool_use_id:",N);return}e.value.has(M)||e.value.set(M,[]);const D=e.value.get(M),z=D.findIndex(Y=>Y.id===O),J={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[N.status]||N.status;if(z!==-1){const Y=D[z];Y.status=J,Y.backendStatus=N.status,N.permission&&(Y.suggestions=N.permission.suggestions||[],Y.permissionRequestId=N.request_id),N.permission_granted!==null&&N.permission_granted!==void 0&&(Y.permissionDecision=N.permission_granted?"allow":"deny"),N.result!==void 0&&(Y.result={error:N.status==="failed",content:N.result}),N.error&&(Y.result={error:!0,content:N.error}),N.status==="denied"&&(Y.result={error:!0,message:"Permission denied"},Y.isExpanded=!1),N.status==="interrupted"&&(E(M,O,"Session was interrupted"),Y.isExpanded=!1),(N.status==="completed"||N.status==="failed")&&(Y.isExpanded=!1),N.display&&(Y.backendState=N.display),console.log(`Updated tool call ${O} to status: ${J} (backend: ${N.status})`)}else{const Y=j(N.name,N.input);t.value.set(Y,O);const te={id:O,name:N.name,input:N.input,signature:Y,status:J,backendStatus:N.status,permissionRequestId:N.request_id,permissionDecision:N.permission_granted!==void 0?N.permission_granted?"allow":"deny":null,suggestions:N.permission?.suggestions||[],result:N.result?{error:N.status==="failed",content:N.result}:null,explanation:null,timestamp:N.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(N.status),backendState:N.display};N.error&&(te.result={error:!0,content:N.error}),D.push(te),console.log(`Created new tool call ${O} for ${N.name} with status: ${J}`)}if(e.value=new Map(e.value),["completed","failed"].includes(N.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(N.name))try{$t().handleTaskToolResult(M,N.name,N.input,{error:N.status==="failed",content:N.result})}catch(Y){console.warn("Failed to update task store:",Y)}}function C(M,N){const O=N.tool_use_id;b(M,O,{status:N.is_error?"error":"completed",result:{error:N.is_error,content:N.content},isExpanded:!1}),console.log(`Tool ${O} ${N.is_error?"failed":"completed"}`);const D=e.value.get(M);if(D){const z=D.find(Q=>Q.id===O);if(z&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(z.name))try{$t().handleTaskToolResult(M,z.name,z.input,{error:N.is_error,content:N.content})}catch(Q){console.warn("Failed to update task store:",Q)}}}function S(M,N){const O=e.value.get(M);if(O){const D=O.find(z=>z.id===N);D&&(D.isExpanded=!D.isExpanded,e.value=new Map(e.value))}}function j(M,N){if(!M)return"unknown:{}";if(!N||typeof N!="object")return`${M}:{}`;const O=JSON.stringify(N,Object.keys(N).sort());return`${M}:${O}`}function L(M,N){const O=N.metadata?.display||N.display;if(!O)return;m.value.has(M)||m.value.set(M,new Map);const D=m.value.get(M);if(O.tool_states)for(const[z,Q]of Object.entries(O.tool_states)){D.set(z,Q);const J=e.value.get(M);if(J){const Y=J.find(te=>te.id===z);if(Y){const te={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Y.status=te[Q.state]||Q.state,Y.backendState=Q}}}if(O.orphaned_tools&&O.orphaned_tools.length>0){const z=a.value.get(M)||new Map;for(const Q of O.orphaned_tools)z.has(Q)||z.set(Q,{reason:"denied",message:"Session was interrupted"});a.value.set(M,z)}if(O.linked_permissions)for(const[z,Q]of Object.entries(O.linked_permissions))o.value.set(z,Q);O.tool_states&&Object.keys(O.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${M}:`,{toolStates:Object.keys(O.tool_states||{}).length,orphanedTools:(O.orphaned_tools||[]).length,linkedPermissions:Object.keys(O.linked_permissions||{}).length})}function x(M,N){return m.value.get(M)?.get(N)}function R(M){const N=m.value.get(M);return N&&N.size>0}function E(M,N,O){const D=a.value.get(M)||new Map;D.set(N,{reason:"denied",message:O}),a.value.set(M,D);const z=e.value.get(M);if(z){const Q=z.find(J=>J.id===N);Q&&Q.isExpanded&&(Q.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${N} as orphaned: ${O}`)}function T(M,N){const O=x(M,N);return O&&O.state==="orphaned"?!0:a.value.get(M)?.has(N)||!1}function F(M,N){const O=x(M,N);return O&&O.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:O}:a.value.get(M)?.get(N)}function U(M,N){const O=i.value.get(M);O&&O.size>0&&(O.forEach(D=>E(M,D,N)),O.clear())}function I(M){n.value.delete(M),e.value.delete(M),n.value=new Map(n.value),e.value=new Map(e.value)}function H(M){return c.value.get(M)}async function V(M){const N=c.value.get(M);if(!N)return console.log(`No sync needed for session ${M} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${M} since ${N}`);const O=await ue.get(`/api/sessions/${M}/messages?limit=1000&offset=0`),D=O.messages||[],z=O.has_more||!1,Q=B=>B?typeof B=="number"?B*1e3:new Date(B).getTime():0,J=Q(N),Y=D.filter(B=>B.timestamp?Q(B.timestamp)>J:!1);if(Y.length===0)return console.log(`No missed messages for session ${M}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Y.length} missed messages for session ${M}`);const te=n.value.get(M)||[],fe=new Set(te.map(B=>B.id).filter(Boolean)),G=Y.filter(B=>!B.id||!fe.has(B.id));if(console.log(`After deduplication: ${G.length} unique new messages`),G.length>0){const B=G.sort((Be,q)=>{const re=Q(Be.timestamp),le=Q(q.timestamp);return re-le}),Z=n.value.get(M)||[],ie=Z.length>0?Q(Z[Z.length-1].timestamp):0,he=Q(B[0].timestamp),nt=Q(B[B.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Z.length,lastExisting:ie,lastExistingDate:Z.length>0?Z[Z.length-1].timestamp:"none",firstNew:he,firstNewDate:B[0].timestamp,lastNew:nt,lastNewDate:B[B.length-1].timestamp,shouldAppend:he>ie}),he>ie){const Be=[...Z,...B];n.value.set(M,Be),console.log(`âœ… Appended ${B.length} new messages (no full sort needed)`)}else{const Be=[...Z,...B].sort((q,re)=>{const le=Q(q.timestamp),Ce=Q(re.timestamp);return le-Ce});n.value.set(M,Be),console.log(`âš ï¸ Merged and sorted ${B.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${te.length} messages unchanged`);G.forEach(B=>{k(M,B),B.metadata?.has_tool_uses&&B.metadata.tool_uses&&B.metadata.tool_uses.forEach(Z=>{h(M,Z)}),B.metadata?.has_tool_results&&B.metadata.tool_results&&B.metadata.tool_results.forEach(Z=>{C(M,Z)}),(B.type==="permission_request"||B.metadata?.has_permission_requests)&&u(M,B),B.type==="permission_response"&&y(M,{request_id:B.metadata?.request_id,decision:B.metadata?.decision,updated_input:B.metadata?.updated_input,reasoning:B.metadata?.reasoning,applied_updates:B.metadata?.applied_updates}),B.type==="system"&&(B.subtype==="init"||B.metadata?.subtype==="init")&&B.metadata?.init_data&&de().storeInitData(M,B.metadata.init_data)});const W=n.value.get(M);if(W&&W.length>0){const B=W[W.length-1];B.timestamp&&c.value.set(M,B.timestamp)}return n.value=new Map(n.value),{syncedCount:G.length,hasMore:z}}catch(O){return console.error(`Failed to sync messages for session ${M}:`,O),{syncedCount:0,hasMore:!1,error:O.message}}}const X=de();return pe(()=>Array.from(X.sessions.values()).map(N=>({id:N.session_id,state:N.state})),(M,N)=>{N&&M.forEach((O,D)=>{const z=N[D];if(!z||z.id!==O.id)return;const Q=["active","paused","starting"].includes(z.state),J=!["active","paused","starting"].includes(O.state);Q&&J&&U(O.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:gs(i),orphanedToolUses:gs(a),currentMessages:p,currentToolCalls:f,loadMessages:d,addMessage:g,addToolCall:$,updateToolCall:b,handleToolCall:_,handleToolUse:h,handlePermissionRequest:u,handlePermissionResponse:y,handleToolResult:C,toggleToolExpansion:S,clearMessages:I,markToolUseOrphaned:E,isToolUseOrphaned:T,getOrphanedInfo:F,clearOrphanedToolUses:U,getLastReceivedTimestamp:H,syncMessages:V,getBackendToolState:x,hasBackendDisplayMetadata:R,backendToolStates:gs(m)}}),na=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Te},Symbol.toStringTag,{value:"Module"}));function oa(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ht(n){return oa(n).toLocaleTimeString()}const ia={class:"message-row message-row-user"},aa=["title"],ra={class:"message-content-column"},la=["innerHTML"],ca={key:0,class:"tool-results mt-2"},ua={class:"tool-results-header text-muted small mb-2"},da={class:"d-flex align-items-start gap-2"},ma={class:"flex-grow-1"},pa={class:"text-muted"},fa={key:0,class:"text-danger small"},va={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;lt.setOptions({breaks:!0,gfm:!0});const t=v(()=>Ht(e.message.timestamp)),o=v(()=>`user
${t.value}`),i=v(()=>{const p=e.message.content||"";let f=lt.parse(p);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),ls.sanitize(f)}),a=v(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=v(()=>e.message.metadata?.tool_results||[]);function m(p,f){return p?p.length<=f?p:p.substring(0,f)+"...":""}return(p,f)=>(r(),l("div",ia,[s("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,aa),s("div",ra,[s("div",{class:"message-text",innerHTML:i.value},null,8,la),a.value?(r(),l("div",ca,[s("div",ua," ðŸ”§ Tool Results ("+w(c.value.length)+") ",1),(r(!0),l(ae,null,ce(c.value,(d,k)=>(r(),l("div",{key:k,class:ee(["tool-result-summary p-2 mb-2 rounded",d.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",da,[s("span",null,w(d.is_error?"âŒ":"âœ…"),1),s("div",ma,[s("small",pa,"Tool: "+w(d.tool_use_id),1),d.is_error?(r(),l("div",fa,w(m(d.content,200)),1)):A("",!0)])])],2))),128))])):A("",!0)])]))}},ha=se(va,[["__scopeId","data-v-7665755b"]]),_a={class:"thinking-block"},ga=["aria-label"],ba={class:"text-muted ms-auto"},ya={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},$a=["innerHTML"],wa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=P(!1),o=v(()=>e.thinking?.length||0),i=v(()=>{const c=e.thinking||"",m=lt.parse(c);return ls.sanitize(m)});function a(){t.value=!t.value}return(c,m)=>(r(),l("div",_a,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("span",{"aria-label":t.value?"Collapse":"Expand"},w(t.value?"â–¾":"â–¸"),9,ga),m[0]||(m[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",ba,w(o.value)+" characters",1)]),t.value?(r(),l("div",ya,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,$a)])):A("",!0)]))}},ka=se(wa,[["__scopeId","data-v-fda2352c"]]),Ze=mt("websocket",()=>{const n=P(null),e=P(!1),t=P(0),o=10,i=P(null),a=P(!1),c=P(0),m=5,p=P(null);let f=null;const d=P(0),k=P(null),g=P(new Map),$=P(null),b=P(!1),h=P(0),u=5,y=P(null),_=1e4,C=1e3,S=P(Date.now()),j=P(Date.now()),L=P(Date.now());let x=null,R=null,E=null;const T=v(()=>e.value&&(a.value||!p.value)?"connected":e.value?"partial":"disconnected");function F(G){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${G}`}function U(G){const W={ui:{timer:()=>x,setTimer:B=>{x=B},lastPing:S,connected:e,name:"UI"},session:{timer:()=>R,setTimer:B=>{R=B},lastPing:j,connected:a,name:"Session"},legion:{timer:()=>E,setTimer:B=>{E=B},lastPing:L,connected:b,name:"Legion"}}[G];W.timer()&&clearInterval(W.timer()),W.setTimer(setInterval(()=>{if(!W.connected.value)return;const B=Date.now()-W.lastPing.value;if(B>_){console.warn(`âš ï¸ ${W.name} WebSocket heartbeat timeout (${B}ms since last ping) - forcing close to trigger reconnection`),W.connected.value=!1;const ie={ui:n,session:i,legion:$}[G];ie.value&&ie.value.readyState===WebSocket.OPEN&&ie.value.close()}},C)),console.log(`âœ… Started heartbeat monitor for ${W.name} WebSocket`)}function I(G){const W={ui:{get:()=>x,set:B=>{x=B}},session:{get:()=>R,set:B=>{R=B}},legion:{get:()=>E,set:B=>{E=B}}}[G];W.get()&&(clearInterval(W.get()),W.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${G} WebSocket`))}function H(){if(n.value)return;const G=F("/ws/ui");console.log(`Connecting to UI WebSocket: ${G}`),n.value=new WebSocket(G),n.value.onopen=()=>{e.value=!0,t.value=0,S.value=Date.now(),U("ui"),console.log("UI WebSocket connected")},n.value.onmessage=W=>{const B=JSON.parse(W.data);Q(B)},n.value.onclose=()=>{if(I("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const W=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${W}ms (attempt ${t.value})`),setTimeout(H,W)}},n.value.onerror=W=>{console.error("UI WebSocket error:",W)}}function V(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function X(G){d.value++;const W=d.value;if(console.log(`[Gen ${W}] Starting connection to session ${G}`),f&&(clearTimeout(f),f=null),await M(),d.value!==W){console.log(`[Gen ${W}] Connection cancelled (current generation: ${d.value})`);return}p.value=G,k.value=W;const B=F(`/ws/session/${G}`);console.log(`[Gen ${W}] Connecting to Session WebSocket: ${B}`),i.value=new WebSocket(B),i.value.onopen=async()=>{if(k.value!==W){console.log(`[Gen ${W}] Ignoring onopen (stale connection, current: ${k.value})`),i.value.close();return}a.value=!0,c.value=0,j.value=Date.now(),U("session"),console.log(`[Gen ${W}] Session WebSocket connected for ${G}`);const Z=g.value.get(G);if(g.value.set(G,!0),Z){console.log(`[Gen ${W}] Reconnection detected, syncing missed messages...`);try{const he=await Te().syncMessages(G);he.syncedCount>0?console.log(`[Gen ${W}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${W}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${W}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${W}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ie){console.error(`[Gen ${W}] Error during message sync:`,ie)}}else console.log(`[Gen ${W}] Initial connection, no sync needed`)},i.value.onmessage=Z=>{if(k.value!==W){console.log(`[Gen ${W}] Ignoring message (stale connection, current: ${k.value})`);return}const ie=JSON.parse(Z.data);J(ie,G)},i.value.onclose=()=>{I("session"),a.value=!1,i.value=null,console.log(`[Gen ${W}] Session WebSocket closed for ${G}`);const Z=de();if(Z.currentSessionId===G&&k.value===W&&c.value<m){c.value++;const ie=Math.min(2e3*c.value,3e4);console.log(`[Gen ${W}] Reconnecting Session WebSocket in ${ie}ms (attempt ${c.value})`),f=setTimeout(()=>{k.value===W&&Z.currentSessionId===G?(f=null,X(G)):console.log(`[Gen ${W}] Skipping reconnect (generation or session changed)`)},ie)}},i.value.onerror=Z=>{console.error(`[Gen ${W}] Session WebSocket error:`,Z)}}function M(){return new Promise(G=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const W=p.value,B=()=>{i.value=null,a.value=!1,p.value=null,k.value=null,c.value=0,W&&g.value.delete(W),G()};if(i.value.readyState===WebSocket.CLOSED)B();else{const Z=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),B()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Z),B()},{once:!0}),i.value.close()}}else p.value=null,k.value=null,G()})}function N(G){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:G})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function O(G,W,B=!1,Z=null){if(i.value&&a.value){const ie={type:"permission_response",request_id:G,decision:W,apply_suggestions:B,timestamp:new Date().toISOString()};Z&&(ie.clarification_message=Z),i.value.send(JSON.stringify(ie)),console.log(`Sent permission ${W} for request ${G}`,{applySuggestions:B,clarification:Z})}}function D(G,W,B){if(i.value&&a.value){const Z={type:"permission_response",request_id:G,decision:W,updated_input:B,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(Z)),console.log(`Sent permission ${W} with updated_input for request ${G}`,B)}}function z(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function Q(G){const W=de(),B=je();switch(G.type){case"sessions_list":G.sessions&&Array.isArray(G.sessions)&&G.sessions.forEach(Z=>{W.updateSession(Z.session_id,Z)});break;case"state_change":G.data&&G.data.session_id&&G.data.session&&W.updateSession(G.data.session_id,G.data.session);break;case"project_updated":if(G.data&&G.data.project){const Z=G.data.project;B.updateProjectLocal(Z.project_id,Z),W.fetchSessions()}break;case"project_deleted":G.data&&G.data.project_id&&B.projects.delete(G.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":S.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",G.type)}}function J(G,W){const B=de();if(B.currentSessionId!==W){console.warn(`Ignoring message for session ${W} (current: ${B.currentSessionId})`);return}const Z=Te();switch(G.type){case"message":const ie=G.data;if(!ie||!ie.type){console.warn("Received message event with invalid data:",G);break}if(ie.type==="tool_call"){Z.handleToolCall(W,ie);break}if(ie.type==="permission_request"){Z.handlePermissionRequest(W,ie);break}if(ie.type==="permission_response"){Z.handlePermissionResponse(W,ie);break}ie.metadata?.has_tool_uses&&ie.metadata.tool_uses.forEach(he=>{Z.handleToolUse(W,he)}),ie.metadata?.has_tool_results&&ie.metadata.tool_results.forEach(he=>{Z.handleToolResult(W,he)}),ie.type==="system"&&(ie.subtype==="init"||ie.metadata?.subtype==="init")&&ie.metadata?.init_data&&B.storeInitData(W,ie.metadata.init_data),Z.addMessage(W,ie);break;case"permission_request":Z.handlePermissionRequest(W,G);break;case"permission_response":Z.handlePermissionResponse(W,G);break;case"tool_result":Z.handleToolResult(W,G);break;case"state_change":B.updateSession(W,G.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${W}`);break;case"ping":j.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",G.type)}}function Y(G){te(),y.value=G;const W=F(`/ws/legion/${G}`);console.log(`Connecting to Legion WebSocket: ${W}`),$.value=new WebSocket(W),$.value.onopen=()=>{b.value=!0,h.value=0,L.value=Date.now(),U("legion"),console.log(`Legion WebSocket connected for ${G}`)},$.value.onmessage=B=>{const Z=JSON.parse(B.data);fe(Z,G)},$.value.onclose=()=>{if(I("legion"),b.value=!1,$.value=null,console.log(`Legion WebSocket closed for ${G}`),y.value===G&&h.value<u){h.value++;const B=Math.min(2e3*h.value,3e4);setTimeout(()=>Y(G),B)}},$.value.onerror=B=>{console.error("Legion WebSocket error:",B)}}function te(){$.value&&($.value.close(),$.value=null,b.value=!1,y.value=null)}function fe(G,W){Me(async()=>{const{useLegionStore:B}=await Promise.resolve().then(()=>yb);return{useLegionStore:B}},void 0).then(({useLegionStore:B})=>{const Z=B();switch(G.type){case"comm":G.comm&&(Z.addComm(W,G.comm),console.log("Legion WebSocket: Received new comm",G.comm));break;case"minion_created":G.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",G.data),Me(async()=>{const{useSessionStore:ie}=await Promise.resolve().then(()=>_n);return{useSessionStore:ie}},void 0).then(({useSessionStore:ie})=>{ie().loadSessions()}));break;case"minion_updated":G.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",G.data),Me(async()=>{const{useSessionStore:ie}=await Promise.resolve().then(()=>_n);return{useSessionStore:ie}},void 0).then(({useSessionStore:ie})=>{ie().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${W}`);break;case"ping":L.value=Date.now(),$.value?.readyState===WebSocket.OPEN&&$.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",G.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:a,sessionRetryCount:c,legionConnected:b,legionRetryCount:h,overallStatus:T,connectUI:H,disconnectUI:V,connectSession:X,disconnectSession:M,sendMessage:N,sendPermissionResponse:O,sendPermissionResponseWithInput:D,interruptSession:z,connectLegion:Y,disconnectLegion:te}}),Sa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Ze},Symbol.toStringTag,{value:"Module"})),Ea={class:"base-tool-handler"},Ca={class:"tool-section"},Ta={class:"tool-parameters"},xa={class:"tool-code"},Aa={key:0,class:"tool-section"},Oa={class:"tool-section-label"},Ma={class:"tool-code"},Da={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=v(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,m)=>(r(),l("div",Ea,[s("div",Ca,[m[0]||(m[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",Ta,[s("pre",xa,w(t.value),1)])]),o.value?(r(),l("div",Aa,[s("div",Oa,w(i.value?"Error:":"Result:"),1),s("div",{class:ee(["tool-result",{"tool-result-error":i.value}])},[s("pre",Ma,w(a.value),1)],2)])):A("",!0)]))}},Na=se(Da,[["__scopeId","data-v-1e69f57d"]]),La={class:"read-tool-handler"},ja={class:"tool-section"},Ia={class:"read-file-info"},Pa={class:"file-path"},Ra={key:0,class:"read-range"},Wa={key:0,class:"tool-section"},Ha={key:0,class:"tool-result tool-result-error"},Ba={class:"tool-code"},Fa={key:1,class:"file-content-preview"},Va={class:"content-header"},Ua={class:"line-count-badge"},qa={key:0,class:"preview-note"},za={class:"tool-code content-display"},Ka={key:0,class:"more-indicator"},ws=100,Ga={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>{const $=e.toolCall.input?.offset,b=e.toolCall.input?.limit;return $!==void 0||b!==void 0}),i=v(()=>{const $=e.toolCall.input?.offset;return $!==void 0?$+1:1}),a=v(()=>{const $=e.toolCall.input?.offset||0,b=e.toolCall.input?.limit;return b!==void 0?$+b:"âˆž"}),c=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=v(()=>{if(!c.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)}),f=v(()=>m.value||!p.value?[]:p.value.split(`
`)),d=v(()=>f.value.length),k=v(()=>d.value>ws),g=v(()=>m.value?"":f.value.slice(0,ws).join(`
`));return($,b)=>(r(),l("div",La,[s("div",ja,[s("div",Ia,[b[0]||(b[0]=s("span",{class:"file-icon"},"ðŸ“„",-1)),b[1]||(b[1]=s("strong",null,"Reading:",-1)),s("code",Pa,w(t.value),1),o.value?(r(),l("span",Ra,"Lines "+w(i.value)+"-"+w(a.value),1)):A("",!0)])]),c.value?(r(),l("div",Wa,[m.value?(r(),l("div",Ha,[s("pre",Ba,w(p.value),1)])):(r(),l("div",Fa,[s("div",Va,[b[2]||(b[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Ua,w(d.value)+" lines",1),k.value?(r(),l("span",qa,"(showing first "+w(ws)+")")):A("",!0)]),s("pre",za,w(g.value),1),k.value?(r(),l("div",Ka,"...")):A("",!0)]))])):A("",!0)]))}},Ya=se(Ga,[["__scopeId","data-v-1f2b0569"]]),Ja={class:"write-tool-handler"},Qa={class:"tool-section"},Xa={class:"write-file-info mb-2"},Za={class:"file-path"},er={class:"write-content-preview"},tr={class:"content-header"},sr={class:"line-count-badge"},nr={key:0,class:"preview-note"},or={class:"tool-code content-display"},ir={key:0,class:"more-indicator"},ar={key:0,class:"tool-section"},rr={key:0,class:"tool-result tool-result-error"},lr={class:"tool-code"},cr={key:1,class:"tool-result tool-result-success"},ur={class:"success-message"},ks=100,dr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.content||""),i=v(()=>o.value.split(`
`)),a=v(()=>i.value.length),c=v(()=>a.value>ks),m=v(()=>i.value.slice(0,ks).join(`
`)),p=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!p.value)return"";const k=e.toolCall.result;return k.content!==void 0?typeof k.content=="string"?k.content:JSON.stringify(k.content,null,2):k.message?k.message:JSON.stringify(k,null,2)});return(k,g)=>(r(),l("div",Ja,[s("div",Qa,[s("div",Xa,[g[0]||(g[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=s("strong",null,"Writing:",-1)),s("code",Za,w(t.value),1)]),s("div",er,[s("div",tr,[g[2]||(g[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",sr,w(a.value)+" lines",1),c.value?(r(),l("span",nr,"(showing first "+w(ks)+")")):A("",!0)]),s("pre",or,w(m.value),1),c.value?(r(),l("div",ir,"...")):A("",!0)])]),p.value?(r(),l("div",ar,[f.value?(r(),l("div",rr,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",lr,w(d.value),1)])):(r(),l("div",cr,[s("div",ur,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+w(a.value)+" lines written)",1)])]))])):A("",!0)]))}},mr=se(dr,[["__scopeId","data-v-ddc24a0f"]]),pr={class:"bash-tool-handler"},fr={class:"tool-section"},vr={class:"bash-header"},hr={class:"bash-header-content"},_r={key:0,class:"bash-description"},gr={key:1,class:"bash-flags"},br={class:"bash-command-section"},yr={class:"bash-command-content"},$r={key:0,class:"tool-section"},wr={key:0,class:"bash-output"},kr={key:1,class:"bash-output-empty"},Sr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.command||""),o=v(()=>e.toolCall.input?.description||""),i=v(()=>e.toolCall.input?.timeout),a=v(()=>e.toolCall.input?.run_in_background||!1),c=v(()=>i.value||a.value),m=v(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),a.value&&g.push("background"),g.join(", ")}),p=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>f.value?"tool-result-error":"tool-result-success"),k=v(()=>{if(!p.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,$)=>(r(),l("div",pr,[s("div",fr,[s("div",vr,[$[1]||($[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",hr,[o.value?(r(),l("div",_r,[$[0]||($[0]=s("strong",null,"Description:",-1)),ne(" "+w(o.value),1)])):A("",!0),c.value?(r(),l("div",gr,w(m.value),1)):A("",!0)])]),s("div",br,[$[2]||($[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",yr,w(t.value),1)])]),p.value?(r(),l("div",$r,[s("div",{class:ee(["tool-result",d.value])},[$[3]||($[3]=s("strong",null,"Output:",-1)),k.value?(r(),l("pre",wr,w(k.value),1)):(r(),l("div",kr,"No output"))],2)])):A("",!0)]))}},Er=se(Sr,[["__scopeId","data-v-ab50fe73"]]),Cr={class:"todo-tool-handler"},Tr={class:"tool-section"},xr={class:"todo-header"},Ar={class:"todo-summary"},Or={key:0,class:"todo-count todo-count-completed"},Mr={key:1,class:"todo-count todo-count-in-progress"},Dr={key:2,class:"todo-count todo-count-pending"},Nr={class:"todo-checklist"},Lr={class:"todo-checkbox"},jr={class:"todo-content"},Ir={key:0,class:"tool-section"},Pr={key:0,class:"tool-result tool-result-error"},Rr={class:"tool-code"},Wr={key:1,class:"tool-result tool-result-success"},Hr={class:"success-message"},Br={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.todos||[]),o=v(()=>t.value.filter(d=>d.status==="completed").length),i=v(()=>t.value.filter(d=>d.status==="in_progress").length),a=v(()=>t.value.filter(d=>d.status==="pending").length);function c(d){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[d]||"â˜"}const m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=v(()=>{if(!m.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,k)=>(r(),l("div",Cr,[s("div",Tr,[s("div",xr,[k[0]||(k[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),k[1]||(k[1]=s("strong",null,"Task List:",-1)),s("div",Ar,[o.value>0?(r(),l("span",Or,w(o.value)+" completed ",1)):A("",!0),i.value>0?(r(),l("span",Mr,w(i.value)+" in progress ",1)):A("",!0),a.value>0?(r(),l("span",Dr,w(a.value)+" pending ",1)):A("",!0)])]),s("div",Nr,[(r(!0),l(ae,null,ce(t.value,(g,$)=>(r(),l("div",{key:$,class:ee(["todo-item",`todo-${g.status}`])},[s("span",Lr,w(c(g.status)),1),s("span",jr,w(g.content),1)],2))),128))])]),m.value?(r(),l("div",Ir,[p.value?(r(),l("div",Pr,[k[2]||(k[2]=s("strong",null,"Error:",-1)),s("pre",Rr,w(f.value),1)])):(r(),l("div",Wr,[s("div",Hr,[k[3]||(k[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+w(t.value.length)+" tasks)",1)])]))])):A("",!0)]))}},Fr=se(Br,[["__scopeId","data-v-bbe55ee7"]]),Vr={class:"edit-tool-handler"},Ur={class:"tool-section"},qr={class:"edit-file-info"},zr={class:"file-path"},Kr={key:0,class:"replace-all-badge"},Gr={class:"edit-diff-container"},Yr={class:"diff-header"},Jr={class:"diff-stats"},Qr={class:"stat-removed"},Xr={class:"stat-added"},Zr={class:"unified-diff"},el={class:"diff-scroll-container"},tl={class:"diff-marker"},sl={class:"diff-content"},nl={key:0,class:"tool-section"},ol={key:0,class:"tool-result tool-result-error"},il={class:"tool-code"},al={key:1,class:"tool-result tool-result-success"},rl={class:"success-message"},ll={key:0,class:"success-detail"},cl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.old_string||""),i=v(()=>e.toolCall.input?.new_string||""),a=v(()=>e.toolCall.input?.replace_all||!1),c=v(()=>{const $=Ei(t.value,o.value,i.value,"","",{context:3}).split(`
`),b=[];for(let h=4;h<$.length;h++){const u=$[h];u&&(u.startsWith("-")?b.push({type:"removed",content:u.substring(1)}):u.startsWith("+")?b.push({type:"added",content:u.substring(1)}):u.startsWith(" ")?b.push({type:"context",content:u.substring(1)}):u.startsWith("@@")&&b.push({type:"hunk",content:u}))}return b}),m=v(()=>c.value.filter(g=>g.type==="removed").length),p=v(()=>c.value.filter(g=>g.type==="added").length),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,$)=>(r(),l("div",Vr,[s("div",Ur,[s("div",qr,[$[0]||($[0]=s("span",{class:"file-icon"},"âœï¸",-1)),$[1]||($[1]=s("strong",null,"Editing:",-1)),s("code",zr,w(t.value),1),a.value?(r(),l("span",Kr,"Replace All")):A("",!0)]),s("div",Gr,[s("div",Yr,[$[2]||($[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Jr,[s("span",Qr,"-"+w(m.value),1),s("span",Xr,"+"+w(p.value),1)])]),s("div",Zr,[s("div",el,[(r(!0),l(ae,null,ce(c.value,(b,h)=>(r(),l("div",{key:h,class:ee(["diff-line",{"diff-line-removed":b.type==="removed","diff-line-added":b.type==="added","diff-line-context":b.type==="context","diff-line-hunk":b.type==="hunk"}])},[s("span",tl,w(b.type==="removed"?"-":b.type==="added"?"+":b.type==="hunk"?"@":" "),1),s("span",sl,w(b.content),1)],2))),128))])])])]),f.value?(r(),l("div",nl,[d.value?(r(),l("div",ol,[$[3]||($[3]=s("strong",null,"Error:",-1)),s("pre",il,w(k.value),1)])):(r(),l("div",al,[s("div",rl,[$[4]||($[4]=s("span",{class:"success-icon"},"âœ…",-1)),$[5]||($[5]=s("strong",null,"File edited successfully",-1)),a.value?(r(),l("span",ll,"(all occurrences replaced)")):A("",!0)])]))])):A("",!0)]))}},ul=se(cl,[["__scopeId","data-v-dd74055e"]]),dl={class:"search-tool-handler"},ml={class:"tool-section"},pl={class:"search-info"},fl={class:"search-icon"},vl={class:"search-pattern"},hl={key:0,class:"search-path"},_l={key:1,class:"search-filters"},gl={key:0,class:"filter-badge"},bl={key:1,class:"filter-badge"},yl={key:2,class:"filter-badge"},$l={key:0,class:"tool-section"},wl={key:0,class:"tool-result tool-result-error"},kl={class:"tool-code"},Sl={key:1,class:"search-results"},El={class:"results-header"},Cl={class:"results-label"},Tl={class:"results-count-badge"},xl={class:"results-content"},Al={class:"tool-code"},Ol={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="Grep"),o=v(()=>e.toolCall.input?.pattern||"Unknown"),i=v(()=>e.toolCall.input?.path||null),a=v(()=>e.toolCall.input?.type||null),c=v(()=>e.toolCall.input?.glob||null),m=v(()=>e.toolCall.input?.["-i"]||!1),p=v(()=>a.value||c.value||m.value),f=v(()=>t.value?"ðŸ”":"ðŸ“"),d=v(()=>t.value?"Searching content":"Finding files"),k=v(()=>t.value?"Matches":"Files found"),g=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!g.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)}),h=v(()=>!g.value||$.value||!b.value?0:b.value.split(`
`).filter(y=>y.trim()).length);return(u,y)=>(r(),l("div",dl,[s("div",ml,[s("div",pl,[s("span",fl,w(f.value),1),s("strong",null,w(d.value)+":",1),s("code",vl,w(o.value),1),i.value?(r(),l("span",hl,"in "+w(i.value),1)):A("",!0),p.value?(r(),l("span",_l,[a.value?(r(),l("span",gl,"type: "+w(a.value),1)):A("",!0),c.value?(r(),l("span",bl,"glob: "+w(c.value),1)):A("",!0),m.value?(r(),l("span",yl,"case-insensitive")):A("",!0)])):A("",!0)])]),g.value?(r(),l("div",$l,[$.value?(r(),l("div",wl,[y[0]||(y[0]=s("strong",null,"Error:",-1)),s("pre",kl,w(b.value),1)])):(r(),l("div",Sl,[s("div",El,[s("span",Cl,w(k.value)+":",1),s("span",Tl,w(h.value)+" "+w(h.value===1?"match":"matches"),1)]),s("div",xl,[s("pre",Al,w(b.value),1)])]))])):A("",!0)]))}},gn=se(Ol,[["__scopeId","data-v-0d272c39"]]),Ml={class:"web-tool-handler"},Dl={class:"tool-section"},Nl={class:"web-info"},Ll={class:"web-icon"},jl=["href"],Il={key:1,class:"web-query"},Pl={key:0,class:"web-prompt-container"},Rl={class:"prompt-content"},Wl={key:1,class:"web-domains"},Hl={class:"domains-label"},Bl={key:0,class:"tool-section"},Fl={key:0,class:"tool-result tool-result-error"},Vl={class:"tool-code"},Ul={key:1,class:"web-results"},ql={class:"results-header"},zl={class:"results-label"},Kl={class:"results-content"},Gl={class:"tool-code"},Yl={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="WebFetch"),o=v(()=>e.toolCall.input?.url||null),i=v(()=>e.toolCall.input?.query||null),a=v(()=>e.toolCall.input?.prompt||null),c=v(()=>e.toolCall.input?.allowed_domains||[]),m=v(()=>e.toolCall.input?.blocked_domains||[]),p=v(()=>c.value.length>0?c.value:m.value.length>0?m.value:[]),f=v(()=>c.value.length>0?"Allowed domains":m.value.length>0?"Blocked domains":"Domains"),d=v(()=>t.value?"ðŸŒ":"ðŸ”Ž"),k=v(()=>t.value?"Fetching URL":"Searching web"),g=v(()=>t.value?"Fetched content":"Search results"),$=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),b=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=v(()=>{if(!$.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,y)=>(r(),l("div",Ml,[s("div",Dl,[s("div",Nl,[s("span",Ll,w(d.value),1),s("strong",null,w(k.value)+":",1),o.value?(r(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},w(o.value),9,jl)):i.value?(r(),l("code",Il,w(i.value),1)):A("",!0)]),a.value?(r(),l("div",Pl,[y[0]||(y[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Rl,w(a.value),1)])):A("",!0),p.value.length>0?(r(),l("div",Wl,[s("span",Hl,w(f.value)+":",1),(r(!0),l(ae,null,ce(p.value,_=>(r(),l("span",{key:_,class:"domain-badge"},w(_),1))),128))])):A("",!0)]),$.value?(r(),l("div",Bl,[b.value?(r(),l("div",Fl,[y[1]||(y[1]=s("strong",null,"Error:",-1)),s("pre",Vl,w(h.value),1)])):(r(),l("div",Ul,[s("div",ql,[s("span",zl,w(g.value)+":",1)]),s("div",Kl,[s("pre",Gl,w(h.value),1)])]))])):A("",!0)]))}},bn=se(Yl,[["__scopeId","data-v-62b55b55"]]),Jl={class:"task-tool-handler"},Ql={class:"tool-section"},Xl={class:"task-header"},Zl={key:0,class:"agent-type-badge"},ec={key:0,class:"task-description"},tc={class:"description-content"},sc={key:1,class:"task-prompt-container"},nc={class:"prompt-header"},oc={class:"prompt-length"},ic={class:"prompt-code"},ac={key:0,class:"tool-section"},rc={key:0,class:"tool-result tool-result-error"},lc={class:"tool-code"},cc={key:1,class:"agent-output"},uc={class:"output-header"},dc={key:0,class:"output-count-badge"},mc={class:"output-content"},pc={class:"tool-code"},fc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.description||null),o=v(()=>e.toolCall.input?.prompt||null),i=v(()=>e.toolCall.input?.subagent_type||null),a=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=v(()=>{if(!a.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),p=v(()=>m.value?m.value.split(`
`).length:0);return(f,d)=>(r(),l("div",Jl,[s("div",Ql,[s("div",Xl,[d[0]||(d[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),d[1]||(d[1]=s("strong",null,"Agent Task:",-1)),i.value?(r(),l("span",Zl,w(i.value),1)):A("",!0)]),t.value?(r(),l("div",ec,[d[2]||(d[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",tc,w(t.value),1)])):A("",!0),o.value?(r(),l("div",sc,[s("div",nc,[d[3]||(d[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",oc,w(o.value.length)+" characters",1)]),s("pre",ic,w(o.value),1)])):A("",!0)]),a.value?(r(),l("div",ac,[c.value?(r(),l("div",rc,[d[4]||(d[4]=s("strong",null,"Error:",-1)),s("pre",lc,w(m.value),1)])):(r(),l("div",cc,[s("div",uc,[d[5]||(d[5]=s("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(r(),l("span",dc,w(p.value)+" lines",1)):A("",!0)]),s("div",mc,[s("pre",pc,w(m.value),1)])]))])):A("",!0)]))}},vc=se(fc,[["__scopeId","data-v-c520c244"]]),hc={class:"task-create-tool-handler"},_c={class:"tool-section"},gc={class:"task-details p-2"},bc={key:0,class:"task-field mb-2"},yc={class:"field-value subject-value"},$c={key:1,class:"task-field mb-2"},wc={class:"field-value description-value"},kc={key:2,class:"task-field"},Sc={class:"field-value active-form-value"},Ec={key:0,class:"tool-section mt-2"},Cc={key:0,class:"tool-result tool-result-error"},Tc={class:"tool-code"},xc={key:1,class:"tool-result tool-result-success"},Ac={class:"result-text"},Oc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.subject||null),o=v(()=>e.toolCall.input?.description||null),i=v(()=>e.toolCall.input?.activeForm||null),a=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=v(()=>{if(!a.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,f)=>(r(),l("div",hc,[s("div",_c,[f[3]||(f[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",gc,[t.value?(r(),l("div",bc,[f[0]||(f[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",yc,w(t.value),1)])):A("",!0),o.value?(r(),l("div",$c,[f[1]||(f[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",wc,w(o.value),1)])):A("",!0),i.value?(r(),l("div",kc,[f[2]||(f[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Sc,w(i.value),1)])):A("",!0)])]),a.value?(r(),l("div",Ec,[c.value?(r(),l("div",Cc,[f[4]||(f[4]=s("strong",null,"Error:",-1)),s("pre",Tc,w(m.value),1)])):(r(),l("div",xc,[f[5]||(f[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Ac,w(m.value),1)]))])):A("",!0)]))}},Mc=se(Oc,[["__scopeId","data-v-474dd444"]]),Dc={class:"task-update-tool-handler"},Nc={class:"tool-section"},Lc={class:"task-header"},jc={key:0,class:"task-id-badge"},Ic={class:"task-details p-2"},Pc={key:0,class:"task-field mb-2"},Rc={key:1,class:"task-field mb-2"},Wc={class:"field-value"},Hc={key:2,class:"task-field mb-2"},Bc={class:"field-value description-value"},Fc={key:3,class:"task-field mb-2"},Vc={class:"field-value active-form-value"},Uc={key:4,class:"task-field mb-2"},qc={class:"field-value"},zc={key:5,class:"task-field mb-2"},Kc={class:"field-value"},Gc={key:6,class:"task-field"},Yc={class:"field-value"},Jc={key:0,class:"tool-section mt-2"},Qc={key:0,class:"tool-result tool-result-error"},Xc={class:"tool-code"},Zc={key:1,class:"tool-result tool-result-success"},eu={class:"result-text"},tu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.input?.status||null),i=v(()=>e.toolCall.input?.subject||null),a=v(()=>e.toolCall.input?.description||null),c=v(()=>e.toolCall.input?.activeForm||null),m=v(()=>e.toolCall.input?.owner||null),p=v(()=>e.toolCall.input?.addBlockedBy||[]),f=v(()=>e.toolCall.input?.addBlocks||[]),d=v(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),k=v(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!g.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,u)=>(r(),l("div",Dc,[s("div",Nc,[s("div",Lc,[u[0]||(u[0]=s("span",{class:"task-icon"},"âœï¸",-1)),u[1]||(u[1]=s("strong",null,"Update Task",-1)),t.value?(r(),l("span",jc,"#"+w(t.value),1)):A("",!0)]),s("div",Ic,[o.value?(r(),l("div",Pc,[u[2]||(u[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:ee(["field-value status-value",k.value])},w(d.value)+" "+w(o.value),3)])):A("",!0),i.value?(r(),l("div",Rc,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Wc,w(i.value),1)])):A("",!0),a.value?(r(),l("div",Hc,[u[4]||(u[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",Bc,w(a.value),1)])):A("",!0),c.value?(r(),l("div",Fc,[u[5]||(u[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Vc,w(c.value),1)])):A("",!0),m.value?(r(),l("div",Uc,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",qc,w(m.value),1)])):A("",!0),p.value?.length?(r(),l("div",zc,[u[7]||(u[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",Kc,[(r(!0),l(ae,null,ce(p.value,y=>(r(),l("span",{key:y,class:"badge bg-warning text-dark me-1"},"#"+w(y),1))),128))])])):A("",!0),f.value?.length?(r(),l("div",Gc,[u[8]||(u[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",Yc,[(r(!0),l(ae,null,ce(f.value,y=>(r(),l("span",{key:y,class:"badge bg-info text-dark me-1"},"#"+w(y),1))),128))])])):A("",!0)])]),g.value?(r(),l("div",Jc,[$.value?(r(),l("div",Qc,[u[9]||(u[9]=s("strong",null,"Error:",-1)),s("pre",Xc,w(b.value),1)])):(r(),l("div",Zc,[u[10]||(u[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",eu,w(b.value),1)]))])):A("",!0)]))}},su=se(tu,[["__scopeId","data-v-35582330"]]),nu={class:"task-list-tool-handler"},ou={key:0,class:"tool-section"},iu={key:0,class:"tool-result tool-result-error"},au={class:"tool-code"},ru={key:1,class:"task-list-result"},lu={key:0,class:"parsed-tasks"},cu={class:"status-icon"},uu={class:"task-id text-muted"},du={class:"task-subject flex-grow-1"},mu={key:0,class:"task-owner badge bg-secondary"},pu={key:1,class:"raw-result p-2"},fu={class:"tool-code"},vu={key:1,class:"tool-section"},hu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=v(()=>{if(!t.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),a=v(()=>{if(!i.value)return[];const m=[],f=i.value.split(`
`);for(const d of f){const k=d.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(k){const g=k[2].toLowerCase();m.push({id:k[1],status:g,subject:k[3].trim(),owner:null,statusIcon:c(g)})}}return m});function c(m){switch(m){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(m,p)=>(r(),l("div",nu,[p[2]||(p[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(r(),l("div",ou,[o.value?(r(),l("div",iu,[p[0]||(p[0]=s("strong",null,"Error:",-1)),s("pre",au,w(i.value),1)])):(r(),l("div",ru,[a.value.length>0?(r(),l("div",lu,[(r(!0),l(ae,null,ce(a.value,(f,d)=>(r(),l("div",{key:d,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",cu,w(f.statusIcon),1),s("span",uu,"#"+w(f.id),1),s("span",du,w(f.subject),1),f.owner?(r(),l("span",mu,w(f.owner),1)):A("",!0)]))),128))])):(r(),l("div",pu,[s("pre",fu,w(i.value),1)]))]))])):n.toolCall.status==="completed"?(r(),l("div",vu,[...p[1]||(p[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):A("",!0)]))}},_u=se(hu,[["__scopeId","data-v-4e79ba4b"]]),gu={class:"task-get-tool-handler"},bu={class:"tool-section"},yu={class:"task-header"},$u={key:0,class:"task-id-badge"},wu={key:0,class:"tool-section"},ku={key:0,class:"tool-result tool-result-error"},Su={class:"tool-code"},Eu={key:1,class:"task-details-result p-2"},Cu={key:0,class:"parsed-task"},Tu={class:"task-field mb-2"},xu={class:"field-value subject-value"},Au={key:0,class:"task-field mb-2"},Ou={key:1,class:"task-field mb-2"},Mu={class:"field-value description-value"},Du={key:2,class:"task-field mb-2"},Nu={class:"field-value"},Lu={key:3,class:"task-field mb-2"},ju={class:"field-value"},Iu={key:4,class:"task-field"},Pu={class:"field-value"},Ru={key:1,class:"raw-result"},Wu={class:"tool-code"},Hu={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=v(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=v(()=>{if(!a.value)return null;const f=a.value;try{const g=JSON.parse(f);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const d=f.split(`
`),k={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of d){const $=g.match(/^Subject:\s*(.+)$/i);$&&(k.subject=$[1].trim());const b=g.match(/^Status:\s*(.+)$/i);b&&(k.status=b[1].trim());const h=g.match(/^Description:\s*(.+)$/i);h&&(k.description=h[1].trim());const u=g.match(/^Owner:\s*(.+)$/i);u&&(k.owner=u[1].trim())}return k.subject?k:null}),m=v(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),p=v(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,d)=>(r(),l("div",gu,[s("div",bu,[s("div",yu,[d[0]||(d[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),d[1]||(d[1]=s("strong",null,"Get Task",-1)),t.value?(r(),l("span",$u,"#"+w(t.value),1)):A("",!0)])]),o.value?(r(),l("div",wu,[i.value?(r(),l("div",ku,[d[2]||(d[2]=s("strong",null,"Error:",-1)),s("pre",Su,w(a.value),1)])):(r(),l("div",Eu,[c.value?(r(),l("div",Cu,[s("div",Tu,[d[3]||(d[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",xu,w(c.value.subject),1)]),c.value.status?(r(),l("div",Au,[d[4]||(d[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:ee(["field-value",p.value])},w(m.value)+" "+w(c.value.status),3)])):A("",!0),c.value.description?(r(),l("div",Ou,[d[5]||(d[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",Mu,w(c.value.description),1)])):A("",!0),c.value.owner?(r(),l("div",Du,[d[6]||(d[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",Nu,w(c.value.owner),1)])):A("",!0),c.value.blockedBy?.length?(r(),l("div",Lu,[d[7]||(d[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",ju,[(r(!0),l(ae,null,ce(c.value.blockedBy,k=>(r(),l("span",{key:k,class:"badge bg-warning text-dark me-1"},"#"+w(k),1))),128))])])):A("",!0),c.value.blocks?.length?(r(),l("div",Iu,[d[8]||(d[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Pu,[(r(!0),l(ae,null,ce(c.value.blocks,k=>(r(),l("span",{key:k,class:"badge bg-info text-dark me-1"},"#"+w(k),1))),128))])])):A("",!0)])):(r(),l("div",Ru,[s("pre",Wu,w(a.value),1)]))]))])):A("",!0)]))}},Bu=se(Hu,[["__scopeId","data-v-a80d14da"]]),Fu={class:"notebook-edit-tool-handler"},Vu={class:"tool-section"},Uu={class:"notebook-info"},qu={class:"file-path"},zu={class:"cell-info mt-2"},Ku={class:"info-row"},Gu={class:"info-row"},Yu={key:0,class:"info-row"},Ju={class:"badge bg-info"},Qu={key:0,class:"source-preview mt-3"},Xu={class:"preview-header"},Zu={class:"preview-stats"},ed={class:"source-code"},td={key:0,class:"tool-section"},sd={key:0},nd={key:1,class:"text-danger"},od={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.notebook_path||"Unknown"),o=v(()=>e.toolCall.input?.cell_id),i=v(()=>e.toolCall.input?.cell_type||"code"),a=v(()=>e.toolCall.input?.edit_mode||"replace"),c=v(()=>e.toolCall.input?.new_source||""),m=v(()=>c.value.split(`
`).length),p=v(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const k=a.value;return k==="insert"?"Cell inserted successfully":k==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(k,g)=>(r(),l("div",Fu,[s("div",Vu,[s("div",Uu,[g[0]||(g[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=s("strong",null,"Notebook:",-1)),s("code",qu,w(t.value),1)]),s("div",zu,[s("div",Ku,[g[2]||(g[2]=s("strong",null,"Cell ID:",-1)),s("code",null,w(o.value||"N/A"),1)]),s("div",Gu,[g[3]||(g[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:ee(["badge",p.value])},w(i.value),3)]),a.value?(r(),l("div",Yu,[g[4]||(g[4]=s("strong",null,"Edit Mode:",-1)),s("span",Ju,w(a.value),1)])):A("",!0)]),c.value?(r(),l("div",Qu,[s("div",Xu,[g[5]||(g[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",Zu,w(m.value)+" lines",1)]),s("pre",ed,[s("code",null,w(c.value),1)])])):A("",!0)]),n.toolCall.result?(r(),l("div",td,[g[6]||(g[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:ee(["tool-result",f.value])},[n.toolCall.result.success!==!1?(r(),l("div",sd," âœ… "+w(d.value),1)):(r(),l("div",nd," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)])):A("",!0)]))}},id=se(od,[["__scopeId","data-v-c81a9bcf"]]),ad={class:"shell-tool-handler"},rd={class:"tool-section"},ld={class:"shell-info"},cd={class:"shell-icon"},ud={key:0,class:"shell-id"},dd={key:0,class:"filter-info mt-2"},md={class:"filter-pattern"},pd={key:0,class:"tool-section"},fd={class:"result-header mb-2"},vd={key:0,class:"mb-2"},hd={class:"shell-output"},_d={key:1,class:"mb-2"},gd={class:"shell-output shell-output-error"},bd={key:0},yd={key:1,class:"text-danger"},$d={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=v(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=v(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=v(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=v(()=>e.toolCall.input?.filter);function m($,b){if(!$)return null;const h=new RegExp(`<${b}>([\\s\\S]*?)<\\/${b}>`,"i"),u=$.match(h);return u?u[1].trim():null}const p=v(()=>{const $=e.toolCall.result;if(!$)return null;let b=$;if($.content&&(b=$.content),typeof b=="string")return{status:m(b,"status"),stdout:m(b,"stdout"),stderr:m(b,"stderr"),exit_code:m(b,"exit_code")};if(Array.isArray(b)){const h=b.find(u=>u.type==="text")?.text||"";return{status:m(h,"status"),stdout:m(h,"stdout"),stderr:m(h,"stderr"),exit_code:m(h,"exit_code")}}return{status:$.status||b.status,stdout:$.stdout||$.output||b.stdout||b.output,stderr:$.stderr||b.stderr,exit_code:$.exit_code||b.exit_code}}),f=v(()=>p.value?.status),d=v(()=>{const $=f.value;return $==="running"?"bg-success":$==="completed"?"bg-secondary":$==="killed"||$==="terminated"?"bg-danger":"bg-info"}),k=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const $=p.value;if($?.status==="running"&&!$.stdout&&!$.stderr)return"No new output since last check";if($?.status==="failed")return`Shell failed (exit code ${$.exit_code||"unknown"})`}return"Operation completed"});return($,b)=>(r(),l("div",ad,[s("div",rd,[s("div",ld,[s("span",cd,w(t.value),1),s("strong",null,w(o.value)+":",1),a.value?(r(),l("code",ud,"Shell "+w(a.value),1)):A("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(r(),l("div",dd,[b[0]||(b[0]=s("strong",null,"Filter:",-1)),s("code",md,w(c.value),1)])):A("",!0)]),n.toolCall.result?(r(),l("div",pd,[s("div",fd,[s("strong",null,w(i.value)+":",1),f.value?(r(),l("span",{key:0,class:ee(["badge",d.value])},w(f.value),3)):A("",!0)]),p.value?.stdout?(r(),l("div",vd,[b[1]||(b[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",hd,[s("pre",null,[s("code",null,w(p.value.stdout),1)])])])):A("",!0),p.value?.stderr?(r(),l("div",_d,[b[2]||(b[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",gd,[s("pre",null,[s("code",null,w(p.value.stderr),1)])])])):A("",!0),!p.value?.stdout&&!p.value?.stderr?(r(),l("div",{key:2,class:ee(["tool-result",k.value])},[n.toolCall.result.success!==!1?(r(),l("div",bd," âœ… "+w(g.value),1)):(r(),l("div",yd," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)):A("",!0)])):A("",!0)]))}},yn=se($d,[["__scopeId","data-v-86def281"]]),wd={class:"skill-tool-handler"},kd={key:0,class:"tool-section"},Sd={class:"d-flex align-items-center gap-2"},Ed={class:"text-muted small"},Cd={key:0,class:"skill-content-body"},Td={class:"skill-content-text"},xd={key:1,class:"tool-section mt-3"},Ad={class:"tool-result tool-result-error"},Od={class:"tool-code"},Md={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Te(),o=de(),i=P(!1);function a(){i.value=!i.value}const c=v(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const $=t.messagesBySession.get(g)||[],b=$.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let h=null,u=null;for(let y=b+1;y<Math.min(b+3,$.length);y++){const _=$[y];if(_.type!=="user")continue;const C=_.content||"";C.includes("<command-message>")&&C.includes("skill is running")?h=_:C.startsWith("Base directory for this skill:")&&(u=_)}return{running:h,content:u}}),m=v(()=>{const g=c.value.content;if(!g)return"";const $=g.content||"",b=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return $.replace(b,"").trim()}),p=v(()=>m.value.length>0),f=v(()=>m.value?m.value.split(`
`).length:0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!d.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,$)=>(r(),l("div",wd,[p.value?(r(),l("div",kd,[s("div",{class:"skill-content-header",onClick:a},[s("div",Sd,[s("i",{class:ee(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),$[0]||($[0]=s("strong",null,"Skill Content",-1)),s("span",Ed,"("+w(f.value)+" lines)",1)])]),i.value?(r(),l("div",Cd,[s("pre",Td,w(m.value),1)])):A("",!0)])):A("",!0),d.value?(r(),l("div",xd,[$[1]||($[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Ad,[s("pre",Od,w(k.value),1)])])):A("",!0)]))}},Dd=se(Md,[["__scopeId","data-v-0a48ca0f"]]),Nd={class:"slashcommand-tool-handler"},Ld={key:0,class:"tool-section"},jd={class:"d-flex align-items-center gap-2"},Id=["aria-label"],Pd={class:"text-muted small"},Rd={key:0,class:"command-content-body"},Wd={class:"command-content-text"},Hd={key:1,class:"tool-section mt-3"},Bd={class:"tool-result tool-result-error"},Fd={class:"tool-code"},Vd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Te(),o=de(),i=P(!1);function a(){i.value=!i.value}const c=v(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const $=t.messagesBySession.get(g)||[],b=$.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let h=null,u=null;for(let y=b+1;y<Math.min(b+3,$.length);y++){const _=$[y];if(_.type!=="user")continue;const C=_.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?h=_:C.includes("ARGUMENTS:")&&(u=_)}return{running:h,content:u}}),m=v(()=>{const g=c.value.content;if(!g)return"";const $=g.content||"",b=/\nARGUMENTS:.*$/s;return $.replace(b,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=v(()=>m.value.length>0),f=v(()=>m.value?m.value.split(`
`).length:0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!d.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,$)=>(r(),l("div",Nd,[p.value?(r(),l("div",Ld,[s("div",{class:"command-content-header",onClick:a},[s("div",jd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},w(i.value?"â–¾":"â–¸"),9,Id),$[0]||($[0]=s("strong",null,"Command Content",-1)),s("span",Pd,"("+w(f.value)+" lines)",1)])]),i.value?(r(),l("div",Rd,[s("pre",Wd,w(m.value),1)])):A("",!0)])):A("",!0),d.value?(r(),l("div",Hd,[$[1]||($[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Bd,[s("pre",Fd,w(k.value),1)])])):A("",!0)]))}},Ud=se(Vd,[["__scopeId","data-v-15991acf"]]),qd={class:"exit-plan-mode-tool-handler"},zd={class:"tool-section"},Kd={key:0,class:"plan-content mt-2"},Gd={class:"plan-text"},Yd={key:0,class:"tool-section"},Jd={key:0},Qd={key:1,class:"text-danger"},Xd={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.plan),o=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(r(),l("div",qd,[s("div",zd,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(r(),l("div",Kd,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",Gd,w(t.value),1)])):A("",!0)]),n.toolCall.result?(r(),l("div",Yd,[a[2]||(a[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:ee(["tool-result",o.value])},[n.toolCall.result.success!==!1?(r(),l("div",Jd," âœ… Permission mode reverted to default ")):(r(),l("div",Qd," â— "+w(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):A("",!0)]))}},Zd=se(Xd,[["__scopeId","data-v-e2e3c781"]]),em={class:"ask-user-question-handler"},tm={key:0,class:"answers-summary"},sm={class:"answer-question text-muted small"},nm={class:"answer-value fw-medium"},om={key:1,class:"text-muted small"},im={key:0,class:"questions-container"},am={class:"question-header d-flex align-items-center gap-2 mb-2"},rm={key:0,class:"badge bg-secondary"},lm={class:"question-text fw-medium"},cm={class:"options-list"},um=["id","checked","onChange"],dm=["id","name","checked","onChange"],mm=["for"],pm={class:"option-label"},fm={key:0,class:"option-description text-muted d-block small"},vm={class:"option-item form-check other-option"},hm=["id","checked","onChange"],_m=["id","name","checked","onChange"],gm=["for"],bm={key:2,class:"other-input mt-2"},ym=["onUpdate:modelValue","onInput"],$m={key:1,class:"alert alert-info mb-0"},wm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=v(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=v(()=>{if(!a.value)return{};const S=o.toolCall.result;if(S?.content){if(typeof S.content=="object"&&S.content.answers)return S.content.answers;if(typeof S.content=="string")try{const L=JSON.parse(S.content);if(L.answers)return L.answers}catch{}}const j=o.toolCall.input||{};return j.answers?j.answers:{}}),m=v(()=>Object.keys(c.value).length>0),p=v(()=>(o.toolCall.input||{}).questions||[]),f=P({}),d=P({});pe(p,S=>{S.forEach((j,L)=>{L in f.value||(f.value[L]=j.multiSelect?[]:null),L in d.value||(d.value[L]="")})},{immediate:!0});function k(S,j){const L=f.value[S];return Array.isArray(L)?L.includes(j):L===j}function g(S){const j=f.value[S];return Array.isArray(j)?j.includes("__OTHER__"):j==="__OTHER__"}function $(S,j){f.value[S]=j,_()}function b(S){f.value[S]="__OTHER__",_()}function h(S,j){const L=f.value[S];if(!Array.isArray(L))f.value[S]=[j];else{const x=L.indexOf(j);x===-1?L.push(j):L.splice(x,1)}_()}function u(S){const j=f.value[S];if(!Array.isArray(j))f.value[S]=["__OTHER__"];else{const L=j.indexOf("__OTHER__");L===-1?j.push("__OTHER__"):j.splice(L,1)}_()}function y(S){_()}function _(){const S={};p.value.forEach((j,L)=>{const x=f.value[L],R=j.question;if(j.multiSelect){if(Array.isArray(x)&&x.length>0){const E=x.map(T=>T==="__OTHER__"?d.value[L]||"":T).filter(T=>T);S[R]=E.join(", ")}}else x==="__OTHER__"?S[R]=d.value[L]||"":x&&(S[R]=x)}),i("answer",S)}const C=v(()=>p.value.every((S,j)=>{const L=f.value[j];if(S.multiSelect){if(!Array.isArray(L)||L.length===0||L.includes("__OTHER__")&&!d.value[j])return!1}else if(!L||L==="__OTHER__"&&!d.value[j])return!1;return!0}));return e({allQuestionsAnswered:C,getAnswers:()=>{const S={};return p.value.forEach((j,L)=>{const x=f.value[L],R=j.question;if(j.multiSelect){if(Array.isArray(x)&&x.length>0){const E=x.map(T=>T==="__OTHER__"?d.value[L]||"":T).filter(T=>T);S[R]=E.join(", ")}}else x==="__OTHER__"?S[R]=d.value[L]||"":x&&(S[R]=x)}),S}}),(S,j)=>(r(),l("div",em,[a.value?(r(),l(ae,{key:0},[m.value?(r(),l("div",tm,[(r(!0),l(ae,null,ce(c.value,(L,x)=>(r(),l("div",{key:x,class:"answer-item mb-2"},[s("div",sm,w(x),1),s("div",nm,w(L),1)]))),128))])):(r(),l("div",om," No answers recorded. "))],64)):(r(),l(ae,{key:1},[p.value.length>0?(r(),l("div",im,[(r(!0),l(ae,null,ce(p.value,(L,x)=>(r(),l("div",{key:x,class:"question-block mb-3"},[s("div",am,[L.header?(r(),l("span",rm,w(L.header),1)):A("",!0),s("span",lm,w(L.question),1)]),s("div",cm,[(r(!0),l(ae,null,ce(L.options,(R,E)=>(r(),l("div",{key:E,class:ee(["option-item form-check",{selected:k(x,R.label)}])},[L.multiSelect?(r(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${x}-opt${E}`,checked:k(x,R.label),onChange:T=>h(x,R.label)},null,40,um)):(r(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${x}-opt${E}`,name:`question-${x}`,checked:k(x,R.label),onChange:T=>$(x,R.label)},null,40,dm)),s("label",{class:"form-check-label",for:`q${x}-opt${E}`},[s("span",pm,w(R.label),1),R.description?(r(),l("span",fm,w(R.description),1)):A("",!0)],8,mm)],2))),128)),s("div",vm,[L.multiSelect?(r(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${x}-other`,checked:g(x),onChange:R=>u(x)},null,40,hm)):(r(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${x}-other`,name:`question-${x}`,checked:g(x),onChange:R=>b(x)},null,40,_m)),s("label",{class:"form-check-label",for:`q${x}-other`},[...j[0]||(j[0]=[s("span",{class:"option-label"},"Other",-1)])],8,gm),g(x)?(r(),l("div",bm,[ge(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":R=>d.value[x]=R,placeholder:"Enter your custom answer...",onInput:R=>y()},null,40,ym),[[We,d.value[x]]])])):A("",!0)])])]))),128))])):(r(),l("div",$m," No questions to display. "))],64))]))}},$n=se(wm,[["__scopeId","data-v-75ce45b4"]]),km={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Sm={class:"tool-status-icon"},Em=["title"],Cm={class:"d-flex align-items-center gap-2"},Tm={class:"text-muted"},xm=["aria-label"],Am={key:0,class:"card-body"},Om={key:0,class:"alert alert-warning mb-3"},Mm={class:"d-flex align-items-center"},Dm={class:"mb-0 small"},Nm={key:2,class:"permission-prompt mt-3"},Lm={class:"question-buttons d-flex gap-2 mt-3"},jm=["disabled"],Im=["disabled"],Pm={class:"alert alert-warning mb-3"},Rm={class:"mb-0"},Wm={class:"tool-name"},Hm={key:0,class:"suggestions-section mb-3"},Bm={class:"alert alert-info mb-0"},Fm={class:"suggestion-details p-2 bg-white rounded"},Vm={class:"permission-buttons d-flex gap-2 mb-3"},Um=["disabled"],qm=["disabled"],zm=["disabled"],Km={class:"guidance-section mt-3"},Gm=["disabled"],Ym=["disabled"],Jm={key:3,class:"mt-3"},Qm={class:"alert alert-warning mb-0"},Xm={class:"d-flex align-items-center"},Zm={class:"mb-0 small"},ep={key:4,class:"tool-section"},tp={class:"alert alert-danger mb-0"},sp={key:0},np={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Te(),o=de(),i=Ze(),a=P(!1),c=P(null),m=P(""),p=P(null),f=P({}),d=v(()=>e.toolCall.name==="AskUserQuestion"),k=v(()=>!d.value||!p.value?!1:p.value.allQuestionsAnswered);function g(O){f.value=O}async function $(){if(!a.value&&p.value){a.value=!0,c.value="submit-answers";try{const O=o.currentSessionId,D=p.value.getAnswers(),z={questions:e.toolCall.input?.questions||[],answers:D};O&&(t.updateToolCall(O,e.toolCall.id,{input:z}),t.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",z)}catch(O){console.error("Failed to submit question answers:",O)}finally{a.value=!1,c.value=null}}}const b=v(()=>e.toolCall.backendStatus==="interrupted"?!0:t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),h=v(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),u=v(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),y=v(()=>{if(e.toolCall.backendStatus){const O=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[O]||O}if(u.value){const O=u.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[O]||O}return e.toolCall.status}),_={Read:Ya,Write:mr,Bash:Er,TodoWrite:Fr,Edit:ul,Grep:gn,Glob:gn,WebFetch:bn,WebSearch:bn,Task:vc,TaskCreate:Mc,TaskUpdate:su,TaskList:_u,TaskGet:Bu,NotebookEdit:id,BashOutput:yn,KillShell:yn,SlashCommand:Ud,Skill:Dd,ExitPlanMode:Zd,AskUserQuestion:$n},C=v(()=>{const O=e.toolCall.name;return _[O]?_[O]:Na}),S=v(()=>{const O=[];if(b.value)return O.push("border-warning"),O.join(" ");switch(y.value){case"pending":O.push("border-secondary");break;case"permission_required":O.push("border-warning");break;case"executing":O.push("border-primary");break;case"completed":x.value||e.toolCall.permissionDecision==="deny"?O.push("border-danger"):O.push("border-success");break;case"error":O.push("border-danger");break}return O.join(" ")}),j=v(()=>{if(b.value)return"â¹ï¸";switch(y.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":x.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),L=v(()=>Ht(e.toolCall.timestamp)),x=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),R=v(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function E(O){if(!O)return"";const D=O.replace(/\\/g,"/").split("/");return D[D.length-1]}function T(O){if(!O)return"";const D=O.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return D?D[1]:O}function F(O,D=200){return O?O.length<=D?O:O.substring(0,D)+"...":""}function U(O){if(!O)return null;if(O.content){const D=O.content.match(/exit code (\d+)/i);if(D)return parseInt(D[1])}return O.error?1:0}function I(O,D){const z=O?O.split(`
`).length:0;return{added:D?D.split(`
`).length:0,removed:z}}const H=v(()=>{const O=e.toolCall.name,D=e.toolCall.input||{},z=e.toolCall.result,Q=y.value;switch(O){case"Bash":case"Shell":case"Command":{const J=T(D.command),Y=F(J,200);if(Q==="completed"&&z){const te=U(z);return`Bash: ${Y} (exit ${te})`}return`Bash: ${Y}`}case"SlashCommand":{const J=F(D.command,200);return Q==="completed"&&z?`SlashCommand: ${J}`:`SlashCommand: ${J}`}case"Edit":{const J=E(D.file_path);if(Q==="completed"&&z&&!z.error){const{added:Y,removed:te}=I(D.old_string,D.new_string);return Y===te?`Edit: ${J} (${Y} lines changed)`:`Edit: ${J} (${Y} lines added, ${te} removed)`}return`Edit: ${J}`}case"Read":{const J=E(D.file_path);if(D.offset!==void 0||D.limit!==void 0){const te=(D.offset||0)+1,fe=D.limit?(D.offset||0)+D.limit:"âˆž";return`Read: ${J} (lines ${te}-${fe})`}return`Read: ${J} (full file)`}case"Write":{const J=E(D.file_path);if(Q==="completed"&&z&&!z.error&&D.content){const Y=D.content.split(`
`).length;return`Write: ${J} (${Y} lines written)`}return`Write: ${J}`}case"Skill":{const J=D.skill||"Unknown";return Q==="completed"&&z?z.error?`Skill: ${J} (error)`:`Skill: ${J} (completed)`:`Skill: ${J}`}case"Task":{const J=D.subagent_type||"general",Y=D.description||"Task";return Q==="completed"&&z?z.error?`Task: (${J}) ${Y} (error)`:`Task: (${J}) ${Y} (completed)`:`Task: (${J}) ${Y}`}case"TodoWrite":{if(D.todos&&Array.isArray(D.todos)){const J=D.todos.filter(fe=>fe.status==="completed").length,Y=D.todos.length,te=D.todos.find(fe=>fe.status==="in_progress");return te?`Todo: Working on "${te.content}"`:`Todo: ${J}/${Y} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const J=D.pattern||"",Y=O==="Grep"?"Grep":"Glob";if(Q==="completed"&&z&&!z.error){let te=0;return z.content&&(te=z.content.split(`
`).filter(G=>G.trim()).length),`${Y}: "${J}" (${te} results)`}return`${Y}: "${J}"`}case"WebFetch":case"WebSearch":{const J=D.url||D.query||"";if(O==="WebSearch"){const te=D.query||"",fe=te.length>50?te.substring(0,50)+"...":te;return Q==="completed"&&z?z.error?`Web: ${fe} (error)`:`Web: ${fe} (success)`:`Web: ${fe}`}let Y="";try{J&&(Y=new URL(J.startsWith("http")?J:`https://${J}`).hostname)}catch{Y=J.length>50?J.substring(0,50)+"...":J}return Q==="completed"&&z?z.error?`Web: ${Y} (error)`:`Web: ${Y} (success)`:`Web: ${Y||J}`}case"NotebookEdit":{const J=E(D.notebook_path),Y=D.cell_number!==void 0?D.cell_number:"?",te=D.edit_mode||"replace";return`NotebookEdit: ${J} cell #${Y} (${te})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${D.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${D.shell_id||"unknown"}`;case"AskUserQuestion":{const Y=(D.questions||[]).length;return Q==="completed"&&z&&!z.error?`AskUserQuestion: ${Y} question(s) answered`:Q==="permission_required"?`AskUserQuestion: ${Y} question(s) awaiting response`:`AskUserQuestion: ${Y} question(s)`}case"TaskCreate":{const J=D.subject||"",Y=J.length>40?J.substring(0,40)+"...":J;return Q==="completed"&&z&&!z.error?`TaskCreate: "${Y}" (created)`:`TaskCreate: "${Y}"`}case"TaskUpdate":{const J=D.taskId||"?",Y=D.status||"";return Y?`TaskUpdate: #${J} -> ${Y}`:`TaskUpdate: #${J}`}case"TaskList":return Q==="completed"&&z&&!z.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const J=D.taskId||"?";return Q==="completed"&&z&&!z.error?`TaskGet: #${J} (retrieved)`:`TaskGet: #${J}`}default:return`${O}: executed`}}),V=v(()=>{const O=e.toolCall.name,D=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(O)?D.command||O:["Edit","Read","Write","NotebookEdit"].includes(O)&&(D.file_path||D.notebook_path)||O});function X(){const O=o.currentSessionId;O&&t.toggleToolExpansion(O,e.toolCall.id)}function M(O){return O.type==="setMode"?`Set permission mode to "${O.mode}"`:O.type==="allow"?`Allow tool: ${O.tool}`:JSON.stringify(O)}async function N(O,D,z=null){if(!a.value){a.value=!0,O==="allow"?c.value=D?"approve-apply":"approve":z?c.value="deny-guidance":c.value="deny";try{const Q=o.currentSessionId;if(Q){const J=D&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(Q,{request_id:e.toolCall.permissionRequestId,decision:O,reasoning:O==="allow"?"User allowed permission":"User denied permission",applied_updates:J})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,O,D,z)}catch(Q){console.error("Failed to send permission response:",Q)}finally{a.value=!1,c.value=null}}}return(O,D)=>(r(),l("div",{class:ee(["tool-call-card card",S.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:X},[s("div",km,[s("span",Sm,w(j.value),1),s("span",{class:"tool-name",title:V.value},w(H.value),9,Em)]),s("div",Cm,[s("small",Tm,w(L.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},w(n.toolCall.isExpanded?"â–¾":"â–¸"),9,xm)])]),n.toolCall.isExpanded?(r(),l("div",Am,[b.value?(r(),l("div",Om,[s("div",Mm,[D[7]||(D[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[D[6]||(D[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Dm,w(h.value?.message||"Session was terminated"),1)])])])):A("",!0),d.value&&y.value==="permission_required"?A("",!0):(r(),be(lo(C.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),y.value==="permission_required"&&!b.value?(r(),l("div",Nm,[d.value?(r(),l(ae,{key:0},[D[8]||(D[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),me($n,{ref_key:"questionHandlerRef",ref:p,toolCall:n.toolCall,onAnswer:g},null,8,["toolCall"]),s("div",Lm,[s("button",{class:"btn btn-primary",onClick:$,disabled:a.value||!k.value},w(a.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,jm),s("button",{class:"btn btn-outline-secondary",onClick:D[0]||(D[0]=z=>N("deny",!1)),disabled:a.value}," Skip Question ",8,Im)])],64)):(r(),l(ae,{key:1},[s("div",Pm,[D[11]||(D[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Rm,[D[9]||(D[9]=ne("Claude wants to use the ",-1)),s("code",Wm,w(n.toolCall.name),1),D[10]||(D[10]=ne(" tool.",-1))])]),R.value?(r(),l("div",Hm,[s("div",Bm,[D[12]||(D[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),D[13]||(D[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Fm,[(r(!0),l(ae,null,ce(n.toolCall.suggestions,(z,Q)=>(r(),l("div",{key:Q,class:"suggestion-item"},[s("code",null,w(M(z)),1)]))),128))]),D[14]||(D[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):A("",!0),s("div",Vm,[R.value?(r(),l("button",{key:0,class:"btn btn-success",onClick:D[1]||(D[1]=z=>N("allow",!0)),disabled:a.value},w(a.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Um)):A("",!0),s("button",{class:ee(["btn",R.value?"btn-outline-success":"btn-success"]),onClick:D[2]||(D[2]=z=>N("allow",!1)),disabled:a.value},w(a.value&&c.value==="approve"?"â³ Submitting...":R.value?"âœ… Approve Only":"âœ… Approve"),11,qm),s("button",{class:"btn btn-danger",onClick:D[3]||(D[3]=z=>N("deny",!1)),disabled:a.value}," ðŸš« "+w(a.value&&c.value==="deny"?"Submitting...":"Deny"),9,zm)]),s("div",Km,[D[15]||(D[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),D[16]||(D[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ge(s("textarea",{"onUpdate:modelValue":D[4]||(D[4]=z=>m.value=z),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Gm),[[We,m.value]]),m.value.trim()?(r(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:D[5]||(D[5]=z=>N("deny",!1,m.value)),disabled:a.value},w(a.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Ym)):A("",!0)])],64))])):A("",!0),y.value==="permission_required"&&b.value?(r(),l("div",Jm,[s("div",Qm,[s("div",Xm,[D[18]||(D[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[D[17]||(D[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Zm,w(h.value?.message||"Session was terminated before permission could be granted"),1)])])])])):A("",!0),n.toolCall.permissionDecision==="deny"?(r(),l("div",ep,[s("div",tp,[D[19]||(D[19]=ne(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(r(),l("span",sp," - "+w(n.toolCall.result.message),1)):A("",!0)])])):A("",!0)])):A("",!0)],2))}},wn=se(np,[["__scopeId","data-v-2377ca10"]]);function kn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function op(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Sn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function ip(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=op(t.command),i=Sn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Sn(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=kn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",a=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${a}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${kn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const ap={key:0,class:"tool-timeline-bar"},rp={class:"timeline-container"},lp=["title","onClick","onKeydown"],cp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=Te(),a=de(),c=v(()=>t.tools.map(($,b)=>({tool:$,originalIndex:b})).sort(($,b)=>{if($.tool.timestamp&&b.tool.timestamp){const h=new Date($.tool.timestamp).getTime(),u=new Date(b.tool.timestamp).getTime();if(h!==u)return h-u}return $.originalIndex-b.originalIndex}).map(({tool:$})=>$));function m($){const b=a.currentSessionId;if(!b)return $.status;const h=i.getBackendToolState(b,$.id);return h?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[h.state]||h.state:i.isToolUseOrphaned(b,$.id)?"orphaned":$.status}function p($){return $.result?.error||$.status==="error"||$.permissionDecision==="deny"}function f($){return m($)==="executing"}function d($){switch(m($)){case"completed":return p($)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function k($){const b=ip($),h=m($),u={completed:p($)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[h]||h;return`${b} [${u}]`}function g($,b){o("segment-click",{tool:$,index:b})}return($,b)=>c.value.length>1?(r(),l("div",ap,[s("div",rp,[(r(!0),l(ae,null,ce(c.value,(h,u)=>(r(),l("div",{key:h.id,class:ee(["timeline-segment",d(h)]),style:{flex:1},title:k(h),onClick:y=>g(h,u),role:"button",tabindex:"0",onKeydown:[Re(y=>g(h,u),["enter"]),Re(_e(y=>g(h,u),["prevent"]),["space"])]},[s("span",{class:ee(["segment-inner",{"executing-pulse":f(h)}])},null,2)],42,lp))),128))])])):A("",!0)}},up=se(cp,[["__scopeId","data-v-26c45a04"]]),dp={class:"tool-footer-container"},mp=["aria-label","onKeydown"],pp={class:"footer-left"},fp={class:"footer-text"},vp={class:"footer-middle"},hp={class:"footer-text"},_p={class:"footer-right"},gp={class:"expand-icon"},bp={key:0,class:"tool-footer-expanded"},yp={key:1,class:"active-tools-area"},$p={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Te(),o=de(),i=P(!1);function a(b){return b.map((h,u)=>({tool:h,originalIndex:u})).sort((h,u)=>{if(h.tool.timestamp&&u.tool.timestamp){const y=new Date(h.tool.timestamp).getTime(),_=new Date(u.tool.timestamp).getTime();if(y!==_)return y-_}return h.originalIndex-u.originalIndex}).map(({tool:h})=>h)}const c=v(()=>{const b=e.tools.filter(h=>h.status==="executing"||h.status==="permission_required");return a(b)}),m=v(()=>{const b=e.tools.filter(h=>h.status!=="executing"&&h.status!=="permission_required");return a(b)}),p=v(()=>{const b=new Map;e.tools.forEach(C=>{const S=b.get(C.name)||0;b.set(C.name,S+1)});const h=Array.from(b.entries()).sort((C,S)=>S[1]-C[1]),u=h.slice(0,5),y=h.length-u.length,_=u.map(([C,S])=>`${C} (${S})`).join(", ");return y>0?`${_}, +${y} more`:_}),f=v(()=>{const b=e.tools.length;let h=0,u=0,y=0;e.tools.forEach(j=>{const L=o.currentSessionId;(L?t.isToolUseOrphaned(L,j.id):!1)?y++:j.status==="completed"&&!j.result?.error&&j.permissionDecision!=="deny"?h++:(j.status==="error"||j.result?.error||j.permissionDecision==="deny")&&u++});let _=[];h>0&&_.push(`${h} âœ…`),u>0&&_.push(`${u} âŒ`),y>0&&_.push(`${y} â¹ï¸`);const C=b===1?"tool":"tools",S=_.length>0?": "+_.join(" "):"";return`${b} ${C}${S}`}),d=v(()=>i.value?"â–²":"â–¼"),k=v(()=>{const b=o.currentSessionId,h=e.tools.some(C=>C.status==="error"||C.result?.error||C.permissionDecision==="deny"),u=e.tools.some(C=>b?t.isToolUseOrphaned(b,C.id):!1),y=c.value.length>0,_=e.tools.every(C=>!(b?t.isToolUseOrphaned(b,C.id):!1)&&C.status==="completed"&&!C.result?.error&&C.permissionDecision!=="deny");return h?"footer-status-error":u?"footer-status-orphaned":y?"footer-status-in-progress":_?"footer-status-success":""});function g(){i.value=!i.value}async function $({tool:b}){const h=o.currentSessionId;if(!h)return;i.value||(i.value=!0,await wt()),t.toggleToolExpansion(h,b.id),await wt();const u=document.querySelector(`[data-tool-id="${b.id}"]`);u&&u.scrollIntoView({behavior:"smooth",block:"nearest"})}return(b,h)=>(r(),l("div",dp,[me(up,{tools:n.tools,onSegmentClick:$},null,8,["tools"]),s("div",{class:ee(["tool-footer-summary",k.value]),onClick:g,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Re(g,["enter"]),Re(_e(g,["prevent"]),["space"])]},[s("div",pp,[s("span",fp,"Used: "+w(p.value),1)]),s("div",vp,[h[0]||(h[0]=s("span",{class:"footer-separator"},"|",-1)),s("span",hp,w(f.value),1)]),s("div",_p,[s("span",gp,w(d.value),1)])],42,mp),i.value?(r(),l("div",bp,[(r(!0),l(ae,null,ce(m.value,u=>(r(),be(wn,{key:u.id,toolCall:u,"data-tool-id":u.id},null,8,["toolCall","data-tool-id"]))),128))])):A("",!0),c.value.length>0?(r(),l("div",yp,[(r(!0),l(ae,null,ce(c.value,u=>(r(),be(wn,{key:u.id,toolCall:u,"data-tool-id":u.id},null,8,["toolCall","data-tool-id"]))),128))])):A("",!0)]))}},wp=se($p,[["__scopeId","data-v-f80c8c6c"]]),kp={class:"message-row message-row-assistant"},Sp=["title"],Ep={class:"message-content-column"},Cp={key:0,class:"thinking-block mb-2"},Tp=["innerHTML"],xp={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Te(),o=de();lt.setOptions({breaks:!0,gfm:!0});const i=v(()=>Ht(e.message.timestamp)),a=v(()=>e.message.metadata?.model||null),c=v(()=>{const b=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${b}`}),m=v(()=>{const b=e.message.content||"";return b.trim().length>0&&b!=="Assistant response"}),p=v(()=>{const b=e.message.content||"";let h=lt.parse(b);return h=h.replace(/\n</g,"<"),h=h.replace(/\n+$/,""),ls.sanitize(h)}),f=v(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),d=v(()=>e.message.metadata?.thinking_content||""),k=v(()=>{const b=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,h=e.attachedTools&&e.attachedTools.length>0;return b||h}),g=v(()=>{const b=e.message.metadata?.tool_uses||[],h=e.attachedTools||[],u=[...b],y=new Set(b.map(_=>_.id));for(const _ of h)y.has(_.id)||u.push(_);return u}),$=v(()=>{const b=o.currentSessionId;if(!b)return[];const h=t.toolCallsBySession.get(b)||[];return g.value.map(u=>{const y=h.find(_=>_.id===u.id);return y||{id:u.id,name:u.name,input:u.input,status:"pending",result:null,timestamp:u.timestamp||e.message.timestamp,isExpanded:!0}})});return(b,h)=>(r(),l("div",kp,[s("div",{class:"message-speaker",title:c.value},[...h[0]||(h[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Sp),s("div",Ep,[f.value?(r(),l("div",Cp,[me(ka,{thinking:d.value},null,8,["thinking"])])):A("",!0),m.value?(r(),l("div",{key:1,class:"message-text",innerHTML:p.value},null,8,Tp)):A("",!0),k.value?(r(),be(wp,{key:2,tools:$.value},null,8,["tools"])):A("",!0)])]))}},Ap=se(xp,[["__scopeId","data-v-2e32f6ef"]]),Op={key:0,class:"message-row message-row-compaction"},Mp=["title"],Dp={class:"message-content-column"},Np={class:"compaction-status-content"},Lp={class:"text-muted ms-auto"},jp={key:1,class:"message-row message-row-system"},Ip=["title"],Pp={class:"message-content-column"},Rp={class:"system-text"},Wp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>Ht(e.message.timestamp)),o=v(()=>`system
${t.value}`),i=v(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,c)=>i.value?(r(),l("div",Op,[s("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Mp),s("div",Dp,[s("div",Np,[c[1]||(c[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Lp,w(t.value),1)])])])):(r(),l("div",jp,[s("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Ip),s("div",Pp,[s("span",Rp,w(n.message.content),1)])]))}},En=se(Wp,[["__scopeId","data-v-a078178f"]]),Hp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>{switch(e.message.type){case"user":return ha;case"assistant":return Ap;case"system":return En;default:return En}});return(o,i)=>(r(),be(lo(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Bp=se(Hp,[["__scopeId","data-v-11dff525"]]);var we="top",xe="bottom",Ae="right",ke="left",cs="auto",Mt=[we,xe,Ae,ke],ct="start",St="end",uo="clippingParents",Ks="viewport",_t="popper",mo="reference",Hs=Mt.reduce(function(n,e){return n.concat([e+"-"+ct,e+"-"+St])},[]),Gs=[].concat(Mt,[cs]).reduce(function(n,e){return n.concat([e,e+"-"+ct,e+"-"+St])},[]),po="beforeRead",fo="read",vo="afterRead",ho="beforeMain",_o="main",go="afterMain",bo="beforeWrite",yo="write",$o="afterWrite",wo=[po,fo,vo,ho,_o,go,bo,yo,$o];function Ue(n){return n?(n.nodeName||"").toLowerCase():null}function Oe(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ut(n){var e=Oe(n).Element;return n instanceof e||n instanceof Element}function De(n){var e=Oe(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Ys(n){if(typeof ShadowRoot>"u")return!1;var e=Oe(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Fp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!De(a)||!Ue(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(c){var m=i[c];m===!1?a.removeAttribute(c):a.setAttribute(c,m===!0?"":m)}))})}function Vp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),m=c.reduce(function(p,f){return p[f]="",p},{});!De(i)||!Ue(i)||(Object.assign(i.style,m),Object.keys(a).forEach(function(p){i.removeAttribute(p)}))})}}const ko={name:"applyStyles",enabled:!0,phase:"write",fn:Fp,effect:Vp,requires:["computeStyles"]};function Fe(n){return n.split("-")[0]}var rt=Math.max,os=Math.min,Et=Math.round;function Bs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function So(){return!/^((?!chrome|android).)*safari/i.test(Bs())}function Ct(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&De(n)&&(i=n.offsetWidth>0&&Et(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&Et(o.height)/n.offsetHeight||1);var c=ut(n)?Oe(n):window,m=c.visualViewport,p=!So()&&t,f=(o.left+(p&&m?m.offsetLeft:0))/i,d=(o.top+(p&&m?m.offsetTop:0))/a,k=o.width/i,g=o.height/a;return{width:k,height:g,top:d,right:f+k,bottom:d+g,left:f,x:f,y:d}}function Js(n){var e=Ct(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function Eo(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Ys(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ke(n){return Oe(n).getComputedStyle(n)}function Up(n){return["table","td","th"].indexOf(Ue(n))>=0}function et(n){return((ut(n)?n.ownerDocument:n.document)||window.document).documentElement}function us(n){return Ue(n)==="html"?n:n.assignedSlot||n.parentNode||(Ys(n)?n.host:null)||et(n)}function Cn(n){return!De(n)||Ke(n).position==="fixed"?null:n.offsetParent}function qp(n){var e=/firefox/i.test(Bs()),t=/Trident/i.test(Bs());if(t&&De(n)){var o=Ke(n);if(o.position==="fixed")return null}var i=us(n);for(Ys(i)&&(i=i.host);De(i)&&["html","body"].indexOf(Ue(i))<0;){var a=Ke(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Bt(n){for(var e=Oe(n),t=Cn(n);t&&Up(t)&&Ke(t).position==="static";)t=Cn(t);return t&&(Ue(t)==="html"||Ue(t)==="body"&&Ke(t).position==="static")?e:t||qp(n)||e}function Qs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Pt(n,e,t){return rt(n,os(e,t))}function zp(n,e,t){var o=Pt(n,e,t);return o>t?t:o}function Co(){return{top:0,right:0,bottom:0,left:0}}function To(n){return Object.assign({},Co(),n)}function xo(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Kp=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,To(typeof e!="number"?e:xo(e,Mt))};function Gp(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,c=t.modifiersData.popperOffsets,m=Fe(t.placement),p=Qs(m),f=[ke,Ae].indexOf(m)>=0,d=f?"height":"width";if(!(!a||!c)){var k=Kp(i.padding,t),g=Js(a),$=p==="y"?we:ke,b=p==="y"?xe:Ae,h=t.rects.reference[d]+t.rects.reference[p]-c[p]-t.rects.popper[d],u=c[p]-t.rects.reference[p],y=Bt(a),_=y?p==="y"?y.clientHeight||0:y.clientWidth||0:0,C=h/2-u/2,S=k[$],j=_-g[d]-k[b],L=_/2-g[d]/2+C,x=Pt(S,L,j),R=p;t.modifiersData[o]=(e={},e[R]=x,e.centerOffset=x-L,e)}}function Yp(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Eo(e.elements.popper,i)&&(e.elements.arrow=i))}const Ao={name:"arrow",enabled:!0,phase:"main",fn:Gp,effect:Yp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Tt(n){return n.split("-")[1]}var Jp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qp(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Et(t*i)/i||0,y:Et(o*i)/i||0}}function Tn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,c=n.offsets,m=n.position,p=n.gpuAcceleration,f=n.adaptive,d=n.roundOffsets,k=n.isFixed,g=c.x,$=g===void 0?0:g,b=c.y,h=b===void 0?0:b,u=typeof d=="function"?d({x:$,y:h}):{x:$,y:h};$=u.x,h=u.y;var y=c.hasOwnProperty("x"),_=c.hasOwnProperty("y"),C=ke,S=we,j=window;if(f){var L=Bt(t),x="clientHeight",R="clientWidth";if(L===Oe(t)&&(L=et(t),Ke(L).position!=="static"&&m==="absolute"&&(x="scrollHeight",R="scrollWidth")),L=L,i===we||(i===ke||i===Ae)&&a===St){S=xe;var E=k&&L===j&&j.visualViewport?j.visualViewport.height:L[x];h-=E-o.height,h*=p?1:-1}if(i===ke||(i===we||i===xe)&&a===St){C=Ae;var T=k&&L===j&&j.visualViewport?j.visualViewport.width:L[R];$-=T-o.width,$*=p?1:-1}}var F=Object.assign({position:m},f&&Jp),U=d===!0?Qp({x:$,y:h},Oe(t)):{x:$,y:h};if($=U.x,h=U.y,p){var I;return Object.assign({},F,(I={},I[S]=_?"0":"",I[C]=y?"0":"",I.transform=(j.devicePixelRatio||1)<=1?"translate("+$+"px, "+h+"px)":"translate3d("+$+"px, "+h+"px, 0)",I))}return Object.assign({},F,(e={},e[S]=_?h+"px":"",e[C]=y?$+"px":"",e.transform="",e))}function Xp(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,c=a===void 0?!0:a,m=t.roundOffsets,p=m===void 0?!0:m,f={placement:Fe(e.placement),variation:Tt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Tn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Tn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Oo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Xp,data:{}};var Kt={passive:!0};function Zp(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,c=o.resize,m=c===void 0?!0:c,p=Oe(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&f.forEach(function(d){d.addEventListener("scroll",t.update,Kt)}),m&&p.addEventListener("resize",t.update,Kt),function(){a&&f.forEach(function(d){d.removeEventListener("scroll",t.update,Kt)}),m&&p.removeEventListener("resize",t.update,Kt)}}const Mo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Zp,data:{}};var ef={left:"right",right:"left",bottom:"top",top:"bottom"};function es(n){return n.replace(/left|right|bottom|top/g,function(e){return ef[e]})}var tf={start:"end",end:"start"};function xn(n){return n.replace(/start|end/g,function(e){return tf[e]})}function Xs(n){var e=Oe(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Zs(n){return Ct(et(n)).left+Xs(n).scrollLeft}function sf(n,e){var t=Oe(n),o=et(n),i=t.visualViewport,a=o.clientWidth,c=o.clientHeight,m=0,p=0;if(i){a=i.width,c=i.height;var f=So();(f||!f&&e==="fixed")&&(m=i.offsetLeft,p=i.offsetTop)}return{width:a,height:c,x:m+Zs(n),y:p}}function nf(n){var e,t=et(n),o=Xs(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=rt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=rt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),m=-o.scrollLeft+Zs(n),p=-o.scrollTop;return Ke(i||t).direction==="rtl"&&(m+=rt(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:c,x:m,y:p}}function en(n){var e=Ke(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Do(n){return["html","body","#document"].indexOf(Ue(n))>=0?n.ownerDocument.body:De(n)&&en(n)?n:Do(us(n))}function Rt(n,e){var t;e===void 0&&(e=[]);var o=Do(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=Oe(o),c=i?[a].concat(a.visualViewport||[],en(o)?o:[]):o,m=e.concat(c);return i?m:m.concat(Rt(us(c)))}function Fs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function of(n,e){var t=Ct(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function An(n,e,t){return e===Ks?Fs(sf(n,t)):ut(e)?of(e,t):Fs(nf(et(n)))}function af(n){var e=Rt(us(n)),t=["absolute","fixed"].indexOf(Ke(n).position)>=0,o=t&&De(n)?Bt(n):n;return ut(o)?e.filter(function(i){return ut(i)&&Eo(i,o)&&Ue(i)!=="body"}):[]}function rf(n,e,t,o){var i=e==="clippingParents"?af(n):[].concat(e),a=[].concat(i,[t]),c=a[0],m=a.reduce(function(p,f){var d=An(n,f,o);return p.top=rt(d.top,p.top),p.right=os(d.right,p.right),p.bottom=os(d.bottom,p.bottom),p.left=rt(d.left,p.left),p},An(n,c,o));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m}function No(n){var e=n.reference,t=n.element,o=n.placement,i=o?Fe(o):null,a=o?Tt(o):null,c=e.x+e.width/2-t.width/2,m=e.y+e.height/2-t.height/2,p;switch(i){case we:p={x:c,y:e.y-t.height};break;case xe:p={x:c,y:e.y+e.height};break;case Ae:p={x:e.x+e.width,y:m};break;case ke:p={x:e.x-t.width,y:m};break;default:p={x:e.x,y:e.y}}var f=i?Qs(i):null;if(f!=null){var d=f==="y"?"height":"width";switch(a){case ct:p[f]=p[f]-(e[d]/2-t[d]/2);break;case St:p[f]=p[f]+(e[d]/2-t[d]/2);break}}return p}function xt(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,c=a===void 0?n.strategy:a,m=t.boundary,p=m===void 0?uo:m,f=t.rootBoundary,d=f===void 0?Ks:f,k=t.elementContext,g=k===void 0?_t:k,$=t.altBoundary,b=$===void 0?!1:$,h=t.padding,u=h===void 0?0:h,y=To(typeof u!="number"?u:xo(u,Mt)),_=g===_t?mo:_t,C=n.rects.popper,S=n.elements[b?_:g],j=rf(ut(S)?S:S.contextElement||et(n.elements.popper),p,d,c),L=Ct(n.elements.reference),x=No({reference:L,element:C,placement:i}),R=Fs(Object.assign({},C,x)),E=g===_t?R:L,T={top:j.top-E.top+y.top,bottom:E.bottom-j.bottom+y.bottom,left:j.left-E.left+y.left,right:E.right-j.right+y.right},F=n.modifiersData.offset;if(g===_t&&F){var U=F[i];Object.keys(T).forEach(function(I){var H=[Ae,xe].indexOf(I)>=0?1:-1,V=[we,xe].indexOf(I)>=0?"y":"x";T[I]+=U[V]*H})}return T}function lf(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,c=t.padding,m=t.flipVariations,p=t.allowedAutoPlacements,f=p===void 0?Gs:p,d=Tt(o),k=d?m?Hs:Hs.filter(function(b){return Tt(b)===d}):Mt,g=k.filter(function(b){return f.indexOf(b)>=0});g.length===0&&(g=k);var $=g.reduce(function(b,h){return b[h]=xt(n,{placement:h,boundary:i,rootBoundary:a,padding:c})[Fe(h)],b},{});return Object.keys($).sort(function(b,h){return $[b]-$[h]})}function cf(n){if(Fe(n)===cs)return[];var e=es(n);return[xn(n),e,xn(e)]}function uf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,c=t.altAxis,m=c===void 0?!0:c,p=t.fallbackPlacements,f=t.padding,d=t.boundary,k=t.rootBoundary,g=t.altBoundary,$=t.flipVariations,b=$===void 0?!0:$,h=t.allowedAutoPlacements,u=e.options.placement,y=Fe(u),_=y===u,C=p||(_||!b?[es(u)]:cf(u)),S=[u].concat(C).reduce(function(Y,te){return Y.concat(Fe(te)===cs?lf(e,{placement:te,boundary:d,rootBoundary:k,padding:f,flipVariations:b,allowedAutoPlacements:h}):te)},[]),j=e.rects.reference,L=e.rects.popper,x=new Map,R=!0,E=S[0],T=0;T<S.length;T++){var F=S[T],U=Fe(F),I=Tt(F)===ct,H=[we,xe].indexOf(U)>=0,V=H?"width":"height",X=xt(e,{placement:F,boundary:d,rootBoundary:k,altBoundary:g,padding:f}),M=H?I?Ae:ke:I?xe:we;j[V]>L[V]&&(M=es(M));var N=es(M),O=[];if(a&&O.push(X[U]<=0),m&&O.push(X[M]<=0,X[N]<=0),O.every(function(Y){return Y})){E=F,R=!1;break}x.set(F,O)}if(R)for(var D=b?3:1,z=function(te){var fe=S.find(function(G){var W=x.get(G);if(W)return W.slice(0,te).every(function(B){return B})});if(fe)return E=fe,"break"},Q=D;Q>0;Q--){var J=z(Q);if(J==="break")break}e.placement!==E&&(e.modifiersData[o]._skip=!0,e.placement=E,e.reset=!0)}}const Lo={name:"flip",enabled:!0,phase:"main",fn:uf,requiresIfExists:["offset"],data:{_skip:!1}};function On(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Mn(n){return[we,Ae,xe,ke].some(function(e){return n[e]>=0})}function df(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,c=xt(e,{elementContext:"reference"}),m=xt(e,{altBoundary:!0}),p=On(c,o),f=On(m,i,a),d=Mn(p),k=Mn(f);e.modifiersData[t]={referenceClippingOffsets:p,popperEscapeOffsets:f,isReferenceHidden:d,hasPopperEscaped:k},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":k})}const jo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:df};function mf(n,e,t){var o=Fe(n),i=[ke,we].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,c=a[0],m=a[1];return c=c||0,m=(m||0)*i,[ke,Ae].indexOf(o)>=0?{x:m,y:c}:{x:c,y:m}}function pf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,c=Gs.reduce(function(d,k){return d[k]=mf(k,e.rects,a),d},{}),m=c[e.placement],p=m.x,f=m.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=c}const Io={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:pf};function ff(n){var e=n.state,t=n.name;e.modifiersData[t]=No({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Po={name:"popperOffsets",enabled:!0,phase:"read",fn:ff,data:{}};function vf(n){return n==="x"?"y":"x"}function hf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,c=t.altAxis,m=c===void 0?!1:c,p=t.boundary,f=t.rootBoundary,d=t.altBoundary,k=t.padding,g=t.tether,$=g===void 0?!0:g,b=t.tetherOffset,h=b===void 0?0:b,u=xt(e,{boundary:p,rootBoundary:f,padding:k,altBoundary:d}),y=Fe(e.placement),_=Tt(e.placement),C=!_,S=Qs(y),j=vf(S),L=e.modifiersData.popperOffsets,x=e.rects.reference,R=e.rects.popper,E=typeof h=="function"?h(Object.assign({},e.rects,{placement:e.placement})):h,T=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),F=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,U={x:0,y:0};if(L){if(a){var I,H=S==="y"?we:ke,V=S==="y"?xe:Ae,X=S==="y"?"height":"width",M=L[S],N=M+u[H],O=M-u[V],D=$?-R[X]/2:0,z=_===ct?x[X]:R[X],Q=_===ct?-R[X]:-x[X],J=e.elements.arrow,Y=$&&J?Js(J):{width:0,height:0},te=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Co(),fe=te[H],G=te[V],W=Pt(0,x[X],Y[X]),B=C?x[X]/2-D-W-fe-T.mainAxis:z-W-fe-T.mainAxis,Z=C?-x[X]/2+D+W+G+T.mainAxis:Q+W+G+T.mainAxis,ie=e.elements.arrow&&Bt(e.elements.arrow),he=ie?S==="y"?ie.clientTop||0:ie.clientLeft||0:0,nt=(I=F?.[S])!=null?I:0,Be=M+B-nt-he,q=M+Z-nt,re=Pt($?os(N,Be):N,M,$?rt(O,q):O);L[S]=re,U[S]=re-M}if(m){var le,Ce=S==="x"?we:ke,Pe=S==="x"?xe:Ae,$e=L[j],zt=j==="y"?"height":"width",cn=$e+u[Ce],un=$e-u[Pe],_s=[we,ke].indexOf(y)!==-1,dn=(le=F?.[j])!=null?le:0,mn=_s?cn:$e-x[zt]-R[zt]-dn+T.altAxis,pn=_s?$e+x[zt]+R[zt]-dn-T.altAxis:un,fn=$&&_s?zp(mn,$e,pn):Pt($?mn:cn,$e,$?pn:un);L[j]=fn,U[j]=fn-$e}e.modifiersData[o]=U}}const Ro={name:"preventOverflow",enabled:!0,phase:"main",fn:hf,requiresIfExists:["offset"]};function _f(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function gf(n){return n===Oe(n)||!De(n)?Xs(n):_f(n)}function bf(n){var e=n.getBoundingClientRect(),t=Et(e.width)/n.offsetWidth||1,o=Et(e.height)/n.offsetHeight||1;return t!==1||o!==1}function yf(n,e,t){t===void 0&&(t=!1);var o=De(e),i=De(e)&&bf(e),a=et(e),c=Ct(n,i,t),m={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!t)&&((Ue(e)!=="body"||en(a))&&(m=gf(e)),De(e)?(p=Ct(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):a&&(p.x=Zs(a))),{x:c.left+m.scrollLeft-p.x,y:c.top+m.scrollTop-p.y,width:c.width,height:c.height}}function $f(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var c=[].concat(a.requires||[],a.requiresIfExists||[]);c.forEach(function(m){if(!t.has(m)){var p=e.get(m);p&&i(p)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function wf(n){var e=$f(n);return wo.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function kf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Sf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var Dn={placement:"bottom",modifiers:[],strategy:"absolute"};function Nn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Wo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?Dn:i;return function(m,p,f){f===void 0&&(f=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Dn,a),modifiersData:{},elements:{reference:m,popper:p},attributes:{},styles:{}},k=[],g=!1,$={state:d,setOptions:function(y){var _=typeof y=="function"?y(d.options):y;h(),d.options=Object.assign({},a,d.options,_),d.scrollParents={reference:ut(m)?Rt(m):m.contextElement?Rt(m.contextElement):[],popper:Rt(p)};var C=wf(Sf([].concat(o,d.options.modifiers)));return d.orderedModifiers=C.filter(function(S){return S.enabled}),b(),$.update()},forceUpdate:function(){if(!g){var y=d.elements,_=y.reference,C=y.popper;if(Nn(_,C)){d.rects={reference:yf(_,Bt(C),d.options.strategy==="fixed"),popper:Js(C)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(T){return d.modifiersData[T.name]=Object.assign({},T.data)});for(var S=0;S<d.orderedModifiers.length;S++){if(d.reset===!0){d.reset=!1,S=-1;continue}var j=d.orderedModifiers[S],L=j.fn,x=j.options,R=x===void 0?{}:x,E=j.name;typeof L=="function"&&(d=L({state:d,options:R,name:E,instance:$})||d)}}}},update:kf(function(){return new Promise(function(u){$.forceUpdate(),u(d)})}),destroy:function(){h(),g=!0}};if(!Nn(m,p))return $;$.setOptions(f).then(function(u){!g&&f.onFirstUpdate&&f.onFirstUpdate(u)});function b(){d.orderedModifiers.forEach(function(u){var y=u.name,_=u.options,C=_===void 0?{}:_,S=u.effect;if(typeof S=="function"){var j=S({state:d,name:y,instance:$,options:C}),L=function(){};k.push(j||L)}})}function h(){k.forEach(function(u){return u()}),k=[]}return $}}var Ef=[Mo,Po,Oo,ko,Io,Lo,Ro,Ao,jo],tn=Wo({defaultModifiers:Ef});const Ho=Object.freeze(Object.defineProperty({__proto__:null,afterMain:go,afterRead:vo,afterWrite:$o,applyStyles:ko,arrow:Ao,auto:cs,basePlacements:Mt,beforeMain:ho,beforeRead:po,beforeWrite:bo,bottom:xe,clippingParents:uo,computeStyles:Oo,createPopper:tn,detectOverflow:xt,end:St,eventListeners:Mo,flip:Lo,hide:jo,left:ke,main:_o,modifierPhases:wo,offset:Io,placements:Gs,popper:_t,popperGenerator:Wo,popperOffsets:Po,preventOverflow:Ro,read:fo,reference:mo,right:Ae,start:ct,top:we,variationPlacements:Hs,viewport:Ks,write:yo},Symbol.toStringTag,{value:"Module"}));const Ye=new Map,Ss={set(n,e,t){Ye.has(n)||Ye.set(n,new Map);const o=Ye.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Ye.has(n)&&Ye.get(n).get(e)||null},remove(n,e){if(!Ye.has(n))return;const t=Ye.get(n);t.delete(e),t.size===0&&Ye.delete(n)}},Cf=1e6,Tf=1e3,Vs="transitionend",Bo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),xf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Af=n=>{do n+=Math.floor(Math.random()*Cf);while(document.getElementById(n));return n},Of=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Tf)},Fo=n=>{n.dispatchEvent(new Event(Vs))},qe=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Je=n=>qe(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Bo(n)):null,Dt=n=>{if(!qe(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Qe=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Vo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Vo(n.parentNode):null},is=()=>{},Ft=n=>{n.offsetHeight},Uo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Es=[],Mf=n=>{document.readyState==="loading"?(Es.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Es)e()}),Es.push(n)):n()},Ne=()=>document.documentElement.dir==="rtl",Ie=n=>{Mf(()=>{const e=Uo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},Se=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,qo=(n,e,t=!0)=>{if(!t){Se(n);return}const i=Of(e)+5;let a=!1;const c=({target:m})=>{m===e&&(a=!0,e.removeEventListener(Vs,c),Se(n))};e.addEventListener(Vs,c),setTimeout(()=>{a||Fo(e)},i)},sn=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},Df=/[^.]*(?=\..*)\.|.*/,Nf=/\..*/,Lf=/::\d+$/,Cs={};let Ln=1;const zo={mouseenter:"mouseover",mouseleave:"mouseout"},jf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ko(n,e){return e&&`${e}::${Ln++}`||n.uidEvent||Ln++}function Go(n){const e=Ko(n);return n.uidEvent=e,Cs[e]=Cs[e]||{},Cs[e]}function If(n,e){return function t(o){return nn(o,{delegateTarget:n}),t.oneOff&&K.off(n,o.type,e),e.apply(n,[o])}}function Pf(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:c}=i;c&&c!==this;c=c.parentNode)for(const m of a)if(m===c)return nn(i,{delegateTarget:c}),o.oneOff&&K.off(n,i.type,e,t),t.apply(c,[i])}}function Yo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Jo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Qo(n);return jf.has(a)||(a=n),[o,i,a]}function jn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,c,m]=Jo(e,t,o);e in zo&&(c=(b=>function(h){if(!h.relatedTarget||h.relatedTarget!==h.delegateTarget&&!h.delegateTarget.contains(h.relatedTarget))return b.call(this,h)})(c));const p=Go(n),f=p[m]||(p[m]={}),d=Yo(f,c,a?t:null);if(d){d.oneOff=d.oneOff&&i;return}const k=Ko(c,e.replace(Df,"")),g=a?Pf(n,t,c):If(n,c);g.delegationSelector=a?t:null,g.callable=c,g.oneOff=i,g.uidEvent=k,f[k]=g,n.addEventListener(m,g,a)}function Us(n,e,t,o,i){const a=Yo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function Rf(n,e,t,o){const i=e[t]||{};for(const[a,c]of Object.entries(i))a.includes(o)&&Us(n,e,t,c.callable,c.delegationSelector)}function Qo(n){return n=n.replace(Nf,""),zo[n]||n}const K={on(n,e,t,o){jn(n,e,t,o,!1)},one(n,e,t,o){jn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,c]=Jo(e,t,o),m=c!==e,p=Go(n),f=p[c]||{},d=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(f).length)return;Us(n,p,c,a,i?t:null);return}if(d)for(const k of Object.keys(p))Rf(n,p,k,e.slice(1));for(const[k,g]of Object.entries(f)){const $=k.replace(Lf,"");(!m||e.includes($))&&Us(n,p,c,g.callable,g.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Uo(),i=Qo(e),a=e!==i;let c=null,m=!0,p=!0,f=!1;a&&o&&(c=o.Event(e,t),o(n).trigger(c),m=!c.isPropagationStopped(),p=!c.isImmediatePropagationStopped(),f=c.isDefaultPrevented());const d=nn(new Event(e,{bubbles:m,cancelable:!0}),t);return f&&d.preventDefault(),p&&n.dispatchEvent(d),d.defaultPrevented&&c&&c.preventDefault(),d}};function nn(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function In(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Ts(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const ze={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${Ts(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Ts(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=In(n.dataset[o])}return e},getDataAttribute(n,e){return In(n.getAttribute(`data-bs-${Ts(e)}`))}};class Vt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=qe(t)?ze.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...qe(t)?ze.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],c=qe(a)?"element":xf(a);if(!new RegExp(i).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${i}".`)}}}const Wf="5.3.8";class He extends Vt{constructor(e,t){super(),e=Je(e),e&&(this._element=e,this._config=this._getConfig(t),Ss.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Ss.remove(this._element,this.constructor.DATA_KEY),K.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){qo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Ss.get(Je(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Wf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const xs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Bo(t)).join(","):null},oe={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Qe(t)&&Dt(t))},getSelectorFromElement(n){const e=xs(n);return e&&oe.findOne(e)?e:null},getElementFromSelector(n){const e=xs(n);return e?oe.findOne(e):null},getMultipleElementsFromSelector(n){const e=xs(n);return e?oe.find(e):[]}},ds=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;K.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Qe(this))return;const a=oe.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},Hf="alert",Bf="bs.alert",Xo=`.${Bf}`,Ff=`close${Xo}`,Vf=`closed${Xo}`,Uf="fade",qf="show";class ms extends He{static get NAME(){return Hf}close(){if(K.trigger(this._element,Ff).defaultPrevented)return;this._element.classList.remove(qf);const t=this._element.classList.contains(Uf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),K.trigger(this._element,Vf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ms.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ds(ms,"close");Ie(ms);const zf="button",Kf="bs.button",Gf=`.${Kf}`,Yf=".data-api",Jf="active",Pn='[data-bs-toggle="button"]',Qf=`click${Gf}${Yf}`;class ps extends He{static get NAME(){return zf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Jf))}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}K.on(document,Qf,Pn,n=>{n.preventDefault();const e=n.target.closest(Pn);ps.getOrCreateInstance(e).toggle()});Ie(ps);const Xf="swipe",Nt=".bs.swipe",Zf=`touchstart${Nt}`,ev=`touchmove${Nt}`,tv=`touchend${Nt}`,sv=`pointerdown${Nt}`,nv=`pointerup${Nt}`,ov="touch",iv="pen",av="pointer-event",rv=40,lv={endCallback:null,leftCallback:null,rightCallback:null},cv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class as extends Vt{constructor(e,t){super(),this._element=e,!(!e||!as.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return lv}static get DefaultType(){return cv}static get NAME(){return Xf}dispose(){K.off(this._element,Nt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Se(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=rv)return;const t=e/this._deltaX;this._deltaX=0,t&&Se(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(K.on(this._element,sv,e=>this._start(e)),K.on(this._element,nv,e=>this._end(e)),this._element.classList.add(av)):(K.on(this._element,Zf,e=>this._start(e)),K.on(this._element,ev,e=>this._move(e)),K.on(this._element,tv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===iv||e.pointerType===ov)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const uv="carousel",dv="bs.carousel",tt=`.${dv}`,Zo=".data-api",mv="ArrowLeft",pv="ArrowRight",fv=500,jt="next",vt="prev",gt="left",ts="right",vv=`slide${tt}`,As=`slid${tt}`,hv=`keydown${tt}`,_v=`mouseenter${tt}`,gv=`mouseleave${tt}`,bv=`dragstart${tt}`,yv=`load${tt}${Zo}`,$v=`click${tt}${Zo}`,ei="carousel",Gt="active",wv="slide",kv="carousel-item-end",Sv="carousel-item-start",Ev="carousel-item-next",Cv="carousel-item-prev",ti=".active",si=".carousel-item",Tv=ti+si,xv=".carousel-item img",Av=".carousel-indicators",Ov="[data-bs-slide], [data-bs-slide-to]",Mv='[data-bs-ride="carousel"]',Dv={[mv]:ts,[pv]:gt},Nv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Lv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ut extends He{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=oe.findOne(Av,this._element),this._addEventListeners(),this._config.ride===ei&&this.cycle()}static get Default(){return Nv}static get DefaultType(){return Lv}static get NAME(){return uv}next(){this._slide(jt)}nextWhenVisible(){!document.hidden&&Dt(this._element)&&this.next()}prev(){this._slide(vt)}pause(){this._isSliding&&Fo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){K.one(this._element,As,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){K.one(this._element,As,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?jt:vt;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&K.on(this._element,hv,e=>this._keydown(e)),this._config.pause==="hover"&&(K.on(this._element,_v,()=>this.pause()),K.on(this._element,gv,()=>this._maybeEnableCycle())),this._config.touch&&as.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of oe.find(xv,this._element))K.on(o,bv,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(gt)),rightCallback:()=>this._slide(this._directionToOrder(ts)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),fv+this._config.interval))}};this._swipeHelper=new as(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Dv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=oe.findOne(ti,this._indicatorsElement);t.classList.remove(Gt),t.removeAttribute("aria-current");const o=oe.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Gt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===jt,a=t||sn(this._getItems(),o,i,this._config.wrap);if(a===o)return;const c=this._getItemIndex(a),m=$=>K.trigger(this._element,$,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(m(vv).defaultPrevented||!o||!a)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=a;const d=i?Sv:kv,k=i?Ev:Cv;a.classList.add(k),Ft(a),o.classList.add(d),a.classList.add(d);const g=()=>{a.classList.remove(d,k),a.classList.add(Gt),o.classList.remove(Gt,k,d),this._isSliding=!1,m(As)};this._queueCallback(g,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(wv)}_getActive(){return oe.findOne(Tv,this._element)}_getItems(){return oe.find(si,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ne()?e===gt?vt:jt:e===gt?jt:vt}_orderToDirection(e){return Ne()?e===vt?gt:ts:e===vt?ts:gt}static jQueryInterface(e){return this.each(function(){const t=Ut.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}K.on(document,$v,Ov,function(n){const e=oe.getElementFromSelector(this);if(!e||!e.classList.contains(ei))return;n.preventDefault();const t=Ut.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(ze.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});K.on(window,yv,()=>{const n=oe.find(Mv);for(const e of n)Ut.getOrCreateInstance(e)});Ie(Ut);const jv="collapse",Iv="bs.collapse",qt=`.${Iv}`,Pv=".data-api",Rv=`show${qt}`,Wv=`shown${qt}`,Hv=`hide${qt}`,Bv=`hidden${qt}`,Fv=`click${qt}${Pv}`,Os="show",yt="collapse",Yt="collapsing",Vv="collapsed",Uv=`:scope .${yt} .${yt}`,qv="collapse-horizontal",zv="width",Kv="height",Gv=".collapse.show, .collapse.collapsing",qs='[data-bs-toggle="collapse"]',Yv={parent:null,toggle:!0},Jv={parent:"(null|element)",toggle:"boolean"};class At extends He{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=oe.find(qs);for(const i of o){const a=oe.getSelectorFromElement(i),c=oe.find(a).filter(m=>m===this._element);a!==null&&c.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Yv}static get DefaultType(){return Jv}static get NAME(){return jv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Gv).filter(m=>m!==this._element).map(m=>At.getOrCreateInstance(m,{toggle:!1}))),e.length&&e[0]._isTransitioning||K.trigger(this._element,Rv).defaultPrevented)return;for(const m of e)m.hide();const o=this._getDimension();this._element.classList.remove(yt),this._element.classList.add(Yt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Yt),this._element.classList.add(yt,Os),this._element.style[o]="",K.trigger(this._element,Wv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||K.trigger(this._element,Hv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ft(this._element),this._element.classList.add(Yt),this._element.classList.remove(yt,Os);for(const i of this._triggerArray){const a=oe.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Yt),this._element.classList.add(yt),K.trigger(this._element,Bv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Os)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Je(e.parent),e}_getDimension(){return this._element.classList.contains(qv)?zv:Kv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(qs);for(const t of e){const o=oe.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=oe.find(Uv,this._config.parent);return oe.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(Vv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=At.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}K.on(document,Fv,qs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of oe.getMultipleElementsFromSelector(this))At.getOrCreateInstance(e,{toggle:!1}).toggle()});Ie(At);const Rn="dropdown",Qv="bs.dropdown",pt=`.${Qv}`,on=".data-api",Xv="Escape",Wn="Tab",Zv="ArrowUp",Hn="ArrowDown",eh=2,th=`hide${pt}`,sh=`hidden${pt}`,nh=`show${pt}`,oh=`shown${pt}`,ni=`click${pt}${on}`,oi=`keydown${pt}${on}`,ih=`keyup${pt}${on}`,bt="show",ah="dropup",rh="dropend",lh="dropstart",ch="dropup-center",uh="dropdown-center",ot='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',dh=`${ot}.${bt}`,ss=".dropdown-menu",mh=".navbar",ph=".navbar-nav",fh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",vh=Ne()?"top-end":"top-start",hh=Ne()?"top-start":"top-end",_h=Ne()?"bottom-end":"bottom-start",gh=Ne()?"bottom-start":"bottom-end",bh=Ne()?"left-start":"right-start",yh=Ne()?"right-start":"left-start",$h="top",wh="bottom",kh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Sh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ve extends He{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=oe.next(this._element,ss)[0]||oe.prev(this._element,ss)[0]||oe.findOne(ss,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return kh}static get DefaultType(){return Sh}static get NAME(){return Rn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Qe(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!K.trigger(this._element,nh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(ph))for(const o of[].concat(...document.body.children))K.on(o,"mouseover",is);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(bt),this._element.classList.add(bt),K.trigger(this._element,oh,e)}}hide(){if(Qe(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!K.trigger(this._element,th,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))K.off(o,"mouseover",is);this._popper&&this._popper.destroy(),this._menu.classList.remove(bt),this._element.classList.remove(bt),this._element.setAttribute("aria-expanded","false"),ze.removeDataAttribute(this._menu,"popper"),K.trigger(this._element,sh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!qe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Rn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ho>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:qe(this._config.reference)?e=Je(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=tn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(bt)}_getPlacement(){const e=this._parent;if(e.classList.contains(rh))return bh;if(e.classList.contains(lh))return yh;if(e.classList.contains(ch))return $h;if(e.classList.contains(uh))return wh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ah)?t?hh:vh:t?gh:_h}_detectNavbar(){return this._element.closest(mh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ze.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Se(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=oe.find(fh,this._menu).filter(i=>Dt(i));o.length&&sn(o,t,e===Hn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ve.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===eh||e.type==="keyup"&&e.key!==Wn)return;const t=oe.find(dh);for(const o of t){const i=Ve.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),c=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!c||i._config.autoClose==="outside"&&c||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Wn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const m={relatedTarget:i._element};e.type==="click"&&(m.clickEvent=e),i._completeHide(m)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===Xv,i=[Zv,Hn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(ot)?this:oe.prev(this,ot)[0]||oe.next(this,ot)[0]||oe.findOne(ot,e.delegateTarget.parentNode),c=Ve.getOrCreateInstance(a);if(i){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),a.focus())}}K.on(document,oi,ot,Ve.dataApiKeydownHandler);K.on(document,oi,ss,Ve.dataApiKeydownHandler);K.on(document,ni,Ve.clearMenus);K.on(document,ih,Ve.clearMenus);K.on(document,ni,ot,function(n){n.preventDefault(),Ve.getOrCreateInstance(this).toggle()});Ie(Ve);const ii="backdrop",Eh="fade",Bn="show",Fn=`mousedown.bs.${ii}`,Ch={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Th={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ai extends Vt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ch}static get DefaultType(){return Th}static get NAME(){return ii}show(e){if(!this._config.isVisible){Se(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Ft(t),t.classList.add(Bn),this._emulateAnimation(()=>{Se(e)})}hide(e){if(!this._config.isVisible){Se(e);return}this._getElement().classList.remove(Bn),this._emulateAnimation(()=>{this.dispose(),Se(e)})}dispose(){this._isAppended&&(K.off(this._element,Fn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Eh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Je(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),K.on(e,Fn,()=>{Se(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){qo(e,this._getElement(),this._config.isAnimated)}}const xh="focustrap",Ah="bs.focustrap",rs=`.${Ah}`,Oh=`focusin${rs}`,Mh=`keydown.tab${rs}`,Dh="Tab",Nh="forward",Vn="backward",Lh={autofocus:!0,trapElement:null},jh={autofocus:"boolean",trapElement:"element"};class ri extends Vt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Lh}static get DefaultType(){return jh}static get NAME(){return xh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),K.off(document,rs),K.on(document,Oh,e=>this._handleFocusin(e)),K.on(document,Mh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,K.off(document,rs))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=oe.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Vn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Dh&&(this._lastTabNavDirection=e.shiftKey?Vn:Nh)}}const Un=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",qn=".sticky-top",Jt="padding-right",zn="margin-right";class zs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Jt,t=>t+e),this._setElementAttributes(Un,Jt,t=>t+e),this._setElementAttributes(qn,zn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Jt),this._resetElementAttributes(Un,Jt),this._resetElementAttributes(qn,zn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+i)return;this._saveInitialAttribute(c,t);const m=window.getComputedStyle(c).getPropertyValue(t);c.style.setProperty(t,`${o(Number.parseFloat(m))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&ze.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=ze.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}ze.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(qe(e)){t(e);return}for(const o of oe.find(e,this._element))t(o)}}const Ih="modal",Ph="bs.modal",Le=`.${Ph}`,Rh=".data-api",Wh="Escape",Hh=`hide${Le}`,Bh=`hidePrevented${Le}`,li=`hidden${Le}`,ci=`show${Le}`,Fh=`shown${Le}`,Vh=`resize${Le}`,Uh=`click.dismiss${Le}`,qh=`mousedown.dismiss${Le}`,zh=`keydown.dismiss${Le}`,Kh=`click${Le}${Rh}`,Kn="modal-open",Gh="fade",Gn="show",Ms="modal-static",Yh=".modal.show",Jh=".modal-dialog",Qh=".modal-body",Xh='[data-bs-toggle="modal"]',Zh={backdrop:!0,focus:!0,keyboard:!0},e_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class dt extends He{constructor(e,t){super(e,t),this._dialog=oe.findOne(Jh,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new zs,this._addEventListeners()}static get Default(){return Zh}static get DefaultType(){return e_}static get NAME(){return Ih}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||K.trigger(this._element,ci,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Kn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||K.trigger(this._element,Hh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Gn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){K.off(window,Le),K.off(this._dialog,Le),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ai({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ri({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=oe.findOne(Qh,this._dialog);t&&(t.scrollTop=0),Ft(this._element),this._element.classList.add(Gn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,K.trigger(this._element,Fh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){K.on(this._element,zh,e=>{if(e.key===Wh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),K.on(window,Vh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),K.on(this._element,qh,e=>{K.one(this._element,Uh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Kn),this._resetAdjustments(),this._scrollBar.reset(),K.trigger(this._element,li)})}_isAnimated(){return this._element.classList.contains(Gh)}_triggerBackdropTransition(){if(K.trigger(this._element,Bh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ms)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ms),this._queueCallback(()=>{this._element.classList.remove(Ms),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Ne()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Ne()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=dt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}K.on(document,Kh,Xh,function(n){const e=oe.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),K.one(e,ci,i=>{i.defaultPrevented||K.one(e,li,()=>{Dt(this)&&this.focus()})});const t=oe.findOne(Yh);t&&dt.getInstance(t).hide(),dt.getOrCreateInstance(e).toggle(this)});ds(dt);Ie(dt);const t_="offcanvas",s_="bs.offcanvas",Ge=`.${s_}`,ui=".data-api",n_=`load${Ge}${ui}`,o_="Escape",Yn="show",Jn="showing",Qn="hiding",i_="offcanvas-backdrop",di=".offcanvas.show",a_=`show${Ge}`,r_=`shown${Ge}`,l_=`hide${Ge}`,Xn=`hidePrevented${Ge}`,mi=`hidden${Ge}`,c_=`resize${Ge}`,u_=`click${Ge}${ui}`,d_=`keydown.dismiss${Ge}`,m_='[data-bs-toggle="offcanvas"]',p_={backdrop:!0,keyboard:!0,scroll:!1},f_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Xe extends He{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return p_}static get DefaultType(){return f_}static get NAME(){return t_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||K.trigger(this._element,a_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new zs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Jn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Yn),this._element.classList.remove(Jn),K.trigger(this._element,r_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||K.trigger(this._element,l_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Qn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Yn,Qn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new zs().reset(),K.trigger(this._element,mi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){K.trigger(this._element,Xn);return}this.hide()},t=!!this._config.backdrop;return new ai({className:i_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new ri({trapElement:this._element})}_addEventListeners(){K.on(this._element,d_,e=>{if(e.key===o_){if(this._config.keyboard){this.hide();return}K.trigger(this._element,Xn)}})}static jQueryInterface(e){return this.each(function(){const t=Xe.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}K.on(document,u_,m_,function(n){const e=oe.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Qe(this))return;K.one(e,mi,()=>{Dt(this)&&this.focus()});const t=oe.findOne(di);t&&t!==e&&Xe.getInstance(t).hide(),Xe.getOrCreateInstance(e).toggle(this)});K.on(window,n_,()=>{for(const n of oe.find(di))Xe.getOrCreateInstance(n).show()});K.on(window,c_,()=>{for(const n of oe.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Xe.getOrCreateInstance(n).hide()});ds(Xe);Ie(Xe);const v_=/^aria-[\w-]*$/i,pi={"*":["class","dir","id","lang","role",v_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},h_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),__=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,g_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?h_.has(t)?!!__.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function b_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const c of a){const m=c.nodeName.toLowerCase();if(!Object.keys(e).includes(m)){c.remove();continue}const p=[].concat(...c.attributes),f=[].concat(e["*"]||[],e[m]||[]);for(const d of p)g_(d,f)||c.removeAttribute(d.nodeName)}return i.body.innerHTML}const y_="TemplateFactory",$_={allowList:pi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},w_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},k_={entry:"(string|element|function|null)",selector:"(string|element)"};class S_ extends Vt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return $_}static get DefaultType(){return w_}static get NAME(){return y_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},k_)}_setContent(e,t,o){const i=oe.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(qe(t)){this._putElementInTemplate(Je(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?b_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Se(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const E_="tooltip",C_=new Set(["sanitize","allowList","sanitizeFn"]),Ds="fade",T_="modal",Qt="show",x_=".tooltip-inner",Zn=`.${T_}`,eo="hide.bs.modal",It="hover",Ns="focus",Ls="click",A_="manual",O_="hide",M_="hidden",D_="show",N_="shown",L_="inserted",j_="click",I_="focusin",P_="focusout",R_="mouseenter",W_="mouseleave",H_={AUTO:"auto",TOP:"top",RIGHT:Ne()?"left":"right",BOTTOM:"bottom",LEFT:Ne()?"right":"left"},B_={allowList:pi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},F_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Lt extends He{constructor(e,t){if(typeof Ho>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return B_}static get DefaultType(){return F_}static get NAME(){return E_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),K.off(this._element.closest(Zn),eo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=K.trigger(this._element,this.constructor.eventName(D_)),o=(Vo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),K.trigger(this._element,this.constructor.eventName(L_))),this._popper=this._createPopper(i),i.classList.add(Qt),"ontouchstart"in document.documentElement)for(const m of[].concat(...document.body.children))K.on(m,"mouseover",is);const c=()=>{K.trigger(this._element,this.constructor.eventName(N_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||K.trigger(this._element,this.constructor.eventName(O_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Qt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))K.off(i,"mouseover",is);this._activeTrigger[Ls]=!1,this._activeTrigger[Ns]=!1,this._activeTrigger[It]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),K.trigger(this._element,this.constructor.eventName(M_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ds,Qt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Af(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ds),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new S_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[x_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ds)}_isShown(){return this.tip&&this.tip.classList.contains(Qt)}_createPopper(e){const t=Se(this._config.placement,[this,e,this._element]),o=H_[t.toUpperCase()];return tn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Se(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Se(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")K.on(this._element,this.constructor.eventName(j_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ls]=!(i._isShown()&&i._activeTrigger[Ls]),i.toggle()});else if(t!==A_){const o=t===It?this.constructor.eventName(R_):this.constructor.eventName(I_),i=t===It?this.constructor.eventName(W_):this.constructor.eventName(P_);K.on(this._element,o,this._config.selector,a=>{const c=this._initializeOnDelegatedTarget(a);c._activeTrigger[a.type==="focusin"?Ns:It]=!0,c._enter()}),K.on(this._element,i,this._config.selector,a=>{const c=this._initializeOnDelegatedTarget(a);c._activeTrigger[a.type==="focusout"?Ns:It]=c._element.contains(a.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},K.on(this._element.closest(Zn),eo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=ze.getDataAttributes(this._element);for(const o of Object.keys(t))C_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Je(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Lt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ie(Lt);const V_="popover",U_=".popover-header",q_=".popover-body",z_={...Lt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},K_={...Lt.DefaultType,content:"(null|string|element|function)"};class an extends Lt{static get Default(){return z_}static get DefaultType(){return K_}static get NAME(){return V_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[U_]:this._getTitle(),[q_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=an.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ie(an);const G_="scrollspy",Y_="bs.scrollspy",rn=`.${Y_}`,J_=".data-api",Q_=`activate${rn}`,to=`click${rn}`,X_=`load${rn}${J_}`,Z_="dropdown-item",ht="active",eg='[data-bs-spy="scroll"]',js="[href]",tg=".nav, .list-group",so=".nav-link",sg=".nav-item",ng=".list-group-item",og=`${so}, ${sg} > ${so}, ${ng}`,ig=".dropdown",ag=".dropdown-toggle",rg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},lg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class fs extends He{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return rg}static get DefaultType(){return lg}static get NAME(){return G_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Je(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(K.off(this._config.target,to),K.on(this._config.target,to,js,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(t(c))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(c));continue}const m=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&m){if(o(c),!i)return;continue}!a&&!m&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=oe.find(js,this._config.target);for(const t of e){if(!t.hash||Qe(t))continue;const o=oe.findOne(decodeURI(t.hash),this._element);Dt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ht),this._activateParents(e),K.trigger(this._element,Q_,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Z_)){oe.findOne(ag,e.closest(ig)).classList.add(ht);return}for(const t of oe.parents(e,tg))for(const o of oe.prev(t,og))o.classList.add(ht)}_clearActiveClass(e){e.classList.remove(ht);const t=oe.find(`${js}.${ht}`,e);for(const o of t)o.classList.remove(ht)}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}K.on(window,X_,()=>{for(const n of oe.find(eg))fs.getOrCreateInstance(n)});Ie(fs);const cg="tab",ug="bs.tab",ft=`.${ug}`,dg=`hide${ft}`,mg=`hidden${ft}`,pg=`show${ft}`,fg=`shown${ft}`,vg=`click${ft}`,hg=`keydown${ft}`,_g=`load${ft}`,gg="ArrowLeft",no="ArrowRight",bg="ArrowUp",oo="ArrowDown",Is="Home",io="End",it="active",ao="fade",Ps="show",yg="dropdown",fi=".dropdown-toggle",$g=".dropdown-menu",Rs=`:not(${fi})`,wg='.list-group, .nav, [role="tablist"]',kg=".nav-item, .list-group-item",Sg=`.nav-link${Rs}, .list-group-item${Rs}, [role="tab"]${Rs}`,vi='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ws=`${Sg}, ${vi}`,Eg=`.${it}[data-bs-toggle="tab"], .${it}[data-bs-toggle="pill"], .${it}[data-bs-toggle="list"]`;class Ot extends He{constructor(e){super(e),this._parent=this._element.closest(wg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),K.on(this._element,hg,t=>this._keydown(t)))}static get NAME(){return cg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?K.trigger(t,dg,{relatedTarget:e}):null;K.trigger(e,pg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(it),this._activate(oe.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ps);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),K.trigger(e,fg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(ao))}_deactivate(e,t){if(!e)return;e.classList.remove(it),e.blur(),this._deactivate(oe.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ps);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),K.trigger(e,mg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(ao))}_keydown(e){if(![gg,no,bg,oo,Is,io].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Qe(i));let o;if([Is,io].includes(e.key))o=t[e.key===Is?0:t.length-1];else{const i=[no,oo].includes(e.key);o=sn(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Ot.getOrCreateInstance(o).show())}_getChildren(){return oe.find(Ws,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=oe.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(yg))return;const i=(a,c)=>{const m=oe.findOne(a,o);m&&m.classList.toggle(c,t)};i(fi,it),i($g,Ps),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(it)}_getInnerElement(e){return e.matches(Ws)?e:oe.findOne(Ws,e)}_getOuterElement(e){return e.closest(kg)||e}static jQueryInterface(e){return this.each(function(){const t=Ot.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}K.on(document,vg,vi,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Qe(this)&&Ot.getOrCreateInstance(this).show()});K.on(window,_g,()=>{for(const n of oe.find(Eg))Ot.getOrCreateInstance(n)});Ie(Ot);const Cg="toast",Tg="bs.toast",st=`.${Tg}`,xg=`mouseover${st}`,Ag=`mouseout${st}`,Og=`focusin${st}`,Mg=`focusout${st}`,Dg=`hide${st}`,Ng=`hidden${st}`,Lg=`show${st}`,jg=`shown${st}`,Ig="fade",ro="hide",Xt="show",Zt="showing",Pg={animation:"boolean",autohide:"boolean",delay:"number"},Rg={animation:!0,autohide:!0,delay:5e3};class vs extends He{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Rg}static get DefaultType(){return Pg}static get NAME(){return Cg}show(){if(K.trigger(this._element,Lg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Ig);const t=()=>{this._element.classList.remove(Zt),K.trigger(this._element,jg),this._maybeScheduleHide()};this._element.classList.remove(ro),Ft(this._element),this._element.classList.add(Xt,Zt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||K.trigger(this._element,Dg).defaultPrevented)return;const t=()=>{this._element.classList.add(ro),this._element.classList.remove(Zt,Xt),K.trigger(this._element,Ng)};this._element.classList.add(Zt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Xt),super.dispose()}isShown(){return this._element.classList.contains(Xt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){K.on(this._element,xg,e=>this._onInteraction(e,!0)),K.on(this._element,Ag,e=>this._onInteraction(e,!1)),K.on(this._element,Og,e=>this._onInteraction(e,!0)),K.on(this._element,Mg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ds(vs);Ie(vs);const Wg={class:"message-content-column"},Hg=["id"],Bg={class:"accordion-item"},Fg=["id"],Vg=["aria-controls"],Ug={class:"d-flex align-items-center w-100"},qg={class:"badge bg-warning text-dark ms-auto me-2"},zg={class:"text-muted"},Kg=["id","aria-labelledby"],Gg={class:"accordion-body bg-light"},Yg={class:"alert alert-warning mb-3",role:"alert"},Jg={class:"compaction-metadata"},Qg={class:"metadata-row"},Xg={class:"metadata-row"},Zg={key:0,class:"metadata-row"},eb={class:"continuation-content"},tb={class:"continuation-text border rounded p-3 bg-white"},sb={class:"mb-0"},nb={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=v(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=v(()=>`heading-${t.value}`),i=v(()=>`collapse-${t.value}`),a=P(null);let c=null;ye(()=>{a.value&&(c=new At(a.value,{toggle:!1}))}),_i(()=>{c&&c.dispose()});function m(){c&&c.toggle()}const p=v(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=v(()=>p.value?e.messages[3]:e.messages[2]),d=v(()=>f.value?.metadata?.init_data?.compact_metadata||{}),k=v(()=>d.value.pre_tokens||0),g=v(()=>p.value?e.messages[4]:e.messages[3]),$=v(()=>g.value?.content||""),b=v(()=>{const u=e.messages[0]?.timestamp;return u?Ht(u):""});function h(u){return u?`${u.toLocaleString()} tokens`:"0 tokens"}return(u,y)=>(r(),l("div",{class:"message-row message-row-compaction",key:t.value},[y[7]||(y[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Wg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Bg,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:m},[s("div",Ug,[y[0]||(y[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),y[1]||(y[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",qg,w(h(k.value)),1),s("small",zg,w(b.value),1)])],8,Vg)],8,Fg),s("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Gg,[s("div",Yg,[y[5]||(y[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ne(" Compaction Details ")],-1)),s("div",Jg,[s("div",Qg,[y[2]||(y[2]=s("strong",null,"Trigger:",-1)),s("span",null,w(d.value.trigger||"auto"),1)]),s("div",Xg,[y[3]||(y[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,w(h(k.value)),1)]),d.value.post_tokens?(r(),l("div",Zg,[y[4]||(y[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,w(h(d.value.post_tokens)),1)])):A("",!0)])]),s("div",eb,[y[6]||(y[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ne(" Continuation Message ")],-1)),s("div",tb,[s("pre",sb,w($.value),1)])])])],8,Kg)])],8,Hg)])]))}},ob=se(nb,[["__scopeId","data-v-e0b95ba8"]]),ib={key:0,class:"text-muted text-center py-5"},ab={__name:"MessageList",setup(n){const e=Te(),t=ve(),o=P(null),i=v(()=>{const d=e.currentMessages,k=[];let g=0;for(;g<d.length;){const $=d[g];if(c($,d,g)){const b=d[g+2],u=b?.type==="system"&&b?.metadata?.subtype==="init"?5:4,y=d.slice(g,g+u);k.push({type:"compaction",messages:y}),g+=u;continue}p($)&&k.push({type:"message",message:$,attachedTools:[]}),g++}return a(k)});function a(d){const k=new Map,g=new Set;for(let b=0;b<d.length;b++){const h=d[b];if(h.type==="compaction")continue;const u=h.message,y=u.content&&u.content.trim().length>0&&u.content!=="Assistant response",_=u.type==="assistant"&&u.metadata?.has_tool_uses&&u.metadata?.tool_uses?.length>0;if(u.type==="assistant"&&_&&!y){let C=-1,S=!1;for(let j=b-1;j>=0;j--){const L=d[j];if(!g.has(j)){if(L.type==="message"&&L.message.type!=="assistant"){S=!0;break}if(L.type==="message"&&L.message.type==="assistant"){const x=L.message;if(x.content&&x.content.trim().length>0&&x.content!=="Assistant response"){C=j;break}else{C=j;break}}}}S&&C===-1||(S&&C>=0?(k.has(C)||k.set(C,[]),k.get(C).push(...u.metadata.tool_uses),g.add(b)):!S&&C>=0&&(k.has(C)||k.set(C,[]),k.get(C).push(...u.metadata.tool_uses),g.add(b)))}}const $=[];for(let b=0;b<d.length;b++){if(g.has(b))continue;const h=d[b];k.has(b)&&(h.attachedTools=[...h.attachedTools||[],...k.get(b)]),$.push(h)}return $}function c(d,k,g){if(g+3>=k.length)return!1;const $=k[g],b=k[g+1];let h=k[g+2],u=k[g+3],y=k[g+4];const _=$.type==="system"&&$.metadata?.subtype==="status"&&$.metadata?.init_data?.status==="compacting",C=b.type==="system"&&b.metadata?.subtype==="status"&&(b.metadata?.init_data?.status===null||b.metadata?.init_data?.status===void 0);if(h?.type==="system"&&h?.metadata?.subtype==="init"){if(g+4>=k.length)return!1;const j=!0,L=u?.type==="system"&&u?.metadata?.subtype==="compact_boundary",x=y?.type==="user"&&y?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",C),console.log("  Msg3 (init):",j),console.log("  Msg4 (boundary):",L),console.log("  Msg5 (continuation):",x)),_&&C&&j&&L&&x}else{const j=h?.type==="system"&&h?.metadata?.subtype==="compact_boundary",L=u?.type==="user"&&u?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",C),console.log("  Msg3 (boundary):",j),console.log("  Msg4 (continuation):",L)),_&&C&&j&&L}}async function m(){t.autoScrollEnabled&&(await wt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}pe(()=>i.value.length,m),pe(()=>e.currentToolCalls.length,m),pe(()=>e.currentToolCalls.map(d=>`${d.id}-${d.status}`).join(","),m),ye(()=>{setTimeout(()=>{m()},100)});function p(d){const k=d.subtype||d.metadata?.subtype;if(d.type==="system"&&k==="init"||d.type==="system"&&k==="task_notification"||d.type==="result"||d.type==="permission_request"||d.type==="permission_response")return!1;if(d.type==="user"&&d.metadata?.has_tool_results){const g=d.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(d.type==="user"){const g=d.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(d.type==="user"){const g=d.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(d.type==="user"){const g=d.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function f(d){return{type:d.type||"unknown",content:d.content||"",timestamp:d.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...d.metadata}}}return(d,k)=>(r(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(r(),l("div",ib," No messages yet. Start a conversation! ")):A("",!0),(r(!0),l(ae,null,ce(i.value,(g,$)=>(r(),l(ae,{key:`item-${$}`},[g.type==="message"?(r(),be(Bp,{key:0,message:f(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(r(),be(ob,{key:1,messages:g.messages},null,8,["messages"])):A("",!0)],64))),128))],512))}},rb=se(ab,[["__scopeId","data-v-bb936559"]]),lb={class:"border-top bg-light"},cb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},ub={class:"d-flex gap-2 align-items-end px-2 py-1"},db=["placeholder","disabled"],mb=["disabled"],pb={__name:"InputArea",setup(n){const e=de(),t=Ze(),o=P(null),i=P(window.innerWidth),a=v({get:()=>e.currentInput,set:u=>{e.currentInput=u}}),c=v(()=>e.currentSession?.is_processing||!1),m=v(()=>t.sessionConnected),p=v(()=>e.currentSession?.state==="starting"),f=v(()=>i.value<768),d=v(()=>p.value?"Session is starting...":m.value?"Type your message to Claude Code...":"Waiting for connection...");function k(){i.value=window.innerWidth}ye(()=>{window.addEventListener("resize",k)}),Ee(()=>{window.removeEventListener("resize",k)});function g(u){if(u.key==="Enter"&&!u.shiftKey){if(f.value)return;u.preventDefault(),b()}}function $(){const u=o.value;if(!u)return;u.style.height="auto";const y=Math.min(u.scrollHeight,parseInt(getComputedStyle(u).maxHeight));u.style.height=y+"px"}function b(){a.value.trim()&&(t.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function h(){t.interruptSession()}return(u,y)=>(r(),l("div",lb,[m.value?A("",!0):(r(),l("div",cb,[...y[1]||(y[1]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",ub,[ge(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":y[0]||(y[0]=_=>a.value=_),class:"form-control",placeholder:d.value,disabled:p.value||!m.value,rows:"1",onInput:$,onKeydown:g},null,40,db),[[We,a.value]]),c.value?(r(),l("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:h}," Stop ")):(r(),l("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!m.value||p.value,onClick:b}," Send ",8,mb))])]))}},fb=se(pb,[["__scopeId","data-v-ef1e5094"]]),vb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},hb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},_b={class:"text-secondary"},gb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},bb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=ve(),i=v(()=>t.currentSession),a=v(()=>o.isLoading),c=v(()=>o.loadingMessage);return ye(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),pe(()=>e.sessionId,async(m,p)=>{if(m!==p&&m!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(m)}finally{o.hideLoading()}}}),Ee(()=>{}),(m,p)=>(r(),l("div",vb,[a.value?(r(),l("div",hb,[p[0]||(p[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",_b,w(c.value),1)])):A("",!0),i.value?(r(),be(Fi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),s("div",gb,[me(rb)]),me(fb),i.value?(r(),be(Ki,{key:2,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),i.value?(r(),be(sa,{key:3,"session-id":e.sessionId},null,8,["session-id"])):A("",!0)]))}},hs=mt("legion",()=>{const n=P(new Map),e=P(new Map),t=P(null),o=v(()=>n.value.get(t.value)||[]),i=v(()=>e.value.get(t.value)||[]);function a(b){t.value=b}async function c(b,h=100,u=0){try{const y=await ue.get(`/api/legions/${b}/timeline?limit=${h}&offset=${u}`),_=y.comms||[],C=y.total_count||_.length,S=y.has_more||!1;return _.sort((j,L)=>new Date(j.timestamp)-new Date(L.timestamp)),console.log(`Loaded ${_.length} of ${C} comms for legion ${b}`),n.value.set(b,_),n.value=new Map(n.value),{comms:_,totalCount:C,hasMore:S}}catch(y){throw console.error("Failed to load timeline:",y),y}}function m(b,h){n.value.has(b)||n.value.set(b,[]);const u=n.value.get(b);if(u.some(_=>_.comm_id===h.comm_id)){console.log(`Duplicate comm ${h.comm_id} prevented in timeline`);return}u.push(h),n.value=new Map(n.value)}async function p(b,h){try{const y=(await ue.post(`/api/legions/${b}/comms`,h)).comm;return console.log(`Sent comm ${y.comm_id} to legion ${b}`),y}catch(u){throw console.error("Failed to send comm:",u),u}}async function f(b){return console.log(`Minions for legion ${b} are already available in session store`),[]}async function d(b,h){try{const y=(await ue.post(`/api/legions/${b}/minions`,h)).minion;return await f(b),console.log(`Created minion ${y.minion_id} in legion ${b}`),y}catch(u){throw console.error("Failed to create minion:",u),u}}async function k(b){try{const h=await ue.post(`/api/legions/${b}/halt-all`);return console.log(`Halted ${h.halted_count} of ${h.total_minions} minions in legion ${b}`),h.failed_minions&&h.failed_minions.length>0&&console.warn("Failed to halt some minions:",h.failed_minions),h}catch(h){throw console.error("Failed to halt all minions:",h),h}}async function g(b){try{const h=await ue.post(`/api/legions/${b}/resume-all`);return console.log(`Resumed ${h.resumed_count} of ${h.total_minions} minions in legion ${b}`),h.failed_minions&&h.failed_minions.length>0&&console.warn("Failed to resume some minions:",h.failed_minions),h}catch(h){throw console.error("Failed to resume all minions:",h),h}}function $(b){n.value.delete(b),e.value.delete(b),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:c,addComm:m,sendComm:p,loadMinions:f,createMinion:d,haltAll:k,resumeAll:g,clearLegionData:$}}),yb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:hs},Symbol.toStringTag,{value:"Module"})),$b={class:"timeline-header border-bottom p-3"},wb={class:"project-name"},kb=["title"],Sb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=je(),o=v(()=>t.projects.get(e.legionId)),i=v(()=>o.value?.name||"Legion");return(a,c)=>(r(),l("div",$b,[s("div",null,[s("div",wb,w(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,kb)])]))}},Eb=se(Sb,[["__scopeId","data-v-44f386f5"]]),Cb={class:"timeline-status-bar border-top p-2 bg-light"},Tb={class:"d-flex justify-content-end"},xb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ve();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(r(),l("div",Cb,[s("div",Tb,[s("button",{class:ee(["btn btn-sm",ns(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+w(ns(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Ab=se(xb,[["__scopeId","data-v-891c73db"]]),Ob={class:"comm-composer border-top p-3"},Mb={key:0,class:"d-flex gap-2 mb-2"},Db={class:"flex-grow-1"},Nb=["disabled"],Lb={label:"Minions"},jb=["value"],Ib={style:{"min-width":"150px"}},Pb=["disabled"],Rb={class:"d-flex gap-2 align-items-end position-relative"},Wb={class:"flex-grow-1 position-relative"},Hb=["disabled"],Bb=["onClick","onMouseenter"],Fb=["disabled"],Vb={key:0},Ub={key:1},qb={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=hs(),o=de(),i=je(),a=P(""),c=P("task"),m=P(""),p=P(!1),f=P(window.innerWidth),d=P(!1),k=P([]),g=P(0),$=P(-1),b=P(null),h=P(null),u=v(()=>f.value<768),y=v(()=>{const U=i.projects.get(e.legionId);return!U||!U.session_ids?[]:U.session_ids.map(I=>o.sessions.get(I)).filter(I=>I)}),_=v(()=>a.value&&m.value.trim().length>0);function C(U){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[U.state]||"â—‹"}function S(U){return U.role?`${U.name} (${U.role})`:U.name}function j(){const U=b.value;if(!U)return;U.style.height="auto";const I=Math.min(U.scrollHeight,parseInt(getComputedStyle(U).maxHeight));U.style.height=I+"px"}function L(){const U=b.value;if(!U)return;j();const I=m.value,H=U.selectionStart,V=I.substring(0,H),X=V.lastIndexOf("#");if(X===-1){d.value=!1;return}const M=V.substring(X+1).toLowerCase();if(M.includes(" ")){d.value=!1;return}const N=y.value.filter(O=>O.name.toLowerCase().includes(M)).map(O=>({type:"minion",name:O.name,role:O.role,id:O.session_id,state:O.state}));if(N.length===0){d.value=!1;return}k.value=N,g.value=0,$.value=X,d.value=!0}function x(){if(!h.value)return;const U=h.value,I=U.children[g.value];if(!I)return;const H=I.offsetTop,V=I.offsetHeight,X=U.scrollTop,M=U.clientHeight;H<X?U.scrollTop=H:H+V>X+M&&(U.scrollTop=H+V-M)}function R(U){if(!d.value){if(U.key==="Enter"&&!U.shiftKey){if(u.value)return;_.value&&(U.preventDefault(),T())}return}if(U.key==="ArrowDown")U.preventDefault(),g.value=(g.value+1)%k.value.length,x();else if(U.key==="ArrowUp")U.preventDefault(),g.value=g.value===0?k.value.length-1:g.value-1,x();else if(U.key==="Enter"){U.preventDefault();const I=k.value[g.value];I&&E(I)}else U.key==="Escape"&&(d.value=!1)}function E(U){const I=b.value;if(!I)return;const H=m.value,V=I.selectionStart,X=H.substring(0,$.value)+"#"+U.name+" "+H.substring(V);m.value=X;const M=$.value+U.name.length+2;setTimeout(()=>{I.setSelectionRange(M,M),I.focus()},0),d.value=!1}async function T(){if(!(!_.value||p.value)){p.value=!0;try{const[U,I]=a.value.split(":"),H={comm_type:c.value,content:m.value.trim()};U==="minion"&&(H.to_minion_id=I),await t.sendComm(e.legionId,H),m.value="",j()}catch(U){console.error("Failed to send comm:",U),alert(`Failed to send comm: ${U.message}`)}finally{p.value=!1}}}function F(){f.value=window.innerWidth}return ye(()=>{window.addEventListener("resize",F)}),Ee(()=>{window.removeEventListener("resize",F)}),pe(d,U=>{if(U){const I=H=>{H.target.closest(".comm-composer")||(d.value=!1,document.removeEventListener("click",I))};setTimeout(()=>document.addEventListener("click",I),0)}}),(U,I)=>(r(),l("div",Ob,[n.hideRecipientSelector?A("",!0):(r(),l("div",Mb,[s("div",Db,[ge(s("select",{"onUpdate:modelValue":I[0]||(I[0]=H=>a.value=H),class:"form-select form-select-sm",disabled:p.value},[I[3]||(I[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Lb,[(r(!0),l(ae,null,ce(y.value,H=>(r(),l("option",{key:H.session_id,value:`minion:${H.session_id}`},w(C(H))+" "+w(S(H)),9,jb))),128))])],8,Nb),[[vn,a.value]])]),s("div",Ib,[ge(s("select",{"onUpdate:modelValue":I[1]||(I[1]=H=>c.value=H),class:"form-select form-select-sm",disabled:p.value},[...I[4]||(I[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Pb),[[vn,c.value]])])])),s("div",Rb,[s("div",Wb,[ge(s("textarea",{ref_key:"contentTextarea",ref:b,"onUpdate:modelValue":I[2]||(I[2]=H=>m.value=H),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:L,onKeydown:R},null,40,Hb),[[We,m.value]]),d.value?(r(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:h,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(r(!0),l(ae,null,ce(k.value,(H,V)=>(r(),l("div",{key:H.id,class:ee(["autocomplete-item px-2 py-1",{"bg-light":V===g.value}]),onClick:X=>E(H),onMouseenter:X=>g.value=V},w(H.type==="minion"?C(H):"#ï¸âƒ£")+" "+w(H.name)+w(H.role?` (${H.role})`:""),43,Bb))),128))],512)):A("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!_.value||p.value,onClick:T},[p.value?(r(),l("span",Vb,[...I[5]||(I[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ne(" Sending... ",-1)])])):(r(),l("span",Ub,"Send"))],8,Fb)])])]))}},zb=se(qb,[["__scopeId","data-v-e52b8e8f"]]),Kb={class:"message-content-column-full"},Gb=["aria-expanded"],Yb={class:"comm-sender-recipient"},Jb={class:"comm-badge-summary"},Qb=["title"],Xb={class:"comm-summary-text text-muted ms-2"},Zb=["aria-label"],ey={key:0,class:"comm-content-body"},ty=["innerHTML"],sy="ffffffff-ffff-ffff-ffff-ffffffffffff",ny={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;lt.setOptions({breaks:!0,gfm:!0});const t=P(!1);function o(){t.value=!t.value}const i=v(()=>e.comm.from_minion_id===sy),a=v(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),c=v(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),m=v(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),p=v(()=>{const f=e.comm.content||"";let d=lt.parse(f);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),ls.sanitize(d)});return(f,d)=>(r(),l("div",{class:ee(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",Kb,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",Yb,[s("strong",{class:ee({"system-sender":i.value})},w(n.senderName),3),n.recipientName?(r(),l(ae,{key:0},[d[0]||(d[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,w(n.recipientName),1)],64)):A("",!0)]),s("div",Jb,[s("span",{class:ee(["badge",c.value]),title:a.value},w(n.comm.comm_type),11,Qb),s("span",Xb,w(m.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},w(t.value?"â–¾":"â–¸"),9,Zb)],8,Gb),t.value?(r(),l("div",ey,[s("div",{class:"message-text",innerHTML:p.value},null,8,ty)])):A("",!0)])],2))}},oy=se(ny,[["__scopeId","data-v-28513f64"]]),iy={class:"timeline-view d-flex flex-column h-100"},ay={key:0,class:"text-center text-muted"},ry={key:1,class:"text-center text-danger"},ly={key:2,class:"text-center text-muted"},cy={key:3,class:"comm-list"},uy={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=hs();je();const o=de(),i=Ze(),a=ve(),c=P(!0),m=P(null),p=P(null),f=v(()=>t.currentComms);function d(u){return u.from_user?"You":u.from_minion_id?u.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(u.from_minion_id)?.name||"Unknown":"Unknown"}function k(u){return u.to_user?"You":u.to_minion_id?o.sessions.get(u.to_minion_id)?.name||"Unknown":"All"}async function g(){a.autoScrollEnabled&&(await wt(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function $(){c.value=!0,m.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await wt(),await g(),setTimeout(()=>{g()},100)}catch(u){console.error("Failed to load timeline:",u),u.response?m.value=`${u.message} (${u.response.status})`:m.value=u.message||"Unknown error"}finally{c.value=!1}}function b(){i.connectLegion(e.legionId)}function h(){i.disconnectLegion()}return pe(()=>f.value.length,()=>{g()}),ye(()=>{o.currentSessionId=null,$(),b(),setTimeout(()=>{g()},100)}),Ee(()=>{h()}),(u,y)=>(r(),l("div",iy,[me(Eb,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(r(),l("div",ay,[...y[0]||(y[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ne(" Loading timeline... ",-1)])])):m.value?(r(),l("div",ry," Failed to load timeline: "+w(m.value),1)):f.value.length===0?(r(),l("div",ly," No messages yet. Minions will appear here once they start communicating. ")):(r(),l("div",cy,[(r(!0),l(ae,null,ce(f.value,_=>(r(),be(oy,{key:_.comm_id,comm:_,"sender-name":d(_),"recipient-name":k(_)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),me(zb,{"legion-id":n.legionId},null,8,["legion-id"]),me(Ab,{"legion-id":n.legionId},null,8,["legion-id"])]))}},dy=se(uy,[["__scopeId","data-v-b6752179"]]),my={class:"minion-info flex-grow-1"},py={class:"minion-name"},fy={key:0,class:"me-1"},vy={key:1,class:"badge bg-secondary ms-2"},hy={key:0,class:"latest-activity text-muted"},_y={key:0,class:"activity-prefix"},gy=["title"],by={key:1,class:"activity-time ms-1"},yy={key:1,class:"latest-activity text-muted"},$y={class:"activity-prefix"},wy=["title"],ky={key:2,class:"latest-activity text-muted fst-italic small"},Sy={class:"node-row"},Ey={class:"node-left"},Cy={key:0,class:"me-2"},Ty={key:1,class:"badge bg-secondary ms-2"},xy={class:"node-right"},Ay={key:0,class:"latest-message-preview"},Oy={key:0,class:"message-prefix"},My=["title"],Dy={key:1,class:"message-time ms-1"},Ny={key:1,class:"last-comm-preview"},Ly={class:"comm-direction"},jy=["title"],Iy={key:2,class:"text-muted fst-italic small"},Py={class:"node-actions"},Ry={key:2,class:"minion-children"},Wy={key:1,class:"text-danger small ms-4"},Hy={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=de(),a=Te(),c=ve(),m=v(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),p=v(()=>{if(!t.minionData||!t.minionData.id)return null;const E=a.messagesBySession.get(t.minionData.id);if(!E||E.length===0)return null;for(let T=E.length-1;T>=0;T--){const F=E[T],U=F.subtype||F.metadata?.subtype;if(F.type!=="result"&&!(F.type==="system"&&U==="init")&&!(F.type==="system"&&U==="task_notification")&&!(F.type==="permission_request"||F.type==="permission_response")){if(F.type==="user"&&F.metadata?.has_tool_results){const I=F.content||"";if(I.match(/^Tool results?: \d+ results?$/i)||I.trim()==="")continue}if(F.type==="user"){const I=F.content||"";if(I.includes("<command-message>")&&I.includes("skill is running")||I.startsWith("Base directory for this skill:"))continue}if(F.type==="user"){const I=F.content||"";if(I.includes("<command-message>")&&I.includes("<command-name>")&&I.includes("<command-args>")||I.includes("ARGUMENTS:")&&(I.includes("<command-name>")||I.match(/\nARGUMENTS:/)))continue}if(!(F.type==="system"&&F.content==="System message")&&!(F.type==="assistant"&&F.content==="Assistant response")&&(F.type==="user"||F.type==="assistant"||F.type==="system"))return{content:F.content,type:F.type,timestamp:F.timestamp}}}return null}),f=v(()=>{if(!t.minionData)return null;const E={...t.minionData};return m.value&&(E.state=m.value.state,E.is_processing=m.value.is_processing,m.value.name&&(E.name=m.value.name),m.value.latest_message&&(E.latest_message=m.value.latest_message,E.latest_message_type=m.value.latest_message_type,E.latest_message_time=m.value.latest_message_time)),p.value&&(E.latest_message=p.value.content,E.latest_message_type=p.value.type,E.latest_message_time=p.value.timestamp),E}),d=v(()=>t.level*24),k=v(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),g=v(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),$=v(()=>t.minionData&&t.minionData.is_overseer&&g.value),b=v(()=>{const E=f.value;return E?E.state==="paused"&&E.is_processing?"pending-prompt":E.is_processing?"processing":E.state||"created":"created"}),h=v(()=>{const E=b.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[E]||"status-dot-grey"}),u=v(()=>{const E=b.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[E]||"#d3d3d3"}}),y=v(()=>{const E=f.value;if(!E||!E.latest_message_type)return"";const T=E.latest_message_type;return T==="user"?"User -->:":T==="system"?"System:":""}),_=v(()=>{const E=f.value;if(!E||!E.latest_message)return"";const T=E.latest_message,F=150;return T.length>F?T.slice(0,F)+"...":T}),C=v(()=>{const E=f.value;if(!E||!E.latest_message_time)return"";try{const T=Date.now();let F;if(typeof E.latest_message_time=="number"?F=E.latest_message_time<3250368e4?E.latest_message_time*1e3:E.latest_message_time:F=new Date(E.latest_message_time).getTime(),isNaN(F)||F<9466848e5||F>T+6e4)return console.warn("Invalid timestamp for relative time calculation:",E.latest_message_time,"parsed to:",F),"";const U=T-F;if(U<0)return"just now";const I=Math.floor(U/6e4),H=Math.floor(I/60),V=Math.floor(H/24);return V>0?`${V}d ago`:H>0?`${H}h ago`:I>0?`${I}m ago`:"just now"}catch(T){return console.error("Error calculating relative time:",T,E.latest_message_time),""}});function S(E){return E.to_user?"User":E.to_minion_name?E.to_minion_name:"unknown"}function j(E){const T=E.summary||E.content||"";return T.length>150?T.substring(0,150)+"...":T}function L(){o("minion-click",t.minionData.id)}function x(){const E=i.sessions.get(t.minionData.id);E&&c.showModal("edit-session",{session:E})}function R(){const E=i.sessions.get(t.minionData.id);E&&c.showModal("manage-session",{session:E})}return(E,T)=>{const F=co("MinionTreeNode",!0);return n.minionData?(r(),l("div",{key:0,class:"minion-tree-node",style:at({marginLeft:`${d.value}px`})},[n.layout==="sidebar"?(r(),l("div",{key:0,class:ee(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:k.value}]),onClick:L},[s("div",{class:ee(["status-dot me-2",h.value]),style:at(u.value)},null,6),s("div",my,[s("div",py,[$.value?(r(),l("span",fy,"ðŸ‘‘")):A("",!0),s("strong",null,w(f.value?.name||n.minionData.name),1),$.value?(r(),l("span",vy,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),f.value?.latest_message?(r(),l("div",hy,[y.value?(r(),l("span",_y,w(y.value),1)):A("",!0),s("span",{class:"activity-content",title:f.value.latest_message},w(_.value),9,gy),C.value?(r(),l("span",by,"("+w(C.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(r(),l("div",yy,[s("span",$y,[T[1]||(T[1]=ne("â†’ ",-1)),s("strong",null,w(S(n.minionData.last_comm)),1),T[2]||(T[2]=ne(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},w(j(n.minionData.last_comm)),9,wy)])):(r(),l("div",ky," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(x,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(R,["stop"])}," âš™ï¸ ")],2)):(r(),l("div",{key:1,class:ee(["minion-card minion-card-clickable border-start border-2 mb-2",{active:k.value}]),onClick:L},[s("div",Sy,[s("div",Ey,[s("div",{class:ee(["status-dot me-2",h.value]),style:at(u.value)},null,6),$.value?(r(),l("span",Cy,"ðŸ‘‘")):A("",!0),s("strong",null,w(f.value?.name||n.minionData.name),1),$.value?(r(),l("span",Ty,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),s("div",xy,[f.value?.latest_message?(r(),l("div",Ay,[y.value?(r(),l("span",Oy,w(y.value),1)):A("",!0),s("span",{class:"message-content",title:f.value.latest_message},w(_.value),9,My),C.value?(r(),l("span",Dy,"("+w(C.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(r(),l("div",Ny,[s("span",Ly,[T[3]||(T[3]=ne("â†’ ",-1)),s("strong",null,w(S(n.minionData.last_comm)),1),T[4]||(T[4]=ne(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},w(j(n.minionData.last_comm)),9,jy)])):(r(),l("div",Iy," No activity yet "))]),s("div",Py,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(x,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(R,["stop"])}," âš™ï¸ ")])])],2)),g.value?(r(),l("div",Ry,[(r(!0),l(ae,null,ce(n.minionData.children,U=>(r(),be(F,{key:U.id,"minion-data":U,level:n.level+1,layout:n.layout,onMinionClick:T[0]||(T[0]=I=>E.$emit("minion-click",I))},null,8,["minion-data","level","layout"]))),128))])):A("",!0)],4)):(r(),l("div",Wy," âš  Minion data is missing "))}}},hi=se(Hy,[["__scopeId","data-v-64b23e0e"]]),By={class:"project-overview d-flex flex-column h-100"},Fy={class:"project-overview-header border-bottom p-3"},Vy={class:"d-flex align-items-center justify-content-between"},Uy={class:"mb-1"},qy={key:0,class:"me-2"},zy={class:"text-muted font-monospace"},Ky={class:"d-flex gap-2"},Gy=["title"],Yy={class:"project-overview-content flex-grow-1 overflow-auto p-3"},Jy={key:0,class:"text-center py-5"},Qy={key:1,class:"alert alert-danger"},Xy={key:2,class:"text-center py-5"},Zy={key:3},e1={class:"row g-3 mb-4"},t1={class:"col-md-4"},s1={class:"card h-100"},n1={class:"card-body"},o1={class:"card-title mb-0"},i1={class:"text-muted"},a1={class:"col-md-4"},r1={class:"card h-100"},l1={class:"card-body"},c1={class:"card-title mb-0"},u1={class:"text-muted"},d1={key:0,class:"card mb-4"},m1={class:"card mb-4"},p1={class:"card-header d-flex align-items-center justify-content-between"},f1={class:"mb-0"},v1={class:"badge bg-secondary"},h1={class:"card-body"},_1={key:0,class:"text-center py-4"},g1={key:1,class:"text-center text-muted py-4"},b1={key:2,class:"hierarchy-tree"},y1={class:"user-root-node mb-3 border rounded bg-white"},$1={class:"node-row"},w1={class:"node-left"},k1={class:"badge bg-primary ms-2"},S1={class:"node-right"},E1={key:0,class:"last-comm-preview"},C1={class:"comm-direction"},T1=["title"],x1={key:1,class:"text-muted fst-italic"},A1={class:"root-minions ms-4"},O1={class:"card"},M1={class:"card-body"},D1={class:"row mb-0"},N1={class:"col-sm-8 font-monospace text-break"},L1={class:"col-sm-8 font-monospace text-break"},j1={class:"col-sm-8"},I1={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},P1={class:"text-muted"},R1={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Wt(),o=je(),i=de(),a=ve(),c=hs(),m=Ze(),p=P(!1),f=P(null),d=P(null),k=P(!1);let g=null;const $=v(()=>o.getProject(e.projectId)),b=v(()=>$.value?.session_ids?$.value.session_ids.map(H=>i.getSession(H)).filter(H=>H!=null):[]),h=v(()=>b.value.length>0),u=v(()=>b.value.length),y=v(()=>b.value.filter(H=>H.state==="ACTIVE").length),_=v(()=>{const H=b.value.some(M=>M.state==="ACTIVE"),V=b.value.some(M=>M.is_processing);return b.value.some(M=>M.state==="ERROR")?"Error":V?"Working":H?"Active":u.value>0?"Idle":"Empty"}),C=v(()=>{switch(_.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),S=v(()=>{switch(_.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function j(){k.value=!0;try{const H=await ue.get(`/api/legions/${e.projectId}/hierarchy`);d.value=H}catch(H){console.error("Failed to load minion hierarchy:",H),d.value=null}finally{k.value=!1}}function L(H,V){if(H&&H.id===V)return H;if(H&&H.children)for(const X of H.children){const M=L(X,V);if(M)return M}return null}function x(H){return H.to_user?"User":H.to_minion_name?H.to_minion_name:"unknown"}function R(H){const V=H.summary||H.content||"";return V.length>150?V.substring(0,150)+"...":V}function E(H){if(d.value){if(H.from_minion_id){const V=L(d.value,H.from_minion_id);V&&V.type==="minion"&&(V.last_comm=H)}H.from_user&&d.value.type==="user"&&(d.value.last_comm=H)}}function T(H){t.push(`/session/${H}`)}function F(){t.push(`/timeline/${e.projectId}`)}function U(){a.showModal("edit-project",{project:$.value})}function I(){a.showModal("create-minion",{project:$.value})}return ye(()=>{o.selectProject(e.projectId),i.currentSessionId=null,j(),c.setCurrentLegion(e.projectId),m.connectLegion(e.projectId),g=pe(()=>i.sessions,H=>{if(d.value){for(const[V,X]of H)if(X.project_id===e.projectId){const M=L(d.value,V);M&&M.type==="minion"&&(M.state!==X.state&&(M.state=X.state),M.is_processing!==X.is_processing&&(M.is_processing=X.is_processing),M.latest_message!==X.latest_message&&(M.latest_message=X.latest_message,M.latest_message_type=X.latest_message_type,M.latest_message_time=X.latest_message_time))}}},{deep:!0}),pe(()=>c.commsByLegion.get(e.projectId),H=>{if(H&&H.length>0){const V=H[H.length-1];E(V)}},{deep:!0}),pe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(H,V)=>{H!==V&&j()})}),pe(()=>e.projectId,H=>{o.selectProject(H),i.currentSessionId=null,j(),c.setCurrentLegion(H),m.connectLegion(H)}),Ee(()=>{g&&g()}),(H,V)=>(r(),l("div",By,[s("div",Fy,[s("div",Vy,[s("div",null,[s("h4",Uy,[h.value?(r(),l("span",qy,"ðŸ›")):A("",!0),ne(" "+w($.value?.name||"Project Overview"),1)]),s("small",zy,w($.value?.working_directory),1)]),s("div",Ky,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:U}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:h.value?"Create minion":"Add session",onClick:I}," âž• "+w(h.value?"Add Minion":"Add Session"),9,Gy)])])]),s("div",Yy,[p.value?(r(),l("div",Jy,[...V[0]||(V[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(r(),l("div",Qy,w(f.value),1)):$.value?(r(),l("div",Zy,[s("div",e1,[s("div",t1,[s("div",s1,[s("div",n1,[V[2]||(V[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",o1,w(u.value),1),s("small",i1,w(y.value)+" active",1)])])]),s("div",a1,[s("div",r1,[s("div",l1,[V[3]||(V[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",c1,[s("span",{class:ee(C.value)},w(_.value),3)]),s("small",u1,w(S.value),1)])])])]),h.value?(r(),l("div",d1,[V[4]||(V[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:F}," ðŸ“Š View Timeline ")])])])):A("",!0),s("div",m1,[s("div",p1,[s("h5",f1,"ðŸŒ³ "+w(h.value?"Minion Hierarchy":"Sessions"),1),s("span",v1,w(b.value.length),1)]),s("div",h1,[k.value?(r(),l("div",_1,[...V[5]||(V[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!d.value||!d.value.children||d.value.children.length===0?(r(),l("div",g1,' No sessions yet. Click "Add Session" to create one. ')):(r(),l("div",b1,[s("div",y1,[s("div",$1,[s("div",w1,[V[6]||(V[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,w(d.value.name),1),s("span",k1,w(d.value.children.length)+" "+w(d.value.children.length===1?"minion":"minions"),1)]),s("div",S1,[d.value.last_comm?(r(),l("div",E1,[s("span",C1,[V[7]||(V[7]=ne(" â†’ ",-1)),s("strong",null,w(x(d.value.last_comm)),1),V[8]||(V[8]=ne(": ",-1))]),s("span",{class:"comm-content",title:d.value.last_comm.content||""},w(R(d.value.last_comm)),9,T1)])):(r(),l("div",x1," No communications yet "))])])]),s("div",A1,[(r(!0),l(ae,null,ce(d.value.children,X=>(r(),be(hi,{key:X.id,"minion-data":X,level:1,layout:"two-column",onMinionClick:T},null,8,["minion-data"]))),128))])]))])]),s("div",O1,[V[12]||(V[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",M1,[s("dl",D1,[V[9]||(V[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",N1,w($.value.working_directory),1),V[10]||(V[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",L1,w($.value.project_id),1),V[11]||(V[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",j1,w(h.value?"Yes (has minions)":"No"),1)])])])])):(r(),l("div",Xy,[...V[1]||(V[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",I1,[V[13]||(V[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",P1,w(u.value)+" session"+w(u.value!==1?"s":""),1)])]))}},W1=se(R1,[["__scopeId","data-v-168bf04c"]]),H1=[{path:"/",name:"home",component:Ti},{path:"/project/:projectId",name:"project",component:W1,props:!0},{path:"/session/:sessionId",name:"session",component:bb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:dy,props:!0}],B1=gi({history:bi(),routes:H1}),F1={class:"connection-indicators"},V1=["title"],U1=["title"],q1=["title"],z1={__name:"ConnectionIndicator",setup(n){const e=Ze();function t(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:c,retryCount:m}=a[i];return m>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},m={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:p,retryCount:f}=m[i];let d="Disconnected";return p?d="Connected":f>0&&(d=`Reconnecting (attempt ${f})`),`${a[i]}
${c[i]}
Status: ${d}`}return(i,a)=>(r(),l("div",F1,[s("div",{class:ee(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,V1),s("div",{class:ee(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,U1),s("div",{class:ee(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,q1)]))}},K1=se(z1,[["__scopeId","data-v-d35b07c8"]]),G1={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Y1={class:"d-flex align-items-center gap-2"},J1={__name:"AppHeader",setup(n){const e=ve();function t(){e.toggleSidebar()}return(o,i)=>(r(),l("header",G1,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",Y1,[me(K1)])]))}},Q1={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},X1={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Z1=["title"],e$={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(m){return m.state==="paused"&&m.is_processing?"pending-prompt":m.is_processing?"processing":m.state}function i(m){const p=o(m);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function a(m){const p=o(m);return p==="starting"||p==="processing"||p==="pending-prompt"}function c(m){const p=o(m),f=p.charAt(0).toUpperCase()+p.slice(1),d=m.name||"Unnamed Session",k=m.role?` (${m.role})`:"";return`${d}${k}: ${f}`}return(m,p)=>(r(),l("div",Q1,[!n.sessions||n.sessions.length===0?(r(),l("div",X1)):(r(!0),l(ae,{key:1},ce(n.sessions,f=>(r(),l("div",{key:f.session_id,class:ee(["progress-bar",{"progress-bar-striped progress-bar-animated":a(f)}]),style:at({width:t.value,backgroundColor:i(f),cursor:"help"}),title:c(f)},null,14,Z1))),128))]))}},t$=se(e$,[["__scopeId","data-v-391d77c1"]]),s$=["data-project-id"],n$=["id"],o$=["aria-expanded","aria-controls","aria-label","onKeydown"],i$=["aria-label","onKeydown"],a$={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},r$={class:"fw-semibold",style:{"flex-shrink":"0"}},l$={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},c$={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},u$=["title"],d$=["title"],m$=["id","aria-labelledby"],p$={class:"accordion-body p-0"},f$={class:"list-group list-group-flush"},v$={class:"minion-hierarchy-container"},h$={key:0,class:"text-center py-2"},_$={key:2,class:"text-muted text-center py-2 small"},g$={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Wt(),o=je(),i=de(),a=ve(),c=P(e.project.is_expanded||!1),m=P(null),p=P(!1);let f=null;const d=v(()=>o.formatPath(e.project.working_directory)),k=v(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(I=>i.getSession(I)).filter(I=>I!=null)),g=v(()=>k.value.length>0),$=v(()=>{const I=t.currentRoute.value;return I.name==="timeline"&&I.params.legionId===e.project.project_id}),b=v(()=>{const I=t.currentRoute.value;return I.name==="project"&&I.params.projectId===e.project.project_id});function h(I){const H=window.bootstrap;if(!H)return;const V=document.getElementById(`collapse-${e.project.project_id}`);if(!V)return;H.Collapse.getOrCreateInstance(V).toggle(),c.value=!c.value}function u(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function y(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function _(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const I=i.currentSessionId;I&&i.getSession(I)&&e.project.session_ids?.includes(I)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function C(){a.showModal("edit-project",{project:e.project})}function S(){a.showModal("create-minion",{project:e.project})}function j(){t.push(`/timeline/${e.project.project_id}`)}async function L(){p.value=!0;try{const I=await ue.get(`/api/legions/${e.project.project_id}/hierarchy`);m.value=I}catch(I){console.error("Failed to load minion hierarchy:",I),m.value=null}finally{p.value=!1}}function x(I){t.push(`/session/${I}`)}function R(I,H){if(I&&I.id===H)return I;if(I&&I.children)for(const V of I.children){const X=R(V,H);if(X)return X}return null}pe(c,I=>{I&&L()}),ye(()=>{f=pe(()=>i.sessions,I=>{if(!(!m.value||!c.value)){for(const[H,V]of I)if(V.project_id===e.project.project_id){const X=R(m.value,H);X&&X.type==="minion"&&(X.state!==V.state&&(X.state=V.state),X.is_processing!==V.is_processing&&(X.is_processing=V.is_processing),X.latest_message!==V.latest_message&&(X.latest_message=V.latest_message,X.latest_message_type=V.latest_message_type,X.latest_message_time=V.latest_message_time))}}},{deep:!0}),pe(()=>i.sessions.size,(I,H)=>{if(c.value&&(I>H&&Array.from(i.sessions.values()).some(M=>M.project_id===e.project.project_id&&(!m.value||!R(m.value,M.session_id)))&&(console.log("New minion detected, reloading hierarchy"),L()),I<H&&m.value)){const V=i.sessions,X=M=>M.type==="minion"&&!V.has(M.id)?!0:M.children?M.children.some(N=>X(N)):!1;X(m.value)&&(console.log("Minion deletion detected, reloading hierarchy"),L())}}),c.value&&L()}),Ee(()=>{f&&f()});function E(I){I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("application/project-id",e.project.project_id),I.dataTransfer.setData("text/plain",e.project.project_id),I.target.classList.add("dragging")}function T(I){I.target.classList.remove("dragging")}function F(I){I.preventDefault(),I.dataTransfer.dropEffect="move";const H=I.currentTarget.getBoundingClientRect(),V=H.top+H.height/2;I.clientY<V?(I.currentTarget.classList.add("drop-above"),I.currentTarget.classList.remove("drop-below")):(I.currentTarget.classList.add("drop-below"),I.currentTarget.classList.remove("drop-above"))}function U(I){I.preventDefault(),I.currentTarget.classList.remove("drop-above","drop-below");const H=I.dataTransfer.getData("application/project-id")||I.dataTransfer.getData("text/plain");if(!H||H===e.project.project_id)return;const V=I.currentTarget.getBoundingClientRect(),X=V.top+V.height/2,M=I.clientY<X,N=o.orderedProjects,O=N.findIndex(te=>te.project_id===e.project.project_id),D=N.findIndex(te=>te.project_id===H);if(O===-1||D===-1)return;const z=[...N],[Q]=z.splice(D,1);let J=M?O:O+1;D<O&&J--,z.splice(J,0,Q);const Y=z.map(te=>te.project_id);o.reorderProjects(Y)}return(I,H)=>(r(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:E,onDragend:T,onDragover:F,onDrop:U},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:ee(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":b.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:_e(h,["stop"]),onKeydown:[Re(_e(h,["prevent"]),["enter"]),Re(_e(h,["prevent"]),["space"])]},[(r(),l("svg",{class:ee(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...H[0]||(H[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,o$),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:u,onKeydown:[Re(_e(u,["prevent"]),["enter"]),Re(_e(u,["prevent"]),["space"])]},[s("div",a$,[s("div",r$,[g.value?(r(),l("span",l$,"ðŸ›")):A("",!0),ne(" "+w(n.project.name),1)]),s("div",c$,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:_e(C,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:_e(S,["stop"])}," âž• ",8,u$)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},w(d.value),9,d$)],40,i$)],2)],8,n$),me(t$,{project:n.project,sessions:k.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:ee(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:y,onHidden:_},[s("div",p$,[s("div",f$,[g.value?(r(),l("div",{key:0,class:ee(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:$.value}]),style:{cursor:"pointer"},onClick:j},[...H[1]||(H[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):A("",!0),s("div",v$,[p.value?(r(),l("div",h$,[...H[2]||(H[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):m.value&&m.value.children&&m.value.children.length>0?(r(!0),l(ae,{key:1},ce(m.value.children,V=>(r(),be(hi,{key:V.id,"minion-data":V,level:0,layout:"sidebar",onMinionClick:x},null,8,["minion-data"]))),128)):(r(),l("div",_$," No sessions "))])])])],42,m$)],40,s$))}},b$=se(g$,[["__scopeId","data-v-a15b34e8"]]),y$={class:"project-list"},$$={key:0,class:"text-muted text-center py-3"},w$={__name:"ProjectList",setup(n){const e=je(),t=v(()=>e.orderedProjects);return(o,i)=>(r(),l("div",y$,[t.value.length===0?(r(),l("div",$$,' No projects yet. Click "New" to create one. ')):A("",!0),(r(!0),l(ae,null,ce(t.value,a=>(r(),be(b$,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},k$={class:"flex-grow-1 overflow-auto p-3"},S$={id:"sessions-container"},E$={__name:"Sidebar",setup(n){const e=ve(),t=v(()=>e.sidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const d=`${e.sidebarWidth}px`;return{width:d,minWidth:"200px",maxWidth:"30vw","--sidebar-width":d}});function a(){e.showModal("create-project")}const c=P(!1);function m(d){c.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",f)}function p(d){c.value&&e.setSidebarWidth(d.clientX)}function f(){c.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f)}return(d,k)=>(r(),l("aside",{id:"sidebar",class:ee(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:at(i.value)},[s("div",k$,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[k[0]||(k[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),s("div",S$,[me(w$)])]),s("div",{class:"sidebar-resize-handle",onMousedown:m},null,32)],6))}},C$=se(E$,[["__scopeId","data-v-d792f0f0"]]),T$={class:"task-row d-flex align-items-center gap-2"},x$={key:0,class:"status-icon"},A$={key:1,class:"status-icon"},O$=["title"],M$={key:0,class:"task-details"},D$={key:0,class:"task-description mb-2"},N$={class:"description-content"},L$={key:1,class:"task-owner mb-2"},j$={class:"ms-1"},I$={key:2,class:"task-blocked-by mb-2"},P$={key:3,class:"task-blocks"},R$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=v(()=>e.task.status==="in_progress"),o=v(()=>e.task.status==="completed"?"âœ…":"â³"),i=v(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),a=v(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,m)=>(r(),l("div",{class:ee(["task-item",a.value]),onClick:m[0]||(m[0]=p=>c.$emit("toggle"))},[s("div",T$,[t.value?(r(),l("span",x$,[...m[1]||(m[1]=[s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(r(),l("span",A$,w(o.value),1)),s("span",{class:"task-text flex-grow-1",title:n.task.subject},w(i.value),9,O$),(r(),l("svg",{class:ee(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...m[2]||(m[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(r(),l("div",M$,[n.task.description?(r(),l("div",D$,[m[3]||(m[3]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",N$,w(n.task.description),1)])):A("",!0),n.task.owner?(r(),l("div",L$,[m[4]||(m[4]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",j$,w(n.task.owner),1)])):A("",!0),n.task.blockedBy?.length>0?(r(),l("div",I$,[m[5]||(m[5]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(r(!0),l(ae,null,ce(n.task.blockedBy,p=>(r(),l("span",{key:p,class:"badge bg-warning text-dark me-1"}," #"+w(p),1))),128))])):A("",!0),n.task.blocks?.length>0?(r(),l("div",P$,[m[6]||(m[6]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(r(!0),l(ae,null,ce(n.task.blocks,p=>(r(),l("span",{key:p,class:"badge bg-info text-dark me-1"}," #"+w(p),1))),128))])):A("",!0)])):A("",!0)],2))}},W$=se(R$,[["__scopeId","data-v-0f96ae87"]]),H$={class:"task-list-panel"},B$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},F$={class:"d-flex align-items-center gap-2"},V$={key:0,class:"badge bg-secondary"},U$=["title"],q$={key:0,class:"task-list p-2"},z$={key:0,class:"text-muted text-center py-4"},K$={__name:"TaskListPanel",setup(n){const e=$t();ve();const t=P(new Set),o=P(!1),i=v(()=>e.currentTasks),a=v(()=>e.currentTaskStats);function c(){o.value=!o.value}function m(p){t.value.has(p)?t.value.delete(p):t.value.add(p),t.value=new Set(t.value)}return(p,f)=>(r(),l("div",H$,[s("div",B$,[s("div",F$,[f[0]||(f[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),f[1]||(f[1]=s("h6",{class:"mb-0"},"Tasks",-1)),a.value.total>0?(r(),l("span",V$,w(a.value.completed)+"/"+w(a.value.total),1)):A("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:c,title:o.value?"Expand":"Collapse"},[(r(),l("svg",{class:ee(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,U$)]),o.value?A("",!0):(r(),l("div",q$,[i.value.length===0?(r(),l("div",z$,[...f[3]||(f[3]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):A("",!0),me($i,{name:"task-list",tag:"div"},{default:yi(()=>[(r(!0),l(ae,null,ce(i.value,d=>(r(),be(W$,{key:d.id,task:d,isExpanded:t.value.has(d.id),onToggle:k=>m(d.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},G$=se(K$,[["__scopeId","data-v-ef829ea9"]]),Y$={class:"flex-grow-1 overflow-auto"},J$={__name:"RightSidebar",setup(n){const e=ve(),t=v(()=>e.rightSidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const f=`${e.rightSidebarWidth}px`;return{width:f,minWidth:"200px",maxWidth:"30vw","--sidebar-width":f}}),a=P(!1);function c(f){f.preventDefault(),a.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",p)}function m(f){if(a.value){const d=window.innerWidth-f.clientX;e.setRightSidebarWidth(d)}}function p(){a.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",p)}return(f,d)=>(r(),l("aside",{id:"right-sidebar",class:ee(["bg-light border-start d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,resizing:a.value}]),style:at(i.value)},[s("div",Y$,[me(G$)]),s("div",{class:"sidebar-resize-handle",onMousedown:c},null,32)],6))}},Q$=se(J$,[["__scopeId","data-v-7b88088a"]]),X$={class:"modal-dialog modal-lg"},Z$={class:"modal-content"},ew={class:"modal-body"},tw={class:"mb-3"},sw={class:"input-group"},nw=["disabled"],ow={key:0,class:"text-center py-4"},iw={key:1,class:"alert alert-danger",role:"alert"},aw={key:2,class:"folder-list"},rw=["onClick","onDblclick"],lw={class:"d-flex align-items-center flex-grow-1"},cw=["onClick"],uw={key:1,class:"text-center text-muted py-3"},dw={class:"modal-footer"},mw=["disabled"],pw={__name:"FolderBrowserModal",setup(n){const e=ve(),t=P(""),o=P(""),i=P([]),a=P(!1),c=P(""),m=P(null);let p=null,f=null;const d=v(()=>{if(!t.value)return null;const C=t.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?"/"+C.join("/"):"/")});function k(C){if(!C)return"";const S=C.split(/[\\/]/).filter(Boolean);return S.length<=2?C:".../"+S.slice(-2).join("/")}async function g(){a.value=!0,c.value="",i.value=[],o.value="";try{const C=t.value?{path:t.value}:{},S=await ue.get("/api/filesystem/browse",{params:C});S.current_path&&(t.value=S.current_path),i.value=S.directories||[]}catch(C){console.error("Failed to load directory:",C),c.value=C.message||"Failed to load directory"}finally{a.value=!1}}function $(C){o.value=C.path}function b(C){t.value=C.path,o.value="",g()}function h(){d.value&&(t.value=d.value,o.value="",g())}function u(){const C=o.value||t.value;C&&f&&f(C),p&&p.hide()}function y(){g()}function _(){i.value=[],o.value="",c.value="",f=null,e.hideModal()}return pe(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&p){const S=C.data||{};t.value=S.defaultPath||S.currentPath||"",f=S.onSelect||null,p.show()}}),ye(()=>{m.value&&Me(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{p=new C(m.value),m.value.addEventListener("shown.bs.modal",y),m.value.addEventListener("hidden.bs.modal",_)})}),Ee(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",y),m.value.removeEventListener("hidden.bs.modal",_)),p&&p.dispose()}),(C,S)=>(r(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[s("div",X$,[s("div",Z$,[S[6]||(S[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",ew,[s("div",tw,[S[1]||(S[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",sw,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":S[0]||(S[0]=j=>t.value=j),onKeyup:Re(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:g,disabled:a.value}," ðŸ”„ Refresh ",8,nw)])]),a.value?(r(),l("div",ow,[...S[2]||(S[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(r(),l("div",iw,w(c.value),1)):(r(),l("div",aw,[d.value?(r(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:h,role:"button"},[...S[3]||(S[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):A("",!0),(r(!0),l(ae,null,ce(i.value,j=>(r(),l("div",{key:j.path,class:ee(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:j.path===o.value}]),onClick:L=>$(j),onDblclick:L=>b(j),role:"button"},[s("div",lw,[S[4]||(S[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,w(j.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:_e(L=>b(j),["stop"])}," Open ",8,cw)],42,rw))),128)),i.value.length===0?(r(),l("div",uw," No subdirectories found ")):A("",!0)]))]),s("div",dw,[S[5]||(S[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:u,disabled:!o.value},' Select "'+w(k(o.value||t.value))+'" ',9,mw)])])])],512))}},fw=se(pw,[["__scopeId","data-v-0d61ed46"]]),vw={class:"modal-dialog"},hw={class:"modal-content"},_w={class:"modal-body"},gw={class:"mb-3"},bw={key:0,class:"invalid-feedback"},yw={class:"mb-3"},$w={class:"input-group"},ww={key:0,class:"invalid-feedback"},kw={class:"mb-3 form-check"},Sw={key:0,class:"mb-3 ms-4"},Ew={key:1,class:"alert alert-danger",role:"alert"},Cw={class:"modal-footer"},Tw=["disabled"],xw={key:0,class:"spinner-border spinner-border-sm me-2"},Aw={__name:"ProjectCreateModal",setup(n){const e=je(),t=de(),o=ve(),i=P({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),a=P({name:"",workingDirectory:""}),c=P(!1),m=P(""),p=P(null);let f=null;function d(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:u=>{i.value.workingDirectory=u,a.value.workingDirectory=""}})}function k(){a.value={};let u=!0;return i.value.name.trim()||(a.value.name="Project name is required",u=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",u=!1),u}async function g(){if(k()){c.value=!0,m.value="";try{const u=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(u.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),$()}catch(u){console.error("Failed to create project:",u),m.value=u.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function $(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},a.value={},m.value=""}function b(){const u=document.getElementById("projectName");u&&u.focus()}function h(){$(),o.hideModal()}return pe(()=>o.currentModal,u=>{u?.name==="create-project"&&f&&f.show()}),ye(()=>{p.value&&Me(async()=>{const{default:u}=await import("./modal-D6mKceGM.js").then(y=>y.m);return{default:u}},__vite__mapDeps([0,1])).then(({default:u})=>{f=new u(p.value),p.value.addEventListener("shown.bs.modal",b),p.value.addEventListener("hidden.bs.modal",h)})}),Ee(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",b),p.value.removeEventListener("hidden.bs.modal",h)),f&&f.dispose()}),(u,y)=>(r(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",vw,[s("div",hw,[y[11]||(y[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",_w,[s("form",{onSubmit:_e(g,["prevent"])},[s("div",gw,[y[4]||(y[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:ee(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":y[0]||(y[0]=_=>i.value.name=_),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),a.value.name?(r(),l("div",bw,w(a.value.name),1)):A("",!0)]),s("div",yw,[y[5]||(y[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",$w,[ge(s("input",{type:"text",class:ee(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":y[1]||(y[1]=_=>i.value.workingDirectory=_),placeholder:"/path/to/project",required:""},null,2),[[We,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:d}," Browse... "),a.value.workingDirectory?(r(),l("div",ww,w(a.value.workingDirectory),1)):A("",!0)]),y[6]||(y[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",kw,[ge(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":y[2]||(y[2]=_=>i.value.createSession=_)},null,512),[[wi,i.value.createSession]]),y[7]||(y[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),y[8]||(y[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(r(),l("div",Sw,[y[9]||(y[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ge(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":y[3]||(y[3]=_=>i.value.sessionName=_),placeholder:"main"},null,512),[[We,i.value.sessionName]])])):A("",!0),m.value?(r(),l("div",Ew,w(m.value),1)):A("",!0)],32)]),s("div",Cw,[y[10]||(y[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:c.value},[c.value?(r(),l("span",xw)):A("",!0),ne(" "+w(c.value?"Creating...":"Create Project"),1)],8,Tw)])])])],512))}},Ow=se(Aw,[["__scopeId","data-v-ea55fdae"]]),Mw={class:"modal-dialog"},Dw={class:"modal-content"},Nw={class:"modal-body"},Lw={class:"mb-3"},jw={key:0,class:"invalid-feedback"},Iw={class:"mb-3"},Pw=["value"],Rw={key:0,class:"alert alert-danger",role:"alert"},Ww={class:"danger-zone"},Hw={class:"text-muted small"},Bw=["disabled"],Fw={key:0,class:"alert alert-warning mt-3",role:"alert"},Vw={class:"mb-2"},Uw={class:"d-flex gap-2"},qw=["disabled"],zw={key:0,class:"spinner-border spinner-border-sm me-2"},Kw=["disabled"],Gw={class:"modal-footer"},Yw=["disabled"],Jw={key:0,class:"spinner-border spinner-border-sm me-2"},Qw={__name:"ProjectEditModal",setup(n){const e=je(),t=ve(),o=P(null),i=P({name:""}),a=P({name:""}),c=P(!1),m=P(!1),p=P(""),f=P(!1),d=P(null);let k=null;const g=v(()=>o.value?.session_ids?.length||0);function $(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Project name is required",C=!1),C}async function b(){if(!(!$()||!o.value)){c.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),k&&k.hide()}catch(C){console.error("Failed to update project:",C),p.value=C.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function h(){if(o.value){m.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),k&&k.hide()}catch(C){console.error("Failed to delete project:",C),p.value=C.message||"Failed to delete project. Please try again."}finally{m.value=!1}}}function u(){i.value={name:""},a.value={},p.value="",f.value=!1}function y(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function _(){u(),o.value=null,t.hideModal()}return pe(()=>t.currentModal,C=>{if(C?.name==="edit-project"&&k){const S=C.data||{};o.value=S.project,o.value&&(i.value.name=o.value.name),k.show()}}),ye(()=>{d.value&&Me(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{k=new C(d.value),d.value.addEventListener("shown.bs.modal",y),d.value.addEventListener("hidden.bs.modal",_)})}),Ee(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",y),d.value.removeEventListener("hidden.bs.modal",_)),k&&k.dispose()}),(C,S)=>(r(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",Mw,[s("div",Dw,[S[10]||(S[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Nw,[s("form",{onSubmit:_e(b,["prevent"])},[s("div",Lw,[S[3]||(S[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:ee(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":S[0]||(S[0]=j=>i.value.name=j),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),a.value.name?(r(),l("div",jw,w(a.value.name),1)):A("",!0)]),s("div",Iw,[S[4]||(S[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Pw),S[5]||(S[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(r(),l("div",Rw,w(p.value),1)):A("",!0)],32),S[8]||(S[8]=s("hr",null,null,-1)),s("div",Ww,[S[6]||(S[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",Hw," Deleting this project will also delete all "+w(g.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:S[1]||(S[1]=j=>f.value=!0),disabled:m.value}," ðŸ—‘ï¸ Delete Project ",8,Bw)]),f.value?(r(),l("div",Fw,[S[7]||(S[7]=s("strong",null,"Are you sure?",-1)),s("p",Vw,' This will permanently delete the project "'+w(o.value?.name)+'" and all '+w(g.value)+" session(s). ",1),s("div",Uw,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:h,disabled:m.value},[m.value?(r(),l("span",zw)):A("",!0),ne(" "+w(m.value?"Deleting...":"Yes, Delete Permanently"),1)],8,qw),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:S[2]||(S[2]=j=>f.value=!1),disabled:m.value}," Cancel ",8,Kw)])])):A("",!0)]),s("div",Gw,[S[9]||(S[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:c.value},[c.value?(r(),l("span",Jw)):A("",!0),ne(" "+w(c.value?"Saving...":"Save Changes"),1)],8,Yw)])])])],512))}},Xw=se(Qw,[["__scopeId","data-v-52679516"]]),Zw={class:"general-tab"},ek={key:0,class:"mb-3"},tk={for:"template-select",class:"form-label"},sk=["value"],nk=["value"],ok={key:0,class:"form-text"},ik={class:"mb-3"},ak={for:"config-name",class:"form-label"},rk=["value","placeholder","pattern","title"],lk={key:0,class:"invalid-feedback"},ck={key:1,class:"form-text"},uk={key:1,class:"mb-3"},dk=["value"],mk={class:"mb-3"},pk=["value"],fk={class:"form-text"},vk={key:0,class:"text-warning"},hk={key:1},_k={class:"mb-3"},gk={for:"config-permission-mode",class:"form-label"},bk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},yk={key:1,class:"field-indicator modified",title:"Modified from template"},$k=["value","disabled"],wk={key:0,value:"bypassPermissions"},kk={class:"form-text"},Sk={key:0,class:"text-warning"},Ek={key:1},Ck={class:"mb-3"},Tk={for:"config-role",class:"form-label"},xk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Ak={key:1,class:"field-indicator modified",title:"Modified from template"},Ok=["value","placeholder"],Mk={class:"form-text"},Dk={key:2,class:"mb-3"},Nk={class:"input-group"},Lk=["value","placeholder","disabled","readonly"],jk={class:"form-text"},Ik={key:3,class:"mb-3"},Pk={class:"form-control-plaintext"},Rk={key:4,class:"mb-3 form-check"},Wk=["checked"],Hk={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=v(()=>e.mode==="create-session"||e.mode==="edit-session"),o=v(()=>e.mode==="create-template"||e.mode==="edit-template"),i=v(()=>e.mode==="create-session"),a=v(()=>e.mode==="edit-session"),c=v(()=>e.session?.state==="active"||e.session?.state==="starting"),m=v(()=>{if(!e.session)return!1;const h=e.session.model||"sonnet";return e.formData.model!==h}),p=v(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=v(()=>e.selectedTemplateId?e.templates.find(h=>h.template_id===e.selectedTemplateId):null),d={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},k=v(()=>d[e.formData.model]||null),g=v(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),$=v(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function b(h){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[h]||"bg-secondary"}return(h,u)=>(r(),l("div",Zw,[i.value?(r(),l("div",ek,[s("label",tk,[u[10]||(u[10]=ne(" Template ",-1)),s("button",{type:"button",onClick:u[0]||(u[0]=y=>h.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:u[1]||(u[1]=y=>h.$emit("update:selected-template-id",y.target.value||null)),class:"form-select"},[u[11]||(u[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(r(!0),l(ae,null,ce(n.templates,y=>(r(),l("option",{key:y.template_id,value:y.template_id},w(y.name),9,nk))),128))],40,sk),f.value?(r(),l("div",ok,w(f.value.description),1)):A("",!0)])):A("",!0),s("div",ik,[s("label",ak,[ne(w(o.value?"Template Name":"Session Name")+" ",1),u[12]||(u[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:ee(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:u[2]||(u[2]=y=>h.$emit("update:form-data","name",y.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,rk),n.errors.name?(r(),l("div",lk,w(n.errors.name),1)):A("",!0),t.value?(r(),l("div",ck,"Must be a single word (no spaces) for #nametag matching")):A("",!0)]),o.value?(r(),l("div",uk,[u[13]||(u[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:u[3]||(u[3]=y=>h.$emit("update:form-data","description",y.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,dk)])):A("",!0),s("div",mk,[u[16]||(u[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:u[4]||(u[4]=y=>h.$emit("update:form-data","model",y.target.value))},[...u[14]||(u[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,pk),s("div",fk,[a.value&&c.value&&m.value?(r(),l("span",vk,[...u[15]||(u[15]=[ne(" Model change requires a ",-1),s("strong",null,"reset",-1),ne(" (not restart) to take effect. ",-1)])])):k.value?(r(),l("span",hk,w(k.value.description),1)):A("",!0)])]),s("div",_k,[s("label",gk,[u[17]||(u[17]=ne(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(r(),l("span",bk," < ")):A("",!0),n.fieldStates.permission_mode==="modified"?(r(),l("span",yk," * ")):A("",!0)]),s("select",{id:"config-permission-mode",class:ee(["form-select",$.value]),value:n.formData.permission_mode,onChange:u[5]||(u[5]=y=>h.$emit("update:form-data","permission_mode",y.target.value)),disabled:a.value&&!c.value},[u[18]||(u[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),u[19]||(u[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),u[20]||(u[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!a.value||p.value?(r(),l("option",wk," Bypass Permissions (No prompts - use with caution) ")):A("",!0)],42,$k),s("div",kk,[a.value&&!c.value?(r(),l("span",Sk," Session must be active to change permission mode. Start the session first. ")):(r(),l("span",Ek,"Controls which tool actions require permission prompts"))])]),s("div",Ck,[s("label",Tk,[ne(w(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(r(),l("span",xk," < ")):A("",!0),n.fieldStates.default_role==="modified"?(r(),l("span",Ak," * ")):A("",!0)]),s("input",{id:"config-role",type:"text",class:ee(["form-control",g.value]),value:n.formData.default_role,onInput:u[6]||(u[6]=y=>h.$emit("update:form-data","default_role",y.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,Ok),s("div",Mk,w(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(r(),l("div",Dk,[u[21]||(u[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",Nk,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:u[7]||(u[7]=y=>h.$emit("update:form-data","working_directory",y.target.value)),placeholder:a.value?"":"Leave empty to inherit from project",disabled:a.value,readonly:a.value},null,40,Lk),a.value?A("",!0):(r(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:u[8]||(u[8]=y=>h.$emit("open-folder-browser"))}," Browse "))]),s("div",jk,w(a.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):A("",!0),a.value&&n.session?(r(),l("div",Ik,[u[22]||(u[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",Pk,[s("span",{class:ee(["badge",b(n.session.state)])},w(n.session.state),3)])])):A("",!0),i.value?(r(),l("div",Rk,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:u[9]||(u[9]=y=>h.$emit("update:form-data","startImmediately",y.target.checked))},null,40,Wk),u[23]||(u[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):A("",!0)]))}},Bk=se(Hk,[["__scopeId","data-v-b9edc342"]]),Fk={class:"permissions-tab"},Vk={class:"mb-3"},Uk={for:"config-allowed-tools",class:"form-label"},qk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},zk={key:1,class:"field-indicator modified",title:"Modified from template"},Kk={key:0,class:"tools-list mb-2"},Gk=["onClick"],Yk={class:"input-group input-group-sm"},Jk=["onKeydown"],Qk=["disabled"],Xk={class:"mt-2"},Zk=["onClick"],eS={class:"form-text"},tS={key:0,class:"text-warning"},sS={key:1},nS={class:"mb-3"},oS={class:"capabilities-editor"},iS={key:0,class:"capabilities-list mb-2"},aS=["onClick"],rS={class:"input-group input-group-sm"},lS=["onKeydown"],cS=["disabled"],uS={key:0,class:"mb-3"},dS={class:"settings-sources-editor"},mS={class:"form-check"},pS=["checked"],fS={class:"form-check"},vS=["checked"],hS={class:"form-check"},_S=["checked"],gS={class:"form-text"},bS={key:0,class:"text-warning"},yS={key:1},$S={key:1,class:"mb-3"},wS={class:"mb-3"},kS={key:0,class:"mt-2"},SS=["value"],ES=["value"],CS={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=P(""),a=P(""),c=P(!1),m=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=v(()=>t.mode==="create-template"||t.mode==="edit-template"),f=v(()=>t.mode==="create-session"||t.mode==="edit-session"),d=v(()=>t.mode==="edit-session"),k=v(()=>t.session?.state==="active"||t.session?.state==="starting"),g=v(()=>{if(!t.session)return!1;const E=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==E}),$=v(()=>t.formData.setting_sources||["user","project","local"]),b=v(()=>{if(!t.session)return!1;const E=t.session.setting_sources||["user","project","local"],T=t.formData.setting_sources||["user","project","local"];return JSON.stringify(E.sort())!==JSON.stringify(T.sort())}),h=v(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(E=>E.trim()).filter(E=>E.length>0)),u=v(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(E=>E.trim()).filter(E=>E.length>0)),y=v(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),_=v(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function C(){const E=i.value.trim();if(E){if(!h.value.includes(E)){const T=[...h.value,E];o("update:form-data","allowed_tools",T.join(", "))}i.value=""}}function S(E){const T=[...h.value];T.splice(E,1),o("update:form-data","allowed_tools",T.join(", "))}function j(E){if(h.value.includes(E)){const T=h.value.indexOf(E);S(T)}else{const T=[...h.value,E];o("update:form-data","allowed_tools",T.join(", "))}}function L(){const E=a.value.trim().toLowerCase();if(E){if(!u.value.includes(E)){const T=[...u.value,E];o("update:form-data","capabilities",T.join(", "))}a.value=""}}function x(E){const T=[...u.value];T.splice(E,1),o("update:form-data","capabilities",T.join(", "))}function R(E){const T=[...$.value],F=T.indexOf(E);F>=0?T.splice(F,1):T.push(E),o("update:form-data","setting_sources",T)}return(E,T)=>(r(),l("div",Fk,[s("div",Vk,[s("label",Uk,[T[9]||(T[9]=ne(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(r(),l("span",qk," < ")):A("",!0),n.fieldStates.allowed_tools==="modified"?(r(),l("span",zk," * ")):A("",!0)]),s("div",{class:ee(["allowed-tools-editor",_.value])},[h.value.length>0?(r(),l("div",Kk,[(r(!0),l(ae,null,ce(h.value,(F,U)=>(r(),l("span",{key:U,class:"badge bg-primary me-1 mb-1 tool-badge"},[ne(w(F)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:I=>S(U),"aria-label":"Remove tool"},null,8,Gk)]))),128))])):A("",!0),s("div",Yk,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=F=>i.value=F),onKeydown:Re(_e(C,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,Jk),[[We,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:C,disabled:!i.value.trim()}," Add ",8,Qk)]),s("div",Xk,[T[10]||(T[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(r(),l(ae,null,ce(m,F=>s("button",{key:F,type:"button",class:ee(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":h.value.includes(F)}]),onClick:U=>j(F)},w(F),11,Zk)),64))])],2),s("div",eS,[d.value&&k.value&&g.value?(r(),l("span",tS,[...T[11]||(T[11]=[ne(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),ne(" (not restart) to take effect. ",-1)])])):(r(),l("span",sS,w(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",nS,[T[12]||(T[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",oS,[u.value.length>0?(r(),l("div",iS,[(r(!0),l(ae,null,ce(u.value,(F,U)=>(r(),l("span",{key:U,class:"badge bg-info me-1 mb-1 capability-badge"},[ne(w(F)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:I=>x(U),"aria-label":"Remove capability"},null,8,aS)]))),128))])):A("",!0),s("div",rS,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":T[1]||(T[1]=F=>a.value=F),onKeydown:Re(_e(L,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,lS),[[We,a.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:L,disabled:!a.value.trim()}," Add ",8,cS)])]),T[13]||(T[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(r(),l("div",uS,[T[18]||(T[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",dS,[s("div",mS,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:$.value.includes("user"),onChange:T[2]||(T[2]=F=>R("user"))},null,40,pS),T[14]||(T[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[ne(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",fS,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:$.value.includes("project"),onChange:T[3]||(T[3]=F=>R("project"))},null,40,vS),T[15]||(T[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[ne(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",hS,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:$.value.includes("local"),onChange:T[4]||(T[4]=F=>R("local"))},null,40,_S),T[16]||(T[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[ne(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",gS,[d.value&&k.value&&b.value?(r(),l("span",bS,[...T[17]||(T[17]=[ne(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),ne(" to take effect. ",-1)])])):(r(),l("span",yS," Select which settings files to load permissions from "))])])):A("",!0),f.value?(r(),l("div",$S,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:T[5]||(T[5]=F=>E.$emit("preview-permissions"))}," Preview Effective Permissions ")])):A("",!0),s("div",wS,[s("a",{class:"text-muted small",role:"button",onClick:T[6]||(T[6]=F=>c.value=!c.value)},w(c.value?"Hide":"Show")+" raw input ",1),c.value?(r(),l("div",kS,[T[19]||(T[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:ee(["form-control form-control-sm",y.value]),value:n.formData.allowed_tools,onInput:T[7]||(T[7]=F=>E.$emit("update:form-data","allowed_tools",F.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,SS),T[20]||(T[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:T[8]||(T[8]=F=>E.$emit("update:form-data","capabilities",F.target.value)),placeholder:"python, testing, debugging"},null,40,ES)])):A("",!0)])]))}},TS=se(CS,[["__scopeId","data-v-e58aa2be"]]),xS={class:"advanced-tab"},AS={key:0,class:"alert alert-warning mb-3",role:"alert"},OS={class:"mb-3"},MS={for:"config-system-prompt",class:"form-label"},DS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},NS={key:1,class:"field-indicator modified",title:"Modified from template"},LS=["value","rows","placeholder"],jS={class:"form-text"},IS={class:"mb-3 form-check"},PS=["checked"],RS={key:0,class:"form-text text-warning"},WS={key:1,class:"mb-3 form-check"},HS=["checked"],BS={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=v(()=>t.mode==="create-session"||t.mode==="edit-session"),a=v(()=>t.mode==="create-template"||t.mode==="edit-template"),c=v(()=>t.mode==="edit-session"),m=v(()=>t.session?.state==="active"||t.session?.state==="starting"),p=v(()=>{if(!t.session)return!1;const b=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),h=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),u=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return b||h||u}),f=v(()=>a.value?t.formData.system_prompt:t.formData.initialization_context),d=v(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),k=v(()=>t.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),g=v(()=>{const b={};return t.fieldStates.initialization_context==="autofilled"&&(b["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&(b["field-modified"]=!0),b});function $(b){const h=b.target.value,u=a.value?"system_prompt":"initialization_context";o("update:form-data",u,h)}return(b,h)=>(r(),l("div",xS,[c.value&&m.value&&p.value?(r(),l("div",AS,[...h[2]||(h[2]=[s("small",null,[ne("Changes to these settings require a "),s("strong",null,"reset"),ne(" (not restart) to take effect.")],-1)])])):A("",!0),s("div",OS,[s("label",MS,[ne(w(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(r(),l("span",DS," < ")):A("",!0),n.fieldStates.initialization_context==="modified"?(r(),l("span",NS," * ")):A("",!0)]),s("textarea",{id:"config-system-prompt",class:ee(["form-control",g.value]),value:f.value,onInput:$,rows:a.value?4:5,placeholder:d.value},null,42,LS),s("div",jS,w(k.value),1)]),s("div",IS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:h[0]||(h[0]=u=>b.$emit("update:form-data","override_system_prompt",u.target.checked))},null,40,PS),h[3]||(h[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(r(),l("div",RS,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+w(a.value?"":" or legion guide")+").",1)])):A("",!0)]),i.value?(r(),l("div",WS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:h[1]||(h[1]=u=>b.$emit("update:form-data","sandbox_enabled",u.target.checked))},null,40,HS),h[4]||(h[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:ee(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,w(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):A("",!0)]))}},FS=se(BS,[["__scopeId","data-v-08b1f06d"]]),VS={class:"modal-dialog modal-lg"},US={class:"modal-content"},qS={class:"modal-body"},zS={key:0,class:"text-center py-4"},KS={key:1,class:"alert alert-danger"},GS={key:2},YS={class:"mb-3"},JS={class:"small text-muted mb-2"},QS={key:0},XS={key:0,class:"alert alert-info"},ZS={key:1},eE={class:"table table-sm table-striped"},tE={key:2,class:"mt-3"},sE={class:"modal-footer"},nE=["disabled"],oE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=P(null);let c=null;const m=P(!1),p=P(""),f=P([]);pe(a,h=>{h&&(c=new dt(h),h.addEventListener("hidden.bs.modal",()=>{i("close")}))});function d(){c&&(c.show(),g())}function k(){c&&c.hide()}async function g(){m.value=!0,p.value="",f.value=[];try{const h=await ue.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=h.permissions||[]}catch(h){console.error("Failed to load permissions:",h),p.value=h.response?.data?.detail||h.message||"Failed to load permissions"}finally{m.value=!1}}function $(){g()}function b(h){switch(h){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:d,hide:k}),(h,u)=>(r(),l("div",{ref_key:"modalRef",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",VS,[s("div",US,[u[7]||(u[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",qS,[m.value?(r(),l("div",zS,[...u[0]||(u[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(r(),l("div",KS,w(p.value),1)):(r(),l("div",GS,[s("div",YS,[u[2]||(u[2]=s("h6",null,"Settings Sources",-1)),s("div",JS,[u[1]||(u[1]=ne(" Loading permissions from: ",-1)),(r(!0),l(ae,null,ce(n.settingSources,(y,_)=>(r(),l("span",{key:y},[s("code",null,w(y),1),_<n.settingSources.length-1?(r(),l("span",QS,", ")):A("",!0)]))),128))])]),f.value.length===0?(r(),l("div",XS," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(r(),l("div",ZS,[s("h6",null,"Pre-approved Permissions ("+w(f.value.length)+")",1),s("table",eE,[u[3]||(u[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(r(!0),l(ae,null,ce(f.value,y=>(r(),l("tr",{key:y.permission},[s("td",null,[s("code",null,w(y.permission),1)]),s("td",null,[(r(!0),l(ae,null,ce(y.sources,(_,C)=>(r(),l("span",{key:_,class:ee(["badge me-1",b(_)])},w(_),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(r(),l("div",tE,[u[4]||(u[4]=s("h6",null,"Session Allowed Tools",-1)),u[5]||(u[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(r(!0),l(ae,null,ce(n.sessionAllowedTools,y=>(r(),l("span",{key:y,class:"badge bg-success me-1 mb-1"},w(y),1))),128))])])):A("",!0)]))]),s("div",sE,[u[6]||(u[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:$,disabled:m.value}," Refresh ",8,nE)])])])],512))}},iE=se(oE,[["__scopeId","data-v-988ff7c4"]]),aE={class:"modal-dialog modal-lg modal-dialog-centered"},rE={class:"modal-content"},lE={class:"modal-header"},cE={id:"configurationModalLabel",class:"modal-title"},uE={class:"modal-body"},dE={key:0,class:"template-list-view"},mE={key:0,class:"alert alert-info"},pE={class:"card-body"},fE={class:"d-flex justify-content-between align-items-start"},vE={class:"flex-grow-1"},hE={class:"card-title mb-1"},_E={key:0,class:"card-text text-muted small mb-2"},gE={class:"template-meta"},bE={class:"badge bg-secondary me-2"},yE={class:"text-muted small"},$E={class:"btn-group btn-group-sm ms-3"},wE=["onClick"],kE=["onClick"],SE={key:1},EE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},CE={class:"nav-item",role:"presentation"},TE={key:0,class:"error-indicator",title:"This tab has validation errors"},xE={class:"nav-item",role:"presentation"},AE={key:0,class:"error-indicator",title:"This tab has validation errors"},OE={class:"nav-item",role:"presentation"},ME={key:0,class:"error-indicator",title:"This tab has validation errors"},DE={class:"tab-content"},NE={key:2,class:"alert alert-danger mt-3"},LE={class:"modal-footer"},jE={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},IE=["disabled"],PE={key:0,class:"spinner-border spinner-border-sm me-2"},RE={__name:"ConfigurationModal",setup(n){const e=Wt(),t=je(),o=de(),i=ve(),a=P(null);let c=null;const m=P(null),p=P("create-session"),f=P("general"),d=P(null),k=P(null),g=P(null),$=P([]),b=P(null),h=P(null),u=P({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),y=ys({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),_=ys({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),C=ys({name:""}),S=v(()=>({general:!!C.name,permissions:!1,advanced:!1})),j=P(!1),L=P(""),x=v(()=>p.value==="create-session"||p.value==="edit-session"),R=v(()=>p.value==="edit-session"||p.value==="edit-template"),E=v(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),T=v(()=>j.value?R.value?"Saving...":"Creating...":R.value?"Save Changes":x.value?"Create Session":"Save Template"),F=v(()=>!(!_.name.trim()||x.value&&_.name.includes(" "))),U=v(()=>k.value?.working_directory?k.value.working_directory:_.working_directory?_.working_directory:t.projects.get(d.value)?.working_directory||""),I=v(()=>!_.allowed_tools||!_.allowed_tools.trim()?[]:_.allowed_tools.split(",").map(q=>q.trim()).filter(q=>q.length>0));function H(){m.value&&m.value.show()}function V(q,re){_[q]=re,q==="name"&&(C.name="")}function X(q){b.value=q,N()}async function M(){try{const q=await ue.get("/api/templates");$.value=q||[]}catch(q){console.error("Failed to load templates:",q),$.value=[]}}function N(){if(!b.value){_.default_role="",_.initialization_context="",_.permission_mode="default",_.allowed_tools="",y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",u.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const q=$.value.find(re=>re.template_id===b.value);if(q)if(y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",q.default_role?(_.default_role=q.default_role,u.value.default_role=q.default_role,y.default_role="autofilled"):(_.default_role="",u.value.default_role=null),q.default_system_prompt?(_.initialization_context=q.default_system_prompt,u.value.initialization_context=q.default_system_prompt,y.initialization_context="autofilled"):(_.initialization_context="",u.value.initialization_context=null),q.permission_mode?(_.permission_mode=q.permission_mode,u.value.permission_mode=q.permission_mode,y.permission_mode="autofilled"):(_.permission_mode="default",u.value.permission_mode=null),q.allowed_tools&&q.allowed_tools.length>0){const re=q.allowed_tools.join(", ");_.allowed_tools=re,u.value.allowed_tools=re,y.allowed_tools="autofilled"}else _.allowed_tools="",u.value.allowed_tools=null}function O(){const re=(d.value?t.projects.get(d.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:re,currentPath:_.working_directory||"",onSelect:le=>{_.working_directory=le}})}function D(){p.value==="create-session"&&(h.value={mode:"create-session",projectId:d.value,formData:{..._},selectedTemplateId:b.value}),p.value="template-list",Z()}function z(){p.value="create-template",Z(),f.value="general"}function Q(q){p.value="edit-template",g.value=q,Z(),he(q),f.value="general"}async function J(q){if(confirm(`Delete template "${q.name}"?

This action cannot be undone.`))try{await ue.delete(`/api/templates/${q.template_id}`),await M()}catch(re){console.error("Failed to delete template:",re),L.value=re.response?.data?.detail||"Failed to delete template"}}function Y(){let q=!0;return C.name="",_.name.trim()||(C.name="Name is required",q=!1),x.value&&_.name.includes(" ")&&(C.name="Session name must be a single word (no spaces)",q=!1),q}async function te(){if(!Y()){C.name&&(f.value="general");return}j.value=!0,L.value="";try{switch(p.value){case"create-session":await fe(),c&&c.hide();break;case"edit-session":await G(),c&&c.hide();break;case"create-template":await W();break;case"edit-template":await B();break}}catch(q){console.error("Submit failed:",q),L.value=q.response?.data?.detail||q.message||"Operation failed. Please try again."}finally{j.value=!1}}async function fe(){if(!d.value)throw new Error("Project ID is missing");const q=_.allowed_tools.split(",").map(Pe=>Pe.trim()).filter(Pe=>Pe.length>0),re=_.capabilities.split(",").map(Pe=>Pe.trim()).filter(Pe=>Pe.length>0),le={name:_.name.trim(),model:_.model||null,role:_.default_role.trim()||null,initialization_context:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,capabilities:re.length>0?re:null,permission_mode:_.permission_mode,allowed_tools:q.length>0?q:null,working_directory:_.working_directory.trim()||null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources},Ce=await ue.post(`/api/legions/${d.value}/minions`,le);if(Ce.success&&Ce.minion_id)await t.fetchProjects(),await o.fetchSessions(),_.startImmediately&&await o.startSession(Ce.minion_id),e.push(`/session/${Ce.minion_id}`);else throw new Error("Failed to create session")}async function G(){if(!k.value)throw new Error("Session data is missing");const q=k.value.session_id,re=k.value.state==="active"||k.value.state==="starting",le=_.allowed_tools.split(",").map($e=>$e.trim()).filter($e=>$e.length>0),Ce=_.capabilities.split(",").map($e=>$e.trim()).filter($e=>$e.length>0),Pe={name:_.name.trim(),model:_.model,role:_.default_role.trim()||null,system_prompt:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,allowed_tools:le.length>0?le:null,capabilities:Ce.length>0?Ce:null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources};await o.patchSession(q,Pe),re&&_.permission_mode!==k.value.current_permission_mode&&await o.setPermissionMode(q,_.permission_mode)}async function W(){const q=_.allowed_tools.split(",").map(le=>le.trim()).filter(le=>le.length>0),re={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:q.length>0?q:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await ue.post("/api/templates",re),await M(),p.value="template-list",Z()}async function B(){if(!g.value)throw new Error("Template data is missing");const q=_.allowed_tools.split(",").map(le=>le.trim()).filter(le=>le.length>0),re={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:q.length>0?q:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await ue.put(`/api/templates/${g.value.template_id}`,re),await M(),p.value="template-list",g.value=null,Z()}function Z(){_.name="",_.model="sonnet",_.permission_mode="default",_.working_directory="",_.description="",_.default_role="",_.startImmediately=!0,_.allowed_tools="",_.capabilities="",_.setting_sources=["user","project","local"],_.system_prompt="",_.override_system_prompt=!1,_.initialization_context="",_.sandbox_enabled=!1,C.name="",y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",u.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},b.value=null,L.value="",f.value="general"}function ie(q){_.name=q.name||"",_.model=q.model||"sonnet",_.permission_mode=q.current_permission_mode||"default",_.working_directory=q.working_directory||"",_.default_role=q.role||"",_.initialization_context=q.system_prompt||"",_.override_system_prompt=q.override_system_prompt||!1,_.system_prompt="",_.allowed_tools=q.allowed_tools?.join(", ")||"",_.capabilities=q.capabilities?.join(", ")||"",_.sandbox_enabled=q.sandbox_enabled||!1,_.setting_sources=q.setting_sources||["user","project","local"]}function he(q){_.name=q.name||"",_.description=q.description||"",_.permission_mode=q.permission_mode||"default",_.default_role=q.default_role||"",_.initialization_context=q.default_system_prompt||"",_.allowed_tools=q.allowed_tools?.join(", ")||""}function nt(){wt(()=>{const q=document.getElementById("config-name");q&&(q.focus(),R.value&&q.select())})}function Be(){Z(),p.value="create-session",d.value=null,k.value=null,g.value=null,i.hideModal()}return pe(()=>i.currentModal,async(q,re)=>{if(!(!q||!c)){if(q.name==="configuration"){const le=q.data||{};p.value=le.mode||"create-session",d.value=le.project?.project_id||le.projectId||null,k.value=le.session||null,g.value=le.template||null,Z(),p.value==="create-session"&&await M(),p.value==="edit-session"&&k.value?ie(k.value):p.value==="edit-template"&&g.value&&he(g.value),c.show()}else if(q.name==="create-minion"||q.name==="create-session"){const le=q.data||{};p.value="create-session",d.value=le.project?.project_id||null,k.value=null,g.value=null,Z(),await M(),c.show()}else if(q.name==="edit-session"){const le=q.data||{};p.value="edit-session",k.value=le.session||null,d.value=k.value?.project_id||null,g.value=null,Z(),k.value&&ie(k.value),c.show()}else q.name==="template-management"&&(p.value="template-list",Z(),await M(),c.show());re?.name==="configuration"&&re.data?.mode?.includes("template")&&q?.name==="configuration"&&p.value==="create-session"&&await M()}}),pe(()=>_.default_role,q=>{u.value.default_role!==null&&(y.default_role=q===u.value.default_role?"autofilled":"modified")}),pe(()=>_.initialization_context,q=>{u.value.initialization_context!==null&&(y.initialization_context=q===u.value.initialization_context?"autofilled":"modified")}),pe(()=>_.permission_mode,q=>{u.value.permission_mode!==null&&(y.permission_mode=q===u.value.permission_mode?"autofilled":"modified")}),pe(()=>_.allowed_tools,q=>{u.value.allowed_tools!==null&&(y.allowed_tools=q===u.value.allowed_tools?"autofilled":"modified")}),ye(()=>{a.value&&Me(()=>import("./modal-D6mKceGM.js").then(q=>q.m),__vite__mapDeps([0,1])).then(q=>{const re=q.default;c=new re(a.value),a.value.addEventListener("shown.bs.modal",nt),a.value.addEventListener("hidden.bs.modal",Be)})}),Ee(()=>{a.value&&(a.value.removeEventListener("shown.bs.modal",nt),a.value.removeEventListener("hidden.bs.modal",Be)),c&&c.dispose()}),(q,re)=>(r(),l(ae,null,[s("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",aE,[s("div",rE,[s("div",lE,[s("h5",cE,[p.value==="create-template"||p.value==="edit-template"?(r(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:D,title:"Back to template list"}," â† ")):A("",!0),ne(" "+w(E.value),1)]),re[3]||(re[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",uE,[p.value==="template-list"?(r(),l("div",dE,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[re[4]||(re[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:z,class:"btn btn-primary btn-sm"}," + Create New ")]),$.value.length===0?(r(),l("div",mE," No templates found. Create your first template! ")):A("",!0),(r(!0),l(ae,null,ce($.value,le=>(r(),l("div",{key:le.template_id,class:"card mb-2"},[s("div",pE,[s("div",fE,[s("div",vE,[s("h6",hE,w(le.name),1),le.description?(r(),l("p",_E,w(le.description),1)):A("",!0),s("div",gE,[s("span",bE,w(le.permission_mode),1),s("span",yE,w(le.allowed_tools?.length||0)+" tools",1)])]),s("div",$E,[s("button",{onClick:Ce=>Q(le),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,wE),s("button",{onClick:Ce=>J(le),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,kE)])])])]))),128))])):(r(),l("div",SE,[s("ul",EE,[s("li",CE,[s("button",{class:ee(["nav-link",{active:f.value==="general","has-error":S.value.general}]),type:"button",onClick:re[0]||(re[0]=le=>f.value="general")},[re[5]||(re[5]=ne(" General ",-1)),S.value.general?(r(),l("span",TE)):A("",!0)],2)]),s("li",xE,[s("button",{class:ee(["nav-link",{active:f.value==="permissions","has-error":S.value.permissions}]),type:"button",onClick:re[1]||(re[1]=le=>f.value="permissions")},[re[6]||(re[6]=ne(" Permissions ",-1)),S.value.permissions?(r(),l("span",AE)):A("",!0)],2)]),s("li",OE,[s("button",{class:ee(["nav-link",{active:f.value==="advanced","has-error":S.value.advanced}]),type:"button",onClick:re[2]||(re[2]=le=>f.value="advanced")},[re[7]||(re[7]=ne(" Advanced ",-1)),S.value.advanced?(r(),l("span",ME)):A("",!0)],2)])]),s("div",DE,[ge(me(Bk,{mode:p.value,"form-data":_,errors:C,templates:$.value,"selected-template-id":b.value,session:k.value,"field-states":y,"onUpdate:formData":V,"onUpdate:selectedTemplateId":X,onOpenFolderBrowser:O,onOpenTemplateManager:D},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[bs,f.value==="general"]]),ge(me(TS,{mode:p.value,"form-data":_,errors:C,session:k.value,"field-states":y,"onUpdate:formData":V,onPreviewPermissions:H},null,8,["mode","form-data","errors","session","field-states"]),[[bs,f.value==="permissions"]]),ge(me(FS,{mode:p.value,"form-data":_,errors:C,session:k.value,"field-states":y,"onUpdate:formData":V},null,8,["mode","form-data","errors","session","field-states"]),[[bs,f.value==="advanced"]])])])),L.value?(r(),l("div",NE,w(L.value),1)):A("",!0)]),s("div",LE,[s("button",jE,w(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(r(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:j.value||!F.value,onClick:te},[j.value?(r(),l("span",PE)):A("",!0),ne(" "+w(T.value),1)],8,IE)):A("",!0)])])])],512),me(iE,{ref_key:"permissionPreviewModal",ref:m,"working-directory":U.value,"setting-sources":_.setting_sources,"session-allowed-tools":I.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},WE=se(RE,[["__scopeId","data-v-098a9c63"]]),HE={class:"modal-dialog modal-dialog-centered"},BE={class:"modal-content"},FE={class:"modal-header"},VE={class:"modal-title",id:"manageSessionModalLabel"},UE={class:"modal-body"},qE={key:0,class:"text-center py-4"},zE={class:"text-muted"},KE={key:1},GE={key:2},YE={class:"text-muted"},JE={key:0,class:"text-center py-2"},QE={key:1,class:"alert alert-warning mt-3"},XE={class:"mb-0 mt-2"},ZE={key:0,class:"text-muted"},eC={key:3},tC={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},sC={class:"d-grid gap-2"},nC=["disabled"],oC=["disabled"],iC=["disabled"],aC=["disabled"],rC={class:"modal-footer"},lC={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},cC={__name:"SessionManageModal",setup(n){const e=Wt(),t=de(),o=ve(),i=Ze();Te();const a=P(null),c=P(!1),m=P(""),p=P(""),f=P(null),d=P(null);let k=null;const g=P([]),$=P(!1),b=v(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function h(){f.value="reset"}async function u(){if(f.value="delete",g.value=[],!!a.value){$.value=!0;try{const E=await ue.get(`/api/sessions/${a.value.session_id}/descendants`);g.value=E.descendants||[]}catch(E){console.error("Failed to fetch descendants:",E),g.value=[]}finally{$.value=!1}}}function y(){f.value=null}async function _(){f.value==="reset"?await j():f.value==="delete"&&await L()}async function C(){if(a.value){c.value=!0,m.value="Restarting session...";try{const E=a.value.session_id,T=t.currentSessionId===E,F=await ue.post(`/api/sessions/${E}/restart`);if(F.success)console.log("Session restarted successfully"),T&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(E)),k&&k.hide();else{const U=F.error||F.detail||"Failed to restart session";console.error("Failed to restart session:",U),p.value=`Failed to restart session: ${U}`}}catch(E){console.error("Error restarting session:",E);const T=E.data?.detail||E.message||"Unknown error";p.value=`Error restarting session: ${T}`}finally{c.value=!1}}}async function S(){if(a.value)try{k&&k.hide(),console.log("Ending session",a.value.session_id);const E=a.value.session_id;await ue.post(`/api/sessions/${E}/terminate`),t.currentSessionId===E&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(E){console.error("Error ending session:",E),t.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function j(){if(a.value){c.value=!0,m.value="Resetting session...";try{const E=a.value.session_id,T=t.currentSessionId===E,F=await ue.post(`/api/sessions/${E}/reset`);if(F.success)console.log("Session reset successfully"),T&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(E)),k&&k.hide();else{const U=F.error||F.detail||"Failed to reset session";console.error("Failed to reset session:",U),p.value=`Failed to reset session: ${U}`,f.value=null}}catch(E){console.error("Error resetting session:",E);const T=E.data?.detail||E.message||"Unknown error";p.value=`Error resetting session: ${T}`,f.value=null}finally{c.value=!1}}}async function L(){if(a.value){c.value=!0,m.value="Deleting session...";try{const E=a.value.session_id;await t.deleteSession(E),e.currentRoute.value.params.sessionId===E&&e.push("/"),k&&k.hide()}catch(E){console.error("Error deleting session:",E);const T=E.data?.detail||E.message||"Unknown error";p.value=`Error deleting session: ${T}`,f.value=null}finally{c.value=!1}}}function x(){f.value=null,c.value=!1,m.value="",p.value="",g.value=[],$.value=!1}function R(){x(),a.value=null,o.hideModal()}return pe(()=>o.currentModal,E=>{if(E?.name==="manage-session"&&k){const T=E.data||{};a.value=T.session,x(),k.show()}}),ye(()=>{d.value&&Me(async()=>{const{default:E}=await import("./modal-D6mKceGM.js").then(T=>T.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{k=new E(d.value),d.value.addEventListener("hidden.bs.modal",R)})}),Ee(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",R),k&&k.dispose()}),(E,T)=>(r(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",HE,[s("div",BE,[s("div",FE,[s("h5",VE,w(f.value?b.value:"Manage Session"),1),T[1]||(T[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",UE,[c.value?(r(),l("div",qE,[T[2]||(T[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",zE,w(m.value),1)])):f.value==="reset"?(r(),l("div",KE,[...T[3]||(T[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(r(),l("div",GE,[T[9]||(T[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",YE,[T[4]||(T[4]=ne("This will permanently delete session ",-1)),s("strong",null,w(a.value?.name),1),T[5]||(T[5]=ne(".",-1))]),T[10]||(T[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),$.value?(r(),l("div",JE,[...T[6]||(T[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(r(),l("div",QE,[T[7]||(T[7]=s("strong",null,"Cascading Deletion:",-1)),T[8]||(T[8]=ne(" This session has ",-1)),s("strong",null,w(g.value.length),1),ne(" child session"+w(g.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",XE,[(r(!0),l(ae,null,ce(g.value,F=>(r(),l("li",{key:F.session_id,class:"small"},[s("strong",null,w(F.name||F.session_id),1),F.role?(r(),l("span",ZE," ("+w(F.role)+")",1)):A("",!0)]))),128))])])):A("",!0)])):(r(),l("div",eC,[p.value?(r(),l("div",tC,[T[11]||(T[11]=s("strong",null,"Error:",-1)),ne(" "+w(p.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:T[0]||(T[0]=F=>p.value="")})])):A("",!0),T[18]||(T[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",sC,[s("button",{class:"btn btn-outline-primary text-start",onClick:C,disabled:c.value},[...T[12]||(T[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,nC),s("button",{class:"btn btn-outline-secondary text-start",onClick:S,disabled:c.value},[...T[13]||(T[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,oC),T[16]||(T[16]=s("hr",{class:"my-2"},null,-1)),T[17]||(T[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:h,disabled:c.value},[...T[14]||(T[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,iC),s("button",{class:"btn btn-outline-danger text-start",onClick:u,disabled:c.value},[...T[15]||(T[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,aC)]),T[19]||(T[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ne(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",rC,[f.value&&!c.value?(r(),l(ae,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancel"),s("button",{type:"button",class:ee(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:_},w(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?A("",!0):(r(),l("button",lC,"Cancel"))])])])],512))}},uC=se(cC,[["__scopeId","data-v-6b832853"]]),dC={class:"modal-dialog modal-dialog-centered modal-lg"},mC={class:"modal-content"},pC={class:"modal-body"},fC={key:0,class:"text-center text-muted py-4"},vC={key:1},hC={class:"mb-3"},_C={class:"font-monospace small"},gC={class:"mb-3"},bC=["value"],yC={class:"mb-3"},$C={class:"mb-3"},wC={class:"mb-3"},kC={key:0},SC={class:"d-flex flex-wrap gap-1"},EC={key:1,class:"text-muted small"},CC={key:0,class:"mb-3"},TC={class:"d-flex flex-wrap gap-1"},xC={key:1,class:"mb-3"},AC={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},OC={class:"mb-3"},MC={class:"text-muted"},DC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},NC={__name:"SessionInfoModal",setup(n){const e=de(),t=Te(),o=ve(),i=P(null),a=P(!1),c=P(null);let m=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=v(()=>{if(!i.value)return null;const h=e.initData.get(i.value);return h||(t.messagesBySession.get(i.value)||[]).find(_=>_.type==="system"&&(_.subtype==="init"||_.metadata?.subtype==="init")&&_.metadata?.init_data)?.metadata?.init_data||null});function d(h){return h?p[h]||h:"Default (Sonnet 4.5)"}function k(h){return typeof h=="string"?h:typeof h=="object"&&h.type==="preset"?`Preset: ${h.preset}`:JSON.stringify(h,null,2)}function g(h){h.target.select()}function $(){i.value=null,a.value=!1}function b(){$(),o.hideModal()}return pe(()=>o.currentModal,h=>{if(h?.name==="session-info"&&m){const u=h.data||{};i.value=u.sessionId,a.value=!1,m.show()}}),ye(()=>{c.value&&Me(async()=>{const{default:h}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:h}},__vite__mapDeps([0,1])).then(({default:h})=>{m=new h(c.value),c.value.addEventListener("hidden.bs.modal",b)})}),Ee(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",b),m&&m.dispose()}),(h,u)=>(r(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",dC,[s("div",mC,[u[9]||(u[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",pC,[f.value?(r(),l("div",vC,[s("div",hC,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",_C,w(i.value),1)]),s("div",gC,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:g},null,8,bC)]),s("div",yC,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,w(d(f.value.model)),1)]),s("div",$C,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,w(f.value.permissionMode||"default"),1)]),s("div",wC,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(r(),l("div",kC,[s("div",SC,[(r(!0),l(ae,null,ce(f.value.allowed_tools||f.value.tools,y=>(r(),l("span",{key:y,class:"badge bg-secondary"},w(y),1))),128))])])):(r(),l("div",EC,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(r(),l("div",CC,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",TC,[(r(!0),l(ae,null,ce(f.value.commands,y=>(r(),l("span",{key:y,class:"badge bg-info"},w(y),1))),128))])])):A("",!0),f.value.systemPrompt?(r(),l("div",xC,[u[7]||(u[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",AC,w(k(f.value.systemPrompt)),1)])):A("",!0),s("div",OC,[s("h6",MC,[u[8]||(u[8]=ne(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:u[0]||(u[0]=y=>a.value=!a.value)},w(a.value?"Hide":"Show"),1)]),a.value?(r(),l("pre",DC,w(JSON.stringify(f.value,null,2)),1)):A("",!0)])])):(r(),l("div",fC," No session configuration data available "))]),u[10]||(u[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},LC=se(NC,[["__scopeId","data-v-b28b39b3"]]),jC={class:"modal-dialog modal-dialog-centered modal-lg"},IC={class:"modal-content"},PC={class:"modal-body"},RC={key:0,class:"text-center text-muted py-4"},WC={key:1},HC={class:"mb-3"},BC={class:"mb-3"},FC={class:"font-monospace small"},VC={class:"mb-3"},UC={class:"mb-3"},qC={class:"mb-3"},zC={key:0},KC={class:"d-flex flex-wrap gap-1"},GC={key:1,class:"text-muted small"},YC={class:"mb-3"},JC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},QC={key:1,class:"text-muted small"},XC={class:"mb-3"},ZC={key:0,class:"badge bg-info"},eT={key:1,class:"badge bg-secondary"},tT={class:"mb-3"},sT={key:0,class:"font-monospace small"},nT={key:1,class:"text-muted small"},oT={key:0,class:"mb-3"},iT={key:0},aT={class:"list-unstyled mb-0"},rT={key:1,class:"text-muted small"},lT={class:"mb-3"},cT={class:"small"},uT={class:"mb-3"},dT={class:"small"},mT={__name:"MinionViewModal",setup(n){const e=ve(),t=P(null),o=P(null);let i=null;function a(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function c(f){if(!f)return"N/A";try{const d=new Date(f);return isNaN(d.getTime())?"Invalid date":d.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(d){return console.error("Error formatting timestamp:",d),"Invalid date"}}function m(){t.value=null}function p(){m(),e.hideModal()}return pe(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const d=f.data||{};t.value=d.session,i.show()}}),ye(()=>{o.value&&Me(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),Ee(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(f,d)=>(r(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",jC,[s("div",IC,[d[11]||(d[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",PC,[t.value?(r(),l("div",WC,[s("div",HC,[d[0]||(d[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,w(t.value.name||"Unnamed Minion"),1)]),s("div",BC,[d[1]||(d[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",FC,w(t.value.session_id),1)]),s("div",VC,[d[2]||(d[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,w(t.value.role||"Not specified"),1)]),s("div",UC,[d[3]||(d[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:ee(["badge",a(t.value.state)])},w(t.value.state),3)])]),s("div",qC,[d[4]||(d[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(r(),l("div",zC,[s("div",KC,[(r(!0),l(ae,null,ce(t.value.capabilities,k=>(r(),l("span",{key:k,class:"badge bg-secondary"},w(k),1))),128))])])):(r(),l("div",GC,"None"))]),s("div",YC,[d[5]||(d[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(r(),l("div",JC,w(t.value.initialization_context),1)):(r(),l("div",QC,"Not specified"))]),s("div",XC,[d[6]||(d[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(r(),l("span",ZC,"Yes")):(r(),l("span",eT,"No"))])]),s("div",tT,[d[7]||(d[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(r(),l("div",sT,w(t.value.parent_overseer_id),1)):(r(),l("div",nT," Root overseer (user-created) "))]),t.value.is_overseer?(r(),l("div",oT,[d[8]||(d[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(r(),l("div",iT,[s("ul",aT,[(r(!0),l(ae,null,ce(t.value.child_minion_ids,k=>(r(),l("li",{key:k,class:"font-monospace small"},w(k),1))),128))])])):(r(),l("div",rT,"No children"))])):A("",!0),s("div",lT,[d[9]||(d[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",cT,w(c(t.value.created_at)),1)]),s("div",uT,[d[10]||(d[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",dT,w(c(t.value.updated_at)),1)])])):(r(),l("div",RC," No minion data available "))]),d[12]||(d[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},pT=se(mT,[["__scopeId","data-v-d996dc6f"]]),fT={class:"container-fluid vh-100 d-flex flex-column p-0"},vT={class:"d-flex flex-grow-1 overflow-hidden position-relative"},hT={class:"flex-grow-1 d-flex flex-column overflow-hidden"},_T={__name:"App",setup(n){const e=ve(),t=Ze(),o=de(),i=je(),a=$t(),c=Wt(),m=v(()=>e.sidebarCollapsed),p=v(()=>e.rightSidebarCollapsed),f=v(()=>e.isMobile);pe(()=>a.currentHasTasks,($,b)=>{$&&!b&&e.setRightSidebarCollapsed(!1)}),ye(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const $=window.location.hash;if($.startsWith("#/session/")){const b=$.replace("#/session/","");o.sessions.has(b)&&await o.selectSession(b)}else if($.startsWith("#/timeline/")){const b=$.replace("#/timeline/","");c.push(`/timeline/${b}`)}window.addEventListener("popstate",d),window.addEventListener("resize",e.handleResize)}),Ee(()=>{window.removeEventListener("popstate",d),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function d(){const $=window.location.hash;if($.startsWith("#/session/")){const b=$.replace("#/session/","");o.sessions.has(b)&&o.selectSession(b)}}function k(){e.toggleSidebar()}function g(){e.toggleRightSidebar()}return($,b)=>{const h=co("router-view");return r(),l("div",fT,[me(J1),s("div",{id:"sidebar-backdrop",class:ee({show:!m.value&&f.value}),onClick:k},null,2),s("div",{id:"right-sidebar-backdrop",class:ee({show:!p.value&&f.value}),onClick:g},null,2),s("div",vT,[me(C$),s("main",hT,[me(h)]),me(Q$)]),me(fw),me(Ow),me(Xw),me(WE),me(uC),me(LC),me(pT)])}}},ln=ki(_T);ln.use(Si());ln.use(B1);ln.mount("#app");
