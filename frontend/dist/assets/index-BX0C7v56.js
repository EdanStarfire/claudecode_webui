const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as m,a as n,o as u,d as xt,r as I,b as v,t as E,n as bt,e as X,f as Z,u as ts,w as de,g as _s,F as ie,h as ae,i as O,j as ye,k as oo,l as _e,v as We,m as Be,p as he,q as me,s as ge,x as pi,y as ss,z as Se,A as fn,B as io,C as Pt,D as fi,E as vi,G as hi,H as gs,I as bs,J as _i,K as gi}from"./vue-vendor-tGvtV_pt.js";import{m as at,p as rs}from"./markdown-vendor-BRsjnVvP.js";import{c as bi}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const yi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},wi={__name:"NoSessionSelected",setup(s){return(e,t)=>(u(),m("div",yi,[...t[0]||(t[0]=[n("h2",{class:"text-muted"},"No Session Selected",-1),n("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},$i="modulepreload",Ei=function(s){return"/"+s},vn={},xe=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let p=function(f){return Promise.all(f.map(c=>Promise.resolve(c).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),d=r?.nonce||r?.getAttribute("nonce");i=p(t.map(f=>{if(f=Ei(f),f in vn)return;vn[f]=!0;const c=f.endsWith(".css"),$=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${$}`))return;const g=document.createElement("link");if(g.rel=c?"stylesheet":$i,c||(g.as="script"),g.crossOrigin="",g.href=f,d&&g.setAttribute("nonce",d),document.head.appendChild(g),c)return new Promise((y,w)=>{g.addEventListener("load",y),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(r){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=r,window.dispatchEvent(d),!d.defaultPrevented)throw r}return i.then(r=>{for(const d of r||[])d.status==="rejected"&&a(d.reason);return e().catch(a)})};class ys extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function yt(s,e={}){try{const t=await fetch(s,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new ys(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof ys?t:(console.error("API request failed:",t),new ys(`Network error: ${t.message}`,0,null))}}async function Si(s,e={}){let t=s;if(e.params){const o=new URLSearchParams;for(const[d,p]of Object.entries(e.params))p!=null&&o.append(d,p);const i=o.toString();i&&(t=`${s}?${i}`);const{params:a,...r}=e;return yt(t,{...r,method:"GET"})}return yt(t,{...e,method:"GET"})}async function Ci(s,e,t={}){return yt(s,{...t,method:"POST",body:JSON.stringify(e)})}async function ki(s,e,t={}){return yt(s,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ti(s,e={}){return yt(s,{...e,method:"DELETE"})}async function xi(s,e,t={}){return yt(s,{...t,method:"PATCH",body:JSON.stringify(e)})}const oe={get:Si,post:Ci,put:ki,delete:Ti,patch:xi},le=xt("session",()=>{const s=I(new Map),e=I(null),t=I(new Map),o=I(new Map),i=I(new Set),a=I(!1);let r=null;const d=v(()=>s.value.get(e.value)),p=v(()=>Array.from(s.value.values()).sort((L,F)=>L.order-F.order)),f=L=>v(()=>p.value.filter(F=>F.project_id===L)),c=v({get:()=>t.value.get(e.value)||"",set:L=>{e.value&&t.value.set(e.value,L)}});async function $(){try{const L=await oe.get("/api/sessions");return s.value.clear(),L.sessions.forEach(F=>{s.value.set(F.session_id,F)}),console.log(`Loaded ${s.value.size} sessions`),L.sessions}catch(L){throw console.error("Failed to fetch sessions:",L),L}}async function g(L,F){try{const A=(await oe.post("/api/sessions",{project_id:L,...F})).session_id,H=(await oe.get(`/api/sessions/${A}`)).session;return s.value.set(A,H),s.value=new Map(s.value),console.log(`Created session ${A}`),H}catch(C){throw console.error("Failed to create session:",C),C}}async function y(L){if(e.value===L&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${L}`),r.abort(),r=null);const F=new AbortController;r=F,a.value=!0;try{if(e.value=L,F.signal.aborted){console.log(`Selection of ${L} aborted early`);return}let C=s.value.get(L);if(!C)try{const H=await oe.get(`/api/sessions/${L}`);if(F.signal.aborted){console.log(`Selection of ${L} aborted after fetch`);return}C=H.session,s.value.set(L,C),s.value=new Map(s.value),console.log(`Fetched session ${L} for deeplink`)}catch(H){console.error(`Failed to fetch session ${L}:`,H);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await _(L),F.signal.aborted){console.log(`Selection of ${L} aborted after start`);return}console.log(`Auto-started session ${L} (was in ${C.state} state)`);const H=6e4,T=200,S=5e3;let N=0,M=0;for(;N<H;){if(F.signal.aborted){console.log(`Selection of ${L} aborted during state wait`);return}const j=s.value.get(L);if(j&&j.state==="active"){console.log(`Session ${L} is now active after ${N}ms`);break}if(N-M>=S){const U=s.value.get(L)?.state||"unknown";console.log(`Waiting for session ${L} to become active (current: ${U}, ${N/1e3}s elapsed)`),M=N}await new Promise(U=>setTimeout(U,T)),N+=T}const k=s.value.get(L);k&&k.state!=="active"&&console.warn(`Session ${L} did not become active within ${H/1e3}s (state: ${k.state}), continuing anyway`)}catch(H){console.error(`Failed to auto-start session ${L}:`,H)}if(F.signal.aborted){console.log(`Selection of ${L} aborted before message load`);return}if(await(await xe(()=>Promise.resolve().then(()=>Gi),void 0)).useMessageStore().loadMessages(L),F.signal.aborted){console.log(`Selection of ${L} aborted after message load`);return}await(await xe(()=>Promise.resolve().then(()=>va),void 0)).useWebSocketStore().connectSession(L),F.signal.aborted||console.log(`Selected session ${L}`)}finally{r===F&&(r=null),a.value=!1}}function w(L,F){const C=s.value.get(L);C?Object.assign(C,F):(s.value.set(L,F),console.log(`Added new session ${L} via WebSocket update`)),s.value=new Map(s.value)}async function b(L){i.value.add(L);try{const C=(await oe.delete(`/api/sessions/${L}`)).deleted_session_ids||[L];for(const A of C)s.value.delete(A),t.value.delete(A),o.value.delete(A);return s.value=new Map(s.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(F){throw console.error("Failed to delete session:",F),F}finally{i.value.delete(L)}}async function l(L,F){try{await oe.patch(`/api/sessions/${L}`,F),w(L,F),console.log(`Updated session ${L}:`,F)}catch(C){throw console.error("Failed to update session:",C),C}}async function h(L,F){try{await oe.post(`/api/sessions/${L}/permission-mode`,{mode:F}),w(L,{current_permission_mode:F});const C=o.value.get(L);C&&(C.permissionMode=F,o.value.set(L,C)),console.log(`Set permission mode for session ${L} to ${F}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function _(L){try{await oe.post(`/api/sessions/${L}/start`),console.log(`Started session ${L}`)}catch(F){throw console.error("Failed to start session:",F),F}}async function x(L){try{await oe.post(`/api/sessions/${L}/pause`),console.log(`Paused session ${L}`)}catch(F){throw console.error("Failed to pause session:",F),F}}async function D(L){try{await oe.post(`/api/sessions/${L}/terminate`),console.log(`Terminated session ${L}`)}catch(F){throw console.error("Failed to terminate session:",F),F}}function q(L){return s.value.get(L)}function K(L,F){o.value.set(L,F),F.permissionMode&&w(L,{current_permission_mode:F.permissionMode})}return{sessions:s,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:d,orderedSessions:p,sessionsInProject:f,currentInput:c,fetchSessions:$,createSession:g,selectSession:y,updateSession:w,deleteSession:b,patchSession:l,setPermissionMode:h,startSession:_,pauseSession:x,terminateSession:D,getSession:q,storeInitData:K}}),hn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:le},Symbol.toStringTag,{value:"Module"})),ve=xt("ui",()=>{const s=I(window.innerWidth<768),e=I(300),t=I(window.innerWidth),o=v(()=>t.value<768),i=I(!0),a=I(null),r=I(null),d=v(()=>a.value?{name:a.value,data:r.value}:null),p=I(!1),f=I("Loading...");function c(){s.value=!s.value}function $(x){s.value=x}function g(x){e.value=Math.max(200,Math.min(x,window.innerWidth*.3))}function y(x){i.value=x}function w(x,D=null){a.value=null,r.value=null,setTimeout(()=>{a.value=x,r.value=D},0)}function b(){a.value=null,r.value=null}function l(x="Loading..."){p.value=!0,f.value=x}function h(){p.value=!1}function _(){const x=t.value;t.value=window.innerWidth,t.value<768&&x>=768?s.value=!0:t.value>=768&&x<768&&(s.value=!1)}return{sidebarCollapsed:s,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:d,isLoading:p,loadingMessage:f,toggleSidebar:c,setSidebarCollapsed:$,setSidebarWidth:g,setAutoScroll:y,showModal:w,hideModal:b,showLoading:l,hideLoading:h,handleResize:_}}),Ne=xt("project",()=>{const s=I(new Map),e=I(null),t=v(()=>s.value.get(e.value)),o=v(()=>Array.from(s.value.values()).sort((l,h)=>l.order-h.order));async function i(){try{const l=await oe.get("/api/projects");return s.value.clear(),l.projects.forEach(h=>{s.value.set(h.project_id,h)}),console.log(`Loaded ${s.value.size} projects`),l.projects}catch(l){throw console.error("Failed to fetch projects:",l),l}}async function a(l,h){try{const x=(await oe.post("/api/projects",{name:l,working_directory:h})).project;return s.value.set(x.project_id,x),s.value=new Map(s.value),console.log(`Created project ${x.project_id}`),x}catch(_){throw console.error("Failed to create project:",_),_}}async function r(l,h){try{await oe.put(`/api/projects/${l}`,h),d(l,h),console.log(`Updated project ${l}`,h)}catch(_){throw console.error("Failed to update project:",_),_}}function d(l,h){const _=s.value.get(l);_&&(Object.assign(_,h),s.value=new Map(s.value))}async function p(l){try{await oe.delete(`/api/projects/${l}`),s.value.delete(l),s.value=new Map(s.value),e.value===l&&(e.value=null),console.log(`Deleted project ${l}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function f(l){try{const h=await oe.put(`/api/projects/${l}/toggle-expansion`),_=s.value.get(l);return _&&(_.is_expanded=h.is_expanded,s.value=new Map(s.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function c(l){try{await oe.put("/api/projects/reorder",{project_ids:l}),l.forEach((h,_)=>{const x=s.value.get(h);x&&(x.order=_)}),s.value=new Map(s.value),console.log("Reordered projects",l)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function $(l,h){try{await oe.put(`/api/projects/${l}/sessions/reorder`,{session_ids:h});const _=s.value.get(l);_&&(_.session_ids=h,s.value=new Map(s.value)),console.log(`Reordered sessions in project ${l}`,h)}catch(_){throw console.error("Failed to reorder sessions:",_),_}}function g(l){return s.value.get(l)}function y(l){e.value=l}function w(){e.value=null}function b(l){if(!l)return"";const h=l.split(/[/\\]/).filter(_=>_);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:s,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:a,updateProject:r,updateProjectLocal:d,deleteProject:p,toggleExpansion:f,reorderProjects:c,reorderSessionsInProject:$,getProject:g,selectProject:y,clearProjectSelection:w,formatPath:b}}),se=(s,e)=>{const t=s.__vccOpts||s;for(const[o,i]of e)t[o]=i;return t},Ai={class:"session-header border-bottom p-3"},Mi={class:"project-name"},Oi=["title"],Di={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(s){const e=s,t=le(),o=Ne(),i=v(()=>t.sessions.get(e.sessionId)),a=v(()=>i.value?.name||e.sessionId),r=v(()=>{for(const p of o.projects.values())if(p.session_ids?.includes(e.sessionId))return p;return null}),d=v(()=>r.value?.name||"Unknown Project");return(p,f)=>(u(),m("div",Ai,[n("div",null,[n("div",Mi,E(d.value),1),n("div",{class:"session-name",title:s.sessionId},E(a.value),9,Oi)])]))}},Ni=se(Di,[["__scopeId","data-v-89e9c269"]]),Li={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ii=["title"],ji={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Pi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(s){const e=s,t=le(),o=v(()=>t.sessions.get(e.sessionId)),i=v(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=v(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),r=v(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),d=v(()=>{if(!o.value)return"No session selected";const p=i.value,f=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",$=o.value.role?` (${o.value.role})`:"";return`${c}${$}: ${f}`});return(p,f)=>(u(),m("div",Li,[o.value?(u(),m("div",{key:0,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:bt({width:"100%",backgroundColor:a.value}),title:d.value},null,14,Ii)):(u(),m("div",ji))]))}},Ri=se(Pi,[["__scopeId","data-v-63d222fe"]]),Wi={class:"session-status-bar border-top p-2 bg-light"},Hi={class:"d-flex justify-content-between align-items-center gap-2"},Vi={class:"d-flex gap-2"},Fi=["disabled"],Bi={class:"mode-label"},Ui=["disabled"],qi=["disabled"],zi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(s){const e=s,t=le(),o=ve(),i=v(()=>t.sessions.get(e.sessionId)),a=v(()=>i.value?.current_permission_mode||"default"),r={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},d=v(()=>r[a.value]||"ðŸ”’"),p=v(()=>a.value),f=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const b=(f.indexOf(a.value)+1)%f.length,l=f[b];try{await t.setPermissionMode(e.sessionId,l)}catch(h){console.error("Failed to cycle permission mode:",h)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},y=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(w,b)=>(u(),m("div",Wi,[n("div",Hi,[n("div",Vi,[n("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[Z(E(d.value)+" ",1),n("span",Bi,E(p.value),1)],8,Fi),n("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...b[0]||(b[0]=[Z(" â„¹ï¸ ",-1),n("span",{class:"button-label"},"Info",-1)])],8,Ui),n("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...b[1]||(b[1]=[Z(" âš™ï¸ ",-1),n("span",{class:"button-label"},"Manage",-1)])],8,qi)]),n("div",null,[n("button",{class:X(["btn btn-sm",ts(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:y}," â¬‡ï¸ "+E(ts(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Ki=se(zi,[["__scopeId","data-v-fdcd3535"]]),Me=xt("message",()=>{const s=I(new Map),e=I(new Map),t=I(new Map),o=I(new Map),i=I(new Map),a=I(new Map),r=I(new Map),d=I(new Map),p=v(()=>{const M=le();return s.value.get(M.currentSessionId)||[]}),f=v(()=>{const M=le();return e.value.get(M.currentSessionId)||[]});async function c(M,k=null,j=0){try{const U=k||1e4,G=await oe.get(`/api/sessions/${M}/messages?limit=${U}&offset=${j}`),Q=G.messages||[],ue=G.total_count||Q.length,ce=G.has_more||!1;if(console.log(`Loaded ${Q.length} of ${ue} messages for session ${M}`),s.value.set(M,Q),Q.length>0){const P=Q[Q.length-1];P.timestamp&&(r.value.set(M,P.timestamp),console.log(`Tracked last received timestamp for session ${M}: ${P.timestamp}`))}const re=new Set;Q.forEach(P=>{P.type==="assistant"&&P.metadata?.tool_uses&&P.metadata.tool_uses.forEach(R=>{re.add(R.id)}),P.type==="user"&&P.metadata?.tool_results&&P.metadata.tool_results.forEach(R=>{re.delete(R.tool_use_id);const Y=a.value.get(M);Y&&Y.delete(R.tool_use_id)}),P.type==="system"&&P.metadata?.subtype==="client_launched"&&(re.forEach(R=>{F(M,R,"Session was restarted")}),re.clear()),P.type==="system"&&P.metadata?.subtype==="interrupt"&&(re.forEach(R=>{F(M,R,"Session was interrupted")}),re.clear()),P.metadata?.has_tool_uses&&P.metadata.tool_uses&&P.metadata.tool_uses.forEach(R=>{b(M,R)}),P.metadata?.has_tool_results&&P.metadata.tool_results&&P.metadata.tool_results.forEach(R=>{_(M,R)}),(P.type==="permission_request"||P.metadata?.has_permission_requests)&&l(M,P),P.type==="system"&&(P.subtype==="init"||P.metadata?.subtype==="init")&&P.metadata?.init_data&&le().storeInitData(M,P.metadata.init_data)});const z=le().sessions.get(M);return z&&!["active","paused","starting"].includes(z.state)&&(re.forEach(P=>{F(M,P,"Session was terminated")}),re.clear()),i.value.set(M,re),s.value=new Map(s.value),ce&&console.warn(`Warning: Only loaded ${Q.length} of ${ue} messages. Some messages may be missing.`),{messages:Q,totalCount:ue,hasMore:ce}}catch(U){throw console.error("Failed to load messages:",U),U}}function $(M,k){const j=i.value.get(M)||new Set;k.type==="assistant"&&k.metadata?.tool_uses&&k.metadata.tool_uses.forEach(U=>{j.add(U.id)}),k.type==="user"&&k.metadata?.tool_results&&k.metadata.tool_results.forEach(U=>{j.delete(U.tool_use_id);const G=a.value.get(M);G&&G.delete(U.tool_use_id)}),k.type==="system"&&k.metadata?.subtype==="client_launched"&&(j.forEach(U=>{F(M,U,"Session was restarted")}),j.clear()),k.type==="system"&&k.metadata?.subtype==="interrupt"&&(j.forEach(U=>{F(M,U,"Session was interrupted")}),j.clear()),i.value.set(M,j)}function g(M,k){s.value.has(M)||s.value.set(M,[]);const j=s.value.get(M);if(k.id){const U=j.findIndex(G=>G.id===k.id);if(U!==-1){console.log(`Skipping duplicate message ${k.id} (already exists at index ${U})`);return}}j.push(k),k.timestamp&&r.value.set(M,k.timestamp),q(M,k),$(M,k),s.value=new Map(s.value)}function y(M,k){e.value.has(M)||e.value.set(M,[]),e.value.get(M).push(k),e.value=new Map(e.value)}function w(M,k,j){const U=e.value.get(M);if(U){const G=U.find(Q=>Q.id===k);G&&(Object.assign(G,j),e.value=new Map(e.value))}}function b(M,k){const j=D(k.name,k.input);t.value.set(j,k.id);const U={id:k.id,name:k.name,input:k.input,signature:j,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return y(M,U),console.log(`Created tool call ${U.id} for ${U.name}`),U}function l(M,k){console.log("handlePermissionRequest received:",k);const j=k.metadata?.tool_name||k.tool_name,U=k.metadata?.input_params||k.input_params,G=k.metadata?.request_id||k.request_id,Q=k.metadata?.suggestions||k.suggestions||[];console.log("Extracted data:",{toolName:j,inputParams:U,requestId:G,suggestions:Q});const ue=D(j,U),ce=t.value.get(ue);ce?(o.value.set(G,ce),w(M,ce,{status:"permission_required",permissionRequestId:G,suggestions:Q}),console.log(`Permission required for tool ${ce}`,{suggestions:Q})):console.warn("No tool use ID found for permission request signature:",ue,{toolName:j,inputParams:U,availableSignatures:Array.from(t.value.keys())})}function h(M,k){const j=o.value.get(k.request_id);if(j){const U={permissionDecision:k.decision,appliedUpdates:k.applied_updates||[]};k.decision==="allow"?U.status="executing":(U.status="completed",U.result={error:!0,message:k.reasoning||"Permission denied"},U.isExpanded=!1),w(M,j,U),console.log(`Permission ${k.decision} for tool ${j}`)}}function _(M,k){const j=k.tool_use_id;w(M,j,{status:k.is_error?"error":"completed",result:{error:k.is_error,content:k.content},isExpanded:!1}),console.log(`Tool ${j} ${k.is_error?"failed":"completed"}`)}function x(M,k){const j=e.value.get(M);if(j){const U=j.find(G=>G.id===k);U&&(U.isExpanded=!U.isExpanded,e.value=new Map(e.value))}}function D(M,k){if(!M)return"unknown:{}";if(!k||typeof k!="object")return`${M}:{}`;const j=JSON.stringify(k,Object.keys(k).sort());return`${M}:${j}`}function q(M,k){const j=k.metadata?.display||k.display;if(!j)return;d.value.has(M)||d.value.set(M,new Map);const U=d.value.get(M);if(j.tool_states)for(const[G,Q]of Object.entries(j.tool_states)){U.set(G,Q);const ue=e.value.get(M);if(ue){const ce=ue.find(re=>re.id===G);if(ce){const re={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};ce.status=re[Q.state]||Q.state,ce.backendState=Q}}}if(j.orphaned_tools&&j.orphaned_tools.length>0){const G=a.value.get(M)||new Map;for(const Q of j.orphaned_tools)G.has(Q)||G.set(Q,{reason:"denied",message:"Session was interrupted"});a.value.set(M,G)}if(j.linked_permissions)for(const[G,Q]of Object.entries(j.linked_permissions))o.value.set(G,Q);j.tool_states&&Object.keys(j.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${M}:`,{toolStates:Object.keys(j.tool_states||{}).length,orphanedTools:(j.orphaned_tools||[]).length,linkedPermissions:Object.keys(j.linked_permissions||{}).length})}function K(M,k){return d.value.get(M)?.get(k)}function L(M){const k=d.value.get(M);return k&&k.size>0}function F(M,k,j){const U=a.value.get(M)||new Map;U.set(k,{reason:"denied",message:j}),a.value.set(M,U);const G=e.value.get(M);if(G){const Q=G.find(ue=>ue.id===k);Q&&Q.isExpanded&&(Q.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${k} as orphaned: ${j}`)}function C(M,k){const j=K(M,k);return j&&j.state==="orphaned"?!0:a.value.get(M)?.has(k)||!1}function A(M,k){const j=K(M,k);return j&&j.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:j}:a.value.get(M)?.get(k)}function V(M,k){const j=i.value.get(M);j&&j.size>0&&(j.forEach(U=>F(M,U,k)),j.clear())}function H(M){s.value.delete(M),e.value.delete(M),s.value=new Map(s.value),e.value=new Map(e.value)}function T(M){return r.value.get(M)}async function S(M){const k=r.value.get(M);if(!k)return console.log(`No sync needed for session ${M} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${M} since ${k}`);const j=await oe.get(`/api/sessions/${M}/messages?limit=1000&offset=0`),U=j.messages||[],G=j.has_more||!1,Q=R=>R?typeof R=="number"?R*1e3:new Date(R).getTime():0,ue=Q(k),ce=U.filter(R=>R.timestamp?Q(R.timestamp)>ue:!1);if(ce.length===0)return console.log(`No missed messages for session ${M}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ce.length} missed messages for session ${M}`);const re=s.value.get(M)||[],fe=new Set(re.map(R=>R.id).filter(Boolean)),z=ce.filter(R=>!R.id||!fe.has(R.id));if(console.log(`After deduplication: ${z.length} unique new messages`),z.length>0){const R=z.sort((Ie,Ge)=>{const W=Q(Ie.timestamp),te=Q(Ge.timestamp);return W-te}),Y=s.value.get(M)||[],J=Y.length>0?Q(Y[Y.length-1].timestamp):0,pe=Q(R[0].timestamp),mt=Q(R[R.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Y.length,lastExisting:J,lastExistingDate:Y.length>0?Y[Y.length-1].timestamp:"none",firstNew:pe,firstNewDate:R[0].timestamp,lastNew:mt,lastNewDate:R[R.length-1].timestamp,shouldAppend:pe>J}),pe>J){const Ie=[...Y,...R];s.value.set(M,Ie),console.log(`âœ… Appended ${R.length} new messages (no full sort needed)`)}else{const Ie=[...Y,...R].sort((Ge,W)=>{const te=Q(Ge.timestamp),ne=Q(W.timestamp);return te-ne});s.value.set(M,Ie),console.log(`âš ï¸ Merged and sorted ${R.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${re.length} messages unchanged`);z.forEach(R=>{$(M,R),R.metadata?.has_tool_uses&&R.metadata.tool_uses&&R.metadata.tool_uses.forEach(Y=>{b(M,Y)}),R.metadata?.has_tool_results&&R.metadata.tool_results&&R.metadata.tool_results.forEach(Y=>{_(M,Y)}),(R.type==="permission_request"||R.metadata?.has_permission_requests)&&l(M,R),R.type==="system"&&(R.subtype==="init"||R.metadata?.subtype==="init")&&R.metadata?.init_data&&le().storeInitData(M,R.metadata.init_data)});const P=s.value.get(M);if(P&&P.length>0){const R=P[P.length-1];R.timestamp&&r.value.set(M,R.timestamp)}return s.value=new Map(s.value),{syncedCount:z.length,hasMore:G}}catch(j){return console.error(`Failed to sync messages for session ${M}:`,j),{syncedCount:0,hasMore:!1,error:j.message}}}const N=le();return de(()=>Array.from(N.sessions.values()).map(k=>({id:k.session_id,state:k.state})),(M,k)=>{k&&M.forEach((j,U)=>{const G=k[U];if(!G||G.id!==j.id)return;const Q=["active","paused","starting"].includes(G.state),ue=!["active","paused","starting"].includes(j.state);Q&&ue&&V(j.id,"Session was terminated")})},{deep:!0}),{messagesBySession:s,toolCallsBySession:e,activeToolUses:_s(i),orphanedToolUses:_s(a),currentMessages:p,currentToolCalls:f,loadMessages:c,addMessage:g,addToolCall:y,updateToolCall:w,handleToolUse:b,handlePermissionRequest:l,handlePermissionResponse:h,handleToolResult:_,toggleToolExpansion:x,clearMessages:H,markToolUseOrphaned:F,isToolUseOrphaned:C,getOrphanedInfo:A,clearOrphanedToolUses:V,getLastReceivedTimestamp:T,syncMessages:S,getBackendToolState:K,hasBackendDisplayMetadata:L,backendToolStates:_s(d)}}),Gi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Me},Symbol.toStringTag,{value:"Module"}));function Yi(s){if(!s)return new Date;if(typeof s=="string"){const e=new Date(s);return isNaN(e.getTime())?new Date:e}return typeof s=="number"?s<1e10?new Date(s*1e3):new Date(s):new Date}function Rt(s){return Yi(s).toLocaleTimeString()}const Ji={class:"message-row message-row-user"},Xi=["title"],Qi={class:"message-content-column"},Zi=["innerHTML"],ea={key:0,class:"tool-results mt-2"},ta={class:"tool-results-header text-muted small mb-2"},sa={class:"d-flex align-items-start gap-2"},na={class:"flex-grow-1"},oa={class:"text-muted"},ia={key:0,class:"text-danger small"},aa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(s){const e=s;at.setOptions({breaks:!0,gfm:!0});const t=v(()=>Rt(e.message.timestamp)),o=v(()=>`user
${t.value}`),i=v(()=>{const p=e.message.content||"";let f=at.parse(p);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),rs.sanitize(f)}),a=v(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=v(()=>e.message.metadata?.tool_results||[]);function d(p,f){return p?p.length<=f?p:p.substring(0,f)+"...":""}return(p,f)=>(u(),m("div",Ji,[n("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[n("span",{class:"speaker-label"},"user",-1)])],8,Xi),n("div",Qi,[n("div",{class:"message-text",innerHTML:i.value},null,8,Zi),a.value?(u(),m("div",ea,[n("div",ta," ðŸ”§ Tool Results ("+E(r.value.length)+") ",1),(u(!0),m(ie,null,ae(r.value,(c,$)=>(u(),m("div",{key:$,class:X(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[n("div",sa,[n("span",null,E(c.is_error?"âŒ":"âœ…"),1),n("div",na,[n("small",oa,"Tool: "+E(c.tool_use_id),1),c.is_error?(u(),m("div",ia,E(d(c.content,200)),1)):O("",!0)])])],2))),128))])):O("",!0)])]))}},ra=se(aa,[["__scopeId","data-v-7665755b"]]),la={class:"thinking-block"},ca=["aria-label"],ua={class:"text-muted ms-auto"},da={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ma=["innerHTML"],pa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(s){const e=s,t=I(!1),o=v(()=>e.thinking?.length||0),i=v(()=>{const r=e.thinking||"",d=at.parse(r);return rs.sanitize(d)});function a(){t.value=!t.value}return(r,d)=>(u(),m("div",la,[n("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[n("span",{"aria-label":t.value?"Collapse":"Expand"},E(t.value?"â–¾":"â–¸"),9,ca),d[0]||(d[0]=n("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),n("small",ua,E(o.value)+" characters",1)]),t.value?(u(),m("div",da,[n("div",{class:"thinking-text",innerHTML:i.value},null,8,ma)])):O("",!0)]))}},fa=se(pa,[["__scopeId","data-v-fda2352c"]]),Ze=xt("websocket",()=>{const s=I(null),e=I(!1),t=I(0),o=10,i=I(null),a=I(!1),r=I(0),d=5,p=I(null);let f=null;const c=I(0),$=I(null),g=I(new Map),y=I(null),w=I(!1),b=I(0),l=5,h=I(null),_=1e4,x=1e3,D=I(Date.now()),q=I(Date.now()),K=I(Date.now());let L=null,F=null,C=null;const A=v(()=>e.value&&(a.value||!p.value)?"connected":e.value?"partial":"disconnected");function V(z){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${z}`}function H(z){const P={ui:{timer:()=>L,setTimer:R=>{L=R},lastPing:D,connected:e,name:"UI"},session:{timer:()=>F,setTimer:R=>{F=R},lastPing:q,connected:a,name:"Session"},legion:{timer:()=>C,setTimer:R=>{C=R},lastPing:K,connected:w,name:"Legion"}}[z];P.timer()&&clearInterval(P.timer()),P.setTimer(setInterval(()=>{if(!P.connected.value)return;const R=Date.now()-P.lastPing.value;if(R>_){console.warn(`âš ï¸ ${P.name} WebSocket heartbeat timeout (${R}ms since last ping) - forcing close to trigger reconnection`),P.connected.value=!1;const J={ui:s,session:i,legion:y}[z];J.value&&J.value.readyState===WebSocket.OPEN&&J.value.close()}},x)),console.log(`âœ… Started heartbeat monitor for ${P.name} WebSocket`)}function T(z){const P={ui:{get:()=>L,set:R=>{L=R}},session:{get:()=>F,set:R=>{F=R}},legion:{get:()=>C,set:R=>{C=R}}}[z];P.get()&&(clearInterval(P.get()),P.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${z} WebSocket`))}function S(){if(s.value)return;const z=V("/ws/ui");console.log(`Connecting to UI WebSocket: ${z}`),s.value=new WebSocket(z),s.value.onopen=()=>{e.value=!0,t.value=0,D.value=Date.now(),H("ui"),console.log("UI WebSocket connected")},s.value.onmessage=P=>{const R=JSON.parse(P.data);Q(R)},s.value.onclose=()=>{if(T("ui"),e.value=!1,s.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const P=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${P}ms (attempt ${t.value})`),setTimeout(S,P)}},s.value.onerror=P=>{console.error("UI WebSocket error:",P)}}function N(){s.value&&(s.value.close(),s.value=null,e.value=!1)}async function M(z){c.value++;const P=c.value;if(console.log(`[Gen ${P}] Starting connection to session ${z}`),f&&(clearTimeout(f),f=null),await k(),c.value!==P){console.log(`[Gen ${P}] Connection cancelled (current generation: ${c.value})`);return}p.value=z,$.value=P;const R=V(`/ws/session/${z}`);console.log(`[Gen ${P}] Connecting to Session WebSocket: ${R}`),i.value=new WebSocket(R),i.value.onopen=async()=>{if($.value!==P){console.log(`[Gen ${P}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}a.value=!0,r.value=0,q.value=Date.now(),H("session"),console.log(`[Gen ${P}] Session WebSocket connected for ${z}`);const Y=g.value.get(z);if(g.value.set(z,!0),Y){console.log(`[Gen ${P}] Reconnection detected, syncing missed messages...`);try{const pe=await Me().syncMessages(z);pe.syncedCount>0?console.log(`[Gen ${P}] âœ… Synced ${pe.syncedCount} missed messages`):pe.error?console.warn(`[Gen ${P}] âš ï¸ Message sync failed: ${pe.error}`):console.log(`[Gen ${P}] No missed messages to sync`),pe.hasMore&&console.warn(`[Gen ${P}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(J){console.error(`[Gen ${P}] Error during message sync:`,J)}}else console.log(`[Gen ${P}] Initial connection, no sync needed`)},i.value.onmessage=Y=>{if($.value!==P){console.log(`[Gen ${P}] Ignoring message (stale connection, current: ${$.value})`);return}const J=JSON.parse(Y.data);ue(J,z)},i.value.onclose=()=>{T("session"),a.value=!1,i.value=null,console.log(`[Gen ${P}] Session WebSocket closed for ${z}`);const Y=le();if(Y.currentSessionId===z&&$.value===P&&r.value<d){r.value++;const J=Math.min(2e3*r.value,3e4);console.log(`[Gen ${P}] Reconnecting Session WebSocket in ${J}ms (attempt ${r.value})`),f=setTimeout(()=>{$.value===P&&Y.currentSessionId===z?(f=null,M(z)):console.log(`[Gen ${P}] Skipping reconnect (generation or session changed)`)},J)}},i.value.onerror=Y=>{console.error(`[Gen ${P}] Session WebSocket error:`,Y)}}function k(){return new Promise(z=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const P=p.value,R=()=>{i.value=null,a.value=!1,p.value=null,$.value=null,r.value=0,P&&g.value.delete(P),z()};if(i.value.readyState===WebSocket.CLOSED)R();else{const Y=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),R()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Y),R()},{once:!0}),i.value.close()}}else p.value=null,$.value=null,z()})}function j(z){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:z})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function U(z,P,R=!1,Y=null){if(i.value&&a.value){const J={type:"permission_response",request_id:z,decision:P,apply_suggestions:R,timestamp:new Date().toISOString()};Y&&(J.clarification_message=Y),i.value.send(JSON.stringify(J)),console.log(`Sent permission ${P} for request ${z}`,{applySuggestions:R,clarification:Y})}}function G(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function Q(z){const P=le(),R=Ne();switch(z.type){case"sessions_list":z.sessions&&Array.isArray(z.sessions)&&z.sessions.forEach(Y=>{P.updateSession(Y.session_id,Y)});break;case"state_change":z.data&&z.data.session_id&&z.data.session&&P.updateSession(z.data.session_id,z.data.session);break;case"project_updated":if(z.data&&z.data.project){const Y=z.data.project;R.updateProjectLocal(Y.project_id,Y),P.fetchSessions()}break;case"project_deleted":z.data&&z.data.project_id&&R.projects.delete(z.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":D.value=Date.now(),s.value?.readyState===WebSocket.OPEN&&s.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",z.type)}}function ue(z,P){const R=le();if(R.currentSessionId!==P){console.warn(`Ignoring message for session ${P} (current: ${R.currentSessionId})`);return}const Y=Me();switch(z.type){case"message":const J=z.data;if(!J||!J.type){console.warn("Received message event with invalid data:",z);break}if(J.type==="permission_request"){Y.handlePermissionRequest(P,J);break}if(J.type==="permission_response"){Y.handlePermissionResponse(P,J);break}J.metadata?.has_tool_uses&&J.metadata.tool_uses.forEach(pe=>{Y.handleToolUse(P,pe)}),J.metadata?.has_tool_results&&J.metadata.tool_results.forEach(pe=>{Y.handleToolResult(P,pe)}),J.type==="system"&&(J.subtype==="init"||J.metadata?.subtype==="init")&&J.metadata?.init_data&&R.storeInitData(P,J.metadata.init_data),Y.addMessage(P,J);break;case"permission_request":Y.handlePermissionRequest(P,z);break;case"permission_response":Y.handlePermissionResponse(P,z);break;case"tool_result":Y.handleToolResult(P,z);break;case"state_change":R.updateSession(P,z.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${P}`);break;case"ping":q.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",z.type)}}function ce(z){re(),h.value=z;const P=V(`/ws/legion/${z}`);console.log(`Connecting to Legion WebSocket: ${P}`),y.value=new WebSocket(P),y.value.onopen=()=>{w.value=!0,b.value=0,K.value=Date.now(),H("legion"),console.log(`Legion WebSocket connected for ${z}`)},y.value.onmessage=R=>{const Y=JSON.parse(R.data);fe(Y,z)},y.value.onclose=()=>{if(T("legion"),w.value=!1,y.value=null,console.log(`Legion WebSocket closed for ${z}`),h.value===z&&b.value<l){b.value++;const R=Math.min(2e3*b.value,3e4);setTimeout(()=>ce(z),R)}},y.value.onerror=R=>{console.error("Legion WebSocket error:",R)}}function re(){y.value&&(y.value.close(),y.value=null,w.value=!1,h.value=null)}function fe(z,P){xe(async()=>{const{useLegionStore:R}=await Promise.resolve().then(()=>a_);return{useLegionStore:R}},void 0).then(({useLegionStore:R})=>{const Y=R();switch(z.type){case"comm":z.comm&&(Y.addComm(P,z.comm),console.log("Legion WebSocket: Received new comm",z.comm));break;case"minion_created":z.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",z.data),xe(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>hn);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"minion_updated":z.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",z.data),xe(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>hn);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${P}`);break;case"ping":K.value=Date.now(),y.value?.readyState===WebSocket.OPEN&&y.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",z.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:a,sessionRetryCount:r,legionConnected:w,legionRetryCount:b,overallStatus:A,connectUI:S,disconnectUI:N,connectSession:M,disconnectSession:k,sendMessage:j,sendPermissionResponse:U,interruptSession:G,connectLegion:ce,disconnectLegion:re}}),va=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Ze},Symbol.toStringTag,{value:"Module"})),ha={class:"base-tool-handler"},_a={class:"tool-section"},ga={class:"tool-parameters"},ba={class:"tool-code"},ya={key:0,class:"tool-section"},wa={class:"tool-section-label"},$a={class:"tool-code"},Ea={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=v(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,d)=>(u(),m("div",ha,[n("div",_a,[d[0]||(d[0]=n("div",{class:"tool-section-label"},"Parameters:",-1)),n("div",ga,[n("pre",ba,E(t.value),1)])]),o.value?(u(),m("div",ya,[n("div",wa,E(i.value?"Error:":"Result:"),1),n("div",{class:X(["tool-result",{"tool-result-error":i.value}])},[n("pre",$a,E(a.value),1)],2)])):O("",!0)]))}},Sa=se(Ea,[["__scopeId","data-v-1e69f57d"]]),Ca={class:"read-tool-handler"},ka={class:"tool-section"},Ta={class:"read-file-info"},xa={class:"file-path"},Aa={key:0,class:"read-range"},Ma={key:0,class:"tool-section"},Oa={key:0,class:"tool-result tool-result-error"},Da={class:"tool-code"},Na={key:1,class:"file-content-preview"},La={class:"content-header"},Ia={class:"line-count-badge"},ja={key:0,class:"preview-note"},Pa={class:"tool-code content-display"},Ra={key:0,class:"more-indicator"},ws=100,Wa={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>{const y=e.toolCall.input?.offset,w=e.toolCall.input?.limit;return y!==void 0||w!==void 0}),i=v(()=>{const y=e.toolCall.input?.offset;return y!==void 0?y+1:1}),a=v(()=>{const y=e.toolCall.input?.offset||0,w=e.toolCall.input?.limit;return w!==void 0?y+w:"âˆž"}),r=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=v(()=>{if(!r.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)}),f=v(()=>d.value||!p.value?[]:p.value.split(`
`)),c=v(()=>f.value.length),$=v(()=>c.value>ws),g=v(()=>d.value?"":f.value.slice(0,ws).join(`
`));return(y,w)=>(u(),m("div",Ca,[n("div",ka,[n("div",Ta,[w[0]||(w[0]=n("span",{class:"file-icon"},"ðŸ“„",-1)),w[1]||(w[1]=n("strong",null,"Reading:",-1)),n("code",xa,E(t.value),1),o.value?(u(),m("span",Aa,"Lines "+E(i.value)+"-"+E(a.value),1)):O("",!0)])]),r.value?(u(),m("div",Ma,[d.value?(u(),m("div",Oa,[n("pre",Da,E(p.value),1)])):(u(),m("div",Na,[n("div",La,[w[2]||(w[2]=n("span",{class:"content-label"},"Content Preview:",-1)),n("span",Ia,E(c.value)+" lines",1),$.value?(u(),m("span",ja,"(showing first "+E(ws)+")")):O("",!0)]),n("pre",Pa,E(g.value),1),$.value?(u(),m("div",Ra,"...")):O("",!0)]))])):O("",!0)]))}},Ha=se(Wa,[["__scopeId","data-v-1f2b0569"]]),Va={class:"write-tool-handler"},Fa={class:"tool-section"},Ba={class:"write-file-info mb-2"},Ua={class:"file-path"},qa={class:"write-content-preview"},za={class:"content-header"},Ka={class:"line-count-badge"},Ga={key:0,class:"preview-note"},Ya={class:"tool-code content-display"},Ja={key:0,class:"more-indicator"},Xa={key:0,class:"tool-section"},Qa={key:0,class:"tool-result tool-result-error"},Za={class:"tool-code"},er={key:1,class:"tool-result tool-result-success"},tr={class:"success-message"},$s=100,sr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.content||""),i=v(()=>o.value.split(`
`)),a=v(()=>i.value.length),r=v(()=>a.value>$s),d=v(()=>i.value.slice(0,$s).join(`
`)),p=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=v(()=>{if(!p.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,g)=>(u(),m("div",Va,[n("div",Fa,[n("div",Ba,[g[0]||(g[0]=n("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=n("strong",null,"Writing:",-1)),n("code",Ua,E(t.value),1)]),n("div",qa,[n("div",za,[g[2]||(g[2]=n("span",{class:"content-label"},"Content:",-1)),n("span",Ka,E(a.value)+" lines",1),r.value?(u(),m("span",Ga,"(showing first "+E($s)+")")):O("",!0)]),n("pre",Ya,E(d.value),1),r.value?(u(),m("div",Ja,"...")):O("",!0)])]),p.value?(u(),m("div",Xa,[f.value?(u(),m("div",Qa,[g[3]||(g[3]=n("strong",null,"Error:",-1)),n("pre",Za,E(c.value),1)])):(u(),m("div",er,[n("div",tr,[g[4]||(g[4]=n("span",{class:"success-icon"},"âœ…",-1)),n("strong",null,"File created successfully ("+E(a.value)+" lines written)",1)])]))])):O("",!0)]))}},nr=se(sr,[["__scopeId","data-v-ddc24a0f"]]),or={class:"bash-tool-handler"},ir={class:"tool-section"},ar={class:"bash-header"},rr={class:"bash-header-content"},lr={key:0,class:"bash-description"},cr={key:1,class:"bash-flags"},ur={class:"bash-command-section"},dr={class:"bash-command-content"},mr={key:0,class:"tool-section"},pr={key:0,class:"bash-output"},fr={key:1,class:"bash-output-empty"},vr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?.command||""),o=v(()=>e.toolCall.input?.description||""),i=v(()=>e.toolCall.input?.timeout),a=v(()=>e.toolCall.input?.run_in_background||!1),r=v(()=>i.value||a.value),d=v(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),a.value&&g.push("background"),g.join(", ")}),p=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=v(()=>f.value?"tool-result-error":"tool-result-success"),$=v(()=>{if(!p.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,y)=>(u(),m("div",or,[n("div",ir,[n("div",ar,[y[1]||(y[1]=n("span",{class:"bash-icon"},"ðŸ’»",-1)),n("div",rr,[o.value?(u(),m("div",lr,[y[0]||(y[0]=n("strong",null,"Description:",-1)),Z(" "+E(o.value),1)])):O("",!0),r.value?(u(),m("div",cr,E(d.value),1)):O("",!0)])]),n("div",ur,[y[2]||(y[2]=n("div",{class:"bash-command-label"},[n("strong",null,"Command:")],-1)),n("div",dr,E(t.value),1)])]),p.value?(u(),m("div",mr,[n("div",{class:X(["tool-result",c.value])},[y[3]||(y[3]=n("strong",null,"Output:",-1)),$.value?(u(),m("pre",pr,E($.value),1)):(u(),m("div",fr,"No output"))],2)])):O("",!0)]))}},hr=se(vr,[["__scopeId","data-v-ab50fe73"]]),_r={class:"todo-tool-handler"},gr={class:"tool-section"},br={class:"todo-header"},yr={class:"todo-summary"},wr={key:0,class:"todo-count todo-count-completed"},$r={key:1,class:"todo-count todo-count-in-progress"},Er={key:2,class:"todo-count todo-count-pending"},Sr={class:"todo-checklist"},Cr={class:"todo-checkbox"},kr={class:"todo-content"},Tr={key:0,class:"tool-section"},xr={key:0,class:"tool-result tool-result-error"},Ar={class:"tool-code"},Mr={key:1,class:"tool-result tool-result-success"},Or={class:"success-message"},Dr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?.todos||[]),o=v(()=>t.value.filter(c=>c.status==="completed").length),i=v(()=>t.value.filter(c=>c.status==="in_progress").length),a=v(()=>t.value.filter(c=>c.status==="pending").length);function r(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const d=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=v(()=>{if(!d.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,$)=>(u(),m("div",_r,[n("div",gr,[n("div",br,[$[0]||($[0]=n("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=n("strong",null,"Task List:",-1)),n("div",yr,[o.value>0?(u(),m("span",wr,E(o.value)+" completed ",1)):O("",!0),i.value>0?(u(),m("span",$r,E(i.value)+" in progress ",1)):O("",!0),a.value>0?(u(),m("span",Er,E(a.value)+" pending ",1)):O("",!0)])]),n("div",Sr,[(u(!0),m(ie,null,ae(t.value,(g,y)=>(u(),m("div",{key:y,class:X(["todo-item",`todo-${g.status}`])},[n("span",Cr,E(r(g.status)),1),n("span",kr,E(g.content),1)],2))),128))])]),d.value?(u(),m("div",Tr,[p.value?(u(),m("div",xr,[$[2]||($[2]=n("strong",null,"Error:",-1)),n("pre",Ar,E(f.value),1)])):(u(),m("div",Mr,[n("div",Or,[$[3]||($[3]=n("span",{class:"success-icon"},"âœ…",-1)),n("strong",null,"Task list updated ("+E(t.value.length)+" tasks)",1)])]))])):O("",!0)]))}},Nr=se(Dr,[["__scopeId","data-v-bbe55ee7"]]),Lr={class:"edit-tool-handler"},Ir={class:"tool-section"},jr={class:"edit-file-info"},Pr={class:"file-path"},Rr={key:0,class:"replace-all-badge"},Wr={class:"edit-diff-container"},Hr={class:"diff-header"},Vr={class:"diff-stats"},Fr={class:"stat-removed"},Br={class:"stat-added"},Ur={class:"unified-diff"},qr={class:"diff-scroll-container"},zr={class:"diff-marker"},Kr={class:"diff-content"},Gr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Xr={key:1,class:"tool-result tool-result-success"},Qr={class:"success-message"},Zr={key:0,class:"success-detail"},el={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.old_string||""),i=v(()=>e.toolCall.input?.new_string||""),a=v(()=>e.toolCall.input?.replace_all||!1),r=v(()=>{const y=bi(t.value,o.value,i.value,"","",{context:3}).split(`
`),w=[];for(let b=4;b<y.length;b++){const l=y[b];l&&(l.startsWith("-")?w.push({type:"removed",content:l.substring(1)}):l.startsWith("+")?w.push({type:"added",content:l.substring(1)}):l.startsWith(" ")?w.push({type:"context",content:l.substring(1)}):l.startsWith("@@")&&w.push({type:"hunk",content:l}))}return w}),d=v(()=>r.value.filter(g=>g.type==="removed").length),p=v(()=>r.value.filter(g=>g.type==="added").length),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,y)=>(u(),m("div",Lr,[n("div",Ir,[n("div",jr,[y[0]||(y[0]=n("span",{class:"file-icon"},"âœï¸",-1)),y[1]||(y[1]=n("strong",null,"Editing:",-1)),n("code",Pr,E(t.value),1),a.value?(u(),m("span",Rr,"Replace All")):O("",!0)]),n("div",Wr,[n("div",Hr,[y[2]||(y[2]=n("span",{class:"diff-label"},"Changes:",-1)),n("span",Vr,[n("span",Fr,"-"+E(d.value),1),n("span",Br,"+"+E(p.value),1)])]),n("div",Ur,[n("div",qr,[(u(!0),m(ie,null,ae(r.value,(w,b)=>(u(),m("div",{key:b,class:X(["diff-line",{"diff-line-removed":w.type==="removed","diff-line-added":w.type==="added","diff-line-context":w.type==="context","diff-line-hunk":w.type==="hunk"}])},[n("span",zr,E(w.type==="removed"?"-":w.type==="added"?"+":w.type==="hunk"?"@":" "),1),n("span",Kr,E(w.content),1)],2))),128))])])])]),f.value?(u(),m("div",Gr,[c.value?(u(),m("div",Yr,[y[3]||(y[3]=n("strong",null,"Error:",-1)),n("pre",Jr,E($.value),1)])):(u(),m("div",Xr,[n("div",Qr,[y[4]||(y[4]=n("span",{class:"success-icon"},"âœ…",-1)),y[5]||(y[5]=n("strong",null,"File edited successfully",-1)),a.value?(u(),m("span",Zr,"(all occurrences replaced)")):O("",!0)])]))])):O("",!0)]))}},tl=se(el,[["__scopeId","data-v-dd74055e"]]),sl={class:"search-tool-handler"},nl={class:"tool-section"},ol={class:"search-info"},il={class:"search-icon"},al={class:"search-pattern"},rl={key:0,class:"search-path"},ll={key:1,class:"search-filters"},cl={key:0,class:"filter-badge"},ul={key:1,class:"filter-badge"},dl={key:2,class:"filter-badge"},ml={key:0,class:"tool-section"},pl={key:0,class:"tool-result tool-result-error"},fl={class:"tool-code"},vl={key:1,class:"search-results"},hl={class:"results-header"},_l={class:"results-label"},gl={class:"results-count-badge"},bl={class:"results-content"},yl={class:"tool-code"},wl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.name==="Grep"),o=v(()=>e.toolCall.input?.pattern||"Unknown"),i=v(()=>e.toolCall.input?.path||null),a=v(()=>e.toolCall.input?.type||null),r=v(()=>e.toolCall.input?.glob||null),d=v(()=>e.toolCall.input?.["-i"]||!1),p=v(()=>a.value||r.value||d.value),f=v(()=>t.value?"ðŸ”":"ðŸ“"),c=v(()=>t.value?"Searching content":"Finding files"),$=v(()=>t.value?"Matches":"Files found"),g=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),y=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!g.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)}),b=v(()=>!g.value||y.value||!w.value?0:w.value.split(`
`).filter(h=>h.trim()).length);return(l,h)=>(u(),m("div",sl,[n("div",nl,[n("div",ol,[n("span",il,E(f.value),1),n("strong",null,E(c.value)+":",1),n("code",al,E(o.value),1),i.value?(u(),m("span",rl,"in "+E(i.value),1)):O("",!0),p.value?(u(),m("span",ll,[a.value?(u(),m("span",cl,"type: "+E(a.value),1)):O("",!0),r.value?(u(),m("span",ul,"glob: "+E(r.value),1)):O("",!0),d.value?(u(),m("span",dl,"case-insensitive")):O("",!0)])):O("",!0)])]),g.value?(u(),m("div",ml,[y.value?(u(),m("div",pl,[h[0]||(h[0]=n("strong",null,"Error:",-1)),n("pre",fl,E(w.value),1)])):(u(),m("div",vl,[n("div",hl,[n("span",_l,E($.value)+":",1),n("span",gl,E(b.value)+" "+E(b.value===1?"match":"matches"),1)]),n("div",bl,[n("pre",yl,E(w.value),1)])]))])):O("",!0)]))}},_n=se(wl,[["__scopeId","data-v-0d272c39"]]),$l={class:"web-tool-handler"},El={class:"tool-section"},Sl={class:"web-info"},Cl={class:"web-icon"},kl=["href"],Tl={key:1,class:"web-query"},xl={key:0,class:"web-prompt-container"},Al={class:"prompt-content"},Ml={key:1,class:"web-domains"},Ol={class:"domains-label"},Dl={key:0,class:"tool-section"},Nl={key:0,class:"tool-result tool-result-error"},Ll={class:"tool-code"},Il={key:1,class:"web-results"},jl={class:"results-header"},Pl={class:"results-label"},Rl={class:"results-content"},Wl={class:"tool-code"},Hl={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.name==="WebFetch"),o=v(()=>e.toolCall.input?.url||null),i=v(()=>e.toolCall.input?.query||null),a=v(()=>e.toolCall.input?.prompt||null),r=v(()=>e.toolCall.input?.allowed_domains||[]),d=v(()=>e.toolCall.input?.blocked_domains||[]),p=v(()=>r.value.length>0?r.value:d.value.length>0?d.value:[]),f=v(()=>r.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),c=v(()=>t.value?"ðŸŒ":"ðŸ”Ž"),$=v(()=>t.value?"Fetching URL":"Searching web"),g=v(()=>t.value?"Fetched content":"Search results"),y=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!y.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,h)=>(u(),m("div",$l,[n("div",El,[n("div",Sl,[n("span",Cl,E(c.value),1),n("strong",null,E($.value)+":",1),o.value?(u(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},E(o.value),9,kl)):i.value?(u(),m("code",Tl,E(i.value),1)):O("",!0)]),a.value?(u(),m("div",xl,[h[0]||(h[0]=n("div",{class:"prompt-label"},"Prompt:",-1)),n("div",Al,E(a.value),1)])):O("",!0),p.value.length>0?(u(),m("div",Ml,[n("span",Ol,E(f.value)+":",1),(u(!0),m(ie,null,ae(p.value,_=>(u(),m("span",{key:_,class:"domain-badge"},E(_),1))),128))])):O("",!0)]),y.value?(u(),m("div",Dl,[w.value?(u(),m("div",Nl,[h[1]||(h[1]=n("strong",null,"Error:",-1)),n("pre",Ll,E(b.value),1)])):(u(),m("div",Il,[n("div",jl,[n("span",Pl,E(g.value)+":",1)]),n("div",Rl,[n("pre",Wl,E(b.value),1)])]))])):O("",!0)]))}},gn=se(Hl,[["__scopeId","data-v-62b55b55"]]),Vl={class:"task-tool-handler"},Fl={class:"tool-section"},Bl={class:"task-header"},Ul={key:0,class:"agent-type-badge"},ql={key:0,class:"task-description"},zl={class:"description-content"},Kl={key:1,class:"task-prompt-container"},Gl={class:"prompt-header"},Yl={class:"prompt-length"},Jl={class:"prompt-code"},Xl={key:0,class:"tool-section"},Ql={key:0,class:"tool-result tool-result-error"},Zl={class:"tool-code"},ec={key:1,class:"agent-output"},tc={class:"output-header"},sc={key:0,class:"output-count-badge"},nc={class:"output-content"},oc={class:"tool-code"},ic={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?.description||null),o=v(()=>e.toolCall.input?.prompt||null),i=v(()=>e.toolCall.input?.subagent_type||null),a=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!a.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),p=v(()=>d.value?d.value.split(`
`).length:0);return(f,c)=>(u(),m("div",Vl,[n("div",Fl,[n("div",Bl,[c[0]||(c[0]=n("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=n("strong",null,"Agent Task:",-1)),i.value?(u(),m("span",Ul,E(i.value),1)):O("",!0)]),t.value?(u(),m("div",ql,[c[2]||(c[2]=n("div",{class:"description-label"},"Description:",-1)),n("div",zl,E(t.value),1)])):O("",!0),o.value?(u(),m("div",Kl,[n("div",Gl,[c[3]||(c[3]=n("span",{class:"prompt-label"},"Task Prompt:",-1)),n("span",Yl,E(o.value.length)+" characters",1)]),n("pre",Jl,E(o.value),1)])):O("",!0)]),a.value?(u(),m("div",Xl,[r.value?(u(),m("div",Ql,[c[4]||(c[4]=n("strong",null,"Error:",-1)),n("pre",Zl,E(d.value),1)])):(u(),m("div",ec,[n("div",tc,[c[5]||(c[5]=n("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(u(),m("span",sc,E(p.value)+" lines",1)):O("",!0)]),n("div",nc,[n("pre",oc,E(d.value),1)])]))])):O("",!0)]))}},ac=se(ic,[["__scopeId","data-v-c520c244"]]),rc={class:"notebook-edit-tool-handler"},lc={class:"tool-section"},cc={class:"notebook-info"},uc={class:"file-path"},dc={class:"cell-info mt-2"},mc={class:"info-row"},pc={class:"info-row"},fc={key:0,class:"info-row"},vc={class:"badge bg-info"},hc={key:0,class:"source-preview mt-3"},_c={class:"preview-header"},gc={class:"preview-stats"},bc={class:"source-code"},yc={key:0,class:"tool-section"},wc={key:0},$c={key:1,class:"text-danger"},Ec={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?.notebook_path||"Unknown"),o=v(()=>e.toolCall.input?.cell_id),i=v(()=>e.toolCall.input?.cell_type||"code"),a=v(()=>e.toolCall.input?.edit_mode||"replace"),r=v(()=>e.toolCall.input?.new_source||""),d=v(()=>r.value.split(`
`).length),p=v(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=a.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,g)=>(u(),m("div",rc,[n("div",lc,[n("div",cc,[g[0]||(g[0]=n("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=n("strong",null,"Notebook:",-1)),n("code",uc,E(t.value),1)]),n("div",dc,[n("div",mc,[g[2]||(g[2]=n("strong",null,"Cell ID:",-1)),n("code",null,E(o.value||"N/A"),1)]),n("div",pc,[g[3]||(g[3]=n("strong",null,"Cell Type:",-1)),n("span",{class:X(["badge",p.value])},E(i.value),3)]),a.value?(u(),m("div",fc,[g[4]||(g[4]=n("strong",null,"Edit Mode:",-1)),n("span",vc,E(a.value),1)])):O("",!0)]),r.value?(u(),m("div",hc,[n("div",_c,[g[5]||(g[5]=n("span",{class:"preview-label"},"New Source:",-1)),n("span",gc,E(d.value)+" lines",1)]),n("pre",bc,[n("code",null,E(r.value),1)])])):O("",!0)]),s.toolCall.result?(u(),m("div",yc,[g[6]||(g[6]=n("div",{class:"result-header mb-2"},[n("strong",null,"Result:")],-1)),n("div",{class:X(["tool-result",f.value])},[s.toolCall.result.success!==!1?(u(),m("div",wc," âœ… "+E(c.value),1)):(u(),m("div",$c," â— "+E(s.toolCall.result.error||"Operation failed"),1))],2)])):O("",!0)]))}},Sc=se(Ec,[["__scopeId","data-v-c81a9bcf"]]),Cc={class:"shell-tool-handler"},kc={class:"tool-section"},Tc={class:"shell-info"},xc={class:"shell-icon"},Ac={key:0,class:"shell-id"},Mc={key:0,class:"filter-info mt-2"},Oc={class:"filter-pattern"},Dc={key:0,class:"tool-section"},Nc={class:"result-header mb-2"},Lc={key:0,class:"mb-2"},Ic={class:"shell-output"},jc={key:1,class:"mb-2"},Pc={class:"shell-output shell-output-error"},Rc={key:0},Wc={key:1,class:"text-danger"},Hc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=v(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=v(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=v(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=v(()=>e.toolCall.input?.filter);function d(y,w){if(!y)return null;const b=new RegExp(`<${w}>([\\s\\S]*?)<\\/${w}>`,"i"),l=y.match(b);return l?l[1].trim():null}const p=v(()=>{const y=e.toolCall.result;if(!y)return null;let w=y;if(y.content&&(w=y.content),typeof w=="string")return{status:d(w,"status"),stdout:d(w,"stdout"),stderr:d(w,"stderr"),exit_code:d(w,"exit_code")};if(Array.isArray(w)){const b=w.find(l=>l.type==="text")?.text||"";return{status:d(b,"status"),stdout:d(b,"stdout"),stderr:d(b,"stderr"),exit_code:d(b,"exit_code")}}return{status:y.status||w.status,stdout:y.stdout||y.output||w.stdout||w.output,stderr:y.stderr||w.stderr,exit_code:y.exit_code||w.exit_code}}),f=v(()=>p.value?.status),c=v(()=>{const y=f.value;return y==="running"?"bg-success":y==="completed"?"bg-secondary":y==="killed"||y==="terminated"?"bg-danger":"bg-info"}),$=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const y=p.value;if(y?.status==="running"&&!y.stdout&&!y.stderr)return"No new output since last check";if(y?.status==="failed")return`Shell failed (exit code ${y.exit_code||"unknown"})`}return"Operation completed"});return(y,w)=>(u(),m("div",Cc,[n("div",kc,[n("div",Tc,[n("span",xc,E(t.value),1),n("strong",null,E(o.value)+":",1),a.value?(u(),m("code",Ac,"Shell "+E(a.value),1)):O("",!0)]),s.toolCall.name==="BashOutput"&&r.value?(u(),m("div",Mc,[w[0]||(w[0]=n("strong",null,"Filter:",-1)),n("code",Oc,E(r.value),1)])):O("",!0)]),s.toolCall.result?(u(),m("div",Dc,[n("div",Nc,[n("strong",null,E(i.value)+":",1),f.value?(u(),m("span",{key:0,class:X(["badge",c.value])},E(f.value),3)):O("",!0)]),p.value?.stdout?(u(),m("div",Lc,[w[1]||(w[1]=n("div",{class:"output-label"},"Output:",-1)),n("div",Ic,[n("pre",null,[n("code",null,E(p.value.stdout),1)])])])):O("",!0),p.value?.stderr?(u(),m("div",jc,[w[2]||(w[2]=n("div",{class:"output-label text-danger"}," â— Errors: ",-1)),n("div",Pc,[n("pre",null,[n("code",null,E(p.value.stderr),1)])])])):O("",!0),!p.value?.stdout&&!p.value?.stderr?(u(),m("div",{key:2,class:X(["tool-result",$.value])},[s.toolCall.result.success!==!1?(u(),m("div",Rc," âœ… "+E(g.value),1)):(u(),m("div",Wc," â— "+E(s.toolCall.result.error||"Operation failed"),1))],2)):O("",!0)])):O("",!0)]))}},bn=se(Hc,[["__scopeId","data-v-86def281"]]),Vc={class:"skill-tool-handler"},Fc={key:0,class:"tool-section"},Bc={class:"d-flex align-items-center gap-2"},Uc={class:"text-muted small"},qc={key:0,class:"skill-content-body"},zc={class:"skill-content-text"},Kc={key:1,class:"tool-section mt-3"},Gc={class:"tool-result tool-result-error"},Yc={class:"tool-code"},Jc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=Me(),o=le(),i=I(!1);function a(){i.value=!i.value}const r=v(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const y=t.messagesBySession.get(g)||[],w=y.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let b=null,l=null;for(let h=w+1;h<Math.min(w+3,y.length);h++){const _=y[h];if(_.type!=="user")continue;const x=_.content||"";x.includes("<command-message>")&&x.includes("skill is running")?b=_:x.startsWith("Base directory for this skill:")&&(l=_)}return{running:b,content:l}}),d=v(()=>{const g=r.value.content;if(!g)return"";const y=g.content||"",w=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return y.replace(w,"").trim()}),p=v(()=>d.value.length>0),f=v(()=>d.value?d.value.split(`
`).length:0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!c.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,y)=>(u(),m("div",Vc,[p.value?(u(),m("div",Fc,[n("div",{class:"skill-content-header",onClick:a},[n("div",Bc,[n("i",{class:X(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),y[0]||(y[0]=n("strong",null,"Skill Content",-1)),n("span",Uc,"("+E(f.value)+" lines)",1)])]),i.value?(u(),m("div",qc,[n("pre",zc,E(d.value),1)])):O("",!0)])):O("",!0),c.value?(u(),m("div",Kc,[y[1]||(y[1]=n("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),n("div",Gc,[n("pre",Yc,E($.value),1)])])):O("",!0)]))}},Xc=se(Jc,[["__scopeId","data-v-0a48ca0f"]]),Qc={class:"slashcommand-tool-handler"},Zc={key:0,class:"tool-section"},eu={class:"d-flex align-items-center gap-2"},tu=["aria-label"],su={class:"text-muted small"},nu={key:0,class:"command-content-body"},ou={class:"command-content-text"},iu={key:1,class:"tool-section mt-3"},au={class:"tool-result tool-result-error"},ru={class:"tool-code"},lu={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=Me(),o=le(),i=I(!1);function a(){i.value=!i.value}const r=v(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const y=t.messagesBySession.get(g)||[],w=y.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let b=null,l=null;for(let h=w+1;h<Math.min(w+3,y.length);h++){const _=y[h];if(_.type!=="user")continue;const x=_.content||"";x.includes("<command-message>")&&x.includes("<command-name>")&&x.includes("<command-args>")?b=_:x.includes("ARGUMENTS:")&&(l=_)}return{running:b,content:l}}),d=v(()=>{const g=r.value.content;if(!g)return"";const y=g.content||"",w=/\nARGUMENTS:.*$/s;return y.replace(w,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=v(()=>d.value.length>0),f=v(()=>d.value?d.value.split(`
`).length:0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!c.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,y)=>(u(),m("div",Qc,[p.value?(u(),m("div",Zc,[n("div",{class:"command-content-header",onClick:a},[n("div",eu,[n("span",{"aria-label":i.value?"Collapse":"Expand"},E(i.value?"â–¾":"â–¸"),9,tu),y[0]||(y[0]=n("strong",null,"Command Content",-1)),n("span",su,"("+E(f.value)+" lines)",1)])]),i.value?(u(),m("div",nu,[n("pre",ou,E(d.value),1)])):O("",!0)])):O("",!0),c.value?(u(),m("div",iu,[y[1]||(y[1]=n("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),n("div",au,[n("pre",ru,E($.value),1)])])):O("",!0)]))}},cu=se(lu,[["__scopeId","data-v-15991acf"]]),uu={class:"exit-plan-mode-tool-handler"},du={class:"tool-section"},mu={key:0,class:"plan-content mt-2"},pu={class:"plan-text"},fu={key:0,class:"tool-section"},vu={key:0},hu={key:1,class:"text-danger"},_u={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>e.toolCall.input?.plan),o=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),m("div",uu,[n("div",du,[a[1]||(a[1]=n("div",{class:"plan-info"},[n("span",{class:"plan-icon"},"ðŸ“‹"),n("strong",null,"Exiting Plan Mode")],-1)),t.value?(u(),m("div",mu,[a[0]||(a[0]=n("div",{class:"plan-header"},[n("strong",null,"Proposed Plan:")],-1)),n("div",pu,E(t.value),1)])):O("",!0)]),s.toolCall.result?(u(),m("div",fu,[a[2]||(a[2]=n("div",{class:"result-header mb-2"},[n("strong",null,"Result:")],-1)),n("div",{class:X(["tool-result",o.value])},[s.toolCall.result.success!==!1?(u(),m("div",vu," âœ… Permission mode reverted to default ")):(u(),m("div",hu," â— "+E(s.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):O("",!0)]))}},gu=se(_u,[["__scopeId","data-v-e2e3c781"]]),bu={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},yu={class:"tool-status-icon"},wu=["title"],$u={class:"d-flex align-items-center gap-2"},Eu={class:"text-muted"},Su=["aria-label"],Cu={key:0,class:"card-body"},ku={key:0,class:"alert alert-warning mb-3"},Tu={class:"d-flex align-items-center"},xu={class:"mb-0 small"},Au={key:1,class:"permission-prompt mt-3"},Mu={class:"alert alert-warning mb-3"},Ou={class:"mb-0"},Du={class:"tool-name"},Nu={key:0,class:"suggestions-section mb-3"},Lu={class:"alert alert-info mb-0"},Iu={class:"suggestion-details p-2 bg-white rounded"},ju={class:"permission-buttons d-flex gap-2 mb-3"},Pu=["disabled"],Ru=["disabled"],Wu=["disabled"],Hu={class:"guidance-section mt-3"},Vu=["disabled"],Fu=["disabled"],Bu={key:2,class:"mt-3"},Uu={class:"alert alert-warning mb-0"},qu={class:"d-flex align-items-center"},zu={class:"mb-0 small"},Ku={key:3,class:"tool-section"},Gu={class:"alert alert-danger mb-0"},Yu={key:0},Ju={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(s){const e=s,t=Me(),o=le(),i=Ze(),a=I(!1),r=I(null),d=I(""),p=v(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),f=v(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c=v(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),$=v(()=>{if(c.value){const T=c.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[T]||T}return e.toolCall.status}),g={Read:Ha,Write:nr,Bash:hr,TodoWrite:Nr,Edit:tl,Grep:_n,Glob:_n,WebFetch:gn,WebSearch:gn,Task:ac,NotebookEdit:Sc,BashOutput:bn,KillShell:bn,SlashCommand:cu,Skill:Xc,ExitPlanMode:gu},y=v(()=>{const T=e.toolCall.name;return g[T]?g[T]:Sa}),w=v(()=>{const T=[];if(p.value)return T.push("border-warning"),T.join(" ");switch($.value){case"pending":T.push("border-secondary");break;case"permission_required":T.push("border-warning");break;case"executing":T.push("border-primary");break;case"completed":h.value||e.toolCall.permissionDecision==="deny"?T.push("border-danger"):T.push("border-success");break;case"error":T.push("border-danger");break}return T.join(" ")}),b=v(()=>{if(p.value)return"â¹ï¸";switch($.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":h.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),l=v(()=>Rt(e.toolCall.timestamp)),h=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=v(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function x(T){if(!T)return"";const S=T.replace(/\\/g,"/").split("/");return S[S.length-1]}function D(T){if(!T)return"";const S=T.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return S?S[1]:T}function q(T,S=200){return T?T.length<=S?T:T.substring(0,S)+"...":""}function K(T){if(!T)return null;if(T.content){const S=T.content.match(/exit code (\d+)/i);if(S)return parseInt(S[1])}return T.error?1:0}function L(T,S){const N=T?T.split(`
`).length:0;return{added:S?S.split(`
`).length:0,removed:N}}const F=v(()=>{const T=e.toolCall.name,S=e.toolCall.input||{},N=e.toolCall.result,M=$.value;switch(T){case"Bash":case"Shell":case"Command":{const k=D(S.command),j=q(k,200);if(M==="completed"&&N){const U=K(N);return`Bash: ${j} (exit ${U})`}return`Bash: ${j}`}case"SlashCommand":{const k=q(S.command,200);return M==="completed"&&N?`SlashCommand: ${k}`:`SlashCommand: ${k}`}case"Edit":{const k=x(S.file_path);if(M==="completed"&&N&&!N.error){const{added:j,removed:U}=L(S.old_string,S.new_string);return j===U?`Edit: ${k} (${j} lines changed)`:`Edit: ${k} (${j} lines added, ${U} removed)`}return`Edit: ${k}`}case"Read":{const k=x(S.file_path);if(S.offset!==void 0||S.limit!==void 0){const U=(S.offset||0)+1,G=S.limit?(S.offset||0)+S.limit:"âˆž";return`Read: ${k} (lines ${U}-${G})`}return`Read: ${k} (full file)`}case"Write":{const k=x(S.file_path);if(M==="completed"&&N&&!N.error&&S.content){const j=S.content.split(`
`).length;return`Write: ${k} (${j} lines written)`}return`Write: ${k}`}case"Skill":{const k=S.skill||"Unknown";return M==="completed"&&N?N.error?`Skill: ${k} (error)`:`Skill: ${k} (completed)`:`Skill: ${k}`}case"Task":{const k=S.subagent_type||"general",j=S.description||"Task";return M==="completed"&&N?N.error?`Task: (${k}) ${j} (error)`:`Task: (${k}) ${j} (completed)`:`Task: (${k}) ${j}`}case"TodoWrite":{if(S.todos&&Array.isArray(S.todos)){const k=S.todos.filter(G=>G.status==="completed").length,j=S.todos.length,U=S.todos.find(G=>G.status==="in_progress");return U?`Todo: Working on "${U.content}"`:`Todo: ${k}/${j} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const k=S.pattern||"",j=T==="Grep"?"Grep":"Glob";if(M==="completed"&&N&&!N.error){let U=0;return N.content&&(U=N.content.split(`
`).filter(Q=>Q.trim()).length),`${j}: "${k}" (${U} results)`}return`${j}: "${k}"`}case"WebFetch":case"WebSearch":{const k=S.url||S.query||"";if(T==="WebSearch"){const U=S.query||"",G=U.length>50?U.substring(0,50)+"...":U;return M==="completed"&&N?N.error?`Web: ${G} (error)`:`Web: ${G} (success)`:`Web: ${G}`}let j="";try{k&&(j=new URL(k.startsWith("http")?k:`https://${k}`).hostname)}catch{j=k.length>50?k.substring(0,50)+"...":k}return M==="completed"&&N?N.error?`Web: ${j} (error)`:`Web: ${j} (success)`:`Web: ${j||k}`}case"NotebookEdit":{const k=x(S.notebook_path),j=S.cell_number!==void 0?S.cell_number:"?",U=S.edit_mode||"replace";return`NotebookEdit: ${k} cell #${j} (${U})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${S.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${S.shell_id||"unknown"}`;default:return`${T}: executed`}}),C=v(()=>{const T=e.toolCall.name,S=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(T)?S.command||T:["Edit","Read","Write","NotebookEdit"].includes(T)&&(S.file_path||S.notebook_path)||T});function A(){const T=o.currentSessionId;T&&t.toggleToolExpansion(T,e.toolCall.id)}function V(T){return T.type==="setMode"?`Set permission mode to "${T.mode}"`:T.type==="allow"?`Allow tool: ${T.tool}`:JSON.stringify(T)}async function H(T,S,N=null){if(!a.value){a.value=!0,T==="allow"?r.value=S?"approve-apply":"approve":N?r.value="deny-guidance":r.value="deny";try{const M=o.currentSessionId;if(M){const k=S&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(M,{request_id:e.toolCall.permissionRequestId,decision:T,reasoning:T==="allow"?"User allowed permission":"User denied permission",applied_updates:k})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,T,S,N)}catch(M){console.error("Failed to send permission response:",M)}finally{a.value=!1,r.value=null}}}return(T,S)=>(u(),m("div",{class:X(["tool-call-card card",w.value])},[n("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:A},[n("div",bu,[n("span",yu,E(b.value),1),n("span",{class:"tool-name",title:C.value},E(F.value),9,wu)]),n("div",$u,[n("small",Eu,E(l.value),1),n("span",{"aria-label":s.toolCall.isExpanded?"Collapse":"Expand"},E(s.toolCall.isExpanded?"â–¾":"â–¸"),9,Su)])]),s.toolCall.isExpanded?(u(),m("div",Cu,[p.value?(u(),m("div",ku,[n("div",Tu,[S[6]||(S[6]=n("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),n("div",null,[S[5]||(S[5]=n("strong",null,"Tool Execution Cancelled",-1)),n("p",xu,E(f.value?.message||"Session was terminated"),1)])])])):O("",!0),(u(),ye(oo(y.value),{toolCall:s.toolCall},null,8,["toolCall"])),$.value==="permission_required"&&!p.value?(u(),m("div",Au,[n("div",Mu,[S[9]||(S[9]=n("p",{class:"mb-2"},[n("strong",null,"ðŸ” Permission Required")],-1)),n("p",Ou,[S[7]||(S[7]=Z("Claude wants to use the ",-1)),n("code",Du,E(s.toolCall.name),1),S[8]||(S[8]=Z(" tool.",-1))])]),_.value?(u(),m("div",Nu,[n("div",Lu,[S[10]||(S[10]=n("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),S[11]||(S[11]=n("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),n("div",Iu,[(u(!0),m(ie,null,ae(s.toolCall.suggestions,(N,M)=>(u(),m("div",{key:M,class:"suggestion-item"},[n("code",null,E(V(N)),1)]))),128))]),S[12]||(S[12]=n("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):O("",!0),n("div",ju,[_.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:S[0]||(S[0]=N=>H("allow",!0)),disabled:a.value},E(a.value&&r.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Pu)):O("",!0),n("button",{class:X(["btn",_.value?"btn-outline-success":"btn-success"]),onClick:S[1]||(S[1]=N=>H("allow",!1)),disabled:a.value},E(a.value&&r.value==="approve"?"â³ Submitting...":_.value?"âœ… Approve Only":"âœ… Approve"),11,Ru),n("button",{class:"btn btn-danger",onClick:S[2]||(S[2]=N=>H("deny",!1)),disabled:a.value}," ðŸš« "+E(a.value&&r.value==="deny"?"Submitting...":"Deny"),9,Wu)]),n("div",Hu,[S[13]||(S[13]=n("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),S[14]||(S[14]=n("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),_e(n("textarea",{"onUpdate:modelValue":S[3]||(S[3]=N=>d.value=N),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Vu),[[We,d.value]]),d.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:S[4]||(S[4]=N=>H("deny",!1,d.value)),disabled:a.value},E(a.value&&r.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Fu)):O("",!0)])])):O("",!0),$.value==="permission_required"&&p.value?(u(),m("div",Bu,[n("div",Uu,[n("div",qu,[S[16]||(S[16]=n("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),n("div",null,[S[15]||(S[15]=n("strong",null,"Permission Request Cancelled",-1)),n("p",zu,E(f.value?.message||"Session was terminated before permission could be granted"),1)])])])])):O("",!0),s.toolCall.permissionDecision==="deny"?(u(),m("div",Ku,[n("div",Gu,[S[17]||(S[17]=Z(" ðŸš« Permission denied ",-1)),s.toolCall.result?.message?(u(),m("span",Yu," - "+E(s.toolCall.result.message),1)):O("",!0)])])):O("",!0)])):O("",!0)],2))}},yn=se(Ju,[["__scopeId","data-v-e339198b"]]),Xu={class:"tool-footer-container"},Qu=["aria-label","onKeydown"],Zu={class:"footer-left"},ed={class:"footer-text"},td={class:"footer-middle"},sd={class:"footer-text"},nd={class:"footer-right"},od={class:"expand-icon"},id={key:0,class:"tool-footer-expanded"},ad={key:1,class:"active-tools-area"},rd={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(s){const e=s,t=Me(),o=le(),i=I(!1);function a(y){return y.map((w,b)=>({tool:w,originalIndex:b})).sort((w,b)=>{if(w.tool.timestamp&&b.tool.timestamp){const l=new Date(w.tool.timestamp).getTime(),h=new Date(b.tool.timestamp).getTime();if(l!==h)return l-h}return w.originalIndex-b.originalIndex}).map(({tool:w})=>w)}const r=v(()=>{const y=e.tools.filter(w=>w.status==="executing"||w.status==="permission_required");return a(y)}),d=v(()=>{const y=e.tools.filter(w=>w.status!=="executing"&&w.status!=="permission_required");return a(y)}),p=v(()=>{const y=new Map;e.tools.forEach(_=>{const x=y.get(_.name)||0;y.set(_.name,x+1)});const w=Array.from(y.entries()).sort((_,x)=>x[1]-_[1]),b=w.slice(0,5),l=w.length-b.length,h=b.map(([_,x])=>`${_} (${x})`).join(", ");return l>0?`${h}, +${l} more`:h}),f=v(()=>{const y=e.tools.length;let w=0,b=0,l=0;e.tools.forEach(D=>{const q=o.currentSessionId;(q?t.isToolUseOrphaned(q,D.id):!1)?l++:D.status==="completed"&&!D.result?.error&&D.permissionDecision!=="deny"?w++:(D.status==="error"||D.result?.error||D.permissionDecision==="deny")&&b++});let h=[];w>0&&h.push(`${w} âœ…`),b>0&&h.push(`${b} âŒ`),l>0&&h.push(`${l} â¹ï¸`);const _=y===1?"tool":"tools",x=h.length>0?": "+h.join(" "):"";return`${y} ${_}${x}`}),c=v(()=>i.value?"â–²":"â–¼"),$=v(()=>{const y=o.currentSessionId,w=e.tools.some(_=>_.status==="error"||_.result?.error||_.permissionDecision==="deny"),b=e.tools.some(_=>y?t.isToolUseOrphaned(y,_.id):!1),l=r.value.length>0,h=e.tools.every(_=>!(y?t.isToolUseOrphaned(y,_.id):!1)&&_.status==="completed"&&!_.result?.error&&_.permissionDecision!=="deny");return w?"footer-status-error":b?"footer-status-orphaned":l?"footer-status-in-progress":h?"footer-status-success":""});function g(){i.value=!i.value}return(y,w)=>(u(),m("div",Xu,[n("div",{class:X(["tool-footer-summary",$.value]),onClick:g,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Be(g,["enter"]),Be(he(g,["prevent"]),["space"])]},[n("div",Zu,[n("span",ed,"Used: "+E(p.value),1)]),n("div",td,[w[0]||(w[0]=n("span",{class:"footer-separator"},"|",-1)),n("span",sd,E(f.value),1)]),n("div",nd,[n("span",od,E(c.value),1)])],42,Qu),i.value?(u(),m("div",id,[(u(!0),m(ie,null,ae(d.value,b=>(u(),ye(yn,{key:b.id,toolCall:b},null,8,["toolCall"]))),128))])):O("",!0),r.value.length>0?(u(),m("div",ad,[(u(!0),m(ie,null,ae(r.value,b=>(u(),ye(yn,{key:b.id,toolCall:b},null,8,["toolCall"]))),128))])):O("",!0)]))}},ld=se(rd,[["__scopeId","data-v-7bae7ae1"]]),cd={class:"message-row message-row-assistant"},ud=["title"],dd={class:"message-content-column"},md={key:0,class:"thinking-block mb-2"},pd=["innerHTML"],fd={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(s){const e=s,t=Me(),o=le();at.setOptions({breaks:!0,gfm:!0});const i=v(()=>Rt(e.message.timestamp)),a=v(()=>e.message.metadata?.model||null),r=v(()=>{const w=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${w}`}),d=v(()=>{const w=e.message.content||"";return w.trim().length>0&&w!=="Assistant response"}),p=v(()=>{const w=e.message.content||"";let b=at.parse(w);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),rs.sanitize(b)}),f=v(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=v(()=>e.message.metadata?.thinking_content||""),$=v(()=>{const w=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return w||b}),g=v(()=>{const w=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],l=[...w],h=new Set(w.map(_=>_.id));for(const _ of b)h.has(_.id)||l.push(_);return l}),y=v(()=>{const w=o.currentSessionId;if(!w)return[];const b=t.toolCallsBySession.get(w)||[];return g.value.map(l=>{const h=b.find(_=>_.id===l.id);return h||{id:l.id,name:l.name,input:l.input,status:"pending",result:null,timestamp:l.timestamp||e.message.timestamp,isExpanded:!0}})});return(w,b)=>(u(),m("div",cd,[n("div",{class:"message-speaker",title:r.value},[...b[0]||(b[0]=[n("span",{class:"speaker-label"},"assistant",-1)])],8,ud),n("div",dd,[f.value?(u(),m("div",md,[me(fa,{thinking:c.value},null,8,["thinking"])])):O("",!0),d.value?(u(),m("div",{key:1,class:"message-text",innerHTML:p.value},null,8,pd)):O("",!0),$.value?(u(),ye(ld,{key:2,tools:y.value},null,8,["tools"])):O("",!0)])]))}},vd=se(fd,[["__scopeId","data-v-2e32f6ef"]]),hd={key:0,class:"message-row message-row-compaction"},_d=["title"],gd={class:"message-content-column"},bd={class:"compaction-status-content"},yd={class:"text-muted ms-auto"},wd={key:1,class:"message-row message-row-system"},$d=["title"],Ed={class:"message-content-column"},Sd={class:"system-text"},Cd={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(s){const e=s,t=v(()=>Rt(e.message.timestamp)),o=v(()=>`system
${t.value}`),i=v(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,r)=>i.value?(u(),m("div",hd,[n("div",{class:"message-speaker",title:o.value},[...r[0]||(r[0]=[n("span",{class:"speaker-label"},"system",-1)])],8,_d),n("div",gd,[n("div",bd,[r[1]||(r[1]=n("span",{class:"me-2"},"ðŸ—œï¸",-1)),r[2]||(r[2]=n("strong",{class:"me-2"},"Context compaction in progress...",-1)),n("small",yd,E(t.value),1)])])])):(u(),m("div",wd,[n("div",{class:"message-speaker",title:o.value},[...r[3]||(r[3]=[n("span",{class:"speaker-label"},"system",-1)])],8,$d),n("div",Ed,[n("span",Sd,E(s.message.content),1)])]))}},wn=se(Cd,[["__scopeId","data-v-a078178f"]]),kd={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(s){const e=s,t=v(()=>{switch(e.message.type){case"user":return ra;case"assistant":return vd;case"system":return wn;default:return wn}});return(o,i)=>(u(),ye(oo(t.value),{message:s.message,attachedTools:s.attachedTools},null,8,["message","attachedTools"]))}},Td=se(kd,[["__scopeId","data-v-11dff525"]]);var we="top",Ce="bottom",ke="right",$e="left",ls="auto",At=[we,Ce,ke,$e],rt="start",wt="end",ao="clippingParents",zs="viewport",vt="popper",ro="reference",Ws=At.reduce(function(s,e){return s.concat([e+"-"+rt,e+"-"+wt])},[]),Ks=[].concat(At,[ls]).reduce(function(s,e){return s.concat([e,e+"-"+rt,e+"-"+wt])},[]),lo="beforeRead",co="read",uo="afterRead",mo="beforeMain",po="main",fo="afterMain",vo="beforeWrite",ho="write",_o="afterWrite",go=[lo,co,uo,mo,po,fo,vo,ho,_o];function Fe(s){return s?(s.nodeName||"").toLowerCase():null}function Te(s){if(s==null)return window;if(s.toString()!=="[object Window]"){var e=s.ownerDocument;return e&&e.defaultView||window}return s}function lt(s){var e=Te(s).Element;return s instanceof e||s instanceof Element}function Ae(s){var e=Te(s).HTMLElement;return s instanceof e||s instanceof HTMLElement}function Gs(s){if(typeof ShadowRoot>"u")return!1;var e=Te(s).ShadowRoot;return s instanceof e||s instanceof ShadowRoot}function xd(s){var e=s.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Ae(a)||!Fe(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var d=i[r];d===!1?a.removeAttribute(r):a.setAttribute(r,d===!0?"":d)}))})}function Ad(s){var e=s.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),d=r.reduce(function(p,f){return p[f]="",p},{});!Ae(i)||!Fe(i)||(Object.assign(i.style,d),Object.keys(a).forEach(function(p){i.removeAttribute(p)}))})}}const bo={name:"applyStyles",enabled:!0,phase:"write",fn:xd,effect:Ad,requires:["computeStyles"]};function He(s){return s.split("-")[0]}var it=Math.max,ns=Math.min,$t=Math.round;function Hs(){var s=navigator.userAgentData;return s!=null&&s.brands&&Array.isArray(s.brands)?s.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function yo(){return!/^((?!chrome|android).)*safari/i.test(Hs())}function Et(s,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=s.getBoundingClientRect(),i=1,a=1;e&&Ae(s)&&(i=s.offsetWidth>0&&$t(o.width)/s.offsetWidth||1,a=s.offsetHeight>0&&$t(o.height)/s.offsetHeight||1);var r=lt(s)?Te(s):window,d=r.visualViewport,p=!yo()&&t,f=(o.left+(p&&d?d.offsetLeft:0))/i,c=(o.top+(p&&d?d.offsetTop:0))/a,$=o.width/i,g=o.height/a;return{width:$,height:g,top:c,right:f+$,bottom:c+g,left:f,x:f,y:c}}function Ys(s){var e=Et(s),t=s.offsetWidth,o=s.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:s.offsetLeft,y:s.offsetTop,width:t,height:o}}function wo(s,e){var t=e.getRootNode&&e.getRootNode();if(s.contains(e))return!0;if(t&&Gs(t)){var o=e;do{if(o&&s.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function ze(s){return Te(s).getComputedStyle(s)}function Md(s){return["table","td","th"].indexOf(Fe(s))>=0}function et(s){return((lt(s)?s.ownerDocument:s.document)||window.document).documentElement}function cs(s){return Fe(s)==="html"?s:s.assignedSlot||s.parentNode||(Gs(s)?s.host:null)||et(s)}function $n(s){return!Ae(s)||ze(s).position==="fixed"?null:s.offsetParent}function Od(s){var e=/firefox/i.test(Hs()),t=/Trident/i.test(Hs());if(t&&Ae(s)){var o=ze(s);if(o.position==="fixed")return null}var i=cs(s);for(Gs(i)&&(i=i.host);Ae(i)&&["html","body"].indexOf(Fe(i))<0;){var a=ze(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Wt(s){for(var e=Te(s),t=$n(s);t&&Md(t)&&ze(t).position==="static";)t=$n(t);return t&&(Fe(t)==="html"||Fe(t)==="body"&&ze(t).position==="static")?e:t||Od(s)||e}function Js(s){return["top","bottom"].indexOf(s)>=0?"x":"y"}function It(s,e,t){return it(s,ns(e,t))}function Dd(s,e,t){var o=It(s,e,t);return o>t?t:o}function $o(){return{top:0,right:0,bottom:0,left:0}}function Eo(s){return Object.assign({},$o(),s)}function So(s,e){return e.reduce(function(t,o){return t[o]=s,t},{})}var Nd=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Eo(typeof e!="number"?e:So(e,At))};function Ld(s){var e,t=s.state,o=s.name,i=s.options,a=t.elements.arrow,r=t.modifiersData.popperOffsets,d=He(t.placement),p=Js(d),f=[$e,ke].indexOf(d)>=0,c=f?"height":"width";if(!(!a||!r)){var $=Nd(i.padding,t),g=Ys(a),y=p==="y"?we:$e,w=p==="y"?Ce:ke,b=t.rects.reference[c]+t.rects.reference[p]-r[p]-t.rects.popper[c],l=r[p]-t.rects.reference[p],h=Wt(a),_=h?p==="y"?h.clientHeight||0:h.clientWidth||0:0,x=b/2-l/2,D=$[y],q=_-g[c]-$[w],K=_/2-g[c]/2+x,L=It(D,K,q),F=p;t.modifiersData[o]=(e={},e[F]=L,e.centerOffset=L-K,e)}}function Id(s){var e=s.state,t=s.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||wo(e.elements.popper,i)&&(e.elements.arrow=i))}const Co={name:"arrow",enabled:!0,phase:"main",fn:Ld,effect:Id,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function St(s){return s.split("-")[1]}var jd={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Pd(s,e){var t=s.x,o=s.y,i=e.devicePixelRatio||1;return{x:$t(t*i)/i||0,y:$t(o*i)/i||0}}function En(s){var e,t=s.popper,o=s.popperRect,i=s.placement,a=s.variation,r=s.offsets,d=s.position,p=s.gpuAcceleration,f=s.adaptive,c=s.roundOffsets,$=s.isFixed,g=r.x,y=g===void 0?0:g,w=r.y,b=w===void 0?0:w,l=typeof c=="function"?c({x:y,y:b}):{x:y,y:b};y=l.x,b=l.y;var h=r.hasOwnProperty("x"),_=r.hasOwnProperty("y"),x=$e,D=we,q=window;if(f){var K=Wt(t),L="clientHeight",F="clientWidth";if(K===Te(t)&&(K=et(t),ze(K).position!=="static"&&d==="absolute"&&(L="scrollHeight",F="scrollWidth")),K=K,i===we||(i===$e||i===ke)&&a===wt){D=Ce;var C=$&&K===q&&q.visualViewport?q.visualViewport.height:K[L];b-=C-o.height,b*=p?1:-1}if(i===$e||(i===we||i===Ce)&&a===wt){x=ke;var A=$&&K===q&&q.visualViewport?q.visualViewport.width:K[F];y-=A-o.width,y*=p?1:-1}}var V=Object.assign({position:d},f&&jd),H=c===!0?Pd({x:y,y:b},Te(t)):{x:y,y:b};if(y=H.x,b=H.y,p){var T;return Object.assign({},V,(T={},T[D]=_?"0":"",T[x]=h?"0":"",T.transform=(q.devicePixelRatio||1)<=1?"translate("+y+"px, "+b+"px)":"translate3d("+y+"px, "+b+"px, 0)",T))}return Object.assign({},V,(e={},e[D]=_?b+"px":"",e[x]=h?y+"px":"",e.transform="",e))}function Rd(s){var e=s.state,t=s.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,r=a===void 0?!0:a,d=t.roundOffsets,p=d===void 0?!0:d,f={placement:He(e.placement),variation:St(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,En(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,En(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const ko={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Rd,data:{}};var qt={passive:!0};function Wd(s){var e=s.state,t=s.instance,o=s.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,d=r===void 0?!0:r,p=Te(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&f.forEach(function(c){c.addEventListener("scroll",t.update,qt)}),d&&p.addEventListener("resize",t.update,qt),function(){a&&f.forEach(function(c){c.removeEventListener("scroll",t.update,qt)}),d&&p.removeEventListener("resize",t.update,qt)}}const To={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Wd,data:{}};var Hd={left:"right",right:"left",bottom:"top",top:"bottom"};function Qt(s){return s.replace(/left|right|bottom|top/g,function(e){return Hd[e]})}var Vd={start:"end",end:"start"};function Sn(s){return s.replace(/start|end/g,function(e){return Vd[e]})}function Xs(s){var e=Te(s),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Qs(s){return Et(et(s)).left+Xs(s).scrollLeft}function Fd(s,e){var t=Te(s),o=et(s),i=t.visualViewport,a=o.clientWidth,r=o.clientHeight,d=0,p=0;if(i){a=i.width,r=i.height;var f=yo();(f||!f&&e==="fixed")&&(d=i.offsetLeft,p=i.offsetTop)}return{width:a,height:r,x:d+Qs(s),y:p}}function Bd(s){var e,t=et(s),o=Xs(s),i=(e=s.ownerDocument)==null?void 0:e.body,a=it(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=it(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),d=-o.scrollLeft+Qs(s),p=-o.scrollTop;return ze(i||t).direction==="rtl"&&(d+=it(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:d,y:p}}function Zs(s){var e=ze(s),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function xo(s){return["html","body","#document"].indexOf(Fe(s))>=0?s.ownerDocument.body:Ae(s)&&Zs(s)?s:xo(cs(s))}function jt(s,e){var t;e===void 0&&(e=[]);var o=xo(s),i=o===((t=s.ownerDocument)==null?void 0:t.body),a=Te(o),r=i?[a].concat(a.visualViewport||[],Zs(o)?o:[]):o,d=e.concat(r);return i?d:d.concat(jt(cs(r)))}function Vs(s){return Object.assign({},s,{left:s.x,top:s.y,right:s.x+s.width,bottom:s.y+s.height})}function Ud(s,e){var t=Et(s,!1,e==="fixed");return t.top=t.top+s.clientTop,t.left=t.left+s.clientLeft,t.bottom=t.top+s.clientHeight,t.right=t.left+s.clientWidth,t.width=s.clientWidth,t.height=s.clientHeight,t.x=t.left,t.y=t.top,t}function Cn(s,e,t){return e===zs?Vs(Fd(s,t)):lt(e)?Ud(e,t):Vs(Bd(et(s)))}function qd(s){var e=jt(cs(s)),t=["absolute","fixed"].indexOf(ze(s).position)>=0,o=t&&Ae(s)?Wt(s):s;return lt(o)?e.filter(function(i){return lt(i)&&wo(i,o)&&Fe(i)!=="body"}):[]}function zd(s,e,t,o){var i=e==="clippingParents"?qd(s):[].concat(e),a=[].concat(i,[t]),r=a[0],d=a.reduce(function(p,f){var c=Cn(s,f,o);return p.top=it(c.top,p.top),p.right=ns(c.right,p.right),p.bottom=ns(c.bottom,p.bottom),p.left=it(c.left,p.left),p},Cn(s,r,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function Ao(s){var e=s.reference,t=s.element,o=s.placement,i=o?He(o):null,a=o?St(o):null,r=e.x+e.width/2-t.width/2,d=e.y+e.height/2-t.height/2,p;switch(i){case we:p={x:r,y:e.y-t.height};break;case Ce:p={x:r,y:e.y+e.height};break;case ke:p={x:e.x+e.width,y:d};break;case $e:p={x:e.x-t.width,y:d};break;default:p={x:e.x,y:e.y}}var f=i?Js(i):null;if(f!=null){var c=f==="y"?"height":"width";switch(a){case rt:p[f]=p[f]-(e[c]/2-t[c]/2);break;case wt:p[f]=p[f]+(e[c]/2-t[c]/2);break}}return p}function Ct(s,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?s.placement:o,a=t.strategy,r=a===void 0?s.strategy:a,d=t.boundary,p=d===void 0?ao:d,f=t.rootBoundary,c=f===void 0?zs:f,$=t.elementContext,g=$===void 0?vt:$,y=t.altBoundary,w=y===void 0?!1:y,b=t.padding,l=b===void 0?0:b,h=Eo(typeof l!="number"?l:So(l,At)),_=g===vt?ro:vt,x=s.rects.popper,D=s.elements[w?_:g],q=zd(lt(D)?D:D.contextElement||et(s.elements.popper),p,c,r),K=Et(s.elements.reference),L=Ao({reference:K,element:x,placement:i}),F=Vs(Object.assign({},x,L)),C=g===vt?F:K,A={top:q.top-C.top+h.top,bottom:C.bottom-q.bottom+h.bottom,left:q.left-C.left+h.left,right:C.right-q.right+h.right},V=s.modifiersData.offset;if(g===vt&&V){var H=V[i];Object.keys(A).forEach(function(T){var S=[ke,Ce].indexOf(T)>=0?1:-1,N=[we,Ce].indexOf(T)>=0?"y":"x";A[T]+=H[N]*S})}return A}function Kd(s,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,r=t.padding,d=t.flipVariations,p=t.allowedAutoPlacements,f=p===void 0?Ks:p,c=St(o),$=c?d?Ws:Ws.filter(function(w){return St(w)===c}):At,g=$.filter(function(w){return f.indexOf(w)>=0});g.length===0&&(g=$);var y=g.reduce(function(w,b){return w[b]=Ct(s,{placement:b,boundary:i,rootBoundary:a,padding:r})[He(b)],w},{});return Object.keys(y).sort(function(w,b){return y[w]-y[b]})}function Gd(s){if(He(s)===ls)return[];var e=Qt(s);return[Sn(s),e,Sn(e)]}function Yd(s){var e=s.state,t=s.options,o=s.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,d=r===void 0?!0:r,p=t.fallbackPlacements,f=t.padding,c=t.boundary,$=t.rootBoundary,g=t.altBoundary,y=t.flipVariations,w=y===void 0?!0:y,b=t.allowedAutoPlacements,l=e.options.placement,h=He(l),_=h===l,x=p||(_||!w?[Qt(l)]:Gd(l)),D=[l].concat(x).reduce(function(re,fe){return re.concat(He(fe)===ls?Kd(e,{placement:fe,boundary:c,rootBoundary:$,padding:f,flipVariations:w,allowedAutoPlacements:b}):fe)},[]),q=e.rects.reference,K=e.rects.popper,L=new Map,F=!0,C=D[0],A=0;A<D.length;A++){var V=D[A],H=He(V),T=St(V)===rt,S=[we,Ce].indexOf(H)>=0,N=S?"width":"height",M=Ct(e,{placement:V,boundary:c,rootBoundary:$,altBoundary:g,padding:f}),k=S?T?ke:$e:T?Ce:we;q[N]>K[N]&&(k=Qt(k));var j=Qt(k),U=[];if(a&&U.push(M[H]<=0),d&&U.push(M[k]<=0,M[j]<=0),U.every(function(re){return re})){C=V,F=!1;break}L.set(V,U)}if(F)for(var G=w?3:1,Q=function(fe){var z=D.find(function(P){var R=L.get(P);if(R)return R.slice(0,fe).every(function(Y){return Y})});if(z)return C=z,"break"},ue=G;ue>0;ue--){var ce=Q(ue);if(ce==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const Mo={name:"flip",enabled:!0,phase:"main",fn:Yd,requiresIfExists:["offset"],data:{_skip:!1}};function kn(s,e,t){return t===void 0&&(t={x:0,y:0}),{top:s.top-e.height-t.y,right:s.right-e.width+t.x,bottom:s.bottom-e.height+t.y,left:s.left-e.width-t.x}}function Tn(s){return[we,ke,Ce,$e].some(function(e){return s[e]>=0})}function Jd(s){var e=s.state,t=s.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=Ct(e,{elementContext:"reference"}),d=Ct(e,{altBoundary:!0}),p=kn(r,o),f=kn(d,i,a),c=Tn(p),$=Tn(f);e.modifiersData[t]={referenceClippingOffsets:p,popperEscapeOffsets:f,isReferenceHidden:c,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":$})}const Oo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Jd};function Xd(s,e,t){var o=He(s),i=[$e,we].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:s})):t,r=a[0],d=a[1];return r=r||0,d=(d||0)*i,[$e,ke].indexOf(o)>=0?{x:d,y:r}:{x:r,y:d}}function Qd(s){var e=s.state,t=s.options,o=s.name,i=t.offset,a=i===void 0?[0,0]:i,r=Ks.reduce(function(c,$){return c[$]=Xd($,e.rects,a),c},{}),d=r[e.placement],p=d.x,f=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=r}const Do={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Qd};function Zd(s){var e=s.state,t=s.name;e.modifiersData[t]=Ao({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const No={name:"popperOffsets",enabled:!0,phase:"read",fn:Zd,data:{}};function em(s){return s==="x"?"y":"x"}function tm(s){var e=s.state,t=s.options,o=s.name,i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,d=r===void 0?!1:r,p=t.boundary,f=t.rootBoundary,c=t.altBoundary,$=t.padding,g=t.tether,y=g===void 0?!0:g,w=t.tetherOffset,b=w===void 0?0:w,l=Ct(e,{boundary:p,rootBoundary:f,padding:$,altBoundary:c}),h=He(e.placement),_=St(e.placement),x=!_,D=Js(h),q=em(D),K=e.modifiersData.popperOffsets,L=e.rects.reference,F=e.rects.popper,C=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,A=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),V=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,H={x:0,y:0};if(K){if(a){var T,S=D==="y"?we:$e,N=D==="y"?Ce:ke,M=D==="y"?"height":"width",k=K[D],j=k+l[S],U=k-l[N],G=y?-F[M]/2:0,Q=_===rt?L[M]:F[M],ue=_===rt?-F[M]:-L[M],ce=e.elements.arrow,re=y&&ce?Ys(ce):{width:0,height:0},fe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:$o(),z=fe[S],P=fe[N],R=It(0,L[M],re[M]),Y=x?L[M]/2-G-R-z-A.mainAxis:Q-R-z-A.mainAxis,J=x?-L[M]/2+G+R+P+A.mainAxis:ue+R+P+A.mainAxis,pe=e.elements.arrow&&Wt(e.elements.arrow),mt=pe?D==="y"?pe.clientTop||0:pe.clientLeft||0:0,Ie=(T=V?.[D])!=null?T:0,Ge=k+Y-Ie-mt,W=k+J-Ie,te=It(y?ns(j,Ge):j,k,y?it(U,W):U);K[D]=te,H[D]=te-k}if(d){var ne,je=D==="x"?we:$e,Pe=D==="x"?Ce:ke,be=K[q],Ut=q==="y"?"height":"width",ln=be+l[je],cn=be-l[Pe],hs=[we,$e].indexOf(h)!==-1,un=(ne=V?.[q])!=null?ne:0,dn=hs?ln:be-L[Ut]-F[Ut]-un+A.altAxis,mn=hs?be+L[Ut]+F[Ut]-un-A.altAxis:cn,pn=y&&hs?Dd(dn,be,mn):It(y?dn:ln,be,y?mn:cn);K[q]=pn,H[q]=pn-be}e.modifiersData[o]=H}}const Lo={name:"preventOverflow",enabled:!0,phase:"main",fn:tm,requiresIfExists:["offset"]};function sm(s){return{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}}function nm(s){return s===Te(s)||!Ae(s)?Xs(s):sm(s)}function om(s){var e=s.getBoundingClientRect(),t=$t(e.width)/s.offsetWidth||1,o=$t(e.height)/s.offsetHeight||1;return t!==1||o!==1}function im(s,e,t){t===void 0&&(t=!1);var o=Ae(e),i=Ae(e)&&om(e),a=et(e),r=Et(s,i,t),d={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!t)&&((Fe(e)!=="body"||Zs(a))&&(d=nm(e)),Ae(e)?(p=Et(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):a&&(p.x=Qs(a))),{x:r.left+d.scrollLeft-p.x,y:r.top+d.scrollTop-p.y,width:r.width,height:r.height}}function am(s){var e=new Map,t=new Set,o=[];s.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(d){if(!t.has(d)){var p=e.get(d);p&&i(p)}}),o.push(a)}return s.forEach(function(a){t.has(a.name)||i(a)}),o}function rm(s){var e=am(s);return go.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function lm(s){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(s())})})),e}}function cm(s){var e=s.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var xn={placement:"bottom",modifiers:[],strategy:"absolute"};function An(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Io(s){s===void 0&&(s={});var e=s,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?xn:i;return function(d,p,f){f===void 0&&(f=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},xn,a),modifiersData:{},elements:{reference:d,popper:p},attributes:{},styles:{}},$=[],g=!1,y={state:c,setOptions:function(h){var _=typeof h=="function"?h(c.options):h;b(),c.options=Object.assign({},a,c.options,_),c.scrollParents={reference:lt(d)?jt(d):d.contextElement?jt(d.contextElement):[],popper:jt(p)};var x=rm(cm([].concat(o,c.options.modifiers)));return c.orderedModifiers=x.filter(function(D){return D.enabled}),w(),y.update()},forceUpdate:function(){if(!g){var h=c.elements,_=h.reference,x=h.popper;if(An(_,x)){c.rects={reference:im(_,Wt(x),c.options.strategy==="fixed"),popper:Ys(x)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(A){return c.modifiersData[A.name]=Object.assign({},A.data)});for(var D=0;D<c.orderedModifiers.length;D++){if(c.reset===!0){c.reset=!1,D=-1;continue}var q=c.orderedModifiers[D],K=q.fn,L=q.options,F=L===void 0?{}:L,C=q.name;typeof K=="function"&&(c=K({state:c,options:F,name:C,instance:y})||c)}}}},update:lm(function(){return new Promise(function(l){y.forceUpdate(),l(c)})}),destroy:function(){b(),g=!0}};if(!An(d,p))return y;y.setOptions(f).then(function(l){!g&&f.onFirstUpdate&&f.onFirstUpdate(l)});function w(){c.orderedModifiers.forEach(function(l){var h=l.name,_=l.options,x=_===void 0?{}:_,D=l.effect;if(typeof D=="function"){var q=D({state:c,name:h,instance:y,options:x}),K=function(){};$.push(q||K)}})}function b(){$.forEach(function(l){return l()}),$=[]}return y}}var um=[To,No,ko,bo,Do,Mo,Lo,Co,Oo],en=Io({defaultModifiers:um});const jo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:fo,afterRead:uo,afterWrite:_o,applyStyles:bo,arrow:Co,auto:ls,basePlacements:At,beforeMain:mo,beforeRead:lo,beforeWrite:vo,bottom:Ce,clippingParents:ao,computeStyles:ko,createPopper:en,detectOverflow:Ct,end:wt,eventListeners:To,flip:Mo,hide:Oo,left:$e,main:po,modifierPhases:go,offset:Do,placements:Ks,popper:vt,popperGenerator:Io,popperOffsets:No,preventOverflow:Lo,read:co,reference:ro,right:ke,start:rt,top:we,variationPlacements:Ws,viewport:zs,write:ho},Symbol.toStringTag,{value:"Module"}));const Ye=new Map,Es={set(s,e,t){Ye.has(s)||Ye.set(s,new Map);const o=Ye.get(s);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(s,e){return Ye.has(s)&&Ye.get(s).get(e)||null},remove(s,e){if(!Ye.has(s))return;const t=Ye.get(s);t.delete(e),t.size===0&&Ye.delete(s)}},dm=1e6,mm=1e3,Fs="transitionend",Po=s=>(s&&window.CSS&&window.CSS.escape&&(s=s.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),s),pm=s=>s==null?`${s}`:Object.prototype.toString.call(s).match(/\s([a-z]+)/i)[1].toLowerCase(),fm=s=>{do s+=Math.floor(Math.random()*dm);while(document.getElementById(s));return s},vm=s=>{if(!s)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(s);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*mm)},Ro=s=>{s.dispatchEvent(new Event(Fs))},Ue=s=>!s||typeof s!="object"?!1:(typeof s.jquery<"u"&&(s=s[0]),typeof s.nodeType<"u"),Je=s=>Ue(s)?s.jquery?s[0]:s:typeof s=="string"&&s.length>0?document.querySelector(Po(s)):null,Mt=s=>{if(!Ue(s)||s.getClientRects().length===0)return!1;const e=getComputedStyle(s).getPropertyValue("visibility")==="visible",t=s.closest("details:not([open])");if(!t)return e;if(t!==s){const o=s.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Xe=s=>!s||s.nodeType!==Node.ELEMENT_NODE||s.classList.contains("disabled")?!0:typeof s.disabled<"u"?s.disabled:s.hasAttribute("disabled")&&s.getAttribute("disabled")!=="false",Wo=s=>{if(!document.documentElement.attachShadow)return null;if(typeof s.getRootNode=="function"){const e=s.getRootNode();return e instanceof ShadowRoot?e:null}return s instanceof ShadowRoot?s:s.parentNode?Wo(s.parentNode):null},os=()=>{},Ht=s=>{s.offsetHeight},Ho=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ss=[],hm=s=>{document.readyState==="loading"?(Ss.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ss)e()}),Ss.push(s)):s()},Oe=()=>document.documentElement.dir==="rtl",Le=s=>{hm(()=>{const e=Ho();if(e){const t=s.NAME,o=e.fn[t];e.fn[t]=s.jQueryInterface,e.fn[t].Constructor=s,e.fn[t].noConflict=()=>(e.fn[t]=o,s.jQueryInterface)}})},Ee=(s,e=[],t=s)=>typeof s=="function"?s.call(...e):t,Vo=(s,e,t=!0)=>{if(!t){Ee(s);return}const i=vm(e)+5;let a=!1;const r=({target:d})=>{d===e&&(a=!0,e.removeEventListener(Fs,r),Ee(s))};e.addEventListener(Fs,r),setTimeout(()=>{a||Ro(e)},i)},tn=(s,e,t,o)=>{const i=s.length;let a=s.indexOf(e);return a===-1?!t&&o?s[i-1]:s[0]:(a+=t?1:-1,o&&(a=(a+i)%i),s[Math.max(0,Math.min(a,i-1))])},_m=/[^.]*(?=\..*)\.|.*/,gm=/\..*/,bm=/::\d+$/,Cs={};let Mn=1;const Fo={mouseenter:"mouseover",mouseleave:"mouseout"},ym=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Bo(s,e){return e&&`${e}::${Mn++}`||s.uidEvent||Mn++}function Uo(s){const e=Bo(s);return s.uidEvent=e,Cs[e]=Cs[e]||{},Cs[e]}function wm(s,e){return function t(o){return sn(o,{delegateTarget:s}),t.oneOff&&B.off(s,o.type,e),e.apply(s,[o])}}function $m(s,e,t){return function o(i){const a=s.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const d of a)if(d===r)return sn(i,{delegateTarget:r}),o.oneOff&&B.off(s,i.type,e,t),t.apply(r,[i])}}function qo(s,e,t=null){return Object.values(s).find(o=>o.callable===e&&o.delegationSelector===t)}function zo(s,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Ko(s);return ym.has(a)||(a=s),[o,i,a]}function On(s,e,t,o,i){if(typeof e!="string"||!s)return;let[a,r,d]=zo(e,t,o);e in Fo&&(r=(w=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return w.call(this,b)})(r));const p=Uo(s),f=p[d]||(p[d]={}),c=qo(f,r,a?t:null);if(c){c.oneOff=c.oneOff&&i;return}const $=Bo(r,e.replace(_m,"")),g=a?$m(s,t,r):wm(s,r);g.delegationSelector=a?t:null,g.callable=r,g.oneOff=i,g.uidEvent=$,f[$]=g,s.addEventListener(d,g,a)}function Bs(s,e,t,o,i){const a=qo(e[t],o,i);a&&(s.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function Em(s,e,t,o){const i=e[t]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&Bs(s,e,t,r.callable,r.delegationSelector)}function Ko(s){return s=s.replace(gm,""),Fo[s]||s}const B={on(s,e,t,o){On(s,e,t,o,!1)},one(s,e,t,o){On(s,e,t,o,!0)},off(s,e,t,o){if(typeof e!="string"||!s)return;const[i,a,r]=zo(e,t,o),d=r!==e,p=Uo(s),f=p[r]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(f).length)return;Bs(s,p,r,a,i?t:null);return}if(c)for(const $ of Object.keys(p))Em(s,p,$,e.slice(1));for(const[$,g]of Object.entries(f)){const y=$.replace(bm,"");(!d||e.includes(y))&&Bs(s,p,r,g.callable,g.delegationSelector)}},trigger(s,e,t){if(typeof e!="string"||!s)return null;const o=Ho(),i=Ko(e),a=e!==i;let r=null,d=!0,p=!0,f=!1;a&&o&&(r=o.Event(e,t),o(s).trigger(r),d=!r.isPropagationStopped(),p=!r.isImmediatePropagationStopped(),f=r.isDefaultPrevented());const c=sn(new Event(e,{bubbles:d,cancelable:!0}),t);return f&&c.preventDefault(),p&&s.dispatchEvent(c),c.defaultPrevented&&r&&r.preventDefault(),c}};function sn(s,e={}){for(const[t,o]of Object.entries(e))try{s[t]=o}catch{Object.defineProperty(s,t,{configurable:!0,get(){return o}})}return s}function Dn(s){if(s==="true")return!0;if(s==="false")return!1;if(s===Number(s).toString())return Number(s);if(s===""||s==="null")return null;if(typeof s!="string")return s;try{return JSON.parse(decodeURIComponent(s))}catch{return s}}function ks(s){return s.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const qe={setDataAttribute(s,e,t){s.setAttribute(`data-bs-${ks(e)}`,t)},removeDataAttribute(s,e){s.removeAttribute(`data-bs-${ks(e)}`)},getDataAttributes(s){if(!s)return{};const e={},t=Object.keys(s.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Dn(s.dataset[o])}return e},getDataAttribute(s,e){return Dn(s.getAttribute(`data-bs-${ks(e)}`))}};class Vt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Ue(t)?qe.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ue(t)?qe.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],r=Ue(a)?"element":pm(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const Sm="5.3.8";class Re extends Vt{constructor(e,t){super(),e=Je(e),e&&(this._element=e,this._config=this._getConfig(t),Es.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Es.remove(this._element,this.constructor.DATA_KEY),B.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Vo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Es.get(Je(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Sm}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ts=s=>{let e=s.getAttribute("data-bs-target");if(!e||e==="#"){let t=s.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Po(t)).join(","):null},ee={find(s,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,s))},findOne(s,e=document.documentElement){return Element.prototype.querySelector.call(e,s)},children(s,e){return[].concat(...s.children).filter(t=>t.matches(e))},parents(s,e){const t=[];let o=s.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(s,e){let t=s.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(s,e){let t=s.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(s){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,s).filter(t=>!Xe(t)&&Mt(t))},getSelectorFromElement(s){const e=Ts(s);return e&&ee.findOne(e)?e:null},getElementFromSelector(s){const e=Ts(s);return e?ee.findOne(e):null},getMultipleElementsFromSelector(s){const e=Ts(s);return e?ee.find(e):[]}},us=(s,e="hide")=>{const t=`click.dismiss${s.EVENT_KEY}`,o=s.NAME;B.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Xe(this))return;const a=ee.getElementFromSelector(this)||this.closest(`.${o}`);s.getOrCreateInstance(a)[e]()})},Cm="alert",km="bs.alert",Go=`.${km}`,Tm=`close${Go}`,xm=`closed${Go}`,Am="fade",Mm="show";class ds extends Re{static get NAME(){return Cm}close(){if(B.trigger(this._element,Tm).defaultPrevented)return;this._element.classList.remove(Mm);const t=this._element.classList.contains(Am);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),B.trigger(this._element,xm),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ds.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}us(ds,"close");Le(ds);const Om="button",Dm="bs.button",Nm=`.${Dm}`,Lm=".data-api",Im="active",Nn='[data-bs-toggle="button"]',jm=`click${Nm}${Lm}`;class ms extends Re{static get NAME(){return Om}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Im))}static jQueryInterface(e){return this.each(function(){const t=ms.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}B.on(document,jm,Nn,s=>{s.preventDefault();const e=s.target.closest(Nn);ms.getOrCreateInstance(e).toggle()});Le(ms);const Pm="swipe",Ot=".bs.swipe",Rm=`touchstart${Ot}`,Wm=`touchmove${Ot}`,Hm=`touchend${Ot}`,Vm=`pointerdown${Ot}`,Fm=`pointerup${Ot}`,Bm="touch",Um="pen",qm="pointer-event",zm=40,Km={endCallback:null,leftCallback:null,rightCallback:null},Gm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class is extends Vt{constructor(e,t){super(),this._element=e,!(!e||!is.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Km}static get DefaultType(){return Gm}static get NAME(){return Pm}dispose(){B.off(this._element,Ot)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ee(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=zm)return;const t=e/this._deltaX;this._deltaX=0,t&&Ee(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(B.on(this._element,Vm,e=>this._start(e)),B.on(this._element,Fm,e=>this._end(e)),this._element.classList.add(qm)):(B.on(this._element,Rm,e=>this._start(e)),B.on(this._element,Wm,e=>this._move(e)),B.on(this._element,Hm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Um||e.pointerType===Bm)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Ym="carousel",Jm="bs.carousel",tt=`.${Jm}`,Yo=".data-api",Xm="ArrowLeft",Qm="ArrowRight",Zm=500,Nt="next",pt="prev",ht="left",Zt="right",ep=`slide${tt}`,xs=`slid${tt}`,tp=`keydown${tt}`,sp=`mouseenter${tt}`,np=`mouseleave${tt}`,op=`dragstart${tt}`,ip=`load${tt}${Yo}`,ap=`click${tt}${Yo}`,Jo="carousel",zt="active",rp="slide",lp="carousel-item-end",cp="carousel-item-start",up="carousel-item-next",dp="carousel-item-prev",Xo=".active",Qo=".carousel-item",mp=Xo+Qo,pp=".carousel-item img",fp=".carousel-indicators",vp="[data-bs-slide], [data-bs-slide-to]",hp='[data-bs-ride="carousel"]',_p={[Xm]:Zt,[Qm]:ht},gp={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},bp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ft extends Re{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ee.findOne(fp,this._element),this._addEventListeners(),this._config.ride===Jo&&this.cycle()}static get Default(){return gp}static get DefaultType(){return bp}static get NAME(){return Ym}next(){this._slide(Nt)}nextWhenVisible(){!document.hidden&&Mt(this._element)&&this.next()}prev(){this._slide(pt)}pause(){this._isSliding&&Ro(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){B.one(this._element,xs,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){B.one(this._element,xs,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Nt:pt;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&B.on(this._element,tp,e=>this._keydown(e)),this._config.pause==="hover"&&(B.on(this._element,sp,()=>this.pause()),B.on(this._element,np,()=>this._maybeEnableCycle())),this._config.touch&&is.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ee.find(pp,this._element))B.on(o,op,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(ht)),rightCallback:()=>this._slide(this._directionToOrder(Zt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Zm+this._config.interval))}};this._swipeHelper=new is(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=_p[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=ee.findOne(Xo,this._indicatorsElement);t.classList.remove(zt),t.removeAttribute("aria-current");const o=ee.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(zt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===Nt,a=t||tn(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),d=y=>B.trigger(this._element,y,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(d(ep).defaultPrevented||!o||!a)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const c=i?cp:lp,$=i?up:dp;a.classList.add($),Ht(a),o.classList.add(c),a.classList.add(c);const g=()=>{a.classList.remove(c,$),a.classList.add(zt),o.classList.remove(zt,$,c),this._isSliding=!1,d(xs)};this._queueCallback(g,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(rp)}_getActive(){return ee.findOne(mp,this._element)}_getItems(){return ee.find(Qo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Oe()?e===ht?pt:Nt:e===ht?Nt:pt}_orderToDirection(e){return Oe()?e===pt?ht:Zt:e===pt?Zt:ht}static jQueryInterface(e){return this.each(function(){const t=Ft.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}B.on(document,ap,vp,function(s){const e=ee.getElementFromSelector(this);if(!e||!e.classList.contains(Jo))return;s.preventDefault();const t=Ft.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(qe.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});B.on(window,ip,()=>{const s=ee.find(hp);for(const e of s)Ft.getOrCreateInstance(e)});Le(Ft);const yp="collapse",wp="bs.collapse",Bt=`.${wp}`,$p=".data-api",Ep=`show${Bt}`,Sp=`shown${Bt}`,Cp=`hide${Bt}`,kp=`hidden${Bt}`,Tp=`click${Bt}${$p}`,As="show",gt="collapse",Kt="collapsing",xp="collapsed",Ap=`:scope .${gt} .${gt}`,Mp="collapse-horizontal",Op="width",Dp="height",Np=".collapse.show, .collapse.collapsing",Us='[data-bs-toggle="collapse"]',Lp={parent:null,toggle:!0},Ip={parent:"(null|element)",toggle:"boolean"};class kt extends Re{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=ee.find(Us);for(const i of o){const a=ee.getSelectorFromElement(i),r=ee.find(a).filter(d=>d===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Lp}static get DefaultType(){return Ip}static get NAME(){return yp}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Np).filter(d=>d!==this._element).map(d=>kt.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||B.trigger(this._element,Ep).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(gt),this._element.classList.add(Kt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(gt,As),this._element.style[o]="",B.trigger(this._element,Sp)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||B.trigger(this._element,Cp).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ht(this._element),this._element.classList.add(Kt),this._element.classList.remove(gt,As);for(const i of this._triggerArray){const a=ee.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(gt),B.trigger(this._element,kp)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(As)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Je(e.parent),e}_getDimension(){return this._element.classList.contains(Mp)?Op:Dp}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Us);for(const t of e){const o=ee.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=ee.find(Ap,this._config.parent);return ee.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(xp,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=kt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}B.on(document,Tp,Us,function(s){(s.target.tagName==="A"||s.delegateTarget&&s.delegateTarget.tagName==="A")&&s.preventDefault();for(const e of ee.getMultipleElementsFromSelector(this))kt.getOrCreateInstance(e,{toggle:!1}).toggle()});Le(kt);const Ln="dropdown",jp="bs.dropdown",ut=`.${jp}`,nn=".data-api",Pp="Escape",In="Tab",Rp="ArrowUp",jn="ArrowDown",Wp=2,Hp=`hide${ut}`,Vp=`hidden${ut}`,Fp=`show${ut}`,Bp=`shown${ut}`,Zo=`click${ut}${nn}`,ei=`keydown${ut}${nn}`,Up=`keyup${ut}${nn}`,_t="show",qp="dropup",zp="dropend",Kp="dropstart",Gp="dropup-center",Yp="dropdown-center",nt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Jp=`${nt}.${_t}`,es=".dropdown-menu",Xp=".navbar",Qp=".navbar-nav",Zp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",ef=Oe()?"top-end":"top-start",tf=Oe()?"top-start":"top-end",sf=Oe()?"bottom-end":"bottom-start",nf=Oe()?"bottom-start":"bottom-end",of=Oe()?"left-start":"right-start",af=Oe()?"right-start":"left-start",rf="top",lf="bottom",cf={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},uf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ve extends Re{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=ee.next(this._element,es)[0]||ee.prev(this._element,es)[0]||ee.findOne(es,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return cf}static get DefaultType(){return uf}static get NAME(){return Ln}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Xe(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!B.trigger(this._element,Fp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Qp))for(const o of[].concat(...document.body.children))B.on(o,"mouseover",os);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(_t),this._element.classList.add(_t),B.trigger(this._element,Bp,e)}}hide(){if(Xe(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!B.trigger(this._element,Hp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))B.off(o,"mouseover",os);this._popper&&this._popper.destroy(),this._menu.classList.remove(_t),this._element.classList.remove(_t),this._element.setAttribute("aria-expanded","false"),qe.removeDataAttribute(this._menu,"popper"),B.trigger(this._element,Vp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ue(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Ln.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof jo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ue(this._config.reference)?e=Je(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=en(e,this._menu,t)}_isShown(){return this._menu.classList.contains(_t)}_getPlacement(){const e=this._parent;if(e.classList.contains(zp))return of;if(e.classList.contains(Kp))return af;if(e.classList.contains(Gp))return rf;if(e.classList.contains(Yp))return lf;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(qp)?t?tf:ef:t?nf:sf}_detectNavbar(){return this._element.closest(Xp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(qe.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ee(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=ee.find(Zp,this._menu).filter(i=>Mt(i));o.length&&tn(o,t,e===jn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ve.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===Wp||e.type==="keyup"&&e.key!==In)return;const t=ee.find(Jp);for(const o of t){const i=Ve.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===In||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:i._element};e.type==="click"&&(d.clickEvent=e),i._completeHide(d)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===Pp,i=[Rp,jn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(nt)?this:ee.prev(this,nt)[0]||ee.next(this,nt)[0]||ee.findOne(nt,e.delegateTarget.parentNode),r=Ve.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}B.on(document,ei,nt,Ve.dataApiKeydownHandler);B.on(document,ei,es,Ve.dataApiKeydownHandler);B.on(document,Zo,Ve.clearMenus);B.on(document,Up,Ve.clearMenus);B.on(document,Zo,nt,function(s){s.preventDefault(),Ve.getOrCreateInstance(this).toggle()});Le(Ve);const ti="backdrop",df="fade",Pn="show",Rn=`mousedown.bs.${ti}`,mf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},pf={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class si extends Vt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return mf}static get DefaultType(){return pf}static get NAME(){return ti}show(e){if(!this._config.isVisible){Ee(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Ht(t),t.classList.add(Pn),this._emulateAnimation(()=>{Ee(e)})}hide(e){if(!this._config.isVisible){Ee(e);return}this._getElement().classList.remove(Pn),this._emulateAnimation(()=>{this.dispose(),Ee(e)})}dispose(){this._isAppended&&(B.off(this._element,Rn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(df),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Je(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),B.on(e,Rn,()=>{Ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Vo(e,this._getElement(),this._config.isAnimated)}}const ff="focustrap",vf="bs.focustrap",as=`.${vf}`,hf=`focusin${as}`,_f=`keydown.tab${as}`,gf="Tab",bf="forward",Wn="backward",yf={autofocus:!0,trapElement:null},wf={autofocus:"boolean",trapElement:"element"};class ni extends Vt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return yf}static get DefaultType(){return wf}static get NAME(){return ff}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),B.off(document,as),B.on(document,hf,e=>this._handleFocusin(e)),B.on(document,_f,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,B.off(document,as))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=ee.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Wn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===gf&&(this._lastTabNavDirection=e.shiftKey?Wn:bf)}}const Hn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Vn=".sticky-top",Gt="padding-right",Fn="margin-right";class qs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Gt,t=>t+e),this._setElementAttributes(Hn,Gt,t=>t+e),this._setElementAttributes(Vn,Fn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Gt),this._resetElementAttributes(Hn,Gt),this._resetElementAttributes(Vn,Fn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const d=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&qe.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=qe.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}qe.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Ue(e)){t(e);return}for(const o of ee.find(e,this._element))t(o)}}const $f="modal",Ef="bs.modal",De=`.${Ef}`,Sf=".data-api",Cf="Escape",kf=`hide${De}`,Tf=`hidePrevented${De}`,oi=`hidden${De}`,ii=`show${De}`,xf=`shown${De}`,Af=`resize${De}`,Mf=`click.dismiss${De}`,Of=`mousedown.dismiss${De}`,Df=`keydown.dismiss${De}`,Nf=`click${De}${Sf}`,Bn="modal-open",Lf="fade",Un="show",Ms="modal-static",If=".modal.show",jf=".modal-dialog",Pf=".modal-body",Rf='[data-bs-toggle="modal"]',Wf={backdrop:!0,focus:!0,keyboard:!0},Hf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ct extends Re{constructor(e,t){super(e,t),this._dialog=ee.findOne(jf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new qs,this._addEventListeners()}static get Default(){return Wf}static get DefaultType(){return Hf}static get NAME(){return $f}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||B.trigger(this._element,ii,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Bn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||B.trigger(this._element,kf).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Un),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){B.off(window,De),B.off(this._dialog,De),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new si({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ni({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=ee.findOne(Pf,this._dialog);t&&(t.scrollTop=0),Ht(this._element),this._element.classList.add(Un);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,B.trigger(this._element,xf,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){B.on(this._element,Df,e=>{if(e.key===Cf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),B.on(window,Af,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),B.on(this._element,Of,e=>{B.one(this._element,Mf,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Bn),this._resetAdjustments(),this._scrollBar.reset(),B.trigger(this._element,oi)})}_isAnimated(){return this._element.classList.contains(Lf)}_triggerBackdropTransition(){if(B.trigger(this._element,Tf).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ms)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ms),this._queueCallback(()=>{this._element.classList.remove(Ms),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Oe()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Oe()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=ct.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}B.on(document,Nf,Rf,function(s){const e=ee.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&s.preventDefault(),B.one(e,ii,i=>{i.defaultPrevented||B.one(e,oi,()=>{Mt(this)&&this.focus()})});const t=ee.findOne(If);t&&ct.getInstance(t).hide(),ct.getOrCreateInstance(e).toggle(this)});us(ct);Le(ct);const Vf="offcanvas",Ff="bs.offcanvas",Ke=`.${Ff}`,ai=".data-api",Bf=`load${Ke}${ai}`,Uf="Escape",qn="show",zn="showing",Kn="hiding",qf="offcanvas-backdrop",ri=".offcanvas.show",zf=`show${Ke}`,Kf=`shown${Ke}`,Gf=`hide${Ke}`,Gn=`hidePrevented${Ke}`,li=`hidden${Ke}`,Yf=`resize${Ke}`,Jf=`click${Ke}${ai}`,Xf=`keydown.dismiss${Ke}`,Qf='[data-bs-toggle="offcanvas"]',Zf={backdrop:!0,keyboard:!0,scroll:!1},ev={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Qe extends Re{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Zf}static get DefaultType(){return ev}static get NAME(){return Vf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||B.trigger(this._element,zf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new qs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(qn),this._element.classList.remove(zn),B.trigger(this._element,Kf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||B.trigger(this._element,Gf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Kn),this._backdrop.hide();const t=()=>{this._element.classList.remove(qn,Kn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new qs().reset(),B.trigger(this._element,li)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){B.trigger(this._element,Gn);return}this.hide()},t=!!this._config.backdrop;return new si({className:qf,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new ni({trapElement:this._element})}_addEventListeners(){B.on(this._element,Xf,e=>{if(e.key===Uf){if(this._config.keyboard){this.hide();return}B.trigger(this._element,Gn)}})}static jQueryInterface(e){return this.each(function(){const t=Qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}B.on(document,Jf,Qf,function(s){const e=ee.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&s.preventDefault(),Xe(this))return;B.one(e,li,()=>{Mt(this)&&this.focus()});const t=ee.findOne(ri);t&&t!==e&&Qe.getInstance(t).hide(),Qe.getOrCreateInstance(e).toggle(this)});B.on(window,Bf,()=>{for(const s of ee.find(ri))Qe.getOrCreateInstance(s).show()});B.on(window,Yf,()=>{for(const s of ee.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(s).position!=="fixed"&&Qe.getOrCreateInstance(s).hide()});us(Qe);Le(Qe);const tv=/^aria-[\w-]*$/i,ci={"*":["class","dir","id","lang","role",tv],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},sv=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),nv=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,ov=(s,e)=>{const t=s.nodeName.toLowerCase();return e.includes(t)?sv.has(t)?!!nv.test(s.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function iv(s,e,t){if(!s.length)return s;if(t&&typeof t=="function")return t(s);const i=new window.DOMParser().parseFromString(s,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const d=r.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){r.remove();continue}const p=[].concat(...r.attributes),f=[].concat(e["*"]||[],e[d]||[]);for(const c of p)ov(c,f)||r.removeAttribute(c.nodeName)}return i.body.innerHTML}const av="TemplateFactory",rv={allowList:ci,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},lv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},cv={entry:"(string|element|function|null)",selector:"(string|element)"};class uv extends Vt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return rv}static get DefaultType(){return lv}static get NAME(){return av}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},cv)}_setContent(e,t,o){const i=ee.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Ue(t)){this._putElementInTemplate(Je(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?iv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ee(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const dv="tooltip",mv=new Set(["sanitize","allowList","sanitizeFn"]),Os="fade",pv="modal",Yt="show",fv=".tooltip-inner",Yn=`.${pv}`,Jn="hide.bs.modal",Lt="hover",Ds="focus",Ns="click",vv="manual",hv="hide",_v="hidden",gv="show",bv="shown",yv="inserted",wv="click",$v="focusin",Ev="focusout",Sv="mouseenter",Cv="mouseleave",kv={AUTO:"auto",TOP:"top",RIGHT:Oe()?"left":"right",BOTTOM:"bottom",LEFT:Oe()?"right":"left"},Tv={allowList:ci,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},xv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Dt extends Re{constructor(e,t){if(typeof jo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Tv}static get DefaultType(){return xv}static get NAME(){return dv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),B.off(this._element.closest(Yn),Jn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=B.trigger(this._element,this.constructor.eventName(gv)),o=(Wo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),B.trigger(this._element,this.constructor.eventName(yv))),this._popper=this._createPopper(i),i.classList.add(Yt),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))B.on(d,"mouseover",os);const r=()=>{B.trigger(this._element,this.constructor.eventName(bv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||B.trigger(this._element,this.constructor.eventName(hv)).defaultPrevented)return;if(this._getTipElement().classList.remove(Yt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))B.off(i,"mouseover",os);this._activeTrigger[Ns]=!1,this._activeTrigger[Ds]=!1,this._activeTrigger[Lt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),B.trigger(this._element,this.constructor.eventName(_v)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Os,Yt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=fm(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Os),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new uv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[fv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Os)}_isShown(){return this.tip&&this.tip.classList.contains(Yt)}_createPopper(e){const t=Ee(this._config.placement,[this,e,this._element]),o=kv[t.toUpperCase()];return en(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Ee(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Ee(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")B.on(this._element,this.constructor.eventName(wv),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ns]=!(i._isShown()&&i._activeTrigger[Ns]),i.toggle()});else if(t!==vv){const o=t===Lt?this.constructor.eventName(Sv):this.constructor.eventName($v),i=t===Lt?this.constructor.eventName(Cv):this.constructor.eventName(Ev);B.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?Ds:Lt]=!0,r._enter()}),B.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?Ds:Lt]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},B.on(this._element.closest(Yn),Jn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=qe.getDataAttributes(this._element);for(const o of Object.keys(t))mv.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Je(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Dt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Le(Dt);const Av="popover",Mv=".popover-header",Ov=".popover-body",Dv={...Dt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Nv={...Dt.DefaultType,content:"(null|string|element|function)"};class on extends Dt{static get Default(){return Dv}static get DefaultType(){return Nv}static get NAME(){return Av}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Mv]:this._getTitle(),[Ov]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=on.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Le(on);const Lv="scrollspy",Iv="bs.scrollspy",an=`.${Iv}`,jv=".data-api",Pv=`activate${an}`,Xn=`click${an}`,Rv=`load${an}${jv}`,Wv="dropdown-item",ft="active",Hv='[data-bs-spy="scroll"]',Ls="[href]",Vv=".nav, .list-group",Qn=".nav-link",Fv=".nav-item",Bv=".list-group-item",Uv=`${Qn}, ${Fv} > ${Qn}, ${Bv}`,qv=".dropdown",zv=".dropdown-toggle",Kv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Gv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ps extends Re{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Kv}static get DefaultType(){return Gv}static get NAME(){return Lv}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Je(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(B.off(this._config.target,Xn),B.on(this._config.target,Xn,Ls,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const d=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&d){if(o(r),!i)return;continue}!a&&!d&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ee.find(Ls,this._config.target);for(const t of e){if(!t.hash||Xe(t))continue;const o=ee.findOne(decodeURI(t.hash),this._element);Mt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ft),this._activateParents(e),B.trigger(this._element,Pv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Wv)){ee.findOne(zv,e.closest(qv)).classList.add(ft);return}for(const t of ee.parents(e,Vv))for(const o of ee.prev(t,Uv))o.classList.add(ft)}_clearActiveClass(e){e.classList.remove(ft);const t=ee.find(`${Ls}.${ft}`,e);for(const o of t)o.classList.remove(ft)}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}B.on(window,Rv,()=>{for(const s of ee.find(Hv))ps.getOrCreateInstance(s)});Le(ps);const Yv="tab",Jv="bs.tab",dt=`.${Jv}`,Xv=`hide${dt}`,Qv=`hidden${dt}`,Zv=`show${dt}`,eh=`shown${dt}`,th=`click${dt}`,sh=`keydown${dt}`,nh=`load${dt}`,oh="ArrowLeft",Zn="ArrowRight",ih="ArrowUp",eo="ArrowDown",Is="Home",to="End",ot="active",so="fade",js="show",ah="dropdown",ui=".dropdown-toggle",rh=".dropdown-menu",Ps=`:not(${ui})`,lh='.list-group, .nav, [role="tablist"]',ch=".nav-item, .list-group-item",uh=`.nav-link${Ps}, .list-group-item${Ps}, [role="tab"]${Ps}`,di='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Rs=`${uh}, ${di}`,dh=`.${ot}[data-bs-toggle="tab"], .${ot}[data-bs-toggle="pill"], .${ot}[data-bs-toggle="list"]`;class Tt extends Re{constructor(e){super(e),this._parent=this._element.closest(lh),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),B.on(this._element,sh,t=>this._keydown(t)))}static get NAME(){return Yv}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?B.trigger(t,Xv,{relatedTarget:e}):null;B.trigger(e,Zv,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(ot),this._activate(ee.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(js);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),B.trigger(e,eh,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(so))}_deactivate(e,t){if(!e)return;e.classList.remove(ot),e.blur(),this._deactivate(ee.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(js);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),B.trigger(e,Qv,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(so))}_keydown(e){if(![oh,Zn,ih,eo,Is,to].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Xe(i));let o;if([Is,to].includes(e.key))o=t[e.key===Is?0:t.length-1];else{const i=[Zn,eo].includes(e.key);o=tn(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Tt.getOrCreateInstance(o).show())}_getChildren(){return ee.find(Rs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=ee.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(ah))return;const i=(a,r)=>{const d=ee.findOne(a,o);d&&d.classList.toggle(r,t)};i(ui,ot),i(rh,js),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(ot)}_getInnerElement(e){return e.matches(Rs)?e:ee.findOne(Rs,e)}_getOuterElement(e){return e.closest(ch)||e}static jQueryInterface(e){return this.each(function(){const t=Tt.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}B.on(document,th,di,function(s){["A","AREA"].includes(this.tagName)&&s.preventDefault(),!Xe(this)&&Tt.getOrCreateInstance(this).show()});B.on(window,nh,()=>{for(const s of ee.find(dh))Tt.getOrCreateInstance(s)});Le(Tt);const mh="toast",ph="bs.toast",st=`.${ph}`,fh=`mouseover${st}`,vh=`mouseout${st}`,hh=`focusin${st}`,_h=`focusout${st}`,gh=`hide${st}`,bh=`hidden${st}`,yh=`show${st}`,wh=`shown${st}`,$h="fade",no="hide",Jt="show",Xt="showing",Eh={animation:"boolean",autohide:"boolean",delay:"number"},Sh={animation:!0,autohide:!0,delay:5e3};class fs extends Re{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Sh}static get DefaultType(){return Eh}static get NAME(){return mh}show(){if(B.trigger(this._element,yh).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add($h);const t=()=>{this._element.classList.remove(Xt),B.trigger(this._element,wh),this._maybeScheduleHide()};this._element.classList.remove(no),Ht(this._element),this._element.classList.add(Jt,Xt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||B.trigger(this._element,gh).defaultPrevented)return;const t=()=>{this._element.classList.add(no),this._element.classList.remove(Xt,Jt),B.trigger(this._element,bh)};this._element.classList.add(Xt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Jt),super.dispose()}isShown(){return this._element.classList.contains(Jt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){B.on(this._element,fh,e=>this._onInteraction(e,!0)),B.on(this._element,vh,e=>this._onInteraction(e,!1)),B.on(this._element,hh,e=>this._onInteraction(e,!0)),B.on(this._element,_h,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}us(fs);Le(fs);const Ch={class:"message-content-column"},kh=["id"],Th={class:"accordion-item"},xh=["id"],Ah=["aria-controls"],Mh={class:"d-flex align-items-center w-100"},Oh={class:"badge bg-warning text-dark ms-auto me-2"},Dh={class:"text-muted"},Nh=["id","aria-labelledby"],Lh={class:"accordion-body bg-light"},Ih={class:"alert alert-warning mb-3",role:"alert"},jh={class:"compaction-metadata"},Ph={class:"metadata-row"},Rh={class:"metadata-row"},Wh={key:0,class:"metadata-row"},Hh={class:"continuation-content"},Vh={class:"continuation-text border rounded p-3 bg-white"},Fh={class:"mb-0"},Bh={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:s=>s.length===4||s.length===5}},setup(s){const e=s,t=v(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=v(()=>`heading-${t.value}`),i=v(()=>`collapse-${t.value}`),a=I(null);let r=null;ge(()=>{a.value&&(r=new kt(a.value,{toggle:!1}))}),pi(()=>{r&&r.dispose()});function d(){r&&r.toggle()}const p=v(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=v(()=>p.value?e.messages[3]:e.messages[2]),c=v(()=>f.value?.metadata?.init_data?.compact_metadata||{}),$=v(()=>c.value.pre_tokens||0),g=v(()=>p.value?e.messages[4]:e.messages[3]),y=v(()=>g.value?.content||""),w=v(()=>{const l=e.messages[0]?.timestamp;return l?Rt(l):""});function b(l){return l?`${l.toLocaleString()} tokens`:"0 tokens"}return(l,h)=>(u(),m("div",{class:"message-row message-row-compaction",key:t.value},[h[7]||(h[7]=n("div",{class:"message-speaker"},[n("span",{class:"speaker-label"},"system")],-1)),n("div",Ch,[n("div",{class:"accordion compaction-accordion",id:t.value},[n("div",Th,[n("h2",{class:"accordion-header",id:o.value},[n("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:d},[n("div",Mh,[h[0]||(h[0]=n("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=n("strong",{class:"me-2"},"Context Compaction Event",-1)),n("span",Oh,E(b($.value)),1),n("small",Dh,E(w.value),1)])],8,Ah)],8,xh),n("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[n("div",Lh,[n("div",Ih,[h[5]||(h[5]=n("h6",{class:"alert-heading mb-2"},[n("span",{class:"me-2"},"â„¹ï¸"),Z(" Compaction Details ")],-1)),n("div",jh,[n("div",Ph,[h[2]||(h[2]=n("strong",null,"Trigger:",-1)),n("span",null,E(c.value.trigger||"auto"),1)]),n("div",Rh,[h[3]||(h[3]=n("strong",null,"Pre-compaction tokens:",-1)),n("span",null,E(b($.value)),1)]),c.value.post_tokens?(u(),m("div",Wh,[h[4]||(h[4]=n("strong",null,"Post-compaction tokens:",-1)),n("span",null,E(b(c.value.post_tokens)),1)])):O("",!0)])]),n("div",Hh,[h[6]||(h[6]=n("h6",{class:"text-muted mb-2"},[n("span",{class:"me-2"},"â†©ï¸"),Z(" Continuation Message ")],-1)),n("div",Vh,[n("pre",Fh,E(y.value),1)])])])],8,Nh)])],8,kh)])]))}},Uh=se(Bh,[["__scopeId","data-v-e0b95ba8"]]),qh={key:0,class:"text-muted text-center py-5"},zh={__name:"MessageList",setup(s){const e=Me(),t=ve(),o=I(null),i=v(()=>{const c=e.currentMessages,$=[];let g=0;for(;g<c.length;){const y=c[g];if(r(y,c,g)){const w=c[g+2],l=w?.type==="system"&&w?.metadata?.subtype==="init"?5:4,h=c.slice(g,g+l);$.push({type:"compaction",messages:h}),g+=l;continue}p(y)&&$.push({type:"message",message:y,attachedTools:[]}),g++}return a($)});function a(c){const $=new Map,g=new Set;for(let w=0;w<c.length;w++){const b=c[w];if(b.type==="compaction")continue;const l=b.message,h=l.content&&l.content.trim().length>0&&l.content!=="Assistant response",_=l.type==="assistant"&&l.metadata?.has_tool_uses&&l.metadata?.tool_uses?.length>0;if(l.type==="assistant"&&_&&!h){let x=-1,D=!1;for(let q=w-1;q>=0;q--){const K=c[q];if(!g.has(q)){if(K.type==="message"&&K.message.type!=="assistant"){D=!0;break}if(K.type==="message"&&K.message.type==="assistant"){const L=K.message;if(L.content&&L.content.trim().length>0&&L.content!=="Assistant response"){x=q;break}else{x=q;break}}}}D&&x===-1||(D&&x>=0?($.has(x)||$.set(x,[]),$.get(x).push(...l.metadata.tool_uses),g.add(w)):!D&&x>=0&&($.has(x)||$.set(x,[]),$.get(x).push(...l.metadata.tool_uses),g.add(w)))}}const y=[];for(let w=0;w<c.length;w++){if(g.has(w))continue;const b=c[w];$.has(w)&&(b.attachedTools=[...b.attachedTools||[],...$.get(w)]),y.push(b)}return y}function r(c,$,g){if(g+3>=$.length)return!1;const y=$[g],w=$[g+1];let b=$[g+2],l=$[g+3],h=$[g+4];const _=y.type==="system"&&y.metadata?.subtype==="status"&&y.metadata?.init_data?.status==="compacting",x=w.type==="system"&&w.metadata?.subtype==="status"&&(w.metadata?.init_data?.status===null||w.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(g+4>=$.length)return!1;const q=!0,K=l?.type==="system"&&l?.metadata?.subtype==="compact_boundary",L=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return y.type==="system"&&y.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",x),console.log("  Msg3 (init):",q),console.log("  Msg4 (boundary):",K),console.log("  Msg5 (continuation):",L)),_&&x&&q&&K&&L}else{const q=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",K=l?.type==="user"&&l?.content?.startsWith("This session is being continued from a previous conversation");return y.type==="system"&&y.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",x),console.log("  Msg3 (boundary):",q),console.log("  Msg4 (continuation):",K)),_&&x&&q&&K}}async function d(){t.autoScrollEnabled&&(await ss(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}de(()=>i.value.length,d),de(()=>e.currentToolCalls.length,d),de(()=>e.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),d),ge(()=>{setTimeout(()=>{d()},100)});function p(c){const $=c.subtype||c.metadata?.subtype;if(c.type==="system"&&$==="init"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const g=c.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(c.type==="user"){const g=c.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(c.type==="user"){const g=c.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}return!0}function f(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,$)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),m("div",qh," No messages yet. Start a conversation! ")):O("",!0),(u(!0),m(ie,null,ae(i.value,(g,y)=>(u(),m(ie,{key:`item-${y}`},[g.type==="message"?(u(),ye(Td,{key:0,message:f(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(u(),ye(Uh,{key:1,messages:g.messages},null,8,["messages"])):O("",!0)],64))),128))],512))}},Kh=se(zh,[["__scopeId","data-v-6bae0fb1"]]),Gh={class:"border-top bg-light"},Yh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Jh={class:"d-flex gap-2 align-items-end px-2 py-1"},Xh=["placeholder","disabled"],Qh=["disabled"],Zh={__name:"InputArea",setup(s){const e=le(),t=Ze(),o=I(null),i=I(window.innerWidth),a=v({get:()=>e.currentInput,set:l=>{e.currentInput=l}}),r=v(()=>e.currentSession?.is_processing||!1),d=v(()=>t.sessionConnected),p=v(()=>e.currentSession?.state==="starting"),f=v(()=>i.value<768),c=v(()=>p.value?"Session is starting...":d.value?"Type your message to Claude Code...":"Waiting for connection...");function $(){i.value=window.innerWidth}ge(()=>{window.addEventListener("resize",$)}),Se(()=>{window.removeEventListener("resize",$)});function g(l){if(l.key==="Enter"&&!l.shiftKey){if(f.value)return;l.preventDefault(),w()}}function y(){const l=o.value;if(!l)return;l.style.height="auto";const h=Math.min(l.scrollHeight,parseInt(getComputedStyle(l).maxHeight));l.style.height=h+"px"}function w(){a.value.trim()&&(t.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function b(){t.interruptSession()}return(l,h)=>(u(),m("div",Gh,[d.value?O("",!0):(u(),m("div",Yh,[...h[1]||(h[1]=[n("span",{class:"flex-shrink-0"},"â—",-1),n("strong",null,"Disconnected",-1),n("span",{class:"text-muted"},"â€”",-1),n("span",null,"Cannot send messages while reconnecting...",-1)])])),n("div",Jh,[_e(n("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":h[0]||(h[0]=_=>a.value=_),class:"form-control",placeholder:c.value,disabled:p.value||!d.value,rows:"1",onInput:y,onKeydown:g},null,40,Xh),[[We,a.value]]),r.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:b}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!d.value||p.value,onClick:w}," Send ",8,Qh))])]))}},e_=se(Zh,[["__scopeId","data-v-ef1e5094"]]),t_={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},s_={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},n_={class:"text-secondary"},o_={class:"d-flex flex-column flex-grow-1 overflow-hidden"},i_={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(s){const e=s,t=le(),o=ve(),i=v(()=>t.currentSession),a=v(()=>o.isLoading),r=v(()=>o.loadingMessage);return ge(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),de(()=>e.sessionId,async(d,p)=>{if(d!==p&&d!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(d)}finally{o.hideLoading()}}}),Se(()=>{}),(d,p)=>(u(),m("div",t_,[a.value?(u(),m("div",s_,[p[0]||(p[0]=n("div",{class:"spinner-border text-primary mb-3",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1)),n("p",n_,E(r.value),1)])):O("",!0),i.value?(u(),ye(Ni,{key:1,"session-id":e.sessionId},null,8,["session-id"])):O("",!0),n("div",o_,[me(Kh)]),me(e_),i.value?(u(),ye(Ri,{key:2,"session-id":e.sessionId},null,8,["session-id"])):O("",!0),i.value?(u(),ye(Ki,{key:3,"session-id":e.sessionId},null,8,["session-id"])):O("",!0)]))}},vs=xt("legion",()=>{const s=I(new Map),e=I(new Map),t=I(null),o=v(()=>s.value.get(t.value)||[]),i=v(()=>e.value.get(t.value)||[]);function a(w){t.value=w}async function r(w,b=100,l=0){try{const h=await oe.get(`/api/legions/${w}/timeline?limit=${b}&offset=${l}`),_=h.comms||[],x=h.total_count||_.length,D=h.has_more||!1;return _.sort((q,K)=>new Date(q.timestamp)-new Date(K.timestamp)),console.log(`Loaded ${_.length} of ${x} comms for legion ${w}`),s.value.set(w,_),s.value=new Map(s.value),{comms:_,totalCount:x,hasMore:D}}catch(h){throw console.error("Failed to load timeline:",h),h}}function d(w,b){s.value.has(w)||s.value.set(w,[]);const l=s.value.get(w);if(l.some(_=>_.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}l.push(b),s.value=new Map(s.value)}async function p(w,b){try{const h=(await oe.post(`/api/legions/${w}/comms`,b)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${w}`),h}catch(l){throw console.error("Failed to send comm:",l),l}}async function f(w){return console.log(`Minions for legion ${w} are already available in session store`),[]}async function c(w,b){try{const h=(await oe.post(`/api/legions/${w}/minions`,b)).minion;return await f(w),console.log(`Created minion ${h.minion_id} in legion ${w}`),h}catch(l){throw console.error("Failed to create minion:",l),l}}async function $(w){try{const b=await oe.post(`/api/legions/${w}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${w}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function g(w){try{const b=await oe.post(`/api/legions/${w}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${w}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function y(w){s.value.delete(w),e.value.delete(w),s.value=new Map(s.value),e.value=new Map(e.value)}return{commsByLegion:s,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:r,addComm:d,sendComm:p,loadMinions:f,createMinion:c,haltAll:$,resumeAll:g,clearLegionData:y}}),a_=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:vs},Symbol.toStringTag,{value:"Module"})),r_={class:"timeline-header border-bottom p-3"},l_={class:"project-name"},c_=["title"],u_={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(s){const e=s,t=Ne(),o=v(()=>t.projects.get(e.legionId)),i=v(()=>o.value?.name||"Legion");return(a,r)=>(u(),m("div",r_,[n("div",null,[n("div",l_,E(i.value),1),n("div",{class:"view-name",title:s.legionId},"Timeline",8,c_)])]))}},d_=se(u_,[["__scopeId","data-v-44f386f5"]]),m_={class:"timeline-status-bar border-top p-2 bg-light"},p_={class:"d-flex justify-content-end"},f_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(s){const e=ve();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),m("div",m_,[n("div",p_,[n("button",{class:X(["btn btn-sm",ts(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+E(ts(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},v_=se(f_,[["__scopeId","data-v-891c73db"]]),h_={class:"comm-composer border-top p-3"},__={key:0,class:"d-flex gap-2 mb-2"},g_={class:"flex-grow-1"},b_=["disabled"],y_={label:"Minions"},w_=["value"],$_={style:{"min-width":"150px"}},E_=["disabled"],S_={class:"d-flex gap-2 align-items-end position-relative"},C_={class:"flex-grow-1 position-relative"},k_=["disabled"],T_=["onClick","onMouseenter"],x_=["disabled"],A_={key:0},M_={key:1},O_={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(s){const e=s,t=vs(),o=le(),i=Ne(),a=I(""),r=I("task"),d=I(""),p=I(!1),f=I(window.innerWidth),c=I(!1),$=I([]),g=I(0),y=I(-1),w=I(null),b=I(null),l=v(()=>f.value<768),h=v(()=>{const H=i.projects.get(e.legionId);return!H||!H.session_ids?[]:H.session_ids.map(T=>o.sessions.get(T)).filter(T=>T)}),_=v(()=>a.value&&d.value.trim().length>0);function x(H){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[H.state]||"â—‹"}function D(H){return H.role?`${H.name} (${H.role})`:H.name}function q(){const H=w.value;if(!H)return;H.style.height="auto";const T=Math.min(H.scrollHeight,parseInt(getComputedStyle(H).maxHeight));H.style.height=T+"px"}function K(){const H=w.value;if(!H)return;q();const T=d.value,S=H.selectionStart,N=T.substring(0,S),M=N.lastIndexOf("#");if(M===-1){c.value=!1;return}const k=N.substring(M+1).toLowerCase();if(k.includes(" ")){c.value=!1;return}const j=h.value.filter(U=>U.name.toLowerCase().includes(k)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(j.length===0){c.value=!1;return}$.value=j,g.value=0,y.value=M,c.value=!0}function L(){if(!b.value)return;const H=b.value,T=H.children[g.value];if(!T)return;const S=T.offsetTop,N=T.offsetHeight,M=H.scrollTop,k=H.clientHeight;S<M?H.scrollTop=S:S+N>M+k&&(H.scrollTop=S+N-k)}function F(H){if(!c.value){if(H.key==="Enter"&&!H.shiftKey){if(l.value)return;_.value&&(H.preventDefault(),A())}return}if(H.key==="ArrowDown")H.preventDefault(),g.value=(g.value+1)%$.value.length,L();else if(H.key==="ArrowUp")H.preventDefault(),g.value=g.value===0?$.value.length-1:g.value-1,L();else if(H.key==="Enter"){H.preventDefault();const T=$.value[g.value];T&&C(T)}else H.key==="Escape"&&(c.value=!1)}function C(H){const T=w.value;if(!T)return;const S=d.value,N=T.selectionStart,M=S.substring(0,y.value)+"#"+H.name+" "+S.substring(N);d.value=M;const k=y.value+H.name.length+2;setTimeout(()=>{T.setSelectionRange(k,k),T.focus()},0),c.value=!1}async function A(){if(!(!_.value||p.value)){p.value=!0;try{const[H,T]=a.value.split(":"),S={comm_type:r.value,content:d.value.trim()};H==="minion"&&(S.to_minion_id=T),await t.sendComm(e.legionId,S),d.value="",q()}catch(H){console.error("Failed to send comm:",H),alert(`Failed to send comm: ${H.message}`)}finally{p.value=!1}}}function V(){f.value=window.innerWidth}return ge(()=>{window.addEventListener("resize",V)}),Se(()=>{window.removeEventListener("resize",V)}),de(c,H=>{if(H){const T=S=>{S.target.closest(".comm-composer")||(c.value=!1,document.removeEventListener("click",T))};setTimeout(()=>document.addEventListener("click",T),0)}}),(H,T)=>(u(),m("div",h_,[s.hideRecipientSelector?O("",!0):(u(),m("div",__,[n("div",g_,[_e(n("select",{"onUpdate:modelValue":T[0]||(T[0]=S=>a.value=S),class:"form-select form-select-sm",disabled:p.value},[T[3]||(T[3]=n("option",{value:""},"-- Select Recipient --",-1)),n("optgroup",y_,[(u(!0),m(ie,null,ae(h.value,S=>(u(),m("option",{key:S.session_id,value:`minion:${S.session_id}`},E(x(S))+" "+E(D(S)),9,w_))),128))])],8,b_),[[fn,a.value]])]),n("div",$_,[_e(n("select",{"onUpdate:modelValue":T[1]||(T[1]=S=>r.value=S),class:"form-select form-select-sm",disabled:p.value},[...T[4]||(T[4]=[n("option",{value:"task"},"Task",-1),n("option",{value:"question"},"Question",-1),n("option",{value:"info"},"Info",-1),n("option",{value:"report"},"Report",-1)])],8,E_),[[fn,r.value]])])])),n("div",S_,[n("div",C_,[_e(n("textarea",{ref_key:"contentTextarea",ref:w,"onUpdate:modelValue":T[2]||(T[2]=S=>d.value=S),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:K,onKeydown:F},null,40,k_),[[We,d.value]]),c.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(ie,null,ae($.value,(S,N)=>(u(),m("div",{key:S.id,class:X(["autocomplete-item px-2 py-1",{"bg-light":N===g.value}]),onClick:M=>C(S),onMouseenter:M=>g.value=N},E(S.type==="minion"?x(S):"#ï¸âƒ£")+" "+E(S.name)+E(S.role?` (${S.role})`:""),43,T_))),128))],512)):O("",!0)]),n("div",null,[n("button",{class:"btn btn-primary btn-sm",disabled:!_.value||p.value,onClick:A},[p.value?(u(),m("span",A_,[...T[5]||(T[5]=[n("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),Z(" Sending... ",-1)])])):(u(),m("span",M_,"Send"))],8,x_)])])]))}},D_=se(O_,[["__scopeId","data-v-e52b8e8f"]]),N_={class:"message-content-column-full"},L_=["aria-expanded"],I_={class:"comm-sender-recipient"},j_={class:"comm-badge-summary"},P_=["title"],R_={class:"comm-summary-text text-muted ms-2"},W_=["aria-label"],H_={key:0,class:"comm-content-body"},V_=["innerHTML"],F_="ffffffff-ffff-ffff-ffff-ffffffffffff",B_={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(s){const e=s;at.setOptions({breaks:!0,gfm:!0});const t=I(!1);function o(){t.value=!t.value}const i=v(()=>e.comm.from_minion_id===F_),a=v(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),r=v(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),d=v(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),p=v(()=>{const f=e.comm.content||"";let c=at.parse(f);return c=c.replace(/\n</g,"<"),c=c.replace(/\n+$/,""),rs.sanitize(c)});return(f,c)=>(u(),m("div",{class:X(["message-row message-row-comm",{"system-comm":i.value}])},[n("div",N_,[n("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[n("div",I_,[n("strong",{class:X({"system-sender":i.value})},E(s.senderName),3),s.recipientName?(u(),m(ie,{key:0},[c[0]||(c[0]=n("span",{class:"text-muted mx-1"},"â†’",-1)),n("strong",null,E(s.recipientName),1)],64)):O("",!0)]),n("div",j_,[n("span",{class:X(["badge",r.value]),title:a.value},E(s.comm.comm_type),11,P_),n("span",R_,E(d.value),1)]),n("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},E(t.value?"â–¾":"â–¸"),9,W_)],8,L_),t.value?(u(),m("div",H_,[n("div",{class:"message-text",innerHTML:p.value},null,8,V_)])):O("",!0)])],2))}},U_=se(B_,[["__scopeId","data-v-28513f64"]]),q_={class:"timeline-view d-flex flex-column h-100"},z_={key:0,class:"text-center text-muted"},K_={key:1,class:"text-center text-danger"},G_={key:2,class:"text-center text-muted"},Y_={key:3,class:"comm-list"},J_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(s){const e=s,t=vs();Ne();const o=le(),i=Ze(),a=ve(),r=I(!0),d=I(null),p=I(null),f=v(()=>t.currentComms);function c(l){return l.from_user?"You":l.from_minion_id?l.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(l.from_minion_id)?.name||"Unknown":"Unknown"}function $(l){return l.to_user?"You":l.to_minion_id?o.sessions.get(l.to_minion_id)?.name||"Unknown":"All"}async function g(){a.autoScrollEnabled&&(await ss(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function y(){r.value=!0,d.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await ss(),await g(),setTimeout(()=>{g()},100)}catch(l){console.error("Failed to load timeline:",l),l.response?d.value=`${l.message} (${l.response.status})`:d.value=l.message||"Unknown error"}finally{r.value=!1}}function w(){i.connectLegion(e.legionId)}function b(){i.disconnectLegion()}return de(()=>f.value.length,()=>{g()}),ge(()=>{o.currentSessionId=null,y(),w(),setTimeout(()=>{g()},100)}),Se(()=>{b()}),(l,h)=>(u(),m("div",q_,[me(d_,{"legion-id":s.legionId},null,8,["legion-id"]),n("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[r.value?(u(),m("div",z_,[...h[0]||(h[0]=[n("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),Z(" Loading timeline... ",-1)])])):d.value?(u(),m("div",K_," Failed to load timeline: "+E(d.value),1)):f.value.length===0?(u(),m("div",G_," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",Y_,[(u(!0),m(ie,null,ae(f.value,_=>(u(),ye(U_,{key:_.comm_id,comm:_,"sender-name":c(_),"recipient-name":$(_)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),me(D_,{"legion-id":s.legionId},null,8,["legion-id"]),me(v_,{"legion-id":s.legionId},null,8,["legion-id"])]))}},X_=se(J_,[["__scopeId","data-v-b6752179"]]),Q_={class:"minion-info flex-grow-1"},Z_={class:"minion-name"},eg={key:0,class:"me-1"},tg={key:1,class:"badge bg-secondary ms-2"},sg={key:0,class:"latest-activity text-muted"},ng={key:0,class:"activity-prefix"},og=["title"],ig={key:1,class:"activity-time ms-1"},ag={key:1,class:"latest-activity text-muted"},rg={class:"activity-prefix"},lg=["title"],cg={key:2,class:"latest-activity text-muted fst-italic small"},ug={class:"node-row"},dg={class:"node-left"},mg={key:0,class:"me-2"},pg={key:1,class:"badge bg-secondary ms-2"},fg={class:"node-right"},vg={key:0,class:"latest-message-preview"},hg={key:0,class:"message-prefix"},_g=["title"],gg={key:1,class:"message-time ms-1"},bg={key:1,class:"last-comm-preview"},yg={class:"comm-direction"},wg=["title"],$g={key:2,class:"text-muted fst-italic small"},Eg={class:"node-actions"},Sg={key:2,class:"minion-children"},Cg={key:1,class:"text-danger small ms-4"},kg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:s=>["two-column","sidebar"].includes(s)}},emits:["minion-click"],setup(s,{emit:e}){const t=s,o=e,i=le(),a=Me(),r=ve(),d=v(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),p=v(()=>{if(!t.minionData||!t.minionData.id)return null;const C=a.messagesBySession.get(t.minionData.id);if(!C||C.length===0)return null;for(let A=C.length-1;A>=0;A--){const V=C[A];if(V.type!=="result"&&!(V.type==="user"&&V.content&&V.content.startsWith("Tool results:"))&&!(V.type==="system"&&V.content==="System message")&&!(V.type==="assistant"&&V.content==="Assistant response")&&(V.type==="user"||V.type==="assistant"||V.type==="system"))return{content:V.content,type:V.type,timestamp:V.timestamp}}return null}),f=v(()=>{if(!t.minionData)return null;const C={...t.minionData};return d.value&&(C.state=d.value.state,C.is_processing=d.value.is_processing,d.value.name&&(C.name=d.value.name),d.value.latest_message&&(C.latest_message=d.value.latest_message,C.latest_message_type=d.value.latest_message_type,C.latest_message_time=d.value.latest_message_time)),p.value&&(C.latest_message=p.value.content,C.latest_message_type=p.value.type,C.latest_message_time=p.value.timestamp),C}),c=v(()=>t.level*24),$=v(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),g=v(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),y=v(()=>t.minionData&&t.minionData.is_overseer&&g.value),w=v(()=>{const C=f.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),b=v(()=>{const C=w.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),l=v(()=>{const C=w.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),h=v(()=>{const C=f.value;if(!C||!C.latest_message_type)return"";const A=C.latest_message_type;return A==="user"?"User -->:":A==="system"?"System:":""}),_=v(()=>{const C=f.value;if(!C||!C.latest_message)return"";const A=C.latest_message,V=150;return A.length>V?A.slice(0,V)+"...":A}),x=v(()=>{const C=f.value;if(!C||!C.latest_message_time)return"";try{const A=Date.now();let V;if(typeof C.latest_message_time=="number"?V=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:V=new Date(C.latest_message_time).getTime(),isNaN(V)||V<9466848e5||V>A+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",V),"";const H=A-V;if(H<0)return"just now";const T=Math.floor(H/6e4),S=Math.floor(T/60),N=Math.floor(S/24);return N>0?`${N}d ago`:S>0?`${S}h ago`:T>0?`${T}m ago`:"just now"}catch(A){return console.error("Error calculating relative time:",A,C.latest_message_time),""}});function D(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function q(C){const A=C.summary||C.content||"";return A.length>150?A.substring(0,150)+"...":A}function K(){o("minion-click",t.minionData.id)}function L(){const C=i.sessions.get(t.minionData.id);C&&r.showModal("edit-session",{session:C})}function F(){const C=i.sessions.get(t.minionData.id);C&&r.showModal("manage-session",{session:C})}return(C,A)=>{const V=io("MinionTreeNode",!0);return s.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:bt({marginLeft:`${c.value}px`})},[s.layout==="sidebar"?(u(),m("div",{key:0,class:X(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:K},[n("div",{class:X(["status-dot me-2",b.value]),style:bt(l.value)},null,6),n("div",Q_,[n("div",Z_,[y.value?(u(),m("span",eg,"ðŸ‘‘")):O("",!0),n("strong",null,E(f.value?.name||s.minionData.name),1),y.value?(u(),m("span",tg,E(s.minionData.children.length)+" "+E(s.minionData.children.length===1?"child":"children"),1)):O("",!0)]),f.value?.latest_message?(u(),m("div",sg,[h.value?(u(),m("span",ng,E(h.value),1)):O("",!0),n("span",{class:"activity-content",title:f.value.latest_message},E(_.value),9,og),x.value?(u(),m("span",ig,"("+E(x.value)+")",1)):O("",!0)])):s.minionData?.last_comm?(u(),m("div",ag,[n("span",rg,[A[1]||(A[1]=Z("â†’ ",-1)),n("strong",null,E(D(s.minionData.last_comm)),1),A[2]||(A[2]=Z(": ",-1))]),n("span",{class:"activity-content",title:s.minionData.last_comm.content||""},E(q(s.minionData.last_comm)),9,lg)])):(u(),m("div",cg," No activity yet "))]),n("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:he(L,["stop"])}," âœï¸ "),n("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:he(F,["stop"])}," âš™ï¸ ")],2)):(u(),m("div",{key:1,class:X(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:K},[n("div",ug,[n("div",dg,[n("div",{class:X(["status-dot me-2",b.value]),style:bt(l.value)},null,6),y.value?(u(),m("span",mg,"ðŸ‘‘")):O("",!0),n("strong",null,E(f.value?.name||s.minionData.name),1),y.value?(u(),m("span",pg,E(s.minionData.children.length)+" "+E(s.minionData.children.length===1?"child":"children"),1)):O("",!0)]),n("div",fg,[f.value?.latest_message?(u(),m("div",vg,[h.value?(u(),m("span",hg,E(h.value),1)):O("",!0),n("span",{class:"message-content",title:f.value.latest_message},E(_.value),9,_g),x.value?(u(),m("span",gg,"("+E(x.value)+")",1)):O("",!0)])):s.minionData?.last_comm?(u(),m("div",bg,[n("span",yg,[A[3]||(A[3]=Z("â†’ ",-1)),n("strong",null,E(D(s.minionData.last_comm)),1),A[4]||(A[4]=Z(":",-1))]),n("span",{class:"comm-content",title:s.minionData.last_comm.content||""},E(q(s.minionData.last_comm)),9,wg)])):(u(),m("div",$g," No activity yet "))]),n("div",Eg,[n("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:he(L,["stop"])}," âœï¸ "),n("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:he(F,["stop"])}," âš™ï¸ ")])])],2)),g.value?(u(),m("div",Sg,[(u(!0),m(ie,null,ae(s.minionData.children,H=>(u(),ye(V,{key:H.id,"minion-data":H,level:s.level+1,layout:s.layout,onMinionClick:A[0]||(A[0]=T=>C.$emit("minion-click",T))},null,8,["minion-data","level","layout"]))),128))])):O("",!0)],4)):(u(),m("div",Cg," âš  Minion data is missing "))}}},mi=se(kg,[["__scopeId","data-v-5dae8a96"]]),Tg={class:"project-overview d-flex flex-column h-100"},xg={class:"project-overview-header border-bottom p-3"},Ag={class:"d-flex align-items-center justify-content-between"},Mg={class:"mb-1"},Og={key:0,class:"me-2"},Dg={class:"text-muted font-monospace"},Ng={class:"d-flex gap-2"},Lg=["title"],Ig={class:"project-overview-content flex-grow-1 overflow-auto p-3"},jg={key:0,class:"text-center py-5"},Pg={key:1,class:"alert alert-danger"},Rg={key:2,class:"text-center py-5"},Wg={key:3},Hg={class:"row g-3 mb-4"},Vg={class:"col-md-4"},Fg={class:"card h-100"},Bg={class:"card-body"},Ug={class:"card-title mb-0"},qg={class:"text-muted"},zg={class:"col-md-4"},Kg={class:"card h-100"},Gg={class:"card-body"},Yg={class:"card-title mb-0"},Jg={class:"text-muted"},Xg={key:0,class:"card mb-4"},Qg={class:"card mb-4"},Zg={class:"card-header d-flex align-items-center justify-content-between"},eb={class:"mb-0"},tb={class:"badge bg-secondary"},sb={class:"card-body"},nb={key:0,class:"text-center py-4"},ob={key:1,class:"text-center text-muted py-4"},ib={key:2,class:"hierarchy-tree"},ab={class:"user-root-node mb-3 border rounded bg-white"},rb={class:"node-row"},lb={class:"node-left"},cb={class:"badge bg-primary ms-2"},ub={class:"node-right"},db={key:0,class:"last-comm-preview"},mb={class:"comm-direction"},pb=["title"],fb={key:1,class:"text-muted fst-italic"},vb={class:"root-minions ms-4"},hb={class:"card"},_b={class:"card-body"},gb={class:"row mb-0"},bb={class:"col-sm-8 font-monospace text-break"},yb={class:"col-sm-8 font-monospace text-break"},wb={class:"col-sm-8"},$b={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},Eb={class:"text-muted"},Sb={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(s){const e=s,t=Pt(),o=Ne(),i=le(),a=ve(),r=vs(),d=Ze(),p=I(!1),f=I(null),c=I(null),$=I(!1);let g=null;const y=v(()=>o.getProject(e.projectId)),w=v(()=>y.value?.session_ids?y.value.session_ids.map(S=>i.getSession(S)).filter(S=>S!=null):[]),b=v(()=>w.value.length>0),l=v(()=>w.value.length),h=v(()=>w.value.filter(S=>S.state==="ACTIVE").length),_=v(()=>{const S=w.value.some(k=>k.state==="ACTIVE"),N=w.value.some(k=>k.is_processing);return w.value.some(k=>k.state==="ERROR")?"Error":N?"Working":S?"Active":l.value>0?"Idle":"Empty"}),x=v(()=>{switch(_.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),D=v(()=>{switch(_.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function q(){$.value=!0;try{const S=await oe.get(`/api/legions/${e.projectId}/hierarchy`);c.value=S}catch(S){console.error("Failed to load minion hierarchy:",S),c.value=null}finally{$.value=!1}}function K(S,N){if(S&&S.id===N)return S;if(S&&S.children)for(const M of S.children){const k=K(M,N);if(k)return k}return null}function L(S){return S.to_user?"User":S.to_minion_name?S.to_minion_name:"unknown"}function F(S){const N=S.summary||S.content||"";return N.length>150?N.substring(0,150)+"...":N}function C(S){if(c.value){if(S.from_minion_id){const N=K(c.value,S.from_minion_id);N&&N.type==="minion"&&(N.last_comm=S)}S.from_user&&c.value.type==="user"&&(c.value.last_comm=S)}}function A(S){t.push(`/session/${S}`)}function V(){t.push(`/timeline/${e.projectId}`)}function H(){a.showModal("edit-project",{project:y.value})}function T(){a.showModal("create-minion",{project:y.value})}return ge(()=>{o.selectProject(e.projectId),i.currentSessionId=null,q(),r.setCurrentLegion(e.projectId),d.connectLegion(e.projectId),g=de(()=>i.sessions,S=>{if(c.value){for(const[N,M]of S)if(M.project_id===e.projectId){const k=K(c.value,N);k&&k.type==="minion"&&(k.state!==M.state&&(k.state=M.state),k.is_processing!==M.is_processing&&(k.is_processing=M.is_processing),k.latest_message!==M.latest_message&&(k.latest_message=M.latest_message,k.latest_message_type=M.latest_message_type,k.latest_message_time=M.latest_message_time))}}},{deep:!0}),de(()=>r.commsByLegion.get(e.projectId),S=>{if(S&&S.length>0){const N=S[S.length-1];C(N)}},{deep:!0}),de(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(S,N)=>{S!==N&&q()})}),de(()=>e.projectId,S=>{o.selectProject(S),i.currentSessionId=null,q(),r.setCurrentLegion(S),d.connectLegion(S)}),Se(()=>{g&&g()}),(S,N)=>(u(),m("div",Tg,[n("div",xg,[n("div",Ag,[n("div",null,[n("h4",Mg,[b.value?(u(),m("span",Og,"ðŸ›")):O("",!0),Z(" "+E(y.value?.name||"Project Overview"),1)]),n("small",Dg,E(y.value?.working_directory),1)]),n("div",Ng,[n("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:H}," âœï¸ Edit "),n("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:T}," âž• "+E(b.value?"Add Minion":"Add Session"),9,Lg)])])]),n("div",Ig,[p.value?(u(),m("div",jg,[...N[0]||(N[0]=[n("div",{class:"spinner-border",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1),n("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(u(),m("div",Pg,E(f.value),1)):y.value?(u(),m("div",Wg,[n("div",Hg,[n("div",Vg,[n("div",Fg,[n("div",Bg,[N[2]||(N[2]=n("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),n("h3",Ug,E(l.value),1),n("small",qg,E(h.value)+" active",1)])])]),n("div",zg,[n("div",Kg,[n("div",Gg,[N[3]||(N[3]=n("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),n("h3",Yg,[n("span",{class:X(x.value)},E(_.value),3)]),n("small",Jg,E(D.value),1)])])])]),b.value?(u(),m("div",Xg,[N[4]||(N[4]=n("div",{class:"card-header"},[n("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),n("div",{class:"card-body"},[n("div",{class:"d-flex gap-2 flex-wrap"},[n("button",{class:"btn btn-outline-primary",onClick:V}," ðŸ“Š View Timeline ")])])])):O("",!0),n("div",Qg,[n("div",Zg,[n("h5",eb,"ðŸŒ³ "+E(b.value?"Minion Hierarchy":"Sessions"),1),n("span",tb,E(w.value.length),1)]),n("div",sb,[$.value?(u(),m("div",nb,[...N[5]||(N[5]=[n("div",{class:"spinner-border spinner-border-sm",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1),n("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!c.value||!c.value.children||c.value.children.length===0?(u(),m("div",ob,' No sessions yet. Click "Add Session" to create one. ')):(u(),m("div",ib,[n("div",ab,[n("div",rb,[n("div",lb,[N[6]||(N[6]=n("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),n("strong",null,E(c.value.name),1),n("span",cb,E(c.value.children.length)+" "+E(c.value.children.length===1?"minion":"minions"),1)]),n("div",ub,[c.value.last_comm?(u(),m("div",db,[n("span",mb,[N[7]||(N[7]=Z(" â†’ ",-1)),n("strong",null,E(L(c.value.last_comm)),1),N[8]||(N[8]=Z(": ",-1))]),n("span",{class:"comm-content",title:c.value.last_comm.content||""},E(F(c.value.last_comm)),9,pb)])):(u(),m("div",fb," No communications yet "))])])]),n("div",vb,[(u(!0),m(ie,null,ae(c.value.children,M=>(u(),ye(mi,{key:M.id,"minion-data":M,level:1,layout:"two-column",onMinionClick:A},null,8,["minion-data"]))),128))])]))])]),n("div",hb,[N[12]||(N[12]=n("div",{class:"card-header"},[n("h5",{class:"mb-0"},"Configuration")],-1)),n("div",_b,[n("dl",gb,[N[9]||(N[9]=n("dt",{class:"col-sm-4"},"Working Directory",-1)),n("dd",bb,E(y.value.working_directory),1),N[10]||(N[10]=n("dt",{class:"col-sm-4"},"Project ID",-1)),n("dd",yb,E(y.value.project_id),1),N[11]||(N[11]=n("dt",{class:"col-sm-4"},"Legion Mode",-1)),n("dd",wb,E(b.value?"Yes (has minions)":"No"),1)])])])])):(u(),m("div",Rg,[...N[1]||(N[1]=[n("h5",{class:"text-muted"},"Project not found",-1),n("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),n("div",$b,[N[13]||(N[13]=n("small",{class:"text-muted"}," Project Overview ",-1)),n("small",Eb,E(l.value)+" session"+E(l.value!==1?"s":""),1)])]))}},Cb=se(Sb,[["__scopeId","data-v-168bf04c"]]),kb=[{path:"/",name:"home",component:wi},{path:"/project/:projectId",name:"project",component:Cb,props:!0},{path:"/session/:sessionId",name:"session",component:i_,props:!0},{path:"/timeline/:legionId",name:"timeline",component:X_,props:!0}],Tb=fi({history:vi(),routes:kb}),xb={class:"connection-indicators"},Ab=["title"],Mb=["title"],Ob=["title"],Db={__name:"ConnectionIndicator",setup(s){const e=Ze();function t(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:r,retryCount:d}=a[i];return d>0&&!r?"indicator-connecting":r?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},r={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},d={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:p,retryCount:f}=d[i];let c="Disconnected";return p?c="Connected":f>0&&(c=`Reconnecting (attempt ${f})`),`${a[i]}
${r[i]}
Status: ${c}`}return(i,a)=>(u(),m("div",xb,[n("div",{class:X(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,Ab),n("div",{class:X(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,Mb),n("div",{class:X(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,Ob)]))}},Nb=se(Db,[["__scopeId","data-v-d35b07c8"]]),Lb={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Ib={class:"d-flex align-items-center gap-2"},jb={__name:"AppHeader",setup(s){const e=ve();function t(){e.toggleSidebar()}return(o,i)=>(u(),m("header",Lb,[n("div",{class:"d-flex align-items-center gap-2"},[n("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[n("span",null,"â˜°",-1)])]),i[1]||(i[1]=n("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),n("div",Ib,[me(Nb)])]))}},Pb={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Rb={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Wb=["title"],Hb={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(s){const e=s,t=v(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function i(d){const p=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function a(d){const p=o(d);return p==="starting"||p==="processing"||p==="pending-prompt"}function r(d){const p=o(d),f=p.charAt(0).toUpperCase()+p.slice(1),c=d.name||"Unnamed Session",$=d.role?` (${d.role})`:"";return`${c}${$}: ${f}`}return(d,p)=>(u(),m("div",Pb,[!s.sessions||s.sessions.length===0?(u(),m("div",Rb)):(u(!0),m(ie,{key:1},ae(s.sessions,f=>(u(),m("div",{key:f.session_id,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":a(f)}]),style:bt({width:t.value,backgroundColor:i(f),cursor:"help"}),title:r(f)},null,14,Wb))),128))]))}},Vb=se(Hb,[["__scopeId","data-v-391d77c1"]]),Fb=["data-project-id"],Bb=["id"],Ub=["aria-expanded","aria-controls","aria-label","onKeydown"],qb=["aria-label","onKeydown"],zb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Kb={class:"fw-semibold",style:{"flex-shrink":"0"}},Gb={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Yb={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Jb=["title"],Xb=["title"],Qb=["id","aria-labelledby"],Zb={class:"accordion-body p-0"},ey={class:"list-group list-group-flush"},ty={class:"minion-hierarchy-container"},sy={key:0,class:"text-center py-2"},ny={key:2,class:"text-muted text-center py-2 small"},oy={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(s){const e=s,t=Pt(),o=Ne(),i=le(),a=ve(),r=I(e.project.is_expanded||!1),d=I(null),p=I(!1);let f=null;const c=v(()=>o.formatPath(e.project.working_directory)),$=v(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(T=>i.getSession(T)).filter(T=>T!=null)),g=v(()=>$.value.length>0),y=v(()=>{const T=t.currentRoute.value;return T.name==="timeline"&&T.params.legionId===e.project.project_id}),w=v(()=>{const T=t.currentRoute.value;return T.name==="project"&&T.params.projectId===e.project.project_id});function b(T){const S=window.bootstrap;if(!S)return;const N=document.getElementById(`collapse-${e.project.project_id}`);if(!N)return;S.Collapse.getOrCreateInstance(N).toggle(),r.value=!r.value}function l(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function h(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function _(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const T=i.currentSessionId;T&&i.getSession(T)&&e.project.session_ids?.includes(T)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function x(){a.showModal("edit-project",{project:e.project})}function D(){a.showModal("create-minion",{project:e.project})}function q(){t.push(`/timeline/${e.project.project_id}`)}async function K(){p.value=!0;try{const T=await oe.get(`/api/legions/${e.project.project_id}/hierarchy`);d.value=T}catch(T){console.error("Failed to load minion hierarchy:",T),d.value=null}finally{p.value=!1}}function L(T){t.push(`/session/${T}`)}function F(T,S){if(T&&T.id===S)return T;if(T&&T.children)for(const N of T.children){const M=F(N,S);if(M)return M}return null}de(r,T=>{T&&K()}),ge(()=>{f=de(()=>i.sessions,T=>{if(!(!d.value||!r.value)){for(const[S,N]of T)if(N.project_id===e.project.project_id){const M=F(d.value,S);M&&M.type==="minion"&&(M.state!==N.state&&(M.state=N.state),M.is_processing!==N.is_processing&&(M.is_processing=N.is_processing),M.latest_message!==N.latest_message&&(M.latest_message=N.latest_message,M.latest_message_type=N.latest_message_type,M.latest_message_time=N.latest_message_time))}}},{deep:!0}),de(()=>i.sessions.size,(T,S)=>{if(r.value&&(T>S&&Array.from(i.sessions.values()).some(k=>k.project_id===e.project.project_id&&(!d.value||!F(d.value,k.session_id)))&&(console.log("New minion detected, reloading hierarchy"),K()),T<S&&d.value)){const N=i.sessions,M=k=>k.type==="minion"&&!N.has(k.id)?!0:k.children?k.children.some(j=>M(j)):!1;M(d.value)&&(console.log("Minion deletion detected, reloading hierarchy"),K())}}),r.value&&K()}),Se(()=>{f&&f()});function C(T){T.dataTransfer.effectAllowed="move",T.dataTransfer.setData("application/project-id",e.project.project_id),T.dataTransfer.setData("text/plain",e.project.project_id),T.target.classList.add("dragging")}function A(T){T.target.classList.remove("dragging")}function V(T){T.preventDefault(),T.dataTransfer.dropEffect="move";const S=T.currentTarget.getBoundingClientRect(),N=S.top+S.height/2;T.clientY<N?(T.currentTarget.classList.add("drop-above"),T.currentTarget.classList.remove("drop-below")):(T.currentTarget.classList.add("drop-below"),T.currentTarget.classList.remove("drop-above"))}function H(T){T.preventDefault(),T.currentTarget.classList.remove("drop-above","drop-below");const S=T.dataTransfer.getData("application/project-id")||T.dataTransfer.getData("text/plain");if(!S||S===e.project.project_id)return;const N=T.currentTarget.getBoundingClientRect(),M=N.top+N.height/2,k=T.clientY<M,j=o.orderedProjects,U=j.findIndex(fe=>fe.project_id===e.project.project_id),G=j.findIndex(fe=>fe.project_id===S);if(U===-1||G===-1)return;const Q=[...j],[ue]=Q.splice(G,1);let ce=k?U:U+1;G<U&&ce--,Q.splice(ce,0,ue);const re=Q.map(fe=>fe.project_id);o.reorderProjects(re)}return(T,S)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":s.project.project_id,draggable:"true",onDragstart:C,onDragend:A,onDragover:V,onDrop:H},[n("h2",{class:"accordion-header",id:`heading-${s.project.project_id}`},[n("div",{class:X(["accordion-button bg-white p-2 project-header-split",{collapsed:!r.value,"project-selected":w.value}])},[n("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":r.value,"aria-controls":`collapse-${s.project.project_id}`,"aria-label":r.value?"Collapse session list":"Expand session list",onClick:he(b,["stop"]),onKeydown:[Be(he(b,["prevent"]),["enter"]),Be(he(b,["prevent"]),["space"])]},[(u(),m("svg",{class:X(["chevron-icon",{expanded:r.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...S[0]||(S[0]=[n("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,Ub),n("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${s.project.name} overview`,onClick:l,onKeydown:[Be(he(l,["prevent"]),["enter"]),Be(he(l,["prevent"]),["space"])]},[n("div",zb,[n("div",Kb,[g.value?(u(),m("span",Gb,"ðŸ›")):O("",!0),Z(" "+E(s.project.name),1)]),n("div",Yb,[n("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:he(x,["stop"])}," âœï¸ "),n("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:he(D,["stop"])}," âž• ",8,Jb)])]),n("small",{class:"text-muted font-monospace",title:s.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},E(c.value),9,Xb)],40,qb)],2)],8,Bb),me(Vb,{project:s.project,sessions:$.value},null,8,["project","sessions"]),n("div",{id:`collapse-${s.project.project_id}`,class:X(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${s.project.project_id}`,onShown:h,onHidden:_},[n("div",Zb,[n("div",ey,[g.value?(u(),m("div",{key:0,class:X(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:y.value}]),style:{cursor:"pointer"},onClick:q},[...S[1]||(S[1]=[n("div",{class:"flex-grow-1"},[n("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),n("span",{class:"fw-semibold"},"Timeline"),n("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):O("",!0),n("div",ty,[p.value?(u(),m("div",sy,[...S[2]||(S[2]=[n("div",{class:"spinner-border spinner-border-sm",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value&&d.value.children&&d.value.children.length>0?(u(!0),m(ie,{key:1},ae(d.value.children,N=>(u(),ye(mi,{key:N.id,"minion-data":N,level:0,layout:"sidebar",onMinionClick:L},null,8,["minion-data"]))),128)):(u(),m("div",ny," No sessions "))])])])],42,Qb)],40,Fb))}},iy=se(oy,[["__scopeId","data-v-a15b34e8"]]),ay={class:"project-list"},ry={key:0,class:"text-muted text-center py-3"},ly={__name:"ProjectList",setup(s){const e=Ne(),t=v(()=>e.orderedProjects);return(o,i)=>(u(),m("div",ay,[t.value.length===0?(u(),m("div",ry,' No projects yet. Click "New" to create one. ')):O("",!0),(u(!0),m(ie,null,ae(t.value,a=>(u(),ye(iy,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},cy={class:"flex-grow-1 overflow-auto p-3"},uy={id:"sessions-container"},dy={__name:"Sidebar",setup(s){const e=ve(),t=v(()=>e.sidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const r=I(!1);function d(c){r.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",f)}function p(c){r.value&&e.setSidebarWidth(c.clientX)}function f(){r.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f)}return(c,$)=>(u(),m("aside",{id:"sidebar",class:X(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:bt(i.value)},[n("div",cy,[n("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=n("h6",{class:"text-muted mb-0"},"Projects",-1)),n("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),n("div",uy,[me(ly)])]),n("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},my=se(dy,[["__scopeId","data-v-d792f0f0"]]),py={class:"modal-dialog modal-lg"},fy={class:"modal-content"},vy={class:"modal-body"},hy={class:"mb-3"},_y={class:"input-group"},gy=["disabled"],by={key:0,class:"text-center py-4"},yy={key:1,class:"alert alert-danger",role:"alert"},wy={key:2,class:"folder-list"},$y=["onClick","onDblclick"],Ey={class:"d-flex align-items-center flex-grow-1"},Sy=["onClick"],Cy={key:1,class:"text-center text-muted py-3"},ky={class:"modal-footer"},Ty=["disabled"],xy={__name:"FolderBrowserModal",setup(s){const e=ve(),t=I(""),o=I(""),i=I([]),a=I(!1),r=I(""),d=I(null);let p=null,f=null;const c=v(()=>{if(!t.value)return null;const x=t.value.split(/[\\/]/).filter(Boolean);return x.length<=1?null:(x.pop(),x.length>0?"/"+x.join("/"):"/")});function $(x){if(!x)return"";const D=x.split(/[\\/]/).filter(Boolean);return D.length<=2?x:".../"+D.slice(-2).join("/")}async function g(){a.value=!0,r.value="",i.value=[],o.value="";try{const x=t.value?{path:t.value}:{},D=await oe.get("/api/filesystem/browse",{params:x});D.current_path&&(t.value=D.current_path),i.value=D.directories||[]}catch(x){console.error("Failed to load directory:",x),r.value=x.message||"Failed to load directory"}finally{a.value=!1}}function y(x){o.value=x.path}function w(x){t.value=x.path,o.value="",g()}function b(){c.value&&(t.value=c.value,o.value="",g())}function l(){const x=o.value||t.value;x&&f&&f(x),p&&p.hide()}function h(){g()}function _(){i.value=[],o.value="",r.value="",f=null,e.hideModal()}return de(()=>e.currentModal,x=>{if(x?.name==="folder-browser"&&p){const D=x.data||{};t.value=D.defaultPath||D.currentPath||"",f=D.onSelect||null,p.show()}}),ge(()=>{d.value&&xe(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(D=>D.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{p=new x(d.value),d.value.addEventListener("shown.bs.modal",h),d.value.addEventListener("hidden.bs.modal",_)})}),Se(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",h),d.value.removeEventListener("hidden.bs.modal",_)),p&&p.dispose()}),(x,D)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[n("div",py,[n("div",fy,[D[6]||(D[6]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",vy,[n("div",hy,[D[1]||(D[1]=n("label",{class:"form-label"},"Current Path:",-1)),n("div",_y,[_e(n("input",{type:"text",class:"form-control","onUpdate:modelValue":D[0]||(D[0]=q=>t.value=q),onKeyup:Be(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,t.value]]),n("button",{class:"btn btn-outline-secondary",onClick:g,disabled:a.value}," ðŸ”„ Refresh ",8,gy)])]),a.value?(u(),m("div",by,[...D[2]||(D[2]=[n("div",{class:"spinner-border",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(u(),m("div",yy,E(r.value),1)):(u(),m("div",wy,[c.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...D[3]||(D[3]=[n("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),n("span",{class:"text-secondary"},"..",-1)])])):O("",!0),(u(!0),m(ie,null,ae(i.value,q=>(u(),m("div",{key:q.path,class:X(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:q.path===o.value}]),onClick:K=>y(q),onDblclick:K=>w(q),role:"button"},[n("div",Ey,[D[4]||(D[4]=n("span",{class:"me-2"},"ðŸ“",-1)),n("span",null,E(q.name),1)]),n("button",{class:"btn btn-sm btn-outline-primary",onClick:he(K=>w(q),["stop"])}," Open ",8,Sy)],42,$y))),128)),i.value.length===0?(u(),m("div",Cy," No subdirectories found ")):O("",!0)]))]),n("div",ky,[D[5]||(D[5]=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),n("button",{type:"button",class:"btn btn-primary",onClick:l,disabled:!o.value},' Select "'+E($(o.value||t.value))+'" ',9,Ty)])])])],512))}},Ay=se(xy,[["__scopeId","data-v-0d61ed46"]]),My={class:"modal-dialog"},Oy={class:"modal-content"},Dy={class:"modal-body"},Ny={class:"mb-3"},Ly={key:0,class:"invalid-feedback"},Iy={class:"mb-3"},jy={class:"input-group"},Py={key:0,class:"invalid-feedback"},Ry={class:"mb-3 form-check"},Wy={key:0,class:"mb-3 ms-4"},Hy={key:1,class:"alert alert-danger",role:"alert"},Vy={class:"modal-footer"},Fy=["disabled"],By={key:0,class:"spinner-border spinner-border-sm me-2"},Uy={__name:"ProjectCreateModal",setup(s){const e=Ne(),t=le(),o=ve(),i=I({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),a=I({name:"",workingDirectory:""}),r=I(!1),d=I(""),p=I(null);let f=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:l=>{i.value.workingDirectory=l,a.value.workingDirectory=""}})}function $(){a.value={};let l=!0;return i.value.name.trim()||(a.value.name="Project name is required",l=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",l=!1),l}async function g(){if($()){r.value=!0,d.value="";try{const l=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(l.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),y()}catch(l){console.error("Failed to create project:",l),d.value=l.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function y(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},a.value={},d.value=""}function w(){const l=document.getElementById("projectName");l&&l.focus()}function b(){y(),o.hideModal()}return de(()=>o.currentModal,l=>{l?.name==="create-project"&&f&&f.show()}),ge(()=>{p.value&&xe(async()=>{const{default:l}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:l}},__vite__mapDeps([0,1])).then(({default:l})=>{f=new l(p.value),p.value.addEventListener("shown.bs.modal",w),p.value.addEventListener("hidden.bs.modal",b)})}),Se(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",w),p.value.removeEventListener("hidden.bs.modal",b)),f&&f.dispose()}),(l,h)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[n("div",My,[n("div",Oy,[h[11]||(h[11]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",Dy,[n("form",{onSubmit:he(g,["prevent"])},[n("div",Ny,[h[4]||(h[4]=n("label",{for:"projectName",class:"form-label"},"Project Name",-1)),_e(n("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=_=>i.value.name=_),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),a.value.name?(u(),m("div",Ly,E(a.value.name),1)):O("",!0)]),n("div",Iy,[h[5]||(h[5]=n("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),n("div",jy,[_e(n("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=_=>i.value.workingDirectory=_),placeholder:"/path/to/project",required:""},null,2),[[We,i.value.workingDirectory]]),n("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(u(),m("div",Py,E(a.value.workingDirectory),1)):O("",!0)]),h[6]||(h[6]=n("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),n("div",Ry,[_e(n("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=_=>i.value.createSession=_)},null,512),[[hi,i.value.createSession]]),h[7]||(h[7]=n("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=n("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(u(),m("div",Wy,[h[9]||(h[9]=n("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),_e(n("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=_=>i.value.sessionName=_),placeholder:"main"},null,512),[[We,i.value.sessionName]])])):O("",!0),d.value?(u(),m("div",Hy,E(d.value),1)):O("",!0)],32)]),n("div",Vy,[h[10]||(h[10]=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),n("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:r.value},[r.value?(u(),m("span",By)):O("",!0),Z(" "+E(r.value?"Creating...":"Create Project"),1)],8,Fy)])])])],512))}},qy=se(Uy,[["__scopeId","data-v-ea55fdae"]]),zy={class:"modal-dialog"},Ky={class:"modal-content"},Gy={class:"modal-body"},Yy={class:"mb-3"},Jy={key:0,class:"invalid-feedback"},Xy={class:"mb-3"},Qy=["value"],Zy={key:0,class:"alert alert-danger",role:"alert"},ew={class:"danger-zone"},tw={class:"text-muted small"},sw=["disabled"],nw={key:0,class:"alert alert-warning mt-3",role:"alert"},ow={class:"mb-2"},iw={class:"d-flex gap-2"},aw=["disabled"],rw={key:0,class:"spinner-border spinner-border-sm me-2"},lw=["disabled"],cw={class:"modal-footer"},uw=["disabled"],dw={key:0,class:"spinner-border spinner-border-sm me-2"},mw={__name:"ProjectEditModal",setup(s){const e=Ne(),t=ve(),o=I(null),i=I({name:""}),a=I({name:""}),r=I(!1),d=I(!1),p=I(""),f=I(!1),c=I(null);let $=null;const g=v(()=>o.value?.session_ids?.length||0);function y(){a.value={};let x=!0;return i.value.name.trim()||(a.value.name="Project name is required",x=!1),x}async function w(){if(!(!y()||!o.value)){r.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(x){console.error("Failed to update project:",x),p.value=x.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function b(){if(o.value){d.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(x){console.error("Failed to delete project:",x),p.value=x.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function l(){i.value={name:""},a.value={},p.value="",f.value=!1}function h(){const x=document.getElementById("editProjectName");x&&(x.focus(),x.select())}function _(){l(),o.value=null,t.hideModal()}return de(()=>t.currentModal,x=>{if(x?.name==="edit-project"&&$){const D=x.data||{};o.value=D.project,o.value&&(i.value.name=o.value.name),$.show()}}),ge(()=>{c.value&&xe(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(D=>D.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{$=new x(c.value),c.value.addEventListener("shown.bs.modal",h),c.value.addEventListener("hidden.bs.modal",_)})}),Se(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",h),c.value.removeEventListener("hidden.bs.modal",_)),$&&$.dispose()}),(x,D)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[n("div",zy,[n("div",Ky,[D[10]||(D[10]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",Gy,[n("form",{onSubmit:he(w,["prevent"])},[n("div",Yy,[D[3]||(D[3]=n("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),_e(n("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":D[0]||(D[0]=q=>i.value.name=q),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),a.value.name?(u(),m("div",Jy,E(a.value.name),1)):O("",!0)]),n("div",Xy,[D[4]||(D[4]=n("label",{class:"form-label"},"Working Directory",-1)),n("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Qy),D[5]||(D[5]=n("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(u(),m("div",Zy,E(p.value),1)):O("",!0)],32),D[8]||(D[8]=n("hr",null,null,-1)),n("div",ew,[D[6]||(D[6]=n("h6",{class:"text-danger"},"Danger Zone",-1)),n("p",tw," Deleting this project will also delete all "+E(g.value)+" session(s) and their data. This action cannot be undone. ",1),n("button",{type:"button",class:"btn btn-outline-danger",onClick:D[1]||(D[1]=q=>f.value=!0),disabled:d.value}," ðŸ—‘ï¸ Delete Project ",8,sw)]),f.value?(u(),m("div",nw,[D[7]||(D[7]=n("strong",null,"Are you sure?",-1)),n("p",ow,' This will permanently delete the project "'+E(o.value?.name)+'" and all '+E(g.value)+" session(s). ",1),n("div",iw,[n("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:d.value},[d.value?(u(),m("span",rw)):O("",!0),Z(" "+E(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,aw),n("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:D[2]||(D[2]=q=>f.value=!1),disabled:d.value}," Cancel ",8,lw)])])):O("",!0)]),n("div",cw,[D[9]||(D[9]=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),n("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:r.value},[r.value?(u(),m("span",dw)):O("",!0),Z(" "+E(r.value?"Saving...":"Save Changes"),1)],8,uw)])])])],512))}},pw=se(mw,[["__scopeId","data-v-52679516"]]),fw={class:"general-tab"},vw={key:0,class:"mb-3"},hw={for:"template-select",class:"form-label"},_w=["value"],gw=["value"],bw={key:0,class:"form-text"},yw={class:"mb-3"},ww={for:"config-name",class:"form-label"},$w=["value","placeholder","pattern","title"],Ew={key:0,class:"invalid-feedback"},Sw={key:1,class:"form-text"},Cw={key:1,class:"mb-3"},kw=["value"],Tw={class:"mb-3"},xw=["value"],Aw={class:"form-text"},Mw={key:0,class:"text-warning"},Ow={key:1},Dw={class:"mb-3"},Nw={for:"config-permission-mode",class:"form-label"},Lw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Iw={key:1,class:"field-indicator modified",title:"Modified from template"},jw=["value","disabled"],Pw={key:0,value:"bypassPermissions"},Rw={class:"form-text"},Ww={key:0,class:"text-warning"},Hw={key:1},Vw={class:"mb-3"},Fw={for:"config-role",class:"form-label"},Bw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Uw={key:1,class:"field-indicator modified",title:"Modified from template"},qw=["value","placeholder"],zw={class:"form-text"},Kw={key:2,class:"mb-3"},Gw={class:"input-group"},Yw=["value","placeholder","disabled","readonly"],Jw={class:"form-text"},Xw={key:3,class:"mb-3"},Qw={class:"form-control-plaintext"},Zw={key:4,class:"mb-3 form-check"},e1=["checked"],t1={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(s){const e=s,t=v(()=>e.mode==="create-session"||e.mode==="edit-session"),o=v(()=>e.mode==="create-template"||e.mode==="edit-template"),i=v(()=>e.mode==="create-session"),a=v(()=>e.mode==="edit-session"),r=v(()=>e.session?.state==="active"||e.session?.state==="starting"),d=v(()=>{if(!e.session)return!1;const b=e.session.model||"sonnet";return e.formData.model!==b}),p=v(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=v(()=>e.selectedTemplateId?e.templates.find(b=>b.template_id===e.selectedTemplateId):null),c={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},$=v(()=>c[e.formData.model]||null),g=v(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),y=v(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function w(b){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[b]||"bg-secondary"}return(b,l)=>(u(),m("div",fw,[i.value?(u(),m("div",vw,[n("label",hw,[l[10]||(l[10]=Z(" Template ",-1)),n("button",{type:"button",onClick:l[0]||(l[0]=h=>b.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),n("select",{id:"template-select",value:s.selectedTemplateId,onChange:l[1]||(l[1]=h=>b.$emit("update:selected-template-id",h.target.value||null)),class:"form-select"},[l[11]||(l[11]=n("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(ie,null,ae(s.templates,h=>(u(),m("option",{key:h.template_id,value:h.template_id},E(h.name),9,gw))),128))],40,_w),f.value?(u(),m("div",bw,E(f.value.description),1)):O("",!0)])):O("",!0),n("div",yw,[n("label",ww,[Z(E(o.value?"Template Name":"Session Name")+" ",1),l[12]||(l[12]=n("span",{class:"text-danger"},"*",-1))]),n("input",{id:"config-name",type:"text",class:X(["form-control",{"is-invalid":s.errors.name}]),value:s.formData.name,onInput:l[2]||(l[2]=h=>b.$emit("update:form-data","name",h.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,$w),s.errors.name?(u(),m("div",Ew,E(s.errors.name),1)):O("",!0),t.value?(u(),m("div",Sw,"Must be a single word (no spaces) for #nametag matching")):O("",!0)]),o.value?(u(),m("div",Cw,[l[13]||(l[13]=n("label",{for:"config-description",class:"form-label"},"Description",-1)),n("textarea",{id:"config-description",class:"form-control",value:s.formData.description,onInput:l[3]||(l[3]=h=>b.$emit("update:form-data","description",h.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,kw)])):O("",!0),n("div",Tw,[l[16]||(l[16]=n("label",{for:"config-model",class:"form-label"},"Model",-1)),n("select",{id:"config-model",class:"form-select",value:s.formData.model,onChange:l[4]||(l[4]=h=>b.$emit("update:form-data","model",h.target.value))},[...l[14]||(l[14]=[n("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),n("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),n("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),n("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,xw),n("div",Aw,[a.value&&r.value&&d.value?(u(),m("span",Mw,[...l[15]||(l[15]=[Z(" Model change requires a ",-1),n("strong",null,"reset",-1),Z(" (not restart) to take effect. ",-1)])])):$.value?(u(),m("span",Ow,E($.value.description),1)):O("",!0)])]),n("div",Dw,[n("label",Nw,[l[17]||(l[17]=Z(" Permission Mode ",-1)),s.fieldStates.permission_mode==="autofilled"?(u(),m("span",Lw," < ")):O("",!0),s.fieldStates.permission_mode==="modified"?(u(),m("span",Iw," * ")):O("",!0)]),n("select",{id:"config-permission-mode",class:X(["form-select",y.value]),value:s.formData.permission_mode,onChange:l[5]||(l[5]=h=>b.$emit("update:form-data","permission_mode",h.target.value)),disabled:a.value&&!r.value},[l[18]||(l[18]=n("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),l[19]||(l[19]=n("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),l[20]||(l[20]=n("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!a.value||p.value?(u(),m("option",Pw," Bypass Permissions (No prompts - use with caution) ")):O("",!0)],42,jw),n("div",Rw,[a.value&&!r.value?(u(),m("span",Ww," Session must be active to change permission mode. Start the session first. ")):(u(),m("span",Hw,"Controls which tool actions require permission prompts"))])]),n("div",Vw,[n("label",Fw,[Z(E(o.value?"Default Role":"Role")+" ",1),s.fieldStates.default_role==="autofilled"?(u(),m("span",Bw," < ")):O("",!0),s.fieldStates.default_role==="modified"?(u(),m("span",Uw," * ")):O("",!0)]),n("input",{id:"config-role",type:"text",class:X(["form-control",g.value]),value:s.formData.default_role,onInput:l[6]||(l[6]=h=>b.$emit("update:form-data","default_role",h.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,qw),n("div",zw,E(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(u(),m("div",Kw,[l[21]||(l[21]=n("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),n("div",Gw,[n("input",{id:"config-working-dir",type:"text",class:"form-control",value:s.formData.working_directory,onInput:l[7]||(l[7]=h=>b.$emit("update:form-data","working_directory",h.target.value)),placeholder:a.value?"":"Leave empty to inherit from project",disabled:a.value,readonly:a.value},null,40,Yw),a.value?O("",!0):(u(),m("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:l[8]||(l[8]=h=>b.$emit("open-folder-browser"))}," Browse "))]),n("div",Jw,E(a.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):O("",!0),a.value&&s.session?(u(),m("div",Xw,[l[22]||(l[22]=n("label",{class:"form-label"},"Current State",-1)),n("div",Qw,[n("span",{class:X(["badge",w(s.session.state)])},E(s.session.state),3)])])):O("",!0),i.value?(u(),m("div",Zw,[n("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:s.formData.startImmediately,onChange:l[9]||(l[9]=h=>b.$emit("update:form-data","startImmediately",h.target.checked))},null,40,e1),l[23]||(l[23]=n("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):O("",!0)]))}},s1=se(t1,[["__scopeId","data-v-b9edc342"]]),n1={class:"permissions-tab"},o1={class:"mb-3"},i1={for:"config-allowed-tools",class:"form-label"},a1={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},r1={key:1,class:"field-indicator modified",title:"Modified from template"},l1={key:0,class:"tools-list mb-2"},c1=["onClick"],u1={class:"input-group input-group-sm"},d1=["onKeydown"],m1=["disabled"],p1={class:"mt-2"},f1=["onClick"],v1={class:"form-text"},h1={key:0,class:"text-warning"},_1={key:1},g1={class:"mb-3"},b1={class:"capabilities-editor"},y1={key:0,class:"capabilities-list mb-2"},w1=["onClick"],$1={class:"input-group input-group-sm"},E1=["onKeydown"],S1=["disabled"],C1={key:0,class:"mb-3"},k1={class:"settings-sources-editor"},T1={class:"form-check"},x1=["checked"],A1={class:"form-check"},M1=["checked"],O1={class:"form-check"},D1=["checked"],N1={class:"form-text"},L1={key:0,class:"text-warning"},I1={key:1},j1={key:1,class:"mb-3"},P1={class:"mb-3"},R1={key:0,class:"mt-2"},W1=["value"],H1=["value"],V1={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(s,{emit:e}){const t=s,o=e,i=I(""),a=I(""),r=I(!1),d=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=v(()=>t.mode==="create-template"||t.mode==="edit-template"),f=v(()=>t.mode==="create-session"||t.mode==="edit-session"),c=v(()=>t.mode==="edit-session"),$=v(()=>t.session?.state==="active"||t.session?.state==="starting"),g=v(()=>{if(!t.session)return!1;const C=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==C}),y=v(()=>t.formData.setting_sources||["user","project","local"]),w=v(()=>{if(!t.session)return!1;const C=t.session.setting_sources||["user","project","local"],A=t.formData.setting_sources||["user","project","local"];return JSON.stringify(C.sort())!==JSON.stringify(A.sort())}),b=v(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(C=>C.trim()).filter(C=>C.length>0)),l=v(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(C=>C.trim()).filter(C=>C.length>0)),h=v(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),_=v(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function x(){const C=i.value.trim();if(C){if(!b.value.includes(C)){const A=[...b.value,C];o("update:form-data","allowed_tools",A.join(", "))}i.value=""}}function D(C){const A=[...b.value];A.splice(C,1),o("update:form-data","allowed_tools",A.join(", "))}function q(C){if(b.value.includes(C)){const A=b.value.indexOf(C);D(A)}else{const A=[...b.value,C];o("update:form-data","allowed_tools",A.join(", "))}}function K(){const C=a.value.trim().toLowerCase();if(C){if(!l.value.includes(C)){const A=[...l.value,C];o("update:form-data","capabilities",A.join(", "))}a.value=""}}function L(C){const A=[...l.value];A.splice(C,1),o("update:form-data","capabilities",A.join(", "))}function F(C){const A=[...y.value],V=A.indexOf(C);V>=0?A.splice(V,1):A.push(C),o("update:form-data","setting_sources",A)}return(C,A)=>(u(),m("div",n1,[n("div",o1,[n("label",i1,[A[9]||(A[9]=Z(" Allowed Tools ",-1)),s.fieldStates.allowed_tools==="autofilled"?(u(),m("span",a1," < ")):O("",!0),s.fieldStates.allowed_tools==="modified"?(u(),m("span",r1," * ")):O("",!0)]),n("div",{class:X(["allowed-tools-editor",_.value])},[b.value.length>0?(u(),m("div",l1,[(u(!0),m(ie,null,ae(b.value,(V,H)=>(u(),m("span",{key:H,class:"badge bg-primary me-1 mb-1 tool-badge"},[Z(E(V)+" ",1),n("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:T=>D(H),"aria-label":"Remove tool"},null,8,c1)]))),128))])):O("",!0),n("div",u1,[_e(n("input",{type:"text",class:"form-control","onUpdate:modelValue":A[0]||(A[0]=V=>i.value=V),onKeydown:Be(he(x,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,d1),[[We,i.value]]),n("button",{type:"button",class:"btn btn-outline-primary",onClick:x,disabled:!i.value.trim()}," Add ",8,m1)]),n("div",p1,[A[10]||(A[10]=n("span",{class:"form-text me-2"},"Quick add:",-1)),(u(),m(ie,null,ae(d,V=>n("button",{key:V,type:"button",class:X(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":b.value.includes(V)}]),onClick:H=>q(V)},E(V),11,f1)),64))])],2),n("div",v1,[c.value&&$.value&&g.value?(u(),m("span",h1,[...A[11]||(A[11]=[Z(" Allowed tools change requires a ",-1),n("strong",null,"reset",-1),Z(" (not restart) to take effect. ",-1)])])):(u(),m("span",_1,E(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),n("div",g1,[A[12]||(A[12]=n("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),n("div",b1,[l.value.length>0?(u(),m("div",y1,[(u(!0),m(ie,null,ae(l.value,(V,H)=>(u(),m("span",{key:H,class:"badge bg-info me-1 mb-1 capability-badge"},[Z(E(V)+" ",1),n("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:T=>L(H),"aria-label":"Remove capability"},null,8,w1)]))),128))])):O("",!0),n("div",$1,[_e(n("input",{type:"text",class:"form-control","onUpdate:modelValue":A[1]||(A[1]=V=>a.value=V),onKeydown:Be(he(K,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,E1),[[We,a.value]]),n("button",{type:"button",class:"btn btn-outline-info",onClick:K,disabled:!a.value.trim()}," Add ",8,S1)])]),A[13]||(A[13]=n("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(u(),m("div",C1,[A[18]||(A[18]=n("label",{class:"form-label"},"Settings Sources",-1)),n("div",k1,[n("div",T1,[n("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:y.value.includes("user"),onChange:A[2]||(A[2]=V=>F("user"))},null,40,x1),A[14]||(A[14]=n("label",{class:"form-check-label",for:"setting-source-user"},[Z(" User "),n("code",{class:"small"},"~/.claude/settings.json")],-1))]),n("div",A1,[n("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:y.value.includes("project"),onChange:A[3]||(A[3]=V=>F("project"))},null,40,M1),A[15]||(A[15]=n("label",{class:"form-check-label",for:"setting-source-project"},[Z(" Project "),n("code",{class:"small"},".claude/settings.json")],-1))]),n("div",O1,[n("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:y.value.includes("local"),onChange:A[4]||(A[4]=V=>F("local"))},null,40,D1),A[16]||(A[16]=n("label",{class:"form-check-label",for:"setting-source-local"},[Z(" Local "),n("code",{class:"small"},".claude/settings.local.json")],-1))])]),n("div",N1,[c.value&&$.value&&w.value?(u(),m("span",L1,[...A[17]||(A[17]=[Z(" Settings sources change requires a ",-1),n("strong",null,"restart",-1),Z(" to take effect. ",-1)])])):(u(),m("span",I1," Select which settings files to load permissions from "))])])):O("",!0),f.value?(u(),m("div",j1,[n("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:A[5]||(A[5]=V=>C.$emit("preview-permissions"))}," Preview Effective Permissions ")])):O("",!0),n("div",P1,[n("a",{class:"text-muted small",role:"button",onClick:A[6]||(A[6]=V=>r.value=!r.value)},E(r.value?"Hide":"Show")+" raw input ",1),r.value?(u(),m("div",R1,[A[19]||(A[19]=n("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),n("input",{type:"text",class:X(["form-control form-control-sm",h.value]),value:s.formData.allowed_tools,onInput:A[7]||(A[7]=V=>C.$emit("update:form-data","allowed_tools",V.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,W1),A[20]||(A[20]=n("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),n("input",{type:"text",class:"form-control form-control-sm",value:s.formData.capabilities,onInput:A[8]||(A[8]=V=>C.$emit("update:form-data","capabilities",V.target.value)),placeholder:"python, testing, debugging"},null,40,H1)])):O("",!0)])]))}},F1=se(V1,[["__scopeId","data-v-e58aa2be"]]),B1={class:"advanced-tab"},U1={key:0,class:"alert alert-warning mb-3",role:"alert"},q1={class:"mb-3"},z1={for:"config-system-prompt",class:"form-label"},K1={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},G1={key:1,class:"field-indicator modified",title:"Modified from template"},Y1=["value","rows","maxlength","placeholder"],J1={class:"form-text d-flex justify-content-between"},X1={key:0,class:"invalid-feedback"},Q1={class:"mb-3 form-check"},Z1=["checked"],e$={key:0,class:"form-text text-warning"},t$={key:1,class:"mb-3 form-check"},s$=["checked"],n$={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(s,{emit:e}){const t=s,o=e,i=v(()=>t.mode==="create-session"||t.mode==="edit-session"),a=v(()=>t.mode==="create-template"||t.mode==="edit-template"),r=v(()=>t.mode==="edit-session"),d=v(()=>t.session?.state==="active"||t.session?.state==="starting"),p=v(()=>{if(!t.session)return!1;const _=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),x=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),D=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return _||x||D}),f=v(()=>a.value?6e3:2e3),c=v(()=>a.value?t.formData.system_prompt:t.formData.initialization_context),$=v(()=>c.value?.length||0),g=v(()=>$.value>f.value),y=v(()=>{const _=f.value*.9;return $.value>_&&$.value<=f.value}),w=v(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),b=v(()=>t.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),l=v(()=>{const _={};return g.value&&(_["is-invalid"]=!0),t.fieldStates.initialization_context==="autofilled"&&(_["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&(_["field-modified"]=!0),_});function h(_){const x=_.target.value,D=a.value?"system_prompt":"initialization_context";o("update:form-data",D,x)}return(_,x)=>(u(),m("div",B1,[r.value&&d.value&&p.value?(u(),m("div",U1,[...x[2]||(x[2]=[n("small",null,[Z("Changes to these settings require a "),n("strong",null,"reset"),Z(" (not restart) to take effect.")],-1)])])):O("",!0),n("div",q1,[n("label",z1,[Z(E(a.value?"Default System Prompt":"Initialization Context")+" ",1),s.fieldStates.initialization_context==="autofilled"?(u(),m("span",K1," < ")):O("",!0),s.fieldStates.initialization_context==="modified"?(u(),m("span",G1," * ")):O("",!0)]),n("textarea",{id:"config-system-prompt",class:X(["form-control",l.value]),value:c.value,onInput:h,rows:a.value?4:5,maxlength:f.value,placeholder:w.value},null,42,Y1),n("div",J1,[n("span",null,E(b.value),1),n("span",{class:X({"text-danger":g.value,"text-warning":y.value})},E($.value)+" / "+E(f.value)+" chars ",3)]),g.value?(u(),m("div",X1,E(a.value?"System prompt":"Initialization context")+" exceeds "+E(f.value)+" character limit ",1)):O("",!0)]),n("div",Q1,[n("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:s.formData.override_system_prompt,onChange:x[0]||(x[0]=D=>_.$emit("update:form-data","override_system_prompt",D.target.checked))},null,40,Z1),x[3]||(x[3]=n("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),s.formData.override_system_prompt?(u(),m("div",e$,[n("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+E(a.value?"":" or legion guide")+").",1)])):O("",!0)]),i.value?(u(),m("div",t$,[n("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:s.formData.sandbox_enabled,onChange:x[1]||(x[1]=D=>_.$emit("update:form-data","sandbox_enabled",D.target.checked))},null,40,s$),x[4]||(x[4]=n("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),n("div",{class:X(["form-text",s.formData.sandbox_enabled?"text-info":"text-muted"])},[n("small",null,E(s.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):O("",!0)]))}},o$=se(n$,[["__scopeId","data-v-1909e7ae"]]),i$={class:"modal-dialog modal-lg"},a$={class:"modal-content"},r$={class:"modal-body"},l$={key:0,class:"text-center py-4"},c$={key:1,class:"alert alert-danger"},u$={key:2},d$={class:"mb-3"},m$={class:"small text-muted mb-2"},p$={key:0},f$={key:0,class:"alert alert-info"},v$={key:1},h$={class:"table table-sm table-striped"},_$={key:2,class:"mt-3"},g$={class:"modal-footer"},b$=["disabled"],y$={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(s,{expose:e,emit:t}){const o=s,i=t,a=I(null);let r=null;const d=I(!1),p=I(""),f=I([]);de(a,b=>{b&&(r=new ct(b),b.addEventListener("hidden.bs.modal",()=>{i("close")}))});function c(){r&&(r.show(),g())}function $(){r&&r.hide()}async function g(){d.value=!0,p.value="",f.value=[];try{const b=await oe.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),p.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{d.value=!1}}function y(){g()}function w(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:c,hide:$}),(b,l)=>(u(),m("div",{ref_key:"modalRef",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[n("div",i$,[n("div",a$,[l[7]||(l[7]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",r$,[d.value?(u(),m("div",l$,[...l[0]||(l[0]=[n("div",{class:"spinner-border text-primary",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1),n("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(u(),m("div",c$,E(p.value),1)):(u(),m("div",u$,[n("div",d$,[l[2]||(l[2]=n("h6",null,"Settings Sources",-1)),n("div",m$,[l[1]||(l[1]=Z(" Loading permissions from: ",-1)),(u(!0),m(ie,null,ae(s.settingSources,(h,_)=>(u(),m("span",{key:h},[n("code",null,E(h),1),_<s.settingSources.length-1?(u(),m("span",p$,", ")):O("",!0)]))),128))])]),f.value.length===0?(u(),m("div",f$," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(u(),m("div",v$,[n("h6",null,"Pre-approved Permissions ("+E(f.value.length)+")",1),n("table",h$,[l[3]||(l[3]=n("thead",null,[n("tr",null,[n("th",null,"Permission"),n("th",null,"Source(s)")])],-1)),n("tbody",null,[(u(!0),m(ie,null,ae(f.value,h=>(u(),m("tr",{key:h.permission},[n("td",null,[n("code",null,E(h.permission),1)]),n("td",null,[(u(!0),m(ie,null,ae(h.sources,(_,x)=>(u(),m("span",{key:_,class:X(["badge me-1",w(_)])},E(_),3))),128))])]))),128))])])])),s.sessionAllowedTools.length>0?(u(),m("div",_$,[l[4]||(l[4]=n("h6",null,"Session Allowed Tools",-1)),l[5]||(l[5]=n("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),n("div",null,[(u(!0),m(ie,null,ae(s.sessionAllowedTools,h=>(u(),m("span",{key:h,class:"badge bg-success me-1 mb-1"},E(h),1))),128))])])):O("",!0)]))]),n("div",g$,[l[6]||(l[6]=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),n("button",{type:"button",class:"btn btn-outline-primary",onClick:y,disabled:d.value}," Refresh ",8,b$)])])])],512))}},w$=se(y$,[["__scopeId","data-v-988ff7c4"]]),$$={class:"modal-dialog modal-lg modal-dialog-centered"},E$={class:"modal-content"},S$={class:"modal-header"},C$={id:"configurationModalLabel",class:"modal-title"},k$={class:"modal-body"},T$={key:0,class:"template-list-view"},x$={key:0,class:"alert alert-info"},A$={class:"card-body"},M$={class:"d-flex justify-content-between align-items-start"},O$={class:"flex-grow-1"},D$={class:"card-title mb-1"},N$={key:0,class:"card-text text-muted small mb-2"},L$={class:"template-meta"},I$={class:"badge bg-secondary me-2"},j$={class:"text-muted small"},P$={class:"btn-group btn-group-sm ms-3"},R$=["onClick"],W$=["onClick"],H$={key:1},V$={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},F$={class:"nav-item",role:"presentation"},B$={key:0,class:"error-indicator",title:"This tab has validation errors"},U$={class:"nav-item",role:"presentation"},q$={key:0,class:"error-indicator",title:"This tab has validation errors"},z$={class:"nav-item",role:"presentation"},K$={key:0,class:"error-indicator",title:"This tab has validation errors"},G$={class:"tab-content"},Y$={key:2,class:"alert alert-danger mt-3"},J$={class:"modal-footer"},X$={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},Q$=["disabled"],Z$={key:0,class:"spinner-border spinner-border-sm me-2"},eE={__name:"ConfigurationModal",setup(s){const e=Pt(),t=Ne(),o=le(),i=ve(),a=I(null);let r=null;const d=I(null),p=I("create-session"),f=I("general"),c=I(null),$=I(null),g=I(null),y=I([]),w=I(null),b=I(null),l=I({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=bs({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),_=bs({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),x=bs({name:"",system_prompt:"",initialization_context:""}),D=v(()=>({general:!!x.name,permissions:!1,advanced:!!x.system_prompt||!!x.initialization_context})),q=I(!1),K=I(""),L=v(()=>p.value==="create-session"||p.value==="edit-session"),F=v(()=>p.value==="edit-session"||p.value==="edit-template"),C=v(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),A=v(()=>q.value?F.value?"Saving...":"Creating...":F.value?"Save Changes":L.value?"Create Session":"Save Template"),V=v(()=>!(!_.name.trim()||_.system_prompt.length>6e3||_.initialization_context.length>2e3||L.value&&_.name.includes(" "))),H=v(()=>$.value?.working_directory?$.value.working_directory:_.working_directory?_.working_directory:t.projects.get(c.value)?.working_directory||""),T=v(()=>!_.allowed_tools||!_.allowed_tools.trim()?[]:_.allowed_tools.split(",").map(W=>W.trim()).filter(W=>W.length>0));function S(){d.value&&d.value.show()}function N(W,te){_[W]=te,W==="name"&&(x.name=""),W==="system_prompt"&&(x.system_prompt=""),W==="initialization_context"&&(x.initialization_context="")}function M(W){w.value=W,j()}async function k(){try{const W=await oe.get("/api/templates");y.value=W||[]}catch(W){console.error("Failed to load templates:",W),y.value=[]}}function j(){if(!w.value){_.default_role="",_.initialization_context="",_.permission_mode="default",_.allowed_tools="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",l.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const W=y.value.find(te=>te.template_id===w.value);if(W)if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",W.default_role?(_.default_role=W.default_role,l.value.default_role=W.default_role,h.default_role="autofilled"):(_.default_role="",l.value.default_role=null),W.default_system_prompt?(_.initialization_context=W.default_system_prompt,l.value.initialization_context=W.default_system_prompt,h.initialization_context="autofilled"):(_.initialization_context="",l.value.initialization_context=null),W.permission_mode?(_.permission_mode=W.permission_mode,l.value.permission_mode=W.permission_mode,h.permission_mode="autofilled"):(_.permission_mode="default",l.value.permission_mode=null),W.allowed_tools&&W.allowed_tools.length>0){const te=W.allowed_tools.join(", ");_.allowed_tools=te,l.value.allowed_tools=te,h.allowed_tools="autofilled"}else _.allowed_tools="",l.value.allowed_tools=null}function U(){const te=(c.value?t.projects.get(c.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:te,currentPath:_.working_directory||"",onSelect:ne=>{_.working_directory=ne}})}function G(){p.value==="create-session"&&(b.value={mode:"create-session",projectId:c.value,formData:{..._},selectedTemplateId:w.value}),p.value="template-list",J()}function Q(){p.value="create-template",J(),f.value="general"}function ue(W){p.value="edit-template",g.value=W,J(),mt(W),f.value="general"}async function ce(W){if(confirm(`Delete template "${W.name}"?

This action cannot be undone.`))try{await oe.delete(`/api/templates/${W.template_id}`),await k()}catch(te){console.error("Failed to delete template:",te),K.value=te.response?.data?.detail||"Failed to delete template"}}function re(){let W=!0;return x.name="",x.system_prompt="",x.initialization_context="",_.name.trim()||(x.name="Name is required",W=!1),L.value&&_.name.includes(" ")&&(x.name="Session name must be a single word (no spaces)",W=!1),_.system_prompt.length>6e3&&(x.system_prompt="System prompt exceeds 6000 character limit",W=!1),_.initialization_context.length>2e3&&(x.initialization_context="Initialization context exceeds 2000 character limit",W=!1),W}async function fe(){if(!re()){x.name?f.value="general":(x.system_prompt||x.initialization_context)&&(f.value="advanced");return}q.value=!0,K.value="";try{switch(p.value){case"create-session":await z(),r&&r.hide();break;case"edit-session":await P(),r&&r.hide();break;case"create-template":await R();break;case"edit-template":await Y();break}}catch(W){console.error("Submit failed:",W),K.value=W.response?.data?.detail||W.message||"Operation failed. Please try again."}finally{q.value=!1}}async function z(){if(!c.value)throw new Error("Project ID is missing");const W=_.allowed_tools.split(",").map(Pe=>Pe.trim()).filter(Pe=>Pe.length>0),te=_.capabilities.split(",").map(Pe=>Pe.trim()).filter(Pe=>Pe.length>0),ne={name:_.name.trim(),model:_.model||null,role:_.default_role.trim()||null,initialization_context:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,capabilities:te.length>0?te:null,permission_mode:_.permission_mode,allowed_tools:W.length>0?W:null,working_directory:_.working_directory.trim()||null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources},je=await oe.post(`/api/legions/${c.value}/minions`,ne);if(je.success&&je.minion_id)await t.fetchProjects(),await o.fetchSessions(),_.startImmediately&&await o.startSession(je.minion_id),e.push(`/session/${je.minion_id}`);else throw new Error("Failed to create session")}async function P(){if(!$.value)throw new Error("Session data is missing");const W=$.value.session_id,te=$.value.state==="active"||$.value.state==="starting",ne=_.allowed_tools.split(",").map(be=>be.trim()).filter(be=>be.length>0),je=_.capabilities.split(",").map(be=>be.trim()).filter(be=>be.length>0),Pe={name:_.name.trim(),model:_.model,role:_.default_role.trim()||null,system_prompt:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,allowed_tools:ne.length>0?ne:null,capabilities:je.length>0?je:null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources};await o.patchSession(W,Pe),te&&_.permission_mode!==$.value.current_permission_mode&&await o.setPermissionMode(W,_.permission_mode)}async function R(){const W=_.allowed_tools.split(",").map(ne=>ne.trim()).filter(ne=>ne.length>0),te={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:W.length>0?W:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await oe.post("/api/templates",te),await k(),p.value="template-list",J()}async function Y(){if(!g.value)throw new Error("Template data is missing");const W=_.allowed_tools.split(",").map(ne=>ne.trim()).filter(ne=>ne.length>0),te={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:W.length>0?W:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await oe.put(`/api/templates/${g.value.template_id}`,te),await k(),p.value="template-list",g.value=null,J()}function J(){_.name="",_.model="sonnet",_.permission_mode="default",_.working_directory="",_.description="",_.default_role="",_.startImmediately=!0,_.allowed_tools="",_.capabilities="",_.setting_sources=["user","project","local"],_.system_prompt="",_.override_system_prompt=!1,_.initialization_context="",_.sandbox_enabled=!1,x.name="",x.system_prompt="",x.initialization_context="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",l.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},w.value=null,K.value="",f.value="general"}function pe(W){_.name=W.name||"",_.model=W.model||"sonnet",_.permission_mode=W.current_permission_mode||"default",_.working_directory=W.working_directory||"",_.default_role=W.role||"",_.initialization_context=W.system_prompt||"",_.override_system_prompt=W.override_system_prompt||!1,_.system_prompt="",_.allowed_tools=W.allowed_tools?.join(", ")||"",_.capabilities=W.capabilities?.join(", ")||"",_.sandbox_enabled=W.sandbox_enabled||!1,_.setting_sources=W.setting_sources||["user","project","local"]}function mt(W){_.name=W.name||"",_.description=W.description||"",_.permission_mode=W.permission_mode||"default",_.default_role=W.default_role||"",_.initialization_context=W.default_system_prompt||"",_.allowed_tools=W.allowed_tools?.join(", ")||""}function Ie(){ss(()=>{const W=document.getElementById("config-name");W&&(W.focus(),F.value&&W.select())})}function Ge(){J(),p.value="create-session",c.value=null,$.value=null,g.value=null,i.hideModal()}return de(()=>i.currentModal,async(W,te)=>{if(!(!W||!r)){if(W.name==="configuration"){const ne=W.data||{};p.value=ne.mode||"create-session",c.value=ne.project?.project_id||ne.projectId||null,$.value=ne.session||null,g.value=ne.template||null,J(),p.value==="create-session"&&await k(),p.value==="edit-session"&&$.value?pe($.value):p.value==="edit-template"&&g.value&&mt(g.value),r.show()}else if(W.name==="create-minion"||W.name==="create-session"){const ne=W.data||{};p.value="create-session",c.value=ne.project?.project_id||null,$.value=null,g.value=null,J(),await k(),r.show()}else if(W.name==="edit-session"){const ne=W.data||{};p.value="edit-session",$.value=ne.session||null,c.value=$.value?.project_id||null,g.value=null,J(),$.value&&pe($.value),r.show()}else W.name==="template-management"&&(p.value="template-list",J(),await k(),r.show());te?.name==="configuration"&&te.data?.mode?.includes("template")&&W?.name==="configuration"&&p.value==="create-session"&&await k()}}),de(()=>_.default_role,W=>{l.value.default_role!==null&&(h.default_role=W===l.value.default_role?"autofilled":"modified")}),de(()=>_.initialization_context,W=>{l.value.initialization_context!==null&&(h.initialization_context=W===l.value.initialization_context?"autofilled":"modified")}),de(()=>_.permission_mode,W=>{l.value.permission_mode!==null&&(h.permission_mode=W===l.value.permission_mode?"autofilled":"modified")}),de(()=>_.allowed_tools,W=>{l.value.allowed_tools!==null&&(h.allowed_tools=W===l.value.allowed_tools?"autofilled":"modified")}),ge(()=>{a.value&&xe(()=>import("./modal-D6mKceGM.js").then(W=>W.m),__vite__mapDeps([0,1])).then(W=>{const te=W.default;r=new te(a.value),a.value.addEventListener("shown.bs.modal",Ie),a.value.addEventListener("hidden.bs.modal",Ge)})}),Se(()=>{a.value&&(a.value.removeEventListener("shown.bs.modal",Ie),a.value.removeEventListener("hidden.bs.modal",Ge)),r&&r.dispose()}),(W,te)=>(u(),m(ie,null,[n("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[n("div",$$,[n("div",E$,[n("div",S$,[n("h5",C$,[p.value==="create-template"||p.value==="edit-template"?(u(),m("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:G,title:"Back to template list"}," â† ")):O("",!0),Z(" "+E(C.value),1)]),te[3]||(te[3]=n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),n("div",k$,[p.value==="template-list"?(u(),m("div",T$,[n("div",{class:"d-flex justify-content-between align-items-center mb-3"},[te[4]||(te[4]=n("h6",{class:"mb-0"},"Templates",-1)),n("button",{onClick:Q,class:"btn btn-primary btn-sm"}," + Create New ")]),y.value.length===0?(u(),m("div",x$," No templates found. Create your first template! ")):O("",!0),(u(!0),m(ie,null,ae(y.value,ne=>(u(),m("div",{key:ne.template_id,class:"card mb-2"},[n("div",A$,[n("div",M$,[n("div",O$,[n("h6",D$,E(ne.name),1),ne.description?(u(),m("p",N$,E(ne.description),1)):O("",!0),n("div",L$,[n("span",I$,E(ne.permission_mode),1),n("span",j$,E(ne.allowed_tools?.length||0)+" tools",1)])]),n("div",P$,[n("button",{onClick:je=>ue(ne),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,R$),n("button",{onClick:je=>ce(ne),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,W$)])])])]))),128))])):(u(),m("div",H$,[n("ul",V$,[n("li",F$,[n("button",{class:X(["nav-link",{active:f.value==="general","has-error":D.value.general}]),type:"button",onClick:te[0]||(te[0]=ne=>f.value="general")},[te[5]||(te[5]=Z(" General ",-1)),D.value.general?(u(),m("span",B$)):O("",!0)],2)]),n("li",U$,[n("button",{class:X(["nav-link",{active:f.value==="permissions","has-error":D.value.permissions}]),type:"button",onClick:te[1]||(te[1]=ne=>f.value="permissions")},[te[6]||(te[6]=Z(" Permissions ",-1)),D.value.permissions?(u(),m("span",q$)):O("",!0)],2)]),n("li",z$,[n("button",{class:X(["nav-link",{active:f.value==="advanced","has-error":D.value.advanced}]),type:"button",onClick:te[2]||(te[2]=ne=>f.value="advanced")},[te[7]||(te[7]=Z(" Advanced ",-1)),D.value.advanced?(u(),m("span",K$)):O("",!0)],2)])]),n("div",G$,[_e(me(s1,{mode:p.value,"form-data":_,errors:x,templates:y.value,"selected-template-id":w.value,session:$.value,"field-states":h,"onUpdate:formData":N,"onUpdate:selectedTemplateId":M,onOpenFolderBrowser:U,onOpenTemplateManager:G},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[gs,f.value==="general"]]),_e(me(F1,{mode:p.value,"form-data":_,errors:x,session:$.value,"field-states":h,"onUpdate:formData":N,onPreviewPermissions:S},null,8,["mode","form-data","errors","session","field-states"]),[[gs,f.value==="permissions"]]),_e(me(o$,{mode:p.value,"form-data":_,errors:x,session:$.value,"field-states":h,"onUpdate:formData":N},null,8,["mode","form-data","errors","session","field-states"]),[[gs,f.value==="advanced"]])])])),K.value?(u(),m("div",Y$,E(K.value),1)):O("",!0)]),n("div",J$,[n("button",X$,E(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(u(),m("button",{key:0,type:"button",class:"btn btn-primary",disabled:q.value||!V.value,onClick:fe},[q.value?(u(),m("span",Z$)):O("",!0),Z(" "+E(A.value),1)],8,Q$)):O("",!0)])])])],512),me(w$,{ref_key:"permissionPreviewModal",ref:d,"working-directory":H.value,"setting-sources":_.setting_sources,"session-allowed-tools":T.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},tE=se(eE,[["__scopeId","data-v-bb54bc71"]]),sE={class:"modal-dialog modal-dialog-centered"},nE={class:"modal-content"},oE={class:"modal-header"},iE={class:"modal-title",id:"manageSessionModalLabel"},aE={class:"modal-body"},rE={key:0,class:"text-center py-4"},lE={class:"text-muted"},cE={key:1},uE={key:2},dE={class:"text-muted"},mE={key:0,class:"text-center py-2"},pE={key:1,class:"alert alert-warning mt-3"},fE={class:"mb-0 mt-2"},vE={key:0,class:"text-muted"},hE={key:3},_E={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},gE={class:"d-grid gap-2"},bE=["disabled"],yE=["disabled"],wE=["disabled"],$E=["disabled"],EE={class:"modal-footer"},SE={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},CE={__name:"SessionManageModal",setup(s){const e=Pt(),t=le(),o=ve(),i=Ze();Me();const a=I(null),r=I(!1),d=I(""),p=I(""),f=I(null),c=I(null);let $=null;const g=I([]),y=I(!1),w=v(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function b(){f.value="reset"}async function l(){if(f.value="delete",g.value=[],!!a.value){y.value=!0;try{const C=await oe.get(`/api/sessions/${a.value.session_id}/descendants`);g.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),g.value=[]}finally{y.value=!1}}}function h(){f.value=null}async function _(){f.value==="reset"?await q():f.value==="delete"&&await K()}async function x(){if(a.value){r.value=!0,d.value="Restarting session...";try{const C=a.value.session_id,A=t.currentSessionId===C,V=await oe.post(`/api/sessions/${C}/restart`);if(V.success)console.log("Session restarted successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(C)),$&&$.hide();else{const H=V.error||V.detail||"Failed to restart session";console.error("Failed to restart session:",H),p.value=`Failed to restart session: ${H}`}}catch(C){console.error("Error restarting session:",C);const A=C.data?.detail||C.message||"Unknown error";p.value=`Error restarting session: ${A}`}finally{r.value=!1}}}async function D(){if(a.value)try{$&&$.hide(),console.log("Ending session",a.value.session_id);const C=a.value.session_id;await oe.post(`/api/sessions/${C}/terminate`),t.currentSessionId===C&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),t.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function q(){if(a.value){r.value=!0,d.value="Resetting session...";try{const C=a.value.session_id,A=t.currentSessionId===C,V=await oe.post(`/api/sessions/${C}/reset`);if(V.success)console.log("Session reset successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(C)),$&&$.hide();else{const H=V.error||V.detail||"Failed to reset session";console.error("Failed to reset session:",H),p.value=`Failed to reset session: ${H}`,f.value=null}}catch(C){console.error("Error resetting session:",C);const A=C.data?.detail||C.message||"Unknown error";p.value=`Error resetting session: ${A}`,f.value=null}finally{r.value=!1}}}async function K(){if(a.value){r.value=!0,d.value="Deleting session...";try{const C=a.value.session_id;await t.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),$&&$.hide()}catch(C){console.error("Error deleting session:",C);const A=C.data?.detail||C.message||"Unknown error";p.value=`Error deleting session: ${A}`,f.value=null}finally{r.value=!1}}}function L(){f.value=null,r.value=!1,d.value="",p.value="",g.value=[],y.value=!1}function F(){L(),a.value=null,o.hideModal()}return de(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&$){const A=C.data||{};a.value=A.session,L(),$.show()}}),ge(()=>{c.value&&xe(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(A=>A.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{$=new C(c.value),c.value.addEventListener("hidden.bs.modal",F)})}),Se(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",F),$&&$.dispose()}),(C,A)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[n("div",sE,[n("div",nE,[n("div",oE,[n("h5",iE,E(f.value?w.value:"Manage Session"),1),A[1]||(A[1]=n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),n("div",aE,[r.value?(u(),m("div",rE,[A[2]||(A[2]=n("div",{class:"spinner-border text-primary mb-3",role:"status"},[n("span",{class:"visually-hidden"},"Loading...")],-1)),n("p",lE,E(d.value),1)])):f.value==="reset"?(u(),m("div",cE,[...A[3]||(A[3]=[n("div",{class:"alert alert-danger mb-3"},[n("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),n("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),n("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(u(),m("div",uE,[A[9]||(A[9]=n("div",{class:"alert alert-danger mb-3"},[n("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),n("p",dE,[A[4]||(A[4]=Z("This will permanently delete session ",-1)),n("strong",null,E(a.value?.name),1),A[5]||(A[5]=Z(".",-1))]),A[10]||(A[10]=n("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),y.value?(u(),m("div",mE,[...A[6]||(A[6]=[n("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[n("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),n("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(u(),m("div",pE,[A[7]||(A[7]=n("strong",null,"Cascading Deletion:",-1)),A[8]||(A[8]=Z(" This session has ",-1)),n("strong",null,E(g.value.length),1),Z(" child session"+E(g.value.length===1?"":"s")+" that will also be deleted: ",1),n("ul",fE,[(u(!0),m(ie,null,ae(g.value,V=>(u(),m("li",{key:V.session_id,class:"small"},[n("strong",null,E(V.name||V.session_id),1),V.role?(u(),m("span",vE," ("+E(V.role)+")",1)):O("",!0)]))),128))])])):O("",!0)])):(u(),m("div",hE,[p.value?(u(),m("div",_E,[A[11]||(A[11]=n("strong",null,"Error:",-1)),Z(" "+E(p.value)+" ",1),n("button",{type:"button",class:"btn-close",onClick:A[0]||(A[0]=V=>p.value="")})])):O("",!0),A[18]||(A[18]=n("p",{class:"text-muted"},"Choose how to manage this session:",-1)),n("div",gE,[n("button",{class:"btn btn-outline-primary text-start",onClick:x,disabled:r.value},[...A[12]||(A[12]=[n("strong",null,"ðŸ”„ Restart Agent",-1),n("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,bE),n("button",{class:"btn btn-outline-secondary text-start",onClick:D,disabled:r.value},[...A[13]||(A[13]=[n("strong",null,"ðŸšª End Session",-1),n("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,yE),A[16]||(A[16]=n("hr",{class:"my-2"},null,-1)),A[17]||(A[17]=n("div",{class:"danger-zone-header"},[n("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),n("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:r.value},[...A[14]||(A[14]=[n("strong",null,"ðŸ§¹ Reset Session",-1),n("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,wE),n("button",{class:"btn btn-outline-danger text-start",onClick:l,disabled:r.value},[...A[15]||(A[15]=[n("strong",null,"ðŸ—‘ï¸ Delete Session",-1),n("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,$E)]),A[19]||(A[19]=n("div",{class:"alert alert-warning mt-3 mb-0"},[n("small",null,[n("strong",null,"Note:"),Z(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),n("div",EE,[f.value&&!r.value?(u(),m(ie,{key:0},[n("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),n("button",{type:"button",class:X(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:_},E(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?O("",!0):(u(),m("button",SE,"Cancel"))])])])],512))}},kE=se(CE,[["__scopeId","data-v-6b832853"]]),TE={class:"modal-dialog modal-dialog-centered modal-lg"},xE={class:"modal-content"},AE={class:"modal-body"},ME={key:0,class:"text-center text-muted py-4"},OE={key:1},DE={class:"mb-3"},NE={class:"font-monospace small"},LE={class:"mb-3"},IE=["value"],jE={class:"mb-3"},PE={class:"mb-3"},RE={class:"mb-3"},WE={key:0},HE={class:"d-flex flex-wrap gap-1"},VE={key:1,class:"text-muted small"},FE={key:0,class:"mb-3"},BE={class:"d-flex flex-wrap gap-1"},UE={key:1,class:"mb-3"},qE={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},zE={class:"mb-3"},KE={class:"text-muted"},GE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},YE={__name:"SessionInfoModal",setup(s){const e=le(),t=Me(),o=ve(),i=I(null),a=I(!1),r=I(null);let d=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=v(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(t.messagesBySession.get(i.value)||[]).find(_=>_.type==="system"&&(_.subtype==="init"||_.metadata?.subtype==="init")&&_.metadata?.init_data)?.metadata?.init_data||null});function c(b){return b?p[b]||b:"Default (Sonnet 4.5)"}function $(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function g(b){b.target.select()}function y(){i.value=null,a.value=!1}function w(){y(),o.hideModal()}return de(()=>o.currentModal,b=>{if(b?.name==="session-info"&&d){const l=b.data||{};i.value=l.sessionId,a.value=!1,d.show()}}),ge(()=>{r.value&&xe(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(l=>l.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{d=new b(r.value),r.value.addEventListener("hidden.bs.modal",w)})}),Se(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",w),d&&d.dispose()}),(b,l)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[n("div",TE,[n("div",xE,[l[9]||(l[9]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",AE,[f.value?(u(),m("div",OE,[n("div",DE,[l[1]||(l[1]=n("h6",{class:"text-muted"},"Session ID",-1)),n("div",NE,E(i.value),1)]),n("div",LE,[l[2]||(l[2]=n("h6",{class:"text-muted"},"Working Directory",-1)),n("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:g},null,8,IE)]),n("div",jE,[l[3]||(l[3]=n("h6",{class:"text-muted"},"Model",-1)),n("div",null,E(c(f.value.model)),1)]),n("div",PE,[l[4]||(l[4]=n("h6",{class:"text-muted"},"Permission Mode",-1)),n("div",null,E(f.value.permissionMode||"default"),1)]),n("div",RE,[l[5]||(l[5]=n("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(u(),m("div",WE,[n("div",HE,[(u(!0),m(ie,null,ae(f.value.allowed_tools||f.value.tools,h=>(u(),m("span",{key:h,class:"badge bg-secondary"},E(h),1))),128))])])):(u(),m("div",VE,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(u(),m("div",FE,[l[6]||(l[6]=n("h6",{class:"text-muted"},"Commands",-1)),n("div",BE,[(u(!0),m(ie,null,ae(f.value.commands,h=>(u(),m("span",{key:h,class:"badge bg-info"},E(h),1))),128))])])):O("",!0),f.value.systemPrompt?(u(),m("div",UE,[l[7]||(l[7]=n("h6",{class:"text-muted"},"System Prompt",-1)),n("pre",qE,E($(f.value.systemPrompt)),1)])):O("",!0),n("div",zE,[n("h6",KE,[l[8]||(l[8]=Z(" Raw Configuration ",-1)),n("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:l[0]||(l[0]=h=>a.value=!a.value)},E(a.value?"Hide":"Show"),1)]),a.value?(u(),m("pre",GE,E(JSON.stringify(f.value,null,2)),1)):O("",!0)])])):(u(),m("div",ME," No session configuration data available "))]),l[10]||(l[10]=n("div",{class:"modal-footer"},[n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},JE=se(YE,[["__scopeId","data-v-b28b39b3"]]),XE={class:"modal-dialog modal-dialog-centered modal-lg"},QE={class:"modal-content"},ZE={class:"modal-body"},eS={key:0,class:"text-center text-muted py-4"},tS={key:1},sS={class:"mb-3"},nS={class:"mb-3"},oS={class:"font-monospace small"},iS={class:"mb-3"},aS={class:"mb-3"},rS={class:"mb-3"},lS={key:0},cS={class:"d-flex flex-wrap gap-1"},uS={key:1,class:"text-muted small"},dS={class:"mb-3"},mS={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},pS={key:1,class:"text-muted small"},fS={class:"mb-3"},vS={key:0,class:"badge bg-info"},hS={key:1,class:"badge bg-secondary"},_S={class:"mb-3"},gS={key:0,class:"font-monospace small"},bS={key:1,class:"text-muted small"},yS={key:0,class:"mb-3"},wS={key:0},$S={class:"list-unstyled mb-0"},ES={key:1,class:"text-muted small"},SS={class:"mb-3"},CS={class:"small"},kS={class:"mb-3"},TS={class:"small"},xS={__name:"MinionViewModal",setup(s){const e=ve(),t=I(null),o=I(null);let i=null;function a(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function r(f){if(!f)return"N/A";try{const c=new Date(f);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function d(){t.value=null}function p(){d(),e.hideModal()}return de(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const c=f.data||{};t.value=c.session,i.show()}}),ge(()=>{o.value&&xe(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(c=>c.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),Se(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(f,c)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[n("div",XE,[n("div",QE,[c[11]||(c[11]=n("div",{class:"modal-header"},[n("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",ZE,[t.value?(u(),m("div",tS,[n("div",sS,[c[0]||(c[0]=n("h6",{class:"text-muted"},"Name",-1)),n("div",null,E(t.value.name||"Unnamed Minion"),1)]),n("div",nS,[c[1]||(c[1]=n("h6",{class:"text-muted"},"Session ID",-1)),n("div",oS,E(t.value.session_id),1)]),n("div",iS,[c[2]||(c[2]=n("h6",{class:"text-muted"},"Role",-1)),n("div",null,E(t.value.role||"Not specified"),1)]),n("div",aS,[c[3]||(c[3]=n("h6",{class:"text-muted"},"Current State",-1)),n("div",null,[n("span",{class:X(["badge",a(t.value.state)])},E(t.value.state),3)])]),n("div",rS,[c[4]||(c[4]=n("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(u(),m("div",lS,[n("div",cS,[(u(!0),m(ie,null,ae(t.value.capabilities,$=>(u(),m("span",{key:$,class:"badge bg-secondary"},E($),1))),128))])])):(u(),m("div",uS,"None"))]),n("div",dS,[c[5]||(c[5]=n("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(u(),m("div",mS,E(t.value.initialization_context),1)):(u(),m("div",pS,"Not specified"))]),n("div",fS,[c[6]||(c[6]=n("h6",{class:"text-muted"},"Overseer",-1)),n("div",null,[t.value.is_overseer?(u(),m("span",vS,"Yes")):(u(),m("span",hS,"No"))])]),n("div",_S,[c[7]||(c[7]=n("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(u(),m("div",gS,E(t.value.parent_overseer_id),1)):(u(),m("div",bS," Root overseer (user-created) "))]),t.value.is_overseer?(u(),m("div",yS,[c[8]||(c[8]=n("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(u(),m("div",wS,[n("ul",$S,[(u(!0),m(ie,null,ae(t.value.child_minion_ids,$=>(u(),m("li",{key:$,class:"font-monospace small"},E($),1))),128))])])):(u(),m("div",ES,"No children"))])):O("",!0),n("div",SS,[c[9]||(c[9]=n("h6",{class:"text-muted"},"Created",-1)),n("div",CS,E(r(t.value.created_at)),1)]),n("div",kS,[c[10]||(c[10]=n("h6",{class:"text-muted"},"Last Active",-1)),n("div",TS,E(r(t.value.updated_at)),1)])])):(u(),m("div",eS," No minion data available "))]),c[12]||(c[12]=n("div",{class:"modal-footer"},[n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},AS=se(xS,[["__scopeId","data-v-d996dc6f"]]),MS={class:"container-fluid vh-100 d-flex flex-column p-0"},OS={class:"d-flex flex-grow-1 overflow-hidden position-relative"},DS={class:"flex-grow-1 d-flex flex-column overflow-hidden"},NS={__name:"App",setup(s){const e=ve(),t=Ze(),o=le(),i=Ne(),a=Pt(),r=v(()=>e.sidebarCollapsed),d=v(()=>e.isMobile);ge(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&await o.selectSession($)}else if(c.startsWith("#/timeline/")){const $=c.replace("#/timeline/","");a.push(`/timeline/${$}`)}window.addEventListener("popstate",p),window.addEventListener("resize",e.handleResize)}),Se(()=>{window.removeEventListener("popstate",p),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function p(){const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&o.selectSession($)}}function f(){e.toggleSidebar()}return(c,$)=>{const g=io("router-view");return u(),m("div",MS,[me(jb),n("div",{id:"sidebar-backdrop",class:X({show:!r.value&&d.value}),onClick:f},null,2),n("div",OS,[me(my),n("main",DS,[me(g)])]),me(Ay),me(qy),me(pw),me(tE),me(kE),me(JE),me(AS)])}}},rn=_i(NS);rn.use(gi());rn.use(Tb);rn.mount("#app");
