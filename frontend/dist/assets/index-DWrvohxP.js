const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as a,d as Ze,r as R,b as _,t as b,n as ee,u as le,e as Ge,f as ae,w as _e,g as ws,F as ce,h as de,i as A,j as we,v as Be,k as $e,l as ho,m as be,p as _o,q as fe,s as st,x as Ke,y as ke,z as Mi,A as go,B as Se,C as yn,D as bo,E as Vt,G as Di,H as Oi,I as Js,T as Li,J as yo,K as wo,L as St,M as $s,N as wn,O as Ni,P as Ii}from"./vue-vendor-urrUqSeI.js";import{m as Qe,p as Ut}from"./markdown-vendor-BRsjnVvP.js";import{c as ji}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();const Ri={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Pi={__name:"NoSessionSelected",setup(n){return(e,s)=>(a(),r("div",Ri,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Fi="modulepreload",Wi=function(n){return"/"+n},$n={},Me=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let p=function(f){return Promise.all(f.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=c?.nonce||c?.getAttribute("nonce");i=p(s.map(f=>{if(f=Wi(f),f in $n)return;$n[f]=!0;const u=f.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${w}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":Fi,u||(g.as="script"),g.crossOrigin="",g.href=f,d&&g.setAttribute("nonce",d),document.head.appendChild(g),u)return new Promise(($,k)=>{g.addEventListener("load",$),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return i.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})};class ks extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Et(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new ks(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof ks?s:(console.error("API request failed:",s),new ks(`Network error: ${s.message}`,0,null))}}async function Ht(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[d,p]of Object.entries(e.params))p!=null&&o.append(d,p);const i=o.toString();i&&(s=`${n}?${i}`);const{params:l,...c}=e;return Et(s,{...c,method:"GET"})}return Et(s,{...e,method:"GET"})}async function $o(n,e,s={}){return Et(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Bi(n,e,s={}){return Et(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function ko(n,e={}){return Et(n,{...e,method:"DELETE"})}async function Hi(n,e,s={}){return Et(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Vi(){return Ht("/api/system/git-status")}async function Ui(){return $o("/api/system/restart")}const ge={get:Ht,post:$o,put:Bi,delete:ko,patch:Hi},ve=Ze("session",()=>{const n=R(new Map),e=R(null),s=R(new Map),o=R(new Map),i=R(new Set),l=R(!1);let c=null;const d=_(()=>n.value.get(e.value)),p=_(()=>Array.from(n.value.values()).sort((E,B)=>E.order-B.order)),f=E=>_(()=>p.value.filter(B=>B.project_id===E)),u=_({get:()=>s.value.get(e.value)||"",set:E=>{e.value&&s.value.set(e.value,E)}});async function w(){try{const E=await ge.get("/api/sessions");return n.value.clear(),E.sessions.forEach(B=>{n.value.set(B.session_id,B)}),console.log(`Loaded ${n.value.size} sessions`),E.sessions}catch(E){throw console.error("Failed to fetch sessions:",E),E}}async function g(E,B){try{const x=(await ge.post("/api/sessions",{project_id:E,...B})).session_id,V=(await ge.get(`/api/sessions/${x}`)).session;return n.value.set(x,V),n.value=new Map(n.value),console.log(`Created session ${x}`),V}catch(T){throw console.error("Failed to create session:",T),T}}async function $(E){if(e.value===E&&!l.value)return;c&&(console.log(`Aborting pending selection to switch to ${E}`),c.abort(),c=null);const B=new AbortController;c=B,l.value=!0;try{if(e.value=E,B.signal.aborted){console.log(`Selection of ${E} aborted early`);return}let T=n.value.get(E);if(!T)try{const N=await ge.get(`/api/sessions/${E}`);if(B.signal.aborted){console.log(`Selection of ${E} aborted after fetch`);return}T=N.session,n.value.set(E,T),n.value=new Map(n.value),console.log(`Fetched session ${E} for deeplink`)}catch(N){console.error(`Failed to fetch session ${E}:`,N);return}if(T&&(T.state==="created"||T.state==="terminated"))try{if(await v(E),B.signal.aborted){console.log(`Selection of ${E} aborted after start`);return}console.log(`Auto-started session ${E} (was in ${T.state} state)`);const N=6e4,H=200,K=5e3;let Y=0,I=0;for(;Y<N;){if(B.signal.aborted){console.log(`Selection of ${E} aborted during state wait`);return}const G=n.value.get(E);if(G&&G.state==="active"){console.log(`Session ${E} is now active after ${Y}ms`);break}if(Y-I>=K){const te=n.value.get(E)?.state||"unknown";console.log(`Waiting for session ${E} to become active (current: ${te}, ${Y/1e3}s elapsed)`),I=Y}await new Promise(te=>setTimeout(te,H)),Y+=H}const P=n.value.get(E);P&&P.state!=="active"&&console.warn(`Session ${E} did not become active within ${N/1e3}s (state: ${P.state}), continuing anyway`)}catch(N){console.error(`Failed to auto-start session ${E}:`,N)}if(B.signal.aborted){console.log(`Selection of ${E} aborted before message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>la),void 0)).useMessageStore().loadMessages(E),B.signal.aborted){console.log(`Selection of ${E} aborted after message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>Ma),void 0)).useResourceStore().loadResources(E),B.signal.aborted){console.log(`Selection of ${E} aborted after resource load`);return}await(await Me(()=>Promise.resolve().then(()=>Da),void 0)).useWebSocketStore().connectSession(E),B.signal.aborted||console.log(`Selected session ${E}`)}finally{c===B&&(c=null),l.value=!1}}function k(E,B){const T=n.value.get(E);T?Object.assign(T,B):(n.value.set(E,B),console.log(`Added new session ${E} via WebSocket update`)),n.value=new Map(n.value)}async function y(E){i.value.add(E);try{const T=(await ge.delete(`/api/sessions/${E}`)).deleted_session_ids||[E];for(const x of T)n.value.delete(x),s.value.delete(x),o.value.delete(x);return n.value=new Map(n.value),T.includes(e.value)&&(e.value=null),console.log(`Deleted ${T.length} session(s): ${T.join(", ")}`),T}catch(B){throw console.error("Failed to delete session:",B),B}finally{i.value.delete(E)}}async function m(E,B){try{await ge.patch(`/api/sessions/${E}`,B),k(E,B),console.log(`Updated session ${E}:`,B)}catch(T){throw console.error("Failed to update session:",T),T}}async function h(E,B){try{await ge.post(`/api/sessions/${E}/permission-mode`,{mode:B}),k(E,{current_permission_mode:B});const T=o.value.get(E);T&&(T.permissionMode=B,o.value.set(E,T)),console.log(`Set permission mode for session ${E} to ${B}`)}catch(T){throw console.error("Failed to set permission mode:",T),T}}async function v(E){try{await ge.post(`/api/sessions/${E}/start`),console.log(`Started session ${E}`)}catch(B){throw console.error("Failed to start session:",B),B}}async function S(E){try{await ge.post(`/api/sessions/${E}/pause`),console.log(`Paused session ${E}`)}catch(B){throw console.error("Failed to pause session:",B),B}}async function C(E){try{await ge.post(`/api/sessions/${E}/terminate`),console.log(`Terminated session ${E}`)}catch(B){throw console.error("Failed to terminate session:",B),B}}function j(E){return n.value.get(E)}function F(E,B){o.value.set(E,B),B.permissionMode&&k(E,{current_permission_mode:B.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:d,orderedSessions:p,sessionsInProject:f,currentInput:u,fetchSessions:w,createSession:g,selectSession:$,updateSession:k,deleteSession:y,patchSession:m,setPermissionMode:h,startSession:v,pauseSession:S,terminateSession:C,getSession:j,storeInitData:F}}),kn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ve},Symbol.toStringTag,{value:"Module"})),ye=Ze("ui",()=>{const n=R(window.innerWidth<768),e=R(300),s=R(!0),o=R(300),i=R("tasks"),l=R(window.innerWidth),c=_(()=>l.value<768),d=R(!0),p=R(!1),f=R(null),u=R(null),w=_(()=>f.value?{name:f.value,data:u.value}:null),g=R(!1),$=R("Loading..."),k=R(!1),y=R("idle");function m(){n.value=!n.value}function h(Y){n.value=Y}function v(Y){e.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function S(){s.value=!s.value}function C(Y){s.value=Y}function j(Y){o.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function F(Y){i.value=Y}function E(Y){d.value=Y}function B(){const Y=localStorage.getItem("webui-background-color");p.value=Y==="red"}function T(){p.value=!p.value,localStorage.setItem("webui-background-color",p.value?"red":"gray")}function x(Y,I=null){f.value=null,u.value=null,setTimeout(()=>{f.value=Y,u.value=I},0)}function z(){f.value=null,u.value=null}function V(Y="Loading..."){g.value=!0,$.value=Y}function N(){g.value=!1}function H(){x("restart-server")}function K(){const Y=l.value;l.value=window.innerWidth,l.value<768&&Y>=768?n.value=!0:l.value>=768&&Y<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:i,isMobile:c,autoScrollEnabled:d,isRedBackground:p,activeModal:f,modalData:u,currentModal:w,isLoading:g,loadingMessage:$,restartInProgress:k,restartStatus:y,toggleSidebar:m,setSidebarCollapsed:h,setSidebarWidth:v,toggleRightSidebar:S,setRightSidebarCollapsed:C,setRightSidebarWidth:j,setRightSidebarTab:F,setAutoScroll:E,initBackgroundColor:B,toggleBackgroundColor:T,showModal:x,hideModal:z,showLoading:V,hideLoading:N,showRestartModal:H,handleResize:K}}),Fe=Ze("project",()=>{const n=R(new Map),e=R(null),s=_(()=>n.value.get(e.value)),o=_(()=>Array.from(n.value.values()).sort((m,h)=>m.order-h.order));async function i(){try{const m=await ge.get("/api/projects");return n.value.clear(),m.projects.forEach(h=>{n.value.set(h.project_id,h)}),console.log(`Loaded ${n.value.size} projects`),m.projects}catch(m){throw console.error("Failed to fetch projects:",m),m}}async function l(m,h){try{const S=(await ge.post("/api/projects",{name:m,working_directory:h})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(v){throw console.error("Failed to create project:",v),v}}async function c(m,h){try{await ge.put(`/api/projects/${m}`,h),d(m,h),console.log(`Updated project ${m}`,h)}catch(v){throw console.error("Failed to update project:",v),v}}function d(m,h){const v=n.value.get(m);v&&(Object.assign(v,h),n.value=new Map(n.value))}async function p(m){try{await ge.delete(`/api/projects/${m}`),n.value.delete(m),n.value=new Map(n.value),e.value===m&&(e.value=null),console.log(`Deleted project ${m}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function f(m){try{const h=await ge.put(`/api/projects/${m}/toggle-expansion`),v=n.value.get(m);return v&&(v.is_expanded=h.is_expanded,n.value=new Map(n.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function u(m){try{await ge.put("/api/projects/reorder",{project_ids:m}),m.forEach((h,v)=>{const S=n.value.get(h);S&&(S.order=v)}),n.value=new Map(n.value),console.log("Reordered projects",m)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function w(m,h){try{await ge.put(`/api/projects/${m}/sessions/reorder`,{session_ids:h});const v=n.value.get(m);v&&(v.session_ids=h,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${m}`,h)}catch(v){throw console.error("Failed to reorder sessions:",v),v}}function g(m){return n.value.get(m)}function $(m){e.value=m}function k(){e.value=null}function y(m){if(!m)return"";const h=m.split(/[/\\]/).filter(v=>v);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:i,createProject:l,updateProject:c,updateProjectLocal:d,deleteProject:p,toggleExpansion:f,reorderProjects:u,reorderSessionsInProject:w,getProject:g,selectProject:$,clearProjectSelection:k,formatPath:y}}),oe=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},qi={class:"project-name"},zi=["title"],Ki={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=Fe(),i=ye(),l=_(()=>s.sessions.get(e.sessionId)),c=_(()=>l.value?.name||e.sessionId),d=_(()=>{for(const f of o.projects.values())if(f.session_ids?.includes(e.sessionId))return f;return null}),p=_(()=>d.value?.name||"Unknown Project");return(f,u)=>(a(),r("div",{class:ee(["session-header border-bottom p-3",{"theme-red-panel":le(i).isRedBackground}])},[t("div",qi,b(p.value),1),t("div",{class:"session-name",title:n.sessionId},b(c.value),9,zi)],2))}},Gi=oe(Ki,[["__scopeId","data-v-ba771dd8"]]),Yi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ji=["title"],Qi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Xi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=_(()=>s.sessions.get(e.sessionId)),i=_(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),l=_(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),c=_(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),d=_(()=>{if(!o.value)return"No session selected";const p=i.value,f=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${u}${w}: ${f}`});return(p,f)=>(a(),r("div",Yi,[o.value?(a(),r("div",{key:0,class:ee(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:Ge({width:"100%",backgroundColor:l.value}),title:d.value},null,14,Ji)):(a(),r("div",Qi))]))}},Zi=oe(Xi,[["__scopeId","data-v-63d222fe"]]),ea={class:"d-flex justify-content-between align-items-center gap-2"},ta={class:"d-flex gap-2"},sa=["disabled"],na={class:"mode-label"},oa=["disabled"],ia=["disabled"],aa={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=ye(),i=_(()=>s.sessions.get(e.sessionId)),l=_(()=>i.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},d=_(()=>c[l.value]||"ðŸ”’"),p=_(()=>l.value),f=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(l.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const y=(f.indexOf(l.value)+1)%f.length,m=f[y];try{await s.setPermissionMode(e.sessionId,m)}catch(h){console.error("Failed to cycle permission mode:",h)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},$=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(k,y)=>(a(),r("div",{class:ee(["session-status-bar border-top p-2",le(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ea,[t("div",ta,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[ae(b(d.value)+" ",1),t("span",na,b(p.value),1)],8,sa),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!i.value},[...y[0]||(y[0]=[ae(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,oa),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...y[1]||(y[1]=[ae(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,ia)]),t("div",null,[t("button",{class:ee(["btn btn-sm",le(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:$}," â¬‡ï¸ "+b(le(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},ra=oe(aa,[["__scopeId","data-v-ed9a4d3c"]]),Ct=Ze("task",()=>{const n=R(new Map),e=R(new Set);function s(v){const S=n.value.get(v);return S?Array.from(S.values()).sort((C,j)=>{const F=parseInt(C.id.replace(/\D/g,""))||0,E=parseInt(j.id.replace(/\D/g,""))||0;return F-E}):[]}function o(v){return s(v).find(C=>C.status==="in_progress")||null}function i(v){const S=s(v);return{total:S.length,completed:S.filter(C=>C.status==="completed").length,inProgress:S.filter(C=>C.status==="in_progress").length,pending:S.filter(C=>C.status==="pending").length}}function l(v){return e.value.has(v)}const c=_(()=>{const v=ve();return s(v.currentSessionId)}),d=_(()=>{const v=ve();return o(v.currentSessionId)}),p=_(()=>{const v=ve();return i(v.currentSessionId)}),f=_(()=>{const v=ve();return l(v.currentSessionId)});function u(v,S){n.value.has(v)||n.value.set(v,new Map),n.value.get(v).set(S.id,{id:S.id,subject:S.subject||"",description:S.description||"",status:S.status||"pending",activeForm:S.activeForm||null,owner:S.owner||null,blocks:S.blocks||[],blockedBy:S.blockedBy||[],metadata:S.metadata||{}}),e.value.add(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${S.id} for session ${v}`)}function w(v,S,C){const j=n.value.get(v);if(!j){console.warn(`No tasks found for session ${v}`);return}const F=j.get(S);if(!F){u(v,{id:S,...C});return}C.subject!==void 0&&(F.subject=C.subject),C.description!==void 0&&(F.description=C.description),C.status!==void 0&&(F.status=C.status),C.activeForm!==void 0&&(F.activeForm=C.activeForm),C.owner!==void 0&&(F.owner=C.owner),C.metadata!==void 0&&(F.metadata={...F.metadata,...C.metadata}),C.addBlocks&&(F.blocks=[...new Set([...F.blocks,...C.addBlocks])]),C.addBlockedBy&&(F.blockedBy=[...new Set([...F.blockedBy,...C.addBlockedBy])]),C.status==="deleted"&&(j.delete(S),j.size===0&&(e.value.delete(v),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${S} for session ${v}`,C)}function g(v,S){return n.value.get(v)?.get(S)||null}function $(v){n.value.delete(v),e.value.delete(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${v}`)}function k(v,S){n.value.has(v)&&n.value.get(v).clear(),e.value.delete(v);const C=new Map;for(const j of S){if(j.metadata?.tool_uses)for(const F of j.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(F.name)&&C.set(F.id,{name:F.name,input:F.input});if(j.metadata?.tool_results)for(const F of j.metadata.tool_results){const E=C.get(F.tool_use_id);E&&(y(v,E.name,E.input,{error:F.is_error,content:F.content}),C.delete(F.tool_use_id))}}console.log(`Reconstructed ${n.value.get(v)?.size||0} tasks for session ${v}`)}function y(v,S,C,j){if(j?.error){console.log(`Skipping task update - tool ${S} returned error`);return}const F=m(j);if(F)switch(S){case"TaskCreate":{const E=h(F)||C?.id;E&&u(v,{id:E,subject:C?.subject||"",description:C?.description||"",status:"pending",activeForm:C?.activeForm||null,owner:C?.owner||null,blocks:[],blockedBy:[],metadata:C?.metadata||{}});break}case"TaskUpdate":{const E=C?.taskId;E&&w(v,E,{status:C?.status,subject:C?.subject,description:C?.description,activeForm:C?.activeForm,owner:C?.owner,metadata:C?.metadata,addBlocks:C?.addBlocks,addBlockedBy:C?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{C?.taskId;break}}}function m(v){return v?typeof v=="string"?v:v.content?typeof v.content=="string"?v.content:JSON.stringify(v.content):v.message?v.message:JSON.stringify(v):null}function h(v){if(!v)return null;const S=v.match(/[Tt]ask\s*#(\d+)/i);if(S)return S[1];const C=v.match(/#(\d+)/);return C?C[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:d,currentTaskStats:p,currentHasTasks:f,tasksForSession:s,activeTask:o,taskStats:i,hasTasks:l,getTask:g,createTask:u,updateTask:w,clearTasks:$,reconstructFromMessages:k,handleTaskToolResult:y}}),Oe=Ze("message",()=>{const n=R(new Map),e=R(new Map),s=R(new Map),o=R(new Map),i=R(new Map),l=R(new Map),c=R(new Map),d=R(new Map),p=_(()=>{const I=ve();return n.value.get(I.currentSessionId)||[]}),f=_(()=>{const I=ve();return e.value.get(I.currentSessionId)||[]});async function u(I,P=null,G=0){try{const te=P||1e4,ne=await ge.get(`/api/sessions/${I}/messages?limit=${te}&offset=${G}`),se=ne.messages||[],he=ne.total_count||se.length,re=ne.has_more||!1;if(console.log(`Loaded ${se.length} of ${he} messages for session ${I}`),n.value.set(I,se),se.length>0){const O=se[se.length-1];O.timestamp&&(c.value.set(I,O.timestamp),console.log(`Tracked last received timestamp for session ${I}: ${O.timestamp}`))}const q=new Set;se.forEach(O=>{O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(L=>{q.add(L.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(L=>{q.delete(L.tool_use_id);const U=l.value.get(I);U&&U.delete(L.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(q.forEach(L=>{T(I,L,"Session was restarted")}),q.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(q.forEach(L=>{T(I,L,"Session was interrupted")}),q.clear()),O.metadata?.has_tool_uses&&O.metadata.tool_uses&&O.metadata.tool_uses.forEach(L=>{y(I,L,O.timestamp)}),O.metadata?.has_tool_results&&O.metadata.tool_results&&O.metadata.tool_results.forEach(L=>{S(I,L)}),(O.type==="permission_request"||O.metadata?.has_permission_requests)&&m(I,O),O.type==="permission_response"&&h(I,{request_id:O.metadata?.request_id,decision:O.metadata?.decision,updated_input:O.metadata?.updated_input,reasoning:O.metadata?.reasoning,applied_updates:O.metadata?.applied_updates}),O.type==="system"&&(O.subtype==="init"||O.metadata?.subtype==="init")&&O.metadata?.init_data&&ve().storeInitData(I,O.metadata.init_data)});const M=ve().sessions.get(I);M&&!["active","paused","starting"].includes(M.state)&&(q.forEach(O=>{T(I,O,"Session was terminated")}),q.clear()),i.value.set(I,q),n.value=new Map(n.value);try{Ct().reconstructFromMessages(I,se)}catch(O){console.warn("Failed to reconstruct task state:",O)}return re&&console.warn(`Warning: Only loaded ${se.length} of ${he} messages. Some messages may be missing.`),{messages:se,totalCount:he,hasMore:re}}catch(te){throw console.error("Failed to load messages:",te),te}}function w(I,P){const G=i.value.get(I)||new Set;P.type==="assistant"&&P.metadata?.tool_uses&&P.metadata.tool_uses.forEach(te=>{G.add(te.id)}),P.type==="user"&&P.metadata?.tool_results&&P.metadata.tool_results.forEach(te=>{G.delete(te.tool_use_id);const ne=l.value.get(I);ne&&ne.delete(te.tool_use_id)}),P.type==="system"&&P.metadata?.subtype==="client_launched"&&(G.forEach(te=>{T(I,te,"Session was restarted")}),G.clear()),P.type==="system"&&P.metadata?.subtype==="interrupt"&&(G.forEach(te=>{T(I,te,"Session was interrupted")}),G.clear()),i.value.set(I,G)}function g(I,P){n.value.has(I)||n.value.set(I,[]);const G=n.value.get(I);if(P.id){const te=G.findIndex(ne=>ne.id===P.id);if(te!==-1){console.log(`Skipping duplicate message ${P.id} (already exists at index ${te})`);return}}G.push(P),P.timestamp&&c.value.set(I,P.timestamp),F(I,P),w(I,P),n.value=new Map(n.value)}function $(I,P){e.value.has(I)||e.value.set(I,[]),e.value.get(I).push(P),e.value=new Map(e.value)}function k(I,P,G){const te=e.value.get(I);if(te){const ne=te.find(se=>se.id===P);ne&&(Object.assign(ne,G),e.value=new Map(e.value))}}function y(I,P,G=null){const te=j(P.name,P.input);s.value.set(te,P.id);const ne={id:P.id,name:P.name,input:P.input,signature:te,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:G||new Date().toISOString(),isExpanded:!0};return $(I,ne),console.log(`Created tool call ${ne.id} for ${ne.name}`),ne}function m(I,P){console.log("handlePermissionRequest received:",P);const G=P.metadata?.tool_name||P.tool_name,te=P.metadata?.input_params||P.input_params,ne=P.metadata?.request_id||P.request_id,se=P.metadata?.suggestions||P.suggestions||[];console.log("Extracted data:",{toolName:G,inputParams:te,requestId:ne,suggestions:se});const he=j(G,te),re=s.value.get(he);re?(o.value.set(ne,re),k(I,re,{status:"permission_required",permissionRequestId:ne,suggestions:se}),console.log(`Permission required for tool ${re}`,{suggestions:se})):console.warn("No tool use ID found for permission request signature:",he,{toolName:G,inputParams:te,availableSignatures:Array.from(s.value.keys())})}function h(I,P){const G=o.value.get(P.request_id);if(G){const te={permissionDecision:P.decision,appliedUpdates:P.applied_updates||[]};P.decision==="allow"?(te.status="executing",te.backendStatus="running"):(te.status="completed",te.backendStatus="denied",te.result={error:!0,message:P.reasoning||"Permission denied"},te.isExpanded=!1),P.updated_input&&(te.input=P.updated_input),k(I,G,te),console.log(`Permission ${P.decision} for tool ${G}`)}}function v(I,P){console.log("handleToolCall received:",P);const G=P.tool_use_id;if(!G){console.warn("Received tool_call without tool_use_id:",P);return}e.value.has(I)||e.value.set(I,[]);const te=e.value.get(I),ne=te.findIndex(re=>re.id===G),he={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[P.status]||P.status;if(ne!==-1){const re=te[ne];re.status=he,re.backendStatus=P.status,P.permission&&(re.suggestions=P.permission.suggestions||[],re.permissionRequestId=P.request_id),P.permission_granted!==null&&P.permission_granted!==void 0&&(re.permissionDecision=P.permission_granted?"allow":"deny"),P.result!==void 0&&(re.result={error:P.status==="failed",content:P.result}),P.error&&(re.result={error:!0,content:P.error}),P.status==="denied"&&(re.result={error:!0,message:"Permission denied"},re.isExpanded=!1),P.status==="interrupted"&&(T(I,G,"Session was interrupted"),re.isExpanded=!1),(P.status==="completed"||P.status==="failed")&&(re.isExpanded=!1),P.display&&(re.backendState=P.display),console.log(`Updated tool call ${G} to status: ${he} (backend: ${P.status})`)}else{const re=j(P.name,P.input);s.value.set(re,G);const q={id:G,name:P.name,input:P.input,signature:re,status:he,backendStatus:P.status,permissionRequestId:P.request_id,permissionDecision:P.permission_granted!==void 0?P.permission_granted?"allow":"deny":null,suggestions:P.permission?.suggestions||[],result:P.result?{error:P.status==="failed",content:P.result}:null,explanation:null,timestamp:P.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(P.status),backendState:P.display};P.error&&(q.result={error:!0,content:P.error}),te.push(q),console.log(`Created new tool call ${G} for ${P.name} with status: ${he}`)}if(e.value=new Map(e.value),["completed","failed"].includes(P.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(P.name))try{Ct().handleTaskToolResult(I,P.name,P.input,{error:P.status==="failed",content:P.result})}catch(re){console.warn("Failed to update task store:",re)}}function S(I,P){const G=P.tool_use_id;k(I,G,{status:P.is_error?"error":"completed",result:{error:P.is_error,content:P.content},isExpanded:!1}),console.log(`Tool ${G} ${P.is_error?"failed":"completed"}`);const te=e.value.get(I);if(te){const ne=te.find(se=>se.id===G);if(ne&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(ne.name))try{Ct().handleTaskToolResult(I,ne.name,ne.input,{error:P.is_error,content:P.content})}catch(se){console.warn("Failed to update task store:",se)}}}function C(I,P){const G=e.value.get(I);if(G){const te=G.find(ne=>ne.id===P);te&&(te.isExpanded=!te.isExpanded,e.value=new Map(e.value))}}function j(I,P){if(!I)return"unknown:{}";if(!P||typeof P!="object")return`${I}:{}`;const G=JSON.stringify(P,Object.keys(P).sort());return`${I}:${G}`}function F(I,P){const G=P.metadata?.display||P.display;if(!G)return;d.value.has(I)||d.value.set(I,new Map);const te=d.value.get(I);if(G.tool_states)for(const[ne,se]of Object.entries(G.tool_states)){te.set(ne,se);const he=e.value.get(I);if(he){const re=he.find(q=>q.id===ne);if(re){const q={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};re.status=q[se.state]||se.state,re.backendState=se}}}if(G.orphaned_tools&&G.orphaned_tools.length>0){const ne=l.value.get(I)||new Map;for(const se of G.orphaned_tools)ne.has(se)||ne.set(se,{reason:"denied",message:"Session was interrupted"});l.value.set(I,ne)}if(G.linked_permissions)for(const[ne,se]of Object.entries(G.linked_permissions))o.value.set(ne,se);G.tool_states&&Object.keys(G.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${I}:`,{toolStates:Object.keys(G.tool_states||{}).length,orphanedTools:(G.orphaned_tools||[]).length,linkedPermissions:Object.keys(G.linked_permissions||{}).length})}function E(I,P){return d.value.get(I)?.get(P)}function B(I){const P=d.value.get(I);return P&&P.size>0}function T(I,P,G){const te=l.value.get(I)||new Map;te.set(P,{reason:"denied",message:G}),l.value.set(I,te);const ne=e.value.get(I);if(ne){const se=ne.find(he=>he.id===P);se&&se.isExpanded&&(se.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${P} as orphaned: ${G}`)}function x(I,P){const G=E(I,P);return G&&G.state==="orphaned"?!0:l.value.get(I)?.has(P)||!1}function z(I,P){const G=E(I,P);return G&&G.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:G}:l.value.get(I)?.get(P)}function V(I,P){const G=i.value.get(I);G&&G.size>0&&(G.forEach(te=>T(I,te,P)),G.clear())}function N(I){n.value.delete(I),e.value.delete(I),n.value=new Map(n.value),e.value=new Map(e.value)}function H(I){return c.value.get(I)}async function K(I){const P=c.value.get(I);if(!P)return console.log(`No sync needed for session ${I} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${I} since ${P}`);const G=await ge.get(`/api/sessions/${I}/messages?limit=1000&offset=0`),te=G.messages||[],ne=G.has_more||!1,se=L=>L?typeof L=="number"?L*1e3:new Date(L).getTime():0,he=se(P),re=te.filter(L=>L.timestamp?se(L.timestamp)>he:!1);if(re.length===0)return console.log(`No missed messages for session ${I}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${re.length} missed messages for session ${I}`);const q=n.value.get(I)||[],D=new Set(q.map(L=>L.id).filter(Boolean)),M=re.filter(L=>!L.id||!D.has(L.id));if(console.log(`After deduplication: ${M.length} unique new messages`),M.length>0){const L=M.sort((Q,W)=>{const Z=se(Q.timestamp),ie=se(W.timestamp);return Z-ie}),U=n.value.get(I)||[],X=U.length>0?se(U[U.length-1].timestamp):0,pe=se(L[0].timestamp),De=se(L[L.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:U.length,lastExisting:X,lastExistingDate:U.length>0?U[U.length-1].timestamp:"none",firstNew:pe,firstNewDate:L[0].timestamp,lastNew:De,lastNewDate:L[L.length-1].timestamp,shouldAppend:pe>X}),pe>X){const Q=[...U,...L];n.value.set(I,Q),console.log(`âœ… Appended ${L.length} new messages (no full sort needed)`)}else{const Q=[...U,...L].sort((W,Z)=>{const ie=se(W.timestamp),me=se(Z.timestamp);return ie-me});n.value.set(I,Q),console.log(`âš ï¸ Merged and sorted ${L.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${q.length} messages unchanged`);M.forEach(L=>{w(I,L),L.metadata?.has_tool_uses&&L.metadata.tool_uses&&L.metadata.tool_uses.forEach(U=>{y(I,U,L.timestamp)}),L.metadata?.has_tool_results&&L.metadata.tool_results&&L.metadata.tool_results.forEach(U=>{S(I,U)}),(L.type==="permission_request"||L.metadata?.has_permission_requests)&&m(I,L),L.type==="permission_response"&&h(I,{request_id:L.metadata?.request_id,decision:L.metadata?.decision,updated_input:L.metadata?.updated_input,reasoning:L.metadata?.reasoning,applied_updates:L.metadata?.applied_updates}),L.type==="system"&&(L.subtype==="init"||L.metadata?.subtype==="init")&&L.metadata?.init_data&&ve().storeInitData(I,L.metadata.init_data)});const O=n.value.get(I);if(O&&O.length>0){const L=O[O.length-1];L.timestamp&&c.value.set(I,L.timestamp)}return n.value=new Map(n.value),{syncedCount:M.length,hasMore:ne}}catch(G){return console.error(`Failed to sync messages for session ${I}:`,G),{syncedCount:0,hasMore:!1,error:G.message}}}const Y=ve();return _e(()=>Array.from(Y.sessions.values()).map(P=>({id:P.session_id,state:P.state})),(I,P)=>{P&&I.forEach((G,te)=>{const ne=P[te];if(!ne||ne.id!==G.id)return;const se=["active","paused","starting"].includes(ne.state),he=!["active","paused","starting"].includes(G.state);se&&he&&V(G.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:ws(i),orphanedToolUses:ws(l),currentMessages:p,currentToolCalls:f,loadMessages:u,addMessage:g,addToolCall:$,updateToolCall:k,handleToolCall:v,handleToolUse:y,handlePermissionRequest:m,handlePermissionResponse:h,handleToolResult:S,toggleToolExpansion:C,clearMessages:N,markToolUseOrphaned:T,isToolUseOrphaned:x,getOrphanedInfo:z,clearOrphanedToolUses:V,getLastReceivedTimestamp:H,syncMessages:K,getBackendToolState:E,hasBackendDisplayMetadata:B,backendToolStates:ws(d)}}),la=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Oe},Symbol.toStringTag,{value:"Module"}));function ca(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function qt(n){return ca(n).toLocaleTimeString()}const ua={class:"message-row message-row-user"},da=["title"],ma={class:"message-content-column"},pa=["innerHTML"],fa={key:0,class:"tool-results mt-2"},va={class:"tool-results-header text-muted small mb-2"},ha={class:"d-flex align-items-start gap-2"},_a={class:"flex-grow-1"},ga={class:"text-muted"},ba={key:0,class:"text-danger small"},ya={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Qe.setOptions({breaks:!0,gfm:!0});const s=_(()=>qt(e.message.timestamp)),o=_(()=>`user
${s.value}`),i=_(()=>{const p=e.message.content||"";let f=Qe.parse(p);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),Ut.sanitize(f)}),l=_(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=_(()=>e.message.metadata?.tool_results||[]);function d(p,f){return p?p.length<=f?p:p.substring(0,f)+"...":""}return(p,f)=>(a(),r("div",ua,[t("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,da),t("div",ma,[t("div",{class:"message-text",innerHTML:i.value},null,8,pa),l.value?(a(),r("div",fa,[t("div",va," ðŸ”§ Tool Results ("+b(c.value.length)+") ",1),(a(!0),r(ce,null,de(c.value,(u,w)=>(a(),r("div",{key:w,class:ee(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",ha,[t("span",null,b(u.is_error?"âŒ":"âœ…"),1),t("div",_a,[t("small",ga,"Tool: "+b(u.tool_use_id),1),u.is_error?(a(),r("div",ba,b(d(u.content,200)),1)):A("",!0)])])],2))),128))])):A("",!0)])]))}},wa=oe(ya,[["__scopeId","data-v-7665755b"]]),$a={class:"thinking-block"},ka=["aria-label"],Sa={class:"text-muted ms-auto"},Ca={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Ea=["innerHTML"],Ta={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=R(!1),o=_(()=>e.thinking?.length||0),i=_(()=>{const c=e.thinking||"",d=Qe.parse(c);return Ut.sanitize(d)});function l(){s.value=!s.value}return(c,d)=>(a(),r("div",$a,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:l},[t("span",{"aria-label":s.value?"Collapse":"Expand"},b(s.value?"â–¾":"â–¸"),9,ka),d[0]||(d[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Sa,b(o.value)+" characters",1)]),s.value?(a(),r("div",Ca,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,Ea)])):A("",!0)]))}},xa=oe(Ta,[["__scopeId","data-v-fda2352c"]]),Sn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Ss={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Ve=Ze("resource",()=>{const n=R(new Map),e=R(!1),s=R(0),o=R(null),i=R(!1),l=R(new Map);function c(Q){if(!Q)return!1;if(Q.is_image===!0||(Q.mime_type||"").toLowerCase().startsWith("image/"))return!0;const Z=(Q.format||"").toLowerCase();if(Z.startsWith("image/")||Sn.has("."+Z))return!0;const ie=Q.original_filename||Q.original_name||"";if(ie){const me="."+ie.split(".").pop().toLowerCase();return Sn.has(me)}return!1}function d(Q){if(!Q||c(Q))return!1;const W=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),Z=Q.original_filename||Q.original_name||"";if(Z){const me="."+Z.split(".").pop().toLowerCase();if(W.has(me))return!0}const ie=(Q.mime_type||Q.format||"").toLowerCase();return!!(ie.startsWith("text/")||ie==="application/json"||ie==="application/xml")}function p(Q){if(c(Q))return"ðŸ–¼ï¸";if(Q.original_filename){const W="."+Q.original_filename.split(".").pop().toLowerCase();return Ss[W]||Ss.default}return Ss.default}function f(Q){return Q.original_filename?"."+Q.original_filename.split(".").pop().toLowerCase():""}function u(Q){const W=n.value.get(Q);return W||[]}function w(Q){return n.value.get(Q)?.length||0}function g(Q){return w(Q)>0}function $(Q){return u(Q).filter(c)}function k(Q){return $(Q).length}function y(Q){return k(Q)>0}const m=_(()=>{const Q=ve();return u(Q.currentSessionId)}),h=_(()=>{const Q=ve();return w(Q.currentSessionId)}),v=_(()=>h.value>0),S=_(()=>m.value.filter(c)),C=_(()=>S.value.length),j=_(()=>C.value>0),F=_(()=>!e.value||!o.value?null:u(o.value)[s.value]||null),E=F,B=_(()=>o.value?w(o.value):0),T=B;async function x(Q){if(Q){i.value=!0;try{const Z=(await Ht(`/api/sessions/${Q}/resources`)).resources||[];Z.sort((ie,me)=>(ie.timestamp||0)-(me.timestamp||0)),n.value.set(Q,Z),n.value=new Map(n.value),console.log(`Loaded ${Z.length} resources for session ${Q}`)}catch(W){console.error(`Failed to load resources for session ${Q}:`,W),n.value.set(Q,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const z=x;function V(Q,W){if(!Q||!W)return;let Z=n.value.get(Q);Z||(Z=[],n.value.set(Q,Z));const ie=Z.findIndex(me=>me.resource_id===W.resource_id);ie>=0?Z[ie]=W:Z.push(W),Z.sort((me,Ce)=>(me.timestamp||0)-(Ce.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${W.resource_id} to session ${Q}`)}const N=V;function H(Q,W){return`/api/sessions/${Q}/resources/${W}`}const K=H;function Y(Q,W){return`/api/sessions/${Q}/resources/${W}/download`}function I(Q,W=0){o.value=Q,s.value=Math.max(0,Math.min(W,w(Q)-1)),e.value=!0}function P(){e.value=!1}function G(){if(!o.value)return;const Q=w(o.value);Q!==0&&(s.value=(s.value+1)%Q)}const te=G;function ne(){if(!o.value)return;const Q=w(o.value);Q!==0&&(s.value=(s.value-1+Q)%Q)}const se=ne;function he(Q){if(!o.value)return;const W=w(o.value);W!==0&&(s.value=Math.max(0,Math.min(Q,W-1)))}const re=he;function q(Q){n.value.delete(Q),n.value=new Map(n.value),o.value===Q&&P(),console.log(`Cleared resources for session ${Q}`)}const D=q;async function M(Q,W){if(!(!Q||!W))try{await ko(`/api/sessions/${Q}/resources/${W}`),L(Q,W)}catch(Z){console.error(`Failed to remove resource ${W}:`,Z)}}function O(Q,W){L(Q,W)}function L(Q,W){const Z=n.value.get(Q);if(!Z)return;const ie=Z.findIndex(me=>me.resource_id===W);ie!==-1&&(Z.splice(ie,1),n.value=new Map(n.value),e.value&&o.value===Q&&(Z.length===0?P():s.value>=Z.length&&(s.value=Z.length-1)),l.value.delete(W),l.value=new Map(l.value))}async function U(Q,W){if(!Q||!W)return null;const Z=l.value.get(W);if(Z&&!Z.error)return Z.content;l.value.set(W,{content:null,loading:!0,error:null}),l.value=new Map(l.value);try{const ie=H(Q,W),me=await fetch(ie);if(!me.ok)throw new Error(`HTTP ${me.status}`);const Ce=await me.text();return l.value.set(W,{content:Ce,loading:!1,error:null}),l.value=new Map(l.value),Ce}catch(ie){return console.error(`Failed to fetch text content for resource ${W}:`,ie),l.value.set(W,{content:null,loading:!1,error:ie.message}),l.value=new Map(l.value),null}}function X(Q){return l.value.get(Q)||null}function pe(Q){if(Q){const W=n.value.get(Q);W&&(W.forEach(Z=>l.value.delete(Z.resource_id)),l.value=new Map(l.value))}else l.value=new Map}function De(Q,W){const Z=n.value.get(Q);return Z&&Z.find(ie=>ie.resource_id===W)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:i,textContentCache:l,currentResources:m,currentResourceCount:h,currentHasResources:v,currentFullViewResource:F,fullViewTotalResources:B,currentImages:S,currentImageCount:C,currentHasImages:j,currentFullViewImage:E,fullViewTotalImages:T,imagesBySession:n,resourcesForSession:u,resourceCount:w,hasResources:g,getResourceUrl:H,getDownloadUrl:Y,isImageResource:c,isTextResource:d,getResourceIcon:p,getResourceExtension:f,getResourceById:De,getTextContent:X,imagesForSession:$,imageCount:k,hasImages:y,getImageUrl:K,loadResources:x,addResource:V,removeResource:M,handleResourceRemoved:O,openFullView:I,closeFullView:P,nextResource:G,prevResource:ne,goToResource:he,clearResources:q,fetchTextContent:U,clearTextCache:pe,loadImages:z,addImage:N,nextImage:te,prevImage:se,goToImage:re,clearImages:D}}),Aa=Ve,Ma=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Aa,useResourceStore:Ve},Symbol.toStringTag,{value:"Module"})),at=Ze("websocket",()=>{const n=R(null),e=R(!1),s=R(0),o=10,i=R(null),l=R(!1),c=R(0),d=5,p=R(null);let f=null;const u=R(0),w=R(null),g=R(new Map),$=R(null),k=R(!1),y=R(0),m=5,h=R(null),v=1e4,S=1e3,C=R(Date.now()),j=R(Date.now()),F=R(Date.now());let E=null,B=null,T=null;const x=_(()=>e.value&&(l.value||!p.value)?"connected":e.value?"partial":"disconnected");function z(M){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${M}`}function V(M){const O={ui:{timer:()=>E,setTimer:L=>{E=L},lastPing:C,connected:e,name:"UI"},session:{timer:()=>B,setTimer:L=>{B=L},lastPing:j,connected:l,name:"Session"},legion:{timer:()=>T,setTimer:L=>{T=L},lastPing:F,connected:k,name:"Legion"}}[M];O.timer()&&clearInterval(O.timer()),O.setTimer(setInterval(()=>{if(!O.connected.value)return;const L=Date.now()-O.lastPing.value;if(L>v){console.warn(`âš ï¸ ${O.name} WebSocket heartbeat timeout (${L}ms since last ping) - forcing close to trigger reconnection`),O.connected.value=!1;const X={ui:n,session:i,legion:$}[M];X.value&&X.value.readyState===WebSocket.OPEN&&X.value.close()}},S)),console.log(`âœ… Started heartbeat monitor for ${O.name} WebSocket`)}function N(M){const O={ui:{get:()=>E,set:L=>{E=L}},session:{get:()=>B,set:L=>{B=L}},legion:{get:()=>T,set:L=>{T=L}}}[M];O.get()&&(clearInterval(O.get()),O.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${M} WebSocket`))}function H(){if(n.value)return;const M=z("/ws/ui");console.log(`Connecting to UI WebSocket: ${M}`),n.value=new WebSocket(M),n.value.onopen=()=>{e.value=!0,s.value=0,C.value=Date.now(),V("ui"),console.log("UI WebSocket connected")},n.value.onmessage=O=>{const L=JSON.parse(O.data);se(L)},n.value.onclose=()=>{if(N("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const O=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${O}ms (attempt ${s.value})`),setTimeout(H,O)}},n.value.onerror=O=>{console.error("UI WebSocket error:",O)}}function K(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Y(M){u.value++;const O=u.value;if(console.log(`[Gen ${O}] Starting connection to session ${M}`),f&&(clearTimeout(f),f=null),await I(),u.value!==O){console.log(`[Gen ${O}] Connection cancelled (current generation: ${u.value})`);return}p.value=M,w.value=O;const L=z(`/ws/session/${M}`);console.log(`[Gen ${O}] Connecting to Session WebSocket: ${L}`),i.value=new WebSocket(L),i.value.onopen=async()=>{if(w.value!==O){console.log(`[Gen ${O}] Ignoring onopen (stale connection, current: ${w.value})`),i.value.close();return}l.value=!0,c.value=0,j.value=Date.now(),V("session"),console.log(`[Gen ${O}] Session WebSocket connected for ${M}`);const U=g.value.get(M);if(g.value.set(M,!0),U){console.log(`[Gen ${O}] Reconnection detected, syncing missed messages...`);try{const pe=await Oe().syncMessages(M);pe.syncedCount>0?console.log(`[Gen ${O}] âœ… Synced ${pe.syncedCount} missed messages`):pe.error?console.warn(`[Gen ${O}] âš ï¸ Message sync failed: ${pe.error}`):console.log(`[Gen ${O}] No missed messages to sync`),pe.hasMore&&console.warn(`[Gen ${O}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(X){console.error(`[Gen ${O}] Error during message sync:`,X)}}else console.log(`[Gen ${O}] Initial connection, no sync needed`)},i.value.onmessage=U=>{if(w.value!==O){console.log(`[Gen ${O}] Ignoring message (stale connection, current: ${w.value})`);return}const X=JSON.parse(U.data);he(X,M)},i.value.onclose=()=>{N("session"),l.value=!1,i.value=null,console.log(`[Gen ${O}] Session WebSocket closed for ${M}`);const U=ve();if(U.currentSessionId===M&&w.value===O&&c.value<d){c.value++;const X=Math.min(2e3*c.value,3e4);console.log(`[Gen ${O}] Reconnecting Session WebSocket in ${X}ms (attempt ${c.value})`),f=setTimeout(()=>{w.value===O&&U.currentSessionId===M?(f=null,Y(M)):console.log(`[Gen ${O}] Skipping reconnect (generation or session changed)`)},X)}},i.value.onerror=U=>{console.error(`[Gen ${O}] Session WebSocket error:`,U)}}function I(){return new Promise(M=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const O=p.value,L=()=>{i.value=null,l.value=!1,p.value=null,w.value=null,c.value=0,O&&g.value.delete(O),M()};if(i.value.readyState===WebSocket.CLOSED)L();else{const U=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),L()},2e3);i.value.addEventListener("close",()=>{clearTimeout(U),L()},{once:!0}),i.value.close()}}else p.value=null,w.value=null,M()})}function P(M){i.value&&l.value?(i.value.send(JSON.stringify({type:"send_message",content:M})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function G(M,O,L=!1,U=null,X=null){if(i.value&&l.value){const pe={type:"permission_response",request_id:M,decision:O,apply_suggestions:L,timestamp:new Date().toISOString()};U&&(pe.clarification_message=U),X&&(pe.selected_suggestions=X),i.value.send(JSON.stringify(pe)),console.log(`Sent permission ${O} for request ${M}`,{applySuggestions:L,clarification:U,selectedSuggestions:X})}}function te(M,O,L){if(i.value&&l.value){const U={type:"permission_response",request_id:M,decision:O,updated_input:L,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(U)),console.log(`Sent permission ${O} with updated_input for request ${M}`,L)}}function ne(){i.value&&l.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function se(M){const O=ve(),L=Fe();switch(M.type){case"sessions_list":M.sessions&&Array.isArray(M.sessions)&&M.sessions.forEach(U=>{O.updateSession(U.session_id,U)});break;case"state_change":M.data&&M.data.session_id&&M.data.session&&O.updateSession(M.data.session_id,M.data.session);break;case"project_updated":if(M.data&&M.data.project){const U=M.data.project;L.updateProjectLocal(U.project_id,U),O.fetchSessions()}break;case"project_deleted":M.data&&M.data.project_id&&L.projects.delete(M.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":C.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",M.type)}}function he(M,O){const L=ve();if(L.currentSessionId!==O){console.warn(`Ignoring message for session ${O} (current: ${L.currentSessionId})`);return}const U=Oe();switch(M.type){case"message":const X=M.data;if(!X||!X.type){console.warn("Received message event with invalid data:",M);break}if(X.type==="tool_call"){U.handleToolCall(O,X);break}if(X.type==="permission_request"){U.handlePermissionRequest(O,X);break}if(X.type==="permission_response"){U.handlePermissionResponse(O,X);break}X.metadata?.has_tool_uses&&X.metadata.tool_uses.forEach(pe=>{U.handleToolUse(O,pe,X.timestamp)}),X.metadata?.has_tool_results&&X.metadata.tool_results.forEach(pe=>{U.handleToolResult(O,pe)}),X.type==="system"&&(X.subtype==="init"||X.metadata?.subtype==="init")&&X.metadata?.init_data&&L.storeInitData(O,X.metadata.init_data),U.addMessage(O,X);break;case"permission_request":U.handlePermissionRequest(O,M);break;case"permission_response":U.handlePermissionResponse(O,M);break;case"tool_result":U.handleToolResult(O,M);break;case"state_change":L.updateSession(O,M.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${O}`);break;case"ping":j.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":M.resource&&(Ve().addResource(O,M.resource),console.log(`Resource registered for session ${O}:`,M.resource.resource_id));break;case"resource_removed":M.resource_id&&(Ve().handleResourceRemoved(O,M.resource_id),console.log(`Resource removed for session ${O}:`,M.resource_id));break;case"image_registered":M.image&&(Ve().addResource(O,{...M.image,resource_id:M.image.image_id}),console.log(`Image registered (legacy) for session ${O}:`,M.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",M.type)}}function re(M){q(),h.value=M;const O=z(`/ws/legion/${M}`);console.log(`Connecting to Legion WebSocket: ${O}`),$.value=new WebSocket(O),$.value.onopen=()=>{k.value=!0,y.value=0,F.value=Date.now(),V("legion"),console.log(`Legion WebSocket connected for ${M}`)},$.value.onmessage=L=>{const U=JSON.parse(L.data);D(U,M)},$.value.onclose=()=>{if(N("legion"),k.value=!1,$.value=null,console.log(`Legion WebSocket closed for ${M}`),h.value===M&&y.value<m){y.value++;const L=Math.min(2e3*y.value,3e4);setTimeout(()=>re(M),L)}},$.value.onerror=L=>{console.error("Legion WebSocket error:",L)}}function q(){$.value&&($.value.close(),$.value=null,k.value=!1,h.value=null)}function D(M,O){Me(async()=>{const{useLegionStore:L}=await Promise.resolve().then(()=>Ub);return{useLegionStore:L}},void 0).then(({useLegionStore:L})=>{const U=L();switch(M.type){case"comm":M.comm&&(U.addComm(O,M.comm),console.log("Legion WebSocket: Received new comm",M.comm));break;case"minion_created":M.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",M.data),Me(async()=>{const{useSessionStore:X}=await Promise.resolve().then(()=>kn);return{useSessionStore:X}},void 0).then(({useSessionStore:X})=>{X().loadSessions()}));break;case"minion_updated":M.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",M.data),Me(async()=>{const{useSessionStore:X}=await Promise.resolve().then(()=>kn);return{useSessionStore:X}},void 0).then(({useSessionStore:X})=>{X().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${O}`);break;case"ping":F.value=Date.now(),$.value?.readyState===WebSocket.OPEN&&$.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",M.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:l,sessionRetryCount:c,legionConnected:k,legionRetryCount:y,overallStatus:x,connectUI:H,disconnectUI:K,connectSession:Y,disconnectSession:I,sendMessage:P,sendPermissionResponse:G,sendPermissionResponseWithInput:te,interruptSession:ne,connectLegion:re,disconnectLegion:q}}),Da=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:at},Symbol.toStringTag,{value:"Module"})),Oa={class:"base-tool-handler"},La={class:"tool-section"},Na={class:"tool-parameters"},Ia={class:"tool-code"},ja={key:0,class:"tool-section"},Ra={class:"tool-section-label"},Pa={class:"tool-code"},Fa={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=_(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,d)=>(a(),r("div",Oa,[t("div",La,[d[0]||(d[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Na,[t("pre",Ia,b(s.value),1)])]),o.value?(a(),r("div",ja,[t("div",Ra,b(i.value?"Error:":"Result:"),1),t("div",{class:ee(["tool-result",{"tool-result-error":i.value}])},[t("pre",Pa,b(l.value),1)],2)])):A("",!0)]))}},Wa=oe(Fa,[["__scopeId","data-v-1e69f57d"]]),Ba={class:"read-tool-handler"},Ha={class:"tool-section"},Va={class:"read-file-info"},Ua={class:"file-icon"},qa={class:"file-path"},za={key:0,class:"read-range"},Ka={key:0,class:"tool-section"},Ga={key:0,class:"tool-result tool-result-error"},Ya={class:"tool-code"},Ja={key:1,class:"image-preview"},Qa={class:"content-header"},Xa={class:"image-badge"},Za={class:"image-container"},er=["src","alt"],tr={key:2,class:"file-content-preview"},sr={class:"content-header"},nr={class:"line-count-badge"},or={key:0,class:"preview-note"},ir={class:"tool-code content-display"},ar={key:0,class:"more-indicator"},Cs=100,rr={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>{const h=s.value;return h.split("/").pop()||h}),i=_(()=>{const h=e.toolCall.input?.offset,v=e.toolCall.input?.limit;return h!==void 0||v!==void 0}),l=_(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),c=_(()=>{const h=e.toolCall.input?.offset||0,v=e.toolCall.input?.limit;return v!==void 0?h+v:"âˆž"}),d=_(()=>{const h=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(h)}),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>{if(!p.value||f.value)return null;const v=e.toolCall.result?.content;if(Array.isArray(v)){for(const S of v)if(S?.type==="image"&&S?.source?.type==="base64"&&S?.source?.data)return S.source.data}return null}),w=_(()=>{if(!u.value)return"";const h=s.value.toLowerCase();return h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".gif")?"image/gif":h.endsWith(".webp")?"image/webp":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".bmp")?"image/bmp":h.endsWith(".ico")?"image/x-icon":"image/png"}),g=_(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),$=_(()=>f.value||!g.value||u.value?[]:g.value.split(`
`)),k=_(()=>$.value.length),y=_(()=>k.value>Cs),m=_(()=>f.value||u.value?"":$.value.slice(0,Cs).join(`
`));return(h,v)=>(a(),r("div",Ba,[t("div",Ha,[t("div",Va,[t("span",Ua,b(d.value?"ðŸ–¼ï¸":"ðŸ“„"),1),v[0]||(v[0]=t("strong",null,"Reading:",-1)),t("code",qa,b(s.value),1),i.value?(a(),r("span",za,"Lines "+b(l.value)+"-"+b(c.value),1)):A("",!0)])]),p.value?(a(),r("div",Ka,[f.value?(a(),r("div",Ga,[t("pre",Ya,b(g.value),1)])):u.value?(a(),r("div",Ja,[t("div",Qa,[v[1]||(v[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",Xa,b(w.value),1)]),t("div",Za,[t("img",{src:`data:${w.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,er)])])):(a(),r("div",tr,[t("div",sr,[v[2]||(v[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",nr,b(k.value)+" lines",1),y.value?(a(),r("span",or,"(showing first "+b(Cs)+")")):A("",!0)]),t("pre",ir,b(m.value),1),y.value?(a(),r("div",ar,"...")):A("",!0)]))])):A("",!0)]))}},lr=oe(rr,[["__scopeId","data-v-29b774b1"]]),cr={class:"write-tool-handler"},ur={class:"tool-section"},dr={class:"write-file-info mb-2"},mr={class:"file-path"},pr={class:"write-content-preview"},fr={class:"content-header"},vr={class:"line-count-badge"},hr={key:0,class:"preview-note"},_r={class:"tool-code content-display"},gr={key:0,class:"more-indicator"},br={key:0,class:"tool-section"},yr={key:0,class:"tool-result tool-result-error"},wr={class:"tool-code"},$r={key:1,class:"tool-result tool-result-success"},kr={class:"success-message"},Es=100,Sr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.content||""),i=_(()=>o.value.split(`
`)),l=_(()=>i.value.length),c=_(()=>l.value>Es),d=_(()=>i.value.slice(0,Es).join(`
`)),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>{if(!p.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,g)=>(a(),r("div",cr,[t("div",ur,[t("div",dr,[g[0]||(g[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=t("strong",null,"Writing:",-1)),t("code",mr,b(s.value),1)]),t("div",pr,[t("div",fr,[g[2]||(g[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",vr,b(l.value)+" lines",1),c.value?(a(),r("span",hr,"(showing first "+b(Es)+")")):A("",!0)]),t("pre",_r,b(d.value),1),c.value?(a(),r("div",gr,"...")):A("",!0)])]),p.value?(a(),r("div",br,[f.value?(a(),r("div",yr,[g[3]||(g[3]=t("strong",null,"Error:",-1)),t("pre",wr,b(u.value),1)])):(a(),r("div",$r,[t("div",kr,[g[4]||(g[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+b(l.value)+" lines written)",1)])]))])):A("",!0)]))}},Cr=oe(Sr,[["__scopeId","data-v-ddc24a0f"]]),Er={class:"bash-tool-handler"},Tr={class:"tool-section"},xr={class:"bash-header"},Ar={class:"bash-header-content"},Mr={key:0,class:"bash-description"},Dr={key:1,class:"bash-flags"},Or={class:"bash-command-section"},Lr={class:"bash-command-content"},Nr={key:0,class:"tool-section"},Ir={key:0,class:"bash-output"},jr={key:1,class:"bash-output-empty"},Rr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.command||""),o=_(()=>e.toolCall.input?.description||""),i=_(()=>e.toolCall.input?.timeout),l=_(()=>e.toolCall.input?.run_in_background||!1),c=_(()=>i.value||l.value),d=_(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),l.value&&g.push("background"),g.join(", ")}),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>f.value?"tool-result-error":"tool-result-success"),w=_(()=>{if(!p.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,$)=>(a(),r("div",Er,[t("div",Tr,[t("div",xr,[$[1]||($[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Ar,[o.value?(a(),r("div",Mr,[$[0]||($[0]=t("strong",null,"Description:",-1)),ae(" "+b(o.value),1)])):A("",!0),c.value?(a(),r("div",Dr,b(d.value),1)):A("",!0)])]),t("div",Or,[$[2]||($[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Lr,b(s.value),1)])]),p.value?(a(),r("div",Nr,[t("div",{class:ee(["tool-result",u.value])},[$[3]||($[3]=t("strong",null,"Output:",-1)),w.value?(a(),r("pre",Ir,b(w.value),1)):(a(),r("div",jr,"No output"))],2)])):A("",!0)]))}},Pr=oe(Rr,[["__scopeId","data-v-ab50fe73"]]),Fr={class:"todo-tool-handler"},Wr={class:"tool-section"},Br={class:"todo-header"},Hr={class:"todo-summary"},Vr={key:0,class:"todo-count todo-count-completed"},Ur={key:1,class:"todo-count todo-count-in-progress"},qr={key:2,class:"todo-count todo-count-pending"},zr={class:"todo-checklist"},Kr={class:"todo-checkbox"},Gr={class:"todo-content"},Yr={key:0,class:"tool-section"},Jr={key:0,class:"tool-result tool-result-error"},Qr={class:"tool-code"},Xr={key:1,class:"tool-result tool-result-success"},Zr={class:"success-message"},el={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.todos||[]),o=_(()=>s.value.filter(u=>u.status==="completed").length),i=_(()=>s.value.filter(u=>u.status==="in_progress").length),l=_(()=>s.value.filter(u=>u.status==="pending").length);function c(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const d=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!d.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,w)=>(a(),r("div",Fr,[t("div",Wr,[t("div",Br,[w[0]||(w[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=t("strong",null,"Task List:",-1)),t("div",Hr,[o.value>0?(a(),r("span",Vr,b(o.value)+" completed ",1)):A("",!0),i.value>0?(a(),r("span",Ur,b(i.value)+" in progress ",1)):A("",!0),l.value>0?(a(),r("span",qr,b(l.value)+" pending ",1)):A("",!0)])]),t("div",zr,[(a(!0),r(ce,null,de(s.value,(g,$)=>(a(),r("div",{key:$,class:ee(["todo-item",`todo-${g.status}`])},[t("span",Kr,b(c(g.status)),1),t("span",Gr,b(g.content),1)],2))),128))])]),d.value?(a(),r("div",Yr,[p.value?(a(),r("div",Jr,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",Qr,b(f.value),1)])):(a(),r("div",Xr,[t("div",Zr,[w[3]||(w[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+b(s.value.length)+" tasks)",1)])]))])):A("",!0)]))}},tl=oe(el,[["__scopeId","data-v-bbe55ee7"]]),sl={class:"edit-tool-handler"},nl={class:"tool-section"},ol={class:"edit-file-info"},il={class:"file-path"},al={key:0,class:"replace-all-badge"},rl={class:"edit-diff-container"},ll={class:"diff-header"},cl={class:"diff-stats"},ul={class:"stat-removed"},dl={class:"stat-added"},ml={class:"unified-diff"},pl={class:"diff-scroll-container"},fl={class:"diff-marker"},vl={class:"diff-content"},hl={key:0,class:"tool-section"},_l={key:0,class:"tool-result tool-result-error"},gl={class:"tool-code"},bl={key:1,class:"tool-result tool-result-success"},yl={class:"success-message"},wl={key:0,class:"success-detail"},$l={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.old_string||""),i=_(()=>e.toolCall.input?.new_string||""),l=_(()=>e.toolCall.input?.replace_all||!1),c=_(()=>{const $=ji(s.value,o.value,i.value,"","",{context:3}).split(`
`),k=[];for(let y=4;y<$.length;y++){const m=$[y];m&&(m.startsWith("-")?k.push({type:"removed",content:m.substring(1)}):m.startsWith("+")?k.push({type:"added",content:m.substring(1)}):m.startsWith(" ")?k.push({type:"context",content:m.substring(1)}):m.startsWith("@@")&&k.push({type:"hunk",content:m}))}return k}),d=_(()=>c.value.filter(g=>g.type==="removed").length),p=_(()=>c.value.filter(g=>g.type==="added").length),f=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,$)=>(a(),r("div",sl,[t("div",nl,[t("div",ol,[$[0]||($[0]=t("span",{class:"file-icon"},"âœï¸",-1)),$[1]||($[1]=t("strong",null,"Editing:",-1)),t("code",il,b(s.value),1),l.value?(a(),r("span",al,"Replace All")):A("",!0)]),t("div",rl,[t("div",ll,[$[2]||($[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",cl,[t("span",ul,"-"+b(d.value),1),t("span",dl,"+"+b(p.value),1)])]),t("div",ml,[t("div",pl,[(a(!0),r(ce,null,de(c.value,(k,y)=>(a(),r("div",{key:y,class:ee(["diff-line",{"diff-line-removed":k.type==="removed","diff-line-added":k.type==="added","diff-line-context":k.type==="context","diff-line-hunk":k.type==="hunk"}])},[t("span",fl,b(k.type==="removed"?"-":k.type==="added"?"+":k.type==="hunk"?"@":" "),1),t("span",vl,b(k.content),1)],2))),128))])])])]),f.value?(a(),r("div",hl,[u.value?(a(),r("div",_l,[$[3]||($[3]=t("strong",null,"Error:",-1)),t("pre",gl,b(w.value),1)])):(a(),r("div",bl,[t("div",yl,[$[4]||($[4]=t("span",{class:"success-icon"},"âœ…",-1)),$[5]||($[5]=t("strong",null,"File edited successfully",-1)),l.value?(a(),r("span",wl,"(all occurrences replaced)")):A("",!0)])]))])):A("",!0)]))}},kl=oe($l,[["__scopeId","data-v-dd74055e"]]),Sl={class:"search-tool-handler"},Cl={class:"tool-section"},El={class:"search-info"},Tl={class:"search-icon"},xl={class:"search-pattern"},Al={key:0,class:"search-path"},Ml={key:1,class:"search-filters"},Dl={key:0,class:"filter-badge"},Ol={key:1,class:"filter-badge"},Ll={key:2,class:"filter-badge"},Nl={key:0,class:"tool-section"},Il={key:0,class:"tool-result tool-result-error"},jl={class:"tool-code"},Rl={key:1,class:"search-results"},Pl={class:"results-header"},Fl={class:"results-label"},Wl={class:"results-count-badge"},Bl={class:"results-content"},Hl={class:"tool-code"},Vl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="Grep"),o=_(()=>e.toolCall.input?.pattern||"Unknown"),i=_(()=>e.toolCall.input?.path||null),l=_(()=>e.toolCall.input?.type||null),c=_(()=>e.toolCall.input?.glob||null),d=_(()=>e.toolCall.input?.["-i"]||!1),p=_(()=>l.value||c.value||d.value),f=_(()=>s.value?"ðŸ”":"ðŸ“"),u=_(()=>s.value?"Searching content":"Finding files"),w=_(()=>s.value?"Matches":"Files found"),g=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=_(()=>{if(!g.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),y=_(()=>!g.value||$.value||!k.value?0:k.value.split(`
`).filter(h=>h.trim()).length);return(m,h)=>(a(),r("div",Sl,[t("div",Cl,[t("div",El,[t("span",Tl,b(f.value),1),t("strong",null,b(u.value)+":",1),t("code",xl,b(o.value),1),i.value?(a(),r("span",Al,"in "+b(i.value),1)):A("",!0),p.value?(a(),r("span",Ml,[l.value?(a(),r("span",Dl,"type: "+b(l.value),1)):A("",!0),c.value?(a(),r("span",Ol,"glob: "+b(c.value),1)):A("",!0),d.value?(a(),r("span",Ll,"case-insensitive")):A("",!0)])):A("",!0)])]),g.value?(a(),r("div",Nl,[$.value?(a(),r("div",Il,[h[0]||(h[0]=t("strong",null,"Error:",-1)),t("pre",jl,b(k.value),1)])):(a(),r("div",Rl,[t("div",Pl,[t("span",Fl,b(w.value)+":",1),t("span",Wl,b(y.value)+" "+b(y.value===1?"match":"matches"),1)]),t("div",Bl,[t("pre",Hl,b(k.value),1)])]))])):A("",!0)]))}},Cn=oe(Vl,[["__scopeId","data-v-0d272c39"]]),Ul={class:"web-tool-handler"},ql={class:"tool-section"},zl={class:"web-info"},Kl={class:"web-icon"},Gl=["href"],Yl={key:1,class:"web-query"},Jl={key:0,class:"web-prompt-container"},Ql={class:"prompt-content"},Xl={key:1,class:"web-domains"},Zl={class:"domains-label"},ec={key:0,class:"tool-section"},tc={key:0,class:"tool-result tool-result-error"},sc={class:"tool-code"},nc={key:1,class:"web-results"},oc={class:"results-header"},ic={class:"results-label"},ac={class:"results-content"},rc={class:"tool-code"},lc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="WebFetch"),o=_(()=>e.toolCall.input?.url||null),i=_(()=>e.toolCall.input?.query||null),l=_(()=>e.toolCall.input?.prompt||null),c=_(()=>e.toolCall.input?.allowed_domains||[]),d=_(()=>e.toolCall.input?.blocked_domains||[]),p=_(()=>c.value.length>0?c.value:d.value.length>0?d.value:[]),f=_(()=>c.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),u=_(()=>s.value?"ðŸŒ":"ðŸ”Ž"),w=_(()=>s.value?"Fetching URL":"Searching web"),g=_(()=>s.value?"Fetched content":"Search results"),$=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=_(()=>{if(!$.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,h)=>(a(),r("div",Ul,[t("div",ql,[t("div",zl,[t("span",Kl,b(u.value),1),t("strong",null,b(w.value)+":",1),o.value?(a(),r("a",{key:0,href:o.value,target:"_blank",class:"web-url"},b(o.value),9,Gl)):i.value?(a(),r("code",Yl,b(i.value),1)):A("",!0)]),l.value?(a(),r("div",Jl,[h[0]||(h[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Ql,b(l.value),1)])):A("",!0),p.value.length>0?(a(),r("div",Xl,[t("span",Zl,b(f.value)+":",1),(a(!0),r(ce,null,de(p.value,v=>(a(),r("span",{key:v,class:"domain-badge"},b(v),1))),128))])):A("",!0)]),$.value?(a(),r("div",ec,[k.value?(a(),r("div",tc,[h[1]||(h[1]=t("strong",null,"Error:",-1)),t("pre",sc,b(y.value),1)])):(a(),r("div",nc,[t("div",oc,[t("span",ic,b(g.value)+":",1)]),t("div",ac,[t("pre",rc,b(y.value),1)])]))])):A("",!0)]))}},En=oe(lc,[["__scopeId","data-v-62b55b55"]]),cc={class:"task-tool-handler"},uc={class:"tool-section"},dc={class:"task-header"},mc={key:0,class:"agent-type-badge"},pc={key:0,class:"task-description"},fc={class:"description-content"},vc={key:1,class:"task-prompt-container"},hc={class:"prompt-header"},_c={class:"prompt-length"},gc={class:"prompt-code"},bc={key:0,class:"tool-section"},yc={key:0,class:"tool-result tool-result-error"},wc={class:"tool-code"},$c={key:1,class:"agent-output"},kc={class:"output-header"},Sc={key:0,class:"output-count-badge"},Cc={class:"output-content"},Ec={class:"tool-code"},Tc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.description||null),o=_(()=>e.toolCall.input?.prompt||null),i=_(()=>e.toolCall.input?.subagent_type||null),l=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!l.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),p=_(()=>d.value?d.value.split(`
`).length:0);return(f,u)=>(a(),r("div",cc,[t("div",uc,[t("div",dc,[u[0]||(u[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=t("strong",null,"Agent Task:",-1)),i.value?(a(),r("span",mc,b(i.value),1)):A("",!0)]),s.value?(a(),r("div",pc,[u[2]||(u[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",fc,b(s.value),1)])):A("",!0),o.value?(a(),r("div",vc,[t("div",hc,[u[3]||(u[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",_c,b(o.value.length)+" characters",1)]),t("pre",gc,b(o.value),1)])):A("",!0)]),l.value?(a(),r("div",bc,[c.value?(a(),r("div",yc,[u[4]||(u[4]=t("strong",null,"Error:",-1)),t("pre",wc,b(d.value),1)])):(a(),r("div",$c,[t("div",kc,[u[5]||(u[5]=t("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(a(),r("span",Sc,b(p.value)+" lines",1)):A("",!0)]),t("div",Cc,[t("pre",Ec,b(d.value),1)])]))])):A("",!0)]))}},xc=oe(Tc,[["__scopeId","data-v-c520c244"]]),Ac={class:"task-create-tool-handler"},Mc={class:"tool-section"},Dc={class:"task-details p-2"},Oc={key:0,class:"task-field mb-2"},Lc={class:"field-value subject-value"},Nc={key:1,class:"task-field mb-2"},Ic={class:"field-value description-value"},jc={key:2,class:"task-field"},Rc={class:"field-value active-form-value"},Pc={key:0,class:"tool-section mt-2"},Fc={key:0,class:"tool-result tool-result-error"},Wc={class:"tool-code"},Bc={key:1,class:"tool-result tool-result-success"},Hc={class:"result-text"},Vc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.subject||null),o=_(()=>e.toolCall.input?.description||null),i=_(()=>e.toolCall.input?.activeForm||null),l=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!l.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,f)=>(a(),r("div",Ac,[t("div",Mc,[f[3]||(f[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Dc,[s.value?(a(),r("div",Oc,[f[0]||(f[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Lc,b(s.value),1)])):A("",!0),o.value?(a(),r("div",Nc,[f[1]||(f[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Ic,b(o.value),1)])):A("",!0),i.value?(a(),r("div",jc,[f[2]||(f[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Rc,b(i.value),1)])):A("",!0)])]),l.value?(a(),r("div",Pc,[c.value?(a(),r("div",Fc,[f[4]||(f[4]=t("strong",null,"Error:",-1)),t("pre",Wc,b(d.value),1)])):(a(),r("div",Bc,[f[5]||(f[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Hc,b(d.value),1)]))])):A("",!0)]))}},Uc=oe(Vc,[["__scopeId","data-v-474dd444"]]),qc={class:"task-update-tool-handler"},zc={class:"tool-section"},Kc={class:"task-header"},Gc={key:0,class:"task-id-badge"},Yc={class:"task-details p-2"},Jc={key:0,class:"task-field mb-2"},Qc={key:1,class:"task-field mb-2"},Xc={class:"field-value"},Zc={key:2,class:"task-field mb-2"},eu={class:"field-value description-value"},tu={key:3,class:"task-field mb-2"},su={class:"field-value active-form-value"},nu={key:4,class:"task-field mb-2"},ou={class:"field-value"},iu={key:5,class:"task-field mb-2"},au={class:"field-value"},ru={key:6,class:"task-field"},lu={class:"field-value"},cu={key:0,class:"tool-section mt-2"},uu={key:0,class:"tool-result tool-result-error"},du={class:"tool-code"},mu={key:1,class:"tool-result tool-result-success"},pu={class:"result-text"},fu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.input?.status||null),i=_(()=>e.toolCall.input?.subject||null),l=_(()=>e.toolCall.input?.description||null),c=_(()=>e.toolCall.input?.activeForm||null),d=_(()=>e.toolCall.input?.owner||null),p=_(()=>e.toolCall.input?.addBlockedBy||[]),f=_(()=>e.toolCall.input?.addBlocks||[]),u=_(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=_(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=_(()=>{if(!g.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,m)=>(a(),r("div",qc,[t("div",zc,[t("div",Kc,[m[0]||(m[0]=t("span",{class:"task-icon"},"âœï¸",-1)),m[1]||(m[1]=t("strong",null,"Update Task",-1)),s.value?(a(),r("span",Gc,"#"+b(s.value),1)):A("",!0)]),t("div",Yc,[o.value?(a(),r("div",Jc,[m[2]||(m[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:ee(["field-value status-value",w.value])},b(u.value)+" "+b(o.value),3)])):A("",!0),i.value?(a(),r("div",Qc,[m[3]||(m[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Xc,b(i.value),1)])):A("",!0),l.value?(a(),r("div",Zc,[m[4]||(m[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",eu,b(l.value),1)])):A("",!0),c.value?(a(),r("div",tu,[m[5]||(m[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",su,b(c.value),1)])):A("",!0),d.value?(a(),r("div",nu,[m[6]||(m[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",ou,b(d.value),1)])):A("",!0),p.value?.length?(a(),r("div",iu,[m[7]||(m[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",au,[(a(!0),r(ce,null,de(p.value,h=>(a(),r("span",{key:h,class:"badge bg-warning text-dark me-1"},"#"+b(h),1))),128))])])):A("",!0),f.value?.length?(a(),r("div",ru,[m[8]||(m[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",lu,[(a(!0),r(ce,null,de(f.value,h=>(a(),r("span",{key:h,class:"badge bg-info text-dark me-1"},"#"+b(h),1))),128))])])):A("",!0)])]),g.value?(a(),r("div",cu,[$.value?(a(),r("div",uu,[m[9]||(m[9]=t("strong",null,"Error:",-1)),t("pre",du,b(k.value),1)])):(a(),r("div",mu,[m[10]||(m[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",pu,b(k.value),1)]))])):A("",!0)]))}},vu=oe(fu,[["__scopeId","data-v-35582330"]]),hu={class:"task-list-tool-handler"},_u={key:0,class:"tool-section"},gu={key:0,class:"tool-result tool-result-error"},bu={class:"tool-code"},yu={key:1,class:"task-list-result"},wu={key:0,class:"parsed-tasks"},$u={class:"status-icon"},ku={class:"task-id text-muted"},Su={class:"task-subject flex-grow-1"},Cu={key:0,class:"task-owner badge bg-secondary"},Eu={key:1,class:"raw-result p-2"},Tu={class:"tool-code"},xu={key:1,class:"tool-section"},Au={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=_(()=>{if(!s.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),l=_(()=>{if(!i.value)return[];const d=[],f=i.value.split(`
`);for(const u of f){const w=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const g=w[2].toLowerCase();d.push({id:w[1],status:g,subject:w[3].trim(),owner:null,statusIcon:c(g)})}}return d});function c(d){switch(d){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(d,p)=>(a(),r("div",hu,[p[2]||(p[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(a(),r("div",_u,[o.value?(a(),r("div",gu,[p[0]||(p[0]=t("strong",null,"Error:",-1)),t("pre",bu,b(i.value),1)])):(a(),r("div",yu,[l.value.length>0?(a(),r("div",wu,[(a(!0),r(ce,null,de(l.value,(f,u)=>(a(),r("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",$u,b(f.statusIcon),1),t("span",ku,"#"+b(f.id),1),t("span",Su,b(f.subject),1),f.owner?(a(),r("span",Cu,b(f.owner),1)):A("",!0)]))),128))])):(a(),r("div",Eu,[t("pre",Tu,b(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),r("div",xu,[...p[1]||(p[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):A("",!0)]))}},Mu=oe(Au,[["__scopeId","data-v-4e79ba4b"]]),Du={class:"task-get-tool-handler"},Ou={class:"tool-section"},Lu={class:"task-header"},Nu={key:0,class:"task-id-badge"},Iu={key:0,class:"tool-section"},ju={key:0,class:"tool-result tool-result-error"},Ru={class:"tool-code"},Pu={key:1,class:"task-details-result p-2"},Fu={key:0,class:"parsed-task"},Wu={class:"task-field mb-2"},Bu={class:"field-value subject-value"},Hu={key:0,class:"task-field mb-2"},Vu={key:1,class:"task-field mb-2"},Uu={class:"field-value description-value"},qu={key:2,class:"task-field mb-2"},zu={class:"field-value"},Ku={key:3,class:"task-field mb-2"},Gu={class:"field-value"},Yu={key:4,class:"task-field"},Ju={class:"field-value"},Qu={key:1,class:"raw-result"},Xu={class:"tool-code"},Zu={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=_(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=_(()=>{if(!l.value)return null;const f=l.value;try{const g=JSON.parse(f);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const u=f.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of u){const $=g.match(/^Subject:\s*(.+)$/i);$&&(w.subject=$[1].trim());const k=g.match(/^Status:\s*(.+)$/i);k&&(w.status=k[1].trim());const y=g.match(/^Description:\s*(.+)$/i);y&&(w.description=y[1].trim());const m=g.match(/^Owner:\s*(.+)$/i);m&&(w.owner=m[1].trim())}return w.subject?w:null}),d=_(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),p=_(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,u)=>(a(),r("div",Du,[t("div",Ou,[t("div",Lu,[u[0]||(u[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=t("strong",null,"Get Task",-1)),s.value?(a(),r("span",Nu,"#"+b(s.value),1)):A("",!0)])]),o.value?(a(),r("div",Iu,[i.value?(a(),r("div",ju,[u[2]||(u[2]=t("strong",null,"Error:",-1)),t("pre",Ru,b(l.value),1)])):(a(),r("div",Pu,[c.value?(a(),r("div",Fu,[t("div",Wu,[u[3]||(u[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Bu,b(c.value.subject),1)]),c.value.status?(a(),r("div",Hu,[u[4]||(u[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:ee(["field-value",p.value])},b(d.value)+" "+b(c.value.status),3)])):A("",!0),c.value.description?(a(),r("div",Vu,[u[5]||(u[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",Uu,b(c.value.description),1)])):A("",!0),c.value.owner?(a(),r("div",qu,[u[6]||(u[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",zu,b(c.value.owner),1)])):A("",!0),c.value.blockedBy?.length?(a(),r("div",Ku,[u[7]||(u[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",Gu,[(a(!0),r(ce,null,de(c.value.blockedBy,w=>(a(),r("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+b(w),1))),128))])])):A("",!0),c.value.blocks?.length?(a(),r("div",Yu,[u[8]||(u[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",Ju,[(a(!0),r(ce,null,de(c.value.blocks,w=>(a(),r("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+b(w),1))),128))])])):A("",!0)])):(a(),r("div",Qu,[t("pre",Xu,b(l.value),1)]))]))])):A("",!0)]))}},ed=oe(Zu,[["__scopeId","data-v-a80d14da"]]),td={class:"notebook-edit-tool-handler"},sd={class:"tool-section"},nd={class:"notebook-info"},od={class:"file-path"},id={class:"cell-info mt-2"},ad={class:"info-row"},rd={class:"info-row"},ld={key:0,class:"info-row"},cd={class:"badge bg-info"},ud={key:0,class:"source-preview mt-3"},dd={class:"preview-header"},md={class:"preview-stats"},pd={class:"source-code"},fd={key:0,class:"tool-section"},vd={key:0},hd={key:1,class:"text-danger"},_d={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.notebook_path||"Unknown"),o=_(()=>e.toolCall.input?.cell_id),i=_(()=>e.toolCall.input?.cell_type||"code"),l=_(()=>e.toolCall.input?.edit_mode||"replace"),c=_(()=>e.toolCall.input?.new_source||""),d=_(()=>c.value.split(`
`).length),p=_(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=l.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,g)=>(a(),r("div",td,[t("div",sd,[t("div",nd,[g[0]||(g[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=t("strong",null,"Notebook:",-1)),t("code",od,b(s.value),1)]),t("div",id,[t("div",ad,[g[2]||(g[2]=t("strong",null,"Cell ID:",-1)),t("code",null,b(o.value||"N/A"),1)]),t("div",rd,[g[3]||(g[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:ee(["badge",p.value])},b(i.value),3)]),l.value?(a(),r("div",ld,[g[4]||(g[4]=t("strong",null,"Edit Mode:",-1)),t("span",cd,b(l.value),1)])):A("",!0)]),c.value?(a(),r("div",ud,[t("div",dd,[g[5]||(g[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",md,b(d.value)+" lines",1)]),t("pre",pd,[t("code",null,b(c.value),1)])])):A("",!0)]),n.toolCall.result?(a(),r("div",fd,[g[6]||(g[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:ee(["tool-result",f.value])},[n.toolCall.result.success!==!1?(a(),r("div",vd," âœ… "+b(u.value),1)):(a(),r("div",hd," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)])):A("",!0)]))}},gd=oe(_d,[["__scopeId","data-v-c81a9bcf"]]),bd={class:"shell-tool-handler"},yd={class:"tool-section"},wd={class:"shell-info"},$d={class:"shell-icon"},kd={key:0,class:"shell-id"},Sd={key:0,class:"filter-info mt-2"},Cd={class:"filter-pattern"},Ed={key:0,class:"tool-section"},Td={class:"result-header mb-2"},xd={key:0,class:"mb-2"},Ad={class:"shell-output"},Md={key:1,class:"mb-2"},Dd={class:"shell-output shell-output-error"},Od={key:0},Ld={key:1,class:"text-danger"},Nd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=_(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=_(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),l=_(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=_(()=>e.toolCall.input?.filter);function d($,k){if(!$)return null;const y=new RegExp(`<${k}>([\\s\\S]*?)<\\/${k}>`,"i"),m=$.match(y);return m?m[1].trim():null}const p=_(()=>{const $=e.toolCall.result;if(!$)return null;let k=$;if($.content&&(k=$.content),typeof k=="string")return{status:d(k,"status"),stdout:d(k,"stdout"),stderr:d(k,"stderr"),exit_code:d(k,"exit_code")};if(Array.isArray(k)){const y=k.find(m=>m.type==="text")?.text||"";return{status:d(y,"status"),stdout:d(y,"stdout"),stderr:d(y,"stderr"),exit_code:d(y,"exit_code")}}return{status:$.status||k.status,stdout:$.stdout||$.output||k.stdout||k.output,stderr:$.stderr||k.stderr,exit_code:$.exit_code||k.exit_code}}),f=_(()=>p.value?.status),u=_(()=>{const $=f.value;return $==="running"?"bg-success":$==="completed"?"bg-secondary":$==="killed"||$==="terminated"?"bg-danger":"bg-info"}),w=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const $=p.value;if($?.status==="running"&&!$.stdout&&!$.stderr)return"No new output since last check";if($?.status==="failed")return`Shell failed (exit code ${$.exit_code||"unknown"})`}return"Operation completed"});return($,k)=>(a(),r("div",bd,[t("div",yd,[t("div",wd,[t("span",$d,b(s.value),1),t("strong",null,b(o.value)+":",1),l.value?(a(),r("code",kd,"Shell "+b(l.value),1)):A("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(a(),r("div",Sd,[k[0]||(k[0]=t("strong",null,"Filter:",-1)),t("code",Cd,b(c.value),1)])):A("",!0)]),n.toolCall.result?(a(),r("div",Ed,[t("div",Td,[t("strong",null,b(i.value)+":",1),f.value?(a(),r("span",{key:0,class:ee(["badge",u.value])},b(f.value),3)):A("",!0)]),p.value?.stdout?(a(),r("div",xd,[k[1]||(k[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Ad,[t("pre",null,[t("code",null,b(p.value.stdout),1)])])])):A("",!0),p.value?.stderr?(a(),r("div",Md,[k[2]||(k[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Dd,[t("pre",null,[t("code",null,b(p.value.stderr),1)])])])):A("",!0),!p.value?.stdout&&!p.value?.stderr?(a(),r("div",{key:2,class:ee(["tool-result",w.value])},[n.toolCall.result.success!==!1?(a(),r("div",Od," âœ… "+b(g.value),1)):(a(),r("div",Ld," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)):A("",!0)])):A("",!0)]))}},Tn=oe(Nd,[["__scopeId","data-v-86def281"]]),Id={class:"skill-tool-handler"},jd={key:0,class:"tool-section"},Rd={class:"d-flex align-items-center gap-2"},Pd={class:"text-muted small"},Fd={key:0,class:"skill-content-body"},Wd={class:"skill-content-text"},Bd={key:1,class:"tool-section mt-3"},Hd={class:"tool-result tool-result-error"},Vd={class:"tool-code"},Ud={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=ve(),i=R(!1);function l(){i.value=!i.value}const c=_(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const $=s.messagesBySession.get(g)||[],k=$.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let y=null,m=null;for(let h=k+1;h<Math.min(k+3,$.length);h++){const v=$[h];if(v.type!=="user")continue;const S=v.content||"";S.includes("<command-message>")&&S.includes("skill is running")?y=v:S.startsWith("Base directory for this skill:")&&(m=v)}return{running:y,content:m}}),d=_(()=>{const g=c.value.content;if(!g)return"";const $=g.content||"",k=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return $.replace(k,"").trim()}),p=_(()=>d.value.length>0),f=_(()=>d.value?d.value.split(`
`).length:0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,$)=>(a(),r("div",Id,[p.value?(a(),r("div",jd,[t("div",{class:"skill-content-header",onClick:l},[t("div",Rd,[t("i",{class:ee(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),$[0]||($[0]=t("strong",null,"Skill Content",-1)),t("span",Pd,"("+b(f.value)+" lines)",1)])]),i.value?(a(),r("div",Fd,[t("pre",Wd,b(d.value),1)])):A("",!0)])):A("",!0),u.value?(a(),r("div",Bd,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Hd,[t("pre",Vd,b(w.value),1)])])):A("",!0)]))}},qd=oe(Ud,[["__scopeId","data-v-0a48ca0f"]]),zd={class:"slashcommand-tool-handler"},Kd={key:0,class:"tool-section"},Gd={class:"d-flex align-items-center gap-2"},Yd=["aria-label"],Jd={class:"text-muted small"},Qd={key:0,class:"command-content-body"},Xd={class:"command-content-text"},Zd={key:1,class:"tool-section mt-3"},em={class:"tool-result tool-result-error"},tm={class:"tool-code"},sm={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=ve(),i=R(!1);function l(){i.value=!i.value}const c=_(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const $=s.messagesBySession.get(g)||[],k=$.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let y=null,m=null;for(let h=k+1;h<Math.min(k+3,$.length);h++){const v=$[h];if(v.type!=="user")continue;const S=v.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?y=v:S.includes("ARGUMENTS:")&&(m=v)}return{running:y,content:m}}),d=_(()=>{const g=c.value.content;if(!g)return"";const $=g.content||"",k=/\nARGUMENTS:.*$/s;return $.replace(k,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=_(()=>d.value.length>0),f=_(()=>d.value?d.value.split(`
`).length:0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,$)=>(a(),r("div",zd,[p.value?(a(),r("div",Kd,[t("div",{class:"command-content-header",onClick:l},[t("div",Gd,[t("span",{"aria-label":i.value?"Collapse":"Expand"},b(i.value?"â–¾":"â–¸"),9,Yd),$[0]||($[0]=t("strong",null,"Command Content",-1)),t("span",Jd,"("+b(f.value)+" lines)",1)])]),i.value?(a(),r("div",Qd,[t("pre",Xd,b(d.value),1)])):A("",!0)])):A("",!0),u.value?(a(),r("div",Zd,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",em,[t("pre",tm,b(w.value),1)])])):A("",!0)]))}},nm=oe(sm,[["__scopeId","data-v-15991acf"]]),om={class:"exit-plan-mode-tool-handler"},im={class:"tool-section"},am={key:0,class:"plan-content mt-2"},rm={class:"plan-text"},lm={key:0,class:"tool-section"},cm={key:0},um={key:1,class:"text-danger"},dm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.plan),o=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,l)=>(a(),r("div",om,[t("div",im,[l[1]||(l[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(a(),r("div",am,[l[0]||(l[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",rm,b(s.value),1)])):A("",!0)]),n.toolCall.result?(a(),r("div",lm,[l[2]||(l[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:ee(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),r("div",cm," âœ… Permission mode reverted to default ")):(a(),r("div",um," â— "+b(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):A("",!0)]))}},mm=oe(dm,[["__scopeId","data-v-e2e3c781"]]),pm={class:"ask-user-question-handler"},fm={key:0,class:"answers-summary"},vm={class:"answer-question text-muted small"},hm={class:"answer-value fw-medium"},_m={key:1,class:"text-muted small"},gm={key:0,class:"questions-container"},bm={class:"question-header d-flex align-items-center gap-2 mb-2"},ym={key:0,class:"badge bg-secondary"},wm={class:"question-text fw-medium"},$m={class:"options-list"},km=["id","checked","disabled","onChange"],Sm=["id","name","checked","disabled","onChange"],Cm=["for"],Em={class:"option-label"},Tm={key:0,class:"option-description text-muted d-block small"},xm={class:"option-item form-check other-option"},Am=["id","checked","disabled","onChange"],Mm=["id","name","checked","disabled","onChange"],Dm=["for"],Om={key:2,class:"other-input mt-2"},Lm=["onUpdate:modelValue","disabled","onInput"],Nm={key:1,class:"alert alert-info mb-0"},Im={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,i=s,l=_(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=_(()=>{if(!l.value)return{};const C=o.toolCall.result;if(C?.content){if(typeof C.content=="object"&&C.content.answers)return C.content.answers;if(typeof C.content=="string")try{const F=JSON.parse(C.content);if(F.answers)return F.answers}catch{}}const j=o.toolCall.input||{};return j.answers?j.answers:{}}),d=_(()=>Object.keys(c.value).length>0),p=_(()=>(o.toolCall.input||{}).questions||[]),f=R({}),u=R({});_e(p,C=>{C.forEach((j,F)=>{F in f.value||(f.value[F]=j.multiSelect?[]:null),F in u.value||(u.value[F]="")})},{immediate:!0});function w(C,j){const F=f.value[C];return Array.isArray(F)?F.includes(j):F===j}function g(C){const j=f.value[C];return Array.isArray(j)?j.includes("__OTHER__"):j==="__OTHER__"}function $(C,j){f.value[C]=j,v()}function k(C){f.value[C]="__OTHER__",v()}function y(C,j){const F=f.value[C];if(!Array.isArray(F))f.value[C]=[j];else{const E=F.indexOf(j);E===-1?F.push(j):F.splice(E,1)}v()}function m(C){const j=f.value[C];if(!Array.isArray(j))f.value[C]=["__OTHER__"];else{const F=j.indexOf("__OTHER__");F===-1?j.push("__OTHER__"):j.splice(F,1)}v()}function h(C){v()}function v(){const C={};p.value.forEach((j,F)=>{const E=f.value[F],B=j.question;if(j.multiSelect){if(Array.isArray(E)&&E.length>0){const T=E.map(x=>x==="__OTHER__"?u.value[F]||"":x).filter(x=>x);C[B]=T.join(", ")}}else E==="__OTHER__"?C[B]=u.value[F]||"":E&&(C[B]=E)}),i("answer",C)}const S=_(()=>p.value.every((C,j)=>{const F=f.value[j];if(C.multiSelect){if(!Array.isArray(F)||F.length===0||F.includes("__OTHER__")&&!u.value[j])return!1}else if(!F||F==="__OTHER__"&&!u.value[j])return!1;return!0}));return e({allQuestionsAnswered:S,getAnswers:()=>{const C={};return p.value.forEach((j,F)=>{const E=f.value[F],B=j.question;if(j.multiSelect){if(Array.isArray(E)&&E.length>0){const T=E.map(x=>x==="__OTHER__"?u.value[F]||"":x).filter(x=>x);C[B]=T.join(", ")}}else E==="__OTHER__"?C[B]=u.value[F]||"":E&&(C[B]=E)}),C}}),(C,j)=>(a(),r("div",pm,[l.value?(a(),r(ce,{key:0},[d.value?(a(),r("div",fm,[(a(!0),r(ce,null,de(c.value,(F,E)=>(a(),r("div",{key:E,class:"answer-item mb-2"},[t("div",vm,b(E),1),t("div",hm,b(F),1)]))),128))])):(a(),r("div",_m," No answers recorded. "))],64)):(a(),r(ce,{key:1},[p.value.length>0?(a(),r("div",gm,[(a(!0),r(ce,null,de(p.value,(F,E)=>(a(),r("div",{key:E,class:"question-block mb-3"},[t("div",bm,[F.header?(a(),r("span",ym,b(F.header),1)):A("",!0),t("span",wm,b(F.question),1)]),t("div",$m,[(a(!0),r(ce,null,de(F.options,(B,T)=>(a(),r("div",{key:T,class:ee(["option-item form-check",{selected:w(E,B.label)}])},[F.multiSelect?(a(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${E}-opt${T}`,checked:w(E,B.label),disabled:n.disabled,onChange:x=>y(E,B.label)},null,40,km)):(a(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${E}-opt${T}`,name:`question-${E}`,checked:w(E,B.label),disabled:n.disabled,onChange:x=>$(E,B.label)},null,40,Sm)),t("label",{class:"form-check-label",for:`q${E}-opt${T}`},[t("span",Em,b(B.label),1),B.description?(a(),r("span",Tm,b(B.description),1)):A("",!0)],8,Cm)],2))),128)),t("div",xm,[F.multiSelect?(a(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${E}-other`,checked:g(E),disabled:n.disabled,onChange:B=>m(E)},null,40,Am)):(a(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${E}-other`,name:`question-${E}`,checked:g(E),disabled:n.disabled,onChange:B=>k(E)},null,40,Mm)),t("label",{class:"form-check-label",for:`q${E}-other`},[...j[0]||(j[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Dm),g(E)?(a(),r("div",Om,[we(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":B=>u.value[E]=B,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:B=>h()},null,40,Lm),[[Be,u.value[E]]])])):A("",!0)])])]))),128))])):(a(),r("div",Nm," No questions to display. "))],64))]))}},xn=oe(Im,[["__scopeId","data-v-ebcee33f"]]),jm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Rm={class:"tool-status-icon"},Pm=["title"],Fm={class:"d-flex align-items-center gap-2"},Wm={class:"text-muted"},Bm=["aria-label"],Hm={key:0,class:"card-body"},Vm={key:0,class:"alert alert-warning mb-3"},Um={class:"d-flex align-items-center"},qm={class:"mb-0 small"},zm={key:2,class:"permission-prompt mt-3"},Km={class:"question-buttons d-flex gap-2 mt-3"},Gm=["disabled"],Ym=["disabled"],Jm={class:"alert alert-warning mb-3"},Qm={class:"mb-0"},Xm={class:"tool-name"},Zm={key:0,class:"suggestions-section mb-3"},ep={class:"alert alert-info mb-0"},tp={class:"suggestion-checkboxes p-2 bg-white rounded"},sp=["id","onUpdate:modelValue","disabled"],np=["for"],op={class:"permission-buttons d-flex gap-2 mb-3"},ip=["disabled"],ap=["disabled"],rp=["disabled"],lp={class:"guidance-section mt-3"},cp=["disabled"],up=["disabled"],dp={key:3,class:"mt-3"},mp={class:"alert alert-warning mb-0"},pp={class:"d-flex align-items-center"},fp={class:"mb-0 small"},vp={key:4,class:"tool-section"},hp={class:"alert alert-danger mb-0"},_p={key:0},gp={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=ve(),i=at(),l=R(!1),c=R(null),d=R(""),p=R(!1),f=R(null),u=R({});_e(()=>e.toolCall.suggestions,q=>{if(q&&q.length>0){const D={};q.forEach((M,O)=>{D[O]=!0}),u.value=D}},{immediate:!0});const w=_(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((q,D)=>u.value[D]):[]),g=R(null),$=R({}),k=_(()=>e.toolCall.name==="AskUserQuestion"),y=_(()=>!k.value||!g.value?!1:g.value.allQuestionsAnswered);function m(q){$.value=q}async function h(){if(!l.value&&g.value){l.value=!0,c.value="submit-answers";try{const q=o.currentSessionId,D=g.value.getAnswers(),M={questions:e.toolCall.input?.questions||[],answers:D};q&&(s.updateToolCall(q,e.toolCall.id,{input:M}),s.handlePermissionResponse(q,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",M)}catch(q){console.error("Failed to submit question answers:",q)}finally{l.value=!1,c.value=null}}}const v=_(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),S=_(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),C=_(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),j=_(()=>{if(e.toolCall.backendStatus){const q=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[q]||q}if(C.value){const q=C.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[q]||q}return e.toolCall.status}),F={Read:lr,Write:Cr,Bash:Pr,TodoWrite:tl,Edit:kl,Grep:Cn,Glob:Cn,WebFetch:En,WebSearch:En,Task:xc,TaskCreate:Uc,TaskUpdate:vu,TaskList:Mu,TaskGet:ed,NotebookEdit:gd,BashOutput:Tn,KillShell:Tn,SlashCommand:nm,Skill:qd,ExitPlanMode:mm,AskUserQuestion:xn},E=_(()=>{const q=e.toolCall.name;return F[q]?F[q]:Wa}),B=_(()=>{const q=[];if(v.value)return q.push("border-warning"),q.join(" ");switch(j.value){case"pending":q.push("border-secondary");break;case"permission_required":q.push("border-warning");break;case"executing":q.push("border-primary");break;case"completed":z.value||e.toolCall.permissionDecision==="deny"?q.push("border-danger"):q.push("border-success");break;case"error":q.push("border-danger");break}return q.join(" ")}),T=_(()=>{if(v.value)return"â¹ï¸";switch(j.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":z.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),x=_(()=>qt(e.toolCall.timestamp)),z=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),V=_(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function N(q){if(!q)return"";const D=q.replace(/\\/g,"/").split("/");return D[D.length-1]}function H(q){if(!q)return"";const D=q.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return D?D[1]:q}function K(q,D=200){return q?q.length<=D?q:q.substring(0,D)+"...":""}function Y(q){if(!q)return null;if(q.content){const D=q.content.match(/exit code (\d+)/i);if(D)return parseInt(D[1])}return q.error?1:0}function I(q,D){const M=q?q.split(`
`).length:0;return{added:D?D.split(`
`).length:0,removed:M}}const P=_(()=>{const q=e.toolCall.name,D=e.toolCall.input||{},M=e.toolCall.result,O=j.value;switch(q){case"Bash":case"Shell":case"Command":{const L=H(D.command),U=K(L,200);if(O==="completed"&&M){const X=Y(M);return`Bash: ${U} (exit ${X})`}return`Bash: ${U}`}case"SlashCommand":{const L=K(D.command,200);return O==="completed"&&M?`SlashCommand: ${L}`:`SlashCommand: ${L}`}case"Edit":{const L=N(D.file_path);if(O==="completed"&&M&&!M.error){const{added:U,removed:X}=I(D.old_string,D.new_string);return U===X?`Edit: ${L} (${U} lines changed)`:`Edit: ${L} (${U} lines added, ${X} removed)`}return`Edit: ${L}`}case"Read":{const L=N(D.file_path);if(D.offset!==void 0||D.limit!==void 0){const X=(D.offset||0)+1,pe=D.limit?(D.offset||0)+D.limit:"âˆž";return`Read: ${L} (lines ${X}-${pe})`}return`Read: ${L} (full file)`}case"Write":{const L=N(D.file_path);if(O==="completed"&&M&&!M.error&&D.content){const U=D.content.split(`
`).length;return`Write: ${L} (${U} lines written)`}return`Write: ${L}`}case"Skill":{const L=D.skill||"Unknown";return O==="completed"&&M?M.error?`Skill: ${L} (error)`:`Skill: ${L} (completed)`:`Skill: ${L}`}case"Task":{const L=D.subagent_type||"general",U=D.description||"Task";return O==="completed"&&M?M.error?`Task: (${L}) ${U} (error)`:`Task: (${L}) ${U} (completed)`:`Task: (${L}) ${U}`}case"TodoWrite":{if(D.todos&&Array.isArray(D.todos)){const L=D.todos.filter(pe=>pe.status==="completed").length,U=D.todos.length,X=D.todos.find(pe=>pe.status==="in_progress");return X?`Todo: Working on "${X.content}"`:`Todo: ${L}/${U} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const L=D.pattern||"",U=q==="Grep"?"Grep":"Glob";if(O==="completed"&&M&&!M.error){let X=0;return M.content&&(X=M.content.split(`
`).filter(De=>De.trim()).length),`${U}: "${L}" (${X} results)`}return`${U}: "${L}"`}case"WebFetch":case"WebSearch":{const L=D.url||D.query||"";if(q==="WebSearch"){const X=D.query||"",pe=X.length>50?X.substring(0,50)+"...":X;return O==="completed"&&M?M.error?`Web: ${pe} (error)`:`Web: ${pe} (success)`:`Web: ${pe}`}let U="";try{L&&(U=new URL(L.startsWith("http")?L:`https://${L}`).hostname)}catch{U=L.length>50?L.substring(0,50)+"...":L}return O==="completed"&&M?M.error?`Web: ${U} (error)`:`Web: ${U} (success)`:`Web: ${U||L}`}case"NotebookEdit":{const L=N(D.notebook_path),U=D.cell_number!==void 0?D.cell_number:"?",X=D.edit_mode||"replace";return`NotebookEdit: ${L} cell #${U} (${X})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${D.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${D.shell_id||"unknown"}`;case"AskUserQuestion":{const U=(D.questions||[]).length;return O==="completed"&&M&&!M.error?`AskUserQuestion: ${U} question(s) answered`:O==="permission_required"?`AskUserQuestion: ${U} question(s) awaiting response`:`AskUserQuestion: ${U} question(s)`}case"TaskCreate":{const L=D.subject||"",U=L.length>40?L.substring(0,40)+"...":L;return O==="completed"&&M&&!M.error?`TaskCreate: "${U}" (created)`:`TaskCreate: "${U}"`}case"TaskUpdate":{const L=D.taskId||"?",U=D.status||"";return U?`TaskUpdate: #${L} -> ${U}`:`TaskUpdate: #${L}`}case"TaskList":return O==="completed"&&M&&!M.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const L=D.taskId||"?";return O==="completed"&&M&&!M.error?`TaskGet: #${L} (retrieved)`:`TaskGet: #${L}`}default:return`${q}: executed`}}),G=_(()=>{const q=e.toolCall.name,D=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(q)?D.command||q:["Edit","Read","Write","NotebookEdit"].includes(q)&&(D.file_path||D.notebook_path)||q});function te(){const q=o.currentSessionId;q&&s.toggleToolExpansion(q,e.toolCall.id)}function ne(q){return q.type==="setMode"?`Set mode: ${q.mode}`:q.type==="addRules"&&q.rules?.length?`Allow: ${q.rules.map(M=>M.ruleContent?`${M.toolName}(${M.ruleContent})`:M.toolName).join(", ")}`:q.type==="addDirectories"&&q.directories?.length?`Add directories: ${q.directories.join(", ")}`:JSON.stringify(q)}function se(){p.value=!0,st(()=>{f.value&&f.value.focus()})}function he(){const q=f.value;if(!q)return;q.style.height="auto";const D=parseFloat(getComputedStyle(q).lineHeight)*6+10;q.style.height=Math.min(q.scrollHeight,D)+"px"}async function re(q,D,M=null){if(l.value)return;l.value=!0;const O=w.value,L=D&&O.length>0;q==="allow"?c.value=L?"approve-apply":"approve":M?c.value="deny-guidance":c.value="deny";try{const U=o.currentSessionId;if(U){const X=L?O:[];s.handlePermissionResponse(U,{request_id:e.toolCall.permissionRequestId,decision:q,reasoning:q==="allow"?"User allowed permission":"User denied permission",applied_updates:X})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,q,L,M,L?O:null)}catch(U){console.error("Failed to send permission response:",U)}finally{l.value=!1,c.value=null}}return(q,D)=>(a(),r("div",{class:ee(["tool-call-card card",B.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:te},[t("div",jm,[t("span",Rm,b(T.value),1),t("span",{class:"tool-name",title:G.value},b(P.value),9,Pm)]),t("div",Fm,[t("small",Wm,b(x.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},b(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Bm)])]),n.toolCall.isExpanded?(a(),r("div",Hm,[v.value?(a(),r("div",Vm,[t("div",Um,[D[7]||(D[7]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[D[6]||(D[6]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",qm,b(S.value?.message||"Session was terminated"),1)])])])):A("",!0),k.value&&j.value==="permission_required"?A("",!0):(a(),$e(ho(E.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),j.value==="permission_required"&&!v.value?(a(),r("div",zm,[k.value?(a(),r(ce,{key:0},[D[8]||(D[8]=t("div",{class:"alert alert-info mb-3"},[t("p",{class:"mb-0"},[t("strong",null,"â“ Claude is asking for your input")])],-1)),be(xn,{ref_key:"questionHandlerRef",ref:g,toolCall:n.toolCall,disabled:l.value,onAnswer:m},null,8,["toolCall","disabled"]),t("div",Km,[t("button",{class:"btn btn-primary",onClick:h,disabled:l.value||!y.value},b(l.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,Gm),t("button",{class:"btn btn-outline-secondary",onClick:D[0]||(D[0]=M=>re("deny",!1)),disabled:l.value}," Skip Question ",8,Ym)])],64)):(a(),r(ce,{key:1},[t("div",Jm,[D[11]||(D[11]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",Qm,[D[9]||(D[9]=ae("Claude wants to use the ",-1)),t("code",Xm,b(n.toolCall.name),1),D[10]||(D[10]=ae(" tool.",-1))])]),V.value?(a(),r("div",Zm,[t("div",ep,[D[12]||(D[12]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Updates ",-1)),D[13]||(D[13]=t("p",{class:"mb-2 small"},"Select which permissions to apply:",-1)),t("div",tp,[(a(!0),r(ce,null,de(n.toolCall.suggestions,(M,O)=>(a(),r("div",{key:O,class:"form-check suggestion-check-item"},[we(t("input",{class:"form-check-input",type:"checkbox",id:`suggestion-${n.toolCall.id}-${O}`,"onUpdate:modelValue":L=>u.value[O]=L,disabled:l.value},null,8,sp),[[_o,u.value[O]]]),t("label",{class:"form-check-label",for:`suggestion-${n.toolCall.id}-${O}`},[t("code",null,b(ne(M)),1)],8,np)]))),128))]),D[14]||(D[14]=t("small",{class:"text-muted mt-2 d-block"}," Checked permissions will be applied to prevent future prompts. ",-1))])])):A("",!0),t("div",op,[V.value?(a(),r("button",{key:0,class:"btn btn-success",onClick:D[1]||(D[1]=M=>re("allow",!0)),disabled:l.value},b(l.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,ip)):A("",!0),t("button",{class:ee(["btn",V.value?"btn-outline-success":"btn-success"]),onClick:D[2]||(D[2]=M=>re("allow",!1)),disabled:l.value},b(l.value&&c.value==="approve"?"â³ Submitting...":V.value?"âœ… Approve Only":"âœ… Approve"),11,ap),t("button",{class:"btn btn-danger",onClick:D[3]||(D[3]=M=>re("deny",!1)),disabled:l.value}," ðŸš« "+b(l.value&&c.value==="deny"?"Submitting...":"Deny"),9,rp)]),t("div",lp,[p.value?A("",!0):(a(),r("a",{key:0,href:"#",class:"text-muted small",onClick:fe(se,["prevent"])}," Add guidance... ")),p.value?(a(),r(ce,{key:1},[D[15]||(D[15]=t("label",{class:"form-label fw-bold"}," Guidance (Optional) ",-1)),D[16]||(D[16]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. ",-1)),we(t("textarea",{ref_key:"guidanceTextarea",ref:f,"onUpdate:modelValue":D[4]||(D[4]=M=>d.value=M),class:"form-control guidance-textarea mb-2",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:l.value,onInput:he},null,40,cp),[[Be,d.value]]),d.value.trim()?(a(),r("button",{key:0,class:"btn btn-warning btn-sm",onClick:D[5]||(D[5]=M=>re("deny",!1,d.value)),disabled:l.value},b(l.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,up)):A("",!0)],64)):A("",!0)])],64))])):A("",!0),j.value==="permission_required"&&v.value?(a(),r("div",dp,[t("div",mp,[t("div",pp,[D[18]||(D[18]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[D[17]||(D[17]=t("strong",null,"Permission Request Cancelled",-1)),t("p",fp,b(S.value?.message||"Session was terminated before permission could be granted"),1)])])])])):A("",!0),n.toolCall.permissionDecision==="deny"?(a(),r("div",vp,[t("div",hp,[D[19]||(D[19]=ae(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),r("span",_p," - "+b(n.toolCall.result.message),1)):A("",!0)])])):A("",!0)])):A("",!0)],2))}},bp=oe(gp,[["__scopeId","data-v-cf42c263"]]);function An(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function yp(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Mn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function wp(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=yp(s.command),i=Mn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Mn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=An(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",i=s.description||"Task",l=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${l}`}case"Grep":case"Glob":{const o=s.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=s.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=s.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${An(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const $p={key:0,class:"tool-timeline-bar"},kp={class:"timeline-container"},Sp=["title","onClick","onKeydown"],Cp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const s=n,o=e,i=Oe(),l=ve(),c=_(()=>s.tools.map(($,k)=>({tool:$,originalIndex:k})).sort(($,k)=>{if($.tool.timestamp&&k.tool.timestamp){const y=new Date($.tool.timestamp).getTime(),m=new Date(k.tool.timestamp).getTime();if(y!==m)return y-m}return $.originalIndex-k.originalIndex}).map(({tool:$})=>$));function d($){const k=l.currentSessionId;if(!k)return $.status;const y=i.getBackendToolState(k,$.id);return y?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[y.state]||y.state:i.isToolUseOrphaned(k,$.id)?"orphaned":$.status}function p($){return $.result?.error||$.status==="error"||$.permissionDecision==="deny"}function f($){return d($)==="executing"}function u($){switch(d($)){case"completed":return p($)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w($){const k=wp($),y=d($),m={completed:p($)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[y]||y;return`${k} [${m}]`}function g($,k){o("segment-click",{tool:$,index:k})}return($,k)=>c.value.length>0?(a(),r("div",$p,[t("div",kp,[(a(!0),r(ce,null,de(c.value,(y,m)=>(a(),r("div",{key:y.id,class:ee(["timeline-segment",u(y)]),style:{flex:1},title:w(y),onClick:h=>g(y,m),role:"button",tabindex:"0",onKeydown:[Ke(h=>g(y,m),["enter"]),Ke(fe(h=>g(y,m),["prevent"]),["space"])]},[t("span",{class:ee(["segment-inner",{"executing-pulse":f(y)}])},null,2)],42,Sp))),128))])])):A("",!0)}},Ep=oe(Cp,[["__scopeId","data-v-4a85fba6"]]),Tp={class:"tool-footer-container"},xp={class:"tool-cards-list"},Ap={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=Oe(),o=ve(),i=_(()=>e.tools.map((c,d)=>({tool:c,originalIndex:d})).sort((c,d)=>{if(c.tool.timestamp&&d.tool.timestamp){const p=new Date(c.tool.timestamp).getTime(),f=new Date(d.tool.timestamp).getTime();if(p!==f)return p-f}return c.originalIndex-d.originalIndex}).map(({tool:c})=>c));async function l({tool:c}){const d=o.currentSessionId;if(!d)return;s.toggleToolExpansion(d,c.id),await st();const p=document.querySelector(`[data-tool-id="${c.id}"]`);p&&p.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,d)=>(a(),r("div",Tp,[be(Ep,{tools:n.tools,onSegmentClick:l},null,8,["tools"]),t("div",xp,[(a(!0),r(ce,null,de(i.value,p=>(a(),$e(bp,{key:p.id,toolCall:p,"data-tool-id":p.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Mp=oe(Ap,[["__scopeId","data-v-527d59ae"]]),Dp={class:"message-row message-row-assistant"},Op=["title"],Lp={class:"message-content-column"},Np={key:0,class:"thinking-block mb-2"},Ip=["innerHTML"],jp={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Oe(),o=ve();Qe.setOptions({breaks:!0,gfm:!0});const i=_(()=>qt(e.message.timestamp)),l=_(()=>e.message.metadata?.model||null),c=_(()=>{const k=i.value;return`assistant${l.value?`
Model: ${l.value}`:""}
${k}`}),d=_(()=>{const k=e.message.content||"";return k.trim().length>0&&k!=="Assistant response"}),p=_(()=>{const k=e.message.content||"";let y=Qe.parse(k);return y=y.replace(/\n</g,"<"),y=y.replace(/\n+$/,""),Ut.sanitize(y)}),f=_(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=_(()=>e.message.metadata?.thinking_content||""),w=_(()=>{const k=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,y=e.attachedTools&&e.attachedTools.length>0;return k||y}),g=_(()=>{const k=e.message.metadata?.tool_uses||[],y=e.attachedTools||[],m=[...k],h=new Set(k.map(v=>v.id));for(const v of y)h.has(v.id)||m.push(v);return m}),$=_(()=>{const k=o.currentSessionId;if(!k)return[];const y=s.toolCallsBySession.get(k)||[];return g.value.map(m=>{const h=y.find(v=>v.id===m.id);return h||{id:m.id,name:m.name,input:m.input,status:"pending",result:null,timestamp:m.timestamp||e.message.timestamp,isExpanded:!0}})});return(k,y)=>(a(),r("div",Dp,[t("div",{class:"message-speaker",title:c.value},[...y[0]||(y[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Op),t("div",Lp,[f.value?(a(),r("div",Np,[be(xa,{thinking:u.value},null,8,["thinking"])])):A("",!0),d.value?(a(),r("div",{key:1,class:"message-text",innerHTML:p.value},null,8,Ip)):A("",!0),w.value?(a(),$e(Mp,{key:2,tools:$.value},null,8,["tools"])):A("",!0)])]))}},Rp=oe(jp,[["__scopeId","data-v-2e32f6ef"]]),Pp={key:0,class:"message-row message-row-compaction"},Fp=["title"],Wp={class:"message-content-column"},Bp={class:"compaction-status-content"},Hp={class:"text-muted ms-auto"},Vp={key:1,class:"message-row message-row-system"},Up=["title"],qp={class:"message-content-column"},zp={class:"system-text"},Kp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>qt(e.message.timestamp)),o=_(()=>`system
${s.value}`),i=_(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(l,c)=>i.value?(a(),r("div",Pp,[t("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,Fp),t("div",Wp,[t("div",Bp,[c[1]||(c[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",Hp,b(s.value),1)])])])):(a(),r("div",Vp,[t("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,Up),t("div",qp,[t("span",zp,b(n.message.content),1)])]))}},Dn=oe(Kp,[["__scopeId","data-v-a078178f"]]),Gp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=_(()=>{switch(e.message.type){case"user":return wa;case"assistant":return Rp;case"system":return Dn;default:return Dn}});return(o,i)=>(a(),$e(ho(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Yp=oe(Gp,[["__scopeId","data-v-11dff525"]]);var Te="top",Le="bottom",Ne="right",xe="left",ms="auto",Nt=[Te,Le,Ne,xe],pt="start",Tt="end",So="clippingParents",Qs="viewport",yt="popper",Co="reference",Vs=Nt.reduce(function(n,e){return n.concat([e+"-"+pt,e+"-"+Tt])},[]),Xs=[].concat(Nt,[ms]).reduce(function(n,e){return n.concat([e,e+"-"+pt,e+"-"+Tt])},[]),Eo="beforeRead",To="read",xo="afterRead",Ao="beforeMain",Mo="main",Do="afterMain",Oo="beforeWrite",Lo="write",No="afterWrite",Io=[Eo,To,xo,Ao,Mo,Do,Oo,Lo,No];function ze(n){return n?(n.nodeName||"").toLowerCase():null}function Ie(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ft(n){var e=Ie(n).Element;return n instanceof e||n instanceof Element}function je(n){var e=Ie(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Zs(n){if(typeof ShadowRoot>"u")return!1;var e=Ie(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Jp(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},l=e.elements[s];!je(l)||!ze(l)||(Object.assign(l.style,o),Object.keys(i).forEach(function(c){var d=i[c];d===!1?l.removeAttribute(c):l.setAttribute(c,d===!0?"":d)}))})}function Qp(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],l=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),d=c.reduce(function(p,f){return p[f]="",p},{});!je(i)||!ze(i)||(Object.assign(i.style,d),Object.keys(l).forEach(function(p){i.removeAttribute(p)}))})}}const jo={name:"applyStyles",enabled:!0,phase:"write",fn:Jp,effect:Qp,requires:["computeStyles"]};function Ue(n){return n.split("-")[0]}var mt=Math.max,ls=Math.min,xt=Math.round;function Us(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ro(){return!/^((?!chrome|android).)*safari/i.test(Us())}function At(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,l=1;e&&je(n)&&(i=n.offsetWidth>0&&xt(o.width)/n.offsetWidth||1,l=n.offsetHeight>0&&xt(o.height)/n.offsetHeight||1);var c=ft(n)?Ie(n):window,d=c.visualViewport,p=!Ro()&&s,f=(o.left+(p&&d?d.offsetLeft:0))/i,u=(o.top+(p&&d?d.offsetTop:0))/l,w=o.width/i,g=o.height/l;return{width:w,height:g,top:u,right:f+w,bottom:u+g,left:f,x:f,y:u}}function en(n){var e=At(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Po(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Zs(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Xe(n){return Ie(n).getComputedStyle(n)}function Xp(n){return["table","td","th"].indexOf(ze(n))>=0}function rt(n){return((ft(n)?n.ownerDocument:n.document)||window.document).documentElement}function ps(n){return ze(n)==="html"?n:n.assignedSlot||n.parentNode||(Zs(n)?n.host:null)||rt(n)}function On(n){return!je(n)||Xe(n).position==="fixed"?null:n.offsetParent}function Zp(n){var e=/firefox/i.test(Us()),s=/Trident/i.test(Us());if(s&&je(n)){var o=Xe(n);if(o.position==="fixed")return null}var i=ps(n);for(Zs(i)&&(i=i.host);je(i)&&["html","body"].indexOf(ze(i))<0;){var l=Xe(i);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return i;i=i.parentNode}return null}function zt(n){for(var e=Ie(n),s=On(n);s&&Xp(s)&&Xe(s).position==="static";)s=On(s);return s&&(ze(s)==="html"||ze(s)==="body"&&Xe(s).position==="static")?e:s||Zp(n)||e}function tn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wt(n,e,s){return mt(n,ls(e,s))}function ef(n,e,s){var o=Wt(n,e,s);return o>s?s:o}function Fo(){return{top:0,right:0,bottom:0,left:0}}function Wo(n){return Object.assign({},Fo(),n)}function Bo(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var tf=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Wo(typeof e!="number"?e:Bo(e,Nt))};function sf(n){var e,s=n.state,o=n.name,i=n.options,l=s.elements.arrow,c=s.modifiersData.popperOffsets,d=Ue(s.placement),p=tn(d),f=[xe,Ne].indexOf(d)>=0,u=f?"height":"width";if(!(!l||!c)){var w=tf(i.padding,s),g=en(l),$=p==="y"?Te:xe,k=p==="y"?Le:Ne,y=s.rects.reference[u]+s.rects.reference[p]-c[p]-s.rects.popper[u],m=c[p]-s.rects.reference[p],h=zt(l),v=h?p==="y"?h.clientHeight||0:h.clientWidth||0:0,S=y/2-m/2,C=w[$],j=v-g[u]-w[k],F=v/2-g[u]/2+S,E=Wt(C,F,j),B=p;s.modifiersData[o]=(e={},e[B]=E,e.centerOffset=E-F,e)}}function nf(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Po(e.elements.popper,i)&&(e.elements.arrow=i))}const Ho={name:"arrow",enabled:!0,phase:"main",fn:sf,effect:nf,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Mt(n){return n.split("-")[1]}var of={top:"auto",right:"auto",bottom:"auto",left:"auto"};function af(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:xt(s*i)/i||0,y:xt(o*i)/i||0}}function Ln(n){var e,s=n.popper,o=n.popperRect,i=n.placement,l=n.variation,c=n.offsets,d=n.position,p=n.gpuAcceleration,f=n.adaptive,u=n.roundOffsets,w=n.isFixed,g=c.x,$=g===void 0?0:g,k=c.y,y=k===void 0?0:k,m=typeof u=="function"?u({x:$,y}):{x:$,y};$=m.x,y=m.y;var h=c.hasOwnProperty("x"),v=c.hasOwnProperty("y"),S=xe,C=Te,j=window;if(f){var F=zt(s),E="clientHeight",B="clientWidth";if(F===Ie(s)&&(F=rt(s),Xe(F).position!=="static"&&d==="absolute"&&(E="scrollHeight",B="scrollWidth")),F=F,i===Te||(i===xe||i===Ne)&&l===Tt){C=Le;var T=w&&F===j&&j.visualViewport?j.visualViewport.height:F[E];y-=T-o.height,y*=p?1:-1}if(i===xe||(i===Te||i===Le)&&l===Tt){S=Ne;var x=w&&F===j&&j.visualViewport?j.visualViewport.width:F[B];$-=x-o.width,$*=p?1:-1}}var z=Object.assign({position:d},f&&of),V=u===!0?af({x:$,y},Ie(s)):{x:$,y};if($=V.x,y=V.y,p){var N;return Object.assign({},z,(N={},N[C]=v?"0":"",N[S]=h?"0":"",N.transform=(j.devicePixelRatio||1)<=1?"translate("+$+"px, "+y+"px)":"translate3d("+$+"px, "+y+"px, 0)",N))}return Object.assign({},z,(e={},e[C]=v?y+"px":"",e[S]=h?$+"px":"",e.transform="",e))}function rf(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,l=s.adaptive,c=l===void 0?!0:l,d=s.roundOffsets,p=d===void 0?!0:d,f={placement:Ue(e.placement),variation:Mt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ln(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ln(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Vo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:rf,data:{}};var Xt={passive:!0};function lf(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,l=i===void 0?!0:i,c=o.resize,d=c===void 0?!0:c,p=Ie(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&f.forEach(function(u){u.addEventListener("scroll",s.update,Xt)}),d&&p.addEventListener("resize",s.update,Xt),function(){l&&f.forEach(function(u){u.removeEventListener("scroll",s.update,Xt)}),d&&p.removeEventListener("resize",s.update,Xt)}}const Uo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:lf,data:{}};var cf={left:"right",right:"left",bottom:"top",top:"bottom"};function is(n){return n.replace(/left|right|bottom|top/g,function(e){return cf[e]})}var uf={start:"end",end:"start"};function Nn(n){return n.replace(/start|end/g,function(e){return uf[e]})}function sn(n){var e=Ie(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function nn(n){return At(rt(n)).left+sn(n).scrollLeft}function df(n,e){var s=Ie(n),o=rt(n),i=s.visualViewport,l=o.clientWidth,c=o.clientHeight,d=0,p=0;if(i){l=i.width,c=i.height;var f=Ro();(f||!f&&e==="fixed")&&(d=i.offsetLeft,p=i.offsetTop)}return{width:l,height:c,x:d+nn(n),y:p}}function mf(n){var e,s=rt(n),o=sn(n),i=(e=n.ownerDocument)==null?void 0:e.body,l=mt(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=mt(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),d=-o.scrollLeft+nn(n),p=-o.scrollTop;return Xe(i||s).direction==="rtl"&&(d+=mt(s.clientWidth,i?i.clientWidth:0)-l),{width:l,height:c,x:d,y:p}}function on(n){var e=Xe(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function qo(n){return["html","body","#document"].indexOf(ze(n))>=0?n.ownerDocument.body:je(n)&&on(n)?n:qo(ps(n))}function Bt(n,e){var s;e===void 0&&(e=[]);var o=qo(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),l=Ie(o),c=i?[l].concat(l.visualViewport||[],on(o)?o:[]):o,d=e.concat(c);return i?d:d.concat(Bt(ps(c)))}function qs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function pf(n,e){var s=At(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function In(n,e,s){return e===Qs?qs(df(n,s)):ft(e)?pf(e,s):qs(mf(rt(n)))}function ff(n){var e=Bt(ps(n)),s=["absolute","fixed"].indexOf(Xe(n).position)>=0,o=s&&je(n)?zt(n):n;return ft(o)?e.filter(function(i){return ft(i)&&Po(i,o)&&ze(i)!=="body"}):[]}function vf(n,e,s,o){var i=e==="clippingParents"?ff(n):[].concat(e),l=[].concat(i,[s]),c=l[0],d=l.reduce(function(p,f){var u=In(n,f,o);return p.top=mt(u.top,p.top),p.right=ls(u.right,p.right),p.bottom=ls(u.bottom,p.bottom),p.left=mt(u.left,p.left),p},In(n,c,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function zo(n){var e=n.reference,s=n.element,o=n.placement,i=o?Ue(o):null,l=o?Mt(o):null,c=e.x+e.width/2-s.width/2,d=e.y+e.height/2-s.height/2,p;switch(i){case Te:p={x:c,y:e.y-s.height};break;case Le:p={x:c,y:e.y+e.height};break;case Ne:p={x:e.x+e.width,y:d};break;case xe:p={x:e.x-s.width,y:d};break;default:p={x:e.x,y:e.y}}var f=i?tn(i):null;if(f!=null){var u=f==="y"?"height":"width";switch(l){case pt:p[f]=p[f]-(e[u]/2-s[u]/2);break;case Tt:p[f]=p[f]+(e[u]/2-s[u]/2);break}}return p}function Dt(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,l=s.strategy,c=l===void 0?n.strategy:l,d=s.boundary,p=d===void 0?So:d,f=s.rootBoundary,u=f===void 0?Qs:f,w=s.elementContext,g=w===void 0?yt:w,$=s.altBoundary,k=$===void 0?!1:$,y=s.padding,m=y===void 0?0:y,h=Wo(typeof m!="number"?m:Bo(m,Nt)),v=g===yt?Co:yt,S=n.rects.popper,C=n.elements[k?v:g],j=vf(ft(C)?C:C.contextElement||rt(n.elements.popper),p,u,c),F=At(n.elements.reference),E=zo({reference:F,element:S,placement:i}),B=qs(Object.assign({},S,E)),T=g===yt?B:F,x={top:j.top-T.top+h.top,bottom:T.bottom-j.bottom+h.bottom,left:j.left-T.left+h.left,right:T.right-j.right+h.right},z=n.modifiersData.offset;if(g===yt&&z){var V=z[i];Object.keys(x).forEach(function(N){var H=[Ne,Le].indexOf(N)>=0?1:-1,K=[Te,Le].indexOf(N)>=0?"y":"x";x[N]+=V[K]*H})}return x}function hf(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,l=s.rootBoundary,c=s.padding,d=s.flipVariations,p=s.allowedAutoPlacements,f=p===void 0?Xs:p,u=Mt(o),w=u?d?Vs:Vs.filter(function(k){return Mt(k)===u}):Nt,g=w.filter(function(k){return f.indexOf(k)>=0});g.length===0&&(g=w);var $=g.reduce(function(k,y){return k[y]=Dt(n,{placement:y,boundary:i,rootBoundary:l,padding:c})[Ue(y)],k},{});return Object.keys($).sort(function(k,y){return $[k]-$[y]})}function _f(n){if(Ue(n)===ms)return[];var e=is(n);return[Nn(n),e,Nn(e)]}function gf(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,l=i===void 0?!0:i,c=s.altAxis,d=c===void 0?!0:c,p=s.fallbackPlacements,f=s.padding,u=s.boundary,w=s.rootBoundary,g=s.altBoundary,$=s.flipVariations,k=$===void 0?!0:$,y=s.allowedAutoPlacements,m=e.options.placement,h=Ue(m),v=h===m,S=p||(v||!k?[is(m)]:_f(m)),C=[m].concat(S).reduce(function(re,q){return re.concat(Ue(q)===ms?hf(e,{placement:q,boundary:u,rootBoundary:w,padding:f,flipVariations:k,allowedAutoPlacements:y}):q)},[]),j=e.rects.reference,F=e.rects.popper,E=new Map,B=!0,T=C[0],x=0;x<C.length;x++){var z=C[x],V=Ue(z),N=Mt(z)===pt,H=[Te,Le].indexOf(V)>=0,K=H?"width":"height",Y=Dt(e,{placement:z,boundary:u,rootBoundary:w,altBoundary:g,padding:f}),I=H?N?Ne:xe:N?Le:Te;j[K]>F[K]&&(I=is(I));var P=is(I),G=[];if(l&&G.push(Y[V]<=0),d&&G.push(Y[I]<=0,Y[P]<=0),G.every(function(re){return re})){T=z,B=!1;break}E.set(z,G)}if(B)for(var te=k?3:1,ne=function(q){var D=C.find(function(M){var O=E.get(M);if(O)return O.slice(0,q).every(function(L){return L})});if(D)return T=D,"break"},se=te;se>0;se--){var he=ne(se);if(he==="break")break}e.placement!==T&&(e.modifiersData[o]._skip=!0,e.placement=T,e.reset=!0)}}const Ko={name:"flip",enabled:!0,phase:"main",fn:gf,requiresIfExists:["offset"],data:{_skip:!1}};function jn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Rn(n){return[Te,Ne,Le,xe].some(function(e){return n[e]>=0})}function bf(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,l=e.modifiersData.preventOverflow,c=Dt(e,{elementContext:"reference"}),d=Dt(e,{altBoundary:!0}),p=jn(c,o),f=jn(d,i,l),u=Rn(p),w=Rn(f);e.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:f,isReferenceHidden:u,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":w})}const Go={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:bf};function yf(n,e,s){var o=Ue(n),i=[xe,Te].indexOf(o)>=0?-1:1,l=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,c=l[0],d=l[1];return c=c||0,d=(d||0)*i,[xe,Ne].indexOf(o)>=0?{x:d,y:c}:{x:c,y:d}}function wf(n){var e=n.state,s=n.options,o=n.name,i=s.offset,l=i===void 0?[0,0]:i,c=Xs.reduce(function(u,w){return u[w]=yf(w,e.rects,l),u},{}),d=c[e.placement],p=d.x,f=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=c}const Yo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:wf};function $f(n){var e=n.state,s=n.name;e.modifiersData[s]=zo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Jo={name:"popperOffsets",enabled:!0,phase:"read",fn:$f,data:{}};function kf(n){return n==="x"?"y":"x"}function Sf(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,l=i===void 0?!0:i,c=s.altAxis,d=c===void 0?!1:c,p=s.boundary,f=s.rootBoundary,u=s.altBoundary,w=s.padding,g=s.tether,$=g===void 0?!0:g,k=s.tetherOffset,y=k===void 0?0:k,m=Dt(e,{boundary:p,rootBoundary:f,padding:w,altBoundary:u}),h=Ue(e.placement),v=Mt(e.placement),S=!v,C=tn(h),j=kf(C),F=e.modifiersData.popperOffsets,E=e.rects.reference,B=e.rects.popper,T=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,x=typeof T=="number"?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),z=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,V={x:0,y:0};if(F){if(l){var N,H=C==="y"?Te:xe,K=C==="y"?Le:Ne,Y=C==="y"?"height":"width",I=F[C],P=I+m[H],G=I-m[K],te=$?-B[Y]/2:0,ne=v===pt?E[Y]:B[Y],se=v===pt?-B[Y]:-E[Y],he=e.elements.arrow,re=$&&he?en(he):{width:0,height:0},q=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Fo(),D=q[H],M=q[K],O=Wt(0,E[Y],re[Y]),L=S?E[Y]/2-te-O-D-x.mainAxis:ne-O-D-x.mainAxis,U=S?-E[Y]/2+te+O+M+x.mainAxis:se+O+M+x.mainAxis,X=e.elements.arrow&&zt(e.elements.arrow),pe=X?C==="y"?X.clientTop||0:X.clientLeft||0:0,De=(N=z?.[C])!=null?N:0,Q=I+L-De-pe,W=I+U-De,Z=Wt($?ls(P,Q):P,I,$?mt(G,W):G);F[C]=Z,V[C]=Z-I}if(d){var ie,me=C==="x"?Te:xe,Ce=C==="x"?Le:Ne,Ee=F[j],Qt=j==="y"?"height":"width",fn=Ee+m[me],vn=Ee-m[Ce],ys=[Te,xe].indexOf(h)!==-1,hn=(ie=z?.[j])!=null?ie:0,_n=ys?fn:Ee-E[Qt]-B[Qt]-hn+x.altAxis,gn=ys?Ee+E[Qt]+B[Qt]-hn-x.altAxis:vn,bn=$&&ys?ef(_n,Ee,gn):Wt($?_n:fn,Ee,$?gn:vn);F[j]=bn,V[j]=bn-Ee}e.modifiersData[o]=V}}const Qo={name:"preventOverflow",enabled:!0,phase:"main",fn:Sf,requiresIfExists:["offset"]};function Cf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Ef(n){return n===Ie(n)||!je(n)?sn(n):Cf(n)}function Tf(n){var e=n.getBoundingClientRect(),s=xt(e.width)/n.offsetWidth||1,o=xt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function xf(n,e,s){s===void 0&&(s=!1);var o=je(e),i=je(e)&&Tf(e),l=rt(e),c=At(n,i,s),d={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!s)&&((ze(e)!=="body"||on(l))&&(d=Ef(e)),je(e)?(p=At(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):l&&(p.x=nn(l))),{x:c.left+d.scrollLeft-p.x,y:c.top+d.scrollTop-p.y,width:c.width,height:c.height}}function Af(n){var e=new Map,s=new Set,o=[];n.forEach(function(l){e.set(l.name,l)});function i(l){s.add(l.name);var c=[].concat(l.requires||[],l.requiresIfExists||[]);c.forEach(function(d){if(!s.has(d)){var p=e.get(d);p&&i(p)}}),o.push(l)}return n.forEach(function(l){s.has(l.name)||i(l)}),o}function Mf(n){var e=Af(n);return Io.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function Df(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Of(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Pn={placement:"bottom",modifiers:[],strategy:"absolute"};function Fn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Xo(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,l=i===void 0?Pn:i;return function(d,p,f){f===void 0&&(f=l);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pn,l),modifiersData:{},elements:{reference:d,popper:p},attributes:{},styles:{}},w=[],g=!1,$={state:u,setOptions:function(h){var v=typeof h=="function"?h(u.options):h;y(),u.options=Object.assign({},l,u.options,v),u.scrollParents={reference:ft(d)?Bt(d):d.contextElement?Bt(d.contextElement):[],popper:Bt(p)};var S=Mf(Of([].concat(o,u.options.modifiers)));return u.orderedModifiers=S.filter(function(C){return C.enabled}),k(),$.update()},forceUpdate:function(){if(!g){var h=u.elements,v=h.reference,S=h.popper;if(Fn(v,S)){u.rects={reference:xf(v,zt(S),u.options.strategy==="fixed"),popper:en(S)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(x){return u.modifiersData[x.name]=Object.assign({},x.data)});for(var C=0;C<u.orderedModifiers.length;C++){if(u.reset===!0){u.reset=!1,C=-1;continue}var j=u.orderedModifiers[C],F=j.fn,E=j.options,B=E===void 0?{}:E,T=j.name;typeof F=="function"&&(u=F({state:u,options:B,name:T,instance:$})||u)}}}},update:Df(function(){return new Promise(function(m){$.forceUpdate(),m(u)})}),destroy:function(){y(),g=!0}};if(!Fn(d,p))return $;$.setOptions(f).then(function(m){!g&&f.onFirstUpdate&&f.onFirstUpdate(m)});function k(){u.orderedModifiers.forEach(function(m){var h=m.name,v=m.options,S=v===void 0?{}:v,C=m.effect;if(typeof C=="function"){var j=C({state:u,name:h,instance:$,options:S}),F=function(){};w.push(j||F)}})}function y(){w.forEach(function(m){return m()}),w=[]}return $}}var Lf=[Uo,Jo,Vo,jo,Yo,Ko,Qo,Ho,Go],an=Xo({defaultModifiers:Lf});const Zo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Do,afterRead:xo,afterWrite:No,applyStyles:jo,arrow:Ho,auto:ms,basePlacements:Nt,beforeMain:Ao,beforeRead:Eo,beforeWrite:Oo,bottom:Le,clippingParents:So,computeStyles:Vo,createPopper:an,detectOverflow:Dt,end:Tt,eventListeners:Uo,flip:Ko,hide:Go,left:xe,main:Mo,modifierPhases:Io,offset:Yo,placements:Xs,popper:yt,popperGenerator:Xo,popperOffsets:Jo,preventOverflow:Qo,read:To,reference:Co,right:Ne,start:pt,top:Te,variationPlacements:Vs,viewport:Qs,write:Lo},Symbol.toStringTag,{value:"Module"}));const tt=new Map,Ts={set(n,e,s){tt.has(n)||tt.set(n,new Map);const o=tt.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return tt.has(n)&&tt.get(n).get(e)||null},remove(n,e){if(!tt.has(n))return;const s=tt.get(n);s.delete(e),s.size===0&&tt.delete(n)}},Nf=1e6,If=1e3,zs="transitionend",ei=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),jf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Rf=n=>{do n+=Math.floor(Math.random()*Nf);while(document.getElementById(n));return n},Pf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*If)},ti=n=>{n.dispatchEvent(new Event(zs))},Ye=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),nt=n=>Ye(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ei(n)):null,It=n=>{if(!Ye(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},ot=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",si=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?si(n.parentNode):null},cs=()=>{},Kt=n=>{n.offsetHeight},ni=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,xs=[],Ff=n=>{document.readyState==="loading"?(xs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of xs)e()}),xs.push(n)):n()},Re=()=>document.documentElement.dir==="rtl",We=n=>{Ff(()=>{const e=ni();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ae=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,oi=(n,e,s=!0)=>{if(!s){Ae(n);return}const i=Pf(e)+5;let l=!1;const c=({target:d})=>{d===e&&(l=!0,e.removeEventListener(zs,c),Ae(n))};e.addEventListener(zs,c),setTimeout(()=>{l||ti(e)},i)},rn=(n,e,s,o)=>{const i=n.length;let l=n.indexOf(e);return l===-1?!s&&o?n[i-1]:n[0]:(l+=s?1:-1,o&&(l=(l+i)%i),n[Math.max(0,Math.min(l,i-1))])},Wf=/[^.]*(?=\..*)\.|.*/,Bf=/\..*/,Hf=/::\d+$/,As={};let Wn=1;const ii={mouseenter:"mouseover",mouseleave:"mouseout"},Vf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ai(n,e){return e&&`${e}::${Wn++}`||n.uidEvent||Wn++}function ri(n){const e=ai(n);return n.uidEvent=e,As[e]=As[e]||{},As[e]}function Uf(n,e){return function s(o){return ln(o,{delegateTarget:n}),s.oneOff&&J.off(n,o.type,e),e.apply(n,[o])}}function qf(n,e,s){return function o(i){const l=n.querySelectorAll(e);for(let{target:c}=i;c&&c!==this;c=c.parentNode)for(const d of l)if(d===c)return ln(i,{delegateTarget:c}),o.oneOff&&J.off(n,i.type,e,s),s.apply(c,[i])}}function li(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ci(n,e,s){const o=typeof e=="string",i=o?s:e||s;let l=ui(n);return Vf.has(l)||(l=n),[o,i,l]}function Bn(n,e,s,o,i){if(typeof e!="string"||!n)return;let[l,c,d]=ci(e,s,o);e in ii&&(c=(k=>function(y){if(!y.relatedTarget||y.relatedTarget!==y.delegateTarget&&!y.delegateTarget.contains(y.relatedTarget))return k.call(this,y)})(c));const p=ri(n),f=p[d]||(p[d]={}),u=li(f,c,l?s:null);if(u){u.oneOff=u.oneOff&&i;return}const w=ai(c,e.replace(Wf,"")),g=l?qf(n,s,c):Uf(n,c);g.delegationSelector=l?s:null,g.callable=c,g.oneOff=i,g.uidEvent=w,f[w]=g,n.addEventListener(d,g,l)}function Ks(n,e,s,o,i){const l=li(e[s],o,i);l&&(n.removeEventListener(s,l,!!i),delete e[s][l.uidEvent])}function zf(n,e,s,o){const i=e[s]||{};for(const[l,c]of Object.entries(i))l.includes(o)&&Ks(n,e,s,c.callable,c.delegationSelector)}function ui(n){return n=n.replace(Bf,""),ii[n]||n}const J={on(n,e,s,o){Bn(n,e,s,o,!1)},one(n,e,s,o){Bn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,l,c]=ci(e,s,o),d=c!==e,p=ri(n),f=p[c]||{},u=e.startsWith(".");if(typeof l<"u"){if(!Object.keys(f).length)return;Ks(n,p,c,l,i?s:null);return}if(u)for(const w of Object.keys(p))zf(n,p,w,e.slice(1));for(const[w,g]of Object.entries(f)){const $=w.replace(Hf,"");(!d||e.includes($))&&Ks(n,p,c,g.callable,g.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=ni(),i=ui(e),l=e!==i;let c=null,d=!0,p=!0,f=!1;l&&o&&(c=o.Event(e,s),o(n).trigger(c),d=!c.isPropagationStopped(),p=!c.isImmediatePropagationStopped(),f=c.isDefaultPrevented());const u=ln(new Event(e,{bubbles:d,cancelable:!0}),s);return f&&u.preventDefault(),p&&n.dispatchEvent(u),u.defaultPrevented&&c&&c.preventDefault(),u}};function ln(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Hn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Ms(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Je={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Ms(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Ms(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Hn(n.dataset[o])}return e},getDataAttribute(n,e){return Hn(n.getAttribute(`data-bs-${Ms(e)}`))}};class Gt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Ye(s)?Je.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ye(s)?Je.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const l=e[o],c=Ye(l)?"element":jf(l);if(!new RegExp(i).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${i}".`)}}}const Kf="5.3.8";class He extends Gt{constructor(e,s){super(),e=nt(e),e&&(this._element=e,this._config=this._getConfig(s),Ts.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Ts.remove(this._element,this.constructor.DATA_KEY),J.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){oi(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Ts.get(nt(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Kf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ds=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ei(s)).join(","):null},ue={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!ot(s)&&It(s))},getSelectorFromElement(n){const e=Ds(n);return e&&ue.findOne(e)?e:null},getElementFromSelector(n){const e=Ds(n);return e?ue.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ds(n);return e?ue.find(e):[]}},fs=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;J.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),ot(this))return;const l=ue.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(l)[e]()})},Gf="alert",Yf="bs.alert",di=`.${Yf}`,Jf=`close${di}`,Qf=`closed${di}`,Xf="fade",Zf="show";class vs extends He{static get NAME(){return Gf}close(){if(J.trigger(this._element,Jf).defaultPrevented)return;this._element.classList.remove(Zf);const s=this._element.classList.contains(Xf);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),J.trigger(this._element,Qf),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=vs.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}fs(vs,"close");We(vs);const ev="button",tv="bs.button",sv=`.${tv}`,nv=".data-api",ov="active",Vn='[data-bs-toggle="button"]',iv=`click${sv}${nv}`;class hs extends He{static get NAME(){return ev}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(ov))}static jQueryInterface(e){return this.each(function(){const s=hs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}J.on(document,iv,Vn,n=>{n.preventDefault();const e=n.target.closest(Vn);hs.getOrCreateInstance(e).toggle()});We(hs);const av="swipe",jt=".bs.swipe",rv=`touchstart${jt}`,lv=`touchmove${jt}`,cv=`touchend${jt}`,uv=`pointerdown${jt}`,dv=`pointerup${jt}`,mv="touch",pv="pen",fv="pointer-event",vv=40,hv={endCallback:null,leftCallback:null,rightCallback:null},_v={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class us extends Gt{constructor(e,s){super(),this._element=e,!(!e||!us.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return hv}static get DefaultType(){return _v}static get NAME(){return av}dispose(){J.off(this._element,jt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ae(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=vv)return;const s=e/this._deltaX;this._deltaX=0,s&&Ae(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(J.on(this._element,uv,e=>this._start(e)),J.on(this._element,dv,e=>this._end(e)),this._element.classList.add(fv)):(J.on(this._element,rv,e=>this._start(e)),J.on(this._element,lv,e=>this._move(e)),J.on(this._element,cv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===pv||e.pointerType===mv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const gv="carousel",bv="bs.carousel",lt=`.${bv}`,mi=".data-api",yv="ArrowLeft",wv="ArrowRight",$v=500,Pt="next",gt="prev",wt="left",as="right",kv=`slide${lt}`,Os=`slid${lt}`,Sv=`keydown${lt}`,Cv=`mouseenter${lt}`,Ev=`mouseleave${lt}`,Tv=`dragstart${lt}`,xv=`load${lt}${mi}`,Av=`click${lt}${mi}`,pi="carousel",Zt="active",Mv="slide",Dv="carousel-item-end",Ov="carousel-item-start",Lv="carousel-item-next",Nv="carousel-item-prev",fi=".active",vi=".carousel-item",Iv=fi+vi,jv=".carousel-item img",Rv=".carousel-indicators",Pv="[data-bs-slide], [data-bs-slide-to]",Fv='[data-bs-ride="carousel"]',Wv={[yv]:as,[wv]:wt},Bv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Hv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Yt extends He{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ue.findOne(Rv,this._element),this._addEventListeners(),this._config.ride===pi&&this.cycle()}static get Default(){return Bv}static get DefaultType(){return Hv}static get NAME(){return gv}next(){this._slide(Pt)}nextWhenVisible(){!document.hidden&&It(this._element)&&this.next()}prev(){this._slide(gt)}pause(){this._isSliding&&ti(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){J.one(this._element,Os,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){J.one(this._element,Os,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Pt:gt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&J.on(this._element,Sv,e=>this._keydown(e)),this._config.pause==="hover"&&(J.on(this._element,Cv,()=>this.pause()),J.on(this._element,Ev,()=>this._maybeEnableCycle())),this._config.touch&&us.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ue.find(jv,this._element))J.on(o,Tv,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(wt)),rightCallback:()=>this._slide(this._directionToOrder(as)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),$v+this._config.interval))}};this._swipeHelper=new us(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Wv[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=ue.findOne(fi,this._indicatorsElement);s.classList.remove(Zt),s.removeAttribute("aria-current");const o=ue.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Zt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===Pt,l=s||rn(this._getItems(),o,i,this._config.wrap);if(l===o)return;const c=this._getItemIndex(l),d=$=>J.trigger(this._element,$,{relatedTarget:l,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(d(kv).defaultPrevented||!o||!l)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=l;const u=i?Ov:Dv,w=i?Lv:Nv;l.classList.add(w),Kt(l),o.classList.add(u),l.classList.add(u);const g=()=>{l.classList.remove(u,w),l.classList.add(Zt),o.classList.remove(Zt,w,u),this._isSliding=!1,d(Os)};this._queueCallback(g,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(Mv)}_getActive(){return ue.findOne(Iv,this._element)}_getItems(){return ue.find(vi,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Re()?e===wt?gt:Pt:e===wt?Pt:gt}_orderToDirection(e){return Re()?e===gt?wt:as:e===gt?as:wt}static jQueryInterface(e){return this.each(function(){const s=Yt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,Av,Pv,function(n){const e=ue.getElementFromSelector(this);if(!e||!e.classList.contains(pi))return;n.preventDefault();const s=Yt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Je.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});J.on(window,xv,()=>{const n=ue.find(Fv);for(const e of n)Yt.getOrCreateInstance(e)});We(Yt);const Vv="collapse",Uv="bs.collapse",Jt=`.${Uv}`,qv=".data-api",zv=`show${Jt}`,Kv=`shown${Jt}`,Gv=`hide${Jt}`,Yv=`hidden${Jt}`,Jv=`click${Jt}${qv}`,Ls="show",kt="collapse",es="collapsing",Qv="collapsed",Xv=`:scope .${kt} .${kt}`,Zv="collapse-horizontal",eh="width",th="height",sh=".collapse.show, .collapse.collapsing",Gs='[data-bs-toggle="collapse"]',nh={parent:null,toggle:!0},oh={parent:"(null|element)",toggle:"boolean"};class Ot extends He{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=ue.find(Gs);for(const i of o){const l=ue.getSelectorFromElement(i),c=ue.find(l).filter(d=>d===this._element);l!==null&&c.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return nh}static get DefaultType(){return oh}static get NAME(){return Vv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(sh).filter(d=>d!==this._element).map(d=>Ot.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||J.trigger(this._element,zv).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(kt),this._element.classList.add(es),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(es),this._element.classList.add(kt,Ls),this._element.style[o]="",J.trigger(this._element,Kv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||J.trigger(this._element,Gv).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Kt(this._element),this._element.classList.add(es),this._element.classList.remove(kt,Ls);for(const i of this._triggerArray){const l=ue.getElementFromSelector(i);l&&!this._isShown(l)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(es),this._element.classList.add(kt),J.trigger(this._element,Yv)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ls)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=nt(e.parent),e}_getDimension(){return this._element.classList.contains(Zv)?eh:th}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Gs);for(const s of e){const o=ue.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=ue.find(Xv,this._config.parent);return ue.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Qv,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Ot.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}J.on(document,Jv,Gs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ue.getMultipleElementsFromSelector(this))Ot.getOrCreateInstance(e,{toggle:!1}).toggle()});We(Ot);const Un="dropdown",ih="bs.dropdown",ht=`.${ih}`,cn=".data-api",ah="Escape",qn="Tab",rh="ArrowUp",zn="ArrowDown",lh=2,ch=`hide${ht}`,uh=`hidden${ht}`,dh=`show${ht}`,mh=`shown${ht}`,hi=`click${ht}${cn}`,_i=`keydown${ht}${cn}`,ph=`keyup${ht}${cn}`,$t="show",fh="dropup",vh="dropend",hh="dropstart",_h="dropup-center",gh="dropdown-center",ut='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',bh=`${ut}.${$t}`,rs=".dropdown-menu",yh=".navbar",wh=".navbar-nav",$h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",kh=Re()?"top-end":"top-start",Sh=Re()?"top-start":"top-end",Ch=Re()?"bottom-end":"bottom-start",Eh=Re()?"bottom-start":"bottom-end",Th=Re()?"left-start":"right-start",xh=Re()?"right-start":"left-start",Ah="top",Mh="bottom",Dh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Oh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class qe extends He{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=ue.next(this._element,rs)[0]||ue.prev(this._element,rs)[0]||ue.findOne(rs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Dh}static get DefaultType(){return Oh}static get NAME(){return Un}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ot(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!J.trigger(this._element,dh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(wh))for(const o of[].concat(...document.body.children))J.on(o,"mouseover",cs);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add($t),this._element.classList.add($t),J.trigger(this._element,mh,e)}}hide(){if(ot(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!J.trigger(this._element,ch,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))J.off(o,"mouseover",cs);this._popper&&this._popper.destroy(),this._menu.classList.remove($t),this._element.classList.remove($t),this._element.setAttribute("aria-expanded","false"),Je.removeDataAttribute(this._menu,"popper"),J.trigger(this._element,uh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ye(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Un.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Zo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ye(this._config.reference)?e=nt(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=an(e,this._menu,s)}_isShown(){return this._menu.classList.contains($t)}_getPlacement(){const e=this._parent;if(e.classList.contains(vh))return Th;if(e.classList.contains(hh))return xh;if(e.classList.contains(_h))return Ah;if(e.classList.contains(gh))return Mh;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(fh)?s?Sh:kh:s?Eh:Ch}_detectNavbar(){return this._element.closest(yh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Je.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ae(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=ue.find($h,this._menu).filter(i=>It(i));o.length&&rn(o,s,e===zn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===lh||e.type==="keyup"&&e.key!==qn)return;const s=ue.find(bh);for(const o of s){const i=qe.getInstance(o);if(!i||i._config.autoClose===!1)continue;const l=e.composedPath(),c=l.includes(i._menu);if(l.includes(i._element)||i._config.autoClose==="inside"&&!c||i._config.autoClose==="outside"&&c||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===qn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:i._element};e.type==="click"&&(d.clickEvent=e),i._completeHide(d)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===ah,i=[rh,zn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const l=this.matches(ut)?this:ue.prev(this,ut)[0]||ue.next(this,ut)[0]||ue.findOne(ut,e.delegateTarget.parentNode),c=qe.getOrCreateInstance(l);if(i){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),l.focus())}}J.on(document,_i,ut,qe.dataApiKeydownHandler);J.on(document,_i,rs,qe.dataApiKeydownHandler);J.on(document,hi,qe.clearMenus);J.on(document,ph,qe.clearMenus);J.on(document,hi,ut,function(n){n.preventDefault(),qe.getOrCreateInstance(this).toggle()});We(qe);const gi="backdrop",Lh="fade",Kn="show",Gn=`mousedown.bs.${gi}`,Nh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Ih={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class bi extends Gt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Nh}static get DefaultType(){return Ih}static get NAME(){return gi}show(e){if(!this._config.isVisible){Ae(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Kt(s),s.classList.add(Kn),this._emulateAnimation(()=>{Ae(e)})}hide(e){if(!this._config.isVisible){Ae(e);return}this._getElement().classList.remove(Kn),this._emulateAnimation(()=>{this.dispose(),Ae(e)})}dispose(){this._isAppended&&(J.off(this._element,Gn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Lh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=nt(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),J.on(e,Gn,()=>{Ae(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){oi(e,this._getElement(),this._config.isAnimated)}}const jh="focustrap",Rh="bs.focustrap",ds=`.${Rh}`,Ph=`focusin${ds}`,Fh=`keydown.tab${ds}`,Wh="Tab",Bh="forward",Yn="backward",Hh={autofocus:!0,trapElement:null},Vh={autofocus:"boolean",trapElement:"element"};class yi extends Gt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Hh}static get DefaultType(){return Vh}static get NAME(){return jh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),J.off(document,ds),J.on(document,Ph,e=>this._handleFocusin(e)),J.on(document,Fh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,J.off(document,ds))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=ue.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Yn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Wh&&(this._lastTabNavDirection=e.shiftKey?Yn:Bh)}}const Jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Qn=".sticky-top",ts="padding-right",Xn="margin-right";class Ys{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ts,s=>s+e),this._setElementAttributes(Jn,ts,s=>s+e),this._setElementAttributes(Qn,Xn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ts),this._resetElementAttributes(Jn,ts),this._resetElementAttributes(Qn,Xn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),l=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+i)return;this._saveInitialAttribute(c,s);const d=window.getComputedStyle(c).getPropertyValue(s);c.style.setProperty(s,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,l)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Je.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const l=Je.getDataAttribute(i,s);if(l===null){i.style.removeProperty(s);return}Je.removeDataAttribute(i,s),i.style.setProperty(s,l)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Ye(e)){s(e);return}for(const o of ue.find(e,this._element))s(o)}}const Uh="modal",qh="bs.modal",Pe=`.${qh}`,zh=".data-api",Kh="Escape",Gh=`hide${Pe}`,Yh=`hidePrevented${Pe}`,wi=`hidden${Pe}`,$i=`show${Pe}`,Jh=`shown${Pe}`,Qh=`resize${Pe}`,Xh=`click.dismiss${Pe}`,Zh=`mousedown.dismiss${Pe}`,e_=`keydown.dismiss${Pe}`,t_=`click${Pe}${zh}`,Zn="modal-open",s_="fade",eo="show",Ns="modal-static",n_=".modal.show",o_=".modal-dialog",i_=".modal-body",a_='[data-bs-toggle="modal"]',r_={backdrop:!0,focus:!0,keyboard:!0},l_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class vt extends He{constructor(e,s){super(e,s),this._dialog=ue.findOne(o_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Ys,this._addEventListeners()}static get Default(){return r_}static get DefaultType(){return l_}static get NAME(){return Uh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||J.trigger(this._element,$i,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Zn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||J.trigger(this._element,Gh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(eo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){J.off(window,Pe),J.off(this._dialog,Pe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new bi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new yi({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=ue.findOne(i_,this._dialog);s&&(s.scrollTop=0),Kt(this._element),this._element.classList.add(eo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,J.trigger(this._element,Jh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){J.on(this._element,e_,e=>{if(e.key===Kh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),J.on(window,Qh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),J.on(this._element,Zh,e=>{J.one(this._element,Xh,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Zn),this._resetAdjustments(),this._scrollBar.reset(),J.trigger(this._element,wi)})}_isAnimated(){return this._element.classList.contains(s_)}_triggerBackdropTransition(){if(J.trigger(this._element,Yh).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ns)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Ns),this._queueCallback(()=>{this._element.classList.remove(Ns),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=Re()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=Re()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=vt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}J.on(document,t_,a_,function(n){const e=ue.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),J.one(e,$i,i=>{i.defaultPrevented||J.one(e,wi,()=>{It(this)&&this.focus()})});const s=ue.findOne(n_);s&&vt.getInstance(s).hide(),vt.getOrCreateInstance(e).toggle(this)});fs(vt);We(vt);const c_="offcanvas",u_="bs.offcanvas",et=`.${u_}`,ki=".data-api",d_=`load${et}${ki}`,m_="Escape",to="show",so="showing",no="hiding",p_="offcanvas-backdrop",Si=".offcanvas.show",f_=`show${et}`,v_=`shown${et}`,h_=`hide${et}`,oo=`hidePrevented${et}`,Ci=`hidden${et}`,__=`resize${et}`,g_=`click${et}${ki}`,b_=`keydown.dismiss${et}`,y_='[data-bs-toggle="offcanvas"]',w_={backdrop:!0,keyboard:!0,scroll:!1},$_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class it extends He{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return w_}static get DefaultType(){return $_}static get NAME(){return c_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||J.trigger(this._element,f_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Ys().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(so);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(to),this._element.classList.remove(so),J.trigger(this._element,v_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||J.trigger(this._element,h_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(no),this._backdrop.hide();const s=()=>{this._element.classList.remove(to,no),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Ys().reset(),J.trigger(this._element,Ci)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){J.trigger(this._element,oo);return}this.hide()},s=!!this._config.backdrop;return new bi({className:p_,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new yi({trapElement:this._element})}_addEventListeners(){J.on(this._element,b_,e=>{if(e.key===m_){if(this._config.keyboard){this.hide();return}J.trigger(this._element,oo)}})}static jQueryInterface(e){return this.each(function(){const s=it.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}J.on(document,g_,y_,function(n){const e=ue.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ot(this))return;J.one(e,Ci,()=>{It(this)&&this.focus()});const s=ue.findOne(Si);s&&s!==e&&it.getInstance(s).hide(),it.getOrCreateInstance(e).toggle(this)});J.on(window,d_,()=>{for(const n of ue.find(Si))it.getOrCreateInstance(n).show()});J.on(window,__,()=>{for(const n of ue.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&it.getOrCreateInstance(n).hide()});fs(it);We(it);const k_=/^aria-[\w-]*$/i,Ei={"*":["class","dir","id","lang","role",k_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},S_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),C_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,E_=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?S_.has(s)?!!C_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function T_(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),l=[].concat(...i.body.querySelectorAll("*"));for(const c of l){const d=c.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){c.remove();continue}const p=[].concat(...c.attributes),f=[].concat(e["*"]||[],e[d]||[]);for(const u of p)E_(u,f)||c.removeAttribute(u.nodeName)}return i.body.innerHTML}const x_="TemplateFactory",A_={allowList:Ei,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},M_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},D_={entry:"(string|element|function|null)",selector:"(string|element)"};class O_ extends Gt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return A_}static get DefaultType(){return M_}static get NAME(){return x_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,l]of Object.entries(this._config.content))this._setContent(e,l,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},D_)}_setContent(e,s,o){const i=ue.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(Ye(s)){this._putElementInTemplate(nt(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?T_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ae(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const L_="tooltip",N_=new Set(["sanitize","allowList","sanitizeFn"]),Is="fade",I_="modal",ss="show",j_=".tooltip-inner",io=`.${I_}`,ao="hide.bs.modal",Ft="hover",js="focus",Rs="click",R_="manual",P_="hide",F_="hidden",W_="show",B_="shown",H_="inserted",V_="click",U_="focusin",q_="focusout",z_="mouseenter",K_="mouseleave",G_={AUTO:"auto",TOP:"top",RIGHT:Re()?"left":"right",BOTTOM:"bottom",LEFT:Re()?"right":"left"},Y_={allowList:Ei,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},J_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Rt extends He{constructor(e,s){if(typeof Zo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Y_}static get DefaultType(){return J_}static get NAME(){return L_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),J.off(this._element.closest(io),ao,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=J.trigger(this._element,this.constructor.eventName(W_)),o=(si(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:l}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(l.append(i),J.trigger(this._element,this.constructor.eventName(H_))),this._popper=this._createPopper(i),i.classList.add(ss),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))J.on(d,"mouseover",cs);const c=()=>{J.trigger(this._element,this.constructor.eventName(B_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||J.trigger(this._element,this.constructor.eventName(P_)).defaultPrevented)return;if(this._getTipElement().classList.remove(ss),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))J.off(i,"mouseover",cs);this._activeTrigger[Rs]=!1,this._activeTrigger[js]=!1,this._activeTrigger[Ft]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),J.trigger(this._element,this.constructor.eventName(F_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Is,ss),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Rf(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Is),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new O_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[j_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Is)}_isShown(){return this.tip&&this.tip.classList.contains(ss)}_createPopper(e){const s=Ae(this._config.placement,[this,e,this._element]),o=G_[s.toUpperCase()];return an(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ae(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ae(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")J.on(this._element,this.constructor.eventName(V_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Rs]=!(i._isShown()&&i._activeTrigger[Rs]),i.toggle()});else if(s!==R_){const o=s===Ft?this.constructor.eventName(z_):this.constructor.eventName(U_),i=s===Ft?this.constructor.eventName(K_):this.constructor.eventName(q_);J.on(this._element,o,this._config.selector,l=>{const c=this._initializeOnDelegatedTarget(l);c._activeTrigger[l.type==="focusin"?js:Ft]=!0,c._enter()}),J.on(this._element,i,this._config.selector,l=>{const c=this._initializeOnDelegatedTarget(l);c._activeTrigger[l.type==="focusout"?js:Ft]=c._element.contains(l.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},J.on(this._element.closest(io),ao,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Je.getDataAttributes(this._element);for(const o of Object.keys(s))N_.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:nt(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Rt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}We(Rt);const Q_="popover",X_=".popover-header",Z_=".popover-body",eg={...Rt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},tg={...Rt.DefaultType,content:"(null|string|element|function)"};class un extends Rt{static get Default(){return eg}static get DefaultType(){return tg}static get NAME(){return Q_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[X_]:this._getTitle(),[Z_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=un.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}We(un);const sg="scrollspy",ng="bs.scrollspy",dn=`.${ng}`,og=".data-api",ig=`activate${dn}`,ro=`click${dn}`,ag=`load${dn}${og}`,rg="dropdown-item",bt="active",lg='[data-bs-spy="scroll"]',Ps="[href]",cg=".nav, .list-group",lo=".nav-link",ug=".nav-item",dg=".list-group-item",mg=`${lo}, ${ug} > ${lo}, ${dg}`,pg=".dropdown",fg=".dropdown-toggle",vg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},hg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class _s extends He{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return vg}static get DefaultType(){return hg}static get NAME(){return sg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=nt(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(J.off(this._config.target,ro),J.on(this._config.target,ro,Ps,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(s(c))},i=(this._rootElement||document.documentElement).scrollTop,l=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(c));continue}const d=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(l&&d){if(o(c),!i)return;continue}!l&&!d&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ue.find(Ps,this._config.target);for(const s of e){if(!s.hash||ot(s))continue;const o=ue.findOne(decodeURI(s.hash),this._element);It(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(bt),this._activateParents(e),J.trigger(this._element,ig,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(rg)){ue.findOne(fg,e.closest(pg)).classList.add(bt);return}for(const s of ue.parents(e,cg))for(const o of ue.prev(s,mg))o.classList.add(bt)}_clearActiveClass(e){e.classList.remove(bt);const s=ue.find(`${Ps}.${bt}`,e);for(const o of s)o.classList.remove(bt)}static jQueryInterface(e){return this.each(function(){const s=_s.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(window,ag,()=>{for(const n of ue.find(lg))_s.getOrCreateInstance(n)});We(_s);const _g="tab",gg="bs.tab",_t=`.${gg}`,bg=`hide${_t}`,yg=`hidden${_t}`,wg=`show${_t}`,$g=`shown${_t}`,kg=`click${_t}`,Sg=`keydown${_t}`,Cg=`load${_t}`,Eg="ArrowLeft",co="ArrowRight",Tg="ArrowUp",uo="ArrowDown",Fs="Home",mo="End",dt="active",po="fade",Ws="show",xg="dropdown",Ti=".dropdown-toggle",Ag=".dropdown-menu",Bs=`:not(${Ti})`,Mg='.list-group, .nav, [role="tablist"]',Dg=".nav-item, .list-group-item",Og=`.nav-link${Bs}, .list-group-item${Bs}, [role="tab"]${Bs}`,xi='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Hs=`${Og}, ${xi}`,Lg=`.${dt}[data-bs-toggle="tab"], .${dt}[data-bs-toggle="pill"], .${dt}[data-bs-toggle="list"]`;class Lt extends He{constructor(e){super(e),this._parent=this._element.closest(Mg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),J.on(this._element,Sg,s=>this._keydown(s)))}static get NAME(){return _g}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?J.trigger(s,bg,{relatedTarget:e}):null;J.trigger(e,wg,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(dt),this._activate(ue.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ws);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),J.trigger(e,$g,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(po))}_deactivate(e,s){if(!e)return;e.classList.remove(dt),e.blur(),this._deactivate(ue.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ws);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),J.trigger(e,yg,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(po))}_keydown(e){if(![Eg,co,Tg,uo,Fs,mo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!ot(i));let o;if([Fs,mo].includes(e.key))o=s[e.key===Fs?0:s.length-1];else{const i=[co,uo].includes(e.key);o=rn(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Lt.getOrCreateInstance(o).show())}_getChildren(){return ue.find(Hs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=ue.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(xg))return;const i=(l,c)=>{const d=ue.findOne(l,o);d&&d.classList.toggle(c,s)};i(Ti,dt),i(Ag,Ws),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(dt)}_getInnerElement(e){return e.matches(Hs)?e:ue.findOne(Hs,e)}_getOuterElement(e){return e.closest(Dg)||e}static jQueryInterface(e){return this.each(function(){const s=Lt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,kg,xi,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ot(this)&&Lt.getOrCreateInstance(this).show()});J.on(window,Cg,()=>{for(const n of ue.find(Lg))Lt.getOrCreateInstance(n)});We(Lt);const Ng="toast",Ig="bs.toast",ct=`.${Ig}`,jg=`mouseover${ct}`,Rg=`mouseout${ct}`,Pg=`focusin${ct}`,Fg=`focusout${ct}`,Wg=`hide${ct}`,Bg=`hidden${ct}`,Hg=`show${ct}`,Vg=`shown${ct}`,Ug="fade",fo="hide",ns="show",os="showing",qg={animation:"boolean",autohide:"boolean",delay:"number"},zg={animation:!0,autohide:!0,delay:5e3};class gs extends He{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return zg}static get DefaultType(){return qg}static get NAME(){return Ng}show(){if(J.trigger(this._element,Hg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Ug);const s=()=>{this._element.classList.remove(os),J.trigger(this._element,Vg),this._maybeScheduleHide()};this._element.classList.remove(fo),Kt(this._element),this._element.classList.add(ns,os),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||J.trigger(this._element,Wg).defaultPrevented)return;const s=()=>{this._element.classList.add(fo),this._element.classList.remove(os,ns),J.trigger(this._element,Bg)};this._element.classList.add(os),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ns),super.dispose()}isShown(){return this._element.classList.contains(ns)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){J.on(this._element,jg,e=>this._onInteraction(e,!0)),J.on(this._element,Rg,e=>this._onInteraction(e,!1)),J.on(this._element,Pg,e=>this._onInteraction(e,!0)),J.on(this._element,Fg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=gs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}fs(gs);We(gs);const Kg={class:"message-content-column"},Gg=["id"],Yg={class:"accordion-item"},Jg=["id"],Qg=["aria-controls"],Xg={class:"d-flex align-items-center w-100"},Zg={class:"badge bg-warning text-dark ms-auto me-2"},eb={class:"text-muted"},tb=["id","aria-labelledby"],sb={class:"accordion-body bg-light"},nb={class:"alert alert-warning mb-3",role:"alert"},ob={class:"compaction-metadata"},ib={class:"metadata-row"},ab={class:"metadata-row"},rb={key:0,class:"metadata-row"},lb={class:"continuation-content"},cb={class:"continuation-text border rounded p-3 bg-white"},ub={class:"mb-0"},db={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=_(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=_(()=>`heading-${s.value}`),i=_(()=>`collapse-${s.value}`),l=R(null);let c=null;ke(()=>{l.value&&(c=new Ot(l.value,{toggle:!1}))}),Mi(()=>{c&&c.dispose()});function d(){c&&c.toggle()}const p=_(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=_(()=>p.value?e.messages[3]:e.messages[2]),u=_(()=>f.value?.metadata?.init_data?.compact_metadata||{}),w=_(()=>u.value.pre_tokens||0),g=_(()=>p.value?e.messages[4]:e.messages[3]),$=_(()=>g.value?.content||""),k=_(()=>{const m=e.messages[0]?.timestamp;return m?qt(m):""});function y(m){return m?`${m.toLocaleString()} tokens`:"0 tokens"}return(m,h)=>(a(),r("div",{class:"message-row message-row-compaction",key:s.value},[h[7]||(h[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",Kg,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Yg,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:d},[t("div",Xg,[h[0]||(h[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",Zg,b(y(w.value)),1),t("small",eb,b(k.value),1)])],8,Qg)],8,Jg),t("div",{ref_key:"collapseElement",ref:l,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",sb,[t("div",nb,[h[5]||(h[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),ae(" Compaction Details ")],-1)),t("div",ob,[t("div",ib,[h[2]||(h[2]=t("strong",null,"Trigger:",-1)),t("span",null,b(u.value.trigger||"auto"),1)]),t("div",ab,[h[3]||(h[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,b(y(w.value)),1)]),u.value.post_tokens?(a(),r("div",rb,[h[4]||(h[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,b(y(u.value.post_tokens)),1)])):A("",!0)])]),t("div",lb,[h[6]||(h[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),ae(" Continuation Message ")],-1)),t("div",cb,[t("pre",ub,b($.value),1)])])])],8,tb)])],8,Gg)])]))}},mb=oe(db,[["__scopeId","data-v-e0b95ba8"]]),pb={key:0,class:"text-muted text-center py-5"},fb={__name:"MessageList",setup(n){const e=Oe(),s=ye(),o=R(null),i=_(()=>{const u=e.currentMessages,w=[];let g=0;for(;g<u.length;){const $=u[g];if(c($,u,g)){const k=u[g+2],m=k?.type==="system"&&k?.metadata?.subtype==="init"?5:4,h=u.slice(g,g+m);w.push({type:"compaction",messages:h}),g+=m;continue}p($)&&w.push({type:"message",message:$,attachedTools:[]}),g++}return l(w)});function l(u){const w=new Map,g=new Set;for(let k=0;k<u.length;k++){const y=u[k];if(y.type==="compaction")continue;const m=y.message,h=m.content&&m.content.trim().length>0&&m.content!=="Assistant response",v=m.type==="assistant"&&m.metadata?.has_tool_uses&&m.metadata?.tool_uses?.length>0;if(m.type==="assistant"&&v&&!h){let S=-1,C=!1;for(let j=k-1;j>=0;j--){const F=u[j];if(!g.has(j)){if(F.type==="message"&&F.message.type!=="assistant"){C=!0;break}if(F.type==="message"&&F.message.type==="assistant"){const E=F.message;if(E.content&&E.content.trim().length>0&&E.content!=="Assistant response"){S=j;break}else{S=j;break}}}}C&&S===-1||(C&&S>=0?(w.has(S)||w.set(S,[]),w.get(S).push(...m.metadata.tool_uses),g.add(k)):!C&&S>=0&&(w.has(S)||w.set(S,[]),w.get(S).push(...m.metadata.tool_uses),g.add(k)))}}const $=[];for(let k=0;k<u.length;k++){if(g.has(k))continue;const y=u[k];w.has(k)&&(y.attachedTools=[...y.attachedTools||[],...w.get(k)]),$.push(y)}return $}function c(u,w,g){if(g+3>=w.length)return!1;const $=w[g],k=w[g+1];let y=w[g+2],m=w[g+3],h=w[g+4];const v=$.type==="system"&&$.metadata?.subtype==="status"&&$.metadata?.init_data?.status==="compacting",S=k.type==="system"&&k.metadata?.subtype==="status"&&(k.metadata?.init_data?.status===null||k.metadata?.init_data?.status===void 0);if(y?.type==="system"&&y?.metadata?.subtype==="init"){if(g+4>=w.length)return!1;const j=!0,F=m?.type==="system"&&m?.metadata?.subtype==="compact_boundary",E=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",S),console.log("  Msg3 (init):",j),console.log("  Msg4 (boundary):",F),console.log("  Msg5 (continuation):",E)),v&&S&&j&&F&&E}else{const j=y?.type==="system"&&y?.metadata?.subtype==="compact_boundary",F=m?.type==="user"&&m?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",S),console.log("  Msg3 (boundary):",j),console.log("  Msg4 (continuation):",F)),v&&S&&j&&F}}async function d(){s.autoScrollEnabled&&(await st(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}_e(()=>i.value.length,d),_e(()=>e.currentToolCalls.length,d),_e(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),d),ke(()=>{setTimeout(()=>{d()},100)});function p(u){const w=u.subtype||u.metadata?.subtype;if(u.type==="system"&&w==="init"||u.type==="system"&&w==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const g=u.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const g=u.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function f(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,w)=>(a(),r("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),r("div",pb," No messages yet. Start a conversation! ")):A("",!0),(a(!0),r(ce,null,de(i.value,(g,$)=>(a(),r(ce,{key:`item-${$}`},[g.type==="message"?(a(),$e(Yp,{key:0,message:f(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(a(),$e(mb,{key:1,messages:g.messages},null,8,["messages"])):A("",!0)],64))),128))],512))}},vb=oe(fb,[["__scopeId","data-v-bb936559"]]),hb={key:0,class:"attachment-list"},_b={key:0,class:"attachment-preview"},gb=["src","alt"],bb={key:1,class:"attachment-icon"},yb={class:"file-type-icon"},wb={class:"attachment-info"},$b=["title"],kb={class:"attachment-size"},Sb=["onClick"],Cb={key:2,class:"upload-progress"},Eb=["title"],Tb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(p){if(p.type&&p.type.startsWith("image/"))return!0;const f=p.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function i(p){const f=p.name?.split(".").pop()?.toLowerCase()||"",u=p.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function l(p){return p?p<1024?p+" B":p<1024*1024?(p/1024).toFixed(1)+" KB":(p/(1024*1024)).toFixed(1)+" MB":""}function c(p,f=20){if(!p||p.length<=f)return p;const u=p.split(".").pop(),w=p.substring(0,p.length-u.length-1);return w.length<=f-u.length-4?p:w.substring(0,f-u.length-4)+"..."+u}function d(p){s("remove",p)}return(p,f)=>n.attachments.length>0?(a(),r("div",hb,[(a(!0),r(ce,null,de(n.attachments,(u,w)=>(a(),r("div",{key:u.id||w,class:"attachment-item"},[o(u)?(a(),r("div",_b,[t("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,gb)])):(a(),r("div",bb,[t("span",yb,b(i(u)),1)])),t("div",wb,[t("span",{class:"attachment-name",title:u.name},b(c(u.name)),9,$b),t("span",kb,b(l(u.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>d(w)}," âœ• ",8,Sb),u.uploading?(a(),r("div",Cb,[t("div",{class:"progress-bar",style:Ge({width:(u.progress||0)+"%"})},null,4)])):A("",!0),u.error?(a(),r("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+b(u.error),9,Eb)):A("",!0)]))),128))])):A("",!0)}},xb=oe(Tb,[["__scopeId","data-v-0fcc4974"]]),Ab=["id","aria-selected","onMousedown","onMouseenter"],Mb={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=R(null);return _e(()=>e.selectedIndex,o=>{if(!s.value)return;const i=s.value.children[o];i&&i.scrollIntoView({block:"nearest"})}),(o,i)=>n.commands.length>0?(a(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(a(!0),r(ce,null,de(n.commands,(l,c)=>(a(),r("li",{id:`slash-cmd-${c}`,key:l,role:"option",class:ee(["slash-command-item",{active:c===n.selectedIndex}]),"aria-selected":c===n.selectedIndex,onMousedown:fe(d=>o.$emit("select",l),["prevent"]),onMouseenter:d=>o.$emit("highlight",c)}," /"+b(l),43,Ab))),128))],512)):A("",!0)}},Db=oe(Mb,[["__scopeId","data-v-97c65547"]]),Ob={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Lb=["disabled"],Nb=["placeholder","disabled","aria-expanded","aria-activedescendant"],Ib=["disabled"],jb=["disabled"],vo=5*1024*1024,Rb={__name:"InputArea",setup(n){const e=ve(),s=at(),o=Ve(),i=ye(),l=go("pendingResourceAttachment",R(null)),c=R(null),d=R(null),p=R(window.innerWidth),f=R([]),u=R(!1),w=R(!1),g=R(!1),$=R(""),k=R(0),y=_({get:()=>e.currentInput,set:D=>{e.currentInput=D}}),m=_(()=>e.currentSession?.is_processing||!1),h=_(()=>s.sessionConnected),v=_(()=>e.currentSession?.state==="starting"),S=_(()=>e.currentSessionId),C=_(()=>!!y.value.trim()||f.value.filter(D=>!D.error).length>0),j=_(()=>p.value<768),F=_(()=>v.value?"Session is starting...":h.value?"Type your message to Claude Code...":"Waiting for connection..."),E=_(()=>{const D=S.value;return D?e.initData.get(D)?.slash_commands||[]:[]}),B=_(()=>{const D=$.value.toLowerCase();return E.value.filter(M=>M.toLowerCase().includes(D)).sort((M,O)=>M.localeCompare(O))});function T(){p.value=window.innerWidth}ke(()=>{window.addEventListener("resize",T)}),Se(()=>{window.removeEventListener("resize",T)}),_e(l,D=>{D&&(re(D),l.value=null)});function x(D){if(g.value&&B.value.length>0){const M=B.value.length;if(D.key==="ArrowDown"){D.preventDefault(),k.value=(k.value+1)%M;return}if(D.key==="ArrowUp"){D.preventDefault(),k.value=(k.value-1+M)%M;return}if(D.key==="Enter"){D.preventDefault(),V(B.value[k.value]);return}if(D.key==="Tab"){D.preventDefault(),V(B.value[k.value]);return}}if(D.key==="Escape"&&g.value){D.preventDefault(),g.value=!1;return}if(D.key==="Enter"&&!D.shiftKey){if(j.value)return;D.preventDefault(),se()}}function z(){const D=c.value;if(!D)return;D.style.height="auto";const M=Math.min(D.scrollHeight,parseInt(getComputedStyle(D).maxHeight));D.style.height=M+"px"}_e(y,D=>{D.startsWith("/")&&E.value.length>0?($.value=D.slice(1),k.value=0,g.value=B.value.length>0):g.value=!1});function V(D){y.value=`/${D} `,g.value=!1,c.value?.focus(),z()}function N(){d.value?.click()}function H(D){const M=Array.from(D.target.files||[]);I(M),D.target.value=""}function K(D){u.value=!1;const M=Array.from(D.dataTransfer?.files||[]);I(M)}function Y(D){const M=D.clipboardData?.items;if(!M)return;const O=[];for(const L of M)if(L.type.startsWith("image/")){const U=L.getAsFile();if(U){const X=L.type.split("/")[1]||"png",pe=`clipboard-${Date.now()}.${X}`,De=new File([U],pe,{type:U.type});O.push(De)}}O.length>0&&(D.preventDefault(),I(O))}function I(D){for(const M of D){if(M.size>vo){f.value.push({id:G(),name:M.name,size:M.size,type:M.type,file:M,error:`File too large (max ${vo/(1024*1024)}MB)`});continue}let O=null;M.type.startsWith("image/")&&(O=URL.createObjectURL(M)),f.value.push({id:G(),name:M.name,size:M.size,type:M.type,file:M,preview:O,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function P(D){const M=f.value[D];M.preview&&URL.revokeObjectURL(M.preview),f.value.splice(D,1)}function G(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function te(D){const M=S.value;if(!M)return null;D.uploading=!0,D.progress=0,D.error=null;try{const O=new FormData;O.append("file",D.file);const L=await fetch(`/api/sessions/${M}/files`,{method:"POST",body:O});if(!L.ok){const X=await L.json().catch(()=>({}));throw new Error(X.detail||`Upload failed: ${L.status}`)}const U=await L.json();return D.uploaded=!0,D.uploadedInfo=U.file,D.progress=100,U.file}catch(O){return D.error=O.message,null}finally{D.uploading=!1}}async function ne(){const D=f.value.filter(M=>!M.uploaded&&!M.error);if(D.length===0)return!0;w.value=!0;try{return(await Promise.all(D.map(te))).every(O=>O!==null)}finally{w.value=!1}}async function se(){const D=y.value.trim(),M=f.value.filter(U=>!U.error).length>0;if(!D&&!M||M&&!await ne())return;let O=y.value;const L=f.value.filter(U=>U.uploaded&&U.uploadedInfo).map(U=>U.uploadedInfo);if(L.length>0){const U=L.map(X=>{const pe=(X.size_bytes/1024).toFixed(1);return`- ${X.original_name} (${pe} KB): ${X.stored_path}`}).join(`
`);O.trim()?O=`${O}

---
Attached files (use Read tool to access):
${U}`:O=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${U}`}s.sendMessage(O),y.value="",he(),c.value&&(c.value.style.height="auto")}function he(){for(const D of f.value)D.preview&&URL.revokeObjectURL(D.preview);f.value=[]}function re(D){if(!D||!D.resource_id){console.warn("Invalid resource for attachment:",D);return}const M=S.value;if(!M){console.warn("No current session for resource attachment");return}if(f.value.findIndex(X=>X.resourceId===D.resource_id)>=0){console.log("Resource already attached:",D.resource_id);return}const L=o.isImageResource(D);let U=null;L&&(U=o.getResourceUrl(M,D.resource_id)),f.value.push({id:G(),resourceId:D.resource_id,name:D.original_filename||D.title||"Resource",size:D.size_bytes||0,type:D.format||"application/octet-stream",file:null,preview:U,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:D.resource_id,original_name:D.original_filename||D.title,stored_path:D.file_path||`/api/sessions/${M}/resources/${D.resource_id}`,size_bytes:D.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",D.resource_id)}function q(){s.interruptSession()}return(D,M)=>(a(),r("div",{class:ee(["border-top",le(i).isRedBackground?"theme-red-panel":"bg-light"])},[h.value?A("",!0):(a(),r("div",Ob,[...M[6]||(M[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),be(xb,{attachments:f.value,onRemove:P},null,8,["attachments"]),u.value?(a(),r("div",{key:1,class:"drop-zone-overlay",onDragover:M[0]||(M[0]=fe(()=>{},["prevent"])),onDragleave:M[1]||(M[1]=O=>u.value=!1),onDrop:fe(K,["prevent"])},[...M[7]||(M[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):A("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:M[4]||(M[4]=fe(O=>u.value=!0,["prevent"])),onDragenter:M[5]||(M[5]=fe(O=>u.value=!0,["prevent"]))},[g.value?(a(),$e(Db,{key:0,commands:B.value,"selected-index":k.value,onSelect:V,onHighlight:M[2]||(M[2]=O=>k.value=O)},null,8,["commands","selected-index"])):A("",!0),t("input",{ref_key:"fileInput",ref:d,type:"file",multiple:"",class:"d-none",onChange:H},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:v.value||!h.value,onClick:N}," ðŸ“Ž ",8,Lb),we(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:c,"onUpdate:modelValue":M[3]||(M[3]=O=>y.value=O),class:"form-control",placeholder:F.value,disabled:v.value||!h.value,rows:"1","aria-expanded":g.value||void 0,"aria-activedescendant":g.value?`slash-cmd-${k.value}`:void 0,onInput:z,onKeydown:x,onPaste:Y},null,40,Nb),[[Be,y.value]]),m.value&&!C.value?(a(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:q}," Stop ")):m.value&&C.value?(a(),r("button",{key:2,class:"btn btn-info",disabled:!h.value||v.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:se},b(w.value?"Uploading...":"Queue"),9,Ib)):(a(),r("button",{key:3,class:"btn btn-primary",disabled:!C.value||!h.value||v.value||w.value,onClick:se},b(w.value?"Uploading...":"Send"),9,jb))],32)],2))}},Pb=oe(Rb,[["__scopeId","data-v-5b1f250e"]]),Fb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Wb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Bb={class:"text-secondary"},Hb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Vb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=ye(),i=_(()=>s.currentSession),l=_(()=>o.isLoading),c=_(()=>o.loadingMessage);return ke(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),_e(()=>e.sessionId,async(d,p)=>{if(d!==p&&d!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(d)}finally{o.hideLoading()}}}),Se(()=>{}),(d,p)=>(a(),r("div",Fb,[l.value?(a(),r("div",Wb,[p[0]||(p[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Bb,b(c.value),1)])):A("",!0),i.value?(a(),$e(Gi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),t("div",Hb,[be(vb)]),be(Pb),i.value?(a(),$e(Zi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),i.value?(a(),$e(ra,{key:3,"session-id":e.sessionId},null,8,["session-id"])):A("",!0)]))}},bs=Ze("legion",()=>{const n=R(new Map),e=R(new Map),s=R(null),o=_(()=>n.value.get(s.value)||[]),i=_(()=>e.value.get(s.value)||[]);function l(k){s.value=k}async function c(k,y=100,m=0){try{const h=await ge.get(`/api/legions/${k}/timeline?limit=${y}&offset=${m}`),v=h.comms||[],S=h.total_count||v.length,C=h.has_more||!1;return v.sort((j,F)=>new Date(j.timestamp)-new Date(F.timestamp)),console.log(`Loaded ${v.length} of ${S} comms for legion ${k}`),n.value.set(k,v),n.value=new Map(n.value),{comms:v,totalCount:S,hasMore:C}}catch(h){throw console.error("Failed to load timeline:",h),h}}function d(k,y){n.value.has(k)||n.value.set(k,[]);const m=n.value.get(k);if(m.some(v=>v.comm_id===y.comm_id)){console.log(`Duplicate comm ${y.comm_id} prevented in timeline`);return}m.push(y),n.value=new Map(n.value)}async function p(k,y){try{const h=(await ge.post(`/api/legions/${k}/comms`,y)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${k}`),h}catch(m){throw console.error("Failed to send comm:",m),m}}async function f(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function u(k,y){try{const h=(await ge.post(`/api/legions/${k}/minions`,y)).minion;return await f(k),console.log(`Created minion ${h.minion_id} in legion ${k}`),h}catch(m){throw console.error("Failed to create minion:",m),m}}async function w(k){try{const y=await ge.post(`/api/legions/${k}/halt-all`);return console.log(`Halted ${y.halted_count} of ${y.total_minions} minions in legion ${k}`),y.failed_minions&&y.failed_minions.length>0&&console.warn("Failed to halt some minions:",y.failed_minions),y}catch(y){throw console.error("Failed to halt all minions:",y),y}}async function g(k){try{const y=await ge.post(`/api/legions/${k}/resume-all`);return console.log(`Resumed ${y.resumed_count} of ${y.total_minions} minions in legion ${k}`),y.failed_minions&&y.failed_minions.length>0&&console.warn("Failed to resume some minions:",y.failed_minions),y}catch(y){throw console.error("Failed to resume all minions:",y),y}}function $(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:i,setCurrentLegion:l,loadTimeline:c,addComm:d,sendComm:p,loadMinions:f,createMinion:u,haltAll:w,resumeAll:g,clearLegionData:$}}),Ub=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:bs},Symbol.toStringTag,{value:"Module"})),qb={class:"timeline-header border-bottom p-3"},zb={class:"project-name"},Kb=["title"],Gb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Fe(),o=_(()=>s.projects.get(e.legionId)),i=_(()=>o.value?.name||"Legion");return(l,c)=>(a(),r("div",qb,[t("div",null,[t("div",zb,b(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Kb)])]))}},Yb=oe(Gb,[["__scopeId","data-v-44f386f5"]]),Jb={class:"timeline-status-bar border-top p-2 bg-light"},Qb={class:"d-flex justify-content-end"},Xb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ye();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),r("div",Jb,[t("div",Qb,[t("button",{class:ee(["btn btn-sm",le(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+b(le(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Zb=oe(Xb,[["__scopeId","data-v-891c73db"]]),ey={class:"comm-composer border-top p-3"},ty={key:0,class:"d-flex gap-2 mb-2"},sy={class:"flex-grow-1"},ny=["disabled"],oy={label:"Minions"},iy=["value"],ay={style:{"min-width":"150px"}},ry=["disabled"],ly={class:"d-flex gap-2 align-items-end position-relative"},cy={class:"flex-grow-1 position-relative"},uy=["disabled"],dy=["onClick","onMouseenter"],my=["disabled"],py={key:0},fy={key:1},vy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=bs(),o=ve(),i=Fe(),l=R(""),c=R("task"),d=R(""),p=R(!1),f=R(window.innerWidth),u=R(!1),w=R([]),g=R(0),$=R(-1),k=R(null),y=R(null),m=_(()=>f.value<768),h=_(()=>{const V=i.projects.get(e.legionId);return!V||!V.session_ids?[]:V.session_ids.map(N=>o.sessions.get(N)).filter(N=>N)}),v=_(()=>l.value&&d.value.trim().length>0);function S(V){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[V.state]||"â—‹"}function C(V){return V.role?`${V.name} (${V.role})`:V.name}function j(){const V=k.value;if(!V)return;V.style.height="auto";const N=Math.min(V.scrollHeight,parseInt(getComputedStyle(V).maxHeight));V.style.height=N+"px"}function F(){const V=k.value;if(!V)return;j();const N=d.value,H=V.selectionStart,K=N.substring(0,H),Y=K.lastIndexOf("#");if(Y===-1){u.value=!1;return}const I=K.substring(Y+1).toLowerCase();if(I.includes(" ")){u.value=!1;return}const P=h.value.filter(G=>G.name.toLowerCase().includes(I)).map(G=>({type:"minion",name:G.name,role:G.role,id:G.session_id,state:G.state}));if(P.length===0){u.value=!1;return}w.value=P,g.value=0,$.value=Y,u.value=!0}function E(){if(!y.value)return;const V=y.value,N=V.children[g.value];if(!N)return;const H=N.offsetTop,K=N.offsetHeight,Y=V.scrollTop,I=V.clientHeight;H<Y?V.scrollTop=H:H+K>Y+I&&(V.scrollTop=H+K-I)}function B(V){if(!u.value){if(V.key==="Enter"&&!V.shiftKey){if(m.value)return;v.value&&(V.preventDefault(),x())}return}if(V.key==="ArrowDown")V.preventDefault(),g.value=(g.value+1)%w.value.length,E();else if(V.key==="ArrowUp")V.preventDefault(),g.value=g.value===0?w.value.length-1:g.value-1,E();else if(V.key==="Enter"){V.preventDefault();const N=w.value[g.value];N&&T(N)}else V.key==="Escape"&&(u.value=!1)}function T(V){const N=k.value;if(!N)return;const H=d.value,K=N.selectionStart,Y=H.substring(0,$.value)+"#"+V.name+" "+H.substring(K);d.value=Y;const I=$.value+V.name.length+2;setTimeout(()=>{N.setSelectionRange(I,I),N.focus()},0),u.value=!1}async function x(){if(!(!v.value||p.value)){p.value=!0;try{const[V,N]=l.value.split(":"),H={comm_type:c.value,content:d.value.trim()};V==="minion"&&(H.to_minion_id=N),await s.sendComm(e.legionId,H),d.value="",j()}catch(V){console.error("Failed to send comm:",V),alert(`Failed to send comm: ${V.message}`)}finally{p.value=!1}}}function z(){f.value=window.innerWidth}return ke(()=>{window.addEventListener("resize",z)}),Se(()=>{window.removeEventListener("resize",z)}),_e(u,V=>{if(V){const N=H=>{H.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",N))};setTimeout(()=>document.addEventListener("click",N),0)}}),(V,N)=>(a(),r("div",ey,[n.hideRecipientSelector?A("",!0):(a(),r("div",ty,[t("div",sy,[we(t("select",{"onUpdate:modelValue":N[0]||(N[0]=H=>l.value=H),class:"form-select form-select-sm",disabled:p.value},[N[3]||(N[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",oy,[(a(!0),r(ce,null,de(h.value,H=>(a(),r("option",{key:H.session_id,value:`minion:${H.session_id}`},b(S(H))+" "+b(C(H)),9,iy))),128))])],8,ny),[[yn,l.value]])]),t("div",ay,[we(t("select",{"onUpdate:modelValue":N[1]||(N[1]=H=>c.value=H),class:"form-select form-select-sm",disabled:p.value},[...N[4]||(N[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,ry),[[yn,c.value]])])])),t("div",ly,[t("div",cy,[we(t("textarea",{ref_key:"contentTextarea",ref:k,"onUpdate:modelValue":N[2]||(N[2]=H=>d.value=H),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:F,onKeydown:B},null,40,uy),[[Be,d.value]]),u.value?(a(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:y,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),r(ce,null,de(w.value,(H,K)=>(a(),r("div",{key:H.id,class:ee(["autocomplete-item px-2 py-1",{"bg-light":K===g.value}]),onClick:Y=>T(H),onMouseenter:Y=>g.value=K},b(H.type==="minion"?S(H):"#ï¸âƒ£")+" "+b(H.name)+b(H.role?` (${H.role})`:""),43,dy))),128))],512)):A("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!v.value||p.value,onClick:x},[p.value?(a(),r("span",py,[...N[5]||(N[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ae(" Sending... ",-1)])])):(a(),r("span",fy,"Send"))],8,my)])])]))}},hy=oe(vy,[["__scopeId","data-v-e52b8e8f"]]),_y={class:"message-content-column-full"},gy=["aria-expanded"],by={class:"comm-sender-recipient"},yy={class:"comm-badge-summary"},wy=["title"],$y={class:"comm-summary-text text-muted ms-2"},ky=["aria-label"],Sy={key:0,class:"comm-content-body"},Cy=["innerHTML"],Ey="ffffffff-ffff-ffff-ffff-ffffffffffff",Ty={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Qe.setOptions({breaks:!0,gfm:!0});const s=R(!1);function o(){s.value=!s.value}const i=_(()=>e.comm.from_minion_id===Ey),l=_(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),c=_(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),d=_(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),p=_(()=>{const f=e.comm.content||"";let u=Qe.parse(f);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),Ut.sanitize(u)});return(f,u)=>(a(),r("div",{class:ee(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",_y,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",by,[t("strong",{class:ee({"system-sender":i.value})},b(n.senderName),3),n.recipientName?(a(),r(ce,{key:0},[u[0]||(u[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,b(n.recipientName),1)],64)):A("",!0)]),t("div",yy,[t("span",{class:ee(["badge",c.value]),title:l.value},b(n.comm.comm_type),11,wy),t("span",$y,b(d.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},b(s.value?"â–¾":"â–¸"),9,ky)],8,gy),s.value?(a(),r("div",Sy,[t("div",{class:"message-text",innerHTML:p.value},null,8,Cy)])):A("",!0)])],2))}},xy=oe(Ty,[["__scopeId","data-v-28513f64"]]),Ay={class:"timeline-view d-flex flex-column h-100"},My={key:0,class:"text-center text-muted"},Dy={key:1,class:"text-center text-danger"},Oy={key:2,class:"text-center text-muted"},Ly={key:3,class:"comm-list"},Ny={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=bs();Fe();const o=ve(),i=at(),l=ye(),c=R(!0),d=R(null),p=R(null),f=_(()=>s.currentComms);function u(m){return m.from_user?"You":m.from_minion_id?m.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(m.from_minion_id)?.name||"Unknown":"Unknown"}function w(m){return m.to_user?"You":m.to_minion_id?o.sessions.get(m.to_minion_id)?.name||"Unknown":"All"}async function g(){l.autoScrollEnabled&&(await st(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function $(){c.value=!0,d.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await st(),await g(),setTimeout(()=>{g()},100)}catch(m){console.error("Failed to load timeline:",m),m.response?d.value=`${m.message} (${m.response.status})`:d.value=m.message||"Unknown error"}finally{c.value=!1}}function k(){i.connectLegion(e.legionId)}function y(){i.disconnectLegion()}return _e(()=>f.value.length,()=>{g()}),ke(()=>{o.currentSessionId=null,$(),k(),setTimeout(()=>{g()},100)}),Se(()=>{y()}),(m,h)=>(a(),r("div",Ay,[be(Yb,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(a(),r("div",My,[...h[0]||(h[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ae(" Loading timeline... ",-1)])])):d.value?(a(),r("div",Dy," Failed to load timeline: "+b(d.value),1)):f.value.length===0?(a(),r("div",Oy," No messages yet. Minions will appear here once they start communicating. ")):(a(),r("div",Ly,[(a(!0),r(ce,null,de(f.value,v=>(a(),$e(xy,{key:v.comm_id,comm:v,"sender-name":u(v),"recipient-name":w(v)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),be(hy,{"legion-id":n.legionId},null,8,["legion-id"]),be(Zb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Iy=oe(Ny,[["__scopeId","data-v-b6752179"]]),jy={class:"minion-info flex-grow-1"},Ry={class:"minion-name"},Py={key:0,class:"me-1"},Fy={key:1,class:"badge bg-secondary ms-2"},Wy={key:0,class:"latest-activity text-muted"},By={key:0,class:"activity-prefix"},Hy=["title"],Vy={key:1,class:"activity-time ms-1"},Uy={key:1,class:"latest-activity text-muted"},qy={class:"activity-prefix"},zy=["title"],Ky={key:2,class:"latest-activity text-muted fst-italic small"},Gy={class:"node-row"},Yy={class:"node-left"},Jy={key:0,class:"me-2"},Qy={key:1,class:"badge bg-secondary ms-2"},Xy={class:"node-right"},Zy={key:0,class:"latest-message-preview"},e1={key:0,class:"message-prefix"},t1=["title"],s1={key:1,class:"message-time ms-1"},n1={key:1,class:"last-comm-preview"},o1={class:"comm-direction"},i1=["title"],a1={key:2,class:"text-muted fst-italic small"},r1={class:"node-actions"},l1={key:2,class:"minion-children"},c1={key:1,class:"text-danger small ms-4"},u1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,i=ve(),l=Oe(),c=ye(),d=_(()=>!s.minionData||!s.minionData.id?null:i.getSession(s.minionData.id)),p=_(()=>{if(!s.minionData||!s.minionData.id)return null;const T=l.messagesBySession.get(s.minionData.id);if(!T||T.length===0)return null;for(let x=T.length-1;x>=0;x--){const z=T[x],V=z.subtype||z.metadata?.subtype;if(z.type!=="result"&&!(z.type==="system"&&V==="init")&&!(z.type==="system"&&V==="task_notification")&&!(z.type==="permission_request"||z.type==="permission_response")){if(z.type==="user"&&z.metadata?.has_tool_results){const N=z.content||"";if(N.match(/^Tool results?: \d+ results?$/i)||N.trim()==="")continue}if(z.type==="user"){const N=z.content||"";if(N.includes("<command-message>")&&N.includes("skill is running")||N.startsWith("Base directory for this skill:"))continue}if(z.type==="user"){const N=z.content||"";if(N.includes("<command-message>")&&N.includes("<command-name>")&&N.includes("<command-args>")||N.includes("ARGUMENTS:")&&(N.includes("<command-name>")||N.match(/\nARGUMENTS:/)))continue}if(!(z.type==="system"&&z.content==="System message")&&!(z.type==="assistant"&&z.content==="Assistant response")&&(z.type==="user"||z.type==="assistant"||z.type==="system"))return{content:z.content,type:z.type,timestamp:z.timestamp}}}return null}),f=_(()=>{if(!s.minionData)return null;const T={...s.minionData};return d.value&&(T.state=d.value.state,T.is_processing=d.value.is_processing,d.value.name&&(T.name=d.value.name),d.value.latest_message&&(T.latest_message=d.value.latest_message,T.latest_message_type=d.value.latest_message_type,T.latest_message_time=d.value.latest_message_time)),p.value&&(T.latest_message=p.value.content,T.latest_message_type=p.value.type,T.latest_message_time=p.value.timestamp),T}),u=_(()=>s.level*24),w=_(()=>!s.minionData||!s.minionData.id?!1:i.currentSessionId===s.minionData.id),g=_(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),$=_(()=>s.minionData&&s.minionData.is_overseer&&g.value),k=_(()=>{const T=f.value;return T?T.state==="paused"&&T.is_processing?"pending-prompt":T.is_processing?"processing":T.state||"created":"created"}),y=_(()=>{const T=k.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[T]||"status-dot-grey"}),m=_(()=>{const T=k.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[T]||"#d3d3d3"}}),h=_(()=>{const T=f.value;if(!T||!T.latest_message_type)return"";const x=T.latest_message_type;return x==="user"?"User -->:":x==="system"?"System:":""}),v=_(()=>{const T=f.value;if(!T||!T.latest_message)return"";const x=T.latest_message,z=150;return x.length>z?x.slice(0,z)+"...":x}),S=_(()=>{const T=f.value;if(!T||!T.latest_message_time)return"";try{const x=Date.now();let z;if(typeof T.latest_message_time=="number"?z=T.latest_message_time<3250368e4?T.latest_message_time*1e3:T.latest_message_time:z=new Date(T.latest_message_time).getTime(),isNaN(z)||z<9466848e5||z>x+6e4)return console.warn("Invalid timestamp for relative time calculation:",T.latest_message_time,"parsed to:",z),"";const V=x-z;if(V<0)return"just now";const N=Math.floor(V/6e4),H=Math.floor(N/60),K=Math.floor(H/24);return K>0?`${K}d ago`:H>0?`${H}h ago`:N>0?`${N}m ago`:"just now"}catch(x){return console.error("Error calculating relative time:",x,T.latest_message_time),""}});function C(T){return T.to_user?"User":T.to_minion_name?T.to_minion_name:"unknown"}function j(T){const x=T.summary||T.content||"";return x.length>150?x.substring(0,150)+"...":x}function F(){o("minion-click",s.minionData.id)}function E(){const T=i.sessions.get(s.minionData.id);T&&c.showModal("edit-session",{session:T})}function B(){const T=i.sessions.get(s.minionData.id);T&&c.showModal("manage-session",{session:T})}return(T,x)=>{const z=bo("MinionTreeNode",!0);return n.minionData?(a(),r("div",{key:0,class:"minion-tree-node",style:Ge({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),r("div",{key:0,class:ee(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:F},[t("div",{class:ee(["status-dot me-2",y.value]),style:Ge(m.value)},null,6),t("div",jy,[t("div",Ry,[$.value?(a(),r("span",Py,"ðŸ‘‘")):A("",!0),t("strong",null,b(f.value?.name||n.minionData.name),1),$.value?(a(),r("span",Fy,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),f.value?.latest_message?(a(),r("div",Wy,[h.value?(a(),r("span",By,b(h.value),1)):A("",!0),t("span",{class:"activity-content",title:f.value.latest_message},b(v.value),9,Hy),S.value?(a(),r("span",Vy,"("+b(S.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(a(),r("div",Uy,[t("span",qy,[x[1]||(x[1]=ae("â†’ ",-1)),t("strong",null,b(C(n.minionData.last_comm)),1),x[2]||(x[2]=ae(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},b(j(n.minionData.last_comm)),9,zy)])):(a(),r("div",Ky," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:fe(E,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:fe(B,["stop"])}," âš™ï¸ ")],2)):(a(),r("div",{key:1,class:ee(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:F},[t("div",Gy,[t("div",Yy,[t("div",{class:ee(["status-dot me-2",y.value]),style:Ge(m.value)},null,6),$.value?(a(),r("span",Jy,"ðŸ‘‘")):A("",!0),t("strong",null,b(f.value?.name||n.minionData.name),1),$.value?(a(),r("span",Qy,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),t("div",Xy,[f.value?.latest_message?(a(),r("div",Zy,[h.value?(a(),r("span",e1,b(h.value),1)):A("",!0),t("span",{class:"message-content",title:f.value.latest_message},b(v.value),9,t1),S.value?(a(),r("span",s1,"("+b(S.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(a(),r("div",n1,[t("span",o1,[x[3]||(x[3]=ae("â†’ ",-1)),t("strong",null,b(C(n.minionData.last_comm)),1),x[4]||(x[4]=ae(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},b(j(n.minionData.last_comm)),9,i1)])):(a(),r("div",a1," No activity yet "))]),t("div",r1,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:fe(E,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:fe(B,["stop"])}," âš™ï¸ ")])])],2)),g.value?(a(),r("div",l1,[(a(!0),r(ce,null,de(n.minionData.children,V=>(a(),$e(z,{key:V.id,"minion-data":V,level:n.level+1,layout:n.layout,onMinionClick:x[0]||(x[0]=N=>T.$emit("minion-click",N))},null,8,["minion-data","level","layout"]))),128))])):A("",!0)],4)):(a(),r("div",c1," âš  Minion data is missing "))}}},Ai=oe(u1,[["__scopeId","data-v-64b23e0e"]]),d1={class:"project-overview d-flex flex-column h-100"},m1={class:"project-overview-header border-bottom p-3"},p1={class:"d-flex align-items-center justify-content-between"},f1={class:"mb-1"},v1={key:0,class:"me-2"},h1={class:"text-muted font-monospace"},_1={class:"d-flex gap-2"},g1=["title"],b1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},y1={key:0,class:"text-center py-5"},w1={key:1,class:"alert alert-danger"},$1={key:2,class:"text-center py-5"},k1={key:3},S1={class:"row g-3 mb-4"},C1={class:"col-md-4"},E1={class:"card h-100"},T1={class:"card-body"},x1={class:"card-title mb-0"},A1={class:"text-muted"},M1={class:"col-md-4"},D1={class:"card h-100"},O1={class:"card-body"},L1={class:"card-title mb-0"},N1={class:"text-muted"},I1={key:0,class:"card mb-4"},j1={class:"card mb-4"},R1={class:"card-header d-flex align-items-center justify-content-between"},P1={class:"mb-0"},F1={class:"badge bg-secondary"},W1={class:"card-body"},B1={key:0,class:"text-center py-4"},H1={key:1,class:"text-center text-muted py-4"},V1={key:2,class:"hierarchy-tree"},U1={class:"user-root-node mb-3 border rounded bg-white"},q1={class:"node-row"},z1={class:"node-left"},K1={class:"badge bg-primary ms-2"},G1={class:"node-right"},Y1={key:0,class:"last-comm-preview"},J1={class:"comm-direction"},Q1=["title"],X1={key:1,class:"text-muted fst-italic"},Z1={class:"root-minions ms-4"},ew={class:"card"},tw={class:"card-body"},sw={class:"row mb-0"},nw={class:"col-sm-8 font-monospace text-break"},ow={class:"col-sm-8 font-monospace text-break"},iw={class:"col-sm-8"},aw={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},rw={class:"text-muted"},lw={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Vt(),o=Fe(),i=ve(),l=ye(),c=bs(),d=at(),p=R(!1),f=R(null),u=R(null),w=R(!1);let g=null;const $=_(()=>o.getProject(e.projectId)),k=_(()=>$.value?.session_ids?$.value.session_ids.map(H=>i.getSession(H)).filter(H=>H!=null):[]),y=_(()=>k.value.length>0),m=_(()=>k.value.length),h=_(()=>k.value.filter(H=>H.state==="ACTIVE").length),v=_(()=>{const H=k.value.some(I=>I.state==="ACTIVE"),K=k.value.some(I=>I.is_processing);return k.value.some(I=>I.state==="ERROR")?"Error":K?"Working":H?"Active":m.value>0?"Idle":"Empty"}),S=_(()=>{switch(v.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),C=_(()=>{switch(v.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function j(){w.value=!0;try{const H=await ge.get(`/api/legions/${e.projectId}/hierarchy`);u.value=H}catch(H){console.error("Failed to load minion hierarchy:",H),u.value=null}finally{w.value=!1}}function F(H,K){if(H&&H.id===K)return H;if(H&&H.children)for(const Y of H.children){const I=F(Y,K);if(I)return I}return null}function E(H){return H.to_user?"User":H.to_minion_name?H.to_minion_name:"unknown"}function B(H){const K=H.summary||H.content||"";return K.length>150?K.substring(0,150)+"...":K}function T(H){if(u.value){if(H.from_minion_id){const K=F(u.value,H.from_minion_id);K&&K.type==="minion"&&(K.last_comm=H)}H.from_user&&u.value.type==="user"&&(u.value.last_comm=H)}}function x(H){s.push(`/session/${H}`)}function z(){s.push(`/timeline/${e.projectId}`)}function V(){l.showModal("edit-project",{project:$.value})}function N(){l.showModal("create-minion",{project:$.value})}return ke(()=>{o.selectProject(e.projectId),i.currentSessionId=null,j(),c.setCurrentLegion(e.projectId),d.connectLegion(e.projectId),g=_e(()=>i.sessions,H=>{if(u.value){for(const[K,Y]of H)if(Y.project_id===e.projectId){const I=F(u.value,K);I&&I.type==="minion"&&(I.state!==Y.state&&(I.state=Y.state),I.is_processing!==Y.is_processing&&(I.is_processing=Y.is_processing),I.latest_message!==Y.latest_message&&(I.latest_message=Y.latest_message,I.latest_message_type=Y.latest_message_type,I.latest_message_time=Y.latest_message_time))}}},{deep:!0}),_e(()=>c.commsByLegion.get(e.projectId),H=>{if(H&&H.length>0){const K=H[H.length-1];T(K)}},{deep:!0}),_e(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(H,K)=>{H!==K&&j()})}),_e(()=>e.projectId,H=>{o.selectProject(H),i.currentSessionId=null,j(),c.setCurrentLegion(H),d.connectLegion(H)}),Se(()=>{g&&g()}),(H,K)=>(a(),r("div",d1,[t("div",m1,[t("div",p1,[t("div",null,[t("h4",f1,[y.value?(a(),r("span",v1,"ðŸ›")):A("",!0),ae(" "+b($.value?.name||"Project Overview"),1)]),t("small",h1,b($.value?.working_directory),1)]),t("div",_1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:V}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:y.value?"Create minion":"Add session",onClick:N}," âž• "+b(y.value?"Add Minion":"Add Session"),9,g1)])])]),t("div",b1,[p.value?(a(),r("div",y1,[...K[0]||(K[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(a(),r("div",w1,b(f.value),1)):$.value?(a(),r("div",k1,[t("div",S1,[t("div",C1,[t("div",E1,[t("div",T1,[K[2]||(K[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",x1,b(m.value),1),t("small",A1,b(h.value)+" active",1)])])]),t("div",M1,[t("div",D1,[t("div",O1,[K[3]||(K[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",L1,[t("span",{class:ee(S.value)},b(v.value),3)]),t("small",N1,b(C.value),1)])])])]),y.value?(a(),r("div",I1,[K[4]||(K[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:z}," ðŸ“Š View Timeline ")])])])):A("",!0),t("div",j1,[t("div",R1,[t("h5",P1,"ðŸŒ³ "+b(y.value?"Minion Hierarchy":"Sessions"),1),t("span",F1,b(k.value.length),1)]),t("div",W1,[w.value?(a(),r("div",B1,[...K[5]||(K[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),r("div",H1,' No sessions yet. Click "Add Session" to create one. ')):(a(),r("div",V1,[t("div",U1,[t("div",q1,[t("div",z1,[K[6]||(K[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,b(u.value.name),1),t("span",K1,b(u.value.children.length)+" "+b(u.value.children.length===1?"minion":"minions"),1)]),t("div",G1,[u.value.last_comm?(a(),r("div",Y1,[t("span",J1,[K[7]||(K[7]=ae(" â†’ ",-1)),t("strong",null,b(E(u.value.last_comm)),1),K[8]||(K[8]=ae(": ",-1))]),t("span",{class:"comm-content",title:u.value.last_comm.content||""},b(B(u.value.last_comm)),9,Q1)])):(a(),r("div",X1," No communications yet "))])])]),t("div",Z1,[(a(!0),r(ce,null,de(u.value.children,Y=>(a(),$e(Ai,{key:Y.id,"minion-data":Y,level:1,layout:"two-column",onMinionClick:x},null,8,["minion-data"]))),128))])]))])]),t("div",ew,[K[12]||(K[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",tw,[t("dl",sw,[K[9]||(K[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",nw,b($.value.working_directory),1),K[10]||(K[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",ow,b($.value.project_id),1),K[11]||(K[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",iw,b(y.value?"Yes (has minions)":"No"),1)])])])])):(a(),r("div",$1,[...K[1]||(K[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",aw,[K[13]||(K[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",rw,b(m.value)+" session"+b(m.value!==1?"s":""),1)])]))}},cw=oe(lw,[["__scopeId","data-v-168bf04c"]]),uw=[{path:"/",name:"home",component:Pi},{path:"/project/:projectId",name:"project",component:cw,props:!0},{path:"/session/:sessionId",name:"session",component:Vb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Iy,props:!0}],dw=Di({history:Oi(),routes:uw}),mw={class:"connection-indicators"},pw=["title"],fw=["title"],vw={__name:"ConnectionIndicator",setup(n){const e=at();function s(i){const l={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:c,retryCount:d}=l[i];return d>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(i){const l={ui:"UI WebSocket",session:"Session WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming"},d={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:p,retryCount:f}=d[i];let u="Disconnected";return p?u="Connected":f>0&&(u=`Reconnecting (attempt ${f})`),`${l[i]}
${c[i]}
Status: ${u}`}return(i,l)=>(a(),r("div",mw,[t("div",{class:ee(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,pw),t("div",{class:ee(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,fw)]))}},hw=oe(vw,[["__scopeId","data-v-a2f53fbb"]]),_w={class:"d-flex align-items-center gap-2"},gw={__name:"AppHeader",setup(n){const e=ye();function s(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(i,l)=>(a(),r("header",{class:ee(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",le(e).isRedBackground?"theme-red-header":"bg-white"])},[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...l[2]||(l[2]=[t("span",null,"â˜°",-1)])]),l[3]||(l[3]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",_w,[t("button",{class:ee(["btn btn-sm",le(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:l[0]||(l[0]=c=>le(e).toggleBackgroundColor())},[t("span",{class:"color-swatch",style:Ge({backgroundColor:le(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),t("button",{class:ee(["btn btn-sm",le(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Restart server",onClick:l[1]||(l[1]=c=>le(e).showRestartModal())},[...l[4]||(l[4]=[t("span",null,"â†»",-1)])],2),be(hw),t("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...l[5]||(l[5]=[t("span",null,"â–¤",-1)])])])],2))}},bw=oe(gw,[["__scopeId","data-v-680c42fe"]]),yw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},ww={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},$w=["title"],kw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=_(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function i(d){const p=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function l(d){const p=o(d);return p==="starting"||p==="processing"||p==="pending-prompt"}function c(d){const p=o(d),f=p.charAt(0).toUpperCase()+p.slice(1),u=d.name||"Unnamed Session",w=d.role?` (${d.role})`:"";return`${u}${w}: ${f}`}return(d,p)=>(a(),r("div",yw,[!n.sessions||n.sessions.length===0?(a(),r("div",ww)):(a(!0),r(ce,{key:1},de(n.sessions,f=>(a(),r("div",{key:f.session_id,class:ee(["progress-bar",{"progress-bar-striped progress-bar-animated":l(f)}]),style:Ge({width:s.value,backgroundColor:i(f),cursor:"help"}),title:c(f)},null,14,$w))),128))]))}},Sw=oe(kw,[["__scopeId","data-v-391d77c1"]]),Cw=["data-project-id"],Ew=["id"],Tw=["aria-expanded","aria-controls","aria-label","onKeydown"],xw=["aria-label","onKeydown"],Aw={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Mw={class:"fw-semibold",style:{"flex-shrink":"0"}},Dw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Ow={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Lw=["title"],Nw=["title"],Iw=["id","aria-labelledby"],jw={class:"accordion-body p-0"},Rw={class:"list-group list-group-flush"},Pw={class:"minion-hierarchy-container"},Fw={key:0,class:"text-center py-2"},Ww={key:2,class:"text-muted text-center py-2 small"},Bw={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Vt(),o=Fe(),i=ve(),l=ye(),c=R(e.project.is_expanded||!1),d=R(null),p=R(!1);let f=null;const u=_(()=>o.formatPath(e.project.working_directory)),w=_(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(N=>i.getSession(N)).filter(N=>N!=null)),g=_(()=>w.value.length>0),$=_(()=>{const N=s.currentRoute.value;return N.name==="timeline"&&N.params.legionId===e.project.project_id}),k=_(()=>{const N=s.currentRoute.value;return N.name==="project"&&N.params.projectId===e.project.project_id});function y(N){const H=window.bootstrap;if(!H)return;const K=document.getElementById(`collapse-${e.project.project_id}`);if(!K)return;H.Collapse.getOrCreateInstance(K).toggle(),c.value=!c.value}function m(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function h(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function v(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const N=i.currentSessionId;N&&i.getSession(N)&&e.project.session_ids?.includes(N)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function S(){l.showModal("edit-project",{project:e.project})}function C(){l.showModal("create-minion",{project:e.project})}function j(){s.push(`/timeline/${e.project.project_id}`)}async function F(){p.value=!0;try{const N=await ge.get(`/api/legions/${e.project.project_id}/hierarchy`);d.value=N}catch(N){console.error("Failed to load minion hierarchy:",N),d.value=null}finally{p.value=!1}}function E(N){s.push(`/session/${N}`)}function B(N,H){if(N&&N.id===H)return N;if(N&&N.children)for(const K of N.children){const Y=B(K,H);if(Y)return Y}return null}_e(c,N=>{N&&F()}),ke(()=>{f=_e(()=>i.sessions,N=>{if(!(!d.value||!c.value)){for(const[H,K]of N)if(K.project_id===e.project.project_id){const Y=B(d.value,H);Y&&Y.type==="minion"&&(Y.state!==K.state&&(Y.state=K.state),Y.is_processing!==K.is_processing&&(Y.is_processing=K.is_processing),Y.latest_message!==K.latest_message&&(Y.latest_message=K.latest_message,Y.latest_message_type=K.latest_message_type,Y.latest_message_time=K.latest_message_time))}}},{deep:!0}),_e(()=>i.sessions.size,(N,H)=>{if(c.value&&(N>H&&Array.from(i.sessions.values()).some(I=>I.project_id===e.project.project_id&&(!d.value||!B(d.value,I.session_id)))&&(console.log("New minion detected, reloading hierarchy"),F()),N<H&&d.value)){const K=i.sessions,Y=I=>I.type==="minion"&&!K.has(I.id)?!0:I.children?I.children.some(P=>Y(P)):!1;Y(d.value)&&(console.log("Minion deletion detected, reloading hierarchy"),F())}}),c.value&&F()}),Se(()=>{f&&f()});function T(N){N.dataTransfer.effectAllowed="move",N.dataTransfer.setData("application/project-id",e.project.project_id),N.dataTransfer.setData("text/plain",e.project.project_id),N.target.classList.add("dragging")}function x(N){N.target.classList.remove("dragging")}function z(N){N.preventDefault(),N.dataTransfer.dropEffect="move";const H=N.currentTarget.getBoundingClientRect(),K=H.top+H.height/2;N.clientY<K?(N.currentTarget.classList.add("drop-above"),N.currentTarget.classList.remove("drop-below")):(N.currentTarget.classList.add("drop-below"),N.currentTarget.classList.remove("drop-above"))}function V(N){N.preventDefault(),N.currentTarget.classList.remove("drop-above","drop-below");const H=N.dataTransfer.getData("application/project-id")||N.dataTransfer.getData("text/plain");if(!H||H===e.project.project_id)return;const K=N.currentTarget.getBoundingClientRect(),Y=K.top+K.height/2,I=N.clientY<Y,P=o.orderedProjects,G=P.findIndex(q=>q.project_id===e.project.project_id),te=P.findIndex(q=>q.project_id===H);if(G===-1||te===-1)return;const ne=[...P],[se]=ne.splice(te,1);let he=I?G:G+1;te<G&&he--,ne.splice(he,0,se);const re=ne.map(q=>q.project_id);o.reorderProjects(re)}return(N,H)=>(a(),r("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:T,onDragend:x,onDragover:z,onDrop:V},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:ee(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":k.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:fe(y,["stop"]),onKeydown:[Ke(fe(y,["prevent"]),["enter"]),Ke(fe(y,["prevent"]),["space"])]},[(a(),r("svg",{class:ee(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...H[0]||(H[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,Tw),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:m,onKeydown:[Ke(fe(m,["prevent"]),["enter"]),Ke(fe(m,["prevent"]),["space"])]},[t("div",Aw,[t("div",Mw,[g.value?(a(),r("span",Dw,"ðŸ›")):A("",!0),ae(" "+b(n.project.name),1)]),t("div",Ow,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:fe(S,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:fe(C,["stop"])}," âž• ",8,Lw)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},b(u.value),9,Nw)],40,xw)],2)],8,Ew),be(Sw,{project:n.project,sessions:w.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:ee(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:v},[t("div",jw,[t("div",Rw,[g.value?(a(),r("div",{key:0,class:ee(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:$.value}]),style:{cursor:"pointer"},onClick:j},[...H[1]||(H[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):A("",!0),t("div",Pw,[p.value?(a(),r("div",Fw,[...H[2]||(H[2]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value&&d.value.children&&d.value.children.length>0?(a(!0),r(ce,{key:1},de(d.value.children,K=>(a(),$e(Ai,{key:K.id,"minion-data":K,level:0,layout:"sidebar",onMinionClick:E},null,8,["minion-data"]))),128)):(a(),r("div",Ww," No sessions "))])])])],42,Iw)],40,Cw))}},Hw=oe(Bw,[["__scopeId","data-v-a15b34e8"]]),Vw={class:"project-list"},Uw={key:0,class:"text-muted text-center py-3"},qw={__name:"ProjectList",setup(n){const e=Fe(),s=_(()=>e.orderedProjects);return(o,i)=>(a(),r("div",Vw,[s.value.length===0?(a(),r("div",Uw,' No projects yet. Click "New" to create one. ')):A("",!0),(a(!0),r(ce,null,de(s.value,l=>(a(),$e(Hw,{key:l.project_id,project:l},null,8,["project"]))),128))]))}},zw={class:"flex-grow-1 overflow-auto p-3"},Kw={id:"sessions-container"},Gw={__name:"Sidebar",setup(n){const e=ye(),s=_(()=>e.sidebarCollapsed),o=_(()=>e.isMobile),i=_(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function l(){e.showModal("create-project")}const c=R(!1);function d(u){c.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",f)}function p(u){c.value&&e.setSidebarWidth(u.clientX)}function f(){c.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f)}return(u,w)=>(a(),r("aside",{id:"sidebar",class:ee(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value,"theme-red-panel":le(e).isRedBackground,"bg-light":!le(e).isRedBackground}]),style:Ge(i.value)},[t("div",zw,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:l}," ðŸ“ New ")]),t("div",Kw,[be(qw)])]),t("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},Yw=oe(Gw,[["__scopeId","data-v-d26424cf"]]),mn=Ze("diff",()=>{const n=R(new Map),e=R(!1),s=R(null),o=R("total"),i=R(!1),l=R(null),c=R(null),d=R(new Map),p=_(()=>{const E=ve();return E.currentSessionId&&n.value.get(E.currentSessionId)||null}),f=_(()=>!p.value||!p.value.files?[]:Object.entries(p.value.files).map(([E,B])=>({path:E,...B})).sort((E,B)=>E.path.localeCompare(B.path))),u=_(()=>f.value.length),w=_(()=>!p.value||!p.value.commits?0:p.value.commits.length),g=_(()=>p.value?.is_git_repo===!0),$=_(()=>{if(!l.value||!c.value)return null;const E=`${l.value}:${c.value}`;return d.value.get(E)||null});async function k(E){if(E){e.value=!0,s.value=null;try{const B=await Ht(`/api/sessions/${E}/diff`);n.value.set(E,B),n.value=new Map(n.value)}catch(B){console.error(`Failed to load diff for session ${E}:`,B),s.value=B.message}finally{e.value=!1}}}async function y(E){for(const B of d.value.keys())B.startsWith(`${E}:`)&&d.value.delete(B);d.value=new Map(d.value),await k(E)}async function m(E,B){if(!E||!B)return;const T=`${E}:${B}`,x=d.value.get(T);if(!(x&&!x.error&&x.content!==null)){d.value.set(T,{content:null,loading:!0,error:null}),d.value=new Map(d.value);try{const z=await Ht(`/api/sessions/${E}/diff/file`,{params:{path:B}});d.value.set(T,{content:z.diff,loading:!1,error:null})}catch(z){console.error(`Failed to load file diff for ${B}:`,z),d.value.set(T,{content:null,loading:!1,error:z.message})}d.value=new Map(d.value)}}function h(E,B){l.value=E,c.value=B,i.value=!0,m(E,B)}function v(){i.value=!1}function S(){if(!l.value)return;const E=f.value;if(E.length===0)return;const T=(E.findIndex(x=>x.path===c.value)+1)%E.length;c.value=E[T].path,m(l.value,c.value)}function C(){if(!l.value)return;const E=f.value;if(E.length===0)return;const T=(E.findIndex(x=>x.path===c.value)-1+E.length)%E.length;c.value=E[T].path,m(l.value,c.value)}function j(E){o.value=E}function F(E){n.value.delete(E),n.value=new Map(n.value);for(const B of d.value.keys())B.startsWith(`${E}:`)&&d.value.delete(B);d.value=new Map(d.value),l.value===E&&v()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:i,fullViewSessionId:l,currentFilePath:c,fileDiffCache:d,currentDiff:p,currentFiles:f,fileCount:u,commitCount:w,isGitRepo:g,currentFullViewFileDiff:$,loadDiff:k,refreshDiff:y,loadFileDiff:m,openFullView:h,closeFullView:v,nextFile:S,prevFile:C,setMode:j,clearDiff:F}}),Jw={class:"task-row d-flex align-items-center gap-2"},Qw={key:0,class:"status-icon"},Xw={key:1,class:"status-icon"},Zw=["title"],e$={key:0,class:"task-details"},t$={key:0,class:"task-description mb-2"},s$={class:"description-content"},n$={key:1,class:"task-owner mb-2"},o$={class:"ms-1"},i$={key:2,class:"task-blocked-by mb-2"},a$={key:3,class:"task-blocks"},r$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=_(()=>e.task.status==="in_progress"),o=_(()=>e.task.status==="completed"?"âœ…":"â³"),i=_(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),l=_(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,d)=>(a(),r("div",{class:ee(["task-item",l.value]),onClick:d[0]||(d[0]=p=>c.$emit("toggle"))},[t("div",Jw,[s.value?(a(),r("span",Qw,[...d[1]||(d[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),r("span",Xw,b(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},b(i.value),9,Zw),(a(),r("svg",{class:ee(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),r("div",e$,[n.task.description?(a(),r("div",t$,[d[3]||(d[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",s$,b(n.task.description),1)])):A("",!0),n.task.owner?(a(),r("div",n$,[d[4]||(d[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",o$,b(n.task.owner),1)])):A("",!0),n.task.blockedBy?.length>0?(a(),r("div",i$,[d[5]||(d[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),r(ce,null,de(n.task.blockedBy,p=>(a(),r("span",{key:p,class:"badge bg-warning text-dark me-1"}," #"+b(p),1))),128))])):A("",!0),n.task.blocks?.length>0?(a(),r("div",a$,[d[6]||(d[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),r(ce,null,de(n.task.blocks,p=>(a(),r("span",{key:p,class:"badge bg-info text-dark me-1"}," #"+b(p),1))),128))])):A("",!0)])):A("",!0)],2))}},l$=oe(r$,[["__scopeId","data-v-0f96ae87"]]),c$={class:"task-list-panel"},u$={class:"task-list p-2"},d$={key:0,class:"text-muted text-center py-4"},m$={__name:"TaskListPanel",setup(n){const e=Ct(),s=R(new Set),o=_(()=>e.currentTasks);function i(l){s.value.has(l)?s.value.delete(l):s.value.add(l),s.value=new Set(s.value)}return(l,c)=>(a(),r("div",c$,[t("div",u$,[o.value.length===0?(a(),r("div",d$,[...c[0]||(c[0]=[t("span",{class:"empty-icon"},"ðŸ“",-1),t("p",{class:"mb-0 small"},"No tasks yet",-1)])])):A("",!0),be(Li,{name:"task-list",tag:"div"},{default:Js(()=>[(a(!0),r(ce,null,de(o.value,d=>(a(),$e(l$,{key:d.id,task:d,isExpanded:s.value.has(d.id),onToggle:p=>i(d.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},p$=oe(m$,[["__scopeId","data-v-e1fa565a"]]),f$={class:"resource-gallery-panel"},v$={class:"resource-grid-container p-2"},h$={key:0,class:"text-muted text-center py-4"},_$={key:1,class:"resource-grid"},g$=["onClick"],b$=["onClick","title"],y$=["src","alt"],w$=["title","onClick"],$$={class:"file-icon"},k$={class:"file-ext"},S$={class:"resource-info"},C$=["title"],E$={class:"resource-actions"},T$=["onClick"],x$=["href","download"],A$={__name:"ResourceGallery",setup(n){const e=Ve(),s=ve(),o=go("addAttachmentFromResource",null),i=_(()=>e.currentResources);function l(y){return e.isImageResource(y)}function c(y){return e.getResourceIcon(y)}function d(y){const m=e.getResourceExtension(y);return m?m.toUpperCase().slice(1):""}function p(y){return e.getResourceUrl(s.currentSessionId,y)}function f(y){return e.getDownloadUrl(s.currentSessionId,y)}function u(y){e.openFullView(s.currentSessionId,y)}function w(y,m=18){return y?y.length<=m?y:y.substring(0,m-3)+"...":""}function g(y){y.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function $(y){e.removeResource(s.currentSessionId,y)}function k(y){o?o(y):console.warn("addAttachmentFromResource not provided")}return(y,m)=>(a(),r("div",f$,[t("div",v$,[i.value.length===0?(a(),r("div",h$,[...m[1]||(m[1]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),r("div",_$,[(a(!0),r(ce,null,de(i.value,(h,v)=>(a(),r("div",{key:h.resource_id,class:ee(["resource-item",{"is-image":l(h)}])},[t("button",{class:"remove-btn",onClick:fe(S=>$(h.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...m[2]||(m[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,g$),l(h)?(a(),r("div",{key:0,class:"resource-thumbnail",onClick:S=>u(v),title:h.title||"Click to view"},[t("img",{src:p(h.resource_id),alt:h.title||"Image",loading:"lazy",onError:g},null,40,y$)],8,b$)):(a(),r("div",{key:1,class:"resource-placeholder",title:h.title||h.original_filename||"Click to view",onClick:S=>u(v)},[t("span",$$,b(c(h)),1),t("span",k$,b(d(h)),1)],8,w$)),t("div",S$,[t("div",{class:"resource-title",title:h.title||h.original_filename},b(w(h.title||h.original_filename)),9,C$),t("div",E$,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:fe(S=>k(h),["stop"]),title:"Add to message attachments"},[...m[3]||(m[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,T$),t("a",{href:f(h.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:h.original_filename||h.title||"download",title:"Download",onClick:m[0]||(m[0]=fe(()=>{},["stop"]))},[...m[4]||(m[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,x$)])])],2))),128))]))])]))}},M$=oe(A$,[["__scopeId","data-v-93315470"]]),D$=["src","alt"],O$={key:1,class:"resource-info"},L$={key:0,class:"resource-title"},N$={key:1,class:"resource-description"},I$={class:"resource-meta"},j$={class:"meta-item"},R$={class:"meta-item"},P$={class:"meta-item"},F$={class:"text-header"},W$={class:"text-header-info"},B$={class:"text-filename"},H$={class:"resource-meta"},V$={key:0,class:"meta-item"},U$={key:1,class:"meta-item"},q$={key:0,class:"display-mode-toggle"},z$=["title","disabled"],K$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},G$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Y$={class:"copy-label"},J$={class:"text-body"},Q$={key:0,class:"text-loading"},X$={key:1,class:"text-error"},Z$={key:2,class:"text-content"},ek=["innerHTML"],tk={key:4,class:"text-unavailable"},sk={key:4,class:"position-indicator"},nk={key:5,class:"thumbnail-strip"},ok=["onClick"],ik=["src","alt"],ak={key:1,class:"strip-text-icon"},rk={__name:"ResourceFullView",setup(n){Qe.setOptions({breaks:!0,gfm:!0});const e=Ve(),s=R(null),o=R(!1),i=R("raw");let l=null;const c=_(()=>e.fullViewOpen),d=_(()=>e.currentFullViewResource),p=_(()=>e.currentResourceIndex),f=_(()=>e.fullViewTotalResources),u=_(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),w=_(()=>e.isImageResource(d.value)),g=_(()=>d.value?e.getTextContent(d.value.resource_id):null),$=_(()=>g.value?.content||null),k=_(()=>g.value?.loading||!1),y=_(()=>g.value?.error||null),m=_(()=>{if(!$.value)return"";let V=Qe.parse($.value);return V=V.replace(/\n</g,"<"),V=V.replace(/\n+$/,""),Ut.sanitize(V)});_e(c,V=>{V?(st(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),_e(p,()=>{i.value="raw"}),_e([p,c],()=>{if(c.value&&d.value&&!w.value){const V=d.value.resource_id,N=e.getTextContent(V);(!N||N.error)&&e.fetchTextContent(e.fullViewSessionId,V)}},{immediate:!0}),Se(()=>{document.body.style.overflow="",l&&clearTimeout(l)});function h(V){return e.getResourceUrl(e.fullViewSessionId,V)}function v(){e.closeFullView()}function S(){e.nextResource()}function C(){e.prevResource()}function j(V){e.goToResource(V)}function F(V){V.target===V.currentTarget&&v()}function E(V){switch(V.key){case"Escape":v();break;case"ArrowLeft":C();break;case"ArrowRight":S();break;case"Home":j(0);break;case"End":j(f.value-1);break;case"m":!w.value&&$.value&&(i.value=i.value==="raw"?"markdown":"raw");break}}async function B(){if($.value)try{await navigator.clipboard.writeText($.value),o.value=!0,l&&clearTimeout(l),l=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function T(V){return V?V<1024?`${V} B`:V<1024*1024?`${(V/1024).toFixed(1)} KB`:`${(V/(1024*1024)).toFixed(2)} MB`:""}function x(V){return V?new Date(V*1e3).toLocaleString():""}function z(V){V.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(V,N)=>(a(),$e(wo,{to:"body"},[be(yo,{name:"modal"},{default:Js(()=>[c.value?(a(),r("div",{key:0,class:"resource-full-view-overlay",onClick:F,onKeydown:E,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:fe(v,["stop"]),title:"Close (Escape)"},[...N[4]||(N[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),f.value>1?(a(),r("button",{key:0,class:"nav-btn nav-prev",onClick:fe(C,["stop"]),title:"Previous (Left Arrow)"},[...N[5]||(N[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):A("",!0),w.value?(a(),r("div",{key:1,class:"image-container",onClick:N[0]||(N[0]=fe(()=>{},["stop"]))},[d.value?(a(),r("img",{key:0,src:h(d.value.resource_id||d.value.image_id),alt:d.value.title||"Image",class:"full-image",onError:z},null,40,D$)):A("",!0),d.value?(a(),r("div",O$,[d.value.title?(a(),r("h5",L$,b(d.value.title),1)):A("",!0),d.value.description?(a(),r("p",N$,b(d.value.description),1)):A("",!0),t("div",I$,[t("span",j$,b(T(d.value.size_bytes)),1),t("span",R$,b(d.value.format?.toUpperCase()),1),t("span",P$,b(x(d.value.timestamp)),1)])])):A("",!0)])):(a(),r("div",{key:2,class:"text-container",onClick:N[3]||(N[3]=fe(()=>{},["stop"]))},[t("div",F$,[t("div",W$,[t("h5",B$,b(d.value?.title||d.value?.original_filename||"Text Resource"),1),t("div",H$,[d.value?.size_bytes?(a(),r("span",V$,b(T(d.value.size_bytes)),1)):A("",!0),d.value?.format?(a(),r("span",U$,b(d.value.format.toUpperCase()),1)):A("",!0)])]),$.value?(a(),r("div",q$,[t("button",{class:ee(["toggle-btn",{active:i.value==="raw"}]),onClick:N[1]||(N[1]=fe(H=>i.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:ee(["toggle-btn",{active:i.value==="markdown"}]),onClick:N[2]||(N[2]=fe(H=>i.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):A("",!0),t("button",{class:"copy-btn",onClick:fe(B,["stop"]),title:o.value?"Copied!":i.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!$.value},[o.value?(a(),r("svg",K$,[...N[6]||(N[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),r("svg",G$,[...N[7]||(N[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Y$,b(o.value?"Copied!":i.value==="markdown"?"Copy raw":"Copy"),1)],8,z$)]),t("div",J$,[k.value?(a(),r("div",Q$,[...N[8]||(N[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):y.value?(a(),r("div",X$," Failed to load content: "+b(y.value),1)):$.value&&i.value==="raw"?(a(),r("pre",Z$,b($.value),1)):$.value&&i.value==="markdown"?(a(),r("div",{key:3,class:"markdown-content",innerHTML:m.value},null,8,ek)):(a(),r("div",tk," Preview not available for this file type. "))])])),f.value>1?(a(),r("button",{key:3,class:"nav-btn nav-next",onClick:fe(S,["stop"]),title:"Next (Right Arrow)"},[...N[9]||(N[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):A("",!0),f.value>1?(a(),r("div",sk,b(p.value+1)+" / "+b(f.value),1)):A("",!0),f.value>1?(a(),r("div",nk,[(a(!0),r(ce,null,de(u.value,(H,K)=>(a(),r("div",{key:H.resource_id||H.image_id,class:ee(["strip-thumbnail",{active:K===p.value,"is-text":!le(e).isImageResource(H)}]),onClick:fe(Y=>j(K),["stop"])},[le(e).isImageResource(H)?(a(),r("img",{key:0,src:h(H.resource_id||H.image_id),alt:H.title||"Thumbnail",loading:"lazy"},null,8,ik)):(a(),r("span",ak,b(le(e).getResourceIcon(H)),1))],10,ok))),128))])):A("",!0)],544)):A("",!0)]),_:1})]))}},lk=oe(rk,[["__scopeId","data-v-169421b1"]]),ck={class:"diff-panel"},uk={class:"diff-body"},dk={key:0,class:"text-center py-4"},mk={key:1,class:"text-muted text-center py-4"},pk={key:2,class:"text-muted text-center py-4"},fk={class:"mb-0 small"},vk={key:3,class:"text-danger text-center py-4"},hk={class:"mb-0 small"},_k={key:4,class:"text-muted text-center py-4"},gk={key:5},bk={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},yk=["disabled"],wk={class:"stats-bar px-3 py-1 border-bottom small text-muted"},$k={class:"text-success"},kk={class:"text-danger"},Sk={class:"ms-2"},Ck={key:0,class:"ms-2"},Ek={key:0,class:"file-list"},Tk=["onClick"],xk=["title"],Ak={key:0,class:"file-stats small text-nowrap"},Mk={key:0,class:"text-success"},Dk={key:1,class:"text-muted"},Ok={key:2,class:"text-danger"},Lk={key:1,class:"file-stats small text-muted"},Nk={key:1,class:"commit-list"},Ik=["onClick"],jk={class:"commit-hash"},Rk=["title"],Pk={class:"commit-date small text-muted text-nowrap"},Fk={key:0,class:"commit-files"},Wk=["onClick"],Bk=["title"],Hk={key:6,class:"text-muted text-center py-4"},Vk={__name:"DiffPanel",setup(n){const e=mn(),s=ve(),o=R(new Set);function i(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function l(u){s.currentSessionId&&e.openFullView(s.currentSessionId,u)}function c(u){o.value.has(u)?o.value.delete(u):o.value.add(u),o.value=new Set(o.value)}function d(u){switch(u){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function p(u){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[u]?.status||"modified"}function f(u){if(!u)return"";const w=new Date(u),$=new Date-w,k=Math.floor($/6e4);if(k<1)return"just now";if(k<60)return`${k}m ago`;const y=Math.floor(k/60);return y<24?`${y}h ago`:`${Math.floor(y/24)}d ago`}return _e(()=>s.currentSessionId,u=>{u&&!e.diffBySession.get(u)&&e.loadDiff(u)},{immediate:!0}),(u,w)=>(a(),r("div",ck,[t("div",uk,[le(e).loading&&!le(e).currentDiff?(a(),r("div",dk,[...w[2]||(w[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):le(e).currentDiff&&!le(e).isGitRepo?(a(),r("div",mk,[...w[3]||(w[3]=[t("p",{class:"mb-0 small"},"Not a git repository",-1)])])):le(e).currentDiff&&le(e).currentDiff.error?(a(),r("div",pk,[t("p",fk,b(le(e).currentDiff.error),1)])):le(e).error?(a(),r("div",vk,[t("p",hk,b(le(e).error),1)])):le(e).currentDiff&&le(e).fileCount===0?(a(),r("div",_k,[...w[4]||(w[4]=[t("p",{class:"mb-0 small"},"No changes since main",-1)])])):le(e).currentDiff&&le(e).fileCount>0?(a(),r("div",gk,[t("div",bk,[t("button",{class:ee(["btn btn-sm",le(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:w[0]||(w[0]=g=>le(e).setMode("total"))}," Total Changes ",2),t("button",{class:ee(["btn btn-sm",le(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:w[1]||(w[1]=g=>le(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:i,title:"Refresh diff",disabled:le(e).loading},[(a(),r("svg",{class:ee({spin:le(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...w[5]||(w[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,yk)]),t("div",wk,[t("span",$k,"+"+b(le(e).currentDiff.total_insertions),1),w[6]||(w[6]=t("span",{class:"mx-1"},"/",-1)),t("span",kk,"-"+b(le(e).currentDiff.total_deletions),1),t("span",Sk,b(le(e).fileCount)+" file"+b(le(e).fileCount!==1?"s":""),1),le(e).commitCount>0?(a(),r("span",Ck,b(le(e).commitCount)+" commit"+b(le(e).commitCount!==1?"s":""),1)):A("",!0)]),le(e).currentMode==="total"?(a(),r("div",Ek,[(a(!0),r(ce,null,de(le(e).currentFiles,g=>(a(),r("div",{key:g.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:$=>l(g.path)},[t("span",{class:ee(["status-icon","status-"+g.status])},b(d(g.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:g.path},b(g.path),9,xk),g.is_binary?(a(),r("span",Lk,"binary")):(a(),r("span",Ak,[g.insertions>0?(a(),r("span",Mk,"+"+b(g.insertions),1)):A("",!0),g.insertions>0&&g.deletions>0?(a(),r("span",Dk,"/")):A("",!0),g.deletions>0?(a(),r("span",Ok,"-"+b(g.deletions),1)):A("",!0)]))],8,Tk))),128))])):(a(),r("div",Nk,[(a(!0),r(ce,null,de(le(e).currentDiff.commits,g=>(a(),r("div",{key:g.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:$=>c(g.hash)},[(a(),r("svg",{class:ee(["chevron-icon",{expanded:o.value.has(g.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...w[7]||(w[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),t("code",jk,b(g.short_hash),1),t("span",{class:"commit-message text-truncate flex-grow-1",title:g.message},b(g.message),9,Rk),t("span",Pk,b(f(g.date)),1)],8,Ik),o.value.has(g.hash)?(a(),r("div",Fk,[(a(!0),r(ce,null,de(g.files,$=>(a(),r("div",{key:$,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:k=>l($)},[t("span",{class:ee(["status-icon","status-"+p($)])},b(d(p($))),3),t("span",{class:"file-path text-truncate small",title:$},b($),9,Bk)],8,Wk))),128))])):A("",!0)]))),128))]))])):(a(),r("div",Hk,[...w[8]||(w[8]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No diff data",-1)])]))])]))}},Uk=oe(Vk,[["__scopeId","data-v-7ddbc381"]]),qk={class:"diff-header"},zk={class:"diff-header-info"},Kk={class:"diff-filename"},Gk={class:"diff-meta"},Yk={key:1,class:"meta-item"},Jk={class:"text-success"},Qk={class:"text-danger"},Xk=["title","disabled"],Zk={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},e0={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},t0={class:"copy-label"},s0={class:"diff-body"},n0={key:0,class:"diff-loading"},o0={key:1,class:"diff-error"},i0={key:2,class:"diff-content"},a0={class:"diff-table"},r0={class:"line-num line-num-old"},l0={class:"line-num line-num-new"},c0={class:"line-content"},u0={class:"line-prefix"},d0={key:3,class:"diff-empty"},m0={key:2,class:"position-indicator"},p0={__name:"DiffFullView",setup(n){const e=mn(),s=R(null),o=R(!1);let i=null;const l=_(()=>e.fullViewOpen),c=_(()=>e.currentFullViewFileDiff),d=_(()=>c.value?.content||null),p=_(()=>e.currentFiles.length),f=_(()=>e.currentFilePath?e.currentFiles.findIndex(h=>h.path===e.currentFilePath):0),u=_(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),w=_(()=>{if(!d.value)return[];const h=d.value.split(`
`),v=[];let S=0,C=0;for(const j of h){if(j.startsWith("diff --git")||j.startsWith("index ")||j.startsWith("---")||j.startsWith("+++")||j.startsWith("new file")||j.startsWith("deleted file")||j.startsWith("similarity")||j.startsWith("rename")||j.startsWith("Binary")){j.startsWith("Binary")&&v.push({type:"info",prefix:"",text:j,oldNum:null,newNum:null});continue}if(j.startsWith("@@")){const F=j.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);F&&(S=parseInt(F[1]),C=parseInt(F[2]),v.push({type:"hunk",prefix:"",text:j,oldNum:null,newNum:null}));continue}j.startsWith(" ")||j.length>0&&!j.startsWith("+")&&!j.startsWith("-")&&!j.startsWith("\\")?(v.push({type:"context",prefix:" ",text:j.substring(1),oldNum:S,newNum:C}),S++,C++):j.startsWith("+")?(v.push({type:"add",prefix:"+",text:j.substring(1),oldNum:null,newNum:C}),C++):j.startsWith("-")?(v.push({type:"remove",prefix:"-",text:j.substring(1),oldNum:S,newNum:null}),S++):j.startsWith("\\")&&v.push({type:"info",prefix:"",text:j,oldNum:null,newNum:null})}return v});function g(h){return`diff-line diff-line-${h.type}`}function $(){e.closeFullView()}function k(h){h.target===h.currentTarget&&$()}function y(h){switch(h.key){case"Escape":$();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function m(){if(d.value)try{await navigator.clipboard.writeText(d.value),o.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return _e(l,h=>{h?(st(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Se(()=>{document.body.style.overflow="",i&&clearTimeout(i)}),(h,v)=>(a(),$e(wo,{to:"body"},[be(yo,{name:"modal"},{default:Js(()=>[l.value?(a(),r("div",{key:0,class:"diff-full-view-overlay",onClick:k,onKeydown:y,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:fe($,["stop"]),title:"Close (Escape)"},[...v[3]||(v[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(a(),r("button",{key:0,class:"nav-btn nav-prev",onClick:v[0]||(v[0]=fe(S=>le(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...v[4]||(v[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):A("",!0),t("div",{class:"diff-container",onClick:v[1]||(v[1]=fe(()=>{},["stop"]))},[t("div",qk,[t("div",zk,[t("h5",Kk,b(le(e).currentFilePath),1),t("div",Gk,[u.value?(a(),r("span",{key:0,class:ee(["meta-badge","status-"+u.value.status])},b(u.value.status),3)):A("",!0),u.value&&!u.value.is_binary?(a(),r("span",Yk,[t("span",Jk,"+"+b(u.value.insertions),1),v[5]||(v[5]=ae(" / ",-1)),t("span",Qk,"-"+b(u.value.deletions),1)])):A("",!0)])]),t("button",{class:"copy-btn",onClick:fe(m,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!d.value},[o.value?(a(),r("svg",Zk,[...v[6]||(v[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),r("svg",e0,[...v[7]||(v[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",t0,b(o.value?"Copied!":"Copy"),1)],8,Xk)]),t("div",s0,[c.value&&c.value.loading?(a(),r("div",n0,[...v[8]||(v[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):c.value&&c.value.error?(a(),r("div",o0," Failed to load diff: "+b(c.value.error),1)):d.value?(a(),r("div",i0,[t("table",a0,[t("tbody",null,[(a(!0),r(ce,null,de(w.value,(S,C)=>(a(),r("tr",{key:C,class:ee(g(S))},[t("td",r0,b(S.oldNum||""),1),t("td",l0,b(S.newNum||""),1),t("td",c0,[t("span",u0,b(S.prefix),1),t("span",null,b(S.text),1)])],2))),128))])])])):(a(),r("div",d0," No diff available for this file. "))])]),p.value>1?(a(),r("button",{key:1,class:"nav-btn nav-next",onClick:v[2]||(v[2]=fe(S=>le(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...v[9]||(v[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):A("",!0),p.value>1?(a(),r("div",m0,b(f.value+1)+" / "+b(p.value),1)):A("",!0)],544)):A("",!0)]),_:1})]))}},f0=oe(p0,[["__scopeId","data-v-d13809ae"]]),v0={class:"nav nav-tabs sidebar-tabs",role:"tablist"},h0={class:"nav-item",role:"presentation"},_0={key:0,class:"tab-badge"},g0={class:"nav-item",role:"presentation"},b0={key:0,class:"tab-badge"},y0={class:"nav-item",role:"presentation"},w0={key:0,class:"tab-badge"},$0={class:"tab-content-container"},k0={__name:"RightSidebar",setup(n){const e=ye(),s=Ct(),o=Ve(),i=mn(),l=_(()=>e.rightSidebarCollapsed),c=_(()=>e.isMobile),d=_(()=>e.rightSidebarActiveTab),p=_(()=>s.currentTaskStats),f=_(()=>o.currentResourceCount),u=_(()=>i.fileCount),w=_(()=>{if(c.value)return{};const m=`${e.rightSidebarWidth}px`;return{width:m,minWidth:"200px",maxWidth:"30vw","--sidebar-width":m}}),g=R(!1);function $(m){m.preventDefault(),g.value=!0,document.addEventListener("mousemove",k),document.addEventListener("mouseup",y)}function k(m){if(g.value){const h=window.innerWidth-m.clientX;e.setRightSidebarWidth(h)}}function y(){g.value=!1,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",y)}return(m,h)=>(a(),r("aside",{id:"right-sidebar",class:ee(["border-start d-flex flex-column overflow-auto",{collapsed:l.value,"mobile-open":!l.value&&c.value,resizing:g.value,"theme-red-panel":le(e).isRedBackground,"bg-light":!le(e).isRedBackground}]),style:Ge(w.value)},[t("ul",v0,[t("li",h0,[t("button",{class:ee(["nav-link",{active:d.value==="tasks"}]),type:"button",onClick:h[0]||(h[0]=v=>le(e).setRightSidebarTab("tasks"))},[h[3]||(h[3]=ae(" Tasks ",-1)),p.value.total>0?(a(),r("span",_0,b(p.value.completed)+"/"+b(p.value.total),1)):A("",!0)],2)]),t("li",g0,[t("button",{class:ee(["nav-link",{active:d.value==="diff"}]),type:"button",onClick:h[1]||(h[1]=v=>le(e).setRightSidebarTab("diff"))},[h[4]||(h[4]=ae(" Diff ",-1)),u.value>0?(a(),r("span",b0,b(u.value),1)):A("",!0)],2)]),t("li",y0,[t("button",{class:ee(["nav-link",{active:d.value==="resources"}]),type:"button",onClick:h[2]||(h[2]=v=>le(e).setRightSidebarTab("resources"))},[h[5]||(h[5]=ae(" Resources ",-1)),f.value>0?(a(),r("span",w0,b(f.value),1)):A("",!0)],2)])]),t("div",$0,[we(be(p$,null,null,512),[[St,d.value==="tasks"]]),we(be(Uk,null,null,512),[[St,d.value==="diff"]]),we(be(M$,null,null,512),[[St,d.value==="resources"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:$},null,32),be(lk),be(f0)],6))}},S0=oe(k0,[["__scopeId","data-v-9a5f3d6b"]]),C0={class:"modal-dialog modal-lg"},E0={class:"modal-content"},T0={class:"modal-body"},x0={class:"mb-3"},A0={class:"input-group"},M0=["disabled"],D0={key:0,class:"text-center py-4"},O0={key:1,class:"alert alert-danger",role:"alert"},L0={key:2,class:"folder-list"},N0=["onClick","onDblclick"],I0={class:"d-flex align-items-center flex-grow-1"},j0=["onClick"],R0={key:1,class:"text-center text-muted py-3"},P0={class:"modal-footer"},F0=["disabled"],W0={__name:"FolderBrowserModal",setup(n){const e=ye(),s=R(""),o=R(""),i=R([]),l=R(!1),c=R(""),d=R(null);let p=null,f=null;const u=_(()=>{if(!s.value)return null;const S=s.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?"/"+S.join("/"):"/")});function w(S){if(!S)return"";const C=S.split(/[\\/]/).filter(Boolean);return C.length<=2?S:".../"+C.slice(-2).join("/")}async function g(){l.value=!0,c.value="",i.value=[],o.value="";try{const S=s.value?{path:s.value}:{},C=await ge.get("/api/filesystem/browse",{params:S});C.current_path&&(s.value=C.current_path),i.value=C.directories||[]}catch(S){console.error("Failed to load directory:",S),c.value=S.message||"Failed to load directory"}finally{l.value=!1}}function $(S){o.value=S.path}function k(S){s.value=S.path,o.value="",g()}function y(){u.value&&(s.value=u.value,o.value="",g())}function m(){const S=o.value||s.value;S&&f&&f(S),p&&p.hide()}function h(){g()}function v(){i.value=[],o.value="",c.value="",f=null,e.hideModal()}return _e(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&p){const C=S.data||{};s.value=C.defaultPath||C.currentPath||"",f=C.onSelect||null,p.show()}}),ke(()=>{d.value&&Me(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{p=new S(d.value),d.value.addEventListener("shown.bs.modal",h),d.value.addEventListener("hidden.bs.modal",v)})}),Se(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",h),d.value.removeEventListener("hidden.bs.modal",v)),p&&p.dispose()}),(S,C)=>(a(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",C0,[t("div",E0,[C[6]||(C[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",T0,[t("div",x0,[C[1]||(C[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",A0,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=j=>s.value=j),onKeyup:Ke(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Be,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:g,disabled:l.value}," ðŸ”„ Refresh ",8,M0)])]),l.value?(a(),r("div",D0,[...C[2]||(C[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(a(),r("div",O0,b(c.value),1)):(a(),r("div",L0,[u.value?(a(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:y,role:"button"},[...C[3]||(C[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):A("",!0),(a(!0),r(ce,null,de(i.value,j=>(a(),r("div",{key:j.path,class:ee(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:j.path===o.value}]),onClick:F=>$(j),onDblclick:F=>k(j),role:"button"},[t("div",I0,[C[4]||(C[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,b(j.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:fe(F=>k(j),["stop"])}," Open ",8,j0)],42,N0))),128)),i.value.length===0?(a(),r("div",R0," No subdirectories found ")):A("",!0)]))]),t("div",P0,[C[5]||(C[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:!o.value},' Select "'+b(w(o.value||s.value))+'" ',9,F0)])])])],512))}},B0=oe(W0,[["__scopeId","data-v-0d61ed46"]]),H0={class:"modal-dialog"},V0={class:"modal-content"},U0={class:"modal-body"},q0={class:"mb-3"},z0={key:0,class:"invalid-feedback"},K0={class:"mb-3"},G0={class:"input-group"},Y0={key:0,class:"invalid-feedback"},J0={class:"mb-3 form-check"},Q0={key:0,class:"mb-3 ms-4"},X0={key:1,class:"alert alert-danger",role:"alert"},Z0={class:"modal-footer"},eS=["disabled"],tS={key:0,class:"spinner-border spinner-border-sm me-2"},sS={__name:"ProjectCreateModal",setup(n){const e=Fe(),s=ve(),o=ye(),i=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),l=R({name:"",workingDirectory:""}),c=R(!1),d=R(""),p=R(null);let f=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:m=>{i.value.workingDirectory=m,l.value.workingDirectory=""}})}function w(){l.value={};let m=!0;return i.value.name.trim()||(l.value.name="Project name is required",m=!1),i.value.workingDirectory.trim()||(l.value.workingDirectory="Working directory is required",m=!1),m}async function g(){if(w()){c.value=!0,d.value="";try{const m=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await s.createSession(m.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),$()}catch(m){console.error("Failed to create project:",m),d.value=m.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function $(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},l.value={},d.value=""}function k(){const m=document.getElementById("projectName");m&&m.focus()}function y(){$(),o.hideModal()}return _e(()=>o.currentModal,m=>{m?.name==="create-project"&&f&&f.show()}),ke(()=>{p.value&&Me(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{f=new m(p.value),p.value.addEventListener("shown.bs.modal",k),p.value.addEventListener("hidden.bs.modal",y)})}),Se(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",k),p.value.removeEventListener("hidden.bs.modal",y)),f&&f.dispose()}),(m,h)=>(a(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",H0,[t("div",V0,[h[11]||(h[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",U0,[t("form",{onSubmit:fe(g,["prevent"])},[t("div",q0,[h[4]||(h[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),we(t("input",{type:"text",class:ee(["form-control",{"is-invalid":l.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=v=>i.value.name=v),placeholder:"My Project",required:""},null,2),[[Be,i.value.name]]),l.value.name?(a(),r("div",z0,b(l.value.name),1)):A("",!0)]),t("div",K0,[h[5]||(h[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",G0,[we(t("input",{type:"text",class:ee(["form-control",{"is-invalid":l.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=v=>i.value.workingDirectory=v),placeholder:"/path/to/project",required:""},null,2),[[Be,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),l.value.workingDirectory?(a(),r("div",Y0,b(l.value.workingDirectory),1)):A("",!0)]),h[6]||(h[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",J0,[we(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=v=>i.value.createSession=v)},null,512),[[_o,i.value.createSession]]),h[7]||(h[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),r("div",Q0,[h[9]||(h[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),we(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=v=>i.value.sessionName=v),placeholder:"main"},null,512),[[Be,i.value.sessionName]])])):A("",!0),d.value?(a(),r("div",X0,b(d.value),1)):A("",!0)],32)]),t("div",Z0,[h[10]||(h[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:c.value},[c.value?(a(),r("span",tS)):A("",!0),ae(" "+b(c.value?"Creating...":"Create Project"),1)],8,eS)])])])],512))}},nS=oe(sS,[["__scopeId","data-v-ea55fdae"]]),oS={class:"modal-dialog"},iS={class:"modal-content"},aS={class:"modal-body"},rS={class:"mb-3"},lS={key:0,class:"invalid-feedback"},cS={class:"mb-3"},uS=["value"],dS={key:0,class:"alert alert-danger",role:"alert"},mS={class:"danger-zone"},pS={class:"text-muted small"},fS=["disabled"],vS={key:0,class:"alert alert-warning mt-3",role:"alert"},hS={class:"mb-2"},_S={class:"d-flex gap-2"},gS=["disabled"],bS={key:0,class:"spinner-border spinner-border-sm me-2"},yS=["disabled"],wS={class:"modal-footer"},$S=["disabled"],kS={key:0,class:"spinner-border spinner-border-sm me-2"},SS={__name:"ProjectEditModal",setup(n){const e=Fe(),s=ye(),o=R(null),i=R({name:""}),l=R({name:""}),c=R(!1),d=R(!1),p=R(""),f=R(!1),u=R(null);let w=null;const g=_(()=>o.value?.session_ids?.length||0);function $(){l.value={};let S=!0;return i.value.name.trim()||(l.value.name="Project name is required",S=!1),S}async function k(){if(!(!$()||!o.value)){c.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),w&&w.hide()}catch(S){console.error("Failed to update project:",S),p.value=S.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function y(){if(o.value){d.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(S){console.error("Failed to delete project:",S),p.value=S.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function m(){i.value={name:""},l.value={},p.value="",f.value=!1}function h(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function v(){m(),o.value=null,s.hideModal()}return _e(()=>s.currentModal,S=>{if(S?.name==="edit-project"&&w){const C=S.data||{};o.value=C.project,o.value&&(i.value.name=o.value.name),w.show()}}),ke(()=>{u.value&&Me(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{w=new S(u.value),u.value.addEventListener("shown.bs.modal",h),u.value.addEventListener("hidden.bs.modal",v)})}),Se(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",h),u.value.removeEventListener("hidden.bs.modal",v)),w&&w.dispose()}),(S,C)=>(a(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",oS,[t("div",iS,[C[10]||(C[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",aS,[t("form",{onSubmit:fe(k,["prevent"])},[t("div",rS,[C[3]||(C[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),we(t("input",{type:"text",class:ee(["form-control",{"is-invalid":l.value.name}]),id:"editProjectName","onUpdate:modelValue":C[0]||(C[0]=j=>i.value.name=j),placeholder:"My Project",required:""},null,2),[[Be,i.value.name]]),l.value.name?(a(),r("div",lS,b(l.value.name),1)):A("",!0)]),t("div",cS,[C[4]||(C[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,uS),C[5]||(C[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(a(),r("div",dS,b(p.value),1)):A("",!0)],32),C[8]||(C[8]=t("hr",null,null,-1)),t("div",mS,[C[6]||(C[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",pS," Deleting this project will also delete all "+b(g.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:C[1]||(C[1]=j=>f.value=!0),disabled:d.value}," ðŸ—‘ï¸ Delete Project ",8,fS)]),f.value?(a(),r("div",vS,[C[7]||(C[7]=t("strong",null,"Are you sure?",-1)),t("p",hS,' This will permanently delete the project "'+b(o.value?.name)+'" and all '+b(g.value)+" session(s). ",1),t("div",_S,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:y,disabled:d.value},[d.value?(a(),r("span",bS)):A("",!0),ae(" "+b(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,gS),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:C[2]||(C[2]=j=>f.value=!1),disabled:d.value}," Cancel ",8,yS)])])):A("",!0)]),t("div",wS,[C[9]||(C[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:k,disabled:c.value},[c.value?(a(),r("span",kS)):A("",!0),ae(" "+b(c.value?"Saving...":"Save Changes"),1)],8,$S)])])])],512))}},CS=oe(SS,[["__scopeId","data-v-52679516"]]),ES={class:"general-tab"},TS={key:0,class:"mb-3"},xS={for:"template-select",class:"form-label"},AS=["value"],MS=["value"],DS={key:0,class:"form-text"},OS={class:"mb-3"},LS={for:"config-name",class:"form-label"},NS=["value","placeholder","pattern","title"],IS={key:0,class:"invalid-feedback"},jS={key:1,class:"form-text"},RS={key:1,class:"mb-3"},PS=["value"],FS={class:"mb-3"},WS=["value"],BS={class:"form-text"},HS={key:0,class:"text-warning"},VS={key:1},US={class:"mb-3"},qS={for:"config-permission-mode",class:"form-label"},zS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},KS={key:1,class:"field-indicator modified",title:"Modified from template"},GS=["value","disabled"],YS={key:0,value:"bypassPermissions"},JS={class:"form-text"},QS={key:0,class:"text-warning"},XS={key:1},ZS={class:"mb-3"},eC={for:"config-role",class:"form-label"},tC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},sC={key:1,class:"field-indicator modified",title:"Modified from template"},nC=["value","placeholder"],oC={class:"form-text"},iC={key:2,class:"mb-3"},aC={class:"input-group"},rC=["value","placeholder","disabled","readonly"],lC={class:"form-text"},cC={key:3,class:"mb-3"},uC={class:"form-control-plaintext"},dC={key:4,class:"mb-3 form-check"},mC=["checked"],pC={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=_(()=>e.mode==="create-session"||e.mode==="edit-session"),o=_(()=>e.mode==="create-template"||e.mode==="edit-template"),i=_(()=>e.mode==="create-session"),l=_(()=>e.mode==="edit-session"),c=_(()=>e.session?.state==="active"||e.session?.state==="starting"),d=_(()=>{if(!e.session)return!1;const y=e.session.model||"sonnet";return e.formData.model!==y}),p=_(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=_(()=>e.selectedTemplateId?e.templates.find(y=>y.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},w=_(()=>u[e.formData.model]||null),g=_(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),$=_(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function k(y){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[y]||"bg-secondary"}return(y,m)=>(a(),r("div",ES,[i.value?(a(),r("div",TS,[t("label",xS,[m[10]||(m[10]=ae(" Template ",-1)),t("button",{type:"button",onClick:m[0]||(m[0]=h=>y.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:m[1]||(m[1]=h=>y.$emit("update:selected-template-id",h.target.value||null)),class:"form-select"},[m[11]||(m[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),r(ce,null,de(n.templates,h=>(a(),r("option",{key:h.template_id,value:h.template_id},b(h.name),9,MS))),128))],40,AS),f.value?(a(),r("div",DS,b(f.value.description),1)):A("",!0)])):A("",!0),t("div",OS,[t("label",LS,[ae(b(o.value?"Template Name":"Session Name")+" ",1),m[12]||(m[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:ee(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:m[2]||(m[2]=h=>y.$emit("update:form-data","name",h.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,NS),n.errors.name?(a(),r("div",IS,b(n.errors.name),1)):A("",!0),s.value?(a(),r("div",jS,"Must be a single word (no spaces) for #nametag matching")):A("",!0)]),o.value?(a(),r("div",RS,[m[13]||(m[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:m[3]||(m[3]=h=>y.$emit("update:form-data","description",h.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,PS)])):A("",!0),t("div",FS,[m[16]||(m[16]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:m[4]||(m[4]=h=>y.$emit("update:form-data","model",h.target.value))},[...m[14]||(m[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,WS),t("div",BS,[l.value&&c.value&&d.value?(a(),r("span",HS,[...m[15]||(m[15]=[ae(" Model change requires a ",-1),t("strong",null,"reset",-1),ae(" (not restart) to take effect. ",-1)])])):w.value?(a(),r("span",VS,b(w.value.description),1)):A("",!0)])]),t("div",US,[t("label",qS,[m[17]||(m[17]=ae(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),r("span",zS," < ")):A("",!0),n.fieldStates.permission_mode==="modified"?(a(),r("span",KS," * ")):A("",!0)]),t("select",{id:"config-permission-mode",class:ee(["form-select",$.value]),value:n.formData.permission_mode,onChange:m[5]||(m[5]=h=>y.$emit("update:form-data","permission_mode",h.target.value)),disabled:l.value&&!c.value},[m[18]||(m[18]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),m[19]||(m[19]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),m[20]||(m[20]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!l.value||p.value?(a(),r("option",YS," Bypass Permissions (No prompts - use with caution) ")):A("",!0)],42,GS),t("div",JS,[l.value&&!c.value?(a(),r("span",QS," Session must be active to change permission mode. Start the session first. ")):(a(),r("span",XS,"Controls which tool actions require permission prompts"))])]),t("div",ZS,[t("label",eC,[ae(b(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),r("span",tC," < ")):A("",!0),n.fieldStates.default_role==="modified"?(a(),r("span",sC," * ")):A("",!0)]),t("input",{id:"config-role",type:"text",class:ee(["form-control",g.value]),value:n.formData.default_role,onInput:m[6]||(m[6]=h=>y.$emit("update:form-data","default_role",h.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,nC),t("div",oC,b(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(a(),r("div",iC,[m[21]||(m[21]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",aC,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:m[7]||(m[7]=h=>y.$emit("update:form-data","working_directory",h.target.value)),placeholder:l.value?"":"Leave empty to inherit from project",disabled:l.value,readonly:l.value},null,40,rC),l.value?A("",!0):(a(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:m[8]||(m[8]=h=>y.$emit("open-folder-browser"))}," Browse "))]),t("div",lC,b(l.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):A("",!0),l.value&&n.session?(a(),r("div",cC,[m[22]||(m[22]=t("label",{class:"form-label"},"Current State",-1)),t("div",uC,[t("span",{class:ee(["badge",k(n.session.state)])},b(n.session.state),3)])])):A("",!0),i.value?(a(),r("div",dC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:m[9]||(m[9]=h=>y.$emit("update:form-data","startImmediately",h.target.checked))},null,40,mC),m[23]||(m[23]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):A("",!0)]))}},fC=oe(pC,[["__scopeId","data-v-b9edc342"]]),vC={class:"permissions-tab"},hC={class:"mb-3"},_C={for:"config-allowed-tools",class:"form-label"},gC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},bC={key:1,class:"field-indicator modified",title:"Modified from template"},yC={key:0,class:"tools-list mb-2"},wC=["onClick"],$C={class:"input-group input-group-sm"},kC=["onKeydown"],SC=["disabled"],CC={class:"mt-2"},EC=["onClick"],TC={class:"form-text"},xC={key:0,class:"text-warning"},AC={key:1},MC={class:"mb-3"},DC={class:"capabilities-editor"},OC={key:0,class:"capabilities-list mb-2"},LC=["onClick"],NC={class:"input-group input-group-sm"},IC=["onKeydown"],jC=["disabled"],RC={key:0,class:"mb-3"},PC={class:"settings-sources-editor"},FC={class:"form-check"},WC=["checked"],BC={class:"form-check"},HC=["checked"],VC={class:"form-check"},UC=["checked"],qC={class:"form-text"},zC={key:0,class:"text-warning"},KC={key:1},GC={key:1,class:"mb-3"},YC={class:"mb-3"},JC={key:0,class:"mt-2"},QC=["value"],XC=["value"],ZC={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,i=R(""),l=R(""),c=R(!1),d=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=_(()=>s.mode==="create-template"||s.mode==="edit-template"),f=_(()=>s.mode==="create-session"||s.mode==="edit-session"),u=_(()=>s.mode==="edit-session"),w=_(()=>s.session?.state==="active"||s.session?.state==="starting"),g=_(()=>{if(!s.session)return!1;const T=s.session.allowed_tools?.join(", ")||"";return s.formData.allowed_tools!==T}),$=_(()=>s.formData.setting_sources||["user","project","local"]),k=_(()=>{if(!s.session)return!1;const T=s.session.setting_sources||["user","project","local"],x=s.formData.setting_sources||["user","project","local"];return JSON.stringify(T.sort())!==JSON.stringify(x.sort())}),y=_(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(T=>T.trim()).filter(T=>T.length>0)),m=_(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(T=>T.trim()).filter(T=>T.length>0)),h=_(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),v=_(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"}));function S(){const T=i.value.trim();if(T){if(!y.value.includes(T)){const x=[...y.value,T];o("update:form-data","allowed_tools",x.join(", "))}i.value=""}}function C(T){const x=[...y.value];x.splice(T,1),o("update:form-data","allowed_tools",x.join(", "))}function j(T){if(y.value.includes(T)){const x=y.value.indexOf(T);C(x)}else{const x=[...y.value,T];o("update:form-data","allowed_tools",x.join(", "))}}function F(){const T=l.value.trim().toLowerCase();if(T){if(!m.value.includes(T)){const x=[...m.value,T];o("update:form-data","capabilities",x.join(", "))}l.value=""}}function E(T){const x=[...m.value];x.splice(T,1),o("update:form-data","capabilities",x.join(", "))}function B(T){const x=[...$.value],z=x.indexOf(T);z>=0?x.splice(z,1):x.push(T),o("update:form-data","setting_sources",x)}return(T,x)=>(a(),r("div",vC,[t("div",hC,[t("label",_C,[x[9]||(x[9]=ae(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),r("span",gC," < ")):A("",!0),n.fieldStates.allowed_tools==="modified"?(a(),r("span",bC," * ")):A("",!0)]),t("div",{class:ee(["allowed-tools-editor",v.value])},[y.value.length>0?(a(),r("div",yC,[(a(!0),r(ce,null,de(y.value,(z,V)=>(a(),r("span",{key:V,class:"badge bg-primary me-1 mb-1 tool-badge"},[ae(b(z)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:N=>C(V),"aria-label":"Remove tool"},null,8,wC)]))),128))])):A("",!0),t("div",$C,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=z=>i.value=z),onKeydown:Ke(fe(S,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,kC),[[Be,i.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:S,disabled:!i.value.trim()}," Add ",8,SC)]),t("div",CC,[x[10]||(x[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),r(ce,null,de(d,z=>t("button",{key:z,type:"button",class:ee(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":y.value.includes(z)}]),onClick:V=>j(z)},b(z),11,EC)),64))])],2),t("div",TC,[u.value&&w.value&&g.value?(a(),r("span",xC,[...x[11]||(x[11]=[ae(" Allowed tools change requires a ",-1),t("strong",null,"reset",-1),ae(" (not restart) to take effect. ",-1)])])):(a(),r("span",AC,b(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),t("div",MC,[x[12]||(x[12]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",DC,[m.value.length>0?(a(),r("div",OC,[(a(!0),r(ce,null,de(m.value,(z,V)=>(a(),r("span",{key:V,class:"badge bg-info me-1 mb-1 capability-badge"},[ae(b(z)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:N=>E(V),"aria-label":"Remove capability"},null,8,LC)]))),128))])):A("",!0),t("div",NC,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[1]||(x[1]=z=>l.value=z),onKeydown:Ke(fe(F,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,IC),[[Be,l.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:F,disabled:!l.value.trim()}," Add ",8,jC)])]),x[13]||(x[13]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(a(),r("div",RC,[x[18]||(x[18]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",PC,[t("div",FC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:$.value.includes("user"),onChange:x[2]||(x[2]=z=>B("user"))},null,40,WC),x[14]||(x[14]=t("label",{class:"form-check-label",for:"setting-source-user"},[ae(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",BC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:$.value.includes("project"),onChange:x[3]||(x[3]=z=>B("project"))},null,40,HC),x[15]||(x[15]=t("label",{class:"form-check-label",for:"setting-source-project"},[ae(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",VC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:$.value.includes("local"),onChange:x[4]||(x[4]=z=>B("local"))},null,40,UC),x[16]||(x[16]=t("label",{class:"form-check-label",for:"setting-source-local"},[ae(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),t("div",qC,[u.value&&w.value&&k.value?(a(),r("span",zC,[...x[17]||(x[17]=[ae(" Settings sources change requires a ",-1),t("strong",null,"restart",-1),ae(" to take effect. ",-1)])])):(a(),r("span",KC," Select which settings files to load permissions from "))])])):A("",!0),f.value?(a(),r("div",GC,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:x[5]||(x[5]=z=>T.$emit("preview-permissions"))}," Preview Effective Permissions ")])):A("",!0),t("div",YC,[t("a",{class:"text-muted small",role:"button",onClick:x[6]||(x[6]=z=>c.value=!c.value)},b(c.value?"Hide":"Show")+" raw input ",1),c.value?(a(),r("div",JC,[x[19]||(x[19]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:ee(["form-control form-control-sm",h.value]),value:n.formData.allowed_tools,onInput:x[7]||(x[7]=z=>T.$emit("update:form-data","allowed_tools",z.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,QC),x[20]||(x[20]=t("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),t("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:x[8]||(x[8]=z=>T.$emit("update:form-data","capabilities",z.target.value)),placeholder:"python, testing, debugging"},null,40,XC)])):A("",!0)])]))}},eE=oe(ZC,[["__scopeId","data-v-e58aa2be"]]),tE={class:"advanced-tab"},sE={key:0,class:"alert alert-warning mb-3",role:"alert"},nE={class:"mb-3"},oE={for:"config-system-prompt",class:"form-label"},iE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},aE={key:1,class:"field-indicator modified",title:"Modified from template"},rE=["value","rows","placeholder"],lE={class:"form-text"},cE={class:"mb-3 form-check"},uE=["checked"],dE={key:0,class:"form-text text-warning"},mE={class:"mb-3 form-check"},pE=["checked"],fE={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,i=_(()=>s.mode==="create-template"||s.mode==="edit-template"),l=_(()=>s.mode==="edit-session"),c=_(()=>s.session?.state==="active"||s.session?.state==="starting"),d=_(()=>{if(!s.session)return!1;const $=(s.formData.initialization_context||"")!==(s.session.system_prompt||""),k=(s.formData.override_system_prompt||!1)!==(s.session.override_system_prompt||!1),y=(s.formData.sandbox_enabled||!1)!==(s.session.sandbox_enabled||!1);return $||k||y}),p=_(()=>s.formData.initialization_context),f=_(()=>i.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),u=_(()=>s.formData.override_system_prompt?i.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":i.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),w=_(()=>{const $={};return s.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$});function g($){const k=$.target.value;o("update:form-data","initialization_context",k)}return($,k)=>(a(),r("div",tE,[l.value&&c.value&&d.value?(a(),r("div",sE,[...k[2]||(k[2]=[t("small",null,[ae("Changes to these settings require a "),t("strong",null,"reset"),ae(" (not restart) to take effect.")],-1)])])):A("",!0),t("div",nE,[t("label",oE,[ae(b(i.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),r("span",iE," < ")):A("",!0),n.fieldStates.initialization_context==="modified"?(a(),r("span",aE," * ")):A("",!0)]),t("textarea",{id:"config-system-prompt",class:ee(["form-control",w.value]),value:p.value,onInput:g,rows:i.value?4:5,placeholder:f.value},null,42,rE),t("div",lE,b(u.value),1)]),t("div",cE,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:k[0]||(k[0]=y=>$.$emit("update:form-data","override_system_prompt",y.target.checked))},null,40,uE),k[3]||(k[3]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),r("div",dE,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+b(i.value?"":" or legion guide")+").",1)])):A("",!0)]),t("div",mE,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:k[1]||(k[1]=y=>$.$emit("update:form-data","sandbox_enabled",y.target.checked))},null,40,pE),k[4]||(k[4]=t("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),t("div",{class:ee(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,b(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])]))}},vE=oe(fE,[["__scopeId","data-v-09e16a32"]]),hE={class:"modal-dialog modal-lg"},_E={class:"modal-content"},gE={class:"modal-body"},bE={key:0,class:"text-center py-4"},yE={key:1,class:"alert alert-danger"},wE={key:2},$E={class:"mb-3"},kE={class:"small text-muted mb-2"},SE={key:0},CE={key:0,class:"alert alert-info"},EE={key:1},TE={class:"table table-sm table-striped"},xE={key:2,class:"mt-3"},AE={class:"modal-footer"},ME=["disabled"],DE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,i=s,l=R(null);let c=null;const d=R(!1),p=R(""),f=R([]);_e(l,y=>{y&&(c=new vt(y),y.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){c&&(c.show(),g())}function w(){c&&c.hide()}async function g(){d.value=!0,p.value="",f.value=[];try{const y=await ge.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=y.permissions||[]}catch(y){console.error("Failed to load permissions:",y),p.value=y.response?.data?.detail||y.message||"Failed to load permissions"}finally{d.value=!1}}function $(){g()}function k(y){switch(y){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:w}),(y,m)=>(a(),r("div",{ref_key:"modalRef",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",hE,[t("div",_E,[m[7]||(m[7]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",gE,[d.value?(a(),r("div",bE,[...m[0]||(m[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(a(),r("div",yE,b(p.value),1)):(a(),r("div",wE,[t("div",$E,[m[2]||(m[2]=t("h6",null,"Settings Sources",-1)),t("div",kE,[m[1]||(m[1]=ae(" Loading permissions from: ",-1)),(a(!0),r(ce,null,de(n.settingSources,(h,v)=>(a(),r("span",{key:h},[t("code",null,b(h),1),v<n.settingSources.length-1?(a(),r("span",SE,", ")):A("",!0)]))),128))])]),f.value.length===0?(a(),r("div",CE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),r("div",EE,[t("h6",null,"Pre-approved Permissions ("+b(f.value.length)+")",1),t("table",TE,[m[3]||(m[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(a(!0),r(ce,null,de(f.value,h=>(a(),r("tr",{key:h.permission},[t("td",null,[t("code",null,b(h.permission),1)]),t("td",null,[(a(!0),r(ce,null,de(h.sources,(v,S)=>(a(),r("span",{key:v,class:ee(["badge me-1",k(v)])},b(v),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),r("div",xE,[m[4]||(m[4]=t("h6",null,"Session Allowed Tools",-1)),m[5]||(m[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(a(!0),r(ce,null,de(n.sessionAllowedTools,h=>(a(),r("span",{key:h,class:"badge bg-success me-1 mb-1"},b(h),1))),128))])])):A("",!0)]))]),t("div",AE,[m[6]||(m[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:$,disabled:d.value}," Refresh ",8,ME)])])])],512))}},OE=oe(DE,[["__scopeId","data-v-988ff7c4"]]),LE={class:"modal-dialog modal-lg modal-dialog-centered"},NE={class:"modal-content"},IE={class:"modal-header"},jE={id:"configurationModalLabel",class:"modal-title"},RE={class:"modal-body"},PE={key:0,class:"template-list-view"},FE={key:0,class:"alert alert-info"},WE={class:"card-body"},BE={class:"d-flex justify-content-between align-items-start"},HE={class:"flex-grow-1"},VE={class:"card-title mb-1"},UE={key:0,class:"card-text text-muted small mb-2"},qE={class:"template-meta"},zE={class:"badge bg-secondary me-2"},KE={class:"text-muted small"},GE={class:"btn-group btn-group-sm ms-3"},YE=["onClick"],JE=["onClick"],QE={key:1},XE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},ZE={class:"nav-item",role:"presentation"},eT={key:0,class:"error-indicator",title:"This tab has validation errors"},tT={class:"nav-item",role:"presentation"},sT={key:0,class:"error-indicator",title:"This tab has validation errors"},nT={class:"nav-item",role:"presentation"},oT={key:0,class:"error-indicator",title:"This tab has validation errors"},iT={class:"tab-content"},aT={key:2,class:"alert alert-danger mt-3"},rT={class:"modal-footer"},lT={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},cT=["disabled"],uT={key:0,class:"spinner-border spinner-border-sm me-2"},dT={__name:"ConfigurationModal",setup(n){const e=Vt(),s=Fe(),o=ve(),i=ye(),l=R(null);let c=null;const d=R(null),p=R("create-session"),f=R("general"),u=R(null),w=R(null),g=R(null),$=R([]),k=R(null),y=R(null),m=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=$s({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),v=$s({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),S=$s({name:""}),C=_(()=>({general:!!S.name,permissions:!1,advanced:!1})),j=R(!1),F=R(""),E=_(()=>p.value==="create-session"||p.value==="edit-session"),B=_(()=>p.value==="edit-session"||p.value==="edit-template"),T=_(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),x=_(()=>j.value?B.value?"Saving...":"Creating...":B.value?"Save Changes":E.value?"Create Session":"Save Template"),z=_(()=>!(!v.name.trim()||E.value&&v.name.includes(" "))),V=_(()=>w.value?.working_directory?w.value.working_directory:v.working_directory?v.working_directory:s.projects.get(u.value)?.working_directory||""),N=_(()=>!v.allowed_tools||!v.allowed_tools.trim()?[]:v.allowed_tools.split(",").map(W=>W.trim()).filter(W=>W.length>0));function H(){d.value&&d.value.show()}function K(W,Z){v[W]=Z,W==="name"&&(S.name="")}function Y(W){k.value=W,P()}async function I(){try{const W=await ge.get("/api/templates");$.value=W||[]}catch(W){console.error("Failed to load templates:",W),$.value=[]}}function P(){if(!k.value){v.default_role="",v.initialization_context="",v.permission_mode="default",v.allowed_tools="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const W=$.value.find(Z=>Z.template_id===k.value);if(W)if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",W.default_role?(v.default_role=W.default_role,m.value.default_role=W.default_role,h.default_role="autofilled"):(v.default_role="",m.value.default_role=null),W.default_system_prompt?(v.initialization_context=W.default_system_prompt,m.value.initialization_context=W.default_system_prompt,h.initialization_context="autofilled"):(v.initialization_context="",m.value.initialization_context=null),W.permission_mode?(v.permission_mode=W.permission_mode,m.value.permission_mode=W.permission_mode,h.permission_mode="autofilled"):(v.permission_mode="default",m.value.permission_mode=null),W.allowed_tools&&W.allowed_tools.length>0){const Z=W.allowed_tools.join(", ");v.allowed_tools=Z,m.value.allowed_tools=Z,h.allowed_tools="autofilled"}else v.allowed_tools="",m.value.allowed_tools=null}function G(){const Z=(u.value?s.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:Z,currentPath:v.working_directory||"",onSelect:ie=>{v.working_directory=ie}})}function te(){p.value==="create-session"&&(y.value={mode:"create-session",projectId:u.value,formData:{...v},selectedTemplateId:k.value}),p.value="template-list",U()}function ne(){p.value="create-template",U(),f.value="general"}function se(W){p.value="edit-template",g.value=W,U(),pe(W),f.value="general"}async function he(W){if(confirm(`Delete template "${W.name}"?

This action cannot be undone.`))try{await ge.delete(`/api/templates/${W.template_id}`),await I()}catch(Z){console.error("Failed to delete template:",Z),F.value=Z.response?.data?.detail||"Failed to delete template"}}function re(){let W=!0;return S.name="",v.name.trim()||(S.name="Name is required",W=!1),E.value&&v.name.includes(" ")&&(S.name="Session name must be a single word (no spaces)",W=!1),W}async function q(){if(!re()){S.name&&(f.value="general");return}j.value=!0,F.value="";try{switch(p.value){case"create-session":await D(),c&&c.hide();break;case"edit-session":await M(),c&&c.hide();break;case"create-template":await O();break;case"edit-template":await L();break}}catch(W){console.error("Submit failed:",W),F.value=W.response?.data?.detail||W.message||"Operation failed. Please try again."}finally{j.value=!1}}async function D(){if(!u.value)throw new Error("Project ID is missing");const W=v.allowed_tools.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),Z=v.capabilities.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),ie={name:v.name.trim(),model:v.model||null,role:v.default_role.trim()||null,initialization_context:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,capabilities:Z.length>0?Z:null,permission_mode:v.permission_mode,allowed_tools:W.length>0?W:null,working_directory:v.working_directory.trim()||null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources},me=await ge.post(`/api/legions/${u.value}/minions`,ie);if(me.success&&me.minion_id)await s.fetchProjects(),await o.fetchSessions(),v.startImmediately&&await o.startSession(me.minion_id),e.push(`/session/${me.minion_id}`);else throw new Error("Failed to create session")}async function M(){if(!w.value)throw new Error("Session data is missing");const W=w.value.session_id,Z=w.value.state==="active"||w.value.state==="starting",ie=v.allowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),me=v.capabilities.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),Ce={name:v.name.trim(),model:v.model,role:v.default_role.trim()||null,system_prompt:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,allowed_tools:ie.length>0?ie:null,capabilities:me.length>0?me:null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources};await o.patchSession(W,Ce),Z&&v.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(W,v.permission_mode)}async function O(){const W=v.allowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),Z=v.capabilities.split(",").map(me=>me.trim()).filter(me=>me.length>0),ie={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:W.length>0?W:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null,model:v.model||null,capabilities:Z.length>0?Z:null,override_system_prompt:v.override_system_prompt,sandbox_enabled:v.sandbox_enabled};await ge.post("/api/templates",ie),await I(),p.value="template-list",U()}async function L(){if(!g.value)throw new Error("Template data is missing");const W=v.allowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),Z=v.capabilities.split(",").map(me=>me.trim()).filter(me=>me.length>0),ie={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:W.length>0?W:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null,model:v.model||null,capabilities:Z.length>0?Z:null,override_system_prompt:v.override_system_prompt,sandbox_enabled:v.sandbox_enabled};await ge.put(`/api/templates/${g.value.template_id}`,ie),await I(),p.value="template-list",g.value=null,U()}function U(){v.name="",v.model="sonnet",v.permission_mode="default",v.working_directory="",v.description="",v.default_role="",v.startImmediately=!0,v.allowed_tools="",v.capabilities="",v.setting_sources=["user","project","local"],v.system_prompt="",v.override_system_prompt=!1,v.initialization_context="",v.sandbox_enabled=!1,S.name="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},k.value=null,F.value="",f.value="general"}function X(W){v.name=W.name||"",v.model=W.model||"sonnet",v.permission_mode=W.current_permission_mode||"default",v.working_directory=W.working_directory||"",v.default_role=W.role||"",v.initialization_context=W.system_prompt||"",v.override_system_prompt=W.override_system_prompt||!1,v.system_prompt="",v.allowed_tools=W.allowed_tools?.join(", ")||"",v.capabilities=W.capabilities?.join(", ")||"",v.sandbox_enabled=W.sandbox_enabled||!1,v.setting_sources=W.setting_sources||["user","project","local"]}function pe(W){v.name=W.name||"",v.description=W.description||"",v.permission_mode=W.permission_mode||"default",v.default_role=W.default_role||"",v.initialization_context=W.default_system_prompt||"",v.allowed_tools=W.allowed_tools?.join(", ")||"",v.model=W.model||"sonnet",v.capabilities=W.capabilities?.join(", ")||"",v.override_system_prompt=W.override_system_prompt||!1,v.sandbox_enabled=W.sandbox_enabled||!1}function De(){st(()=>{const W=document.getElementById("config-name");W&&(W.focus(),B.value&&W.select())})}function Q(){U(),p.value="create-session",u.value=null,w.value=null,g.value=null,i.hideModal()}return _e(()=>i.currentModal,async(W,Z)=>{if(!(!W||!c)){if(W.name==="configuration"){const ie=W.data||{};p.value=ie.mode||"create-session",u.value=ie.project?.project_id||ie.projectId||null,w.value=ie.session||null,g.value=ie.template||null,U(),p.value==="create-session"&&await I(),p.value==="edit-session"&&w.value?X(w.value):p.value==="edit-template"&&g.value&&pe(g.value),c.show()}else if(W.name==="create-minion"||W.name==="create-session"){const ie=W.data||{};p.value="create-session",u.value=ie.project?.project_id||null,w.value=null,g.value=null,U(),await I(),c.show()}else if(W.name==="edit-session"){const ie=W.data||{};p.value="edit-session",w.value=ie.session||null,u.value=w.value?.project_id||null,g.value=null,U(),w.value&&X(w.value),c.show()}else W.name==="template-management"&&(p.value="template-list",U(),await I(),c.show());Z?.name==="configuration"&&Z.data?.mode?.includes("template")&&W?.name==="configuration"&&p.value==="create-session"&&await I()}}),_e(()=>v.default_role,W=>{m.value.default_role!==null&&(h.default_role=W===m.value.default_role?"autofilled":"modified")}),_e(()=>v.initialization_context,W=>{m.value.initialization_context!==null&&(h.initialization_context=W===m.value.initialization_context?"autofilled":"modified")}),_e(()=>v.permission_mode,W=>{m.value.permission_mode!==null&&(h.permission_mode=W===m.value.permission_mode?"autofilled":"modified")}),_e(()=>v.allowed_tools,W=>{m.value.allowed_tools!==null&&(h.allowed_tools=W===m.value.allowed_tools?"autofilled":"modified")}),ke(()=>{l.value&&Me(()=>import("./modal-D6mKceGM.js").then(W=>W.m),__vite__mapDeps([0,1])).then(W=>{const Z=W.default;c=new Z(l.value),l.value.addEventListener("shown.bs.modal",De),l.value.addEventListener("hidden.bs.modal",Q)})}),Se(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",De),l.value.removeEventListener("hidden.bs.modal",Q)),c&&c.dispose()}),(W,Z)=>(a(),r(ce,null,[t("div",{ref_key:"modalElement",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",LE,[t("div",NE,[t("div",IE,[t("h5",jE,[p.value==="create-template"||p.value==="edit-template"?(a(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:te,title:"Back to template list"}," â† ")):A("",!0),ae(" "+b(T.value),1)]),Z[3]||(Z[3]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",RE,[p.value==="template-list"?(a(),r("div",PE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[Z[4]||(Z[4]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:ne,class:"btn btn-primary btn-sm"}," + Create New ")]),$.value.length===0?(a(),r("div",FE," No templates found. Create your first template! ")):A("",!0),(a(!0),r(ce,null,de($.value,ie=>(a(),r("div",{key:ie.template_id,class:"card mb-2"},[t("div",WE,[t("div",BE,[t("div",HE,[t("h6",VE,b(ie.name),1),ie.description?(a(),r("p",UE,b(ie.description),1)):A("",!0),t("div",qE,[t("span",zE,b(ie.permission_mode),1),t("span",KE,b(ie.allowed_tools?.length||0)+" tools",1)])]),t("div",GE,[t("button",{onClick:me=>se(ie),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,YE),t("button",{onClick:me=>he(ie),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,JE)])])])]))),128))])):(a(),r("div",QE,[t("ul",XE,[t("li",ZE,[t("button",{class:ee(["nav-link",{active:f.value==="general","has-error":C.value.general}]),type:"button",onClick:Z[0]||(Z[0]=ie=>f.value="general")},[Z[5]||(Z[5]=ae(" General ",-1)),C.value.general?(a(),r("span",eT)):A("",!0)],2)]),t("li",tT,[t("button",{class:ee(["nav-link",{active:f.value==="permissions","has-error":C.value.permissions}]),type:"button",onClick:Z[1]||(Z[1]=ie=>f.value="permissions")},[Z[6]||(Z[6]=ae(" Permissions ",-1)),C.value.permissions?(a(),r("span",sT)):A("",!0)],2)]),t("li",nT,[t("button",{class:ee(["nav-link",{active:f.value==="advanced","has-error":C.value.advanced}]),type:"button",onClick:Z[2]||(Z[2]=ie=>f.value="advanced")},[Z[7]||(Z[7]=ae(" Advanced ",-1)),C.value.advanced?(a(),r("span",oT)):A("",!0)],2)])]),t("div",iT,[we(be(fC,{mode:p.value,"form-data":v,errors:S,templates:$.value,"selected-template-id":k.value,session:w.value,"field-states":h,"onUpdate:formData":K,"onUpdate:selectedTemplateId":Y,onOpenFolderBrowser:G,onOpenTemplateManager:te},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[St,f.value==="general"]]),we(be(eE,{mode:p.value,"form-data":v,errors:S,session:w.value,"field-states":h,"onUpdate:formData":K,onPreviewPermissions:H},null,8,["mode","form-data","errors","session","field-states"]),[[St,f.value==="permissions"]]),we(be(vE,{mode:p.value,"form-data":v,errors:S,session:w.value,"field-states":h,"onUpdate:formData":K},null,8,["mode","form-data","errors","session","field-states"]),[[St,f.value==="advanced"]])])])),F.value?(a(),r("div",aT,b(F.value),1)):A("",!0)]),t("div",rT,[t("button",lT,b(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(a(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:j.value||!z.value,onClick:q},[j.value?(a(),r("span",uT)):A("",!0),ae(" "+b(x.value),1)],8,cT)):A("",!0)])])])],512),be(OE,{ref_key:"permissionPreviewModal",ref:d,"working-directory":V.value,"setting-sources":v.setting_sources,"session-allowed-tools":N.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},mT=oe(dT,[["__scopeId","data-v-a2883803"]]),pT={class:"modal-dialog modal-dialog-centered"},fT={class:"modal-content"},vT={class:"modal-header"},hT={class:"modal-title",id:"manageSessionModalLabel"},_T={class:"modal-body"},gT={key:0,class:"text-center py-4"},bT={class:"text-muted"},yT={key:1},wT={key:2},$T={class:"text-muted"},kT={key:0,class:"text-center py-2"},ST={key:1,class:"alert alert-warning mt-3"},CT={class:"mb-0 mt-2"},ET={key:0,class:"text-muted"},TT={key:3},xT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},AT={class:"d-grid gap-2"},MT=["disabled"],DT=["disabled"],OT=["disabled"],LT=["disabled"],NT={class:"modal-footer"},IT={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},jT={__name:"SessionManageModal",setup(n){const e=Vt(),s=ve(),o=ye(),i=at();Oe();const l=R(null),c=R(!1),d=R(""),p=R(""),f=R(null),u=R(null);let w=null;const g=R([]),$=R(!1),k=_(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function y(){f.value="reset"}async function m(){if(f.value="delete",g.value=[],!!l.value){$.value=!0;try{const T=await ge.get(`/api/sessions/${l.value.session_id}/descendants`);g.value=T.descendants||[]}catch(T){console.error("Failed to fetch descendants:",T),g.value=[]}finally{$.value=!1}}}function h(){f.value=null}async function v(){f.value==="reset"?await j():f.value==="delete"&&await F()}async function S(){if(l.value){c.value=!0,d.value="Restarting session...";try{const T=l.value.session_id,x=s.currentSessionId===T,z=await ge.post(`/api/sessions/${T}/restart`);if(z.success)console.log("Session restarted successfully"),x&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(T)),w&&w.hide();else{const V=z.error||z.detail||"Failed to restart session";console.error("Failed to restart session:",V),p.value=`Failed to restart session: ${V}`}}catch(T){console.error("Error restarting session:",T);const x=T.data?.detail||T.message||"Unknown error";p.value=`Error restarting session: ${x}`}finally{c.value=!1}}}async function C(){if(l.value)try{w&&w.hide(),console.log("Ending session",l.value.session_id);const T=l.value.session_id;await ge.post(`/api/sessions/${T}/terminate`),s.currentSessionId===T&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(T){console.error("Error ending session:",T),s.currentSessionId===l.value?.session_id&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function j(){if(l.value){c.value=!0,d.value="Resetting session...";try{const T=l.value.session_id,x=s.currentSessionId===T,z=await ge.post(`/api/sessions/${T}/reset`);if(z.success)console.log("Session reset successfully"),x&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(T)),w&&w.hide();else{const V=z.error||z.detail||"Failed to reset session";console.error("Failed to reset session:",V),p.value=`Failed to reset session: ${V}`,f.value=null}}catch(T){console.error("Error resetting session:",T);const x=T.data?.detail||T.message||"Unknown error";p.value=`Error resetting session: ${x}`,f.value=null}finally{c.value=!1}}}async function F(){if(l.value){c.value=!0,d.value="Deleting session...";try{const T=l.value.session_id;await s.deleteSession(T),e.currentRoute.value.params.sessionId===T&&e.push("/"),w&&w.hide()}catch(T){console.error("Error deleting session:",T);const x=T.data?.detail||T.message||"Unknown error";p.value=`Error deleting session: ${x}`,f.value=null}finally{c.value=!1}}}function E(){f.value=null,c.value=!1,d.value="",p.value="",g.value=[],$.value=!1}function B(){E(),l.value=null,o.hideModal()}return _e(()=>o.currentModal,T=>{if(T?.name==="manage-session"&&w){const x=T.data||{};l.value=x.session,E(),w.show()}}),ke(()=>{u.value&&Me(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{w=new T(u.value),u.value.addEventListener("hidden.bs.modal",B)})}),Se(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",B),w&&w.dispose()}),(T,x)=>(a(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",pT,[t("div",fT,[t("div",vT,[t("h5",hT,b(f.value?k.value:"Manage Session"),1),x[1]||(x[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",_T,[c.value?(a(),r("div",gT,[x[2]||(x[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",bT,b(d.value),1)])):f.value==="reset"?(a(),r("div",yT,[...x[3]||(x[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(a(),r("div",wT,[x[9]||(x[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",$T,[x[4]||(x[4]=ae("This will permanently delete session ",-1)),t("strong",null,b(l.value?.name),1),x[5]||(x[5]=ae(".",-1))]),x[10]||(x[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),$.value?(a(),r("div",kT,[...x[6]||(x[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(a(),r("div",ST,[x[7]||(x[7]=t("strong",null,"Cascading Deletion:",-1)),x[8]||(x[8]=ae(" This session has ",-1)),t("strong",null,b(g.value.length),1),ae(" child session"+b(g.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",CT,[(a(!0),r(ce,null,de(g.value,z=>(a(),r("li",{key:z.session_id,class:"small"},[t("strong",null,b(z.name||z.session_id),1),z.role?(a(),r("span",ET," ("+b(z.role)+")",1)):A("",!0)]))),128))])])):A("",!0)])):(a(),r("div",TT,[p.value?(a(),r("div",xT,[x[11]||(x[11]=t("strong",null,"Error:",-1)),ae(" "+b(p.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:x[0]||(x[0]=z=>p.value="")})])):A("",!0),x[18]||(x[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",AT,[t("button",{class:"btn btn-outline-primary text-start",onClick:S,disabled:c.value},[...x[12]||(x[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,MT),t("button",{class:"btn btn-outline-secondary text-start",onClick:C,disabled:c.value},[...x[13]||(x[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,DT),x[16]||(x[16]=t("hr",{class:"my-2"},null,-1)),x[17]||(x[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:y,disabled:c.value},[...x[14]||(x[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,OT),t("button",{class:"btn btn-outline-danger text-start",onClick:m,disabled:c.value},[...x[15]||(x[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,LT)]),x[19]||(x[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ae(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",NT,[f.value&&!c.value?(a(),r(ce,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),t("button",{type:"button",class:ee(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:v},b(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?A("",!0):(a(),r("button",IT,"Cancel"))])])])],512))}},RT=oe(jT,[["__scopeId","data-v-6b832853"]]),PT={class:"modal-dialog modal-dialog-centered modal-lg"},FT={class:"modal-content"},WT={class:"modal-body"},BT={key:0,class:"text-center text-muted py-4"},HT={key:1},VT={class:"mb-3"},UT={class:"font-monospace small"},qT={class:"mb-3"},zT=["value"],KT={class:"mb-3"},GT={class:"mb-3"},YT={class:"mb-3"},JT={key:0},QT={class:"d-flex flex-wrap gap-1"},XT={key:1,class:"text-muted small"},ZT={key:0,class:"mb-3"},ex={class:"d-flex flex-wrap gap-1"},tx={key:1,class:"mb-3"},sx={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},nx={class:"mb-3"},ox={class:"text-muted"},ix={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},ax={__name:"SessionInfoModal",setup(n){const e=ve(),s=Oe(),o=ye(),i=R(null),l=R(!1),c=R(null);let d=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=_(()=>{if(!i.value)return null;const y=e.initData.get(i.value);return y||(s.messagesBySession.get(i.value)||[]).find(v=>v.type==="system"&&(v.subtype==="init"||v.metadata?.subtype==="init")&&v.metadata?.init_data)?.metadata?.init_data||null});function u(y){return y?p[y]||y:"Default (Sonnet 4.5)"}function w(y){return typeof y=="string"?y:typeof y=="object"&&y.type==="preset"?`Preset: ${y.preset}`:JSON.stringify(y,null,2)}function g(y){y.target.select()}function $(){i.value=null,l.value=!1}function k(){$(),o.hideModal()}return _e(()=>o.currentModal,y=>{if(y?.name==="session-info"&&d){const m=y.data||{};i.value=m.sessionId,l.value=!1,d.show()}}),ke(()=>{c.value&&Me(async()=>{const{default:y}=await import("./modal-D6mKceGM.js").then(m=>m.m);return{default:y}},__vite__mapDeps([0,1])).then(({default:y})=>{d=new y(c.value),c.value.addEventListener("hidden.bs.modal",k)})}),Se(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",k),d&&d.dispose()}),(y,m)=>(a(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",PT,[t("div",FT,[m[9]||(m[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",WT,[f.value?(a(),r("div",HT,[t("div",VT,[m[1]||(m[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",UT,b(i.value),1)]),t("div",qT,[m[2]||(m[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:g},null,8,zT)]),t("div",KT,[m[3]||(m[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,b(u(f.value.model)),1)]),t("div",GT,[m[4]||(m[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,b(f.value.permissionMode||"default"),1)]),t("div",YT,[m[5]||(m[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(a(),r("div",JT,[t("div",QT,[(a(!0),r(ce,null,de(f.value.allowed_tools||f.value.tools,h=>(a(),r("span",{key:h,class:"badge bg-secondary"},b(h),1))),128))])])):(a(),r("div",XT,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(a(),r("div",ZT,[m[6]||(m[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",ex,[(a(!0),r(ce,null,de(f.value.commands,h=>(a(),r("span",{key:h,class:"badge bg-info"},b(h),1))),128))])])):A("",!0),f.value.systemPrompt?(a(),r("div",tx,[m[7]||(m[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",sx,b(w(f.value.systemPrompt)),1)])):A("",!0),t("div",nx,[t("h6",ox,[m[8]||(m[8]=ae(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:m[0]||(m[0]=h=>l.value=!l.value)},b(l.value?"Hide":"Show"),1)]),l.value?(a(),r("pre",ix,b(JSON.stringify(f.value,null,2)),1)):A("",!0)])])):(a(),r("div",BT," No session configuration data available "))]),m[10]||(m[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},rx=oe(ax,[["__scopeId","data-v-b28b39b3"]]),lx={class:"modal-dialog modal-dialog-centered modal-lg"},cx={class:"modal-content"},ux={class:"modal-body"},dx={key:0,class:"text-center text-muted py-4"},mx={key:1},px={class:"mb-3"},fx={class:"mb-3"},vx={class:"font-monospace small"},hx={class:"mb-3"},_x={class:"mb-3"},gx={class:"mb-3"},bx={key:0},yx={class:"d-flex flex-wrap gap-1"},wx={key:1,class:"text-muted small"},$x={class:"mb-3"},kx={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},Sx={key:1,class:"text-muted small"},Cx={class:"mb-3"},Ex={key:0,class:"badge bg-info"},Tx={key:1,class:"badge bg-secondary"},xx={class:"mb-3"},Ax={key:0,class:"font-monospace small"},Mx={key:1,class:"text-muted small"},Dx={key:0,class:"mb-3"},Ox={key:0},Lx={class:"list-unstyled mb-0"},Nx={key:1,class:"text-muted small"},Ix={class:"mb-3"},jx={class:"small"},Rx={class:"mb-3"},Px={class:"small"},Fx={__name:"MinionViewModal",setup(n){const e=ye(),s=R(null),o=R(null);let i=null;function l(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function c(f){if(!f)return"N/A";try{const u=new Date(f);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function d(){s.value=null}function p(){d(),e.hideModal()}return _e(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const u=f.data||{};s.value=u.session,i.show()}}),ke(()=>{o.value&&Me(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),Se(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(f,u)=>(a(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",lx,[t("div",cx,[u[11]||(u[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ux,[s.value?(a(),r("div",mx,[t("div",px,[u[0]||(u[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,b(s.value.name||"Unnamed Minion"),1)]),t("div",fx,[u[1]||(u[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",vx,b(s.value.session_id),1)]),t("div",hx,[u[2]||(u[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,b(s.value.role||"Not specified"),1)]),t("div",_x,[u[3]||(u[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:ee(["badge",l(s.value.state)])},b(s.value.state),3)])]),t("div",gx,[u[4]||(u[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(a(),r("div",bx,[t("div",yx,[(a(!0),r(ce,null,de(s.value.capabilities,w=>(a(),r("span",{key:w,class:"badge bg-secondary"},b(w),1))),128))])])):(a(),r("div",wx,"None"))]),t("div",$x,[u[5]||(u[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(a(),r("div",kx,b(s.value.initialization_context),1)):(a(),r("div",Sx,"Not specified"))]),t("div",Cx,[u[6]||(u[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(a(),r("span",Ex,"Yes")):(a(),r("span",Tx,"No"))])]),t("div",xx,[u[7]||(u[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(a(),r("div",Ax,b(s.value.parent_overseer_id),1)):(a(),r("div",Mx," Root overseer (user-created) "))]),s.value.is_overseer?(a(),r("div",Dx,[u[8]||(u[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(a(),r("div",Ox,[t("ul",Lx,[(a(!0),r(ce,null,de(s.value.child_minion_ids,w=>(a(),r("li",{key:w,class:"font-monospace small"},b(w),1))),128))])])):(a(),r("div",Nx,"No children"))])):A("",!0),t("div",Ix,[u[9]||(u[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",jx,b(c(s.value.created_at)),1)]),t("div",Rx,[u[10]||(u[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",Px,b(c(s.value.updated_at)),1)])])):(a(),r("div",dx," No minion data available "))]),u[12]||(u[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},Wx=oe(Fx,[["__scopeId","data-v-d996dc6f"]]),Bx={class:"modal-dialog modal-dialog-centered"},Hx={class:"modal-content"},Vx={class:"modal-header"},Ux={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},qx={class:"modal-body"},zx={key:0},Kx={key:0,class:"text-center py-3"},Gx={key:1,class:"card bg-light mb-3"},Yx={class:"card-body py-2 px-3"},Jx={class:"small"},Qx={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},Xx={key:0,class:"text-warning mt-1"},Zx={key:2,class:"alert alert-warning py-2 small"},e2={key:1,class:"text-center py-3"},t2={key:0,class:"mb-3"},s2={key:1,class:"mb-3"},n2={key:2,class:"mb-3"},o2={class:"text-muted small mt-1"},i2={key:3,class:"mb-3"},a2={class:"mt-2 text-danger"},r2={class:"modal-footer"},l2=["disabled"],c2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},u2={__name:"RestartModal",setup(n){const e=ye(),s=R(null);let o=null;const i=R("confirm"),l=R(!1),c=R(null),d=R(null),p=R(""),f=R(60);let u=null,w=null;async function g(){l.value=!0,d.value=null;try{c.value=await Vi()}catch(v){d.value=v.message||"Unknown error"}finally{l.value=!1}}async function $(){i.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Ui(),e.restartStatus="restarting",k()}catch(v){e.restartStatus="error",p.value=v.message||"Restart failed",e.restartInProgress=!1}}function k(){e.restartStatus="reconnecting",f.value=60;const v=Date.now();w=setInterval(()=>{const S=Math.floor((Date.now()-v)/1e3);f.value=Math.max(0,60-S)},1e3),setTimeout(()=>{u=setInterval(async()=>{try{(await fetch("/health")).ok&&(y(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-v>6e4&&(y(),e.restartStatus="error",p.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function y(){u&&(clearInterval(u),u=null),w&&(clearInterval(w),w=null)}function m(){i.value="confirm",c.value=null,d.value=null,p.value="",f.value=60,y()}function h(){e.restartInProgress||(m(),e.restartStatus="idle"),e.hideModal()}return _e(()=>e.currentModal,v=>{v?.name==="restart-server"&&o&&(m(),o.show(),g())}),ke(()=>{s.value&&Me(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{o=new v(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",h)})}),Se(()=>{y(),s.value&&s.value.removeEventListener("hidden.bs.modal",h),o&&o.dispose()}),(v,S)=>(a(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",Bx,[t("div",Hx,[t("div",Vx,[S[0]||(S[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),i.value==="confirm"?(a(),r("button",Ux)):A("",!0)]),t("div",qx,[i.value==="confirm"?(a(),r("div",zx,[S[5]||(S[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),l.value?(a(),r("div",Kx,[...S[1]||(S[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):c.value?(a(),r("div",Gx,[t("div",Yx,[t("div",Jx,[t("div",null,[S[2]||(S[2]=t("strong",null,"Branch:",-1)),ae(" "+b(c.value.branch),1)]),t("div",null,[S[3]||(S[3]=t("strong",null,"Last commit:",-1)),ae(" "+b(c.value.last_commit_message),1)]),t("div",Qx,b(c.value.last_commit_hash?.substring(0,12)),1),c.value.has_uncommitted_changes?(a(),r("div",Xx,[...S[4]||(S[4]=[t("strong",null,"Warning:",-1),ae(" Uncommitted changes detected. git pull may fail. ",-1)])])):A("",!0)])])])):d.value?(a(),r("div",Zx," Could not fetch git status: "+b(d.value),1)):A("",!0)])):i.value==="progress"?(a(),r("div",e2,[le(e).restartStatus==="pulling"?(a(),r("div",t2,[...S[6]||(S[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):le(e).restartStatus==="restarting"?(a(),r("div",s2,[...S[7]||(S[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):le(e).restartStatus==="reconnecting"?(a(),r("div",n2,[S[8]||(S[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),S[9]||(S[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",o2,b(f.value)+"s remaining",1)])):le(e).restartStatus==="error"?(a(),r("div",i2,[S[10]||(S[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",a2,b(p.value),1)])):A("",!0)])):A("",!0)]),t("div",r2,[i.value==="confirm"?(a(),r(ce,{key:0},[S[11]||(S[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:$,disabled:l.value}," Pull & Restart ",8,l2)],64)):le(e).restartStatus==="error"?(a(),r("button",c2,"Close")):A("",!0)])])])],512))}},d2={class:"container-fluid vh-100 d-flex flex-column p-0"},m2={class:"d-flex flex-grow-1 overflow-hidden position-relative"},p2={class:"flex-grow-1 d-flex flex-column overflow-hidden"},f2={__name:"App",setup(n){const e=ye(),s=at(),o=ve(),i=Fe(),l=Ct(),c=Ve(),d=Vt(),p=R(null);function f(m){p.value=m}wn("addAttachmentFromResource",f),wn("pendingResourceAttachment",p);const u=_(()=>e.sidebarCollapsed),w=_(()=>e.rightSidebarCollapsed),g=_(()=>e.isMobile);_e(()=>l.currentHasTasks,(m,h)=>{m&&!h&&e.setRightSidebarCollapsed(!1)}),_e(()=>c.currentHasResources,(m,h)=>{m&&!h&&e.setRightSidebarCollapsed(!1)}),ke(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const m=window.location.hash;if(m.startsWith("#/session/")){const h=m.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(m.startsWith("#/timeline/")){const h=m.replace("#/timeline/","");d.push(`/timeline/${h}`)}window.addEventListener("popstate",$),window.addEventListener("resize",e.handleResize)}),Se(()=>{window.removeEventListener("popstate",$),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function $(){const m=window.location.hash;if(m.startsWith("#/session/")){const h=m.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function k(){e.toggleSidebar()}function y(){e.toggleRightSidebar()}return(m,h)=>{const v=bo("router-view");return a(),r("div",d2,[be(bw),t("div",{id:"sidebar-backdrop",class:ee({show:!u.value&&g.value}),onClick:k},null,2),t("div",{id:"right-sidebar-backdrop",class:ee({show:!w.value&&g.value}),onClick:y},null,2),t("div",m2,[be(Yw),t("main",p2,[be(v)]),be(S0)]),be(B0),be(nS),be(CS),be(mT),be(RT),be(rx),be(Wx),be(u2)])}}},pn=Ni(f2);pn.use(Ii());pn.use(dw);pn.mount("#app");
