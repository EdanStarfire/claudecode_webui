const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as s,o as a,d as tt,r as P,b as h,t as y,e as O,n as te,f as Je,g as ie,u as os,w as fe,h as bs,F as re,i as ce,j as ge,v as Re,k as be,l as po,m as pe,p as Ue,q as ve,s as kt,x as ye,y as Si,z as fo,A as Se,B as _n,C as vo,D as Ft,E as Ei,G as Ci,H as ho,T as Ti,I as xi,J as Ai,K as Mi,L as ys,M as ws,N as gn,O as Oi,P as Di}from"./vue-vendor-CkFj9aRq.js";import{m as ut,p as cs}from"./markdown-vendor-BRsjnVvP.js";import{c as Ni}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const Li={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ii={__name:"NoSessionSelected",setup(n){return(e,t)=>(a(),l("div",Li,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},ji="modulepreload",Pi=function(n){return"/"+n},bn={},Te=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let d=function(f){return Promise.all(f.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),p=c?.nonce||c?.getAttribute("nonce");i=d(t.map(f=>{if(f=Pi(f),f in bn)return;bn[f]=!0;const u=f.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${w}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":ji,u||(g.as="script"),g.crossOrigin="",g.href=f,p&&g.setAttribute("nonce",p),document.head.appendChild(g),u)return new Promise(($,k)=>{g.addEventListener("load",$),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${f}`)))})}))}function r(c){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=c,window.dispatchEvent(p),!p.defaultPrevented)throw c}return i.then(c=>{for(const p of c||[])p.status==="rejected"&&r(p.reason);return e().catch(r)})};class $s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function St(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new $s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof $s?t:(console.error("API request failed:",t),new $s(`Network error: ${t.message}`,0,null))}}async function _o(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[p,d]of Object.entries(e.params))d!=null&&o.append(p,d);const i=o.toString();i&&(t=`${n}?${i}`);const{params:r,...c}=e;return St(t,{...c,method:"GET"})}return St(t,{...e,method:"GET"})}async function Ri(n,e,t={}){return St(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Wi(n,e,t={}){return St(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Fi(n,e={}){return St(n,{...e,method:"DELETE"})}async function Bi(n,e,t={}){return St(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const me={get:_o,post:Ri,put:Wi,delete:Fi,patch:Bi},de=tt("session",()=>{const n=P(new Map),e=P(null),t=P(new Map),o=P(new Map),i=P(new Set),r=P(!1);let c=null;const p=h(()=>n.value.get(e.value)),d=h(()=>Array.from(n.value.values()).sort((D,W)=>D.order-W.order)),f=D=>h(()=>d.value.filter(W=>W.project_id===D)),u=h({get:()=>t.value.get(e.value)||"",set:D=>{e.value&&t.value.set(e.value,D)}});async function w(){try{const D=await me.get("/api/sessions");return n.value.clear(),D.sessions.forEach(W=>{n.value.set(W.session_id,W)}),console.log(`Loaded ${n.value.size} sessions`),D.sessions}catch(D){throw console.error("Failed to fetch sessions:",D),D}}async function g(D,W){try{const A=(await me.post("/api/sessions",{project_id:D,...W})).session_id,G=(await me.get(`/api/sessions/${A}`)).session;return n.value.set(A,G),n.value=new Map(n.value),console.log(`Created session ${A}`),G}catch(T){throw console.error("Failed to create session:",T),T}}async function $(D){if(e.value===D&&!r.value)return;c&&(console.log(`Aborting pending selection to switch to ${D}`),c.abort(),c=null);const W=new AbortController;c=W,r.value=!0;try{if(e.value=D,W.signal.aborted){console.log(`Selection of ${D} aborted early`);return}let T=n.value.get(D);if(!T)try{const L=await me.get(`/api/sessions/${D}`);if(W.signal.aborted){console.log(`Selection of ${D} aborted after fetch`);return}T=L.session,n.value.set(D,T),n.value=new Map(n.value),console.log(`Fetched session ${D} for deeplink`)}catch(L){console.error(`Failed to fetch session ${D}:`,L);return}if(T&&(T.state==="created"||T.state==="terminated"))try{if(await v(D),W.signal.aborted){console.log(`Selection of ${D} aborted after start`);return}console.log(`Auto-started session ${D} (was in ${T.state} state)`);const L=6e4,F=200,q=5e3;let Z=0,N=0;for(;Z<L;){if(W.signal.aborted){console.log(`Selection of ${D} aborted during state wait`);return}const C=n.value.get(D);if(C&&C.state==="active"){console.log(`Session ${D} is now active after ${Z}ms`);break}if(Z-N>=q){const M=n.value.get(D)?.state||"unknown";console.log(`Waiting for session ${D} to become active (current: ${M}, ${Z/1e3}s elapsed)`),N=Z}await new Promise(M=>setTimeout(M,F)),Z+=F}const S=n.value.get(D);S&&S.state!=="active"&&console.warn(`Session ${D} did not become active within ${L/1e3}s (state: ${S.state}), continuing anyway`)}catch(L){console.error(`Failed to auto-start session ${D}:`,L)}if(W.signal.aborted){console.log(`Selection of ${D} aborted before message load`);return}if(await(await Te(()=>Promise.resolve().then(()=>ua),void 0)).useMessageStore().loadMessages(D),W.signal.aborted){console.log(`Selection of ${D} aborted after message load`);return}if(await(await Te(()=>Promise.resolve().then(()=>Da),void 0)).useResourceStore().loadResources(D),W.signal.aborted){console.log(`Selection of ${D} aborted after resource load`);return}await(await Te(()=>Promise.resolve().then(()=>Na),void 0)).useWebSocketStore().connectSession(D),W.signal.aborted||console.log(`Selected session ${D}`)}finally{c===W&&(c=null),r.value=!1}}function k(D,W){const T=n.value.get(D);T?Object.assign(T,W):(n.value.set(D,W),console.log(`Added new session ${D} via WebSocket update`)),n.value=new Map(n.value)}async function b(D){i.value.add(D);try{const T=(await me.delete(`/api/sessions/${D}`)).deleted_session_ids||[D];for(const A of T)n.value.delete(A),t.value.delete(A),o.value.delete(A);return n.value=new Map(n.value),T.includes(e.value)&&(e.value=null),console.log(`Deleted ${T.length} session(s): ${T.join(", ")}`),T}catch(W){throw console.error("Failed to delete session:",W),W}finally{i.value.delete(D)}}async function m(D,W){try{await me.patch(`/api/sessions/${D}`,W),k(D,W),console.log(`Updated session ${D}:`,W)}catch(T){throw console.error("Failed to update session:",T),T}}async function _(D,W){try{await me.post(`/api/sessions/${D}/permission-mode`,{mode:W}),k(D,{current_permission_mode:W});const T=o.value.get(D);T&&(T.permissionMode=W,o.value.set(D,T)),console.log(`Set permission mode for session ${D} to ${W}`)}catch(T){throw console.error("Failed to set permission mode:",T),T}}async function v(D){try{await me.post(`/api/sessions/${D}/start`),console.log(`Started session ${D}`)}catch(W){throw console.error("Failed to start session:",W),W}}async function x(D){try{await me.post(`/api/sessions/${D}/pause`),console.log(`Paused session ${D}`)}catch(W){throw console.error("Failed to pause session:",W),W}}async function E(D){try{await me.post(`/api/sessions/${D}/terminate`),console.log(`Terminated session ${D}`)}catch(W){throw console.error("Failed to terminate session:",W),W}}function R(D){return n.value.get(D)}function I(D,W){o.value.set(D,W),W.permissionMode&&k(D,{current_permission_mode:W.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:p,orderedSessions:d,sessionsInProject:f,currentInput:u,fetchSessions:w,createSession:g,selectSession:$,updateSession:k,deleteSession:b,patchSession:m,setPermissionMode:_,startSession:v,pauseSession:x,terminateSession:E,getSession:R,storeInitData:I}}),yn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:de},Symbol.toStringTag,{value:"Module"})),_e=tt("ui",()=>{const n=P(window.innerWidth<768),e=P(300),t=P(!0),o=P(300),i=P(window.innerWidth),r=h(()=>i.value<768),c=P(!0),p=P(null),d=P(null),f=h(()=>p.value?{name:p.value,data:d.value}:null),u=P(!1),w=P("Loading...");function g(){n.value=!n.value}function $(W){n.value=W}function k(W){e.value=Math.max(200,Math.min(W,window.innerWidth*.3))}function b(){t.value=!t.value}function m(W){t.value=W}function _(W){o.value=Math.max(200,Math.min(W,window.innerWidth*.3))}function v(W){c.value=W}function x(W,T=null){p.value=null,d.value=null,setTimeout(()=>{p.value=W,d.value=T},0)}function E(){p.value=null,d.value=null}function R(W="Loading..."){u.value=!0,w.value=W}function I(){u.value=!1}function D(){const W=i.value;i.value=window.innerWidth,i.value<768&&W>=768?n.value=!0:i.value>=768&&W<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:r,autoScrollEnabled:c,activeModal:p,modalData:d,currentModal:f,isLoading:u,loadingMessage:w,toggleSidebar:g,setSidebarCollapsed:$,setSidebarWidth:k,toggleRightSidebar:b,setRightSidebarCollapsed:m,setRightSidebarWidth:_,setAutoScroll:v,showModal:x,hideModal:E,showLoading:R,hideLoading:I,handleResize:D}}),Ie=tt("project",()=>{const n=P(new Map),e=P(null),t=h(()=>n.value.get(e.value)),o=h(()=>Array.from(n.value.values()).sort((m,_)=>m.order-_.order));async function i(){try{const m=await me.get("/api/projects");return n.value.clear(),m.projects.forEach(_=>{n.value.set(_.project_id,_)}),console.log(`Loaded ${n.value.size} projects`),m.projects}catch(m){throw console.error("Failed to fetch projects:",m),m}}async function r(m,_){try{const x=(await me.post("/api/projects",{name:m,working_directory:_})).project;return n.value.set(x.project_id,x),n.value=new Map(n.value),console.log(`Created project ${x.project_id}`),x}catch(v){throw console.error("Failed to create project:",v),v}}async function c(m,_){try{await me.put(`/api/projects/${m}`,_),p(m,_),console.log(`Updated project ${m}`,_)}catch(v){throw console.error("Failed to update project:",v),v}}function p(m,_){const v=n.value.get(m);v&&(Object.assign(v,_),n.value=new Map(n.value))}async function d(m){try{await me.delete(`/api/projects/${m}`),n.value.delete(m),n.value=new Map(n.value),e.value===m&&(e.value=null),console.log(`Deleted project ${m}`)}catch(_){throw console.error("Failed to delete project:",_),_}}async function f(m){try{const _=await me.put(`/api/projects/${m}/toggle-expansion`),v=n.value.get(m);return v&&(v.is_expanded=_.is_expanded,n.value=new Map(n.value)),_.is_expanded}catch(_){throw console.error("Failed to toggle expansion:",_),_}}async function u(m){try{await me.put("/api/projects/reorder",{project_ids:m}),m.forEach((_,v)=>{const x=n.value.get(_);x&&(x.order=v)}),n.value=new Map(n.value),console.log("Reordered projects",m)}catch(_){throw console.error("Failed to reorder projects:",_),_}}async function w(m,_){try{await me.put(`/api/projects/${m}/sessions/reorder`,{session_ids:_});const v=n.value.get(m);v&&(v.session_ids=_,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${m}`,_)}catch(v){throw console.error("Failed to reorder sessions:",v),v}}function g(m){return n.value.get(m)}function $(m){e.value=m}function k(){e.value=null}function b(m){if(!m)return"";const _=m.split(/[/\\]/).filter(v=>v);return _.length===0?"/":_.length===1?`/${_[0]}`:_.length===2?`/${_.join("/")}`:`.../${_.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:r,updateProject:c,updateProjectLocal:p,deleteProject:d,toggleExpansion:f,reorderProjects:u,reorderSessionsInProject:w,getProject:g,selectProject:$,clearProjectSelection:k,formatPath:b}}),$t=tt("task",()=>{const n=P(new Map),e=P(new Set);function t(v){const x=n.value.get(v);return x?Array.from(x.values()).sort((E,R)=>{const I=parseInt(E.id.replace(/\D/g,""))||0,D=parseInt(R.id.replace(/\D/g,""))||0;return I-D}):[]}function o(v){return t(v).find(E=>E.status==="in_progress")||null}function i(v){const x=t(v);return{total:x.length,completed:x.filter(E=>E.status==="completed").length,inProgress:x.filter(E=>E.status==="in_progress").length,pending:x.filter(E=>E.status==="pending").length}}function r(v){return e.value.has(v)}const c=h(()=>{const v=de();return t(v.currentSessionId)}),p=h(()=>{const v=de();return o(v.currentSessionId)}),d=h(()=>{const v=de();return i(v.currentSessionId)}),f=h(()=>{const v=de();return r(v.currentSessionId)});function u(v,x){n.value.has(v)||n.value.set(v,new Map),n.value.get(v).set(x.id,{id:x.id,subject:x.subject||"",description:x.description||"",status:x.status||"pending",activeForm:x.activeForm||null,owner:x.owner||null,blocks:x.blocks||[],blockedBy:x.blockedBy||[],metadata:x.metadata||{}}),e.value.add(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${x.id} for session ${v}`)}function w(v,x,E){const R=n.value.get(v);if(!R){console.warn(`No tasks found for session ${v}`);return}const I=R.get(x);if(!I){u(v,{id:x,...E});return}E.subject!==void 0&&(I.subject=E.subject),E.description!==void 0&&(I.description=E.description),E.status!==void 0&&(I.status=E.status),E.activeForm!==void 0&&(I.activeForm=E.activeForm),E.owner!==void 0&&(I.owner=E.owner),E.metadata!==void 0&&(I.metadata={...I.metadata,...E.metadata}),E.addBlocks&&(I.blocks=[...new Set([...I.blocks,...E.addBlocks])]),E.addBlockedBy&&(I.blockedBy=[...new Set([...I.blockedBy,...E.addBlockedBy])]),E.status==="deleted"&&(R.delete(x),R.size===0&&(e.value.delete(v),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${x} for session ${v}`,E)}function g(v,x){return n.value.get(v)?.get(x)||null}function $(v){n.value.delete(v),e.value.delete(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${v}`)}function k(v,x){n.value.has(v)&&n.value.get(v).clear(),e.value.delete(v);const E=new Map;for(const R of x){if(R.metadata?.tool_uses)for(const I of R.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name)&&E.set(I.id,{name:I.name,input:I.input});if(R.metadata?.tool_results)for(const I of R.metadata.tool_results){const D=E.get(I.tool_use_id);D&&(b(v,D.name,D.input,{error:I.is_error,content:I.content}),E.delete(I.tool_use_id))}}console.log(`Reconstructed ${n.value.get(v)?.size||0} tasks for session ${v}`)}function b(v,x,E,R){if(R?.error){console.log(`Skipping task update - tool ${x} returned error`);return}const I=m(R);if(I)switch(x){case"TaskCreate":{const D=_(I)||E?.id;D&&u(v,{id:D,subject:E?.subject||"",description:E?.description||"",status:"pending",activeForm:E?.activeForm||null,owner:E?.owner||null,blocks:[],blockedBy:[],metadata:E?.metadata||{}});break}case"TaskUpdate":{const D=E?.taskId;D&&w(v,D,{status:E?.status,subject:E?.subject,description:E?.description,activeForm:E?.activeForm,owner:E?.owner,metadata:E?.metadata,addBlocks:E?.addBlocks,addBlockedBy:E?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{E?.taskId;break}}}function m(v){return v?typeof v=="string"?v:v.content?typeof v.content=="string"?v.content:JSON.stringify(v.content):v.message?v.message:JSON.stringify(v):null}function _(v){if(!v)return null;const x=v.match(/[Tt]ask\s*#(\d+)/i);if(x)return x[1];const E=v.match(/#(\d+)/);return E?E[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:p,currentTaskStats:d,currentHasTasks:f,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:r,getTask:g,createTask:u,updateTask:w,clearTasks:$,reconstructFromMessages:k,handleTaskToolResult:b}}),ne=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Hi={class:"session-header border-bottom p-3 d-flex justify-content-between align-items-center"},Vi={class:"project-name"},Ui=["title"],qi=["title"],zi={class:"toggle-icon"},Ki={key:0,class:"task-badge ms-1"},Gi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=Ie(),i=$t(),r=_e(),c=h(()=>t.sessions.get(e.sessionId)),p=h(()=>c.value?.name||e.sessionId),d=h(()=>{for(const k of o.projects.values())if(k.session_ids?.includes(e.sessionId))return k;return null}),f=h(()=>d.value?.name||"Unknown Project"),u=h(()=>i.hasTasks(e.sessionId)),w=h(()=>i.taskStats(e.sessionId)),g=h(()=>r.rightSidebarCollapsed);function $(){r.toggleRightSidebar()}return(k,b)=>(a(),l("div",Hi,[s("div",null,[s("div",Vi,y(f.value),1),s("div",{class:"session-name",title:n.sessionId},y(p.value),9,Ui)]),s("button",{class:te(["btn btn-sm sidebar-toggle-btn",{"btn-primary":!g.value,"btn-outline-secondary":g.value}]),onClick:$,title:g.value?"Show panel":"Hide panel"},[s("span",zi,y(g.value?"â—€":"â–¶"),1),u.value?(a(),l("span",Ki,"ðŸ“‹ "+y(w.value.completed)+"/"+y(w.value.total),1)):O("",!0)],10,qi)]))}},Yi=ne(Gi,[["__scopeId","data-v-9406aba2"]]),Ji={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Qi=["title"],Xi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Zi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=h(()=>t.sessions.get(e.sessionId)),i=h(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=h(()=>{const d=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[d]||"#d3d3d3"}),c=h(()=>{const d=i.value;return d==="starting"||d==="processing"||d==="pending-prompt"}),p=h(()=>{if(!o.value)return"No session selected";const d=i.value,f=d.charAt(0).toUpperCase()+d.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${u}${w}: ${f}`});return(d,f)=>(a(),l("div",Ji,[o.value?(a(),l("div",{key:0,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:Je({width:"100%",backgroundColor:r.value}),title:p.value},null,14,Qi)):(a(),l("div",Xi))]))}},ea=ne(Zi,[["__scopeId","data-v-63d222fe"]]),ta={class:"session-status-bar border-top p-2 bg-light"},sa={class:"d-flex justify-content-between align-items-center gap-2"},na={class:"d-flex gap-2"},oa=["disabled"],ia={class:"mode-label"},aa=["disabled"],ra=["disabled"],la={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_e(),i=h(()=>t.sessions.get(e.sessionId)),r=h(()=>i.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},p=h(()=>c[r.value]||"ðŸ”’"),d=h(()=>r.value),f=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(r.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(_){console.error("Failed to cycle permission mode:",_)}return}const b=(f.indexOf(r.value)+1)%f.length,m=f[b];try{await t.setPermissionMode(e.sessionId,m)}catch(_){console.error("Failed to cycle permission mode:",_)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},$=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(k,b)=>(a(),l("div",ta,[s("div",sa,[s("div",na,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[ie(y(p.value)+" ",1),s("span",ia,y(d.value),1)],8,oa),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!i.value},[...b[0]||(b[0]=[ie(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,aa),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...b[1]||(b[1]=[ie(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,ra)]),s("div",null,[s("button",{class:te(["btn btn-sm",os(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:$}," â¬‡ï¸ "+y(os(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},ca=ne(la,[["__scopeId","data-v-fdcd3535"]]),xe=tt("message",()=>{const n=P(new Map),e=P(new Map),t=P(new Map),o=P(new Map),i=P(new Map),r=P(new Map),c=P(new Map),p=P(new Map),d=h(()=>{const N=de();return n.value.get(N.currentSessionId)||[]}),f=h(()=>{const N=de();return e.value.get(N.currentSessionId)||[]});async function u(N,S=null,C=0){try{const M=S||1e4,V=await me.get(`/api/sessions/${N}/messages?limit=${M}&offset=${C}`),K=V.messages||[],J=V.total_count||K.length,Q=V.has_more||!1;if(console.log(`Loaded ${K.length} of ${J} messages for session ${N}`),n.value.set(N,K),K.length>0){const j=K[K.length-1];j.timestamp&&(c.value.set(N,j.timestamp),console.log(`Tracked last received timestamp for session ${N}: ${j.timestamp}`))}const se=new Set;K.forEach(j=>{j.type==="assistant"&&j.metadata?.tool_uses&&j.metadata.tool_uses.forEach(H=>{se.add(H.id)}),j.type==="user"&&j.metadata?.tool_results&&j.metadata.tool_results.forEach(H=>{se.delete(H.tool_use_id);const ee=r.value.get(N);ee&&ee.delete(H.tool_use_id)}),j.type==="system"&&j.metadata?.subtype==="client_launched"&&(se.forEach(H=>{T(N,H,"Session was restarted")}),se.clear()),j.type==="system"&&j.metadata?.subtype==="interrupt"&&(se.forEach(H=>{T(N,H,"Session was interrupted")}),se.clear()),j.metadata?.has_tool_uses&&j.metadata.tool_uses&&j.metadata.tool_uses.forEach(H=>{b(N,H,j.timestamp)}),j.metadata?.has_tool_results&&j.metadata.tool_results&&j.metadata.tool_results.forEach(H=>{x(N,H)}),(j.type==="permission_request"||j.metadata?.has_permission_requests)&&m(N,j),j.type==="permission_response"&&_(N,{request_id:j.metadata?.request_id,decision:j.metadata?.decision,updated_input:j.metadata?.updated_input,reasoning:j.metadata?.reasoning,applied_updates:j.metadata?.applied_updates}),j.type==="system"&&(j.subtype==="init"||j.metadata?.subtype==="init")&&j.metadata?.init_data&&de().storeInitData(N,j.metadata.init_data)});const B=de().sessions.get(N);B&&!["active","paused","starting"].includes(B.state)&&(se.forEach(j=>{T(N,j,"Session was terminated")}),se.clear()),i.value.set(N,se),n.value=new Map(n.value);try{$t().reconstructFromMessages(N,K)}catch(j){console.warn("Failed to reconstruct task state:",j)}return Q&&console.warn(`Warning: Only loaded ${K.length} of ${J} messages. Some messages may be missing.`),{messages:K,totalCount:J,hasMore:Q}}catch(M){throw console.error("Failed to load messages:",M),M}}function w(N,S){const C=i.value.get(N)||new Set;S.type==="assistant"&&S.metadata?.tool_uses&&S.metadata.tool_uses.forEach(M=>{C.add(M.id)}),S.type==="user"&&S.metadata?.tool_results&&S.metadata.tool_results.forEach(M=>{C.delete(M.tool_use_id);const V=r.value.get(N);V&&V.delete(M.tool_use_id)}),S.type==="system"&&S.metadata?.subtype==="client_launched"&&(C.forEach(M=>{T(N,M,"Session was restarted")}),C.clear()),S.type==="system"&&S.metadata?.subtype==="interrupt"&&(C.forEach(M=>{T(N,M,"Session was interrupted")}),C.clear()),i.value.set(N,C)}function g(N,S){n.value.has(N)||n.value.set(N,[]);const C=n.value.get(N);if(S.id){const M=C.findIndex(V=>V.id===S.id);if(M!==-1){console.log(`Skipping duplicate message ${S.id} (already exists at index ${M})`);return}}C.push(S),S.timestamp&&c.value.set(N,S.timestamp),I(N,S),w(N,S),n.value=new Map(n.value)}function $(N,S){e.value.has(N)||e.value.set(N,[]),e.value.get(N).push(S),e.value=new Map(e.value)}function k(N,S,C){const M=e.value.get(N);if(M){const V=M.find(K=>K.id===S);V&&(Object.assign(V,C),e.value=new Map(e.value))}}function b(N,S,C=null){const M=R(S.name,S.input);t.value.set(M,S.id);const V={id:S.id,name:S.name,input:S.input,signature:M,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:C||new Date().toISOString(),isExpanded:!0};return $(N,V),console.log(`Created tool call ${V.id} for ${V.name}`),V}function m(N,S){console.log("handlePermissionRequest received:",S);const C=S.metadata?.tool_name||S.tool_name,M=S.metadata?.input_params||S.input_params,V=S.metadata?.request_id||S.request_id,K=S.metadata?.suggestions||S.suggestions||[];console.log("Extracted data:",{toolName:C,inputParams:M,requestId:V,suggestions:K});const J=R(C,M),Q=t.value.get(J);Q?(o.value.set(V,Q),k(N,Q,{status:"permission_required",permissionRequestId:V,suggestions:K}),console.log(`Permission required for tool ${Q}`,{suggestions:K})):console.warn("No tool use ID found for permission request signature:",J,{toolName:C,inputParams:M,availableSignatures:Array.from(t.value.keys())})}function _(N,S){const C=o.value.get(S.request_id);if(C){const M={permissionDecision:S.decision,appliedUpdates:S.applied_updates||[]};S.decision==="allow"?M.status="executing":(M.status="completed",M.result={error:!0,message:S.reasoning||"Permission denied"},M.isExpanded=!1),S.updated_input&&(M.input=S.updated_input),k(N,C,M),console.log(`Permission ${S.decision} for tool ${C}`)}}function v(N,S){console.log("handleToolCall received:",S);const C=S.tool_use_id;if(!C){console.warn("Received tool_call without tool_use_id:",S);return}e.value.has(N)||e.value.set(N,[]);const M=e.value.get(N),V=M.findIndex(Q=>Q.id===C),J={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[S.status]||S.status;if(V!==-1){const Q=M[V];Q.status=J,Q.backendStatus=S.status,S.permission&&(Q.suggestions=S.permission.suggestions||[],Q.permissionRequestId=S.request_id),S.permission_granted!==null&&S.permission_granted!==void 0&&(Q.permissionDecision=S.permission_granted?"allow":"deny"),S.result!==void 0&&(Q.result={error:S.status==="failed",content:S.result}),S.error&&(Q.result={error:!0,content:S.error}),S.status==="denied"&&(Q.result={error:!0,message:"Permission denied"},Q.isExpanded=!1),S.status==="interrupted"&&(T(N,C,"Session was interrupted"),Q.isExpanded=!1),(S.status==="completed"||S.status==="failed")&&(Q.isExpanded=!1),S.display&&(Q.backendState=S.display),console.log(`Updated tool call ${C} to status: ${J} (backend: ${S.status})`)}else{const Q=R(S.name,S.input);t.value.set(Q,C);const se={id:C,name:S.name,input:S.input,signature:Q,status:J,backendStatus:S.status,permissionRequestId:S.request_id,permissionDecision:S.permission_granted!==void 0?S.permission_granted?"allow":"deny":null,suggestions:S.permission?.suggestions||[],result:S.result?{error:S.status==="failed",content:S.result}:null,explanation:null,timestamp:S.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(S.status),backendState:S.display};S.error&&(se.result={error:!0,content:S.error}),M.push(se),console.log(`Created new tool call ${C} for ${S.name} with status: ${J}`)}if(e.value=new Map(e.value),["completed","failed"].includes(S.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(S.name))try{$t().handleTaskToolResult(N,S.name,S.input,{error:S.status==="failed",content:S.result})}catch(Q){console.warn("Failed to update task store:",Q)}}function x(N,S){const C=S.tool_use_id;k(N,C,{status:S.is_error?"error":"completed",result:{error:S.is_error,content:S.content},isExpanded:!1}),console.log(`Tool ${C} ${S.is_error?"failed":"completed"}`);const M=e.value.get(N);if(M){const V=M.find(K=>K.id===C);if(V&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(V.name))try{$t().handleTaskToolResult(N,V.name,V.input,{error:S.is_error,content:S.content})}catch(K){console.warn("Failed to update task store:",K)}}}function E(N,S){const C=e.value.get(N);if(C){const M=C.find(V=>V.id===S);M&&(M.isExpanded=!M.isExpanded,e.value=new Map(e.value))}}function R(N,S){if(!N)return"unknown:{}";if(!S||typeof S!="object")return`${N}:{}`;const C=JSON.stringify(S,Object.keys(S).sort());return`${N}:${C}`}function I(N,S){const C=S.metadata?.display||S.display;if(!C)return;p.value.has(N)||p.value.set(N,new Map);const M=p.value.get(N);if(C.tool_states)for(const[V,K]of Object.entries(C.tool_states)){M.set(V,K);const J=e.value.get(N);if(J){const Q=J.find(se=>se.id===V);if(Q){const se={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Q.status=se[K.state]||K.state,Q.backendState=K}}}if(C.orphaned_tools&&C.orphaned_tools.length>0){const V=r.value.get(N)||new Map;for(const K of C.orphaned_tools)V.has(K)||V.set(K,{reason:"denied",message:"Session was interrupted"});r.value.set(N,V)}if(C.linked_permissions)for(const[V,K]of Object.entries(C.linked_permissions))o.value.set(V,K);C.tool_states&&Object.keys(C.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${N}:`,{toolStates:Object.keys(C.tool_states||{}).length,orphanedTools:(C.orphaned_tools||[]).length,linkedPermissions:Object.keys(C.linked_permissions||{}).length})}function D(N,S){return p.value.get(N)?.get(S)}function W(N){const S=p.value.get(N);return S&&S.size>0}function T(N,S,C){const M=r.value.get(N)||new Map;M.set(S,{reason:"denied",message:C}),r.value.set(N,M);const V=e.value.get(N);if(V){const K=V.find(J=>J.id===S);K&&K.isExpanded&&(K.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${S} as orphaned: ${C}`)}function A(N,S){const C=D(N,S);return C&&C.state==="orphaned"?!0:r.value.get(N)?.has(S)||!1}function U(N,S){const C=D(N,S);return C&&C.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:C}:r.value.get(N)?.get(S)}function G(N,S){const C=i.value.get(N);C&&C.size>0&&(C.forEach(M=>T(N,M,S)),C.clear())}function L(N){n.value.delete(N),e.value.delete(N),n.value=new Map(n.value),e.value=new Map(e.value)}function F(N){return c.value.get(N)}async function q(N){const S=c.value.get(N);if(!S)return console.log(`No sync needed for session ${N} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${N} since ${S}`);const C=await me.get(`/api/sessions/${N}/messages?limit=1000&offset=0`),M=C.messages||[],V=C.has_more||!1,K=H=>H?typeof H=="number"?H*1e3:new Date(H).getTime():0,J=K(S),Q=M.filter(H=>H.timestamp?K(H.timestamp)>J:!1);if(Q.length===0)return console.log(`No missed messages for session ${N}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Q.length} missed messages for session ${N}`);const se=n.value.get(N)||[],X=new Set(se.map(H=>H.id).filter(Boolean)),B=Q.filter(H=>!H.id||!X.has(H.id));if(console.log(`After deduplication: ${B.length} unique new messages`),B.length>0){const H=B.sort((Fe,z)=>{const le=K(Fe.timestamp),ue=K(z.timestamp);return le-ue}),ee=n.value.get(N)||[],oe=ee.length>0?K(ee[ee.length-1].timestamp):0,he=K(H[0].timestamp),at=K(H[H.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ee.length,lastExisting:oe,lastExistingDate:ee.length>0?ee[ee.length-1].timestamp:"none",firstNew:he,firstNewDate:H[0].timestamp,lastNew:at,lastNewDate:H[H.length-1].timestamp,shouldAppend:he>oe}),he>oe){const Fe=[...ee,...H];n.value.set(N,Fe),console.log(`âœ… Appended ${H.length} new messages (no full sort needed)`)}else{const Fe=[...ee,...H].sort((z,le)=>{const ue=K(z.timestamp),Ce=K(le.timestamp);return ue-Ce});n.value.set(N,Fe),console.log(`âš ï¸ Merged and sorted ${H.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${se.length} messages unchanged`);B.forEach(H=>{w(N,H),H.metadata?.has_tool_uses&&H.metadata.tool_uses&&H.metadata.tool_uses.forEach(ee=>{b(N,ee,H.timestamp)}),H.metadata?.has_tool_results&&H.metadata.tool_results&&H.metadata.tool_results.forEach(ee=>{x(N,ee)}),(H.type==="permission_request"||H.metadata?.has_permission_requests)&&m(N,H),H.type==="permission_response"&&_(N,{request_id:H.metadata?.request_id,decision:H.metadata?.decision,updated_input:H.metadata?.updated_input,reasoning:H.metadata?.reasoning,applied_updates:H.metadata?.applied_updates}),H.type==="system"&&(H.subtype==="init"||H.metadata?.subtype==="init")&&H.metadata?.init_data&&de().storeInitData(N,H.metadata.init_data)});const j=n.value.get(N);if(j&&j.length>0){const H=j[j.length-1];H.timestamp&&c.value.set(N,H.timestamp)}return n.value=new Map(n.value),{syncedCount:B.length,hasMore:V}}catch(C){return console.error(`Failed to sync messages for session ${N}:`,C),{syncedCount:0,hasMore:!1,error:C.message}}}const Z=de();return fe(()=>Array.from(Z.sessions.values()).map(S=>({id:S.session_id,state:S.state})),(N,S)=>{S&&N.forEach((C,M)=>{const V=S[M];if(!V||V.id!==C.id)return;const K=["active","paused","starting"].includes(V.state),J=!["active","paused","starting"].includes(C.state);K&&J&&G(C.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:bs(i),orphanedToolUses:bs(r),currentMessages:d,currentToolCalls:f,loadMessages:u,addMessage:g,addToolCall:$,updateToolCall:k,handleToolCall:v,handleToolUse:b,handlePermissionRequest:m,handlePermissionResponse:_,handleToolResult:x,toggleToolExpansion:E,clearMessages:L,markToolUseOrphaned:T,isToolUseOrphaned:A,getOrphanedInfo:U,clearOrphanedToolUses:G,getLastReceivedTimestamp:F,syncMessages:q,getBackendToolState:D,hasBackendDisplayMetadata:W,backendToolStates:bs(p)}}),ua=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:xe},Symbol.toStringTag,{value:"Module"}));function da(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Bt(n){return da(n).toLocaleTimeString()}const ma={class:"message-row message-row-user"},pa=["title"],fa={class:"message-content-column"},va=["innerHTML"],ha={key:0,class:"tool-results mt-2"},_a={class:"tool-results-header text-muted small mb-2"},ga={class:"d-flex align-items-start gap-2"},ba={class:"flex-grow-1"},ya={class:"text-muted"},wa={key:0,class:"text-danger small"},$a={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;ut.setOptions({breaks:!0,gfm:!0});const t=h(()=>Bt(e.message.timestamp)),o=h(()=>`user
${t.value}`),i=h(()=>{const d=e.message.content||"";let f=ut.parse(d);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),cs.sanitize(f)}),r=h(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=h(()=>e.message.metadata?.tool_results||[]);function p(d,f){return d?d.length<=f?d:d.substring(0,f)+"...":""}return(d,f)=>(a(),l("div",ma,[s("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,pa),s("div",fa,[s("div",{class:"message-text",innerHTML:i.value},null,8,va),r.value?(a(),l("div",ha,[s("div",_a," ðŸ”§ Tool Results ("+y(c.value.length)+") ",1),(a(!0),l(re,null,ce(c.value,(u,w)=>(a(),l("div",{key:w,class:te(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",ga,[s("span",null,y(u.is_error?"âŒ":"âœ…"),1),s("div",ba,[s("small",ya,"Tool: "+y(u.tool_use_id),1),u.is_error?(a(),l("div",wa,y(p(u.content,200)),1)):O("",!0)])])],2))),128))])):O("",!0)])]))}},ka=ne($a,[["__scopeId","data-v-7665755b"]]),Sa={class:"thinking-block"},Ea=["aria-label"],Ca={class:"text-muted ms-auto"},Ta={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},xa=["innerHTML"],Aa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=P(!1),o=h(()=>e.thinking?.length||0),i=h(()=>{const c=e.thinking||"",p=ut.parse(c);return cs.sanitize(p)});function r(){t.value=!t.value}return(c,p)=>(a(),l("div",Sa,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[s("span",{"aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,Ea),p[0]||(p[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",Ca,y(o.value)+" characters",1)]),t.value?(a(),l("div",Ta,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,xa)])):O("",!0)]))}},Ma=ne(Aa,[["__scopeId","data-v-fda2352c"]]),wn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),ks={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Qe=tt("resource",()=>{const n=P(new Map),e=P(!1),t=P(0),o=P(null),i=P(!1);function r(X){if(!X)return!1;if(X.is_image===!0||(X.mime_type||"").toLowerCase().startsWith("image/"))return!0;const j=(X.format||"").toLowerCase();if(j.startsWith("image/")||wn.has("."+j))return!0;const H=X.original_filename||X.original_name||"";if(H){const ee="."+H.split(".").pop().toLowerCase();return wn.has(ee)}return!1}function c(X){if(r(X))return"ðŸ–¼ï¸";if(X.original_filename){const B="."+X.original_filename.split(".").pop().toLowerCase();return ks[B]||ks.default}return ks.default}function p(X){return X.original_filename?"."+X.original_filename.split(".").pop().toLowerCase():""}function d(X){const B=n.value.get(X);return B||[]}function f(X){return n.value.get(X)?.length||0}function u(X){return f(X)>0}function w(X){return d(X).filter(r)}function g(X){return w(X).length}function $(X){return g(X)>0}const k=h(()=>{const X=de();return d(X.currentSessionId)}),b=h(()=>{const X=de();return f(X.currentSessionId)}),m=h(()=>b.value>0),_=h(()=>k.value.filter(r)),v=h(()=>_.value.length),x=h(()=>v.value>0),E=h(()=>!e.value||!o.value?null:d(o.value)[t.value]||null),R=E,I=h(()=>o.value?f(o.value):0),D=I;async function W(X){if(X){i.value=!0;try{const j=(await _o(`/api/sessions/${X}/resources`)).resources||[];j.sort((H,ee)=>(H.timestamp||0)-(ee.timestamp||0)),n.value.set(X,j),n.value=new Map(n.value),console.log(`Loaded ${j.length} resources for session ${X}`)}catch(B){console.error(`Failed to load resources for session ${X}:`,B),n.value.set(X,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const T=W;function A(X,B){if(!X||!B)return;let j=n.value.get(X);j||(j=[],n.value.set(X,j));const H=j.findIndex(ee=>ee.resource_id===B.resource_id);H>=0?j[H]=B:j.push(B),j.sort((ee,oe)=>(ee.timestamp||0)-(oe.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${B.resource_id} to session ${X}`)}const U=A;function G(X,B){return`/api/sessions/${X}/resources/${B}`}const L=G;function F(X,B){return`/api/sessions/${X}/resources/${B}/download`}function q(X,B=0){o.value=X,t.value=Math.max(0,Math.min(B,f(X)-1)),e.value=!0}function Z(){e.value=!1}function N(){if(!o.value)return;const X=f(o.value);X!==0&&(t.value=(t.value+1)%X)}const S=N;function C(){if(!o.value)return;const X=f(o.value);X!==0&&(t.value=(t.value-1+X)%X)}const M=C;function V(X){if(!o.value)return;const B=f(o.value);B!==0&&(t.value=Math.max(0,Math.min(X,B-1)))}const K=V;function J(X){n.value.delete(X),n.value=new Map(n.value),o.value===X&&Z(),console.log(`Cleared resources for session ${X}`)}const Q=J;function se(X,B){const j=n.value.get(X);return j&&j.find(H=>H.resource_id===B)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:t,fullViewSessionId:o,loading:i,currentResources:k,currentResourceCount:b,currentHasResources:m,currentFullViewResource:E,fullViewTotalResources:I,currentImages:_,currentImageCount:v,currentHasImages:x,currentFullViewImage:R,fullViewTotalImages:D,imagesBySession:n,resourcesForSession:d,resourceCount:f,hasResources:u,getResourceUrl:G,getDownloadUrl:F,isImageResource:r,getResourceIcon:c,getResourceExtension:p,getResourceById:se,imagesForSession:w,imageCount:g,hasImages:$,getImageUrl:L,loadResources:W,addResource:A,openFullView:q,closeFullView:Z,nextResource:N,prevResource:C,goToResource:V,clearResources:J,loadImages:T,addImage:U,nextImage:S,prevImage:M,goToImage:K,clearImages:Q}}),Oa=Qe,Da=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Oa,useResourceStore:Qe},Symbol.toStringTag,{value:"Module"})),st=tt("websocket",()=>{const n=P(null),e=P(!1),t=P(0),o=10,i=P(null),r=P(!1),c=P(0),p=5,d=P(null);let f=null;const u=P(0),w=P(null),g=P(new Map),$=P(null),k=P(!1),b=P(0),m=5,_=P(null),v=1e4,x=1e3,E=P(Date.now()),R=P(Date.now()),I=P(Date.now());let D=null,W=null,T=null;const A=h(()=>e.value&&(r.value||!d.value)?"connected":e.value?"partial":"disconnected");function U(B){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${B}`}function G(B){const j={ui:{timer:()=>D,setTimer:H=>{D=H},lastPing:E,connected:e,name:"UI"},session:{timer:()=>W,setTimer:H=>{W=H},lastPing:R,connected:r,name:"Session"},legion:{timer:()=>T,setTimer:H=>{T=H},lastPing:I,connected:k,name:"Legion"}}[B];j.timer()&&clearInterval(j.timer()),j.setTimer(setInterval(()=>{if(!j.connected.value)return;const H=Date.now()-j.lastPing.value;if(H>v){console.warn(`âš ï¸ ${j.name} WebSocket heartbeat timeout (${H}ms since last ping) - forcing close to trigger reconnection`),j.connected.value=!1;const oe={ui:n,session:i,legion:$}[B];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},x)),console.log(`âœ… Started heartbeat monitor for ${j.name} WebSocket`)}function L(B){const j={ui:{get:()=>D,set:H=>{D=H}},session:{get:()=>W,set:H=>{W=H}},legion:{get:()=>T,set:H=>{T=H}}}[B];j.get()&&(clearInterval(j.get()),j.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${B} WebSocket`))}function F(){if(n.value)return;const B=U("/ws/ui");console.log(`Connecting to UI WebSocket: ${B}`),n.value=new WebSocket(B),n.value.onopen=()=>{e.value=!0,t.value=0,E.value=Date.now(),G("ui"),console.log("UI WebSocket connected")},n.value.onmessage=j=>{const H=JSON.parse(j.data);K(H)},n.value.onclose=()=>{if(L("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const j=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${j}ms (attempt ${t.value})`),setTimeout(F,j)}},n.value.onerror=j=>{console.error("UI WebSocket error:",j)}}function q(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Z(B){u.value++;const j=u.value;if(console.log(`[Gen ${j}] Starting connection to session ${B}`),f&&(clearTimeout(f),f=null),await N(),u.value!==j){console.log(`[Gen ${j}] Connection cancelled (current generation: ${u.value})`);return}d.value=B,w.value=j;const H=U(`/ws/session/${B}`);console.log(`[Gen ${j}] Connecting to Session WebSocket: ${H}`),i.value=new WebSocket(H),i.value.onopen=async()=>{if(w.value!==j){console.log(`[Gen ${j}] Ignoring onopen (stale connection, current: ${w.value})`),i.value.close();return}r.value=!0,c.value=0,R.value=Date.now(),G("session"),console.log(`[Gen ${j}] Session WebSocket connected for ${B}`);const ee=g.value.get(B);if(g.value.set(B,!0),ee){console.log(`[Gen ${j}] Reconnection detected, syncing missed messages...`);try{const he=await xe().syncMessages(B);he.syncedCount>0?console.log(`[Gen ${j}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${j}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${j}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${j}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${j}] Error during message sync:`,oe)}}else console.log(`[Gen ${j}] Initial connection, no sync needed`)},i.value.onmessage=ee=>{if(w.value!==j){console.log(`[Gen ${j}] Ignoring message (stale connection, current: ${w.value})`);return}const oe=JSON.parse(ee.data);J(oe,B)},i.value.onclose=()=>{L("session"),r.value=!1,i.value=null,console.log(`[Gen ${j}] Session WebSocket closed for ${B}`);const ee=de();if(ee.currentSessionId===B&&w.value===j&&c.value<p){c.value++;const oe=Math.min(2e3*c.value,3e4);console.log(`[Gen ${j}] Reconnecting Session WebSocket in ${oe}ms (attempt ${c.value})`),f=setTimeout(()=>{w.value===j&&ee.currentSessionId===B?(f=null,Z(B)):console.log(`[Gen ${j}] Skipping reconnect (generation or session changed)`)},oe)}},i.value.onerror=ee=>{console.error(`[Gen ${j}] Session WebSocket error:`,ee)}}function N(){return new Promise(B=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const j=d.value,H=()=>{i.value=null,r.value=!1,d.value=null,w.value=null,c.value=0,j&&g.value.delete(j),B()};if(i.value.readyState===WebSocket.CLOSED)H();else{const ee=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),H()},2e3);i.value.addEventListener("close",()=>{clearTimeout(ee),H()},{once:!0}),i.value.close()}}else d.value=null,w.value=null,B()})}function S(B){i.value&&r.value?(i.value.send(JSON.stringify({type:"send_message",content:B})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function C(B,j,H=!1,ee=null){if(i.value&&r.value){const oe={type:"permission_response",request_id:B,decision:j,apply_suggestions:H,timestamp:new Date().toISOString()};ee&&(oe.clarification_message=ee),i.value.send(JSON.stringify(oe)),console.log(`Sent permission ${j} for request ${B}`,{applySuggestions:H,clarification:ee})}}function M(B,j,H){if(i.value&&r.value){const ee={type:"permission_response",request_id:B,decision:j,updated_input:H,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(ee)),console.log(`Sent permission ${j} with updated_input for request ${B}`,H)}}function V(){i.value&&r.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function K(B){const j=de(),H=Ie();switch(B.type){case"sessions_list":B.sessions&&Array.isArray(B.sessions)&&B.sessions.forEach(ee=>{j.updateSession(ee.session_id,ee)});break;case"state_change":B.data&&B.data.session_id&&B.data.session&&j.updateSession(B.data.session_id,B.data.session);break;case"project_updated":if(B.data&&B.data.project){const ee=B.data.project;H.updateProjectLocal(ee.project_id,ee),j.fetchSessions()}break;case"project_deleted":B.data&&B.data.project_id&&H.projects.delete(B.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":E.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",B.type)}}function J(B,j){const H=de();if(H.currentSessionId!==j){console.warn(`Ignoring message for session ${j} (current: ${H.currentSessionId})`);return}const ee=xe();switch(B.type){case"message":const oe=B.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",B);break}if(oe.type==="tool_call"){ee.handleToolCall(j,oe);break}if(oe.type==="permission_request"){ee.handlePermissionRequest(j,oe);break}if(oe.type==="permission_response"){ee.handlePermissionResponse(j,oe);break}oe.metadata?.has_tool_uses&&oe.metadata.tool_uses.forEach(he=>{ee.handleToolUse(j,he,oe.timestamp)}),oe.metadata?.has_tool_results&&oe.metadata.tool_results.forEach(he=>{ee.handleToolResult(j,he)}),oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&H.storeInitData(j,oe.metadata.init_data),ee.addMessage(j,oe);break;case"permission_request":ee.handlePermissionRequest(j,B);break;case"permission_response":ee.handlePermissionResponse(j,B);break;case"tool_result":ee.handleToolResult(j,B);break;case"state_change":H.updateSession(j,B.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${j}`);break;case"ping":R.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":B.resource&&(Qe().addResource(j,B.resource),console.log(`Resource registered for session ${j}:`,B.resource.resource_id));break;case"image_registered":B.image&&(Qe().addResource(j,{...B.image,resource_id:B.image.image_id}),console.log(`Image registered (legacy) for session ${j}:`,B.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",B.type)}}function Q(B){se(),_.value=B;const j=U(`/ws/legion/${B}`);console.log(`Connecting to Legion WebSocket: ${j}`),$.value=new WebSocket(j),$.value.onopen=()=>{k.value=!0,b.value=0,I.value=Date.now(),G("legion"),console.log(`Legion WebSocket connected for ${B}`)},$.value.onmessage=H=>{const ee=JSON.parse(H.data);X(ee,B)},$.value.onclose=()=>{if(L("legion"),k.value=!1,$.value=null,console.log(`Legion WebSocket closed for ${B}`),_.value===B&&b.value<m){b.value++;const H=Math.min(2e3*b.value,3e4);setTimeout(()=>Q(B),H)}},$.value.onerror=H=>{console.error("Legion WebSocket error:",H)}}function se(){$.value&&($.value.close(),$.value=null,k.value=!1,_.value=null)}function X(B,j){Te(async()=>{const{useLegionStore:H}=await Promise.resolve().then(()=>Bb);return{useLegionStore:H}},void 0).then(({useLegionStore:H})=>{const ee=H();switch(B.type){case"comm":B.comm&&(ee.addComm(j,B.comm),console.log("Legion WebSocket: Received new comm",B.comm));break;case"minion_created":B.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",B.data),Te(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>yn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":B.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",B.data),Te(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>yn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${j}`);break;case"ping":I.value=Date.now(),$.value?.readyState===WebSocket.OPEN&&$.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",B.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:r,sessionRetryCount:c,legionConnected:k,legionRetryCount:b,overallStatus:A,connectUI:F,disconnectUI:q,connectSession:Z,disconnectSession:N,sendMessage:S,sendPermissionResponse:C,sendPermissionResponseWithInput:M,interruptSession:V,connectLegion:Q,disconnectLegion:se}}),Na=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:st},Symbol.toStringTag,{value:"Module"})),La={class:"base-tool-handler"},Ia={class:"tool-section"},ja={class:"tool-parameters"},Pa={class:"tool-code"},Ra={key:0,class:"tool-section"},Wa={class:"tool-section-label"},Fa={class:"tool-code"},Ba={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=h(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,p)=>(a(),l("div",La,[s("div",Ia,[p[0]||(p[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",ja,[s("pre",Pa,y(t.value),1)])]),o.value?(a(),l("div",Ra,[s("div",Wa,y(i.value?"Error:":"Result:"),1),s("div",{class:te(["tool-result",{"tool-result-error":i.value}])},[s("pre",Fa,y(r.value),1)],2)])):O("",!0)]))}},Ha=ne(Ba,[["__scopeId","data-v-1e69f57d"]]),Va={class:"read-tool-handler"},Ua={class:"tool-section"},qa={class:"read-file-info"},za={class:"file-icon"},Ka={class:"file-path"},Ga={key:0,class:"read-range"},Ya={key:0,class:"tool-section"},Ja={key:0,class:"tool-result tool-result-error"},Qa={class:"tool-code"},Xa={key:1,class:"image-preview"},Za={class:"content-header"},er={class:"image-badge"},tr={class:"image-container"},sr=["src","alt"],nr={key:2,class:"file-content-preview"},or={class:"content-header"},ir={class:"line-count-badge"},ar={key:0,class:"preview-note"},rr={class:"tool-code content-display"},lr={key:0,class:"more-indicator"},Ss=100,cr={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>{const _=t.value;return _.split("/").pop()||_}),i=h(()=>{const _=e.toolCall.input?.offset,v=e.toolCall.input?.limit;return _!==void 0||v!==void 0}),r=h(()=>{const _=e.toolCall.input?.offset;return _!==void 0?_+1:1}),c=h(()=>{const _=e.toolCall.input?.offset||0,v=e.toolCall.input?.limit;return v!==void 0?_+v:"âˆž"}),p=h(()=>{const _=t.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(_)}),d=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>{if(!d.value||f.value)return null;const v=e.toolCall.result?.content;if(Array.isArray(v)){for(const x of v)if(x?.type==="image"&&x?.source?.type==="base64"&&x?.source?.data)return x.source.data}return null}),w=h(()=>{if(!u.value)return"";const _=t.value.toLowerCase();return _.endsWith(".png")?"image/png":_.endsWith(".jpg")||_.endsWith(".jpeg")?"image/jpeg":_.endsWith(".gif")?"image/gif":_.endsWith(".webp")?"image/webp":_.endsWith(".svg")?"image/svg+xml":_.endsWith(".bmp")?"image/bmp":_.endsWith(".ico")?"image/x-icon":"image/png"}),g=h(()=>{if(!d.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),$=h(()=>f.value||!g.value||u.value?[]:g.value.split(`
`)),k=h(()=>$.value.length),b=h(()=>k.value>Ss),m=h(()=>f.value||u.value?"":$.value.slice(0,Ss).join(`
`));return(_,v)=>(a(),l("div",Va,[s("div",Ua,[s("div",qa,[s("span",za,y(p.value?"ðŸ–¼ï¸":"ðŸ“„"),1),v[0]||(v[0]=s("strong",null,"Reading:",-1)),s("code",Ka,y(t.value),1),i.value?(a(),l("span",Ga,"Lines "+y(r.value)+"-"+y(c.value),1)):O("",!0)])]),d.value?(a(),l("div",Ya,[f.value?(a(),l("div",Ja,[s("pre",Qa,y(g.value),1)])):u.value?(a(),l("div",Xa,[s("div",Za,[v[1]||(v[1]=s("span",{class:"content-label"},"Image Preview:",-1)),s("span",er,y(w.value),1)]),s("div",tr,[s("img",{src:`data:${w.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,sr)])])):(a(),l("div",nr,[s("div",or,[v[2]||(v[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",ir,y(k.value)+" lines",1),b.value?(a(),l("span",ar,"(showing first "+y(Ss)+")")):O("",!0)]),s("pre",rr,y(m.value),1),b.value?(a(),l("div",lr,"...")):O("",!0)]))])):O("",!0)]))}},ur=ne(cr,[["__scopeId","data-v-29b774b1"]]),dr={class:"write-tool-handler"},mr={class:"tool-section"},pr={class:"write-file-info mb-2"},fr={class:"file-path"},vr={class:"write-content-preview"},hr={class:"content-header"},_r={class:"line-count-badge"},gr={key:0,class:"preview-note"},br={class:"tool-code content-display"},yr={key:0,class:"more-indicator"},wr={key:0,class:"tool-section"},$r={key:0,class:"tool-result tool-result-error"},kr={class:"tool-code"},Sr={key:1,class:"tool-result tool-result-success"},Er={class:"success-message"},Es=100,Cr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.content||""),i=h(()=>o.value.split(`
`)),r=h(()=>i.value.length),c=h(()=>r.value>Es),p=h(()=>i.value.slice(0,Es).join(`
`)),d=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>{if(!d.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,g)=>(a(),l("div",dr,[s("div",mr,[s("div",pr,[g[0]||(g[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=s("strong",null,"Writing:",-1)),s("code",fr,y(t.value),1)]),s("div",vr,[s("div",hr,[g[2]||(g[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",_r,y(r.value)+" lines",1),c.value?(a(),l("span",gr,"(showing first "+y(Es)+")")):O("",!0)]),s("pre",br,y(p.value),1),c.value?(a(),l("div",yr,"...")):O("",!0)])]),d.value?(a(),l("div",wr,[f.value?(a(),l("div",$r,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",kr,y(u.value),1)])):(a(),l("div",Sr,[s("div",Er,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+y(r.value)+" lines written)",1)])]))])):O("",!0)]))}},Tr=ne(Cr,[["__scopeId","data-v-ddc24a0f"]]),xr={class:"bash-tool-handler"},Ar={class:"tool-section"},Mr={class:"bash-header"},Or={class:"bash-header-content"},Dr={key:0,class:"bash-description"},Nr={key:1,class:"bash-flags"},Lr={class:"bash-command-section"},Ir={class:"bash-command-content"},jr={key:0,class:"tool-section"},Pr={key:0,class:"bash-output"},Rr={key:1,class:"bash-output-empty"},Wr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.command||""),o=h(()=>e.toolCall.input?.description||""),i=h(()=>e.toolCall.input?.timeout),r=h(()=>e.toolCall.input?.run_in_background||!1),c=h(()=>i.value||r.value),p=h(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),r.value&&g.push("background"),g.join(", ")}),d=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>f.value?"tool-result-error":"tool-result-success"),w=h(()=>{if(!d.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,$)=>(a(),l("div",xr,[s("div",Ar,[s("div",Mr,[$[1]||($[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",Or,[o.value?(a(),l("div",Dr,[$[0]||($[0]=s("strong",null,"Description:",-1)),ie(" "+y(o.value),1)])):O("",!0),c.value?(a(),l("div",Nr,y(p.value),1)):O("",!0)])]),s("div",Lr,[$[2]||($[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",Ir,y(t.value),1)])]),d.value?(a(),l("div",jr,[s("div",{class:te(["tool-result",u.value])},[$[3]||($[3]=s("strong",null,"Output:",-1)),w.value?(a(),l("pre",Pr,y(w.value),1)):(a(),l("div",Rr,"No output"))],2)])):O("",!0)]))}},Fr=ne(Wr,[["__scopeId","data-v-ab50fe73"]]),Br={class:"todo-tool-handler"},Hr={class:"tool-section"},Vr={class:"todo-header"},Ur={class:"todo-summary"},qr={key:0,class:"todo-count todo-count-completed"},zr={key:1,class:"todo-count todo-count-in-progress"},Kr={key:2,class:"todo-count todo-count-pending"},Gr={class:"todo-checklist"},Yr={class:"todo-checkbox"},Jr={class:"todo-content"},Qr={key:0,class:"tool-section"},Xr={key:0,class:"tool-result tool-result-error"},Zr={class:"tool-code"},el={key:1,class:"tool-result tool-result-success"},tl={class:"success-message"},sl={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.todos||[]),o=h(()=>t.value.filter(u=>u.status==="completed").length),i=h(()=>t.value.filter(u=>u.status==="in_progress").length),r=h(()=>t.value.filter(u=>u.status==="pending").length);function c(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const p=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=h(()=>{if(!p.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,w)=>(a(),l("div",Br,[s("div",Hr,[s("div",Vr,[w[0]||(w[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=s("strong",null,"Task List:",-1)),s("div",Ur,[o.value>0?(a(),l("span",qr,y(o.value)+" completed ",1)):O("",!0),i.value>0?(a(),l("span",zr,y(i.value)+" in progress ",1)):O("",!0),r.value>0?(a(),l("span",Kr,y(r.value)+" pending ",1)):O("",!0)])]),s("div",Gr,[(a(!0),l(re,null,ce(t.value,(g,$)=>(a(),l("div",{key:$,class:te(["todo-item",`todo-${g.status}`])},[s("span",Yr,y(c(g.status)),1),s("span",Jr,y(g.content),1)],2))),128))])]),p.value?(a(),l("div",Qr,[d.value?(a(),l("div",Xr,[w[2]||(w[2]=s("strong",null,"Error:",-1)),s("pre",Zr,y(f.value),1)])):(a(),l("div",el,[s("div",tl,[w[3]||(w[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+y(t.value.length)+" tasks)",1)])]))])):O("",!0)]))}},nl=ne(sl,[["__scopeId","data-v-bbe55ee7"]]),ol={class:"edit-tool-handler"},il={class:"tool-section"},al={class:"edit-file-info"},rl={class:"file-path"},ll={key:0,class:"replace-all-badge"},cl={class:"edit-diff-container"},ul={class:"diff-header"},dl={class:"diff-stats"},ml={class:"stat-removed"},pl={class:"stat-added"},fl={class:"unified-diff"},vl={class:"diff-scroll-container"},hl={class:"diff-marker"},_l={class:"diff-content"},gl={key:0,class:"tool-section"},bl={key:0,class:"tool-result tool-result-error"},yl={class:"tool-code"},wl={key:1,class:"tool-result tool-result-success"},$l={class:"success-message"},kl={key:0,class:"success-detail"},Sl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.old_string||""),i=h(()=>e.toolCall.input?.new_string||""),r=h(()=>e.toolCall.input?.replace_all||!1),c=h(()=>{const $=Ni(t.value,o.value,i.value,"","",{context:3}).split(`
`),k=[];for(let b=4;b<$.length;b++){const m=$[b];m&&(m.startsWith("-")?k.push({type:"removed",content:m.substring(1)}):m.startsWith("+")?k.push({type:"added",content:m.substring(1)}):m.startsWith(" ")?k.push({type:"context",content:m.substring(1)}):m.startsWith("@@")&&k.push({type:"hunk",content:m}))}return k}),p=h(()=>c.value.filter(g=>g.type==="removed").length),d=h(()=>c.value.filter(g=>g.type==="added").length),f=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,$)=>(a(),l("div",ol,[s("div",il,[s("div",al,[$[0]||($[0]=s("span",{class:"file-icon"},"âœï¸",-1)),$[1]||($[1]=s("strong",null,"Editing:",-1)),s("code",rl,y(t.value),1),r.value?(a(),l("span",ll,"Replace All")):O("",!0)]),s("div",cl,[s("div",ul,[$[2]||($[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",dl,[s("span",ml,"-"+y(p.value),1),s("span",pl,"+"+y(d.value),1)])]),s("div",fl,[s("div",vl,[(a(!0),l(re,null,ce(c.value,(k,b)=>(a(),l("div",{key:b,class:te(["diff-line",{"diff-line-removed":k.type==="removed","diff-line-added":k.type==="added","diff-line-context":k.type==="context","diff-line-hunk":k.type==="hunk"}])},[s("span",hl,y(k.type==="removed"?"-":k.type==="added"?"+":k.type==="hunk"?"@":" "),1),s("span",_l,y(k.content),1)],2))),128))])])])]),f.value?(a(),l("div",gl,[u.value?(a(),l("div",bl,[$[3]||($[3]=s("strong",null,"Error:",-1)),s("pre",yl,y(w.value),1)])):(a(),l("div",wl,[s("div",$l,[$[4]||($[4]=s("span",{class:"success-icon"},"âœ…",-1)),$[5]||($[5]=s("strong",null,"File edited successfully",-1)),r.value?(a(),l("span",kl,"(all occurrences replaced)")):O("",!0)])]))])):O("",!0)]))}},El=ne(Sl,[["__scopeId","data-v-dd74055e"]]),Cl={class:"search-tool-handler"},Tl={class:"tool-section"},xl={class:"search-info"},Al={class:"search-icon"},Ml={class:"search-pattern"},Ol={key:0,class:"search-path"},Dl={key:1,class:"search-filters"},Nl={key:0,class:"filter-badge"},Ll={key:1,class:"filter-badge"},Il={key:2,class:"filter-badge"},jl={key:0,class:"tool-section"},Pl={key:0,class:"tool-result tool-result-error"},Rl={class:"tool-code"},Wl={key:1,class:"search-results"},Fl={class:"results-header"},Bl={class:"results-label"},Hl={class:"results-count-badge"},Vl={class:"results-content"},Ul={class:"tool-code"},ql={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="Grep"),o=h(()=>e.toolCall.input?.pattern||"Unknown"),i=h(()=>e.toolCall.input?.path||null),r=h(()=>e.toolCall.input?.type||null),c=h(()=>e.toolCall.input?.glob||null),p=h(()=>e.toolCall.input?.["-i"]||!1),d=h(()=>r.value||c.value||p.value),f=h(()=>t.value?"ðŸ”":"ðŸ“"),u=h(()=>t.value?"Searching content":"Finding files"),w=h(()=>t.value?"Matches":"Files found"),g=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=h(()=>{if(!g.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),b=h(()=>!g.value||$.value||!k.value?0:k.value.split(`
`).filter(_=>_.trim()).length);return(m,_)=>(a(),l("div",Cl,[s("div",Tl,[s("div",xl,[s("span",Al,y(f.value),1),s("strong",null,y(u.value)+":",1),s("code",Ml,y(o.value),1),i.value?(a(),l("span",Ol,"in "+y(i.value),1)):O("",!0),d.value?(a(),l("span",Dl,[r.value?(a(),l("span",Nl,"type: "+y(r.value),1)):O("",!0),c.value?(a(),l("span",Ll,"glob: "+y(c.value),1)):O("",!0),p.value?(a(),l("span",Il,"case-insensitive")):O("",!0)])):O("",!0)])]),g.value?(a(),l("div",jl,[$.value?(a(),l("div",Pl,[_[0]||(_[0]=s("strong",null,"Error:",-1)),s("pre",Rl,y(k.value),1)])):(a(),l("div",Wl,[s("div",Fl,[s("span",Bl,y(w.value)+":",1),s("span",Hl,y(b.value)+" "+y(b.value===1?"match":"matches"),1)]),s("div",Vl,[s("pre",Ul,y(k.value),1)])]))])):O("",!0)]))}},$n=ne(ql,[["__scopeId","data-v-0d272c39"]]),zl={class:"web-tool-handler"},Kl={class:"tool-section"},Gl={class:"web-info"},Yl={class:"web-icon"},Jl=["href"],Ql={key:1,class:"web-query"},Xl={key:0,class:"web-prompt-container"},Zl={class:"prompt-content"},ec={key:1,class:"web-domains"},tc={class:"domains-label"},sc={key:0,class:"tool-section"},nc={key:0,class:"tool-result tool-result-error"},oc={class:"tool-code"},ic={key:1,class:"web-results"},ac={class:"results-header"},rc={class:"results-label"},lc={class:"results-content"},cc={class:"tool-code"},uc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="WebFetch"),o=h(()=>e.toolCall.input?.url||null),i=h(()=>e.toolCall.input?.query||null),r=h(()=>e.toolCall.input?.prompt||null),c=h(()=>e.toolCall.input?.allowed_domains||[]),p=h(()=>e.toolCall.input?.blocked_domains||[]),d=h(()=>c.value.length>0?c.value:p.value.length>0?p.value:[]),f=h(()=>c.value.length>0?"Allowed domains":p.value.length>0?"Blocked domains":"Domains"),u=h(()=>t.value?"ðŸŒ":"ðŸ”Ž"),w=h(()=>t.value?"Fetching URL":"Searching web"),g=h(()=>t.value?"Fetched content":"Search results"),$=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=h(()=>{if(!$.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,_)=>(a(),l("div",zl,[s("div",Kl,[s("div",Gl,[s("span",Yl,y(u.value),1),s("strong",null,y(w.value)+":",1),o.value?(a(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,Jl)):i.value?(a(),l("code",Ql,y(i.value),1)):O("",!0)]),r.value?(a(),l("div",Xl,[_[0]||(_[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Zl,y(r.value),1)])):O("",!0),d.value.length>0?(a(),l("div",ec,[s("span",tc,y(f.value)+":",1),(a(!0),l(re,null,ce(d.value,v=>(a(),l("span",{key:v,class:"domain-badge"},y(v),1))),128))])):O("",!0)]),$.value?(a(),l("div",sc,[k.value?(a(),l("div",nc,[_[1]||(_[1]=s("strong",null,"Error:",-1)),s("pre",oc,y(b.value),1)])):(a(),l("div",ic,[s("div",ac,[s("span",rc,y(g.value)+":",1)]),s("div",lc,[s("pre",cc,y(b.value),1)])]))])):O("",!0)]))}},kn=ne(uc,[["__scopeId","data-v-62b55b55"]]),dc={class:"task-tool-handler"},mc={class:"tool-section"},pc={class:"task-header"},fc={key:0,class:"agent-type-badge"},vc={key:0,class:"task-description"},hc={class:"description-content"},_c={key:1,class:"task-prompt-container"},gc={class:"prompt-header"},bc={class:"prompt-length"},yc={class:"prompt-code"},wc={key:0,class:"tool-section"},$c={key:0,class:"tool-result tool-result-error"},kc={class:"tool-code"},Sc={key:1,class:"agent-output"},Ec={class:"output-header"},Cc={key:0,class:"output-count-badge"},Tc={class:"output-content"},xc={class:"tool-code"},Ac={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.description||null),o=h(()=>e.toolCall.input?.prompt||null),i=h(()=>e.toolCall.input?.subagent_type||null),r=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=h(()=>{if(!r.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),d=h(()=>p.value?p.value.split(`
`).length:0);return(f,u)=>(a(),l("div",dc,[s("div",mc,[s("div",pc,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=s("strong",null,"Agent Task:",-1)),i.value?(a(),l("span",fc,y(i.value),1)):O("",!0)]),t.value?(a(),l("div",vc,[u[2]||(u[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",hc,y(t.value),1)])):O("",!0),o.value?(a(),l("div",_c,[s("div",gc,[u[3]||(u[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",bc,y(o.value.length)+" characters",1)]),s("pre",yc,y(o.value),1)])):O("",!0)]),r.value?(a(),l("div",wc,[c.value?(a(),l("div",$c,[u[4]||(u[4]=s("strong",null,"Error:",-1)),s("pre",kc,y(p.value),1)])):(a(),l("div",Sc,[s("div",Ec,[u[5]||(u[5]=s("span",{class:"output-label"},"Agent Output:",-1)),d.value>0?(a(),l("span",Cc,y(d.value)+" lines",1)):O("",!0)]),s("div",Tc,[s("pre",xc,y(p.value),1)])]))])):O("",!0)]))}},Mc=ne(Ac,[["__scopeId","data-v-c520c244"]]),Oc={class:"task-create-tool-handler"},Dc={class:"tool-section"},Nc={class:"task-details p-2"},Lc={key:0,class:"task-field mb-2"},Ic={class:"field-value subject-value"},jc={key:1,class:"task-field mb-2"},Pc={class:"field-value description-value"},Rc={key:2,class:"task-field"},Wc={class:"field-value active-form-value"},Fc={key:0,class:"tool-section mt-2"},Bc={key:0,class:"tool-result tool-result-error"},Hc={class:"tool-code"},Vc={key:1,class:"tool-result tool-result-success"},Uc={class:"result-text"},qc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.subject||null),o=h(()=>e.toolCall.input?.description||null),i=h(()=>e.toolCall.input?.activeForm||null),r=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=h(()=>{if(!r.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,f)=>(a(),l("div",Oc,[s("div",Dc,[f[3]||(f[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",Nc,[t.value?(a(),l("div",Lc,[f[0]||(f[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Ic,y(t.value),1)])):O("",!0),o.value?(a(),l("div",jc,[f[1]||(f[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",Pc,y(o.value),1)])):O("",!0),i.value?(a(),l("div",Rc,[f[2]||(f[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Wc,y(i.value),1)])):O("",!0)])]),r.value?(a(),l("div",Fc,[c.value?(a(),l("div",Bc,[f[4]||(f[4]=s("strong",null,"Error:",-1)),s("pre",Hc,y(p.value),1)])):(a(),l("div",Vc,[f[5]||(f[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Uc,y(p.value),1)]))])):O("",!0)]))}},zc=ne(qc,[["__scopeId","data-v-474dd444"]]),Kc={class:"task-update-tool-handler"},Gc={class:"tool-section"},Yc={class:"task-header"},Jc={key:0,class:"task-id-badge"},Qc={class:"task-details p-2"},Xc={key:0,class:"task-field mb-2"},Zc={key:1,class:"task-field mb-2"},eu={class:"field-value"},tu={key:2,class:"task-field mb-2"},su={class:"field-value description-value"},nu={key:3,class:"task-field mb-2"},ou={class:"field-value active-form-value"},iu={key:4,class:"task-field mb-2"},au={class:"field-value"},ru={key:5,class:"task-field mb-2"},lu={class:"field-value"},cu={key:6,class:"task-field"},uu={class:"field-value"},du={key:0,class:"tool-section mt-2"},mu={key:0,class:"tool-result tool-result-error"},pu={class:"tool-code"},fu={key:1,class:"tool-result tool-result-success"},vu={class:"result-text"},hu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.taskId||null),o=h(()=>e.toolCall.input?.status||null),i=h(()=>e.toolCall.input?.subject||null),r=h(()=>e.toolCall.input?.description||null),c=h(()=>e.toolCall.input?.activeForm||null),p=h(()=>e.toolCall.input?.owner||null),d=h(()=>e.toolCall.input?.addBlockedBy||[]),f=h(()=>e.toolCall.input?.addBlocks||[]),u=h(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=h(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=h(()=>{if(!g.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,m)=>(a(),l("div",Kc,[s("div",Gc,[s("div",Yc,[m[0]||(m[0]=s("span",{class:"task-icon"},"âœï¸",-1)),m[1]||(m[1]=s("strong",null,"Update Task",-1)),t.value?(a(),l("span",Jc,"#"+y(t.value),1)):O("",!0)]),s("div",Qc,[o.value?(a(),l("div",Xc,[m[2]||(m[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:te(["field-value status-value",w.value])},y(u.value)+" "+y(o.value),3)])):O("",!0),i.value?(a(),l("div",Zc,[m[3]||(m[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",eu,y(i.value),1)])):O("",!0),r.value?(a(),l("div",tu,[m[4]||(m[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",su,y(r.value),1)])):O("",!0),c.value?(a(),l("div",nu,[m[5]||(m[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",ou,y(c.value),1)])):O("",!0),p.value?(a(),l("div",iu,[m[6]||(m[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",au,y(p.value),1)])):O("",!0),d.value?.length?(a(),l("div",ru,[m[7]||(m[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",lu,[(a(!0),l(re,null,ce(d.value,_=>(a(),l("span",{key:_,class:"badge bg-warning text-dark me-1"},"#"+y(_),1))),128))])])):O("",!0),f.value?.length?(a(),l("div",cu,[m[8]||(m[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",uu,[(a(!0),l(re,null,ce(f.value,_=>(a(),l("span",{key:_,class:"badge bg-info text-dark me-1"},"#"+y(_),1))),128))])])):O("",!0)])]),g.value?(a(),l("div",du,[$.value?(a(),l("div",mu,[m[9]||(m[9]=s("strong",null,"Error:",-1)),s("pre",pu,y(k.value),1)])):(a(),l("div",fu,[m[10]||(m[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",vu,y(k.value),1)]))])):O("",!0)]))}},_u=ne(hu,[["__scopeId","data-v-35582330"]]),gu={class:"task-list-tool-handler"},bu={key:0,class:"tool-section"},yu={key:0,class:"tool-result tool-result-error"},wu={class:"tool-code"},$u={key:1,class:"task-list-result"},ku={key:0,class:"parsed-tasks"},Su={class:"status-icon"},Eu={class:"task-id text-muted"},Cu={class:"task-subject flex-grow-1"},Tu={key:0,class:"task-owner badge bg-secondary"},xu={key:1,class:"raw-result p-2"},Au={class:"tool-code"},Mu={key:1,class:"tool-section"},Ou={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=h(()=>{if(!t.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),r=h(()=>{if(!i.value)return[];const p=[],f=i.value.split(`
`);for(const u of f){const w=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const g=w[2].toLowerCase();p.push({id:w[1],status:g,subject:w[3].trim(),owner:null,statusIcon:c(g)})}}return p});function c(p){switch(p){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(p,d)=>(a(),l("div",gu,[d[2]||(d[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(a(),l("div",bu,[o.value?(a(),l("div",yu,[d[0]||(d[0]=s("strong",null,"Error:",-1)),s("pre",wu,y(i.value),1)])):(a(),l("div",$u,[r.value.length>0?(a(),l("div",ku,[(a(!0),l(re,null,ce(r.value,(f,u)=>(a(),l("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",Su,y(f.statusIcon),1),s("span",Eu,"#"+y(f.id),1),s("span",Cu,y(f.subject),1),f.owner?(a(),l("span",Tu,y(f.owner),1)):O("",!0)]))),128))])):(a(),l("div",xu,[s("pre",Au,y(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),l("div",Mu,[...d[1]||(d[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):O("",!0)]))}},Du=ne(Ou,[["__scopeId","data-v-4e79ba4b"]]),Nu={class:"task-get-tool-handler"},Lu={class:"tool-section"},Iu={class:"task-header"},ju={key:0,class:"task-id-badge"},Pu={key:0,class:"tool-section"},Ru={key:0,class:"tool-result tool-result-error"},Wu={class:"tool-code"},Fu={key:1,class:"task-details-result p-2"},Bu={key:0,class:"parsed-task"},Hu={class:"task-field mb-2"},Vu={class:"field-value subject-value"},Uu={key:0,class:"task-field mb-2"},qu={key:1,class:"task-field mb-2"},zu={class:"field-value description-value"},Ku={key:2,class:"task-field mb-2"},Gu={class:"field-value"},Yu={key:3,class:"task-field mb-2"},Ju={class:"field-value"},Qu={key:4,class:"task-field"},Xu={class:"field-value"},Zu={key:1,class:"raw-result"},ed={class:"tool-code"},td={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.taskId||null),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=h(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=h(()=>{if(!r.value)return null;const f=r.value;try{const g=JSON.parse(f);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const u=f.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of u){const $=g.match(/^Subject:\s*(.+)$/i);$&&(w.subject=$[1].trim());const k=g.match(/^Status:\s*(.+)$/i);k&&(w.status=k[1].trim());const b=g.match(/^Description:\s*(.+)$/i);b&&(w.description=b[1].trim());const m=g.match(/^Owner:\s*(.+)$/i);m&&(w.owner=m[1].trim())}return w.subject?w:null}),p=h(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),d=h(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,u)=>(a(),l("div",Nu,[s("div",Lu,[s("div",Iu,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=s("strong",null,"Get Task",-1)),t.value?(a(),l("span",ju,"#"+y(t.value),1)):O("",!0)])]),o.value?(a(),l("div",Pu,[i.value?(a(),l("div",Ru,[u[2]||(u[2]=s("strong",null,"Error:",-1)),s("pre",Wu,y(r.value),1)])):(a(),l("div",Fu,[c.value?(a(),l("div",Bu,[s("div",Hu,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Vu,y(c.value.subject),1)]),c.value.status?(a(),l("div",Uu,[u[4]||(u[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:te(["field-value",d.value])},y(p.value)+" "+y(c.value.status),3)])):O("",!0),c.value.description?(a(),l("div",qu,[u[5]||(u[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",zu,y(c.value.description),1)])):O("",!0),c.value.owner?(a(),l("div",Ku,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",Gu,y(c.value.owner),1)])):O("",!0),c.value.blockedBy?.length?(a(),l("div",Yu,[u[7]||(u[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",Ju,[(a(!0),l(re,null,ce(c.value.blockedBy,w=>(a(),l("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):O("",!0),c.value.blocks?.length?(a(),l("div",Qu,[u[8]||(u[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Xu,[(a(!0),l(re,null,ce(c.value.blocks,w=>(a(),l("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):O("",!0)])):(a(),l("div",Zu,[s("pre",ed,y(r.value),1)]))]))])):O("",!0)]))}},sd=ne(td,[["__scopeId","data-v-a80d14da"]]),nd={class:"notebook-edit-tool-handler"},od={class:"tool-section"},id={class:"notebook-info"},ad={class:"file-path"},rd={class:"cell-info mt-2"},ld={class:"info-row"},cd={class:"info-row"},ud={key:0,class:"info-row"},dd={class:"badge bg-info"},md={key:0,class:"source-preview mt-3"},pd={class:"preview-header"},fd={class:"preview-stats"},vd={class:"source-code"},hd={key:0,class:"tool-section"},_d={key:0},gd={key:1,class:"text-danger"},bd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.notebook_path||"Unknown"),o=h(()=>e.toolCall.input?.cell_id),i=h(()=>e.toolCall.input?.cell_type||"code"),r=h(()=>e.toolCall.input?.edit_mode||"replace"),c=h(()=>e.toolCall.input?.new_source||""),p=h(()=>c.value.split(`
`).length),d=h(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=r.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,g)=>(a(),l("div",nd,[s("div",od,[s("div",id,[g[0]||(g[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=s("strong",null,"Notebook:",-1)),s("code",ad,y(t.value),1)]),s("div",rd,[s("div",ld,[g[2]||(g[2]=s("strong",null,"Cell ID:",-1)),s("code",null,y(o.value||"N/A"),1)]),s("div",cd,[g[3]||(g[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:te(["badge",d.value])},y(i.value),3)]),r.value?(a(),l("div",ud,[g[4]||(g[4]=s("strong",null,"Edit Mode:",-1)),s("span",dd,y(r.value),1)])):O("",!0)]),c.value?(a(),l("div",md,[s("div",pd,[g[5]||(g[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",fd,y(p.value)+" lines",1)]),s("pre",vd,[s("code",null,y(c.value),1)])])):O("",!0)]),n.toolCall.result?(a(),l("div",hd,[g[6]||(g[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:te(["tool-result",f.value])},[n.toolCall.result.success!==!1?(a(),l("div",_d," âœ… "+y(u.value),1)):(a(),l("div",gd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):O("",!0)]))}},yd=ne(bd,[["__scopeId","data-v-c81a9bcf"]]),wd={class:"shell-tool-handler"},$d={class:"tool-section"},kd={class:"shell-info"},Sd={class:"shell-icon"},Ed={key:0,class:"shell-id"},Cd={key:0,class:"filter-info mt-2"},Td={class:"filter-pattern"},xd={key:0,class:"tool-section"},Ad={class:"result-header mb-2"},Md={key:0,class:"mb-2"},Od={class:"shell-output"},Dd={key:1,class:"mb-2"},Nd={class:"shell-output shell-output-error"},Ld={key:0},Id={key:1,class:"text-danger"},jd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=h(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=h(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=h(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=h(()=>e.toolCall.input?.filter);function p($,k){if(!$)return null;const b=new RegExp(`<${k}>([\\s\\S]*?)<\\/${k}>`,"i"),m=$.match(b);return m?m[1].trim():null}const d=h(()=>{const $=e.toolCall.result;if(!$)return null;let k=$;if($.content&&(k=$.content),typeof k=="string")return{status:p(k,"status"),stdout:p(k,"stdout"),stderr:p(k,"stderr"),exit_code:p(k,"exit_code")};if(Array.isArray(k)){const b=k.find(m=>m.type==="text")?.text||"";return{status:p(b,"status"),stdout:p(b,"stdout"),stderr:p(b,"stderr"),exit_code:p(b,"exit_code")}}return{status:$.status||k.status,stdout:$.stdout||$.output||k.stdout||k.output,stderr:$.stderr||k.stderr,exit_code:$.exit_code||k.exit_code}}),f=h(()=>d.value?.status),u=h(()=>{const $=f.value;return $==="running"?"bg-success":$==="completed"?"bg-secondary":$==="killed"||$==="terminated"?"bg-danger":"bg-info"}),w=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const $=d.value;if($?.status==="running"&&!$.stdout&&!$.stderr)return"No new output since last check";if($?.status==="failed")return`Shell failed (exit code ${$.exit_code||"unknown"})`}return"Operation completed"});return($,k)=>(a(),l("div",wd,[s("div",$d,[s("div",kd,[s("span",Sd,y(t.value),1),s("strong",null,y(o.value)+":",1),r.value?(a(),l("code",Ed,"Shell "+y(r.value),1)):O("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(a(),l("div",Cd,[k[0]||(k[0]=s("strong",null,"Filter:",-1)),s("code",Td,y(c.value),1)])):O("",!0)]),n.toolCall.result?(a(),l("div",xd,[s("div",Ad,[s("strong",null,y(i.value)+":",1),f.value?(a(),l("span",{key:0,class:te(["badge",u.value])},y(f.value),3)):O("",!0)]),d.value?.stdout?(a(),l("div",Md,[k[1]||(k[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Od,[s("pre",null,[s("code",null,y(d.value.stdout),1)])])])):O("",!0),d.value?.stderr?(a(),l("div",Dd,[k[2]||(k[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",Nd,[s("pre",null,[s("code",null,y(d.value.stderr),1)])])])):O("",!0),!d.value?.stdout&&!d.value?.stderr?(a(),l("div",{key:2,class:te(["tool-result",w.value])},[n.toolCall.result.success!==!1?(a(),l("div",Ld," âœ… "+y(g.value),1)):(a(),l("div",Id," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):O("",!0)])):O("",!0)]))}},Sn=ne(jd,[["__scopeId","data-v-86def281"]]),Pd={class:"skill-tool-handler"},Rd={key:0,class:"tool-section"},Wd={class:"d-flex align-items-center gap-2"},Fd={class:"text-muted small"},Bd={key:0,class:"skill-content-body"},Hd={class:"skill-content-text"},Vd={key:1,class:"tool-section mt-3"},Ud={class:"tool-result tool-result-error"},qd={class:"tool-code"},zd={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=de(),i=P(!1);function r(){i.value=!i.value}const c=h(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const $=t.messagesBySession.get(g)||[],k=$.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let b=null,m=null;for(let _=k+1;_<Math.min(k+3,$.length);_++){const v=$[_];if(v.type!=="user")continue;const x=v.content||"";x.includes("<command-message>")&&x.includes("skill is running")?b=v:x.startsWith("Base directory for this skill:")&&(m=v)}return{running:b,content:m}}),p=h(()=>{const g=c.value.content;if(!g)return"";const $=g.content||"",k=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return $.replace(k,"").trim()}),d=h(()=>p.value.length>0),f=h(()=>p.value?p.value.split(`
`).length:0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,$)=>(a(),l("div",Pd,[d.value?(a(),l("div",Rd,[s("div",{class:"skill-content-header",onClick:r},[s("div",Wd,[s("i",{class:te(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),$[0]||($[0]=s("strong",null,"Skill Content",-1)),s("span",Fd,"("+y(f.value)+" lines)",1)])]),i.value?(a(),l("div",Bd,[s("pre",Hd,y(p.value),1)])):O("",!0)])):O("",!0),u.value?(a(),l("div",Vd,[$[1]||($[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Ud,[s("pre",qd,y(w.value),1)])])):O("",!0)]))}},Kd=ne(zd,[["__scopeId","data-v-0a48ca0f"]]),Gd={class:"slashcommand-tool-handler"},Yd={key:0,class:"tool-section"},Jd={class:"d-flex align-items-center gap-2"},Qd=["aria-label"],Xd={class:"text-muted small"},Zd={key:0,class:"command-content-body"},em={class:"command-content-text"},tm={key:1,class:"tool-section mt-3"},sm={class:"tool-result tool-result-error"},nm={class:"tool-code"},om={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=de(),i=P(!1);function r(){i.value=!i.value}const c=h(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const $=t.messagesBySession.get(g)||[],k=$.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let b=null,m=null;for(let _=k+1;_<Math.min(k+3,$.length);_++){const v=$[_];if(v.type!=="user")continue;const x=v.content||"";x.includes("<command-message>")&&x.includes("<command-name>")&&x.includes("<command-args>")?b=v:x.includes("ARGUMENTS:")&&(m=v)}return{running:b,content:m}}),p=h(()=>{const g=c.value.content;if(!g)return"";const $=g.content||"",k=/\nARGUMENTS:.*$/s;return $.replace(k,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),d=h(()=>p.value.length>0),f=h(()=>p.value?p.value.split(`
`).length:0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,$)=>(a(),l("div",Gd,[d.value?(a(),l("div",Yd,[s("div",{class:"command-content-header",onClick:r},[s("div",Jd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},y(i.value?"â–¾":"â–¸"),9,Qd),$[0]||($[0]=s("strong",null,"Command Content",-1)),s("span",Xd,"("+y(f.value)+" lines)",1)])]),i.value?(a(),l("div",Zd,[s("pre",em,y(p.value),1)])):O("",!0)])):O("",!0),u.value?(a(),l("div",tm,[$[1]||($[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",sm,[s("pre",nm,y(w.value),1)])])):O("",!0)]))}},im=ne(om,[["__scopeId","data-v-15991acf"]]),am={class:"exit-plan-mode-tool-handler"},rm={class:"tool-section"},lm={key:0,class:"plan-content mt-2"},cm={class:"plan-text"},um={key:0,class:"tool-section"},dm={key:0},mm={key:1,class:"text-danger"},pm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.plan),o=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,r)=>(a(),l("div",am,[s("div",rm,[r[1]||(r[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(a(),l("div",lm,[r[0]||(r[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",cm,y(t.value),1)])):O("",!0)]),n.toolCall.result?(a(),l("div",um,[r[2]||(r[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:te(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),l("div",dm," âœ… Permission mode reverted to default ")):(a(),l("div",mm," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):O("",!0)]))}},fm=ne(pm,[["__scopeId","data-v-e2e3c781"]]),vm={class:"ask-user-question-handler"},hm={key:0,class:"answers-summary"},_m={class:"answer-question text-muted small"},gm={class:"answer-value fw-medium"},bm={key:1,class:"text-muted small"},ym={key:0,class:"questions-container"},wm={class:"question-header d-flex align-items-center gap-2 mb-2"},$m={key:0,class:"badge bg-secondary"},km={class:"question-text fw-medium"},Sm={class:"options-list"},Em=["id","checked","onChange"],Cm=["id","name","checked","onChange"],Tm=["for"],xm={class:"option-label"},Am={key:0,class:"option-description text-muted d-block small"},Mm={class:"option-item form-check other-option"},Om=["id","checked","onChange"],Dm=["id","name","checked","onChange"],Nm=["for"],Lm={key:2,class:"other-input mt-2"},Im=["onUpdate:modelValue","onInput"],jm={key:1,class:"alert alert-info mb-0"},Pm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=h(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=h(()=>{if(!r.value)return{};const E=o.toolCall.result;if(E?.content){if(typeof E.content=="object"&&E.content.answers)return E.content.answers;if(typeof E.content=="string")try{const I=JSON.parse(E.content);if(I.answers)return I.answers}catch{}}const R=o.toolCall.input||{};return R.answers?R.answers:{}}),p=h(()=>Object.keys(c.value).length>0),d=h(()=>(o.toolCall.input||{}).questions||[]),f=P({}),u=P({});fe(d,E=>{E.forEach((R,I)=>{I in f.value||(f.value[I]=R.multiSelect?[]:null),I in u.value||(u.value[I]="")})},{immediate:!0});function w(E,R){const I=f.value[E];return Array.isArray(I)?I.includes(R):I===R}function g(E){const R=f.value[E];return Array.isArray(R)?R.includes("__OTHER__"):R==="__OTHER__"}function $(E,R){f.value[E]=R,v()}function k(E){f.value[E]="__OTHER__",v()}function b(E,R){const I=f.value[E];if(!Array.isArray(I))f.value[E]=[R];else{const D=I.indexOf(R);D===-1?I.push(R):I.splice(D,1)}v()}function m(E){const R=f.value[E];if(!Array.isArray(R))f.value[E]=["__OTHER__"];else{const I=R.indexOf("__OTHER__");I===-1?R.push("__OTHER__"):R.splice(I,1)}v()}function _(E){v()}function v(){const E={};d.value.forEach((R,I)=>{const D=f.value[I],W=R.question;if(R.multiSelect){if(Array.isArray(D)&&D.length>0){const T=D.map(A=>A==="__OTHER__"?u.value[I]||"":A).filter(A=>A);E[W]=T.join(", ")}}else D==="__OTHER__"?E[W]=u.value[I]||"":D&&(E[W]=D)}),i("answer",E)}const x=h(()=>d.value.every((E,R)=>{const I=f.value[R];if(E.multiSelect){if(!Array.isArray(I)||I.length===0||I.includes("__OTHER__")&&!u.value[R])return!1}else if(!I||I==="__OTHER__"&&!u.value[R])return!1;return!0}));return e({allQuestionsAnswered:x,getAnswers:()=>{const E={};return d.value.forEach((R,I)=>{const D=f.value[I],W=R.question;if(R.multiSelect){if(Array.isArray(D)&&D.length>0){const T=D.map(A=>A==="__OTHER__"?u.value[I]||"":A).filter(A=>A);E[W]=T.join(", ")}}else D==="__OTHER__"?E[W]=u.value[I]||"":D&&(E[W]=D)}),E}}),(E,R)=>(a(),l("div",vm,[r.value?(a(),l(re,{key:0},[p.value?(a(),l("div",hm,[(a(!0),l(re,null,ce(c.value,(I,D)=>(a(),l("div",{key:D,class:"answer-item mb-2"},[s("div",_m,y(D),1),s("div",gm,y(I),1)]))),128))])):(a(),l("div",bm," No answers recorded. "))],64)):(a(),l(re,{key:1},[d.value.length>0?(a(),l("div",ym,[(a(!0),l(re,null,ce(d.value,(I,D)=>(a(),l("div",{key:D,class:"question-block mb-3"},[s("div",wm,[I.header?(a(),l("span",$m,y(I.header),1)):O("",!0),s("span",km,y(I.question),1)]),s("div",Sm,[(a(!0),l(re,null,ce(I.options,(W,T)=>(a(),l("div",{key:T,class:te(["option-item form-check",{selected:w(D,W.label)}])},[I.multiSelect?(a(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${D}-opt${T}`,checked:w(D,W.label),onChange:A=>b(D,W.label)},null,40,Em)):(a(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${D}-opt${T}`,name:`question-${D}`,checked:w(D,W.label),onChange:A=>$(D,W.label)},null,40,Cm)),s("label",{class:"form-check-label",for:`q${D}-opt${T}`},[s("span",xm,y(W.label),1),W.description?(a(),l("span",Am,y(W.description),1)):O("",!0)],8,Tm)],2))),128)),s("div",Mm,[I.multiSelect?(a(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${D}-other`,checked:g(D),onChange:W=>m(D)},null,40,Om)):(a(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${D}-other`,name:`question-${D}`,checked:g(D),onChange:W=>k(D)},null,40,Dm)),s("label",{class:"form-check-label",for:`q${D}-other`},[...R[0]||(R[0]=[s("span",{class:"option-label"},"Other",-1)])],8,Nm),g(D)?(a(),l("div",Lm,[ge(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":W=>u.value[D]=W,placeholder:"Enter your custom answer...",onInput:W=>_()},null,40,Im),[[Re,u.value[D]]])])):O("",!0)])])]))),128))])):(a(),l("div",jm," No questions to display. "))],64))]))}},En=ne(Pm,[["__scopeId","data-v-75ce45b4"]]),Rm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Wm={class:"tool-status-icon"},Fm=["title"],Bm={class:"d-flex align-items-center gap-2"},Hm={class:"text-muted"},Vm=["aria-label"],Um={key:0,class:"card-body"},qm={key:0,class:"alert alert-warning mb-3"},zm={class:"d-flex align-items-center"},Km={class:"mb-0 small"},Gm={key:2,class:"permission-prompt mt-3"},Ym={class:"question-buttons d-flex gap-2 mt-3"},Jm=["disabled"],Qm=["disabled"],Xm={class:"alert alert-warning mb-3"},Zm={class:"mb-0"},ep={class:"tool-name"},tp={key:0,class:"suggestions-section mb-3"},sp={class:"alert alert-info mb-0"},np={class:"suggestion-details p-2 bg-white rounded"},op={class:"permission-buttons d-flex gap-2 mb-3"},ip=["disabled"],ap=["disabled"],rp=["disabled"],lp={class:"guidance-section mt-3"},cp=["disabled"],up=["disabled"],dp={key:3,class:"mt-3"},mp={class:"alert alert-warning mb-0"},pp={class:"d-flex align-items-center"},fp={class:"mb-0 small"},vp={key:4,class:"tool-section"},hp={class:"alert alert-danger mb-0"},_p={key:0},gp={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=de(),i=st(),r=P(!1),c=P(null),p=P(""),d=P(null),f=P({}),u=h(()=>e.toolCall.name==="AskUserQuestion"),w=h(()=>!u.value||!d.value?!1:d.value.allQuestionsAnswered);function g(C){f.value=C}async function $(){if(!r.value&&d.value){r.value=!0,c.value="submit-answers";try{const C=o.currentSessionId,M=d.value.getAnswers(),V={questions:e.toolCall.input?.questions||[],answers:M};C&&(t.updateToolCall(C,e.toolCall.id,{input:V}),t.handlePermissionResponse(C,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",V)}catch(C){console.error("Failed to submit question answers:",C)}finally{r.value=!1,c.value=null}}}const k=h(()=>e.toolCall.backendStatus==="interrupted"?!0:t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),b=h(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),m=h(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),_=h(()=>{if(e.toolCall.backendStatus){const C=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[C]||C}if(m.value){const C=m.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[C]||C}return e.toolCall.status}),v={Read:ur,Write:Tr,Bash:Fr,TodoWrite:nl,Edit:El,Grep:$n,Glob:$n,WebFetch:kn,WebSearch:kn,Task:Mc,TaskCreate:zc,TaskUpdate:_u,TaskList:Du,TaskGet:sd,NotebookEdit:yd,BashOutput:Sn,KillShell:Sn,SlashCommand:im,Skill:Kd,ExitPlanMode:fm,AskUserQuestion:En},x=h(()=>{const C=e.toolCall.name;return v[C]?v[C]:Ha}),E=h(()=>{const C=[];if(k.value)return C.push("border-warning"),C.join(" ");switch(_.value){case"pending":C.push("border-secondary");break;case"permission_required":C.push("border-warning");break;case"executing":C.push("border-primary");break;case"completed":D.value||e.toolCall.permissionDecision==="deny"?C.push("border-danger"):C.push("border-success");break;case"error":C.push("border-danger");break}return C.join(" ")}),R=h(()=>{if(k.value)return"â¹ï¸";switch(_.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":D.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),I=h(()=>Bt(e.toolCall.timestamp)),D=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),W=h(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function T(C){if(!C)return"";const M=C.replace(/\\/g,"/").split("/");return M[M.length-1]}function A(C){if(!C)return"";const M=C.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return M?M[1]:C}function U(C,M=200){return C?C.length<=M?C:C.substring(0,M)+"...":""}function G(C){if(!C)return null;if(C.content){const M=C.content.match(/exit code (\d+)/i);if(M)return parseInt(M[1])}return C.error?1:0}function L(C,M){const V=C?C.split(`
`).length:0;return{added:M?M.split(`
`).length:0,removed:V}}const F=h(()=>{const C=e.toolCall.name,M=e.toolCall.input||{},V=e.toolCall.result,K=_.value;switch(C){case"Bash":case"Shell":case"Command":{const J=A(M.command),Q=U(J,200);if(K==="completed"&&V){const se=G(V);return`Bash: ${Q} (exit ${se})`}return`Bash: ${Q}`}case"SlashCommand":{const J=U(M.command,200);return K==="completed"&&V?`SlashCommand: ${J}`:`SlashCommand: ${J}`}case"Edit":{const J=T(M.file_path);if(K==="completed"&&V&&!V.error){const{added:Q,removed:se}=L(M.old_string,M.new_string);return Q===se?`Edit: ${J} (${Q} lines changed)`:`Edit: ${J} (${Q} lines added, ${se} removed)`}return`Edit: ${J}`}case"Read":{const J=T(M.file_path);if(M.offset!==void 0||M.limit!==void 0){const se=(M.offset||0)+1,X=M.limit?(M.offset||0)+M.limit:"âˆž";return`Read: ${J} (lines ${se}-${X})`}return`Read: ${J} (full file)`}case"Write":{const J=T(M.file_path);if(K==="completed"&&V&&!V.error&&M.content){const Q=M.content.split(`
`).length;return`Write: ${J} (${Q} lines written)`}return`Write: ${J}`}case"Skill":{const J=M.skill||"Unknown";return K==="completed"&&V?V.error?`Skill: ${J} (error)`:`Skill: ${J} (completed)`:`Skill: ${J}`}case"Task":{const J=M.subagent_type||"general",Q=M.description||"Task";return K==="completed"&&V?V.error?`Task: (${J}) ${Q} (error)`:`Task: (${J}) ${Q} (completed)`:`Task: (${J}) ${Q}`}case"TodoWrite":{if(M.todos&&Array.isArray(M.todos)){const J=M.todos.filter(X=>X.status==="completed").length,Q=M.todos.length,se=M.todos.find(X=>X.status==="in_progress");return se?`Todo: Working on "${se.content}"`:`Todo: ${J}/${Q} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const J=M.pattern||"",Q=C==="Grep"?"Grep":"Glob";if(K==="completed"&&V&&!V.error){let se=0;return V.content&&(se=V.content.split(`
`).filter(B=>B.trim()).length),`${Q}: "${J}" (${se} results)`}return`${Q}: "${J}"`}case"WebFetch":case"WebSearch":{const J=M.url||M.query||"";if(C==="WebSearch"){const se=M.query||"",X=se.length>50?se.substring(0,50)+"...":se;return K==="completed"&&V?V.error?`Web: ${X} (error)`:`Web: ${X} (success)`:`Web: ${X}`}let Q="";try{J&&(Q=new URL(J.startsWith("http")?J:`https://${J}`).hostname)}catch{Q=J.length>50?J.substring(0,50)+"...":J}return K==="completed"&&V?V.error?`Web: ${Q} (error)`:`Web: ${Q} (success)`:`Web: ${Q||J}`}case"NotebookEdit":{const J=T(M.notebook_path),Q=M.cell_number!==void 0?M.cell_number:"?",se=M.edit_mode||"replace";return`NotebookEdit: ${J} cell #${Q} (${se})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${M.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${M.shell_id||"unknown"}`;case"AskUserQuestion":{const Q=(M.questions||[]).length;return K==="completed"&&V&&!V.error?`AskUserQuestion: ${Q} question(s) answered`:K==="permission_required"?`AskUserQuestion: ${Q} question(s) awaiting response`:`AskUserQuestion: ${Q} question(s)`}case"TaskCreate":{const J=M.subject||"",Q=J.length>40?J.substring(0,40)+"...":J;return K==="completed"&&V&&!V.error?`TaskCreate: "${Q}" (created)`:`TaskCreate: "${Q}"`}case"TaskUpdate":{const J=M.taskId||"?",Q=M.status||"";return Q?`TaskUpdate: #${J} -> ${Q}`:`TaskUpdate: #${J}`}case"TaskList":return K==="completed"&&V&&!V.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const J=M.taskId||"?";return K==="completed"&&V&&!V.error?`TaskGet: #${J} (retrieved)`:`TaskGet: #${J}`}default:return`${C}: executed`}}),q=h(()=>{const C=e.toolCall.name,M=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(C)?M.command||C:["Edit","Read","Write","NotebookEdit"].includes(C)&&(M.file_path||M.notebook_path)||C});function Z(){const C=o.currentSessionId;C&&t.toggleToolExpansion(C,e.toolCall.id)}function N(C){return C.type==="setMode"?`Set permission mode to "${C.mode}"`:C.type==="allow"?`Allow tool: ${C.tool}`:JSON.stringify(C)}async function S(C,M,V=null){if(!r.value){r.value=!0,C==="allow"?c.value=M?"approve-apply":"approve":V?c.value="deny-guidance":c.value="deny";try{const K=o.currentSessionId;if(K){const J=M&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(K,{request_id:e.toolCall.permissionRequestId,decision:C,reasoning:C==="allow"?"User allowed permission":"User denied permission",applied_updates:J})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,C,M,V)}catch(K){console.error("Failed to send permission response:",K)}finally{r.value=!1,c.value=null}}}return(C,M)=>(a(),l("div",{class:te(["tool-call-card card",E.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:Z},[s("div",Rm,[s("span",Wm,y(R.value),1),s("span",{class:"tool-name",title:q.value},y(F.value),9,Fm)]),s("div",Bm,[s("small",Hm,y(I.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Vm)])]),n.toolCall.isExpanded?(a(),l("div",Um,[k.value?(a(),l("div",qm,[s("div",zm,[M[7]||(M[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[M[6]||(M[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Km,y(b.value?.message||"Session was terminated"),1)])])])):O("",!0),u.value&&_.value==="permission_required"?O("",!0):(a(),be(po(x.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),_.value==="permission_required"&&!k.value?(a(),l("div",Gm,[u.value?(a(),l(re,{key:0},[M[8]||(M[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),pe(En,{ref_key:"questionHandlerRef",ref:d,toolCall:n.toolCall,onAnswer:g},null,8,["toolCall"]),s("div",Ym,[s("button",{class:"btn btn-primary",onClick:$,disabled:r.value||!w.value},y(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,Jm),s("button",{class:"btn btn-outline-secondary",onClick:M[0]||(M[0]=V=>S("deny",!1)),disabled:r.value}," Skip Question ",8,Qm)])],64)):(a(),l(re,{key:1},[s("div",Xm,[M[11]||(M[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Zm,[M[9]||(M[9]=ie("Claude wants to use the ",-1)),s("code",ep,y(n.toolCall.name),1),M[10]||(M[10]=ie(" tool.",-1))])]),W.value?(a(),l("div",tp,[s("div",sp,[M[12]||(M[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),M[13]||(M[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",np,[(a(!0),l(re,null,ce(n.toolCall.suggestions,(V,K)=>(a(),l("div",{key:K,class:"suggestion-item"},[s("code",null,y(N(V)),1)]))),128))]),M[14]||(M[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):O("",!0),s("div",op,[W.value?(a(),l("button",{key:0,class:"btn btn-success",onClick:M[1]||(M[1]=V=>S("allow",!0)),disabled:r.value},y(r.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,ip)):O("",!0),s("button",{class:te(["btn",W.value?"btn-outline-success":"btn-success"]),onClick:M[2]||(M[2]=V=>S("allow",!1)),disabled:r.value},y(r.value&&c.value==="approve"?"â³ Submitting...":W.value?"âœ… Approve Only":"âœ… Approve"),11,ap),s("button",{class:"btn btn-danger",onClick:M[3]||(M[3]=V=>S("deny",!1)),disabled:r.value}," ðŸš« "+y(r.value&&c.value==="deny"?"Submitting...":"Deny"),9,rp)]),s("div",lp,[M[15]||(M[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),M[16]||(M[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ge(s("textarea",{"onUpdate:modelValue":M[4]||(M[4]=V=>p.value=V),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:r.value},null,8,cp),[[Re,p.value]]),p.value.trim()?(a(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:M[5]||(M[5]=V=>S("deny",!1,p.value)),disabled:r.value},y(r.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,up)):O("",!0)])],64))])):O("",!0),_.value==="permission_required"&&k.value?(a(),l("div",dp,[s("div",mp,[s("div",pp,[M[18]||(M[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[M[17]||(M[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",fp,y(b.value?.message||"Session was terminated before permission could be granted"),1)])])])])):O("",!0),n.toolCall.permissionDecision==="deny"?(a(),l("div",vp,[s("div",hp,[M[19]||(M[19]=ie(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),l("span",_p," - "+y(n.toolCall.result.message),1)):O("",!0)])])):O("",!0)])):O("",!0)],2))}},bp=ne(gp,[["__scopeId","data-v-2377ca10"]]);function Cn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function yp(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Tn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function wp(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=yp(t.command),i=Tn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Tn(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=Cn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",r=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Cn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const $p={key:0,class:"tool-timeline-bar"},kp={class:"timeline-container"},Sp=["title","onClick","onKeydown"],Ep={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=xe(),r=de(),c=h(()=>t.tools.map(($,k)=>({tool:$,originalIndex:k})).sort(($,k)=>{if($.tool.timestamp&&k.tool.timestamp){const b=new Date($.tool.timestamp).getTime(),m=new Date(k.tool.timestamp).getTime();if(b!==m)return b-m}return $.originalIndex-k.originalIndex}).map(({tool:$})=>$));function p($){const k=r.currentSessionId;if(!k)return $.status;const b=i.getBackendToolState(k,$.id);return b?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[b.state]||b.state:i.isToolUseOrphaned(k,$.id)?"orphaned":$.status}function d($){return $.result?.error||$.status==="error"||$.permissionDecision==="deny"}function f($){return p($)==="executing"}function u($){switch(p($)){case"completed":return d($)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w($){const k=wp($),b=p($),m={completed:d($)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[b]||b;return`${k} [${m}]`}function g($,k){o("segment-click",{tool:$,index:k})}return($,k)=>c.value.length>0?(a(),l("div",$p,[s("div",kp,[(a(!0),l(re,null,ce(c.value,(b,m)=>(a(),l("div",{key:b.id,class:te(["timeline-segment",u(b)]),style:{flex:1},title:w(b),onClick:_=>g(b,m),role:"button",tabindex:"0",onKeydown:[Ue(_=>g(b,m),["enter"]),Ue(ve(_=>g(b,m),["prevent"]),["space"])]},[s("span",{class:te(["segment-inner",{"executing-pulse":f(b)}])},null,2)],42,Sp))),128))])])):O("",!0)}},Cp=ne(Ep,[["__scopeId","data-v-4a85fba6"]]),Tp={class:"tool-footer-container"},xp={class:"tool-cards-list"},Ap={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=xe(),o=de(),i=h(()=>e.tools.map((c,p)=>({tool:c,originalIndex:p})).sort((c,p)=>{if(c.tool.timestamp&&p.tool.timestamp){const d=new Date(c.tool.timestamp).getTime(),f=new Date(p.tool.timestamp).getTime();if(d!==f)return d-f}return c.originalIndex-p.originalIndex}).map(({tool:c})=>c));async function r({tool:c}){const p=o.currentSessionId;if(!p)return;t.toggleToolExpansion(p,c.id),await kt();const d=document.querySelector(`[data-tool-id="${c.id}"]`);d&&d.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,p)=>(a(),l("div",Tp,[pe(Cp,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),s("div",xp,[(a(!0),l(re,null,ce(i.value,d=>(a(),be(bp,{key:d.id,toolCall:d,"data-tool-id":d.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Mp=ne(Ap,[["__scopeId","data-v-527d59ae"]]),Op={class:"message-row message-row-assistant"},Dp=["title"],Np={class:"message-content-column"},Lp={key:0,class:"thinking-block mb-2"},Ip=["innerHTML"],jp={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=xe(),o=de();ut.setOptions({breaks:!0,gfm:!0});const i=h(()=>Bt(e.message.timestamp)),r=h(()=>e.message.metadata?.model||null),c=h(()=>{const k=i.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${k}`}),p=h(()=>{const k=e.message.content||"";return k.trim().length>0&&k!=="Assistant response"}),d=h(()=>{const k=e.message.content||"";let b=ut.parse(k);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),cs.sanitize(b)}),f=h(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=h(()=>e.message.metadata?.thinking_content||""),w=h(()=>{const k=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return k||b}),g=h(()=>{const k=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],m=[...k],_=new Set(k.map(v=>v.id));for(const v of b)_.has(v.id)||m.push(v);return m}),$=h(()=>{const k=o.currentSessionId;if(!k)return[];const b=t.toolCallsBySession.get(k)||[];return g.value.map(m=>{const _=b.find(v=>v.id===m.id);return _||{id:m.id,name:m.name,input:m.input,status:"pending",result:null,timestamp:m.timestamp||e.message.timestamp,isExpanded:!0}})});return(k,b)=>(a(),l("div",Op,[s("div",{class:"message-speaker",title:c.value},[...b[0]||(b[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Dp),s("div",Np,[f.value?(a(),l("div",Lp,[pe(Ma,{thinking:u.value},null,8,["thinking"])])):O("",!0),p.value?(a(),l("div",{key:1,class:"message-text",innerHTML:d.value},null,8,Ip)):O("",!0),w.value?(a(),be(Mp,{key:2,tools:$.value},null,8,["tools"])):O("",!0)])]))}},Pp=ne(jp,[["__scopeId","data-v-2e32f6ef"]]),Rp={key:0,class:"message-row message-row-compaction"},Wp=["title"],Fp={class:"message-content-column"},Bp={class:"compaction-status-content"},Hp={class:"text-muted ms-auto"},Vp={key:1,class:"message-row message-row-system"},Up=["title"],qp={class:"message-content-column"},zp={class:"system-text"},Kp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>Bt(e.message.timestamp)),o=h(()=>`system
${t.value}`),i=h(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,c)=>i.value?(a(),l("div",Rp,[s("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Wp),s("div",Fp,[s("div",Bp,[c[1]||(c[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Hp,y(t.value),1)])])])):(a(),l("div",Vp,[s("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Up),s("div",qp,[s("span",zp,y(n.message.content),1)])]))}},xn=ne(Kp,[["__scopeId","data-v-a078178f"]]),Gp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=h(()=>{switch(e.message.type){case"user":return ka;case"assistant":return Pp;case"system":return xn;default:return xn}});return(o,i)=>(a(),be(po(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Yp=ne(Gp,[["__scopeId","data-v-11dff525"]]);var $e="top",Ae="bottom",Me="right",ke="left",us="auto",Dt=[$e,Ae,Me,ke],dt="start",Et="end",go="clippingParents",Ys="viewport",gt="popper",bo="reference",Hs=Dt.reduce(function(n,e){return n.concat([e+"-"+dt,e+"-"+Et])},[]),Js=[].concat(Dt,[us]).reduce(function(n,e){return n.concat([e,e+"-"+dt,e+"-"+Et])},[]),yo="beforeRead",wo="read",$o="afterRead",ko="beforeMain",So="main",Eo="afterMain",Co="beforeWrite",To="write",xo="afterWrite",Ao=[yo,wo,$o,ko,So,Eo,Co,To,xo];function Ve(n){return n?(n.nodeName||"").toLowerCase():null}function Oe(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function mt(n){var e=Oe(n).Element;return n instanceof e||n instanceof Element}function De(n){var e=Oe(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Qs(n){if(typeof ShadowRoot>"u")return!1;var e=Oe(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Jp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];!De(r)||!Ve(r)||(Object.assign(r.style,o),Object.keys(i).forEach(function(c){var p=i[c];p===!1?r.removeAttribute(c):r.setAttribute(c,p===!0?"":p)}))})}function Qp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],r=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),p=c.reduce(function(d,f){return d[f]="",d},{});!De(i)||!Ve(i)||(Object.assign(i.style,p),Object.keys(r).forEach(function(d){i.removeAttribute(d)}))})}}const Mo={name:"applyStyles",enabled:!0,phase:"write",fn:Jp,effect:Qp,requires:["computeStyles"]};function Be(n){return n.split("-")[0]}var ct=Math.max,is=Math.min,Ct=Math.round;function Vs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Oo(){return!/^((?!chrome|android).)*safari/i.test(Vs())}function Tt(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,r=1;e&&De(n)&&(i=n.offsetWidth>0&&Ct(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&Ct(o.height)/n.offsetHeight||1);var c=mt(n)?Oe(n):window,p=c.visualViewport,d=!Oo()&&t,f=(o.left+(d&&p?p.offsetLeft:0))/i,u=(o.top+(d&&p?p.offsetTop:0))/r,w=o.width/i,g=o.height/r;return{width:w,height:g,top:u,right:f+w,bottom:u+g,left:f,x:f,y:u}}function Xs(n){var e=Tt(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function Do(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Qs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ke(n){return Oe(n).getComputedStyle(n)}function Xp(n){return["table","td","th"].indexOf(Ve(n))>=0}function nt(n){return((mt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ds(n){return Ve(n)==="html"?n:n.assignedSlot||n.parentNode||(Qs(n)?n.host:null)||nt(n)}function An(n){return!De(n)||Ke(n).position==="fixed"?null:n.offsetParent}function Zp(n){var e=/firefox/i.test(Vs()),t=/Trident/i.test(Vs());if(t&&De(n)){var o=Ke(n);if(o.position==="fixed")return null}var i=ds(n);for(Qs(i)&&(i=i.host);De(i)&&["html","body"].indexOf(Ve(i))<0;){var r=Ke(i);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return i;i=i.parentNode}return null}function Ht(n){for(var e=Oe(n),t=An(n);t&&Xp(t)&&Ke(t).position==="static";)t=An(t);return t&&(Ve(t)==="html"||Ve(t)==="body"&&Ke(t).position==="static")?e:t||Zp(n)||e}function Zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Rt(n,e,t){return ct(n,is(e,t))}function ef(n,e,t){var o=Rt(n,e,t);return o>t?t:o}function No(){return{top:0,right:0,bottom:0,left:0}}function Lo(n){return Object.assign({},No(),n)}function Io(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var tf=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Lo(typeof e!="number"?e:Io(e,Dt))};function sf(n){var e,t=n.state,o=n.name,i=n.options,r=t.elements.arrow,c=t.modifiersData.popperOffsets,p=Be(t.placement),d=Zs(p),f=[ke,Me].indexOf(p)>=0,u=f?"height":"width";if(!(!r||!c)){var w=tf(i.padding,t),g=Xs(r),$=d==="y"?$e:ke,k=d==="y"?Ae:Me,b=t.rects.reference[u]+t.rects.reference[d]-c[d]-t.rects.popper[u],m=c[d]-t.rects.reference[d],_=Ht(r),v=_?d==="y"?_.clientHeight||0:_.clientWidth||0:0,x=b/2-m/2,E=w[$],R=v-g[u]-w[k],I=v/2-g[u]/2+x,D=Rt(E,I,R),W=d;t.modifiersData[o]=(e={},e[W]=D,e.centerOffset=D-I,e)}}function nf(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Do(e.elements.popper,i)&&(e.elements.arrow=i))}const jo={name:"arrow",enabled:!0,phase:"main",fn:sf,effect:nf,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function xt(n){return n.split("-")[1]}var of={top:"auto",right:"auto",bottom:"auto",left:"auto"};function af(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Ct(t*i)/i||0,y:Ct(o*i)/i||0}}function Mn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,r=n.variation,c=n.offsets,p=n.position,d=n.gpuAcceleration,f=n.adaptive,u=n.roundOffsets,w=n.isFixed,g=c.x,$=g===void 0?0:g,k=c.y,b=k===void 0?0:k,m=typeof u=="function"?u({x:$,y:b}):{x:$,y:b};$=m.x,b=m.y;var _=c.hasOwnProperty("x"),v=c.hasOwnProperty("y"),x=ke,E=$e,R=window;if(f){var I=Ht(t),D="clientHeight",W="clientWidth";if(I===Oe(t)&&(I=nt(t),Ke(I).position!=="static"&&p==="absolute"&&(D="scrollHeight",W="scrollWidth")),I=I,i===$e||(i===ke||i===Me)&&r===Et){E=Ae;var T=w&&I===R&&R.visualViewport?R.visualViewport.height:I[D];b-=T-o.height,b*=d?1:-1}if(i===ke||(i===$e||i===Ae)&&r===Et){x=Me;var A=w&&I===R&&R.visualViewport?R.visualViewport.width:I[W];$-=A-o.width,$*=d?1:-1}}var U=Object.assign({position:p},f&&of),G=u===!0?af({x:$,y:b},Oe(t)):{x:$,y:b};if($=G.x,b=G.y,d){var L;return Object.assign({},U,(L={},L[E]=v?"0":"",L[x]=_?"0":"",L.transform=(R.devicePixelRatio||1)<=1?"translate("+$+"px, "+b+"px)":"translate3d("+$+"px, "+b+"px, 0)",L))}return Object.assign({},U,(e={},e[E]=v?b+"px":"",e[x]=_?$+"px":"",e.transform="",e))}function rf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,r=t.adaptive,c=r===void 0?!0:r,p=t.roundOffsets,d=p===void 0?!0:p,f={placement:Be(e.placement),variation:xt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Mn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Mn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Po={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:rf,data:{}};var Gt={passive:!0};function lf(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,r=i===void 0?!0:i,c=o.resize,p=c===void 0?!0:c,d=Oe(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&f.forEach(function(u){u.addEventListener("scroll",t.update,Gt)}),p&&d.addEventListener("resize",t.update,Gt),function(){r&&f.forEach(function(u){u.removeEventListener("scroll",t.update,Gt)}),p&&d.removeEventListener("resize",t.update,Gt)}}const Ro={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:lf,data:{}};var cf={left:"right",right:"left",bottom:"top",top:"bottom"};function ts(n){return n.replace(/left|right|bottom|top/g,function(e){return cf[e]})}var uf={start:"end",end:"start"};function On(n){return n.replace(/start|end/g,function(e){return uf[e]})}function en(n){var e=Oe(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function tn(n){return Tt(nt(n)).left+en(n).scrollLeft}function df(n,e){var t=Oe(n),o=nt(n),i=t.visualViewport,r=o.clientWidth,c=o.clientHeight,p=0,d=0;if(i){r=i.width,c=i.height;var f=Oo();(f||!f&&e==="fixed")&&(p=i.offsetLeft,d=i.offsetTop)}return{width:r,height:c,x:p+tn(n),y:d}}function mf(n){var e,t=nt(n),o=en(n),i=(e=n.ownerDocument)==null?void 0:e.body,r=ct(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=ct(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),p=-o.scrollLeft+tn(n),d=-o.scrollTop;return Ke(i||t).direction==="rtl"&&(p+=ct(t.clientWidth,i?i.clientWidth:0)-r),{width:r,height:c,x:p,y:d}}function sn(n){var e=Ke(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Wo(n){return["html","body","#document"].indexOf(Ve(n))>=0?n.ownerDocument.body:De(n)&&sn(n)?n:Wo(ds(n))}function Wt(n,e){var t;e===void 0&&(e=[]);var o=Wo(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),r=Oe(o),c=i?[r].concat(r.visualViewport||[],sn(o)?o:[]):o,p=e.concat(c);return i?p:p.concat(Wt(ds(c)))}function Us(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function pf(n,e){var t=Tt(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Dn(n,e,t){return e===Ys?Us(df(n,t)):mt(e)?pf(e,t):Us(mf(nt(n)))}function ff(n){var e=Wt(ds(n)),t=["absolute","fixed"].indexOf(Ke(n).position)>=0,o=t&&De(n)?Ht(n):n;return mt(o)?e.filter(function(i){return mt(i)&&Do(i,o)&&Ve(i)!=="body"}):[]}function vf(n,e,t,o){var i=e==="clippingParents"?ff(n):[].concat(e),r=[].concat(i,[t]),c=r[0],p=r.reduce(function(d,f){var u=Dn(n,f,o);return d.top=ct(u.top,d.top),d.right=is(u.right,d.right),d.bottom=is(u.bottom,d.bottom),d.left=ct(u.left,d.left),d},Dn(n,c,o));return p.width=p.right-p.left,p.height=p.bottom-p.top,p.x=p.left,p.y=p.top,p}function Fo(n){var e=n.reference,t=n.element,o=n.placement,i=o?Be(o):null,r=o?xt(o):null,c=e.x+e.width/2-t.width/2,p=e.y+e.height/2-t.height/2,d;switch(i){case $e:d={x:c,y:e.y-t.height};break;case Ae:d={x:c,y:e.y+e.height};break;case Me:d={x:e.x+e.width,y:p};break;case ke:d={x:e.x-t.width,y:p};break;default:d={x:e.x,y:e.y}}var f=i?Zs(i):null;if(f!=null){var u=f==="y"?"height":"width";switch(r){case dt:d[f]=d[f]-(e[u]/2-t[u]/2);break;case Et:d[f]=d[f]+(e[u]/2-t[u]/2);break}}return d}function At(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,r=t.strategy,c=r===void 0?n.strategy:r,p=t.boundary,d=p===void 0?go:p,f=t.rootBoundary,u=f===void 0?Ys:f,w=t.elementContext,g=w===void 0?gt:w,$=t.altBoundary,k=$===void 0?!1:$,b=t.padding,m=b===void 0?0:b,_=Lo(typeof m!="number"?m:Io(m,Dt)),v=g===gt?bo:gt,x=n.rects.popper,E=n.elements[k?v:g],R=vf(mt(E)?E:E.contextElement||nt(n.elements.popper),d,u,c),I=Tt(n.elements.reference),D=Fo({reference:I,element:x,placement:i}),W=Us(Object.assign({},x,D)),T=g===gt?W:I,A={top:R.top-T.top+_.top,bottom:T.bottom-R.bottom+_.bottom,left:R.left-T.left+_.left,right:T.right-R.right+_.right},U=n.modifiersData.offset;if(g===gt&&U){var G=U[i];Object.keys(A).forEach(function(L){var F=[Me,Ae].indexOf(L)>=0?1:-1,q=[$e,Ae].indexOf(L)>=0?"y":"x";A[L]+=G[q]*F})}return A}function hf(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,r=t.rootBoundary,c=t.padding,p=t.flipVariations,d=t.allowedAutoPlacements,f=d===void 0?Js:d,u=xt(o),w=u?p?Hs:Hs.filter(function(k){return xt(k)===u}):Dt,g=w.filter(function(k){return f.indexOf(k)>=0});g.length===0&&(g=w);var $=g.reduce(function(k,b){return k[b]=At(n,{placement:b,boundary:i,rootBoundary:r,padding:c})[Be(b)],k},{});return Object.keys($).sort(function(k,b){return $[k]-$[b]})}function _f(n){if(Be(n)===us)return[];var e=ts(n);return[On(n),e,On(e)]}function gf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,r=i===void 0?!0:i,c=t.altAxis,p=c===void 0?!0:c,d=t.fallbackPlacements,f=t.padding,u=t.boundary,w=t.rootBoundary,g=t.altBoundary,$=t.flipVariations,k=$===void 0?!0:$,b=t.allowedAutoPlacements,m=e.options.placement,_=Be(m),v=_===m,x=d||(v||!k?[ts(m)]:_f(m)),E=[m].concat(x).reduce(function(Q,se){return Q.concat(Be(se)===us?hf(e,{placement:se,boundary:u,rootBoundary:w,padding:f,flipVariations:k,allowedAutoPlacements:b}):se)},[]),R=e.rects.reference,I=e.rects.popper,D=new Map,W=!0,T=E[0],A=0;A<E.length;A++){var U=E[A],G=Be(U),L=xt(U)===dt,F=[$e,Ae].indexOf(G)>=0,q=F?"width":"height",Z=At(e,{placement:U,boundary:u,rootBoundary:w,altBoundary:g,padding:f}),N=F?L?Me:ke:L?Ae:$e;R[q]>I[q]&&(N=ts(N));var S=ts(N),C=[];if(r&&C.push(Z[G]<=0),p&&C.push(Z[N]<=0,Z[S]<=0),C.every(function(Q){return Q})){T=U,W=!1;break}D.set(U,C)}if(W)for(var M=k?3:1,V=function(se){var X=E.find(function(B){var j=D.get(B);if(j)return j.slice(0,se).every(function(H){return H})});if(X)return T=X,"break"},K=M;K>0;K--){var J=V(K);if(J==="break")break}e.placement!==T&&(e.modifiersData[o]._skip=!0,e.placement=T,e.reset=!0)}}const Bo={name:"flip",enabled:!0,phase:"main",fn:gf,requiresIfExists:["offset"],data:{_skip:!1}};function Nn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Ln(n){return[$e,Me,Ae,ke].some(function(e){return n[e]>=0})}function bf(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,r=e.modifiersData.preventOverflow,c=At(e,{elementContext:"reference"}),p=At(e,{altBoundary:!0}),d=Nn(c,o),f=Nn(p,i,r),u=Ln(d),w=Ln(f);e.modifiersData[t]={referenceClippingOffsets:d,popperEscapeOffsets:f,isReferenceHidden:u,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":w})}const Ho={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:bf};function yf(n,e,t){var o=Be(n),i=[ke,$e].indexOf(o)>=0?-1:1,r=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,c=r[0],p=r[1];return c=c||0,p=(p||0)*i,[ke,Me].indexOf(o)>=0?{x:p,y:c}:{x:c,y:p}}function wf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,r=i===void 0?[0,0]:i,c=Js.reduce(function(u,w){return u[w]=yf(w,e.rects,r),u},{}),p=c[e.placement],d=p.x,f=p.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=c}const Vo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:wf};function $f(n){var e=n.state,t=n.name;e.modifiersData[t]=Fo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Uo={name:"popperOffsets",enabled:!0,phase:"read",fn:$f,data:{}};function kf(n){return n==="x"?"y":"x"}function Sf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,r=i===void 0?!0:i,c=t.altAxis,p=c===void 0?!1:c,d=t.boundary,f=t.rootBoundary,u=t.altBoundary,w=t.padding,g=t.tether,$=g===void 0?!0:g,k=t.tetherOffset,b=k===void 0?0:k,m=At(e,{boundary:d,rootBoundary:f,padding:w,altBoundary:u}),_=Be(e.placement),v=xt(e.placement),x=!v,E=Zs(_),R=kf(E),I=e.modifiersData.popperOffsets,D=e.rects.reference,W=e.rects.popper,T=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,A=typeof T=="number"?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),U=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,G={x:0,y:0};if(I){if(r){var L,F=E==="y"?$e:ke,q=E==="y"?Ae:Me,Z=E==="y"?"height":"width",N=I[E],S=N+m[F],C=N-m[q],M=$?-W[Z]/2:0,V=v===dt?D[Z]:W[Z],K=v===dt?-W[Z]:-D[Z],J=e.elements.arrow,Q=$&&J?Xs(J):{width:0,height:0},se=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:No(),X=se[F],B=se[q],j=Rt(0,D[Z],Q[Z]),H=x?D[Z]/2-M-j-X-A.mainAxis:V-j-X-A.mainAxis,ee=x?-D[Z]/2+M+j+B+A.mainAxis:K+j+B+A.mainAxis,oe=e.elements.arrow&&Ht(e.elements.arrow),he=oe?E==="y"?oe.clientTop||0:oe.clientLeft||0:0,at=(L=U?.[E])!=null?L:0,Fe=N+H-at-he,z=N+ee-at,le=Rt($?is(S,Fe):S,N,$?ct(C,z):C);I[E]=le,G[E]=le-N}if(p){var ue,Ce=E==="x"?$e:ke,Pe=E==="x"?Ae:Me,we=I[R],Kt=R==="y"?"height":"width",dn=we+m[Ce],mn=we-m[Pe],gs=[$e,ke].indexOf(_)!==-1,pn=(ue=U?.[R])!=null?ue:0,fn=gs?dn:we-D[Kt]-W[Kt]-pn+A.altAxis,vn=gs?we+D[Kt]+W[Kt]-pn-A.altAxis:mn,hn=$&&gs?ef(fn,we,vn):Rt($?fn:dn,we,$?vn:mn);I[R]=hn,G[R]=hn-we}e.modifiersData[o]=G}}const qo={name:"preventOverflow",enabled:!0,phase:"main",fn:Sf,requiresIfExists:["offset"]};function Ef(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Cf(n){return n===Oe(n)||!De(n)?en(n):Ef(n)}function Tf(n){var e=n.getBoundingClientRect(),t=Ct(e.width)/n.offsetWidth||1,o=Ct(e.height)/n.offsetHeight||1;return t!==1||o!==1}function xf(n,e,t){t===void 0&&(t=!1);var o=De(e),i=De(e)&&Tf(e),r=nt(e),c=Tt(n,i,t),p={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(o||!o&&!t)&&((Ve(e)!=="body"||sn(r))&&(p=Cf(e)),De(e)?(d=Tt(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):r&&(d.x=tn(r))),{x:c.left+p.scrollLeft-d.x,y:c.top+p.scrollTop-d.y,width:c.width,height:c.height}}function Af(n){var e=new Map,t=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function i(r){t.add(r.name);var c=[].concat(r.requires||[],r.requiresIfExists||[]);c.forEach(function(p){if(!t.has(p)){var d=e.get(p);d&&i(d)}}),o.push(r)}return n.forEach(function(r){t.has(r.name)||i(r)}),o}function Mf(n){var e=Af(n);return Ao.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Of(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Df(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var In={placement:"bottom",modifiers:[],strategy:"absolute"};function jn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function zo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,r=i===void 0?In:i;return function(p,d,f){f===void 0&&(f=r);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},In,r),modifiersData:{},elements:{reference:p,popper:d},attributes:{},styles:{}},w=[],g=!1,$={state:u,setOptions:function(_){var v=typeof _=="function"?_(u.options):_;b(),u.options=Object.assign({},r,u.options,v),u.scrollParents={reference:mt(p)?Wt(p):p.contextElement?Wt(p.contextElement):[],popper:Wt(d)};var x=Mf(Df([].concat(o,u.options.modifiers)));return u.orderedModifiers=x.filter(function(E){return E.enabled}),k(),$.update()},forceUpdate:function(){if(!g){var _=u.elements,v=_.reference,x=_.popper;if(jn(v,x)){u.rects={reference:xf(v,Ht(x),u.options.strategy==="fixed"),popper:Xs(x)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(A){return u.modifiersData[A.name]=Object.assign({},A.data)});for(var E=0;E<u.orderedModifiers.length;E++){if(u.reset===!0){u.reset=!1,E=-1;continue}var R=u.orderedModifiers[E],I=R.fn,D=R.options,W=D===void 0?{}:D,T=R.name;typeof I=="function"&&(u=I({state:u,options:W,name:T,instance:$})||u)}}}},update:Of(function(){return new Promise(function(m){$.forceUpdate(),m(u)})}),destroy:function(){b(),g=!0}};if(!jn(p,d))return $;$.setOptions(f).then(function(m){!g&&f.onFirstUpdate&&f.onFirstUpdate(m)});function k(){u.orderedModifiers.forEach(function(m){var _=m.name,v=m.options,x=v===void 0?{}:v,E=m.effect;if(typeof E=="function"){var R=E({state:u,name:_,instance:$,options:x}),I=function(){};w.push(R||I)}})}function b(){w.forEach(function(m){return m()}),w=[]}return $}}var Nf=[Ro,Uo,Po,Mo,Vo,Bo,qo,jo,Ho],nn=zo({defaultModifiers:Nf});const Ko=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Eo,afterRead:$o,afterWrite:xo,applyStyles:Mo,arrow:jo,auto:us,basePlacements:Dt,beforeMain:ko,beforeRead:yo,beforeWrite:Co,bottom:Ae,clippingParents:go,computeStyles:Po,createPopper:nn,detectOverflow:At,end:Et,eventListeners:Ro,flip:Bo,hide:Ho,left:ke,main:So,modifierPhases:Ao,offset:Vo,placements:Js,popper:gt,popperGenerator:zo,popperOffsets:Uo,preventOverflow:qo,read:wo,reference:bo,right:Me,start:dt,top:$e,variationPlacements:Hs,viewport:Ys,write:To},Symbol.toStringTag,{value:"Module"}));const Ye=new Map,Cs={set(n,e,t){Ye.has(n)||Ye.set(n,new Map);const o=Ye.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Ye.has(n)&&Ye.get(n).get(e)||null},remove(n,e){if(!Ye.has(n))return;const t=Ye.get(n);t.delete(e),t.size===0&&Ye.delete(n)}},Lf=1e6,If=1e3,qs="transitionend",Go=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),jf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Pf=n=>{do n+=Math.floor(Math.random()*Lf);while(document.getElementById(n));return n},Rf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*If)},Yo=n=>{n.dispatchEvent(new Event(qs))},qe=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Xe=n=>qe(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Go(n)):null,Nt=n=>{if(!qe(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Ze=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Jo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Jo(n.parentNode):null},as=()=>{},Vt=n=>{n.offsetHeight},Qo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ts=[],Wf=n=>{document.readyState==="loading"?(Ts.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ts)e()}),Ts.push(n)):n()},Ne=()=>document.documentElement.dir==="rtl",je=n=>{Wf(()=>{const e=Qo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},Ee=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Xo=(n,e,t=!0)=>{if(!t){Ee(n);return}const i=Rf(e)+5;let r=!1;const c=({target:p})=>{p===e&&(r=!0,e.removeEventListener(qs,c),Ee(n))};e.addEventListener(qs,c),setTimeout(()=>{r||Yo(e)},i)},on=(n,e,t,o)=>{const i=n.length;let r=n.indexOf(e);return r===-1?!t&&o?n[i-1]:n[0]:(r+=t?1:-1,o&&(r=(r+i)%i),n[Math.max(0,Math.min(r,i-1))])},Ff=/[^.]*(?=\..*)\.|.*/,Bf=/\..*/,Hf=/::\d+$/,xs={};let Pn=1;const Zo={mouseenter:"mouseover",mouseleave:"mouseout"},Vf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ei(n,e){return e&&`${e}::${Pn++}`||n.uidEvent||Pn++}function ti(n){const e=ei(n);return n.uidEvent=e,xs[e]=xs[e]||{},xs[e]}function Uf(n,e){return function t(o){return an(o,{delegateTarget:n}),t.oneOff&&Y.off(n,o.type,e),e.apply(n,[o])}}function qf(n,e,t){return function o(i){const r=n.querySelectorAll(e);for(let{target:c}=i;c&&c!==this;c=c.parentNode)for(const p of r)if(p===c)return an(i,{delegateTarget:c}),o.oneOff&&Y.off(n,i.type,e,t),t.apply(c,[i])}}function si(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function ni(n,e,t){const o=typeof e=="string",i=o?t:e||t;let r=oi(n);return Vf.has(r)||(r=n),[o,i,r]}function Rn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[r,c,p]=ni(e,t,o);e in Zo&&(c=(k=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return k.call(this,b)})(c));const d=ti(n),f=d[p]||(d[p]={}),u=si(f,c,r?t:null);if(u){u.oneOff=u.oneOff&&i;return}const w=ei(c,e.replace(Ff,"")),g=r?qf(n,t,c):Uf(n,c);g.delegationSelector=r?t:null,g.callable=c,g.oneOff=i,g.uidEvent=w,f[w]=g,n.addEventListener(p,g,r)}function zs(n,e,t,o,i){const r=si(e[t],o,i);r&&(n.removeEventListener(t,r,!!i),delete e[t][r.uidEvent])}function zf(n,e,t,o){const i=e[t]||{};for(const[r,c]of Object.entries(i))r.includes(o)&&zs(n,e,t,c.callable,c.delegationSelector)}function oi(n){return n=n.replace(Bf,""),Zo[n]||n}const Y={on(n,e,t,o){Rn(n,e,t,o,!1)},one(n,e,t,o){Rn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,r,c]=ni(e,t,o),p=c!==e,d=ti(n),f=d[c]||{},u=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(f).length)return;zs(n,d,c,r,i?t:null);return}if(u)for(const w of Object.keys(d))zf(n,d,w,e.slice(1));for(const[w,g]of Object.entries(f)){const $=w.replace(Hf,"");(!p||e.includes($))&&zs(n,d,c,g.callable,g.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Qo(),i=oi(e),r=e!==i;let c=null,p=!0,d=!0,f=!1;r&&o&&(c=o.Event(e,t),o(n).trigger(c),p=!c.isPropagationStopped(),d=!c.isImmediatePropagationStopped(),f=c.isDefaultPrevented());const u=an(new Event(e,{bubbles:p,cancelable:!0}),t);return f&&u.preventDefault(),d&&n.dispatchEvent(u),u.defaultPrevented&&c&&c.preventDefault(),u}};function an(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function Wn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function As(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const ze={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${As(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${As(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Wn(n.dataset[o])}return e},getDataAttribute(n,e){return Wn(n.getAttribute(`data-bs-${As(e)}`))}};class Ut{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=qe(t)?ze.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...qe(t)?ze.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const r=e[o],c=qe(r)?"element":jf(r);if(!new RegExp(i).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${i}".`)}}}const Kf="5.3.8";class We extends Ut{constructor(e,t){super(),e=Xe(e),e&&(this._element=e,this._config=this._getConfig(t),Cs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Cs.remove(this._element,this.constructor.DATA_KEY),Y.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Xo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Cs.get(Xe(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Kf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ms=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Go(t)).join(","):null},ae={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Ze(t)&&Nt(t))},getSelectorFromElement(n){const e=Ms(n);return e&&ae.findOne(e)?e:null},getElementFromSelector(n){const e=Ms(n);return e?ae.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ms(n);return e?ae.find(e):[]}},ms=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Y.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Ze(this))return;const r=ae.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},Gf="alert",Yf="bs.alert",ii=`.${Yf}`,Jf=`close${ii}`,Qf=`closed${ii}`,Xf="fade",Zf="show";class ps extends We{static get NAME(){return Gf}close(){if(Y.trigger(this._element,Jf).defaultPrevented)return;this._element.classList.remove(Zf);const t=this._element.classList.contains(Xf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),Y.trigger(this._element,Qf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(ps,"close");je(ps);const ev="button",tv="bs.button",sv=`.${tv}`,nv=".data-api",ov="active",Fn='[data-bs-toggle="button"]',iv=`click${sv}${nv}`;class fs extends We{static get NAME(){return ev}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(ov))}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}Y.on(document,iv,Fn,n=>{n.preventDefault();const e=n.target.closest(Fn);fs.getOrCreateInstance(e).toggle()});je(fs);const av="swipe",Lt=".bs.swipe",rv=`touchstart${Lt}`,lv=`touchmove${Lt}`,cv=`touchend${Lt}`,uv=`pointerdown${Lt}`,dv=`pointerup${Lt}`,mv="touch",pv="pen",fv="pointer-event",vv=40,hv={endCallback:null,leftCallback:null,rightCallback:null},_v={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class rs extends Ut{constructor(e,t){super(),this._element=e,!(!e||!rs.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return hv}static get DefaultType(){return _v}static get NAME(){return av}dispose(){Y.off(this._element,Lt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ee(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=vv)return;const t=e/this._deltaX;this._deltaX=0,t&&Ee(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Y.on(this._element,uv,e=>this._start(e)),Y.on(this._element,dv,e=>this._end(e)),this._element.classList.add(fv)):(Y.on(this._element,rv,e=>this._start(e)),Y.on(this._element,lv,e=>this._move(e)),Y.on(this._element,cv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===pv||e.pointerType===mv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const gv="carousel",bv="bs.carousel",ot=`.${bv}`,ai=".data-api",yv="ArrowLeft",wv="ArrowRight",$v=500,jt="next",ht="prev",bt="left",ss="right",kv=`slide${ot}`,Os=`slid${ot}`,Sv=`keydown${ot}`,Ev=`mouseenter${ot}`,Cv=`mouseleave${ot}`,Tv=`dragstart${ot}`,xv=`load${ot}${ai}`,Av=`click${ot}${ai}`,ri="carousel",Yt="active",Mv="slide",Ov="carousel-item-end",Dv="carousel-item-start",Nv="carousel-item-next",Lv="carousel-item-prev",li=".active",ci=".carousel-item",Iv=li+ci,jv=".carousel-item img",Pv=".carousel-indicators",Rv="[data-bs-slide], [data-bs-slide-to]",Wv='[data-bs-ride="carousel"]',Fv={[yv]:ss,[wv]:bt},Bv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Hv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class qt extends We{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ae.findOne(Pv,this._element),this._addEventListeners(),this._config.ride===ri&&this.cycle()}static get Default(){return Bv}static get DefaultType(){return Hv}static get NAME(){return gv}next(){this._slide(jt)}nextWhenVisible(){!document.hidden&&Nt(this._element)&&this.next()}prev(){this._slide(ht)}pause(){this._isSliding&&Yo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Y.one(this._element,Os,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){Y.one(this._element,Os,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?jt:ht;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Y.on(this._element,Sv,e=>this._keydown(e)),this._config.pause==="hover"&&(Y.on(this._element,Ev,()=>this.pause()),Y.on(this._element,Cv,()=>this._maybeEnableCycle())),this._config.touch&&rs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ae.find(jv,this._element))Y.on(o,Tv,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(bt)),rightCallback:()=>this._slide(this._directionToOrder(ss)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),$v+this._config.interval))}};this._swipeHelper=new rs(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Fv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=ae.findOne(li,this._indicatorsElement);t.classList.remove(Yt),t.removeAttribute("aria-current");const o=ae.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Yt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===jt,r=t||on(this._getItems(),o,i,this._config.wrap);if(r===o)return;const c=this._getItemIndex(r),p=$=>Y.trigger(this._element,$,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(p(kv).defaultPrevented||!o||!r)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=r;const u=i?Dv:Ov,w=i?Nv:Lv;r.classList.add(w),Vt(r),o.classList.add(u),r.classList.add(u);const g=()=>{r.classList.remove(u,w),r.classList.add(Yt),o.classList.remove(Yt,w,u),this._isSliding=!1,p(Os)};this._queueCallback(g,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(Mv)}_getActive(){return ae.findOne(Iv,this._element)}_getItems(){return ae.find(ci,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ne()?e===bt?ht:jt:e===bt?jt:ht}_orderToDirection(e){return Ne()?e===ht?bt:ss:e===ht?ss:bt}static jQueryInterface(e){return this.each(function(){const t=qt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(document,Av,Rv,function(n){const e=ae.getElementFromSelector(this);if(!e||!e.classList.contains(ri))return;n.preventDefault();const t=qt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(ze.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});Y.on(window,xv,()=>{const n=ae.find(Wv);for(const e of n)qt.getOrCreateInstance(e)});je(qt);const Vv="collapse",Uv="bs.collapse",zt=`.${Uv}`,qv=".data-api",zv=`show${zt}`,Kv=`shown${zt}`,Gv=`hide${zt}`,Yv=`hidden${zt}`,Jv=`click${zt}${qv}`,Ds="show",wt="collapse",Jt="collapsing",Qv="collapsed",Xv=`:scope .${wt} .${wt}`,Zv="collapse-horizontal",eh="width",th="height",sh=".collapse.show, .collapse.collapsing",Ks='[data-bs-toggle="collapse"]',nh={parent:null,toggle:!0},oh={parent:"(null|element)",toggle:"boolean"};class Mt extends We{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=ae.find(Ks);for(const i of o){const r=ae.getSelectorFromElement(i),c=ae.find(r).filter(p=>p===this._element);r!==null&&c.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return nh}static get DefaultType(){return oh}static get NAME(){return Vv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(sh).filter(p=>p!==this._element).map(p=>Mt.getOrCreateInstance(p,{toggle:!1}))),e.length&&e[0]._isTransitioning||Y.trigger(this._element,zv).defaultPrevented)return;for(const p of e)p.hide();const o=this._getDimension();this._element.classList.remove(wt),this._element.classList.add(Jt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Jt),this._element.classList.add(wt,Ds),this._element.style[o]="",Y.trigger(this._element,Kv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||Y.trigger(this._element,Gv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Vt(this._element),this._element.classList.add(Jt),this._element.classList.remove(wt,Ds);for(const i of this._triggerArray){const r=ae.getElementFromSelector(i);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Jt),this._element.classList.add(wt),Y.trigger(this._element,Yv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ds)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Xe(e.parent),e}_getDimension(){return this._element.classList.contains(Zv)?eh:th}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ks);for(const t of e){const o=ae.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=ae.find(Xv,this._config.parent);return ae.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(Qv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Mt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Y.on(document,Jv,Ks,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ae.getMultipleElementsFromSelector(this))Mt.getOrCreateInstance(e,{toggle:!1}).toggle()});je(Mt);const Bn="dropdown",ih="bs.dropdown",ft=`.${ih}`,rn=".data-api",ah="Escape",Hn="Tab",rh="ArrowUp",Vn="ArrowDown",lh=2,ch=`hide${ft}`,uh=`hidden${ft}`,dh=`show${ft}`,mh=`shown${ft}`,ui=`click${ft}${rn}`,di=`keydown${ft}${rn}`,ph=`keyup${ft}${rn}`,yt="show",fh="dropup",vh="dropend",hh="dropstart",_h="dropup-center",gh="dropdown-center",rt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',bh=`${rt}.${yt}`,ns=".dropdown-menu",yh=".navbar",wh=".navbar-nav",$h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",kh=Ne()?"top-end":"top-start",Sh=Ne()?"top-start":"top-end",Eh=Ne()?"bottom-end":"bottom-start",Ch=Ne()?"bottom-start":"bottom-end",Th=Ne()?"left-start":"right-start",xh=Ne()?"right-start":"left-start",Ah="top",Mh="bottom",Oh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Dh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class He extends We{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=ae.next(this._element,ns)[0]||ae.prev(this._element,ns)[0]||ae.findOne(ns,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Oh}static get DefaultType(){return Dh}static get NAME(){return Bn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ze(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Y.trigger(this._element,dh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(wh))for(const o of[].concat(...document.body.children))Y.on(o,"mouseover",as);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(yt),this._element.classList.add(yt),Y.trigger(this._element,mh,e)}}hide(){if(Ze(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Y.trigger(this._element,ch,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Y.off(o,"mouseover",as);this._popper&&this._popper.destroy(),this._menu.classList.remove(yt),this._element.classList.remove(yt),this._element.setAttribute("aria-expanded","false"),ze.removeDataAttribute(this._menu,"popper"),Y.trigger(this._element,uh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!qe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Bn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ko>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:qe(this._config.reference)?e=Xe(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=nn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(yt)}_getPlacement(){const e=this._parent;if(e.classList.contains(vh))return Th;if(e.classList.contains(hh))return xh;if(e.classList.contains(_h))return Ah;if(e.classList.contains(gh))return Mh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(fh)?t?Sh:kh:t?Ch:Eh}_detectNavbar(){return this._element.closest(yh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ze.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ee(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=ae.find($h,this._menu).filter(i=>Nt(i));o.length&&on(o,t,e===Vn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=He.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===lh||e.type==="keyup"&&e.key!==Hn)return;const t=ae.find(bh);for(const o of t){const i=He.getInstance(o);if(!i||i._config.autoClose===!1)continue;const r=e.composedPath(),c=r.includes(i._menu);if(r.includes(i._element)||i._config.autoClose==="inside"&&!c||i._config.autoClose==="outside"&&c||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Hn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const p={relatedTarget:i._element};e.type==="click"&&(p.clickEvent=e),i._completeHide(p)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===ah,i=[rh,Vn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const r=this.matches(rt)?this:ae.prev(this,rt)[0]||ae.next(this,rt)[0]||ae.findOne(rt,e.delegateTarget.parentNode),c=He.getOrCreateInstance(r);if(i){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),r.focus())}}Y.on(document,di,rt,He.dataApiKeydownHandler);Y.on(document,di,ns,He.dataApiKeydownHandler);Y.on(document,ui,He.clearMenus);Y.on(document,ph,He.clearMenus);Y.on(document,ui,rt,function(n){n.preventDefault(),He.getOrCreateInstance(this).toggle()});je(He);const mi="backdrop",Nh="fade",Un="show",qn=`mousedown.bs.${mi}`,Lh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Ih={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class pi extends Ut{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Lh}static get DefaultType(){return Ih}static get NAME(){return mi}show(e){if(!this._config.isVisible){Ee(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Vt(t),t.classList.add(Un),this._emulateAnimation(()=>{Ee(e)})}hide(e){if(!this._config.isVisible){Ee(e);return}this._getElement().classList.remove(Un),this._emulateAnimation(()=>{this.dispose(),Ee(e)})}dispose(){this._isAppended&&(Y.off(this._element,qn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Nh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Xe(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Y.on(e,qn,()=>{Ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Xo(e,this._getElement(),this._config.isAnimated)}}const jh="focustrap",Ph="bs.focustrap",ls=`.${Ph}`,Rh=`focusin${ls}`,Wh=`keydown.tab${ls}`,Fh="Tab",Bh="forward",zn="backward",Hh={autofocus:!0,trapElement:null},Vh={autofocus:"boolean",trapElement:"element"};class fi extends Ut{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Hh}static get DefaultType(){return Vh}static get NAME(){return jh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Y.off(document,ls),Y.on(document,Rh,e=>this._handleFocusin(e)),Y.on(document,Wh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Y.off(document,ls))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=ae.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===zn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Fh&&(this._lastTabNavDirection=e.shiftKey?zn:Bh)}}const Kn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Gn=".sticky-top",Qt="padding-right",Yn="margin-right";class Gs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Qt,t=>t+e),this._setElementAttributes(Kn,Qt,t=>t+e),this._setElementAttributes(Gn,Yn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Qt),this._resetElementAttributes(Kn,Qt),this._resetElementAttributes(Gn,Yn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),r=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+i)return;this._saveInitialAttribute(c,t);const p=window.getComputedStyle(c).getPropertyValue(t);c.style.setProperty(t,`${o(Number.parseFloat(p))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&ze.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const r=ze.getDataAttribute(i,t);if(r===null){i.style.removeProperty(t);return}ze.removeDataAttribute(i,t),i.style.setProperty(t,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(qe(e)){t(e);return}for(const o of ae.find(e,this._element))t(o)}}const Uh="modal",qh="bs.modal",Le=`.${qh}`,zh=".data-api",Kh="Escape",Gh=`hide${Le}`,Yh=`hidePrevented${Le}`,vi=`hidden${Le}`,hi=`show${Le}`,Jh=`shown${Le}`,Qh=`resize${Le}`,Xh=`click.dismiss${Le}`,Zh=`mousedown.dismiss${Le}`,e_=`keydown.dismiss${Le}`,t_=`click${Le}${zh}`,Jn="modal-open",s_="fade",Qn="show",Ns="modal-static",n_=".modal.show",o_=".modal-dialog",i_=".modal-body",a_='[data-bs-toggle="modal"]',r_={backdrop:!0,focus:!0,keyboard:!0},l_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class pt extends We{constructor(e,t){super(e,t),this._dialog=ae.findOne(o_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Gs,this._addEventListeners()}static get Default(){return r_}static get DefaultType(){return l_}static get NAME(){return Uh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Y.trigger(this._element,hi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Jn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Y.trigger(this._element,Gh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Qn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Y.off(window,Le),Y.off(this._dialog,Le),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new pi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=ae.findOne(i_,this._dialog);t&&(t.scrollTop=0),Vt(this._element),this._element.classList.add(Qn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Y.trigger(this._element,Jh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Y.on(this._element,e_,e=>{if(e.key===Kh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Y.on(window,Qh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Y.on(this._element,Zh,e=>{Y.one(this._element,Xh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Jn),this._resetAdjustments(),this._scrollBar.reset(),Y.trigger(this._element,vi)})}_isAnimated(){return this._element.classList.contains(s_)}_triggerBackdropTransition(){if(Y.trigger(this._element,Yh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ns)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ns),this._queueCallback(()=>{this._element.classList.remove(Ns),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Ne()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Ne()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=pt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}Y.on(document,t_,a_,function(n){const e=ae.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Y.one(e,hi,i=>{i.defaultPrevented||Y.one(e,vi,()=>{Nt(this)&&this.focus()})});const t=ae.findOne(n_);t&&pt.getInstance(t).hide(),pt.getOrCreateInstance(e).toggle(this)});ms(pt);je(pt);const c_="offcanvas",u_="bs.offcanvas",Ge=`.${u_}`,_i=".data-api",d_=`load${Ge}${_i}`,m_="Escape",Xn="show",Zn="showing",eo="hiding",p_="offcanvas-backdrop",gi=".offcanvas.show",f_=`show${Ge}`,v_=`shown${Ge}`,h_=`hide${Ge}`,to=`hidePrevented${Ge}`,bi=`hidden${Ge}`,__=`resize${Ge}`,g_=`click${Ge}${_i}`,b_=`keydown.dismiss${Ge}`,y_='[data-bs-toggle="offcanvas"]',w_={backdrop:!0,keyboard:!0,scroll:!1},$_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class et extends We{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return w_}static get DefaultType(){return $_}static get NAME(){return c_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Y.trigger(this._element,f_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Gs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Xn),this._element.classList.remove(Zn),Y.trigger(this._element,v_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Y.trigger(this._element,h_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(eo),this._backdrop.hide();const t=()=>{this._element.classList.remove(Xn,eo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Gs().reset(),Y.trigger(this._element,bi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Y.trigger(this._element,to);return}this.hide()},t=!!this._config.backdrop;return new pi({className:p_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_addEventListeners(){Y.on(this._element,b_,e=>{if(e.key===m_){if(this._config.keyboard){this.hide();return}Y.trigger(this._element,to)}})}static jQueryInterface(e){return this.each(function(){const t=et.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}Y.on(document,g_,y_,function(n){const e=ae.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Ze(this))return;Y.one(e,bi,()=>{Nt(this)&&this.focus()});const t=ae.findOne(gi);t&&t!==e&&et.getInstance(t).hide(),et.getOrCreateInstance(e).toggle(this)});Y.on(window,d_,()=>{for(const n of ae.find(gi))et.getOrCreateInstance(n).show()});Y.on(window,__,()=>{for(const n of ae.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&et.getOrCreateInstance(n).hide()});ms(et);je(et);const k_=/^aria-[\w-]*$/i,yi={"*":["class","dir","id","lang","role",k_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},S_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),E_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,C_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?S_.has(t)?!!E_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function T_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const c of r){const p=c.nodeName.toLowerCase();if(!Object.keys(e).includes(p)){c.remove();continue}const d=[].concat(...c.attributes),f=[].concat(e["*"]||[],e[p]||[]);for(const u of d)C_(u,f)||c.removeAttribute(u.nodeName)}return i.body.innerHTML}const x_="TemplateFactory",A_={allowList:yi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},M_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},O_={entry:"(string|element|function|null)",selector:"(string|element)"};class D_ extends Ut{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return A_}static get DefaultType(){return M_}static get NAME(){return x_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,r]of Object.entries(this._config.content))this._setContent(e,r,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},O_)}_setContent(e,t,o){const i=ae.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(qe(t)){this._putElementInTemplate(Xe(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?T_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ee(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const N_="tooltip",L_=new Set(["sanitize","allowList","sanitizeFn"]),Ls="fade",I_="modal",Xt="show",j_=".tooltip-inner",so=`.${I_}`,no="hide.bs.modal",Pt="hover",Is="focus",js="click",P_="manual",R_="hide",W_="hidden",F_="show",B_="shown",H_="inserted",V_="click",U_="focusin",q_="focusout",z_="mouseenter",K_="mouseleave",G_={AUTO:"auto",TOP:"top",RIGHT:Ne()?"left":"right",BOTTOM:"bottom",LEFT:Ne()?"right":"left"},Y_={allowList:yi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},J_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class It extends We{constructor(e,t){if(typeof Ko>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Y_}static get DefaultType(){return J_}static get NAME(){return N_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Y.off(this._element.closest(so),no,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Y.trigger(this._element,this.constructor.eventName(F_)),o=(Jo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(i),Y.trigger(this._element,this.constructor.eventName(H_))),this._popper=this._createPopper(i),i.classList.add(Xt),"ontouchstart"in document.documentElement)for(const p of[].concat(...document.body.children))Y.on(p,"mouseover",as);const c=()=>{Y.trigger(this._element,this.constructor.eventName(B_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Y.trigger(this._element,this.constructor.eventName(R_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Xt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Y.off(i,"mouseover",as);this._activeTrigger[js]=!1,this._activeTrigger[Is]=!1,this._activeTrigger[Pt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Y.trigger(this._element,this.constructor.eventName(W_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ls,Xt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Pf(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ls),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new D_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[j_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ls)}_isShown(){return this.tip&&this.tip.classList.contains(Xt)}_createPopper(e){const t=Ee(this._config.placement,[this,e,this._element]),o=G_[t.toUpperCase()];return nn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Ee(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Ee(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")Y.on(this._element,this.constructor.eventName(V_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[js]=!(i._isShown()&&i._activeTrigger[js]),i.toggle()});else if(t!==P_){const o=t===Pt?this.constructor.eventName(z_):this.constructor.eventName(U_),i=t===Pt?this.constructor.eventName(K_):this.constructor.eventName(q_);Y.on(this._element,o,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusin"?Is:Pt]=!0,c._enter()}),Y.on(this._element,i,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusout"?Is:Pt]=c._element.contains(r.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Y.on(this._element.closest(so),no,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=ze.getDataAttributes(this._element);for(const o of Object.keys(t))L_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Xe(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=It.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}je(It);const Q_="popover",X_=".popover-header",Z_=".popover-body",eg={...It.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},tg={...It.DefaultType,content:"(null|string|element|function)"};class ln extends It{static get Default(){return eg}static get DefaultType(){return tg}static get NAME(){return Q_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[X_]:this._getTitle(),[Z_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=ln.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}je(ln);const sg="scrollspy",ng="bs.scrollspy",cn=`.${ng}`,og=".data-api",ig=`activate${cn}`,oo=`click${cn}`,ag=`load${cn}${og}`,rg="dropdown-item",_t="active",lg='[data-bs-spy="scroll"]',Ps="[href]",cg=".nav, .list-group",io=".nav-link",ug=".nav-item",dg=".list-group-item",mg=`${io}, ${ug} > ${io}, ${dg}`,pg=".dropdown",fg=".dropdown-toggle",vg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},hg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class vs extends We{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return vg}static get DefaultType(){return hg}static get NAME(){return sg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Xe(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Y.off(this._config.target,oo),Y.on(this._config.target,oo,Ps,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(t(c))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(c));continue}const p=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&p){if(o(c),!i)return;continue}!r&&!p&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ae.find(Ps,this._config.target);for(const t of e){if(!t.hash||Ze(t))continue;const o=ae.findOne(decodeURI(t.hash),this._element);Nt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(_t),this._activateParents(e),Y.trigger(this._element,ig,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(rg)){ae.findOne(fg,e.closest(pg)).classList.add(_t);return}for(const t of ae.parents(e,cg))for(const o of ae.prev(t,mg))o.classList.add(_t)}_clearActiveClass(e){e.classList.remove(_t);const t=ae.find(`${Ps}.${_t}`,e);for(const o of t)o.classList.remove(_t)}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(window,ag,()=>{for(const n of ae.find(lg))vs.getOrCreateInstance(n)});je(vs);const _g="tab",gg="bs.tab",vt=`.${gg}`,bg=`hide${vt}`,yg=`hidden${vt}`,wg=`show${vt}`,$g=`shown${vt}`,kg=`click${vt}`,Sg=`keydown${vt}`,Eg=`load${vt}`,Cg="ArrowLeft",ao="ArrowRight",Tg="ArrowUp",ro="ArrowDown",Rs="Home",lo="End",lt="active",co="fade",Ws="show",xg="dropdown",wi=".dropdown-toggle",Ag=".dropdown-menu",Fs=`:not(${wi})`,Mg='.list-group, .nav, [role="tablist"]',Og=".nav-item, .list-group-item",Dg=`.nav-link${Fs}, .list-group-item${Fs}, [role="tab"]${Fs}`,$i='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Bs=`${Dg}, ${$i}`,Ng=`.${lt}[data-bs-toggle="tab"], .${lt}[data-bs-toggle="pill"], .${lt}[data-bs-toggle="list"]`;class Ot extends We{constructor(e){super(e),this._parent=this._element.closest(Mg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Y.on(this._element,Sg,t=>this._keydown(t)))}static get NAME(){return _g}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?Y.trigger(t,bg,{relatedTarget:e}):null;Y.trigger(e,wg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(lt),this._activate(ae.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ws);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Y.trigger(e,$g,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_deactivate(e,t){if(!e)return;e.classList.remove(lt),e.blur(),this._deactivate(ae.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ws);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Y.trigger(e,yg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_keydown(e){if(![Cg,ao,Tg,ro,Rs,lo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Ze(i));let o;if([Rs,lo].includes(e.key))o=t[e.key===Rs?0:t.length-1];else{const i=[ao,ro].includes(e.key);o=on(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Ot.getOrCreateInstance(o).show())}_getChildren(){return ae.find(Bs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=ae.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(xg))return;const i=(r,c)=>{const p=ae.findOne(r,o);p&&p.classList.toggle(c,t)};i(wi,lt),i(Ag,Ws),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(lt)}_getInnerElement(e){return e.matches(Bs)?e:ae.findOne(Bs,e)}_getOuterElement(e){return e.closest(Og)||e}static jQueryInterface(e){return this.each(function(){const t=Ot.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(document,kg,$i,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Ze(this)&&Ot.getOrCreateInstance(this).show()});Y.on(window,Eg,()=>{for(const n of ae.find(Ng))Ot.getOrCreateInstance(n)});je(Ot);const Lg="toast",Ig="bs.toast",it=`.${Ig}`,jg=`mouseover${it}`,Pg=`mouseout${it}`,Rg=`focusin${it}`,Wg=`focusout${it}`,Fg=`hide${it}`,Bg=`hidden${it}`,Hg=`show${it}`,Vg=`shown${it}`,Ug="fade",uo="hide",Zt="show",es="showing",qg={animation:"boolean",autohide:"boolean",delay:"number"},zg={animation:!0,autohide:!0,delay:5e3};class hs extends We{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return zg}static get DefaultType(){return qg}static get NAME(){return Lg}show(){if(Y.trigger(this._element,Hg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Ug);const t=()=>{this._element.classList.remove(es),Y.trigger(this._element,Vg),this._maybeScheduleHide()};this._element.classList.remove(uo),Vt(this._element),this._element.classList.add(Zt,es),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||Y.trigger(this._element,Fg).defaultPrevented)return;const t=()=>{this._element.classList.add(uo),this._element.classList.remove(es,Zt),Y.trigger(this._element,Bg)};this._element.classList.add(es),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Zt),super.dispose()}isShown(){return this._element.classList.contains(Zt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Y.on(this._element,jg,e=>this._onInteraction(e,!0)),Y.on(this._element,Pg,e=>this._onInteraction(e,!1)),Y.on(this._element,Rg,e=>this._onInteraction(e,!0)),Y.on(this._element,Wg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=hs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(hs);je(hs);const Kg={class:"message-content-column"},Gg=["id"],Yg={class:"accordion-item"},Jg=["id"],Qg=["aria-controls"],Xg={class:"d-flex align-items-center w-100"},Zg={class:"badge bg-warning text-dark ms-auto me-2"},eb={class:"text-muted"},tb=["id","aria-labelledby"],sb={class:"accordion-body bg-light"},nb={class:"alert alert-warning mb-3",role:"alert"},ob={class:"compaction-metadata"},ib={class:"metadata-row"},ab={class:"metadata-row"},rb={key:0,class:"metadata-row"},lb={class:"continuation-content"},cb={class:"continuation-text border rounded p-3 bg-white"},ub={class:"mb-0"},db={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=h(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=h(()=>`heading-${t.value}`),i=h(()=>`collapse-${t.value}`),r=P(null);let c=null;ye(()=>{r.value&&(c=new Mt(r.value,{toggle:!1}))}),Si(()=>{c&&c.dispose()});function p(){c&&c.toggle()}const d=h(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=h(()=>d.value?e.messages[3]:e.messages[2]),u=h(()=>f.value?.metadata?.init_data?.compact_metadata||{}),w=h(()=>u.value.pre_tokens||0),g=h(()=>d.value?e.messages[4]:e.messages[3]),$=h(()=>g.value?.content||""),k=h(()=>{const m=e.messages[0]?.timestamp;return m?Bt(m):""});function b(m){return m?`${m.toLocaleString()} tokens`:"0 tokens"}return(m,_)=>(a(),l("div",{class:"message-row message-row-compaction",key:t.value},[_[7]||(_[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Kg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Yg,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:p},[s("div",Xg,[_[0]||(_[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),_[1]||(_[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",Zg,y(b(w.value)),1),s("small",eb,y(k.value),1)])],8,Qg)],8,Jg),s("div",{ref_key:"collapseElement",ref:r,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",sb,[s("div",nb,[_[5]||(_[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ie(" Compaction Details ")],-1)),s("div",ob,[s("div",ib,[_[2]||(_[2]=s("strong",null,"Trigger:",-1)),s("span",null,y(u.value.trigger||"auto"),1)]),s("div",ab,[_[3]||(_[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,y(b(w.value)),1)]),u.value.post_tokens?(a(),l("div",rb,[_[4]||(_[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,y(b(u.value.post_tokens)),1)])):O("",!0)])]),s("div",lb,[_[6]||(_[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ie(" Continuation Message ")],-1)),s("div",cb,[s("pre",ub,y($.value),1)])])])],8,tb)])],8,Gg)])]))}},mb=ne(db,[["__scopeId","data-v-e0b95ba8"]]),pb={key:0,class:"text-muted text-center py-5"},fb={__name:"MessageList",setup(n){const e=xe(),t=_e(),o=P(null),i=h(()=>{const u=e.currentMessages,w=[];let g=0;for(;g<u.length;){const $=u[g];if(c($,u,g)){const k=u[g+2],m=k?.type==="system"&&k?.metadata?.subtype==="init"?5:4,_=u.slice(g,g+m);w.push({type:"compaction",messages:_}),g+=m;continue}d($)&&w.push({type:"message",message:$,attachedTools:[]}),g++}return r(w)});function r(u){const w=new Map,g=new Set;for(let k=0;k<u.length;k++){const b=u[k];if(b.type==="compaction")continue;const m=b.message,_=m.content&&m.content.trim().length>0&&m.content!=="Assistant response",v=m.type==="assistant"&&m.metadata?.has_tool_uses&&m.metadata?.tool_uses?.length>0;if(m.type==="assistant"&&v&&!_){let x=-1,E=!1;for(let R=k-1;R>=0;R--){const I=u[R];if(!g.has(R)){if(I.type==="message"&&I.message.type!=="assistant"){E=!0;break}if(I.type==="message"&&I.message.type==="assistant"){const D=I.message;if(D.content&&D.content.trim().length>0&&D.content!=="Assistant response"){x=R;break}else{x=R;break}}}}E&&x===-1||(E&&x>=0?(w.has(x)||w.set(x,[]),w.get(x).push(...m.metadata.tool_uses),g.add(k)):!E&&x>=0&&(w.has(x)||w.set(x,[]),w.get(x).push(...m.metadata.tool_uses),g.add(k)))}}const $=[];for(let k=0;k<u.length;k++){if(g.has(k))continue;const b=u[k];w.has(k)&&(b.attachedTools=[...b.attachedTools||[],...w.get(k)]),$.push(b)}return $}function c(u,w,g){if(g+3>=w.length)return!1;const $=w[g],k=w[g+1];let b=w[g+2],m=w[g+3],_=w[g+4];const v=$.type==="system"&&$.metadata?.subtype==="status"&&$.metadata?.init_data?.status==="compacting",x=k.type==="system"&&k.metadata?.subtype==="status"&&(k.metadata?.init_data?.status===null||k.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(g+4>=w.length)return!1;const R=!0,I=m?.type==="system"&&m?.metadata?.subtype==="compact_boundary",D=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",x),console.log("  Msg3 (init):",R),console.log("  Msg4 (boundary):",I),console.log("  Msg5 (continuation):",D)),v&&x&&R&&I&&D}else{const R=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",I=m?.type==="user"&&m?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",x),console.log("  Msg3 (boundary):",R),console.log("  Msg4 (continuation):",I)),v&&x&&R&&I}}async function p(){t.autoScrollEnabled&&(await kt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>i.value.length,p),fe(()=>e.currentToolCalls.length,p),fe(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),p),ye(()=>{setTimeout(()=>{p()},100)});function d(u){const w=u.subtype||u.metadata?.subtype;if(u.type==="system"&&w==="init"||u.type==="system"&&w==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const g=u.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const g=u.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function f(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,w)=>(a(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),l("div",pb," No messages yet. Start a conversation! ")):O("",!0),(a(!0),l(re,null,ce(i.value,(g,$)=>(a(),l(re,{key:`item-${$}`},[g.type==="message"?(a(),be(Yp,{key:0,message:f(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(a(),be(mb,{key:1,messages:g.messages},null,8,["messages"])):O("",!0)],64))),128))],512))}},vb=ne(fb,[["__scopeId","data-v-bb936559"]]),hb={key:0,class:"attachment-list"},_b={key:0,class:"attachment-preview"},gb=["src","alt"],bb={key:1,class:"attachment-icon"},yb={class:"file-type-icon"},wb={class:"attachment-info"},$b=["title"],kb={class:"attachment-size"},Sb=["onClick"],Eb={key:2,class:"upload-progress"},Cb=["title"],Tb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const t=e;function o(d){if(d.type&&d.type.startsWith("image/"))return!0;const f=d.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function i(d){const f=d.name?.split(".").pop()?.toLowerCase()||"",u=d.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function r(d){return d?d<1024?d+" B":d<1024*1024?(d/1024).toFixed(1)+" KB":(d/(1024*1024)).toFixed(1)+" MB":""}function c(d,f=20){if(!d||d.length<=f)return d;const u=d.split(".").pop(),w=d.substring(0,d.length-u.length-1);return w.length<=f-u.length-4?d:w.substring(0,f-u.length-4)+"..."+u}function p(d){t("remove",d)}return(d,f)=>n.attachments.length>0?(a(),l("div",hb,[(a(!0),l(re,null,ce(n.attachments,(u,w)=>(a(),l("div",{key:u.id||w,class:"attachment-item"},[o(u)?(a(),l("div",_b,[s("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,gb)])):(a(),l("div",bb,[s("span",yb,y(i(u)),1)])),s("div",wb,[s("span",{class:"attachment-name",title:u.name},y(c(u.name)),9,$b),s("span",kb,y(r(u.size)),1)]),s("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>p(w)}," âœ• ",8,Sb),u.uploading?(a(),l("div",Eb,[s("div",{class:"progress-bar",style:Je({width:(u.progress||0)+"%"})},null,4)])):O("",!0),u.error?(a(),l("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+y(u.error),9,Cb)):O("",!0)]))),128))])):O("",!0)}},xb=ne(Tb,[["__scopeId","data-v-0fcc4974"]]),Ab={class:"border-top bg-light"},Mb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Ob=["disabled"],Db=["placeholder","disabled"],Nb=["disabled"],mo=5*1024*1024,Lb={__name:"InputArea",setup(n){const e=de(),t=st(),o=Qe(),i=fo("pendingResourceAttachment",P(null)),r=P(null),c=P(null),p=P(window.innerWidth),d=P([]),f=P(!1),u=P(!1),w=h({get:()=>e.currentInput,set:S=>{e.currentInput=S}}),g=h(()=>e.currentSession?.is_processing||!1),$=h(()=>t.sessionConnected),k=h(()=>e.currentSession?.state==="starting"),b=h(()=>e.currentSessionId),m=h(()=>p.value<768),_=h(()=>k.value?"Session is starting...":$.value?"Type your message to Claude Code...":"Waiting for connection...");function v(){p.value=window.innerWidth}ye(()=>{window.addEventListener("resize",v)}),Se(()=>{window.removeEventListener("resize",v)}),fe(i,S=>{S&&(Z(S),i.value=null)});function x(S){if(S.key==="Enter"&&!S.shiftKey){if(m.value)return;S.preventDefault(),F()}}function E(){const S=r.value;if(!S)return;S.style.height="auto";const C=Math.min(S.scrollHeight,parseInt(getComputedStyle(S).maxHeight));S.style.height=C+"px"}function R(){c.value?.click()}function I(S){const C=Array.from(S.target.files||[]);T(C),S.target.value=""}function D(S){f.value=!1;const C=Array.from(S.dataTransfer?.files||[]);T(C)}function W(S){const C=S.clipboardData?.items;if(!C)return;const M=[];for(const V of C)if(V.type.startsWith("image/")){const K=V.getAsFile();if(K){const J=V.type.split("/")[1]||"png",Q=`clipboard-${Date.now()}.${J}`,se=new File([K],Q,{type:K.type});M.push(se)}}M.length>0&&(S.preventDefault(),T(M))}function T(S){for(const C of S){if(C.size>mo){d.value.push({id:U(),name:C.name,size:C.size,type:C.type,file:C,error:`File too large (max ${mo/(1024*1024)}MB)`});continue}let M=null;C.type.startsWith("image/")&&(M=URL.createObjectURL(C)),d.value.push({id:U(),name:C.name,size:C.size,type:C.type,file:C,preview:M,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function A(S){const C=d.value[S];C.preview&&URL.revokeObjectURL(C.preview),d.value.splice(S,1)}function U(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function G(S){const C=b.value;if(!C)return null;S.uploading=!0,S.progress=0,S.error=null;try{const M=new FormData;M.append("file",S.file);const V=await fetch(`/api/sessions/${C}/files`,{method:"POST",body:M});if(!V.ok){const J=await V.json().catch(()=>({}));throw new Error(J.detail||`Upload failed: ${V.status}`)}const K=await V.json();return S.uploaded=!0,S.uploadedInfo=K.file,S.progress=100,K.file}catch(M){return S.error=M.message,null}finally{S.uploading=!1}}async function L(){const S=d.value.filter(C=>!C.uploaded&&!C.error);if(S.length===0)return!0;u.value=!0;try{return(await Promise.all(S.map(G))).every(M=>M!==null)}finally{u.value=!1}}async function F(){const S=w.value.trim(),C=d.value.filter(K=>!K.error).length>0;if(!S&&!C||C&&!await L())return;let M=w.value;const V=d.value.filter(K=>K.uploaded&&K.uploadedInfo).map(K=>K.uploadedInfo);if(V.length>0){const K=V.map(J=>{const Q=(J.size_bytes/1024).toFixed(1);return`- ${J.original_name} (${Q} KB): ${J.stored_path}`}).join(`
`);M.trim()?M=`${M}

---
Attached files (use Read tool to access):
${K}`:M=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${K}`}t.sendMessage(M),w.value="",q(),r.value&&(r.value.style.height="auto")}function q(){for(const S of d.value)S.preview&&URL.revokeObjectURL(S.preview);d.value=[]}function Z(S){if(!S||!S.resource_id){console.warn("Invalid resource for attachment:",S);return}const C=b.value;if(!C){console.warn("No current session for resource attachment");return}if(d.value.findIndex(J=>J.resourceId===S.resource_id)>=0){console.log("Resource already attached:",S.resource_id);return}const V=o.isImageResource(S);let K=null;V&&(K=o.getResourceUrl(C,S.resource_id)),d.value.push({id:U(),resourceId:S.resource_id,name:S.original_filename||S.title||"Resource",size:S.size_bytes||0,type:S.format||"application/octet-stream",file:null,preview:K,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:S.resource_id,original_name:S.original_filename||S.title,stored_path:S.file_path||`/api/sessions/${C}/resources/${S.resource_id}`,size_bytes:S.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",S.resource_id)}function N(){t.interruptSession()}return(S,C)=>(a(),l("div",Ab,[$.value?O("",!0):(a(),l("div",Mb,[...C[5]||(C[5]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),pe(xb,{attachments:d.value,onRemove:A},null,8,["attachments"]),f.value?(a(),l("div",{key:1,class:"drop-zone-overlay",onDragover:C[0]||(C[0]=ve(()=>{},["prevent"])),onDragleave:C[1]||(C[1]=M=>f.value=!1),onDrop:ve(D,["prevent"])},[...C[6]||(C[6]=[s("div",{class:"drop-zone-content"},[s("span",{class:"drop-icon"},"ðŸ“Ž"),s("span",null,"Drop files here")],-1)])],32)):O("",!0),s("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:C[3]||(C[3]=ve(M=>f.value=!0,["prevent"])),onDragenter:C[4]||(C[4]=ve(M=>f.value=!0,["prevent"]))},[s("input",{ref_key:"fileInput",ref:c,type:"file",multiple:"",class:"d-none",onChange:I},null,544),s("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:k.value||!$.value,onClick:R}," ðŸ“Ž ",8,Ob),ge(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:r,"onUpdate:modelValue":C[2]||(C[2]=M=>w.value=M),class:"form-control",placeholder:_.value,disabled:k.value||!$.value,rows:"1",onInput:E,onKeydown:x,onPaste:W},null,40,Db),[[Re,w.value]]),g.value?(a(),l("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:N}," Stop ")):(a(),l("button",{key:1,class:"btn btn-primary",disabled:!w.value.trim()&&d.value.length===0||!$.value||k.value||u.value,onClick:F},y(u.value?"Uploading...":"Send"),9,Nb))],32)]))}},Ib=ne(Lb,[["__scopeId","data-v-c0dea258"]]),jb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Pb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Rb={class:"text-secondary"},Wb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Fb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_e(),i=h(()=>t.currentSession),r=h(()=>o.isLoading),c=h(()=>o.loadingMessage);return ye(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(p,d)=>{if(p!==d&&p!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(p)}finally{o.hideLoading()}}}),Se(()=>{}),(p,d)=>(a(),l("div",jb,[r.value?(a(),l("div",Pb,[d[0]||(d[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",Rb,y(c.value),1)])):O("",!0),i.value?(a(),be(Yi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):O("",!0),s("div",Wb,[pe(vb)]),pe(Ib),i.value?(a(),be(ea,{key:2,"session-id":e.sessionId},null,8,["session-id"])):O("",!0),i.value?(a(),be(ca,{key:3,"session-id":e.sessionId},null,8,["session-id"])):O("",!0)]))}},_s=tt("legion",()=>{const n=P(new Map),e=P(new Map),t=P(null),o=h(()=>n.value.get(t.value)||[]),i=h(()=>e.value.get(t.value)||[]);function r(k){t.value=k}async function c(k,b=100,m=0){try{const _=await me.get(`/api/legions/${k}/timeline?limit=${b}&offset=${m}`),v=_.comms||[],x=_.total_count||v.length,E=_.has_more||!1;return v.sort((R,I)=>new Date(R.timestamp)-new Date(I.timestamp)),console.log(`Loaded ${v.length} of ${x} comms for legion ${k}`),n.value.set(k,v),n.value=new Map(n.value),{comms:v,totalCount:x,hasMore:E}}catch(_){throw console.error("Failed to load timeline:",_),_}}function p(k,b){n.value.has(k)||n.value.set(k,[]);const m=n.value.get(k);if(m.some(v=>v.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}m.push(b),n.value=new Map(n.value)}async function d(k,b){try{const _=(await me.post(`/api/legions/${k}/comms`,b)).comm;return console.log(`Sent comm ${_.comm_id} to legion ${k}`),_}catch(m){throw console.error("Failed to send comm:",m),m}}async function f(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function u(k,b){try{const _=(await me.post(`/api/legions/${k}/minions`,b)).minion;return await f(k),console.log(`Created minion ${_.minion_id} in legion ${k}`),_}catch(m){throw console.error("Failed to create minion:",m),m}}async function w(k){try{const b=await me.post(`/api/legions/${k}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${k}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function g(k){try{const b=await me.post(`/api/legions/${k}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${k}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function $(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:r,loadTimeline:c,addComm:p,sendComm:d,loadMinions:f,createMinion:u,haltAll:w,resumeAll:g,clearLegionData:$}}),Bb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:_s},Symbol.toStringTag,{value:"Module"})),Hb={class:"timeline-header border-bottom p-3"},Vb={class:"project-name"},Ub=["title"],qb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Ie(),o=h(()=>t.projects.get(e.legionId)),i=h(()=>o.value?.name||"Legion");return(r,c)=>(a(),l("div",Hb,[s("div",null,[s("div",Vb,y(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Ub)])]))}},zb=ne(qb,[["__scopeId","data-v-44f386f5"]]),Kb={class:"timeline-status-bar border-top p-2 bg-light"},Gb={class:"d-flex justify-content-end"},Yb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=_e();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),l("div",Kb,[s("div",Gb,[s("button",{class:te(["btn btn-sm",os(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+y(os(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Jb=ne(Yb,[["__scopeId","data-v-891c73db"]]),Qb={class:"comm-composer border-top p-3"},Xb={key:0,class:"d-flex gap-2 mb-2"},Zb={class:"flex-grow-1"},ey=["disabled"],ty={label:"Minions"},sy=["value"],ny={style:{"min-width":"150px"}},oy=["disabled"],iy={class:"d-flex gap-2 align-items-end position-relative"},ay={class:"flex-grow-1 position-relative"},ry=["disabled"],ly=["onClick","onMouseenter"],cy=["disabled"],uy={key:0},dy={key:1},my={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=_s(),o=de(),i=Ie(),r=P(""),c=P("task"),p=P(""),d=P(!1),f=P(window.innerWidth),u=P(!1),w=P([]),g=P(0),$=P(-1),k=P(null),b=P(null),m=h(()=>f.value<768),_=h(()=>{const G=i.projects.get(e.legionId);return!G||!G.session_ids?[]:G.session_ids.map(L=>o.sessions.get(L)).filter(L=>L)}),v=h(()=>r.value&&p.value.trim().length>0);function x(G){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[G.state]||"â—‹"}function E(G){return G.role?`${G.name} (${G.role})`:G.name}function R(){const G=k.value;if(!G)return;G.style.height="auto";const L=Math.min(G.scrollHeight,parseInt(getComputedStyle(G).maxHeight));G.style.height=L+"px"}function I(){const G=k.value;if(!G)return;R();const L=p.value,F=G.selectionStart,q=L.substring(0,F),Z=q.lastIndexOf("#");if(Z===-1){u.value=!1;return}const N=q.substring(Z+1).toLowerCase();if(N.includes(" ")){u.value=!1;return}const S=_.value.filter(C=>C.name.toLowerCase().includes(N)).map(C=>({type:"minion",name:C.name,role:C.role,id:C.session_id,state:C.state}));if(S.length===0){u.value=!1;return}w.value=S,g.value=0,$.value=Z,u.value=!0}function D(){if(!b.value)return;const G=b.value,L=G.children[g.value];if(!L)return;const F=L.offsetTop,q=L.offsetHeight,Z=G.scrollTop,N=G.clientHeight;F<Z?G.scrollTop=F:F+q>Z+N&&(G.scrollTop=F+q-N)}function W(G){if(!u.value){if(G.key==="Enter"&&!G.shiftKey){if(m.value)return;v.value&&(G.preventDefault(),A())}return}if(G.key==="ArrowDown")G.preventDefault(),g.value=(g.value+1)%w.value.length,D();else if(G.key==="ArrowUp")G.preventDefault(),g.value=g.value===0?w.value.length-1:g.value-1,D();else if(G.key==="Enter"){G.preventDefault();const L=w.value[g.value];L&&T(L)}else G.key==="Escape"&&(u.value=!1)}function T(G){const L=k.value;if(!L)return;const F=p.value,q=L.selectionStart,Z=F.substring(0,$.value)+"#"+G.name+" "+F.substring(q);p.value=Z;const N=$.value+G.name.length+2;setTimeout(()=>{L.setSelectionRange(N,N),L.focus()},0),u.value=!1}async function A(){if(!(!v.value||d.value)){d.value=!0;try{const[G,L]=r.value.split(":"),F={comm_type:c.value,content:p.value.trim()};G==="minion"&&(F.to_minion_id=L),await t.sendComm(e.legionId,F),p.value="",R()}catch(G){console.error("Failed to send comm:",G),alert(`Failed to send comm: ${G.message}`)}finally{d.value=!1}}}function U(){f.value=window.innerWidth}return ye(()=>{window.addEventListener("resize",U)}),Se(()=>{window.removeEventListener("resize",U)}),fe(u,G=>{if(G){const L=F=>{F.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",L))};setTimeout(()=>document.addEventListener("click",L),0)}}),(G,L)=>(a(),l("div",Qb,[n.hideRecipientSelector?O("",!0):(a(),l("div",Xb,[s("div",Zb,[ge(s("select",{"onUpdate:modelValue":L[0]||(L[0]=F=>r.value=F),class:"form-select form-select-sm",disabled:d.value},[L[3]||(L[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",ty,[(a(!0),l(re,null,ce(_.value,F=>(a(),l("option",{key:F.session_id,value:`minion:${F.session_id}`},y(x(F))+" "+y(E(F)),9,sy))),128))])],8,ey),[[_n,r.value]])]),s("div",ny,[ge(s("select",{"onUpdate:modelValue":L[1]||(L[1]=F=>c.value=F),class:"form-select form-select-sm",disabled:d.value},[...L[4]||(L[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,oy),[[_n,c.value]])])])),s("div",iy,[s("div",ay,[ge(s("textarea",{ref_key:"contentTextarea",ref:k,"onUpdate:modelValue":L[2]||(L[2]=F=>p.value=F),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:d.value,onInput:I,onKeydown:W},null,40,ry),[[Re,p.value]]),u.value?(a(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),l(re,null,ce(w.value,(F,q)=>(a(),l("div",{key:F.id,class:te(["autocomplete-item px-2 py-1",{"bg-light":q===g.value}]),onClick:Z=>T(F),onMouseenter:Z=>g.value=q},y(F.type==="minion"?x(F):"#ï¸âƒ£")+" "+y(F.name)+y(F.role?` (${F.role})`:""),43,ly))),128))],512)):O("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!v.value||d.value,onClick:A},[d.value?(a(),l("span",uy,[...L[5]||(L[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ie(" Sending... ",-1)])])):(a(),l("span",dy,"Send"))],8,cy)])])]))}},py=ne(my,[["__scopeId","data-v-e52b8e8f"]]),fy={class:"message-content-column-full"},vy=["aria-expanded"],hy={class:"comm-sender-recipient"},_y={class:"comm-badge-summary"},gy=["title"],by={class:"comm-summary-text text-muted ms-2"},yy=["aria-label"],wy={key:0,class:"comm-content-body"},$y=["innerHTML"],ky="ffffffff-ffff-ffff-ffff-ffffffffffff",Sy={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;ut.setOptions({breaks:!0,gfm:!0});const t=P(!1);function o(){t.value=!t.value}const i=h(()=>e.comm.from_minion_id===ky),r=h(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),c=h(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),p=h(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),d=h(()=>{const f=e.comm.content||"";let u=ut.parse(f);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),cs.sanitize(u)});return(f,u)=>(a(),l("div",{class:te(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",fy,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",hy,[s("strong",{class:te({"system-sender":i.value})},y(n.senderName),3),n.recipientName?(a(),l(re,{key:0},[u[0]||(u[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,y(n.recipientName),1)],64)):O("",!0)]),s("div",_y,[s("span",{class:te(["badge",c.value]),title:r.value},y(n.comm.comm_type),11,gy),s("span",by,y(p.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,yy)],8,vy),t.value?(a(),l("div",wy,[s("div",{class:"message-text",innerHTML:d.value},null,8,$y)])):O("",!0)])],2))}},Ey=ne(Sy,[["__scopeId","data-v-28513f64"]]),Cy={class:"timeline-view d-flex flex-column h-100"},Ty={key:0,class:"text-center text-muted"},xy={key:1,class:"text-center text-danger"},Ay={key:2,class:"text-center text-muted"},My={key:3,class:"comm-list"},Oy={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=_s();Ie();const o=de(),i=st(),r=_e(),c=P(!0),p=P(null),d=P(null),f=h(()=>t.currentComms);function u(m){return m.from_user?"You":m.from_minion_id?m.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(m.from_minion_id)?.name||"Unknown":"Unknown"}function w(m){return m.to_user?"You":m.to_minion_id?o.sessions.get(m.to_minion_id)?.name||"Unknown":"All"}async function g(){r.autoScrollEnabled&&(await kt(),d.value&&(d.value.scrollTop=d.value.scrollHeight))}async function $(){c.value=!0,p.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await kt(),await g(),setTimeout(()=>{g()},100)}catch(m){console.error("Failed to load timeline:",m),m.response?p.value=`${m.message} (${m.response.status})`:p.value=m.message||"Unknown error"}finally{c.value=!1}}function k(){i.connectLegion(e.legionId)}function b(){i.disconnectLegion()}return fe(()=>f.value.length,()=>{g()}),ye(()=>{o.currentSessionId=null,$(),k(),setTimeout(()=>{g()},100)}),Se(()=>{b()}),(m,_)=>(a(),l("div",Cy,[pe(zb,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:d,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(a(),l("div",Ty,[..._[0]||(_[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ie(" Loading timeline... ",-1)])])):p.value?(a(),l("div",xy," Failed to load timeline: "+y(p.value),1)):f.value.length===0?(a(),l("div",Ay," No messages yet. Minions will appear here once they start communicating. ")):(a(),l("div",My,[(a(!0),l(re,null,ce(f.value,v=>(a(),be(Ey,{key:v.comm_id,comm:v,"sender-name":u(v),"recipient-name":w(v)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),pe(py,{"legion-id":n.legionId},null,8,["legion-id"]),pe(Jb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Dy=ne(Oy,[["__scopeId","data-v-b6752179"]]),Ny={class:"minion-info flex-grow-1"},Ly={class:"minion-name"},Iy={key:0,class:"me-1"},jy={key:1,class:"badge bg-secondary ms-2"},Py={key:0,class:"latest-activity text-muted"},Ry={key:0,class:"activity-prefix"},Wy=["title"],Fy={key:1,class:"activity-time ms-1"},By={key:1,class:"latest-activity text-muted"},Hy={class:"activity-prefix"},Vy=["title"],Uy={key:2,class:"latest-activity text-muted fst-italic small"},qy={class:"node-row"},zy={class:"node-left"},Ky={key:0,class:"me-2"},Gy={key:1,class:"badge bg-secondary ms-2"},Yy={class:"node-right"},Jy={key:0,class:"latest-message-preview"},Qy={key:0,class:"message-prefix"},Xy=["title"],Zy={key:1,class:"message-time ms-1"},e1={key:1,class:"last-comm-preview"},t1={class:"comm-direction"},s1=["title"],n1={key:2,class:"text-muted fst-italic small"},o1={class:"node-actions"},i1={key:2,class:"minion-children"},a1={key:1,class:"text-danger small ms-4"},r1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=de(),r=xe(),c=_e(),p=h(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),d=h(()=>{if(!t.minionData||!t.minionData.id)return null;const T=r.messagesBySession.get(t.minionData.id);if(!T||T.length===0)return null;for(let A=T.length-1;A>=0;A--){const U=T[A],G=U.subtype||U.metadata?.subtype;if(U.type!=="result"&&!(U.type==="system"&&G==="init")&&!(U.type==="system"&&G==="task_notification")&&!(U.type==="permission_request"||U.type==="permission_response")){if(U.type==="user"&&U.metadata?.has_tool_results){const L=U.content||"";if(L.match(/^Tool results?: \d+ results?$/i)||L.trim()==="")continue}if(U.type==="user"){const L=U.content||"";if(L.includes("<command-message>")&&L.includes("skill is running")||L.startsWith("Base directory for this skill:"))continue}if(U.type==="user"){const L=U.content||"";if(L.includes("<command-message>")&&L.includes("<command-name>")&&L.includes("<command-args>")||L.includes("ARGUMENTS:")&&(L.includes("<command-name>")||L.match(/\nARGUMENTS:/)))continue}if(!(U.type==="system"&&U.content==="System message")&&!(U.type==="assistant"&&U.content==="Assistant response")&&(U.type==="user"||U.type==="assistant"||U.type==="system"))return{content:U.content,type:U.type,timestamp:U.timestamp}}}return null}),f=h(()=>{if(!t.minionData)return null;const T={...t.minionData};return p.value&&(T.state=p.value.state,T.is_processing=p.value.is_processing,p.value.name&&(T.name=p.value.name),p.value.latest_message&&(T.latest_message=p.value.latest_message,T.latest_message_type=p.value.latest_message_type,T.latest_message_time=p.value.latest_message_time)),d.value&&(T.latest_message=d.value.content,T.latest_message_type=d.value.type,T.latest_message_time=d.value.timestamp),T}),u=h(()=>t.level*24),w=h(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),g=h(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),$=h(()=>t.minionData&&t.minionData.is_overseer&&g.value),k=h(()=>{const T=f.value;return T?T.state==="paused"&&T.is_processing?"pending-prompt":T.is_processing?"processing":T.state||"created":"created"}),b=h(()=>{const T=k.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[T]||"status-dot-grey"}),m=h(()=>{const T=k.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[T]||"#d3d3d3"}}),_=h(()=>{const T=f.value;if(!T||!T.latest_message_type)return"";const A=T.latest_message_type;return A==="user"?"User -->:":A==="system"?"System:":""}),v=h(()=>{const T=f.value;if(!T||!T.latest_message)return"";const A=T.latest_message,U=150;return A.length>U?A.slice(0,U)+"...":A}),x=h(()=>{const T=f.value;if(!T||!T.latest_message_time)return"";try{const A=Date.now();let U;if(typeof T.latest_message_time=="number"?U=T.latest_message_time<3250368e4?T.latest_message_time*1e3:T.latest_message_time:U=new Date(T.latest_message_time).getTime(),isNaN(U)||U<9466848e5||U>A+6e4)return console.warn("Invalid timestamp for relative time calculation:",T.latest_message_time,"parsed to:",U),"";const G=A-U;if(G<0)return"just now";const L=Math.floor(G/6e4),F=Math.floor(L/60),q=Math.floor(F/24);return q>0?`${q}d ago`:F>0?`${F}h ago`:L>0?`${L}m ago`:"just now"}catch(A){return console.error("Error calculating relative time:",A,T.latest_message_time),""}});function E(T){return T.to_user?"User":T.to_minion_name?T.to_minion_name:"unknown"}function R(T){const A=T.summary||T.content||"";return A.length>150?A.substring(0,150)+"...":A}function I(){o("minion-click",t.minionData.id)}function D(){const T=i.sessions.get(t.minionData.id);T&&c.showModal("edit-session",{session:T})}function W(){const T=i.sessions.get(t.minionData.id);T&&c.showModal("manage-session",{session:T})}return(T,A)=>{const U=vo("MinionTreeNode",!0);return n.minionData?(a(),l("div",{key:0,class:"minion-tree-node",style:Je({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),l("div",{key:0,class:te(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:I},[s("div",{class:te(["status-dot me-2",b.value]),style:Je(m.value)},null,6),s("div",Ny,[s("div",Ly,[$.value?(a(),l("span",Iy,"ðŸ‘‘")):O("",!0),s("strong",null,y(f.value?.name||n.minionData.name),1),$.value?(a(),l("span",jy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):O("",!0)]),f.value?.latest_message?(a(),l("div",Py,[_.value?(a(),l("span",Ry,y(_.value),1)):O("",!0),s("span",{class:"activity-content",title:f.value.latest_message},y(v.value),9,Wy),x.value?(a(),l("span",Fy,"("+y(x.value)+")",1)):O("",!0)])):n.minionData?.last_comm?(a(),l("div",By,[s("span",Hy,[A[1]||(A[1]=ie("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),A[2]||(A[2]=ie(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(R(n.minionData.last_comm)),9,Vy)])):(a(),l("div",Uy," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(D,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(W,["stop"])}," âš™ï¸ ")],2)):(a(),l("div",{key:1,class:te(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:I},[s("div",qy,[s("div",zy,[s("div",{class:te(["status-dot me-2",b.value]),style:Je(m.value)},null,6),$.value?(a(),l("span",Ky,"ðŸ‘‘")):O("",!0),s("strong",null,y(f.value?.name||n.minionData.name),1),$.value?(a(),l("span",Gy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):O("",!0)]),s("div",Yy,[f.value?.latest_message?(a(),l("div",Jy,[_.value?(a(),l("span",Qy,y(_.value),1)):O("",!0),s("span",{class:"message-content",title:f.value.latest_message},y(v.value),9,Xy),x.value?(a(),l("span",Zy,"("+y(x.value)+")",1)):O("",!0)])):n.minionData?.last_comm?(a(),l("div",e1,[s("span",t1,[A[3]||(A[3]=ie("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),A[4]||(A[4]=ie(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(R(n.minionData.last_comm)),9,s1)])):(a(),l("div",n1," No activity yet "))]),s("div",o1,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(D,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(W,["stop"])}," âš™ï¸ ")])])],2)),g.value?(a(),l("div",i1,[(a(!0),l(re,null,ce(n.minionData.children,G=>(a(),be(U,{key:G.id,"minion-data":G,level:n.level+1,layout:n.layout,onMinionClick:A[0]||(A[0]=L=>T.$emit("minion-click",L))},null,8,["minion-data","level","layout"]))),128))])):O("",!0)],4)):(a(),l("div",a1," âš  Minion data is missing "))}}},ki=ne(r1,[["__scopeId","data-v-64b23e0e"]]),l1={class:"project-overview d-flex flex-column h-100"},c1={class:"project-overview-header border-bottom p-3"},u1={class:"d-flex align-items-center justify-content-between"},d1={class:"mb-1"},m1={key:0,class:"me-2"},p1={class:"text-muted font-monospace"},f1={class:"d-flex gap-2"},v1=["title"],h1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},_1={key:0,class:"text-center py-5"},g1={key:1,class:"alert alert-danger"},b1={key:2,class:"text-center py-5"},y1={key:3},w1={class:"row g-3 mb-4"},$1={class:"col-md-4"},k1={class:"card h-100"},S1={class:"card-body"},E1={class:"card-title mb-0"},C1={class:"text-muted"},T1={class:"col-md-4"},x1={class:"card h-100"},A1={class:"card-body"},M1={class:"card-title mb-0"},O1={class:"text-muted"},D1={key:0,class:"card mb-4"},N1={class:"card mb-4"},L1={class:"card-header d-flex align-items-center justify-content-between"},I1={class:"mb-0"},j1={class:"badge bg-secondary"},P1={class:"card-body"},R1={key:0,class:"text-center py-4"},W1={key:1,class:"text-center text-muted py-4"},F1={key:2,class:"hierarchy-tree"},B1={class:"user-root-node mb-3 border rounded bg-white"},H1={class:"node-row"},V1={class:"node-left"},U1={class:"badge bg-primary ms-2"},q1={class:"node-right"},z1={key:0,class:"last-comm-preview"},K1={class:"comm-direction"},G1=["title"],Y1={key:1,class:"text-muted fst-italic"},J1={class:"root-minions ms-4"},Q1={class:"card"},X1={class:"card-body"},Z1={class:"row mb-0"},ew={class:"col-sm-8 font-monospace text-break"},tw={class:"col-sm-8 font-monospace text-break"},sw={class:"col-sm-8"},nw={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},ow={class:"text-muted"},iw={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Ft(),o=Ie(),i=de(),r=_e(),c=_s(),p=st(),d=P(!1),f=P(null),u=P(null),w=P(!1);let g=null;const $=h(()=>o.getProject(e.projectId)),k=h(()=>$.value?.session_ids?$.value.session_ids.map(F=>i.getSession(F)).filter(F=>F!=null):[]),b=h(()=>k.value.length>0),m=h(()=>k.value.length),_=h(()=>k.value.filter(F=>F.state==="ACTIVE").length),v=h(()=>{const F=k.value.some(N=>N.state==="ACTIVE"),q=k.value.some(N=>N.is_processing);return k.value.some(N=>N.state==="ERROR")?"Error":q?"Working":F?"Active":m.value>0?"Idle":"Empty"}),x=h(()=>{switch(v.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),E=h(()=>{switch(v.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function R(){w.value=!0;try{const F=await me.get(`/api/legions/${e.projectId}/hierarchy`);u.value=F}catch(F){console.error("Failed to load minion hierarchy:",F),u.value=null}finally{w.value=!1}}function I(F,q){if(F&&F.id===q)return F;if(F&&F.children)for(const Z of F.children){const N=I(Z,q);if(N)return N}return null}function D(F){return F.to_user?"User":F.to_minion_name?F.to_minion_name:"unknown"}function W(F){const q=F.summary||F.content||"";return q.length>150?q.substring(0,150)+"...":q}function T(F){if(u.value){if(F.from_minion_id){const q=I(u.value,F.from_minion_id);q&&q.type==="minion"&&(q.last_comm=F)}F.from_user&&u.value.type==="user"&&(u.value.last_comm=F)}}function A(F){t.push(`/session/${F}`)}function U(){t.push(`/timeline/${e.projectId}`)}function G(){r.showModal("edit-project",{project:$.value})}function L(){r.showModal("create-minion",{project:$.value})}return ye(()=>{o.selectProject(e.projectId),i.currentSessionId=null,R(),c.setCurrentLegion(e.projectId),p.connectLegion(e.projectId),g=fe(()=>i.sessions,F=>{if(u.value){for(const[q,Z]of F)if(Z.project_id===e.projectId){const N=I(u.value,q);N&&N.type==="minion"&&(N.state!==Z.state&&(N.state=Z.state),N.is_processing!==Z.is_processing&&(N.is_processing=Z.is_processing),N.latest_message!==Z.latest_message&&(N.latest_message=Z.latest_message,N.latest_message_type=Z.latest_message_type,N.latest_message_time=Z.latest_message_time))}}},{deep:!0}),fe(()=>c.commsByLegion.get(e.projectId),F=>{if(F&&F.length>0){const q=F[F.length-1];T(q)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(F,q)=>{F!==q&&R()})}),fe(()=>e.projectId,F=>{o.selectProject(F),i.currentSessionId=null,R(),c.setCurrentLegion(F),p.connectLegion(F)}),Se(()=>{g&&g()}),(F,q)=>(a(),l("div",l1,[s("div",c1,[s("div",u1,[s("div",null,[s("h4",d1,[b.value?(a(),l("span",m1,"ðŸ›")):O("",!0),ie(" "+y($.value?.name||"Project Overview"),1)]),s("small",p1,y($.value?.working_directory),1)]),s("div",f1,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:G}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:L}," âž• "+y(b.value?"Add Minion":"Add Session"),9,v1)])])]),s("div",h1,[d.value?(a(),l("div",_1,[...q[0]||(q[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(a(),l("div",g1,y(f.value),1)):$.value?(a(),l("div",y1,[s("div",w1,[s("div",$1,[s("div",k1,[s("div",S1,[q[2]||(q[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",E1,y(m.value),1),s("small",C1,y(_.value)+" active",1)])])]),s("div",T1,[s("div",x1,[s("div",A1,[q[3]||(q[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",M1,[s("span",{class:te(x.value)},y(v.value),3)]),s("small",O1,y(E.value),1)])])])]),b.value?(a(),l("div",D1,[q[4]||(q[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:U}," ðŸ“Š View Timeline ")])])])):O("",!0),s("div",N1,[s("div",L1,[s("h5",I1,"ðŸŒ³ "+y(b.value?"Minion Hierarchy":"Sessions"),1),s("span",j1,y(k.value.length),1)]),s("div",P1,[w.value?(a(),l("div",R1,[...q[5]||(q[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),l("div",W1,' No sessions yet. Click "Add Session" to create one. ')):(a(),l("div",F1,[s("div",B1,[s("div",H1,[s("div",V1,[q[6]||(q[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,y(u.value.name),1),s("span",U1,y(u.value.children.length)+" "+y(u.value.children.length===1?"minion":"minions"),1)]),s("div",q1,[u.value.last_comm?(a(),l("div",z1,[s("span",K1,[q[7]||(q[7]=ie(" â†’ ",-1)),s("strong",null,y(D(u.value.last_comm)),1),q[8]||(q[8]=ie(": ",-1))]),s("span",{class:"comm-content",title:u.value.last_comm.content||""},y(W(u.value.last_comm)),9,G1)])):(a(),l("div",Y1," No communications yet "))])])]),s("div",J1,[(a(!0),l(re,null,ce(u.value.children,Z=>(a(),be(ki,{key:Z.id,"minion-data":Z,level:1,layout:"two-column",onMinionClick:A},null,8,["minion-data"]))),128))])]))])]),s("div",Q1,[q[12]||(q[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",X1,[s("dl",Z1,[q[9]||(q[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",ew,y($.value.working_directory),1),q[10]||(q[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",tw,y($.value.project_id),1),q[11]||(q[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",sw,y(b.value?"Yes (has minions)":"No"),1)])])])])):(a(),l("div",b1,[...q[1]||(q[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",nw,[q[13]||(q[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",ow,y(m.value)+" session"+y(m.value!==1?"s":""),1)])]))}},aw=ne(iw,[["__scopeId","data-v-168bf04c"]]),rw=[{path:"/",name:"home",component:Ii},{path:"/project/:projectId",name:"project",component:aw,props:!0},{path:"/session/:sessionId",name:"session",component:Fb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Dy,props:!0}],lw=Ei({history:Ci(),routes:rw}),cw={class:"connection-indicators"},uw=["title"],dw=["title"],mw=["title"],pw={__name:"ConnectionIndicator",setup(n){const e=st();function t(i){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:c,retryCount:p}=r[i];return p>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(i){const r={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},p={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:d,retryCount:f}=p[i];let u="Disconnected";return d?u="Connected":f>0&&(u=`Reconnecting (attempt ${f})`),`${r[i]}
${c[i]}
Status: ${u}`}return(i,r)=>(a(),l("div",cw,[s("div",{class:te(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,uw),s("div",{class:te(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,dw),s("div",{class:te(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,mw)]))}},fw=ne(pw,[["__scopeId","data-v-d35b07c8"]]),vw={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},hw={class:"d-flex align-items-center gap-2"},_w={__name:"AppHeader",setup(n){const e=_e();function t(){e.toggleSidebar()}return(o,i)=>(a(),l("header",vw,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",hw,[pe(fw)])]))}},gw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},bw={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},yw=["title"],ww={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=h(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(p){return p.state==="paused"&&p.is_processing?"pending-prompt":p.is_processing?"processing":p.state}function i(p){const d=o(p);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[d]||"#d3d3d3"}function r(p){const d=o(p);return d==="starting"||d==="processing"||d==="pending-prompt"}function c(p){const d=o(p),f=d.charAt(0).toUpperCase()+d.slice(1),u=p.name||"Unnamed Session",w=p.role?` (${p.role})`:"";return`${u}${w}: ${f}`}return(p,d)=>(a(),l("div",gw,[!n.sessions||n.sessions.length===0?(a(),l("div",bw)):(a(!0),l(re,{key:1},ce(n.sessions,f=>(a(),l("div",{key:f.session_id,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":r(f)}]),style:Je({width:t.value,backgroundColor:i(f),cursor:"help"}),title:c(f)},null,14,yw))),128))]))}},$w=ne(ww,[["__scopeId","data-v-391d77c1"]]),kw=["data-project-id"],Sw=["id"],Ew=["aria-expanded","aria-controls","aria-label","onKeydown"],Cw=["aria-label","onKeydown"],Tw={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},xw={class:"fw-semibold",style:{"flex-shrink":"0"}},Aw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Mw={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Ow=["title"],Dw=["title"],Nw=["id","aria-labelledby"],Lw={class:"accordion-body p-0"},Iw={class:"list-group list-group-flush"},jw={class:"minion-hierarchy-container"},Pw={key:0,class:"text-center py-2"},Rw={key:2,class:"text-muted text-center py-2 small"},Ww={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ft(),o=Ie(),i=de(),r=_e(),c=P(e.project.is_expanded||!1),p=P(null),d=P(!1);let f=null;const u=h(()=>o.formatPath(e.project.working_directory)),w=h(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(L=>i.getSession(L)).filter(L=>L!=null)),g=h(()=>w.value.length>0),$=h(()=>{const L=t.currentRoute.value;return L.name==="timeline"&&L.params.legionId===e.project.project_id}),k=h(()=>{const L=t.currentRoute.value;return L.name==="project"&&L.params.projectId===e.project.project_id});function b(L){const F=window.bootstrap;if(!F)return;const q=document.getElementById(`collapse-${e.project.project_id}`);if(!q)return;F.Collapse.getOrCreateInstance(q).toggle(),c.value=!c.value}function m(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function _(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function v(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const L=i.currentSessionId;L&&i.getSession(L)&&e.project.session_ids?.includes(L)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function x(){r.showModal("edit-project",{project:e.project})}function E(){r.showModal("create-minion",{project:e.project})}function R(){t.push(`/timeline/${e.project.project_id}`)}async function I(){d.value=!0;try{const L=await me.get(`/api/legions/${e.project.project_id}/hierarchy`);p.value=L}catch(L){console.error("Failed to load minion hierarchy:",L),p.value=null}finally{d.value=!1}}function D(L){t.push(`/session/${L}`)}function W(L,F){if(L&&L.id===F)return L;if(L&&L.children)for(const q of L.children){const Z=W(q,F);if(Z)return Z}return null}fe(c,L=>{L&&I()}),ye(()=>{f=fe(()=>i.sessions,L=>{if(!(!p.value||!c.value)){for(const[F,q]of L)if(q.project_id===e.project.project_id){const Z=W(p.value,F);Z&&Z.type==="minion"&&(Z.state!==q.state&&(Z.state=q.state),Z.is_processing!==q.is_processing&&(Z.is_processing=q.is_processing),Z.latest_message!==q.latest_message&&(Z.latest_message=q.latest_message,Z.latest_message_type=q.latest_message_type,Z.latest_message_time=q.latest_message_time))}}},{deep:!0}),fe(()=>i.sessions.size,(L,F)=>{if(c.value&&(L>F&&Array.from(i.sessions.values()).some(N=>N.project_id===e.project.project_id&&(!p.value||!W(p.value,N.session_id)))&&(console.log("New minion detected, reloading hierarchy"),I()),L<F&&p.value)){const q=i.sessions,Z=N=>N.type==="minion"&&!q.has(N.id)?!0:N.children?N.children.some(S=>Z(S)):!1;Z(p.value)&&(console.log("Minion deletion detected, reloading hierarchy"),I())}}),c.value&&I()}),Se(()=>{f&&f()});function T(L){L.dataTransfer.effectAllowed="move",L.dataTransfer.setData("application/project-id",e.project.project_id),L.dataTransfer.setData("text/plain",e.project.project_id),L.target.classList.add("dragging")}function A(L){L.target.classList.remove("dragging")}function U(L){L.preventDefault(),L.dataTransfer.dropEffect="move";const F=L.currentTarget.getBoundingClientRect(),q=F.top+F.height/2;L.clientY<q?(L.currentTarget.classList.add("drop-above"),L.currentTarget.classList.remove("drop-below")):(L.currentTarget.classList.add("drop-below"),L.currentTarget.classList.remove("drop-above"))}function G(L){L.preventDefault(),L.currentTarget.classList.remove("drop-above","drop-below");const F=L.dataTransfer.getData("application/project-id")||L.dataTransfer.getData("text/plain");if(!F||F===e.project.project_id)return;const q=L.currentTarget.getBoundingClientRect(),Z=q.top+q.height/2,N=L.clientY<Z,S=o.orderedProjects,C=S.findIndex(se=>se.project_id===e.project.project_id),M=S.findIndex(se=>se.project_id===F);if(C===-1||M===-1)return;const V=[...S],[K]=V.splice(M,1);let J=N?C:C+1;M<C&&J--,V.splice(J,0,K);const Q=V.map(se=>se.project_id);o.reorderProjects(Q)}return(L,F)=>(a(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:T,onDragend:A,onDragover:U,onDrop:G},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:te(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":k.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:ve(b,["stop"]),onKeydown:[Ue(ve(b,["prevent"]),["enter"]),Ue(ve(b,["prevent"]),["space"])]},[(a(),l("svg",{class:te(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...F[0]||(F[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,Ew),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:m,onKeydown:[Ue(ve(m,["prevent"]),["enter"]),Ue(ve(m,["prevent"]),["space"])]},[s("div",Tw,[s("div",xw,[g.value?(a(),l("span",Aw,"ðŸ›")):O("",!0),ie(" "+y(n.project.name),1)]),s("div",Mw,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ve(x,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:ve(E,["stop"])}," âž• ",8,Ow)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(u.value),9,Dw)],40,Cw)],2)],8,Sw),pe($w,{project:n.project,sessions:w.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:te(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:_,onHidden:v},[s("div",Lw,[s("div",Iw,[g.value?(a(),l("div",{key:0,class:te(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:$.value}]),style:{cursor:"pointer"},onClick:R},[...F[1]||(F[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):O("",!0),s("div",jw,[d.value?(a(),l("div",Pw,[...F[2]||(F[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):p.value&&p.value.children&&p.value.children.length>0?(a(!0),l(re,{key:1},ce(p.value.children,q=>(a(),be(ki,{key:q.id,"minion-data":q,level:0,layout:"sidebar",onMinionClick:D},null,8,["minion-data"]))),128)):(a(),l("div",Rw," No sessions "))])])])],42,Nw)],40,kw))}},Fw=ne(Ww,[["__scopeId","data-v-a15b34e8"]]),Bw={class:"project-list"},Hw={key:0,class:"text-muted text-center py-3"},Vw={__name:"ProjectList",setup(n){const e=Ie(),t=h(()=>e.orderedProjects);return(o,i)=>(a(),l("div",Bw,[t.value.length===0?(a(),l("div",Hw,' No projects yet. Click "New" to create one. ')):O("",!0),(a(!0),l(re,null,ce(t.value,r=>(a(),be(Fw,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},Uw={class:"flex-grow-1 overflow-auto p-3"},qw={id:"sessions-container"},zw={__name:"Sidebar",setup(n){const e=_e(),t=h(()=>e.sidebarCollapsed),o=h(()=>e.isMobile),i=h(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function r(){e.showModal("create-project")}const c=P(!1);function p(u){c.value=!0,document.addEventListener("mousemove",d),document.addEventListener("mouseup",f)}function d(u){c.value&&e.setSidebarWidth(u.clientX)}function f(){c.value=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",f)}return(u,w)=>(a(),l("aside",{id:"sidebar",class:te(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:Je(i.value)},[s("div",Uw,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),s("div",qw,[pe(Vw)])]),s("div",{class:"sidebar-resize-handle",onMousedown:p},null,32)],6))}},Kw=ne(zw,[["__scopeId","data-v-d792f0f0"]]),Gw={class:"task-row d-flex align-items-center gap-2"},Yw={key:0,class:"status-icon"},Jw={key:1,class:"status-icon"},Qw=["title"],Xw={key:0,class:"task-details"},Zw={key:0,class:"task-description mb-2"},e$={class:"description-content"},t$={key:1,class:"task-owner mb-2"},s$={class:"ms-1"},n$={key:2,class:"task-blocked-by mb-2"},o$={key:3,class:"task-blocks"},i$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=h(()=>e.task.status==="in_progress"),o=h(()=>e.task.status==="completed"?"âœ…":"â³"),i=h(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=h(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,p)=>(a(),l("div",{class:te(["task-item",r.value]),onClick:p[0]||(p[0]=d=>c.$emit("toggle"))},[s("div",Gw,[t.value?(a(),l("span",Yw,[...p[1]||(p[1]=[s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),l("span",Jw,y(o.value),1)),s("span",{class:"task-text flex-grow-1",title:n.task.subject},y(i.value),9,Qw),(a(),l("svg",{class:te(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...p[2]||(p[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),l("div",Xw,[n.task.description?(a(),l("div",Zw,[p[3]||(p[3]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",e$,y(n.task.description),1)])):O("",!0),n.task.owner?(a(),l("div",t$,[p[4]||(p[4]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",s$,y(n.task.owner),1)])):O("",!0),n.task.blockedBy?.length>0?(a(),l("div",n$,[p[5]||(p[5]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),l(re,null,ce(n.task.blockedBy,d=>(a(),l("span",{key:d,class:"badge bg-warning text-dark me-1"}," #"+y(d),1))),128))])):O("",!0),n.task.blocks?.length>0?(a(),l("div",o$,[p[6]||(p[6]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),l(re,null,ce(n.task.blocks,d=>(a(),l("span",{key:d,class:"badge bg-info text-dark me-1"}," #"+y(d),1))),128))])):O("",!0)])):O("",!0)],2))}},a$=ne(i$,[["__scopeId","data-v-0f96ae87"]]),r$={class:"task-list-panel"},l$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},c$={class:"d-flex align-items-center gap-2"},u$={key:0,class:"badge bg-secondary"},d$=["title"],m$={key:0,class:"task-list p-2"},p$={key:0,class:"text-muted text-center py-4"},f$={__name:"TaskListPanel",setup(n){const e=$t();_e();const t=P(new Set),o=P(!1),i=h(()=>e.currentTasks),r=h(()=>e.currentTaskStats);function c(){o.value=!o.value}function p(d){t.value.has(d)?t.value.delete(d):t.value.add(d),t.value=new Set(t.value)}return(d,f)=>(a(),l("div",r$,[s("div",l$,[s("div",c$,[f[0]||(f[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),f[1]||(f[1]=s("h6",{class:"mb-0"},"Tasks",-1)),r.value.total>0?(a(),l("span",u$,y(r.value.completed)+"/"+y(r.value.total),1)):O("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:c,title:o.value?"Expand":"Collapse"},[(a(),l("svg",{class:te(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,d$)]),o.value?O("",!0):(a(),l("div",m$,[i.value.length===0?(a(),l("div",p$,[...f[3]||(f[3]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):O("",!0),pe(Ti,{name:"task-list",tag:"div"},{default:ho(()=>[(a(!0),l(re,null,ce(i.value,u=>(a(),be(a$,{key:u.id,task:u,isExpanded:t.value.has(u.id),onToggle:w=>p(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},v$=ne(f$,[["__scopeId","data-v-c03a807a"]]),h$={class:"resource-gallery-panel"},_$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},g$={class:"d-flex align-items-center gap-2"},b$={key:0,class:"badge bg-secondary"},y$=["title"],w$={key:0,class:"resource-grid-container p-2"},$$={key:0,class:"text-muted text-center py-4"},k$={key:1,class:"resource-grid"},S$=["onClick","title"],E$=["src","alt"],C$=["title"],T$={class:"file-icon"},x$={class:"file-ext"},A$={class:"resource-info"},M$=["title"],O$={class:"resource-actions"},D$=["onClick"],N$=["href","download"],L$={__name:"ResourceGallery",setup(n){const e=Qe(),t=de(),o=fo("addAttachmentFromResource",null),i=P(!1),r=h(()=>e.currentResources),c=h(()=>e.currentResourceCount);function p(){i.value=!i.value}function d(_){return e.isImageResource(_)}function f(_){return e.getResourceIcon(_)}function u(_){const v=e.getResourceExtension(_);return v?v.toUpperCase().slice(1):""}function w(_){return e.getResourceUrl(t.currentSessionId,_)}function g(_){return e.getDownloadUrl(t.currentSessionId,_)}function $(_){e.openFullView(t.currentSessionId,_)}function k(_,v=18){return _?_.length<=v?_:_.substring(0,v-3)+"...":""}function b(_){_.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function m(_){o?o(_):console.warn("addAttachmentFromResource not provided")}return(_,v)=>(a(),l("div",h$,[s("div",_$,[s("div",g$,[v[1]||(v[1]=s("span",{class:"panel-icon"},"ðŸ“",-1)),v[2]||(v[2]=s("h6",{class:"mb-0"},"Resources",-1)),c.value>0?(a(),l("span",b$,y(c.value),1)):O("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:p,title:i.value?"Expand":"Collapse"},[(a(),l("svg",{class:te(["chevron-icon",{expanded:!i.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...v[3]||(v[3]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,y$)]),i.value?O("",!0):(a(),l("div",w$,[r.value.length===0?(a(),l("div",$$,[...v[4]||(v[4]=[s("span",{class:"empty-icon"},"ðŸ“‚",-1),s("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),l("div",k$,[(a(!0),l(re,null,ce(r.value,(x,E)=>(a(),l("div",{key:x.resource_id,class:te(["resource-item",{"is-image":d(x)}])},[d(x)?(a(),l("div",{key:0,class:"resource-thumbnail",onClick:R=>$(E),title:x.title||"Click to view"},[s("img",{src:w(x.resource_id),alt:x.title||"Image",loading:"lazy",onError:b},null,40,E$)],8,S$)):(a(),l("div",{key:1,class:"resource-placeholder",title:x.title||x.original_filename||"File"},[s("span",T$,y(f(x)),1),s("span",x$,y(u(x)),1)],8,C$)),s("div",A$,[s("div",{class:"resource-title",title:x.title||x.original_filename},y(k(x.title||x.original_filename)),9,M$),s("div",O$,[s("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ve(R=>m(x),["stop"]),title:"Add to message attachments"},[...v[5]||(v[5]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,D$),s("a",{href:g(x.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:x.original_filename||x.title||"download",title:"Download",onClick:v[0]||(v[0]=ve(()=>{},["stop"]))},[...v[6]||(v[6]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),s("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,N$)])])],2))),128))]))]))]))}},I$=ne(L$,[["__scopeId","data-v-3bb063c1"]]),j$=["src","alt"],P$={key:1,class:"image-info"},R$={key:0,class:"image-title"},W$={key:1,class:"image-description"},F$={class:"image-meta"},B$={class:"meta-item"},H$={class:"meta-item"},V$={class:"meta-item"},U$={key:2,class:"position-indicator"},q$={key:3,class:"thumbnail-strip"},z$=["onClick"],K$=["src","alt"],G$={__name:"ImageFullView",setup(n){const e=Qe(),t=P(null),o=h(()=>e.fullViewOpen),i=h(()=>e.currentFullViewResource),r=h(()=>e.currentResourceIndex),c=h(()=>e.fullViewTotalResources),p=h(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]);fe(o,v=>{v?(kt(()=>{t.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Se(()=>{document.body.style.overflow=""});function d(v){return e.getResourceUrl(e.fullViewSessionId,v)}function f(){e.closeFullView()}function u(){e.nextResource()}function w(){e.prevResource()}function g(v){e.goToResource(v)}function $(v){v.target===v.currentTarget&&f()}function k(v){switch(v.key){case"Escape":f();break;case"ArrowLeft":w();break;case"ArrowRight":u();break;case"Home":g(0);break;case"End":g(c.value-1);break}}function b(v){return v?v<1024?`${v} B`:v<1024*1024?`${(v/1024).toFixed(1)} KB`:`${(v/(1024*1024)).toFixed(2)} MB`:""}function m(v){return v?new Date(v*1e3).toLocaleString():""}function _(v){v.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(v,x)=>(a(),be(Ai,{to:"body"},[pe(xi,{name:"modal"},{default:ho(()=>[o.value?(a(),l("div",{key:0,class:"image-full-view-overlay",onClick:$,onKeydown:k,tabindex:"0",ref_key:"overlayRef",ref:t},[s("button",{class:"close-btn",onClick:ve(f,["stop"]),title:"Close (Escape)"},[...x[1]||(x[1]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),c.value>1?(a(),l("button",{key:0,class:"nav-btn nav-prev",onClick:ve(w,["stop"]),title:"Previous (Left Arrow)"},[...x[2]||(x[2]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"15 18 9 12 15 6"})],-1)])])):O("",!0),s("div",{class:"image-container",onClick:x[0]||(x[0]=ve(()=>{},["stop"]))},[i.value?(a(),l("img",{key:0,src:d(i.value.resource_id||i.value.image_id),alt:i.value.title||"Image",class:"full-image",onError:_},null,40,j$)):O("",!0),i.value?(a(),l("div",P$,[i.value.title?(a(),l("h5",R$,y(i.value.title),1)):O("",!0),i.value.description?(a(),l("p",W$,y(i.value.description),1)):O("",!0),s("div",F$,[s("span",B$,y(b(i.value.size_bytes)),1),s("span",H$,y(i.value.format?.toUpperCase()),1),s("span",V$,y(m(i.value.timestamp)),1)])])):O("",!0)]),c.value>1?(a(),l("button",{key:1,class:"nav-btn nav-next",onClick:ve(u,["stop"]),title:"Next (Right Arrow)"},[...x[3]||(x[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"9 18 15 12 9 6"})],-1)])])):O("",!0),c.value>1?(a(),l("div",U$,y(r.value+1)+" / "+y(c.value),1)):O("",!0),c.value>1?(a(),l("div",q$,[(a(!0),l(re,null,ce(p.value,(E,R)=>(a(),l("div",{key:E.resource_id||E.image_id,class:te(["strip-thumbnail",{active:R===r.value}]),onClick:ve(I=>g(R),["stop"])},[s("img",{src:d(E.resource_id||E.image_id),alt:E.title||"Thumbnail",loading:"lazy"},null,8,K$)],10,z$))),128))])):O("",!0)],544)):O("",!0)]),_:1})]))}},Y$=ne(G$,[["__scopeId","data-v-9bc36988"]]),J$={class:"panels-container"},Q$={__name:"RightSidebar",setup(n){const e=_e(),t=h(()=>e.rightSidebarCollapsed),o=h(()=>e.isMobile),i=h(()=>{if(o.value)return{};const f=`${e.rightSidebarWidth}px`;return{width:f,minWidth:"200px",maxWidth:"30vw","--sidebar-width":f}}),r=P(!1);function c(f){f.preventDefault(),r.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",d)}function p(f){if(r.value){const u=window.innerWidth-f.clientX;e.setRightSidebarWidth(u)}}function d(){r.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",d)}return(f,u)=>(a(),l("aside",{id:"right-sidebar",class:te(["bg-light border-start d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,resizing:r.value}]),style:Je(i.value)},[s("div",J$,[pe(v$),pe(I$)]),s("div",{class:"sidebar-resize-handle",onMousedown:c},null,32),pe(Y$)],6))}},X$=ne(Q$,[["__scopeId","data-v-597f1f49"]]),Z$={class:"modal-dialog modal-lg"},ek={class:"modal-content"},tk={class:"modal-body"},sk={class:"mb-3"},nk={class:"input-group"},ok=["disabled"],ik={key:0,class:"text-center py-4"},ak={key:1,class:"alert alert-danger",role:"alert"},rk={key:2,class:"folder-list"},lk=["onClick","onDblclick"],ck={class:"d-flex align-items-center flex-grow-1"},uk=["onClick"],dk={key:1,class:"text-center text-muted py-3"},mk={class:"modal-footer"},pk=["disabled"],fk={__name:"FolderBrowserModal",setup(n){const e=_e(),t=P(""),o=P(""),i=P([]),r=P(!1),c=P(""),p=P(null);let d=null,f=null;const u=h(()=>{if(!t.value)return null;const x=t.value.split(/[\\/]/).filter(Boolean);return x.length<=1?null:(x.pop(),x.length>0?"/"+x.join("/"):"/")});function w(x){if(!x)return"";const E=x.split(/[\\/]/).filter(Boolean);return E.length<=2?x:".../"+E.slice(-2).join("/")}async function g(){r.value=!0,c.value="",i.value=[],o.value="";try{const x=t.value?{path:t.value}:{},E=await me.get("/api/filesystem/browse",{params:x});E.current_path&&(t.value=E.current_path),i.value=E.directories||[]}catch(x){console.error("Failed to load directory:",x),c.value=x.message||"Failed to load directory"}finally{r.value=!1}}function $(x){o.value=x.path}function k(x){t.value=x.path,o.value="",g()}function b(){u.value&&(t.value=u.value,o.value="",g())}function m(){const x=o.value||t.value;x&&f&&f(x),d&&d.hide()}function _(){g()}function v(){i.value=[],o.value="",c.value="",f=null,e.hideModal()}return fe(()=>e.currentModal,x=>{if(x?.name==="folder-browser"&&d){const E=x.data||{};t.value=E.defaultPath||E.currentPath||"",f=E.onSelect||null,d.show()}}),ye(()=>{p.value&&Te(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{d=new x(p.value),p.value.addEventListener("shown.bs.modal",_),p.value.addEventListener("hidden.bs.modal",v)})}),Se(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",_),p.value.removeEventListener("hidden.bs.modal",v)),d&&d.dispose()}),(x,E)=>(a(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",Z$,[s("div",ek,[E[6]||(E[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",tk,[s("div",sk,[E[1]||(E[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",nk,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=R=>t.value=R),onKeyup:Ue(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Re,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:g,disabled:r.value}," ðŸ”„ Refresh ",8,ok)])]),r.value?(a(),l("div",ik,[...E[2]||(E[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(a(),l("div",ak,y(c.value),1)):(a(),l("div",rk,[u.value?(a(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...E[3]||(E[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):O("",!0),(a(!0),l(re,null,ce(i.value,R=>(a(),l("div",{key:R.path,class:te(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:R.path===o.value}]),onClick:I=>$(R),onDblclick:I=>k(R),role:"button"},[s("div",ck,[E[4]||(E[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,y(R.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:ve(I=>k(R),["stop"])}," Open ",8,uk)],42,lk))),128)),i.value.length===0?(a(),l("div",dk," No subdirectories found ")):O("",!0)]))]),s("div",mk,[E[5]||(E[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:!o.value},' Select "'+y(w(o.value||t.value))+'" ',9,pk)])])])],512))}},vk=ne(fk,[["__scopeId","data-v-0d61ed46"]]),hk={class:"modal-dialog"},_k={class:"modal-content"},gk={class:"modal-body"},bk={class:"mb-3"},yk={key:0,class:"invalid-feedback"},wk={class:"mb-3"},$k={class:"input-group"},kk={key:0,class:"invalid-feedback"},Sk={class:"mb-3 form-check"},Ek={key:0,class:"mb-3 ms-4"},Ck={key:1,class:"alert alert-danger",role:"alert"},Tk={class:"modal-footer"},xk=["disabled"],Ak={key:0,class:"spinner-border spinner-border-sm me-2"},Mk={__name:"ProjectCreateModal",setup(n){const e=Ie(),t=de(),o=_e(),i=P({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=P({name:"",workingDirectory:""}),c=P(!1),p=P(""),d=P(null);let f=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:m=>{i.value.workingDirectory=m,r.value.workingDirectory=""}})}function w(){r.value={};let m=!0;return i.value.name.trim()||(r.value.name="Project name is required",m=!1),i.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",m=!1),m}async function g(){if(w()){c.value=!0,p.value="";try{const m=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(m.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),$()}catch(m){console.error("Failed to create project:",m),p.value=m.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function $(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},p.value=""}function k(){const m=document.getElementById("projectName");m&&m.focus()}function b(){$(),o.hideModal()}return fe(()=>o.currentModal,m=>{m?.name==="create-project"&&f&&f.show()}),ye(()=>{d.value&&Te(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{f=new m(d.value),d.value.addEventListener("shown.bs.modal",k),d.value.addEventListener("hidden.bs.modal",b)})}),Se(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",k),d.value.removeEventListener("hidden.bs.modal",b)),f&&f.dispose()}),(m,_)=>(a(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",hk,[s("div",_k,[_[11]||(_[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",gk,[s("form",{onSubmit:ve(g,["prevent"])},[s("div",bk,[_[4]||(_[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":_[0]||(_[0]=v=>i.value.name=v),placeholder:"My Project",required:""},null,2),[[Re,i.value.name]]),r.value.name?(a(),l("div",yk,y(r.value.name),1)):O("",!0)]),s("div",wk,[_[5]||(_[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",$k,[ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":_[1]||(_[1]=v=>i.value.workingDirectory=v),placeholder:"/path/to/project",required:""},null,2),[[Re,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),r.value.workingDirectory?(a(),l("div",kk,y(r.value.workingDirectory),1)):O("",!0)]),_[6]||(_[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",Sk,[ge(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":_[2]||(_[2]=v=>i.value.createSession=v)},null,512),[[Mi,i.value.createSession]]),_[7]||(_[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),_[8]||(_[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),l("div",Ek,[_[9]||(_[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ge(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":_[3]||(_[3]=v=>i.value.sessionName=v),placeholder:"main"},null,512),[[Re,i.value.sessionName]])])):O("",!0),p.value?(a(),l("div",Ck,y(p.value),1)):O("",!0)],32)]),s("div",Tk,[_[10]||(_[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:c.value},[c.value?(a(),l("span",Ak)):O("",!0),ie(" "+y(c.value?"Creating...":"Create Project"),1)],8,xk)])])])],512))}},Ok=ne(Mk,[["__scopeId","data-v-ea55fdae"]]),Dk={class:"modal-dialog"},Nk={class:"modal-content"},Lk={class:"modal-body"},Ik={class:"mb-3"},jk={key:0,class:"invalid-feedback"},Pk={class:"mb-3"},Rk=["value"],Wk={key:0,class:"alert alert-danger",role:"alert"},Fk={class:"danger-zone"},Bk={class:"text-muted small"},Hk=["disabled"],Vk={key:0,class:"alert alert-warning mt-3",role:"alert"},Uk={class:"mb-2"},qk={class:"d-flex gap-2"},zk=["disabled"],Kk={key:0,class:"spinner-border spinner-border-sm me-2"},Gk=["disabled"],Yk={class:"modal-footer"},Jk=["disabled"],Qk={key:0,class:"spinner-border spinner-border-sm me-2"},Xk={__name:"ProjectEditModal",setup(n){const e=Ie(),t=_e(),o=P(null),i=P({name:""}),r=P({name:""}),c=P(!1),p=P(!1),d=P(""),f=P(!1),u=P(null);let w=null;const g=h(()=>o.value?.session_ids?.length||0);function $(){r.value={};let x=!0;return i.value.name.trim()||(r.value.name="Project name is required",x=!1),x}async function k(){if(!(!$()||!o.value)){c.value=!0,d.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),w&&w.hide()}catch(x){console.error("Failed to update project:",x),d.value=x.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function b(){if(o.value){p.value=!0,d.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(x){console.error("Failed to delete project:",x),d.value=x.message||"Failed to delete project. Please try again."}finally{p.value=!1}}}function m(){i.value={name:""},r.value={},d.value="",f.value=!1}function _(){const x=document.getElementById("editProjectName");x&&(x.focus(),x.select())}function v(){m(),o.value=null,t.hideModal()}return fe(()=>t.currentModal,x=>{if(x?.name==="edit-project"&&w){const E=x.data||{};o.value=E.project,o.value&&(i.value.name=o.value.name),w.show()}}),ye(()=>{u.value&&Te(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{w=new x(u.value),u.value.addEventListener("shown.bs.modal",_),u.value.addEventListener("hidden.bs.modal",v)})}),Se(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",_),u.value.removeEventListener("hidden.bs.modal",v)),w&&w.dispose()}),(x,E)=>(a(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",Dk,[s("div",Nk,[E[10]||(E[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Lk,[s("form",{onSubmit:ve(k,["prevent"])},[s("div",Ik,[E[3]||(E[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":E[0]||(E[0]=R=>i.value.name=R),placeholder:"My Project",required:""},null,2),[[Re,i.value.name]]),r.value.name?(a(),l("div",jk,y(r.value.name),1)):O("",!0)]),s("div",Pk,[E[4]||(E[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Rk),E[5]||(E[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),d.value?(a(),l("div",Wk,y(d.value),1)):O("",!0)],32),E[8]||(E[8]=s("hr",null,null,-1)),s("div",Fk,[E[6]||(E[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",Bk," Deleting this project will also delete all "+y(g.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:E[1]||(E[1]=R=>f.value=!0),disabled:p.value}," ðŸ—‘ï¸ Delete Project ",8,Hk)]),f.value?(a(),l("div",Vk,[E[7]||(E[7]=s("strong",null,"Are you sure?",-1)),s("p",Uk,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(g.value)+" session(s). ",1),s("div",qk,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:p.value},[p.value?(a(),l("span",Kk)):O("",!0),ie(" "+y(p.value?"Deleting...":"Yes, Delete Permanently"),1)],8,zk),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:E[2]||(E[2]=R=>f.value=!1),disabled:p.value}," Cancel ",8,Gk)])])):O("",!0)]),s("div",Yk,[E[9]||(E[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:k,disabled:c.value},[c.value?(a(),l("span",Qk)):O("",!0),ie(" "+y(c.value?"Saving...":"Save Changes"),1)],8,Jk)])])])],512))}},Zk=ne(Xk,[["__scopeId","data-v-52679516"]]),eS={class:"general-tab"},tS={key:0,class:"mb-3"},sS={for:"template-select",class:"form-label"},nS=["value"],oS=["value"],iS={key:0,class:"form-text"},aS={class:"mb-3"},rS={for:"config-name",class:"form-label"},lS=["value","placeholder","pattern","title"],cS={key:0,class:"invalid-feedback"},uS={key:1,class:"form-text"},dS={key:1,class:"mb-3"},mS=["value"],pS={class:"mb-3"},fS=["value"],vS={class:"form-text"},hS={key:0,class:"text-warning"},_S={key:1},gS={class:"mb-3"},bS={for:"config-permission-mode",class:"form-label"},yS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},wS={key:1,class:"field-indicator modified",title:"Modified from template"},$S=["value","disabled"],kS={key:0,value:"bypassPermissions"},SS={class:"form-text"},ES={key:0,class:"text-warning"},CS={key:1},TS={class:"mb-3"},xS={for:"config-role",class:"form-label"},AS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},MS={key:1,class:"field-indicator modified",title:"Modified from template"},OS=["value","placeholder"],DS={class:"form-text"},NS={key:2,class:"mb-3"},LS={class:"input-group"},IS=["value","placeholder","disabled","readonly"],jS={class:"form-text"},PS={key:3,class:"mb-3"},RS={class:"form-control-plaintext"},WS={key:4,class:"mb-3 form-check"},FS=["checked"],BS={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=h(()=>e.mode==="create-session"||e.mode==="edit-session"),o=h(()=>e.mode==="create-template"||e.mode==="edit-template"),i=h(()=>e.mode==="create-session"),r=h(()=>e.mode==="edit-session"),c=h(()=>e.session?.state==="active"||e.session?.state==="starting"),p=h(()=>{if(!e.session)return!1;const b=e.session.model||"sonnet";return e.formData.model!==b}),d=h(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=h(()=>e.selectedTemplateId?e.templates.find(b=>b.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},w=h(()=>u[e.formData.model]||null),g=h(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),$=h(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function k(b){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[b]||"bg-secondary"}return(b,m)=>(a(),l("div",eS,[i.value?(a(),l("div",tS,[s("label",sS,[m[10]||(m[10]=ie(" Template ",-1)),s("button",{type:"button",onClick:m[0]||(m[0]=_=>b.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:m[1]||(m[1]=_=>b.$emit("update:selected-template-id",_.target.value||null)),class:"form-select"},[m[11]||(m[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),l(re,null,ce(n.templates,_=>(a(),l("option",{key:_.template_id,value:_.template_id},y(_.name),9,oS))),128))],40,nS),f.value?(a(),l("div",iS,y(f.value.description),1)):O("",!0)])):O("",!0),s("div",aS,[s("label",rS,[ie(y(o.value?"Template Name":"Session Name")+" ",1),m[12]||(m[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:te(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:m[2]||(m[2]=_=>b.$emit("update:form-data","name",_.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,lS),n.errors.name?(a(),l("div",cS,y(n.errors.name),1)):O("",!0),t.value?(a(),l("div",uS,"Must be a single word (no spaces) for #nametag matching")):O("",!0)]),o.value?(a(),l("div",dS,[m[13]||(m[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:m[3]||(m[3]=_=>b.$emit("update:form-data","description",_.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,mS)])):O("",!0),s("div",pS,[m[16]||(m[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:m[4]||(m[4]=_=>b.$emit("update:form-data","model",_.target.value))},[...m[14]||(m[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,fS),s("div",vS,[r.value&&c.value&&p.value?(a(),l("span",hS,[...m[15]||(m[15]=[ie(" Model change requires a ",-1),s("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):w.value?(a(),l("span",_S,y(w.value.description),1)):O("",!0)])]),s("div",gS,[s("label",bS,[m[17]||(m[17]=ie(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),l("span",yS," < ")):O("",!0),n.fieldStates.permission_mode==="modified"?(a(),l("span",wS," * ")):O("",!0)]),s("select",{id:"config-permission-mode",class:te(["form-select",$.value]),value:n.formData.permission_mode,onChange:m[5]||(m[5]=_=>b.$emit("update:form-data","permission_mode",_.target.value)),disabled:r.value&&!c.value},[m[18]||(m[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),m[19]||(m[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),m[20]||(m[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||d.value?(a(),l("option",kS," Bypass Permissions (No prompts - use with caution) ")):O("",!0)],42,$S),s("div",SS,[r.value&&!c.value?(a(),l("span",ES," Session must be active to change permission mode. Start the session first. ")):(a(),l("span",CS,"Controls which tool actions require permission prompts"))])]),s("div",TS,[s("label",xS,[ie(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),l("span",AS," < ")):O("",!0),n.fieldStates.default_role==="modified"?(a(),l("span",MS," * ")):O("",!0)]),s("input",{id:"config-role",type:"text",class:te(["form-control",g.value]),value:n.formData.default_role,onInput:m[6]||(m[6]=_=>b.$emit("update:form-data","default_role",_.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,OS),s("div",DS,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(a(),l("div",NS,[m[21]||(m[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",LS,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:m[7]||(m[7]=_=>b.$emit("update:form-data","working_directory",_.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,IS),r.value?O("",!0):(a(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:m[8]||(m[8]=_=>b.$emit("open-folder-browser"))}," Browse "))]),s("div",jS,y(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):O("",!0),r.value&&n.session?(a(),l("div",PS,[m[22]||(m[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",RS,[s("span",{class:te(["badge",k(n.session.state)])},y(n.session.state),3)])])):O("",!0),i.value?(a(),l("div",WS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:m[9]||(m[9]=_=>b.$emit("update:form-data","startImmediately",_.target.checked))},null,40,FS),m[23]||(m[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):O("",!0)]))}},HS=ne(BS,[["__scopeId","data-v-b9edc342"]]),VS={class:"permissions-tab"},US={class:"mb-3"},qS={for:"config-allowed-tools",class:"form-label"},zS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},KS={key:1,class:"field-indicator modified",title:"Modified from template"},GS={key:0,class:"tools-list mb-2"},YS=["onClick"],JS={class:"input-group input-group-sm"},QS=["onKeydown"],XS=["disabled"],ZS={class:"mt-2"},eE=["onClick"],tE={class:"form-text"},sE={key:0,class:"text-warning"},nE={key:1},oE={class:"mb-3"},iE={class:"capabilities-editor"},aE={key:0,class:"capabilities-list mb-2"},rE=["onClick"],lE={class:"input-group input-group-sm"},cE=["onKeydown"],uE=["disabled"],dE={key:0,class:"mb-3"},mE={class:"settings-sources-editor"},pE={class:"form-check"},fE=["checked"],vE={class:"form-check"},hE=["checked"],_E={class:"form-check"},gE=["checked"],bE={class:"form-text"},yE={key:0,class:"text-warning"},wE={key:1},$E={key:1,class:"mb-3"},kE={class:"mb-3"},SE={key:0,class:"mt-2"},EE=["value"],CE=["value"],TE={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=P(""),r=P(""),c=P(!1),p=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],d=h(()=>t.mode==="create-template"||t.mode==="edit-template"),f=h(()=>t.mode==="create-session"||t.mode==="edit-session"),u=h(()=>t.mode==="edit-session"),w=h(()=>t.session?.state==="active"||t.session?.state==="starting"),g=h(()=>{if(!t.session)return!1;const T=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==T}),$=h(()=>t.formData.setting_sources||["user","project","local"]),k=h(()=>{if(!t.session)return!1;const T=t.session.setting_sources||["user","project","local"],A=t.formData.setting_sources||["user","project","local"];return JSON.stringify(T.sort())!==JSON.stringify(A.sort())}),b=h(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(T=>T.trim()).filter(T=>T.length>0)),m=h(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(T=>T.trim()).filter(T=>T.length>0)),_=h(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),v=h(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function x(){const T=i.value.trim();if(T){if(!b.value.includes(T)){const A=[...b.value,T];o("update:form-data","allowed_tools",A.join(", "))}i.value=""}}function E(T){const A=[...b.value];A.splice(T,1),o("update:form-data","allowed_tools",A.join(", "))}function R(T){if(b.value.includes(T)){const A=b.value.indexOf(T);E(A)}else{const A=[...b.value,T];o("update:form-data","allowed_tools",A.join(", "))}}function I(){const T=r.value.trim().toLowerCase();if(T){if(!m.value.includes(T)){const A=[...m.value,T];o("update:form-data","capabilities",A.join(", "))}r.value=""}}function D(T){const A=[...m.value];A.splice(T,1),o("update:form-data","capabilities",A.join(", "))}function W(T){const A=[...$.value],U=A.indexOf(T);U>=0?A.splice(U,1):A.push(T),o("update:form-data","setting_sources",A)}return(T,A)=>(a(),l("div",VS,[s("div",US,[s("label",qS,[A[9]||(A[9]=ie(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),l("span",zS," < ")):O("",!0),n.fieldStates.allowed_tools==="modified"?(a(),l("span",KS," * ")):O("",!0)]),s("div",{class:te(["allowed-tools-editor",v.value])},[b.value.length>0?(a(),l("div",GS,[(a(!0),l(re,null,ce(b.value,(U,G)=>(a(),l("span",{key:G,class:"badge bg-primary me-1 mb-1 tool-badge"},[ie(y(U)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>E(G),"aria-label":"Remove tool"},null,8,YS)]))),128))])):O("",!0),s("div",JS,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":A[0]||(A[0]=U=>i.value=U),onKeydown:Ue(ve(x,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,QS),[[Re,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:x,disabled:!i.value.trim()}," Add ",8,XS)]),s("div",ZS,[A[10]||(A[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),l(re,null,ce(p,U=>s("button",{key:U,type:"button",class:te(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":b.value.includes(U)}]),onClick:G=>R(U)},y(U),11,eE)),64))])],2),s("div",tE,[u.value&&w.value&&g.value?(a(),l("span",sE,[...A[11]||(A[11]=[ie(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):(a(),l("span",nE,y(d.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",oE,[A[12]||(A[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",iE,[m.value.length>0?(a(),l("div",aE,[(a(!0),l(re,null,ce(m.value,(U,G)=>(a(),l("span",{key:G,class:"badge bg-info me-1 mb-1 capability-badge"},[ie(y(U)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>D(G),"aria-label":"Remove capability"},null,8,rE)]))),128))])):O("",!0),s("div",lE,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":A[1]||(A[1]=U=>r.value=U),onKeydown:Ue(ve(I,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,cE),[[Re,r.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:I,disabled:!r.value.trim()}," Add ",8,uE)])]),A[13]||(A[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(a(),l("div",dE,[A[18]||(A[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",mE,[s("div",pE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:$.value.includes("user"),onChange:A[2]||(A[2]=U=>W("user"))},null,40,fE),A[14]||(A[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[ie(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",vE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:$.value.includes("project"),onChange:A[3]||(A[3]=U=>W("project"))},null,40,hE),A[15]||(A[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[ie(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",_E,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:$.value.includes("local"),onChange:A[4]||(A[4]=U=>W("local"))},null,40,gE),A[16]||(A[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[ie(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",bE,[u.value&&w.value&&k.value?(a(),l("span",yE,[...A[17]||(A[17]=[ie(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),ie(" to take effect. ",-1)])])):(a(),l("span",wE," Select which settings files to load permissions from "))])])):O("",!0),f.value?(a(),l("div",$E,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:A[5]||(A[5]=U=>T.$emit("preview-permissions"))}," Preview Effective Permissions ")])):O("",!0),s("div",kE,[s("a",{class:"text-muted small",role:"button",onClick:A[6]||(A[6]=U=>c.value=!c.value)},y(c.value?"Hide":"Show")+" raw input ",1),c.value?(a(),l("div",SE,[A[19]||(A[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:te(["form-control form-control-sm",_.value]),value:n.formData.allowed_tools,onInput:A[7]||(A[7]=U=>T.$emit("update:form-data","allowed_tools",U.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,EE),A[20]||(A[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:A[8]||(A[8]=U=>T.$emit("update:form-data","capabilities",U.target.value)),placeholder:"python, testing, debugging"},null,40,CE)])):O("",!0)])]))}},xE=ne(TE,[["__scopeId","data-v-e58aa2be"]]),AE={class:"advanced-tab"},ME={key:0,class:"alert alert-warning mb-3",role:"alert"},OE={class:"mb-3"},DE={for:"config-system-prompt",class:"form-label"},NE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},LE={key:1,class:"field-indicator modified",title:"Modified from template"},IE=["value","rows","placeholder"],jE={class:"form-text"},PE={class:"mb-3 form-check"},RE=["checked"],WE={key:0,class:"form-text text-warning"},FE={key:1,class:"mb-3 form-check"},BE=["checked"],HE={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=h(()=>t.mode==="create-session"||t.mode==="edit-session"),r=h(()=>t.mode==="create-template"||t.mode==="edit-template"),c=h(()=>t.mode==="edit-session"),p=h(()=>t.session?.state==="active"||t.session?.state==="starting"),d=h(()=>{if(!t.session)return!1;const k=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),b=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),m=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return k||b||m}),f=h(()=>r.value?t.formData.system_prompt:t.formData.initialization_context),u=h(()=>r.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),w=h(()=>t.formData.override_system_prompt?r.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":r.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),g=h(()=>{const k={};return t.fieldStates.initialization_context==="autofilled"&&(k["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&(k["field-modified"]=!0),k});function $(k){const b=k.target.value,m=r.value?"system_prompt":"initialization_context";o("update:form-data",m,b)}return(k,b)=>(a(),l("div",AE,[c.value&&p.value&&d.value?(a(),l("div",ME,[...b[2]||(b[2]=[s("small",null,[ie("Changes to these settings require a "),s("strong",null,"reset"),ie(" (not restart) to take effect.")],-1)])])):O("",!0),s("div",OE,[s("label",DE,[ie(y(r.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),l("span",NE," < ")):O("",!0),n.fieldStates.initialization_context==="modified"?(a(),l("span",LE," * ")):O("",!0)]),s("textarea",{id:"config-system-prompt",class:te(["form-control",g.value]),value:f.value,onInput:$,rows:r.value?4:5,placeholder:u.value},null,42,IE),s("div",jE,y(w.value),1)]),s("div",PE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:b[0]||(b[0]=m=>k.$emit("update:form-data","override_system_prompt",m.target.checked))},null,40,RE),b[3]||(b[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),l("div",WE,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(r.value?"":" or legion guide")+").",1)])):O("",!0)]),i.value?(a(),l("div",FE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:b[1]||(b[1]=m=>k.$emit("update:form-data","sandbox_enabled",m.target.checked))},null,40,BE),b[4]||(b[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:te(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):O("",!0)]))}},VE=ne(HE,[["__scopeId","data-v-08b1f06d"]]),UE={class:"modal-dialog modal-lg"},qE={class:"modal-content"},zE={class:"modal-body"},KE={key:0,class:"text-center py-4"},GE={key:1,class:"alert alert-danger"},YE={key:2},JE={class:"mb-3"},QE={class:"small text-muted mb-2"},XE={key:0},ZE={key:0,class:"alert alert-info"},e0={key:1},t0={class:"table table-sm table-striped"},s0={key:2,class:"mt-3"},n0={class:"modal-footer"},o0=["disabled"],i0={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=P(null);let c=null;const p=P(!1),d=P(""),f=P([]);fe(r,b=>{b&&(c=new pt(b),b.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){c&&(c.show(),g())}function w(){c&&c.hide()}async function g(){p.value=!0,d.value="",f.value=[];try{const b=await me.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),d.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{p.value=!1}}function $(){g()}function k(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:w}),(b,m)=>(a(),l("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",UE,[s("div",qE,[m[7]||(m[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",zE,[p.value?(a(),l("div",KE,[...m[0]||(m[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):d.value?(a(),l("div",GE,y(d.value),1)):(a(),l("div",YE,[s("div",JE,[m[2]||(m[2]=s("h6",null,"Settings Sources",-1)),s("div",QE,[m[1]||(m[1]=ie(" Loading permissions from: ",-1)),(a(!0),l(re,null,ce(n.settingSources,(_,v)=>(a(),l("span",{key:_},[s("code",null,y(_),1),v<n.settingSources.length-1?(a(),l("span",XE,", ")):O("",!0)]))),128))])]),f.value.length===0?(a(),l("div",ZE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),l("div",e0,[s("h6",null,"Pre-approved Permissions ("+y(f.value.length)+")",1),s("table",t0,[m[3]||(m[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(a(!0),l(re,null,ce(f.value,_=>(a(),l("tr",{key:_.permission},[s("td",null,[s("code",null,y(_.permission),1)]),s("td",null,[(a(!0),l(re,null,ce(_.sources,(v,x)=>(a(),l("span",{key:v,class:te(["badge me-1",k(v)])},y(v),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),l("div",s0,[m[4]||(m[4]=s("h6",null,"Session Allowed Tools",-1)),m[5]||(m[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(a(!0),l(re,null,ce(n.sessionAllowedTools,_=>(a(),l("span",{key:_,class:"badge bg-success me-1 mb-1"},y(_),1))),128))])])):O("",!0)]))]),s("div",n0,[m[6]||(m[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:$,disabled:p.value}," Refresh ",8,o0)])])])],512))}},a0=ne(i0,[["__scopeId","data-v-988ff7c4"]]),r0={class:"modal-dialog modal-lg modal-dialog-centered"},l0={class:"modal-content"},c0={class:"modal-header"},u0={id:"configurationModalLabel",class:"modal-title"},d0={class:"modal-body"},m0={key:0,class:"template-list-view"},p0={key:0,class:"alert alert-info"},f0={class:"card-body"},v0={class:"d-flex justify-content-between align-items-start"},h0={class:"flex-grow-1"},_0={class:"card-title mb-1"},g0={key:0,class:"card-text text-muted small mb-2"},b0={class:"template-meta"},y0={class:"badge bg-secondary me-2"},w0={class:"text-muted small"},$0={class:"btn-group btn-group-sm ms-3"},k0=["onClick"],S0=["onClick"],E0={key:1},C0={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},T0={class:"nav-item",role:"presentation"},x0={key:0,class:"error-indicator",title:"This tab has validation errors"},A0={class:"nav-item",role:"presentation"},M0={key:0,class:"error-indicator",title:"This tab has validation errors"},O0={class:"nav-item",role:"presentation"},D0={key:0,class:"error-indicator",title:"This tab has validation errors"},N0={class:"tab-content"},L0={key:2,class:"alert alert-danger mt-3"},I0={class:"modal-footer"},j0={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},P0=["disabled"],R0={key:0,class:"spinner-border spinner-border-sm me-2"},W0={__name:"ConfigurationModal",setup(n){const e=Ft(),t=Ie(),o=de(),i=_e(),r=P(null);let c=null;const p=P(null),d=P("create-session"),f=P("general"),u=P(null),w=P(null),g=P(null),$=P([]),k=P(null),b=P(null),m=P({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),_=ws({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),v=ws({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),x=ws({name:""}),E=h(()=>({general:!!x.name,permissions:!1,advanced:!1})),R=P(!1),I=P(""),D=h(()=>d.value==="create-session"||d.value==="edit-session"),W=h(()=>d.value==="edit-session"||d.value==="edit-template"),T=h(()=>{switch(d.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),A=h(()=>R.value?W.value?"Saving...":"Creating...":W.value?"Save Changes":D.value?"Create Session":"Save Template"),U=h(()=>!(!v.name.trim()||D.value&&v.name.includes(" "))),G=h(()=>w.value?.working_directory?w.value.working_directory:v.working_directory?v.working_directory:t.projects.get(u.value)?.working_directory||""),L=h(()=>!v.allowed_tools||!v.allowed_tools.trim()?[]:v.allowed_tools.split(",").map(z=>z.trim()).filter(z=>z.length>0));function F(){p.value&&p.value.show()}function q(z,le){v[z]=le,z==="name"&&(x.name="")}function Z(z){k.value=z,S()}async function N(){try{const z=await me.get("/api/templates");$.value=z||[]}catch(z){console.error("Failed to load templates:",z),$.value=[]}}function S(){if(!k.value){v.default_role="",v.initialization_context="",v.permission_mode="default",v.allowed_tools="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const z=$.value.find(le=>le.template_id===k.value);if(z)if(_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",z.default_role?(v.default_role=z.default_role,m.value.default_role=z.default_role,_.default_role="autofilled"):(v.default_role="",m.value.default_role=null),z.default_system_prompt?(v.initialization_context=z.default_system_prompt,m.value.initialization_context=z.default_system_prompt,_.initialization_context="autofilled"):(v.initialization_context="",m.value.initialization_context=null),z.permission_mode?(v.permission_mode=z.permission_mode,m.value.permission_mode=z.permission_mode,_.permission_mode="autofilled"):(v.permission_mode="default",m.value.permission_mode=null),z.allowed_tools&&z.allowed_tools.length>0){const le=z.allowed_tools.join(", ");v.allowed_tools=le,m.value.allowed_tools=le,_.allowed_tools="autofilled"}else v.allowed_tools="",m.value.allowed_tools=null}function C(){const le=(u.value?t.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:le,currentPath:v.working_directory||"",onSelect:ue=>{v.working_directory=ue}})}function M(){d.value==="create-session"&&(b.value={mode:"create-session",projectId:u.value,formData:{...v},selectedTemplateId:k.value}),d.value="template-list",ee()}function V(){d.value="create-template",ee(),f.value="general"}function K(z){d.value="edit-template",g.value=z,ee(),he(z),f.value="general"}async function J(z){if(confirm(`Delete template "${z.name}"?

This action cannot be undone.`))try{await me.delete(`/api/templates/${z.template_id}`),await N()}catch(le){console.error("Failed to delete template:",le),I.value=le.response?.data?.detail||"Failed to delete template"}}function Q(){let z=!0;return x.name="",v.name.trim()||(x.name="Name is required",z=!1),D.value&&v.name.includes(" ")&&(x.name="Session name must be a single word (no spaces)",z=!1),z}async function se(){if(!Q()){x.name&&(f.value="general");return}R.value=!0,I.value="";try{switch(d.value){case"create-session":await X(),c&&c.hide();break;case"edit-session":await B(),c&&c.hide();break;case"create-template":await j();break;case"edit-template":await H();break}}catch(z){console.error("Submit failed:",z),I.value=z.response?.data?.detail||z.message||"Operation failed. Please try again."}finally{R.value=!1}}async function X(){if(!u.value)throw new Error("Project ID is missing");const z=v.allowed_tools.split(",").map(Pe=>Pe.trim()).filter(Pe=>Pe.length>0),le=v.capabilities.split(",").map(Pe=>Pe.trim()).filter(Pe=>Pe.length>0),ue={name:v.name.trim(),model:v.model||null,role:v.default_role.trim()||null,initialization_context:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,capabilities:le.length>0?le:null,permission_mode:v.permission_mode,allowed_tools:z.length>0?z:null,working_directory:v.working_directory.trim()||null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources},Ce=await me.post(`/api/legions/${u.value}/minions`,ue);if(Ce.success&&Ce.minion_id)await t.fetchProjects(),await o.fetchSessions(),v.startImmediately&&await o.startSession(Ce.minion_id),e.push(`/session/${Ce.minion_id}`);else throw new Error("Failed to create session")}async function B(){if(!w.value)throw new Error("Session data is missing");const z=w.value.session_id,le=w.value.state==="active"||w.value.state==="starting",ue=v.allowed_tools.split(",").map(we=>we.trim()).filter(we=>we.length>0),Ce=v.capabilities.split(",").map(we=>we.trim()).filter(we=>we.length>0),Pe={name:v.name.trim(),model:v.model,role:v.default_role.trim()||null,system_prompt:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,allowed_tools:ue.length>0?ue:null,capabilities:Ce.length>0?Ce:null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources};await o.patchSession(z,Pe),le&&v.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(z,v.permission_mode)}async function j(){const z=v.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),le={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:z.length>0?z:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null};await me.post("/api/templates",le),await N(),d.value="template-list",ee()}async function H(){if(!g.value)throw new Error("Template data is missing");const z=v.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),le={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:z.length>0?z:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null};await me.put(`/api/templates/${g.value.template_id}`,le),await N(),d.value="template-list",g.value=null,ee()}function ee(){v.name="",v.model="sonnet",v.permission_mode="default",v.working_directory="",v.description="",v.default_role="",v.startImmediately=!0,v.allowed_tools="",v.capabilities="",v.setting_sources=["user","project","local"],v.system_prompt="",v.override_system_prompt=!1,v.initialization_context="",v.sandbox_enabled=!1,x.name="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},k.value=null,I.value="",f.value="general"}function oe(z){v.name=z.name||"",v.model=z.model||"sonnet",v.permission_mode=z.current_permission_mode||"default",v.working_directory=z.working_directory||"",v.default_role=z.role||"",v.initialization_context=z.system_prompt||"",v.override_system_prompt=z.override_system_prompt||!1,v.system_prompt="",v.allowed_tools=z.allowed_tools?.join(", ")||"",v.capabilities=z.capabilities?.join(", ")||"",v.sandbox_enabled=z.sandbox_enabled||!1,v.setting_sources=z.setting_sources||["user","project","local"]}function he(z){v.name=z.name||"",v.description=z.description||"",v.permission_mode=z.permission_mode||"default",v.default_role=z.default_role||"",v.initialization_context=z.default_system_prompt||"",v.allowed_tools=z.allowed_tools?.join(", ")||""}function at(){kt(()=>{const z=document.getElementById("config-name");z&&(z.focus(),W.value&&z.select())})}function Fe(){ee(),d.value="create-session",u.value=null,w.value=null,g.value=null,i.hideModal()}return fe(()=>i.currentModal,async(z,le)=>{if(!(!z||!c)){if(z.name==="configuration"){const ue=z.data||{};d.value=ue.mode||"create-session",u.value=ue.project?.project_id||ue.projectId||null,w.value=ue.session||null,g.value=ue.template||null,ee(),d.value==="create-session"&&await N(),d.value==="edit-session"&&w.value?oe(w.value):d.value==="edit-template"&&g.value&&he(g.value),c.show()}else if(z.name==="create-minion"||z.name==="create-session"){const ue=z.data||{};d.value="create-session",u.value=ue.project?.project_id||null,w.value=null,g.value=null,ee(),await N(),c.show()}else if(z.name==="edit-session"){const ue=z.data||{};d.value="edit-session",w.value=ue.session||null,u.value=w.value?.project_id||null,g.value=null,ee(),w.value&&oe(w.value),c.show()}else z.name==="template-management"&&(d.value="template-list",ee(),await N(),c.show());le?.name==="configuration"&&le.data?.mode?.includes("template")&&z?.name==="configuration"&&d.value==="create-session"&&await N()}}),fe(()=>v.default_role,z=>{m.value.default_role!==null&&(_.default_role=z===m.value.default_role?"autofilled":"modified")}),fe(()=>v.initialization_context,z=>{m.value.initialization_context!==null&&(_.initialization_context=z===m.value.initialization_context?"autofilled":"modified")}),fe(()=>v.permission_mode,z=>{m.value.permission_mode!==null&&(_.permission_mode=z===m.value.permission_mode?"autofilled":"modified")}),fe(()=>v.allowed_tools,z=>{m.value.allowed_tools!==null&&(_.allowed_tools=z===m.value.allowed_tools?"autofilled":"modified")}),ye(()=>{r.value&&Te(()=>import("./modal-D6mKceGM.js").then(z=>z.m),__vite__mapDeps([0,1])).then(z=>{const le=z.default;c=new le(r.value),r.value.addEventListener("shown.bs.modal",at),r.value.addEventListener("hidden.bs.modal",Fe)})}),Se(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",at),r.value.removeEventListener("hidden.bs.modal",Fe)),c&&c.dispose()}),(z,le)=>(a(),l(re,null,[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",r0,[s("div",l0,[s("div",c0,[s("h5",u0,[d.value==="create-template"||d.value==="edit-template"?(a(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:M,title:"Back to template list"}," â† ")):O("",!0),ie(" "+y(T.value),1)]),le[3]||(le[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",d0,[d.value==="template-list"?(a(),l("div",m0,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[le[4]||(le[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:V,class:"btn btn-primary btn-sm"}," + Create New ")]),$.value.length===0?(a(),l("div",p0," No templates found. Create your first template! ")):O("",!0),(a(!0),l(re,null,ce($.value,ue=>(a(),l("div",{key:ue.template_id,class:"card mb-2"},[s("div",f0,[s("div",v0,[s("div",h0,[s("h6",_0,y(ue.name),1),ue.description?(a(),l("p",g0,y(ue.description),1)):O("",!0),s("div",b0,[s("span",y0,y(ue.permission_mode),1),s("span",w0,y(ue.allowed_tools?.length||0)+" tools",1)])]),s("div",$0,[s("button",{onClick:Ce=>K(ue),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,k0),s("button",{onClick:Ce=>J(ue),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,S0)])])])]))),128))])):(a(),l("div",E0,[s("ul",C0,[s("li",T0,[s("button",{class:te(["nav-link",{active:f.value==="general","has-error":E.value.general}]),type:"button",onClick:le[0]||(le[0]=ue=>f.value="general")},[le[5]||(le[5]=ie(" General ",-1)),E.value.general?(a(),l("span",x0)):O("",!0)],2)]),s("li",A0,[s("button",{class:te(["nav-link",{active:f.value==="permissions","has-error":E.value.permissions}]),type:"button",onClick:le[1]||(le[1]=ue=>f.value="permissions")},[le[6]||(le[6]=ie(" Permissions ",-1)),E.value.permissions?(a(),l("span",M0)):O("",!0)],2)]),s("li",O0,[s("button",{class:te(["nav-link",{active:f.value==="advanced","has-error":E.value.advanced}]),type:"button",onClick:le[2]||(le[2]=ue=>f.value="advanced")},[le[7]||(le[7]=ie(" Advanced ",-1)),E.value.advanced?(a(),l("span",D0)):O("",!0)],2)])]),s("div",N0,[ge(pe(HS,{mode:d.value,"form-data":v,errors:x,templates:$.value,"selected-template-id":k.value,session:w.value,"field-states":_,"onUpdate:formData":q,"onUpdate:selectedTemplateId":Z,onOpenFolderBrowser:C,onOpenTemplateManager:M},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ys,f.value==="general"]]),ge(pe(xE,{mode:d.value,"form-data":v,errors:x,session:w.value,"field-states":_,"onUpdate:formData":q,onPreviewPermissions:F},null,8,["mode","form-data","errors","session","field-states"]),[[ys,f.value==="permissions"]]),ge(pe(VE,{mode:d.value,"form-data":v,errors:x,session:w.value,"field-states":_,"onUpdate:formData":q},null,8,["mode","form-data","errors","session","field-states"]),[[ys,f.value==="advanced"]])])])),I.value?(a(),l("div",L0,y(I.value),1)):O("",!0)]),s("div",I0,[s("button",j0,y(d.value==="template-list"?"Close":"Cancel"),1),d.value!=="template-list"?(a(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:R.value||!U.value,onClick:se},[R.value?(a(),l("span",R0)):O("",!0),ie(" "+y(A.value),1)],8,P0)):O("",!0)])])])],512),pe(a0,{ref_key:"permissionPreviewModal",ref:p,"working-directory":G.value,"setting-sources":v.setting_sources,"session-allowed-tools":L.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},F0=ne(W0,[["__scopeId","data-v-098a9c63"]]),B0={class:"modal-dialog modal-dialog-centered"},H0={class:"modal-content"},V0={class:"modal-header"},U0={class:"modal-title",id:"manageSessionModalLabel"},q0={class:"modal-body"},z0={key:0,class:"text-center py-4"},K0={class:"text-muted"},G0={key:1},Y0={key:2},J0={class:"text-muted"},Q0={key:0,class:"text-center py-2"},X0={key:1,class:"alert alert-warning mt-3"},Z0={class:"mb-0 mt-2"},eC={key:0,class:"text-muted"},tC={key:3},sC={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},nC={class:"d-grid gap-2"},oC=["disabled"],iC=["disabled"],aC=["disabled"],rC=["disabled"],lC={class:"modal-footer"},cC={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},uC={__name:"SessionManageModal",setup(n){const e=Ft(),t=de(),o=_e(),i=st();xe();const r=P(null),c=P(!1),p=P(""),d=P(""),f=P(null),u=P(null);let w=null;const g=P([]),$=P(!1),k=h(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function b(){f.value="reset"}async function m(){if(f.value="delete",g.value=[],!!r.value){$.value=!0;try{const T=await me.get(`/api/sessions/${r.value.session_id}/descendants`);g.value=T.descendants||[]}catch(T){console.error("Failed to fetch descendants:",T),g.value=[]}finally{$.value=!1}}}function _(){f.value=null}async function v(){f.value==="reset"?await R():f.value==="delete"&&await I()}async function x(){if(r.value){c.value=!0,p.value="Restarting session...";try{const T=r.value.session_id,A=t.currentSessionId===T,U=await me.post(`/api/sessions/${T}/restart`);if(U.success)console.log("Session restarted successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(T)),w&&w.hide();else{const G=U.error||U.detail||"Failed to restart session";console.error("Failed to restart session:",G),d.value=`Failed to restart session: ${G}`}}catch(T){console.error("Error restarting session:",T);const A=T.data?.detail||T.message||"Unknown error";d.value=`Error restarting session: ${A}`}finally{c.value=!1}}}async function E(){if(r.value)try{w&&w.hide(),console.log("Ending session",r.value.session_id);const T=r.value.session_id;await me.post(`/api/sessions/${T}/terminate`),t.currentSessionId===T&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(T){console.error("Error ending session:",T),t.currentSessionId===r.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function R(){if(r.value){c.value=!0,p.value="Resetting session...";try{const T=r.value.session_id,A=t.currentSessionId===T,U=await me.post(`/api/sessions/${T}/reset`);if(U.success)console.log("Session reset successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(T)),w&&w.hide();else{const G=U.error||U.detail||"Failed to reset session";console.error("Failed to reset session:",G),d.value=`Failed to reset session: ${G}`,f.value=null}}catch(T){console.error("Error resetting session:",T);const A=T.data?.detail||T.message||"Unknown error";d.value=`Error resetting session: ${A}`,f.value=null}finally{c.value=!1}}}async function I(){if(r.value){c.value=!0,p.value="Deleting session...";try{const T=r.value.session_id;await t.deleteSession(T),e.currentRoute.value.params.sessionId===T&&e.push("/"),w&&w.hide()}catch(T){console.error("Error deleting session:",T);const A=T.data?.detail||T.message||"Unknown error";d.value=`Error deleting session: ${A}`,f.value=null}finally{c.value=!1}}}function D(){f.value=null,c.value=!1,p.value="",d.value="",g.value=[],$.value=!1}function W(){D(),r.value=null,o.hideModal()}return fe(()=>o.currentModal,T=>{if(T?.name==="manage-session"&&w){const A=T.data||{};r.value=A.session,D(),w.show()}}),ye(()=>{u.value&&Te(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(A=>A.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{w=new T(u.value),u.value.addEventListener("hidden.bs.modal",W)})}),Se(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",W),w&&w.dispose()}),(T,A)=>(a(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",B0,[s("div",H0,[s("div",V0,[s("h5",U0,y(f.value?k.value:"Manage Session"),1),A[1]||(A[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",q0,[c.value?(a(),l("div",z0,[A[2]||(A[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",K0,y(p.value),1)])):f.value==="reset"?(a(),l("div",G0,[...A[3]||(A[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(a(),l("div",Y0,[A[9]||(A[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",J0,[A[4]||(A[4]=ie("This will permanently delete session ",-1)),s("strong",null,y(r.value?.name),1),A[5]||(A[5]=ie(".",-1))]),A[10]||(A[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),$.value?(a(),l("div",Q0,[...A[6]||(A[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(a(),l("div",X0,[A[7]||(A[7]=s("strong",null,"Cascading Deletion:",-1)),A[8]||(A[8]=ie(" This session has ",-1)),s("strong",null,y(g.value.length),1),ie(" child session"+y(g.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",Z0,[(a(!0),l(re,null,ce(g.value,U=>(a(),l("li",{key:U.session_id,class:"small"},[s("strong",null,y(U.name||U.session_id),1),U.role?(a(),l("span",eC," ("+y(U.role)+")",1)):O("",!0)]))),128))])])):O("",!0)])):(a(),l("div",tC,[d.value?(a(),l("div",sC,[A[11]||(A[11]=s("strong",null,"Error:",-1)),ie(" "+y(d.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:A[0]||(A[0]=U=>d.value="")})])):O("",!0),A[18]||(A[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",nC,[s("button",{class:"btn btn-outline-primary text-start",onClick:x,disabled:c.value},[...A[12]||(A[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,oC),s("button",{class:"btn btn-outline-secondary text-start",onClick:E,disabled:c.value},[...A[13]||(A[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,iC),A[16]||(A[16]=s("hr",{class:"my-2"},null,-1)),A[17]||(A[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:c.value},[...A[14]||(A[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,aC),s("button",{class:"btn btn-outline-danger text-start",onClick:m,disabled:c.value},[...A[15]||(A[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,rC)]),A[19]||(A[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ie(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",lC,[f.value&&!c.value?(a(),l(re,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),s("button",{type:"button",class:te(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:v},y(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?O("",!0):(a(),l("button",cC,"Cancel"))])])])],512))}},dC=ne(uC,[["__scopeId","data-v-6b832853"]]),mC={class:"modal-dialog modal-dialog-centered modal-lg"},pC={class:"modal-content"},fC={class:"modal-body"},vC={key:0,class:"text-center text-muted py-4"},hC={key:1},_C={class:"mb-3"},gC={class:"font-monospace small"},bC={class:"mb-3"},yC=["value"],wC={class:"mb-3"},$C={class:"mb-3"},kC={class:"mb-3"},SC={key:0},EC={class:"d-flex flex-wrap gap-1"},CC={key:1,class:"text-muted small"},TC={key:0,class:"mb-3"},xC={class:"d-flex flex-wrap gap-1"},AC={key:1,class:"mb-3"},MC={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},OC={class:"mb-3"},DC={class:"text-muted"},NC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},LC={__name:"SessionInfoModal",setup(n){const e=de(),t=xe(),o=_e(),i=P(null),r=P(!1),c=P(null);let p=null;const d={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=h(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(t.messagesBySession.get(i.value)||[]).find(v=>v.type==="system"&&(v.subtype==="init"||v.metadata?.subtype==="init")&&v.metadata?.init_data)?.metadata?.init_data||null});function u(b){return b?d[b]||b:"Default (Sonnet 4.5)"}function w(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function g(b){b.target.select()}function $(){i.value=null,r.value=!1}function k(){$(),o.hideModal()}return fe(()=>o.currentModal,b=>{if(b?.name==="session-info"&&p){const m=b.data||{};i.value=m.sessionId,r.value=!1,p.show()}}),ye(()=>{c.value&&Te(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(m=>m.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{p=new b(c.value),c.value.addEventListener("hidden.bs.modal",k)})}),Se(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",k),p&&p.dispose()}),(b,m)=>(a(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",mC,[s("div",pC,[m[9]||(m[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",fC,[f.value?(a(),l("div",hC,[s("div",_C,[m[1]||(m[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",gC,y(i.value),1)]),s("div",bC,[m[2]||(m[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:g},null,8,yC)]),s("div",wC,[m[3]||(m[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,y(u(f.value.model)),1)]),s("div",$C,[m[4]||(m[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,y(f.value.permissionMode||"default"),1)]),s("div",kC,[m[5]||(m[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(a(),l("div",SC,[s("div",EC,[(a(!0),l(re,null,ce(f.value.allowed_tools||f.value.tools,_=>(a(),l("span",{key:_,class:"badge bg-secondary"},y(_),1))),128))])])):(a(),l("div",CC,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(a(),l("div",TC,[m[6]||(m[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",xC,[(a(!0),l(re,null,ce(f.value.commands,_=>(a(),l("span",{key:_,class:"badge bg-info"},y(_),1))),128))])])):O("",!0),f.value.systemPrompt?(a(),l("div",AC,[m[7]||(m[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",MC,y(w(f.value.systemPrompt)),1)])):O("",!0),s("div",OC,[s("h6",DC,[m[8]||(m[8]=ie(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:m[0]||(m[0]=_=>r.value=!r.value)},y(r.value?"Hide":"Show"),1)]),r.value?(a(),l("pre",NC,y(JSON.stringify(f.value,null,2)),1)):O("",!0)])])):(a(),l("div",vC," No session configuration data available "))]),m[10]||(m[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},IC=ne(LC,[["__scopeId","data-v-b28b39b3"]]),jC={class:"modal-dialog modal-dialog-centered modal-lg"},PC={class:"modal-content"},RC={class:"modal-body"},WC={key:0,class:"text-center text-muted py-4"},FC={key:1},BC={class:"mb-3"},HC={class:"mb-3"},VC={class:"font-monospace small"},UC={class:"mb-3"},qC={class:"mb-3"},zC={class:"mb-3"},KC={key:0},GC={class:"d-flex flex-wrap gap-1"},YC={key:1,class:"text-muted small"},JC={class:"mb-3"},QC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},XC={key:1,class:"text-muted small"},ZC={class:"mb-3"},eT={key:0,class:"badge bg-info"},tT={key:1,class:"badge bg-secondary"},sT={class:"mb-3"},nT={key:0,class:"font-monospace small"},oT={key:1,class:"text-muted small"},iT={key:0,class:"mb-3"},aT={key:0},rT={class:"list-unstyled mb-0"},lT={key:1,class:"text-muted small"},cT={class:"mb-3"},uT={class:"small"},dT={class:"mb-3"},mT={class:"small"},pT={__name:"MinionViewModal",setup(n){const e=_e(),t=P(null),o=P(null);let i=null;function r(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function c(f){if(!f)return"N/A";try{const u=new Date(f);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function p(){t.value=null}function d(){p(),e.hideModal()}return fe(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const u=f.data||{};t.value=u.session,i.show()}}),ye(()=>{o.value&&Te(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",d)})}),Se(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",d),i&&i.dispose()}),(f,u)=>(a(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",jC,[s("div",PC,[u[11]||(u[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",RC,[t.value?(a(),l("div",FC,[s("div",BC,[u[0]||(u[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,y(t.value.name||"Unnamed Minion"),1)]),s("div",HC,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",VC,y(t.value.session_id),1)]),s("div",UC,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,y(t.value.role||"Not specified"),1)]),s("div",qC,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:te(["badge",r(t.value.state)])},y(t.value.state),3)])]),s("div",zC,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(a(),l("div",KC,[s("div",GC,[(a(!0),l(re,null,ce(t.value.capabilities,w=>(a(),l("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(a(),l("div",YC,"None"))]),s("div",JC,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(a(),l("div",QC,y(t.value.initialization_context),1)):(a(),l("div",XC,"Not specified"))]),s("div",ZC,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(a(),l("span",eT,"Yes")):(a(),l("span",tT,"No"))])]),s("div",sT,[u[7]||(u[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(a(),l("div",nT,y(t.value.parent_overseer_id),1)):(a(),l("div",oT," Root overseer (user-created) "))]),t.value.is_overseer?(a(),l("div",iT,[u[8]||(u[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(a(),l("div",aT,[s("ul",rT,[(a(!0),l(re,null,ce(t.value.child_minion_ids,w=>(a(),l("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(a(),l("div",lT,"No children"))])):O("",!0),s("div",cT,[u[9]||(u[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",uT,y(c(t.value.created_at)),1)]),s("div",dT,[u[10]||(u[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",mT,y(c(t.value.updated_at)),1)])])):(a(),l("div",WC," No minion data available "))]),u[12]||(u[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},fT=ne(pT,[["__scopeId","data-v-d996dc6f"]]),vT={class:"container-fluid vh-100 d-flex flex-column p-0"},hT={class:"d-flex flex-grow-1 overflow-hidden position-relative"},_T={class:"flex-grow-1 d-flex flex-column overflow-hidden"},gT={__name:"App",setup(n){const e=_e(),t=st(),o=de(),i=Ie(),r=$t(),c=Qe(),p=Ft(),d=P(null);function f(m){d.value=m}gn("addAttachmentFromResource",f),gn("pendingResourceAttachment",d);const u=h(()=>e.sidebarCollapsed),w=h(()=>e.rightSidebarCollapsed),g=h(()=>e.isMobile);fe(()=>r.currentHasTasks,(m,_)=>{m&&!_&&e.setRightSidebarCollapsed(!1)}),fe(()=>c.currentHasResources,(m,_)=>{m&&!_&&e.setRightSidebarCollapsed(!1)}),ye(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const m=window.location.hash;if(m.startsWith("#/session/")){const _=m.replace("#/session/","");o.sessions.has(_)&&await o.selectSession(_)}else if(m.startsWith("#/timeline/")){const _=m.replace("#/timeline/","");p.push(`/timeline/${_}`)}window.addEventListener("popstate",$),window.addEventListener("resize",e.handleResize)}),Se(()=>{window.removeEventListener("popstate",$),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function $(){const m=window.location.hash;if(m.startsWith("#/session/")){const _=m.replace("#/session/","");o.sessions.has(_)&&o.selectSession(_)}}function k(){e.toggleSidebar()}function b(){e.toggleRightSidebar()}return(m,_)=>{const v=vo("router-view");return a(),l("div",vT,[pe(_w),s("div",{id:"sidebar-backdrop",class:te({show:!u.value&&g.value}),onClick:k},null,2),s("div",{id:"right-sidebar-backdrop",class:te({show:!w.value&&g.value}),onClick:b},null,2),s("div",hT,[pe(Kw),s("main",_T,[pe(v)]),pe(X$)]),pe(vk),pe(Ok),pe(Zk),pe(F0),pe(dC),pe(IC),pe(fT)])}}},un=Oi(gT);un.use(Di());un.use(lw);un.mount("#app");
