const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as t,o as u,d as yt,r as N,b,t as $,n as We,e as Y,f as K,u as Xt,w as le,g as vn,h as I,F as ie,i as ce,j as ge,k as oo,l as se,v as ue,m as ae,p as me,q as ns,s as Ns,x as Qt,y as be,z as ve,A as Oe,B as io,C as fi,D as vi,E as Ye,T as ao,G as At,H as hi,I as _i}from"./vue-vendor-yyuQCQ7n.js";import{m as Ot,p as Ws}from"./markdown-vendor-CQ3OZdP9.js";import{c as gi}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();const bi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},yi={__name:"NoSessionSelected",setup(n){return(e,s)=>(u(),m("div",bi,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},$i="modulepreload",wi=function(n){return"/"+n},hn={},ye=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let d=function(p){return Promise.all(p.map(c=>Promise.resolve(c).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),r=l?.nonce||l?.getAttribute("nonce");i=d(s.map(p=>{if(p=wi(p),p in hn)return;hn[p]=!0;const c=p.endsWith(".css"),_=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${_}`))return;const v=document.createElement("link");if(v.rel=c?"stylesheet":$i,c||(v.as="script"),v.crossOrigin="",v.href=p,r&&v.setAttribute("nonce",r),document.head.appendChild(v),c)return new Promise((f,C)=>{v.addEventListener("load",f),v.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return i.then(l=>{for(const r of l||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})};class ps extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Nt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new ps(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof ps?s:(console.error("API request failed:",s),new ps(`Network error: ${s.message}`,0,null))}}async function Ei(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[r,d]of Object.entries(e.params))d!=null&&o.append(r,d);const i=o.toString();i&&(s=`${n}?${i}`);const{params:a,...l}=e;return Nt(s,{...l,method:"GET"})}return Nt(s,{...e,method:"GET"})}async function Ci(n,e,s={}){return Nt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Si(n,e,s={}){return Nt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function ki(n,e={}){return Nt(n,{...e,method:"DELETE"})}const te={get:Ei,post:Ci,put:Si,delete:ki},oe=yt("session",()=>{const n=N(new Map),e=N(null),s=N(new Map),o=N(new Map),i=N(new Set),a=N(!1);let l=null;const r=b(()=>n.value.get(e.value)),d=b(()=>Array.from(n.value.values()).sort((k,D)=>k.order-D.order)),p=k=>b(()=>d.value.filter(D=>D.project_id===k)),c=b({get:()=>s.value.get(e.value)||"",set:k=>{e.value&&s.value.set(e.value,k)}});async function _(){try{const k=await te.get("/api/sessions");return n.value.clear(),k.sessions.forEach(D=>{n.value.set(D.session_id,D)}),console.log(`Loaded ${n.value.size} sessions`),k.sessions}catch(k){throw console.error("Failed to fetch sessions:",k),k}}async function v(k,D){try{const x=(await te.post("/api/sessions",{project_id:k,...D})).session_id,w=(await te.get(`/api/sessions/${x}`)).session;return n.value.set(x,w),n.value=new Map(n.value),console.log(`Created session ${x}`),w}catch(F){throw console.error("Failed to create session:",F),F}}async function f(k){if(e.value===k&&!a.value)return;l&&(console.log(`Aborting pending selection to switch to ${k}`),l.abort(),l=null);const D=new AbortController;l=D,a.value=!0;try{if(e.value=k,D.signal.aborted){console.log(`Selection of ${k} aborted early`);return}let F=n.value.get(k);if(!F)try{const w=await te.get(`/api/sessions/${k}`);if(D.signal.aborted){console.log(`Selection of ${k} aborted after fetch`);return}F=w.session,n.value.set(k,F),n.value=new Map(n.value),console.log(`Fetched session ${k} for deeplink`)}catch(w){console.error(`Failed to fetch session ${k}:`,w);return}if(F&&(F.state==="created"||F.state==="terminated"))try{if(await M(k),D.signal.aborted){console.log(`Selection of ${k} aborted after start`);return}console.log(`Auto-started session ${k} (was in ${F.state} state)`);const w=6e4,O=200,P=5e3;let j=0,U=0;for(;j<w;){if(D.signal.aborted){console.log(`Selection of ${k} aborted during state wait`);return}const ne=n.value.get(k);if(ne&&ne.state==="active"){console.log(`Session ${k} is now active after ${j}ms`);break}if(j-U>=P){const B=n.value.get(k)?.state||"unknown";console.log(`Waiting for session ${k} to become active (current: ${B}, ${j/1e3}s elapsed)`),U=j}await new Promise(B=>setTimeout(B,O)),j+=O}const q=n.value.get(k);q&&q.state!=="active"&&console.warn(`Session ${k} did not become active within ${w/1e3}s (state: ${q.state}), continuing anyway`)}catch(w){console.error(`Failed to auto-start session ${k}:`,w)}if(D.signal.aborted){console.log(`Selection of ${k} aborted before message load`);return}if(await(await ye(()=>Promise.resolve().then(()=>zi),void 0)).useMessageStore().loadMessages(k),D.signal.aborted){console.log(`Selection of ${k} aborted after message load`);return}await(await ye(()=>Promise.resolve().then(()=>ma),void 0)).useWebSocketStore().connectSession(k),D.signal.aborted||console.log(`Selected session ${k}`)}finally{l===D&&(l=null),a.value=!1}}function C(k,D){const F=n.value.get(k);F?Object.assign(F,D):(n.value.set(k,D),console.log(`Added new session ${k} via WebSocket update`)),n.value=new Map(n.value)}async function y(k){i.value.add(k);try{await te.delete(`/api/sessions/${k}`),n.value.delete(k),s.value.delete(k),o.value.delete(k),n.value=new Map(n.value),e.value===k&&(e.value=null),console.log(`Deleted session ${k}`)}catch(D){throw console.error("Failed to delete session:",D),D}finally{i.value.delete(k)}}async function g(k,D){try{await te.put(`/api/sessions/${k}/name`,{name:D}),C(k,{name:D}),console.log(`Updated session ${k} name to "${D}"`)}catch(F){throw console.error("Failed to update session name:",F),F}}async function h(k,D){try{await te.post(`/api/sessions/${k}/permission-mode`,{mode:D}),C(k,{current_permission_mode:D});const F=o.value.get(k);F&&(F.permissionMode=D,o.value.set(k,F)),console.log(`Set permission mode for session ${k} to ${D}`)}catch(F){throw console.error("Failed to set permission mode:",F),F}}async function M(k){try{await te.post(`/api/sessions/${k}/start`),console.log(`Started session ${k}`)}catch(D){throw console.error("Failed to start session:",D),D}}async function T(k){try{await te.post(`/api/sessions/${k}/pause`),console.log(`Paused session ${k}`)}catch(D){throw console.error("Failed to pause session:",D),D}}async function E(k){try{await te.post(`/api/sessions/${k}/terminate`),console.log(`Terminated session ${k}`)}catch(D){throw console.error("Failed to terminate session:",D),D}}function A(k){return n.value.get(k)}function L(k,D){o.value.set(k,D),D.permissionMode&&C(k,{current_permission_mode:D.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:r,orderedSessions:d,sessionsInProject:p,currentInput:c,fetchSessions:_,createSession:v,selectSession:f,updateSession:C,deleteSession:y,updateSessionName:g,setPermissionMode:h,startSession:M,pauseSession:T,terminateSession:E,getSession:A,storeInitData:L}}),_n=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:oe},Symbol.toStringTag,{value:"Module"})),pe=yt("ui",()=>{const n=N(window.innerWidth<768),e=N(300),s=N(window.innerWidth),o=b(()=>s.value<768),i=N(!0),a=N(null),l=N(null),r=b(()=>a.value?{name:a.value,data:l.value}:null),d=N(!1),p=N("Loading...");function c(){n.value=!n.value}function _(T){n.value=T}function v(T){e.value=Math.max(200,Math.min(T,window.innerWidth*.3))}function f(T){i.value=T}function C(T,E=null){a.value=null,l.value=null,setTimeout(()=>{a.value=T,l.value=E},0)}function y(){a.value=null,l.value=null}function g(T="Loading..."){d.value=!0,p.value=T}function h(){d.value=!1}function M(){const T=s.value;s.value=window.innerWidth,s.value<768&&T>=768?n.value=!0:s.value>=768&&T<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:l,currentModal:r,isLoading:d,loadingMessage:p,toggleSidebar:c,setSidebarCollapsed:_,setSidebarWidth:v,setAutoScroll:f,showModal:C,hideModal:y,showLoading:g,hideLoading:h,handleResize:M}}),he=yt("project",()=>{const n=N(new Map),e=N(null),s=b(()=>n.value.get(e.value)),o=b(()=>Array.from(n.value.values()).sort((y,g)=>y.order-g.order)),i=y=>n.value.get(y)?.is_multi_agent||!1;async function a(){try{const y=await te.get("/api/projects");return n.value.clear(),y.projects.forEach(g=>{n.value.set(g.project_id,g)}),console.log(`Loaded ${n.value.size} projects`),y.projects}catch(y){throw console.error("Failed to fetch projects:",y),y}}async function l(y,g,h=!1){try{const T=(await te.post("/api/projects",{name:y,working_directory:g,is_multi_agent:h})).project;return n.value.set(T.project_id,T),n.value=new Map(n.value),console.log(`Created project ${T.project_id}`),T}catch(M){throw console.error("Failed to create project:",M),M}}async function r(y,g){try{await te.put(`/api/projects/${y}`,g),d(y,g),console.log(`Updated project ${y}`,g)}catch(h){throw console.error("Failed to update project:",h),h}}function d(y,g){const h=n.value.get(y);h&&(Object.assign(h,g),n.value=new Map(n.value))}async function p(y){try{await te.delete(`/api/projects/${y}`),n.value.delete(y),n.value=new Map(n.value),e.value===y&&(e.value=null),console.log(`Deleted project ${y}`)}catch(g){throw console.error("Failed to delete project:",g),g}}async function c(y){try{const g=await te.put(`/api/projects/${y}/toggle-expansion`),h=n.value.get(y);return h&&(h.is_expanded=g.is_expanded,n.value=new Map(n.value)),g.is_expanded}catch(g){throw console.error("Failed to toggle expansion:",g),g}}async function _(y){try{await te.put("/api/projects/reorder",{project_ids:y}),y.forEach((g,h)=>{const M=n.value.get(g);M&&(M.order=h)}),n.value=new Map(n.value),console.log("Reordered projects",y)}catch(g){throw console.error("Failed to reorder projects:",g),g}}async function v(y,g){try{await te.put(`/api/projects/${y}/sessions/reorder`,{session_ids:g});const h=n.value.get(y);h&&(h.session_ids=g,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${y}`,g)}catch(h){throw console.error("Failed to reorder sessions:",h),h}}function f(y){return n.value.get(y)}function C(y){if(!y)return"";const g=y.split(/[/\\]/).filter(h=>h);return g.length===0?"/":g.length===1?`/${g[0]}`:g.length===2?`/${g.join("/")}`:`.../${g.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:l,updateProject:r,updateProjectLocal:d,deleteProject:p,toggleExpansion:c,reorderProjects:_,reorderSessionsInProject:v,getProject:f,formatPath:C}}),G=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},Ti={class:"session-header border-bottom p-3"},xi={class:"project-name"},Mi=["title"],Ai={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=oe(),o=he(),i=b(()=>s.sessions.get(e.sessionId)),a=b(()=>i.value?.name||e.sessionId),l=b(()=>{for(const d of o.projects.values())if(d.session_ids?.includes(e.sessionId))return d;return null}),r=b(()=>l.value?.name||"Unknown Project");return(d,p)=>(u(),m("div",Ti,[t("div",null,[t("div",xi,$(r.value),1),t("div",{class:"session-name",title:n.sessionId},$(a.value),9,Mi)])]))}},Oi=G(Ai,[["__scopeId","data-v-89e9c269"]]),Ni={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Di=["title"],Li={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Ii={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=oe(),o=b(()=>s.sessions.get(e.sessionId)),i=b(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=b(()=>{const d=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[d]||"#d3d3d3"}),l=b(()=>{const d=i.value;return d==="starting"||d==="processing"||d==="pending-prompt"}),r=b(()=>{if(!o.value)return"No session selected";const d=i.value,p=d.charAt(0).toUpperCase()+d.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",_=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${_}: ${p}`});return(d,p)=>(u(),m("div",Ni,[o.value?(u(),m("div",{key:0,class:Y(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:We({width:"100%",backgroundColor:a.value}),title:r.value},null,14,Di)):(u(),m("div",Li))]))}},Pi=G(Ii,[["__scopeId","data-v-e8795bb7"]]),ji={class:"session-status-bar border-top p-2 bg-light"},Ri={class:"d-flex justify-content-between align-items-center gap-2"},Vi={class:"d-flex gap-2"},Wi=["disabled"],Hi={class:"mode-label"},Fi=["disabled"],Ui=["disabled"],Bi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=oe(),o=pe(),i=b(()=>s.sessions.get(e.sessionId)),a=b(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},r=b(()=>l[a.value]||"ðŸ”’"),d=b(()=>a.value),p=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const y=(p.indexOf(a.value)+1)%p.length,g=p[y];try{await s.setPermissionMode(e.sessionId,g)}catch(h){console.error("Failed to cycle permission mode:",h)}},_=()=>{o.showModal("session-info",{sessionId:e.sessionId})},v=()=>{o.showModal("manage-session",{session:i.value})},f=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(C,y)=>(u(),m("div",ji,[t("div",Ri,[t("div",Vi,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[K($(r.value)+" ",1),t("span",Hi,$(d.value),1)],8,Wi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!i.value},[...y[0]||(y[0]=[K(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,Fi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:v,disabled:!i.value},[...y[1]||(y[1]=[K(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,Ui)]),t("div",null,[t("button",{class:Y(["btn btn-sm",Xt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:f}," â¬‡ï¸ "+$(Xt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},qi=G(Bi,[["__scopeId","data-v-fdcd3535"]]),Ie=yt("message",()=>{const n=N(new Map),e=N(new Map),s=N(new Map),o=N(new Map),i=N(new Map),a=N(new Map),l=N(new Map),r=b(()=>{const w=oe();return n.value.get(w.currentSessionId)||[]}),d=b(()=>{const w=oe();return e.value.get(w.currentSessionId)||[]});async function p(w,O=null,P=0){try{const j=O||1e4,U=await te.get(`/api/sessions/${w}/messages?limit=${j}&offset=${P}`),q=U.messages||[],ne=U.total_count||q.length,B=U.has_more||!1;if(console.log(`Loaded ${q.length} of ${ne} messages for session ${w}`),n.value.set(w,q),q.length>0){const ee=q[q.length-1];ee.timestamp&&(l.value.set(w,ee.timestamp),console.log(`Tracked last received timestamp for session ${w}: ${ee.timestamp}`))}const V=new Set;q.forEach(ee=>{ee.type==="assistant"&&ee.metadata?.tool_uses&&ee.metadata.tool_uses.forEach(z=>{V.add(z.id)}),ee.type==="user"&&ee.metadata?.tool_results&&ee.metadata.tool_results.forEach(z=>{V.delete(z.tool_use_id);const de=a.value.get(w);de&&de.delete(z.tool_use_id)}),ee.type==="system"&&ee.metadata?.subtype==="client_launched"&&(V.forEach(z=>{E(w,z,"Session was restarted")}),V.clear()),ee.type==="system"&&ee.metadata?.subtype==="interrupt"&&(V.forEach(z=>{E(w,z,"Session was interrupted")}),V.clear()),ee.metadata?.has_tool_uses&&ee.metadata.tool_uses&&ee.metadata.tool_uses.forEach(z=>{C(w,z)}),ee.metadata?.has_tool_results&&ee.metadata.tool_results&&ee.metadata.tool_results.forEach(z=>{h(w,z)}),(ee.type==="permission_request"||ee.metadata?.has_permission_requests)&&y(w,ee),ee.type==="system"&&(ee.subtype==="init"||ee.metadata?.subtype==="init")&&ee.metadata?.init_data&&oe().storeInitData(w,ee.metadata.init_data)});const _e=oe().sessions.get(w);return _e&&!["active","paused","starting"].includes(_e.state)&&(V.forEach(ee=>{E(w,ee,"Session was terminated")}),V.clear()),i.value.set(w,V),n.value=new Map(n.value),B&&console.warn(`Warning: Only loaded ${q.length} of ${ne} messages. Some messages may be missing.`),{messages:q,totalCount:ne,hasMore:B}}catch(j){throw console.error("Failed to load messages:",j),j}}function c(w,O){const P=i.value.get(w)||new Set;O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(j=>{P.add(j.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(j=>{P.delete(j.tool_use_id);const U=a.value.get(w);U&&U.delete(j.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(P.forEach(j=>{E(w,j,"Session was restarted")}),P.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(P.forEach(j=>{E(w,j,"Session was interrupted")}),P.clear()),i.value.set(w,P)}function _(w,O){n.value.has(w)||n.value.set(w,[]);const P=n.value.get(w);if(O.id){const j=P.findIndex(U=>U.id===O.id);if(j!==-1){console.log(`Skipping duplicate message ${O.id} (already exists at index ${j})`);return}}P.push(O),O.timestamp&&l.value.set(w,O.timestamp),c(w,O),n.value=new Map(n.value)}function v(w,O){e.value.has(w)||e.value.set(w,[]),e.value.get(w).push(O),e.value=new Map(e.value)}function f(w,O,P){const j=e.value.get(w);if(j){const U=j.find(q=>q.id===O);U&&(Object.assign(U,P),e.value=new Map(e.value))}}function C(w,O){const P=T(O.name,O.input);s.value.set(P,O.id);const j={id:O.id,name:O.name,input:O.input,signature:P,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return v(w,j),console.log(`Created tool call ${j.id} for ${j.name}`),j}function y(w,O){console.log("handlePermissionRequest received:",O);const P=O.metadata?.tool_name||O.tool_name,j=O.metadata?.input_params||O.input_params,U=O.metadata?.request_id||O.request_id,q=O.metadata?.suggestions||O.suggestions||[];console.log("Extracted data:",{toolName:P,inputParams:j,requestId:U,suggestions:q});const ne=T(P,j),B=s.value.get(ne);B?(o.value.set(U,B),f(w,B,{status:"permission_required",permissionRequestId:U,suggestions:q}),console.log(`Permission required for tool ${B}`,{suggestions:q})):console.warn("No tool use ID found for permission request signature:",ne,{toolName:P,inputParams:j,availableSignatures:Array.from(s.value.keys())})}function g(w,O){const P=o.value.get(O.request_id);if(P){const j={permissionDecision:O.decision,appliedUpdates:O.applied_updates||[]};O.decision==="allow"?j.status="executing":(j.status="completed",j.result={error:!0,message:O.reasoning||"Permission denied"},j.isExpanded=!1),f(w,P,j),console.log(`Permission ${O.decision} for tool ${P}`)}}function h(w,O){const P=O.tool_use_id;f(w,P,{status:O.is_error?"error":"completed",result:{error:O.is_error,content:O.content},isExpanded:!1}),console.log(`Tool ${P} ${O.is_error?"failed":"completed"}`)}function M(w,O){const P=e.value.get(w);if(P){const j=P.find(U=>U.id===O);j&&(j.isExpanded=!j.isExpanded,e.value=new Map(e.value))}}function T(w,O){if(!w)return"unknown:{}";if(!O||typeof O!="object")return`${w}:{}`;const P=JSON.stringify(O,Object.keys(O).sort());return`${w}:${P}`}function E(w,O,P){const j=a.value.get(w)||new Map;j.set(O,{reason:"denied",message:P}),a.value.set(w,j);const U=e.value.get(w);if(U){const q=U.find(ne=>ne.id===O);q&&q.isExpanded&&(q.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${O} as orphaned: ${P}`)}function A(w,O){return a.value.get(w)?.has(O)||!1}function L(w,O){return a.value.get(w)?.get(O)}function k(w,O){const P=i.value.get(w);P&&P.size>0&&(P.forEach(j=>E(w,j,O)),P.clear())}function D(w){n.value.delete(w),e.value.delete(w),n.value=new Map(n.value),e.value=new Map(e.value)}function F(w){return l.value.get(w)}async function x(w){const O=l.value.get(w);if(!O)return console.log(`No sync needed for session ${w} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${w} since ${O}`);const P=await te.get(`/api/sessions/${w}/messages?limit=1000&offset=0`),j=P.messages||[],U=P.has_more||!1,q=z=>z?typeof z=="number"?z*1e3:new Date(z).getTime():0,ne=q(O),B=j.filter(z=>z.timestamp?q(z.timestamp)>ne:!1);if(B.length===0)return console.log(`No missed messages for session ${w}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${B.length} missed messages for session ${w}`);const V=n.value.get(w)||[],re=new Set(V.map(z=>z.id).filter(Boolean)),_e=B.filter(z=>!z.id||!re.has(z.id));if(console.log(`After deduplication: ${_e.length} unique new messages`),_e.length>0){const z=_e.sort((Q,Z)=>{const fe=q(Q.timestamp),St=q(Z.timestamp);return fe-St}),de=n.value.get(w)||[],W=de.length>0?q(de[de.length-1].timestamp):0,H=q(z[0].timestamp),J=q(z[z.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:de.length,lastExisting:W,lastExistingDate:de.length>0?de[de.length-1].timestamp:"none",firstNew:H,firstNewDate:z[0].timestamp,lastNew:J,lastNewDate:z[z.length-1].timestamp,shouldAppend:H>W}),H>W){const Q=[...de,...z];n.value.set(w,Q),console.log(`âœ… Appended ${z.length} new messages (no full sort needed)`)}else{const Q=[...de,...z].sort((Z,fe)=>{const St=q(Z.timestamp),Vt=q(fe.timestamp);return St-Vt});n.value.set(w,Q),console.log(`âš ï¸ Merged and sorted ${z.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${V.length} messages unchanged`);_e.forEach(z=>{c(w,z),z.metadata?.has_tool_uses&&z.metadata.tool_uses&&z.metadata.tool_uses.forEach(de=>{C(w,de)}),z.metadata?.has_tool_results&&z.metadata.tool_results&&z.metadata.tool_results.forEach(de=>{h(w,de)}),(z.type==="permission_request"||z.metadata?.has_permission_requests)&&y(w,z),z.type==="system"&&(z.subtype==="init"||z.metadata?.subtype==="init")&&z.metadata?.init_data&&oe().storeInitData(w,z.metadata.init_data)});const ee=n.value.get(w);if(ee&&ee.length>0){const z=ee[ee.length-1];z.timestamp&&l.value.set(w,z.timestamp)}return n.value=new Map(n.value),{syncedCount:_e.length,hasMore:U}}catch(P){return console.error(`Failed to sync messages for session ${w}:`,P),{syncedCount:0,hasMore:!1,error:P.message}}}const S=oe();return le(()=>Array.from(S.sessions.values()).map(O=>({id:O.session_id,state:O.state})),(w,O)=>{O&&w.forEach((P,j)=>{const U=O[j];if(!U||U.id!==P.id)return;const q=["active","paused","starting"].includes(U.state),ne=!["active","paused","starting"].includes(P.state);q&&ne&&k(P.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:vn(i),orphanedToolUses:vn(a),currentMessages:r,currentToolCalls:d,loadMessages:p,addMessage:_,addToolCall:v,updateToolCall:f,handleToolUse:C,handlePermissionRequest:y,handlePermissionResponse:g,handleToolResult:h,toggleToolExpansion:M,clearMessages:D,markToolUseOrphaned:E,isToolUseOrphaned:A,getOrphanedInfo:L,clearOrphanedToolUses:k,getLastReceivedTimestamp:F,syncMessages:x}}),zi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ie},Symbol.toStringTag,{value:"Module"}));function Ki(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Dt(n){return Ki(n).toLocaleTimeString()}const Yi={class:"message-row message-row-user"},Gi=["title"],Ji={class:"message-content-column"},Xi=["innerHTML"],Qi={key:0,class:"tool-results mt-2"},Zi={class:"tool-results-header text-muted small mb-2"},ea={class:"d-flex align-items-start gap-2"},ta={class:"flex-grow-1"},sa={class:"text-muted"},na={key:0,class:"text-danger small"},oa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ot.setOptions({breaks:!0,gfm:!0});const s=b(()=>Dt(e.message.timestamp)),o=b(()=>`user
${s.value}`),i=b(()=>{const d=e.message.content||"";let p=Ot.parse(d);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Ws.sanitize(p)}),a=b(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=b(()=>e.message.metadata?.tool_results||[]);function r(d,p){return d?d.length<=p?d:d.substring(0,p)+"...":""}return(d,p)=>(u(),m("div",Yi,[t("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,Gi),t("div",Ji,[t("div",{class:"message-text",innerHTML:i.value},null,8,Xi),a.value?(u(),m("div",Qi,[t("div",Zi,[p[1]||(p[1]=t("i",{class:"bi bi-tools"},null,-1)),K(" Tool Results ("+$(l.value.length)+") ",1)]),(u(!0),m(ie,null,ce(l.value,(c,_)=>(u(),m("div",{key:_,class:Y(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",ea,[t("span",null,$(c.is_error?"âŒ":"âœ…"),1),t("div",ta,[t("small",sa,"Tool: "+$(c.tool_use_id),1),c.is_error?(u(),m("div",na,$(r(c.content,200)),1)):I("",!0)])])],2))),128))])):I("",!0)])]))}},ia=G(oa,[["__scopeId","data-v-09875214"]]),aa={class:"thinking-block"},la={class:"text-muted ms-auto"},ra={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ca=["innerHTML"],da={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=N(!1),o=b(()=>e.thinking?.length||0),i=b(()=>{const l=e.thinking||"",r=Ot.parse(l);return Ws.sanitize(r)});function a(){s.value=!s.value}return(l,r)=>(u(),m("div",aa,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[t("i",{class:Y(["bi",s.value?"bi-chevron-down":"bi-chevron-right"])},null,2),r[0]||(r[0]=t("span",{class:"thinking-label"},[t("i",{class:"bi bi-lightbulb"}),K(" Thinking ")],-1)),t("small",la,$(o.value)+" characters",1)]),s.value?(u(),m("div",ra,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,ca)])):I("",!0)]))}},ua=G(da,[["__scopeId","data-v-619a8344"]]),je=yt("websocket",()=>{const n=N(null),e=N(!1),s=N(0),o=10,i=N(null),a=N(!1),l=N(0),r=5,d=N(null);let p=null;const c=N(0),_=N(null),v=N(new Map),f=N(null),C=N(!1),y=N(0),g=5,h=N(null),M=1e4,T=1e3,E=N(Date.now()),A=N(Date.now()),L=N(Date.now());let k=null,D=null,F=null;const x=b(()=>e.value&&(a.value||!d.value)?"connected":e.value?"partial":"disconnected");function S(W){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${W}`}function w(W){const H={ui:{timer:()=>k,setTimer:J=>{k=J},lastPing:E,connected:e,name:"UI"},session:{timer:()=>D,setTimer:J=>{D=J},lastPing:A,connected:a,name:"Session"},legion:{timer:()=>F,setTimer:J=>{F=J},lastPing:L,connected:C,name:"Legion"}}[W];H.timer()&&clearInterval(H.timer()),H.setTimer(setInterval(()=>{if(!H.connected.value)return;const J=Date.now()-H.lastPing.value;if(J>M){console.warn(`âš ï¸ ${H.name} WebSocket heartbeat timeout (${J}ms since last ping) - forcing close to trigger reconnection`),H.connected.value=!1;const Z={ui:n,session:i,legion:f}[W];Z.value&&Z.value.readyState===WebSocket.OPEN&&Z.value.close()}},T)),console.log(`âœ… Started heartbeat monitor for ${H.name} WebSocket`)}function O(W){const H={ui:{get:()=>k,set:J=>{k=J}},session:{get:()=>D,set:J=>{D=J}},legion:{get:()=>F,set:J=>{F=J}}}[W];H.get()&&(clearInterval(H.get()),H.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${W} WebSocket`))}function P(){if(n.value)return;const W=S("/ws/ui");console.log(`Connecting to UI WebSocket: ${W}`),n.value=new WebSocket(W),n.value.onopen=()=>{e.value=!0,s.value=0,E.value=Date.now(),w("ui"),console.log("UI WebSocket connected")},n.value.onmessage=H=>{const J=JSON.parse(H.data);re(J)},n.value.onclose=()=>{if(O("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const H=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${H}ms (attempt ${s.value})`),setTimeout(P,H)}},n.value.onerror=H=>{console.error("UI WebSocket error:",H)}}function j(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function U(W){c.value++;const H=c.value;if(console.log(`[Gen ${H}] Starting connection to session ${W}`),p&&(clearTimeout(p),p=null),await q(),c.value!==H){console.log(`[Gen ${H}] Connection cancelled (current generation: ${c.value})`);return}d.value=W,_.value=H;const J=S(`/ws/session/${W}`);console.log(`[Gen ${H}] Connecting to Session WebSocket: ${J}`),i.value=new WebSocket(J),i.value.onopen=async()=>{if(_.value!==H){console.log(`[Gen ${H}] Ignoring onopen (stale connection, current: ${_.value})`),i.value.close();return}a.value=!0,l.value=0,A.value=Date.now(),w("session"),console.log(`[Gen ${H}] Session WebSocket connected for ${W}`);const Q=v.value.get(W);if(v.value.set(W,!0),Q){console.log(`[Gen ${H}] Reconnection detected, syncing missed messages...`);try{const fe=await Ie().syncMessages(W);fe.syncedCount>0?console.log(`[Gen ${H}] âœ… Synced ${fe.syncedCount} missed messages`):fe.error?console.warn(`[Gen ${H}] âš ï¸ Message sync failed: ${fe.error}`):console.log(`[Gen ${H}] No missed messages to sync`),fe.hasMore&&console.warn(`[Gen ${H}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(Z){console.error(`[Gen ${H}] Error during message sync:`,Z)}}else console.log(`[Gen ${H}] Initial connection, no sync needed`)},i.value.onmessage=Q=>{if(_.value!==H){console.log(`[Gen ${H}] Ignoring message (stale connection, current: ${_.value})`);return}const Z=JSON.parse(Q.data);_e(Z,W)},i.value.onclose=()=>{O("session"),a.value=!1,i.value=null,console.log(`[Gen ${H}] Session WebSocket closed for ${W}`);const Q=oe();if(Q.currentSessionId===W&&_.value===H&&l.value<r){l.value++;const Z=Math.min(2e3*l.value,3e4);console.log(`[Gen ${H}] Reconnecting Session WebSocket in ${Z}ms (attempt ${l.value})`),p=setTimeout(()=>{_.value===H&&Q.currentSessionId===W?(p=null,U(W)):console.log(`[Gen ${H}] Skipping reconnect (generation or session changed)`)},Z)}},i.value.onerror=Q=>{console.error(`[Gen ${H}] Session WebSocket error:`,Q)}}function q(){return new Promise(W=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),i.value){const H=d.value,J=()=>{i.value=null,a.value=!1,d.value=null,_.value=null,l.value=0,H&&v.value.delete(H),W()};if(i.value.readyState===WebSocket.CLOSED)J();else{const Q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),J()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Q),J()},{once:!0}),i.value.close()}}else d.value=null,_.value=null,W()})}function ne(W){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:W})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function B(W,H,J=!1,Q=null){if(i.value&&a.value){const Z={type:"permission_response",request_id:W,decision:H,apply_suggestions:J,timestamp:new Date().toISOString()};Q&&(Z.clarification_message=Q),i.value.send(JSON.stringify(Z)),console.log(`Sent permission ${H} for request ${W}`,{applySuggestions:J,clarification:Q})}}function V(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function re(W){const H=oe(),J=he();switch(W.type){case"sessions_list":W.sessions&&Array.isArray(W.sessions)&&W.sessions.forEach(Q=>{H.updateSession(Q.session_id,Q)});break;case"state_change":W.data&&W.data.session_id&&W.data.session&&H.updateSession(W.data.session_id,W.data.session);break;case"project_updated":if(W.data&&W.data.project){const Q=W.data.project;J.updateProjectLocal(Q.project_id,Q)}break;case"project_deleted":W.data&&W.data.project_id&&J.projects.delete(W.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":E.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",W.type)}}function _e(W,H){const J=oe();if(J.currentSessionId!==H){console.warn(`Ignoring message for session ${H} (current: ${J.currentSessionId})`);return}const Q=Ie();switch(W.type){case"message":const Z=W.data;if(!Z||!Z.type){console.warn("Received message event with invalid data:",W);break}if(Z.type==="permission_request"){Q.handlePermissionRequest(H,Z);break}if(Z.type==="permission_response"){Q.handlePermissionResponse(H,Z);break}Z.metadata?.has_tool_uses&&Z.metadata.tool_uses.forEach(fe=>{Q.handleToolUse(H,fe)}),Z.metadata?.has_tool_results&&Z.metadata.tool_results.forEach(fe=>{Q.handleToolResult(H,fe)}),Z.type==="system"&&(Z.subtype==="init"||Z.metadata?.subtype==="init")&&Z.metadata?.init_data&&J.storeInitData(H,Z.metadata.init_data),Q.addMessage(H,Z);break;case"permission_request":Q.handlePermissionRequest(H,W);break;case"permission_response":Q.handlePermissionResponse(H,W);break;case"tool_result":Q.handleToolResult(H,W);break;case"state_change":J.updateSession(H,W.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${H}`);break;case"ping":A.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function ee(W){z(),h.value=W;const H=S(`/ws/legion/${W}`);console.log(`Connecting to Legion WebSocket: ${H}`),f.value=new WebSocket(H),f.value.onopen=()=>{C.value=!0,y.value=0,L.value=Date.now(),w("legion"),console.log(`Legion WebSocket connected for ${W}`)},f.value.onmessage=J=>{const Q=JSON.parse(J.data);de(Q,W)},f.value.onclose=()=>{if(O("legion"),C.value=!1,f.value=null,console.log(`Legion WebSocket closed for ${W}`),h.value===W&&y.value<g){y.value++;const J=Math.min(2e3*y.value,3e4);setTimeout(()=>ee(W),J)}},f.value.onerror=J=>{console.error("Legion WebSocket error:",J)}}function z(){f.value&&(f.value.close(),f.value=null,C.value=!1,h.value=null)}function de(W,H){ye(async()=>{const{useLegionStore:J}=await Promise.resolve().then(()=>Kh);return{useLegionStore:J}},void 0).then(({useLegionStore:J})=>{const Q=J();switch(W.type){case"comm":W.comm&&(Q.addComm(H,W.comm),console.log("Legion WebSocket: Received new comm",W.comm));break;case"minion_created":W.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",W.data),ye(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>_n);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"minion_updated":W.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",W.data),ye(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>_n);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"channel_created":W.channel&&(console.log("Legion WebSocket: Channel created, updating list",W.channel),Q.addChannel(H,W.channel));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${H}`);break;case"ping":L.value=Date.now(),f.value?.readyState===WebSocket.OPEN&&f.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",W.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:a,sessionRetryCount:l,legionConnected:C,legionRetryCount:y,overallStatus:x,connectUI:P,disconnectUI:j,connectSession:U,disconnectSession:q,sendMessage:ne,sendPermissionResponse:B,interruptSession:V,connectLegion:ee,disconnectLegion:z}}),ma=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:je},Symbol.toStringTag,{value:"Module"})),pa={class:"base-tool-handler"},fa={class:"tool-section"},va={class:"tool-parameters"},ha={class:"tool-code"},_a={key:0,class:"tool-section"},ga={class:"tool-section-label"},ba={class:"tool-code"},ya={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=b(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,r)=>(u(),m("div",pa,[t("div",fa,[r[0]||(r[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",va,[t("pre",ha,$(s.value),1)])]),o.value?(u(),m("div",_a,[t("div",ga,$(i.value?"Error:":"Result:"),1),t("div",{class:Y(["tool-result",{"tool-result-error":i.value}])},[t("pre",ba,$(a.value),1)],2)])):I("",!0)]))}},$a=G(ya,[["__scopeId","data-v-1e69f57d"]]),wa={class:"read-tool-handler"},Ea={class:"tool-section"},Ca={class:"read-file-info"},Sa={class:"file-path"},ka={key:0,class:"read-range"},Ta={key:0,class:"tool-section"},xa={key:0,class:"tool-result tool-result-error"},Ma={class:"tool-code"},Aa={key:1,class:"file-content-preview"},Oa={class:"content-header"},Na={class:"line-count-badge"},Da={key:0,class:"preview-note"},La={class:"tool-code content-display"},Ia={key:0,class:"more-indicator"},fs=100,Pa={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>{const f=e.toolCall.input?.offset,C=e.toolCall.input?.limit;return f!==void 0||C!==void 0}),i=b(()=>{const f=e.toolCall.input?.offset;return f!==void 0?f+1:1}),a=b(()=>{const f=e.toolCall.input?.offset||0,C=e.toolCall.input?.limit;return C!==void 0?f+C:"âˆž"}),l=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=b(()=>{if(!l.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),p=b(()=>r.value||!d.value?[]:d.value.split(`
`)),c=b(()=>p.value.length),_=b(()=>c.value>fs),v=b(()=>r.value?"":p.value.slice(0,fs).join(`
`));return(f,C)=>(u(),m("div",wa,[t("div",Ea,[t("div",Ca,[C[0]||(C[0]=t("span",{class:"file-icon"},"ðŸ“„",-1)),C[1]||(C[1]=t("strong",null,"Reading:",-1)),t("code",Sa,$(s.value),1),o.value?(u(),m("span",ka,"Lines "+$(i.value)+"-"+$(a.value),1)):I("",!0)])]),l.value?(u(),m("div",Ta,[r.value?(u(),m("div",xa,[t("pre",Ma,$(d.value),1)])):(u(),m("div",Aa,[t("div",Oa,[C[2]||(C[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Na,$(c.value)+" lines",1),_.value?(u(),m("span",Da,"(showing first "+$(fs)+")")):I("",!0)]),t("pre",La,$(v.value),1),_.value?(u(),m("div",Ia,"...")):I("",!0)]))])):I("",!0)]))}},ja=G(Pa,[["__scopeId","data-v-1f2b0569"]]),Ra={class:"write-tool-handler"},Va={class:"tool-section"},Wa={class:"write-file-info mb-2"},Ha={class:"file-path"},Fa={class:"write-content-preview"},Ua={class:"content-header"},Ba={class:"line-count-badge"},qa={key:0,class:"preview-note"},za={class:"tool-code content-display"},Ka={key:0,class:"more-indicator"},Ya={key:0,class:"tool-section"},Ga={key:0,class:"tool-result tool-result-error"},Ja={class:"tool-code"},Xa={key:1,class:"tool-result tool-result-success"},Qa={class:"success-message"},vs=100,Za={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>e.toolCall.input?.content||""),i=b(()=>o.value.split(`
`)),a=b(()=>i.value.length),l=b(()=>a.value>vs),r=b(()=>i.value.slice(0,vs).join(`
`)),d=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=b(()=>{if(!d.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,v)=>(u(),m("div",Ra,[t("div",Va,[t("div",Wa,[v[0]||(v[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),v[1]||(v[1]=t("strong",null,"Writing:",-1)),t("code",Ha,$(s.value),1)]),t("div",Fa,[t("div",Ua,[v[2]||(v[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Ba,$(a.value)+" lines",1),l.value?(u(),m("span",qa,"(showing first "+$(vs)+")")):I("",!0)]),t("pre",za,$(r.value),1),l.value?(u(),m("div",Ka,"...")):I("",!0)])]),d.value?(u(),m("div",Ya,[p.value?(u(),m("div",Ga,[v[3]||(v[3]=t("strong",null,"Error:",-1)),t("pre",Ja,$(c.value),1)])):(u(),m("div",Xa,[t("div",Qa,[v[4]||(v[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):I("",!0)]))}},el=G(Za,[["__scopeId","data-v-ddc24a0f"]]),tl={class:"bash-tool-handler"},sl={class:"tool-section"},nl={class:"bash-header"},ol={class:"bash-header-content"},il={key:0,class:"bash-description"},al={key:1,class:"bash-flags"},ll={class:"bash-command-section"},rl={class:"bash-command-content"},cl={key:0,class:"tool-section"},dl={key:0,class:"bash-output"},ul={key:1,class:"bash-output-empty"},ml={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.command||""),o=b(()=>e.toolCall.input?.description||""),i=b(()=>e.toolCall.input?.timeout),a=b(()=>e.toolCall.input?.run_in_background||!1),l=b(()=>i.value||a.value),r=b(()=>{const v=[];return i.value&&v.push(`timeout: ${i.value}ms`),a.value&&v.push("background"),v.join(", ")}),d=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=b(()=>p.value?"tool-result-error":"tool-result-success"),_=b(()=>{if(!d.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,f)=>(u(),m("div",tl,[t("div",sl,[t("div",nl,[f[1]||(f[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",ol,[o.value?(u(),m("div",il,[f[0]||(f[0]=t("strong",null,"Description:",-1)),K(" "+$(o.value),1)])):I("",!0),l.value?(u(),m("div",al,$(r.value),1)):I("",!0)])]),t("div",ll,[f[2]||(f[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",rl,$(s.value),1)])]),d.value?(u(),m("div",cl,[t("div",{class:Y(["tool-result",c.value])},[f[3]||(f[3]=t("strong",null,"Output:",-1)),_.value?(u(),m("pre",dl,$(_.value),1)):(u(),m("div",ul,"No output"))],2)])):I("",!0)]))}},pl=G(ml,[["__scopeId","data-v-ab50fe73"]]),fl={class:"todo-tool-handler"},vl={class:"tool-section"},hl={class:"todo-header"},_l={class:"todo-summary"},gl={key:0,class:"todo-count todo-count-completed"},bl={key:1,class:"todo-count todo-count-in-progress"},yl={key:2,class:"todo-count todo-count-pending"},$l={class:"todo-checklist"},wl={class:"todo-checkbox"},El={class:"todo-content"},Cl={key:0,class:"tool-section"},Sl={key:0,class:"tool-result tool-result-error"},kl={class:"tool-code"},Tl={key:1,class:"tool-result tool-result-success"},xl={class:"success-message"},Ml={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.todos||[]),o=b(()=>s.value.filter(c=>c.status==="completed").length),i=b(()=>s.value.filter(c=>c.status==="in_progress").length),a=b(()=>s.value.filter(c=>c.status==="pending").length);function l(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const r=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=b(()=>{if(!r.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,_)=>(u(),m("div",fl,[t("div",vl,[t("div",hl,[_[0]||(_[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),_[1]||(_[1]=t("strong",null,"Task List:",-1)),t("div",_l,[o.value>0?(u(),m("span",gl,$(o.value)+" completed ",1)):I("",!0),i.value>0?(u(),m("span",bl,$(i.value)+" in progress ",1)):I("",!0),a.value>0?(u(),m("span",yl,$(a.value)+" pending ",1)):I("",!0)])]),t("div",$l,[(u(!0),m(ie,null,ce(s.value,(v,f)=>(u(),m("div",{key:f,class:Y(["todo-item",`todo-${v.status}`])},[t("span",wl,$(l(v.status)),1),t("span",El,$(v.content),1)],2))),128))])]),r.value?(u(),m("div",Cl,[d.value?(u(),m("div",Sl,[_[2]||(_[2]=t("strong",null,"Error:",-1)),t("pre",kl,$(p.value),1)])):(u(),m("div",Tl,[t("div",xl,[_[3]||(_[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+$(s.value.length)+" tasks)",1)])]))])):I("",!0)]))}},Al=G(Ml,[["__scopeId","data-v-bbe55ee7"]]),Ol={class:"edit-tool-handler"},Nl={class:"tool-section"},Dl={class:"edit-file-info"},Ll={class:"file-path"},Il={key:0,class:"replace-all-badge"},Pl={class:"edit-diff-container"},jl={class:"diff-header"},Rl={class:"diff-stats"},Vl={class:"stat-removed"},Wl={class:"stat-added"},Hl={class:"unified-diff"},Fl={class:"diff-scroll-container"},Ul={class:"diff-marker"},Bl={class:"diff-content"},ql={key:0,class:"tool-section"},zl={key:0,class:"tool-result tool-result-error"},Kl={class:"tool-code"},Yl={key:1,class:"tool-result tool-result-success"},Gl={class:"success-message"},Jl={key:0,class:"success-detail"},Xl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>e.toolCall.input?.old_string||""),i=b(()=>e.toolCall.input?.new_string||""),a=b(()=>e.toolCall.input?.replace_all||!1),l=b(()=>{const f=gi(s.value,o.value,i.value,"","",{context:3}).split(`
`),C=[];for(let y=4;y<f.length;y++){const g=f[y];g&&(g.startsWith("-")?C.push({type:"removed",content:g.substring(1)}):g.startsWith("+")?C.push({type:"added",content:g.substring(1)}):g.startsWith(" ")?C.push({type:"context",content:g.substring(1)}):g.startsWith("@@")&&C.push({type:"hunk",content:g}))}return C}),r=b(()=>l.value.filter(v=>v.type==="removed").length),d=b(()=>l.value.filter(v=>v.type==="added").length),p=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=b(()=>{if(!p.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,f)=>(u(),m("div",Ol,[t("div",Nl,[t("div",Dl,[f[0]||(f[0]=t("span",{class:"file-icon"},"âœï¸",-1)),f[1]||(f[1]=t("strong",null,"Editing:",-1)),t("code",Ll,$(s.value),1),a.value?(u(),m("span",Il,"Replace All")):I("",!0)]),t("div",Pl,[t("div",jl,[f[2]||(f[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Rl,[t("span",Vl,"-"+$(r.value),1),t("span",Wl,"+"+$(d.value),1)])]),t("div",Hl,[t("div",Fl,[(u(!0),m(ie,null,ce(l.value,(C,y)=>(u(),m("div",{key:y,class:Y(["diff-line",{"diff-line-removed":C.type==="removed","diff-line-added":C.type==="added","diff-line-context":C.type==="context","diff-line-hunk":C.type==="hunk"}])},[t("span",Ul,$(C.type==="removed"?"-":C.type==="added"?"+":C.type==="hunk"?"@":" "),1),t("span",Bl,$(C.content),1)],2))),128))])])])]),p.value?(u(),m("div",ql,[c.value?(u(),m("div",zl,[f[3]||(f[3]=t("strong",null,"Error:",-1)),t("pre",Kl,$(_.value),1)])):(u(),m("div",Yl,[t("div",Gl,[f[4]||(f[4]=t("span",{class:"success-icon"},"âœ…",-1)),f[5]||(f[5]=t("strong",null,"File edited successfully",-1)),a.value?(u(),m("span",Jl,"(all occurrences replaced)")):I("",!0)])]))])):I("",!0)]))}},Ql=G(Xl,[["__scopeId","data-v-16b90adc"]]),Zl={class:"search-tool-handler"},er={class:"tool-section"},tr={class:"search-info"},sr={class:"search-icon"},nr={class:"search-pattern"},or={key:0,class:"search-path"},ir={key:1,class:"search-filters"},ar={key:0,class:"filter-badge"},lr={key:1,class:"filter-badge"},rr={key:2,class:"filter-badge"},cr={key:0,class:"tool-section"},dr={key:0,class:"tool-result tool-result-error"},ur={class:"tool-code"},mr={key:1,class:"search-results"},pr={class:"results-header"},fr={class:"results-label"},vr={class:"results-count-badge"},hr={class:"results-content"},_r={class:"tool-code"},gr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="Grep");b(()=>e.toolCall.name==="Glob");const o=b(()=>e.toolCall.input?.pattern||"Unknown"),i=b(()=>e.toolCall.input?.path||null),a=b(()=>e.toolCall.input?.type||null),l=b(()=>e.toolCall.input?.glob||null),r=b(()=>e.toolCall.input?.["-i"]||!1),d=b(()=>a.value||l.value||r.value),p=b(()=>s.value?"ðŸ”":"ðŸ“"),c=b(()=>s.value?"Searching content":"Finding files"),_=b(()=>s.value?"Matches":"Files found"),v=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),C=b(()=>{if(!v.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),y=b(()=>!v.value||f.value||!C.value?0:C.value.split(`
`).filter(h=>h.trim()).length);return(g,h)=>(u(),m("div",Zl,[t("div",er,[t("div",tr,[t("span",sr,$(p.value),1),t("strong",null,$(c.value)+":",1),t("code",nr,$(o.value),1),i.value?(u(),m("span",or,"in "+$(i.value),1)):I("",!0),d.value?(u(),m("span",ir,[a.value?(u(),m("span",ar,"type: "+$(a.value),1)):I("",!0),l.value?(u(),m("span",lr,"glob: "+$(l.value),1)):I("",!0),r.value?(u(),m("span",rr,"case-insensitive")):I("",!0)])):I("",!0)])]),v.value?(u(),m("div",cr,[f.value?(u(),m("div",dr,[h[0]||(h[0]=t("strong",null,"Error:",-1)),t("pre",ur,$(C.value),1)])):(u(),m("div",mr,[t("div",pr,[t("span",fr,$(_.value)+":",1),t("span",vr,$(y.value)+" "+$(y.value===1?"match":"matches"),1)]),t("div",hr,[t("pre",_r,$(C.value),1)])]))])):I("",!0)]))}},gn=G(gr,[["__scopeId","data-v-0d272c39"]]),br={class:"web-tool-handler"},yr={class:"tool-section"},$r={class:"web-info"},wr={class:"web-icon"},Er=["href"],Cr={key:1,class:"web-query"},Sr={key:0,class:"web-prompt-container"},kr={class:"prompt-content"},Tr={key:1,class:"web-domains"},xr={class:"domains-label"},Mr={key:0,class:"tool-section"},Ar={key:0,class:"tool-result tool-result-error"},Or={class:"tool-code"},Nr={key:1,class:"web-results"},Dr={class:"results-header"},Lr={class:"results-label"},Ir={class:"results-content"},Pr={class:"tool-code"},jr={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="WebFetch");b(()=>e.toolCall.name==="WebSearch");const o=b(()=>e.toolCall.input?.url||null),i=b(()=>e.toolCall.input?.query||null),a=b(()=>e.toolCall.input?.prompt||null),l=b(()=>e.toolCall.input?.allowed_domains||[]),r=b(()=>e.toolCall.input?.blocked_domains||[]),d=b(()=>l.value.length>0?l.value:r.value.length>0?r.value:[]),p=b(()=>l.value.length>0?"Allowed domains":r.value.length>0?"Blocked domains":"Domains"),c=b(()=>s.value?"ðŸŒ":"ðŸ”Ž"),_=b(()=>s.value?"Fetching URL":"Searching web"),v=b(()=>s.value?"Fetched content":"Search results"),f=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),C=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=b(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,h)=>(u(),m("div",br,[t("div",yr,[t("div",$r,[t("span",wr,$(c.value),1),t("strong",null,$(_.value)+":",1),o.value?(u(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},$(o.value),9,Er)):i.value?(u(),m("code",Cr,$(i.value),1)):I("",!0)]),a.value?(u(),m("div",Sr,[h[0]||(h[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",kr,$(a.value),1)])):I("",!0),d.value.length>0?(u(),m("div",Tr,[t("span",xr,$(p.value)+":",1),(u(!0),m(ie,null,ce(d.value,M=>(u(),m("span",{key:M,class:"domain-badge"},$(M),1))),128))])):I("",!0)]),f.value?(u(),m("div",Mr,[C.value?(u(),m("div",Ar,[h[1]||(h[1]=t("strong",null,"Error:",-1)),t("pre",Or,$(y.value),1)])):(u(),m("div",Nr,[t("div",Dr,[t("span",Lr,$(v.value)+":",1)]),t("div",Ir,[t("pre",Pr,$(y.value),1)])]))])):I("",!0)]))}},bn=G(jr,[["__scopeId","data-v-62b55b55"]]),Rr={class:"task-tool-handler"},Vr={class:"tool-section"},Wr={class:"task-header"},Hr={key:0,class:"agent-type-badge"},Fr={key:0,class:"task-description"},Ur={class:"description-content"},Br={key:1,class:"task-prompt-container"},qr={class:"prompt-header"},zr={class:"prompt-length"},Kr={class:"prompt-code"},Yr={key:0,class:"tool-section"},Gr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Xr={key:1,class:"agent-output"},Qr={class:"output-header"},Zr={key:0,class:"output-count-badge"},ec={class:"output-content"},tc={class:"tool-code"},sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.description||null),o=b(()=>e.toolCall.input?.prompt||null),i=b(()=>e.toolCall.input?.subagent_type||null),a=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=b(()=>{if(!a.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),d=b(()=>r.value?r.value.split(`
`).length:0);return(p,c)=>(u(),m("div",Rr,[t("div",Vr,[t("div",Wr,[c[0]||(c[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=t("strong",null,"Agent Task:",-1)),i.value?(u(),m("span",Hr,$(i.value),1)):I("",!0)]),s.value?(u(),m("div",Fr,[c[2]||(c[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Ur,$(s.value),1)])):I("",!0),o.value?(u(),m("div",Br,[t("div",qr,[c[3]||(c[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",zr,$(o.value.length)+" characters",1)]),t("pre",Kr,$(o.value),1)])):I("",!0)]),a.value?(u(),m("div",Yr,[l.value?(u(),m("div",Gr,[c[4]||(c[4]=t("strong",null,"Error:",-1)),t("pre",Jr,$(r.value),1)])):(u(),m("div",Xr,[t("div",Qr,[c[5]||(c[5]=t("span",{class:"output-label"},"Agent Output:",-1)),d.value>0?(u(),m("span",Zr,$(d.value)+" lines",1)):I("",!0)]),t("div",ec,[t("pre",tc,$(r.value),1)])]))])):I("",!0)]))}},nc=G(sc,[["__scopeId","data-v-c520c244"]]),oc={class:"notebook-edit-tool-handler"},ic={class:"tool-section"},ac={class:"notebook-info"},lc={class:"file-path"},rc={class:"cell-info mt-2"},cc={class:"info-row"},dc={class:"info-row"},uc={key:0,class:"info-row"},mc={class:"badge bg-info"},pc={key:0,class:"source-preview mt-3"},fc={class:"preview-header"},vc={class:"preview-stats"},hc={class:"source-code"},_c={key:0,class:"tool-section"},gc={key:0},bc={key:1,class:"text-danger"},yc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.notebook_path||"Unknown"),o=b(()=>e.toolCall.input?.cell_id),i=b(()=>e.toolCall.input?.cell_type||"code"),a=b(()=>e.toolCall.input?.edit_mode||"replace"),l=b(()=>e.toolCall.input?.new_source||""),r=b(()=>l.value.split(`
`).length),d=b(()=>i.value==="code"?"bg-primary":"bg-secondary"),p=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=b(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const _=a.value;return _==="insert"?"Cell inserted successfully":_==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(_,v)=>(u(),m("div",oc,[t("div",ic,[t("div",ac,[v[0]||(v[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),v[1]||(v[1]=t("strong",null,"Notebook:",-1)),t("code",lc,$(s.value),1)]),t("div",rc,[t("div",cc,[v[2]||(v[2]=t("strong",null,"Cell ID:",-1)),t("code",null,$(o.value||"N/A"),1)]),t("div",dc,[v[3]||(v[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:Y(["badge",d.value])},$(i.value),3)]),a.value?(u(),m("div",uc,[v[4]||(v[4]=t("strong",null,"Edit Mode:",-1)),t("span",mc,$(a.value),1)])):I("",!0)]),l.value?(u(),m("div",pc,[t("div",fc,[v[5]||(v[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",vc,$(r.value)+" lines",1)]),t("pre",hc,[t("code",null,$(l.value),1)])])):I("",!0)]),n.toolCall.result?(u(),m("div",_c,[v[8]||(v[8]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Y(["tool-result",p.value])},[n.toolCall.result.success!==!1?(u(),m("div",gc,[v[6]||(v[6]=t("i",{class:"bi bi-check-circle"},null,-1)),K(" "+$(c.value),1)])):(u(),m("div",bc,[v[7]||(v[7]=t("i",{class:"bi bi-x-circle"},null,-1)),K(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)])):I("",!0)]))}},$c=G(yc,[["__scopeId","data-v-bf9ef8f9"]]),wc={class:"shell-tool-handler"},Ec={class:"tool-section"},Cc={class:"shell-info"},Sc={class:"shell-icon"},kc={key:0,class:"shell-id"},Tc={key:0,class:"filter-info mt-2"},xc={class:"filter-pattern"},Mc={key:0,class:"tool-section"},Ac={class:"result-header mb-2"},Oc={key:0,class:"mb-2"},Nc={class:"shell-output"},Dc={key:1,class:"mb-2"},Lc={class:"shell-output shell-output-error"},Ic={key:0},Pc={key:1,class:"text-danger"},jc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=b(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=b(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=b(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=b(()=>e.toolCall.input?.filter);function r(f,C){if(!f)return null;const y=new RegExp(`<${C}>([\\s\\S]*?)<\\/${C}>`,"i"),g=f.match(y);return g?g[1].trim():null}const d=b(()=>{const f=e.toolCall.result;if(!f)return null;let C=f;if(f.content&&(C=f.content),typeof C=="string")return{status:r(C,"status"),stdout:r(C,"stdout"),stderr:r(C,"stderr"),exit_code:r(C,"exit_code")};if(Array.isArray(C)){const y=C.find(g=>g.type==="text")?.text||"";return{status:r(y,"status"),stdout:r(y,"stdout"),stderr:r(y,"stderr"),exit_code:r(y,"exit_code")}}return{status:f.status||C.status,stdout:f.stdout||f.output||C.stdout||C.output,stderr:f.stderr||C.stderr,exit_code:f.exit_code||C.exit_code}});b(()=>{if(e.toolCall.name==="BashOutput"){const f=d.value;if(!f)return null;const C=[];return f.stdout&&C.push(f.stdout),f.stderr&&C.push(`[stderr]
${f.stderr}`),C.length>0?C.join(`

`):null}return null});const p=b(()=>d.value?.status),c=b(()=>{const f=p.value;return f==="running"?"bg-success":f==="completed"?"bg-secondary":f==="killed"||f==="terminated"?"bg-danger":"bg-info"}),_=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),v=b(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const f=d.value;if(f?.status==="running"&&!f.stdout&&!f.stderr)return"No new output since last check";if(f?.status==="failed")return`Shell failed (exit code ${f.exit_code||"unknown"})`}return"Operation completed"});return(f,C)=>(u(),m("div",wc,[t("div",Ec,[t("div",Cc,[t("span",Sc,$(s.value),1),t("strong",null,$(o.value)+":",1),a.value?(u(),m("code",kc,"Shell "+$(a.value),1)):I("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(u(),m("div",Tc,[C[0]||(C[0]=t("strong",null,"Filter:",-1)),t("code",xc,$(l.value),1)])):I("",!0)]),n.toolCall.result?(u(),m("div",Mc,[t("div",Ac,[t("strong",null,$(i.value)+":",1),p.value?(u(),m("span",{key:0,class:Y(["badge",c.value])},$(p.value),3)):I("",!0)]),d.value?.stdout?(u(),m("div",Oc,[C[1]||(C[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Nc,[t("pre",null,[t("code",null,$(d.value.stdout),1)])])])):I("",!0),d.value?.stderr?(u(),m("div",Dc,[C[2]||(C[2]=t("div",{class:"output-label text-danger"},[t("i",{class:"bi bi-exclamation-triangle"}),K(" Errors: ")],-1)),t("div",Lc,[t("pre",null,[t("code",null,$(d.value.stderr),1)])])])):I("",!0),!d.value?.stdout&&!d.value?.stderr?(u(),m("div",{key:2,class:Y(["tool-result",_.value])},[n.toolCall.result.success!==!1?(u(),m("div",Ic,[C[3]||(C[3]=t("i",{class:"bi bi-check-circle"},null,-1)),K(" "+$(v.value),1)])):(u(),m("div",Pc,[C[4]||(C[4]=t("i",{class:"bi bi-x-circle"},null,-1)),K(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)):I("",!0)])):I("",!0)]))}},yn=G(jc,[["__scopeId","data-v-99efb136"]]),Rc={class:"skill-tool-handler"},Vc={key:0,class:"tool-section"},Wc={class:"d-flex align-items-center gap-2"},Hc={class:"text-muted small"},Fc={key:0,class:"skill-content-body"},Uc={class:"skill-content-text"},Bc={key:1,class:"tool-section mt-3"},qc={class:"tool-result tool-result-error"},zc={class:"tool-code"},Kc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=oe(),i=N(!1);function a(){i.value=!i.value}b(()=>e.toolCall.input?.command||"Unknown Skill"),b(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),b(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const l=b(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const f=s.messagesBySession.get(v)||[],C=f.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(C===-1)return{running:null,content:null};let y=null,g=null;for(let h=C+1;h<Math.min(C+3,f.length);h++){const M=f[h];if(M.type!=="user")continue;const T=M.content||"";T.includes("<command-message>")&&T.includes("skill is running")?y=M:T.startsWith("Base directory for this skill:")&&(g=M)}return{running:y,content:g}});b(()=>{const v=l.value.content;if(!v)return null;const C=(v.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return C&&C[1]?C[1].trim():null});const r=b(()=>{const v=l.value.content;if(!v)return"";const f=v.content||"",C=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return f.replace(C,"").trim()}),d=b(()=>r.value.length>0),p=b(()=>r.value?r.value.split(`
`).length:0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=b(()=>{if(!c.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,f)=>(u(),m("div",Rc,[d.value?(u(),m("div",Vc,[t("div",{class:"skill-content-header",onClick:a},[t("div",Wc,[t("i",{class:Y(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),f[0]||(f[0]=t("strong",null,"Skill Content",-1)),t("span",Hc,"("+$(p.value)+" lines)",1)])]),i.value?(u(),m("div",Fc,[t("pre",Uc,$(r.value),1)])):I("",!0)])):I("",!0),c.value?(u(),m("div",Bc,[f[1]||(f[1]=t("div",{class:"tool-section-label text-danger"},[t("i",{class:"bi bi-x-circle"}),K(" Error: ")],-1)),t("div",qc,[t("pre",zc,$(_.value),1)])])):I("",!0)]))}},Yc=G(Kc,[["__scopeId","data-v-ba9a91da"]]),Gc={class:"slashcommand-tool-handler"},Jc={key:0,class:"tool-section"},Xc={class:"d-flex align-items-center gap-2"},Qc={class:"text-muted small"},Zc={key:0,class:"command-content-body"},ed={class:"command-content-text"},td={key:1,class:"tool-section mt-3"},sd={class:"tool-result tool-result-error"},nd={class:"tool-code"},od={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=oe(),i=N(!1);function a(){i.value=!i.value}b(()=>e.toolCall.input?.command||"Unknown Command"),b(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),b(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const l=b(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const f=s.messagesBySession.get(v)||[],C=f.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(C===-1)return{running:null,content:null};let y=null,g=null;for(let h=C+1;h<Math.min(C+3,f.length);h++){const M=f[h];if(M.type!=="user")continue;const T=M.content||"";T.includes("<command-message>")&&T.includes("<command-name>")&&T.includes("<command-args>")?y=M:T.includes("ARGUMENTS:")&&(g=M)}return{running:y,content:g}});b(()=>{const v=l.value.running;if(!v)return null;const C=(v.content||"").match(/<command-args>(.+?)<\/command-args>/s);return C&&C[1]?C[1].trim():null});const r=b(()=>{const v=l.value.content;if(!v)return"";const f=v.content||"",C=/\nARGUMENTS:.*$/s;return f.replace(C,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),d=b(()=>r.value.length>0),p=b(()=>r.value?r.value.split(`
`).length:0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=b(()=>{if(!c.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,f)=>(u(),m("div",Gc,[d.value?(u(),m("div",Jc,[t("div",{class:"command-content-header",onClick:a},[t("div",Xc,[t("i",{class:Y(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),f[0]||(f[0]=t("strong",null,"Command Content",-1)),t("span",Qc,"("+$(p.value)+" lines)",1)])]),i.value?(u(),m("div",Zc,[t("pre",ed,$(r.value),1)])):I("",!0)])):I("",!0),c.value?(u(),m("div",td,[f[1]||(f[1]=t("div",{class:"tool-section-label text-danger"},[t("i",{class:"bi bi-x-circle"}),K(" Error: ")],-1)),t("div",sd,[t("pre",nd,$(_.value),1)])])):I("",!0)]))}},id=G(od,[["__scopeId","data-v-17d3444e"]]),ad={class:"exit-plan-mode-tool-handler"},ld={class:"tool-section"},rd={key:0,class:"plan-content mt-2"},cd={class:"plan-text"},dd={key:0,class:"tool-section"},ud={key:0},md={key:1,class:"text-danger"},pd={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.plan),o=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),m("div",ad,[t("div",ld,[a[1]||(a[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(u(),m("div",rd,[a[0]||(a[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",cd,$(s.value),1)])):I("",!0)]),n.toolCall.result?(u(),m("div",dd,[a[4]||(a[4]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Y(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),m("div",ud,[...a[2]||(a[2]=[t("i",{class:"bi bi-check-circle"},null,-1),K(" Permission mode reverted to default ",-1)])])):(u(),m("div",md,[a[3]||(a[3]=t("i",{class:"bi bi-x-circle"},null,-1)),K(" "+$(n.toolCall.result.error||"Failed to exit plan mode"),1)]))],2)])):I("",!0)]))}},fd=G(pd,[["__scopeId","data-v-bd35183e"]]),vd={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},hd={class:"tool-status-icon"},_d=["title"],gd={class:"d-flex align-items-center gap-2"},bd={class:"text-muted"},yd={key:0,class:"card-body"},$d={key:0,class:"alert alert-warning mb-3"},wd={class:"d-flex align-items-center"},Ed={class:"mb-0 small"},Cd={key:1,class:"permission-prompt mt-3"},Sd={class:"alert alert-warning mb-3"},kd={class:"mb-0"},Td={class:"tool-name"},xd={key:0,class:"suggestions-section mb-3"},Md={class:"alert alert-info mb-0"},Ad={class:"suggestion-details p-2 bg-white rounded"},Od={class:"permission-buttons d-flex gap-2 mb-3"},Nd=["disabled"],Dd=["disabled"],Ld=["disabled"],Id={class:"guidance-section mt-3"},Pd=["disabled"],jd=["disabled"],Rd={key:2,class:"mt-3"},Vd={class:"alert alert-warning mb-0"},Wd={class:"d-flex align-items-center"},Hd={class:"mb-0 small"},Fd={key:3,class:"tool-section"},Ud={class:"alert alert-danger mb-0"},Bd={key:0},qd={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=oe(),i=je(),a=N(!1),l=N(null),r=N(""),d=b(()=>s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),p=b(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c={Read:ja,Write:el,Bash:pl,TodoWrite:Al,Edit:Ql,Grep:gn,Glob:gn,WebFetch:bn,WebSearch:bn,Task:nc,NotebookEdit:$c,BashOutput:yn,KillShell:yn,SlashCommand:id,Skill:Yc,ExitPlanMode:fd},_=b(()=>{const x=e.toolCall.name;return c[x]?c[x]:$a}),v=b(()=>{const x=[];switch(e.toolCall.status){case"pending":x.push("border-secondary");break;case"permission_required":x.push("border-warning");break;case"executing":x.push("border-primary");break;case"completed":y.value||e.toolCall.permissionDecision==="deny"?x.push("border-danger"):x.push("border-success");break;case"error":x.push("border-danger");break}return x.join(" ")}),f=b(()=>{switch(e.toolCall.status){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":y.value?"ðŸ’¥":"âœ…";case"error":return"ðŸ’¥";default:return"ðŸ”§"}}),C=b(()=>Dt(e.toolCall.timestamp)),y=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=b(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function h(x){if(!x)return"";const S=x.replace(/\\/g,"/").split("/");return S[S.length-1]}function M(x,S=200){return x?x.length<=S?x:x.substring(0,S)+"...":""}function T(x){if(!x)return null;if(x.content){const S=x.content.match(/exit code (\d+)/i);if(S)return parseInt(S[1])}return x.error?1:0}function E(x,S){const w=x?x.split(`
`).length:0;return{added:S?S.split(`
`).length:0,removed:w}}const A=b(()=>{const x=e.toolCall.name,S=e.toolCall.input||{},w=e.toolCall.result,O=e.toolCall.status;switch(x){case"Bash":case"Shell":case"Command":{const P=M(S.command,200);if(O==="completed"&&w){const j=T(w);return`Bash: ${P} (exit ${j})`}return`Bash: ${P}`}case"SlashCommand":{const P=M(S.command,200);return O==="completed"&&w?`SlashCommand: ${P}`:`SlashCommand: ${P}`}case"Edit":{const P=h(S.file_path);if(O==="completed"&&w&&!w.error){const{added:j,removed:U}=E(S.old_string,S.new_string);return j===U?`Edit: ${P} (${j} lines changed)`:`Edit: ${P} (${j} lines added, ${U} removed)`}return`Edit: ${P}`}case"Read":{const P=h(S.file_path);if(S.offset!==void 0||S.limit!==void 0){const U=(S.offset||0)+1,q=S.limit?(S.offset||0)+S.limit:"âˆž";return`Read: ${P} (lines ${U}-${q})`}return`Read: ${P} (full file)`}case"Write":{const P=h(S.file_path);if(O==="completed"&&w&&!w.error&&S.content){const j=S.content.split(`
`).length;return`Write: ${P} (${j} lines written)`}return`Write: ${P}`}case"Skill":{const P=S.command||"Unknown";return O==="completed"&&w?w.error?`Skill: ${P} (error)`:`Skill: ${P} (completed)`:`Skill: ${P}`}case"Task":{const P=S.subagent_type||"general",j=S.description||"Task";return O==="completed"&&w?w.error?`Task: (${P}) ${j} (error)`:`Task: (${P}) ${j} (completed)`:`Task: (${P}) ${j}`}case"TodoWrite":{if(S.todos&&Array.isArray(S.todos)){const P=S.todos.filter(q=>q.status==="completed").length,j=S.todos.length,U=S.todos.find(q=>q.status==="in_progress");return U?`Todo: Working on "${U.content}"`:`Todo: ${P}/${j} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const P=S.pattern||"",j=x==="Grep"?"Grep":"Glob";if(O==="completed"&&w&&!w.error){let U=0;return w.content&&(U=w.content.split(`
`).filter(ne=>ne.trim()).length),`${j}: "${P}" (${U} results)`}return`${j}: "${P}"`}case"WebFetch":case"WebSearch":{const P=S.url||S.query||"";if(x==="WebSearch"){const U=S.query||"",q=U.length>50?U.substring(0,50)+"...":U;return O==="completed"&&w?w.error?`Web: ${q} (error)`:`Web: ${q} (success)`:`Web: ${q}`}let j="";try{P&&(j=new URL(P.startsWith("http")?P:`https://${P}`).hostname)}catch{j=P.length>50?P.substring(0,50)+"...":P}return O==="completed"&&w?w.error?`Web: ${j} (error)`:`Web: ${j} (success)`:`Web: ${j||P}`}case"NotebookEdit":{const P=h(S.notebook_path),j=S.cell_number!==void 0?S.cell_number:"?",U=S.edit_mode||"replace";return`NotebookEdit: ${P} cell #${j} (${U})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${S.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${S.shell_id||"unknown"}`;default:return`${x}: executed`}}),L=b(()=>{const x=e.toolCall.name,S=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(x)?S.command||x:["Edit","Read","Write","NotebookEdit"].includes(x)&&(S.file_path||S.notebook_path)||x});function k(){const x=o.currentSessionId;x&&s.toggleToolExpansion(x,e.toolCall.id)}function D(x){return x.type==="setMode"?`Set permission mode to "${x.mode}"`:x.type==="allow"?`Allow tool: ${x.tool}`:JSON.stringify(x)}async function F(x,S,w=null){if(!a.value){a.value=!0,x==="allow"?l.value=S?"approve-apply":"approve":w?l.value="deny-guidance":l.value="deny";try{const O=o.currentSessionId;if(O){const P=S&&e.toolCall.suggestions?e.toolCall.suggestions:[];s.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:x,reasoning:x==="allow"?"User allowed permission":"User denied permission",applied_updates:P})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,x,S,w)}catch(O){console.error("Failed to send permission response:",O)}finally{a.value=!1,l.value=null}}}return(x,S)=>(u(),m("div",{class:Y(["tool-call-card card",v.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:k},[t("div",vd,[t("span",hd,$(f.value),1),t("strong",{class:"tool-name",title:L.value},$(A.value),9,_d)]),t("div",gd,[t("small",bd,$(C.value),1),t("i",{class:Y(["bi",n.toolCall.isExpanded?"bi-chevron-up":"bi-chevron-down"])},null,2)])]),n.toolCall.isExpanded?(u(),m("div",yd,[d.value?(u(),m("div",$d,[t("div",wd,[S[6]||(S[6]=t("i",{class:"bi bi-x-circle me-2",style:{"font-size":"1.2rem"}},null,-1)),t("div",null,[S[5]||(S[5]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",Ed,$(p.value?.message||"Session was terminated"),1)])])])):I("",!0),(u(),ge(oo(_.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!d.value?(u(),m("div",Cd,[t("div",Sd,[S[9]||(S[9]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",kd,[S[7]||(S[7]=K("Claude wants to use the ",-1)),t("code",Td,$(n.toolCall.name),1),S[8]||(S[8]=K(" tool.",-1))])]),g.value?(u(),m("div",xd,[t("div",Md,[S[10]||(S[10]=t("h6",{class:"mb-2"},[t("i",{class:"bi bi-lightbulb me-2"}),K(" Suggested Permission Update ")],-1)),S[11]||(S[11]=t("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),t("div",Ad,[(u(!0),m(ie,null,ce(n.toolCall.suggestions,(w,O)=>(u(),m("div",{key:O,class:"suggestion-item"},[t("code",null,$(D(w)),1)]))),128))]),S[12]||(S[12]=t("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):I("",!0),t("div",Od,[g.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:S[0]||(S[0]=w=>F("allow",!0)),disabled:a.value},[S[13]||(S[13]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),K(" "+$(a.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),1)],8,Nd)):I("",!0),t("button",{class:Y(["btn",g.value?"btn-outline-success":"btn-success"]),onClick:S[1]||(S[1]=w=>F("allow",!1)),disabled:a.value},[S[14]||(S[14]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),K(" "+$(a.value&&l.value==="approve"?"â³ Submitting...":g.value?"âœ… Approve Only":"âœ… Approve"),1)],10,Dd),t("button",{class:"btn btn-danger",onClick:S[2]||(S[2]=w=>F("deny",!1)),disabled:a.value},[S[15]||(S[15]=t("i",{class:"bi bi-x-circle me-1"},null,-1)),K(" "+$(a.value&&l.value==="deny"?"â³ Submitting...":"âŒ Deny"),1)],8,Ld)]),t("div",Id,[S[17]||(S[17]=t("label",{class:"form-label fw-bold"},[t("i",{class:"bi bi-chat-left-text me-1"}),K(" Provide Guidance (Optional) ")],-1)),S[18]||(S[18]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),se(t("textarea",{"onUpdate:modelValue":S[3]||(S[3]=w=>r.value=w),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Pd),[[ue,r.value]]),r.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:S[4]||(S[4]=w=>F("deny",!1,r.value)),disabled:a.value},[S[16]||(S[16]=t("i",{class:"bi bi-arrow-repeat me-1"},null,-1)),K(" "+$(a.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ’¡ Provide Guidance & Continue"),1)],8,jd)):I("",!0)])])):I("",!0),n.toolCall.status==="permission_required"&&d.value?(u(),m("div",Rd,[t("div",Vd,[t("div",Wd,[S[20]||(S[20]=t("i",{class:"bi bi-shield-x me-2",style:{"font-size":"1.2rem"}},null,-1)),t("div",null,[S[19]||(S[19]=t("strong",null,"Permission Request Cancelled",-1)),t("p",Hd,$(p.value?.message||"Session was terminated before permission could be granted"),1)])])])])):I("",!0),n.toolCall.permissionDecision==="deny"?(u(),m("div",Fd,[t("div",Ud,[S[21]||(S[21]=t("i",{class:"bi bi-x-circle"},null,-1)),S[22]||(S[22]=K(" Permission denied ",-1)),n.toolCall.result?.message?(u(),m("span",Bd," - "+$(n.toolCall.result.message),1)):I("",!0)])])):I("",!0)])):I("",!0)],2))}},zd=G(qd,[["__scopeId","data-v-0f254afa"]]),Kd={class:"message-row message-row-assistant"},Yd=["title"],Gd={class:"message-content-column"},Jd={key:0,class:"thinking-block mb-2"},Xd=["innerHTML"],Qd={key:2,class:"tool-calls"},Zd={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=oe();Ot.setOptions({breaks:!0,gfm:!0});const i=b(()=>Dt(e.message.timestamp)),a=b(()=>e.message.metadata?.model||null),l=b(()=>{const C=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${C}`}),r=b(()=>{const C=e.message.content||"";return C.trim().length>0&&C!=="Assistant response"}),d=b(()=>{const C=e.message.content||"";let y=Ot.parse(C);return y=y.replace(/\n</g,"<"),y=y.replace(/\n+$/,""),Ws.sanitize(y)}),p=b(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=b(()=>e.message.metadata?.thinking_content||""),_=b(()=>e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0),v=b(()=>e.message.metadata?.tool_uses||[]),f=b(()=>{const C=o.currentSessionId;if(!C)return[];const y=s.toolCallsBySession.get(C)||[];return v.value.map(g=>{const h=y.find(M=>M.id===g.id);return h||{id:g.id,name:g.name,input:g.input,status:"pending",result:null,timestamp:g.timestamp||e.message.timestamp,isExpanded:!0}})});return(C,y)=>(u(),m("div",Kd,[t("div",{class:"message-speaker",title:l.value},[...y[0]||(y[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Yd),t("div",Gd,[p.value?(u(),m("div",Jd,[ae(ua,{thinking:c.value},null,8,["thinking"])])):I("",!0),r.value?(u(),m("div",{key:1,class:"message-text",innerHTML:d.value},null,8,Xd)):I("",!0),_.value?(u(),m("div",Qd,[(u(!0),m(ie,null,ce(f.value,g=>(u(),ge(zd,{key:g.id,toolCall:g},null,8,["toolCall"]))),128))])):I("",!0)])]))}},eu=G(Zd,[["__scopeId","data-v-726a72a7"]]),tu={key:0,class:"message-row message-row-compaction"},su=["title"],nu={class:"message-content-column"},ou={class:"compaction-status-content"},iu={class:"text-muted ms-auto"},au={key:1,class:"message-row message-row-system"},lu=["title"],ru={class:"message-content-column"},cu={class:"system-text"},du={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>Dt(e.message.timestamp)),o=b(()=>`system
${s.value}`),i=b(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,l)=>i.value?(u(),m("div",tu,[t("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,su),t("div",nu,[t("div",ou,[l[1]||(l[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",iu,$(s.value),1)])])])):(u(),m("div",au,[t("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,lu),t("div",ru,[t("span",cu,$(n.message.content),1)])]))}},$n=G(du,[["__scopeId","data-v-a078178f"]]),uu={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>{switch(e.message.type){case"user":return ia;case"assistant":return eu;case"system":return $n;default:return $n}});return(o,i)=>(u(),ge(oo(s.value),{message:n.message},null,8,["message"]))}},mu=G(uu,[["__scopeId","data-v-f283c218"]]);var $e="top",Ce="bottom",Se="right",we="left",os="auto",$t=[$e,Ce,Se,we],st="start",pt="end",lo="clippingParents",Hs="viewport",ct="popper",ro="reference",Ds=$t.reduce(function(n,e){return n.concat([e+"-"+st,e+"-"+pt])},[]),Fs=[].concat($t,[os]).reduce(function(n,e){return n.concat([e,e+"-"+st,e+"-"+pt])},[]),co="beforeRead",uo="read",mo="afterRead",po="beforeMain",fo="main",vo="afterMain",ho="beforeWrite",_o="write",go="afterWrite",bo=[co,uo,mo,po,fo,vo,ho,_o,go];function Pe(n){return n?(n.nodeName||"").toLowerCase():null}function ke(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nt(n){var e=ke(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=ke(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Us(n){if(typeof ShadowRoot>"u")return!1;var e=ke(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function pu(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},a=e.elements[s];!Te(a)||!Pe(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(l){var r=i[l];r===!1?a.removeAttribute(l):a.setAttribute(l,r===!0?"":r)}))})}function fu(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),r=l.reduce(function(d,p){return d[p]="",d},{});!Te(i)||!Pe(i)||(Object.assign(i.style,r),Object.keys(a).forEach(function(d){i.removeAttribute(d)}))})}}const Bs={name:"applyStyles",enabled:!0,phase:"write",fn:pu,effect:fu,requires:["computeStyles"]};function De(n){return n.split("-")[0]}var tt=Math.max,Zt=Math.min,ft=Math.round;function Ls(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function yo(){return!/^((?!chrome|android).)*safari/i.test(Ls())}function vt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&ft(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&ft(o.height)/n.offsetHeight||1);var l=nt(n)?ke(n):window,r=l.visualViewport,d=!yo()&&s,p=(o.left+(d&&r?r.offsetLeft:0))/i,c=(o.top+(d&&r?r.offsetTop:0))/a,_=o.width/i,v=o.height/a;return{width:_,height:v,top:c,right:p+_,bottom:c+v,left:p,x:p,y:c}}function qs(n){var e=vt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function $o(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Us(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function He(n){return ke(n).getComputedStyle(n)}function vu(n){return["table","td","th"].indexOf(Pe(n))>=0}function Ge(n){return((nt(n)?n.ownerDocument:n.document)||window.document).documentElement}function is(n){return Pe(n)==="html"?n:n.assignedSlot||n.parentNode||(Us(n)?n.host:null)||Ge(n)}function wn(n){return!Te(n)||He(n).position==="fixed"?null:n.offsetParent}function hu(n){var e=/firefox/i.test(Ls()),s=/Trident/i.test(Ls());if(s&&Te(n)){var o=He(n);if(o.position==="fixed")return null}var i=is(n);for(Us(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Pe(i))<0;){var a=He(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Lt(n){for(var e=ke(n),s=wn(n);s&&vu(s)&&He(s).position==="static";)s=wn(s);return s&&(Pe(s)==="html"||Pe(s)==="body"&&He(s).position==="static")?e:s||hu(n)||e}function zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function xt(n,e,s){return tt(n,Zt(e,s))}function _u(n,e,s){var o=xt(n,e,s);return o>s?s:o}function wo(){return{top:0,right:0,bottom:0,left:0}}function Eo(n){return Object.assign({},wo(),n)}function Co(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var gu=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Eo(typeof e!="number"?e:Co(e,$t))};function bu(n){var e,s=n.state,o=n.name,i=n.options,a=s.elements.arrow,l=s.modifiersData.popperOffsets,r=De(s.placement),d=zs(r),p=[we,Se].indexOf(r)>=0,c=p?"height":"width";if(!(!a||!l)){var _=gu(i.padding,s),v=qs(a),f=d==="y"?$e:we,C=d==="y"?Ce:Se,y=s.rects.reference[c]+s.rects.reference[d]-l[d]-s.rects.popper[c],g=l[d]-s.rects.reference[d],h=Lt(a),M=h?d==="y"?h.clientHeight||0:h.clientWidth||0:0,T=y/2-g/2,E=_[f],A=M-v[c]-_[C],L=M/2-v[c]/2+T,k=xt(E,L,A),D=d;s.modifiersData[o]=(e={},e[D]=k,e.centerOffset=k-L,e)}}function yu(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||$o(e.elements.popper,i)&&(e.elements.arrow=i))}const So={name:"arrow",enabled:!0,phase:"main",fn:bu,effect:yu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ht(n){return n.split("-")[1]}var $u={top:"auto",right:"auto",bottom:"auto",left:"auto"};function wu(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:ft(s*i)/i||0,y:ft(o*i)/i||0}}function En(n){var e,s=n.popper,o=n.popperRect,i=n.placement,a=n.variation,l=n.offsets,r=n.position,d=n.gpuAcceleration,p=n.adaptive,c=n.roundOffsets,_=n.isFixed,v=l.x,f=v===void 0?0:v,C=l.y,y=C===void 0?0:C,g=typeof c=="function"?c({x:f,y}):{x:f,y};f=g.x,y=g.y;var h=l.hasOwnProperty("x"),M=l.hasOwnProperty("y"),T=we,E=$e,A=window;if(p){var L=Lt(s),k="clientHeight",D="clientWidth";if(L===ke(s)&&(L=Ge(s),He(L).position!=="static"&&r==="absolute"&&(k="scrollHeight",D="scrollWidth")),L=L,i===$e||(i===we||i===Se)&&a===pt){E=Ce;var F=_&&L===A&&A.visualViewport?A.visualViewport.height:L[k];y-=F-o.height,y*=d?1:-1}if(i===we||(i===$e||i===Ce)&&a===pt){T=Se;var x=_&&L===A&&A.visualViewport?A.visualViewport.width:L[D];f-=x-o.width,f*=d?1:-1}}var S=Object.assign({position:r},p&&$u),w=c===!0?wu({x:f,y},ke(s)):{x:f,y};if(f=w.x,y=w.y,d){var O;return Object.assign({},S,(O={},O[E]=M?"0":"",O[T]=h?"0":"",O.transform=(A.devicePixelRatio||1)<=1?"translate("+f+"px, "+y+"px)":"translate3d("+f+"px, "+y+"px, 0)",O))}return Object.assign({},S,(e={},e[E]=M?y+"px":"",e[T]=h?f+"px":"",e.transform="",e))}function Eu(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,a=s.adaptive,l=a===void 0?!0:a,r=s.roundOffsets,d=r===void 0?!0:r,p={placement:De(e.placement),variation:ht(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,En(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,En(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ks={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Eu,data:{}};var Ht={passive:!0};function Cu(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,l=o.resize,r=l===void 0?!0:l,d=ke(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&p.forEach(function(c){c.addEventListener("scroll",s.update,Ht)}),r&&d.addEventListener("resize",s.update,Ht),function(){a&&p.forEach(function(c){c.removeEventListener("scroll",s.update,Ht)}),r&&d.removeEventListener("resize",s.update,Ht)}}const Ys={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Cu,data:{}};var Su={left:"right",right:"left",bottom:"top",top:"bottom"};function Yt(n){return n.replace(/left|right|bottom|top/g,function(e){return Su[e]})}var ku={start:"end",end:"start"};function Cn(n){return n.replace(/start|end/g,function(e){return ku[e]})}function Gs(n){var e=ke(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function Js(n){return vt(Ge(n)).left+Gs(n).scrollLeft}function Tu(n,e){var s=ke(n),o=Ge(n),i=s.visualViewport,a=o.clientWidth,l=o.clientHeight,r=0,d=0;if(i){a=i.width,l=i.height;var p=yo();(p||!p&&e==="fixed")&&(r=i.offsetLeft,d=i.offsetTop)}return{width:a,height:l,x:r+Js(n),y:d}}function xu(n){var e,s=Ge(n),o=Gs(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=tt(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=tt(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),r=-o.scrollLeft+Js(n),d=-o.scrollTop;return He(i||s).direction==="rtl"&&(r+=tt(s.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:r,y:d}}function Xs(n){var e=He(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function ko(n){return["html","body","#document"].indexOf(Pe(n))>=0?n.ownerDocument.body:Te(n)&&Xs(n)?n:ko(is(n))}function Mt(n,e){var s;e===void 0&&(e=[]);var o=ko(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),a=ke(o),l=i?[a].concat(a.visualViewport||[],Xs(o)?o:[]):o,r=e.concat(l);return i?r:r.concat(Mt(is(l)))}function Is(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Mu(n,e){var s=vt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Sn(n,e,s){return e===Hs?Is(Tu(n,s)):nt(e)?Mu(e,s):Is(xu(Ge(n)))}function Au(n){var e=Mt(is(n)),s=["absolute","fixed"].indexOf(He(n).position)>=0,o=s&&Te(n)?Lt(n):n;return nt(o)?e.filter(function(i){return nt(i)&&$o(i,o)&&Pe(i)!=="body"}):[]}function Ou(n,e,s,o){var i=e==="clippingParents"?Au(n):[].concat(e),a=[].concat(i,[s]),l=a[0],r=a.reduce(function(d,p){var c=Sn(n,p,o);return d.top=tt(c.top,d.top),d.right=Zt(c.right,d.right),d.bottom=Zt(c.bottom,d.bottom),d.left=tt(c.left,d.left),d},Sn(n,l,o));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function To(n){var e=n.reference,s=n.element,o=n.placement,i=o?De(o):null,a=o?ht(o):null,l=e.x+e.width/2-s.width/2,r=e.y+e.height/2-s.height/2,d;switch(i){case $e:d={x:l,y:e.y-s.height};break;case Ce:d={x:l,y:e.y+e.height};break;case Se:d={x:e.x+e.width,y:r};break;case we:d={x:e.x-s.width,y:r};break;default:d={x:e.x,y:e.y}}var p=i?zs(i):null;if(p!=null){var c=p==="y"?"height":"width";switch(a){case st:d[p]=d[p]-(e[c]/2-s[c]/2);break;case pt:d[p]=d[p]+(e[c]/2-s[c]/2);break}}return d}function _t(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,a=s.strategy,l=a===void 0?n.strategy:a,r=s.boundary,d=r===void 0?lo:r,p=s.rootBoundary,c=p===void 0?Hs:p,_=s.elementContext,v=_===void 0?ct:_,f=s.altBoundary,C=f===void 0?!1:f,y=s.padding,g=y===void 0?0:y,h=Eo(typeof g!="number"?g:Co(g,$t)),M=v===ct?ro:ct,T=n.rects.popper,E=n.elements[C?M:v],A=Ou(nt(E)?E:E.contextElement||Ge(n.elements.popper),d,c,l),L=vt(n.elements.reference),k=To({reference:L,element:T,placement:i}),D=Is(Object.assign({},T,k)),F=v===ct?D:L,x={top:A.top-F.top+h.top,bottom:F.bottom-A.bottom+h.bottom,left:A.left-F.left+h.left,right:F.right-A.right+h.right},S=n.modifiersData.offset;if(v===ct&&S){var w=S[i];Object.keys(x).forEach(function(O){var P=[Se,Ce].indexOf(O)>=0?1:-1,j=[$e,Ce].indexOf(O)>=0?"y":"x";x[O]+=w[j]*P})}return x}function Nu(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,a=s.rootBoundary,l=s.padding,r=s.flipVariations,d=s.allowedAutoPlacements,p=d===void 0?Fs:d,c=ht(o),_=c?r?Ds:Ds.filter(function(C){return ht(C)===c}):$t,v=_.filter(function(C){return p.indexOf(C)>=0});v.length===0&&(v=_);var f=v.reduce(function(C,y){return C[y]=_t(n,{placement:y,boundary:i,rootBoundary:a,padding:l})[De(y)],C},{});return Object.keys(f).sort(function(C,y){return f[C]-f[y]})}function Du(n){if(De(n)===os)return[];var e=Yt(n);return[Cn(n),e,Cn(e)]}function Lu(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!0:l,d=s.fallbackPlacements,p=s.padding,c=s.boundary,_=s.rootBoundary,v=s.altBoundary,f=s.flipVariations,C=f===void 0?!0:f,y=s.allowedAutoPlacements,g=e.options.placement,h=De(g),M=h===g,T=d||(M||!C?[Yt(g)]:Du(g)),E=[g].concat(T).reduce(function(z,de){return z.concat(De(de)===os?Nu(e,{placement:de,boundary:c,rootBoundary:_,padding:p,flipVariations:C,allowedAutoPlacements:y}):de)},[]),A=e.rects.reference,L=e.rects.popper,k=new Map,D=!0,F=E[0],x=0;x<E.length;x++){var S=E[x],w=De(S),O=ht(S)===st,P=[$e,Ce].indexOf(w)>=0,j=P?"width":"height",U=_t(e,{placement:S,boundary:c,rootBoundary:_,altBoundary:v,padding:p}),q=P?O?Se:we:O?Ce:$e;A[j]>L[j]&&(q=Yt(q));var ne=Yt(q),B=[];if(a&&B.push(U[w]<=0),r&&B.push(U[q]<=0,U[ne]<=0),B.every(function(z){return z})){F=S,D=!1;break}k.set(S,B)}if(D)for(var V=C?3:1,re=function(de){var W=E.find(function(H){var J=k.get(H);if(J)return J.slice(0,de).every(function(Q){return Q})});if(W)return F=W,"break"},_e=V;_e>0;_e--){var ee=re(_e);if(ee==="break")break}e.placement!==F&&(e.modifiersData[o]._skip=!0,e.placement=F,e.reset=!0)}}const xo={name:"flip",enabled:!0,phase:"main",fn:Lu,requiresIfExists:["offset"],data:{_skip:!1}};function kn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Tn(n){return[$e,Se,Ce,we].some(function(e){return n[e]>=0})}function Iu(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=_t(e,{elementContext:"reference"}),r=_t(e,{altBoundary:!0}),d=kn(l,o),p=kn(r,i,a),c=Tn(d),_=Tn(p);e.modifiersData[s]={referenceClippingOffsets:d,popperEscapeOffsets:p,isReferenceHidden:c,hasPopperEscaped:_},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":_})}const Mo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Iu};function Pu(n,e,s){var o=De(n),i=[we,$e].indexOf(o)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,l=a[0],r=a[1];return l=l||0,r=(r||0)*i,[we,Se].indexOf(o)>=0?{x:r,y:l}:{x:l,y:r}}function ju(n){var e=n.state,s=n.options,o=n.name,i=s.offset,a=i===void 0?[0,0]:i,l=Fs.reduce(function(c,_){return c[_]=Pu(_,e.rects,a),c},{}),r=l[e.placement],d=r.x,p=r.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=l}const Ao={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ju};function Ru(n){var e=n.state,s=n.name;e.modifiersData[s]=To({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Qs={name:"popperOffsets",enabled:!0,phase:"read",fn:Ru,data:{}};function Vu(n){return n==="x"?"y":"x"}function Wu(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!1:l,d=s.boundary,p=s.rootBoundary,c=s.altBoundary,_=s.padding,v=s.tether,f=v===void 0?!0:v,C=s.tetherOffset,y=C===void 0?0:C,g=_t(e,{boundary:d,rootBoundary:p,padding:_,altBoundary:c}),h=De(e.placement),M=ht(e.placement),T=!M,E=zs(h),A=Vu(E),L=e.modifiersData.popperOffsets,k=e.rects.reference,D=e.rects.popper,F=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,x=typeof F=="number"?{mainAxis:F,altAxis:F}:Object.assign({mainAxis:0,altAxis:0},F),S=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,w={x:0,y:0};if(L){if(a){var O,P=E==="y"?$e:we,j=E==="y"?Ce:Se,U=E==="y"?"height":"width",q=L[E],ne=q+g[P],B=q-g[j],V=f?-D[U]/2:0,re=M===st?k[U]:D[U],_e=M===st?-D[U]:-k[U],ee=e.elements.arrow,z=f&&ee?qs(ee):{width:0,height:0},de=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:wo(),W=de[P],H=de[j],J=xt(0,k[U],z[U]),Q=T?k[U]/2-V-J-W-x.mainAxis:re-J-W-x.mainAxis,Z=T?-k[U]/2+V+J+H+x.mainAxis:_e+J+H+x.mainAxis,fe=e.elements.arrow&&Lt(e.elements.arrow),St=fe?E==="y"?fe.clientTop||0:fe.clientLeft||0:0,Vt=(O=S?.[E])!=null?O:0,di=q+Q-Vt-St,ui=q+Z-Vt,ln=xt(f?Zt(ne,di):ne,q,f?tt(B,ui):B);L[E]=ln,w[E]=ln-q}if(r){var rn,mi=E==="x"?$e:we,pi=E==="x"?Ce:Se,Qe=L[A],Wt=A==="y"?"height":"width",cn=Qe+g[mi],dn=Qe-g[pi],ms=[$e,we].indexOf(h)!==-1,un=(rn=S?.[A])!=null?rn:0,mn=ms?cn:Qe-k[Wt]-D[Wt]-un+x.altAxis,pn=ms?Qe+k[Wt]+D[Wt]-un-x.altAxis:dn,fn=f&&ms?_u(mn,Qe,pn):xt(f?mn:cn,Qe,f?pn:dn);L[A]=fn,w[A]=fn-Qe}e.modifiersData[o]=w}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:Wu,requiresIfExists:["offset"]};function Hu(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Fu(n){return n===ke(n)||!Te(n)?Gs(n):Hu(n)}function Uu(n){var e=n.getBoundingClientRect(),s=ft(e.width)/n.offsetWidth||1,o=ft(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Bu(n,e,s){s===void 0&&(s=!1);var o=Te(e),i=Te(e)&&Uu(e),a=Ge(e),l=vt(n,i,s),r={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(o||!o&&!s)&&((Pe(e)!=="body"||Xs(a))&&(r=Fu(e)),Te(e)?(d=vt(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):a&&(d.x=Js(a))),{x:l.left+r.scrollLeft-d.x,y:l.top+r.scrollTop-d.y,width:l.width,height:l.height}}function qu(n){var e=new Map,s=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){s.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(r){if(!s.has(r)){var d=e.get(r);d&&i(d)}}),o.push(a)}return n.forEach(function(a){s.has(a.name)||i(a)}),o}function zu(n){var e=qu(n);return bo.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function Ku(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Yu(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var xn={placement:"bottom",modifiers:[],strategy:"absolute"};function Mn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function as(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,a=i===void 0?xn:i;return function(r,d,p){p===void 0&&(p=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},xn,a),modifiersData:{},elements:{reference:r,popper:d},attributes:{},styles:{}},_=[],v=!1,f={state:c,setOptions:function(h){var M=typeof h=="function"?h(c.options):h;y(),c.options=Object.assign({},a,c.options,M),c.scrollParents={reference:nt(r)?Mt(r):r.contextElement?Mt(r.contextElement):[],popper:Mt(d)};var T=zu(Yu([].concat(o,c.options.modifiers)));return c.orderedModifiers=T.filter(function(E){return E.enabled}),C(),f.update()},forceUpdate:function(){if(!v){var h=c.elements,M=h.reference,T=h.popper;if(Mn(M,T)){c.rects={reference:Bu(M,Lt(T),c.options.strategy==="fixed"),popper:qs(T)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(x){return c.modifiersData[x.name]=Object.assign({},x.data)});for(var E=0;E<c.orderedModifiers.length;E++){if(c.reset===!0){c.reset=!1,E=-1;continue}var A=c.orderedModifiers[E],L=A.fn,k=A.options,D=k===void 0?{}:k,F=A.name;typeof L=="function"&&(c=L({state:c,options:D,name:F,instance:f})||c)}}}},update:Ku(function(){return new Promise(function(g){f.forceUpdate(),g(c)})}),destroy:function(){y(),v=!0}};if(!Mn(r,d))return f;f.setOptions(p).then(function(g){!v&&p.onFirstUpdate&&p.onFirstUpdate(g)});function C(){c.orderedModifiers.forEach(function(g){var h=g.name,M=g.options,T=M===void 0?{}:M,E=g.effect;if(typeof E=="function"){var A=E({state:c,name:h,instance:f,options:T}),L=function(){};_.push(A||L)}})}function y(){_.forEach(function(g){return g()}),_=[]}return f}}var Gu=as(),Ju=[Ys,Qs,Ks,Bs],Xu=as({defaultModifiers:Ju}),Qu=[Ys,Qs,Ks,Bs,Ao,xo,Oo,So,Mo],Zs=as({defaultModifiers:Qu});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:vo,afterRead:mo,afterWrite:go,applyStyles:Bs,arrow:So,auto:os,basePlacements:$t,beforeMain:po,beforeRead:co,beforeWrite:ho,bottom:Ce,clippingParents:lo,computeStyles:Ks,createPopper:Zs,createPopperBase:Gu,createPopperLite:Xu,detectOverflow:_t,end:pt,eventListeners:Ys,flip:xo,hide:Mo,left:we,main:fo,modifierPhases:bo,offset:Ao,placements:Fs,popper:ct,popperGenerator:as,popperOffsets:Qs,preventOverflow:Oo,read:uo,reference:ro,right:Se,start:st,top:$e,variationPlacements:Ds,viewport:Hs,write:_o},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Ue=new Map,hs={set(n,e,s){Ue.has(n)||Ue.set(n,new Map);const o=Ue.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return Ue.has(n)&&Ue.get(n).get(e)||null},remove(n,e){if(!Ue.has(n))return;const s=Ue.get(n);s.delete(e),s.size===0&&Ue.delete(n)}},Zu=1e6,em=1e3,Ps="transitionend",Do=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),tm=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),sm=n=>{do n+=Math.floor(Math.random()*Zu);while(document.getElementById(n));return n},nm=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*em)},Lo=n=>{n.dispatchEvent(new Event(Ps))},Re=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Be=n=>Re(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Do(n)):null,wt=n=>{if(!Re(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},qe=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Io=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Io(n.parentNode):null},es=()=>{},It=n=>{n.offsetHeight},Po=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_s=[],om=n=>{document.readyState==="loading"?(_s.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of _s)e()}),_s.push(n)):n()},xe=()=>document.documentElement.dir==="rtl",Ae=n=>{om(()=>{const e=Po();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ee=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,jo=(n,e,s=!0)=>{if(!s){Ee(n);return}const i=nm(e)+5;let a=!1;const l=({target:r})=>{r===e&&(a=!0,e.removeEventListener(Ps,l),Ee(n))};e.addEventListener(Ps,l),setTimeout(()=>{a||Lo(e)},i)},en=(n,e,s,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!s&&o?n[i-1]:n[0]:(a+=s?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},im=/[^.]*(?=\..*)\.|.*/,am=/\..*/,lm=/::\d+$/,gs={};let An=1;const Ro={mouseenter:"mouseover",mouseleave:"mouseout"},rm=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vo(n,e){return e&&`${e}::${An++}`||n.uidEvent||An++}function Wo(n){const e=Vo(n);return n.uidEvent=e,gs[e]=gs[e]||{},gs[e]}function cm(n,e){return function s(o){return tn(o,{delegateTarget:n}),s.oneOff&&R.off(n,o.type,e),e.apply(n,[o])}}function dm(n,e,s){return function o(i){const a=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const r of a)if(r===l)return tn(i,{delegateTarget:l}),o.oneOff&&R.off(n,i.type,e,s),s.apply(l,[i])}}function Ho(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Fo(n,e,s){const o=typeof e=="string",i=o?s:e||s;let a=Uo(n);return rm.has(a)||(a=n),[o,i,a]}function On(n,e,s,o,i){if(typeof e!="string"||!n)return;let[a,l,r]=Fo(e,s,o);e in Ro&&(l=(C=>function(y){if(!y.relatedTarget||y.relatedTarget!==y.delegateTarget&&!y.delegateTarget.contains(y.relatedTarget))return C.call(this,y)})(l));const d=Wo(n),p=d[r]||(d[r]={}),c=Ho(p,l,a?s:null);if(c){c.oneOff=c.oneOff&&i;return}const _=Vo(l,e.replace(im,"")),v=a?dm(n,s,l):cm(n,l);v.delegationSelector=a?s:null,v.callable=l,v.oneOff=i,v.uidEvent=_,p[_]=v,n.addEventListener(r,v,a)}function js(n,e,s,o,i){const a=Ho(e[s],o,i);a&&(n.removeEventListener(s,a,!!i),delete e[s][a.uidEvent])}function um(n,e,s,o){const i=e[s]||{};for(const[a,l]of Object.entries(i))a.includes(o)&&js(n,e,s,l.callable,l.delegationSelector)}function Uo(n){return n=n.replace(am,""),Ro[n]||n}const R={on(n,e,s,o){On(n,e,s,o,!1)},one(n,e,s,o){On(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,a,l]=Fo(e,s,o),r=l!==e,d=Wo(n),p=d[l]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(p).length)return;js(n,d,l,a,i?s:null);return}if(c)for(const _ of Object.keys(d))um(n,d,_,e.slice(1));for(const[_,v]of Object.entries(p)){const f=_.replace(lm,"");(!r||e.includes(f))&&js(n,d,l,v.callable,v.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=Po(),i=Uo(e),a=e!==i;let l=null,r=!0,d=!0,p=!1;a&&o&&(l=o.Event(e,s),o(n).trigger(l),r=!l.isPropagationStopped(),d=!l.isImmediatePropagationStopped(),p=l.isDefaultPrevented());const c=tn(new Event(e,{bubbles:r,cancelable:!0}),s);return p&&c.preventDefault(),d&&n.dispatchEvent(c),c.defaultPrevented&&l&&l.preventDefault(),c}};function tn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Nn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function bs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ve={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${bs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${bs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Nn(n.dataset[o])}return e},getDataAttribute(n,e){return Nn(n.getAttribute(`data-bs-${bs(e)}`))}};class Pt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Re(s)?Ve.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Re(s)?Ve.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const a=e[o],l=Re(a)?"element":tm(a);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const mm="5.3.8";class Ne extends Pt{constructor(e,s){super(),e=Be(e),e&&(this._element=e,this._config=this._getConfig(s),hs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){hs.remove(this._element,this.constructor.DATA_KEY),R.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){jo(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return hs.get(Be(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return mm}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const ys=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>Do(s)).join(","):null},X={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!qe(s)&&wt(s))},getSelectorFromElement(n){const e=ys(n);return e&&X.findOne(e)?e:null},getElementFromSelector(n){const e=ys(n);return e?X.findOne(e):null},getMultipleElementsFromSelector(n){const e=ys(n);return e?X.find(e):[]}},ls=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;R.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),qe(this))return;const a=X.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},pm="alert",fm="bs.alert",Bo=`.${fm}`,vm=`close${Bo}`,hm=`closed${Bo}`,_m="fade",gm="show";class rs extends Ne{static get NAME(){return pm}close(){if(R.trigger(this._element,vm).defaultPrevented)return;this._element.classList.remove(gm);const s=this._element.classList.contains(_m);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),R.trigger(this._element,hm),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=rs.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ls(rs,"close");Ae(rs);const bm="button",ym="bs.button",$m=`.${ym}`,wm=".data-api",Em="active",Dn='[data-bs-toggle="button"]',Cm=`click${$m}${wm}`;class cs extends Ne{static get NAME(){return bm}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Em))}static jQueryInterface(e){return this.each(function(){const s=cs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}R.on(document,Cm,Dn,n=>{n.preventDefault();const e=n.target.closest(Dn);cs.getOrCreateInstance(e).toggle()});Ae(cs);const Sm="swipe",Et=".bs.swipe",km=`touchstart${Et}`,Tm=`touchmove${Et}`,xm=`touchend${Et}`,Mm=`pointerdown${Et}`,Am=`pointerup${Et}`,Om="touch",Nm="pen",Dm="pointer-event",Lm=40,Im={endCallback:null,leftCallback:null,rightCallback:null},Pm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class ts extends Pt{constructor(e,s){super(),this._element=e,!(!e||!ts.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Im}static get DefaultType(){return Pm}static get NAME(){return Sm}dispose(){R.off(this._element,Et)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ee(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Lm)return;const s=e/this._deltaX;this._deltaX=0,s&&Ee(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(R.on(this._element,Mm,e=>this._start(e)),R.on(this._element,Am,e=>this._end(e)),this._element.classList.add(Dm)):(R.on(this._element,km,e=>this._start(e)),R.on(this._element,Tm,e=>this._move(e)),R.on(this._element,xm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Nm||e.pointerType===Om)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const jm="carousel",Rm="bs.carousel",Je=`.${Rm}`,qo=".data-api",Vm="ArrowLeft",Wm="ArrowRight",Hm=500,kt="next",lt="prev",dt="left",Gt="right",Fm=`slide${Je}`,$s=`slid${Je}`,Um=`keydown${Je}`,Bm=`mouseenter${Je}`,qm=`mouseleave${Je}`,zm=`dragstart${Je}`,Km=`load${Je}${qo}`,Ym=`click${Je}${qo}`,zo="carousel",Ft="active",Gm="slide",Jm="carousel-item-end",Xm="carousel-item-start",Qm="carousel-item-next",Zm="carousel-item-prev",Ko=".active",Yo=".carousel-item",ep=Ko+Yo,tp=".carousel-item img",sp=".carousel-indicators",np="[data-bs-slide], [data-bs-slide-to]",op='[data-bs-ride="carousel"]',ip={[Vm]:Gt,[Wm]:dt},ap={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},lp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class jt extends Ne{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=X.findOne(sp,this._element),this._addEventListeners(),this._config.ride===zo&&this.cycle()}static get Default(){return ap}static get DefaultType(){return lp}static get NAME(){return jm}next(){this._slide(kt)}nextWhenVisible(){!document.hidden&&wt(this._element)&&this.next()}prev(){this._slide(lt)}pause(){this._isSliding&&Lo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){R.one(this._element,$s,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){R.one(this._element,$s,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?kt:lt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&R.on(this._element,Um,e=>this._keydown(e)),this._config.pause==="hover"&&(R.on(this._element,Bm,()=>this.pause()),R.on(this._element,qm,()=>this._maybeEnableCycle())),this._config.touch&&ts.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of X.find(tp,this._element))R.on(o,zm,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(dt)),rightCallback:()=>this._slide(this._directionToOrder(Gt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Hm+this._config.interval))}};this._swipeHelper=new ts(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=ip[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=X.findOne(Ko,this._indicatorsElement);s.classList.remove(Ft),s.removeAttribute("aria-current");const o=X.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Ft),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===kt,a=s||en(this._getItems(),o,i,this._config.wrap);if(a===o)return;const l=this._getItemIndex(a),r=f=>R.trigger(this._element,f,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(r(Fm).defaultPrevented||!o||!a)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=a;const c=i?Xm:Jm,_=i?Qm:Zm;a.classList.add(_),It(a),o.classList.add(c),a.classList.add(c);const v=()=>{a.classList.remove(c,_),a.classList.add(Ft),o.classList.remove(Ft,_,c),this._isSliding=!1,r($s)};this._queueCallback(v,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(Gm)}_getActive(){return X.findOne(ep,this._element)}_getItems(){return X.find(Yo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return xe()?e===dt?lt:kt:e===dt?kt:lt}_orderToDirection(e){return xe()?e===lt?dt:Gt:e===lt?Gt:dt}static jQueryInterface(e){return this.each(function(){const s=jt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}R.on(document,Ym,np,function(n){const e=X.getElementFromSelector(this);if(!e||!e.classList.contains(zo))return;n.preventDefault();const s=jt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Ve.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});R.on(window,Km,()=>{const n=X.find(op);for(const e of n)jt.getOrCreateInstance(e)});Ae(jt);const rp="collapse",cp="bs.collapse",Rt=`.${cp}`,dp=".data-api",up=`show${Rt}`,mp=`shown${Rt}`,pp=`hide${Rt}`,fp=`hidden${Rt}`,vp=`click${Rt}${dp}`,ws="show",mt="collapse",Ut="collapsing",hp="collapsed",_p=`:scope .${mt} .${mt}`,gp="collapse-horizontal",bp="width",yp="height",$p=".collapse.show, .collapse.collapsing",Rs='[data-bs-toggle="collapse"]',wp={parent:null,toggle:!0},Ep={parent:"(null|element)",toggle:"boolean"};class gt extends Ne{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=X.find(Rs);for(const i of o){const a=X.getSelectorFromElement(i),l=X.find(a).filter(r=>r===this._element);a!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return wp}static get DefaultType(){return Ep}static get NAME(){return rp}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren($p).filter(r=>r!==this._element).map(r=>gt.getOrCreateInstance(r,{toggle:!1}))),e.length&&e[0]._isTransitioning||R.trigger(this._element,up).defaultPrevented)return;for(const r of e)r.hide();const o=this._getDimension();this._element.classList.remove(mt),this._element.classList.add(Ut),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Ut),this._element.classList.add(mt,ws),this._element.style[o]="",R.trigger(this._element,mp)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||R.trigger(this._element,pp).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,It(this._element),this._element.classList.add(Ut),this._element.classList.remove(mt,ws);for(const i of this._triggerArray){const a=X.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Ut),this._element.classList.add(mt),R.trigger(this._element,fp)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ws)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Be(e.parent),e}_getDimension(){return this._element.classList.contains(gp)?bp:yp}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Rs);for(const s of e){const o=X.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=X.find(_p,this._config.parent);return X.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(hp,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=gt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}R.on(document,vp,Rs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of X.getMultipleElementsFromSelector(this))gt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ae(gt);const Ln="dropdown",Cp="bs.dropdown",ot=`.${Cp}`,sn=".data-api",Sp="Escape",In="Tab",kp="ArrowUp",Pn="ArrowDown",Tp=2,xp=`hide${ot}`,Mp=`hidden${ot}`,Ap=`show${ot}`,Op=`shown${ot}`,Go=`click${ot}${sn}`,Jo=`keydown${ot}${sn}`,Np=`keyup${ot}${sn}`,ut="show",Dp="dropup",Lp="dropend",Ip="dropstart",Pp="dropup-center",jp="dropdown-center",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Rp=`${Ze}.${ut}`,Jt=".dropdown-menu",Vp=".navbar",Wp=".navbar-nav",Hp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Fp=xe()?"top-end":"top-start",Up=xe()?"top-start":"top-end",Bp=xe()?"bottom-end":"bottom-start",qp=xe()?"bottom-start":"bottom-end",zp=xe()?"left-start":"right-start",Kp=xe()?"right-start":"left-start",Yp="top",Gp="bottom",Jp={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Xp={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Le extends Ne{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=X.next(this._element,Jt)[0]||X.prev(this._element,Jt)[0]||X.findOne(Jt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Jp}static get DefaultType(){return Xp}static get NAME(){return Ln}toggle(){return this._isShown()?this.hide():this.show()}show(){if(qe(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!R.trigger(this._element,Ap,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Wp))for(const o of[].concat(...document.body.children))R.on(o,"mouseover",es);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ut),this._element.classList.add(ut),R.trigger(this._element,Op,e)}}hide(){if(qe(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!R.trigger(this._element,xp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))R.off(o,"mouseover",es);this._popper&&this._popper.destroy(),this._menu.classList.remove(ut),this._element.classList.remove(ut),this._element.setAttribute("aria-expanded","false"),Ve.removeDataAttribute(this._menu,"popper"),R.trigger(this._element,Mp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Re(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Ln.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Re(this._config.reference)?e=Be(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Zs(e,this._menu,s)}_isShown(){return this._menu.classList.contains(ut)}_getPlacement(){const e=this._parent;if(e.classList.contains(Lp))return zp;if(e.classList.contains(Ip))return Kp;if(e.classList.contains(Pp))return Yp;if(e.classList.contains(jp))return Gp;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Dp)?s?Up:Fp:s?qp:Bp}_detectNavbar(){return this._element.closest(Vp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ve.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ee(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=X.find(Hp,this._menu).filter(i=>wt(i));o.length&&en(o,s,e===Pn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Le.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===Tp||e.type==="keyup"&&e.key!==In)return;const s=X.find(Rp);for(const o of s){const i=Le.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),l=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===In||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const r={relatedTarget:i._element};e.type==="click"&&(r.clickEvent=e),i._completeHide(r)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Sp,i=[kp,Pn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const a=this.matches(Ze)?this:X.prev(this,Ze)[0]||X.next(this,Ze)[0]||X.findOne(Ze,e.delegateTarget.parentNode),l=Le.getOrCreateInstance(a);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),a.focus())}}R.on(document,Jo,Ze,Le.dataApiKeydownHandler);R.on(document,Jo,Jt,Le.dataApiKeydownHandler);R.on(document,Go,Le.clearMenus);R.on(document,Np,Le.clearMenus);R.on(document,Go,Ze,function(n){n.preventDefault(),Le.getOrCreateInstance(this).toggle()});Ae(Le);const Xo="backdrop",Qp="fade",jn="show",Rn=`mousedown.bs.${Xo}`,Zp={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},ef={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Qo extends Pt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Zp}static get DefaultType(){return ef}static get NAME(){return Xo}show(e){if(!this._config.isVisible){Ee(e);return}this._append();const s=this._getElement();this._config.isAnimated&&It(s),s.classList.add(jn),this._emulateAnimation(()=>{Ee(e)})}hide(e){if(!this._config.isVisible){Ee(e);return}this._getElement().classList.remove(jn),this._emulateAnimation(()=>{this.dispose(),Ee(e)})}dispose(){this._isAppended&&(R.off(this._element,Rn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Qp),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Be(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),R.on(e,Rn,()=>{Ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){jo(e,this._getElement(),this._config.isAnimated)}}const tf="focustrap",sf="bs.focustrap",ss=`.${sf}`,nf=`focusin${ss}`,of=`keydown.tab${ss}`,af="Tab",lf="forward",Vn="backward",rf={autofocus:!0,trapElement:null},cf={autofocus:"boolean",trapElement:"element"};class Zo extends Pt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return rf}static get DefaultType(){return cf}static get NAME(){return tf}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),R.off(document,ss),R.on(document,nf,e=>this._handleFocusin(e)),R.on(document,of,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,R.off(document,ss))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=X.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Vn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===af&&(this._lastTabNavDirection=e.shiftKey?Vn:lf)}}const Wn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Hn=".sticky-top",Bt="padding-right",Fn="margin-right";class Vs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Bt,s=>s+e),this._setElementAttributes(Wn,Bt,s=>s+e),this._setElementAttributes(Hn,Fn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Bt),this._resetElementAttributes(Wn,Bt),this._resetElementAttributes(Hn,Fn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),a=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,s);const r=window.getComputedStyle(l).getPropertyValue(s);l.style.setProperty(s,`${o(Number.parseFloat(r))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Ve.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const a=Ve.getDataAttribute(i,s);if(a===null){i.style.removeProperty(s);return}Ve.removeDataAttribute(i,s),i.style.setProperty(s,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Re(e)){s(e);return}for(const o of X.find(e,this._element))s(o)}}const df="modal",uf="bs.modal",Me=`.${uf}`,mf=".data-api",pf="Escape",ff=`hide${Me}`,vf=`hidePrevented${Me}`,ei=`hidden${Me}`,ti=`show${Me}`,hf=`shown${Me}`,_f=`resize${Me}`,gf=`click.dismiss${Me}`,bf=`mousedown.dismiss${Me}`,yf=`keydown.dismiss${Me}`,$f=`click${Me}${mf}`,Un="modal-open",wf="fade",Bn="show",Es="modal-static",Ef=".modal.show",Cf=".modal-dialog",Sf=".modal-body",kf='[data-bs-toggle="modal"]',Tf={backdrop:!0,focus:!0,keyboard:!0},xf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ze extends Ne{constructor(e,s){super(e,s),this._dialog=X.findOne(Cf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Vs,this._addEventListeners()}static get Default(){return Tf}static get DefaultType(){return xf}static get NAME(){return df}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||R.trigger(this._element,ti,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Un),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||R.trigger(this._element,ff).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Bn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){R.off(window,Me),R.off(this._dialog,Me),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Qo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=X.findOne(Sf,this._dialog);s&&(s.scrollTop=0),It(this._element),this._element.classList.add(Bn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,R.trigger(this._element,hf,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){R.on(this._element,yf,e=>{if(e.key===pf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),R.on(window,_f,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),R.on(this._element,bf,e=>{R.one(this._element,gf,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Un),this._resetAdjustments(),this._scrollBar.reset(),R.trigger(this._element,ei)})}_isAnimated(){return this._element.classList.contains(wf)}_triggerBackdropTransition(){if(R.trigger(this._element,vf).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Es)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Es),this._queueCallback(()=>{this._element.classList.remove(Es),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=xe()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=xe()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}R.on(document,$f,kf,function(n){const e=X.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),R.one(e,ti,i=>{i.defaultPrevented||R.one(e,ei,()=>{wt(this)&&this.focus()})});const s=X.findOne(Ef);s&&ze.getInstance(s).hide(),ze.getOrCreateInstance(e).toggle(this)});ls(ze);Ae(ze);const Mf="offcanvas",Af="bs.offcanvas",Fe=`.${Af}`,si=".data-api",Of=`load${Fe}${si}`,Nf="Escape",qn="show",zn="showing",Kn="hiding",Df="offcanvas-backdrop",ni=".offcanvas.show",Lf=`show${Fe}`,If=`shown${Fe}`,Pf=`hide${Fe}`,Yn=`hidePrevented${Fe}`,oi=`hidden${Fe}`,jf=`resize${Fe}`,Rf=`click${Fe}${si}`,Vf=`keydown.dismiss${Fe}`,Wf='[data-bs-toggle="offcanvas"]',Hf={backdrop:!0,keyboard:!0,scroll:!1},Ff={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ke extends Ne{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Hf}static get DefaultType(){return Ff}static get NAME(){return Mf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||R.trigger(this._element,Lf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Vs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(qn),this._element.classList.remove(zn),R.trigger(this._element,If,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||R.trigger(this._element,Pf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Kn),this._backdrop.hide();const s=()=>{this._element.classList.remove(qn,Kn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Vs().reset(),R.trigger(this._element,oi)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){R.trigger(this._element,Yn);return}this.hide()},s=!!this._config.backdrop;return new Qo({className:Df,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_addEventListeners(){R.on(this._element,Vf,e=>{if(e.key===Nf){if(this._config.keyboard){this.hide();return}R.trigger(this._element,Yn)}})}static jQueryInterface(e){return this.each(function(){const s=Ke.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}R.on(document,Rf,Wf,function(n){const e=X.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),qe(this))return;R.one(e,oi,()=>{wt(this)&&this.focus()});const s=X.findOne(ni);s&&s!==e&&Ke.getInstance(s).hide(),Ke.getOrCreateInstance(e).toggle(this)});R.on(window,Of,()=>{for(const n of X.find(ni))Ke.getOrCreateInstance(n).show()});R.on(window,jf,()=>{for(const n of X.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ke.getOrCreateInstance(n).hide()});ls(Ke);Ae(Ke);const Uf=/^aria-[\w-]*$/i,ii={"*":["class","dir","id","lang","role",Uf],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Bf=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),qf=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,zf=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Bf.has(s)?!!qf.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Kf(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const l of a){const r=l.nodeName.toLowerCase();if(!Object.keys(e).includes(r)){l.remove();continue}const d=[].concat(...l.attributes),p=[].concat(e["*"]||[],e[r]||[]);for(const c of d)zf(c,p)||l.removeAttribute(c.nodeName)}return i.body.innerHTML}const Yf="TemplateFactory",Gf={allowList:ii,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Jf={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Xf={entry:"(string|element|function|null)",selector:"(string|element)"};class Qf extends Pt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Gf}static get DefaultType(){return Jf}static get NAME(){return Yf}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},Xf)}_setContent(e,s,o){const i=X.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(Re(s)){this._putElementInTemplate(Be(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Kf(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ee(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Zf="tooltip",ev=new Set(["sanitize","allowList","sanitizeFn"]),Cs="fade",tv="modal",qt="show",sv=".tooltip-inner",Gn=`.${tv}`,Jn="hide.bs.modal",Tt="hover",Ss="focus",ks="click",nv="manual",ov="hide",iv="hidden",av="show",lv="shown",rv="inserted",cv="click",dv="focusin",uv="focusout",mv="mouseenter",pv="mouseleave",fv={AUTO:"auto",TOP:"top",RIGHT:xe()?"left":"right",BOTTOM:"bottom",LEFT:xe()?"right":"left"},vv={allowList:ii,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},hv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Ct extends Ne{constructor(e,s){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return vv}static get DefaultType(){return hv}static get NAME(){return Zf}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),R.off(this._element.closest(Gn),Jn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=R.trigger(this._element,this.constructor.eventName(av)),o=(Io(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),R.trigger(this._element,this.constructor.eventName(rv))),this._popper=this._createPopper(i),i.classList.add(qt),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))R.on(r,"mouseover",es);const l=()=>{R.trigger(this._element,this.constructor.eventName(lv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||R.trigger(this._element,this.constructor.eventName(ov)).defaultPrevented)return;if(this._getTipElement().classList.remove(qt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))R.off(i,"mouseover",es);this._activeTrigger[ks]=!1,this._activeTrigger[Ss]=!1,this._activeTrigger[Tt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),R.trigger(this._element,this.constructor.eventName(iv)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Cs,qt),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=sm(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Cs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Qf({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[sv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Cs)}_isShown(){return this.tip&&this.tip.classList.contains(qt)}_createPopper(e){const s=Ee(this._config.placement,[this,e,this._element]),o=fv[s.toUpperCase()];return Zs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ee(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ee(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")R.on(this._element,this.constructor.eventName(cv),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[ks]=!(i._isShown()&&i._activeTrigger[ks]),i.toggle()});else if(s!==nv){const o=s===Tt?this.constructor.eventName(mv):this.constructor.eventName(dv),i=s===Tt?this.constructor.eventName(pv):this.constructor.eventName(uv);R.on(this._element,o,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusin"?Ss:Tt]=!0,l._enter()}),R.on(this._element,i,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusout"?Ss:Tt]=l._element.contains(a.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},R.on(this._element.closest(Gn),Jn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Ve.getDataAttributes(this._element);for(const o of Object.keys(s))ev.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Be(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Ct.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ae(Ct);const _v="popover",gv=".popover-header",bv=".popover-body",yv={...Ct.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},$v={...Ct.DefaultType,content:"(null|string|element|function)"};class nn extends Ct{static get Default(){return yv}static get DefaultType(){return $v}static get NAME(){return _v}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[gv]:this._getTitle(),[bv]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=nn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ae(nn);const wv="scrollspy",Ev="bs.scrollspy",on=`.${Ev}`,Cv=".data-api",Sv=`activate${on}`,Xn=`click${on}`,kv=`load${on}${Cv}`,Tv="dropdown-item",rt="active",xv='[data-bs-spy="scroll"]',Ts="[href]",Mv=".nav, .list-group",Qn=".nav-link",Av=".nav-item",Ov=".list-group-item",Nv=`${Qn}, ${Av} > ${Qn}, ${Ov}`,Dv=".dropdown",Lv=".dropdown-toggle",Iv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Pv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ds extends Ne{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Iv}static get DefaultType(){return Pv}static get NAME(){return wv}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Be(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(R.off(this._config.target,Xn),R.on(this._config.target,Xn,Ts,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(s(l))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(l));continue}const r=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&r){if(o(l),!i)return;continue}!a&&!r&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=X.find(Ts,this._config.target);for(const s of e){if(!s.hash||qe(s))continue;const o=X.findOne(decodeURI(s.hash),this._element);wt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(rt),this._activateParents(e),R.trigger(this._element,Sv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Tv)){X.findOne(Lv,e.closest(Dv)).classList.add(rt);return}for(const s of X.parents(e,Mv))for(const o of X.prev(s,Nv))o.classList.add(rt)}_clearActiveClass(e){e.classList.remove(rt);const s=X.find(`${Ts}.${rt}`,e);for(const o of s)o.classList.remove(rt)}static jQueryInterface(e){return this.each(function(){const s=ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}R.on(window,kv,()=>{for(const n of X.find(xv))ds.getOrCreateInstance(n)});Ae(ds);const jv="tab",Rv="bs.tab",it=`.${Rv}`,Vv=`hide${it}`,Wv=`hidden${it}`,Hv=`show${it}`,Fv=`shown${it}`,Uv=`click${it}`,Bv=`keydown${it}`,qv=`load${it}`,zv="ArrowLeft",Zn="ArrowRight",Kv="ArrowUp",eo="ArrowDown",xs="Home",to="End",et="active",so="fade",Ms="show",Yv="dropdown",ai=".dropdown-toggle",Gv=".dropdown-menu",As=`:not(${ai})`,Jv='.list-group, .nav, [role="tablist"]',Xv=".nav-item, .list-group-item",Qv=`.nav-link${As}, .list-group-item${As}, [role="tab"]${As}`,li='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Os=`${Qv}, ${li}`,Zv=`.${et}[data-bs-toggle="tab"], .${et}[data-bs-toggle="pill"], .${et}[data-bs-toggle="list"]`;class bt extends Ne{constructor(e){super(e),this._parent=this._element.closest(Jv),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),R.on(this._element,Bv,s=>this._keydown(s)))}static get NAME(){return jv}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?R.trigger(s,Vv,{relatedTarget:e}):null;R.trigger(e,Hv,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(et),this._activate(X.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ms);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),R.trigger(e,Fv,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(so))}_deactivate(e,s){if(!e)return;e.classList.remove(et),e.blur(),this._deactivate(X.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ms);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),R.trigger(e,Wv,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(so))}_keydown(e){if(![zv,Zn,Kv,eo,xs,to].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!qe(i));let o;if([xs,to].includes(e.key))o=s[e.key===xs?0:s.length-1];else{const i=[Zn,eo].includes(e.key);o=en(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),bt.getOrCreateInstance(o).show())}_getChildren(){return X.find(Os,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=X.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(Yv))return;const i=(a,l)=>{const r=X.findOne(a,o);r&&r.classList.toggle(l,s)};i(ai,et),i(Gv,Ms),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(et)}_getInnerElement(e){return e.matches(Os)?e:X.findOne(Os,e)}_getOuterElement(e){return e.closest(Xv)||e}static jQueryInterface(e){return this.each(function(){const s=bt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}R.on(document,Uv,li,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!qe(this)&&bt.getOrCreateInstance(this).show()});R.on(window,qv,()=>{for(const n of X.find(Zv))bt.getOrCreateInstance(n)});Ae(bt);const eh="toast",th="bs.toast",Xe=`.${th}`,sh=`mouseover${Xe}`,nh=`mouseout${Xe}`,oh=`focusin${Xe}`,ih=`focusout${Xe}`,ah=`hide${Xe}`,lh=`hidden${Xe}`,rh=`show${Xe}`,ch=`shown${Xe}`,dh="fade",no="hide",zt="show",Kt="showing",uh={animation:"boolean",autohide:"boolean",delay:"number"},mh={animation:!0,autohide:!0,delay:5e3};class us extends Ne{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return mh}static get DefaultType(){return uh}static get NAME(){return eh}show(){if(R.trigger(this._element,rh).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(dh);const s=()=>{this._element.classList.remove(Kt),R.trigger(this._element,ch),this._maybeScheduleHide()};this._element.classList.remove(no),It(this._element),this._element.classList.add(zt,Kt),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||R.trigger(this._element,ah).defaultPrevented)return;const s=()=>{this._element.classList.add(no),this._element.classList.remove(Kt,zt),R.trigger(this._element,lh)};this._element.classList.add(Kt),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(zt),super.dispose()}isShown(){return this._element.classList.contains(zt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){R.on(this._element,sh,e=>this._onInteraction(e,!0)),R.on(this._element,nh,e=>this._onInteraction(e,!1)),R.on(this._element,oh,e=>this._onInteraction(e,!0)),R.on(this._element,ih,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=us.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ls(us);Ae(us);const ph={class:"message-content-column"},fh=["id"],vh={class:"accordion-item"},hh=["id"],_h=["aria-controls"],gh={class:"d-flex align-items-center w-100"},bh={class:"badge bg-warning text-dark ms-auto me-2"},yh={class:"text-muted"},$h=["id","aria-labelledby"],wh={class:"accordion-body bg-light"},Eh={class:"alert alert-warning mb-3",role:"alert"},Ch={class:"compaction-metadata"},Sh={class:"metadata-row"},kh={class:"metadata-row"},Th={key:0,class:"metadata-row"},xh={class:"continuation-content"},Mh={class:"continuation-text border rounded p-3 bg-white"},Ah={class:"mb-0"},Oh={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=b(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=b(()=>`heading-${s.value}`),i=b(()=>`collapse-${s.value}`),a=N(null);let l=null;me(()=>{a.value&&(l=new gt(a.value,{toggle:!1}))}),ns(()=>{l&&l.dispose()});function r(){l&&l.toggle()}const d=b(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),p=b(()=>d.value?e.messages[3]:e.messages[2]),c=b(()=>p.value?.metadata?.init_data?.compact_metadata||{}),_=b(()=>c.value.pre_tokens||0),v=b(()=>d.value?e.messages[4]:e.messages[3]),f=b(()=>v.value?.content||""),C=b(()=>{const g=e.messages[0]?.timestamp;return g?Dt(g):""});function y(g){return g?`${g.toLocaleString()} tokens`:"0 tokens"}return(g,h)=>(u(),m("div",{class:"message-row message-row-compaction",key:s.value},[h[7]||(h[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",ph,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",vh,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:r},[t("div",gh,[h[0]||(h[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",bh,$(y(_.value)),1),t("small",yh,$(C.value),1)])],8,_h)],8,hh),t("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",wh,[t("div",Eh,[h[5]||(h[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),K(" Compaction Details ")],-1)),t("div",Ch,[t("div",Sh,[h[2]||(h[2]=t("strong",null,"Trigger:",-1)),t("span",null,$(c.value.trigger||"auto"),1)]),t("div",kh,[h[3]||(h[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,$(y(_.value)),1)]),c.value.post_tokens?(u(),m("div",Th,[h[4]||(h[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,$(y(c.value.post_tokens)),1)])):I("",!0)])]),t("div",xh,[h[6]||(h[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),K(" Continuation Message ")],-1)),t("div",Mh,[t("pre",Ah,$(f.value),1)])])])],8,$h)])],8,fh)])]))}},Nh=G(Oh,[["__scopeId","data-v-e0b95ba8"]]),Dh={key:0,class:"text-muted text-center py-5"},Lh={__name:"MessageList",setup(n){const e=Ie(),s=pe(),o=N(null),i=b(()=>{const p=e.currentMessages,c=[];let _=0;for(;_<p.length;){const v=p[_];if(a(v,p,_)){const f=p[_+2],y=f?.type==="system"&&f?.metadata?.subtype==="init"?5:4,g=p.slice(_,_+y);c.push({type:"compaction",messages:g}),_+=y;continue}r(v)&&c.push({type:"message",message:v}),_++}return c});function a(p,c,_){if(_+3>=c.length)return!1;const v=c[_],f=c[_+1];let C=c[_+2],y=c[_+3],g=c[_+4];const h=v.type==="system"&&v.metadata?.subtype==="status"&&v.metadata?.init_data?.status==="compacting",M=f.type==="system"&&f.metadata?.subtype==="status"&&(f.metadata?.init_data?.status===null||f.metadata?.init_data?.status===void 0);if(C?.type==="system"&&C?.metadata?.subtype==="init"){if(_+4>=c.length)return!1;const E=!0,A=y?.type==="system"&&y?.metadata?.subtype==="compact_boundary",L=g?.type==="user"&&g?.content?.startsWith("This session is being continued from a previous conversation");return v.type==="system"&&v.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",_),console.log("  Msg1 (compacting):",h),console.log("  Msg2 (null status):",M),console.log("  Msg3 (init):",E),console.log("  Msg4 (boundary):",A),console.log("  Msg5 (continuation):",L)),h&&M&&E&&A&&L}else{const E=C?.type==="system"&&C?.metadata?.subtype==="compact_boundary",A=y?.type==="user"&&y?.content?.startsWith("This session is being continued from a previous conversation");return v.type==="system"&&v.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",_),console.log("  Msg1 (compacting):",h),console.log("  Msg2 (null status):",M),console.log("  Msg3 (boundary):",E),console.log("  Msg4 (continuation):",A)),h&&M&&E&&A}}b(()=>e.currentToolCalls);async function l(){s.autoScrollEnabled&&(await Ns(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}le(()=>i.value.length,l),le(()=>e.currentToolCalls.length,l),le(()=>e.currentToolCalls.map(p=>`${p.id}-${p.status}`).join(","),l),me(()=>{setTimeout(()=>{l()},100)});function r(p){const c=p.subtype||p.metadata?.subtype;if(p.type==="system"&&c==="init"||p.type==="result"||p.type==="permission_request"||p.type==="permission_response")return!1;if(p.type==="user"&&p.metadata?.has_tool_results){const _=p.content||"";if(_.match(/^Tool results?: \d+ results?$/i)||_.trim()==="")return!1}if(p.type==="user"){const _=p.content||"";if(_.includes("<command-message>")&&_.includes("skill is running")||_.startsWith("Base directory for this skill:"))return!1}if(p.type==="user"){const _=p.content||"";if(_.includes("<command-message>")&&_.includes("<command-name>")&&_.includes("<command-args>")||_.includes("ARGUMENTS:")&&(_.includes("<command-name>")||_.match(/\nARGUMENTS:/)))return!1}return!0}function d(p){return{type:p.type||"unknown",content:p.content||"",timestamp:p.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...p.metadata}}}return(p,c)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),m("div",Dh," No messages yet. Start a conversation! ")):I("",!0),(u(!0),m(ie,null,ce(i.value,(_,v)=>(u(),m(ie,{key:`item-${v}`},[_.type==="message"?(u(),ge(mu,{key:0,message:d(_.message)},null,8,["message"])):_.type==="compaction"?(u(),ge(Nh,{key:1,messages:_.messages},null,8,["messages"])):I("",!0)],64))),128))],512))}},Ih=G(Lh,[["__scopeId","data-v-b8954c4c"]]),Ph={class:"border-top bg-light"},jh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Rh={class:"d-flex gap-2 align-items-end px-2 py-1"},Vh=["placeholder","disabled","onKeydown"],Wh=["disabled"],Hh={__name:"InputArea",setup(n){const e=oe(),s=je(),o=N(null),i=b({get:()=>e.currentInput,set:v=>{e.currentInput=v}}),a=b(()=>e.currentSession?.is_processing||!1),l=b(()=>s.sessionConnected),r=b(()=>e.currentSession?.state==="starting"),d=b(()=>r.value?"Session is starting...":l.value?"Type your message to Claude Code...":"Waiting for connection...");function p(){const v=o.value;if(!v)return;v.style.height="auto";const f=Math.min(v.scrollHeight,parseInt(getComputedStyle(v).maxHeight));v.style.height=f+"px"}function c(){i.value.trim()&&(s.sendMessage(i.value),i.value="",o.value&&(o.value.style.height="auto"))}function _(){s.interruptSession()}return(v,f)=>(u(),m("div",Ph,[l.value?I("",!0):(u(),m("div",jh,[...f[1]||(f[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-exclamation-triangle-fill flex-shrink-0",viewBox:"0 0 16 16"},[t("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})],-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),t("div",Rh,[se(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":f[0]||(f[0]=C=>i.value=C),class:"form-control",placeholder:d.value,disabled:r.value||!l.value,rows:"1",onInput:p,onKeydown:Qt(be(c,["exact","prevent"]),["enter"])},null,40,Vh),[[ue,i.value]]),a.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:_}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!i.value.trim()||!l.value||r.value,onClick:c}," Send ",8,Wh))])]))}},Fh=G(Hh,[["__scopeId","data-v-d2ca2648"]]),Uh={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Bh={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},qh={class:"text-secondary"},zh={class:"d-flex flex-column flex-grow-1 overflow-hidden"},ri={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=oe(),o=pe(),i=b(()=>s.currentSession),a=b(()=>o.isLoading),l=b(()=>o.loadingMessage);return me(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),le(()=>e.sessionId,async(r,d)=>{if(r!==d&&r!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(r)}finally{o.hideLoading()}}}),ve(()=>{}),(r,d)=>(u(),m("div",Uh,[a.value?(u(),m("div",Bh,[d[0]||(d[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",qh,$(l.value),1)])):I("",!0),i.value?(u(),ge(Oi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):I("",!0),t("div",zh,[ae(Ih)]),ae(Fh),i.value?(u(),ge(Pi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):I("",!0),i.value?(u(),ge(qi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):I("",!0)]))}},at=yt("legion",()=>{const n=N(new Map),e=N(new Map),s=N(new Map),o=N(new Map),i=N(new Map),a=N(new Map),l=N(null),r=b(()=>n.value.get(l.value)||[]),d=b(()=>e.value.get(l.value)||[]),p=b(()=>s.value.get(l.value)||[]),c=b(()=>o.value.get(l.value)||[]);function _(x){l.value=x}async function v(x,S=100,w=0){try{const O=await te.get(`/api/legions/${x}/timeline?limit=${S}&offset=${w}`),P=O.comms||[],j=O.total_count||P.length,U=O.has_more||!1;return P.sort((q,ne)=>new Date(q.timestamp)-new Date(ne.timestamp)),console.log(`Loaded ${P.length} of ${j} comms for legion ${x}`),n.value.set(x,P),n.value=new Map(n.value),{comms:P,totalCount:j,hasMore:U}}catch(O){throw console.error("Failed to load timeline:",O),O}}function f(x,S){n.value.has(x)||n.value.set(x,[]);const w=n.value.get(x);if(w.some(P=>P.comm_id===S.comm_id)){console.log(`Duplicate comm ${S.comm_id} prevented in timeline`);return}w.push(S),n.value=new Map(n.value),S.to_channel_id&&C(S.to_channel_id,S)}function C(x,S){a.value.has(x)||a.value.set(x,[]);const w=a.value.get(x);if(w.some(P=>P.comm_id===S.comm_id)){console.log(`Duplicate comm ${S.comm_id} prevented in channel ${x}`);return}w.push(S),a.value=new Map(a.value)}async function y(x,S){try{const O=(await te.post(`/api/legions/${x}/comms`,S)).comm;return console.log(`Sent comm ${O.comm_id} to legion ${x}`),O}catch(w){throw console.error("Failed to send comm:",w),w}}async function g(x){return console.log(`Minions for legion ${x} are already available in session store`),[]}async function h(x,S){try{const O=(await te.post(`/api/legions/${x}/minions`,S)).minion;return await g(x),console.log(`Created minion ${O.minion_id} in legion ${x}`),O}catch(w){throw console.error("Failed to create minion:",w),w}}async function M(x){try{const w=(await te.get(`/api/legions/${x}/hordes`)).hordes||[];return console.log(`Loaded ${w.length} hordes for legion ${x}`),s.value.set(x,w),s.value=new Map(s.value),w}catch(S){throw console.error("Failed to load hordes:",S),S}}async function T(x){try{const w=(await te.get(`/api/legions/${x}/channels`)).channels||[];return console.log(`Loaded ${w.length} channels for legion ${x}`),o.value.set(x,w),o.value=new Map(o.value),w}catch(S){throw console.error("Failed to load channels:",S),S}}function E(x,S){o.value.has(x)||o.value.set(x,[]);const w=o.value.get(x);if(w.some(P=>P.channel_id===S.channel_id)){console.log(`Duplicate channel ${S.channel_id} prevented`);return}w.push(S),o.value=new Map(o.value),console.log(`Added channel ${S.name} to legion ${x}`)}async function A(x){try{const S=await te.get(`/api/channels/${x}`),w=S.channel||S;return console.log(`Loaded details for channel ${x}`),i.value.set(x,w),i.value=new Map(i.value),w}catch(S){throw console.error("Failed to load channel details:",S),S}}async function L(x,S=1e3){try{const O=(await te.get(`/api/channels/${x}/comms?limit=${S}`)).comms||[];return console.log(`Loaded ${O.length} comms for channel ${x}`),O.sort((P,j)=>new Date(P.timestamp)-new Date(j.timestamp)),a.value.set(x,O),a.value=new Map(a.value),O}catch(w){throw console.error("Failed to load channel comms:",w),w}}async function k(x,S){try{await te.post(`/api/channels/${x}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:S}),console.log(`Added minion ${S} to channel ${x}`),await A(x)}catch(w){throw console.error("Failed to add member to channel:",w),w}}async function D(x,S){try{await te.post(`/api/channels/${x}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:S}),console.log(`Removed minion ${S} from channel ${x}`),await A(x)}catch(w){throw console.error("Failed to remove member from channel:",w),w}}function F(x){n.value.delete(x),e.value.delete(x),s.value.delete(x),o.value.delete(x),n.value=new Map(n.value),e.value=new Map(e.value),s.value=new Map(s.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:s,channelsByLegion:o,channelDetailsByChannel:i,channelCommsByChannel:a,currentLegionId:l,currentComms:r,currentMinions:d,currentHordes:p,currentChannels:c,setCurrentLegion:_,loadTimeline:v,addComm:f,addChannelComm:C,sendComm:y,loadMinions:g,createMinion:h,loadHordes:M,loadChannels:T,addChannel:E,loadChannelDetails:A,loadChannelComms:L,addMemberToChannel:k,removeMemberFromChannel:D,clearLegionData:F}}),Kh=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:at},Symbol.toStringTag,{value:"Module"})),Yh={class:"timeline-header border-bottom p-3"},Gh={class:"project-name"},Jh=["title"],Xh={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=he(),o=b(()=>s.projects.get(e.legionId)),i=b(()=>o.value?.name||"Legion");return(a,l)=>(u(),m("div",Yh,[t("div",null,[t("div",Gh,$(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Jh)])]))}},Qh=G(Xh,[["__scopeId","data-v-44f386f5"]]),Zh={class:"timeline-status-bar border-top p-2 bg-light"},e_={class:"d-flex justify-content-end"},t_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=pe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),m("div",Zh,[t("div",e_,[t("button",{class:Y(["btn btn-sm",Xt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+$(Xt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},s_=G(t_,[["__scopeId","data-v-891c73db"]]),n_={class:"comm-composer border-top p-3"},o_={class:"d-flex gap-2 mb-2"},i_={class:"flex-grow-1"},a_=["disabled"],l_={label:"Minions"},r_=["value"],c_={key:0,label:"Channels"},d_=["value"],u_={style:{"min-width":"150px"}},m_=["disabled"],p_={class:"d-flex gap-2 align-items-end position-relative"},f_={class:"flex-grow-1 position-relative"},v_=["disabled"],h_=["onClick","onMouseenter"],__=["disabled"],g_={key:0},b_={key:1},y_={__name:"CommComposer",props:{legionId:{type:String,required:!0},defaultChannelId:{type:String,default:""}},setup(n){const e=n,s=at(),o=oe(),i=he(),a=N(""),l=N("task"),r=N(""),d=N(!1),p=N(!1),c=N([]),_=N(0),v=N(-1),f=N(null),C=N(null),y=b(()=>{const x=i.projects.get(e.legionId);return!x||!x.session_ids?[]:x.session_ids.map(S=>o.sessions.get(S)).filter(S=>S&&S.is_minion)}),g=b(()=>s.currentChannels||[]),h=b(()=>a.value&&r.value.trim().length>0);function M(x){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[x.state]||"â—‹"}function T(x){return x.is_minion&&x.role?`${x.name} (${x.role})`:x.name}function E(){const x=f.value;if(!x)return;x.style.height="auto";const S=Math.min(x.scrollHeight,parseInt(getComputedStyle(x).maxHeight));x.style.height=S+"px"}function A(){const x=f.value;if(!x)return;E();const S=r.value,w=x.selectionStart,O=S.substring(0,w),P=O.lastIndexOf("#");if(P===-1){p.value=!1;return}const j=O.substring(P+1).toLowerCase();if(j.includes(" ")){p.value=!1;return}const U=y.value.filter(q=>q.name.toLowerCase().includes(j)).map(q=>({type:"minion",name:q.name,role:q.role,id:q.session_id,state:q.state}));if(U.length===0){p.value=!1;return}c.value=U,_.value=0,v.value=P,p.value=!0}function L(){if(!C.value)return;const x=C.value,S=x.children[_.value];if(!S)return;const w=S.offsetTop,O=S.offsetHeight,P=x.scrollTop,j=x.clientHeight;w<P?x.scrollTop=w:w+O>P+j&&(x.scrollTop=w+O-j)}function k(x){if(!p.value){x.key==="Enter"&&!x.shiftKey&&h.value&&(x.preventDefault(),F());return}if(x.key==="ArrowDown")x.preventDefault(),_.value=(_.value+1)%c.value.length,L();else if(x.key==="ArrowUp")x.preventDefault(),_.value=_.value===0?c.value.length-1:_.value-1,L();else if(x.key==="Enter"){x.preventDefault();const S=c.value[_.value];S&&D(S)}else x.key==="Escape"&&(p.value=!1)}function D(x){const S=f.value;if(!S)return;const w=r.value,O=S.selectionStart,P=w.substring(0,v.value)+"#"+x.name+" "+w.substring(O);r.value=P;const j=v.value+x.name.length+2;setTimeout(()=>{S.setSelectionRange(j,j),S.focus()},0),p.value=!1}async function F(){if(!(!h.value||d.value)){d.value=!0;try{const[x,S]=a.value.split(":"),w={comm_type:l.value,content:r.value.trim()};x==="minion"?w.to_minion_id=S:x==="channel"&&(w.to_channel_id=S),await s.sendComm(e.legionId,w),r.value="",E()}catch(x){console.error("Failed to send comm:",x),alert(`Failed to send comm: ${x.message}`)}finally{d.value=!1}}}return le(()=>e.defaultChannelId,x=>{x&&(a.value=`channel:${x}`)},{immediate:!0}),le(p,x=>{if(x){const S=w=>{w.target.closest(".comm-composer")||(p.value=!1,document.removeEventListener("click",S))};setTimeout(()=>document.addEventListener("click",S),0)}}),(x,S)=>(u(),m("div",n_,[t("div",o_,[t("div",i_,[se(t("select",{"onUpdate:modelValue":S[0]||(S[0]=w=>a.value=w),class:"form-select form-select-sm",disabled:d.value},[S[3]||(S[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",l_,[(u(!0),m(ie,null,ce(y.value,w=>(u(),m("option",{key:w.session_id,value:`minion:${w.session_id}`},$(M(w))+" "+$(T(w)),9,r_))),128))]),g.value.length>0?(u(),m("optgroup",c_,[(u(!0),m(ie,null,ce(g.value,w=>(u(),m("option",{key:w.channel_id,value:`channel:${w.channel_id}`}," #ï¸âƒ£ "+$(w.name),9,d_))),128))])):I("",!0)],8,a_),[[Oe,a.value]])]),t("div",u_,[se(t("select",{"onUpdate:modelValue":S[1]||(S[1]=w=>l.value=w),class:"form-select form-select-sm",disabled:d.value},[...S[4]||(S[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,m_),[[Oe,l.value]])])]),t("div",p_,[t("div",f_,[se(t("textarea",{ref_key:"contentTextarea",ref:f,"onUpdate:modelValue":S[2]||(S[2]=w=>r.value=w),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:d.value,onInput:A,onKeydown:k},null,40,v_),[[ue,r.value]]),p.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:C,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(ie,null,ce(c.value,(w,O)=>(u(),m("div",{key:w.id,class:Y(["autocomplete-item px-2 py-1",{"bg-light":O===_.value}]),onClick:P=>D(w),onMouseenter:P=>_.value=O},$(w.type==="minion"?M(w):"#ï¸âƒ£")+" "+$(w.name)+$(w.role?` (${w.role})`:""),43,h_))),128))],512)):I("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!h.value||d.value,onClick:F},[d.value?(u(),m("span",g_,[...S[5]||(S[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),K(" Sending... ",-1)])])):(u(),m("span",b_,"Send"))],8,__)])])]))}},ci=G(y_,[["__scopeId","data-v-2e02adff"]]),$_={class:"timeline-view d-flex flex-column h-100"},w_={key:0,class:"text-center text-muted"},E_={key:1,class:"text-center text-danger"},C_={key:2,class:"text-center text-muted"},S_={key:3,class:"comm-list"},k_={class:"col-auto message-speaker text-end pe-3"},T_={class:"text-muted"},x_={class:"col message-content-column"},M_={class:"card-body p-2"},A_={class:"d-flex justify-content-between align-items-start mb-1"},O_={class:"comm-content"},N_="ffffffff-ffff-ffff-ffff-ffffffffffff",D_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=at(),o=he(),i=oe(),a=je(),l=pe(),r=N(!0),d=N(null),p=N(null),c=b(()=>o.projects.get(e.legionId));b(()=>c.value?.name||"Legion");const _=b(()=>s.currentComms);b(()=>s.currentMinions);function v(A){return A.from_minion_id===N_}function f(A){return A.from_user?"You":A.from_minion_id?v(A)?"SYSTEM":i.sessions.get(A.from_minion_id)?.name||"Unknown":"Unknown"}function C(A){return A.to_user?"You":A.to_minion_id?i.sessions.get(A.to_minion_id)?.name||"Unknown":A.to_channel_id?A.to_channel_name?`#${A.to_channel_name}`:A.to_channel_id:"All"}function y(A){return{task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success"}[A]||"bg-secondary"}function g(A){return new Date(A).toLocaleTimeString()}async function h(){l.autoScrollEnabled&&(await Ns(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function M(){r.value=!0,d.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Ns(),await h(),setTimeout(()=>{h()},100)}catch(A){console.error("Failed to load timeline:",A),A.response?d.value=`${A.message} (${A.response.status})`:d.value=A.message||"Unknown error"}finally{r.value=!1}}function T(){a.connectLegion(e.legionId)}function E(){a.disconnectLegion()}return le(()=>_.value.length,()=>{h()}),me(()=>{M(),T(),setTimeout(()=>{h()},100)}),ve(()=>{E()}),(A,L)=>(u(),m("div",$_,[ae(Qh,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto p-3"},[r.value?(u(),m("div",w_,[...L[0]||(L[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),K(" Loading timeline... ",-1)])])):d.value?(u(),m("div",E_," Failed to load timeline: "+$(d.value),1)):_.value.length===0?(u(),m("div",C_," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",S_,[(u(!0),m(ie,null,ce(_.value,k=>(u(),m("div",{key:k.comm_id,class:Y(["comm-item message-row row py-2 mb-2",{"system-comm":v(k)}])},[t("div",k_,[t("small",T_,$(g(k.timestamp)),1)]),t("div",x_,[t("div",{class:Y(["comm-card card",{"system-card":v(k)}])},[t("div",M_,[t("div",A_,[t("div",null,[t("span",{class:Y(["badge",y(k.comm_type)])},$(k.comm_type),3),t("strong",{class:Y(["ms-2",{"system-sender":v(k)}])},$(f(k)),3),L[1]||(L[1]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",{class:Y({"recipient-channel":k.to_channel_id})},$(C(k)),3)])]),t("div",O_,$(k.content),1)])],2)])],2))),128))]))],512),ae(ci,{"legion-id":n.legionId},null,8,["legion-id"]),ae(s_,{"legion-id":n.legionId},null,8,["legion-id"])]))}},L_=G(D_,[["__scopeId","data-v-6d97bd0b"]]),I_={class:"spy-view d-flex flex-column overflow-hidden"},P_={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){const e=n,s=je();return me(()=>{s.connectLegion(e.legionId)}),ns(()=>{s.disconnectLegion()}),(o,i)=>(u(),m("div",I_,[ae(ri,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},j_=G(P_,[["__scopeId","data-v-21206f91"]]),R_={class:"horde-header border-bottom p-3"},V_={class:"project-name"},W_={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=he(),o=b(()=>s.projects.get(e.legionId)),i=b(()=>o.value?.name||"Legion");return(a,l)=>(u(),m("div",R_,[t("div",null,[t("div",V_,$(i.value),1),l[0]||(l[0]=t("div",{class:"view-name"},"Minion Hierarchy",-1))])]))}},H_=G(W_,[["__scopeId","data-v-0c86e2b5"]]),F_={class:"horde-status-bar border-top p-2 bg-light"},U_={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,s)=>(u(),m("div",F_,[...s[0]||(s[0]=[t("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},B_=G(U_,[["__scopeId","data-v-f0e64ab0"]]),q_={class:"minion-card border-start border-2 mb-2"},z_={class:"node-row"},K_={class:"node-left"},Y_={key:0,class:"me-2"},G_={key:1,class:"badge bg-secondary ms-2"},J_={class:"node-right"},X_={key:0,class:"last-comm-preview"},Q_={class:"comm-direction"},Z_=["title"],eg={key:1,class:"text-muted fst-italic small"},tg={key:0,class:"minion-children"},sg={key:1,class:"text-danger small ms-4"},ng={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,s=b(()=>e.level*24),o=b(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=b(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=b(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),l=b(()=>{const c=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[c]||"status-dot-grey"}),r=b(()=>{const c=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}});function d(c){return c.to_user?"User":c.to_minion_name?c.to_minion_name:c.to_channel_name?`#${c.to_channel_name}`:"unknown"}function p(c){const _=c.summary||c.content||"";return _.length>150?_.substring(0,150)+"...":_}return(c,_)=>{const v=io("MinionTreeNode",!0);return n.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:We({marginLeft:`${s.value}px`})},[t("div",q_,[t("div",z_,[t("div",K_,[t("div",{class:Y(["status-dot me-2",l.value]),style:We(r.value)},null,6),i.value?(u(),m("span",Y_,"ðŸ‘‘")):I("",!0),t("strong",null,$(n.minionData.name),1),i.value?(u(),m("span",G_,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):I("",!0)]),t("div",J_,[n.minionData.last_comm?(u(),m("div",X_,[t("span",Q_,[_[0]||(_[0]=K(" â†’ ",-1)),t("strong",null,$(d(n.minionData.last_comm)),1),_[1]||(_[1]=K(": ",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},$(p(n.minionData.last_comm)),9,Z_)])):(u(),m("div",eg," No communications yet "))])])]),o.value?(u(),m("div",tg,[(u(!0),m(ie,null,ce(n.minionData.children,f=>(u(),ge(v,{key:f.id,"minion-data":f,level:n.level+1},null,8,["minion-data","level"]))),128))])):I("",!0)],4)):(u(),m("div",sg," âš  Minion data is missing "))}}},og=G(ng,[["__scopeId","data-v-1cd9863f"]]),ig={class:"horde-view d-flex flex-column h-100"},ag={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},lg={key:0,class:"text-center py-5"},rg={key:1,class:"alert alert-danger"},cg={class:"mb-0"},dg={key:2,class:"horde-tree"},ug={class:"user-root-node mb-3 border rounded bg-white"},mg={class:"node-row"},pg={class:"node-left"},fg={key:0,class:"badge bg-primary ms-2"},vg={class:"node-right"},hg={key:0,class:"last-comm-preview"},_g={class:"comm-direction"},gg=["title"],bg={key:1,class:"text-muted fst-italic"},yg={key:0,class:"alert alert-info ms-4"},$g={key:1,class:"root-minions ms-4"},wg={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=he(),o=oe(),i=je(),a=at(),l=N(null),r=N(!1),d=N(null);b(()=>s.projects.get(e.legionId));const p=b(()=>l.value&&l.value.children&&l.value.children.length>0);async function c(){r.value=!0,d.value=null;try{const y=await te.get(`/api/legions/${e.legionId}/hordes`);l.value=y,console.log("Loaded hierarchy:",y)}catch(y){console.error("Failed to load hierarchy:",y),d.value=y.message||"Unknown error"}finally{r.value=!1}}me(()=>{c()}),le(()=>e.legionId,()=>{c()});function _(y){return y.to_user?"User":y.to_minion_name?y.to_minion_name:y.to_channel_name?`#${y.to_channel_name}`:"unknown"}function v(y){const g=y.summary||y.content||"";return g.length>150?g.substring(0,150)+"...":g}function f(y,g){if(y.id===g)return y;if(y.children)for(const h of y.children){const M=f(h,g);if(M)return M}return null}function C(y){if(l.value){if(y.from_minion_id){const g=f(l.value,y.from_minion_id);g&&g.type==="minion"&&(g.last_comm=y,console.log(`Updated minion ${g.name} last_comm`))}y.from_user&&l.value.type==="user"&&(l.value.last_comm=y,console.log("Updated user last_comm"))}}return me(()=>{c(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),le(()=>o.sessions,y=>{if(l.value){for(const[g,h]of y)if(h.is_minion&&h.project_id===e.legionId){const M=f(l.value,g);M&&M.type==="minion"&&(M.state!==h.state&&(M.state=h.state,console.log(`Updated minion ${M.name} state to ${h.state}`)),M.is_processing!==h.is_processing&&(M.is_processing=h.is_processing,console.log(`Updated minion ${M.name} is_processing to ${h.is_processing}`)))}}},{deep:!0}),le(()=>a.commsByLegion.get(e.legionId),y=>{if(y&&y.length>0){const g=y[y.length-1];C(g)}},{deep:!0}),le(()=>o.sessions.size,(y,g)=>{y>g&&Array.from(o.sessions.values()).some(T=>T.is_minion&&T.project_id===e.legionId&&!f(l.value,T.session_id))&&(console.log("New minion detected, reloading hierarchy"),c())})}),ve(()=>{console.log("HordeView unmounted")}),(y,g)=>(u(),m("div",ig,[ae(H_,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",ag,[r.value?(u(),m("div",lg,[...g[0]||(g[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):d.value?(u(),m("div",rg,[g[1]||(g[1]=t("strong",null,"Failed to load hierarchy",-1)),t("p",cg,$(d.value),1)])):l.value?(u(),m("div",dg,[t("div",ug,[t("div",mg,[t("div",pg,[g[2]||(g[2]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,$(l.value.name),1),p.value?(u(),m("span",fg,$(l.value.children.length)+" "+$(l.value.children.length===1?"minion":"minions"),1)):I("",!0)]),t("div",vg,[l.value.last_comm?(u(),m("div",hg,[t("span",_g,[g[3]||(g[3]=K(" â†’ ",-1)),t("strong",null,$(_(l.value.last_comm)),1),g[4]||(g[4]=K(": ",-1))]),t("span",{class:"comm-content",title:l.value.last_comm.content||""},$(v(l.value.last_comm)),9,gg)])):(u(),m("div",bg," No communications yet "))])])]),p.value?(u(),m("div",$g,[(u(!0),m(ie,null,ce(l.value.children,h=>(u(),ge(og,{key:h.id,"minion-data":h,level:1},null,8,["minion-data"]))),128))])):(u(),m("div",yg,[...g[5]||(g[5]=[t("p",{class:"mb-2"},"No minions yet",-1),t("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):I("",!0)]),ae(B_,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Eg=G(wg,[["__scopeId","data-v-af6338a3"]]),Cg={class:"channel-status-bar d-flex gap-2"},Sg={class:"button-label"},kg={__name:"ChannelStatusBar",props:{channel:{type:Object,required:!0},members:{type:Array,default:()=>[]},legionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=b(()=>e.members?.length||0);function i(){s.showModal("channel-info",{channel:e.channel})}function a(){s.showModal("channel-members",{channel:e.channel,members:e.members,legionId:e.legionId,channelId:e.channel.channel_id})}return(l,r)=>(u(),m("div",Cg,[t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:i,title:"View channel information"},[...r[0]||(r[0]=[t("span",{class:"button-icon"},"ðŸ“‹",-1),t("span",{class:"button-label"},"Info",-1)])]),t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:a,title:"View channel members"},[r[1]||(r[1]=t("span",{class:"button-icon"},"ðŸ‘¥",-1)),t("span",Sg,"Members ("+$(o.value)+")",1)])]))}},Tg=G(kg,[["__scopeId","data-v-f497955c"]]),xg={class:"modal-dialog modal-dialog-centered"},Mg={class:"modal-content"},Ag={class:"modal-body"},Og={key:0},Ng={class:"info-section"},Dg={class:"info-value"},Lg={class:"info-section"},Ig={class:"info-value"},Pg={key:0,class:"info-section"},jg={class:"info-value"},Rg={class:"info-section"},Vg={class:"info-value"},Wg={class:"info-section"},Hg={class:"info-value"},Fg={class:"info-section"},Ug={class:"info-value"},Bg={style:{"font-size":"0.85rem"}},qg={key:1,class:"text-muted text-center py-3"},zg={__name:"ChannelInfoModal",setup(n){const e=pe(),s=N(null);let o=null;const i=N(null);le(()=>e.currentModal,l=>{l?.name==="channel-info"&&o&&(i.value=l.data?.channel||null,o.show())});function a(l){if(!l)return"Unknown";try{return new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return l}}return me(()=>{if(s.value){const l=window.bootstrap;l&&l.Modal&&(o=new l.Modal(s.value),s.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),i.value=null}))}}),ns(()=>{o&&o.dispose()}),(l,r)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",id:"channelInfoModal",tabindex:"-1","aria-labelledby":"channelInfoModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",xg,[t("div",Mg,[r[6]||(r[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelInfoModalLabel"},"Channel Information"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ag,[i.value?(u(),m("div",Og,[t("div",Ng,[r[0]||(r[0]=t("label",null,"Channel Name",-1)),t("div",Dg,$(i.value.name),1)]),t("div",Lg,[r[1]||(r[1]=t("label",null,"Purpose",-1)),t("div",Ig,$(i.value.purpose||"No purpose specified"),1)]),i.value.description&&i.value.description!==i.value.purpose?(u(),m("div",Pg,[r[2]||(r[2]=t("label",null,"Description",-1)),t("div",jg,$(i.value.description),1)])):I("",!0),t("div",Rg,[r[3]||(r[3]=t("label",null,"Created",-1)),t("div",Vg,$(a(i.value.created_at)),1)]),t("div",Wg,[r[4]||(r[4]=t("label",null,"Members",-1)),t("div",Hg,$(i.value.member_minion_ids?.length||0)+" member(s)",1)]),t("div",Fg,[r[5]||(r[5]=t("label",null,"Channel ID",-1)),t("div",Ug,[t("code",Bg,$(i.value.channel_id),1)])])])):(u(),m("div",qg," No channel data available "))]),r[7]||(r[7]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},Kg=G(zg,[["__scopeId","data-v-3d7eceff"]]),Yg={class:"modal-dialog modal-dialog-centered"},Gg={class:"modal-content"},Jg={class:"modal-body"},Xg={class:"mb-3"},Qg=["disabled"],Zg={key:0,class:"text-muted ms-2"},eb={key:1,class:"mt-2"},tb=["disabled"],sb=["value"],nb={key:0,class:"text-muted small mt-1"},ob={key:0,class:"member-count"},ib={key:1,class:"member-list"},ab={class:"member-info"},lb={class:"member-name"},rb={key:0,class:"member-role"},cb={class:"member-state"},db={class:"status-text"},ub=["onClick","disabled"],mb={key:2,class:"empty-state text-center py-4"},pb={__name:"ChannelMembersModal",setup(n){const e=pe(),s=at(),o=oe(),i=he(),a=N(null);let l=null;const r=N(null),d=N([]),p=N(null),c=N(null),_=N(""),v=N(!1),f=N(!1),C=N(!1),y=b(()=>{if(!p.value)return[];const A=i.projects.get(p.value);if(!A||!A.session_ids)return[];const L=A.session_ids.map(D=>o.sessions.get(D)).filter(Boolean),k=new Set(d.value.map(D=>D.session_id));return L.filter(D=>!k.has(D.session_id))});le(()=>e.currentModal,A=>{A?.name==="channel-members"&&l&&(r.value=A.data?.channel||null,d.value=A.data?.members||[],p.value=A.data?.legionId||null,c.value=A.data?.channelId||null,v.value=!1,_.value="",l.show())});function g(A){return A==="processing"||A==="starting"?"status-blinking":""}function h(A){return{backgroundColor:{created:"#6c757d",starting:"#28a745",active:"#28a745",processing:"#da70d6",paused:"#ffc107",error:"#dc3545",terminated:"#6c757d"}[A]||"#6c757d"}}function M(A){return A?A.charAt(0).toUpperCase()+A.slice(1).replace(/_/g," "):"Unknown"}async function T(){if(!(!_.value||!c.value)){f.value=!0;try{await s.addMemberToChannel(c.value,_.value);const A=await s.loadChannelDetails(c.value);A?.member_minion_ids&&(d.value=A.member_minion_ids.map(L=>o.sessions.get(L)).filter(Boolean)),_.value="",v.value=!1}catch(A){console.error("Failed to add member:",A),alert(`Failed to add member: ${A.message}`)}finally{f.value=!1}}}async function E(A){if(!A||!c.value)return;const L=d.value.find(k=>k.session_id===A);if(confirm(`Remove ${L?.name||"this member"} from the channel?`)){C.value=!0;try{await s.removeMemberFromChannel(c.value,A);const k=await s.loadChannelDetails(c.value);k?.member_minion_ids&&(d.value=k.member_minion_ids.map(D=>o.sessions.get(D)).filter(Boolean))}catch(k){console.error("Failed to remove member:",k),alert(`Failed to remove member: ${k.message}`)}finally{C.value=!1}}}return me(()=>{if(a.value){const A=window.bootstrap;A&&A.Modal&&(l=new A.Modal(a.value),a.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),r.value=null,d.value=[]}))}}),ns(()=>{l&&l.dispose()}),(A,L)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",id:"channelMembersModal",tabindex:"-1","aria-labelledby":"channelMembersModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",Yg,[t("div",Gg,[L[5]||(L[5]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelMembersModalLabel"},"Channel Members"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Jg,[t("div",Xg,[t("button",{class:"btn btn-sm btn-primary",onClick:L[0]||(L[0]=k=>v.value=!v.value),disabled:f.value||y.value.length===0}," âž• Add Member ",8,Qg),y.value.length===0?(u(),m("small",Zg," (All minions are already members) ")):I("",!0),v.value&&y.value.length>0?(u(),m("div",eb,[se(t("select",{"onUpdate:modelValue":L[1]||(L[1]=k=>_.value=k),class:"form-select form-select-sm",onChange:T,disabled:f.value},[L[2]||(L[2]=t("option",{value:""},"-- Select minion to add --",-1)),(u(!0),m(ie,null,ce(y.value,k=>(u(),m("option",{key:k.session_id,value:k.session_id},$(k.name)+" "+$(k.role?`(${k.role})`:"(No role)"),9,sb))),128))],40,tb),[[Oe,_.value]]),f.value?(u(),m("div",nb,[...L[3]||(L[3]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),K(" Adding member... ",-1)])])):I("",!0)])):I("",!0)]),d.value&&d.value.length>0?(u(),m("p",ob,$(d.value.length)+" "+$(d.value.length===1?"member":"members"),1)):I("",!0),d.value&&d.value.length>0?(u(),m("div",ib,[(u(!0),m(ie,null,ce(d.value,k=>(u(),m("div",{key:k.session_id,class:"member-item"},[t("div",ab,[t("div",lb,$(k.name),1),k.role?(u(),m("div",rb,$(k.role),1)):I("",!0),t("div",cb,[t("span",{class:Y(["status-dot",g(k.state)]),style:We(h(k.state))},null,6),t("span",db,$(M(k.state)),1)])]),t("button",{class:"btn btn-sm btn-outline-danger",onClick:D=>E(k.session_id),disabled:C.value,title:"Remove from channel"}," ðŸ—‘ï¸ ",8,ub)]))),128))])):(u(),m("div",mb,[...L[4]||(L[4]=[t("p",{class:"text-muted mb-0"},"No members in this channel yet.",-1)])]))]),L[6]||(L[6]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},fb=G(pb,[["__scopeId","data-v-28fb4eaa"]]),vb={class:"channel-view d-flex flex-column h-100"},hb={class:"channel-header border-bottom p-3"},_b={class:"d-flex align-items-center justify-content-between"},gb={class:"mb-0"},bb={class:"text-muted"},yb={class:"badge bg-secondary"},$b={class:"channel-content flex-grow-1 overflow-auto"},wb={key:0,class:"text-center text-muted py-4"},Eb={key:1,class:"text-center text-danger py-4"},Cb={key:2,class:"text-center text-muted py-4"},Sb={key:3,class:"p-3 pb-5"},kb={class:"comms-section"},Tb={class:"text-muted border-bottom pb-2"},xb={key:0,class:"text-center text-muted py-4"},Mb={key:1,class:"text-center text-muted py-3"},Ab={key:2,class:"comm-list"},Ob={class:"card-body p-2"},Nb={class:"d-flex justify-content-between align-items-start mb-1"},Db={class:"ms-2"},Lb={class:"text-muted ms-2"},Ib={key:0,class:"text-muted small mb-1"},Pb={class:"comm-content"},jb={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,s=at(),o=he(),i=oe(),a=je(),l=N(!0),r=N(null),d=N(!1),p=b(()=>o.projects.get(e.legionId)),c=b(()=>s.channelDetailsByChannel.get(e.channelId)),_=b(()=>s.channelCommsByChannel.get(e.channelId)||[]),v=b(()=>c.value?.member_minion_ids?.length||0),f=b(()=>_.value.length),C=b(()=>c.value?.member_minion_ids?c.value.member_minion_ids.map(E=>i.sessions.get(E)).filter(Boolean):[]);function y(E){return E.from_user?"You":E.from_minion_name?E.from_minion_name:E.from_minion_id&&i.sessions.get(E.from_minion_id)?.name||"Unknown"}function g(E){return{task:"bg-primary",question:"bg-info",report:"bg-success",info:"bg-secondary",halt:"bg-danger",pivot:"bg-warning"}[E?.toLowerCase()]||"bg-secondary"}function h(E){return E?new Date(E).toLocaleString():"N/A"}function M(){a.connectLegion(e.legionId)}function T(){a.disconnectLegion()}return me(async()=>{l.value=!0;try{s.setCurrentLegion(e.legionId),await s.loadChannels(e.legionId),await s.loadChannelDetails(e.channelId),d.value=!0,await s.loadChannelComms(e.channelId,1e3),d.value=!1}catch(E){console.error("Failed to load channel:",E),r.value=E.message||"Unknown error"}finally{l.value=!1}M()}),le(()=>e.channelId,async E=>{if(E){l.value=!0,r.value=null;try{s.setCurrentLegion(e.legionId),await s.loadChannels(e.legionId),await s.loadChannelDetails(E),d.value=!0,await s.loadChannelComms(E,1e3),d.value=!1}catch(A){console.error("Failed to load channel:",A),r.value=A.message||"Unknown error"}finally{l.value=!1}}}),ve(()=>{T()}),(E,A)=>(u(),m("div",vb,[t("div",hb,[t("div",_b,[t("div",null,[t("h5",gb," ðŸ’¬ "+$(c.value?.name||"Channel"),1),t("small",bb,$(p.value?.name||"Legion"),1)]),t("span",yb,$(v.value)+" members",1)])]),t("div",$b,[l.value?(u(),m("div",wb,[...A[0]||(A[0]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading channel...",-1)])])):r.value?(u(),m("div",Eb," Failed to load channel: "+$(r.value),1)):c.value?(u(),m("div",Sb,[t("div",kb,[t("h6",Tb,"Communications ("+$(f.value)+")",1),d.value?(u(),m("div",xb,[...A[1]||(A[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading comms...",-1)])])):_.value.length===0?(u(),m("div",Mb," No communications in this channel yet ")):(u(),m("div",Ab,[(u(!0),m(ie,null,ce(_.value,L=>(u(),m("div",{key:L.comm_id,class:"comm-item card mb-2"},[t("div",Ob,[t("div",Nb,[t("div",null,[t("span",{class:Y(["badge",g(L.comm_type)])},$(L.comm_type),3),t("strong",Db,$(y(L)),1),t("small",Lb,$(h(L.timestamp)),1)])]),L.summary?(u(),m("div",Ib,[A[2]||(A[2]=t("strong",null,"Summary:",-1)),K(" "+$(L.summary),1)])):I("",!0),t("div",Pb,$(L.content),1)])]))),128))]))])])):(u(),m("div",Cb," Channel not found "))]),c.value?(u(),ge(ci,{key:0,"legion-id":n.legionId,"default-channel-id":n.channelId},null,8,["legion-id","default-channel-id"])):I("",!0),c.value?(u(),ge(Tg,{key:1,channel:c.value,members:C.value,"legion-id":n.legionId},null,8,["channel","members","legion-id"])):I("",!0),ae(Kg),ae(fb)]))}},Rb=G(jb,[["__scopeId","data-v-428d15f5"]]),Vb=[{path:"/",name:"home",component:yi},{path:"/session/:sessionId",name:"session",component:ri,props:!0},{path:"/timeline/:legionId",name:"timeline",component:L_,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:j_,props:!0},{path:"/horde/:legionId",name:"horde",component:Eg,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:Rb,props:!0}],Wb=fi({history:vi(),routes:Vb}),Hb={class:"connection-indicators"},Fb=["title"],Ub=["title"],Bb=["title"],qb={__name:"ConnectionIndicator",setup(n){const e=je();function s(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:r}=a[i];return r>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:d,retryCount:p}=r[i];let c="Disconnected";return d?c="Connected":p>0&&(c=`Reconnecting (attempt ${p})`),`${a[i]}
${l[i]}
Status: ${c}`}return(i,a)=>(u(),m("div",Hb,[t("div",{class:Y(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,Fb),t("div",{class:Y(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,Ub),t("div",{class:Y(["indicator",s("legion")]),title:o("legion")}," ðŸ‘¥ ",10,Bb)]))}},zb=G(qb,[["__scopeId","data-v-d35b07c8"]]),Kb={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Yb={class:"d-flex align-items-center gap-2"},Gb={__name:"AppHeader",setup(n){const e=pe();function s(){e.toggleSidebar()}return(o,i)=>(u(),m("header",Kb,[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...i[0]||(i[0]=[t("span",null,"â˜°",-1)])]),i[1]||(i[1]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",Yb,[ae(zb)])]))}},Jb={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Xb={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Qb=["title"],Zb={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=b(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(r){return r.state==="paused"&&r.is_processing?"pending-prompt":r.is_processing?"processing":r.state}function i(r){const d=o(r);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[d]||"#d3d3d3"}function a(r){const d=o(r);return d==="starting"||d==="processing"||d==="pending-prompt"}function l(r){const d=o(r),p=d.charAt(0).toUpperCase()+d.slice(1),c=r.name||"Unnamed Session",_=r.is_minion&&r.role?` (${r.role})`:"";return`${c}${_}: ${p}`}return(r,d)=>(u(),m("div",Jb,[!n.sessions||n.sessions.length===0?(u(),m("div",Xb)):(u(!0),m(ie,{key:1},ce(n.sessions,p=>(u(),m("div",{key:p.session_id,class:Y(["progress-bar",{"progress-bar-striped progress-bar-animated":a(p)}]),style:We({width:s.value,backgroundColor:i(p),cursor:"help"}),title:l(p)},null,14,Qb))),128))]))}},ey=G(Zb,[["__scopeId","data-v-a79cfeec"]]),ty={class:"flex-grow-1"},sy={key:0,class:"text-muted small ms-1"},ny={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,s=Ye(),o=oe(),i=he(),a=pe(),l=b(()=>o.currentSessionId===e.session.session_id),r=b(()=>o.deletingSessions.has(e.session.session_id)),d=b(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),p=b(()=>{const h=d.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[h]||"status-dot-grey"}),c=b(()=>{const h=d.value,M={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},T={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:M[h]||"#d3d3d3",borderColor:T[h]||"#6c757d"}});function _(){o.selectSession(e.session.session_id),s.push(`/session/${e.session.session_id}`)}function v(){a.showModal("edit-session",{session:e.session})}function f(h){h.dataTransfer.effectAllowed="move",h.dataTransfer.setData("application/session-id",e.session.session_id),h.dataTransfer.setData("application/project-id",e.projectId),h.dataTransfer.setData("text/plain",e.session.session_id),h.target.classList.add("dragging")}function C(h){h.target.classList.remove("dragging")}function y(h){h.preventDefault(),h.dataTransfer.dropEffect="move";const M=h.currentTarget.getBoundingClientRect(),T=M.top+M.height/2;h.clientY<T?(h.currentTarget.classList.add("drop-above"),h.currentTarget.classList.remove("drop-below")):(h.currentTarget.classList.add("drop-below"),h.currentTarget.classList.remove("drop-above"))}function g(h){h.preventDefault(),h.currentTarget.classList.remove("drop-above","drop-below");const M=h.dataTransfer.getData("application/session-id")||h.dataTransfer.getData("text/plain"),T=h.dataTransfer.getData("application/project-id");if(!M||M===e.session.session_id||T!==e.projectId)return;const E=h.currentTarget.getBoundingClientRect(),A=E.top+E.height/2,L=h.clientY<A,k=i.getProject(e.projectId);if(!k||!k.session_ids)return;const D=[...k.session_ids],F=D.indexOf(e.session.session_id),x=D.indexOf(M);if(F===-1||x===-1)return;const S=[...D],[w]=S.splice(x,1);let O=L?F:F+1;x<F&&O--,S.splice(O,0,w),i.reorderSessionsInProject(e.projectId,S)}return(h,M)=>(u(),m("div",{class:Y(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:l.value,"session-deleting":r.value}]),style:{cursor:"pointer"},draggable:"true",onClick:_,onDragstart:f,onDragend:C,onDragover:y,onDrop:g},[t("div",{class:Y(["status-dot me-2",p.value]),style:We(c.value)},null,6),t("div",ty,[t("span",null,$(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(u(),m("span",sy,"("+$(n.session.role)+")",1)):I("",!0)]),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:be(v,["stop"])}," âœï¸ ")],34))}},oy=G(ny,[["__scopeId","data-v-07ecbf94"]]),iy={class:"d-flex align-items-center gap-2"},ay=["value"],ly={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ye(),o=oe(),i=pe(),a=N("");le(()=>s.currentRoute.value,y=>{!a.value&&y.name==="spy"&&y.params.minionId&&y.params.legionId===e.project.project_id&&(a.value=y.params.minionId)},{immediate:!0});const l=b(()=>a.value?e.sessions.find(y=>y.session_id===a.value):null),r=b(()=>{const y=s.currentRoute.value;return y.name==="spy"&&y.params.legionId===e.project.project_id}),d=b(()=>{if(!l.value)return"";if(l.value.state==="paused"&&l.value.is_processing)return"status-blinking";const y=l.value.is_processing?"processing":l.value.state;return y==="starting"||y==="processing"?"status-blinking":""}),p=b(()=>{if(!l.value)return{};if(l.value.state==="paused"&&l.value.is_processing)return{backgroundColor:"#ffc107"};const y=l.value.is_processing?"processing":l.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[y]||"#d3d3d3"}});function c(y){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[y.state]||"â—‹"}function _(y){return y.is_minion&&y.role?`${y.name} (${y.role})`:y.name}function v(){a.value&&s.push(`/spy/${e.project.project_id}/${a.value}`)}function f(){a.value?s.push(`/spy/${e.project.project_id}/${a.value}`):s.push("/")}function C(){l.value&&i.showModal("minion-view",{session:l.value})}return le(()=>o.currentSessionId,y=>{if(y)e.sessions.some(g=>g.session_id===y)&&(a.value=y);else{a.value="";const g=s.currentRoute.value;g.name==="spy"&&g.params.legionId===e.project.project_id&&s.push("/")}}),(y,g)=>(u(),m("div",{class:Y(["list-group-item list-group-item-action p-2",{active:r.value}])},[t("div",{class:"d-flex align-items-center justify-content-between mb-2",style:We({cursor:a.value?"pointer":"default"}),onClick:v},[g[1]||(g[1]=t("div",{class:"d-flex align-items-center"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ”"),t("span",{class:"fw-semibold"},"Spy"),t("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),t("div",iy,[l.value?(u(),m("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:be(C,["stop"]),title:"View minion details"}," ðŸ‘ï¸ ")):I("",!0),l.value?(u(),m("span",{key:1,class:Y(["minion-state-indicator",d.value]),style:We(p.value)}," ðŸ‘¤ ",6)):I("",!0)])],4),se(t("select",{"onUpdate:modelValue":g[0]||(g[0]=h=>a.value=h),class:"form-select form-select-sm",onChange:f},[g[2]||(g[2]=t("option",{value:""},"-- Select Minion --",-1)),(u(!0),m(ie,null,ce(n.sessions,h=>(u(),m("option",{key:h.session_id,value:h.session_id},$(c(h))+" "+$(_(h)),9,ay))),128))],544),[[Oe,a.value]])],2))}},ry=G(ly,[["__scopeId","data-v-579589fb"]]),cy={class:"modal-dialog modal-dialog-centered"},dy={class:"modal-content"},uy={class:"modal-body"},my={key:0,class:"alert alert-danger"},py={class:"mb-3"},fy={class:"mb-3"},vy={class:"form-text"},hy={class:"mb-3"},_y={class:"mb-3"},gy=["value"],by={class:"modal-footer"},yy=["disabled"],$y={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:s}){const o=n,i=s,a=oe(),l=N(null),r=N(null),d=N(""),p=N(!1),c=N({name:"",purpose:"",description:"",member_minion_ids:[]}),_=b(()=>{const g=[];for(const[h,M]of a.sessions.entries())M.is_minion&&M.project_id===o.legionId&&g.push(M);return g}),v=b(()=>c.value.name.trim()!==""&&c.value.purpose.trim()!==""),f=async()=>{if(!v.value){d.value="Name and purpose are required";return}p.value=!0,d.value="";try{const g=await te.post(`/api/legions/${o.legionId}/channels`,{name:c.value.name.trim(),purpose:c.value.purpose.trim(),description:c.value.description.trim()||"",member_minion_ids:c.value.member_minion_ids});i("created",g.channel),r.value?.hide(),c.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(g){console.error("Failed to create channel:",g),d.value=g.response?.data?.detail||"Failed to create channel"}finally{p.value=!1}},C=()=>{r.value?.show()},y=()=>{r.value?.hide()};return me(()=>{l.value&&(r.value=new ze(l.value))}),ve(()=>{r.value?.dispose()}),e({show:C,hide:y}),(g,h)=>(u(),ge(ao,{to:"body"},[t("div",{ref_key:"modalElement",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[t("div",cy,[t("div",dy,[h[11]||(h[11]=t("div",{class:"modal-header"},[t("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",uy,[d.value?(u(),m("div",my,$(d.value),1)):I("",!0),t("form",{onSubmit:be(f,["prevent"])},[t("div",py,[h[4]||(h[4]=t("label",{for:"channel-name",class:"form-label"},[K(" Channel Name "),t("span",{class:"text-danger"},"*")],-1)),se(t("input",{id:"channel-name","onUpdate:modelValue":h[0]||(h[0]=M=>c.value.name=M),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[ue,c.value.name]]),h[5]||(h[5]=t("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),t("div",fy,[h[6]||(h[6]=t("label",{for:"channel-purpose",class:"form-label"},[K(" Purpose "),t("span",{class:"text-danger"},"*")],-1)),se(t("textarea",{id:"channel-purpose","onUpdate:modelValue":h[1]||(h[1]=M=>c.value.purpose=M),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[ue,c.value.purpose]]),t("div",vy,$(c.value.purpose.length)+" / 500 characters",1)]),t("div",hy,[h[7]||(h[7]=t("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),se(t("textarea",{id:"channel-description","onUpdate:modelValue":h[2]||(h[2]=M=>c.value.description=M),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[ue,c.value.description]])]),t("div",_y,[h[8]||(h[8]=t("label",{class:"form-label"},"Initial Members (Optional)",-1)),se(t("select",{"onUpdate:modelValue":h[3]||(h[3]=M=>c.value.member_minion_ids=M),multiple:"",class:"form-select",size:"5"},[(u(!0),m(ie,null,ce(_.value,M=>(u(),m("option",{key:M.session_id,value:M.session_id},$(M.name)+$(M.role?` (${M.role})`:""),9,gy))),128))],512),[[Oe,c.value.member_minion_ids]]),h[9]||(h[9]=t("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),t("div",by,[h[10]||(h[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:f,disabled:p.value||!v.value},$(p.value?"Creating...":"Create Channel"),9,yy)])])])],512)]))}},wy=G($y,[["__scopeId","data-v-573f4c01"]]),Ey={class:"modal-dialog modal-dialog-centered"},Cy={class:"modal-content"},Sy={class:"modal-body"},ky={key:0,class:"alert alert-danger"},Ty={class:"text-muted"},xy={class:"modal-footer"},My=["disabled"],Ay={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:s}){const o=n,i=s,a=N(null),l=N(null),r=N(""),d=N(!1),p=b(()=>o.channel?.member_minion_ids?.length||0),c=async()=>{if(!o.channel){r.value="No channel selected";return}d.value=!0,r.value="";try{await te.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),i("deleted",o.channel.channel_id),l.value?.hide()}catch(f){console.error("Failed to delete channel:",f),r.value=f.data?.detail||f.message||"Failed to delete channel"}finally{d.value=!1}},_=()=>{r.value="",l.value?.show()},v=()=>{l.value?.hide()};return me(()=>{a.value&&(l.value=new ze(a.value))}),ve(()=>{l.value?.dispose()}),e({show:_,hide:v}),(f,C)=>(u(),ge(ao,{to:"body"},[t("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[t("div",Ey,[t("div",Cy,[C[4]||(C[4]=t("div",{class:"modal-header"},[t("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Sy,[r.value?(u(),m("div",ky,$(r.value),1)):I("",!0),C[2]||(C[2]=t("div",{class:"alert alert-warning"},[t("strong",null,"âš ï¸ Warning:"),K(" This action cannot be undone. ")],-1)),t("p",null,[C[0]||(C[0]=K("Are you sure you want to delete ",-1)),t("strong",null,$(n.channel?.name),1),C[1]||(C[1]=K("?",-1))]),t("p",Ty," This channel has "+$(p.value)+" "+$(p.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),t("div",xy,[C[3]||(C[3]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-danger",onClick:c,disabled:d.value},$(d.value?"Deleting...":"Delete Channel"),9,My)])])])],512)]))}},Oy=["id"],Ny={class:"accordion-item"},Dy={class:"accordion-header"},Ly=["aria-expanded","aria-controls"],Iy={class:"text-muted ms-2"},Py=["id","data-bs-parent"],jy={class:"accordion-body p-0"},Ry={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},Vy={key:1,class:"list-group list-group-flush"},Wy={class:"d-flex align-items-center justify-content-between"},Hy=["onClick"],Fy={class:"channel-name"},Uy={class:"d-flex align-items-center gap-2"},By={class:"badge bg-secondary member-count"},qy=["onClick"],zy={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ye(),o=at(),i=N(null),a=N(null),l=N(null),r=N(!0),d=b(()=>`channelsAccordion-${e.project.project_id}`),p=b(()=>`channelsCollapsePanel-${e.project.project_id}`),c=b(()=>o.channelsByLegion.get(e.project.project_id)||[]),_=b(()=>c.value.length);function v(){const E=window.bootstrap;if(!E)return;const A=document.getElementById(p.value);if(!A)return;E.Collapse.getOrCreateInstance(A).toggle()}function f(){r.value=!0}function C(){r.value=!1}function y(E){s.push(`/channel/${e.project.project_id}/${E}`)}function g(){i.value?.show()}function h(E){l.value=E,a.value?.show()}function M(E){console.log("Channel created, waiting for WebSocket update:",E)}function T(E){const L=(o.channelsByLegion.get(e.project.project_id)||[]).filter(k=>k.channel_id!==E);o.channelsByLegion.set(e.project.project_id,L),s.currentRoute.value.path.includes(E)&&s.push(`/timeline/${e.project.project_id}`)}return me(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(E){console.error("Failed to load channels:",E)}}),(E,A)=>(u(),m(ie,null,[t("div",{class:"accordion mt-2",id:d.value},[t("div",Ny,[t("h2",Dy,[t("button",{class:Y(["accordion-button",{collapsed:!r.value}]),type:"button","aria-expanded":r.value,"aria-controls":p.value,onClick:v},[A[0]||(A[0]=t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),A[1]||(A[1]=t("span",{class:"fw-semibold"},"Channels",-1)),t("small",Iy,"("+$(_.value)+")",1)],10,Ly)]),t("div",{id:p.value,class:Y(["accordion-collapse","collapse",{show:r.value}]),"data-bs-parent":`#${d.value}`,onShown:f,onHidden:C},[t("div",jy,[t("div",{class:"p-2 border-bottom"},[t("button",{class:"btn btn-sm btn-primary w-100",onClick:g}," + New Channel ")]),c.value.length===0?(u(),m("div",Ry,' No channels yet. Click "New Channel" to create one. ')):(u(),m("div",Vy,[(u(!0),m(ie,null,ce(c.value,L=>(u(),m("div",{key:L.channel_id,class:"list-group-item list-group-item-action channel-item"},[t("div",Wy,[t("div",{class:"d-flex align-items-center flex-grow-1",onClick:k=>y(L.channel_id)},[A[2]||(A[2]=t("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),t("span",Fy,$(L.name),1)],8,Hy),t("div",Uy,[t("span",By,$(L.member_minion_ids?.length||0),1),t("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:be(k=>h(L),["stop"]),title:"Delete channel",style:{"font-size":"1.1rem","line-height":"1"}}," ðŸ—‘ï¸ ",8,qy)])])]))),128))]))])],42,Py)])],8,Oy),ae(wy,{ref_key:"createModal",ref:i,"legion-id":n.project.project_id,onCreated:M},null,8,["legion-id"]),ae(Ay,{ref_key:"deleteModal",ref:a,"legion-id":n.project.project_id,channel:l.value,onDeleted:T},null,8,["legion-id","channel"])],64))}},Ky=G(zy,[["__scopeId","data-v-4f87a3d1"]]),Yy=["data-project-id"],Gy=["id"],Jy=["aria-expanded","aria-controls","onKeydown"],Xy={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Qy={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Zy={class:"fw-semibold",style:{"flex-shrink":"0"}},e1={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},t1={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},s1=["title"],n1=["title"],o1=["id","aria-labelledby"],i1={class:"accordion-body p-0"},a1={class:"list-group list-group-flush"},l1={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ye(),o=he(),i=oe(),a=pe(),l=N(e.project.is_expanded||!1),r=b(()=>o.formatPath(e.project.working_directory)),d=b(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(L=>i.getSession(L)).filter(L=>L!=null)),p=b(()=>{const L=s.currentRoute.value;return L.name==="timeline"&&L.params.legionId===e.project.project_id}),c=b(()=>{const L=s.currentRoute.value;return L.name==="horde"&&L.params.legionId===e.project.project_id});function _(L){const k=window.bootstrap;if(!k)return;const D=document.getElementById(`collapse-${e.project.project_id}`);if(!D)return;k.Collapse.getOrCreateInstance(D).toggle()}function v(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function f(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const L=i.currentSessionId;L&&i.getSession(L)&&e.project.session_ids?.includes(L)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function C(){a.showModal("edit-project",{project:e.project})}function y(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function g(){s.push(`/timeline/${e.project.project_id}`)}function h(){s.push(`/horde/${e.project.project_id}`)}function M(L){L.dataTransfer.effectAllowed="move",L.dataTransfer.setData("application/project-id",e.project.project_id),L.dataTransfer.setData("text/plain",e.project.project_id),L.target.classList.add("dragging")}function T(L){L.target.classList.remove("dragging")}function E(L){L.preventDefault(),L.dataTransfer.dropEffect="move";const k=L.currentTarget.getBoundingClientRect(),D=k.top+k.height/2;L.clientY<D?(L.currentTarget.classList.add("drop-above"),L.currentTarget.classList.remove("drop-below")):(L.currentTarget.classList.add("drop-below"),L.currentTarget.classList.remove("drop-above"))}function A(L){L.preventDefault(),L.currentTarget.classList.remove("drop-above","drop-below");const k=L.dataTransfer.getData("application/project-id")||L.dataTransfer.getData("text/plain");if(!k||k===e.project.project_id)return;const D=L.currentTarget.getBoundingClientRect(),F=D.top+D.height/2,x=L.clientY<F,S=o.orderedProjects,w=S.findIndex(ne=>ne.project_id===e.project.project_id),O=S.findIndex(ne=>ne.project_id===k);if(w===-1||O===-1)return;const P=[...S],[j]=P.splice(O,1);let U=x?w:w+1;O<w&&U--,P.splice(U,0,j);const q=P.map(ne=>ne.project_id);o.reorderProjects(q)}return(L,k)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:M,onDragend:T,onDragover:E,onDrop:A},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:Y(["accordion-button bg-white p-2",{collapsed:!l.value}]),role:"button",tabindex:"0","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:_,onKeydown:[Qt(be(_,["prevent"]),["enter"]),Qt(be(_,["prevent"]),["space"])]},[t("div",Xy,[t("div",Qy,[t("div",Zy,[n.project.is_multi_agent?(u(),m("span",e1,"ðŸ›")):I("",!0),K(" "+$(n.project.name),1)]),t("div",t1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:be(C,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:be(y,["stop"])}," âž• ",8,s1)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(r.value),9,n1)])],42,Jy)],8,Gy),ae(ey,{project:n.project,sessions:d.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:Y(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:v,onHidden:f},[t("div",i1,[t("div",a1,[n.project.is_multi_agent?(u(),m("div",{key:0,class:Y(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:p.value}]),style:{cursor:"pointer"},onClick:g},[...k[0]||(k[0]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):I("",!0),n.project.is_multi_agent?(u(),m(ie,{key:1},[t("div",{class:Y(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:c.value}]),style:{cursor:"pointer"},onClick:h},[...k[1]||(k[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),t("span",{class:"fw-semibold"},"Horde"),t("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),ae(ry,{project:n.project,sessions:d.value},null,8,["project","sessions"]),ae(Ky,{project:n.project},null,8,["project"])],64)):(u(!0),m(ie,{key:2},ce(d.value,D=>(u(),ge(oy,{key:D.session_id,session:D,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,o1)],40,Yy))}},r1=G(l1,[["__scopeId","data-v-04f4e534"]]),c1={class:"project-list"},d1={key:0,class:"text-muted text-center py-3"},u1={__name:"ProjectList",setup(n){const e=he(),s=b(()=>e.orderedProjects);return(o,i)=>(u(),m("div",c1,[s.value.length===0?(u(),m("div",d1,' No projects yet. Click "New" to create one. ')):I("",!0),(u(!0),m(ie,null,ce(s.value,a=>(u(),ge(r1,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},m1={class:"flex-grow-1 overflow-auto p-3"},p1={id:"sessions-container"},f1={__name:"Sidebar",setup(n){const e=pe(),s=b(()=>e.sidebarCollapsed),o=b(()=>e.isMobile),i=b(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const l=N(!1);function r(c){l.value=!0,document.addEventListener("mousemove",d),document.addEventListener("mouseup",p)}function d(c){l.value&&e.setSidebarWidth(c.clientX)}function p(){l.value=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",p)}return(c,_)=>(u(),m("aside",{id:"sidebar",class:Y(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value}]),style:We(i.value)},[t("div",m1,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[_[0]||(_[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),t("div",p1,[ae(u1)])]),t("div",{class:"sidebar-resize-handle",onMousedown:r},null,32)],6))}},v1=G(f1,[["__scopeId","data-v-d792f0f0"]]),h1={class:"modal-dialog modal-lg"},_1={class:"modal-content"},g1={class:"modal-body"},b1={class:"mb-3"},y1={class:"input-group"},$1=["disabled"],w1={key:0,class:"text-center py-4"},E1={key:1,class:"alert alert-danger",role:"alert"},C1={key:2,class:"folder-list"},S1=["onClick","onDblclick"],k1={class:"d-flex align-items-center flex-grow-1"},T1=["onClick"],x1={key:1,class:"text-center text-muted py-3"},M1={class:"modal-footer"},A1=["disabled"],O1={__name:"FolderBrowserModal",setup(n){const e=pe(),s=N(""),o=N(""),i=N([]),a=N(!1),l=N(""),r=N(null);let d=null,p=null;const c=b(()=>{if(!s.value)return null;const T=s.value.split(/[\\/]/).filter(Boolean);return T.length<=1?null:(T.pop(),T.length>0?T.join("/"):"/")});function _(T){if(!T)return"";const E=T.split(/[\\/]/).filter(Boolean);return E.length<=2?T:".../"+E.slice(-2).join("/")}async function v(){a.value=!0,l.value="",i.value=[],o.value="";try{const T=s.value?{path:s.value}:{},E=await te.get("/api/filesystem/browse",{params:T});E.current_path&&(s.value=E.current_path),i.value=E.directories||[]}catch(T){console.error("Failed to load directory:",T),l.value=T.message||"Failed to load directory"}finally{a.value=!1}}function f(T){o.value=T.path}function C(T){s.value=T.path,o.value="",v()}function y(){c.value&&(s.value=c.value,o.value="",v())}function g(){const T=o.value||s.value;T&&p&&p(T),d&&d.hide()}function h(){v()}function M(){i.value=[],o.value="",l.value="",p=null,e.hideModal()}return le(()=>e.currentModal,T=>{if(T?.name==="folder-browser"&&d){const E=T.data||{};s.value=E.currentPath||"",p=E.onSelect||null,d.show()}}),me(()=>{r.value&&ye(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{d=new T(r.value),r.value.addEventListener("shown.bs.modal",h),r.value.addEventListener("hidden.bs.modal",M)})}),ve(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",h),r.value.removeEventListener("hidden.bs.modal",M)),d&&d.dispose()}),(T,E)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",h1,[t("div",_1,[E[7]||(E[7]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",g1,[t("div",b1,[E[2]||(E[2]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",y1,[se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=A=>s.value=A),onKeyup:Qt(v,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[ue,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:v,disabled:a.value},[...E[1]||(E[1]=[t("i",{class:"bi bi-arrow-clockwise"},null,-1),K(" Refresh ",-1)])],8,$1)])]),a.value?(u(),m("div",w1,[...E[3]||(E[3]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(u(),m("div",E1,$(l.value),1)):(u(),m("div",C1,[c.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:y,role:"button"},[...E[4]||(E[4]=[t("i",{class:"bi bi-arrow-up-circle me-2 text-secondary"},null,-1),t("span",{class:"text-secondary"},"..",-1)])])):I("",!0),(u(!0),m(ie,null,ce(i.value,A=>(u(),m("div",{key:A.path,class:Y(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:A.path===o.value}]),onClick:L=>f(A),onDblclick:L=>C(A),role:"button"},[t("div",k1,[E[5]||(E[5]=t("i",{class:"bi bi-folder-fill me-2 text-warning"},null,-1)),t("span",null,$(A.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:be(L=>C(A),["stop"])}," Open ",8,T1)],42,S1))),128)),i.value.length===0?(u(),m("div",x1," No subdirectories found ")):I("",!0)]))]),t("div",M1,[E[6]||(E[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:!o.value},' Select "'+$(_(o.value||s.value))+'" ',9,A1)])])])],512))}},N1=G(O1,[["__scopeId","data-v-667c51a9"]]),D1={class:"modal-dialog"},L1={class:"modal-content"},I1={class:"modal-body"},P1={class:"mb-3"},j1={key:0,class:"invalid-feedback"},R1={class:"mb-3"},V1={class:"input-group"},W1={key:0,class:"invalid-feedback"},H1={class:"mb-3 form-check"},F1={class:"mb-3 form-check"},U1={class:"form-check-label",for:"createSession"},B1={key:0,class:"mb-3 ms-4"},q1={for:"sessionName",class:"form-label"},z1={key:1,class:"alert alert-danger",role:"alert"},K1={class:"modal-footer"},Y1=["disabled"],G1={key:0,class:"spinner-border spinner-border-sm me-2"},J1={__name:"ProjectCreateModal",setup(n){const e=he(),s=oe(),o=pe(),i=N({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=N({name:"",workingDirectory:""}),l=N(!1),r=N(""),d=N(null);let p=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:g=>{i.value.workingDirectory=g,a.value.workingDirectory=""}})}function _(){a.value={};let g=!0;return i.value.name.trim()||(a.value.name="Project name is required",g=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",g=!1),g}async function v(){if(_()){l.value=!0,r.value="";try{const g=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await s.createSession(g.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),p&&p.hide(),f()}catch(g){console.error("Failed to create project:",g),r.value=g.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function f(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},r.value=""}function C(){const g=document.getElementById("projectName");g&&g.focus()}function y(){f(),o.hideModal()}return le(()=>o.currentModal,g=>{g?.name==="create-project"&&p&&p.show()}),me(()=>{d.value&&ye(async()=>{const{default:g}=await import("./modal-B4rHLo2F.js").then(h=>h.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{p=new g(d.value),d.value.addEventListener("shown.bs.modal",C),d.value.addEventListener("hidden.bs.modal",y)})}),ve(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",C),d.value.removeEventListener("hidden.bs.modal",y)),p&&p.dispose()}),(g,h)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",D1,[t("div",L1,[h[11]||(h[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",I1,[t("form",{onSubmit:be(v,["prevent"])},[t("div",P1,[h[5]||(h[5]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=M=>i.value.name=M),placeholder:"My Project",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",j1,$(a.value.name),1)):I("",!0)]),t("div",R1,[h[6]||(h[6]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",V1,[se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=M=>i.value.workingDirectory=M),placeholder:"/path/to/project",required:""},null,2),[[ue,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(u(),m("div",W1,$(a.value.workingDirectory),1)):I("",!0)]),h[7]||(h[7]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",H1,[se(t("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":h[2]||(h[2]=M=>i.value.isMultiAgent=M)},null,512),[[At,i.value.isMultiAgent]]),h[8]||(h[8]=t("label",{class:"form-check-label",for:"isMultiAgent"}," ðŸ› Multi-Agent Project (Legion) ",-1)),h[9]||(h[9]=t("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),t("div",F1,[se(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[3]||(h[3]=M=>i.value.createSession=M)},null,512),[[At,i.value.createSession]]),t("label",U1," Create initial "+$(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(u(),m("div",B1,[t("label",q1," Initial "+$(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),se(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[4]||(h[4]=M=>i.value.sessionName=M),placeholder:"main"},null,512),[[ue,i.value.sessionName]])])):I("",!0),r.value?(u(),m("div",z1,$(r.value),1)):I("",!0)],32)]),t("div",K1,[h[10]||(h[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:l.value},[l.value?(u(),m("span",G1)):I("",!0),K(" "+$(l.value?"Creating...":"Create Project"),1)],8,Y1)])])])],512))}},X1=G(J1,[["__scopeId","data-v-adf50394"]]),Q1={class:"modal-dialog"},Z1={class:"modal-content"},e$={class:"modal-body"},t$={class:"mb-3"},s$={key:0,class:"invalid-feedback"},n$={class:"mb-3"},o$=["value"],i$={key:0,class:"alert alert-danger",role:"alert"},a$={class:"danger-zone"},l$={class:"text-muted small"},r$=["disabled"],c$={key:0,class:"alert alert-warning mt-3",role:"alert"},d$={class:"mb-2"},u$={class:"d-flex gap-2"},m$=["disabled"],p$={key:0,class:"spinner-border spinner-border-sm me-2"},f$=["disabled"],v$={class:"modal-footer"},h$=["disabled"],_$={key:0,class:"spinner-border spinner-border-sm me-2"},g$={__name:"ProjectEditModal",setup(n){const e=he(),s=pe(),o=N(null),i=N({name:""}),a=N({name:""}),l=N(!1),r=N(!1),d=N(""),p=N(!1),c=N(null);let _=null;const v=b(()=>o.value?.session_ids?.length||0);function f(){a.value={};let T=!0;return i.value.name.trim()||(a.value.name="Project name is required",T=!1),T}async function C(){if(!(!f()||!o.value)){l.value=!0,d.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),_&&_.hide()}catch(T){console.error("Failed to update project:",T),d.value=T.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function y(){if(o.value){r.value=!0,d.value="";try{await e.deleteProject(o.value.project_id),_&&_.hide()}catch(T){console.error("Failed to delete project:",T),d.value=T.message||"Failed to delete project. Please try again."}finally{r.value=!1}}}function g(){i.value={name:""},a.value={},d.value="",p.value=!1}function h(){const T=document.getElementById("editProjectName");T&&(T.focus(),T.select())}function M(){g(),o.value=null,s.hideModal()}return le(()=>s.currentModal,T=>{if(T?.name==="edit-project"&&_){const E=T.data||{};o.value=E.project,o.value&&(i.value.name=o.value.name),_.show()}}),me(()=>{c.value&&ye(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{_=new T(c.value),c.value.addEventListener("shown.bs.modal",h),c.value.addEventListener("hidden.bs.modal",M)})}),ve(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",h),c.value.removeEventListener("hidden.bs.modal",M)),_&&_.dispose()}),(T,E)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",Q1,[t("div",Z1,[E[11]||(E[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",e$,[t("form",{onSubmit:be(C,["prevent"])},[t("div",t$,[E[3]||(E[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":E[0]||(E[0]=A=>i.value.name=A),placeholder:"My Project",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",s$,$(a.value.name),1)):I("",!0)]),t("div",n$,[E[4]||(E[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,o$),E[5]||(E[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),d.value?(u(),m("div",i$,$(d.value),1)):I("",!0)],32),E[9]||(E[9]=t("hr",null,null,-1)),t("div",a$,[E[7]||(E[7]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",l$," Deleting this project will also delete all "+$(v.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:E[1]||(E[1]=A=>p.value=!0),disabled:r.value},[...E[6]||(E[6]=[t("i",{class:"bi bi-trash"},null,-1),K(" Delete Project ",-1)])],8,r$)]),p.value?(u(),m("div",c$,[E[8]||(E[8]=t("strong",null,"Are you sure?",-1)),t("p",d$,' This will permanently delete the project "'+$(o.value?.name)+'" and all '+$(v.value)+" session(s). ",1),t("div",u$,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:y,disabled:r.value},[r.value?(u(),m("span",p$)):I("",!0),K(" "+$(r.value?"Deleting...":"Yes, Delete Permanently"),1)],8,m$),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:E[2]||(E[2]=A=>p.value=!1),disabled:r.value}," Cancel ",8,f$)])])):I("",!0)]),t("div",v$,[E[10]||(E[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:C,disabled:l.value},[l.value?(u(),m("span",_$)):I("",!0),K(" "+$(l.value?"Saving...":"Save Changes"),1)],8,h$)])])])],512))}},b$=G(g$,[["__scopeId","data-v-6f299f35"]]),y$={class:"modal-dialog modal-lg"},$$={class:"modal-content"},w$={class:"modal-header"},E$={class:"modal-title",id:"createSessionModalLabel"},C$={key:0,class:"text-muted small"},S$={class:"modal-body"},k$={class:"mb-3"},T$={key:0,class:"invalid-feedback"},x$={class:"mb-3"},M$={class:"mb-3"},A$={class:"mb-3"},O$={class:"form-text d-flex justify-content-between"},N$={key:0,class:"invalid-feedback"},D$={class:"mb-3 form-check"},L$={key:0,class:"form-text text-warning"},I$={class:"mb-3"},P$={class:"mb-3 form-check"},j$={key:0,class:"alert alert-danger",role:"alert"},R$={class:"modal-footer"},V$=["disabled"],W$={key:0,class:"spinner-border spinner-border-sm me-2"},H$={__name:"SessionCreateModal",setup(n){const e=Ye();he();const s=oe(),o=pe(),i=N(null),a=N({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0}),l=N({name:""}),r=N(!1),d=N(""),p=N(null);let c=null;const _=b(()=>a.value.system_prompt.length),v=b(()=>_.value>6e3),f=b(()=>_.value>5500&&_.value<=6e3);function C(){l.value={};let T=!0;return a.value.name.trim()||(l.value.name="Session name is required",T=!1),v.value&&(T=!1),T}async function y(){if(!(!C()||!i.value)){r.value=!0,d.value="";try{const T=a.value.tools.split(",").map(L=>L.trim()).filter(L=>L.length>0),E={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,tools:T},A=await s.createSession(i.value.project_id,E);a.value.startImmediately&&await s.startSession(A.session_id),e.push(`/session/${A.session_id}`),c&&c.hide(),g()}catch(T){console.error("Failed to create session:",T),d.value=T.message||"Failed to create session. Please try again."}finally{r.value=!1}}}function g(){a.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0},l.value={},d.value=""}function h(){const T=document.getElementById("sessionName");T&&T.focus()}function M(){g(),i.value=null,o.hideModal()}return le(()=>o.currentModal,T=>{if(T?.name==="create-session"&&c){const E=T.data||{};i.value=E.project,c.show()}}),me(()=>{p.value&&ye(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{c=new T(p.value),p.value.addEventListener("shown.bs.modal",h),p.value.addEventListener("hidden.bs.modal",M)})}),ve(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",h),p.value.removeEventListener("hidden.bs.modal",M)),c&&c.dispose()}),(T,E)=>(u(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",y$,[t("div",$$,[t("div",w$,[t("h5",E$,[E[7]||(E[7]=K(" Create New Session ",-1)),i.value?(u(),m("span",C$,"in "+$(i.value.name),1)):I("",!0)]),E[8]||(E[8]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",S$,[t("form",{onSubmit:be(y,["prevent"])},[t("div",k$,[E[9]||(E[9]=t("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":l.value.name}]),id:"sessionName","onUpdate:modelValue":E[0]||(E[0]=A=>a.value.name=A),placeholder:"main",required:""},null,2),[[ue,a.value.name]]),l.value.name?(u(),m("div",T$,$(l.value.name),1)):I("",!0)]),t("div",x$,[E[11]||(E[11]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),se(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":E[1]||(E[1]=A=>a.value.permission_mode=A)},[...E[10]||(E[10]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Oe,a.value.permission_mode]]),E[12]||(E[12]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",M$,[E[14]||(E[14]=t("label",{for:"model",class:"form-label"},"Model",-1)),se(t("select",{class:"form-select",id:"model","onUpdate:modelValue":E[2]||(E[2]=A=>a.value.model=A)},[...E[13]||(E[13]=[t("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),t("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),t("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[Oe,a.value.model]])]),t("div",A$,[E[15]||(E[15]=t("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),se(t("textarea",{class:Y(["form-control",{"is-invalid":v.value}]),id:"systemPrompt","onUpdate:modelValue":E[3]||(E[3]=A=>a.value.system_prompt=A),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[ue,a.value.system_prompt]]),t("div",O$,[t("span",null,$(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),t("span",{class:Y({"text-danger":v.value,"text-warning":f.value})},$(_.value)+" / 6000 chars ",3)]),v.value?(u(),m("div",N$," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):I("",!0)]),t("div",D$,[se(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":E[4]||(E[4]=A=>a.value.override_system_prompt=A)},null,512),[[At,a.value.override_system_prompt]]),E[17]||(E[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),m("div",L$,[...E[16]||(E[16]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):I("",!0)]),t("div",I$,[E[18]||(E[18]=t("label",{for:"tools",class:"form-label"},"Allowed Tools (Optional)",-1)),se(t("input",{type:"text",class:"form-control",id:"tools","onUpdate:modelValue":E[5]||(E[5]=A=>a.value.tools=A),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[ue,a.value.tools]]),E[19]||(E[19]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",P$,[se(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":E[6]||(E[6]=A=>a.value.startImmediately=A)},null,512),[[At,a.value.startImmediately]]),E[20]||(E[20]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),d.value?(u(),m("div",j$,$(d.value),1)):I("",!0)],32)]),t("div",R$,[E[21]||(E[21]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:r.value},[r.value?(u(),m("span",W$)):I("",!0),K(" "+$(r.value?"Creating...":"Create Session"),1)],8,V$)])])])],512))}},F$=G(H$,[["__scopeId","data-v-5aef47e0"]]),U$={class:"modal-dialog"},B$={class:"modal-content"},q$={class:"modal-body"},z$={class:"mb-3"},K$={key:0,class:"invalid-feedback"},Y$={class:"mb-3"},G$=["value"],J$={class:"mb-3"},X$={class:"form-control-plaintext"},Q$={class:"mb-3"},Z$=["disabled"],ew={key:0,value:"bypassPermissions"},tw={class:"form-text"},sw={key:0,class:"text-warning"},nw={key:1},ow={key:0,class:"mb-3"},iw={class:"card"},aw={class:"card-body"},lw={key:0,class:"mb-2"},rw={key:1,class:"mb-2"},cw={key:2,class:"mt-2"},dw={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},uw={key:1,class:"alert alert-danger",role:"alert"},mw={class:"modal-footer"},pw=["disabled"],fw={key:0,class:"spinner-border spinner-border-sm me-2"},vw={__name:"SessionEditModal",setup(n){const e=oe(),s=pe(),o=N(null),i=N({name:"",permission_mode:"default"}),a=N({name:""}),l=N(!1),r=N(""),d=N(null);let p=null;const c=b(()=>o.value?.state==="active"||o.value?.state==="starting"),_=b(()=>o.value?.initial_permission_mode==="bypassPermissions");function v(M){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[M]||"bg-secondary"}function f(){a.value={};let M=!0;return i.value.name.trim()||(a.value.name="Session name is required",M=!1),M}async function C(){if(!(!f()||!o.value)){l.value=!0,r.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),p&&p.hide()}catch(M){console.error("Failed to update session:",M),r.value=M.message||"Failed to update session. Please try again."}finally{l.value=!1}}}function y(){i.value={name:"",permission_mode:"default"},a.value={},r.value=""}function g(){const M=document.getElementById("editSessionName");M&&(M.focus(),M.select())}function h(){y(),o.value=null,s.hideModal()}return le(()=>s.currentModal,M=>{if(M?.name==="edit-session"&&p){const T=M.data||{};o.value=T.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),p.show()}}),me(()=>{d.value&&ye(async()=>{const{default:M}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:M}},__vite__mapDeps([0,1])).then(({default:M})=>{p=new M(d.value),d.value.addEventListener("shown.bs.modal",g),d.value.addEventListener("hidden.bs.modal",h)})}),ve(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",g),d.value.removeEventListener("hidden.bs.modal",h)),p&&p.dispose()}),(M,T)=>(u(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",U$,[t("div",B$,[T[15]||(T[15]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",q$,[t("form",{onSubmit:be(C,["prevent"])},[t("div",z$,[T[2]||(T[2]=t("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":T[0]||(T[0]=E=>i.value.name=E),placeholder:"Session Name",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",K$,$(a.value.name),1)):I("",!0)]),t("div",Y$,[T[3]||(T[3]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,G$),T[4]||(T[4]=t("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),t("div",J$,[T[5]||(T[5]=t("label",{class:"form-label"},"Current State",-1)),t("div",X$,[t("span",{class:Y(["badge",v(o.value?.state)])},$(o.value?.state),3)])]),t("div",Q$,[T[9]||(T[9]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),se(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":T[1]||(T[1]=E=>i.value.permission_mode=E),disabled:!c.value},[T[6]||(T[6]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),T[7]||(T[7]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),T[8]||(T[8]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),_.value?(u(),m("option",ew,"âš ï¸ Bypass Permissions (No prompts)")):I("",!0)],8,Z$),[[Oe,i.value.permission_mode]]),t("div",tw,[c.value?(u(),m("span",nw," Controls which tool actions require permission prompts ")):(u(),m("span",sw," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),m("div",ow,[T[13]||(T[13]=t("label",{class:"form-label"},"System Prompt Configuration",-1)),t("div",iw,[t("div",aw,[o.value?.override_system_prompt?(u(),m("div",lw,[...T[10]||(T[10]=[t("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),t("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),m("div",rw,[...T[11]||(T[11]=[t("span",{class:"badge bg-info"},"Append Mode",-1),t("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),m("div",cw,[T[12]||(T[12]=t("strong",{class:"small"},"Custom Instructions:",-1)),t("div",dw,$(o.value.system_prompt),1)])):I("",!0)])])])):I("",!0),r.value?(u(),m("div",uw,$(r.value),1)):I("",!0)],32)]),t("div",mw,[T[14]||(T[14]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:C,disabled:l.value},[l.value?(u(),m("span",fw)):I("",!0),K(" "+$(l.value?"Saving...":"Save Changes"),1)],8,pw)])])])],512))}},hw=G(vw,[["__scopeId","data-v-c99ca17f"]]),_w={class:"modal-dialog modal-dialog-centered"},gw={class:"modal-content"},bw={class:"modal-header"},yw={class:"modal-title",id:"manageSessionModalLabel"},$w={class:"modal-body"},ww={key:0,class:"text-center py-4"},Ew={class:"text-muted"},Cw={key:1},Sw={key:2},kw={class:"text-muted"},Tw={key:3},xw={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},Mw={class:"d-grid gap-2"},Aw=["disabled"],Ow=["disabled"],Nw=["disabled"],Dw=["disabled"],Lw={class:"modal-footer"},Iw={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},Pw={__name:"SessionManageModal",setup(n){const e=Ye(),s=oe(),o=pe(),i=je();Ie();const a=N(null),l=N(!1),r=N(""),d=N(""),p=N(null),c=N(null);let _=null;const v=b(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function f(){p.value="reset"}function C(){p.value="delete"}function y(){p.value=null}async function g(){p.value==="reset"?await T():p.value==="delete"&&await E()}async function h(){if(a.value){l.value=!0,r.value="Restarting session...";try{const k=a.value.session_id,D=await te.post(`/api/sessions/${k}/restart`);if(D.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(k),_&&_.hide();else{const F=D.error||D.detail||"Failed to restart session";console.error("Failed to restart session:",F),d.value=`Failed to restart session: ${F}`}}catch(k){console.error("Error restarting session:",k);const D=k.data?.detail||k.message||"Unknown error";d.value=`Error restarting session: ${D}`}finally{l.value=!1}}}async function M(){if(a.value)try{_&&_.hide(),console.log("Ending session",a.value.session_id);const k=a.value.session_id;await te.post(`/api/sessions/${k}/terminate`),await i.disconnectSession(),s.currentSessionId===k&&(s.currentSessionId=null),e.push("/")}catch(k){console.error("Error ending session:",k),await i.disconnectSession(),s.currentSessionId===a.value?.session_id&&(s.currentSessionId=null),e.push("/")}}async function T(){if(a.value){l.value=!0,r.value="Resetting session...";try{const k=a.value.session_id,D=await te.post(`/api/sessions/${k}/reset`);if(D.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(k),_&&_.hide();else{const F=D.error||D.detail||"Failed to reset session";console.error("Failed to reset session:",F),d.value=`Failed to reset session: ${F}`,p.value=null}}catch(k){console.error("Error resetting session:",k);const D=k.data?.detail||k.message||"Unknown error";d.value=`Error resetting session: ${D}`,p.value=null}finally{l.value=!1}}}async function E(){if(a.value){l.value=!0,r.value="Deleting session...";try{const k=a.value.session_id;await s.deleteSession(k),e.currentRoute.value.params.sessionId===k&&e.push("/"),_&&_.hide()}catch(k){console.error("Error deleting session:",k);const D=k.data?.detail||k.message||"Unknown error";d.value=`Error deleting session: ${D}`,p.value=null}finally{l.value=!1}}}function A(){p.value=null,l.value=!1,r.value="",d.value=""}function L(){A(),a.value=null,o.hideModal()}return le(()=>o.currentModal,k=>{if(k?.name==="manage-session"&&_){const D=k.data||{};a.value=D.session,A(),_.show()}}),me(()=>{c.value&&ye(async()=>{const{default:k}=await import("./modal-B4rHLo2F.js").then(D=>D.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{_=new k(c.value),c.value.addEventListener("hidden.bs.modal",L)})}),ve(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",L),_&&_.dispose()}),(k,D)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",_w,[t("div",gw,[t("div",bw,[t("h5",yw,$(p.value?v.value:"Manage Session"),1),D[1]||(D[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",$w,[l.value?(u(),m("div",ww,[D[2]||(D[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Ew,$(r.value),1)])):p.value==="reset"?(u(),m("div",Cw,[...D[3]||(D[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(u(),m("div",Sw,[D[6]||(D[6]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",kw,[D[4]||(D[4]=K("This will permanently delete session ",-1)),t("strong",null,$(a.value?.name),1),D[5]||(D[5]=K(".",-1))]),D[7]||(D[7]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(u(),m("div",Tw,[d.value?(u(),m("div",xw,[D[8]||(D[8]=t("strong",null,"Error:",-1)),K(" "+$(d.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:D[0]||(D[0]=F=>d.value="")})])):I("",!0),D[15]||(D[15]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",Mw,[t("button",{class:"btn btn-outline-primary text-start",onClick:h,disabled:l.value},[...D[9]||(D[9]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,Aw),t("button",{class:"btn btn-outline-secondary text-start",onClick:M,disabled:l.value},[...D[10]||(D[10]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,Ow),D[13]||(D[13]=t("hr",{class:"my-2"},null,-1)),D[14]||(D[14]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:f,disabled:l.value},[...D[11]||(D[11]=[t("strong",null,"ðŸ—‘ï¸ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,Nw),t("button",{class:"btn btn-outline-danger text-start",onClick:C,disabled:l.value},[...D[12]||(D[12]=[t("strong",null,"âŒ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,Dw)]),D[16]||(D[16]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),K(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",Lw,[p.value&&!l.value?(u(),m(ie,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancel"),t("button",{type:"button",class:Y(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:g},$(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?I("",!0):(u(),m("button",Iw,"Cancel"))])])])],512))}},jw=G(Pw,[["__scopeId","data-v-de7ff18c"]]),Rw={class:"modal-dialog modal-dialog-centered modal-lg"},Vw={class:"modal-content"},Ww={class:"modal-body"},Hw={key:0,class:"text-center text-muted py-4"},Fw={key:1},Uw={class:"mb-3"},Bw={class:"font-monospace small"},qw={class:"mb-3"},zw={class:"font-monospace small"},Kw={class:"mb-3"},Yw={class:"mb-3"},Gw={class:"mb-3"},Jw={key:0},Xw={class:"d-flex flex-wrap gap-1"},Qw={key:1,class:"text-muted small"},Zw={key:0,class:"mb-3"},eE={class:"d-flex flex-wrap gap-1"},tE={key:1,class:"mb-3"},sE={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},nE={class:"mb-3"},oE={class:"text-muted"},iE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},aE={__name:"SessionInfoModal",setup(n){const e=oe(),s=Ie(),o=pe(),i=N(null),a=N(!1),l=N(null);let r=null;const d=b(()=>{if(!i.value)return null;const v=e.initData.get(i.value);return v||(s.messagesBySession.get(i.value)||[]).find(y=>y.type==="system"&&(y.subtype==="init"||y.metadata?.subtype==="init")&&y.metadata?.init_data)?.metadata?.init_data||null});function p(v){return typeof v=="string"?v:typeof v=="object"&&v.type==="preset"?`Preset: ${v.preset}`:JSON.stringify(v,null,2)}function c(){i.value=null,a.value=!1}function _(){c(),o.hideModal()}return le(()=>o.currentModal,v=>{if(v?.name==="session-info"&&r){const f=v.data||{};i.value=f.sessionId,a.value=!1,r.show()}}),me(()=>{l.value&&ye(async()=>{const{default:v}=await import("./modal-B4rHLo2F.js").then(f=>f.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{r=new v(l.value),l.value.addEventListener("hidden.bs.modal",_)})}),ve(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",_),r&&r.dispose()}),(v,f)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[t("div",Rw,[t("div",Vw,[f[9]||(f[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ww,[d.value?(u(),m("div",Fw,[t("div",Uw,[f[1]||(f[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",Bw,$(i.value),1)]),t("div",qw,[f[2]||(f[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("div",zw,$(d.value.cwd||"Not specified"),1)]),t("div",Kw,[f[3]||(f[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,$(d.value.model||"Default"),1)]),t("div",Yw,[f[4]||(f[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,$(d.value.permissionMode||"default"),1)]),t("div",Gw,[f[5]||(f[5]=t("h6",{class:"text-muted"},"Available Tools",-1)),d.value.tools&&d.value.tools.length>0?(u(),m("div",Jw,[t("div",Xw,[(u(!0),m(ie,null,ce(d.value.tools,C=>(u(),m("span",{key:C,class:"badge bg-secondary"},$(C),1))),128))])])):(u(),m("div",Qw,"All tools available"))]),d.value.commands&&d.value.commands.length>0?(u(),m("div",Zw,[f[6]||(f[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",eE,[(u(!0),m(ie,null,ce(d.value.commands,C=>(u(),m("span",{key:C,class:"badge bg-info"},$(C),1))),128))])])):I("",!0),d.value.systemPrompt?(u(),m("div",tE,[f[7]||(f[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",sE,$(p(d.value.systemPrompt)),1)])):I("",!0),t("div",nE,[t("h6",oE,[f[8]||(f[8]=K(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:f[0]||(f[0]=C=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(u(),m("pre",iE,$(JSON.stringify(d.value,null,2)),1)):I("",!0)])])):(u(),m("div",Hw," No session configuration data available "))]),f[10]||(f[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},lE=G(aE,[["__scopeId","data-v-809e2099"]]),rE={class:"modal-dialog modal-dialog-centered"},cE={class:"modal-content"},dE={class:"modal-body"},uE={class:"mb-3"},mE=["value"],pE={key:0,class:"form-text"},fE={class:"mb-3"},vE={class:"mb-3"},hE={for:"minion-role",class:"form-label"},_E={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},gE={key:1,class:"field-indicator modified",title:"Modified from template"},bE=["placeholder","title"],yE={class:"mb-3"},$E={for:"minion-context",class:"form-label"},wE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},EE={key:1,class:"field-indicator modified",title:"Modified from template"},CE=["title"],SE={class:"form-text d-flex justify-content-between"},kE={key:0,class:"invalid-feedback"},TE={class:"mb-3 form-check"},xE={key:0,class:"form-text text-warning"},ME={class:"mb-3"},AE={class:"mb-3"},OE={for:"permission-mode",class:"form-label"},NE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},DE={key:1,class:"field-indicator modified",title:"Modified from template"},LE=["title"],IE={class:"mb-3"},PE={for:"allowed-tools",class:"form-label"},jE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},RE={key:1,class:"field-indicator modified",title:"Modified from template"},VE=["title"],WE={key:0,class:"alert alert-danger"},HE={class:"modal-footer"},FE=["disabled"],UE={key:0,class:"spinner-border spinner-border-sm me-2"},BE={__name:"CreateMinionModal",setup(n){const e=Ye(),s=he(),o=oe(),i=pe(),a=N(null);let l=null;const r=N(null),d=N([]),p=N(null),c=N(new Set),_=N({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),v=N({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),f=N({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:""}),C=N(""),y=N(""),g=N(!1),h=b(()=>C.value.trim()?C.value.split(",").map(B=>B.trim()).filter(B=>B.length>0):[]),M=b(()=>f.value.allowed_tools.trim()?f.value.allowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0):null),T=b(()=>f.value.initialization_context.length),E=b(()=>T.value>2e3),A=b(()=>T.value>1800&&T.value<=2e3),L=b(()=>p.value?d.value.find(B=>B.template_id===p.value):null),k=b(()=>L.value?.default_role||"e.g., Code Expert, Testing Specialist"),D=b(()=>({"field-autofilled":v.value.role==="autofilled","field-modified":v.value.role==="modified"})),F=b(()=>({"field-autofilled":v.value.initialization_context==="autofilled","field-modified":v.value.initialization_context==="modified"})),x=b(()=>({"field-autofilled":v.value.permission_mode==="autofilled","field-modified":v.value.permission_mode==="modified"})),S=b(()=>({"field-autofilled":v.value.allowed_tools==="autofilled","field-modified":v.value.allowed_tools==="modified"})),w=B=>{const V=v.value[B];return V==="autofilled"?`Auto-filled from template: ${L.value?.name}`:V==="modified"?"Modified from template value":""};async function O(){try{console.log("[CreateMinionModal] Loading templates...");const B=await te.get("/api/templates");console.log("[CreateMinionModal] Templates data:",B),d.value=B||[],console.log("[CreateMinionModal] Templates set to:",d.value)}catch(B){console.error("[CreateMinionModal] Failed to load templates:",B),d.value=[]}}function P(){if(c.value.clear(),!L.value){f.value.role="",f.value.initialization_context="",f.value.permission_mode="default",f.value.allowed_tools="",v.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},_.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const B=L.value;if(v.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},B.default_role?(f.value.role=B.default_role,c.value.add("role"),_.value.role=B.default_role,v.value.role="autofilled"):(f.value.role="",_.value.role=null,v.value.role="normal"),B.default_system_prompt?(f.value.initialization_context=B.default_system_prompt,c.value.add("initialization_context"),_.value.initialization_context=B.default_system_prompt,v.value.initialization_context="autofilled"):(f.value.initialization_context="",_.value.initialization_context=null,v.value.initialization_context="normal"),B.permission_mode?(f.value.permission_mode=B.permission_mode,c.value.add("permission_mode"),_.value.permission_mode=B.permission_mode,v.value.permission_mode="autofilled"):(f.value.permission_mode="default",_.value.permission_mode=null,v.value.permission_mode="normal"),B.allowed_tools&&B.allowed_tools.length>0){const V=B.allowed_tools.join(", ");f.value.allowed_tools=V,c.value.add("allowed_tools"),_.value.allowed_tools=V,v.value.allowed_tools="autofilled"}else f.value.allowed_tools="",_.value.allowed_tools=null,v.value.allowed_tools="normal"}function j(){i.showModal("template-management",{})}function U(){f.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:""},C.value="",p.value=null,c.value.clear(),v.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},_.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},y.value="",g.value=!1}function q(){U(),i.hideModal()}async function ne(){if(!f.value.name.trim()){y.value="Minion name is required";return}if(f.value.name.includes(" ")){y.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(E.value){y.value="Initialization context exceeds 2000 character limit";return}if(!r.value){y.value="Legion ID is missing";return}g.value=!0,y.value="";try{const B={name:f.value.name.trim(),role:f.value.role.trim(),initialization_context:f.value.initialization_context.trim(),override_system_prompt:f.value.override_system_prompt,capabilities:h.value,permission_mode:f.value.permission_mode,allowed_tools:M.value},V=await te.post(`/api/legions/${r.value}/minions`,B);V.success&&V.minion_id?(await s.fetchProjects(),await o.fetchSessions(),l&&l.hide(),e.push(`/spy/${r.value}/${V.minion_id}`)):y.value="Failed to create minion"}catch(B){console.error("Failed to create minion:",B),y.value=B.response?.data?.detail||"Failed to create minion"}finally{g.value=!1}}return le(()=>i.currentModal,(B,V)=>{if(B?.name==="create-minion"&&l){const re=B.data||{};r.value=re.project?.project_id||null,U(),O(),l.show()}else V?.name==="template-management"&&l&&a.value?.classList.contains("show")&&O()}),le(()=>f.value.role,B=>{_.value.role!==null&&(B===_.value.role?v.value.role="autofilled":v.value.role="modified")}),le(()=>f.value.initialization_context,B=>{_.value.initialization_context!==null&&(B===_.value.initialization_context?v.value.initialization_context="autofilled":v.value.initialization_context="modified")}),le(()=>f.value.permission_mode,B=>{_.value.permission_mode!==null&&(B===_.value.permission_mode?v.value.permission_mode="autofilled":v.value.permission_mode="modified")}),le(()=>f.value.allowed_tools,B=>{_.value.allowed_tools!==null&&(B===_.value.allowed_tools?v.value.allowed_tools="autofilled":v.value.allowed_tools="modified")}),me(()=>{a.value&&ye(()=>import("./modal-B4rHLo2F.js").then(B=>B.m),__vite__mapDeps([0,1])).then(B=>{const V=B.default;l=new V(a.value),a.value.addEventListener("hidden.bs.modal",q)}),O()}),ve(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",q),l&&l.dispose()}),(B,V)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[t("div",rE,[t("div",cE,[V[26]||(V[26]=t("div",{class:"modal-header"},[t("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",dE,[t("form",{onSubmit:be(ne,["prevent"])},[t("div",uE,[t("label",{for:"template-select",class:"form-label"},[V[9]||(V[9]=K(" Template ",-1)),t("button",{type:"button",onClick:j,class:"btn btn-link btn-sm p-0 ms-2"},[...V[8]||(V[8]=[t("i",{class:"bi-gear"},null,-1),K(" Manage Templates ",-1)])])]),se(t("select",{id:"template-select","onUpdate:modelValue":V[0]||(V[0]=re=>p.value=re),onChange:P,class:"form-select"},[V[10]||(V[10]=t("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(ie,null,ce(d.value,re=>(u(),m("option",{key:re.template_id,value:re.template_id},$(re.name),9,mE))),128))],544),[[Oe,p.value]]),L.value?(u(),m("div",pE,$(L.value.description),1)):I("",!0)]),t("div",fE,[V[11]||(V[11]=t("label",{for:"minion-name",class:"form-label"},[K(" Name "),t("span",{class:"text-danger"},"*")],-1)),se(t("input",{id:"minion-name","onUpdate:modelValue":V[1]||(V[1]=re=>f.value.name=re),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[ue,f.value.name]]),V[12]||(V[12]=t("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),t("div",vE,[t("label",hE,[V[13]||(V[13]=K(" Role ",-1)),v.value.role==="autofilled"?(u(),m("span",_E," âš¡ ")):I("",!0),v.value.role==="modified"?(u(),m("span",gE," âœï¸ ")):I("",!0)]),se(t("input",{id:"minion-role","onUpdate:modelValue":V[2]||(V[2]=re=>f.value.role=re),type:"text",class:Y(["form-control",D.value]),placeholder:k.value,title:w("role")},null,10,bE),[[ue,f.value.role]]),V[14]||(V[14]=t("div",{class:"form-text"}," Optional role description for the minion ",-1))]),t("div",yE,[t("label",$E,[V[15]||(V[15]=K(" Initialization Context ",-1)),v.value.initialization_context==="autofilled"?(u(),m("span",wE," âš¡ ")):I("",!0),v.value.initialization_context==="modified"?(u(),m("span",EE," âœï¸ ")):I("",!0)]),se(t("textarea",{id:"minion-context","onUpdate:modelValue":V[3]||(V[3]=re=>f.value.initialization_context=re),class:Y(["form-control",[F.value,{"is-invalid":E.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:w("initialization_context")},null,10,CE),[[ue,f.value.initialization_context]]),t("div",SE,[t("span",null,$(f.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),t("span",{class:Y({"text-danger":E.value,"text-warning":A.value})},$(T.value)+" / 2000 chars ",3)]),E.value?(u(),m("div",kE," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):I("",!0)]),t("div",TE,[se(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":V[4]||(V[4]=re=>f.value.override_system_prompt=re)},null,512),[[At,f.value.override_system_prompt]]),V[17]||(V[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),f.value.override_system_prompt?(u(),m("div",xE,[...V[16]||(V[16]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):I("",!0)]),t("div",ME,[V[18]||(V[18]=t("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),se(t("input",{id:"minion-capabilities","onUpdate:modelValue":V[5]||(V[5]=re=>C.value=re),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[ue,C.value]]),V[19]||(V[19]=t("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),t("div",AE,[t("label",OE,[V[20]||(V[20]=K(" Permission Mode ",-1)),v.value.permission_mode==="autofilled"?(u(),m("span",NE," âš¡ ")):I("",!0),v.value.permission_mode==="modified"?(u(),m("span",DE," âœï¸ ")):I("",!0)]),se(t("select",{class:Y(["form-select",x.value]),id:"permission-mode","onUpdate:modelValue":V[6]||(V[6]=re=>f.value.permission_mode=re),title:w("permission_mode")},[...V[21]||(V[21]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,LE),[[Oe,f.value.permission_mode]]),V[22]||(V[22]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",IE,[t("label",PE,[V[23]||(V[23]=K(" Allowed Tools (Optional) ",-1)),v.value.allowed_tools==="autofilled"?(u(),m("span",jE," âš¡ ")):I("",!0),v.value.allowed_tools==="modified"?(u(),m("span",RE," âœï¸ ")):I("",!0)]),se(t("input",{type:"text",class:Y(["form-control",S.value]),id:"allowed-tools","onUpdate:modelValue":V[7]||(V[7]=re=>f.value.allowed_tools=re),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:w("allowed_tools")},null,10,VE),[[ue,f.value.allowed_tools]]),V[24]||(V[24]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),y.value?(u(),m("div",WE,$(y.value),1)):I("",!0)],32)]),t("div",HE,[V[25]||(V[25]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",disabled:!f.value.name.trim()||g.value,onClick:ne},[g.value?(u(),m("span",UE)):I("",!0),K(" "+$(g.value?"Creating...":"Create Minion"),1)],8,FE)])])])],512))}},qE=G(BE,[["__scopeId","data-v-087cc297"]]),zE={class:"modal-dialog modal-dialog-centered modal-lg"},KE={class:"modal-content"},YE={class:"modal-body"},GE={key:0,class:"text-center text-muted py-4"},JE={key:1},XE={class:"mb-3"},QE={class:"mb-3"},ZE={class:"font-monospace small"},eC={class:"mb-3"},tC={class:"mb-3"},sC={class:"mb-3"},nC={key:0},oC={class:"d-flex flex-wrap gap-1"},iC={key:1,class:"text-muted small"},aC={class:"mb-3"},lC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},rC={key:1,class:"text-muted small"},cC={class:"mb-3"},dC={key:0,class:"badge bg-info"},uC={key:1,class:"badge bg-secondary"},mC={class:"mb-3"},pC={key:0,class:"font-monospace small"},fC={key:1,class:"text-muted small"},vC={key:0,class:"mb-3"},hC={key:0},_C={class:"list-unstyled mb-0"},gC={key:1,class:"text-muted small"},bC={class:"mb-3"},yC={key:0,class:"font-monospace small"},$C={key:1,class:"text-muted small"},wC={class:"mb-3"},EC={key:0},CC={class:"d-flex flex-wrap gap-1"},SC={key:1,class:"text-muted small"},kC={class:"mb-3"},TC={class:"small"},xC={class:"mb-3"},MC={class:"small"},AC={__name:"MinionViewModal",setup(n){const e=pe(),s=N(null),o=N(null);let i=null;function a(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function l(p){if(!p)return"N/A";try{const c=new Date(p);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function r(){s.value=null}function d(){r(),e.hideModal()}return le(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&i){const c=p.data||{};s.value=c.session,i.show()}}),me(()=>{o.value&&ye(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(c=>c.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{i=new p(o.value),o.value.addEventListener("hidden.bs.modal",d)})}),ve(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",d),i&&i.dispose()}),(p,c)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",zE,[t("div",KE,[c[13]||(c[13]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",YE,[s.value?(u(),m("div",JE,[t("div",XE,[c[0]||(c[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,$(s.value.name||"Unnamed Minion"),1)]),t("div",QE,[c[1]||(c[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",ZE,$(s.value.session_id),1)]),t("div",eC,[c[2]||(c[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,$(s.value.role||"Not specified"),1)]),t("div",tC,[c[3]||(c[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:Y(["badge",a(s.value.state)])},$(s.value.state),3)])]),t("div",sC,[c[4]||(c[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(u(),m("div",nC,[t("div",oC,[(u(!0),m(ie,null,ce(s.value.capabilities,_=>(u(),m("span",{key:_,class:"badge bg-secondary"},$(_),1))),128))])])):(u(),m("div",iC,"None"))]),t("div",aC,[c[5]||(c[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(u(),m("div",lC,$(s.value.initialization_context),1)):(u(),m("div",rC,"Not specified"))]),t("div",cC,[c[6]||(c[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(u(),m("span",dC,"Yes")):(u(),m("span",uC,"No"))])]),t("div",mC,[c[7]||(c[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(u(),m("div",pC,$(s.value.parent_overseer_id),1)):(u(),m("div",fC,$(s.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),s.value.is_overseer?(u(),m("div",vC,[c[8]||(c[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(u(),m("div",hC,[t("ul",_C,[(u(!0),m(ie,null,ce(s.value.child_minion_ids,_=>(u(),m("li",{key:_,class:"font-monospace small"},$(_),1))),128))])])):(u(),m("div",gC,"No children"))])):I("",!0),t("div",bC,[c[9]||(c[9]=t("h6",{class:"text-muted"},"Horde Membership",-1)),s.value.horde_id?(u(),m("div",yC,$(s.value.horde_id),1)):(u(),m("div",$C,"Not in a horde"))]),t("div",wC,[c[10]||(c[10]=t("h6",{class:"text-muted"},"Channel Memberships",-1)),s.value.channel_ids&&s.value.channel_ids.length>0?(u(),m("div",EC,[t("div",CC,[(u(!0),m(ie,null,ce(s.value.channel_ids,_=>(u(),m("span",{key:_,class:"badge bg-info"},$(_),1))),128))])])):(u(),m("div",SC,"No channels"))]),t("div",kC,[c[11]||(c[11]=t("h6",{class:"text-muted"},"Created",-1)),t("div",TC,$(l(s.value.created_at)),1)]),t("div",xC,[c[12]||(c[12]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",MC,$(l(s.value.updated_at)),1)])])):(u(),m("div",GE," No minion data available "))]),c[14]||(c[14]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},OC=G(AC,[["__scopeId","data-v-c44eaee2"]]),NC={class:"modal-dialog modal-lg"},DC={class:"modal-content"},LC={class:"modal-body"},IC={key:0,class:"template-list"},PC={key:0,class:"alert alert-info"},jC={class:"card-body"},RC={class:"d-flex justify-content-between align-items-start"},VC={class:"flex-grow-1"},WC={class:"card-title mb-1"},HC={class:"card-text text-muted small mb-2"},FC={class:"template-meta"},UC={class:"badge bg-secondary me-2"},BC={class:"text-muted small"},qC={class:"btn-group btn-group-sm ms-3"},zC=["onClick"],KC=["onClick"],YC={key:1,class:"template-form"},GC={class:"mb-3"},JC={class:"mb-3"},XC={class:"mb-3"},QC={class:"mb-3"},ZC={class:"mb-3"},eS={class:"mb-3"},tS={class:"mb-3"},sS={key:0,class:"alert alert-danger"},nS={class:"d-flex gap-2"},oS=["disabled"],iS={key:0,class:"spinner-border spinner-border-sm me-2"},aS={__name:"TemplateManagementModal",setup(n){const e=pe(),s=N(null);let o=null;const i=N([]),a=N(null),l=N(""),r=N(""),d=N(!1);async function p(){try{const g=await te.get("/api/templates");i.value=g||[]}catch(g){console.error("Failed to load templates:",g),i.value=[]}}function c(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},l.value="",r.value=""}function _(g){a.value={...g},l.value=g.allowed_tools?.join(", ")||"",r.value=""}async function v(){if(!a.value.name.trim()){r.value="Template name is required";return}d.value=!0,r.value="";try{const g=l.value.split(",").map(T=>T.trim()).filter(T=>T.length>0),h={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:g.length>0?g:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await te.post("/api/templates",h):await te.put(`/api/templates/${a.value.template_id}`,h),await p(),a.value=null,l.value=""}catch(g){console.error("Failed to save template:",g),r.value=g.response?.data?.detail||"Failed to save template"}finally{d.value=!1}}async function f(g){if(confirm(`Delete template "${g.name}"?

This action cannot be undone.`))try{await te.delete(`/api/templates/${g.template_id}`),await p()}catch(h){console.error("Failed to delete template:",h),alert(`Failed to delete template: ${h.response?.data?.detail||h.message}`)}}function C(){a.value=null,l.value="",r.value=""}function y(){a.value=null,l.value="",r.value="",e.hideModal()}return le(()=>e.currentModal,g=>{g?.name==="template-management"&&o&&(p(),o.show())}),me(()=>{s.value&&ye(()=>import("./modal-B4rHLo2F.js").then(g=>g.m),__vite__mapDeps([0,1])).then(g=>{const h=g.default;o=new h(s.value),s.value.addEventListener("hidden.bs.modal",y)})}),ve(()=>{s.value&&s.value.removeEventListener("hidden.bs.modal",y),o&&o.dispose()}),(g,h)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[t("div",NC,[t("div",DC,[h[15]||(h[15]=t("div",{class:"modal-header"},[t("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",LC,[a.value?I("",!0):(u(),m("div",IC,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[h[6]||(h[6]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:c,class:"btn btn-primary btn-sm"}," âž• Create New ")]),i.value.length===0?(u(),m("div",PC," No templates found. Create your first template! ")):I("",!0),(u(!0),m(ie,null,ce(i.value,M=>(u(),m("div",{key:M.template_id,class:"card mb-2"},[t("div",jC,[t("div",RC,[t("div",VC,[t("h6",WC,$(M.name),1),t("p",HC,$(M.description),1),t("div",FC,[t("span",UC,$(M.permission_mode),1),t("span",BC,$(M.allowed_tools?.length||0)+" tools",1)])]),t("div",qC,[t("button",{onClick:T=>_(M),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,zC),t("button",{onClick:T=>f(M),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,KC)])])])]))),128))])),a.value?(u(),m("div",YC,[t("h6",GC,$(a.value.template_id?"Edit Template":"Create Template"),1),t("div",JC,[h[7]||(h[7]=t("label",{for:"template-name",class:"form-label"},[K(" Name "),t("span",{class:"text-danger"},"*")],-1)),se(t("input",{id:"template-name","onUpdate:modelValue":h[0]||(h[0]=M=>a.value.name=M),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[ue,a.value.name]])]),t("div",XC,[h[8]||(h[8]=t("label",{for:"template-description",class:"form-label"},"Description",-1)),se(t("textarea",{id:"template-description","onUpdate:modelValue":h[1]||(h[1]=M=>a.value.description=M),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[ue,a.value.description]])]),t("div",QC,[h[10]||(h[10]=t("label",{for:"template-permission-mode",class:"form-label"},[K(" Permission Mode "),t("span",{class:"text-danger"},"*")],-1)),se(t("select",{id:"template-permission-mode","onUpdate:modelValue":h[2]||(h[2]=M=>a.value.permission_mode=M),class:"form-select",required:""},[...h[9]||(h[9]=[t("option",{value:"default"},"Default",-1),t("option",{value:"acceptEdits"},"Accept Edits",-1),t("option",{value:"plan"},"Plan Mode",-1),t("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Oe,a.value.permission_mode]])]),t("div",ZC,[h[11]||(h[11]=t("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),se(t("input",{id:"template-tools","onUpdate:modelValue":h[3]||(h[3]=M=>l.value=M),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[ue,l.value]]),h[12]||(h[12]=t("div",{class:"form-text"},"Comma-separated list of tools",-1))]),t("div",eS,[h[13]||(h[13]=t("label",{for:"template-role",class:"form-label"},"Default Role",-1)),se(t("input",{id:"template-role","onUpdate:modelValue":h[4]||(h[4]=M=>a.value.default_role=M),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[ue,a.value.default_role]])]),t("div",tS,[h[14]||(h[14]=t("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),se(t("textarea",{id:"template-prompt","onUpdate:modelValue":h[5]||(h[5]=M=>a.value.default_system_prompt=M),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[ue,a.value.default_system_prompt]])]),r.value?(u(),m("div",sS,$(r.value),1)):I("",!0),t("div",nS,[t("button",{onClick:v,class:"btn btn-primary",disabled:d.value},[d.value?(u(),m("span",iS)):I("",!0),K(" "+$(d.value?"Saving...":"Save Template"),1)],8,oS),t("button",{onClick:C,class:"btn btn-secondary"},"Cancel")])])):I("",!0)])])])],512))}},lS=G(aS,[["__scopeId","data-v-81126ff4"]]),rS={class:"container-fluid vh-100 d-flex flex-column p-0"},cS={class:"d-flex flex-grow-1 overflow-hidden position-relative"},dS={class:"flex-grow-1 d-flex flex-column overflow-hidden"},uS={__name:"App",setup(n){const e=pe(),s=je(),o=oe(),i=he(),a=Ye(),l=b(()=>e.sidebarCollapsed),r=b(()=>e.isMobile);me(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const _=c.replace("#/session/","");o.sessions.has(_)&&await o.selectSession(_)}else if(c.startsWith("#/timeline/")){const _=c.replace("#/timeline/","");a.push(`/timeline/${_}`)}window.addEventListener("popstate",d),window.addEventListener("resize",e.handleResize)}),ve(()=>{window.removeEventListener("popstate",d),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function d(){const c=window.location.hash;if(c.startsWith("#/session/")){const _=c.replace("#/session/","");o.sessions.has(_)&&o.selectSession(_)}}function p(){e.toggleSidebar()}return(c,_)=>{const v=io("router-view");return u(),m("div",rS,[ae(Gb),t("div",{id:"sidebar-backdrop",class:Y({show:!l.value&&r.value}),onClick:p},null,2),t("div",cS,[ae(v1),t("main",dS,[ae(v)])]),ae(N1),ae(X1),ae(b$),ae(F$),ae(hw),ae(jw),ae(lE),ae(qE),ae(OC),ae(lS)])}}},an=hi(uS);an.use(_i());an.use(Wb);an.mount("#app");
