const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as l,d as lt,r as L,b as _,n as Pe,e as K,f as fe,t as y,u as ae,w as ve,g as rs,F as oe,h as de,i as T,j as Ra,k as ye,l as Se,v as We,m as Te,p as xo,q as be,s as Co,x as dt,y as Me,z as Eo,A as De,B as En,C as cn,D as ts,E as Ba,G as Fa,H as un,T as Va,I as To,J as Ao,K as nt,L as bs,M as Ns,N as Tn,O as Wa,P as Ua}from"./vue-vendor-Ctw3vgQe.js";import{m as Ye,p as Wt}from"./markdown-vendor-BRsjnVvP.js";import{c as Ha}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();const qa={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},za={__name:"NoSessionSelected",setup(n){return(e,s)=>(l(),r("div",qa,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Ka="modulepreload",Ga=function(n){return"/"+n},An={},Ie=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let m=function(p){return Promise.all(p.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),f=d?.nonce||d?.getAttribute("nonce");a=m(s.map(p=>{if(p=Ga(p),p in An)return;An[p]=!0;const u=p.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const v=document.createElement("link");if(v.rel=u?"stylesheet":Ka,u||(v.as="script"),v.crossOrigin="",v.href=p,f&&v.setAttribute("nonce",f),document.head.appendChild(v),u)return new Promise((k,S)=>{v.addEventListener("load",k),v.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&c(f.reason);return e().catch(c)})};class Ls extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function It(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new Ls(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Ls?s:(console.error("API request failed:",s),new Ls(`Network error: ${s.message}`,0,null))}}async function Zt(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[f,m]of Object.entries(e.params))m!=null&&o.append(f,m);const a=o.toString();a&&(s=`${n}?${a}`);const{params:c,...d}=e;return It(s,{...d,method:"GET"})}return It(s,{...e,method:"GET"})}async function Do(n,e,s={}){return It(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ya(n,e,s={}){return It(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Mo(n,e={}){return It(n,{...e,method:"DELETE"})}async function Ja(n,e,s={}){return It(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Qa(){return Zt("/api/system/git-status")}async function Xa(){return Do("/api/system/restart")}const ke={get:Zt,post:Do,put:Ya,delete:Mo,patch:Ja},he=lt("session",()=>{const n=L(new Map),e=L(null),s=L(new Map),o=L(new Map),a=L(new Set),c=L(!1);let d=null;const f=_(()=>n.value.get(e.value)),m=_(()=>Array.from(n.value.values()).sort((A,E)=>A.order-E.order)),p=A=>_(()=>m.value.filter(E=>E.project_id===A)),u=_({get:()=>s.value.get(e.value)||"",set:A=>{e.value&&s.value.set(e.value,A)}});async function w(){try{const A=await ke.get("/api/sessions");return n.value.clear(),A.sessions.forEach(E=>{n.value.set(E.session_id,E)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function v(A,E){try{const O=(await ke.post("/api/sessions",{project_id:A,...E})).session_id,R=(await ke.get(`/api/sessions/${O}`)).session;return n.value.set(O,R),n.value=new Map(n.value),console.log(`Created session ${O}`),R}catch(C){throw console.error("Failed to create session:",C),C}}async function k(A){if(e.value===A&&!c.value)return;d&&(console.log(`Aborting pending selection to switch to ${A}`),d.abort(),d=null);const E=new AbortController;d=E,c.value=!0;try{if(e.value=A,E.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let C=n.value.get(A);if(!C)try{const F=await ke.get(`/api/sessions/${A}`);if(E.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}C=F.session,n.value.set(A,C),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(F){console.error(`Failed to fetch session ${A}:`,F);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await i(A),E.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${C.state} state)`);const F=6e4,W=200,J=5e3;let ie=0,re=0;for(;ie<F;){if(E.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const D=n.value.get(A);if(D&&D.state==="active"){console.log(`Session ${A} is now active after ${ie}ms`);break}if(ie-re>=J){const P=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${P}, ${ie/1e3}s elapsed)`),re=ie}await new Promise(P=>setTimeout(P,W)),ie+=W}const B=n.value.get(A);B&&B.state!=="active"&&console.warn(`Session ${A} did not become active within ${F/1e3}s (state: ${B.state}), continuing anyway`)}catch(F){console.error(`Failed to auto-start session ${A}:`,F)}if(E.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>fi),void 0)).useMessageStore().loadMessages(A),E.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>Wi),void 0)).useResourceStore().loadResources(A),E.signal.aborted){console.log(`Selection of ${A} aborted after resource load`);return}await(await Ie(()=>Promise.resolve().then(()=>Ui),void 0)).useWebSocketStore().connectSession(A),E.signal.aborted||console.log(`Selected session ${A}`)}finally{d===E&&(d=null),c.value=!1}}function S(A,E){const C=n.value.get(A);C?Object.assign(C,E):(n.value.set(A,E),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function b(A){a.value.add(A);try{const C=(await ke.delete(`/api/sessions/${A}`)).deleted_session_ids||[A];for(const O of C)n.value.delete(O),s.value.delete(O),o.value.delete(O);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(E){throw console.error("Failed to delete session:",E),E}finally{a.value.delete(A)}}async function g(A,E){try{await ke.patch(`/api/sessions/${A}`,E),S(A,E),console.log(`Updated session ${A}:`,E)}catch(C){throw console.error("Failed to update session:",C),C}}async function h(A,E){try{await ke.post(`/api/sessions/${A}/permission-mode`,{mode:E}),S(A,{current_permission_mode:E});const C=o.value.get(A);C&&(C.permissionMode=E,o.value.set(A,C)),console.log(`Set permission mode for session ${A} to ${E}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function i(A){try{await ke.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(E){throw console.error("Failed to start session:",E),E}}async function $(A){try{await ke.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(E){throw console.error("Failed to pause session:",E),E}}async function x(A){try{await ke.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(E){throw console.error("Failed to terminate session:",E),E}}function N(A){return n.value.get(A)}function M(A,E){o.value.set(A,E),E.permissionMode&&S(A,{current_permission_mode:E.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:f,orderedSessions:m,sessionsInProject:p,currentInput:u,fetchSessions:w,createSession:v,selectSession:k,updateSession:S,deleteSession:b,patchSession:g,setPermissionMode:h,startSession:i,pauseSession:$,terminateSession:x,getSession:N,storeInitData:M}}),Dn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:he},Symbol.toStringTag,{value:"Module"})),Oo="webui-sidebar-";function Gt(n,e){try{const s=localStorage.getItem(Oo+n);return s!==null?JSON.parse(s):e}catch{return e}}function Et(n,e){try{localStorage.setItem(Oo+n,JSON.stringify(e))}catch{}}const xe=lt("ui",()=>{const n=L(window.innerWidth<768),e=L(300),s=L(Gt("rightCollapsed",!0)),o=L(Gt("rightWidth",300)),a=L(Gt("activeTab","diff")),c=L(window.innerWidth>1024?Gt("rightVisible",!0):!1),d=L(null),f=L(new Set),m=L(window.innerWidth),p=_(()=>m.value<768),u=L(!0),w=L(!1),v=L(null),k=L(null),S=_(()=>v.value?{name:v.value,data:k.value}:null),b=L(!1),g=L("Loading..."),h=L(!1),i=L("idle");function $(){n.value=!n.value}function x(Z){n.value=Z}function N(Z){e.value=Math.max(200,Math.min(Z,window.innerWidth*.3))}function M(){s.value=!s.value,Et("rightCollapsed",s.value)}function A(Z){s.value=Z,Et("rightCollapsed",Z)}function E(Z){o.value=Math.max(200,Math.min(Z,window.innerWidth*.3)),Et("rightWidth",o.value)}function C(Z){a.value=Z,Et("activeTab",Z)}function O(Z){u.value=Z}function z(){const Z=localStorage.getItem("webui-background-color");w.value=Z==="red"}function R(){w.value=!w.value,localStorage.setItem("webui-background-color",w.value?"red":"gray")}function F(Z,ce=null){v.value=null,k.value=null,setTimeout(()=>{v.value=Z,k.value=ce},0)}function W(){v.value=null,k.value=null}function J(Z="Loading..."){b.value=!0,g.value=Z}function ie(){b.value=!1}function re(){F("restart-server")}function B(Z){d.value=Z}function D(Z){f.value.has(Z)?f.value.delete(Z):f.value.add(Z),f.value=new Set(f.value)}function P(){f.value.size>0&&(f.value=new Set)}function G(){c.value=!c.value,Et("rightVisible",c.value)}function X(Z){c.value=Z,Et("rightVisible",Z)}function se(){const Z=m.value;m.value=window.innerWidth,m.value<768&&Z>=768?n.value=!0:m.value>=768&&Z<768&&(n.value=!1),m.value>1024&&Z<=1024?c.value=Gt("rightVisible",!0):m.value<=1024&&Z>1024&&(c.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:a,rightPanelVisible:c,browsingProjectId:d,expandedStacks:f,windowWidth:m,isMobile:p,autoScrollEnabled:u,isRedBackground:w,activeModal:v,modalData:k,currentModal:S,isLoading:b,loadingMessage:g,restartInProgress:h,restartStatus:i,toggleSidebar:$,setSidebarCollapsed:x,setSidebarWidth:N,toggleRightSidebar:M,setRightSidebarCollapsed:A,setRightSidebarWidth:E,setRightSidebarTab:C,setBrowsingProject:B,toggleStack:D,collapseAllStacks:P,toggleRightPanel:G,setRightPanelVisible:X,setAutoScroll:O,initBackgroundColor:z,toggleBackgroundColor:R,showModal:F,hideModal:W,showLoading:J,hideLoading:ie,showRestartModal:re,handleResize:se}}),ne=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},Za={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},ei=["title"],ti={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},si={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=he(),o=_(()=>s.sessions.get(e.sessionId)),a=_(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),c=_(()=>{const m=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),d=_(()=>{const m=a.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),f=_(()=>{if(!o.value)return"No session selected";const m=a.value,p=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${u}${w}: ${p}`});return(m,p)=>(l(),r("div",Za,[o.value?(l(),r("div",{key:0,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":d.value}]),style:Pe({width:"100%",backgroundColor:c.value}),title:f.value},null,14,ei)):(l(),r("div",ti))]))}},ni=ne(si,[["__scopeId","data-v-63d222fe"]]),oi={class:"d-flex justify-content-between align-items-center gap-2"},ai={class:"d-flex gap-2"},ii=["disabled"],li={class:"mode-label"},ri=["disabled"],ci=["disabled"],ui={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=he(),o=xe(),a=_(()=>s.sessions.get(e.sessionId)),c=_(()=>a.value?.current_permission_mode||"default"),d={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},f=_(()=>d[c.value]||"ðŸ”’"),m=_(()=>c.value),p=["default","acceptEdits","plan"],u=async()=>{if(!a.value)return;if(c.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const b=(p.indexOf(c.value)+1)%p.length,g=p[b];try{await s.setPermissionMode(e.sessionId,g)}catch(h){console.error("Failed to cycle permission mode:",h)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},v=()=>{o.showModal("manage-session",{session:a.value})},k=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(S,b)=>(l(),r("div",{class:K(["session-status-bar border-top p-2",ae(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",oi,[t("div",ai,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!a.value},[fe(y(f.value)+" ",1),t("span",li,y(m.value),1)],8,ii),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!a.value},[...b[0]||(b[0]=[fe(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,ri),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:v,disabled:!a.value},[...b[1]||(b[1]=[fe(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,ci)]),t("div",null,[t("button",{class:K(["btn btn-sm",ae(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:k}," â¬‡ï¸ "+y(ae(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},di=ne(ui,[["__scopeId","data-v-ed9a4d3c"]]),Lt=lt("task",()=>{const n=L(new Map),e=L(new Set);function s(i){const $=n.value.get(i);return $?Array.from($.values()).filter(x=>x.status!=="deleted").sort((x,N)=>{const M=parseInt(x.id.replace(/\D/g,""))||0,A=parseInt(N.id.replace(/\D/g,""))||0;return M-A}):[]}function o(i){return s(i).find(x=>x.status==="in_progress")||null}function a(i){const $=s(i);return{total:$.length,completed:$.filter(x=>x.status==="completed").length,inProgress:$.filter(x=>x.status==="in_progress").length,pending:$.filter(x=>x.status==="pending").length}}function c(i){return e.value.has(i)}const d=_(()=>{const i=he();return s(i.currentSessionId)}),f=_(()=>{const i=he();return o(i.currentSessionId)}),m=_(()=>{const i=he();return a(i.currentSessionId)}),p=_(()=>{const i=he();return c(i.currentSessionId)});function u(i,$){n.value.has(i)||n.value.set(i,new Map),n.value.get(i).set($.id,{id:$.id,subject:$.subject||"",description:$.description||"",status:$.status||"pending",activeForm:$.activeForm||null,owner:$.owner||null,blocks:$.blocks||[],blockedBy:$.blockedBy||[],metadata:$.metadata||{}}),e.value.add(i),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${$.id} for session ${i}`)}function w(i,$,x){const N=n.value.get(i);if(!N){console.warn(`No tasks found for session ${i}`);return}const M=N.get($);if(!M){if(x.status==="deleted")return;u(i,{id:$,...x});return}x.subject!==void 0&&(M.subject=x.subject),x.description!==void 0&&(M.description=x.description),x.status!==void 0&&(M.status=x.status),x.activeForm!==void 0&&(M.activeForm=x.activeForm),x.owner!==void 0&&(M.owner=x.owner),x.metadata!==void 0&&(M.metadata={...M.metadata,...x.metadata}),x.addBlocks&&(M.blocks=[...new Set([...M.blocks,...x.addBlocks])]),x.addBlockedBy&&(M.blockedBy=[...new Set([...M.blockedBy,...x.addBlockedBy])]),x.status==="deleted"&&(N.delete($),N.size===0&&(e.value.delete(i),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${$} for session ${i}`,x)}function v(i,$){return n.value.get(i)?.get($)||null}function k(i){n.value.delete(i),e.value.delete(i),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${i}`)}function S(i,$){n.value.has(i)&&n.value.get(i).clear(),e.value.delete(i);const x=new Map;for(const N of $){if(N.metadata?.tool_uses)for(const M of N.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(M.name)&&x.set(M.id,{name:M.name,input:M.input});if(N.metadata?.tool_results)for(const M of N.metadata.tool_results){const A=x.get(M.tool_use_id);A&&(b(i,A.name,A.input,{error:M.is_error,content:M.content}),x.delete(M.tool_use_id))}}console.log(`Reconstructed ${n.value.get(i)?.size||0} tasks for session ${i}`)}function b(i,$,x,N){if(N?.error){console.log(`Skipping task update - tool ${$} returned error`);return}const M=g(N);if(M)switch($){case"TaskCreate":{const A=h(M)||x?.id;A&&u(i,{id:A,subject:x?.subject||"",description:x?.description||"",status:"pending",activeForm:x?.activeForm||null,owner:x?.owner||null,blocks:[],blockedBy:[],metadata:x?.metadata||{}});break}case"TaskUpdate":{const A=x?.taskId;A&&w(i,A,{status:x?.status,subject:x?.subject,description:x?.description,activeForm:x?.activeForm,owner:x?.owner,metadata:x?.metadata,addBlocks:x?.addBlocks,addBlockedBy:x?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{x?.taskId;break}}}function g(i){return i?typeof i=="string"?i:i.content?typeof i.content=="string"?i.content:JSON.stringify(i.content):i.message?i.message:JSON.stringify(i):null}function h(i){if(!i)return null;const $=i.match(/[Tt]ask\s*#(\d+)/i);if($)return $[1];const x=i.match(/#(\d+)/);return x?x[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:d,currentActiveTask:f,currentTaskStats:m,currentHasTasks:p,tasksForSession:s,activeTask:o,taskStats:a,hasTasks:c,getTask:v,createTask:u,updateTask:w,clearTasks:k,reconstructFromMessages:S,handleTaskToolResult:b}}),je=lt("message",()=>{const n=L(new Map),e=L(new Map),s=L(new Map),o=L(new Map),a=L(new Map),c=L(new Map),d=L(new Map),f=L(new Map),m=L(new Map),p=_(()=>{const B=he();return n.value.get(B.currentSessionId)||[]}),u=_(()=>{const B=he();return e.value.get(B.currentSessionId)||[]});async function w(B,D=null,P=0){try{const G=D||1e4,X=await ke.get(`/api/sessions/${B}/messages?limit=${G}&offset=${P}`),se=X.messages||[],Z=X.total_count||se.length,ce=X.has_more||!1;if(console.log(`Loaded ${se.length} of ${Z} messages for session ${B}`),n.value.set(B,se),se.length>0){const q=se[se.length-1];q.timestamp&&(d.value.set(B,q.timestamp),console.log(`Tracked last received timestamp for session ${B}: ${q.timestamp}`))}const H=new Set;se.forEach(q=>{if(q.type==="assistant"&&q.metadata?.tool_uses&&q.metadata.tool_uses.forEach(U=>{H.add(U.id)}),q.type==="user"&&q.metadata?.tool_results&&q.metadata.tool_results.forEach(U=>{H.delete(U.tool_use_id);const ee=c.value.get(B);ee&&ee.delete(U.tool_use_id)}),q.type==="system"&&q.metadata?.subtype==="client_launched"&&(H.forEach(U=>{O(B,U,"Session was restarted")}),H.clear(),q.timestamp)){const U=typeof q.timestamp=="number"?q.timestamp:new Date(q.timestamp).getTime()/1e3;f.value.set(B,U)}q.type==="system"&&q.metadata?.subtype==="interrupt"&&(H.forEach(U=>{O(B,U,"Session was interrupted")}),H.clear()),q.metadata?.has_tool_uses&&q.metadata.tool_uses&&q.metadata.tool_uses.forEach(U=>{g(B,U,q.timestamp)}),q.metadata?.has_tool_results&&q.metadata.tool_results&&q.metadata.tool_results.forEach(U=>{x(B,U)}),(q.type==="permission_request"||q.metadata?.has_permission_requests)&&h(B,q),q.type==="permission_response"&&i(B,{request_id:q.metadata?.request_id,decision:q.metadata?.decision,updated_input:q.metadata?.updated_input,reasoning:q.metadata?.reasoning,applied_updates:q.metadata?.applied_updates}),q.type==="system"&&(q.subtype==="init"||q.metadata?.subtype==="init")&&q.metadata?.init_data&&he().storeInitData(B,q.metadata.init_data)});const V=he().sessions.get(B);V&&!["active","paused","starting"].includes(V.state)&&(H.forEach(q=>{O(B,q,"Session was terminated")}),H.clear()),a.value.set(B,H),n.value=new Map(n.value);try{Lt().reconstructFromMessages(B,se)}catch(q){console.warn("Failed to reconstruct task state:",q)}return ce&&console.warn(`Warning: Only loaded ${se.length} of ${Z} messages. Some messages may be missing.`),{messages:se,totalCount:Z,hasMore:ce}}catch(G){throw console.error("Failed to load messages:",G),G}}function v(B,D){const P=a.value.get(B)||new Set;if(D.type==="assistant"&&D.metadata?.tool_uses&&D.metadata.tool_uses.forEach(G=>{P.add(G.id)}),D.type==="user"&&D.metadata?.tool_results&&D.metadata.tool_results.forEach(G=>{P.delete(G.tool_use_id);const X=c.value.get(B);X&&X.delete(G.tool_use_id)}),D.type==="system"&&D.metadata?.subtype==="client_launched"&&(P.forEach(G=>{O(B,G,"Session was restarted")}),P.clear(),D.timestamp)){const G=typeof D.timestamp=="number"?D.timestamp:new Date(D.timestamp).getTime()/1e3;f.value.set(B,G)}D.type==="system"&&D.metadata?.subtype==="interrupt"&&(P.forEach(G=>{O(B,G,"Session was interrupted")}),P.clear()),a.value.set(B,P)}function k(B,D){n.value.has(B)||n.value.set(B,[]);const P=n.value.get(B);if(D.id){const G=P.findIndex(X=>X.id===D.id);if(G!==-1){console.log(`Skipping duplicate message ${D.id} (already exists at index ${G})`);return}}P.push(D),D.timestamp&&d.value.set(B,D.timestamp),A(B,D),v(B,D),n.value=new Map(n.value)}function S(B,D){e.value.has(B)||e.value.set(B,[]),e.value.get(B).push(D),e.value=new Map(e.value)}function b(B,D,P){const G=e.value.get(B);if(G){const X=G.find(se=>se.id===D);X&&(Object.assign(X,P),e.value=new Map(e.value))}}function g(B,D,P=null){const G=M(D.name,D.input);s.value.set(G,D.id);const X={id:D.id,name:D.name,input:D.input,signature:G,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:P||new Date().toISOString(),isExpanded:!0};return S(B,X),console.log(`Created tool call ${X.id} for ${X.name}`),X}function h(B,D){console.log("handlePermissionRequest received:",D);const P=D.metadata?.tool_name||D.tool_name,G=D.metadata?.input_params||D.input_params,X=D.metadata?.request_id||D.request_id,se=D.metadata?.suggestions||D.suggestions||[];console.log("Extracted data:",{toolName:P,inputParams:G,requestId:X,suggestions:se});const Z=M(P,G),ce=s.value.get(Z);ce?(o.value.set(X,ce),b(B,ce,{status:"permission_required",permissionRequestId:X,suggestions:se}),console.log(`Permission required for tool ${ce}`,{suggestions:se})):console.warn("No tool use ID found for permission request signature:",Z,{toolName:P,inputParams:G,availableSignatures:Array.from(s.value.keys())})}function i(B,D){const P=o.value.get(D.request_id);if(P){const G={permissionDecision:D.decision,appliedUpdates:D.applied_updates||[]};D.decision==="allow"?(G.status="executing",G.backendStatus="running"):(G.status="completed",G.backendStatus="denied",G.result={error:!0,message:D.reasoning||"Permission denied"},G.isExpanded=!1),D.updated_input&&(G.input=D.updated_input),b(B,P,G),console.log(`Permission ${D.decision} for tool ${P}`)}}function $(B,D){console.log("handleToolCall received:",D);const P=D.tool_use_id;if(!P){console.warn("Received tool_call without tool_use_id:",D);return}e.value.has(B)||e.value.set(B,[]);const G=e.value.get(B),X=G.findIndex(ce=>ce.id===P),Z={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[D.status]||D.status;if(X!==-1){const ce=G[X];ce.status=Z,ce.backendStatus=D.status,D.permission&&(ce.suggestions=D.permission.suggestions||[],ce.permissionRequestId=D.request_id),D.permission_granted!==null&&D.permission_granted!==void 0&&(ce.permissionDecision=D.permission_granted?"allow":"deny"),D.result!==void 0&&(ce.result={error:D.status==="failed",content:D.result}),D.error&&(ce.result={error:!0,content:D.error}),D.status==="denied"&&(ce.result={error:!0,message:"Permission denied"},ce.isExpanded=!1),D.status==="interrupted"&&(O(B,P,"Session was interrupted"),ce.isExpanded=!1),(D.status==="completed"||D.status==="failed")&&(ce.isExpanded=!1),D.display&&(ce.backendState=D.display),console.log(`Updated tool call ${P} to status: ${Z} (backend: ${D.status})`)}else{const ce=M(D.name,D.input);s.value.set(ce,P);const H={id:P,name:D.name,input:D.input,signature:ce,status:Z,backendStatus:D.status,permissionRequestId:D.request_id,permissionDecision:D.permission_granted!==void 0?D.permission_granted?"allow":"deny":null,suggestions:D.permission?.suggestions||[],result:D.result?{error:D.status==="failed",content:D.result}:null,explanation:null,timestamp:D.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(D.status),backendState:D.display};D.error&&(H.result={error:!0,content:D.error}),G.push(H),console.log(`Created new tool call ${P} for ${D.name} with status: ${Z}`)}if(e.value=new Map(e.value),["completed","failed"].includes(D.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(D.name))try{Lt().handleTaskToolResult(B,D.name,D.input,{error:D.status==="failed",content:D.result})}catch(ce){console.warn("Failed to update task store:",ce)}}function x(B,D){const P=D.tool_use_id;b(B,P,{status:D.is_error?"error":"completed",result:{error:D.is_error,content:D.content},isExpanded:!1}),console.log(`Tool ${P} ${D.is_error?"failed":"completed"}`);const G=e.value.get(B);if(G){const X=G.find(se=>se.id===P);if(X&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(X.name))try{Lt().handleTaskToolResult(B,X.name,X.input,{error:D.is_error,content:D.content})}catch(se){console.warn("Failed to update task store:",se)}}}function N(B,D){const P=e.value.get(B);if(P){const G=P.find(X=>X.id===D);G&&(G.isExpanded=!G.isExpanded,e.value=new Map(e.value))}}function M(B,D){if(!B)return"unknown:{}";if(!D||typeof D!="object")return`${B}:{}`;const P=JSON.stringify(D,Object.keys(D).sort());return`${B}:${P}`}function A(B,D){const P=D.metadata?.display||D.display;if(!P)return;m.value.has(B)||m.value.set(B,new Map);const G=m.value.get(B);if(P.tool_states)for(const[X,se]of Object.entries(P.tool_states)){G.set(X,se);const Z=e.value.get(B);if(Z){const ce=Z.find(H=>H.id===X);if(ce){const H={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};ce.status=H[se.state]||se.state,ce.backendState=se}}}if(P.orphaned_tools&&P.orphaned_tools.length>0){const X=c.value.get(B)||new Map;for(const se of P.orphaned_tools)X.has(se)||X.set(se,{reason:"denied",message:"Session was interrupted"});c.value.set(B,X)}if(P.linked_permissions)for(const[X,se]of Object.entries(P.linked_permissions))o.value.set(X,se);P.tool_states&&Object.keys(P.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${B}:`,{toolStates:Object.keys(P.tool_states||{}).length,orphanedTools:(P.orphaned_tools||[]).length,linkedPermissions:Object.keys(P.linked_permissions||{}).length})}function E(B,D){return m.value.get(B)?.get(D)}function C(B){const D=m.value.get(B);return D&&D.size>0}function O(B,D,P){const G=c.value.get(B)||new Map;G.set(D,{reason:"denied",message:P}),c.value.set(B,G);const X=e.value.get(B);if(X){const se=X.find(Z=>Z.id===D);se&&se.isExpanded&&(se.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${D} as orphaned: ${P}`)}function z(B,D){const P=E(B,D);return P&&P.state==="orphaned"?!0:c.value.get(B)?.has(D)||!1}function R(B,D){const P=E(B,D);return P&&P.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:P}:c.value.get(B)?.get(D)}function F(B,D){const P=a.value.get(B);P&&P.size>0&&(P.forEach(G=>O(B,G,D)),P.clear())}function W(B){n.value.delete(B),e.value.delete(B),n.value=new Map(n.value),e.value=new Map(e.value)}function J(B){return d.value.get(B)}async function ie(B){const D=d.value.get(B);if(!D)return console.log(`No sync needed for session ${B} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${B} since ${D}`);const P=await ke.get(`/api/sessions/${B}/messages?limit=1000&offset=0`),G=P.messages||[],X=P.has_more||!1,se=U=>U?typeof U=="number"?U*1e3:new Date(U).getTime():0,Z=se(D),ce=G.filter(U=>U.timestamp?se(U.timestamp)>Z:!1);if(ce.length===0)return console.log(`No missed messages for session ${B}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ce.length} missed messages for session ${B}`);const H=n.value.get(B)||[],I=new Set(H.map(U=>U.id).filter(Boolean)),V=ce.filter(U=>!U.id||!I.has(U.id));if(console.log(`After deduplication: ${V.length} unique new messages`),V.length>0){const U=V.sort((ue,_e)=>{const ge=se(ue.timestamp),Ce=se(_e.timestamp);return ge-Ce}),ee=n.value.get(B)||[],$e=ee.length>0?se(ee[ee.length-1].timestamp):0,Ve=se(U[0].timestamp),Q=se(U[U.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ee.length,lastExisting:$e,lastExistingDate:ee.length>0?ee[ee.length-1].timestamp:"none",firstNew:Ve,firstNewDate:U[0].timestamp,lastNew:Q,lastNewDate:U[U.length-1].timestamp,shouldAppend:Ve>$e}),Ve>$e){const ue=[...ee,...U];n.value.set(B,ue),console.log(`âœ… Appended ${U.length} new messages (no full sort needed)`)}else{const ue=[...ee,...U].sort((_e,ge)=>{const Ce=se(_e.timestamp),Ge=se(ge.timestamp);return Ce-Ge});n.value.set(B,ue),console.log(`âš ï¸ Merged and sorted ${U.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${H.length} messages unchanged`);V.forEach(U=>{v(B,U),U.metadata?.has_tool_uses&&U.metadata.tool_uses&&U.metadata.tool_uses.forEach(ee=>{g(B,ee,U.timestamp)}),U.metadata?.has_tool_results&&U.metadata.tool_results&&U.metadata.tool_results.forEach(ee=>{x(B,ee)}),(U.type==="permission_request"||U.metadata?.has_permission_requests)&&h(B,U),U.type==="permission_response"&&i(B,{request_id:U.metadata?.request_id,decision:U.metadata?.decision,updated_input:U.metadata?.updated_input,reasoning:U.metadata?.reasoning,applied_updates:U.metadata?.applied_updates}),U.type==="system"&&(U.subtype==="init"||U.metadata?.subtype==="init")&&U.metadata?.init_data&&he().storeInitData(B,U.metadata.init_data)});const q=n.value.get(B);if(q&&q.length>0){const U=q[q.length-1];U.timestamp&&d.value.set(B,U.timestamp)}return n.value=new Map(n.value),{syncedCount:V.length,hasMore:X}}catch(P){return console.error(`Failed to sync messages for session ${B}:`,P),{syncedCount:0,hasMore:!1,error:P.message}}}const re=he();return ve(()=>Array.from(re.sessions.values()).map(D=>({id:D.session_id,state:D.state})),(B,D)=>{D&&B.forEach((P,G)=>{const X=D[G];if(!X||X.id!==P.id)return;const se=["active","paused","starting"].includes(X.state),Z=!["active","paused","starting"].includes(P.state);se&&Z&&F(P.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:rs(a),orphanedToolUses:rs(c),currentMessages:p,currentToolCalls:u,loadMessages:w,addMessage:k,addToolCall:S,updateToolCall:b,handleToolCall:$,handleToolUse:g,handlePermissionRequest:h,handlePermissionResponse:i,handleToolResult:x,toggleToolExpansion:N,clearMessages:W,markToolUseOrphaned:O,isToolUseOrphaned:z,getOrphanedInfo:R,clearOrphanedToolUses:F,getLastReceivedTimestamp:J,syncMessages:ie,getBackendToolState:E,hasBackendDisplayMetadata:C,backendToolStates:rs(m),launchTimestampBySession:rs(f)}}),fi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:je},Symbol.toStringTag,{value:"Module"}));function mi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function ss(n){return mi(n).toLocaleTimeString()}const pi={class:"msg-wrapper msg-user"},vi={class:"msg-meta"},hi={class:"msg-time"},_i={class:"msg-bubble msg-bubble-user"},gi=["innerHTML"],bi={key:0,class:"tool-results mt-2"},yi={class:"tool-results-header text-muted small mb-2"},wi={class:"d-flex align-items-start gap-2"},ki={class:"flex-grow-1"},$i={class:"text-muted"},Si={key:0,class:"text-danger small"},xi={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ye.setOptions({breaks:!0,gfm:!0});const s=_(()=>ss(e.message.timestamp)),o=_(()=>{const f=e.message.content||"";let m=Ye.parse(f);return m=m.replace(/\n</g,"<"),m=m.replace(/\n+$/,""),Wt.sanitize(m)}),a=_(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=_(()=>e.message.metadata?.tool_results||[]);function d(f,m){return f?f.length<=m?f:f.substring(0,m)+"...":""}return(f,m)=>(l(),r("div",pi,[t("div",vi,[m[0]||(m[0]=t("span",{class:"msg-role"},"user",-1)),t("span",hi,y(s.value),1)]),t("div",_i,[t("div",{class:"msg-text",innerHTML:o.value},null,8,gi),a.value?(l(),r("div",bi,[t("div",yi," Tool Results ("+y(c.value.length)+") ",1),(l(!0),r(oe,null,de(c.value,(p,u)=>(l(),r("div",{key:u,class:K(["tool-result-summary",p.is_error?"result-error":"result-success"])},[t("div",wi,[t("span",null,y(p.is_error?"âœ—":"âœ“"),1),t("div",ki,[t("small",$i,"Tool: "+y(p.tool_use_id),1),p.is_error?(l(),r("div",Si,y(d(p.content,200)),1)):T("",!0)])])],2))),128))])):T("",!0)])]))}},Ci=ne(xi,[["__scopeId","data-v-c5db10e0"]]),Ei={class:"thinking-block"},Ti=["aria-label"],Ai={class:"text-muted ms-auto"},Di={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Mi=["innerHTML"],Oi={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=L(!1),o=_(()=>e.thinking?.length||0),a=_(()=>{const d=e.thinking||"",f=Ye.parse(d);return Wt.sanitize(f)});function c(){s.value=!s.value}return(d,f)=>(l(),r("div",Ei,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:c},[t("span",{"aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,Ti),f[0]||(f[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Ai,y(o.value)+" characters",1)]),s.value?(l(),r("div",Di,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,Mi)])):T("",!0)]))}},Ni=ne(Oi,[["__scopeId","data-v-fda2352c"]]);function Mn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function Li(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function On(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Ii(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=Li(s.command),a=On(o,60);return`${e}: ${a}`}case"SlashCommand":return`SlashCommand: ${On(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=Mn(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",a=s.description||"Task",c=a.length>40?a.substring(0,40)+"...":a;return`Task: (${o}) ${c}`}case"Grep":case"Glob":{const o=s.pattern||"",a=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${a}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const a=s.query||"";return`WebSearch: ${a.length>40?a.substring(0,40)+"...":a}`}let o="";try{const a=s.url||"";a&&(o=new URL(a.startsWith("http")?a:`https://${a}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Mn(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const ji=["title"],Pi={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){Ra(v=>({v7cfa694e:m.value}));const s=n,o=je(),a=he(),c=L(!1),d=_(()=>{const v=a.currentSessionId;return v?s.tool.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[s.tool.backendStatus]||s.tool.backendStatus:o.isToolUseOrphaned(v,s.tool.id)?"orphaned":s.tool.status:s.tool.status}),f=_(()=>s.tool.result?.error||s.tool.status==="error"||s.tool.permissionDecision==="deny"),m=_(()=>{switch(d.value){case"completed":return f.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}),p=_(()=>({"node-expanded":s.isExpanded,"node-running":d.value==="executing","node-permission":d.value==="permission_required"})),u=_(()=>({"dot-running":d.value==="executing","dot-permission":d.value==="permission_required","dot-error":d.value==="error"||d.value==="completed"&&f.value})),w=_(()=>{const v=Ii(s.tool),k={completed:f.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[d.value]||d.value;return`${v} [${k}]`});return e({statusColor:m,effectiveStatus:d}),(v,k)=>(l(),r("div",{class:K(["timeline-node",[p.value,{"node-compact":n.compact}]]),title:w.value,onClick:k[0]||(k[0]=ye(S=>v.$emit("click"),["stop"])),onMouseenter:k[1]||(k[1]=S=>c.value=!0),onMouseleave:k[2]||(k[2]=S=>c.value=!1)},[t("div",{class:K(["node-dot",u.value])},null,2)],42,ji))}},Ri=ne(Pi,[["__scopeId","data-v-720f014d"]]),Bi={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"},compact:{type:Boolean,default:!1}},setup(n){const e=n,s=_(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(o,a)=>(l(),r("div",{class:K(["timeline-segment",{"segment-compact":n.compact}]),style:Pe(s.value)},null,6))}},Fi=ne(Bi,[["__scopeId","data-v-ea6b297e"]]),ze=lt("project",()=>{const n=L(new Map),e=L(null),s=_(()=>n.value.get(e.value)),o=_(()=>Array.from(n.value.values()).sort((h,i)=>h.order-i.order));async function a(){try{const h=await ke.get("/api/projects");return n.value.clear(),h.projects.forEach(i=>{n.value.set(i.project_id,i)}),console.log(`Loaded ${n.value.size} projects`),h.projects}catch(h){throw console.error("Failed to fetch projects:",h),h}}async function c(h,i){try{const x=(await ke.post("/api/projects",{name:h,working_directory:i})).project;return n.value.set(x.project_id,x),n.value=new Map(n.value),console.log(`Created project ${x.project_id}`),x}catch($){throw console.error("Failed to create project:",$),$}}async function d(h,i){try{await ke.put(`/api/projects/${h}`,i),f(h,i),console.log(`Updated project ${h}`,i)}catch($){throw console.error("Failed to update project:",$),$}}function f(h,i){const $=n.value.get(h);$&&(Object.assign($,i),n.value=new Map(n.value))}async function m(h){try{await ke.delete(`/api/projects/${h}`),n.value.delete(h),n.value=new Map(n.value),e.value===h&&(e.value=null),console.log(`Deleted project ${h}`)}catch(i){throw console.error("Failed to delete project:",i),i}}async function p(h){try{const i=await ke.put(`/api/projects/${h}/toggle-expansion`),$=n.value.get(h);return $&&($.is_expanded=i.is_expanded,n.value=new Map(n.value)),i.is_expanded}catch(i){throw console.error("Failed to toggle expansion:",i),i}}async function u(h){try{await ke.put("/api/projects/reorder",{project_ids:h}),h.forEach((i,$)=>{const x=n.value.get(i);x&&(x.order=$)}),n.value=new Map(n.value),console.log("Reordered projects",h)}catch(i){throw console.error("Failed to reorder projects:",i),i}}async function w(h,i){try{await ke.put(`/api/projects/${h}/sessions/reorder`,{session_ids:i});const $=n.value.get(h);$&&($.session_ids=i,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${h}`,i)}catch($){throw console.error("Failed to reorder sessions:",$),$}}function v(h,i){const $=n.value.get(h);if(!$||!$.session_ids||$.session_ids.length===0)return[{status:"none",flex:1}];const x=new Set,N=new Map;for(const O of $.session_ids){const z=i.getSession(O);if(z&&(N.set(O,z),z.child_minion_ids))for(const R of z.child_minion_ids)x.add(R)}const M=Array.from(N.values()).filter(O=>!x.has(O.session_id)).sort((O,z)=>(O.order||0)-(z.order||0));if(M.length===0&&N.size===0)return[{status:"none",flex:1}];function A(O){return O.state==="active"&&O.is_processing?"active":O.state==="active"?"idle":O.state==="paused"?"waiting":O.state==="error"?"error":"none"}function E(O,z){if(z.push({status:A(O),flex:1}),O.child_minion_ids)for(const R of O.child_minion_ids){const F=N.get(R);F&&E(F,z)}}const C=[];for(const O of M)E(O,C);return C.length>0?C:[{status:"none",flex:1}]}function k(h){return n.value.get(h)}function S(h){e.value=h}function b(){e.value=null}function g(h){if(!h)return"";const i=h.split(/[/\\]/).filter($=>$);return i.length===0?"/":i.length===1?`/${i[0]}`:i.length===2?`/${i.join("/")}`:`.../${i.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:a,createProject:c,updateProject:d,updateProjectLocal:f,deleteProject:m,toggleExpansion:p,reorderProjects:u,reorderSessionsInProject:w,getProject:k,getStatusBarSegments:v,selectProject:S,clearProjectSelection:b,formatPath:g}}),Nn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Is={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Ze=lt("resource",()=>{const n=L(new Map),e=L(!1),s=L(0),o=L(null),a=L(!1),c=L(new Map);function d(Q){if(!Q)return!1;if(Q.is_image===!0||(Q.mime_type||"").toLowerCase().startsWith("image/"))return!0;const _e=(Q.format||"").toLowerCase();if(_e.startsWith("image/")||Nn.has("."+_e))return!0;const ge=Q.original_filename||Q.original_name||"";if(ge){const Ce="."+ge.split(".").pop().toLowerCase();return Nn.has(Ce)}return!1}function f(Q){if(!Q||d(Q))return!1;const ue=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),_e=Q.original_filename||Q.original_name||"";if(_e){const Ce="."+_e.split(".").pop().toLowerCase();if(ue.has(Ce))return!0}const ge=(Q.mime_type||Q.format||"").toLowerCase();return!!(ge.startsWith("text/")||ge==="application/json"||ge==="application/xml")}function m(Q){if(d(Q))return"ðŸ–¼ï¸";if(Q.original_filename){const ue="."+Q.original_filename.split(".").pop().toLowerCase();return Is[ue]||Is.default}return Is.default}function p(Q){return Q.original_filename?"."+Q.original_filename.split(".").pop().toLowerCase():""}function u(Q){const ue=n.value.get(Q);return ue||[]}function w(Q){return n.value.get(Q)?.length||0}function v(Q){return w(Q)>0}function k(Q){return u(Q).filter(d)}function S(Q){return k(Q).length}function b(Q){return S(Q)>0}const g=_(()=>{const Q=he();return u(Q.currentSessionId)}),h=_(()=>{const Q=he();return w(Q.currentSessionId)}),i=_(()=>h.value>0),$=_(()=>g.value.filter(d)),x=_(()=>$.value.length),N=_(()=>x.value>0),M=_(()=>!e.value||!o.value?null:u(o.value)[s.value]||null),A=M,E=_(()=>o.value?w(o.value):0),C=E;async function O(Q){if(Q){a.value=!0;try{const _e=(await Zt(`/api/sessions/${Q}/resources`)).resources||[];_e.sort((ge,Ce)=>(ge.timestamp||0)-(Ce.timestamp||0)),n.value.set(Q,_e),n.value=new Map(n.value),console.log(`Loaded ${_e.length} resources for session ${Q}`)}catch(ue){console.error(`Failed to load resources for session ${Q}:`,ue),n.value.set(Q,[]),n.value=new Map(n.value)}finally{a.value=!1}}}const z=O;function R(Q,ue){if(!Q||!ue)return;let _e=n.value.get(Q);_e||(_e=[],n.value.set(Q,_e));const ge=_e.findIndex(Ce=>Ce.resource_id===ue.resource_id);ge>=0?_e[ge]=ue:_e.push(ue),_e.sort((Ce,Ge)=>(Ce.timestamp||0)-(Ge.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${ue.resource_id} to session ${Q}`)}const F=R;function W(Q,ue){return`/api/sessions/${Q}/resources/${ue}`}const J=W;function ie(Q,ue){return`/api/sessions/${Q}/resources/${ue}/download`}function re(Q,ue=0){o.value=Q,s.value=Math.max(0,Math.min(ue,w(Q)-1)),e.value=!0}function B(){e.value=!1}function D(){if(!o.value)return;const Q=w(o.value);Q!==0&&(s.value=(s.value+1)%Q)}const P=D;function G(){if(!o.value)return;const Q=w(o.value);Q!==0&&(s.value=(s.value-1+Q)%Q)}const X=G;function se(Q){if(!o.value)return;const ue=w(o.value);ue!==0&&(s.value=Math.max(0,Math.min(Q,ue-1)))}const Z=se;function ce(Q){n.value.delete(Q),n.value=new Map(n.value),o.value===Q&&B(),console.log(`Cleared resources for session ${Q}`)}const H=ce;async function I(Q,ue){if(!(!Q||!ue))try{await Mo(`/api/sessions/${Q}/resources/${ue}`),q(Q,ue)}catch(_e){console.error(`Failed to remove resource ${ue}:`,_e)}}function V(Q,ue){q(Q,ue)}function q(Q,ue){const _e=n.value.get(Q);if(!_e)return;const ge=_e.findIndex(Ce=>Ce.resource_id===ue);ge!==-1&&(_e.splice(ge,1),n.value=new Map(n.value),e.value&&o.value===Q&&(_e.length===0?B():s.value>=_e.length&&(s.value=_e.length-1)),c.value.delete(ue),c.value=new Map(c.value))}async function U(Q,ue){if(!Q||!ue)return null;const _e=c.value.get(ue);if(_e&&!_e.error)return _e.content;c.value.set(ue,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const ge=W(Q,ue),Ce=await fetch(ge);if(!Ce.ok)throw new Error(`HTTP ${Ce.status}`);const Ge=await Ce.text();return c.value.set(ue,{content:Ge,loading:!1,error:null}),c.value=new Map(c.value),Ge}catch(ge){return console.error(`Failed to fetch text content for resource ${ue}:`,ge),c.value.set(ue,{content:null,loading:!1,error:ge.message}),c.value=new Map(c.value),null}}function ee(Q){return c.value.get(Q)||null}function $e(Q){if(Q){const ue=n.value.get(Q);ue&&(ue.forEach(_e=>c.value.delete(_e.resource_id)),c.value=new Map(c.value))}else c.value=new Map}function Ve(Q,ue){const _e=n.value.get(Q);return _e&&_e.find(ge=>ge.resource_id===ue)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:a,textContentCache:c,currentResources:g,currentResourceCount:h,currentHasResources:i,currentFullViewResource:M,fullViewTotalResources:E,currentImages:$,currentImageCount:x,currentHasImages:N,currentFullViewImage:A,fullViewTotalImages:C,imagesBySession:n,resourcesForSession:u,resourceCount:w,hasResources:v,getResourceUrl:W,getDownloadUrl:ie,isImageResource:d,isTextResource:f,getResourceIcon:m,getResourceExtension:p,getResourceById:Ve,getTextContent:ee,imagesForSession:k,imageCount:S,hasImages:b,getImageUrl:J,loadResources:O,addResource:R,removeResource:I,handleResourceRemoved:V,openFullView:re,closeFullView:B,nextResource:D,prevResource:G,goToResource:se,clearResources:ce,fetchTextContent:U,clearTextCache:$e,loadImages:z,addImage:F,nextImage:P,prevImage:X,goToImage:Z,clearImages:H}}),Vi=Ze,Wi=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Vi,useResourceStore:Ze},Symbol.toStringTag,{value:"Module"})),rt=lt("websocket",()=>{const n=L(null),e=L(!1),s=L(0),o=10,a=L(null),c=L(!1),d=L(0),f=5,m=L(null);let p=null;const u=L(0),w=L(null),v=L(new Map),k=L(null),S=L(!1),b=L(0),g=5,h=L(null),i=1e4,$=1e3,x=L(Date.now()),N=L(Date.now()),M=L(Date.now());let A=null,E=null,C=null;const O=_(()=>e.value&&(c.value||!m.value)?"connected":e.value?"partial":"disconnected");function z(I){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${I}`}function R(I){const V={ui:{timer:()=>A,setTimer:q=>{A=q},lastPing:x,connected:e,name:"UI"},session:{timer:()=>E,setTimer:q=>{E=q},lastPing:N,connected:c,name:"Session"},legion:{timer:()=>C,setTimer:q=>{C=q},lastPing:M,connected:S,name:"Legion"}}[I];V.timer()&&clearInterval(V.timer()),V.setTimer(setInterval(()=>{if(!V.connected.value)return;const q=Date.now()-V.lastPing.value;if(q>i){console.warn(`âš ï¸ ${V.name} WebSocket heartbeat timeout (${q}ms since last ping) - forcing close to trigger reconnection`),V.connected.value=!1;const ee={ui:n,session:a,legion:k}[I];ee.value&&ee.value.readyState===WebSocket.OPEN&&ee.value.close()}},$)),console.log(`âœ… Started heartbeat monitor for ${V.name} WebSocket`)}function F(I){const V={ui:{get:()=>A,set:q=>{A=q}},session:{get:()=>E,set:q=>{E=q}},legion:{get:()=>C,set:q=>{C=q}}}[I];V.get()&&(clearInterval(V.get()),V.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${I} WebSocket`))}function W(){if(n.value)return;const I=z("/ws/ui");console.log(`Connecting to UI WebSocket: ${I}`),n.value=new WebSocket(I),n.value.onopen=()=>{e.value=!0,s.value=0,x.value=Date.now(),R("ui"),console.log("UI WebSocket connected")},n.value.onmessage=V=>{const q=JSON.parse(V.data);X(q)},n.value.onclose=()=>{if(F("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const V=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${V}ms (attempt ${s.value})`),setTimeout(W,V)}},n.value.onerror=V=>{console.error("UI WebSocket error:",V)}}function J(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function ie(I){u.value++;const V=u.value;if(console.log(`[Gen ${V}] Starting connection to session ${I}`),p&&(clearTimeout(p),p=null),await re(),u.value!==V){console.log(`[Gen ${V}] Connection cancelled (current generation: ${u.value})`);return}m.value=I,w.value=V;const q=z(`/ws/session/${I}`);console.log(`[Gen ${V}] Connecting to Session WebSocket: ${q}`),a.value=new WebSocket(q),a.value.onopen=async()=>{if(w.value!==V){console.log(`[Gen ${V}] Ignoring onopen (stale connection, current: ${w.value})`),a.value.close();return}c.value=!0,d.value=0,N.value=Date.now(),R("session"),console.log(`[Gen ${V}] Session WebSocket connected for ${I}`);const U=v.value.get(I);if(v.value.set(I,!0),U){console.log(`[Gen ${V}] Reconnection detected, syncing missed messages...`);try{const $e=await je().syncMessages(I);$e.syncedCount>0?console.log(`[Gen ${V}] âœ… Synced ${$e.syncedCount} missed messages`):$e.error?console.warn(`[Gen ${V}] âš ï¸ Message sync failed: ${$e.error}`):console.log(`[Gen ${V}] No missed messages to sync`),$e.hasMore&&console.warn(`[Gen ${V}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ee){console.error(`[Gen ${V}] Error during message sync:`,ee)}}else console.log(`[Gen ${V}] Initial connection, no sync needed`)},a.value.onmessage=U=>{if(w.value!==V){console.log(`[Gen ${V}] Ignoring message (stale connection, current: ${w.value})`);return}const ee=JSON.parse(U.data);se(ee,I)},a.value.onclose=()=>{F("session"),c.value=!1,a.value=null,console.log(`[Gen ${V}] Session WebSocket closed for ${I}`);const U=he();if(U.currentSessionId===I&&w.value===V&&d.value<f){d.value++;const ee=Math.min(2e3*d.value,3e4);console.log(`[Gen ${V}] Reconnecting Session WebSocket in ${ee}ms (attempt ${d.value})`),p=setTimeout(()=>{w.value===V&&U.currentSessionId===I?(p=null,ie(I)):console.log(`[Gen ${V}] Skipping reconnect (generation or session changed)`)},ee)}},a.value.onerror=U=>{console.error(`[Gen ${V}] Session WebSocket error:`,U)}}function re(){return new Promise(I=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),a.value){const V=m.value,q=()=>{a.value=null,c.value=!1,m.value=null,w.value=null,d.value=0,V&&v.value.delete(V),I()};if(a.value.readyState===WebSocket.CLOSED)q();else{const U=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),q()},2e3);a.value.addEventListener("close",()=>{clearTimeout(U),q()},{once:!0}),a.value.close()}}else m.value=null,w.value=null,I()})}function B(I){a.value&&c.value?(a.value.send(JSON.stringify({type:"send_message",content:I})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function D(I,V,q=!1,U=null,ee=null){if(a.value&&c.value){const $e={type:"permission_response",request_id:I,decision:V,apply_suggestions:q,timestamp:new Date().toISOString()};U&&($e.clarification_message=U),ee&&($e.selected_suggestions=ee),a.value.send(JSON.stringify($e)),console.log(`Sent permission ${V} for request ${I}`,{applySuggestions:q,clarification:U,selectedSuggestions:ee})}}function P(I,V,q){if(a.value&&c.value){const U={type:"permission_response",request_id:I,decision:V,updated_input:q,timestamp:new Date().toISOString()};a.value.send(JSON.stringify(U)),console.log(`Sent permission ${V} with updated_input for request ${I}`,q)}}function G(){a.value&&c.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function X(I){const V=he(),q=ze();switch(I.type){case"sessions_list":I.sessions&&Array.isArray(I.sessions)&&I.sessions.forEach(U=>{V.updateSession(U.session_id,U)});break;case"state_change":I.data&&I.data.session_id&&I.data.session&&V.updateSession(I.data.session_id,I.data.session);break;case"project_updated":if(I.data&&I.data.project){const U=I.data.project;q.updateProjectLocal(U.project_id,U),V.fetchSessions()}break;case"project_deleted":I.data&&I.data.project_id&&q.projects.delete(I.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":x.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",I.type)}}function se(I,V){const q=he();if(q.currentSessionId!==V){console.warn(`Ignoring message for session ${V} (current: ${q.currentSessionId})`);return}const U=je();switch(I.type){case"message":const ee=I.data;if(!ee||!ee.type){console.warn("Received message event with invalid data:",I);break}if(ee.type==="tool_call"){U.handleToolCall(V,ee);break}if(ee.type==="permission_request"){U.handlePermissionRequest(V,ee);break}if(ee.type==="permission_response"){U.handlePermissionResponse(V,ee);break}ee.metadata?.has_tool_uses&&ee.metadata.tool_uses.forEach($e=>{U.handleToolUse(V,$e,ee.timestamp)}),ee.metadata?.has_tool_results&&ee.metadata.tool_results.forEach($e=>{U.handleToolResult(V,$e)}),ee.type==="system"&&(ee.subtype==="init"||ee.metadata?.subtype==="init")&&ee.metadata?.init_data&&q.storeInitData(V,ee.metadata.init_data),U.addMessage(V,ee);break;case"permission_request":U.handlePermissionRequest(V,I);break;case"permission_response":U.handlePermissionResponse(V,I);break;case"tool_result":U.handleToolResult(V,I);break;case"state_change":q.updateSession(V,I.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${V}`);break;case"ping":N.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":I.resource&&(Ze().addResource(V,I.resource),console.log(`Resource registered for session ${V}:`,I.resource.resource_id));break;case"resource_removed":I.resource_id&&(Ze().handleResourceRemoved(V,I.resource_id),console.log(`Resource removed for session ${V}:`,I.resource_id));break;case"image_registered":I.image&&(Ze().addResource(V,{...I.image,resource_id:I.image.image_id}),console.log(`Image registered (legacy) for session ${V}:`,I.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",I.type)}}function Z(I){ce(),h.value=I;const V=z(`/ws/legion/${I}`);console.log(`Connecting to Legion WebSocket: ${V}`),k.value=new WebSocket(V),k.value.onopen=()=>{S.value=!0,b.value=0,M.value=Date.now(),R("legion"),console.log(`Legion WebSocket connected for ${I}`)},k.value.onmessage=q=>{const U=JSON.parse(q.data);H(U,I)},k.value.onclose=()=>{if(F("legion"),S.value=!1,k.value=null,console.log(`Legion WebSocket closed for ${I}`),h.value===I&&b.value<g){b.value++;const q=Math.min(2e3*b.value,3e4);setTimeout(()=>Z(I),q)}},k.value.onerror=q=>{console.error("Legion WebSocket error:",q)}}function ce(){k.value&&(k.value.close(),k.value=null,S.value=!1,h.value=null)}function H(I,V){Ie(async()=>{const{useLegionStore:q}=await Promise.resolve().then(()=>Np);return{useLegionStore:q}},void 0).then(({useLegionStore:q})=>{const U=q();switch(I.type){case"comm":I.comm&&(U.addComm(V,I.comm),console.log("Legion WebSocket: Received new comm",I.comm));break;case"minion_created":I.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",I.data),Ie(async()=>{const{useSessionStore:ee}=await Promise.resolve().then(()=>Dn);return{useSessionStore:ee}},void 0).then(({useSessionStore:ee})=>{ee().loadSessions()}));break;case"minion_updated":I.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",I.data),Ie(async()=>{const{useSessionStore:ee}=await Promise.resolve().then(()=>Dn);return{useSessionStore:ee}},void 0).then(({useSessionStore:ee})=>{ee().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${V}`);break;case"ping":M.value=Date.now(),k.value?.readyState===WebSocket.OPEN&&k.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",I.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:c,sessionRetryCount:d,legionConnected:S,legionRetryCount:b,overallStatus:O,connectUI:W,disconnectUI:J,connectSession:ie,disconnectSession:re,sendMessage:B,sendPermissionResponse:D,sendPermissionResponseWithInput:P,interruptSession:G,connectLegion:Z,disconnectLegion:ce}}),Ui=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:rt},Symbol.toStringTag,{value:"Module"})),Hi={class:"base-tool-handler"},qi={class:"tool-section"},zi={class:"tool-parameters"},Ki={class:"tool-code"},Gi={key:0,class:"tool-section"},Yi={class:"tool-section-label"},Ji={class:"tool-code"},Qi={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=_(()=>{if(!o.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,f)=>(l(),r("div",Hi,[t("div",qi,[f[0]||(f[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",zi,[t("pre",Ki,y(s.value),1)])]),o.value?(l(),r("div",Gi,[t("div",Yi,y(a.value?"Error:":"Result:"),1),t("div",{class:K(["tool-result",{"tool-result-error":a.value}])},[t("pre",Ji,y(c.value),1)],2)])):T("",!0)]))}},Xi=ne(Qi,[["__scopeId","data-v-1e69f57d"]]),Zi={class:"read-tool-handler"},el={class:"tool-section"},tl={class:"read-file-info"},sl={class:"file-icon"},nl={class:"file-path"},ol={key:0,class:"read-range"},al={key:0,class:"tool-section"},il={key:0,class:"tool-result tool-result-error"},ll={class:"tool-code"},rl={key:1,class:"image-preview"},cl={class:"content-header"},ul={class:"image-badge"},dl={class:"image-container"},fl=["src","alt"],ml={key:2,class:"file-content-preview"},pl={class:"content-header"},vl={class:"line-count-badge"},hl={key:0,class:"preview-note"},_l={class:"tool-code content-display"},gl={key:0,class:"more-indicator"},js=100,bl={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>{const h=s.value;return h.split("/").pop()||h}),a=_(()=>{const h=e.toolCall.input?.offset,i=e.toolCall.input?.limit;return h!==void 0||i!==void 0}),c=_(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),d=_(()=>{const h=e.toolCall.input?.offset||0,i=e.toolCall.input?.limit;return i!==void 0?h+i:"âˆž"}),f=_(()=>{const h=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(h)}),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>{if(!m.value||p.value)return null;const i=e.toolCall.result?.content;if(Array.isArray(i)){for(const $ of i)if($?.type==="image"&&$?.source?.type==="base64"&&$?.source?.data)return $.source.data}return null}),w=_(()=>{if(!u.value)return"";const h=s.value.toLowerCase();return h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".gif")?"image/gif":h.endsWith(".webp")?"image/webp":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".bmp")?"image/bmp":h.endsWith(".ico")?"image/x-icon":"image/png"}),v=_(()=>{if(!m.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),k=_(()=>p.value||!v.value||u.value?[]:v.value.split(`
`)),S=_(()=>k.value.length),b=_(()=>S.value>js),g=_(()=>p.value||u.value?"":k.value.slice(0,js).join(`
`));return(h,i)=>(l(),r("div",Zi,[t("div",el,[t("div",tl,[t("span",sl,y(f.value?"ðŸ–¼ï¸":"ðŸ“„"),1),i[0]||(i[0]=t("strong",null,"Reading:",-1)),t("code",nl,y(s.value),1),a.value?(l(),r("span",ol,"Lines "+y(c.value)+"-"+y(d.value),1)):T("",!0)])]),m.value?(l(),r("div",al,[p.value?(l(),r("div",il,[t("pre",ll,y(v.value),1)])):u.value?(l(),r("div",rl,[t("div",cl,[i[1]||(i[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",ul,y(w.value),1)]),t("div",dl,[t("img",{src:`data:${w.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,fl)])])):(l(),r("div",ml,[t("div",pl,[i[2]||(i[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",vl,y(S.value)+" lines",1),b.value?(l(),r("span",hl,"(showing first "+y(js)+")")):T("",!0)]),t("pre",_l,y(g.value),1),b.value?(l(),r("div",gl,"...")):T("",!0)]))])):T("",!0)]))}},yl=ne(bl,[["__scopeId","data-v-29b774b1"]]),wl={class:"write-tool-handler"},kl={class:"tool-section"},$l={class:"write-file-info mb-2"},Sl={class:"file-path"},xl={class:"write-content-preview"},Cl={class:"content-header"},El={class:"line-count-badge"},Tl={key:0,class:"preview-note"},Al={class:"tool-code content-display"},Dl={key:0,class:"more-indicator"},Ml={key:0,class:"tool-section"},Ol={key:0,class:"tool-result tool-result-error"},Nl={class:"tool-code"},Ll={key:1,class:"tool-result tool-result-success"},Il={class:"success-message"},Ps=100,jl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.content||""),a=_(()=>o.value.split(`
`)),c=_(()=>a.value.length),d=_(()=>c.value>Ps),f=_(()=>a.value.slice(0,Ps).join(`
`)),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>{if(!m.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,v)=>(l(),r("div",wl,[t("div",kl,[t("div",$l,[v[0]||(v[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),v[1]||(v[1]=t("strong",null,"Writing:",-1)),t("code",Sl,y(s.value),1)]),t("div",xl,[t("div",Cl,[v[2]||(v[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",El,y(c.value)+" lines",1),d.value?(l(),r("span",Tl,"(showing first "+y(Ps)+")")):T("",!0)]),t("pre",Al,y(f.value),1),d.value?(l(),r("div",Dl,"...")):T("",!0)])]),m.value?(l(),r("div",Ml,[p.value?(l(),r("div",Ol,[v[3]||(v[3]=t("strong",null,"Error:",-1)),t("pre",Nl,y(u.value),1)])):(l(),r("div",Ll,[t("div",Il,[v[4]||(v[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+y(c.value)+" lines written)",1)])]))])):T("",!0)]))}},Pl=ne(jl,[["__scopeId","data-v-ddc24a0f"]]),Rl={class:"bash-tool-handler"},Bl={class:"tool-section"},Fl={class:"bash-header"},Vl={class:"bash-header-content"},Wl={key:0,class:"bash-description"},Ul={key:1,class:"bash-flags"},Hl={class:"bash-command-section"},ql={class:"bash-command-content"},zl={key:0,class:"tool-section"},Kl={key:0,class:"bash-output"},Gl={key:1,class:"bash-output-empty"},Yl={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.command||""),o=_(()=>e.toolCall.input?.description||""),a=_(()=>e.toolCall.input?.timeout),c=_(()=>e.toolCall.input?.run_in_background||!1),d=_(()=>a.value||c.value),f=_(()=>{const v=[];return a.value&&v.push(`timeout: ${a.value}ms`),c.value&&v.push("background"),v.join(", ")}),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>p.value?"tool-result-error":"tool-result-success"),w=_(()=>{if(!m.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,k)=>(l(),r("div",Rl,[t("div",Bl,[t("div",Fl,[k[1]||(k[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Vl,[o.value?(l(),r("div",Wl,[k[0]||(k[0]=t("strong",null,"Description:",-1)),fe(" "+y(o.value),1)])):T("",!0),d.value?(l(),r("div",Ul,y(f.value),1)):T("",!0)])]),t("div",Hl,[k[2]||(k[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",ql,y(s.value),1)])]),m.value?(l(),r("div",zl,[t("div",{class:K(["tool-result",u.value])},[k[3]||(k[3]=t("strong",null,"Output:",-1)),w.value?(l(),r("pre",Kl,y(w.value),1)):(l(),r("div",Gl,"No output"))],2)])):T("",!0)]))}},Jl=ne(Yl,[["__scopeId","data-v-ab50fe73"]]),Ql={class:"todo-tool-handler"},Xl={class:"tool-section"},Zl={class:"todo-header"},er={class:"todo-summary"},tr={key:0,class:"todo-count todo-count-completed"},sr={key:1,class:"todo-count todo-count-in-progress"},nr={key:2,class:"todo-count todo-count-pending"},or={class:"todo-checklist"},ar={class:"todo-checkbox"},ir={class:"todo-content"},lr={key:0,class:"tool-section"},rr={key:0,class:"tool-result tool-result-error"},cr={class:"tool-code"},ur={key:1,class:"tool-result tool-result-success"},dr={class:"success-message"},fr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.todos||[]),o=_(()=>s.value.filter(u=>u.status==="completed").length),a=_(()=>s.value.filter(u=>u.status==="in_progress").length),c=_(()=>s.value.filter(u=>u.status==="pending").length);function d(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const f=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=_(()=>{if(!f.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,w)=>(l(),r("div",Ql,[t("div",Xl,[t("div",Zl,[w[0]||(w[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=t("strong",null,"Task List:",-1)),t("div",er,[o.value>0?(l(),r("span",tr,y(o.value)+" completed ",1)):T("",!0),a.value>0?(l(),r("span",sr,y(a.value)+" in progress ",1)):T("",!0),c.value>0?(l(),r("span",nr,y(c.value)+" pending ",1)):T("",!0)])]),t("div",or,[(l(!0),r(oe,null,de(s.value,(v,k)=>(l(),r("div",{key:k,class:K(["todo-item",`todo-${v.status}`])},[t("span",ar,y(d(v.status)),1),t("span",ir,y(v.content),1)],2))),128))])]),f.value?(l(),r("div",lr,[m.value?(l(),r("div",rr,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",cr,y(p.value),1)])):(l(),r("div",ur,[t("div",dr,[w[3]||(w[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+y(s.value.length)+" tasks)",1)])]))])):T("",!0)]))}},mr=ne(fr,[["__scopeId","data-v-bbe55ee7"]]),pr={class:"edit-tool-handler"},vr={class:"tool-section"},hr={class:"edit-file-info"},_r={class:"file-path"},gr={key:0,class:"replace-all-badge"},br={class:"edit-diff-container"},yr={class:"diff-header"},wr={class:"diff-stats"},kr={class:"stat-removed"},$r={class:"stat-added"},Sr={class:"unified-diff"},xr={class:"diff-scroll-container"},Cr={class:"diff-marker"},Er={class:"diff-content"},Tr={key:0,class:"tool-section"},Ar={key:0,class:"tool-result tool-result-error"},Dr={class:"tool-code"},Mr={key:1,class:"tool-result tool-result-success"},Or={class:"success-message"},Nr={key:0,class:"success-detail"},Lr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.old_string||""),a=_(()=>e.toolCall.input?.new_string||""),c=_(()=>e.toolCall.input?.replace_all||!1),d=_(()=>{const k=Ha(s.value,o.value,a.value,"","",{context:3}).split(`
`),S=[];for(let b=4;b<k.length;b++){const g=k[b];g&&(g.startsWith("-")?S.push({type:"removed",content:g.substring(1)}):g.startsWith("+")?S.push({type:"added",content:g.substring(1)}):g.startsWith(" ")?S.push({type:"context",content:g.substring(1)}):g.startsWith("@@")&&S.push({type:"hunk",content:g}))}return S}),f=_(()=>d.value.filter(v=>v.type==="removed").length),m=_(()=>d.value.filter(v=>v.type==="added").length),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!p.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,k)=>(l(),r("div",pr,[t("div",vr,[t("div",hr,[k[0]||(k[0]=t("span",{class:"file-icon"},"âœï¸",-1)),k[1]||(k[1]=t("strong",null,"Editing:",-1)),t("code",_r,y(s.value),1),c.value?(l(),r("span",gr,"Replace All")):T("",!0)]),t("div",br,[t("div",yr,[k[2]||(k[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",wr,[t("span",kr,"-"+y(f.value),1),t("span",$r,"+"+y(m.value),1)])]),t("div",Sr,[t("div",xr,[(l(!0),r(oe,null,de(d.value,(S,b)=>(l(),r("div",{key:b,class:K(["diff-line",{"diff-line-removed":S.type==="removed","diff-line-added":S.type==="added","diff-line-context":S.type==="context","diff-line-hunk":S.type==="hunk"}])},[t("span",Cr,y(S.type==="removed"?"-":S.type==="added"?"+":S.type==="hunk"?"@":" "),1),t("span",Er,y(S.content),1)],2))),128))])])])]),p.value?(l(),r("div",Tr,[u.value?(l(),r("div",Ar,[k[3]||(k[3]=t("strong",null,"Error:",-1)),t("pre",Dr,y(w.value),1)])):(l(),r("div",Mr,[t("div",Or,[k[4]||(k[4]=t("span",{class:"success-icon"},"âœ…",-1)),k[5]||(k[5]=t("strong",null,"File edited successfully",-1)),c.value?(l(),r("span",Nr,"(all occurrences replaced)")):T("",!0)])]))])):T("",!0)]))}},Ir=ne(Lr,[["__scopeId","data-v-dd74055e"]]),jr={class:"search-tool-handler"},Pr={class:"tool-section"},Rr={class:"search-info"},Br={class:"search-icon"},Fr={class:"search-pattern"},Vr={key:0,class:"search-path"},Wr={key:1,class:"search-filters"},Ur={key:0,class:"filter-badge"},Hr={key:1,class:"filter-badge"},qr={key:2,class:"filter-badge"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Yr={key:1,class:"search-results"},Jr={class:"results-header"},Qr={class:"results-label"},Xr={class:"results-count-badge"},Zr={class:"results-content"},ec={class:"tool-code"},tc={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="Grep"),o=_(()=>e.toolCall.input?.pattern||"Unknown"),a=_(()=>e.toolCall.input?.path||null),c=_(()=>e.toolCall.input?.type||null),d=_(()=>e.toolCall.input?.glob||null),f=_(()=>e.toolCall.input?.["-i"]||!1),m=_(()=>c.value||d.value||f.value),p=_(()=>s.value?"ðŸ”":"ðŸ“"),u=_(()=>s.value?"Searching content":"Finding files"),w=_(()=>s.value?"Matches":"Files found"),v=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),S=_(()=>{if(!v.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),b=_(()=>!v.value||k.value||!S.value?0:S.value.split(`
`).filter(h=>h.trim()).length);return(g,h)=>(l(),r("div",jr,[t("div",Pr,[t("div",Rr,[t("span",Br,y(p.value),1),t("strong",null,y(u.value)+":",1),t("code",Fr,y(o.value),1),a.value?(l(),r("span",Vr,"in "+y(a.value),1)):T("",!0),m.value?(l(),r("span",Wr,[c.value?(l(),r("span",Ur,"type: "+y(c.value),1)):T("",!0),d.value?(l(),r("span",Hr,"glob: "+y(d.value),1)):T("",!0),f.value?(l(),r("span",qr,"case-insensitive")):T("",!0)])):T("",!0)])]),v.value?(l(),r("div",zr,[k.value?(l(),r("div",Kr,[h[0]||(h[0]=t("strong",null,"Error:",-1)),t("pre",Gr,y(S.value),1)])):(l(),r("div",Yr,[t("div",Jr,[t("span",Qr,y(w.value)+":",1),t("span",Xr,y(b.value)+" "+y(b.value===1?"match":"matches"),1)]),t("div",Zr,[t("pre",ec,y(S.value),1)])]))])):T("",!0)]))}},Ln=ne(tc,[["__scopeId","data-v-0d272c39"]]),sc={class:"web-tool-handler"},nc={class:"tool-section"},oc={class:"web-info"},ac={class:"web-icon"},ic=["href"],lc={key:1,class:"web-query"},rc={key:0,class:"web-prompt-container"},cc={class:"prompt-content"},uc={key:1,class:"web-domains"},dc={class:"domains-label"},fc={key:0,class:"tool-section"},mc={key:0,class:"tool-result tool-result-error"},pc={class:"tool-code"},vc={key:1,class:"web-results"},hc={class:"results-header"},_c={class:"results-label"},gc={class:"results-content"},bc={class:"tool-code"},yc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="WebFetch"),o=_(()=>e.toolCall.input?.url||null),a=_(()=>e.toolCall.input?.query||null),c=_(()=>e.toolCall.input?.prompt||null),d=_(()=>e.toolCall.input?.allowed_domains||[]),f=_(()=>e.toolCall.input?.blocked_domains||[]),m=_(()=>d.value.length>0?d.value:f.value.length>0?f.value:[]),p=_(()=>d.value.length>0?"Allowed domains":f.value.length>0?"Blocked domains":"Domains"),u=_(()=>s.value?"ðŸŒ":"ðŸ”Ž"),w=_(()=>s.value?"Fetching URL":"Searching web"),v=_(()=>s.value?"Fetched content":"Search results"),k=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),S=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=_(()=>{if(!k.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,h)=>(l(),r("div",sc,[t("div",nc,[t("div",oc,[t("span",ac,y(u.value),1),t("strong",null,y(w.value)+":",1),o.value?(l(),r("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,ic)):a.value?(l(),r("code",lc,y(a.value),1)):T("",!0)]),c.value?(l(),r("div",rc,[h[0]||(h[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",cc,y(c.value),1)])):T("",!0),m.value.length>0?(l(),r("div",uc,[t("span",dc,y(p.value)+":",1),(l(!0),r(oe,null,de(m.value,i=>(l(),r("span",{key:i,class:"domain-badge"},y(i),1))),128))])):T("",!0)]),k.value?(l(),r("div",fc,[S.value?(l(),r("div",mc,[h[1]||(h[1]=t("strong",null,"Error:",-1)),t("pre",pc,y(b.value),1)])):(l(),r("div",vc,[t("div",hc,[t("span",_c,y(v.value)+":",1)]),t("div",gc,[t("pre",bc,y(b.value),1)])]))])):T("",!0)]))}},In=ne(yc,[["__scopeId","data-v-62b55b55"]]),wc={class:"task-tool-handler"},kc={class:"tool-section"},$c={class:"task-header"},Sc={key:0,class:"agent-type-badge"},xc={key:0,class:"task-description"},Cc={class:"description-content"},Ec={key:1,class:"task-prompt-container"},Tc={class:"prompt-header"},Ac={class:"prompt-length"},Dc={class:"prompt-code"},Mc={key:0,class:"tool-section"},Oc={key:0,class:"tool-result tool-result-error"},Nc={class:"tool-code"},Lc={key:1,class:"agent-output"},Ic={class:"output-header"},jc={key:0,class:"output-count-badge"},Pc={class:"output-content"},Rc={class:"tool-code"},Bc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.description||null),o=_(()=>e.toolCall.input?.prompt||null),a=_(()=>e.toolCall.input?.subagent_type||null),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!c.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),m=_(()=>f.value?f.value.split(`
`).length:0);return(p,u)=>(l(),r("div",wc,[t("div",kc,[t("div",$c,[u[0]||(u[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=t("strong",null,"Agent Task:",-1)),a.value?(l(),r("span",Sc,y(a.value),1)):T("",!0)]),s.value?(l(),r("div",xc,[u[2]||(u[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Cc,y(s.value),1)])):T("",!0),o.value?(l(),r("div",Ec,[t("div",Tc,[u[3]||(u[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Ac,y(o.value.length)+" characters",1)]),t("pre",Dc,y(o.value),1)])):T("",!0)]),c.value?(l(),r("div",Mc,[d.value?(l(),r("div",Oc,[u[4]||(u[4]=t("strong",null,"Error:",-1)),t("pre",Nc,y(f.value),1)])):(l(),r("div",Lc,[t("div",Ic,[u[5]||(u[5]=t("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(l(),r("span",jc,y(m.value)+" lines",1)):T("",!0)]),t("div",Pc,[t("pre",Rc,y(f.value),1)])]))])):T("",!0)]))}},Fc=ne(Bc,[["__scopeId","data-v-c520c244"]]),Vc={class:"task-create-tool-handler"},Wc={class:"tool-section"},Uc={class:"task-details p-2"},Hc={key:0,class:"task-field mb-2"},qc={class:"field-value subject-value"},zc={key:1,class:"task-field mb-2"},Kc={class:"field-value description-value"},Gc={key:2,class:"task-field"},Yc={class:"field-value active-form-value"},Jc={key:0,class:"tool-section mt-2"},Qc={key:0,class:"tool-result tool-result-error"},Xc={class:"tool-code"},Zc={key:1,class:"tool-result tool-result-success"},eu={class:"result-text"},tu={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.subject||null),o=_(()=>e.toolCall.input?.description||null),a=_(()=>e.toolCall.input?.activeForm||null),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!c.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,p)=>(l(),r("div",Vc,[t("div",Wc,[p[3]||(p[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Uc,[s.value?(l(),r("div",Hc,[p[0]||(p[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",qc,y(s.value),1)])):T("",!0),o.value?(l(),r("div",zc,[p[1]||(p[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Kc,y(o.value),1)])):T("",!0),a.value?(l(),r("div",Gc,[p[2]||(p[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Yc,y(a.value),1)])):T("",!0)])]),c.value?(l(),r("div",Jc,[d.value?(l(),r("div",Qc,[p[4]||(p[4]=t("strong",null,"Error:",-1)),t("pre",Xc,y(f.value),1)])):(l(),r("div",Zc,[p[5]||(p[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",eu,y(f.value),1)]))])):T("",!0)]))}},su=ne(tu,[["__scopeId","data-v-474dd444"]]),nu={class:"task-update-tool-handler"},ou={class:"tool-section"},au={class:"task-header"},iu={key:0,class:"task-id-badge"},lu={class:"task-details p-2"},ru={key:0,class:"task-field mb-2"},cu={key:1,class:"task-field mb-2"},uu={class:"field-value"},du={key:2,class:"task-field mb-2"},fu={class:"field-value description-value"},mu={key:3,class:"task-field mb-2"},pu={class:"field-value active-form-value"},vu={key:4,class:"task-field mb-2"},hu={class:"field-value"},_u={key:5,class:"task-field mb-2"},gu={class:"field-value"},bu={key:6,class:"task-field"},yu={class:"field-value"},wu={key:0,class:"tool-section mt-2"},ku={key:0,class:"tool-result tool-result-error"},$u={class:"tool-code"},Su={key:1,class:"tool-result tool-result-success"},xu={class:"result-text"},Cu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.input?.status||null),a=_(()=>e.toolCall.input?.subject||null),c=_(()=>e.toolCall.input?.description||null),d=_(()=>e.toolCall.input?.activeForm||null),f=_(()=>e.toolCall.input?.owner||null),m=_(()=>e.toolCall.input?.addBlockedBy||[]),p=_(()=>e.toolCall.input?.addBlocks||[]),u=_(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=_(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),v=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),S=_(()=>{if(!v.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,g)=>(l(),r("div",nu,[t("div",ou,[t("div",au,[g[0]||(g[0]=t("span",{class:"task-icon"},"âœï¸",-1)),g[1]||(g[1]=t("strong",null,"Update Task",-1)),s.value?(l(),r("span",iu,"#"+y(s.value),1)):T("",!0)]),t("div",lu,[o.value?(l(),r("div",ru,[g[2]||(g[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:K(["field-value status-value",w.value])},y(u.value)+" "+y(o.value),3)])):T("",!0),a.value?(l(),r("div",cu,[g[3]||(g[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",uu,y(a.value),1)])):T("",!0),c.value?(l(),r("div",du,[g[4]||(g[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",fu,y(c.value),1)])):T("",!0),d.value?(l(),r("div",mu,[g[5]||(g[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",pu,y(d.value),1)])):T("",!0),f.value?(l(),r("div",vu,[g[6]||(g[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",hu,y(f.value),1)])):T("",!0),m.value?.length?(l(),r("div",_u,[g[7]||(g[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",gu,[(l(!0),r(oe,null,de(m.value,h=>(l(),r("span",{key:h,class:"badge bg-warning text-dark me-1"},"#"+y(h),1))),128))])])):T("",!0),p.value?.length?(l(),r("div",bu,[g[8]||(g[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",yu,[(l(!0),r(oe,null,de(p.value,h=>(l(),r("span",{key:h,class:"badge bg-info text-dark me-1"},"#"+y(h),1))),128))])])):T("",!0)])]),v.value?(l(),r("div",wu,[k.value?(l(),r("div",ku,[g[9]||(g[9]=t("strong",null,"Error:",-1)),t("pre",$u,y(S.value),1)])):(l(),r("div",Su,[g[10]||(g[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",xu,y(S.value),1)]))])):T("",!0)]))}},Eu=ne(Cu,[["__scopeId","data-v-35582330"]]),Tu={class:"task-list-tool-handler"},Au={key:0,class:"tool-section"},Du={key:0,class:"tool-result tool-result-error"},Mu={class:"tool-code"},Ou={key:1,class:"task-list-result"},Nu={key:0,class:"parsed-tasks"},Lu={class:"status-icon"},Iu={class:"task-id text-muted"},ju={class:"task-subject flex-grow-1"},Pu={key:0,class:"task-owner badge bg-secondary"},Ru={key:1,class:"raw-result p-2"},Bu={class:"tool-code"},Fu={key:1,class:"tool-section"},Vu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=_(()=>{if(!s.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=_(()=>{if(!a.value)return[];const f=[],p=a.value.split(`
`);for(const u of p){const w=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const v=w[2].toLowerCase();f.push({id:w[1],status:v,subject:w[3].trim(),owner:null,statusIcon:d(v)})}}return f});function d(f){switch(f){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(f,m)=>(l(),r("div",Tu,[m[2]||(m[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(l(),r("div",Au,[o.value?(l(),r("div",Du,[m[0]||(m[0]=t("strong",null,"Error:",-1)),t("pre",Mu,y(a.value),1)])):(l(),r("div",Ou,[c.value.length>0?(l(),r("div",Nu,[(l(!0),r(oe,null,de(c.value,(p,u)=>(l(),r("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",Lu,y(p.statusIcon),1),t("span",Iu,"#"+y(p.id),1),t("span",ju,y(p.subject),1),p.owner?(l(),r("span",Pu,y(p.owner),1)):T("",!0)]))),128))])):(l(),r("div",Ru,[t("pre",Bu,y(a.value),1)]))]))])):n.toolCall.status==="completed"?(l(),r("div",Fu,[...m[1]||(m[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):T("",!0)]))}},Wu=ne(Vu,[["__scopeId","data-v-4e79ba4b"]]),Uu={class:"task-get-tool-handler"},Hu={class:"tool-section"},qu={class:"task-header"},zu={key:0,class:"task-id-badge"},Ku={key:0,class:"tool-section"},Gu={key:0,class:"tool-result tool-result-error"},Yu={class:"tool-code"},Ju={key:1,class:"task-details-result p-2"},Qu={key:0,class:"parsed-task"},Xu={class:"task-field mb-2"},Zu={class:"field-value subject-value"},ed={key:0,class:"task-field mb-2"},td={key:1,class:"task-field mb-2"},sd={class:"field-value description-value"},nd={key:2,class:"task-field mb-2"},od={class:"field-value"},ad={key:3,class:"task-field mb-2"},id={class:"field-value"},ld={key:4,class:"task-field"},rd={class:"field-value"},cd={key:1,class:"raw-result"},ud={class:"tool-code"},dd={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=_(()=>{if(!o.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),d=_(()=>{if(!c.value)return null;const p=c.value;try{const v=JSON.parse(p);if(v&&typeof v=="object")return{subject:v.subject||v.title||"",status:v.status||"",description:v.description||"",owner:v.owner||"",blockedBy:v.blockedBy||[],blocks:v.blocks||[]}}catch{}const u=p.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const v of u){const k=v.match(/^Subject:\s*(.+)$/i);k&&(w.subject=k[1].trim());const S=v.match(/^Status:\s*(.+)$/i);S&&(w.status=S[1].trim());const b=v.match(/^Description:\s*(.+)$/i);b&&(w.description=b[1].trim());const g=v.match(/^Owner:\s*(.+)$/i);g&&(w.owner=g[1].trim())}return w.subject?w:null}),f=_(()=>{if(!d.value)return"";switch(d.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=_(()=>{if(!d.value)return"";switch(d.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,u)=>(l(),r("div",Uu,[t("div",Hu,[t("div",qu,[u[0]||(u[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=t("strong",null,"Get Task",-1)),s.value?(l(),r("span",zu,"#"+y(s.value),1)):T("",!0)])]),o.value?(l(),r("div",Ku,[a.value?(l(),r("div",Gu,[u[2]||(u[2]=t("strong",null,"Error:",-1)),t("pre",Yu,y(c.value),1)])):(l(),r("div",Ju,[d.value?(l(),r("div",Qu,[t("div",Xu,[u[3]||(u[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Zu,y(d.value.subject),1)]),d.value.status?(l(),r("div",ed,[u[4]||(u[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:K(["field-value",m.value])},y(f.value)+" "+y(d.value.status),3)])):T("",!0),d.value.description?(l(),r("div",td,[u[5]||(u[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",sd,y(d.value.description),1)])):T("",!0),d.value.owner?(l(),r("div",nd,[u[6]||(u[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",od,y(d.value.owner),1)])):T("",!0),d.value.blockedBy?.length?(l(),r("div",ad,[u[7]||(u[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",id,[(l(!0),r(oe,null,de(d.value.blockedBy,w=>(l(),r("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):T("",!0),d.value.blocks?.length?(l(),r("div",ld,[u[8]||(u[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",rd,[(l(!0),r(oe,null,de(d.value.blocks,w=>(l(),r("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):T("",!0)])):(l(),r("div",cd,[t("pre",ud,y(c.value),1)]))]))])):T("",!0)]))}},fd=ne(dd,[["__scopeId","data-v-a80d14da"]]),md={class:"notebook-edit-tool-handler"},pd={class:"tool-section"},vd={class:"notebook-info"},hd={class:"file-path"},_d={class:"cell-info mt-2"},gd={class:"info-row"},bd={class:"info-row"},yd={key:0,class:"info-row"},wd={class:"badge bg-info"},kd={key:0,class:"source-preview mt-3"},$d={class:"preview-header"},Sd={class:"preview-stats"},xd={class:"source-code"},Cd={key:0,class:"tool-section"},Ed={key:0},Td={key:1,class:"text-danger"},Ad={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.notebook_path||"Unknown"),o=_(()=>e.toolCall.input?.cell_id),a=_(()=>e.toolCall.input?.cell_type||"code"),c=_(()=>e.toolCall.input?.edit_mode||"replace"),d=_(()=>e.toolCall.input?.new_source||""),f=_(()=>d.value.split(`
`).length),m=_(()=>a.value==="code"?"bg-primary":"bg-secondary"),p=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=c.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,v)=>(l(),r("div",md,[t("div",pd,[t("div",vd,[v[0]||(v[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),v[1]||(v[1]=t("strong",null,"Notebook:",-1)),t("code",hd,y(s.value),1)]),t("div",_d,[t("div",gd,[v[2]||(v[2]=t("strong",null,"Cell ID:",-1)),t("code",null,y(o.value||"N/A"),1)]),t("div",bd,[v[3]||(v[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:K(["badge",m.value])},y(a.value),3)]),c.value?(l(),r("div",yd,[v[4]||(v[4]=t("strong",null,"Edit Mode:",-1)),t("span",wd,y(c.value),1)])):T("",!0)]),d.value?(l(),r("div",kd,[t("div",$d,[v[5]||(v[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",Sd,y(f.value)+" lines",1)]),t("pre",xd,[t("code",null,y(d.value),1)])])):T("",!0)]),n.toolCall.result?(l(),r("div",Cd,[v[6]||(v[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:K(["tool-result",p.value])},[n.toolCall.result.success!==!1?(l(),r("div",Ed," âœ… "+y(u.value),1)):(l(),r("div",Td," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):T("",!0)]))}},Dd=ne(Ad,[["__scopeId","data-v-c81a9bcf"]]),Md={class:"shell-tool-handler"},Od={class:"tool-section"},Nd={class:"shell-info"},Ld={class:"shell-icon"},Id={key:0,class:"shell-id"},jd={key:0,class:"filter-info mt-2"},Pd={class:"filter-pattern"},Rd={key:0,class:"tool-section"},Bd={class:"result-header mb-2"},Fd={key:0,class:"mb-2"},Vd={class:"shell-output"},Wd={key:1,class:"mb-2"},Ud={class:"shell-output shell-output-error"},Hd={key:0},qd={key:1,class:"text-danger"},zd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=_(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=_(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),c=_(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),d=_(()=>e.toolCall.input?.filter);function f(k,S){if(!k)return null;const b=new RegExp(`<${S}>([\\s\\S]*?)<\\/${S}>`,"i"),g=k.match(b);return g?g[1].trim():null}const m=_(()=>{const k=e.toolCall.result;if(!k)return null;let S=k;if(k.content&&(S=k.content),typeof S=="string")return{status:f(S,"status"),stdout:f(S,"stdout"),stderr:f(S,"stderr"),exit_code:f(S,"exit_code")};if(Array.isArray(S)){const b=S.find(g=>g.type==="text")?.text||"";return{status:f(b,"status"),stdout:f(b,"stdout"),stderr:f(b,"stderr"),exit_code:f(b,"exit_code")}}return{status:k.status||S.status,stdout:k.stdout||k.output||S.stdout||S.output,stderr:k.stderr||S.stderr,exit_code:k.exit_code||S.exit_code}}),p=_(()=>m.value?.status),u=_(()=>{const k=p.value;return k==="running"?"bg-success":k==="completed"?"bg-secondary":k==="killed"||k==="terminated"?"bg-danger":"bg-info"}),w=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),v=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const k=m.value;if(k?.status==="running"&&!k.stdout&&!k.stderr)return"No new output since last check";if(k?.status==="failed")return`Shell failed (exit code ${k.exit_code||"unknown"})`}return"Operation completed"});return(k,S)=>(l(),r("div",Md,[t("div",Od,[t("div",Nd,[t("span",Ld,y(s.value),1),t("strong",null,y(o.value)+":",1),c.value?(l(),r("code",Id,"Shell "+y(c.value),1)):T("",!0)]),n.toolCall.name==="BashOutput"&&d.value?(l(),r("div",jd,[S[0]||(S[0]=t("strong",null,"Filter:",-1)),t("code",Pd,y(d.value),1)])):T("",!0)]),n.toolCall.result?(l(),r("div",Rd,[t("div",Bd,[t("strong",null,y(a.value)+":",1),p.value?(l(),r("span",{key:0,class:K(["badge",u.value])},y(p.value),3)):T("",!0)]),m.value?.stdout?(l(),r("div",Fd,[S[1]||(S[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Vd,[t("pre",null,[t("code",null,y(m.value.stdout),1)])])])):T("",!0),m.value?.stderr?(l(),r("div",Wd,[S[2]||(S[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Ud,[t("pre",null,[t("code",null,y(m.value.stderr),1)])])])):T("",!0),!m.value?.stdout&&!m.value?.stderr?(l(),r("div",{key:2,class:K(["tool-result",w.value])},[n.toolCall.result.success!==!1?(l(),r("div",Hd," âœ… "+y(v.value),1)):(l(),r("div",qd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):T("",!0)])):T("",!0)]))}},jn=ne(zd,[["__scopeId","data-v-86def281"]]),Kd={class:"skill-tool-handler"},Gd={key:0,class:"tool-section"},Yd={class:"d-flex align-items-center gap-2"},Jd={class:"text-muted small"},Qd={key:0,class:"skill-content-body"},Xd={class:"skill-content-text"},Zd={key:1,class:"tool-section mt-3"},ef={class:"tool-result tool-result-error"},tf={class:"tool-code"},sf={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=he(),a=L(!1);function c(){a.value=!a.value}const d=_(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const k=s.messagesBySession.get(v)||[],S=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(i=>i.tool_use_id===e.toolCall.id));if(S===-1)return{running:null,content:null};let b=null,g=null;for(let h=S+1;h<Math.min(S+3,k.length);h++){const i=k[h];if(i.type!=="user")continue;const $=i.content||"";$.includes("<command-message>")&&$.includes("skill is running")?b=i:$.startsWith("Base directory for this skill:")&&(g=i)}return{running:b,content:g}}),f=_(()=>{const v=d.value.content;if(!v)return"";const k=v.content||"",S=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return k.replace(S,"").trim()}),m=_(()=>f.value.length>0),p=_(()=>f.value?f.value.split(`
`).length:0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!u.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,k)=>(l(),r("div",Kd,[m.value?(l(),r("div",Gd,[t("div",{class:"skill-content-header",onClick:c},[t("div",Yd,[t("i",{class:K(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),k[0]||(k[0]=t("strong",null,"Skill Content",-1)),t("span",Jd,"("+y(p.value)+" lines)",1)])]),a.value?(l(),r("div",Qd,[t("pre",Xd,y(f.value),1)])):T("",!0)])):T("",!0),u.value?(l(),r("div",Zd,[k[1]||(k[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",ef,[t("pre",tf,y(w.value),1)])])):T("",!0)]))}},nf=ne(sf,[["__scopeId","data-v-0a48ca0f"]]),of={class:"slashcommand-tool-handler"},af={key:0,class:"tool-section"},lf={class:"d-flex align-items-center gap-2"},rf=["aria-label"],cf={class:"text-muted small"},uf={key:0,class:"command-content-body"},df={class:"command-content-text"},ff={key:1,class:"tool-section mt-3"},mf={class:"tool-result tool-result-error"},pf={class:"tool-code"},vf={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=he(),a=L(!1);function c(){a.value=!a.value}const d=_(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const k=s.messagesBySession.get(v)||[],S=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(i=>i.tool_use_id===e.toolCall.id));if(S===-1)return{running:null,content:null};let b=null,g=null;for(let h=S+1;h<Math.min(S+3,k.length);h++){const i=k[h];if(i.type!=="user")continue;const $=i.content||"";$.includes("<command-message>")&&$.includes("<command-name>")&&$.includes("<command-args>")?b=i:$.includes("ARGUMENTS:")&&(g=i)}return{running:b,content:g}}),f=_(()=>{const v=d.value.content;if(!v)return"";const k=v.content||"",S=/\nARGUMENTS:.*$/s;return k.replace(S,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=_(()=>f.value.length>0),p=_(()=>f.value?f.value.split(`
`).length:0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!u.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,k)=>(l(),r("div",of,[m.value?(l(),r("div",af,[t("div",{class:"command-content-header",onClick:c},[t("div",lf,[t("span",{"aria-label":a.value?"Collapse":"Expand"},y(a.value?"â–¾":"â–¸"),9,rf),k[0]||(k[0]=t("strong",null,"Command Content",-1)),t("span",cf,"("+y(p.value)+" lines)",1)])]),a.value?(l(),r("div",uf,[t("pre",df,y(f.value),1)])):T("",!0)])):T("",!0),u.value?(l(),r("div",ff,[k[1]||(k[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",mf,[t("pre",pf,y(w.value),1)])])):T("",!0)]))}},hf=ne(vf,[["__scopeId","data-v-15991acf"]]),_f={class:"exit-plan-mode-tool-handler"},gf={class:"tool-section"},bf={key:0,class:"plan-content mt-2"},yf={class:"plan-text"},wf={key:0,class:"tool-section"},kf={key:0},$f={key:1,class:"text-danger"},Sf={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.plan),o=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,c)=>(l(),r("div",_f,[t("div",gf,[c[1]||(c[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(l(),r("div",bf,[c[0]||(c[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",yf,y(s.value),1)])):T("",!0)]),n.toolCall.result?(l(),r("div",wf,[c[2]||(c[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:K(["tool-result",o.value])},[n.toolCall.result.success!==!1?(l(),r("div",kf," âœ… Permission mode reverted to default ")):(l(),r("div",$f," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):T("",!0)]))}},xf=ne(Sf,[["__scopeId","data-v-e2e3c781"]]),Cf={class:"ask-user-question-handler"},Ef={key:0,class:"answers-summary"},Tf={class:"answer-question text-muted small"},Af={class:"answer-value fw-medium"},Df={key:1,class:"text-muted small"},Mf={key:0,class:"questions-container"},Of={class:"question-header d-flex align-items-center gap-2 mb-2"},Nf={key:0,class:"badge bg-secondary"},Lf={class:"question-text fw-medium"},If={class:"options-list"},jf=["id","checked","disabled","onChange"],Pf=["id","name","checked","disabled","onChange"],Rf=["for"],Bf={class:"option-label"},Ff={key:0,class:"option-description text-muted d-block small"},Vf={class:"option-item form-check other-option"},Wf=["id","checked","disabled","onChange"],Uf=["id","name","checked","disabled","onChange"],Hf=["for"],qf={key:2,class:"other-input mt-2"},zf=["onUpdate:modelValue","disabled","onInput"],Kf={key:1,class:"alert alert-info mb-0"},Gf={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=_(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),d=_(()=>{if(!c.value)return{};const x=o.toolCall.result;if(x?.content){if(typeof x.content=="object"&&x.content.answers)return x.content.answers;if(typeof x.content=="string")try{const M=JSON.parse(x.content);if(M.answers)return M.answers}catch{}}const N=o.toolCall.input||{};return N.answers?N.answers:{}}),f=_(()=>Object.keys(d.value).length>0),m=_(()=>(o.toolCall.input||{}).questions||[]),p=L({}),u=L({});ve(m,x=>{x.forEach((N,M)=>{M in p.value||(p.value[M]=N.multiSelect?[]:null),M in u.value||(u.value[M]="")})},{immediate:!0});function w(x,N){const M=p.value[x];return Array.isArray(M)?M.includes(N):M===N}function v(x){const N=p.value[x];return Array.isArray(N)?N.includes("__OTHER__"):N==="__OTHER__"}function k(x,N){p.value[x]=N,i()}function S(x){p.value[x]="__OTHER__",i()}function b(x,N){const M=p.value[x];if(!Array.isArray(M))p.value[x]=[N];else{const A=M.indexOf(N);A===-1?M.push(N):M.splice(A,1)}i()}function g(x){const N=p.value[x];if(!Array.isArray(N))p.value[x]=["__OTHER__"];else{const M=N.indexOf("__OTHER__");M===-1?N.push("__OTHER__"):N.splice(M,1)}i()}function h(x){i()}function i(){const x={};m.value.forEach((N,M)=>{const A=p.value[M],E=N.question;if(N.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(O=>O==="__OTHER__"?u.value[M]||"":O).filter(O=>O);x[E]=C.join(", ")}}else A==="__OTHER__"?x[E]=u.value[M]||"":A&&(x[E]=A)}),a("answer",x)}const $=_(()=>m.value.every((x,N)=>{const M=p.value[N];if(x.multiSelect){if(!Array.isArray(M)||M.length===0||M.includes("__OTHER__")&&!u.value[N])return!1}else if(!M||M==="__OTHER__"&&!u.value[N])return!1;return!0}));return e({allQuestionsAnswered:$,getAnswers:()=>{const x={};return m.value.forEach((N,M)=>{const A=p.value[M],E=N.question;if(N.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(O=>O==="__OTHER__"?u.value[M]||"":O).filter(O=>O);x[E]=C.join(", ")}}else A==="__OTHER__"?x[E]=u.value[M]||"":A&&(x[E]=A)}),x}}),(x,N)=>(l(),r("div",Cf,[c.value?(l(),r(oe,{key:0},[f.value?(l(),r("div",Ef,[(l(!0),r(oe,null,de(d.value,(M,A)=>(l(),r("div",{key:A,class:"answer-item mb-2"},[t("div",Tf,y(A),1),t("div",Af,y(M),1)]))),128))])):(l(),r("div",Df," No answers recorded. "))],64)):(l(),r(oe,{key:1},[m.value.length>0?(l(),r("div",Mf,[(l(!0),r(oe,null,de(m.value,(M,A)=>(l(),r("div",{key:A,class:"question-block mb-3"},[t("div",Of,[M.header?(l(),r("span",Nf,y(M.header),1)):T("",!0),t("span",Lf,y(M.question),1)]),t("div",If,[(l(!0),r(oe,null,de(M.options,(E,C)=>(l(),r("div",{key:C,class:K(["option-item form-check",{selected:w(A,E.label)}])},[M.multiSelect?(l(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-opt${C}`,checked:w(A,E.label),disabled:n.disabled,onChange:O=>b(A,E.label)},null,40,jf)):(l(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-opt${C}`,name:`question-${A}`,checked:w(A,E.label),disabled:n.disabled,onChange:O=>k(A,E.label)},null,40,Pf)),t("label",{class:"form-check-label",for:`q${A}-opt${C}`},[t("span",Bf,y(E.label),1),E.description?(l(),r("span",Ff,y(E.description),1)):T("",!0)],8,Rf)],2))),128)),t("div",Vf,[M.multiSelect?(l(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-other`,checked:v(A),disabled:n.disabled,onChange:E=>g(A)},null,40,Wf)):(l(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-other`,name:`question-${A}`,checked:v(A),disabled:n.disabled,onChange:E=>S(A)},null,40,Uf)),t("label",{class:"form-check-label",for:`q${A}-other`},[...N[0]||(N[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Hf),v(A)?(l(),r("div",qf,[Se(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":E=>u.value[A]=E,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:E=>h()},null,40,zf),[[We,u.value[A]]])])):T("",!0)])])]))),128))])):(l(),r("div",Kf," No questions to display. "))],64))]))}},Pn=ne(Gf,[["__scopeId","data-v-ebcee33f"]]),Yf={class:"timeline-detail"},Jf={key:0,class:"detail-banner detail-banner-warning"},Qf={key:2,class:"permission-section"},Xf={class:"permission-buttons"},Zf=["disabled"],em=["disabled"],tm={class:"detail-banner detail-banner-warning"},sm={key:0,class:"suggestions-section"},nm=["id","onUpdate:modelValue","disabled"],om=["for"],am={class:"permission-buttons"},im=["disabled"],lm=["disabled"],rm=["disabled"],cm={class:"guidance-section"},um=["disabled"],dm=["disabled"],fm={key:3,class:"detail-banner detail-banner-warning"},mm={key:4,class:"detail-banner detail-banner-error"},pm={key:0},vm={key:5,class:"detail-section"},hm={key:0,class:"detail-pre"},_m={key:6,class:"detail-section"},gm={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=he(),a=rt(),c=L(!1),d=L(!1),f=L(!1),m=L(null),p=L(""),u=L(!1),w=L(null),v=L({}),k=L(null),S=L({});ve(()=>e.toolCall.suggestions,D=>{if(D&&D.length>0){const P={};D.forEach((G,X)=>{P[X]=!0}),v.value=P}},{immediate:!0});const b=_(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((D,P)=>v.value[P]):[]),g={Read:yl,Write:Pl,Bash:Jl,TodoWrite:mr,Edit:Ir,Grep:Ln,Glob:Ln,WebFetch:In,WebSearch:In,Task:Fc,TaskCreate:su,TaskUpdate:Eu,TaskList:Wu,TaskGet:fd,NotebookEdit:Dd,BashOutput:jn,KillShell:jn,SlashCommand:hf,Skill:nf,ExitPlanMode:xf,AskUserQuestion:Pn},h=_(()=>g[e.toolCall.name]||Xi),i=_(()=>{if(e.toolCall.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[e.toolCall.backendStatus]||e.toolCall.backendStatus;const D=s.getBackendToolState(o.currentSessionId,e.toolCall.id);return D?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[D.state]||D.state:e.toolCall.status}),$=_(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),x=_(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),N=_(()=>i.value==="permission_required"),M=_(()=>e.toolCall.name==="AskUserQuestion"),A=_(()=>!M.value||!k.value?!1:k.value.allQuestionsAnswered),E=_(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0),C=_(()=>e.toolCall.input&&Object.keys(e.toolCall.input).length>0),O=_(()=>e.toolCall.result!=null),z=_(()=>{try{return JSON.stringify(e.toolCall.input,null,2)}catch{return String(e.toolCall.input)}}),R=_(()=>{const D=e.toolCall.result;if(!D)return"";if(typeof D=="string")return D;if(D.content)return typeof D.content=="string"?D.content:JSON.stringify(D.content,null,2);try{return JSON.stringify(D,null,2)}catch{return String(D)}});function F(D){S.value=D}async function W(){if(!(f.value||!k.value)){f.value=!0,m.value="submit-answers";try{const D=o.currentSessionId,P=k.value.getAnswers(),G={questions:e.toolCall.input?.questions||[],answers:P};D&&(s.updateToolCall(D,e.toolCall.id,{input:G}),s.handlePermissionResponse(D,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await a.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",G)}catch(D){console.error("Failed to submit question answers:",D)}finally{f.value=!1,m.value=null}}}async function J(D,P,G=null){if(f.value)return;f.value=!0;const X=b.value,se=P&&X.length>0;D==="allow"?m.value=se?"approve-apply":"approve":G?m.value="deny-guidance":m.value="deny";try{const Z=o.currentSessionId;if(Z){const ce=se?X:[];s.handlePermissionResponse(Z,{request_id:e.toolCall.permissionRequestId,decision:D,reasoning:D==="allow"?"User allowed permission":"User denied permission",applied_updates:ce})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,D,se,G,se?X:null)}catch(Z){console.error("Failed to send permission response:",Z)}finally{f.value=!1,m.value=null}}function ie(D){return D.type==="setMode"?`Set mode: ${D.mode}`:D.type==="addRules"&&D.rules?.length?`Allow: ${D.rules.map(G=>G.ruleContent?`${G.toolName}(${G.ruleContent})`:G.toolName).join(", ")}`:D.type==="addDirectories"&&D.directories?.length?`Add directories: ${D.directories.join(", ")}`:JSON.stringify(D)}function re(){u.value=!0,dt(()=>{w.value?.focus()})}function B(){const D=w.value;if(!D)return;D.style.height="auto";const P=parseFloat(getComputedStyle(D).lineHeight)*6+10;D.style.height=Math.min(D.scrollHeight,P)+"px"}return(D,P)=>(l(),r("div",Yf,[$.value?(l(),r("div",Jf,[P[9]||(P[9]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[P[8]||(P[8]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,y(x.value?.message||"Session was terminated"),1)])])):T("",!0),M.value&&i.value==="permission_required"?T("",!0):(l(),Te(xo(h.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),i.value==="permission_required"&&!$.value?(l(),r("div",Qf,[M.value?(l(),r(oe,{key:0},[P[10]||(P[10]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),be(Pn,{ref_key:"questionHandlerRef",ref:k,toolCall:n.toolCall,disabled:f.value,onAnswer:F},null,8,["toolCall","disabled"]),t("div",Xf,[t("button",{class:"btn-timeline btn-primary",onClick:W,disabled:f.value||!A.value},y(f.value?"Submitting...":"Submit Answers"),9,Zf),t("button",{class:"btn-timeline btn-secondary",onClick:P[0]||(P[0]=G=>J("deny",!1)),disabled:f.value}," Skip ",8,em)])],64)):(l(),r(oe,{key:1},[t("div",tm,[P[12]||(P[12]=t("strong",null,"Permission Required",-1)),t("p",null,[P[11]||(P[11]=fe("Claude wants to use ",-1)),t("code",null,y(n.toolCall.name),1)])]),E.value?(l(),r("div",sm,[P[13]||(P[13]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(l(!0),r(oe,null,de(n.toolCall.suggestions,(G,X)=>(l(),r("div",{key:X,class:"suggestion-item"},[Se(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${X}`,"onUpdate:modelValue":se=>v.value[X]=se,disabled:f.value},null,8,nm),[[Co,v.value[X]]]),t("label",{for:`sg-${n.toolCall.id}-${X}`},[t("code",null,y(ie(G)),1)],8,om)]))),128))])):T("",!0),t("div",am,[E.value?(l(),r("button",{key:0,class:"btn-timeline btn-approve",onClick:P[1]||(P[1]=G=>J("allow",!0)),disabled:f.value},y(f.value&&m.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,im)):T("",!0),t("button",{class:K(["btn-timeline",E.value?"btn-approve-outline":"btn-approve"]),onClick:P[2]||(P[2]=G=>J("allow",!1)),disabled:f.value},y(E.value?"Approve Only":"Approve"),11,lm),t("button",{class:"btn-timeline btn-deny",onClick:P[3]||(P[3]=G=>J("deny",!1)),disabled:f.value}," Deny ",8,rm)]),t("div",cm,[u.value?T("",!0):(l(),r("a",{key:0,href:"#",class:"guidance-link",onClick:ye(re,["prevent"])}," Add guidance... ")),u.value?(l(),r(oe,{key:1},[Se(t("textarea",{ref_key:"guidanceTextarea",ref:w,"onUpdate:modelValue":P[4]||(P[4]=G=>p.value=G),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:f.value,onInput:B},null,40,um),[[We,p.value]]),p.value.trim()?(l(),r("button",{key:0,class:"btn-timeline btn-guidance",onClick:P[5]||(P[5]=G=>J("deny",!1,p.value)),disabled:f.value}," Provide Guidance & Continue ",8,dm)):T("",!0)],64)):T("",!0)])],64))])):T("",!0),i.value==="permission_required"&&$.value?(l(),r("div",fm,[P[14]||(P[14]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,y(x.value?.message||"Session was terminated before permission could be granted"),1)])):T("",!0),n.toolCall.permissionDecision==="deny"?(l(),r("div",mm,[P[15]||(P[15]=fe(" Permission denied ",-1)),n.toolCall.result?.message?(l(),r("span",pm," - "+y(n.toolCall.result.message),1)):T("",!0)])):T("",!0),C.value&&!N.value?(l(),r("div",vm,[t("div",{class:"section-header",onClick:P[6]||(P[6]=G=>c.value=!c.value)},[t("span",null,y(c.value?"â–¾":"â–¸")+" Parameters",1)]),c.value?(l(),r("pre",hm,y(z.value),1)):T("",!0)])):T("",!0),O.value&&!N.value?(l(),r("div",_m,[t("div",{class:"section-header",onClick:P[7]||(P[7]=G=>d.value=!d.value)},[t("span",null,y(d.value?"â–¾":"â–¸")+" Result",1)]),d.value?(l(),r("pre",{key:0,class:K(["detail-pre",{"result-error":n.toolCall.result?.error}])},y(R.value),3)):T("",!0)])):T("",!0)]))}},bm=ne(gm,[["__scopeId","data-v-1ed79806"]]),ym={class:"timeline-row"},wm={class:"timeline-summary"},km={class:"summary-count"},$m={key:0,class:"summary-running"},Sm={key:1,class:"summary-permission"},xm={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=je(),o=he(),a=xe(),c=L(null),d=L({});function f(b,g){g&&(d.value[b]=g)}const m=_(()=>[...e.tools].map((b,g)=>({tool:b,originalIndex:g})).sort((b,g)=>{if(b.tool.timestamp&&g.tool.timestamp){const h=new Date(b.tool.timestamp).getTime(),i=new Date(g.tool.timestamp).getTime();if(h!==i)return h-i}return b.originalIndex-g.originalIndex}).map(({tool:b})=>b)),p=_(()=>c.value?m.value.find(b=>b.id===c.value):null);ve(m,b=>{const g=b.find(h=>v(h)==="permission_required");if(g)c.value=g.id;else if(c.value){const h=b.find(i=>i.id===c.value);h&&v(h)!=="permission_required"&&(c.value=null)}},{deep:!0});const u=_(()=>m.value.filter(b=>v(b)==="executing").length),w=_(()=>m.value.filter(b=>v(b)==="permission_required").length);function v(b){const g=o.currentSessionId;return g?b.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[b.backendStatus]||b.backendStatus:s.isToolUseOrphaned(g,b.id)?"orphaned":b.status:b.status}function k(b){const g=v(b),h=b.result?.error||b.status==="error"||b.permissionDecision==="deny";switch(g){case"completed":return h?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function S(b){c.value===b?c.value=null:c.value=b}return(b,g)=>m.value.length>0?(l(),r("div",{key:0,class:K(["activity-timeline",{"timeline-mobile":ae(a).isMobile}])},[t("div",ym,[(l(!0),r(oe,null,de(m.value,(h,i)=>(l(),r(oe,{key:h.id},[i>0?(l(),Te(Fi,{key:0,leftColor:k(m.value[i-1]),rightColor:k(h),compact:ae(a).isMobile},null,8,["leftColor","rightColor","compact"])):T("",!0),be(Ri,{ref_for:!0,ref:$=>f(h.id,$),tool:h,isExpanded:c.value===h.id,compact:ae(a).isMobile,onClick:$=>S(h.id)},null,8,["tool","isExpanded","compact","onClick"])],64))),128))]),t("div",wm,[t("span",km,y(m.value.length)+" tool"+y(m.value.length!==1?"s":""),1),u.value>0?(l(),r("span",$m,y(u.value)+" running",1)):T("",!0),w.value>0?(l(),r("span",Sm,y(w.value)+" needs permission",1)):T("",!0)]),c.value&&p.value?(l(),Te(bm,{key:0,toolCall:p.value},null,8,["toolCall"])):T("",!0)],2)):T("",!0)}},Cm=ne(xm,[["__scopeId","data-v-5bf765ba"]]),Em={class:"msg-wrapper msg-assistant"},Tm={class:"msg-meta"},Am={class:"msg-time"},Dm={class:"msg-bubble msg-bubble-assistant"},Mm={key:0,class:"thinking-block mb-2"},Om=["innerHTML"],Nm={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=je(),o=he();Ye.setOptions({breaks:!0,gfm:!0});const a=_(()=>ss(e.message.timestamp)),c=_(()=>{const v=e.message.content||"";return v.trim().length>0&&v!=="Assistant response"}),d=_(()=>{const v=e.message.content||"";let k=Ye.parse(v);return k=k.replace(/\n</g,"<"),k=k.replace(/\n+$/,""),Wt.sanitize(k)}),f=_(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),m=_(()=>e.message.metadata?.thinking_content||""),p=_(()=>{const v=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,k=e.attachedTools&&e.attachedTools.length>0;return v||k}),u=_(()=>{const v=e.message.metadata?.tool_uses||[],k=e.attachedTools||[],S=[...v],b=new Set(v.map(g=>g.id));for(const g of k)b.has(g.id)||S.push(g);return S}),w=_(()=>{const v=o.currentSessionId;if(!v)return[];const k=s.toolCallsBySession.get(v)||[];return u.value.map(S=>{const b=k.find(g=>g.id===S.id);return b||{id:S.id,name:S.name,input:S.input,status:"pending",result:null,timestamp:S.timestamp||e.message.timestamp,isExpanded:!0}})});return(v,k)=>(l(),r("div",Em,[t("div",Tm,[k[0]||(k[0]=t("span",{class:"msg-role"},"assistant",-1)),t("span",Am,y(a.value),1)]),t("div",Dm,[f.value?(l(),r("div",Mm,[be(Ni,{thinking:m.value},null,8,["thinking"])])):T("",!0),c.value?(l(),r("div",{key:1,class:"msg-text",innerHTML:d.value},null,8,Om)):T("",!0),p.value?(l(),Te(Cm,{key:2,tools:w.value,messageId:n.message.id},null,8,["tools","messageId"])):T("",!0)])]))}},Lm=ne(Nm,[["__scopeId","data-v-2f57d076"]]),Im={class:"msg-wrapper msg-system"},jm={key:0,class:"pill-icon"},Pm={class:"pill-text"},Rm={class:"pill-time"},Bm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>ss(e.message.timestamp)),o=_(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting"),a=_(()=>{if(o.value)return"Context compaction in progress...";const c=e.message.content||"";return c.length>80?c.substring(0,77)+"...":c});return(c,d)=>(l(),r("div",Im,[t("div",{class:K(["msg-pill",{"pill-compaction":o.value}])},[o.value?(l(),r("span",jm,"ðŸ—œï¸")):T("",!0),t("span",Pm,y(a.value),1),d[0]||(d[0]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Rm,y(s.value),1)],2)]))}},Rn=ne(Bm,[["__scopeId","data-v-950fba0a"]]),Fm={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=_(()=>{switch(e.message.type){case"user":return Ci;case"assistant":return Lm;case"system":return Rn;default:return Rn}});return(o,a)=>(l(),Te(xo(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Vm=ne(Fm,[["__scopeId","data-v-11dff525"]]),Wm={class:"msg-wrapper msg-system"},Um={class:"pill-badge"},Hm={class:"pill-time"},qm={key:0,class:"compaction-detail"},zm={class:"detail-section"},Km={class:"detail-value"},Gm={class:"detail-section"},Ym={class:"detail-value"},Jm={key:0,class:"detail-section"},Qm={class:"detail-value"},Xm={class:"continuation-section"},Zm={class:"continuation-text"},ep={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=L(!1);function o(){s.value=!s.value}const a=_(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),c=_(()=>a.value?e.messages[3]:e.messages[2]),d=_(()=>c.value?.metadata?.init_data?.compact_metadata||{}),f=_(()=>d.value.pre_tokens||0),m=_(()=>a.value?e.messages[4]:e.messages[3]),p=_(()=>m.value?.content||""),u=_(()=>{const v=e.messages[0]?.timestamp;return v?ss(v):""});function w(v){return v?`${v.toLocaleString()} tokens`:"0 tokens"}return(v,k)=>(l(),r("div",Wm,[t("div",{class:"msg-pill pill-compaction",onClick:o,style:{cursor:"pointer"}},[k[0]||(k[0]=t("span",{class:"pill-icon"},"ðŸ—œï¸",-1)),k[1]||(k[1]=t("span",{class:"pill-text"},"Context Compaction Event",-1)),t("span",Um,y(w(f.value)),1),k[2]||(k[2]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Hm,y(u.value),1),t("span",{class:K(["pill-chevron",{expanded:s.value}])},"â–¶",2)]),s.value?(l(),r("div",qm,[t("div",zm,[k[3]||(k[3]=t("div",{class:"detail-label"},"Trigger",-1)),t("div",Km,y(d.value.trigger||"auto"),1)]),t("div",Gm,[k[4]||(k[4]=t("div",{class:"detail-label"},"Pre-compaction",-1)),t("div",Ym,y(w(f.value)),1)]),d.value.post_tokens?(l(),r("div",Jm,[k[5]||(k[5]=t("div",{class:"detail-label"},"Post-compaction",-1)),t("div",Qm,y(w(d.value.post_tokens)),1)])):T("",!0),t("div",Xm,[k[6]||(k[6]=t("div",{class:"detail-label"},"Continuation Message",-1)),t("pre",Zm,y(p.value),1)])])):T("",!0)]))}},tp=ne(ep,[["__scopeId","data-v-6b5b6a98"]]),sp={key:0,class:"text-muted text-center py-5"},np={__name:"MessageList",setup(n){const e=je(),s=xe(),o=L(null),a=_(()=>{const u=e.currentMessages,w=[];let v=0;for(;v<u.length;){const k=u[v];if(d(k,u,v)){const S=u[v+2],g=S?.type==="system"&&S?.metadata?.subtype==="init"?5:4,h=u.slice(v,v+g);w.push({type:"compaction",messages:h}),v+=g;continue}m(k)&&w.push({type:"message",message:k,attachedTools:[]}),v++}return c(w)});function c(u){const w=new Map,v=new Set;for(let S=0;S<u.length;S++){const b=u[S];if(b.type==="compaction")continue;const g=b.message,h=g.content&&g.content.trim().length>0&&g.content!=="Assistant response",i=g.type==="assistant"&&g.metadata?.has_tool_uses&&g.metadata?.tool_uses?.length>0;if(g.type==="assistant"&&i&&!h){let $=-1,x=!1;for(let N=S-1;N>=0;N--){const M=u[N];if(!v.has(N)){if(M.type==="message"&&M.message.type!=="assistant"){x=!0;break}if(M.type==="message"&&M.message.type==="assistant"){const A=M.message;if(A.content&&A.content.trim().length>0&&A.content!=="Assistant response"){$=N;break}else{$=N;break}}}}x&&$===-1||(x&&$>=0?(w.has($)||w.set($,[]),w.get($).push(...g.metadata.tool_uses),v.add(S)):!x&&$>=0&&(w.has($)||w.set($,[]),w.get($).push(...g.metadata.tool_uses),v.add(S)))}}const k=[];for(let S=0;S<u.length;S++){if(v.has(S))continue;const b=u[S];w.has(S)&&(b.attachedTools=[...b.attachedTools||[],...w.get(S)]),k.push(b)}return k}function d(u,w,v){if(v+3>=w.length)return!1;const k=w[v],S=w[v+1];let b=w[v+2],g=w[v+3],h=w[v+4];const i=k.type==="system"&&k.metadata?.subtype==="status"&&k.metadata?.init_data?.status==="compacting",$=S.type==="system"&&S.metadata?.subtype==="status"&&(S.metadata?.init_data?.status===null||S.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(v+4>=w.length)return!1;const N=!0,M=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",A=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",v),console.log("  Msg1 (compacting):",i),console.log("  Msg2 (null status):",$),console.log("  Msg3 (init):",N),console.log("  Msg4 (boundary):",M),console.log("  Msg5 (continuation):",A)),i&&$&&N&&M&&A}else{const N=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",M=g?.type==="user"&&g?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",v),console.log("  Msg1 (compacting):",i),console.log("  Msg2 (null status):",$),console.log("  Msg3 (boundary):",N),console.log("  Msg4 (continuation):",M)),i&&$&&N&&M}}async function f(){s.autoScrollEnabled&&(await dt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ve(()=>a.value.length,f),ve(()=>e.currentToolCalls.length,f),ve(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),f),Me(()=>{setTimeout(()=>{f()},100)});function m(u){const w=u.subtype||u.metadata?.subtype;if(u.type==="system"&&w==="init"||u.type==="system"&&w==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const v=u.content||"";if(v.match(/^Tool results?: \d+ results?$/i)||v.trim()==="")return!1}if(u.type==="user"){const v=u.content||"";if(v.includes("<command-message>")&&v.includes("skill is running")||v.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const v=u.content||"";if(v.includes("<command-message>")&&v.includes("<command-name>")&&v.includes("<command-args>")||v.includes("ARGUMENTS:")&&(v.includes("<command-name>")||v.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const v=u.metadata||{};if(v.parent_tool_use_id&&!v.has_tool_results)return!1}return!0}function p(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,w)=>(l(),r("div",{class:K(["messages-area flex-grow-1 overflow-auto",{"theme-red":ae(s).isRedBackground}]),ref_key:"messagesArea",ref:o},[a.value.length===0?(l(),r("div",sp," No messages yet. Start a conversation! ")):T("",!0),(l(!0),r(oe,null,de(a.value,(v,k)=>(l(),r(oe,{key:`item-${k}`},[v.type==="message"?(l(),Te(Vm,{key:0,message:p(v.message),attachedTools:v.attachedTools||[]},null,8,["message","attachedTools"])):v.type==="compaction"?(l(),Te(tp,{key:1,messages:v.messages},null,8,["messages"])):T("",!0)],64))),128))],2))}},op=ne(np,[["__scopeId","data-v-7aa43476"]]),ap={key:0,class:"attachment-list"},ip={key:0,class:"attachment-preview"},lp=["src","alt"],rp={key:1,class:"attachment-icon"},cp={class:"file-type-icon"},up={class:"attachment-info"},dp=["title"],fp={class:"attachment-size"},mp=["onClick"],pp={key:2,class:"upload-progress"},vp=["title"],hp={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const p=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(p)}function a(m){const p=m.name?.split(".").pop()?.toLowerCase()||"",u=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(p)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(p)?"âš™ï¸":["log","txt"].includes(p)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(p)?"ðŸ“":"ðŸ“"}function c(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function d(m,p=20){if(!m||m.length<=p)return m;const u=m.split(".").pop(),w=m.substring(0,m.length-u.length-1);return w.length<=p-u.length-4?m:w.substring(0,p-u.length-4)+"..."+u}function f(m){s("remove",m)}return(m,p)=>n.attachments.length>0?(l(),r("div",ap,[(l(!0),r(oe,null,de(n.attachments,(u,w)=>(l(),r("div",{key:u.id||w,class:"attachment-item"},[o(u)?(l(),r("div",ip,[t("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,lp)])):(l(),r("div",rp,[t("span",cp,y(a(u)),1)])),t("div",up,[t("span",{class:"attachment-name",title:u.name},y(d(u.name)),9,dp),t("span",fp,y(c(u.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:v=>f(w)}," âœ• ",8,mp),u.uploading?(l(),r("div",pp,[t("div",{class:"progress-bar",style:Pe({width:(u.progress||0)+"%"})},null,4)])):T("",!0),u.error?(l(),r("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+y(u.error),9,vp)):T("",!0)]))),128))])):T("",!0)}},_p=ne(hp,[["__scopeId","data-v-0fcc4974"]]),gp=["id","aria-selected","onMousedown","onMouseenter"],bp={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=L(null);return ve(()=>e.selectedIndex,o=>{if(!s.value)return;const a=s.value.children[o];a&&a.scrollIntoView({block:"nearest"})}),(o,a)=>n.commands.length>0?(l(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(l(!0),r(oe,null,de(n.commands,(c,d)=>(l(),r("li",{id:`slash-cmd-${d}`,key:c,role:"option",class:K(["slash-command-item",{active:d===n.selectedIndex}]),"aria-selected":d===n.selectedIndex,onMousedown:ye(f=>o.$emit("select",c),["prevent"]),onMouseenter:f=>o.$emit("highlight",d)}," /"+y(c),43,gp))),128))],512)):T("",!0)}},yp=ne(bp,[["__scopeId","data-v-97c65547"]]),wp={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},kp=["disabled"],$p=["placeholder","disabled","aria-expanded","aria-activedescendant"],Sp=["disabled"],xp=["disabled"],Bn=5*1024*1024,Cp={__name:"InputArea",setup(n){const e=he(),s=rt(),o=Ze(),a=xe(),c=Eo("pendingResourceAttachment",L(null)),d=L(null),f=L(null),m=L(window.innerWidth),p=L([]),u=L(!1),w=L(!1),v=L(!1),k=L(""),S=L(0),b=_({get:()=>e.currentInput,set:H=>{e.currentInput=H}}),g=_(()=>e.currentSession?.is_processing||!1),h=_(()=>s.sessionConnected),i=_(()=>e.currentSession?.state==="starting"),$=_(()=>e.currentSessionId),x=_(()=>!!b.value.trim()||p.value.filter(H=>!H.error).length>0),N=_(()=>m.value<768),M=_(()=>i.value?"Session is starting...":h.value?"Type your message to Claude Code...":"Waiting for connection..."),A=_(()=>{const H=$.value;return H?e.initData.get(H)?.slash_commands||[]:[]}),E=_(()=>{const H=k.value.toLowerCase();return A.value.filter(I=>I.toLowerCase().includes(H)).sort((I,V)=>I.localeCompare(V))});function C(){m.value=window.innerWidth}Me(()=>{window.addEventListener("resize",C)}),De(()=>{window.removeEventListener("resize",C)}),ve(c,H=>{H&&(Z(H),c.value=null)});function O(H){if(v.value&&E.value.length>0){const I=E.value.length;if(H.key==="ArrowDown"){H.preventDefault(),S.value=(S.value+1)%I;return}if(H.key==="ArrowUp"){H.preventDefault(),S.value=(S.value-1+I)%I;return}if(H.key==="Enter"){H.preventDefault(),R(E.value[S.value]);return}if(H.key==="Tab"){H.preventDefault(),R(E.value[S.value]);return}}if(H.key==="Escape"&&v.value){H.preventDefault(),v.value=!1;return}if(H.key==="Enter"&&!H.shiftKey){if(N.value)return;H.preventDefault(),X()}}function z(){const H=d.value;if(!H)return;H.style.height="auto";const I=Math.min(H.scrollHeight,parseInt(getComputedStyle(H).maxHeight));H.style.height=I+"px"}ve(b,H=>{H.startsWith("/")&&A.value.length>0?(k.value=H.slice(1),S.value=0,v.value=E.value.length>0):v.value=!1});function R(H){b.value=`/${H} `,v.value=!1,d.value?.focus(),z()}function F(){f.value?.click()}function W(H){const I=Array.from(H.target.files||[]);re(I),H.target.value=""}function J(H){u.value=!1;const I=Array.from(H.dataTransfer?.files||[]);re(I)}function ie(H){const I=H.clipboardData?.items;if(!I)return;const V=[];for(const q of I)if(q.type.startsWith("image/")){const U=q.getAsFile();if(U){const ee=q.type.split("/")[1]||"png",$e=`clipboard-${Date.now()}.${ee}`,Ve=new File([U],$e,{type:U.type});V.push(Ve)}}V.length>0&&(H.preventDefault(),re(V))}function re(H){for(const I of H){if(I.size>Bn){p.value.push({id:D(),name:I.name,size:I.size,type:I.type,file:I,error:`File too large (max ${Bn/(1024*1024)}MB)`});continue}let V=null;I.type.startsWith("image/")&&(V=URL.createObjectURL(I)),p.value.push({id:D(),name:I.name,size:I.size,type:I.type,file:I,preview:V,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function B(H){const I=p.value[H];I.preview&&URL.revokeObjectURL(I.preview),p.value.splice(H,1)}function D(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function P(H){const I=$.value;if(!I)return null;H.uploading=!0,H.progress=0,H.error=null;try{const V=new FormData;V.append("file",H.file);const q=await fetch(`/api/sessions/${I}/files`,{method:"POST",body:V});if(!q.ok){const ee=await q.json().catch(()=>({}));throw new Error(ee.detail||`Upload failed: ${q.status}`)}const U=await q.json();return H.uploaded=!0,H.uploadedInfo=U.file,H.progress=100,U.file}catch(V){return H.error=V.message,null}finally{H.uploading=!1}}async function G(){const H=p.value.filter(I=>!I.uploaded&&!I.error);if(H.length===0)return!0;w.value=!0;try{return(await Promise.all(H.map(P))).every(V=>V!==null)}finally{w.value=!1}}async function X(){const H=b.value.trim(),I=p.value.filter(U=>!U.error).length>0;if(!H&&!I||I&&!await G())return;let V=b.value;const q=p.value.filter(U=>U.uploaded&&U.uploadedInfo).map(U=>U.uploadedInfo);if(q.length>0){const U=q.map(ee=>{const $e=(ee.size_bytes/1024).toFixed(1);return`- ${ee.original_name} (${$e} KB): ${ee.stored_path}`}).join(`
`);V.trim()?V=`${V}

---
Attached files (use Read tool to access):
${U}`:V=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${U}`}s.sendMessage(V),b.value="",se(),d.value&&(d.value.style.height="auto")}function se(){for(const H of p.value)H.preview&&URL.revokeObjectURL(H.preview);p.value=[]}function Z(H){if(!H||!H.resource_id){console.warn("Invalid resource for attachment:",H);return}const I=$.value;if(!I){console.warn("No current session for resource attachment");return}if(p.value.findIndex(ee=>ee.resourceId===H.resource_id)>=0){console.log("Resource already attached:",H.resource_id);return}const q=o.isImageResource(H);let U=null;q&&(U=o.getResourceUrl(I,H.resource_id)),p.value.push({id:D(),resourceId:H.resource_id,name:H.original_filename||H.title||"Resource",size:H.size_bytes||0,type:H.format||"application/octet-stream",file:null,preview:U,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:H.resource_id,original_name:H.original_filename||H.title,stored_path:H.file_path||`/api/sessions/${I}/resources/${H.resource_id}`,size_bytes:H.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",H.resource_id)}function ce(){s.interruptSession()}return(H,I)=>(l(),r("div",{class:K(["border-top",ae(a).isRedBackground?"theme-red-panel":"bg-light"])},[h.value?T("",!0):(l(),r("div",wp,[...I[6]||(I[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),be(_p,{attachments:p.value,onRemove:B},null,8,["attachments"]),u.value?(l(),r("div",{key:1,class:"drop-zone-overlay",onDragover:I[0]||(I[0]=ye(()=>{},["prevent"])),onDragleave:I[1]||(I[1]=V=>u.value=!1),onDrop:ye(J,["prevent"])},[...I[7]||(I[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):T("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:I[4]||(I[4]=ye(V=>u.value=!0,["prevent"])),onDragenter:I[5]||(I[5]=ye(V=>u.value=!0,["prevent"]))},[v.value?(l(),Te(yp,{key:0,commands:E.value,"selected-index":S.value,onSelect:R,onHighlight:I[2]||(I[2]=V=>S.value=V)},null,8,["commands","selected-index"])):T("",!0),t("input",{ref_key:"fileInput",ref:f,type:"file",multiple:"",class:"d-none",onChange:W},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:i.value||!h.value,onClick:F}," ðŸ“Ž ",8,kp),Se(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:d,"onUpdate:modelValue":I[3]||(I[3]=V=>b.value=V),class:"form-control",placeholder:M.value,disabled:i.value||!h.value,rows:"1","aria-expanded":v.value||void 0,"aria-activedescendant":v.value?`slash-cmd-${S.value}`:void 0,onInput:z,onKeydown:O,onPaste:ie},null,40,$p),[[We,b.value]]),g.value&&!x.value?(l(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:ce}," Stop ")):g.value&&x.value?(l(),r("button",{key:2,class:"btn btn-info",disabled:!h.value||i.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:X},y(w.value?"Uploading...":"Queue"),9,Sp)):(l(),r("button",{key:3,class:"btn btn-primary",disabled:!x.value||!h.value||i.value||w.value,onClick:X},y(w.value?"Uploading...":"Send"),9,xp))],32)],2))}},Ep=ne(Cp,[["__scopeId","data-v-5b1f250e"]]),Tp={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Ap={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Dp={class:"text-secondary"},Mp={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Op={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=he(),o=xe(),a=_(()=>s.currentSession),c=_(()=>o.isLoading),d=_(()=>o.loadingMessage);return Me(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ve(()=>e.sessionId,async(f,m)=>{if(f!==m&&f!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(f)}finally{o.hideLoading()}}}),De(()=>{}),(f,m)=>(l(),r("div",Tp,[c.value?(l(),r("div",Ap,[m[0]||(m[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Dp,y(d.value),1)])):T("",!0),t("div",Mp,[be(op)]),be(Ep),a.value?(l(),Te(ni,{key:1,"session-id":e.sessionId},null,8,["session-id"])):T("",!0),a.value?(l(),Te(di,{key:2,"session-id":e.sessionId},null,8,["session-id"])):T("",!0)]))}},Ut=lt("legion",()=>{const n=L(new Map),e=L(new Map),s=L(null),o=_(()=>n.value.get(s.value)||[]),a=_(()=>e.value.get(s.value)||[]);function c(S){s.value=S}async function d(S,b=100,g=0){try{const h=await ke.get(`/api/legions/${S}/timeline?limit=${b}&offset=${g}`),i=h.comms||[],$=h.total_count||i.length,x=h.has_more||!1;return i.sort((N,M)=>new Date(N.timestamp)-new Date(M.timestamp)),console.log(`Loaded ${i.length} of ${$} comms for legion ${S}`),n.value.set(S,i),n.value=new Map(n.value),{comms:i,totalCount:$,hasMore:x}}catch(h){throw console.error("Failed to load timeline:",h),h}}function f(S,b){n.value.has(S)||n.value.set(S,[]);const g=n.value.get(S);if(g.some(i=>i.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}g.push(b),n.value=new Map(n.value)}async function m(S,b){try{const h=(await ke.post(`/api/legions/${S}/comms`,b)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${S}`),h}catch(g){throw console.error("Failed to send comm:",g),g}}async function p(S){return console.log(`Minions for legion ${S} are already available in session store`),[]}async function u(S,b){try{const h=(await ke.post(`/api/legions/${S}/minions`,b)).minion;return await p(S),console.log(`Created minion ${h.minion_id} in legion ${S}`),h}catch(g){throw console.error("Failed to create minion:",g),g}}async function w(S){try{const b=await ke.post(`/api/legions/${S}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${S}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function v(S){try{const b=await ke.post(`/api/legions/${S}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${S}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function k(S){n.value.delete(S),e.value.delete(S),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:a,setCurrentLegion:c,loadTimeline:d,addComm:f,sendComm:m,loadMinions:p,createMinion:u,haltAll:w,resumeAll:v,clearLegionData:k}}),Np=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Ut},Symbol.toStringTag,{value:"Module"})),Lp={class:"timeline-header border-bottom p-3"},Ip={class:"project-name"},jp=["title"],Pp={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ze(),o=_(()=>s.projects.get(e.legionId)),a=_(()=>o.value?.name||"Legion");return(c,d)=>(l(),r("div",Lp,[t("div",null,[t("div",Ip,y(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,jp)])]))}},Rp=ne(Pp,[["__scopeId","data-v-44f386f5"]]),Bp={class:"timeline-status-bar border-top p-2 bg-light"},Fp={class:"d-flex justify-content-end"},Vp={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=xe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(l(),r("div",Bp,[t("div",Fp,[t("button",{class:K(["btn btn-sm",ae(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+y(ae(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Wp=ne(Vp,[["__scopeId","data-v-891c73db"]]),Up={class:"comm-composer border-top p-3"},Hp={key:0,class:"d-flex gap-2 mb-2"},qp={class:"flex-grow-1"},zp=["disabled"],Kp={label:"Minions"},Gp=["value"],Yp={style:{"min-width":"150px"}},Jp=["disabled"],Qp={class:"d-flex gap-2 align-items-end position-relative"},Xp={class:"flex-grow-1 position-relative"},Zp=["disabled"],ev=["onClick","onMouseenter"],tv=["disabled"],sv={key:0},nv={key:1},ov={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Ut(),o=he(),a=ze(),c=L(""),d=L("task"),f=L(""),m=L(!1),p=L(window.innerWidth),u=L(!1),w=L([]),v=L(0),k=L(-1),S=L(null),b=L(null),g=_(()=>p.value<768),h=_(()=>{const R=a.projects.get(e.legionId);return!R||!R.session_ids?[]:R.session_ids.map(F=>o.sessions.get(F)).filter(F=>F)}),i=_(()=>c.value&&f.value.trim().length>0);function $(R){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[R.state]||"â—‹"}function x(R){return R.role?`${R.name} (${R.role})`:R.name}function N(){const R=S.value;if(!R)return;R.style.height="auto";const F=Math.min(R.scrollHeight,parseInt(getComputedStyle(R).maxHeight));R.style.height=F+"px"}function M(){const R=S.value;if(!R)return;N();const F=f.value,W=R.selectionStart,J=F.substring(0,W),ie=J.lastIndexOf("#");if(ie===-1){u.value=!1;return}const re=J.substring(ie+1).toLowerCase();if(re.includes(" ")){u.value=!1;return}const B=h.value.filter(D=>D.name.toLowerCase().includes(re)).map(D=>({type:"minion",name:D.name,role:D.role,id:D.session_id,state:D.state}));if(B.length===0){u.value=!1;return}w.value=B,v.value=0,k.value=ie,u.value=!0}function A(){if(!b.value)return;const R=b.value,F=R.children[v.value];if(!F)return;const W=F.offsetTop,J=F.offsetHeight,ie=R.scrollTop,re=R.clientHeight;W<ie?R.scrollTop=W:W+J>ie+re&&(R.scrollTop=W+J-re)}function E(R){if(!u.value){if(R.key==="Enter"&&!R.shiftKey){if(g.value)return;i.value&&(R.preventDefault(),O())}return}if(R.key==="ArrowDown")R.preventDefault(),v.value=(v.value+1)%w.value.length,A();else if(R.key==="ArrowUp")R.preventDefault(),v.value=v.value===0?w.value.length-1:v.value-1,A();else if(R.key==="Enter"){R.preventDefault();const F=w.value[v.value];F&&C(F)}else R.key==="Escape"&&(u.value=!1)}function C(R){const F=S.value;if(!F)return;const W=f.value,J=F.selectionStart,ie=W.substring(0,k.value)+"#"+R.name+" "+W.substring(J);f.value=ie;const re=k.value+R.name.length+2;setTimeout(()=>{F.setSelectionRange(re,re),F.focus()},0),u.value=!1}async function O(){if(!(!i.value||m.value)){m.value=!0;try{const[R,F]=c.value.split(":"),W={comm_type:d.value,content:f.value.trim()};R==="minion"&&(W.to_minion_id=F),await s.sendComm(e.legionId,W),f.value="",N()}catch(R){console.error("Failed to send comm:",R),alert(`Failed to send comm: ${R.message}`)}finally{m.value=!1}}}function z(){p.value=window.innerWidth}return Me(()=>{window.addEventListener("resize",z)}),De(()=>{window.removeEventListener("resize",z)}),ve(u,R=>{if(R){const F=W=>{W.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",F))};setTimeout(()=>document.addEventListener("click",F),0)}}),(R,F)=>(l(),r("div",Up,[n.hideRecipientSelector?T("",!0):(l(),r("div",Hp,[t("div",qp,[Se(t("select",{"onUpdate:modelValue":F[0]||(F[0]=W=>c.value=W),class:"form-select form-select-sm",disabled:m.value},[F[3]||(F[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",Kp,[(l(!0),r(oe,null,de(h.value,W=>(l(),r("option",{key:W.session_id,value:`minion:${W.session_id}`},y($(W))+" "+y(x(W)),9,Gp))),128))])],8,zp),[[En,c.value]])]),t("div",Yp,[Se(t("select",{"onUpdate:modelValue":F[1]||(F[1]=W=>d.value=W),class:"form-select form-select-sm",disabled:m.value},[...F[4]||(F[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,Jp),[[En,d.value]])])])),t("div",Qp,[t("div",Xp,[Se(t("textarea",{ref_key:"contentTextarea",ref:S,"onUpdate:modelValue":F[2]||(F[2]=W=>f.value=W),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:M,onKeydown:E},null,40,Zp),[[We,f.value]]),u.value?(l(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(l(!0),r(oe,null,de(w.value,(W,J)=>(l(),r("div",{key:W.id,class:K(["autocomplete-item px-2 py-1",{"bg-light":J===v.value}]),onClick:ie=>C(W),onMouseenter:ie=>v.value=J},y(W.type==="minion"?$(W):"#ï¸âƒ£")+" "+y(W.name)+y(W.role?` (${W.role})`:""),43,ev))),128))],512)):T("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!i.value||m.value,onClick:O},[m.value?(l(),r("span",sv,[...F[5]||(F[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),fe(" Sending... ",-1)])])):(l(),r("span",nv,"Send"))],8,tv)])])]))}},av=ne(ov,[["__scopeId","data-v-e52b8e8f"]]),iv={class:"message-content-column-full"},lv=["aria-expanded"],rv={class:"comm-sender-recipient"},cv={class:"comm-badge-summary"},uv=["title"],dv={class:"comm-summary-text text-muted ms-2"},fv=["aria-label"],mv={key:0,class:"comm-content-body"},pv=["innerHTML"],vv="ffffffff-ffff-ffff-ffff-ffffffffffff",hv={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ye.setOptions({breaks:!0,gfm:!0});const s=L(!1);function o(){s.value=!s.value}const a=_(()=>e.comm.from_minion_id===vv),c=_(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),d=_(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),f=_(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),m=_(()=>{const p=e.comm.content||"";let u=Ye.parse(p);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),Wt.sanitize(u)});return(p,u)=>(l(),r("div",{class:K(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",iv,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",rv,[t("strong",{class:K({"system-sender":a.value})},y(n.senderName),3),n.recipientName?(l(),r(oe,{key:0},[u[0]||(u[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,y(n.recipientName),1)],64)):T("",!0)]),t("div",cv,[t("span",{class:K(["badge",d.value]),title:c.value},y(n.comm.comm_type),11,uv),t("span",dv,y(f.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,fv)],8,lv),s.value?(l(),r("div",mv,[t("div",{class:"message-text",innerHTML:m.value},null,8,pv)])):T("",!0)])],2))}},_v=ne(hv,[["__scopeId","data-v-28513f64"]]),gv={class:"timeline-view d-flex flex-column h-100"},bv={key:0,class:"text-center text-muted"},yv={key:1,class:"text-center text-danger"},wv={key:2,class:"text-center text-muted"},kv={key:3,class:"comm-list"},$v={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Ut();ze();const o=he(),a=rt(),c=xe(),d=L(!0),f=L(null),m=L(null),p=_(()=>s.currentComms);function u(g){return g.from_user?"You":g.from_minion_id?g.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(g.from_minion_id)?.name||"Unknown":"Unknown"}function w(g){return g.to_user?"You":g.to_minion_id?o.sessions.get(g.to_minion_id)?.name||"Unknown":"All"}async function v(){c.autoScrollEnabled&&(await dt(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function k(){d.value=!0,f.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await dt(),await v(),setTimeout(()=>{v()},100)}catch(g){console.error("Failed to load timeline:",g),g.response?f.value=`${g.message} (${g.response.status})`:f.value=g.message||"Unknown error"}finally{d.value=!1}}function S(){a.connectLegion(e.legionId)}function b(){a.disconnectLegion()}return ve(()=>p.value.length,()=>{v()}),Me(()=>{o.currentSessionId=null,k(),S(),setTimeout(()=>{v()},100)}),De(()=>{b()}),(g,h)=>(l(),r("div",gv,[be(Rp,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[d.value?(l(),r("div",bv,[...h[0]||(h[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),fe(" Loading timeline... ",-1)])])):f.value?(l(),r("div",yv," Failed to load timeline: "+y(f.value),1)):p.value.length===0?(l(),r("div",wv," No messages yet. Minions will appear here once they start communicating. ")):(l(),r("div",kv,[(l(!0),r(oe,null,de(p.value,i=>(l(),Te(_v,{key:i.comm_id,comm:i,"sender-name":u(i),"recipient-name":w(i)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),be(av,{"legion-id":n.legionId},null,8,["legion-id"]),be(Wp,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Sv=ne($v,[["__scopeId","data-v-b6752179"]]),xv={class:"minion-info flex-grow-1"},Cv={class:"minion-name"},Ev={key:0,class:"me-1"},Tv={key:1,class:"badge bg-secondary ms-2"},Av={key:0,class:"latest-activity text-muted"},Dv={key:0,class:"activity-prefix"},Mv=["title"],Ov={key:1,class:"activity-time ms-1"},Nv={key:1,class:"latest-activity text-muted"},Lv={class:"activity-prefix"},Iv=["title"],jv={key:2,class:"latest-activity text-muted fst-italic small"},Pv={class:"node-row"},Rv={class:"node-left"},Bv={key:0,class:"me-2"},Fv={key:1,class:"badge bg-secondary ms-2"},Vv={class:"node-right"},Wv={key:0,class:"latest-message-preview"},Uv={key:0,class:"message-prefix"},Hv=["title"],qv={key:1,class:"message-time ms-1"},zv={key:1,class:"last-comm-preview"},Kv={class:"comm-direction"},Gv=["title"],Yv={key:2,class:"text-muted fst-italic small"},Jv={class:"node-actions"},Qv={key:2,class:"minion-children"},Xv={key:1,class:"text-danger small ms-4"},Zv={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,a=he(),c=je(),d=xe(),f=_(()=>!s.minionData||!s.minionData.id?null:a.getSession(s.minionData.id)),m=_(()=>{if(!s.minionData||!s.minionData.id)return null;const C=c.messagesBySession.get(s.minionData.id);if(!C||C.length===0)return null;for(let O=C.length-1;O>=0;O--){const z=C[O],R=z.subtype||z.metadata?.subtype;if(z.type!=="result"&&!(z.type==="system"&&R==="init")&&!(z.type==="system"&&R==="task_notification")&&!(z.type==="permission_request"||z.type==="permission_response")){if(z.type==="user"&&z.metadata?.has_tool_results){const F=z.content||"";if(F.match(/^Tool results?: \d+ results?$/i)||F.trim()==="")continue}if(z.type==="user"){const F=z.content||"";if(F.includes("<command-message>")&&F.includes("skill is running")||F.startsWith("Base directory for this skill:"))continue}if(z.type==="user"){const F=z.content||"";if(F.includes("<command-message>")&&F.includes("<command-name>")&&F.includes("<command-args>")||F.includes("ARGUMENTS:")&&(F.includes("<command-name>")||F.match(/\nARGUMENTS:/)))continue}if(!(z.type==="system"&&z.content==="System message")&&!(z.type==="assistant"&&z.content==="Assistant response")&&(z.type==="user"||z.type==="assistant"||z.type==="system"))return{content:z.content,type:z.type,timestamp:z.timestamp}}}return null}),p=_(()=>{if(!s.minionData)return null;const C={...s.minionData};return f.value&&(C.state=f.value.state,C.is_processing=f.value.is_processing,f.value.name&&(C.name=f.value.name),f.value.latest_message&&(C.latest_message=f.value.latest_message,C.latest_message_type=f.value.latest_message_type,C.latest_message_time=f.value.latest_message_time)),m.value&&(C.latest_message=m.value.content,C.latest_message_type=m.value.type,C.latest_message_time=m.value.timestamp),C}),u=_(()=>s.level*24),w=_(()=>!s.minionData||!s.minionData.id?!1:a.currentSessionId===s.minionData.id),v=_(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),k=_(()=>s.minionData&&s.minionData.is_overseer&&v.value),S=_(()=>{const C=p.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),b=_(()=>{const C=S.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),g=_(()=>{const C=S.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),h=_(()=>{const C=p.value;if(!C||!C.latest_message_type)return"";const O=C.latest_message_type;return O==="user"?"User -->:":O==="system"?"System:":""}),i=_(()=>{const C=p.value;if(!C||!C.latest_message)return"";const O=C.latest_message,z=150;return O.length>z?O.slice(0,z)+"...":O}),$=_(()=>{const C=p.value;if(!C||!C.latest_message_time)return"";try{const O=Date.now();let z;if(typeof C.latest_message_time=="number"?z=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:z=new Date(C.latest_message_time).getTime(),isNaN(z)||z<9466848e5||z>O+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",z),"";const R=O-z;if(R<0)return"just now";const F=Math.floor(R/6e4),W=Math.floor(F/60),J=Math.floor(W/24);return J>0?`${J}d ago`:W>0?`${W}h ago`:F>0?`${F}m ago`:"just now"}catch(O){return console.error("Error calculating relative time:",O,C.latest_message_time),""}});function x(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function N(C){const O=C.summary||C.content||"";return O.length>150?O.substring(0,150)+"...":O}function M(){o("minion-click",s.minionData.id)}function A(){const C=a.sessions.get(s.minionData.id);C&&d.showModal("edit-session",{session:C})}function E(){const C=a.sessions.get(s.minionData.id);C&&d.showModal("manage-session",{session:C})}return(C,O)=>{const z=cn("MinionTreeNode",!0);return n.minionData?(l(),r("div",{key:0,class:"minion-tree-node",style:Pe({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(l(),r("div",{key:0,class:K(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:M},[t("div",{class:K(["status-dot me-2",b.value]),style:Pe(g.value)},null,6),t("div",xv,[t("div",Cv,[k.value?(l(),r("span",Ev,"ðŸ‘‘")):T("",!0),t("strong",null,y(p.value?.name||n.minionData.name),1),k.value?(l(),r("span",Tv,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):T("",!0)]),p.value?.latest_message?(l(),r("div",Av,[h.value?(l(),r("span",Dv,y(h.value),1)):T("",!0),t("span",{class:"activity-content",title:p.value.latest_message},y(i.value),9,Mv),$.value?(l(),r("span",Ov,"("+y($.value)+")",1)):T("",!0)])):n.minionData?.last_comm?(l(),r("div",Nv,[t("span",Lv,[O[1]||(O[1]=fe("â†’ ",-1)),t("strong",null,y(x(n.minionData.last_comm)),1),O[2]||(O[2]=fe(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(N(n.minionData.last_comm)),9,Iv)])):(l(),r("div",jv," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ye(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ye(E,["stop"])}," âš™ï¸ ")],2)):(l(),r("div",{key:1,class:K(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:M},[t("div",Pv,[t("div",Rv,[t("div",{class:K(["status-dot me-2",b.value]),style:Pe(g.value)},null,6),k.value?(l(),r("span",Bv,"ðŸ‘‘")):T("",!0),t("strong",null,y(p.value?.name||n.minionData.name),1),k.value?(l(),r("span",Fv,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):T("",!0)]),t("div",Vv,[p.value?.latest_message?(l(),r("div",Wv,[h.value?(l(),r("span",Uv,y(h.value),1)):T("",!0),t("span",{class:"message-content",title:p.value.latest_message},y(i.value),9,Hv),$.value?(l(),r("span",qv,"("+y($.value)+")",1)):T("",!0)])):n.minionData?.last_comm?(l(),r("div",zv,[t("span",Kv,[O[3]||(O[3]=fe("â†’ ",-1)),t("strong",null,y(x(n.minionData.last_comm)),1),O[4]||(O[4]=fe(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(N(n.minionData.last_comm)),9,Gv)])):(l(),r("div",Yv," No activity yet "))]),t("div",Jv,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ye(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ye(E,["stop"])}," âš™ï¸ ")])])],2)),v.value?(l(),r("div",Qv,[(l(!0),r(oe,null,de(n.minionData.children,R=>(l(),Te(z,{key:R.id,"minion-data":R,level:n.level+1,layout:n.layout,onMinionClick:O[0]||(O[0]=F=>C.$emit("minion-click",F))},null,8,["minion-data","level","layout"]))),128))])):T("",!0)],4)):(l(),r("div",Xv," âš  Minion data is missing "))}}},eh=ne(Zv,[["__scopeId","data-v-64b23e0e"]]),th={class:"project-overview d-flex flex-column h-100"},sh={class:"project-overview-header border-bottom p-3"},nh={class:"d-flex align-items-center justify-content-between"},oh={class:"mb-1"},ah={key:0,class:"me-2"},ih={class:"text-muted font-monospace"},lh={class:"d-flex gap-2"},rh=["title"],ch={class:"project-overview-content flex-grow-1 overflow-auto p-3"},uh={key:0,class:"text-center py-5"},dh={key:1,class:"alert alert-danger"},fh={key:2,class:"text-center py-5"},mh={key:3},ph={class:"row g-3 mb-4"},vh={class:"col-md-4"},hh={class:"card h-100"},_h={class:"card-body"},gh={class:"card-title mb-0"},bh={class:"text-muted"},yh={class:"col-md-4"},wh={class:"card h-100"},kh={class:"card-body"},$h={class:"card-title mb-0"},Sh={class:"text-muted"},xh={key:0,class:"card mb-4"},Ch={class:"card mb-4"},Eh={class:"card-header d-flex align-items-center justify-content-between"},Th={class:"mb-0"},Ah={class:"badge bg-secondary"},Dh={class:"card-body"},Mh={key:0,class:"text-center py-4"},Oh={key:1,class:"text-center text-muted py-4"},Nh={key:2,class:"hierarchy-tree"},Lh={class:"user-root-node mb-3 border rounded bg-white"},Ih={class:"node-row"},jh={class:"node-left"},Ph={class:"badge bg-primary ms-2"},Rh={class:"node-right"},Bh={key:0,class:"last-comm-preview"},Fh={class:"comm-direction"},Vh=["title"],Wh={key:1,class:"text-muted fst-italic"},Uh={class:"root-minions ms-4"},Hh={class:"card"},qh={class:"card-body"},zh={class:"row mb-0"},Kh={class:"col-sm-8 font-monospace text-break"},Gh={class:"col-sm-8 font-monospace text-break"},Yh={class:"col-sm-8"},Jh={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},Qh={class:"text-muted"},Xh={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=ts(),o=ze(),a=he(),c=xe(),d=Ut(),f=rt(),m=L(!1),p=L(null),u=L(null),w=L(!1);let v=null;const k=_(()=>o.getProject(e.projectId)),S=_(()=>k.value?.session_ids?k.value.session_ids.map(W=>a.getSession(W)).filter(W=>W!=null):[]),b=_(()=>S.value.length>0),g=_(()=>S.value.length),h=_(()=>S.value.filter(W=>W.state==="ACTIVE").length),i=_(()=>{const W=S.value.some(re=>re.state==="ACTIVE"),J=S.value.some(re=>re.is_processing);return S.value.some(re=>re.state==="ERROR")?"Error":J?"Working":W?"Active":g.value>0?"Idle":"Empty"}),$=_(()=>{switch(i.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),x=_(()=>{switch(i.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function N(){w.value=!0;try{const W=await ke.get(`/api/legions/${e.projectId}/hierarchy`);u.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),u.value=null}finally{w.value=!1}}function M(W,J){if(W&&W.id===J)return W;if(W&&W.children)for(const ie of W.children){const re=M(ie,J);if(re)return re}return null}function A(W){return W.to_user?"User":W.to_minion_name?W.to_minion_name:"unknown"}function E(W){const J=W.summary||W.content||"";return J.length>150?J.substring(0,150)+"...":J}function C(W){if(u.value){if(W.from_minion_id){const J=M(u.value,W.from_minion_id);J&&J.type==="minion"&&(J.last_comm=W)}W.from_user&&u.value.type==="user"&&(u.value.last_comm=W)}}function O(W){s.push(`/session/${W}`)}function z(){s.push(`/timeline/${e.projectId}`)}function R(){c.showModal("edit-project",{project:k.value})}function F(){c.showModal("create-minion",{project:k.value})}return Me(()=>{o.selectProject(e.projectId),a.currentSessionId=null,N(),d.setCurrentLegion(e.projectId),f.connectLegion(e.projectId),v=ve(()=>a.sessions,W=>{if(u.value){for(const[J,ie]of W)if(ie.project_id===e.projectId){const re=M(u.value,J);re&&re.type==="minion"&&(re.state!==ie.state&&(re.state=ie.state),re.is_processing!==ie.is_processing&&(re.is_processing=ie.is_processing),re.latest_message!==ie.latest_message&&(re.latest_message=ie.latest_message,re.latest_message_type=ie.latest_message_type,re.latest_message_time=ie.latest_message_time))}}},{deep:!0}),ve(()=>d.commsByLegion.get(e.projectId),W=>{if(W&&W.length>0){const J=W[W.length-1];C(J)}},{deep:!0}),ve(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(W,J)=>{W!==J&&N()})}),ve(()=>e.projectId,W=>{o.selectProject(W),a.currentSessionId=null,N(),d.setCurrentLegion(W),f.connectLegion(W)}),De(()=>{v&&v()}),(W,J)=>(l(),r("div",th,[t("div",sh,[t("div",nh,[t("div",null,[t("h4",oh,[b.value?(l(),r("span",ah,"ðŸ›")):T("",!0),fe(" "+y(k.value?.name||"Project Overview"),1)]),t("small",ih,y(k.value?.working_directory),1)]),t("div",lh,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:R}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:F}," âž• "+y(b.value?"Add Minion":"Add Session"),9,rh)])])]),t("div",ch,[m.value?(l(),r("div",uh,[...J[0]||(J[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(l(),r("div",dh,y(p.value),1)):k.value?(l(),r("div",mh,[t("div",ph,[t("div",vh,[t("div",hh,[t("div",_h,[J[2]||(J[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",gh,y(g.value),1),t("small",bh,y(h.value)+" active",1)])])]),t("div",yh,[t("div",wh,[t("div",kh,[J[3]||(J[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",$h,[t("span",{class:K($.value)},y(i.value),3)]),t("small",Sh,y(x.value),1)])])])]),b.value?(l(),r("div",xh,[J[4]||(J[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:z}," ðŸ“Š View Timeline ")])])])):T("",!0),t("div",Ch,[t("div",Eh,[t("h5",Th,"ðŸŒ³ "+y(b.value?"Minion Hierarchy":"Sessions"),1),t("span",Ah,y(S.value.length),1)]),t("div",Dh,[w.value?(l(),r("div",Mh,[...J[5]||(J[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(l(),r("div",Oh,' No sessions yet. Click "Add Session" to create one. ')):(l(),r("div",Nh,[t("div",Lh,[t("div",Ih,[t("div",jh,[J[6]||(J[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,y(u.value.name),1),t("span",Ph,y(u.value.children.length)+" "+y(u.value.children.length===1?"minion":"minions"),1)]),t("div",Rh,[u.value.last_comm?(l(),r("div",Bh,[t("span",Fh,[J[7]||(J[7]=fe(" â†’ ",-1)),t("strong",null,y(A(u.value.last_comm)),1),J[8]||(J[8]=fe(": ",-1))]),t("span",{class:"comm-content",title:u.value.last_comm.content||""},y(E(u.value.last_comm)),9,Vh)])):(l(),r("div",Wh," No communications yet "))])])]),t("div",Uh,[(l(!0),r(oe,null,de(u.value.children,ie=>(l(),Te(eh,{key:ie.id,"minion-data":ie,level:1,layout:"two-column",onMinionClick:O},null,8,["minion-data"]))),128))])]))])]),t("div",Hh,[J[12]||(J[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",qh,[t("dl",zh,[J[9]||(J[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",Kh,y(k.value.working_directory),1),J[10]||(J[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",Gh,y(k.value.project_id),1),J[11]||(J[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",Yh,y(b.value?"Yes (has minions)":"No"),1)])])])])):(l(),r("div",fh,[...J[1]||(J[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",Jh,[J[13]||(J[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",Qh,y(g.value)+" session"+y(g.value!==1?"s":""),1)])]))}},Zh=ne(Xh,[["__scopeId","data-v-168bf04c"]]),e_=[{path:"/",name:"home",component:za},{path:"/project/:projectId",name:"project",component:Zh,props:!0},{path:"/session/:sessionId",name:"session",component:Op,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Sv,props:!0}],t_=Ba({history:Fa(),routes:e_}),s_={class:"header-row1"},n_={class:"header-right"},o_=["title"],a_={__name:"HeaderRow1",setup(n){const e=xe(),s=rt(),o=_(()=>s.uiConnected);return(a,c)=>(l(),r("div",s_,[c[6]||(c[6]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",n_,[t("div",{class:K(["header-indicator",o.value?"connected":"disconnected"])},[c[3]||(c[3]=t("span",{class:"indicator-dot"},null,-1)),fe(" "+y(o.value?"Connected":"Disconnected"),1)],2),t("button",{class:K(["header-btn theme-toggle-btn",{"theme-active":ae(e).isRedBackground}]),onClick:c[0]||(c[0]=d=>ae(e).toggleBackgroundColor()),title:ae(e).isRedBackground?"Disable sensitive environment mode":"Enable sensitive environment mode"},[...c[4]||(c[4]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})],-1)])],10,o_),t("button",{class:"header-btn",onClick:c[1]||(c[1]=d=>ae(e).showRestartModal()),title:"Restart server"}," â†» "),c[5]||(c[5]=t("button",{class:"header-btn",disabled:"",title:"Settings (coming soon)",style:{opacity:"0.4",cursor:"default"}}," âš™ ",-1)),t("button",{class:K(["header-btn panel-toggle-btn",{"panel-open":ae(e).rightPanelVisible}]),onClick:c[2]||(c[2]=d=>ae(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},i_=ne(a_,[["__scopeId","data-v-2d22058c"]]),l_=["title"],r_={class:"pill-icon"},c_={class:"pill-name"},u_={key:0,class:"pill-count"},d_={class:"pill-status-bar"},f_={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=ze(),o=he(),a=xe(),c=_(()=>e.project.session_ids?.length||0),d=_(()=>c.value>1?"ðŸ”·":c.value===1?"ðŸ’¬":"ðŸ“"),f=_(()=>s.getStatusBarSegments(e.project.project_id,o));function m(){a.setBrowsingProject(e.project.project_id)}function p(){a.showModal("edit-project",{project:e.project})}return(u,w)=>(l(),r("div",{class:K(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:m,onContextmenu:ye(p,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",r_,y(d.value),1),t("span",c_,y(n.project.name),1),c.value>0?(l(),r("span",u_,y(c.value),1)):T("",!0),t("div",d_,[(l(!0),r(oe,null,de(f.value,(v,k)=>(l(),r("div",{key:k,class:K(["seg",v.status]),style:Pe({flex:v.flex})},null,6))),128))])],42,l_))}},m_=ne(f_,[["__scopeId","data-v-ecccd6e9"]]),p_={__name:"ProjectPillBar",setup(n){const e=ze(),s=he(),o=xe(),a=_(()=>e.orderedProjects),c=_(()=>o.browsingProjectId),d=_(()=>{const m=s.currentSession;return m?m.project_id:null});ve(d,m=>{m&&o.setBrowsingProject(m)}),ve(a,m=>{!c.value&&m.length>0&&o.setBrowsingProject(m[0].project_id)},{immediate:!0});function f(){o.showModal("create-project")}return(m,p)=>(l(),r("div",{class:K(["project-pill-bar",{"theme-red":ae(o).isRedBackground}])},[(l(!0),r(oe,null,de(a.value,u=>(l(),Te(m_,{key:u.project_id,project:u,isActive:u.project_id===d.value,isBrowsing:u.project_id===c.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:f,title:"New project"}," + ")],2))}},v_=ne(p_,[["__scopeId","data-v-fcc3f866"]]),h_=["title"],__={class:"ac-info"},g_={class:"ac-name"},b_={class:"ac-status"},y_={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select"],setup(n,{emit:e}){const s=n,o=e;he();const a=_(()=>s.session.name||s.session.role||"Agent"),c=_(()=>{const u=s.session.state;return u==="error"?"error":u==="paused"?"waiting":u==="active"&&s.session.is_processing?"active":u==="active"?"idle":"none"}),d=_(()=>{const u=s.session.state;return u==="active"&&s.session.is_processing?"Processing...":u==="active"?"Idle":u==="paused"?"Awaiting input":u==="error"?"Error":u==="terminated"?"Stopped":u==="starting"?"Starting...":u==="created"?"Ready":u||"Unknown"}),f=_(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),m=_(()=>{const u=[a.value];return s.session.role&&u.push(`Role: ${s.session.role}`),u.push(`Status: ${d.value}`),s.session.model&&u.push(`Model: ${s.session.model}`),u.join(`
`)});function p(){o("select",s.session.session_id)}return(u,w)=>(l(),r("div",{class:K(["agent-chip",{active:n.isActive,child:n.variant==="child"}]),onClick:p,title:m.value},[t("div",{class:K(["ac-dot",c.value])},null,2),t("div",__,[t("div",g_,y(a.value),1),t("div",b_,y(d.value),1)]),f.value?(l(),r("div",{key:0,class:K(["ac-alert",f.value])},y(f.value==="error"?"!":"?"),3)):T("",!0)],10,h_))}},en=ne(y_,[["__scopeId","data-v-f9f7aad4"]]),w_=["title"],k_={class:"peek-letter"},$_={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=he(),o=_(()=>s.getSession(e.sessionId)),a=_(()=>(o.value?.name||o.value?.role||"?").charAt(0).toUpperCase()),c=_(()=>({right:`${-22-e.index*22}px`,zIndex:20-e.index})),d=_(()=>{if(!o.value)return"dot-none";const p=o.value.state;return p==="active"&&o.value.is_processing?"dot-active":p==="active"?"dot-idle":p==="paused"?"dot-waiting":p==="error"?"dot-error":"dot-none"}),f=_(()=>o.value?o.value.has_pending_permission||o.value.state==="error":!1),m=_(()=>o.value?o.value.state==="error"?"alert-error":"alert-permission":"");return(p,u)=>(l(),r("div",{class:"peek-card",style:Pe(c.value),title:o.value?.name||"Child agent",onClick:u[0]||(u[0]=ye(w=>p.$emit("click"),["stop"]))},[t("div",{class:K(["peek-dot",d.value])},null,2),t("span",k_,y(a.value),1),f.value?(l(),r("div",{key:0,class:K(["peek-alert",m.value])},null,2)):T("",!0)],12,w_))}},S_=ne($_,[["__scopeId","data-v-7f1d4c1b"]]),Fn=44,Vn=12,x_={__name:"ChipConnector",props:{depth:{type:Number,default:1},maxDepth:{type:Number,default:1}},setup(n){const e=n,s=Fn-Vn*2,o=_(()=>{const a=e.maxDepth;let c;if(a<=1)c=Fn/2;else{const d=(e.depth-1)/(a-1);c=Vn+d*s}return{alignSelf:"flex-start",marginTop:`${Math.round(c)}px`}});return(a,c)=>(l(),r("div",{class:"chip-connector",style:Pe(o.value)},null,4))}},C_=ne(x_,[["__scopeId","data-v-08d20738"]]),E_=["title"],T_=Object.assign({name:"StackedChip"},{__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},depth:{type:Number,default:1},maxDepth:{type:Number,default:0}},emits:["select"],setup(n){const e=n,s=he(),o=xe(),a=_(()=>s.currentSessionId),c=_(()=>e.session.child_minion_ids||[]);function d(h,i){if(!h?.child_minion_ids?.length)return i;let $=i;for(const x of h.child_minion_ids){const N=s.getSession(x);N&&($=Math.max($,d(N,i+1)))}return $}const f=_(()=>e.maxDepth>0?e.maxDepth:d(e.session,0)),m=_(()=>{if(!a.value)return!1;function h(i){if(!i)return!1;for(const $ of i){if($===a.value)return!0;const x=s.getSession($);if(x?.child_minion_ids&&h(x.child_minion_ids))return!0}return!1}return h(c.value)}),p=_(()=>o.expandedStacks.has(e.session.session_id)||m.value),u=_(()=>c.value.slice(0,3)),w=_(()=>p.value||c.value.length===0?{}:{marginRight:`${Math.min(c.value.length,3)*22}px`});function v(h){return s.getSession(h)}function k(h){return s.getSession(h)?.child_minion_ids?.length>0}function S(h){const i=s.getSession(h);return i?.child_minion_ids?i.child_minion_ids.includes(a.value):!1}function b(){o.toggleStack(e.session.session_id)}function g(){p.value||o.toggleStack(e.session.session_id)}return(h,i)=>{const $=cn("StackedChip",!0);return l(),r("div",{class:"stacked-chip",style:Pe(w.value)},[t("div",{class:K(["parent-wrapper",{"has-children":c.value.length>0}])},[be(en,{session:n.session,isActive:n.isActive,onSelect:i[0]||(i[0]=x=>h.$emit("select",n.session.session_id)),onDblclick:b},null,8,["session","isActive"]),!p.value&&c.value.length>0?(l(!0),r(oe,{key:0},de(u.value,(x,N)=>(l(),Te(S_,{key:x,sessionId:x,index:N,onClick:g},null,8,["sessionId","index"]))),128)):T("",!0),c.value.length>0?(l(),r("div",{key:1,class:"stack-count",onClick:ye(b,["stop"]),title:`${c.value.length} child agent${c.value.length!==1?"s":""}`},y(c.value.length),9,E_)):T("",!0)],2),p.value?(l(!0),r(oe,{key:0},de(c.value,x=>(l(),r(oe,{key:x},[be(C_,{depth:n.depth,maxDepth:f.value},null,8,["depth","maxDepth"]),v(x)&&k(x)?(l(),Te($,{key:0,session:v(x),isActive:x===a.value||S(x),depth:n.depth+1,maxDepth:f.value,onSelect:i[1]||(i[1]=N=>h.$emit("select",N))},null,8,["session","isActive","depth","maxDepth"])):v(x)?(l(),Te(en,{key:1,session:v(x),isActive:x===a.value,variant:"child",onSelect:N=>h.$emit("select",x)},null,8,["session","isActive","onSelect"])):T("",!0)],64))),128)):T("",!0)],4)}}}),A_=ne(T_,[["__scopeId","data-v-90c2e1f5"]]),D_={class:"strip-project-label"},M_={key:0,class:"strip-empty"},O_={__name:"AgentStrip",setup(n){const e=ze(),s=he(),o=xe(),a=ts(),c=L(null),d=_(()=>{const i=s.currentSession;return i?i.project_id:null});function f(i){const $=c.value&&c.value.contains(i.target),x=i.target.closest(".project-pill-bar");!$&&!x&&(o.collapseAllStacks(),d.value&&o.browsingProjectId!==d.value&&o.setBrowsingProject(d.value))}Me(()=>{document.addEventListener("click",f,!0)}),De(()=>{document.removeEventListener("click",f,!0)});const m=_(()=>s.currentSessionId),p=_(()=>{const i=o.browsingProjectId;return i?e.getProject(i):null}),u=_(()=>{const i=p.value;return!i||!i.session_ids?[]:i.session_ids.map($=>s.getSession($)).filter(Boolean).sort(($,x)=>($.order||0)-(x.order||0))}),w=_(()=>{const i=new Set;for(const $ of u.value)if($.child_minion_ids)for(const x of $.child_minion_ids)i.add(x);return i}),v=_(()=>u.value.filter(i=>!w.value.has(i.session_id)));function k(i){return i.child_minion_ids&&i.child_minion_ids.length>0}function S(i){return i.child_minion_ids?i.child_minion_ids.includes(m.value):!1}function b(i){const $=s.getSession(i);$&&o.setBrowsingProject($.project_id),s.selectSession(i),a.push(`/session/${i}`)}function g(i){i.target.classList.contains("agent-strip")&&o.collapseAllStacks()}function h(){const i=p.value;i&&o.showModal("create-minion",{project:i})}return(i,$)=>p.value?(l(),r("div",{key:0,class:K(["agent-strip",{"theme-red":ae(o).isRedBackground}]),ref_key:"stripEl",ref:c,onClick:g},[t("span",D_,y(p.value.name),1),(l(!0),r(oe,null,de(v.value,x=>(l(),r(oe,{key:x.session_id},[k(x)?(l(),Te(A_,{key:0,session:x,isActive:x.session_id===m.value||S(x),onSelect:b},null,8,["session","isActive"])):(l(),Te(en,{key:1,session:x,isActive:x.session_id===m.value,onSelect:b},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:ye(h,["stop"]),title:"Add agent"}," + "),v.value.length===0?(l(),r("span",M_,"No agents yet")):T("",!0)],2)):(l(),r("div",{key:1,class:K(["agent-strip agent-strip-empty",{"theme-red":ae(o).isRedBackground}])},[...$[0]||($[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])],2))}},N_=ne(O_,[["__scopeId","data-v-31dc5efd"]]),dn=lt("diff",()=>{const n=L(new Map),e=L(!1),s=L(null),o=L("total"),a=L(!1),c=L(null),d=L(null),f=L(null),m=L(new Map),p=_(()=>{const E=he();return E.currentSessionId&&n.value.get(E.currentSessionId)||null}),u=_(()=>!p.value||!p.value.files?[]:Object.entries(p.value.files).map(([E,C])=>({path:E,...C})).sort((E,C)=>E.path.localeCompare(C.path))),w=_(()=>u.value.length),v=_(()=>!p.value||!p.value.commits?0:p.value.commits.length),k=_(()=>p.value?.is_git_repo===!0),S=_(()=>{if(!c.value||!d.value)return null;const E=f.value||"committed",C=`${c.value}:${E}:${d.value}`;return m.value.get(C)||null});async function b(E){if(E){e.value=!0,s.value=null;try{const C=await Zt(`/api/sessions/${E}/diff`);n.value.set(E,C),n.value=new Map(n.value)}catch(C){console.error(`Failed to load diff for session ${E}:`,C),s.value=C.message}finally{e.value=!1}}}async function g(E){for(const C of m.value.keys())C.startsWith(`${E}:`)&&m.value.delete(C);m.value=new Map(m.value),await b(E)}async function h(E,C,O=null){if(!E||!C)return;const R=`${E}:${O||"committed"}:${C}`,F=m.value.get(R);if(!(F&&!F.error&&F.content!==null)){m.value.set(R,{content:null,loading:!0,error:null}),m.value=new Map(m.value);try{const W={path:C};O&&(W.ref=O);const J=await Zt(`/api/sessions/${E}/diff/file`,{params:W});m.value.set(R,{content:J.diff,loading:!1,error:null})}catch(W){console.error(`Failed to load file diff for ${C}:`,W),m.value.set(R,{content:null,loading:!1,error:W.message})}m.value=new Map(m.value)}}function i(E,C,O=null){c.value=E,d.value=C,f.value=O,a.value=!0,h(E,C,O)}function $(){a.value=!1,f.value=null}function x(){if(!c.value)return;const E=u.value;if(E.length===0)return;const O=(E.findIndex(z=>z.path===d.value)+1)%E.length;d.value=E[O].path,h(c.value,d.value,f.value)}function N(){if(!c.value)return;const E=u.value;if(E.length===0)return;const O=(E.findIndex(z=>z.path===d.value)-1+E.length)%E.length;d.value=E[O].path,h(c.value,d.value,f.value)}function M(E){o.value=E}function A(E){n.value.delete(E),n.value=new Map(n.value);for(const C of m.value.keys())C.startsWith(`${E}:`)&&m.value.delete(C);m.value=new Map(m.value),c.value===E&&$()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:a,fullViewSessionId:c,currentFilePath:d,fullViewRef:f,fileDiffCache:m,currentDiff:p,currentFiles:u,fileCount:w,commitCount:v,isGitRepo:k,currentFullViewFileDiff:S,loadDiff:b,refreshDiff:g,loadFileDiff:h,openFullView:i,closeFullView:$,nextFile:x,prevFile:N,setMode:M,clearDiff:A}}),L_={key:0,class:"agent-overview"},I_={class:"overview-identity"},j_={class:"overview-info"},P_={class:"overview-name"},R_={key:0,class:"overview-role"},B_={class:"overview-stats"},F_={class:"stat-item"},V_={class:"stat-value"},W_={class:"stat-item"},U_={class:"stat-value"},H_={class:"stat-item"},q_={class:"stat-value"},z_={class:"stat-item"},K_={class:"stat-value"},G_={key:1,class:"agent-overview agent-overview-empty"},Y_={__name:"AgentOverview",setup(n){const e=he(),s=je(),o=xe(),a=L(Date.now());let c=null;Me(()=>{c=setInterval(()=>{a.value=Date.now()},1e4)}),De(()=>{c&&clearInterval(c)});const d=_(()=>{const i=e.currentSessionId;return i?e.getSession(i):null}),f=_(()=>(d.value?.name||"A").charAt(0).toUpperCase()),m=_(()=>{const i=d.value?.name||"";let $=0;for(let N=0;N<i.length;N++)$=i.charCodeAt(N)+(($<<5)-$);return`hsl(${Math.abs($%360)}, 60%, 55%)`}),p=_(()=>{if(!d.value)return"status-none";const i=d.value.state;return i==="active"&&d.value.is_processing?"status-active":i==="active"?"status-idle":i==="paused"?"status-waiting":i==="error"?"status-error":i==="terminated"?"status-terminated":"status-none"}),u=_(()=>{if(!d.value)return"None";const i=d.value.state;return i==="active"&&d.value.is_processing?"Processing":i==="active"?"Idle":i==="paused"?"Paused":i==="error"?"Error":i==="terminated"?"Terminated":i==="created"?"Created":i==="starting"?"Starting":i}),w=_(()=>{const i=e.currentSessionId;if(!i)return 0;const $=s.messagesBySession.get(i);return $?$.filter(x=>x.type==="user"||x.type==="assistant").length:0}),v=_(()=>{const i=e.currentSessionId;if(!i)return 0;const $=s.toolCallsBySession.get(i);return $?$.length:0}),k=_(()=>d.value&&d.value.child_minion_ids?.length||0),S=_(()=>{const i=e.currentSessionId;if(!i)return"--";const $=s.launchTimestampBySession.get(i);if(!$)return"--";const x=$*1e3;a.value;let N;const M=d.value?.state;M==="terminated"||M==="error"?N=d.value?.updated_at?new Date(d.value.updated_at).getTime():Date.now():N=Date.now();const A=N-x;if(A<0)return"--";if(A<6e4)return"< 1m";const E=Math.floor(A/6e4);if(E<60)return`${E}m`;const C=Math.floor(E/60);return C<24?`${C}h ${E%60}m`:`${Math.floor(C/24)}d ${C%24}h`});function b(){d.value&&o.showModal("edit-session",{session:d.value})}function g(){d.value&&o.showModal("manage-session",{session:d.value})}function h(){d.value&&o.showModal("session-info",{sessionId:d.value.session_id})}return(i,$)=>d.value?(l(),r("div",L_,[t("div",I_,[t("div",{class:"overview-avatar",style:Pe({background:m.value})},y(f.value),5),t("div",j_,[t("div",P_,y(d.value.name||"Agent"),1),d.value.role?(l(),r("div",R_,y(d.value.role),1)):T("",!0),t("span",{class:K(["overview-status-badge",p.value])},y(u.value),3)])]),t("div",B_,[t("div",F_,[t("span",V_,y(w.value),1),$[0]||($[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",W_,[t("span",U_,y(v.value),1),$[1]||($[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",H_,[t("span",q_,y(k.value),1),$[2]||($[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",z_,[t("span",K_,y(S.value),1),$[3]||($[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview",onClick:h,title:"View session details"}," Info "),t("button",{class:"btn-overview",onClick:b,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:g,title:"Manage session lifecycle"}," Manage ")])])):(l(),r("div",G_,[...$[4]||($[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},J_=ne(Y_,[["__scopeId","data-v-4ef00321"]]),Q_={class:"task-row d-flex align-items-center gap-2"},X_={key:0,class:"status-icon"},Z_={key:1,class:"status-icon"},eg=["title"],tg={key:0,class:"task-details"},sg={key:0,class:"task-description mb-2"},ng={class:"description-content"},og={key:1,class:"task-owner mb-2"},ag={class:"ms-1"},ig={key:2,class:"task-blocked-by mb-2"},lg={key:3,class:"task-blocks"},rg={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=_(()=>e.task.status==="in_progress"),o=_(()=>e.task.status==="completed"?"âœ…":"â³"),a=_(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),c=_(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(d,f)=>(l(),r("div",{class:K(["task-item",c.value]),onClick:f[0]||(f[0]=m=>d.$emit("toggle"))},[t("div",Q_,[s.value?(l(),r("span",X_,[...f[1]||(f[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(l(),r("span",Z_,y(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},y(a.value),9,eg),(l(),r("svg",{class:K(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(l(),r("div",tg,[n.task.description?(l(),r("div",sg,[f[3]||(f[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",ng,y(n.task.description),1)])):T("",!0),n.task.owner?(l(),r("div",og,[f[4]||(f[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",ag,y(n.task.owner),1)])):T("",!0),n.task.blockedBy?.length>0?(l(),r("div",ig,[f[5]||(f[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(l(!0),r(oe,null,de(n.task.blockedBy,m=>(l(),r("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+y(m),1))),128))])):T("",!0),n.task.blocks?.length>0?(l(),r("div",lg,[f[6]||(f[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(l(!0),r(oe,null,de(n.task.blocks,m=>(l(),r("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+y(m),1))),128))])):T("",!0)])):T("",!0)],2))}},cg=ne(rg,[["__scopeId","data-v-0f96ae87"]]),ug={class:"task-list-panel"},dg={class:"task-list p-2"},fg={key:0,class:"empty-placeholder"},mg={__name:"TaskListPanel",setup(n){const e=Lt(),s=L(new Set),o=_(()=>e.currentTasks);function a(c){s.value.has(c)?s.value.delete(c):s.value.add(c),s.value=new Set(s.value)}return(c,d)=>(l(),r("div",ug,[t("div",dg,[o.value.length===0?(l(),r("div",fg,[...d[0]||(d[0]=[t("span",null,"Tasks will appear here as the agent works",-1)])])):T("",!0),be(Va,{name:"task-list",tag:"div"},{default:un(()=>[(l(!0),r(oe,null,de(o.value,f=>(l(),Te(cg,{key:f.id,task:f,isExpanded:s.value.has(f.id),onToggle:m=>a(f.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},pg=ne(mg,[["__scopeId","data-v-893d4ab0"]]),vg={class:"resource-gallery-panel"},hg={class:"resource-grid-container p-2"},_g={key:0,class:"empty-placeholder"},gg={key:1,class:"resource-grid"},bg=["onClick"],yg=["onClick","title"],wg=["src","alt"],kg=["title","onClick"],$g={class:"file-icon"},Sg={class:"file-ext"},xg={class:"resource-info"},Cg=["title"],Eg={class:"resource-actions"},Tg=["onClick"],Ag=["href","download"],Dg={__name:"ResourceGallery",setup(n){const e=Ze(),s=he(),o=Eo("addAttachmentFromResource",null),a=_(()=>e.currentResources);function c(b){return e.isImageResource(b)}function d(b){return e.getResourceIcon(b)}function f(b){const g=e.getResourceExtension(b);return g?g.toUpperCase().slice(1):""}function m(b){return e.getResourceUrl(s.currentSessionId,b)}function p(b){return e.getDownloadUrl(s.currentSessionId,b)}function u(b){e.openFullView(s.currentSessionId,b)}function w(b,g=18){return b?b.length<=g?b:b.substring(0,g-3)+"...":""}function v(b){b.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function k(b){e.removeResource(s.currentSessionId,b)}function S(b){o?o(b):console.warn("addAttachmentFromResource not provided")}return(b,g)=>(l(),r("div",vg,[t("div",hg,[a.value.length===0?(l(),r("div",_g,[...g[1]||(g[1]=[t("span",null,"Resources shared by the agent will appear here",-1)])])):(l(),r("div",gg,[(l(!0),r(oe,null,de(a.value,(h,i)=>(l(),r("div",{key:h.resource_id,class:K(["resource-item",{"is-image":c(h)}])},[t("button",{class:"remove-btn",onClick:ye($=>k(h.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...g[2]||(g[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,bg),c(h)?(l(),r("div",{key:0,class:"resource-thumbnail",onClick:$=>u(i),title:h.title||"Click to view"},[t("img",{src:m(h.resource_id),alt:h.title||"Image",loading:"lazy",onError:v},null,40,wg)],8,yg)):(l(),r("div",{key:1,class:"resource-placeholder",title:h.title||h.original_filename||"Click to view",onClick:$=>u(i)},[t("span",$g,y(d(h)),1),t("span",Sg,y(f(h)),1)],8,kg)),t("div",xg,[t("div",{class:"resource-title",title:h.title||h.original_filename},y(w(h.title||h.original_filename)),9,Cg),t("div",Eg,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ye($=>S(h),["stop"]),title:"Add to message attachments"},[...g[3]||(g[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,Tg),t("a",{href:p(h.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:h.original_filename||h.title||"download",title:"Download",onClick:g[0]||(g[0]=ye(()=>{},["stop"]))},[...g[4]||(g[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,Ag)])])],2))),128))]))])]))}},Mg=ne(Dg,[["__scopeId","data-v-5b14b073"]]),Og=["src","alt"],Ng={key:1,class:"resource-info"},Lg={key:0,class:"resource-title"},Ig={key:1,class:"resource-description"},jg={class:"resource-meta"},Pg={class:"meta-item"},Rg={class:"meta-item"},Bg={class:"meta-item"},Fg={class:"text-header"},Vg={class:"text-header-info"},Wg={class:"text-filename"},Ug={class:"resource-meta"},Hg={key:0,class:"meta-item"},qg={key:1,class:"meta-item"},zg={key:0,class:"display-mode-toggle"},Kg=["title","disabled"],Gg={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Yg={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Jg={class:"copy-label"},Qg={class:"text-body"},Xg={key:0,class:"text-loading"},Zg={key:1,class:"text-error"},eb={key:2,class:"text-content"},tb=["innerHTML"],sb={key:4,class:"text-unavailable"},nb={key:4,class:"position-indicator"},ob={key:5,class:"thumbnail-strip"},ab=["onClick"],ib=["src","alt"],lb={key:1,class:"strip-text-icon"},rb={__name:"ResourceFullView",setup(n){Ye.setOptions({breaks:!0,gfm:!0});const e=Ze(),s=L(null),o=L(!1),a=L("raw");let c=null;const d=_(()=>e.fullViewOpen),f=_(()=>e.currentFullViewResource),m=_(()=>e.currentResourceIndex),p=_(()=>e.fullViewTotalResources),u=_(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),w=_(()=>e.isImageResource(f.value)),v=_(()=>f.value?e.getTextContent(f.value.resource_id):null),k=_(()=>v.value?.content||null),S=_(()=>v.value?.loading||!1),b=_(()=>v.value?.error||null),g=_(()=>{if(!k.value)return"";let R=Ye.parse(k.value);return R=R.replace(/\n</g,"<"),R=R.replace(/\n+$/,""),Wt.sanitize(R)});ve(d,R=>{R?(dt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),ve(m,()=>{a.value="raw"}),ve([m,d],()=>{if(d.value&&f.value&&!w.value){const R=f.value.resource_id,F=e.getTextContent(R);(!F||F.error)&&e.fetchTextContent(e.fullViewSessionId,R)}},{immediate:!0}),De(()=>{document.body.style.overflow="",c&&clearTimeout(c)});function h(R){return e.getResourceUrl(e.fullViewSessionId,R)}function i(){e.closeFullView()}function $(){e.nextResource()}function x(){e.prevResource()}function N(R){e.goToResource(R)}function M(R){R.target===R.currentTarget&&i()}function A(R){switch(R.key){case"Escape":i();break;case"ArrowLeft":x();break;case"ArrowRight":$();break;case"Home":N(0);break;case"End":N(p.value-1);break;case"m":!w.value&&k.value&&(a.value=a.value==="raw"?"markdown":"raw");break}}async function E(){if(k.value)try{await navigator.clipboard.writeText(k.value),o.value=!0,c&&clearTimeout(c),c=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function C(R){return R?R<1024?`${R} B`:R<1024*1024?`${(R/1024).toFixed(1)} KB`:`${(R/(1024*1024)).toFixed(2)} MB`:""}function O(R){return R?new Date(R*1e3).toLocaleString():""}function z(R){R.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(R,F)=>(l(),Te(Ao,{to:"body"},[be(To,{name:"modal"},{default:un(()=>[d.value?(l(),r("div",{key:0,class:"resource-full-view-overlay",onClick:M,onKeydown:A,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ye(i,["stop"]),title:"Close (Escape)"},[...F[4]||(F[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(l(),r("button",{key:0,class:"nav-btn nav-prev",onClick:ye(x,["stop"]),title:"Previous (Left Arrow)"},[...F[5]||(F[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):T("",!0),w.value?(l(),r("div",{key:1,class:"image-container",onClick:F[0]||(F[0]=ye(()=>{},["stop"]))},[f.value?(l(),r("img",{key:0,src:h(f.value.resource_id||f.value.image_id),alt:f.value.title||"Image",class:"full-image",onError:z},null,40,Og)):T("",!0),f.value?(l(),r("div",Ng,[f.value.title?(l(),r("h5",Lg,y(f.value.title),1)):T("",!0),f.value.description?(l(),r("p",Ig,y(f.value.description),1)):T("",!0),t("div",jg,[t("span",Pg,y(C(f.value.size_bytes)),1),t("span",Rg,y(f.value.format?.toUpperCase()),1),t("span",Bg,y(O(f.value.timestamp)),1)])])):T("",!0)])):(l(),r("div",{key:2,class:"text-container",onClick:F[3]||(F[3]=ye(()=>{},["stop"]))},[t("div",Fg,[t("div",Vg,[t("h5",Wg,y(f.value?.title||f.value?.original_filename||"Text Resource"),1),t("div",Ug,[f.value?.size_bytes?(l(),r("span",Hg,y(C(f.value.size_bytes)),1)):T("",!0),f.value?.format?(l(),r("span",qg,y(f.value.format.toUpperCase()),1)):T("",!0)])]),k.value?(l(),r("div",zg,[t("button",{class:K(["toggle-btn",{active:a.value==="raw"}]),onClick:F[1]||(F[1]=ye(W=>a.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:K(["toggle-btn",{active:a.value==="markdown"}]),onClick:F[2]||(F[2]=ye(W=>a.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):T("",!0),t("button",{class:"copy-btn",onClick:ye(E,["stop"]),title:o.value?"Copied!":a.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!k.value},[o.value?(l(),r("svg",Gg,[...F[6]||(F[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),r("svg",Yg,[...F[7]||(F[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Jg,y(o.value?"Copied!":a.value==="markdown"?"Copy raw":"Copy"),1)],8,Kg)]),t("div",Qg,[S.value?(l(),r("div",Xg,[...F[8]||(F[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):b.value?(l(),r("div",Zg," Failed to load content: "+y(b.value),1)):k.value&&a.value==="raw"?(l(),r("pre",eb,y(k.value),1)):k.value&&a.value==="markdown"?(l(),r("div",{key:3,class:"markdown-content",innerHTML:g.value},null,8,tb)):(l(),r("div",sb," Preview not available for this file type. "))])])),p.value>1?(l(),r("button",{key:3,class:"nav-btn nav-next",onClick:ye($,["stop"]),title:"Next (Right Arrow)"},[...F[9]||(F[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):T("",!0),p.value>1?(l(),r("div",nb,y(m.value+1)+" / "+y(p.value),1)):T("",!0),p.value>1?(l(),r("div",ob,[(l(!0),r(oe,null,de(u.value,(W,J)=>(l(),r("div",{key:W.resource_id||W.image_id,class:K(["strip-thumbnail",{active:J===m.value,"is-text":!ae(e).isImageResource(W)}]),onClick:ye(ie=>N(J),["stop"])},[ae(e).isImageResource(W)?(l(),r("img",{key:0,src:h(W.resource_id||W.image_id),alt:W.title||"Thumbnail",loading:"lazy"},null,8,ib)):(l(),r("span",lb,y(ae(e).getResourceIcon(W)),1))],10,ab))),128))])):T("",!0)],544)):T("",!0)]),_:1})]))}},cb=ne(rb,[["__scopeId","data-v-169421b1"]]),ub={class:"diff-panel"},db={class:"diff-body"},fb={key:0,class:"text-center py-4"},mb={key:1,class:"empty-placeholder"},pb={key:2,class:"empty-placeholder"},vb={key:3,class:"text-danger text-center py-4"},hb={class:"mb-0 small"},_b={key:4,class:"empty-placeholder"},gb=["disabled"],bb={key:5},yb={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},wb=["disabled"],kb={class:"stats-bar px-3 py-1 border-bottom small text-muted"},$b={class:"text-success"},Sb={class:"text-danger"},xb={class:"ms-2"},Cb={key:0,class:"ms-2"},Eb={key:0,class:"file-list"},Tb=["onClick"],Ab=["title"],Db={key:0,class:"file-stats small text-nowrap"},Mb={key:0,class:"text-success"},Ob={key:1,class:"text-muted"},Nb={key:2,class:"text-danger"},Lb={key:1,class:"file-stats small text-muted"},Ib={key:1,class:"commit-list"},jb=["onClick"],Pb={key:0,class:"wip-badge"},Rb={key:1,class:"commit-hash"},Bb=["title"],Fb={key:2,class:"commit-date small text-muted text-nowrap"},Vb={key:0,class:"commit-files"},Wb=["onClick"],Ub=["title"],Hb={key:6,class:"empty-placeholder"},qb={__name:"DiffPanel",setup(n){const e=dn(),s=he(),o=L(new Set);function a(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function c(u,w=null){s.currentSessionId&&e.openFullView(s.currentSessionId,u,w)}function d(u){o.value.has(u)?o.value.delete(u):o.value.add(u),o.value=new Set(o.value)}function f(u){switch(u){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function m(u){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[u]?.status||"modified"}function p(u){if(!u)return"";const w=new Date(u),k=new Date-w,S=Math.floor(k/6e4);if(S<1)return"just now";if(S<60)return`${S}m ago`;const b=Math.floor(S/60);return b<24?`${b}h ago`:`${Math.floor(b/24)}d ago`}return ve(()=>s.currentSessionId,u=>{u&&!e.diffBySession.get(u)&&e.loadDiff(u)},{immediate:!0}),ve(()=>e.currentDiff,u=>{if(u?.commits){const w=u.commits.find(v=>v.is_uncommitted);w&&(o.value.add(w.hash),o.value=new Set(o.value))}},{immediate:!0}),(u,w)=>(l(),r("div",ub,[t("div",db,[ae(e).loading&&!ae(e).currentDiff?(l(),r("div",fb,[...w[2]||(w[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):ae(e).currentDiff&&!ae(e).isGitRepo?(l(),r("div",mb,[...w[3]||(w[3]=[t("span",null,"Not a git repository",-1)])])):ae(e).currentDiff&&ae(e).currentDiff.error?(l(),r("div",pb,[t("span",null,y(ae(e).currentDiff.error),1)])):ae(e).error?(l(),r("div",vb,[t("p",hb,y(ae(e).error),1)])):ae(e).currentDiff&&ae(e).fileCount===0?(l(),r("div",_b,[w[6]||(w[6]=t("span",null,"No changes since main",-1)),t("button",{class:"refresh-inline",onClick:a,disabled:ae(e).loading,title:"Refresh diff"},[(l(),r("svg",{class:K({spin:ae(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...w[4]||(w[4]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2)),w[5]||(w[5]=fe(" Refresh ",-1))],8,gb)])):ae(e).currentDiff&&ae(e).fileCount>0?(l(),r("div",bb,[t("div",yb,[t("button",{class:K(["btn btn-sm",ae(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:w[0]||(w[0]=v=>ae(e).setMode("total"))}," Total Changes ",2),t("button",{class:K(["btn btn-sm",ae(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:w[1]||(w[1]=v=>ae(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:a,title:"Refresh diff",disabled:ae(e).loading},[(l(),r("svg",{class:K({spin:ae(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...w[7]||(w[7]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,wb)]),t("div",kb,[t("span",$b,"+"+y(ae(e).currentDiff.total_insertions),1),w[8]||(w[8]=t("span",{class:"mx-1"},"/",-1)),t("span",Sb,"-"+y(ae(e).currentDiff.total_deletions),1),t("span",xb,y(ae(e).fileCount)+" file"+y(ae(e).fileCount!==1?"s":""),1),ae(e).commitCount>0?(l(),r("span",Cb,y(ae(e).commitCount)+" commit"+y(ae(e).commitCount!==1?"s":""),1)):T("",!0)]),ae(e).currentMode==="total"?(l(),r("div",Eb,[(l(!0),r(oe,null,de(ae(e).currentFiles,v=>(l(),r("div",{key:v.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:k=>c(v.path,"uncommitted")},[t("span",{class:K(["status-icon","status-"+v.status])},y(f(v.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:v.path},y(v.path),9,Ab),v.is_binary?(l(),r("span",Lb,"binary")):(l(),r("span",Db,[v.insertions>0?(l(),r("span",Mb,"+"+y(v.insertions),1)):T("",!0),v.insertions>0&&v.deletions>0?(l(),r("span",Ob,"/")):T("",!0),v.deletions>0?(l(),r("span",Nb,"-"+y(v.deletions),1)):T("",!0)]))],8,Tb))),128))])):(l(),r("div",Ib,[(l(!0),r(oe,null,de(ae(e).currentDiff.commits,v=>(l(),r("div",{key:v.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:k=>d(v.hash)},[(l(),r("svg",{class:K(["chevron-icon",{expanded:o.value.has(v.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...w[9]||(w[9]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),v.is_uncommitted?(l(),r("span",Pb,"WIP")):(l(),r("code",Rb,y(v.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:v.message},y(v.message),9,Bb),v.is_uncommitted?T("",!0):(l(),r("span",Fb,y(p(v.date)),1))],8,jb),o.value.has(v.hash)?(l(),r("div",Vb,[(l(!0),r(oe,null,de(v.files,k=>(l(),r("div",{key:k,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:S=>c(k,v.is_uncommitted?"uncommitted":null)},[t("span",{class:K(["status-icon","status-"+m(k)])},y(f(m(k))),3),t("span",{class:"file-path text-truncate small",title:k},y(k),9,Ub)],8,Wb))),128))])):T("",!0)]))),128))]))])):(l(),r("div",Hb,[...w[10]||(w[10]=[t("span",null,"No diff data available",-1)])]))])]))}},zb=ne(qb,[["__scopeId","data-v-67e039dc"]]),Kb={class:"diff-header"},Gb={class:"diff-header-info"},Yb={class:"diff-filename"},Jb={class:"diff-meta"},Qb={key:1,class:"meta-item"},Xb={class:"text-success"},Zb={class:"text-danger"},ey=["title","disabled"],ty={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},sy={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ny={class:"copy-label"},oy={class:"diff-body"},ay={key:0,class:"diff-loading"},iy={key:1,class:"diff-error"},ly={key:2,class:"diff-content"},ry={class:"diff-table"},cy={class:"line-num line-num-old"},uy={class:"line-num line-num-new"},dy={class:"line-content"},fy={class:"line-prefix"},my={key:3,class:"diff-empty"},py={key:2,class:"position-indicator"},vy={__name:"DiffFullView",setup(n){const e=dn(),s=L(null),o=L(!1);let a=null;const c=_(()=>e.fullViewOpen),d=_(()=>e.currentFullViewFileDiff),f=_(()=>d.value?.content||null),m=_(()=>e.currentFiles.length),p=_(()=>e.currentFilePath?e.currentFiles.findIndex(h=>h.path===e.currentFilePath):0),u=_(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),w=_(()=>{if(!f.value)return[];const h=f.value.split(`
`),i=[];let $=0,x=0;for(const N of h){if(N.startsWith("diff --git")||N.startsWith("index ")||N.startsWith("---")||N.startsWith("+++")||N.startsWith("new file")||N.startsWith("deleted file")||N.startsWith("similarity")||N.startsWith("rename")||N.startsWith("Binary")){N.startsWith("Binary")&&i.push({type:"info",prefix:"",text:N,oldNum:null,newNum:null});continue}if(N.startsWith("@@")){const M=N.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);M&&($=parseInt(M[1]),x=parseInt(M[2]),i.push({type:"hunk",prefix:"",text:N,oldNum:null,newNum:null}));continue}N.startsWith(" ")||N.length>0&&!N.startsWith("+")&&!N.startsWith("-")&&!N.startsWith("\\")?(i.push({type:"context",prefix:" ",text:N.substring(1),oldNum:$,newNum:x}),$++,x++):N.startsWith("+")?(i.push({type:"add",prefix:"+",text:N.substring(1),oldNum:null,newNum:x}),x++):N.startsWith("-")?(i.push({type:"remove",prefix:"-",text:N.substring(1),oldNum:$,newNum:null}),$++):N.startsWith("\\")&&i.push({type:"info",prefix:"",text:N,oldNum:null,newNum:null})}return i});function v(h){return`diff-line diff-line-${h.type}`}function k(){e.closeFullView()}function S(h){h.target===h.currentTarget&&k()}function b(h){switch(h.key){case"Escape":k();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function g(){if(f.value)try{await navigator.clipboard.writeText(f.value),o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return ve(c,h=>{h?(dt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),De(()=>{document.body.style.overflow="",a&&clearTimeout(a)}),(h,i)=>(l(),Te(Ao,{to:"body"},[be(To,{name:"modal"},{default:un(()=>[c.value?(l(),r("div",{key:0,class:"diff-full-view-overlay",onClick:S,onKeydown:b,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ye(k,["stop"]),title:"Close (Escape)"},[...i[3]||(i[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(l(),r("button",{key:0,class:"nav-btn nav-prev",onClick:i[0]||(i[0]=ye($=>ae(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...i[4]||(i[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):T("",!0),t("div",{class:"diff-container",onClick:i[1]||(i[1]=ye(()=>{},["stop"]))},[t("div",Kb,[t("div",Gb,[t("h5",Yb,y(ae(e).currentFilePath),1),t("div",Jb,[u.value?(l(),r("span",{key:0,class:K(["meta-badge","status-"+u.value.status])},y(u.value.status),3)):T("",!0),u.value&&!u.value.is_binary?(l(),r("span",Qb,[t("span",Xb,"+"+y(u.value.insertions),1),i[5]||(i[5]=fe(" / ",-1)),t("span",Zb,"-"+y(u.value.deletions),1)])):T("",!0)])]),t("button",{class:"copy-btn",onClick:ye(g,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!f.value},[o.value?(l(),r("svg",ty,[...i[6]||(i[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),r("svg",sy,[...i[7]||(i[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",ny,y(o.value?"Copied!":"Copy"),1)],8,ey)]),t("div",oy,[d.value&&d.value.loading?(l(),r("div",ay,[...i[8]||(i[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):d.value&&d.value.error?(l(),r("div",iy," Failed to load diff: "+y(d.value.error),1)):f.value?(l(),r("div",ly,[t("table",ry,[t("tbody",null,[(l(!0),r(oe,null,de(w.value,($,x)=>(l(),r("tr",{key:x,class:K(v($))},[t("td",cy,y($.oldNum||""),1),t("td",uy,y($.newNum||""),1),t("td",dy,[t("span",fy,y($.prefix),1),t("span",null,y($.text),1)])],2))),128))])])])):(l(),r("div",my," No diff available for this file. "))])]),m.value>1?(l(),r("button",{key:1,class:"nav-btn nav-next",onClick:i[2]||(i[2]=ye($=>ae(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...i[9]||(i[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):T("",!0),m.value>1?(l(),r("div",py,y(p.value+1)+" / "+y(m.value),1)):T("",!0)],544)):T("",!0)]),_:1})]))}},hy=ne(vy,[["__scopeId","data-v-d13809ae"]]),_y={class:"comms-panel"},gy={key:0,class:"empty-placeholder"},by=["onClick"],yy={class:"comm-meta"},wy={class:"comm-icon"},ky={class:"comm-type"},$y={class:"comm-direction"},Sy={class:"comm-time"},xy={class:"comm-summary"},Cy=["innerHTML"],Ey="ffffffff-ffff-ffff-ffff-ffffffffffff",Ty="00000000-0000-0000-0000-000000000000",Ay={__name:"CommsPanel",setup(n){const e=he(),s=Ut(),o=rt(),a=L(null),c=L(new Set);let d=null;Ye.setOptions({breaks:!0,gfm:!0});const f=_(()=>e.currentSession?.project_id||null),m=_(()=>e.currentSessionId),p=_(()=>{if(!f.value)return[];const M=s.commsByLegion.get(f.value)||[],A=m.value;return A?M.filter(E=>E.from_minion_id===A||E.to_minion_id===A):[]}),u=[{bg:"#fef3c7",border:"#fde68a"},{bg:"#fce7f3",border:"#fbcfe8"},{bg:"#e0e7ff",border:"#c7d2fe"},{bg:"#d1fae5",border:"#a7f3d0"},{bg:"#ede9fe",border:"#ddd6fe"},{bg:"#fee2e2",border:"#fecaca"},{bg:"#cffafe",border:"#a5f3fc"},{bg:"#fef9c3",border:"#fef08a"}],w=new Map;function v(M){if(!M)return null;if(w.has(M))return w.get(M);let A=0;for(let O=0;O<M.length;O++)A=(A<<5)-A+M.charCodeAt(O)|0;const E=Math.abs(A)%u.length,C=u[E];return w.set(M,C),C}function k(M){const A=M.from_minion_id;if(A===Ey)return{background:"#f1f5f9",borderColor:"#e2e8f0",opacity:.8};if(M.from_user||A===Ty)return{background:"#eef2ff",borderColor:"#e0e7ff"};if(A===m.value)return{background:"#f8fafc",borderColor:"#e2e8f0"};const E=v(A);return E?{background:E.bg,borderColor:E.border}:{background:"#f8fafc",borderColor:"#e2e8f0"}}function S(M){return{task:"ðŸ“‹",question:"â“",report:"ðŸ“Š",info:"ðŸ’¡",system:"âš™ï¸",halt:"ðŸ›‘",pivot:"ðŸ›‘",spawn:"ðŸŒŸ",dispose:"ðŸ—‘ï¸",thought:"ðŸ’­"}[M]||"ðŸ’¬"}function b(M){return M?M.charAt(0).toUpperCase()+M.slice(1):""}function g(M){const A=M.from_minion_name||(M.from_user?"User":"System"),E=M.to_minion_name||(M.to_user?"User":"Unknown");return`${A} â†’ ${E}`}function h(M){return M.content&&M.content!==M.summary}function i(M,A){return M?M.length<=A?M:M.substring(0,A)+"...":""}function $(M){c.value.has(M)?c.value.delete(M):c.value.add(M),c.value=new Set(c.value)}function x(M){if(!M)return"";let A=Ye.parse(M);return A=A.replace(/\n</g,"<"),A=A.replace(/\n+$/,""),Wt.sanitize(A)}ve(()=>p.value.length,async()=>{await dt(),a.value&&(a.value.scrollTop=a.value.scrollHeight)});function N(M){M&&d!==M&&(d&&o.disconnectLegion(),d=M,s.setCurrentLegion(M),s.loadTimeline(M),o.connectLegion(M))}return ve(f,M=>{M&&N(M)},{immediate:!0}),Me(()=>{f.value&&N(f.value)}),De(()=>{d&&(o.disconnectLegion(),d=null)}),(M,A)=>(l(),r("div",_y,[p.value.length===0?(l(),r("div",gy,[...A[0]||(A[0]=[t("span",null,"Communication between this session's minions will appear here",-1)])])):(l(),r("div",{key:1,class:"comms-list",ref_key:"commsList",ref:a},[(l(!0),r(oe,null,de(p.value,E=>(l(),r("div",{key:E.comm_id,class:K(["comm-item",{expandable:h(E)}]),style:Pe(k(E)),onClick:C=>h(E)&&$(E.comm_id)},[t("div",yy,[t("span",wy,y(S(E.comm_type)),1),t("span",ky,y(b(E.comm_type)),1),t("span",$y,y(g(E)),1),t("span",Sy,y(ae(ss)(E.timestamp)),1),h(E)?(l(),r("svg",{key:0,class:K(["expand-chevron",{expanded:c.value.has(E.comm_id)}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[...A[1]||(A[1]=[t("path",{d:"M4.5 2.5L8 6L4.5 9.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)):T("",!0)]),t("div",xy,y(E.summary||i(E.content,120)),1),c.value.has(E.comm_id)?(l(),r("div",{key:0,class:"comm-content",innerHTML:x(E.content)},null,8,Cy)):T("",!0)],14,by))),128))],512))]))}},Dy=ne(Ay,[["__scopeId","data-v-79e3a8cb"]]),My={class:"sidebar-tabs"},Oy=["onClick"],Ny={key:0,class:"tab-badge"},Ly={class:"tab-content-container"},Iy={__name:"RightSidebar",setup(n){const e=xe(),s=Lt(),o=Ze(),a=dn(),c=Ut(),d=he(),f=_(()=>e.rightSidebarActiveTab),m=_(()=>s.currentTaskStats),p=_(()=>o.currentResourceCount),u=_(()=>a.fileCount),w=_(()=>{const $=d.currentSession?.project_id,x=d.currentSessionId;return!$||!x?0:(c.commsByLegion.get($)||[]).filter(M=>M.from_minion_id===x||M.to_minion_id===x).length}),v=_(()=>[{id:"diff",label:"Diff",badge:u.value},{id:"tasks",label:"Tasks",badge:m.value.total>0?m.value.total:0},{id:"resources",label:"Resources",badge:p.value},{id:"comms",label:"Comms",badge:w.value}]),k=_(()=>e.windowWidth<=1024),S=_(()=>k.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),b=L(!1);function g($){$.preventDefault(),b.value=!0,document.addEventListener("mousemove",h),document.addEventListener("mouseup",i)}function h($){if(b.value){const x=window.innerWidth-$.clientX;e.setRightSidebarWidth(x)}}function i(){b.value=!1,document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",i)}return($,x)=>(l(),r("aside",{id:"right-sidebar",class:K(["right-sidebar",{resizing:b.value,"theme-red-panel":ae(e).isRedBackground}]),style:Pe(S.value)},[be(J_),t("div",My,[(l(!0),r(oe,null,de(v.value,N=>(l(),r("button",{key:N.id,class:K(["sidebar-tab",{active:f.value===N.id}]),onClick:M=>ae(e).setRightSidebarTab(N.id)},[fe(y(N.label)+" ",1),N.badge>0?(l(),r("span",Ny,y(N.badge),1)):T("",!0)],10,Oy))),128))]),t("div",Ly,[Se(be(zb,null,null,512),[[nt,f.value==="diff"]]),Se(be(pg,null,null,512),[[nt,f.value==="tasks"]]),Se(be(Mg,null,null,512),[[nt,f.value==="resources"]]),Se(be(Dy,null,null,512),[[nt,f.value==="comms"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:g},null,32),be(cb),be(hy)],6))}},jy=ne(Iy,[["__scopeId","data-v-ee26fc9d"]]),Py={class:"modal-dialog modal-lg"},Ry={class:"modal-content"},By={class:"modal-body"},Fy={class:"mb-3"},Vy={class:"input-group"},Wy=["disabled"],Uy={key:0,class:"text-center py-4"},Hy={key:1,class:"alert alert-danger",role:"alert"},qy={key:2,class:"folder-list"},zy=["onClick","onDblclick"],Ky={class:"d-flex align-items-center flex-grow-1"},Gy=["onClick"],Yy={key:1,class:"text-center text-muted py-3"},Jy={class:"modal-footer"},Qy=["disabled"],Xy={__name:"FolderBrowserModal",setup(n){const e=xe(),s=L(""),o=L(""),a=L([]),c=L(!1),d=L(""),f=L(null);let m=null,p=null;const u=_(()=>{if(!s.value)return null;const $=s.value.split(/[\\/]/).filter(Boolean);return $.length<=1?null:($.pop(),$.length>0?"/"+$.join("/"):"/")});function w($){if(!$)return"";const x=$.split(/[\\/]/).filter(Boolean);return x.length<=2?$:".../"+x.slice(-2).join("/")}async function v(){c.value=!0,d.value="",a.value=[],o.value="";try{const $=s.value?{path:s.value}:{},x=await ke.get("/api/filesystem/browse",{params:$});x.current_path&&(s.value=x.current_path),a.value=x.directories||[]}catch($){console.error("Failed to load directory:",$),d.value=$.message||"Failed to load directory"}finally{c.value=!1}}function k($){o.value=$.path}function S($){s.value=$.path,o.value="",v()}function b(){u.value&&(s.value=u.value,o.value="",v())}function g(){const $=o.value||s.value;$&&p&&p($),m&&m.hide()}function h(){v()}function i(){a.value=[],o.value="",d.value="",p=null,e.hideModal()}return ve(()=>e.currentModal,$=>{if($?.name==="folder-browser"&&m){const x=$.data||{};s.value=x.defaultPath||x.currentPath||"",p=x.onSelect||null,m.show()}}),Me(()=>{f.value&&Ie(async()=>{const{default:$}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:$}},__vite__mapDeps([0,1])).then(({default:$})=>{m=new $(f.value),f.value.addEventListener("shown.bs.modal",h),f.value.addEventListener("hidden.bs.modal",i)})}),De(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",h),f.value.removeEventListener("hidden.bs.modal",i)),m&&m.dispose()}),($,x)=>(l(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[t("div",Py,[t("div",Ry,[x[6]||(x[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",By,[t("div",Fy,[x[1]||(x[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Vy,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=N=>s.value=N),onKeyup:bs(v,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:v,disabled:c.value}," ðŸ”„ Refresh ",8,Wy)])]),c.value?(l(),r("div",Uy,[...x[2]||(x[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value?(l(),r("div",Hy,y(d.value),1)):(l(),r("div",qy,[u.value?(l(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...x[3]||(x[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):T("",!0),(l(!0),r(oe,null,de(a.value,N=>(l(),r("div",{key:N.path,class:K(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:N.path===o.value}]),onClick:M=>k(N),onDblclick:M=>S(N),role:"button"},[t("div",Ky,[x[4]||(x[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,y(N.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ye(M=>S(N),["stop"])}," Open ",8,Gy)],42,zy))),128)),a.value.length===0?(l(),r("div",Yy," No subdirectories found ")):T("",!0)]))]),t("div",Jy,[x[5]||(x[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:!o.value},' Select "'+y(w(o.value||s.value))+'" ',9,Qy)])])])],512))}},Zy=ne(Xy,[["__scopeId","data-v-0d61ed46"]]),e1={class:"modal-dialog"},t1={class:"modal-content"},s1={class:"modal-body"},n1={class:"mb-3"},o1={key:0,class:"invalid-feedback"},a1={class:"mb-3"},i1={class:"input-group"},l1={key:0,class:"invalid-feedback"},r1={class:"mb-3 form-check"},c1={key:0,class:"mb-3 ms-4"},u1={key:1,class:"alert alert-danger",role:"alert"},d1={class:"modal-footer"},f1=["disabled"],m1={key:0,class:"spinner-border spinner-border-sm me-2"},p1={__name:"ProjectCreateModal",setup(n){const e=ze(),s=he(),o=xe(),a=L({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),c=L({name:"",workingDirectory:""}),d=L(!1),f=L(""),m=L(null);let p=null;function u(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:g=>{a.value.workingDirectory=g,c.value.workingDirectory=""}})}function w(){c.value={};let g=!0;return a.value.name.trim()||(c.value.name="Project name is required",g=!1),a.value.workingDirectory.trim()||(c.value.workingDirectory="Working directory is required",g=!1),g}async function v(){if(w()){d.value=!0,f.value="";try{const g=await e.createProject(a.value.name,a.value.workingDirectory);a.value.createSession&&await s.createSession(g.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),k()}catch(g){console.error("Failed to create project:",g),f.value=g.message||"Failed to create project. Please try again."}finally{d.value=!1}}}function k(){a.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},c.value={},f.value=""}function S(){const g=document.getElementById("projectName");g&&g.focus()}function b(){k(),o.hideModal()}return ve(()=>o.currentModal,g=>{g?.name==="create-project"&&p&&p.show()}),Me(()=>{m.value&&Ie(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{p=new g(m.value),m.value.addEventListener("shown.bs.modal",S),m.value.addEventListener("hidden.bs.modal",b)})}),De(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",S),m.value.removeEventListener("hidden.bs.modal",b)),p&&p.dispose()}),(g,h)=>(l(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",e1,[t("div",t1,[h[11]||(h[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",s1,[t("form",{onSubmit:ye(v,["prevent"])},[t("div",n1,[h[4]||(h[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),Se(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=i=>a.value.name=i),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),c.value.name?(l(),r("div",o1,y(c.value.name),1)):T("",!0)]),t("div",a1,[h[5]||(h[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",i1,[Se(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=i=>a.value.workingDirectory=i),placeholder:"/path/to/project",required:""},null,2),[[We,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),c.value.workingDirectory?(l(),r("div",l1,y(c.value.workingDirectory),1)):T("",!0)]),h[6]||(h[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",r1,[Se(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=i=>a.value.createSession=i)},null,512),[[Co,a.value.createSession]]),h[7]||(h[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),a.value.createSession?(l(),r("div",c1,[h[9]||(h[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),Se(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=i=>a.value.sessionName=i),placeholder:"main"},null,512),[[We,a.value.sessionName]])])):T("",!0),f.value?(l(),r("div",u1,y(f.value),1)):T("",!0)],32)]),t("div",d1,[h[10]||(h[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:d.value},[d.value?(l(),r("span",m1)):T("",!0),fe(" "+y(d.value?"Creating...":"Create Project"),1)],8,f1)])])])],512))}},v1=ne(p1,[["__scopeId","data-v-ea55fdae"]]),h1={class:"modal-dialog"},_1={class:"modal-content"},g1={class:"modal-body"},b1={class:"mb-3"},y1={key:0,class:"invalid-feedback"},w1={class:"mb-3"},k1=["value"],$1={key:0,class:"alert alert-danger",role:"alert"},S1={class:"danger-zone"},x1={class:"text-muted small"},C1=["disabled"],E1={key:0,class:"alert alert-warning mt-3",role:"alert"},T1={class:"mb-2"},A1={class:"d-flex gap-2"},D1=["disabled"],M1={key:0,class:"spinner-border spinner-border-sm me-2"},O1=["disabled"],N1={class:"modal-footer"},L1=["disabled"],I1={key:0,class:"spinner-border spinner-border-sm me-2"},j1={__name:"ProjectEditModal",setup(n){const e=ze(),s=xe(),o=L(null),a=L({name:""}),c=L({name:""}),d=L(!1),f=L(!1),m=L(""),p=L(!1),u=L(null);let w=null;const v=_(()=>o.value?.session_ids?.length||0);function k(){c.value={};let $=!0;return a.value.name.trim()||(c.value.name="Project name is required",$=!1),$}async function S(){if(!(!k()||!o.value)){d.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),w&&w.hide()}catch($){console.error("Failed to update project:",$),m.value=$.message||"Failed to update project. Please try again."}finally{d.value=!1}}}async function b(){if(o.value){f.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch($){console.error("Failed to delete project:",$),m.value=$.message||"Failed to delete project. Please try again."}finally{f.value=!1}}}function g(){a.value={name:""},c.value={},m.value="",p.value=!1}function h(){const $=document.getElementById("editProjectName");$&&($.focus(),$.select())}function i(){g(),o.value=null,s.hideModal()}return ve(()=>s.currentModal,$=>{if($?.name==="edit-project"&&w){const x=$.data||{};o.value=x.project,o.value&&(a.value.name=o.value.name),w.show()}}),Me(()=>{u.value&&Ie(async()=>{const{default:$}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:$}},__vite__mapDeps([0,1])).then(({default:$})=>{w=new $(u.value),u.value.addEventListener("shown.bs.modal",h),u.value.addEventListener("hidden.bs.modal",i)})}),De(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",h),u.value.removeEventListener("hidden.bs.modal",i)),w&&w.dispose()}),($,x)=>(l(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",h1,[t("div",_1,[x[10]||(x[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",g1,[t("form",{onSubmit:ye(S,["prevent"])},[t("div",b1,[x[3]||(x[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),Se(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.name}]),id:"editProjectName","onUpdate:modelValue":x[0]||(x[0]=N=>a.value.name=N),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),c.value.name?(l(),r("div",y1,y(c.value.name),1)):T("",!0)]),t("div",w1,[x[4]||(x[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,k1),x[5]||(x[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(l(),r("div",$1,y(m.value),1)):T("",!0)],32),x[8]||(x[8]=t("hr",null,null,-1)),t("div",S1,[x[6]||(x[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",x1," Deleting this project will also delete all "+y(v.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x[1]||(x[1]=N=>p.value=!0),disabled:f.value}," ðŸ—‘ï¸ Delete Project ",8,C1)]),p.value?(l(),r("div",E1,[x[7]||(x[7]=t("strong",null,"Are you sure?",-1)),t("p",T1,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(v.value)+" session(s). ",1),t("div",A1,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:f.value},[f.value?(l(),r("span",M1)):T("",!0),fe(" "+y(f.value?"Deleting...":"Yes, Delete Permanently"),1)],8,D1),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:x[2]||(x[2]=N=>p.value=!1),disabled:f.value}," Cancel ",8,O1)])])):T("",!0)]),t("div",N1,[x[9]||(x[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:S,disabled:d.value},[d.value?(l(),r("span",I1)):T("",!0),fe(" "+y(d.value?"Saving...":"Save Changes"),1)],8,L1)])])])],512))}},P1=ne(j1,[["__scopeId","data-v-52679516"]]),R1={class:"general-tab"},B1={key:0,class:"mb-3"},F1={for:"template-select",class:"form-label"},V1=["value"],W1=["value"],U1={key:0,class:"form-text"},H1={class:"mb-3"},q1={for:"config-name",class:"form-label"},z1=["value","placeholder","pattern","title"],K1={key:0,class:"invalid-feedback"},G1={key:1,class:"form-text"},Y1={key:1,class:"mb-3"},J1=["value"],Q1={class:"mb-3"},X1=["value"],Z1={class:"form-text"},ew={key:0},tw={class:"mb-3"},sw={for:"config-permission-mode",class:"form-label"},nw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ow={key:1,class:"field-indicator modified",title:"Modified from template"},aw=["value","disabled"],iw={key:0,value:"bypassPermissions"},lw={class:"form-text"},rw={key:0,class:"text-warning"},cw={key:1},uw={class:"mb-3"},dw={for:"config-role",class:"form-label"},fw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},mw={key:1,class:"field-indicator modified",title:"Modified from template"},pw=["value","placeholder"],vw={class:"form-text"},hw={key:2,class:"mb-3"},_w={class:"input-group"},gw=["value","placeholder","disabled","readonly"],bw={class:"form-text"},yw={key:3,class:"mb-3"},ww={class:"form-control-plaintext"},kw={key:4,class:"mb-3 form-check"},$w=["checked"],Sw={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=_(()=>e.mode==="create-session"||e.mode==="edit-session"),o=_(()=>e.mode==="create-template"||e.mode==="edit-template"),a=_(()=>e.mode==="create-session"),c=_(()=>e.mode==="edit-session"),d=_(()=>e.session?.state==="active"||e.session?.state==="starting"),f=_(()=>e.session?.initial_permission_mode==="bypassPermissions"),m=_(()=>e.selectedTemplateId?e.templates.find(S=>S.template_id===e.selectedTemplateId):null),p={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},u=_(()=>p[e.formData.model]||null),w=_(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),v=_(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function k(S){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[S]||"bg-secondary"}return(S,b)=>(l(),r("div",R1,[a.value?(l(),r("div",B1,[t("label",F1,[b[10]||(b[10]=fe(" Template ",-1)),t("button",{type:"button",onClick:b[0]||(b[0]=g=>S.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:b[1]||(b[1]=g=>S.$emit("update:selected-template-id",g.target.value||null)),class:"form-select"},[b[11]||(b[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(l(!0),r(oe,null,de(n.templates,g=>(l(),r("option",{key:g.template_id,value:g.template_id},y(g.name),9,W1))),128))],40,V1),m.value?(l(),r("div",U1,y(m.value.description),1)):T("",!0)])):T("",!0),t("div",H1,[t("label",q1,[fe(y(o.value?"Template Name":"Session Name")+" ",1),b[12]||(b[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:K(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:b[2]||(b[2]=g=>S.$emit("update:form-data","name",g.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,z1),n.errors.name?(l(),r("div",K1,y(n.errors.name),1)):T("",!0),s.value?(l(),r("div",G1,"Must be a single word (no spaces) for #nametag matching")):T("",!0)]),o.value?(l(),r("div",Y1,[b[13]||(b[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:b[3]||(b[3]=g=>S.$emit("update:form-data","description",g.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,J1)])):T("",!0),t("div",Q1,[b[15]||(b[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:b[4]||(b[4]=g=>S.$emit("update:form-data","model",g.target.value))},[...b[14]||(b[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,X1),t("div",Z1,[u.value?(l(),r("span",ew,y(u.value.description),1)):T("",!0)])]),t("div",tw,[t("label",sw,[b[16]||(b[16]=fe(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(l(),r("span",nw," < ")):T("",!0),n.fieldStates.permission_mode==="modified"?(l(),r("span",ow," * ")):T("",!0)]),t("select",{id:"config-permission-mode",class:K(["form-select",v.value]),value:n.formData.permission_mode,onChange:b[5]||(b[5]=g=>S.$emit("update:form-data","permission_mode",g.target.value)),disabled:c.value&&!d.value},[b[17]||(b[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),b[18]||(b[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),b[19]||(b[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!c.value||f.value?(l(),r("option",iw," Bypass Permissions (No prompts - use with caution) ")):T("",!0)],42,aw),t("div",lw,[c.value&&!d.value?(l(),r("span",rw," Session must be active to change permission mode. Start the session first. ")):(l(),r("span",cw,"Controls which tool actions require permission prompts"))])]),t("div",uw,[t("label",dw,[fe(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(l(),r("span",fw," < ")):T("",!0),n.fieldStates.default_role==="modified"?(l(),r("span",mw," * ")):T("",!0)]),t("input",{id:"config-role",type:"text",class:K(["form-control",w.value]),value:n.formData.default_role,onInput:b[6]||(b[6]=g=>S.$emit("update:form-data","default_role",g.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,pw),t("div",vw,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(l(),r("div",hw,[b[20]||(b[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",_w,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:b[7]||(b[7]=g=>S.$emit("update:form-data","working_directory",g.target.value)),placeholder:c.value?"":"Leave empty to inherit from project",disabled:c.value,readonly:c.value},null,40,gw),c.value?T("",!0):(l(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:b[8]||(b[8]=g=>S.$emit("open-folder-browser"))}," Browse "))]),t("div",bw,y(c.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):T("",!0),c.value&&n.session?(l(),r("div",yw,[b[21]||(b[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",ww,[t("span",{class:K(["badge",k(n.session.state)])},y(n.session.state),3)])])):T("",!0),a.value?(l(),r("div",kw,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:b[9]||(b[9]=g=>S.$emit("update:form-data","startImmediately",g.target.checked))},null,40,$w),b[22]||(b[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):T("",!0)]))}},xw=ne(Sw,[["__scopeId","data-v-9f0e3252"]]),Cw={class:"permissions-tab"},Ew={class:"mb-3"},Tw={for:"config-allowed-tools",class:"form-label"},Aw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Dw={key:1,class:"field-indicator modified",title:"Modified from template"},Mw={key:0,class:"tools-list mb-2"},Ow=["onClick"],Nw={class:"input-group input-group-sm"},Lw=["onKeydown"],Iw=["disabled"],jw={class:"mt-2"},Pw=["onClick"],Rw={class:"form-text"},Bw={class:"mb-3"},Fw={for:"config-disallowed-tools",class:"form-label"},Vw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Ww={key:1,class:"field-indicator modified",title:"Modified from template"},Uw={key:0,class:"tools-list mb-2"},Hw=["onClick"],qw={class:"input-group input-group-sm"},zw=["onKeydown"],Kw=["disabled"],Gw={class:"mt-2"},Yw=["onClick"],Jw={class:"form-text"},Qw={key:0,class:"mb-3"},Xw={class:"settings-sources-editor"},Zw={class:"form-check"},ek=["checked"],tk={class:"form-check"},sk=["checked"],nk={class:"form-check"},ok=["checked"],ak={key:1,class:"mb-3"},ik={class:"mb-3"},lk={key:0,class:"mt-2"},rk=["value"],ck=["value"],uk={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,a=L(""),c=L(""),d=L(!1),f=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=_(()=>s.mode==="create-template"||s.mode==="edit-template"),p=_(()=>s.mode==="create-session"||s.mode==="edit-session"),u=_(()=>s.formData.setting_sources||["user","project","local"]),w=_(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(E=>E.trim()).filter(E=>E.length>0)),v=_(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(E=>E.trim()).filter(E=>E.length>0)),k=_(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),S=_(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),b=_(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),g=_(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function h(){const E=a.value.trim();if(E){if(!w.value.includes(E)){const C=[...w.value,E];o("update:form-data","allowed_tools",C.join(", "))}a.value=""}}function i(E){const C=[...w.value];C.splice(E,1),o("update:form-data","allowed_tools",C.join(", "))}function $(E){if(w.value.includes(E)){const C=w.value.indexOf(E);i(C)}else{const C=[...w.value,E];o("update:form-data","allowed_tools",C.join(", "))}}function x(){const E=c.value.trim();if(E){if(!v.value.includes(E)){const C=[...v.value,E];o("update:form-data","disallowed_tools",C.join(", "))}c.value=""}}function N(E){const C=[...v.value];C.splice(E,1),o("update:form-data","disallowed_tools",C.join(", "))}function M(E){if(v.value.includes(E)){const C=v.value.indexOf(E);N(C)}else{const C=[...v.value,E];o("update:form-data","disallowed_tools",C.join(", "))}}function A(E){const C=[...u.value],O=C.indexOf(E);O>=0?C.splice(O,1):C.push(E),o("update:form-data","setting_sources",C)}return(E,C)=>(l(),r("div",Cw,[t("div",Ew,[t("label",Tw,[C[9]||(C[9]=fe(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(l(),r("span",Aw," < ")):T("",!0),n.fieldStates.allowed_tools==="modified"?(l(),r("span",Dw," * ")):T("",!0)]),t("div",{class:K(["allowed-tools-editor",S.value])},[w.value.length>0?(l(),r("div",Mw,[(l(!0),r(oe,null,de(w.value,(O,z)=>(l(),r("span",{key:z,class:"badge bg-primary me-1 mb-1 tool-badge"},[fe(y(O)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:R=>i(z),"aria-label":"Remove tool"},null,8,Ow)]))),128))])):T("",!0),t("div",Nw,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=O=>a.value=O),onKeydown:bs(ye(h,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,Lw),[[We,a.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:h,disabled:!a.value.trim()}," Add ",8,Iw)]),t("div",jw,[C[10]||(C[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(l(),r(oe,null,de(f,O=>t("button",{key:O,type:"button",class:K(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":w.value.includes(O)}]),onClick:z=>$(O)},y(O),11,Pw)),64))])],2),t("div",Rw,y(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",Bw,[t("label",Fw,[C[11]||(C[11]=fe(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(l(),r("span",Vw," < ")):T("",!0),n.fieldStates.disallowed_tools==="modified"?(l(),r("span",Ww," * ")):T("",!0)]),t("div",{class:K(["disallowed-tools-editor",g.value])},[v.value.length>0?(l(),r("div",Uw,[(l(!0),r(oe,null,de(v.value,(O,z)=>(l(),r("span",{key:z,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[fe(y(O)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:R=>N(z),"aria-label":"Remove denied tool"},null,8,Hw)]))),128))])):T("",!0),t("div",qw,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[1]||(C[1]=O=>c.value=O),onKeydown:bs(ye(x,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,zw),[[We,c.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x,disabled:!c.value.trim()}," Deny ",8,Kw)]),t("div",Gw,[C[12]||(C[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(l(),r(oe,null,de(f,O=>t("button",{key:O,type:"button",class:K(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":v.value.includes(O)}]),onClick:z=>M(O)},y(O),11,Yw)),64))])],2),t("div",Jw,y(m.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),p.value?(l(),r("div",Qw,[C[16]||(C[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",Xw,[t("div",Zw,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:u.value.includes("user"),onChange:C[2]||(C[2]=O=>A("user"))},null,40,ek),C[13]||(C[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[fe(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",tk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:u.value.includes("project"),onChange:C[3]||(C[3]=O=>A("project"))},null,40,sk),C[14]||(C[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[fe(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",nk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:u.value.includes("local"),onChange:C[4]||(C[4]=O=>A("local"))},null,40,ok),C[15]||(C[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[fe(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),C[17]||(C[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):T("",!0),p.value?(l(),r("div",ak,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C[5]||(C[5]=O=>E.$emit("preview-permissions"))}," Preview Effective Permissions ")])):T("",!0),t("div",ik,[t("a",{class:"text-muted small",role:"button",onClick:C[6]||(C[6]=O=>d.value=!d.value)},y(d.value?"Hide":"Show")+" raw input ",1),d.value?(l(),r("div",lk,[C[18]||(C[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:K(["form-control form-control-sm",k.value]),value:n.formData.allowed_tools,onInput:C[7]||(C[7]=O=>E.$emit("update:form-data","allowed_tools",O.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,rk),C[19]||(C[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:K(["form-control form-control-sm",b.value]),value:n.formData.disallowed_tools,onInput:C[8]||(C[8]=O=>E.$emit("update:form-data","disallowed_tools",O.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,ck)])):T("",!0)])]))}},dk=ne(uk,[["__scopeId","data-v-cbec74ed"]]),fk={class:"advanced-tab"},mk={class:"mb-3"},pk={for:"config-system-prompt",class:"form-label"},vk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},hk={key:1,class:"field-indicator modified",title:"Modified from template"},_k=["value","rows","placeholder"],gk={class:"form-text"},bk={class:"mb-3 form-check"},yk=["checked"],wk={key:0,class:"form-text text-warning"},kk={class:"mb-3"},$k={class:"capabilities-editor"},Sk={key:0,class:"capabilities-list mb-2"},xk=["onClick"],Ck={class:"input-group input-group-sm"},Ek=["onKeydown"],Tk=["disabled"],Ak={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,a=_(()=>s.mode==="create-template"||s.mode==="edit-template"),c=_(()=>s.formData.initialization_context),d=_(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),f=_(()=>s.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),m=_(()=>{const S={};return s.fieldStates.initialization_context==="autofilled"&&(S["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(S["field-modified"]=!0),S}),p=L(""),u=_(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(S=>S.trim()).filter(S=>S.length>0));function w(S){const b=S.target.value;o("update:form-data","initialization_context",b)}function v(){const S=p.value.trim().toLowerCase();if(S){if(!u.value.includes(S)){const b=[...u.value,S];o("update:form-data","capabilities",b.join(", "))}p.value=""}}function k(S){const b=[...u.value];b.splice(S,1),o("update:form-data","capabilities",b.join(", "))}return(S,b)=>(l(),r("div",fk,[t("div",mk,[t("label",pk,[fe(y(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(l(),r("span",vk," < ")):T("",!0),n.fieldStates.initialization_context==="modified"?(l(),r("span",hk," * ")):T("",!0)]),t("textarea",{id:"config-system-prompt",class:K(["form-control",m.value]),value:c.value,onInput:w,rows:a.value?4:5,placeholder:d.value},null,42,_k),t("div",gk,y(f.value),1)]),t("div",bk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:b[0]||(b[0]=g=>S.$emit("update:form-data","override_system_prompt",g.target.checked))},null,40,yk),b[2]||(b[2]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(l(),r("div",wk,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(a.value?"":" or legion guide")+").",1)])):T("",!0)]),t("div",kk,[b[3]||(b[3]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",$k,[u.value.length>0?(l(),r("div",Sk,[(l(!0),r(oe,null,de(u.value,(g,h)=>(l(),r("span",{key:h,class:"badge bg-info me-1 mb-1 capability-badge"},[fe(y(g)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:i=>k(h),"aria-label":"Remove capability"},null,8,xk)]))),128))])):T("",!0),t("div",Ck,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":b[1]||(b[1]=g=>p.value=g),onKeydown:bs(ye(v,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,Ek),[[We,p.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:v,disabled:!p.value.trim()}," Add ",8,Tk)])]),b[4]||(b[4]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},Dk=ne(Ak,[["__scopeId","data-v-9ffdae4f"]]),Mk={class:"sandbox-tab"},Ok={class:"mb-3 form-check"},Nk=["checked"],Lk={class:"mb-2 form-check"},Ik=["checked","disabled"],jk={class:"mb-2 form-check"},Pk=["checked","disabled"],Rk={class:"mb-2"},Bk=["value","disabled"],Fk={class:"mb-3 form-check"},Vk=["checked","disabled"],Wk={class:"mb-2"},Uk=["value","disabled"],Hk={class:"mb-2 form-check"},qk=["checked","disabled"],zk={class:"mb-2"},Kk=["value","disabled"],Gk={class:"mb-3 form-check"},Yk=["checked","disabled"],Jk={class:"mb-2"},Qk=["value","disabled"],Xk={class:"mb-2"},Zk=["value","disabled"],e$={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(d,f){s.formData.sandbox[d]=f}function a(d,f){s.formData.sandbox.network[d]=f}function c(d,f){s.formData.sandbox.ignoreViolations[d]=f}return(d,f)=>(l(),r("div",Mk,[t("div",Ok,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:f[0]||(f[0]=m=>d.$emit("update:form-data","sandbox_enabled",m.target.checked))},null,40,Nk),f[11]||(f[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:K(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",Lk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:f[1]||(f[1]=m=>o("autoAllowBashIfSandboxed",m.target.checked))},null,40,Ik),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",jk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:f[2]||(f[2]=m=>o("allowUnsandboxedCommands",m.target.checked))},null,40,Pk),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",Rk,[t("label",{for:"config-sandbox-excluded-cmds",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:f[3]||(f[3]=m=>o("excludedCommands",m.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,Bk)]),t("div",Fk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:f[4]||(f[4]=m=>o("enableWeakerNestedSandbox",m.target.checked))},null,40,Vk),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",Wk,[t("label",{for:"config-sandbox-allowed-domains",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:f[5]||(f[5]=m=>a("allowedDomains",m.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,Uk)]),t("div",Hk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:f[6]||(f[6]=m=>a("allowLocalBinding",m.target.checked))},null,40,qk),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",zk,[t("label",{for:"config-sandbox-unix-sockets",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:f[7]||(f[7]=m=>a("allowUnixSockets",m.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,Kk)]),t("div",Gk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:f[8]||(f[8]=m=>a("allowAllUnixSockets",m.target.checked))},null,40,Yk),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",Jk,[t("label",{for:"config-sandbox-ignore-file",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:f[9]||(f[9]=m=>c("file",m.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,Qk)]),t("div",Xk,[t("label",{for:"config-sandbox-ignore-network",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:f[10]||(f[10]=m=>c("network",m.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,Zk)])]))}},t$=ne(e$,[["__scopeId","data-v-be109d12"]]);var Oe="top",Re="bottom",Be="right",Ne="left",Ss="auto",Ht=[Oe,Re,Be,Ne],kt="start",jt="end",No="clippingParents",fn="viewport",Dt="popper",Lo="reference",tn=Ht.reduce(function(n,e){return n.concat([e+"-"+kt,e+"-"+jt])},[]),mn=[].concat(Ht,[Ss]).reduce(function(n,e){return n.concat([e,e+"-"+kt,e+"-"+jt])},[]),Io="beforeRead",jo="read",Po="afterRead",Ro="beforeMain",Bo="main",Fo="afterMain",Vo="beforeWrite",Wo="write",Uo="afterWrite",Ho=[Io,jo,Po,Ro,Bo,Fo,Vo,Wo,Uo];function st(n){return n?(n.nodeName||"").toLowerCase():null}function Fe(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function $t(n){var e=Fe(n).Element;return n instanceof e||n instanceof Element}function Ue(n){var e=Fe(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function pn(n){if(typeof ShadowRoot>"u")return!1;var e=Fe(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function s$(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},c=e.elements[s];!Ue(c)||!st(c)||(Object.assign(c.style,o),Object.keys(a).forEach(function(d){var f=a[d];f===!1?c.removeAttribute(d):c.setAttribute(d,f===!0?"":f)}))})}function n$(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],c=e.attributes[o]||{},d=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),f=d.reduce(function(m,p){return m[p]="",m},{});!Ue(a)||!st(a)||(Object.assign(a.style,f),Object.keys(c).forEach(function(m){a.removeAttribute(m)}))})}}const qo={name:"applyStyles",enabled:!0,phase:"write",fn:s$,effect:n$,requires:["computeStyles"]};function et(n){return n.split("-")[0]}var wt=Math.max,ys=Math.min,Pt=Math.round;function sn(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function zo(){return!/^((?!chrome|android).)*safari/i.test(sn())}function Rt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,c=1;e&&Ue(n)&&(a=n.offsetWidth>0&&Pt(o.width)/n.offsetWidth||1,c=n.offsetHeight>0&&Pt(o.height)/n.offsetHeight||1);var d=$t(n)?Fe(n):window,f=d.visualViewport,m=!zo()&&s,p=(o.left+(m&&f?f.offsetLeft:0))/a,u=(o.top+(m&&f?f.offsetTop:0))/c,w=o.width/a,v=o.height/c;return{width:w,height:v,top:u,right:p+w,bottom:u+v,left:p,x:p,y:u}}function vn(n){var e=Rt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Ko(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&pn(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function it(n){return Fe(n).getComputedStyle(n)}function o$(n){return["table","td","th"].indexOf(st(n))>=0}function vt(n){return(($t(n)?n.ownerDocument:n.document)||window.document).documentElement}function xs(n){return st(n)==="html"?n:n.assignedSlot||n.parentNode||(pn(n)?n.host:null)||vt(n)}function Wn(n){return!Ue(n)||it(n).position==="fixed"?null:n.offsetParent}function a$(n){var e=/firefox/i.test(sn()),s=/Trident/i.test(sn());if(s&&Ue(n)){var o=it(n);if(o.position==="fixed")return null}var a=xs(n);for(pn(a)&&(a=a.host);Ue(a)&&["html","body"].indexOf(st(a))<0;){var c=it(a);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return a;a=a.parentNode}return null}function ns(n){for(var e=Fe(n),s=Wn(n);s&&o$(s)&&it(s).position==="static";)s=Wn(s);return s&&(st(s)==="html"||st(s)==="body"&&it(s).position==="static")?e:s||a$(n)||e}function hn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Qt(n,e,s){return wt(n,ys(e,s))}function i$(n,e,s){var o=Qt(n,e,s);return o>s?s:o}function Go(){return{top:0,right:0,bottom:0,left:0}}function Yo(n){return Object.assign({},Go(),n)}function Jo(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var l$=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Yo(typeof e!="number"?e:Jo(e,Ht))};function r$(n){var e,s=n.state,o=n.name,a=n.options,c=s.elements.arrow,d=s.modifiersData.popperOffsets,f=et(s.placement),m=hn(f),p=[Ne,Be].indexOf(f)>=0,u=p?"height":"width";if(!(!c||!d)){var w=l$(a.padding,s),v=vn(c),k=m==="y"?Oe:Ne,S=m==="y"?Re:Be,b=s.rects.reference[u]+s.rects.reference[m]-d[m]-s.rects.popper[u],g=d[m]-s.rects.reference[m],h=ns(c),i=h?m==="y"?h.clientHeight||0:h.clientWidth||0:0,$=b/2-g/2,x=w[k],N=i-v[u]-w[S],M=i/2-v[u]/2+$,A=Qt(x,M,N),E=m;s.modifiersData[o]=(e={},e[E]=A,e.centerOffset=A-M,e)}}function c$(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||Ko(e.elements.popper,a)&&(e.elements.arrow=a))}const Qo={name:"arrow",enabled:!0,phase:"main",fn:r$,effect:c$,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Bt(n){return n.split("-")[1]}var u$={top:"auto",right:"auto",bottom:"auto",left:"auto"};function d$(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:Pt(s*a)/a||0,y:Pt(o*a)/a||0}}function Un(n){var e,s=n.popper,o=n.popperRect,a=n.placement,c=n.variation,d=n.offsets,f=n.position,m=n.gpuAcceleration,p=n.adaptive,u=n.roundOffsets,w=n.isFixed,v=d.x,k=v===void 0?0:v,S=d.y,b=S===void 0?0:S,g=typeof u=="function"?u({x:k,y:b}):{x:k,y:b};k=g.x,b=g.y;var h=d.hasOwnProperty("x"),i=d.hasOwnProperty("y"),$=Ne,x=Oe,N=window;if(p){var M=ns(s),A="clientHeight",E="clientWidth";if(M===Fe(s)&&(M=vt(s),it(M).position!=="static"&&f==="absolute"&&(A="scrollHeight",E="scrollWidth")),M=M,a===Oe||(a===Ne||a===Be)&&c===jt){x=Re;var C=w&&M===N&&N.visualViewport?N.visualViewport.height:M[A];b-=C-o.height,b*=m?1:-1}if(a===Ne||(a===Oe||a===Re)&&c===jt){$=Be;var O=w&&M===N&&N.visualViewport?N.visualViewport.width:M[E];k-=O-o.width,k*=m?1:-1}}var z=Object.assign({position:f},p&&u$),R=u===!0?d$({x:k,y:b},Fe(s)):{x:k,y:b};if(k=R.x,b=R.y,m){var F;return Object.assign({},z,(F={},F[x]=i?"0":"",F[$]=h?"0":"",F.transform=(N.devicePixelRatio||1)<=1?"translate("+k+"px, "+b+"px)":"translate3d("+k+"px, "+b+"px, 0)",F))}return Object.assign({},z,(e={},e[x]=i?b+"px":"",e[$]=h?k+"px":"",e.transform="",e))}function f$(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,c=s.adaptive,d=c===void 0?!0:c,f=s.roundOffsets,m=f===void 0?!0:f,p={placement:et(e.placement),variation:Bt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Un(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:d,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Un(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Xo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:f$,data:{}};var cs={passive:!0};function m$(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,c=a===void 0?!0:a,d=o.resize,f=d===void 0?!0:d,m=Fe(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&p.forEach(function(u){u.addEventListener("scroll",s.update,cs)}),f&&m.addEventListener("resize",s.update,cs),function(){c&&p.forEach(function(u){u.removeEventListener("scroll",s.update,cs)}),f&&m.removeEventListener("resize",s.update,cs)}}const Zo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:m$,data:{}};var p$={left:"right",right:"left",bottom:"top",top:"bottom"};function hs(n){return n.replace(/left|right|bottom|top/g,function(e){return p$[e]})}var v$={start:"end",end:"start"};function Hn(n){return n.replace(/start|end/g,function(e){return v$[e]})}function _n(n){var e=Fe(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function gn(n){return Rt(vt(n)).left+_n(n).scrollLeft}function h$(n,e){var s=Fe(n),o=vt(n),a=s.visualViewport,c=o.clientWidth,d=o.clientHeight,f=0,m=0;if(a){c=a.width,d=a.height;var p=zo();(p||!p&&e==="fixed")&&(f=a.offsetLeft,m=a.offsetTop)}return{width:c,height:d,x:f+gn(n),y:m}}function _$(n){var e,s=vt(n),o=_n(n),a=(e=n.ownerDocument)==null?void 0:e.body,c=wt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),d=wt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),f=-o.scrollLeft+gn(n),m=-o.scrollTop;return it(a||s).direction==="rtl"&&(f+=wt(s.clientWidth,a?a.clientWidth:0)-c),{width:c,height:d,x:f,y:m}}function bn(n){var e=it(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function ea(n){return["html","body","#document"].indexOf(st(n))>=0?n.ownerDocument.body:Ue(n)&&bn(n)?n:ea(xs(n))}function Xt(n,e){var s;e===void 0&&(e=[]);var o=ea(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),c=Fe(o),d=a?[c].concat(c.visualViewport||[],bn(o)?o:[]):o,f=e.concat(d);return a?f:f.concat(Xt(xs(d)))}function nn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function g$(n,e){var s=Rt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function qn(n,e,s){return e===fn?nn(h$(n,s)):$t(e)?g$(e,s):nn(_$(vt(n)))}function b$(n){var e=Xt(xs(n)),s=["absolute","fixed"].indexOf(it(n).position)>=0,o=s&&Ue(n)?ns(n):n;return $t(o)?e.filter(function(a){return $t(a)&&Ko(a,o)&&st(a)!=="body"}):[]}function y$(n,e,s,o){var a=e==="clippingParents"?b$(n):[].concat(e),c=[].concat(a,[s]),d=c[0],f=c.reduce(function(m,p){var u=qn(n,p,o);return m.top=wt(u.top,m.top),m.right=ys(u.right,m.right),m.bottom=ys(u.bottom,m.bottom),m.left=wt(u.left,m.left),m},qn(n,d,o));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function ta(n){var e=n.reference,s=n.element,o=n.placement,a=o?et(o):null,c=o?Bt(o):null,d=e.x+e.width/2-s.width/2,f=e.y+e.height/2-s.height/2,m;switch(a){case Oe:m={x:d,y:e.y-s.height};break;case Re:m={x:d,y:e.y+e.height};break;case Be:m={x:e.x+e.width,y:f};break;case Ne:m={x:e.x-s.width,y:f};break;default:m={x:e.x,y:e.y}}var p=a?hn(a):null;if(p!=null){var u=p==="y"?"height":"width";switch(c){case kt:m[p]=m[p]-(e[u]/2-s[u]/2);break;case jt:m[p]=m[p]+(e[u]/2-s[u]/2);break}}return m}function Ft(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,c=s.strategy,d=c===void 0?n.strategy:c,f=s.boundary,m=f===void 0?No:f,p=s.rootBoundary,u=p===void 0?fn:p,w=s.elementContext,v=w===void 0?Dt:w,k=s.altBoundary,S=k===void 0?!1:k,b=s.padding,g=b===void 0?0:b,h=Yo(typeof g!="number"?g:Jo(g,Ht)),i=v===Dt?Lo:Dt,$=n.rects.popper,x=n.elements[S?i:v],N=y$($t(x)?x:x.contextElement||vt(n.elements.popper),m,u,d),M=Rt(n.elements.reference),A=ta({reference:M,element:$,placement:a}),E=nn(Object.assign({},$,A)),C=v===Dt?E:M,O={top:N.top-C.top+h.top,bottom:C.bottom-N.bottom+h.bottom,left:N.left-C.left+h.left,right:C.right-N.right+h.right},z=n.modifiersData.offset;if(v===Dt&&z){var R=z[a];Object.keys(O).forEach(function(F){var W=[Be,Re].indexOf(F)>=0?1:-1,J=[Oe,Re].indexOf(F)>=0?"y":"x";O[F]+=R[J]*W})}return O}function w$(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,c=s.rootBoundary,d=s.padding,f=s.flipVariations,m=s.allowedAutoPlacements,p=m===void 0?mn:m,u=Bt(o),w=u?f?tn:tn.filter(function(S){return Bt(S)===u}):Ht,v=w.filter(function(S){return p.indexOf(S)>=0});v.length===0&&(v=w);var k=v.reduce(function(S,b){return S[b]=Ft(n,{placement:b,boundary:a,rootBoundary:c,padding:d})[et(b)],S},{});return Object.keys(k).sort(function(S,b){return k[S]-k[b]})}function k$(n){if(et(n)===Ss)return[];var e=hs(n);return[Hn(n),e,Hn(e)]}function $$(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,c=a===void 0?!0:a,d=s.altAxis,f=d===void 0?!0:d,m=s.fallbackPlacements,p=s.padding,u=s.boundary,w=s.rootBoundary,v=s.altBoundary,k=s.flipVariations,S=k===void 0?!0:k,b=s.allowedAutoPlacements,g=e.options.placement,h=et(g),i=h===g,$=m||(i||!S?[hs(g)]:k$(g)),x=[g].concat($).reduce(function(Z,ce){return Z.concat(et(ce)===Ss?w$(e,{placement:ce,boundary:u,rootBoundary:w,padding:p,flipVariations:S,allowedAutoPlacements:b}):ce)},[]),N=e.rects.reference,M=e.rects.popper,A=new Map,E=!0,C=x[0],O=0;O<x.length;O++){var z=x[O],R=et(z),F=Bt(z)===kt,W=[Oe,Re].indexOf(R)>=0,J=W?"width":"height",ie=Ft(e,{placement:z,boundary:u,rootBoundary:w,altBoundary:v,padding:p}),re=W?F?Be:Ne:F?Re:Oe;N[J]>M[J]&&(re=hs(re));var B=hs(re),D=[];if(c&&D.push(ie[R]<=0),f&&D.push(ie[re]<=0,ie[B]<=0),D.every(function(Z){return Z})){C=z,E=!1;break}A.set(z,D)}if(E)for(var P=S?3:1,G=function(ce){var H=x.find(function(I){var V=A.get(I);if(V)return V.slice(0,ce).every(function(q){return q})});if(H)return C=H,"break"},X=P;X>0;X--){var se=G(X);if(se==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const sa={name:"flip",enabled:!0,phase:"main",fn:$$,requiresIfExists:["offset"],data:{_skip:!1}};function zn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Kn(n){return[Oe,Be,Re,Ne].some(function(e){return n[e]>=0})}function S$(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,c=e.modifiersData.preventOverflow,d=Ft(e,{elementContext:"reference"}),f=Ft(e,{altBoundary:!0}),m=zn(d,o),p=zn(f,a,c),u=Kn(m),w=Kn(p);e.modifiersData[s]={referenceClippingOffsets:m,popperEscapeOffsets:p,isReferenceHidden:u,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":w})}const na={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:S$};function x$(n,e,s){var o=et(n),a=[Ne,Oe].indexOf(o)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,d=c[0],f=c[1];return d=d||0,f=(f||0)*a,[Ne,Be].indexOf(o)>=0?{x:f,y:d}:{x:d,y:f}}function C$(n){var e=n.state,s=n.options,o=n.name,a=s.offset,c=a===void 0?[0,0]:a,d=mn.reduce(function(u,w){return u[w]=x$(w,e.rects,c),u},{}),f=d[e.placement],m=f.x,p=f.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=d}const oa={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:C$};function E$(n){var e=n.state,s=n.name;e.modifiersData[s]=ta({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const aa={name:"popperOffsets",enabled:!0,phase:"read",fn:E$,data:{}};function T$(n){return n==="x"?"y":"x"}function A$(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,c=a===void 0?!0:a,d=s.altAxis,f=d===void 0?!1:d,m=s.boundary,p=s.rootBoundary,u=s.altBoundary,w=s.padding,v=s.tether,k=v===void 0?!0:v,S=s.tetherOffset,b=S===void 0?0:S,g=Ft(e,{boundary:m,rootBoundary:p,padding:w,altBoundary:u}),h=et(e.placement),i=Bt(e.placement),$=!i,x=hn(h),N=T$(x),M=e.modifiersData.popperOffsets,A=e.rects.reference,E=e.rects.popper,C=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,O=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),z=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,R={x:0,y:0};if(M){if(c){var F,W=x==="y"?Oe:Ne,J=x==="y"?Re:Be,ie=x==="y"?"height":"width",re=M[x],B=re+g[W],D=re-g[J],P=k?-E[ie]/2:0,G=i===kt?A[ie]:E[ie],X=i===kt?-E[ie]:-A[ie],se=e.elements.arrow,Z=k&&se?vn(se):{width:0,height:0},ce=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Go(),H=ce[W],I=ce[J],V=Qt(0,A[ie],Z[ie]),q=$?A[ie]/2-P-V-H-O.mainAxis:G-V-H-O.mainAxis,U=$?-A[ie]/2+P+V+I+O.mainAxis:X+V+I+O.mainAxis,ee=e.elements.arrow&&ns(e.elements.arrow),$e=ee?x==="y"?ee.clientTop||0:ee.clientLeft||0:0,Ve=(F=z?.[x])!=null?F:0,Q=re+q-Ve-$e,ue=re+U-Ve,_e=Qt(k?ys(B,Q):B,re,k?wt(D,ue):D);M[x]=_e,R[x]=_e-re}if(f){var ge,Ce=x==="x"?Oe:Ne,Ge=x==="x"?Re:Be,Qe=M[N],gt=N==="y"?"height":"width",j=Qe+g[Ce],te=Qe-g[Ge],le=[Oe,Ne].indexOf(h)!==-1,we=(ge=z?.[N])!=null?ge:0,pe=le?j:Qe-A[gt]-E[gt]-we+O.altAxis,Ee=le?Qe+A[gt]+E[gt]-we-O.altAxis:te,Ae=k&&le?i$(pe,Qe,Ee):Qt(k?pe:j,Qe,k?Ee:te);M[N]=Ae,R[N]=Ae-Qe}e.modifiersData[o]=R}}const ia={name:"preventOverflow",enabled:!0,phase:"main",fn:A$,requiresIfExists:["offset"]};function D$(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function M$(n){return n===Fe(n)||!Ue(n)?_n(n):D$(n)}function O$(n){var e=n.getBoundingClientRect(),s=Pt(e.width)/n.offsetWidth||1,o=Pt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function N$(n,e,s){s===void 0&&(s=!1);var o=Ue(e),a=Ue(e)&&O$(e),c=vt(e),d=Rt(n,a,s),f={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!s)&&((st(e)!=="body"||bn(c))&&(f=M$(e)),Ue(e)?(m=Rt(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):c&&(m.x=gn(c))),{x:d.left+f.scrollLeft-m.x,y:d.top+f.scrollTop-m.y,width:d.width,height:d.height}}function L$(n){var e=new Map,s=new Set,o=[];n.forEach(function(c){e.set(c.name,c)});function a(c){s.add(c.name);var d=[].concat(c.requires||[],c.requiresIfExists||[]);d.forEach(function(f){if(!s.has(f)){var m=e.get(f);m&&a(m)}}),o.push(c)}return n.forEach(function(c){s.has(c.name)||a(c)}),o}function I$(n){var e=L$(n);return Ho.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function j$(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function P$(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Gn={placement:"bottom",modifiers:[],strategy:"absolute"};function Yn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function la(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,c=a===void 0?Gn:a;return function(f,m,p){p===void 0&&(p=c);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Gn,c),modifiersData:{},elements:{reference:f,popper:m},attributes:{},styles:{}},w=[],v=!1,k={state:u,setOptions:function(h){var i=typeof h=="function"?h(u.options):h;b(),u.options=Object.assign({},c,u.options,i),u.scrollParents={reference:$t(f)?Xt(f):f.contextElement?Xt(f.contextElement):[],popper:Xt(m)};var $=I$(P$([].concat(o,u.options.modifiers)));return u.orderedModifiers=$.filter(function(x){return x.enabled}),S(),k.update()},forceUpdate:function(){if(!v){var h=u.elements,i=h.reference,$=h.popper;if(Yn(i,$)){u.rects={reference:N$(i,ns($),u.options.strategy==="fixed"),popper:vn($)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(O){return u.modifiersData[O.name]=Object.assign({},O.data)});for(var x=0;x<u.orderedModifiers.length;x++){if(u.reset===!0){u.reset=!1,x=-1;continue}var N=u.orderedModifiers[x],M=N.fn,A=N.options,E=A===void 0?{}:A,C=N.name;typeof M=="function"&&(u=M({state:u,options:E,name:C,instance:k})||u)}}}},update:j$(function(){return new Promise(function(g){k.forceUpdate(),g(u)})}),destroy:function(){b(),v=!0}};if(!Yn(f,m))return k;k.setOptions(p).then(function(g){!v&&p.onFirstUpdate&&p.onFirstUpdate(g)});function S(){u.orderedModifiers.forEach(function(g){var h=g.name,i=g.options,$=i===void 0?{}:i,x=g.effect;if(typeof x=="function"){var N=x({state:u,name:h,instance:k,options:$}),M=function(){};w.push(N||M)}})}function b(){w.forEach(function(g){return g()}),w=[]}return k}}var R$=[Zo,aa,Xo,qo,oa,sa,ia,Qo,na],yn=la({defaultModifiers:R$});const ra=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Fo,afterRead:Po,afterWrite:Uo,applyStyles:qo,arrow:Qo,auto:Ss,basePlacements:Ht,beforeMain:Ro,beforeRead:Io,beforeWrite:Vo,bottom:Re,clippingParents:No,computeStyles:Xo,createPopper:yn,detectOverflow:Ft,end:jt,eventListeners:Zo,flip:sa,hide:na,left:Ne,main:Bo,modifierPhases:Ho,offset:oa,placements:mn,popper:Dt,popperGenerator:la,popperOffsets:aa,preventOverflow:ia,read:jo,reference:Lo,right:Be,start:kt,top:Oe,variationPlacements:tn,viewport:fn,write:Wo},Symbol.toStringTag,{value:"Module"}));const ut=new Map,Rs={set(n,e,s){ut.has(n)||ut.set(n,new Map);const o=ut.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return ut.has(n)&&ut.get(n).get(e)||null},remove(n,e){if(!ut.has(n))return;const s=ut.get(n);s.delete(e),s.size===0&&ut.delete(n)}},B$=1e6,F$=1e3,on="transitionend",ca=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),V$=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),W$=n=>{do n+=Math.floor(Math.random()*B$);while(document.getElementById(n));return n},U$=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*F$)},ua=n=>{n.dispatchEvent(new Event(on))},ot=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ft=n=>ot(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ca(n)):null,qt=n=>{if(!ot(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},mt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",da=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?da(n.parentNode):null},ws=()=>{},os=n=>{n.offsetHeight},fa=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Bs=[],H$=n=>{document.readyState==="loading"?(Bs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Bs)e()}),Bs.push(n)):n()},He=()=>document.documentElement.dir==="rtl",Ke=n=>{H$(()=>{const e=fa();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Le=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,ma=(n,e,s=!0)=>{if(!s){Le(n);return}const a=U$(e)+5;let c=!1;const d=({target:f})=>{f===e&&(c=!0,e.removeEventListener(on,d),Le(n))};e.addEventListener(on,d),setTimeout(()=>{c||ua(e)},a)},wn=(n,e,s,o)=>{const a=n.length;let c=n.indexOf(e);return c===-1?!s&&o?n[a-1]:n[0]:(c+=s?1:-1,o&&(c=(c+a)%a),n[Math.max(0,Math.min(c,a-1))])},q$=/[^.]*(?=\..*)\.|.*/,z$=/\..*/,K$=/::\d+$/,Fs={};let Jn=1;const pa={mouseenter:"mouseover",mouseleave:"mouseout"},G$=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function va(n,e){return e&&`${e}::${Jn++}`||n.uidEvent||Jn++}function ha(n){const e=va(n);return n.uidEvent=e,Fs[e]=Fs[e]||{},Fs[e]}function Y$(n,e){return function s(o){return kn(o,{delegateTarget:n}),s.oneOff&&Y.off(n,o.type,e),e.apply(n,[o])}}function J$(n,e,s){return function o(a){const c=n.querySelectorAll(e);for(let{target:d}=a;d&&d!==this;d=d.parentNode)for(const f of c)if(f===d)return kn(a,{delegateTarget:d}),o.oneOff&&Y.off(n,a.type,e,s),s.apply(d,[a])}}function _a(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ga(n,e,s){const o=typeof e=="string",a=o?s:e||s;let c=ba(n);return G$.has(c)||(c=n),[o,a,c]}function Qn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[c,d,f]=ga(e,s,o);e in pa&&(d=(S=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return S.call(this,b)})(d));const m=ha(n),p=m[f]||(m[f]={}),u=_a(p,d,c?s:null);if(u){u.oneOff=u.oneOff&&a;return}const w=va(d,e.replace(q$,"")),v=c?J$(n,s,d):Y$(n,d);v.delegationSelector=c?s:null,v.callable=d,v.oneOff=a,v.uidEvent=w,p[w]=v,n.addEventListener(f,v,c)}function an(n,e,s,o,a){const c=_a(e[s],o,a);c&&(n.removeEventListener(s,c,!!a),delete e[s][c.uidEvent])}function Q$(n,e,s,o){const a=e[s]||{};for(const[c,d]of Object.entries(a))c.includes(o)&&an(n,e,s,d.callable,d.delegationSelector)}function ba(n){return n=n.replace(z$,""),pa[n]||n}const Y={on(n,e,s,o){Qn(n,e,s,o,!1)},one(n,e,s,o){Qn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,c,d]=ga(e,s,o),f=d!==e,m=ha(n),p=m[d]||{},u=e.startsWith(".");if(typeof c<"u"){if(!Object.keys(p).length)return;an(n,m,d,c,a?s:null);return}if(u)for(const w of Object.keys(m))Q$(n,m,w,e.slice(1));for(const[w,v]of Object.entries(p)){const k=w.replace(K$,"");(!f||e.includes(k))&&an(n,m,d,v.callable,v.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=fa(),a=ba(e),c=e!==a;let d=null,f=!0,m=!0,p=!1;c&&o&&(d=o.Event(e,s),o(n).trigger(d),f=!d.isPropagationStopped(),m=!d.isImmediatePropagationStopped(),p=d.isDefaultPrevented());const u=kn(new Event(e,{bubbles:f,cancelable:!0}),s);return p&&u.preventDefault(),m&&n.dispatchEvent(u),u.defaultPrevented&&d&&d.preventDefault(),u}};function kn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Xn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Vs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const at={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Vs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Vs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=Xn(n.dataset[o])}return e},getDataAttribute(n,e){return Xn(n.getAttribute(`data-bs-${Vs(e)}`))}};class as{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=ot(s)?at.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...ot(s)?at.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const c=e[o],d=ot(c)?"element":V$(c);if(!new RegExp(a).test(d))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${d}" but expected type "${a}".`)}}}const X$="5.3.8";class Je extends as{constructor(e,s){super(),e=ft(e),e&&(this._element=e,this._config=this._getConfig(s),Rs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Rs.remove(this._element,this.constructor.DATA_KEY),Y.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){ma(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Rs.get(ft(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return X$}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ws=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ca(s)).join(","):null},me={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!mt(s)&&qt(s))},getSelectorFromElement(n){const e=Ws(n);return e&&me.findOne(e)?e:null},getElementFromSelector(n){const e=Ws(n);return e?me.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ws(n);return e?me.find(e):[]}},Cs=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Y.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),mt(this))return;const c=me.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(c)[e]()})},Z$="alert",e0="bs.alert",ya=`.${e0}`,t0=`close${ya}`,s0=`closed${ya}`,n0="fade",o0="show";class Es extends Je{static get NAME(){return Z$}close(){if(Y.trigger(this._element,t0).defaultPrevented)return;this._element.classList.remove(o0);const s=this._element.classList.contains(n0);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),Y.trigger(this._element,s0),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Es.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Cs(Es,"close");Ke(Es);const a0="button",i0="bs.button",l0=`.${i0}`,r0=".data-api",c0="active",Zn='[data-bs-toggle="button"]',u0=`click${l0}${r0}`;class Ts extends Je{static get NAME(){return a0}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(c0))}static jQueryInterface(e){return this.each(function(){const s=Ts.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}Y.on(document,u0,Zn,n=>{n.preventDefault();const e=n.target.closest(Zn);Ts.getOrCreateInstance(e).toggle()});Ke(Ts);const d0="swipe",zt=".bs.swipe",f0=`touchstart${zt}`,m0=`touchmove${zt}`,p0=`touchend${zt}`,v0=`pointerdown${zt}`,h0=`pointerup${zt}`,_0="touch",g0="pen",b0="pointer-event",y0=40,w0={endCallback:null,leftCallback:null,rightCallback:null},k0={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class ks extends as{constructor(e,s){super(),this._element=e,!(!e||!ks.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return w0}static get DefaultType(){return k0}static get NAME(){return d0}dispose(){Y.off(this._element,zt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Le(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=y0)return;const s=e/this._deltaX;this._deltaX=0,s&&Le(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Y.on(this._element,v0,e=>this._start(e)),Y.on(this._element,h0,e=>this._end(e)),this._element.classList.add(b0)):(Y.on(this._element,f0,e=>this._start(e)),Y.on(this._element,m0,e=>this._move(e)),Y.on(this._element,p0,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===g0||e.pointerType===_0)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const $0="carousel",S0="bs.carousel",ht=`.${S0}`,wa=".data-api",x0="ArrowLeft",C0="ArrowRight",E0=500,Yt="next",Tt="prev",Mt="left",_s="right",T0=`slide${ht}`,Us=`slid${ht}`,A0=`keydown${ht}`,D0=`mouseenter${ht}`,M0=`mouseleave${ht}`,O0=`dragstart${ht}`,N0=`load${ht}${wa}`,L0=`click${ht}${wa}`,ka="carousel",us="active",I0="slide",j0="carousel-item-end",P0="carousel-item-start",R0="carousel-item-next",B0="carousel-item-prev",$a=".active",Sa=".carousel-item",F0=$a+Sa,V0=".carousel-item img",W0=".carousel-indicators",U0="[data-bs-slide], [data-bs-slide-to]",H0='[data-bs-ride="carousel"]',q0={[x0]:_s,[C0]:Mt},z0={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},K0={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class is extends Je{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=me.findOne(W0,this._element),this._addEventListeners(),this._config.ride===ka&&this.cycle()}static get Default(){return z0}static get DefaultType(){return K0}static get NAME(){return $0}next(){this._slide(Yt)}nextWhenVisible(){!document.hidden&&qt(this._element)&&this.next()}prev(){this._slide(Tt)}pause(){this._isSliding&&ua(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Y.one(this._element,Us,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){Y.one(this._element,Us,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?Yt:Tt;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Y.on(this._element,A0,e=>this._keydown(e)),this._config.pause==="hover"&&(Y.on(this._element,D0,()=>this.pause()),Y.on(this._element,M0,()=>this._maybeEnableCycle())),this._config.touch&&ks.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of me.find(V0,this._element))Y.on(o,O0,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Mt)),rightCallback:()=>this._slide(this._directionToOrder(_s)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),E0+this._config.interval))}};this._swipeHelper=new ks(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=q0[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=me.findOne($a,this._indicatorsElement);s.classList.remove(us),s.removeAttribute("aria-current");const o=me.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(us),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===Yt,c=s||wn(this._getItems(),o,a,this._config.wrap);if(c===o)return;const d=this._getItemIndex(c),f=k=>Y.trigger(this._element,k,{relatedTarget:c,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:d});if(f(T0).defaultPrevented||!o||!c)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(d),this._activeElement=c;const u=a?P0:j0,w=a?R0:B0;c.classList.add(w),os(c),o.classList.add(u),c.classList.add(u);const v=()=>{c.classList.remove(u,w),c.classList.add(us),o.classList.remove(us,w,u),this._isSliding=!1,f(Us)};this._queueCallback(v,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(I0)}_getActive(){return me.findOne(F0,this._element)}_getItems(){return me.find(Sa,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return He()?e===Mt?Tt:Yt:e===Mt?Yt:Tt}_orderToDirection(e){return He()?e===Tt?Mt:_s:e===Tt?_s:Mt}static jQueryInterface(e){return this.each(function(){const s=is.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(document,L0,U0,function(n){const e=me.getElementFromSelector(this);if(!e||!e.classList.contains(ka))return;n.preventDefault();const s=is.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(at.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});Y.on(window,N0,()=>{const n=me.find(H0);for(const e of n)is.getOrCreateInstance(e)});Ke(is);const G0="collapse",Y0="bs.collapse",ls=`.${Y0}`,J0=".data-api",Q0=`show${ls}`,X0=`shown${ls}`,Z0=`hide${ls}`,eS=`hidden${ls}`,tS=`click${ls}${J0}`,Hs="show",Nt="collapse",ds="collapsing",sS="collapsed",nS=`:scope .${Nt} .${Nt}`,oS="collapse-horizontal",aS="width",iS="height",lS=".collapse.show, .collapse.collapsing",ln='[data-bs-toggle="collapse"]',rS={parent:null,toggle:!0},cS={parent:"(null|element)",toggle:"boolean"};class es extends Je{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=me.find(ln);for(const a of o){const c=me.getSelectorFromElement(a),d=me.find(c).filter(f=>f===this._element);c!==null&&d.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return rS}static get DefaultType(){return cS}static get NAME(){return G0}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(lS).filter(f=>f!==this._element).map(f=>es.getOrCreateInstance(f,{toggle:!1}))),e.length&&e[0]._isTransitioning||Y.trigger(this._element,Q0).defaultPrevented)return;for(const f of e)f.hide();const o=this._getDimension();this._element.classList.remove(Nt),this._element.classList.add(ds),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(ds),this._element.classList.add(Nt,Hs),this._element.style[o]="",Y.trigger(this._element,X0)},d=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[d]}px`}hide(){if(this._isTransitioning||!this._isShown()||Y.trigger(this._element,Z0).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,os(this._element),this._element.classList.add(ds),this._element.classList.remove(Nt,Hs);for(const a of this._triggerArray){const c=me.getElementFromSelector(a);c&&!this._isShown(c)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(ds),this._element.classList.add(Nt),Y.trigger(this._element,eS)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Hs)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ft(e.parent),e}_getDimension(){return this._element.classList.contains(oS)?aS:iS}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(ln);for(const s of e){const o=me.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=me.find(nS,this._config.parent);return me.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(sS,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=es.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Y.on(document,tS,ln,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of me.getMultipleElementsFromSelector(this))es.getOrCreateInstance(e,{toggle:!1}).toggle()});Ke(es);const eo="dropdown",uS="bs.dropdown",xt=`.${uS}`,$n=".data-api",dS="Escape",to="Tab",fS="ArrowUp",so="ArrowDown",mS=2,pS=`hide${xt}`,vS=`hidden${xt}`,hS=`show${xt}`,_S=`shown${xt}`,xa=`click${xt}${$n}`,Ca=`keydown${xt}${$n}`,gS=`keyup${xt}${$n}`,Ot="show",bS="dropup",yS="dropend",wS="dropstart",kS="dropup-center",$S="dropdown-center",bt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',SS=`${bt}.${Ot}`,gs=".dropdown-menu",xS=".navbar",CS=".navbar-nav",ES=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",TS=He()?"top-end":"top-start",AS=He()?"top-start":"top-end",DS=He()?"bottom-end":"bottom-start",MS=He()?"bottom-start":"bottom-end",OS=He()?"left-start":"right-start",NS=He()?"right-start":"left-start",LS="top",IS="bottom",jS={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},PS={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class tt extends Je{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=me.next(this._element,gs)[0]||me.prev(this._element,gs)[0]||me.findOne(gs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return jS}static get DefaultType(){return PS}static get NAME(){return eo}toggle(){return this._isShown()?this.hide():this.show()}show(){if(mt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Y.trigger(this._element,hS,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(CS))for(const o of[].concat(...document.body.children))Y.on(o,"mouseover",ws);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ot),this._element.classList.add(Ot),Y.trigger(this._element,_S,e)}}hide(){if(mt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Y.trigger(this._element,pS,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Y.off(o,"mouseover",ws);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ot),this._element.classList.remove(Ot),this._element.setAttribute("aria-expanded","false"),at.removeDataAttribute(this._menu,"popper"),Y.trigger(this._element,vS,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!ot(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${eo.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof ra>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:ot(this._config.reference)?e=ft(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=yn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Ot)}_getPlacement(){const e=this._parent;if(e.classList.contains(yS))return OS;if(e.classList.contains(wS))return NS;if(e.classList.contains(kS))return LS;if(e.classList.contains($S))return IS;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(bS)?s?AS:TS:s?MS:DS}_detectNavbar(){return this._element.closest(xS)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(at.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Le(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=me.find(ES,this._menu).filter(a=>qt(a));o.length&&wn(o,s,e===so,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=tt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===mS||e.type==="keyup"&&e.key!==to)return;const s=me.find(SS);for(const o of s){const a=tt.getInstance(o);if(!a||a._config.autoClose===!1)continue;const c=e.composedPath(),d=c.includes(a._menu);if(c.includes(a._element)||a._config.autoClose==="inside"&&!d||a._config.autoClose==="outside"&&d||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===to||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const f={relatedTarget:a._element};e.type==="click"&&(f.clickEvent=e),a._completeHide(f)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===dS,a=[fS,so].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const c=this.matches(bt)?this:me.prev(this,bt)[0]||me.next(this,bt)[0]||me.findOne(bt,e.delegateTarget.parentNode),d=tt.getOrCreateInstance(c);if(a){e.stopPropagation(),d.show(),d._selectMenuItem(e);return}d._isShown()&&(e.stopPropagation(),d.hide(),c.focus())}}Y.on(document,Ca,bt,tt.dataApiKeydownHandler);Y.on(document,Ca,gs,tt.dataApiKeydownHandler);Y.on(document,xa,tt.clearMenus);Y.on(document,gS,tt.clearMenus);Y.on(document,xa,bt,function(n){n.preventDefault(),tt.getOrCreateInstance(this).toggle()});Ke(tt);const Ea="backdrop",RS="fade",no="show",oo=`mousedown.bs.${Ea}`,BS={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},FS={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Ta extends as{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return BS}static get DefaultType(){return FS}static get NAME(){return Ea}show(e){if(!this._config.isVisible){Le(e);return}this._append();const s=this._getElement();this._config.isAnimated&&os(s),s.classList.add(no),this._emulateAnimation(()=>{Le(e)})}hide(e){if(!this._config.isVisible){Le(e);return}this._getElement().classList.remove(no),this._emulateAnimation(()=>{this.dispose(),Le(e)})}dispose(){this._isAppended&&(Y.off(this._element,oo),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(RS),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ft(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Y.on(e,oo,()=>{Le(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){ma(e,this._getElement(),this._config.isAnimated)}}const VS="focustrap",WS="bs.focustrap",$s=`.${WS}`,US=`focusin${$s}`,HS=`keydown.tab${$s}`,qS="Tab",zS="forward",ao="backward",KS={autofocus:!0,trapElement:null},GS={autofocus:"boolean",trapElement:"element"};class Aa extends as{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return KS}static get DefaultType(){return GS}static get NAME(){return VS}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Y.off(document,$s),Y.on(document,US,e=>this._handleFocusin(e)),Y.on(document,HS,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Y.off(document,$s))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=me.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===ao?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===qS&&(this._lastTabNavDirection=e.shiftKey?ao:zS)}}const io=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",lo=".sticky-top",fs="padding-right",ro="margin-right";class rn{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,fs,s=>s+e),this._setElementAttributes(io,fs,s=>s+e),this._setElementAttributes(lo,ro,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,fs),this._resetElementAttributes(io,fs),this._resetElementAttributes(lo,ro)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),c=d=>{if(d!==this._element&&window.innerWidth>d.clientWidth+a)return;this._saveInitialAttribute(d,s);const f=window.getComputedStyle(d).getPropertyValue(s);d.style.setProperty(s,`${o(Number.parseFloat(f))}px`)};this._applyManipulationCallback(e,c)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&at.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const c=at.getDataAttribute(a,s);if(c===null){a.style.removeProperty(s);return}at.removeDataAttribute(a,s),a.style.setProperty(s,c)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(ot(e)){s(e);return}for(const o of me.find(e,this._element))s(o)}}const YS="modal",JS="bs.modal",qe=`.${JS}`,QS=".data-api",XS="Escape",ZS=`hide${qe}`,ex=`hidePrevented${qe}`,Da=`hidden${qe}`,Ma=`show${qe}`,tx=`shown${qe}`,sx=`resize${qe}`,nx=`click.dismiss${qe}`,ox=`mousedown.dismiss${qe}`,ax=`keydown.dismiss${qe}`,ix=`click${qe}${QS}`,co="modal-open",lx="fade",uo="show",qs="modal-static",rx=".modal.show",cx=".modal-dialog",ux=".modal-body",dx='[data-bs-toggle="modal"]',fx={backdrop:!0,focus:!0,keyboard:!0},mx={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class St extends Je{constructor(e,s){super(e,s),this._dialog=me.findOne(cx,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new rn,this._addEventListeners()}static get Default(){return fx}static get DefaultType(){return mx}static get NAME(){return YS}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Y.trigger(this._element,Ma,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(co),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Y.trigger(this._element,ZS).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(uo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Y.off(window,qe),Y.off(this._dialog,qe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ta({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Aa({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=me.findOne(ux,this._dialog);s&&(s.scrollTop=0),os(this._element),this._element.classList.add(uo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Y.trigger(this._element,tx,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Y.on(this._element,ax,e=>{if(e.key===XS){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Y.on(window,sx,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Y.on(this._element,ox,e=>{Y.one(this._element,nx,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(co),this._resetAdjustments(),this._scrollBar.reset(),Y.trigger(this._element,Da)})}_isAnimated(){return this._element.classList.contains(lx)}_triggerBackdropTransition(){if(Y.trigger(this._element,ex).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(qs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(qs),this._queueCallback(()=>{this._element.classList.remove(qs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=He()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=He()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}Y.on(document,ix,dx,function(n){const e=me.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Y.one(e,Ma,a=>{a.defaultPrevented||Y.one(e,Da,()=>{qt(this)&&this.focus()})});const s=me.findOne(rx);s&&St.getInstance(s).hide(),St.getOrCreateInstance(e).toggle(this)});Cs(St);Ke(St);const px="offcanvas",vx="bs.offcanvas",ct=`.${vx}`,Oa=".data-api",hx=`load${ct}${Oa}`,_x="Escape",fo="show",mo="showing",po="hiding",gx="offcanvas-backdrop",Na=".offcanvas.show",bx=`show${ct}`,yx=`shown${ct}`,wx=`hide${ct}`,vo=`hidePrevented${ct}`,La=`hidden${ct}`,kx=`resize${ct}`,$x=`click${ct}${Oa}`,Sx=`keydown.dismiss${ct}`,xx='[data-bs-toggle="offcanvas"]',Cx={backdrop:!0,keyboard:!0,scroll:!1},Ex={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class pt extends Je{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Cx}static get DefaultType(){return Ex}static get NAME(){return px}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Y.trigger(this._element,bx,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new rn().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(mo);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(fo),this._element.classList.remove(mo),Y.trigger(this._element,yx,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Y.trigger(this._element,wx).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(po),this._backdrop.hide();const s=()=>{this._element.classList.remove(fo,po),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new rn().reset(),Y.trigger(this._element,La)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Y.trigger(this._element,vo);return}this.hide()},s=!!this._config.backdrop;return new Ta({className:gx,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Aa({trapElement:this._element})}_addEventListeners(){Y.on(this._element,Sx,e=>{if(e.key===_x){if(this._config.keyboard){this.hide();return}Y.trigger(this._element,vo)}})}static jQueryInterface(e){return this.each(function(){const s=pt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Y.on(document,$x,xx,function(n){const e=me.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),mt(this))return;Y.one(e,La,()=>{qt(this)&&this.focus()});const s=me.findOne(Na);s&&s!==e&&pt.getInstance(s).hide(),pt.getOrCreateInstance(e).toggle(this)});Y.on(window,hx,()=>{for(const n of me.find(Na))pt.getOrCreateInstance(n).show()});Y.on(window,kx,()=>{for(const n of me.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&pt.getOrCreateInstance(n).hide()});Cs(pt);Ke(pt);const Tx=/^aria-[\w-]*$/i,Ia={"*":["class","dir","id","lang","role",Tx],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Ax=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Dx=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Mx=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Ax.has(s)?!!Dx.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Ox(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),c=[].concat(...a.body.querySelectorAll("*"));for(const d of c){const f=d.nodeName.toLowerCase();if(!Object.keys(e).includes(f)){d.remove();continue}const m=[].concat(...d.attributes),p=[].concat(e["*"]||[],e[f]||[]);for(const u of m)Mx(u,p)||d.removeAttribute(u.nodeName)}return a.body.innerHTML}const Nx="TemplateFactory",Lx={allowList:Ia,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Ix={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},jx={entry:"(string|element|function|null)",selector:"(string|element)"};class Px extends as{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Lx}static get DefaultType(){return Ix}static get NAME(){return Nx}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,c]of Object.entries(this._config.content))this._setContent(e,c,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},jx)}_setContent(e,s,o){const a=me.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(ot(s)){this._putElementInTemplate(ft(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Ox(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Le(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Rx="tooltip",Bx=new Set(["sanitize","allowList","sanitizeFn"]),zs="fade",Fx="modal",ms="show",Vx=".tooltip-inner",ho=`.${Fx}`,_o="hide.bs.modal",Jt="hover",Ks="focus",Gs="click",Wx="manual",Ux="hide",Hx="hidden",qx="show",zx="shown",Kx="inserted",Gx="click",Yx="focusin",Jx="focusout",Qx="mouseenter",Xx="mouseleave",Zx={AUTO:"auto",TOP:"top",RIGHT:He()?"left":"right",BOTTOM:"bottom",LEFT:He()?"right":"left"},eC={allowList:Ia,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},tC={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Kt extends Je{constructor(e,s){if(typeof ra>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return eC}static get DefaultType(){return tC}static get NAME(){return Rx}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Y.off(this._element.closest(ho),_o,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Y.trigger(this._element,this.constructor.eventName(qx)),o=(da(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:c}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(c.append(a),Y.trigger(this._element,this.constructor.eventName(Kx))),this._popper=this._createPopper(a),a.classList.add(ms),"ontouchstart"in document.documentElement)for(const f of[].concat(...document.body.children))Y.on(f,"mouseover",ws);const d=()=>{Y.trigger(this._element,this.constructor.eventName(zx)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(d,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Y.trigger(this._element,this.constructor.eventName(Ux)).defaultPrevented)return;if(this._getTipElement().classList.remove(ms),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))Y.off(a,"mouseover",ws);this._activeTrigger[Gs]=!1,this._activeTrigger[Ks]=!1,this._activeTrigger[Jt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Y.trigger(this._element,this.constructor.eventName(Hx)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(zs,ms),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=W$(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(zs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Px({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Vx]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(zs)}_isShown(){return this.tip&&this.tip.classList.contains(ms)}_createPopper(e){const s=Le(this._config.placement,[this,e,this._element]),o=Zx[s.toUpperCase()];return yn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Le(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Le(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")Y.on(this._element,this.constructor.eventName(Gx),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[Gs]=!(a._isShown()&&a._activeTrigger[Gs]),a.toggle()});else if(s!==Wx){const o=s===Jt?this.constructor.eventName(Qx):this.constructor.eventName(Yx),a=s===Jt?this.constructor.eventName(Xx):this.constructor.eventName(Jx);Y.on(this._element,o,this._config.selector,c=>{const d=this._initializeOnDelegatedTarget(c);d._activeTrigger[c.type==="focusin"?Ks:Jt]=!0,d._enter()}),Y.on(this._element,a,this._config.selector,c=>{const d=this._initializeOnDelegatedTarget(c);d._activeTrigger[c.type==="focusout"?Ks:Jt]=d._element.contains(c.relatedTarget),d._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Y.on(this._element.closest(ho),_o,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=at.getDataAttributes(this._element);for(const o of Object.keys(s))Bx.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ft(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Kt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ke(Kt);const sC="popover",nC=".popover-header",oC=".popover-body",aC={...Kt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},iC={...Kt.DefaultType,content:"(null|string|element|function)"};class Sn extends Kt{static get Default(){return aC}static get DefaultType(){return iC}static get NAME(){return sC}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[nC]:this._getTitle(),[oC]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=Sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ke(Sn);const lC="scrollspy",rC="bs.scrollspy",xn=`.${rC}`,cC=".data-api",uC=`activate${xn}`,go=`click${xn}`,dC=`load${xn}${cC}`,fC="dropdown-item",At="active",mC='[data-bs-spy="scroll"]',Ys="[href]",pC=".nav, .list-group",bo=".nav-link",vC=".nav-item",hC=".list-group-item",_C=`${bo}, ${vC} > ${bo}, ${hC}`,gC=".dropdown",bC=".dropdown-toggle",yC={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},wC={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class As extends Je{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return yC}static get DefaultType(){return wC}static get NAME(){return lC}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ft(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Y.off(this._config.target,go),Y.on(this._config.target,go,Ys,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=d=>this._targetLinks.get(`#${d.target.id}`),o=d=>{this._previousScrollData.visibleEntryTop=d.target.offsetTop,this._process(s(d))},a=(this._rootElement||document.documentElement).scrollTop,c=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const d of e){if(!d.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(d));continue}const f=d.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(c&&f){if(o(d),!a)return;continue}!c&&!f&&o(d)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=me.find(Ys,this._config.target);for(const s of e){if(!s.hash||mt(s))continue;const o=me.findOne(decodeURI(s.hash),this._element);qt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(At),this._activateParents(e),Y.trigger(this._element,uC,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(fC)){me.findOne(bC,e.closest(gC)).classList.add(At);return}for(const s of me.parents(e,pC))for(const o of me.prev(s,_C))o.classList.add(At)}_clearActiveClass(e){e.classList.remove(At);const s=me.find(`${Ys}.${At}`,e);for(const o of s)o.classList.remove(At)}static jQueryInterface(e){return this.each(function(){const s=As.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(window,dC,()=>{for(const n of me.find(mC))As.getOrCreateInstance(n)});Ke(As);const kC="tab",$C="bs.tab",Ct=`.${$C}`,SC=`hide${Ct}`,xC=`hidden${Ct}`,CC=`show${Ct}`,EC=`shown${Ct}`,TC=`click${Ct}`,AC=`keydown${Ct}`,DC=`load${Ct}`,MC="ArrowLeft",yo="ArrowRight",OC="ArrowUp",wo="ArrowDown",Js="Home",ko="End",yt="active",$o="fade",Qs="show",NC="dropdown",ja=".dropdown-toggle",LC=".dropdown-menu",Xs=`:not(${ja})`,IC='.list-group, .nav, [role="tablist"]',jC=".nav-item, .list-group-item",PC=`.nav-link${Xs}, .list-group-item${Xs}, [role="tab"]${Xs}`,Pa='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Zs=`${PC}, ${Pa}`,RC=`.${yt}[data-bs-toggle="tab"], .${yt}[data-bs-toggle="pill"], .${yt}[data-bs-toggle="list"]`;class Vt extends Je{constructor(e){super(e),this._parent=this._element.closest(IC),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Y.on(this._element,AC,s=>this._keydown(s)))}static get NAME(){return kC}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?Y.trigger(s,SC,{relatedTarget:e}):null;Y.trigger(e,CC,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(yt),this._activate(me.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Qs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Y.trigger(e,EC,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains($o))}_deactivate(e,s){if(!e)return;e.classList.remove(yt),e.blur(),this._deactivate(me.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Qs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Y.trigger(e,xC,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains($o))}_keydown(e){if(![MC,yo,OC,wo,Js,ko].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!mt(a));let o;if([Js,ko].includes(e.key))o=s[e.key===Js?0:s.length-1];else{const a=[yo,wo].includes(e.key);o=wn(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),Vt.getOrCreateInstance(o).show())}_getChildren(){return me.find(Zs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=me.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(NC))return;const a=(c,d)=>{const f=me.findOne(c,o);f&&f.classList.toggle(d,s)};a(ja,yt),a(LC,Qs),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(yt)}_getInnerElement(e){return e.matches(Zs)?e:me.findOne(Zs,e)}_getOuterElement(e){return e.closest(jC)||e}static jQueryInterface(e){return this.each(function(){const s=Vt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(document,TC,Pa,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!mt(this)&&Vt.getOrCreateInstance(this).show()});Y.on(window,DC,()=>{for(const n of me.find(RC))Vt.getOrCreateInstance(n)});Ke(Vt);const BC="toast",FC="bs.toast",_t=`.${FC}`,VC=`mouseover${_t}`,WC=`mouseout${_t}`,UC=`focusin${_t}`,HC=`focusout${_t}`,qC=`hide${_t}`,zC=`hidden${_t}`,KC=`show${_t}`,GC=`shown${_t}`,YC="fade",So="hide",ps="show",vs="showing",JC={animation:"boolean",autohide:"boolean",delay:"number"},QC={animation:!0,autohide:!0,delay:5e3};class Ds extends Je{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return QC}static get DefaultType(){return JC}static get NAME(){return BC}show(){if(Y.trigger(this._element,KC).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(YC);const s=()=>{this._element.classList.remove(vs),Y.trigger(this._element,GC),this._maybeScheduleHide()};this._element.classList.remove(So),os(this._element),this._element.classList.add(ps,vs),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||Y.trigger(this._element,qC).defaultPrevented)return;const s=()=>{this._element.classList.add(So),this._element.classList.remove(vs,ps),Y.trigger(this._element,zC)};this._element.classList.add(vs),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ps),super.dispose()}isShown(){return this._element.classList.contains(ps)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Y.on(this._element,VC,e=>this._onInteraction(e,!0)),Y.on(this._element,WC,e=>this._onInteraction(e,!1)),Y.on(this._element,UC,e=>this._onInteraction(e,!0)),Y.on(this._element,HC,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Cs(Ds);Ke(Ds);const XC={class:"modal-dialog modal-lg"},ZC={class:"modal-content"},eE={class:"modal-body"},tE={key:0,class:"text-center py-4"},sE={key:1,class:"alert alert-danger"},nE={key:2},oE={class:"mb-3"},aE={class:"small text-muted mb-2"},iE={key:0},lE={key:0,class:"alert alert-info"},rE={key:1},cE={class:"table table-sm table-striped"},uE={key:2,class:"mt-3"},dE={key:3,class:"mt-3"},fE={class:"modal-footer"},mE=["disabled"],pE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=L(null);let d=null;const f=L(!1),m=L(""),p=L([]);ve(c,b=>{b&&(d=new St(b),b.addEventListener("hidden.bs.modal",()=>{a("close")}))});function u(){d&&(d.show(),v())}function w(){d&&d.hide()}async function v(){f.value=!0,m.value="",p.value=[];try{const b=await ke.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});p.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),m.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{f.value=!1}}function k(){v()}function S(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:w}),(b,g)=>(l(),r("div",{ref_key:"modalRef",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",XC,[t("div",ZC,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",eE,[f.value?(l(),r("div",tE,[...g[0]||(g[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(l(),r("div",sE,y(m.value),1)):(l(),r("div",nE,[t("div",oE,[g[2]||(g[2]=t("h6",null,"Settings Sources",-1)),t("div",aE,[g[1]||(g[1]=fe(" Loading permissions from: ",-1)),(l(!0),r(oe,null,de(n.settingSources,(h,i)=>(l(),r("span",{key:h},[t("code",null,y(h),1),i<n.settingSources.length-1?(l(),r("span",iE,", ")):T("",!0)]))),128))])]),p.value.length===0?(l(),r("div",lE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(l(),r("div",rE,[t("h6",null,"Pre-approved Permissions ("+y(p.value.length)+")",1),t("table",cE,[g[3]||(g[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(l(!0),r(oe,null,de(p.value,h=>(l(),r("tr",{key:h.permission},[t("td",null,[t("code",null,y(h.permission),1)]),t("td",null,[(l(!0),r(oe,null,de(h.sources,(i,$)=>(l(),r("span",{key:i,class:K(["badge me-1",S(i)])},y(i),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(l(),r("div",uE,[g[4]||(g[4]=t("h6",null,"Session Allowed Tools",-1)),g[5]||(g[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(l(!0),r(oe,null,de(n.sessionAllowedTools,h=>(l(),r("span",{key:h,class:"badge bg-success me-1 mb-1"},y(h),1))),128))])])):T("",!0),n.sessionDisallowedTools.length>0?(l(),r("div",dE,[g[6]||(g[6]=t("h6",null,"Session Disallowed Tools",-1)),g[7]||(g[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(l(!0),r(oe,null,de(n.sessionDisallowedTools,h=>(l(),r("span",{key:h,class:"badge bg-danger me-1 mb-1"},y(h),1))),128))])])):T("",!0)]))]),t("div",fE,[g[8]||(g[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:k,disabled:f.value}," Refresh ",8,mE)])])])],512))}},vE=ne(pE,[["__scopeId","data-v-2078b366"]]),hE={class:"modal-dialog modal-lg modal-dialog-centered"},_E={class:"modal-content"},gE={class:"modal-header"},bE={id:"configurationModalLabel",class:"modal-title"},yE={class:"modal-body"},wE={key:0,class:"template-list-view"},kE={key:0,class:"alert alert-info"},$E={class:"card-body"},SE={class:"d-flex justify-content-between align-items-start"},xE={class:"flex-grow-1"},CE={class:"card-title mb-1"},EE={key:0,class:"card-text text-muted small mb-2"},TE={class:"template-meta"},AE={class:"badge bg-secondary me-2"},DE={class:"text-muted small"},ME={class:"btn-group btn-group-sm ms-3"},OE=["onClick"],NE=["onClick"],LE={key:1},IE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},jE={class:"nav-item",role:"presentation"},PE={key:0,class:"error-indicator",title:"This tab has validation errors"},RE={class:"nav-item",role:"presentation"},BE={key:0,class:"error-indicator",title:"This tab has validation errors"},FE={class:"nav-item",role:"presentation"},VE={key:0,class:"error-indicator",title:"This tab has validation errors"},WE={class:"nav-item",role:"presentation"},UE={class:"tab-content"},HE={key:2,class:"alert alert-danger mt-3"},qE={key:0},zE={key:1},KE={class:"modal-footer"},GE={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},YE=["disabled"],JE={key:0,class:"spinner-border spinner-border-sm me-2"},QE={__name:"ConfigurationModal",setup(n){const e=ts(),s=ze(),o=he(),a=xe(),c=L(null);let d=null;const f=L(null),m=L("create-session"),p=L("general"),u=L(null),w=L(null),v=L(null),k=L([]),S=L(null),b=L(null),g=L({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),h=Ns({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),i=Ns({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),$=Ns({name:""}),x=_(()=>({general:!!$.name,permissions:!1,advanced:!1})),N=L(!1),M=L(""),A=_(()=>m.value==="create-session"||m.value==="edit-session"),E=_(()=>m.value==="edit-session"||m.value==="edit-template"),C=_(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),O=_(()=>N.value?E.value?"Saving...":"Creating...":E.value?"Save Changes":A.value?"Create Session":"Save Template"),z=_(()=>!(!i.name.trim()||A.value&&i.name.includes(" "))),R=_(()=>w.value?.state==="active"||w.value?.state==="starting"),F=_(()=>{if(!w.value)return!1;const j=(i.initialization_context||"")!==(w.value.system_prompt||""),te=(i.override_system_prompt||!1)!==(w.value.override_system_prompt||!1),le=(i.sandbox_enabled||!1)!==(w.value.sandbox_enabled||!1);if(j||te||le)return!0;if(i.sandbox_enabled){const we=w.value.sandbox_config||{},pe=i.sandbox,Ee=JSON.stringify({autoAllowBashIfSandboxed:we.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:we.allowUnsandboxedCommands??!1,excludedCommands:(we.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:we.enableWeakerNestedSandbox??!1,network:{allowedDomains:(we.network?.allowedDomains||[]).join(", "),allowLocalBinding:we.network?.allowLocalBinding??!1,allowUnixSockets:(we.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:we.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(we.ignoreViolations?.file||[]).join(", "),network:(we.ignoreViolations?.network||[]).join(", ")}}),Ae=JSON.stringify({autoAllowBashIfSandboxed:pe.autoAllowBashIfSandboxed,allowUnsandboxedCommands:pe.allowUnsandboxedCommands,excludedCommands:pe.excludedCommands,enableWeakerNestedSandbox:pe.enableWeakerNestedSandbox,network:{allowedDomains:pe.network.allowedDomains,allowLocalBinding:pe.network.allowLocalBinding,allowUnixSockets:pe.network.allowUnixSockets,allowAllUnixSockets:pe.network.allowAllUnixSockets},ignoreViolations:{file:pe.ignoreViolations.file,network:pe.ignoreViolations.network}});if(Ee!==Ae)return!0}return!1}),W=_(()=>{if(!w.value)return!1;const j=(i.model||"sonnet")!==(w.value.model||"sonnet"),te=(i.allowed_tools||"")!==(w.value.allowed_tools?.join(", ")||""),le=w.value.setting_sources||["user","project","local"],we=i.setting_sources||["user","project","local"],pe=JSON.stringify([...le].sort())!==JSON.stringify([...we].sort());return j||te||pe}),J=_(()=>F.value?"reset":W.value?"restart":null),ie=_(()=>m.value==="edit-session"&&R.value&&J.value!==null),re=_(()=>w.value?.working_directory?w.value.working_directory:i.working_directory?i.working_directory:s.projects.get(u.value)?.working_directory||""),B=_(()=>!i.allowed_tools||!i.allowed_tools.trim()?[]:i.allowed_tools.split(",").map(j=>j.trim()).filter(j=>j.length>0)),D=_(()=>!i.disallowed_tools||!i.disallowed_tools.trim()?[]:i.disallowed_tools.split(",").map(j=>j.trim()).filter(j=>j.length>0));function P(){f.value&&f.value.show()}function G(){const j=te=>te.split(",").map(le=>le.trim()).filter(le=>le.length>0);return{autoAllowBashIfSandboxed:i.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:i.sandbox.allowUnsandboxedCommands,excludedCommands:j(i.sandbox.excludedCommands),enableWeakerNestedSandbox:i.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:j(i.sandbox.network.allowedDomains),allowLocalBinding:i.sandbox.network.allowLocalBinding,allowUnixSockets:j(i.sandbox.network.allowUnixSockets),allowAllUnixSockets:i.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:j(i.sandbox.ignoreViolations.file),network:j(i.sandbox.ignoreViolations.network)}}}function X(j,te){i[j]=te,j==="name"&&($.name="")}function se(j){S.value=j,ce()}async function Z(){try{const j=await ke.get("/api/templates");k.value=j||[]}catch(j){console.error("Failed to load templates:",j),k.value=[]}}function ce(){if(!S.value){i.default_role="",i.initialization_context="",i.permission_mode="default",i.allowed_tools="",i.disallowed_tools="",i.model="sonnet",i.capabilities="",i.override_system_prompt=!1,i.sandbox_enabled=!1,i.sandbox.autoAllowBashIfSandboxed=!0,i.sandbox.allowUnsandboxedCommands=!1,i.sandbox.excludedCommands="",i.sandbox.enableWeakerNestedSandbox=!1,i.sandbox.network.allowedDomains="",i.sandbox.network.allowLocalBinding=!1,i.sandbox.network.allowUnixSockets="",i.sandbox.network.allowAllUnixSockets=!1,i.sandbox.ignoreViolations.file="",i.sandbox.ignoreViolations.network="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",h.disallowed_tools="normal",h.model="normal",h.capabilities="normal",h.sandbox_excludedCommands="normal",h.sandbox_network_allowedDomains="normal",h.sandbox_network_allowUnixSockets="normal",h.sandbox_ignoreViolations_file="normal",h.sandbox_ignoreViolations_network="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const j=k.value.find(Xe=>Xe.template_id===S.value);if(!j)return;if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",h.disallowed_tools="normal",h.model="normal",h.capabilities="normal",h.sandbox_excludedCommands="normal",h.sandbox_network_allowedDomains="normal",h.sandbox_network_allowUnixSockets="normal",h.sandbox_ignoreViolations_file="normal",h.sandbox_ignoreViolations_network="normal",j.default_role?(i.default_role=j.default_role,g.value.default_role=j.default_role,h.default_role="autofilled"):(i.default_role="",g.value.default_role=null),j.default_system_prompt?(i.initialization_context=j.default_system_prompt,g.value.initialization_context=j.default_system_prompt,h.initialization_context="autofilled"):(i.initialization_context="",g.value.initialization_context=null),j.permission_mode?(i.permission_mode=j.permission_mode,g.value.permission_mode=j.permission_mode,h.permission_mode="autofilled"):(i.permission_mode="default",g.value.permission_mode=null),j.allowed_tools&&j.allowed_tools.length>0){const Xe=j.allowed_tools.join(", ");i.allowed_tools=Xe,g.value.allowed_tools=Xe,h.allowed_tools="autofilled"}else i.allowed_tools="",g.value.allowed_tools=null;if(j.disallowed_tools&&j.disallowed_tools.length>0){const Xe=j.disallowed_tools.join(", ");i.disallowed_tools=Xe,g.value.disallowed_tools=Xe,h.disallowed_tools="autofilled"}else i.disallowed_tools="",g.value.disallowed_tools=null;if(j.model?(i.model=j.model,g.value.model=j.model,h.model="autofilled"):(i.model="sonnet",g.value.model=null),j.capabilities&&j.capabilities.length>0){const Xe=j.capabilities.join(", ");i.capabilities=Xe,g.value.capabilities=Xe,h.capabilities="autofilled"}else i.capabilities="",g.value.capabilities=null;i.override_system_prompt=j.override_system_prompt||!1,i.sandbox_enabled=j.sandbox_enabled||!1;const te=j.sandbox_config||{};i.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,i.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,i.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const le=te.network||{};i.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,i.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const we=(te.excludedCommands||[]).join(", ");i.sandbox.excludedCommands=we,g.value.sandbox_excludedCommands=we||null,we&&(h.sandbox_excludedCommands="autofilled");const pe=(le.allowedDomains||[]).join(", ");i.sandbox.network.allowedDomains=pe,g.value.sandbox_network_allowedDomains=pe||null,pe&&(h.sandbox_network_allowedDomains="autofilled");const Ee=(le.allowUnixSockets||[]).join(", ");i.sandbox.network.allowUnixSockets=Ee,g.value.sandbox_network_allowUnixSockets=Ee||null,Ee&&(h.sandbox_network_allowUnixSockets="autofilled");const Ae=te.ignoreViolations||{},Ms=(Ae.file||[]).join(", ");i.sandbox.ignoreViolations.file=Ms,g.value.sandbox_ignoreViolations_file=Ms||null,Ms&&(h.sandbox_ignoreViolations_file="autofilled");const Os=(Ae.network||[]).join(", ");i.sandbox.ignoreViolations.network=Os,g.value.sandbox_ignoreViolations_network=Os||null,Os&&(h.sandbox_ignoreViolations_network="autofilled")}function H(){const te=(u.value?s.projects.get(u.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:te,currentPath:i.working_directory||"",onSelect:le=>{i.working_directory=le}})}function I(){m.value==="create-session"&&(b.value={mode:"create-session",projectId:u.value,formData:{...i},selectedTemplateId:S.value}),m.value="template-list",ge()}function V(){m.value="create-template",ge(),p.value="general"}function q(j){m.value="edit-template",v.value=j,ge(),Ge(j),p.value="general"}async function U(j){if(confirm(`Delete template "${j.name}"?

This action cannot be undone.`))try{await ke.delete(`/api/templates/${j.template_id}`),await Z()}catch(te){console.error("Failed to delete template:",te),M.value=te.response?.data?.detail||"Failed to delete template"}}function ee(){let j=!0;return $.name="",i.name.trim()||($.name="Name is required",j=!1),A.value&&i.name.includes(" ")&&($.name="Session name must be a single word (no spaces)",j=!1),j}async function $e(){if(!ee()){$.name&&(p.value="general");return}N.value=!0,M.value="";try{switch(m.value){case"create-session":await Ve(),d&&d.hide();break;case"edit-session":await Q(),d&&d.hide();break;case"create-template":await ue();break;case"edit-template":await _e();break}}catch(j){console.error("Submit failed:",j),M.value=j.response?.data?.detail||j.message||"Operation failed. Please try again."}finally{N.value=!1}}async function Ve(){if(!u.value)throw new Error("Project ID is missing");const j=i.allowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),te=i.disallowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),le=i.capabilities.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),we={name:i.name.trim(),model:i.model||null,role:i.default_role.trim()||null,initialization_context:i.initialization_context.trim()||null,override_system_prompt:i.override_system_prompt,capabilities:le.length>0?le:null,permission_mode:i.permission_mode,allowed_tools:j.length>0?j:null,disallowed_tools:te.length>0?te:null,working_directory:i.working_directory.trim()||null,sandbox_enabled:i.sandbox_enabled,sandbox_config:i.sandbox_enabled?G():null,setting_sources:i.setting_sources},pe=await ke.post(`/api/legions/${u.value}/minions`,we);if(pe.success&&pe.minion_id)await s.fetchProjects(),await o.fetchSessions(),i.startImmediately&&await o.startSession(pe.minion_id),e.push(`/session/${pe.minion_id}`);else throw new Error("Failed to create session")}async function Q(){if(!w.value)throw new Error("Session data is missing");const j=w.value.session_id,te=w.value.state==="active"||w.value.state==="starting",le=i.allowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),we=i.disallowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),pe=i.capabilities.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),Ee={name:i.name.trim(),model:i.model,role:i.default_role.trim()||null,system_prompt:i.initialization_context.trim()||null,override_system_prompt:i.override_system_prompt,allowed_tools:le.length>0?le:null,disallowed_tools:we.length>0?we:null,capabilities:pe.length>0?pe:null,sandbox_enabled:i.sandbox_enabled,sandbox_config:i.sandbox_enabled?G():null,setting_sources:i.setting_sources};await o.patchSession(j,Ee),te&&i.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(j,i.permission_mode)}async function ue(){const j=i.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),te=i.disallowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),le=i.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),we={name:i.name.trim(),description:i.description.trim()||null,permission_mode:i.permission_mode,allowed_tools:j.length>0?j:null,disallowed_tools:te.length>0?te:null,default_role:i.default_role.trim()||null,default_system_prompt:i.initialization_context.trim()||null,model:i.model||null,capabilities:le.length>0?le:null,override_system_prompt:i.override_system_prompt,sandbox_enabled:i.sandbox_enabled,sandbox_config:i.sandbox_enabled?G():null};await ke.post("/api/templates",we),await Z(),m.value="template-list",ge()}async function _e(){if(!v.value)throw new Error("Template data is missing");const j=i.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),te=i.disallowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),le=i.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),we={name:i.name.trim(),description:i.description.trim()||null,permission_mode:i.permission_mode,allowed_tools:j.length>0?j:null,disallowed_tools:te.length>0?te:null,default_role:i.default_role.trim()||null,default_system_prompt:i.initialization_context.trim()||null,model:i.model||null,capabilities:le.length>0?le:null,override_system_prompt:i.override_system_prompt,sandbox_enabled:i.sandbox_enabled,sandbox_config:i.sandbox_enabled?G():null};await ke.put(`/api/templates/${v.value.template_id}`,we),await Z(),m.value="template-list",v.value=null,ge()}function ge(){i.name="",i.model="sonnet",i.permission_mode="default",i.working_directory="",i.description="",i.default_role="",i.startImmediately=!0,i.allowed_tools="",i.disallowed_tools="",i.capabilities="",i.setting_sources=["user","project","local"],i.system_prompt="",i.override_system_prompt=!1,i.initialization_context="",i.sandbox_enabled=!1,i.sandbox.autoAllowBashIfSandboxed=!0,i.sandbox.allowUnsandboxedCommands=!1,i.sandbox.excludedCommands="",i.sandbox.enableWeakerNestedSandbox=!1,i.sandbox.network.allowedDomains="",i.sandbox.network.allowLocalBinding=!1,i.sandbox.network.allowUnixSockets="",i.sandbox.network.allowAllUnixSockets=!1,i.sandbox.ignoreViolations.file="",i.sandbox.ignoreViolations.network="",$.name="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",h.disallowed_tools="normal",h.model="normal",h.capabilities="normal",h.sandbox_excludedCommands="normal",h.sandbox_network_allowedDomains="normal",h.sandbox_network_allowUnixSockets="normal",h.sandbox_ignoreViolations_file="normal",h.sandbox_ignoreViolations_network="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},S.value=null,M.value="",p.value="general"}function Ce(j){i.name=j.name||"",i.model=j.model||"sonnet",i.permission_mode=j.current_permission_mode||"default",i.working_directory=j.working_directory||"",i.default_role=j.role||"",i.initialization_context=j.system_prompt||"",i.override_system_prompt=j.override_system_prompt||!1,i.system_prompt="",i.allowed_tools=j.allowed_tools?.join(", ")||"",i.disallowed_tools=j.disallowed_tools?.join(", ")||"",i.capabilities=j.capabilities?.join(", ")||"",i.sandbox_enabled=j.sandbox_enabled||!1,i.setting_sources=j.setting_sources||["user","project","local"];const te=j.sandbox_config||{};i.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,i.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,i.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),i.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const le=te.network||{};i.sandbox.network.allowedDomains=(le.allowedDomains||[]).join(", "),i.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,i.sandbox.network.allowUnixSockets=(le.allowUnixSockets||[]).join(", "),i.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const we=te.ignoreViolations||{};i.sandbox.ignoreViolations.file=(we.file||[]).join(", "),i.sandbox.ignoreViolations.network=(we.network||[]).join(", ")}function Ge(j){i.name=j.name||"",i.description=j.description||"",i.permission_mode=j.permission_mode||"default",i.default_role=j.default_role||"",i.initialization_context=j.default_system_prompt||"",i.allowed_tools=j.allowed_tools?.join(", ")||"",i.disallowed_tools=j.disallowed_tools?.join(", ")||"",i.model=j.model||"sonnet",i.capabilities=j.capabilities?.join(", ")||"",i.override_system_prompt=j.override_system_prompt||!1,i.sandbox_enabled=j.sandbox_enabled||!1;const te=j.sandbox_config||{};i.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,i.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,i.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),i.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const le=te.network||{};i.sandbox.network.allowedDomains=(le.allowedDomains||[]).join(", "),i.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,i.sandbox.network.allowUnixSockets=(le.allowUnixSockets||[]).join(", "),i.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const we=te.ignoreViolations||{};i.sandbox.ignoreViolations.file=(we.file||[]).join(", "),i.sandbox.ignoreViolations.network=(we.network||[]).join(", ")}function Qe(){dt(()=>{const j=document.getElementById("config-name");j&&(j.focus(),E.value&&j.select())})}function gt(){ge(),m.value="create-session",u.value=null,w.value=null,v.value=null,a.hideModal()}return ve(()=>a.currentModal,async(j,te)=>{if(!(!j||!d)){if(j.name==="configuration"){const le=j.data||{};m.value=le.mode||"create-session",u.value=le.project?.project_id||le.projectId||null,w.value=le.session||null,v.value=le.template||null,ge(),m.value==="create-session"&&await Z(),m.value==="edit-session"&&w.value?Ce(w.value):m.value==="edit-template"&&v.value&&Ge(v.value),d.show()}else if(j.name==="create-minion"||j.name==="create-session"){const le=j.data||{};m.value="create-session",u.value=le.project?.project_id||null,w.value=null,v.value=null,ge(),await Z(),d.show()}else if(j.name==="edit-session"){const le=j.data||{};m.value="edit-session",w.value=le.session||null,u.value=w.value?.project_id||null,v.value=null,ge(),w.value&&Ce(w.value),d.show()}else j.name==="template-management"&&(m.value="template-list",ge(),await Z(),d.show());te?.name==="configuration"&&te.data?.mode?.includes("template")&&j?.name==="configuration"&&m.value==="create-session"&&await Z()}}),ve(()=>i.default_role,j=>{g.value.default_role!==null&&(h.default_role=j===g.value.default_role?"autofilled":"modified")}),ve(()=>i.initialization_context,j=>{g.value.initialization_context!==null&&(h.initialization_context=j===g.value.initialization_context?"autofilled":"modified")}),ve(()=>i.permission_mode,j=>{g.value.permission_mode!==null&&(h.permission_mode=j===g.value.permission_mode?"autofilled":"modified")}),ve(()=>i.allowed_tools,j=>{g.value.allowed_tools!==null&&(h.allowed_tools=j===g.value.allowed_tools?"autofilled":"modified")}),ve(()=>i.disallowed_tools,j=>{g.value.disallowed_tools!==null&&(h.disallowed_tools=j===g.value.disallowed_tools?"autofilled":"modified")}),ve(()=>i.model,j=>{g.value.model!==null&&(h.model=j===g.value.model?"autofilled":"modified")}),ve(()=>i.capabilities,j=>{g.value.capabilities!==null&&(h.capabilities=j===g.value.capabilities?"autofilled":"modified")}),ve(()=>i.sandbox.excludedCommands,j=>{g.value.sandbox_excludedCommands!==null&&(h.sandbox_excludedCommands=j===g.value.sandbox_excludedCommands?"autofilled":"modified")}),ve(()=>i.sandbox.network.allowedDomains,j=>{g.value.sandbox_network_allowedDomains!==null&&(h.sandbox_network_allowedDomains=j===g.value.sandbox_network_allowedDomains?"autofilled":"modified")}),ve(()=>i.sandbox.network.allowUnixSockets,j=>{g.value.sandbox_network_allowUnixSockets!==null&&(h.sandbox_network_allowUnixSockets=j===g.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),ve(()=>i.sandbox.ignoreViolations.file,j=>{g.value.sandbox_ignoreViolations_file!==null&&(h.sandbox_ignoreViolations_file=j===g.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),ve(()=>i.sandbox.ignoreViolations.network,j=>{g.value.sandbox_ignoreViolations_network!==null&&(h.sandbox_ignoreViolations_network=j===g.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),Me(()=>{c.value&&Ie(()=>import("./modal-D6mKceGM.js").then(j=>j.m),__vite__mapDeps([0,1])).then(j=>{const te=j.default;d=new te(c.value),c.value.addEventListener("shown.bs.modal",Qe),c.value.addEventListener("hidden.bs.modal",gt)})}),De(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",Qe),c.value.removeEventListener("hidden.bs.modal",gt)),d&&d.dispose()}),(j,te)=>(l(),r(oe,null,[t("div",{ref_key:"modalElement",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",hE,[t("div",_E,[t("div",gE,[t("h5",bE,[m.value==="create-template"||m.value==="edit-template"?(l(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:I,title:"Back to template list"}," â† ")):T("",!0),fe(" "+y(C.value),1)]),te[4]||(te[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",yE,[m.value==="template-list"?(l(),r("div",wE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[te[5]||(te[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:V,class:"btn btn-primary btn-sm"}," + Create New ")]),k.value.length===0?(l(),r("div",kE," No templates found. Create your first template! ")):T("",!0),(l(!0),r(oe,null,de(k.value,le=>(l(),r("div",{key:le.template_id,class:"card mb-2"},[t("div",$E,[t("div",SE,[t("div",xE,[t("h6",CE,y(le.name),1),le.description?(l(),r("p",EE,y(le.description),1)):T("",!0),t("div",TE,[t("span",AE,y(le.permission_mode),1),t("span",DE,y(le.allowed_tools?.length||0)+" tools",1)])]),t("div",ME,[t("button",{onClick:we=>q(le),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,OE),t("button",{onClick:we=>U(le),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,NE)])])])]))),128))])):(l(),r("div",LE,[t("ul",IE,[t("li",jE,[t("button",{class:K(["nav-link",{active:p.value==="general","has-error":x.value.general}]),type:"button",onClick:te[0]||(te[0]=le=>p.value="general")},[te[6]||(te[6]=fe(" General ",-1)),x.value.general?(l(),r("span",PE)):T("",!0)],2)]),t("li",RE,[t("button",{class:K(["nav-link",{active:p.value==="permissions","has-error":x.value.permissions}]),type:"button",onClick:te[1]||(te[1]=le=>p.value="permissions")},[te[7]||(te[7]=fe(" Permissions ",-1)),x.value.permissions?(l(),r("span",BE)):T("",!0)],2)]),t("li",FE,[t("button",{class:K(["nav-link",{active:p.value==="advanced","has-error":x.value.advanced}]),type:"button",onClick:te[2]||(te[2]=le=>p.value="advanced")},[te[8]||(te[8]=fe(" Advanced ",-1)),x.value.advanced?(l(),r("span",VE)):T("",!0)],2)]),t("li",WE,[t("button",{class:K(["nav-link",{active:p.value==="sandbox"}]),type:"button",onClick:te[3]||(te[3]=le=>p.value="sandbox")}," Sandbox ",2)])]),t("div",UE,[Se(be(xw,{mode:m.value,"form-data":i,errors:$,templates:k.value,"selected-template-id":S.value,session:w.value,"field-states":h,"onUpdate:formData":X,"onUpdate:selectedTemplateId":se,onOpenFolderBrowser:H,onOpenTemplateManager:I},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[nt,p.value==="general"]]),Se(be(dk,{mode:m.value,"form-data":i,errors:$,session:w.value,"field-states":h,"onUpdate:formData":X,onPreviewPermissions:P},null,8,["mode","form-data","errors","session","field-states"]),[[nt,p.value==="permissions"]]),Se(be(Dk,{mode:m.value,"form-data":i,errors:$,session:w.value,"field-states":h,"onUpdate:formData":X},null,8,["mode","form-data","errors","session","field-states"]),[[nt,p.value==="advanced"]]),Se(be(t$,{mode:m.value,"form-data":i,errors:$,session:w.value,"field-states":h,"onUpdate:formData":X},null,8,["mode","form-data","errors","session","field-states"]),[[nt,p.value==="sandbox"]])])])),M.value?(l(),r("div",HE,y(M.value),1)):T("",!0)]),ie.value?(l(),r("div",{key:0,class:K(["warning-banner","warning-banner-"+J.value])},[J.value==="reset"?(l(),r("small",qE,[...te[9]||(te[9]=[fe(" Changes require a ",-1),t("strong",null,"reset",-1),fe(" to take effect. This starts a new conversation. ",-1)])])):(l(),r("small",zE,[...te[10]||(te[10]=[fe(" Changes require a ",-1),t("strong",null,"restart",-1),fe(" to take effect. ",-1)])]))],2)):T("",!0),t("div",KE,[t("button",GE,y(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(l(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:N.value||!z.value,onClick:$e},[N.value?(l(),r("span",JE)):T("",!0),fe(" "+y(O.value),1)],8,YE)):T("",!0)])])])],512),be(vE,{ref_key:"permissionPreviewModal",ref:f,"working-directory":re.value,"setting-sources":i.setting_sources,"session-allowed-tools":B.value,"session-disallowed-tools":D.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},XE=ne(QE,[["__scopeId","data-v-da2afdcd"]]),ZE={class:"modal-dialog modal-dialog-centered"},eT={class:"modal-content"},tT={class:"modal-header"},sT={class:"modal-title",id:"manageSessionModalLabel"},nT={class:"modal-body"},oT={key:0,class:"text-center py-4"},aT={class:"text-muted"},iT={key:1},lT={key:2},rT={class:"text-muted"},cT={key:0,class:"text-center py-2"},uT={key:1,class:"alert alert-warning mt-3"},dT={class:"mb-0 mt-2"},fT={key:0,class:"text-muted"},mT={key:3},pT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},vT={class:"d-grid gap-2"},hT=["disabled"],_T=["disabled"],gT=["disabled"],bT=["disabled"],yT={class:"modal-footer"},wT={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},kT={__name:"SessionManageModal",setup(n){const e=ts(),s=he(),o=xe(),a=rt();je();const c=L(null),d=L(!1),f=L(""),m=L(""),p=L(null),u=L(null);let w=null;const v=L([]),k=L(!1),S=_(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function b(){p.value="reset"}async function g(){if(p.value="delete",v.value=[],!!c.value){k.value=!0;try{const C=await ke.get(`/api/sessions/${c.value.session_id}/descendants`);v.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),v.value=[]}finally{k.value=!1}}}function h(){p.value=null}async function i(){p.value==="reset"?await N():p.value==="delete"&&await M()}async function $(){if(c.value){d.value=!0,f.value="Restarting session...";try{const C=c.value.session_id,O=s.currentSessionId===C,z=await ke.post(`/api/sessions/${C}/restart`);if(z.success)console.log("Session restarted successfully"),O&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),w&&w.hide();else{const R=z.error||z.detail||"Failed to restart session";console.error("Failed to restart session:",R),m.value=`Failed to restart session: ${R}`}}catch(C){console.error("Error restarting session:",C);const O=C.data?.detail||C.message||"Unknown error";m.value=`Error restarting session: ${O}`}finally{d.value=!1}}}async function x(){if(c.value)try{w&&w.hide(),console.log("Ending session",c.value.session_id);const C=c.value.session_id;await ke.post(`/api/sessions/${C}/terminate`),s.currentSessionId===C&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),s.currentSessionId===c.value?.session_id&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function N(){if(c.value){d.value=!0,f.value="Resetting session...";try{const C=c.value.session_id,O=s.currentSessionId===C,z=await ke.post(`/api/sessions/${C}/reset`);if(z.success)console.log("Session reset successfully"),O&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),w&&w.hide();else{const R=z.error||z.detail||"Failed to reset session";console.error("Failed to reset session:",R),m.value=`Failed to reset session: ${R}`,p.value=null}}catch(C){console.error("Error resetting session:",C);const O=C.data?.detail||C.message||"Unknown error";m.value=`Error resetting session: ${O}`,p.value=null}finally{d.value=!1}}}async function M(){if(c.value){d.value=!0,f.value="Deleting session...";try{const C=c.value.session_id;await s.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),w&&w.hide()}catch(C){console.error("Error deleting session:",C);const O=C.data?.detail||C.message||"Unknown error";m.value=`Error deleting session: ${O}`,p.value=null}finally{d.value=!1}}}function A(){p.value=null,d.value=!1,f.value="",m.value="",v.value=[],k.value=!1}function E(){A(),c.value=null,o.hideModal()}return ve(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&w){const O=C.data||{};c.value=O.session,A(),w.show()}}),Me(()=>{u.value&&Ie(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(O=>O.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{w=new C(u.value),u.value.addEventListener("hidden.bs.modal",E)})}),De(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",E),w&&w.dispose()}),(C,O)=>(l(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",ZE,[t("div",eT,[t("div",tT,[t("h5",sT,y(p.value?S.value:"Manage Session"),1),O[1]||(O[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",nT,[d.value?(l(),r("div",oT,[O[2]||(O[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",aT,y(f.value),1)])):p.value==="reset"?(l(),r("div",iT,[...O[3]||(O[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(l(),r("div",lT,[O[9]||(O[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",rT,[O[4]||(O[4]=fe("This will permanently delete session ",-1)),t("strong",null,y(c.value?.name),1),O[5]||(O[5]=fe(".",-1))]),O[10]||(O[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),k.value?(l(),r("div",cT,[...O[6]||(O[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):v.value.length>0?(l(),r("div",uT,[O[7]||(O[7]=t("strong",null,"Cascading Deletion:",-1)),O[8]||(O[8]=fe(" This session has ",-1)),t("strong",null,y(v.value.length),1),fe(" child session"+y(v.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",dT,[(l(!0),r(oe,null,de(v.value,z=>(l(),r("li",{key:z.session_id,class:"small"},[t("strong",null,y(z.name||z.session_id),1),z.role?(l(),r("span",fT," ("+y(z.role)+")",1)):T("",!0)]))),128))])])):T("",!0)])):(l(),r("div",mT,[m.value?(l(),r("div",pT,[O[11]||(O[11]=t("strong",null,"Error:",-1)),fe(" "+y(m.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:O[0]||(O[0]=z=>m.value="")})])):T("",!0),O[18]||(O[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",vT,[t("button",{class:"btn btn-outline-primary text-start",onClick:$,disabled:d.value},[...O[12]||(O[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,hT),t("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:d.value},[...O[13]||(O[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,_T),O[16]||(O[16]=t("hr",{class:"my-2"},null,-1)),O[17]||(O[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:d.value},[...O[14]||(O[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,gT),t("button",{class:"btn btn-outline-danger text-start",onClick:g,disabled:d.value},[...O[15]||(O[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,bT)]),O[19]||(O[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),fe(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",yT,[p.value&&!d.value?(l(),r(oe,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),t("button",{type:"button",class:K(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:i},y(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):d.value?T("",!0):(l(),r("button",wT,"Cancel"))])])])],512))}},$T=ne(kT,[["__scopeId","data-v-6b832853"]]),ST={class:"modal-dialog modal-dialog-centered modal-lg"},xT={class:"modal-content"},CT={class:"modal-body"},ET={key:0,class:"text-center text-muted py-4"},TT={key:1},AT={class:"mb-3"},DT={class:"font-monospace small"},MT={class:"mb-3"},OT=["value"],NT={class:"mb-3"},LT={class:"mb-3"},IT={class:"mb-3"},jT={key:0},PT={class:"d-flex flex-wrap gap-1"},RT={key:1,class:"text-muted small"},BT={key:0,class:"mb-3"},FT={class:"d-flex flex-wrap gap-1"},VT={key:1,class:"mb-3"},WT={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},UT={class:"mb-3"},HT={class:"text-muted"},qT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},zT={__name:"SessionInfoModal",setup(n){const e=he(),s=je(),o=xe(),a=L(null),c=L(!1),d=L(null);let f=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},p=_(()=>{if(!a.value)return null;const b=e.initData.get(a.value);return b||(s.messagesBySession.get(a.value)||[]).find(i=>i.type==="system"&&(i.subtype==="init"||i.metadata?.subtype==="init")&&i.metadata?.init_data)?.metadata?.init_data||null});function u(b){return b?m[b]||b:"Default (Sonnet 4.5)"}function w(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function v(b){b.target.select()}function k(){a.value=null,c.value=!1}function S(){k(),o.hideModal()}return ve(()=>o.currentModal,b=>{if(b?.name==="session-info"&&f){const g=b.data||{};a.value=g.sessionId,c.value=!1,f.show()}}),Me(()=>{d.value&&Ie(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(g=>g.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{f=new b(d.value),d.value.addEventListener("hidden.bs.modal",S)})}),De(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",S),f&&f.dispose()}),(b,g)=>(l(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",ST,[t("div",xT,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",CT,[p.value?(l(),r("div",TT,[t("div",AT,[g[1]||(g[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",DT,y(a.value),1)]),t("div",MT,[g[2]||(g[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:v},null,8,OT)]),t("div",NT,[g[3]||(g[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,y(u(p.value.model)),1)]),t("div",LT,[g[4]||(g[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,y(p.value.permissionMode||"default"),1)]),t("div",IT,[g[5]||(g[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(l(),r("div",jT,[t("div",PT,[(l(!0),r(oe,null,de(p.value.allowed_tools||p.value.tools,h=>(l(),r("span",{key:h,class:"badge bg-secondary"},y(h),1))),128))])])):(l(),r("div",RT,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(l(),r("div",BT,[g[6]||(g[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",FT,[(l(!0),r(oe,null,de(p.value.commands,h=>(l(),r("span",{key:h,class:"badge bg-info"},y(h),1))),128))])])):T("",!0),p.value.systemPrompt?(l(),r("div",VT,[g[7]||(g[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",WT,y(w(p.value.systemPrompt)),1)])):T("",!0),t("div",UT,[t("h6",HT,[g[8]||(g[8]=fe(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:g[0]||(g[0]=h=>c.value=!c.value)},y(c.value?"Hide":"Show"),1)]),c.value?(l(),r("pre",qT,y(JSON.stringify(p.value,null,2)),1)):T("",!0)])])):(l(),r("div",ET," No session configuration data available "))]),g[10]||(g[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},KT=ne(zT,[["__scopeId","data-v-b28b39b3"]]),GT={class:"modal-dialog modal-dialog-centered modal-lg"},YT={class:"modal-content"},JT={class:"modal-body"},QT={key:0,class:"text-center text-muted py-4"},XT={key:1},ZT={class:"mb-3"},e2={class:"mb-3"},t2={class:"font-monospace small"},s2={class:"mb-3"},n2={class:"mb-3"},o2={class:"mb-3"},a2={key:0},i2={class:"d-flex flex-wrap gap-1"},l2={key:1,class:"text-muted small"},r2={class:"mb-3"},c2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},u2={key:1,class:"text-muted small"},d2={class:"mb-3"},f2={key:0,class:"badge bg-info"},m2={key:1,class:"badge bg-secondary"},p2={class:"mb-3"},v2={key:0,class:"font-monospace small"},h2={key:1,class:"text-muted small"},_2={key:0,class:"mb-3"},g2={key:0},b2={class:"list-unstyled mb-0"},y2={key:1,class:"text-muted small"},w2={class:"mb-3"},k2={class:"small"},$2={class:"mb-3"},S2={class:"small"},x2={__name:"MinionViewModal",setup(n){const e=xe(),s=L(null),o=L(null);let a=null;function c(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function d(p){if(!p)return"N/A";try{const u=new Date(p);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function f(){s.value=null}function m(){f(),e.hideModal()}return ve(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&a){const u=p.data||{};s.value=u.session,a.show()}}),Me(()=>{o.value&&Ie(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{a=new p(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),De(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),a&&a.dispose()}),(p,u)=>(l(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",GT,[t("div",YT,[u[11]||(u[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",JT,[s.value?(l(),r("div",XT,[t("div",ZT,[u[0]||(u[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,y(s.value.name||"Unnamed Minion"),1)]),t("div",e2,[u[1]||(u[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",t2,y(s.value.session_id),1)]),t("div",s2,[u[2]||(u[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,y(s.value.role||"Not specified"),1)]),t("div",n2,[u[3]||(u[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:K(["badge",c(s.value.state)])},y(s.value.state),3)])]),t("div",o2,[u[4]||(u[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(l(),r("div",a2,[t("div",i2,[(l(!0),r(oe,null,de(s.value.capabilities,w=>(l(),r("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(l(),r("div",l2,"None"))]),t("div",r2,[u[5]||(u[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(l(),r("div",c2,y(s.value.initialization_context),1)):(l(),r("div",u2,"Not specified"))]),t("div",d2,[u[6]||(u[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(l(),r("span",f2,"Yes")):(l(),r("span",m2,"No"))])]),t("div",p2,[u[7]||(u[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(l(),r("div",v2,y(s.value.parent_overseer_id),1)):(l(),r("div",h2," Root overseer (user-created) "))]),s.value.is_overseer?(l(),r("div",_2,[u[8]||(u[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(l(),r("div",g2,[t("ul",b2,[(l(!0),r(oe,null,de(s.value.child_minion_ids,w=>(l(),r("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(l(),r("div",y2,"No children"))])):T("",!0),t("div",w2,[u[9]||(u[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",k2,y(d(s.value.created_at)),1)]),t("div",$2,[u[10]||(u[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",S2,y(d(s.value.updated_at)),1)])])):(l(),r("div",QT," No minion data available "))]),u[12]||(u[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},C2=ne(x2,[["__scopeId","data-v-d996dc6f"]]),E2={class:"modal-dialog modal-dialog-centered"},T2={class:"modal-content"},A2={class:"modal-header"},D2={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},M2={class:"modal-body"},O2={key:0},N2={key:0,class:"text-center py-3"},L2={key:1,class:"card bg-light mb-3"},I2={class:"card-body py-2 px-3"},j2={class:"small"},P2={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},R2={key:0,class:"text-warning mt-1"},B2={key:2,class:"alert alert-warning py-2 small"},F2={key:1,class:"text-center py-3"},V2={key:0,class:"mb-3"},W2={key:1,class:"mb-3"},U2={key:2,class:"mb-3"},H2={class:"text-muted small mt-1"},q2={key:3,class:"mb-3"},z2={class:"mt-2 text-danger"},K2={class:"modal-footer"},G2=["disabled"],Y2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},J2={__name:"RestartModal",setup(n){const e=xe(),s=L(null);let o=null;const a=L("confirm"),c=L(!1),d=L(null),f=L(null),m=L(""),p=L(60);let u=null,w=null;async function v(){c.value=!0,f.value=null;try{d.value=await Qa()}catch(i){f.value=i.message||"Unknown error"}finally{c.value=!1}}async function k(){a.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Xa(),e.restartStatus="restarting",S()}catch(i){e.restartStatus="error",m.value=i.message||"Restart failed",e.restartInProgress=!1}}function S(){e.restartStatus="reconnecting",p.value=60;const i=Date.now();w=setInterval(()=>{const $=Math.floor((Date.now()-i)/1e3);p.value=Math.max(0,60-$)},1e3),setTimeout(()=>{u=setInterval(async()=>{try{(await fetch("/health")).ok&&(b(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-i>6e4&&(b(),e.restartStatus="error",m.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function b(){u&&(clearInterval(u),u=null),w&&(clearInterval(w),w=null)}function g(){a.value="confirm",d.value=null,f.value=null,m.value="",p.value=60,b()}function h(){e.restartInProgress||(g(),e.restartStatus="idle"),e.hideModal()}return ve(()=>e.currentModal,i=>{i?.name==="restart-server"&&o&&(g(),o.show(),v())}),Me(()=>{s.value&&Ie(async()=>{const{default:i}=await import("./modal-D6mKceGM.js").then($=>$.m);return{default:i}},__vite__mapDeps([0,1])).then(({default:i})=>{o=new i(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",h)})}),De(()=>{b(),s.value&&s.value.removeEventListener("hidden.bs.modal",h),o&&o.dispose()}),(i,$)=>(l(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",E2,[t("div",T2,[t("div",A2,[$[0]||($[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),a.value==="confirm"?(l(),r("button",D2)):T("",!0)]),t("div",M2,[a.value==="confirm"?(l(),r("div",O2,[$[5]||($[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),c.value?(l(),r("div",N2,[...$[1]||($[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):d.value?(l(),r("div",L2,[t("div",I2,[t("div",j2,[t("div",null,[$[2]||($[2]=t("strong",null,"Branch:",-1)),fe(" "+y(d.value.branch),1)]),t("div",null,[$[3]||($[3]=t("strong",null,"Last commit:",-1)),fe(" "+y(d.value.last_commit_message),1)]),t("div",P2,y(d.value.last_commit_hash?.substring(0,12)),1),d.value.has_uncommitted_changes?(l(),r("div",R2,[...$[4]||($[4]=[t("strong",null,"Warning:",-1),fe(" Uncommitted changes detected. git pull may fail. ",-1)])])):T("",!0)])])])):f.value?(l(),r("div",B2," Could not fetch git status: "+y(f.value),1)):T("",!0)])):a.value==="progress"?(l(),r("div",F2,[ae(e).restartStatus==="pulling"?(l(),r("div",V2,[...$[6]||($[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):ae(e).restartStatus==="restarting"?(l(),r("div",W2,[...$[7]||($[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):ae(e).restartStatus==="reconnecting"?(l(),r("div",U2,[$[8]||($[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),$[9]||($[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",H2,y(p.value)+"s remaining",1)])):ae(e).restartStatus==="error"?(l(),r("div",q2,[$[10]||($[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",z2,y(m.value),1)])):T("",!0)])):T("",!0)]),t("div",K2,[a.value==="confirm"?(l(),r(oe,{key:0},[$[11]||($[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:k,disabled:c.value}," Pull & Restart ",8,G2)],64)):ae(e).restartStatus==="error"?(l(),r("button",Y2,"Close")):T("",!0)])])])],512))}},Q2={class:"app-shell"},X2={class:"main-layout"},Z2={class:"center-panel"},eA={__name:"App",setup(n){const e=xe(),s=rt(),o=he(),a=ze(),c=Lt(),d=Ze(),f=ts(),m=L(null);function p(k){m.value=k}Tn("addAttachmentFromResource",p),Tn("pendingResourceAttachment",m);const u=_(()=>e.rightPanelVisible),w=_(()=>e.windowWidth<=1024);ve(()=>c.currentHasTasks,(k,S)=>{k&&!S&&e.setRightPanelVisible(!0)}),ve(()=>d.currentHasResources,(k,S)=>{k&&!S&&e.setRightPanelVisible(!0)}),Me(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const k=window.location.hash;if(k.startsWith("#/session/")){const S=k.replace("#/session/","");o.sessions.has(S)&&await o.selectSession(S)}else if(k.startsWith("#/timeline/")){const S=k.replace("#/timeline/","");f.push(`/timeline/${S}`)}window.addEventListener("popstate",v),window.addEventListener("resize",e.handleResize)}),De(()=>{window.removeEventListener("popstate",v),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function v(){const k=window.location.hash;if(k.startsWith("#/session/")){const S=k.replace("#/session/","");o.sessions.has(S)&&o.selectSession(S)}}return(k,S)=>{const b=cn("router-view");return l(),r("div",Q2,[be(i_),be(v_),be(N_),t("div",{id:"right-panel-backdrop",class:K({show:u.value&&w.value}),onClick:S[0]||(S[0]=g=>ae(e).setRightPanelVisible(!1))},null,2),t("div",X2,[t("main",Z2,[be(b)]),Se(be(jy,{class:K({"panel-overlay":w.value,"panel-visible":u.value})},null,8,["class"]),[[nt,u.value||w.value]])]),be(Zy),be(v1),be(P1),be(XE),be($T),be(KT),be(C2),be(J2)])}}},Cn=Wa(eA);Cn.use(Ua());Cn.use(t_);Cn.mount("#app");
