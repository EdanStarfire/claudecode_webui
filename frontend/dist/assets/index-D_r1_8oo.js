const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as t,o as u,d as bt,r as O,b as _,t as $,n as Ve,e as Y,f as K,u as Jt,w as re,g as vn,h as D,F as ie,i as ce,j as Ee,k as oo,l as se,v as ue,m as ae,p as pe,q as Os,s as Xt,x as ge,y as _e,z as Oe,A as Vs,B as io,C as pi,D as fi,E as Ye,T as ao,G as At,H as vi,I as hi}from"./vue-vendor-CZmLX7q9.js";import{m as Mt,p as Hs}from"./markdown-vendor-CQ3OZdP9.js";import{c as _i}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();const gi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},bi={__name:"NoSessionSelected",setup(n){return(e,s)=>(u(),m("div",gi,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},yi="modulepreload",$i=function(n){return"/"+n},hn={},be=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let c=function(f){return Promise.all(f.map(d=>Promise.resolve(d).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),r=l?.nonce||l?.getAttribute("nonce");i=c(s.map(f=>{if(f=$i(f),f in hn)return;hn[f]=!0;const d=f.endsWith(".css"),y=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${y}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":yi,d||(h.as="script"),h.crossOrigin="",h.href=f,r&&h.setAttribute("nonce",r),document.head.appendChild(h),d)return new Promise((p,w)=>{h.addEventListener("load",p),h.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return i.then(l=>{for(const r of l||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})};class ms extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Ot(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new ms(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof ms?s:(console.error("API request failed:",s),new ms(`Network error: ${s.message}`,0,null))}}async function wi(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[r,c]of Object.entries(e.params))c!=null&&o.append(r,c);const i=o.toString();i&&(s=`${n}?${i}`);const{params:a,...l}=e;return Ot(s,{...l,method:"GET"})}return Ot(s,{...e,method:"GET"})}async function Ei(n,e,s={}){return Ot(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ci(n,e,s={}){return Ot(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Si(n,e={}){return Ot(n,{...e,method:"DELETE"})}const te={get:wi,post:Ei,put:Ci,delete:Si},ne=bt("session",()=>{const n=O(new Map),e=O(null),s=O(new Map),o=O(new Map),i=O(new Set),a=O(!1);let l=null;const r=_(()=>n.value.get(e.value)),c=_(()=>Array.from(n.value.values()).sort((E,k)=>E.order-k.order)),f=E=>_(()=>c.value.filter(k=>k.project_id===E)),d=_({get:()=>s.value.get(e.value)||"",set:E=>{e.value&&s.value.set(e.value,E)}});async function y(){try{const E=await te.get("/api/sessions");return n.value.clear(),E.sessions.forEach(k=>{n.value.set(k.session_id,k)}),console.log(`Loaded ${n.value.size} sessions`),E.sessions}catch(E){throw console.error("Failed to fetch sessions:",E),E}}async function h(E,k){try{const M=(await te.post("/api/sessions",{project_id:E,...k})).session_id,S=(await te.get(`/api/sessions/${M}`)).session;return n.value.set(M,S),n.value=new Map(n.value),console.log(`Created session ${M}`),S}catch(j){throw console.error("Failed to create session:",j),j}}async function p(E){if(e.value===E&&!a.value)return;l&&(console.log(`Aborting pending selection to switch to ${E}`),l.abort(),l=null);const k=new AbortController;l=k,a.value=!0;try{if(e.value=E,k.signal.aborted){console.log(`Selection of ${E} aborted early`);return}let j=n.value.get(E);if(!j)try{const S=await te.get(`/api/sessions/${E}`);if(k.signal.aborted){console.log(`Selection of ${E} aborted after fetch`);return}j=S.session,n.value.set(E,j),n.value=new Map(n.value),console.log(`Fetched session ${E} for deeplink`)}catch(S){console.error(`Failed to fetch session ${E}:`,S);return}if(j&&(j.state==="created"||j.state==="terminated"))try{if(await A(E),k.signal.aborted){console.log(`Selection of ${E} aborted after start`);return}console.log(`Auto-started session ${E} (was in ${j.state} state)`);const S=6e4,L=200,P=5e3;let R=0,U=0;for(;R<S;){if(k.signal.aborted){console.log(`Selection of ${E} aborted during state wait`);return}const oe=n.value.get(E);if(oe&&oe.state==="active"){console.log(`Session ${E} is now active after ${R}ms`);break}if(R-U>=P){const B=n.value.get(E)?.state||"unknown";console.log(`Waiting for session ${E} to become active (current: ${B}, ${R/1e3}s elapsed)`),U=R}await new Promise(B=>setTimeout(B,L)),R+=L}const q=n.value.get(E);q&&q.state!=="active"&&console.warn(`Session ${E} did not become active within ${S/1e3}s (state: ${q.state}), continuing anyway`)}catch(S){console.error(`Failed to auto-start session ${E}:`,S)}if(k.signal.aborted){console.log(`Selection of ${E} aborted before message load`);return}if(await(await be(()=>Promise.resolve().then(()=>qi),void 0)).useMessageStore().loadMessages(E),k.signal.aborted){console.log(`Selection of ${E} aborted after message load`);return}await(await be(()=>Promise.resolve().then(()=>ua),void 0)).useWebSocketStore().connectSession(E),k.signal.aborted||console.log(`Selected session ${E}`)}finally{l===k&&(l=null),a.value=!1}}function w(E,k){const j=n.value.get(E);j?Object.assign(j,k):(n.value.set(E,k),console.log(`Added new session ${E} via WebSocket update`)),n.value=new Map(n.value)}async function b(E){i.value.add(E);try{await te.delete(`/api/sessions/${E}`),n.value.delete(E),s.value.delete(E),o.value.delete(E),n.value=new Map(n.value),e.value===E&&(e.value=null),console.log(`Deleted session ${E}`)}catch(k){throw console.error("Failed to delete session:",k),k}finally{i.value.delete(E)}}async function g(E,k){try{await te.put(`/api/sessions/${E}/name`,{name:k}),w(E,{name:k}),console.log(`Updated session ${E} name to "${k}"`)}catch(j){throw console.error("Failed to update session name:",j),j}}async function v(E,k){try{await te.post(`/api/sessions/${E}/permission-mode`,{mode:k}),w(E,{current_permission_mode:k});const j=o.value.get(E);j&&(j.permissionMode=k,o.value.set(E,j)),console.log(`Set permission mode for session ${E} to ${k}`)}catch(j){throw console.error("Failed to set permission mode:",j),j}}async function A(E){try{await te.post(`/api/sessions/${E}/start`),console.log(`Started session ${E}`)}catch(k){throw console.error("Failed to start session:",k),k}}async function C(E){try{await te.post(`/api/sessions/${E}/pause`),console.log(`Paused session ${E}`)}catch(k){throw console.error("Failed to pause session:",k),k}}async function T(E){try{await te.post(`/api/sessions/${E}/terminate`),console.log(`Terminated session ${E}`)}catch(k){throw console.error("Failed to terminate session:",k),k}}function N(E){return n.value.get(E)}function I(E,k){o.value.set(E,k),k.permissionMode&&w(E,{current_permission_mode:k.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:r,orderedSessions:c,sessionsInProject:f,currentInput:d,fetchSessions:y,createSession:h,selectSession:p,updateSession:w,deleteSession:b,updateSessionName:g,setPermissionMode:v,startSession:A,pauseSession:C,terminateSession:T,getSession:N,storeInitData:I}}),_n=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ne},Symbol.toStringTag,{value:"Module"})),me=bt("ui",()=>{const n=O(window.innerWidth<768),e=O(300),s=O(window.innerWidth),o=_(()=>s.value<768),i=O(!0),a=O(null),l=O(null),r=_(()=>a.value?{name:a.value,data:l.value}:null),c=O(!1),f=O("Loading...");function d(){n.value=!n.value}function y(C){n.value=C}function h(C){e.value=Math.max(200,Math.min(C,window.innerWidth*.3))}function p(C){i.value=C}function w(C,T=null){a.value=null,l.value=null,setTimeout(()=>{a.value=C,l.value=T},0)}function b(){a.value=null,l.value=null}function g(C="Loading..."){c.value=!0,f.value=C}function v(){c.value=!1}function A(){const C=s.value;s.value=window.innerWidth,s.value<768&&C>=768?n.value=!0:s.value>=768&&C<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:l,currentModal:r,isLoading:c,loadingMessage:f,toggleSidebar:d,setSidebarCollapsed:y,setSidebarWidth:h,setAutoScroll:p,showModal:w,hideModal:b,showLoading:g,hideLoading:v,handleResize:A}}),ve=bt("project",()=>{const n=O(new Map),e=O(null),s=_(()=>n.value.get(e.value)),o=_(()=>Array.from(n.value.values()).sort((b,g)=>b.order-g.order)),i=b=>n.value.get(b)?.is_multi_agent||!1;async function a(){try{const b=await te.get("/api/projects");return n.value.clear(),b.projects.forEach(g=>{n.value.set(g.project_id,g)}),console.log(`Loaded ${n.value.size} projects`),b.projects}catch(b){throw console.error("Failed to fetch projects:",b),b}}async function l(b,g,v=!1){try{const C=(await te.post("/api/projects",{name:b,working_directory:g,is_multi_agent:v})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(A){throw console.error("Failed to create project:",A),A}}async function r(b,g){try{await te.put(`/api/projects/${b}`,g),c(b,g),console.log(`Updated project ${b}`,g)}catch(v){throw console.error("Failed to update project:",v),v}}function c(b,g){const v=n.value.get(b);v&&(Object.assign(v,g),n.value=new Map(n.value))}async function f(b){try{await te.delete(`/api/projects/${b}`),n.value.delete(b),n.value=new Map(n.value),e.value===b&&(e.value=null),console.log(`Deleted project ${b}`)}catch(g){throw console.error("Failed to delete project:",g),g}}async function d(b){try{const g=await te.put(`/api/projects/${b}/toggle-expansion`),v=n.value.get(b);return v&&(v.is_expanded=g.is_expanded,n.value=new Map(n.value)),g.is_expanded}catch(g){throw console.error("Failed to toggle expansion:",g),g}}async function y(b){try{await te.put("/api/projects/reorder",{project_ids:b}),b.forEach((g,v)=>{const A=n.value.get(g);A&&(A.order=v)}),n.value=new Map(n.value),console.log("Reordered projects",b)}catch(g){throw console.error("Failed to reorder projects:",g),g}}async function h(b,g){try{await te.put(`/api/projects/${b}/sessions/reorder`,{session_ids:g});const v=n.value.get(b);v&&(v.session_ids=g,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${b}`,g)}catch(v){throw console.error("Failed to reorder sessions:",v),v}}function p(b){return n.value.get(b)}function w(b){if(!b)return"";const g=b.split(/[/\\]/).filter(v=>v);return g.length===0?"/":g.length===1?`/${g[0]}`:g.length===2?`/${g.join("/")}`:`.../${g.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:l,updateProject:r,updateProjectLocal:c,deleteProject:f,toggleExpansion:d,reorderProjects:y,reorderSessionsInProject:h,getProject:p,formatPath:w}}),G=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},ki={class:"session-header border-bottom p-3"},Ti={class:"project-name"},xi=["title"],Ai={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ne(),o=ve(),i=_(()=>s.sessions.get(e.sessionId)),a=_(()=>i.value?.name||e.sessionId),l=_(()=>{for(const c of o.projects.values())if(c.session_ids?.includes(e.sessionId))return c;return null}),r=_(()=>l.value?.name||"Unknown Project");return(c,f)=>(u(),m("div",ki,[t("div",null,[t("div",Ti,$(r.value),1),t("div",{class:"session-name",title:n.sessionId},$(a.value),9,xi)])]))}},Mi=G(Ai,[["__scopeId","data-v-89e9c269"]]),Oi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ni=["title"],Li={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Di={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ne(),o=_(()=>s.sessions.get(e.sessionId)),i=_(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=_(()=>{const c=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[c]||"#d3d3d3"}),l=_(()=>{const c=i.value;return c==="starting"||c==="processing"||c==="pending-prompt"}),r=_(()=>{if(!o.value)return"No session selected";const c=i.value,f=c.charAt(0).toUpperCase()+c.slice(1).replace("-"," "),d=o.value.name||"Unnamed Session",y=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${d}${y}: ${f}`});return(c,f)=>(u(),m("div",Oi,[o.value?(u(),m("div",{key:0,class:Y(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:Ve({width:"100%",backgroundColor:a.value}),title:r.value},null,14,Ni)):(u(),m("div",Li))]))}},Ii=G(Di,[["__scopeId","data-v-e8795bb7"]]),Pi={class:"session-status-bar border-top p-2 bg-light"},ji={class:"d-flex justify-content-between align-items-center gap-2"},Ri={class:"d-flex gap-2"},Vi=["disabled"],Hi={class:"mode-label"},Wi=["disabled"],Fi=["disabled"],Ui={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ne(),o=me(),i=_(()=>s.sessions.get(e.sessionId)),a=_(()=>i.value?.current_permission_mode||"default"),l={default:"🔒",acceptEdits:"✏️",plan:"📋",bypassPermissions:"☢️"},r=_(()=>l[a.value]||"🔒"),c=_(()=>a.value),f=["default","acceptEdits","plan"],d=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(v){console.error("Failed to cycle permission mode:",v)}return}const b=(f.indexOf(a.value)+1)%f.length,g=f[b];try{await s.setPermissionMode(e.sessionId,g)}catch(v){console.error("Failed to cycle permission mode:",v)}},y=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:i.value})},p=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(w,b)=>(u(),m("div",Pi,[t("div",ji,[t("div",Ri,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!i.value},[K($(r.value)+" ",1),t("span",Hi,$(c.value),1)],8,Vi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:y,disabled:!i.value},[...b[0]||(b[0]=[K(" ℹ️ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,Wi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[...b[1]||(b[1]=[K(" ⚙️ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,Fi)]),t("div",null,[t("button",{class:Y(["btn btn-sm",Jt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:p}," ⬇️ "+$(Jt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Bi=G(Ui,[["__scopeId","data-v-fdcd3535"]]),Ie=bt("message",()=>{const n=O(new Map),e=O(new Map),s=O(new Map),o=O(new Map),i=O(new Map),a=O(new Map),l=O(new Map),r=_(()=>{const S=ne();return n.value.get(S.currentSessionId)||[]}),c=_(()=>{const S=ne();return e.value.get(S.currentSessionId)||[]});async function f(S,L=null,P=0){try{const R=L||1e4,U=await te.get(`/api/sessions/${S}/messages?limit=${R}&offset=${P}`),q=U.messages||[],oe=U.total_count||q.length,B=U.has_more||!1;if(console.log(`Loaded ${q.length} of ${oe} messages for session ${S}`),n.value.set(S,q),q.length>0){const ee=q[q.length-1];ee.timestamp&&(l.value.set(S,ee.timestamp),console.log(`Tracked last received timestamp for session ${S}: ${ee.timestamp}`))}const H=new Set;q.forEach(ee=>{ee.type==="assistant"&&ee.metadata?.tool_uses&&ee.metadata.tool_uses.forEach(z=>{H.add(z.id)}),ee.type==="user"&&ee.metadata?.tool_results&&ee.metadata.tool_results.forEach(z=>{H.delete(z.tool_use_id);const de=a.value.get(S);de&&de.delete(z.tool_use_id)}),ee.type==="system"&&ee.metadata?.subtype==="client_launched"&&(H.forEach(z=>{T(S,z,"Session was restarted")}),H.clear()),ee.type==="system"&&ee.metadata?.subtype==="interrupt"&&(H.forEach(z=>{T(S,z,"Session was interrupted")}),H.clear()),ee.metadata?.has_tool_uses&&ee.metadata.tool_uses&&ee.metadata.tool_uses.forEach(z=>{w(S,z)}),ee.metadata?.has_tool_results&&ee.metadata.tool_results&&ee.metadata.tool_results.forEach(z=>{v(S,z)}),(ee.type==="permission_request"||ee.metadata?.has_permission_requests)&&b(S,ee),ee.type==="system"&&(ee.subtype==="init"||ee.metadata?.subtype==="init")&&ee.metadata?.init_data&&ne().storeInitData(S,ee.metadata.init_data)});const he=ne().sessions.get(S);return he&&!["active","paused","starting"].includes(he.state)&&(H.forEach(ee=>{T(S,ee,"Session was terminated")}),H.clear()),i.value.set(S,H),n.value=new Map(n.value),B&&console.warn(`Warning: Only loaded ${q.length} of ${oe} messages. Some messages may be missing.`),{messages:q,totalCount:oe,hasMore:B}}catch(R){throw console.error("Failed to load messages:",R),R}}function d(S,L){const P=i.value.get(S)||new Set;L.type==="assistant"&&L.metadata?.tool_uses&&L.metadata.tool_uses.forEach(R=>{P.add(R.id)}),L.type==="user"&&L.metadata?.tool_results&&L.metadata.tool_results.forEach(R=>{P.delete(R.tool_use_id);const U=a.value.get(S);U&&U.delete(R.tool_use_id)}),L.type==="system"&&L.metadata?.subtype==="client_launched"&&(P.forEach(R=>{T(S,R,"Session was restarted")}),P.clear()),L.type==="system"&&L.metadata?.subtype==="interrupt"&&(P.forEach(R=>{T(S,R,"Session was interrupted")}),P.clear()),i.value.set(S,P)}function y(S,L){n.value.has(S)||n.value.set(S,[]);const P=n.value.get(S);if(L.id){const R=P.findIndex(U=>U.id===L.id);if(R!==-1){console.log(`Skipping duplicate message ${L.id} (already exists at index ${R})`);return}}P.push(L),L.timestamp&&l.value.set(S,L.timestamp),d(S,L),n.value=new Map(n.value)}function h(S,L){e.value.has(S)||e.value.set(S,[]),e.value.get(S).push(L),e.value=new Map(e.value)}function p(S,L,P){const R=e.value.get(S);if(R){const U=R.find(q=>q.id===L);U&&(Object.assign(U,P),e.value=new Map(e.value))}}function w(S,L){const P=C(L.name,L.input);s.value.set(P,L.id);const R={id:L.id,name:L.name,input:L.input,signature:P,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return h(S,R),console.log(`Created tool call ${R.id} for ${R.name}`),R}function b(S,L){console.log("handlePermissionRequest received:",L);const P=L.metadata?.tool_name||L.tool_name,R=L.metadata?.input_params||L.input_params,U=L.metadata?.request_id||L.request_id,q=L.metadata?.suggestions||L.suggestions||[];console.log("Extracted data:",{toolName:P,inputParams:R,requestId:U,suggestions:q});const oe=C(P,R),B=s.value.get(oe);B?(o.value.set(U,B),p(S,B,{status:"permission_required",permissionRequestId:U,suggestions:q}),console.log(`Permission required for tool ${B}`,{suggestions:q})):console.warn("No tool use ID found for permission request signature:",oe,{toolName:P,inputParams:R,availableSignatures:Array.from(s.value.keys())})}function g(S,L){const P=o.value.get(L.request_id);if(P){const R={permissionDecision:L.decision,appliedUpdates:L.applied_updates||[]};L.decision==="allow"?R.status="executing":(R.status="completed",R.result={error:!0,message:L.reasoning||"Permission denied"},R.isExpanded=!1),p(S,P,R),console.log(`Permission ${L.decision} for tool ${P}`)}}function v(S,L){const P=L.tool_use_id;p(S,P,{status:L.is_error?"error":"completed",result:{error:L.is_error,content:L.content},isExpanded:!1}),console.log(`Tool ${P} ${L.is_error?"failed":"completed"}`)}function A(S,L){const P=e.value.get(S);if(P){const R=P.find(U=>U.id===L);R&&(R.isExpanded=!R.isExpanded,e.value=new Map(e.value))}}function C(S,L){if(!S)return"unknown:{}";if(!L||typeof L!="object")return`${S}:{}`;const P=JSON.stringify(L,Object.keys(L).sort());return`${S}:${P}`}function T(S,L,P){const R=a.value.get(S)||new Map;R.set(L,{reason:"denied",message:P}),a.value.set(S,R);const U=e.value.get(S);if(U){const q=U.find(oe=>oe.id===L);q&&q.isExpanded&&(q.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${L} as orphaned: ${P}`)}function N(S,L){return a.value.get(S)?.has(L)||!1}function I(S,L){return a.value.get(S)?.get(L)}function E(S,L){const P=i.value.get(S);P&&P.size>0&&(P.forEach(R=>T(S,R,L)),P.clear())}function k(S){n.value.delete(S),e.value.delete(S),n.value=new Map(n.value),e.value=new Map(e.value)}function j(S){return l.value.get(S)}async function M(S){const L=l.value.get(S);if(!L)return console.log(`No sync needed for session ${S} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${S} since ${L}`);const P=await te.get(`/api/sessions/${S}/messages?limit=1000&offset=0`),R=P.messages||[],U=P.has_more||!1,q=z=>z?typeof z=="number"?z*1e3:new Date(z).getTime():0,oe=q(L),B=R.filter(z=>z.timestamp?q(z.timestamp)>oe:!1);if(B.length===0)return console.log(`No missed messages for session ${S}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${B.length} missed messages for session ${S}`);const H=n.value.get(S)||[],le=new Set(H.map(z=>z.id).filter(Boolean)),he=B.filter(z=>!z.id||!le.has(z.id));if(console.log(`After deduplication: ${he.length} unique new messages`),he.length>0){const z=he.sort((Z,Q)=>{const fe=q(Z.timestamp),Ct=q(Q.timestamp);return fe-Ct}),de=n.value.get(S)||[],W=de.length>0?q(de[de.length-1].timestamp):0,F=q(z[0].timestamp),J=q(z[z.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:de.length,lastExisting:W,lastExistingDate:de.length>0?de[de.length-1].timestamp:"none",firstNew:F,firstNewDate:z[0].timestamp,lastNew:J,lastNewDate:z[z.length-1].timestamp,shouldAppend:F>W}),F>W){const Z=[...de,...z];n.value.set(S,Z),console.log(`✅ Appended ${z.length} new messages (no full sort needed)`)}else{const Z=[...de,...z].sort((Q,fe)=>{const Ct=q(Q.timestamp),Rt=q(fe.timestamp);return Ct-Rt});n.value.set(S,Z),console.log(`⚠️ Merged and sorted ${z.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${H.length} messages unchanged`);he.forEach(z=>{d(S,z),z.metadata?.has_tool_uses&&z.metadata.tool_uses&&z.metadata.tool_uses.forEach(de=>{w(S,de)}),z.metadata?.has_tool_results&&z.metadata.tool_results&&z.metadata.tool_results.forEach(de=>{v(S,de)}),(z.type==="permission_request"||z.metadata?.has_permission_requests)&&b(S,z),z.type==="system"&&(z.subtype==="init"||z.metadata?.subtype==="init")&&z.metadata?.init_data&&ne().storeInitData(S,z.metadata.init_data)});const ee=n.value.get(S);if(ee&&ee.length>0){const z=ee[ee.length-1];z.timestamp&&l.value.set(S,z.timestamp)}return n.value=new Map(n.value),{syncedCount:he.length,hasMore:U}}catch(P){return console.error(`Failed to sync messages for session ${S}:`,P),{syncedCount:0,hasMore:!1,error:P.message}}}const x=ne();return re(()=>Array.from(x.sessions.values()).map(L=>({id:L.session_id,state:L.state})),(S,L)=>{L&&S.forEach((P,R)=>{const U=L[R];if(!U||U.id!==P.id)return;const q=["active","paused","starting"].includes(U.state),oe=!["active","paused","starting"].includes(P.state);q&&oe&&E(P.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:vn(i),orphanedToolUses:vn(a),currentMessages:r,currentToolCalls:c,loadMessages:f,addMessage:y,addToolCall:h,updateToolCall:p,handleToolUse:w,handlePermissionRequest:b,handlePermissionResponse:g,handleToolResult:v,toggleToolExpansion:A,clearMessages:k,markToolUseOrphaned:T,isToolUseOrphaned:N,getOrphanedInfo:I,clearOrphanedToolUses:E,getLastReceivedTimestamp:j,syncMessages:M}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ie},Symbol.toStringTag,{value:"Module"}));function zi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function ss(n){return zi(n).toLocaleTimeString()}const Ki={class:"message-row message-row-user"},Yi=["title"],Gi={class:"message-content-column"},Ji=["innerHTML"],Xi={key:0,class:"tool-results mt-2"},Qi={class:"tool-results-header text-muted small mb-2"},Zi={class:"d-flex align-items-start gap-2"},ea={class:"flex-grow-1"},ta={class:"text-muted"},sa={key:0,class:"text-danger small"},na={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Mt.setOptions({breaks:!0,gfm:!0});const s=_(()=>ss(e.message.timestamp)),o=_(()=>`user
${s.value}`),i=_(()=>{const c=e.message.content||"";let f=Mt.parse(c);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),Hs.sanitize(f)}),a=_(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=_(()=>e.message.metadata?.tool_results||[]);function r(c,f){return c?c.length<=f?c:c.substring(0,f)+"...":""}return(c,f)=>(u(),m("div",Ki,[t("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,Yi),t("div",Gi,[t("div",{class:"message-text",innerHTML:i.value},null,8,Ji),a.value?(u(),m("div",Xi,[t("div",Qi,[f[1]||(f[1]=t("i",{class:"bi bi-tools"},null,-1)),K(" Tool Results ("+$(l.value.length)+") ",1)]),(u(!0),m(ie,null,ce(l.value,(d,y)=>(u(),m("div",{key:y,class:Y(["tool-result-summary p-2 mb-2 rounded",d.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",Zi,[t("span",null,$(d.is_error?"❌":"✅"),1),t("div",ea,[t("small",ta,"Tool: "+$(d.tool_use_id),1),d.is_error?(u(),m("div",sa,$(r(d.content,200)),1)):D("",!0)])])],2))),128))])):D("",!0)])]))}},oa=G(na,[["__scopeId","data-v-09875214"]]),ia={class:"thinking-block"},aa={class:"text-muted ms-auto"},la={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ra=["innerHTML"],ca={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=O(!1),o=_(()=>e.thinking?.length||0),i=_(()=>{const l=e.thinking||"",r=Mt.parse(l);return Hs.sanitize(r)});function a(){s.value=!s.value}return(l,r)=>(u(),m("div",ia,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[t("i",{class:Y(["bi",s.value?"bi-chevron-down":"bi-chevron-right"])},null,2),r[0]||(r[0]=t("span",{class:"thinking-label"},[t("i",{class:"bi bi-lightbulb"}),K(" Thinking ")],-1)),t("small",aa,$(o.value)+" characters",1)]),s.value?(u(),m("div",la,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,ra)])):D("",!0)]))}},da=G(ca,[["__scopeId","data-v-619a8344"]]),We=bt("websocket",()=>{const n=O(null),e=O(!1),s=O(0),o=10,i=O(null),a=O(!1),l=O(0),r=5,c=O(null);let f=null;const d=O(0),y=O(null),h=O(new Map),p=O(null),w=O(!1),b=O(0),g=5,v=O(null),A=5e3,C=1e3,T=O(Date.now()),N=O(Date.now()),I=O(Date.now());let E=null,k=null,j=null;const M=_(()=>e.value&&(a.value||!c.value)?"connected":e.value?"partial":"disconnected");function x(W){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${W}`}function S(W){const F={ui:{timer:()=>E,setTimer:J=>{E=J},lastPing:T,connected:e,name:"UI"},session:{timer:()=>k,setTimer:J=>{k=J},lastPing:N,connected:a,name:"Session"},legion:{timer:()=>j,setTimer:J=>{j=J},lastPing:I,connected:w,name:"Legion"}}[W];F.timer()&&clearInterval(F.timer()),F.setTimer(setInterval(()=>{if(!F.connected.value)return;const J=Date.now()-F.lastPing.value;if(J>A){console.warn(`⚠️ ${F.name} WebSocket heartbeat timeout (${J}ms since last ping) - forcing close to trigger reconnection`),F.connected.value=!1;const Q={ui:n,session:i,legion:p}[W];Q.value&&Q.value.readyState===WebSocket.OPEN&&Q.value.close()}},C)),console.log(`✅ Started heartbeat monitor for ${F.name} WebSocket`)}function L(W){const F={ui:{get:()=>E,set:J=>{E=J}},session:{get:()=>k,set:J=>{k=J}},legion:{get:()=>j,set:J=>{j=J}}}[W];F.get()&&(clearInterval(F.get()),F.set(null),console.log(`🛑 Stopped heartbeat monitor for ${W} WebSocket`))}function P(){if(n.value)return;const W=x("/ws/ui");console.log(`Connecting to UI WebSocket: ${W}`),n.value=new WebSocket(W),n.value.onopen=()=>{e.value=!0,s.value=0,T.value=Date.now(),S("ui"),console.log("UI WebSocket connected")},n.value.onmessage=F=>{const J=JSON.parse(F.data);le(J)},n.value.onclose=()=>{if(L("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const F=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${F}ms (attempt ${s.value})`),setTimeout(P,F)}},n.value.onerror=F=>{console.error("UI WebSocket error:",F)}}function R(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function U(W){d.value++;const F=d.value;if(console.log(`[Gen ${F}] Starting connection to session ${W}`),f&&(clearTimeout(f),f=null),await q(),d.value!==F){console.log(`[Gen ${F}] Connection cancelled (current generation: ${d.value})`);return}c.value=W,y.value=F;const J=x(`/ws/session/${W}`);console.log(`[Gen ${F}] Connecting to Session WebSocket: ${J}`),i.value=new WebSocket(J),i.value.onopen=async()=>{if(y.value!==F){console.log(`[Gen ${F}] Ignoring onopen (stale connection, current: ${y.value})`),i.value.close();return}a.value=!0,l.value=0,N.value=Date.now(),S("session"),console.log(`[Gen ${F}] Session WebSocket connected for ${W}`);const Z=h.value.get(W);if(h.value.set(W,!0),Z){console.log(`[Gen ${F}] Reconnection detected, syncing missed messages...`);try{const fe=await Ie().syncMessages(W);fe.syncedCount>0?console.log(`[Gen ${F}] ✅ Synced ${fe.syncedCount} missed messages`):fe.error?console.warn(`[Gen ${F}] ⚠️ Message sync failed: ${fe.error}`):console.log(`[Gen ${F}] No missed messages to sync`),fe.hasMore&&console.warn(`[Gen ${F}] ⚠️ More than 1000 missed messages, showing recent 1000 only`)}catch(Q){console.error(`[Gen ${F}] Error during message sync:`,Q)}}else console.log(`[Gen ${F}] Initial connection, no sync needed`)},i.value.onmessage=Z=>{if(y.value!==F){console.log(`[Gen ${F}] Ignoring message (stale connection, current: ${y.value})`);return}const Q=JSON.parse(Z.data);he(Q,W)},i.value.onclose=()=>{L("session"),a.value=!1,i.value=null,console.log(`[Gen ${F}] Session WebSocket closed for ${W}`);const Z=ne();if(Z.currentSessionId===W&&y.value===F&&l.value<r){l.value++;const Q=Math.min(2e3*l.value,3e4);console.log(`[Gen ${F}] Reconnecting Session WebSocket in ${Q}ms (attempt ${l.value})`),f=setTimeout(()=>{y.value===F&&Z.currentSessionId===W?(f=null,U(W)):console.log(`[Gen ${F}] Skipping reconnect (generation or session changed)`)},Q)}},i.value.onerror=Z=>{console.error(`[Gen ${F}] Session WebSocket error:`,Z)}}function q(){return new Promise(W=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const F=c.value,J=()=>{i.value=null,a.value=!1,c.value=null,y.value=null,l.value=0,F&&h.value.delete(F),W()};if(i.value.readyState===WebSocket.CLOSED)J();else{const Z=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),J()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Z),J()},{once:!0}),i.value.close()}}else c.value=null,y.value=null,W()})}function oe(W){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:W})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function B(W,F,J=!1,Z=null){if(i.value&&a.value){const Q={type:"permission_response",request_id:W,decision:F,apply_suggestions:J,timestamp:new Date().toISOString()};Z&&(Q.clarification_message=Z),i.value.send(JSON.stringify(Q)),console.log(`Sent permission ${F} for request ${W}`,{applySuggestions:J,clarification:Z})}}function H(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function le(W){const F=ne(),J=ve();switch(W.type){case"sessions_list":W.sessions&&Array.isArray(W.sessions)&&W.sessions.forEach(Z=>{F.updateSession(Z.session_id,Z)});break;case"state_change":W.data&&W.data.session_id&&W.data.session&&F.updateSession(W.data.session_id,W.data.session);break;case"project_updated":if(W.data&&W.data.project){const Z=W.data.project;J.updateProjectLocal(Z.project_id,Z)}break;case"project_deleted":W.data&&W.data.project_id&&J.projects.delete(W.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":T.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",W.type)}}function he(W,F){const J=ne();if(J.currentSessionId!==F){console.warn(`Ignoring message for session ${F} (current: ${J.currentSessionId})`);return}const Z=Ie();switch(W.type){case"message":const Q=W.data;if(!Q||!Q.type){console.warn("Received message event with invalid data:",W);break}if(Q.type==="permission_request"){Z.handlePermissionRequest(F,Q);break}if(Q.type==="permission_response"){Z.handlePermissionResponse(F,Q);break}Q.metadata?.has_tool_uses&&Q.metadata.tool_uses.forEach(fe=>{Z.handleToolUse(F,fe)}),Q.metadata?.has_tool_results&&Q.metadata.tool_results.forEach(fe=>{Z.handleToolResult(F,fe)}),Q.type==="system"&&(Q.subtype==="init"||Q.metadata?.subtype==="init")&&Q.metadata?.init_data&&J.storeInitData(F,Q.metadata.init_data),Z.addMessage(F,Q);break;case"permission_request":Z.handlePermissionRequest(F,W);break;case"permission_response":Z.handlePermissionResponse(F,W);break;case"tool_result":Z.handleToolResult(F,W);break;case"state_change":J.updateSession(F,W.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${F}`);break;case"ping":N.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function ee(W){z(),v.value=W;const F=x(`/ws/legion/${W}`);console.log(`Connecting to Legion WebSocket: ${F}`),p.value=new WebSocket(F),p.value.onopen=()=>{w.value=!0,b.value=0,I.value=Date.now(),S("legion"),console.log(`Legion WebSocket connected for ${W}`)},p.value.onmessage=J=>{const Z=JSON.parse(J.data);de(Z,W)},p.value.onclose=()=>{if(L("legion"),w.value=!1,p.value=null,console.log(`Legion WebSocket closed for ${W}`),v.value===W&&b.value<g){b.value++;const J=Math.min(2e3*b.value,3e4);setTimeout(()=>ee(W),J)}},p.value.onerror=J=>{console.error("Legion WebSocket error:",J)}}function z(){p.value&&(p.value.close(),p.value=null,w.value=!1,v.value=null)}function de(W,F){be(async()=>{const{useLegionStore:J}=await Promise.resolve().then(()=>$u);return{useLegionStore:J}},void 0).then(({useLegionStore:J})=>{const Z=J();switch(W.type){case"comm":W.comm&&(Z.addComm(F,W.comm),console.log("Legion WebSocket: Received new comm",W.comm));break;case"minion_created":W.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",W.data),be(async()=>{const{useSessionStore:Q}=await Promise.resolve().then(()=>_n);return{useSessionStore:Q}},void 0).then(({useSessionStore:Q})=>{Q().loadSessions()}));break;case"minion_updated":W.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",W.data),be(async()=>{const{useSessionStore:Q}=await Promise.resolve().then(()=>_n);return{useSessionStore:Q}},void 0).then(({useSessionStore:Q})=>{Q().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${F}`);break;case"ping":I.value=Date.now(),p.value?.readyState===WebSocket.OPEN&&p.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",W.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:a,sessionRetryCount:l,legionConnected:w,legionRetryCount:b,overallStatus:M,connectUI:P,disconnectUI:R,connectSession:U,disconnectSession:q,sendMessage:oe,sendPermissionResponse:B,interruptSession:H,connectLegion:ee,disconnectLegion:z}}),ua=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:We},Symbol.toStringTag,{value:"Module"})),ma={class:"base-tool-handler"},pa={class:"tool-section"},fa={class:"tool-parameters"},va={class:"tool-code"},ha={key:0,class:"tool-section"},_a={class:"tool-section-label"},ga={class:"tool-code"},ba={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=_(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,r)=>(u(),m("div",ma,[t("div",pa,[r[0]||(r[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",fa,[t("pre",va,$(s.value),1)])]),o.value?(u(),m("div",ha,[t("div",_a,$(i.value?"Error:":"Result:"),1),t("div",{class:Y(["tool-result",{"tool-result-error":i.value}])},[t("pre",ga,$(a.value),1)],2)])):D("",!0)]))}},ya=G(ba,[["__scopeId","data-v-1e69f57d"]]),$a={class:"read-tool-handler"},wa={class:"tool-section"},Ea={class:"read-file-info"},Ca={class:"file-path"},Sa={key:0,class:"read-range"},ka={key:0,class:"tool-section"},Ta={key:0,class:"tool-result tool-result-error"},xa={class:"tool-code"},Aa={key:1,class:"file-content-preview"},Ma={class:"content-header"},Oa={class:"line-count-badge"},Na={key:0,class:"preview-note"},La={class:"tool-code content-display"},Da={key:0,class:"more-indicator"},ps=100,Ia={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>{const p=e.toolCall.input?.offset,w=e.toolCall.input?.limit;return p!==void 0||w!==void 0}),i=_(()=>{const p=e.toolCall.input?.offset;return p!==void 0?p+1:1}),a=_(()=>{const p=e.toolCall.input?.offset||0,w=e.toolCall.input?.limit;return w!==void 0?p+w:"∞"}),l=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=_(()=>{if(!l.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),f=_(()=>r.value||!c.value?[]:c.value.split(`
`)),d=_(()=>f.value.length),y=_(()=>d.value>ps),h=_(()=>r.value?"":f.value.slice(0,ps).join(`
`));return(p,w)=>(u(),m("div",$a,[t("div",wa,[t("div",Ea,[w[0]||(w[0]=t("span",{class:"file-icon"},"📄",-1)),w[1]||(w[1]=t("strong",null,"Reading:",-1)),t("code",Ca,$(s.value),1),o.value?(u(),m("span",Sa,"Lines "+$(i.value)+"-"+$(a.value),1)):D("",!0)])]),l.value?(u(),m("div",ka,[r.value?(u(),m("div",Ta,[t("pre",xa,$(c.value),1)])):(u(),m("div",Aa,[t("div",Ma,[w[2]||(w[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Oa,$(d.value)+" lines",1),y.value?(u(),m("span",Na,"(showing first "+$(ps)+")")):D("",!0)]),t("pre",La,$(h.value),1),y.value?(u(),m("div",Da,"...")):D("",!0)]))])):D("",!0)]))}},Pa=G(Ia,[["__scopeId","data-v-1f2b0569"]]),ja={class:"write-tool-handler"},Ra={class:"tool-section"},Va={class:"write-file-info mb-2"},Ha={class:"file-path"},Wa={class:"write-content-preview"},Fa={class:"content-header"},Ua={class:"line-count-badge"},Ba={key:0,class:"preview-note"},qa={class:"tool-code content-display"},za={key:0,class:"more-indicator"},Ka={key:0,class:"tool-section"},Ya={key:0,class:"tool-result tool-result-error"},Ga={class:"tool-code"},Ja={key:1,class:"tool-result tool-result-success"},Xa={class:"success-message"},fs=100,Qa={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.content||""),i=_(()=>o.value.split(`
`)),a=_(()=>i.value.length),l=_(()=>a.value>fs),r=_(()=>i.value.slice(0,fs).join(`
`)),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!c.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,h)=>(u(),m("div",ja,[t("div",Ra,[t("div",Va,[h[0]||(h[0]=t("span",{class:"file-icon"},"📝",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",Ha,$(s.value),1)]),t("div",Wa,[t("div",Fa,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Ua,$(a.value)+" lines",1),l.value?(u(),m("span",Ba,"(showing first "+$(fs)+")")):D("",!0)]),t("pre",qa,$(r.value),1),l.value?(u(),m("div",za,"...")):D("",!0)])]),c.value?(u(),m("div",Ka,[f.value?(u(),m("div",Ya,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",Ga,$(d.value),1)])):(u(),m("div",Ja,[t("div",Xa,[h[4]||(h[4]=t("span",{class:"success-icon"},"✅",-1)),t("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):D("",!0)]))}},Za=G(Qa,[["__scopeId","data-v-ddc24a0f"]]),el={class:"bash-tool-handler"},tl={class:"tool-section"},sl={class:"bash-header"},nl={class:"bash-header-content"},ol={key:0,class:"bash-description"},il={key:1,class:"bash-flags"},al={class:"bash-command-section"},ll={class:"bash-command-content"},rl={key:0,class:"tool-section"},cl={key:0,class:"bash-output"},dl={key:1,class:"bash-output-empty"},ul={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.command||""),o=_(()=>e.toolCall.input?.description||""),i=_(()=>e.toolCall.input?.timeout),a=_(()=>e.toolCall.input?.run_in_background||!1),l=_(()=>i.value||a.value),r=_(()=>{const h=[];return i.value&&h.push(`timeout: ${i.value}ms`),a.value&&h.push("background"),h.join(", ")}),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>f.value?"tool-result-error":"tool-result-success"),y=_(()=>{if(!c.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,p)=>(u(),m("div",el,[t("div",tl,[t("div",sl,[p[1]||(p[1]=t("span",{class:"bash-icon"},"💻",-1)),t("div",nl,[o.value?(u(),m("div",ol,[p[0]||(p[0]=t("strong",null,"Description:",-1)),K(" "+$(o.value),1)])):D("",!0),l.value?(u(),m("div",il,$(r.value),1)):D("",!0)])]),t("div",al,[p[2]||(p[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",ll,$(s.value),1)])]),c.value?(u(),m("div",rl,[t("div",{class:Y(["tool-result",d.value])},[p[3]||(p[3]=t("strong",null,"Output:",-1)),y.value?(u(),m("pre",cl,$(y.value),1)):(u(),m("div",dl,"No output"))],2)])):D("",!0)]))}},ml=G(ul,[["__scopeId","data-v-ab50fe73"]]),pl={class:"todo-tool-handler"},fl={class:"tool-section"},vl={class:"todo-header"},hl={class:"todo-summary"},_l={key:0,class:"todo-count todo-count-completed"},gl={key:1,class:"todo-count todo-count-in-progress"},bl={key:2,class:"todo-count todo-count-pending"},yl={class:"todo-checklist"},$l={class:"todo-checkbox"},wl={class:"todo-content"},El={key:0,class:"tool-section"},Cl={key:0,class:"tool-result tool-result-error"},Sl={class:"tool-code"},kl={key:1,class:"tool-result tool-result-success"},Tl={class:"success-message"},xl={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.todos||[]),o=_(()=>s.value.filter(d=>d.status==="completed").length),i=_(()=>s.value.filter(d=>d.status==="in_progress").length),a=_(()=>s.value.filter(d=>d.status==="pending").length);function l(d){return{pending:"☐",in_progress:"◐",completed:"☑"}[d]||"☐"}const r=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!r.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,y)=>(u(),m("div",pl,[t("div",fl,[t("div",vl,[y[0]||(y[0]=t("span",{class:"todo-icon"},"📋",-1)),y[1]||(y[1]=t("strong",null,"Task List:",-1)),t("div",hl,[o.value>0?(u(),m("span",_l,$(o.value)+" completed ",1)):D("",!0),i.value>0?(u(),m("span",gl,$(i.value)+" in progress ",1)):D("",!0),a.value>0?(u(),m("span",bl,$(a.value)+" pending ",1)):D("",!0)])]),t("div",yl,[(u(!0),m(ie,null,ce(s.value,(h,p)=>(u(),m("div",{key:p,class:Y(["todo-item",`todo-${h.status}`])},[t("span",$l,$(l(h.status)),1),t("span",wl,$(h.content),1)],2))),128))])]),r.value?(u(),m("div",El,[c.value?(u(),m("div",Cl,[y[2]||(y[2]=t("strong",null,"Error:",-1)),t("pre",Sl,$(f.value),1)])):(u(),m("div",kl,[t("div",Tl,[y[3]||(y[3]=t("span",{class:"success-icon"},"✅",-1)),t("strong",null,"Task list updated ("+$(s.value.length)+" tasks)",1)])]))])):D("",!0)]))}},Al=G(xl,[["__scopeId","data-v-bbe55ee7"]]),Ml={class:"edit-tool-handler"},Ol={class:"tool-section"},Nl={class:"edit-file-info"},Ll={class:"file-path"},Dl={key:0,class:"replace-all-badge"},Il={class:"edit-diff-container"},Pl={class:"diff-header"},jl={class:"diff-stats"},Rl={class:"stat-removed"},Vl={class:"stat-added"},Hl={class:"unified-diff"},Wl={class:"diff-scroll-container"},Fl={class:"diff-marker"},Ul={class:"diff-content"},Bl={key:0,class:"tool-section"},ql={key:0,class:"tool-result tool-result-error"},zl={class:"tool-code"},Kl={key:1,class:"tool-result tool-result-success"},Yl={class:"success-message"},Gl={key:0,class:"success-detail"},Jl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.old_string||""),i=_(()=>e.toolCall.input?.new_string||""),a=_(()=>e.toolCall.input?.replace_all||!1),l=_(()=>{const p=_i(s.value,o.value,i.value,"","",{context:3}).split(`
`),w=[];for(let b=4;b<p.length;b++){const g=p[b];g&&(g.startsWith("-")?w.push({type:"removed",content:g.substring(1)}):g.startsWith("+")?w.push({type:"added",content:g.substring(1)}):g.startsWith(" ")?w.push({type:"context",content:g.substring(1)}):g.startsWith("@@")&&w.push({type:"hunk",content:g}))}return w}),r=_(()=>l.value.filter(h=>h.type==="removed").length),c=_(()=>l.value.filter(h=>h.type==="added").length),f=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=_(()=>{if(!f.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,p)=>(u(),m("div",Ml,[t("div",Ol,[t("div",Nl,[p[0]||(p[0]=t("span",{class:"file-icon"},"✏️",-1)),p[1]||(p[1]=t("strong",null,"Editing:",-1)),t("code",Ll,$(s.value),1),a.value?(u(),m("span",Dl,"Replace All")):D("",!0)]),t("div",Il,[t("div",Pl,[p[2]||(p[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",jl,[t("span",Rl,"-"+$(r.value),1),t("span",Vl,"+"+$(c.value),1)])]),t("div",Hl,[t("div",Wl,[(u(!0),m(ie,null,ce(l.value,(w,b)=>(u(),m("div",{key:b,class:Y(["diff-line",{"diff-line-removed":w.type==="removed","diff-line-added":w.type==="added","diff-line-context":w.type==="context","diff-line-hunk":w.type==="hunk"}])},[t("span",Fl,$(w.type==="removed"?"-":w.type==="added"?"+":w.type==="hunk"?"@":" "),1),t("span",Ul,$(w.content),1)],2))),128))])])])]),f.value?(u(),m("div",Bl,[d.value?(u(),m("div",ql,[p[3]||(p[3]=t("strong",null,"Error:",-1)),t("pre",zl,$(y.value),1)])):(u(),m("div",Kl,[t("div",Yl,[p[4]||(p[4]=t("span",{class:"success-icon"},"✅",-1)),p[5]||(p[5]=t("strong",null,"File edited successfully",-1)),a.value?(u(),m("span",Gl,"(all occurrences replaced)")):D("",!0)])]))])):D("",!0)]))}},Xl=G(Jl,[["__scopeId","data-v-16b90adc"]]),Ql={class:"search-tool-handler"},Zl={class:"tool-section"},er={class:"search-info"},tr={class:"search-icon"},sr={class:"search-pattern"},nr={key:0,class:"search-path"},or={key:1,class:"search-filters"},ir={key:0,class:"filter-badge"},ar={key:1,class:"filter-badge"},lr={key:2,class:"filter-badge"},rr={key:0,class:"tool-section"},cr={key:0,class:"tool-result tool-result-error"},dr={class:"tool-code"},ur={key:1,class:"search-results"},mr={class:"results-header"},pr={class:"results-label"},fr={class:"results-count-badge"},vr={class:"results-content"},hr={class:"tool-code"},_r={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="Grep");_(()=>e.toolCall.name==="Glob");const o=_(()=>e.toolCall.input?.pattern||"Unknown"),i=_(()=>e.toolCall.input?.path||null),a=_(()=>e.toolCall.input?.type||null),l=_(()=>e.toolCall.input?.glob||null),r=_(()=>e.toolCall.input?.["-i"]||!1),c=_(()=>a.value||l.value||r.value),f=_(()=>s.value?"🔍":"📁"),d=_(()=>s.value?"Searching content":"Finding files"),y=_(()=>s.value?"Matches":"Files found"),h=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!h.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),b=_(()=>!h.value||p.value||!w.value?0:w.value.split(`
`).filter(v=>v.trim()).length);return(g,v)=>(u(),m("div",Ql,[t("div",Zl,[t("div",er,[t("span",tr,$(f.value),1),t("strong",null,$(d.value)+":",1),t("code",sr,$(o.value),1),i.value?(u(),m("span",nr,"in "+$(i.value),1)):D("",!0),c.value?(u(),m("span",or,[a.value?(u(),m("span",ir,"type: "+$(a.value),1)):D("",!0),l.value?(u(),m("span",ar,"glob: "+$(l.value),1)):D("",!0),r.value?(u(),m("span",lr,"case-insensitive")):D("",!0)])):D("",!0)])]),h.value?(u(),m("div",rr,[p.value?(u(),m("div",cr,[v[0]||(v[0]=t("strong",null,"Error:",-1)),t("pre",dr,$(w.value),1)])):(u(),m("div",ur,[t("div",mr,[t("span",pr,$(y.value)+":",1),t("span",fr,$(b.value)+" "+$(b.value===1?"match":"matches"),1)]),t("div",vr,[t("pre",hr,$(w.value),1)])]))])):D("",!0)]))}},gn=G(_r,[["__scopeId","data-v-0d272c39"]]),gr={class:"web-tool-handler"},br={class:"tool-section"},yr={class:"web-info"},$r={class:"web-icon"},wr=["href"],Er={key:1,class:"web-query"},Cr={key:0,class:"web-prompt-container"},Sr={class:"prompt-content"},kr={key:1,class:"web-domains"},Tr={class:"domains-label"},xr={key:0,class:"tool-section"},Ar={key:0,class:"tool-result tool-result-error"},Mr={class:"tool-code"},Or={key:1,class:"web-results"},Nr={class:"results-header"},Lr={class:"results-label"},Dr={class:"results-content"},Ir={class:"tool-code"},Pr={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="WebFetch");_(()=>e.toolCall.name==="WebSearch");const o=_(()=>e.toolCall.input?.url||null),i=_(()=>e.toolCall.input?.query||null),a=_(()=>e.toolCall.input?.prompt||null),l=_(()=>e.toolCall.input?.allowed_domains||[]),r=_(()=>e.toolCall.input?.blocked_domains||[]),c=_(()=>l.value.length>0?l.value:r.value.length>0?r.value:[]),f=_(()=>l.value.length>0?"Allowed domains":r.value.length>0?"Blocked domains":"Domains"),d=_(()=>s.value?"🌐":"🔎"),y=_(()=>s.value?"Fetching URL":"Searching web"),h=_(()=>s.value?"Fetched content":"Search results"),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=_(()=>{if(!p.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,v)=>(u(),m("div",gr,[t("div",br,[t("div",yr,[t("span",$r,$(d.value),1),t("strong",null,$(y.value)+":",1),o.value?(u(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},$(o.value),9,wr)):i.value?(u(),m("code",Er,$(i.value),1)):D("",!0)]),a.value?(u(),m("div",Cr,[v[0]||(v[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Sr,$(a.value),1)])):D("",!0),c.value.length>0?(u(),m("div",kr,[t("span",Tr,$(f.value)+":",1),(u(!0),m(ie,null,ce(c.value,A=>(u(),m("span",{key:A,class:"domain-badge"},$(A),1))),128))])):D("",!0)]),p.value?(u(),m("div",xr,[w.value?(u(),m("div",Ar,[v[1]||(v[1]=t("strong",null,"Error:",-1)),t("pre",Mr,$(b.value),1)])):(u(),m("div",Or,[t("div",Nr,[t("span",Lr,$(h.value)+":",1)]),t("div",Dr,[t("pre",Ir,$(b.value),1)])]))])):D("",!0)]))}},bn=G(Pr,[["__scopeId","data-v-62b55b55"]]),jr={class:"task-tool-handler"},Rr={class:"tool-section"},Vr={class:"task-header"},Hr={key:0,class:"agent-type-badge"},Wr={key:0,class:"task-description"},Fr={class:"description-content"},Ur={key:1,class:"task-prompt-container"},Br={class:"prompt-header"},qr={class:"prompt-length"},zr={class:"prompt-code"},Kr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Jr={key:1,class:"agent-output"},Xr={class:"output-header"},Qr={key:0,class:"output-count-badge"},Zr={class:"output-content"},ec={class:"tool-code"},tc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.description||null),o=_(()=>e.toolCall.input?.prompt||null),i=_(()=>e.toolCall.input?.subagent_type||null),a=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=_(()=>{if(!a.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=_(()=>r.value?r.value.split(`
`).length:0);return(f,d)=>(u(),m("div",jr,[t("div",Rr,[t("div",Vr,[d[0]||(d[0]=t("span",{class:"task-icon"},"🤖",-1)),d[1]||(d[1]=t("strong",null,"Agent Task:",-1)),i.value?(u(),m("span",Hr,$(i.value),1)):D("",!0)]),s.value?(u(),m("div",Wr,[d[2]||(d[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Fr,$(s.value),1)])):D("",!0),o.value?(u(),m("div",Ur,[t("div",Br,[d[3]||(d[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",qr,$(o.value.length)+" characters",1)]),t("pre",zr,$(o.value),1)])):D("",!0)]),a.value?(u(),m("div",Kr,[l.value?(u(),m("div",Yr,[d[4]||(d[4]=t("strong",null,"Error:",-1)),t("pre",Gr,$(r.value),1)])):(u(),m("div",Jr,[t("div",Xr,[d[5]||(d[5]=t("span",{class:"output-label"},"Agent Output:",-1)),c.value>0?(u(),m("span",Qr,$(c.value)+" lines",1)):D("",!0)]),t("div",Zr,[t("pre",ec,$(r.value),1)])]))])):D("",!0)]))}},sc=G(tc,[["__scopeId","data-v-c520c244"]]),nc={class:"notebook-edit-tool-handler"},oc={class:"tool-section"},ic={class:"notebook-info"},ac={class:"file-path"},lc={class:"cell-info mt-2"},rc={class:"info-row"},cc={class:"info-row"},dc={key:0,class:"info-row"},uc={class:"badge bg-info"},mc={key:0,class:"source-preview mt-3"},pc={class:"preview-header"},fc={class:"preview-stats"},vc={class:"source-code"},hc={key:0,class:"tool-section"},_c={key:0},gc={key:1,class:"text-danger"},bc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.notebook_path||"Unknown"),o=_(()=>e.toolCall.input?.cell_id),i=_(()=>e.toolCall.input?.cell_type||"code"),a=_(()=>e.toolCall.input?.edit_mode||"replace"),l=_(()=>e.toolCall.input?.new_source||""),r=_(()=>l.value.split(`
`).length),c=_(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const y=a.value;return y==="insert"?"Cell inserted successfully":y==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(y,h)=>(u(),m("div",nc,[t("div",oc,[t("div",ic,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"📓",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",ac,$(s.value),1)]),t("div",lc,[t("div",rc,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,$(o.value||"N/A"),1)]),t("div",cc,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:Y(["badge",c.value])},$(i.value),3)]),a.value?(u(),m("div",dc,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",uc,$(a.value),1)])):D("",!0)]),l.value?(u(),m("div",mc,[t("div",pc,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",fc,$(r.value)+" lines",1)]),t("pre",vc,[t("code",null,$(l.value),1)])])):D("",!0)]),n.toolCall.result?(u(),m("div",hc,[h[8]||(h[8]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Y(["tool-result",f.value])},[n.toolCall.result.success!==!1?(u(),m("div",_c,[h[6]||(h[6]=t("i",{class:"bi bi-check-circle"},null,-1)),K(" "+$(d.value),1)])):(u(),m("div",gc,[h[7]||(h[7]=t("i",{class:"bi bi-x-circle"},null,-1)),K(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)])):D("",!0)]))}},yc=G(bc,[["__scopeId","data-v-bf9ef8f9"]]),$c={class:"shell-tool-handler"},wc={class:"tool-section"},Ec={class:"shell-info"},Cc={class:"shell-icon"},Sc={key:0,class:"shell-id"},kc={key:0,class:"filter-info mt-2"},Tc={class:"filter-pattern"},xc={key:0,class:"tool-section"},Ac={class:"result-header mb-2"},Mc={key:0,class:"mb-2"},Oc={class:"shell-output"},Nc={key:1,class:"mb-2"},Lc={class:"shell-output shell-output-error"},Dc={key:0},Ic={key:1,class:"text-danger"},Pc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="BashOutput"?"📤":e.toolCall.name==="KillShell"?"🛑":"🐚"),o=_(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=_(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=_(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=_(()=>e.toolCall.input?.filter);function r(p,w){if(!p)return null;const b=new RegExp(`<${w}>([\\s\\S]*?)<\\/${w}>`,"i"),g=p.match(b);return g?g[1].trim():null}const c=_(()=>{const p=e.toolCall.result;if(!p)return null;let w=p;if(p.content&&(w=p.content),typeof w=="string")return{status:r(w,"status"),stdout:r(w,"stdout"),stderr:r(w,"stderr"),exit_code:r(w,"exit_code")};if(Array.isArray(w)){const b=w.find(g=>g.type==="text")?.text||"";return{status:r(b,"status"),stdout:r(b,"stdout"),stderr:r(b,"stderr"),exit_code:r(b,"exit_code")}}return{status:p.status||w.status,stdout:p.stdout||p.output||w.stdout||w.output,stderr:p.stderr||w.stderr,exit_code:p.exit_code||w.exit_code}});_(()=>{if(e.toolCall.name==="BashOutput"){const p=c.value;if(!p)return null;const w=[];return p.stdout&&w.push(p.stdout),p.stderr&&w.push(`[stderr]
${p.stderr}`),w.length>0?w.join(`

`):null}return null});const f=_(()=>c.value?.status),d=_(()=>{const p=f.value;return p==="running"?"bg-success":p==="completed"?"bg-secondary":p==="killed"||p==="terminated"?"bg-danger":"bg-info"}),y=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const p=c.value;if(p?.status==="running"&&!p.stdout&&!p.stderr)return"No new output since last check";if(p?.status==="failed")return`Shell failed (exit code ${p.exit_code||"unknown"})`}return"Operation completed"});return(p,w)=>(u(),m("div",$c,[t("div",wc,[t("div",Ec,[t("span",Cc,$(s.value),1),t("strong",null,$(o.value)+":",1),a.value?(u(),m("code",Sc,"Shell "+$(a.value),1)):D("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(u(),m("div",kc,[w[0]||(w[0]=t("strong",null,"Filter:",-1)),t("code",Tc,$(l.value),1)])):D("",!0)]),n.toolCall.result?(u(),m("div",xc,[t("div",Ac,[t("strong",null,$(i.value)+":",1),f.value?(u(),m("span",{key:0,class:Y(["badge",d.value])},$(f.value),3)):D("",!0)]),c.value?.stdout?(u(),m("div",Mc,[w[1]||(w[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Oc,[t("pre",null,[t("code",null,$(c.value.stdout),1)])])])):D("",!0),c.value?.stderr?(u(),m("div",Nc,[w[2]||(w[2]=t("div",{class:"output-label text-danger"},[t("i",{class:"bi bi-exclamation-triangle"}),K(" Errors: ")],-1)),t("div",Lc,[t("pre",null,[t("code",null,$(c.value.stderr),1)])])])):D("",!0),!c.value?.stdout&&!c.value?.stderr?(u(),m("div",{key:2,class:Y(["tool-result",y.value])},[n.toolCall.result.success!==!1?(u(),m("div",Dc,[w[3]||(w[3]=t("i",{class:"bi bi-check-circle"},null,-1)),K(" "+$(h.value),1)])):(u(),m("div",Ic,[w[4]||(w[4]=t("i",{class:"bi bi-x-circle"},null,-1)),K(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)):D("",!0)])):D("",!0)]))}},yn=G(Pc,[["__scopeId","data-v-99efb136"]]),jc={class:"skill-tool-handler"},Rc={key:0,class:"tool-section"},Vc={class:"d-flex align-items-center gap-2"},Hc={class:"text-muted small"},Wc={key:0,class:"skill-content-body"},Fc={class:"skill-content-text"},Uc={key:1,class:"tool-section mt-3"},Bc={class:"tool-result tool-result-error"},qc={class:"tool-code"},zc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ne(),i=O(!1);function a(){i.value=!i.value}_(()=>e.toolCall.input?.command||"Unknown Skill"),_(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),_(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const l=_(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const p=s.messagesBySession.get(h)||[],w=p.findIndex(v=>v.type==="user"&&v.metadata?.has_tool_results&&v.metadata?.tool_results?.some(A=>A.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let b=null,g=null;for(let v=w+1;v<Math.min(w+3,p.length);v++){const A=p[v];if(A.type!=="user")continue;const C=A.content||"";C.includes("<command-message>")&&C.includes("skill is running")?b=A:C.startsWith("Base directory for this skill:")&&(g=A)}return{running:b,content:g}});_(()=>{const h=l.value.content;if(!h)return null;const w=(h.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return w&&w[1]?w[1].trim():null});const r=_(()=>{const h=l.value.content;if(!h)return"";const p=h.content||"",w=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return p.replace(w,"").trim()}),c=_(()=>r.value.length>0),f=_(()=>r.value?r.value.split(`
`).length:0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=_(()=>{if(!d.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,p)=>(u(),m("div",jc,[c.value?(u(),m("div",Rc,[t("div",{class:"skill-content-header",onClick:a},[t("div",Vc,[t("i",{class:Y(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),p[0]||(p[0]=t("strong",null,"Skill Content",-1)),t("span",Hc,"("+$(f.value)+" lines)",1)])]),i.value?(u(),m("div",Wc,[t("pre",Fc,$(r.value),1)])):D("",!0)])):D("",!0),d.value?(u(),m("div",Uc,[p[1]||(p[1]=t("div",{class:"tool-section-label text-danger"},[t("i",{class:"bi bi-x-circle"}),K(" Error: ")],-1)),t("div",Bc,[t("pre",qc,$(y.value),1)])])):D("",!0)]))}},Kc=G(zc,[["__scopeId","data-v-ba9a91da"]]),Yc={class:"slashcommand-tool-handler"},Gc={key:0,class:"tool-section"},Jc={class:"d-flex align-items-center gap-2"},Xc={class:"text-muted small"},Qc={key:0,class:"command-content-body"},Zc={class:"command-content-text"},ed={key:1,class:"tool-section mt-3"},td={class:"tool-result tool-result-error"},sd={class:"tool-code"},nd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ne(),i=O(!1);function a(){i.value=!i.value}_(()=>e.toolCall.input?.command||"Unknown Command"),_(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),_(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const l=_(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const p=s.messagesBySession.get(h)||[],w=p.findIndex(v=>v.type==="user"&&v.metadata?.has_tool_results&&v.metadata?.tool_results?.some(A=>A.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let b=null,g=null;for(let v=w+1;v<Math.min(w+3,p.length);v++){const A=p[v];if(A.type!=="user")continue;const C=A.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?b=A:C.includes("ARGUMENTS:")&&(g=A)}return{running:b,content:g}});_(()=>{const h=l.value.running;if(!h)return null;const w=(h.content||"").match(/<command-args>(.+?)<\/command-args>/s);return w&&w[1]?w[1].trim():null});const r=_(()=>{const h=l.value.content;if(!h)return"";const p=h.content||"",w=/\nARGUMENTS:.*$/s;return p.replace(w,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),c=_(()=>r.value.length>0),f=_(()=>r.value?r.value.split(`
`).length:0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=_(()=>{if(!d.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,p)=>(u(),m("div",Yc,[c.value?(u(),m("div",Gc,[t("div",{class:"command-content-header",onClick:a},[t("div",Jc,[t("i",{class:Y(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),p[0]||(p[0]=t("strong",null,"Command Content",-1)),t("span",Xc,"("+$(f.value)+" lines)",1)])]),i.value?(u(),m("div",Qc,[t("pre",Zc,$(r.value),1)])):D("",!0)])):D("",!0),d.value?(u(),m("div",ed,[p[1]||(p[1]=t("div",{class:"tool-section-label text-danger"},[t("i",{class:"bi bi-x-circle"}),K(" Error: ")],-1)),t("div",td,[t("pre",sd,$(y.value),1)])])):D("",!0)]))}},od=G(nd,[["__scopeId","data-v-17d3444e"]]),id={class:"exit-plan-mode-tool-handler"},ad={class:"tool-section"},ld={key:0,class:"plan-content mt-2"},rd={class:"plan-text"},cd={key:0,class:"tool-section"},dd={key:0},ud={key:1,class:"text-danger"},md={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.plan),o=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),m("div",id,[t("div",ad,[a[1]||(a[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"📋"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(u(),m("div",ld,[a[0]||(a[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",rd,$(s.value),1)])):D("",!0)]),n.toolCall.result?(u(),m("div",cd,[a[4]||(a[4]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Y(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),m("div",dd,[...a[2]||(a[2]=[t("i",{class:"bi bi-check-circle"},null,-1),K(" Permission mode reverted to default ",-1)])])):(u(),m("div",ud,[a[3]||(a[3]=t("i",{class:"bi bi-x-circle"},null,-1)),K(" "+$(n.toolCall.result.error||"Failed to exit plan mode"),1)]))],2)])):D("",!0)]))}},pd=G(md,[["__scopeId","data-v-bd35183e"]]),fd={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},vd={class:"tool-status-icon"},hd=["title"],_d={class:"d-flex align-items-center gap-2"},gd={class:"text-muted"},bd={key:0,class:"card-body"},yd={key:0,class:"alert alert-warning mb-3"},$d={class:"d-flex align-items-center"},wd={class:"mb-0 small"},Ed={key:1,class:"permission-prompt mt-3"},Cd={class:"alert alert-warning mb-3"},Sd={class:"mb-0"},kd={class:"tool-name"},Td={key:0,class:"suggestions-section mb-3"},xd={class:"alert alert-info mb-0"},Ad={class:"suggestion-details p-2 bg-white rounded"},Md={class:"permission-buttons d-flex gap-2 mb-3"},Od=["disabled"],Nd=["disabled"],Ld=["disabled"],Dd={class:"guidance-section mt-3"},Id=["disabled"],Pd=["disabled"],jd={key:2,class:"mt-3"},Rd={class:"alert alert-warning mb-0"},Vd={class:"d-flex align-items-center"},Hd={class:"mb-0 small"},Wd={key:3,class:"tool-section"},Fd={class:"alert alert-danger mb-0"},Ud={key:0},Bd={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ne(),i=We(),a=O(!1),l=O(null),r=O(""),c=_(()=>s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),f=_(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),d={Read:Pa,Write:Za,Bash:ml,TodoWrite:Al,Edit:Xl,Grep:gn,Glob:gn,WebFetch:bn,WebSearch:bn,Task:sc,NotebookEdit:yc,BashOutput:yn,KillShell:yn,SlashCommand:od,Skill:Kc,ExitPlanMode:pd},y=_(()=>{const M=e.toolCall.name;return d[M]?d[M]:ya}),h=_(()=>{const M=[];switch(e.toolCall.status){case"pending":M.push("border-secondary");break;case"permission_required":M.push("border-warning");break;case"executing":M.push("border-primary");break;case"completed":b.value||e.toolCall.permissionDecision==="deny"?M.push("border-danger"):M.push("border-success");break;case"error":M.push("border-danger");break}return M.join(" ")}),p=_(()=>{switch(e.toolCall.status){case"pending":return"🔄";case"permission_required":return"❓";case"executing":return"⚡";case"completed":return e.toolCall.permissionDecision==="deny"?"❌":b.value?"💥":"✅";case"error":return"💥";default:return"🔧"}}),w=_(()=>ss(e.toolCall.timestamp)),b=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=_(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function v(M){if(!M)return"";const x=M.replace(/\\/g,"/").split("/");return x[x.length-1]}function A(M,x=200){return M?M.length<=x?M:M.substring(0,x)+"...":""}function C(M){if(!M)return null;if(M.content){const x=M.content.match(/exit code (\d+)/i);if(x)return parseInt(x[1])}return M.error?1:0}function T(M,x){const S=M?M.split(`
`).length:0;return{added:x?x.split(`
`).length:0,removed:S}}const N=_(()=>{const M=e.toolCall.name,x=e.toolCall.input||{},S=e.toolCall.result,L=e.toolCall.status;switch(M){case"Bash":case"Shell":case"Command":{const P=A(x.command,200);if(L==="completed"&&S){const R=C(S);return`Bash: ${P} (exit ${R})`}return`Bash: ${P}`}case"SlashCommand":{const P=A(x.command,200);return L==="completed"&&S?`SlashCommand: ${P}`:`SlashCommand: ${P}`}case"Edit":{const P=v(x.file_path);if(L==="completed"&&S&&!S.error){const{added:R,removed:U}=T(x.old_string,x.new_string);return R===U?`Edit: ${P} (${R} lines changed)`:`Edit: ${P} (${R} lines added, ${U} removed)`}return`Edit: ${P}`}case"Read":{const P=v(x.file_path);if(x.offset!==void 0||x.limit!==void 0){const U=(x.offset||0)+1,q=x.limit?(x.offset||0)+x.limit:"∞";return`Read: ${P} (lines ${U}-${q})`}return`Read: ${P} (full file)`}case"Write":{const P=v(x.file_path);if(L==="completed"&&S&&!S.error&&x.content){const R=x.content.split(`
`).length;return`Write: ${P} (${R} lines written)`}return`Write: ${P}`}case"Skill":{const P=x.command||"Unknown";return L==="completed"&&S?S.error?`Skill: ${P} (error)`:`Skill: ${P} (completed)`:`Skill: ${P}`}case"Task":{const P=x.subagent_type||"general",R=x.description||"Task";return L==="completed"&&S?S.error?`Task: (${P}) ${R} (error)`:`Task: (${P}) ${R} (completed)`:`Task: (${P}) ${R}`}case"TodoWrite":{if(x.todos&&Array.isArray(x.todos)){const P=x.todos.filter(q=>q.status==="completed").length,R=x.todos.length,U=x.todos.find(q=>q.status==="in_progress");return U?`Todo: Working on "${U.content}"`:`Todo: ${P}/${R} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const P=x.pattern||"",R=M==="Grep"?"Grep":"Glob";if(L==="completed"&&S&&!S.error){let U=0;return S.content&&(U=S.content.split(`
`).filter(oe=>oe.trim()).length),`${R}: "${P}" (${U} results)`}return`${R}: "${P}"`}case"WebFetch":case"WebSearch":{const P=x.url||x.query||"";if(M==="WebSearch"){const U=x.query||"",q=U.length>50?U.substring(0,50)+"...":U;return L==="completed"&&S?S.error?`Web: ${q} (error)`:`Web: ${q} (success)`:`Web: ${q}`}let R="";try{P&&(R=new URL(P.startsWith("http")?P:`https://${P}`).hostname)}catch{R=P.length>50?P.substring(0,50)+"...":P}return L==="completed"&&S?S.error?`Web: ${R} (error)`:`Web: ${R} (success)`:`Web: ${R||P}`}case"NotebookEdit":{const P=v(x.notebook_path),R=x.cell_number!==void 0?x.cell_number:"?",U=x.edit_mode||"replace";return`NotebookEdit: ${P} cell #${R} (${U})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${x.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${x.shell_id||"unknown"}`;default:return`${M}: executed`}}),I=_(()=>{const M=e.toolCall.name,x=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(M)?x.command||M:["Edit","Read","Write","NotebookEdit"].includes(M)&&(x.file_path||x.notebook_path)||M});function E(){const M=o.currentSessionId;M&&s.toggleToolExpansion(M,e.toolCall.id)}function k(M){return M.type==="setMode"?`Set permission mode to "${M.mode}"`:M.type==="allow"?`Allow tool: ${M.tool}`:JSON.stringify(M)}async function j(M,x,S=null){if(!a.value){a.value=!0,M==="allow"?l.value=x?"approve-apply":"approve":S?l.value="deny-guidance":l.value="deny";try{const L=o.currentSessionId;if(L){const P=x&&e.toolCall.suggestions?e.toolCall.suggestions:[];s.handlePermissionResponse(L,{request_id:e.toolCall.permissionRequestId,decision:M,reasoning:M==="allow"?"User allowed permission":"User denied permission",applied_updates:P})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,M,x,S)}catch(L){console.error("Failed to send permission response:",L)}finally{a.value=!1,l.value=null}}}return(M,x)=>(u(),m("div",{class:Y(["tool-call-card card",h.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:E},[t("div",fd,[t("span",vd,$(p.value),1),t("strong",{class:"tool-name",title:I.value},$(N.value),9,hd)]),t("div",_d,[t("small",gd,$(w.value),1),t("i",{class:Y(["bi",n.toolCall.isExpanded?"bi-chevron-up":"bi-chevron-down"])},null,2)])]),n.toolCall.isExpanded?(u(),m("div",bd,[c.value?(u(),m("div",yd,[t("div",$d,[x[6]||(x[6]=t("i",{class:"bi bi-x-circle me-2",style:{"font-size":"1.2rem"}},null,-1)),t("div",null,[x[5]||(x[5]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",wd,$(f.value?.message||"Session was terminated"),1)])])])):D("",!0),(u(),Ee(oo(y.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!c.value?(u(),m("div",Ed,[t("div",Cd,[x[9]||(x[9]=t("p",{class:"mb-2"},[t("strong",null,"🔐 Permission Required")],-1)),t("p",Sd,[x[7]||(x[7]=K("Claude wants to use the ",-1)),t("code",kd,$(n.toolCall.name),1),x[8]||(x[8]=K(" tool.",-1))])]),g.value?(u(),m("div",Td,[t("div",xd,[x[10]||(x[10]=t("h6",{class:"mb-2"},[t("i",{class:"bi bi-lightbulb me-2"}),K(" Suggested Permission Update ")],-1)),x[11]||(x[11]=t("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),t("div",Ad,[(u(!0),m(ie,null,ce(n.toolCall.suggestions,(S,L)=>(u(),m("div",{key:L,class:"suggestion-item"},[t("code",null,$(k(S)),1)]))),128))]),x[12]||(x[12]=t("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):D("",!0),t("div",Md,[g.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:x[0]||(x[0]=S=>j("allow",!0)),disabled:a.value},[x[13]||(x[13]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),K(" "+$(a.value&&l.value==="approve-apply"?"⏳ Submitting...":"✅ Approve & Apply"),1)],8,Od)):D("",!0),t("button",{class:Y(["btn",g.value?"btn-outline-success":"btn-success"]),onClick:x[1]||(x[1]=S=>j("allow",!1)),disabled:a.value},[x[14]||(x[14]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),K(" "+$(a.value&&l.value==="approve"?"⏳ Submitting...":g.value?"✅ Approve Only":"✅ Approve"),1)],10,Nd),t("button",{class:"btn btn-danger",onClick:x[2]||(x[2]=S=>j("deny",!1)),disabled:a.value},[x[15]||(x[15]=t("i",{class:"bi bi-x-circle me-1"},null,-1)),K(" "+$(a.value&&l.value==="deny"?"⏳ Submitting...":"❌ Deny"),1)],8,Ld)]),t("div",Dd,[x[17]||(x[17]=t("label",{class:"form-label fw-bold"},[t("i",{class:"bi bi-chat-left-text me-1"}),K(" Provide Guidance (Optional) ")],-1)),x[18]||(x[18]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),se(t("textarea",{"onUpdate:modelValue":x[3]||(x[3]=S=>r.value=S),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Id),[[ue,r.value]]),r.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:x[4]||(x[4]=S=>j("deny",!1,r.value)),disabled:a.value},[x[16]||(x[16]=t("i",{class:"bi bi-arrow-repeat me-1"},null,-1)),K(" "+$(a.value&&l.value==="deny-guidance"?"⏳ Submitting...":"💡 Provide Guidance & Continue"),1)],8,Pd)):D("",!0)])])):D("",!0),n.toolCall.status==="permission_required"&&c.value?(u(),m("div",jd,[t("div",Rd,[t("div",Vd,[x[20]||(x[20]=t("i",{class:"bi bi-shield-x me-2",style:{"font-size":"1.2rem"}},null,-1)),t("div",null,[x[19]||(x[19]=t("strong",null,"Permission Request Cancelled",-1)),t("p",Hd,$(f.value?.message||"Session was terminated before permission could be granted"),1)])])])])):D("",!0),n.toolCall.permissionDecision==="deny"?(u(),m("div",Wd,[t("div",Fd,[x[21]||(x[21]=t("i",{class:"bi bi-x-circle"},null,-1)),x[22]||(x[22]=K(" Permission denied ",-1)),n.toolCall.result?.message?(u(),m("span",Ud," - "+$(n.toolCall.result.message),1)):D("",!0)])])):D("",!0)])):D("",!0)],2))}},qd=G(Bd,[["__scopeId","data-v-0f254afa"]]),zd={class:"message-row message-row-assistant"},Kd=["title"],Yd={class:"message-content-column"},Gd={key:0,class:"thinking-block mb-2"},Jd=["innerHTML"],Xd={key:2,class:"tool-calls"},Qd={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ne();Mt.setOptions({breaks:!0,gfm:!0});const i=_(()=>ss(e.message.timestamp)),a=_(()=>e.message.metadata?.model||null),l=_(()=>{const w=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${w}`}),r=_(()=>{const w=e.message.content||"";return w.trim().length>0&&w!=="Assistant response"}),c=_(()=>{const w=e.message.content||"";let b=Mt.parse(w);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),Hs.sanitize(b)}),f=_(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),d=_(()=>e.message.metadata?.thinking_content||""),y=_(()=>e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0),h=_(()=>e.message.metadata?.tool_uses||[]),p=_(()=>{const w=o.currentSessionId;if(!w)return[];const b=s.toolCallsBySession.get(w)||[];return h.value.map(g=>{const v=b.find(A=>A.id===g.id);return v||{id:g.id,name:g.name,input:g.input,status:"pending",result:null,timestamp:g.timestamp||e.message.timestamp,isExpanded:!0}})});return(w,b)=>(u(),m("div",zd,[t("div",{class:"message-speaker",title:l.value},[...b[0]||(b[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Kd),t("div",Yd,[f.value?(u(),m("div",Gd,[ae(da,{thinking:d.value},null,8,["thinking"])])):D("",!0),r.value?(u(),m("div",{key:1,class:"message-text",innerHTML:c.value},null,8,Jd)):D("",!0),y.value?(u(),m("div",Xd,[(u(!0),m(ie,null,ce(p.value,g=>(u(),Ee(qd,{key:g.id,toolCall:g},null,8,["toolCall"]))),128))])):D("",!0)])]))}},Zd=G(Qd,[["__scopeId","data-v-726a72a7"]]),eu={class:"message-row message-row-system"},tu=["title"],su={class:"message-content-column"},nu={class:"system-text"},ou={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>ss(e.message.timestamp)),o=_(()=>`system
${s.value}`);return(i,a)=>(u(),m("div",eu,[t("div",{class:"message-speaker",title:o.value},[...a[0]||(a[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,tu),t("div",su,[t("span",nu,$(n.message.content),1)])]))}},$n=G(ou,[["__scopeId","data-v-4999cd2b"]]),iu={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>{switch(e.message.type){case"user":return oa;case"assistant":return Zd;case"system":return $n;default:return $n}});return(o,i)=>(u(),Ee(oo(s.value),{message:n.message},null,8,["message"]))}},au=G(iu,[["__scopeId","data-v-f283c218"]]),lu={key:0,class:"text-muted text-center py-5"},ru={__name:"MessageList",setup(n){const e=Ie(),s=me(),o=O(null),i=_(()=>e.currentMessages.filter(c=>l(c)));_(()=>e.currentToolCalls);async function a(){s.autoScrollEnabled&&(await Os(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}re(()=>e.currentMessages.length,a),re(()=>e.currentToolCalls.length,a),re(()=>e.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),a),pe(()=>{setTimeout(()=>{a()},100)});function l(c){const f=c.subtype||c.metadata?.subtype;if(c.type==="system"&&f==="init"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const d=c.content||"";if(d.match(/^Tool results?: \d+ results?$/i)||d.trim()==="")return!1}if(c.type==="user"){const d=c.content||"";if(d.includes("<command-message>")&&d.includes("skill is running")||d.startsWith("Base directory for this skill:"))return!1}if(c.type==="user"){const d=c.content||"";if(d.includes("<command-message>")&&d.includes("<command-name>")&&d.includes("<command-args>")||d.includes("ARGUMENTS:")&&(d.includes("<command-name>")||d.match(/\nARGUMENTS:/)))return!1}return!0}function r(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,f)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),m("div",lu," No messages yet. Start a conversation! ")):D("",!0),(u(!0),m(ie,null,ce(i.value,(d,y)=>(u(),Ee(au,{key:`msg-${d.timestamp}-${y}`,message:r(d)},null,8,["message"]))),128))],512))}},cu=G(ru,[["__scopeId","data-v-f94a8763"]]),du={class:"border-top bg-light"},uu={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},mu={class:"d-flex gap-2 align-items-end px-2 py-1"},pu=["placeholder","disabled","onKeydown"],fu=["disabled"],vu={__name:"InputArea",setup(n){const e=ne(),s=We(),o=O(null),i=_({get:()=>e.currentInput,set:h=>{e.currentInput=h}}),a=_(()=>e.currentSession?.is_processing||!1),l=_(()=>s.sessionConnected),r=_(()=>e.currentSession?.state==="starting"),c=_(()=>r.value?"Session is starting...":l.value?"Type your message to Claude Code...":"Waiting for connection...");function f(){const h=o.value;if(!h)return;h.style.height="auto";const p=Math.min(h.scrollHeight,parseInt(getComputedStyle(h).maxHeight));h.style.height=p+"px"}function d(){i.value.trim()&&(s.sendMessage(i.value),i.value="",o.value&&(o.value.style.height="auto"))}function y(){s.interruptSession()}return(h,p)=>(u(),m("div",du,[l.value?D("",!0):(u(),m("div",uu,[...p[1]||(p[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-exclamation-triangle-fill flex-shrink-0",viewBox:"0 0 16 16"},[t("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})],-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"—",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),t("div",mu,[se(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":p[0]||(p[0]=w=>i.value=w),class:"form-control",placeholder:c.value,disabled:r.value||!l.value,rows:"1",onInput:f,onKeydown:Xt(ge(d,["exact","prevent"]),["enter"])},null,40,pu),[[ue,i.value]]),a.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:y}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!i.value.trim()||!l.value||r.value,onClick:d}," Send ",8,fu))])]))}},hu=G(vu,[["__scopeId","data-v-d2ca2648"]]),_u={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},gu={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},bu={class:"text-secondary"},yu={class:"d-flex flex-column flex-grow-1 overflow-hidden"},lo={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ne(),o=me(),i=_(()=>s.currentSession),a=_(()=>o.isLoading),l=_(()=>o.loadingMessage);return pe(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),re(()=>e.sessionId,async(r,c)=>{if(r!==c&&r!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(r)}finally{o.hideLoading()}}}),_e(()=>{}),(r,c)=>(u(),m("div",_u,[a.value?(u(),m("div",gu,[c[0]||(c[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",bu,$(l.value),1)])):D("",!0),i.value?(u(),Ee(Mi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):D("",!0),t("div",yu,[ae(cu)]),ae(hu),i.value?(u(),Ee(Ii,{key:2,"session-id":e.sessionId},null,8,["session-id"])):D("",!0),i.value?(u(),Ee(Bi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):D("",!0)]))}},ot=bt("legion",()=>{const n=O(new Map),e=O(new Map),s=O(new Map),o=O(new Map),i=O(new Map),a=O(new Map),l=O(null),r=_(()=>n.value.get(l.value)||[]),c=_(()=>e.value.get(l.value)||[]),f=_(()=>s.value.get(l.value)||[]),d=_(()=>o.value.get(l.value)||[]);function y(k){l.value=k}async function h(k,j=100,M=0){try{const x=await te.get(`/api/legions/${k}/timeline?limit=${j}&offset=${M}`),S=x.comms||[],L=x.total_count||S.length,P=x.has_more||!1;return S.sort((R,U)=>new Date(R.timestamp)-new Date(U.timestamp)),console.log(`Loaded ${S.length} of ${L} comms for legion ${k}`),n.value.set(k,S),n.value=new Map(n.value),{comms:S,totalCount:L,hasMore:P}}catch(x){throw console.error("Failed to load timeline:",x),x}}function p(k,j){n.value.has(k)||n.value.set(k,[]),n.value.get(k).push(j),n.value=new Map(n.value)}async function w(k,j){try{const x=(await te.post(`/api/legions/${k}/comms`,j)).comm;return console.log(`Sent comm ${x.comm_id} to legion ${k}`),x}catch(M){throw console.error("Failed to send comm:",M),M}}async function b(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function g(k,j){try{const x=(await te.post(`/api/legions/${k}/minions`,j)).minion;return await b(k),console.log(`Created minion ${x.minion_id} in legion ${k}`),x}catch(M){throw console.error("Failed to create minion:",M),M}}async function v(k){try{const M=(await te.get(`/api/legions/${k}/hordes`)).hordes||[];return console.log(`Loaded ${M.length} hordes for legion ${k}`),s.value.set(k,M),s.value=new Map(s.value),M}catch(j){throw console.error("Failed to load hordes:",j),j}}async function A(k){try{const M=(await te.get(`/api/legions/${k}/channels`)).channels||[];return console.log(`Loaded ${M.length} channels for legion ${k}`),o.value.set(k,M),o.value=new Map(o.value),M}catch(j){throw console.error("Failed to load channels:",j),j}}async function C(k){try{const j=await te.get(`/api/channels/${k}`),M=j.channel||j;return console.log(`Loaded details for channel ${k}`),i.value.set(k,M),i.value=new Map(i.value),M}catch(j){throw console.error("Failed to load channel details:",j),j}}async function T(k,j=1e3){try{const x=(await te.get(`/api/channels/${k}/comms?limit=${j}`)).comms||[];return console.log(`Loaded ${x.length} comms for channel ${k}`),x.sort((S,L)=>new Date(S.timestamp)-new Date(L.timestamp)),a.value.set(k,x),a.value=new Map(a.value),x}catch(M){throw console.error("Failed to load channel comms:",M),M}}async function N(k,j){try{await te.post(`/api/channels/${k}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:j}),console.log(`Added minion ${j} to channel ${k}`),await C(k)}catch(M){throw console.error("Failed to add member to channel:",M),M}}async function I(k,j){try{await te.post(`/api/channels/${k}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:j}),console.log(`Removed minion ${j} from channel ${k}`),await C(k)}catch(M){throw console.error("Failed to remove member from channel:",M),M}}function E(k){n.value.delete(k),e.value.delete(k),s.value.delete(k),o.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value),s.value=new Map(s.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:s,channelsByLegion:o,channelDetailsByChannel:i,channelCommsByChannel:a,currentLegionId:l,currentComms:r,currentMinions:c,currentHordes:f,currentChannels:d,setCurrentLegion:y,loadTimeline:h,addComm:p,sendComm:w,loadMinions:b,createMinion:g,loadHordes:v,loadChannels:A,loadChannelDetails:C,loadChannelComms:T,addMemberToChannel:N,removeMemberFromChannel:I,clearLegionData:E}}),$u=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:ot},Symbol.toStringTag,{value:"Module"})),wu={class:"timeline-header border-bottom p-3"},Eu={class:"project-name"},Cu=["title"],Su={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=_(()=>s.projects.get(e.legionId)),i=_(()=>o.value?.name||"Legion");return(a,l)=>(u(),m("div",wu,[t("div",null,[t("div",Eu,$(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Cu)])]))}},ku=G(Su,[["__scopeId","data-v-44f386f5"]]),Tu={class:"timeline-status-bar border-top p-2 bg-light"},xu={class:"d-flex justify-content-end"},Au={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=me();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),m("div",Tu,[t("div",xu,[t("button",{class:Y(["btn btn-sm",Jt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," ⬇️ "+$(Jt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Mu=G(Au,[["__scopeId","data-v-891c73db"]]),Ou={class:"comm-composer border-top p-3"},Nu={class:"d-flex gap-2 mb-2"},Lu={class:"flex-grow-1"},Du=["disabled"],Iu={label:"Minions"},Pu=["value"],ju={key:0,label:"Channels"},Ru=["value"],Vu={style:{"min-width":"150px"}},Hu=["disabled"],Wu={class:"d-flex gap-2 align-items-end position-relative"},Fu={class:"flex-grow-1 position-relative"},Uu=["disabled"],Bu=["onClick","onMouseenter"],qu=["disabled"],zu={key:0},Ku={key:1},Yu={__name:"CommComposer",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ot(),o=ne(),i=ve(),a=O(""),l=O("task"),r=O(""),c=O(!1),f=O(!1),d=O([]),y=O(0),h=O(-1),p=O(null),w=O(null),b=_(()=>{const M=i.projects.get(e.legionId);return!M||!M.session_ids?[]:M.session_ids.map(x=>o.sessions.get(x)).filter(x=>x&&x.is_minion)}),g=_(()=>s.currentChannels||[]),v=_(()=>a.value&&r.value.trim().length>0);function A(M){return{created:"○",starting:"◐",active:"●",paused:"⏸",terminating:"◍",terminated:"✗",error:"⚠"}[M.state]||"○"}function C(M){return M.is_minion&&M.role?`${M.name} (${M.role})`:M.name}function T(){const M=p.value;if(!M)return;M.style.height="auto";const x=Math.min(M.scrollHeight,parseInt(getComputedStyle(M).maxHeight));M.style.height=x+"px"}function N(){const M=p.value;if(!M)return;T();const x=r.value,S=M.selectionStart,L=x.substring(0,S),P=L.lastIndexOf("#");if(P===-1){f.value=!1;return}const R=L.substring(P+1).toLowerCase();if(R.includes(" ")){f.value=!1;return}const U=b.value.filter(q=>q.name.toLowerCase().includes(R)).map(q=>({type:"minion",name:q.name,role:q.role,id:q.session_id,state:q.state}));if(U.length===0){f.value=!1;return}d.value=U,y.value=0,h.value=P,f.value=!0}function I(){if(!w.value)return;const M=w.value,x=M.children[y.value];if(!x)return;const S=x.offsetTop,L=x.offsetHeight,P=M.scrollTop,R=M.clientHeight;S<P?M.scrollTop=S:S+L>P+R&&(M.scrollTop=S+L-R)}function E(M){if(!f.value){M.key==="Enter"&&!M.shiftKey&&v.value&&(M.preventDefault(),j());return}if(M.key==="ArrowDown")M.preventDefault(),y.value=(y.value+1)%d.value.length,I();else if(M.key==="ArrowUp")M.preventDefault(),y.value=y.value===0?d.value.length-1:y.value-1,I();else if(M.key==="Enter"){M.preventDefault();const x=d.value[y.value];x&&k(x)}else M.key==="Escape"&&(f.value=!1)}function k(M){const x=p.value;if(!x)return;const S=r.value,L=x.selectionStart,P=S.substring(0,h.value)+"#"+M.name+" "+S.substring(L);r.value=P;const R=h.value+M.name.length+2;setTimeout(()=>{x.setSelectionRange(R,R),x.focus()},0),f.value=!1}async function j(){if(!(!v.value||c.value)){c.value=!0;try{const[M,x]=a.value.split(":"),S={comm_type:l.value,content:r.value.trim()};M==="minion"?S.to_minion_id=x:M==="channel"&&(S.to_channel_id=x),await s.sendComm(e.legionId,S),r.value="",T()}catch(M){console.error("Failed to send comm:",M),alert(`Failed to send comm: ${M.message}`)}finally{c.value=!1}}}return re(f,M=>{if(M){const x=S=>{S.target.closest(".comm-composer")||(f.value=!1,document.removeEventListener("click",x))};setTimeout(()=>document.addEventListener("click",x),0)}}),(M,x)=>(u(),m("div",Ou,[t("div",Nu,[t("div",Lu,[se(t("select",{"onUpdate:modelValue":x[0]||(x[0]=S=>a.value=S),class:"form-select form-select-sm",disabled:c.value},[x[3]||(x[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",Iu,[(u(!0),m(ie,null,ce(b.value,S=>(u(),m("option",{key:S.session_id,value:`minion:${S.session_id}`},$(A(S))+" "+$(C(S)),9,Pu))),128))]),g.value.length>0?(u(),m("optgroup",ju,[(u(!0),m(ie,null,ce(g.value,S=>(u(),m("option",{key:S.channel_id,value:`channel:${S.channel_id}`}," #️⃣ "+$(S.name),9,Ru))),128))])):D("",!0)],8,Du),[[Oe,a.value]])]),t("div",Vu,[se(t("select",{"onUpdate:modelValue":x[1]||(x[1]=S=>l.value=S),class:"form-select form-select-sm",disabled:c.value},[...x[4]||(x[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,Hu),[[Oe,l.value]])])]),t("div",Wu,[t("div",Fu,[se(t("textarea",{ref_key:"contentTextarea",ref:p,"onUpdate:modelValue":x[2]||(x[2]=S=>r.value=S),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:c.value,onInput:N,onKeydown:E},null,40,Uu),[[ue,r.value]]),f.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:w,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(ie,null,ce(d.value,(S,L)=>(u(),m("div",{key:S.id,class:Y(["autocomplete-item px-2 py-1",{"bg-light":L===y.value}]),onClick:P=>k(S),onMouseenter:P=>y.value=L},$(S.type==="minion"?A(S):"#️⃣")+" "+$(S.name)+$(S.role?` (${S.role})`:""),43,Bu))),128))],512)):D("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!v.value||c.value,onClick:j},[c.value?(u(),m("span",zu,[...x[5]||(x[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),K(" Sending... ",-1)])])):(u(),m("span",Ku,"Send"))],8,qu)])])]))}},Gu=G(Yu,[["__scopeId","data-v-ffa54193"]]),Ju={class:"timeline-view d-flex flex-column h-100"},Xu={key:0,class:"text-center text-muted"},Qu={key:1,class:"text-center text-danger"},Zu={key:2,class:"text-center text-muted"},em={key:3,class:"comm-list"},tm={class:"col-auto message-speaker text-end pe-3"},sm={class:"text-muted"},nm={class:"col message-content-column"},om={class:"card-body p-2"},im={class:"d-flex justify-content-between align-items-start mb-1"},am={class:"comm-content"},lm="ffffffff-ffff-ffff-ffff-ffffffffffff",rm={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ot(),o=ve(),i=ne(),a=We(),l=me(),r=O(!0),c=O(null),f=O(null),d=_(()=>o.projects.get(e.legionId));_(()=>d.value?.name||"Legion");const y=_(()=>s.currentComms);_(()=>s.currentMinions);function h(N){return N.from_minion_id===lm}function p(N){return N.from_user?"You":N.from_minion_id?h(N)?"SYSTEM":i.sessions.get(N.from_minion_id)?.name||"Unknown":"Unknown"}function w(N){return N.to_user?"You":N.to_minion_id?i.sessions.get(N.to_minion_id)?.name||"Unknown":N.to_channel_id?N.to_channel_name?`#${N.to_channel_name}`:N.to_channel_id:"All"}function b(N){return{task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success"}[N]||"bg-secondary"}function g(N){return new Date(N).toLocaleTimeString()}async function v(){l.autoScrollEnabled&&(await Os(),f.value&&(f.value.scrollTop=f.value.scrollHeight))}async function A(){r.value=!0,c.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Os(),await v(),setTimeout(()=>{v()},100)}catch(N){console.error("Failed to load timeline:",N),N.response?c.value=`${N.message} (${N.response.status})`:c.value=N.message||"Unknown error"}finally{r.value=!1}}function C(){a.connectLegion(e.legionId)}function T(){a.disconnectLegion()}return re(()=>y.value.length,()=>{v()}),pe(()=>{A(),C(),setTimeout(()=>{v()},100)}),_e(()=>{T()}),(N,I)=>(u(),m("div",Ju,[ae(ku,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:f,class:"timeline-messages flex-grow-1 overflow-auto p-3"},[r.value?(u(),m("div",Xu,[...I[0]||(I[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),K(" Loading timeline... ",-1)])])):c.value?(u(),m("div",Qu," Failed to load timeline: "+$(c.value),1)):y.value.length===0?(u(),m("div",Zu," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",em,[(u(!0),m(ie,null,ce(y.value,E=>(u(),m("div",{key:E.comm_id,class:Y(["comm-item message-row row py-2 mb-2",{"system-comm":h(E)}])},[t("div",tm,[t("small",sm,$(g(E.timestamp)),1)]),t("div",nm,[t("div",{class:Y(["comm-card card",{"system-card":h(E)}])},[t("div",om,[t("div",im,[t("div",null,[t("span",{class:Y(["badge",b(E.comm_type)])},$(E.comm_type),3),t("strong",{class:Y(["ms-2",{"system-sender":h(E)}])},$(p(E)),3),I[1]||(I[1]=t("span",{class:"text-muted mx-1"},"→",-1)),t("strong",{class:Y({"recipient-channel":E.to_channel_id})},$(w(E)),3)])]),t("div",am,$(E.content),1)])],2)])],2))),128))]))],512),ae(Gu,{"legion-id":n.legionId},null,8,["legion-id"]),ae(Mu,{"legion-id":n.legionId},null,8,["legion-id"])]))}},cm=G(rm,[["__scopeId","data-v-6d97bd0b"]]),dm={class:"spy-view d-flex flex-column overflow-hidden"},um={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){const e=n,s=We();return pe(()=>{s.connectLegion(e.legionId)}),Vs(()=>{s.disconnectLegion()}),(o,i)=>(u(),m("div",dm,[ae(lo,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},mm=G(um,[["__scopeId","data-v-21206f91"]]),pm={class:"horde-header border-bottom p-3"},fm={class:"project-name"},vm={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=_(()=>s.projects.get(e.legionId)),i=_(()=>o.value?.name||"Legion");return(a,l)=>(u(),m("div",pm,[t("div",null,[t("div",fm,$(i.value),1),l[0]||(l[0]=t("div",{class:"view-name"},"Minion Hierarchy",-1))])]))}},hm=G(vm,[["__scopeId","data-v-0c86e2b5"]]),_m={class:"horde-status-bar border-top p-2 bg-light"},gm={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,s)=>(u(),m("div",_m,[...s[0]||(s[0]=[t("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},bm=G(gm,[["__scopeId","data-v-f0e64ab0"]]),ym={class:"minion-card border-start border-2 mb-2"},$m={class:"node-row"},wm={class:"node-left"},Em={key:0,class:"me-2"},Cm={key:1,class:"badge bg-secondary ms-2"},Sm={class:"node-right"},km={key:0,class:"last-comm-preview"},Tm={class:"comm-direction"},xm=["title"],Am={key:1,class:"text-muted fst-italic small"},Mm={key:0,class:"minion-children"},Om={key:1,class:"text-danger small ms-4"},Nm={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,s=_(()=>e.level*24),o=_(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=_(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=_(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),l=_(()=>{const d=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[d]||"status-dot-grey"}),r=_(()=>{const d=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[d]||"#d3d3d3"}});function c(d){return d.to_user?"User":d.to_minion_name?d.to_minion_name:d.to_channel_name?`#${d.to_channel_name}`:"unknown"}function f(d){const y=d.summary||d.content||"";return y.length>150?y.substring(0,150)+"...":y}return(d,y)=>{const h=io("MinionTreeNode",!0);return n.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:Ve({marginLeft:`${s.value}px`})},[t("div",ym,[t("div",$m,[t("div",wm,[t("div",{class:Y(["status-dot me-2",l.value]),style:Ve(r.value)},null,6),i.value?(u(),m("span",Em,"👑")):D("",!0),t("strong",null,$(n.minionData.name),1),i.value?(u(),m("span",Cm,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),t("div",Sm,[n.minionData.last_comm?(u(),m("div",km,[t("span",Tm,[y[0]||(y[0]=K(" → ",-1)),t("strong",null,$(c(n.minionData.last_comm)),1),y[1]||(y[1]=K(": ",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},$(f(n.minionData.last_comm)),9,xm)])):(u(),m("div",Am," No communications yet "))])])]),o.value?(u(),m("div",Mm,[(u(!0),m(ie,null,ce(n.minionData.children,p=>(u(),Ee(h,{key:p.id,"minion-data":p,level:n.level+1},null,8,["minion-data","level"]))),128))])):D("",!0)],4)):(u(),m("div",Om," ⚠ Minion data is missing "))}}},Lm=G(Nm,[["__scopeId","data-v-1cd9863f"]]),Dm={class:"horde-view d-flex flex-column h-100"},Im={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},Pm={key:0,class:"text-center py-5"},jm={key:1,class:"alert alert-danger"},Rm={class:"mb-0"},Vm={key:2,class:"horde-tree"},Hm={class:"user-root-node mb-3 border rounded bg-white"},Wm={class:"node-row"},Fm={class:"node-left"},Um={key:0,class:"badge bg-primary ms-2"},Bm={class:"node-right"},qm={key:0,class:"last-comm-preview"},zm={class:"comm-direction"},Km=["title"],Ym={key:1,class:"text-muted fst-italic"},Gm={key:0,class:"alert alert-info ms-4"},Jm={key:1,class:"root-minions ms-4"},Xm={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=ne(),i=We(),a=ot(),l=O(null),r=O(!1),c=O(null);_(()=>s.projects.get(e.legionId));const f=_(()=>l.value&&l.value.children&&l.value.children.length>0);async function d(){r.value=!0,c.value=null;try{const b=await te.get(`/api/legions/${e.legionId}/hordes`);l.value=b,console.log("Loaded hierarchy:",b)}catch(b){console.error("Failed to load hierarchy:",b),c.value=b.message||"Unknown error"}finally{r.value=!1}}pe(()=>{d()}),re(()=>e.legionId,()=>{d()});function y(b){return b.to_user?"User":b.to_minion_name?b.to_minion_name:b.to_channel_name?`#${b.to_channel_name}`:"unknown"}function h(b){const g=b.summary||b.content||"";return g.length>150?g.substring(0,150)+"...":g}function p(b,g){if(b.id===g)return b;if(b.children)for(const v of b.children){const A=p(v,g);if(A)return A}return null}function w(b){if(l.value){if(b.from_minion_id){const g=p(l.value,b.from_minion_id);g&&g.type==="minion"&&(g.last_comm=b,console.log(`Updated minion ${g.name} last_comm`))}b.from_user&&l.value.type==="user"&&(l.value.last_comm=b,console.log("Updated user last_comm"))}}return pe(()=>{d(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),re(()=>o.sessions,b=>{if(l.value){for(const[g,v]of b)if(v.is_minion&&v.project_id===e.legionId){const A=p(l.value,g);A&&A.type==="minion"&&(A.state!==v.state&&(A.state=v.state,console.log(`Updated minion ${A.name} state to ${v.state}`)),A.is_processing!==v.is_processing&&(A.is_processing=v.is_processing,console.log(`Updated minion ${A.name} is_processing to ${v.is_processing}`)))}}},{deep:!0}),re(()=>a.commsByLegion.get(e.legionId),b=>{if(b&&b.length>0){const g=b[b.length-1];w(g)}},{deep:!0}),re(()=>o.sessions.size,(b,g)=>{b>g&&Array.from(o.sessions.values()).some(C=>C.is_minion&&C.project_id===e.legionId&&!p(l.value,C.session_id))&&(console.log("New minion detected, reloading hierarchy"),d())})}),_e(()=>{console.log("HordeView unmounted")}),(b,g)=>(u(),m("div",Dm,[ae(hm,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",Im,[r.value?(u(),m("div",Pm,[...g[0]||(g[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):c.value?(u(),m("div",jm,[g[1]||(g[1]=t("strong",null,"Failed to load hierarchy",-1)),t("p",Rm,$(c.value),1)])):l.value?(u(),m("div",Vm,[t("div",Hm,[t("div",Wm,[t("div",Fm,[g[2]||(g[2]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"👤",-1)),t("strong",null,$(l.value.name),1),f.value?(u(),m("span",Um,$(l.value.children.length)+" "+$(l.value.children.length===1?"minion":"minions"),1)):D("",!0)]),t("div",Bm,[l.value.last_comm?(u(),m("div",qm,[t("span",zm,[g[3]||(g[3]=K(" → ",-1)),t("strong",null,$(y(l.value.last_comm)),1),g[4]||(g[4]=K(": ",-1))]),t("span",{class:"comm-content",title:l.value.last_comm.content||""},$(h(l.value.last_comm)),9,Km)])):(u(),m("div",Ym," No communications yet "))])])]),f.value?(u(),m("div",Jm,[(u(!0),m(ie,null,ce(l.value.children,v=>(u(),Ee(Lm,{key:v.id,"minion-data":v,level:1},null,8,["minion-data"]))),128))])):(u(),m("div",Gm,[...g[5]||(g[5]=[t("p",{class:"mb-2"},"No minions yet",-1),t("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):D("",!0)]),ae(bm,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Qm=G(Xm,[["__scopeId","data-v-af6338a3"]]),Zm={class:"channel-status-bar d-flex gap-2"},ep={class:"button-label"},tp={__name:"ChannelStatusBar",props:{channel:{type:Object,required:!0},members:{type:Array,default:()=>[]},legionId:{type:String,required:!0}},setup(n){const e=n,s=me(),o=_(()=>e.members?.length||0);function i(){s.showModal("channel-info",{channel:e.channel})}function a(){s.showModal("channel-members",{channel:e.channel,members:e.members,legionId:e.legionId,channelId:e.channel.channel_id})}return(l,r)=>(u(),m("div",Zm,[t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:i,title:"View channel information"},[...r[0]||(r[0]=[t("span",{class:"button-icon"},"📋",-1),t("span",{class:"button-label"},"Info",-1)])]),t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:a,title:"View channel members"},[r[1]||(r[1]=t("span",{class:"button-icon"},"👥",-1)),t("span",ep,"Members ("+$(o.value)+")",1)])]))}},sp=G(tp,[["__scopeId","data-v-f497955c"]]),np={class:"modal-dialog modal-dialog-centered"},op={class:"modal-content"},ip={class:"modal-body"},ap={key:0},lp={class:"info-section"},rp={class:"info-value"},cp={class:"info-section"},dp={class:"info-value"},up={key:0,class:"info-section"},mp={class:"info-value"},pp={class:"info-section"},fp={class:"info-value"},vp={class:"info-section"},hp={class:"info-value"},_p={class:"info-section"},gp={class:"info-value"},bp={style:{"font-size":"0.85rem"}},yp={key:1,class:"text-muted text-center py-3"},$p={__name:"ChannelInfoModal",setup(n){const e=me(),s=O(null);let o=null;const i=O(null);re(()=>e.currentModal,l=>{l?.name==="channel-info"&&o&&(i.value=l.data?.channel||null,o.show())});function a(l){if(!l)return"Unknown";try{return new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return l}}return pe(()=>{if(s.value){const l=window.bootstrap;l&&l.Modal&&(o=new l.Modal(s.value),s.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),i.value=null}))}}),Vs(()=>{o&&o.dispose()}),(l,r)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",id:"channelInfoModal",tabindex:"-1","aria-labelledby":"channelInfoModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",np,[t("div",op,[r[6]||(r[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelInfoModalLabel"},"Channel Information"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ip,[i.value?(u(),m("div",ap,[t("div",lp,[r[0]||(r[0]=t("label",null,"Channel Name",-1)),t("div",rp,$(i.value.name),1)]),t("div",cp,[r[1]||(r[1]=t("label",null,"Purpose",-1)),t("div",dp,$(i.value.purpose||"No purpose specified"),1)]),i.value.description&&i.value.description!==i.value.purpose?(u(),m("div",up,[r[2]||(r[2]=t("label",null,"Description",-1)),t("div",mp,$(i.value.description),1)])):D("",!0),t("div",pp,[r[3]||(r[3]=t("label",null,"Created",-1)),t("div",fp,$(a(i.value.created_at)),1)]),t("div",vp,[r[4]||(r[4]=t("label",null,"Members",-1)),t("div",hp,$(i.value.member_minion_ids?.length||0)+" member(s)",1)]),t("div",_p,[r[5]||(r[5]=t("label",null,"Channel ID",-1)),t("div",gp,[t("code",bp,$(i.value.channel_id),1)])])])):(u(),m("div",yp," No channel data available "))]),r[7]||(r[7]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},wp=G($p,[["__scopeId","data-v-3d7eceff"]]),Ep={class:"modal-dialog modal-dialog-centered"},Cp={class:"modal-content"},Sp={class:"modal-body"},kp={class:"mb-3"},Tp=["disabled"],xp={key:0,class:"text-muted ms-2"},Ap={key:1,class:"mt-2"},Mp=["disabled"],Op=["value"],Np={key:0,class:"text-muted small mt-1"},Lp={key:0,class:"member-count"},Dp={key:1,class:"member-list"},Ip={class:"member-info"},Pp={class:"member-name"},jp={key:0,class:"member-role"},Rp={class:"member-state"},Vp={class:"status-text"},Hp=["onClick","disabled"],Wp={key:2,class:"empty-state text-center py-4"},Fp={__name:"ChannelMembersModal",setup(n){const e=me(),s=ot(),o=ne(),i=ve(),a=O(null);let l=null;const r=O(null),c=O([]),f=O(null),d=O(null),y=O(""),h=O(!1),p=O(!1),w=O(!1),b=_(()=>{if(!f.value)return[];const N=i.projects.get(f.value);if(!N||!N.session_ids)return[];const I=N.session_ids.map(k=>o.sessions.get(k)).filter(Boolean),E=new Set(c.value.map(k=>k.session_id));return I.filter(k=>!E.has(k.session_id))});re(()=>e.currentModal,N=>{N?.name==="channel-members"&&l&&(r.value=N.data?.channel||null,c.value=N.data?.members||[],f.value=N.data?.legionId||null,d.value=N.data?.channelId||null,h.value=!1,y.value="",l.show())});function g(N){return N==="processing"||N==="starting"?"status-blinking":""}function v(N){return{backgroundColor:{created:"#6c757d",starting:"#28a745",active:"#28a745",processing:"#da70d6",paused:"#ffc107",error:"#dc3545",terminated:"#6c757d"}[N]||"#6c757d"}}function A(N){return N?N.charAt(0).toUpperCase()+N.slice(1).replace(/_/g," "):"Unknown"}async function C(){if(!(!y.value||!d.value)){p.value=!0;try{await s.addMemberToChannel(d.value,y.value);const N=await s.loadChannelDetails(d.value);N?.member_minion_ids&&(c.value=N.member_minion_ids.map(I=>o.sessions.get(I)).filter(Boolean)),y.value="",h.value=!1}catch(N){console.error("Failed to add member:",N),alert(`Failed to add member: ${N.message}`)}finally{p.value=!1}}}async function T(N){if(!N||!d.value)return;const I=c.value.find(E=>E.session_id===N);if(confirm(`Remove ${I?.name||"this member"} from the channel?`)){w.value=!0;try{await s.removeMemberFromChannel(d.value,N);const E=await s.loadChannelDetails(d.value);E?.member_minion_ids&&(c.value=E.member_minion_ids.map(k=>o.sessions.get(k)).filter(Boolean))}catch(E){console.error("Failed to remove member:",E),alert(`Failed to remove member: ${E.message}`)}finally{w.value=!1}}}return pe(()=>{if(a.value){const N=window.bootstrap;N&&N.Modal&&(l=new N.Modal(a.value),a.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),r.value=null,c.value=[]}))}}),Vs(()=>{l&&l.dispose()}),(N,I)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",id:"channelMembersModal",tabindex:"-1","aria-labelledby":"channelMembersModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",Ep,[t("div",Cp,[I[5]||(I[5]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelMembersModalLabel"},"Channel Members"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Sp,[t("div",kp,[t("button",{class:"btn btn-sm btn-primary",onClick:I[0]||(I[0]=E=>h.value=!h.value),disabled:p.value||b.value.length===0}," ➕ Add Member ",8,Tp),b.value.length===0?(u(),m("small",xp," (All minions are already members) ")):D("",!0),h.value&&b.value.length>0?(u(),m("div",Ap,[se(t("select",{"onUpdate:modelValue":I[1]||(I[1]=E=>y.value=E),class:"form-select form-select-sm",onChange:C,disabled:p.value},[I[2]||(I[2]=t("option",{value:""},"-- Select minion to add --",-1)),(u(!0),m(ie,null,ce(b.value,E=>(u(),m("option",{key:E.session_id,value:E.session_id},$(E.name)+" "+$(E.role?`(${E.role})`:"(No role)"),9,Op))),128))],40,Mp),[[Oe,y.value]]),p.value?(u(),m("div",Np,[...I[3]||(I[3]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),K(" Adding member... ",-1)])])):D("",!0)])):D("",!0)]),c.value&&c.value.length>0?(u(),m("p",Lp,$(c.value.length)+" "+$(c.value.length===1?"member":"members"),1)):D("",!0),c.value&&c.value.length>0?(u(),m("div",Dp,[(u(!0),m(ie,null,ce(c.value,E=>(u(),m("div",{key:E.session_id,class:"member-item"},[t("div",Ip,[t("div",Pp,$(E.name),1),E.role?(u(),m("div",jp,$(E.role),1)):D("",!0),t("div",Rp,[t("span",{class:Y(["status-dot",g(E.state)]),style:Ve(v(E.state))},null,6),t("span",Vp,$(A(E.state)),1)])]),t("button",{class:"btn btn-sm btn-outline-danger",onClick:k=>T(E.session_id),disabled:w.value,title:"Remove from channel"}," 🗑️ ",8,Hp)]))),128))])):(u(),m("div",Wp,[...I[4]||(I[4]=[t("p",{class:"text-muted mb-0"},"No members in this channel yet.",-1)])]))]),I[6]||(I[6]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},Up=G(Fp,[["__scopeId","data-v-28fb4eaa"]]),Bp={class:"channel-view d-flex flex-column h-100"},qp={class:"channel-header border-bottom p-3"},zp={class:"d-flex align-items-center justify-content-between"},Kp={class:"mb-0"},Yp={class:"text-muted"},Gp={class:"badge bg-secondary"},Jp={class:"channel-content flex-grow-1 overflow-auto"},Xp={key:0,class:"text-center text-muted py-4"},Qp={key:1,class:"text-center text-danger py-4"},Zp={key:2,class:"text-center text-muted py-4"},ef={key:3,class:"p-3 pb-5"},tf={class:"comms-section"},sf={class:"text-muted border-bottom pb-2"},nf={key:0,class:"text-center text-muted py-4"},of={key:1,class:"text-center text-muted py-3"},af={key:2,class:"comm-list"},lf={class:"card-body p-2"},rf={class:"d-flex justify-content-between align-items-start mb-1"},cf={class:"ms-2"},df={class:"text-muted ms-2"},uf={key:0,class:"text-muted small mb-1"},mf={class:"comm-content"},pf={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,s=ot(),o=ve(),i=ne(),a=O(!0),l=O(null),r=O(!1),c=_(()=>o.projects.get(e.legionId)),f=_(()=>s.channelDetailsByChannel.get(e.channelId)),d=_(()=>s.channelCommsByChannel.get(e.channelId)||[]),y=_(()=>f.value?.member_minion_ids?.length||0),h=_(()=>d.value.length),p=_(()=>f.value?.member_minion_ids?f.value.member_minion_ids.map(v=>i.sessions.get(v)).filter(Boolean):[]);function w(v){return v.from_user?"You":v.from_minion_name?v.from_minion_name:v.from_minion_id&&i.sessions.get(v.from_minion_id)?.name||"Unknown"}function b(v){return{task:"bg-primary",question:"bg-info",report:"bg-success",info:"bg-secondary",halt:"bg-danger",pivot:"bg-warning"}[v?.toLowerCase()]||"bg-secondary"}function g(v){return v?new Date(v).toLocaleString():"N/A"}return pe(async()=>{a.value=!0;try{await s.loadChannelDetails(e.channelId),r.value=!0,await s.loadChannelComms(e.channelId,1e3),r.value=!1}catch(v){console.error("Failed to load channel:",v),l.value=v.message||"Unknown error"}finally{a.value=!1}}),re(()=>e.channelId,async v=>{if(v){a.value=!0,l.value=null;try{await s.loadChannelDetails(v),r.value=!0,await s.loadChannelComms(v,1e3),r.value=!1}catch(A){console.error("Failed to load channel:",A),l.value=A.message||"Unknown error"}finally{a.value=!1}}}),(v,A)=>(u(),m("div",Bp,[t("div",qp,[t("div",zp,[t("div",null,[t("h5",Kp," 💬 "+$(f.value?.name||"Channel"),1),t("small",Yp,$(c.value?.name||"Legion"),1)]),t("span",Gp,$(y.value)+" members",1)])]),t("div",Jp,[a.value?(u(),m("div",Xp,[...A[0]||(A[0]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading channel...",-1)])])):l.value?(u(),m("div",Qp," Failed to load channel: "+$(l.value),1)):f.value?(u(),m("div",ef,[t("div",tf,[t("h6",sf,"Communications ("+$(h.value)+")",1),r.value?(u(),m("div",nf,[...A[1]||(A[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading comms...",-1)])])):d.value.length===0?(u(),m("div",of," No communications in this channel yet ")):(u(),m("div",af,[(u(!0),m(ie,null,ce(d.value,C=>(u(),m("div",{key:C.comm_id,class:"comm-item card mb-2"},[t("div",lf,[t("div",rf,[t("div",null,[t("span",{class:Y(["badge",b(C.comm_type)])},$(C.comm_type),3),t("strong",cf,$(w(C)),1),t("small",df,$(g(C.timestamp)),1)])]),C.summary?(u(),m("div",uf,[A[2]||(A[2]=t("strong",null,"Summary:",-1)),K(" "+$(C.summary),1)])):D("",!0),t("div",mf,$(C.content),1)])]))),128))]))])])):(u(),m("div",Zp," Channel not found "))]),f.value?(u(),Ee(sp,{key:0,channel:f.value,members:p.value,"legion-id":n.legionId},null,8,["channel","members","legion-id"])):D("",!0),ae(wp),ae(Up)]))}},ff=G(pf,[["__scopeId","data-v-daa6aa75"]]),vf=[{path:"/",name:"home",component:bi},{path:"/session/:sessionId",name:"session",component:lo,props:!0},{path:"/timeline/:legionId",name:"timeline",component:cm,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:mm,props:!0},{path:"/horde/:legionId",name:"horde",component:Qm,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:ff,props:!0}],hf=pi({history:fi(),routes:vf}),_f={class:"connection-indicators"},gf=["title"],bf=["title"],yf=["title"],$f={__name:"ConnectionIndicator",setup(n){const e=We();function s(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:r}=a[i];return r>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:c,retryCount:f}=r[i];let d="Disconnected";return c?d="Connected":f>0&&(d=`Reconnecting (attempt ${f})`),`${a[i]}
${l[i]}
Status: ${d}`}return(i,a)=>(u(),m("div",_f,[t("div",{class:Y(["indicator",s("ui")]),title:o("ui")}," 🌐 ",10,gf),t("div",{class:Y(["indicator",s("session")]),title:o("session")}," 💬 ",10,bf),t("div",{class:Y(["indicator",s("legion")]),title:o("legion")}," 👥 ",10,yf)]))}},wf=G($f,[["__scopeId","data-v-d35b07c8"]]),Ef={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Cf={class:"d-flex align-items-center gap-2"},Sf={__name:"AppHeader",setup(n){const e=me();function s(){e.toggleSidebar()}return(o,i)=>(u(),m("header",Ef,[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...i[0]||(i[0]=[t("span",null,"☰",-1)])]),i[1]||(i[1]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",Cf,[ae(wf)])]))}},kf={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Tf={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},xf=["title"],Af={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=_(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(r){return r.state==="paused"&&r.is_processing?"pending-prompt":r.is_processing?"processing":r.state}function i(r){const c=o(r);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}function a(r){const c=o(r);return c==="starting"||c==="processing"||c==="pending-prompt"}function l(r){const c=o(r),f=c.charAt(0).toUpperCase()+c.slice(1),d=r.name||"Unnamed Session",y=r.is_minion&&r.role?` (${r.role})`:"";return`${d}${y}: ${f}`}return(r,c)=>(u(),m("div",kf,[!n.sessions||n.sessions.length===0?(u(),m("div",Tf)):(u(!0),m(ie,{key:1},ce(n.sessions,f=>(u(),m("div",{key:f.session_id,class:Y(["progress-bar",{"progress-bar-striped progress-bar-animated":a(f)}]),style:Ve({width:s.value,backgroundColor:i(f),cursor:"help"}),title:l(f)},null,14,xf))),128))]))}},Mf=G(Af,[["__scopeId","data-v-a79cfeec"]]),Of={class:"flex-grow-1"},Nf={key:0,class:"text-muted small ms-1"},Lf={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,s=Ye(),o=ne(),i=ve(),a=me(),l=_(()=>o.currentSessionId===e.session.session_id),r=_(()=>o.deletingSessions.has(e.session.session_id)),c=_(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),f=_(()=>{const v=c.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[v]||"status-dot-grey"}),d=_(()=>{const v=c.value,A={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},C={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:A[v]||"#d3d3d3",borderColor:C[v]||"#6c757d"}});function y(){o.selectSession(e.session.session_id),s.push(`/session/${e.session.session_id}`)}function h(){a.showModal("edit-session",{session:e.session})}function p(v){v.dataTransfer.effectAllowed="move",v.dataTransfer.setData("application/session-id",e.session.session_id),v.dataTransfer.setData("application/project-id",e.projectId),v.dataTransfer.setData("text/plain",e.session.session_id),v.target.classList.add("dragging")}function w(v){v.target.classList.remove("dragging")}function b(v){v.preventDefault(),v.dataTransfer.dropEffect="move";const A=v.currentTarget.getBoundingClientRect(),C=A.top+A.height/2;v.clientY<C?(v.currentTarget.classList.add("drop-above"),v.currentTarget.classList.remove("drop-below")):(v.currentTarget.classList.add("drop-below"),v.currentTarget.classList.remove("drop-above"))}function g(v){v.preventDefault(),v.currentTarget.classList.remove("drop-above","drop-below");const A=v.dataTransfer.getData("application/session-id")||v.dataTransfer.getData("text/plain"),C=v.dataTransfer.getData("application/project-id");if(!A||A===e.session.session_id||C!==e.projectId)return;const T=v.currentTarget.getBoundingClientRect(),N=T.top+T.height/2,I=v.clientY<N,E=i.getProject(e.projectId);if(!E||!E.session_ids)return;const k=[...E.session_ids],j=k.indexOf(e.session.session_id),M=k.indexOf(A);if(j===-1||M===-1)return;const x=[...k],[S]=x.splice(M,1);let L=I?j:j+1;M<j&&L--,x.splice(L,0,S),i.reorderSessionsInProject(e.projectId,x)}return(v,A)=>(u(),m("div",{class:Y(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:l.value,"session-deleting":r.value}]),style:{cursor:"pointer"},draggable:"true",onClick:y,onDragstart:p,onDragend:w,onDragover:b,onDrop:g},[t("div",{class:Y(["status-dot me-2",f.value]),style:Ve(d.value)},null,6),t("div",Of,[t("span",null,$(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(u(),m("span",Nf,"("+$(n.session.role)+")",1)):D("",!0)]),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:ge(h,["stop"])}," ✏️ ")],34))}},Df=G(Lf,[["__scopeId","data-v-07ecbf94"]]),If={class:"d-flex align-items-center gap-2"},Pf=["value"],jf={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ye(),o=ne(),i=me(),a=O("");re(()=>s.currentRoute.value,b=>{!a.value&&b.name==="spy"&&b.params.minionId&&b.params.legionId===e.project.project_id&&(a.value=b.params.minionId)},{immediate:!0});const l=_(()=>a.value?e.sessions.find(b=>b.session_id===a.value):null),r=_(()=>{const b=s.currentRoute.value;return b.name==="spy"&&b.params.legionId===e.project.project_id}),c=_(()=>{if(!l.value)return"";if(l.value.state==="paused"&&l.value.is_processing)return"status-blinking";const b=l.value.is_processing?"processing":l.value.state;return b==="starting"||b==="processing"?"status-blinking":""}),f=_(()=>{if(!l.value)return{};if(l.value.state==="paused"&&l.value.is_processing)return{backgroundColor:"#ffc107"};const b=l.value.is_processing?"processing":l.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[b]||"#d3d3d3"}});function d(b){return{created:"○",starting:"◐",active:"●",paused:"⏸",terminating:"◍",terminated:"✗",error:"⚠"}[b.state]||"○"}function y(b){return b.is_minion&&b.role?`${b.name} (${b.role})`:b.name}function h(){a.value&&s.push(`/spy/${e.project.project_id}/${a.value}`)}function p(){a.value?s.push(`/spy/${e.project.project_id}/${a.value}`):s.push("/")}function w(){l.value&&i.showModal("minion-view",{session:l.value})}return re(()=>o.currentSessionId,b=>{if(b)e.sessions.some(g=>g.session_id===b)&&(a.value=b);else{a.value="";const g=s.currentRoute.value;g.name==="spy"&&g.params.legionId===e.project.project_id&&s.push("/")}}),(b,g)=>(u(),m("div",{class:Y(["list-group-item list-group-item-action p-2",{active:r.value}])},[t("div",{class:"d-flex align-items-center justify-content-between mb-2",style:Ve({cursor:a.value?"pointer":"default"}),onClick:h},[g[1]||(g[1]=t("div",{class:"d-flex align-items-center"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"🔍"),t("span",{class:"fw-semibold"},"Spy"),t("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),t("div",If,[l.value?(u(),m("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:ge(w,["stop"]),title:"View minion details"}," 👁️ ")):D("",!0),l.value?(u(),m("span",{key:1,class:Y(["minion-state-indicator",c.value]),style:Ve(f.value)}," 👤 ",6)):D("",!0)])],4),se(t("select",{"onUpdate:modelValue":g[0]||(g[0]=v=>a.value=v),class:"form-select form-select-sm",onChange:p},[g[2]||(g[2]=t("option",{value:""},"-- Select Minion --",-1)),(u(!0),m(ie,null,ce(n.sessions,v=>(u(),m("option",{key:v.session_id,value:v.session_id},$(d(v))+" "+$(y(v)),9,Pf))),128))],544),[[Oe,a.value]])],2))}},Rf=G(jf,[["__scopeId","data-v-579589fb"]]);var ye="top",Ce="bottom",Se="right",$e="left",ns="auto",yt=[ye,Ce,Se,$e],st="start",pt="end",ro="clippingParents",Ws="viewport",ct="popper",co="reference",Ns=yt.reduce(function(n,e){return n.concat([e+"-"+st,e+"-"+pt])},[]),Fs=[].concat(yt,[ns]).reduce(function(n,e){return n.concat([e,e+"-"+st,e+"-"+pt])},[]),uo="beforeRead",mo="read",po="afterRead",fo="beforeMain",vo="main",ho="afterMain",_o="beforeWrite",go="write",bo="afterWrite",yo=[uo,mo,po,fo,vo,ho,_o,go,bo];function Pe(n){return n?(n.nodeName||"").toLowerCase():null}function ke(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nt(n){var e=ke(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=ke(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Us(n){if(typeof ShadowRoot>"u")return!1;var e=ke(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Vf(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},a=e.elements[s];!Te(a)||!Pe(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(l){var r=i[l];r===!1?a.removeAttribute(l):a.setAttribute(l,r===!0?"":r)}))})}function Hf(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),r=l.reduce(function(c,f){return c[f]="",c},{});!Te(i)||!Pe(i)||(Object.assign(i.style,r),Object.keys(a).forEach(function(c){i.removeAttribute(c)}))})}}const Bs={name:"applyStyles",enabled:!0,phase:"write",fn:Vf,effect:Hf,requires:["computeStyles"]};function Le(n){return n.split("-")[0]}var tt=Math.max,Qt=Math.min,ft=Math.round;function Ls(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function $o(){return!/^((?!chrome|android).)*safari/i.test(Ls())}function vt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&ft(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&ft(o.height)/n.offsetHeight||1);var l=nt(n)?ke(n):window,r=l.visualViewport,c=!$o()&&s,f=(o.left+(c&&r?r.offsetLeft:0))/i,d=(o.top+(c&&r?r.offsetTop:0))/a,y=o.width/i,h=o.height/a;return{width:y,height:h,top:d,right:f+y,bottom:d+h,left:f,x:f,y:d}}function qs(n){var e=vt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function wo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Us(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function He(n){return ke(n).getComputedStyle(n)}function Wf(n){return["table","td","th"].indexOf(Pe(n))>=0}function Ge(n){return((nt(n)?n.ownerDocument:n.document)||window.document).documentElement}function os(n){return Pe(n)==="html"?n:n.assignedSlot||n.parentNode||(Us(n)?n.host:null)||Ge(n)}function wn(n){return!Te(n)||He(n).position==="fixed"?null:n.offsetParent}function Ff(n){var e=/firefox/i.test(Ls()),s=/Trident/i.test(Ls());if(s&&Te(n)){var o=He(n);if(o.position==="fixed")return null}var i=os(n);for(Us(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Pe(i))<0;){var a=He(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Lt(n){for(var e=ke(n),s=wn(n);s&&Wf(s)&&He(s).position==="static";)s=wn(s);return s&&(Pe(s)==="html"||Pe(s)==="body"&&He(s).position==="static")?e:s||Ff(n)||e}function zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Tt(n,e,s){return tt(n,Qt(e,s))}function Uf(n,e,s){var o=Tt(n,e,s);return o>s?s:o}function Eo(){return{top:0,right:0,bottom:0,left:0}}function Co(n){return Object.assign({},Eo(),n)}function So(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var Bf=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Co(typeof e!="number"?e:So(e,yt))};function qf(n){var e,s=n.state,o=n.name,i=n.options,a=s.elements.arrow,l=s.modifiersData.popperOffsets,r=Le(s.placement),c=zs(r),f=[$e,Se].indexOf(r)>=0,d=f?"height":"width";if(!(!a||!l)){var y=Bf(i.padding,s),h=qs(a),p=c==="y"?ye:$e,w=c==="y"?Ce:Se,b=s.rects.reference[d]+s.rects.reference[c]-l[c]-s.rects.popper[d],g=l[c]-s.rects.reference[c],v=Lt(a),A=v?c==="y"?v.clientHeight||0:v.clientWidth||0:0,C=b/2-g/2,T=y[p],N=A-h[d]-y[w],I=A/2-h[d]/2+C,E=Tt(T,I,N),k=c;s.modifiersData[o]=(e={},e[k]=E,e.centerOffset=E-I,e)}}function zf(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||wo(e.elements.popper,i)&&(e.elements.arrow=i))}const ko={name:"arrow",enabled:!0,phase:"main",fn:qf,effect:zf,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ht(n){return n.split("-")[1]}var Kf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Yf(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:ft(s*i)/i||0,y:ft(o*i)/i||0}}function En(n){var e,s=n.popper,o=n.popperRect,i=n.placement,a=n.variation,l=n.offsets,r=n.position,c=n.gpuAcceleration,f=n.adaptive,d=n.roundOffsets,y=n.isFixed,h=l.x,p=h===void 0?0:h,w=l.y,b=w===void 0?0:w,g=typeof d=="function"?d({x:p,y:b}):{x:p,y:b};p=g.x,b=g.y;var v=l.hasOwnProperty("x"),A=l.hasOwnProperty("y"),C=$e,T=ye,N=window;if(f){var I=Lt(s),E="clientHeight",k="clientWidth";if(I===ke(s)&&(I=Ge(s),He(I).position!=="static"&&r==="absolute"&&(E="scrollHeight",k="scrollWidth")),I=I,i===ye||(i===$e||i===Se)&&a===pt){T=Ce;var j=y&&I===N&&N.visualViewport?N.visualViewport.height:I[E];b-=j-o.height,b*=c?1:-1}if(i===$e||(i===ye||i===Ce)&&a===pt){C=Se;var M=y&&I===N&&N.visualViewport?N.visualViewport.width:I[k];p-=M-o.width,p*=c?1:-1}}var x=Object.assign({position:r},f&&Kf),S=d===!0?Yf({x:p,y:b},ke(s)):{x:p,y:b};if(p=S.x,b=S.y,c){var L;return Object.assign({},x,(L={},L[T]=A?"0":"",L[C]=v?"0":"",L.transform=(N.devicePixelRatio||1)<=1?"translate("+p+"px, "+b+"px)":"translate3d("+p+"px, "+b+"px, 0)",L))}return Object.assign({},x,(e={},e[T]=A?b+"px":"",e[C]=v?p+"px":"",e.transform="",e))}function Gf(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,a=s.adaptive,l=a===void 0?!0:a,r=s.roundOffsets,c=r===void 0?!0:r,f={placement:Le(e.placement),variation:ht(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,En(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,En(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ks={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Gf,data:{}};var Ht={passive:!0};function Jf(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,l=o.resize,r=l===void 0?!0:l,c=ke(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&f.forEach(function(d){d.addEventListener("scroll",s.update,Ht)}),r&&c.addEventListener("resize",s.update,Ht),function(){a&&f.forEach(function(d){d.removeEventListener("scroll",s.update,Ht)}),r&&c.removeEventListener("resize",s.update,Ht)}}const Ys={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Jf,data:{}};var Xf={left:"right",right:"left",bottom:"top",top:"bottom"};function Kt(n){return n.replace(/left|right|bottom|top/g,function(e){return Xf[e]})}var Qf={start:"end",end:"start"};function Cn(n){return n.replace(/start|end/g,function(e){return Qf[e]})}function Gs(n){var e=ke(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function Js(n){return vt(Ge(n)).left+Gs(n).scrollLeft}function Zf(n,e){var s=ke(n),o=Ge(n),i=s.visualViewport,a=o.clientWidth,l=o.clientHeight,r=0,c=0;if(i){a=i.width,l=i.height;var f=$o();(f||!f&&e==="fixed")&&(r=i.offsetLeft,c=i.offsetTop)}return{width:a,height:l,x:r+Js(n),y:c}}function ev(n){var e,s=Ge(n),o=Gs(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=tt(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=tt(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),r=-o.scrollLeft+Js(n),c=-o.scrollTop;return He(i||s).direction==="rtl"&&(r+=tt(s.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:r,y:c}}function Xs(n){var e=He(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function To(n){return["html","body","#document"].indexOf(Pe(n))>=0?n.ownerDocument.body:Te(n)&&Xs(n)?n:To(os(n))}function xt(n,e){var s;e===void 0&&(e=[]);var o=To(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),a=ke(o),l=i?[a].concat(a.visualViewport||[],Xs(o)?o:[]):o,r=e.concat(l);return i?r:r.concat(xt(os(l)))}function Ds(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function tv(n,e){var s=vt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Sn(n,e,s){return e===Ws?Ds(Zf(n,s)):nt(e)?tv(e,s):Ds(ev(Ge(n)))}function sv(n){var e=xt(os(n)),s=["absolute","fixed"].indexOf(He(n).position)>=0,o=s&&Te(n)?Lt(n):n;return nt(o)?e.filter(function(i){return nt(i)&&wo(i,o)&&Pe(i)!=="body"}):[]}function nv(n,e,s,o){var i=e==="clippingParents"?sv(n):[].concat(e),a=[].concat(i,[s]),l=a[0],r=a.reduce(function(c,f){var d=Sn(n,f,o);return c.top=tt(d.top,c.top),c.right=Qt(d.right,c.right),c.bottom=Qt(d.bottom,c.bottom),c.left=tt(d.left,c.left),c},Sn(n,l,o));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function xo(n){var e=n.reference,s=n.element,o=n.placement,i=o?Le(o):null,a=o?ht(o):null,l=e.x+e.width/2-s.width/2,r=e.y+e.height/2-s.height/2,c;switch(i){case ye:c={x:l,y:e.y-s.height};break;case Ce:c={x:l,y:e.y+e.height};break;case Se:c={x:e.x+e.width,y:r};break;case $e:c={x:e.x-s.width,y:r};break;default:c={x:e.x,y:e.y}}var f=i?zs(i):null;if(f!=null){var d=f==="y"?"height":"width";switch(a){case st:c[f]=c[f]-(e[d]/2-s[d]/2);break;case pt:c[f]=c[f]+(e[d]/2-s[d]/2);break}}return c}function _t(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,a=s.strategy,l=a===void 0?n.strategy:a,r=s.boundary,c=r===void 0?ro:r,f=s.rootBoundary,d=f===void 0?Ws:f,y=s.elementContext,h=y===void 0?ct:y,p=s.altBoundary,w=p===void 0?!1:p,b=s.padding,g=b===void 0?0:b,v=Co(typeof g!="number"?g:So(g,yt)),A=h===ct?co:ct,C=n.rects.popper,T=n.elements[w?A:h],N=nv(nt(T)?T:T.contextElement||Ge(n.elements.popper),c,d,l),I=vt(n.elements.reference),E=xo({reference:I,element:C,placement:i}),k=Ds(Object.assign({},C,E)),j=h===ct?k:I,M={top:N.top-j.top+v.top,bottom:j.bottom-N.bottom+v.bottom,left:N.left-j.left+v.left,right:j.right-N.right+v.right},x=n.modifiersData.offset;if(h===ct&&x){var S=x[i];Object.keys(M).forEach(function(L){var P=[Se,Ce].indexOf(L)>=0?1:-1,R=[ye,Ce].indexOf(L)>=0?"y":"x";M[L]+=S[R]*P})}return M}function ov(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,a=s.rootBoundary,l=s.padding,r=s.flipVariations,c=s.allowedAutoPlacements,f=c===void 0?Fs:c,d=ht(o),y=d?r?Ns:Ns.filter(function(w){return ht(w)===d}):yt,h=y.filter(function(w){return f.indexOf(w)>=0});h.length===0&&(h=y);var p=h.reduce(function(w,b){return w[b]=_t(n,{placement:b,boundary:i,rootBoundary:a,padding:l})[Le(b)],w},{});return Object.keys(p).sort(function(w,b){return p[w]-p[b]})}function iv(n){if(Le(n)===ns)return[];var e=Kt(n);return[Cn(n),e,Cn(e)]}function av(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!0:l,c=s.fallbackPlacements,f=s.padding,d=s.boundary,y=s.rootBoundary,h=s.altBoundary,p=s.flipVariations,w=p===void 0?!0:p,b=s.allowedAutoPlacements,g=e.options.placement,v=Le(g),A=v===g,C=c||(A||!w?[Kt(g)]:iv(g)),T=[g].concat(C).reduce(function(z,de){return z.concat(Le(de)===ns?ov(e,{placement:de,boundary:d,rootBoundary:y,padding:f,flipVariations:w,allowedAutoPlacements:b}):de)},[]),N=e.rects.reference,I=e.rects.popper,E=new Map,k=!0,j=T[0],M=0;M<T.length;M++){var x=T[M],S=Le(x),L=ht(x)===st,P=[ye,Ce].indexOf(S)>=0,R=P?"width":"height",U=_t(e,{placement:x,boundary:d,rootBoundary:y,altBoundary:h,padding:f}),q=P?L?Se:$e:L?Ce:ye;N[R]>I[R]&&(q=Kt(q));var oe=Kt(q),B=[];if(a&&B.push(U[S]<=0),r&&B.push(U[q]<=0,U[oe]<=0),B.every(function(z){return z})){j=x,k=!1;break}E.set(x,B)}if(k)for(var H=w?3:1,le=function(de){var W=T.find(function(F){var J=E.get(F);if(J)return J.slice(0,de).every(function(Z){return Z})});if(W)return j=W,"break"},he=H;he>0;he--){var ee=le(he);if(ee==="break")break}e.placement!==j&&(e.modifiersData[o]._skip=!0,e.placement=j,e.reset=!0)}}const Ao={name:"flip",enabled:!0,phase:"main",fn:av,requiresIfExists:["offset"],data:{_skip:!1}};function kn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Tn(n){return[ye,Se,Ce,$e].some(function(e){return n[e]>=0})}function lv(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=_t(e,{elementContext:"reference"}),r=_t(e,{altBoundary:!0}),c=kn(l,o),f=kn(r,i,a),d=Tn(c),y=Tn(f);e.modifiersData[s]={referenceClippingOffsets:c,popperEscapeOffsets:f,isReferenceHidden:d,hasPopperEscaped:y},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":y})}const Mo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:lv};function rv(n,e,s){var o=Le(n),i=[$e,ye].indexOf(o)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,l=a[0],r=a[1];return l=l||0,r=(r||0)*i,[$e,Se].indexOf(o)>=0?{x:r,y:l}:{x:l,y:r}}function cv(n){var e=n.state,s=n.options,o=n.name,i=s.offset,a=i===void 0?[0,0]:i,l=Fs.reduce(function(d,y){return d[y]=rv(y,e.rects,a),d},{}),r=l[e.placement],c=r.x,f=r.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=l}const Oo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:cv};function dv(n){var e=n.state,s=n.name;e.modifiersData[s]=xo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Qs={name:"popperOffsets",enabled:!0,phase:"read",fn:dv,data:{}};function uv(n){return n==="x"?"y":"x"}function mv(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!1:l,c=s.boundary,f=s.rootBoundary,d=s.altBoundary,y=s.padding,h=s.tether,p=h===void 0?!0:h,w=s.tetherOffset,b=w===void 0?0:w,g=_t(e,{boundary:c,rootBoundary:f,padding:y,altBoundary:d}),v=Le(e.placement),A=ht(e.placement),C=!A,T=zs(v),N=uv(T),I=e.modifiersData.popperOffsets,E=e.rects.reference,k=e.rects.popper,j=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,M=typeof j=="number"?{mainAxis:j,altAxis:j}:Object.assign({mainAxis:0,altAxis:0},j),x=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,S={x:0,y:0};if(I){if(a){var L,P=T==="y"?ye:$e,R=T==="y"?Ce:Se,U=T==="y"?"height":"width",q=I[T],oe=q+g[P],B=q-g[R],H=p?-k[U]/2:0,le=A===st?E[U]:k[U],he=A===st?-k[U]:-E[U],ee=e.elements.arrow,z=p&&ee?qs(ee):{width:0,height:0},de=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Eo(),W=de[P],F=de[R],J=Tt(0,E[U],z[U]),Z=C?E[U]/2-H-J-W-M.mainAxis:le-J-W-M.mainAxis,Q=C?-E[U]/2+H+J+F+M.mainAxis:he+J+F+M.mainAxis,fe=e.elements.arrow&&Lt(e.elements.arrow),Ct=fe?T==="y"?fe.clientTop||0:fe.clientLeft||0:0,Rt=(L=x?.[T])!=null?L:0,ci=q+Z-Rt-Ct,di=q+Q-Rt,ln=Tt(p?Qt(oe,ci):oe,q,p?tt(B,di):B);I[T]=ln,S[T]=ln-q}if(r){var rn,ui=T==="x"?ye:$e,mi=T==="x"?Ce:Se,Qe=I[N],Vt=N==="y"?"height":"width",cn=Qe+g[ui],dn=Qe-g[mi],us=[ye,$e].indexOf(v)!==-1,un=(rn=x?.[N])!=null?rn:0,mn=us?cn:Qe-E[Vt]-k[Vt]-un+M.altAxis,pn=us?Qe+E[Vt]+k[Vt]-un-M.altAxis:dn,fn=p&&us?Uf(mn,Qe,pn):Tt(p?mn:cn,Qe,p?pn:dn);I[N]=fn,S[N]=fn-Qe}e.modifiersData[o]=S}}const No={name:"preventOverflow",enabled:!0,phase:"main",fn:mv,requiresIfExists:["offset"]};function pv(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function fv(n){return n===ke(n)||!Te(n)?Gs(n):pv(n)}function vv(n){var e=n.getBoundingClientRect(),s=ft(e.width)/n.offsetWidth||1,o=ft(e.height)/n.offsetHeight||1;return s!==1||o!==1}function hv(n,e,s){s===void 0&&(s=!1);var o=Te(e),i=Te(e)&&vv(e),a=Ge(e),l=vt(n,i,s),r={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(o||!o&&!s)&&((Pe(e)!=="body"||Xs(a))&&(r=fv(e)),Te(e)?(c=vt(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):a&&(c.x=Js(a))),{x:l.left+r.scrollLeft-c.x,y:l.top+r.scrollTop-c.y,width:l.width,height:l.height}}function _v(n){var e=new Map,s=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){s.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(r){if(!s.has(r)){var c=e.get(r);c&&i(c)}}),o.push(a)}return n.forEach(function(a){s.has(a.name)||i(a)}),o}function gv(n){var e=_v(n);return yo.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function bv(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function yv(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var xn={placement:"bottom",modifiers:[],strategy:"absolute"};function An(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function is(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,a=i===void 0?xn:i;return function(r,c,f){f===void 0&&(f=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},xn,a),modifiersData:{},elements:{reference:r,popper:c},attributes:{},styles:{}},y=[],h=!1,p={state:d,setOptions:function(v){var A=typeof v=="function"?v(d.options):v;b(),d.options=Object.assign({},a,d.options,A),d.scrollParents={reference:nt(r)?xt(r):r.contextElement?xt(r.contextElement):[],popper:xt(c)};var C=gv(yv([].concat(o,d.options.modifiers)));return d.orderedModifiers=C.filter(function(T){return T.enabled}),w(),p.update()},forceUpdate:function(){if(!h){var v=d.elements,A=v.reference,C=v.popper;if(An(A,C)){d.rects={reference:hv(A,Lt(C),d.options.strategy==="fixed"),popper:qs(C)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(M){return d.modifiersData[M.name]=Object.assign({},M.data)});for(var T=0;T<d.orderedModifiers.length;T++){if(d.reset===!0){d.reset=!1,T=-1;continue}var N=d.orderedModifiers[T],I=N.fn,E=N.options,k=E===void 0?{}:E,j=N.name;typeof I=="function"&&(d=I({state:d,options:k,name:j,instance:p})||d)}}}},update:bv(function(){return new Promise(function(g){p.forceUpdate(),g(d)})}),destroy:function(){b(),h=!0}};if(!An(r,c))return p;p.setOptions(f).then(function(g){!h&&f.onFirstUpdate&&f.onFirstUpdate(g)});function w(){d.orderedModifiers.forEach(function(g){var v=g.name,A=g.options,C=A===void 0?{}:A,T=g.effect;if(typeof T=="function"){var N=T({state:d,name:v,instance:p,options:C}),I=function(){};y.push(N||I)}})}function b(){y.forEach(function(g){return g()}),y=[]}return p}}var $v=is(),wv=[Ys,Qs,Ks,Bs],Ev=is({defaultModifiers:wv}),Cv=[Ys,Qs,Ks,Bs,Oo,Ao,No,ko,Mo],Zs=is({defaultModifiers:Cv});const Lo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ho,afterRead:po,afterWrite:bo,applyStyles:Bs,arrow:ko,auto:ns,basePlacements:yt,beforeMain:fo,beforeRead:uo,beforeWrite:_o,bottom:Ce,clippingParents:ro,computeStyles:Ks,createPopper:Zs,createPopperBase:$v,createPopperLite:Ev,detectOverflow:_t,end:pt,eventListeners:Ys,flip:Ao,hide:Mo,left:$e,main:vo,modifierPhases:yo,offset:Oo,placements:Fs,popper:ct,popperGenerator:is,popperOffsets:Qs,preventOverflow:No,read:mo,reference:co,right:Se,start:st,top:ye,variationPlacements:Ns,viewport:Ws,write:go},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Ue=new Map,vs={set(n,e,s){Ue.has(n)||Ue.set(n,new Map);const o=Ue.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return Ue.has(n)&&Ue.get(n).get(e)||null},remove(n,e){if(!Ue.has(n))return;const s=Ue.get(n);s.delete(e),s.size===0&&Ue.delete(n)}},Sv=1e6,kv=1e3,Is="transitionend",Do=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),Tv=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),xv=n=>{do n+=Math.floor(Math.random()*Sv);while(document.getElementById(n));return n},Av=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*kv)},Io=n=>{n.dispatchEvent(new Event(Is))},je=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Be=n=>je(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Do(n)):null,$t=n=>{if(!je(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},qe=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Po=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Po(n.parentNode):null},Zt=()=>{},Dt=n=>{n.offsetHeight},jo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,hs=[],Mv=n=>{document.readyState==="loading"?(hs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of hs)e()}),hs.push(n)):n()},xe=()=>document.documentElement.dir==="rtl",Me=n=>{Mv(()=>{const e=jo();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},we=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,Ro=(n,e,s=!0)=>{if(!s){we(n);return}const i=Av(e)+5;let a=!1;const l=({target:r})=>{r===e&&(a=!0,e.removeEventListener(Is,l),we(n))};e.addEventListener(Is,l),setTimeout(()=>{a||Io(e)},i)},en=(n,e,s,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!s&&o?n[i-1]:n[0]:(a+=s?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},Ov=/[^.]*(?=\..*)\.|.*/,Nv=/\..*/,Lv=/::\d+$/,_s={};let Mn=1;const Vo={mouseenter:"mouseover",mouseleave:"mouseout"},Dv=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ho(n,e){return e&&`${e}::${Mn++}`||n.uidEvent||Mn++}function Wo(n){const e=Ho(n);return n.uidEvent=e,_s[e]=_s[e]||{},_s[e]}function Iv(n,e){return function s(o){return tn(o,{delegateTarget:n}),s.oneOff&&V.off(n,o.type,e),e.apply(n,[o])}}function Pv(n,e,s){return function o(i){const a=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const r of a)if(r===l)return tn(i,{delegateTarget:l}),o.oneOff&&V.off(n,i.type,e,s),s.apply(l,[i])}}function Fo(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Uo(n,e,s){const o=typeof e=="string",i=o?s:e||s;let a=Bo(n);return Dv.has(a)||(a=n),[o,i,a]}function On(n,e,s,o,i){if(typeof e!="string"||!n)return;let[a,l,r]=Uo(e,s,o);e in Vo&&(l=(w=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return w.call(this,b)})(l));const c=Wo(n),f=c[r]||(c[r]={}),d=Fo(f,l,a?s:null);if(d){d.oneOff=d.oneOff&&i;return}const y=Ho(l,e.replace(Ov,"")),h=a?Pv(n,s,l):Iv(n,l);h.delegationSelector=a?s:null,h.callable=l,h.oneOff=i,h.uidEvent=y,f[y]=h,n.addEventListener(r,h,a)}function Ps(n,e,s,o,i){const a=Fo(e[s],o,i);a&&(n.removeEventListener(s,a,!!i),delete e[s][a.uidEvent])}function jv(n,e,s,o){const i=e[s]||{};for(const[a,l]of Object.entries(i))a.includes(o)&&Ps(n,e,s,l.callable,l.delegationSelector)}function Bo(n){return n=n.replace(Nv,""),Vo[n]||n}const V={on(n,e,s,o){On(n,e,s,o,!1)},one(n,e,s,o){On(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,a,l]=Uo(e,s,o),r=l!==e,c=Wo(n),f=c[l]||{},d=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(f).length)return;Ps(n,c,l,a,i?s:null);return}if(d)for(const y of Object.keys(c))jv(n,c,y,e.slice(1));for(const[y,h]of Object.entries(f)){const p=y.replace(Lv,"");(!r||e.includes(p))&&Ps(n,c,l,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=jo(),i=Bo(e),a=e!==i;let l=null,r=!0,c=!0,f=!1;a&&o&&(l=o.Event(e,s),o(n).trigger(l),r=!l.isPropagationStopped(),c=!l.isImmediatePropagationStopped(),f=l.isDefaultPrevented());const d=tn(new Event(e,{bubbles:r,cancelable:!0}),s);return f&&d.preventDefault(),c&&n.dispatchEvent(d),d.defaultPrevented&&l&&l.preventDefault(),d}};function tn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Nn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function gs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Re={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${gs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${gs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Nn(n.dataset[o])}return e},getDataAttribute(n,e){return Nn(n.getAttribute(`data-bs-${gs(e)}`))}};class It{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=je(s)?Re.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...je(s)?Re.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const a=e[o],l=je(a)?"element":Tv(a);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const Rv="5.3.8";class Ne extends It{constructor(e,s){super(),e=Be(e),e&&(this._element=e,this._config=this._getConfig(s),vs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){vs.remove(this._element,this.constructor.DATA_KEY),V.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){Ro(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return vs.get(Be(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Rv}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const bs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>Do(s)).join(","):null},X={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!qe(s)&&$t(s))},getSelectorFromElement(n){const e=bs(n);return e&&X.findOne(e)?e:null},getElementFromSelector(n){const e=bs(n);return e?X.findOne(e):null},getMultipleElementsFromSelector(n){const e=bs(n);return e?X.find(e):[]}},as=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;V.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),qe(this))return;const a=X.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},Vv="alert",Hv="bs.alert",qo=`.${Hv}`,Wv=`close${qo}`,Fv=`closed${qo}`,Uv="fade",Bv="show";class ls extends Ne{static get NAME(){return Vv}close(){if(V.trigger(this._element,Wv).defaultPrevented)return;this._element.classList.remove(Bv);const s=this._element.classList.contains(Uv);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),V.trigger(this._element,Fv),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=ls.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}as(ls,"close");Me(ls);const qv="button",zv="bs.button",Kv=`.${zv}`,Yv=".data-api",Gv="active",Ln='[data-bs-toggle="button"]',Jv=`click${Kv}${Yv}`;class rs extends Ne{static get NAME(){return qv}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Gv))}static jQueryInterface(e){return this.each(function(){const s=rs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}V.on(document,Jv,Ln,n=>{n.preventDefault();const e=n.target.closest(Ln);rs.getOrCreateInstance(e).toggle()});Me(rs);const Xv="swipe",wt=".bs.swipe",Qv=`touchstart${wt}`,Zv=`touchmove${wt}`,eh=`touchend${wt}`,th=`pointerdown${wt}`,sh=`pointerup${wt}`,nh="touch",oh="pen",ih="pointer-event",ah=40,lh={endCallback:null,leftCallback:null,rightCallback:null},rh={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class es extends It{constructor(e,s){super(),this._element=e,!(!e||!es.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return lh}static get DefaultType(){return rh}static get NAME(){return Xv}dispose(){V.off(this._element,wt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),we(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=ah)return;const s=e/this._deltaX;this._deltaX=0,s&&we(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(V.on(this._element,th,e=>this._start(e)),V.on(this._element,sh,e=>this._end(e)),this._element.classList.add(ih)):(V.on(this._element,Qv,e=>this._start(e)),V.on(this._element,Zv,e=>this._move(e)),V.on(this._element,eh,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===oh||e.pointerType===nh)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const ch="carousel",dh="bs.carousel",Je=`.${dh}`,zo=".data-api",uh="ArrowLeft",mh="ArrowRight",ph=500,St="next",lt="prev",dt="left",Yt="right",fh=`slide${Je}`,ys=`slid${Je}`,vh=`keydown${Je}`,hh=`mouseenter${Je}`,_h=`mouseleave${Je}`,gh=`dragstart${Je}`,bh=`load${Je}${zo}`,yh=`click${Je}${zo}`,Ko="carousel",Wt="active",$h="slide",wh="carousel-item-end",Eh="carousel-item-start",Ch="carousel-item-next",Sh="carousel-item-prev",Yo=".active",Go=".carousel-item",kh=Yo+Go,Th=".carousel-item img",xh=".carousel-indicators",Ah="[data-bs-slide], [data-bs-slide-to]",Mh='[data-bs-ride="carousel"]',Oh={[uh]:Yt,[mh]:dt},Nh={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Lh={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Pt extends Ne{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=X.findOne(xh,this._element),this._addEventListeners(),this._config.ride===Ko&&this.cycle()}static get Default(){return Nh}static get DefaultType(){return Lh}static get NAME(){return ch}next(){this._slide(St)}nextWhenVisible(){!document.hidden&&$t(this._element)&&this.next()}prev(){this._slide(lt)}pause(){this._isSliding&&Io(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){V.one(this._element,ys,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){V.one(this._element,ys,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?St:lt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&V.on(this._element,vh,e=>this._keydown(e)),this._config.pause==="hover"&&(V.on(this._element,hh,()=>this.pause()),V.on(this._element,_h,()=>this._maybeEnableCycle())),this._config.touch&&es.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of X.find(Th,this._element))V.on(o,gh,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(dt)),rightCallback:()=>this._slide(this._directionToOrder(Yt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),ph+this._config.interval))}};this._swipeHelper=new es(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Oh[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=X.findOne(Yo,this._indicatorsElement);s.classList.remove(Wt),s.removeAttribute("aria-current");const o=X.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Wt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===St,a=s||en(this._getItems(),o,i,this._config.wrap);if(a===o)return;const l=this._getItemIndex(a),r=p=>V.trigger(this._element,p,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(r(fh).defaultPrevented||!o||!a)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=a;const d=i?Eh:wh,y=i?Ch:Sh;a.classList.add(y),Dt(a),o.classList.add(d),a.classList.add(d);const h=()=>{a.classList.remove(d,y),a.classList.add(Wt),o.classList.remove(Wt,y,d),this._isSliding=!1,r(ys)};this._queueCallback(h,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains($h)}_getActive(){return X.findOne(kh,this._element)}_getItems(){return X.find(Go,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return xe()?e===dt?lt:St:e===dt?St:lt}_orderToDirection(e){return xe()?e===lt?dt:Yt:e===lt?Yt:dt}static jQueryInterface(e){return this.each(function(){const s=Pt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}V.on(document,yh,Ah,function(n){const e=X.getElementFromSelector(this);if(!e||!e.classList.contains(Ko))return;n.preventDefault();const s=Pt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Re.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});V.on(window,bh,()=>{const n=X.find(Mh);for(const e of n)Pt.getOrCreateInstance(e)});Me(Pt);const Dh="collapse",Ih="bs.collapse",jt=`.${Ih}`,Ph=".data-api",jh=`show${jt}`,Rh=`shown${jt}`,Vh=`hide${jt}`,Hh=`hidden${jt}`,Wh=`click${jt}${Ph}`,$s="show",mt="collapse",Ft="collapsing",Fh="collapsed",Uh=`:scope .${mt} .${mt}`,Bh="collapse-horizontal",qh="width",zh="height",Kh=".collapse.show, .collapse.collapsing",js='[data-bs-toggle="collapse"]',Yh={parent:null,toggle:!0},Gh={parent:"(null|element)",toggle:"boolean"};class Nt extends Ne{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=X.find(js);for(const i of o){const a=X.getSelectorFromElement(i),l=X.find(a).filter(r=>r===this._element);a!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Yh}static get DefaultType(){return Gh}static get NAME(){return Dh}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Kh).filter(r=>r!==this._element).map(r=>Nt.getOrCreateInstance(r,{toggle:!1}))),e.length&&e[0]._isTransitioning||V.trigger(this._element,jh).defaultPrevented)return;for(const r of e)r.hide();const o=this._getDimension();this._element.classList.remove(mt),this._element.classList.add(Ft),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(mt,$s),this._element.style[o]="",V.trigger(this._element,Rh)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||V.trigger(this._element,Vh).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Dt(this._element),this._element.classList.add(Ft),this._element.classList.remove(mt,$s);for(const i of this._triggerArray){const a=X.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(mt),V.trigger(this._element,Hh)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains($s)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Be(e.parent),e}_getDimension(){return this._element.classList.contains(Bh)?qh:zh}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(js);for(const s of e){const o=X.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=X.find(Uh,this._config.parent);return X.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Fh,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Nt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}V.on(document,Wh,js,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of X.getMultipleElementsFromSelector(this))Nt.getOrCreateInstance(e,{toggle:!1}).toggle()});Me(Nt);const Dn="dropdown",Jh="bs.dropdown",it=`.${Jh}`,sn=".data-api",Xh="Escape",In="Tab",Qh="ArrowUp",Pn="ArrowDown",Zh=2,e_=`hide${it}`,t_=`hidden${it}`,s_=`show${it}`,n_=`shown${it}`,Jo=`click${it}${sn}`,Xo=`keydown${it}${sn}`,o_=`keyup${it}${sn}`,ut="show",i_="dropup",a_="dropend",l_="dropstart",r_="dropup-center",c_="dropdown-center",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',d_=`${Ze}.${ut}`,Gt=".dropdown-menu",u_=".navbar",m_=".navbar-nav",p_=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",f_=xe()?"top-end":"top-start",v_=xe()?"top-start":"top-end",h_=xe()?"bottom-end":"bottom-start",__=xe()?"bottom-start":"bottom-end",g_=xe()?"left-start":"right-start",b_=xe()?"right-start":"left-start",y_="top",$_="bottom",w_={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},E_={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class De extends Ne{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=X.next(this._element,Gt)[0]||X.prev(this._element,Gt)[0]||X.findOne(Gt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return w_}static get DefaultType(){return E_}static get NAME(){return Dn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(qe(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!V.trigger(this._element,s_,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(m_))for(const o of[].concat(...document.body.children))V.on(o,"mouseover",Zt);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ut),this._element.classList.add(ut),V.trigger(this._element,n_,e)}}hide(){if(qe(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!V.trigger(this._element,e_,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))V.off(o,"mouseover",Zt);this._popper&&this._popper.destroy(),this._menu.classList.remove(ut),this._element.classList.remove(ut),this._element.setAttribute("aria-expanded","false"),Re.removeDataAttribute(this._menu,"popper"),V.trigger(this._element,t_,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!je(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Dn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Lo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:je(this._config.reference)?e=Be(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Zs(e,this._menu,s)}_isShown(){return this._menu.classList.contains(ut)}_getPlacement(){const e=this._parent;if(e.classList.contains(a_))return g_;if(e.classList.contains(l_))return b_;if(e.classList.contains(r_))return y_;if(e.classList.contains(c_))return $_;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(i_)?s?v_:f_:s?__:h_}_detectNavbar(){return this._element.closest(u_)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Re.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...we(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=X.find(p_,this._menu).filter(i=>$t(i));o.length&&en(o,s,e===Pn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=De.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===Zh||e.type==="keyup"&&e.key!==In)return;const s=X.find(d_);for(const o of s){const i=De.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),l=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===In||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const r={relatedTarget:i._element};e.type==="click"&&(r.clickEvent=e),i._completeHide(r)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Xh,i=[Qh,Pn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const a=this.matches(Ze)?this:X.prev(this,Ze)[0]||X.next(this,Ze)[0]||X.findOne(Ze,e.delegateTarget.parentNode),l=De.getOrCreateInstance(a);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),a.focus())}}V.on(document,Xo,Ze,De.dataApiKeydownHandler);V.on(document,Xo,Gt,De.dataApiKeydownHandler);V.on(document,Jo,De.clearMenus);V.on(document,o_,De.clearMenus);V.on(document,Jo,Ze,function(n){n.preventDefault(),De.getOrCreateInstance(this).toggle()});Me(De);const Qo="backdrop",C_="fade",jn="show",Rn=`mousedown.bs.${Qo}`,S_={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},k_={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Zo extends It{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return S_}static get DefaultType(){return k_}static get NAME(){return Qo}show(e){if(!this._config.isVisible){we(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Dt(s),s.classList.add(jn),this._emulateAnimation(()=>{we(e)})}hide(e){if(!this._config.isVisible){we(e);return}this._getElement().classList.remove(jn),this._emulateAnimation(()=>{this.dispose(),we(e)})}dispose(){this._isAppended&&(V.off(this._element,Rn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(C_),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Be(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),V.on(e,Rn,()=>{we(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Ro(e,this._getElement(),this._config.isAnimated)}}const T_="focustrap",x_="bs.focustrap",ts=`.${x_}`,A_=`focusin${ts}`,M_=`keydown.tab${ts}`,O_="Tab",N_="forward",Vn="backward",L_={autofocus:!0,trapElement:null},D_={autofocus:"boolean",trapElement:"element"};class ei extends It{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return L_}static get DefaultType(){return D_}static get NAME(){return T_}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),V.off(document,ts),V.on(document,A_,e=>this._handleFocusin(e)),V.on(document,M_,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,V.off(document,ts))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=X.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Vn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===O_&&(this._lastTabNavDirection=e.shiftKey?Vn:N_)}}const Hn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Wn=".sticky-top",Ut="padding-right",Fn="margin-right";class Rs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ut,s=>s+e),this._setElementAttributes(Hn,Ut,s=>s+e),this._setElementAttributes(Wn,Fn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ut),this._resetElementAttributes(Hn,Ut),this._resetElementAttributes(Wn,Fn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),a=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,s);const r=window.getComputedStyle(l).getPropertyValue(s);l.style.setProperty(s,`${o(Number.parseFloat(r))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Re.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const a=Re.getDataAttribute(i,s);if(a===null){i.style.removeProperty(s);return}Re.removeDataAttribute(i,s),i.style.setProperty(s,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(je(e)){s(e);return}for(const o of X.find(e,this._element))s(o)}}const I_="modal",P_="bs.modal",Ae=`.${P_}`,j_=".data-api",R_="Escape",V_=`hide${Ae}`,H_=`hidePrevented${Ae}`,ti=`hidden${Ae}`,si=`show${Ae}`,W_=`shown${Ae}`,F_=`resize${Ae}`,U_=`click.dismiss${Ae}`,B_=`mousedown.dismiss${Ae}`,q_=`keydown.dismiss${Ae}`,z_=`click${Ae}${j_}`,Un="modal-open",K_="fade",Bn="show",ws="modal-static",Y_=".modal.show",G_=".modal-dialog",J_=".modal-body",X_='[data-bs-toggle="modal"]',Q_={backdrop:!0,focus:!0,keyboard:!0},Z_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ze extends Ne{constructor(e,s){super(e,s),this._dialog=X.findOne(G_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Rs,this._addEventListeners()}static get Default(){return Q_}static get DefaultType(){return Z_}static get NAME(){return I_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||V.trigger(this._element,si,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Un),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||V.trigger(this._element,V_).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Bn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){V.off(window,Ae),V.off(this._dialog,Ae),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Zo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=X.findOne(J_,this._dialog);s&&(s.scrollTop=0),Dt(this._element),this._element.classList.add(Bn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,V.trigger(this._element,W_,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){V.on(this._element,q_,e=>{if(e.key===R_){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),V.on(window,F_,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),V.on(this._element,B_,e=>{V.one(this._element,U_,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Un),this._resetAdjustments(),this._scrollBar.reset(),V.trigger(this._element,ti)})}_isAnimated(){return this._element.classList.contains(K_)}_triggerBackdropTransition(){if(V.trigger(this._element,H_).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(ws)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(ws),this._queueCallback(()=>{this._element.classList.remove(ws),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=xe()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=xe()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}V.on(document,z_,X_,function(n){const e=X.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),V.one(e,si,i=>{i.defaultPrevented||V.one(e,ti,()=>{$t(this)&&this.focus()})});const s=X.findOne(Y_);s&&ze.getInstance(s).hide(),ze.getOrCreateInstance(e).toggle(this)});as(ze);Me(ze);const eg="offcanvas",tg="bs.offcanvas",Fe=`.${tg}`,ni=".data-api",sg=`load${Fe}${ni}`,ng="Escape",qn="show",zn="showing",Kn="hiding",og="offcanvas-backdrop",oi=".offcanvas.show",ig=`show${Fe}`,ag=`shown${Fe}`,lg=`hide${Fe}`,Yn=`hidePrevented${Fe}`,ii=`hidden${Fe}`,rg=`resize${Fe}`,cg=`click${Fe}${ni}`,dg=`keydown.dismiss${Fe}`,ug='[data-bs-toggle="offcanvas"]',mg={backdrop:!0,keyboard:!0,scroll:!1},pg={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ke extends Ne{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return mg}static get DefaultType(){return pg}static get NAME(){return eg}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||V.trigger(this._element,ig,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Rs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(qn),this._element.classList.remove(zn),V.trigger(this._element,ag,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||V.trigger(this._element,lg).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Kn),this._backdrop.hide();const s=()=>{this._element.classList.remove(qn,Kn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Rs().reset(),V.trigger(this._element,ii)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){V.trigger(this._element,Yn);return}this.hide()},s=!!this._config.backdrop;return new Zo({className:og,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_addEventListeners(){V.on(this._element,dg,e=>{if(e.key===ng){if(this._config.keyboard){this.hide();return}V.trigger(this._element,Yn)}})}static jQueryInterface(e){return this.each(function(){const s=Ke.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}V.on(document,cg,ug,function(n){const e=X.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),qe(this))return;V.one(e,ii,()=>{$t(this)&&this.focus()});const s=X.findOne(oi);s&&s!==e&&Ke.getInstance(s).hide(),Ke.getOrCreateInstance(e).toggle(this)});V.on(window,sg,()=>{for(const n of X.find(oi))Ke.getOrCreateInstance(n).show()});V.on(window,rg,()=>{for(const n of X.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ke.getOrCreateInstance(n).hide()});as(Ke);Me(Ke);const fg=/^aria-[\w-]*$/i,ai={"*":["class","dir","id","lang","role",fg],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},vg=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),hg=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,_g=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?vg.has(s)?!!hg.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function gg(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const l of a){const r=l.nodeName.toLowerCase();if(!Object.keys(e).includes(r)){l.remove();continue}const c=[].concat(...l.attributes),f=[].concat(e["*"]||[],e[r]||[]);for(const d of c)_g(d,f)||l.removeAttribute(d.nodeName)}return i.body.innerHTML}const bg="TemplateFactory",yg={allowList:ai,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},$g={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},wg={entry:"(string|element|function|null)",selector:"(string|element)"};class Eg extends It{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return yg}static get DefaultType(){return $g}static get NAME(){return bg}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},wg)}_setContent(e,s,o){const i=X.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(je(s)){this._putElementInTemplate(Be(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?gg(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return we(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Cg="tooltip",Sg=new Set(["sanitize","allowList","sanitizeFn"]),Es="fade",kg="modal",Bt="show",Tg=".tooltip-inner",Gn=`.${kg}`,Jn="hide.bs.modal",kt="hover",Cs="focus",Ss="click",xg="manual",Ag="hide",Mg="hidden",Og="show",Ng="shown",Lg="inserted",Dg="click",Ig="focusin",Pg="focusout",jg="mouseenter",Rg="mouseleave",Vg={AUTO:"auto",TOP:"top",RIGHT:xe()?"left":"right",BOTTOM:"bottom",LEFT:xe()?"right":"left"},Hg={allowList:ai,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Wg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Et extends Ne{constructor(e,s){if(typeof Lo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Hg}static get DefaultType(){return Wg}static get NAME(){return Cg}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),V.off(this._element.closest(Gn),Jn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=V.trigger(this._element,this.constructor.eventName(Og)),o=(Po(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),V.trigger(this._element,this.constructor.eventName(Lg))),this._popper=this._createPopper(i),i.classList.add(Bt),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))V.on(r,"mouseover",Zt);const l=()=>{V.trigger(this._element,this.constructor.eventName(Ng)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||V.trigger(this._element,this.constructor.eventName(Ag)).defaultPrevented)return;if(this._getTipElement().classList.remove(Bt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))V.off(i,"mouseover",Zt);this._activeTrigger[Ss]=!1,this._activeTrigger[Cs]=!1,this._activeTrigger[kt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),V.trigger(this._element,this.constructor.eventName(Mg)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Es,Bt),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=xv(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Es),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Eg({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Tg]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Es)}_isShown(){return this.tip&&this.tip.classList.contains(Bt)}_createPopper(e){const s=we(this._config.placement,[this,e,this._element]),o=Vg[s.toUpperCase()];return Zs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return we(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...we(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")V.on(this._element,this.constructor.eventName(Dg),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ss]=!(i._isShown()&&i._activeTrigger[Ss]),i.toggle()});else if(s!==xg){const o=s===kt?this.constructor.eventName(jg):this.constructor.eventName(Ig),i=s===kt?this.constructor.eventName(Rg):this.constructor.eventName(Pg);V.on(this._element,o,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusin"?Cs:kt]=!0,l._enter()}),V.on(this._element,i,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusout"?Cs:kt]=l._element.contains(a.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},V.on(this._element.closest(Gn),Jn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Re.getDataAttributes(this._element);for(const o of Object.keys(s))Sg.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Be(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Et.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Me(Et);const Fg="popover",Ug=".popover-header",Bg=".popover-body",qg={...Et.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},zg={...Et.DefaultType,content:"(null|string|element|function)"};class nn extends Et{static get Default(){return qg}static get DefaultType(){return zg}static get NAME(){return Fg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Ug]:this._getTitle(),[Bg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=nn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Me(nn);const Kg="scrollspy",Yg="bs.scrollspy",on=`.${Yg}`,Gg=".data-api",Jg=`activate${on}`,Xn=`click${on}`,Xg=`load${on}${Gg}`,Qg="dropdown-item",rt="active",Zg='[data-bs-spy="scroll"]',ks="[href]",eb=".nav, .list-group",Qn=".nav-link",tb=".nav-item",sb=".list-group-item",nb=`${Qn}, ${tb} > ${Qn}, ${sb}`,ob=".dropdown",ib=".dropdown-toggle",ab={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},lb={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class cs extends Ne{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ab}static get DefaultType(){return lb}static get NAME(){return Kg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Be(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(V.off(this._config.target,Xn),V.on(this._config.target,Xn,ks,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(s(l))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(l));continue}const r=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&r){if(o(l),!i)return;continue}!a&&!r&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=X.find(ks,this._config.target);for(const s of e){if(!s.hash||qe(s))continue;const o=X.findOne(decodeURI(s.hash),this._element);$t(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(rt),this._activateParents(e),V.trigger(this._element,Jg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Qg)){X.findOne(ib,e.closest(ob)).classList.add(rt);return}for(const s of X.parents(e,eb))for(const o of X.prev(s,nb))o.classList.add(rt)}_clearActiveClass(e){e.classList.remove(rt);const s=X.find(`${ks}.${rt}`,e);for(const o of s)o.classList.remove(rt)}static jQueryInterface(e){return this.each(function(){const s=cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}V.on(window,Xg,()=>{for(const n of X.find(Zg))cs.getOrCreateInstance(n)});Me(cs);const rb="tab",cb="bs.tab",at=`.${cb}`,db=`hide${at}`,ub=`hidden${at}`,mb=`show${at}`,pb=`shown${at}`,fb=`click${at}`,vb=`keydown${at}`,hb=`load${at}`,_b="ArrowLeft",Zn="ArrowRight",gb="ArrowUp",eo="ArrowDown",Ts="Home",to="End",et="active",so="fade",xs="show",bb="dropdown",li=".dropdown-toggle",yb=".dropdown-menu",As=`:not(${li})`,$b='.list-group, .nav, [role="tablist"]',wb=".nav-item, .list-group-item",Eb=`.nav-link${As}, .list-group-item${As}, [role="tab"]${As}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ms=`${Eb}, ${ri}`,Cb=`.${et}[data-bs-toggle="tab"], .${et}[data-bs-toggle="pill"], .${et}[data-bs-toggle="list"]`;class gt extends Ne{constructor(e){super(e),this._parent=this._element.closest($b),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),V.on(this._element,vb,s=>this._keydown(s)))}static get NAME(){return rb}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?V.trigger(s,db,{relatedTarget:e}):null;V.trigger(e,mb,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(et),this._activate(X.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(xs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),V.trigger(e,pb,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(so))}_deactivate(e,s){if(!e)return;e.classList.remove(et),e.blur(),this._deactivate(X.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(xs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),V.trigger(e,ub,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(so))}_keydown(e){if(![_b,Zn,gb,eo,Ts,to].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!qe(i));let o;if([Ts,to].includes(e.key))o=s[e.key===Ts?0:s.length-1];else{const i=[Zn,eo].includes(e.key);o=en(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),gt.getOrCreateInstance(o).show())}_getChildren(){return X.find(Ms,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=X.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(bb))return;const i=(a,l)=>{const r=X.findOne(a,o);r&&r.classList.toggle(l,s)};i(li,et),i(yb,xs),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(et)}_getInnerElement(e){return e.matches(Ms)?e:X.findOne(Ms,e)}_getOuterElement(e){return e.closest(wb)||e}static jQueryInterface(e){return this.each(function(){const s=gt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}V.on(document,fb,ri,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!qe(this)&&gt.getOrCreateInstance(this).show()});V.on(window,hb,()=>{for(const n of X.find(Cb))gt.getOrCreateInstance(n)});Me(gt);const Sb="toast",kb="bs.toast",Xe=`.${kb}`,Tb=`mouseover${Xe}`,xb=`mouseout${Xe}`,Ab=`focusin${Xe}`,Mb=`focusout${Xe}`,Ob=`hide${Xe}`,Nb=`hidden${Xe}`,Lb=`show${Xe}`,Db=`shown${Xe}`,Ib="fade",no="hide",qt="show",zt="showing",Pb={animation:"boolean",autohide:"boolean",delay:"number"},jb={animation:!0,autohide:!0,delay:5e3};class ds extends Ne{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return jb}static get DefaultType(){return Pb}static get NAME(){return Sb}show(){if(V.trigger(this._element,Lb).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Ib);const s=()=>{this._element.classList.remove(zt),V.trigger(this._element,Db),this._maybeScheduleHide()};this._element.classList.remove(no),Dt(this._element),this._element.classList.add(qt,zt),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||V.trigger(this._element,Ob).defaultPrevented)return;const s=()=>{this._element.classList.add(no),this._element.classList.remove(zt,qt),V.trigger(this._element,Nb)};this._element.classList.add(zt),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(qt),super.dispose()}isShown(){return this._element.classList.contains(qt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){V.on(this._element,Tb,e=>this._onInteraction(e,!0)),V.on(this._element,xb,e=>this._onInteraction(e,!1)),V.on(this._element,Ab,e=>this._onInteraction(e,!0)),V.on(this._element,Mb,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}as(ds);Me(ds);const Rb={class:"modal-dialog modal-dialog-centered"},Vb={class:"modal-content"},Hb={class:"modal-body"},Wb={key:0,class:"alert alert-danger"},Fb={class:"mb-3"},Ub={class:"mb-3"},Bb={class:"form-text"},qb={class:"mb-3"},zb={class:"mb-3"},Kb=["value"],Yb={class:"modal-footer"},Gb=["disabled"],Jb={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:s}){const o=n,i=s,a=ne(),l=O(null),r=O(null),c=O(""),f=O(!1),d=O({name:"",purpose:"",description:"",member_minion_ids:[]}),y=_(()=>{const g=[];for(const[v,A]of a.sessions.entries())A.is_minion&&A.project_id===o.legionId&&g.push(A);return g}),h=_(()=>d.value.name.trim()!==""&&d.value.purpose.trim()!==""),p=async()=>{if(!h.value){c.value="Name and purpose are required";return}f.value=!0,c.value="";try{const g=await te.post(`/api/legions/${o.legionId}/channels`,{name:d.value.name.trim(),purpose:d.value.purpose.trim(),description:d.value.description.trim()||"",member_minion_ids:d.value.member_minion_ids});i("created",g.channel),r.value?.hide(),d.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(g){console.error("Failed to create channel:",g),c.value=g.response?.data?.detail||"Failed to create channel"}finally{f.value=!1}},w=()=>{r.value?.show()},b=()=>{r.value?.hide()};return pe(()=>{l.value&&(r.value=new ze(l.value))}),_e(()=>{r.value?.dispose()}),e({show:w,hide:b}),(g,v)=>(u(),Ee(ao,{to:"body"},[t("div",{ref_key:"modalElement",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[t("div",Rb,[t("div",Vb,[v[11]||(v[11]=t("div",{class:"modal-header"},[t("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Hb,[c.value?(u(),m("div",Wb,$(c.value),1)):D("",!0),t("form",{onSubmit:ge(p,["prevent"])},[t("div",Fb,[v[4]||(v[4]=t("label",{for:"channel-name",class:"form-label"},[K(" Channel Name "),t("span",{class:"text-danger"},"*")],-1)),se(t("input",{id:"channel-name","onUpdate:modelValue":v[0]||(v[0]=A=>d.value.name=A),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[ue,d.value.name]]),v[5]||(v[5]=t("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),t("div",Ub,[v[6]||(v[6]=t("label",{for:"channel-purpose",class:"form-label"},[K(" Purpose "),t("span",{class:"text-danger"},"*")],-1)),se(t("textarea",{id:"channel-purpose","onUpdate:modelValue":v[1]||(v[1]=A=>d.value.purpose=A),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[ue,d.value.purpose]]),t("div",Bb,$(d.value.purpose.length)+" / 500 characters",1)]),t("div",qb,[v[7]||(v[7]=t("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),se(t("textarea",{id:"channel-description","onUpdate:modelValue":v[2]||(v[2]=A=>d.value.description=A),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[ue,d.value.description]])]),t("div",zb,[v[8]||(v[8]=t("label",{class:"form-label"},"Initial Members (Optional)",-1)),se(t("select",{"onUpdate:modelValue":v[3]||(v[3]=A=>d.value.member_minion_ids=A),multiple:"",class:"form-select",size:"5"},[(u(!0),m(ie,null,ce(y.value,A=>(u(),m("option",{key:A.session_id,value:A.session_id},$(A.name)+$(A.role?` (${A.role})`:""),9,Kb))),128))],512),[[Oe,d.value.member_minion_ids]]),v[9]||(v[9]=t("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),t("div",Yb,[v[10]||(v[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:p,disabled:f.value||!h.value},$(f.value?"Creating...":"Create Channel"),9,Gb)])])])],512)]))}},Xb=G(Jb,[["__scopeId","data-v-573f4c01"]]),Qb={class:"modal-dialog modal-dialog-centered"},Zb={class:"modal-content"},ey={class:"modal-body"},ty={key:0,class:"alert alert-danger"},sy={class:"text-muted"},ny={class:"modal-footer"},oy=["disabled"],iy={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:s}){const o=n,i=s,a=O(null),l=O(null),r=O(""),c=O(!1),f=_(()=>o.channel?.member_minion_ids?.length||0),d=async()=>{if(!o.channel){r.value="No channel selected";return}c.value=!0,r.value="";try{await te.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),i("deleted",o.channel.channel_id),l.value?.hide()}catch(p){console.error("Failed to delete channel:",p),r.value=p.data?.detail||p.message||"Failed to delete channel"}finally{c.value=!1}},y=()=>{r.value="",l.value?.show()},h=()=>{l.value?.hide()};return pe(()=>{a.value&&(l.value=new ze(a.value))}),_e(()=>{l.value?.dispose()}),e({show:y,hide:h}),(p,w)=>(u(),Ee(ao,{to:"body"},[t("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[t("div",Qb,[t("div",Zb,[w[4]||(w[4]=t("div",{class:"modal-header"},[t("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ey,[r.value?(u(),m("div",ty,$(r.value),1)):D("",!0),w[2]||(w[2]=t("div",{class:"alert alert-warning"},[t("strong",null,"⚠️ Warning:"),K(" This action cannot be undone. ")],-1)),t("p",null,[w[0]||(w[0]=K("Are you sure you want to delete ",-1)),t("strong",null,$(n.channel?.name),1),w[1]||(w[1]=K("?",-1))]),t("p",sy," This channel has "+$(f.value)+" "+$(f.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),t("div",ny,[w[3]||(w[3]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-danger",onClick:d,disabled:c.value},$(c.value?"Deleting...":"Delete Channel"),9,oy)])])])],512)]))}},ay=["id"],ly={class:"accordion-item"},ry={class:"accordion-header"},cy=["aria-expanded","aria-controls"],dy={class:"text-muted ms-2"},uy=["id","data-bs-parent"],my={class:"accordion-body p-0"},py={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},fy={key:1,class:"list-group list-group-flush"},vy={class:"d-flex align-items-center justify-content-between"},hy=["onClick"],_y={class:"channel-name"},gy={class:"d-flex align-items-center gap-2"},by={class:"badge bg-secondary member-count"},yy=["onClick"],$y={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ye(),o=ot(),i=O(null),a=O(null),l=O(null),r=O(!0),c=_(()=>`channelsAccordion-${e.project.project_id}`),f=_(()=>`channelsCollapsePanel-${e.project.project_id}`),d=_(()=>o.channelsByLegion.get(e.project.project_id)||[]),y=_(()=>d.value.length);function h(){const T=window.bootstrap;if(!T)return;const N=document.getElementById(f.value);if(!N)return;T.Collapse.getOrCreateInstance(N).toggle()}function p(){r.value=!0}function w(){r.value=!1}function b(T){s.push(`/channel/${e.project.project_id}/${T}`)}function g(){i.value?.show()}function v(T){l.value=T,a.value?.show()}function A(T){o.loadChannels(e.project.project_id)}function C(T){const I=(o.channelsByLegion.get(e.project.project_id)||[]).filter(E=>E.channel_id!==T);o.channelsByLegion.set(e.project.project_id,I),s.currentRoute.value.path.includes(T)&&s.push(`/timeline/${e.project.project_id}`)}return pe(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(T){console.error("Failed to load channels:",T)}}),(T,N)=>(u(),m(ie,null,[t("div",{class:"accordion mt-2",id:c.value},[t("div",ly,[t("h2",ry,[t("button",{class:Y(["accordion-button",{collapsed:!r.value}]),type:"button","aria-expanded":r.value,"aria-controls":f.value,onClick:h},[N[0]||(N[0]=t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"💬",-1)),N[1]||(N[1]=t("span",{class:"fw-semibold"},"Channels",-1)),t("small",dy,"("+$(y.value)+")",1)],10,cy)]),t("div",{id:f.value,class:Y(["accordion-collapse","collapse",{show:r.value}]),"data-bs-parent":`#${c.value}`,onShown:p,onHidden:w},[t("div",my,[t("div",{class:"p-2 border-bottom"},[t("button",{class:"btn btn-sm btn-primary w-100",onClick:g}," + New Channel ")]),d.value.length===0?(u(),m("div",py,' No channels yet. Click "New Channel" to create one. ')):(u(),m("div",fy,[(u(!0),m(ie,null,ce(d.value,I=>(u(),m("div",{key:I.channel_id,class:"list-group-item list-group-item-action channel-item"},[t("div",vy,[t("div",{class:"d-flex align-items-center flex-grow-1",onClick:E=>b(I.channel_id)},[N[2]||(N[2]=t("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"💬",-1)),t("span",_y,$(I.name),1)],8,hy),t("div",gy,[t("span",by,$(I.member_minion_ids?.length||0),1),t("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:ge(E=>v(I),["stop"]),title:"Delete channel",style:{"font-size":"1.1rem","line-height":"1"}}," 🗑️ ",8,yy)])])]))),128))]))])],42,uy)])],8,ay),ae(Xb,{ref_key:"createModal",ref:i,"legion-id":n.project.project_id,onCreated:A},null,8,["legion-id"]),ae(iy,{ref_key:"deleteModal",ref:a,"legion-id":n.project.project_id,channel:l.value,onDeleted:C},null,8,["legion-id","channel"])],64))}},wy=G($y,[["__scopeId","data-v-5644a5de"]]),Ey=["data-project-id"],Cy=["id"],Sy=["aria-expanded","aria-controls","onKeydown"],ky={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Ty={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},xy={class:"fw-semibold",style:{"flex-shrink":"0"}},Ay={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},My={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Oy=["title"],Ny=["title"],Ly=["id","aria-labelledby"],Dy={class:"accordion-body p-0"},Iy={class:"list-group list-group-flush"},Py={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ye(),o=ve(),i=ne(),a=me(),l=O(e.project.is_expanded||!1),r=_(()=>o.formatPath(e.project.working_directory)),c=_(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(I=>i.getSession(I)).filter(I=>I!=null)),f=_(()=>{const I=s.currentRoute.value;return I.name==="timeline"&&I.params.legionId===e.project.project_id}),d=_(()=>{const I=s.currentRoute.value;return I.name==="horde"&&I.params.legionId===e.project.project_id});function y(I){const E=window.bootstrap;if(!E)return;const k=document.getElementById(`collapse-${e.project.project_id}`);if(!k)return;E.Collapse.getOrCreateInstance(k).toggle()}function h(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function p(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const I=i.currentSessionId;I&&i.getSession(I)&&e.project.session_ids?.includes(I)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function w(){a.showModal("edit-project",{project:e.project})}function b(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function g(){s.push(`/timeline/${e.project.project_id}`)}function v(){s.push(`/horde/${e.project.project_id}`)}function A(I){I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("application/project-id",e.project.project_id),I.dataTransfer.setData("text/plain",e.project.project_id),I.target.classList.add("dragging")}function C(I){I.target.classList.remove("dragging")}function T(I){I.preventDefault(),I.dataTransfer.dropEffect="move";const E=I.currentTarget.getBoundingClientRect(),k=E.top+E.height/2;I.clientY<k?(I.currentTarget.classList.add("drop-above"),I.currentTarget.classList.remove("drop-below")):(I.currentTarget.classList.add("drop-below"),I.currentTarget.classList.remove("drop-above"))}function N(I){I.preventDefault(),I.currentTarget.classList.remove("drop-above","drop-below");const E=I.dataTransfer.getData("application/project-id")||I.dataTransfer.getData("text/plain");if(!E||E===e.project.project_id)return;const k=I.currentTarget.getBoundingClientRect(),j=k.top+k.height/2,M=I.clientY<j,x=o.orderedProjects,S=x.findIndex(oe=>oe.project_id===e.project.project_id),L=x.findIndex(oe=>oe.project_id===E);if(S===-1||L===-1)return;const P=[...x],[R]=P.splice(L,1);let U=M?S:S+1;L<S&&U--,P.splice(U,0,R);const q=P.map(oe=>oe.project_id);o.reorderProjects(q)}return(I,E)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:A,onDragend:C,onDragover:T,onDrop:N},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:Y(["accordion-button bg-white p-2",{collapsed:!l.value}]),role:"button",tabindex:"0","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:y,onKeydown:[Xt(ge(y,["prevent"]),["enter"]),Xt(ge(y,["prevent"]),["space"])]},[t("div",ky,[t("div",Ty,[t("div",xy,[n.project.is_multi_agent?(u(),m("span",Ay,"🏛")):D("",!0),K(" "+$(n.project.name),1)]),t("div",My,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ge(w,["stop"])}," ✏️ "),t("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:ge(b,["stop"])}," ➕ ",8,Oy)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(r.value),9,Ny)])],42,Sy)],8,Cy),ae(Mf,{project:n.project,sessions:c.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:Y(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:p},[t("div",Dy,[t("div",Iy,[n.project.is_multi_agent?(u(),m("div",{key:0,class:Y(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:f.value}]),style:{cursor:"pointer"},onClick:g},[...E[0]||(E[0]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"📊"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):D("",!0),n.project.is_multi_agent?(u(),m(ie,{key:1},[t("div",{class:Y(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:d.value}]),style:{cursor:"pointer"},onClick:v},[...E[1]||(E[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"🌳"),t("span",{class:"fw-semibold"},"Horde"),t("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),ae(Rf,{project:n.project,sessions:c.value},null,8,["project","sessions"]),ae(wy,{project:n.project},null,8,["project"])],64)):(u(!0),m(ie,{key:2},ce(c.value,k=>(u(),Ee(Df,{key:k.session_id,session:k,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,Ly)],40,Ey))}},jy=G(Py,[["__scopeId","data-v-04f4e534"]]),Ry={class:"project-list"},Vy={key:0,class:"text-muted text-center py-3"},Hy={__name:"ProjectList",setup(n){const e=ve(),s=_(()=>e.orderedProjects);return(o,i)=>(u(),m("div",Ry,[s.value.length===0?(u(),m("div",Vy,' No projects yet. Click "New" to create one. ')):D("",!0),(u(!0),m(ie,null,ce(s.value,a=>(u(),Ee(jy,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},Wy={class:"flex-grow-1 overflow-auto p-3"},Fy={id:"sessions-container"},Uy={__name:"Sidebar",setup(n){const e=me(),s=_(()=>e.sidebarCollapsed),o=_(()=>e.isMobile),i=_(()=>{if(o.value)return{};const d=`${e.sidebarWidth}px`;return{width:d,minWidth:"200px",maxWidth:"30vw","--sidebar-width":d}});function a(){e.showModal("create-project")}const l=O(!1);function r(d){l.value=!0,document.addEventListener("mousemove",c),document.addEventListener("mouseup",f)}function c(d){l.value&&e.setSidebarWidth(d.clientX)}function f(){l.value=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",f)}return(d,y)=>(u(),m("aside",{id:"sidebar",class:Y(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value}]),style:Ve(i.value)},[t("div",Wy,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[y[0]||(y[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," 📁 New ")]),t("div",Fy,[ae(Hy)])]),t("div",{class:"sidebar-resize-handle",onMousedown:r},null,32)],6))}},By=G(Uy,[["__scopeId","data-v-d792f0f0"]]),qy={class:"modal-dialog modal-lg"},zy={class:"modal-content"},Ky={class:"modal-body"},Yy={class:"mb-3"},Gy={class:"input-group"},Jy=["disabled"],Xy={key:0,class:"text-center py-4"},Qy={key:1,class:"alert alert-danger",role:"alert"},Zy={key:2,class:"folder-list"},e1=["onClick","onDblclick"],t1={class:"d-flex align-items-center flex-grow-1"},s1=["onClick"],n1={key:1,class:"text-center text-muted py-3"},o1={class:"modal-footer"},i1=["disabled"],a1={__name:"FolderBrowserModal",setup(n){const e=me(),s=O(""),o=O(""),i=O([]),a=O(!1),l=O(""),r=O(null);let c=null,f=null;const d=_(()=>{if(!s.value)return null;const C=s.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?C.join("/"):"/")});function y(C){if(!C)return"";const T=C.split(/[\\/]/).filter(Boolean);return T.length<=2?C:".../"+T.slice(-2).join("/")}async function h(){a.value=!0,l.value="",i.value=[],o.value="";try{const C=s.value?{path:s.value}:{},T=await te.get("/api/filesystem/browse",{params:C});T.current_path&&(s.value=T.current_path),i.value=T.directories||[]}catch(C){console.error("Failed to load directory:",C),l.value=C.message||"Failed to load directory"}finally{a.value=!1}}function p(C){o.value=C.path}function w(C){s.value=C.path,o.value="",h()}function b(){d.value&&(s.value=d.value,o.value="",h())}function g(){const C=o.value||s.value;C&&f&&f(C),c&&c.hide()}function v(){h()}function A(){i.value=[],o.value="",l.value="",f=null,e.hideModal()}return re(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&c){const T=C.data||{};s.value=T.currentPath||"",f=T.onSelect||null,c.show()}}),pe(()=>{r.value&&be(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{c=new C(r.value),r.value.addEventListener("shown.bs.modal",v),r.value.addEventListener("hidden.bs.modal",A)})}),_e(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",v),r.value.removeEventListener("hidden.bs.modal",A)),c&&c.dispose()}),(C,T)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",qy,[t("div",zy,[T[7]||(T[7]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ky,[t("div",Yy,[T[2]||(T[2]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Gy,[se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=N=>s.value=N),onKeyup:Xt(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[ue,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:a.value},[...T[1]||(T[1]=[t("i",{class:"bi bi-arrow-clockwise"},null,-1),K(" Refresh ",-1)])],8,Jy)])]),a.value?(u(),m("div",Xy,[...T[3]||(T[3]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(u(),m("div",Qy,$(l.value),1)):(u(),m("div",Zy,[d.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...T[4]||(T[4]=[t("i",{class:"bi bi-arrow-up-circle me-2 text-secondary"},null,-1),t("span",{class:"text-secondary"},"..",-1)])])):D("",!0),(u(!0),m(ie,null,ce(i.value,N=>(u(),m("div",{key:N.path,class:Y(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:N.path===o.value}]),onClick:I=>p(N),onDblclick:I=>w(N),role:"button"},[t("div",t1,[T[5]||(T[5]=t("i",{class:"bi bi-folder-fill me-2 text-warning"},null,-1)),t("span",null,$(N.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ge(I=>w(N),["stop"])}," Open ",8,s1)],42,e1))),128)),i.value.length===0?(u(),m("div",n1," No subdirectories found ")):D("",!0)]))]),t("div",o1,[T[6]||(T[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:!o.value},' Select "'+$(y(o.value||s.value))+'" ',9,i1)])])])],512))}},l1=G(a1,[["__scopeId","data-v-667c51a9"]]),r1={class:"modal-dialog"},c1={class:"modal-content"},d1={class:"modal-body"},u1={class:"mb-3"},m1={key:0,class:"invalid-feedback"},p1={class:"mb-3"},f1={class:"input-group"},v1={key:0,class:"invalid-feedback"},h1={class:"mb-3 form-check"},_1={class:"mb-3 form-check"},g1={class:"form-check-label",for:"createSession"},b1={key:0,class:"mb-3 ms-4"},y1={for:"sessionName",class:"form-label"},$1={key:1,class:"alert alert-danger",role:"alert"},w1={class:"modal-footer"},E1=["disabled"],C1={key:0,class:"spinner-border spinner-border-sm me-2"},S1={__name:"ProjectCreateModal",setup(n){const e=ve(),s=ne(),o=me(),i=O({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=O({name:"",workingDirectory:""}),l=O(!1),r=O(""),c=O(null);let f=null;function d(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:g=>{i.value.workingDirectory=g,a.value.workingDirectory=""}})}function y(){a.value={};let g=!0;return i.value.name.trim()||(a.value.name="Project name is required",g=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",g=!1),g}async function h(){if(y()){l.value=!0,r.value="";try{const g=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await s.createSession(g.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),f&&f.hide(),p()}catch(g){console.error("Failed to create project:",g),r.value=g.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function p(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},r.value=""}function w(){const g=document.getElementById("projectName");g&&g.focus()}function b(){p(),o.hideModal()}return re(()=>o.currentModal,g=>{g?.name==="create-project"&&f&&f.show()}),pe(()=>{c.value&&be(async()=>{const{default:g}=await import("./modal-B4rHLo2F.js").then(v=>v.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{f=new g(c.value),c.value.addEventListener("shown.bs.modal",w),c.value.addEventListener("hidden.bs.modal",b)})}),_e(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",w),c.value.removeEventListener("hidden.bs.modal",b)),f&&f.dispose()}),(g,v)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",r1,[t("div",c1,[v[11]||(v[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",d1,[t("form",{onSubmit:ge(h,["prevent"])},[t("div",u1,[v[5]||(v[5]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":v[0]||(v[0]=A=>i.value.name=A),placeholder:"My Project",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",m1,$(a.value.name),1)):D("",!0)]),t("div",p1,[v[6]||(v[6]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",f1,[se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":v[1]||(v[1]=A=>i.value.workingDirectory=A),placeholder:"/path/to/project",required:""},null,2),[[ue,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:d}," Browse... "),a.value.workingDirectory?(u(),m("div",v1,$(a.value.workingDirectory),1)):D("",!0)]),v[7]||(v[7]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",h1,[se(t("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":v[2]||(v[2]=A=>i.value.isMultiAgent=A)},null,512),[[At,i.value.isMultiAgent]]),v[8]||(v[8]=t("label",{class:"form-check-label",for:"isMultiAgent"}," 🏛 Multi-Agent Project (Legion) ",-1)),v[9]||(v[9]=t("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),t("div",_1,[se(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":v[3]||(v[3]=A=>i.value.createSession=A)},null,512),[[At,i.value.createSession]]),t("label",g1," Create initial "+$(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(u(),m("div",b1,[t("label",y1," Initial "+$(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),se(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":v[4]||(v[4]=A=>i.value.sessionName=A),placeholder:"main"},null,512),[[ue,i.value.sessionName]])])):D("",!0),r.value?(u(),m("div",$1,$(r.value),1)):D("",!0)],32)]),t("div",w1,[v[10]||(v[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:l.value},[l.value?(u(),m("span",C1)):D("",!0),K(" "+$(l.value?"Creating...":"Create Project"),1)],8,E1)])])])],512))}},k1=G(S1,[["__scopeId","data-v-adf50394"]]),T1={class:"modal-dialog"},x1={class:"modal-content"},A1={class:"modal-body"},M1={class:"mb-3"},O1={key:0,class:"invalid-feedback"},N1={class:"mb-3"},L1=["value"],D1={key:0,class:"alert alert-danger",role:"alert"},I1={class:"danger-zone"},P1={class:"text-muted small"},j1=["disabled"],R1={key:0,class:"alert alert-warning mt-3",role:"alert"},V1={class:"mb-2"},H1={class:"d-flex gap-2"},W1=["disabled"],F1={key:0,class:"spinner-border spinner-border-sm me-2"},U1=["disabled"],B1={class:"modal-footer"},q1=["disabled"],z1={key:0,class:"spinner-border spinner-border-sm me-2"},K1={__name:"ProjectEditModal",setup(n){const e=ve(),s=me(),o=O(null),i=O({name:""}),a=O({name:""}),l=O(!1),r=O(!1),c=O(""),f=O(!1),d=O(null);let y=null;const h=_(()=>o.value?.session_ids?.length||0);function p(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Project name is required",C=!1),C}async function w(){if(!(!p()||!o.value)){l.value=!0,c.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),y&&y.hide()}catch(C){console.error("Failed to update project:",C),c.value=C.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function b(){if(o.value){r.value=!0,c.value="";try{await e.deleteProject(o.value.project_id),y&&y.hide()}catch(C){console.error("Failed to delete project:",C),c.value=C.message||"Failed to delete project. Please try again."}finally{r.value=!1}}}function g(){i.value={name:""},a.value={},c.value="",f.value=!1}function v(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function A(){g(),o.value=null,s.hideModal()}return re(()=>s.currentModal,C=>{if(C?.name==="edit-project"&&y){const T=C.data||{};o.value=T.project,o.value&&(i.value.name=o.value.name),y.show()}}),pe(()=>{d.value&&be(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{y=new C(d.value),d.value.addEventListener("shown.bs.modal",v),d.value.addEventListener("hidden.bs.modal",A)})}),_e(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",v),d.value.removeEventListener("hidden.bs.modal",A)),y&&y.dispose()}),(C,T)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",T1,[t("div",x1,[T[11]||(T[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",A1,[t("form",{onSubmit:ge(w,["prevent"])},[t("div",M1,[T[3]||(T[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":T[0]||(T[0]=N=>i.value.name=N),placeholder:"My Project",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",O1,$(a.value.name),1)):D("",!0)]),t("div",N1,[T[4]||(T[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,L1),T[5]||(T[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),c.value?(u(),m("div",D1,$(c.value),1)):D("",!0)],32),T[9]||(T[9]=t("hr",null,null,-1)),t("div",I1,[T[7]||(T[7]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",P1," Deleting this project will also delete all "+$(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:T[1]||(T[1]=N=>f.value=!0),disabled:r.value},[...T[6]||(T[6]=[t("i",{class:"bi bi-trash"},null,-1),K(" Delete Project ",-1)])],8,j1)]),f.value?(u(),m("div",R1,[T[8]||(T[8]=t("strong",null,"Are you sure?",-1)),t("p",V1,' This will permanently delete the project "'+$(o.value?.name)+'" and all '+$(h.value)+" session(s). ",1),t("div",H1,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:r.value},[r.value?(u(),m("span",F1)):D("",!0),K(" "+$(r.value?"Deleting...":"Yes, Delete Permanently"),1)],8,W1),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:T[2]||(T[2]=N=>f.value=!1),disabled:r.value}," Cancel ",8,U1)])])):D("",!0)]),t("div",B1,[T[10]||(T[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:l.value},[l.value?(u(),m("span",z1)):D("",!0),K(" "+$(l.value?"Saving...":"Save Changes"),1)],8,q1)])])])],512))}},Y1=G(K1,[["__scopeId","data-v-6f299f35"]]),G1={class:"modal-dialog modal-lg"},J1={class:"modal-content"},X1={class:"modal-header"},Q1={class:"modal-title",id:"createSessionModalLabel"},Z1={key:0,class:"text-muted small"},e$={class:"modal-body"},t$={class:"mb-3"},s$={key:0,class:"invalid-feedback"},n$={class:"mb-3"},o$={class:"mb-3"},i$={class:"mb-3"},a$={class:"form-text d-flex justify-content-between"},l$={key:0,class:"invalid-feedback"},r$={class:"mb-3 form-check"},c$={key:0,class:"form-text text-warning"},d$={class:"mb-3"},u$={class:"mb-3 form-check"},m$={key:0,class:"alert alert-danger",role:"alert"},p$={class:"modal-footer"},f$=["disabled"],v$={key:0,class:"spinner-border spinner-border-sm me-2"},h$={__name:"SessionCreateModal",setup(n){const e=Ye();ve();const s=ne(),o=me(),i=O(null),a=O({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0}),l=O({name:""}),r=O(!1),c=O(""),f=O(null);let d=null;const y=_(()=>a.value.system_prompt.length),h=_(()=>y.value>6e3),p=_(()=>y.value>5500&&y.value<=6e3);function w(){l.value={};let C=!0;return a.value.name.trim()||(l.value.name="Session name is required",C=!1),h.value&&(C=!1),C}async function b(){if(!(!w()||!i.value)){r.value=!0,c.value="";try{const C=a.value.tools.split(",").map(I=>I.trim()).filter(I=>I.length>0),T={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,tools:C},N=await s.createSession(i.value.project_id,T);a.value.startImmediately&&await s.startSession(N.session_id),e.push(`/session/${N.session_id}`),d&&d.hide(),g()}catch(C){console.error("Failed to create session:",C),c.value=C.message||"Failed to create session. Please try again."}finally{r.value=!1}}}function g(){a.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0},l.value={},c.value=""}function v(){const C=document.getElementById("sessionName");C&&C.focus()}function A(){g(),i.value=null,o.hideModal()}return re(()=>o.currentModal,C=>{if(C?.name==="create-session"&&d){const T=C.data||{};i.value=T.project,d.show()}}),pe(()=>{f.value&&be(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{d=new C(f.value),f.value.addEventListener("shown.bs.modal",v),f.value.addEventListener("hidden.bs.modal",A)})}),_e(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",v),f.value.removeEventListener("hidden.bs.modal",A)),d&&d.dispose()}),(C,T)=>(u(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[t("div",G1,[t("div",J1,[t("div",X1,[t("h5",Q1,[T[7]||(T[7]=K(" Create New Session ",-1)),i.value?(u(),m("span",Z1,"in "+$(i.value.name),1)):D("",!0)]),T[8]||(T[8]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",e$,[t("form",{onSubmit:ge(b,["prevent"])},[t("div",t$,[T[9]||(T[9]=t("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":l.value.name}]),id:"sessionName","onUpdate:modelValue":T[0]||(T[0]=N=>a.value.name=N),placeholder:"main",required:""},null,2),[[ue,a.value.name]]),l.value.name?(u(),m("div",s$,$(l.value.name),1)):D("",!0)]),t("div",n$,[T[11]||(T[11]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),se(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":T[1]||(T[1]=N=>a.value.permission_mode=N)},[...T[10]||(T[10]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"⚠️ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Oe,a.value.permission_mode]]),T[12]||(T[12]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",o$,[T[14]||(T[14]=t("label",{for:"model",class:"form-label"},"Model",-1)),se(t("select",{class:"form-select",id:"model","onUpdate:modelValue":T[2]||(T[2]=N=>a.value.model=N)},[...T[13]||(T[13]=[t("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),t("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),t("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[Oe,a.value.model]])]),t("div",i$,[T[15]||(T[15]=t("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),se(t("textarea",{class:Y(["form-control",{"is-invalid":h.value}]),id:"systemPrompt","onUpdate:modelValue":T[3]||(T[3]=N=>a.value.system_prompt=N),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[ue,a.value.system_prompt]]),t("div",a$,[t("span",null,$(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),t("span",{class:Y({"text-danger":h.value,"text-warning":p.value})},$(y.value)+" / 6000 chars ",3)]),h.value?(u(),m("div",l$," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):D("",!0)]),t("div",r$,[se(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":T[4]||(T[4]=N=>a.value.override_system_prompt=N)},null,512),[[At,a.value.override_system_prompt]]),T[17]||(T[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),m("div",c$,[...T[16]||(T[16]=[t("small",null,"⚠️ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):D("",!0)]),t("div",d$,[T[18]||(T[18]=t("label",{for:"tools",class:"form-label"},"Allowed Tools (Optional)",-1)),se(t("input",{type:"text",class:"form-control",id:"tools","onUpdate:modelValue":T[5]||(T[5]=N=>a.value.tools=N),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[ue,a.value.tools]]),T[19]||(T[19]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",u$,[se(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":T[6]||(T[6]=N=>a.value.startImmediately=N)},null,512),[[At,a.value.startImmediately]]),T[20]||(T[20]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),c.value?(u(),m("div",m$,$(c.value),1)):D("",!0)],32)]),t("div",p$,[T[21]||(T[21]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:r.value},[r.value?(u(),m("span",v$)):D("",!0),K(" "+$(r.value?"Creating...":"Create Session"),1)],8,f$)])])])],512))}},_$=G(h$,[["__scopeId","data-v-5aef47e0"]]),g$={class:"modal-dialog"},b$={class:"modal-content"},y$={class:"modal-body"},$$={class:"mb-3"},w$={key:0,class:"invalid-feedback"},E$={class:"mb-3"},C$=["value"],S$={class:"mb-3"},k$={class:"form-control-plaintext"},T$={class:"mb-3"},x$=["disabled"],A$={key:0,value:"bypassPermissions"},M$={class:"form-text"},O$={key:0,class:"text-warning"},N$={key:1},L$={key:0,class:"mb-3"},D$={class:"card"},I$={class:"card-body"},P$={key:0,class:"mb-2"},j$={key:1,class:"mb-2"},R$={key:2,class:"mt-2"},V$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},H$={key:1,class:"alert alert-danger",role:"alert"},W$={class:"modal-footer"},F$=["disabled"],U$={key:0,class:"spinner-border spinner-border-sm me-2"},B$={__name:"SessionEditModal",setup(n){const e=ne(),s=me(),o=O(null),i=O({name:"",permission_mode:"default"}),a=O({name:""}),l=O(!1),r=O(""),c=O(null);let f=null;const d=_(()=>o.value?.state==="active"||o.value?.state==="starting"),y=_(()=>o.value?.initial_permission_mode==="bypassPermissions");function h(A){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[A]||"bg-secondary"}function p(){a.value={};let A=!0;return i.value.name.trim()||(a.value.name="Session name is required",A=!1),A}async function w(){if(!(!p()||!o.value)){l.value=!0,r.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),f&&f.hide()}catch(A){console.error("Failed to update session:",A),r.value=A.message||"Failed to update session. Please try again."}finally{l.value=!1}}}function b(){i.value={name:"",permission_mode:"default"},a.value={},r.value=""}function g(){const A=document.getElementById("editSessionName");A&&(A.focus(),A.select())}function v(){b(),o.value=null,s.hideModal()}return re(()=>s.currentModal,A=>{if(A?.name==="edit-session"&&f){const C=A.data||{};o.value=C.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),f.show()}}),pe(()=>{c.value&&be(async()=>{const{default:A}=await import("./modal-B4rHLo2F.js").then(C=>C.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{f=new A(c.value),c.value.addEventListener("shown.bs.modal",g),c.value.addEventListener("hidden.bs.modal",v)})}),_e(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",g),c.value.removeEventListener("hidden.bs.modal",v)),f&&f.dispose()}),(A,C)=>(u(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",g$,[t("div",b$,[C[15]||(C[15]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",y$,[t("form",{onSubmit:ge(w,["prevent"])},[t("div",$$,[C[2]||(C[2]=t("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),se(t("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":C[0]||(C[0]=T=>i.value.name=T),placeholder:"Session Name",required:""},null,2),[[ue,i.value.name]]),a.value.name?(u(),m("div",w$,$(a.value.name),1)):D("",!0)]),t("div",E$,[C[3]||(C[3]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,C$),C[4]||(C[4]=t("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),t("div",S$,[C[5]||(C[5]=t("label",{class:"form-label"},"Current State",-1)),t("div",k$,[t("span",{class:Y(["badge",h(o.value?.state)])},$(o.value?.state),3)])]),t("div",T$,[C[9]||(C[9]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),se(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":C[1]||(C[1]=T=>i.value.permission_mode=T),disabled:!d.value},[C[6]||(C[6]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),C[7]||(C[7]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),C[8]||(C[8]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),y.value?(u(),m("option",A$,"⚠️ Bypass Permissions (No prompts)")):D("",!0)],8,x$),[[Oe,i.value.permission_mode]]),t("div",M$,[d.value?(u(),m("span",N$," Controls which tool actions require permission prompts ")):(u(),m("span",O$," ⚠️ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),m("div",L$,[C[13]||(C[13]=t("label",{class:"form-label"},"System Prompt Configuration",-1)),t("div",D$,[t("div",I$,[o.value?.override_system_prompt?(u(),m("div",P$,[...C[10]||(C[10]=[t("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),t("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),m("div",j$,[...C[11]||(C[11]=[t("span",{class:"badge bg-info"},"Append Mode",-1),t("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),m("div",R$,[C[12]||(C[12]=t("strong",{class:"small"},"Custom Instructions:",-1)),t("div",V$,$(o.value.system_prompt),1)])):D("",!0)])])])):D("",!0),r.value?(u(),m("div",H$,$(r.value),1)):D("",!0)],32)]),t("div",W$,[C[14]||(C[14]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:l.value},[l.value?(u(),m("span",U$)):D("",!0),K(" "+$(l.value?"Saving...":"Save Changes"),1)],8,F$)])])])],512))}},q$=G(B$,[["__scopeId","data-v-c99ca17f"]]),z$={class:"modal-dialog modal-dialog-centered"},K$={class:"modal-content"},Y$={class:"modal-header"},G$={class:"modal-title",id:"manageSessionModalLabel"},J$={class:"modal-body"},X$={key:0,class:"text-center py-4"},Q$={class:"text-muted"},Z$={key:1},ew={key:2},tw={class:"text-muted"},sw={key:3},nw={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},ow={class:"d-grid gap-2"},iw=["disabled"],aw=["disabled"],lw=["disabled"],rw=["disabled"],cw={class:"modal-footer"},dw={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},uw={__name:"SessionManageModal",setup(n){const e=Ye(),s=ne(),o=me(),i=We();Ie();const a=O(null),l=O(!1),r=O(""),c=O(""),f=O(null),d=O(null);let y=null;const h=_(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function p(){f.value="reset"}function w(){f.value="delete"}function b(){f.value=null}async function g(){f.value==="reset"?await C():f.value==="delete"&&await T()}async function v(){if(a.value){l.value=!0,r.value="Restarting session...";try{const E=a.value.session_id,k=await te.post(`/api/sessions/${E}/restart`);if(k.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(E),y&&y.hide();else{const j=k.error||k.detail||"Failed to restart session";console.error("Failed to restart session:",j),c.value=`Failed to restart session: ${j}`}}catch(E){console.error("Error restarting session:",E);const k=E.data?.detail||E.message||"Unknown error";c.value=`Error restarting session: ${k}`}finally{l.value=!1}}}async function A(){if(a.value)try{y&&y.hide(),console.log("Ending session",a.value.session_id);const E=a.value.session_id;await te.post(`/api/sessions/${E}/terminate`),await i.disconnectSession(),s.currentSessionId===E&&(s.currentSessionId=null),e.push("/")}catch(E){console.error("Error ending session:",E),await i.disconnectSession(),s.currentSessionId===a.value?.session_id&&(s.currentSessionId=null),e.push("/")}}async function C(){if(a.value){l.value=!0,r.value="Resetting session...";try{const E=a.value.session_id,k=await te.post(`/api/sessions/${E}/reset`);if(k.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(E),y&&y.hide();else{const j=k.error||k.detail||"Failed to reset session";console.error("Failed to reset session:",j),c.value=`Failed to reset session: ${j}`,f.value=null}}catch(E){console.error("Error resetting session:",E);const k=E.data?.detail||E.message||"Unknown error";c.value=`Error resetting session: ${k}`,f.value=null}finally{l.value=!1}}}async function T(){if(a.value){l.value=!0,r.value="Deleting session...";try{const E=a.value.session_id;await s.deleteSession(E),e.currentRoute.value.params.sessionId===E&&e.push("/"),y&&y.hide()}catch(E){console.error("Error deleting session:",E);const k=E.data?.detail||E.message||"Unknown error";c.value=`Error deleting session: ${k}`,f.value=null}finally{l.value=!1}}}function N(){f.value=null,l.value=!1,r.value="",c.value=""}function I(){N(),a.value=null,o.hideModal()}return re(()=>o.currentModal,E=>{if(E?.name==="manage-session"&&y){const k=E.data||{};a.value=k.session,N(),y.show()}}),pe(()=>{d.value&&be(async()=>{const{default:E}=await import("./modal-B4rHLo2F.js").then(k=>k.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{y=new E(d.value),d.value.addEventListener("hidden.bs.modal",I)})}),_e(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",I),y&&y.dispose()}),(E,k)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",z$,[t("div",K$,[t("div",Y$,[t("h5",G$,$(f.value?h.value:"Manage Session"),1),k[1]||(k[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",J$,[l.value?(u(),m("div",X$,[k[2]||(k[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Q$,$(r.value),1)])):f.value==="reset"?(u(),m("div",Z$,[...k[3]||(k[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"⚠️ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(u(),m("div",ew,[k[6]||(k[6]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"⚠️ Warning: This action cannot be undone")],-1)),t("p",tw,[k[4]||(k[4]=K("This will permanently delete session ",-1)),t("strong",null,$(a.value?.name),1),k[5]||(k[5]=K(".",-1))]),k[7]||(k[7]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(u(),m("div",sw,[c.value?(u(),m("div",nw,[k[8]||(k[8]=t("strong",null,"Error:",-1)),K(" "+$(c.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:k[0]||(k[0]=j=>c.value="")})])):D("",!0),k[15]||(k[15]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",ow,[t("button",{class:"btn btn-outline-primary text-start",onClick:v,disabled:l.value},[...k[9]||(k[9]=[t("strong",null,"🔄 Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,iw),t("button",{class:"btn btn-outline-secondary text-start",onClick:A,disabled:l.value},[...k[10]||(k[10]=[t("strong",null,"🚪 End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,aw),k[13]||(k[13]=t("hr",{class:"my-2"},null,-1)),k[14]||(k[14]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"⚠️ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:p,disabled:l.value},[...k[11]||(k[11]=[t("strong",null,"🗑️ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,lw),t("button",{class:"btn btn-outline-danger text-start",onClick:w,disabled:l.value},[...k[12]||(k[12]=[t("strong",null,"❌ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,rw)]),k[16]||(k[16]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),K(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",cw,[f.value&&!l.value?(u(),m(ie,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:b},"Cancel"),t("button",{type:"button",class:Y(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:g},$(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?D("",!0):(u(),m("button",dw,"Cancel"))])])])],512))}},mw=G(uw,[["__scopeId","data-v-de7ff18c"]]),pw={class:"modal-dialog modal-dialog-centered modal-lg"},fw={class:"modal-content"},vw={class:"modal-body"},hw={key:0,class:"text-center text-muted py-4"},_w={key:1},gw={class:"mb-3"},bw={class:"font-monospace small"},yw={class:"mb-3"},$w={class:"font-monospace small"},ww={class:"mb-3"},Ew={class:"mb-3"},Cw={class:"mb-3"},Sw={key:0},kw={class:"d-flex flex-wrap gap-1"},Tw={key:1,class:"text-muted small"},xw={key:0,class:"mb-3"},Aw={class:"d-flex flex-wrap gap-1"},Mw={key:1,class:"mb-3"},Ow={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},Nw={class:"mb-3"},Lw={class:"text-muted"},Dw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},Iw={__name:"SessionInfoModal",setup(n){const e=ne(),s=Ie(),o=me(),i=O(null),a=O(!1),l=O(null);let r=null;const c=_(()=>{if(!i.value)return null;const h=e.initData.get(i.value);return h||(s.messagesBySession.get(i.value)||[]).find(b=>b.type==="system"&&(b.subtype==="init"||b.metadata?.subtype==="init")&&b.metadata?.init_data)?.metadata?.init_data||null});function f(h){return typeof h=="string"?h:typeof h=="object"&&h.type==="preset"?`Preset: ${h.preset}`:JSON.stringify(h,null,2)}function d(){i.value=null,a.value=!1}function y(){d(),o.hideModal()}return re(()=>o.currentModal,h=>{if(h?.name==="session-info"&&r){const p=h.data||{};i.value=p.sessionId,a.value=!1,r.show()}}),pe(()=>{l.value&&be(async()=>{const{default:h}=await import("./modal-B4rHLo2F.js").then(p=>p.m);return{default:h}},__vite__mapDeps([0,1])).then(({default:h})=>{r=new h(l.value),l.value.addEventListener("hidden.bs.modal",y)})}),_e(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",y),r&&r.dispose()}),(h,p)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[t("div",pw,[t("div",fw,[p[9]||(p[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",vw,[c.value?(u(),m("div",_w,[t("div",gw,[p[1]||(p[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",bw,$(i.value),1)]),t("div",yw,[p[2]||(p[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("div",$w,$(c.value.cwd||"Not specified"),1)]),t("div",ww,[p[3]||(p[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,$(c.value.model||"Default"),1)]),t("div",Ew,[p[4]||(p[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,$(c.value.permissionMode||"default"),1)]),t("div",Cw,[p[5]||(p[5]=t("h6",{class:"text-muted"},"Available Tools",-1)),c.value.tools&&c.value.tools.length>0?(u(),m("div",Sw,[t("div",kw,[(u(!0),m(ie,null,ce(c.value.tools,w=>(u(),m("span",{key:w,class:"badge bg-secondary"},$(w),1))),128))])])):(u(),m("div",Tw,"All tools available"))]),c.value.commands&&c.value.commands.length>0?(u(),m("div",xw,[p[6]||(p[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",Aw,[(u(!0),m(ie,null,ce(c.value.commands,w=>(u(),m("span",{key:w,class:"badge bg-info"},$(w),1))),128))])])):D("",!0),c.value.systemPrompt?(u(),m("div",Mw,[p[7]||(p[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",Ow,$(f(c.value.systemPrompt)),1)])):D("",!0),t("div",Nw,[t("h6",Lw,[p[8]||(p[8]=K(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:p[0]||(p[0]=w=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(u(),m("pre",Dw,$(JSON.stringify(c.value,null,2)),1)):D("",!0)])])):(u(),m("div",hw," No session configuration data available "))]),p[10]||(p[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},Pw=G(Iw,[["__scopeId","data-v-809e2099"]]),jw={class:"modal-dialog modal-dialog-centered"},Rw={class:"modal-content"},Vw={class:"modal-body"},Hw={class:"mb-3"},Ww=["value"],Fw={key:0,class:"form-text"},Uw={class:"mb-3"},Bw={class:"mb-3"},qw={for:"minion-role",class:"form-label"},zw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Kw={key:1,class:"field-indicator modified",title:"Modified from template"},Yw=["placeholder","title"],Gw={class:"mb-3"},Jw={for:"minion-context",class:"form-label"},Xw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Qw={key:1,class:"field-indicator modified",title:"Modified from template"},Zw=["title"],eE={class:"form-text d-flex justify-content-between"},tE={key:0,class:"invalid-feedback"},sE={class:"mb-3 form-check"},nE={key:0,class:"form-text text-warning"},oE={class:"mb-3"},iE={class:"mb-3"},aE={for:"permission-mode",class:"form-label"},lE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},rE={key:1,class:"field-indicator modified",title:"Modified from template"},cE=["title"],dE={class:"mb-3"},uE={for:"allowed-tools",class:"form-label"},mE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},pE={key:1,class:"field-indicator modified",title:"Modified from template"},fE=["title"],vE={key:0,class:"alert alert-danger"},hE={class:"modal-footer"},_E=["disabled"],gE={key:0,class:"spinner-border spinner-border-sm me-2"},bE={__name:"CreateMinionModal",setup(n){const e=Ye(),s=ve(),o=ne(),i=me(),a=O(null);let l=null;const r=O(null),c=O([]),f=O(null),d=O(new Set),y=O({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=O({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),p=O({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:""}),w=O(""),b=O(""),g=O(!1),v=_(()=>w.value.trim()?w.value.split(",").map(B=>B.trim()).filter(B=>B.length>0):[]),A=_(()=>p.value.allowed_tools.trim()?p.value.allowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0):null),C=_(()=>p.value.initialization_context.length),T=_(()=>C.value>2e3),N=_(()=>C.value>1800&&C.value<=2e3),I=_(()=>f.value?c.value.find(B=>B.template_id===f.value):null),E=_(()=>I.value?.default_role||"e.g., Code Expert, Testing Specialist"),k=_(()=>({"field-autofilled":h.value.role==="autofilled","field-modified":h.value.role==="modified"})),j=_(()=>({"field-autofilled":h.value.initialization_context==="autofilled","field-modified":h.value.initialization_context==="modified"})),M=_(()=>({"field-autofilled":h.value.permission_mode==="autofilled","field-modified":h.value.permission_mode==="modified"})),x=_(()=>({"field-autofilled":h.value.allowed_tools==="autofilled","field-modified":h.value.allowed_tools==="modified"})),S=B=>{const H=h.value[B];return H==="autofilled"?`Auto-filled from template: ${I.value?.name}`:H==="modified"?"Modified from template value":""};async function L(){try{console.log("[CreateMinionModal] Loading templates...");const B=await te.get("/api/templates");console.log("[CreateMinionModal] Templates data:",B),c.value=B||[],console.log("[CreateMinionModal] Templates set to:",c.value)}catch(B){console.error("[CreateMinionModal] Failed to load templates:",B),c.value=[]}}function P(){if(d.value.clear(),!I.value){p.value.role="",p.value.initialization_context="",p.value.permission_mode="default",p.value.allowed_tools="",h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},y.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const B=I.value;if(h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},B.default_role?(p.value.role=B.default_role,d.value.add("role"),y.value.role=B.default_role,h.value.role="autofilled"):(p.value.role="",y.value.role=null,h.value.role="normal"),B.default_system_prompt?(p.value.initialization_context=B.default_system_prompt,d.value.add("initialization_context"),y.value.initialization_context=B.default_system_prompt,h.value.initialization_context="autofilled"):(p.value.initialization_context="",y.value.initialization_context=null,h.value.initialization_context="normal"),B.permission_mode?(p.value.permission_mode=B.permission_mode,d.value.add("permission_mode"),y.value.permission_mode=B.permission_mode,h.value.permission_mode="autofilled"):(p.value.permission_mode="default",y.value.permission_mode=null,h.value.permission_mode="normal"),B.allowed_tools&&B.allowed_tools.length>0){const H=B.allowed_tools.join(", ");p.value.allowed_tools=H,d.value.add("allowed_tools"),y.value.allowed_tools=H,h.value.allowed_tools="autofilled"}else p.value.allowed_tools="",y.value.allowed_tools=null,h.value.allowed_tools="normal"}function R(){i.showModal("template-management",{})}function U(){p.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:""},w.value="",f.value=null,d.value.clear(),h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},y.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},b.value="",g.value=!1}function q(){U(),i.hideModal()}async function oe(){if(!p.value.name.trim()){b.value="Minion name is required";return}if(p.value.name.includes(" ")){b.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(T.value){b.value="Initialization context exceeds 2000 character limit";return}if(!r.value){b.value="Legion ID is missing";return}g.value=!0,b.value="";try{const B={name:p.value.name.trim(),role:p.value.role.trim(),initialization_context:p.value.initialization_context.trim(),override_system_prompt:p.value.override_system_prompt,capabilities:v.value,permission_mode:p.value.permission_mode,allowed_tools:A.value},H=await te.post(`/api/legions/${r.value}/minions`,B);H.success&&H.minion_id?(await s.fetchProjects(),await o.fetchSessions(),l&&l.hide(),e.push(`/spy/${r.value}/${H.minion_id}`)):b.value="Failed to create minion"}catch(B){console.error("Failed to create minion:",B),b.value=B.response?.data?.detail||"Failed to create minion"}finally{g.value=!1}}return re(()=>i.currentModal,(B,H)=>{if(B?.name==="create-minion"&&l){const le=B.data||{};r.value=le.project?.project_id||null,U(),L(),l.show()}else H?.name==="template-management"&&l&&a.value?.classList.contains("show")&&L()}),re(()=>p.value.role,B=>{y.value.role!==null&&(B===y.value.role?h.value.role="autofilled":h.value.role="modified")}),re(()=>p.value.initialization_context,B=>{y.value.initialization_context!==null&&(B===y.value.initialization_context?h.value.initialization_context="autofilled":h.value.initialization_context="modified")}),re(()=>p.value.permission_mode,B=>{y.value.permission_mode!==null&&(B===y.value.permission_mode?h.value.permission_mode="autofilled":h.value.permission_mode="modified")}),re(()=>p.value.allowed_tools,B=>{y.value.allowed_tools!==null&&(B===y.value.allowed_tools?h.value.allowed_tools="autofilled":h.value.allowed_tools="modified")}),pe(()=>{a.value&&be(()=>import("./modal-B4rHLo2F.js").then(B=>B.m),__vite__mapDeps([0,1])).then(B=>{const H=B.default;l=new H(a.value),a.value.addEventListener("hidden.bs.modal",q)}),L()}),_e(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",q),l&&l.dispose()}),(B,H)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[t("div",jw,[t("div",Rw,[H[26]||(H[26]=t("div",{class:"modal-header"},[t("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Vw,[t("form",{onSubmit:ge(oe,["prevent"])},[t("div",Hw,[t("label",{for:"template-select",class:"form-label"},[H[9]||(H[9]=K(" Template ",-1)),t("button",{type:"button",onClick:R,class:"btn btn-link btn-sm p-0 ms-2"},[...H[8]||(H[8]=[t("i",{class:"bi-gear"},null,-1),K(" Manage Templates ",-1)])])]),se(t("select",{id:"template-select","onUpdate:modelValue":H[0]||(H[0]=le=>f.value=le),onChange:P,class:"form-select"},[H[10]||(H[10]=t("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(ie,null,ce(c.value,le=>(u(),m("option",{key:le.template_id,value:le.template_id},$(le.name),9,Ww))),128))],544),[[Oe,f.value]]),I.value?(u(),m("div",Fw,$(I.value.description),1)):D("",!0)]),t("div",Uw,[H[11]||(H[11]=t("label",{for:"minion-name",class:"form-label"},[K(" Name "),t("span",{class:"text-danger"},"*")],-1)),se(t("input",{id:"minion-name","onUpdate:modelValue":H[1]||(H[1]=le=>p.value.name=le),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[ue,p.value.name]]),H[12]||(H[12]=t("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),t("div",Bw,[t("label",qw,[H[13]||(H[13]=K(" Role ",-1)),h.value.role==="autofilled"?(u(),m("span",zw," ⚡ ")):D("",!0),h.value.role==="modified"?(u(),m("span",Kw," ✏️ ")):D("",!0)]),se(t("input",{id:"minion-role","onUpdate:modelValue":H[2]||(H[2]=le=>p.value.role=le),type:"text",class:Y(["form-control",k.value]),placeholder:E.value,title:S("role")},null,10,Yw),[[ue,p.value.role]]),H[14]||(H[14]=t("div",{class:"form-text"}," Optional role description for the minion ",-1))]),t("div",Gw,[t("label",Jw,[H[15]||(H[15]=K(" Initialization Context ",-1)),h.value.initialization_context==="autofilled"?(u(),m("span",Xw," ⚡ ")):D("",!0),h.value.initialization_context==="modified"?(u(),m("span",Qw," ✏️ ")):D("",!0)]),se(t("textarea",{id:"minion-context","onUpdate:modelValue":H[3]||(H[3]=le=>p.value.initialization_context=le),class:Y(["form-control",[j.value,{"is-invalid":T.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:S("initialization_context")},null,10,Zw),[[ue,p.value.initialization_context]]),t("div",eE,[t("span",null,$(p.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),t("span",{class:Y({"text-danger":T.value,"text-warning":N.value})},$(C.value)+" / 2000 chars ",3)]),T.value?(u(),m("div",tE," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):D("",!0)]),t("div",sE,[se(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":H[4]||(H[4]=le=>p.value.override_system_prompt=le)},null,512),[[At,p.value.override_system_prompt]]),H[17]||(H[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),p.value.override_system_prompt?(u(),m("div",nE,[...H[16]||(H[16]=[t("small",null,"⚠️ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):D("",!0)]),t("div",oE,[H[18]||(H[18]=t("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),se(t("input",{id:"minion-capabilities","onUpdate:modelValue":H[5]||(H[5]=le=>w.value=le),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[ue,w.value]]),H[19]||(H[19]=t("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),t("div",iE,[t("label",aE,[H[20]||(H[20]=K(" Permission Mode ",-1)),h.value.permission_mode==="autofilled"?(u(),m("span",lE," ⚡ ")):D("",!0),h.value.permission_mode==="modified"?(u(),m("span",rE," ✏️ ")):D("",!0)]),se(t("select",{class:Y(["form-select",M.value]),id:"permission-mode","onUpdate:modelValue":H[6]||(H[6]=le=>p.value.permission_mode=le),title:S("permission_mode")},[...H[21]||(H[21]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"⚠️ Bypass Permissions (No prompts - use with caution)",-1)])],10,cE),[[Oe,p.value.permission_mode]]),H[22]||(H[22]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",dE,[t("label",uE,[H[23]||(H[23]=K(" Allowed Tools (Optional) ",-1)),h.value.allowed_tools==="autofilled"?(u(),m("span",mE," ⚡ ")):D("",!0),h.value.allowed_tools==="modified"?(u(),m("span",pE," ✏️ ")):D("",!0)]),se(t("input",{type:"text",class:Y(["form-control",x.value]),id:"allowed-tools","onUpdate:modelValue":H[7]||(H[7]=le=>p.value.allowed_tools=le),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:S("allowed_tools")},null,10,fE),[[ue,p.value.allowed_tools]]),H[24]||(H[24]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),b.value?(u(),m("div",vE,$(b.value),1)):D("",!0)],32)]),t("div",hE,[H[25]||(H[25]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",disabled:!p.value.name.trim()||g.value,onClick:oe},[g.value?(u(),m("span",gE)):D("",!0),K(" "+$(g.value?"Creating...":"Create Minion"),1)],8,_E)])])])],512))}},yE=G(bE,[["__scopeId","data-v-087cc297"]]),$E={class:"modal-dialog modal-dialog-centered modal-lg"},wE={class:"modal-content"},EE={class:"modal-body"},CE={key:0,class:"text-center text-muted py-4"},SE={key:1},kE={class:"mb-3"},TE={class:"mb-3"},xE={class:"font-monospace small"},AE={class:"mb-3"},ME={class:"mb-3"},OE={class:"mb-3"},NE={key:0},LE={class:"d-flex flex-wrap gap-1"},DE={key:1,class:"text-muted small"},IE={class:"mb-3"},PE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},jE={key:1,class:"text-muted small"},RE={class:"mb-3"},VE={key:0,class:"badge bg-info"},HE={key:1,class:"badge bg-secondary"},WE={class:"mb-3"},FE={key:0,class:"font-monospace small"},UE={key:1,class:"text-muted small"},BE={key:0,class:"mb-3"},qE={key:0},zE={class:"list-unstyled mb-0"},KE={key:1,class:"text-muted small"},YE={class:"mb-3"},GE={key:0,class:"font-monospace small"},JE={key:1,class:"text-muted small"},XE={class:"mb-3"},QE={key:0},ZE={class:"d-flex flex-wrap gap-1"},eC={key:1,class:"text-muted small"},tC={class:"mb-3"},sC={class:"small"},nC={class:"mb-3"},oC={class:"small"},iC={__name:"MinionViewModal",setup(n){const e=me(),s=O(null),o=O(null);let i=null;function a(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function l(f){if(!f)return"N/A";try{const d=new Date(f);return isNaN(d.getTime())?"Invalid date":d.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(d){return console.error("Error formatting timestamp:",d),"Invalid date"}}function r(){s.value=null}function c(){r(),e.hideModal()}return re(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const d=f.data||{};s.value=d.session,i.show()}}),pe(()=>{o.value&&be(async()=>{const{default:f}=await import("./modal-B4rHLo2F.js").then(d=>d.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",c)})}),_e(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",c),i&&i.dispose()}),(f,d)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",$E,[t("div",wE,[d[13]||(d[13]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",EE,[s.value?(u(),m("div",SE,[t("div",kE,[d[0]||(d[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,$(s.value.name||"Unnamed Minion"),1)]),t("div",TE,[d[1]||(d[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",xE,$(s.value.session_id),1)]),t("div",AE,[d[2]||(d[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,$(s.value.role||"Not specified"),1)]),t("div",ME,[d[3]||(d[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:Y(["badge",a(s.value.state)])},$(s.value.state),3)])]),t("div",OE,[d[4]||(d[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(u(),m("div",NE,[t("div",LE,[(u(!0),m(ie,null,ce(s.value.capabilities,y=>(u(),m("span",{key:y,class:"badge bg-secondary"},$(y),1))),128))])])):(u(),m("div",DE,"None"))]),t("div",IE,[d[5]||(d[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(u(),m("div",PE,$(s.value.initialization_context),1)):(u(),m("div",jE,"Not specified"))]),t("div",RE,[d[6]||(d[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(u(),m("span",VE,"Yes")):(u(),m("span",HE,"No"))])]),t("div",WE,[d[7]||(d[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(u(),m("div",FE,$(s.value.parent_overseer_id),1)):(u(),m("div",UE,$(s.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),s.value.is_overseer?(u(),m("div",BE,[d[8]||(d[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(u(),m("div",qE,[t("ul",zE,[(u(!0),m(ie,null,ce(s.value.child_minion_ids,y=>(u(),m("li",{key:y,class:"font-monospace small"},$(y),1))),128))])])):(u(),m("div",KE,"No children"))])):D("",!0),t("div",YE,[d[9]||(d[9]=t("h6",{class:"text-muted"},"Horde Membership",-1)),s.value.horde_id?(u(),m("div",GE,$(s.value.horde_id),1)):(u(),m("div",JE,"Not in a horde"))]),t("div",XE,[d[10]||(d[10]=t("h6",{class:"text-muted"},"Channel Memberships",-1)),s.value.channel_ids&&s.value.channel_ids.length>0?(u(),m("div",QE,[t("div",ZE,[(u(!0),m(ie,null,ce(s.value.channel_ids,y=>(u(),m("span",{key:y,class:"badge bg-info"},$(y),1))),128))])])):(u(),m("div",eC,"No channels"))]),t("div",tC,[d[11]||(d[11]=t("h6",{class:"text-muted"},"Created",-1)),t("div",sC,$(l(s.value.created_at)),1)]),t("div",nC,[d[12]||(d[12]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",oC,$(l(s.value.updated_at)),1)])])):(u(),m("div",CE," No minion data available "))]),d[14]||(d[14]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},aC=G(iC,[["__scopeId","data-v-c44eaee2"]]),lC={class:"modal-dialog modal-lg"},rC={class:"modal-content"},cC={class:"modal-body"},dC={key:0,class:"template-list"},uC={key:0,class:"alert alert-info"},mC={class:"card-body"},pC={class:"d-flex justify-content-between align-items-start"},fC={class:"flex-grow-1"},vC={class:"card-title mb-1"},hC={class:"card-text text-muted small mb-2"},_C={class:"template-meta"},gC={class:"badge bg-secondary me-2"},bC={class:"text-muted small"},yC={class:"btn-group btn-group-sm ms-3"},$C=["onClick"],wC=["onClick"],EC={key:1,class:"template-form"},CC={class:"mb-3"},SC={class:"mb-3"},kC={class:"mb-3"},TC={class:"mb-3"},xC={class:"mb-3"},AC={class:"mb-3"},MC={class:"mb-3"},OC={key:0,class:"alert alert-danger"},NC={class:"d-flex gap-2"},LC=["disabled"],DC={key:0,class:"spinner-border spinner-border-sm me-2"},IC={__name:"TemplateManagementModal",setup(n){const e=me(),s=O(null);let o=null;const i=O([]),a=O(null),l=O(""),r=O(""),c=O(!1);async function f(){try{const g=await te.get("/api/templates");i.value=g||[]}catch(g){console.error("Failed to load templates:",g),i.value=[]}}function d(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},l.value="",r.value=""}function y(g){a.value={...g},l.value=g.allowed_tools?.join(", ")||"",r.value=""}async function h(){if(!a.value.name.trim()){r.value="Template name is required";return}c.value=!0,r.value="";try{const g=l.value.split(",").map(C=>C.trim()).filter(C=>C.length>0),v={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:g.length>0?g:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await te.post("/api/templates",v):await te.put(`/api/templates/${a.value.template_id}`,v),await f(),a.value=null,l.value=""}catch(g){console.error("Failed to save template:",g),r.value=g.response?.data?.detail||"Failed to save template"}finally{c.value=!1}}async function p(g){if(confirm(`Delete template "${g.name}"?

This action cannot be undone.`))try{await te.delete(`/api/templates/${g.template_id}`),await f()}catch(v){console.error("Failed to delete template:",v),alert(`Failed to delete template: ${v.response?.data?.detail||v.message}`)}}function w(){a.value=null,l.value="",r.value=""}function b(){a.value=null,l.value="",r.value="",e.hideModal()}return re(()=>e.currentModal,g=>{g?.name==="template-management"&&o&&(f(),o.show())}),pe(()=>{s.value&&be(()=>import("./modal-B4rHLo2F.js").then(g=>g.m),__vite__mapDeps([0,1])).then(g=>{const v=g.default;o=new v(s.value),s.value.addEventListener("hidden.bs.modal",b)})}),_e(()=>{s.value&&s.value.removeEventListener("hidden.bs.modal",b),o&&o.dispose()}),(g,v)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[t("div",lC,[t("div",rC,[v[15]||(v[15]=t("div",{class:"modal-header"},[t("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",cC,[a.value?D("",!0):(u(),m("div",dC,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[v[6]||(v[6]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:d,class:"btn btn-primary btn-sm"}," ➕ Create New ")]),i.value.length===0?(u(),m("div",uC," No templates found. Create your first template! ")):D("",!0),(u(!0),m(ie,null,ce(i.value,A=>(u(),m("div",{key:A.template_id,class:"card mb-2"},[t("div",mC,[t("div",pC,[t("div",fC,[t("h6",vC,$(A.name),1),t("p",hC,$(A.description),1),t("div",_C,[t("span",gC,$(A.permission_mode),1),t("span",bC,$(A.allowed_tools?.length||0)+" tools",1)])]),t("div",yC,[t("button",{onClick:C=>y(A),class:"btn btn-outline-primary",title:"Edit"}," ✏️ ",8,$C),t("button",{onClick:C=>p(A),class:"btn btn-outline-danger",title:"Delete"}," 🗑️ ",8,wC)])])])]))),128))])),a.value?(u(),m("div",EC,[t("h6",CC,$(a.value.template_id?"Edit Template":"Create Template"),1),t("div",SC,[v[7]||(v[7]=t("label",{for:"template-name",class:"form-label"},[K(" Name "),t("span",{class:"text-danger"},"*")],-1)),se(t("input",{id:"template-name","onUpdate:modelValue":v[0]||(v[0]=A=>a.value.name=A),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[ue,a.value.name]])]),t("div",kC,[v[8]||(v[8]=t("label",{for:"template-description",class:"form-label"},"Description",-1)),se(t("textarea",{id:"template-description","onUpdate:modelValue":v[1]||(v[1]=A=>a.value.description=A),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[ue,a.value.description]])]),t("div",TC,[v[10]||(v[10]=t("label",{for:"template-permission-mode",class:"form-label"},[K(" Permission Mode "),t("span",{class:"text-danger"},"*")],-1)),se(t("select",{id:"template-permission-mode","onUpdate:modelValue":v[2]||(v[2]=A=>a.value.permission_mode=A),class:"form-select",required:""},[...v[9]||(v[9]=[t("option",{value:"default"},"Default",-1),t("option",{value:"acceptEdits"},"Accept Edits",-1),t("option",{value:"plan"},"Plan Mode",-1),t("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Oe,a.value.permission_mode]])]),t("div",xC,[v[11]||(v[11]=t("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),se(t("input",{id:"template-tools","onUpdate:modelValue":v[3]||(v[3]=A=>l.value=A),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[ue,l.value]]),v[12]||(v[12]=t("div",{class:"form-text"},"Comma-separated list of tools",-1))]),t("div",AC,[v[13]||(v[13]=t("label",{for:"template-role",class:"form-label"},"Default Role",-1)),se(t("input",{id:"template-role","onUpdate:modelValue":v[4]||(v[4]=A=>a.value.default_role=A),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[ue,a.value.default_role]])]),t("div",MC,[v[14]||(v[14]=t("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),se(t("textarea",{id:"template-prompt","onUpdate:modelValue":v[5]||(v[5]=A=>a.value.default_system_prompt=A),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[ue,a.value.default_system_prompt]])]),r.value?(u(),m("div",OC,$(r.value),1)):D("",!0),t("div",NC,[t("button",{onClick:h,class:"btn btn-primary",disabled:c.value},[c.value?(u(),m("span",DC)):D("",!0),K(" "+$(c.value?"Saving...":"Save Template"),1)],8,LC),t("button",{onClick:w,class:"btn btn-secondary"},"Cancel")])])):D("",!0)])])])],512))}},PC=G(IC,[["__scopeId","data-v-81126ff4"]]),jC={class:"container-fluid vh-100 d-flex flex-column p-0"},RC={class:"d-flex flex-grow-1 overflow-hidden position-relative"},VC={class:"flex-grow-1 d-flex flex-column overflow-hidden"},HC={__name:"App",setup(n){const e=me(),s=We(),o=ne(),i=ve(),a=Ye(),l=_(()=>e.sidebarCollapsed),r=_(()=>e.isMobile);pe(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const d=window.location.hash;if(d.startsWith("#/session/")){const y=d.replace("#/session/","");o.sessions.has(y)&&await o.selectSession(y)}else if(d.startsWith("#/timeline/")){const y=d.replace("#/timeline/","");a.push(`/timeline/${y}`)}window.addEventListener("popstate",c),window.addEventListener("resize",e.handleResize)}),_e(()=>{window.removeEventListener("popstate",c),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function c(){const d=window.location.hash;if(d.startsWith("#/session/")){const y=d.replace("#/session/","");o.sessions.has(y)&&o.selectSession(y)}}function f(){e.toggleSidebar()}return(d,y)=>{const h=io("router-view");return u(),m("div",jC,[ae(Sf),t("div",{id:"sidebar-backdrop",class:Y({show:!l.value&&r.value}),onClick:f},null,2),t("div",RC,[ae(By),t("main",VC,[ae(h)])]),ae(l1),ae(k1),ae(Y1),ae(_$),ae(q$),ae(mw),ae(Pw),ae(yE),ae(aC),ae(PC)])}}},an=vi(HC);an.use(hi());an.use(hf);an.mount("#app");
