const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as i,d as lt,r as N,b as _,t as b,n as z,u as le,e as Ie,f as ue,w as me,g as Ds,F as ne,h as ce,i as T,j as ja,k as ye,l as Se,v as We,m as Ce,p as So,q as be,s as xo,x as dt,y as Me,z as Co,A as De,B as Cn,C as rn,D as Zt,E as Pa,G as Ra,H as cn,T as Fa,I as Eo,J as To,K as nt,L as hs,M as Ms,N as En,O as Ba,P as Va}from"./vue-vendor-DYUY1mh2.js";import{m as Ke,p as Vt}from"./markdown-vendor-BRsjnVvP.js";import{c as Wa}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();const Ua={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ha={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),r("div",Ua,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},qa="modulepreload",za=function(n){return"/"+n},Tn={},je=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let m=function(p){return Promise.all(p.map(d=>Promise.resolve(d).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");a=m(s.map(p=>{if(p=za(p),p in Tn)return;Tn[p]=!0;const d=p.endsWith(".css"),w=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":qa,d||(h.as="script"),h.crossOrigin="",h.href=p,f&&h.setAttribute("nonce",f),document.head.appendChild(h),d)return new Promise(($,S)=>{h.addEventListener("load",$),h.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return a.then(u=>{for(const f of u||[])f.status==="rejected"&&c(f.reason);return e().catch(c)})};class Os extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Lt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new Os(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Os?s:(console.error("API request failed:",s),new Os(`Network error: ${s.message}`,0,null))}}async function Qt(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[f,m]of Object.entries(e.params))m!=null&&o.append(f,m);const a=o.toString();a&&(s=`${n}?${a}`);const{params:c,...u}=e;return Lt(s,{...u,method:"GET"})}return Lt(s,{...e,method:"GET"})}async function Ao(n,e,s={}){return Lt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ka(n,e,s={}){return Lt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Do(n,e={}){return Lt(n,{...e,method:"DELETE"})}async function Ga(n,e,s={}){return Lt(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Ya(){return Qt("/api/system/git-status")}async function Ja(){return Ao("/api/system/restart")}const ke={get:Qt,post:Ao,put:Ka,delete:Do,patch:Ga},pe=lt("session",()=>{const n=N(new Map),e=N(null),s=N(new Map),o=N(new Map),a=N(new Set),c=N(!1);let u=null;const f=_(()=>n.value.get(e.value)),m=_(()=>Array.from(n.value.values()).sort((A,D)=>A.order-D.order)),p=A=>_(()=>m.value.filter(D=>D.project_id===A)),d=_({get:()=>s.value.get(e.value)||"",set:A=>{e.value&&s.value.set(e.value,A)}});async function w(){try{const A=await ke.get("/api/sessions");return n.value.clear(),A.sessions.forEach(D=>{n.value.set(D.session_id,D)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function h(A,D){try{const M=(await ke.post("/api/sessions",{project_id:A,...D})).session_id,B=(await ke.get(`/api/sessions/${M}`)).session;return n.value.set(M,B),n.value=new Map(n.value),console.log(`Created session ${M}`),B}catch(C){throw console.error("Failed to create session:",C),C}}async function $(A){if(e.value===A&&!c.value)return;u&&(console.log(`Aborting pending selection to switch to ${A}`),u.abort(),u=null);const D=new AbortController;u=D,c.value=!0;try{if(e.value=A,D.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let C=n.value.get(A);if(!C)try{const V=await ke.get(`/api/sessions/${A}`);if(D.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}C=V.session,n.value.set(A,C),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(V){console.error(`Failed to fetch session ${A}:`,V);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await l(A),D.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${C.state} state)`);const V=6e4,U=200,J=5e3;let ae=0,L=0;for(;ae<V;){if(D.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const R=n.value.get(A);if(R&&R.state==="active"){console.log(`Session ${A} is now active after ${ae}ms`);break}if(ae-L>=J){const H=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${H}, ${ae/1e3}s elapsed)`),L=ae}await new Promise(H=>setTimeout(H,U)),ae+=U}const j=n.value.get(A);j&&j.state!=="active"&&console.warn(`Session ${A} did not become active within ${V/1e3}s (state: ${j.state}), continuing anyway`)}catch(V){console.error(`Failed to auto-start session ${A}:`,V)}if(D.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await je(()=>Promise.resolve().then(()=>pi),void 0)).useMessageStore().loadMessages(A),D.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}if(await(await je(()=>Promise.resolve().then(()=>Hi),void 0)).useResourceStore().loadResources(A),D.signal.aborted){console.log(`Selection of ${A} aborted after resource load`);return}await(await je(()=>Promise.resolve().then(()=>qi),void 0)).useWebSocketStore().connectSession(A),D.signal.aborted||console.log(`Selected session ${A}`)}finally{u===D&&(u=null),c.value=!1}}function S(A,D){const C=n.value.get(A);C?Object.assign(C,D):(n.value.set(A,D),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function y(A){a.value.add(A);try{const C=(await ke.delete(`/api/sessions/${A}`)).deleted_session_ids||[A];for(const M of C)n.value.delete(M),s.value.delete(M),o.value.delete(M);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(D){throw console.error("Failed to delete session:",D),D}finally{a.value.delete(A)}}async function g(A,D){try{await ke.patch(`/api/sessions/${A}`,D),S(A,D),console.log(`Updated session ${A}:`,D)}catch(C){throw console.error("Failed to update session:",C),C}}async function v(A,D){try{await ke.post(`/api/sessions/${A}/permission-mode`,{mode:D}),S(A,{current_permission_mode:D});const C=o.value.get(A);C&&(C.permissionMode=D,o.value.set(A,C)),console.log(`Set permission mode for session ${A} to ${D}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function l(A){try{await ke.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(D){throw console.error("Failed to start session:",D),D}}async function k(A){try{await ke.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(D){throw console.error("Failed to pause session:",D),D}}async function x(A){try{await ke.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(D){throw console.error("Failed to terminate session:",D),D}}function E(A){return n.value.get(A)}function O(A,D){o.value.set(A,D),D.permissionMode&&S(A,{current_permission_mode:D.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:f,orderedSessions:m,sessionsInProject:p,currentInput:d,fetchSessions:w,createSession:h,selectSession:$,updateSession:S,deleteSession:y,patchSession:g,setPermissionMode:v,startSession:l,pauseSession:k,terminateSession:x,getSession:E,storeInitData:O}}),An=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:pe},Symbol.toStringTag,{value:"Module"})),xe=lt("ui",()=>{const n=N(window.innerWidth<768),e=N(300),s=N(!0),o=N(300),a=N("diff"),c=N(window.innerWidth>1024),u=N(null),f=N(new Set),m=N(window.innerWidth),p=_(()=>m.value<768),d=N(!0),w=N(!1),h=N(null),$=N(null),S=_(()=>h.value?{name:h.value,data:$.value}:null),y=N(!1),g=N("Loading..."),v=N(!1),l=N("idle");function k(){n.value=!n.value}function x(Q){n.value=Q}function E(Q){e.value=Math.max(200,Math.min(Q,window.innerWidth*.3))}function O(){s.value=!s.value}function A(Q){s.value=Q}function D(Q){o.value=Math.max(200,Math.min(Q,window.innerWidth*.3))}function C(Q){a.value=Q}function M(Q){d.value=Q}function q(){const Q=localStorage.getItem("webui-background-color");w.value=Q==="red"}function B(){w.value=!w.value,localStorage.setItem("webui-background-color",w.value?"red":"gray")}function V(Q,_e=null){h.value=null,$.value=null,setTimeout(()=>{h.value=Q,$.value=_e},0)}function U(){h.value=null,$.value=null}function J(Q="Loading..."){y.value=!0,g.value=Q}function ae(){y.value=!1}function L(){V("restart-server")}function j(Q){u.value=Q}function R(Q){f.value.has(Q)?f.value.delete(Q):f.value.add(Q),f.value=new Set(f.value)}function H(){f.value.size>0&&(f.value=new Set)}function X(){c.value=!c.value}function ee(Q){c.value=Q}function he(){const Q=m.value;m.value=window.innerWidth,m.value<768&&Q>=768?n.value=!0:m.value>=768&&Q<768&&(n.value=!1),m.value>1024?c.value=!0:m.value<=1024&&Q>1024&&(c.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:a,rightPanelVisible:c,browsingProjectId:u,expandedStacks:f,windowWidth:m,isMobile:p,autoScrollEnabled:d,isRedBackground:w,activeModal:h,modalData:$,currentModal:S,isLoading:y,loadingMessage:g,restartInProgress:v,restartStatus:l,toggleSidebar:k,setSidebarCollapsed:x,setSidebarWidth:E,toggleRightSidebar:O,setRightSidebarCollapsed:A,setRightSidebarWidth:D,setRightSidebarTab:C,setBrowsingProject:j,toggleStack:R,collapseAllStacks:H,toggleRightPanel:X,setRightPanelVisible:ee,setAutoScroll:M,initBackgroundColor:q,toggleBackgroundColor:B,showModal:V,hideModal:U,showLoading:J,hideLoading:ae,showRestartModal:L,handleResize:he}}),Ve=lt("project",()=>{const n=N(new Map),e=N(null),s=_(()=>n.value.get(e.value)),o=_(()=>Array.from(n.value.values()).sort((v,l)=>v.order-l.order));async function a(){try{const v=await ke.get("/api/projects");return n.value.clear(),v.projects.forEach(l=>{n.value.set(l.project_id,l)}),console.log(`Loaded ${n.value.size} projects`),v.projects}catch(v){throw console.error("Failed to fetch projects:",v),v}}async function c(v,l){try{const x=(await ke.post("/api/projects",{name:v,working_directory:l})).project;return n.value.set(x.project_id,x),n.value=new Map(n.value),console.log(`Created project ${x.project_id}`),x}catch(k){throw console.error("Failed to create project:",k),k}}async function u(v,l){try{await ke.put(`/api/projects/${v}`,l),f(v,l),console.log(`Updated project ${v}`,l)}catch(k){throw console.error("Failed to update project:",k),k}}function f(v,l){const k=n.value.get(v);k&&(Object.assign(k,l),n.value=new Map(n.value))}async function m(v){try{await ke.delete(`/api/projects/${v}`),n.value.delete(v),n.value=new Map(n.value),e.value===v&&(e.value=null),console.log(`Deleted project ${v}`)}catch(l){throw console.error("Failed to delete project:",l),l}}async function p(v){try{const l=await ke.put(`/api/projects/${v}/toggle-expansion`),k=n.value.get(v);return k&&(k.is_expanded=l.is_expanded,n.value=new Map(n.value)),l.is_expanded}catch(l){throw console.error("Failed to toggle expansion:",l),l}}async function d(v){try{await ke.put("/api/projects/reorder",{project_ids:v}),v.forEach((l,k)=>{const x=n.value.get(l);x&&(x.order=k)}),n.value=new Map(n.value),console.log("Reordered projects",v)}catch(l){throw console.error("Failed to reorder projects:",l),l}}async function w(v,l){try{await ke.put(`/api/projects/${v}/sessions/reorder`,{session_ids:l});const k=n.value.get(v);k&&(k.session_ids=l,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${v}`,l)}catch(k){throw console.error("Failed to reorder sessions:",k),k}}function h(v,l){const k=n.value.get(v);if(!k||!k.session_ids||k.session_ids.length===0)return[{status:"none",flex:1}];const x=new Set,E=new Map;for(const M of k.session_ids){const q=l.getSession(M);if(q&&(E.set(M,q),q.child_minion_ids))for(const B of q.child_minion_ids)x.add(B)}const O=Array.from(E.values()).filter(M=>!x.has(M.session_id)).sort((M,q)=>(M.order||0)-(q.order||0));if(O.length===0&&E.size===0)return[{status:"none",flex:1}];function A(M){return M.state==="active"&&M.is_processing?"active":M.state==="active"?"idle":M.state==="paused"?"waiting":M.state==="error"?"error":"none"}function D(M,q){if(q.push({status:A(M),flex:1}),M.child_minion_ids)for(const B of M.child_minion_ids){const V=E.get(B);V&&D(V,q)}}const C=[];for(const M of O)D(M,C);return C.length>0?C:[{status:"none",flex:1}]}function $(v){return n.value.get(v)}function S(v){e.value=v}function y(){e.value=null}function g(v){if(!v)return"";const l=v.split(/[/\\]/).filter(k=>k);return l.length===0?"/":l.length===1?`/${l[0]}`:l.length===2?`/${l.join("/")}`:`.../${l.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:a,createProject:c,updateProject:u,updateProjectLocal:f,deleteProject:m,toggleExpansion:p,reorderProjects:d,reorderSessionsInProject:w,getProject:$,getStatusBarSegments:h,selectProject:S,clearProjectSelection:y,formatPath:g}}),se=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},Qa={class:"project-name"},Xa=["title"],Za={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=Ve(),a=xe(),c=_(()=>s.sessions.get(e.sessionId)),u=_(()=>c.value?.name||e.sessionId),f=_(()=>{for(const p of o.projects.values())if(p.session_ids?.includes(e.sessionId))return p;return null}),m=_(()=>f.value?.name||"Unknown Project");return(p,d)=>(i(),r("div",{class:z(["session-header border-bottom p-3",{"theme-red-panel":le(a).isRedBackground}])},[t("div",Qa,b(m.value),1),t("div",{class:"session-name",title:n.sessionId},b(u.value),9,Xa)],2))}},ei=se(Za,[["__scopeId","data-v-ba771dd8"]]),ti={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},si=["title"],ni={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},oi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=_(()=>s.sessions.get(e.sessionId)),a=_(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),c=_(()=>{const m=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),u=_(()=>{const m=a.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),f=_(()=>{if(!o.value)return"No session selected";const m=a.value,p=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),d=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${d}${w}: ${p}`});return(m,p)=>(i(),r("div",ti,[o.value?(i(),r("div",{key:0,class:z(["progress-bar",{"progress-bar-striped progress-bar-animated":u.value}]),style:Ie({width:"100%",backgroundColor:c.value}),title:f.value},null,14,si)):(i(),r("div",ni))]))}},ai=se(oi,[["__scopeId","data-v-63d222fe"]]),ii={class:"d-flex justify-content-between align-items-center gap-2"},li={class:"d-flex gap-2"},ri=["disabled"],ci={class:"mode-label"},ui=["disabled"],di=["disabled"],fi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=xe(),a=_(()=>s.sessions.get(e.sessionId)),c=_(()=>a.value?.current_permission_mode||"default"),u={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},f=_(()=>u[c.value]||"ðŸ”’"),m=_(()=>c.value),p=["default","acceptEdits","plan"],d=async()=>{if(!a.value)return;if(c.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(v){console.error("Failed to cycle permission mode:",v)}return}const y=(p.indexOf(c.value)+1)%p.length,g=p[y];try{await s.setPermissionMode(e.sessionId,g)}catch(v){console.error("Failed to cycle permission mode:",v)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:a.value})},$=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(S,y)=>(i(),r("div",{class:z(["session-status-bar border-top p-2",le(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ii,[t("div",li,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!a.value},[ue(b(f.value)+" ",1),t("span",ci,b(m.value),1)],8,ri),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!a.value},[...y[0]||(y[0]=[ue(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,ui),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!a.value},[...y[1]||(y[1]=[ue(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,di)]),t("div",null,[t("button",{class:z(["btn btn-sm",le(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:$}," â¬‡ï¸ "+b(le(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},mi=se(fi,[["__scopeId","data-v-ed9a4d3c"]]),Nt=lt("task",()=>{const n=N(new Map),e=N(new Set);function s(l){const k=n.value.get(l);return k?Array.from(k.values()).filter(x=>x.status!=="deleted").sort((x,E)=>{const O=parseInt(x.id.replace(/\D/g,""))||0,A=parseInt(E.id.replace(/\D/g,""))||0;return O-A}):[]}function o(l){return s(l).find(x=>x.status==="in_progress")||null}function a(l){const k=s(l);return{total:k.length,completed:k.filter(x=>x.status==="completed").length,inProgress:k.filter(x=>x.status==="in_progress").length,pending:k.filter(x=>x.status==="pending").length}}function c(l){return e.value.has(l)}const u=_(()=>{const l=pe();return s(l.currentSessionId)}),f=_(()=>{const l=pe();return o(l.currentSessionId)}),m=_(()=>{const l=pe();return a(l.currentSessionId)}),p=_(()=>{const l=pe();return c(l.currentSessionId)});function d(l,k){n.value.has(l)||n.value.set(l,new Map),n.value.get(l).set(k.id,{id:k.id,subject:k.subject||"",description:k.description||"",status:k.status||"pending",activeForm:k.activeForm||null,owner:k.owner||null,blocks:k.blocks||[],blockedBy:k.blockedBy||[],metadata:k.metadata||{}}),e.value.add(l),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${k.id} for session ${l}`)}function w(l,k,x){const E=n.value.get(l);if(!E){console.warn(`No tasks found for session ${l}`);return}const O=E.get(k);if(!O){if(x.status==="deleted")return;d(l,{id:k,...x});return}x.subject!==void 0&&(O.subject=x.subject),x.description!==void 0&&(O.description=x.description),x.status!==void 0&&(O.status=x.status),x.activeForm!==void 0&&(O.activeForm=x.activeForm),x.owner!==void 0&&(O.owner=x.owner),x.metadata!==void 0&&(O.metadata={...O.metadata,...x.metadata}),x.addBlocks&&(O.blocks=[...new Set([...O.blocks,...x.addBlocks])]),x.addBlockedBy&&(O.blockedBy=[...new Set([...O.blockedBy,...x.addBlockedBy])]),x.status==="deleted"&&(E.delete(k),E.size===0&&(e.value.delete(l),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${k} for session ${l}`,x)}function h(l,k){return n.value.get(l)?.get(k)||null}function $(l){n.value.delete(l),e.value.delete(l),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${l}`)}function S(l,k){n.value.has(l)&&n.value.get(l).clear(),e.value.delete(l);const x=new Map;for(const E of k){if(E.metadata?.tool_uses)for(const O of E.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(O.name)&&x.set(O.id,{name:O.name,input:O.input});if(E.metadata?.tool_results)for(const O of E.metadata.tool_results){const A=x.get(O.tool_use_id);A&&(y(l,A.name,A.input,{error:O.is_error,content:O.content}),x.delete(O.tool_use_id))}}console.log(`Reconstructed ${n.value.get(l)?.size||0} tasks for session ${l}`)}function y(l,k,x,E){if(E?.error){console.log(`Skipping task update - tool ${k} returned error`);return}const O=g(E);if(O)switch(k){case"TaskCreate":{const A=v(O)||x?.id;A&&d(l,{id:A,subject:x?.subject||"",description:x?.description||"",status:"pending",activeForm:x?.activeForm||null,owner:x?.owner||null,blocks:[],blockedBy:[],metadata:x?.metadata||{}});break}case"TaskUpdate":{const A=x?.taskId;A&&w(l,A,{status:x?.status,subject:x?.subject,description:x?.description,activeForm:x?.activeForm,owner:x?.owner,metadata:x?.metadata,addBlocks:x?.addBlocks,addBlockedBy:x?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{x?.taskId;break}}}function g(l){return l?typeof l=="string"?l:l.content?typeof l.content=="string"?l.content:JSON.stringify(l.content):l.message?l.message:JSON.stringify(l):null}function v(l){if(!l)return null;const k=l.match(/[Tt]ask\s*#(\d+)/i);if(k)return k[1];const x=l.match(/#(\d+)/);return x?x[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:u,currentActiveTask:f,currentTaskStats:m,currentHasTasks:p,tasksForSession:s,activeTask:o,taskStats:a,hasTasks:c,getTask:h,createTask:d,updateTask:w,clearTasks:$,reconstructFromMessages:S,handleTaskToolResult:y}}),Pe=lt("message",()=>{const n=N(new Map),e=N(new Map),s=N(new Map),o=N(new Map),a=N(new Map),c=N(new Map),u=N(new Map),f=N(new Map),m=_(()=>{const L=pe();return n.value.get(L.currentSessionId)||[]}),p=_(()=>{const L=pe();return e.value.get(L.currentSessionId)||[]});async function d(L,j=null,R=0){try{const H=j||1e4,X=await ke.get(`/api/sessions/${L}/messages?limit=${H}&offset=${R}`),ee=X.messages||[],he=X.total_count||ee.length,Q=X.has_more||!1;if(console.log(`Loaded ${ee.length} of ${he} messages for session ${L}`),n.value.set(L,ee),ee.length>0){const I=ee[ee.length-1];I.timestamp&&(u.value.set(L,I.timestamp),console.log(`Tracked last received timestamp for session ${L}: ${I.timestamp}`))}const _e=new Set;ee.forEach(I=>{I.type==="assistant"&&I.metadata?.tool_uses&&I.metadata.tool_uses.forEach(W=>{_e.add(W.id)}),I.type==="user"&&I.metadata?.tool_results&&I.metadata.tool_results.forEach(W=>{_e.delete(W.tool_use_id);const Z=c.value.get(L);Z&&Z.delete(W.tool_use_id)}),I.type==="system"&&I.metadata?.subtype==="client_launched"&&(_e.forEach(W=>{C(L,W,"Session was restarted")}),_e.clear()),I.type==="system"&&I.metadata?.subtype==="interrupt"&&(_e.forEach(W=>{C(L,W,"Session was interrupted")}),_e.clear()),I.metadata?.has_tool_uses&&I.metadata.tool_uses&&I.metadata.tool_uses.forEach(W=>{y(L,W,I.timestamp)}),I.metadata?.has_tool_results&&I.metadata.tool_results&&I.metadata.tool_results.forEach(W=>{k(L,W)}),(I.type==="permission_request"||I.metadata?.has_permission_requests)&&g(L,I),I.type==="permission_response"&&v(L,{request_id:I.metadata?.request_id,decision:I.metadata?.decision,updated_input:I.metadata?.updated_input,reasoning:I.metadata?.reasoning,applied_updates:I.metadata?.applied_updates}),I.type==="system"&&(I.subtype==="init"||I.metadata?.subtype==="init")&&I.metadata?.init_data&&pe().storeInitData(L,I.metadata.init_data)});const P=pe().sessions.get(L);P&&!["active","paused","starting"].includes(P.state)&&(_e.forEach(I=>{C(L,I,"Session was terminated")}),_e.clear()),a.value.set(L,_e),n.value=new Map(n.value);try{Nt().reconstructFromMessages(L,ee)}catch(I){console.warn("Failed to reconstruct task state:",I)}return Q&&console.warn(`Warning: Only loaded ${ee.length} of ${he} messages. Some messages may be missing.`),{messages:ee,totalCount:he,hasMore:Q}}catch(H){throw console.error("Failed to load messages:",H),H}}function w(L,j){const R=a.value.get(L)||new Set;j.type==="assistant"&&j.metadata?.tool_uses&&j.metadata.tool_uses.forEach(H=>{R.add(H.id)}),j.type==="user"&&j.metadata?.tool_results&&j.metadata.tool_results.forEach(H=>{R.delete(H.tool_use_id);const X=c.value.get(L);X&&X.delete(H.tool_use_id)}),j.type==="system"&&j.metadata?.subtype==="client_launched"&&(R.forEach(H=>{C(L,H,"Session was restarted")}),R.clear()),j.type==="system"&&j.metadata?.subtype==="interrupt"&&(R.forEach(H=>{C(L,H,"Session was interrupted")}),R.clear()),a.value.set(L,R)}function h(L,j){n.value.has(L)||n.value.set(L,[]);const R=n.value.get(L);if(j.id){const H=R.findIndex(X=>X.id===j.id);if(H!==-1){console.log(`Skipping duplicate message ${j.id} (already exists at index ${H})`);return}}R.push(j),j.timestamp&&u.value.set(L,j.timestamp),O(L,j),w(L,j),n.value=new Map(n.value)}function $(L,j){e.value.has(L)||e.value.set(L,[]),e.value.get(L).push(j),e.value=new Map(e.value)}function S(L,j,R){const H=e.value.get(L);if(H){const X=H.find(ee=>ee.id===j);X&&(Object.assign(X,R),e.value=new Map(e.value))}}function y(L,j,R=null){const H=E(j.name,j.input);s.value.set(H,j.id);const X={id:j.id,name:j.name,input:j.input,signature:H,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:R||new Date().toISOString(),isExpanded:!0};return $(L,X),console.log(`Created tool call ${X.id} for ${X.name}`),X}function g(L,j){console.log("handlePermissionRequest received:",j);const R=j.metadata?.tool_name||j.tool_name,H=j.metadata?.input_params||j.input_params,X=j.metadata?.request_id||j.request_id,ee=j.metadata?.suggestions||j.suggestions||[];console.log("Extracted data:",{toolName:R,inputParams:H,requestId:X,suggestions:ee});const he=E(R,H),Q=s.value.get(he);Q?(o.value.set(X,Q),S(L,Q,{status:"permission_required",permissionRequestId:X,suggestions:ee}),console.log(`Permission required for tool ${Q}`,{suggestions:ee})):console.warn("No tool use ID found for permission request signature:",he,{toolName:R,inputParams:H,availableSignatures:Array.from(s.value.keys())})}function v(L,j){const R=o.value.get(j.request_id);if(R){const H={permissionDecision:j.decision,appliedUpdates:j.applied_updates||[]};j.decision==="allow"?(H.status="executing",H.backendStatus="running"):(H.status="completed",H.backendStatus="denied",H.result={error:!0,message:j.reasoning||"Permission denied"},H.isExpanded=!1),j.updated_input&&(H.input=j.updated_input),S(L,R,H),console.log(`Permission ${j.decision} for tool ${R}`)}}function l(L,j){console.log("handleToolCall received:",j);const R=j.tool_use_id;if(!R){console.warn("Received tool_call without tool_use_id:",j);return}e.value.has(L)||e.value.set(L,[]);const H=e.value.get(L),X=H.findIndex(Q=>Q.id===R),he={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[j.status]||j.status;if(X!==-1){const Q=H[X];Q.status=he,Q.backendStatus=j.status,j.permission&&(Q.suggestions=j.permission.suggestions||[],Q.permissionRequestId=j.request_id),j.permission_granted!==null&&j.permission_granted!==void 0&&(Q.permissionDecision=j.permission_granted?"allow":"deny"),j.result!==void 0&&(Q.result={error:j.status==="failed",content:j.result}),j.error&&(Q.result={error:!0,content:j.error}),j.status==="denied"&&(Q.result={error:!0,message:"Permission denied"},Q.isExpanded=!1),j.status==="interrupted"&&(C(L,R,"Session was interrupted"),Q.isExpanded=!1),(j.status==="completed"||j.status==="failed")&&(Q.isExpanded=!1),j.display&&(Q.backendState=j.display),console.log(`Updated tool call ${R} to status: ${he} (backend: ${j.status})`)}else{const Q=E(j.name,j.input);s.value.set(Q,R);const _e={id:R,name:j.name,input:j.input,signature:Q,status:he,backendStatus:j.status,permissionRequestId:j.request_id,permissionDecision:j.permission_granted!==void 0?j.permission_granted?"allow":"deny":null,suggestions:j.permission?.suggestions||[],result:j.result?{error:j.status==="failed",content:j.result}:null,explanation:null,timestamp:j.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(j.status),backendState:j.display};j.error&&(_e.result={error:!0,content:j.error}),H.push(_e),console.log(`Created new tool call ${R} for ${j.name} with status: ${he}`)}if(e.value=new Map(e.value),["completed","failed"].includes(j.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(j.name))try{Nt().handleTaskToolResult(L,j.name,j.input,{error:j.status==="failed",content:j.result})}catch(Q){console.warn("Failed to update task store:",Q)}}function k(L,j){const R=j.tool_use_id;S(L,R,{status:j.is_error?"error":"completed",result:{error:j.is_error,content:j.content},isExpanded:!1}),console.log(`Tool ${R} ${j.is_error?"failed":"completed"}`);const H=e.value.get(L);if(H){const X=H.find(ee=>ee.id===R);if(X&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(X.name))try{Nt().handleTaskToolResult(L,X.name,X.input,{error:j.is_error,content:j.content})}catch(ee){console.warn("Failed to update task store:",ee)}}}function x(L,j){const R=e.value.get(L);if(R){const H=R.find(X=>X.id===j);H&&(H.isExpanded=!H.isExpanded,e.value=new Map(e.value))}}function E(L,j){if(!L)return"unknown:{}";if(!j||typeof j!="object")return`${L}:{}`;const R=JSON.stringify(j,Object.keys(j).sort());return`${L}:${R}`}function O(L,j){const R=j.metadata?.display||j.display;if(!R)return;f.value.has(L)||f.value.set(L,new Map);const H=f.value.get(L);if(R.tool_states)for(const[X,ee]of Object.entries(R.tool_states)){H.set(X,ee);const he=e.value.get(L);if(he){const Q=he.find(_e=>_e.id===X);if(Q){const _e={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Q.status=_e[ee.state]||ee.state,Q.backendState=ee}}}if(R.orphaned_tools&&R.orphaned_tools.length>0){const X=c.value.get(L)||new Map;for(const ee of R.orphaned_tools)X.has(ee)||X.set(ee,{reason:"denied",message:"Session was interrupted"});c.value.set(L,X)}if(R.linked_permissions)for(const[X,ee]of Object.entries(R.linked_permissions))o.value.set(X,ee);R.tool_states&&Object.keys(R.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${L}:`,{toolStates:Object.keys(R.tool_states||{}).length,orphanedTools:(R.orphaned_tools||[]).length,linkedPermissions:Object.keys(R.linked_permissions||{}).length})}function A(L,j){return f.value.get(L)?.get(j)}function D(L){const j=f.value.get(L);return j&&j.size>0}function C(L,j,R){const H=c.value.get(L)||new Map;H.set(j,{reason:"denied",message:R}),c.value.set(L,H);const X=e.value.get(L);if(X){const ee=X.find(he=>he.id===j);ee&&ee.isExpanded&&(ee.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${j} as orphaned: ${R}`)}function M(L,j){const R=A(L,j);return R&&R.state==="orphaned"?!0:c.value.get(L)?.has(j)||!1}function q(L,j){const R=A(L,j);return R&&R.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:R}:c.value.get(L)?.get(j)}function B(L,j){const R=a.value.get(L);R&&R.size>0&&(R.forEach(H=>C(L,H,j)),R.clear())}function V(L){n.value.delete(L),e.value.delete(L),n.value=new Map(n.value),e.value=new Map(e.value)}function U(L){return u.value.get(L)}async function J(L){const j=u.value.get(L);if(!j)return console.log(`No sync needed for session ${L} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${L} since ${j}`);const R=await ke.get(`/api/sessions/${L}/messages?limit=1000&offset=0`),H=R.messages||[],X=R.has_more||!1,ee=W=>W?typeof W=="number"?W*1e3:new Date(W).getTime():0,he=ee(j),Q=H.filter(W=>W.timestamp?ee(W.timestamp)>he:!1);if(Q.length===0)return console.log(`No missed messages for session ${L}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Q.length} missed messages for session ${L}`);const _e=n.value.get(L)||[],K=new Set(_e.map(W=>W.id).filter(Boolean)),P=Q.filter(W=>!W.id||!K.has(W.id));if(console.log(`After deduplication: ${P.length} unique new messages`),P.length>0){const W=P.sort((Y,re)=>{const ve=ee(Y.timestamp),ge=ee(re.timestamp);return ve-ge}),Z=n.value.get(L)||[],oe=Z.length>0?ee(Z[Z.length-1].timestamp):0,$e=ee(W[0].timestamp),Ye=ee(W[W.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Z.length,lastExisting:oe,lastExistingDate:Z.length>0?Z[Z.length-1].timestamp:"none",firstNew:$e,firstNewDate:W[0].timestamp,lastNew:Ye,lastNewDate:W[W.length-1].timestamp,shouldAppend:$e>oe}),$e>oe){const Y=[...Z,...W];n.value.set(L,Y),console.log(`âœ… Appended ${W.length} new messages (no full sort needed)`)}else{const Y=[...Z,...W].sort((re,ve)=>{const ge=ee(re.timestamp),Ee=ee(ve.timestamp);return ge-Ee});n.value.set(L,Y),console.log(`âš ï¸ Merged and sorted ${W.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${_e.length} messages unchanged`);P.forEach(W=>{w(L,W),W.metadata?.has_tool_uses&&W.metadata.tool_uses&&W.metadata.tool_uses.forEach(Z=>{y(L,Z,W.timestamp)}),W.metadata?.has_tool_results&&W.metadata.tool_results&&W.metadata.tool_results.forEach(Z=>{k(L,Z)}),(W.type==="permission_request"||W.metadata?.has_permission_requests)&&g(L,W),W.type==="permission_response"&&v(L,{request_id:W.metadata?.request_id,decision:W.metadata?.decision,updated_input:W.metadata?.updated_input,reasoning:W.metadata?.reasoning,applied_updates:W.metadata?.applied_updates}),W.type==="system"&&(W.subtype==="init"||W.metadata?.subtype==="init")&&W.metadata?.init_data&&pe().storeInitData(L,W.metadata.init_data)});const I=n.value.get(L);if(I&&I.length>0){const W=I[I.length-1];W.timestamp&&u.value.set(L,W.timestamp)}return n.value=new Map(n.value),{syncedCount:P.length,hasMore:X}}catch(R){return console.error(`Failed to sync messages for session ${L}:`,R),{syncedCount:0,hasMore:!1,error:R.message}}}const ae=pe();return me(()=>Array.from(ae.sessions.values()).map(j=>({id:j.session_id,state:j.state})),(L,j)=>{j&&L.forEach((R,H)=>{const X=j[H];if(!X||X.id!==R.id)return;const ee=["active","paused","starting"].includes(X.state),he=!["active","paused","starting"].includes(R.state);ee&&he&&B(R.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:Ds(a),orphanedToolUses:Ds(c),currentMessages:m,currentToolCalls:p,loadMessages:d,addMessage:h,addToolCall:$,updateToolCall:S,handleToolCall:l,handleToolUse:y,handlePermissionRequest:g,handlePermissionResponse:v,handleToolResult:k,toggleToolExpansion:x,clearMessages:V,markToolUseOrphaned:C,isToolUseOrphaned:M,getOrphanedInfo:q,clearOrphanedToolUses:B,getLastReceivedTimestamp:U,syncMessages:J,getBackendToolState:A,hasBackendDisplayMetadata:D,backendToolStates:Ds(f)}}),pi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Pe},Symbol.toStringTag,{value:"Module"}));function vi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function es(n){return vi(n).toLocaleTimeString()}const hi={class:"msg-wrapper msg-user"},_i={class:"msg-meta"},gi={class:"msg-time"},bi={class:"msg-bubble msg-bubble-user"},yi=["innerHTML"],wi={key:0,class:"tool-results mt-2"},ki={class:"tool-results-header text-muted small mb-2"},$i={class:"d-flex align-items-start gap-2"},Si={class:"flex-grow-1"},xi={class:"text-muted"},Ci={key:0,class:"text-danger small"},Ei={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ke.setOptions({breaks:!0,gfm:!0});const s=_(()=>es(e.message.timestamp)),o=_(()=>{const f=e.message.content||"";let m=Ke.parse(f);return m=m.replace(/\n</g,"<"),m=m.replace(/\n+$/,""),Vt.sanitize(m)}),a=_(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=_(()=>e.message.metadata?.tool_results||[]);function u(f,m){return f?f.length<=m?f:f.substring(0,m)+"...":""}return(f,m)=>(i(),r("div",hi,[t("div",_i,[m[0]||(m[0]=t("span",{class:"msg-role"},"user",-1)),t("span",gi,b(s.value),1)]),t("div",bi,[t("div",{class:"msg-text",innerHTML:o.value},null,8,yi),a.value?(i(),r("div",wi,[t("div",ki," Tool Results ("+b(c.value.length)+") ",1),(i(!0),r(ne,null,ce(c.value,(p,d)=>(i(),r("div",{key:d,class:z(["tool-result-summary",p.is_error?"result-error":"result-success"])},[t("div",$i,[t("span",null,b(p.is_error?"âœ—":"âœ“"),1),t("div",Si,[t("small",xi,"Tool: "+b(p.tool_use_id),1),p.is_error?(i(),r("div",Ci,b(u(p.content,200)),1)):T("",!0)])])],2))),128))])):T("",!0)])]))}},Ti=se(Ei,[["__scopeId","data-v-c5db10e0"]]),Ai={class:"thinking-block"},Di=["aria-label"],Mi={class:"text-muted ms-auto"},Oi={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Ni=["innerHTML"],Li={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=N(!1),o=_(()=>e.thinking?.length||0),a=_(()=>{const u=e.thinking||"",f=Ke.parse(u);return Vt.sanitize(f)});function c(){s.value=!s.value}return(u,f)=>(i(),r("div",Ai,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:c},[t("span",{"aria-label":s.value?"Collapse":"Expand"},b(s.value?"â–¾":"â–¸"),9,Di),f[0]||(f[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Mi,b(o.value)+" characters",1)]),s.value?(i(),r("div",Oi,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,Ni)])):T("",!0)]))}},Ii=se(Li,[["__scopeId","data-v-fda2352c"]]);function Dn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function ji(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Mn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Pi(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=ji(s.command),a=Mn(o,60);return`${e}: ${a}`}case"SlashCommand":return`SlashCommand: ${Mn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=Dn(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",a=s.description||"Task",c=a.length>40?a.substring(0,40)+"...":a;return`Task: (${o}) ${c}`}case"Grep":case"Glob":{const o=s.pattern||"",a=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${a}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const a=s.query||"";return`WebSearch: ${a.length>40?a.substring(0,40)+"...":a}`}let o="";try{const a=s.url||"";a&&(o=new URL(a.startsWith("http")?a:`https://${a}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Dn(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const Ri=["title"],Fi={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){ja(h=>({v0443f0fe:m.value}));const s=n,o=Pe(),a=pe(),c=N(!1),u=_(()=>{const h=a.currentSessionId;return h?s.tool.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[s.tool.backendStatus]||s.tool.backendStatus:o.isToolUseOrphaned(h,s.tool.id)?"orphaned":s.tool.status:s.tool.status}),f=_(()=>s.tool.result?.error||s.tool.status==="error"||s.tool.permissionDecision==="deny"),m=_(()=>{switch(u.value){case"completed":return f.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}),p=_(()=>({"node-expanded":s.isExpanded,"node-running":u.value==="executing","node-permission":u.value==="permission_required"})),d=_(()=>({"dot-running":u.value==="executing","dot-permission":u.value==="permission_required","dot-error":u.value==="error"||u.value==="completed"&&f.value})),w=_(()=>{const h=Pi(s.tool),$={completed:f.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[u.value]||u.value;return`${h} [${$}]`});return e({statusColor:m,effectiveStatus:u}),(h,$)=>(i(),r("div",{class:z(["timeline-node",p.value]),title:w.value,onClick:$[0]||($[0]=ye(S=>h.$emit("click"),["stop"])),onMouseenter:$[1]||($[1]=S=>c.value=!0),onMouseleave:$[2]||($[2]=S=>c.value=!1)},[t("div",{class:z(["node-dot",d.value])},null,2)],42,Ri))}},Bi=se(Fi,[["__scopeId","data-v-a77cf729"]]),Vi={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"}},setup(n){const e=n,s=_(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(o,a)=>(i(),r("div",{class:"timeline-segment",style:Ie(s.value)},null,4))}},Wi=se(Vi,[["__scopeId","data-v-40450ab2"]]),On=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Ns={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Xe=lt("resource",()=>{const n=N(new Map),e=N(!1),s=N(0),o=N(null),a=N(!1),c=N(new Map);function u(Y){if(!Y)return!1;if(Y.is_image===!0||(Y.mime_type||"").toLowerCase().startsWith("image/"))return!0;const ve=(Y.format||"").toLowerCase();if(ve.startsWith("image/")||On.has("."+ve))return!0;const ge=Y.original_filename||Y.original_name||"";if(ge){const Ee="."+ge.split(".").pop().toLowerCase();return On.has(Ee)}return!1}function f(Y){if(!Y||u(Y))return!1;const re=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),ve=Y.original_filename||Y.original_name||"";if(ve){const Ee="."+ve.split(".").pop().toLowerCase();if(re.has(Ee))return!0}const ge=(Y.mime_type||Y.format||"").toLowerCase();return!!(ge.startsWith("text/")||ge==="application/json"||ge==="application/xml")}function m(Y){if(u(Y))return"ðŸ–¼ï¸";if(Y.original_filename){const re="."+Y.original_filename.split(".").pop().toLowerCase();return Ns[re]||Ns.default}return Ns.default}function p(Y){return Y.original_filename?"."+Y.original_filename.split(".").pop().toLowerCase():""}function d(Y){const re=n.value.get(Y);return re||[]}function w(Y){return n.value.get(Y)?.length||0}function h(Y){return w(Y)>0}function $(Y){return d(Y).filter(u)}function S(Y){return $(Y).length}function y(Y){return S(Y)>0}const g=_(()=>{const Y=pe();return d(Y.currentSessionId)}),v=_(()=>{const Y=pe();return w(Y.currentSessionId)}),l=_(()=>v.value>0),k=_(()=>g.value.filter(u)),x=_(()=>k.value.length),E=_(()=>x.value>0),O=_(()=>!e.value||!o.value?null:d(o.value)[s.value]||null),A=O,D=_(()=>o.value?w(o.value):0),C=D;async function M(Y){if(Y){a.value=!0;try{const ve=(await Qt(`/api/sessions/${Y}/resources`)).resources||[];ve.sort((ge,Ee)=>(ge.timestamp||0)-(Ee.timestamp||0)),n.value.set(Y,ve),n.value=new Map(n.value),console.log(`Loaded ${ve.length} resources for session ${Y}`)}catch(re){console.error(`Failed to load resources for session ${Y}:`,re),n.value.set(Y,[]),n.value=new Map(n.value)}finally{a.value=!1}}}const q=M;function B(Y,re){if(!Y||!re)return;let ve=n.value.get(Y);ve||(ve=[],n.value.set(Y,ve));const ge=ve.findIndex(Ee=>Ee.resource_id===re.resource_id);ge>=0?ve[ge]=re:ve.push(re),ve.sort((Ee,st)=>(Ee.timestamp||0)-(st.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${re.resource_id} to session ${Y}`)}const V=B;function U(Y,re){return`/api/sessions/${Y}/resources/${re}`}const J=U;function ae(Y,re){return`/api/sessions/${Y}/resources/${re}/download`}function L(Y,re=0){o.value=Y,s.value=Math.max(0,Math.min(re,w(Y)-1)),e.value=!0}function j(){e.value=!1}function R(){if(!o.value)return;const Y=w(o.value);Y!==0&&(s.value=(s.value+1)%Y)}const H=R;function X(){if(!o.value)return;const Y=w(o.value);Y!==0&&(s.value=(s.value-1+Y)%Y)}const ee=X;function he(Y){if(!o.value)return;const re=w(o.value);re!==0&&(s.value=Math.max(0,Math.min(Y,re-1)))}const Q=he;function _e(Y){n.value.delete(Y),n.value=new Map(n.value),o.value===Y&&j(),console.log(`Cleared resources for session ${Y}`)}const K=_e;async function P(Y,re){if(!(!Y||!re))try{await Do(`/api/sessions/${Y}/resources/${re}`),W(Y,re)}catch(ve){console.error(`Failed to remove resource ${re}:`,ve)}}function I(Y,re){W(Y,re)}function W(Y,re){const ve=n.value.get(Y);if(!ve)return;const ge=ve.findIndex(Ee=>Ee.resource_id===re);ge!==-1&&(ve.splice(ge,1),n.value=new Map(n.value),e.value&&o.value===Y&&(ve.length===0?j():s.value>=ve.length&&(s.value=ve.length-1)),c.value.delete(re),c.value=new Map(c.value))}async function Z(Y,re){if(!Y||!re)return null;const ve=c.value.get(re);if(ve&&!ve.error)return ve.content;c.value.set(re,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const ge=U(Y,re),Ee=await fetch(ge);if(!Ee.ok)throw new Error(`HTTP ${Ee.status}`);const st=await Ee.text();return c.value.set(re,{content:st,loading:!1,error:null}),c.value=new Map(c.value),st}catch(ge){return console.error(`Failed to fetch text content for resource ${re}:`,ge),c.value.set(re,{content:null,loading:!1,error:ge.message}),c.value=new Map(c.value),null}}function oe(Y){return c.value.get(Y)||null}function $e(Y){if(Y){const re=n.value.get(Y);re&&(re.forEach(ve=>c.value.delete(ve.resource_id)),c.value=new Map(c.value))}else c.value=new Map}function Ye(Y,re){const ve=n.value.get(Y);return ve&&ve.find(ge=>ge.resource_id===re)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:a,textContentCache:c,currentResources:g,currentResourceCount:v,currentHasResources:l,currentFullViewResource:O,fullViewTotalResources:D,currentImages:k,currentImageCount:x,currentHasImages:E,currentFullViewImage:A,fullViewTotalImages:C,imagesBySession:n,resourcesForSession:d,resourceCount:w,hasResources:h,getResourceUrl:U,getDownloadUrl:ae,isImageResource:u,isTextResource:f,getResourceIcon:m,getResourceExtension:p,getResourceById:Ye,getTextContent:oe,imagesForSession:$,imageCount:S,hasImages:y,getImageUrl:J,loadResources:M,addResource:B,removeResource:P,handleResourceRemoved:I,openFullView:L,closeFullView:j,nextResource:R,prevResource:X,goToResource:he,clearResources:_e,fetchTextContent:Z,clearTextCache:$e,loadImages:q,addImage:V,nextImage:H,prevImage:ee,goToImage:Q,clearImages:K}}),Ui=Xe,Hi=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ui,useResourceStore:Xe},Symbol.toStringTag,{value:"Module"})),rt=lt("websocket",()=>{const n=N(null),e=N(!1),s=N(0),o=10,a=N(null),c=N(!1),u=N(0),f=5,m=N(null);let p=null;const d=N(0),w=N(null),h=N(new Map),$=N(null),S=N(!1),y=N(0),g=5,v=N(null),l=1e4,k=1e3,x=N(Date.now()),E=N(Date.now()),O=N(Date.now());let A=null,D=null,C=null;const M=_(()=>e.value&&(c.value||!m.value)?"connected":e.value?"partial":"disconnected");function q(P){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${P}`}function B(P){const I={ui:{timer:()=>A,setTimer:W=>{A=W},lastPing:x,connected:e,name:"UI"},session:{timer:()=>D,setTimer:W=>{D=W},lastPing:E,connected:c,name:"Session"},legion:{timer:()=>C,setTimer:W=>{C=W},lastPing:O,connected:S,name:"Legion"}}[P];I.timer()&&clearInterval(I.timer()),I.setTimer(setInterval(()=>{if(!I.connected.value)return;const W=Date.now()-I.lastPing.value;if(W>l){console.warn(`âš ï¸ ${I.name} WebSocket heartbeat timeout (${W}ms since last ping) - forcing close to trigger reconnection`),I.connected.value=!1;const oe={ui:n,session:a,legion:$}[P];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},k)),console.log(`âœ… Started heartbeat monitor for ${I.name} WebSocket`)}function V(P){const I={ui:{get:()=>A,set:W=>{A=W}},session:{get:()=>D,set:W=>{D=W}},legion:{get:()=>C,set:W=>{C=W}}}[P];I.get()&&(clearInterval(I.get()),I.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${P} WebSocket`))}function U(){if(n.value)return;const P=q("/ws/ui");console.log(`Connecting to UI WebSocket: ${P}`),n.value=new WebSocket(P),n.value.onopen=()=>{e.value=!0,s.value=0,x.value=Date.now(),B("ui"),console.log("UI WebSocket connected")},n.value.onmessage=I=>{const W=JSON.parse(I.data);ee(W)},n.value.onclose=()=>{if(V("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const I=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${I}ms (attempt ${s.value})`),setTimeout(U,I)}},n.value.onerror=I=>{console.error("UI WebSocket error:",I)}}function J(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function ae(P){d.value++;const I=d.value;if(console.log(`[Gen ${I}] Starting connection to session ${P}`),p&&(clearTimeout(p),p=null),await L(),d.value!==I){console.log(`[Gen ${I}] Connection cancelled (current generation: ${d.value})`);return}m.value=P,w.value=I;const W=q(`/ws/session/${P}`);console.log(`[Gen ${I}] Connecting to Session WebSocket: ${W}`),a.value=new WebSocket(W),a.value.onopen=async()=>{if(w.value!==I){console.log(`[Gen ${I}] Ignoring onopen (stale connection, current: ${w.value})`),a.value.close();return}c.value=!0,u.value=0,E.value=Date.now(),B("session"),console.log(`[Gen ${I}] Session WebSocket connected for ${P}`);const Z=h.value.get(P);if(h.value.set(P,!0),Z){console.log(`[Gen ${I}] Reconnection detected, syncing missed messages...`);try{const $e=await Pe().syncMessages(P);$e.syncedCount>0?console.log(`[Gen ${I}] âœ… Synced ${$e.syncedCount} missed messages`):$e.error?console.warn(`[Gen ${I}] âš ï¸ Message sync failed: ${$e.error}`):console.log(`[Gen ${I}] No missed messages to sync`),$e.hasMore&&console.warn(`[Gen ${I}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${I}] Error during message sync:`,oe)}}else console.log(`[Gen ${I}] Initial connection, no sync needed`)},a.value.onmessage=Z=>{if(w.value!==I){console.log(`[Gen ${I}] Ignoring message (stale connection, current: ${w.value})`);return}const oe=JSON.parse(Z.data);he(oe,P)},a.value.onclose=()=>{V("session"),c.value=!1,a.value=null,console.log(`[Gen ${I}] Session WebSocket closed for ${P}`);const Z=pe();if(Z.currentSessionId===P&&w.value===I&&u.value<f){u.value++;const oe=Math.min(2e3*u.value,3e4);console.log(`[Gen ${I}] Reconnecting Session WebSocket in ${oe}ms (attempt ${u.value})`),p=setTimeout(()=>{w.value===I&&Z.currentSessionId===P?(p=null,ae(P)):console.log(`[Gen ${I}] Skipping reconnect (generation or session changed)`)},oe)}},a.value.onerror=Z=>{console.error(`[Gen ${I}] Session WebSocket error:`,Z)}}function L(){return new Promise(P=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),a.value){const I=m.value,W=()=>{a.value=null,c.value=!1,m.value=null,w.value=null,u.value=0,I&&h.value.delete(I),P()};if(a.value.readyState===WebSocket.CLOSED)W();else{const Z=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),W()},2e3);a.value.addEventListener("close",()=>{clearTimeout(Z),W()},{once:!0}),a.value.close()}}else m.value=null,w.value=null,P()})}function j(P){a.value&&c.value?(a.value.send(JSON.stringify({type:"send_message",content:P})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function R(P,I,W=!1,Z=null,oe=null){if(a.value&&c.value){const $e={type:"permission_response",request_id:P,decision:I,apply_suggestions:W,timestamp:new Date().toISOString()};Z&&($e.clarification_message=Z),oe&&($e.selected_suggestions=oe),a.value.send(JSON.stringify($e)),console.log(`Sent permission ${I} for request ${P}`,{applySuggestions:W,clarification:Z,selectedSuggestions:oe})}}function H(P,I,W){if(a.value&&c.value){const Z={type:"permission_response",request_id:P,decision:I,updated_input:W,timestamp:new Date().toISOString()};a.value.send(JSON.stringify(Z)),console.log(`Sent permission ${I} with updated_input for request ${P}`,W)}}function X(){a.value&&c.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ee(P){const I=pe(),W=Ve();switch(P.type){case"sessions_list":P.sessions&&Array.isArray(P.sessions)&&P.sessions.forEach(Z=>{I.updateSession(Z.session_id,Z)});break;case"state_change":P.data&&P.data.session_id&&P.data.session&&I.updateSession(P.data.session_id,P.data.session);break;case"project_updated":if(P.data&&P.data.project){const Z=P.data.project;W.updateProjectLocal(Z.project_id,Z),I.fetchSessions()}break;case"project_deleted":P.data&&P.data.project_id&&W.projects.delete(P.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":x.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",P.type)}}function he(P,I){const W=pe();if(W.currentSessionId!==I){console.warn(`Ignoring message for session ${I} (current: ${W.currentSessionId})`);return}const Z=Pe();switch(P.type){case"message":const oe=P.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",P);break}if(oe.type==="tool_call"){Z.handleToolCall(I,oe);break}if(oe.type==="permission_request"){Z.handlePermissionRequest(I,oe);break}if(oe.type==="permission_response"){Z.handlePermissionResponse(I,oe);break}oe.metadata?.has_tool_uses&&oe.metadata.tool_uses.forEach($e=>{Z.handleToolUse(I,$e,oe.timestamp)}),oe.metadata?.has_tool_results&&oe.metadata.tool_results.forEach($e=>{Z.handleToolResult(I,$e)}),oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&W.storeInitData(I,oe.metadata.init_data),Z.addMessage(I,oe);break;case"permission_request":Z.handlePermissionRequest(I,P);break;case"permission_response":Z.handlePermissionResponse(I,P);break;case"tool_result":Z.handleToolResult(I,P);break;case"state_change":W.updateSession(I,P.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${I}`);break;case"ping":E.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":P.resource&&(Xe().addResource(I,P.resource),console.log(`Resource registered for session ${I}:`,P.resource.resource_id));break;case"resource_removed":P.resource_id&&(Xe().handleResourceRemoved(I,P.resource_id),console.log(`Resource removed for session ${I}:`,P.resource_id));break;case"image_registered":P.image&&(Xe().addResource(I,{...P.image,resource_id:P.image.image_id}),console.log(`Image registered (legacy) for session ${I}:`,P.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",P.type)}}function Q(P){_e(),v.value=P;const I=q(`/ws/legion/${P}`);console.log(`Connecting to Legion WebSocket: ${I}`),$.value=new WebSocket(I),$.value.onopen=()=>{S.value=!0,y.value=0,O.value=Date.now(),B("legion"),console.log(`Legion WebSocket connected for ${P}`)},$.value.onmessage=W=>{const Z=JSON.parse(W.data);K(Z,P)},$.value.onclose=()=>{if(V("legion"),S.value=!1,$.value=null,console.log(`Legion WebSocket closed for ${P}`),v.value===P&&y.value<g){y.value++;const W=Math.min(2e3*y.value,3e4);setTimeout(()=>Q(P),W)}},$.value.onerror=W=>{console.error("Legion WebSocket error:",W)}}function _e(){$.value&&($.value.close(),$.value=null,S.value=!1,v.value=null)}function K(P,I){je(async()=>{const{useLegionStore:W}=await Promise.resolve().then(()=>Fp);return{useLegionStore:W}},void 0).then(({useLegionStore:W})=>{const Z=W();switch(P.type){case"comm":P.comm&&(Z.addComm(I,P.comm),console.log("Legion WebSocket: Received new comm",P.comm));break;case"minion_created":P.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",P.data),je(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>An);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":P.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",P.data),je(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>An);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${I}`);break;case"ping":O.value=Date.now(),$.value?.readyState===WebSocket.OPEN&&$.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",P.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:c,sessionRetryCount:u,legionConnected:S,legionRetryCount:y,overallStatus:M,connectUI:U,disconnectUI:J,connectSession:ae,disconnectSession:L,sendMessage:j,sendPermissionResponse:R,sendPermissionResponseWithInput:H,interruptSession:X,connectLegion:Q,disconnectLegion:_e}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:rt},Symbol.toStringTag,{value:"Module"})),zi={class:"base-tool-handler"},Ki={class:"tool-section"},Gi={class:"tool-parameters"},Yi={class:"tool-code"},Ji={key:0,class:"tool-section"},Qi={class:"tool-section-label"},Xi={class:"tool-code"},Zi={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=_(()=>{if(!o.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,f)=>(i(),r("div",zi,[t("div",Ki,[f[0]||(f[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Gi,[t("pre",Yi,b(s.value),1)])]),o.value?(i(),r("div",Ji,[t("div",Qi,b(a.value?"Error:":"Result:"),1),t("div",{class:z(["tool-result",{"tool-result-error":a.value}])},[t("pre",Xi,b(c.value),1)],2)])):T("",!0)]))}},el=se(Zi,[["__scopeId","data-v-1e69f57d"]]),tl={class:"read-tool-handler"},sl={class:"tool-section"},nl={class:"read-file-info"},ol={class:"file-icon"},al={class:"file-path"},il={key:0,class:"read-range"},ll={key:0,class:"tool-section"},rl={key:0,class:"tool-result tool-result-error"},cl={class:"tool-code"},ul={key:1,class:"image-preview"},dl={class:"content-header"},fl={class:"image-badge"},ml={class:"image-container"},pl=["src","alt"],vl={key:2,class:"file-content-preview"},hl={class:"content-header"},_l={class:"line-count-badge"},gl={key:0,class:"preview-note"},bl={class:"tool-code content-display"},yl={key:0,class:"more-indicator"},Ls=100,wl={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>{const v=s.value;return v.split("/").pop()||v}),a=_(()=>{const v=e.toolCall.input?.offset,l=e.toolCall.input?.limit;return v!==void 0||l!==void 0}),c=_(()=>{const v=e.toolCall.input?.offset;return v!==void 0?v+1:1}),u=_(()=>{const v=e.toolCall.input?.offset||0,l=e.toolCall.input?.limit;return l!==void 0?v+l:"âˆž"}),f=_(()=>{const v=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(v)}),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!m.value||p.value)return null;const l=e.toolCall.result?.content;if(Array.isArray(l)){for(const k of l)if(k?.type==="image"&&k?.source?.type==="base64"&&k?.source?.data)return k.source.data}return null}),w=_(()=>{if(!d.value)return"";const v=s.value.toLowerCase();return v.endsWith(".png")?"image/png":v.endsWith(".jpg")||v.endsWith(".jpeg")?"image/jpeg":v.endsWith(".gif")?"image/gif":v.endsWith(".webp")?"image/webp":v.endsWith(".svg")?"image/svg+xml":v.endsWith(".bmp")?"image/bmp":v.endsWith(".ico")?"image/x-icon":"image/png"}),h=_(()=>{if(!m.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),$=_(()=>p.value||!h.value||d.value?[]:h.value.split(`
`)),S=_(()=>$.value.length),y=_(()=>S.value>Ls),g=_(()=>p.value||d.value?"":$.value.slice(0,Ls).join(`
`));return(v,l)=>(i(),r("div",tl,[t("div",sl,[t("div",nl,[t("span",ol,b(f.value?"ðŸ–¼ï¸":"ðŸ“„"),1),l[0]||(l[0]=t("strong",null,"Reading:",-1)),t("code",al,b(s.value),1),a.value?(i(),r("span",il,"Lines "+b(c.value)+"-"+b(u.value),1)):T("",!0)])]),m.value?(i(),r("div",ll,[p.value?(i(),r("div",rl,[t("pre",cl,b(h.value),1)])):d.value?(i(),r("div",ul,[t("div",dl,[l[1]||(l[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",fl,b(w.value),1)]),t("div",ml,[t("img",{src:`data:${w.value};base64,${d.value}`,alt:o.value,class:"preview-image"},null,8,pl)])])):(i(),r("div",vl,[t("div",hl,[l[2]||(l[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",_l,b(S.value)+" lines",1),y.value?(i(),r("span",gl,"(showing first "+b(Ls)+")")):T("",!0)]),t("pre",bl,b(g.value),1),y.value?(i(),r("div",yl,"...")):T("",!0)]))])):T("",!0)]))}},kl=se(wl,[["__scopeId","data-v-29b774b1"]]),$l={class:"write-tool-handler"},Sl={class:"tool-section"},xl={class:"write-file-info mb-2"},Cl={class:"file-path"},El={class:"write-content-preview"},Tl={class:"content-header"},Al={class:"line-count-badge"},Dl={key:0,class:"preview-note"},Ml={class:"tool-code content-display"},Ol={key:0,class:"more-indicator"},Nl={key:0,class:"tool-section"},Ll={key:0,class:"tool-result tool-result-error"},Il={class:"tool-code"},jl={key:1,class:"tool-result tool-result-success"},Pl={class:"success-message"},Is=100,Rl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.content||""),a=_(()=>o.value.split(`
`)),c=_(()=>a.value.length),u=_(()=>c.value>Is),f=_(()=>a.value.slice(0,Is).join(`
`)),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!m.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,h)=>(i(),r("div",$l,[t("div",Sl,[t("div",xl,[h[0]||(h[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",Cl,b(s.value),1)]),t("div",El,[t("div",Tl,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Al,b(c.value)+" lines",1),u.value?(i(),r("span",Dl,"(showing first "+b(Is)+")")):T("",!0)]),t("pre",Ml,b(f.value),1),u.value?(i(),r("div",Ol,"...")):T("",!0)])]),m.value?(i(),r("div",Nl,[p.value?(i(),r("div",Ll,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",Il,b(d.value),1)])):(i(),r("div",jl,[t("div",Pl,[h[4]||(h[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+b(c.value)+" lines written)",1)])]))])):T("",!0)]))}},Fl=se(Rl,[["__scopeId","data-v-ddc24a0f"]]),Bl={class:"bash-tool-handler"},Vl={class:"tool-section"},Wl={class:"bash-header"},Ul={class:"bash-header-content"},Hl={key:0,class:"bash-description"},ql={key:1,class:"bash-flags"},zl={class:"bash-command-section"},Kl={class:"bash-command-content"},Gl={key:0,class:"tool-section"},Yl={key:0,class:"bash-output"},Jl={key:1,class:"bash-output-empty"},Ql={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.command||""),o=_(()=>e.toolCall.input?.description||""),a=_(()=>e.toolCall.input?.timeout),c=_(()=>e.toolCall.input?.run_in_background||!1),u=_(()=>a.value||c.value),f=_(()=>{const h=[];return a.value&&h.push(`timeout: ${a.value}ms`),c.value&&h.push("background"),h.join(", ")}),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>p.value?"tool-result-error":"tool-result-success"),w=_(()=>{if(!m.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,$)=>(i(),r("div",Bl,[t("div",Vl,[t("div",Wl,[$[1]||($[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Ul,[o.value?(i(),r("div",Hl,[$[0]||($[0]=t("strong",null,"Description:",-1)),ue(" "+b(o.value),1)])):T("",!0),u.value?(i(),r("div",ql,b(f.value),1)):T("",!0)])]),t("div",zl,[$[2]||($[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Kl,b(s.value),1)])]),m.value?(i(),r("div",Gl,[t("div",{class:z(["tool-result",d.value])},[$[3]||($[3]=t("strong",null,"Output:",-1)),w.value?(i(),r("pre",Yl,b(w.value),1)):(i(),r("div",Jl,"No output"))],2)])):T("",!0)]))}},Xl=se(Ql,[["__scopeId","data-v-ab50fe73"]]),Zl={class:"todo-tool-handler"},er={class:"tool-section"},tr={class:"todo-header"},sr={class:"todo-summary"},nr={key:0,class:"todo-count todo-count-completed"},or={key:1,class:"todo-count todo-count-in-progress"},ar={key:2,class:"todo-count todo-count-pending"},ir={class:"todo-checklist"},lr={class:"todo-checkbox"},rr={class:"todo-content"},cr={key:0,class:"tool-section"},ur={key:0,class:"tool-result tool-result-error"},dr={class:"tool-code"},fr={key:1,class:"tool-result tool-result-success"},mr={class:"success-message"},pr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.todos||[]),o=_(()=>s.value.filter(d=>d.status==="completed").length),a=_(()=>s.value.filter(d=>d.status==="in_progress").length),c=_(()=>s.value.filter(d=>d.status==="pending").length);function u(d){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[d]||"â˜"}const f=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=_(()=>{if(!f.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,w)=>(i(),r("div",Zl,[t("div",er,[t("div",tr,[w[0]||(w[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=t("strong",null,"Task List:",-1)),t("div",sr,[o.value>0?(i(),r("span",nr,b(o.value)+" completed ",1)):T("",!0),a.value>0?(i(),r("span",or,b(a.value)+" in progress ",1)):T("",!0),c.value>0?(i(),r("span",ar,b(c.value)+" pending ",1)):T("",!0)])]),t("div",ir,[(i(!0),r(ne,null,ce(s.value,(h,$)=>(i(),r("div",{key:$,class:z(["todo-item",`todo-${h.status}`])},[t("span",lr,b(u(h.status)),1),t("span",rr,b(h.content),1)],2))),128))])]),f.value?(i(),r("div",cr,[m.value?(i(),r("div",ur,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",dr,b(p.value),1)])):(i(),r("div",fr,[t("div",mr,[w[3]||(w[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+b(s.value.length)+" tasks)",1)])]))])):T("",!0)]))}},vr=se(pr,[["__scopeId","data-v-bbe55ee7"]]),hr={class:"edit-tool-handler"},_r={class:"tool-section"},gr={class:"edit-file-info"},br={class:"file-path"},yr={key:0,class:"replace-all-badge"},wr={class:"edit-diff-container"},kr={class:"diff-header"},$r={class:"diff-stats"},Sr={class:"stat-removed"},xr={class:"stat-added"},Cr={class:"unified-diff"},Er={class:"diff-scroll-container"},Tr={class:"diff-marker"},Ar={class:"diff-content"},Dr={key:0,class:"tool-section"},Mr={key:0,class:"tool-result tool-result-error"},Or={class:"tool-code"},Nr={key:1,class:"tool-result tool-result-success"},Lr={class:"success-message"},Ir={key:0,class:"success-detail"},jr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.old_string||""),a=_(()=>e.toolCall.input?.new_string||""),c=_(()=>e.toolCall.input?.replace_all||!1),u=_(()=>{const $=Wa(s.value,o.value,a.value,"","",{context:3}).split(`
`),S=[];for(let y=4;y<$.length;y++){const g=$[y];g&&(g.startsWith("-")?S.push({type:"removed",content:g.substring(1)}):g.startsWith("+")?S.push({type:"added",content:g.substring(1)}):g.startsWith(" ")?S.push({type:"context",content:g.substring(1)}):g.startsWith("@@")&&S.push({type:"hunk",content:g}))}return S}),f=_(()=>u.value.filter(h=>h.type==="removed").length),m=_(()=>u.value.filter(h=>h.type==="added").length),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,$)=>(i(),r("div",hr,[t("div",_r,[t("div",gr,[$[0]||($[0]=t("span",{class:"file-icon"},"âœï¸",-1)),$[1]||($[1]=t("strong",null,"Editing:",-1)),t("code",br,b(s.value),1),c.value?(i(),r("span",yr,"Replace All")):T("",!0)]),t("div",wr,[t("div",kr,[$[2]||($[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",$r,[t("span",Sr,"-"+b(f.value),1),t("span",xr,"+"+b(m.value),1)])]),t("div",Cr,[t("div",Er,[(i(!0),r(ne,null,ce(u.value,(S,y)=>(i(),r("div",{key:y,class:z(["diff-line",{"diff-line-removed":S.type==="removed","diff-line-added":S.type==="added","diff-line-context":S.type==="context","diff-line-hunk":S.type==="hunk"}])},[t("span",Tr,b(S.type==="removed"?"-":S.type==="added"?"+":S.type==="hunk"?"@":" "),1),t("span",Ar,b(S.content),1)],2))),128))])])])]),p.value?(i(),r("div",Dr,[d.value?(i(),r("div",Mr,[$[3]||($[3]=t("strong",null,"Error:",-1)),t("pre",Or,b(w.value),1)])):(i(),r("div",Nr,[t("div",Lr,[$[4]||($[4]=t("span",{class:"success-icon"},"âœ…",-1)),$[5]||($[5]=t("strong",null,"File edited successfully",-1)),c.value?(i(),r("span",Ir,"(all occurrences replaced)")):T("",!0)])]))])):T("",!0)]))}},Pr=se(jr,[["__scopeId","data-v-dd74055e"]]),Rr={class:"search-tool-handler"},Fr={class:"tool-section"},Br={class:"search-info"},Vr={class:"search-icon"},Wr={class:"search-pattern"},Ur={key:0,class:"search-path"},Hr={key:1,class:"search-filters"},qr={key:0,class:"filter-badge"},zr={key:1,class:"filter-badge"},Kr={key:2,class:"filter-badge"},Gr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Qr={key:1,class:"search-results"},Xr={class:"results-header"},Zr={class:"results-label"},ec={class:"results-count-badge"},tc={class:"results-content"},sc={class:"tool-code"},nc={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="Grep"),o=_(()=>e.toolCall.input?.pattern||"Unknown"),a=_(()=>e.toolCall.input?.path||null),c=_(()=>e.toolCall.input?.type||null),u=_(()=>e.toolCall.input?.glob||null),f=_(()=>e.toolCall.input?.["-i"]||!1),m=_(()=>c.value||u.value||f.value),p=_(()=>s.value?"ðŸ”":"ðŸ“"),d=_(()=>s.value?"Searching content":"Finding files"),w=_(()=>s.value?"Matches":"Files found"),h=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),S=_(()=>{if(!h.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),y=_(()=>!h.value||$.value||!S.value?0:S.value.split(`
`).filter(v=>v.trim()).length);return(g,v)=>(i(),r("div",Rr,[t("div",Fr,[t("div",Br,[t("span",Vr,b(p.value),1),t("strong",null,b(d.value)+":",1),t("code",Wr,b(o.value),1),a.value?(i(),r("span",Ur,"in "+b(a.value),1)):T("",!0),m.value?(i(),r("span",Hr,[c.value?(i(),r("span",qr,"type: "+b(c.value),1)):T("",!0),u.value?(i(),r("span",zr,"glob: "+b(u.value),1)):T("",!0),f.value?(i(),r("span",Kr,"case-insensitive")):T("",!0)])):T("",!0)])]),h.value?(i(),r("div",Gr,[$.value?(i(),r("div",Yr,[v[0]||(v[0]=t("strong",null,"Error:",-1)),t("pre",Jr,b(S.value),1)])):(i(),r("div",Qr,[t("div",Xr,[t("span",Zr,b(w.value)+":",1),t("span",ec,b(y.value)+" "+b(y.value===1?"match":"matches"),1)]),t("div",tc,[t("pre",sc,b(S.value),1)])]))])):T("",!0)]))}},Nn=se(nc,[["__scopeId","data-v-0d272c39"]]),oc={class:"web-tool-handler"},ac={class:"tool-section"},ic={class:"web-info"},lc={class:"web-icon"},rc=["href"],cc={key:1,class:"web-query"},uc={key:0,class:"web-prompt-container"},dc={class:"prompt-content"},fc={key:1,class:"web-domains"},mc={class:"domains-label"},pc={key:0,class:"tool-section"},vc={key:0,class:"tool-result tool-result-error"},hc={class:"tool-code"},_c={key:1,class:"web-results"},gc={class:"results-header"},bc={class:"results-label"},yc={class:"results-content"},wc={class:"tool-code"},kc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="WebFetch"),o=_(()=>e.toolCall.input?.url||null),a=_(()=>e.toolCall.input?.query||null),c=_(()=>e.toolCall.input?.prompt||null),u=_(()=>e.toolCall.input?.allowed_domains||[]),f=_(()=>e.toolCall.input?.blocked_domains||[]),m=_(()=>u.value.length>0?u.value:f.value.length>0?f.value:[]),p=_(()=>u.value.length>0?"Allowed domains":f.value.length>0?"Blocked domains":"Domains"),d=_(()=>s.value?"ðŸŒ":"ðŸ”Ž"),w=_(()=>s.value?"Fetching URL":"Searching web"),h=_(()=>s.value?"Fetched content":"Search results"),$=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),S=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=_(()=>{if(!$.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,v)=>(i(),r("div",oc,[t("div",ac,[t("div",ic,[t("span",lc,b(d.value),1),t("strong",null,b(w.value)+":",1),o.value?(i(),r("a",{key:0,href:o.value,target:"_blank",class:"web-url"},b(o.value),9,rc)):a.value?(i(),r("code",cc,b(a.value),1)):T("",!0)]),c.value?(i(),r("div",uc,[v[0]||(v[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",dc,b(c.value),1)])):T("",!0),m.value.length>0?(i(),r("div",fc,[t("span",mc,b(p.value)+":",1),(i(!0),r(ne,null,ce(m.value,l=>(i(),r("span",{key:l,class:"domain-badge"},b(l),1))),128))])):T("",!0)]),$.value?(i(),r("div",pc,[S.value?(i(),r("div",vc,[v[1]||(v[1]=t("strong",null,"Error:",-1)),t("pre",hc,b(y.value),1)])):(i(),r("div",_c,[t("div",gc,[t("span",bc,b(h.value)+":",1)]),t("div",yc,[t("pre",wc,b(y.value),1)])]))])):T("",!0)]))}},Ln=se(kc,[["__scopeId","data-v-62b55b55"]]),$c={class:"task-tool-handler"},Sc={class:"tool-section"},xc={class:"task-header"},Cc={key:0,class:"agent-type-badge"},Ec={key:0,class:"task-description"},Tc={class:"description-content"},Ac={key:1,class:"task-prompt-container"},Dc={class:"prompt-header"},Mc={class:"prompt-length"},Oc={class:"prompt-code"},Nc={key:0,class:"tool-section"},Lc={key:0,class:"tool-result tool-result-error"},Ic={class:"tool-code"},jc={key:1,class:"agent-output"},Pc={class:"output-header"},Rc={key:0,class:"output-count-badge"},Fc={class:"output-content"},Bc={class:"tool-code"},Vc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.description||null),o=_(()=>e.toolCall.input?.prompt||null),a=_(()=>e.toolCall.input?.subagent_type||null),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!c.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),m=_(()=>f.value?f.value.split(`
`).length:0);return(p,d)=>(i(),r("div",$c,[t("div",Sc,[t("div",xc,[d[0]||(d[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),d[1]||(d[1]=t("strong",null,"Agent Task:",-1)),a.value?(i(),r("span",Cc,b(a.value),1)):T("",!0)]),s.value?(i(),r("div",Ec,[d[2]||(d[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Tc,b(s.value),1)])):T("",!0),o.value?(i(),r("div",Ac,[t("div",Dc,[d[3]||(d[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Mc,b(o.value.length)+" characters",1)]),t("pre",Oc,b(o.value),1)])):T("",!0)]),c.value?(i(),r("div",Nc,[u.value?(i(),r("div",Lc,[d[4]||(d[4]=t("strong",null,"Error:",-1)),t("pre",Ic,b(f.value),1)])):(i(),r("div",jc,[t("div",Pc,[d[5]||(d[5]=t("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(i(),r("span",Rc,b(m.value)+" lines",1)):T("",!0)]),t("div",Fc,[t("pre",Bc,b(f.value),1)])]))])):T("",!0)]))}},Wc=se(Vc,[["__scopeId","data-v-c520c244"]]),Uc={class:"task-create-tool-handler"},Hc={class:"tool-section"},qc={class:"task-details p-2"},zc={key:0,class:"task-field mb-2"},Kc={class:"field-value subject-value"},Gc={key:1,class:"task-field mb-2"},Yc={class:"field-value description-value"},Jc={key:2,class:"task-field"},Qc={class:"field-value active-form-value"},Xc={key:0,class:"tool-section mt-2"},Zc={key:0,class:"tool-result tool-result-error"},eu={class:"tool-code"},tu={key:1,class:"tool-result tool-result-success"},su={class:"result-text"},nu={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.subject||null),o=_(()=>e.toolCall.input?.description||null),a=_(()=>e.toolCall.input?.activeForm||null),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!c.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,p)=>(i(),r("div",Uc,[t("div",Hc,[p[3]||(p[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",qc,[s.value?(i(),r("div",zc,[p[0]||(p[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Kc,b(s.value),1)])):T("",!0),o.value?(i(),r("div",Gc,[p[1]||(p[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Yc,b(o.value),1)])):T("",!0),a.value?(i(),r("div",Jc,[p[2]||(p[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Qc,b(a.value),1)])):T("",!0)])]),c.value?(i(),r("div",Xc,[u.value?(i(),r("div",Zc,[p[4]||(p[4]=t("strong",null,"Error:",-1)),t("pre",eu,b(f.value),1)])):(i(),r("div",tu,[p[5]||(p[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",su,b(f.value),1)]))])):T("",!0)]))}},ou=se(nu,[["__scopeId","data-v-474dd444"]]),au={class:"task-update-tool-handler"},iu={class:"tool-section"},lu={class:"task-header"},ru={key:0,class:"task-id-badge"},cu={class:"task-details p-2"},uu={key:0,class:"task-field mb-2"},du={key:1,class:"task-field mb-2"},fu={class:"field-value"},mu={key:2,class:"task-field mb-2"},pu={class:"field-value description-value"},vu={key:3,class:"task-field mb-2"},hu={class:"field-value active-form-value"},_u={key:4,class:"task-field mb-2"},gu={class:"field-value"},bu={key:5,class:"task-field mb-2"},yu={class:"field-value"},wu={key:6,class:"task-field"},ku={class:"field-value"},$u={key:0,class:"tool-section mt-2"},Su={key:0,class:"tool-result tool-result-error"},xu={class:"tool-code"},Cu={key:1,class:"tool-result tool-result-success"},Eu={class:"result-text"},Tu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.input?.status||null),a=_(()=>e.toolCall.input?.subject||null),c=_(()=>e.toolCall.input?.description||null),u=_(()=>e.toolCall.input?.activeForm||null),f=_(()=>e.toolCall.input?.owner||null),m=_(()=>e.toolCall.input?.addBlockedBy||[]),p=_(()=>e.toolCall.input?.addBlocks||[]),d=_(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=_(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),h=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),S=_(()=>{if(!h.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,g)=>(i(),r("div",au,[t("div",iu,[t("div",lu,[g[0]||(g[0]=t("span",{class:"task-icon"},"âœï¸",-1)),g[1]||(g[1]=t("strong",null,"Update Task",-1)),s.value?(i(),r("span",ru,"#"+b(s.value),1)):T("",!0)]),t("div",cu,[o.value?(i(),r("div",uu,[g[2]||(g[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:z(["field-value status-value",w.value])},b(d.value)+" "+b(o.value),3)])):T("",!0),a.value?(i(),r("div",du,[g[3]||(g[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",fu,b(a.value),1)])):T("",!0),c.value?(i(),r("div",mu,[g[4]||(g[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",pu,b(c.value),1)])):T("",!0),u.value?(i(),r("div",vu,[g[5]||(g[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",hu,b(u.value),1)])):T("",!0),f.value?(i(),r("div",_u,[g[6]||(g[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",gu,b(f.value),1)])):T("",!0),m.value?.length?(i(),r("div",bu,[g[7]||(g[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",yu,[(i(!0),r(ne,null,ce(m.value,v=>(i(),r("span",{key:v,class:"badge bg-warning text-dark me-1"},"#"+b(v),1))),128))])])):T("",!0),p.value?.length?(i(),r("div",wu,[g[8]||(g[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",ku,[(i(!0),r(ne,null,ce(p.value,v=>(i(),r("span",{key:v,class:"badge bg-info text-dark me-1"},"#"+b(v),1))),128))])])):T("",!0)])]),h.value?(i(),r("div",$u,[$.value?(i(),r("div",Su,[g[9]||(g[9]=t("strong",null,"Error:",-1)),t("pre",xu,b(S.value),1)])):(i(),r("div",Cu,[g[10]||(g[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Eu,b(S.value),1)]))])):T("",!0)]))}},Au=se(Tu,[["__scopeId","data-v-35582330"]]),Du={class:"task-list-tool-handler"},Mu={key:0,class:"tool-section"},Ou={key:0,class:"tool-result tool-result-error"},Nu={class:"tool-code"},Lu={key:1,class:"task-list-result"},Iu={key:0,class:"parsed-tasks"},ju={class:"status-icon"},Pu={class:"task-id text-muted"},Ru={class:"task-subject flex-grow-1"},Fu={key:0,class:"task-owner badge bg-secondary"},Bu={key:1,class:"raw-result p-2"},Vu={class:"tool-code"},Wu={key:1,class:"tool-section"},Uu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=_(()=>{if(!s.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=_(()=>{if(!a.value)return[];const f=[],p=a.value.split(`
`);for(const d of p){const w=d.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const h=w[2].toLowerCase();f.push({id:w[1],status:h,subject:w[3].trim(),owner:null,statusIcon:u(h)})}}return f});function u(f){switch(f){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(f,m)=>(i(),r("div",Du,[m[2]||(m[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(i(),r("div",Mu,[o.value?(i(),r("div",Ou,[m[0]||(m[0]=t("strong",null,"Error:",-1)),t("pre",Nu,b(a.value),1)])):(i(),r("div",Lu,[c.value.length>0?(i(),r("div",Iu,[(i(!0),r(ne,null,ce(c.value,(p,d)=>(i(),r("div",{key:d,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",ju,b(p.statusIcon),1),t("span",Pu,"#"+b(p.id),1),t("span",Ru,b(p.subject),1),p.owner?(i(),r("span",Fu,b(p.owner),1)):T("",!0)]))),128))])):(i(),r("div",Bu,[t("pre",Vu,b(a.value),1)]))]))])):n.toolCall.status==="completed"?(i(),r("div",Wu,[...m[1]||(m[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):T("",!0)]))}},Hu=se(Uu,[["__scopeId","data-v-4e79ba4b"]]),qu={class:"task-get-tool-handler"},zu={class:"tool-section"},Ku={class:"task-header"},Gu={key:0,class:"task-id-badge"},Yu={key:0,class:"tool-section"},Ju={key:0,class:"tool-result tool-result-error"},Qu={class:"tool-code"},Xu={key:1,class:"task-details-result p-2"},Zu={key:0,class:"parsed-task"},ed={class:"task-field mb-2"},td={class:"field-value subject-value"},sd={key:0,class:"task-field mb-2"},nd={key:1,class:"task-field mb-2"},od={class:"field-value description-value"},ad={key:2,class:"task-field mb-2"},id={class:"field-value"},ld={key:3,class:"task-field mb-2"},rd={class:"field-value"},cd={key:4,class:"task-field"},ud={class:"field-value"},dd={key:1,class:"raw-result"},fd={class:"tool-code"},md={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=_(()=>{if(!o.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),u=_(()=>{if(!c.value)return null;const p=c.value;try{const h=JSON.parse(p);if(h&&typeof h=="object")return{subject:h.subject||h.title||"",status:h.status||"",description:h.description||"",owner:h.owner||"",blockedBy:h.blockedBy||[],blocks:h.blocks||[]}}catch{}const d=p.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const h of d){const $=h.match(/^Subject:\s*(.+)$/i);$&&(w.subject=$[1].trim());const S=h.match(/^Status:\s*(.+)$/i);S&&(w.status=S[1].trim());const y=h.match(/^Description:\s*(.+)$/i);y&&(w.description=y[1].trim());const g=h.match(/^Owner:\s*(.+)$/i);g&&(w.owner=g[1].trim())}return w.subject?w:null}),f=_(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=_(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,d)=>(i(),r("div",qu,[t("div",zu,[t("div",Ku,[d[0]||(d[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),d[1]||(d[1]=t("strong",null,"Get Task",-1)),s.value?(i(),r("span",Gu,"#"+b(s.value),1)):T("",!0)])]),o.value?(i(),r("div",Yu,[a.value?(i(),r("div",Ju,[d[2]||(d[2]=t("strong",null,"Error:",-1)),t("pre",Qu,b(c.value),1)])):(i(),r("div",Xu,[u.value?(i(),r("div",Zu,[t("div",ed,[d[3]||(d[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",td,b(u.value.subject),1)]),u.value.status?(i(),r("div",sd,[d[4]||(d[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:z(["field-value",m.value])},b(f.value)+" "+b(u.value.status),3)])):T("",!0),u.value.description?(i(),r("div",nd,[d[5]||(d[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",od,b(u.value.description),1)])):T("",!0),u.value.owner?(i(),r("div",ad,[d[6]||(d[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",id,b(u.value.owner),1)])):T("",!0),u.value.blockedBy?.length?(i(),r("div",ld,[d[7]||(d[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",rd,[(i(!0),r(ne,null,ce(u.value.blockedBy,w=>(i(),r("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+b(w),1))),128))])])):T("",!0),u.value.blocks?.length?(i(),r("div",cd,[d[8]||(d[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",ud,[(i(!0),r(ne,null,ce(u.value.blocks,w=>(i(),r("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+b(w),1))),128))])])):T("",!0)])):(i(),r("div",dd,[t("pre",fd,b(c.value),1)]))]))])):T("",!0)]))}},pd=se(md,[["__scopeId","data-v-a80d14da"]]),vd={class:"notebook-edit-tool-handler"},hd={class:"tool-section"},_d={class:"notebook-info"},gd={class:"file-path"},bd={class:"cell-info mt-2"},yd={class:"info-row"},wd={class:"info-row"},kd={key:0,class:"info-row"},$d={class:"badge bg-info"},Sd={key:0,class:"source-preview mt-3"},xd={class:"preview-header"},Cd={class:"preview-stats"},Ed={class:"source-code"},Td={key:0,class:"tool-section"},Ad={key:0},Dd={key:1,class:"text-danger"},Md={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.notebook_path||"Unknown"),o=_(()=>e.toolCall.input?.cell_id),a=_(()=>e.toolCall.input?.cell_type||"code"),c=_(()=>e.toolCall.input?.edit_mode||"replace"),u=_(()=>e.toolCall.input?.new_source||""),f=_(()=>u.value.split(`
`).length),m=_(()=>a.value==="code"?"bg-primary":"bg-secondary"),p=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=c.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,h)=>(i(),r("div",vd,[t("div",hd,[t("div",_d,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",gd,b(s.value),1)]),t("div",bd,[t("div",yd,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,b(o.value||"N/A"),1)]),t("div",wd,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:z(["badge",m.value])},b(a.value),3)]),c.value?(i(),r("div",kd,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",$d,b(c.value),1)])):T("",!0)]),u.value?(i(),r("div",Sd,[t("div",xd,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",Cd,b(f.value)+" lines",1)]),t("pre",Ed,[t("code",null,b(u.value),1)])])):T("",!0)]),n.toolCall.result?(i(),r("div",Td,[h[6]||(h[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:z(["tool-result",p.value])},[n.toolCall.result.success!==!1?(i(),r("div",Ad," âœ… "+b(d.value),1)):(i(),r("div",Dd," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)])):T("",!0)]))}},Od=se(Md,[["__scopeId","data-v-c81a9bcf"]]),Nd={class:"shell-tool-handler"},Ld={class:"tool-section"},Id={class:"shell-info"},jd={class:"shell-icon"},Pd={key:0,class:"shell-id"},Rd={key:0,class:"filter-info mt-2"},Fd={class:"filter-pattern"},Bd={key:0,class:"tool-section"},Vd={class:"result-header mb-2"},Wd={key:0,class:"mb-2"},Ud={class:"shell-output"},Hd={key:1,class:"mb-2"},qd={class:"shell-output shell-output-error"},zd={key:0},Kd={key:1,class:"text-danger"},Gd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=_(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=_(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),c=_(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),u=_(()=>e.toolCall.input?.filter);function f($,S){if(!$)return null;const y=new RegExp(`<${S}>([\\s\\S]*?)<\\/${S}>`,"i"),g=$.match(y);return g?g[1].trim():null}const m=_(()=>{const $=e.toolCall.result;if(!$)return null;let S=$;if($.content&&(S=$.content),typeof S=="string")return{status:f(S,"status"),stdout:f(S,"stdout"),stderr:f(S,"stderr"),exit_code:f(S,"exit_code")};if(Array.isArray(S)){const y=S.find(g=>g.type==="text")?.text||"";return{status:f(y,"status"),stdout:f(y,"stdout"),stderr:f(y,"stderr"),exit_code:f(y,"exit_code")}}return{status:$.status||S.status,stdout:$.stdout||$.output||S.stdout||S.output,stderr:$.stderr||S.stderr,exit_code:$.exit_code||S.exit_code}}),p=_(()=>m.value?.status),d=_(()=>{const $=p.value;return $==="running"?"bg-success":$==="completed"?"bg-secondary":$==="killed"||$==="terminated"?"bg-danger":"bg-info"}),w=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const $=m.value;if($?.status==="running"&&!$.stdout&&!$.stderr)return"No new output since last check";if($?.status==="failed")return`Shell failed (exit code ${$.exit_code||"unknown"})`}return"Operation completed"});return($,S)=>(i(),r("div",Nd,[t("div",Ld,[t("div",Id,[t("span",jd,b(s.value),1),t("strong",null,b(o.value)+":",1),c.value?(i(),r("code",Pd,"Shell "+b(c.value),1)):T("",!0)]),n.toolCall.name==="BashOutput"&&u.value?(i(),r("div",Rd,[S[0]||(S[0]=t("strong",null,"Filter:",-1)),t("code",Fd,b(u.value),1)])):T("",!0)]),n.toolCall.result?(i(),r("div",Bd,[t("div",Vd,[t("strong",null,b(a.value)+":",1),p.value?(i(),r("span",{key:0,class:z(["badge",d.value])},b(p.value),3)):T("",!0)]),m.value?.stdout?(i(),r("div",Wd,[S[1]||(S[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Ud,[t("pre",null,[t("code",null,b(m.value.stdout),1)])])])):T("",!0),m.value?.stderr?(i(),r("div",Hd,[S[2]||(S[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",qd,[t("pre",null,[t("code",null,b(m.value.stderr),1)])])])):T("",!0),!m.value?.stdout&&!m.value?.stderr?(i(),r("div",{key:2,class:z(["tool-result",w.value])},[n.toolCall.result.success!==!1?(i(),r("div",zd," âœ… "+b(h.value),1)):(i(),r("div",Kd," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)):T("",!0)])):T("",!0)]))}},In=se(Gd,[["__scopeId","data-v-86def281"]]),Yd={class:"skill-tool-handler"},Jd={key:0,class:"tool-section"},Qd={class:"d-flex align-items-center gap-2"},Xd={class:"text-muted small"},Zd={key:0,class:"skill-content-body"},ef={class:"skill-content-text"},tf={key:1,class:"tool-section mt-3"},sf={class:"tool-result tool-result-error"},nf={class:"tool-code"},of={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=pe(),a=N(!1);function c(){a.value=!a.value}const u=_(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const $=s.messagesBySession.get(h)||[],S=$.findIndex(v=>v.type==="user"&&v.metadata?.has_tool_results&&v.metadata?.tool_results?.some(l=>l.tool_use_id===e.toolCall.id));if(S===-1)return{running:null,content:null};let y=null,g=null;for(let v=S+1;v<Math.min(S+3,$.length);v++){const l=$[v];if(l.type!=="user")continue;const k=l.content||"";k.includes("<command-message>")&&k.includes("skill is running")?y=l:k.startsWith("Base directory for this skill:")&&(g=l)}return{running:y,content:g}}),f=_(()=>{const h=u.value.content;if(!h)return"";const $=h.content||"",S=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return $.replace(S,"").trim()}),m=_(()=>f.value.length>0),p=_(()=>f.value?f.value.split(`
`).length:0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!d.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,$)=>(i(),r("div",Yd,[m.value?(i(),r("div",Jd,[t("div",{class:"skill-content-header",onClick:c},[t("div",Qd,[t("i",{class:z(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),$[0]||($[0]=t("strong",null,"Skill Content",-1)),t("span",Xd,"("+b(p.value)+" lines)",1)])]),a.value?(i(),r("div",Zd,[t("pre",ef,b(f.value),1)])):T("",!0)])):T("",!0),d.value?(i(),r("div",tf,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",sf,[t("pre",nf,b(w.value),1)])])):T("",!0)]))}},af=se(of,[["__scopeId","data-v-0a48ca0f"]]),lf={class:"slashcommand-tool-handler"},rf={key:0,class:"tool-section"},cf={class:"d-flex align-items-center gap-2"},uf=["aria-label"],df={class:"text-muted small"},ff={key:0,class:"command-content-body"},mf={class:"command-content-text"},pf={key:1,class:"tool-section mt-3"},vf={class:"tool-result tool-result-error"},hf={class:"tool-code"},_f={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=pe(),a=N(!1);function c(){a.value=!a.value}const u=_(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const $=s.messagesBySession.get(h)||[],S=$.findIndex(v=>v.type==="user"&&v.metadata?.has_tool_results&&v.metadata?.tool_results?.some(l=>l.tool_use_id===e.toolCall.id));if(S===-1)return{running:null,content:null};let y=null,g=null;for(let v=S+1;v<Math.min(S+3,$.length);v++){const l=$[v];if(l.type!=="user")continue;const k=l.content||"";k.includes("<command-message>")&&k.includes("<command-name>")&&k.includes("<command-args>")?y=l:k.includes("ARGUMENTS:")&&(g=l)}return{running:y,content:g}}),f=_(()=>{const h=u.value.content;if(!h)return"";const $=h.content||"",S=/\nARGUMENTS:.*$/s;return $.replace(S,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=_(()=>f.value.length>0),p=_(()=>f.value?f.value.split(`
`).length:0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!d.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,$)=>(i(),r("div",lf,[m.value?(i(),r("div",rf,[t("div",{class:"command-content-header",onClick:c},[t("div",cf,[t("span",{"aria-label":a.value?"Collapse":"Expand"},b(a.value?"â–¾":"â–¸"),9,uf),$[0]||($[0]=t("strong",null,"Command Content",-1)),t("span",df,"("+b(p.value)+" lines)",1)])]),a.value?(i(),r("div",ff,[t("pre",mf,b(f.value),1)])):T("",!0)])):T("",!0),d.value?(i(),r("div",pf,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",vf,[t("pre",hf,b(w.value),1)])])):T("",!0)]))}},gf=se(_f,[["__scopeId","data-v-15991acf"]]),bf={class:"exit-plan-mode-tool-handler"},yf={class:"tool-section"},wf={key:0,class:"plan-content mt-2"},kf={class:"plan-text"},$f={key:0,class:"tool-section"},Sf={key:0},xf={key:1,class:"text-danger"},Cf={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.plan),o=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,c)=>(i(),r("div",bf,[t("div",yf,[c[1]||(c[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(i(),r("div",wf,[c[0]||(c[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",kf,b(s.value),1)])):T("",!0)]),n.toolCall.result?(i(),r("div",$f,[c[2]||(c[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:z(["tool-result",o.value])},[n.toolCall.result.success!==!1?(i(),r("div",Sf," âœ… Permission mode reverted to default ")):(i(),r("div",xf," â— "+b(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):T("",!0)]))}},Ef=se(Cf,[["__scopeId","data-v-e2e3c781"]]),Tf={class:"ask-user-question-handler"},Af={key:0,class:"answers-summary"},Df={class:"answer-question text-muted small"},Mf={class:"answer-value fw-medium"},Of={key:1,class:"text-muted small"},Nf={key:0,class:"questions-container"},Lf={class:"question-header d-flex align-items-center gap-2 mb-2"},If={key:0,class:"badge bg-secondary"},jf={class:"question-text fw-medium"},Pf={class:"options-list"},Rf=["id","checked","disabled","onChange"],Ff=["id","name","checked","disabled","onChange"],Bf=["for"],Vf={class:"option-label"},Wf={key:0,class:"option-description text-muted d-block small"},Uf={class:"option-item form-check other-option"},Hf=["id","checked","disabled","onChange"],qf=["id","name","checked","disabled","onChange"],zf=["for"],Kf={key:2,class:"other-input mt-2"},Gf=["onUpdate:modelValue","disabled","onInput"],Yf={key:1,class:"alert alert-info mb-0"},Jf={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=_(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),u=_(()=>{if(!c.value)return{};const x=o.toolCall.result;if(x?.content){if(typeof x.content=="object"&&x.content.answers)return x.content.answers;if(typeof x.content=="string")try{const O=JSON.parse(x.content);if(O.answers)return O.answers}catch{}}const E=o.toolCall.input||{};return E.answers?E.answers:{}}),f=_(()=>Object.keys(u.value).length>0),m=_(()=>(o.toolCall.input||{}).questions||[]),p=N({}),d=N({});me(m,x=>{x.forEach((E,O)=>{O in p.value||(p.value[O]=E.multiSelect?[]:null),O in d.value||(d.value[O]="")})},{immediate:!0});function w(x,E){const O=p.value[x];return Array.isArray(O)?O.includes(E):O===E}function h(x){const E=p.value[x];return Array.isArray(E)?E.includes("__OTHER__"):E==="__OTHER__"}function $(x,E){p.value[x]=E,l()}function S(x){p.value[x]="__OTHER__",l()}function y(x,E){const O=p.value[x];if(!Array.isArray(O))p.value[x]=[E];else{const A=O.indexOf(E);A===-1?O.push(E):O.splice(A,1)}l()}function g(x){const E=p.value[x];if(!Array.isArray(E))p.value[x]=["__OTHER__"];else{const O=E.indexOf("__OTHER__");O===-1?E.push("__OTHER__"):E.splice(O,1)}l()}function v(x){l()}function l(){const x={};m.value.forEach((E,O)=>{const A=p.value[O],D=E.question;if(E.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(M=>M==="__OTHER__"?d.value[O]||"":M).filter(M=>M);x[D]=C.join(", ")}}else A==="__OTHER__"?x[D]=d.value[O]||"":A&&(x[D]=A)}),a("answer",x)}const k=_(()=>m.value.every((x,E)=>{const O=p.value[E];if(x.multiSelect){if(!Array.isArray(O)||O.length===0||O.includes("__OTHER__")&&!d.value[E])return!1}else if(!O||O==="__OTHER__"&&!d.value[E])return!1;return!0}));return e({allQuestionsAnswered:k,getAnswers:()=>{const x={};return m.value.forEach((E,O)=>{const A=p.value[O],D=E.question;if(E.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(M=>M==="__OTHER__"?d.value[O]||"":M).filter(M=>M);x[D]=C.join(", ")}}else A==="__OTHER__"?x[D]=d.value[O]||"":A&&(x[D]=A)}),x}}),(x,E)=>(i(),r("div",Tf,[c.value?(i(),r(ne,{key:0},[f.value?(i(),r("div",Af,[(i(!0),r(ne,null,ce(u.value,(O,A)=>(i(),r("div",{key:A,class:"answer-item mb-2"},[t("div",Df,b(A),1),t("div",Mf,b(O),1)]))),128))])):(i(),r("div",Of," No answers recorded. "))],64)):(i(),r(ne,{key:1},[m.value.length>0?(i(),r("div",Nf,[(i(!0),r(ne,null,ce(m.value,(O,A)=>(i(),r("div",{key:A,class:"question-block mb-3"},[t("div",Lf,[O.header?(i(),r("span",If,b(O.header),1)):T("",!0),t("span",jf,b(O.question),1)]),t("div",Pf,[(i(!0),r(ne,null,ce(O.options,(D,C)=>(i(),r("div",{key:C,class:z(["option-item form-check",{selected:w(A,D.label)}])},[O.multiSelect?(i(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-opt${C}`,checked:w(A,D.label),disabled:n.disabled,onChange:M=>y(A,D.label)},null,40,Rf)):(i(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-opt${C}`,name:`question-${A}`,checked:w(A,D.label),disabled:n.disabled,onChange:M=>$(A,D.label)},null,40,Ff)),t("label",{class:"form-check-label",for:`q${A}-opt${C}`},[t("span",Vf,b(D.label),1),D.description?(i(),r("span",Wf,b(D.description),1)):T("",!0)],8,Bf)],2))),128)),t("div",Uf,[O.multiSelect?(i(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-other`,checked:h(A),disabled:n.disabled,onChange:D=>g(A)},null,40,Hf)):(i(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-other`,name:`question-${A}`,checked:h(A),disabled:n.disabled,onChange:D=>S(A)},null,40,qf)),t("label",{class:"form-check-label",for:`q${A}-other`},[...E[0]||(E[0]=[t("span",{class:"option-label"},"Other",-1)])],8,zf),h(A)?(i(),r("div",Kf,[Se(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":D=>d.value[A]=D,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:D=>v()},null,40,Gf),[[We,d.value[A]]])])):T("",!0)])])]))),128))])):(i(),r("div",Yf," No questions to display. "))],64))]))}},jn=se(Jf,[["__scopeId","data-v-ebcee33f"]]),Qf={class:"timeline-detail"},Xf={key:0,class:"detail-banner detail-banner-warning"},Zf={key:2,class:"permission-section"},em={class:"permission-buttons"},tm=["disabled"],sm=["disabled"],nm={class:"detail-banner detail-banner-warning"},om={key:0,class:"suggestions-section"},am=["id","onUpdate:modelValue","disabled"],im=["for"],lm={class:"permission-buttons"},rm=["disabled"],cm=["disabled"],um=["disabled"],dm={class:"guidance-section"},fm=["disabled"],mm=["disabled"],pm={key:3,class:"detail-banner detail-banner-warning"},vm={key:4,class:"detail-banner detail-banner-error"},hm={key:0},_m={key:5,class:"detail-section"},gm={key:0,class:"detail-pre"},bm={key:6,class:"detail-section"},ym={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=pe(),a=rt(),c=N(!1),u=N(!1),f=N(!1),m=N(null),p=N(""),d=N(!1),w=N(null),h=N({}),$=N(null),S=N({});me(()=>e.toolCall.suggestions,R=>{if(R&&R.length>0){const H={};R.forEach((X,ee)=>{H[ee]=!0}),h.value=H}},{immediate:!0});const y=_(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((R,H)=>h.value[H]):[]),g={Read:kl,Write:Fl,Bash:Xl,TodoWrite:vr,Edit:Pr,Grep:Nn,Glob:Nn,WebFetch:Ln,WebSearch:Ln,Task:Wc,TaskCreate:ou,TaskUpdate:Au,TaskList:Hu,TaskGet:pd,NotebookEdit:Od,BashOutput:In,KillShell:In,SlashCommand:gf,Skill:af,ExitPlanMode:Ef,AskUserQuestion:jn},v=_(()=>g[e.toolCall.name]||el),l=_(()=>{if(e.toolCall.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[e.toolCall.backendStatus]||e.toolCall.backendStatus;const R=s.getBackendToolState(o.currentSessionId,e.toolCall.id);return R?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[R.state]||R.state:e.toolCall.status}),k=_(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),x=_(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),E=_(()=>l.value==="permission_required"),O=_(()=>e.toolCall.name==="AskUserQuestion"),A=_(()=>!O.value||!$.value?!1:$.value.allQuestionsAnswered),D=_(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0),C=_(()=>e.toolCall.input&&Object.keys(e.toolCall.input).length>0),M=_(()=>e.toolCall.result!=null),q=_(()=>{try{return JSON.stringify(e.toolCall.input,null,2)}catch{return String(e.toolCall.input)}}),B=_(()=>{const R=e.toolCall.result;if(!R)return"";if(typeof R=="string")return R;if(R.content)return typeof R.content=="string"?R.content:JSON.stringify(R.content,null,2);try{return JSON.stringify(R,null,2)}catch{return String(R)}});function V(R){S.value=R}async function U(){if(!(f.value||!$.value)){f.value=!0,m.value="submit-answers";try{const R=o.currentSessionId,H=$.value.getAnswers(),X={questions:e.toolCall.input?.questions||[],answers:H};R&&(s.updateToolCall(R,e.toolCall.id,{input:X}),s.handlePermissionResponse(R,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await a.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",X)}catch(R){console.error("Failed to submit question answers:",R)}finally{f.value=!1,m.value=null}}}async function J(R,H,X=null){if(f.value)return;f.value=!0;const ee=y.value,he=H&&ee.length>0;R==="allow"?m.value=he?"approve-apply":"approve":X?m.value="deny-guidance":m.value="deny";try{const Q=o.currentSessionId;if(Q){const _e=he?ee:[];s.handlePermissionResponse(Q,{request_id:e.toolCall.permissionRequestId,decision:R,reasoning:R==="allow"?"User allowed permission":"User denied permission",applied_updates:_e})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,R,he,X,he?ee:null)}catch(Q){console.error("Failed to send permission response:",Q)}finally{f.value=!1,m.value=null}}function ae(R){return R.type==="setMode"?`Set mode: ${R.mode}`:R.type==="addRules"&&R.rules?.length?`Allow: ${R.rules.map(X=>X.ruleContent?`${X.toolName}(${X.ruleContent})`:X.toolName).join(", ")}`:R.type==="addDirectories"&&R.directories?.length?`Add directories: ${R.directories.join(", ")}`:JSON.stringify(R)}function L(){d.value=!0,dt(()=>{w.value?.focus()})}function j(){const R=w.value;if(!R)return;R.style.height="auto";const H=parseFloat(getComputedStyle(R).lineHeight)*6+10;R.style.height=Math.min(R.scrollHeight,H)+"px"}return(R,H)=>(i(),r("div",Qf,[k.value?(i(),r("div",Xf,[H[9]||(H[9]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[H[8]||(H[8]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,b(x.value?.message||"Session was terminated"),1)])])):T("",!0),O.value&&l.value==="permission_required"?T("",!0):(i(),Ce(So(v.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),l.value==="permission_required"&&!k.value?(i(),r("div",Zf,[O.value?(i(),r(ne,{key:0},[H[10]||(H[10]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),be(jn,{ref_key:"questionHandlerRef",ref:$,toolCall:n.toolCall,disabled:f.value,onAnswer:V},null,8,["toolCall","disabled"]),t("div",em,[t("button",{class:"btn-timeline btn-primary",onClick:U,disabled:f.value||!A.value},b(f.value?"Submitting...":"Submit Answers"),9,tm),t("button",{class:"btn-timeline btn-secondary",onClick:H[0]||(H[0]=X=>J("deny",!1)),disabled:f.value}," Skip ",8,sm)])],64)):(i(),r(ne,{key:1},[t("div",nm,[H[12]||(H[12]=t("strong",null,"Permission Required",-1)),t("p",null,[H[11]||(H[11]=ue("Claude wants to use ",-1)),t("code",null,b(n.toolCall.name),1)])]),D.value?(i(),r("div",om,[H[13]||(H[13]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(i(!0),r(ne,null,ce(n.toolCall.suggestions,(X,ee)=>(i(),r("div",{key:ee,class:"suggestion-item"},[Se(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${ee}`,"onUpdate:modelValue":he=>h.value[ee]=he,disabled:f.value},null,8,am),[[xo,h.value[ee]]]),t("label",{for:`sg-${n.toolCall.id}-${ee}`},[t("code",null,b(ae(X)),1)],8,im)]))),128))])):T("",!0),t("div",lm,[D.value?(i(),r("button",{key:0,class:"btn-timeline btn-approve",onClick:H[1]||(H[1]=X=>J("allow",!0)),disabled:f.value},b(f.value&&m.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,rm)):T("",!0),t("button",{class:z(["btn-timeline",D.value?"btn-approve-outline":"btn-approve"]),onClick:H[2]||(H[2]=X=>J("allow",!1)),disabled:f.value},b(D.value?"Approve Only":"Approve"),11,cm),t("button",{class:"btn-timeline btn-deny",onClick:H[3]||(H[3]=X=>J("deny",!1)),disabled:f.value}," Deny ",8,um)]),t("div",dm,[d.value?T("",!0):(i(),r("a",{key:0,href:"#",class:"guidance-link",onClick:ye(L,["prevent"])}," Add guidance... ")),d.value?(i(),r(ne,{key:1},[Se(t("textarea",{ref_key:"guidanceTextarea",ref:w,"onUpdate:modelValue":H[4]||(H[4]=X=>p.value=X),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:f.value,onInput:j},null,40,fm),[[We,p.value]]),p.value.trim()?(i(),r("button",{key:0,class:"btn-timeline btn-guidance",onClick:H[5]||(H[5]=X=>J("deny",!1,p.value)),disabled:f.value}," Provide Guidance & Continue ",8,mm)):T("",!0)],64)):T("",!0)])],64))])):T("",!0),l.value==="permission_required"&&k.value?(i(),r("div",pm,[H[14]||(H[14]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,b(x.value?.message||"Session was terminated before permission could be granted"),1)])):T("",!0),n.toolCall.permissionDecision==="deny"?(i(),r("div",vm,[H[15]||(H[15]=ue(" Permission denied ",-1)),n.toolCall.result?.message?(i(),r("span",hm," - "+b(n.toolCall.result.message),1)):T("",!0)])):T("",!0),C.value&&!E.value?(i(),r("div",_m,[t("div",{class:"section-header",onClick:H[6]||(H[6]=X=>c.value=!c.value)},[t("span",null,b(c.value?"â–¾":"â–¸")+" Parameters",1)]),c.value?(i(),r("pre",gm,b(q.value),1)):T("",!0)])):T("",!0),M.value&&!E.value?(i(),r("div",bm,[t("div",{class:"section-header",onClick:H[7]||(H[7]=X=>u.value=!u.value)},[t("span",null,b(u.value?"â–¾":"â–¸")+" Result",1)]),u.value?(i(),r("pre",{key:0,class:z(["detail-pre",{"result-error":n.toolCall.result?.error}])},b(B.value),3)):T("",!0)])):T("",!0)]))}},wm=se(ym,[["__scopeId","data-v-1ed79806"]]),km=["title"],$m={__name:"TimelineOverflow",props:{count:{type:Number,required:!0}},emits:["toggle"],setup(n){return(e,s)=>(i(),r("div",{class:"timeline-overflow",title:`${n.count} earlier tool calls hidden`,onClick:s[0]||(s[0]=ye(o=>e.$emit("toggle"),["stop"]))}," +"+b(n.count),9,km))}},Sm=se($m,[["__scopeId","data-v-5df52f24"]]),xm={key:0,class:"activity-timeline"},Cm={class:"timeline-row"},Em={class:"timeline-summary"},Tm={class:"summary-count"},Am={key:0,class:"summary-running"},Dm={key:1,class:"summary-permission"},js=10,Mm={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=Pe(),o=pe(),a=N(null),c=N(!1),u=N({});function f(k,x){x&&(u.value[k]=x)}const m=_(()=>[...e.tools].map((k,x)=>({tool:k,originalIndex:x})).sort((k,x)=>{if(k.tool.timestamp&&x.tool.timestamp){const E=new Date(k.tool.timestamp).getTime(),O=new Date(x.tool.timestamp).getTime();if(E!==O)return E-O}return k.originalIndex-x.originalIndex}).map(({tool:k})=>k)),p=_(()=>m.value.length>js),d=_(()=>p.value?m.value.length-js:0),w=_(()=>!p.value||c.value?m.value:m.value.slice(-js)),h=_(()=>a.value?m.value.find(k=>k.id===a.value):null);me(m,k=>{const x=k.find(E=>y(E)==="permission_required");if(x)a.value=x.id;else if(a.value){const E=k.find(O=>O.id===a.value);E&&y(E)!=="permission_required"&&(a.value=null)}},{deep:!0});const $=_(()=>m.value.filter(k=>y(k)==="executing").length),S=_(()=>m.value.filter(k=>y(k)==="permission_required").length);function y(k){const x=o.currentSessionId;return x?k.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[k.backendStatus]||k.backendStatus:s.isToolUseOrphaned(x,k.id)?"orphaned":k.status:k.status}function g(k){const x=y(k),E=k.result?.error||k.status==="error"||k.permissionDecision==="deny";switch(x){case"completed":return E?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function v(k){a.value===k?a.value=null:a.value=k}function l(){c.value=!c.value}return(k,x)=>m.value.length>0?(i(),r("div",xm,[t("div",Cm,[p.value&&!c.value?(i(),Ce(Sm,{key:0,count:d.value,onToggle:l},null,8,["count"])):T("",!0),(i(!0),r(ne,null,ce(w.value,(E,O)=>(i(),r(ne,{key:E.id},[O>0?(i(),Ce(Wi,{key:0,leftColor:g(w.value[O-1]),rightColor:g(E)},null,8,["leftColor","rightColor"])):T("",!0),be(Bi,{ref_for:!0,ref:A=>f(E.id,A),tool:E,isExpanded:a.value===E.id,onClick:A=>v(E.id)},null,8,["tool","isExpanded","onClick"])],64))),128))]),t("div",Em,[t("span",Tm,b(m.value.length)+" tool"+b(m.value.length!==1?"s":""),1),$.value>0?(i(),r("span",Am,b($.value)+" running",1)):T("",!0),S.value>0?(i(),r("span",Dm,b(S.value)+" needs permission",1)):T("",!0)]),a.value&&h.value?(i(),Ce(wm,{key:0,toolCall:h.value},null,8,["toolCall"])):T("",!0)])):T("",!0)}},Om=se(Mm,[["__scopeId","data-v-f86bca17"]]),Nm={class:"msg-wrapper msg-assistant"},Lm={class:"msg-meta"},Im={class:"msg-time"},jm={class:"msg-bubble msg-bubble-assistant"},Pm={key:0,class:"thinking-block mb-2"},Rm=["innerHTML"],Fm={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Pe(),o=pe();Ke.setOptions({breaks:!0,gfm:!0});const a=_(()=>es(e.message.timestamp)),c=_(()=>{const h=e.message.content||"";return h.trim().length>0&&h!=="Assistant response"}),u=_(()=>{const h=e.message.content||"";let $=Ke.parse(h);return $=$.replace(/\n</g,"<"),$=$.replace(/\n+$/,""),Vt.sanitize($)}),f=_(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),m=_(()=>e.message.metadata?.thinking_content||""),p=_(()=>{const h=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,$=e.attachedTools&&e.attachedTools.length>0;return h||$}),d=_(()=>{const h=e.message.metadata?.tool_uses||[],$=e.attachedTools||[],S=[...h],y=new Set(h.map(g=>g.id));for(const g of $)y.has(g.id)||S.push(g);return S}),w=_(()=>{const h=o.currentSessionId;if(!h)return[];const $=s.toolCallsBySession.get(h)||[];return d.value.map(S=>{const y=$.find(g=>g.id===S.id);return y||{id:S.id,name:S.name,input:S.input,status:"pending",result:null,timestamp:S.timestamp||e.message.timestamp,isExpanded:!0}})});return(h,$)=>(i(),r("div",Nm,[t("div",Lm,[$[0]||($[0]=t("span",{class:"msg-role"},"assistant",-1)),t("span",Im,b(a.value),1)]),t("div",jm,[f.value?(i(),r("div",Pm,[be(Ii,{thinking:m.value},null,8,["thinking"])])):T("",!0),c.value?(i(),r("div",{key:1,class:"msg-text",innerHTML:u.value},null,8,Rm)):T("",!0),p.value?(i(),Ce(Om,{key:2,tools:w.value,messageId:n.message.id},null,8,["tools","messageId"])):T("",!0)])]))}},Bm=se(Fm,[["__scopeId","data-v-2f57d076"]]),Vm={class:"msg-wrapper msg-system"},Wm={key:0,class:"pill-icon"},Um={class:"pill-text"},Hm={class:"pill-time"},qm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>es(e.message.timestamp)),o=_(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting"),a=_(()=>{if(o.value)return"Context compaction in progress...";const c=e.message.content||"";return c.length>80?c.substring(0,77)+"...":c});return(c,u)=>(i(),r("div",Vm,[t("div",{class:z(["msg-pill",{"pill-compaction":o.value}])},[o.value?(i(),r("span",Wm,"ðŸ—œï¸")):T("",!0),t("span",Um,b(a.value),1),u[0]||(u[0]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Hm,b(s.value),1)],2)]))}},Pn=se(qm,[["__scopeId","data-v-950fba0a"]]),zm={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=_(()=>{switch(e.message.type){case"user":return Ti;case"assistant":return Bm;case"system":return Pn;default:return Pn}});return(o,a)=>(i(),Ce(So(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Km=se(zm,[["__scopeId","data-v-11dff525"]]),Gm={class:"msg-wrapper msg-system"},Ym={class:"pill-badge"},Jm={class:"pill-time"},Qm={key:0,class:"compaction-detail"},Xm={class:"detail-section"},Zm={class:"detail-value"},ep={class:"detail-section"},tp={class:"detail-value"},sp={key:0,class:"detail-section"},np={class:"detail-value"},op={class:"continuation-section"},ap={class:"continuation-text"},ip={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=N(!1);function o(){s.value=!s.value}const a=_(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),c=_(()=>a.value?e.messages[3]:e.messages[2]),u=_(()=>c.value?.metadata?.init_data?.compact_metadata||{}),f=_(()=>u.value.pre_tokens||0),m=_(()=>a.value?e.messages[4]:e.messages[3]),p=_(()=>m.value?.content||""),d=_(()=>{const h=e.messages[0]?.timestamp;return h?es(h):""});function w(h){return h?`${h.toLocaleString()} tokens`:"0 tokens"}return(h,$)=>(i(),r("div",Gm,[t("div",{class:"msg-pill pill-compaction",onClick:o,style:{cursor:"pointer"}},[$[0]||($[0]=t("span",{class:"pill-icon"},"ðŸ—œï¸",-1)),$[1]||($[1]=t("span",{class:"pill-text"},"Context Compaction Event",-1)),t("span",Ym,b(w(f.value)),1),$[2]||($[2]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Jm,b(d.value),1),t("span",{class:z(["pill-chevron",{expanded:s.value}])},"â–¶",2)]),s.value?(i(),r("div",Qm,[t("div",Xm,[$[3]||($[3]=t("div",{class:"detail-label"},"Trigger",-1)),t("div",Zm,b(u.value.trigger||"auto"),1)]),t("div",ep,[$[4]||($[4]=t("div",{class:"detail-label"},"Pre-compaction",-1)),t("div",tp,b(w(f.value)),1)]),u.value.post_tokens?(i(),r("div",sp,[$[5]||($[5]=t("div",{class:"detail-label"},"Post-compaction",-1)),t("div",np,b(w(u.value.post_tokens)),1)])):T("",!0),t("div",op,[$[6]||($[6]=t("div",{class:"detail-label"},"Continuation Message",-1)),t("pre",ap,b(p.value),1)])])):T("",!0)]))}},lp=se(ip,[["__scopeId","data-v-6b5b6a98"]]),rp={key:0,class:"text-muted text-center py-5"},cp={__name:"MessageList",setup(n){const e=Pe(),s=xe(),o=N(null),a=_(()=>{const d=e.currentMessages,w=[];let h=0;for(;h<d.length;){const $=d[h];if(u($,d,h)){const S=d[h+2],g=S?.type==="system"&&S?.metadata?.subtype==="init"?5:4,v=d.slice(h,h+g);w.push({type:"compaction",messages:v}),h+=g;continue}m($)&&w.push({type:"message",message:$,attachedTools:[]}),h++}return c(w)});function c(d){const w=new Map,h=new Set;for(let S=0;S<d.length;S++){const y=d[S];if(y.type==="compaction")continue;const g=y.message,v=g.content&&g.content.trim().length>0&&g.content!=="Assistant response",l=g.type==="assistant"&&g.metadata?.has_tool_uses&&g.metadata?.tool_uses?.length>0;if(g.type==="assistant"&&l&&!v){let k=-1,x=!1;for(let E=S-1;E>=0;E--){const O=d[E];if(!h.has(E)){if(O.type==="message"&&O.message.type!=="assistant"){x=!0;break}if(O.type==="message"&&O.message.type==="assistant"){const A=O.message;if(A.content&&A.content.trim().length>0&&A.content!=="Assistant response"){k=E;break}else{k=E;break}}}}x&&k===-1||(x&&k>=0?(w.has(k)||w.set(k,[]),w.get(k).push(...g.metadata.tool_uses),h.add(S)):!x&&k>=0&&(w.has(k)||w.set(k,[]),w.get(k).push(...g.metadata.tool_uses),h.add(S)))}}const $=[];for(let S=0;S<d.length;S++){if(h.has(S))continue;const y=d[S];w.has(S)&&(y.attachedTools=[...y.attachedTools||[],...w.get(S)]),$.push(y)}return $}function u(d,w,h){if(h+3>=w.length)return!1;const $=w[h],S=w[h+1];let y=w[h+2],g=w[h+3],v=w[h+4];const l=$.type==="system"&&$.metadata?.subtype==="status"&&$.metadata?.init_data?.status==="compacting",k=S.type==="system"&&S.metadata?.subtype==="status"&&(S.metadata?.init_data?.status===null||S.metadata?.init_data?.status===void 0);if(y?.type==="system"&&y?.metadata?.subtype==="init"){if(h+4>=w.length)return!1;const E=!0,O=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",A=v?.type==="user"&&v?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",l),console.log("  Msg2 (null status):",k),console.log("  Msg3 (init):",E),console.log("  Msg4 (boundary):",O),console.log("  Msg5 (continuation):",A)),l&&k&&E&&O&&A}else{const E=y?.type==="system"&&y?.metadata?.subtype==="compact_boundary",O=g?.type==="user"&&g?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",l),console.log("  Msg2 (null status):",k),console.log("  Msg3 (boundary):",E),console.log("  Msg4 (continuation):",O)),l&&k&&E&&O}}async function f(){s.autoScrollEnabled&&(await dt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}me(()=>a.value.length,f),me(()=>e.currentToolCalls.length,f),me(()=>e.currentToolCalls.map(d=>`${d.id}-${d.status}`).join(","),f),Me(()=>{setTimeout(()=>{f()},100)});function m(d){const w=d.subtype||d.metadata?.subtype;if(d.type==="system"&&w==="init"||d.type==="system"&&w==="task_notification"||d.type==="result"||d.type==="permission_request"||d.type==="permission_response")return!1;if(d.type==="user"&&d.metadata?.has_tool_results){const h=d.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(d.type==="user"){const h=d.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(d.type==="user"){const h=d.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}if(d.type==="user"){const h=d.metadata||{};if(h.parent_tool_use_id&&!h.has_tool_results)return!1}return!0}function p(d){return{type:d.type||"unknown",content:d.content||"",timestamp:d.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...d.metadata}}}return(d,w)=>(i(),r("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[a.value.length===0?(i(),r("div",rp," No messages yet. Start a conversation! ")):T("",!0),(i(!0),r(ne,null,ce(a.value,(h,$)=>(i(),r(ne,{key:`item-${$}`},[h.type==="message"?(i(),Ce(Km,{key:0,message:p(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(i(),Ce(lp,{key:1,messages:h.messages},null,8,["messages"])):T("",!0)],64))),128))],512))}},up=se(cp,[["__scopeId","data-v-1d56e967"]]),dp={key:0,class:"attachment-list"},fp={key:0,class:"attachment-preview"},mp=["src","alt"],pp={key:1,class:"attachment-icon"},vp={class:"file-type-icon"},hp={class:"attachment-info"},_p=["title"],gp={class:"attachment-size"},bp=["onClick"],yp={key:2,class:"upload-progress"},wp=["title"],kp={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const p=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(p)}function a(m){const p=m.name?.split(".").pop()?.toLowerCase()||"",d=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(p)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(p)?"âš™ï¸":["log","txt"].includes(p)||d==="text/plain"?"ðŸ“‹":["md","rst"].includes(p)?"ðŸ“":"ðŸ“"}function c(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function u(m,p=20){if(!m||m.length<=p)return m;const d=m.split(".").pop(),w=m.substring(0,m.length-d.length-1);return w.length<=p-d.length-4?m:w.substring(0,p-d.length-4)+"..."+d}function f(m){s("remove",m)}return(m,p)=>n.attachments.length>0?(i(),r("div",dp,[(i(!0),r(ne,null,ce(n.attachments,(d,w)=>(i(),r("div",{key:d.id||w,class:"attachment-item"},[o(d)?(i(),r("div",fp,[t("img",{src:d.preview||d.url,alt:d.name,class:"attachment-thumbnail"},null,8,mp)])):(i(),r("div",pp,[t("span",vp,b(a(d)),1)])),t("div",hp,[t("span",{class:"attachment-name",title:d.name},b(u(d.name)),9,_p),t("span",gp,b(c(d.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:h=>f(w)}," âœ• ",8,bp),d.uploading?(i(),r("div",yp,[t("div",{class:"progress-bar",style:Ie({width:(d.progress||0)+"%"})},null,4)])):T("",!0),d.error?(i(),r("div",{key:3,class:"upload-error",title:d.error}," âš ï¸ "+b(d.error),9,wp)):T("",!0)]))),128))])):T("",!0)}},$p=se(kp,[["__scopeId","data-v-0fcc4974"]]),Sp=["id","aria-selected","onMousedown","onMouseenter"],xp={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=N(null);return me(()=>e.selectedIndex,o=>{if(!s.value)return;const a=s.value.children[o];a&&a.scrollIntoView({block:"nearest"})}),(o,a)=>n.commands.length>0?(i(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),r(ne,null,ce(n.commands,(c,u)=>(i(),r("li",{id:`slash-cmd-${u}`,key:c,role:"option",class:z(["slash-command-item",{active:u===n.selectedIndex}]),"aria-selected":u===n.selectedIndex,onMousedown:ye(f=>o.$emit("select",c),["prevent"]),onMouseenter:f=>o.$emit("highlight",u)}," /"+b(c),43,Sp))),128))],512)):T("",!0)}},Cp=se(xp,[["__scopeId","data-v-97c65547"]]),Ep={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Tp=["disabled"],Ap=["placeholder","disabled","aria-expanded","aria-activedescendant"],Dp=["disabled"],Mp=["disabled"],Rn=5*1024*1024,Op={__name:"InputArea",setup(n){const e=pe(),s=rt(),o=Xe(),a=xe(),c=Co("pendingResourceAttachment",N(null)),u=N(null),f=N(null),m=N(window.innerWidth),p=N([]),d=N(!1),w=N(!1),h=N(!1),$=N(""),S=N(0),y=_({get:()=>e.currentInput,set:K=>{e.currentInput=K}}),g=_(()=>e.currentSession?.is_processing||!1),v=_(()=>s.sessionConnected),l=_(()=>e.currentSession?.state==="starting"),k=_(()=>e.currentSessionId),x=_(()=>!!y.value.trim()||p.value.filter(K=>!K.error).length>0),E=_(()=>m.value<768),O=_(()=>l.value?"Session is starting...":v.value?"Type your message to Claude Code...":"Waiting for connection..."),A=_(()=>{const K=k.value;return K?e.initData.get(K)?.slash_commands||[]:[]}),D=_(()=>{const K=$.value.toLowerCase();return A.value.filter(P=>P.toLowerCase().includes(K)).sort((P,I)=>P.localeCompare(I))});function C(){m.value=window.innerWidth}Me(()=>{window.addEventListener("resize",C)}),De(()=>{window.removeEventListener("resize",C)}),me(c,K=>{K&&(Q(K),c.value=null)});function M(K){if(h.value&&D.value.length>0){const P=D.value.length;if(K.key==="ArrowDown"){K.preventDefault(),S.value=(S.value+1)%P;return}if(K.key==="ArrowUp"){K.preventDefault(),S.value=(S.value-1+P)%P;return}if(K.key==="Enter"){K.preventDefault(),B(D.value[S.value]);return}if(K.key==="Tab"){K.preventDefault(),B(D.value[S.value]);return}}if(K.key==="Escape"&&h.value){K.preventDefault(),h.value=!1;return}if(K.key==="Enter"&&!K.shiftKey){if(E.value)return;K.preventDefault(),ee()}}function q(){const K=u.value;if(!K)return;K.style.height="auto";const P=Math.min(K.scrollHeight,parseInt(getComputedStyle(K).maxHeight));K.style.height=P+"px"}me(y,K=>{K.startsWith("/")&&A.value.length>0?($.value=K.slice(1),S.value=0,h.value=D.value.length>0):h.value=!1});function B(K){y.value=`/${K} `,h.value=!1,u.value?.focus(),q()}function V(){f.value?.click()}function U(K){const P=Array.from(K.target.files||[]);L(P),K.target.value=""}function J(K){d.value=!1;const P=Array.from(K.dataTransfer?.files||[]);L(P)}function ae(K){const P=K.clipboardData?.items;if(!P)return;const I=[];for(const W of P)if(W.type.startsWith("image/")){const Z=W.getAsFile();if(Z){const oe=W.type.split("/")[1]||"png",$e=`clipboard-${Date.now()}.${oe}`,Ye=new File([Z],$e,{type:Z.type});I.push(Ye)}}I.length>0&&(K.preventDefault(),L(I))}function L(K){for(const P of K){if(P.size>Rn){p.value.push({id:R(),name:P.name,size:P.size,type:P.type,file:P,error:`File too large (max ${Rn/(1024*1024)}MB)`});continue}let I=null;P.type.startsWith("image/")&&(I=URL.createObjectURL(P)),p.value.push({id:R(),name:P.name,size:P.size,type:P.type,file:P,preview:I,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function j(K){const P=p.value[K];P.preview&&URL.revokeObjectURL(P.preview),p.value.splice(K,1)}function R(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function H(K){const P=k.value;if(!P)return null;K.uploading=!0,K.progress=0,K.error=null;try{const I=new FormData;I.append("file",K.file);const W=await fetch(`/api/sessions/${P}/files`,{method:"POST",body:I});if(!W.ok){const oe=await W.json().catch(()=>({}));throw new Error(oe.detail||`Upload failed: ${W.status}`)}const Z=await W.json();return K.uploaded=!0,K.uploadedInfo=Z.file,K.progress=100,Z.file}catch(I){return K.error=I.message,null}finally{K.uploading=!1}}async function X(){const K=p.value.filter(P=>!P.uploaded&&!P.error);if(K.length===0)return!0;w.value=!0;try{return(await Promise.all(K.map(H))).every(I=>I!==null)}finally{w.value=!1}}async function ee(){const K=y.value.trim(),P=p.value.filter(Z=>!Z.error).length>0;if(!K&&!P||P&&!await X())return;let I=y.value;const W=p.value.filter(Z=>Z.uploaded&&Z.uploadedInfo).map(Z=>Z.uploadedInfo);if(W.length>0){const Z=W.map(oe=>{const $e=(oe.size_bytes/1024).toFixed(1);return`- ${oe.original_name} (${$e} KB): ${oe.stored_path}`}).join(`
`);I.trim()?I=`${I}

---
Attached files (use Read tool to access):
${Z}`:I=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${Z}`}s.sendMessage(I),y.value="",he(),u.value&&(u.value.style.height="auto")}function he(){for(const K of p.value)K.preview&&URL.revokeObjectURL(K.preview);p.value=[]}function Q(K){if(!K||!K.resource_id){console.warn("Invalid resource for attachment:",K);return}const P=k.value;if(!P){console.warn("No current session for resource attachment");return}if(p.value.findIndex(oe=>oe.resourceId===K.resource_id)>=0){console.log("Resource already attached:",K.resource_id);return}const W=o.isImageResource(K);let Z=null;W&&(Z=o.getResourceUrl(P,K.resource_id)),p.value.push({id:R(),resourceId:K.resource_id,name:K.original_filename||K.title||"Resource",size:K.size_bytes||0,type:K.format||"application/octet-stream",file:null,preview:Z,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:K.resource_id,original_name:K.original_filename||K.title,stored_path:K.file_path||`/api/sessions/${P}/resources/${K.resource_id}`,size_bytes:K.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",K.resource_id)}function _e(){s.interruptSession()}return(K,P)=>(i(),r("div",{class:z(["border-top",le(a).isRedBackground?"theme-red-panel":"bg-light"])},[v.value?T("",!0):(i(),r("div",Ep,[...P[6]||(P[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),be($p,{attachments:p.value,onRemove:j},null,8,["attachments"]),d.value?(i(),r("div",{key:1,class:"drop-zone-overlay",onDragover:P[0]||(P[0]=ye(()=>{},["prevent"])),onDragleave:P[1]||(P[1]=I=>d.value=!1),onDrop:ye(J,["prevent"])},[...P[7]||(P[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):T("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:P[4]||(P[4]=ye(I=>d.value=!0,["prevent"])),onDragenter:P[5]||(P[5]=ye(I=>d.value=!0,["prevent"]))},[h.value?(i(),Ce(Cp,{key:0,commands:D.value,"selected-index":S.value,onSelect:B,onHighlight:P[2]||(P[2]=I=>S.value=I)},null,8,["commands","selected-index"])):T("",!0),t("input",{ref_key:"fileInput",ref:f,type:"file",multiple:"",class:"d-none",onChange:U},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:l.value||!v.value,onClick:V}," ðŸ“Ž ",8,Tp),Se(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:u,"onUpdate:modelValue":P[3]||(P[3]=I=>y.value=I),class:"form-control",placeholder:O.value,disabled:l.value||!v.value,rows:"1","aria-expanded":h.value||void 0,"aria-activedescendant":h.value?`slash-cmd-${S.value}`:void 0,onInput:q,onKeydown:M,onPaste:ae},null,40,Ap),[[We,y.value]]),g.value&&!x.value?(i(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:_e}," Stop ")):g.value&&x.value?(i(),r("button",{key:2,class:"btn btn-info",disabled:!v.value||l.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:ee},b(w.value?"Uploading...":"Queue"),9,Dp)):(i(),r("button",{key:3,class:"btn btn-primary",disabled:!x.value||!v.value||l.value||w.value,onClick:ee},b(w.value?"Uploading...":"Send"),9,Mp))],32)],2))}},Np=se(Op,[["__scopeId","data-v-5b1f250e"]]),Lp={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Ip={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},jp={class:"text-secondary"},Pp={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Rp={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=xe(),a=_(()=>s.currentSession),c=_(()=>o.isLoading),u=_(()=>o.loadingMessage);return Me(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),me(()=>e.sessionId,async(f,m)=>{if(f!==m&&f!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(f)}finally{o.hideLoading()}}}),De(()=>{}),(f,m)=>(i(),r("div",Lp,[c.value?(i(),r("div",Ip,[m[0]||(m[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",jp,b(u.value),1)])):T("",!0),a.value?(i(),Ce(ei,{key:1,"session-id":e.sessionId},null,8,["session-id"])):T("",!0),t("div",Pp,[be(up)]),be(Np),a.value?(i(),Ce(ai,{key:2,"session-id":e.sessionId},null,8,["session-id"])):T("",!0),a.value?(i(),Ce(mi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):T("",!0)]))}},Wt=lt("legion",()=>{const n=N(new Map),e=N(new Map),s=N(null),o=_(()=>n.value.get(s.value)||[]),a=_(()=>e.value.get(s.value)||[]);function c(S){s.value=S}async function u(S,y=100,g=0){try{const v=await ke.get(`/api/legions/${S}/timeline?limit=${y}&offset=${g}`),l=v.comms||[],k=v.total_count||l.length,x=v.has_more||!1;return l.sort((E,O)=>new Date(E.timestamp)-new Date(O.timestamp)),console.log(`Loaded ${l.length} of ${k} comms for legion ${S}`),n.value.set(S,l),n.value=new Map(n.value),{comms:l,totalCount:k,hasMore:x}}catch(v){throw console.error("Failed to load timeline:",v),v}}function f(S,y){n.value.has(S)||n.value.set(S,[]);const g=n.value.get(S);if(g.some(l=>l.comm_id===y.comm_id)){console.log(`Duplicate comm ${y.comm_id} prevented in timeline`);return}g.push(y),n.value=new Map(n.value)}async function m(S,y){try{const v=(await ke.post(`/api/legions/${S}/comms`,y)).comm;return console.log(`Sent comm ${v.comm_id} to legion ${S}`),v}catch(g){throw console.error("Failed to send comm:",g),g}}async function p(S){return console.log(`Minions for legion ${S} are already available in session store`),[]}async function d(S,y){try{const v=(await ke.post(`/api/legions/${S}/minions`,y)).minion;return await p(S),console.log(`Created minion ${v.minion_id} in legion ${S}`),v}catch(g){throw console.error("Failed to create minion:",g),g}}async function w(S){try{const y=await ke.post(`/api/legions/${S}/halt-all`);return console.log(`Halted ${y.halted_count} of ${y.total_minions} minions in legion ${S}`),y.failed_minions&&y.failed_minions.length>0&&console.warn("Failed to halt some minions:",y.failed_minions),y}catch(y){throw console.error("Failed to halt all minions:",y),y}}async function h(S){try{const y=await ke.post(`/api/legions/${S}/resume-all`);return console.log(`Resumed ${y.resumed_count} of ${y.total_minions} minions in legion ${S}`),y.failed_minions&&y.failed_minions.length>0&&console.warn("Failed to resume some minions:",y.failed_minions),y}catch(y){throw console.error("Failed to resume all minions:",y),y}}function $(S){n.value.delete(S),e.value.delete(S),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:a,setCurrentLegion:c,loadTimeline:u,addComm:f,sendComm:m,loadMinions:p,createMinion:d,haltAll:w,resumeAll:h,clearLegionData:$}}),Fp=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Wt},Symbol.toStringTag,{value:"Module"})),Bp={class:"timeline-header border-bottom p-3"},Vp={class:"project-name"},Wp=["title"],Up={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Ve(),o=_(()=>s.projects.get(e.legionId)),a=_(()=>o.value?.name||"Legion");return(c,u)=>(i(),r("div",Bp,[t("div",null,[t("div",Vp,b(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Wp)])]))}},Hp=se(Up,[["__scopeId","data-v-44f386f5"]]),qp={class:"timeline-status-bar border-top p-2 bg-light"},zp={class:"d-flex justify-content-end"},Kp={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=xe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(i(),r("div",qp,[t("div",zp,[t("button",{class:z(["btn btn-sm",le(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+b(le(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Gp=se(Kp,[["__scopeId","data-v-891c73db"]]),Yp={class:"comm-composer border-top p-3"},Jp={key:0,class:"d-flex gap-2 mb-2"},Qp={class:"flex-grow-1"},Xp=["disabled"],Zp={label:"Minions"},ev=["value"],tv={style:{"min-width":"150px"}},sv=["disabled"],nv={class:"d-flex gap-2 align-items-end position-relative"},ov={class:"flex-grow-1 position-relative"},av=["disabled"],iv=["onClick","onMouseenter"],lv=["disabled"],rv={key:0},cv={key:1},uv={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Wt(),o=pe(),a=Ve(),c=N(""),u=N("task"),f=N(""),m=N(!1),p=N(window.innerWidth),d=N(!1),w=N([]),h=N(0),$=N(-1),S=N(null),y=N(null),g=_(()=>p.value<768),v=_(()=>{const B=a.projects.get(e.legionId);return!B||!B.session_ids?[]:B.session_ids.map(V=>o.sessions.get(V)).filter(V=>V)}),l=_(()=>c.value&&f.value.trim().length>0);function k(B){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[B.state]||"â—‹"}function x(B){return B.role?`${B.name} (${B.role})`:B.name}function E(){const B=S.value;if(!B)return;B.style.height="auto";const V=Math.min(B.scrollHeight,parseInt(getComputedStyle(B).maxHeight));B.style.height=V+"px"}function O(){const B=S.value;if(!B)return;E();const V=f.value,U=B.selectionStart,J=V.substring(0,U),ae=J.lastIndexOf("#");if(ae===-1){d.value=!1;return}const L=J.substring(ae+1).toLowerCase();if(L.includes(" ")){d.value=!1;return}const j=v.value.filter(R=>R.name.toLowerCase().includes(L)).map(R=>({type:"minion",name:R.name,role:R.role,id:R.session_id,state:R.state}));if(j.length===0){d.value=!1;return}w.value=j,h.value=0,$.value=ae,d.value=!0}function A(){if(!y.value)return;const B=y.value,V=B.children[h.value];if(!V)return;const U=V.offsetTop,J=V.offsetHeight,ae=B.scrollTop,L=B.clientHeight;U<ae?B.scrollTop=U:U+J>ae+L&&(B.scrollTop=U+J-L)}function D(B){if(!d.value){if(B.key==="Enter"&&!B.shiftKey){if(g.value)return;l.value&&(B.preventDefault(),M())}return}if(B.key==="ArrowDown")B.preventDefault(),h.value=(h.value+1)%w.value.length,A();else if(B.key==="ArrowUp")B.preventDefault(),h.value=h.value===0?w.value.length-1:h.value-1,A();else if(B.key==="Enter"){B.preventDefault();const V=w.value[h.value];V&&C(V)}else B.key==="Escape"&&(d.value=!1)}function C(B){const V=S.value;if(!V)return;const U=f.value,J=V.selectionStart,ae=U.substring(0,$.value)+"#"+B.name+" "+U.substring(J);f.value=ae;const L=$.value+B.name.length+2;setTimeout(()=>{V.setSelectionRange(L,L),V.focus()},0),d.value=!1}async function M(){if(!(!l.value||m.value)){m.value=!0;try{const[B,V]=c.value.split(":"),U={comm_type:u.value,content:f.value.trim()};B==="minion"&&(U.to_minion_id=V),await s.sendComm(e.legionId,U),f.value="",E()}catch(B){console.error("Failed to send comm:",B),alert(`Failed to send comm: ${B.message}`)}finally{m.value=!1}}}function q(){p.value=window.innerWidth}return Me(()=>{window.addEventListener("resize",q)}),De(()=>{window.removeEventListener("resize",q)}),me(d,B=>{if(B){const V=U=>{U.target.closest(".comm-composer")||(d.value=!1,document.removeEventListener("click",V))};setTimeout(()=>document.addEventListener("click",V),0)}}),(B,V)=>(i(),r("div",Yp,[n.hideRecipientSelector?T("",!0):(i(),r("div",Jp,[t("div",Qp,[Se(t("select",{"onUpdate:modelValue":V[0]||(V[0]=U=>c.value=U),class:"form-select form-select-sm",disabled:m.value},[V[3]||(V[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",Zp,[(i(!0),r(ne,null,ce(v.value,U=>(i(),r("option",{key:U.session_id,value:`minion:${U.session_id}`},b(k(U))+" "+b(x(U)),9,ev))),128))])],8,Xp),[[Cn,c.value]])]),t("div",tv,[Se(t("select",{"onUpdate:modelValue":V[1]||(V[1]=U=>u.value=U),class:"form-select form-select-sm",disabled:m.value},[...V[4]||(V[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,sv),[[Cn,u.value]])])])),t("div",nv,[t("div",ov,[Se(t("textarea",{ref_key:"contentTextarea",ref:S,"onUpdate:modelValue":V[2]||(V[2]=U=>f.value=U),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:O,onKeydown:D},null,40,av),[[We,f.value]]),d.value?(i(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:y,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),r(ne,null,ce(w.value,(U,J)=>(i(),r("div",{key:U.id,class:z(["autocomplete-item px-2 py-1",{"bg-light":J===h.value}]),onClick:ae=>C(U),onMouseenter:ae=>h.value=J},b(U.type==="minion"?k(U):"#ï¸âƒ£")+" "+b(U.name)+b(U.role?` (${U.role})`:""),43,iv))),128))],512)):T("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!l.value||m.value,onClick:M},[m.value?(i(),r("span",rv,[...V[5]||(V[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ue(" Sending... ",-1)])])):(i(),r("span",cv,"Send"))],8,lv)])])]))}},dv=se(uv,[["__scopeId","data-v-e52b8e8f"]]),fv={class:"message-content-column-full"},mv=["aria-expanded"],pv={class:"comm-sender-recipient"},vv={class:"comm-badge-summary"},hv=["title"],_v={class:"comm-summary-text text-muted ms-2"},gv=["aria-label"],bv={key:0,class:"comm-content-body"},yv=["innerHTML"],wv="ffffffff-ffff-ffff-ffff-ffffffffffff",kv={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ke.setOptions({breaks:!0,gfm:!0});const s=N(!1);function o(){s.value=!s.value}const a=_(()=>e.comm.from_minion_id===wv),c=_(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),u=_(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),f=_(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),m=_(()=>{const p=e.comm.content||"";let d=Ke.parse(p);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),Vt.sanitize(d)});return(p,d)=>(i(),r("div",{class:z(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",fv,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",pv,[t("strong",{class:z({"system-sender":a.value})},b(n.senderName),3),n.recipientName?(i(),r(ne,{key:0},[d[0]||(d[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,b(n.recipientName),1)],64)):T("",!0)]),t("div",vv,[t("span",{class:z(["badge",u.value]),title:c.value},b(n.comm.comm_type),11,hv),t("span",_v,b(f.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},b(s.value?"â–¾":"â–¸"),9,gv)],8,mv),s.value?(i(),r("div",bv,[t("div",{class:"message-text",innerHTML:m.value},null,8,yv)])):T("",!0)])],2))}},$v=se(kv,[["__scopeId","data-v-28513f64"]]),Sv={class:"timeline-view d-flex flex-column h-100"},xv={key:0,class:"text-center text-muted"},Cv={key:1,class:"text-center text-danger"},Ev={key:2,class:"text-center text-muted"},Tv={key:3,class:"comm-list"},Av={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Wt();Ve();const o=pe(),a=rt(),c=xe(),u=N(!0),f=N(null),m=N(null),p=_(()=>s.currentComms);function d(g){return g.from_user?"You":g.from_minion_id?g.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(g.from_minion_id)?.name||"Unknown":"Unknown"}function w(g){return g.to_user?"You":g.to_minion_id?o.sessions.get(g.to_minion_id)?.name||"Unknown":"All"}async function h(){c.autoScrollEnabled&&(await dt(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function $(){u.value=!0,f.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await dt(),await h(),setTimeout(()=>{h()},100)}catch(g){console.error("Failed to load timeline:",g),g.response?f.value=`${g.message} (${g.response.status})`:f.value=g.message||"Unknown error"}finally{u.value=!1}}function S(){a.connectLegion(e.legionId)}function y(){a.disconnectLegion()}return me(()=>p.value.length,()=>{h()}),Me(()=>{o.currentSessionId=null,$(),S(),setTimeout(()=>{h()},100)}),De(()=>{y()}),(g,v)=>(i(),r("div",Sv,[be(Hp,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[u.value?(i(),r("div",xv,[...v[0]||(v[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ue(" Loading timeline... ",-1)])])):f.value?(i(),r("div",Cv," Failed to load timeline: "+b(f.value),1)):p.value.length===0?(i(),r("div",Ev," No messages yet. Minions will appear here once they start communicating. ")):(i(),r("div",Tv,[(i(!0),r(ne,null,ce(p.value,l=>(i(),Ce($v,{key:l.comm_id,comm:l,"sender-name":d(l),"recipient-name":w(l)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),be(dv,{"legion-id":n.legionId},null,8,["legion-id"]),be(Gp,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Dv=se(Av,[["__scopeId","data-v-b6752179"]]),Mv={class:"minion-info flex-grow-1"},Ov={class:"minion-name"},Nv={key:0,class:"me-1"},Lv={key:1,class:"badge bg-secondary ms-2"},Iv={key:0,class:"latest-activity text-muted"},jv={key:0,class:"activity-prefix"},Pv=["title"],Rv={key:1,class:"activity-time ms-1"},Fv={key:1,class:"latest-activity text-muted"},Bv={class:"activity-prefix"},Vv=["title"],Wv={key:2,class:"latest-activity text-muted fst-italic small"},Uv={class:"node-row"},Hv={class:"node-left"},qv={key:0,class:"me-2"},zv={key:1,class:"badge bg-secondary ms-2"},Kv={class:"node-right"},Gv={key:0,class:"latest-message-preview"},Yv={key:0,class:"message-prefix"},Jv=["title"],Qv={key:1,class:"message-time ms-1"},Xv={key:1,class:"last-comm-preview"},Zv={class:"comm-direction"},eh=["title"],th={key:2,class:"text-muted fst-italic small"},sh={class:"node-actions"},nh={key:2,class:"minion-children"},oh={key:1,class:"text-danger small ms-4"},ah={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,a=pe(),c=Pe(),u=xe(),f=_(()=>!s.minionData||!s.minionData.id?null:a.getSession(s.minionData.id)),m=_(()=>{if(!s.minionData||!s.minionData.id)return null;const C=c.messagesBySession.get(s.minionData.id);if(!C||C.length===0)return null;for(let M=C.length-1;M>=0;M--){const q=C[M],B=q.subtype||q.metadata?.subtype;if(q.type!=="result"&&!(q.type==="system"&&B==="init")&&!(q.type==="system"&&B==="task_notification")&&!(q.type==="permission_request"||q.type==="permission_response")){if(q.type==="user"&&q.metadata?.has_tool_results){const V=q.content||"";if(V.match(/^Tool results?: \d+ results?$/i)||V.trim()==="")continue}if(q.type==="user"){const V=q.content||"";if(V.includes("<command-message>")&&V.includes("skill is running")||V.startsWith("Base directory for this skill:"))continue}if(q.type==="user"){const V=q.content||"";if(V.includes("<command-message>")&&V.includes("<command-name>")&&V.includes("<command-args>")||V.includes("ARGUMENTS:")&&(V.includes("<command-name>")||V.match(/\nARGUMENTS:/)))continue}if(!(q.type==="system"&&q.content==="System message")&&!(q.type==="assistant"&&q.content==="Assistant response")&&(q.type==="user"||q.type==="assistant"||q.type==="system"))return{content:q.content,type:q.type,timestamp:q.timestamp}}}return null}),p=_(()=>{if(!s.minionData)return null;const C={...s.minionData};return f.value&&(C.state=f.value.state,C.is_processing=f.value.is_processing,f.value.name&&(C.name=f.value.name),f.value.latest_message&&(C.latest_message=f.value.latest_message,C.latest_message_type=f.value.latest_message_type,C.latest_message_time=f.value.latest_message_time)),m.value&&(C.latest_message=m.value.content,C.latest_message_type=m.value.type,C.latest_message_time=m.value.timestamp),C}),d=_(()=>s.level*24),w=_(()=>!s.minionData||!s.minionData.id?!1:a.currentSessionId===s.minionData.id),h=_(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),$=_(()=>s.minionData&&s.minionData.is_overseer&&h.value),S=_(()=>{const C=p.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),y=_(()=>{const C=S.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),g=_(()=>{const C=S.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),v=_(()=>{const C=p.value;if(!C||!C.latest_message_type)return"";const M=C.latest_message_type;return M==="user"?"User -->:":M==="system"?"System:":""}),l=_(()=>{const C=p.value;if(!C||!C.latest_message)return"";const M=C.latest_message,q=150;return M.length>q?M.slice(0,q)+"...":M}),k=_(()=>{const C=p.value;if(!C||!C.latest_message_time)return"";try{const M=Date.now();let q;if(typeof C.latest_message_time=="number"?q=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:q=new Date(C.latest_message_time).getTime(),isNaN(q)||q<9466848e5||q>M+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",q),"";const B=M-q;if(B<0)return"just now";const V=Math.floor(B/6e4),U=Math.floor(V/60),J=Math.floor(U/24);return J>0?`${J}d ago`:U>0?`${U}h ago`:V>0?`${V}m ago`:"just now"}catch(M){return console.error("Error calculating relative time:",M,C.latest_message_time),""}});function x(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function E(C){const M=C.summary||C.content||"";return M.length>150?M.substring(0,150)+"...":M}function O(){o("minion-click",s.minionData.id)}function A(){const C=a.sessions.get(s.minionData.id);C&&u.showModal("edit-session",{session:C})}function D(){const C=a.sessions.get(s.minionData.id);C&&u.showModal("manage-session",{session:C})}return(C,M)=>{const q=rn("MinionTreeNode",!0);return n.minionData?(i(),r("div",{key:0,class:"minion-tree-node",style:Ie({marginLeft:`${d.value}px`})},[n.layout==="sidebar"?(i(),r("div",{key:0,class:z(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:O},[t("div",{class:z(["status-dot me-2",y.value]),style:Ie(g.value)},null,6),t("div",Mv,[t("div",Ov,[$.value?(i(),r("span",Nv,"ðŸ‘‘")):T("",!0),t("strong",null,b(p.value?.name||n.minionData.name),1),$.value?(i(),r("span",Lv,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):T("",!0)]),p.value?.latest_message?(i(),r("div",Iv,[v.value?(i(),r("span",jv,b(v.value),1)):T("",!0),t("span",{class:"activity-content",title:p.value.latest_message},b(l.value),9,Pv),k.value?(i(),r("span",Rv,"("+b(k.value)+")",1)):T("",!0)])):n.minionData?.last_comm?(i(),r("div",Fv,[t("span",Bv,[M[1]||(M[1]=ue("â†’ ",-1)),t("strong",null,b(x(n.minionData.last_comm)),1),M[2]||(M[2]=ue(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},b(E(n.minionData.last_comm)),9,Vv)])):(i(),r("div",Wv," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ye(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ye(D,["stop"])}," âš™ï¸ ")],2)):(i(),r("div",{key:1,class:z(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:O},[t("div",Uv,[t("div",Hv,[t("div",{class:z(["status-dot me-2",y.value]),style:Ie(g.value)},null,6),$.value?(i(),r("span",qv,"ðŸ‘‘")):T("",!0),t("strong",null,b(p.value?.name||n.minionData.name),1),$.value?(i(),r("span",zv,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):T("",!0)]),t("div",Kv,[p.value?.latest_message?(i(),r("div",Gv,[v.value?(i(),r("span",Yv,b(v.value),1)):T("",!0),t("span",{class:"message-content",title:p.value.latest_message},b(l.value),9,Jv),k.value?(i(),r("span",Qv,"("+b(k.value)+")",1)):T("",!0)])):n.minionData?.last_comm?(i(),r("div",Xv,[t("span",Zv,[M[3]||(M[3]=ue("â†’ ",-1)),t("strong",null,b(x(n.minionData.last_comm)),1),M[4]||(M[4]=ue(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},b(E(n.minionData.last_comm)),9,eh)])):(i(),r("div",th," No activity yet "))]),t("div",sh,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ye(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ye(D,["stop"])}," âš™ï¸ ")])])],2)),h.value?(i(),r("div",nh,[(i(!0),r(ne,null,ce(n.minionData.children,B=>(i(),Ce(q,{key:B.id,"minion-data":B,level:n.level+1,layout:n.layout,onMinionClick:M[0]||(M[0]=V=>C.$emit("minion-click",V))},null,8,["minion-data","level","layout"]))),128))])):T("",!0)],4)):(i(),r("div",oh," âš  Minion data is missing "))}}},ih=se(ah,[["__scopeId","data-v-64b23e0e"]]),lh={class:"project-overview d-flex flex-column h-100"},rh={class:"project-overview-header border-bottom p-3"},ch={class:"d-flex align-items-center justify-content-between"},uh={class:"mb-1"},dh={key:0,class:"me-2"},fh={class:"text-muted font-monospace"},mh={class:"d-flex gap-2"},ph=["title"],vh={class:"project-overview-content flex-grow-1 overflow-auto p-3"},hh={key:0,class:"text-center py-5"},_h={key:1,class:"alert alert-danger"},gh={key:2,class:"text-center py-5"},bh={key:3},yh={class:"row g-3 mb-4"},wh={class:"col-md-4"},kh={class:"card h-100"},$h={class:"card-body"},Sh={class:"card-title mb-0"},xh={class:"text-muted"},Ch={class:"col-md-4"},Eh={class:"card h-100"},Th={class:"card-body"},Ah={class:"card-title mb-0"},Dh={class:"text-muted"},Mh={key:0,class:"card mb-4"},Oh={class:"card mb-4"},Nh={class:"card-header d-flex align-items-center justify-content-between"},Lh={class:"mb-0"},Ih={class:"badge bg-secondary"},jh={class:"card-body"},Ph={key:0,class:"text-center py-4"},Rh={key:1,class:"text-center text-muted py-4"},Fh={key:2,class:"hierarchy-tree"},Bh={class:"user-root-node mb-3 border rounded bg-white"},Vh={class:"node-row"},Wh={class:"node-left"},Uh={class:"badge bg-primary ms-2"},Hh={class:"node-right"},qh={key:0,class:"last-comm-preview"},zh={class:"comm-direction"},Kh=["title"],Gh={key:1,class:"text-muted fst-italic"},Yh={class:"root-minions ms-4"},Jh={class:"card"},Qh={class:"card-body"},Xh={class:"row mb-0"},Zh={class:"col-sm-8 font-monospace text-break"},e_={class:"col-sm-8 font-monospace text-break"},t_={class:"col-sm-8"},s_={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},n_={class:"text-muted"},o_={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Zt(),o=Ve(),a=pe(),c=xe(),u=Wt(),f=rt(),m=N(!1),p=N(null),d=N(null),w=N(!1);let h=null;const $=_(()=>o.getProject(e.projectId)),S=_(()=>$.value?.session_ids?$.value.session_ids.map(U=>a.getSession(U)).filter(U=>U!=null):[]),y=_(()=>S.value.length>0),g=_(()=>S.value.length),v=_(()=>S.value.filter(U=>U.state==="ACTIVE").length),l=_(()=>{const U=S.value.some(L=>L.state==="ACTIVE"),J=S.value.some(L=>L.is_processing);return S.value.some(L=>L.state==="ERROR")?"Error":J?"Working":U?"Active":g.value>0?"Idle":"Empty"}),k=_(()=>{switch(l.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),x=_(()=>{switch(l.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function E(){w.value=!0;try{const U=await ke.get(`/api/legions/${e.projectId}/hierarchy`);d.value=U}catch(U){console.error("Failed to load minion hierarchy:",U),d.value=null}finally{w.value=!1}}function O(U,J){if(U&&U.id===J)return U;if(U&&U.children)for(const ae of U.children){const L=O(ae,J);if(L)return L}return null}function A(U){return U.to_user?"User":U.to_minion_name?U.to_minion_name:"unknown"}function D(U){const J=U.summary||U.content||"";return J.length>150?J.substring(0,150)+"...":J}function C(U){if(d.value){if(U.from_minion_id){const J=O(d.value,U.from_minion_id);J&&J.type==="minion"&&(J.last_comm=U)}U.from_user&&d.value.type==="user"&&(d.value.last_comm=U)}}function M(U){s.push(`/session/${U}`)}function q(){s.push(`/timeline/${e.projectId}`)}function B(){c.showModal("edit-project",{project:$.value})}function V(){c.showModal("create-minion",{project:$.value})}return Me(()=>{o.selectProject(e.projectId),a.currentSessionId=null,E(),u.setCurrentLegion(e.projectId),f.connectLegion(e.projectId),h=me(()=>a.sessions,U=>{if(d.value){for(const[J,ae]of U)if(ae.project_id===e.projectId){const L=O(d.value,J);L&&L.type==="minion"&&(L.state!==ae.state&&(L.state=ae.state),L.is_processing!==ae.is_processing&&(L.is_processing=ae.is_processing),L.latest_message!==ae.latest_message&&(L.latest_message=ae.latest_message,L.latest_message_type=ae.latest_message_type,L.latest_message_time=ae.latest_message_time))}}},{deep:!0}),me(()=>u.commsByLegion.get(e.projectId),U=>{if(U&&U.length>0){const J=U[U.length-1];C(J)}},{deep:!0}),me(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(U,J)=>{U!==J&&E()})}),me(()=>e.projectId,U=>{o.selectProject(U),a.currentSessionId=null,E(),u.setCurrentLegion(U),f.connectLegion(U)}),De(()=>{h&&h()}),(U,J)=>(i(),r("div",lh,[t("div",rh,[t("div",ch,[t("div",null,[t("h4",uh,[y.value?(i(),r("span",dh,"ðŸ›")):T("",!0),ue(" "+b($.value?.name||"Project Overview"),1)]),t("small",fh,b($.value?.working_directory),1)]),t("div",mh,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:B}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:y.value?"Create minion":"Add session",onClick:V}," âž• "+b(y.value?"Add Minion":"Add Session"),9,ph)])])]),t("div",vh,[m.value?(i(),r("div",hh,[...J[0]||(J[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(i(),r("div",_h,b(p.value),1)):$.value?(i(),r("div",bh,[t("div",yh,[t("div",wh,[t("div",kh,[t("div",$h,[J[2]||(J[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",Sh,b(g.value),1),t("small",xh,b(v.value)+" active",1)])])]),t("div",Ch,[t("div",Eh,[t("div",Th,[J[3]||(J[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",Ah,[t("span",{class:z(k.value)},b(l.value),3)]),t("small",Dh,b(x.value),1)])])])]),y.value?(i(),r("div",Mh,[J[4]||(J[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:q}," ðŸ“Š View Timeline ")])])])):T("",!0),t("div",Oh,[t("div",Nh,[t("h5",Lh,"ðŸŒ³ "+b(y.value?"Minion Hierarchy":"Sessions"),1),t("span",Ih,b(S.value.length),1)]),t("div",jh,[w.value?(i(),r("div",Ph,[...J[5]||(J[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!d.value||!d.value.children||d.value.children.length===0?(i(),r("div",Rh,' No sessions yet. Click "Add Session" to create one. ')):(i(),r("div",Fh,[t("div",Bh,[t("div",Vh,[t("div",Wh,[J[6]||(J[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,b(d.value.name),1),t("span",Uh,b(d.value.children.length)+" "+b(d.value.children.length===1?"minion":"minions"),1)]),t("div",Hh,[d.value.last_comm?(i(),r("div",qh,[t("span",zh,[J[7]||(J[7]=ue(" â†’ ",-1)),t("strong",null,b(A(d.value.last_comm)),1),J[8]||(J[8]=ue(": ",-1))]),t("span",{class:"comm-content",title:d.value.last_comm.content||""},b(D(d.value.last_comm)),9,Kh)])):(i(),r("div",Gh," No communications yet "))])])]),t("div",Yh,[(i(!0),r(ne,null,ce(d.value.children,ae=>(i(),Ce(ih,{key:ae.id,"minion-data":ae,level:1,layout:"two-column",onMinionClick:M},null,8,["minion-data"]))),128))])]))])]),t("div",Jh,[J[12]||(J[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",Qh,[t("dl",Xh,[J[9]||(J[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",Zh,b($.value.working_directory),1),J[10]||(J[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",e_,b($.value.project_id),1),J[11]||(J[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",t_,b(y.value?"Yes (has minions)":"No"),1)])])])])):(i(),r("div",gh,[...J[1]||(J[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",s_,[J[13]||(J[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",n_,b(g.value)+" session"+b(g.value!==1?"s":""),1)])]))}},a_=se(o_,[["__scopeId","data-v-168bf04c"]]),i_=[{path:"/",name:"home",component:Ha},{path:"/project/:projectId",name:"project",component:a_,props:!0},{path:"/session/:sessionId",name:"session",component:Rp,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Dv,props:!0}],l_=Pa({history:Ra(),routes:i_}),r_={class:"header-row1"},c_={class:"header-right"},u_={__name:"HeaderRow1",setup(n){const e=xe(),s=rt(),o=_(()=>s.uiConnected);return(a,c)=>(i(),r("div",r_,[c[5]||(c[5]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",c_,[t("div",{class:z(["header-indicator",o.value?"connected":"disconnected"])},[c[3]||(c[3]=t("span",{class:"indicator-dot"},null,-1)),ue(" "+b(o.value?"Connected":"Disconnected"),1)],2),t("button",{class:z(["header-btn",{"theme-active":le(e).isRedBackground}]),onClick:c[0]||(c[0]=u=>le(e).toggleBackgroundColor()),title:"Toggle instance color"},[t("span",{class:"color-swatch",style:Ie({backgroundColor:le(e).isRedBackground?"#ef4444":"#94a3b8"})},null,4)],2),t("button",{class:"header-btn",onClick:c[1]||(c[1]=u=>le(e).showRestartModal()),title:"Restart server"}," â†» "),c[4]||(c[4]=t("button",{class:"header-btn",disabled:"",title:"Settings (coming soon)",style:{opacity:"0.4",cursor:"default"}}," âš™ ",-1)),t("button",{class:z(["header-btn panel-toggle-btn",{"panel-open":le(e).rightPanelVisible}]),onClick:c[2]||(c[2]=u=>le(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},d_=se(u_,[["__scopeId","data-v-36f4ea49"]]),f_=["title"],m_={class:"pill-icon"},p_={class:"pill-name"},v_={key:0,class:"pill-count"},h_={class:"pill-status-bar"},__={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=Ve(),o=pe(),a=xe(),c=_(()=>e.project.session_ids?.length||0),u=_(()=>c.value>1?"ðŸ”·":c.value===1?"ðŸ’¬":"ðŸ“"),f=_(()=>s.getStatusBarSegments(e.project.project_id,o));function m(){a.setBrowsingProject(e.project.project_id)}function p(){a.showModal("edit-project",{project:e.project})}return(d,w)=>(i(),r("div",{class:z(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:m,onContextmenu:ye(p,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",m_,b(u.value),1),t("span",p_,b(n.project.name),1),c.value>0?(i(),r("span",v_,b(c.value),1)):T("",!0),t("div",h_,[(i(!0),r(ne,null,ce(f.value,(h,$)=>(i(),r("div",{key:$,class:z(["seg",h.status]),style:Ie({flex:h.flex})},null,6))),128))])],42,f_))}},g_=se(__,[["__scopeId","data-v-0ff0ae55"]]),b_={class:"project-pill-bar"},y_={__name:"ProjectPillBar",setup(n){const e=Ve(),s=pe(),o=xe(),a=_(()=>e.orderedProjects),c=_(()=>o.browsingProjectId),u=_(()=>{const m=s.currentSession;return m?m.project_id:null});me(u,m=>{m&&o.setBrowsingProject(m)}),me(a,m=>{!c.value&&m.length>0&&o.setBrowsingProject(m[0].project_id)},{immediate:!0});function f(){o.showModal("create-project")}return(m,p)=>(i(),r("div",b_,[(i(!0),r(ne,null,ce(a.value,d=>(i(),Ce(g_,{key:d.project_id,project:d,isActive:d.project_id===u.value,isBrowsing:d.project_id===c.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:f,title:"New project"}," + ")]))}},w_=se(y_,[["__scopeId","data-v-6d2c68a7"]]),k_=["title"],$_={class:"ac-info"},S_={class:"ac-name"},x_={class:"ac-status"},C_={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select"],setup(n,{emit:e}){const s=n,o=e;pe();const a=_(()=>s.session.name||s.session.role||"Agent"),c=_(()=>{const d=s.session.state;return d==="error"?"error":d==="paused"?"waiting":d==="active"&&s.session.is_processing?"active":d==="active"?"idle":"none"}),u=_(()=>{const d=s.session.state;return d==="active"&&s.session.is_processing?"Processing...":d==="active"?"Idle":d==="paused"?"Awaiting input":d==="error"?"Error":d==="terminated"?"Stopped":d==="starting"?"Starting...":d==="created"?"Ready":d||"Unknown"}),f=_(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),m=_(()=>{const d=[a.value];return s.session.role&&d.push(`Role: ${s.session.role}`),d.push(`Status: ${u.value}`),s.session.model&&d.push(`Model: ${s.session.model}`),d.join(`
`)});function p(){o("select",s.session.session_id)}return(d,w)=>(i(),r("div",{class:z(["agent-chip",{active:n.isActive,child:n.variant==="child"}]),onClick:p,title:m.value},[t("div",{class:z(["ac-dot",c.value])},null,2),t("div",$_,[t("div",S_,b(a.value),1),t("div",x_,b(u.value),1)]),f.value?(i(),r("div",{key:0,class:z(["ac-alert",f.value])},b(f.value==="error"?"!":"?"),3)):T("",!0)],10,k_))}},Zs=se(C_,[["__scopeId","data-v-f9f7aad4"]]),E_=["title"],T_={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=pe(),o=_(()=>s.getSession(e.sessionId)),a=_(()=>({right:`${-16-e.index*14}px`})),c=_(()=>{if(!o.value)return"dot-none";const m=o.value.state;return m==="active"&&o.value.is_processing?"dot-active":m==="active"?"dot-idle":m==="paused"?"dot-waiting":m==="error"?"dot-error":"dot-none"}),u=_(()=>o.value?o.value.has_pending_permission||o.value.state==="error":!1),f=_(()=>o.value?o.value.state==="error"?"alert-error":"alert-permission":"");return(m,p)=>(i(),r("div",{class:"peek-card",style:Ie(a.value),title:o.value?.name||"Child agent",onClick:p[0]||(p[0]=ye(d=>m.$emit("click"),["stop"]))},[t("div",{class:z(["peek-dot",c.value])},null,2),u.value?(i(),r("div",{key:0,class:z(["peek-alert",f.value])},null,2)):T("",!0)],12,E_))}},A_=se(T_,[["__scopeId","data-v-06c8c352"]]),Fn=44,Bn=12,D_={__name:"ChipConnector",props:{depth:{type:Number,default:1},maxDepth:{type:Number,default:1}},setup(n){const e=n,s=Fn-Bn*2,o=_(()=>{const a=e.maxDepth;let c;if(a<=1)c=Fn/2;else{const u=(e.depth-1)/(a-1);c=Bn+u*s}return{alignSelf:"flex-start",marginTop:`${Math.round(c)}px`}});return(a,c)=>(i(),r("div",{class:"chip-connector",style:Ie(o.value)},null,4))}},M_=se(D_,[["__scopeId","data-v-08d20738"]]),O_=["title"],N_=Object.assign({name:"StackedChip"},{__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},depth:{type:Number,default:1},maxDepth:{type:Number,default:0}},emits:["select"],setup(n){const e=n,s=pe(),o=xe(),a=_(()=>s.currentSessionId),c=_(()=>e.session.child_minion_ids||[]);function u(v,l){if(!v?.child_minion_ids?.length)return l;let k=l;for(const x of v.child_minion_ids){const E=s.getSession(x);E&&(k=Math.max(k,u(E,l+1)))}return k}const f=_(()=>e.maxDepth>0?e.maxDepth:u(e.session,0)),m=_(()=>{if(!a.value)return!1;function v(l){if(!l)return!1;for(const k of l){if(k===a.value)return!0;const x=s.getSession(k);if(x?.child_minion_ids&&v(x.child_minion_ids))return!0}return!1}return v(c.value)}),p=_(()=>o.expandedStacks.has(e.session.session_id)||m.value),d=_(()=>c.value.slice(0,3)),w=_(()=>p.value||c.value.length===0?{}:{marginRight:`${Math.min(c.value.length,3)*14+4}px`});function h(v){return s.getSession(v)}function $(v){return s.getSession(v)?.child_minion_ids?.length>0}function S(v){const l=s.getSession(v);return l?.child_minion_ids?l.child_minion_ids.includes(a.value):!1}function y(){o.toggleStack(e.session.session_id)}function g(){p.value||o.toggleStack(e.session.session_id)}return(v,l)=>{const k=rn("StackedChip",!0);return i(),r("div",{class:"stacked-chip",style:Ie(w.value)},[t("div",{class:z(["parent-wrapper",{"has-children":c.value.length>0}])},[be(Zs,{session:n.session,isActive:n.isActive,onSelect:l[0]||(l[0]=x=>v.$emit("select",n.session.session_id)),onDblclick:y},null,8,["session","isActive"]),!p.value&&c.value.length>0?(i(!0),r(ne,{key:0},ce(d.value,(x,E)=>(i(),Ce(A_,{key:x,sessionId:x,index:E,onClick:g},null,8,["sessionId","index"]))),128)):T("",!0),c.value.length>0?(i(),r("div",{key:1,class:"stack-count",onClick:ye(y,["stop"]),title:`${c.value.length} child agent${c.value.length!==1?"s":""}`},b(c.value.length),9,O_)):T("",!0)],2),p.value?(i(!0),r(ne,{key:0},ce(c.value,x=>(i(),r(ne,{key:x},[be(M_,{depth:n.depth,maxDepth:f.value},null,8,["depth","maxDepth"]),h(x)&&$(x)?(i(),Ce(k,{key:0,session:h(x),isActive:x===a.value||S(x),depth:n.depth+1,maxDepth:f.value,onSelect:l[1]||(l[1]=E=>v.$emit("select",E))},null,8,["session","isActive","depth","maxDepth"])):h(x)?(i(),Ce(Zs,{key:1,session:h(x),isActive:x===a.value,variant:"child",onSelect:E=>v.$emit("select",x)},null,8,["session","isActive","onSelect"])):T("",!0)],64))),128)):T("",!0)],4)}}}),L_=se(N_,[["__scopeId","data-v-9cb915a6"]]),I_={class:"strip-project-label"},j_={key:0,class:"strip-empty"},P_={key:1,class:"agent-strip agent-strip-empty"},R_={__name:"AgentStrip",setup(n){const e=Ve(),s=pe(),o=xe(),a=Zt(),c=N(null);function u(v){c.value&&!c.value.contains(v.target)&&o.collapseAllStacks()}Me(()=>{document.addEventListener("click",u,!0)}),De(()=>{document.removeEventListener("click",u,!0)});const f=_(()=>s.currentSessionId),m=_(()=>{const v=o.browsingProjectId;return v?e.getProject(v):null}),p=_(()=>{const v=m.value;return!v||!v.session_ids?[]:v.session_ids.map(l=>s.getSession(l)).filter(Boolean).sort((l,k)=>(l.order||0)-(k.order||0))}),d=_(()=>{const v=new Set;for(const l of p.value)if(l.child_minion_ids)for(const k of l.child_minion_ids)v.add(k);return v}),w=_(()=>p.value.filter(v=>!d.value.has(v.session_id)));function h(v){return v.child_minion_ids&&v.child_minion_ids.length>0}function $(v){return v.child_minion_ids?v.child_minion_ids.includes(f.value):!1}function S(v){const l=s.getSession(v);l&&o.setBrowsingProject(l.project_id),s.selectSession(v),a.push(`/session/${v}`)}function y(v){v.target.classList.contains("agent-strip")&&o.collapseAllStacks()}function g(){const v=m.value;v&&o.showModal("create-minion",{project:v})}return(v,l)=>m.value?(i(),r("div",{key:0,class:"agent-strip",ref_key:"stripEl",ref:c,onClick:y},[t("span",I_,b(m.value.name),1),(i(!0),r(ne,null,ce(w.value,k=>(i(),r(ne,{key:k.session_id},[h(k)?(i(),Ce(L_,{key:0,session:k,isActive:k.session_id===f.value||$(k),onSelect:S},null,8,["session","isActive"])):(i(),Ce(Zs,{key:1,session:k,isActive:k.session_id===f.value,onSelect:S},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:ye(g,["stop"]),title:"Add agent"}," + "),w.value.length===0?(i(),r("span",j_,"No agents yet")):T("",!0)],512)):(i(),r("div",P_,[...l[0]||(l[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])]))}},F_=se(R_,[["__scopeId","data-v-8cd0887f"]]),un=lt("diff",()=>{const n=N(new Map),e=N(!1),s=N(null),o=N("total"),a=N(!1),c=N(null),u=N(null),f=N(null),m=N(new Map),p=_(()=>{const D=pe();return D.currentSessionId&&n.value.get(D.currentSessionId)||null}),d=_(()=>!p.value||!p.value.files?[]:Object.entries(p.value.files).map(([D,C])=>({path:D,...C})).sort((D,C)=>D.path.localeCompare(C.path))),w=_(()=>d.value.length),h=_(()=>!p.value||!p.value.commits?0:p.value.commits.length),$=_(()=>p.value?.is_git_repo===!0),S=_(()=>{if(!c.value||!u.value)return null;const D=f.value||"committed",C=`${c.value}:${D}:${u.value}`;return m.value.get(C)||null});async function y(D){if(D){e.value=!0,s.value=null;try{const C=await Qt(`/api/sessions/${D}/diff`);n.value.set(D,C),n.value=new Map(n.value)}catch(C){console.error(`Failed to load diff for session ${D}:`,C),s.value=C.message}finally{e.value=!1}}}async function g(D){for(const C of m.value.keys())C.startsWith(`${D}:`)&&m.value.delete(C);m.value=new Map(m.value),await y(D)}async function v(D,C,M=null){if(!D||!C)return;const B=`${D}:${M||"committed"}:${C}`,V=m.value.get(B);if(!(V&&!V.error&&V.content!==null)){m.value.set(B,{content:null,loading:!0,error:null}),m.value=new Map(m.value);try{const U={path:C};M&&(U.ref=M);const J=await Qt(`/api/sessions/${D}/diff/file`,{params:U});m.value.set(B,{content:J.diff,loading:!1,error:null})}catch(U){console.error(`Failed to load file diff for ${C}:`,U),m.value.set(B,{content:null,loading:!1,error:U.message})}m.value=new Map(m.value)}}function l(D,C,M=null){c.value=D,u.value=C,f.value=M,a.value=!0,v(D,C,M)}function k(){a.value=!1,f.value=null}function x(){if(!c.value)return;const D=d.value;if(D.length===0)return;const M=(D.findIndex(q=>q.path===u.value)+1)%D.length;u.value=D[M].path,v(c.value,u.value,f.value)}function E(){if(!c.value)return;const D=d.value;if(D.length===0)return;const M=(D.findIndex(q=>q.path===u.value)-1+D.length)%D.length;u.value=D[M].path,v(c.value,u.value,f.value)}function O(D){o.value=D}function A(D){n.value.delete(D),n.value=new Map(n.value);for(const C of m.value.keys())C.startsWith(`${D}:`)&&m.value.delete(C);m.value=new Map(m.value),c.value===D&&k()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:a,fullViewSessionId:c,currentFilePath:u,fullViewRef:f,fileDiffCache:m,currentDiff:p,currentFiles:d,fileCount:w,commitCount:h,isGitRepo:$,currentFullViewFileDiff:S,loadDiff:y,refreshDiff:g,loadFileDiff:v,openFullView:l,closeFullView:k,nextFile:x,prevFile:E,setMode:O,clearDiff:A}}),B_={key:0,class:"agent-overview"},V_={class:"overview-identity"},W_={class:"overview-info"},U_={class:"overview-name"},H_={key:0,class:"overview-role"},q_={class:"overview-stats"},z_={class:"stat-item"},K_={class:"stat-value"},G_={class:"stat-item"},Y_={class:"stat-value"},J_={class:"stat-item"},Q_={class:"stat-value"},X_={class:"stat-item"},Z_={class:"stat-value"},eg={key:1,class:"agent-overview agent-overview-empty"},tg={__name:"AgentOverview",setup(n){const e=pe(),s=Pe(),o=xe(),a=N(Date.now());let c=null;Me(()=>{c=setInterval(()=>{a.value=Date.now()},1e4)}),De(()=>{c&&clearInterval(c)});const u=_(()=>{const l=e.currentSessionId;return l?e.getSession(l):null}),f=_(()=>(u.value?.name||"A").charAt(0).toUpperCase()),m=_(()=>{const l=u.value?.name||"";let k=0;for(let E=0;E<l.length;E++)k=l.charCodeAt(E)+((k<<5)-k);return`hsl(${Math.abs(k%360)}, 60%, 55%)`}),p=_(()=>{if(!u.value)return"status-none";const l=u.value.state;return l==="active"&&u.value.is_processing?"status-active":l==="active"?"status-idle":l==="paused"?"status-waiting":l==="error"?"status-error":l==="terminated"?"status-terminated":"status-none"}),d=_(()=>{if(!u.value)return"None";const l=u.value.state;return l==="active"&&u.value.is_processing?"Processing":l==="active"?"Idle":l==="paused"?"Paused":l==="error"?"Error":l==="terminated"?"Terminated":l==="created"?"Created":l==="starting"?"Starting":l}),w=_(()=>{const l=e.currentSessionId;if(!l)return 0;const k=s.messagesBySession.get(l);return k?k.filter(x=>x.type==="user"||x.type==="assistant").length:0}),h=_(()=>{const l=e.currentSessionId;if(!l)return 0;const k=s.toolCallsBySession.get(l);return k?k.length:0}),$=_(()=>u.value&&u.value.child_minion_ids?.length||0),S=_(()=>{if(!u.value?.started_at)return"--";a.value;const l=new Date(u.value.started_at).getTime(),k=Date.now()-l;if(k<0)return"--";const x=Math.floor(k/6e4);if(x<60)return`${x}m`;const E=Math.floor(x/60);return E<24?`${E}h ${x%60}m`:`${Math.floor(E/24)}d ${E%24}h`});function y(){u.value&&o.showModal("edit-session",{session:u.value})}function g(){u.value&&o.showModal("manage-session",{session:u.value})}function v(){u.value&&o.showModal("session-info",{sessionId:u.value.session_id})}return(l,k)=>u.value?(i(),r("div",B_,[t("div",V_,[t("div",{class:"overview-avatar",style:Ie({background:m.value})},b(f.value),5),t("div",W_,[t("div",U_,b(u.value.name||"Agent"),1),u.value.role?(i(),r("div",H_,b(u.value.role),1)):T("",!0),t("span",{class:z(["overview-status-badge",p.value])},b(d.value),3)])]),t("div",q_,[t("div",z_,[t("span",K_,b(w.value),1),k[0]||(k[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",G_,[t("span",Y_,b(h.value),1),k[1]||(k[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",J_,[t("span",Q_,b($.value),1),k[2]||(k[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",X_,[t("span",Z_,b(S.value),1),k[3]||(k[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview btn-overview-primary",onClick:y,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:g,title:"Manage session lifecycle"}," Manage "),t("button",{class:"btn-overview",onClick:v,title:"View session details"}," Info ")])])):(i(),r("div",eg,[...k[4]||(k[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},sg=se(tg,[["__scopeId","data-v-1b177eab"]]),ng={class:"task-row d-flex align-items-center gap-2"},og={key:0,class:"status-icon"},ag={key:1,class:"status-icon"},ig=["title"],lg={key:0,class:"task-details"},rg={key:0,class:"task-description mb-2"},cg={class:"description-content"},ug={key:1,class:"task-owner mb-2"},dg={class:"ms-1"},fg={key:2,class:"task-blocked-by mb-2"},mg={key:3,class:"task-blocks"},pg={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=_(()=>e.task.status==="in_progress"),o=_(()=>e.task.status==="completed"?"âœ…":"â³"),a=_(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),c=_(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(u,f)=>(i(),r("div",{class:z(["task-item",c.value]),onClick:f[0]||(f[0]=m=>u.$emit("toggle"))},[t("div",ng,[s.value?(i(),r("span",og,[...f[1]||(f[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),r("span",ag,b(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},b(a.value),9,ig),(i(),r("svg",{class:z(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),r("div",lg,[n.task.description?(i(),r("div",rg,[f[3]||(f[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",cg,b(n.task.description),1)])):T("",!0),n.task.owner?(i(),r("div",ug,[f[4]||(f[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",dg,b(n.task.owner),1)])):T("",!0),n.task.blockedBy?.length>0?(i(),r("div",fg,[f[5]||(f[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),r(ne,null,ce(n.task.blockedBy,m=>(i(),r("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+b(m),1))),128))])):T("",!0),n.task.blocks?.length>0?(i(),r("div",mg,[f[6]||(f[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),r(ne,null,ce(n.task.blocks,m=>(i(),r("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+b(m),1))),128))])):T("",!0)])):T("",!0)],2))}},vg=se(pg,[["__scopeId","data-v-0f96ae87"]]),hg={class:"task-list-panel"},_g={class:"task-list p-2"},gg={key:0,class:"empty-placeholder"},bg={__name:"TaskListPanel",setup(n){const e=Nt(),s=N(new Set),o=_(()=>e.currentTasks);function a(c){s.value.has(c)?s.value.delete(c):s.value.add(c),s.value=new Set(s.value)}return(c,u)=>(i(),r("div",hg,[t("div",_g,[o.value.length===0?(i(),r("div",gg,[...u[0]||(u[0]=[t("span",null,"Tasks will appear here as the agent works",-1)])])):T("",!0),be(Fa,{name:"task-list",tag:"div"},{default:cn(()=>[(i(!0),r(ne,null,ce(o.value,f=>(i(),Ce(vg,{key:f.id,task:f,isExpanded:s.value.has(f.id),onToggle:m=>a(f.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},yg=se(bg,[["__scopeId","data-v-893d4ab0"]]),wg={class:"resource-gallery-panel"},kg={class:"resource-grid-container p-2"},$g={key:0,class:"empty-placeholder"},Sg={key:1,class:"resource-grid"},xg=["onClick"],Cg=["onClick","title"],Eg=["src","alt"],Tg=["title","onClick"],Ag={class:"file-icon"},Dg={class:"file-ext"},Mg={class:"resource-info"},Og=["title"],Ng={class:"resource-actions"},Lg=["onClick"],Ig=["href","download"],jg={__name:"ResourceGallery",setup(n){const e=Xe(),s=pe(),o=Co("addAttachmentFromResource",null),a=_(()=>e.currentResources);function c(y){return e.isImageResource(y)}function u(y){return e.getResourceIcon(y)}function f(y){const g=e.getResourceExtension(y);return g?g.toUpperCase().slice(1):""}function m(y){return e.getResourceUrl(s.currentSessionId,y)}function p(y){return e.getDownloadUrl(s.currentSessionId,y)}function d(y){e.openFullView(s.currentSessionId,y)}function w(y,g=18){return y?y.length<=g?y:y.substring(0,g-3)+"...":""}function h(y){y.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function $(y){e.removeResource(s.currentSessionId,y)}function S(y){o?o(y):console.warn("addAttachmentFromResource not provided")}return(y,g)=>(i(),r("div",wg,[t("div",kg,[a.value.length===0?(i(),r("div",$g,[...g[1]||(g[1]=[t("span",null,"Resources shared by the agent will appear here",-1)])])):(i(),r("div",Sg,[(i(!0),r(ne,null,ce(a.value,(v,l)=>(i(),r("div",{key:v.resource_id,class:z(["resource-item",{"is-image":c(v)}])},[t("button",{class:"remove-btn",onClick:ye(k=>$(v.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...g[2]||(g[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,xg),c(v)?(i(),r("div",{key:0,class:"resource-thumbnail",onClick:k=>d(l),title:v.title||"Click to view"},[t("img",{src:m(v.resource_id),alt:v.title||"Image",loading:"lazy",onError:h},null,40,Eg)],8,Cg)):(i(),r("div",{key:1,class:"resource-placeholder",title:v.title||v.original_filename||"Click to view",onClick:k=>d(l)},[t("span",Ag,b(u(v)),1),t("span",Dg,b(f(v)),1)],8,Tg)),t("div",Mg,[t("div",{class:"resource-title",title:v.title||v.original_filename},b(w(v.title||v.original_filename)),9,Og),t("div",Ng,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ye(k=>S(v),["stop"]),title:"Add to message attachments"},[...g[3]||(g[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,Lg),t("a",{href:p(v.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:v.original_filename||v.title||"download",title:"Download",onClick:g[0]||(g[0]=ye(()=>{},["stop"]))},[...g[4]||(g[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,Ig)])])],2))),128))]))])]))}},Pg=se(jg,[["__scopeId","data-v-5b14b073"]]),Rg=["src","alt"],Fg={key:1,class:"resource-info"},Bg={key:0,class:"resource-title"},Vg={key:1,class:"resource-description"},Wg={class:"resource-meta"},Ug={class:"meta-item"},Hg={class:"meta-item"},qg={class:"meta-item"},zg={class:"text-header"},Kg={class:"text-header-info"},Gg={class:"text-filename"},Yg={class:"resource-meta"},Jg={key:0,class:"meta-item"},Qg={key:1,class:"meta-item"},Xg={key:0,class:"display-mode-toggle"},Zg=["title","disabled"],eb={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},tb={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},sb={class:"copy-label"},nb={class:"text-body"},ob={key:0,class:"text-loading"},ab={key:1,class:"text-error"},ib={key:2,class:"text-content"},lb=["innerHTML"],rb={key:4,class:"text-unavailable"},cb={key:4,class:"position-indicator"},ub={key:5,class:"thumbnail-strip"},db=["onClick"],fb=["src","alt"],mb={key:1,class:"strip-text-icon"},pb={__name:"ResourceFullView",setup(n){Ke.setOptions({breaks:!0,gfm:!0});const e=Xe(),s=N(null),o=N(!1),a=N("raw");let c=null;const u=_(()=>e.fullViewOpen),f=_(()=>e.currentFullViewResource),m=_(()=>e.currentResourceIndex),p=_(()=>e.fullViewTotalResources),d=_(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),w=_(()=>e.isImageResource(f.value)),h=_(()=>f.value?e.getTextContent(f.value.resource_id):null),$=_(()=>h.value?.content||null),S=_(()=>h.value?.loading||!1),y=_(()=>h.value?.error||null),g=_(()=>{if(!$.value)return"";let B=Ke.parse($.value);return B=B.replace(/\n</g,"<"),B=B.replace(/\n+$/,""),Vt.sanitize(B)});me(u,B=>{B?(dt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),me(m,()=>{a.value="raw"}),me([m,u],()=>{if(u.value&&f.value&&!w.value){const B=f.value.resource_id,V=e.getTextContent(B);(!V||V.error)&&e.fetchTextContent(e.fullViewSessionId,B)}},{immediate:!0}),De(()=>{document.body.style.overflow="",c&&clearTimeout(c)});function v(B){return e.getResourceUrl(e.fullViewSessionId,B)}function l(){e.closeFullView()}function k(){e.nextResource()}function x(){e.prevResource()}function E(B){e.goToResource(B)}function O(B){B.target===B.currentTarget&&l()}function A(B){switch(B.key){case"Escape":l();break;case"ArrowLeft":x();break;case"ArrowRight":k();break;case"Home":E(0);break;case"End":E(p.value-1);break;case"m":!w.value&&$.value&&(a.value=a.value==="raw"?"markdown":"raw");break}}async function D(){if($.value)try{await navigator.clipboard.writeText($.value),o.value=!0,c&&clearTimeout(c),c=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function C(B){return B?B<1024?`${B} B`:B<1024*1024?`${(B/1024).toFixed(1)} KB`:`${(B/(1024*1024)).toFixed(2)} MB`:""}function M(B){return B?new Date(B*1e3).toLocaleString():""}function q(B){B.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(B,V)=>(i(),Ce(To,{to:"body"},[be(Eo,{name:"modal"},{default:cn(()=>[u.value?(i(),r("div",{key:0,class:"resource-full-view-overlay",onClick:O,onKeydown:A,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ye(l,["stop"]),title:"Close (Escape)"},[...V[4]||(V[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(i(),r("button",{key:0,class:"nav-btn nav-prev",onClick:ye(x,["stop"]),title:"Previous (Left Arrow)"},[...V[5]||(V[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):T("",!0),w.value?(i(),r("div",{key:1,class:"image-container",onClick:V[0]||(V[0]=ye(()=>{},["stop"]))},[f.value?(i(),r("img",{key:0,src:v(f.value.resource_id||f.value.image_id),alt:f.value.title||"Image",class:"full-image",onError:q},null,40,Rg)):T("",!0),f.value?(i(),r("div",Fg,[f.value.title?(i(),r("h5",Bg,b(f.value.title),1)):T("",!0),f.value.description?(i(),r("p",Vg,b(f.value.description),1)):T("",!0),t("div",Wg,[t("span",Ug,b(C(f.value.size_bytes)),1),t("span",Hg,b(f.value.format?.toUpperCase()),1),t("span",qg,b(M(f.value.timestamp)),1)])])):T("",!0)])):(i(),r("div",{key:2,class:"text-container",onClick:V[3]||(V[3]=ye(()=>{},["stop"]))},[t("div",zg,[t("div",Kg,[t("h5",Gg,b(f.value?.title||f.value?.original_filename||"Text Resource"),1),t("div",Yg,[f.value?.size_bytes?(i(),r("span",Jg,b(C(f.value.size_bytes)),1)):T("",!0),f.value?.format?(i(),r("span",Qg,b(f.value.format.toUpperCase()),1)):T("",!0)])]),$.value?(i(),r("div",Xg,[t("button",{class:z(["toggle-btn",{active:a.value==="raw"}]),onClick:V[1]||(V[1]=ye(U=>a.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:z(["toggle-btn",{active:a.value==="markdown"}]),onClick:V[2]||(V[2]=ye(U=>a.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):T("",!0),t("button",{class:"copy-btn",onClick:ye(D,["stop"]),title:o.value?"Copied!":a.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!$.value},[o.value?(i(),r("svg",eb,[...V[6]||(V[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),r("svg",tb,[...V[7]||(V[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",sb,b(o.value?"Copied!":a.value==="markdown"?"Copy raw":"Copy"),1)],8,Zg)]),t("div",nb,[S.value?(i(),r("div",ob,[...V[8]||(V[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):y.value?(i(),r("div",ab," Failed to load content: "+b(y.value),1)):$.value&&a.value==="raw"?(i(),r("pre",ib,b($.value),1)):$.value&&a.value==="markdown"?(i(),r("div",{key:3,class:"markdown-content",innerHTML:g.value},null,8,lb)):(i(),r("div",rb," Preview not available for this file type. "))])])),p.value>1?(i(),r("button",{key:3,class:"nav-btn nav-next",onClick:ye(k,["stop"]),title:"Next (Right Arrow)"},[...V[9]||(V[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):T("",!0),p.value>1?(i(),r("div",cb,b(m.value+1)+" / "+b(p.value),1)):T("",!0),p.value>1?(i(),r("div",ub,[(i(!0),r(ne,null,ce(d.value,(U,J)=>(i(),r("div",{key:U.resource_id||U.image_id,class:z(["strip-thumbnail",{active:J===m.value,"is-text":!le(e).isImageResource(U)}]),onClick:ye(ae=>E(J),["stop"])},[le(e).isImageResource(U)?(i(),r("img",{key:0,src:v(U.resource_id||U.image_id),alt:U.title||"Thumbnail",loading:"lazy"},null,8,fb)):(i(),r("span",mb,b(le(e).getResourceIcon(U)),1))],10,db))),128))])):T("",!0)],544)):T("",!0)]),_:1})]))}},vb=se(pb,[["__scopeId","data-v-169421b1"]]),hb={class:"diff-panel"},_b={class:"diff-body"},gb={key:0,class:"text-center py-4"},bb={key:1,class:"empty-placeholder"},yb={key:2,class:"empty-placeholder"},wb={key:3,class:"text-danger text-center py-4"},kb={class:"mb-0 small"},$b={key:4,class:"empty-placeholder"},Sb={key:5},xb={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},Cb=["disabled"],Eb={class:"stats-bar px-3 py-1 border-bottom small text-muted"},Tb={class:"text-success"},Ab={class:"text-danger"},Db={class:"ms-2"},Mb={key:0,class:"ms-2"},Ob={key:0,class:"file-list"},Nb=["onClick"],Lb=["title"],Ib={key:0,class:"file-stats small text-nowrap"},jb={key:0,class:"text-success"},Pb={key:1,class:"text-muted"},Rb={key:2,class:"text-danger"},Fb={key:1,class:"file-stats small text-muted"},Bb={key:1,class:"commit-list"},Vb=["onClick"],Wb={key:0,class:"wip-badge"},Ub={key:1,class:"commit-hash"},Hb=["title"],qb={key:2,class:"commit-date small text-muted text-nowrap"},zb={key:0,class:"commit-files"},Kb=["onClick"],Gb=["title"],Yb={key:6,class:"empty-placeholder"},Jb={__name:"DiffPanel",setup(n){const e=un(),s=pe(),o=N(new Set);function a(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function c(d,w=null){s.currentSessionId&&e.openFullView(s.currentSessionId,d,w)}function u(d){o.value.has(d)?o.value.delete(d):o.value.add(d),o.value=new Set(o.value)}function f(d){switch(d){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function m(d){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[d]?.status||"modified"}function p(d){if(!d)return"";const w=new Date(d),$=new Date-w,S=Math.floor($/6e4);if(S<1)return"just now";if(S<60)return`${S}m ago`;const y=Math.floor(S/60);return y<24?`${y}h ago`:`${Math.floor(y/24)}d ago`}return me(()=>s.currentSessionId,d=>{d&&!e.diffBySession.get(d)&&e.loadDiff(d)},{immediate:!0}),me(()=>e.currentDiff,d=>{if(d?.commits){const w=d.commits.find(h=>h.is_uncommitted);w&&(o.value.add(w.hash),o.value=new Set(o.value))}},{immediate:!0}),(d,w)=>(i(),r("div",hb,[t("div",_b,[le(e).loading&&!le(e).currentDiff?(i(),r("div",gb,[...w[2]||(w[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):le(e).currentDiff&&!le(e).isGitRepo?(i(),r("div",bb,[...w[3]||(w[3]=[t("span",null,"Not a git repository",-1)])])):le(e).currentDiff&&le(e).currentDiff.error?(i(),r("div",yb,[t("span",null,b(le(e).currentDiff.error),1)])):le(e).error?(i(),r("div",wb,[t("p",kb,b(le(e).error),1)])):le(e).currentDiff&&le(e).fileCount===0?(i(),r("div",$b,[...w[4]||(w[4]=[t("span",null,"No changes since main",-1)])])):le(e).currentDiff&&le(e).fileCount>0?(i(),r("div",Sb,[t("div",xb,[t("button",{class:z(["btn btn-sm",le(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:w[0]||(w[0]=h=>le(e).setMode("total"))}," Total Changes ",2),t("button",{class:z(["btn btn-sm",le(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:w[1]||(w[1]=h=>le(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:a,title:"Refresh diff",disabled:le(e).loading},[(i(),r("svg",{class:z({spin:le(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...w[5]||(w[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,Cb)]),t("div",Eb,[t("span",Tb,"+"+b(le(e).currentDiff.total_insertions),1),w[6]||(w[6]=t("span",{class:"mx-1"},"/",-1)),t("span",Ab,"-"+b(le(e).currentDiff.total_deletions),1),t("span",Db,b(le(e).fileCount)+" file"+b(le(e).fileCount!==1?"s":""),1),le(e).commitCount>0?(i(),r("span",Mb,b(le(e).commitCount)+" commit"+b(le(e).commitCount!==1?"s":""),1)):T("",!0)]),le(e).currentMode==="total"?(i(),r("div",Ob,[(i(!0),r(ne,null,ce(le(e).currentFiles,h=>(i(),r("div",{key:h.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:$=>c(h.path,"uncommitted")},[t("span",{class:z(["status-icon","status-"+h.status])},b(f(h.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:h.path},b(h.path),9,Lb),h.is_binary?(i(),r("span",Fb,"binary")):(i(),r("span",Ib,[h.insertions>0?(i(),r("span",jb,"+"+b(h.insertions),1)):T("",!0),h.insertions>0&&h.deletions>0?(i(),r("span",Pb,"/")):T("",!0),h.deletions>0?(i(),r("span",Rb,"-"+b(h.deletions),1)):T("",!0)]))],8,Nb))),128))])):(i(),r("div",Bb,[(i(!0),r(ne,null,ce(le(e).currentDiff.commits,h=>(i(),r("div",{key:h.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:$=>u(h.hash)},[(i(),r("svg",{class:z(["chevron-icon",{expanded:o.value.has(h.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...w[7]||(w[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),h.is_uncommitted?(i(),r("span",Wb,"WIP")):(i(),r("code",Ub,b(h.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:h.message},b(h.message),9,Hb),h.is_uncommitted?T("",!0):(i(),r("span",qb,b(p(h.date)),1))],8,Vb),o.value.has(h.hash)?(i(),r("div",zb,[(i(!0),r(ne,null,ce(h.files,$=>(i(),r("div",{key:$,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:S=>c($,h.is_uncommitted?"uncommitted":null)},[t("span",{class:z(["status-icon","status-"+m($)])},b(f(m($))),3),t("span",{class:"file-path text-truncate small",title:$},b($),9,Gb)],8,Kb))),128))])):T("",!0)]))),128))]))])):(i(),r("div",Yb,[...w[8]||(w[8]=[t("span",null,"No diff data available",-1)])]))])]))}},Qb=se(Jb,[["__scopeId","data-v-c74ae063"]]),Xb={class:"diff-header"},Zb={class:"diff-header-info"},ey={class:"diff-filename"},ty={class:"diff-meta"},sy={key:1,class:"meta-item"},ny={class:"text-success"},oy={class:"text-danger"},ay=["title","disabled"],iy={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ly={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ry={class:"copy-label"},cy={class:"diff-body"},uy={key:0,class:"diff-loading"},dy={key:1,class:"diff-error"},fy={key:2,class:"diff-content"},my={class:"diff-table"},py={class:"line-num line-num-old"},vy={class:"line-num line-num-new"},hy={class:"line-content"},_y={class:"line-prefix"},gy={key:3,class:"diff-empty"},by={key:2,class:"position-indicator"},yy={__name:"DiffFullView",setup(n){const e=un(),s=N(null),o=N(!1);let a=null;const c=_(()=>e.fullViewOpen),u=_(()=>e.currentFullViewFileDiff),f=_(()=>u.value?.content||null),m=_(()=>e.currentFiles.length),p=_(()=>e.currentFilePath?e.currentFiles.findIndex(v=>v.path===e.currentFilePath):0),d=_(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),w=_(()=>{if(!f.value)return[];const v=f.value.split(`
`),l=[];let k=0,x=0;for(const E of v){if(E.startsWith("diff --git")||E.startsWith("index ")||E.startsWith("---")||E.startsWith("+++")||E.startsWith("new file")||E.startsWith("deleted file")||E.startsWith("similarity")||E.startsWith("rename")||E.startsWith("Binary")){E.startsWith("Binary")&&l.push({type:"info",prefix:"",text:E,oldNum:null,newNum:null});continue}if(E.startsWith("@@")){const O=E.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);O&&(k=parseInt(O[1]),x=parseInt(O[2]),l.push({type:"hunk",prefix:"",text:E,oldNum:null,newNum:null}));continue}E.startsWith(" ")||E.length>0&&!E.startsWith("+")&&!E.startsWith("-")&&!E.startsWith("\\")?(l.push({type:"context",prefix:" ",text:E.substring(1),oldNum:k,newNum:x}),k++,x++):E.startsWith("+")?(l.push({type:"add",prefix:"+",text:E.substring(1),oldNum:null,newNum:x}),x++):E.startsWith("-")?(l.push({type:"remove",prefix:"-",text:E.substring(1),oldNum:k,newNum:null}),k++):E.startsWith("\\")&&l.push({type:"info",prefix:"",text:E,oldNum:null,newNum:null})}return l});function h(v){return`diff-line diff-line-${v.type}`}function $(){e.closeFullView()}function S(v){v.target===v.currentTarget&&$()}function y(v){switch(v.key){case"Escape":$();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function g(){if(f.value)try{await navigator.clipboard.writeText(f.value),o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return me(c,v=>{v?(dt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),De(()=>{document.body.style.overflow="",a&&clearTimeout(a)}),(v,l)=>(i(),Ce(To,{to:"body"},[be(Eo,{name:"modal"},{default:cn(()=>[c.value?(i(),r("div",{key:0,class:"diff-full-view-overlay",onClick:S,onKeydown:y,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ye($,["stop"]),title:"Close (Escape)"},[...l[3]||(l[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(i(),r("button",{key:0,class:"nav-btn nav-prev",onClick:l[0]||(l[0]=ye(k=>le(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...l[4]||(l[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):T("",!0),t("div",{class:"diff-container",onClick:l[1]||(l[1]=ye(()=>{},["stop"]))},[t("div",Xb,[t("div",Zb,[t("h5",ey,b(le(e).currentFilePath),1),t("div",ty,[d.value?(i(),r("span",{key:0,class:z(["meta-badge","status-"+d.value.status])},b(d.value.status),3)):T("",!0),d.value&&!d.value.is_binary?(i(),r("span",sy,[t("span",ny,"+"+b(d.value.insertions),1),l[5]||(l[5]=ue(" / ",-1)),t("span",oy,"-"+b(d.value.deletions),1)])):T("",!0)])]),t("button",{class:"copy-btn",onClick:ye(g,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!f.value},[o.value?(i(),r("svg",iy,[...l[6]||(l[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),r("svg",ly,[...l[7]||(l[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",ry,b(o.value?"Copied!":"Copy"),1)],8,ay)]),t("div",cy,[u.value&&u.value.loading?(i(),r("div",uy,[...l[8]||(l[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):u.value&&u.value.error?(i(),r("div",dy," Failed to load diff: "+b(u.value.error),1)):f.value?(i(),r("div",fy,[t("table",my,[t("tbody",null,[(i(!0),r(ne,null,ce(w.value,(k,x)=>(i(),r("tr",{key:x,class:z(h(k))},[t("td",py,b(k.oldNum||""),1),t("td",vy,b(k.newNum||""),1),t("td",hy,[t("span",_y,b(k.prefix),1),t("span",null,b(k.text),1)])],2))),128))])])])):(i(),r("div",gy," No diff available for this file. "))])]),m.value>1?(i(),r("button",{key:1,class:"nav-btn nav-next",onClick:l[2]||(l[2]=ye(k=>le(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...l[9]||(l[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):T("",!0),m.value>1?(i(),r("div",by,b(p.value+1)+" / "+b(m.value),1)):T("",!0)],544)):T("",!0)]),_:1})]))}},wy=se(yy,[["__scopeId","data-v-d13809ae"]]),ky={class:"comms-panel"},$y={key:0,class:"empty-placeholder"},Sy={class:"comm-meta"},xy={class:"comm-icon"},Cy={class:"comm-type"},Ey={class:"comm-direction"},Ty={class:"comm-time"},Ay={class:"comm-summary"},Dy=["onClick"],My={class:"expand-label"},Oy=["innerHTML"],Ny="ffffffff-ffff-ffff-ffff-ffffffffffff",Ly="00000000-0000-0000-0000-000000000000",Iy={__name:"CommsPanel",setup(n){const e=pe(),s=Wt(),o=rt(),a=N(null),c=N(new Set);let u=null;Ke.setOptions({breaks:!0,gfm:!0});const f=_(()=>e.currentSession?.project_id||null),m=_(()=>e.currentSessionId),p=_(()=>f.value?s.commsByLegion.get(f.value)||[]:[]),d=[{bg:"#fef3c7",border:"#fde68a"},{bg:"#fce7f3",border:"#fbcfe8"},{bg:"#e0e7ff",border:"#c7d2fe"},{bg:"#d1fae5",border:"#a7f3d0"},{bg:"#ede9fe",border:"#ddd6fe"},{bg:"#fee2e2",border:"#fecaca"},{bg:"#cffafe",border:"#a5f3fc"},{bg:"#fef9c3",border:"#fef08a"}],w=new Map;function h(E){if(!E)return null;if(w.has(E))return w.get(E);let O=0;for(let C=0;C<E.length;C++)O=(O<<5)-O+E.charCodeAt(C)|0;const A=Math.abs(O)%d.length,D=d[A];return w.set(E,D),D}function $(E){const O=E.from_minion_id;if(O===Ny)return{background:"#f1f5f9",borderColor:"#e2e8f0",opacity:.8};if(E.from_user||O===Ly)return{background:"#eef2ff",borderColor:"#e0e7ff"};if(O===m.value)return{background:"#f8fafc",borderColor:"#e2e8f0"};const A=h(O);return A?{background:A.bg,borderColor:A.border}:{background:"#f8fafc",borderColor:"#e2e8f0"}}function S(E){return{task:"ðŸ“‹",question:"â“",report:"ðŸ“Š",info:"ðŸ’¡",system:"âš™ï¸",halt:"ðŸ›‘",pivot:"ðŸ›‘",spawn:"ðŸŒŸ",dispose:"ðŸ—‘ï¸",thought:"ðŸ’­"}[E]||"ðŸ’¬"}function y(E){return E?E.charAt(0).toUpperCase()+E.slice(1):""}function g(E){const O=E.from_minion_name||(E.from_user?"User":"System"),A=E.to_minion_name||(E.to_user?"User":"Unknown");return`${O} â†’ ${A}`}function v(E,O){return E?E.length<=O?E:E.substring(0,O)+"...":""}function l(E){c.value.has(E)?c.value.delete(E):c.value.add(E),c.value=new Set(c.value)}function k(E){if(!E)return"";let O=Ke.parse(E);return O=O.replace(/\n</g,"<"),O=O.replace(/\n+$/,""),Vt.sanitize(O)}me(()=>p.value.length,async()=>{await dt(),a.value&&(a.value.scrollTop=a.value.scrollHeight)});function x(E){E&&u!==E&&(u&&o.disconnectLegion(),u=E,s.setCurrentLegion(E),s.loadTimeline(E),o.connectLegion(E))}return me(f,E=>{E&&x(E)},{immediate:!0}),Me(()=>{f.value&&x(f.value)}),De(()=>{u&&(o.disconnectLegion(),u=null)}),(E,O)=>(i(),r("div",ky,[p.value.length===0?(i(),r("div",$y,[...O[0]||(O[0]=[t("span",null,"Communication between this session's minions will appear here",-1)])])):(i(),r("div",{key:1,class:"comms-list",ref_key:"commsList",ref:a},[(i(!0),r(ne,null,ce(p.value,A=>(i(),r("div",{key:A.comm_id,class:"comm-item",style:Ie($(A))},[t("div",Sy,[t("span",xy,b(S(A.comm_type)),1),t("span",Cy,b(y(A.comm_type)),1),t("span",Ey,b(g(A)),1),t("span",Ty,b(le(es)(A.timestamp)),1)]),t("div",Ay,b(A.summary||v(A.content,120)),1),A.content&&A.content!==A.summary?(i(),r("div",{key:0,class:"comm-expand",onClick:D=>l(A.comm_id)},[t("span",{class:z(["expand-chevron",{expanded:c.value.has(A.comm_id)}])},"â–¶",2),t("span",My,b(c.value.has(A.comm_id)?"Hide details":"Show details"),1)],8,Dy)):T("",!0),c.value.has(A.comm_id)?(i(),r("div",{key:1,class:"comm-content",innerHTML:k(A.content)},null,8,Oy)):T("",!0)],4))),128))],512))]))}},jy=se(Iy,[["__scopeId","data-v-9d206479"]]),Py={class:"sidebar-tabs"},Ry=["onClick"],Fy={key:0,class:"tab-badge"},By={class:"tab-content-container"},Vy={__name:"RightSidebar",setup(n){const e=xe(),s=Nt(),o=Xe(),a=un(),c=Wt(),u=pe(),f=_(()=>e.rightSidebarActiveTab),m=_(()=>s.currentTaskStats),p=_(()=>o.currentResourceCount),d=_(()=>a.fileCount),w=_(()=>{const k=u.currentSession?.project_id;return k?(c.commsByLegion.get(k)||[]).length:0}),h=_(()=>[{id:"diff",label:"Diff",badge:d.value},{id:"tasks",label:"Tasks",badge:m.value.total>0?m.value.total:0},{id:"resources",label:"Resources",badge:p.value},{id:"comms",label:"Comms",badge:w.value}]),$=_(()=>e.windowWidth<=1024),S=_(()=>$.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),y=N(!1);function g(k){k.preventDefault(),y.value=!0,document.addEventListener("mousemove",v),document.addEventListener("mouseup",l)}function v(k){if(y.value){const x=window.innerWidth-k.clientX;e.setRightSidebarWidth(x)}}function l(){y.value=!1,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",l)}return(k,x)=>(i(),r("aside",{id:"right-sidebar",class:z(["right-sidebar",{resizing:y.value,"theme-red-panel":le(e).isRedBackground}]),style:Ie(S.value)},[be(sg),t("div",Py,[(i(!0),r(ne,null,ce(h.value,E=>(i(),r("button",{key:E.id,class:z(["sidebar-tab",{active:f.value===E.id}]),onClick:O=>le(e).setRightSidebarTab(E.id)},[ue(b(E.label)+" ",1),E.badge>0?(i(),r("span",Fy,b(E.badge),1)):T("",!0)],10,Ry))),128))]),t("div",By,[Se(be(Qb,null,null,512),[[nt,f.value==="diff"]]),Se(be(yg,null,null,512),[[nt,f.value==="tasks"]]),Se(be(Pg,null,null,512),[[nt,f.value==="resources"]]),Se(be(jy,null,null,512),[[nt,f.value==="comms"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:g},null,32),be(vb),be(wy)],6))}},Wy=se(Vy,[["__scopeId","data-v-d7faa1fb"]]),Uy={class:"modal-dialog modal-lg"},Hy={class:"modal-content"},qy={class:"modal-body"},zy={class:"mb-3"},Ky={class:"input-group"},Gy=["disabled"],Yy={key:0,class:"text-center py-4"},Jy={key:1,class:"alert alert-danger",role:"alert"},Qy={key:2,class:"folder-list"},Xy=["onClick","onDblclick"],Zy={class:"d-flex align-items-center flex-grow-1"},e1=["onClick"],t1={key:1,class:"text-center text-muted py-3"},s1={class:"modal-footer"},n1=["disabled"],o1={__name:"FolderBrowserModal",setup(n){const e=xe(),s=N(""),o=N(""),a=N([]),c=N(!1),u=N(""),f=N(null);let m=null,p=null;const d=_(()=>{if(!s.value)return null;const k=s.value.split(/[\\/]/).filter(Boolean);return k.length<=1?null:(k.pop(),k.length>0?"/"+k.join("/"):"/")});function w(k){if(!k)return"";const x=k.split(/[\\/]/).filter(Boolean);return x.length<=2?k:".../"+x.slice(-2).join("/")}async function h(){c.value=!0,u.value="",a.value=[],o.value="";try{const k=s.value?{path:s.value}:{},x=await ke.get("/api/filesystem/browse",{params:k});x.current_path&&(s.value=x.current_path),a.value=x.directories||[]}catch(k){console.error("Failed to load directory:",k),u.value=k.message||"Failed to load directory"}finally{c.value=!1}}function $(k){o.value=k.path}function S(k){s.value=k.path,o.value="",h()}function y(){d.value&&(s.value=d.value,o.value="",h())}function g(){const k=o.value||s.value;k&&p&&p(k),m&&m.hide()}function v(){h()}function l(){a.value=[],o.value="",u.value="",p=null,e.hideModal()}return me(()=>e.currentModal,k=>{if(k?.name==="folder-browser"&&m){const x=k.data||{};s.value=x.defaultPath||x.currentPath||"",p=x.onSelect||null,m.show()}}),Me(()=>{f.value&&je(async()=>{const{default:k}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{m=new k(f.value),f.value.addEventListener("shown.bs.modal",v),f.value.addEventListener("hidden.bs.modal",l)})}),De(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",v),f.value.removeEventListener("hidden.bs.modal",l)),m&&m.dispose()}),(k,x)=>(i(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[t("div",Uy,[t("div",Hy,[x[6]||(x[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",qy,[t("div",zy,[x[1]||(x[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Ky,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=E=>s.value=E),onKeyup:hs(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:c.value}," ðŸ”„ Refresh ",8,Gy)])]),c.value?(i(),r("div",Yy,[...x[2]||(x[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):u.value?(i(),r("div",Jy,b(u.value),1)):(i(),r("div",Qy,[d.value?(i(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:y,role:"button"},[...x[3]||(x[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):T("",!0),(i(!0),r(ne,null,ce(a.value,E=>(i(),r("div",{key:E.path,class:z(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:E.path===o.value}]),onClick:O=>$(E),onDblclick:O=>S(E),role:"button"},[t("div",Zy,[x[4]||(x[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,b(E.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ye(O=>S(E),["stop"])}," Open ",8,e1)],42,Xy))),128)),a.value.length===0?(i(),r("div",t1," No subdirectories found ")):T("",!0)]))]),t("div",s1,[x[5]||(x[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:!o.value},' Select "'+b(w(o.value||s.value))+'" ',9,n1)])])])],512))}},a1=se(o1,[["__scopeId","data-v-0d61ed46"]]),i1={class:"modal-dialog"},l1={class:"modal-content"},r1={class:"modal-body"},c1={class:"mb-3"},u1={key:0,class:"invalid-feedback"},d1={class:"mb-3"},f1={class:"input-group"},m1={key:0,class:"invalid-feedback"},p1={class:"mb-3 form-check"},v1={key:0,class:"mb-3 ms-4"},h1={key:1,class:"alert alert-danger",role:"alert"},_1={class:"modal-footer"},g1=["disabled"],b1={key:0,class:"spinner-border spinner-border-sm me-2"},y1={__name:"ProjectCreateModal",setup(n){const e=Ve(),s=pe(),o=xe(),a=N({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),c=N({name:"",workingDirectory:""}),u=N(!1),f=N(""),m=N(null);let p=null;function d(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:g=>{a.value.workingDirectory=g,c.value.workingDirectory=""}})}function w(){c.value={};let g=!0;return a.value.name.trim()||(c.value.name="Project name is required",g=!1),a.value.workingDirectory.trim()||(c.value.workingDirectory="Working directory is required",g=!1),g}async function h(){if(w()){u.value=!0,f.value="";try{const g=await e.createProject(a.value.name,a.value.workingDirectory);a.value.createSession&&await s.createSession(g.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),$()}catch(g){console.error("Failed to create project:",g),f.value=g.message||"Failed to create project. Please try again."}finally{u.value=!1}}}function $(){a.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},c.value={},f.value=""}function S(){const g=document.getElementById("projectName");g&&g.focus()}function y(){$(),o.hideModal()}return me(()=>o.currentModal,g=>{g?.name==="create-project"&&p&&p.show()}),Me(()=>{m.value&&je(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(v=>v.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{p=new g(m.value),m.value.addEventListener("shown.bs.modal",S),m.value.addEventListener("hidden.bs.modal",y)})}),De(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",S),m.value.removeEventListener("hidden.bs.modal",y)),p&&p.dispose()}),(g,v)=>(i(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",i1,[t("div",l1,[v[11]||(v[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",r1,[t("form",{onSubmit:ye(h,["prevent"])},[t("div",c1,[v[4]||(v[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),Se(t("input",{type:"text",class:z(["form-control",{"is-invalid":c.value.name}]),id:"projectName","onUpdate:modelValue":v[0]||(v[0]=l=>a.value.name=l),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),c.value.name?(i(),r("div",u1,b(c.value.name),1)):T("",!0)]),t("div",d1,[v[5]||(v[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",f1,[Se(t("input",{type:"text",class:z(["form-control",{"is-invalid":c.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":v[1]||(v[1]=l=>a.value.workingDirectory=l),placeholder:"/path/to/project",required:""},null,2),[[We,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:d}," Browse... "),c.value.workingDirectory?(i(),r("div",m1,b(c.value.workingDirectory),1)):T("",!0)]),v[6]||(v[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",p1,[Se(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":v[2]||(v[2]=l=>a.value.createSession=l)},null,512),[[xo,a.value.createSession]]),v[7]||(v[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),v[8]||(v[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),a.value.createSession?(i(),r("div",v1,[v[9]||(v[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),Se(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":v[3]||(v[3]=l=>a.value.sessionName=l),placeholder:"main"},null,512),[[We,a.value.sessionName]])])):T("",!0),f.value?(i(),r("div",h1,b(f.value),1)):T("",!0)],32)]),t("div",_1,[v[10]||(v[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:u.value},[u.value?(i(),r("span",b1)):T("",!0),ue(" "+b(u.value?"Creating...":"Create Project"),1)],8,g1)])])])],512))}},w1=se(y1,[["__scopeId","data-v-ea55fdae"]]),k1={class:"modal-dialog"},$1={class:"modal-content"},S1={class:"modal-body"},x1={class:"mb-3"},C1={key:0,class:"invalid-feedback"},E1={class:"mb-3"},T1=["value"],A1={key:0,class:"alert alert-danger",role:"alert"},D1={class:"danger-zone"},M1={class:"text-muted small"},O1=["disabled"],N1={key:0,class:"alert alert-warning mt-3",role:"alert"},L1={class:"mb-2"},I1={class:"d-flex gap-2"},j1=["disabled"],P1={key:0,class:"spinner-border spinner-border-sm me-2"},R1=["disabled"],F1={class:"modal-footer"},B1=["disabled"],V1={key:0,class:"spinner-border spinner-border-sm me-2"},W1={__name:"ProjectEditModal",setup(n){const e=Ve(),s=xe(),o=N(null),a=N({name:""}),c=N({name:""}),u=N(!1),f=N(!1),m=N(""),p=N(!1),d=N(null);let w=null;const h=_(()=>o.value?.session_ids?.length||0);function $(){c.value={};let k=!0;return a.value.name.trim()||(c.value.name="Project name is required",k=!1),k}async function S(){if(!(!$()||!o.value)){u.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),w&&w.hide()}catch(k){console.error("Failed to update project:",k),m.value=k.message||"Failed to update project. Please try again."}finally{u.value=!1}}}async function y(){if(o.value){f.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(k){console.error("Failed to delete project:",k),m.value=k.message||"Failed to delete project. Please try again."}finally{f.value=!1}}}function g(){a.value={name:""},c.value={},m.value="",p.value=!1}function v(){const k=document.getElementById("editProjectName");k&&(k.focus(),k.select())}function l(){g(),o.value=null,s.hideModal()}return me(()=>s.currentModal,k=>{if(k?.name==="edit-project"&&w){const x=k.data||{};o.value=x.project,o.value&&(a.value.name=o.value.name),w.show()}}),Me(()=>{d.value&&je(async()=>{const{default:k}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{w=new k(d.value),d.value.addEventListener("shown.bs.modal",v),d.value.addEventListener("hidden.bs.modal",l)})}),De(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",v),d.value.removeEventListener("hidden.bs.modal",l)),w&&w.dispose()}),(k,x)=>(i(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",k1,[t("div",$1,[x[10]||(x[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",S1,[t("form",{onSubmit:ye(S,["prevent"])},[t("div",x1,[x[3]||(x[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),Se(t("input",{type:"text",class:z(["form-control",{"is-invalid":c.value.name}]),id:"editProjectName","onUpdate:modelValue":x[0]||(x[0]=E=>a.value.name=E),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),c.value.name?(i(),r("div",C1,b(c.value.name),1)):T("",!0)]),t("div",E1,[x[4]||(x[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,T1),x[5]||(x[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(i(),r("div",A1,b(m.value),1)):T("",!0)],32),x[8]||(x[8]=t("hr",null,null,-1)),t("div",D1,[x[6]||(x[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",M1," Deleting this project will also delete all "+b(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x[1]||(x[1]=E=>p.value=!0),disabled:f.value}," ðŸ—‘ï¸ Delete Project ",8,O1)]),p.value?(i(),r("div",N1,[x[7]||(x[7]=t("strong",null,"Are you sure?",-1)),t("p",L1,' This will permanently delete the project "'+b(o.value?.name)+'" and all '+b(h.value)+" session(s). ",1),t("div",I1,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:y,disabled:f.value},[f.value?(i(),r("span",P1)):T("",!0),ue(" "+b(f.value?"Deleting...":"Yes, Delete Permanently"),1)],8,j1),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:x[2]||(x[2]=E=>p.value=!1),disabled:f.value}," Cancel ",8,R1)])])):T("",!0)]),t("div",F1,[x[9]||(x[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:S,disabled:u.value},[u.value?(i(),r("span",V1)):T("",!0),ue(" "+b(u.value?"Saving...":"Save Changes"),1)],8,B1)])])])],512))}},U1=se(W1,[["__scopeId","data-v-52679516"]]),H1={class:"general-tab"},q1={key:0,class:"mb-3"},z1={for:"template-select",class:"form-label"},K1=["value"],G1=["value"],Y1={key:0,class:"form-text"},J1={class:"mb-3"},Q1={for:"config-name",class:"form-label"},X1=["value","placeholder","pattern","title"],Z1={key:0,class:"invalid-feedback"},ew={key:1,class:"form-text"},tw={key:1,class:"mb-3"},sw=["value"],nw={class:"mb-3"},ow=["value"],aw={class:"form-text"},iw={key:0},lw={class:"mb-3"},rw={for:"config-permission-mode",class:"form-label"},cw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},uw={key:1,class:"field-indicator modified",title:"Modified from template"},dw=["value","disabled"],fw={key:0,value:"bypassPermissions"},mw={class:"form-text"},pw={key:0,class:"text-warning"},vw={key:1},hw={class:"mb-3"},_w={for:"config-role",class:"form-label"},gw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},bw={key:1,class:"field-indicator modified",title:"Modified from template"},yw=["value","placeholder"],ww={class:"form-text"},kw={key:2,class:"mb-3"},$w={class:"input-group"},Sw=["value","placeholder","disabled","readonly"],xw={class:"form-text"},Cw={key:3,class:"mb-3"},Ew={class:"form-control-plaintext"},Tw={key:4,class:"mb-3 form-check"},Aw=["checked"],Dw={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=_(()=>e.mode==="create-session"||e.mode==="edit-session"),o=_(()=>e.mode==="create-template"||e.mode==="edit-template"),a=_(()=>e.mode==="create-session"),c=_(()=>e.mode==="edit-session"),u=_(()=>e.session?.state==="active"||e.session?.state==="starting"),f=_(()=>e.session?.initial_permission_mode==="bypassPermissions"),m=_(()=>e.selectedTemplateId?e.templates.find(S=>S.template_id===e.selectedTemplateId):null),p={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},d=_(()=>p[e.formData.model]||null),w=_(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),h=_(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function $(S){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[S]||"bg-secondary"}return(S,y)=>(i(),r("div",H1,[a.value?(i(),r("div",q1,[t("label",z1,[y[10]||(y[10]=ue(" Template ",-1)),t("button",{type:"button",onClick:y[0]||(y[0]=g=>S.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:y[1]||(y[1]=g=>S.$emit("update:selected-template-id",g.target.value||null)),class:"form-select"},[y[11]||(y[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),r(ne,null,ce(n.templates,g=>(i(),r("option",{key:g.template_id,value:g.template_id},b(g.name),9,G1))),128))],40,K1),m.value?(i(),r("div",Y1,b(m.value.description),1)):T("",!0)])):T("",!0),t("div",J1,[t("label",Q1,[ue(b(o.value?"Template Name":"Session Name")+" ",1),y[12]||(y[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:z(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:y[2]||(y[2]=g=>S.$emit("update:form-data","name",g.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,X1),n.errors.name?(i(),r("div",Z1,b(n.errors.name),1)):T("",!0),s.value?(i(),r("div",ew,"Must be a single word (no spaces) for #nametag matching")):T("",!0)]),o.value?(i(),r("div",tw,[y[13]||(y[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:y[3]||(y[3]=g=>S.$emit("update:form-data","description",g.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,sw)])):T("",!0),t("div",nw,[y[15]||(y[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:y[4]||(y[4]=g=>S.$emit("update:form-data","model",g.target.value))},[...y[14]||(y[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,ow),t("div",aw,[d.value?(i(),r("span",iw,b(d.value.description),1)):T("",!0)])]),t("div",lw,[t("label",rw,[y[16]||(y[16]=ue(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),r("span",cw," < ")):T("",!0),n.fieldStates.permission_mode==="modified"?(i(),r("span",uw," * ")):T("",!0)]),t("select",{id:"config-permission-mode",class:z(["form-select",h.value]),value:n.formData.permission_mode,onChange:y[5]||(y[5]=g=>S.$emit("update:form-data","permission_mode",g.target.value)),disabled:c.value&&!u.value},[y[17]||(y[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),y[18]||(y[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),y[19]||(y[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!c.value||f.value?(i(),r("option",fw," Bypass Permissions (No prompts - use with caution) ")):T("",!0)],42,dw),t("div",mw,[c.value&&!u.value?(i(),r("span",pw," Session must be active to change permission mode. Start the session first. ")):(i(),r("span",vw,"Controls which tool actions require permission prompts"))])]),t("div",hw,[t("label",_w,[ue(b(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),r("span",gw," < ")):T("",!0),n.fieldStates.default_role==="modified"?(i(),r("span",bw," * ")):T("",!0)]),t("input",{id:"config-role",type:"text",class:z(["form-control",w.value]),value:n.formData.default_role,onInput:y[6]||(y[6]=g=>S.$emit("update:form-data","default_role",g.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,yw),t("div",ww,b(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),r("div",kw,[y[20]||(y[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",$w,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:y[7]||(y[7]=g=>S.$emit("update:form-data","working_directory",g.target.value)),placeholder:c.value?"":"Leave empty to inherit from project",disabled:c.value,readonly:c.value},null,40,Sw),c.value?T("",!0):(i(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:y[8]||(y[8]=g=>S.$emit("open-folder-browser"))}," Browse "))]),t("div",xw,b(c.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):T("",!0),c.value&&n.session?(i(),r("div",Cw,[y[21]||(y[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",Ew,[t("span",{class:z(["badge",$(n.session.state)])},b(n.session.state),3)])])):T("",!0),a.value?(i(),r("div",Tw,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:y[9]||(y[9]=g=>S.$emit("update:form-data","startImmediately",g.target.checked))},null,40,Aw),y[22]||(y[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):T("",!0)]))}},Mw=se(Dw,[["__scopeId","data-v-9f0e3252"]]),Ow={class:"permissions-tab"},Nw={class:"mb-3"},Lw={for:"config-allowed-tools",class:"form-label"},Iw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},jw={key:1,class:"field-indicator modified",title:"Modified from template"},Pw={key:0,class:"tools-list mb-2"},Rw=["onClick"],Fw={class:"input-group input-group-sm"},Bw=["onKeydown"],Vw=["disabled"],Ww={class:"mt-2"},Uw=["onClick"],Hw={class:"form-text"},qw={class:"mb-3"},zw={for:"config-disallowed-tools",class:"form-label"},Kw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Gw={key:1,class:"field-indicator modified",title:"Modified from template"},Yw={key:0,class:"tools-list mb-2"},Jw=["onClick"],Qw={class:"input-group input-group-sm"},Xw=["onKeydown"],Zw=["disabled"],ek={class:"mt-2"},tk=["onClick"],sk={class:"form-text"},nk={key:0,class:"mb-3"},ok={class:"settings-sources-editor"},ak={class:"form-check"},ik=["checked"],lk={class:"form-check"},rk=["checked"],ck={class:"form-check"},uk=["checked"],dk={key:1,class:"mb-3"},fk={class:"mb-3"},mk={key:0,class:"mt-2"},pk=["value"],vk=["value"],hk={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,a=N(""),c=N(""),u=N(!1),f=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=_(()=>s.mode==="create-template"||s.mode==="edit-template"),p=_(()=>s.mode==="create-session"||s.mode==="edit-session"),d=_(()=>s.formData.setting_sources||["user","project","local"]),w=_(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(D=>D.trim()).filter(D=>D.length>0)),h=_(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(D=>D.trim()).filter(D=>D.length>0)),$=_(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),S=_(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),y=_(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),g=_(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function v(){const D=a.value.trim();if(D){if(!w.value.includes(D)){const C=[...w.value,D];o("update:form-data","allowed_tools",C.join(", "))}a.value=""}}function l(D){const C=[...w.value];C.splice(D,1),o("update:form-data","allowed_tools",C.join(", "))}function k(D){if(w.value.includes(D)){const C=w.value.indexOf(D);l(C)}else{const C=[...w.value,D];o("update:form-data","allowed_tools",C.join(", "))}}function x(){const D=c.value.trim();if(D){if(!h.value.includes(D)){const C=[...h.value,D];o("update:form-data","disallowed_tools",C.join(", "))}c.value=""}}function E(D){const C=[...h.value];C.splice(D,1),o("update:form-data","disallowed_tools",C.join(", "))}function O(D){if(h.value.includes(D)){const C=h.value.indexOf(D);E(C)}else{const C=[...h.value,D];o("update:form-data","disallowed_tools",C.join(", "))}}function A(D){const C=[...d.value],M=C.indexOf(D);M>=0?C.splice(M,1):C.push(D),o("update:form-data","setting_sources",C)}return(D,C)=>(i(),r("div",Ow,[t("div",Nw,[t("label",Lw,[C[9]||(C[9]=ue(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),r("span",Iw," < ")):T("",!0),n.fieldStates.allowed_tools==="modified"?(i(),r("span",jw," * ")):T("",!0)]),t("div",{class:z(["allowed-tools-editor",S.value])},[w.value.length>0?(i(),r("div",Pw,[(i(!0),r(ne,null,ce(w.value,(M,q)=>(i(),r("span",{key:q,class:"badge bg-primary me-1 mb-1 tool-badge"},[ue(b(M)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:B=>l(q),"aria-label":"Remove tool"},null,8,Rw)]))),128))])):T("",!0),t("div",Fw,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=M=>a.value=M),onKeydown:hs(ye(v,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,Bw),[[We,a.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:v,disabled:!a.value.trim()}," Add ",8,Vw)]),t("div",Ww,[C[10]||(C[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),r(ne,null,ce(f,M=>t("button",{key:M,type:"button",class:z(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":w.value.includes(M)}]),onClick:q=>k(M)},b(M),11,Uw)),64))])],2),t("div",Hw,b(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",qw,[t("label",zw,[C[11]||(C[11]=ue(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(i(),r("span",Kw," < ")):T("",!0),n.fieldStates.disallowed_tools==="modified"?(i(),r("span",Gw," * ")):T("",!0)]),t("div",{class:z(["disallowed-tools-editor",g.value])},[h.value.length>0?(i(),r("div",Yw,[(i(!0),r(ne,null,ce(h.value,(M,q)=>(i(),r("span",{key:q,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[ue(b(M)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:B=>E(q),"aria-label":"Remove denied tool"},null,8,Jw)]))),128))])):T("",!0),t("div",Qw,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[1]||(C[1]=M=>c.value=M),onKeydown:hs(ye(x,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,Xw),[[We,c.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x,disabled:!c.value.trim()}," Deny ",8,Zw)]),t("div",ek,[C[12]||(C[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(i(),r(ne,null,ce(f,M=>t("button",{key:M,type:"button",class:z(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":h.value.includes(M)}]),onClick:q=>O(M)},b(M),11,tk)),64))])],2),t("div",sk,b(m.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),p.value?(i(),r("div",nk,[C[16]||(C[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",ok,[t("div",ak,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:d.value.includes("user"),onChange:C[2]||(C[2]=M=>A("user"))},null,40,ik),C[13]||(C[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[ue(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",lk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:d.value.includes("project"),onChange:C[3]||(C[3]=M=>A("project"))},null,40,rk),C[14]||(C[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[ue(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",ck,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:d.value.includes("local"),onChange:C[4]||(C[4]=M=>A("local"))},null,40,uk),C[15]||(C[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[ue(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),C[17]||(C[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):T("",!0),p.value?(i(),r("div",dk,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C[5]||(C[5]=M=>D.$emit("preview-permissions"))}," Preview Effective Permissions ")])):T("",!0),t("div",fk,[t("a",{class:"text-muted small",role:"button",onClick:C[6]||(C[6]=M=>u.value=!u.value)},b(u.value?"Hide":"Show")+" raw input ",1),u.value?(i(),r("div",mk,[C[18]||(C[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:z(["form-control form-control-sm",$.value]),value:n.formData.allowed_tools,onInput:C[7]||(C[7]=M=>D.$emit("update:form-data","allowed_tools",M.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,pk),C[19]||(C[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:z(["form-control form-control-sm",y.value]),value:n.formData.disallowed_tools,onInput:C[8]||(C[8]=M=>D.$emit("update:form-data","disallowed_tools",M.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,vk)])):T("",!0)])]))}},_k=se(hk,[["__scopeId","data-v-cbec74ed"]]),gk={class:"advanced-tab"},bk={class:"mb-3"},yk={for:"config-system-prompt",class:"form-label"},wk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},kk={key:1,class:"field-indicator modified",title:"Modified from template"},$k=["value","rows","placeholder"],Sk={class:"form-text"},xk={class:"mb-3 form-check"},Ck=["checked"],Ek={key:0,class:"form-text text-warning"},Tk={class:"mb-3"},Ak={class:"capabilities-editor"},Dk={key:0,class:"capabilities-list mb-2"},Mk=["onClick"],Ok={class:"input-group input-group-sm"},Nk=["onKeydown"],Lk=["disabled"],Ik={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,a=_(()=>s.mode==="create-template"||s.mode==="edit-template"),c=_(()=>s.formData.initialization_context),u=_(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),f=_(()=>s.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),m=_(()=>{const S={};return s.fieldStates.initialization_context==="autofilled"&&(S["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(S["field-modified"]=!0),S}),p=N(""),d=_(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(S=>S.trim()).filter(S=>S.length>0));function w(S){const y=S.target.value;o("update:form-data","initialization_context",y)}function h(){const S=p.value.trim().toLowerCase();if(S){if(!d.value.includes(S)){const y=[...d.value,S];o("update:form-data","capabilities",y.join(", "))}p.value=""}}function $(S){const y=[...d.value];y.splice(S,1),o("update:form-data","capabilities",y.join(", "))}return(S,y)=>(i(),r("div",gk,[t("div",bk,[t("label",yk,[ue(b(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),r("span",wk," < ")):T("",!0),n.fieldStates.initialization_context==="modified"?(i(),r("span",kk," * ")):T("",!0)]),t("textarea",{id:"config-system-prompt",class:z(["form-control",m.value]),value:c.value,onInput:w,rows:a.value?4:5,placeholder:u.value},null,42,$k),t("div",Sk,b(f.value),1)]),t("div",xk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:y[0]||(y[0]=g=>S.$emit("update:form-data","override_system_prompt",g.target.checked))},null,40,Ck),y[2]||(y[2]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),r("div",Ek,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+b(a.value?"":" or legion guide")+").",1)])):T("",!0)]),t("div",Tk,[y[3]||(y[3]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",Ak,[d.value.length>0?(i(),r("div",Dk,[(i(!0),r(ne,null,ce(d.value,(g,v)=>(i(),r("span",{key:v,class:"badge bg-info me-1 mb-1 capability-badge"},[ue(b(g)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:l=>$(v),"aria-label":"Remove capability"},null,8,Mk)]))),128))])):T("",!0),t("div",Ok,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":y[1]||(y[1]=g=>p.value=g),onKeydown:hs(ye(h,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,Nk),[[We,p.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:h,disabled:!p.value.trim()}," Add ",8,Lk)])]),y[4]||(y[4]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},jk=se(Ik,[["__scopeId","data-v-9ffdae4f"]]),Pk={class:"sandbox-tab"},Rk={class:"mb-3 form-check"},Fk=["checked"],Bk={class:"mb-2 form-check"},Vk=["checked","disabled"],Wk={class:"mb-2 form-check"},Uk=["checked","disabled"],Hk={class:"mb-2"},qk=["value","disabled"],zk={class:"mb-3 form-check"},Kk=["checked","disabled"],Gk={class:"mb-2"},Yk=["value","disabled"],Jk={class:"mb-2 form-check"},Qk=["checked","disabled"],Xk={class:"mb-2"},Zk=["value","disabled"],e$={class:"mb-3 form-check"},t$=["checked","disabled"],s$={class:"mb-2"},n$=["value","disabled"],o$={class:"mb-2"},a$=["value","disabled"],i$={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(u,f){s.formData.sandbox[u]=f}function a(u,f){s.formData.sandbox.network[u]=f}function c(u,f){s.formData.sandbox.ignoreViolations[u]=f}return(u,f)=>(i(),r("div",Pk,[t("div",Rk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:f[0]||(f[0]=m=>u.$emit("update:form-data","sandbox_enabled",m.target.checked))},null,40,Fk),f[11]||(f[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:z(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,b(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:z(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",Bk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:f[1]||(f[1]=m=>o("autoAllowBashIfSandboxed",m.target.checked))},null,40,Vk),t("label",{class:z(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",Wk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:f[2]||(f[2]=m=>o("allowUnsandboxedCommands",m.target.checked))},null,40,Uk),t("label",{class:z(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",Hk,[t("label",{for:"config-sandbox-excluded-cmds",class:z(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:f[3]||(f[3]=m=>o("excludedCommands",m.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,qk)]),t("div",zk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:f[4]||(f[4]=m=>o("enableWeakerNestedSandbox",m.target.checked))},null,40,Kk),t("label",{class:z(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:z(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",Gk,[t("label",{for:"config-sandbox-allowed-domains",class:z(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:f[5]||(f[5]=m=>a("allowedDomains",m.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,Yk)]),t("div",Jk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:f[6]||(f[6]=m=>a("allowLocalBinding",m.target.checked))},null,40,Qk),t("label",{class:z(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",Xk,[t("label",{for:"config-sandbox-unix-sockets",class:z(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:f[7]||(f[7]=m=>a("allowUnixSockets",m.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,Zk)]),t("div",e$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:f[8]||(f[8]=m=>a("allowAllUnixSockets",m.target.checked))},null,40,t$),t("label",{class:z(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:z(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",s$,[t("label",{for:"config-sandbox-ignore-file",class:z(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:f[9]||(f[9]=m=>c("file",m.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,n$)]),t("div",o$,[t("label",{for:"config-sandbox-ignore-network",class:z(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:f[10]||(f[10]=m=>c("network",m.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,a$)])]))}},l$=se(i$,[["__scopeId","data-v-be109d12"]]);var Oe="top",Re="bottom",Fe="right",Ne="left",ws="auto",Ut=[Oe,Re,Fe,Ne],kt="start",It="end",Mo="clippingParents",dn="viewport",At="popper",Oo="reference",en=Ut.reduce(function(n,e){return n.concat([e+"-"+kt,e+"-"+It])},[]),fn=[].concat(Ut,[ws]).reduce(function(n,e){return n.concat([e,e+"-"+kt,e+"-"+It])},[]),No="beforeRead",Lo="read",Io="afterRead",jo="beforeMain",Po="main",Ro="afterMain",Fo="beforeWrite",Bo="write",Vo="afterWrite",Wo=[No,Lo,Io,jo,Po,Ro,Fo,Bo,Vo];function tt(n){return n?(n.nodeName||"").toLowerCase():null}function Be(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function $t(n){var e=Be(n).Element;return n instanceof e||n instanceof Element}function Ue(n){var e=Be(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function mn(n){if(typeof ShadowRoot>"u")return!1;var e=Be(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function r$(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},c=e.elements[s];!Ue(c)||!tt(c)||(Object.assign(c.style,o),Object.keys(a).forEach(function(u){var f=a[u];f===!1?c.removeAttribute(u):c.setAttribute(u,f===!0?"":f)}))})}function c$(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],c=e.attributes[o]||{},u=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),f=u.reduce(function(m,p){return m[p]="",m},{});!Ue(a)||!tt(a)||(Object.assign(a.style,f),Object.keys(c).forEach(function(m){a.removeAttribute(m)}))})}}const Uo={name:"applyStyles",enabled:!0,phase:"write",fn:r$,effect:c$,requires:["computeStyles"]};function Ze(n){return n.split("-")[0]}var wt=Math.max,_s=Math.min,jt=Math.round;function tn(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ho(){return!/^((?!chrome|android).)*safari/i.test(tn())}function Pt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,c=1;e&&Ue(n)&&(a=n.offsetWidth>0&&jt(o.width)/n.offsetWidth||1,c=n.offsetHeight>0&&jt(o.height)/n.offsetHeight||1);var u=$t(n)?Be(n):window,f=u.visualViewport,m=!Ho()&&s,p=(o.left+(m&&f?f.offsetLeft:0))/a,d=(o.top+(m&&f?f.offsetTop:0))/c,w=o.width/a,h=o.height/c;return{width:w,height:h,top:d,right:p+w,bottom:d+h,left:p,x:p,y:d}}function pn(n){var e=Pt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function qo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&mn(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function it(n){return Be(n).getComputedStyle(n)}function u$(n){return["table","td","th"].indexOf(tt(n))>=0}function vt(n){return(($t(n)?n.ownerDocument:n.document)||window.document).documentElement}function ks(n){return tt(n)==="html"?n:n.assignedSlot||n.parentNode||(mn(n)?n.host:null)||vt(n)}function Vn(n){return!Ue(n)||it(n).position==="fixed"?null:n.offsetParent}function d$(n){var e=/firefox/i.test(tn()),s=/Trident/i.test(tn());if(s&&Ue(n)){var o=it(n);if(o.position==="fixed")return null}var a=ks(n);for(mn(a)&&(a=a.host);Ue(a)&&["html","body"].indexOf(tt(a))<0;){var c=it(a);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return a;a=a.parentNode}return null}function ts(n){for(var e=Be(n),s=Vn(n);s&&u$(s)&&it(s).position==="static";)s=Vn(s);return s&&(tt(s)==="html"||tt(s)==="body"&&it(s).position==="static")?e:s||d$(n)||e}function vn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Yt(n,e,s){return wt(n,_s(e,s))}function f$(n,e,s){var o=Yt(n,e,s);return o>s?s:o}function zo(){return{top:0,right:0,bottom:0,left:0}}function Ko(n){return Object.assign({},zo(),n)}function Go(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var m$=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Ko(typeof e!="number"?e:Go(e,Ut))};function p$(n){var e,s=n.state,o=n.name,a=n.options,c=s.elements.arrow,u=s.modifiersData.popperOffsets,f=Ze(s.placement),m=vn(f),p=[Ne,Fe].indexOf(f)>=0,d=p?"height":"width";if(!(!c||!u)){var w=m$(a.padding,s),h=pn(c),$=m==="y"?Oe:Ne,S=m==="y"?Re:Fe,y=s.rects.reference[d]+s.rects.reference[m]-u[m]-s.rects.popper[d],g=u[m]-s.rects.reference[m],v=ts(c),l=v?m==="y"?v.clientHeight||0:v.clientWidth||0:0,k=y/2-g/2,x=w[$],E=l-h[d]-w[S],O=l/2-h[d]/2+k,A=Yt(x,O,E),D=m;s.modifiersData[o]=(e={},e[D]=A,e.centerOffset=A-O,e)}}function v$(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||qo(e.elements.popper,a)&&(e.elements.arrow=a))}const Yo={name:"arrow",enabled:!0,phase:"main",fn:p$,effect:v$,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Rt(n){return n.split("-")[1]}var h$={top:"auto",right:"auto",bottom:"auto",left:"auto"};function _$(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:jt(s*a)/a||0,y:jt(o*a)/a||0}}function Wn(n){var e,s=n.popper,o=n.popperRect,a=n.placement,c=n.variation,u=n.offsets,f=n.position,m=n.gpuAcceleration,p=n.adaptive,d=n.roundOffsets,w=n.isFixed,h=u.x,$=h===void 0?0:h,S=u.y,y=S===void 0?0:S,g=typeof d=="function"?d({x:$,y}):{x:$,y};$=g.x,y=g.y;var v=u.hasOwnProperty("x"),l=u.hasOwnProperty("y"),k=Ne,x=Oe,E=window;if(p){var O=ts(s),A="clientHeight",D="clientWidth";if(O===Be(s)&&(O=vt(s),it(O).position!=="static"&&f==="absolute"&&(A="scrollHeight",D="scrollWidth")),O=O,a===Oe||(a===Ne||a===Fe)&&c===It){x=Re;var C=w&&O===E&&E.visualViewport?E.visualViewport.height:O[A];y-=C-o.height,y*=m?1:-1}if(a===Ne||(a===Oe||a===Re)&&c===It){k=Fe;var M=w&&O===E&&E.visualViewport?E.visualViewport.width:O[D];$-=M-o.width,$*=m?1:-1}}var q=Object.assign({position:f},p&&h$),B=d===!0?_$({x:$,y},Be(s)):{x:$,y};if($=B.x,y=B.y,m){var V;return Object.assign({},q,(V={},V[x]=l?"0":"",V[k]=v?"0":"",V.transform=(E.devicePixelRatio||1)<=1?"translate("+$+"px, "+y+"px)":"translate3d("+$+"px, "+y+"px, 0)",V))}return Object.assign({},q,(e={},e[x]=l?y+"px":"",e[k]=v?$+"px":"",e.transform="",e))}function g$(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,c=s.adaptive,u=c===void 0?!0:c,f=s.roundOffsets,m=f===void 0?!0:f,p={placement:Ze(e.placement),variation:Rt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Wn(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:u,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Wn(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Jo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:g$,data:{}};var is={passive:!0};function b$(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,c=a===void 0?!0:a,u=o.resize,f=u===void 0?!0:u,m=Be(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&p.forEach(function(d){d.addEventListener("scroll",s.update,is)}),f&&m.addEventListener("resize",s.update,is),function(){c&&p.forEach(function(d){d.removeEventListener("scroll",s.update,is)}),f&&m.removeEventListener("resize",s.update,is)}}const Qo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:b$,data:{}};var y$={left:"right",right:"left",bottom:"top",top:"bottom"};function ms(n){return n.replace(/left|right|bottom|top/g,function(e){return y$[e]})}var w$={start:"end",end:"start"};function Un(n){return n.replace(/start|end/g,function(e){return w$[e]})}function hn(n){var e=Be(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function _n(n){return Pt(vt(n)).left+hn(n).scrollLeft}function k$(n,e){var s=Be(n),o=vt(n),a=s.visualViewport,c=o.clientWidth,u=o.clientHeight,f=0,m=0;if(a){c=a.width,u=a.height;var p=Ho();(p||!p&&e==="fixed")&&(f=a.offsetLeft,m=a.offsetTop)}return{width:c,height:u,x:f+_n(n),y:m}}function $$(n){var e,s=vt(n),o=hn(n),a=(e=n.ownerDocument)==null?void 0:e.body,c=wt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),u=wt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),f=-o.scrollLeft+_n(n),m=-o.scrollTop;return it(a||s).direction==="rtl"&&(f+=wt(s.clientWidth,a?a.clientWidth:0)-c),{width:c,height:u,x:f,y:m}}function gn(n){var e=it(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function Xo(n){return["html","body","#document"].indexOf(tt(n))>=0?n.ownerDocument.body:Ue(n)&&gn(n)?n:Xo(ks(n))}function Jt(n,e){var s;e===void 0&&(e=[]);var o=Xo(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),c=Be(o),u=a?[c].concat(c.visualViewport||[],gn(o)?o:[]):o,f=e.concat(u);return a?f:f.concat(Jt(ks(u)))}function sn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function S$(n,e){var s=Pt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Hn(n,e,s){return e===dn?sn(k$(n,s)):$t(e)?S$(e,s):sn($$(vt(n)))}function x$(n){var e=Jt(ks(n)),s=["absolute","fixed"].indexOf(it(n).position)>=0,o=s&&Ue(n)?ts(n):n;return $t(o)?e.filter(function(a){return $t(a)&&qo(a,o)&&tt(a)!=="body"}):[]}function C$(n,e,s,o){var a=e==="clippingParents"?x$(n):[].concat(e),c=[].concat(a,[s]),u=c[0],f=c.reduce(function(m,p){var d=Hn(n,p,o);return m.top=wt(d.top,m.top),m.right=_s(d.right,m.right),m.bottom=_s(d.bottom,m.bottom),m.left=wt(d.left,m.left),m},Hn(n,u,o));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function Zo(n){var e=n.reference,s=n.element,o=n.placement,a=o?Ze(o):null,c=o?Rt(o):null,u=e.x+e.width/2-s.width/2,f=e.y+e.height/2-s.height/2,m;switch(a){case Oe:m={x:u,y:e.y-s.height};break;case Re:m={x:u,y:e.y+e.height};break;case Fe:m={x:e.x+e.width,y:f};break;case Ne:m={x:e.x-s.width,y:f};break;default:m={x:e.x,y:e.y}}var p=a?vn(a):null;if(p!=null){var d=p==="y"?"height":"width";switch(c){case kt:m[p]=m[p]-(e[d]/2-s[d]/2);break;case It:m[p]=m[p]+(e[d]/2-s[d]/2);break}}return m}function Ft(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,c=s.strategy,u=c===void 0?n.strategy:c,f=s.boundary,m=f===void 0?Mo:f,p=s.rootBoundary,d=p===void 0?dn:p,w=s.elementContext,h=w===void 0?At:w,$=s.altBoundary,S=$===void 0?!1:$,y=s.padding,g=y===void 0?0:y,v=Ko(typeof g!="number"?g:Go(g,Ut)),l=h===At?Oo:At,k=n.rects.popper,x=n.elements[S?l:h],E=C$($t(x)?x:x.contextElement||vt(n.elements.popper),m,d,u),O=Pt(n.elements.reference),A=Zo({reference:O,element:k,placement:a}),D=sn(Object.assign({},k,A)),C=h===At?D:O,M={top:E.top-C.top+v.top,bottom:C.bottom-E.bottom+v.bottom,left:E.left-C.left+v.left,right:C.right-E.right+v.right},q=n.modifiersData.offset;if(h===At&&q){var B=q[a];Object.keys(M).forEach(function(V){var U=[Fe,Re].indexOf(V)>=0?1:-1,J=[Oe,Re].indexOf(V)>=0?"y":"x";M[V]+=B[J]*U})}return M}function E$(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,c=s.rootBoundary,u=s.padding,f=s.flipVariations,m=s.allowedAutoPlacements,p=m===void 0?fn:m,d=Rt(o),w=d?f?en:en.filter(function(S){return Rt(S)===d}):Ut,h=w.filter(function(S){return p.indexOf(S)>=0});h.length===0&&(h=w);var $=h.reduce(function(S,y){return S[y]=Ft(n,{placement:y,boundary:a,rootBoundary:c,padding:u})[Ze(y)],S},{});return Object.keys($).sort(function(S,y){return $[S]-$[y]})}function T$(n){if(Ze(n)===ws)return[];var e=ms(n);return[Un(n),e,Un(e)]}function A$(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,c=a===void 0?!0:a,u=s.altAxis,f=u===void 0?!0:u,m=s.fallbackPlacements,p=s.padding,d=s.boundary,w=s.rootBoundary,h=s.altBoundary,$=s.flipVariations,S=$===void 0?!0:$,y=s.allowedAutoPlacements,g=e.options.placement,v=Ze(g),l=v===g,k=m||(l||!S?[ms(g)]:T$(g)),x=[g].concat(k).reduce(function(Q,_e){return Q.concat(Ze(_e)===ws?E$(e,{placement:_e,boundary:d,rootBoundary:w,padding:p,flipVariations:S,allowedAutoPlacements:y}):_e)},[]),E=e.rects.reference,O=e.rects.popper,A=new Map,D=!0,C=x[0],M=0;M<x.length;M++){var q=x[M],B=Ze(q),V=Rt(q)===kt,U=[Oe,Re].indexOf(B)>=0,J=U?"width":"height",ae=Ft(e,{placement:q,boundary:d,rootBoundary:w,altBoundary:h,padding:p}),L=U?V?Fe:Ne:V?Re:Oe;E[J]>O[J]&&(L=ms(L));var j=ms(L),R=[];if(c&&R.push(ae[B]<=0),f&&R.push(ae[L]<=0,ae[j]<=0),R.every(function(Q){return Q})){C=q,D=!1;break}A.set(q,R)}if(D)for(var H=S?3:1,X=function(_e){var K=x.find(function(P){var I=A.get(P);if(I)return I.slice(0,_e).every(function(W){return W})});if(K)return C=K,"break"},ee=H;ee>0;ee--){var he=X(ee);if(he==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const ea={name:"flip",enabled:!0,phase:"main",fn:A$,requiresIfExists:["offset"],data:{_skip:!1}};function qn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function zn(n){return[Oe,Fe,Re,Ne].some(function(e){return n[e]>=0})}function D$(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,c=e.modifiersData.preventOverflow,u=Ft(e,{elementContext:"reference"}),f=Ft(e,{altBoundary:!0}),m=qn(u,o),p=qn(f,a,c),d=zn(m),w=zn(p);e.modifiersData[s]={referenceClippingOffsets:m,popperEscapeOffsets:p,isReferenceHidden:d,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":w})}const ta={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:D$};function M$(n,e,s){var o=Ze(n),a=[Ne,Oe].indexOf(o)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,u=c[0],f=c[1];return u=u||0,f=(f||0)*a,[Ne,Fe].indexOf(o)>=0?{x:f,y:u}:{x:u,y:f}}function O$(n){var e=n.state,s=n.options,o=n.name,a=s.offset,c=a===void 0?[0,0]:a,u=fn.reduce(function(d,w){return d[w]=M$(w,e.rects,c),d},{}),f=u[e.placement],m=f.x,p=f.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=u}const sa={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:O$};function N$(n){var e=n.state,s=n.name;e.modifiersData[s]=Zo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const na={name:"popperOffsets",enabled:!0,phase:"read",fn:N$,data:{}};function L$(n){return n==="x"?"y":"x"}function I$(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,c=a===void 0?!0:a,u=s.altAxis,f=u===void 0?!1:u,m=s.boundary,p=s.rootBoundary,d=s.altBoundary,w=s.padding,h=s.tether,$=h===void 0?!0:h,S=s.tetherOffset,y=S===void 0?0:S,g=Ft(e,{boundary:m,rootBoundary:p,padding:w,altBoundary:d}),v=Ze(e.placement),l=Rt(e.placement),k=!l,x=vn(v),E=L$(x),O=e.modifiersData.popperOffsets,A=e.rects.reference,D=e.rects.popper,C=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,M=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(O){if(c){var V,U=x==="y"?Oe:Ne,J=x==="y"?Re:Fe,ae=x==="y"?"height":"width",L=O[x],j=L+g[U],R=L-g[J],H=$?-D[ae]/2:0,X=l===kt?A[ae]:D[ae],ee=l===kt?-D[ae]:-A[ae],he=e.elements.arrow,Q=$&&he?pn(he):{width:0,height:0},_e=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:zo(),K=_e[U],P=_e[J],I=Yt(0,A[ae],Q[ae]),W=k?A[ae]/2-H-I-K-M.mainAxis:X-I-K-M.mainAxis,Z=k?-A[ae]/2+H+I+P+M.mainAxis:ee+I+P+M.mainAxis,oe=e.elements.arrow&&ts(e.elements.arrow),$e=oe?x==="y"?oe.clientTop||0:oe.clientLeft||0:0,Ye=(V=q?.[x])!=null?V:0,Y=L+W-Ye-$e,re=L+Z-Ye,ve=Yt($?_s(j,Y):j,L,$?wt(R,re):R);O[x]=ve,B[x]=ve-L}if(f){var ge,Ee=x==="x"?Oe:Ne,st=x==="x"?Re:Fe,Je=O[E],gt=E==="y"?"height":"width",F=Je+g[Ee],te=Je-g[st],ie=[Oe,Ne].indexOf(v)!==-1,we=(ge=q?.[E])!=null?ge:0,fe=ie?F:Je-A[gt]-D[gt]-we+M.altAxis,Te=ie?Je+A[gt]+D[gt]-we-M.altAxis:te,Ae=$&&ie?f$(fe,Je,Te):Yt($?fe:F,Je,$?Te:te);O[E]=Ae,B[E]=Ae-Je}e.modifiersData[o]=B}}const oa={name:"preventOverflow",enabled:!0,phase:"main",fn:I$,requiresIfExists:["offset"]};function j$(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function P$(n){return n===Be(n)||!Ue(n)?hn(n):j$(n)}function R$(n){var e=n.getBoundingClientRect(),s=jt(e.width)/n.offsetWidth||1,o=jt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function F$(n,e,s){s===void 0&&(s=!1);var o=Ue(e),a=Ue(e)&&R$(e),c=vt(e),u=Pt(n,a,s),f={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!s)&&((tt(e)!=="body"||gn(c))&&(f=P$(e)),Ue(e)?(m=Pt(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):c&&(m.x=_n(c))),{x:u.left+f.scrollLeft-m.x,y:u.top+f.scrollTop-m.y,width:u.width,height:u.height}}function B$(n){var e=new Map,s=new Set,o=[];n.forEach(function(c){e.set(c.name,c)});function a(c){s.add(c.name);var u=[].concat(c.requires||[],c.requiresIfExists||[]);u.forEach(function(f){if(!s.has(f)){var m=e.get(f);m&&a(m)}}),o.push(c)}return n.forEach(function(c){s.has(c.name)||a(c)}),o}function V$(n){var e=B$(n);return Wo.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function W$(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function U$(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Kn={placement:"bottom",modifiers:[],strategy:"absolute"};function Gn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function aa(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,c=a===void 0?Kn:a;return function(f,m,p){p===void 0&&(p=c);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Kn,c),modifiersData:{},elements:{reference:f,popper:m},attributes:{},styles:{}},w=[],h=!1,$={state:d,setOptions:function(v){var l=typeof v=="function"?v(d.options):v;y(),d.options=Object.assign({},c,d.options,l),d.scrollParents={reference:$t(f)?Jt(f):f.contextElement?Jt(f.contextElement):[],popper:Jt(m)};var k=V$(U$([].concat(o,d.options.modifiers)));return d.orderedModifiers=k.filter(function(x){return x.enabled}),S(),$.update()},forceUpdate:function(){if(!h){var v=d.elements,l=v.reference,k=v.popper;if(Gn(l,k)){d.rects={reference:F$(l,ts(k),d.options.strategy==="fixed"),popper:pn(k)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(M){return d.modifiersData[M.name]=Object.assign({},M.data)});for(var x=0;x<d.orderedModifiers.length;x++){if(d.reset===!0){d.reset=!1,x=-1;continue}var E=d.orderedModifiers[x],O=E.fn,A=E.options,D=A===void 0?{}:A,C=E.name;typeof O=="function"&&(d=O({state:d,options:D,name:C,instance:$})||d)}}}},update:W$(function(){return new Promise(function(g){$.forceUpdate(),g(d)})}),destroy:function(){y(),h=!0}};if(!Gn(f,m))return $;$.setOptions(p).then(function(g){!h&&p.onFirstUpdate&&p.onFirstUpdate(g)});function S(){d.orderedModifiers.forEach(function(g){var v=g.name,l=g.options,k=l===void 0?{}:l,x=g.effect;if(typeof x=="function"){var E=x({state:d,name:v,instance:$,options:k}),O=function(){};w.push(E||O)}})}function y(){w.forEach(function(g){return g()}),w=[]}return $}}var H$=[Qo,na,Jo,Uo,sa,ea,oa,Yo,ta],bn=aa({defaultModifiers:H$});const ia=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Ro,afterRead:Io,afterWrite:Vo,applyStyles:Uo,arrow:Yo,auto:ws,basePlacements:Ut,beforeMain:jo,beforeRead:No,beforeWrite:Fo,bottom:Re,clippingParents:Mo,computeStyles:Jo,createPopper:bn,detectOverflow:Ft,end:It,eventListeners:Qo,flip:ea,hide:ta,left:Ne,main:Po,modifierPhases:Wo,offset:sa,placements:fn,popper:At,popperGenerator:aa,popperOffsets:na,preventOverflow:oa,read:Lo,reference:Oo,right:Fe,start:kt,top:Oe,variationPlacements:en,viewport:dn,write:Bo},Symbol.toStringTag,{value:"Module"}));const ut=new Map,Ps={set(n,e,s){ut.has(n)||ut.set(n,new Map);const o=ut.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return ut.has(n)&&ut.get(n).get(e)||null},remove(n,e){if(!ut.has(n))return;const s=ut.get(n);s.delete(e),s.size===0&&ut.delete(n)}},q$=1e6,z$=1e3,nn="transitionend",la=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),K$=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),G$=n=>{do n+=Math.floor(Math.random()*q$);while(document.getElementById(n));return n},Y$=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*z$)},ra=n=>{n.dispatchEvent(new Event(nn))},ot=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ft=n=>ot(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(la(n)):null,Ht=n=>{if(!ot(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},mt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",ca=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?ca(n.parentNode):null},gs=()=>{},ss=n=>{n.offsetHeight},ua=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Rs=[],J$=n=>{document.readyState==="loading"?(Rs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Rs)e()}),Rs.push(n)):n()},He=()=>document.documentElement.dir==="rtl",ze=n=>{J$(()=>{const e=ua();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Le=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,da=(n,e,s=!0)=>{if(!s){Le(n);return}const a=Y$(e)+5;let c=!1;const u=({target:f})=>{f===e&&(c=!0,e.removeEventListener(nn,u),Le(n))};e.addEventListener(nn,u),setTimeout(()=>{c||ra(e)},a)},yn=(n,e,s,o)=>{const a=n.length;let c=n.indexOf(e);return c===-1?!s&&o?n[a-1]:n[0]:(c+=s?1:-1,o&&(c=(c+a)%a),n[Math.max(0,Math.min(c,a-1))])},Q$=/[^.]*(?=\..*)\.|.*/,X$=/\..*/,Z$=/::\d+$/,Fs={};let Yn=1;const fa={mouseenter:"mouseover",mouseleave:"mouseout"},eS=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ma(n,e){return e&&`${e}::${Yn++}`||n.uidEvent||Yn++}function pa(n){const e=ma(n);return n.uidEvent=e,Fs[e]=Fs[e]||{},Fs[e]}function tS(n,e){return function s(o){return wn(o,{delegateTarget:n}),s.oneOff&&G.off(n,o.type,e),e.apply(n,[o])}}function sS(n,e,s){return function o(a){const c=n.querySelectorAll(e);for(let{target:u}=a;u&&u!==this;u=u.parentNode)for(const f of c)if(f===u)return wn(a,{delegateTarget:u}),o.oneOff&&G.off(n,a.type,e,s),s.apply(u,[a])}}function va(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ha(n,e,s){const o=typeof e=="string",a=o?s:e||s;let c=_a(n);return eS.has(c)||(c=n),[o,a,c]}function Jn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[c,u,f]=ha(e,s,o);e in fa&&(u=(S=>function(y){if(!y.relatedTarget||y.relatedTarget!==y.delegateTarget&&!y.delegateTarget.contains(y.relatedTarget))return S.call(this,y)})(u));const m=pa(n),p=m[f]||(m[f]={}),d=va(p,u,c?s:null);if(d){d.oneOff=d.oneOff&&a;return}const w=ma(u,e.replace(Q$,"")),h=c?sS(n,s,u):tS(n,u);h.delegationSelector=c?s:null,h.callable=u,h.oneOff=a,h.uidEvent=w,p[w]=h,n.addEventListener(f,h,c)}function on(n,e,s,o,a){const c=va(e[s],o,a);c&&(n.removeEventListener(s,c,!!a),delete e[s][c.uidEvent])}function nS(n,e,s,o){const a=e[s]||{};for(const[c,u]of Object.entries(a))c.includes(o)&&on(n,e,s,u.callable,u.delegationSelector)}function _a(n){return n=n.replace(X$,""),fa[n]||n}const G={on(n,e,s,o){Jn(n,e,s,o,!1)},one(n,e,s,o){Jn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,c,u]=ha(e,s,o),f=u!==e,m=pa(n),p=m[u]||{},d=e.startsWith(".");if(typeof c<"u"){if(!Object.keys(p).length)return;on(n,m,u,c,a?s:null);return}if(d)for(const w of Object.keys(m))nS(n,m,w,e.slice(1));for(const[w,h]of Object.entries(p)){const $=w.replace(Z$,"");(!f||e.includes($))&&on(n,m,u,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=ua(),a=_a(e),c=e!==a;let u=null,f=!0,m=!0,p=!1;c&&o&&(u=o.Event(e,s),o(n).trigger(u),f=!u.isPropagationStopped(),m=!u.isImmediatePropagationStopped(),p=u.isDefaultPrevented());const d=wn(new Event(e,{bubbles:f,cancelable:!0}),s);return p&&d.preventDefault(),m&&n.dispatchEvent(d),d.defaultPrevented&&u&&u.preventDefault(),d}};function wn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Qn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Bs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const at={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Bs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Bs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=Qn(n.dataset[o])}return e},getDataAttribute(n,e){return Qn(n.getAttribute(`data-bs-${Bs(e)}`))}};class ns{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=ot(s)?at.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...ot(s)?at.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const c=e[o],u=ot(c)?"element":K$(c);if(!new RegExp(a).test(u))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${u}" but expected type "${a}".`)}}}const oS="5.3.8";class Ge extends ns{constructor(e,s){super(),e=ft(e),e&&(this._element=e,this._config=this._getConfig(s),Ps.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Ps.remove(this._element,this.constructor.DATA_KEY),G.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){da(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Ps.get(ft(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return oS}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Vs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>la(s)).join(","):null},de={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!mt(s)&&Ht(s))},getSelectorFromElement(n){const e=Vs(n);return e&&de.findOne(e)?e:null},getElementFromSelector(n){const e=Vs(n);return e?de.findOne(e):null},getMultipleElementsFromSelector(n){const e=Vs(n);return e?de.find(e):[]}},$s=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;G.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),mt(this))return;const c=de.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(c)[e]()})},aS="alert",iS="bs.alert",ga=`.${iS}`,lS=`close${ga}`,rS=`closed${ga}`,cS="fade",uS="show";class Ss extends Ge{static get NAME(){return aS}close(){if(G.trigger(this._element,lS).defaultPrevented)return;this._element.classList.remove(uS);const s=this._element.classList.contains(cS);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),G.trigger(this._element,rS),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Ss.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}$s(Ss,"close");ze(Ss);const dS="button",fS="bs.button",mS=`.${fS}`,pS=".data-api",vS="active",Xn='[data-bs-toggle="button"]',hS=`click${mS}${pS}`;class xs extends Ge{static get NAME(){return dS}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(vS))}static jQueryInterface(e){return this.each(function(){const s=xs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}G.on(document,hS,Xn,n=>{n.preventDefault();const e=n.target.closest(Xn);xs.getOrCreateInstance(e).toggle()});ze(xs);const _S="swipe",qt=".bs.swipe",gS=`touchstart${qt}`,bS=`touchmove${qt}`,yS=`touchend${qt}`,wS=`pointerdown${qt}`,kS=`pointerup${qt}`,$S="touch",SS="pen",xS="pointer-event",CS=40,ES={endCallback:null,leftCallback:null,rightCallback:null},TS={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class bs extends ns{constructor(e,s){super(),this._element=e,!(!e||!bs.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return ES}static get DefaultType(){return TS}static get NAME(){return _S}dispose(){G.off(this._element,qt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Le(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=CS)return;const s=e/this._deltaX;this._deltaX=0,s&&Le(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(G.on(this._element,wS,e=>this._start(e)),G.on(this._element,kS,e=>this._end(e)),this._element.classList.add(xS)):(G.on(this._element,gS,e=>this._start(e)),G.on(this._element,bS,e=>this._move(e)),G.on(this._element,yS,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===SS||e.pointerType===$S)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const AS="carousel",DS="bs.carousel",ht=`.${DS}`,ba=".data-api",MS="ArrowLeft",OS="ArrowRight",NS=500,Kt="next",Et="prev",Dt="left",ps="right",LS=`slide${ht}`,Ws=`slid${ht}`,IS=`keydown${ht}`,jS=`mouseenter${ht}`,PS=`mouseleave${ht}`,RS=`dragstart${ht}`,FS=`load${ht}${ba}`,BS=`click${ht}${ba}`,ya="carousel",ls="active",VS="slide",WS="carousel-item-end",US="carousel-item-start",HS="carousel-item-next",qS="carousel-item-prev",wa=".active",ka=".carousel-item",zS=wa+ka,KS=".carousel-item img",GS=".carousel-indicators",YS="[data-bs-slide], [data-bs-slide-to]",JS='[data-bs-ride="carousel"]',QS={[MS]:ps,[OS]:Dt},XS={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},ZS={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class os extends Ge{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=de.findOne(GS,this._element),this._addEventListeners(),this._config.ride===ya&&this.cycle()}static get Default(){return XS}static get DefaultType(){return ZS}static get NAME(){return AS}next(){this._slide(Kt)}nextWhenVisible(){!document.hidden&&Ht(this._element)&&this.next()}prev(){this._slide(Et)}pause(){this._isSliding&&ra(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){G.one(this._element,Ws,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){G.one(this._element,Ws,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?Kt:Et;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&G.on(this._element,IS,e=>this._keydown(e)),this._config.pause==="hover"&&(G.on(this._element,jS,()=>this.pause()),G.on(this._element,PS,()=>this._maybeEnableCycle())),this._config.touch&&bs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of de.find(KS,this._element))G.on(o,RS,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Dt)),rightCallback:()=>this._slide(this._directionToOrder(ps)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),NS+this._config.interval))}};this._swipeHelper=new bs(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=QS[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=de.findOne(wa,this._indicatorsElement);s.classList.remove(ls),s.removeAttribute("aria-current");const o=de.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(ls),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===Kt,c=s||yn(this._getItems(),o,a,this._config.wrap);if(c===o)return;const u=this._getItemIndex(c),f=$=>G.trigger(this._element,$,{relatedTarget:c,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:u});if(f(LS).defaultPrevented||!o||!c)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(u),this._activeElement=c;const d=a?US:WS,w=a?HS:qS;c.classList.add(w),ss(c),o.classList.add(d),c.classList.add(d);const h=()=>{c.classList.remove(d,w),c.classList.add(ls),o.classList.remove(ls,w,d),this._isSliding=!1,f(Ws)};this._queueCallback(h,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(VS)}_getActive(){return de.findOne(zS,this._element)}_getItems(){return de.find(ka,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return He()?e===Dt?Et:Kt:e===Dt?Kt:Et}_orderToDirection(e){return He()?e===Et?Dt:ps:e===Et?ps:Dt}static jQueryInterface(e){return this.each(function(){const s=os.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(document,BS,YS,function(n){const e=de.getElementFromSelector(this);if(!e||!e.classList.contains(ya))return;n.preventDefault();const s=os.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(at.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});G.on(window,FS,()=>{const n=de.find(JS);for(const e of n)os.getOrCreateInstance(e)});ze(os);const e0="collapse",t0="bs.collapse",as=`.${t0}`,s0=".data-api",n0=`show${as}`,o0=`shown${as}`,a0=`hide${as}`,i0=`hidden${as}`,l0=`click${as}${s0}`,Us="show",Ot="collapse",rs="collapsing",r0="collapsed",c0=`:scope .${Ot} .${Ot}`,u0="collapse-horizontal",d0="width",f0="height",m0=".collapse.show, .collapse.collapsing",an='[data-bs-toggle="collapse"]',p0={parent:null,toggle:!0},v0={parent:"(null|element)",toggle:"boolean"};class Xt extends Ge{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=de.find(an);for(const a of o){const c=de.getSelectorFromElement(a),u=de.find(c).filter(f=>f===this._element);c!==null&&u.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return p0}static get DefaultType(){return v0}static get NAME(){return e0}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(m0).filter(f=>f!==this._element).map(f=>Xt.getOrCreateInstance(f,{toggle:!1}))),e.length&&e[0]._isTransitioning||G.trigger(this._element,n0).defaultPrevented)return;for(const f of e)f.hide();const o=this._getDimension();this._element.classList.remove(Ot),this._element.classList.add(rs),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(rs),this._element.classList.add(Ot,Us),this._element.style[o]="",G.trigger(this._element,o0)},u=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[u]}px`}hide(){if(this._isTransitioning||!this._isShown()||G.trigger(this._element,a0).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,ss(this._element),this._element.classList.add(rs),this._element.classList.remove(Ot,Us);for(const a of this._triggerArray){const c=de.getElementFromSelector(a);c&&!this._isShown(c)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(rs),this._element.classList.add(Ot),G.trigger(this._element,i0)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Us)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ft(e.parent),e}_getDimension(){return this._element.classList.contains(u0)?d0:f0}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(an);for(const s of e){const o=de.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=de.find(c0,this._config.parent);return de.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(r0,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Xt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}G.on(document,l0,an,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of de.getMultipleElementsFromSelector(this))Xt.getOrCreateInstance(e,{toggle:!1}).toggle()});ze(Xt);const Zn="dropdown",h0="bs.dropdown",xt=`.${h0}`,kn=".data-api",_0="Escape",eo="Tab",g0="ArrowUp",to="ArrowDown",b0=2,y0=`hide${xt}`,w0=`hidden${xt}`,k0=`show${xt}`,$0=`shown${xt}`,$a=`click${xt}${kn}`,Sa=`keydown${xt}${kn}`,S0=`keyup${xt}${kn}`,Mt="show",x0="dropup",C0="dropend",E0="dropstart",T0="dropup-center",A0="dropdown-center",bt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',D0=`${bt}.${Mt}`,vs=".dropdown-menu",M0=".navbar",O0=".navbar-nav",N0=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",L0=He()?"top-end":"top-start",I0=He()?"top-start":"top-end",j0=He()?"bottom-end":"bottom-start",P0=He()?"bottom-start":"bottom-end",R0=He()?"left-start":"right-start",F0=He()?"right-start":"left-start",B0="top",V0="bottom",W0={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},U0={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class et extends Ge{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=de.next(this._element,vs)[0]||de.prev(this._element,vs)[0]||de.findOne(vs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return W0}static get DefaultType(){return U0}static get NAME(){return Zn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(mt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!G.trigger(this._element,k0,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(O0))for(const o of[].concat(...document.body.children))G.on(o,"mouseover",gs);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Mt),this._element.classList.add(Mt),G.trigger(this._element,$0,e)}}hide(){if(mt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!G.trigger(this._element,y0,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))G.off(o,"mouseover",gs);this._popper&&this._popper.destroy(),this._menu.classList.remove(Mt),this._element.classList.remove(Mt),this._element.setAttribute("aria-expanded","false"),at.removeDataAttribute(this._menu,"popper"),G.trigger(this._element,w0,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!ot(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Zn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof ia>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:ot(this._config.reference)?e=ft(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=bn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Mt)}_getPlacement(){const e=this._parent;if(e.classList.contains(C0))return R0;if(e.classList.contains(E0))return F0;if(e.classList.contains(T0))return B0;if(e.classList.contains(A0))return V0;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(x0)?s?I0:L0:s?P0:j0}_detectNavbar(){return this._element.closest(M0)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(at.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Le(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=de.find(N0,this._menu).filter(a=>Ht(a));o.length&&yn(o,s,e===to,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=et.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===b0||e.type==="keyup"&&e.key!==eo)return;const s=de.find(D0);for(const o of s){const a=et.getInstance(o);if(!a||a._config.autoClose===!1)continue;const c=e.composedPath(),u=c.includes(a._menu);if(c.includes(a._element)||a._config.autoClose==="inside"&&!u||a._config.autoClose==="outside"&&u||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===eo||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const f={relatedTarget:a._element};e.type==="click"&&(f.clickEvent=e),a._completeHide(f)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===_0,a=[g0,to].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const c=this.matches(bt)?this:de.prev(this,bt)[0]||de.next(this,bt)[0]||de.findOne(bt,e.delegateTarget.parentNode),u=et.getOrCreateInstance(c);if(a){e.stopPropagation(),u.show(),u._selectMenuItem(e);return}u._isShown()&&(e.stopPropagation(),u.hide(),c.focus())}}G.on(document,Sa,bt,et.dataApiKeydownHandler);G.on(document,Sa,vs,et.dataApiKeydownHandler);G.on(document,$a,et.clearMenus);G.on(document,S0,et.clearMenus);G.on(document,$a,bt,function(n){n.preventDefault(),et.getOrCreateInstance(this).toggle()});ze(et);const xa="backdrop",H0="fade",so="show",no=`mousedown.bs.${xa}`,q0={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},z0={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Ca extends ns{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return q0}static get DefaultType(){return z0}static get NAME(){return xa}show(e){if(!this._config.isVisible){Le(e);return}this._append();const s=this._getElement();this._config.isAnimated&&ss(s),s.classList.add(so),this._emulateAnimation(()=>{Le(e)})}hide(e){if(!this._config.isVisible){Le(e);return}this._getElement().classList.remove(so),this._emulateAnimation(()=>{this.dispose(),Le(e)})}dispose(){this._isAppended&&(G.off(this._element,no),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(H0),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ft(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),G.on(e,no,()=>{Le(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){da(e,this._getElement(),this._config.isAnimated)}}const K0="focustrap",G0="bs.focustrap",ys=`.${G0}`,Y0=`focusin${ys}`,J0=`keydown.tab${ys}`,Q0="Tab",X0="forward",oo="backward",Z0={autofocus:!0,trapElement:null},ex={autofocus:"boolean",trapElement:"element"};class Ea extends ns{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Z0}static get DefaultType(){return ex}static get NAME(){return K0}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),G.off(document,ys),G.on(document,Y0,e=>this._handleFocusin(e)),G.on(document,J0,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,G.off(document,ys))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=de.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===oo?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Q0&&(this._lastTabNavDirection=e.shiftKey?oo:X0)}}const ao=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",io=".sticky-top",cs="padding-right",lo="margin-right";class ln{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,cs,s=>s+e),this._setElementAttributes(ao,cs,s=>s+e),this._setElementAttributes(io,lo,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,cs),this._resetElementAttributes(ao,cs),this._resetElementAttributes(io,lo)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),c=u=>{if(u!==this._element&&window.innerWidth>u.clientWidth+a)return;this._saveInitialAttribute(u,s);const f=window.getComputedStyle(u).getPropertyValue(s);u.style.setProperty(s,`${o(Number.parseFloat(f))}px`)};this._applyManipulationCallback(e,c)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&at.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const c=at.getDataAttribute(a,s);if(c===null){a.style.removeProperty(s);return}at.removeDataAttribute(a,s),a.style.setProperty(s,c)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(ot(e)){s(e);return}for(const o of de.find(e,this._element))s(o)}}const tx="modal",sx="bs.modal",qe=`.${sx}`,nx=".data-api",ox="Escape",ax=`hide${qe}`,ix=`hidePrevented${qe}`,Ta=`hidden${qe}`,Aa=`show${qe}`,lx=`shown${qe}`,rx=`resize${qe}`,cx=`click.dismiss${qe}`,ux=`mousedown.dismiss${qe}`,dx=`keydown.dismiss${qe}`,fx=`click${qe}${nx}`,ro="modal-open",mx="fade",co="show",Hs="modal-static",px=".modal.show",vx=".modal-dialog",hx=".modal-body",_x='[data-bs-toggle="modal"]',gx={backdrop:!0,focus:!0,keyboard:!0},bx={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class St extends Ge{constructor(e,s){super(e,s),this._dialog=de.findOne(vx,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new ln,this._addEventListeners()}static get Default(){return gx}static get DefaultType(){return bx}static get NAME(){return tx}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||G.trigger(this._element,Aa,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(ro),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||G.trigger(this._element,ax).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(co),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){G.off(window,qe),G.off(this._dialog,qe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ca({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Ea({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=de.findOne(hx,this._dialog);s&&(s.scrollTop=0),ss(this._element),this._element.classList.add(co);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,G.trigger(this._element,lx,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){G.on(this._element,dx,e=>{if(e.key===ox){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),G.on(window,rx,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),G.on(this._element,ux,e=>{G.one(this._element,cx,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(ro),this._resetAdjustments(),this._scrollBar.reset(),G.trigger(this._element,Ta)})}_isAnimated(){return this._element.classList.contains(mx)}_triggerBackdropTransition(){if(G.trigger(this._element,ix).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Hs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Hs),this._queueCallback(()=>{this._element.classList.remove(Hs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=He()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=He()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}G.on(document,fx,_x,function(n){const e=de.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),G.one(e,Aa,a=>{a.defaultPrevented||G.one(e,Ta,()=>{Ht(this)&&this.focus()})});const s=de.findOne(px);s&&St.getInstance(s).hide(),St.getOrCreateInstance(e).toggle(this)});$s(St);ze(St);const yx="offcanvas",wx="bs.offcanvas",ct=`.${wx}`,Da=".data-api",kx=`load${ct}${Da}`,$x="Escape",uo="show",fo="showing",mo="hiding",Sx="offcanvas-backdrop",Ma=".offcanvas.show",xx=`show${ct}`,Cx=`shown${ct}`,Ex=`hide${ct}`,po=`hidePrevented${ct}`,Oa=`hidden${ct}`,Tx=`resize${ct}`,Ax=`click${ct}${Da}`,Dx=`keydown.dismiss${ct}`,Mx='[data-bs-toggle="offcanvas"]',Ox={backdrop:!0,keyboard:!0,scroll:!1},Nx={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class pt extends Ge{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Ox}static get DefaultType(){return Nx}static get NAME(){return yx}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||G.trigger(this._element,xx,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new ln().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(fo);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(uo),this._element.classList.remove(fo),G.trigger(this._element,Cx,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||G.trigger(this._element,Ex).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(mo),this._backdrop.hide();const s=()=>{this._element.classList.remove(uo,mo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new ln().reset(),G.trigger(this._element,Oa)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){G.trigger(this._element,po);return}this.hide()},s=!!this._config.backdrop;return new Ca({className:Sx,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Ea({trapElement:this._element})}_addEventListeners(){G.on(this._element,Dx,e=>{if(e.key===$x){if(this._config.keyboard){this.hide();return}G.trigger(this._element,po)}})}static jQueryInterface(e){return this.each(function(){const s=pt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}G.on(document,Ax,Mx,function(n){const e=de.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),mt(this))return;G.one(e,Oa,()=>{Ht(this)&&this.focus()});const s=de.findOne(Ma);s&&s!==e&&pt.getInstance(s).hide(),pt.getOrCreateInstance(e).toggle(this)});G.on(window,kx,()=>{for(const n of de.find(Ma))pt.getOrCreateInstance(n).show()});G.on(window,Tx,()=>{for(const n of de.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&pt.getOrCreateInstance(n).hide()});$s(pt);ze(pt);const Lx=/^aria-[\w-]*$/i,Na={"*":["class","dir","id","lang","role",Lx],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Ix=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),jx=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Px=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Ix.has(s)?!!jx.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Rx(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),c=[].concat(...a.body.querySelectorAll("*"));for(const u of c){const f=u.nodeName.toLowerCase();if(!Object.keys(e).includes(f)){u.remove();continue}const m=[].concat(...u.attributes),p=[].concat(e["*"]||[],e[f]||[]);for(const d of m)Px(d,p)||u.removeAttribute(d.nodeName)}return a.body.innerHTML}const Fx="TemplateFactory",Bx={allowList:Na,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Vx={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Wx={entry:"(string|element|function|null)",selector:"(string|element)"};class Ux extends ns{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Bx}static get DefaultType(){return Vx}static get NAME(){return Fx}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,c]of Object.entries(this._config.content))this._setContent(e,c,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},Wx)}_setContent(e,s,o){const a=de.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(ot(s)){this._putElementInTemplate(ft(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Rx(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Le(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Hx="tooltip",qx=new Set(["sanitize","allowList","sanitizeFn"]),qs="fade",zx="modal",us="show",Kx=".tooltip-inner",vo=`.${zx}`,ho="hide.bs.modal",Gt="hover",zs="focus",Ks="click",Gx="manual",Yx="hide",Jx="hidden",Qx="show",Xx="shown",Zx="inserted",eC="click",tC="focusin",sC="focusout",nC="mouseenter",oC="mouseleave",aC={AUTO:"auto",TOP:"top",RIGHT:He()?"left":"right",BOTTOM:"bottom",LEFT:He()?"right":"left"},iC={allowList:Na,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},lC={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class zt extends Ge{constructor(e,s){if(typeof ia>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return iC}static get DefaultType(){return lC}static get NAME(){return Hx}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),G.off(this._element.closest(vo),ho,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=G.trigger(this._element,this.constructor.eventName(Qx)),o=(ca(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:c}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(c.append(a),G.trigger(this._element,this.constructor.eventName(Zx))),this._popper=this._createPopper(a),a.classList.add(us),"ontouchstart"in document.documentElement)for(const f of[].concat(...document.body.children))G.on(f,"mouseover",gs);const u=()=>{G.trigger(this._element,this.constructor.eventName(Xx)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(u,this.tip,this._isAnimated())}hide(){if(!this._isShown()||G.trigger(this._element,this.constructor.eventName(Yx)).defaultPrevented)return;if(this._getTipElement().classList.remove(us),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))G.off(a,"mouseover",gs);this._activeTrigger[Ks]=!1,this._activeTrigger[zs]=!1,this._activeTrigger[Gt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),G.trigger(this._element,this.constructor.eventName(Jx)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(qs,us),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=G$(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(qs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Ux({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Kx]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(qs)}_isShown(){return this.tip&&this.tip.classList.contains(us)}_createPopper(e){const s=Le(this._config.placement,[this,e,this._element]),o=aC[s.toUpperCase()];return bn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Le(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Le(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")G.on(this._element,this.constructor.eventName(eC),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[Ks]=!(a._isShown()&&a._activeTrigger[Ks]),a.toggle()});else if(s!==Gx){const o=s===Gt?this.constructor.eventName(nC):this.constructor.eventName(tC),a=s===Gt?this.constructor.eventName(oC):this.constructor.eventName(sC);G.on(this._element,o,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusin"?zs:Gt]=!0,u._enter()}),G.on(this._element,a,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusout"?zs:Gt]=u._element.contains(c.relatedTarget),u._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},G.on(this._element.closest(vo),ho,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=at.getDataAttributes(this._element);for(const o of Object.keys(s))qx.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ft(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=zt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(zt);const rC="popover",cC=".popover-header",uC=".popover-body",dC={...zt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},fC={...zt.DefaultType,content:"(null|string|element|function)"};class $n extends zt{static get Default(){return dC}static get DefaultType(){return fC}static get NAME(){return rC}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[cC]:this._getTitle(),[uC]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=$n.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze($n);const mC="scrollspy",pC="bs.scrollspy",Sn=`.${pC}`,vC=".data-api",hC=`activate${Sn}`,_o=`click${Sn}`,_C=`load${Sn}${vC}`,gC="dropdown-item",Tt="active",bC='[data-bs-spy="scroll"]',Gs="[href]",yC=".nav, .list-group",go=".nav-link",wC=".nav-item",kC=".list-group-item",$C=`${go}, ${wC} > ${go}, ${kC}`,SC=".dropdown",xC=".dropdown-toggle",CC={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},EC={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Cs extends Ge{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return CC}static get DefaultType(){return EC}static get NAME(){return mC}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ft(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(G.off(this._config.target,_o),G.on(this._config.target,_o,Gs,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=u=>this._targetLinks.get(`#${u.target.id}`),o=u=>{this._previousScrollData.visibleEntryTop=u.target.offsetTop,this._process(s(u))},a=(this._rootElement||document.documentElement).scrollTop,c=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const u of e){if(!u.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(u));continue}const f=u.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(c&&f){if(o(u),!a)return;continue}!c&&!f&&o(u)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=de.find(Gs,this._config.target);for(const s of e){if(!s.hash||mt(s))continue;const o=de.findOne(decodeURI(s.hash),this._element);Ht(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Tt),this._activateParents(e),G.trigger(this._element,hC,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(gC)){de.findOne(xC,e.closest(SC)).classList.add(Tt);return}for(const s of de.parents(e,yC))for(const o of de.prev(s,$C))o.classList.add(Tt)}_clearActiveClass(e){e.classList.remove(Tt);const s=de.find(`${Gs}.${Tt}`,e);for(const o of s)o.classList.remove(Tt)}static jQueryInterface(e){return this.each(function(){const s=Cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(window,_C,()=>{for(const n of de.find(bC))Cs.getOrCreateInstance(n)});ze(Cs);const TC="tab",AC="bs.tab",Ct=`.${AC}`,DC=`hide${Ct}`,MC=`hidden${Ct}`,OC=`show${Ct}`,NC=`shown${Ct}`,LC=`click${Ct}`,IC=`keydown${Ct}`,jC=`load${Ct}`,PC="ArrowLeft",bo="ArrowRight",RC="ArrowUp",yo="ArrowDown",Ys="Home",wo="End",yt="active",ko="fade",Js="show",FC="dropdown",La=".dropdown-toggle",BC=".dropdown-menu",Qs=`:not(${La})`,VC='.list-group, .nav, [role="tablist"]',WC=".nav-item, .list-group-item",UC=`.nav-link${Qs}, .list-group-item${Qs}, [role="tab"]${Qs}`,Ia='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Xs=`${UC}, ${Ia}`,HC=`.${yt}[data-bs-toggle="tab"], .${yt}[data-bs-toggle="pill"], .${yt}[data-bs-toggle="list"]`;class Bt extends Ge{constructor(e){super(e),this._parent=this._element.closest(VC),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),G.on(this._element,IC,s=>this._keydown(s)))}static get NAME(){return TC}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?G.trigger(s,DC,{relatedTarget:e}):null;G.trigger(e,OC,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(yt),this._activate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Js);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),G.trigger(e,NC,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(ko))}_deactivate(e,s){if(!e)return;e.classList.remove(yt),e.blur(),this._deactivate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Js);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),G.trigger(e,MC,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(ko))}_keydown(e){if(![PC,bo,RC,yo,Ys,wo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!mt(a));let o;if([Ys,wo].includes(e.key))o=s[e.key===Ys?0:s.length-1];else{const a=[bo,yo].includes(e.key);o=yn(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),Bt.getOrCreateInstance(o).show())}_getChildren(){return de.find(Xs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=de.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(FC))return;const a=(c,u)=>{const f=de.findOne(c,o);f&&f.classList.toggle(u,s)};a(La,yt),a(BC,Js),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(yt)}_getInnerElement(e){return e.matches(Xs)?e:de.findOne(Xs,e)}_getOuterElement(e){return e.closest(WC)||e}static jQueryInterface(e){return this.each(function(){const s=Bt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(document,LC,Ia,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!mt(this)&&Bt.getOrCreateInstance(this).show()});G.on(window,jC,()=>{for(const n of de.find(HC))Bt.getOrCreateInstance(n)});ze(Bt);const qC="toast",zC="bs.toast",_t=`.${zC}`,KC=`mouseover${_t}`,GC=`mouseout${_t}`,YC=`focusin${_t}`,JC=`focusout${_t}`,QC=`hide${_t}`,XC=`hidden${_t}`,ZC=`show${_t}`,eE=`shown${_t}`,tE="fade",$o="hide",ds="show",fs="showing",sE={animation:"boolean",autohide:"boolean",delay:"number"},nE={animation:!0,autohide:!0,delay:5e3};class Es extends Ge{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return nE}static get DefaultType(){return sE}static get NAME(){return qC}show(){if(G.trigger(this._element,ZC).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(tE);const s=()=>{this._element.classList.remove(fs),G.trigger(this._element,eE),this._maybeScheduleHide()};this._element.classList.remove($o),ss(this._element),this._element.classList.add(ds,fs),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||G.trigger(this._element,QC).defaultPrevented)return;const s=()=>{this._element.classList.add($o),this._element.classList.remove(fs,ds),G.trigger(this._element,XC)};this._element.classList.add(fs),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ds),super.dispose()}isShown(){return this._element.classList.contains(ds)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){G.on(this._element,KC,e=>this._onInteraction(e,!0)),G.on(this._element,GC,e=>this._onInteraction(e,!1)),G.on(this._element,YC,e=>this._onInteraction(e,!0)),G.on(this._element,JC,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Es.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}$s(Es);ze(Es);const oE={class:"modal-dialog modal-lg"},aE={class:"modal-content"},iE={class:"modal-body"},lE={key:0,class:"text-center py-4"},rE={key:1,class:"alert alert-danger"},cE={key:2},uE={class:"mb-3"},dE={class:"small text-muted mb-2"},fE={key:0},mE={key:0,class:"alert alert-info"},pE={key:1},vE={class:"table table-sm table-striped"},hE={key:2,class:"mt-3"},_E={key:3,class:"mt-3"},gE={class:"modal-footer"},bE=["disabled"],yE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=N(null);let u=null;const f=N(!1),m=N(""),p=N([]);me(c,y=>{y&&(u=new St(y),y.addEventListener("hidden.bs.modal",()=>{a("close")}))});function d(){u&&(u.show(),h())}function w(){u&&u.hide()}async function h(){f.value=!0,m.value="",p.value=[];try{const y=await ke.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});p.value=y.permissions||[]}catch(y){console.error("Failed to load permissions:",y),m.value=y.response?.data?.detail||y.message||"Failed to load permissions"}finally{f.value=!1}}function $(){h()}function S(y){switch(y){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:d,hide:w}),(y,g)=>(i(),r("div",{ref_key:"modalRef",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",oE,[t("div",aE,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",iE,[f.value?(i(),r("div",lE,[...g[0]||(g[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(i(),r("div",rE,b(m.value),1)):(i(),r("div",cE,[t("div",uE,[g[2]||(g[2]=t("h6",null,"Settings Sources",-1)),t("div",dE,[g[1]||(g[1]=ue(" Loading permissions from: ",-1)),(i(!0),r(ne,null,ce(n.settingSources,(v,l)=>(i(),r("span",{key:v},[t("code",null,b(v),1),l<n.settingSources.length-1?(i(),r("span",fE,", ")):T("",!0)]))),128))])]),p.value.length===0?(i(),r("div",mE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),r("div",pE,[t("h6",null,"Pre-approved Permissions ("+b(p.value.length)+")",1),t("table",vE,[g[3]||(g[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),r(ne,null,ce(p.value,v=>(i(),r("tr",{key:v.permission},[t("td",null,[t("code",null,b(v.permission),1)]),t("td",null,[(i(!0),r(ne,null,ce(v.sources,(l,k)=>(i(),r("span",{key:l,class:z(["badge me-1",S(l)])},b(l),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),r("div",hE,[g[4]||(g[4]=t("h6",null,"Session Allowed Tools",-1)),g[5]||(g[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),r(ne,null,ce(n.sessionAllowedTools,v=>(i(),r("span",{key:v,class:"badge bg-success me-1 mb-1"},b(v),1))),128))])])):T("",!0),n.sessionDisallowedTools.length>0?(i(),r("div",_E,[g[6]||(g[6]=t("h6",null,"Session Disallowed Tools",-1)),g[7]||(g[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(i(!0),r(ne,null,ce(n.sessionDisallowedTools,v=>(i(),r("span",{key:v,class:"badge bg-danger me-1 mb-1"},b(v),1))),128))])])):T("",!0)]))]),t("div",gE,[g[8]||(g[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:$,disabled:f.value}," Refresh ",8,bE)])])])],512))}},wE=se(yE,[["__scopeId","data-v-2078b366"]]),kE={class:"modal-dialog modal-lg modal-dialog-centered"},$E={class:"modal-content"},SE={class:"modal-header"},xE={id:"configurationModalLabel",class:"modal-title"},CE={class:"modal-body"},EE={key:0,class:"template-list-view"},TE={key:0,class:"alert alert-info"},AE={class:"card-body"},DE={class:"d-flex justify-content-between align-items-start"},ME={class:"flex-grow-1"},OE={class:"card-title mb-1"},NE={key:0,class:"card-text text-muted small mb-2"},LE={class:"template-meta"},IE={class:"badge bg-secondary me-2"},jE={class:"text-muted small"},PE={class:"btn-group btn-group-sm ms-3"},RE=["onClick"],FE=["onClick"],BE={key:1},VE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},WE={class:"nav-item",role:"presentation"},UE={key:0,class:"error-indicator",title:"This tab has validation errors"},HE={class:"nav-item",role:"presentation"},qE={key:0,class:"error-indicator",title:"This tab has validation errors"},zE={class:"nav-item",role:"presentation"},KE={key:0,class:"error-indicator",title:"This tab has validation errors"},GE={class:"nav-item",role:"presentation"},YE={class:"tab-content"},JE={key:2,class:"alert alert-danger mt-3"},QE={key:0},XE={key:1},ZE={class:"modal-footer"},eT={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},tT=["disabled"],sT={key:0,class:"spinner-border spinner-border-sm me-2"},nT={__name:"ConfigurationModal",setup(n){const e=Zt(),s=Ve(),o=pe(),a=xe(),c=N(null);let u=null;const f=N(null),m=N("create-session"),p=N("general"),d=N(null),w=N(null),h=N(null),$=N([]),S=N(null),y=N(null),g=N({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),v=Ms({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),l=Ms({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),k=Ms({name:""}),x=_(()=>({general:!!k.name,permissions:!1,advanced:!1})),E=N(!1),O=N(""),A=_(()=>m.value==="create-session"||m.value==="edit-session"),D=_(()=>m.value==="edit-session"||m.value==="edit-template"),C=_(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),M=_(()=>E.value?D.value?"Saving...":"Creating...":D.value?"Save Changes":A.value?"Create Session":"Save Template"),q=_(()=>!(!l.name.trim()||A.value&&l.name.includes(" "))),B=_(()=>w.value?.state==="active"||w.value?.state==="starting"),V=_(()=>{if(!w.value)return!1;const F=(l.initialization_context||"")!==(w.value.system_prompt||""),te=(l.override_system_prompt||!1)!==(w.value.override_system_prompt||!1),ie=(l.sandbox_enabled||!1)!==(w.value.sandbox_enabled||!1);if(F||te||ie)return!0;if(l.sandbox_enabled){const we=w.value.sandbox_config||{},fe=l.sandbox,Te=JSON.stringify({autoAllowBashIfSandboxed:we.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:we.allowUnsandboxedCommands??!1,excludedCommands:(we.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:we.enableWeakerNestedSandbox??!1,network:{allowedDomains:(we.network?.allowedDomains||[]).join(", "),allowLocalBinding:we.network?.allowLocalBinding??!1,allowUnixSockets:(we.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:we.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(we.ignoreViolations?.file||[]).join(", "),network:(we.ignoreViolations?.network||[]).join(", ")}}),Ae=JSON.stringify({autoAllowBashIfSandboxed:fe.autoAllowBashIfSandboxed,allowUnsandboxedCommands:fe.allowUnsandboxedCommands,excludedCommands:fe.excludedCommands,enableWeakerNestedSandbox:fe.enableWeakerNestedSandbox,network:{allowedDomains:fe.network.allowedDomains,allowLocalBinding:fe.network.allowLocalBinding,allowUnixSockets:fe.network.allowUnixSockets,allowAllUnixSockets:fe.network.allowAllUnixSockets},ignoreViolations:{file:fe.ignoreViolations.file,network:fe.ignoreViolations.network}});if(Te!==Ae)return!0}return!1}),U=_(()=>{if(!w.value)return!1;const F=(l.model||"sonnet")!==(w.value.model||"sonnet"),te=(l.allowed_tools||"")!==(w.value.allowed_tools?.join(", ")||""),ie=w.value.setting_sources||["user","project","local"],we=l.setting_sources||["user","project","local"],fe=JSON.stringify([...ie].sort())!==JSON.stringify([...we].sort());return F||te||fe}),J=_(()=>V.value?"reset":U.value?"restart":null),ae=_(()=>m.value==="edit-session"&&B.value&&J.value!==null),L=_(()=>w.value?.working_directory?w.value.working_directory:l.working_directory?l.working_directory:s.projects.get(d.value)?.working_directory||""),j=_(()=>!l.allowed_tools||!l.allowed_tools.trim()?[]:l.allowed_tools.split(",").map(F=>F.trim()).filter(F=>F.length>0)),R=_(()=>!l.disallowed_tools||!l.disallowed_tools.trim()?[]:l.disallowed_tools.split(",").map(F=>F.trim()).filter(F=>F.length>0));function H(){f.value&&f.value.show()}function X(){const F=te=>te.split(",").map(ie=>ie.trim()).filter(ie=>ie.length>0);return{autoAllowBashIfSandboxed:l.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:l.sandbox.allowUnsandboxedCommands,excludedCommands:F(l.sandbox.excludedCommands),enableWeakerNestedSandbox:l.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:F(l.sandbox.network.allowedDomains),allowLocalBinding:l.sandbox.network.allowLocalBinding,allowUnixSockets:F(l.sandbox.network.allowUnixSockets),allowAllUnixSockets:l.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:F(l.sandbox.ignoreViolations.file),network:F(l.sandbox.ignoreViolations.network)}}}function ee(F,te){l[F]=te,F==="name"&&(k.name="")}function he(F){S.value=F,_e()}async function Q(){try{const F=await ke.get("/api/templates");$.value=F||[]}catch(F){console.error("Failed to load templates:",F),$.value=[]}}function _e(){if(!S.value){l.default_role="",l.initialization_context="",l.permission_mode="default",l.allowed_tools="",l.disallowed_tools="",l.model="sonnet",l.capabilities="",l.override_system_prompt=!1,l.sandbox_enabled=!1,l.sandbox.autoAllowBashIfSandboxed=!0,l.sandbox.allowUnsandboxedCommands=!1,l.sandbox.excludedCommands="",l.sandbox.enableWeakerNestedSandbox=!1,l.sandbox.network.allowedDomains="",l.sandbox.network.allowLocalBinding=!1,l.sandbox.network.allowUnixSockets="",l.sandbox.network.allowAllUnixSockets=!1,l.sandbox.ignoreViolations.file="",l.sandbox.ignoreViolations.network="",v.default_role="normal",v.initialization_context="normal",v.permission_mode="normal",v.allowed_tools="normal",v.disallowed_tools="normal",v.model="normal",v.capabilities="normal",v.sandbox_excludedCommands="normal",v.sandbox_network_allowedDomains="normal",v.sandbox_network_allowUnixSockets="normal",v.sandbox_ignoreViolations_file="normal",v.sandbox_ignoreViolations_network="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const F=$.value.find(Qe=>Qe.template_id===S.value);if(!F)return;if(v.default_role="normal",v.initialization_context="normal",v.permission_mode="normal",v.allowed_tools="normal",v.disallowed_tools="normal",v.model="normal",v.capabilities="normal",v.sandbox_excludedCommands="normal",v.sandbox_network_allowedDomains="normal",v.sandbox_network_allowUnixSockets="normal",v.sandbox_ignoreViolations_file="normal",v.sandbox_ignoreViolations_network="normal",F.default_role?(l.default_role=F.default_role,g.value.default_role=F.default_role,v.default_role="autofilled"):(l.default_role="",g.value.default_role=null),F.default_system_prompt?(l.initialization_context=F.default_system_prompt,g.value.initialization_context=F.default_system_prompt,v.initialization_context="autofilled"):(l.initialization_context="",g.value.initialization_context=null),F.permission_mode?(l.permission_mode=F.permission_mode,g.value.permission_mode=F.permission_mode,v.permission_mode="autofilled"):(l.permission_mode="default",g.value.permission_mode=null),F.allowed_tools&&F.allowed_tools.length>0){const Qe=F.allowed_tools.join(", ");l.allowed_tools=Qe,g.value.allowed_tools=Qe,v.allowed_tools="autofilled"}else l.allowed_tools="",g.value.allowed_tools=null;if(F.disallowed_tools&&F.disallowed_tools.length>0){const Qe=F.disallowed_tools.join(", ");l.disallowed_tools=Qe,g.value.disallowed_tools=Qe,v.disallowed_tools="autofilled"}else l.disallowed_tools="",g.value.disallowed_tools=null;if(F.model?(l.model=F.model,g.value.model=F.model,v.model="autofilled"):(l.model="sonnet",g.value.model=null),F.capabilities&&F.capabilities.length>0){const Qe=F.capabilities.join(", ");l.capabilities=Qe,g.value.capabilities=Qe,v.capabilities="autofilled"}else l.capabilities="",g.value.capabilities=null;l.override_system_prompt=F.override_system_prompt||!1,l.sandbox_enabled=F.sandbox_enabled||!1;const te=F.sandbox_config||{};l.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,l.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,l.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};l.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,l.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const we=(te.excludedCommands||[]).join(", ");l.sandbox.excludedCommands=we,g.value.sandbox_excludedCommands=we||null,we&&(v.sandbox_excludedCommands="autofilled");const fe=(ie.allowedDomains||[]).join(", ");l.sandbox.network.allowedDomains=fe,g.value.sandbox_network_allowedDomains=fe||null,fe&&(v.sandbox_network_allowedDomains="autofilled");const Te=(ie.allowUnixSockets||[]).join(", ");l.sandbox.network.allowUnixSockets=Te,g.value.sandbox_network_allowUnixSockets=Te||null,Te&&(v.sandbox_network_allowUnixSockets="autofilled");const Ae=te.ignoreViolations||{},Ts=(Ae.file||[]).join(", ");l.sandbox.ignoreViolations.file=Ts,g.value.sandbox_ignoreViolations_file=Ts||null,Ts&&(v.sandbox_ignoreViolations_file="autofilled");const As=(Ae.network||[]).join(", ");l.sandbox.ignoreViolations.network=As,g.value.sandbox_ignoreViolations_network=As||null,As&&(v.sandbox_ignoreViolations_network="autofilled")}function K(){const te=(d.value?s.projects.get(d.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:te,currentPath:l.working_directory||"",onSelect:ie=>{l.working_directory=ie}})}function P(){m.value==="create-session"&&(y.value={mode:"create-session",projectId:d.value,formData:{...l},selectedTemplateId:S.value}),m.value="template-list",ge()}function I(){m.value="create-template",ge(),p.value="general"}function W(F){m.value="edit-template",h.value=F,ge(),st(F),p.value="general"}async function Z(F){if(confirm(`Delete template "${F.name}"?

This action cannot be undone.`))try{await ke.delete(`/api/templates/${F.template_id}`),await Q()}catch(te){console.error("Failed to delete template:",te),O.value=te.response?.data?.detail||"Failed to delete template"}}function oe(){let F=!0;return k.name="",l.name.trim()||(k.name="Name is required",F=!1),A.value&&l.name.includes(" ")&&(k.name="Session name must be a single word (no spaces)",F=!1),F}async function $e(){if(!oe()){k.name&&(p.value="general");return}E.value=!0,O.value="";try{switch(m.value){case"create-session":await Ye(),u&&u.hide();break;case"edit-session":await Y(),u&&u.hide();break;case"create-template":await re();break;case"edit-template":await ve();break}}catch(F){console.error("Submit failed:",F),O.value=F.response?.data?.detail||F.message||"Operation failed. Please try again."}finally{E.value=!1}}async function Ye(){if(!d.value)throw new Error("Project ID is missing");const F=l.allowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),te=l.disallowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ie=l.capabilities.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),we={name:l.name.trim(),model:l.model||null,role:l.default_role.trim()||null,initialization_context:l.initialization_context.trim()||null,override_system_prompt:l.override_system_prompt,capabilities:ie.length>0?ie:null,permission_mode:l.permission_mode,allowed_tools:F.length>0?F:null,disallowed_tools:te.length>0?te:null,working_directory:l.working_directory.trim()||null,sandbox_enabled:l.sandbox_enabled,sandbox_config:l.sandbox_enabled?X():null,setting_sources:l.setting_sources},fe=await ke.post(`/api/legions/${d.value}/minions`,we);if(fe.success&&fe.minion_id)await s.fetchProjects(),await o.fetchSessions(),l.startImmediately&&await o.startSession(fe.minion_id),e.push(`/session/${fe.minion_id}`);else throw new Error("Failed to create session")}async function Y(){if(!w.value)throw new Error("Session data is missing");const F=w.value.session_id,te=w.value.state==="active"||w.value.state==="starting",ie=l.allowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),we=l.disallowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),fe=l.capabilities.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),Te={name:l.name.trim(),model:l.model,role:l.default_role.trim()||null,system_prompt:l.initialization_context.trim()||null,override_system_prompt:l.override_system_prompt,allowed_tools:ie.length>0?ie:null,disallowed_tools:we.length>0?we:null,capabilities:fe.length>0?fe:null,sandbox_enabled:l.sandbox_enabled,sandbox_config:l.sandbox_enabled?X():null,setting_sources:l.setting_sources};await o.patchSession(F,Te),te&&l.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(F,l.permission_mode)}async function re(){const F=l.allowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),te=l.disallowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),ie=l.capabilities.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),we={name:l.name.trim(),description:l.description.trim()||null,permission_mode:l.permission_mode,allowed_tools:F.length>0?F:null,disallowed_tools:te.length>0?te:null,default_role:l.default_role.trim()||null,default_system_prompt:l.initialization_context.trim()||null,model:l.model||null,capabilities:ie.length>0?ie:null,override_system_prompt:l.override_system_prompt,sandbox_enabled:l.sandbox_enabled,sandbox_config:l.sandbox_enabled?X():null};await ke.post("/api/templates",we),await Q(),m.value="template-list",ge()}async function ve(){if(!h.value)throw new Error("Template data is missing");const F=l.allowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),te=l.disallowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),ie=l.capabilities.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),we={name:l.name.trim(),description:l.description.trim()||null,permission_mode:l.permission_mode,allowed_tools:F.length>0?F:null,disallowed_tools:te.length>0?te:null,default_role:l.default_role.trim()||null,default_system_prompt:l.initialization_context.trim()||null,model:l.model||null,capabilities:ie.length>0?ie:null,override_system_prompt:l.override_system_prompt,sandbox_enabled:l.sandbox_enabled,sandbox_config:l.sandbox_enabled?X():null};await ke.put(`/api/templates/${h.value.template_id}`,we),await Q(),m.value="template-list",h.value=null,ge()}function ge(){l.name="",l.model="sonnet",l.permission_mode="default",l.working_directory="",l.description="",l.default_role="",l.startImmediately=!0,l.allowed_tools="",l.disallowed_tools="",l.capabilities="",l.setting_sources=["user","project","local"],l.system_prompt="",l.override_system_prompt=!1,l.initialization_context="",l.sandbox_enabled=!1,l.sandbox.autoAllowBashIfSandboxed=!0,l.sandbox.allowUnsandboxedCommands=!1,l.sandbox.excludedCommands="",l.sandbox.enableWeakerNestedSandbox=!1,l.sandbox.network.allowedDomains="",l.sandbox.network.allowLocalBinding=!1,l.sandbox.network.allowUnixSockets="",l.sandbox.network.allowAllUnixSockets=!1,l.sandbox.ignoreViolations.file="",l.sandbox.ignoreViolations.network="",k.name="",v.default_role="normal",v.initialization_context="normal",v.permission_mode="normal",v.allowed_tools="normal",v.disallowed_tools="normal",v.model="normal",v.capabilities="normal",v.sandbox_excludedCommands="normal",v.sandbox_network_allowedDomains="normal",v.sandbox_network_allowUnixSockets="normal",v.sandbox_ignoreViolations_file="normal",v.sandbox_ignoreViolations_network="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},S.value=null,O.value="",p.value="general"}function Ee(F){l.name=F.name||"",l.model=F.model||"sonnet",l.permission_mode=F.current_permission_mode||"default",l.working_directory=F.working_directory||"",l.default_role=F.role||"",l.initialization_context=F.system_prompt||"",l.override_system_prompt=F.override_system_prompt||!1,l.system_prompt="",l.allowed_tools=F.allowed_tools?.join(", ")||"",l.disallowed_tools=F.disallowed_tools?.join(", ")||"",l.capabilities=F.capabilities?.join(", ")||"",l.sandbox_enabled=F.sandbox_enabled||!1,l.setting_sources=F.setting_sources||["user","project","local"];const te=F.sandbox_config||{};l.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,l.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,l.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),l.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};l.sandbox.network.allowedDomains=(ie.allowedDomains||[]).join(", "),l.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,l.sandbox.network.allowUnixSockets=(ie.allowUnixSockets||[]).join(", "),l.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const we=te.ignoreViolations||{};l.sandbox.ignoreViolations.file=(we.file||[]).join(", "),l.sandbox.ignoreViolations.network=(we.network||[]).join(", ")}function st(F){l.name=F.name||"",l.description=F.description||"",l.permission_mode=F.permission_mode||"default",l.default_role=F.default_role||"",l.initialization_context=F.default_system_prompt||"",l.allowed_tools=F.allowed_tools?.join(", ")||"",l.disallowed_tools=F.disallowed_tools?.join(", ")||"",l.model=F.model||"sonnet",l.capabilities=F.capabilities?.join(", ")||"",l.override_system_prompt=F.override_system_prompt||!1,l.sandbox_enabled=F.sandbox_enabled||!1;const te=F.sandbox_config||{};l.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,l.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,l.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),l.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};l.sandbox.network.allowedDomains=(ie.allowedDomains||[]).join(", "),l.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,l.sandbox.network.allowUnixSockets=(ie.allowUnixSockets||[]).join(", "),l.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const we=te.ignoreViolations||{};l.sandbox.ignoreViolations.file=(we.file||[]).join(", "),l.sandbox.ignoreViolations.network=(we.network||[]).join(", ")}function Je(){dt(()=>{const F=document.getElementById("config-name");F&&(F.focus(),D.value&&F.select())})}function gt(){ge(),m.value="create-session",d.value=null,w.value=null,h.value=null,a.hideModal()}return me(()=>a.currentModal,async(F,te)=>{if(!(!F||!u)){if(F.name==="configuration"){const ie=F.data||{};m.value=ie.mode||"create-session",d.value=ie.project?.project_id||ie.projectId||null,w.value=ie.session||null,h.value=ie.template||null,ge(),m.value==="create-session"&&await Q(),m.value==="edit-session"&&w.value?Ee(w.value):m.value==="edit-template"&&h.value&&st(h.value),u.show()}else if(F.name==="create-minion"||F.name==="create-session"){const ie=F.data||{};m.value="create-session",d.value=ie.project?.project_id||null,w.value=null,h.value=null,ge(),await Q(),u.show()}else if(F.name==="edit-session"){const ie=F.data||{};m.value="edit-session",w.value=ie.session||null,d.value=w.value?.project_id||null,h.value=null,ge(),w.value&&Ee(w.value),u.show()}else F.name==="template-management"&&(m.value="template-list",ge(),await Q(),u.show());te?.name==="configuration"&&te.data?.mode?.includes("template")&&F?.name==="configuration"&&m.value==="create-session"&&await Q()}}),me(()=>l.default_role,F=>{g.value.default_role!==null&&(v.default_role=F===g.value.default_role?"autofilled":"modified")}),me(()=>l.initialization_context,F=>{g.value.initialization_context!==null&&(v.initialization_context=F===g.value.initialization_context?"autofilled":"modified")}),me(()=>l.permission_mode,F=>{g.value.permission_mode!==null&&(v.permission_mode=F===g.value.permission_mode?"autofilled":"modified")}),me(()=>l.allowed_tools,F=>{g.value.allowed_tools!==null&&(v.allowed_tools=F===g.value.allowed_tools?"autofilled":"modified")}),me(()=>l.disallowed_tools,F=>{g.value.disallowed_tools!==null&&(v.disallowed_tools=F===g.value.disallowed_tools?"autofilled":"modified")}),me(()=>l.model,F=>{g.value.model!==null&&(v.model=F===g.value.model?"autofilled":"modified")}),me(()=>l.capabilities,F=>{g.value.capabilities!==null&&(v.capabilities=F===g.value.capabilities?"autofilled":"modified")}),me(()=>l.sandbox.excludedCommands,F=>{g.value.sandbox_excludedCommands!==null&&(v.sandbox_excludedCommands=F===g.value.sandbox_excludedCommands?"autofilled":"modified")}),me(()=>l.sandbox.network.allowedDomains,F=>{g.value.sandbox_network_allowedDomains!==null&&(v.sandbox_network_allowedDomains=F===g.value.sandbox_network_allowedDomains?"autofilled":"modified")}),me(()=>l.sandbox.network.allowUnixSockets,F=>{g.value.sandbox_network_allowUnixSockets!==null&&(v.sandbox_network_allowUnixSockets=F===g.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),me(()=>l.sandbox.ignoreViolations.file,F=>{g.value.sandbox_ignoreViolations_file!==null&&(v.sandbox_ignoreViolations_file=F===g.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),me(()=>l.sandbox.ignoreViolations.network,F=>{g.value.sandbox_ignoreViolations_network!==null&&(v.sandbox_ignoreViolations_network=F===g.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),Me(()=>{c.value&&je(()=>import("./modal-D6mKceGM.js").then(F=>F.m),__vite__mapDeps([0,1])).then(F=>{const te=F.default;u=new te(c.value),c.value.addEventListener("shown.bs.modal",Je),c.value.addEventListener("hidden.bs.modal",gt)})}),De(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",Je),c.value.removeEventListener("hidden.bs.modal",gt)),u&&u.dispose()}),(F,te)=>(i(),r(ne,null,[t("div",{ref_key:"modalElement",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",kE,[t("div",$E,[t("div",SE,[t("h5",xE,[m.value==="create-template"||m.value==="edit-template"?(i(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:P,title:"Back to template list"}," â† ")):T("",!0),ue(" "+b(C.value),1)]),te[4]||(te[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",CE,[m.value==="template-list"?(i(),r("div",EE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[te[5]||(te[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:I,class:"btn btn-primary btn-sm"}," + Create New ")]),$.value.length===0?(i(),r("div",TE," No templates found. Create your first template! ")):T("",!0),(i(!0),r(ne,null,ce($.value,ie=>(i(),r("div",{key:ie.template_id,class:"card mb-2"},[t("div",AE,[t("div",DE,[t("div",ME,[t("h6",OE,b(ie.name),1),ie.description?(i(),r("p",NE,b(ie.description),1)):T("",!0),t("div",LE,[t("span",IE,b(ie.permission_mode),1),t("span",jE,b(ie.allowed_tools?.length||0)+" tools",1)])]),t("div",PE,[t("button",{onClick:we=>W(ie),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,RE),t("button",{onClick:we=>Z(ie),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,FE)])])])]))),128))])):(i(),r("div",BE,[t("ul",VE,[t("li",WE,[t("button",{class:z(["nav-link",{active:p.value==="general","has-error":x.value.general}]),type:"button",onClick:te[0]||(te[0]=ie=>p.value="general")},[te[6]||(te[6]=ue(" General ",-1)),x.value.general?(i(),r("span",UE)):T("",!0)],2)]),t("li",HE,[t("button",{class:z(["nav-link",{active:p.value==="permissions","has-error":x.value.permissions}]),type:"button",onClick:te[1]||(te[1]=ie=>p.value="permissions")},[te[7]||(te[7]=ue(" Permissions ",-1)),x.value.permissions?(i(),r("span",qE)):T("",!0)],2)]),t("li",zE,[t("button",{class:z(["nav-link",{active:p.value==="advanced","has-error":x.value.advanced}]),type:"button",onClick:te[2]||(te[2]=ie=>p.value="advanced")},[te[8]||(te[8]=ue(" Advanced ",-1)),x.value.advanced?(i(),r("span",KE)):T("",!0)],2)]),t("li",GE,[t("button",{class:z(["nav-link",{active:p.value==="sandbox"}]),type:"button",onClick:te[3]||(te[3]=ie=>p.value="sandbox")}," Sandbox ",2)])]),t("div",YE,[Se(be(Mw,{mode:m.value,"form-data":l,errors:k,templates:$.value,"selected-template-id":S.value,session:w.value,"field-states":v,"onUpdate:formData":ee,"onUpdate:selectedTemplateId":he,onOpenFolderBrowser:K,onOpenTemplateManager:P},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[nt,p.value==="general"]]),Se(be(_k,{mode:m.value,"form-data":l,errors:k,session:w.value,"field-states":v,"onUpdate:formData":ee,onPreviewPermissions:H},null,8,["mode","form-data","errors","session","field-states"]),[[nt,p.value==="permissions"]]),Se(be(jk,{mode:m.value,"form-data":l,errors:k,session:w.value,"field-states":v,"onUpdate:formData":ee},null,8,["mode","form-data","errors","session","field-states"]),[[nt,p.value==="advanced"]]),Se(be(l$,{mode:m.value,"form-data":l,errors:k,session:w.value,"field-states":v,"onUpdate:formData":ee},null,8,["mode","form-data","errors","session","field-states"]),[[nt,p.value==="sandbox"]])])])),O.value?(i(),r("div",JE,b(O.value),1)):T("",!0)]),ae.value?(i(),r("div",{key:0,class:z(["warning-banner","warning-banner-"+J.value])},[J.value==="reset"?(i(),r("small",QE,[...te[9]||(te[9]=[ue(" Changes require a ",-1),t("strong",null,"reset",-1),ue(" to take effect. This starts a new conversation. ",-1)])])):(i(),r("small",XE,[...te[10]||(te[10]=[ue(" Changes require a ",-1),t("strong",null,"restart",-1),ue(" to take effect. ",-1)])]))],2)):T("",!0),t("div",ZE,[t("button",eT,b(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(i(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:E.value||!q.value,onClick:$e},[E.value?(i(),r("span",sT)):T("",!0),ue(" "+b(M.value),1)],8,tT)):T("",!0)])])])],512),be(wE,{ref_key:"permissionPreviewModal",ref:f,"working-directory":L.value,"setting-sources":l.setting_sources,"session-allowed-tools":j.value,"session-disallowed-tools":R.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},oT=se(nT,[["__scopeId","data-v-da2afdcd"]]),aT={class:"modal-dialog modal-dialog-centered"},iT={class:"modal-content"},lT={class:"modal-header"},rT={class:"modal-title",id:"manageSessionModalLabel"},cT={class:"modal-body"},uT={key:0,class:"text-center py-4"},dT={class:"text-muted"},fT={key:1},mT={key:2},pT={class:"text-muted"},vT={key:0,class:"text-center py-2"},hT={key:1,class:"alert alert-warning mt-3"},_T={class:"mb-0 mt-2"},gT={key:0,class:"text-muted"},bT={key:3},yT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},wT={class:"d-grid gap-2"},kT=["disabled"],$T=["disabled"],ST=["disabled"],xT=["disabled"],CT={class:"modal-footer"},ET={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},TT={__name:"SessionManageModal",setup(n){const e=Zt(),s=pe(),o=xe(),a=rt();Pe();const c=N(null),u=N(!1),f=N(""),m=N(""),p=N(null),d=N(null);let w=null;const h=N([]),$=N(!1),S=_(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function y(){p.value="reset"}async function g(){if(p.value="delete",h.value=[],!!c.value){$.value=!0;try{const C=await ke.get(`/api/sessions/${c.value.session_id}/descendants`);h.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),h.value=[]}finally{$.value=!1}}}function v(){p.value=null}async function l(){p.value==="reset"?await E():p.value==="delete"&&await O()}async function k(){if(c.value){u.value=!0,f.value="Restarting session...";try{const C=c.value.session_id,M=s.currentSessionId===C,q=await ke.post(`/api/sessions/${C}/restart`);if(q.success)console.log("Session restarted successfully"),M&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),w&&w.hide();else{const B=q.error||q.detail||"Failed to restart session";console.error("Failed to restart session:",B),m.value=`Failed to restart session: ${B}`}}catch(C){console.error("Error restarting session:",C);const M=C.data?.detail||C.message||"Unknown error";m.value=`Error restarting session: ${M}`}finally{u.value=!1}}}async function x(){if(c.value)try{w&&w.hide(),console.log("Ending session",c.value.session_id);const C=c.value.session_id;await ke.post(`/api/sessions/${C}/terminate`),s.currentSessionId===C&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),s.currentSessionId===c.value?.session_id&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function E(){if(c.value){u.value=!0,f.value="Resetting session...";try{const C=c.value.session_id,M=s.currentSessionId===C,q=await ke.post(`/api/sessions/${C}/reset`);if(q.success)console.log("Session reset successfully"),M&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),w&&w.hide();else{const B=q.error||q.detail||"Failed to reset session";console.error("Failed to reset session:",B),m.value=`Failed to reset session: ${B}`,p.value=null}}catch(C){console.error("Error resetting session:",C);const M=C.data?.detail||C.message||"Unknown error";m.value=`Error resetting session: ${M}`,p.value=null}finally{u.value=!1}}}async function O(){if(c.value){u.value=!0,f.value="Deleting session...";try{const C=c.value.session_id;await s.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),w&&w.hide()}catch(C){console.error("Error deleting session:",C);const M=C.data?.detail||C.message||"Unknown error";m.value=`Error deleting session: ${M}`,p.value=null}finally{u.value=!1}}}function A(){p.value=null,u.value=!1,f.value="",m.value="",h.value=[],$.value=!1}function D(){A(),c.value=null,o.hideModal()}return me(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&w){const M=C.data||{};c.value=M.session,A(),w.show()}}),Me(()=>{d.value&&je(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(M=>M.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{w=new C(d.value),d.value.addEventListener("hidden.bs.modal",D)})}),De(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",D),w&&w.dispose()}),(C,M)=>(i(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",aT,[t("div",iT,[t("div",lT,[t("h5",rT,b(p.value?S.value:"Manage Session"),1),M[1]||(M[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",cT,[u.value?(i(),r("div",uT,[M[2]||(M[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",dT,b(f.value),1)])):p.value==="reset"?(i(),r("div",fT,[...M[3]||(M[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(i(),r("div",mT,[M[9]||(M[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",pT,[M[4]||(M[4]=ue("This will permanently delete session ",-1)),t("strong",null,b(c.value?.name),1),M[5]||(M[5]=ue(".",-1))]),M[10]||(M[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),$.value?(i(),r("div",vT,[...M[6]||(M[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):h.value.length>0?(i(),r("div",hT,[M[7]||(M[7]=t("strong",null,"Cascading Deletion:",-1)),M[8]||(M[8]=ue(" This session has ",-1)),t("strong",null,b(h.value.length),1),ue(" child session"+b(h.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",_T,[(i(!0),r(ne,null,ce(h.value,q=>(i(),r("li",{key:q.session_id,class:"small"},[t("strong",null,b(q.name||q.session_id),1),q.role?(i(),r("span",gT," ("+b(q.role)+")",1)):T("",!0)]))),128))])])):T("",!0)])):(i(),r("div",bT,[m.value?(i(),r("div",yT,[M[11]||(M[11]=t("strong",null,"Error:",-1)),ue(" "+b(m.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:M[0]||(M[0]=q=>m.value="")})])):T("",!0),M[18]||(M[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",wT,[t("button",{class:"btn btn-outline-primary text-start",onClick:k,disabled:u.value},[...M[12]||(M[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,kT),t("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:u.value},[...M[13]||(M[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,$T),M[16]||(M[16]=t("hr",{class:"my-2"},null,-1)),M[17]||(M[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:y,disabled:u.value},[...M[14]||(M[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,ST),t("button",{class:"btn btn-outline-danger text-start",onClick:g,disabled:u.value},[...M[15]||(M[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,xT)]),M[19]||(M[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ue(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",CT,[p.value&&!u.value?(i(),r(ne,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:v},"Cancel"),t("button",{type:"button",class:z(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:l},b(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):u.value?T("",!0):(i(),r("button",ET,"Cancel"))])])])],512))}},AT=se(TT,[["__scopeId","data-v-6b832853"]]),DT={class:"modal-dialog modal-dialog-centered modal-lg"},MT={class:"modal-content"},OT={class:"modal-body"},NT={key:0,class:"text-center text-muted py-4"},LT={key:1},IT={class:"mb-3"},jT={class:"font-monospace small"},PT={class:"mb-3"},RT=["value"],FT={class:"mb-3"},BT={class:"mb-3"},VT={class:"mb-3"},WT={key:0},UT={class:"d-flex flex-wrap gap-1"},HT={key:1,class:"text-muted small"},qT={key:0,class:"mb-3"},zT={class:"d-flex flex-wrap gap-1"},KT={key:1,class:"mb-3"},GT={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},YT={class:"mb-3"},JT={class:"text-muted"},QT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},XT={__name:"SessionInfoModal",setup(n){const e=pe(),s=Pe(),o=xe(),a=N(null),c=N(!1),u=N(null);let f=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},p=_(()=>{if(!a.value)return null;const y=e.initData.get(a.value);return y||(s.messagesBySession.get(a.value)||[]).find(l=>l.type==="system"&&(l.subtype==="init"||l.metadata?.subtype==="init")&&l.metadata?.init_data)?.metadata?.init_data||null});function d(y){return y?m[y]||y:"Default (Sonnet 4.5)"}function w(y){return typeof y=="string"?y:typeof y=="object"&&y.type==="preset"?`Preset: ${y.preset}`:JSON.stringify(y,null,2)}function h(y){y.target.select()}function $(){a.value=null,c.value=!1}function S(){$(),o.hideModal()}return me(()=>o.currentModal,y=>{if(y?.name==="session-info"&&f){const g=y.data||{};a.value=g.sessionId,c.value=!1,f.show()}}),Me(()=>{u.value&&je(async()=>{const{default:y}=await import("./modal-D6mKceGM.js").then(g=>g.m);return{default:y}},__vite__mapDeps([0,1])).then(({default:y})=>{f=new y(u.value),u.value.addEventListener("hidden.bs.modal",S)})}),De(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",S),f&&f.dispose()}),(y,g)=>(i(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",DT,[t("div",MT,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",OT,[p.value?(i(),r("div",LT,[t("div",IT,[g[1]||(g[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",jT,b(a.value),1)]),t("div",PT,[g[2]||(g[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:h},null,8,RT)]),t("div",FT,[g[3]||(g[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,b(d(p.value.model)),1)]),t("div",BT,[g[4]||(g[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,b(p.value.permissionMode||"default"),1)]),t("div",VT,[g[5]||(g[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(i(),r("div",WT,[t("div",UT,[(i(!0),r(ne,null,ce(p.value.allowed_tools||p.value.tools,v=>(i(),r("span",{key:v,class:"badge bg-secondary"},b(v),1))),128))])])):(i(),r("div",HT,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(i(),r("div",qT,[g[6]||(g[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",zT,[(i(!0),r(ne,null,ce(p.value.commands,v=>(i(),r("span",{key:v,class:"badge bg-info"},b(v),1))),128))])])):T("",!0),p.value.systemPrompt?(i(),r("div",KT,[g[7]||(g[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",GT,b(w(p.value.systemPrompt)),1)])):T("",!0),t("div",YT,[t("h6",JT,[g[8]||(g[8]=ue(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:g[0]||(g[0]=v=>c.value=!c.value)},b(c.value?"Hide":"Show"),1)]),c.value?(i(),r("pre",QT,b(JSON.stringify(p.value,null,2)),1)):T("",!0)])])):(i(),r("div",NT," No session configuration data available "))]),g[10]||(g[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},ZT=se(XT,[["__scopeId","data-v-b28b39b3"]]),e2={class:"modal-dialog modal-dialog-centered modal-lg"},t2={class:"modal-content"},s2={class:"modal-body"},n2={key:0,class:"text-center text-muted py-4"},o2={key:1},a2={class:"mb-3"},i2={class:"mb-3"},l2={class:"font-monospace small"},r2={class:"mb-3"},c2={class:"mb-3"},u2={class:"mb-3"},d2={key:0},f2={class:"d-flex flex-wrap gap-1"},m2={key:1,class:"text-muted small"},p2={class:"mb-3"},v2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},h2={key:1,class:"text-muted small"},_2={class:"mb-3"},g2={key:0,class:"badge bg-info"},b2={key:1,class:"badge bg-secondary"},y2={class:"mb-3"},w2={key:0,class:"font-monospace small"},k2={key:1,class:"text-muted small"},$2={key:0,class:"mb-3"},S2={key:0},x2={class:"list-unstyled mb-0"},C2={key:1,class:"text-muted small"},E2={class:"mb-3"},T2={class:"small"},A2={class:"mb-3"},D2={class:"small"},M2={__name:"MinionViewModal",setup(n){const e=xe(),s=N(null),o=N(null);let a=null;function c(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function u(p){if(!p)return"N/A";try{const d=new Date(p);return isNaN(d.getTime())?"Invalid date":d.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(d){return console.error("Error formatting timestamp:",d),"Invalid date"}}function f(){s.value=null}function m(){f(),e.hideModal()}return me(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&a){const d=p.data||{};s.value=d.session,a.show()}}),Me(()=>{o.value&&je(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{a=new p(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),De(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),a&&a.dispose()}),(p,d)=>(i(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",e2,[t("div",t2,[d[11]||(d[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",s2,[s.value?(i(),r("div",o2,[t("div",a2,[d[0]||(d[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,b(s.value.name||"Unnamed Minion"),1)]),t("div",i2,[d[1]||(d[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",l2,b(s.value.session_id),1)]),t("div",r2,[d[2]||(d[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,b(s.value.role||"Not specified"),1)]),t("div",c2,[d[3]||(d[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:z(["badge",c(s.value.state)])},b(s.value.state),3)])]),t("div",u2,[d[4]||(d[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),r("div",d2,[t("div",f2,[(i(!0),r(ne,null,ce(s.value.capabilities,w=>(i(),r("span",{key:w,class:"badge bg-secondary"},b(w),1))),128))])])):(i(),r("div",m2,"None"))]),t("div",p2,[d[5]||(d[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),r("div",v2,b(s.value.initialization_context),1)):(i(),r("div",h2,"Not specified"))]),t("div",_2,[d[6]||(d[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),r("span",g2,"Yes")):(i(),r("span",b2,"No"))])]),t("div",y2,[d[7]||(d[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),r("div",w2,b(s.value.parent_overseer_id),1)):(i(),r("div",k2," Root overseer (user-created) "))]),s.value.is_overseer?(i(),r("div",$2,[d[8]||(d[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),r("div",S2,[t("ul",x2,[(i(!0),r(ne,null,ce(s.value.child_minion_ids,w=>(i(),r("li",{key:w,class:"font-monospace small"},b(w),1))),128))])])):(i(),r("div",C2,"No children"))])):T("",!0),t("div",E2,[d[9]||(d[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",T2,b(u(s.value.created_at)),1)]),t("div",A2,[d[10]||(d[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",D2,b(u(s.value.updated_at)),1)])])):(i(),r("div",n2," No minion data available "))]),d[12]||(d[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},O2=se(M2,[["__scopeId","data-v-d996dc6f"]]),N2={class:"modal-dialog modal-dialog-centered"},L2={class:"modal-content"},I2={class:"modal-header"},j2={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},P2={class:"modal-body"},R2={key:0},F2={key:0,class:"text-center py-3"},B2={key:1,class:"card bg-light mb-3"},V2={class:"card-body py-2 px-3"},W2={class:"small"},U2={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},H2={key:0,class:"text-warning mt-1"},q2={key:2,class:"alert alert-warning py-2 small"},z2={key:1,class:"text-center py-3"},K2={key:0,class:"mb-3"},G2={key:1,class:"mb-3"},Y2={key:2,class:"mb-3"},J2={class:"text-muted small mt-1"},Q2={key:3,class:"mb-3"},X2={class:"mt-2 text-danger"},Z2={class:"modal-footer"},eA=["disabled"],tA={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},sA={__name:"RestartModal",setup(n){const e=xe(),s=N(null);let o=null;const a=N("confirm"),c=N(!1),u=N(null),f=N(null),m=N(""),p=N(60);let d=null,w=null;async function h(){c.value=!0,f.value=null;try{u.value=await Ya()}catch(l){f.value=l.message||"Unknown error"}finally{c.value=!1}}async function $(){a.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Ja(),e.restartStatus="restarting",S()}catch(l){e.restartStatus="error",m.value=l.message||"Restart failed",e.restartInProgress=!1}}function S(){e.restartStatus="reconnecting",p.value=60;const l=Date.now();w=setInterval(()=>{const k=Math.floor((Date.now()-l)/1e3);p.value=Math.max(0,60-k)},1e3),setTimeout(()=>{d=setInterval(async()=>{try{(await fetch("/health")).ok&&(y(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-l>6e4&&(y(),e.restartStatus="error",m.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function y(){d&&(clearInterval(d),d=null),w&&(clearInterval(w),w=null)}function g(){a.value="confirm",u.value=null,f.value=null,m.value="",p.value=60,y()}function v(){e.restartInProgress||(g(),e.restartStatus="idle"),e.hideModal()}return me(()=>e.currentModal,l=>{l?.name==="restart-server"&&o&&(g(),o.show(),h())}),Me(()=>{s.value&&je(async()=>{const{default:l}=await import("./modal-D6mKceGM.js").then(k=>k.m);return{default:l}},__vite__mapDeps([0,1])).then(({default:l})=>{o=new l(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",v)})}),De(()=>{y(),s.value&&s.value.removeEventListener("hidden.bs.modal",v),o&&o.dispose()}),(l,k)=>(i(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",N2,[t("div",L2,[t("div",I2,[k[0]||(k[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),a.value==="confirm"?(i(),r("button",j2)):T("",!0)]),t("div",P2,[a.value==="confirm"?(i(),r("div",R2,[k[5]||(k[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),c.value?(i(),r("div",F2,[...k[1]||(k[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):u.value?(i(),r("div",B2,[t("div",V2,[t("div",W2,[t("div",null,[k[2]||(k[2]=t("strong",null,"Branch:",-1)),ue(" "+b(u.value.branch),1)]),t("div",null,[k[3]||(k[3]=t("strong",null,"Last commit:",-1)),ue(" "+b(u.value.last_commit_message),1)]),t("div",U2,b(u.value.last_commit_hash?.substring(0,12)),1),u.value.has_uncommitted_changes?(i(),r("div",H2,[...k[4]||(k[4]=[t("strong",null,"Warning:",-1),ue(" Uncommitted changes detected. git pull may fail. ",-1)])])):T("",!0)])])])):f.value?(i(),r("div",q2," Could not fetch git status: "+b(f.value),1)):T("",!0)])):a.value==="progress"?(i(),r("div",z2,[le(e).restartStatus==="pulling"?(i(),r("div",K2,[...k[6]||(k[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):le(e).restartStatus==="restarting"?(i(),r("div",G2,[...k[7]||(k[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):le(e).restartStatus==="reconnecting"?(i(),r("div",Y2,[k[8]||(k[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),k[9]||(k[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",J2,b(p.value)+"s remaining",1)])):le(e).restartStatus==="error"?(i(),r("div",Q2,[k[10]||(k[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",X2,b(m.value),1)])):T("",!0)])):T("",!0)]),t("div",Z2,[a.value==="confirm"?(i(),r(ne,{key:0},[k[11]||(k[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:$,disabled:c.value}," Pull & Restart ",8,eA)],64)):le(e).restartStatus==="error"?(i(),r("button",tA,"Close")):T("",!0)])])])],512))}},nA={class:"app-shell"},oA={class:"main-layout"},aA={class:"center-panel"},iA={__name:"App",setup(n){const e=xe(),s=rt(),o=pe(),a=Ve(),c=Nt(),u=Xe(),f=Zt(),m=N(null);function p($){m.value=$}En("addAttachmentFromResource",p),En("pendingResourceAttachment",m);const d=_(()=>e.rightPanelVisible),w=_(()=>e.windowWidth<=1024);me(()=>c.currentHasTasks,($,S)=>{$&&!S&&e.setRightPanelVisible(!0)}),me(()=>u.currentHasResources,($,S)=>{$&&!S&&e.setRightPanelVisible(!0)}),Me(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const $=window.location.hash;if($.startsWith("#/session/")){const S=$.replace("#/session/","");o.sessions.has(S)&&await o.selectSession(S)}else if($.startsWith("#/timeline/")){const S=$.replace("#/timeline/","");f.push(`/timeline/${S}`)}window.addEventListener("popstate",h),window.addEventListener("resize",e.handleResize)}),De(()=>{window.removeEventListener("popstate",h),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function h(){const $=window.location.hash;if($.startsWith("#/session/")){const S=$.replace("#/session/","");o.sessions.has(S)&&o.selectSession(S)}}return($,S)=>{const y=rn("router-view");return i(),r("div",nA,[be(d_),be(w_),be(F_),t("div",{id:"right-panel-backdrop",class:z({show:d.value&&w.value}),onClick:S[0]||(S[0]=g=>le(e).setRightPanelVisible(!1))},null,2),t("div",oA,[t("main",aA,[be(y)]),Se(be(Wy,{class:z({"panel-overlay":w.value,"panel-visible":d.value})},null,8,["class"]),[[nt,d.value||w.value]])]),be(a1),be(w1),be(U1),be(oT),be(AT),be(ZT),be(O2),be(sA)])}}},xn=Ba(iA);xn.use(Va());xn.use(l_);xn.mount("#app");
