const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as t,o as u,d as bt,r as L,b as _,t as $,n as Re,e as z,f as q,u as Jt,w as re,g as vn,h as P,F as se,i as ie,j as we,k as oo,l as ee,v as ce,m as ne,p as ue,q as Os,s as Xt,x as _e,y as he,z as Me,A as Vs,B as io,C as pi,D as fi,E as Ye,T as ao,G as At,H as vi,I as hi}from"./vue-vendor-CZmLX7q9.js";import{m as Mt,p as Hs}from"./markdown-vendor-CQ3OZdP9.js";import{c as _i}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();const gi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},bi={__name:"NoSessionSelected",setup(n){return(e,s)=>(u(),m("div",gi,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},yi="modulepreload",$i=function(n){return"/"+n},hn={},ge=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let c=function(p){return Promise.all(p.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),l=r?.nonce||r?.getAttribute("nonce");i=c(s.map(p=>{if(p=$i(p),p in hn)return;hn[p]=!0;const d=p.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${h}`))return;const b=document.createElement("link");if(b.rel=d?"stylesheet":yi,d||(b.as="script"),b.crossOrigin="",b.href=p,l&&b.setAttribute("nonce",l),document.head.appendChild(b),d)return new Promise((v,w)=>{b.addEventListener("load",v),b.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return i.then(r=>{for(const l of r||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};class ms extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Ot(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new ms(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof ms?s:(console.error("API request failed:",s),new ms(`Network error: ${s.message}`,0,null))}}async function wi(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[l,c]of Object.entries(e.params))c!=null&&o.append(l,c);const i=o.toString();i&&(s=`${n}?${i}`);const{params:a,...r}=e;return Ot(s,{...r,method:"GET"})}return Ot(s,{...e,method:"GET"})}async function Ei(n,e,s={}){return Ot(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ci(n,e,s={}){return Ot(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Si(n,e={}){return Ot(n,{...e,method:"DELETE"})}const Z={get:wi,post:Ei,put:Ci,delete:Si},te=bt("session",()=>{const n=L(new Map),e=L(null),s=L(new Map),o=L(new Map),i=L(new Set),a=L(!1);let r=null;const l=_(()=>n.value.get(e.value)),c=_(()=>Array.from(n.value.values()).sort((E,k)=>E.order-k.order)),p=E=>_(()=>c.value.filter(k=>k.project_id===E)),d=_({get:()=>s.value.get(e.value)||"",set:E=>{e.value&&s.value.set(e.value,E)}});async function h(){try{const E=await Z.get("/api/sessions");return n.value.clear(),E.sessions.forEach(k=>{n.value.set(k.session_id,k)}),console.log(`Loaded ${n.value.size} sessions`),E.sessions}catch(E){throw console.error("Failed to fetch sessions:",E),E}}async function b(E,k){try{const N=(await Z.post("/api/sessions",{project_id:E,...k})).session_id,S=(await Z.get(`/api/sessions/${N}`)).session;return n.value.set(N,S),n.value=new Map(n.value),console.log(`Created session ${N}`),S}catch(R){throw console.error("Failed to create session:",R),R}}async function v(E){if(e.value===E&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${E}`),r.abort(),r=null);const k=new AbortController;r=k,a.value=!0;try{if(e.value=E,k.signal.aborted){console.log(`Selection of ${E} aborted early`);return}let R=n.value.get(E);if(!R)try{const S=await Z.get(`/api/sessions/${E}`);if(k.signal.aborted){console.log(`Selection of ${E} aborted after fetch`);return}R=S.session,n.value.set(E,R),n.value=new Map(n.value),console.log(`Fetched session ${E} for deeplink`)}catch(S){console.error(`Failed to fetch session ${E}:`,S);return}if(R&&(R.state==="created"||R.state==="terminated"))try{if(await M(E),k.signal.aborted){console.log(`Selection of ${E} aborted after start`);return}console.log(`Auto-started session ${E} (was in ${R.state} state)`);const S=6e4,O=200,x=5e3;let j=0,F=0;for(;j<S;){if(k.signal.aborted){console.log(`Selection of ${E} aborted during state wait`);return}const oe=n.value.get(E);if(oe&&oe.state==="active"){console.log(`Session ${E} is now active after ${j}ms`);break}if(j-F>=x){const le=n.value.get(E)?.state||"unknown";console.log(`Waiting for session ${E} to become active (current: ${le}, ${j/1e3}s elapsed)`),F=j}await new Promise(le=>setTimeout(le,O)),j+=O}const U=n.value.get(E);U&&U.state!=="active"&&console.warn(`Session ${E} did not become active within ${S/1e3}s (state: ${U.state}), continuing anyway`)}catch(S){console.error(`Failed to auto-start session ${E}:`,S)}if(k.signal.aborted){console.log(`Selection of ${E} aborted before message load`);return}if(await(await ge(()=>Promise.resolve().then(()=>qi),void 0)).useMessageStore().loadMessages(E),k.signal.aborted){console.log(`Selection of ${E} aborted after message load`);return}await(await ge(()=>Promise.resolve().then(()=>ua),void 0)).useWebSocketStore().connectSession(E),k.signal.aborted||console.log(`Selected session ${E}`)}finally{r===k&&(r=null),a.value=!1}}function w(E,k){const R=n.value.get(E);R?Object.assign(R,k):(n.value.set(E,k),console.log(`Added new session ${E} via WebSocket update`)),n.value=new Map(n.value)}async function y(E){i.value.add(E);try{await Z.delete(`/api/sessions/${E}`),n.value.delete(E),s.value.delete(E),o.value.delete(E),n.value=new Map(n.value),e.value===E&&(e.value=null),console.log(`Deleted session ${E}`)}catch(k){throw console.error("Failed to delete session:",k),k}finally{i.value.delete(E)}}async function g(E,k){try{await Z.put(`/api/sessions/${E}/name`,{name:k}),w(E,{name:k}),console.log(`Updated session ${E} name to "${k}"`)}catch(R){throw console.error("Failed to update session name:",R),R}}async function f(E,k){try{await Z.post(`/api/sessions/${E}/permission-mode`,{mode:k}),w(E,{current_permission_mode:k});const R=o.value.get(E);R&&(R.permissionMode=k,o.value.set(E,R)),console.log(`Set permission mode for session ${E} to ${k}`)}catch(R){throw console.error("Failed to set permission mode:",R),R}}async function M(E){try{await Z.post(`/api/sessions/${E}/start`),console.log(`Started session ${E}`)}catch(k){throw console.error("Failed to start session:",k),k}}async function C(E){try{await Z.post(`/api/sessions/${E}/pause`),console.log(`Paused session ${E}`)}catch(k){throw console.error("Failed to pause session:",k),k}}async function T(E){try{await Z.post(`/api/sessions/${E}/terminate`),console.log(`Terminated session ${E}`)}catch(k){throw console.error("Failed to terminate session:",k),k}}function D(E){return n.value.get(E)}function I(E,k){o.value.set(E,k),k.permissionMode&&w(E,{current_permission_mode:k.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:l,orderedSessions:c,sessionsInProject:p,currentInput:d,fetchSessions:h,createSession:b,selectSession:v,updateSession:w,deleteSession:y,updateSessionName:g,setPermissionMode:f,startSession:M,pauseSession:C,terminateSession:T,getSession:D,storeInitData:I}}),_n=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:te},Symbol.toStringTag,{value:"Module"})),de=bt("ui",()=>{const n=L(window.innerWidth<768),e=L(300),s=L(window.innerWidth),o=_(()=>s.value<768),i=L(!0),a=L(null),r=L(null),l=_(()=>a.value?{name:a.value,data:r.value}:null),c=L(!1),p=L("Loading...");function d(){n.value=!n.value}function h(C){n.value=C}function b(C){e.value=Math.max(200,Math.min(C,window.innerWidth*.3))}function v(C){i.value=C}function w(C,T=null){a.value=null,r.value=null,setTimeout(()=>{a.value=C,r.value=T},0)}function y(){a.value=null,r.value=null}function g(C="Loading..."){c.value=!0,p.value=C}function f(){c.value=!1}function M(){const C=s.value;s.value=window.innerWidth,s.value<768&&C>=768?n.value=!0:s.value>=768&&C<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:l,isLoading:c,loadingMessage:p,toggleSidebar:d,setSidebarCollapsed:h,setSidebarWidth:b,setAutoScroll:v,showModal:w,hideModal:y,showLoading:g,hideLoading:f,handleResize:M}}),fe=bt("project",()=>{const n=L(new Map),e=L(null),s=_(()=>n.value.get(e.value)),o=_(()=>Array.from(n.value.values()).sort((y,g)=>y.order-g.order)),i=y=>n.value.get(y)?.is_multi_agent||!1;async function a(){try{const y=await Z.get("/api/projects");return n.value.clear(),y.projects.forEach(g=>{n.value.set(g.project_id,g)}),console.log(`Loaded ${n.value.size} projects`),y.projects}catch(y){throw console.error("Failed to fetch projects:",y),y}}async function r(y,g,f=!1){try{const C=(await Z.post("/api/projects",{name:y,working_directory:g,is_multi_agent:f})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(M){throw console.error("Failed to create project:",M),M}}async function l(y,g){try{await Z.put(`/api/projects/${y}`,g),c(y,g),console.log(`Updated project ${y}`,g)}catch(f){throw console.error("Failed to update project:",f),f}}function c(y,g){const f=n.value.get(y);f&&(Object.assign(f,g),n.value=new Map(n.value))}async function p(y){try{await Z.delete(`/api/projects/${y}`),n.value.delete(y),n.value=new Map(n.value),e.value===y&&(e.value=null),console.log(`Deleted project ${y}`)}catch(g){throw console.error("Failed to delete project:",g),g}}async function d(y){try{const g=await Z.put(`/api/projects/${y}/toggle-expansion`),f=n.value.get(y);return f&&(f.is_expanded=g.is_expanded,n.value=new Map(n.value)),g.is_expanded}catch(g){throw console.error("Failed to toggle expansion:",g),g}}async function h(y){try{await Z.put("/api/projects/reorder",{project_ids:y}),y.forEach((g,f)=>{const M=n.value.get(g);M&&(M.order=f)}),n.value=new Map(n.value),console.log("Reordered projects",y)}catch(g){throw console.error("Failed to reorder projects:",g),g}}async function b(y,g){try{await Z.put(`/api/projects/${y}/sessions/reorder`,{session_ids:g});const f=n.value.get(y);f&&(f.session_ids=g,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${y}`,g)}catch(f){throw console.error("Failed to reorder sessions:",f),f}}function v(y){return n.value.get(y)}function w(y){if(!y)return"";const g=y.split(/[/\\]/).filter(f=>f);return g.length===0?"/":g.length===1?`/${g[0]}`:g.length===2?`/${g.join("/")}`:`.../${g.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:r,updateProject:l,updateProjectLocal:c,deleteProject:p,toggleExpansion:d,reorderProjects:h,reorderSessionsInProject:b,getProject:v,formatPath:w}}),K=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},ki={class:"session-header border-bottom p-3"},Ti={class:"project-name"},xi=["title"],Ai={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=te(),o=fe(),i=_(()=>s.sessions.get(e.sessionId)),a=_(()=>i.value?.name||e.sessionId),r=_(()=>{for(const c of o.projects.values())if(c.session_ids?.includes(e.sessionId))return c;return null}),l=_(()=>r.value?.name||"Unknown Project");return(c,p)=>(u(),m("div",ki,[t("div",null,[t("div",Ti,$(l.value),1),t("div",{class:"session-name",title:n.sessionId},$(a.value),9,xi)])]))}},Mi=K(Ai,[["__scopeId","data-v-89e9c269"]]),Oi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ni=["title"],Li={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Di={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=te(),o=_(()=>s.sessions.get(e.sessionId)),i=_(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=_(()=>{const c=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[c]||"#d3d3d3"}),r=_(()=>{const c=i.value;return c==="starting"||c==="processing"||c==="pending-prompt"}),l=_(()=>{if(!o.value)return"No session selected";const c=i.value,p=c.charAt(0).toUpperCase()+c.slice(1).replace("-"," "),d=o.value.name||"Unnamed Session",h=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${d}${h}: ${p}`});return(c,p)=>(u(),m("div",Oi,[o.value?(u(),m("div",{key:0,class:z(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:Re({width:"100%",backgroundColor:a.value}),title:l.value},null,14,Ni)):(u(),m("div",Li))]))}},Ii=K(Di,[["__scopeId","data-v-e8795bb7"]]),Pi={class:"session-status-bar border-top p-2 bg-light"},ji={class:"d-flex justify-content-between align-items-center gap-2"},Ri={class:"d-flex gap-2"},Vi=["disabled"],Hi={class:"mode-label"},Wi=["disabled"],Fi=["disabled"],Ui={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=te(),o=de(),i=_(()=>s.sessions.get(e.sessionId)),a=_(()=>i.value?.current_permission_mode||"default"),r={default:"🔒",acceptEdits:"✏️",plan:"📋",bypassPermissions:"☢️"},l=_(()=>r[a.value]||"🔒"),c=_(()=>a.value),p=["default","acceptEdits","plan"],d=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(f){console.error("Failed to cycle permission mode:",f)}return}const y=(p.indexOf(a.value)+1)%p.length,g=p[y];try{await s.setPermissionMode(e.sessionId,g)}catch(f){console.error("Failed to cycle permission mode:",f)}},h=()=>{o.showModal("session-info",{sessionId:e.sessionId})},b=()=>{o.showModal("manage-session",{session:i.value})},v=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(w,y)=>(u(),m("div",Pi,[t("div",ji,[t("div",Ri,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!i.value},[q($(l.value)+" ",1),t("span",Hi,$(c.value),1)],8,Vi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[...y[0]||(y[0]=[q(" ℹ️ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,Wi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:b,disabled:!i.value},[...y[1]||(y[1]=[q(" ⚙️ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,Fi)]),t("div",null,[t("button",{class:z(["btn btn-sm",Jt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:v}," ⬇️ "+$(Jt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Bi=K(Ui,[["__scopeId","data-v-fdcd3535"]]),De=bt("message",()=>{const n=L(new Map),e=L(new Map),s=L(new Map),o=L(new Map),i=L(new Map),a=L(new Map),r=L(new Map),l=_(()=>{const S=te();return n.value.get(S.currentSessionId)||[]}),c=_(()=>{const S=te();return e.value.get(S.currentSessionId)||[]});async function p(S,O=null,x=0){try{const j=O||1e4,F=await Z.get(`/api/sessions/${S}/messages?limit=${j}&offset=${x}`),U=F.messages||[],oe=F.total_count||U.length,le=F.has_more||!1;if(console.log(`Loaded ${U.length} of ${oe} messages for session ${S}`),n.value.set(S,U),U.length>0){const Q=U[U.length-1];Q.timestamp&&(r.value.set(S,Q.timestamp),console.log(`Tracked last received timestamp for session ${S}: ${Q.timestamp}`))}const me=new Set;U.forEach(Q=>{Q.type==="assistant"&&Q.metadata?.tool_uses&&Q.metadata.tool_uses.forEach(B=>{me.add(B.id)}),Q.type==="user"&&Q.metadata?.tool_results&&Q.metadata.tool_results.forEach(B=>{me.delete(B.tool_use_id);const ae=a.value.get(S);ae&&ae.delete(B.tool_use_id)}),Q.type==="system"&&Q.metadata?.subtype==="client_launched"&&(me.forEach(B=>{T(S,B,"Session was restarted")}),me.clear()),Q.type==="system"&&Q.metadata?.subtype==="interrupt"&&(me.forEach(B=>{T(S,B,"Session was interrupted")}),me.clear()),Q.metadata?.has_tool_uses&&Q.metadata.tool_uses&&Q.metadata.tool_uses.forEach(B=>{w(S,B)}),Q.metadata?.has_tool_results&&Q.metadata.tool_results&&Q.metadata.tool_results.forEach(B=>{f(S,B)}),(Q.type==="permission_request"||Q.metadata?.has_permission_requests)&&y(S,Q),Q.type==="system"&&(Q.subtype==="init"||Q.metadata?.subtype==="init")&&Q.metadata?.init_data&&te().storeInitData(S,Q.metadata.init_data)});const ve=te().sessions.get(S);return ve&&!["active","paused","starting"].includes(ve.state)&&(me.forEach(Q=>{T(S,Q,"Session was terminated")}),me.clear()),i.value.set(S,me),n.value=new Map(n.value),le&&console.warn(`Warning: Only loaded ${U.length} of ${oe} messages. Some messages may be missing.`),{messages:U,totalCount:oe,hasMore:le}}catch(j){throw console.error("Failed to load messages:",j),j}}function d(S,O){const x=i.value.get(S)||new Set;O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(j=>{x.add(j.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(j=>{x.delete(j.tool_use_id);const F=a.value.get(S);F&&F.delete(j.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(x.forEach(j=>{T(S,j,"Session was restarted")}),x.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(x.forEach(j=>{T(S,j,"Session was interrupted")}),x.clear()),i.value.set(S,x)}function h(S,O){n.value.has(S)||n.value.set(S,[]);const x=n.value.get(S);if(O.id){const j=x.findIndex(F=>F.id===O.id);if(j!==-1){console.log(`Skipping duplicate message ${O.id} (already exists at index ${j})`);return}}x.push(O),O.timestamp&&r.value.set(S,O.timestamp),d(S,O),n.value=new Map(n.value)}function b(S,O){e.value.has(S)||e.value.set(S,[]),e.value.get(S).push(O),e.value=new Map(e.value)}function v(S,O,x){const j=e.value.get(S);if(j){const F=j.find(U=>U.id===O);F&&(Object.assign(F,x),e.value=new Map(e.value))}}function w(S,O){const x=C(O.name,O.input);s.value.set(x,O.id);const j={id:O.id,name:O.name,input:O.input,signature:x,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return b(S,j),console.log(`Created tool call ${j.id} for ${j.name}`),j}function y(S,O){console.log("handlePermissionRequest received:",O);const x=O.metadata?.tool_name||O.tool_name,j=O.metadata?.input_params||O.input_params,F=O.metadata?.request_id||O.request_id,U=O.metadata?.suggestions||O.suggestions||[];console.log("Extracted data:",{toolName:x,inputParams:j,requestId:F,suggestions:U});const oe=C(x,j),le=s.value.get(oe);le?(o.value.set(F,le),v(S,le,{status:"permission_required",permissionRequestId:F,suggestions:U}),console.log(`Permission required for tool ${le}`,{suggestions:U})):console.warn("No tool use ID found for permission request signature:",oe,{toolName:x,inputParams:j,availableSignatures:Array.from(s.value.keys())})}function g(S,O){const x=o.value.get(O.request_id);if(x){const j={permissionDecision:O.decision,appliedUpdates:O.applied_updates||[]};O.decision==="allow"?j.status="executing":(j.status="completed",j.result={error:!0,message:O.reasoning||"Permission denied"},j.isExpanded=!1),v(S,x,j),console.log(`Permission ${O.decision} for tool ${x}`)}}function f(S,O){const x=O.tool_use_id;v(S,x,{status:O.is_error?"error":"completed",result:{error:O.is_error,content:O.content},isExpanded:!1}),console.log(`Tool ${x} ${O.is_error?"failed":"completed"}`)}function M(S,O){const x=e.value.get(S);if(x){const j=x.find(F=>F.id===O);j&&(j.isExpanded=!j.isExpanded,e.value=new Map(e.value))}}function C(S,O){if(!S)return"unknown:{}";if(!O||typeof O!="object")return`${S}:{}`;const x=JSON.stringify(O,Object.keys(O).sort());return`${S}:${x}`}function T(S,O,x){const j=a.value.get(S)||new Map;j.set(O,{reason:"denied",message:x}),a.value.set(S,j);const F=e.value.get(S);if(F){const U=F.find(oe=>oe.id===O);U&&U.isExpanded&&(U.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${O} as orphaned: ${x}`)}function D(S,O){return a.value.get(S)?.has(O)||!1}function I(S,O){return a.value.get(S)?.get(O)}function E(S,O){const x=i.value.get(S);x&&x.size>0&&(x.forEach(j=>T(S,j,O)),x.clear())}function k(S){n.value.delete(S),e.value.delete(S),n.value=new Map(n.value),e.value=new Map(e.value)}function R(S){return r.value.get(S)}async function N(S){const O=r.value.get(S);if(!O)return console.log(`No sync needed for session ${S} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${S} since ${O}`);const x=await Z.get(`/api/sessions/${S}/messages?limit=1000&offset=0`),j=x.messages||[],F=x.has_more||!1,U=B=>B?typeof B=="number"?B*1e3:new Date(B).getTime():0,oe=U(O),le=j.filter(B=>B.timestamp?U(B.timestamp)>oe:!1);if(le.length===0)return console.log(`No missed messages for session ${S}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${le.length} missed messages for session ${S}`);const me=n.value.get(S)||[],Fe=new Set(me.map(B=>B.id).filter(Boolean)),ve=le.filter(B=>!B.id||!Fe.has(B.id));if(console.log(`After deduplication: ${ve.length} unique new messages`),ve.length>0){const B=ve.sort((X,J)=>{const pe=U(X.timestamp),Ct=U(J.timestamp);return pe-Ct}),ae=n.value.get(S)||[],H=ae.length>0?U(ae[ae.length-1].timestamp):0,W=U(B[0].timestamp),Y=U(B[B.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ae.length,lastExisting:H,lastExistingDate:ae.length>0?ae[ae.length-1].timestamp:"none",firstNew:W,firstNewDate:B[0].timestamp,lastNew:Y,lastNewDate:B[B.length-1].timestamp,shouldAppend:W>H}),W>H){const X=[...ae,...B];n.value.set(S,X),console.log(`✅ Appended ${B.length} new messages (no full sort needed)`)}else{const X=[...ae,...B].sort((J,pe)=>{const Ct=U(J.timestamp),Rt=U(pe.timestamp);return Ct-Rt});n.value.set(S,X),console.log(`⚠️ Merged and sorted ${B.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${me.length} messages unchanged`);ve.forEach(B=>{d(S,B),B.metadata?.has_tool_uses&&B.metadata.tool_uses&&B.metadata.tool_uses.forEach(ae=>{w(S,ae)}),B.metadata?.has_tool_results&&B.metadata.tool_results&&B.metadata.tool_results.forEach(ae=>{f(S,ae)}),(B.type==="permission_request"||B.metadata?.has_permission_requests)&&y(S,B),B.type==="system"&&(B.subtype==="init"||B.metadata?.subtype==="init")&&B.metadata?.init_data&&te().storeInitData(S,B.metadata.init_data)});const Q=n.value.get(S);if(Q&&Q.length>0){const B=Q[Q.length-1];B.timestamp&&r.value.set(S,B.timestamp)}return n.value=new Map(n.value),{syncedCount:ve.length,hasMore:F}}catch(x){return console.error(`Failed to sync messages for session ${S}:`,x),{syncedCount:0,hasMore:!1,error:x.message}}}const A=te();return re(()=>Array.from(A.sessions.values()).map(O=>({id:O.session_id,state:O.state})),(S,O)=>{O&&S.forEach((x,j)=>{const F=O[j];if(!F||F.id!==x.id)return;const U=["active","paused","starting"].includes(F.state),oe=!["active","paused","starting"].includes(x.state);U&&oe&&E(x.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:vn(i),orphanedToolUses:vn(a),currentMessages:l,currentToolCalls:c,loadMessages:p,addMessage:h,addToolCall:b,updateToolCall:v,handleToolUse:w,handlePermissionRequest:y,handlePermissionResponse:g,handleToolResult:f,toggleToolExpansion:M,clearMessages:k,markToolUseOrphaned:T,isToolUseOrphaned:D,getOrphanedInfo:I,clearOrphanedToolUses:E,getLastReceivedTimestamp:R,syncMessages:N}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:De},Symbol.toStringTag,{value:"Module"}));function zi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function ss(n){return zi(n).toLocaleTimeString()}const Ki={class:"message-row message-row-user"},Yi=["title"],Gi={class:"message-content-column"},Ji=["innerHTML"],Xi={key:0,class:"tool-results mt-2"},Qi={class:"tool-results-header text-muted small mb-2"},Zi={class:"d-flex align-items-start gap-2"},ea={class:"flex-grow-1"},ta={class:"text-muted"},sa={key:0,class:"text-danger small"},na={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Mt.setOptions({breaks:!0,gfm:!0});const s=_(()=>ss(e.message.timestamp)),o=_(()=>`user
${s.value}`),i=_(()=>{const c=e.message.content||"";let p=Mt.parse(c);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Hs.sanitize(p)}),a=_(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=_(()=>e.message.metadata?.tool_results||[]);function l(c,p){return c?c.length<=p?c:c.substring(0,p)+"...":""}return(c,p)=>(u(),m("div",Ki,[t("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,Yi),t("div",Gi,[t("div",{class:"message-text",innerHTML:i.value},null,8,Ji),a.value?(u(),m("div",Xi,[t("div",Qi,[p[1]||(p[1]=t("i",{class:"bi bi-tools"},null,-1)),q(" Tool Results ("+$(r.value.length)+") ",1)]),(u(!0),m(se,null,ie(r.value,(d,h)=>(u(),m("div",{key:h,class:z(["tool-result-summary p-2 mb-2 rounded",d.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",Zi,[t("span",null,$(d.is_error?"❌":"✅"),1),t("div",ea,[t("small",ta,"Tool: "+$(d.tool_use_id),1),d.is_error?(u(),m("div",sa,$(l(d.content,200)),1)):P("",!0)])])],2))),128))])):P("",!0)])]))}},oa=K(na,[["__scopeId","data-v-09875214"]]),ia={class:"thinking-block"},aa={class:"text-muted ms-auto"},ra={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},la=["innerHTML"],ca={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=L(!1),o=_(()=>e.thinking?.length||0),i=_(()=>{const r=e.thinking||"",l=Mt.parse(r);return Hs.sanitize(l)});function a(){s.value=!s.value}return(r,l)=>(u(),m("div",ia,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[t("i",{class:z(["bi",s.value?"bi-chevron-down":"bi-chevron-right"])},null,2),l[0]||(l[0]=t("span",{class:"thinking-label"},[t("i",{class:"bi bi-lightbulb"}),q(" Thinking ")],-1)),t("small",aa,$(o.value)+" characters",1)]),s.value?(u(),m("div",ra,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,la)])):P("",!0)]))}},da=K(ca,[["__scopeId","data-v-619a8344"]]),He=bt("websocket",()=>{const n=L(null),e=L(!1),s=L(0),o=10,i=L(null),a=L(!1),r=L(0),l=5,c=L(null);let p=null;const d=L(0),h=L(null),b=L(new Map),v=L(null),w=L(!1),y=L(0),g=5,f=L(null),M=5e3,C=1e3,T=L(Date.now()),D=L(Date.now()),I=L(Date.now());let E=null,k=null,R=null;const N=_(()=>e.value&&(a.value||!c.value)?"connected":e.value?"partial":"disconnected");function A(H){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${H}`}function S(H){const W={ui:{timer:()=>E,setTimer:Y=>{E=Y},lastPing:T,connected:e,name:"UI"},session:{timer:()=>k,setTimer:Y=>{k=Y},lastPing:D,connected:a,name:"Session"},legion:{timer:()=>R,setTimer:Y=>{R=Y},lastPing:I,connected:w,name:"Legion"}}[H];W.timer()&&clearInterval(W.timer()),W.setTimer(setInterval(()=>{if(!W.connected.value)return;const Y=Date.now()-W.lastPing.value;if(Y>M){console.warn(`⚠️ ${W.name} WebSocket heartbeat timeout (${Y}ms since last ping) - forcing close to trigger reconnection`),W.connected.value=!1;const J={ui:n,session:i,legion:v}[H];J.value&&J.value.readyState===WebSocket.OPEN&&J.value.close()}},C)),console.log(`✅ Started heartbeat monitor for ${W.name} WebSocket`)}function O(H){const W={ui:{get:()=>E,set:Y=>{E=Y}},session:{get:()=>k,set:Y=>{k=Y}},legion:{get:()=>R,set:Y=>{R=Y}}}[H];W.get()&&(clearInterval(W.get()),W.set(null),console.log(`🛑 Stopped heartbeat monitor for ${H} WebSocket`))}function x(){if(n.value)return;const H=A("/ws/ui");console.log(`Connecting to UI WebSocket: ${H}`),n.value=new WebSocket(H),n.value.onopen=()=>{e.value=!0,s.value=0,T.value=Date.now(),S("ui"),console.log("UI WebSocket connected")},n.value.onmessage=W=>{const Y=JSON.parse(W.data);Fe(Y)},n.value.onclose=()=>{if(O("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const W=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${W}ms (attempt ${s.value})`),setTimeout(x,W)}},n.value.onerror=W=>{console.error("UI WebSocket error:",W)}}function j(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function F(H){d.value++;const W=d.value;if(console.log(`[Gen ${W}] Starting connection to session ${H}`),p&&(clearTimeout(p),p=null),await U(),d.value!==W){console.log(`[Gen ${W}] Connection cancelled (current generation: ${d.value})`);return}c.value=H,h.value=W;const Y=A(`/ws/session/${H}`);console.log(`[Gen ${W}] Connecting to Session WebSocket: ${Y}`),i.value=new WebSocket(Y),i.value.onopen=async()=>{if(h.value!==W){console.log(`[Gen ${W}] Ignoring onopen (stale connection, current: ${h.value})`),i.value.close();return}a.value=!0,r.value=0,D.value=Date.now(),S("session"),console.log(`[Gen ${W}] Session WebSocket connected for ${H}`);const X=b.value.get(H);if(b.value.set(H,!0),X){console.log(`[Gen ${W}] Reconnection detected, syncing missed messages...`);try{const pe=await De().syncMessages(H);pe.syncedCount>0?console.log(`[Gen ${W}] ✅ Synced ${pe.syncedCount} missed messages`):pe.error?console.warn(`[Gen ${W}] ⚠️ Message sync failed: ${pe.error}`):console.log(`[Gen ${W}] No missed messages to sync`),pe.hasMore&&console.warn(`[Gen ${W}] ⚠️ More than 1000 missed messages, showing recent 1000 only`)}catch(J){console.error(`[Gen ${W}] Error during message sync:`,J)}}else console.log(`[Gen ${W}] Initial connection, no sync needed`)},i.value.onmessage=X=>{if(h.value!==W){console.log(`[Gen ${W}] Ignoring message (stale connection, current: ${h.value})`);return}const J=JSON.parse(X.data);ve(J,H)},i.value.onclose=()=>{O("session"),a.value=!1,i.value=null,console.log(`[Gen ${W}] Session WebSocket closed for ${H}`);const X=te();if(X.currentSessionId===H&&h.value===W&&r.value<l){r.value++;const J=Math.min(2e3*r.value,3e4);console.log(`[Gen ${W}] Reconnecting Session WebSocket in ${J}ms (attempt ${r.value})`),p=setTimeout(()=>{h.value===W&&X.currentSessionId===H?(p=null,F(H)):console.log(`[Gen ${W}] Skipping reconnect (generation or session changed)`)},J)}},i.value.onerror=X=>{console.error(`[Gen ${W}] Session WebSocket error:`,X)}}function U(){return new Promise(H=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),i.value){const W=c.value,Y=()=>{i.value=null,a.value=!1,c.value=null,h.value=null,r.value=0,W&&b.value.delete(W),H()};if(i.value.readyState===WebSocket.CLOSED)Y();else{const X=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),Y()},2e3);i.value.addEventListener("close",()=>{clearTimeout(X),Y()},{once:!0}),i.value.close()}}else c.value=null,h.value=null,H()})}function oe(H){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:H})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function le(H,W,Y=!1,X=null){if(i.value&&a.value){const J={type:"permission_response",request_id:H,decision:W,apply_suggestions:Y,timestamp:new Date().toISOString()};X&&(J.clarification_message=X),i.value.send(JSON.stringify(J)),console.log(`Sent permission ${W} for request ${H}`,{applySuggestions:Y,clarification:X})}}function me(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function Fe(H){const W=te(),Y=fe();switch(H.type){case"sessions_list":H.sessions&&Array.isArray(H.sessions)&&H.sessions.forEach(X=>{W.updateSession(X.session_id,X)});break;case"state_change":H.data&&H.data.session_id&&H.data.session&&W.updateSession(H.data.session_id,H.data.session);break;case"project_updated":if(H.data&&H.data.project){const X=H.data.project;Y.updateProjectLocal(X.project_id,X)}break;case"project_deleted":H.data&&H.data.project_id&&Y.projects.delete(H.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":T.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",H.type)}}function ve(H,W){const Y=te();if(Y.currentSessionId!==W){console.warn(`Ignoring message for session ${W} (current: ${Y.currentSessionId})`);return}const X=De();switch(H.type){case"message":const J=H.data;if(!J||!J.type){console.warn("Received message event with invalid data:",H);break}if(J.type==="permission_request"){X.handlePermissionRequest(W,J);break}if(J.type==="permission_response"){X.handlePermissionResponse(W,J);break}J.metadata?.has_tool_uses&&J.metadata.tool_uses.forEach(pe=>{X.handleToolUse(W,pe)}),J.metadata?.has_tool_results&&J.metadata.tool_results.forEach(pe=>{X.handleToolResult(W,pe)}),J.type==="system"&&(J.subtype==="init"||J.metadata?.subtype==="init")&&J.metadata?.init_data&&Y.storeInitData(W,J.metadata.init_data),X.addMessage(W,J);break;case"permission_request":X.handlePermissionRequest(W,H);break;case"permission_response":X.handlePermissionResponse(W,H);break;case"tool_result":X.handleToolResult(W,H);break;case"state_change":Y.updateSession(W,H.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${W}`);break;case"ping":D.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function Q(H){B(),f.value=H;const W=A(`/ws/legion/${H}`);console.log(`Connecting to Legion WebSocket: ${W}`),v.value=new WebSocket(W),v.value.onopen=()=>{w.value=!0,y.value=0,I.value=Date.now(),S("legion"),console.log(`Legion WebSocket connected for ${H}`)},v.value.onmessage=Y=>{const X=JSON.parse(Y.data);ae(X,H)},v.value.onclose=()=>{if(O("legion"),w.value=!1,v.value=null,console.log(`Legion WebSocket closed for ${H}`),f.value===H&&y.value<g){y.value++;const Y=Math.min(2e3*y.value,3e4);setTimeout(()=>Q(H),Y)}},v.value.onerror=Y=>{console.error("Legion WebSocket error:",Y)}}function B(){v.value&&(v.value.close(),v.value=null,w.value=!1,f.value=null)}function ae(H,W){ge(async()=>{const{useLegionStore:Y}=await Promise.resolve().then(()=>$u);return{useLegionStore:Y}},void 0).then(({useLegionStore:Y})=>{const X=Y();switch(H.type){case"comm":H.comm&&(X.addComm(W,H.comm),console.log("Legion WebSocket: Received new comm",H.comm));break;case"minion_created":H.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",H.data),ge(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>_n);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"minion_updated":H.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",H.data),ge(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>_n);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${W}`);break;case"ping":I.value=Date.now(),v.value?.readyState===WebSocket.OPEN&&v.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",H.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:a,sessionRetryCount:r,legionConnected:w,legionRetryCount:y,overallStatus:N,connectUI:x,disconnectUI:j,connectSession:F,disconnectSession:U,sendMessage:oe,sendPermissionResponse:le,interruptSession:me,connectLegion:Q,disconnectLegion:B}}),ua=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:He},Symbol.toStringTag,{value:"Module"})),ma={class:"base-tool-handler"},pa={class:"tool-section"},fa={class:"tool-parameters"},va={class:"tool-code"},ha={key:0,class:"tool-section"},_a={class:"tool-section-label"},ga={class:"tool-code"},ba={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=_(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,l)=>(u(),m("div",ma,[t("div",pa,[l[0]||(l[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",fa,[t("pre",va,$(s.value),1)])]),o.value?(u(),m("div",ha,[t("div",_a,$(i.value?"Error:":"Result:"),1),t("div",{class:z(["tool-result",{"tool-result-error":i.value}])},[t("pre",ga,$(a.value),1)],2)])):P("",!0)]))}},ya=K(ba,[["__scopeId","data-v-1e69f57d"]]),$a={class:"read-tool-handler"},wa={class:"tool-section"},Ea={class:"read-file-info"},Ca={class:"file-path"},Sa={key:0,class:"read-range"},ka={key:0,class:"tool-section"},Ta={key:0,class:"tool-result tool-result-error"},xa={class:"tool-code"},Aa={key:1,class:"file-content-preview"},Ma={class:"content-header"},Oa={class:"line-count-badge"},Na={key:0,class:"preview-note"},La={class:"tool-code content-display"},Da={key:0,class:"more-indicator"},ps=100,Ia={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>{const v=e.toolCall.input?.offset,w=e.toolCall.input?.limit;return v!==void 0||w!==void 0}),i=_(()=>{const v=e.toolCall.input?.offset;return v!==void 0?v+1:1}),a=_(()=>{const v=e.toolCall.input?.offset||0,w=e.toolCall.input?.limit;return w!==void 0?v+w:"∞"}),r=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=_(()=>{if(!r.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),p=_(()=>l.value||!c.value?[]:c.value.split(`
`)),d=_(()=>p.value.length),h=_(()=>d.value>ps),b=_(()=>l.value?"":p.value.slice(0,ps).join(`
`));return(v,w)=>(u(),m("div",$a,[t("div",wa,[t("div",Ea,[w[0]||(w[0]=t("span",{class:"file-icon"},"📄",-1)),w[1]||(w[1]=t("strong",null,"Reading:",-1)),t("code",Ca,$(s.value),1),o.value?(u(),m("span",Sa,"Lines "+$(i.value)+"-"+$(a.value),1)):P("",!0)])]),r.value?(u(),m("div",ka,[l.value?(u(),m("div",Ta,[t("pre",xa,$(c.value),1)])):(u(),m("div",Aa,[t("div",Ma,[w[2]||(w[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Oa,$(d.value)+" lines",1),h.value?(u(),m("span",Na,"(showing first "+$(ps)+")")):P("",!0)]),t("pre",La,$(b.value),1),h.value?(u(),m("div",Da,"...")):P("",!0)]))])):P("",!0)]))}},Pa=K(Ia,[["__scopeId","data-v-1f2b0569"]]),ja={class:"write-tool-handler"},Ra={class:"tool-section"},Va={class:"write-file-info mb-2"},Ha={class:"file-path"},Wa={class:"write-content-preview"},Fa={class:"content-header"},Ua={class:"line-count-badge"},Ba={key:0,class:"preview-note"},qa={class:"tool-code content-display"},za={key:0,class:"more-indicator"},Ka={key:0,class:"tool-section"},Ya={key:0,class:"tool-result tool-result-error"},Ga={class:"tool-code"},Ja={key:1,class:"tool-result tool-result-success"},Xa={class:"success-message"},fs=100,Qa={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.content||""),i=_(()=>o.value.split(`
`)),a=_(()=>i.value.length),r=_(()=>a.value>fs),l=_(()=>i.value.slice(0,fs).join(`
`)),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!c.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,b)=>(u(),m("div",ja,[t("div",Ra,[t("div",Va,[b[0]||(b[0]=t("span",{class:"file-icon"},"📝",-1)),b[1]||(b[1]=t("strong",null,"Writing:",-1)),t("code",Ha,$(s.value),1)]),t("div",Wa,[t("div",Fa,[b[2]||(b[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Ua,$(a.value)+" lines",1),r.value?(u(),m("span",Ba,"(showing first "+$(fs)+")")):P("",!0)]),t("pre",qa,$(l.value),1),r.value?(u(),m("div",za,"...")):P("",!0)])]),c.value?(u(),m("div",Ka,[p.value?(u(),m("div",Ya,[b[3]||(b[3]=t("strong",null,"Error:",-1)),t("pre",Ga,$(d.value),1)])):(u(),m("div",Ja,[t("div",Xa,[b[4]||(b[4]=t("span",{class:"success-icon"},"✅",-1)),t("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):P("",!0)]))}},Za=K(Qa,[["__scopeId","data-v-ddc24a0f"]]),er={class:"bash-tool-handler"},tr={class:"tool-section"},sr={class:"bash-header"},nr={class:"bash-header-content"},or={key:0,class:"bash-description"},ir={key:1,class:"bash-flags"},ar={class:"bash-command-section"},rr={class:"bash-command-content"},lr={key:0,class:"tool-section"},cr={key:0,class:"bash-output"},dr={key:1,class:"bash-output-empty"},ur={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.command||""),o=_(()=>e.toolCall.input?.description||""),i=_(()=>e.toolCall.input?.timeout),a=_(()=>e.toolCall.input?.run_in_background||!1),r=_(()=>i.value||a.value),l=_(()=>{const b=[];return i.value&&b.push(`timeout: ${i.value}ms`),a.value&&b.push("background"),b.join(", ")}),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>p.value?"tool-result-error":"tool-result-success"),h=_(()=>{if(!c.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,v)=>(u(),m("div",er,[t("div",tr,[t("div",sr,[v[1]||(v[1]=t("span",{class:"bash-icon"},"💻",-1)),t("div",nr,[o.value?(u(),m("div",or,[v[0]||(v[0]=t("strong",null,"Description:",-1)),q(" "+$(o.value),1)])):P("",!0),r.value?(u(),m("div",ir,$(l.value),1)):P("",!0)])]),t("div",ar,[v[2]||(v[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",rr,$(s.value),1)])]),c.value?(u(),m("div",lr,[t("div",{class:z(["tool-result",d.value])},[v[3]||(v[3]=t("strong",null,"Output:",-1)),h.value?(u(),m("pre",cr,$(h.value),1)):(u(),m("div",dr,"No output"))],2)])):P("",!0)]))}},mr=K(ur,[["__scopeId","data-v-ab50fe73"]]),pr={class:"todo-tool-handler"},fr={class:"tool-section"},vr={class:"todo-header"},hr={class:"todo-summary"},_r={key:0,class:"todo-count todo-count-completed"},gr={key:1,class:"todo-count todo-count-in-progress"},br={key:2,class:"todo-count todo-count-pending"},yr={class:"todo-checklist"},$r={class:"todo-checkbox"},wr={class:"todo-content"},Er={key:0,class:"tool-section"},Cr={key:0,class:"tool-result tool-result-error"},Sr={class:"tool-code"},kr={key:1,class:"tool-result tool-result-success"},Tr={class:"success-message"},xr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.todos||[]),o=_(()=>s.value.filter(d=>d.status==="completed").length),i=_(()=>s.value.filter(d=>d.status==="in_progress").length),a=_(()=>s.value.filter(d=>d.status==="pending").length);function r(d){return{pending:"☐",in_progress:"◐",completed:"☑"}[d]||"☐"}const l=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=_(()=>{if(!l.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,h)=>(u(),m("div",pr,[t("div",fr,[t("div",vr,[h[0]||(h[0]=t("span",{class:"todo-icon"},"📋",-1)),h[1]||(h[1]=t("strong",null,"Task List:",-1)),t("div",hr,[o.value>0?(u(),m("span",_r,$(o.value)+" completed ",1)):P("",!0),i.value>0?(u(),m("span",gr,$(i.value)+" in progress ",1)):P("",!0),a.value>0?(u(),m("span",br,$(a.value)+" pending ",1)):P("",!0)])]),t("div",yr,[(u(!0),m(se,null,ie(s.value,(b,v)=>(u(),m("div",{key:v,class:z(["todo-item",`todo-${b.status}`])},[t("span",$r,$(r(b.status)),1),t("span",wr,$(b.content),1)],2))),128))])]),l.value?(u(),m("div",Er,[c.value?(u(),m("div",Cr,[h[2]||(h[2]=t("strong",null,"Error:",-1)),t("pre",Sr,$(p.value),1)])):(u(),m("div",kr,[t("div",Tr,[h[3]||(h[3]=t("span",{class:"success-icon"},"✅",-1)),t("strong",null,"Task list updated ("+$(s.value.length)+" tasks)",1)])]))])):P("",!0)]))}},Ar=K(xr,[["__scopeId","data-v-bbe55ee7"]]),Mr={class:"edit-tool-handler"},Or={class:"tool-section"},Nr={class:"edit-file-info"},Lr={class:"file-path"},Dr={key:0,class:"replace-all-badge"},Ir={class:"edit-diff-container"},Pr={class:"diff-header"},jr={class:"diff-stats"},Rr={class:"stat-removed"},Vr={class:"stat-added"},Hr={class:"unified-diff"},Wr={class:"diff-scroll-container"},Fr={class:"diff-marker"},Ur={class:"diff-content"},Br={key:0,class:"tool-section"},qr={key:0,class:"tool-result tool-result-error"},zr={class:"tool-code"},Kr={key:1,class:"tool-result tool-result-success"},Yr={class:"success-message"},Gr={key:0,class:"success-detail"},Jr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.old_string||""),i=_(()=>e.toolCall.input?.new_string||""),a=_(()=>e.toolCall.input?.replace_all||!1),r=_(()=>{const v=_i(s.value,o.value,i.value,"","",{context:3}).split(`
`),w=[];for(let y=4;y<v.length;y++){const g=v[y];g&&(g.startsWith("-")?w.push({type:"removed",content:g.substring(1)}):g.startsWith("+")?w.push({type:"added",content:g.substring(1)}):g.startsWith(" ")?w.push({type:"context",content:g.substring(1)}):g.startsWith("@@")&&w.push({type:"hunk",content:g}))}return w}),l=_(()=>r.value.filter(b=>b.type==="removed").length),c=_(()=>r.value.filter(b=>b.type==="added").length),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=_(()=>{if(!p.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,v)=>(u(),m("div",Mr,[t("div",Or,[t("div",Nr,[v[0]||(v[0]=t("span",{class:"file-icon"},"✏️",-1)),v[1]||(v[1]=t("strong",null,"Editing:",-1)),t("code",Lr,$(s.value),1),a.value?(u(),m("span",Dr,"Replace All")):P("",!0)]),t("div",Ir,[t("div",Pr,[v[2]||(v[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",jr,[t("span",Rr,"-"+$(l.value),1),t("span",Vr,"+"+$(c.value),1)])]),t("div",Hr,[t("div",Wr,[(u(!0),m(se,null,ie(r.value,(w,y)=>(u(),m("div",{key:y,class:z(["diff-line",{"diff-line-removed":w.type==="removed","diff-line-added":w.type==="added","diff-line-context":w.type==="context","diff-line-hunk":w.type==="hunk"}])},[t("span",Fr,$(w.type==="removed"?"-":w.type==="added"?"+":w.type==="hunk"?"@":" "),1),t("span",Ur,$(w.content),1)],2))),128))])])])]),p.value?(u(),m("div",Br,[d.value?(u(),m("div",qr,[v[3]||(v[3]=t("strong",null,"Error:",-1)),t("pre",zr,$(h.value),1)])):(u(),m("div",Kr,[t("div",Yr,[v[4]||(v[4]=t("span",{class:"success-icon"},"✅",-1)),v[5]||(v[5]=t("strong",null,"File edited successfully",-1)),a.value?(u(),m("span",Gr,"(all occurrences replaced)")):P("",!0)])]))])):P("",!0)]))}},Xr=K(Jr,[["__scopeId","data-v-16b90adc"]]),Qr={class:"search-tool-handler"},Zr={class:"tool-section"},el={class:"search-info"},tl={class:"search-icon"},sl={class:"search-pattern"},nl={key:0,class:"search-path"},ol={key:1,class:"search-filters"},il={key:0,class:"filter-badge"},al={key:1,class:"filter-badge"},rl={key:2,class:"filter-badge"},ll={key:0,class:"tool-section"},cl={key:0,class:"tool-result tool-result-error"},dl={class:"tool-code"},ul={key:1,class:"search-results"},ml={class:"results-header"},pl={class:"results-label"},fl={class:"results-count-badge"},vl={class:"results-content"},hl={class:"tool-code"},_l={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="Grep");_(()=>e.toolCall.name==="Glob");const o=_(()=>e.toolCall.input?.pattern||"Unknown"),i=_(()=>e.toolCall.input?.path||null),a=_(()=>e.toolCall.input?.type||null),r=_(()=>e.toolCall.input?.glob||null),l=_(()=>e.toolCall.input?.["-i"]||!1),c=_(()=>a.value||r.value||l.value),p=_(()=>s.value?"🔍":"📁"),d=_(()=>s.value?"Searching content":"Finding files"),h=_(()=>s.value?"Matches":"Files found"),b=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!b.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),y=_(()=>!b.value||v.value||!w.value?0:w.value.split(`
`).filter(f=>f.trim()).length);return(g,f)=>(u(),m("div",Qr,[t("div",Zr,[t("div",el,[t("span",tl,$(p.value),1),t("strong",null,$(d.value)+":",1),t("code",sl,$(o.value),1),i.value?(u(),m("span",nl,"in "+$(i.value),1)):P("",!0),c.value?(u(),m("span",ol,[a.value?(u(),m("span",il,"type: "+$(a.value),1)):P("",!0),r.value?(u(),m("span",al,"glob: "+$(r.value),1)):P("",!0),l.value?(u(),m("span",rl,"case-insensitive")):P("",!0)])):P("",!0)])]),b.value?(u(),m("div",ll,[v.value?(u(),m("div",cl,[f[0]||(f[0]=t("strong",null,"Error:",-1)),t("pre",dl,$(w.value),1)])):(u(),m("div",ul,[t("div",ml,[t("span",pl,$(h.value)+":",1),t("span",fl,$(y.value)+" "+$(y.value===1?"match":"matches"),1)]),t("div",vl,[t("pre",hl,$(w.value),1)])]))])):P("",!0)]))}},gn=K(_l,[["__scopeId","data-v-0d272c39"]]),gl={class:"web-tool-handler"},bl={class:"tool-section"},yl={class:"web-info"},$l={class:"web-icon"},wl=["href"],El={key:1,class:"web-query"},Cl={key:0,class:"web-prompt-container"},Sl={class:"prompt-content"},kl={key:1,class:"web-domains"},Tl={class:"domains-label"},xl={key:0,class:"tool-section"},Al={key:0,class:"tool-result tool-result-error"},Ml={class:"tool-code"},Ol={key:1,class:"web-results"},Nl={class:"results-header"},Ll={class:"results-label"},Dl={class:"results-content"},Il={class:"tool-code"},Pl={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="WebFetch");_(()=>e.toolCall.name==="WebSearch");const o=_(()=>e.toolCall.input?.url||null),i=_(()=>e.toolCall.input?.query||null),a=_(()=>e.toolCall.input?.prompt||null),r=_(()=>e.toolCall.input?.allowed_domains||[]),l=_(()=>e.toolCall.input?.blocked_domains||[]),c=_(()=>r.value.length>0?r.value:l.value.length>0?l.value:[]),p=_(()=>r.value.length>0?"Allowed domains":l.value.length>0?"Blocked domains":"Domains"),d=_(()=>s.value?"🌐":"🔎"),h=_(()=>s.value?"Fetching URL":"Searching web"),b=_(()=>s.value?"Fetched content":"Search results"),v=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=_(()=>{if(!v.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,f)=>(u(),m("div",gl,[t("div",bl,[t("div",yl,[t("span",$l,$(d.value),1),t("strong",null,$(h.value)+":",1),o.value?(u(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},$(o.value),9,wl)):i.value?(u(),m("code",El,$(i.value),1)):P("",!0)]),a.value?(u(),m("div",Cl,[f[0]||(f[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Sl,$(a.value),1)])):P("",!0),c.value.length>0?(u(),m("div",kl,[t("span",Tl,$(p.value)+":",1),(u(!0),m(se,null,ie(c.value,M=>(u(),m("span",{key:M,class:"domain-badge"},$(M),1))),128))])):P("",!0)]),v.value?(u(),m("div",xl,[w.value?(u(),m("div",Al,[f[1]||(f[1]=t("strong",null,"Error:",-1)),t("pre",Ml,$(y.value),1)])):(u(),m("div",Ol,[t("div",Nl,[t("span",Ll,$(b.value)+":",1)]),t("div",Dl,[t("pre",Il,$(y.value),1)])]))])):P("",!0)]))}},bn=K(Pl,[["__scopeId","data-v-62b55b55"]]),jl={class:"task-tool-handler"},Rl={class:"tool-section"},Vl={class:"task-header"},Hl={key:0,class:"agent-type-badge"},Wl={key:0,class:"task-description"},Fl={class:"description-content"},Ul={key:1,class:"task-prompt-container"},Bl={class:"prompt-header"},ql={class:"prompt-length"},zl={class:"prompt-code"},Kl={key:0,class:"tool-section"},Yl={key:0,class:"tool-result tool-result-error"},Gl={class:"tool-code"},Jl={key:1,class:"agent-output"},Xl={class:"output-header"},Ql={key:0,class:"output-count-badge"},Zl={class:"output-content"},ec={class:"tool-code"},tc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.description||null),o=_(()=>e.toolCall.input?.prompt||null),i=_(()=>e.toolCall.input?.subagent_type||null),a=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=_(()=>{if(!a.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),c=_(()=>l.value?l.value.split(`
`).length:0);return(p,d)=>(u(),m("div",jl,[t("div",Rl,[t("div",Vl,[d[0]||(d[0]=t("span",{class:"task-icon"},"🤖",-1)),d[1]||(d[1]=t("strong",null,"Agent Task:",-1)),i.value?(u(),m("span",Hl,$(i.value),1)):P("",!0)]),s.value?(u(),m("div",Wl,[d[2]||(d[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Fl,$(s.value),1)])):P("",!0),o.value?(u(),m("div",Ul,[t("div",Bl,[d[3]||(d[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",ql,$(o.value.length)+" characters",1)]),t("pre",zl,$(o.value),1)])):P("",!0)]),a.value?(u(),m("div",Kl,[r.value?(u(),m("div",Yl,[d[4]||(d[4]=t("strong",null,"Error:",-1)),t("pre",Gl,$(l.value),1)])):(u(),m("div",Jl,[t("div",Xl,[d[5]||(d[5]=t("span",{class:"output-label"},"Agent Output:",-1)),c.value>0?(u(),m("span",Ql,$(c.value)+" lines",1)):P("",!0)]),t("div",Zl,[t("pre",ec,$(l.value),1)])]))])):P("",!0)]))}},sc=K(tc,[["__scopeId","data-v-c520c244"]]),nc={class:"notebook-edit-tool-handler"},oc={class:"tool-section"},ic={class:"notebook-info"},ac={class:"file-path"},rc={class:"cell-info mt-2"},lc={class:"info-row"},cc={class:"info-row"},dc={key:0,class:"info-row"},uc={class:"badge bg-info"},mc={key:0,class:"source-preview mt-3"},pc={class:"preview-header"},fc={class:"preview-stats"},vc={class:"source-code"},hc={key:0,class:"tool-section"},_c={key:0},gc={key:1,class:"text-danger"},bc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.notebook_path||"Unknown"),o=_(()=>e.toolCall.input?.cell_id),i=_(()=>e.toolCall.input?.cell_type||"code"),a=_(()=>e.toolCall.input?.edit_mode||"replace"),r=_(()=>e.toolCall.input?.new_source||""),l=_(()=>r.value.split(`
`).length),c=_(()=>i.value==="code"?"bg-primary":"bg-secondary"),p=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const h=a.value;return h==="insert"?"Cell inserted successfully":h==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(h,b)=>(u(),m("div",nc,[t("div",oc,[t("div",ic,[b[0]||(b[0]=t("span",{class:"notebook-icon"},"📓",-1)),b[1]||(b[1]=t("strong",null,"Notebook:",-1)),t("code",ac,$(s.value),1)]),t("div",rc,[t("div",lc,[b[2]||(b[2]=t("strong",null,"Cell ID:",-1)),t("code",null,$(o.value||"N/A"),1)]),t("div",cc,[b[3]||(b[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:z(["badge",c.value])},$(i.value),3)]),a.value?(u(),m("div",dc,[b[4]||(b[4]=t("strong",null,"Edit Mode:",-1)),t("span",uc,$(a.value),1)])):P("",!0)]),r.value?(u(),m("div",mc,[t("div",pc,[b[5]||(b[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",fc,$(l.value)+" lines",1)]),t("pre",vc,[t("code",null,$(r.value),1)])])):P("",!0)]),n.toolCall.result?(u(),m("div",hc,[b[8]||(b[8]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:z(["tool-result",p.value])},[n.toolCall.result.success!==!1?(u(),m("div",_c,[b[6]||(b[6]=t("i",{class:"bi bi-check-circle"},null,-1)),q(" "+$(d.value),1)])):(u(),m("div",gc,[b[7]||(b[7]=t("i",{class:"bi bi-x-circle"},null,-1)),q(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)])):P("",!0)]))}},yc=K(bc,[["__scopeId","data-v-bf9ef8f9"]]),$c={class:"shell-tool-handler"},wc={class:"tool-section"},Ec={class:"shell-info"},Cc={class:"shell-icon"},Sc={key:0,class:"shell-id"},kc={key:0,class:"filter-info mt-2"},Tc={class:"filter-pattern"},xc={key:0,class:"tool-section"},Ac={class:"result-header mb-2"},Mc={key:0,class:"mb-2"},Oc={class:"shell-output"},Nc={key:1,class:"mb-2"},Lc={class:"shell-output shell-output-error"},Dc={key:0},Ic={key:1,class:"text-danger"},Pc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="BashOutput"?"📤":e.toolCall.name==="KillShell"?"🛑":"🐚"),o=_(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=_(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=_(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=_(()=>e.toolCall.input?.filter);function l(v,w){if(!v)return null;const y=new RegExp(`<${w}>([\\s\\S]*?)<\\/${w}>`,"i"),g=v.match(y);return g?g[1].trim():null}const c=_(()=>{const v=e.toolCall.result;if(!v)return null;let w=v;if(v.content&&(w=v.content),typeof w=="string")return{status:l(w,"status"),stdout:l(w,"stdout"),stderr:l(w,"stderr"),exit_code:l(w,"exit_code")};if(Array.isArray(w)){const y=w.find(g=>g.type==="text")?.text||"";return{status:l(y,"status"),stdout:l(y,"stdout"),stderr:l(y,"stderr"),exit_code:l(y,"exit_code")}}return{status:v.status||w.status,stdout:v.stdout||v.output||w.stdout||w.output,stderr:v.stderr||w.stderr,exit_code:v.exit_code||w.exit_code}});_(()=>{if(e.toolCall.name==="BashOutput"){const v=c.value;if(!v)return null;const w=[];return v.stdout&&w.push(v.stdout),v.stderr&&w.push(`[stderr]
${v.stderr}`),w.length>0?w.join(`

`):null}return null});const p=_(()=>c.value?.status),d=_(()=>{const v=p.value;return v==="running"?"bg-success":v==="completed"?"bg-secondary":v==="killed"||v==="terminated"?"bg-danger":"bg-info"}),h=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),b=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const v=c.value;if(v?.status==="running"&&!v.stdout&&!v.stderr)return"No new output since last check";if(v?.status==="failed")return`Shell failed (exit code ${v.exit_code||"unknown"})`}return"Operation completed"});return(v,w)=>(u(),m("div",$c,[t("div",wc,[t("div",Ec,[t("span",Cc,$(s.value),1),t("strong",null,$(o.value)+":",1),a.value?(u(),m("code",Sc,"Shell "+$(a.value),1)):P("",!0)]),n.toolCall.name==="BashOutput"&&r.value?(u(),m("div",kc,[w[0]||(w[0]=t("strong",null,"Filter:",-1)),t("code",Tc,$(r.value),1)])):P("",!0)]),n.toolCall.result?(u(),m("div",xc,[t("div",Ac,[t("strong",null,$(i.value)+":",1),p.value?(u(),m("span",{key:0,class:z(["badge",d.value])},$(p.value),3)):P("",!0)]),c.value?.stdout?(u(),m("div",Mc,[w[1]||(w[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Oc,[t("pre",null,[t("code",null,$(c.value.stdout),1)])])])):P("",!0),c.value?.stderr?(u(),m("div",Nc,[w[2]||(w[2]=t("div",{class:"output-label text-danger"},[t("i",{class:"bi bi-exclamation-triangle"}),q(" Errors: ")],-1)),t("div",Lc,[t("pre",null,[t("code",null,$(c.value.stderr),1)])])])):P("",!0),!c.value?.stdout&&!c.value?.stderr?(u(),m("div",{key:2,class:z(["tool-result",h.value])},[n.toolCall.result.success!==!1?(u(),m("div",Dc,[w[3]||(w[3]=t("i",{class:"bi bi-check-circle"},null,-1)),q(" "+$(b.value),1)])):(u(),m("div",Ic,[w[4]||(w[4]=t("i",{class:"bi bi-x-circle"},null,-1)),q(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)):P("",!0)])):P("",!0)]))}},yn=K(Pc,[["__scopeId","data-v-99efb136"]]),jc={class:"skill-tool-handler"},Rc={key:0,class:"tool-section"},Vc={class:"d-flex align-items-center gap-2"},Hc={class:"text-muted small"},Wc={key:0,class:"skill-content-body"},Fc={class:"skill-content-text"},Uc={key:1,class:"tool-section mt-3"},Bc={class:"tool-result tool-result-error"},qc={class:"tool-code"},zc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=De(),o=te(),i=L(!1);function a(){i.value=!i.value}_(()=>e.toolCall.input?.command||"Unknown Skill"),_(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),_(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=_(()=>{const b=o.currentSessionId;if(!b)return{running:null,content:null};const v=s.messagesBySession.get(b)||[],w=v.findIndex(f=>f.type==="user"&&f.metadata?.has_tool_results&&f.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let y=null,g=null;for(let f=w+1;f<Math.min(w+3,v.length);f++){const M=v[f];if(M.type!=="user")continue;const C=M.content||"";C.includes("<command-message>")&&C.includes("skill is running")?y=M:C.startsWith("Base directory for this skill:")&&(g=M)}return{running:y,content:g}});_(()=>{const b=r.value.content;if(!b)return null;const w=(b.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return w&&w[1]?w[1].trim():null});const l=_(()=>{const b=r.value.content;if(!b)return"";const v=b.content||"",w=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return v.replace(w,"").trim()}),c=_(()=>l.value.length>0),p=_(()=>l.value?l.value.split(`
`).length:0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=_(()=>{if(!d.value)return"";const b=e.toolCall.result;return b?.message?b.message:b?.error?b.error:"An error occurred"});return(b,v)=>(u(),m("div",jc,[c.value?(u(),m("div",Rc,[t("div",{class:"skill-content-header",onClick:a},[t("div",Vc,[t("i",{class:z(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),v[0]||(v[0]=t("strong",null,"Skill Content",-1)),t("span",Hc,"("+$(p.value)+" lines)",1)])]),i.value?(u(),m("div",Wc,[t("pre",Fc,$(l.value),1)])):P("",!0)])):P("",!0),d.value?(u(),m("div",Uc,[v[1]||(v[1]=t("div",{class:"tool-section-label text-danger"},[t("i",{class:"bi bi-x-circle"}),q(" Error: ")],-1)),t("div",Bc,[t("pre",qc,$(h.value),1)])])):P("",!0)]))}},Kc=K(zc,[["__scopeId","data-v-ba9a91da"]]),Yc={class:"slashcommand-tool-handler"},Gc={key:0,class:"tool-section"},Jc={class:"d-flex align-items-center gap-2"},Xc={class:"text-muted small"},Qc={key:0,class:"command-content-body"},Zc={class:"command-content-text"},ed={key:1,class:"tool-section mt-3"},td={class:"tool-result tool-result-error"},sd={class:"tool-code"},nd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=De(),o=te(),i=L(!1);function a(){i.value=!i.value}_(()=>e.toolCall.input?.command||"Unknown Command"),_(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),_(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=_(()=>{const b=o.currentSessionId;if(!b)return{running:null,content:null};const v=s.messagesBySession.get(b)||[],w=v.findIndex(f=>f.type==="user"&&f.metadata?.has_tool_results&&f.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let y=null,g=null;for(let f=w+1;f<Math.min(w+3,v.length);f++){const M=v[f];if(M.type!=="user")continue;const C=M.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?y=M:C.includes("ARGUMENTS:")&&(g=M)}return{running:y,content:g}});_(()=>{const b=r.value.running;if(!b)return null;const w=(b.content||"").match(/<command-args>(.+?)<\/command-args>/s);return w&&w[1]?w[1].trim():null});const l=_(()=>{const b=r.value.content;if(!b)return"";const v=b.content||"",w=/\nARGUMENTS:.*$/s;return v.replace(w,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),c=_(()=>l.value.length>0),p=_(()=>l.value?l.value.split(`
`).length:0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=_(()=>{if(!d.value)return"";const b=e.toolCall.result;return b?.message?b.message:b?.error?b.error:"An error occurred"});return(b,v)=>(u(),m("div",Yc,[c.value?(u(),m("div",Gc,[t("div",{class:"command-content-header",onClick:a},[t("div",Jc,[t("i",{class:z(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),v[0]||(v[0]=t("strong",null,"Command Content",-1)),t("span",Xc,"("+$(p.value)+" lines)",1)])]),i.value?(u(),m("div",Qc,[t("pre",Zc,$(l.value),1)])):P("",!0)])):P("",!0),d.value?(u(),m("div",ed,[v[1]||(v[1]=t("div",{class:"tool-section-label text-danger"},[t("i",{class:"bi bi-x-circle"}),q(" Error: ")],-1)),t("div",td,[t("pre",sd,$(h.value),1)])])):P("",!0)]))}},od=K(nd,[["__scopeId","data-v-17d3444e"]]),id={class:"exit-plan-mode-tool-handler"},ad={class:"tool-section"},rd={key:0,class:"plan-content mt-2"},ld={class:"plan-text"},cd={key:0,class:"tool-section"},dd={key:0},ud={key:1,class:"text-danger"},md={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.plan),o=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),m("div",id,[t("div",ad,[a[1]||(a[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"📋"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(u(),m("div",rd,[a[0]||(a[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",ld,$(s.value),1)])):P("",!0)]),n.toolCall.result?(u(),m("div",cd,[a[4]||(a[4]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:z(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),m("div",dd,[...a[2]||(a[2]=[t("i",{class:"bi bi-check-circle"},null,-1),q(" Permission mode reverted to default ",-1)])])):(u(),m("div",ud,[a[3]||(a[3]=t("i",{class:"bi bi-x-circle"},null,-1)),q(" "+$(n.toolCall.result.error||"Failed to exit plan mode"),1)]))],2)])):P("",!0)]))}},pd=K(md,[["__scopeId","data-v-bd35183e"]]),fd={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},vd={class:"tool-status-icon"},hd=["title"],_d={class:"d-flex align-items-center gap-2"},gd={class:"text-muted"},bd={key:0,class:"card-body"},yd={key:0,class:"alert alert-warning mb-3"},$d={class:"d-flex align-items-center"},wd={class:"mb-0 small"},Ed={key:1,class:"permission-prompt mt-3"},Cd={class:"alert alert-warning mb-3"},Sd={class:"mb-0"},kd={class:"tool-name"},Td={key:0,class:"suggestions-section mb-3"},xd={class:"alert alert-info mb-0"},Ad={class:"suggestion-details p-2 bg-white rounded"},Md={class:"permission-buttons d-flex gap-2 mb-3"},Od=["disabled"],Nd=["disabled"],Ld=["disabled"],Dd={class:"guidance-section mt-3"},Id=["disabled"],Pd=["disabled"],jd={key:2,class:"mt-3"},Rd={class:"alert alert-warning mb-0"},Vd={class:"d-flex align-items-center"},Hd={class:"mb-0 small"},Wd={key:3,class:"tool-section"},Fd={class:"alert alert-danger mb-0"},Ud={key:0},Bd={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=De(),o=te(),i=He(),a=L(!1),r=L(null),l=L(""),c=_(()=>s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),p=_(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),d={Read:Pa,Write:Za,Bash:mr,TodoWrite:Ar,Edit:Xr,Grep:gn,Glob:gn,WebFetch:bn,WebSearch:bn,Task:sc,NotebookEdit:yc,BashOutput:yn,KillShell:yn,SlashCommand:od,Skill:Kc,ExitPlanMode:pd},h=_(()=>{const N=e.toolCall.name;return d[N]?d[N]:ya}),b=_(()=>{const N=[];switch(e.toolCall.status){case"pending":N.push("border-secondary");break;case"permission_required":N.push("border-warning");break;case"executing":N.push("border-primary");break;case"completed":y.value||e.toolCall.permissionDecision==="deny"?N.push("border-danger"):N.push("border-success");break;case"error":N.push("border-danger");break}return N.join(" ")}),v=_(()=>{switch(e.toolCall.status){case"pending":return"🔄";case"permission_required":return"❓";case"executing":return"⚡";case"completed":return e.toolCall.permissionDecision==="deny"?"❌":y.value?"💥":"✅";case"error":return"💥";default:return"🔧"}}),w=_(()=>ss(e.toolCall.timestamp)),y=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=_(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function f(N){if(!N)return"";const A=N.replace(/\\/g,"/").split("/");return A[A.length-1]}function M(N,A=200){return N?N.length<=A?N:N.substring(0,A)+"...":""}function C(N){if(!N)return null;if(N.content){const A=N.content.match(/exit code (\d+)/i);if(A)return parseInt(A[1])}return N.error?1:0}function T(N,A){const S=N?N.split(`
`).length:0;return{added:A?A.split(`
`).length:0,removed:S}}const D=_(()=>{const N=e.toolCall.name,A=e.toolCall.input||{},S=e.toolCall.result,O=e.toolCall.status;switch(N){case"Bash":case"Shell":case"Command":{const x=M(A.command,200);if(O==="completed"&&S){const j=C(S);return`Bash: ${x} (exit ${j})`}return`Bash: ${x}`}case"SlashCommand":{const x=M(A.command,200);return O==="completed"&&S?`SlashCommand: ${x}`:`SlashCommand: ${x}`}case"Edit":{const x=f(A.file_path);if(O==="completed"&&S&&!S.error){const{added:j,removed:F}=T(A.old_string,A.new_string);return j===F?`Edit: ${x} (${j} lines changed)`:`Edit: ${x} (${j} lines added, ${F} removed)`}return`Edit: ${x}`}case"Read":{const x=f(A.file_path);if(A.offset!==void 0||A.limit!==void 0){const F=(A.offset||0)+1,U=A.limit?(A.offset||0)+A.limit:"∞";return`Read: ${x} (lines ${F}-${U})`}return`Read: ${x} (full file)`}case"Write":{const x=f(A.file_path);if(O==="completed"&&S&&!S.error&&A.content){const j=A.content.split(`
`).length;return`Write: ${x} (${j} lines written)`}return`Write: ${x}`}case"Skill":{const x=A.command||"Unknown";return O==="completed"&&S?S.error?`Skill: ${x} (error)`:`Skill: ${x} (completed)`:`Skill: ${x}`}case"Task":{const x=A.subagent_type||"general",j=A.description||"Task";return O==="completed"&&S?S.error?`Task: (${x}) ${j} (error)`:`Task: (${x}) ${j} (completed)`:`Task: (${x}) ${j}`}case"TodoWrite":{if(A.todos&&Array.isArray(A.todos)){const x=A.todos.filter(U=>U.status==="completed").length,j=A.todos.length,F=A.todos.find(U=>U.status==="in_progress");return F?`Todo: Working on "${F.content}"`:`Todo: ${x}/${j} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const x=A.pattern||"",j=N==="Grep"?"Grep":"Glob";if(O==="completed"&&S&&!S.error){let F=0;return S.content&&(F=S.content.split(`
`).filter(oe=>oe.trim()).length),`${j}: "${x}" (${F} results)`}return`${j}: "${x}"`}case"WebFetch":case"WebSearch":{const x=A.url||A.query||"";if(N==="WebSearch"){const F=A.query||"",U=F.length>50?F.substring(0,50)+"...":F;return O==="completed"&&S?S.error?`Web: ${U} (error)`:`Web: ${U} (success)`:`Web: ${U}`}let j="";try{x&&(j=new URL(x.startsWith("http")?x:`https://${x}`).hostname)}catch{j=x.length>50?x.substring(0,50)+"...":x}return O==="completed"&&S?S.error?`Web: ${j} (error)`:`Web: ${j} (success)`:`Web: ${j||x}`}case"NotebookEdit":{const x=f(A.notebook_path),j=A.cell_number!==void 0?A.cell_number:"?",F=A.edit_mode||"replace";return`NotebookEdit: ${x} cell #${j} (${F})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${A.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${A.shell_id||"unknown"}`;default:return`${N}: executed`}}),I=_(()=>{const N=e.toolCall.name,A=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(N)?A.command||N:["Edit","Read","Write","NotebookEdit"].includes(N)&&(A.file_path||A.notebook_path)||N});function E(){const N=o.currentSessionId;N&&s.toggleToolExpansion(N,e.toolCall.id)}function k(N){return N.type==="setMode"?`Set permission mode to "${N.mode}"`:N.type==="allow"?`Allow tool: ${N.tool}`:JSON.stringify(N)}async function R(N,A,S=null){if(!a.value){a.value=!0,N==="allow"?r.value=A?"approve-apply":"approve":S?r.value="deny-guidance":r.value="deny";try{const O=o.currentSessionId;if(O){const x=A&&e.toolCall.suggestions?e.toolCall.suggestions:[];s.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:N,reasoning:N==="allow"?"User allowed permission":"User denied permission",applied_updates:x})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,N,A,S)}catch(O){console.error("Failed to send permission response:",O)}finally{a.value=!1,r.value=null}}}return(N,A)=>(u(),m("div",{class:z(["tool-call-card card",b.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:E},[t("div",fd,[t("span",vd,$(v.value),1),t("strong",{class:"tool-name",title:I.value},$(D.value),9,hd)]),t("div",_d,[t("small",gd,$(w.value),1),t("i",{class:z(["bi",n.toolCall.isExpanded?"bi-chevron-up":"bi-chevron-down"])},null,2)])]),n.toolCall.isExpanded?(u(),m("div",bd,[c.value?(u(),m("div",yd,[t("div",$d,[A[6]||(A[6]=t("i",{class:"bi bi-x-circle me-2",style:{"font-size":"1.2rem"}},null,-1)),t("div",null,[A[5]||(A[5]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",wd,$(p.value?.message||"Session was terminated"),1)])])])):P("",!0),(u(),we(oo(h.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!c.value?(u(),m("div",Ed,[t("div",Cd,[A[9]||(A[9]=t("p",{class:"mb-2"},[t("strong",null,"🔐 Permission Required")],-1)),t("p",Sd,[A[7]||(A[7]=q("Claude wants to use the ",-1)),t("code",kd,$(n.toolCall.name),1),A[8]||(A[8]=q(" tool.",-1))])]),g.value?(u(),m("div",Td,[t("div",xd,[A[10]||(A[10]=t("h6",{class:"mb-2"},[t("i",{class:"bi bi-lightbulb me-2"}),q(" Suggested Permission Update ")],-1)),A[11]||(A[11]=t("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),t("div",Ad,[(u(!0),m(se,null,ie(n.toolCall.suggestions,(S,O)=>(u(),m("div",{key:O,class:"suggestion-item"},[t("code",null,$(k(S)),1)]))),128))]),A[12]||(A[12]=t("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):P("",!0),t("div",Md,[g.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:A[0]||(A[0]=S=>R("allow",!0)),disabled:a.value},[A[13]||(A[13]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),q(" "+$(a.value&&r.value==="approve-apply"?"⏳ Submitting...":"✅ Approve & Apply"),1)],8,Od)):P("",!0),t("button",{class:z(["btn",g.value?"btn-outline-success":"btn-success"]),onClick:A[1]||(A[1]=S=>R("allow",!1)),disabled:a.value},[A[14]||(A[14]=t("i",{class:"bi bi-check-circle me-1"},null,-1)),q(" "+$(a.value&&r.value==="approve"?"⏳ Submitting...":g.value?"✅ Approve Only":"✅ Approve"),1)],10,Nd),t("button",{class:"btn btn-danger",onClick:A[2]||(A[2]=S=>R("deny",!1)),disabled:a.value},[A[15]||(A[15]=t("i",{class:"bi bi-x-circle me-1"},null,-1)),q(" "+$(a.value&&r.value==="deny"?"⏳ Submitting...":"❌ Deny"),1)],8,Ld)]),t("div",Dd,[A[17]||(A[17]=t("label",{class:"form-label fw-bold"},[t("i",{class:"bi bi-chat-left-text me-1"}),q(" Provide Guidance (Optional) ")],-1)),A[18]||(A[18]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ee(t("textarea",{"onUpdate:modelValue":A[3]||(A[3]=S=>l.value=S),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Id),[[ce,l.value]]),l.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:A[4]||(A[4]=S=>R("deny",!1,l.value)),disabled:a.value},[A[16]||(A[16]=t("i",{class:"bi bi-arrow-repeat me-1"},null,-1)),q(" "+$(a.value&&r.value==="deny-guidance"?"⏳ Submitting...":"💡 Provide Guidance & Continue"),1)],8,Pd)):P("",!0)])])):P("",!0),n.toolCall.status==="permission_required"&&c.value?(u(),m("div",jd,[t("div",Rd,[t("div",Vd,[A[20]||(A[20]=t("i",{class:"bi bi-shield-x me-2",style:{"font-size":"1.2rem"}},null,-1)),t("div",null,[A[19]||(A[19]=t("strong",null,"Permission Request Cancelled",-1)),t("p",Hd,$(p.value?.message||"Session was terminated before permission could be granted"),1)])])])])):P("",!0),n.toolCall.permissionDecision==="deny"?(u(),m("div",Wd,[t("div",Fd,[A[21]||(A[21]=t("i",{class:"bi bi-x-circle"},null,-1)),A[22]||(A[22]=q(" Permission denied ",-1)),n.toolCall.result?.message?(u(),m("span",Ud," - "+$(n.toolCall.result.message),1)):P("",!0)])])):P("",!0)])):P("",!0)],2))}},qd=K(Bd,[["__scopeId","data-v-0f254afa"]]),zd={class:"message-row message-row-assistant"},Kd=["title"],Yd={class:"message-content-column"},Gd={key:0,class:"thinking-block mb-2"},Jd=["innerHTML"],Xd={key:2,class:"tool-calls"},Qd={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=De(),o=te();Mt.setOptions({breaks:!0,gfm:!0});const i=_(()=>ss(e.message.timestamp)),a=_(()=>e.message.metadata?.model||null),r=_(()=>{const w=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${w}`}),l=_(()=>{const w=e.message.content||"";return w.trim().length>0&&w!=="Assistant response"}),c=_(()=>{const w=e.message.content||"";let y=Mt.parse(w);return y=y.replace(/\n</g,"<"),y=y.replace(/\n+$/,""),Hs.sanitize(y)}),p=_(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),d=_(()=>e.message.metadata?.thinking_content||""),h=_(()=>e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0),b=_(()=>e.message.metadata?.tool_uses||[]),v=_(()=>{const w=o.currentSessionId;if(!w)return[];const y=s.toolCallsBySession.get(w)||[];return b.value.map(g=>{const f=y.find(M=>M.id===g.id);return f||{id:g.id,name:g.name,input:g.input,status:"pending",result:null,timestamp:g.timestamp||e.message.timestamp,isExpanded:!0}})});return(w,y)=>(u(),m("div",zd,[t("div",{class:"message-speaker",title:r.value},[...y[0]||(y[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Kd),t("div",Yd,[p.value?(u(),m("div",Gd,[ne(da,{thinking:d.value},null,8,["thinking"])])):P("",!0),l.value?(u(),m("div",{key:1,class:"message-text",innerHTML:c.value},null,8,Jd)):P("",!0),h.value?(u(),m("div",Xd,[(u(!0),m(se,null,ie(v.value,g=>(u(),we(qd,{key:g.id,toolCall:g},null,8,["toolCall"]))),128))])):P("",!0)])]))}},Zd=K(Qd,[["__scopeId","data-v-726a72a7"]]),eu={class:"message-row message-row-system"},tu=["title"],su={class:"message-content-column"},nu={class:"system-text"},ou={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>ss(e.message.timestamp)),o=_(()=>`system
${s.value}`);return(i,a)=>(u(),m("div",eu,[t("div",{class:"message-speaker",title:o.value},[...a[0]||(a[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,tu),t("div",su,[t("span",nu,$(n.message.content),1)])]))}},$n=K(ou,[["__scopeId","data-v-4999cd2b"]]),iu={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>{switch(e.message.type){case"user":return oa;case"assistant":return Zd;case"system":return $n;default:return $n}});return(o,i)=>(u(),we(oo(s.value),{message:n.message},null,8,["message"]))}},au=K(iu,[["__scopeId","data-v-f283c218"]]),ru={key:0,class:"text-muted text-center py-5"},lu={__name:"MessageList",setup(n){const e=De(),s=de(),o=L(null),i=_(()=>e.currentMessages.filter(c=>r(c)));_(()=>e.currentToolCalls);async function a(){s.autoScrollEnabled&&(await Os(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}re(()=>e.currentMessages.length,a),re(()=>e.currentToolCalls.length,a),re(()=>e.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),a),ue(()=>{setTimeout(()=>{a()},100)});function r(c){const p=c.subtype||c.metadata?.subtype;if(c.type==="system"&&p==="init"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const d=c.content||"";if(d.match(/^Tool results?: \d+ results?$/i)||d.trim()==="")return!1}if(c.type==="user"){const d=c.content||"";if(d.includes("<command-message>")&&d.includes("skill is running")||d.startsWith("Base directory for this skill:"))return!1}if(c.type==="user"){const d=c.content||"";if(d.includes("<command-message>")&&d.includes("<command-name>")&&d.includes("<command-args>")||d.includes("ARGUMENTS:")&&(d.includes("<command-name>")||d.match(/\nARGUMENTS:/)))return!1}return!0}function l(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,p)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),m("div",ru," No messages yet. Start a conversation! ")):P("",!0),(u(!0),m(se,null,ie(i.value,(d,h)=>(u(),we(au,{key:`msg-${d.timestamp}-${h}`,message:l(d)},null,8,["message"]))),128))],512))}},cu=K(lu,[["__scopeId","data-v-f94a8763"]]),du={class:"border-top bg-light"},uu={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},mu={class:"d-flex gap-2 align-items-end px-2 py-1"},pu=["placeholder","disabled","onKeydown"],fu=["disabled"],vu={__name:"InputArea",setup(n){const e=te(),s=He(),o=L(null),i=_({get:()=>e.currentInput,set:b=>{e.currentInput=b}}),a=_(()=>e.currentSession?.is_processing||!1),r=_(()=>s.sessionConnected),l=_(()=>e.currentSession?.state==="starting"),c=_(()=>l.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function p(){const b=o.value;if(!b)return;b.style.height="auto";const v=Math.min(b.scrollHeight,parseInt(getComputedStyle(b).maxHeight));b.style.height=v+"px"}function d(){i.value.trim()&&(s.sendMessage(i.value),i.value="",o.value&&(o.value.style.height="auto"))}function h(){s.interruptSession()}return(b,v)=>(u(),m("div",du,[r.value?P("",!0):(u(),m("div",uu,[...v[1]||(v[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-exclamation-triangle-fill flex-shrink-0",viewBox:"0 0 16 16"},[t("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})],-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"—",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),t("div",mu,[ee(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":v[0]||(v[0]=w=>i.value=w),class:"form-control",placeholder:c.value,disabled:l.value||!r.value,rows:"1",onInput:p,onKeydown:Xt(_e(d,["exact","prevent"]),["enter"])},null,40,pu),[[ce,i.value]]),a.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:h}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!i.value.trim()||!r.value||l.value,onClick:d}," Send ",8,fu))])]))}},hu=K(vu,[["__scopeId","data-v-d2ca2648"]]),_u={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},gu={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},bu={class:"text-secondary"},yu={class:"d-flex flex-column flex-grow-1 overflow-hidden"},ro={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=te(),o=de(),i=_(()=>s.currentSession),a=_(()=>o.isLoading),r=_(()=>o.loadingMessage);return ue(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),re(()=>e.sessionId,async(l,c)=>{if(l!==c&&l!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(l)}finally{o.hideLoading()}}}),he(()=>{}),(l,c)=>(u(),m("div",_u,[a.value?(u(),m("div",gu,[c[0]||(c[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",bu,$(r.value),1)])):P("",!0),i.value?(u(),we(Mi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):P("",!0),t("div",yu,[ne(cu)]),ne(hu),i.value?(u(),we(Ii,{key:2,"session-id":e.sessionId},null,8,["session-id"])):P("",!0),i.value?(u(),we(Bi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):P("",!0)]))}},ot=bt("legion",()=>{const n=L(new Map),e=L(new Map),s=L(new Map),o=L(new Map),i=L(new Map),a=L(new Map),r=L(null),l=_(()=>n.value.get(r.value)||[]),c=_(()=>e.value.get(r.value)||[]),p=_(()=>s.value.get(r.value)||[]),d=_(()=>o.value.get(r.value)||[]);function h(k){r.value=k}async function b(k,R=100,N=0){try{const A=await Z.get(`/api/legions/${k}/timeline?limit=${R}&offset=${N}`),S=A.comms||[],O=A.total_count||S.length,x=A.has_more||!1;return S.sort((j,F)=>new Date(j.timestamp)-new Date(F.timestamp)),console.log(`Loaded ${S.length} of ${O} comms for legion ${k}`),n.value.set(k,S),n.value=new Map(n.value),{comms:S,totalCount:O,hasMore:x}}catch(A){throw console.error("Failed to load timeline:",A),A}}function v(k,R){n.value.has(k)||n.value.set(k,[]),n.value.get(k).push(R),n.value=new Map(n.value)}async function w(k,R){try{const A=(await Z.post(`/api/legions/${k}/comms`,R)).comm;return console.log(`Sent comm ${A.comm_id} to legion ${k}`),A}catch(N){throw console.error("Failed to send comm:",N),N}}async function y(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function g(k,R){try{const A=(await Z.post(`/api/legions/${k}/minions`,R)).minion;return await y(k),console.log(`Created minion ${A.minion_id} in legion ${k}`),A}catch(N){throw console.error("Failed to create minion:",N),N}}async function f(k){try{const N=(await Z.get(`/api/legions/${k}/hordes`)).hordes||[];return console.log(`Loaded ${N.length} hordes for legion ${k}`),s.value.set(k,N),s.value=new Map(s.value),N}catch(R){throw console.error("Failed to load hordes:",R),R}}async function M(k){try{const N=(await Z.get(`/api/legions/${k}/channels`)).channels||[];return console.log(`Loaded ${N.length} channels for legion ${k}`),o.value.set(k,N),o.value=new Map(o.value),N}catch(R){throw console.error("Failed to load channels:",R),R}}async function C(k){try{const R=await Z.get(`/api/channels/${k}`),N=R.channel||R;return console.log(`Loaded details for channel ${k}`),i.value.set(k,N),i.value=new Map(i.value),N}catch(R){throw console.error("Failed to load channel details:",R),R}}async function T(k,R=1e3){try{const A=(await Z.get(`/api/channels/${k}/comms?limit=${R}`)).comms||[];return console.log(`Loaded ${A.length} comms for channel ${k}`),A.sort((S,O)=>new Date(S.timestamp)-new Date(O.timestamp)),a.value.set(k,A),a.value=new Map(a.value),A}catch(N){throw console.error("Failed to load channel comms:",N),N}}async function D(k,R){try{await Z.post(`/api/channels/${k}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:R}),console.log(`Added minion ${R} to channel ${k}`),await C(k)}catch(N){throw console.error("Failed to add member to channel:",N),N}}async function I(k,R){try{await Z.post(`/api/channels/${k}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:R}),console.log(`Removed minion ${R} from channel ${k}`),await C(k)}catch(N){throw console.error("Failed to remove member from channel:",N),N}}function E(k){n.value.delete(k),e.value.delete(k),s.value.delete(k),o.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value),s.value=new Map(s.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:s,channelsByLegion:o,channelDetailsByChannel:i,channelCommsByChannel:a,currentLegionId:r,currentComms:l,currentMinions:c,currentHordes:p,currentChannels:d,setCurrentLegion:h,loadTimeline:b,addComm:v,sendComm:w,loadMinions:y,createMinion:g,loadHordes:f,loadChannels:M,loadChannelDetails:C,loadChannelComms:T,addMemberToChannel:D,removeMemberFromChannel:I,clearLegionData:E}}),$u=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:ot},Symbol.toStringTag,{value:"Module"})),wu={class:"timeline-header border-bottom p-3"},Eu={class:"project-name"},Cu=["title"],Su={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=fe(),o=_(()=>s.projects.get(e.legionId)),i=_(()=>o.value?.name||"Legion");return(a,r)=>(u(),m("div",wu,[t("div",null,[t("div",Eu,$(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Cu)])]))}},ku=K(Su,[["__scopeId","data-v-44f386f5"]]),Tu={class:"timeline-status-bar border-top p-2 bg-light"},xu={class:"d-flex justify-content-end"},Au={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=de();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),m("div",Tu,[t("div",xu,[t("button",{class:z(["btn btn-sm",Jt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," ⬇️ "+$(Jt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Mu=K(Au,[["__scopeId","data-v-891c73db"]]),Ou={class:"comm-composer border-top p-3"},Nu={class:"d-flex gap-2 mb-2"},Lu={class:"flex-grow-1"},Du=["disabled"],Iu={label:"Minions"},Pu=["value"],ju={key:0,label:"Channels"},Ru=["value"],Vu={style:{"min-width":"150px"}},Hu=["disabled"],Wu={class:"d-flex gap-2 align-items-end position-relative"},Fu={class:"flex-grow-1 position-relative"},Uu=["disabled"],Bu=["onClick","onMouseenter"],qu=["disabled"],zu={key:0},Ku={key:1},Yu={__name:"CommComposer",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ot(),o=te(),i=fe(),a=L(""),r=L("task"),l=L(""),c=L(!1),p=L(!1),d=L([]),h=L(0),b=L(-1),v=L(null),w=L(null),y=_(()=>{const N=i.projects.get(e.legionId);return!N||!N.session_ids?[]:N.session_ids.map(A=>o.sessions.get(A)).filter(A=>A&&A.is_minion)}),g=_(()=>s.currentChannels||[]),f=_(()=>a.value&&l.value.trim().length>0);function M(N){return{created:"○",starting:"◐",active:"●",paused:"⏸",terminating:"◍",terminated:"✗",error:"⚠"}[N.state]||"○"}function C(N){return N.is_minion&&N.role?`${N.name} (${N.role})`:N.name}function T(){const N=v.value;if(!N)return;N.style.height="auto";const A=Math.min(N.scrollHeight,parseInt(getComputedStyle(N).maxHeight));N.style.height=A+"px"}function D(){const N=v.value;if(!N)return;T();const A=l.value,S=N.selectionStart,O=A.substring(0,S),x=O.lastIndexOf("#");if(x===-1){p.value=!1;return}const j=O.substring(x+1).toLowerCase();if(j.includes(" ")){p.value=!1;return}const F=y.value.filter(U=>U.name.toLowerCase().includes(j)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(F.length===0){p.value=!1;return}d.value=F,h.value=0,b.value=x,p.value=!0}function I(){if(!w.value)return;const N=w.value,A=N.children[h.value];if(!A)return;const S=A.offsetTop,O=A.offsetHeight,x=N.scrollTop,j=N.clientHeight;S<x?N.scrollTop=S:S+O>x+j&&(N.scrollTop=S+O-j)}function E(N){if(!p.value){N.key==="Enter"&&!N.shiftKey&&f.value&&(N.preventDefault(),R());return}if(N.key==="ArrowDown")N.preventDefault(),h.value=(h.value+1)%d.value.length,I();else if(N.key==="ArrowUp")N.preventDefault(),h.value=h.value===0?d.value.length-1:h.value-1,I();else if(N.key==="Enter"){N.preventDefault();const A=d.value[h.value];A&&k(A)}else N.key==="Escape"&&(p.value=!1)}function k(N){const A=v.value;if(!A)return;const S=l.value,O=A.selectionStart,x=S.substring(0,b.value)+"#"+N.name+" "+S.substring(O);l.value=x;const j=b.value+N.name.length+2;setTimeout(()=>{A.setSelectionRange(j,j),A.focus()},0),p.value=!1}async function R(){if(!(!f.value||c.value)){c.value=!0;try{const[N,A]=a.value.split(":"),S={comm_type:r.value,content:l.value.trim()};N==="minion"?S.to_minion_id=A:N==="channel"&&(S.to_channel_id=A),await s.sendComm(e.legionId,S),l.value="",T()}catch(N){console.error("Failed to send comm:",N),alert(`Failed to send comm: ${N.message}`)}finally{c.value=!1}}}return re(p,N=>{if(N){const A=S=>{S.target.closest(".comm-composer")||(p.value=!1,document.removeEventListener("click",A))};setTimeout(()=>document.addEventListener("click",A),0)}}),(N,A)=>(u(),m("div",Ou,[t("div",Nu,[t("div",Lu,[ee(t("select",{"onUpdate:modelValue":A[0]||(A[0]=S=>a.value=S),class:"form-select form-select-sm",disabled:c.value},[A[3]||(A[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",Iu,[(u(!0),m(se,null,ie(y.value,S=>(u(),m("option",{key:S.session_id,value:`minion:${S.session_id}`},$(M(S))+" "+$(C(S)),9,Pu))),128))]),g.value.length>0?(u(),m("optgroup",ju,[(u(!0),m(se,null,ie(g.value,S=>(u(),m("option",{key:S.channel_id,value:`channel:${S.channel_id}`}," #️⃣ "+$(S.name),9,Ru))),128))])):P("",!0)],8,Du),[[Me,a.value]])]),t("div",Vu,[ee(t("select",{"onUpdate:modelValue":A[1]||(A[1]=S=>r.value=S),class:"form-select form-select-sm",disabled:c.value},[...A[4]||(A[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,Hu),[[Me,r.value]])])]),t("div",Wu,[t("div",Fu,[ee(t("textarea",{ref_key:"contentTextarea",ref:v,"onUpdate:modelValue":A[2]||(A[2]=S=>l.value=S),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:c.value,onInput:D,onKeydown:E},null,40,Uu),[[ce,l.value]]),p.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:w,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(se,null,ie(d.value,(S,O)=>(u(),m("div",{key:S.id,class:z(["autocomplete-item px-2 py-1",{"bg-light":O===h.value}]),onClick:x=>k(S),onMouseenter:x=>h.value=O},$(S.type==="minion"?M(S):"#️⃣")+" "+$(S.name)+$(S.role?` (${S.role})`:""),43,Bu))),128))],512)):P("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!f.value||c.value,onClick:R},[c.value?(u(),m("span",zu,[...A[5]||(A[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),q(" Sending... ",-1)])])):(u(),m("span",Ku,"Send"))],8,qu)])])]))}},Gu=K(Yu,[["__scopeId","data-v-ffa54193"]]),Ju={class:"timeline-view d-flex flex-column h-100"},Xu={key:0,class:"text-center text-muted"},Qu={key:1,class:"text-center text-danger"},Zu={key:2,class:"text-center text-muted"},em={key:3,class:"comm-list"},tm={class:"col-auto message-speaker text-end pe-3"},sm={class:"text-muted"},nm={class:"col message-content-column"},om={class:"card-body p-2"},im={class:"d-flex justify-content-between align-items-start mb-1"},am={class:"comm-content"},rm="ffffffff-ffff-ffff-ffff-ffffffffffff",lm={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ot(),o=fe(),i=te(),a=He(),r=de(),l=L(!0),c=L(null),p=L(null),d=_(()=>o.projects.get(e.legionId));_(()=>d.value?.name||"Legion");const h=_(()=>s.currentComms);_(()=>s.currentMinions);function b(D){return D.from_minion_id===rm}function v(D){return D.from_user?"You":D.from_minion_id?b(D)?"SYSTEM":i.sessions.get(D.from_minion_id)?.name||"Unknown":"Unknown"}function w(D){return D.to_user?"You":D.to_minion_id?i.sessions.get(D.to_minion_id)?.name||"Unknown":D.to_channel_id?D.to_channel_name?`#${D.to_channel_name}`:D.to_channel_id:"All"}function y(D){return{task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success"}[D]||"bg-secondary"}function g(D){return new Date(D).toLocaleTimeString()}async function f(){r.autoScrollEnabled&&(await Os(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function M(){l.value=!0,c.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Os(),await f(),setTimeout(()=>{f()},100)}catch(D){console.error("Failed to load timeline:",D),D.response?c.value=`${D.message} (${D.response.status})`:c.value=D.message||"Unknown error"}finally{l.value=!1}}function C(){a.connectLegion(e.legionId)}function T(){a.disconnectLegion()}return re(()=>h.value.length,()=>{f()}),ue(()=>{M(),C(),setTimeout(()=>{f()},100)}),he(()=>{T()}),(D,I)=>(u(),m("div",Ju,[ne(ku,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto p-3"},[l.value?(u(),m("div",Xu,[...I[0]||(I[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),q(" Loading timeline... ",-1)])])):c.value?(u(),m("div",Qu," Failed to load timeline: "+$(c.value),1)):h.value.length===0?(u(),m("div",Zu," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",em,[(u(!0),m(se,null,ie(h.value,E=>(u(),m("div",{key:E.comm_id,class:z(["comm-item message-row row py-2 mb-2",{"system-comm":b(E)}])},[t("div",tm,[t("small",sm,$(g(E.timestamp)),1)]),t("div",nm,[t("div",{class:z(["comm-card card",{"system-card":b(E)}])},[t("div",om,[t("div",im,[t("div",null,[t("span",{class:z(["badge",y(E.comm_type)])},$(E.comm_type),3),t("strong",{class:z(["ms-2",{"system-sender":b(E)}])},$(v(E)),3),I[1]||(I[1]=t("span",{class:"text-muted mx-1"},"→",-1)),t("strong",{class:z({"recipient-channel":E.to_channel_id})},$(w(E)),3)])]),t("div",am,$(E.content),1)])],2)])],2))),128))]))],512),ne(Gu,{"legion-id":n.legionId},null,8,["legion-id"]),ne(Mu,{"legion-id":n.legionId},null,8,["legion-id"])]))}},cm=K(lm,[["__scopeId","data-v-6d97bd0b"]]),dm={class:"spy-view d-flex flex-column overflow-hidden"},um={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){const e=n,s=He();return ue(()=>{s.connectLegion(e.legionId)}),Vs(()=>{s.disconnectLegion()}),(o,i)=>(u(),m("div",dm,[ne(ro,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},mm=K(um,[["__scopeId","data-v-21206f91"]]),pm={class:"horde-header border-bottom p-3"},fm={class:"project-name"},vm={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=fe(),o=_(()=>s.projects.get(e.legionId)),i=_(()=>o.value?.name||"Legion");return(a,r)=>(u(),m("div",pm,[t("div",null,[t("div",fm,$(i.value),1),r[0]||(r[0]=t("div",{class:"view-name"},"Minion Hierarchy",-1))])]))}},hm=K(vm,[["__scopeId","data-v-0c86e2b5"]]),_m={class:"horde-status-bar border-top p-2 bg-light"},gm={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,s)=>(u(),m("div",_m,[...s[0]||(s[0]=[t("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},bm=K(gm,[["__scopeId","data-v-f0e64ab0"]]),ym={class:"minion-card border-start border-2 mb-2"},$m={class:"node-row"},wm={class:"node-left"},Em={key:0,class:"me-2"},Cm={key:1,class:"badge bg-secondary ms-2"},Sm={class:"node-right"},km={key:0,class:"last-comm-preview"},Tm={class:"comm-direction"},xm=["title"],Am={key:1,class:"text-muted fst-italic small"},Mm={key:0,class:"minion-children"},Om={key:1,class:"text-danger small ms-4"},Nm={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,s=_(()=>e.level*24),o=_(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=_(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=_(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),r=_(()=>{const d=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[d]||"status-dot-grey"}),l=_(()=>{const d=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[d]||"#d3d3d3"}});function c(d){return d.to_user?"User":d.to_minion_name?d.to_minion_name:d.to_channel_name?`#${d.to_channel_name}`:"unknown"}function p(d){const h=d.summary||d.content||"";return h.length>150?h.substring(0,150)+"...":h}return(d,h)=>{const b=io("MinionTreeNode",!0);return n.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:Re({marginLeft:`${s.value}px`})},[t("div",ym,[t("div",$m,[t("div",wm,[t("div",{class:z(["status-dot me-2",r.value]),style:Re(l.value)},null,6),i.value?(u(),m("span",Em,"👑")):P("",!0),t("strong",null,$(n.minionData.name),1),i.value?(u(),m("span",Cm,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):P("",!0)]),t("div",Sm,[n.minionData.last_comm?(u(),m("div",km,[t("span",Tm,[h[0]||(h[0]=q(" → ",-1)),t("strong",null,$(c(n.minionData.last_comm)),1),h[1]||(h[1]=q(": ",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},$(p(n.minionData.last_comm)),9,xm)])):(u(),m("div",Am," No communications yet "))])])]),o.value?(u(),m("div",Mm,[(u(!0),m(se,null,ie(n.minionData.children,v=>(u(),we(b,{key:v.id,"minion-data":v,level:n.level+1},null,8,["minion-data","level"]))),128))])):P("",!0)],4)):(u(),m("div",Om," ⚠ Minion data is missing "))}}},Lm=K(Nm,[["__scopeId","data-v-1cd9863f"]]),Dm={class:"horde-view d-flex flex-column h-100"},Im={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},Pm={key:0,class:"text-center py-5"},jm={key:1,class:"alert alert-danger"},Rm={class:"mb-0"},Vm={key:2,class:"horde-tree"},Hm={class:"user-root-node mb-3 border rounded bg-white"},Wm={class:"node-row"},Fm={class:"node-left"},Um={key:0,class:"badge bg-primary ms-2"},Bm={class:"node-right"},qm={key:0,class:"last-comm-preview"},zm={class:"comm-direction"},Km=["title"],Ym={key:1,class:"text-muted fst-italic"},Gm={key:0,class:"alert alert-info ms-4"},Jm={key:1,class:"root-minions ms-4"},Xm={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=fe(),o=te(),i=He(),a=ot(),r=L(null),l=L(!1),c=L(null);_(()=>s.projects.get(e.legionId));const p=_(()=>r.value&&r.value.children&&r.value.children.length>0);async function d(){l.value=!0,c.value=null;try{const y=await Z.get(`/api/legions/${e.legionId}/hordes`);r.value=y,console.log("Loaded hierarchy:",y)}catch(y){console.error("Failed to load hierarchy:",y),c.value=y.message||"Unknown error"}finally{l.value=!1}}ue(()=>{d()}),re(()=>e.legionId,()=>{d()});function h(y){return y.to_user?"User":y.to_minion_name?y.to_minion_name:y.to_channel_name?`#${y.to_channel_name}`:"unknown"}function b(y){const g=y.summary||y.content||"";return g.length>150?g.substring(0,150)+"...":g}function v(y,g){if(y.id===g)return y;if(y.children)for(const f of y.children){const M=v(f,g);if(M)return M}return null}function w(y){if(r.value){if(y.from_minion_id){const g=v(r.value,y.from_minion_id);g&&g.type==="minion"&&(g.last_comm=y,console.log(`Updated minion ${g.name} last_comm`))}y.from_user&&r.value.type==="user"&&(r.value.last_comm=y,console.log("Updated user last_comm"))}}return ue(()=>{d(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),re(()=>o.sessions,y=>{if(r.value){for(const[g,f]of y)if(f.is_minion&&f.project_id===e.legionId){const M=v(r.value,g);M&&M.type==="minion"&&(M.state!==f.state&&(M.state=f.state,console.log(`Updated minion ${M.name} state to ${f.state}`)),M.is_processing!==f.is_processing&&(M.is_processing=f.is_processing,console.log(`Updated minion ${M.name} is_processing to ${f.is_processing}`)))}}},{deep:!0}),re(()=>a.commsByLegion.get(e.legionId),y=>{if(y&&y.length>0){const g=y[y.length-1];w(g)}},{deep:!0}),re(()=>o.sessions.size,(y,g)=>{y>g&&Array.from(o.sessions.values()).some(C=>C.is_minion&&C.project_id===e.legionId&&!v(r.value,C.session_id))&&(console.log("New minion detected, reloading hierarchy"),d())})}),he(()=>{console.log("HordeView unmounted")}),(y,g)=>(u(),m("div",Dm,[ne(hm,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",Im,[l.value?(u(),m("div",Pm,[...g[0]||(g[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):c.value?(u(),m("div",jm,[g[1]||(g[1]=t("strong",null,"Failed to load hierarchy",-1)),t("p",Rm,$(c.value),1)])):r.value?(u(),m("div",Vm,[t("div",Hm,[t("div",Wm,[t("div",Fm,[g[2]||(g[2]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"👤",-1)),t("strong",null,$(r.value.name),1),p.value?(u(),m("span",Um,$(r.value.children.length)+" "+$(r.value.children.length===1?"minion":"minions"),1)):P("",!0)]),t("div",Bm,[r.value.last_comm?(u(),m("div",qm,[t("span",zm,[g[3]||(g[3]=q(" → ",-1)),t("strong",null,$(h(r.value.last_comm)),1),g[4]||(g[4]=q(": ",-1))]),t("span",{class:"comm-content",title:r.value.last_comm.content||""},$(b(r.value.last_comm)),9,Km)])):(u(),m("div",Ym," No communications yet "))])])]),p.value?(u(),m("div",Jm,[(u(!0),m(se,null,ie(r.value.children,f=>(u(),we(Lm,{key:f.id,"minion-data":f,level:1},null,8,["minion-data"]))),128))])):(u(),m("div",Gm,[...g[5]||(g[5]=[t("p",{class:"mb-2"},"No minions yet",-1),t("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):P("",!0)]),ne(bm,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Qm=K(Xm,[["__scopeId","data-v-af6338a3"]]),Zm={class:"channel-status-bar d-flex gap-2"},ep={class:"button-label"},tp={__name:"ChannelStatusBar",props:{channel:{type:Object,required:!0},members:{type:Array,default:()=>[]},legionId:{type:String,required:!0}},setup(n){const e=n,s=de(),o=_(()=>e.members?.length||0);function i(){s.showModal("channel-info",{channel:e.channel})}function a(){s.showModal("channel-members",{channel:e.channel,members:e.members,legionId:e.legionId,channelId:e.channel.channel_id})}return(r,l)=>(u(),m("div",Zm,[t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:i,title:"View channel information"},[...l[0]||(l[0]=[t("span",{class:"button-icon"},"📋",-1),t("span",{class:"button-label"},"Info",-1)])]),t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:a,title:"View channel members"},[l[1]||(l[1]=t("span",{class:"button-icon"},"👥",-1)),t("span",ep,"Members ("+$(o.value)+")",1)])]))}},sp=K(tp,[["__scopeId","data-v-f497955c"]]),np={class:"modal-dialog modal-dialog-centered"},op={class:"modal-content"},ip={class:"modal-body"},ap={key:0},rp={class:"info-section"},lp={class:"info-value"},cp={class:"info-section"},dp={class:"info-value"},up={key:0,class:"info-section"},mp={class:"info-value"},pp={class:"info-section"},fp={class:"info-value"},vp={class:"info-section"},hp={class:"info-value"},_p={class:"info-section"},gp={class:"info-value"},bp={style:{"font-size":"0.85rem"}},yp={key:1,class:"text-muted text-center py-3"},$p={__name:"ChannelInfoModal",setup(n){const e=de(),s=L(null);let o=null;const i=L(null);re(()=>e.currentModal,r=>{r?.name==="channel-info"&&o&&(i.value=r.data?.channel||null,o.show())});function a(r){if(!r)return"Unknown";try{return new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return r}}return ue(()=>{if(s.value){const r=window.bootstrap;r&&r.Modal&&(o=new r.Modal(s.value),s.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),i.value=null}))}}),Vs(()=>{o&&o.dispose()}),(r,l)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",id:"channelInfoModal",tabindex:"-1","aria-labelledby":"channelInfoModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",np,[t("div",op,[l[6]||(l[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelInfoModalLabel"},"Channel Information"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ip,[i.value?(u(),m("div",ap,[t("div",rp,[l[0]||(l[0]=t("label",null,"Channel Name",-1)),t("div",lp,$(i.value.name),1)]),t("div",cp,[l[1]||(l[1]=t("label",null,"Purpose",-1)),t("div",dp,$(i.value.purpose||"No purpose specified"),1)]),i.value.description&&i.value.description!==i.value.purpose?(u(),m("div",up,[l[2]||(l[2]=t("label",null,"Description",-1)),t("div",mp,$(i.value.description),1)])):P("",!0),t("div",pp,[l[3]||(l[3]=t("label",null,"Created",-1)),t("div",fp,$(a(i.value.created_at)),1)]),t("div",vp,[l[4]||(l[4]=t("label",null,"Members",-1)),t("div",hp,$(i.value.member_minion_ids?.length||0)+" member(s)",1)]),t("div",_p,[l[5]||(l[5]=t("label",null,"Channel ID",-1)),t("div",gp,[t("code",bp,$(i.value.channel_id),1)])])])):(u(),m("div",yp," No channel data available "))]),l[7]||(l[7]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},wp=K($p,[["__scopeId","data-v-3d7eceff"]]),Ep={class:"modal-dialog modal-dialog-centered"},Cp={class:"modal-content"},Sp={class:"modal-body"},kp={class:"mb-3"},Tp=["disabled"],xp={key:0,class:"text-muted ms-2"},Ap={key:1,class:"mt-2"},Mp=["disabled"],Op=["value"],Np={key:0,class:"text-muted small mt-1"},Lp={key:0,class:"member-count"},Dp={key:1,class:"member-list"},Ip={class:"member-info"},Pp={class:"member-name"},jp={key:0,class:"member-role"},Rp={class:"member-state"},Vp={class:"status-text"},Hp=["onClick","disabled"],Wp={key:2,class:"empty-state text-center py-4"},Fp={__name:"ChannelMembersModal",setup(n){const e=de(),s=ot(),o=te(),i=fe(),a=L(null);let r=null;const l=L(null),c=L([]),p=L(null),d=L(null),h=L(""),b=L(!1),v=L(!1),w=L(!1),y=_(()=>{if(!p.value)return[];const D=i.projects.get(p.value);if(!D||!D.session_ids)return[];const I=D.session_ids.map(k=>o.sessions.get(k)).filter(Boolean),E=new Set(c.value.map(k=>k.session_id));return I.filter(k=>!E.has(k.session_id))});re(()=>e.currentModal,D=>{D?.name==="channel-members"&&r&&(l.value=D.data?.channel||null,c.value=D.data?.members||[],p.value=D.data?.legionId||null,d.value=D.data?.channelId||null,b.value=!1,h.value="",r.show())});function g(D){return D==="processing"||D==="starting"?"status-blinking":""}function f(D){return{backgroundColor:{created:"#6c757d",starting:"#28a745",active:"#28a745",processing:"#da70d6",paused:"#ffc107",error:"#dc3545",terminated:"#6c757d"}[D]||"#6c757d"}}function M(D){return D?D.charAt(0).toUpperCase()+D.slice(1).replace(/_/g," "):"Unknown"}async function C(){if(!(!h.value||!d.value)){v.value=!0;try{await s.addMemberToChannel(d.value,h.value);const D=await s.loadChannelDetails(d.value);D?.member_minion_ids&&(c.value=D.member_minion_ids.map(I=>o.sessions.get(I)).filter(Boolean)),h.value="",b.value=!1}catch(D){console.error("Failed to add member:",D),alert(`Failed to add member: ${D.message}`)}finally{v.value=!1}}}async function T(D){if(!D||!d.value)return;const I=c.value.find(E=>E.session_id===D);if(confirm(`Remove ${I?.name||"this member"} from the channel?`)){w.value=!0;try{await s.removeMemberFromChannel(d.value,D);const E=await s.loadChannelDetails(d.value);E?.member_minion_ids&&(c.value=E.member_minion_ids.map(k=>o.sessions.get(k)).filter(Boolean))}catch(E){console.error("Failed to remove member:",E),alert(`Failed to remove member: ${E.message}`)}finally{w.value=!1}}}return ue(()=>{if(a.value){const D=window.bootstrap;D&&D.Modal&&(r=new D.Modal(a.value),a.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),l.value=null,c.value=[]}))}}),Vs(()=>{r&&r.dispose()}),(D,I)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",id:"channelMembersModal",tabindex:"-1","aria-labelledby":"channelMembersModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",Ep,[t("div",Cp,[I[5]||(I[5]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelMembersModalLabel"},"Channel Members"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Sp,[t("div",kp,[t("button",{class:"btn btn-sm btn-primary",onClick:I[0]||(I[0]=E=>b.value=!b.value),disabled:v.value||y.value.length===0}," ➕ Add Member ",8,Tp),y.value.length===0?(u(),m("small",xp," (All minions are already members) ")):P("",!0),b.value&&y.value.length>0?(u(),m("div",Ap,[ee(t("select",{"onUpdate:modelValue":I[1]||(I[1]=E=>h.value=E),class:"form-select form-select-sm",onChange:C,disabled:v.value},[I[2]||(I[2]=t("option",{value:""},"-- Select minion to add --",-1)),(u(!0),m(se,null,ie(y.value,E=>(u(),m("option",{key:E.session_id,value:E.session_id},$(E.name)+" "+$(E.role?`(${E.role})`:"(No role)"),9,Op))),128))],40,Mp),[[Me,h.value]]),v.value?(u(),m("div",Np,[...I[3]||(I[3]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),q(" Adding member... ",-1)])])):P("",!0)])):P("",!0)]),c.value&&c.value.length>0?(u(),m("p",Lp,$(c.value.length)+" "+$(c.value.length===1?"member":"members"),1)):P("",!0),c.value&&c.value.length>0?(u(),m("div",Dp,[(u(!0),m(se,null,ie(c.value,E=>(u(),m("div",{key:E.session_id,class:"member-item"},[t("div",Ip,[t("div",Pp,$(E.name),1),E.role?(u(),m("div",jp,$(E.role),1)):P("",!0),t("div",Rp,[t("span",{class:z(["status-dot",g(E.state)]),style:Re(f(E.state))},null,6),t("span",Vp,$(M(E.state)),1)])]),t("button",{class:"btn btn-sm btn-outline-danger",onClick:k=>T(E.session_id),disabled:w.value,title:"Remove from channel"}," 🗑️ ",8,Hp)]))),128))])):(u(),m("div",Wp,[...I[4]||(I[4]=[t("p",{class:"text-muted mb-0"},"No members in this channel yet.",-1)])]))]),I[6]||(I[6]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},Up=K(Fp,[["__scopeId","data-v-28fb4eaa"]]),Bp={class:"channel-view d-flex flex-column h-100"},qp={class:"channel-header border-bottom p-3"},zp={class:"d-flex align-items-center justify-content-between"},Kp={class:"mb-0"},Yp={class:"text-muted"},Gp={class:"badge bg-secondary"},Jp={class:"channel-content flex-grow-1 overflow-auto"},Xp={key:0,class:"text-center text-muted py-4"},Qp={key:1,class:"text-center text-danger py-4"},Zp={key:2,class:"text-center text-muted py-4"},ef={key:3,class:"p-3 pb-5"},tf={class:"comms-section"},sf={class:"text-muted border-bottom pb-2"},nf={key:0,class:"text-center text-muted py-4"},of={key:1,class:"text-center text-muted py-3"},af={key:2,class:"comm-list"},rf={class:"card-body p-2"},lf={class:"d-flex justify-content-between align-items-start mb-1"},cf={class:"ms-2"},df={class:"text-muted ms-2"},uf={key:0,class:"text-muted small mb-1"},mf={class:"comm-content"},pf={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,s=ot(),o=fe(),i=te(),a=L(!0),r=L(null),l=L(!1),c=_(()=>o.projects.get(e.legionId)),p=_(()=>s.channelDetailsByChannel.get(e.channelId)),d=_(()=>s.channelCommsByChannel.get(e.channelId)||[]),h=_(()=>p.value?.member_minion_ids?.length||0),b=_(()=>d.value.length),v=_(()=>p.value?.member_minion_ids?p.value.member_minion_ids.map(f=>i.sessions.get(f)).filter(Boolean):[]);function w(f){return f.from_user?"You":f.from_minion_name?f.from_minion_name:f.from_minion_id&&i.sessions.get(f.from_minion_id)?.name||"Unknown"}function y(f){return{task:"bg-primary",question:"bg-info",report:"bg-success",info:"bg-secondary",halt:"bg-danger",pivot:"bg-warning"}[f?.toLowerCase()]||"bg-secondary"}function g(f){return f?new Date(f).toLocaleString():"N/A"}return ue(async()=>{a.value=!0;try{await s.loadChannelDetails(e.channelId),l.value=!0,await s.loadChannelComms(e.channelId,1e3),l.value=!1}catch(f){console.error("Failed to load channel:",f),r.value=f.message||"Unknown error"}finally{a.value=!1}}),re(()=>e.channelId,async f=>{if(f){a.value=!0,r.value=null;try{await s.loadChannelDetails(f),l.value=!0,await s.loadChannelComms(f,1e3),l.value=!1}catch(M){console.error("Failed to load channel:",M),r.value=M.message||"Unknown error"}finally{a.value=!1}}}),(f,M)=>(u(),m("div",Bp,[t("div",qp,[t("div",zp,[t("div",null,[t("h5",Kp," 💬 "+$(p.value?.name||"Channel"),1),t("small",Yp,$(c.value?.name||"Legion"),1)]),t("span",Gp,$(h.value)+" members",1)])]),t("div",Jp,[a.value?(u(),m("div",Xp,[...M[0]||(M[0]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading channel...",-1)])])):r.value?(u(),m("div",Qp," Failed to load channel: "+$(r.value),1)):p.value?(u(),m("div",ef,[t("div",tf,[t("h6",sf,"Communications ("+$(b.value)+")",1),l.value?(u(),m("div",nf,[...M[1]||(M[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading comms...",-1)])])):d.value.length===0?(u(),m("div",of," No communications in this channel yet ")):(u(),m("div",af,[(u(!0),m(se,null,ie(d.value,C=>(u(),m("div",{key:C.comm_id,class:"comm-item card mb-2"},[t("div",rf,[t("div",lf,[t("div",null,[t("span",{class:z(["badge",y(C.comm_type)])},$(C.comm_type),3),t("strong",cf,$(w(C)),1),t("small",df,$(g(C.timestamp)),1)])]),C.summary?(u(),m("div",uf,[M[2]||(M[2]=t("strong",null,"Summary:",-1)),q(" "+$(C.summary),1)])):P("",!0),t("div",mf,$(C.content),1)])]))),128))]))])])):(u(),m("div",Zp," Channel not found "))]),p.value?(u(),we(sp,{key:0,channel:p.value,members:v.value,"legion-id":n.legionId},null,8,["channel","members","legion-id"])):P("",!0),ne(wp),ne(Up)]))}},ff=K(pf,[["__scopeId","data-v-daa6aa75"]]),vf=[{path:"/",name:"home",component:bi},{path:"/session/:sessionId",name:"session",component:ro,props:!0},{path:"/timeline/:legionId",name:"timeline",component:cm,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:mm,props:!0},{path:"/horde/:legionId",name:"horde",component:Qm,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:ff,props:!0}],hf=pi({history:fi(),routes:vf}),_f={class:"connection-indicators"},gf=["title"],bf=["title"],yf=["title"],$f={__name:"ConnectionIndicator",setup(n){const e=He();function s(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:r,retryCount:l}=a[i];return l>0&&!r?"indicator-connecting":r?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},r={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},l={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:c,retryCount:p}=l[i];let d="Disconnected";return c?d="Connected":p>0&&(d=`Reconnecting (attempt ${p})`),`${a[i]}
${r[i]}
Status: ${d}`}return(i,a)=>(u(),m("div",_f,[t("div",{class:z(["indicator",s("ui")]),title:o("ui")}," 🌐 ",10,gf),t("div",{class:z(["indicator",s("session")]),title:o("session")}," 💬 ",10,bf),t("div",{class:z(["indicator",s("legion")]),title:o("legion")}," 👥 ",10,yf)]))}},wf=K($f,[["__scopeId","data-v-d35b07c8"]]),Ef={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Cf={class:"d-flex align-items-center gap-2"},Sf={__name:"AppHeader",setup(n){const e=de();function s(){e.toggleSidebar()}return(o,i)=>(u(),m("header",Ef,[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...i[0]||(i[0]=[t("span",null,"☰",-1)])]),i[1]||(i[1]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",Cf,[ne(wf)])]))}},kf={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Tf={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},xf=["title"],Af={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=_(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(l){return l.state==="paused"&&l.is_processing?"pending-prompt":l.is_processing?"processing":l.state}function i(l){const c=o(l);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}function a(l){const c=o(l);return c==="starting"||c==="processing"||c==="pending-prompt"}function r(l){const c=o(l),p=c.charAt(0).toUpperCase()+c.slice(1),d=l.name||"Unnamed Session",h=l.is_minion&&l.role?` (${l.role})`:"";return`${d}${h}: ${p}`}return(l,c)=>(u(),m("div",kf,[!n.sessions||n.sessions.length===0?(u(),m("div",Tf)):(u(!0),m(se,{key:1},ie(n.sessions,p=>(u(),m("div",{key:p.session_id,class:z(["progress-bar",{"progress-bar-striped progress-bar-animated":a(p)}]),style:Re({width:s.value,backgroundColor:i(p),cursor:"help"}),title:r(p)},null,14,xf))),128))]))}},Mf=K(Af,[["__scopeId","data-v-a79cfeec"]]),Of={class:"flex-grow-1"},Nf={key:0,class:"text-muted small ms-1"},Lf={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,s=Ye(),o=te(),i=fe(),a=de(),r=_(()=>o.currentSessionId===e.session.session_id),l=_(()=>o.deletingSessions.has(e.session.session_id)),c=_(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),p=_(()=>{const f=c.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[f]||"status-dot-grey"}),d=_(()=>{const f=c.value,M={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},C={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:M[f]||"#d3d3d3",borderColor:C[f]||"#6c757d"}});function h(){o.selectSession(e.session.session_id),s.push(`/session/${e.session.session_id}`)}function b(){a.showModal("edit-session",{session:e.session})}function v(f){f.dataTransfer.effectAllowed="move",f.dataTransfer.setData("application/session-id",e.session.session_id),f.dataTransfer.setData("application/project-id",e.projectId),f.dataTransfer.setData("text/plain",e.session.session_id),f.target.classList.add("dragging")}function w(f){f.target.classList.remove("dragging")}function y(f){f.preventDefault(),f.dataTransfer.dropEffect="move";const M=f.currentTarget.getBoundingClientRect(),C=M.top+M.height/2;f.clientY<C?(f.currentTarget.classList.add("drop-above"),f.currentTarget.classList.remove("drop-below")):(f.currentTarget.classList.add("drop-below"),f.currentTarget.classList.remove("drop-above"))}function g(f){f.preventDefault(),f.currentTarget.classList.remove("drop-above","drop-below");const M=f.dataTransfer.getData("application/session-id")||f.dataTransfer.getData("text/plain"),C=f.dataTransfer.getData("application/project-id");if(!M||M===e.session.session_id||C!==e.projectId)return;const T=f.currentTarget.getBoundingClientRect(),D=T.top+T.height/2,I=f.clientY<D,E=i.getProject(e.projectId);if(!E||!E.session_ids)return;const k=[...E.session_ids],R=k.indexOf(e.session.session_id),N=k.indexOf(M);if(R===-1||N===-1)return;const A=[...k],[S]=A.splice(N,1);let O=I?R:R+1;N<R&&O--,A.splice(O,0,S),i.reorderSessionsInProject(e.projectId,A)}return(f,M)=>(u(),m("div",{class:z(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:r.value,"session-deleting":l.value}]),style:{cursor:"pointer"},draggable:"true",onClick:h,onDragstart:v,onDragend:w,onDragover:y,onDrop:g},[t("div",{class:z(["status-dot me-2",p.value]),style:Re(d.value)},null,6),t("div",Of,[t("span",null,$(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(u(),m("span",Nf,"("+$(n.session.role)+")",1)):P("",!0)]),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:_e(b,["stop"])}," ✏️ ")],34))}},Df=K(Lf,[["__scopeId","data-v-07ecbf94"]]),If={class:"d-flex align-items-center gap-2"},Pf=["value"],jf={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ye(),o=te(),i=de(),a=L("");re(()=>s.currentRoute.value,y=>{!a.value&&y.name==="spy"&&y.params.minionId&&y.params.legionId===e.project.project_id&&(a.value=y.params.minionId)},{immediate:!0});const r=_(()=>a.value?e.sessions.find(y=>y.session_id===a.value):null),l=_(()=>{const y=s.currentRoute.value;return y.name==="spy"&&y.params.legionId===e.project.project_id}),c=_(()=>{if(!r.value)return"";if(r.value.state==="paused"&&r.value.is_processing)return"status-blinking";const y=r.value.is_processing?"processing":r.value.state;return y==="starting"||y==="processing"?"status-blinking":""}),p=_(()=>{if(!r.value)return{};if(r.value.state==="paused"&&r.value.is_processing)return{backgroundColor:"#ffc107"};const y=r.value.is_processing?"processing":r.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[y]||"#d3d3d3"}});function d(y){return{created:"○",starting:"◐",active:"●",paused:"⏸",terminating:"◍",terminated:"✗",error:"⚠"}[y.state]||"○"}function h(y){return y.is_minion&&y.role?`${y.name} (${y.role})`:y.name}function b(){a.value&&s.push(`/spy/${e.project.project_id}/${a.value}`)}function v(){a.value?s.push(`/spy/${e.project.project_id}/${a.value}`):s.push("/")}function w(){r.value&&i.showModal("minion-view",{session:r.value})}return re(()=>o.currentSessionId,y=>{if(y)e.sessions.some(g=>g.session_id===y)&&(a.value=y);else{a.value="";const g=s.currentRoute.value;g.name==="spy"&&g.params.legionId===e.project.project_id&&s.push("/")}}),(y,g)=>(u(),m("div",{class:z(["list-group-item list-group-item-action p-2",{active:l.value}])},[t("div",{class:"d-flex align-items-center justify-content-between mb-2",style:Re({cursor:a.value?"pointer":"default"}),onClick:b},[g[1]||(g[1]=t("div",{class:"d-flex align-items-center"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"🔍"),t("span",{class:"fw-semibold"},"Spy"),t("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),t("div",If,[r.value?(u(),m("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:_e(w,["stop"]),title:"View minion details"}," 👁️ ")):P("",!0),r.value?(u(),m("span",{key:1,class:z(["minion-state-indicator",c.value]),style:Re(p.value)}," 👤 ",6)):P("",!0)])],4),ee(t("select",{"onUpdate:modelValue":g[0]||(g[0]=f=>a.value=f),class:"form-select form-select-sm",onChange:v},[g[2]||(g[2]=t("option",{value:""},"-- Select Minion --",-1)),(u(!0),m(se,null,ie(n.sessions,f=>(u(),m("option",{key:f.session_id,value:f.session_id},$(d(f))+" "+$(h(f)),9,Pf))),128))],544),[[Me,a.value]])],2))}},Rf=K(jf,[["__scopeId","data-v-579589fb"]]);var be="top",Ee="bottom",Ce="right",ye="left",ns="auto",yt=[be,Ee,Ce,ye],st="start",pt="end",lo="clippingParents",Ws="viewport",ct="popper",co="reference",Ns=yt.reduce(function(n,e){return n.concat([e+"-"+st,e+"-"+pt])},[]),Fs=[].concat(yt,[ns]).reduce(function(n,e){return n.concat([e,e+"-"+st,e+"-"+pt])},[]),uo="beforeRead",mo="read",po="afterRead",fo="beforeMain",vo="main",ho="afterMain",_o="beforeWrite",go="write",bo="afterWrite",yo=[uo,mo,po,fo,vo,ho,_o,go,bo];function Ie(n){return n?(n.nodeName||"").toLowerCase():null}function Se(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nt(n){var e=Se(n).Element;return n instanceof e||n instanceof Element}function ke(n){var e=Se(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Us(n){if(typeof ShadowRoot>"u")return!1;var e=Se(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Vf(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},a=e.elements[s];!ke(a)||!Ie(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var l=i[r];l===!1?a.removeAttribute(r):a.setAttribute(r,l===!0?"":l)}))})}function Hf(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),l=r.reduce(function(c,p){return c[p]="",c},{});!ke(i)||!Ie(i)||(Object.assign(i.style,l),Object.keys(a).forEach(function(c){i.removeAttribute(c)}))})}}const Bs={name:"applyStyles",enabled:!0,phase:"write",fn:Vf,effect:Hf,requires:["computeStyles"]};function Ne(n){return n.split("-")[0]}var tt=Math.max,Qt=Math.min,ft=Math.round;function Ls(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function $o(){return!/^((?!chrome|android).)*safari/i.test(Ls())}function vt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&ke(n)&&(i=n.offsetWidth>0&&ft(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&ft(o.height)/n.offsetHeight||1);var r=nt(n)?Se(n):window,l=r.visualViewport,c=!$o()&&s,p=(o.left+(c&&l?l.offsetLeft:0))/i,d=(o.top+(c&&l?l.offsetTop:0))/a,h=o.width/i,b=o.height/a;return{width:h,height:b,top:d,right:p+h,bottom:d+b,left:p,x:p,y:d}}function qs(n){var e=vt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function wo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Us(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ve(n){return Se(n).getComputedStyle(n)}function Wf(n){return["table","td","th"].indexOf(Ie(n))>=0}function Ge(n){return((nt(n)?n.ownerDocument:n.document)||window.document).documentElement}function os(n){return Ie(n)==="html"?n:n.assignedSlot||n.parentNode||(Us(n)?n.host:null)||Ge(n)}function wn(n){return!ke(n)||Ve(n).position==="fixed"?null:n.offsetParent}function Ff(n){var e=/firefox/i.test(Ls()),s=/Trident/i.test(Ls());if(s&&ke(n)){var o=Ve(n);if(o.position==="fixed")return null}var i=os(n);for(Us(i)&&(i=i.host);ke(i)&&["html","body"].indexOf(Ie(i))<0;){var a=Ve(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Lt(n){for(var e=Se(n),s=wn(n);s&&Wf(s)&&Ve(s).position==="static";)s=wn(s);return s&&(Ie(s)==="html"||Ie(s)==="body"&&Ve(s).position==="static")?e:s||Ff(n)||e}function zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Tt(n,e,s){return tt(n,Qt(e,s))}function Uf(n,e,s){var o=Tt(n,e,s);return o>s?s:o}function Eo(){return{top:0,right:0,bottom:0,left:0}}function Co(n){return Object.assign({},Eo(),n)}function So(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var Bf=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Co(typeof e!="number"?e:So(e,yt))};function qf(n){var e,s=n.state,o=n.name,i=n.options,a=s.elements.arrow,r=s.modifiersData.popperOffsets,l=Ne(s.placement),c=zs(l),p=[ye,Ce].indexOf(l)>=0,d=p?"height":"width";if(!(!a||!r)){var h=Bf(i.padding,s),b=qs(a),v=c==="y"?be:ye,w=c==="y"?Ee:Ce,y=s.rects.reference[d]+s.rects.reference[c]-r[c]-s.rects.popper[d],g=r[c]-s.rects.reference[c],f=Lt(a),M=f?c==="y"?f.clientHeight||0:f.clientWidth||0:0,C=y/2-g/2,T=h[v],D=M-b[d]-h[w],I=M/2-b[d]/2+C,E=Tt(T,I,D),k=c;s.modifiersData[o]=(e={},e[k]=E,e.centerOffset=E-I,e)}}function zf(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||wo(e.elements.popper,i)&&(e.elements.arrow=i))}const ko={name:"arrow",enabled:!0,phase:"main",fn:qf,effect:zf,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ht(n){return n.split("-")[1]}var Kf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Yf(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:ft(s*i)/i||0,y:ft(o*i)/i||0}}function En(n){var e,s=n.popper,o=n.popperRect,i=n.placement,a=n.variation,r=n.offsets,l=n.position,c=n.gpuAcceleration,p=n.adaptive,d=n.roundOffsets,h=n.isFixed,b=r.x,v=b===void 0?0:b,w=r.y,y=w===void 0?0:w,g=typeof d=="function"?d({x:v,y}):{x:v,y};v=g.x,y=g.y;var f=r.hasOwnProperty("x"),M=r.hasOwnProperty("y"),C=ye,T=be,D=window;if(p){var I=Lt(s),E="clientHeight",k="clientWidth";if(I===Se(s)&&(I=Ge(s),Ve(I).position!=="static"&&l==="absolute"&&(E="scrollHeight",k="scrollWidth")),I=I,i===be||(i===ye||i===Ce)&&a===pt){T=Ee;var R=h&&I===D&&D.visualViewport?D.visualViewport.height:I[E];y-=R-o.height,y*=c?1:-1}if(i===ye||(i===be||i===Ee)&&a===pt){C=Ce;var N=h&&I===D&&D.visualViewport?D.visualViewport.width:I[k];v-=N-o.width,v*=c?1:-1}}var A=Object.assign({position:l},p&&Kf),S=d===!0?Yf({x:v,y},Se(s)):{x:v,y};if(v=S.x,y=S.y,c){var O;return Object.assign({},A,(O={},O[T]=M?"0":"",O[C]=f?"0":"",O.transform=(D.devicePixelRatio||1)<=1?"translate("+v+"px, "+y+"px)":"translate3d("+v+"px, "+y+"px, 0)",O))}return Object.assign({},A,(e={},e[T]=M?y+"px":"",e[C]=f?v+"px":"",e.transform="",e))}function Gf(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,a=s.adaptive,r=a===void 0?!0:a,l=s.roundOffsets,c=l===void 0?!0:l,p={placement:Ne(e.placement),variation:ht(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,En(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,En(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ks={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Gf,data:{}};var Ht={passive:!0};function Jf(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,l=r===void 0?!0:r,c=Se(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&p.forEach(function(d){d.addEventListener("scroll",s.update,Ht)}),l&&c.addEventListener("resize",s.update,Ht),function(){a&&p.forEach(function(d){d.removeEventListener("scroll",s.update,Ht)}),l&&c.removeEventListener("resize",s.update,Ht)}}const Ys={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Jf,data:{}};var Xf={left:"right",right:"left",bottom:"top",top:"bottom"};function Kt(n){return n.replace(/left|right|bottom|top/g,function(e){return Xf[e]})}var Qf={start:"end",end:"start"};function Cn(n){return n.replace(/start|end/g,function(e){return Qf[e]})}function Gs(n){var e=Se(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function Js(n){return vt(Ge(n)).left+Gs(n).scrollLeft}function Zf(n,e){var s=Se(n),o=Ge(n),i=s.visualViewport,a=o.clientWidth,r=o.clientHeight,l=0,c=0;if(i){a=i.width,r=i.height;var p=$o();(p||!p&&e==="fixed")&&(l=i.offsetLeft,c=i.offsetTop)}return{width:a,height:r,x:l+Js(n),y:c}}function ev(n){var e,s=Ge(n),o=Gs(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=tt(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=tt(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-o.scrollLeft+Js(n),c=-o.scrollTop;return Ve(i||s).direction==="rtl"&&(l+=tt(s.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:l,y:c}}function Xs(n){var e=Ve(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function To(n){return["html","body","#document"].indexOf(Ie(n))>=0?n.ownerDocument.body:ke(n)&&Xs(n)?n:To(os(n))}function xt(n,e){var s;e===void 0&&(e=[]);var o=To(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),a=Se(o),r=i?[a].concat(a.visualViewport||[],Xs(o)?o:[]):o,l=e.concat(r);return i?l:l.concat(xt(os(r)))}function Ds(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function tv(n,e){var s=vt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Sn(n,e,s){return e===Ws?Ds(Zf(n,s)):nt(e)?tv(e,s):Ds(ev(Ge(n)))}function sv(n){var e=xt(os(n)),s=["absolute","fixed"].indexOf(Ve(n).position)>=0,o=s&&ke(n)?Lt(n):n;return nt(o)?e.filter(function(i){return nt(i)&&wo(i,o)&&Ie(i)!=="body"}):[]}function nv(n,e,s,o){var i=e==="clippingParents"?sv(n):[].concat(e),a=[].concat(i,[s]),r=a[0],l=a.reduce(function(c,p){var d=Sn(n,p,o);return c.top=tt(d.top,c.top),c.right=Qt(d.right,c.right),c.bottom=Qt(d.bottom,c.bottom),c.left=tt(d.left,c.left),c},Sn(n,r,o));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function xo(n){var e=n.reference,s=n.element,o=n.placement,i=o?Ne(o):null,a=o?ht(o):null,r=e.x+e.width/2-s.width/2,l=e.y+e.height/2-s.height/2,c;switch(i){case be:c={x:r,y:e.y-s.height};break;case Ee:c={x:r,y:e.y+e.height};break;case Ce:c={x:e.x+e.width,y:l};break;case ye:c={x:e.x-s.width,y:l};break;default:c={x:e.x,y:e.y}}var p=i?zs(i):null;if(p!=null){var d=p==="y"?"height":"width";switch(a){case st:c[p]=c[p]-(e[d]/2-s[d]/2);break;case pt:c[p]=c[p]+(e[d]/2-s[d]/2);break}}return c}function _t(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,a=s.strategy,r=a===void 0?n.strategy:a,l=s.boundary,c=l===void 0?lo:l,p=s.rootBoundary,d=p===void 0?Ws:p,h=s.elementContext,b=h===void 0?ct:h,v=s.altBoundary,w=v===void 0?!1:v,y=s.padding,g=y===void 0?0:y,f=Co(typeof g!="number"?g:So(g,yt)),M=b===ct?co:ct,C=n.rects.popper,T=n.elements[w?M:b],D=nv(nt(T)?T:T.contextElement||Ge(n.elements.popper),c,d,r),I=vt(n.elements.reference),E=xo({reference:I,element:C,placement:i}),k=Ds(Object.assign({},C,E)),R=b===ct?k:I,N={top:D.top-R.top+f.top,bottom:R.bottom-D.bottom+f.bottom,left:D.left-R.left+f.left,right:R.right-D.right+f.right},A=n.modifiersData.offset;if(b===ct&&A){var S=A[i];Object.keys(N).forEach(function(O){var x=[Ce,Ee].indexOf(O)>=0?1:-1,j=[be,Ee].indexOf(O)>=0?"y":"x";N[O]+=S[j]*x})}return N}function ov(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,a=s.rootBoundary,r=s.padding,l=s.flipVariations,c=s.allowedAutoPlacements,p=c===void 0?Fs:c,d=ht(o),h=d?l?Ns:Ns.filter(function(w){return ht(w)===d}):yt,b=h.filter(function(w){return p.indexOf(w)>=0});b.length===0&&(b=h);var v=b.reduce(function(w,y){return w[y]=_t(n,{placement:y,boundary:i,rootBoundary:a,padding:r})[Ne(y)],w},{});return Object.keys(v).sort(function(w,y){return v[w]-v[y]})}function iv(n){if(Ne(n)===ns)return[];var e=Kt(n);return[Cn(n),e,Cn(e)]}function av(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,a=i===void 0?!0:i,r=s.altAxis,l=r===void 0?!0:r,c=s.fallbackPlacements,p=s.padding,d=s.boundary,h=s.rootBoundary,b=s.altBoundary,v=s.flipVariations,w=v===void 0?!0:v,y=s.allowedAutoPlacements,g=e.options.placement,f=Ne(g),M=f===g,C=c||(M||!w?[Kt(g)]:iv(g)),T=[g].concat(C).reduce(function(B,ae){return B.concat(Ne(ae)===ns?ov(e,{placement:ae,boundary:d,rootBoundary:h,padding:p,flipVariations:w,allowedAutoPlacements:y}):ae)},[]),D=e.rects.reference,I=e.rects.popper,E=new Map,k=!0,R=T[0],N=0;N<T.length;N++){var A=T[N],S=Ne(A),O=ht(A)===st,x=[be,Ee].indexOf(S)>=0,j=x?"width":"height",F=_t(e,{placement:A,boundary:d,rootBoundary:h,altBoundary:b,padding:p}),U=x?O?Ce:ye:O?Ee:be;D[j]>I[j]&&(U=Kt(U));var oe=Kt(U),le=[];if(a&&le.push(F[S]<=0),l&&le.push(F[U]<=0,F[oe]<=0),le.every(function(B){return B})){R=A,k=!1;break}E.set(A,le)}if(k)for(var me=w?3:1,Fe=function(ae){var H=T.find(function(W){var Y=E.get(W);if(Y)return Y.slice(0,ae).every(function(X){return X})});if(H)return R=H,"break"},ve=me;ve>0;ve--){var Q=Fe(ve);if(Q==="break")break}e.placement!==R&&(e.modifiersData[o]._skip=!0,e.placement=R,e.reset=!0)}}const Ao={name:"flip",enabled:!0,phase:"main",fn:av,requiresIfExists:["offset"],data:{_skip:!1}};function kn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Tn(n){return[be,Ce,Ee,ye].some(function(e){return n[e]>=0})}function rv(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=_t(e,{elementContext:"reference"}),l=_t(e,{altBoundary:!0}),c=kn(r,o),p=kn(l,i,a),d=Tn(c),h=Tn(p);e.modifiersData[s]={referenceClippingOffsets:c,popperEscapeOffsets:p,isReferenceHidden:d,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":h})}const Mo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:rv};function lv(n,e,s){var o=Ne(n),i=[ye,be].indexOf(o)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,r=a[0],l=a[1];return r=r||0,l=(l||0)*i,[ye,Ce].indexOf(o)>=0?{x:l,y:r}:{x:r,y:l}}function cv(n){var e=n.state,s=n.options,o=n.name,i=s.offset,a=i===void 0?[0,0]:i,r=Fs.reduce(function(d,h){return d[h]=lv(h,e.rects,a),d},{}),l=r[e.placement],c=l.x,p=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=r}const Oo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:cv};function dv(n){var e=n.state,s=n.name;e.modifiersData[s]=xo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Qs={name:"popperOffsets",enabled:!0,phase:"read",fn:dv,data:{}};function uv(n){return n==="x"?"y":"x"}function mv(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,a=i===void 0?!0:i,r=s.altAxis,l=r===void 0?!1:r,c=s.boundary,p=s.rootBoundary,d=s.altBoundary,h=s.padding,b=s.tether,v=b===void 0?!0:b,w=s.tetherOffset,y=w===void 0?0:w,g=_t(e,{boundary:c,rootBoundary:p,padding:h,altBoundary:d}),f=Ne(e.placement),M=ht(e.placement),C=!M,T=zs(f),D=uv(T),I=e.modifiersData.popperOffsets,E=e.rects.reference,k=e.rects.popper,R=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,N=typeof R=="number"?{mainAxis:R,altAxis:R}:Object.assign({mainAxis:0,altAxis:0},R),A=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,S={x:0,y:0};if(I){if(a){var O,x=T==="y"?be:ye,j=T==="y"?Ee:Ce,F=T==="y"?"height":"width",U=I[T],oe=U+g[x],le=U-g[j],me=v?-k[F]/2:0,Fe=M===st?E[F]:k[F],ve=M===st?-k[F]:-E[F],Q=e.elements.arrow,B=v&&Q?qs(Q):{width:0,height:0},ae=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Eo(),H=ae[x],W=ae[j],Y=Tt(0,E[F],B[F]),X=C?E[F]/2-me-Y-H-N.mainAxis:Fe-Y-H-N.mainAxis,J=C?-E[F]/2+me+Y+W+N.mainAxis:ve+Y+W+N.mainAxis,pe=e.elements.arrow&&Lt(e.elements.arrow),Ct=pe?T==="y"?pe.clientTop||0:pe.clientLeft||0:0,Rt=(O=A?.[T])!=null?O:0,ci=U+X-Rt-Ct,di=U+J-Rt,rn=Tt(v?Qt(oe,ci):oe,U,v?tt(le,di):le);I[T]=rn,S[T]=rn-U}if(l){var ln,ui=T==="x"?be:ye,mi=T==="x"?Ee:Ce,Qe=I[D],Vt=D==="y"?"height":"width",cn=Qe+g[ui],dn=Qe-g[mi],us=[be,ye].indexOf(f)!==-1,un=(ln=A?.[D])!=null?ln:0,mn=us?cn:Qe-E[Vt]-k[Vt]-un+N.altAxis,pn=us?Qe+E[Vt]+k[Vt]-un-N.altAxis:dn,fn=v&&us?Uf(mn,Qe,pn):Tt(v?mn:cn,Qe,v?pn:dn);I[D]=fn,S[D]=fn-Qe}e.modifiersData[o]=S}}const No={name:"preventOverflow",enabled:!0,phase:"main",fn:mv,requiresIfExists:["offset"]};function pv(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function fv(n){return n===Se(n)||!ke(n)?Gs(n):pv(n)}function vv(n){var e=n.getBoundingClientRect(),s=ft(e.width)/n.offsetWidth||1,o=ft(e.height)/n.offsetHeight||1;return s!==1||o!==1}function hv(n,e,s){s===void 0&&(s=!1);var o=ke(e),i=ke(e)&&vv(e),a=Ge(e),r=vt(n,i,s),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(o||!o&&!s)&&((Ie(e)!=="body"||Xs(a))&&(l=fv(e)),ke(e)?(c=vt(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):a&&(c.x=Js(a))),{x:r.left+l.scrollLeft-c.x,y:r.top+l.scrollTop-c.y,width:r.width,height:r.height}}function _v(n){var e=new Map,s=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){s.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(l){if(!s.has(l)){var c=e.get(l);c&&i(c)}}),o.push(a)}return n.forEach(function(a){s.has(a.name)||i(a)}),o}function gv(n){var e=_v(n);return yo.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function bv(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function yv(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var xn={placement:"bottom",modifiers:[],strategy:"absolute"};function An(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function is(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,a=i===void 0?xn:i;return function(l,c,p){p===void 0&&(p=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},xn,a),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},h=[],b=!1,v={state:d,setOptions:function(f){var M=typeof f=="function"?f(d.options):f;y(),d.options=Object.assign({},a,d.options,M),d.scrollParents={reference:nt(l)?xt(l):l.contextElement?xt(l.contextElement):[],popper:xt(c)};var C=gv(yv([].concat(o,d.options.modifiers)));return d.orderedModifiers=C.filter(function(T){return T.enabled}),w(),v.update()},forceUpdate:function(){if(!b){var f=d.elements,M=f.reference,C=f.popper;if(An(M,C)){d.rects={reference:hv(M,Lt(C),d.options.strategy==="fixed"),popper:qs(C)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(N){return d.modifiersData[N.name]=Object.assign({},N.data)});for(var T=0;T<d.orderedModifiers.length;T++){if(d.reset===!0){d.reset=!1,T=-1;continue}var D=d.orderedModifiers[T],I=D.fn,E=D.options,k=E===void 0?{}:E,R=D.name;typeof I=="function"&&(d=I({state:d,options:k,name:R,instance:v})||d)}}}},update:bv(function(){return new Promise(function(g){v.forceUpdate(),g(d)})}),destroy:function(){y(),b=!0}};if(!An(l,c))return v;v.setOptions(p).then(function(g){!b&&p.onFirstUpdate&&p.onFirstUpdate(g)});function w(){d.orderedModifiers.forEach(function(g){var f=g.name,M=g.options,C=M===void 0?{}:M,T=g.effect;if(typeof T=="function"){var D=T({state:d,name:f,instance:v,options:C}),I=function(){};h.push(D||I)}})}function y(){h.forEach(function(g){return g()}),h=[]}return v}}var $v=is(),wv=[Ys,Qs,Ks,Bs],Ev=is({defaultModifiers:wv}),Cv=[Ys,Qs,Ks,Bs,Oo,Ao,No,ko,Mo],Zs=is({defaultModifiers:Cv});const Lo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ho,afterRead:po,afterWrite:bo,applyStyles:Bs,arrow:ko,auto:ns,basePlacements:yt,beforeMain:fo,beforeRead:uo,beforeWrite:_o,bottom:Ee,clippingParents:lo,computeStyles:Ks,createPopper:Zs,createPopperBase:$v,createPopperLite:Ev,detectOverflow:_t,end:pt,eventListeners:Ys,flip:Ao,hide:Mo,left:ye,main:vo,modifierPhases:yo,offset:Oo,placements:Fs,popper:ct,popperGenerator:is,popperOffsets:Qs,preventOverflow:No,read:mo,reference:co,right:Ce,start:st,top:be,variationPlacements:Ns,viewport:Ws,write:go},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Ue=new Map,vs={set(n,e,s){Ue.has(n)||Ue.set(n,new Map);const o=Ue.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return Ue.has(n)&&Ue.get(n).get(e)||null},remove(n,e){if(!Ue.has(n))return;const s=Ue.get(n);s.delete(e),s.size===0&&Ue.delete(n)}},Sv=1e6,kv=1e3,Is="transitionend",Do=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),Tv=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),xv=n=>{do n+=Math.floor(Math.random()*Sv);while(document.getElementById(n));return n},Av=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*kv)},Io=n=>{n.dispatchEvent(new Event(Is))},Pe=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Be=n=>Pe(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Do(n)):null,$t=n=>{if(!Pe(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},qe=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Po=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Po(n.parentNode):null},Zt=()=>{},Dt=n=>{n.offsetHeight},jo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,hs=[],Mv=n=>{document.readyState==="loading"?(hs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of hs)e()}),hs.push(n)):n()},Te=()=>document.documentElement.dir==="rtl",Ae=n=>{Mv(()=>{const e=jo();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},$e=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,Ro=(n,e,s=!0)=>{if(!s){$e(n);return}const i=Av(e)+5;let a=!1;const r=({target:l})=>{l===e&&(a=!0,e.removeEventListener(Is,r),$e(n))};e.addEventListener(Is,r),setTimeout(()=>{a||Io(e)},i)},en=(n,e,s,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!s&&o?n[i-1]:n[0]:(a+=s?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},Ov=/[^.]*(?=\..*)\.|.*/,Nv=/\..*/,Lv=/::\d+$/,_s={};let Mn=1;const Vo={mouseenter:"mouseover",mouseleave:"mouseout"},Dv=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ho(n,e){return e&&`${e}::${Mn++}`||n.uidEvent||Mn++}function Wo(n){const e=Ho(n);return n.uidEvent=e,_s[e]=_s[e]||{},_s[e]}function Iv(n,e){return function s(o){return tn(o,{delegateTarget:n}),s.oneOff&&V.off(n,o.type,e),e.apply(n,[o])}}function Pv(n,e,s){return function o(i){const a=n.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const l of a)if(l===r)return tn(i,{delegateTarget:r}),o.oneOff&&V.off(n,i.type,e,s),s.apply(r,[i])}}function Fo(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Uo(n,e,s){const o=typeof e=="string",i=o?s:e||s;let a=Bo(n);return Dv.has(a)||(a=n),[o,i,a]}function On(n,e,s,o,i){if(typeof e!="string"||!n)return;let[a,r,l]=Uo(e,s,o);e in Vo&&(r=(w=>function(y){if(!y.relatedTarget||y.relatedTarget!==y.delegateTarget&&!y.delegateTarget.contains(y.relatedTarget))return w.call(this,y)})(r));const c=Wo(n),p=c[l]||(c[l]={}),d=Fo(p,r,a?s:null);if(d){d.oneOff=d.oneOff&&i;return}const h=Ho(r,e.replace(Ov,"")),b=a?Pv(n,s,r):Iv(n,r);b.delegationSelector=a?s:null,b.callable=r,b.oneOff=i,b.uidEvent=h,p[h]=b,n.addEventListener(l,b,a)}function Ps(n,e,s,o,i){const a=Fo(e[s],o,i);a&&(n.removeEventListener(s,a,!!i),delete e[s][a.uidEvent])}function jv(n,e,s,o){const i=e[s]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&Ps(n,e,s,r.callable,r.delegationSelector)}function Bo(n){return n=n.replace(Nv,""),Vo[n]||n}const V={on(n,e,s,o){On(n,e,s,o,!1)},one(n,e,s,o){On(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,a,r]=Uo(e,s,o),l=r!==e,c=Wo(n),p=c[r]||{},d=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(p).length)return;Ps(n,c,r,a,i?s:null);return}if(d)for(const h of Object.keys(c))jv(n,c,h,e.slice(1));for(const[h,b]of Object.entries(p)){const v=h.replace(Lv,"");(!l||e.includes(v))&&Ps(n,c,r,b.callable,b.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=jo(),i=Bo(e),a=e!==i;let r=null,l=!0,c=!0,p=!1;a&&o&&(r=o.Event(e,s),o(n).trigger(r),l=!r.isPropagationStopped(),c=!r.isImmediatePropagationStopped(),p=r.isDefaultPrevented());const d=tn(new Event(e,{bubbles:l,cancelable:!0}),s);return p&&d.preventDefault(),c&&n.dispatchEvent(d),d.defaultPrevented&&r&&r.preventDefault(),d}};function tn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Nn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function gs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const je={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${gs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${gs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Nn(n.dataset[o])}return e},getDataAttribute(n,e){return Nn(n.getAttribute(`data-bs-${gs(e)}`))}};class It{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Pe(s)?je.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Pe(s)?je.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const a=e[o],r=Pe(a)?"element":Tv(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const Rv="5.3.8";class Oe extends It{constructor(e,s){super(),e=Be(e),e&&(this._element=e,this._config=this._getConfig(s),vs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){vs.remove(this._element,this.constructor.DATA_KEY),V.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){Ro(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return vs.get(Be(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Rv}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const bs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>Do(s)).join(","):null},G={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!qe(s)&&$t(s))},getSelectorFromElement(n){const e=bs(n);return e&&G.findOne(e)?e:null},getElementFromSelector(n){const e=bs(n);return e?G.findOne(e):null},getMultipleElementsFromSelector(n){const e=bs(n);return e?G.find(e):[]}},as=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;V.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),qe(this))return;const a=G.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},Vv="alert",Hv="bs.alert",qo=`.${Hv}`,Wv=`close${qo}`,Fv=`closed${qo}`,Uv="fade",Bv="show";class rs extends Oe{static get NAME(){return Vv}close(){if(V.trigger(this._element,Wv).defaultPrevented)return;this._element.classList.remove(Bv);const s=this._element.classList.contains(Uv);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),V.trigger(this._element,Fv),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=rs.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}as(rs,"close");Ae(rs);const qv="button",zv="bs.button",Kv=`.${zv}`,Yv=".data-api",Gv="active",Ln='[data-bs-toggle="button"]',Jv=`click${Kv}${Yv}`;class ls extends Oe{static get NAME(){return qv}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Gv))}static jQueryInterface(e){return this.each(function(){const s=ls.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}V.on(document,Jv,Ln,n=>{n.preventDefault();const e=n.target.closest(Ln);ls.getOrCreateInstance(e).toggle()});Ae(ls);const Xv="swipe",wt=".bs.swipe",Qv=`touchstart${wt}`,Zv=`touchmove${wt}`,eh=`touchend${wt}`,th=`pointerdown${wt}`,sh=`pointerup${wt}`,nh="touch",oh="pen",ih="pointer-event",ah=40,rh={endCallback:null,leftCallback:null,rightCallback:null},lh={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class es extends It{constructor(e,s){super(),this._element=e,!(!e||!es.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return rh}static get DefaultType(){return lh}static get NAME(){return Xv}dispose(){V.off(this._element,wt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),$e(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=ah)return;const s=e/this._deltaX;this._deltaX=0,s&&$e(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(V.on(this._element,th,e=>this._start(e)),V.on(this._element,sh,e=>this._end(e)),this._element.classList.add(ih)):(V.on(this._element,Qv,e=>this._start(e)),V.on(this._element,Zv,e=>this._move(e)),V.on(this._element,eh,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===oh||e.pointerType===nh)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const ch="carousel",dh="bs.carousel",Je=`.${dh}`,zo=".data-api",uh="ArrowLeft",mh="ArrowRight",ph=500,St="next",rt="prev",dt="left",Yt="right",fh=`slide${Je}`,ys=`slid${Je}`,vh=`keydown${Je}`,hh=`mouseenter${Je}`,_h=`mouseleave${Je}`,gh=`dragstart${Je}`,bh=`load${Je}${zo}`,yh=`click${Je}${zo}`,Ko="carousel",Wt="active",$h="slide",wh="carousel-item-end",Eh="carousel-item-start",Ch="carousel-item-next",Sh="carousel-item-prev",Yo=".active",Go=".carousel-item",kh=Yo+Go,Th=".carousel-item img",xh=".carousel-indicators",Ah="[data-bs-slide], [data-bs-slide-to]",Mh='[data-bs-ride="carousel"]',Oh={[uh]:Yt,[mh]:dt},Nh={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Lh={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Pt extends Oe{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=G.findOne(xh,this._element),this._addEventListeners(),this._config.ride===Ko&&this.cycle()}static get Default(){return Nh}static get DefaultType(){return Lh}static get NAME(){return ch}next(){this._slide(St)}nextWhenVisible(){!document.hidden&&$t(this._element)&&this.next()}prev(){this._slide(rt)}pause(){this._isSliding&&Io(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){V.one(this._element,ys,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){V.one(this._element,ys,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?St:rt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&V.on(this._element,vh,e=>this._keydown(e)),this._config.pause==="hover"&&(V.on(this._element,hh,()=>this.pause()),V.on(this._element,_h,()=>this._maybeEnableCycle())),this._config.touch&&es.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of G.find(Th,this._element))V.on(o,gh,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(dt)),rightCallback:()=>this._slide(this._directionToOrder(Yt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),ph+this._config.interval))}};this._swipeHelper=new es(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Oh[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=G.findOne(Yo,this._indicatorsElement);s.classList.remove(Wt),s.removeAttribute("aria-current");const o=G.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Wt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===St,a=s||en(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),l=v=>V.trigger(this._element,v,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(l(fh).defaultPrevented||!o||!a)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const d=i?Eh:wh,h=i?Ch:Sh;a.classList.add(h),Dt(a),o.classList.add(d),a.classList.add(d);const b=()=>{a.classList.remove(d,h),a.classList.add(Wt),o.classList.remove(Wt,h,d),this._isSliding=!1,l(ys)};this._queueCallback(b,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains($h)}_getActive(){return G.findOne(kh,this._element)}_getItems(){return G.find(Go,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Te()?e===dt?rt:St:e===dt?St:rt}_orderToDirection(e){return Te()?e===rt?dt:Yt:e===rt?Yt:dt}static jQueryInterface(e){return this.each(function(){const s=Pt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}V.on(document,yh,Ah,function(n){const e=G.getElementFromSelector(this);if(!e||!e.classList.contains(Ko))return;n.preventDefault();const s=Pt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(je.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});V.on(window,bh,()=>{const n=G.find(Mh);for(const e of n)Pt.getOrCreateInstance(e)});Ae(Pt);const Dh="collapse",Ih="bs.collapse",jt=`.${Ih}`,Ph=".data-api",jh=`show${jt}`,Rh=`shown${jt}`,Vh=`hide${jt}`,Hh=`hidden${jt}`,Wh=`click${jt}${Ph}`,$s="show",mt="collapse",Ft="collapsing",Fh="collapsed",Uh=`:scope .${mt} .${mt}`,Bh="collapse-horizontal",qh="width",zh="height",Kh=".collapse.show, .collapse.collapsing",js='[data-bs-toggle="collapse"]',Yh={parent:null,toggle:!0},Gh={parent:"(null|element)",toggle:"boolean"};class Nt extends Oe{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=G.find(js);for(const i of o){const a=G.getSelectorFromElement(i),r=G.find(a).filter(l=>l===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Yh}static get DefaultType(){return Gh}static get NAME(){return Dh}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Kh).filter(l=>l!==this._element).map(l=>Nt.getOrCreateInstance(l,{toggle:!1}))),e.length&&e[0]._isTransitioning||V.trigger(this._element,jh).defaultPrevented)return;for(const l of e)l.hide();const o=this._getDimension();this._element.classList.remove(mt),this._element.classList.add(Ft),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(mt,$s),this._element.style[o]="",V.trigger(this._element,Rh)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||V.trigger(this._element,Vh).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Dt(this._element),this._element.classList.add(Ft),this._element.classList.remove(mt,$s);for(const i of this._triggerArray){const a=G.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(mt),V.trigger(this._element,Hh)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains($s)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Be(e.parent),e}_getDimension(){return this._element.classList.contains(Bh)?qh:zh}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(js);for(const s of e){const o=G.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=G.find(Uh,this._config.parent);return G.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Fh,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Nt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}V.on(document,Wh,js,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of G.getMultipleElementsFromSelector(this))Nt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ae(Nt);const Dn="dropdown",Jh="bs.dropdown",it=`.${Jh}`,sn=".data-api",Xh="Escape",In="Tab",Qh="ArrowUp",Pn="ArrowDown",Zh=2,e_=`hide${it}`,t_=`hidden${it}`,s_=`show${it}`,n_=`shown${it}`,Jo=`click${it}${sn}`,Xo=`keydown${it}${sn}`,o_=`keyup${it}${sn}`,ut="show",i_="dropup",a_="dropend",r_="dropstart",l_="dropup-center",c_="dropdown-center",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',d_=`${Ze}.${ut}`,Gt=".dropdown-menu",u_=".navbar",m_=".navbar-nav",p_=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",f_=Te()?"top-end":"top-start",v_=Te()?"top-start":"top-end",h_=Te()?"bottom-end":"bottom-start",__=Te()?"bottom-start":"bottom-end",g_=Te()?"left-start":"right-start",b_=Te()?"right-start":"left-start",y_="top",$_="bottom",w_={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},E_={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Le extends Oe{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=G.next(this._element,Gt)[0]||G.prev(this._element,Gt)[0]||G.findOne(Gt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return w_}static get DefaultType(){return E_}static get NAME(){return Dn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(qe(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!V.trigger(this._element,s_,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(m_))for(const o of[].concat(...document.body.children))V.on(o,"mouseover",Zt);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ut),this._element.classList.add(ut),V.trigger(this._element,n_,e)}}hide(){if(qe(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!V.trigger(this._element,e_,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))V.off(o,"mouseover",Zt);this._popper&&this._popper.destroy(),this._menu.classList.remove(ut),this._element.classList.remove(ut),this._element.setAttribute("aria-expanded","false"),je.removeDataAttribute(this._menu,"popper"),V.trigger(this._element,t_,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Pe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Dn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Lo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Pe(this._config.reference)?e=Be(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Zs(e,this._menu,s)}_isShown(){return this._menu.classList.contains(ut)}_getPlacement(){const e=this._parent;if(e.classList.contains(a_))return g_;if(e.classList.contains(r_))return b_;if(e.classList.contains(l_))return y_;if(e.classList.contains(c_))return $_;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(i_)?s?v_:f_:s?__:h_}_detectNavbar(){return this._element.closest(u_)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(je.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...$e(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=G.find(p_,this._menu).filter(i=>$t(i));o.length&&en(o,s,e===Pn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Le.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===Zh||e.type==="keyup"&&e.key!==In)return;const s=G.find(d_);for(const o of s){const i=Le.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===In||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const l={relatedTarget:i._element};e.type==="click"&&(l.clickEvent=e),i._completeHide(l)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Xh,i=[Qh,Pn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const a=this.matches(Ze)?this:G.prev(this,Ze)[0]||G.next(this,Ze)[0]||G.findOne(Ze,e.delegateTarget.parentNode),r=Le.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}V.on(document,Xo,Ze,Le.dataApiKeydownHandler);V.on(document,Xo,Gt,Le.dataApiKeydownHandler);V.on(document,Jo,Le.clearMenus);V.on(document,o_,Le.clearMenus);V.on(document,Jo,Ze,function(n){n.preventDefault(),Le.getOrCreateInstance(this).toggle()});Ae(Le);const Qo="backdrop",C_="fade",jn="show",Rn=`mousedown.bs.${Qo}`,S_={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},k_={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Zo extends It{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return S_}static get DefaultType(){return k_}static get NAME(){return Qo}show(e){if(!this._config.isVisible){$e(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Dt(s),s.classList.add(jn),this._emulateAnimation(()=>{$e(e)})}hide(e){if(!this._config.isVisible){$e(e);return}this._getElement().classList.remove(jn),this._emulateAnimation(()=>{this.dispose(),$e(e)})}dispose(){this._isAppended&&(V.off(this._element,Rn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(C_),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Be(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),V.on(e,Rn,()=>{$e(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Ro(e,this._getElement(),this._config.isAnimated)}}const T_="focustrap",x_="bs.focustrap",ts=`.${x_}`,A_=`focusin${ts}`,M_=`keydown.tab${ts}`,O_="Tab",N_="forward",Vn="backward",L_={autofocus:!0,trapElement:null},D_={autofocus:"boolean",trapElement:"element"};class ei extends It{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return L_}static get DefaultType(){return D_}static get NAME(){return T_}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),V.off(document,ts),V.on(document,A_,e=>this._handleFocusin(e)),V.on(document,M_,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,V.off(document,ts))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=G.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Vn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===O_&&(this._lastTabNavDirection=e.shiftKey?Vn:N_)}}const Hn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Wn=".sticky-top",Ut="padding-right",Fn="margin-right";class Rs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ut,s=>s+e),this._setElementAttributes(Hn,Ut,s=>s+e),this._setElementAttributes(Wn,Fn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ut),this._resetElementAttributes(Hn,Ut),this._resetElementAttributes(Wn,Fn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,s);const l=window.getComputedStyle(r).getPropertyValue(s);r.style.setProperty(s,`${o(Number.parseFloat(l))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&je.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const a=je.getDataAttribute(i,s);if(a===null){i.style.removeProperty(s);return}je.removeDataAttribute(i,s),i.style.setProperty(s,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Pe(e)){s(e);return}for(const o of G.find(e,this._element))s(o)}}const I_="modal",P_="bs.modal",xe=`.${P_}`,j_=".data-api",R_="Escape",V_=`hide${xe}`,H_=`hidePrevented${xe}`,ti=`hidden${xe}`,si=`show${xe}`,W_=`shown${xe}`,F_=`resize${xe}`,U_=`click.dismiss${xe}`,B_=`mousedown.dismiss${xe}`,q_=`keydown.dismiss${xe}`,z_=`click${xe}${j_}`,Un="modal-open",K_="fade",Bn="show",ws="modal-static",Y_=".modal.show",G_=".modal-dialog",J_=".modal-body",X_='[data-bs-toggle="modal"]',Q_={backdrop:!0,focus:!0,keyboard:!0},Z_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ze extends Oe{constructor(e,s){super(e,s),this._dialog=G.findOne(G_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Rs,this._addEventListeners()}static get Default(){return Q_}static get DefaultType(){return Z_}static get NAME(){return I_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||V.trigger(this._element,si,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Un),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||V.trigger(this._element,V_).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Bn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){V.off(window,xe),V.off(this._dialog,xe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Zo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=G.findOne(J_,this._dialog);s&&(s.scrollTop=0),Dt(this._element),this._element.classList.add(Bn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,V.trigger(this._element,W_,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){V.on(this._element,q_,e=>{if(e.key===R_){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),V.on(window,F_,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),V.on(this._element,B_,e=>{V.one(this._element,U_,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Un),this._resetAdjustments(),this._scrollBar.reset(),V.trigger(this._element,ti)})}_isAnimated(){return this._element.classList.contains(K_)}_triggerBackdropTransition(){if(V.trigger(this._element,H_).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(ws)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(ws),this._queueCallback(()=>{this._element.classList.remove(ws),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=Te()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=Te()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}V.on(document,z_,X_,function(n){const e=G.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),V.one(e,si,i=>{i.defaultPrevented||V.one(e,ti,()=>{$t(this)&&this.focus()})});const s=G.findOne(Y_);s&&ze.getInstance(s).hide(),ze.getOrCreateInstance(e).toggle(this)});as(ze);Ae(ze);const eg="offcanvas",tg="bs.offcanvas",We=`.${tg}`,ni=".data-api",sg=`load${We}${ni}`,ng="Escape",qn="show",zn="showing",Kn="hiding",og="offcanvas-backdrop",oi=".offcanvas.show",ig=`show${We}`,ag=`shown${We}`,rg=`hide${We}`,Yn=`hidePrevented${We}`,ii=`hidden${We}`,lg=`resize${We}`,cg=`click${We}${ni}`,dg=`keydown.dismiss${We}`,ug='[data-bs-toggle="offcanvas"]',mg={backdrop:!0,keyboard:!0,scroll:!1},pg={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ke extends Oe{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return mg}static get DefaultType(){return pg}static get NAME(){return eg}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||V.trigger(this._element,ig,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Rs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(qn),this._element.classList.remove(zn),V.trigger(this._element,ag,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||V.trigger(this._element,rg).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Kn),this._backdrop.hide();const s=()=>{this._element.classList.remove(qn,Kn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Rs().reset(),V.trigger(this._element,ii)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){V.trigger(this._element,Yn);return}this.hide()},s=!!this._config.backdrop;return new Zo({className:og,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_addEventListeners(){V.on(this._element,dg,e=>{if(e.key===ng){if(this._config.keyboard){this.hide();return}V.trigger(this._element,Yn)}})}static jQueryInterface(e){return this.each(function(){const s=Ke.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}V.on(document,cg,ug,function(n){const e=G.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),qe(this))return;V.one(e,ii,()=>{$t(this)&&this.focus()});const s=G.findOne(oi);s&&s!==e&&Ke.getInstance(s).hide(),Ke.getOrCreateInstance(e).toggle(this)});V.on(window,sg,()=>{for(const n of G.find(oi))Ke.getOrCreateInstance(n).show()});V.on(window,lg,()=>{for(const n of G.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ke.getOrCreateInstance(n).hide()});as(Ke);Ae(Ke);const fg=/^aria-[\w-]*$/i,ai={"*":["class","dir","id","lang","role",fg],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},vg=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),hg=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,_g=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?vg.has(s)?!!hg.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function gg(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const l=r.nodeName.toLowerCase();if(!Object.keys(e).includes(l)){r.remove();continue}const c=[].concat(...r.attributes),p=[].concat(e["*"]||[],e[l]||[]);for(const d of c)_g(d,p)||r.removeAttribute(d.nodeName)}return i.body.innerHTML}const bg="TemplateFactory",yg={allowList:ai,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},$g={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},wg={entry:"(string|element|function|null)",selector:"(string|element)"};class Eg extends It{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return yg}static get DefaultType(){return $g}static get NAME(){return bg}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},wg)}_setContent(e,s,o){const i=G.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(Pe(s)){this._putElementInTemplate(Be(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?gg(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return $e(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Cg="tooltip",Sg=new Set(["sanitize","allowList","sanitizeFn"]),Es="fade",kg="modal",Bt="show",Tg=".tooltip-inner",Gn=`.${kg}`,Jn="hide.bs.modal",kt="hover",Cs="focus",Ss="click",xg="manual",Ag="hide",Mg="hidden",Og="show",Ng="shown",Lg="inserted",Dg="click",Ig="focusin",Pg="focusout",jg="mouseenter",Rg="mouseleave",Vg={AUTO:"auto",TOP:"top",RIGHT:Te()?"left":"right",BOTTOM:"bottom",LEFT:Te()?"right":"left"},Hg={allowList:ai,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Wg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Et extends Oe{constructor(e,s){if(typeof Lo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Hg}static get DefaultType(){return Wg}static get NAME(){return Cg}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),V.off(this._element.closest(Gn),Jn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=V.trigger(this._element,this.constructor.eventName(Og)),o=(Po(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),V.trigger(this._element,this.constructor.eventName(Lg))),this._popper=this._createPopper(i),i.classList.add(Bt),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))V.on(l,"mouseover",Zt);const r=()=>{V.trigger(this._element,this.constructor.eventName(Ng)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||V.trigger(this._element,this.constructor.eventName(Ag)).defaultPrevented)return;if(this._getTipElement().classList.remove(Bt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))V.off(i,"mouseover",Zt);this._activeTrigger[Ss]=!1,this._activeTrigger[Cs]=!1,this._activeTrigger[kt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),V.trigger(this._element,this.constructor.eventName(Mg)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Es,Bt),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=xv(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Es),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Eg({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Tg]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Es)}_isShown(){return this.tip&&this.tip.classList.contains(Bt)}_createPopper(e){const s=$e(this._config.placement,[this,e,this._element]),o=Vg[s.toUpperCase()];return Zs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return $e(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...$e(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")V.on(this._element,this.constructor.eventName(Dg),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ss]=!(i._isShown()&&i._activeTrigger[Ss]),i.toggle()});else if(s!==xg){const o=s===kt?this.constructor.eventName(jg):this.constructor.eventName(Ig),i=s===kt?this.constructor.eventName(Rg):this.constructor.eventName(Pg);V.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?Cs:kt]=!0,r._enter()}),V.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?Cs:kt]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},V.on(this._element.closest(Gn),Jn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=je.getDataAttributes(this._element);for(const o of Object.keys(s))Sg.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Be(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Et.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ae(Et);const Fg="popover",Ug=".popover-header",Bg=".popover-body",qg={...Et.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},zg={...Et.DefaultType,content:"(null|string|element|function)"};class nn extends Et{static get Default(){return qg}static get DefaultType(){return zg}static get NAME(){return Fg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Ug]:this._getTitle(),[Bg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=nn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ae(nn);const Kg="scrollspy",Yg="bs.scrollspy",on=`.${Yg}`,Gg=".data-api",Jg=`activate${on}`,Xn=`click${on}`,Xg=`load${on}${Gg}`,Qg="dropdown-item",lt="active",Zg='[data-bs-spy="scroll"]',ks="[href]",eb=".nav, .list-group",Qn=".nav-link",tb=".nav-item",sb=".list-group-item",nb=`${Qn}, ${tb} > ${Qn}, ${sb}`,ob=".dropdown",ib=".dropdown-toggle",ab={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},rb={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class cs extends Oe{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ab}static get DefaultType(){return rb}static get NAME(){return Kg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Be(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(V.off(this._config.target,Xn),V.on(this._config.target,Xn,ks,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(s(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(r));continue}const l=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&l){if(o(r),!i)return;continue}!a&&!l&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=G.find(ks,this._config.target);for(const s of e){if(!s.hash||qe(s))continue;const o=G.findOne(decodeURI(s.hash),this._element);$t(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(lt),this._activateParents(e),V.trigger(this._element,Jg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Qg)){G.findOne(ib,e.closest(ob)).classList.add(lt);return}for(const s of G.parents(e,eb))for(const o of G.prev(s,nb))o.classList.add(lt)}_clearActiveClass(e){e.classList.remove(lt);const s=G.find(`${ks}.${lt}`,e);for(const o of s)o.classList.remove(lt)}static jQueryInterface(e){return this.each(function(){const s=cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}V.on(window,Xg,()=>{for(const n of G.find(Zg))cs.getOrCreateInstance(n)});Ae(cs);const lb="tab",cb="bs.tab",at=`.${cb}`,db=`hide${at}`,ub=`hidden${at}`,mb=`show${at}`,pb=`shown${at}`,fb=`click${at}`,vb=`keydown${at}`,hb=`load${at}`,_b="ArrowLeft",Zn="ArrowRight",gb="ArrowUp",eo="ArrowDown",Ts="Home",to="End",et="active",so="fade",xs="show",bb="dropdown",ri=".dropdown-toggle",yb=".dropdown-menu",As=`:not(${ri})`,$b='.list-group, .nav, [role="tablist"]',wb=".nav-item, .list-group-item",Eb=`.nav-link${As}, .list-group-item${As}, [role="tab"]${As}`,li='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ms=`${Eb}, ${li}`,Cb=`.${et}[data-bs-toggle="tab"], .${et}[data-bs-toggle="pill"], .${et}[data-bs-toggle="list"]`;class gt extends Oe{constructor(e){super(e),this._parent=this._element.closest($b),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),V.on(this._element,vb,s=>this._keydown(s)))}static get NAME(){return lb}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?V.trigger(s,db,{relatedTarget:e}):null;V.trigger(e,mb,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(et),this._activate(G.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(xs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),V.trigger(e,pb,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(so))}_deactivate(e,s){if(!e)return;e.classList.remove(et),e.blur(),this._deactivate(G.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(xs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),V.trigger(e,ub,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(so))}_keydown(e){if(![_b,Zn,gb,eo,Ts,to].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!qe(i));let o;if([Ts,to].includes(e.key))o=s[e.key===Ts?0:s.length-1];else{const i=[Zn,eo].includes(e.key);o=en(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),gt.getOrCreateInstance(o).show())}_getChildren(){return G.find(Ms,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=G.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(bb))return;const i=(a,r)=>{const l=G.findOne(a,o);l&&l.classList.toggle(r,s)};i(ri,et),i(yb,xs),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(et)}_getInnerElement(e){return e.matches(Ms)?e:G.findOne(Ms,e)}_getOuterElement(e){return e.closest(wb)||e}static jQueryInterface(e){return this.each(function(){const s=gt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}V.on(document,fb,li,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!qe(this)&&gt.getOrCreateInstance(this).show()});V.on(window,hb,()=>{for(const n of G.find(Cb))gt.getOrCreateInstance(n)});Ae(gt);const Sb="toast",kb="bs.toast",Xe=`.${kb}`,Tb=`mouseover${Xe}`,xb=`mouseout${Xe}`,Ab=`focusin${Xe}`,Mb=`focusout${Xe}`,Ob=`hide${Xe}`,Nb=`hidden${Xe}`,Lb=`show${Xe}`,Db=`shown${Xe}`,Ib="fade",no="hide",qt="show",zt="showing",Pb={animation:"boolean",autohide:"boolean",delay:"number"},jb={animation:!0,autohide:!0,delay:5e3};class ds extends Oe{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return jb}static get DefaultType(){return Pb}static get NAME(){return Sb}show(){if(V.trigger(this._element,Lb).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Ib);const s=()=>{this._element.classList.remove(zt),V.trigger(this._element,Db),this._maybeScheduleHide()};this._element.classList.remove(no),Dt(this._element),this._element.classList.add(qt,zt),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||V.trigger(this._element,Ob).defaultPrevented)return;const s=()=>{this._element.classList.add(no),this._element.classList.remove(zt,qt),V.trigger(this._element,Nb)};this._element.classList.add(zt),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(qt),super.dispose()}isShown(){return this._element.classList.contains(qt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){V.on(this._element,Tb,e=>this._onInteraction(e,!0)),V.on(this._element,xb,e=>this._onInteraction(e,!1)),V.on(this._element,Ab,e=>this._onInteraction(e,!0)),V.on(this._element,Mb,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}as(ds);Ae(ds);const Rb={class:"modal-dialog modal-dialog-centered"},Vb={class:"modal-content"},Hb={class:"modal-body"},Wb={key:0,class:"alert alert-danger"},Fb={class:"mb-3"},Ub={class:"mb-3"},Bb={class:"form-text"},qb={class:"mb-3"},zb={class:"mb-3"},Kb=["value"],Yb={class:"modal-footer"},Gb=["disabled"],Jb={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:s}){const o=n,i=s,a=te(),r=L(null),l=L(null),c=L(""),p=L(!1),d=L({name:"",purpose:"",description:"",member_minion_ids:[]}),h=_(()=>{const g=[];for(const[f,M]of a.sessions.entries())M.is_minion&&M.project_id===o.legionId&&g.push(M);return g}),b=_(()=>d.value.name.trim()!==""&&d.value.purpose.trim()!==""),v=async()=>{if(!b.value){c.value="Name and purpose are required";return}p.value=!0,c.value="";try{const g=await Z.post(`/api/legions/${o.legionId}/channels`,{name:d.value.name.trim(),purpose:d.value.purpose.trim(),description:d.value.description.trim()||"",member_minion_ids:d.value.member_minion_ids});i("created",g.channel),l.value?.hide(),d.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(g){console.error("Failed to create channel:",g),c.value=g.response?.data?.detail||"Failed to create channel"}finally{p.value=!1}},w=()=>{l.value?.show()},y=()=>{l.value?.hide()};return ue(()=>{r.value&&(l.value=new ze(r.value))}),he(()=>{l.value?.dispose()}),e({show:w,hide:y}),(g,f)=>(u(),we(ao,{to:"body"},[t("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[t("div",Rb,[t("div",Vb,[f[11]||(f[11]=t("div",{class:"modal-header"},[t("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Hb,[c.value?(u(),m("div",Wb,$(c.value),1)):P("",!0),t("form",{onSubmit:_e(v,["prevent"])},[t("div",Fb,[f[4]||(f[4]=t("label",{for:"channel-name",class:"form-label"},[q(" Channel Name "),t("span",{class:"text-danger"},"*")],-1)),ee(t("input",{id:"channel-name","onUpdate:modelValue":f[0]||(f[0]=M=>d.value.name=M),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[ce,d.value.name]]),f[5]||(f[5]=t("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),t("div",Ub,[f[6]||(f[6]=t("label",{for:"channel-purpose",class:"form-label"},[q(" Purpose "),t("span",{class:"text-danger"},"*")],-1)),ee(t("textarea",{id:"channel-purpose","onUpdate:modelValue":f[1]||(f[1]=M=>d.value.purpose=M),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[ce,d.value.purpose]]),t("div",Bb,$(d.value.purpose.length)+" / 500 characters",1)]),t("div",qb,[f[7]||(f[7]=t("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),ee(t("textarea",{id:"channel-description","onUpdate:modelValue":f[2]||(f[2]=M=>d.value.description=M),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[ce,d.value.description]])]),t("div",zb,[f[8]||(f[8]=t("label",{class:"form-label"},"Initial Members (Optional)",-1)),ee(t("select",{"onUpdate:modelValue":f[3]||(f[3]=M=>d.value.member_minion_ids=M),multiple:"",class:"form-select",size:"5"},[(u(!0),m(se,null,ie(h.value,M=>(u(),m("option",{key:M.session_id,value:M.session_id},$(M.name)+$(M.role?` (${M.role})`:""),9,Kb))),128))],512),[[Me,d.value.member_minion_ids]]),f[9]||(f[9]=t("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),t("div",Yb,[f[10]||(f[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:p.value||!b.value},$(p.value?"Creating...":"Create Channel"),9,Gb)])])])],512)]))}},Xb=K(Jb,[["__scopeId","data-v-573f4c01"]]),Qb={class:"modal-dialog modal-dialog-centered"},Zb={class:"modal-content"},ey={class:"modal-body"},ty={key:0,class:"alert alert-danger"},sy={class:"text-muted"},ny={class:"modal-footer"},oy=["disabled"],iy={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:s}){const o=n,i=s,a=L(null),r=L(null),l=L(""),c=L(!1),p=_(()=>o.channel?.member_minion_ids?.length||0),d=async()=>{if(!o.channel){l.value="No channel selected";return}c.value=!0,l.value="";try{await Z.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),i("deleted",o.channel.channel_id),r.value?.hide()}catch(v){console.error("Failed to delete channel:",v),l.value=v.data?.detail||v.message||"Failed to delete channel"}finally{c.value=!1}},h=()=>{l.value="",r.value?.show()},b=()=>{r.value?.hide()};return ue(()=>{a.value&&(r.value=new ze(a.value))}),he(()=>{r.value?.dispose()}),e({show:h,hide:b}),(v,w)=>(u(),we(ao,{to:"body"},[t("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[t("div",Qb,[t("div",Zb,[w[4]||(w[4]=t("div",{class:"modal-header"},[t("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ey,[l.value?(u(),m("div",ty,$(l.value),1)):P("",!0),w[2]||(w[2]=t("div",{class:"alert alert-warning"},[t("strong",null,"⚠️ Warning:"),q(" This action cannot be undone. ")],-1)),t("p",null,[w[0]||(w[0]=q("Are you sure you want to delete ",-1)),t("strong",null,$(n.channel?.name),1),w[1]||(w[1]=q("?",-1))]),t("p",sy," This channel has "+$(p.value)+" "+$(p.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),t("div",ny,[w[3]||(w[3]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-danger",onClick:d,disabled:c.value},$(c.value?"Deleting...":"Delete Channel"),9,oy)])])])],512)]))}},ay=["id"],ry={class:"accordion-item"},ly={class:"accordion-header"},cy=["aria-expanded","aria-controls"],dy={class:"text-muted ms-2"},uy=["id","data-bs-parent"],my={class:"accordion-body p-0"},py={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},fy={key:1,class:"list-group list-group-flush"},vy={class:"d-flex align-items-center justify-content-between"},hy=["onClick"],_y={class:"channel-name"},gy={class:"d-flex align-items-center gap-2"},by={class:"badge bg-secondary member-count"},yy=["onClick"],$y={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ye(),o=ot(),i=L(null),a=L(null),r=L(null),l=L(!0),c=_(()=>`channelsAccordion-${e.project.project_id}`),p=_(()=>`channelsCollapsePanel-${e.project.project_id}`),d=_(()=>o.channelsByLegion.get(e.project.project_id)||[]),h=_(()=>d.value.length);function b(){const T=window.bootstrap;if(!T)return;const D=document.getElementById(p.value);if(!D)return;T.Collapse.getOrCreateInstance(D).toggle()}function v(){l.value=!0}function w(){l.value=!1}function y(T){s.push(`/channel/${e.project.project_id}/${T}`)}function g(){i.value?.show()}function f(T){r.value=T,a.value?.show()}function M(T){o.loadChannels(e.project.project_id)}function C(T){const I=(o.channelsByLegion.get(e.project.project_id)||[]).filter(E=>E.channel_id!==T);o.channelsByLegion.set(e.project.project_id,I),s.currentRoute.value.path.includes(T)&&s.push(`/timeline/${e.project.project_id}`)}return ue(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(T){console.error("Failed to load channels:",T)}}),(T,D)=>(u(),m(se,null,[t("div",{class:"accordion mt-2",id:c.value},[t("div",ry,[t("h2",ly,[t("button",{class:z(["accordion-button",{collapsed:!l.value}]),type:"button","aria-expanded":l.value,"aria-controls":p.value,onClick:b},[D[0]||(D[0]=t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"💬",-1)),D[1]||(D[1]=t("span",{class:"fw-semibold"},"Channels",-1)),t("small",dy,"("+$(h.value)+")",1)],10,cy)]),t("div",{id:p.value,class:z(["accordion-collapse","collapse",{show:l.value}]),"data-bs-parent":`#${c.value}`,onShown:v,onHidden:w},[t("div",my,[t("div",{class:"p-2 border-bottom"},[t("button",{class:"btn btn-sm btn-primary w-100",onClick:g}," + New Channel ")]),d.value.length===0?(u(),m("div",py,' No channels yet. Click "New Channel" to create one. ')):(u(),m("div",fy,[(u(!0),m(se,null,ie(d.value,I=>(u(),m("div",{key:I.channel_id,class:"list-group-item list-group-item-action channel-item"},[t("div",vy,[t("div",{class:"d-flex align-items-center flex-grow-1",onClick:E=>y(I.channel_id)},[D[2]||(D[2]=t("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"💬",-1)),t("span",_y,$(I.name),1)],8,hy),t("div",gy,[t("span",by,$(I.member_minion_ids?.length||0),1),t("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:_e(E=>f(I),["stop"]),title:"Delete channel",style:{"font-size":"1.1rem","line-height":"1"}}," 🗑️ ",8,yy)])])]))),128))]))])],42,uy)])],8,ay),ne(Xb,{ref_key:"createModal",ref:i,"legion-id":n.project.project_id,onCreated:M},null,8,["legion-id"]),ne(iy,{ref_key:"deleteModal",ref:a,"legion-id":n.project.project_id,channel:r.value,onDeleted:C},null,8,["legion-id","channel"])],64))}},wy=K($y,[["__scopeId","data-v-5644a5de"]]),Ey=["data-project-id"],Cy=["id"],Sy=["aria-expanded","aria-controls","onKeydown"],ky={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Ty={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},xy={class:"fw-semibold",style:{"flex-shrink":"0"}},Ay={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},My={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Oy=["title"],Ny=["title"],Ly=["id","aria-labelledby"],Dy={class:"accordion-body p-0"},Iy={class:"list-group list-group-flush"},Py={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ye(),o=fe(),i=te(),a=de(),r=L(e.project.is_expanded||!1),l=_(()=>o.formatPath(e.project.working_directory)),c=_(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(I=>i.getSession(I)).filter(I=>I!=null)),p=_(()=>{const I=s.currentRoute.value;return I.name==="timeline"&&I.params.legionId===e.project.project_id}),d=_(()=>{const I=s.currentRoute.value;return I.name==="horde"&&I.params.legionId===e.project.project_id});function h(I){const E=window.bootstrap;if(!E)return;const k=document.getElementById(`collapse-${e.project.project_id}`);if(!k)return;E.Collapse.getOrCreateInstance(k).toggle()}function b(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function v(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const I=i.currentSessionId;I&&i.getSession(I)&&e.project.session_ids?.includes(I)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function w(){a.showModal("edit-project",{project:e.project})}function y(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function g(){s.push(`/timeline/${e.project.project_id}`)}function f(){s.push(`/horde/${e.project.project_id}`)}function M(I){I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("application/project-id",e.project.project_id),I.dataTransfer.setData("text/plain",e.project.project_id),I.target.classList.add("dragging")}function C(I){I.target.classList.remove("dragging")}function T(I){I.preventDefault(),I.dataTransfer.dropEffect="move";const E=I.currentTarget.getBoundingClientRect(),k=E.top+E.height/2;I.clientY<k?(I.currentTarget.classList.add("drop-above"),I.currentTarget.classList.remove("drop-below")):(I.currentTarget.classList.add("drop-below"),I.currentTarget.classList.remove("drop-above"))}function D(I){I.preventDefault(),I.currentTarget.classList.remove("drop-above","drop-below");const E=I.dataTransfer.getData("application/project-id")||I.dataTransfer.getData("text/plain");if(!E||E===e.project.project_id)return;const k=I.currentTarget.getBoundingClientRect(),R=k.top+k.height/2,N=I.clientY<R,A=o.orderedProjects,S=A.findIndex(oe=>oe.project_id===e.project.project_id),O=A.findIndex(oe=>oe.project_id===E);if(S===-1||O===-1)return;const x=[...A],[j]=x.splice(O,1);let F=N?S:S+1;O<S&&F--,x.splice(F,0,j);const U=x.map(oe=>oe.project_id);o.reorderProjects(U)}return(I,E)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:M,onDragend:C,onDragover:T,onDrop:D},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:z(["accordion-button bg-white p-2",{collapsed:!r.value}]),role:"button",tabindex:"0","aria-expanded":r.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:h,onKeydown:[Xt(_e(h,["prevent"]),["enter"]),Xt(_e(h,["prevent"]),["space"])]},[t("div",ky,[t("div",Ty,[t("div",xy,[n.project.is_multi_agent?(u(),m("span",Ay,"🏛")):P("",!0),q(" "+$(n.project.name),1)]),t("div",My,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:_e(w,["stop"])}," ✏️ "),t("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:_e(y,["stop"])}," ➕ ",8,Oy)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(l.value),9,Ny)])],42,Sy)],8,Cy),ne(Mf,{project:n.project,sessions:c.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:z(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:b,onHidden:v},[t("div",Dy,[t("div",Iy,[n.project.is_multi_agent?(u(),m("div",{key:0,class:z(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:p.value}]),style:{cursor:"pointer"},onClick:g},[...E[0]||(E[0]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"📊"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):P("",!0),n.project.is_multi_agent?(u(),m(se,{key:1},[t("div",{class:z(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:d.value}]),style:{cursor:"pointer"},onClick:f},[...E[1]||(E[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"🌳"),t("span",{class:"fw-semibold"},"Horde"),t("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),ne(Rf,{project:n.project,sessions:c.value},null,8,["project","sessions"]),ne(wy,{project:n.project},null,8,["project"])],64)):(u(!0),m(se,{key:2},ie(c.value,k=>(u(),we(Df,{key:k.session_id,session:k,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,Ly)],40,Ey))}},jy=K(Py,[["__scopeId","data-v-04f4e534"]]),Ry={class:"project-list"},Vy={key:0,class:"text-muted text-center py-3"},Hy={__name:"ProjectList",setup(n){const e=fe(),s=_(()=>e.orderedProjects);return(o,i)=>(u(),m("div",Ry,[s.value.length===0?(u(),m("div",Vy,' No projects yet. Click "New" to create one. ')):P("",!0),(u(!0),m(se,null,ie(s.value,a=>(u(),we(jy,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},Wy={class:"flex-grow-1 overflow-auto p-3"},Fy={id:"sessions-container"},Uy={__name:"Sidebar",setup(n){const e=de(),s=_(()=>e.sidebarCollapsed),o=_(()=>e.isMobile),i=_(()=>{if(o.value)return{};const d=`${e.sidebarWidth}px`;return{width:d,minWidth:"200px",maxWidth:"30vw","--sidebar-width":d}});function a(){e.showModal("create-project")}const r=L(!1);function l(d){r.value=!0,document.addEventListener("mousemove",c),document.addEventListener("mouseup",p)}function c(d){r.value&&e.setSidebarWidth(d.clientX)}function p(){r.value=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",p)}return(d,h)=>(u(),m("aside",{id:"sidebar",class:z(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value}]),style:Re(i.value)},[t("div",Wy,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[h[0]||(h[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," 📁 New ")]),t("div",Fy,[ne(Hy)])]),t("div",{class:"sidebar-resize-handle",onMousedown:l},null,32)],6))}},By=K(Uy,[["__scopeId","data-v-d792f0f0"]]),qy={class:"modal-dialog modal-lg"},zy={class:"modal-content"},Ky={class:"modal-body"},Yy={class:"mb-3"},Gy={class:"input-group"},Jy=["disabled"],Xy={key:0,class:"text-center py-4"},Qy={key:1,class:"alert alert-danger",role:"alert"},Zy={key:2,class:"folder-list"},e1=["onClick","onDblclick"],t1={class:"d-flex align-items-center flex-grow-1"},s1=["onClick"],n1={key:1,class:"text-center text-muted py-3"},o1={class:"modal-footer"},i1=["disabled"],a1={__name:"FolderBrowserModal",setup(n){const e=de(),s=L(""),o=L(""),i=L([]),a=L(!1),r=L(""),l=L(null);let c=null,p=null;const d=_(()=>{if(!s.value)return null;const C=s.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?C.join("/"):"/")});function h(C){if(!C)return"";const T=C.split(/[\\/]/).filter(Boolean);return T.length<=2?C:".../"+T.slice(-2).join("/")}async function b(){a.value=!0,r.value="",i.value=[],o.value="";try{const C=s.value?{path:s.value}:{},T=await Z.get("/api/filesystem/browse",{params:C});T.current_path&&(s.value=T.current_path),i.value=T.directories||[]}catch(C){console.error("Failed to load directory:",C),r.value=C.message||"Failed to load directory"}finally{a.value=!1}}function v(C){o.value=C.path}function w(C){s.value=C.path,o.value="",b()}function y(){d.value&&(s.value=d.value,o.value="",b())}function g(){const C=o.value||s.value;C&&p&&p(C),c&&c.hide()}function f(){b()}function M(){i.value=[],o.value="",r.value="",p=null,e.hideModal()}return re(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&c){const T=C.data||{};s.value=T.currentPath||"",p=T.onSelect||null,c.show()}}),ue(()=>{l.value&&ge(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{c=new C(l.value),l.value.addEventListener("shown.bs.modal",f),l.value.addEventListener("hidden.bs.modal",M)})}),he(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",f),l.value.removeEventListener("hidden.bs.modal",M)),c&&c.dispose()}),(C,T)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[t("div",qy,[t("div",zy,[T[7]||(T[7]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ky,[t("div",Yy,[T[2]||(T[2]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Gy,[ee(t("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=D=>s.value=D),onKeyup:Xt(b,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[ce,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:b,disabled:a.value},[...T[1]||(T[1]=[t("i",{class:"bi bi-arrow-clockwise"},null,-1),q(" Refresh ",-1)])],8,Jy)])]),a.value?(u(),m("div",Xy,[...T[3]||(T[3]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(u(),m("div",Qy,$(r.value),1)):(u(),m("div",Zy,[d.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:y,role:"button"},[...T[4]||(T[4]=[t("i",{class:"bi bi-arrow-up-circle me-2 text-secondary"},null,-1),t("span",{class:"text-secondary"},"..",-1)])])):P("",!0),(u(!0),m(se,null,ie(i.value,D=>(u(),m("div",{key:D.path,class:z(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:D.path===o.value}]),onClick:I=>v(D),onDblclick:I=>w(D),role:"button"},[t("div",t1,[T[5]||(T[5]=t("i",{class:"bi bi-folder-fill me-2 text-warning"},null,-1)),t("span",null,$(D.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:_e(I=>w(D),["stop"])}," Open ",8,s1)],42,e1))),128)),i.value.length===0?(u(),m("div",n1," No subdirectories found ")):P("",!0)]))]),t("div",o1,[T[6]||(T[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:!o.value},' Select "'+$(h(o.value||s.value))+'" ',9,i1)])])])],512))}},r1=K(a1,[["__scopeId","data-v-667c51a9"]]),l1={class:"modal-dialog"},c1={class:"modal-content"},d1={class:"modal-body"},u1={class:"mb-3"},m1={key:0,class:"invalid-feedback"},p1={class:"mb-3"},f1={class:"input-group"},v1={key:0,class:"invalid-feedback"},h1={class:"mb-3 form-check"},_1={class:"mb-3 form-check"},g1={class:"form-check-label",for:"createSession"},b1={key:0,class:"mb-3 ms-4"},y1={for:"sessionName",class:"form-label"},$1={key:1,class:"alert alert-danger",role:"alert"},w1={class:"modal-footer"},E1=["disabled"],C1={key:0,class:"spinner-border spinner-border-sm me-2"},S1={__name:"ProjectCreateModal",setup(n){const e=fe(),s=te(),o=de(),i=L({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=L({name:"",workingDirectory:""}),r=L(!1),l=L(""),c=L(null);let p=null;function d(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:g=>{i.value.workingDirectory=g,a.value.workingDirectory=""}})}function h(){a.value={};let g=!0;return i.value.name.trim()||(a.value.name="Project name is required",g=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",g=!1),g}async function b(){if(h()){r.value=!0,l.value="";try{const g=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await s.createSession(g.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),p&&p.hide(),v()}catch(g){console.error("Failed to create project:",g),l.value=g.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function v(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},l.value=""}function w(){const g=document.getElementById("projectName");g&&g.focus()}function y(){v(),o.hideModal()}return re(()=>o.currentModal,g=>{g?.name==="create-project"&&p&&p.show()}),ue(()=>{c.value&&ge(async()=>{const{default:g}=await import("./modal-B4rHLo2F.js").then(f=>f.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{p=new g(c.value),c.value.addEventListener("shown.bs.modal",w),c.value.addEventListener("hidden.bs.modal",y)})}),he(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",w),c.value.removeEventListener("hidden.bs.modal",y)),p&&p.dispose()}),(g,f)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",l1,[t("div",c1,[f[11]||(f[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",d1,[t("form",{onSubmit:_e(b,["prevent"])},[t("div",u1,[f[5]||(f[5]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ee(t("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":f[0]||(f[0]=M=>i.value.name=M),placeholder:"My Project",required:""},null,2),[[ce,i.value.name]]),a.value.name?(u(),m("div",m1,$(a.value.name),1)):P("",!0)]),t("div",p1,[f[6]||(f[6]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",f1,[ee(t("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":f[1]||(f[1]=M=>i.value.workingDirectory=M),placeholder:"/path/to/project",required:""},null,2),[[ce,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:d}," Browse... "),a.value.workingDirectory?(u(),m("div",v1,$(a.value.workingDirectory),1)):P("",!0)]),f[7]||(f[7]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",h1,[ee(t("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":f[2]||(f[2]=M=>i.value.isMultiAgent=M)},null,512),[[At,i.value.isMultiAgent]]),f[8]||(f[8]=t("label",{class:"form-check-label",for:"isMultiAgent"}," 🏛 Multi-Agent Project (Legion) ",-1)),f[9]||(f[9]=t("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),t("div",_1,[ee(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":f[3]||(f[3]=M=>i.value.createSession=M)},null,512),[[At,i.value.createSession]]),t("label",g1," Create initial "+$(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(u(),m("div",b1,[t("label",y1," Initial "+$(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),ee(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":f[4]||(f[4]=M=>i.value.sessionName=M),placeholder:"main"},null,512),[[ce,i.value.sessionName]])])):P("",!0),l.value?(u(),m("div",$1,$(l.value),1)):P("",!0)],32)]),t("div",w1,[f[10]||(f[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:r.value},[r.value?(u(),m("span",C1)):P("",!0),q(" "+$(r.value?"Creating...":"Create Project"),1)],8,E1)])])])],512))}},k1=K(S1,[["__scopeId","data-v-adf50394"]]),T1={class:"modal-dialog"},x1={class:"modal-content"},A1={class:"modal-body"},M1={class:"mb-3"},O1={key:0,class:"invalid-feedback"},N1={class:"mb-3"},L1=["value"],D1={key:0,class:"alert alert-danger",role:"alert"},I1={class:"danger-zone"},P1={class:"text-muted small"},j1=["disabled"],R1={key:0,class:"alert alert-warning mt-3",role:"alert"},V1={class:"mb-2"},H1={class:"d-flex gap-2"},W1=["disabled"],F1={key:0,class:"spinner-border spinner-border-sm me-2"},U1=["disabled"],B1={class:"modal-footer"},q1=["disabled"],z1={key:0,class:"spinner-border spinner-border-sm me-2"},K1={__name:"ProjectEditModal",setup(n){const e=fe(),s=de(),o=L(null),i=L({name:""}),a=L({name:""}),r=L(!1),l=L(!1),c=L(""),p=L(!1),d=L(null);let h=null;const b=_(()=>o.value?.session_ids?.length||0);function v(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Project name is required",C=!1),C}async function w(){if(!(!v()||!o.value)){r.value=!0,c.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),h&&h.hide()}catch(C){console.error("Failed to update project:",C),c.value=C.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function y(){if(o.value){l.value=!0,c.value="";try{await e.deleteProject(o.value.project_id),h&&h.hide()}catch(C){console.error("Failed to delete project:",C),c.value=C.message||"Failed to delete project. Please try again."}finally{l.value=!1}}}function g(){i.value={name:""},a.value={},c.value="",p.value=!1}function f(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function M(){g(),o.value=null,s.hideModal()}return re(()=>s.currentModal,C=>{if(C?.name==="edit-project"&&h){const T=C.data||{};o.value=T.project,o.value&&(i.value.name=o.value.name),h.show()}}),ue(()=>{d.value&&ge(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{h=new C(d.value),d.value.addEventListener("shown.bs.modal",f),d.value.addEventListener("hidden.bs.modal",M)})}),he(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",f),d.value.removeEventListener("hidden.bs.modal",M)),h&&h.dispose()}),(C,T)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",T1,[t("div",x1,[T[11]||(T[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",A1,[t("form",{onSubmit:_e(w,["prevent"])},[t("div",M1,[T[3]||(T[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ee(t("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":T[0]||(T[0]=D=>i.value.name=D),placeholder:"My Project",required:""},null,2),[[ce,i.value.name]]),a.value.name?(u(),m("div",O1,$(a.value.name),1)):P("",!0)]),t("div",N1,[T[4]||(T[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,L1),T[5]||(T[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),c.value?(u(),m("div",D1,$(c.value),1)):P("",!0)],32),T[9]||(T[9]=t("hr",null,null,-1)),t("div",I1,[T[7]||(T[7]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",P1," Deleting this project will also delete all "+$(b.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:T[1]||(T[1]=D=>p.value=!0),disabled:l.value},[...T[6]||(T[6]=[t("i",{class:"bi bi-trash"},null,-1),q(" Delete Project ",-1)])],8,j1)]),p.value?(u(),m("div",R1,[T[8]||(T[8]=t("strong",null,"Are you sure?",-1)),t("p",V1,' This will permanently delete the project "'+$(o.value?.name)+'" and all '+$(b.value)+" session(s). ",1),t("div",H1,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:y,disabled:l.value},[l.value?(u(),m("span",F1)):P("",!0),q(" "+$(l.value?"Deleting...":"Yes, Delete Permanently"),1)],8,W1),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:T[2]||(T[2]=D=>p.value=!1),disabled:l.value}," Cancel ",8,U1)])])):P("",!0)]),t("div",B1,[T[10]||(T[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:r.value},[r.value?(u(),m("span",z1)):P("",!0),q(" "+$(r.value?"Saving...":"Save Changes"),1)],8,q1)])])])],512))}},Y1=K(K1,[["__scopeId","data-v-6f299f35"]]),G1={class:"modal-dialog modal-lg"},J1={class:"modal-content"},X1={class:"modal-header"},Q1={class:"modal-title",id:"createSessionModalLabel"},Z1={key:0,class:"text-muted small"},e$={class:"modal-body"},t$={class:"mb-3"},s$={key:0,class:"invalid-feedback"},n$={class:"mb-3"},o$={class:"mb-3"},i$={class:"mb-3"},a$={class:"form-text d-flex justify-content-between"},r$={key:0,class:"invalid-feedback"},l$={class:"mb-3 form-check"},c$={key:0,class:"form-text text-warning"},d$={class:"mb-3"},u$={class:"mb-3 form-check"},m$={key:0,class:"alert alert-danger",role:"alert"},p$={class:"modal-footer"},f$=["disabled"],v$={key:0,class:"spinner-border spinner-border-sm me-2"},h$={__name:"SessionCreateModal",setup(n){const e=Ye();fe();const s=te(),o=de(),i=L(null),a=L({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0}),r=L({name:""}),l=L(!1),c=L(""),p=L(null);let d=null;const h=_(()=>a.value.system_prompt.length),b=_(()=>h.value>6e3),v=_(()=>h.value>5500&&h.value<=6e3);function w(){r.value={};let C=!0;return a.value.name.trim()||(r.value.name="Session name is required",C=!1),b.value&&(C=!1),C}async function y(){if(!(!w()||!i.value)){l.value=!0,c.value="";try{const C=a.value.tools.split(",").map(I=>I.trim()).filter(I=>I.length>0),T={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,tools:C},D=await s.createSession(i.value.project_id,T);a.value.startImmediately&&await s.startSession(D.session_id),e.push(`/session/${D.session_id}`),d&&d.hide(),g()}catch(C){console.error("Failed to create session:",C),c.value=C.message||"Failed to create session. Please try again."}finally{l.value=!1}}}function g(){a.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0},r.value={},c.value=""}function f(){const C=document.getElementById("sessionName");C&&C.focus()}function M(){g(),i.value=null,o.hideModal()}return re(()=>o.currentModal,C=>{if(C?.name==="create-session"&&d){const T=C.data||{};i.value=T.project,d.show()}}),ue(()=>{p.value&&ge(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{d=new C(p.value),p.value.addEventListener("shown.bs.modal",f),p.value.addEventListener("hidden.bs.modal",M)})}),he(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",f),p.value.removeEventListener("hidden.bs.modal",M)),d&&d.dispose()}),(C,T)=>(u(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",G1,[t("div",J1,[t("div",X1,[t("h5",Q1,[T[7]||(T[7]=q(" Create New Session ",-1)),i.value?(u(),m("span",Z1,"in "+$(i.value.name),1)):P("",!0)]),T[8]||(T[8]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",e$,[t("form",{onSubmit:_e(y,["prevent"])},[t("div",t$,[T[9]||(T[9]=t("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),ee(t("input",{type:"text",class:z(["form-control",{"is-invalid":r.value.name}]),id:"sessionName","onUpdate:modelValue":T[0]||(T[0]=D=>a.value.name=D),placeholder:"main",required:""},null,2),[[ce,a.value.name]]),r.value.name?(u(),m("div",s$,$(r.value.name),1)):P("",!0)]),t("div",n$,[T[11]||(T[11]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ee(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":T[1]||(T[1]=D=>a.value.permission_mode=D)},[...T[10]||(T[10]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"⚠️ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Me,a.value.permission_mode]]),T[12]||(T[12]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",o$,[T[14]||(T[14]=t("label",{for:"model",class:"form-label"},"Model",-1)),ee(t("select",{class:"form-select",id:"model","onUpdate:modelValue":T[2]||(T[2]=D=>a.value.model=D)},[...T[13]||(T[13]=[t("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),t("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),t("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[Me,a.value.model]])]),t("div",i$,[T[15]||(T[15]=t("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),ee(t("textarea",{class:z(["form-control",{"is-invalid":b.value}]),id:"systemPrompt","onUpdate:modelValue":T[3]||(T[3]=D=>a.value.system_prompt=D),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[ce,a.value.system_prompt]]),t("div",a$,[t("span",null,$(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),t("span",{class:z({"text-danger":b.value,"text-warning":v.value})},$(h.value)+" / 6000 chars ",3)]),b.value?(u(),m("div",r$," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):P("",!0)]),t("div",l$,[ee(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":T[4]||(T[4]=D=>a.value.override_system_prompt=D)},null,512),[[At,a.value.override_system_prompt]]),T[17]||(T[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),m("div",c$,[...T[16]||(T[16]=[t("small",null,"⚠️ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):P("",!0)]),t("div",d$,[T[18]||(T[18]=t("label",{for:"tools",class:"form-label"},"Allowed Tools (Optional)",-1)),ee(t("input",{type:"text",class:"form-control",id:"tools","onUpdate:modelValue":T[5]||(T[5]=D=>a.value.tools=D),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[ce,a.value.tools]]),T[19]||(T[19]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",u$,[ee(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":T[6]||(T[6]=D=>a.value.startImmediately=D)},null,512),[[At,a.value.startImmediately]]),T[20]||(T[20]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),c.value?(u(),m("div",m$,$(c.value),1)):P("",!0)],32)]),t("div",p$,[T[21]||(T[21]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:l.value},[l.value?(u(),m("span",v$)):P("",!0),q(" "+$(l.value?"Creating...":"Create Session"),1)],8,f$)])])])],512))}},_$=K(h$,[["__scopeId","data-v-5aef47e0"]]),g$={class:"modal-dialog"},b$={class:"modal-content"},y$={class:"modal-body"},$$={class:"mb-3"},w$={key:0,class:"invalid-feedback"},E$={class:"mb-3"},C$=["value"],S$={class:"mb-3"},k$={class:"form-control-plaintext"},T$={class:"mb-3"},x$=["disabled"],A$={key:0,value:"bypassPermissions"},M$={class:"form-text"},O$={key:0,class:"text-warning"},N$={key:1},L$={key:0,class:"mb-3"},D$={class:"card"},I$={class:"card-body"},P$={key:0,class:"mb-2"},j$={key:1,class:"mb-2"},R$={key:2,class:"mt-2"},V$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},H$={key:1,class:"alert alert-danger",role:"alert"},W$={class:"modal-footer"},F$=["disabled"],U$={key:0,class:"spinner-border spinner-border-sm me-2"},B$={__name:"SessionEditModal",setup(n){const e=te(),s=de(),o=L(null),i=L({name:"",permission_mode:"default"}),a=L({name:""}),r=L(!1),l=L(""),c=L(null);let p=null;const d=_(()=>o.value?.state==="active"||o.value?.state==="starting"),h=_(()=>o.value?.initial_permission_mode==="bypassPermissions");function b(M){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[M]||"bg-secondary"}function v(){a.value={};let M=!0;return i.value.name.trim()||(a.value.name="Session name is required",M=!1),M}async function w(){if(!(!v()||!o.value)){r.value=!0,l.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),p&&p.hide()}catch(M){console.error("Failed to update session:",M),l.value=M.message||"Failed to update session. Please try again."}finally{r.value=!1}}}function y(){i.value={name:"",permission_mode:"default"},a.value={},l.value=""}function g(){const M=document.getElementById("editSessionName");M&&(M.focus(),M.select())}function f(){y(),o.value=null,s.hideModal()}return re(()=>s.currentModal,M=>{if(M?.name==="edit-session"&&p){const C=M.data||{};o.value=C.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),p.show()}}),ue(()=>{c.value&&ge(async()=>{const{default:M}=await import("./modal-B4rHLo2F.js").then(C=>C.m);return{default:M}},__vite__mapDeps([0,1])).then(({default:M})=>{p=new M(c.value),c.value.addEventListener("shown.bs.modal",g),c.value.addEventListener("hidden.bs.modal",f)})}),he(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",g),c.value.removeEventListener("hidden.bs.modal",f)),p&&p.dispose()}),(M,C)=>(u(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",g$,[t("div",b$,[C[15]||(C[15]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",y$,[t("form",{onSubmit:_e(w,["prevent"])},[t("div",$$,[C[2]||(C[2]=t("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),ee(t("input",{type:"text",class:z(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":C[0]||(C[0]=T=>i.value.name=T),placeholder:"Session Name",required:""},null,2),[[ce,i.value.name]]),a.value.name?(u(),m("div",w$,$(a.value.name),1)):P("",!0)]),t("div",E$,[C[3]||(C[3]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,C$),C[4]||(C[4]=t("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),t("div",S$,[C[5]||(C[5]=t("label",{class:"form-label"},"Current State",-1)),t("div",k$,[t("span",{class:z(["badge",b(o.value?.state)])},$(o.value?.state),3)])]),t("div",T$,[C[9]||(C[9]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ee(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":C[1]||(C[1]=T=>i.value.permission_mode=T),disabled:!d.value},[C[6]||(C[6]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),C[7]||(C[7]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),C[8]||(C[8]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),h.value?(u(),m("option",A$,"⚠️ Bypass Permissions (No prompts)")):P("",!0)],8,x$),[[Me,i.value.permission_mode]]),t("div",M$,[d.value?(u(),m("span",N$," Controls which tool actions require permission prompts ")):(u(),m("span",O$," ⚠️ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),m("div",L$,[C[13]||(C[13]=t("label",{class:"form-label"},"System Prompt Configuration",-1)),t("div",D$,[t("div",I$,[o.value?.override_system_prompt?(u(),m("div",P$,[...C[10]||(C[10]=[t("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),t("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),m("div",j$,[...C[11]||(C[11]=[t("span",{class:"badge bg-info"},"Append Mode",-1),t("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),m("div",R$,[C[12]||(C[12]=t("strong",{class:"small"},"Custom Instructions:",-1)),t("div",V$,$(o.value.system_prompt),1)])):P("",!0)])])])):P("",!0),l.value?(u(),m("div",H$,$(l.value),1)):P("",!0)],32)]),t("div",W$,[C[14]||(C[14]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:r.value},[r.value?(u(),m("span",U$)):P("",!0),q(" "+$(r.value?"Saving...":"Save Changes"),1)],8,F$)])])])],512))}},q$=K(B$,[["__scopeId","data-v-c99ca17f"]]),z$={class:"modal-dialog modal-dialog-centered"},K$={class:"modal-content"},Y$={class:"modal-header"},G$={class:"modal-title",id:"manageSessionModalLabel"},J$={class:"modal-body"},X$={key:0,class:"text-center py-4"},Q$={class:"text-muted"},Z$={key:1},ew={key:2},tw={class:"text-muted"},sw={key:3},nw={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},ow={class:"d-grid gap-2"},iw=["disabled"],aw=["disabled"],rw=["disabled"],lw=["disabled"],cw={class:"modal-footer"},dw={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},uw={__name:"SessionManageModal",setup(n){const e=Ye(),s=te(),o=de(),i=He();De();const a=L(null),r=L(!1),l=L(""),c=L(""),p=L(null),d=L(null);let h=null;const b=_(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function v(){p.value="reset"}function w(){p.value="delete"}function y(){p.value=null}async function g(){p.value==="reset"?await C():p.value==="delete"&&await T()}async function f(){if(a.value){r.value=!0,l.value="Restarting session...";try{const E=a.value.session_id,k=await Z.post(`/api/sessions/${E}/restart`);if(k.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(E),h&&h.hide();else{const R=k.error||k.detail||"Failed to restart session";console.error("Failed to restart session:",R),c.value=`Failed to restart session: ${R}`}}catch(E){console.error("Error restarting session:",E);const k=E.data?.detail||E.message||"Unknown error";c.value=`Error restarting session: ${k}`}finally{r.value=!1}}}async function M(){if(a.value)try{h&&h.hide(),console.log("Ending session",a.value.session_id);const E=a.value.session_id;await Z.post(`/api/sessions/${E}/terminate`),await i.disconnectSession(),s.currentSessionId===E&&(s.currentSessionId=null),e.push("/")}catch(E){console.error("Error ending session:",E),await i.disconnectSession(),s.currentSessionId===a.value?.session_id&&(s.currentSessionId=null),e.push("/")}}async function C(){if(a.value){r.value=!0,l.value="Resetting session...";try{const E=a.value.session_id,k=await Z.post(`/api/sessions/${E}/reset`);if(k.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(E),h&&h.hide();else{const R=k.error||k.detail||"Failed to reset session";console.error("Failed to reset session:",R),c.value=`Failed to reset session: ${R}`,p.value=null}}catch(E){console.error("Error resetting session:",E);const k=E.data?.detail||E.message||"Unknown error";c.value=`Error resetting session: ${k}`,p.value=null}finally{r.value=!1}}}async function T(){if(a.value){r.value=!0,l.value="Deleting session...";try{const E=a.value.session_id;await s.deleteSession(E),e.currentRoute.value.params.sessionId===E&&e.push("/"),h&&h.hide()}catch(E){console.error("Error deleting session:",E);const k=E.data?.detail||E.message||"Unknown error";c.value=`Error deleting session: ${k}`,p.value=null}finally{r.value=!1}}}function D(){p.value=null,r.value=!1,l.value="",c.value=""}function I(){D(),a.value=null,o.hideModal()}return re(()=>o.currentModal,E=>{if(E?.name==="manage-session"&&h){const k=E.data||{};a.value=k.session,D(),h.show()}}),ue(()=>{d.value&&ge(async()=>{const{default:E}=await import("./modal-B4rHLo2F.js").then(k=>k.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{h=new E(d.value),d.value.addEventListener("hidden.bs.modal",I)})}),he(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",I),h&&h.dispose()}),(E,k)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",z$,[t("div",K$,[t("div",Y$,[t("h5",G$,$(p.value?b.value:"Manage Session"),1),k[1]||(k[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",J$,[r.value?(u(),m("div",X$,[k[2]||(k[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Q$,$(l.value),1)])):p.value==="reset"?(u(),m("div",Z$,[...k[3]||(k[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"⚠️ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(u(),m("div",ew,[k[6]||(k[6]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"⚠️ Warning: This action cannot be undone")],-1)),t("p",tw,[k[4]||(k[4]=q("This will permanently delete session ",-1)),t("strong",null,$(a.value?.name),1),k[5]||(k[5]=q(".",-1))]),k[7]||(k[7]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(u(),m("div",sw,[c.value?(u(),m("div",nw,[k[8]||(k[8]=t("strong",null,"Error:",-1)),q(" "+$(c.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:k[0]||(k[0]=R=>c.value="")})])):P("",!0),k[15]||(k[15]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",ow,[t("button",{class:"btn btn-outline-primary text-start",onClick:f,disabled:r.value},[...k[9]||(k[9]=[t("strong",null,"🔄 Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,iw),t("button",{class:"btn btn-outline-secondary text-start",onClick:M,disabled:r.value},[...k[10]||(k[10]=[t("strong",null,"🚪 End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,aw),k[13]||(k[13]=t("hr",{class:"my-2"},null,-1)),k[14]||(k[14]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"⚠️ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:v,disabled:r.value},[...k[11]||(k[11]=[t("strong",null,"🗑️ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,rw),t("button",{class:"btn btn-outline-danger text-start",onClick:w,disabled:r.value},[...k[12]||(k[12]=[t("strong",null,"❌ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,lw)]),k[16]||(k[16]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),q(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",cw,[p.value&&!r.value?(u(),m(se,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancel"),t("button",{type:"button",class:z(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:g},$(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?P("",!0):(u(),m("button",dw,"Cancel"))])])])],512))}},mw=K(uw,[["__scopeId","data-v-de7ff18c"]]),pw={class:"modal-dialog modal-dialog-centered modal-lg"},fw={class:"modal-content"},vw={class:"modal-body"},hw={key:0,class:"text-center text-muted py-4"},_w={key:1},gw={class:"mb-3"},bw={class:"font-monospace small"},yw={class:"mb-3"},$w={class:"font-monospace small"},ww={class:"mb-3"},Ew={class:"mb-3"},Cw={class:"mb-3"},Sw={key:0},kw={class:"d-flex flex-wrap gap-1"},Tw={key:1,class:"text-muted small"},xw={key:0,class:"mb-3"},Aw={class:"d-flex flex-wrap gap-1"},Mw={key:1,class:"mb-3"},Ow={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},Nw={class:"mb-3"},Lw={class:"text-muted"},Dw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},Iw={__name:"SessionInfoModal",setup(n){const e=te(),s=De(),o=de(),i=L(null),a=L(!1),r=L(null);let l=null;const c=_(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(s.messagesBySession.get(i.value)||[]).find(y=>y.type==="system"&&(y.subtype==="init"||y.metadata?.subtype==="init")&&y.metadata?.init_data)?.metadata?.init_data||null});function p(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function d(){i.value=null,a.value=!1}function h(){d(),o.hideModal()}return re(()=>o.currentModal,b=>{if(b?.name==="session-info"&&l){const v=b.data||{};i.value=v.sessionId,a.value=!1,l.show()}}),ue(()=>{r.value&&ge(async()=>{const{default:b}=await import("./modal-B4rHLo2F.js").then(v=>v.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{l=new b(r.value),r.value.addEventListener("hidden.bs.modal",h)})}),he(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",h),l&&l.dispose()}),(b,v)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",pw,[t("div",fw,[v[9]||(v[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",vw,[c.value?(u(),m("div",_w,[t("div",gw,[v[1]||(v[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",bw,$(i.value),1)]),t("div",yw,[v[2]||(v[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("div",$w,$(c.value.cwd||"Not specified"),1)]),t("div",ww,[v[3]||(v[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,$(c.value.model||"Default"),1)]),t("div",Ew,[v[4]||(v[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,$(c.value.permissionMode||"default"),1)]),t("div",Cw,[v[5]||(v[5]=t("h6",{class:"text-muted"},"Available Tools",-1)),c.value.tools&&c.value.tools.length>0?(u(),m("div",Sw,[t("div",kw,[(u(!0),m(se,null,ie(c.value.tools,w=>(u(),m("span",{key:w,class:"badge bg-secondary"},$(w),1))),128))])])):(u(),m("div",Tw,"All tools available"))]),c.value.commands&&c.value.commands.length>0?(u(),m("div",xw,[v[6]||(v[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",Aw,[(u(!0),m(se,null,ie(c.value.commands,w=>(u(),m("span",{key:w,class:"badge bg-info"},$(w),1))),128))])])):P("",!0),c.value.systemPrompt?(u(),m("div",Mw,[v[7]||(v[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",Ow,$(p(c.value.systemPrompt)),1)])):P("",!0),t("div",Nw,[t("h6",Lw,[v[8]||(v[8]=q(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:v[0]||(v[0]=w=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(u(),m("pre",Dw,$(JSON.stringify(c.value,null,2)),1)):P("",!0)])])):(u(),m("div",hw," No session configuration data available "))]),v[10]||(v[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},Pw=K(Iw,[["__scopeId","data-v-809e2099"]]),jw={class:"modal-dialog modal-dialog-centered"},Rw={class:"modal-content"},Vw={class:"modal-body"},Hw={class:"mb-3"},Ww=["value"],Fw={key:0,class:"form-text"},Uw={class:"mb-3"},Bw={class:"mb-3"},qw=["placeholder"],zw={class:"form-text"},Kw={key:0,class:"text-info ms-2"},Yw={class:"mb-3"},Gw={class:"form-text d-flex justify-content-between"},Jw={key:0,class:"text-info ms-2"},Xw={key:0,class:"invalid-feedback"},Qw={class:"mb-3 form-check"},Zw={key:0,class:"form-text text-warning"},eE={class:"mb-3"},tE={class:"mb-3"},sE={class:"form-text"},nE={key:0,class:"text-info ms-2"},oE={class:"mb-3"},iE={class:"form-text"},aE={key:0,class:"text-info ms-2"},rE={key:0,class:"alert alert-danger"},lE={class:"modal-footer"},cE=["disabled"],dE={key:0,class:"spinner-border spinner-border-sm me-2"},uE={__name:"CreateMinionModal",setup(n){const e=Ye(),s=fe(),o=te(),i=de(),a=L(null);let r=null;const l=L(null),c=L([]),p=L(null),d=L(new Set),h=L({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:""}),b=L(""),v=L(""),w=L(!1),y=_(()=>b.value.trim()?b.value.split(",").map(O=>O.trim()).filter(O=>O.length>0):[]),g=_(()=>h.value.allowed_tools.trim()?h.value.allowed_tools.split(",").map(O=>O.trim()).filter(O=>O.length>0):null),f=_(()=>h.value.initialization_context.length),M=_(()=>f.value>2e3),C=_(()=>f.value>1800&&f.value<=2e3),T=_(()=>p.value?c.value.find(O=>O.template_id===p.value):null),D=_(()=>T.value?.default_role||"e.g., Code Expert, Testing Specialist"),I=O=>d.value.has(O);async function E(){try{console.log("[CreateMinionModal] Loading templates...");const O=await Z.get("/api/templates");console.log("[CreateMinionModal] Templates data:",O),c.value=O||[],console.log("[CreateMinionModal] Templates set to:",c.value)}catch(O){console.error("[CreateMinionModal] Failed to load templates:",O),c.value=[]}}function k(){if(d.value.clear(),!T.value){h.value.role="",h.value.initialization_context="",h.value.permission_mode="default",h.value.allowed_tools="";return}const O=T.value;O.default_role&&(h.value.role=O.default_role,d.value.add("role")),O.default_system_prompt&&(h.value.initialization_context=O.default_system_prompt,d.value.add("initialization_context")),O.permission_mode&&(h.value.permission_mode=O.permission_mode,d.value.add("permission_mode")),O.allowed_tools&&O.allowed_tools.length>0&&(h.value.allowed_tools=O.allowed_tools.join(", "),d.value.add("allowed_tools"))}function R(){i.showModal("template-management",{})}function N(){h.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:""},b.value="",p.value=null,d.value.clear(),v.value="",w.value=!1}function A(){N(),i.hideModal()}async function S(){if(!h.value.name.trim()){v.value="Minion name is required";return}if(h.value.name.includes(" ")){v.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(M.value){v.value="Initialization context exceeds 2000 character limit";return}if(!l.value){v.value="Legion ID is missing";return}w.value=!0,v.value="";try{const O={name:h.value.name.trim(),role:h.value.role.trim(),initialization_context:h.value.initialization_context.trim(),override_system_prompt:h.value.override_system_prompt,capabilities:y.value,permission_mode:h.value.permission_mode,allowed_tools:g.value},x=await Z.post(`/api/legions/${l.value}/minions`,O);x.success&&x.minion_id?(await s.fetchProjects(),await o.fetchSessions(),r&&r.hide(),e.push(`/spy/${l.value}/${x.minion_id}`)):v.value="Failed to create minion"}catch(O){console.error("Failed to create minion:",O),v.value=O.response?.data?.detail||"Failed to create minion"}finally{w.value=!1}}return re(()=>i.currentModal,(O,x)=>{if(O?.name==="create-minion"&&r){const j=O.data||{};l.value=j.project?.project_id||null,N(),E(),r.show()}else x?.name==="template-management"&&r&&a.value?.classList.contains("show")&&E()}),ue(()=>{a.value&&ge(()=>import("./modal-B4rHLo2F.js").then(O=>O.m),__vite__mapDeps([0,1])).then(O=>{const x=O.default;r=new x(a.value),a.value.addEventListener("hidden.bs.modal",A)}),E()}),he(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",A),r&&r.dispose()}),(O,x)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[t("div",jw,[t("div",Rw,[x[30]||(x[30]=t("div",{class:"modal-header"},[t("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Vw,[t("form",{onSubmit:_e(S,["prevent"])},[t("div",Hw,[t("label",{for:"template-select",class:"form-label"},[x[9]||(x[9]=q(" Template ",-1)),t("button",{type:"button",onClick:R,class:"btn btn-link btn-sm p-0 ms-2"},[...x[8]||(x[8]=[t("i",{class:"bi-gear"},null,-1),q(" Manage Templates ",-1)])])]),ee(t("select",{id:"template-select","onUpdate:modelValue":x[0]||(x[0]=j=>p.value=j),onChange:k,class:"form-select"},[x[10]||(x[10]=t("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(se,null,ie(c.value,j=>(u(),m("option",{key:j.template_id,value:j.template_id},$(j.name),9,Ww))),128))],544),[[Me,p.value]]),T.value?(u(),m("div",Fw,$(T.value.description),1)):P("",!0)]),t("div",Uw,[x[11]||(x[11]=t("label",{for:"minion-name",class:"form-label"},[q(" Name "),t("span",{class:"text-danger"},"*")],-1)),ee(t("input",{id:"minion-name","onUpdate:modelValue":x[1]||(x[1]=j=>h.value.name=j),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[ce,h.value.name]]),x[12]||(x[12]=t("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),t("div",Bw,[x[15]||(x[15]=t("label",{for:"minion-role",class:"form-label"},"Role",-1)),ee(t("input",{id:"minion-role","onUpdate:modelValue":x[2]||(x[2]=j=>h.value.role=j),type:"text",class:"form-control",placeholder:D.value},null,8,qw),[[ce,h.value.role]]),t("div",zw,[x[14]||(x[14]=q(" Optional role description for the minion ",-1)),I("role")?(u(),m("span",Kw,[...x[13]||(x[13]=[t("i",{class:"bi-lightning-fill"},null,-1),q(" From template ",-1)])])):P("",!0)])]),t("div",Yw,[x[17]||(x[17]=t("label",{for:"minion-context",class:"form-label"},"Initialization Context",-1)),ee(t("textarea",{id:"minion-context","onUpdate:modelValue":x[3]||(x[3]=j=>h.value.initialization_context=j),class:z(["form-control",{"is-invalid":M.value}]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion..."},null,2),[[ce,h.value.initialization_context]]),t("div",Gw,[t("span",null,[q($(h.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset")+" ",1),I("initialization_context")?(u(),m("span",Jw,[...x[16]||(x[16]=[t("i",{class:"bi-lightning-fill"},null,-1),q(" From template ",-1)])])):P("",!0)]),t("span",{class:z({"text-danger":M.value,"text-warning":C.value})},$(f.value)+" / 2000 chars ",3)]),M.value?(u(),m("div",Xw," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):P("",!0)]),t("div",Qw,[ee(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":x[4]||(x[4]=j=>h.value.override_system_prompt=j)},null,512),[[At,h.value.override_system_prompt]]),x[19]||(x[19]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),h.value.override_system_prompt?(u(),m("div",Zw,[...x[18]||(x[18]=[t("small",null,"⚠️ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):P("",!0)]),t("div",eE,[x[20]||(x[20]=t("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),ee(t("input",{id:"minion-capabilities","onUpdate:modelValue":x[5]||(x[5]=j=>b.value=j),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[ce,b.value]]),x[21]||(x[21]=t("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),t("div",tE,[x[25]||(x[25]=t("label",{for:"permission-mode",class:"form-label"},"Permission Mode",-1)),ee(t("select",{class:"form-select",id:"permission-mode","onUpdate:modelValue":x[6]||(x[6]=j=>h.value.permission_mode=j)},[...x[22]||(x[22]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"⚠️ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Me,h.value.permission_mode]]),t("div",sE,[x[24]||(x[24]=q(" Controls which tool actions require permission prompts ",-1)),I("permission_mode")?(u(),m("span",nE,[...x[23]||(x[23]=[t("i",{class:"bi-lightning-fill"},null,-1),q(" From template ",-1)])])):P("",!0)])]),t("div",oE,[x[28]||(x[28]=t("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),ee(t("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":x[7]||(x[7]=j=>h.value.allowed_tools=j),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[ce,h.value.allowed_tools]]),t("div",iE,[x[27]||(x[27]=q(" Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1)),I("allowed_tools")?(u(),m("span",aE,[...x[26]||(x[26]=[t("i",{class:"bi-lightning-fill"},null,-1),q(" From template ",-1)])])):P("",!0)])]),v.value?(u(),m("div",rE,$(v.value),1)):P("",!0)],32)]),t("div",lE,[x[29]||(x[29]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",disabled:!h.value.name.trim()||w.value,onClick:S},[w.value?(u(),m("span",dE)):P("",!0),q(" "+$(w.value?"Creating...":"Create Minion"),1)],8,cE)])])])],512))}},mE=K(uE,[["__scopeId","data-v-1cf9d058"]]),pE={class:"modal-dialog modal-dialog-centered modal-lg"},fE={class:"modal-content"},vE={class:"modal-body"},hE={key:0,class:"text-center text-muted py-4"},_E={key:1},gE={class:"mb-3"},bE={class:"mb-3"},yE={class:"font-monospace small"},$E={class:"mb-3"},wE={class:"mb-3"},EE={class:"mb-3"},CE={key:0},SE={class:"d-flex flex-wrap gap-1"},kE={key:1,class:"text-muted small"},TE={class:"mb-3"},xE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},AE={key:1,class:"text-muted small"},ME={class:"mb-3"},OE={key:0,class:"badge bg-info"},NE={key:1,class:"badge bg-secondary"},LE={class:"mb-3"},DE={key:0,class:"font-monospace small"},IE={key:1,class:"text-muted small"},PE={key:0,class:"mb-3"},jE={key:0},RE={class:"list-unstyled mb-0"},VE={key:1,class:"text-muted small"},HE={class:"mb-3"},WE={key:0,class:"font-monospace small"},FE={key:1,class:"text-muted small"},UE={class:"mb-3"},BE={key:0},qE={class:"d-flex flex-wrap gap-1"},zE={key:1,class:"text-muted small"},KE={class:"mb-3"},YE={class:"small"},GE={class:"mb-3"},JE={class:"small"},XE={__name:"MinionViewModal",setup(n){const e=de(),s=L(null),o=L(null);let i=null;function a(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function r(p){if(!p)return"N/A";try{const d=new Date(p);return isNaN(d.getTime())?"Invalid date":d.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(d){return console.error("Error formatting timestamp:",d),"Invalid date"}}function l(){s.value=null}function c(){l(),e.hideModal()}return re(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&i){const d=p.data||{};s.value=d.session,i.show()}}),ue(()=>{o.value&&ge(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(d=>d.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{i=new p(o.value),o.value.addEventListener("hidden.bs.modal",c)})}),he(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",c),i&&i.dispose()}),(p,d)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",pE,[t("div",fE,[d[13]||(d[13]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",vE,[s.value?(u(),m("div",_E,[t("div",gE,[d[0]||(d[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,$(s.value.name||"Unnamed Minion"),1)]),t("div",bE,[d[1]||(d[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",yE,$(s.value.session_id),1)]),t("div",$E,[d[2]||(d[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,$(s.value.role||"Not specified"),1)]),t("div",wE,[d[3]||(d[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:z(["badge",a(s.value.state)])},$(s.value.state),3)])]),t("div",EE,[d[4]||(d[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(u(),m("div",CE,[t("div",SE,[(u(!0),m(se,null,ie(s.value.capabilities,h=>(u(),m("span",{key:h,class:"badge bg-secondary"},$(h),1))),128))])])):(u(),m("div",kE,"None"))]),t("div",TE,[d[5]||(d[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(u(),m("div",xE,$(s.value.initialization_context),1)):(u(),m("div",AE,"Not specified"))]),t("div",ME,[d[6]||(d[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(u(),m("span",OE,"Yes")):(u(),m("span",NE,"No"))])]),t("div",LE,[d[7]||(d[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(u(),m("div",DE,$(s.value.parent_overseer_id),1)):(u(),m("div",IE,$(s.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),s.value.is_overseer?(u(),m("div",PE,[d[8]||(d[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(u(),m("div",jE,[t("ul",RE,[(u(!0),m(se,null,ie(s.value.child_minion_ids,h=>(u(),m("li",{key:h,class:"font-monospace small"},$(h),1))),128))])])):(u(),m("div",VE,"No children"))])):P("",!0),t("div",HE,[d[9]||(d[9]=t("h6",{class:"text-muted"},"Horde Membership",-1)),s.value.horde_id?(u(),m("div",WE,$(s.value.horde_id),1)):(u(),m("div",FE,"Not in a horde"))]),t("div",UE,[d[10]||(d[10]=t("h6",{class:"text-muted"},"Channel Memberships",-1)),s.value.channel_ids&&s.value.channel_ids.length>0?(u(),m("div",BE,[t("div",qE,[(u(!0),m(se,null,ie(s.value.channel_ids,h=>(u(),m("span",{key:h,class:"badge bg-info"},$(h),1))),128))])])):(u(),m("div",zE,"No channels"))]),t("div",KE,[d[11]||(d[11]=t("h6",{class:"text-muted"},"Created",-1)),t("div",YE,$(r(s.value.created_at)),1)]),t("div",GE,[d[12]||(d[12]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",JE,$(r(s.value.updated_at)),1)])])):(u(),m("div",hE," No minion data available "))]),d[14]||(d[14]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},QE=K(XE,[["__scopeId","data-v-c44eaee2"]]),ZE={class:"modal-dialog modal-lg"},eC={class:"modal-content"},tC={class:"modal-body"},sC={key:0,class:"template-list"},nC={key:0,class:"alert alert-info"},oC={class:"card-body"},iC={class:"d-flex justify-content-between align-items-start"},aC={class:"flex-grow-1"},rC={class:"card-title mb-1"},lC={class:"card-text text-muted small mb-2"},cC={class:"template-meta"},dC={class:"badge bg-secondary me-2"},uC={class:"text-muted small"},mC={class:"btn-group btn-group-sm ms-3"},pC=["onClick"],fC=["onClick"],vC={key:1,class:"template-form"},hC={class:"mb-3"},_C={class:"mb-3"},gC={class:"mb-3"},bC={class:"mb-3"},yC={class:"mb-3"},$C={class:"mb-3"},wC={class:"mb-3"},EC={key:0,class:"alert alert-danger"},CC={class:"d-flex gap-2"},SC=["disabled"],kC={key:0,class:"spinner-border spinner-border-sm me-2"},TC={__name:"TemplateManagementModal",setup(n){const e=de(),s=L(null);let o=null;const i=L([]),a=L(null),r=L(""),l=L(""),c=L(!1);async function p(){try{const g=await Z.get("/api/templates");i.value=g||[]}catch(g){console.error("Failed to load templates:",g),i.value=[]}}function d(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},r.value="",l.value=""}function h(g){a.value={...g},r.value=g.allowed_tools?.join(", ")||"",l.value=""}async function b(){if(!a.value.name.trim()){l.value="Template name is required";return}c.value=!0,l.value="";try{const g=r.value.split(",").map(C=>C.trim()).filter(C=>C.length>0),f={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:g.length>0?g:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await Z.post("/api/templates",f):await Z.put(`/api/templates/${a.value.template_id}`,f),await p(),a.value=null,r.value=""}catch(g){console.error("Failed to save template:",g),l.value=g.response?.data?.detail||"Failed to save template"}finally{c.value=!1}}async function v(g){if(confirm(`Delete template "${g.name}"?

This action cannot be undone.`))try{await Z.delete(`/api/templates/${g.template_id}`),await p()}catch(f){console.error("Failed to delete template:",f),alert(`Failed to delete template: ${f.response?.data?.detail||f.message}`)}}function w(){a.value=null,r.value="",l.value=""}function y(){a.value=null,r.value="",l.value="",e.hideModal()}return re(()=>e.currentModal,g=>{g?.name==="template-management"&&o&&(p(),o.show())}),ue(()=>{s.value&&ge(()=>import("./modal-B4rHLo2F.js").then(g=>g.m),__vite__mapDeps([0,1])).then(g=>{const f=g.default;o=new f(s.value),s.value.addEventListener("hidden.bs.modal",y)})}),he(()=>{s.value&&s.value.removeEventListener("hidden.bs.modal",y),o&&o.dispose()}),(g,f)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[t("div",ZE,[t("div",eC,[f[15]||(f[15]=t("div",{class:"modal-header"},[t("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",tC,[a.value?P("",!0):(u(),m("div",sC,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[f[6]||(f[6]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:d,class:"btn btn-primary btn-sm"}," ➕ Create New ")]),i.value.length===0?(u(),m("div",nC," No templates found. Create your first template! ")):P("",!0),(u(!0),m(se,null,ie(i.value,M=>(u(),m("div",{key:M.template_id,class:"card mb-2"},[t("div",oC,[t("div",iC,[t("div",aC,[t("h6",rC,$(M.name),1),t("p",lC,$(M.description),1),t("div",cC,[t("span",dC,$(M.permission_mode),1),t("span",uC,$(M.allowed_tools?.length||0)+" tools",1)])]),t("div",mC,[t("button",{onClick:C=>h(M),class:"btn btn-outline-primary",title:"Edit"}," ✏️ ",8,pC),t("button",{onClick:C=>v(M),class:"btn btn-outline-danger",title:"Delete"}," 🗑️ ",8,fC)])])])]))),128))])),a.value?(u(),m("div",vC,[t("h6",hC,$(a.value.template_id?"Edit Template":"Create Template"),1),t("div",_C,[f[7]||(f[7]=t("label",{for:"template-name",class:"form-label"},[q(" Name "),t("span",{class:"text-danger"},"*")],-1)),ee(t("input",{id:"template-name","onUpdate:modelValue":f[0]||(f[0]=M=>a.value.name=M),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[ce,a.value.name]])]),t("div",gC,[f[8]||(f[8]=t("label",{for:"template-description",class:"form-label"},"Description",-1)),ee(t("textarea",{id:"template-description","onUpdate:modelValue":f[1]||(f[1]=M=>a.value.description=M),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[ce,a.value.description]])]),t("div",bC,[f[10]||(f[10]=t("label",{for:"template-permission-mode",class:"form-label"},[q(" Permission Mode "),t("span",{class:"text-danger"},"*")],-1)),ee(t("select",{id:"template-permission-mode","onUpdate:modelValue":f[2]||(f[2]=M=>a.value.permission_mode=M),class:"form-select",required:""},[...f[9]||(f[9]=[t("option",{value:"default"},"Default",-1),t("option",{value:"acceptEdits"},"Accept Edits",-1),t("option",{value:"plan"},"Plan Mode",-1),t("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Me,a.value.permission_mode]])]),t("div",yC,[f[11]||(f[11]=t("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),ee(t("input",{id:"template-tools","onUpdate:modelValue":f[3]||(f[3]=M=>r.value=M),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[ce,r.value]]),f[12]||(f[12]=t("div",{class:"form-text"},"Comma-separated list of tools",-1))]),t("div",$C,[f[13]||(f[13]=t("label",{for:"template-role",class:"form-label"},"Default Role",-1)),ee(t("input",{id:"template-role","onUpdate:modelValue":f[4]||(f[4]=M=>a.value.default_role=M),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[ce,a.value.default_role]])]),t("div",wC,[f[14]||(f[14]=t("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),ee(t("textarea",{id:"template-prompt","onUpdate:modelValue":f[5]||(f[5]=M=>a.value.default_system_prompt=M),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[ce,a.value.default_system_prompt]])]),l.value?(u(),m("div",EC,$(l.value),1)):P("",!0),t("div",CC,[t("button",{onClick:b,class:"btn btn-primary",disabled:c.value},[c.value?(u(),m("span",kC)):P("",!0),q(" "+$(c.value?"Saving...":"Save Template"),1)],8,SC),t("button",{onClick:w,class:"btn btn-secondary"},"Cancel")])])):P("",!0)])])])],512))}},xC=K(TC,[["__scopeId","data-v-81126ff4"]]),AC={class:"container-fluid vh-100 d-flex flex-column p-0"},MC={class:"d-flex flex-grow-1 overflow-hidden position-relative"},OC={class:"flex-grow-1 d-flex flex-column overflow-hidden"},NC={__name:"App",setup(n){const e=de(),s=He(),o=te(),i=fe(),a=Ye(),r=_(()=>e.sidebarCollapsed),l=_(()=>e.isMobile);ue(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const d=window.location.hash;if(d.startsWith("#/session/")){const h=d.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(d.startsWith("#/timeline/")){const h=d.replace("#/timeline/","");a.push(`/timeline/${h}`)}window.addEventListener("popstate",c),window.addEventListener("resize",e.handleResize)}),he(()=>{window.removeEventListener("popstate",c),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function c(){const d=window.location.hash;if(d.startsWith("#/session/")){const h=d.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function p(){e.toggleSidebar()}return(d,h)=>{const b=io("router-view");return u(),m("div",AC,[ne(Sf),t("div",{id:"sidebar-backdrop",class:z({show:!r.value&&l.value}),onClick:p},null,2),t("div",MC,[ne(By),t("main",OC,[ne(b)])]),ne(r1),ne(k1),ne(Y1),ne(_$),ne(q$),ne(mw),ne(Pw),ne(mE),ne(QE),ne(xC)])}}},an=vi(NC);an.use(hi());an.use(hf);an.mount("#app");
