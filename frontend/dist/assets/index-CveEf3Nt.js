const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as p,a as s,o as d,d as gt,r as D,b as v,t as $,n as je,e as K,f as Y,u as Jt,w as le,g as fn,h as I,F as se,i as ae,j as we,k as no,l as te,v as pe,m as ie,p as me,q as Os,s as Xt,x as he,y as be,z as Fe,A as oo,B as pi,C as mi,D as Ke,T as io,E as At,G as fi,H as vi}from"./vue-vendor-Dbs_RS4O.js";import{m as Mt,p as Vs}from"./markdown-vendor-CQ3OZdP9.js";import{c as hi}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const _i={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},gi={__name:"NoSessionSelected",setup(n){return(e,t)=>(d(),p("div",_i,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},bi="modulepreload",yi=function(n){return"/"+n},vn={},$e=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let l=function(m){return Promise.all(m.map(c=>Promise.resolve(c).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),u=r?.nonce||r?.getAttribute("nonce");i=l(t.map(m=>{if(m=yi(m),m in vn)return;vn[m]=!0;const c=m.endsWith(".css"),b=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${b}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":bi,c||(h.as="script"),h.crossOrigin="",h.href=m,u&&h.setAttribute("nonce",u),document.head.appendChild(h),c)return new Promise((f,C)=>{h.addEventListener("load",f),h.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(r){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=r,window.dispatchEvent(u),!u.defaultPrevented)throw r}return i.then(r=>{for(const u of r||[])u.status==="rejected"&&a(u.reason);return e().catch(a)})};class ps extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function Ot(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new ps(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof ps?t:(console.error("API request failed:",t),new ps(`Network error: ${t.message}`,0,null))}}async function $i(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[u,l]of Object.entries(e.params))l!=null&&o.append(u,l);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...r}=e;return Ot(t,{...r,method:"GET"})}return Ot(t,{...e,method:"GET"})}async function wi(n,e,t={}){return Ot(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Ei(n,e,t={}){return Ot(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ci(n,e={}){return Ot(n,{...e,method:"DELETE"})}const Z={get:$i,post:wi,put:Ei,delete:Ci},ee=gt("session",()=>{const n=D(new Map),e=D(null),t=D(new Map),o=D(new Map),i=D(new Set),a=D(!1);let r=null;const u=v(()=>n.value.get(e.value)),l=v(()=>Array.from(n.value.values()).sort((A,x)=>A.order-x.order)),m=A=>v(()=>l.value.filter(x=>x.project_id===A)),c=v({get:()=>t.value.get(e.value)||"",set:A=>{e.value&&t.value.set(e.value,A)}});async function b(){try{const A=await Z.get("/api/sessions");return n.value.clear(),A.sessions.forEach(x=>{n.value.set(x.session_id,x)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function h(A,x){try{const S=(await Z.post("/api/sessions",{project_id:A,...x})).session_id,k=(await Z.get(`/api/sessions/${S}`)).session;return n.value.set(S,k),n.value=new Map(n.value),console.log(`Created session ${S}`),k}catch(N){throw console.error("Failed to create session:",N),N}}async function f(A){if(e.value===A&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${A}`),r.abort(),r=null);const x=new AbortController;r=x,a.value=!0;try{if(e.value=A,x.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let N=n.value.get(A);if(!N)try{const k=await Z.get(`/api/sessions/${A}`);if(x.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}N=k.session,n.value.set(A,N),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(k){console.error(`Failed to fetch session ${A}:`,k);return}if(N&&(N.state==="created"||N.state==="terminated"))try{if(await M(A),x.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${N.state} state)`);const k=6e4,O=200,L=5e3;let R=0,F=0;for(;R<k;){if(x.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const ne=n.value.get(A);if(ne&&ne.state==="active"){console.log(`Session ${A} is now active after ${R}ms`);break}if(R-F>=L){const re=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${re}, ${R/1e3}s elapsed)`),F=R}await new Promise(re=>setTimeout(re,O)),R+=O}const B=n.value.get(A);B&&B.state!=="active"&&console.warn(`Session ${A} did not become active within ${k/1e3}s (state: ${B.state}), continuing anyway`)}catch(k){console.error(`Failed to auto-start session ${A}:`,k)}if(x.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await $e(()=>Promise.resolve().then(()=>Ui),void 0)).useMessageStore().loadMessages(A),x.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}await(await $e(()=>Promise.resolve().then(()=>ua),void 0)).useWebSocketStore().connectSession(A),x.signal.aborted||console.log(`Selected session ${A}`)}finally{r===x&&(r=null),a.value=!1}}function C(A,x){const N=n.value.get(A);N?Object.assign(N,x):(n.value.set(A,x),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function _(A){i.value.add(A);try{await Z.delete(`/api/sessions/${A}`),n.value.delete(A),t.value.delete(A),o.value.delete(A),n.value=new Map(n.value),e.value===A&&(e.value=null),console.log(`Deleted session ${A}`)}catch(x){throw console.error("Failed to delete session:",x),x}finally{i.value.delete(A)}}async function g(A,x){try{await Z.put(`/api/sessions/${A}/name`,{name:x}),C(A,{name:x}),console.log(`Updated session ${A} name to "${x}"`)}catch(N){throw console.error("Failed to update session name:",N),N}}async function y(A,x){try{await Z.post(`/api/sessions/${A}/permission-mode`,{mode:x}),C(A,{current_permission_mode:x});const N=o.value.get(A);N&&(N.permissionMode=x,o.value.set(A,N)),console.log(`Set permission mode for session ${A} to ${x}`)}catch(N){throw console.error("Failed to set permission mode:",N),N}}async function M(A){try{await Z.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(x){throw console.error("Failed to start session:",x),x}}async function T(A){try{await Z.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(x){throw console.error("Failed to pause session:",x),x}}async function w(A){try{await Z.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(x){throw console.error("Failed to terminate session:",x),x}}function P(A){return n.value.get(A)}function j(A,x){o.value.set(A,x),x.permissionMode&&C(A,{current_permission_mode:x.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:u,orderedSessions:l,sessionsInProject:m,currentInput:c,fetchSessions:b,createSession:h,selectSession:f,updateSession:C,deleteSession:_,updateSessionName:g,setPermissionMode:y,startSession:M,pauseSession:T,terminateSession:w,getSession:P,storeInitData:j}}),hn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ee},Symbol.toStringTag,{value:"Module"})),ce=gt("ui",()=>{const n=D(window.innerWidth<768),e=D(300),t=D(window.innerWidth),o=v(()=>t.value<768),i=D(!0),a=D(null),r=D(null),u=v(()=>a.value?{name:a.value,data:r.value}:null),l=D(!1),m=D("Loading...");function c(){n.value=!n.value}function b(T){n.value=T}function h(T){e.value=Math.max(200,Math.min(T,window.innerWidth*.3))}function f(T){i.value=T}function C(T,w=null){a.value=null,r.value=null,setTimeout(()=>{a.value=T,r.value=w},0)}function _(){a.value=null,r.value=null}function g(T="Loading..."){l.value=!0,m.value=T}function y(){l.value=!1}function M(){const T=t.value;t.value=window.innerWidth,t.value<768&&T>=768?n.value=!0:t.value>=768&&T<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:u,isLoading:l,loadingMessage:m,toggleSidebar:c,setSidebarCollapsed:b,setSidebarWidth:h,setAutoScroll:f,showModal:C,hideModal:_,showLoading:g,hideLoading:y,handleResize:M}}),ve=gt("project",()=>{const n=D(new Map),e=D(null),t=v(()=>n.value.get(e.value)),o=v(()=>Array.from(n.value.values()).sort((_,g)=>_.order-g.order)),i=_=>n.value.get(_)?.is_multi_agent||!1;async function a(){try{const _=await Z.get("/api/projects");return n.value.clear(),_.projects.forEach(g=>{n.value.set(g.project_id,g)}),console.log(`Loaded ${n.value.size} projects`),_.projects}catch(_){throw console.error("Failed to fetch projects:",_),_}}async function r(_,g,y=!1){try{const T=(await Z.post("/api/projects",{name:_,working_directory:g,is_multi_agent:y})).project;return n.value.set(T.project_id,T),n.value=new Map(n.value),console.log(`Created project ${T.project_id}`),T}catch(M){throw console.error("Failed to create project:",M),M}}async function u(_,g){try{await Z.put(`/api/projects/${_}`,g),l(_,g),console.log(`Updated project ${_}`,g)}catch(y){throw console.error("Failed to update project:",y),y}}function l(_,g){const y=n.value.get(_);y&&(Object.assign(y,g),n.value=new Map(n.value))}async function m(_){try{await Z.delete(`/api/projects/${_}`),n.value.delete(_),n.value=new Map(n.value),e.value===_&&(e.value=null),console.log(`Deleted project ${_}`)}catch(g){throw console.error("Failed to delete project:",g),g}}async function c(_){try{const g=await Z.put(`/api/projects/${_}/toggle-expansion`),y=n.value.get(_);return y&&(y.is_expanded=g.is_expanded,n.value=new Map(n.value)),g.is_expanded}catch(g){throw console.error("Failed to toggle expansion:",g),g}}async function b(_){try{await Z.put("/api/projects/reorder",{project_ids:_}),_.forEach((g,y)=>{const M=n.value.get(g);M&&(M.order=y)}),n.value=new Map(n.value),console.log("Reordered projects",_)}catch(g){throw console.error("Failed to reorder projects:",g),g}}async function h(_,g){try{await Z.put(`/api/projects/${_}/sessions/reorder`,{session_ids:g});const y=n.value.get(_);y&&(y.session_ids=g,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${_}`,g)}catch(y){throw console.error("Failed to reorder sessions:",y),y}}function f(_){return n.value.get(_)}function C(_){if(!_)return"";const g=_.split(/[/\\]/).filter(y=>y);return g.length===0?"/":g.length===1?`/${g[0]}`:g.length===2?`/${g.join("/")}`:`.../${g.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:r,updateProject:u,updateProjectLocal:l,deleteProject:m,toggleExpansion:c,reorderProjects:b,reorderSessionsInProject:h,getProject:f,formatPath:C}}),G=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Si={class:"session-header border-bottom p-3"},Ti={class:"project-name"},ki=["title"],xi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ee(),o=ve(),i=v(()=>t.sessions.get(e.sessionId)),a=v(()=>i.value?.name||e.sessionId),r=v(()=>{for(const l of o.projects.values())if(l.session_ids?.includes(e.sessionId))return l;return null}),u=v(()=>r.value?.name||"Unknown Project");return(l,m)=>(d(),p("div",Si,[s("div",null,[s("div",Ti,$(u.value),1),s("div",{class:"session-name",title:n.sessionId},$(a.value),9,ki)])]))}},Ai=G(xi,[["__scopeId","data-v-89e9c269"]]),Mi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Oi=["title"],Ni={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Di={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ee(),o=v(()=>t.sessions.get(e.sessionId)),i=v(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=v(()=>{const l=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[l]||"#d3d3d3"}),r=v(()=>{const l=i.value;return l==="starting"||l==="processing"||l==="pending-prompt"}),u=v(()=>{if(!o.value)return"No session selected";const l=i.value,m=l.charAt(0).toUpperCase()+l.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",b=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${b}: ${m}`});return(l,m)=>(d(),p("div",Mi,[o.value?(d(),p("div",{key:0,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:je({width:"100%",backgroundColor:a.value}),title:u.value},null,14,Oi)):(d(),p("div",Ni))]))}},Li=G(Di,[["__scopeId","data-v-e8795bb7"]]),Ii={class:"session-status-bar border-top p-2 bg-light"},Pi={class:"d-flex justify-content-between align-items-center gap-2"},ji={class:"d-flex gap-2"},Ri=["disabled"],Vi={class:"mode-label"},Hi=["disabled"],Wi=["disabled"],Fi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ee(),o=ce(),i=v(()=>t.sessions.get(e.sessionId)),a=v(()=>i.value?.current_permission_mode||"default"),r={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},u=v(()=>r[a.value]||"ðŸ”’"),l=v(()=>a.value),m=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(y){console.error("Failed to cycle permission mode:",y)}return}const _=(m.indexOf(a.value)+1)%m.length,g=m[_];try{await t.setPermissionMode(e.sessionId,g)}catch(y){console.error("Failed to cycle permission mode:",y)}},b=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:i.value})},f=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(C,_)=>(d(),p("div",Ii,[s("div",Pi,[s("div",ji,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[Y($(u.value)+" ",1),s("span",Vi,$(l.value),1)],8,Ri),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:b,disabled:!i.value},[..._[0]||(_[0]=[Y(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Hi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[..._[1]||(_[1]=[Y(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,Wi)]),s("div",null,[s("button",{class:K(["btn btn-sm",Jt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:f}," â¬‡ï¸ "+$(Jt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Bi=G(Fi,[["__scopeId","data-v-fdcd3535"]]),De=gt("message",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(new Map),u=v(()=>{const k=ee();return n.value.get(k.currentSessionId)||[]}),l=v(()=>{const k=ee();return e.value.get(k.currentSessionId)||[]});async function m(k,O=null,L=0){try{const R=O||1e4,F=await Z.get(`/api/sessions/${k}/messages?limit=${R}&offset=${L}`),B=F.messages||[],ne=F.total_count||B.length,re=F.has_more||!1;if(console.log(`Loaded ${B.length} of ${ne} messages for session ${k}`),n.value.set(k,B),B.length>0){const Q=B[B.length-1];Q.timestamp&&(r.value.set(k,Q.timestamp),console.log(`Tracked last received timestamp for session ${k}: ${Q.timestamp}`))}const ue=new Set;B.forEach(Q=>{Q.type==="assistant"&&Q.metadata?.tool_uses&&Q.metadata.tool_uses.forEach(U=>{ue.add(U.id)}),Q.type==="user"&&Q.metadata?.tool_results&&Q.metadata.tool_results.forEach(U=>{ue.delete(U.tool_use_id);const oe=a.value.get(k);oe&&oe.delete(U.tool_use_id)}),Q.type==="system"&&Q.metadata?.subtype==="client_launched"&&(ue.forEach(U=>{w(k,U,"Session was restarted")}),ue.clear()),Q.type==="system"&&Q.metadata?.subtype==="interrupt"&&(ue.forEach(U=>{w(k,U,"Session was interrupted")}),ue.clear()),Q.metadata?.has_tool_uses&&Q.metadata.tool_uses&&Q.metadata.tool_uses.forEach(U=>{C(k,U)}),Q.metadata?.has_tool_results&&Q.metadata.tool_results&&Q.metadata.tool_results.forEach(U=>{y(k,U)}),(Q.type==="permission_request"||Q.metadata?.has_permission_requests)&&_(k,Q),Q.type==="system"&&(Q.subtype==="init"||Q.metadata?.subtype==="init")&&Q.metadata?.init_data&&ee().storeInitData(k,Q.metadata.init_data)});const fe=ee().sessions.get(k);return fe&&!["active","paused","starting"].includes(fe.state)&&(ue.forEach(Q=>{w(k,Q,"Session was terminated")}),ue.clear()),i.value.set(k,ue),n.value=new Map(n.value),re&&console.warn(`Warning: Only loaded ${B.length} of ${ne} messages. Some messages may be missing.`),{messages:B,totalCount:ne,hasMore:re}}catch(R){throw console.error("Failed to load messages:",R),R}}function c(k,O){const L=i.value.get(k)||new Set;O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(R=>{L.add(R.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(R=>{L.delete(R.tool_use_id);const F=a.value.get(k);F&&F.delete(R.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(L.forEach(R=>{w(k,R,"Session was restarted")}),L.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(L.forEach(R=>{w(k,R,"Session was interrupted")}),L.clear()),i.value.set(k,L)}function b(k,O){n.value.has(k)||n.value.set(k,[]);const L=n.value.get(k);if(O.id){const R=L.findIndex(F=>F.id===O.id);if(R!==-1){console.log(`Skipping duplicate message ${O.id} (already exists at index ${R})`);return}}L.push(O),O.timestamp&&r.value.set(k,O.timestamp),c(k,O),n.value=new Map(n.value)}function h(k,O){e.value.has(k)||e.value.set(k,[]),e.value.get(k).push(O),e.value=new Map(e.value)}function f(k,O,L){const R=e.value.get(k);if(R){const F=R.find(B=>B.id===O);F&&(Object.assign(F,L),e.value=new Map(e.value))}}function C(k,O){const L=T(O.name,O.input);t.value.set(L,O.id);const R={id:O.id,name:O.name,input:O.input,signature:L,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return h(k,R),console.log(`Created tool call ${R.id} for ${R.name}`),R}function _(k,O){console.log("handlePermissionRequest received:",O);const L=O.metadata?.tool_name||O.tool_name,R=O.metadata?.input_params||O.input_params,F=O.metadata?.request_id||O.request_id,B=O.metadata?.suggestions||O.suggestions||[];console.log("Extracted data:",{toolName:L,inputParams:R,requestId:F,suggestions:B});const ne=T(L,R),re=t.value.get(ne);re?(o.value.set(F,re),f(k,re,{status:"permission_required",permissionRequestId:F,suggestions:B}),console.log(`Permission required for tool ${re}`,{suggestions:B})):console.warn("No tool use ID found for permission request signature:",ne,{toolName:L,inputParams:R,availableSignatures:Array.from(t.value.keys())})}function g(k,O){const L=o.value.get(O.request_id);if(L){const R={permissionDecision:O.decision,appliedUpdates:O.applied_updates||[]};O.decision==="allow"?R.status="executing":(R.status="completed",R.result={error:!0,message:O.reasoning||"Permission denied"},R.isExpanded=!1),f(k,L,R),console.log(`Permission ${O.decision} for tool ${L}`)}}function y(k,O){const L=O.tool_use_id;f(k,L,{status:O.is_error?"error":"completed",result:{error:O.is_error,content:O.content},isExpanded:!1}),console.log(`Tool ${L} ${O.is_error?"failed":"completed"}`)}function M(k,O){const L=e.value.get(k);if(L){const R=L.find(F=>F.id===O);R&&(R.isExpanded=!R.isExpanded,e.value=new Map(e.value))}}function T(k,O){if(!k)return"unknown:{}";if(!O||typeof O!="object")return`${k}:{}`;const L=JSON.stringify(O,Object.keys(O).sort());return`${k}:${L}`}function w(k,O,L){const R=a.value.get(k)||new Map;R.set(O,{reason:"denied",message:L}),a.value.set(k,R);const F=e.value.get(k);if(F){const B=F.find(ne=>ne.id===O);B&&B.isExpanded&&(B.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${O} as orphaned: ${L}`)}function P(k,O){return a.value.get(k)?.has(O)||!1}function j(k,O){return a.value.get(k)?.get(O)}function A(k,O){const L=i.value.get(k);L&&L.size>0&&(L.forEach(R=>w(k,R,O)),L.clear())}function x(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}function N(k){return r.value.get(k)}async function S(k){const O=r.value.get(k);if(!O)return console.log(`No sync needed for session ${k} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${k} since ${O}`);const L=await Z.get(`/api/sessions/${k}/messages?limit=1000&offset=0`),R=L.messages||[],F=L.has_more||!1,B=U=>U?typeof U=="number"?U*1e3:new Date(U).getTime():0,ne=B(O),re=R.filter(U=>U.timestamp?B(U.timestamp)>ne:!1);if(re.length===0)return console.log(`No missed messages for session ${k}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${re.length} missed messages for session ${k}`);const ue=n.value.get(k)||[],He=new Set(ue.map(U=>U.id).filter(Boolean)),fe=re.filter(U=>!U.id||!He.has(U.id));if(console.log(`After deduplication: ${fe.length} unique new messages`),fe.length>0){const U=fe.sort((X,J)=>{const de=B(X.timestamp),Ct=B(J.timestamp);return de-Ct}),oe=n.value.get(k)||[],H=oe.length>0?B(oe[oe.length-1].timestamp):0,W=B(U[0].timestamp),q=B(U[U.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:oe.length,lastExisting:H,lastExistingDate:oe.length>0?oe[oe.length-1].timestamp:"none",firstNew:W,firstNewDate:U[0].timestamp,lastNew:q,lastNewDate:U[U.length-1].timestamp,shouldAppend:W>H}),W>H){const X=[...oe,...U];n.value.set(k,X),console.log(`âœ… Appended ${U.length} new messages (no full sort needed)`)}else{const X=[...oe,...U].sort((J,de)=>{const Ct=B(J.timestamp),Rt=B(de.timestamp);return Ct-Rt});n.value.set(k,X),console.log(`âš ï¸ Merged and sorted ${U.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${ue.length} messages unchanged`);fe.forEach(U=>{c(k,U),U.metadata?.has_tool_uses&&U.metadata.tool_uses&&U.metadata.tool_uses.forEach(oe=>{C(k,oe)}),U.metadata?.has_tool_results&&U.metadata.tool_results&&U.metadata.tool_results.forEach(oe=>{y(k,oe)}),(U.type==="permission_request"||U.metadata?.has_permission_requests)&&_(k,U),U.type==="system"&&(U.subtype==="init"||U.metadata?.subtype==="init")&&U.metadata?.init_data&&ee().storeInitData(k,U.metadata.init_data)});const Q=n.value.get(k);if(Q&&Q.length>0){const U=Q[Q.length-1];U.timestamp&&r.value.set(k,U.timestamp)}return n.value=new Map(n.value),{syncedCount:fe.length,hasMore:F}}catch(L){return console.error(`Failed to sync messages for session ${k}:`,L),{syncedCount:0,hasMore:!1,error:L.message}}}const E=ee();return le(()=>Array.from(E.sessions.values()).map(O=>({id:O.session_id,state:O.state})),(k,O)=>{O&&k.forEach((L,R)=>{const F=O[R];if(!F||F.id!==L.id)return;const B=["active","paused","starting"].includes(F.state),ne=!["active","paused","starting"].includes(L.state);B&&ne&&A(L.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:fn(i),orphanedToolUses:fn(a),currentMessages:u,currentToolCalls:l,loadMessages:m,addMessage:b,addToolCall:h,updateToolCall:f,handleToolUse:C,handlePermissionRequest:_,handlePermissionResponse:g,handleToolResult:y,toggleToolExpansion:M,clearMessages:x,markToolUseOrphaned:w,isToolUseOrphaned:P,getOrphanedInfo:j,clearOrphanedToolUses:A,getLastReceivedTimestamp:N,syncMessages:S}}),Ui=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:De},Symbol.toStringTag,{value:"Module"}));function qi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function ss(n){return qi(n).toLocaleTimeString()}const zi={class:"message-row message-row-user"},Ki=["title"],Yi={class:"message-content-column"},Gi=["innerHTML"],Ji={key:0,class:"tool-results mt-2"},Xi={class:"tool-results-header text-muted small mb-2"},Qi={class:"d-flex align-items-start gap-2"},Zi={class:"flex-grow-1"},ea={class:"text-muted"},ta={key:0,class:"text-danger small"},sa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Mt.setOptions({breaks:!0,gfm:!0});const t=v(()=>ss(e.message.timestamp)),o=v(()=>`user
${t.value}`),i=v(()=>{const l=e.message.content||"";let m=Mt.parse(l);return m=m.replace(/\n</g,"<"),m=m.replace(/\n+$/,""),Vs.sanitize(m)}),a=v(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=v(()=>e.message.metadata?.tool_results||[]);function u(l,m){return l?l.length<=m?l:l.substring(0,m)+"...":""}return(l,m)=>(d(),p("div",zi,[s("div",{class:"message-speaker",title:o.value},[...m[0]||(m[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,Ki),s("div",Yi,[s("div",{class:"message-text",innerHTML:i.value},null,8,Gi),a.value?(d(),p("div",Ji,[s("div",Xi,[m[1]||(m[1]=s("i",{class:"bi bi-tools"},null,-1)),Y(" Tool Results ("+$(r.value.length)+") ",1)]),(d(!0),p(se,null,ae(r.value,(c,b)=>(d(),p("div",{key:b,class:K(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",Qi,[s("span",null,$(c.is_error?"âŒ":"âœ…"),1),s("div",Zi,[s("small",ea,"Tool: "+$(c.tool_use_id),1),c.is_error?(d(),p("div",ta,$(u(c.content,200)),1)):I("",!0)])])],2))),128))])):I("",!0)])]))}},na=G(sa,[["__scopeId","data-v-09875214"]]),oa={class:"thinking-block"},ia={class:"text-muted ms-auto"},aa={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ra=["innerHTML"],la={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=D(!1),o=v(()=>e.thinking?.length||0),i=v(()=>{const r=e.thinking||"",u=Mt.parse(r);return Vs.sanitize(u)});function a(){t.value=!t.value}return(r,u)=>(d(),p("div",oa,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("i",{class:K(["bi",t.value?"bi-chevron-down":"bi-chevron-right"])},null,2),u[0]||(u[0]=s("span",{class:"thinking-label"},[s("i",{class:"bi bi-lightbulb"}),Y(" Thinking ")],-1)),s("small",ia,$(o.value)+" characters",1)]),t.value?(d(),p("div",aa,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ra)])):I("",!0)]))}},ca=G(la,[["__scopeId","data-v-619a8344"]]),Ye=gt("websocket",()=>{const n=D(null),e=D(!1),t=D(0),o=10,i=D(null),a=D(!1),r=D(0),u=5,l=D(null);let m=null;const c=D(0),b=D(null),h=D(new Map),f=D(null),C=D(!1),_=D(0),g=5,y=D(null),M=5e3,T=1e3,w=D(Date.now()),P=D(Date.now()),j=D(Date.now());let A=null,x=null,N=null;const S=v(()=>e.value&&(a.value||!l.value)?"connected":e.value?"partial":"disconnected");function E(H){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${H}`}function k(H){const W={ui:{timer:()=>A,setTimer:q=>{A=q},lastPing:w,connected:e,name:"UI"},session:{timer:()=>x,setTimer:q=>{x=q},lastPing:P,connected:a,name:"Session"},legion:{timer:()=>N,setTimer:q=>{N=q},lastPing:j,connected:C,name:"Legion"}}[H];W.timer()&&clearInterval(W.timer()),W.setTimer(setInterval(()=>{if(!W.connected.value)return;const q=Date.now()-W.lastPing.value;if(q>M){console.warn(`âš ï¸ ${W.name} WebSocket heartbeat timeout (${q}ms since last ping) - forcing close to trigger reconnection`),W.connected.value=!1;const J={ui:n,session:i,legion:f}[H];J.value&&J.value.readyState===WebSocket.OPEN&&J.value.close()}},T)),console.log(`âœ… Started heartbeat monitor for ${W.name} WebSocket`)}function O(H){const W={ui:{get:()=>A,set:q=>{A=q}},session:{get:()=>x,set:q=>{x=q}},legion:{get:()=>N,set:q=>{N=q}}}[H];W.get()&&(clearInterval(W.get()),W.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${H} WebSocket`))}function L(){if(n.value)return;const H=E("/ws/ui");console.log(`Connecting to UI WebSocket: ${H}`),n.value=new WebSocket(H),n.value.onopen=()=>{e.value=!0,t.value=0,w.value=Date.now(),k("ui"),console.log("UI WebSocket connected")},n.value.onmessage=W=>{const q=JSON.parse(W.data);He(q)},n.value.onclose=()=>{if(O("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const W=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${W}ms (attempt ${t.value})`),setTimeout(L,W)}},n.value.onerror=W=>{console.error("UI WebSocket error:",W)}}function R(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function F(H){c.value++;const W=c.value;if(console.log(`[Gen ${W}] Starting connection to session ${H}`),m&&(clearTimeout(m),m=null),await B(),c.value!==W){console.log(`[Gen ${W}] Connection cancelled (current generation: ${c.value})`);return}l.value=H,b.value=W;const q=E(`/ws/session/${H}`);console.log(`[Gen ${W}] Connecting to Session WebSocket: ${q}`),i.value=new WebSocket(q),i.value.onopen=async()=>{if(b.value!==W){console.log(`[Gen ${W}] Ignoring onopen (stale connection, current: ${b.value})`),i.value.close();return}a.value=!0,r.value=0,P.value=Date.now(),k("session"),console.log(`[Gen ${W}] Session WebSocket connected for ${H}`);const X=h.value.get(H);if(h.value.set(H,!0),X){console.log(`[Gen ${W}] Reconnection detected, syncing missed messages...`);try{const de=await De().syncMessages(H);de.syncedCount>0?console.log(`[Gen ${W}] âœ… Synced ${de.syncedCount} missed messages`):de.error?console.warn(`[Gen ${W}] âš ï¸ Message sync failed: ${de.error}`):console.log(`[Gen ${W}] No missed messages to sync`),de.hasMore&&console.warn(`[Gen ${W}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(J){console.error(`[Gen ${W}] Error during message sync:`,J)}}else console.log(`[Gen ${W}] Initial connection, no sync needed`)},i.value.onmessage=X=>{if(b.value!==W){console.log(`[Gen ${W}] Ignoring message (stale connection, current: ${b.value})`);return}const J=JSON.parse(X.data);fe(J,H)},i.value.onclose=()=>{O("session"),a.value=!1,i.value=null,console.log(`[Gen ${W}] Session WebSocket closed for ${H}`);const X=ee();if(X.currentSessionId===H&&b.value===W&&r.value<u){r.value++;const J=Math.min(2e3*r.value,3e4);console.log(`[Gen ${W}] Reconnecting Session WebSocket in ${J}ms (attempt ${r.value})`),m=setTimeout(()=>{b.value===W&&X.currentSessionId===H?(m=null,F(H)):console.log(`[Gen ${W}] Skipping reconnect (generation or session changed)`)},J)}},i.value.onerror=X=>{console.error(`[Gen ${W}] Session WebSocket error:`,X)}}function B(){return new Promise(H=>{if(m&&(clearTimeout(m),m=null,console.log("Cancelled pending session reconnect timer")),i.value){const W=l.value,q=()=>{i.value=null,a.value=!1,l.value=null,b.value=null,r.value=0,W&&h.value.delete(W),H()};if(i.value.readyState===WebSocket.CLOSED)q();else{const X=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),q()},2e3);i.value.addEventListener("close",()=>{clearTimeout(X),q()},{once:!0}),i.value.close()}}else l.value=null,b.value=null,H()})}function ne(H){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:H})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function re(H,W,q=!1,X=null){if(i.value&&a.value){const J={type:"permission_response",request_id:H,decision:W,apply_suggestions:q,timestamp:new Date().toISOString()};X&&(J.clarification_message=X),i.value.send(JSON.stringify(J)),console.log(`Sent permission ${W} for request ${H}`,{applySuggestions:q,clarification:X})}}function ue(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function He(H){const W=ee(),q=ve();switch(H.type){case"sessions_list":H.sessions&&Array.isArray(H.sessions)&&H.sessions.forEach(X=>{W.updateSession(X.session_id,X)});break;case"state_change":H.data&&H.data.session_id&&H.data.session&&W.updateSession(H.data.session_id,H.data.session);break;case"project_updated":if(H.data&&H.data.project){const X=H.data.project;q.updateProjectLocal(X.project_id,X)}break;case"project_deleted":H.data&&H.data.project_id&&q.projects.delete(H.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":w.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",H.type)}}function fe(H,W){const q=ee();if(q.currentSessionId!==W){console.warn(`Ignoring message for session ${W} (current: ${q.currentSessionId})`);return}const X=De();switch(H.type){case"message":const J=H.data;if(!J||!J.type){console.warn("Received message event with invalid data:",H);break}if(J.type==="permission_request"){X.handlePermissionRequest(W,J);break}if(J.type==="permission_response"){X.handlePermissionResponse(W,J);break}J.metadata?.has_tool_uses&&J.metadata.tool_uses.forEach(de=>{X.handleToolUse(W,de)}),J.metadata?.has_tool_results&&J.metadata.tool_results.forEach(de=>{X.handleToolResult(W,de)}),J.type==="system"&&(J.subtype==="init"||J.metadata?.subtype==="init")&&J.metadata?.init_data&&q.storeInitData(W,J.metadata.init_data),X.addMessage(W,J);break;case"permission_request":X.handlePermissionRequest(W,H);break;case"permission_response":X.handlePermissionResponse(W,H);break;case"tool_result":X.handleToolResult(W,H);break;case"state_change":q.updateSession(W,H.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${W}`);break;case"ping":P.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function Q(H){U(),y.value=H;const W=E(`/ws/legion/${H}`);console.log(`Connecting to Legion WebSocket: ${W}`),f.value=new WebSocket(W),f.value.onopen=()=>{C.value=!0,_.value=0,j.value=Date.now(),k("legion"),console.log(`Legion WebSocket connected for ${H}`)},f.value.onmessage=q=>{const X=JSON.parse(q.data);oe(X,H)},f.value.onclose=()=>{if(O("legion"),C.value=!1,f.value=null,console.log(`Legion WebSocket closed for ${H}`),y.value===H&&_.value<g){_.value++;const q=Math.min(2e3*_.value,3e4);setTimeout(()=>Q(H),q)}},f.value.onerror=q=>{console.error("Legion WebSocket error:",q)}}function U(){f.value&&(f.value.close(),f.value=null,C.value=!1,y.value=null)}function oe(H,W){$e(async()=>{const{useLegionStore:q}=await Promise.resolve().then(()=>yd);return{useLegionStore:q}},void 0).then(({useLegionStore:q})=>{const X=q();switch(H.type){case"comm":H.comm&&(X.addComm(W,H.comm),console.log("Legion WebSocket: Received new comm",H.comm));break;case"minion_created":H.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",H.data),$e(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>hn);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"minion_updated":H.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",H.data),$e(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>hn);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${W}`);break;case"ping":j.value=Date.now(),f.value?.readyState===WebSocket.OPEN&&f.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",H.type)}})}return{uiConnected:e,sessionConnected:a,legionConnected:C,overallStatus:S,connectUI:L,disconnectUI:R,connectSession:F,disconnectSession:B,sendMessage:ne,sendPermissionResponse:re,interruptSession:ue,connectLegion:Q,disconnectLegion:U}}),ua=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Ye},Symbol.toStringTag,{value:"Module"})),da={class:"base-tool-handler"},pa={class:"tool-section"},ma={class:"tool-parameters"},fa={class:"tool-code"},va={key:0,class:"tool-section"},ha={class:"tool-section-label"},_a={class:"tool-code"},ga={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=v(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,u)=>(d(),p("div",da,[s("div",pa,[u[0]||(u[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",ma,[s("pre",fa,$(t.value),1)])]),o.value?(d(),p("div",va,[s("div",ha,$(i.value?"Error:":"Result:"),1),s("div",{class:K(["tool-result",{"tool-result-error":i.value}])},[s("pre",_a,$(a.value),1)],2)])):I("",!0)]))}},ba=G(ga,[["__scopeId","data-v-1e69f57d"]]),ya={class:"read-tool-handler"},$a={class:"tool-section"},wa={class:"read-file-info"},Ea={class:"file-path"},Ca={key:0,class:"read-range"},Sa={key:0,class:"tool-section"},Ta={key:0,class:"tool-result tool-result-error"},ka={class:"tool-code"},xa={key:1,class:"file-content-preview"},Aa={class:"content-header"},Ma={class:"line-count-badge"},Oa={key:0,class:"preview-note"},Na={class:"tool-code content-display"},Da={key:0,class:"more-indicator"},ms=100,La={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>{const f=e.toolCall.input?.offset,C=e.toolCall.input?.limit;return f!==void 0||C!==void 0}),i=v(()=>{const f=e.toolCall.input?.offset;return f!==void 0?f+1:1}),a=v(()=>{const f=e.toolCall.input?.offset||0,C=e.toolCall.input?.limit;return C!==void 0?f+C:"âˆž"}),r=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=v(()=>{if(!r.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),m=v(()=>u.value||!l.value?[]:l.value.split(`
`)),c=v(()=>m.value.length),b=v(()=>c.value>ms),h=v(()=>u.value?"":m.value.slice(0,ms).join(`
`));return(f,C)=>(d(),p("div",ya,[s("div",$a,[s("div",wa,[C[0]||(C[0]=s("span",{class:"file-icon"},"ðŸ“„",-1)),C[1]||(C[1]=s("strong",null,"Reading:",-1)),s("code",Ea,$(t.value),1),o.value?(d(),p("span",Ca,"Lines "+$(i.value)+"-"+$(a.value),1)):I("",!0)])]),r.value?(d(),p("div",Sa,[u.value?(d(),p("div",Ta,[s("pre",ka,$(l.value),1)])):(d(),p("div",xa,[s("div",Aa,[C[2]||(C[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Ma,$(c.value)+" lines",1),b.value?(d(),p("span",Oa,"(showing first "+$(ms)+")")):I("",!0)]),s("pre",Na,$(h.value),1),b.value?(d(),p("div",Da,"...")):I("",!0)]))])):I("",!0)]))}},Ia=G(La,[["__scopeId","data-v-1f2b0569"]]),Pa={class:"write-tool-handler"},ja={class:"tool-section"},Ra={class:"write-file-info mb-2"},Va={class:"file-path"},Ha={class:"write-content-preview"},Wa={class:"content-header"},Fa={class:"line-count-badge"},Ba={key:0,class:"preview-note"},Ua={class:"tool-code content-display"},qa={key:0,class:"more-indicator"},za={key:0,class:"tool-section"},Ka={key:0,class:"tool-result tool-result-error"},Ya={class:"tool-code"},Ga={key:1,class:"tool-result tool-result-success"},Ja={class:"success-message"},fs=100,Xa={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.content||""),i=v(()=>o.value.split(`
`)),a=v(()=>i.value.length),r=v(()=>a.value>fs),u=v(()=>i.value.slice(0,fs).join(`
`)),l=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=v(()=>{if(!l.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,h)=>(d(),p("div",Pa,[s("div",ja,[s("div",Ra,[h[0]||(h[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=s("strong",null,"Writing:",-1)),s("code",Va,$(t.value),1)]),s("div",Ha,[s("div",Wa,[h[2]||(h[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",Fa,$(a.value)+" lines",1),r.value?(d(),p("span",Ba,"(showing first "+$(fs)+")")):I("",!0)]),s("pre",Ua,$(u.value),1),r.value?(d(),p("div",qa,"...")):I("",!0)])]),l.value?(d(),p("div",za,[m.value?(d(),p("div",Ka,[h[3]||(h[3]=s("strong",null,"Error:",-1)),s("pre",Ya,$(c.value),1)])):(d(),p("div",Ga,[s("div",Ja,[h[4]||(h[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):I("",!0)]))}},Qa=G(Xa,[["__scopeId","data-v-ddc24a0f"]]),Za={class:"bash-tool-handler"},er={class:"tool-section"},tr={class:"bash-header"},sr={class:"bash-header-content"},nr={key:0,class:"bash-description"},or={key:1,class:"bash-flags"},ir={class:"bash-command-section"},ar={class:"bash-command-content"},rr={key:0,class:"tool-section"},lr={key:0,class:"bash-output"},cr={key:1,class:"bash-output-empty"},ur={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.command||""),o=v(()=>e.toolCall.input?.description||""),i=v(()=>e.toolCall.input?.timeout),a=v(()=>e.toolCall.input?.run_in_background||!1),r=v(()=>i.value||a.value),u=v(()=>{const h=[];return i.value&&h.push(`timeout: ${i.value}ms`),a.value&&h.push("background"),h.join(", ")}),l=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=v(()=>m.value?"tool-result-error":"tool-result-success"),b=v(()=>{if(!l.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,f)=>(d(),p("div",Za,[s("div",er,[s("div",tr,[f[1]||(f[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",sr,[o.value?(d(),p("div",nr,[f[0]||(f[0]=s("strong",null,"Description:",-1)),Y(" "+$(o.value),1)])):I("",!0),r.value?(d(),p("div",or,$(u.value),1)):I("",!0)])]),s("div",ir,[f[2]||(f[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",ar,$(t.value),1)])]),l.value?(d(),p("div",rr,[s("div",{class:K(["tool-result",c.value])},[f[3]||(f[3]=s("strong",null,"Output:",-1)),b.value?(d(),p("pre",lr,$(b.value),1)):(d(),p("div",cr,"No output"))],2)])):I("",!0)]))}},dr=G(ur,[["__scopeId","data-v-ab50fe73"]]),pr={class:"todo-tool-handler"},mr={class:"tool-section"},fr={class:"todo-header"},vr={class:"todo-summary"},hr={key:0,class:"todo-count todo-count-completed"},_r={key:1,class:"todo-count todo-count-in-progress"},gr={key:2,class:"todo-count todo-count-pending"},br={class:"todo-checklist"},yr={class:"todo-checkbox"},$r={class:"todo-content"},wr={key:0,class:"tool-section"},Er={key:0,class:"tool-result tool-result-error"},Cr={class:"tool-code"},Sr={key:1,class:"tool-result tool-result-success"},Tr={class:"success-message"},kr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.todos||[]),o=v(()=>t.value.filter(c=>c.status==="completed").length),i=v(()=>t.value.filter(c=>c.status==="in_progress").length),a=v(()=>t.value.filter(c=>c.status==="pending").length);function r(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const u=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=v(()=>{if(!u.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,b)=>(d(),p("div",pr,[s("div",mr,[s("div",fr,[b[0]||(b[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),b[1]||(b[1]=s("strong",null,"Task List:",-1)),s("div",vr,[o.value>0?(d(),p("span",hr,$(o.value)+" completed ",1)):I("",!0),i.value>0?(d(),p("span",_r,$(i.value)+" in progress ",1)):I("",!0),a.value>0?(d(),p("span",gr,$(a.value)+" pending ",1)):I("",!0)])]),s("div",br,[(d(!0),p(se,null,ae(t.value,(h,f)=>(d(),p("div",{key:f,class:K(["todo-item",`todo-${h.status}`])},[s("span",yr,$(r(h.status)),1),s("span",$r,$(h.content),1)],2))),128))])]),u.value?(d(),p("div",wr,[l.value?(d(),p("div",Er,[b[2]||(b[2]=s("strong",null,"Error:",-1)),s("pre",Cr,$(m.value),1)])):(d(),p("div",Sr,[s("div",Tr,[b[3]||(b[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+$(t.value.length)+" tasks)",1)])]))])):I("",!0)]))}},xr=G(kr,[["__scopeId","data-v-bbe55ee7"]]),Ar={class:"edit-tool-handler"},Mr={class:"tool-section"},Or={class:"edit-file-info"},Nr={class:"file-path"},Dr={key:0,class:"replace-all-badge"},Lr={class:"edit-diff-container"},Ir={class:"diff-header"},Pr={class:"diff-stats"},jr={class:"stat-removed"},Rr={class:"stat-added"},Vr={class:"unified-diff"},Hr={class:"diff-scroll-container"},Wr={class:"diff-marker"},Fr={class:"diff-content"},Br={key:0,class:"tool-section"},Ur={key:0,class:"tool-result tool-result-error"},qr={class:"tool-code"},zr={key:1,class:"tool-result tool-result-success"},Kr={class:"success-message"},Yr={key:0,class:"success-detail"},Gr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.old_string||""),i=v(()=>e.toolCall.input?.new_string||""),a=v(()=>e.toolCall.input?.replace_all||!1),r=v(()=>{const f=hi(t.value,o.value,i.value,"","",{context:3}).split(`
`),C=[];for(let _=4;_<f.length;_++){const g=f[_];g&&(g.startsWith("-")?C.push({type:"removed",content:g.substring(1)}):g.startsWith("+")?C.push({type:"added",content:g.substring(1)}):g.startsWith(" ")?C.push({type:"context",content:g.substring(1)}):g.startsWith("@@")&&C.push({type:"hunk",content:g}))}return C}),u=v(()=>r.value.filter(h=>h.type==="removed").length),l=v(()=>r.value.filter(h=>h.type==="added").length),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!m.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,f)=>(d(),p("div",Ar,[s("div",Mr,[s("div",Or,[f[0]||(f[0]=s("span",{class:"file-icon"},"âœï¸",-1)),f[1]||(f[1]=s("strong",null,"Editing:",-1)),s("code",Nr,$(t.value),1),a.value?(d(),p("span",Dr,"Replace All")):I("",!0)]),s("div",Lr,[s("div",Ir,[f[2]||(f[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Pr,[s("span",jr,"-"+$(u.value),1),s("span",Rr,"+"+$(l.value),1)])]),s("div",Vr,[s("div",Hr,[(d(!0),p(se,null,ae(r.value,(C,_)=>(d(),p("div",{key:_,class:K(["diff-line",{"diff-line-removed":C.type==="removed","diff-line-added":C.type==="added","diff-line-context":C.type==="context","diff-line-hunk":C.type==="hunk"}])},[s("span",Wr,$(C.type==="removed"?"-":C.type==="added"?"+":C.type==="hunk"?"@":" "),1),s("span",Fr,$(C.content),1)],2))),128))])])])]),m.value?(d(),p("div",Br,[c.value?(d(),p("div",Ur,[f[3]||(f[3]=s("strong",null,"Error:",-1)),s("pre",qr,$(b.value),1)])):(d(),p("div",zr,[s("div",Kr,[f[4]||(f[4]=s("span",{class:"success-icon"},"âœ…",-1)),f[5]||(f[5]=s("strong",null,"File edited successfully",-1)),a.value?(d(),p("span",Yr,"(all occurrences replaced)")):I("",!0)])]))])):I("",!0)]))}},Jr=G(Gr,[["__scopeId","data-v-16b90adc"]]),Xr={class:"search-tool-handler"},Qr={class:"tool-section"},Zr={class:"search-info"},el={class:"search-icon"},tl={class:"search-pattern"},sl={key:0,class:"search-path"},nl={key:1,class:"search-filters"},ol={key:0,class:"filter-badge"},il={key:1,class:"filter-badge"},al={key:2,class:"filter-badge"},rl={key:0,class:"tool-section"},ll={key:0,class:"tool-result tool-result-error"},cl={class:"tool-code"},ul={key:1,class:"search-results"},dl={class:"results-header"},pl={class:"results-label"},ml={class:"results-count-badge"},fl={class:"results-content"},vl={class:"tool-code"},hl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="Grep");v(()=>e.toolCall.name==="Glob");const o=v(()=>e.toolCall.input?.pattern||"Unknown"),i=v(()=>e.toolCall.input?.path||null),a=v(()=>e.toolCall.input?.type||null),r=v(()=>e.toolCall.input?.glob||null),u=v(()=>e.toolCall.input?.["-i"]||!1),l=v(()=>a.value||r.value||u.value),m=v(()=>t.value?"ðŸ”":"ðŸ“"),c=v(()=>t.value?"Searching content":"Finding files"),b=v(()=>t.value?"Matches":"Files found"),h=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),C=v(()=>{if(!h.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),_=v(()=>!h.value||f.value||!C.value?0:C.value.split(`
`).filter(y=>y.trim()).length);return(g,y)=>(d(),p("div",Xr,[s("div",Qr,[s("div",Zr,[s("span",el,$(m.value),1),s("strong",null,$(c.value)+":",1),s("code",tl,$(o.value),1),i.value?(d(),p("span",sl,"in "+$(i.value),1)):I("",!0),l.value?(d(),p("span",nl,[a.value?(d(),p("span",ol,"type: "+$(a.value),1)):I("",!0),r.value?(d(),p("span",il,"glob: "+$(r.value),1)):I("",!0),u.value?(d(),p("span",al,"case-insensitive")):I("",!0)])):I("",!0)])]),h.value?(d(),p("div",rl,[f.value?(d(),p("div",ll,[y[0]||(y[0]=s("strong",null,"Error:",-1)),s("pre",cl,$(C.value),1)])):(d(),p("div",ul,[s("div",dl,[s("span",pl,$(b.value)+":",1),s("span",ml,$(_.value)+" "+$(_.value===1?"match":"matches"),1)]),s("div",fl,[s("pre",vl,$(C.value),1)])]))])):I("",!0)]))}},_n=G(hl,[["__scopeId","data-v-0d272c39"]]),_l={class:"web-tool-handler"},gl={class:"tool-section"},bl={class:"web-info"},yl={class:"web-icon"},$l=["href"],wl={key:1,class:"web-query"},El={key:0,class:"web-prompt-container"},Cl={class:"prompt-content"},Sl={key:1,class:"web-domains"},Tl={class:"domains-label"},kl={key:0,class:"tool-section"},xl={key:0,class:"tool-result tool-result-error"},Al={class:"tool-code"},Ml={key:1,class:"web-results"},Ol={class:"results-header"},Nl={class:"results-label"},Dl={class:"results-content"},Ll={class:"tool-code"},Il={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="WebFetch");v(()=>e.toolCall.name==="WebSearch");const o=v(()=>e.toolCall.input?.url||null),i=v(()=>e.toolCall.input?.query||null),a=v(()=>e.toolCall.input?.prompt||null),r=v(()=>e.toolCall.input?.allowed_domains||[]),u=v(()=>e.toolCall.input?.blocked_domains||[]),l=v(()=>r.value.length>0?r.value:u.value.length>0?u.value:[]),m=v(()=>r.value.length>0?"Allowed domains":u.value.length>0?"Blocked domains":"Domains"),c=v(()=>t.value?"ðŸŒ":"ðŸ”Ž"),b=v(()=>t.value?"Fetching URL":"Searching web"),h=v(()=>t.value?"Fetched content":"Search results"),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),C=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=v(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,y)=>(d(),p("div",_l,[s("div",gl,[s("div",bl,[s("span",yl,$(c.value),1),s("strong",null,$(b.value)+":",1),o.value?(d(),p("a",{key:0,href:o.value,target:"_blank",class:"web-url"},$(o.value),9,$l)):i.value?(d(),p("code",wl,$(i.value),1)):I("",!0)]),a.value?(d(),p("div",El,[y[0]||(y[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Cl,$(a.value),1)])):I("",!0),l.value.length>0?(d(),p("div",Sl,[s("span",Tl,$(m.value)+":",1),(d(!0),p(se,null,ae(l.value,M=>(d(),p("span",{key:M,class:"domain-badge"},$(M),1))),128))])):I("",!0)]),f.value?(d(),p("div",kl,[C.value?(d(),p("div",xl,[y[1]||(y[1]=s("strong",null,"Error:",-1)),s("pre",Al,$(_.value),1)])):(d(),p("div",Ml,[s("div",Ol,[s("span",Nl,$(h.value)+":",1)]),s("div",Dl,[s("pre",Ll,$(_.value),1)])]))])):I("",!0)]))}},gn=G(Il,[["__scopeId","data-v-62b55b55"]]),Pl={class:"task-tool-handler"},jl={class:"tool-section"},Rl={class:"task-header"},Vl={key:0,class:"agent-type-badge"},Hl={key:0,class:"task-description"},Wl={class:"description-content"},Fl={key:1,class:"task-prompt-container"},Bl={class:"prompt-header"},Ul={class:"prompt-length"},ql={class:"prompt-code"},zl={key:0,class:"tool-section"},Kl={key:0,class:"tool-result tool-result-error"},Yl={class:"tool-code"},Gl={key:1,class:"agent-output"},Jl={class:"output-header"},Xl={key:0,class:"output-count-badge"},Ql={class:"output-content"},Zl={class:"tool-code"},ec={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.description||null),o=v(()=>e.toolCall.input?.prompt||null),i=v(()=>e.toolCall.input?.subagent_type||null),a=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>{if(!a.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),l=v(()=>u.value?u.value.split(`
`).length:0);return(m,c)=>(d(),p("div",Pl,[s("div",jl,[s("div",Rl,[c[0]||(c[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=s("strong",null,"Agent Task:",-1)),i.value?(d(),p("span",Vl,$(i.value),1)):I("",!0)]),t.value?(d(),p("div",Hl,[c[2]||(c[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",Wl,$(t.value),1)])):I("",!0),o.value?(d(),p("div",Fl,[s("div",Bl,[c[3]||(c[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",Ul,$(o.value.length)+" characters",1)]),s("pre",ql,$(o.value),1)])):I("",!0)]),a.value?(d(),p("div",zl,[r.value?(d(),p("div",Kl,[c[4]||(c[4]=s("strong",null,"Error:",-1)),s("pre",Yl,$(u.value),1)])):(d(),p("div",Gl,[s("div",Jl,[c[5]||(c[5]=s("span",{class:"output-label"},"Agent Output:",-1)),l.value>0?(d(),p("span",Xl,$(l.value)+" lines",1)):I("",!0)]),s("div",Ql,[s("pre",Zl,$(u.value),1)])]))])):I("",!0)]))}},tc=G(ec,[["__scopeId","data-v-c520c244"]]),sc={class:"notebook-edit-tool-handler"},nc={class:"tool-section"},oc={class:"notebook-info"},ic={class:"file-path"},ac={class:"cell-info mt-2"},rc={class:"info-row"},lc={class:"info-row"},cc={key:0,class:"info-row"},uc={class:"badge bg-info"},dc={key:0,class:"source-preview mt-3"},pc={class:"preview-header"},mc={class:"preview-stats"},fc={class:"source-code"},vc={key:0,class:"tool-section"},hc={key:0},_c={key:1,class:"text-danger"},gc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.notebook_path||"Unknown"),o=v(()=>e.toolCall.input?.cell_id),i=v(()=>e.toolCall.input?.cell_type||"code"),a=v(()=>e.toolCall.input?.edit_mode||"replace"),r=v(()=>e.toolCall.input?.new_source||""),u=v(()=>r.value.split(`
`).length),l=v(()=>i.value==="code"?"bg-primary":"bg-secondary"),m=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const b=a.value;return b==="insert"?"Cell inserted successfully":b==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(b,h)=>(d(),p("div",sc,[s("div",nc,[s("div",oc,[h[0]||(h[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=s("strong",null,"Notebook:",-1)),s("code",ic,$(t.value),1)]),s("div",ac,[s("div",rc,[h[2]||(h[2]=s("strong",null,"Cell ID:",-1)),s("code",null,$(o.value||"N/A"),1)]),s("div",lc,[h[3]||(h[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:K(["badge",l.value])},$(i.value),3)]),a.value?(d(),p("div",cc,[h[4]||(h[4]=s("strong",null,"Edit Mode:",-1)),s("span",uc,$(a.value),1)])):I("",!0)]),r.value?(d(),p("div",dc,[s("div",pc,[h[5]||(h[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",mc,$(u.value)+" lines",1)]),s("pre",fc,[s("code",null,$(r.value),1)])])):I("",!0)]),n.toolCall.result?(d(),p("div",vc,[h[8]||(h[8]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:K(["tool-result",m.value])},[n.toolCall.result.success!==!1?(d(),p("div",hc,[h[6]||(h[6]=s("i",{class:"bi bi-check-circle"},null,-1)),Y(" "+$(c.value),1)])):(d(),p("div",_c,[h[7]||(h[7]=s("i",{class:"bi bi-x-circle"},null,-1)),Y(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)])):I("",!0)]))}},bc=G(gc,[["__scopeId","data-v-bf9ef8f9"]]),yc={class:"shell-tool-handler"},$c={class:"tool-section"},wc={class:"shell-info"},Ec={class:"shell-icon"},Cc={key:0,class:"shell-id"},Sc={key:0,class:"filter-info mt-2"},Tc={class:"filter-pattern"},kc={key:0,class:"tool-section"},xc={class:"result-header mb-2"},Ac={key:0,class:"mb-2"},Mc={class:"shell-output"},Oc={key:1,class:"mb-2"},Nc={class:"shell-output shell-output-error"},Dc={key:0},Lc={key:1,class:"text-danger"},Ic={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=v(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=v(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=v(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=v(()=>e.toolCall.input?.filter);function u(f,C){if(!f)return null;const _=new RegExp(`<${C}>([\\s\\S]*?)<\\/${C}>`,"i"),g=f.match(_);return g?g[1].trim():null}const l=v(()=>{const f=e.toolCall.result;if(!f)return null;if(typeof f=="string")return{status:u(f,"status"),stdout:u(f,"stdout"),stderr:u(f,"stderr"),exit_code:u(f,"exit_code")};if(f.content&&Array.isArray(f.content)){const C=f.content.find(_=>_.type==="text")?.text||"";return{status:u(C,"status"),stdout:u(C,"stdout"),stderr:u(C,"stderr"),exit_code:u(C,"exit_code")}}return{status:f.status,stdout:f.stdout||f.output,stderr:f.stderr,exit_code:f.exit_code}});v(()=>{if(e.toolCall.name==="BashOutput"){const f=l.value;if(!f)return null;const C=[];return f.stdout&&C.push(f.stdout),f.stderr&&C.push(`[stderr]
${f.stderr}`),C.length>0?C.join(`

`):null}return null});const m=v(()=>l.value?.status),c=v(()=>{const f=m.value;return f==="running"?"bg-success":f==="completed"?"bg-secondary":f==="killed"||f==="terminated"?"bg-danger":"bg-info"}),b=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const f=l.value;if(f?.status==="running"&&!f.stdout&&!f.stderr)return"No new output since last check";if(f?.status==="failed")return`Shell failed (exit code ${f.exit_code||"unknown"})`}return"Operation completed"});return(f,C)=>(d(),p("div",yc,[s("div",$c,[s("div",wc,[s("span",Ec,$(t.value),1),s("strong",null,$(o.value)+":",1),a.value?(d(),p("code",Cc,"Shell "+$(a.value),1)):I("",!0)]),n.toolCall.name==="BashOutput"&&r.value?(d(),p("div",Sc,[C[0]||(C[0]=s("strong",null,"Filter:",-1)),s("code",Tc,$(r.value),1)])):I("",!0)]),n.toolCall.result?(d(),p("div",kc,[s("div",xc,[s("strong",null,$(i.value)+":",1),m.value?(d(),p("span",{key:0,class:K(["badge",c.value])},$(m.value),3)):I("",!0)]),l.value?.stdout?(d(),p("div",Ac,[C[1]||(C[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Mc,[s("pre",null,[s("code",null,$(l.value.stdout),1)])])])):I("",!0),l.value?.stderr?(d(),p("div",Oc,[C[2]||(C[2]=s("div",{class:"output-label text-danger"},[s("i",{class:"bi bi-exclamation-triangle"}),Y(" Errors: ")],-1)),s("div",Nc,[s("pre",null,[s("code",null,$(l.value.stderr),1)])])])):I("",!0),!l.value?.stdout&&!l.value?.stderr?(d(),p("div",{key:2,class:K(["tool-result",b.value])},[n.toolCall.result.success!==!1?(d(),p("div",Dc,[C[3]||(C[3]=s("i",{class:"bi bi-check-circle"},null,-1)),Y(" "+$(h.value),1)])):(d(),p("div",Lc,[C[4]||(C[4]=s("i",{class:"bi bi-x-circle"},null,-1)),Y(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)):I("",!0)])):I("",!0)]))}},bn=G(Ic,[["__scopeId","data-v-9ceb124f"]]),Pc={class:"skill-tool-handler"},jc={key:0,class:"tool-section"},Rc={class:"d-flex align-items-center gap-2"},Vc={class:"text-muted small"},Hc={key:0,class:"skill-content-body"},Wc={class:"skill-content-text"},Fc={key:1,class:"tool-section mt-3"},Bc={class:"tool-result tool-result-error"},Uc={class:"tool-code"},qc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=De(),o=ee(),i=D(!1);function a(){i.value=!i.value}v(()=>e.toolCall.input?.command||"Unknown Skill"),v(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),v(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=v(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const f=t.messagesBySession.get(h)||[],C=f.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(C===-1)return{running:null,content:null};let _=null,g=null;for(let y=C+1;y<Math.min(C+3,f.length);y++){const M=f[y];if(M.type!=="user")continue;const T=M.content||"";T.includes("<command-message>")&&T.includes("skill is running")?_=M:T.startsWith("Base directory for this skill:")&&(g=M)}return{running:_,content:g}});v(()=>{const h=r.value.content;if(!h)return null;const C=(h.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return C&&C[1]?C[1].trim():null});const u=v(()=>{const h=r.value.content;if(!h)return"";const f=h.content||"",C=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return f.replace(C,"").trim()}),l=v(()=>u.value.length>0),m=v(()=>u.value?u.value.split(`
`).length:0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!c.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,f)=>(d(),p("div",Pc,[l.value?(d(),p("div",jc,[s("div",{class:"skill-content-header",onClick:a},[s("div",Rc,[s("i",{class:K(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),f[0]||(f[0]=s("strong",null,"Skill Content",-1)),s("span",Vc,"("+$(m.value)+" lines)",1)])]),i.value?(d(),p("div",Hc,[s("pre",Wc,$(u.value),1)])):I("",!0)])):I("",!0),c.value?(d(),p("div",Fc,[f[1]||(f[1]=s("div",{class:"tool-section-label text-danger"},[s("i",{class:"bi bi-x-circle"}),Y(" Error: ")],-1)),s("div",Bc,[s("pre",Uc,$(b.value),1)])])):I("",!0)]))}},zc=G(qc,[["__scopeId","data-v-ba9a91da"]]),Kc={class:"slashcommand-tool-handler"},Yc={key:0,class:"tool-section"},Gc={class:"d-flex align-items-center gap-2"},Jc={class:"text-muted small"},Xc={key:0,class:"command-content-body"},Qc={class:"command-content-text"},Zc={key:1,class:"tool-section mt-3"},eu={class:"tool-result tool-result-error"},tu={class:"tool-code"},su={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=De(),o=ee(),i=D(!1);function a(){i.value=!i.value}v(()=>e.toolCall.input?.command||"Unknown Command"),v(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),v(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=v(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const f=t.messagesBySession.get(h)||[],C=f.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(C===-1)return{running:null,content:null};let _=null,g=null;for(let y=C+1;y<Math.min(C+3,f.length);y++){const M=f[y];if(M.type!=="user")continue;const T=M.content||"";T.includes("<command-message>")&&T.includes("<command-name>")&&T.includes("<command-args>")?_=M:T.includes("ARGUMENTS:")&&(g=M)}return{running:_,content:g}});v(()=>{const h=r.value.running;if(!h)return null;const C=(h.content||"").match(/<command-args>(.+?)<\/command-args>/s);return C&&C[1]?C[1].trim():null});const u=v(()=>{const h=r.value.content;if(!h)return"";const f=h.content||"",C=/\nARGUMENTS:.*$/s;return f.replace(C,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),l=v(()=>u.value.length>0),m=v(()=>u.value?u.value.split(`
`).length:0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!c.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,f)=>(d(),p("div",Kc,[l.value?(d(),p("div",Yc,[s("div",{class:"command-content-header",onClick:a},[s("div",Gc,[s("i",{class:K(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),f[0]||(f[0]=s("strong",null,"Command Content",-1)),s("span",Jc,"("+$(m.value)+" lines)",1)])]),i.value?(d(),p("div",Xc,[s("pre",Qc,$(u.value),1)])):I("",!0)])):I("",!0),c.value?(d(),p("div",Zc,[f[1]||(f[1]=s("div",{class:"tool-section-label text-danger"},[s("i",{class:"bi bi-x-circle"}),Y(" Error: ")],-1)),s("div",eu,[s("pre",tu,$(b.value),1)])])):I("",!0)]))}},nu=G(su,[["__scopeId","data-v-17d3444e"]]),ou={class:"exit-plan-mode-tool-handler"},iu={class:"tool-section"},au={key:0,class:"plan-content mt-2"},ru={class:"plan-text"},lu={key:0,class:"tool-section"},cu={key:0},uu={key:1,class:"text-danger"},du={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.plan),o=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(d(),p("div",ou,[s("div",iu,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(d(),p("div",au,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",ru,$(t.value),1)])):I("",!0)]),n.toolCall.result?(d(),p("div",lu,[a[4]||(a[4]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:K(["tool-result",o.value])},[n.toolCall.result.success!==!1?(d(),p("div",cu,[...a[2]||(a[2]=[s("i",{class:"bi bi-check-circle"},null,-1),Y(" Permission mode reverted to default ",-1)])])):(d(),p("div",uu,[a[3]||(a[3]=s("i",{class:"bi bi-x-circle"},null,-1)),Y(" "+$(n.toolCall.result.error||"Failed to exit plan mode"),1)]))],2)])):I("",!0)]))}},pu=G(du,[["__scopeId","data-v-bd35183e"]]),mu={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},fu={class:"tool-status-icon"},vu=["title"],hu={class:"d-flex align-items-center gap-2"},_u={class:"text-muted"},gu={key:0,class:"card-body"},bu={key:0,class:"alert alert-warning mb-3"},yu={class:"d-flex align-items-center"},$u={class:"mb-0 small"},wu={key:1,class:"permission-prompt mt-3"},Eu={class:"alert alert-warning mb-3"},Cu={class:"mb-0"},Su={class:"tool-name"},Tu={key:0,class:"suggestions-section mb-3"},ku={class:"alert alert-info mb-0"},xu={class:"suggestion-details p-2 bg-white rounded"},Au={class:"permission-buttons d-flex gap-2 mb-3"},Mu=["disabled"],Ou=["disabled"],Nu=["disabled"],Du={class:"guidance-section mt-3"},Lu=["disabled"],Iu=["disabled"],Pu={key:2,class:"mt-3"},ju={class:"alert alert-warning mb-0"},Ru={class:"d-flex align-items-center"},Vu={class:"mb-0 small"},Hu={key:3,class:"tool-section"},Wu={class:"alert alert-danger mb-0"},Fu={key:0},Bu={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=De(),o=ee(),i=Ye(),a=D(!1),r=D(null),u=D(""),l=v(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),m=v(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c={Read:Ia,Write:Qa,Bash:dr,TodoWrite:xr,Edit:Jr,Grep:_n,Glob:_n,WebFetch:gn,WebSearch:gn,Task:tc,NotebookEdit:bc,BashOutput:bn,KillShell:bn,SlashCommand:nu,Skill:zc,ExitPlanMode:pu},b=v(()=>{const S=e.toolCall.name;return c[S]?c[S]:ba}),h=v(()=>{const S=[];switch(e.toolCall.status){case"pending":S.push("border-secondary");break;case"permission_required":S.push("border-warning");break;case"executing":S.push("border-primary");break;case"completed":_.value||e.toolCall.permissionDecision==="deny"?S.push("border-danger"):S.push("border-success");break;case"error":S.push("border-danger");break}return S.join(" ")}),f=v(()=>{switch(e.toolCall.status){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":_.value?"ðŸ’¥":"âœ…";case"error":return"ðŸ’¥";default:return"ðŸ”§"}}),C=v(()=>ss(e.toolCall.timestamp)),_=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=v(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function y(S){if(!S)return"";const E=S.replace(/\\/g,"/").split("/");return E[E.length-1]}function M(S,E=200){return S?S.length<=E?S:S.substring(0,E)+"...":""}function T(S){if(!S)return null;if(S.content){const E=S.content.match(/exit code (\d+)/i);if(E)return parseInt(E[1])}return S.error?1:0}function w(S,E){const k=S?S.split(`
`).length:0;return{added:E?E.split(`
`).length:0,removed:k}}const P=v(()=>{const S=e.toolCall.name,E=e.toolCall.input||{},k=e.toolCall.result,O=e.toolCall.status;switch(S){case"Bash":case"Shell":case"Command":{const L=M(E.command,200);if(O==="completed"&&k){const R=T(k);return`Bash: ${L} (exit ${R})`}return`Bash: ${L}`}case"SlashCommand":{const L=M(E.command,200);return O==="completed"&&k?`SlashCommand: ${L}`:`SlashCommand: ${L}`}case"Edit":{const L=y(E.file_path);if(O==="completed"&&k&&!k.error){const{added:R,removed:F}=w(E.old_string,E.new_string);return R===F?`Edit: ${L} (${R} lines changed)`:`Edit: ${L} (${R} lines added, ${F} removed)`}return`Edit: ${L}`}case"Read":{const L=y(E.file_path);if(E.offset!==void 0||E.limit!==void 0){const F=(E.offset||0)+1,B=E.limit?(E.offset||0)+E.limit:"âˆž";return`Read: ${L} (lines ${F}-${B})`}return`Read: ${L} (full file)`}case"Write":{const L=y(E.file_path);if(O==="completed"&&k&&!k.error&&E.content){const R=E.content.split(`
`).length;return`Write: ${L} (${R} lines written)`}return`Write: ${L}`}case"Skill":{const L=E.command||"Unknown";return O==="completed"&&k?k.error?`Skill: ${L} (error)`:`Skill: ${L} (completed)`:`Skill: ${L}`}case"Task":{const L=E.subagent_type||"general",R=E.description||"Task";return O==="completed"&&k?k.error?`Task: (${L}) ${R} (error)`:`Task: (${L}) ${R} (completed)`:`Task: (${L}) ${R}`}case"TodoWrite":{if(E.todos&&Array.isArray(E.todos)){const L=E.todos.filter(B=>B.status==="completed").length,R=E.todos.length,F=E.todos.find(B=>B.status==="in_progress");return F?`Todo: Working on "${F.content}"`:`Todo: ${L}/${R} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const L=E.pattern||"",R=S==="Grep"?"Grep":"Glob";if(O==="completed"&&k&&!k.error){let F=0;return k.content&&(F=k.content.split(`
`).filter(ne=>ne.trim()).length),`${R}: "${L}" (${F} results)`}return`${R}: "${L}"`}case"WebFetch":case"WebSearch":{const L=E.url||E.query||"";let R="";try{L&&(R=new URL(L.startsWith("http")?L:`https://${L}`).hostname)}catch{R=L.length>50?L.substring(0,50)+"...":L}return O==="completed"&&k?k.error?`Web: ${R} (error)`:`Web: ${R} (success)`:`Web: ${R||L}`}case"NotebookEdit":{const L=y(E.notebook_path),R=E.cell_number!==void 0?E.cell_number:"?",F=E.edit_mode||"replace";return`NotebookEdit: ${L} cell #${R} (${F})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${E.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${E.shell_id||"unknown"}`;default:return`${S}: executed`}}),j=v(()=>{const S=e.toolCall.name,E=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(S)?E.command||S:["Edit","Read","Write","NotebookEdit"].includes(S)&&(E.file_path||E.notebook_path)||S});function A(){const S=o.currentSessionId;S&&t.toggleToolExpansion(S,e.toolCall.id)}function x(S){return S.type==="setMode"?`Set permission mode to "${S.mode}"`:S.type==="allow"?`Allow tool: ${S.tool}`:JSON.stringify(S)}async function N(S,E,k=null){if(!a.value){a.value=!0,S==="allow"?r.value=E?"approve-apply":"approve":k?r.value="deny-guidance":r.value="deny";try{const O=o.currentSessionId;if(O){const L=E&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:S,reasoning:S==="allow"?"User allowed permission":"User denied permission",applied_updates:L})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,S,E,k)}catch(O){console.error("Failed to send permission response:",O)}finally{a.value=!1,r.value=null}}}return(S,E)=>(d(),p("div",{class:K(["tool-call-card card",h.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:A},[s("div",mu,[s("span",fu,$(f.value),1),s("strong",{class:"tool-name",title:j.value},$(P.value),9,vu)]),s("div",hu,[s("small",_u,$(C.value),1),s("i",{class:K(["bi",n.toolCall.isExpanded?"bi-chevron-up":"bi-chevron-down"])},null,2)])]),n.toolCall.isExpanded?(d(),p("div",gu,[l.value?(d(),p("div",bu,[s("div",yu,[E[6]||(E[6]=s("i",{class:"bi bi-x-circle me-2",style:{"font-size":"1.2rem"}},null,-1)),s("div",null,[E[5]||(E[5]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",$u,$(m.value?.message||"Session was terminated"),1)])])])):I("",!0),(d(),we(no(b.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!l.value?(d(),p("div",wu,[s("div",Eu,[E[9]||(E[9]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Cu,[E[7]||(E[7]=Y("Claude wants to use the ",-1)),s("code",Su,$(n.toolCall.name),1),E[8]||(E[8]=Y(" tool.",-1))])]),g.value?(d(),p("div",Tu,[s("div",ku,[E[10]||(E[10]=s("h6",{class:"mb-2"},[s("i",{class:"bi bi-lightbulb me-2"}),Y(" Suggested Permission Update ")],-1)),E[11]||(E[11]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",xu,[(d(!0),p(se,null,ae(n.toolCall.suggestions,(k,O)=>(d(),p("div",{key:O,class:"suggestion-item"},[s("code",null,$(x(k)),1)]))),128))]),E[12]||(E[12]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):I("",!0),s("div",Au,[g.value?(d(),p("button",{key:0,class:"btn btn-success",onClick:E[0]||(E[0]=k=>N("allow",!0)),disabled:a.value},[E[13]||(E[13]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),Y(" "+$(a.value&&r.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),1)],8,Mu)):I("",!0),s("button",{class:K(["btn",g.value?"btn-outline-success":"btn-success"]),onClick:E[1]||(E[1]=k=>N("allow",!1)),disabled:a.value},[E[14]||(E[14]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),Y(" "+$(a.value&&r.value==="approve"?"â³ Submitting...":g.value?"âœ… Approve Only":"âœ… Approve"),1)],10,Ou),s("button",{class:"btn btn-danger",onClick:E[2]||(E[2]=k=>N("deny",!1)),disabled:a.value},[E[15]||(E[15]=s("i",{class:"bi bi-x-circle me-1"},null,-1)),Y(" "+$(a.value&&r.value==="deny"?"â³ Submitting...":"âŒ Deny"),1)],8,Nu)]),s("div",Du,[E[17]||(E[17]=s("label",{class:"form-label fw-bold"},[s("i",{class:"bi bi-chat-left-text me-1"}),Y(" Provide Guidance (Optional) ")],-1)),E[18]||(E[18]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),te(s("textarea",{"onUpdate:modelValue":E[3]||(E[3]=k=>u.value=k),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Lu),[[pe,u.value]]),u.value.trim()?(d(),p("button",{key:0,class:"btn btn-warning btn-sm",onClick:E[4]||(E[4]=k=>N("deny",!1,u.value)),disabled:a.value},[E[16]||(E[16]=s("i",{class:"bi bi-arrow-repeat me-1"},null,-1)),Y(" "+$(a.value&&r.value==="deny-guidance"?"â³ Submitting...":"ðŸ’¡ Provide Guidance & Continue"),1)],8,Iu)):I("",!0)])])):I("",!0),n.toolCall.status==="permission_required"&&l.value?(d(),p("div",Pu,[s("div",ju,[s("div",Ru,[E[20]||(E[20]=s("i",{class:"bi bi-shield-x me-2",style:{"font-size":"1.2rem"}},null,-1)),s("div",null,[E[19]||(E[19]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Vu,$(m.value?.message||"Session was terminated before permission could be granted"),1)])])])])):I("",!0),n.toolCall.permissionDecision==="deny"?(d(),p("div",Hu,[s("div",Wu,[E[21]||(E[21]=s("i",{class:"bi bi-x-circle"},null,-1)),E[22]||(E[22]=Y(" Permission denied ",-1)),n.toolCall.result?.message?(d(),p("span",Fu," - "+$(n.toolCall.result.message),1)):I("",!0)])])):I("",!0)])):I("",!0)],2))}},Uu=G(Bu,[["__scopeId","data-v-65c848bf"]]),qu={class:"message-row message-row-assistant"},zu=["title"],Ku={class:"message-content-column"},Yu={key:0,class:"thinking-block mb-2"},Gu=["innerHTML"],Ju={key:2,class:"tool-calls"},Xu={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=De(),o=ee();Mt.setOptions({breaks:!0,gfm:!0});const i=v(()=>ss(e.message.timestamp)),a=v(()=>e.message.metadata?.model||null),r=v(()=>{const C=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${C}`}),u=v(()=>{const C=e.message.content||"";return C.trim().length>0&&C!=="Assistant response"}),l=v(()=>{const C=e.message.content||"";let _=Mt.parse(C);return _=_.replace(/\n</g,"<"),_=_.replace(/\n+$/,""),Vs.sanitize(_)}),m=v(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=v(()=>e.message.metadata?.thinking_content||""),b=v(()=>e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0),h=v(()=>e.message.metadata?.tool_uses||[]),f=v(()=>{const C=o.currentSessionId;if(!C)return[];const _=t.toolCallsBySession.get(C)||[];return h.value.map(g=>{const y=_.find(M=>M.id===g.id);return y||{id:g.id,name:g.name,input:g.input,status:"pending",result:null,timestamp:g.timestamp||e.message.timestamp,isExpanded:!0}})});return(C,_)=>(d(),p("div",qu,[s("div",{class:"message-speaker",title:r.value},[..._[0]||(_[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,zu),s("div",Ku,[m.value?(d(),p("div",Yu,[ie(ca,{thinking:c.value},null,8,["thinking"])])):I("",!0),u.value?(d(),p("div",{key:1,class:"message-text",innerHTML:l.value},null,8,Gu)):I("",!0),b.value?(d(),p("div",Ju,[(d(!0),p(se,null,ae(f.value,g=>(d(),we(Uu,{key:g.id,toolCall:g},null,8,["toolCall"]))),128))])):I("",!0)])]))}},Qu=G(Xu,[["__scopeId","data-v-726a72a7"]]),Zu={class:"message-row message-row-system"},ed=["title"],td={class:"message-content-column"},sd={class:"system-text"},nd={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>ss(e.message.timestamp)),o=v(()=>`system
${t.value}`);return(i,a)=>(d(),p("div",Zu,[s("div",{class:"message-speaker",title:o.value},[...a[0]||(a[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,ed),s("div",td,[s("span",sd,$(n.message.content),1)])]))}},yn=G(nd,[["__scopeId","data-v-4999cd2b"]]),od={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>{switch(e.message.type){case"user":return na;case"assistant":return Qu;case"system":return yn;default:return yn}});return(o,i)=>(d(),we(no(t.value),{message:n.message},null,8,["message"]))}},id=G(od,[["__scopeId","data-v-f283c218"]]),ad={key:0,class:"text-muted text-center py-5"},rd={__name:"MessageList",setup(n){const e=De(),t=ce(),o=D(null),i=v(()=>e.currentMessages.filter(l=>r(l)));v(()=>e.currentToolCalls);async function a(){t.autoScrollEnabled&&(await Os(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}le(()=>e.currentMessages.length,a),le(()=>e.currentToolCalls.length,a),le(()=>e.currentToolCalls.map(l=>`${l.id}-${l.status}`).join(","),a),me(()=>{setTimeout(()=>{a()},100)});function r(l){const m=l.subtype||l.metadata?.subtype;if(l.type==="system"&&m==="init"||l.type==="result"||l.type==="permission_request"||l.type==="permission_response")return!1;if(l.type==="user"&&l.metadata?.has_tool_results){const c=l.content||"";if(c.match(/^Tool results?: \d+ results?$/i)||c.trim()==="")return!1}if(l.type==="user"){const c=l.content||"";if(c.includes("<command-message>")&&c.includes("skill is running")||c.startsWith("Base directory for this skill:"))return!1}if(l.type==="user"){const c=l.content||"";if(c.includes("<command-message>")&&c.includes("<command-name>")&&c.includes("<command-args>")||c.includes("ARGUMENTS:")&&(c.includes("<command-name>")||c.match(/\nARGUMENTS:/)))return!1}return!0}function u(l){return{type:l.type||"unknown",content:l.content||"",timestamp:l.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...l.metadata}}}return(l,m)=>(d(),p("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(d(),p("div",ad," No messages yet. Start a conversation! ")):I("",!0),(d(!0),p(se,null,ae(i.value,(c,b)=>(d(),we(id,{key:`msg-${c.timestamp}-${b}`,message:u(c)},null,8,["message"]))),128))],512))}},ld=G(rd,[["__scopeId","data-v-f94a8763"]]),cd={class:"border-top bg-light"},ud={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},dd={class:"d-flex gap-2 align-items-end px-2 py-1"},pd=["placeholder","disabled","onKeydown"],md=["disabled"],fd={__name:"InputArea",setup(n){const e=ee(),t=Ye(),o=D(null),i=v({get:()=>e.currentInput,set:h=>{e.currentInput=h}}),a=v(()=>e.currentSession?.is_processing||!1),r=v(()=>t.sessionConnected),u=v(()=>e.currentSession?.state==="starting"),l=v(()=>u.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function m(){const h=o.value;if(!h)return;h.style.height="auto";const f=Math.min(h.scrollHeight,parseInt(getComputedStyle(h).maxHeight));h.style.height=f+"px"}function c(){i.value.trim()&&(t.sendMessage(i.value),i.value="",o.value&&(o.value.style.height="auto"))}function b(){t.interruptSession()}return(h,f)=>(d(),p("div",cd,[r.value?I("",!0):(d(),p("div",ud,[...f[1]||(f[1]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-exclamation-triangle-fill flex-shrink-0",viewBox:"0 0 16 16"},[s("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})],-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",dd,[te(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":f[0]||(f[0]=C=>i.value=C),class:"form-control",placeholder:l.value,disabled:u.value||!r.value,rows:"1",onInput:m,onKeydown:Xt(he(c,["exact","prevent"]),["enter"])},null,40,pd),[[pe,i.value]]),a.value?(d(),p("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:b}," Stop ")):(d(),p("button",{key:1,class:"btn btn-primary",disabled:!i.value.trim()||!r.value||u.value,onClick:c}," Send ",8,md))])]))}},vd=G(fd,[["__scopeId","data-v-d2ca2648"]]),hd={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},_d={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},gd={class:"text-secondary"},bd={class:"d-flex flex-column flex-grow-1 overflow-hidden"},ao={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ee(),o=ce(),i=v(()=>t.currentSession),a=v(()=>o.isLoading),r=v(()=>o.loadingMessage);return me(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),le(()=>e.sessionId,async(u,l)=>{if(u!==l&&u!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(u)}finally{o.hideLoading()}}}),be(()=>{}),(u,l)=>(d(),p("div",hd,[a.value?(d(),p("div",_d,[l[0]||(l[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",gd,$(r.value),1)])):I("",!0),i.value?(d(),we(Ai,{key:1,"session-id":e.sessionId},null,8,["session-id"])):I("",!0),s("div",bd,[ie(ld)]),ie(vd),i.value?(d(),we(Li,{key:2,"session-id":e.sessionId},null,8,["session-id"])):I("",!0),i.value?(d(),we(Bi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):I("",!0)]))}},bt=gt("legion",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(null),u=v(()=>n.value.get(r.value)||[]),l=v(()=>e.value.get(r.value)||[]),m=v(()=>t.value.get(r.value)||[]),c=v(()=>o.value.get(r.value)||[]);function b(x){r.value=x}async function h(x,N=100,S=0){try{const E=await Z.get(`/api/legions/${x}/timeline?limit=${N}&offset=${S}`),k=E.comms||[],O=E.total_count||k.length,L=E.has_more||!1;return k.sort((R,F)=>new Date(R.timestamp)-new Date(F.timestamp)),console.log(`Loaded ${k.length} of ${O} comms for legion ${x}`),n.value.set(x,k),n.value=new Map(n.value),{comms:k,totalCount:O,hasMore:L}}catch(E){throw console.error("Failed to load timeline:",E),E}}function f(x,N){n.value.has(x)||n.value.set(x,[]),n.value.get(x).push(N),n.value=new Map(n.value)}async function C(x,N){try{const E=(await Z.post(`/api/legions/${x}/comms`,N)).comm;return console.log(`Sent comm ${E.comm_id} to legion ${x}`),E}catch(S){throw console.error("Failed to send comm:",S),S}}async function _(x){return console.log(`Minions for legion ${x} are already available in session store`),[]}async function g(x,N){try{const E=(await Z.post(`/api/legions/${x}/minions`,N)).minion;return await _(x),console.log(`Created minion ${E.minion_id} in legion ${x}`),E}catch(S){throw console.error("Failed to create minion:",S),S}}async function y(x){try{const S=(await Z.get(`/api/legions/${x}/hordes`)).hordes||[];return console.log(`Loaded ${S.length} hordes for legion ${x}`),t.value.set(x,S),t.value=new Map(t.value),S}catch(N){throw console.error("Failed to load hordes:",N),N}}async function M(x){try{const S=(await Z.get(`/api/legions/${x}/channels`)).channels||[];return console.log(`Loaded ${S.length} channels for legion ${x}`),o.value.set(x,S),o.value=new Map(o.value),S}catch(N){throw console.error("Failed to load channels:",N),N}}async function T(x){try{const N=await Z.get(`/api/channels/${x}`),S=N.channel||N;return console.log(`Loaded details for channel ${x}`),i.value.set(x,S),i.value=new Map(i.value),S}catch(N){throw console.error("Failed to load channel details:",N),N}}async function w(x,N=1e3){try{const E=(await Z.get(`/api/channels/${x}/comms?limit=${N}`)).comms||[];return console.log(`Loaded ${E.length} comms for channel ${x}`),E.sort((k,O)=>new Date(k.timestamp)-new Date(O.timestamp)),a.value.set(x,E),a.value=new Map(a.value),E}catch(S){throw console.error("Failed to load channel comms:",S),S}}async function P(x,N){try{await Z.post(`/api/channels/${x}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:N}),console.log(`Added minion ${N} to channel ${x}`),await T(x)}catch(S){throw console.error("Failed to add member to channel:",S),S}}async function j(x,N){try{await Z.post(`/api/channels/${x}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:N}),console.log(`Removed minion ${N} from channel ${x}`),await T(x)}catch(S){throw console.error("Failed to remove member from channel:",S),S}}function A(x){n.value.delete(x),e.value.delete(x),t.value.delete(x),o.value.delete(x),n.value=new Map(n.value),e.value=new Map(e.value),t.value=new Map(t.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:t,channelsByLegion:o,channelDetailsByChannel:i,channelCommsByChannel:a,currentLegionId:r,currentComms:u,currentMinions:l,currentHordes:m,currentChannels:c,setCurrentLegion:b,loadTimeline:h,addComm:f,sendComm:C,loadMinions:_,createMinion:g,loadHordes:y,loadChannels:M,loadChannelDetails:T,loadChannelComms:w,addMemberToChannel:P,removeMemberFromChannel:j,clearLegionData:A}}),yd=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:bt},Symbol.toStringTag,{value:"Module"})),$d={class:"timeline-header border-bottom p-3"},wd={class:"project-name"},Ed=["title"],Cd={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=ve(),o=v(()=>t.projects.get(e.legionId)),i=v(()=>o.value?.name||"Legion");return(a,r)=>(d(),p("div",$d,[s("div",null,[s("div",wd,$(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Ed)])]))}},Sd=G(Cd,[["__scopeId","data-v-44f386f5"]]),Td={class:"timeline-status-bar border-top p-2 bg-light"},kd={class:"d-flex justify-content-end"},xd={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ce();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(d(),p("div",Td,[s("div",kd,[s("button",{class:K(["btn btn-sm",Jt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+$(Jt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Ad=G(xd,[["__scopeId","data-v-891c73db"]]),Md={class:"comm-composer border-top p-3"},Od={class:"d-flex gap-2 mb-2"},Nd={class:"flex-grow-1"},Dd=["disabled"],Ld={label:"Minions"},Id=["value"],Pd={key:0,label:"Channels"},jd=["value"],Rd={style:{"min-width":"150px"}},Vd=["disabled"],Hd={class:"d-flex gap-2 align-items-end position-relative"},Wd={class:"flex-grow-1 position-relative"},Fd=["disabled"],Bd=["onClick","onMouseenter"],Ud=["disabled"],qd={key:0},zd={key:1},Kd={__name:"CommComposer",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=ee(),i=ve(),a=D(""),r=D("task"),u=D(""),l=D(!1),m=D(!1),c=D([]),b=D(0),h=D(-1),f=D(null),C=D(null),_=v(()=>{const S=i.projects.get(e.legionId);return!S||!S.session_ids?[]:S.session_ids.map(E=>o.sessions.get(E)).filter(E=>E&&E.is_minion)}),g=v(()=>t.currentChannels||[]),y=v(()=>a.value&&u.value.trim().length>0);function M(S){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[S.state]||"â—‹"}function T(S){return S.is_minion&&S.role?`${S.name} (${S.role})`:S.name}function w(){const S=f.value;if(!S)return;S.style.height="auto";const E=Math.min(S.scrollHeight,parseInt(getComputedStyle(S).maxHeight));S.style.height=E+"px"}function P(){const S=f.value;if(!S)return;w();const E=u.value,k=S.selectionStart,O=E.substring(0,k),L=O.lastIndexOf("#");if(L===-1){m.value=!1;return}const R=O.substring(L+1).toLowerCase();if(R.includes(" ")){m.value=!1;return}const F=_.value.filter(B=>B.name.toLowerCase().includes(R)).map(B=>({type:"minion",name:B.name,role:B.role,id:B.session_id,state:B.state}));if(F.length===0){m.value=!1;return}c.value=F,b.value=0,h.value=L,m.value=!0}function j(){if(!C.value)return;const S=C.value,E=S.children[b.value];if(!E)return;const k=E.offsetTop,O=E.offsetHeight,L=S.scrollTop,R=S.clientHeight;k<L?S.scrollTop=k:k+O>L+R&&(S.scrollTop=k+O-R)}function A(S){if(!m.value){S.key==="Enter"&&!S.shiftKey&&y.value&&(S.preventDefault(),N());return}if(S.key==="ArrowDown")S.preventDefault(),b.value=(b.value+1)%c.value.length,j();else if(S.key==="ArrowUp")S.preventDefault(),b.value=b.value===0?c.value.length-1:b.value-1,j();else if(S.key==="Enter"){S.preventDefault();const E=c.value[b.value];E&&x(E)}else S.key==="Escape"&&(m.value=!1)}function x(S){const E=f.value;if(!E)return;const k=u.value,O=E.selectionStart,L=k.substring(0,h.value)+"#"+S.name+" "+k.substring(O);u.value=L;const R=h.value+S.name.length+2;setTimeout(()=>{E.setSelectionRange(R,R),E.focus()},0),m.value=!1}async function N(){if(!(!y.value||l.value)){l.value=!0;try{const[S,E]=a.value.split(":"),k={comm_type:r.value,content:u.value.trim()};S==="minion"?k.to_minion_id=E:S==="channel"&&(k.to_channel_id=E),await t.sendComm(e.legionId,k),u.value="",w()}catch(S){console.error("Failed to send comm:",S),alert(`Failed to send comm: ${S.message}`)}finally{l.value=!1}}}return le(m,S=>{if(S){const E=k=>{k.target.closest(".comm-composer")||(m.value=!1,document.removeEventListener("click",E))};setTimeout(()=>document.addEventListener("click",E),0)}}),(S,E)=>(d(),p("div",Md,[s("div",Od,[s("div",Nd,[te(s("select",{"onUpdate:modelValue":E[0]||(E[0]=k=>a.value=k),class:"form-select form-select-sm",disabled:l.value},[E[3]||(E[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Ld,[(d(!0),p(se,null,ae(_.value,k=>(d(),p("option",{key:k.session_id,value:`minion:${k.session_id}`},$(M(k))+" "+$(T(k)),9,Id))),128))]),g.value.length>0?(d(),p("optgroup",Pd,[(d(!0),p(se,null,ae(g.value,k=>(d(),p("option",{key:k.channel_id,value:`channel:${k.channel_id}`}," #ï¸âƒ£ "+$(k.name),9,jd))),128))])):I("",!0)],8,Dd),[[Fe,a.value]])]),s("div",Rd,[te(s("select",{"onUpdate:modelValue":E[1]||(E[1]=k=>r.value=k),class:"form-select form-select-sm",disabled:l.value},[...E[4]||(E[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Vd),[[Fe,r.value]])])]),s("div",Hd,[s("div",Wd,[te(s("textarea",{ref_key:"contentTextarea",ref:f,"onUpdate:modelValue":E[2]||(E[2]=k=>u.value=k),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:l.value,onInput:P,onKeydown:A},null,40,Fd),[[pe,u.value]]),m.value?(d(),p("div",{key:0,ref_key:"autocompleteDropdown",ref:C,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(d(!0),p(se,null,ae(c.value,(k,O)=>(d(),p("div",{key:k.id,class:K(["autocomplete-item px-2 py-1",{"bg-light":O===b.value}]),onClick:L=>x(k),onMouseenter:L=>b.value=O},$(k.type==="minion"?M(k):"#ï¸âƒ£")+" "+$(k.name)+$(k.role?` (${k.role})`:""),43,Bd))),128))],512)):I("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!y.value||l.value,onClick:N},[l.value?(d(),p("span",qd,[...E[5]||(E[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),Y(" Sending... ",-1)])])):(d(),p("span",zd,"Send"))],8,Ud)])])]))}},Yd=G(Kd,[["__scopeId","data-v-ffa54193"]]),Gd={class:"timeline-view d-flex flex-column h-100"},Jd={key:0,class:"text-center text-muted"},Xd={key:1,class:"text-center text-danger"},Qd={key:2,class:"text-center text-muted"},Zd={key:3,class:"comm-list"},ep={class:"col-auto message-speaker text-end pe-3"},tp={class:"text-muted"},sp={class:"col message-content-column"},np={class:"card-body p-2"},op={class:"d-flex justify-content-between align-items-start mb-1"},ip={class:"comm-content"},ap="ffffffff-ffff-ffff-ffff-ffffffffffff",rp={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=ve(),i=ee(),a=Ye(),r=ce(),u=D(!0),l=D(null),m=D(null),c=v(()=>o.projects.get(e.legionId));v(()=>c.value?.name||"Legion");const b=v(()=>t.currentComms);v(()=>t.currentMinions);function h(P){return P.from_minion_id===ap}function f(P){return P.from_user?"You":P.from_minion_id?h(P)?"SYSTEM":i.sessions.get(P.from_minion_id)?.name||"Unknown":"Unknown"}function C(P){return P.to_user?"You":P.to_minion_id?i.sessions.get(P.to_minion_id)?.name||"Unknown":P.to_channel_id?P.to_channel_name?`#${P.to_channel_name}`:P.to_channel_id:"All"}function _(P){return{task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success"}[P]||"bg-secondary"}function g(P){return new Date(P).toLocaleTimeString()}async function y(){r.autoScrollEnabled&&(await Os(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function M(){u.value=!0,l.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await Os(),await y(),setTimeout(()=>{y()},100)}catch(P){console.error("Failed to load timeline:",P),P.response?l.value=`${P.message} (${P.response.status})`:l.value=P.message||"Unknown error"}finally{u.value=!1}}function T(){a.connectLegion(e.legionId)}function w(){a.disconnectLegion()}return le(()=>b.value.length,()=>{y()}),me(()=>{M(),T(),setTimeout(()=>{y()},100)}),be(()=>{w()}),(P,j)=>(d(),p("div",Gd,[ie(Sd,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto p-3"},[u.value?(d(),p("div",Jd,[...j[0]||(j[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),Y(" Loading timeline... ",-1)])])):l.value?(d(),p("div",Xd," Failed to load timeline: "+$(l.value),1)):b.value.length===0?(d(),p("div",Qd," No messages yet. Minions will appear here once they start communicating. ")):(d(),p("div",Zd,[(d(!0),p(se,null,ae(b.value,A=>(d(),p("div",{key:A.comm_id,class:K(["comm-item message-row row py-2 mb-2",{"system-comm":h(A)}])},[s("div",ep,[s("small",tp,$(g(A.timestamp)),1)]),s("div",sp,[s("div",{class:K(["comm-card card",{"system-card":h(A)}])},[s("div",np,[s("div",op,[s("div",null,[s("span",{class:K(["badge",_(A.comm_type)])},$(A.comm_type),3),s("strong",{class:K(["ms-2",{"system-sender":h(A)}])},$(f(A)),3),j[1]||(j[1]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",{class:K({"recipient-channel":A.to_channel_id})},$(C(A)),3)])]),s("div",ip,$(A.content),1)])],2)])],2))),128))]))],512),ie(Yd,{"legion-id":n.legionId},null,8,["legion-id"]),ie(Ad,{"legion-id":n.legionId},null,8,["legion-id"])]))}},lp=G(rp,[["__scopeId","data-v-6d97bd0b"]]),cp={class:"spy-view d-flex flex-column overflow-hidden"},up={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){return(e,t)=>(d(),p("div",cp,[ie(ao,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},dp=G(up,[["__scopeId","data-v-43a24eaf"]]),pp={class:"horde-header border-bottom p-3"},mp={class:"project-name"},fp={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=ve(),o=v(()=>t.projects.get(e.legionId)),i=v(()=>o.value?.name||"Legion");return(a,r)=>(d(),p("div",pp,[s("div",null,[s("div",mp,$(i.value),1),r[0]||(r[0]=s("div",{class:"view-name"},"Minion Hierarchy",-1))])]))}},vp=G(fp,[["__scopeId","data-v-0c86e2b5"]]),hp={class:"horde-status-bar border-top p-2 bg-light"},_p={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,t)=>(d(),p("div",hp,[...t[0]||(t[0]=[s("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},gp=G(_p,[["__scopeId","data-v-f0e64ab0"]]),bp={class:"minion-card border-start border-2 mb-2"},yp={class:"node-row"},$p={class:"node-left"},wp={key:0,class:"me-2"},Ep={key:1,class:"badge bg-secondary ms-2"},Cp={class:"node-right"},Sp={key:0,class:"last-comm-preview"},Tp={class:"comm-direction"},kp=["title"],xp={key:1,class:"text-muted fst-italic small"},Ap={key:0,class:"minion-children"},Mp={key:1,class:"text-danger small ms-4"},Op={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,t=v(()=>e.level*24),o=v(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=v(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=v(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),r=v(()=>{const c=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[c]||"status-dot-grey"}),u=v(()=>{const c=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}});function l(c){return c.to_user?"User":c.to_minion_name?c.to_minion_name:c.to_channel_name?`#${c.to_channel_name}`:"unknown"}function m(c){const b=c.summary||c.content||"";return b.length>150?b.substring(0,150)+"...":b}return(c,b)=>{const h=oo("MinionTreeNode",!0);return n.minionData?(d(),p("div",{key:0,class:"minion-tree-node",style:je({marginLeft:`${t.value}px`})},[s("div",bp,[s("div",yp,[s("div",$p,[s("div",{class:K(["status-dot me-2",r.value]),style:je(u.value)},null,6),i.value?(d(),p("span",wp,"ðŸ‘‘")):I("",!0),s("strong",null,$(n.minionData.name),1),i.value?(d(),p("span",Ep,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):I("",!0)]),s("div",Cp,[n.minionData.last_comm?(d(),p("div",Sp,[s("span",Tp,[b[0]||(b[0]=Y(" â†’ ",-1)),s("strong",null,$(l(n.minionData.last_comm)),1),b[1]||(b[1]=Y(": ",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},$(m(n.minionData.last_comm)),9,kp)])):(d(),p("div",xp," No communications yet "))])])]),o.value?(d(),p("div",Ap,[(d(!0),p(se,null,ae(n.minionData.children,f=>(d(),we(h,{key:f.id,"minion-data":f,level:n.level+1},null,8,["minion-data","level"]))),128))])):I("",!0)],4)):(d(),p("div",Mp," âš  Minion data is missing "))}}},Np=G(Op,[["__scopeId","data-v-1cd9863f"]]),Dp={class:"horde-view d-flex flex-column h-100"},Lp={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},Ip={key:0,class:"text-center py-5"},Pp={key:1,class:"alert alert-danger"},jp={class:"mb-0"},Rp={key:2,class:"horde-tree"},Vp={class:"user-root-node mb-3 border rounded bg-white"},Hp={class:"node-row"},Wp={class:"node-left"},Fp={key:0,class:"badge bg-primary ms-2"},Bp={class:"node-right"},Up={key:0,class:"last-comm-preview"},qp={class:"comm-direction"},zp=["title"],Kp={key:1,class:"text-muted fst-italic"},Yp={key:0,class:"alert alert-info ms-4"},Gp={key:1,class:"root-minions ms-4"},Jp={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=ve(),o=ee(),i=Ye(),a=bt(),r=D(null),u=D(!1),l=D(null);v(()=>t.projects.get(e.legionId));const m=v(()=>r.value&&r.value.children&&r.value.children.length>0);async function c(){u.value=!0,l.value=null;try{const _=await Z.get(`/api/legions/${e.legionId}/hordes`);r.value=_,console.log("Loaded hierarchy:",_)}catch(_){console.error("Failed to load hierarchy:",_),l.value=_.message||"Unknown error"}finally{u.value=!1}}me(()=>{c()}),le(()=>e.legionId,()=>{c()});function b(_){return _.to_user?"User":_.to_minion_name?_.to_minion_name:_.to_channel_name?`#${_.to_channel_name}`:"unknown"}function h(_){const g=_.summary||_.content||"";return g.length>150?g.substring(0,150)+"...":g}function f(_,g){if(_.id===g)return _;if(_.children)for(const y of _.children){const M=f(y,g);if(M)return M}return null}function C(_){if(r.value){if(_.from_minion_id){const g=f(r.value,_.from_minion_id);g&&g.type==="minion"&&(g.last_comm=_,console.log(`Updated minion ${g.name} last_comm`))}_.from_user&&r.value.type==="user"&&(r.value.last_comm=_,console.log("Updated user last_comm"))}}return me(()=>{c(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),le(()=>o.sessions,_=>{if(r.value){for(const[g,y]of _)if(y.is_minion&&y.project_id===e.legionId){const M=f(r.value,g);M&&M.type==="minion"&&(M.state!==y.state&&(M.state=y.state,console.log(`Updated minion ${M.name} state to ${y.state}`)),M.is_processing!==y.is_processing&&(M.is_processing=y.is_processing,console.log(`Updated minion ${M.name} is_processing to ${y.is_processing}`)))}}},{deep:!0}),le(()=>a.commsByLegion.get(e.legionId),_=>{if(_&&_.length>0){const g=_[_.length-1];C(g)}},{deep:!0}),le(()=>o.sessions.size,(_,g)=>{_>g&&Array.from(o.sessions.values()).some(T=>T.is_minion&&T.project_id===e.legionId&&!f(r.value,T.session_id))&&(console.log("New minion detected, reloading hierarchy"),c())})}),be(()=>{console.log("HordeView unmounted")}),(_,g)=>(d(),p("div",Dp,[ie(vp,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",Lp,[u.value?(d(),p("div",Ip,[...g[0]||(g[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):l.value?(d(),p("div",Pp,[g[1]||(g[1]=s("strong",null,"Failed to load hierarchy",-1)),s("p",jp,$(l.value),1)])):r.value?(d(),p("div",Rp,[s("div",Vp,[s("div",Hp,[s("div",Wp,[g[2]||(g[2]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,$(r.value.name),1),m.value?(d(),p("span",Fp,$(r.value.children.length)+" "+$(r.value.children.length===1?"minion":"minions"),1)):I("",!0)]),s("div",Bp,[r.value.last_comm?(d(),p("div",Up,[s("span",qp,[g[3]||(g[3]=Y(" â†’ ",-1)),s("strong",null,$(b(r.value.last_comm)),1),g[4]||(g[4]=Y(": ",-1))]),s("span",{class:"comm-content",title:r.value.last_comm.content||""},$(h(r.value.last_comm)),9,zp)])):(d(),p("div",Kp," No communications yet "))])])]),m.value?(d(),p("div",Gp,[(d(!0),p(se,null,ae(r.value.children,y=>(d(),we(Np,{key:y.id,"minion-data":y,level:1},null,8,["minion-data"]))),128))])):(d(),p("div",Yp,[...g[5]||(g[5]=[s("p",{class:"mb-2"},"No minions yet",-1),s("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):I("",!0)]),ie(gp,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Xp=G(Jp,[["__scopeId","data-v-af6338a3"]]),Qp={class:"channel-view d-flex flex-column h-100"},Zp={class:"channel-header border-bottom p-3"},em={class:"d-flex align-items-center justify-content-between"},tm={class:"mb-0"},sm={class:"text-muted"},nm={class:"badge bg-secondary"},om={class:"channel-content flex-grow-1 overflow-auto"},im={key:0,class:"text-center text-muted py-4"},am={key:1,class:"text-center text-danger py-4"},rm={key:2,class:"text-center text-muted py-4"},lm={key:3,class:"p-3"},cm={class:"overview-section mb-4"},um={class:"row g-3"},dm={class:"col-md-6"},pm={class:"font-monospace small text-muted"},mm={class:"col-md-6"},fm={class:"text-muted"},vm={class:"col-12"},hm={class:"text-muted"},_m={class:"col-12"},gm={class:"text-muted"},bm={class:"members-section mb-4"},ym={class:"text-muted border-bottom pb-2 d-flex align-items-center justify-content-between"},$m={key:0,class:"mb-3"},wm=["value"],Em={key:1,class:"text-center text-muted py-3"},Cm={key:2,class:"list-group"},Sm={class:"d-flex align-items-center gap-2"},Tm=["title"],km={class:"fw-semibold"},xm={class:"text-muted"},Am=["onClick"],Mm={class:"comms-section"},Om={class:"text-muted border-bottom pb-2"},Nm={key:0,class:"text-center text-muted py-4"},Dm={key:1,class:"text-center text-muted py-3"},Lm={key:2,class:"comm-list"},Im={class:"card-body p-2"},Pm={class:"d-flex justify-content-between align-items-start mb-1"},jm={class:"ms-2"},Rm={class:"text-muted ms-2"},Vm={key:0,class:"text-muted small mb-1"},Hm={class:"comm-content"},Wm={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=ve(),i=ee(),a=D(!0),r=D(null),u=D(!1),l=D(!1),m=D(""),c=v(()=>o.projects.get(e.legionId)),b=v(()=>t.channelDetailsByChannel.get(e.channelId)),h=v(()=>t.channelCommsByChannel.get(e.channelId)||[]),f=v(()=>b.value?.member_minion_ids?.length||0),C=v(()=>h.value.length),_=v(()=>b.value?.member_minion_ids?b.value.member_minion_ids.map(N=>i.sessions.get(N)).filter(Boolean):[]),g=v(()=>{if(!b.value)return[];const N=new Set(b.value.member_minion_ids||[]);return Array.from(i.sessions.values()).filter(E=>E.is_minion).filter(E=>!N.has(E.session_id))});function y(N){if(N.state==="paused"&&N.is_processing)return"status-blinking";const S=N.is_processing?"processing":N.state;return S==="starting"||S==="processing"?"status-blinking":""}function M(N){if(N.state==="paused"&&N.is_processing)return{backgroundColor:"#ffc107"};const S=N.is_processing?"processing":N.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[S]||"#d3d3d3"}}function T(N){return N.from_user?"You":N.from_minion_name?N.from_minion_name:N.from_minion_id&&i.sessions.get(N.from_minion_id)?.name||"Unknown"}function w(N){return{task:"bg-primary",question:"bg-info",report:"bg-success",info:"bg-secondary",halt:"bg-danger",pivot:"bg-warning"}[N?.toLowerCase()]||"bg-secondary"}function P(N){return N?new Date(N).toLocaleString():"N/A"}function j(N){return N?new Date(N).toLocaleString():"N/A"}async function A(){if(!(!m.value||!e.channelId))try{await t.addMemberToChannel(e.channelId,m.value),m.value="",l.value=!1}catch(N){console.error("Failed to add member:",N),alert("Failed to add member to channel")}}async function x(N){if(confirm("Remove this minion from the channel?"))try{await t.removeMemberFromChannel(e.channelId,N)}catch(E){console.error("Failed to remove member:",E),alert("Failed to remove member from channel")}}return me(async()=>{a.value=!0;try{await t.loadChannelDetails(e.channelId),u.value=!0,await t.loadChannelComms(e.channelId,1e3),u.value=!1}catch(N){console.error("Failed to load channel:",N),r.value=N.message||"Unknown error"}finally{a.value=!1}}),le(()=>e.channelId,async N=>{if(N){a.value=!0,r.value=null;try{await t.loadChannelDetails(N),u.value=!0,await t.loadChannelComms(N,1e3),u.value=!1}catch(S){console.error("Failed to load channel:",S),r.value=S.message||"Unknown error"}finally{a.value=!1}}}),(N,S)=>(d(),p("div",Qp,[s("div",Zp,[s("div",em,[s("div",null,[s("h5",tm," ðŸ’¬ "+$(b.value?.name||"Channel"),1),s("small",sm,$(c.value?.name||"Legion"),1)]),s("span",nm,$(f.value)+" members",1)])]),s("div",om,[a.value?(d(),p("div",im,[...S[2]||(S[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),s("div",{class:"mt-2"},"Loading channel...",-1)])])):r.value?(d(),p("div",am," Failed to load channel: "+$(r.value),1)):b.value?(d(),p("div",lm,[s("div",cm,[S[7]||(S[7]=s("h6",{class:"text-muted border-bottom pb-2"},"Overview",-1)),s("div",um,[s("div",dm,[S[3]||(S[3]=s("strong",null,"Channel ID:",-1)),s("div",pm,$(b.value.channel_id),1)]),s("div",mm,[S[4]||(S[4]=s("strong",null,"Created:",-1)),s("div",fm,$(P(b.value.created_at)),1)]),s("div",vm,[S[5]||(S[5]=s("strong",null,"Purpose:",-1)),s("div",hm,$(b.value.purpose||"No purpose specified"),1)]),s("div",_m,[S[6]||(S[6]=s("strong",null,"Description:",-1)),s("div",gm,$(b.value.description||"No description provided"),1)])])]),s("div",bm,[s("h6",ym,[s("span",null,"Members ("+$(f.value)+")",1),s("button",{class:"btn btn-sm btn-primary",onClick:S[0]||(S[0]=E=>l.value=!l.value)}," âž• Add Member ")]),l.value?(d(),p("div",$m,[te(s("select",{"onUpdate:modelValue":S[1]||(S[1]=E=>m.value=E),class:"form-select form-select-sm",onChange:A},[S[8]||(S[8]=s("option",{value:""},"-- Select Minion to Add --",-1)),(d(!0),p(se,null,ae(g.value,E=>(d(),p("option",{key:E.session_id,value:E.session_id},$(E.name)+" ("+$(E.role||"No role")+") ",9,wm))),128))],544),[[Fe,m.value]])])):I("",!0),_.value.length===0?(d(),p("div",Em," No members in this channel yet ")):(d(),p("div",Cm,[(d(!0),p(se,null,ae(_.value,E=>(d(),p("div",{key:E.session_id,class:"list-group-item d-flex align-items-center justify-content-between"},[s("div",Sm,[s("span",{class:K(["status-dot",y(E)]),style:je(M(E)),title:E.state},null,14,Tm),s("div",null,[s("div",km,$(E.name),1),s("small",xm,$(E.role||"No role"),1)])]),s("button",{class:"btn btn-sm btn-outline-danger",onClick:k=>x(E.session_id),title:"Remove member from channel"}," Remove ",8,Am)]))),128))]))]),s("div",Mm,[s("h6",Om,"Communications ("+$(C.value)+")",1),u.value?(d(),p("div",Nm,[...S[9]||(S[9]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),s("div",{class:"mt-2"},"Loading comms...",-1)])])):h.value.length===0?(d(),p("div",Dm," No communications in this channel yet ")):(d(),p("div",Lm,[(d(!0),p(se,null,ae(h.value,E=>(d(),p("div",{key:E.comm_id,class:"comm-item card mb-2"},[s("div",Im,[s("div",Pm,[s("div",null,[s("span",{class:K(["badge",w(E.comm_type)])},$(E.comm_type),3),s("strong",jm,$(T(E)),1),s("small",Rm,$(j(E.timestamp)),1)])]),E.summary?(d(),p("div",Vm,[S[10]||(S[10]=s("strong",null,"Summary:",-1)),Y(" "+$(E.summary),1)])):I("",!0),s("div",Hm,$(E.content),1)])]))),128))]))])])):(d(),p("div",rm," Channel not found "))])]))}},Fm=G(Wm,[["__scopeId","data-v-e09adf09"]]),Bm=[{path:"/",name:"home",component:gi},{path:"/session/:sessionId",name:"session",component:ao,props:!0},{path:"/timeline/:legionId",name:"timeline",component:lp,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:dp,props:!0},{path:"/horde/:legionId",name:"horde",component:Xp,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:Fm,props:!0}],Um=pi({history:mi(),routes:Bm}),qm={__name:"ConnectionIndicator",setup(n){const e=Ye(),t=D(!1);le(()=>e.overallStatus,(a,r)=>{a!==r&&r!==void 0&&(console.log(`ðŸ”„ Connection status changed: ${r} â†’ ${a}`),t.value=!0,setTimeout(()=>{t.value=!1},600))});const o=v(()=>{const a=[];switch(e.overallStatus){case"connected":a.push("bg-success");break;case"partial":a.push("bg-warning");break;default:a.push("bg-secondary")}return t.value&&a.push("status-flash"),a.join(" ")}),i=v(()=>{switch(e.overallStatus){case"connected":return"Connected";case"partial":return"Partial Connection";default:return"Disconnected"}});return(a,r)=>(d(),p("span",{id:"connection-indicator",class:K(["badge",o.value])},$(i.value),3))}},zm=G(qm,[["__scopeId","data-v-c966b4c3"]]),Km={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Ym={class:"d-flex align-items-center gap-2"},Gm={__name:"AppHeader",setup(n){const e=ce();function t(){e.toggleSidebar()}return(o,i)=>(d(),p("header",Km,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",Ym,[ie(zm)])]))}},Jm={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Xm={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Qm=["title"],Zm={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(u){return u.state==="paused"&&u.is_processing?"pending-prompt":u.is_processing?"processing":u.state}function i(u){const l=o(u);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[l]||"#d3d3d3"}function a(u){const l=o(u);return l==="starting"||l==="processing"||l==="pending-prompt"}function r(u){const l=o(u),m=l.charAt(0).toUpperCase()+l.slice(1),c=u.name||"Unnamed Session",b=u.is_minion&&u.role?` (${u.role})`:"";return`${c}${b}: ${m}`}return(u,l)=>(d(),p("div",Jm,[!n.sessions||n.sessions.length===0?(d(),p("div",Xm)):(d(!0),p(se,{key:1},ae(n.sessions,m=>(d(),p("div",{key:m.session_id,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":a(m)}]),style:je({width:t.value,backgroundColor:i(m),cursor:"help"}),title:r(m)},null,14,Qm))),128))]))}},ef=G(Zm,[["__scopeId","data-v-a79cfeec"]]),tf={class:"flex-grow-1"},sf={key:0,class:"text-muted small ms-1"},nf={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,t=Ke(),o=ee(),i=ve(),a=ce(),r=v(()=>o.currentSessionId===e.session.session_id),u=v(()=>o.deletingSessions.has(e.session.session_id)),l=v(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),m=v(()=>{const y=l.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[y]||"status-dot-grey"}),c=v(()=>{const y=l.value,M={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},T={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:M[y]||"#d3d3d3",borderColor:T[y]||"#6c757d"}});function b(){o.selectSession(e.session.session_id),t.push(`/session/${e.session.session_id}`)}function h(){a.showModal("edit-session",{session:e.session})}function f(y){y.dataTransfer.effectAllowed="move",y.dataTransfer.setData("application/session-id",e.session.session_id),y.dataTransfer.setData("application/project-id",e.projectId),y.dataTransfer.setData("text/plain",e.session.session_id),y.target.classList.add("dragging")}function C(y){y.target.classList.remove("dragging")}function _(y){y.preventDefault(),y.dataTransfer.dropEffect="move";const M=y.currentTarget.getBoundingClientRect(),T=M.top+M.height/2;y.clientY<T?(y.currentTarget.classList.add("drop-above"),y.currentTarget.classList.remove("drop-below")):(y.currentTarget.classList.add("drop-below"),y.currentTarget.classList.remove("drop-above"))}function g(y){y.preventDefault(),y.currentTarget.classList.remove("drop-above","drop-below");const M=y.dataTransfer.getData("application/session-id")||y.dataTransfer.getData("text/plain"),T=y.dataTransfer.getData("application/project-id");if(!M||M===e.session.session_id||T!==e.projectId)return;const w=y.currentTarget.getBoundingClientRect(),P=w.top+w.height/2,j=y.clientY<P,A=i.getProject(e.projectId);if(!A||!A.session_ids)return;const x=[...A.session_ids],N=x.indexOf(e.session.session_id),S=x.indexOf(M);if(N===-1||S===-1)return;const E=[...x],[k]=E.splice(S,1);let O=j?N:N+1;S<N&&O--,E.splice(O,0,k),i.reorderSessionsInProject(e.projectId,E)}return(y,M)=>(d(),p("div",{class:K(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:r.value,"session-deleting":u.value}]),style:{cursor:"pointer"},draggable:"true",onClick:b,onDragstart:f,onDragend:C,onDragover:_,onDrop:g},[s("div",{class:K(["status-dot me-2",m.value]),style:je(c.value)},null,6),s("div",tf,[s("span",null,$(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(d(),p("span",sf,"("+$(n.session.role)+")",1)):I("",!0)]),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:he(h,["stop"])}," âœï¸ ")],34))}},of=G(nf,[["__scopeId","data-v-07ecbf94"]]),af={class:"d-flex align-items-center gap-2"},rf=["value"],lf={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ke(),o=ee(),i=ce(),a=D("");le(()=>t.currentRoute.value,_=>{!a.value&&_.name==="spy"&&_.params.minionId&&_.params.legionId===e.project.project_id&&(a.value=_.params.minionId)},{immediate:!0});const r=v(()=>a.value?e.sessions.find(_=>_.session_id===a.value):null),u=v(()=>{const _=t.currentRoute.value;return _.name==="spy"&&_.params.legionId===e.project.project_id}),l=v(()=>{if(!r.value)return"";if(r.value.state==="paused"&&r.value.is_processing)return"status-blinking";const _=r.value.is_processing?"processing":r.value.state;return _==="starting"||_==="processing"?"status-blinking":""}),m=v(()=>{if(!r.value)return{};if(r.value.state==="paused"&&r.value.is_processing)return{backgroundColor:"#ffc107"};const _=r.value.is_processing?"processing":r.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[_]||"#d3d3d3"}});function c(_){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[_.state]||"â—‹"}function b(_){return _.is_minion&&_.role?`${_.name} (${_.role})`:_.name}function h(){a.value&&t.push(`/spy/${e.project.project_id}/${a.value}`)}function f(){a.value?t.push(`/spy/${e.project.project_id}/${a.value}`):t.push("/")}function C(){r.value&&i.showModal("minion-view",{session:r.value})}return le(()=>o.currentSessionId,_=>{if(_)e.sessions.some(g=>g.session_id===_)&&(a.value=_);else{a.value="";const g=t.currentRoute.value;g.name==="spy"&&g.params.legionId===e.project.project_id&&t.push("/")}}),(_,g)=>(d(),p("div",{class:K(["list-group-item list-group-item-action p-2",{active:u.value}])},[s("div",{class:"d-flex align-items-center justify-content-between mb-2",style:je({cursor:a.value?"pointer":"default"}),onClick:h},[g[1]||(g[1]=s("div",{class:"d-flex align-items-center"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ”"),s("span",{class:"fw-semibold"},"Spy"),s("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),s("div",af,[r.value?(d(),p("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:he(C,["stop"]),title:"View minion details"}," ðŸ‘ï¸ ")):I("",!0),r.value?(d(),p("span",{key:1,class:K(["minion-state-indicator",l.value]),style:je(m.value)}," ðŸ‘¤ ",6)):I("",!0)])],4),te(s("select",{"onUpdate:modelValue":g[0]||(g[0]=y=>a.value=y),class:"form-select form-select-sm",onChange:f},[g[2]||(g[2]=s("option",{value:""},"-- Select Minion --",-1)),(d(!0),p(se,null,ae(n.sessions,y=>(d(),p("option",{key:y.session_id,value:y.session_id},$(c(y))+" "+$(b(y)),9,rf))),128))],544),[[Fe,a.value]])],2))}},cf=G(lf,[["__scopeId","data-v-579589fb"]]);var _e="top",Ee="bottom",Ce="right",ge="left",ns="auto",yt=[_e,Ee,Ce,ge],st="start",pt="end",ro="clippingParents",Hs="viewport",lt="popper",lo="reference",Ns=yt.reduce(function(n,e){return n.concat([e+"-"+st,e+"-"+pt])},[]),Ws=[].concat(yt,[ns]).reduce(function(n,e){return n.concat([e,e+"-"+st,e+"-"+pt])},[]),co="beforeRead",uo="read",po="afterRead",mo="beforeMain",fo="main",vo="afterMain",ho="beforeWrite",_o="write",go="afterWrite",bo=[co,uo,po,mo,fo,vo,ho,_o,go];function Le(n){return n?(n.nodeName||"").toLowerCase():null}function Se(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nt(n){var e=Se(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=Se(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Fs(n){if(typeof ShadowRoot>"u")return!1;var e=Se(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function uf(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Te(a)||!Le(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var u=i[r];u===!1?a.removeAttribute(r):a.setAttribute(r,u===!0?"":u)}))})}function df(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),u=r.reduce(function(l,m){return l[m]="",l},{});!Te(i)||!Le(i)||(Object.assign(i.style,u),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const Bs={name:"applyStyles",enabled:!0,phase:"write",fn:uf,effect:df,requires:["computeStyles"]};function Oe(n){return n.split("-")[0]}var tt=Math.max,Qt=Math.min,mt=Math.round;function Ds(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function yo(){return!/^((?!chrome|android).)*safari/i.test(Ds())}function ft(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&mt(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&mt(o.height)/n.offsetHeight||1);var r=nt(n)?Se(n):window,u=r.visualViewport,l=!yo()&&t,m=(o.left+(l&&u?u.offsetLeft:0))/i,c=(o.top+(l&&u?u.offsetTop:0))/a,b=o.width/i,h=o.height/a;return{width:b,height:h,top:c,right:m+b,bottom:c+h,left:m,x:m,y:c}}function Us(n){var e=ft(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function $o(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Fs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Re(n){return Se(n).getComputedStyle(n)}function pf(n){return["table","td","th"].indexOf(Le(n))>=0}function Ge(n){return((nt(n)?n.ownerDocument:n.document)||window.document).documentElement}function os(n){return Le(n)==="html"?n:n.assignedSlot||n.parentNode||(Fs(n)?n.host:null)||Ge(n)}function $n(n){return!Te(n)||Re(n).position==="fixed"?null:n.offsetParent}function mf(n){var e=/firefox/i.test(Ds()),t=/Trident/i.test(Ds());if(t&&Te(n)){var o=Re(n);if(o.position==="fixed")return null}var i=os(n);for(Fs(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Le(i))<0;){var a=Re(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Dt(n){for(var e=Se(n),t=$n(n);t&&pf(t)&&Re(t).position==="static";)t=$n(t);return t&&(Le(t)==="html"||Le(t)==="body"&&Re(t).position==="static")?e:t||mf(n)||e}function qs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function kt(n,e,t){return tt(n,Qt(e,t))}function ff(n,e,t){var o=kt(n,e,t);return o>t?t:o}function wo(){return{top:0,right:0,bottom:0,left:0}}function Eo(n){return Object.assign({},wo(),n)}function Co(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var vf=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Eo(typeof e!="number"?e:Co(e,yt))};function hf(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,r=t.modifiersData.popperOffsets,u=Oe(t.placement),l=qs(u),m=[ge,Ce].indexOf(u)>=0,c=m?"height":"width";if(!(!a||!r)){var b=vf(i.padding,t),h=Us(a),f=l==="y"?_e:ge,C=l==="y"?Ee:Ce,_=t.rects.reference[c]+t.rects.reference[l]-r[l]-t.rects.popper[c],g=r[l]-t.rects.reference[l],y=Dt(a),M=y?l==="y"?y.clientHeight||0:y.clientWidth||0:0,T=_/2-g/2,w=b[f],P=M-h[c]-b[C],j=M/2-h[c]/2+T,A=kt(w,j,P),x=l;t.modifiersData[o]=(e={},e[x]=A,e.centerOffset=A-j,e)}}function _f(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||$o(e.elements.popper,i)&&(e.elements.arrow=i))}const So={name:"arrow",enabled:!0,phase:"main",fn:hf,effect:_f,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function vt(n){return n.split("-")[1]}var gf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function bf(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:mt(t*i)/i||0,y:mt(o*i)/i||0}}function wn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,r=n.offsets,u=n.position,l=n.gpuAcceleration,m=n.adaptive,c=n.roundOffsets,b=n.isFixed,h=r.x,f=h===void 0?0:h,C=r.y,_=C===void 0?0:C,g=typeof c=="function"?c({x:f,y:_}):{x:f,y:_};f=g.x,_=g.y;var y=r.hasOwnProperty("x"),M=r.hasOwnProperty("y"),T=ge,w=_e,P=window;if(m){var j=Dt(t),A="clientHeight",x="clientWidth";if(j===Se(t)&&(j=Ge(t),Re(j).position!=="static"&&u==="absolute"&&(A="scrollHeight",x="scrollWidth")),j=j,i===_e||(i===ge||i===Ce)&&a===pt){w=Ee;var N=b&&j===P&&P.visualViewport?P.visualViewport.height:j[A];_-=N-o.height,_*=l?1:-1}if(i===ge||(i===_e||i===Ee)&&a===pt){T=Ce;var S=b&&j===P&&P.visualViewport?P.visualViewport.width:j[x];f-=S-o.width,f*=l?1:-1}}var E=Object.assign({position:u},m&&gf),k=c===!0?bf({x:f,y:_},Se(t)):{x:f,y:_};if(f=k.x,_=k.y,l){var O;return Object.assign({},E,(O={},O[w]=M?"0":"",O[T]=y?"0":"",O.transform=(P.devicePixelRatio||1)<=1?"translate("+f+"px, "+_+"px)":"translate3d("+f+"px, "+_+"px, 0)",O))}return Object.assign({},E,(e={},e[w]=M?_+"px":"",e[T]=y?f+"px":"",e.transform="",e))}function yf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,r=a===void 0?!0:a,u=t.roundOffsets,l=u===void 0?!0:u,m={placement:Oe(e.placement),variation:vt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,wn(Object.assign({},m,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,wn(Object.assign({},m,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const zs={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:yf,data:{}};var Ht={passive:!0};function $f(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,u=r===void 0?!0:r,l=Se(e.elements.popper),m=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&m.forEach(function(c){c.addEventListener("scroll",t.update,Ht)}),u&&l.addEventListener("resize",t.update,Ht),function(){a&&m.forEach(function(c){c.removeEventListener("scroll",t.update,Ht)}),u&&l.removeEventListener("resize",t.update,Ht)}}const Ks={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:$f,data:{}};var wf={left:"right",right:"left",bottom:"top",top:"bottom"};function Kt(n){return n.replace(/left|right|bottom|top/g,function(e){return wf[e]})}var Ef={start:"end",end:"start"};function En(n){return n.replace(/start|end/g,function(e){return Ef[e]})}function Ys(n){var e=Se(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Gs(n){return ft(Ge(n)).left+Ys(n).scrollLeft}function Cf(n,e){var t=Se(n),o=Ge(n),i=t.visualViewport,a=o.clientWidth,r=o.clientHeight,u=0,l=0;if(i){a=i.width,r=i.height;var m=yo();(m||!m&&e==="fixed")&&(u=i.offsetLeft,l=i.offsetTop)}return{width:a,height:r,x:u+Gs(n),y:l}}function Sf(n){var e,t=Ge(n),o=Ys(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=tt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=tt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),u=-o.scrollLeft+Gs(n),l=-o.scrollTop;return Re(i||t).direction==="rtl"&&(u+=tt(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:u,y:l}}function Js(n){var e=Re(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function To(n){return["html","body","#document"].indexOf(Le(n))>=0?n.ownerDocument.body:Te(n)&&Js(n)?n:To(os(n))}function xt(n,e){var t;e===void 0&&(e=[]);var o=To(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=Se(o),r=i?[a].concat(a.visualViewport||[],Js(o)?o:[]):o,u=e.concat(r);return i?u:u.concat(xt(os(r)))}function Ls(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Tf(n,e){var t=ft(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Cn(n,e,t){return e===Hs?Ls(Cf(n,t)):nt(e)?Tf(e,t):Ls(Sf(Ge(n)))}function kf(n){var e=xt(os(n)),t=["absolute","fixed"].indexOf(Re(n).position)>=0,o=t&&Te(n)?Dt(n):n;return nt(o)?e.filter(function(i){return nt(i)&&$o(i,o)&&Le(i)!=="body"}):[]}function xf(n,e,t,o){var i=e==="clippingParents"?kf(n):[].concat(e),a=[].concat(i,[t]),r=a[0],u=a.reduce(function(l,m){var c=Cn(n,m,o);return l.top=tt(c.top,l.top),l.right=Qt(c.right,l.right),l.bottom=Qt(c.bottom,l.bottom),l.left=tt(c.left,l.left),l},Cn(n,r,o));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function ko(n){var e=n.reference,t=n.element,o=n.placement,i=o?Oe(o):null,a=o?vt(o):null,r=e.x+e.width/2-t.width/2,u=e.y+e.height/2-t.height/2,l;switch(i){case _e:l={x:r,y:e.y-t.height};break;case Ee:l={x:r,y:e.y+e.height};break;case Ce:l={x:e.x+e.width,y:u};break;case ge:l={x:e.x-t.width,y:u};break;default:l={x:e.x,y:e.y}}var m=i?qs(i):null;if(m!=null){var c=m==="y"?"height":"width";switch(a){case st:l[m]=l[m]-(e[c]/2-t[c]/2);break;case pt:l[m]=l[m]+(e[c]/2-t[c]/2);break}}return l}function ht(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,r=a===void 0?n.strategy:a,u=t.boundary,l=u===void 0?ro:u,m=t.rootBoundary,c=m===void 0?Hs:m,b=t.elementContext,h=b===void 0?lt:b,f=t.altBoundary,C=f===void 0?!1:f,_=t.padding,g=_===void 0?0:_,y=Eo(typeof g!="number"?g:Co(g,yt)),M=h===lt?lo:lt,T=n.rects.popper,w=n.elements[C?M:h],P=xf(nt(w)?w:w.contextElement||Ge(n.elements.popper),l,c,r),j=ft(n.elements.reference),A=ko({reference:j,element:T,placement:i}),x=Ls(Object.assign({},T,A)),N=h===lt?x:j,S={top:P.top-N.top+y.top,bottom:N.bottom-P.bottom+y.bottom,left:P.left-N.left+y.left,right:N.right-P.right+y.right},E=n.modifiersData.offset;if(h===lt&&E){var k=E[i];Object.keys(S).forEach(function(O){var L=[Ce,Ee].indexOf(O)>=0?1:-1,R=[_e,Ee].indexOf(O)>=0?"y":"x";S[O]+=k[R]*L})}return S}function Af(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,r=t.padding,u=t.flipVariations,l=t.allowedAutoPlacements,m=l===void 0?Ws:l,c=vt(o),b=c?u?Ns:Ns.filter(function(C){return vt(C)===c}):yt,h=b.filter(function(C){return m.indexOf(C)>=0});h.length===0&&(h=b);var f=h.reduce(function(C,_){return C[_]=ht(n,{placement:_,boundary:i,rootBoundary:a,padding:r})[Oe(_)],C},{});return Object.keys(f).sort(function(C,_){return f[C]-f[_]})}function Mf(n){if(Oe(n)===ns)return[];var e=Kt(n);return[En(n),e,En(e)]}function Of(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,u=r===void 0?!0:r,l=t.fallbackPlacements,m=t.padding,c=t.boundary,b=t.rootBoundary,h=t.altBoundary,f=t.flipVariations,C=f===void 0?!0:f,_=t.allowedAutoPlacements,g=e.options.placement,y=Oe(g),M=y===g,T=l||(M||!C?[Kt(g)]:Mf(g)),w=[g].concat(T).reduce(function(U,oe){return U.concat(Oe(oe)===ns?Af(e,{placement:oe,boundary:c,rootBoundary:b,padding:m,flipVariations:C,allowedAutoPlacements:_}):oe)},[]),P=e.rects.reference,j=e.rects.popper,A=new Map,x=!0,N=w[0],S=0;S<w.length;S++){var E=w[S],k=Oe(E),O=vt(E)===st,L=[_e,Ee].indexOf(k)>=0,R=L?"width":"height",F=ht(e,{placement:E,boundary:c,rootBoundary:b,altBoundary:h,padding:m}),B=L?O?Ce:ge:O?Ee:_e;P[R]>j[R]&&(B=Kt(B));var ne=Kt(B),re=[];if(a&&re.push(F[k]<=0),u&&re.push(F[B]<=0,F[ne]<=0),re.every(function(U){return U})){N=E,x=!1;break}A.set(E,re)}if(x)for(var ue=C?3:1,He=function(oe){var H=w.find(function(W){var q=A.get(W);if(q)return q.slice(0,oe).every(function(X){return X})});if(H)return N=H,"break"},fe=ue;fe>0;fe--){var Q=He(fe);if(Q==="break")break}e.placement!==N&&(e.modifiersData[o]._skip=!0,e.placement=N,e.reset=!0)}}const xo={name:"flip",enabled:!0,phase:"main",fn:Of,requiresIfExists:["offset"],data:{_skip:!1}};function Sn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Tn(n){return[_e,Ce,Ee,ge].some(function(e){return n[e]>=0})}function Nf(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=ht(e,{elementContext:"reference"}),u=ht(e,{altBoundary:!0}),l=Sn(r,o),m=Sn(u,i,a),c=Tn(l),b=Tn(m);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:m,isReferenceHidden:c,hasPopperEscaped:b},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":b})}const Ao={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Nf};function Df(n,e,t){var o=Oe(n),i=[ge,_e].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,r=a[0],u=a[1];return r=r||0,u=(u||0)*i,[ge,Ce].indexOf(o)>=0?{x:u,y:r}:{x:r,y:u}}function Lf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,r=Ws.reduce(function(c,b){return c[b]=Df(b,e.rects,a),c},{}),u=r[e.placement],l=u.x,m=u.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=m),e.modifiersData[o]=r}const Mo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Lf};function If(n){var e=n.state,t=n.name;e.modifiersData[t]=ko({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Xs={name:"popperOffsets",enabled:!0,phase:"read",fn:If,data:{}};function Pf(n){return n==="x"?"y":"x"}function jf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,u=r===void 0?!1:r,l=t.boundary,m=t.rootBoundary,c=t.altBoundary,b=t.padding,h=t.tether,f=h===void 0?!0:h,C=t.tetherOffset,_=C===void 0?0:C,g=ht(e,{boundary:l,rootBoundary:m,padding:b,altBoundary:c}),y=Oe(e.placement),M=vt(e.placement),T=!M,w=qs(y),P=Pf(w),j=e.modifiersData.popperOffsets,A=e.rects.reference,x=e.rects.popper,N=typeof _=="function"?_(Object.assign({},e.rects,{placement:e.placement})):_,S=typeof N=="number"?{mainAxis:N,altAxis:N}:Object.assign({mainAxis:0,altAxis:0},N),E=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,k={x:0,y:0};if(j){if(a){var O,L=w==="y"?_e:ge,R=w==="y"?Ee:Ce,F=w==="y"?"height":"width",B=j[w],ne=B+g[L],re=B-g[R],ue=f?-x[F]/2:0,He=M===st?A[F]:x[F],fe=M===st?-x[F]:-A[F],Q=e.elements.arrow,U=f&&Q?Us(Q):{width:0,height:0},oe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:wo(),H=oe[L],W=oe[R],q=kt(0,A[F],U[F]),X=T?A[F]/2-ue-q-H-S.mainAxis:He-q-H-S.mainAxis,J=T?-A[F]/2+ue+q+W+S.mainAxis:fe+q+W+S.mainAxis,de=e.elements.arrow&&Dt(e.elements.arrow),Ct=de?w==="y"?de.clientTop||0:de.clientLeft||0:0,Rt=(O=E?.[w])!=null?O:0,li=B+X-Rt-Ct,ci=B+J-Rt,an=kt(f?Qt(ne,li):ne,B,f?tt(re,ci):re);j[w]=an,k[w]=an-B}if(u){var rn,ui=w==="x"?_e:ge,di=w==="x"?Ee:Ce,Qe=j[P],Vt=P==="y"?"height":"width",ln=Qe+g[ui],cn=Qe-g[di],ds=[_e,ge].indexOf(y)!==-1,un=(rn=E?.[P])!=null?rn:0,dn=ds?ln:Qe-A[Vt]-x[Vt]-un+S.altAxis,pn=ds?Qe+A[Vt]+x[Vt]-un-S.altAxis:cn,mn=f&&ds?ff(dn,Qe,pn):kt(f?dn:ln,Qe,f?pn:cn);j[P]=mn,k[P]=mn-Qe}e.modifiersData[o]=k}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:jf,requiresIfExists:["offset"]};function Rf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Vf(n){return n===Se(n)||!Te(n)?Ys(n):Rf(n)}function Hf(n){var e=n.getBoundingClientRect(),t=mt(e.width)/n.offsetWidth||1,o=mt(e.height)/n.offsetHeight||1;return t!==1||o!==1}function Wf(n,e,t){t===void 0&&(t=!1);var o=Te(e),i=Te(e)&&Hf(e),a=Ge(e),r=ft(n,i,t),u={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(o||!o&&!t)&&((Le(e)!=="body"||Js(a))&&(u=Vf(e)),Te(e)?(l=ft(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=Gs(a))),{x:r.left+u.scrollLeft-l.x,y:r.top+u.scrollTop-l.y,width:r.width,height:r.height}}function Ff(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(u){if(!t.has(u)){var l=e.get(u);l&&i(l)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function Bf(n){var e=Ff(n);return bo.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Uf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function qf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var kn={placement:"bottom",modifiers:[],strategy:"absolute"};function xn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function is(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?kn:i;return function(u,l,m){m===void 0&&(m=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},kn,a),modifiersData:{},elements:{reference:u,popper:l},attributes:{},styles:{}},b=[],h=!1,f={state:c,setOptions:function(y){var M=typeof y=="function"?y(c.options):y;_(),c.options=Object.assign({},a,c.options,M),c.scrollParents={reference:nt(u)?xt(u):u.contextElement?xt(u.contextElement):[],popper:xt(l)};var T=Bf(qf([].concat(o,c.options.modifiers)));return c.orderedModifiers=T.filter(function(w){return w.enabled}),C(),f.update()},forceUpdate:function(){if(!h){var y=c.elements,M=y.reference,T=y.popper;if(xn(M,T)){c.rects={reference:Wf(M,Dt(T),c.options.strategy==="fixed"),popper:Us(T)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(S){return c.modifiersData[S.name]=Object.assign({},S.data)});for(var w=0;w<c.orderedModifiers.length;w++){if(c.reset===!0){c.reset=!1,w=-1;continue}var P=c.orderedModifiers[w],j=P.fn,A=P.options,x=A===void 0?{}:A,N=P.name;typeof j=="function"&&(c=j({state:c,options:x,name:N,instance:f})||c)}}}},update:Uf(function(){return new Promise(function(g){f.forceUpdate(),g(c)})}),destroy:function(){_(),h=!0}};if(!xn(u,l))return f;f.setOptions(m).then(function(g){!h&&m.onFirstUpdate&&m.onFirstUpdate(g)});function C(){c.orderedModifiers.forEach(function(g){var y=g.name,M=g.options,T=M===void 0?{}:M,w=g.effect;if(typeof w=="function"){var P=w({state:c,name:y,instance:f,options:T}),j=function(){};b.push(P||j)}})}function _(){b.forEach(function(g){return g()}),b=[]}return f}}var zf=is(),Kf=[Ks,Xs,zs,Bs],Yf=is({defaultModifiers:Kf}),Gf=[Ks,Xs,zs,Bs,Mo,xo,Oo,So,Ao],Qs=is({defaultModifiers:Gf});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:vo,afterRead:po,afterWrite:go,applyStyles:Bs,arrow:So,auto:ns,basePlacements:yt,beforeMain:mo,beforeRead:co,beforeWrite:ho,bottom:Ee,clippingParents:ro,computeStyles:zs,createPopper:Qs,createPopperBase:zf,createPopperLite:Yf,detectOverflow:ht,end:pt,eventListeners:Ks,flip:xo,hide:Ao,left:ge,main:fo,modifierPhases:bo,offset:Mo,placements:Ws,popper:lt,popperGenerator:is,popperOffsets:Xs,preventOverflow:Oo,read:uo,reference:lo,right:Ce,start:st,top:_e,variationPlacements:Ns,viewport:Hs,write:_o},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const We=new Map,vs={set(n,e,t){We.has(n)||We.set(n,new Map);const o=We.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return We.has(n)&&We.get(n).get(e)||null},remove(n,e){if(!We.has(n))return;const t=We.get(n);t.delete(e),t.size===0&&We.delete(n)}},Jf=1e6,Xf=1e3,Is="transitionend",Do=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Qf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Zf=n=>{do n+=Math.floor(Math.random()*Jf);while(document.getElementById(n));return n},ev=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Xf)},Lo=n=>{n.dispatchEvent(new Event(Is))},Ie=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Be=n=>Ie(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Do(n)):null,$t=n=>{if(!Ie(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Ue=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Io=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Io(n.parentNode):null},Zt=()=>{},Lt=n=>{n.offsetHeight},Po=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,hs=[],tv=n=>{document.readyState==="loading"?(hs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of hs)e()}),hs.push(n)):n()},ke=()=>document.documentElement.dir==="rtl",Ae=n=>{tv(()=>{const e=Po();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},ye=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,jo=(n,e,t=!0)=>{if(!t){ye(n);return}const i=ev(e)+5;let a=!1;const r=({target:u})=>{u===e&&(a=!0,e.removeEventListener(Is,r),ye(n))};e.addEventListener(Is,r),setTimeout(()=>{a||Lo(e)},i)},Zs=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},sv=/[^.]*(?=\..*)\.|.*/,nv=/\..*/,ov=/::\d+$/,_s={};let An=1;const Ro={mouseenter:"mouseover",mouseleave:"mouseout"},iv=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vo(n,e){return e&&`${e}::${An++}`||n.uidEvent||An++}function Ho(n){const e=Vo(n);return n.uidEvent=e,_s[e]=_s[e]||{},_s[e]}function av(n,e){return function t(o){return en(o,{delegateTarget:n}),t.oneOff&&V.off(n,o.type,e),e.apply(n,[o])}}function rv(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const u of a)if(u===r)return en(i,{delegateTarget:r}),o.oneOff&&V.off(n,i.type,e,t),t.apply(r,[i])}}function Wo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Fo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Bo(n);return iv.has(a)||(a=n),[o,i,a]}function Mn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,r,u]=Fo(e,t,o);e in Ro&&(r=(C=>function(_){if(!_.relatedTarget||_.relatedTarget!==_.delegateTarget&&!_.delegateTarget.contains(_.relatedTarget))return C.call(this,_)})(r));const l=Ho(n),m=l[u]||(l[u]={}),c=Wo(m,r,a?t:null);if(c){c.oneOff=c.oneOff&&i;return}const b=Vo(r,e.replace(sv,"")),h=a?rv(n,t,r):av(n,r);h.delegationSelector=a?t:null,h.callable=r,h.oneOff=i,h.uidEvent=b,m[b]=h,n.addEventListener(u,h,a)}function Ps(n,e,t,o,i){const a=Wo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function lv(n,e,t,o){const i=e[t]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&Ps(n,e,t,r.callable,r.delegationSelector)}function Bo(n){return n=n.replace(nv,""),Ro[n]||n}const V={on(n,e,t,o){Mn(n,e,t,o,!1)},one(n,e,t,o){Mn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,r]=Fo(e,t,o),u=r!==e,l=Ho(n),m=l[r]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(m).length)return;Ps(n,l,r,a,i?t:null);return}if(c)for(const b of Object.keys(l))lv(n,l,b,e.slice(1));for(const[b,h]of Object.entries(m)){const f=b.replace(ov,"");(!u||e.includes(f))&&Ps(n,l,r,h.callable,h.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Po(),i=Bo(e),a=e!==i;let r=null,u=!0,l=!0,m=!1;a&&o&&(r=o.Event(e,t),o(n).trigger(r),u=!r.isPropagationStopped(),l=!r.isImmediatePropagationStopped(),m=r.isDefaultPrevented());const c=en(new Event(e,{bubbles:u,cancelable:!0}),t);return m&&c.preventDefault(),l&&n.dispatchEvent(c),c.defaultPrevented&&r&&r.preventDefault(),c}};function en(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function On(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function gs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Pe={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${gs(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${gs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=On(n.dataset[o])}return e},getDataAttribute(n,e){return On(n.getAttribute(`data-bs-${gs(e)}`))}};class It{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Ie(t)?Pe.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ie(t)?Pe.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],r=Ie(a)?"element":Qf(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const cv="5.3.8";class Me extends It{constructor(e,t){super(),e=Be(e),e&&(this._element=e,this._config=this._getConfig(t),vs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){vs.remove(this._element,this.constructor.DATA_KEY),V.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){jo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return vs.get(Be(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return cv}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const bs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Do(t)).join(","):null},z={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Ue(t)&&$t(t))},getSelectorFromElement(n){const e=bs(n);return e&&z.findOne(e)?e:null},getElementFromSelector(n){const e=bs(n);return e?z.findOne(e):null},getMultipleElementsFromSelector(n){const e=bs(n);return e?z.find(e):[]}},as=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;V.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Ue(this))return;const a=z.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},uv="alert",dv="bs.alert",Uo=`.${dv}`,pv=`close${Uo}`,mv=`closed${Uo}`,fv="fade",vv="show";class rs extends Me{static get NAME(){return uv}close(){if(V.trigger(this._element,pv).defaultPrevented)return;this._element.classList.remove(vv);const t=this._element.classList.contains(fv);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),V.trigger(this._element,mv),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=rs.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}as(rs,"close");Ae(rs);const hv="button",_v="bs.button",gv=`.${_v}`,bv=".data-api",yv="active",Nn='[data-bs-toggle="button"]',$v=`click${gv}${bv}`;class ls extends Me{static get NAME(){return hv}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(yv))}static jQueryInterface(e){return this.each(function(){const t=ls.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}V.on(document,$v,Nn,n=>{n.preventDefault();const e=n.target.closest(Nn);ls.getOrCreateInstance(e).toggle()});Ae(ls);const wv="swipe",wt=".bs.swipe",Ev=`touchstart${wt}`,Cv=`touchmove${wt}`,Sv=`touchend${wt}`,Tv=`pointerdown${wt}`,kv=`pointerup${wt}`,xv="touch",Av="pen",Mv="pointer-event",Ov=40,Nv={endCallback:null,leftCallback:null,rightCallback:null},Dv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class es extends It{constructor(e,t){super(),this._element=e,!(!e||!es.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Nv}static get DefaultType(){return Dv}static get NAME(){return wv}dispose(){V.off(this._element,wt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),ye(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Ov)return;const t=e/this._deltaX;this._deltaX=0,t&&ye(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(V.on(this._element,Tv,e=>this._start(e)),V.on(this._element,kv,e=>this._end(e)),this._element.classList.add(Mv)):(V.on(this._element,Ev,e=>this._start(e)),V.on(this._element,Cv,e=>this._move(e)),V.on(this._element,Sv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Av||e.pointerType===xv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Lv="carousel",Iv="bs.carousel",Je=`.${Iv}`,qo=".data-api",Pv="ArrowLeft",jv="ArrowRight",Rv=500,St="next",at="prev",ct="left",Yt="right",Vv=`slide${Je}`,ys=`slid${Je}`,Hv=`keydown${Je}`,Wv=`mouseenter${Je}`,Fv=`mouseleave${Je}`,Bv=`dragstart${Je}`,Uv=`load${Je}${qo}`,qv=`click${Je}${qo}`,zo="carousel",Wt="active",zv="slide",Kv="carousel-item-end",Yv="carousel-item-start",Gv="carousel-item-next",Jv="carousel-item-prev",Ko=".active",Yo=".carousel-item",Xv=Ko+Yo,Qv=".carousel-item img",Zv=".carousel-indicators",eh="[data-bs-slide], [data-bs-slide-to]",th='[data-bs-ride="carousel"]',sh={[Pv]:Yt,[jv]:ct},nh={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},oh={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Pt extends Me{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=z.findOne(Zv,this._element),this._addEventListeners(),this._config.ride===zo&&this.cycle()}static get Default(){return nh}static get DefaultType(){return oh}static get NAME(){return Lv}next(){this._slide(St)}nextWhenVisible(){!document.hidden&&$t(this._element)&&this.next()}prev(){this._slide(at)}pause(){this._isSliding&&Lo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){V.one(this._element,ys,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){V.one(this._element,ys,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?St:at;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&V.on(this._element,Hv,e=>this._keydown(e)),this._config.pause==="hover"&&(V.on(this._element,Wv,()=>this.pause()),V.on(this._element,Fv,()=>this._maybeEnableCycle())),this._config.touch&&es.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of z.find(Qv,this._element))V.on(o,Bv,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(ct)),rightCallback:()=>this._slide(this._directionToOrder(Yt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Rv+this._config.interval))}};this._swipeHelper=new es(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=sh[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=z.findOne(Ko,this._indicatorsElement);t.classList.remove(Wt),t.removeAttribute("aria-current");const o=z.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Wt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===St,a=t||Zs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),u=f=>V.trigger(this._element,f,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(u(Vv).defaultPrevented||!o||!a)return;const m=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const c=i?Yv:Kv,b=i?Gv:Jv;a.classList.add(b),Lt(a),o.classList.add(c),a.classList.add(c);const h=()=>{a.classList.remove(c,b),a.classList.add(Wt),o.classList.remove(Wt,b,c),this._isSliding=!1,u(ys)};this._queueCallback(h,o,this._isAnimated()),m&&this.cycle()}_isAnimated(){return this._element.classList.contains(zv)}_getActive(){return z.findOne(Xv,this._element)}_getItems(){return z.find(Yo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return ke()?e===ct?at:St:e===ct?St:at}_orderToDirection(e){return ke()?e===at?ct:Yt:e===at?Yt:ct}static jQueryInterface(e){return this.each(function(){const t=Pt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(document,qv,eh,function(n){const e=z.getElementFromSelector(this);if(!e||!e.classList.contains(zo))return;n.preventDefault();const t=Pt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Pe.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});V.on(window,Uv,()=>{const n=z.find(th);for(const e of n)Pt.getOrCreateInstance(e)});Ae(Pt);const ih="collapse",ah="bs.collapse",jt=`.${ah}`,rh=".data-api",lh=`show${jt}`,ch=`shown${jt}`,uh=`hide${jt}`,dh=`hidden${jt}`,ph=`click${jt}${rh}`,$s="show",dt="collapse",Ft="collapsing",mh="collapsed",fh=`:scope .${dt} .${dt}`,vh="collapse-horizontal",hh="width",_h="height",gh=".collapse.show, .collapse.collapsing",js='[data-bs-toggle="collapse"]',bh={parent:null,toggle:!0},yh={parent:"(null|element)",toggle:"boolean"};class Nt extends Me{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=z.find(js);for(const i of o){const a=z.getSelectorFromElement(i),r=z.find(a).filter(u=>u===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return bh}static get DefaultType(){return yh}static get NAME(){return ih}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(gh).filter(u=>u!==this._element).map(u=>Nt.getOrCreateInstance(u,{toggle:!1}))),e.length&&e[0]._isTransitioning||V.trigger(this._element,lh).defaultPrevented)return;for(const u of e)u.hide();const o=this._getDimension();this._element.classList.remove(dt),this._element.classList.add(Ft),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(dt,$s),this._element.style[o]="",V.trigger(this._element,ch)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||V.trigger(this._element,uh).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Lt(this._element),this._element.classList.add(Ft),this._element.classList.remove(dt,$s);for(const i of this._triggerArray){const a=z.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(dt),V.trigger(this._element,dh)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains($s)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Be(e.parent),e}_getDimension(){return this._element.classList.contains(vh)?hh:_h}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(js);for(const t of e){const o=z.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=z.find(fh,this._config.parent);return z.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(mh,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Nt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}V.on(document,ph,js,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of z.getMultipleElementsFromSelector(this))Nt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ae(Nt);const Dn="dropdown",$h="bs.dropdown",ot=`.${$h}`,tn=".data-api",wh="Escape",Ln="Tab",Eh="ArrowUp",In="ArrowDown",Ch=2,Sh=`hide${ot}`,Th=`hidden${ot}`,kh=`show${ot}`,xh=`shown${ot}`,Go=`click${ot}${tn}`,Jo=`keydown${ot}${tn}`,Ah=`keyup${ot}${tn}`,ut="show",Mh="dropup",Oh="dropend",Nh="dropstart",Dh="dropup-center",Lh="dropdown-center",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Ih=`${Ze}.${ut}`,Gt=".dropdown-menu",Ph=".navbar",jh=".navbar-nav",Rh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Vh=ke()?"top-end":"top-start",Hh=ke()?"top-start":"top-end",Wh=ke()?"bottom-end":"bottom-start",Fh=ke()?"bottom-start":"bottom-end",Bh=ke()?"left-start":"right-start",Uh=ke()?"right-start":"left-start",qh="top",zh="bottom",Kh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Yh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ne extends Me{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=z.next(this._element,Gt)[0]||z.prev(this._element,Gt)[0]||z.findOne(Gt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Kh}static get DefaultType(){return Yh}static get NAME(){return Dn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ue(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!V.trigger(this._element,kh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(jh))for(const o of[].concat(...document.body.children))V.on(o,"mouseover",Zt);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ut),this._element.classList.add(ut),V.trigger(this._element,xh,e)}}hide(){if(Ue(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!V.trigger(this._element,Sh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))V.off(o,"mouseover",Zt);this._popper&&this._popper.destroy(),this._menu.classList.remove(ut),this._element.classList.remove(ut),this._element.setAttribute("aria-expanded","false"),Pe.removeDataAttribute(this._menu,"popper"),V.trigger(this._element,Th,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ie(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Dn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ie(this._config.reference)?e=Be(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Qs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(ut)}_getPlacement(){const e=this._parent;if(e.classList.contains(Oh))return Bh;if(e.classList.contains(Nh))return Uh;if(e.classList.contains(Dh))return qh;if(e.classList.contains(Lh))return zh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Mh)?t?Hh:Vh:t?Fh:Wh}_detectNavbar(){return this._element.closest(Ph)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Pe.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...ye(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=z.find(Rh,this._menu).filter(i=>$t(i));o.length&&Zs(o,t,e===In,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ne.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===Ch||e.type==="keyup"&&e.key!==Ln)return;const t=z.find(Ih);for(const o of t){const i=Ne.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Ln||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const u={relatedTarget:i._element};e.type==="click"&&(u.clickEvent=e),i._completeHide(u)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===wh,i=[Eh,In].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(Ze)?this:z.prev(this,Ze)[0]||z.next(this,Ze)[0]||z.findOne(Ze,e.delegateTarget.parentNode),r=Ne.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}V.on(document,Jo,Ze,Ne.dataApiKeydownHandler);V.on(document,Jo,Gt,Ne.dataApiKeydownHandler);V.on(document,Go,Ne.clearMenus);V.on(document,Ah,Ne.clearMenus);V.on(document,Go,Ze,function(n){n.preventDefault(),Ne.getOrCreateInstance(this).toggle()});Ae(Ne);const Xo="backdrop",Gh="fade",Pn="show",jn=`mousedown.bs.${Xo}`,Jh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Xh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Qo extends It{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Jh}static get DefaultType(){return Xh}static get NAME(){return Xo}show(e){if(!this._config.isVisible){ye(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Lt(t),t.classList.add(Pn),this._emulateAnimation(()=>{ye(e)})}hide(e){if(!this._config.isVisible){ye(e);return}this._getElement().classList.remove(Pn),this._emulateAnimation(()=>{this.dispose(),ye(e)})}dispose(){this._isAppended&&(V.off(this._element,jn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Gh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Be(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),V.on(e,jn,()=>{ye(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){jo(e,this._getElement(),this._config.isAnimated)}}const Qh="focustrap",Zh="bs.focustrap",ts=`.${Zh}`,e_=`focusin${ts}`,t_=`keydown.tab${ts}`,s_="Tab",n_="forward",Rn="backward",o_={autofocus:!0,trapElement:null},i_={autofocus:"boolean",trapElement:"element"};class Zo extends It{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return o_}static get DefaultType(){return i_}static get NAME(){return Qh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),V.off(document,ts),V.on(document,e_,e=>this._handleFocusin(e)),V.on(document,t_,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,V.off(document,ts))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=z.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Rn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===s_&&(this._lastTabNavDirection=e.shiftKey?Rn:n_)}}const Vn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Hn=".sticky-top",Bt="padding-right",Wn="margin-right";class Rs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Bt,t=>t+e),this._setElementAttributes(Vn,Bt,t=>t+e),this._setElementAttributes(Hn,Wn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Bt),this._resetElementAttributes(Vn,Bt),this._resetElementAttributes(Hn,Wn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const u=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(u))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Pe.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=Pe.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}Pe.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Ie(e)){t(e);return}for(const o of z.find(e,this._element))t(o)}}const a_="modal",r_="bs.modal",xe=`.${r_}`,l_=".data-api",c_="Escape",u_=`hide${xe}`,d_=`hidePrevented${xe}`,ei=`hidden${xe}`,ti=`show${xe}`,p_=`shown${xe}`,m_=`resize${xe}`,f_=`click.dismiss${xe}`,v_=`mousedown.dismiss${xe}`,h_=`keydown.dismiss${xe}`,__=`click${xe}${l_}`,Fn="modal-open",g_="fade",Bn="show",ws="modal-static",b_=".modal.show",y_=".modal-dialog",$_=".modal-body",w_='[data-bs-toggle="modal"]',E_={backdrop:!0,focus:!0,keyboard:!0},C_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class qe extends Me{constructor(e,t){super(e,t),this._dialog=z.findOne(y_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Rs,this._addEventListeners()}static get Default(){return E_}static get DefaultType(){return C_}static get NAME(){return a_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||V.trigger(this._element,ti,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Fn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||V.trigger(this._element,u_).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Bn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){V.off(window,xe),V.off(this._dialog,xe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Qo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=z.findOne($_,this._dialog);t&&(t.scrollTop=0),Lt(this._element),this._element.classList.add(Bn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,V.trigger(this._element,p_,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){V.on(this._element,h_,e=>{if(e.key===c_){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),V.on(window,m_,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),V.on(this._element,v_,e=>{V.one(this._element,f_,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Fn),this._resetAdjustments(),this._scrollBar.reset(),V.trigger(this._element,ei)})}_isAnimated(){return this._element.classList.contains(g_)}_triggerBackdropTransition(){if(V.trigger(this._element,d_).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(ws)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(ws),this._queueCallback(()=>{this._element.classList.remove(ws),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=ke()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=ke()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}V.on(document,__,w_,function(n){const e=z.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),V.one(e,ti,i=>{i.defaultPrevented||V.one(e,ei,()=>{$t(this)&&this.focus()})});const t=z.findOne(b_);t&&qe.getInstance(t).hide(),qe.getOrCreateInstance(e).toggle(this)});as(qe);Ae(qe);const S_="offcanvas",T_="bs.offcanvas",Ve=`.${T_}`,si=".data-api",k_=`load${Ve}${si}`,x_="Escape",Un="show",qn="showing",zn="hiding",A_="offcanvas-backdrop",ni=".offcanvas.show",M_=`show${Ve}`,O_=`shown${Ve}`,N_=`hide${Ve}`,Kn=`hidePrevented${Ve}`,oi=`hidden${Ve}`,D_=`resize${Ve}`,L_=`click${Ve}${si}`,I_=`keydown.dismiss${Ve}`,P_='[data-bs-toggle="offcanvas"]',j_={backdrop:!0,keyboard:!0,scroll:!1},R_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ze extends Me{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return j_}static get DefaultType(){return R_}static get NAME(){return S_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||V.trigger(this._element,M_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Rs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(qn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Un),this._element.classList.remove(qn),V.trigger(this._element,O_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||V.trigger(this._element,N_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(zn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Un,zn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Rs().reset(),V.trigger(this._element,oi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){V.trigger(this._element,Kn);return}this.hide()},t=!!this._config.backdrop;return new Qo({className:A_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_addEventListeners(){V.on(this._element,I_,e=>{if(e.key===x_){if(this._config.keyboard){this.hide();return}V.trigger(this._element,Kn)}})}static jQueryInterface(e){return this.each(function(){const t=ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}V.on(document,L_,P_,function(n){const e=z.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Ue(this))return;V.one(e,oi,()=>{$t(this)&&this.focus()});const t=z.findOne(ni);t&&t!==e&&ze.getInstance(t).hide(),ze.getOrCreateInstance(e).toggle(this)});V.on(window,k_,()=>{for(const n of z.find(ni))ze.getOrCreateInstance(n).show()});V.on(window,D_,()=>{for(const n of z.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&ze.getOrCreateInstance(n).hide()});as(ze);Ae(ze);const V_=/^aria-[\w-]*$/i,ii={"*":["class","dir","id","lang","role",V_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},H_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),W_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,F_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?H_.has(t)?!!W_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function B_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const u=r.nodeName.toLowerCase();if(!Object.keys(e).includes(u)){r.remove();continue}const l=[].concat(...r.attributes),m=[].concat(e["*"]||[],e[u]||[]);for(const c of l)F_(c,m)||r.removeAttribute(c.nodeName)}return i.body.innerHTML}const U_="TemplateFactory",q_={allowList:ii,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},z_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},K_={entry:"(string|element|function|null)",selector:"(string|element)"};class Y_ extends It{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return q_}static get DefaultType(){return z_}static get NAME(){return U_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},K_)}_setContent(e,t,o){const i=z.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Ie(t)){this._putElementInTemplate(Be(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?B_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return ye(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const G_="tooltip",J_=new Set(["sanitize","allowList","sanitizeFn"]),Es="fade",X_="modal",Ut="show",Q_=".tooltip-inner",Yn=`.${X_}`,Gn="hide.bs.modal",Tt="hover",Cs="focus",Ss="click",Z_="manual",eg="hide",tg="hidden",sg="show",ng="shown",og="inserted",ig="click",ag="focusin",rg="focusout",lg="mouseenter",cg="mouseleave",ug={AUTO:"auto",TOP:"top",RIGHT:ke()?"left":"right",BOTTOM:"bottom",LEFT:ke()?"right":"left"},dg={allowList:ii,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},pg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Et extends Me{constructor(e,t){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return dg}static get DefaultType(){return pg}static get NAME(){return G_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),V.off(this._element.closest(Yn),Gn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=V.trigger(this._element,this.constructor.eventName(sg)),o=(Io(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),V.trigger(this._element,this.constructor.eventName(og))),this._popper=this._createPopper(i),i.classList.add(Ut),"ontouchstart"in document.documentElement)for(const u of[].concat(...document.body.children))V.on(u,"mouseover",Zt);const r=()=>{V.trigger(this._element,this.constructor.eventName(ng)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||V.trigger(this._element,this.constructor.eventName(eg)).defaultPrevented)return;if(this._getTipElement().classList.remove(Ut),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))V.off(i,"mouseover",Zt);this._activeTrigger[Ss]=!1,this._activeTrigger[Cs]=!1,this._activeTrigger[Tt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),V.trigger(this._element,this.constructor.eventName(tg)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Es,Ut),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Zf(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Es),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Y_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Q_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Es)}_isShown(){return this.tip&&this.tip.classList.contains(Ut)}_createPopper(e){const t=ye(this._config.placement,[this,e,this._element]),o=ug[t.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return ye(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...ye(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")V.on(this._element,this.constructor.eventName(ig),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ss]=!(i._isShown()&&i._activeTrigger[Ss]),i.toggle()});else if(t!==Z_){const o=t===Tt?this.constructor.eventName(lg):this.constructor.eventName(ag),i=t===Tt?this.constructor.eventName(cg):this.constructor.eventName(rg);V.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?Cs:Tt]=!0,r._enter()}),V.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?Cs:Tt]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},V.on(this._element.closest(Yn),Gn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Pe.getDataAttributes(this._element);for(const o of Object.keys(t))J_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Be(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Et.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ae(Et);const mg="popover",fg=".popover-header",vg=".popover-body",hg={...Et.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},_g={...Et.DefaultType,content:"(null|string|element|function)"};class sn extends Et{static get Default(){return hg}static get DefaultType(){return _g}static get NAME(){return mg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[fg]:this._getTitle(),[vg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ae(sn);const gg="scrollspy",bg="bs.scrollspy",nn=`.${bg}`,yg=".data-api",$g=`activate${nn}`,Jn=`click${nn}`,wg=`load${nn}${yg}`,Eg="dropdown-item",rt="active",Cg='[data-bs-spy="scroll"]',Ts="[href]",Sg=".nav, .list-group",Xn=".nav-link",Tg=".nav-item",kg=".list-group-item",xg=`${Xn}, ${Tg} > ${Xn}, ${kg}`,Ag=".dropdown",Mg=".dropdown-toggle",Og={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Ng={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class cs extends Me{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Og}static get DefaultType(){return Ng}static get NAME(){return gg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Be(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(V.off(this._config.target,Jn),V.on(this._config.target,Jn,Ts,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const u=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&u){if(o(r),!i)return;continue}!a&&!u&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=z.find(Ts,this._config.target);for(const t of e){if(!t.hash||Ue(t))continue;const o=z.findOne(decodeURI(t.hash),this._element);$t(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(rt),this._activateParents(e),V.trigger(this._element,$g,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Eg)){z.findOne(Mg,e.closest(Ag)).classList.add(rt);return}for(const t of z.parents(e,Sg))for(const o of z.prev(t,xg))o.classList.add(rt)}_clearActiveClass(e){e.classList.remove(rt);const t=z.find(`${Ts}.${rt}`,e);for(const o of t)o.classList.remove(rt)}static jQueryInterface(e){return this.each(function(){const t=cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(window,wg,()=>{for(const n of z.find(Cg))cs.getOrCreateInstance(n)});Ae(cs);const Dg="tab",Lg="bs.tab",it=`.${Lg}`,Ig=`hide${it}`,Pg=`hidden${it}`,jg=`show${it}`,Rg=`shown${it}`,Vg=`click${it}`,Hg=`keydown${it}`,Wg=`load${it}`,Fg="ArrowLeft",Qn="ArrowRight",Bg="ArrowUp",Zn="ArrowDown",ks="Home",eo="End",et="active",to="fade",xs="show",Ug="dropdown",ai=".dropdown-toggle",qg=".dropdown-menu",As=`:not(${ai})`,zg='.list-group, .nav, [role="tablist"]',Kg=".nav-item, .list-group-item",Yg=`.nav-link${As}, .list-group-item${As}, [role="tab"]${As}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ms=`${Yg}, ${ri}`,Gg=`.${et}[data-bs-toggle="tab"], .${et}[data-bs-toggle="pill"], .${et}[data-bs-toggle="list"]`;class _t extends Me{constructor(e){super(e),this._parent=this._element.closest(zg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),V.on(this._element,Hg,t=>this._keydown(t)))}static get NAME(){return Dg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?V.trigger(t,Ig,{relatedTarget:e}):null;V.trigger(e,jg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(et),this._activate(z.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(xs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),V.trigger(e,Rg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(to))}_deactivate(e,t){if(!e)return;e.classList.remove(et),e.blur(),this._deactivate(z.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(xs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),V.trigger(e,Pg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(to))}_keydown(e){if(![Fg,Qn,Bg,Zn,ks,eo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Ue(i));let o;if([ks,eo].includes(e.key))o=t[e.key===ks?0:t.length-1];else{const i=[Qn,Zn].includes(e.key);o=Zs(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),_t.getOrCreateInstance(o).show())}_getChildren(){return z.find(Ms,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=z.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(Ug))return;const i=(a,r)=>{const u=z.findOne(a,o);u&&u.classList.toggle(r,t)};i(ai,et),i(qg,xs),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(et)}_getInnerElement(e){return e.matches(Ms)?e:z.findOne(Ms,e)}_getOuterElement(e){return e.closest(Kg)||e}static jQueryInterface(e){return this.each(function(){const t=_t.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(document,Vg,ri,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Ue(this)&&_t.getOrCreateInstance(this).show()});V.on(window,Wg,()=>{for(const n of z.find(Gg))_t.getOrCreateInstance(n)});Ae(_t);const Jg="toast",Xg="bs.toast",Xe=`.${Xg}`,Qg=`mouseover${Xe}`,Zg=`mouseout${Xe}`,eb=`focusin${Xe}`,tb=`focusout${Xe}`,sb=`hide${Xe}`,nb=`hidden${Xe}`,ob=`show${Xe}`,ib=`shown${Xe}`,ab="fade",so="hide",qt="show",zt="showing",rb={animation:"boolean",autohide:"boolean",delay:"number"},lb={animation:!0,autohide:!0,delay:5e3};class us extends Me{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return lb}static get DefaultType(){return rb}static get NAME(){return Jg}show(){if(V.trigger(this._element,ob).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(ab);const t=()=>{this._element.classList.remove(zt),V.trigger(this._element,ib),this._maybeScheduleHide()};this._element.classList.remove(so),Lt(this._element),this._element.classList.add(qt,zt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||V.trigger(this._element,sb).defaultPrevented)return;const t=()=>{this._element.classList.add(so),this._element.classList.remove(zt,qt),V.trigger(this._element,nb)};this._element.classList.add(zt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(qt),super.dispose()}isShown(){return this._element.classList.contains(qt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){V.on(this._element,Qg,e=>this._onInteraction(e,!0)),V.on(this._element,Zg,e=>this._onInteraction(e,!1)),V.on(this._element,eb,e=>this._onInteraction(e,!0)),V.on(this._element,tb,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=us.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}as(us);Ae(us);const cb={class:"modal-dialog modal-dialog-centered"},ub={class:"modal-content"},db={class:"modal-body"},pb={key:0,class:"alert alert-danger"},mb={class:"mb-3"},fb={class:"mb-3"},vb={class:"form-text"},hb={class:"mb-3"},_b={class:"mb-3"},gb=["value"],bb={class:"modal-footer"},yb=["disabled"],$b={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=ee(),r=D(null),u=D(null),l=D(""),m=D(!1),c=D({name:"",purpose:"",description:"",member_minion_ids:[]}),b=v(()=>{const g=[];for(const[y,M]of a.sessions.entries())M.is_minion&&M.project_id===o.legionId&&g.push(M);return g}),h=v(()=>c.value.name.trim()!==""&&c.value.purpose.trim()!==""),f=async()=>{if(!h.value){l.value="Name and purpose are required";return}m.value=!0,l.value="";try{const g=await Z.post(`/api/legions/${o.legionId}/channels`,{name:c.value.name.trim(),purpose:c.value.purpose.trim(),description:c.value.description.trim()||"",member_minion_ids:c.value.member_minion_ids});i("created",g.channel),u.value?.hide(),c.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(g){console.error("Failed to create channel:",g),l.value=g.response?.data?.detail||"Failed to create channel"}finally{m.value=!1}},C=()=>{u.value?.show()},_=()=>{u.value?.hide()};return me(()=>{r.value&&(u.value=new qe(r.value))}),be(()=>{u.value?.dispose()}),e({show:C,hide:_}),(g,y)=>(d(),we(io,{to:"body"},[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[s("div",cb,[s("div",ub,[y[11]||(y[11]=s("div",{class:"modal-header"},[s("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",db,[l.value?(d(),p("div",pb,$(l.value),1)):I("",!0),s("form",{onSubmit:he(f,["prevent"])},[s("div",mb,[y[4]||(y[4]=s("label",{for:"channel-name",class:"form-label"},[Y(" Channel Name "),s("span",{class:"text-danger"},"*")],-1)),te(s("input",{id:"channel-name","onUpdate:modelValue":y[0]||(y[0]=M=>c.value.name=M),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[pe,c.value.name]]),y[5]||(y[5]=s("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),s("div",fb,[y[6]||(y[6]=s("label",{for:"channel-purpose",class:"form-label"},[Y(" Purpose "),s("span",{class:"text-danger"},"*")],-1)),te(s("textarea",{id:"channel-purpose","onUpdate:modelValue":y[1]||(y[1]=M=>c.value.purpose=M),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[pe,c.value.purpose]]),s("div",vb,$(c.value.purpose.length)+" / 500 characters",1)]),s("div",hb,[y[7]||(y[7]=s("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),te(s("textarea",{id:"channel-description","onUpdate:modelValue":y[2]||(y[2]=M=>c.value.description=M),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[pe,c.value.description]])]),s("div",_b,[y[8]||(y[8]=s("label",{class:"form-label"},"Initial Members (Optional)",-1)),te(s("select",{"onUpdate:modelValue":y[3]||(y[3]=M=>c.value.member_minion_ids=M),multiple:"",class:"form-select",size:"5"},[(d(!0),p(se,null,ae(b.value,M=>(d(),p("option",{key:M.session_id,value:M.session_id},$(M.name)+$(M.role?` (${M.role})`:""),9,gb))),128))],512),[[Fe,c.value.member_minion_ids]]),y[9]||(y[9]=s("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),s("div",bb,[y[10]||(y[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:f,disabled:m.value||!h.value},$(m.value?"Creating...":"Create Channel"),9,yb)])])])],512)]))}},wb=G($b,[["__scopeId","data-v-573f4c01"]]),Eb={class:"modal-dialog modal-dialog-centered"},Cb={class:"modal-content"},Sb={class:"modal-body"},Tb={key:0,class:"alert alert-danger"},kb={class:"text-muted"},xb={class:"modal-footer"},Ab=["disabled"],Mb={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=D(null),r=D(null),u=D(""),l=D(!1),m=v(()=>o.channel?.member_minion_ids?.length||0),c=async()=>{if(!o.channel){u.value="No channel selected";return}l.value=!0,u.value="";try{await Z.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),i("deleted",o.channel.channel_id),r.value?.hide()}catch(f){console.error("Failed to delete channel:",f),u.value=f.data?.detail||f.message||"Failed to delete channel"}finally{l.value=!1}},b=()=>{u.value="",r.value?.show()},h=()=>{r.value?.hide()};return me(()=>{a.value&&(r.value=new qe(a.value))}),be(()=>{r.value?.dispose()}),e({show:b,hide:h}),(f,C)=>(d(),we(io,{to:"body"},[s("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[s("div",Eb,[s("div",Cb,[C[4]||(C[4]=s("div",{class:"modal-header"},[s("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Sb,[u.value?(d(),p("div",Tb,$(u.value),1)):I("",!0),C[2]||(C[2]=s("div",{class:"alert alert-warning"},[s("strong",null,"âš ï¸ Warning:"),Y(" This action cannot be undone. ")],-1)),s("p",null,[C[0]||(C[0]=Y("Are you sure you want to delete ",-1)),s("strong",null,$(n.channel?.name),1),C[1]||(C[1]=Y("?",-1))]),s("p",kb," This channel has "+$(m.value)+" "+$(m.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),s("div",xb,[C[3]||(C[3]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-danger",onClick:c,disabled:l.value},$(l.value?"Deleting...":"Delete Channel"),9,Ab)])])])],512)]))}},Ob={class:"accordion mt-2",id:"channelsAccordion"},Nb={class:"accordion-item"},Db={class:"accordion-header"},Lb={class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#channelsCollapsePanel","aria-expanded":"false","aria-controls":"channelsCollapsePanel"},Ib={class:"text-muted ms-2"},Pb={id:"channelsCollapsePanel",class:"accordion-collapse collapse","data-bs-parent":"#channelsAccordion"},jb={class:"accordion-body p-0"},Rb={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},Vb={key:1,class:"list-group list-group-flush"},Hb={class:"d-flex align-items-center justify-content-between"},Wb=["onClick"],Fb={class:"channel-name"},Bb={class:"d-flex align-items-center gap-2"},Ub={class:"badge bg-secondary member-count"},qb=["onClick"],zb={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ke(),o=bt(),i=D(null),a=D(null),r=D(null),u=v(()=>o.channelsByLegion.get(e.project.project_id)||[]),l=v(()=>u.value.length);function m(C){t.push(`/channel/${e.project.project_id}/${C}`)}function c(){i.value?.show()}function b(C){r.value=C,a.value?.show()}function h(C){o.loadChannels(e.project.project_id)}function f(C){const g=(o.channelsByLegion.get(e.project.project_id)||[]).filter(y=>y.channel_id!==C);o.channelsByLegion.set(e.project.project_id,g),t.currentRoute.value.path.includes(C)&&t.push(`/timeline/${e.project.project_id}`)}return me(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(C){console.error("Failed to load channels:",C)}}),(C,_)=>(d(),p(se,null,[s("div",Ob,[s("div",Nb,[s("h2",Db,[s("button",Lb,[_[0]||(_[0]=s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),_[1]||(_[1]=s("span",{class:"fw-semibold"},"Channels",-1)),s("small",Ib,"("+$(l.value)+")",1)])]),s("div",Pb,[s("div",jb,[s("div",{class:"p-2 border-bottom"},[s("button",{class:"btn btn-sm btn-primary w-100",onClick:c}," + New Channel ")]),u.value.length===0?(d(),p("div",Rb,' No channels yet. Click "New Channel" to create one. ')):(d(),p("div",Vb,[(d(!0),p(se,null,ae(u.value,g=>(d(),p("div",{key:g.channel_id,class:"list-group-item list-group-item-action channel-item"},[s("div",Hb,[s("div",{class:"d-flex align-items-center flex-grow-1",onClick:y=>m(g.channel_id)},[_[2]||(_[2]=s("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),s("span",Fb,$(g.name),1)],8,Wb),s("div",Bb,[s("span",Ub,$(g.member_minion_ids?.length||0),1),s("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:he(y=>b(g),["stop"]),title:"Delete channel",style:{"font-size":"1.1rem","line-height":"1"}}," ðŸ—‘ï¸ ",8,qb)])])]))),128))]))])])])]),ie(wb,{ref_key:"createModal",ref:i,"legion-id":n.project.project_id,onCreated:h},null,8,["legion-id"]),ie(Mb,{ref_key:"deleteModal",ref:a,"legion-id":n.project.project_id,channel:r.value,onDeleted:f},null,8,["legion-id","channel"])],64))}},Kb=G(zb,[["__scopeId","data-v-3887d5f8"]]),Yb=["data-project-id"],Gb=["id"],Jb=["aria-expanded","aria-controls","onKeydown"],Xb={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Qb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Zb={class:"fw-semibold",style:{"flex-shrink":"0"}},ey={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},ty={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},sy=["title"],ny=["title"],oy=["id","aria-labelledby"],iy={class:"accordion-body p-0"},ay={class:"list-group list-group-flush"},ry={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ke(),o=ve(),i=ee(),a=ce(),r=D(e.project.is_expanded||!1),u=v(()=>o.formatPath(e.project.working_directory)),l=v(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(j=>i.getSession(j)).filter(j=>j!=null)),m=v(()=>{const j=t.currentRoute.value;return j.name==="timeline"&&j.params.legionId===e.project.project_id}),c=v(()=>{const j=t.currentRoute.value;return j.name==="horde"&&j.params.legionId===e.project.project_id});function b(j){const A=window.bootstrap;if(!A)return;const x=document.getElementById(`collapse-${e.project.project_id}`);if(!x)return;A.Collapse.getOrCreateInstance(x).toggle()}function h(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function f(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const j=i.currentSessionId;j&&i.getSession(j)&&e.project.session_ids?.includes(j)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function C(){a.showModal("edit-project",{project:e.project})}function _(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function g(){t.push(`/timeline/${e.project.project_id}`)}function y(){t.push(`/horde/${e.project.project_id}`)}function M(j){j.dataTransfer.effectAllowed="move",j.dataTransfer.setData("application/project-id",e.project.project_id),j.dataTransfer.setData("text/plain",e.project.project_id),j.target.classList.add("dragging")}function T(j){j.target.classList.remove("dragging")}function w(j){j.preventDefault(),j.dataTransfer.dropEffect="move";const A=j.currentTarget.getBoundingClientRect(),x=A.top+A.height/2;j.clientY<x?(j.currentTarget.classList.add("drop-above"),j.currentTarget.classList.remove("drop-below")):(j.currentTarget.classList.add("drop-below"),j.currentTarget.classList.remove("drop-above"))}function P(j){j.preventDefault(),j.currentTarget.classList.remove("drop-above","drop-below");const A=j.dataTransfer.getData("application/project-id")||j.dataTransfer.getData("text/plain");if(!A||A===e.project.project_id)return;const x=j.currentTarget.getBoundingClientRect(),N=x.top+x.height/2,S=j.clientY<N,E=o.orderedProjects,k=E.findIndex(ne=>ne.project_id===e.project.project_id),O=E.findIndex(ne=>ne.project_id===A);if(k===-1||O===-1)return;const L=[...E],[R]=L.splice(O,1);let F=S?k:k+1;O<k&&F--,L.splice(F,0,R);const B=L.map(ne=>ne.project_id);o.reorderProjects(B)}return(j,A)=>(d(),p("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:M,onDragend:T,onDragover:w,onDrop:P},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:K(["accordion-button bg-white p-2",{collapsed:!r.value}]),role:"button",tabindex:"0","aria-expanded":r.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:b,onKeydown:[Xt(he(b,["prevent"]),["enter"]),Xt(he(b,["prevent"]),["space"])]},[s("div",Xb,[s("div",Qb,[s("div",Zb,[n.project.is_multi_agent?(d(),p("span",ey,"ðŸ›")):I("",!0),Y(" "+$(n.project.name),1)]),s("div",ty,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:he(C,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:he(_,["stop"])}," âž• ",8,sy)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(u.value),9,ny)])],42,Jb)],8,Gb),ie(ef,{project:n.project,sessions:l.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:K(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:f},[s("div",iy,[s("div",ay,[n.project.is_multi_agent?(d(),p("div",{key:0,class:K(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:m.value}]),style:{cursor:"pointer"},onClick:g},[...A[0]||(A[0]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):I("",!0),n.project.is_multi_agent?(d(),p(se,{key:1},[s("div",{class:K(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:c.value}]),style:{cursor:"pointer"},onClick:y},[...A[1]||(A[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),s("span",{class:"fw-semibold"},"Horde"),s("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),ie(cf,{project:n.project,sessions:l.value},null,8,["project","sessions"]),ie(Kb,{project:n.project},null,8,["project"])],64)):(d(!0),p(se,{key:2},ae(l.value,x=>(d(),we(of,{key:x.session_id,session:x,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,oy)],40,Yb))}},ly=G(ry,[["__scopeId","data-v-04f4e534"]]),cy={class:"project-list"},uy={key:0,class:"text-muted text-center py-3"},dy={__name:"ProjectList",setup(n){const e=ve(),t=v(()=>e.orderedProjects);return(o,i)=>(d(),p("div",cy,[t.value.length===0?(d(),p("div",uy,' No projects yet. Click "New" to create one. ')):I("",!0),(d(!0),p(se,null,ae(t.value,a=>(d(),we(ly,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},py={class:"flex-grow-1 overflow-auto p-3"},my={id:"sessions-container"},fy={__name:"Sidebar",setup(n){const e=ce(),t=v(()=>e.sidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const r=D(!1);function u(c){r.value=!0,document.addEventListener("mousemove",l),document.addEventListener("mouseup",m)}function l(c){r.value&&e.setSidebarWidth(c.clientX)}function m(){r.value=!1,document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",m)}return(c,b)=>(d(),p("aside",{id:"sidebar",class:K(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:je(i.value)},[s("div",py,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[b[0]||(b[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),s("div",my,[ie(dy)])]),s("div",{class:"sidebar-resize-handle",onMousedown:u},null,32)],6))}},vy=G(fy,[["__scopeId","data-v-d792f0f0"]]),hy={class:"modal-dialog modal-lg"},_y={class:"modal-content"},gy={class:"modal-body"},by={class:"mb-3"},yy={class:"input-group"},$y=["disabled"],wy={key:0,class:"text-center py-4"},Ey={key:1,class:"alert alert-danger",role:"alert"},Cy={key:2,class:"folder-list"},Sy=["onClick","onDblclick"],Ty={class:"d-flex align-items-center flex-grow-1"},ky=["onClick"],xy={key:1,class:"text-center text-muted py-3"},Ay={class:"modal-footer"},My=["disabled"],Oy={__name:"FolderBrowserModal",setup(n){const e=ce(),t=D(""),o=D(""),i=D([]),a=D(!1),r=D(""),u=D(null);let l=null,m=null;const c=v(()=>{if(!t.value)return null;const T=t.value.split(/[\\/]/).filter(Boolean);return T.length<=1?null:(T.pop(),T.length>0?T.join("/"):"/")});function b(T){if(!T)return"";const w=T.split(/[\\/]/).filter(Boolean);return w.length<=2?T:".../"+w.slice(-2).join("/")}async function h(){a.value=!0,r.value="",i.value=[],o.value="";try{const T=t.value?{path:t.value}:{},w=await Z.get("/api/filesystem/browse",{params:T});w.current_path&&(t.value=w.current_path),i.value=w.directories||[]}catch(T){console.error("Failed to load directory:",T),r.value=T.message||"Failed to load directory"}finally{a.value=!1}}function f(T){o.value=T.path}function C(T){t.value=T.path,o.value="",h()}function _(){c.value&&(t.value=c.value,o.value="",h())}function g(){const T=o.value||t.value;T&&m&&m(T),l&&l.hide()}function y(){h()}function M(){i.value=[],o.value="",r.value="",m=null,e.hideModal()}return le(()=>e.currentModal,T=>{if(T?.name==="folder-browser"&&l){const w=T.data||{};t.value=w.currentPath||"",m=w.onSelect||null,l.show()}}),me(()=>{u.value&&$e(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{l=new T(u.value),u.value.addEventListener("shown.bs.modal",y),u.value.addEventListener("hidden.bs.modal",M)})}),be(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",y),u.value.removeEventListener("hidden.bs.modal",M)),l&&l.dispose()}),(T,w)=>(d(),p("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",hy,[s("div",_y,[w[7]||(w[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",gy,[s("div",by,[w[2]||(w[2]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",yy,[te(s("input",{type:"text",class:"form-control","onUpdate:modelValue":w[0]||(w[0]=P=>t.value=P),onKeyup:Xt(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[pe,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:h,disabled:a.value},[...w[1]||(w[1]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1),Y(" Refresh ",-1)])],8,$y)])]),a.value?(d(),p("div",wy,[...w[3]||(w[3]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(d(),p("div",Ey,$(r.value),1)):(d(),p("div",Cy,[c.value?(d(),p("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:_,role:"button"},[...w[4]||(w[4]=[s("i",{class:"bi bi-arrow-up-circle me-2 text-secondary"},null,-1),s("span",{class:"text-secondary"},"..",-1)])])):I("",!0),(d(!0),p(se,null,ae(i.value,P=>(d(),p("div",{key:P.path,class:K(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:P.path===o.value}]),onClick:j=>f(P),onDblclick:j=>C(P),role:"button"},[s("div",Ty,[w[5]||(w[5]=s("i",{class:"bi bi-folder-fill me-2 text-warning"},null,-1)),s("span",null,$(P.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:he(j=>C(P),["stop"])}," Open ",8,ky)],42,Sy))),128)),i.value.length===0?(d(),p("div",xy," No subdirectories found ")):I("",!0)]))]),s("div",Ay,[w[6]||(w[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:!o.value},' Select "'+$(b(o.value||t.value))+'" ',9,My)])])])],512))}},Ny=G(Oy,[["__scopeId","data-v-667c51a9"]]),Dy={class:"modal-dialog"},Ly={class:"modal-content"},Iy={class:"modal-body"},Py={class:"mb-3"},jy={key:0,class:"invalid-feedback"},Ry={class:"mb-3"},Vy={class:"input-group"},Hy={key:0,class:"invalid-feedback"},Wy={class:"mb-3 form-check"},Fy={class:"mb-3 form-check"},By={class:"form-check-label",for:"createSession"},Uy={key:0,class:"mb-3 ms-4"},qy={for:"sessionName",class:"form-label"},zy={key:1,class:"alert alert-danger",role:"alert"},Ky={class:"modal-footer"},Yy=["disabled"],Gy={key:0,class:"spinner-border spinner-border-sm me-2"},Jy={__name:"ProjectCreateModal",setup(n){const e=ve(),t=ee(),o=ce(),i=D({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=D({name:"",workingDirectory:""}),r=D(!1),u=D(""),l=D(null);let m=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:g=>{i.value.workingDirectory=g,a.value.workingDirectory=""}})}function b(){a.value={};let g=!0;return i.value.name.trim()||(a.value.name="Project name is required",g=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",g=!1),g}async function h(){if(b()){r.value=!0,u.value="";try{const g=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await t.createSession(g.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),m&&m.hide(),f()}catch(g){console.error("Failed to create project:",g),u.value=g.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function f(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},u.value=""}function C(){const g=document.getElementById("projectName");g&&g.focus()}function _(){f(),o.hideModal()}return le(()=>o.currentModal,g=>{g?.name==="create-project"&&m&&m.show()}),me(()=>{l.value&&$e(async()=>{const{default:g}=await import("./modal-B4rHLo2F.js").then(y=>y.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{m=new g(l.value),l.value.addEventListener("shown.bs.modal",C),l.value.addEventListener("hidden.bs.modal",_)})}),be(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",C),l.value.removeEventListener("hidden.bs.modal",_)),m&&m.dispose()}),(g,y)=>(d(),p("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",Dy,[s("div",Ly,[y[11]||(y[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Iy,[s("form",{onSubmit:he(h,["prevent"])},[s("div",Py,[y[5]||(y[5]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),te(s("input",{type:"text",class:K(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":y[0]||(y[0]=M=>i.value.name=M),placeholder:"My Project",required:""},null,2),[[pe,i.value.name]]),a.value.name?(d(),p("div",jy,$(a.value.name),1)):I("",!0)]),s("div",Ry,[y[6]||(y[6]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Vy,[te(s("input",{type:"text",class:K(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":y[1]||(y[1]=M=>i.value.workingDirectory=M),placeholder:"/path/to/project",required:""},null,2),[[pe,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(d(),p("div",Hy,$(a.value.workingDirectory),1)):I("",!0)]),y[7]||(y[7]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",Wy,[te(s("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":y[2]||(y[2]=M=>i.value.isMultiAgent=M)},null,512),[[At,i.value.isMultiAgent]]),y[8]||(y[8]=s("label",{class:"form-check-label",for:"isMultiAgent"}," ðŸ› Multi-Agent Project (Legion) ",-1)),y[9]||(y[9]=s("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),s("div",Fy,[te(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":y[3]||(y[3]=M=>i.value.createSession=M)},null,512),[[At,i.value.createSession]]),s("label",By," Create initial "+$(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(d(),p("div",Uy,[s("label",qy," Initial "+$(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),te(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":y[4]||(y[4]=M=>i.value.sessionName=M),placeholder:"main"},null,512),[[pe,i.value.sessionName]])])):I("",!0),u.value?(d(),p("div",zy,$(u.value),1)):I("",!0)],32)]),s("div",Ky,[y[10]||(y[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:r.value},[r.value?(d(),p("span",Gy)):I("",!0),Y(" "+$(r.value?"Creating...":"Create Project"),1)],8,Yy)])])])],512))}},Xy=G(Jy,[["__scopeId","data-v-adf50394"]]),Qy={class:"modal-dialog"},Zy={class:"modal-content"},e1={class:"modal-body"},t1={class:"mb-3"},s1={key:0,class:"invalid-feedback"},n1={class:"mb-3"},o1=["value"],i1={key:0,class:"alert alert-danger",role:"alert"},a1={class:"danger-zone"},r1={class:"text-muted small"},l1=["disabled"],c1={key:0,class:"alert alert-warning mt-3",role:"alert"},u1={class:"mb-2"},d1={class:"d-flex gap-2"},p1=["disabled"],m1={key:0,class:"spinner-border spinner-border-sm me-2"},f1=["disabled"],v1={class:"modal-footer"},h1=["disabled"],_1={key:0,class:"spinner-border spinner-border-sm me-2"},g1={__name:"ProjectEditModal",setup(n){const e=ve(),t=ce(),o=D(null),i=D({name:""}),a=D({name:""}),r=D(!1),u=D(!1),l=D(""),m=D(!1),c=D(null);let b=null;const h=v(()=>o.value?.session_ids?.length||0);function f(){a.value={};let T=!0;return i.value.name.trim()||(a.value.name="Project name is required",T=!1),T}async function C(){if(!(!f()||!o.value)){r.value=!0,l.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),b&&b.hide()}catch(T){console.error("Failed to update project:",T),l.value=T.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function _(){if(o.value){u.value=!0,l.value="";try{await e.deleteProject(o.value.project_id),b&&b.hide()}catch(T){console.error("Failed to delete project:",T),l.value=T.message||"Failed to delete project. Please try again."}finally{u.value=!1}}}function g(){i.value={name:""},a.value={},l.value="",m.value=!1}function y(){const T=document.getElementById("editProjectName");T&&(T.focus(),T.select())}function M(){g(),o.value=null,t.hideModal()}return le(()=>t.currentModal,T=>{if(T?.name==="edit-project"&&b){const w=T.data||{};o.value=w.project,o.value&&(i.value.name=o.value.name),b.show()}}),me(()=>{c.value&&$e(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{b=new T(c.value),c.value.addEventListener("shown.bs.modal",y),c.value.addEventListener("hidden.bs.modal",M)})}),be(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",y),c.value.removeEventListener("hidden.bs.modal",M)),b&&b.dispose()}),(T,w)=>(d(),p("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",Qy,[s("div",Zy,[w[11]||(w[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",e1,[s("form",{onSubmit:he(C,["prevent"])},[s("div",t1,[w[3]||(w[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),te(s("input",{type:"text",class:K(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":w[0]||(w[0]=P=>i.value.name=P),placeholder:"My Project",required:""},null,2),[[pe,i.value.name]]),a.value.name?(d(),p("div",s1,$(a.value.name),1)):I("",!0)]),s("div",n1,[w[4]||(w[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,o1),w[5]||(w[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),l.value?(d(),p("div",i1,$(l.value),1)):I("",!0)],32),w[9]||(w[9]=s("hr",null,null,-1)),s("div",a1,[w[7]||(w[7]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",r1," Deleting this project will also delete all "+$(h.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:w[1]||(w[1]=P=>m.value=!0),disabled:u.value},[...w[6]||(w[6]=[s("i",{class:"bi bi-trash"},null,-1),Y(" Delete Project ",-1)])],8,l1)]),m.value?(d(),p("div",c1,[w[8]||(w[8]=s("strong",null,"Are you sure?",-1)),s("p",u1,' This will permanently delete the project "'+$(o.value?.name)+'" and all '+$(h.value)+" session(s). ",1),s("div",d1,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:_,disabled:u.value},[u.value?(d(),p("span",m1)):I("",!0),Y(" "+$(u.value?"Deleting...":"Yes, Delete Permanently"),1)],8,p1),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:w[2]||(w[2]=P=>m.value=!1),disabled:u.value}," Cancel ",8,f1)])])):I("",!0)]),s("div",v1,[w[10]||(w[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:C,disabled:r.value},[r.value?(d(),p("span",_1)):I("",!0),Y(" "+$(r.value?"Saving...":"Save Changes"),1)],8,h1)])])])],512))}},b1=G(g1,[["__scopeId","data-v-6f299f35"]]),y1={class:"modal-dialog modal-lg"},$1={class:"modal-content"},w1={class:"modal-header"},E1={class:"modal-title",id:"createSessionModalLabel"},C1={key:0,class:"text-muted small"},S1={class:"modal-body"},T1={class:"mb-3"},k1={key:0,class:"invalid-feedback"},x1={class:"mb-3"},A1={class:"mb-3"},M1={class:"mb-3"},O1={class:"form-text d-flex justify-content-between"},N1={key:0,class:"invalid-feedback"},D1={class:"mb-3 form-check"},L1={key:0,class:"form-text text-warning"},I1={class:"mb-3"},P1={class:"mb-3 form-check"},j1={key:0,class:"alert alert-danger",role:"alert"},R1={class:"modal-footer"},V1=["disabled"],H1={key:0,class:"spinner-border spinner-border-sm me-2"},W1={__name:"SessionCreateModal",setup(n){const e=Ke();ve();const t=ee(),o=ce(),i=D(null),a=D({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0}),r=D({name:""}),u=D(!1),l=D(""),m=D(null);let c=null;const b=v(()=>a.value.system_prompt.length),h=v(()=>b.value>6e3),f=v(()=>b.value>5500&&b.value<=6e3);function C(){r.value={};let T=!0;return a.value.name.trim()||(r.value.name="Session name is required",T=!1),h.value&&(T=!1),T}async function _(){if(!(!C()||!i.value)){u.value=!0,l.value="";try{const T=a.value.tools.split(",").map(j=>j.trim()).filter(j=>j.length>0),w={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,tools:T},P=await t.createSession(i.value.project_id,w);a.value.startImmediately&&await t.startSession(P.session_id),e.push(`/session/${P.session_id}`),c&&c.hide(),g()}catch(T){console.error("Failed to create session:",T),l.value=T.message||"Failed to create session. Please try again."}finally{u.value=!1}}}function g(){a.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0},r.value={},l.value=""}function y(){const T=document.getElementById("sessionName");T&&T.focus()}function M(){g(),i.value=null,o.hideModal()}return le(()=>o.currentModal,T=>{if(T?.name==="create-session"&&c){const w=T.data||{};i.value=w.project,c.show()}}),me(()=>{m.value&&$e(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{c=new T(m.value),m.value.addEventListener("shown.bs.modal",y),m.value.addEventListener("hidden.bs.modal",M)})}),be(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",y),m.value.removeEventListener("hidden.bs.modal",M)),c&&c.dispose()}),(T,w)=>(d(),p("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[s("div",y1,[s("div",$1,[s("div",w1,[s("h5",E1,[w[7]||(w[7]=Y(" Create New Session ",-1)),i.value?(d(),p("span",C1,"in "+$(i.value.name),1)):I("",!0)]),w[8]||(w[8]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",S1,[s("form",{onSubmit:he(_,["prevent"])},[s("div",T1,[w[9]||(w[9]=s("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),te(s("input",{type:"text",class:K(["form-control",{"is-invalid":r.value.name}]),id:"sessionName","onUpdate:modelValue":w[0]||(w[0]=P=>a.value.name=P),placeholder:"main",required:""},null,2),[[pe,a.value.name]]),r.value.name?(d(),p("div",k1,$(r.value.name),1)):I("",!0)]),s("div",x1,[w[11]||(w[11]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),te(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":w[1]||(w[1]=P=>a.value.permission_mode=P)},[...w[10]||(w[10]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Fe,a.value.permission_mode]]),w[12]||(w[12]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",A1,[w[14]||(w[14]=s("label",{for:"model",class:"form-label"},"Model",-1)),te(s("select",{class:"form-select",id:"model","onUpdate:modelValue":w[2]||(w[2]=P=>a.value.model=P)},[...w[13]||(w[13]=[s("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),s("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),s("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[Fe,a.value.model]])]),s("div",M1,[w[15]||(w[15]=s("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),te(s("textarea",{class:K(["form-control",{"is-invalid":h.value}]),id:"systemPrompt","onUpdate:modelValue":w[3]||(w[3]=P=>a.value.system_prompt=P),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[pe,a.value.system_prompt]]),s("div",O1,[s("span",null,$(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),s("span",{class:K({"text-danger":h.value,"text-warning":f.value})},$(b.value)+" / 6000 chars ",3)]),h.value?(d(),p("div",N1," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):I("",!0)]),s("div",D1,[te(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":w[4]||(w[4]=P=>a.value.override_system_prompt=P)},null,512),[[At,a.value.override_system_prompt]]),w[17]||(w[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(d(),p("div",L1,[...w[16]||(w[16]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):I("",!0)]),s("div",I1,[w[18]||(w[18]=s("label",{for:"tools",class:"form-label"},"Allowed Tools (Optional)",-1)),te(s("input",{type:"text",class:"form-control",id:"tools","onUpdate:modelValue":w[5]||(w[5]=P=>a.value.tools=P),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[pe,a.value.tools]]),w[19]||(w[19]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",P1,[te(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":w[6]||(w[6]=P=>a.value.startImmediately=P)},null,512),[[At,a.value.startImmediately]]),w[20]||(w[20]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),l.value?(d(),p("div",j1,$(l.value),1)):I("",!0)],32)]),s("div",R1,[w[21]||(w[21]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:u.value},[u.value?(d(),p("span",H1)):I("",!0),Y(" "+$(u.value?"Creating...":"Create Session"),1)],8,V1)])])])],512))}},F1=G(W1,[["__scopeId","data-v-5aef47e0"]]),B1={class:"modal-dialog"},U1={class:"modal-content"},q1={class:"modal-body"},z1={class:"mb-3"},K1={key:0,class:"invalid-feedback"},Y1={class:"mb-3"},G1=["value"],J1={class:"mb-3"},X1={class:"form-control-plaintext"},Q1={class:"mb-3"},Z1=["disabled"],e$={key:0,value:"bypassPermissions"},t$={class:"form-text"},s$={key:0,class:"text-warning"},n$={key:1},o$={key:0,class:"mb-3"},i$={class:"card"},a$={class:"card-body"},r$={key:0,class:"mb-2"},l$={key:1,class:"mb-2"},c$={key:2,class:"mt-2"},u$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},d$={key:1,class:"alert alert-danger",role:"alert"},p$={class:"modal-footer"},m$=["disabled"],f$={key:0,class:"spinner-border spinner-border-sm me-2"},v$={__name:"SessionEditModal",setup(n){const e=ee(),t=ce(),o=D(null),i=D({name:"",permission_mode:"default"}),a=D({name:""}),r=D(!1),u=D(""),l=D(null);let m=null;const c=v(()=>o.value?.state==="active"||o.value?.state==="starting"),b=v(()=>o.value?.initial_permission_mode==="bypassPermissions");function h(M){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[M]||"bg-secondary"}function f(){a.value={};let M=!0;return i.value.name.trim()||(a.value.name="Session name is required",M=!1),M}async function C(){if(!(!f()||!o.value)){r.value=!0,u.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),m&&m.hide()}catch(M){console.error("Failed to update session:",M),u.value=M.message||"Failed to update session. Please try again."}finally{r.value=!1}}}function _(){i.value={name:"",permission_mode:"default"},a.value={},u.value=""}function g(){const M=document.getElementById("editSessionName");M&&(M.focus(),M.select())}function y(){_(),o.value=null,t.hideModal()}return le(()=>t.currentModal,M=>{if(M?.name==="edit-session"&&m){const T=M.data||{};o.value=T.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),m.show()}}),me(()=>{l.value&&$e(async()=>{const{default:M}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:M}},__vite__mapDeps([0,1])).then(({default:M})=>{m=new M(l.value),l.value.addEventListener("shown.bs.modal",g),l.value.addEventListener("hidden.bs.modal",y)})}),be(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",g),l.value.removeEventListener("hidden.bs.modal",y)),m&&m.dispose()}),(M,T)=>(d(),p("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",B1,[s("div",U1,[T[15]||(T[15]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",q1,[s("form",{onSubmit:he(C,["prevent"])},[s("div",z1,[T[2]||(T[2]=s("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),te(s("input",{type:"text",class:K(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":T[0]||(T[0]=w=>i.value.name=w),placeholder:"Session Name",required:""},null,2),[[pe,i.value.name]]),a.value.name?(d(),p("div",K1,$(a.value.name),1)):I("",!0)]),s("div",Y1,[T[3]||(T[3]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,G1),T[4]||(T[4]=s("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),s("div",J1,[T[5]||(T[5]=s("label",{class:"form-label"},"Current State",-1)),s("div",X1,[s("span",{class:K(["badge",h(o.value?.state)])},$(o.value?.state),3)])]),s("div",Q1,[T[9]||(T[9]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),te(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":T[1]||(T[1]=w=>i.value.permission_mode=w),disabled:!c.value},[T[6]||(T[6]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),T[7]||(T[7]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),T[8]||(T[8]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),b.value?(d(),p("option",e$,"âš ï¸ Bypass Permissions (No prompts)")):I("",!0)],8,Z1),[[Fe,i.value.permission_mode]]),s("div",t$,[c.value?(d(),p("span",n$," Controls which tool actions require permission prompts ")):(d(),p("span",s$," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(d(),p("div",o$,[T[13]||(T[13]=s("label",{class:"form-label"},"System Prompt Configuration",-1)),s("div",i$,[s("div",a$,[o.value?.override_system_prompt?(d(),p("div",r$,[...T[10]||(T[10]=[s("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),s("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(d(),p("div",l$,[...T[11]||(T[11]=[s("span",{class:"badge bg-info"},"Append Mode",-1),s("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(d(),p("div",c$,[T[12]||(T[12]=s("strong",{class:"small"},"Custom Instructions:",-1)),s("div",u$,$(o.value.system_prompt),1)])):I("",!0)])])])):I("",!0),u.value?(d(),p("div",d$,$(u.value),1)):I("",!0)],32)]),s("div",p$,[T[14]||(T[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:C,disabled:r.value},[r.value?(d(),p("span",f$)):I("",!0),Y(" "+$(r.value?"Saving...":"Save Changes"),1)],8,m$)])])])],512))}},h$=G(v$,[["__scopeId","data-v-c99ca17f"]]),_$={class:"modal-dialog modal-dialog-centered"},g$={class:"modal-content"},b$={class:"modal-header"},y$={class:"modal-title",id:"manageSessionModalLabel"},$$={class:"modal-body"},w$={key:0,class:"text-center py-4"},E$={class:"text-muted"},C$={key:1},S$={key:2},T$={class:"text-muted"},k$={key:3},x$={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},A$={class:"d-grid gap-2"},M$=["disabled"],O$=["disabled"],N$=["disabled"],D$=["disabled"],L$={class:"modal-footer"},I$={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},P$={__name:"SessionManageModal",setup(n){const e=Ke(),t=ee(),o=ce(),i=Ye();De();const a=D(null),r=D(!1),u=D(""),l=D(""),m=D(null),c=D(null);let b=null;const h=v(()=>m.value==="reset"?"Reset Session":m.value==="delete"?"Delete Session":"Manage Session");function f(){m.value="reset"}function C(){m.value="delete"}function _(){m.value=null}async function g(){m.value==="reset"?await T():m.value==="delete"&&await w()}async function y(){if(a.value){r.value=!0,u.value="Restarting session...";try{const A=a.value.session_id,x=await Z.post(`/api/sessions/${A}/restart`);if(x.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A),b&&b.hide();else{const N=x.error||x.detail||"Failed to restart session";console.error("Failed to restart session:",N),l.value=`Failed to restart session: ${N}`}}catch(A){console.error("Error restarting session:",A);const x=A.data?.detail||A.message||"Unknown error";l.value=`Error restarting session: ${x}`}finally{r.value=!1}}}async function M(){if(a.value)try{b&&b.hide(),console.log("Ending session",a.value.session_id);const A=a.value.session_id;await Z.post(`/api/sessions/${A}/terminate`),await i.disconnectSession(),t.currentSessionId===A&&(t.currentSessionId=null),e.push("/")}catch(A){console.error("Error ending session:",A),await i.disconnectSession(),t.currentSessionId===a.value?.session_id&&(t.currentSessionId=null),e.push("/")}}async function T(){if(a.value){r.value=!0,u.value="Resetting session...";try{const A=a.value.session_id,x=await Z.post(`/api/sessions/${A}/reset`);if(x.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A),b&&b.hide();else{const N=x.error||x.detail||"Failed to reset session";console.error("Failed to reset session:",N),l.value=`Failed to reset session: ${N}`,m.value=null}}catch(A){console.error("Error resetting session:",A);const x=A.data?.detail||A.message||"Unknown error";l.value=`Error resetting session: ${x}`,m.value=null}finally{r.value=!1}}}async function w(){if(a.value){r.value=!0,u.value="Deleting session...";try{const A=a.value.session_id;await t.deleteSession(A),e.currentRoute.value.params.sessionId===A&&e.push("/"),b&&b.hide()}catch(A){console.error("Error deleting session:",A);const x=A.data?.detail||A.message||"Unknown error";l.value=`Error deleting session: ${x}`,m.value=null}finally{r.value=!1}}}function P(){m.value=null,r.value=!1,u.value="",l.value=""}function j(){P(),a.value=null,o.hideModal()}return le(()=>o.currentModal,A=>{if(A?.name==="manage-session"&&b){const x=A.data||{};a.value=x.session,P(),b.show()}}),me(()=>{c.value&&$e(async()=>{const{default:A}=await import("./modal-B4rHLo2F.js").then(x=>x.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{b=new A(c.value),c.value.addEventListener("hidden.bs.modal",j)})}),be(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",j),b&&b.dispose()}),(A,x)=>(d(),p("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",_$,[s("div",g$,[s("div",b$,[s("h5",y$,$(m.value?h.value:"Manage Session"),1),x[1]||(x[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",$$,[r.value?(d(),p("div",w$,[x[2]||(x[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",E$,$(u.value),1)])):m.value==="reset"?(d(),p("div",C$,[...x[3]||(x[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):m.value==="delete"?(d(),p("div",S$,[x[6]||(x[6]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",T$,[x[4]||(x[4]=Y("This will permanently delete session ",-1)),s("strong",null,$(a.value?.name),1),x[5]||(x[5]=Y(".",-1))]),x[7]||(x[7]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(d(),p("div",k$,[l.value?(d(),p("div",x$,[x[8]||(x[8]=s("strong",null,"Error:",-1)),Y(" "+$(l.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:x[0]||(x[0]=N=>l.value="")})])):I("",!0),x[15]||(x[15]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",A$,[s("button",{class:"btn btn-outline-primary text-start",onClick:y,disabled:r.value},[...x[9]||(x[9]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,M$),s("button",{class:"btn btn-outline-secondary text-start",onClick:M,disabled:r.value},[...x[10]||(x[10]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,O$),x[13]||(x[13]=s("hr",{class:"my-2"},null,-1)),x[14]||(x[14]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:f,disabled:r.value},[...x[11]||(x[11]=[s("strong",null,"ðŸ—‘ï¸ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,N$),s("button",{class:"btn btn-outline-danger text-start",onClick:C,disabled:r.value},[...x[12]||(x[12]=[s("strong",null,"âŒ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,D$)]),x[16]||(x[16]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),Y(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",L$,[m.value&&!r.value?(d(),p(se,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),s("button",{type:"button",class:K(["btn",m.value==="delete"?"btn-danger":"btn-warning"]),onClick:g},$(m.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?I("",!0):(d(),p("button",I$,"Cancel"))])])])],512))}},j$=G(P$,[["__scopeId","data-v-de7ff18c"]]),R$={class:"modal-dialog modal-dialog-centered modal-lg"},V$={class:"modal-content"},H$={class:"modal-body"},W$={key:0,class:"text-center text-muted py-4"},F$={key:1},B$={class:"mb-3"},U$={class:"font-monospace small"},q$={class:"mb-3"},z$={class:"font-monospace small"},K$={class:"mb-3"},Y$={class:"mb-3"},G$={class:"mb-3"},J$={key:0},X$={class:"d-flex flex-wrap gap-1"},Q$={key:1,class:"text-muted small"},Z$={key:0,class:"mb-3"},ew={class:"d-flex flex-wrap gap-1"},tw={key:1,class:"mb-3"},sw={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},nw={class:"mb-3"},ow={class:"text-muted"},iw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},aw={__name:"SessionInfoModal",setup(n){const e=ee(),t=De(),o=ce(),i=D(null),a=D(!1),r=D(null);let u=null;const l=v(()=>{if(!i.value)return null;const h=e.initData.get(i.value);return h||(t.messagesBySession.get(i.value)||[]).find(_=>_.type==="system"&&(_.subtype==="init"||_.metadata?.subtype==="init")&&_.metadata?.init_data)?.metadata?.init_data||null});function m(h){return typeof h=="string"?h:typeof h=="object"&&h.type==="preset"?`Preset: ${h.preset}`:JSON.stringify(h,null,2)}function c(){i.value=null,a.value=!1}function b(){c(),o.hideModal()}return le(()=>o.currentModal,h=>{if(h?.name==="session-info"&&u){const f=h.data||{};i.value=f.sessionId,a.value=!1,u.show()}}),me(()=>{r.value&&$e(async()=>{const{default:h}=await import("./modal-B4rHLo2F.js").then(f=>f.m);return{default:h}},__vite__mapDeps([0,1])).then(({default:h})=>{u=new h(r.value),r.value.addEventListener("hidden.bs.modal",b)})}),be(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",b),u&&u.dispose()}),(h,f)=>(d(),p("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",R$,[s("div",V$,[f[9]||(f[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",H$,[l.value?(d(),p("div",F$,[s("div",B$,[f[1]||(f[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",U$,$(i.value),1)]),s("div",q$,[f[2]||(f[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("div",z$,$(l.value.cwd||"Not specified"),1)]),s("div",K$,[f[3]||(f[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,$(l.value.model||"Default"),1)]),s("div",Y$,[f[4]||(f[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,$(l.value.permissionMode||"default"),1)]),s("div",G$,[f[5]||(f[5]=s("h6",{class:"text-muted"},"Available Tools",-1)),l.value.tools&&l.value.tools.length>0?(d(),p("div",J$,[s("div",X$,[(d(!0),p(se,null,ae(l.value.tools,C=>(d(),p("span",{key:C,class:"badge bg-secondary"},$(C),1))),128))])])):(d(),p("div",Q$,"All tools available"))]),l.value.commands&&l.value.commands.length>0?(d(),p("div",Z$,[f[6]||(f[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",ew,[(d(!0),p(se,null,ae(l.value.commands,C=>(d(),p("span",{key:C,class:"badge bg-info"},$(C),1))),128))])])):I("",!0),l.value.systemPrompt?(d(),p("div",tw,[f[7]||(f[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",sw,$(m(l.value.systemPrompt)),1)])):I("",!0),s("div",nw,[s("h6",ow,[f[8]||(f[8]=Y(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:f[0]||(f[0]=C=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(d(),p("pre",iw,$(JSON.stringify(l.value,null,2)),1)):I("",!0)])])):(d(),p("div",W$," No session configuration data available "))]),f[10]||(f[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},rw=G(aw,[["__scopeId","data-v-809e2099"]]),lw={class:"modal-dialog modal-dialog-centered"},cw={class:"modal-content"},uw={class:"modal-body"},dw={class:"mb-3"},pw={class:"mb-3"},mw={class:"mb-3"},fw={class:"form-text d-flex justify-content-between"},vw={key:0,class:"invalid-feedback"},hw={class:"mb-3 form-check"},_w={key:0,class:"form-text text-warning"},gw={class:"mb-3"},bw={key:0,class:"alert alert-danger"},yw={class:"modal-footer"},$w=["disabled"],ww={key:0,class:"spinner-border spinner-border-sm me-2"},Ew={__name:"CreateMinionModal",setup(n){const e=Ke(),t=ve(),o=ee(),i=ce(),a=D(null);let r=null;const u=D(null),l=D({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[]}),m=D(""),c=D(""),b=D(!1),h=v(()=>m.value.trim()?m.value.split(",").map(T=>T.trim()).filter(T=>T.length>0):[]),f=v(()=>l.value.initialization_context.length),C=v(()=>f.value>2e3),_=v(()=>f.value>1800&&f.value<=2e3);function g(){l.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[]},m.value="",c.value="",b.value=!1}function y(){g(),i.hideModal()}async function M(){if(!l.value.name.trim()){c.value="Minion name is required";return}if(l.value.name.includes(" ")){c.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(C.value){c.value="Initialization context exceeds 2000 character limit";return}if(!u.value){c.value="Legion ID is missing";return}b.value=!0,c.value="";try{const T={name:l.value.name.trim(),role:l.value.role.trim(),initialization_context:l.value.initialization_context.trim(),override_system_prompt:l.value.override_system_prompt,capabilities:h.value},w=await Z.post(`/api/legions/${u.value}/minions`,T);w.success&&w.minion_id?(await t.fetchProjects(),await o.fetchSessions(),r&&r.hide(),e.push(`/spy/${u.value}/${w.minion_id}`)):c.value="Failed to create minion"}catch(T){console.error("Failed to create minion:",T),c.value=T.response?.data?.detail||"Failed to create minion"}finally{b.value=!1}}return le(()=>i.currentModal,T=>{if(T?.name==="create-minion"&&r){const w=T.data||{};u.value=w.project?.project_id||null,g(),r.show()}}),me(()=>{a.value&&$e(()=>import("./modal-B4rHLo2F.js").then(T=>T.m),__vite__mapDeps([0,1])).then(T=>{const w=T.default;r=new w(a.value),a.value.addEventListener("hidden.bs.modal",y)})}),be(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",y),r&&r.dispose()}),(T,w)=>(d(),p("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[s("div",lw,[s("div",cw,[w[15]||(w[15]=s("div",{class:"modal-header"},[s("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",uw,[s("form",{onSubmit:he(M,["prevent"])},[s("div",dw,[w[5]||(w[5]=s("label",{for:"minion-name",class:"form-label"},[Y(" Name "),s("span",{class:"text-danger"},"*")],-1)),te(s("input",{id:"minion-name","onUpdate:modelValue":w[0]||(w[0]=P=>l.value.name=P),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[pe,l.value.name]]),w[6]||(w[6]=s("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),s("div",pw,[w[7]||(w[7]=s("label",{for:"minion-role",class:"form-label"},"Role",-1)),te(s("input",{id:"minion-role","onUpdate:modelValue":w[1]||(w[1]=P=>l.value.role=P),type:"text",class:"form-control",placeholder:"e.g., Code Expert, Testing Specialist"},null,512),[[pe,l.value.role]]),w[8]||(w[8]=s("div",{class:"form-text"},"Optional role description for the minion",-1))]),s("div",mw,[w[9]||(w[9]=s("label",{for:"minion-context",class:"form-label"},"Initialization Context",-1)),te(s("textarea",{id:"minion-context","onUpdate:modelValue":w[2]||(w[2]=P=>l.value.initialization_context=P),class:K(["form-control",{"is-invalid":C.value}]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion..."},null,2),[[pe,l.value.initialization_context]]),s("div",fw,[s("span",null,$(l.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),s("span",{class:K({"text-danger":C.value,"text-warning":_.value})},$(f.value)+" / 2000 chars ",3)]),C.value?(d(),p("div",vw," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):I("",!0)]),s("div",hw,[te(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":w[3]||(w[3]=P=>l.value.override_system_prompt=P)},null,512),[[At,l.value.override_system_prompt]]),w[11]||(w[11]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),l.value.override_system_prompt?(d(),p("div",_w,[...w[10]||(w[10]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):I("",!0)]),s("div",gw,[w[12]||(w[12]=s("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),te(s("input",{id:"minion-capabilities","onUpdate:modelValue":w[4]||(w[4]=P=>m.value=P),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[pe,m.value]]),w[13]||(w[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),c.value?(d(),p("div",bw,$(c.value),1)):I("",!0)],32)]),s("div",yw,[w[14]||(w[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",disabled:!l.value.name.trim()||b.value,onClick:M},[b.value?(d(),p("span",ww)):I("",!0),Y(" "+$(b.value?"Creating...":"Create Minion"),1)],8,$w)])])])],512))}},Cw=G(Ew,[["__scopeId","data-v-d7434e2a"]]),Sw={class:"modal-dialog modal-dialog-centered modal-lg"},Tw={class:"modal-content"},kw={class:"modal-body"},xw={key:0,class:"text-center text-muted py-4"},Aw={key:1},Mw={class:"mb-3"},Ow={class:"mb-3"},Nw={class:"font-monospace small"},Dw={class:"mb-3"},Lw={class:"mb-3"},Iw={class:"mb-3"},Pw={key:0},jw={class:"d-flex flex-wrap gap-1"},Rw={key:1,class:"text-muted small"},Vw={class:"mb-3"},Hw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},Ww={key:1,class:"text-muted small"},Fw={class:"mb-3"},Bw={key:0,class:"badge bg-info"},Uw={key:1,class:"badge bg-secondary"},qw={class:"mb-3"},zw={key:0,class:"font-monospace small"},Kw={key:1,class:"text-muted small"},Yw={key:0,class:"mb-3"},Gw={key:0},Jw={class:"list-unstyled mb-0"},Xw={key:1,class:"text-muted small"},Qw={class:"mb-3"},Zw={key:0,class:"font-monospace small"},eE={key:1,class:"text-muted small"},tE={class:"mb-3"},sE={key:0},nE={class:"d-flex flex-wrap gap-1"},oE={key:1,class:"text-muted small"},iE={class:"mb-3"},aE={class:"small"},rE={class:"mb-3"},lE={class:"small"},cE={__name:"MinionViewModal",setup(n){const e=ce(),t=D(null),o=D(null);let i=null;function a(m){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[m]||"bg-secondary"}function r(m){if(!m)return"N/A";try{const c=new Date(m);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function u(){t.value=null}function l(){u(),e.hideModal()}return le(()=>e.currentModal,m=>{if(m?.name==="minion-view"&&i){const c=m.data||{};t.value=c.session,i.show()}}),me(()=>{o.value&&$e(async()=>{const{default:m}=await import("./modal-B4rHLo2F.js").then(c=>c.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{i=new m(o.value),o.value.addEventListener("hidden.bs.modal",l)})}),be(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",l),i&&i.dispose()}),(m,c)=>(d(),p("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",Sw,[s("div",Tw,[c[13]||(c[13]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",kw,[t.value?(d(),p("div",Aw,[s("div",Mw,[c[0]||(c[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,$(t.value.name||"Unnamed Minion"),1)]),s("div",Ow,[c[1]||(c[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",Nw,$(t.value.session_id),1)]),s("div",Dw,[c[2]||(c[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,$(t.value.role||"Not specified"),1)]),s("div",Lw,[c[3]||(c[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:K(["badge",a(t.value.state)])},$(t.value.state),3)])]),s("div",Iw,[c[4]||(c[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(d(),p("div",Pw,[s("div",jw,[(d(!0),p(se,null,ae(t.value.capabilities,b=>(d(),p("span",{key:b,class:"badge bg-secondary"},$(b),1))),128))])])):(d(),p("div",Rw,"None"))]),s("div",Vw,[c[5]||(c[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(d(),p("div",Hw,$(t.value.initialization_context),1)):(d(),p("div",Ww,"Not specified"))]),s("div",Fw,[c[6]||(c[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(d(),p("span",Bw,"Yes")):(d(),p("span",Uw,"No"))])]),s("div",qw,[c[7]||(c[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(d(),p("div",zw,$(t.value.parent_overseer_id),1)):(d(),p("div",Kw,$(t.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),t.value.is_overseer?(d(),p("div",Yw,[c[8]||(c[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(d(),p("div",Gw,[s("ul",Jw,[(d(!0),p(se,null,ae(t.value.child_minion_ids,b=>(d(),p("li",{key:b,class:"font-monospace small"},$(b),1))),128))])])):(d(),p("div",Xw,"No children"))])):I("",!0),s("div",Qw,[c[9]||(c[9]=s("h6",{class:"text-muted"},"Horde Membership",-1)),t.value.horde_id?(d(),p("div",Zw,$(t.value.horde_id),1)):(d(),p("div",eE,"Not in a horde"))]),s("div",tE,[c[10]||(c[10]=s("h6",{class:"text-muted"},"Channel Memberships",-1)),t.value.channel_ids&&t.value.channel_ids.length>0?(d(),p("div",sE,[s("div",nE,[(d(!0),p(se,null,ae(t.value.channel_ids,b=>(d(),p("span",{key:b,class:"badge bg-info"},$(b),1))),128))])])):(d(),p("div",oE,"No channels"))]),s("div",iE,[c[11]||(c[11]=s("h6",{class:"text-muted"},"Created",-1)),s("div",aE,$(r(t.value.created_at)),1)]),s("div",rE,[c[12]||(c[12]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",lE,$(r(t.value.updated_at)),1)])])):(d(),p("div",xw," No minion data available "))]),c[14]||(c[14]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},uE=G(cE,[["__scopeId","data-v-c44eaee2"]]),dE={class:"container-fluid vh-100 d-flex flex-column p-0"},pE={class:"d-flex flex-grow-1 overflow-hidden position-relative"},mE={class:"flex-grow-1 d-flex flex-column overflow-hidden"},fE={__name:"App",setup(n){const e=ce(),t=Ye(),o=ee(),i=ve(),a=Ke(),r=v(()=>e.sidebarCollapsed),u=v(()=>e.isMobile);me(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const b=c.replace("#/session/","");o.sessions.has(b)&&await o.selectSession(b)}else if(c.startsWith("#/timeline/")){const b=c.replace("#/timeline/","");a.push(`/timeline/${b}`)}window.addEventListener("popstate",l),window.addEventListener("resize",e.handleResize)}),be(()=>{window.removeEventListener("popstate",l),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function l(){const c=window.location.hash;if(c.startsWith("#/session/")){const b=c.replace("#/session/","");o.sessions.has(b)&&o.selectSession(b)}}function m(){e.toggleSidebar()}return(c,b)=>{const h=oo("router-view");return d(),p("div",dE,[ie(Gm),s("div",{id:"sidebar-backdrop",class:K({show:!r.value&&u.value}),onClick:m},null,2),s("div",pE,[ie(vy),s("main",mE,[ie(h)])]),ie(Ny),ie(Xy),ie(b1),ie(F1),ie(h$),ie(j$),ie(rw),ie(Cw),ie(uE)])}}},on=fi(fE);on.use(vi());on.use(Um);on.mount("#app");
