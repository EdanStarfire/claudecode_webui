const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as i,d as tt,r as O,b as h,n as je,e as H,f as ce,t as k,u as ne,w as fe,g as rs,F as se,h as le,i as E,j as Ba,k as ye,l as Se,v as Ve,m as Te,p as xo,q as be,s as Co,x as dt,y as Me,z as Eo,A as De,B as En,C as cn,D as ts,E as Fa,G as Va,H as un,T as Wa,I as To,J as Ao,K as ot,L as bs,M as Ls,N as Tn,O as Ua,P as Ha}from"./vue-vendor-Ctw3vgQe.js";import{m as Ke,p as Vt}from"./markdown-vendor-BRsjnVvP.js";import{c as qa}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();const za={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ka={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),r("div",za,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Ga="modulepreload",Ya=function(n){return"/"+n},An={},Ie=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let m=function(p){return Promise.all(p.map(d=>Promise.resolve(d).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");a=m(s.map(p=>{if(p=Ya(p),p in An)return;An[p]=!0;const d=p.endsWith(".css"),$=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${$}`))return;const v=document.createElement("link");if(v.rel=d?"stylesheet":Ga,d||(v.as="script"),v.crossOrigin="",v.href=p,f&&v.setAttribute("nonce",f),document.head.appendChild(v),d)return new Promise((g,w)=>{v.addEventListener("load",g),v.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return a.then(u=>{for(const f of u||[])f.status==="rejected"&&c(f.reason);return e().catch(c)})};class Ns extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Nt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new Ns(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Ns?s:(console.error("API request failed:",s),new Ns(`Network error: ${s.message}`,0,null))}}async function Xt(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[f,m]of Object.entries(e.params))m!=null&&o.append(f,m);const a=o.toString();a&&(s=`${n}?${a}`);const{params:c,...u}=e;return Nt(s,{...u,method:"GET"})}return Nt(s,{...e,method:"GET"})}async function Do(n,e,s={}){return Nt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ja(n,e,s={}){return Nt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Mo(n,e={}){return Nt(n,{...e,method:"DELETE"})}async function Qa(n,e,s={}){return Nt(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Xa(){return Xt("/api/system/git-status")}async function Za(){return Do("/api/system/restart")}const ge={get:Xt,post:Do,put:Ja,delete:Mo,patch:Qa},pe=tt("session",()=>{const n=O(new Map),e=O(null),s=O(new Map),o=O(new Map),a=O(new Set),c=O(!1);let u=null;const f=h(()=>n.value.get(e.value)),m=h(()=>Array.from(n.value.values()).sort((A,N)=>A.order-N.order)),p=A=>h(()=>m.value.filter(N=>N.project_id===A)),d=h({get:()=>s.value.get(e.value)||"",set:A=>{e.value&&s.value.set(e.value,A)}});async function $(){try{const A=await ge.get("/api/sessions");return n.value.clear(),A.sessions.forEach(N=>{n.value.set(N.session_id,N)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function v(A,N){try{const M=(await ge.post("/api/sessions",{project_id:A,...N})).session_id,B=(await ge.get(`/api/sessions/${M}`)).session;return n.value.set(M,B),n.value=new Map(n.value),console.log(`Created session ${M}`),B}catch(C){throw console.error("Failed to create session:",C),C}}async function g(A){if(e.value===A&&!c.value)return;u&&(console.log(`Aborting pending selection to switch to ${A}`),u.abort(),u=null);const N=new AbortController;u=N,c.value=!0;try{if(e.value=A,N.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let C=n.value.get(A);if(!C)try{const F=await ge.get(`/api/sessions/${A}`);if(N.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}C=F.session,n.value.set(A,C),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(F){console.error(`Failed to fetch session ${A}:`,F);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await l(A),N.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${C.state} state)`);const F=6e4,V=200,G=5e3;let I=0,L=0;for(;I<F;){if(N.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const j=n.value.get(A);if(j&&j.state==="active"){console.log(`Session ${A} is now active after ${I}ms`);break}if(I-L>=G){const z=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${z}, ${I/1e3}s elapsed)`),L=I}await new Promise(z=>setTimeout(z,V)),I+=V}const K=n.value.get(A);K&&K.state!=="active"&&console.warn(`Session ${A} did not become active within ${F/1e3}s (state: ${K.state}), continuing anyway`)}catch(F){console.error(`Failed to auto-start session ${A}:`,F)}if(N.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>mi),void 0)).useMessageStore().loadMessages(A),N.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>Hi),void 0)).useResourceStore().loadResources(A),N.signal.aborted){console.log(`Selection of ${A} aborted after resource load`);return}await(await Ie(()=>Promise.resolve().then(()=>qi),void 0)).useWebSocketStore().connectSession(A),N.signal.aborted||console.log(`Selected session ${A}`)}finally{u===N&&(u=null),c.value=!1}}function w(A,N){const C=n.value.get(A);C?Object.assign(C,N):(n.value.set(A,N),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function _(A){a.value.add(A);try{const C=(await ge.delete(`/api/sessions/${A}`)).deleted_session_ids||[A];for(const M of C)n.value.delete(M),s.value.delete(M),o.value.delete(M);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(N){throw console.error("Failed to delete session:",N),N}finally{a.value.delete(A)}}async function b(A,N){try{await ge.patch(`/api/sessions/${A}`,N),w(A,N),console.log(`Updated session ${A}:`,N)}catch(C){throw console.error("Failed to update session:",C),C}}async function y(A,N){try{await ge.post(`/api/sessions/${A}/permission-mode`,{mode:N}),w(A,{current_permission_mode:N});const C=o.value.get(A);C&&(C.permissionMode=N,o.value.set(A,C)),console.log(`Set permission mode for session ${A} to ${N}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function l(A){try{await ge.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(N){throw console.error("Failed to start session:",N),N}}async function S(A){try{await ge.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(N){throw console.error("Failed to pause session:",N),N}}async function x(A){try{await ge.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(N){throw console.error("Failed to terminate session:",N),N}}function T(A){return n.value.get(A)}function D(A,N){o.value.set(A,N),N.permissionMode&&w(A,{current_permission_mode:N.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:f,orderedSessions:m,sessionsInProject:p,currentInput:d,fetchSessions:$,createSession:v,selectSession:g,updateSession:w,deleteSession:_,patchSession:b,setPermissionMode:y,startSession:l,pauseSession:S,terminateSession:x,getSession:T,storeInitData:D}}),Dn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:pe},Symbol.toStringTag,{value:"Module"})),Oo="webui-sidebar-";function Kt(n,e){try{const s=localStorage.getItem(Oo+n);return s!==null?JSON.parse(s):e}catch{return e}}function Et(n,e){try{localStorage.setItem(Oo+n,JSON.stringify(e))}catch{}}const xe=tt("ui",()=>{const n=O(Kt("rightCollapsed",!0)),e=O(Kt("rightWidth",300)),s=O(Kt("activeTab","diff")),o=O(window.innerWidth>=768?Kt("rightVisible",!0):!1),a=O(null),c=O(new Set),u=O(window.innerWidth),f=h(()=>u.value<768),m=O(!0),p=O(!1),d=O(null),$=O(null),v=h(()=>d.value?{name:d.value,data:$.value}:null),g=O(!1),w=O("Loading..."),_=O(!1),b=O("idle");function y(){n.value=!n.value,Et("rightCollapsed",n.value)}function l(j){n.value=j,Et("rightCollapsed",j)}function S(j){e.value=Math.max(200,Math.min(j,window.innerWidth*.3)),Et("rightWidth",e.value)}function x(j){s.value=j,Et("activeTab",j)}function T(j){m.value=j}function D(){const j=localStorage.getItem("webui-background-color");p.value=j==="red"}function A(){p.value=!p.value,localStorage.setItem("webui-background-color",p.value?"red":"gray")}function N(j,z=null){d.value=null,$.value=null,setTimeout(()=>{d.value=j,$.value=z},0)}function C(){d.value=null,$.value=null}function M(j="Loading..."){g.value=!0,w.value=j}function W(){g.value=!1}function B(){N("restart-server")}function F(j){a.value=j}function V(j){c.value.has(j)?c.value.delete(j):c.value.add(j),c.value=new Set(c.value)}function G(){c.value.size>0&&(c.value=new Set)}function I(){o.value=!o.value,Et("rightVisible",o.value)}function L(j){o.value=j,Et("rightVisible",j)}function K(){const j=u.value;u.value=window.innerWidth,u.value>=768&&j<768?o.value=Kt("rightVisible",!0):u.value<768&&j>=768&&(o.value=!1)}return{rightSidebarCollapsed:n,rightSidebarWidth:e,rightSidebarActiveTab:s,rightPanelVisible:o,browsingProjectId:a,expandedStacks:c,windowWidth:u,isMobile:f,autoScrollEnabled:m,isRedBackground:p,activeModal:d,modalData:$,currentModal:v,isLoading:g,loadingMessage:w,restartInProgress:_,restartStatus:b,toggleRightSidebar:y,setRightSidebarCollapsed:l,setRightSidebarWidth:S,setRightSidebarTab:x,setBrowsingProject:F,toggleStack:V,collapseAllStacks:G,toggleRightPanel:I,setRightPanelVisible:L,setAutoScroll:T,initBackgroundColor:D,toggleBackgroundColor:A,showModal:N,hideModal:C,showLoading:M,hideLoading:W,showRestartModal:B,handleResize:K}}),te=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},ei={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},ti=["title"],si={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},ni={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=h(()=>s.sessions.get(e.sessionId)),a=h(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),c=h(()=>{const m=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),u=h(()=>{const m=a.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),f=h(()=>{if(!o.value)return"No session selected";const m=a.value,p=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),d=o.value.name||"Unnamed Session",$=o.value.role?` (${o.value.role})`:"";return`${d}${$}: ${p}`});return(m,p)=>(i(),r("div",ei,[o.value?(i(),r("div",{key:0,class:H(["progress-bar",{"progress-bar-striped progress-bar-animated":u.value}]),style:je({width:"100%",backgroundColor:c.value}),title:f.value},null,14,ti)):(i(),r("div",si))]))}},oi=te(ni,[["__scopeId","data-v-63d222fe"]]),ai={class:"d-flex justify-content-between align-items-center gap-2"},ii={class:"d-flex gap-2"},li=["disabled"],ri={class:"mode-label"},ci=["disabled"],ui=["disabled"],di={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=xe(),a=h(()=>s.sessions.get(e.sessionId)),c=h(()=>a.value?.current_permission_mode||"default"),u={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},f=h(()=>u[c.value]||"ðŸ”’"),m=h(()=>c.value),p=["default","acceptEdits","plan"],d=async()=>{if(!a.value)return;if(c.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(y){console.error("Failed to cycle permission mode:",y)}return}const _=(p.indexOf(c.value)+1)%p.length,b=p[_];try{await s.setPermissionMode(e.sessionId,b)}catch(y){console.error("Failed to cycle permission mode:",y)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},v=()=>{o.showModal("manage-session",{session:a.value})},g=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(w,_)=>(i(),r("div",{class:H(["session-status-bar border-top p-2",ne(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ai,[t("div",ii,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!a.value},[ce(k(f.value)+" ",1),t("span",ri,k(m.value),1)],8,li),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!a.value},[..._[0]||(_[0]=[ce(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,ci),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:v,disabled:!a.value},[..._[1]||(_[1]=[ce(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,ui)]),t("div",null,[t("button",{class:H(["btn btn-sm",ne(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:g}," â¬‡ï¸ "+k(ne(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},fi=te(di,[["__scopeId","data-v-ed9a4d3c"]]),Zt=tt("task",()=>{const n=O(new Map),e=O(new Set);function s(l){const S=n.value.get(l);return S?Array.from(S.values()).filter(x=>x.status!=="deleted").sort((x,T)=>{const D=parseInt(x.id.replace(/\D/g,""))||0,A=parseInt(T.id.replace(/\D/g,""))||0;return D-A}):[]}function o(l){return s(l).find(x=>x.status==="in_progress")||null}function a(l){const S=s(l);return{total:S.length,completed:S.filter(x=>x.status==="completed").length,inProgress:S.filter(x=>x.status==="in_progress").length,pending:S.filter(x=>x.status==="pending").length}}function c(l){return e.value.has(l)}const u=h(()=>{const l=pe();return s(l.currentSessionId)}),f=h(()=>{const l=pe();return o(l.currentSessionId)}),m=h(()=>{const l=pe();return a(l.currentSessionId)}),p=h(()=>{const l=pe();return c(l.currentSessionId)});function d(l,S){n.value.has(l)||n.value.set(l,new Map),n.value.get(l).set(S.id,{id:S.id,subject:S.subject||"",description:S.description||"",status:S.status||"pending",activeForm:S.activeForm||null,owner:S.owner||null,blocks:S.blocks||[],blockedBy:S.blockedBy||[],metadata:S.metadata||{}}),e.value.add(l),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${S.id} for session ${l}`)}function $(l,S,x){const T=n.value.get(l);if(!T){console.warn(`No tasks found for session ${l}`);return}const D=T.get(S);if(!D){if(x.status==="deleted")return;d(l,{id:S,...x});return}x.subject!==void 0&&(D.subject=x.subject),x.description!==void 0&&(D.description=x.description),x.status!==void 0&&(D.status=x.status),x.activeForm!==void 0&&(D.activeForm=x.activeForm),x.owner!==void 0&&(D.owner=x.owner),x.metadata!==void 0&&(D.metadata={...D.metadata,...x.metadata}),x.addBlocks&&(D.blocks=[...new Set([...D.blocks,...x.addBlocks])]),x.addBlockedBy&&(D.blockedBy=[...new Set([...D.blockedBy,...x.addBlockedBy])]),x.status==="deleted"&&(T.delete(S),T.size===0&&(e.value.delete(l),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${S} for session ${l}`,x)}function v(l,S){return n.value.get(l)?.get(S)||null}function g(l){n.value.delete(l),e.value.delete(l),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${l}`)}function w(l,S){n.value.has(l)&&n.value.get(l).clear(),e.value.delete(l);const x=new Map;for(const T of S){if(T.metadata?.tool_uses)for(const D of T.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(D.name)&&x.set(D.id,{name:D.name,input:D.input});if(T.metadata?.tool_results)for(const D of T.metadata.tool_results){const A=x.get(D.tool_use_id);A&&(_(l,A.name,A.input,{error:D.is_error,content:D.content}),x.delete(D.tool_use_id))}}console.log(`Reconstructed ${n.value.get(l)?.size||0} tasks for session ${l}`)}function _(l,S,x,T){if(T?.error){console.log(`Skipping task update - tool ${S} returned error`);return}const D=b(T);if(D)switch(S){case"TaskCreate":{const A=y(D)||x?.id;A&&d(l,{id:A,subject:x?.subject||"",description:x?.description||"",status:"pending",activeForm:x?.activeForm||null,owner:x?.owner||null,blocks:[],blockedBy:[],metadata:x?.metadata||{}});break}case"TaskUpdate":{const A=x?.taskId;A&&$(l,A,{status:x?.status,subject:x?.subject,description:x?.description,activeForm:x?.activeForm,owner:x?.owner,metadata:x?.metadata,addBlocks:x?.addBlocks,addBlockedBy:x?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{x?.taskId;break}}}function b(l){return l?typeof l=="string"?l:l.content?typeof l.content=="string"?l.content:JSON.stringify(l.content):l.message?l.message:JSON.stringify(l):null}function y(l){if(!l)return null;const S=l.match(/[Tt]ask\s*#(\d+)/i);if(S)return S[1];const x=l.match(/#(\d+)/);return x?x[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:u,currentActiveTask:f,currentTaskStats:m,currentHasTasks:p,tasksForSession:s,activeTask:o,taskStats:a,hasTasks:c,getTask:v,createTask:d,updateTask:$,clearTasks:g,reconstructFromMessages:w,handleTaskToolResult:_}}),Pe=tt("message",()=>{const n=O(new Map),e=O(new Map),s=O(new Map),o=O(new Map),a=O(new Map),c=O(new Map),u=O(new Map),f=O(new Map),m=O(new Map),p=h(()=>{const I=pe();return n.value.get(I.currentSessionId)||[]}),d=h(()=>{const I=pe();return e.value.get(I.currentSessionId)||[]});async function $(I,L=null,K=0){try{const j=L||1e4,z=await ge.get(`/api/sessions/${I}/messages?limit=${j}&offset=${K}`),ee=z.messages||[],ue=z.total_count||ee.length,ie=z.has_more||!1;console.log(`Loaded ${ee.length} of ${ue} messages for session ${I}`);const ve=[];if(ee.forEach(he=>{if(he.type==="tool_call"){l(I,he);return}if(he.type==="system"&&he.metadata?.subtype==="client_launched"&&he.timestamp){const q=typeof he.timestamp=="number"?he.timestamp:new Date(he.timestamp).getTime()/1e3;f.value.set(I,q)}he.type==="system"&&(he.subtype==="init"||he.metadata?.subtype==="init")&&he.metadata?.init_data&&pe().storeInitData(I,he.metadata.init_data),ve.push(he)}),n.value.set(I,ve),ve.length>0){const he=ve[ve.length-1];he.timestamp&&u.value.set(I,he.timestamp)}n.value=new Map(n.value);try{Zt().reconstructFromMessages(I,ve)}catch(he){console.warn("Failed to reconstruct task state:",he)}return ie&&console.warn(`Warning: Only loaded ${ve.length} of ${ue} messages. Some messages may be missing.`),{messages:ve,totalCount:ue,hasMore:ie}}catch(j){throw console.error("Failed to load messages:",j),j}}function v(I,L){const K=a.value.get(I)||new Set;if(L.type==="assistant"&&L.metadata?.tool_uses&&L.metadata.tool_uses.forEach(j=>{K.add(j.id)}),L.type==="user"&&L.metadata?.tool_results&&L.metadata.tool_results.forEach(j=>{K.delete(j.tool_use_id);const z=c.value.get(I);z&&z.delete(j.tool_use_id)}),L.type==="system"&&L.metadata?.subtype==="client_launched"&&(K.forEach(j=>{N(I,j,"Session was restarted")}),K.clear(),L.timestamp)){const j=typeof L.timestamp=="number"?L.timestamp:new Date(L.timestamp).getTime()/1e3;f.value.set(I,j)}L.type==="system"&&L.metadata?.subtype==="interrupt"&&(K.forEach(j=>{N(I,j,"Session was interrupted")}),K.clear()),a.value.set(I,K)}function g(I,L){n.value.has(I)||n.value.set(I,[]);const K=n.value.get(I);if(L.id){const j=K.findIndex(z=>z.id===L.id);if(j!==-1){console.log(`Skipping duplicate message ${L.id} (already exists at index ${j})`);return}}K.push(L),L.timestamp&&u.value.set(I,L.timestamp),T(I,L),v(I,L),n.value=new Map(n.value)}function w(I,L){e.value.has(I)||e.value.set(I,[]),e.value.get(I).push(L),e.value=new Map(e.value)}function _(I,L,K){const j=e.value.get(I);if(j){const z=j.find(ee=>ee.id===L);z&&(Object.assign(z,K),e.value=new Map(e.value))}}function b(I,L){console.log("handlePermissionRequest received:",L);const K=L.metadata?.tool_name||L.tool_name,j=L.metadata?.input_params||L.input_params,z=L.metadata?.request_id||L.request_id,ee=L.metadata?.suggestions||L.suggestions||[];console.log("Extracted data:",{toolName:K,inputParams:j,requestId:z,suggestions:ee});const ue=x(K,j),ie=s.value.get(I)?.get(ue);ie?(o.value.set(z,ie),_(I,ie,{status:"permission_required",permissionRequestId:z,suggestions:ee}),console.log(`Permission required for tool ${ie}`,{suggestions:ee})):console.warn("No tool use ID found for permission request signature:",ue,{toolName:K,inputParams:j,availableSignatures:Array.from(s.value.keys())})}function y(I,L){const K=o.value.get(L.request_id);if(K){const j={permissionDecision:L.decision,appliedUpdates:L.applied_updates||[]};L.decision==="allow"?(j.status="executing",j.backendStatus="running"):(j.status="completed",j.backendStatus="denied",j.result={error:!0,message:L.reasoning||"Permission denied"},j.isExpanded=!1),L.updated_input&&(j.input=L.updated_input),_(I,K,j),console.log(`Permission ${L.decision} for tool ${K}`)}}function l(I,L){console.log("handleToolCall received:",L);const K=L.tool_use_id;if(!K){console.warn("Received tool_call without tool_use_id:",L);return}e.value.has(I)||e.value.set(I,[]);const j=e.value.get(I),z=j.findIndex(ie=>ie.id===K),ue={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[L.status]||L.status;if(z!==-1){const ie=j[z],ve=["completed","error"],he=["pending","executing","permission_required"];if(ve.includes(ie.status)&&he.includes(ue)){console.warn(`Ignoring status regression for tool ${K}: ${ie.status} â†’ ${ue}`);return}ie.status=ue,ie.backendStatus=L.status,L.permission&&(ie.suggestions=L.permission.suggestions||[],ie.permissionRequestId=L.request_id),L.permission_granted!==null&&L.permission_granted!==void 0&&(ie.permissionDecision=L.permission_granted?"allow":"deny"),L.result!==void 0&&(ie.result={error:L.status==="failed",content:L.result}),L.error&&(ie.result={error:!0,content:L.error}),L.status==="denied"&&(ie.result={error:!0,message:"Permission denied"},ie.isExpanded=!1),L.status==="interrupted"&&(N(I,K,"Session was interrupted"),ie.isExpanded=!1),(L.status==="completed"||L.status==="failed")&&(ie.isExpanded=!1),L.display&&(ie.backendState=L.display),console.log(`Updated tool call ${K} to status: ${ue} (backend: ${L.status})`)}else{const ie=x(L.name,L.input);s.value.has(I)||s.value.set(I,new Map),s.value.get(I).set(ie,K);const ve={id:K,name:L.name,input:L.input,signature:ie,status:ue,backendStatus:L.status,permissionRequestId:L.request_id,permissionDecision:L.permission_granted!==void 0?L.permission_granted?"allow":"deny":null,suggestions:L.permission?.suggestions||[],result:L.result?{error:L.status==="failed",content:L.result}:null,explanation:null,timestamp:L.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(L.status),backendState:L.display};L.error&&(ve.result={error:!0,content:L.error}),j.push(ve),console.log(`Created new tool call ${K} for ${L.name} with status: ${ue}`)}if(e.value=new Map(e.value),["completed","failed"].includes(L.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(L.name))try{Zt().handleTaskToolResult(I,L.name,L.input,{error:L.status==="failed",content:L.result})}catch(ie){console.warn("Failed to update task store:",ie)}}function S(I,L){const K=e.value.get(I);if(K){const j=K.find(z=>z.id===L);j&&(j.isExpanded=!j.isExpanded,e.value=new Map(e.value))}}function x(I,L){if(!I)return"unknown:{}";if(!L||typeof L!="object")return`${I}:{}`;const K=JSON.stringify(L,Object.keys(L).sort());return`${I}:${K}`}function T(I,L){const K=L.metadata?.display||L.display;if(!K)return;m.value.has(I)||m.value.set(I,new Map);const j=m.value.get(I);if(K.tool_states)for(const[z,ee]of Object.entries(K.tool_states)){j.set(z,ee);const ue=e.value.get(I);if(ue){const ie=ue.find(ve=>ve.id===z);if(ie){const ve={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};ie.status=ve[ee.state]||ee.state,ie.backendState=ee}}}if(K.orphaned_tools&&K.orphaned_tools.length>0){const z=c.value.get(I)||new Map;for(const ee of K.orphaned_tools)z.has(ee)||z.set(ee,{reason:"denied",message:"Session was interrupted"});c.value.set(I,z)}if(K.linked_permissions)for(const[z,ee]of Object.entries(K.linked_permissions))o.value.set(z,ee);K.tool_states&&Object.keys(K.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${I}:`,{toolStates:Object.keys(K.tool_states||{}).length,orphanedTools:(K.orphaned_tools||[]).length,linkedPermissions:Object.keys(K.linked_permissions||{}).length})}function D(I,L){return m.value.get(I)?.get(L)}function A(I){const L=m.value.get(I);return L&&L.size>0}function N(I,L,K){const j=c.value.get(I)||new Map;j.set(L,{reason:"denied",message:K}),c.value.set(I,j);const z=e.value.get(I);if(z){const ee=z.find(ue=>ue.id===L);ee&&ee.isExpanded&&(ee.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${L} as orphaned: ${K}`)}function C(I,L){const K=D(I,L);return K&&K.state==="orphaned"?!0:c.value.get(I)?.has(L)||!1}function M(I,L){const K=D(I,L);return K&&K.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:K}:c.value.get(I)?.get(L)}function W(I,L){const K=a.value.get(I);K&&K.size>0&&(K.forEach(j=>N(I,j,L)),K.clear())}function B(I){n.value.delete(I),e.value.delete(I),s.value.delete(I),n.value=new Map(n.value),e.value=new Map(e.value)}function F(I){return u.value.get(I)}async function V(I){const L=u.value.get(I);if(!L)return console.log(`No sync needed for session ${I} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${I} since ${L}`);const K=await ge.get(`/api/sessions/${I}/messages?limit=1000&offset=0`),j=K.messages||[],z=K.has_more||!1,ee=Q=>Q?typeof Q=="number"?Q*1e3:new Date(Q).getTime():0,ue=ee(L),ie=j.filter(Q=>Q.timestamp?ee(Q.timestamp)>ue:!1);if(ie.length===0)return console.log(`No missed messages for session ${I}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ie.length} missed messages for session ${I}`);const ve=n.value.get(I)||[],he=new Set(ve.map(Q=>Q.id).filter(Boolean)),q=ie.filter(Q=>!Q.id||!he.has(Q.id));console.log(`After deduplication: ${q.length} unique new messages`);const P=[],U=[];if(q.forEach(Q=>{Q.type==="tool_call"?P.push(Q):U.push(Q)}),P.forEach(Q=>{l(I,Q)}),U.length>0){const Q=U.sort((J,re)=>{const _e=ee(J.timestamp),we=ee(re.timestamp);return _e-we}),ae=n.value.get(I)||[],$e=ae.length>0?ee(ae[ae.length-1].timestamp):0;if(ee(Q[0].timestamp)>$e){const J=[...ae,...Q];n.value.set(I,J)}else{const J=[...ae,...Q].sort((re,_e)=>{const we=ee(re.timestamp),Ce=ee(_e.timestamp);return we-Ce});n.value.set(I,J)}}U.forEach(Q=>{v(I,Q),Q.type==="system"&&(Q.subtype==="init"||Q.metadata?.subtype==="init")&&Q.metadata?.init_data&&pe().storeInitData(I,Q.metadata.init_data)});const X=n.value.get(I);if(X&&X.length>0){const Q=X[X.length-1];Q.timestamp&&u.value.set(I,Q.timestamp)}return n.value=new Map(n.value),{syncedCount:q.length,hasMore:z}}catch(K){return console.error(`Failed to sync messages for session ${I}:`,K),{syncedCount:0,hasMore:!1,error:K.message}}}const G=pe();return fe(()=>Array.from(G.sessions.values()).map(L=>({id:L.session_id,state:L.state})),(I,L)=>{L&&I.forEach((K,j)=>{const z=L[j];if(!z||z.id!==K.id)return;const ee=["active","paused","starting"].includes(z.state),ue=!["active","paused","starting"].includes(K.state);ee&&ue&&W(K.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:rs(a),orphanedToolUses:rs(c),currentMessages:p,currentToolCalls:d,loadMessages:$,addMessage:g,addToolCall:w,updateToolCall:_,handleToolCall:l,handlePermissionRequest:b,handlePermissionResponse:y,toggleToolExpansion:S,clearMessages:B,markToolUseOrphaned:N,isToolUseOrphaned:C,getOrphanedInfo:M,clearOrphanedToolUses:W,getLastReceivedTimestamp:F,syncMessages:V,getBackendToolState:D,hasBackendDisplayMetadata:A,backendToolStates:rs(m),launchTimestampBySession:rs(f)}}),mi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Pe},Symbol.toStringTag,{value:"Module"}));function pi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function ss(n){return pi(n).toLocaleTimeString()}const vi={class:"msg-wrapper msg-user"},hi={class:"msg-meta"},_i={class:"msg-time"},gi={class:"msg-bubble msg-bubble-user"},bi=["innerHTML"],yi={key:0,class:"tool-results mt-2"},wi={class:"tool-results-header text-muted small mb-2"},ki={class:"d-flex align-items-start gap-2"},$i={class:"flex-grow-1"},Si={class:"text-muted"},xi={key:0,class:"text-danger small"},Ci={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ke.setOptions({breaks:!0,gfm:!0});const s=h(()=>ss(e.message.timestamp)),o=h(()=>{const f=e.message.content||"";let m=Ke.parse(f);return m=m.replace(/\n</g,"<"),m=m.replace(/\n+$/,""),Vt.sanitize(m)}),a=h(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=h(()=>e.message.metadata?.tool_results||[]);function u(f,m){return f?f.length<=m?f:f.substring(0,m)+"...":""}return(f,m)=>(i(),r("div",vi,[t("div",hi,[m[0]||(m[0]=t("span",{class:"msg-role"},"user",-1)),t("span",_i,k(s.value),1)]),t("div",gi,[t("div",{class:"msg-text",innerHTML:o.value},null,8,bi),a.value?(i(),r("div",yi,[t("div",wi," Tool Results ("+k(c.value.length)+") ",1),(i(!0),r(se,null,le(c.value,(p,d)=>(i(),r("div",{key:d,class:H(["tool-result-summary",p.is_error?"result-error":"result-success"])},[t("div",ki,[t("span",null,k(p.is_error?"âœ—":"âœ“"),1),t("div",$i,[t("small",Si,"Tool: "+k(p.tool_use_id),1),p.is_error?(i(),r("div",xi,k(u(p.content,200)),1)):E("",!0)])])],2))),128))])):E("",!0)])]))}},Ei=te(Ci,[["__scopeId","data-v-c5db10e0"]]),Ti={class:"thinking-block"},Ai=["aria-label"],Di={class:"text-muted ms-auto"},Mi={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Oi=["innerHTML"],Li={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=O(!1),o=h(()=>e.thinking?.length||0),a=h(()=>{const u=e.thinking||"",f=Ke.parse(u);return Vt.sanitize(f)});function c(){s.value=!s.value}return(u,f)=>(i(),r("div",Ti,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:c},[t("span",{"aria-label":s.value?"Collapse":"Expand"},k(s.value?"â–¾":"â–¸"),9,Ai),f[0]||(f[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Di,k(o.value)+" characters",1)]),s.value?(i(),r("div",Mi,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,Oi)])):E("",!0)]))}},Ni=te(Li,[["__scopeId","data-v-fda2352c"]]);function Mn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function Ii(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function On(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Pi(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=Ii(s.command),a=On(o,60);return`${e}: ${a}`}case"SlashCommand":return`SlashCommand: ${On(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=Mn(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",a=s.description||"Task",c=a.length>40?a.substring(0,40)+"...":a;return`Task: (${o}) ${c}`}case"Grep":case"Glob":{const o=s.pattern||"",a=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${a}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const a=s.query||"";return`WebSearch: ${a.length>40?a.substring(0,40)+"...":a}`}let o="";try{const a=s.url||"";a&&(o=new URL(a.startsWith("http")?a:`https://${a}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Mn(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const ji=["title"],Ri={class:"node-label"},Bi={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){Ba(g=>({b853f60e:m.value}));const s=n,o=Pe(),a=pe(),c=O(!1),u=h(()=>{const g=a.currentSessionId;return g?s.tool.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[s.tool.backendStatus]||s.tool.backendStatus:o.isToolUseOrphaned(g,s.tool.id)?"orphaned":s.tool.status:s.tool.status}),f=h(()=>s.tool.result?.error||s.tool.status==="error"||s.tool.permissionDecision==="deny"),m=h(()=>{switch(u.value){case"completed":return f.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}),p=h(()=>({"node-expanded":s.isExpanded,"node-running":u.value==="executing","node-permission":u.value==="permission_required"})),d=h(()=>({"dot-running":u.value==="executing","dot-permission":u.value==="permission_required","dot-error":u.value==="error"||u.value==="completed"&&f.value})),$=h(()=>{const g=Pi(s.tool),w={completed:f.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[u.value]||u.value;return`${g} [${w}]`}),v=h(()=>{const g=s.tool.name||"";if(g.startsWith("mcp__")){const w=g.lastIndexOf("__");if(w>4)return g.slice(w+2)}return g.replace(/Tool$/,"")});return e({statusColor:m,effectiveStatus:u}),(g,w)=>(i(),r("div",{class:H(["timeline-node",[p.value,{"node-compact":n.compact}]]),title:$.value,onClick:w[0]||(w[0]=ye(_=>g.$emit("click"),["stop"])),onMouseenter:w[1]||(w[1]=_=>c.value=!0),onMouseleave:w[2]||(w[2]=_=>c.value=!1)},[t("div",{class:H(["node-dot",d.value])},null,2),t("span",Ri,k(v.value),1)],42,ji))}},Fi=te(Bi,[["__scopeId","data-v-9c8e95b1"]]),Vi={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"},compact:{type:Boolean,default:!1}},setup(n){const e=n,s=h(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(o,a)=>(i(),r("div",{class:H(["timeline-segment",{"segment-compact":n.compact}]),style:je(s.value)},null,6))}},Wi=te(Vi,[["__scopeId","data-v-40110c30"]]),qe=tt("project",()=>{const n=O(new Map),e=O(null),s=h(()=>n.value.get(e.value)),o=h(()=>Array.from(n.value.values()).sort((y,l)=>y.order-l.order));async function a(){try{const y=await ge.get("/api/projects");return n.value.clear(),y.projects.forEach(l=>{n.value.set(l.project_id,l)}),console.log(`Loaded ${n.value.size} projects`),y.projects}catch(y){throw console.error("Failed to fetch projects:",y),y}}async function c(y,l){try{const x=(await ge.post("/api/projects",{name:y,working_directory:l})).project;return n.value.set(x.project_id,x),n.value=new Map(n.value),console.log(`Created project ${x.project_id}`),x}catch(S){throw console.error("Failed to create project:",S),S}}async function u(y,l){try{await ge.put(`/api/projects/${y}`,l),f(y,l),console.log(`Updated project ${y}`,l)}catch(S){throw console.error("Failed to update project:",S),S}}function f(y,l){const S=n.value.get(y);S&&(Object.assign(S,l),n.value=new Map(n.value))}async function m(y){try{await ge.delete(`/api/projects/${y}`),n.value.delete(y),n.value=new Map(n.value),e.value===y&&(e.value=null),console.log(`Deleted project ${y}`)}catch(l){throw console.error("Failed to delete project:",l),l}}async function p(y){try{const l=await ge.put(`/api/projects/${y}/toggle-expansion`),S=n.value.get(y);return S&&(S.is_expanded=l.is_expanded,n.value=new Map(n.value)),l.is_expanded}catch(l){throw console.error("Failed to toggle expansion:",l),l}}async function d(y){try{await ge.put("/api/projects/reorder",{project_ids:y}),y.forEach((l,S)=>{const x=n.value.get(l);x&&(x.order=S)}),n.value=new Map(n.value),console.log("Reordered projects",y)}catch(l){throw console.error("Failed to reorder projects:",l),l}}async function $(y,l){try{await ge.put(`/api/projects/${y}/sessions/reorder`,{session_ids:l});const S=n.value.get(y);S&&(S.session_ids=l,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${y}`,l)}catch(S){throw console.error("Failed to reorder sessions:",S),S}}function v(y,l){const S=n.value.get(y);if(!S||!S.session_ids||S.session_ids.length===0)return[{status:"none",flex:1}];const x=new Set,T=new Map;for(const M of S.session_ids){const W=l.getSession(M);if(W&&(T.set(M,W),W.child_minion_ids))for(const B of W.child_minion_ids)x.add(B)}const D=Array.from(T.values()).filter(M=>!x.has(M.session_id)).sort((M,W)=>(M.order||0)-(W.order||0));if(D.length===0&&T.size===0)return[{status:"none",flex:1}];function A(M){return M.state==="active"&&M.is_processing?"active":M.state==="active"?"idle":M.state==="paused"?"waiting":M.state==="error"?"error":"none"}function N(M,W){if(W.push({status:A(M),flex:1}),M.child_minion_ids)for(const B of M.child_minion_ids){const F=T.get(B);F&&N(F,W)}}const C=[];for(const M of D)N(M,C);return C.length>0?C:[{status:"none",flex:1}]}function g(y){return n.value.get(y)}function w(y){e.value=y}function _(){e.value=null}function b(y){if(!y)return"";const l=y.split(/[/\\]/).filter(S=>S);return l.length===0?"/":l.length===1?`/${l[0]}`:l.length===2?`/${l.join("/")}`:`.../${l.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:a,createProject:c,updateProject:u,updateProjectLocal:f,deleteProject:m,toggleExpansion:p,reorderProjects:d,reorderSessionsInProject:$,getProject:g,getStatusBarSegments:v,selectProject:w,clearProjectSelection:_,formatPath:b}}),Ln=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Is={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Qe=tt("resource",()=>{const n=O(new Map),e=O(!1),s=O(0),o=O(null),a=O(!1),c=O(new Map);function u(J){if(!J)return!1;if(J.is_image===!0||(J.mime_type||"").toLowerCase().startsWith("image/"))return!0;const _e=(J.format||"").toLowerCase();if(_e.startsWith("image/")||Ln.has("."+_e))return!0;const we=J.original_filename||J.original_name||"";if(we){const Ce="."+we.split(".").pop().toLowerCase();return Ln.has(Ce)}return!1}function f(J){if(!J||u(J))return!1;const re=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),_e=J.original_filename||J.original_name||"";if(_e){const Ce="."+_e.split(".").pop().toLowerCase();if(re.has(Ce))return!0}const we=(J.mime_type||J.format||"").toLowerCase();return!!(we.startsWith("text/")||we==="application/json"||we==="application/xml")}function m(J){if(u(J))return"ðŸ–¼ï¸";if(J.original_filename){const re="."+J.original_filename.split(".").pop().toLowerCase();return Is[re]||Is.default}return Is.default}function p(J){return J.original_filename?"."+J.original_filename.split(".").pop().toLowerCase():""}function d(J){const re=n.value.get(J);return re||[]}function $(J){return n.value.get(J)?.length||0}function v(J){return $(J)>0}function g(J){return d(J).filter(u)}function w(J){return g(J).length}function _(J){return w(J)>0}const b=h(()=>{const J=pe();return d(J.currentSessionId)}),y=h(()=>{const J=pe();return $(J.currentSessionId)}),l=h(()=>y.value>0),S=h(()=>b.value.filter(u)),x=h(()=>S.value.length),T=h(()=>x.value>0),D=h(()=>!e.value||!o.value?null:d(o.value)[s.value]||null),A=D,N=h(()=>o.value?$(o.value):0),C=N;async function M(J){if(J){a.value=!0;try{const _e=(await Xt(`/api/sessions/${J}/resources`)).resources||[];_e.sort((we,Ce)=>(we.timestamp||0)-(Ce.timestamp||0)),n.value.set(J,_e),n.value=new Map(n.value),console.log(`Loaded ${_e.length} resources for session ${J}`)}catch(re){console.error(`Failed to load resources for session ${J}:`,re),n.value.set(J,[]),n.value=new Map(n.value)}finally{a.value=!1}}}const W=M;function B(J,re){if(!J||!re)return;let _e=n.value.get(J);_e||(_e=[],n.value.set(J,_e));const we=_e.findIndex(Ce=>Ce.resource_id===re.resource_id);we>=0?_e[we]=re:_e.push(re),_e.sort((Ce,nt)=>(Ce.timestamp||0)-(nt.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${re.resource_id} to session ${J}`)}const F=B;function V(J,re){return`/api/sessions/${J}/resources/${re}`}const G=V;function I(J,re){return`/api/sessions/${J}/resources/${re}/download`}function L(J,re=0){o.value=J,s.value=Math.max(0,Math.min(re,$(J)-1)),e.value=!0}function K(){e.value=!1}function j(){if(!o.value)return;const J=$(o.value);J!==0&&(s.value=(s.value+1)%J)}const z=j;function ee(){if(!o.value)return;const J=$(o.value);J!==0&&(s.value=(s.value-1+J)%J)}const ue=ee;function ie(J){if(!o.value)return;const re=$(o.value);re!==0&&(s.value=Math.max(0,Math.min(J,re-1)))}const ve=ie;function he(J){n.value.delete(J),n.value=new Map(n.value),o.value===J&&K(),console.log(`Cleared resources for session ${J}`)}const q=he;async function P(J,re){if(!(!J||!re))try{await Mo(`/api/sessions/${J}/resources/${re}`),X(J,re)}catch(_e){console.error(`Failed to remove resource ${re}:`,_e)}}function U(J,re){X(J,re)}function X(J,re){const _e=n.value.get(J);if(!_e)return;const we=_e.findIndex(Ce=>Ce.resource_id===re);we!==-1&&(_e.splice(we,1),n.value=new Map(n.value),e.value&&o.value===J&&(_e.length===0?K():s.value>=_e.length&&(s.value=_e.length-1)),c.value.delete(re),c.value=new Map(c.value))}async function Q(J,re){if(!J||!re)return null;const _e=c.value.get(re);if(_e&&!_e.error)return _e.content;c.value.set(re,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const we=V(J,re),Ce=await fetch(we);if(!Ce.ok)throw new Error(`HTTP ${Ce.status}`);const nt=await Ce.text();return c.value.set(re,{content:nt,loading:!1,error:null}),c.value=new Map(c.value),nt}catch(we){return console.error(`Failed to fetch text content for resource ${re}:`,we),c.value.set(re,{content:null,loading:!1,error:we.message}),c.value=new Map(c.value),null}}function ae(J){return c.value.get(J)||null}function $e(J){if(J){const re=n.value.get(J);re&&(re.forEach(_e=>c.value.delete(_e.resource_id)),c.value=new Map(c.value))}else c.value=new Map}function st(J,re){const _e=n.value.get(J);return _e&&_e.find(we=>we.resource_id===re)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:a,textContentCache:c,currentResources:b,currentResourceCount:y,currentHasResources:l,currentFullViewResource:D,fullViewTotalResources:N,currentImages:S,currentImageCount:x,currentHasImages:T,currentFullViewImage:A,fullViewTotalImages:C,imagesBySession:n,resourcesForSession:d,resourceCount:$,hasResources:v,getResourceUrl:V,getDownloadUrl:I,isImageResource:u,isTextResource:f,getResourceIcon:m,getResourceExtension:p,getResourceById:st,getTextContent:ae,imagesForSession:g,imageCount:w,hasImages:_,getImageUrl:G,loadResources:M,addResource:B,removeResource:P,handleResourceRemoved:U,openFullView:L,closeFullView:K,nextResource:j,prevResource:ee,goToResource:ie,clearResources:he,fetchTextContent:Q,clearTextCache:$e,loadImages:W,addImage:F,nextImage:z,prevImage:ue,goToImage:ve,clearImages:q}}),Ui=Qe,Hi=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ui,useResourceStore:Qe},Symbol.toStringTag,{value:"Module"})),Lo=tt("queue",()=>{const n=O(new Map),e=O(new Map);function s(g){return n.value.get(g)||[]}function o(g){return s(g).filter(w=>w.status==="pending").length}function a(g){return e.value.get(g)||!1}async function c(g){try{const w=await ge.get(`/api/sessions/${g}/queue`);return n.value.set(g,w.items||[]),n.value=new Map(n.value),w.items}catch(w){return console.error("Failed to fetch queue:",w),[]}}async function u(g,w,_=null,b=null){try{const y={content:w};return _!==null&&(y.reset_session=_),b!==null&&(y.metadata=b),(await ge.post(`/api/sessions/${g}/queue-message`,y)).item}catch(y){throw console.error("Failed to enqueue message:",y),y}}async function f(g,w){try{return(await ge.delete(`/api/sessions/${g}/queue/${w}`)).item}catch(_){throw console.error("Failed to cancel queue item:",_),_}}async function m(g,w){try{return(await ge.post(`/api/sessions/${g}/queue/${w}/requeue`)).item}catch(_){throw console.error("Failed to requeue item:",_),_}}async function p(g){try{return(await ge.delete(`/api/sessions/${g}/queue`)).cancelled_count}catch(w){throw console.error("Failed to clear queue:",w),w}}async function d(g,w){try{const _=await ge.put(`/api/sessions/${g}/queue/pause`,{paused:w});return e.value.set(g,w),e.value=new Map(e.value),_}catch(_){throw console.error("Failed to pause/resume queue:",_),_}}function $(g,w){const _=w.action;w.item,w.pending_count,c(g),_==="paused"?(e.value.set(g,!0),e.value=new Map(e.value)):_==="resumed"&&(e.value.set(g,!1),e.value=new Map(e.value))}function v(g,w){e.value.set(g,w),e.value=new Map(e.value)}return{queuesBySession:n,pausedBySession:e,getItems:s,getPendingCount:o,isPaused:a,fetchQueue:c,enqueueMessage:u,cancelItem:f,requeueItem:m,clearQueue:p,pauseQueue:d,handleQueueUpdate:$,updatePauseState:v}}),rt=tt("websocket",()=>{const n=O(null),e=O(!1),s=O(0),o=10,a=O(null),c=O(!1),u=O(0),f=5,m=O(null);let p=null;const d=O(0),$=O(null),v=O(new Map),g=O(null),w=O(!1),_=O(0),b=5,y=O(null),l=1e4,S=1e3,x=O(Date.now()),T=O(Date.now()),D=O(Date.now());let A=null,N=null,C=null;const M=h(()=>e.value&&(c.value||!m.value)?"connected":e.value?"partial":"disconnected");function W(P){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${P}`}function B(P){const U={ui:{timer:()=>A,setTimer:X=>{A=X},lastPing:x,connected:e,name:"UI"},session:{timer:()=>N,setTimer:X=>{N=X},lastPing:T,connected:c,name:"Session"},legion:{timer:()=>C,setTimer:X=>{C=X},lastPing:D,connected:w,name:"Legion"}}[P];U.timer()&&clearInterval(U.timer()),U.setTimer(setInterval(()=>{if(!U.connected.value)return;const X=Date.now()-U.lastPing.value;if(X>l){console.warn(`âš ï¸ ${U.name} WebSocket heartbeat timeout (${X}ms since last ping) - forcing close to trigger reconnection`),U.connected.value=!1;const ae={ui:n,session:a,legion:g}[P];ae.value&&ae.value.readyState===WebSocket.OPEN&&ae.value.close()}},S)),console.log(`âœ… Started heartbeat monitor for ${U.name} WebSocket`)}function F(P){const U={ui:{get:()=>A,set:X=>{A=X}},session:{get:()=>N,set:X=>{N=X}},legion:{get:()=>C,set:X=>{C=X}}}[P];U.get()&&(clearInterval(U.get()),U.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${P} WebSocket`))}function V(){if(n.value)return;const P=W("/ws/ui");console.log(`Connecting to UI WebSocket: ${P}`),n.value=new WebSocket(P),n.value.onopen=()=>{e.value=!0,s.value=0,x.value=Date.now(),B("ui"),console.log("UI WebSocket connected")},n.value.onmessage=U=>{const X=JSON.parse(U.data);ue(X)},n.value.onclose=()=>{if(F("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const U=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${U}ms (attempt ${s.value})`),setTimeout(V,U)}},n.value.onerror=U=>{console.error("UI WebSocket error:",U)}}function G(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function I(P){d.value++;const U=d.value;if(console.log(`[Gen ${U}] Starting connection to session ${P}`),p&&(clearTimeout(p),p=null),await L(),d.value!==U){console.log(`[Gen ${U}] Connection cancelled (current generation: ${d.value})`);return}m.value=P,$.value=U;const X=W(`/ws/session/${P}`);console.log(`[Gen ${U}] Connecting to Session WebSocket: ${X}`),a.value=new WebSocket(X),a.value.onopen=async()=>{if($.value!==U){console.log(`[Gen ${U}] Ignoring onopen (stale connection, current: ${$.value})`),a.value.close();return}c.value=!0,u.value=0,T.value=Date.now(),B("session"),console.log(`[Gen ${U}] Session WebSocket connected for ${P}`);const Q=v.value.get(P);if(v.value.set(P,!0),Q){console.log(`[Gen ${U}] Reconnection detected, syncing missed messages...`);try{const $e=await Pe().syncMessages(P);$e.syncedCount>0?console.log(`[Gen ${U}] âœ… Synced ${$e.syncedCount} missed messages`):$e.error?console.warn(`[Gen ${U}] âš ï¸ Message sync failed: ${$e.error}`):console.log(`[Gen ${U}] No missed messages to sync`),$e.hasMore&&console.warn(`[Gen ${U}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ae){console.error(`[Gen ${U}] Error during message sync:`,ae)}}else console.log(`[Gen ${U}] Initial connection, no sync needed`)},a.value.onmessage=Q=>{if($.value!==U){console.log(`[Gen ${U}] Ignoring message (stale connection, current: ${$.value})`);return}const ae=JSON.parse(Q.data);ie(ae,P)},a.value.onclose=()=>{F("session"),c.value=!1,a.value=null,console.log(`[Gen ${U}] Session WebSocket closed for ${P}`);const Q=pe();if(Q.currentSessionId===P&&$.value===U&&u.value<f){u.value++;const ae=Math.min(2e3*u.value,3e4);console.log(`[Gen ${U}] Reconnecting Session WebSocket in ${ae}ms (attempt ${u.value})`),p=setTimeout(()=>{$.value===U&&Q.currentSessionId===P?(p=null,I(P)):console.log(`[Gen ${U}] Skipping reconnect (generation or session changed)`)},ae)}},a.value.onerror=Q=>{console.error(`[Gen ${U}] Session WebSocket error:`,Q)}}function L(){return new Promise(P=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),a.value){const U=m.value,X=()=>{a.value=null,c.value=!1,m.value=null,$.value=null,u.value=0,U&&v.value.delete(U),P()};if(a.value.readyState===WebSocket.CLOSED)X();else{const Q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),X()},2e3);a.value.addEventListener("close",()=>{clearTimeout(Q),X()},{once:!0}),a.value.close()}}else m.value=null,$.value=null,P()})}function K(P){a.value&&c.value?(a.value.send(JSON.stringify({type:"send_message",content:P})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function j(P,U,X=!1,Q=null,ae=null){if(a.value&&c.value){const $e={type:"permission_response",request_id:P,decision:U,apply_suggestions:X,timestamp:new Date().toISOString()};Q&&($e.clarification_message=Q),ae&&($e.selected_suggestions=ae),a.value.send(JSON.stringify($e)),console.log(`Sent permission ${U} for request ${P}`,{applySuggestions:X,clarification:Q,selectedSuggestions:ae})}}function z(P,U,X){if(a.value&&c.value){const Q={type:"permission_response",request_id:P,decision:U,updated_input:X,timestamp:new Date().toISOString()};a.value.send(JSON.stringify(Q)),console.log(`Sent permission ${U} with updated_input for request ${P}`,X)}}function ee(){a.value&&c.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ue(P){const U=pe(),X=qe();switch(P.type){case"sessions_list":P.sessions&&Array.isArray(P.sessions)&&P.sessions.forEach(Q=>{U.updateSession(Q.session_id,Q)});break;case"state_change":if(P.data&&P.data.session_id&&P.data.session){U.updateSession(P.data.session_id,P.data.session);const Q=P.data.session_id,ae=P.data.session.state;Q===U.currentSessionId&&ae==="active"&&!c.value&&(console.log(`[UI state_change] Session ${Q} became active, reconnecting session WebSocket`),u.value=0,I(Q))}break;case"project_updated":if(P.data&&P.data.project){const Q=P.data.project;X.updateProjectLocal(Q.project_id,Q),U.fetchSessions()}break;case"project_deleted":P.data&&P.data.project_id&&X.projects.delete(P.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":x.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",P.type)}}function ie(P,U){const X=pe();if(X.currentSessionId!==U){console.warn(`Ignoring message for session ${U} (current: ${X.currentSessionId})`);return}const Q=Pe();switch(P.type){case"message":const ae=P.data;if(!ae||!ae.type){console.warn("Received message event with invalid data:",P);break}if(ae.type==="tool_call"){Q.handleToolCall(U,ae);break}ae.type==="system"&&(ae.subtype==="init"||ae.metadata?.subtype==="init")&&ae.metadata?.init_data&&X.storeInitData(U,ae.metadata.init_data),Q.addMessage(U,ae);break;case"state_change":X.updateSession(U,P.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${U}`);break;case"ping":T.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":P.resource&&(Qe().addResource(U,P.resource),console.log(`Resource registered for session ${U}:`,P.resource.resource_id));break;case"resource_removed":P.resource_id&&(Qe().handleResourceRemoved(U,P.resource_id),console.log(`Resource removed for session ${U}:`,P.resource_id));break;case"image_registered":P.image&&(Qe().addResource(U,{...P.image,resource_id:P.image.image_id}),console.log(`Image registered (legacy) for session ${U}:`,P.image.image_id));break;case"queue_update":{Lo().handleQueueUpdate(U,P);break}default:console.warn("Unknown Session WebSocket message type:",P.type)}}function ve(P){he(),y.value=P;const U=W(`/ws/legion/${P}`);console.log(`Connecting to Legion WebSocket: ${U}`),g.value=new WebSocket(U),g.value.onopen=()=>{w.value=!0,_.value=0,D.value=Date.now(),B("legion"),console.log(`Legion WebSocket connected for ${P}`)},g.value.onmessage=X=>{const Q=JSON.parse(X.data);q(Q,P)},g.value.onclose=()=>{if(F("legion"),w.value=!1,g.value=null,console.log(`Legion WebSocket closed for ${P}`),y.value===P&&_.value<b){_.value++;const X=Math.min(2e3*_.value,3e4);setTimeout(()=>ve(P),X)}},g.value.onerror=X=>{console.error("Legion WebSocket error:",X)}}function he(){g.value&&(g.value.close(),g.value=null,w.value=!1,y.value=null)}function q(P,U){Ie(async()=>{const{useLegionStore:X}=await Promise.resolve().then(()=>Mp);return{useLegionStore:X}},void 0).then(({useLegionStore:X})=>{const Q=X();switch(P.type){case"comm":P.comm&&(Q.addComm(U,P.comm),console.log("Legion WebSocket: Received new comm",P.comm));break;case"minion_created":P.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",P.data),Ie(async()=>{const{useSessionStore:ae}=await Promise.resolve().then(()=>Dn);return{useSessionStore:ae}},void 0).then(({useSessionStore:ae})=>{ae().loadSessions()}));break;case"minion_updated":P.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",P.data),Ie(async()=>{const{useSessionStore:ae}=await Promise.resolve().then(()=>Dn);return{useSessionStore:ae}},void 0).then(({useSessionStore:ae})=>{ae().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${U}`);break;case"ping":D.value=Date.now(),g.value?.readyState===WebSocket.OPEN&&g.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",P.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:c,sessionRetryCount:u,legionConnected:w,legionRetryCount:_,currentLegionId:y,overallStatus:M,connectUI:V,disconnectUI:G,connectSession:I,disconnectSession:L,sendMessage:K,sendPermissionResponse:j,sendPermissionResponseWithInput:z,interruptSession:ee,connectLegion:ve,disconnectLegion:he}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:rt},Symbol.toStringTag,{value:"Module"})),zi={class:"base-tool-handler"},Ki={class:"tool-section"},Gi={class:"tool-parameters"},Yi={class:"tool-code"},Ji={key:0,class:"tool-section"},Qi={class:"tool-section-label"},Xi={class:"tool-code"},Zi={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=h(()=>{if(!o.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,f)=>(i(),r("div",zi,[t("div",Ki,[f[0]||(f[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Gi,[t("pre",Yi,k(s.value),1)])]),o.value?(i(),r("div",Ji,[t("div",Qi,k(a.value?"Error:":"Result:"),1),t("div",{class:H(["tool-result",{"tool-result-error":a.value}])},[t("pre",Xi,k(c.value),1)],2)])):E("",!0)]))}},el=te(Zi,[["__scopeId","data-v-1e69f57d"]]),tl={class:"read-tool-handler"},sl={class:"tool-section"},nl={class:"read-file-info"},ol={class:"file-icon"},al={class:"file-path"},il={key:0,class:"read-range"},ll={key:0,class:"tool-section"},rl={key:0,class:"tool-result tool-result-error"},cl={class:"tool-code"},ul={key:1,class:"image-preview"},dl={class:"content-header"},fl={class:"image-badge"},ml={class:"image-container"},pl=["src","alt"],vl={key:2,class:"file-content-preview"},hl={class:"content-header"},_l={class:"line-count-badge"},gl={key:0,class:"preview-note"},bl={class:"tool-code content-display"},yl={key:0,class:"more-indicator"},Ps=100,wl={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>{const y=s.value;return y.split("/").pop()||y}),a=h(()=>{const y=e.toolCall.input?.offset,l=e.toolCall.input?.limit;return y!==void 0||l!==void 0}),c=h(()=>{const y=e.toolCall.input?.offset;return y!==void 0?y+1:1}),u=h(()=>{const y=e.toolCall.input?.offset||0,l=e.toolCall.input?.limit;return l!==void 0?y+l:"âˆž"}),f=h(()=>{const y=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(y)}),m=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=h(()=>{if(!m.value||p.value)return null;const l=e.toolCall.result?.content;if(Array.isArray(l)){for(const S of l)if(S?.type==="image"&&S?.source?.type==="base64"&&S?.source?.data)return S.source.data}return null}),$=h(()=>{if(!d.value)return"";const y=s.value.toLowerCase();return y.endsWith(".png")?"image/png":y.endsWith(".jpg")||y.endsWith(".jpeg")?"image/jpeg":y.endsWith(".gif")?"image/gif":y.endsWith(".webp")?"image/webp":y.endsWith(".svg")?"image/svg+xml":y.endsWith(".bmp")?"image/bmp":y.endsWith(".ico")?"image/x-icon":"image/png"}),v=h(()=>{if(!m.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)}),g=h(()=>p.value||!v.value||d.value?[]:v.value.split(`
`)),w=h(()=>g.value.length),_=h(()=>w.value>Ps),b=h(()=>p.value||d.value?"":g.value.slice(0,Ps).join(`
`));return(y,l)=>(i(),r("div",tl,[t("div",sl,[t("div",nl,[t("span",ol,k(f.value?"ðŸ–¼ï¸":"ðŸ“„"),1),l[0]||(l[0]=t("strong",null,"Reading:",-1)),t("code",al,k(s.value),1),a.value?(i(),r("span",il,"Lines "+k(c.value)+"-"+k(u.value),1)):E("",!0)])]),m.value?(i(),r("div",ll,[p.value?(i(),r("div",rl,[t("pre",cl,k(v.value),1)])):d.value?(i(),r("div",ul,[t("div",dl,[l[1]||(l[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",fl,k($.value),1)]),t("div",ml,[t("img",{src:`data:${$.value};base64,${d.value}`,alt:o.value,class:"preview-image"},null,8,pl)])])):(i(),r("div",vl,[t("div",hl,[l[2]||(l[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",_l,k(w.value)+" lines",1),_.value?(i(),r("span",gl,"(showing first "+k(Ps)+")")):E("",!0)]),t("pre",bl,k(b.value),1),_.value?(i(),r("div",yl,"...")):E("",!0)]))])):E("",!0)]))}},kl=te(wl,[["__scopeId","data-v-29b774b1"]]),$l={class:"write-tool-handler"},Sl={class:"tool-section"},xl={class:"write-file-info mb-2"},Cl={class:"file-path"},El={class:"write-content-preview"},Tl={class:"content-header"},Al={class:"line-count-badge"},Dl={key:0,class:"preview-note"},Ml={class:"tool-code content-display"},Ol={key:0,class:"more-indicator"},Ll={key:0,class:"tool-section"},Nl={key:0,class:"tool-result tool-result-error"},Il={class:"tool-code"},Pl={key:1,class:"tool-result tool-result-success"},jl={class:"success-message"},js=100,Rl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.content||""),a=h(()=>o.value.split(`
`)),c=h(()=>a.value.length),u=h(()=>c.value>js),f=h(()=>a.value.slice(0,js).join(`
`)),m=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=h(()=>{if(!m.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,v)=>(i(),r("div",$l,[t("div",Sl,[t("div",xl,[v[0]||(v[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),v[1]||(v[1]=t("strong",null,"Writing:",-1)),t("code",Cl,k(s.value),1)]),t("div",El,[t("div",Tl,[v[2]||(v[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Al,k(c.value)+" lines",1),u.value?(i(),r("span",Dl,"(showing first "+k(js)+")")):E("",!0)]),t("pre",Ml,k(f.value),1),u.value?(i(),r("div",Ol,"...")):E("",!0)])]),m.value?(i(),r("div",Ll,[p.value?(i(),r("div",Nl,[v[3]||(v[3]=t("strong",null,"Error:",-1)),t("pre",Il,k(d.value),1)])):(i(),r("div",Pl,[t("div",jl,[v[4]||(v[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+k(c.value)+" lines written)",1)])]))])):E("",!0)]))}},Bl=te(Rl,[["__scopeId","data-v-ddc24a0f"]]),Fl={class:"bash-tool-handler"},Vl={class:"tool-section"},Wl={class:"bash-header"},Ul={class:"bash-header-content"},Hl={key:0,class:"bash-description"},ql={key:1,class:"bash-flags"},zl={class:"bash-command-section"},Kl={class:"bash-command-content"},Gl={key:0,class:"tool-section"},Yl={key:0,class:"bash-output"},Jl={key:1,class:"bash-output-empty"},Ql={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.command||""),o=h(()=>e.toolCall.input?.description||""),a=h(()=>e.toolCall.input?.timeout),c=h(()=>e.toolCall.input?.run_in_background||!1),u=h(()=>a.value||c.value),f=h(()=>{const v=[];return a.value&&v.push(`timeout: ${a.value}ms`),c.value&&v.push("background"),v.join(", ")}),m=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=h(()=>p.value?"tool-result-error":"tool-result-success"),$=h(()=>{if(!m.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,g)=>(i(),r("div",Fl,[t("div",Vl,[t("div",Wl,[g[1]||(g[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Ul,[o.value?(i(),r("div",Hl,[g[0]||(g[0]=t("strong",null,"Description:",-1)),ce(" "+k(o.value),1)])):E("",!0),u.value?(i(),r("div",ql,k(f.value),1)):E("",!0)])]),t("div",zl,[g[2]||(g[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Kl,k(s.value),1)])]),m.value?(i(),r("div",Gl,[t("div",{class:H(["tool-result",d.value])},[g[3]||(g[3]=t("strong",null,"Output:",-1)),$.value?(i(),r("pre",Yl,k($.value),1)):(i(),r("div",Jl,"No output"))],2)])):E("",!0)]))}},Xl=te(Ql,[["__scopeId","data-v-ab50fe73"]]),Zl={class:"todo-tool-handler"},er={class:"tool-section"},tr={class:"todo-header"},sr={class:"todo-summary"},nr={key:0,class:"todo-count todo-count-completed"},or={key:1,class:"todo-count todo-count-in-progress"},ar={key:2,class:"todo-count todo-count-pending"},ir={class:"todo-checklist"},lr={class:"todo-checkbox"},rr={class:"todo-content"},cr={key:0,class:"tool-section"},ur={key:0,class:"tool-result tool-result-error"},dr={class:"tool-code"},fr={key:1,class:"tool-result tool-result-success"},mr={class:"success-message"},pr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.todos||[]),o=h(()=>s.value.filter(d=>d.status==="completed").length),a=h(()=>s.value.filter(d=>d.status==="in_progress").length),c=h(()=>s.value.filter(d=>d.status==="pending").length);function u(d){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[d]||"â˜"}const f=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=h(()=>{if(!f.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,$)=>(i(),r("div",Zl,[t("div",er,[t("div",tr,[$[0]||($[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=t("strong",null,"Task List:",-1)),t("div",sr,[o.value>0?(i(),r("span",nr,k(o.value)+" completed ",1)):E("",!0),a.value>0?(i(),r("span",or,k(a.value)+" in progress ",1)):E("",!0),c.value>0?(i(),r("span",ar,k(c.value)+" pending ",1)):E("",!0)])]),t("div",ir,[(i(!0),r(se,null,le(s.value,(v,g)=>(i(),r("div",{key:g,class:H(["todo-item",`todo-${v.status}`])},[t("span",lr,k(u(v.status)),1),t("span",rr,k(v.content),1)],2))),128))])]),f.value?(i(),r("div",cr,[m.value?(i(),r("div",ur,[$[2]||($[2]=t("strong",null,"Error:",-1)),t("pre",dr,k(p.value),1)])):(i(),r("div",fr,[t("div",mr,[$[3]||($[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+k(s.value.length)+" tasks)",1)])]))])):E("",!0)]))}},vr=te(pr,[["__scopeId","data-v-bbe55ee7"]]),hr={class:"edit-tool-handler"},_r={class:"tool-section"},gr={class:"edit-file-info"},br={class:"file-path"},yr={key:0,class:"replace-all-badge"},wr={class:"edit-diff-container"},kr={class:"diff-header"},$r={class:"diff-stats"},Sr={class:"stat-removed"},xr={class:"stat-added"},Cr={class:"unified-diff"},Er={class:"diff-scroll-container"},Tr={class:"diff-marker"},Ar={class:"diff-content"},Dr={key:0,class:"tool-section"},Mr={key:0,class:"tool-result tool-result-error"},Or={class:"tool-code"},Lr={key:1,class:"tool-result tool-result-success"},Nr={class:"success-message"},Ir={key:0,class:"success-detail"},Pr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.old_string||""),a=h(()=>e.toolCall.input?.new_string||""),c=h(()=>e.toolCall.input?.replace_all||!1),u=h(()=>{const g=qa(s.value,o.value,a.value,"","",{context:3}).split(`
`),w=[];for(let _=4;_<g.length;_++){const b=g[_];b&&(b.startsWith("-")?w.push({type:"removed",content:b.substring(1)}):b.startsWith("+")?w.push({type:"added",content:b.substring(1)}):b.startsWith(" ")?w.push({type:"context",content:b.substring(1)}):b.startsWith("@@")&&w.push({type:"hunk",content:b}))}return w}),f=h(()=>u.value.filter(v=>v.type==="removed").length),m=h(()=>u.value.filter(v=>v.type==="added").length),p=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!p.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,g)=>(i(),r("div",hr,[t("div",_r,[t("div",gr,[g[0]||(g[0]=t("span",{class:"file-icon"},"âœï¸",-1)),g[1]||(g[1]=t("strong",null,"Editing:",-1)),t("code",br,k(s.value),1),c.value?(i(),r("span",yr,"Replace All")):E("",!0)]),t("div",wr,[t("div",kr,[g[2]||(g[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",$r,[t("span",Sr,"-"+k(f.value),1),t("span",xr,"+"+k(m.value),1)])]),t("div",Cr,[t("div",Er,[(i(!0),r(se,null,le(u.value,(w,_)=>(i(),r("div",{key:_,class:H(["diff-line",{"diff-line-removed":w.type==="removed","diff-line-added":w.type==="added","diff-line-context":w.type==="context","diff-line-hunk":w.type==="hunk"}])},[t("span",Tr,k(w.type==="removed"?"-":w.type==="added"?"+":w.type==="hunk"?"@":" "),1),t("span",Ar,k(w.content),1)],2))),128))])])])]),p.value?(i(),r("div",Dr,[d.value?(i(),r("div",Mr,[g[3]||(g[3]=t("strong",null,"Error:",-1)),t("pre",Or,k($.value),1)])):(i(),r("div",Lr,[t("div",Nr,[g[4]||(g[4]=t("span",{class:"success-icon"},"âœ…",-1)),g[5]||(g[5]=t("strong",null,"File edited successfully",-1)),c.value?(i(),r("span",Ir,"(all occurrences replaced)")):E("",!0)])]))])):E("",!0)]))}},jr=te(Pr,[["__scopeId","data-v-dd74055e"]]),Rr={class:"search-tool-handler"},Br={class:"tool-section"},Fr={class:"search-info"},Vr={class:"search-icon"},Wr={class:"search-pattern"},Ur={key:0,class:"search-path"},Hr={key:1,class:"search-filters"},qr={key:0,class:"filter-badge"},zr={key:1,class:"filter-badge"},Kr={key:2,class:"filter-badge"},Gr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Qr={key:1,class:"search-results"},Xr={class:"results-header"},Zr={class:"results-label"},ec={class:"results-count-badge"},tc={class:"results-content"},sc={class:"tool-code"},nc={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.name==="Grep"),o=h(()=>e.toolCall.input?.pattern||"Unknown"),a=h(()=>e.toolCall.input?.path||null),c=h(()=>e.toolCall.input?.type||null),u=h(()=>e.toolCall.input?.glob||null),f=h(()=>e.toolCall.input?.["-i"]||!1),m=h(()=>c.value||u.value||f.value),p=h(()=>s.value?"ðŸ”":"ðŸ“"),d=h(()=>s.value?"Searching content":"Finding files"),$=h(()=>s.value?"Matches":"Files found"),v=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),g=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!v.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)}),_=h(()=>!v.value||g.value||!w.value?0:w.value.split(`
`).filter(y=>y.trim()).length);return(b,y)=>(i(),r("div",Rr,[t("div",Br,[t("div",Fr,[t("span",Vr,k(p.value),1),t("strong",null,k(d.value)+":",1),t("code",Wr,k(o.value),1),a.value?(i(),r("span",Ur,"in "+k(a.value),1)):E("",!0),m.value?(i(),r("span",Hr,[c.value?(i(),r("span",qr,"type: "+k(c.value),1)):E("",!0),u.value?(i(),r("span",zr,"glob: "+k(u.value),1)):E("",!0),f.value?(i(),r("span",Kr,"case-insensitive")):E("",!0)])):E("",!0)])]),v.value?(i(),r("div",Gr,[g.value?(i(),r("div",Yr,[y[0]||(y[0]=t("strong",null,"Error:",-1)),t("pre",Jr,k(w.value),1)])):(i(),r("div",Qr,[t("div",Xr,[t("span",Zr,k($.value)+":",1),t("span",ec,k(_.value)+" "+k(_.value===1?"match":"matches"),1)]),t("div",tc,[t("pre",sc,k(w.value),1)])]))])):E("",!0)]))}},Nn=te(nc,[["__scopeId","data-v-0d272c39"]]),oc={class:"web-tool-handler"},ac={class:"tool-section"},ic={class:"web-info"},lc={class:"web-icon"},rc=["href"],cc={key:1,class:"web-query"},uc={key:0,class:"web-prompt-container"},dc={class:"prompt-content"},fc={key:1,class:"web-domains"},mc={class:"domains-label"},pc={key:0,class:"tool-section"},vc={key:0,class:"tool-result tool-result-error"},hc={class:"tool-code"},_c={key:1,class:"web-results"},gc={class:"results-header"},bc={class:"results-label"},yc={class:"results-content"},wc={class:"tool-code"},kc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.name==="WebFetch"),o=h(()=>e.toolCall.input?.url||null),a=h(()=>e.toolCall.input?.query||null),c=h(()=>e.toolCall.input?.prompt||null),u=h(()=>e.toolCall.input?.allowed_domains||[]),f=h(()=>e.toolCall.input?.blocked_domains||[]),m=h(()=>u.value.length>0?u.value:f.value.length>0?f.value:[]),p=h(()=>u.value.length>0?"Allowed domains":f.value.length>0?"Blocked domains":"Domains"),d=h(()=>s.value?"ðŸŒ":"ðŸ”Ž"),$=h(()=>s.value?"Fetching URL":"Searching web"),v=h(()=>s.value?"Fetched content":"Search results"),g=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=h(()=>{if(!g.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,y)=>(i(),r("div",oc,[t("div",ac,[t("div",ic,[t("span",lc,k(d.value),1),t("strong",null,k($.value)+":",1),o.value?(i(),r("a",{key:0,href:o.value,target:"_blank",class:"web-url"},k(o.value),9,rc)):a.value?(i(),r("code",cc,k(a.value),1)):E("",!0)]),c.value?(i(),r("div",uc,[y[0]||(y[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",dc,k(c.value),1)])):E("",!0),m.value.length>0?(i(),r("div",fc,[t("span",mc,k(p.value)+":",1),(i(!0),r(se,null,le(m.value,l=>(i(),r("span",{key:l,class:"domain-badge"},k(l),1))),128))])):E("",!0)]),g.value?(i(),r("div",pc,[w.value?(i(),r("div",vc,[y[1]||(y[1]=t("strong",null,"Error:",-1)),t("pre",hc,k(_.value),1)])):(i(),r("div",_c,[t("div",gc,[t("span",bc,k(v.value)+":",1)]),t("div",yc,[t("pre",wc,k(_.value),1)])]))])):E("",!0)]))}},In=te(kc,[["__scopeId","data-v-62b55b55"]]),$c={class:"task-tool-handler"},Sc={class:"tool-section"},xc={class:"task-header"},Cc={key:0,class:"agent-type-badge"},Ec={key:0,class:"task-description"},Tc={class:"description-content"},Ac={key:1,class:"task-prompt-container"},Dc={class:"prompt-header"},Mc={class:"prompt-length"},Oc={class:"prompt-code"},Lc={key:0,class:"tool-section"},Nc={key:0,class:"tool-result tool-result-error"},Ic={class:"tool-code"},Pc={key:1,class:"agent-output"},jc={class:"output-header"},Rc={key:0,class:"output-count-badge"},Bc={class:"output-content"},Fc={class:"tool-code"},Vc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.description||null),o=h(()=>e.toolCall.input?.prompt||null),a=h(()=>e.toolCall.input?.subagent_type||null),c=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=h(()=>{if(!c.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),m=h(()=>f.value?f.value.split(`
`).length:0);return(p,d)=>(i(),r("div",$c,[t("div",Sc,[t("div",xc,[d[0]||(d[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),d[1]||(d[1]=t("strong",null,"Agent Task:",-1)),a.value?(i(),r("span",Cc,k(a.value),1)):E("",!0)]),s.value?(i(),r("div",Ec,[d[2]||(d[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Tc,k(s.value),1)])):E("",!0),o.value?(i(),r("div",Ac,[t("div",Dc,[d[3]||(d[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Mc,k(o.value.length)+" characters",1)]),t("pre",Oc,k(o.value),1)])):E("",!0)]),c.value?(i(),r("div",Lc,[u.value?(i(),r("div",Nc,[d[4]||(d[4]=t("strong",null,"Error:",-1)),t("pre",Ic,k(f.value),1)])):(i(),r("div",Pc,[t("div",jc,[d[5]||(d[5]=t("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(i(),r("span",Rc,k(m.value)+" lines",1)):E("",!0)]),t("div",Bc,[t("pre",Fc,k(f.value),1)])]))])):E("",!0)]))}},Wc=te(Vc,[["__scopeId","data-v-c520c244"]]),Uc={class:"task-create-tool-handler"},Hc={class:"tool-section"},qc={class:"task-details p-2"},zc={key:0,class:"task-field mb-2"},Kc={class:"field-value subject-value"},Gc={key:1,class:"task-field mb-2"},Yc={class:"field-value description-value"},Jc={key:2,class:"task-field"},Qc={class:"field-value active-form-value"},Xc={key:0,class:"tool-section mt-2"},Zc={key:0,class:"tool-result tool-result-error"},eu={class:"tool-code"},tu={key:1,class:"tool-result tool-result-success"},su={class:"result-text"},nu={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.subject||null),o=h(()=>e.toolCall.input?.description||null),a=h(()=>e.toolCall.input?.activeForm||null),c=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=h(()=>{if(!c.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,p)=>(i(),r("div",Uc,[t("div",Hc,[p[3]||(p[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",qc,[s.value?(i(),r("div",zc,[p[0]||(p[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Kc,k(s.value),1)])):E("",!0),o.value?(i(),r("div",Gc,[p[1]||(p[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Yc,k(o.value),1)])):E("",!0),a.value?(i(),r("div",Jc,[p[2]||(p[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Qc,k(a.value),1)])):E("",!0)])]),c.value?(i(),r("div",Xc,[u.value?(i(),r("div",Zc,[p[4]||(p[4]=t("strong",null,"Error:",-1)),t("pre",eu,k(f.value),1)])):(i(),r("div",tu,[p[5]||(p[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",su,k(f.value),1)]))])):E("",!0)]))}},ou=te(nu,[["__scopeId","data-v-474dd444"]]),au={class:"task-update-tool-handler"},iu={class:"tool-section"},lu={class:"task-header"},ru={key:0,class:"task-id-badge"},cu={class:"task-details p-2"},uu={key:0,class:"task-field mb-2"},du={key:1,class:"task-field mb-2"},fu={class:"field-value"},mu={key:2,class:"task-field mb-2"},pu={class:"field-value description-value"},vu={key:3,class:"task-field mb-2"},hu={class:"field-value active-form-value"},_u={key:4,class:"task-field mb-2"},gu={class:"field-value"},bu={key:5,class:"task-field mb-2"},yu={class:"field-value"},wu={key:6,class:"task-field"},ku={class:"field-value"},$u={key:0,class:"tool-section mt-2"},Su={key:0,class:"tool-result tool-result-error"},xu={class:"tool-code"},Cu={key:1,class:"tool-result tool-result-success"},Eu={class:"result-text"},Tu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.taskId||null),o=h(()=>e.toolCall.input?.status||null),a=h(()=>e.toolCall.input?.subject||null),c=h(()=>e.toolCall.input?.description||null),u=h(()=>e.toolCall.input?.activeForm||null),f=h(()=>e.toolCall.input?.owner||null),m=h(()=>e.toolCall.input?.addBlockedBy||[]),p=h(()=>e.toolCall.input?.addBlocks||[]),d=h(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),$=h(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),v=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),g=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!v.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,b)=>(i(),r("div",au,[t("div",iu,[t("div",lu,[b[0]||(b[0]=t("span",{class:"task-icon"},"âœï¸",-1)),b[1]||(b[1]=t("strong",null,"Update Task",-1)),s.value?(i(),r("span",ru,"#"+k(s.value),1)):E("",!0)]),t("div",cu,[o.value?(i(),r("div",uu,[b[2]||(b[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:H(["field-value status-value",$.value])},k(d.value)+" "+k(o.value),3)])):E("",!0),a.value?(i(),r("div",du,[b[3]||(b[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",fu,k(a.value),1)])):E("",!0),c.value?(i(),r("div",mu,[b[4]||(b[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",pu,k(c.value),1)])):E("",!0),u.value?(i(),r("div",vu,[b[5]||(b[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",hu,k(u.value),1)])):E("",!0),f.value?(i(),r("div",_u,[b[6]||(b[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",gu,k(f.value),1)])):E("",!0),m.value?.length?(i(),r("div",bu,[b[7]||(b[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",yu,[(i(!0),r(se,null,le(m.value,y=>(i(),r("span",{key:y,class:"badge bg-warning text-dark me-1"},"#"+k(y),1))),128))])])):E("",!0),p.value?.length?(i(),r("div",wu,[b[8]||(b[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",ku,[(i(!0),r(se,null,le(p.value,y=>(i(),r("span",{key:y,class:"badge bg-info text-dark me-1"},"#"+k(y),1))),128))])])):E("",!0)])]),v.value?(i(),r("div",$u,[g.value?(i(),r("div",Su,[b[9]||(b[9]=t("strong",null,"Error:",-1)),t("pre",xu,k(w.value),1)])):(i(),r("div",Cu,[b[10]||(b[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Eu,k(w.value),1)]))])):E("",!0)]))}},Au=te(Tu,[["__scopeId","data-v-35582330"]]),Du={class:"task-list-tool-handler"},Mu={key:0,class:"tool-section"},Ou={key:0,class:"tool-result tool-result-error"},Lu={class:"tool-code"},Nu={key:1,class:"task-list-result"},Iu={key:0,class:"parsed-tasks"},Pu={class:"status-icon"},ju={class:"task-id text-muted"},Ru={class:"task-subject flex-grow-1"},Bu={key:0,class:"task-owner badge bg-secondary"},Fu={key:1,class:"raw-result p-2"},Vu={class:"tool-code"},Wu={key:1,class:"tool-section"},Uu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=h(()=>{if(!s.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=h(()=>{if(!a.value)return[];const f=[],p=a.value.split(`
`);for(const d of p){const $=d.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if($){const v=$[2].toLowerCase();f.push({id:$[1],status:v,subject:$[3].trim(),owner:null,statusIcon:u(v)})}}return f});function u(f){switch(f){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(f,m)=>(i(),r("div",Du,[m[2]||(m[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(i(),r("div",Mu,[o.value?(i(),r("div",Ou,[m[0]||(m[0]=t("strong",null,"Error:",-1)),t("pre",Lu,k(a.value),1)])):(i(),r("div",Nu,[c.value.length>0?(i(),r("div",Iu,[(i(!0),r(se,null,le(c.value,(p,d)=>(i(),r("div",{key:d,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",Pu,k(p.statusIcon),1),t("span",ju,"#"+k(p.id),1),t("span",Ru,k(p.subject),1),p.owner?(i(),r("span",Bu,k(p.owner),1)):E("",!0)]))),128))])):(i(),r("div",Fu,[t("pre",Vu,k(a.value),1)]))]))])):n.toolCall.status==="completed"?(i(),r("div",Wu,[...m[1]||(m[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):E("",!0)]))}},Hu=te(Uu,[["__scopeId","data-v-4e79ba4b"]]),qu={class:"task-get-tool-handler"},zu={class:"tool-section"},Ku={class:"task-header"},Gu={key:0,class:"task-id-badge"},Yu={key:0,class:"tool-section"},Ju={key:0,class:"tool-result tool-result-error"},Qu={class:"tool-code"},Xu={key:1,class:"task-details-result p-2"},Zu={key:0,class:"parsed-task"},ed={class:"task-field mb-2"},td={class:"field-value subject-value"},sd={key:0,class:"task-field mb-2"},nd={key:1,class:"task-field mb-2"},od={class:"field-value description-value"},ad={key:2,class:"task-field mb-2"},id={class:"field-value"},ld={key:3,class:"task-field mb-2"},rd={class:"field-value"},cd={key:4,class:"task-field"},ud={class:"field-value"},dd={key:1,class:"raw-result"},fd={class:"tool-code"},md={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.taskId||null),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=h(()=>{if(!o.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),u=h(()=>{if(!c.value)return null;const p=c.value;try{const v=JSON.parse(p);if(v&&typeof v=="object")return{subject:v.subject||v.title||"",status:v.status||"",description:v.description||"",owner:v.owner||"",blockedBy:v.blockedBy||[],blocks:v.blocks||[]}}catch{}const d=p.split(`
`),$={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const v of d){const g=v.match(/^Subject:\s*(.+)$/i);g&&($.subject=g[1].trim());const w=v.match(/^Status:\s*(.+)$/i);w&&($.status=w[1].trim());const _=v.match(/^Description:\s*(.+)$/i);_&&($.description=_[1].trim());const b=v.match(/^Owner:\s*(.+)$/i);b&&($.owner=b[1].trim())}return $.subject?$:null}),f=h(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=h(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,d)=>(i(),r("div",qu,[t("div",zu,[t("div",Ku,[d[0]||(d[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),d[1]||(d[1]=t("strong",null,"Get Task",-1)),s.value?(i(),r("span",Gu,"#"+k(s.value),1)):E("",!0)])]),o.value?(i(),r("div",Yu,[a.value?(i(),r("div",Ju,[d[2]||(d[2]=t("strong",null,"Error:",-1)),t("pre",Qu,k(c.value),1)])):(i(),r("div",Xu,[u.value?(i(),r("div",Zu,[t("div",ed,[d[3]||(d[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",td,k(u.value.subject),1)]),u.value.status?(i(),r("div",sd,[d[4]||(d[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:H(["field-value",m.value])},k(f.value)+" "+k(u.value.status),3)])):E("",!0),u.value.description?(i(),r("div",nd,[d[5]||(d[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",od,k(u.value.description),1)])):E("",!0),u.value.owner?(i(),r("div",ad,[d[6]||(d[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",id,k(u.value.owner),1)])):E("",!0),u.value.blockedBy?.length?(i(),r("div",ld,[d[7]||(d[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",rd,[(i(!0),r(se,null,le(u.value.blockedBy,$=>(i(),r("span",{key:$,class:"badge bg-warning text-dark me-1"},"#"+k($),1))),128))])])):E("",!0),u.value.blocks?.length?(i(),r("div",cd,[d[8]||(d[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",ud,[(i(!0),r(se,null,le(u.value.blocks,$=>(i(),r("span",{key:$,class:"badge bg-info text-dark me-1"},"#"+k($),1))),128))])])):E("",!0)])):(i(),r("div",dd,[t("pre",fd,k(c.value),1)]))]))])):E("",!0)]))}},pd=te(md,[["__scopeId","data-v-a80d14da"]]),vd={class:"notebook-edit-tool-handler"},hd={class:"tool-section"},_d={class:"notebook-info"},gd={class:"file-path"},bd={class:"cell-info mt-2"},yd={class:"info-row"},wd={class:"info-row"},kd={key:0,class:"info-row"},$d={class:"badge bg-info"},Sd={key:0,class:"source-preview mt-3"},xd={class:"preview-header"},Cd={class:"preview-stats"},Ed={class:"source-code"},Td={key:0,class:"tool-section"},Ad={key:0},Dd={key:1,class:"text-danger"},Md={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.notebook_path||"Unknown"),o=h(()=>e.toolCall.input?.cell_id),a=h(()=>e.toolCall.input?.cell_type||"code"),c=h(()=>e.toolCall.input?.edit_mode||"replace"),u=h(()=>e.toolCall.input?.new_source||""),f=h(()=>u.value.split(`
`).length),m=h(()=>a.value==="code"?"bg-primary":"bg-secondary"),p=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=c.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,v)=>(i(),r("div",vd,[t("div",hd,[t("div",_d,[v[0]||(v[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),v[1]||(v[1]=t("strong",null,"Notebook:",-1)),t("code",gd,k(s.value),1)]),t("div",bd,[t("div",yd,[v[2]||(v[2]=t("strong",null,"Cell ID:",-1)),t("code",null,k(o.value||"N/A"),1)]),t("div",wd,[v[3]||(v[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:H(["badge",m.value])},k(a.value),3)]),c.value?(i(),r("div",kd,[v[4]||(v[4]=t("strong",null,"Edit Mode:",-1)),t("span",$d,k(c.value),1)])):E("",!0)]),u.value?(i(),r("div",Sd,[t("div",xd,[v[5]||(v[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",Cd,k(f.value)+" lines",1)]),t("pre",Ed,[t("code",null,k(u.value),1)])])):E("",!0)]),n.toolCall.result?(i(),r("div",Td,[v[6]||(v[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:H(["tool-result",p.value])},[n.toolCall.result.success!==!1?(i(),r("div",Ad," âœ… "+k(d.value),1)):(i(),r("div",Dd," â— "+k(n.toolCall.result.error||"Operation failed"),1))],2)])):E("",!0)]))}},Od=te(Md,[["__scopeId","data-v-c81a9bcf"]]),Ld={class:"shell-tool-handler"},Nd={class:"tool-section"},Id={class:"shell-info"},Pd={class:"shell-icon"},jd={key:0,class:"shell-id"},Rd={key:0,class:"filter-info mt-2"},Bd={class:"filter-pattern"},Fd={key:0,class:"tool-section"},Vd={class:"result-header mb-2"},Wd={key:0,class:"mb-2"},Ud={class:"shell-output"},Hd={key:1,class:"mb-2"},qd={class:"shell-output shell-output-error"},zd={key:0},Kd={key:1,class:"text-danger"},Gd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=h(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=h(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),c=h(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),u=h(()=>e.toolCall.input?.filter);function f(g,w){if(!g)return null;const _=new RegExp(`<${w}>([\\s\\S]*?)<\\/${w}>`,"i"),b=g.match(_);return b?b[1].trim():null}const m=h(()=>{const g=e.toolCall.result;if(!g)return null;let w=g;if(g.content&&(w=g.content),typeof w=="string")return{status:f(w,"status"),stdout:f(w,"stdout"),stderr:f(w,"stderr"),exit_code:f(w,"exit_code")};if(Array.isArray(w)){const _=w.find(b=>b.type==="text")?.text||"";return{status:f(_,"status"),stdout:f(_,"stdout"),stderr:f(_,"stderr"),exit_code:f(_,"exit_code")}}return{status:g.status||w.status,stdout:g.stdout||g.output||w.stdout||w.output,stderr:g.stderr||w.stderr,exit_code:g.exit_code||w.exit_code}}),p=h(()=>m.value?.status),d=h(()=>{const g=p.value;return g==="running"?"bg-success":g==="completed"?"bg-secondary":g==="killed"||g==="terminated"?"bg-danger":"bg-info"}),$=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),v=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const g=m.value;if(g?.status==="running"&&!g.stdout&&!g.stderr)return"No new output since last check";if(g?.status==="failed")return`Shell failed (exit code ${g.exit_code||"unknown"})`}return"Operation completed"});return(g,w)=>(i(),r("div",Ld,[t("div",Nd,[t("div",Id,[t("span",Pd,k(s.value),1),t("strong",null,k(o.value)+":",1),c.value?(i(),r("code",jd,"Shell "+k(c.value),1)):E("",!0)]),n.toolCall.name==="BashOutput"&&u.value?(i(),r("div",Rd,[w[0]||(w[0]=t("strong",null,"Filter:",-1)),t("code",Bd,k(u.value),1)])):E("",!0)]),n.toolCall.result?(i(),r("div",Fd,[t("div",Vd,[t("strong",null,k(a.value)+":",1),p.value?(i(),r("span",{key:0,class:H(["badge",d.value])},k(p.value),3)):E("",!0)]),m.value?.stdout?(i(),r("div",Wd,[w[1]||(w[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Ud,[t("pre",null,[t("code",null,k(m.value.stdout),1)])])])):E("",!0),m.value?.stderr?(i(),r("div",Hd,[w[2]||(w[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",qd,[t("pre",null,[t("code",null,k(m.value.stderr),1)])])])):E("",!0),!m.value?.stdout&&!m.value?.stderr?(i(),r("div",{key:2,class:H(["tool-result",$.value])},[n.toolCall.result.success!==!1?(i(),r("div",zd," âœ… "+k(v.value),1)):(i(),r("div",Kd," â— "+k(n.toolCall.result.error||"Operation failed"),1))],2)):E("",!0)])):E("",!0)]))}},Pn=te(Gd,[["__scopeId","data-v-86def281"]]),Yd={class:"skill-tool-handler"},Jd={key:0,class:"tool-section"},Qd={class:"d-flex align-items-center gap-2"},Xd={class:"text-muted small"},Zd={key:0,class:"skill-content-body"},ef={class:"skill-content-text"},tf={key:1,class:"tool-section mt-3"},sf={class:"tool-result tool-result-error"},nf={class:"tool-code"},of={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=pe(),a=O(!1);function c(){a.value=!a.value}const u=h(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const g=s.messagesBySession.get(v)||[],w=g.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(l=>l.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let _=null,b=null;for(let y=w+1;y<Math.min(w+3,g.length);y++){const l=g[y];if(l.type!=="user")continue;const S=l.content||"";S.includes("<command-message>")&&S.includes("skill is running")?_=l:S.startsWith("Base directory for this skill:")&&(b=l)}return{running:_,content:b}}),f=h(()=>{const v=u.value.content;if(!v)return"";const g=v.content||"",w=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return g.replace(w,"").trim()}),m=h(()=>f.value.length>0),p=h(()=>f.value?f.value.split(`
`).length:0),d=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!d.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,g)=>(i(),r("div",Yd,[m.value?(i(),r("div",Jd,[t("div",{class:"skill-content-header",onClick:c},[t("div",Qd,[t("i",{class:H(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),g[0]||(g[0]=t("strong",null,"Skill Content",-1)),t("span",Xd,"("+k(p.value)+" lines)",1)])]),a.value?(i(),r("div",Zd,[t("pre",ef,k(f.value),1)])):E("",!0)])):E("",!0),d.value?(i(),r("div",tf,[g[1]||(g[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",sf,[t("pre",nf,k($.value),1)])])):E("",!0)]))}},af=te(of,[["__scopeId","data-v-0a48ca0f"]]),lf={class:"slashcommand-tool-handler"},rf={key:0,class:"tool-section"},cf={class:"d-flex align-items-center gap-2"},uf=["aria-label"],df={class:"text-muted small"},ff={key:0,class:"command-content-body"},mf={class:"command-content-text"},pf={key:1,class:"tool-section mt-3"},vf={class:"tool-result tool-result-error"},hf={class:"tool-code"},_f={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=pe(),a=O(!1);function c(){a.value=!a.value}const u=h(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const g=s.messagesBySession.get(v)||[],w=g.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(l=>l.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let _=null,b=null;for(let y=w+1;y<Math.min(w+3,g.length);y++){const l=g[y];if(l.type!=="user")continue;const S=l.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?_=l:S.includes("ARGUMENTS:")&&(b=l)}return{running:_,content:b}}),f=h(()=>{const v=u.value.content;if(!v)return"";const g=v.content||"",w=/\nARGUMENTS:.*$/s;return g.replace(w,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=h(()=>f.value.length>0),p=h(()=>f.value?f.value.split(`
`).length:0),d=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!d.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,g)=>(i(),r("div",lf,[m.value?(i(),r("div",rf,[t("div",{class:"command-content-header",onClick:c},[t("div",cf,[t("span",{"aria-label":a.value?"Collapse":"Expand"},k(a.value?"â–¾":"â–¸"),9,uf),g[0]||(g[0]=t("strong",null,"Command Content",-1)),t("span",df,"("+k(p.value)+" lines)",1)])]),a.value?(i(),r("div",ff,[t("pre",mf,k(f.value),1)])):E("",!0)])):E("",!0),d.value?(i(),r("div",pf,[g[1]||(g[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",vf,[t("pre",hf,k($.value),1)])])):E("",!0)]))}},gf=te(_f,[["__scopeId","data-v-15991acf"]]),bf={class:"exit-plan-mode-tool-handler"},yf={class:"tool-section"},wf={key:0,class:"plan-content mt-2"},kf={class:"plan-text"},$f={key:0,class:"tool-section"},Sf={key:0},xf={key:1,class:"text-danger"},Cf={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>e.toolCall.input?.plan),o=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,c)=>(i(),r("div",bf,[t("div",yf,[c[1]||(c[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(i(),r("div",wf,[c[0]||(c[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",kf,k(s.value),1)])):E("",!0)]),n.toolCall.result?(i(),r("div",$f,[c[2]||(c[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:H(["tool-result",o.value])},[n.toolCall.result.success!==!1?(i(),r("div",Sf," âœ… Permission mode reverted to default ")):(i(),r("div",xf," â— "+k(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):E("",!0)]))}},Ef=te(Cf,[["__scopeId","data-v-e2e3c781"]]),Tf={class:"ask-user-question-handler"},Af={key:0,class:"answers-summary"},Df={class:"answer-question text-muted small"},Mf={class:"answer-value fw-medium"},Of={key:1,class:"text-muted small"},Lf={key:0,class:"questions-container"},Nf={class:"question-header d-flex align-items-center gap-2 mb-2"},If={key:0,class:"badge bg-secondary"},Pf={class:"question-text fw-medium"},jf={class:"options-list"},Rf=["id","checked","disabled","onChange"],Bf=["id","name","checked","disabled","onChange"],Ff=["for"],Vf={class:"option-label"},Wf={key:0,class:"option-description text-muted d-block small"},Uf={class:"option-item form-check other-option"},Hf=["id","checked","disabled","onChange"],qf=["id","name","checked","disabled","onChange"],zf=["for"],Kf={key:2,class:"other-input mt-2"},Gf=["onUpdate:modelValue","disabled","onInput"],Yf={key:1,class:"alert alert-info mb-0"},Jf={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=h(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),u=h(()=>{if(!c.value)return{};const x=o.toolCall.result;if(x?.content){if(typeof x.content=="object"&&x.content.answers)return x.content.answers;if(typeof x.content=="string")try{const D=JSON.parse(x.content);if(D.answers)return D.answers}catch{}}const T=o.toolCall.input||{};return T.answers?T.answers:{}}),f=h(()=>Object.keys(u.value).length>0),m=h(()=>(o.toolCall.input||{}).questions||[]),p=O({}),d=O({});fe(m,x=>{x.forEach((T,D)=>{D in p.value||(p.value[D]=T.multiSelect?[]:null),D in d.value||(d.value[D]="")})},{immediate:!0});function $(x,T){const D=p.value[x];return Array.isArray(D)?D.includes(T):D===T}function v(x){const T=p.value[x];return Array.isArray(T)?T.includes("__OTHER__"):T==="__OTHER__"}function g(x,T){p.value[x]=T,l()}function w(x){p.value[x]="__OTHER__",l()}function _(x,T){const D=p.value[x];if(!Array.isArray(D))p.value[x]=[T];else{const A=D.indexOf(T);A===-1?D.push(T):D.splice(A,1)}l()}function b(x){const T=p.value[x];if(!Array.isArray(T))p.value[x]=["__OTHER__"];else{const D=T.indexOf("__OTHER__");D===-1?T.push("__OTHER__"):T.splice(D,1)}l()}function y(x){l()}function l(){const x={};m.value.forEach((T,D)=>{const A=p.value[D],N=T.question;if(T.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(M=>M==="__OTHER__"?d.value[D]||"":M).filter(M=>M);x[N]=C.join(", ")}}else A==="__OTHER__"?x[N]=d.value[D]||"":A&&(x[N]=A)}),a("answer",x)}const S=h(()=>m.value.every((x,T)=>{const D=p.value[T];if(x.multiSelect){if(!Array.isArray(D)||D.length===0||D.includes("__OTHER__")&&!d.value[T])return!1}else if(!D||D==="__OTHER__"&&!d.value[T])return!1;return!0}));return e({allQuestionsAnswered:S,getAnswers:()=>{const x={};return m.value.forEach((T,D)=>{const A=p.value[D],N=T.question;if(T.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(M=>M==="__OTHER__"?d.value[D]||"":M).filter(M=>M);x[N]=C.join(", ")}}else A==="__OTHER__"?x[N]=d.value[D]||"":A&&(x[N]=A)}),x}}),(x,T)=>(i(),r("div",Tf,[c.value?(i(),r(se,{key:0},[f.value?(i(),r("div",Af,[(i(!0),r(se,null,le(u.value,(D,A)=>(i(),r("div",{key:A,class:"answer-item mb-2"},[t("div",Df,k(A),1),t("div",Mf,k(D),1)]))),128))])):(i(),r("div",Of," No answers recorded. "))],64)):(i(),r(se,{key:1},[m.value.length>0?(i(),r("div",Lf,[(i(!0),r(se,null,le(m.value,(D,A)=>(i(),r("div",{key:A,class:"question-block mb-3"},[t("div",Nf,[D.header?(i(),r("span",If,k(D.header),1)):E("",!0),t("span",Pf,k(D.question),1)]),t("div",jf,[(i(!0),r(se,null,le(D.options,(N,C)=>(i(),r("div",{key:C,class:H(["option-item form-check",{selected:$(A,N.label)}])},[D.multiSelect?(i(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-opt${C}`,checked:$(A,N.label),disabled:n.disabled,onChange:M=>_(A,N.label)},null,40,Rf)):(i(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-opt${C}`,name:`question-${A}`,checked:$(A,N.label),disabled:n.disabled,onChange:M=>g(A,N.label)},null,40,Bf)),t("label",{class:"form-check-label",for:`q${A}-opt${C}`},[t("span",Vf,k(N.label),1),N.description?(i(),r("span",Wf,k(N.description),1)):E("",!0)],8,Ff)],2))),128)),t("div",Uf,[D.multiSelect?(i(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-other`,checked:v(A),disabled:n.disabled,onChange:N=>b(A)},null,40,Hf)):(i(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-other`,name:`question-${A}`,checked:v(A),disabled:n.disabled,onChange:N=>w(A)},null,40,qf)),t("label",{class:"form-check-label",for:`q${A}-other`},[...T[0]||(T[0]=[t("span",{class:"option-label"},"Other",-1)])],8,zf),v(A)?(i(),r("div",Kf,[Se(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":N=>d.value[A]=N,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:N=>y()},null,40,Gf),[[Ve,d.value[A]]])])):E("",!0)])])]))),128))])):(i(),r("div",Yf," No questions to display. "))],64))]))}},jn=te(Jf,[["__scopeId","data-v-ebcee33f"]]),Qf={class:"timeline-detail"},Xf={key:0,class:"detail-banner detail-banner-warning"},Zf={key:2,class:"permission-section"},em={class:"permission-buttons"},tm=["disabled"],sm=["disabled"],nm={class:"detail-banner detail-banner-warning"},om={key:0,class:"suggestions-section"},am=["id","onUpdate:modelValue","disabled"],im=["for"],lm={class:"permission-buttons"},rm=["disabled"],cm=["disabled"],um=["disabled"],dm={class:"guidance-section"},fm=["disabled"],mm=["disabled"],pm={key:3,class:"detail-banner detail-banner-warning"},vm={key:4,class:"detail-banner detail-banner-error"},hm={key:0},_m={key:5,class:"detail-section"},gm={key:0,class:"detail-pre"},bm={key:6,class:"detail-section"},ym={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=pe(),a=rt(),c=O(!1),u=O(!1),f=O(!1),m=O(null),p=O(""),d=O(!1),$=O(null),v=O({}),g=O(null),w=O({});fe(()=>e.toolCall.suggestions,j=>{if(j&&j.length>0){const z={};j.forEach((ee,ue)=>{z[ue]=!0}),v.value=z}},{immediate:!0});const _=h(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((j,z)=>v.value[z]):[]),b={Read:kl,Write:Bl,Bash:Xl,TodoWrite:vr,Edit:jr,Grep:Nn,Glob:Nn,WebFetch:In,WebSearch:In,Task:Wc,TaskCreate:ou,TaskUpdate:Au,TaskList:Hu,TaskGet:pd,NotebookEdit:Od,BashOutput:Pn,KillShell:Pn,SlashCommand:gf,Skill:af,ExitPlanMode:Ef,AskUserQuestion:jn},y=h(()=>b[e.toolCall.name]||el),l=h(()=>{if(e.toolCall.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[e.toolCall.backendStatus]||e.toolCall.backendStatus;const j=s.getBackendToolState(o.currentSessionId,e.toolCall.id);return j?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[j.state]||j.state:e.toolCall.status}),S=h(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),x=h(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),T=h(()=>l.value==="permission_required"),D=h(()=>e.toolCall.name==="AskUserQuestion"),A=h(()=>!D.value||!g.value?!1:g.value.allQuestionsAnswered),N=h(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0),C=h(()=>e.toolCall.input&&Object.keys(e.toolCall.input).length>0),M=h(()=>e.toolCall.result!=null),W=h(()=>{try{return JSON.stringify(e.toolCall.input,null,2)}catch{return String(e.toolCall.input)}}),B=h(()=>{const j=e.toolCall.result;if(!j)return"";if(typeof j=="string")return j;if(j.content)return typeof j.content=="string"?j.content:JSON.stringify(j.content,null,2);try{return JSON.stringify(j,null,2)}catch{return String(j)}});function F(j){w.value=j}async function V(){if(!(f.value||!g.value)){f.value=!0,m.value="submit-answers";try{const j=o.currentSessionId,z=g.value.getAnswers(),ee={questions:e.toolCall.input?.questions||[],answers:z};j&&(s.updateToolCall(j,e.toolCall.id,{input:ee}),s.handlePermissionResponse(j,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await a.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",ee)}catch(j){console.error("Failed to submit question answers:",j)}finally{f.value=!1,m.value=null}}}async function G(j,z,ee=null){if(f.value)return;f.value=!0;const ue=_.value,ie=z&&ue.length>0;j==="allow"?m.value=ie?"approve-apply":"approve":ee?m.value="deny-guidance":m.value="deny";try{const ve=o.currentSessionId;if(ve){const he=ie?ue:[];s.handlePermissionResponse(ve,{request_id:e.toolCall.permissionRequestId,decision:j,reasoning:j==="allow"?"User allowed permission":"User denied permission",applied_updates:he})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,j,ie,ee,ie?ue:null)}catch(ve){console.error("Failed to send permission response:",ve)}finally{f.value=!1,m.value=null}}function I(j){return j.type==="setMode"?`Set mode: ${j.mode}`:j.type==="addRules"&&j.rules?.length?`Allow: ${j.rules.map(ee=>ee.ruleContent?`${ee.toolName}(${ee.ruleContent})`:ee.toolName).join(", ")}`:j.type==="addDirectories"&&j.directories?.length?`Add directories: ${j.directories.join(", ")}`:JSON.stringify(j)}function L(){d.value=!0,dt(()=>{$.value?.focus()})}function K(){const j=$.value;if(!j)return;j.style.height="auto";const z=parseFloat(getComputedStyle(j).lineHeight)*6+10;j.style.height=Math.min(j.scrollHeight,z)+"px"}return(j,z)=>(i(),r("div",Qf,[S.value?(i(),r("div",Xf,[z[9]||(z[9]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[z[8]||(z[8]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,k(x.value?.message||"Session was terminated"),1)])])):E("",!0),D.value&&l.value==="permission_required"?E("",!0):(i(),Te(xo(y.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),l.value==="permission_required"&&!S.value?(i(),r("div",Zf,[D.value?(i(),r(se,{key:0},[z[10]||(z[10]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),be(jn,{ref_key:"questionHandlerRef",ref:g,toolCall:n.toolCall,disabled:f.value,onAnswer:F},null,8,["toolCall","disabled"]),t("div",em,[t("button",{class:"btn-timeline btn-primary",onClick:V,disabled:f.value||!A.value},k(f.value?"Submitting...":"Submit Answers"),9,tm),t("button",{class:"btn-timeline btn-secondary",onClick:z[0]||(z[0]=ee=>G("deny",!1)),disabled:f.value}," Skip ",8,sm)])],64)):(i(),r(se,{key:1},[t("div",nm,[z[12]||(z[12]=t("strong",null,"Permission Required",-1)),t("p",null,[z[11]||(z[11]=ce("Claude wants to use ",-1)),t("code",null,k(n.toolCall.name),1)])]),N.value?(i(),r("div",om,[z[13]||(z[13]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(i(!0),r(se,null,le(n.toolCall.suggestions,(ee,ue)=>(i(),r("div",{key:ue,class:"suggestion-item"},[Se(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${ue}`,"onUpdate:modelValue":ie=>v.value[ue]=ie,disabled:f.value},null,8,am),[[Co,v.value[ue]]]),t("label",{for:`sg-${n.toolCall.id}-${ue}`},[t("code",null,k(I(ee)),1)],8,im)]))),128))])):E("",!0),t("div",lm,[N.value?(i(),r("button",{key:0,class:"btn-timeline btn-approve",onClick:z[1]||(z[1]=ee=>G("allow",!0)),disabled:f.value},k(f.value&&m.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,rm)):E("",!0),t("button",{class:H(["btn-timeline",N.value?"btn-approve-outline":"btn-approve"]),onClick:z[2]||(z[2]=ee=>G("allow",!1)),disabled:f.value},k(N.value?"Approve Only":"Approve"),11,cm),t("button",{class:"btn-timeline btn-deny",onClick:z[3]||(z[3]=ee=>G("deny",!1)),disabled:f.value}," Deny ",8,um)]),t("div",dm,[d.value?E("",!0):(i(),r("a",{key:0,href:"#",class:"guidance-link",onClick:ye(L,["prevent"])}," Add guidance... ")),d.value?(i(),r(se,{key:1},[Se(t("textarea",{ref_key:"guidanceTextarea",ref:$,"onUpdate:modelValue":z[4]||(z[4]=ee=>p.value=ee),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:f.value,onInput:K},null,40,fm),[[Ve,p.value]]),p.value.trim()?(i(),r("button",{key:0,class:"btn-timeline btn-guidance",onClick:z[5]||(z[5]=ee=>G("deny",!1,p.value)),disabled:f.value}," Provide Guidance & Continue ",8,mm)):E("",!0)],64)):E("",!0)])],64))])):E("",!0),l.value==="permission_required"&&S.value?(i(),r("div",pm,[z[14]||(z[14]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,k(x.value?.message||"Session was terminated before permission could be granted"),1)])):E("",!0),n.toolCall.permissionDecision==="deny"?(i(),r("div",vm,[z[15]||(z[15]=ce(" Permission denied ",-1)),n.toolCall.result?.message?(i(),r("span",hm," - "+k(n.toolCall.result.message),1)):E("",!0)])):E("",!0),C.value&&!T.value?(i(),r("div",_m,[t("div",{class:"section-header",onClick:z[6]||(z[6]=ee=>c.value=!c.value)},[t("span",null,k(c.value?"â–¾":"â–¸")+" Parameters",1)]),c.value?(i(),r("pre",gm,k(W.value),1)):E("",!0)])):E("",!0),M.value&&!T.value?(i(),r("div",bm,[t("div",{class:"section-header",onClick:z[7]||(z[7]=ee=>u.value=!u.value)},[t("span",null,k(u.value?"â–¾":"â–¸")+" Result",1)]),u.value?(i(),r("pre",{key:0,class:H(["detail-pre",{"result-error":n.toolCall.result?.error}])},k(B.value),3)):E("",!0)])):E("",!0)]))}},wm=te(ym,[["__scopeId","data-v-1ed79806"]]),km={class:"timeline-row"},$m={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=Pe(),o=pe(),a=xe(),c=O(null),u=O({});function f(g,w){w&&(u.value[g]=w)}const m=h(()=>[...e.tools].map((g,w)=>({tool:g,originalIndex:w})).sort((g,w)=>{if(g.tool.timestamp&&w.tool.timestamp){const _=new Date(g.tool.timestamp).getTime(),b=new Date(w.tool.timestamp).getTime();if(_!==b)return _-b}return g.originalIndex-w.originalIndex}).map(({tool:g})=>g)),p=h(()=>c.value?m.value.find(g=>g.id===c.value):null);fe(m,g=>{const w=g.find(_=>d(_)==="permission_required");if(w)c.value=w.id;else if(c.value){const _=g.find(b=>b.id===c.value);_&&d(_)!=="permission_required"&&(c.value=null)}},{deep:!0,immediate:!0});function d(g){const w=o.currentSessionId;return w?g.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[g.backendStatus]||g.backendStatus:s.isToolUseOrphaned(w,g.id)?"orphaned":g.status:g.status}function $(g){const w=d(g),_=g.result?.error||g.status==="error"||g.permissionDecision==="deny";switch(w){case"completed":return _?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function v(g){c.value===g?c.value=null:c.value=g}return(g,w)=>m.value.length>0?(i(),r("div",{key:0,class:H(["activity-timeline",{"timeline-mobile":ne(a).isMobile}])},[t("div",km,[(i(!0),r(se,null,le(m.value,(_,b)=>(i(),r(se,{key:_.id},[b>0?(i(),Te(Wi,{key:0,leftColor:$(m.value[b-1]),rightColor:$(_),compact:ne(a).isMobile},null,8,["leftColor","rightColor","compact"])):E("",!0),be(Fi,{ref_for:!0,ref:y=>f(_.id,y),tool:_,isExpanded:c.value===_.id,compact:ne(a).isMobile,onClick:y=>v(_.id)},null,8,["tool","isExpanded","compact","onClick"])],64))),128))]),c.value&&p.value?(i(),Te(wm,{key:0,toolCall:p.value},null,8,["toolCall"])):E("",!0)],2)):E("",!0)}},Sm=te($m,[["__scopeId","data-v-5c2a6058"]]),xm={class:"msg-wrapper msg-assistant"},Cm={class:"msg-meta"},Em={class:"msg-time"},Tm={class:"msg-bubble msg-bubble-assistant"},Am={key:0,class:"thinking-block mb-2"},Dm=["innerHTML"],Mm={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Pe(),o=pe();Ke.setOptions({breaks:!0,gfm:!0});const a=h(()=>ss(e.message.timestamp)),c=h(()=>{const v=e.message.content||"";return v.trim().length>0&&v!=="Assistant response"}),u=h(()=>{const v=e.message.content||"";let g=Ke.parse(v);return g=g.replace(/\n</g,"<"),g=g.replace(/\n+$/,""),Vt.sanitize(g)}),f=h(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),m=h(()=>e.message.metadata?.thinking_content||""),p=h(()=>{const v=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,g=e.attachedTools&&e.attachedTools.length>0;return v||g}),d=h(()=>{const v=e.message.metadata?.tool_uses||[],g=e.attachedTools||[],w=[...v],_=new Set(v.map(b=>b.id));for(const b of g)_.has(b.id)||w.push(b);return w}),$=h(()=>{const v=o.currentSessionId;if(!v)return[];const g=s.toolCallsBySession.get(v)||[];return d.value.map(w=>{const _=g.find(b=>b.id===w.id);return _||{id:w.id,name:w.name,input:w.input,status:"pending",result:null,timestamp:w.timestamp||e.message.timestamp,isExpanded:!0}})});return(v,g)=>(i(),r("div",xm,[t("div",Cm,[g[0]||(g[0]=t("span",{class:"msg-role"},"assistant",-1)),t("span",Em,k(a.value),1)]),t("div",Tm,[f.value?(i(),r("div",Am,[be(Ni,{thinking:m.value},null,8,["thinking"])])):E("",!0),c.value?(i(),r("div",{key:1,class:"msg-text",innerHTML:u.value},null,8,Dm)):E("",!0),p.value?(i(),Te(Sm,{key:2,tools:$.value,messageId:n.message.id},null,8,["tools","messageId"])):E("",!0)])]))}},Om=te(Mm,[["__scopeId","data-v-2f57d076"]]),Lm={class:"msg-wrapper msg-system"},Nm={key:0,class:"pill-icon"},Im={class:"pill-text"},Pm={class:"pill-time"},jm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=h(()=>ss(e.message.timestamp)),o=h(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting"),a=h(()=>{if(o.value)return"Context compaction in progress...";const c=e.message.content||"";return c.length>80?c.substring(0,77)+"...":c});return(c,u)=>(i(),r("div",Lm,[t("div",{class:H(["msg-pill",{"pill-compaction":o.value}])},[o.value?(i(),r("span",Nm,"ðŸ—œï¸")):E("",!0),t("span",Im,k(a.value),1),u[0]||(u[0]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Pm,k(s.value),1)],2)]))}},Rn=te(jm,[["__scopeId","data-v-950fba0a"]]),Rm={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=h(()=>{switch(e.message.type){case"user":return Ei;case"assistant":return Om;case"system":return Rn;default:return Rn}});return(o,a)=>(i(),Te(xo(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Bm=te(Rm,[["__scopeId","data-v-11dff525"]]),Fm={class:"msg-wrapper msg-system"},Vm={class:"pill-badge"},Wm={class:"pill-time"},Um={key:0,class:"compaction-detail"},Hm={class:"detail-section"},qm={class:"detail-value"},zm={class:"detail-section"},Km={class:"detail-value"},Gm={key:0,class:"detail-section"},Ym={class:"detail-value"},Jm={class:"continuation-section"},Qm={class:"continuation-text"},Xm={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=O(!1);function o(){s.value=!s.value}const a=h(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),c=h(()=>a.value?e.messages[3]:e.messages[2]),u=h(()=>c.value?.metadata?.init_data?.compact_metadata||{}),f=h(()=>u.value.pre_tokens||0),m=h(()=>a.value?e.messages[4]:e.messages[3]),p=h(()=>m.value?.content||""),d=h(()=>{const v=e.messages[0]?.timestamp;return v?ss(v):""});function $(v){return v?`${v.toLocaleString()} tokens`:"0 tokens"}return(v,g)=>(i(),r("div",Fm,[t("div",{class:"msg-pill pill-compaction",onClick:o,style:{cursor:"pointer"}},[g[0]||(g[0]=t("span",{class:"pill-icon"},"ðŸ—œï¸",-1)),g[1]||(g[1]=t("span",{class:"pill-text"},"Context Compaction Event",-1)),t("span",Vm,k($(f.value)),1),g[2]||(g[2]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Wm,k(d.value),1),t("span",{class:H(["pill-chevron",{expanded:s.value}])},"â–¶",2)]),s.value?(i(),r("div",Um,[t("div",Hm,[g[3]||(g[3]=t("div",{class:"detail-label"},"Trigger",-1)),t("div",qm,k(u.value.trigger||"auto"),1)]),t("div",zm,[g[4]||(g[4]=t("div",{class:"detail-label"},"Pre-compaction",-1)),t("div",Km,k($(f.value)),1)]),u.value.post_tokens?(i(),r("div",Gm,[g[5]||(g[5]=t("div",{class:"detail-label"},"Post-compaction",-1)),t("div",Ym,k($(u.value.post_tokens)),1)])):E("",!0),t("div",Jm,[g[6]||(g[6]=t("div",{class:"detail-label"},"Continuation Message",-1)),t("pre",Qm,k(p.value),1)])])):E("",!0)]))}},Zm=te(Xm,[["__scopeId","data-v-6b5b6a98"]]),ep={key:0,class:"text-muted text-center py-5"},tp={__name:"MessageList",setup(n){const e=Pe(),s=xe(),o=O(null),a=h(()=>{const d=e.currentMessages,$=[];let v=0;for(;v<d.length;){const g=d[v];if(u(g,d,v)){const w=d[v+2],b=w?.type==="system"&&w?.metadata?.subtype==="init"?5:4,y=d.slice(v,v+b);$.push({type:"compaction",messages:y}),v+=b;continue}m(g)&&$.push({type:"message",message:g,attachedTools:[]}),v++}return c($)});function c(d){const $=new Map,v=new Set;for(let w=0;w<d.length;w++){const _=d[w];if(_.type==="compaction")continue;const b=_.message,y=b.content&&b.content.trim().length>0&&b.content!=="Assistant response",l=b.type==="assistant"&&b.metadata?.has_tool_uses&&b.metadata?.tool_uses?.length>0;if(b.type==="assistant"&&l&&!y){let S=-1,x=!1;for(let T=w-1;T>=0;T--){const D=d[T];if(!v.has(T)){if(D.type==="message"&&D.message.type!=="assistant"){x=!0;break}if(D.type==="message"&&D.message.type==="assistant"){const A=D.message;if(A.content&&A.content.trim().length>0&&A.content!=="Assistant response"){S=T;break}else{S=T;break}}}}x&&S===-1||(x&&S>=0?($.has(S)||$.set(S,[]),$.get(S).push(...b.metadata.tool_uses),v.add(w)):!x&&S>=0&&($.has(S)||$.set(S,[]),$.get(S).push(...b.metadata.tool_uses),v.add(w)))}}const g=[];for(let w=0;w<d.length;w++){if(v.has(w))continue;const _=d[w];$.has(w)&&(_.attachedTools=[..._.attachedTools||[],...$.get(w)]),g.push(_)}return g}function u(d,$,v){if(v+3>=$.length)return!1;const g=$[v],w=$[v+1];let _=$[v+2],b=$[v+3],y=$[v+4];const l=g.type==="system"&&g.metadata?.subtype==="status"&&g.metadata?.init_data?.status==="compacting",S=w.type==="system"&&w.metadata?.subtype==="status"&&(w.metadata?.init_data?.status===null||w.metadata?.init_data?.status===void 0);if(_?.type==="system"&&_?.metadata?.subtype==="init"){if(v+4>=$.length)return!1;const T=!0,D=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",A=y?.type==="user"&&y?.content?.startsWith("This session is being continued from a previous conversation");return g.type==="system"&&g.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",v),console.log("  Msg1 (compacting):",l),console.log("  Msg2 (null status):",S),console.log("  Msg3 (init):",T),console.log("  Msg4 (boundary):",D),console.log("  Msg5 (continuation):",A)),l&&S&&T&&D&&A}else{const T=_?.type==="system"&&_?.metadata?.subtype==="compact_boundary",D=b?.type==="user"&&b?.content?.startsWith("This session is being continued from a previous conversation");return g.type==="system"&&g.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",v),console.log("  Msg1 (compacting):",l),console.log("  Msg2 (null status):",S),console.log("  Msg3 (boundary):",T),console.log("  Msg4 (continuation):",D)),l&&S&&T&&D}}async function f(){s.autoScrollEnabled&&(await dt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>a.value.length,f),fe(()=>e.currentToolCalls.length,f),fe(()=>e.currentToolCalls.map(d=>`${d.id}-${d.status}`).join(","),f),Me(()=>{setTimeout(()=>{f()},100)});function m(d){const $=d.subtype||d.metadata?.subtype;if(d.type==="system"&&$==="init"||d.type==="system"&&$==="task_notification"||d.type==="result"||d.type==="permission_request"||d.type==="permission_response")return!1;if(d.type==="user"&&d.metadata?.has_tool_results){const v=d.content||"";if(v.match(/^Tool results?: \d+ results?$/i)||v.trim()==="")return!1}if(d.type==="user"){const v=d.content||"";if(v.includes("<command-message>")&&v.includes("skill is running")||v.startsWith("Base directory for this skill:"))return!1}if(d.type==="user"){const v=d.content||"";if(v.includes("<command-message>")&&v.includes("<command-name>")&&v.includes("<command-args>")||v.includes("ARGUMENTS:")&&(v.includes("<command-name>")||v.match(/\nARGUMENTS:/)))return!1}if(d.type==="user"){const v=d.metadata||{};if(v.parent_tool_use_id&&!v.has_tool_results)return!1}return!0}function p(d){return{type:d.type||"unknown",content:d.content||"",timestamp:d.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...d.metadata}}}return(d,$)=>(i(),r("div",{class:H(["messages-area flex-grow-1 overflow-auto",{"theme-red":ne(s).isRedBackground}]),ref_key:"messagesArea",ref:o},[a.value.length===0?(i(),r("div",ep," No messages yet. Start a conversation! ")):E("",!0),(i(!0),r(se,null,le(a.value,(v,g)=>(i(),r(se,{key:`item-${g}`},[v.type==="message"?(i(),Te(Bm,{key:0,message:p(v.message),attachedTools:v.attachedTools||[]},null,8,["message","attachedTools"])):v.type==="compaction"?(i(),Te(Zm,{key:1,messages:v.messages},null,8,["messages"])):E("",!0)],64))),128))],2))}},sp=te(tp,[["__scopeId","data-v-7aa43476"]]),np={key:0,class:"attachment-list"},op={key:0,class:"attachment-preview"},ap=["src","alt"],ip={key:1,class:"attachment-icon"},lp={class:"file-type-icon"},rp={class:"attachment-info"},cp=["title"],up={class:"attachment-size"},dp=["onClick"],fp={key:2,class:"upload-progress"},mp=["title"],pp={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const p=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(p)}function a(m){const p=m.name?.split(".").pop()?.toLowerCase()||"",d=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(p)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(p)?"âš™ï¸":["log","txt"].includes(p)||d==="text/plain"?"ðŸ“‹":["md","rst"].includes(p)?"ðŸ“":"ðŸ“"}function c(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function u(m,p=20){if(!m||m.length<=p)return m;const d=m.split(".").pop(),$=m.substring(0,m.length-d.length-1);return $.length<=p-d.length-4?m:$.substring(0,p-d.length-4)+"..."+d}function f(m){s("remove",m)}return(m,p)=>n.attachments.length>0?(i(),r("div",np,[(i(!0),r(se,null,le(n.attachments,(d,$)=>(i(),r("div",{key:d.id||$,class:"attachment-item"},[o(d)?(i(),r("div",op,[t("img",{src:d.preview||d.url,alt:d.name,class:"attachment-thumbnail"},null,8,ap)])):(i(),r("div",ip,[t("span",lp,k(a(d)),1)])),t("div",rp,[t("span",{class:"attachment-name",title:d.name},k(u(d.name)),9,cp),t("span",up,k(c(d.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:v=>f($)}," âœ• ",8,dp),d.uploading?(i(),r("div",fp,[t("div",{class:"progress-bar",style:je({width:(d.progress||0)+"%"})},null,4)])):E("",!0),d.error?(i(),r("div",{key:3,class:"upload-error",title:d.error}," âš ï¸ "+k(d.error),9,mp)):E("",!0)]))),128))])):E("",!0)}},vp=te(pp,[["__scopeId","data-v-0fcc4974"]]),hp=["id","aria-selected","onMousedown","onMouseenter"],_p={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=O(null);return fe(()=>e.selectedIndex,o=>{if(!s.value)return;const a=s.value.children[o];a&&a.scrollIntoView({block:"nearest"})}),(o,a)=>n.commands.length>0?(i(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),r(se,null,le(n.commands,(c,u)=>(i(),r("li",{id:`slash-cmd-${u}`,key:c,role:"option",class:H(["slash-command-item",{active:u===n.selectedIndex}]),"aria-selected":u===n.selectedIndex,onMousedown:ye(f=>o.$emit("select",c),["prevent"]),onMouseenter:f=>o.$emit("highlight",u)}," /"+k(c),43,hp))),128))],512)):E("",!0)}},gp=te(_p,[["__scopeId","data-v-97c65547"]]),bp={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},yp=["disabled"],wp=["placeholder","disabled","aria-expanded","aria-activedescendant"],kp=["disabled"],$p=["disabled"],Bn=5*1024*1024,Sp={__name:"InputArea",setup(n){const e=pe(),s=rt(),o=Qe(),a=xe(),c=Eo("pendingResourceAttachment",O(null)),u=O(null),f=O(null),m=O(window.innerWidth),p=O([]),d=O(!1),$=O(!1),v=O(!1),g=O(""),w=O(0),_=h({get:()=>e.currentInput,set:q=>{e.currentInput=q}}),b=h(()=>e.currentSession?.is_processing||!1),y=h(()=>s.sessionConnected),l=h(()=>e.currentSession?.state==="starting"),S=h(()=>e.currentSessionId),x=h(()=>!!_.value.trim()||p.value.filter(q=>!q.error).length>0),T=h(()=>m.value<768),D=h(()=>l.value?"Session is starting...":y.value?"Type your message to Claude Code...":"Waiting for connection..."),A=h(()=>{const q=S.value;return q?e.initData.get(q)?.slash_commands||[]:[]}),N=h(()=>{const q=g.value.toLowerCase();return A.value.filter(P=>P.toLowerCase().includes(q)).sort((P,U)=>P.localeCompare(U))});function C(){m.value=window.innerWidth}Me(()=>{window.addEventListener("resize",C)}),De(()=>{window.removeEventListener("resize",C)}),fe(c,q=>{q&&(ve(q),c.value=null)});function M(q){if(v.value&&N.value.length>0){const P=N.value.length;if(q.key==="ArrowDown"){q.preventDefault(),w.value=(w.value+1)%P;return}if(q.key==="ArrowUp"){q.preventDefault(),w.value=(w.value-1+P)%P;return}if(q.key==="Enter"){q.preventDefault(),B(N.value[w.value]);return}if(q.key==="Tab"){q.preventDefault(),B(N.value[w.value]);return}}if(q.key==="Escape"&&v.value){q.preventDefault(),v.value=!1;return}if(q.key==="Enter"&&!q.shiftKey){if(T.value)return;q.preventDefault(),ue()}}function W(){const q=u.value;if(!q)return;q.style.height="auto";const P=Math.min(q.scrollHeight,parseInt(getComputedStyle(q).maxHeight));q.style.height=P+"px"}fe(_,q=>{q.startsWith("/")&&A.value.length>0?(g.value=q.slice(1),w.value=0,v.value=N.value.length>0):v.value=!1});function B(q){_.value=`/${q} `,v.value=!1,u.value?.focus(),W()}function F(){f.value?.click()}function V(q){const P=Array.from(q.target.files||[]);L(P),q.target.value=""}function G(q){d.value=!1;const P=Array.from(q.dataTransfer?.files||[]);L(P)}function I(q){const P=q.clipboardData?.items;if(!P)return;const U=[];for(const X of P)if(X.type.startsWith("image/")){const Q=X.getAsFile();if(Q){const ae=X.type.split("/")[1]||"png",$e=`clipboard-${Date.now()}.${ae}`,st=new File([Q],$e,{type:Q.type});U.push(st)}}U.length>0&&(q.preventDefault(),L(U))}function L(q){for(const P of q){if(P.size>Bn){p.value.push({id:j(),name:P.name,size:P.size,type:P.type,file:P,error:`File too large (max ${Bn/(1024*1024)}MB)`});continue}let U=null;P.type.startsWith("image/")&&(U=URL.createObjectURL(P)),p.value.push({id:j(),name:P.name,size:P.size,type:P.type,file:P,preview:U,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function K(q){const P=p.value[q];P.preview&&URL.revokeObjectURL(P.preview),p.value.splice(q,1)}function j(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function z(q){const P=S.value;if(!P)return null;q.uploading=!0,q.progress=0,q.error=null;try{const U=new FormData;U.append("file",q.file);const X=await fetch(`/api/sessions/${P}/files`,{method:"POST",body:U});if(!X.ok){const ae=await X.json().catch(()=>({}));throw new Error(ae.detail||`Upload failed: ${X.status}`)}const Q=await X.json();return q.uploaded=!0,q.uploadedInfo=Q.file,q.progress=100,Q.file}catch(U){return q.error=U.message,null}finally{q.uploading=!1}}async function ee(){const q=p.value.filter(P=>!P.uploaded&&!P.error);if(q.length===0)return!0;$.value=!0;try{return(await Promise.all(q.map(z))).every(U=>U!==null)}finally{$.value=!1}}async function ue(){const q=_.value.trim(),P=p.value.filter(Q=>!Q.error).length>0;if(!q&&!P||P&&!await ee())return;let U=_.value;const X=p.value.filter(Q=>Q.uploaded&&Q.uploadedInfo).map(Q=>Q.uploadedInfo);if(X.length>0){const Q=X.map(ae=>{const $e=(ae.size_bytes/1024).toFixed(1);return`- ${ae.original_name} (${$e} KB): ${ae.stored_path}`}).join(`
`);U.trim()?U=`${U}

---
Attached files (use Read tool to access):
${Q}`:U=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${Q}`}s.sendMessage(U),_.value="",ie(),u.value&&(u.value.style.height="auto")}function ie(){for(const q of p.value)q.preview&&URL.revokeObjectURL(q.preview);p.value=[]}function ve(q){if(!q||!q.resource_id){console.warn("Invalid resource for attachment:",q);return}const P=S.value;if(!P){console.warn("No current session for resource attachment");return}if(p.value.findIndex(ae=>ae.resourceId===q.resource_id)>=0){console.log("Resource already attached:",q.resource_id);return}const X=o.isImageResource(q);let Q=null;X&&(Q=o.getResourceUrl(P,q.resource_id)),p.value.push({id:j(),resourceId:q.resource_id,name:q.original_filename||q.title||"Resource",size:q.size_bytes||0,type:q.format||"application/octet-stream",file:null,preview:Q,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:q.resource_id,original_name:q.original_filename||q.title,stored_path:q.file_path||`/api/sessions/${P}/resources/${q.resource_id}`,size_bytes:q.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",q.resource_id)}function he(){s.interruptSession()}return(q,P)=>(i(),r("div",{class:H(["border-top",ne(a).isRedBackground?"theme-red-panel":"bg-light"])},[y.value?E("",!0):(i(),r("div",bp,[...P[6]||(P[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),be(vp,{attachments:p.value,onRemove:K},null,8,["attachments"]),d.value?(i(),r("div",{key:1,class:"drop-zone-overlay",onDragover:P[0]||(P[0]=ye(()=>{},["prevent"])),onDragleave:P[1]||(P[1]=U=>d.value=!1),onDrop:ye(G,["prevent"])},[...P[7]||(P[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):E("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:P[4]||(P[4]=ye(U=>d.value=!0,["prevent"])),onDragenter:P[5]||(P[5]=ye(U=>d.value=!0,["prevent"]))},[v.value?(i(),Te(gp,{key:0,commands:N.value,"selected-index":w.value,onSelect:B,onHighlight:P[2]||(P[2]=U=>w.value=U)},null,8,["commands","selected-index"])):E("",!0),t("input",{ref_key:"fileInput",ref:f,type:"file",multiple:"",class:"d-none",onChange:V},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:l.value||!y.value,onClick:F}," ðŸ“Ž ",8,yp),Se(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:u,"onUpdate:modelValue":P[3]||(P[3]=U=>_.value=U),class:"form-control",placeholder:D.value,disabled:l.value||!y.value,rows:"1","aria-expanded":v.value||void 0,"aria-activedescendant":v.value?`slash-cmd-${w.value}`:void 0,onInput:W,onKeydown:M,onPaste:I},null,40,wp),[[Ve,_.value]]),b.value&&!x.value?(i(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:he}," Stop ")):b.value&&x.value?(i(),r("button",{key:2,class:"btn btn-info",disabled:!y.value||l.value||$.value,title:"Send while processing (doesn't interrupt)",onClick:ue},k($.value?"Uploading...":"Queue"),9,kp)):(i(),r("button",{key:3,class:"btn btn-primary",disabled:!x.value||!y.value||l.value||$.value,onClick:ue},k($.value?"Uploading...":"Send"),9,$p))],32)],2))}},xp=te(Sp,[["__scopeId","data-v-5b1f250e"]]),Cp={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Ep={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Tp={class:"text-secondary"},Ap={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Dp={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=pe(),o=xe(),a=h(()=>s.currentSession),c=h(()=>o.isLoading),u=h(()=>o.loadingMessage);return Me(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(f,m)=>{if(f!==m&&f!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(f)}finally{o.hideLoading()}}}),De(()=>{}),(f,m)=>(i(),r("div",Cp,[c.value?(i(),r("div",Ep,[m[0]||(m[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Tp,k(u.value),1)])):E("",!0),t("div",Ap,[be(sp)]),be(xp),a.value?(i(),Te(oi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):E("",!0),a.value?(i(),Te(fi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):E("",!0)]))}},Wt=tt("legion",()=>{const n=O(new Map),e=O(new Map),s=O(null),o=h(()=>n.value.get(s.value)||[]),a=h(()=>e.value.get(s.value)||[]);function c(w){s.value=w}async function u(w,_=100,b=0){try{const y=await ge.get(`/api/legions/${w}/timeline?limit=${_}&offset=${b}`),l=y.comms||[],S=y.total_count||l.length,x=y.has_more||!1;return l.sort((T,D)=>new Date(T.timestamp)-new Date(D.timestamp)),console.log(`Loaded ${l.length} of ${S} comms for legion ${w}`),n.value.set(w,l),n.value=new Map(n.value),{comms:l,totalCount:S,hasMore:x}}catch(y){throw console.error("Failed to load timeline:",y),y}}function f(w,_){n.value.has(w)||n.value.set(w,[]);const b=n.value.get(w);if(b.some(l=>l.comm_id===_.comm_id)){console.log(`Duplicate comm ${_.comm_id} prevented in timeline`);return}b.push(_),n.value=new Map(n.value)}async function m(w,_){try{const y=(await ge.post(`/api/legions/${w}/comms`,_)).comm;return console.log(`Sent comm ${y.comm_id} to legion ${w}`),y}catch(b){throw console.error("Failed to send comm:",b),b}}async function p(w){return console.log(`Minions for legion ${w} are already available in session store`),[]}async function d(w,_){try{const y=(await ge.post(`/api/legions/${w}/minions`,_)).minion;return await p(w),console.log(`Created minion ${y.minion_id} in legion ${w}`),y}catch(b){throw console.error("Failed to create minion:",b),b}}async function $(w){try{const _=await ge.post(`/api/legions/${w}/halt-all`);return console.log(`Halted ${_.halted_count} of ${_.total_minions} minions in legion ${w}`),_.failed_minions&&_.failed_minions.length>0&&console.warn("Failed to halt some minions:",_.failed_minions),_}catch(_){throw console.error("Failed to halt all minions:",_),_}}async function v(w){try{const _=await ge.post(`/api/legions/${w}/resume-all`);return console.log(`Resumed ${_.resumed_count} of ${_.total_minions} minions in legion ${w}`),_.failed_minions&&_.failed_minions.length>0&&console.warn("Failed to resume some minions:",_.failed_minions),_}catch(_){throw console.error("Failed to resume all minions:",_),_}}function g(w){n.value.delete(w),e.value.delete(w),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:a,setCurrentLegion:c,loadTimeline:u,addComm:f,sendComm:m,loadMinions:p,createMinion:d,haltAll:$,resumeAll:v,clearLegionData:g}}),Mp=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Wt},Symbol.toStringTag,{value:"Module"})),Op={class:"timeline-header border-bottom p-3"},Lp={class:"project-name"},Np=["title"],Ip={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=qe(),o=h(()=>s.projects.get(e.legionId)),a=h(()=>o.value?.name||"Legion");return(c,u)=>(i(),r("div",Op,[t("div",null,[t("div",Lp,k(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Np)])]))}},Pp=te(Ip,[["__scopeId","data-v-44f386f5"]]),jp={class:"timeline-status-bar border-top p-2 bg-light"},Rp={class:"d-flex justify-content-end"},Bp={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=xe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(i(),r("div",jp,[t("div",Rp,[t("button",{class:H(["btn btn-sm",ne(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+k(ne(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Fp=te(Bp,[["__scopeId","data-v-891c73db"]]),Vp={class:"comm-composer border-top p-3"},Wp={key:0,class:"d-flex gap-2 mb-2"},Up={class:"flex-grow-1"},Hp=["disabled"],qp={label:"Minions"},zp=["value"],Kp={style:{"min-width":"150px"}},Gp=["disabled"],Yp={class:"d-flex gap-2 align-items-end position-relative"},Jp={class:"flex-grow-1 position-relative"},Qp=["disabled"],Xp=["onClick","onMouseenter"],Zp=["disabled"],ev={key:0},tv={key:1},sv={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Wt(),o=pe(),a=qe(),c=O(""),u=O("task"),f=O(""),m=O(!1),p=O(window.innerWidth),d=O(!1),$=O([]),v=O(0),g=O(-1),w=O(null),_=O(null),b=h(()=>p.value<768),y=h(()=>{const B=a.projects.get(e.legionId);return!B||!B.session_ids?[]:B.session_ids.map(F=>o.sessions.get(F)).filter(F=>F)}),l=h(()=>c.value&&f.value.trim().length>0);function S(B){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[B.state]||"â—‹"}function x(B){return B.role?`${B.name} (${B.role})`:B.name}function T(){const B=w.value;if(!B)return;B.style.height="auto";const F=Math.min(B.scrollHeight,parseInt(getComputedStyle(B).maxHeight));B.style.height=F+"px"}function D(){const B=w.value;if(!B)return;T();const F=f.value,V=B.selectionStart,G=F.substring(0,V),I=G.lastIndexOf("#");if(I===-1){d.value=!1;return}const L=G.substring(I+1).toLowerCase();if(L.includes(" ")){d.value=!1;return}const K=y.value.filter(j=>j.name.toLowerCase().includes(L)).map(j=>({type:"minion",name:j.name,role:j.role,id:j.session_id,state:j.state}));if(K.length===0){d.value=!1;return}$.value=K,v.value=0,g.value=I,d.value=!0}function A(){if(!_.value)return;const B=_.value,F=B.children[v.value];if(!F)return;const V=F.offsetTop,G=F.offsetHeight,I=B.scrollTop,L=B.clientHeight;V<I?B.scrollTop=V:V+G>I+L&&(B.scrollTop=V+G-L)}function N(B){if(!d.value){if(B.key==="Enter"&&!B.shiftKey){if(b.value)return;l.value&&(B.preventDefault(),M())}return}if(B.key==="ArrowDown")B.preventDefault(),v.value=(v.value+1)%$.value.length,A();else if(B.key==="ArrowUp")B.preventDefault(),v.value=v.value===0?$.value.length-1:v.value-1,A();else if(B.key==="Enter"){B.preventDefault();const F=$.value[v.value];F&&C(F)}else B.key==="Escape"&&(d.value=!1)}function C(B){const F=w.value;if(!F)return;const V=f.value,G=F.selectionStart,I=V.substring(0,g.value)+"#"+B.name+" "+V.substring(G);f.value=I;const L=g.value+B.name.length+2;setTimeout(()=>{F.setSelectionRange(L,L),F.focus()},0),d.value=!1}async function M(){if(!(!l.value||m.value)){m.value=!0;try{const[B,F]=c.value.split(":"),V={comm_type:u.value,content:f.value.trim()};B==="minion"&&(V.to_minion_id=F),await s.sendComm(e.legionId,V),f.value="",T()}catch(B){console.error("Failed to send comm:",B),alert(`Failed to send comm: ${B.message}`)}finally{m.value=!1}}}function W(){p.value=window.innerWidth}return Me(()=>{window.addEventListener("resize",W)}),De(()=>{window.removeEventListener("resize",W)}),fe(d,B=>{if(B){const F=V=>{V.target.closest(".comm-composer")||(d.value=!1,document.removeEventListener("click",F))};setTimeout(()=>document.addEventListener("click",F),0)}}),(B,F)=>(i(),r("div",Vp,[n.hideRecipientSelector?E("",!0):(i(),r("div",Wp,[t("div",Up,[Se(t("select",{"onUpdate:modelValue":F[0]||(F[0]=V=>c.value=V),class:"form-select form-select-sm",disabled:m.value},[F[3]||(F[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",qp,[(i(!0),r(se,null,le(y.value,V=>(i(),r("option",{key:V.session_id,value:`minion:${V.session_id}`},k(S(V))+" "+k(x(V)),9,zp))),128))])],8,Hp),[[En,c.value]])]),t("div",Kp,[Se(t("select",{"onUpdate:modelValue":F[1]||(F[1]=V=>u.value=V),class:"form-select form-select-sm",disabled:m.value},[...F[4]||(F[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,Gp),[[En,u.value]])])])),t("div",Yp,[t("div",Jp,[Se(t("textarea",{ref_key:"contentTextarea",ref:w,"onUpdate:modelValue":F[2]||(F[2]=V=>f.value=V),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:D,onKeydown:N},null,40,Qp),[[Ve,f.value]]),d.value?(i(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:_,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),r(se,null,le($.value,(V,G)=>(i(),r("div",{key:V.id,class:H(["autocomplete-item px-2 py-1",{"bg-light":G===v.value}]),onClick:I=>C(V),onMouseenter:I=>v.value=G},k(V.type==="minion"?S(V):"#ï¸âƒ£")+" "+k(V.name)+k(V.role?` (${V.role})`:""),43,Xp))),128))],512)):E("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!l.value||m.value,onClick:M},[m.value?(i(),r("span",ev,[...F[5]||(F[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ce(" Sending... ",-1)])])):(i(),r("span",tv,"Send"))],8,Zp)])])]))}},nv=te(sv,[["__scopeId","data-v-e52b8e8f"]]),ov={class:"message-content-column-full"},av=["aria-expanded"],iv={class:"comm-sender-recipient"},lv={class:"comm-badge-summary"},rv=["title"],cv={class:"comm-summary-text text-muted ms-2"},uv=["aria-label"],dv={key:0,class:"comm-content-body"},fv=["innerHTML"],mv="ffffffff-ffff-ffff-ffff-ffffffffffff",pv={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ke.setOptions({breaks:!0,gfm:!0});const s=O(!1);function o(){s.value=!s.value}const a=h(()=>e.comm.from_minion_id===mv),c=h(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),u=h(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),f=h(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),m=h(()=>{const p=e.comm.content||"";let d=Ke.parse(p);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),Vt.sanitize(d)});return(p,d)=>(i(),r("div",{class:H(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",ov,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",iv,[t("strong",{class:H({"system-sender":a.value})},k(n.senderName),3),n.recipientName?(i(),r(se,{key:0},[d[0]||(d[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,k(n.recipientName),1)],64)):E("",!0)]),t("div",lv,[t("span",{class:H(["badge",u.value]),title:c.value},k(n.comm.comm_type),11,rv),t("span",cv,k(f.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},k(s.value?"â–¾":"â–¸"),9,uv)],8,av),s.value?(i(),r("div",dv,[t("div",{class:"message-text",innerHTML:m.value},null,8,fv)])):E("",!0)])],2))}},vv=te(pv,[["__scopeId","data-v-28513f64"]]),hv={class:"timeline-view d-flex flex-column h-100"},_v={key:0,class:"text-center text-muted"},gv={key:1,class:"text-center text-danger"},bv={key:2,class:"text-center text-muted"},yv={key:3,class:"comm-list"},wv={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Wt();qe();const o=pe(),a=rt(),c=xe(),u=O(!0),f=O(null),m=O(null),p=h(()=>s.currentComms);function d(b){return b.from_user?"You":b.from_minion_id?b.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(b.from_minion_id)?.name||"Unknown":"Unknown"}function $(b){return b.to_user?"You":b.to_minion_id?o.sessions.get(b.to_minion_id)?.name||"Unknown":"All"}async function v(){c.autoScrollEnabled&&(await dt(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function g(){u.value=!0,f.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await dt(),await v(),setTimeout(()=>{v()},100)}catch(b){console.error("Failed to load timeline:",b),b.response?f.value=`${b.message} (${b.response.status})`:f.value=b.message||"Unknown error"}finally{u.value=!1}}function w(){a.connectLegion(e.legionId)}function _(){a.disconnectLegion()}return fe(()=>p.value.length,()=>{v()}),Me(()=>{o.currentSessionId=null,g(),w(),setTimeout(()=>{v()},100)}),De(()=>{_()}),(b,y)=>(i(),r("div",hv,[be(Pp,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[u.value?(i(),r("div",_v,[...y[0]||(y[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ce(" Loading timeline... ",-1)])])):f.value?(i(),r("div",gv," Failed to load timeline: "+k(f.value),1)):p.value.length===0?(i(),r("div",bv," No messages yet. Minions will appear here once they start communicating. ")):(i(),r("div",yv,[(i(!0),r(se,null,le(p.value,l=>(i(),Te(vv,{key:l.comm_id,comm:l,"sender-name":d(l),"recipient-name":$(l)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),be(nv,{"legion-id":n.legionId},null,8,["legion-id"]),be(Fp,{"legion-id":n.legionId},null,8,["legion-id"])]))}},kv=te(wv,[["__scopeId","data-v-b6752179"]]),$v={class:"minion-info flex-grow-1"},Sv={class:"minion-name"},xv={key:0,class:"me-1"},Cv={key:1,class:"badge bg-secondary ms-2"},Ev={key:0,class:"latest-activity text-muted"},Tv={key:0,class:"activity-prefix"},Av=["title"],Dv={key:1,class:"activity-time ms-1"},Mv={key:1,class:"latest-activity text-muted"},Ov={class:"activity-prefix"},Lv=["title"],Nv={key:2,class:"latest-activity text-muted fst-italic small"},Iv={class:"node-row"},Pv={class:"node-left"},jv={key:0,class:"me-2"},Rv={key:1,class:"badge bg-secondary ms-2"},Bv={class:"node-right"},Fv={key:0,class:"latest-message-preview"},Vv={key:0,class:"message-prefix"},Wv=["title"],Uv={key:1,class:"message-time ms-1"},Hv={key:1,class:"last-comm-preview"},qv={class:"comm-direction"},zv=["title"],Kv={key:2,class:"text-muted fst-italic small"},Gv={class:"node-actions"},Yv={key:2,class:"minion-children"},Jv={key:1,class:"text-danger small ms-4"},Qv={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,a=pe(),c=Pe(),u=xe(),f=h(()=>!s.minionData||!s.minionData.id?null:a.getSession(s.minionData.id)),m=h(()=>{if(!s.minionData||!s.minionData.id)return null;const C=c.messagesBySession.get(s.minionData.id);if(!C||C.length===0)return null;for(let M=C.length-1;M>=0;M--){const W=C[M],B=W.subtype||W.metadata?.subtype;if(W.type!=="result"&&!(W.type==="system"&&B==="init")&&!(W.type==="system"&&B==="task_notification")&&!(W.type==="permission_request"||W.type==="permission_response")){if(W.type==="user"&&W.metadata?.has_tool_results){const F=W.content||"";if(F.match(/^Tool results?: \d+ results?$/i)||F.trim()==="")continue}if(W.type==="user"){const F=W.content||"";if(F.includes("<command-message>")&&F.includes("skill is running")||F.startsWith("Base directory for this skill:"))continue}if(W.type==="user"){const F=W.content||"";if(F.includes("<command-message>")&&F.includes("<command-name>")&&F.includes("<command-args>")||F.includes("ARGUMENTS:")&&(F.includes("<command-name>")||F.match(/\nARGUMENTS:/)))continue}if(!(W.type==="system"&&W.content==="System message")&&!(W.type==="assistant"&&W.content==="Assistant response")&&(W.type==="user"||W.type==="assistant"||W.type==="system"))return{content:W.content,type:W.type,timestamp:W.timestamp}}}return null}),p=h(()=>{if(!s.minionData)return null;const C={...s.minionData};return f.value&&(C.state=f.value.state,C.is_processing=f.value.is_processing,f.value.name&&(C.name=f.value.name),f.value.latest_message&&(C.latest_message=f.value.latest_message,C.latest_message_type=f.value.latest_message_type,C.latest_message_time=f.value.latest_message_time)),m.value&&(C.latest_message=m.value.content,C.latest_message_type=m.value.type,C.latest_message_time=m.value.timestamp),C}),d=h(()=>s.level*24),$=h(()=>!s.minionData||!s.minionData.id?!1:a.currentSessionId===s.minionData.id),v=h(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),g=h(()=>s.minionData&&s.minionData.is_overseer&&v.value),w=h(()=>{const C=p.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),_=h(()=>{const C=w.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),b=h(()=>{const C=w.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),y=h(()=>{const C=p.value;if(!C||!C.latest_message_type)return"";const M=C.latest_message_type;return M==="user"?"User -->:":M==="system"?"System:":""}),l=h(()=>{const C=p.value;if(!C||!C.latest_message)return"";const M=C.latest_message,W=150;return M.length>W?M.slice(0,W)+"...":M}),S=h(()=>{const C=p.value;if(!C||!C.latest_message_time)return"";try{const M=Date.now();let W;if(typeof C.latest_message_time=="number"?W=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:W=new Date(C.latest_message_time).getTime(),isNaN(W)||W<9466848e5||W>M+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",W),"";const B=M-W;if(B<0)return"just now";const F=Math.floor(B/6e4),V=Math.floor(F/60),G=Math.floor(V/24);return G>0?`${G}d ago`:V>0?`${V}h ago`:F>0?`${F}m ago`:"just now"}catch(M){return console.error("Error calculating relative time:",M,C.latest_message_time),""}});function x(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function T(C){const M=C.summary||C.content||"";return M.length>150?M.substring(0,150)+"...":M}function D(){o("minion-click",s.minionData.id)}function A(){const C=a.sessions.get(s.minionData.id);C&&u.showModal("edit-session",{session:C})}function N(){const C=a.sessions.get(s.minionData.id);C&&u.showModal("manage-session",{session:C})}return(C,M)=>{const W=cn("MinionTreeNode",!0);return n.minionData?(i(),r("div",{key:0,class:"minion-tree-node",style:je({marginLeft:`${d.value}px`})},[n.layout==="sidebar"?(i(),r("div",{key:0,class:H(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:D},[t("div",{class:H(["status-dot me-2",_.value]),style:je(b.value)},null,6),t("div",$v,[t("div",Sv,[g.value?(i(),r("span",xv,"ðŸ‘‘")):E("",!0),t("strong",null,k(p.value?.name||n.minionData.name),1),g.value?(i(),r("span",Cv,k(n.minionData.children.length)+" "+k(n.minionData.children.length===1?"child":"children"),1)):E("",!0)]),p.value?.latest_message?(i(),r("div",Ev,[y.value?(i(),r("span",Tv,k(y.value),1)):E("",!0),t("span",{class:"activity-content",title:p.value.latest_message},k(l.value),9,Av),S.value?(i(),r("span",Dv,"("+k(S.value)+")",1)):E("",!0)])):n.minionData?.last_comm?(i(),r("div",Mv,[t("span",Ov,[M[1]||(M[1]=ce("â†’ ",-1)),t("strong",null,k(x(n.minionData.last_comm)),1),M[2]||(M[2]=ce(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},k(T(n.minionData.last_comm)),9,Lv)])):(i(),r("div",Nv," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ye(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ye(N,["stop"])}," âš™ï¸ ")],2)):(i(),r("div",{key:1,class:H(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:D},[t("div",Iv,[t("div",Pv,[t("div",{class:H(["status-dot me-2",_.value]),style:je(b.value)},null,6),g.value?(i(),r("span",jv,"ðŸ‘‘")):E("",!0),t("strong",null,k(p.value?.name||n.minionData.name),1),g.value?(i(),r("span",Rv,k(n.minionData.children.length)+" "+k(n.minionData.children.length===1?"child":"children"),1)):E("",!0)]),t("div",Bv,[p.value?.latest_message?(i(),r("div",Fv,[y.value?(i(),r("span",Vv,k(y.value),1)):E("",!0),t("span",{class:"message-content",title:p.value.latest_message},k(l.value),9,Wv),S.value?(i(),r("span",Uv,"("+k(S.value)+")",1)):E("",!0)])):n.minionData?.last_comm?(i(),r("div",Hv,[t("span",qv,[M[3]||(M[3]=ce("â†’ ",-1)),t("strong",null,k(x(n.minionData.last_comm)),1),M[4]||(M[4]=ce(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},k(T(n.minionData.last_comm)),9,zv)])):(i(),r("div",Kv," No activity yet "))]),t("div",Gv,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ye(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ye(N,["stop"])}," âš™ï¸ ")])])],2)),v.value?(i(),r("div",Yv,[(i(!0),r(se,null,le(n.minionData.children,B=>(i(),Te(W,{key:B.id,"minion-data":B,level:n.level+1,layout:n.layout,onMinionClick:M[0]||(M[0]=F=>C.$emit("minion-click",F))},null,8,["minion-data","level","layout"]))),128))])):E("",!0)],4)):(i(),r("div",Jv," âš  Minion data is missing "))}}},Xv=te(Qv,[["__scopeId","data-v-64b23e0e"]]),Zv={class:"project-overview d-flex flex-column h-100"},eh={class:"project-overview-header border-bottom p-3"},th={class:"d-flex align-items-center justify-content-between"},sh={class:"mb-1"},nh={key:0,class:"me-2"},oh={class:"text-muted font-monospace"},ah={class:"d-flex gap-2"},ih=["title"],lh={class:"project-overview-content flex-grow-1 overflow-auto p-3"},rh={key:0,class:"text-center py-5"},ch={key:1,class:"alert alert-danger"},uh={key:2,class:"text-center py-5"},dh={key:3},fh={class:"row g-3 mb-4"},mh={class:"col-md-4"},ph={class:"card h-100"},vh={class:"card-body"},hh={class:"card-title mb-0"},_h={class:"text-muted"},gh={class:"col-md-4"},bh={class:"card h-100"},yh={class:"card-body"},wh={class:"card-title mb-0"},kh={class:"text-muted"},$h={key:0,class:"card mb-4"},Sh={class:"card mb-4"},xh={class:"card-header d-flex align-items-center justify-content-between"},Ch={class:"mb-0"},Eh={class:"badge bg-secondary"},Th={class:"card-body"},Ah={key:0,class:"text-center py-4"},Dh={key:1,class:"text-center text-muted py-4"},Mh={key:2,class:"hierarchy-tree"},Oh={class:"user-root-node mb-3 border rounded bg-white"},Lh={class:"node-row"},Nh={class:"node-left"},Ih={class:"badge bg-primary ms-2"},Ph={class:"node-right"},jh={key:0,class:"last-comm-preview"},Rh={class:"comm-direction"},Bh=["title"],Fh={key:1,class:"text-muted fst-italic"},Vh={class:"root-minions ms-4"},Wh={class:"card"},Uh={class:"card-body"},Hh={class:"row mb-0"},qh={class:"col-sm-8 font-monospace text-break"},zh={class:"col-sm-8 font-monospace text-break"},Kh={class:"col-sm-8"},Gh={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},Yh={class:"text-muted"},Jh={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=ts(),o=qe(),a=pe(),c=xe(),u=Wt(),f=rt(),m=O(!1),p=O(null),d=O(null),$=O(!1);let v=null;const g=h(()=>o.getProject(e.projectId)),w=h(()=>g.value?.session_ids?g.value.session_ids.map(V=>a.getSession(V)).filter(V=>V!=null):[]),_=h(()=>w.value.length>0),b=h(()=>w.value.length),y=h(()=>w.value.filter(V=>V.state==="ACTIVE").length),l=h(()=>{const V=w.value.some(L=>L.state==="ACTIVE"),G=w.value.some(L=>L.is_processing);return w.value.some(L=>L.state==="ERROR")?"Error":G?"Working":V?"Active":b.value>0?"Idle":"Empty"}),S=h(()=>{switch(l.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),x=h(()=>{switch(l.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function T(){$.value=!0;try{const V=await ge.get(`/api/legions/${e.projectId}/hierarchy`);d.value=V}catch(V){console.error("Failed to load minion hierarchy:",V),d.value=null}finally{$.value=!1}}function D(V,G){if(V&&V.id===G)return V;if(V&&V.children)for(const I of V.children){const L=D(I,G);if(L)return L}return null}function A(V){return V.to_user?"User":V.to_minion_name?V.to_minion_name:"unknown"}function N(V){const G=V.summary||V.content||"";return G.length>150?G.substring(0,150)+"...":G}function C(V){if(d.value){if(V.from_minion_id){const G=D(d.value,V.from_minion_id);G&&G.type==="minion"&&(G.last_comm=V)}V.from_user&&d.value.type==="user"&&(d.value.last_comm=V)}}function M(V){s.push(`/session/${V}`)}function W(){s.push(`/timeline/${e.projectId}`)}function B(){c.showModal("edit-project",{project:g.value})}function F(){c.showModal("create-minion",{project:g.value})}return Me(()=>{o.selectProject(e.projectId),a.currentSessionId=null,T(),u.setCurrentLegion(e.projectId),f.connectLegion(e.projectId),v=fe(()=>a.sessions,V=>{if(d.value){for(const[G,I]of V)if(I.project_id===e.projectId){const L=D(d.value,G);L&&L.type==="minion"&&(L.state!==I.state&&(L.state=I.state),L.is_processing!==I.is_processing&&(L.is_processing=I.is_processing),L.latest_message!==I.latest_message&&(L.latest_message=I.latest_message,L.latest_message_type=I.latest_message_type,L.latest_message_time=I.latest_message_time))}}},{deep:!0}),fe(()=>u.commsByLegion.get(e.projectId),V=>{if(V&&V.length>0){const G=V[V.length-1];C(G)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(V,G)=>{V!==G&&T()})}),fe(()=>e.projectId,V=>{o.selectProject(V),a.currentSessionId=null,T(),u.setCurrentLegion(V),f.connectLegion(V)}),De(()=>{v&&v()}),(V,G)=>(i(),r("div",Zv,[t("div",eh,[t("div",th,[t("div",null,[t("h4",sh,[_.value?(i(),r("span",nh,"ðŸ›")):E("",!0),ce(" "+k(g.value?.name||"Project Overview"),1)]),t("small",oh,k(g.value?.working_directory),1)]),t("div",ah,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:B}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:_.value?"Create minion":"Add session",onClick:F}," âž• "+k(_.value?"Add Minion":"Add Session"),9,ih)])])]),t("div",lh,[m.value?(i(),r("div",rh,[...G[0]||(G[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(i(),r("div",ch,k(p.value),1)):g.value?(i(),r("div",dh,[t("div",fh,[t("div",mh,[t("div",ph,[t("div",vh,[G[2]||(G[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",hh,k(b.value),1),t("small",_h,k(y.value)+" active",1)])])]),t("div",gh,[t("div",bh,[t("div",yh,[G[3]||(G[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",wh,[t("span",{class:H(S.value)},k(l.value),3)]),t("small",kh,k(x.value),1)])])])]),_.value?(i(),r("div",$h,[G[4]||(G[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:W}," ðŸ“Š View Timeline ")])])])):E("",!0),t("div",Sh,[t("div",xh,[t("h5",Ch,"ðŸŒ³ "+k(_.value?"Minion Hierarchy":"Sessions"),1),t("span",Eh,k(w.value.length),1)]),t("div",Th,[$.value?(i(),r("div",Ah,[...G[5]||(G[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!d.value||!d.value.children||d.value.children.length===0?(i(),r("div",Dh,' No sessions yet. Click "Add Session" to create one. ')):(i(),r("div",Mh,[t("div",Oh,[t("div",Lh,[t("div",Nh,[G[6]||(G[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,k(d.value.name),1),t("span",Ih,k(d.value.children.length)+" "+k(d.value.children.length===1?"minion":"minions"),1)]),t("div",Ph,[d.value.last_comm?(i(),r("div",jh,[t("span",Rh,[G[7]||(G[7]=ce(" â†’ ",-1)),t("strong",null,k(A(d.value.last_comm)),1),G[8]||(G[8]=ce(": ",-1))]),t("span",{class:"comm-content",title:d.value.last_comm.content||""},k(N(d.value.last_comm)),9,Bh)])):(i(),r("div",Fh," No communications yet "))])])]),t("div",Vh,[(i(!0),r(se,null,le(d.value.children,I=>(i(),Te(Xv,{key:I.id,"minion-data":I,level:1,layout:"two-column",onMinionClick:M},null,8,["minion-data"]))),128))])]))])]),t("div",Wh,[G[12]||(G[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",Uh,[t("dl",Hh,[G[9]||(G[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",qh,k(g.value.working_directory),1),G[10]||(G[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",zh,k(g.value.project_id),1),G[11]||(G[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",Kh,k(_.value?"Yes (has minions)":"No"),1)])])])])):(i(),r("div",uh,[...G[1]||(G[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",Gh,[G[13]||(G[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",Yh,k(b.value)+" session"+k(b.value!==1?"s":""),1)])]))}},Qh=te(Jh,[["__scopeId","data-v-168bf04c"]]),Xh=[{path:"/",name:"home",component:Ka},{path:"/project/:projectId",name:"project",component:Qh,props:!0},{path:"/session/:sessionId",name:"session",component:Dp,props:!0},{path:"/timeline/:legionId",name:"timeline",component:kv,props:!0}],Zh=Fa({history:Va(),routes:Xh}),e_={class:"header-row1"},t_={class:"header-right"},s_=["title"],n_={__name:"HeaderRow1",setup(n){const e=xe(),s=rt(),o=h(()=>s.uiConnected);return(a,c)=>(i(),r("div",e_,[c[6]||(c[6]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",t_,[t("div",{class:H(["header-indicator",o.value?"connected":"disconnected"])},[c[3]||(c[3]=t("span",{class:"indicator-dot"},null,-1)),ce(" "+k(o.value?"Connected":"Disconnected"),1)],2),t("button",{class:H(["header-btn theme-toggle-btn",{"theme-active":ne(e).isRedBackground}]),onClick:c[0]||(c[0]=u=>ne(e).toggleBackgroundColor()),title:ne(e).isRedBackground?"Disable sensitive environment mode":"Enable sensitive environment mode"},[...c[4]||(c[4]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})],-1)])],10,s_),t("button",{class:"header-btn",onClick:c[1]||(c[1]=u=>ne(e).showRestartModal()),title:"Restart server"}," â†» "),c[5]||(c[5]=t("button",{class:"header-btn",disabled:"",title:"Settings (coming soon)",style:{opacity:"0.4",cursor:"default"}}," âš™ ",-1)),t("button",{class:H(["header-btn panel-toggle-btn",{"panel-open":ne(e).rightPanelVisible}]),onClick:c[2]||(c[2]=u=>ne(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},o_=te(n_,[["__scopeId","data-v-2d22058c"]]),a_=["title"],i_={class:"pill-icon"},l_={class:"pill-name"},r_={key:0,class:"pill-count"},c_={class:"pill-status-bar"},u_={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=qe(),o=pe(),a=xe(),c=h(()=>e.project.session_ids?.length||0),u=h(()=>c.value>1?"ðŸ”·":c.value===1?"ðŸ’¬":"ðŸ“"),f=h(()=>s.getStatusBarSegments(e.project.project_id,o));function m(){a.setBrowsingProject(e.project.project_id)}function p(){a.showModal("edit-project",{project:e.project})}return(d,$)=>(i(),r("div",{class:H(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:m,onContextmenu:ye(p,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",i_,k(u.value),1),t("span",l_,k(n.project.name),1),c.value>0?(i(),r("span",r_,k(c.value),1)):E("",!0),t("div",c_,[(i(!0),r(se,null,le(f.value,(v,g)=>(i(),r("div",{key:g,class:H(["seg",v.status]),style:je({flex:v.flex})},null,6))),128))])],42,a_))}},d_=te(u_,[["__scopeId","data-v-ecccd6e9"]]),f_={__name:"ProjectPillBar",setup(n){const e=qe(),s=pe(),o=xe(),a=h(()=>e.orderedProjects),c=h(()=>o.browsingProjectId),u=h(()=>{const m=s.currentSession;return m?m.project_id:null});fe(u,m=>{m&&o.setBrowsingProject(m)}),fe(a,m=>{!c.value&&m.length>0&&o.setBrowsingProject(m[0].project_id)},{immediate:!0});function f(){o.showModal("create-project")}return(m,p)=>(i(),r("div",{class:H(["project-pill-bar",{"theme-red":ne(o).isRedBackground}])},[(i(!0),r(se,null,le(a.value,d=>(i(),Te(d_,{key:d.project_id,project:d,isActive:d.project_id===u.value,isBrowsing:d.project_id===c.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:f,title:"New project"}," + ")],2))}},m_=te(f_,[["__scopeId","data-v-fcc3f866"]]),p_=["title"],v_={class:"ac-info"},h_={class:"ac-name"},__={class:"ac-status"},g_={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select"],setup(n,{emit:e}){const s=n,o=e;pe();const a=h(()=>s.session.name||s.session.role||"Agent"),c=h(()=>{const d=s.session.state;return d==="error"?"error":d==="paused"?"waiting":d==="active"&&s.session.is_processing?"active":d==="active"?"idle":"none"}),u=h(()=>{const d=s.session.state;return d==="active"&&s.session.is_processing?"Processing...":d==="active"?"Idle":d==="paused"?"Awaiting input":d==="error"?"Error":d==="terminated"?"Stopped":d==="starting"?"Starting...":d==="created"?"Ready":d||"Unknown"}),f=h(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),m=h(()=>{const d=[a.value];return s.session.role&&d.push(`Role: ${s.session.role}`),d.push(`Status: ${u.value}`),s.session.model&&d.push(`Model: ${s.session.model}`),d.join(`
`)});function p(){o("select",s.session.session_id)}return(d,$)=>(i(),r("div",{class:H(["agent-chip",{active:n.isActive,child:n.variant==="child"}]),onClick:p,title:m.value},[t("div",{class:H(["ac-dot",c.value])},null,2),t("div",v_,[t("div",h_,k(a.value),1),t("div",__,k(u.value),1)]),f.value?(i(),r("div",{key:0,class:H(["ac-alert",f.value])},k(f.value==="error"?"!":"?"),3)):E("",!0)],10,p_))}},en=te(g_,[["__scopeId","data-v-f9f7aad4"]]),b_=["title"],y_={class:"peek-letter"},w_={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=pe(),o=h(()=>s.getSession(e.sessionId)),a=h(()=>(o.value?.name||o.value?.role||"?").charAt(0).toUpperCase()),c=h(()=>({right:`${-22-e.index*22}px`,zIndex:20-e.index})),u=h(()=>{if(!o.value)return"dot-none";const p=o.value.state;return p==="active"&&o.value.is_processing?"dot-active":p==="active"?"dot-idle":p==="paused"?"dot-waiting":p==="error"?"dot-error":"dot-none"}),f=h(()=>o.value?o.value.has_pending_permission||o.value.state==="error":!1),m=h(()=>o.value?o.value.state==="error"?"alert-error":"alert-permission":"");return(p,d)=>(i(),r("div",{class:"peek-card",style:je(c.value),title:o.value?.name||"Child agent",onClick:d[0]||(d[0]=ye($=>p.$emit("click"),["stop"]))},[t("div",{class:H(["peek-dot",u.value])},null,2),t("span",y_,k(a.value),1),f.value?(i(),r("div",{key:0,class:H(["peek-alert",m.value])},null,2)):E("",!0)],12,b_))}},k_=te(w_,[["__scopeId","data-v-7f1d4c1b"]]),Fn=44,Vn=12,$_={__name:"ChipConnector",props:{depth:{type:Number,default:1},maxDepth:{type:Number,default:1}},setup(n){const e=n,s=Fn-Vn*2,o=h(()=>{const a=e.maxDepth;let c;if(a<=1)c=Fn/2;else{const u=(e.depth-1)/(a-1);c=Vn+u*s}return{alignSelf:"flex-start",marginTop:`${Math.round(c)}px`}});return(a,c)=>(i(),r("div",{class:"chip-connector",style:je(o.value)},null,4))}},S_=te($_,[["__scopeId","data-v-08d20738"]]),x_=["title"],C_=Object.assign({name:"StackedChip"},{__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},depth:{type:Number,default:1},maxDepth:{type:Number,default:0}},emits:["select"],setup(n){const e=n,s=pe(),o=xe(),a=h(()=>s.currentSessionId),c=h(()=>e.session.child_minion_ids||[]);function u(y,l){if(!y?.child_minion_ids?.length)return l;let S=l;for(const x of y.child_minion_ids){const T=s.getSession(x);T&&(S=Math.max(S,u(T,l+1)))}return S}const f=h(()=>e.maxDepth>0?e.maxDepth:u(e.session,0)),m=h(()=>{if(!a.value)return!1;function y(l){if(!l)return!1;for(const S of l){if(S===a.value)return!0;const x=s.getSession(S);if(x?.child_minion_ids&&y(x.child_minion_ids))return!0}return!1}return y(c.value)}),p=h(()=>o.expandedStacks.has(e.session.session_id)||m.value),d=h(()=>c.value),$=h(()=>p.value||c.value.length===0?{}:{marginRight:`${c.value.length*22}px`});function v(y){return s.getSession(y)}function g(y){return s.getSession(y)?.child_minion_ids?.length>0}function w(y){const l=s.getSession(y);return l?.child_minion_ids?l.child_minion_ids.includes(a.value):!1}function _(){o.toggleStack(e.session.session_id)}function b(){p.value||o.toggleStack(e.session.session_id)}return(y,l)=>{const S=cn("StackedChip",!0);return i(),r("div",{class:"stacked-chip",style:je($.value)},[t("div",{class:H(["parent-wrapper",{"has-children":c.value.length>0}])},[be(en,{session:n.session,isActive:n.isActive,onSelect:l[0]||(l[0]=x=>y.$emit("select",n.session.session_id)),onDblclick:_},null,8,["session","isActive"]),!p.value&&c.value.length>0?(i(!0),r(se,{key:0},le(d.value,(x,T)=>(i(),Te(k_,{key:x,sessionId:x,index:T,onClick:b},null,8,["sessionId","index"]))),128)):E("",!0),c.value.length>0?(i(),r("div",{key:1,class:"stack-count",onClick:ye(_,["stop"]),title:`${c.value.length} child agent${c.value.length!==1?"s":""}`},k(c.value.length),9,x_)):E("",!0)],2),p.value?(i(!0),r(se,{key:0},le(c.value,x=>(i(),r(se,{key:x},[be(S_,{depth:n.depth,maxDepth:f.value},null,8,["depth","maxDepth"]),v(x)&&g(x)?(i(),Te(S,{key:0,session:v(x),isActive:x===a.value||w(x),depth:n.depth+1,maxDepth:f.value,onSelect:l[1]||(l[1]=T=>y.$emit("select",T))},null,8,["session","isActive","depth","maxDepth"])):v(x)?(i(),Te(en,{key:1,session:v(x),isActive:x===a.value,variant:"child",onSelect:T=>y.$emit("select",x)},null,8,["session","isActive","onSelect"])):E("",!0)],64))),128)):E("",!0)],4)}}}),E_=te(C_,[["__scopeId","data-v-720fecbd"]]),T_={class:"strip-project-label"},A_={key:0,class:"strip-empty"},D_={__name:"AgentStrip",setup(n){const e=qe(),s=pe(),o=xe(),a=ts(),c=O(null),u=h(()=>{const l=s.currentSession;return l?l.project_id:null});function f(l){const S=c.value&&c.value.contains(l.target),x=l.target.closest(".project-pill-bar");!S&&!x&&(o.collapseAllStacks(),u.value&&o.browsingProjectId!==u.value&&o.setBrowsingProject(u.value))}Me(()=>{document.addEventListener("click",f,!0)}),De(()=>{document.removeEventListener("click",f,!0)});const m=h(()=>s.currentSessionId),p=h(()=>{const l=o.browsingProjectId;return l?e.getProject(l):null}),d=h(()=>{const l=p.value;return!l||!l.session_ids?[]:l.session_ids.map(S=>s.getSession(S)).filter(Boolean).sort((S,x)=>(S.order||0)-(x.order||0))}),$=h(()=>{const l=new Set;for(const S of d.value)if(S.child_minion_ids)for(const x of S.child_minion_ids)l.add(x);return l}),v=h(()=>d.value.filter(l=>!$.value.has(l.session_id)));function g(l){return l.child_minion_ids&&l.child_minion_ids.length>0}function w(l){return l.child_minion_ids?l.child_minion_ids.includes(m.value):!1}function _(l){const S=s.getSession(l);S&&o.setBrowsingProject(S.project_id),s.selectSession(l),a.push(`/session/${l}`)}function b(l){l.target.classList.contains("agent-strip")&&o.collapseAllStacks()}function y(){const l=p.value;l&&o.showModal("create-minion",{project:l})}return(l,S)=>p.value?(i(),r("div",{key:0,class:H(["agent-strip",{"theme-red":ne(o).isRedBackground}]),ref_key:"stripEl",ref:c,onClick:b},[t("span",T_,k(p.value.name),1),(i(!0),r(se,null,le(v.value,x=>(i(),r(se,{key:x.session_id},[g(x)?(i(),Te(E_,{key:0,session:x,isActive:x.session_id===m.value||w(x),onSelect:_},null,8,["session","isActive"])):(i(),Te(en,{key:1,session:x,isActive:x.session_id===m.value,onSelect:_},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:ye(y,["stop"]),title:"Add agent"}," + "),v.value.length===0?(i(),r("span",A_,"No agents yet")):E("",!0)],2)):(i(),r("div",{key:1,class:H(["agent-strip agent-strip-empty",{"theme-red":ne(o).isRedBackground}])},[...S[0]||(S[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])],2))}},M_=te(D_,[["__scopeId","data-v-31dc5efd"]]),dn=tt("diff",()=>{const n=O(new Map),e=O(!1),s=O(null),o=O("total"),a=O(!1),c=O(null),u=O(null),f=O(null),m=O(new Map),p=h(()=>{const C=pe();return C.currentSessionId&&n.value.get(C.currentSessionId)||null}),d=h(()=>!p.value||!p.value.files?[]:Object.entries(p.value.files).map(([C,M])=>({path:C,...M})).sort((C,M)=>C.path.localeCompare(M.path))),$=h(()=>d.value.length),v=h(()=>!p.value||!p.value.commits?0:p.value.commits.length),g=h(()=>p.value?.is_git_repo===!0),w=h(()=>{const C=f.value;if(C&&C!=="uncommitted"){const M=p.value;if(M?.commits){const W=M.commits.find(B=>B.hash===C);if(W?.files)return W.files.map(B=>({path:B})).sort((B,F)=>B.path.localeCompare(F.path))}return[]}return d.value}),_=h(()=>{if(!c.value||!u.value)return null;const C=f.value||"committed",M=`${c.value}:${C}:${u.value}`;return m.value.get(M)||null});async function b(C){if(C){e.value=!0,s.value=null;try{const M=await Xt(`/api/sessions/${C}/diff`);n.value.set(C,M),n.value=new Map(n.value)}catch(M){console.error(`Failed to load diff for session ${C}:`,M),s.value=M.message}finally{e.value=!1}}}async function y(C){for(const M of m.value.keys())M.startsWith(`${C}:`)&&m.value.delete(M);m.value=new Map(m.value),await b(C)}async function l(C,M,W=null){if(!C||!M)return;const F=`${C}:${W||"committed"}:${M}`,V=m.value.get(F);if(!(V&&!V.error&&V.content!==null)){m.value.set(F,{content:null,loading:!0,error:null}),m.value=new Map(m.value);try{const G={path:M};W&&(G.ref=W);const I=await Xt(`/api/sessions/${C}/diff/file`,{params:G});m.value.set(F,{content:I.diff,loading:!1,error:null})}catch(G){console.error(`Failed to load file diff for ${M}:`,G),m.value.set(F,{content:null,loading:!1,error:G.message})}m.value=new Map(m.value)}}function S(C,M,W=null){c.value=C,u.value=M,f.value=W,a.value=!0,l(C,M,W)}function x(){a.value=!1,f.value=null}function T(){if(!c.value)return;const C=w.value;if(C.length===0)return;const W=(C.findIndex(B=>B.path===u.value)+1)%C.length;u.value=C[W].path,l(c.value,u.value,f.value)}function D(){if(!c.value)return;const C=w.value;if(C.length===0)return;const W=(C.findIndex(B=>B.path===u.value)-1+C.length)%C.length;u.value=C[W].path,l(c.value,u.value,f.value)}function A(C){o.value=C}function N(C){n.value.delete(C),n.value=new Map(n.value);for(const M of m.value.keys())M.startsWith(`${C}:`)&&m.value.delete(M);m.value=new Map(m.value),c.value===C&&x()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:a,fullViewSessionId:c,currentFilePath:u,fullViewRef:f,fileDiffCache:m,currentDiff:p,currentFiles:d,fileCount:$,commitCount:v,isGitRepo:g,fullViewFiles:w,currentFullViewFileDiff:_,loadDiff:b,refreshDiff:y,loadFileDiff:l,openFullView:S,closeFullView:x,nextFile:T,prevFile:D,setMode:A,clearDiff:N}}),O_={key:0,class:"agent-overview"},L_={class:"overview-identity"},N_={class:"overview-info"},I_={class:"overview-name"},P_={key:0,class:"overview-role"},j_={class:"overview-stats"},R_={class:"stat-item"},B_={class:"stat-value"},F_={class:"stat-item"},V_={class:"stat-value"},W_={class:"stat-item"},U_={class:"stat-value"},H_={class:"stat-item"},q_={class:"stat-value"},z_={key:1,class:"agent-overview agent-overview-empty"},K_={__name:"AgentOverview",setup(n){const e=pe(),s=Pe(),o=xe(),a=O(Date.now());let c=null;Me(()=>{c=setInterval(()=>{a.value=Date.now()},1e4)}),De(()=>{c&&clearInterval(c)});const u=h(()=>{const l=e.currentSessionId;return l?e.getSession(l):null}),f=h(()=>(u.value?.name||"A").charAt(0).toUpperCase()),m=h(()=>{const l=u.value?.name||"";let S=0;for(let T=0;T<l.length;T++)S=l.charCodeAt(T)+((S<<5)-S);return`hsl(${Math.abs(S%360)}, 60%, 55%)`}),p=h(()=>{if(!u.value)return"status-none";const l=u.value.state;return l==="active"&&u.value.is_processing?"status-active":l==="active"?"status-idle":l==="paused"?"status-waiting":l==="error"?"status-error":l==="terminated"?"status-terminated":"status-none"}),d=h(()=>{if(!u.value)return"None";const l=u.value.state;return l==="active"&&u.value.is_processing?"Processing":l==="active"?"Idle":l==="paused"?"Paused":l==="error"?"Error":l==="terminated"?"Terminated":l==="created"?"Created":l==="starting"?"Starting":l}),$=h(()=>{const l=e.currentSessionId;if(!l)return 0;const S=s.messagesBySession.get(l);return S?S.filter(x=>x.type==="user"||x.type==="assistant").length:0}),v=h(()=>{const l=e.currentSessionId;if(!l)return 0;const S=s.toolCallsBySession.get(l);return S?S.length:0}),g=h(()=>u.value&&u.value.child_minion_ids?.length||0),w=h(()=>{const l=e.currentSessionId;if(!l)return"--";const S=s.launchTimestampBySession.get(l);if(!S)return"--";const x=S*1e3;a.value;let T;const D=u.value?.state;D==="terminated"||D==="error"?T=u.value?.updated_at?new Date(u.value.updated_at).getTime():Date.now():T=Date.now();const A=T-x;if(A<0)return"--";if(A<6e4)return"< 1m";const N=Math.floor(A/6e4);if(N<60)return`${N}m`;const C=Math.floor(N/60);return C<24?`${C}h ${N%60}m`:`${Math.floor(C/24)}d ${C%24}h`});function _(){u.value&&o.showModal("edit-session",{session:u.value})}function b(){u.value&&o.showModal("manage-session",{session:u.value})}function y(){u.value&&o.showModal("session-info",{sessionId:u.value.session_id})}return(l,S)=>u.value?(i(),r("div",O_,[t("div",L_,[t("div",{class:"overview-avatar",style:je({background:m.value})},k(f.value),5),t("div",N_,[t("div",I_,k(u.value.name||"Agent"),1),u.value.role?(i(),r("div",P_,k(u.value.role),1)):E("",!0),t("span",{class:H(["overview-status-badge",p.value])},k(d.value),3)])]),t("div",j_,[t("div",R_,[t("span",B_,k($.value),1),S[0]||(S[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",F_,[t("span",V_,k(v.value),1),S[1]||(S[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",W_,[t("span",U_,k(g.value),1),S[2]||(S[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",H_,[t("span",q_,k(w.value),1),S[3]||(S[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview",onClick:y,title:"View session details"}," Info "),t("button",{class:"btn-overview",onClick:_,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:b,title:"Manage session lifecycle"}," Manage ")])])):(i(),r("div",z_,[...S[4]||(S[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},G_=te(K_,[["__scopeId","data-v-4ef00321"]]),Y_={class:"task-row d-flex align-items-center gap-2"},J_={key:0,class:"status-icon"},Q_={key:1,class:"status-icon"},X_=["title"],Z_={key:0,class:"task-details"},eg={key:0,class:"task-description mb-2"},tg={class:"description-content"},sg={key:1,class:"task-owner mb-2"},ng={class:"ms-1"},og={key:2,class:"task-blocked-by mb-2"},ag={key:3,class:"task-blocks"},ig={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=h(()=>e.task.status==="in_progress"),o=h(()=>e.task.status==="completed"?"âœ…":"â³"),a=h(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),c=h(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(u,f)=>(i(),r("div",{class:H(["task-item",c.value]),onClick:f[0]||(f[0]=m=>u.$emit("toggle"))},[t("div",Y_,[s.value?(i(),r("span",J_,[...f[1]||(f[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),r("span",Q_,k(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},k(a.value),9,X_),(i(),r("svg",{class:H(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),r("div",Z_,[n.task.description?(i(),r("div",eg,[f[3]||(f[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",tg,k(n.task.description),1)])):E("",!0),n.task.owner?(i(),r("div",sg,[f[4]||(f[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",ng,k(n.task.owner),1)])):E("",!0),n.task.blockedBy?.length>0?(i(),r("div",og,[f[5]||(f[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),r(se,null,le(n.task.blockedBy,m=>(i(),r("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+k(m),1))),128))])):E("",!0),n.task.blocks?.length>0?(i(),r("div",ag,[f[6]||(f[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),r(se,null,le(n.task.blocks,m=>(i(),r("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+k(m),1))),128))])):E("",!0)])):E("",!0)],2))}},lg=te(ig,[["__scopeId","data-v-0f96ae87"]]),rg={key:0,class:"queue-section"},cg={key:0,class:"badge bg-primary"},ug={key:0,class:"queue-items"},dg={class:"status-icon"},fg=["title"],mg=["onClick"],pg=["onClick"],vg={__name:"QueueSection",setup(n){const e=Lo(),s=pe(),o=O(!1),a=h(()=>s.currentSessionId);fe(a,w=>{w&&e.fetchQueue(w)},{immediate:!0});const c=h(()=>a.value?e.getItems(a.value):[]),u=h(()=>a.value?e.getPendingCount(a.value):0),f=h(()=>a.value?e.isPaused(a.value)?!0:s.sessions.get(a.value)?.queue_paused||!1:!1);function m(w){switch(w){case"sent":return"âœ‰";case"pending":return"â—‹";case"failed":return"âš ";case"cancelled":return"âœ•";default:return"â—‹"}}function p(w,_){return w?w.length>_?w.slice(0,_)+"...":w:""}async function d(w){a.value&&await e.cancelItem(a.value,w)}async function $(w){a.value&&await e.requeueItem(a.value,w)}async function v(){a.value&&await e.pauseQueue(a.value,!0)}async function g(){a.value&&await e.pauseQueue(a.value,!1)}return(w,_)=>c.value.length>0||f.value?(i(),r("div",rg,[t("div",{class:"queue-header d-flex align-items-center gap-2 px-3 py-2",onClick:_[0]||(_[0]=b=>o.value=!o.value)},[(i(),r("svg",{class:H(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[..._[1]||(_[1]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),_[2]||(_[2]=t("span",{class:"section-title"},"Message Queue",-1)),u.value>0?(i(),r("span",cg,k(u.value),1)):E("",!0),f.value?(i(),r("button",{key:1,class:"btn btn-sm btn-outline-success ms-auto",title:"Resume queue",onClick:ye(g,["stop"])}," Resume ")):u.value>0?(i(),r("button",{key:2,class:"btn btn-sm btn-outline-warning ms-auto",title:"Pause queue",onClick:ye(v,["stop"])}," Pause ")):E("",!0)]),o.value?E("",!0):(i(),r("div",ug,[(i(!0),r(se,null,le(c.value,b=>(i(),r("div",{key:b.queue_id,class:H(["queue-item d-flex align-items-center gap-2 px-3 py-1","status-"+b.status])},[t("span",dg,k(m(b.status)),1),t("span",{class:"item-content flex-grow-1",title:b.content},k(p(b.content,60)),9,fg),b.status==="pending"?(i(),r("button",{key:0,class:"btn btn-sm btn-link text-danger p-0",title:"Cancel",onClick:y=>d(b.queue_id)}," Ã— ",8,mg)):E("",!0),b.status==="sent"||b.status==="failed"?(i(),r("button",{key:1,class:"btn btn-sm btn-link text-primary p-0",title:"Re-queue",onClick:y=>$(b.queue_id)}," â†» ",8,pg)):E("",!0)],2))),128))]))])):E("",!0)}},hg=te(vg,[["__scopeId","data-v-0a46711c"]]),_g={class:"task-list-panel"},gg={class:"task-list p-2"},bg={key:0,class:"empty-placeholder"},yg={__name:"TaskListPanel",setup(n){const e=Zt(),s=O(new Set),o=h(()=>e.currentTasks);function a(c){s.value.has(c)?s.value.delete(c):s.value.add(c),s.value=new Set(s.value)}return(c,u)=>(i(),r("div",_g,[t("div",gg,[o.value.length===0?(i(),r("div",bg,[...u[0]||(u[0]=[t("span",null,"Tasks will appear here as the agent works",-1)])])):E("",!0),be(Wa,{name:"task-list",tag:"div"},{default:un(()=>[(i(!0),r(se,null,le(o.value,f=>(i(),Te(lg,{key:f.id,task:f,isExpanded:s.value.has(f.id),onToggle:m=>a(f.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]),be(hg)]))}},wg=te(yg,[["__scopeId","data-v-d63cd00c"]]),kg={class:"resource-gallery-panel"},$g={class:"resource-grid-container p-2"},Sg={key:0,class:"empty-placeholder"},xg={key:1,class:"resource-grid"},Cg=["onClick"],Eg=["onClick","title"],Tg=["src","alt"],Ag=["title","onClick"],Dg={class:"file-icon"},Mg={class:"file-ext"},Og={class:"resource-info"},Lg=["title"],Ng={class:"resource-actions"},Ig=["onClick"],Pg=["href","download"],jg={__name:"ResourceGallery",setup(n){const e=Qe(),s=pe(),o=Eo("addAttachmentFromResource",null),a=h(()=>e.currentResources);function c(_){return e.isImageResource(_)}function u(_){return e.getResourceIcon(_)}function f(_){const b=e.getResourceExtension(_);return b?b.toUpperCase().slice(1):""}function m(_){return e.getResourceUrl(s.currentSessionId,_)}function p(_){return e.getDownloadUrl(s.currentSessionId,_)}function d(_){e.openFullView(s.currentSessionId,_)}function $(_,b=18){return _?_.length<=b?_:_.substring(0,b-3)+"...":""}function v(_){_.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function g(_){e.removeResource(s.currentSessionId,_)}function w(_){o?o(_):console.warn("addAttachmentFromResource not provided")}return(_,b)=>(i(),r("div",kg,[t("div",$g,[a.value.length===0?(i(),r("div",Sg,[...b[1]||(b[1]=[t("span",null,"Resources shared by the agent will appear here",-1)])])):(i(),r("div",xg,[(i(!0),r(se,null,le(a.value,(y,l)=>(i(),r("div",{key:y.resource_id,class:H(["resource-item",{"is-image":c(y)}])},[t("button",{class:"remove-btn",onClick:ye(S=>g(y.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...b[2]||(b[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,Cg),c(y)?(i(),r("div",{key:0,class:"resource-thumbnail",onClick:S=>d(l),title:y.title||"Click to view"},[t("img",{src:m(y.resource_id),alt:y.title||"Image",loading:"lazy",onError:v},null,40,Tg)],8,Eg)):(i(),r("div",{key:1,class:"resource-placeholder",title:y.title||y.original_filename||"Click to view",onClick:S=>d(l)},[t("span",Dg,k(u(y)),1),t("span",Mg,k(f(y)),1)],8,Ag)),t("div",Og,[t("div",{class:"resource-title",title:y.title||y.original_filename},k($(y.title||y.original_filename)),9,Lg),t("div",Ng,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ye(S=>w(y),["stop"]),title:"Add to message attachments"},[...b[3]||(b[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,Ig),t("a",{href:p(y.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:y.original_filename||y.title||"download",title:"Download",onClick:b[0]||(b[0]=ye(()=>{},["stop"]))},[...b[4]||(b[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,Pg)])])],2))),128))]))])]))}},Rg=te(jg,[["__scopeId","data-v-5b14b073"]]),Bg=["src","alt"],Fg={key:1,class:"resource-info"},Vg={key:0,class:"resource-title"},Wg={key:1,class:"resource-description"},Ug={class:"resource-meta"},Hg={class:"meta-item"},qg={class:"meta-item"},zg={class:"meta-item"},Kg={class:"text-header"},Gg={class:"text-header-info"},Yg={class:"text-filename"},Jg={class:"resource-meta"},Qg={key:0,class:"meta-item"},Xg={key:1,class:"meta-item"},Zg={key:0,class:"display-mode-toggle"},eb=["title","disabled"],tb={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},sb={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},nb={class:"copy-label"},ob={class:"text-body"},ab={key:0,class:"text-loading"},ib={key:1,class:"text-error"},lb={key:2,class:"text-content"},rb=["innerHTML"],cb={key:4,class:"text-unavailable"},ub={key:4,class:"position-indicator"},db={key:5,class:"thumbnail-strip"},fb=["onClick"],mb=["src","alt"],pb={key:1,class:"strip-text-icon"},vb={__name:"ResourceFullView",setup(n){Ke.setOptions({breaks:!0,gfm:!0});const e=Qe(),s=O(null),o=O(!1),a=O("raw");let c=null;const u=h(()=>e.fullViewOpen),f=h(()=>e.currentFullViewResource),m=h(()=>e.currentResourceIndex),p=h(()=>e.fullViewTotalResources),d=h(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),$=h(()=>e.isImageResource(f.value)),v=h(()=>f.value?e.getTextContent(f.value.resource_id):null),g=h(()=>v.value?.content||null),w=h(()=>v.value?.loading||!1),_=h(()=>v.value?.error||null),b=h(()=>{if(!g.value)return"";let B=Ke.parse(g.value);return B=B.replace(/\n</g,"<"),B=B.replace(/\n+$/,""),Vt.sanitize(B)});fe(u,B=>{B?(dt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),fe(m,()=>{a.value="raw"}),fe([m,u],()=>{if(u.value&&f.value&&!$.value){const B=f.value.resource_id,F=e.getTextContent(B);(!F||F.error)&&e.fetchTextContent(e.fullViewSessionId,B)}},{immediate:!0}),De(()=>{document.body.style.overflow="",c&&clearTimeout(c)});function y(B){return e.getResourceUrl(e.fullViewSessionId,B)}function l(){e.closeFullView()}function S(){e.nextResource()}function x(){e.prevResource()}function T(B){e.goToResource(B)}function D(B){B.target===B.currentTarget&&l()}function A(B){switch(B.key){case"Escape":l();break;case"ArrowLeft":x();break;case"ArrowRight":S();break;case"Home":T(0);break;case"End":T(p.value-1);break;case"m":!$.value&&g.value&&(a.value=a.value==="raw"?"markdown":"raw");break}}async function N(){if(g.value)try{await navigator.clipboard.writeText(g.value),o.value=!0,c&&clearTimeout(c),c=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function C(B){return B?B<1024?`${B} B`:B<1024*1024?`${(B/1024).toFixed(1)} KB`:`${(B/(1024*1024)).toFixed(2)} MB`:""}function M(B){return B?new Date(B*1e3).toLocaleString():""}function W(B){B.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(B,F)=>(i(),Te(Ao,{to:"body"},[be(To,{name:"modal"},{default:un(()=>[u.value?(i(),r("div",{key:0,class:"resource-full-view-overlay",onClick:D,onKeydown:A,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ye(l,["stop"]),title:"Close (Escape)"},[...F[4]||(F[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(i(),r("button",{key:0,class:"nav-btn nav-prev",onClick:ye(x,["stop"]),title:"Previous (Left Arrow)"},[...F[5]||(F[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):E("",!0),$.value?(i(),r("div",{key:1,class:"image-container",onClick:F[0]||(F[0]=ye(()=>{},["stop"]))},[f.value?(i(),r("img",{key:0,src:y(f.value.resource_id||f.value.image_id),alt:f.value.title||"Image",class:"full-image",onError:W},null,40,Bg)):E("",!0),f.value?(i(),r("div",Fg,[f.value.title?(i(),r("h5",Vg,k(f.value.title),1)):E("",!0),f.value.description?(i(),r("p",Wg,k(f.value.description),1)):E("",!0),t("div",Ug,[t("span",Hg,k(C(f.value.size_bytes)),1),t("span",qg,k(f.value.format?.toUpperCase()),1),t("span",zg,k(M(f.value.timestamp)),1)])])):E("",!0)])):(i(),r("div",{key:2,class:"text-container",onClick:F[3]||(F[3]=ye(()=>{},["stop"]))},[t("div",Kg,[t("div",Gg,[t("h5",Yg,k(f.value?.title||f.value?.original_filename||"Text Resource"),1),t("div",Jg,[f.value?.size_bytes?(i(),r("span",Qg,k(C(f.value.size_bytes)),1)):E("",!0),f.value?.format?(i(),r("span",Xg,k(f.value.format.toUpperCase()),1)):E("",!0)])]),g.value?(i(),r("div",Zg,[t("button",{class:H(["toggle-btn",{active:a.value==="raw"}]),onClick:F[1]||(F[1]=ye(V=>a.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:H(["toggle-btn",{active:a.value==="markdown"}]),onClick:F[2]||(F[2]=ye(V=>a.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):E("",!0),t("button",{class:"copy-btn",onClick:ye(N,["stop"]),title:o.value?"Copied!":a.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!g.value},[o.value?(i(),r("svg",tb,[...F[6]||(F[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),r("svg",sb,[...F[7]||(F[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",nb,k(o.value?"Copied!":a.value==="markdown"?"Copy raw":"Copy"),1)],8,eb)]),t("div",ob,[w.value?(i(),r("div",ab,[...F[8]||(F[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):_.value?(i(),r("div",ib," Failed to load content: "+k(_.value),1)):g.value&&a.value==="raw"?(i(),r("pre",lb,k(g.value),1)):g.value&&a.value==="markdown"?(i(),r("div",{key:3,class:"markdown-content",innerHTML:b.value},null,8,rb)):(i(),r("div",cb," Preview not available for this file type. "))])])),p.value>1?(i(),r("button",{key:3,class:"nav-btn nav-next",onClick:ye(S,["stop"]),title:"Next (Right Arrow)"},[...F[9]||(F[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):E("",!0),p.value>1?(i(),r("div",ub,k(m.value+1)+" / "+k(p.value),1)):E("",!0),p.value>1?(i(),r("div",db,[(i(!0),r(se,null,le(d.value,(V,G)=>(i(),r("div",{key:V.resource_id||V.image_id,class:H(["strip-thumbnail",{active:G===m.value,"is-text":!ne(e).isImageResource(V)}]),onClick:ye(I=>T(G),["stop"])},[ne(e).isImageResource(V)?(i(),r("img",{key:0,src:y(V.resource_id||V.image_id),alt:V.title||"Thumbnail",loading:"lazy"},null,8,mb)):(i(),r("span",pb,k(ne(e).getResourceIcon(V)),1))],10,fb))),128))])):E("",!0)],544)):E("",!0)]),_:1})]))}},hb=te(vb,[["__scopeId","data-v-169421b1"]]),_b={class:"diff-panel"},gb={class:"diff-body"},bb={key:0,class:"text-center py-4"},yb={key:1,class:"empty-placeholder"},wb={key:2,class:"empty-placeholder"},kb={key:3,class:"text-danger text-center py-4"},$b={class:"mb-0 small"},Sb={key:4,class:"empty-placeholder"},xb=["disabled"],Cb={key:5},Eb={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},Tb=["disabled"],Ab={class:"stats-bar px-3 py-1 border-bottom small text-muted"},Db={class:"text-success"},Mb={class:"text-danger"},Ob={class:"ms-2"},Lb={key:0,class:"ms-2"},Nb={key:0,class:"file-list"},Ib=["onClick"],Pb=["title"],jb={key:0,class:"file-stats small text-nowrap"},Rb={key:0,class:"text-success"},Bb={key:1,class:"text-muted"},Fb={key:2,class:"text-danger"},Vb={key:1,class:"file-stats small text-muted"},Wb={key:1,class:"commit-list"},Ub=["onClick"],Hb={key:0,class:"wip-badge"},qb={key:1,class:"commit-hash"},zb=["title"],Kb={key:2,class:"commit-date small text-muted text-nowrap"},Gb={key:0,class:"commit-files"},Yb=["onClick"],Jb=["title"],Qb={key:6,class:"empty-placeholder"},Xb={__name:"DiffPanel",setup(n){const e=dn(),s=pe(),o=O(new Set);function a(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function c(d,$=null){s.currentSessionId&&e.openFullView(s.currentSessionId,d,$)}function u(d){o.value.has(d)?o.value.delete(d):o.value.add(d),o.value=new Set(o.value)}function f(d){switch(d){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function m(d){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[d]?.status||"modified"}function p(d){if(!d)return"";const $=new Date(d),g=new Date-$,w=Math.floor(g/6e4);if(w<1)return"just now";if(w<60)return`${w}m ago`;const _=Math.floor(w/60);return _<24?`${_}h ago`:`${Math.floor(_/24)}d ago`}return fe(()=>s.currentSessionId,d=>{d&&!e.diffBySession.get(d)&&e.loadDiff(d)},{immediate:!0}),fe(()=>e.currentDiff,d=>{if(d?.commits){const $=d.commits.find(v=>v.is_uncommitted);$&&(o.value.add($.hash),o.value=new Set(o.value))}},{immediate:!0}),(d,$)=>(i(),r("div",_b,[t("div",gb,[ne(e).loading&&!ne(e).currentDiff?(i(),r("div",bb,[...$[2]||($[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):ne(e).currentDiff&&!ne(e).isGitRepo?(i(),r("div",yb,[...$[3]||($[3]=[t("span",null,"Not a git repository",-1)])])):ne(e).currentDiff&&ne(e).currentDiff.error?(i(),r("div",wb,[t("span",null,k(ne(e).currentDiff.error),1)])):ne(e).error?(i(),r("div",kb,[t("p",$b,k(ne(e).error),1)])):ne(e).currentDiff&&ne(e).fileCount===0?(i(),r("div",Sb,[$[6]||($[6]=t("span",null,"No changes since main",-1)),t("button",{class:"refresh-inline",onClick:a,disabled:ne(e).loading,title:"Refresh diff"},[(i(),r("svg",{class:H({spin:ne(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[4]||($[4]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2)),$[5]||($[5]=ce(" Refresh ",-1))],8,xb)])):ne(e).currentDiff&&ne(e).fileCount>0?(i(),r("div",Cb,[t("div",Eb,[t("button",{class:H(["btn btn-sm",ne(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:$[0]||($[0]=v=>ne(e).setMode("total"))}," Total Changes ",2),t("button",{class:H(["btn btn-sm",ne(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:$[1]||($[1]=v=>ne(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:a,title:"Refresh diff",disabled:ne(e).loading},[(i(),r("svg",{class:H({spin:ne(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[7]||($[7]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,Tb)]),t("div",Ab,[t("span",Db,"+"+k(ne(e).currentDiff.total_insertions),1),$[8]||($[8]=t("span",{class:"mx-1"},"/",-1)),t("span",Mb,"-"+k(ne(e).currentDiff.total_deletions),1),t("span",Ob,k(ne(e).fileCount)+" file"+k(ne(e).fileCount!==1?"s":""),1),ne(e).commitCount>0?(i(),r("span",Lb,k(ne(e).commitCount)+" commit"+k(ne(e).commitCount!==1?"s":""),1)):E("",!0)]),ne(e).currentMode==="total"?(i(),r("div",Nb,[(i(!0),r(se,null,le(ne(e).currentFiles,v=>(i(),r("div",{key:v.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:g=>c(v.path,null)},[t("span",{class:H(["status-icon","status-"+v.status])},k(f(v.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:v.path},k(v.path),9,Pb),v.is_binary?(i(),r("span",Vb,"binary")):(i(),r("span",jb,[v.insertions>0?(i(),r("span",Rb,"+"+k(v.insertions),1)):E("",!0),v.insertions>0&&v.deletions>0?(i(),r("span",Bb,"/")):E("",!0),v.deletions>0?(i(),r("span",Fb,"-"+k(v.deletions),1)):E("",!0)]))],8,Ib))),128))])):(i(),r("div",Wb,[(i(!0),r(se,null,le(ne(e).currentDiff.commits,v=>(i(),r("div",{key:v.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:g=>u(v.hash)},[(i(),r("svg",{class:H(["chevron-icon",{expanded:o.value.has(v.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...$[9]||($[9]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),v.is_uncommitted?(i(),r("span",Hb,"WIP")):(i(),r("code",qb,k(v.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:v.message},k(v.message),9,zb),v.is_uncommitted?E("",!0):(i(),r("span",Kb,k(p(v.date)),1))],8,Ub),o.value.has(v.hash)?(i(),r("div",Gb,[(i(!0),r(se,null,le(v.files,g=>(i(),r("div",{key:g,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:w=>c(g,v.is_uncommitted?"uncommitted":v.hash)},[t("span",{class:H(["status-icon","status-"+m(g)])},k(f(m(g))),3),t("span",{class:"file-path text-truncate small",title:g},k(g),9,Jb)],8,Yb))),128))])):E("",!0)]))),128))]))])):(i(),r("div",Qb,[...$[10]||($[10]=[t("span",null,"No diff data available",-1)])]))])]))}},Zb=te(Xb,[["__scopeId","data-v-164fd7bb"]]),ey={class:"diff-header"},ty={class:"diff-header-info"},sy={class:"diff-filename"},ny={class:"diff-meta"},oy={key:0,class:"commit-ref-badge"},ay={class:"commit-ref-msg"},iy={key:2,class:"meta-item"},ly={class:"text-success"},ry={class:"text-danger"},cy=["title","disabled"],uy={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},dy={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},fy={class:"copy-label"},my={class:"diff-body"},py={key:0,class:"diff-loading"},vy={key:1,class:"diff-error"},hy={key:2,class:"diff-content"},_y={class:"diff-table"},gy={class:"line-num line-num-old"},by={class:"line-num line-num-new"},yy={class:"line-content"},wy={class:"line-prefix"},ky={key:3,class:"diff-empty"},$y={key:2,class:"position-indicator"},Sy={__name:"DiffFullView",setup(n){const e=dn(),s=O(null),o=O(!1);let a=null;const c=h(()=>e.fullViewOpen),u=h(()=>e.currentFullViewFileDiff),f=h(()=>u.value?.content||null),m=h(()=>e.fullViewFiles.length),p=h(()=>e.currentFilePath?e.fullViewFiles.findIndex(l=>l.path===e.currentFilePath):0),d=h(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),$=h(()=>{const l=e.fullViewRef;if(!l||l==="uncommitted")return null;const S=e.currentDiff;return S?.commits&&S.commits.find(x=>x.hash===l)||null}),v=h(()=>{if(!f.value)return[];const l=f.value.split(`
`),S=[];let x=0,T=0;for(const D of l){if(D.startsWith("diff --git")||D.startsWith("index ")||D.startsWith("---")||D.startsWith("+++")||D.startsWith("new file")||D.startsWith("deleted file")||D.startsWith("similarity")||D.startsWith("rename")||D.startsWith("Binary")){D.startsWith("Binary")&&S.push({type:"info",prefix:"",text:D,oldNum:null,newNum:null});continue}if(D.startsWith("@@")){const A=D.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);A&&(x=parseInt(A[1]),T=parseInt(A[2]),S.push({type:"hunk",prefix:"",text:D,oldNum:null,newNum:null}));continue}D.startsWith(" ")||D.length>0&&!D.startsWith("+")&&!D.startsWith("-")&&!D.startsWith("\\")?(S.push({type:"context",prefix:" ",text:D.substring(1),oldNum:x,newNum:T}),x++,T++):D.startsWith("+")?(S.push({type:"add",prefix:"+",text:D.substring(1),oldNum:null,newNum:T}),T++):D.startsWith("-")?(S.push({type:"remove",prefix:"-",text:D.substring(1),oldNum:x,newNum:null}),x++):D.startsWith("\\")&&S.push({type:"info",prefix:"",text:D,oldNum:null,newNum:null})}return S});function g(l){return`diff-line diff-line-${l.type}`}function w(){e.closeFullView()}function _(l){l.target===l.currentTarget&&w()}function b(l){switch(l.key){case"Escape":w();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function y(){if(f.value)try{await navigator.clipboard.writeText(f.value),o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return fe(c,l=>{l?(dt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),De(()=>{document.body.style.overflow="",a&&clearTimeout(a)}),(l,S)=>(i(),Te(Ao,{to:"body"},[be(To,{name:"modal"},{default:un(()=>[c.value?(i(),r("div",{key:0,class:"diff-full-view-overlay",onClick:_,onKeydown:b,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ye(w,["stop"]),title:"Close (Escape)"},[...S[3]||(S[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(i(),r("button",{key:0,class:"nav-btn nav-prev",onClick:S[0]||(S[0]=ye(x=>ne(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...S[4]||(S[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):E("",!0),t("div",{class:"diff-container",onClick:S[1]||(S[1]=ye(()=>{},["stop"]))},[t("div",ey,[t("div",ty,[t("h5",sy,k(ne(e).currentFilePath),1),t("div",ny,[$.value?(i(),r("span",oy,[t("code",null,k($.value.short_hash),1),t("span",ay,k($.value.message),1)])):E("",!0),d.value?(i(),r("span",{key:1,class:H(["meta-badge","status-"+d.value.status])},k(d.value.status),3)):E("",!0),d.value&&!d.value.is_binary?(i(),r("span",iy,[t("span",ly,"+"+k(d.value.insertions),1),S[5]||(S[5]=ce(" / ",-1)),t("span",ry,"-"+k(d.value.deletions),1)])):E("",!0)])]),t("button",{class:"copy-btn",onClick:ye(y,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!f.value},[o.value?(i(),r("svg",uy,[...S[6]||(S[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),r("svg",dy,[...S[7]||(S[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",fy,k(o.value?"Copied!":"Copy"),1)],8,cy)]),t("div",my,[u.value&&u.value.loading?(i(),r("div",py,[...S[8]||(S[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):u.value&&u.value.error?(i(),r("div",vy," Failed to load diff: "+k(u.value.error),1)):f.value?(i(),r("div",hy,[t("table",_y,[t("tbody",null,[(i(!0),r(se,null,le(v.value,(x,T)=>(i(),r("tr",{key:T,class:H(g(x))},[t("td",gy,k(x.oldNum||""),1),t("td",by,k(x.newNum||""),1),t("td",yy,[t("span",wy,k(x.prefix),1),t("span",null,k(x.text),1)])],2))),128))])])])):(i(),r("div",ky," No diff available for this file. "))])]),m.value>1?(i(),r("button",{key:1,class:"nav-btn nav-next",onClick:S[2]||(S[2]=ye(x=>ne(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...S[9]||(S[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):E("",!0),m.value>1?(i(),r("div",$y,k(p.value+1)+" / "+k(m.value),1)):E("",!0)],544)):E("",!0)]),_:1})]))}},xy=te(Sy,[["__scopeId","data-v-1c2aa9a4"]]),Cy={class:"comms-panel"},Ey={key:0,class:"empty-placeholder"},Ty=["onClick"],Ay={class:"comm-meta"},Dy={class:"comm-icon"},My={class:"comm-type"},Oy={class:"comm-direction"},Ly={class:"comm-time"},Ny={class:"comm-summary"},Iy=["innerHTML"],Py="ffffffff-ffff-ffff-ffff-ffffffffffff",jy="00000000-0000-0000-0000-000000000000",Ry={__name:"CommsPanel",setup(n){const e=pe(),s=Wt(),o=rt(),a=O(null),c=O(new Set);Ke.setOptions({breaks:!0,gfm:!0});const u=h(()=>e.currentSession?.project_id||null),f=h(()=>e.currentSessionId),m=h(()=>{if(!u.value)return[];const T=s.commsByLegion.get(u.value)||[],D=f.value;return D?T.filter(A=>A.from_minion_id===D||A.to_minion_id===D):[]}),p=[{bg:"#fef3c7",border:"#fde68a"},{bg:"#fce7f3",border:"#fbcfe8"},{bg:"#e0e7ff",border:"#c7d2fe"},{bg:"#d1fae5",border:"#a7f3d0"},{bg:"#ede9fe",border:"#ddd6fe"},{bg:"#fee2e2",border:"#fecaca"},{bg:"#cffafe",border:"#a5f3fc"},{bg:"#fef9c3",border:"#fef08a"}],d=new Map;function $(T){if(!T)return null;if(d.has(T))return d.get(T);let D=0;for(let C=0;C<T.length;C++)D=(D<<5)-D+T.charCodeAt(C)|0;const A=Math.abs(D)%p.length,N=p[A];return d.set(T,N),N}function v(T){const D=T.from_minion_id;if(D===Py)return{background:"#f1f5f9",borderColor:"#e2e8f0",opacity:.8};if(T.from_user||D===jy)return{background:"#eef2ff",borderColor:"#e0e7ff"};if(D===f.value)return{background:"#f8fafc",borderColor:"#e2e8f0"};const A=$(D);return A?{background:A.bg,borderColor:A.border}:{background:"#f8fafc",borderColor:"#e2e8f0"}}function g(T){return{task:"ðŸ“‹",question:"â“",report:"ðŸ“Š",info:"ðŸ’¡",system:"âš™ï¸",halt:"ðŸ›‘",pivot:"ðŸ›‘",spawn:"ðŸŒŸ",dispose:"ðŸ—‘ï¸",thought:"ðŸ’­"}[T]||"ðŸ’¬"}function w(T){return T?T.charAt(0).toUpperCase()+T.slice(1):""}function _(T){const D=T.from_minion_name||(T.from_user?"User":"System"),A=T.to_minion_name||(T.to_user?"User":"Unknown");return`${D} â†’ ${A}`}function b(T){return T.content&&T.content!==T.summary}function y(T,D){return T?T.length<=D?T:T.substring(0,D)+"...":""}function l(T){c.value.has(T)?c.value.delete(T):c.value.add(T),c.value=new Set(c.value)}function S(T){if(!T)return"";let D=Ke.parse(T);return D=D.replace(/\n</g,"<"),D=D.replace(/\n+$/,""),Vt.sanitize(D)}fe(()=>m.value.length,async()=>{await dt(),a.value&&(a.value.scrollTop=a.value.scrollHeight)});function x(T){if(!T)return;s.setCurrentLegion(T),s.commsByLegion.get(T)||s.loadTimeline(T),(!o.legionConnected||o.currentLegionId!==T)&&o.connectLegion(T)}return fe(u,T=>{T&&x(T)},{immediate:!0}),fe(()=>o.legionConnected,T=>{T&&u.value&&s.loadTimeline(u.value)}),(T,D)=>(i(),r("div",Cy,[m.value.length===0?(i(),r("div",Ey,[...D[0]||(D[0]=[t("span",null,"Communication between this session's minions will appear here",-1)])])):(i(),r("div",{key:1,class:"comms-list",ref_key:"commsList",ref:a},[(i(!0),r(se,null,le(m.value,A=>(i(),r("div",{key:A.comm_id,class:H(["comm-item",{expandable:b(A)}]),style:je(v(A)),onClick:N=>b(A)&&l(A.comm_id)},[t("div",Ay,[t("span",Dy,k(g(A.comm_type)),1),t("span",My,k(w(A.comm_type)),1),t("span",Oy,k(_(A)),1),t("span",Ly,k(ne(ss)(A.timestamp)),1),b(A)?(i(),r("svg",{key:0,class:H(["expand-chevron",{expanded:c.value.has(A.comm_id)}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[...D[1]||(D[1]=[t("path",{d:"M4.5 2.5L8 6L4.5 9.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)):E("",!0)]),t("div",Ny,k(A.summary||y(A.content,120)),1),c.value.has(A.comm_id)?(i(),r("div",{key:0,class:"comm-content",innerHTML:S(A.content)},null,8,Iy)):E("",!0)],14,Ty))),128))],512))]))}},By=te(Ry,[["__scopeId","data-v-fa8a184a"]]),Fy={class:"sidebar-tabs"},Vy=["onClick"],Wy={key:0,class:"tab-badge"},Uy={class:"tab-content-container"},Hy={__name:"RightSidebar",setup(n){const e=xe(),s=Zt(),o=Qe(),a=dn(),c=Wt(),u=pe(),f=h(()=>e.rightSidebarActiveTab),m=h(()=>s.currentTaskStats),p=h(()=>o.currentResourceCount),d=h(()=>a.fileCount),$=h(()=>{const S=u.currentSession?.project_id,x=u.currentSessionId;return!S||!x?0:(c.commsByLegion.get(S)||[]).filter(D=>D.from_minion_id===x||D.to_minion_id===x).length}),v=h(()=>[{id:"diff",label:"Diff",badge:d.value},{id:"tasks",label:"Tasks",badge:m.value.total>0?m.value.total:0},{id:"resources",label:"Resources",badge:p.value},{id:"comms",label:"Comms",badge:$.value}]),g=h(()=>e.windowWidth<768),w=h(()=>g.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),_=O(!1);function b(S){S.preventDefault(),_.value=!0,document.addEventListener("mousemove",y),document.addEventListener("mouseup",l)}function y(S){if(_.value){const x=window.innerWidth-S.clientX;e.setRightSidebarWidth(x)}}function l(){_.value=!1,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",l)}return(S,x)=>(i(),r("aside",{id:"right-sidebar",class:H(["right-sidebar",{resizing:_.value,"theme-red-panel":ne(e).isRedBackground}]),style:je(w.value)},[be(G_),t("div",Fy,[(i(!0),r(se,null,le(v.value,T=>(i(),r("button",{key:T.id,class:H(["sidebar-tab",{active:f.value===T.id}]),onClick:D=>ne(e).setRightSidebarTab(T.id)},[ce(k(T.label)+" ",1),T.badge>0?(i(),r("span",Wy,k(T.badge),1)):E("",!0)],10,Vy))),128))]),t("div",Uy,[Se(be(Zb,null,null,512),[[ot,f.value==="diff"]]),Se(be(wg,null,null,512),[[ot,f.value==="tasks"]]),Se(be(Rg,null,null,512),[[ot,f.value==="resources"]]),Se(be(By,null,null,512),[[ot,f.value==="comms"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:b},null,32),be(hb),be(xy)],6))}},qy=te(Hy,[["__scopeId","data-v-258ec702"]]),zy={class:"modal-dialog modal-lg"},Ky={class:"modal-content"},Gy={class:"modal-body"},Yy={class:"mb-3"},Jy={class:"input-group"},Qy=["disabled"],Xy={key:0,class:"text-center py-4"},Zy={key:1,class:"alert alert-danger",role:"alert"},e1={key:2,class:"folder-list"},t1=["onClick","onDblclick"],s1={class:"d-flex align-items-center flex-grow-1"},n1=["onClick"],o1={key:1,class:"text-center text-muted py-3"},a1={class:"modal-footer"},i1=["disabled"],l1={__name:"FolderBrowserModal",setup(n){const e=xe(),s=O(""),o=O(""),a=O([]),c=O(!1),u=O(""),f=O(null);let m=null,p=null;const d=h(()=>{if(!s.value)return null;const S=s.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?"/"+S.join("/"):"/")});function $(S){if(!S)return"";const x=S.split(/[\\/]/).filter(Boolean);return x.length<=2?S:".../"+x.slice(-2).join("/")}async function v(){c.value=!0,u.value="",a.value=[],o.value="";try{const S=s.value?{path:s.value}:{},x=await ge.get("/api/filesystem/browse",{params:S});x.current_path&&(s.value=x.current_path),a.value=x.directories||[]}catch(S){console.error("Failed to load directory:",S),u.value=S.message||"Failed to load directory"}finally{c.value=!1}}function g(S){o.value=S.path}function w(S){s.value=S.path,o.value="",v()}function _(){d.value&&(s.value=d.value,o.value="",v())}function b(){const S=o.value||s.value;S&&p&&p(S),m&&m.hide()}function y(){v()}function l(){a.value=[],o.value="",u.value="",p=null,e.hideModal()}return fe(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&m){const x=S.data||{};s.value=x.defaultPath||x.currentPath||"",p=x.onSelect||null,m.show()}}),Me(()=>{f.value&&Ie(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{m=new S(f.value),f.value.addEventListener("shown.bs.modal",y),f.value.addEventListener("hidden.bs.modal",l)})}),De(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",y),f.value.removeEventListener("hidden.bs.modal",l)),m&&m.dispose()}),(S,x)=>(i(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[t("div",zy,[t("div",Ky,[x[6]||(x[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Gy,[t("div",Yy,[x[1]||(x[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Jy,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=T=>s.value=T),onKeyup:bs(v,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Ve,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:v,disabled:c.value}," ðŸ”„ Refresh ",8,Qy)])]),c.value?(i(),r("div",Xy,[...x[2]||(x[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):u.value?(i(),r("div",Zy,k(u.value),1)):(i(),r("div",e1,[d.value?(i(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:_,role:"button"},[...x[3]||(x[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):E("",!0),(i(!0),r(se,null,le(a.value,T=>(i(),r("div",{key:T.path,class:H(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:T.path===o.value}]),onClick:D=>g(T),onDblclick:D=>w(T),role:"button"},[t("div",s1,[x[4]||(x[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,k(T.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ye(D=>w(T),["stop"])}," Open ",8,n1)],42,t1))),128)),a.value.length===0?(i(),r("div",o1," No subdirectories found ")):E("",!0)]))]),t("div",a1,[x[5]||(x[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:!o.value},' Select "'+k($(o.value||s.value))+'" ',9,i1)])])])],512))}},r1=te(l1,[["__scopeId","data-v-0d61ed46"]]),c1={class:"modal-dialog"},u1={class:"modal-content"},d1={class:"modal-body"},f1={class:"mb-3"},m1={key:0,class:"invalid-feedback"},p1={class:"mb-3"},v1={class:"input-group"},h1={key:0,class:"invalid-feedback"},_1={class:"mb-3 form-check"},g1={key:0,class:"mb-3 ms-4"},b1={key:1,class:"alert alert-danger",role:"alert"},y1={class:"modal-footer"},w1=["disabled"],k1={key:0,class:"spinner-border spinner-border-sm me-2"},$1={__name:"ProjectCreateModal",setup(n){const e=qe(),s=pe(),o=xe(),a=O({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),c=O({name:"",workingDirectory:""}),u=O(!1),f=O(""),m=O(null);let p=null;function d(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:b=>{a.value.workingDirectory=b,c.value.workingDirectory=""}})}function $(){c.value={};let b=!0;return a.value.name.trim()||(c.value.name="Project name is required",b=!1),a.value.workingDirectory.trim()||(c.value.workingDirectory="Working directory is required",b=!1),b}async function v(){if($()){u.value=!0,f.value="";try{const b=await e.createProject(a.value.name,a.value.workingDirectory);a.value.createSession&&await s.createSession(b.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),g()}catch(b){console.error("Failed to create project:",b),f.value=b.message||"Failed to create project. Please try again."}finally{u.value=!1}}}function g(){a.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},c.value={},f.value=""}function w(){const b=document.getElementById("projectName");b&&b.focus()}function _(){g(),o.hideModal()}return fe(()=>o.currentModal,b=>{b?.name==="create-project"&&p&&p.show()}),Me(()=>{m.value&&Ie(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(y=>y.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{p=new b(m.value),m.value.addEventListener("shown.bs.modal",w),m.value.addEventListener("hidden.bs.modal",_)})}),De(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",w),m.value.removeEventListener("hidden.bs.modal",_)),p&&p.dispose()}),(b,y)=>(i(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",c1,[t("div",u1,[y[11]||(y[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",d1,[t("form",{onSubmit:ye(v,["prevent"])},[t("div",f1,[y[4]||(y[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),Se(t("input",{type:"text",class:H(["form-control",{"is-invalid":c.value.name}]),id:"projectName","onUpdate:modelValue":y[0]||(y[0]=l=>a.value.name=l),placeholder:"My Project",required:""},null,2),[[Ve,a.value.name]]),c.value.name?(i(),r("div",m1,k(c.value.name),1)):E("",!0)]),t("div",p1,[y[5]||(y[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",v1,[Se(t("input",{type:"text",class:H(["form-control",{"is-invalid":c.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":y[1]||(y[1]=l=>a.value.workingDirectory=l),placeholder:"/path/to/project",required:""},null,2),[[Ve,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:d}," Browse... "),c.value.workingDirectory?(i(),r("div",h1,k(c.value.workingDirectory),1)):E("",!0)]),y[6]||(y[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",_1,[Se(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":y[2]||(y[2]=l=>a.value.createSession=l)},null,512),[[Co,a.value.createSession]]),y[7]||(y[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),y[8]||(y[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),a.value.createSession?(i(),r("div",g1,[y[9]||(y[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),Se(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":y[3]||(y[3]=l=>a.value.sessionName=l),placeholder:"main"},null,512),[[Ve,a.value.sessionName]])])):E("",!0),f.value?(i(),r("div",b1,k(f.value),1)):E("",!0)],32)]),t("div",y1,[y[10]||(y[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:u.value},[u.value?(i(),r("span",k1)):E("",!0),ce(" "+k(u.value?"Creating...":"Create Project"),1)],8,w1)])])])],512))}},S1=te($1,[["__scopeId","data-v-ea55fdae"]]),x1={class:"modal-dialog"},C1={class:"modal-content"},E1={class:"modal-body"},T1={class:"mb-3"},A1={key:0,class:"invalid-feedback"},D1={class:"mb-3"},M1=["value"],O1={key:0,class:"alert alert-danger",role:"alert"},L1={class:"danger-zone"},N1={class:"text-muted small"},I1=["disabled"],P1={key:0,class:"alert alert-warning mt-3",role:"alert"},j1={class:"mb-2"},R1={class:"d-flex gap-2"},B1=["disabled"],F1={key:0,class:"spinner-border spinner-border-sm me-2"},V1=["disabled"],W1={class:"modal-footer"},U1=["disabled"],H1={key:0,class:"spinner-border spinner-border-sm me-2"},q1={__name:"ProjectEditModal",setup(n){const e=qe(),s=xe(),o=O(null),a=O({name:""}),c=O({name:""}),u=O(!1),f=O(!1),m=O(""),p=O(!1),d=O(null);let $=null;const v=h(()=>o.value?.session_ids?.length||0);function g(){c.value={};let S=!0;return a.value.name.trim()||(c.value.name="Project name is required",S=!1),S}async function w(){if(!(!g()||!o.value)){u.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),$&&$.hide()}catch(S){console.error("Failed to update project:",S),m.value=S.message||"Failed to update project. Please try again."}finally{u.value=!1}}}async function _(){if(o.value){f.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(S){console.error("Failed to delete project:",S),m.value=S.message||"Failed to delete project. Please try again."}finally{f.value=!1}}}function b(){a.value={name:""},c.value={},m.value="",p.value=!1}function y(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function l(){b(),o.value=null,s.hideModal()}return fe(()=>s.currentModal,S=>{if(S?.name==="edit-project"&&$){const x=S.data||{};o.value=x.project,o.value&&(a.value.name=o.value.name),$.show()}}),Me(()=>{d.value&&Ie(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{$=new S(d.value),d.value.addEventListener("shown.bs.modal",y),d.value.addEventListener("hidden.bs.modal",l)})}),De(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",y),d.value.removeEventListener("hidden.bs.modal",l)),$&&$.dispose()}),(S,x)=>(i(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",x1,[t("div",C1,[x[10]||(x[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",E1,[t("form",{onSubmit:ye(w,["prevent"])},[t("div",T1,[x[3]||(x[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),Se(t("input",{type:"text",class:H(["form-control",{"is-invalid":c.value.name}]),id:"editProjectName","onUpdate:modelValue":x[0]||(x[0]=T=>a.value.name=T),placeholder:"My Project",required:""},null,2),[[Ve,a.value.name]]),c.value.name?(i(),r("div",A1,k(c.value.name),1)):E("",!0)]),t("div",D1,[x[4]||(x[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,M1),x[5]||(x[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(i(),r("div",O1,k(m.value),1)):E("",!0)],32),x[8]||(x[8]=t("hr",null,null,-1)),t("div",L1,[x[6]||(x[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",N1," Deleting this project will also delete all "+k(v.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x[1]||(x[1]=T=>p.value=!0),disabled:f.value}," ðŸ—‘ï¸ Delete Project ",8,I1)]),p.value?(i(),r("div",P1,[x[7]||(x[7]=t("strong",null,"Are you sure?",-1)),t("p",j1,' This will permanently delete the project "'+k(o.value?.name)+'" and all '+k(v.value)+" session(s). ",1),t("div",R1,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:_,disabled:f.value},[f.value?(i(),r("span",F1)):E("",!0),ce(" "+k(f.value?"Deleting...":"Yes, Delete Permanently"),1)],8,B1),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:x[2]||(x[2]=T=>p.value=!1),disabled:f.value}," Cancel ",8,V1)])])):E("",!0)]),t("div",W1,[x[9]||(x[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:u.value},[u.value?(i(),r("span",H1)):E("",!0),ce(" "+k(u.value?"Saving...":"Save Changes"),1)],8,U1)])])])],512))}},z1=te(q1,[["__scopeId","data-v-52679516"]]),K1={class:"general-tab"},G1={key:0,class:"mb-3"},Y1={for:"template-select",class:"form-label"},J1=["value"],Q1=["value"],X1={key:0,class:"form-text"},Z1={class:"mb-3"},ew={for:"config-name",class:"form-label"},tw=["value","placeholder","pattern","title"],sw={key:0,class:"invalid-feedback"},nw={key:1,class:"form-text"},ow={key:1,class:"mb-3"},aw=["value"],iw={class:"mb-3"},lw=["value"],rw={class:"form-text"},cw={key:0},uw={class:"mb-3"},dw={for:"config-permission-mode",class:"form-label"},fw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},mw={key:1,class:"field-indicator modified",title:"Modified from template"},pw=["value","disabled"],vw={key:0,value:"bypassPermissions"},hw={class:"form-text"},_w={key:0,class:"text-warning"},gw={key:1},bw={class:"mb-3"},yw={for:"config-role",class:"form-label"},ww={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},kw={key:1,class:"field-indicator modified",title:"Modified from template"},$w=["value","placeholder"],Sw={class:"form-text"},xw={key:2,class:"mb-3"},Cw={class:"input-group"},Ew=["value","placeholder","disabled","readonly"],Tw={class:"form-text"},Aw={key:3,class:"mb-3"},Dw={class:"form-control-plaintext"},Mw={key:4,class:"mb-3 form-check"},Ow=["checked"],Lw={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=h(()=>e.mode==="create-session"||e.mode==="edit-session"),o=h(()=>e.mode==="create-template"||e.mode==="edit-template"),a=h(()=>e.mode==="create-session"),c=h(()=>e.mode==="edit-session"),u=h(()=>e.session?.state==="active"||e.session?.state==="starting"),f=h(()=>e.session?.initial_permission_mode==="bypassPermissions"),m=h(()=>e.selectedTemplateId?e.templates.find(w=>w.template_id===e.selectedTemplateId):null),p={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},d=h(()=>p[e.formData.model]||null),$=h(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),v=h(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function g(w){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[w]||"bg-secondary"}return(w,_)=>(i(),r("div",K1,[a.value?(i(),r("div",G1,[t("label",Y1,[_[10]||(_[10]=ce(" Template ",-1)),t("button",{type:"button",onClick:_[0]||(_[0]=b=>w.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:_[1]||(_[1]=b=>w.$emit("update:selected-template-id",b.target.value||null)),class:"form-select"},[_[11]||(_[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),r(se,null,le(n.templates,b=>(i(),r("option",{key:b.template_id,value:b.template_id},k(b.name),9,Q1))),128))],40,J1),m.value?(i(),r("div",X1,k(m.value.description),1)):E("",!0)])):E("",!0),t("div",Z1,[t("label",ew,[ce(k(o.value?"Template Name":"Session Name")+" ",1),_[12]||(_[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:H(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:_[2]||(_[2]=b=>w.$emit("update:form-data","name",b.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,tw),n.errors.name?(i(),r("div",sw,k(n.errors.name),1)):E("",!0),s.value?(i(),r("div",nw,"Must be a single word (no spaces) for #nametag matching")):E("",!0)]),o.value?(i(),r("div",ow,[_[13]||(_[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:_[3]||(_[3]=b=>w.$emit("update:form-data","description",b.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,aw)])):E("",!0),t("div",iw,[_[15]||(_[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:_[4]||(_[4]=b=>w.$emit("update:form-data","model",b.target.value))},[..._[14]||(_[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,lw),t("div",rw,[d.value?(i(),r("span",cw,k(d.value.description),1)):E("",!0)])]),t("div",uw,[t("label",dw,[_[16]||(_[16]=ce(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),r("span",fw," < ")):E("",!0),n.fieldStates.permission_mode==="modified"?(i(),r("span",mw," * ")):E("",!0)]),t("select",{id:"config-permission-mode",class:H(["form-select",v.value]),value:n.formData.permission_mode,onChange:_[5]||(_[5]=b=>w.$emit("update:form-data","permission_mode",b.target.value)),disabled:c.value&&!u.value},[_[17]||(_[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),_[18]||(_[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),_[19]||(_[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!c.value||f.value?(i(),r("option",vw," Bypass Permissions (No prompts - use with caution) ")):E("",!0)],42,pw),t("div",hw,[c.value&&!u.value?(i(),r("span",_w," Session must be active to change permission mode. Start the session first. ")):(i(),r("span",gw,"Controls which tool actions require permission prompts"))])]),t("div",bw,[t("label",yw,[ce(k(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),r("span",ww," < ")):E("",!0),n.fieldStates.default_role==="modified"?(i(),r("span",kw," * ")):E("",!0)]),t("input",{id:"config-role",type:"text",class:H(["form-control",$.value]),value:n.formData.default_role,onInput:_[6]||(_[6]=b=>w.$emit("update:form-data","default_role",b.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,$w),t("div",Sw,k(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),r("div",xw,[_[20]||(_[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",Cw,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:_[7]||(_[7]=b=>w.$emit("update:form-data","working_directory",b.target.value)),placeholder:c.value?"":"Leave empty to inherit from project",disabled:c.value,readonly:c.value},null,40,Ew),c.value?E("",!0):(i(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:_[8]||(_[8]=b=>w.$emit("open-folder-browser"))}," Browse "))]),t("div",Tw,k(c.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):E("",!0),c.value&&n.session?(i(),r("div",Aw,[_[21]||(_[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",Dw,[t("span",{class:H(["badge",g(n.session.state)])},k(n.session.state),3)])])):E("",!0),a.value?(i(),r("div",Mw,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:_[9]||(_[9]=b=>w.$emit("update:form-data","startImmediately",b.target.checked))},null,40,Ow),_[22]||(_[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):E("",!0)]))}},Nw=te(Lw,[["__scopeId","data-v-9f0e3252"]]),Iw={class:"permissions-tab"},Pw={class:"mb-3"},jw={for:"config-allowed-tools",class:"form-label"},Rw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Bw={key:1,class:"field-indicator modified",title:"Modified from template"},Fw={key:0,class:"tools-list mb-2"},Vw=["onClick"],Ww={class:"input-group input-group-sm"},Uw=["onKeydown"],Hw=["disabled"],qw={class:"mt-2"},zw=["onClick"],Kw={class:"form-text"},Gw={class:"mb-3"},Yw={for:"config-disallowed-tools",class:"form-label"},Jw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Qw={key:1,class:"field-indicator modified",title:"Modified from template"},Xw={key:0,class:"tools-list mb-2"},Zw=["onClick"],ek={class:"input-group input-group-sm"},tk=["onKeydown"],sk=["disabled"],nk={class:"mt-2"},ok=["onClick"],ak={class:"form-text"},ik={key:0,class:"mb-3"},lk={class:"settings-sources-editor"},rk={class:"form-check"},ck=["checked"],uk={class:"form-check"},dk=["checked"],fk={class:"form-check"},mk=["checked"],pk={key:1,class:"mb-3"},vk={class:"mb-3"},hk={key:0,class:"mt-2"},_k=["value"],gk=["value"],bk={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,a=O(""),c=O(""),u=O(!1),f=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=h(()=>s.mode==="create-template"||s.mode==="edit-template"),p=h(()=>s.mode==="create-session"||s.mode==="edit-session"),d=h(()=>s.formData.setting_sources||["user","project","local"]),$=h(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(N=>N.trim()).filter(N=>N.length>0)),v=h(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(N=>N.trim()).filter(N=>N.length>0)),g=h(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),w=h(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),_=h(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),b=h(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function y(){const N=a.value.trim();if(N){if(!$.value.includes(N)){const C=[...$.value,N];o("update:form-data","allowed_tools",C.join(", "))}a.value=""}}function l(N){const C=[...$.value];C.splice(N,1),o("update:form-data","allowed_tools",C.join(", "))}function S(N){if($.value.includes(N)){const C=$.value.indexOf(N);l(C)}else{const C=[...$.value,N];o("update:form-data","allowed_tools",C.join(", "))}}function x(){const N=c.value.trim();if(N){if(!v.value.includes(N)){const C=[...v.value,N];o("update:form-data","disallowed_tools",C.join(", "))}c.value=""}}function T(N){const C=[...v.value];C.splice(N,1),o("update:form-data","disallowed_tools",C.join(", "))}function D(N){if(v.value.includes(N)){const C=v.value.indexOf(N);T(C)}else{const C=[...v.value,N];o("update:form-data","disallowed_tools",C.join(", "))}}function A(N){const C=[...d.value],M=C.indexOf(N);M>=0?C.splice(M,1):C.push(N),o("update:form-data","setting_sources",C)}return(N,C)=>(i(),r("div",Iw,[t("div",Pw,[t("label",jw,[C[9]||(C[9]=ce(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),r("span",Rw," < ")):E("",!0),n.fieldStates.allowed_tools==="modified"?(i(),r("span",Bw," * ")):E("",!0)]),t("div",{class:H(["allowed-tools-editor",w.value])},[$.value.length>0?(i(),r("div",Fw,[(i(!0),r(se,null,le($.value,(M,W)=>(i(),r("span",{key:W,class:"badge bg-primary me-1 mb-1 tool-badge"},[ce(k(M)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:B=>l(W),"aria-label":"Remove tool"},null,8,Vw)]))),128))])):E("",!0),t("div",Ww,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=M=>a.value=M),onKeydown:bs(ye(y,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,Uw),[[Ve,a.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:y,disabled:!a.value.trim()}," Add ",8,Hw)]),t("div",qw,[C[10]||(C[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),r(se,null,le(f,M=>t("button",{key:M,type:"button",class:H(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":$.value.includes(M)}]),onClick:W=>S(M)},k(M),11,zw)),64))])],2),t("div",Kw,k(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",Gw,[t("label",Yw,[C[11]||(C[11]=ce(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(i(),r("span",Jw," < ")):E("",!0),n.fieldStates.disallowed_tools==="modified"?(i(),r("span",Qw," * ")):E("",!0)]),t("div",{class:H(["disallowed-tools-editor",b.value])},[v.value.length>0?(i(),r("div",Xw,[(i(!0),r(se,null,le(v.value,(M,W)=>(i(),r("span",{key:W,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[ce(k(M)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:B=>T(W),"aria-label":"Remove denied tool"},null,8,Zw)]))),128))])):E("",!0),t("div",ek,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[1]||(C[1]=M=>c.value=M),onKeydown:bs(ye(x,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,tk),[[Ve,c.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x,disabled:!c.value.trim()}," Deny ",8,sk)]),t("div",nk,[C[12]||(C[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(i(),r(se,null,le(f,M=>t("button",{key:M,type:"button",class:H(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":v.value.includes(M)}]),onClick:W=>D(M)},k(M),11,ok)),64))])],2),t("div",ak,k(m.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),p.value?(i(),r("div",ik,[C[16]||(C[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",lk,[t("div",rk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:d.value.includes("user"),onChange:C[2]||(C[2]=M=>A("user"))},null,40,ck),C[13]||(C[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[ce(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",uk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:d.value.includes("project"),onChange:C[3]||(C[3]=M=>A("project"))},null,40,dk),C[14]||(C[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[ce(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",fk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:d.value.includes("local"),onChange:C[4]||(C[4]=M=>A("local"))},null,40,mk),C[15]||(C[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[ce(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),C[17]||(C[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):E("",!0),p.value?(i(),r("div",pk,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C[5]||(C[5]=M=>N.$emit("preview-permissions"))}," Preview Effective Permissions ")])):E("",!0),t("div",vk,[t("a",{class:"text-muted small",role:"button",onClick:C[6]||(C[6]=M=>u.value=!u.value)},k(u.value?"Hide":"Show")+" raw input ",1),u.value?(i(),r("div",hk,[C[18]||(C[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:H(["form-control form-control-sm",g.value]),value:n.formData.allowed_tools,onInput:C[7]||(C[7]=M=>N.$emit("update:form-data","allowed_tools",M.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,_k),C[19]||(C[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:H(["form-control form-control-sm",_.value]),value:n.formData.disallowed_tools,onInput:C[8]||(C[8]=M=>N.$emit("update:form-data","disallowed_tools",M.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,gk)])):E("",!0)])]))}},yk=te(bk,[["__scopeId","data-v-cbec74ed"]]),wk={class:"advanced-tab"},kk={class:"mb-3"},$k={for:"config-system-prompt",class:"form-label"},Sk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},xk={key:1,class:"field-indicator modified",title:"Modified from template"},Ck=["value","rows","placeholder"],Ek={class:"form-text"},Tk={class:"mb-3 form-check"},Ak=["checked"],Dk={key:0,class:"form-text text-warning"},Mk={class:"mb-3"},Ok={class:"capabilities-editor"},Lk={key:0,class:"capabilities-list mb-2"},Nk=["onClick"],Ik={class:"input-group input-group-sm"},Pk=["onKeydown"],jk=["disabled"],Rk={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,a=h(()=>s.mode==="create-template"||s.mode==="edit-template"),c=h(()=>s.formData.initialization_context),u=h(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),f=h(()=>s.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),m=h(()=>{const w={};return s.fieldStates.initialization_context==="autofilled"&&(w["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(w["field-modified"]=!0),w}),p=O(""),d=h(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(w=>w.trim()).filter(w=>w.length>0));function $(w){const _=w.target.value;o("update:form-data","initialization_context",_)}function v(){const w=p.value.trim().toLowerCase();if(w){if(!d.value.includes(w)){const _=[...d.value,w];o("update:form-data","capabilities",_.join(", "))}p.value=""}}function g(w){const _=[...d.value];_.splice(w,1),o("update:form-data","capabilities",_.join(", "))}return(w,_)=>(i(),r("div",wk,[t("div",kk,[t("label",$k,[ce(k(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),r("span",Sk," < ")):E("",!0),n.fieldStates.initialization_context==="modified"?(i(),r("span",xk," * ")):E("",!0)]),t("textarea",{id:"config-system-prompt",class:H(["form-control",m.value]),value:c.value,onInput:$,rows:a.value?4:5,placeholder:u.value},null,42,Ck),t("div",Ek,k(f.value),1)]),t("div",Tk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:_[0]||(_[0]=b=>w.$emit("update:form-data","override_system_prompt",b.target.checked))},null,40,Ak),_[2]||(_[2]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),r("div",Dk,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+k(a.value?"":" or legion guide")+").",1)])):E("",!0)]),t("div",Mk,[_[3]||(_[3]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",Ok,[d.value.length>0?(i(),r("div",Lk,[(i(!0),r(se,null,le(d.value,(b,y)=>(i(),r("span",{key:y,class:"badge bg-info me-1 mb-1 capability-badge"},[ce(k(b)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:l=>g(y),"aria-label":"Remove capability"},null,8,Nk)]))),128))])):E("",!0),t("div",Ik,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":_[1]||(_[1]=b=>p.value=b),onKeydown:bs(ye(v,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,Pk),[[Ve,p.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:v,disabled:!p.value.trim()}," Add ",8,jk)])]),_[4]||(_[4]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},Bk=te(Rk,[["__scopeId","data-v-9ffdae4f"]]),Fk={class:"sandbox-tab"},Vk={class:"mb-3 form-check"},Wk=["checked"],Uk={class:"mb-2 form-check"},Hk=["checked","disabled"],qk={class:"mb-2 form-check"},zk=["checked","disabled"],Kk={class:"mb-2"},Gk=["value","disabled"],Yk={class:"mb-3 form-check"},Jk=["checked","disabled"],Qk={class:"mb-2"},Xk=["value","disabled"],Zk={class:"mb-2 form-check"},e$=["checked","disabled"],t$={class:"mb-2"},s$=["value","disabled"],n$={class:"mb-3 form-check"},o$=["checked","disabled"],a$={class:"mb-2"},i$=["value","disabled"],l$={class:"mb-2"},r$=["value","disabled"],c$={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(u,f){s.formData.sandbox[u]=f}function a(u,f){s.formData.sandbox.network[u]=f}function c(u,f){s.formData.sandbox.ignoreViolations[u]=f}return(u,f)=>(i(),r("div",Fk,[t("div",Vk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:f[0]||(f[0]=m=>u.$emit("update:form-data","sandbox_enabled",m.target.checked))},null,40,Wk),f[11]||(f[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:H(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,k(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",Uk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:f[1]||(f[1]=m=>o("autoAllowBashIfSandboxed",m.target.checked))},null,40,Hk),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",qk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:f[2]||(f[2]=m=>o("allowUnsandboxedCommands",m.target.checked))},null,40,zk),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",Kk,[t("label",{for:"config-sandbox-excluded-cmds",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:f[3]||(f[3]=m=>o("excludedCommands",m.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,Gk)]),t("div",Yk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:f[4]||(f[4]=m=>o("enableWeakerNestedSandbox",m.target.checked))},null,40,Jk),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",Qk,[t("label",{for:"config-sandbox-allowed-domains",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:f[5]||(f[5]=m=>a("allowedDomains",m.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,Xk)]),t("div",Zk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:f[6]||(f[6]=m=>a("allowLocalBinding",m.target.checked))},null,40,e$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",t$,[t("label",{for:"config-sandbox-unix-sockets",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:f[7]||(f[7]=m=>a("allowUnixSockets",m.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,s$)]),t("div",n$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:f[8]||(f[8]=m=>a("allowAllUnixSockets",m.target.checked))},null,40,o$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",a$,[t("label",{for:"config-sandbox-ignore-file",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:f[9]||(f[9]=m=>c("file",m.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,i$)]),t("div",l$,[t("label",{for:"config-sandbox-ignore-network",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:f[10]||(f[10]=m=>c("network",m.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,r$)])]))}},u$=te(c$,[["__scopeId","data-v-be109d12"]]);var Oe="top",Re="bottom",Be="right",Le="left",Ss="auto",Ut=[Oe,Re,Be,Le],kt="start",It="end",No="clippingParents",fn="viewport",Dt="popper",Io="reference",tn=Ut.reduce(function(n,e){return n.concat([e+"-"+kt,e+"-"+It])},[]),mn=[].concat(Ut,[Ss]).reduce(function(n,e){return n.concat([e,e+"-"+kt,e+"-"+It])},[]),Po="beforeRead",jo="read",Ro="afterRead",Bo="beforeMain",Fo="main",Vo="afterMain",Wo="beforeWrite",Uo="write",Ho="afterWrite",qo=[Po,jo,Ro,Bo,Fo,Vo,Wo,Uo,Ho];function et(n){return n?(n.nodeName||"").toLowerCase():null}function Fe(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function $t(n){var e=Fe(n).Element;return n instanceof e||n instanceof Element}function We(n){var e=Fe(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function pn(n){if(typeof ShadowRoot>"u")return!1;var e=Fe(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function d$(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},c=e.elements[s];!We(c)||!et(c)||(Object.assign(c.style,o),Object.keys(a).forEach(function(u){var f=a[u];f===!1?c.removeAttribute(u):c.setAttribute(u,f===!0?"":f)}))})}function f$(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],c=e.attributes[o]||{},u=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),f=u.reduce(function(m,p){return m[p]="",m},{});!We(a)||!et(a)||(Object.assign(a.style,f),Object.keys(c).forEach(function(m){a.removeAttribute(m)}))})}}const zo={name:"applyStyles",enabled:!0,phase:"write",fn:d$,effect:f$,requires:["computeStyles"]};function Xe(n){return n.split("-")[0]}var wt=Math.max,ys=Math.min,Pt=Math.round;function sn(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ko(){return!/^((?!chrome|android).)*safari/i.test(sn())}function jt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,c=1;e&&We(n)&&(a=n.offsetWidth>0&&Pt(o.width)/n.offsetWidth||1,c=n.offsetHeight>0&&Pt(o.height)/n.offsetHeight||1);var u=$t(n)?Fe(n):window,f=u.visualViewport,m=!Ko()&&s,p=(o.left+(m&&f?f.offsetLeft:0))/a,d=(o.top+(m&&f?f.offsetTop:0))/c,$=o.width/a,v=o.height/c;return{width:$,height:v,top:d,right:p+$,bottom:d+v,left:p,x:p,y:d}}function vn(n){var e=jt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Go(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&pn(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function lt(n){return Fe(n).getComputedStyle(n)}function m$(n){return["table","td","th"].indexOf(et(n))>=0}function vt(n){return(($t(n)?n.ownerDocument:n.document)||window.document).documentElement}function xs(n){return et(n)==="html"?n:n.assignedSlot||n.parentNode||(pn(n)?n.host:null)||vt(n)}function Wn(n){return!We(n)||lt(n).position==="fixed"?null:n.offsetParent}function p$(n){var e=/firefox/i.test(sn()),s=/Trident/i.test(sn());if(s&&We(n)){var o=lt(n);if(o.position==="fixed")return null}var a=xs(n);for(pn(a)&&(a=a.host);We(a)&&["html","body"].indexOf(et(a))<0;){var c=lt(a);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return a;a=a.parentNode}return null}function ns(n){for(var e=Fe(n),s=Wn(n);s&&m$(s)&&lt(s).position==="static";)s=Wn(s);return s&&(et(s)==="html"||et(s)==="body"&&lt(s).position==="static")?e:s||p$(n)||e}function hn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Jt(n,e,s){return wt(n,ys(e,s))}function v$(n,e,s){var o=Jt(n,e,s);return o>s?s:o}function Yo(){return{top:0,right:0,bottom:0,left:0}}function Jo(n){return Object.assign({},Yo(),n)}function Qo(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var h$=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Jo(typeof e!="number"?e:Qo(e,Ut))};function _$(n){var e,s=n.state,o=n.name,a=n.options,c=s.elements.arrow,u=s.modifiersData.popperOffsets,f=Xe(s.placement),m=hn(f),p=[Le,Be].indexOf(f)>=0,d=p?"height":"width";if(!(!c||!u)){var $=h$(a.padding,s),v=vn(c),g=m==="y"?Oe:Le,w=m==="y"?Re:Be,_=s.rects.reference[d]+s.rects.reference[m]-u[m]-s.rects.popper[d],b=u[m]-s.rects.reference[m],y=ns(c),l=y?m==="y"?y.clientHeight||0:y.clientWidth||0:0,S=_/2-b/2,x=$[g],T=l-v[d]-$[w],D=l/2-v[d]/2+S,A=Jt(x,D,T),N=m;s.modifiersData[o]=(e={},e[N]=A,e.centerOffset=A-D,e)}}function g$(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||Go(e.elements.popper,a)&&(e.elements.arrow=a))}const Xo={name:"arrow",enabled:!0,phase:"main",fn:_$,effect:g$,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Rt(n){return n.split("-")[1]}var b$={top:"auto",right:"auto",bottom:"auto",left:"auto"};function y$(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:Pt(s*a)/a||0,y:Pt(o*a)/a||0}}function Un(n){var e,s=n.popper,o=n.popperRect,a=n.placement,c=n.variation,u=n.offsets,f=n.position,m=n.gpuAcceleration,p=n.adaptive,d=n.roundOffsets,$=n.isFixed,v=u.x,g=v===void 0?0:v,w=u.y,_=w===void 0?0:w,b=typeof d=="function"?d({x:g,y:_}):{x:g,y:_};g=b.x,_=b.y;var y=u.hasOwnProperty("x"),l=u.hasOwnProperty("y"),S=Le,x=Oe,T=window;if(p){var D=ns(s),A="clientHeight",N="clientWidth";if(D===Fe(s)&&(D=vt(s),lt(D).position!=="static"&&f==="absolute"&&(A="scrollHeight",N="scrollWidth")),D=D,a===Oe||(a===Le||a===Be)&&c===It){x=Re;var C=$&&D===T&&T.visualViewport?T.visualViewport.height:D[A];_-=C-o.height,_*=m?1:-1}if(a===Le||(a===Oe||a===Re)&&c===It){S=Be;var M=$&&D===T&&T.visualViewport?T.visualViewport.width:D[N];g-=M-o.width,g*=m?1:-1}}var W=Object.assign({position:f},p&&b$),B=d===!0?y$({x:g,y:_},Fe(s)):{x:g,y:_};if(g=B.x,_=B.y,m){var F;return Object.assign({},W,(F={},F[x]=l?"0":"",F[S]=y?"0":"",F.transform=(T.devicePixelRatio||1)<=1?"translate("+g+"px, "+_+"px)":"translate3d("+g+"px, "+_+"px, 0)",F))}return Object.assign({},W,(e={},e[x]=l?_+"px":"",e[S]=y?g+"px":"",e.transform="",e))}function w$(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,c=s.adaptive,u=c===void 0?!0:c,f=s.roundOffsets,m=f===void 0?!0:f,p={placement:Xe(e.placement),variation:Rt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Un(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:u,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Un(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Zo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:w$,data:{}};var cs={passive:!0};function k$(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,c=a===void 0?!0:a,u=o.resize,f=u===void 0?!0:u,m=Fe(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&p.forEach(function(d){d.addEventListener("scroll",s.update,cs)}),f&&m.addEventListener("resize",s.update,cs),function(){c&&p.forEach(function(d){d.removeEventListener("scroll",s.update,cs)}),f&&m.removeEventListener("resize",s.update,cs)}}const ea={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:k$,data:{}};var $$={left:"right",right:"left",bottom:"top",top:"bottom"};function hs(n){return n.replace(/left|right|bottom|top/g,function(e){return $$[e]})}var S$={start:"end",end:"start"};function Hn(n){return n.replace(/start|end/g,function(e){return S$[e]})}function _n(n){var e=Fe(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function gn(n){return jt(vt(n)).left+_n(n).scrollLeft}function x$(n,e){var s=Fe(n),o=vt(n),a=s.visualViewport,c=o.clientWidth,u=o.clientHeight,f=0,m=0;if(a){c=a.width,u=a.height;var p=Ko();(p||!p&&e==="fixed")&&(f=a.offsetLeft,m=a.offsetTop)}return{width:c,height:u,x:f+gn(n),y:m}}function C$(n){var e,s=vt(n),o=_n(n),a=(e=n.ownerDocument)==null?void 0:e.body,c=wt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),u=wt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),f=-o.scrollLeft+gn(n),m=-o.scrollTop;return lt(a||s).direction==="rtl"&&(f+=wt(s.clientWidth,a?a.clientWidth:0)-c),{width:c,height:u,x:f,y:m}}function bn(n){var e=lt(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function ta(n){return["html","body","#document"].indexOf(et(n))>=0?n.ownerDocument.body:We(n)&&bn(n)?n:ta(xs(n))}function Qt(n,e){var s;e===void 0&&(e=[]);var o=ta(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),c=Fe(o),u=a?[c].concat(c.visualViewport||[],bn(o)?o:[]):o,f=e.concat(u);return a?f:f.concat(Qt(xs(u)))}function nn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function E$(n,e){var s=jt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function qn(n,e,s){return e===fn?nn(x$(n,s)):$t(e)?E$(e,s):nn(C$(vt(n)))}function T$(n){var e=Qt(xs(n)),s=["absolute","fixed"].indexOf(lt(n).position)>=0,o=s&&We(n)?ns(n):n;return $t(o)?e.filter(function(a){return $t(a)&&Go(a,o)&&et(a)!=="body"}):[]}function A$(n,e,s,o){var a=e==="clippingParents"?T$(n):[].concat(e),c=[].concat(a,[s]),u=c[0],f=c.reduce(function(m,p){var d=qn(n,p,o);return m.top=wt(d.top,m.top),m.right=ys(d.right,m.right),m.bottom=ys(d.bottom,m.bottom),m.left=wt(d.left,m.left),m},qn(n,u,o));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function sa(n){var e=n.reference,s=n.element,o=n.placement,a=o?Xe(o):null,c=o?Rt(o):null,u=e.x+e.width/2-s.width/2,f=e.y+e.height/2-s.height/2,m;switch(a){case Oe:m={x:u,y:e.y-s.height};break;case Re:m={x:u,y:e.y+e.height};break;case Be:m={x:e.x+e.width,y:f};break;case Le:m={x:e.x-s.width,y:f};break;default:m={x:e.x,y:e.y}}var p=a?hn(a):null;if(p!=null){var d=p==="y"?"height":"width";switch(c){case kt:m[p]=m[p]-(e[d]/2-s[d]/2);break;case It:m[p]=m[p]+(e[d]/2-s[d]/2);break}}return m}function Bt(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,c=s.strategy,u=c===void 0?n.strategy:c,f=s.boundary,m=f===void 0?No:f,p=s.rootBoundary,d=p===void 0?fn:p,$=s.elementContext,v=$===void 0?Dt:$,g=s.altBoundary,w=g===void 0?!1:g,_=s.padding,b=_===void 0?0:_,y=Jo(typeof b!="number"?b:Qo(b,Ut)),l=v===Dt?Io:Dt,S=n.rects.popper,x=n.elements[w?l:v],T=A$($t(x)?x:x.contextElement||vt(n.elements.popper),m,d,u),D=jt(n.elements.reference),A=sa({reference:D,element:S,placement:a}),N=nn(Object.assign({},S,A)),C=v===Dt?N:D,M={top:T.top-C.top+y.top,bottom:C.bottom-T.bottom+y.bottom,left:T.left-C.left+y.left,right:C.right-T.right+y.right},W=n.modifiersData.offset;if(v===Dt&&W){var B=W[a];Object.keys(M).forEach(function(F){var V=[Be,Re].indexOf(F)>=0?1:-1,G=[Oe,Re].indexOf(F)>=0?"y":"x";M[F]+=B[G]*V})}return M}function D$(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,c=s.rootBoundary,u=s.padding,f=s.flipVariations,m=s.allowedAutoPlacements,p=m===void 0?mn:m,d=Rt(o),$=d?f?tn:tn.filter(function(w){return Rt(w)===d}):Ut,v=$.filter(function(w){return p.indexOf(w)>=0});v.length===0&&(v=$);var g=v.reduce(function(w,_){return w[_]=Bt(n,{placement:_,boundary:a,rootBoundary:c,padding:u})[Xe(_)],w},{});return Object.keys(g).sort(function(w,_){return g[w]-g[_]})}function M$(n){if(Xe(n)===Ss)return[];var e=hs(n);return[Hn(n),e,Hn(e)]}function O$(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,c=a===void 0?!0:a,u=s.altAxis,f=u===void 0?!0:u,m=s.fallbackPlacements,p=s.padding,d=s.boundary,$=s.rootBoundary,v=s.altBoundary,g=s.flipVariations,w=g===void 0?!0:g,_=s.allowedAutoPlacements,b=e.options.placement,y=Xe(b),l=y===b,S=m||(l||!w?[hs(b)]:M$(b)),x=[b].concat(S).reduce(function(ve,he){return ve.concat(Xe(he)===Ss?D$(e,{placement:he,boundary:d,rootBoundary:$,padding:p,flipVariations:w,allowedAutoPlacements:_}):he)},[]),T=e.rects.reference,D=e.rects.popper,A=new Map,N=!0,C=x[0],M=0;M<x.length;M++){var W=x[M],B=Xe(W),F=Rt(W)===kt,V=[Oe,Re].indexOf(B)>=0,G=V?"width":"height",I=Bt(e,{placement:W,boundary:d,rootBoundary:$,altBoundary:v,padding:p}),L=V?F?Be:Le:F?Re:Oe;T[G]>D[G]&&(L=hs(L));var K=hs(L),j=[];if(c&&j.push(I[B]<=0),f&&j.push(I[L]<=0,I[K]<=0),j.every(function(ve){return ve})){C=W,N=!1;break}A.set(W,j)}if(N)for(var z=w?3:1,ee=function(he){var q=x.find(function(P){var U=A.get(P);if(U)return U.slice(0,he).every(function(X){return X})});if(q)return C=q,"break"},ue=z;ue>0;ue--){var ie=ee(ue);if(ie==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const na={name:"flip",enabled:!0,phase:"main",fn:O$,requiresIfExists:["offset"],data:{_skip:!1}};function zn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Kn(n){return[Oe,Be,Re,Le].some(function(e){return n[e]>=0})}function L$(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,c=e.modifiersData.preventOverflow,u=Bt(e,{elementContext:"reference"}),f=Bt(e,{altBoundary:!0}),m=zn(u,o),p=zn(f,a,c),d=Kn(m),$=Kn(p);e.modifiersData[s]={referenceClippingOffsets:m,popperEscapeOffsets:p,isReferenceHidden:d,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":$})}const oa={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:L$};function N$(n,e,s){var o=Xe(n),a=[Le,Oe].indexOf(o)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,u=c[0],f=c[1];return u=u||0,f=(f||0)*a,[Le,Be].indexOf(o)>=0?{x:f,y:u}:{x:u,y:f}}function I$(n){var e=n.state,s=n.options,o=n.name,a=s.offset,c=a===void 0?[0,0]:a,u=mn.reduce(function(d,$){return d[$]=N$($,e.rects,c),d},{}),f=u[e.placement],m=f.x,p=f.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=u}const aa={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:I$};function P$(n){var e=n.state,s=n.name;e.modifiersData[s]=sa({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const ia={name:"popperOffsets",enabled:!0,phase:"read",fn:P$,data:{}};function j$(n){return n==="x"?"y":"x"}function R$(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,c=a===void 0?!0:a,u=s.altAxis,f=u===void 0?!1:u,m=s.boundary,p=s.rootBoundary,d=s.altBoundary,$=s.padding,v=s.tether,g=v===void 0?!0:v,w=s.tetherOffset,_=w===void 0?0:w,b=Bt(e,{boundary:m,rootBoundary:p,padding:$,altBoundary:d}),y=Xe(e.placement),l=Rt(e.placement),S=!l,x=hn(y),T=j$(x),D=e.modifiersData.popperOffsets,A=e.rects.reference,N=e.rects.popper,C=typeof _=="function"?_(Object.assign({},e.rects,{placement:e.placement})):_,M=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),W=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(D){if(c){var F,V=x==="y"?Oe:Le,G=x==="y"?Re:Be,I=x==="y"?"height":"width",L=D[x],K=L+b[V],j=L-b[G],z=g?-N[I]/2:0,ee=l===kt?A[I]:N[I],ue=l===kt?-N[I]:-A[I],ie=e.elements.arrow,ve=g&&ie?vn(ie):{width:0,height:0},he=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Yo(),q=he[V],P=he[G],U=Jt(0,A[I],ve[I]),X=S?A[I]/2-z-U-q-M.mainAxis:ee-U-q-M.mainAxis,Q=S?-A[I]/2+z+U+P+M.mainAxis:ue+U+P+M.mainAxis,ae=e.elements.arrow&&ns(e.elements.arrow),$e=ae?x==="y"?ae.clientTop||0:ae.clientLeft||0:0,st=(F=W?.[x])!=null?F:0,J=L+X-st-$e,re=L+Q-st,_e=Jt(g?ys(K,J):K,L,g?wt(j,re):j);D[x]=_e,B[x]=_e-L}if(f){var we,Ce=x==="x"?Oe:Le,nt=x==="x"?Re:Be,Ye=D[T],gt=T==="y"?"height":"width",R=Ye+b[Ce],Z=Ye-b[nt],oe=[Oe,Le].indexOf(y)!==-1,ke=(we=W?.[T])!=null?we:0,me=oe?R:Ye-A[gt]-N[gt]-ke+M.altAxis,Ee=oe?Ye+A[gt]+N[gt]-ke-M.altAxis:Z,Ae=g&&oe?v$(me,Ye,Ee):Jt(g?me:R,Ye,g?Ee:Z);D[T]=Ae,B[T]=Ae-Ye}e.modifiersData[o]=B}}const la={name:"preventOverflow",enabled:!0,phase:"main",fn:R$,requiresIfExists:["offset"]};function B$(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function F$(n){return n===Fe(n)||!We(n)?_n(n):B$(n)}function V$(n){var e=n.getBoundingClientRect(),s=Pt(e.width)/n.offsetWidth||1,o=Pt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function W$(n,e,s){s===void 0&&(s=!1);var o=We(e),a=We(e)&&V$(e),c=vt(e),u=jt(n,a,s),f={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!s)&&((et(e)!=="body"||bn(c))&&(f=F$(e)),We(e)?(m=jt(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):c&&(m.x=gn(c))),{x:u.left+f.scrollLeft-m.x,y:u.top+f.scrollTop-m.y,width:u.width,height:u.height}}function U$(n){var e=new Map,s=new Set,o=[];n.forEach(function(c){e.set(c.name,c)});function a(c){s.add(c.name);var u=[].concat(c.requires||[],c.requiresIfExists||[]);u.forEach(function(f){if(!s.has(f)){var m=e.get(f);m&&a(m)}}),o.push(c)}return n.forEach(function(c){s.has(c.name)||a(c)}),o}function H$(n){var e=U$(n);return qo.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function q$(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function z$(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Gn={placement:"bottom",modifiers:[],strategy:"absolute"};function Yn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function ra(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,c=a===void 0?Gn:a;return function(f,m,p){p===void 0&&(p=c);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Gn,c),modifiersData:{},elements:{reference:f,popper:m},attributes:{},styles:{}},$=[],v=!1,g={state:d,setOptions:function(y){var l=typeof y=="function"?y(d.options):y;_(),d.options=Object.assign({},c,d.options,l),d.scrollParents={reference:$t(f)?Qt(f):f.contextElement?Qt(f.contextElement):[],popper:Qt(m)};var S=H$(z$([].concat(o,d.options.modifiers)));return d.orderedModifiers=S.filter(function(x){return x.enabled}),w(),g.update()},forceUpdate:function(){if(!v){var y=d.elements,l=y.reference,S=y.popper;if(Yn(l,S)){d.rects={reference:W$(l,ns(S),d.options.strategy==="fixed"),popper:vn(S)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(M){return d.modifiersData[M.name]=Object.assign({},M.data)});for(var x=0;x<d.orderedModifiers.length;x++){if(d.reset===!0){d.reset=!1,x=-1;continue}var T=d.orderedModifiers[x],D=T.fn,A=T.options,N=A===void 0?{}:A,C=T.name;typeof D=="function"&&(d=D({state:d,options:N,name:C,instance:g})||d)}}}},update:q$(function(){return new Promise(function(b){g.forceUpdate(),b(d)})}),destroy:function(){_(),v=!0}};if(!Yn(f,m))return g;g.setOptions(p).then(function(b){!v&&p.onFirstUpdate&&p.onFirstUpdate(b)});function w(){d.orderedModifiers.forEach(function(b){var y=b.name,l=b.options,S=l===void 0?{}:l,x=b.effect;if(typeof x=="function"){var T=x({state:d,name:y,instance:g,options:S}),D=function(){};$.push(T||D)}})}function _(){$.forEach(function(b){return b()}),$=[]}return g}}var K$=[ea,ia,Zo,zo,aa,na,la,Xo,oa],yn=ra({defaultModifiers:K$});const ca=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Vo,afterRead:Ro,afterWrite:Ho,applyStyles:zo,arrow:Xo,auto:Ss,basePlacements:Ut,beforeMain:Bo,beforeRead:Po,beforeWrite:Wo,bottom:Re,clippingParents:No,computeStyles:Zo,createPopper:yn,detectOverflow:Bt,end:It,eventListeners:ea,flip:na,hide:oa,left:Le,main:Fo,modifierPhases:qo,offset:aa,placements:mn,popper:Dt,popperGenerator:ra,popperOffsets:ia,preventOverflow:la,read:jo,reference:Io,right:Be,start:kt,top:Oe,variationPlacements:tn,viewport:fn,write:Uo},Symbol.toStringTag,{value:"Module"}));const ut=new Map,Rs={set(n,e,s){ut.has(n)||ut.set(n,new Map);const o=ut.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return ut.has(n)&&ut.get(n).get(e)||null},remove(n,e){if(!ut.has(n))return;const s=ut.get(n);s.delete(e),s.size===0&&ut.delete(n)}},G$=1e6,Y$=1e3,on="transitionend",ua=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),J$=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Q$=n=>{do n+=Math.floor(Math.random()*G$);while(document.getElementById(n));return n},X$=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*Y$)},da=n=>{n.dispatchEvent(new Event(on))},at=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ft=n=>at(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ua(n)):null,Ht=n=>{if(!at(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},mt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",fa=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?fa(n.parentNode):null},ws=()=>{},os=n=>{n.offsetHeight},ma=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Bs=[],Z$=n=>{document.readyState==="loading"?(Bs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Bs)e()}),Bs.push(n)):n()},Ue=()=>document.documentElement.dir==="rtl",ze=n=>{Z$(()=>{const e=ma();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ne=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,pa=(n,e,s=!0)=>{if(!s){Ne(n);return}const a=X$(e)+5;let c=!1;const u=({target:f})=>{f===e&&(c=!0,e.removeEventListener(on,u),Ne(n))};e.addEventListener(on,u),setTimeout(()=>{c||da(e)},a)},wn=(n,e,s,o)=>{const a=n.length;let c=n.indexOf(e);return c===-1?!s&&o?n[a-1]:n[0]:(c+=s?1:-1,o&&(c=(c+a)%a),n[Math.max(0,Math.min(c,a-1))])},e0=/[^.]*(?=\..*)\.|.*/,t0=/\..*/,s0=/::\d+$/,Fs={};let Jn=1;const va={mouseenter:"mouseover",mouseleave:"mouseout"},n0=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ha(n,e){return e&&`${e}::${Jn++}`||n.uidEvent||Jn++}function _a(n){const e=ha(n);return n.uidEvent=e,Fs[e]=Fs[e]||{},Fs[e]}function o0(n,e){return function s(o){return kn(o,{delegateTarget:n}),s.oneOff&&Y.off(n,o.type,e),e.apply(n,[o])}}function a0(n,e,s){return function o(a){const c=n.querySelectorAll(e);for(let{target:u}=a;u&&u!==this;u=u.parentNode)for(const f of c)if(f===u)return kn(a,{delegateTarget:u}),o.oneOff&&Y.off(n,a.type,e,s),s.apply(u,[a])}}function ga(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ba(n,e,s){const o=typeof e=="string",a=o?s:e||s;let c=ya(n);return n0.has(c)||(c=n),[o,a,c]}function Qn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[c,u,f]=ba(e,s,o);e in va&&(u=(w=>function(_){if(!_.relatedTarget||_.relatedTarget!==_.delegateTarget&&!_.delegateTarget.contains(_.relatedTarget))return w.call(this,_)})(u));const m=_a(n),p=m[f]||(m[f]={}),d=ga(p,u,c?s:null);if(d){d.oneOff=d.oneOff&&a;return}const $=ha(u,e.replace(e0,"")),v=c?a0(n,s,u):o0(n,u);v.delegationSelector=c?s:null,v.callable=u,v.oneOff=a,v.uidEvent=$,p[$]=v,n.addEventListener(f,v,c)}function an(n,e,s,o,a){const c=ga(e[s],o,a);c&&(n.removeEventListener(s,c,!!a),delete e[s][c.uidEvent])}function i0(n,e,s,o){const a=e[s]||{};for(const[c,u]of Object.entries(a))c.includes(o)&&an(n,e,s,u.callable,u.delegationSelector)}function ya(n){return n=n.replace(t0,""),va[n]||n}const Y={on(n,e,s,o){Qn(n,e,s,o,!1)},one(n,e,s,o){Qn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,c,u]=ba(e,s,o),f=u!==e,m=_a(n),p=m[u]||{},d=e.startsWith(".");if(typeof c<"u"){if(!Object.keys(p).length)return;an(n,m,u,c,a?s:null);return}if(d)for(const $ of Object.keys(m))i0(n,m,$,e.slice(1));for(const[$,v]of Object.entries(p)){const g=$.replace(s0,"");(!f||e.includes(g))&&an(n,m,u,v.callable,v.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=ma(),a=ya(e),c=e!==a;let u=null,f=!0,m=!0,p=!1;c&&o&&(u=o.Event(e,s),o(n).trigger(u),f=!u.isPropagationStopped(),m=!u.isImmediatePropagationStopped(),p=u.isDefaultPrevented());const d=kn(new Event(e,{bubbles:f,cancelable:!0}),s);return p&&d.preventDefault(),m&&n.dispatchEvent(d),d.defaultPrevented&&u&&u.preventDefault(),d}};function kn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Xn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Vs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const it={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Vs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Vs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=Xn(n.dataset[o])}return e},getDataAttribute(n,e){return Xn(n.getAttribute(`data-bs-${Vs(e)}`))}};class as{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=at(s)?it.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...at(s)?it.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const c=e[o],u=at(c)?"element":J$(c);if(!new RegExp(a).test(u))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${u}" but expected type "${a}".`)}}}const l0="5.3.8";class Ge extends as{constructor(e,s){super(),e=ft(e),e&&(this._element=e,this._config=this._getConfig(s),Rs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Rs.remove(this._element,this.constructor.DATA_KEY),Y.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){pa(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Rs.get(ft(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return l0}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ws=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ua(s)).join(","):null},de={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!mt(s)&&Ht(s))},getSelectorFromElement(n){const e=Ws(n);return e&&de.findOne(e)?e:null},getElementFromSelector(n){const e=Ws(n);return e?de.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ws(n);return e?de.find(e):[]}},Cs=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Y.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),mt(this))return;const c=de.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(c)[e]()})},r0="alert",c0="bs.alert",wa=`.${c0}`,u0=`close${wa}`,d0=`closed${wa}`,f0="fade",m0="show";class Es extends Ge{static get NAME(){return r0}close(){if(Y.trigger(this._element,u0).defaultPrevented)return;this._element.classList.remove(m0);const s=this._element.classList.contains(f0);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),Y.trigger(this._element,d0),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Es.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Cs(Es,"close");ze(Es);const p0="button",v0="bs.button",h0=`.${v0}`,_0=".data-api",g0="active",Zn='[data-bs-toggle="button"]',b0=`click${h0}${_0}`;class Ts extends Ge{static get NAME(){return p0}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(g0))}static jQueryInterface(e){return this.each(function(){const s=Ts.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}Y.on(document,b0,Zn,n=>{n.preventDefault();const e=n.target.closest(Zn);Ts.getOrCreateInstance(e).toggle()});ze(Ts);const y0="swipe",qt=".bs.swipe",w0=`touchstart${qt}`,k0=`touchmove${qt}`,$0=`touchend${qt}`,S0=`pointerdown${qt}`,x0=`pointerup${qt}`,C0="touch",E0="pen",T0="pointer-event",A0=40,D0={endCallback:null,leftCallback:null,rightCallback:null},M0={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class ks extends as{constructor(e,s){super(),this._element=e,!(!e||!ks.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return D0}static get DefaultType(){return M0}static get NAME(){return y0}dispose(){Y.off(this._element,qt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ne(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=A0)return;const s=e/this._deltaX;this._deltaX=0,s&&Ne(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Y.on(this._element,S0,e=>this._start(e)),Y.on(this._element,x0,e=>this._end(e)),this._element.classList.add(T0)):(Y.on(this._element,w0,e=>this._start(e)),Y.on(this._element,k0,e=>this._move(e)),Y.on(this._element,$0,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===E0||e.pointerType===C0)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const O0="carousel",L0="bs.carousel",ht=`.${L0}`,ka=".data-api",N0="ArrowLeft",I0="ArrowRight",P0=500,Gt="next",Tt="prev",Mt="left",_s="right",j0=`slide${ht}`,Us=`slid${ht}`,R0=`keydown${ht}`,B0=`mouseenter${ht}`,F0=`mouseleave${ht}`,V0=`dragstart${ht}`,W0=`load${ht}${ka}`,U0=`click${ht}${ka}`,$a="carousel",us="active",H0="slide",q0="carousel-item-end",z0="carousel-item-start",K0="carousel-item-next",G0="carousel-item-prev",Sa=".active",xa=".carousel-item",Y0=Sa+xa,J0=".carousel-item img",Q0=".carousel-indicators",X0="[data-bs-slide], [data-bs-slide-to]",Z0='[data-bs-ride="carousel"]',eS={[N0]:_s,[I0]:Mt},tS={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},sS={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class is extends Ge{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=de.findOne(Q0,this._element),this._addEventListeners(),this._config.ride===$a&&this.cycle()}static get Default(){return tS}static get DefaultType(){return sS}static get NAME(){return O0}next(){this._slide(Gt)}nextWhenVisible(){!document.hidden&&Ht(this._element)&&this.next()}prev(){this._slide(Tt)}pause(){this._isSliding&&da(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Y.one(this._element,Us,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){Y.one(this._element,Us,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?Gt:Tt;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Y.on(this._element,R0,e=>this._keydown(e)),this._config.pause==="hover"&&(Y.on(this._element,B0,()=>this.pause()),Y.on(this._element,F0,()=>this._maybeEnableCycle())),this._config.touch&&ks.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of de.find(J0,this._element))Y.on(o,V0,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Mt)),rightCallback:()=>this._slide(this._directionToOrder(_s)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),P0+this._config.interval))}};this._swipeHelper=new ks(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=eS[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=de.findOne(Sa,this._indicatorsElement);s.classList.remove(us),s.removeAttribute("aria-current");const o=de.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(us),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===Gt,c=s||wn(this._getItems(),o,a,this._config.wrap);if(c===o)return;const u=this._getItemIndex(c),f=g=>Y.trigger(this._element,g,{relatedTarget:c,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:u});if(f(j0).defaultPrevented||!o||!c)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(u),this._activeElement=c;const d=a?z0:q0,$=a?K0:G0;c.classList.add($),os(c),o.classList.add(d),c.classList.add(d);const v=()=>{c.classList.remove(d,$),c.classList.add(us),o.classList.remove(us,$,d),this._isSliding=!1,f(Us)};this._queueCallback(v,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(H0)}_getActive(){return de.findOne(Y0,this._element)}_getItems(){return de.find(xa,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ue()?e===Mt?Tt:Gt:e===Mt?Gt:Tt}_orderToDirection(e){return Ue()?e===Tt?Mt:_s:e===Tt?_s:Mt}static jQueryInterface(e){return this.each(function(){const s=is.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(document,U0,X0,function(n){const e=de.getElementFromSelector(this);if(!e||!e.classList.contains($a))return;n.preventDefault();const s=is.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(it.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});Y.on(window,W0,()=>{const n=de.find(Z0);for(const e of n)is.getOrCreateInstance(e)});ze(is);const nS="collapse",oS="bs.collapse",ls=`.${oS}`,aS=".data-api",iS=`show${ls}`,lS=`shown${ls}`,rS=`hide${ls}`,cS=`hidden${ls}`,uS=`click${ls}${aS}`,Hs="show",Lt="collapse",ds="collapsing",dS="collapsed",fS=`:scope .${Lt} .${Lt}`,mS="collapse-horizontal",pS="width",vS="height",hS=".collapse.show, .collapse.collapsing",ln='[data-bs-toggle="collapse"]',_S={parent:null,toggle:!0},gS={parent:"(null|element)",toggle:"boolean"};class es extends Ge{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=de.find(ln);for(const a of o){const c=de.getSelectorFromElement(a),u=de.find(c).filter(f=>f===this._element);c!==null&&u.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return _S}static get DefaultType(){return gS}static get NAME(){return nS}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(hS).filter(f=>f!==this._element).map(f=>es.getOrCreateInstance(f,{toggle:!1}))),e.length&&e[0]._isTransitioning||Y.trigger(this._element,iS).defaultPrevented)return;for(const f of e)f.hide();const o=this._getDimension();this._element.classList.remove(Lt),this._element.classList.add(ds),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(ds),this._element.classList.add(Lt,Hs),this._element.style[o]="",Y.trigger(this._element,lS)},u=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[u]}px`}hide(){if(this._isTransitioning||!this._isShown()||Y.trigger(this._element,rS).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,os(this._element),this._element.classList.add(ds),this._element.classList.remove(Lt,Hs);for(const a of this._triggerArray){const c=de.getElementFromSelector(a);c&&!this._isShown(c)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(ds),this._element.classList.add(Lt),Y.trigger(this._element,cS)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Hs)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ft(e.parent),e}_getDimension(){return this._element.classList.contains(mS)?pS:vS}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(ln);for(const s of e){const o=de.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=de.find(fS,this._config.parent);return de.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(dS,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=es.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Y.on(document,uS,ln,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of de.getMultipleElementsFromSelector(this))es.getOrCreateInstance(e,{toggle:!1}).toggle()});ze(es);const eo="dropdown",bS="bs.dropdown",xt=`.${bS}`,$n=".data-api",yS="Escape",to="Tab",wS="ArrowUp",so="ArrowDown",kS=2,$S=`hide${xt}`,SS=`hidden${xt}`,xS=`show${xt}`,CS=`shown${xt}`,Ca=`click${xt}${$n}`,Ea=`keydown${xt}${$n}`,ES=`keyup${xt}${$n}`,Ot="show",TS="dropup",AS="dropend",DS="dropstart",MS="dropup-center",OS="dropdown-center",bt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',LS=`${bt}.${Ot}`,gs=".dropdown-menu",NS=".navbar",IS=".navbar-nav",PS=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",jS=Ue()?"top-end":"top-start",RS=Ue()?"top-start":"top-end",BS=Ue()?"bottom-end":"bottom-start",FS=Ue()?"bottom-start":"bottom-end",VS=Ue()?"left-start":"right-start",WS=Ue()?"right-start":"left-start",US="top",HS="bottom",qS={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},zS={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ze extends Ge{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=de.next(this._element,gs)[0]||de.prev(this._element,gs)[0]||de.findOne(gs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return qS}static get DefaultType(){return zS}static get NAME(){return eo}toggle(){return this._isShown()?this.hide():this.show()}show(){if(mt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Y.trigger(this._element,xS,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(IS))for(const o of[].concat(...document.body.children))Y.on(o,"mouseover",ws);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ot),this._element.classList.add(Ot),Y.trigger(this._element,CS,e)}}hide(){if(mt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Y.trigger(this._element,$S,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Y.off(o,"mouseover",ws);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ot),this._element.classList.remove(Ot),this._element.setAttribute("aria-expanded","false"),it.removeDataAttribute(this._menu,"popper"),Y.trigger(this._element,SS,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!at(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${eo.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof ca>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:at(this._config.reference)?e=ft(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=yn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Ot)}_getPlacement(){const e=this._parent;if(e.classList.contains(AS))return VS;if(e.classList.contains(DS))return WS;if(e.classList.contains(MS))return US;if(e.classList.contains(OS))return HS;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(TS)?s?RS:jS:s?FS:BS}_detectNavbar(){return this._element.closest(NS)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(it.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ne(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=de.find(PS,this._menu).filter(a=>Ht(a));o.length&&wn(o,s,e===so,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===kS||e.type==="keyup"&&e.key!==to)return;const s=de.find(LS);for(const o of s){const a=Ze.getInstance(o);if(!a||a._config.autoClose===!1)continue;const c=e.composedPath(),u=c.includes(a._menu);if(c.includes(a._element)||a._config.autoClose==="inside"&&!u||a._config.autoClose==="outside"&&u||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===to||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const f={relatedTarget:a._element};e.type==="click"&&(f.clickEvent=e),a._completeHide(f)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===yS,a=[wS,so].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const c=this.matches(bt)?this:de.prev(this,bt)[0]||de.next(this,bt)[0]||de.findOne(bt,e.delegateTarget.parentNode),u=Ze.getOrCreateInstance(c);if(a){e.stopPropagation(),u.show(),u._selectMenuItem(e);return}u._isShown()&&(e.stopPropagation(),u.hide(),c.focus())}}Y.on(document,Ea,bt,Ze.dataApiKeydownHandler);Y.on(document,Ea,gs,Ze.dataApiKeydownHandler);Y.on(document,Ca,Ze.clearMenus);Y.on(document,ES,Ze.clearMenus);Y.on(document,Ca,bt,function(n){n.preventDefault(),Ze.getOrCreateInstance(this).toggle()});ze(Ze);const Ta="backdrop",KS="fade",no="show",oo=`mousedown.bs.${Ta}`,GS={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},YS={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Aa extends as{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return GS}static get DefaultType(){return YS}static get NAME(){return Ta}show(e){if(!this._config.isVisible){Ne(e);return}this._append();const s=this._getElement();this._config.isAnimated&&os(s),s.classList.add(no),this._emulateAnimation(()=>{Ne(e)})}hide(e){if(!this._config.isVisible){Ne(e);return}this._getElement().classList.remove(no),this._emulateAnimation(()=>{this.dispose(),Ne(e)})}dispose(){this._isAppended&&(Y.off(this._element,oo),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(KS),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ft(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Y.on(e,oo,()=>{Ne(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){pa(e,this._getElement(),this._config.isAnimated)}}const JS="focustrap",QS="bs.focustrap",$s=`.${QS}`,XS=`focusin${$s}`,ZS=`keydown.tab${$s}`,ex="Tab",tx="forward",ao="backward",sx={autofocus:!0,trapElement:null},nx={autofocus:"boolean",trapElement:"element"};class Da extends as{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return sx}static get DefaultType(){return nx}static get NAME(){return JS}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Y.off(document,$s),Y.on(document,XS,e=>this._handleFocusin(e)),Y.on(document,ZS,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Y.off(document,$s))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=de.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===ao?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===ex&&(this._lastTabNavDirection=e.shiftKey?ao:tx)}}const io=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",lo=".sticky-top",fs="padding-right",ro="margin-right";class rn{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,fs,s=>s+e),this._setElementAttributes(io,fs,s=>s+e),this._setElementAttributes(lo,ro,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,fs),this._resetElementAttributes(io,fs),this._resetElementAttributes(lo,ro)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),c=u=>{if(u!==this._element&&window.innerWidth>u.clientWidth+a)return;this._saveInitialAttribute(u,s);const f=window.getComputedStyle(u).getPropertyValue(s);u.style.setProperty(s,`${o(Number.parseFloat(f))}px`)};this._applyManipulationCallback(e,c)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&it.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const c=it.getDataAttribute(a,s);if(c===null){a.style.removeProperty(s);return}it.removeDataAttribute(a,s),a.style.setProperty(s,c)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(at(e)){s(e);return}for(const o of de.find(e,this._element))s(o)}}const ox="modal",ax="bs.modal",He=`.${ax}`,ix=".data-api",lx="Escape",rx=`hide${He}`,cx=`hidePrevented${He}`,Ma=`hidden${He}`,Oa=`show${He}`,ux=`shown${He}`,dx=`resize${He}`,fx=`click.dismiss${He}`,mx=`mousedown.dismiss${He}`,px=`keydown.dismiss${He}`,vx=`click${He}${ix}`,co="modal-open",hx="fade",uo="show",qs="modal-static",_x=".modal.show",gx=".modal-dialog",bx=".modal-body",yx='[data-bs-toggle="modal"]',wx={backdrop:!0,focus:!0,keyboard:!0},kx={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class St extends Ge{constructor(e,s){super(e,s),this._dialog=de.findOne(gx,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new rn,this._addEventListeners()}static get Default(){return wx}static get DefaultType(){return kx}static get NAME(){return ox}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Y.trigger(this._element,Oa,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(co),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Y.trigger(this._element,rx).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(uo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Y.off(window,He),Y.off(this._dialog,He),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Aa({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Da({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=de.findOne(bx,this._dialog);s&&(s.scrollTop=0),os(this._element),this._element.classList.add(uo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Y.trigger(this._element,ux,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Y.on(this._element,px,e=>{if(e.key===lx){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Y.on(window,dx,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Y.on(this._element,mx,e=>{Y.one(this._element,fx,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(co),this._resetAdjustments(),this._scrollBar.reset(),Y.trigger(this._element,Ma)})}_isAnimated(){return this._element.classList.contains(hx)}_triggerBackdropTransition(){if(Y.trigger(this._element,cx).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(qs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(qs),this._queueCallback(()=>{this._element.classList.remove(qs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=Ue()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=Ue()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}Y.on(document,vx,yx,function(n){const e=de.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Y.one(e,Oa,a=>{a.defaultPrevented||Y.one(e,Ma,()=>{Ht(this)&&this.focus()})});const s=de.findOne(_x);s&&St.getInstance(s).hide(),St.getOrCreateInstance(e).toggle(this)});Cs(St);ze(St);const $x="offcanvas",Sx="bs.offcanvas",ct=`.${Sx}`,La=".data-api",xx=`load${ct}${La}`,Cx="Escape",fo="show",mo="showing",po="hiding",Ex="offcanvas-backdrop",Na=".offcanvas.show",Tx=`show${ct}`,Ax=`shown${ct}`,Dx=`hide${ct}`,vo=`hidePrevented${ct}`,Ia=`hidden${ct}`,Mx=`resize${ct}`,Ox=`click${ct}${La}`,Lx=`keydown.dismiss${ct}`,Nx='[data-bs-toggle="offcanvas"]',Ix={backdrop:!0,keyboard:!0,scroll:!1},Px={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class pt extends Ge{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Ix}static get DefaultType(){return Px}static get NAME(){return $x}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Y.trigger(this._element,Tx,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new rn().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(mo);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(fo),this._element.classList.remove(mo),Y.trigger(this._element,Ax,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Y.trigger(this._element,Dx).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(po),this._backdrop.hide();const s=()=>{this._element.classList.remove(fo,po),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new rn().reset(),Y.trigger(this._element,Ia)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Y.trigger(this._element,vo);return}this.hide()},s=!!this._config.backdrop;return new Aa({className:Ex,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Da({trapElement:this._element})}_addEventListeners(){Y.on(this._element,Lx,e=>{if(e.key===Cx){if(this._config.keyboard){this.hide();return}Y.trigger(this._element,vo)}})}static jQueryInterface(e){return this.each(function(){const s=pt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Y.on(document,Ox,Nx,function(n){const e=de.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),mt(this))return;Y.one(e,Ia,()=>{Ht(this)&&this.focus()});const s=de.findOne(Na);s&&s!==e&&pt.getInstance(s).hide(),pt.getOrCreateInstance(e).toggle(this)});Y.on(window,xx,()=>{for(const n of de.find(Na))pt.getOrCreateInstance(n).show()});Y.on(window,Mx,()=>{for(const n of de.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&pt.getOrCreateInstance(n).hide()});Cs(pt);ze(pt);const jx=/^aria-[\w-]*$/i,Pa={"*":["class","dir","id","lang","role",jx],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Rx=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Bx=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Fx=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Rx.has(s)?!!Bx.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Vx(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),c=[].concat(...a.body.querySelectorAll("*"));for(const u of c){const f=u.nodeName.toLowerCase();if(!Object.keys(e).includes(f)){u.remove();continue}const m=[].concat(...u.attributes),p=[].concat(e["*"]||[],e[f]||[]);for(const d of m)Fx(d,p)||u.removeAttribute(d.nodeName)}return a.body.innerHTML}const Wx="TemplateFactory",Ux={allowList:Pa,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Hx={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},qx={entry:"(string|element|function|null)",selector:"(string|element)"};class zx extends as{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Ux}static get DefaultType(){return Hx}static get NAME(){return Wx}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,c]of Object.entries(this._config.content))this._setContent(e,c,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},qx)}_setContent(e,s,o){const a=de.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(at(s)){this._putElementInTemplate(ft(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Vx(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ne(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Kx="tooltip",Gx=new Set(["sanitize","allowList","sanitizeFn"]),zs="fade",Yx="modal",ms="show",Jx=".tooltip-inner",ho=`.${Yx}`,_o="hide.bs.modal",Yt="hover",Ks="focus",Gs="click",Qx="manual",Xx="hide",Zx="hidden",eC="show",tC="shown",sC="inserted",nC="click",oC="focusin",aC="focusout",iC="mouseenter",lC="mouseleave",rC={AUTO:"auto",TOP:"top",RIGHT:Ue()?"left":"right",BOTTOM:"bottom",LEFT:Ue()?"right":"left"},cC={allowList:Pa,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},uC={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class zt extends Ge{constructor(e,s){if(typeof ca>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return cC}static get DefaultType(){return uC}static get NAME(){return Kx}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Y.off(this._element.closest(ho),_o,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Y.trigger(this._element,this.constructor.eventName(eC)),o=(fa(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:c}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(c.append(a),Y.trigger(this._element,this.constructor.eventName(sC))),this._popper=this._createPopper(a),a.classList.add(ms),"ontouchstart"in document.documentElement)for(const f of[].concat(...document.body.children))Y.on(f,"mouseover",ws);const u=()=>{Y.trigger(this._element,this.constructor.eventName(tC)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(u,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Y.trigger(this._element,this.constructor.eventName(Xx)).defaultPrevented)return;if(this._getTipElement().classList.remove(ms),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))Y.off(a,"mouseover",ws);this._activeTrigger[Gs]=!1,this._activeTrigger[Ks]=!1,this._activeTrigger[Yt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Y.trigger(this._element,this.constructor.eventName(Zx)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(zs,ms),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Q$(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(zs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new zx({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Jx]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(zs)}_isShown(){return this.tip&&this.tip.classList.contains(ms)}_createPopper(e){const s=Ne(this._config.placement,[this,e,this._element]),o=rC[s.toUpperCase()];return yn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ne(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ne(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")Y.on(this._element,this.constructor.eventName(nC),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[Gs]=!(a._isShown()&&a._activeTrigger[Gs]),a.toggle()});else if(s!==Qx){const o=s===Yt?this.constructor.eventName(iC):this.constructor.eventName(oC),a=s===Yt?this.constructor.eventName(lC):this.constructor.eventName(aC);Y.on(this._element,o,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusin"?Ks:Yt]=!0,u._enter()}),Y.on(this._element,a,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusout"?Ks:Yt]=u._element.contains(c.relatedTarget),u._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Y.on(this._element.closest(ho),_o,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=it.getDataAttributes(this._element);for(const o of Object.keys(s))Gx.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ft(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=zt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(zt);const dC="popover",fC=".popover-header",mC=".popover-body",pC={...zt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},vC={...zt.DefaultType,content:"(null|string|element|function)"};class Sn extends zt{static get Default(){return pC}static get DefaultType(){return vC}static get NAME(){return dC}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[fC]:this._getTitle(),[mC]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=Sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(Sn);const hC="scrollspy",_C="bs.scrollspy",xn=`.${_C}`,gC=".data-api",bC=`activate${xn}`,go=`click${xn}`,yC=`load${xn}${gC}`,wC="dropdown-item",At="active",kC='[data-bs-spy="scroll"]',Ys="[href]",$C=".nav, .list-group",bo=".nav-link",SC=".nav-item",xC=".list-group-item",CC=`${bo}, ${SC} > ${bo}, ${xC}`,EC=".dropdown",TC=".dropdown-toggle",AC={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},DC={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class As extends Ge{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return AC}static get DefaultType(){return DC}static get NAME(){return hC}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ft(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Y.off(this._config.target,go),Y.on(this._config.target,go,Ys,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=u=>this._targetLinks.get(`#${u.target.id}`),o=u=>{this._previousScrollData.visibleEntryTop=u.target.offsetTop,this._process(s(u))},a=(this._rootElement||document.documentElement).scrollTop,c=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const u of e){if(!u.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(u));continue}const f=u.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(c&&f){if(o(u),!a)return;continue}!c&&!f&&o(u)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=de.find(Ys,this._config.target);for(const s of e){if(!s.hash||mt(s))continue;const o=de.findOne(decodeURI(s.hash),this._element);Ht(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(At),this._activateParents(e),Y.trigger(this._element,bC,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(wC)){de.findOne(TC,e.closest(EC)).classList.add(At);return}for(const s of de.parents(e,$C))for(const o of de.prev(s,CC))o.classList.add(At)}_clearActiveClass(e){e.classList.remove(At);const s=de.find(`${Ys}.${At}`,e);for(const o of s)o.classList.remove(At)}static jQueryInterface(e){return this.each(function(){const s=As.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(window,yC,()=>{for(const n of de.find(kC))As.getOrCreateInstance(n)});ze(As);const MC="tab",OC="bs.tab",Ct=`.${OC}`,LC=`hide${Ct}`,NC=`hidden${Ct}`,IC=`show${Ct}`,PC=`shown${Ct}`,jC=`click${Ct}`,RC=`keydown${Ct}`,BC=`load${Ct}`,FC="ArrowLeft",yo="ArrowRight",VC="ArrowUp",wo="ArrowDown",Js="Home",ko="End",yt="active",$o="fade",Qs="show",WC="dropdown",ja=".dropdown-toggle",UC=".dropdown-menu",Xs=`:not(${ja})`,HC='.list-group, .nav, [role="tablist"]',qC=".nav-item, .list-group-item",zC=`.nav-link${Xs}, .list-group-item${Xs}, [role="tab"]${Xs}`,Ra='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Zs=`${zC}, ${Ra}`,KC=`.${yt}[data-bs-toggle="tab"], .${yt}[data-bs-toggle="pill"], .${yt}[data-bs-toggle="list"]`;class Ft extends Ge{constructor(e){super(e),this._parent=this._element.closest(HC),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Y.on(this._element,RC,s=>this._keydown(s)))}static get NAME(){return MC}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?Y.trigger(s,LC,{relatedTarget:e}):null;Y.trigger(e,IC,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(yt),this._activate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Qs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Y.trigger(e,PC,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains($o))}_deactivate(e,s){if(!e)return;e.classList.remove(yt),e.blur(),this._deactivate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Qs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Y.trigger(e,NC,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains($o))}_keydown(e){if(![FC,yo,VC,wo,Js,ko].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!mt(a));let o;if([Js,ko].includes(e.key))o=s[e.key===Js?0:s.length-1];else{const a=[yo,wo].includes(e.key);o=wn(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),Ft.getOrCreateInstance(o).show())}_getChildren(){return de.find(Zs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=de.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(WC))return;const a=(c,u)=>{const f=de.findOne(c,o);f&&f.classList.toggle(u,s)};a(ja,yt),a(UC,Qs),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(yt)}_getInnerElement(e){return e.matches(Zs)?e:de.findOne(Zs,e)}_getOuterElement(e){return e.closest(qC)||e}static jQueryInterface(e){return this.each(function(){const s=Ft.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(document,jC,Ra,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!mt(this)&&Ft.getOrCreateInstance(this).show()});Y.on(window,BC,()=>{for(const n of de.find(KC))Ft.getOrCreateInstance(n)});ze(Ft);const GC="toast",YC="bs.toast",_t=`.${YC}`,JC=`mouseover${_t}`,QC=`mouseout${_t}`,XC=`focusin${_t}`,ZC=`focusout${_t}`,eE=`hide${_t}`,tE=`hidden${_t}`,sE=`show${_t}`,nE=`shown${_t}`,oE="fade",So="hide",ps="show",vs="showing",aE={animation:"boolean",autohide:"boolean",delay:"number"},iE={animation:!0,autohide:!0,delay:5e3};class Ds extends Ge{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return iE}static get DefaultType(){return aE}static get NAME(){return GC}show(){if(Y.trigger(this._element,sE).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(oE);const s=()=>{this._element.classList.remove(vs),Y.trigger(this._element,nE),this._maybeScheduleHide()};this._element.classList.remove(So),os(this._element),this._element.classList.add(ps,vs),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||Y.trigger(this._element,eE).defaultPrevented)return;const s=()=>{this._element.classList.add(So),this._element.classList.remove(vs,ps),Y.trigger(this._element,tE)};this._element.classList.add(vs),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ps),super.dispose()}isShown(){return this._element.classList.contains(ps)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Y.on(this._element,JC,e=>this._onInteraction(e,!0)),Y.on(this._element,QC,e=>this._onInteraction(e,!1)),Y.on(this._element,XC,e=>this._onInteraction(e,!0)),Y.on(this._element,ZC,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Cs(Ds);ze(Ds);const lE={class:"modal-dialog modal-lg"},rE={class:"modal-content"},cE={class:"modal-body"},uE={key:0,class:"text-center py-4"},dE={key:1,class:"alert alert-danger"},fE={key:2},mE={class:"mb-3"},pE={class:"small text-muted mb-2"},vE={key:0},hE={key:0,class:"alert alert-info"},_E={key:1},gE={class:"table table-sm table-striped"},bE={key:2,class:"mt-3"},yE={key:3,class:"mt-3"},wE={class:"modal-footer"},kE=["disabled"],$E={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=O(null);let u=null;const f=O(!1),m=O(""),p=O([]);fe(c,_=>{_&&(u=new St(_),_.addEventListener("hidden.bs.modal",()=>{a("close")}))});function d(){u&&(u.show(),v())}function $(){u&&u.hide()}async function v(){f.value=!0,m.value="",p.value=[];try{const _=await ge.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});p.value=_.permissions||[]}catch(_){console.error("Failed to load permissions:",_),m.value=_.response?.data?.detail||_.message||"Failed to load permissions"}finally{f.value=!1}}function g(){v()}function w(_){switch(_){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:d,hide:$}),(_,b)=>(i(),r("div",{ref_key:"modalRef",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",lE,[t("div",rE,[b[9]||(b[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",cE,[f.value?(i(),r("div",uE,[...b[0]||(b[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(i(),r("div",dE,k(m.value),1)):(i(),r("div",fE,[t("div",mE,[b[2]||(b[2]=t("h6",null,"Settings Sources",-1)),t("div",pE,[b[1]||(b[1]=ce(" Loading permissions from: ",-1)),(i(!0),r(se,null,le(n.settingSources,(y,l)=>(i(),r("span",{key:y},[t("code",null,k(y),1),l<n.settingSources.length-1?(i(),r("span",vE,", ")):E("",!0)]))),128))])]),p.value.length===0?(i(),r("div",hE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),r("div",_E,[t("h6",null,"Pre-approved Permissions ("+k(p.value.length)+")",1),t("table",gE,[b[3]||(b[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),r(se,null,le(p.value,y=>(i(),r("tr",{key:y.permission},[t("td",null,[t("code",null,k(y.permission),1)]),t("td",null,[(i(!0),r(se,null,le(y.sources,(l,S)=>(i(),r("span",{key:l,class:H(["badge me-1",w(l)])},k(l),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),r("div",bE,[b[4]||(b[4]=t("h6",null,"Session Allowed Tools",-1)),b[5]||(b[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),r(se,null,le(n.sessionAllowedTools,y=>(i(),r("span",{key:y,class:"badge bg-success me-1 mb-1"},k(y),1))),128))])])):E("",!0),n.sessionDisallowedTools.length>0?(i(),r("div",yE,[b[6]||(b[6]=t("h6",null,"Session Disallowed Tools",-1)),b[7]||(b[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(i(!0),r(se,null,le(n.sessionDisallowedTools,y=>(i(),r("span",{key:y,class:"badge bg-danger me-1 mb-1"},k(y),1))),128))])])):E("",!0)]))]),t("div",wE,[b[8]||(b[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:g,disabled:f.value}," Refresh ",8,kE)])])])],512))}},SE=te($E,[["__scopeId","data-v-2078b366"]]),xE={class:"modal-dialog modal-lg modal-dialog-centered"},CE={class:"modal-content"},EE={class:"modal-header"},TE={id:"configurationModalLabel",class:"modal-title"},AE={class:"modal-body"},DE={key:0,class:"template-list-view"},ME={key:0,class:"alert alert-info"},OE={class:"card-body"},LE={class:"d-flex justify-content-between align-items-start"},NE={class:"flex-grow-1"},IE={class:"card-title mb-1"},PE={key:0,class:"card-text text-muted small mb-2"},jE={class:"template-meta"},RE={class:"badge bg-secondary me-2"},BE={class:"text-muted small"},FE={class:"btn-group btn-group-sm ms-3"},VE=["onClick"],WE=["onClick"],UE={key:1},HE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},qE={class:"nav-item",role:"presentation"},zE={key:0,class:"error-indicator",title:"This tab has validation errors"},KE={class:"nav-item",role:"presentation"},GE={key:0,class:"error-indicator",title:"This tab has validation errors"},YE={class:"nav-item",role:"presentation"},JE={key:0,class:"error-indicator",title:"This tab has validation errors"},QE={class:"nav-item",role:"presentation"},XE={class:"tab-content"},ZE={key:2,class:"alert alert-danger mt-3"},eT={key:0},tT={key:1},sT={class:"modal-footer"},nT={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},oT=["disabled"],aT={key:0,class:"spinner-border spinner-border-sm me-2"},iT={__name:"ConfigurationModal",setup(n){const e=ts(),s=qe(),o=pe(),a=xe(),c=O(null);let u=null;const f=O(null),m=O("create-session"),p=O("general"),d=O(null),$=O(null),v=O(null),g=O([]),w=O(null),_=O(null),b=O({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),y=Ls({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),l=Ls({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),S=Ls({name:""}),x=h(()=>({general:!!S.name,permissions:!1,advanced:!1})),T=O(!1),D=O(""),A=h(()=>m.value==="create-session"||m.value==="edit-session"),N=h(()=>m.value==="edit-session"||m.value==="edit-template"),C=h(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),M=h(()=>T.value?N.value?"Saving...":"Creating...":N.value?"Save Changes":A.value?"Create Session":"Save Template"),W=h(()=>!(!l.name.trim()||A.value&&l.name.includes(" "))),B=h(()=>$.value?.state==="active"||$.value?.state==="starting"),F=h(()=>{if(!$.value)return!1;const R=(l.initialization_context||"")!==($.value.system_prompt||""),Z=(l.override_system_prompt||!1)!==($.value.override_system_prompt||!1),oe=(l.sandbox_enabled||!1)!==($.value.sandbox_enabled||!1);if(R||Z||oe)return!0;if(l.sandbox_enabled){const ke=$.value.sandbox_config||{},me=l.sandbox,Ee=JSON.stringify({autoAllowBashIfSandboxed:ke.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:ke.allowUnsandboxedCommands??!1,excludedCommands:(ke.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:ke.enableWeakerNestedSandbox??!1,network:{allowedDomains:(ke.network?.allowedDomains||[]).join(", "),allowLocalBinding:ke.network?.allowLocalBinding??!1,allowUnixSockets:(ke.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:ke.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(ke.ignoreViolations?.file||[]).join(", "),network:(ke.ignoreViolations?.network||[]).join(", ")}}),Ae=JSON.stringify({autoAllowBashIfSandboxed:me.autoAllowBashIfSandboxed,allowUnsandboxedCommands:me.allowUnsandboxedCommands,excludedCommands:me.excludedCommands,enableWeakerNestedSandbox:me.enableWeakerNestedSandbox,network:{allowedDomains:me.network.allowedDomains,allowLocalBinding:me.network.allowLocalBinding,allowUnixSockets:me.network.allowUnixSockets,allowAllUnixSockets:me.network.allowAllUnixSockets},ignoreViolations:{file:me.ignoreViolations.file,network:me.ignoreViolations.network}});if(Ee!==Ae)return!0}return!1}),V=h(()=>{if(!$.value)return!1;const R=(l.model||"sonnet")!==($.value.model||"sonnet"),Z=(l.allowed_tools||"")!==($.value.allowed_tools?.join(", ")||""),oe=$.value.setting_sources||["user","project","local"],ke=l.setting_sources||["user","project","local"],me=JSON.stringify([...oe].sort())!==JSON.stringify([...ke].sort());return R||Z||me}),G=h(()=>F.value?"reset":V.value?"restart":null),I=h(()=>m.value==="edit-session"&&B.value&&G.value!==null),L=h(()=>$.value?.working_directory?$.value.working_directory:l.working_directory?l.working_directory:s.projects.get(d.value)?.working_directory||""),K=h(()=>!l.allowed_tools||!l.allowed_tools.trim()?[]:l.allowed_tools.split(",").map(R=>R.trim()).filter(R=>R.length>0)),j=h(()=>!l.disallowed_tools||!l.disallowed_tools.trim()?[]:l.disallowed_tools.split(",").map(R=>R.trim()).filter(R=>R.length>0));function z(){f.value&&f.value.show()}function ee(){const R=Z=>Z.split(",").map(oe=>oe.trim()).filter(oe=>oe.length>0);return{autoAllowBashIfSandboxed:l.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:l.sandbox.allowUnsandboxedCommands,excludedCommands:R(l.sandbox.excludedCommands),enableWeakerNestedSandbox:l.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:R(l.sandbox.network.allowedDomains),allowLocalBinding:l.sandbox.network.allowLocalBinding,allowUnixSockets:R(l.sandbox.network.allowUnixSockets),allowAllUnixSockets:l.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:R(l.sandbox.ignoreViolations.file),network:R(l.sandbox.ignoreViolations.network)}}}function ue(R,Z){l[R]=Z,R==="name"&&(S.name="")}function ie(R){w.value=R,he()}async function ve(){try{const R=await ge.get("/api/templates");g.value=R||[]}catch(R){console.error("Failed to load templates:",R),g.value=[]}}function he(){if(!w.value){l.default_role="",l.initialization_context="",l.permission_mode="default",l.allowed_tools="",l.disallowed_tools="",l.model="sonnet",l.capabilities="",l.override_system_prompt=!1,l.sandbox_enabled=!1,l.sandbox.autoAllowBashIfSandboxed=!0,l.sandbox.allowUnsandboxedCommands=!1,l.sandbox.excludedCommands="",l.sandbox.enableWeakerNestedSandbox=!1,l.sandbox.network.allowedDomains="",l.sandbox.network.allowLocalBinding=!1,l.sandbox.network.allowUnixSockets="",l.sandbox.network.allowAllUnixSockets=!1,l.sandbox.ignoreViolations.file="",l.sandbox.ignoreViolations.network="",y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",y.disallowed_tools="normal",y.model="normal",y.capabilities="normal",y.sandbox_excludedCommands="normal",y.sandbox_network_allowedDomains="normal",y.sandbox_network_allowUnixSockets="normal",y.sandbox_ignoreViolations_file="normal",y.sandbox_ignoreViolations_network="normal",b.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const R=g.value.find(Je=>Je.template_id===w.value);if(!R)return;if(y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",y.disallowed_tools="normal",y.model="normal",y.capabilities="normal",y.sandbox_excludedCommands="normal",y.sandbox_network_allowedDomains="normal",y.sandbox_network_allowUnixSockets="normal",y.sandbox_ignoreViolations_file="normal",y.sandbox_ignoreViolations_network="normal",R.default_role?(l.default_role=R.default_role,b.value.default_role=R.default_role,y.default_role="autofilled"):(l.default_role="",b.value.default_role=null),R.default_system_prompt?(l.initialization_context=R.default_system_prompt,b.value.initialization_context=R.default_system_prompt,y.initialization_context="autofilled"):(l.initialization_context="",b.value.initialization_context=null),R.permission_mode?(l.permission_mode=R.permission_mode,b.value.permission_mode=R.permission_mode,y.permission_mode="autofilled"):(l.permission_mode="default",b.value.permission_mode=null),R.allowed_tools&&R.allowed_tools.length>0){const Je=R.allowed_tools.join(", ");l.allowed_tools=Je,b.value.allowed_tools=Je,y.allowed_tools="autofilled"}else l.allowed_tools="",b.value.allowed_tools=null;if(R.disallowed_tools&&R.disallowed_tools.length>0){const Je=R.disallowed_tools.join(", ");l.disallowed_tools=Je,b.value.disallowed_tools=Je,y.disallowed_tools="autofilled"}else l.disallowed_tools="",b.value.disallowed_tools=null;if(R.model?(l.model=R.model,b.value.model=R.model,y.model="autofilled"):(l.model="sonnet",b.value.model=null),R.capabilities&&R.capabilities.length>0){const Je=R.capabilities.join(", ");l.capabilities=Je,b.value.capabilities=Je,y.capabilities="autofilled"}else l.capabilities="",b.value.capabilities=null;l.override_system_prompt=R.override_system_prompt||!1,l.sandbox_enabled=R.sandbox_enabled||!1;const Z=R.sandbox_config||{};l.sandbox.autoAllowBashIfSandboxed=Z.autoAllowBashIfSandboxed??!0,l.sandbox.allowUnsandboxedCommands=Z.allowUnsandboxedCommands??!1,l.sandbox.enableWeakerNestedSandbox=Z.enableWeakerNestedSandbox??!1;const oe=Z.network||{};l.sandbox.network.allowLocalBinding=oe.allowLocalBinding??!1,l.sandbox.network.allowAllUnixSockets=oe.allowAllUnixSockets??!1;const ke=(Z.excludedCommands||[]).join(", ");l.sandbox.excludedCommands=ke,b.value.sandbox_excludedCommands=ke||null,ke&&(y.sandbox_excludedCommands="autofilled");const me=(oe.allowedDomains||[]).join(", ");l.sandbox.network.allowedDomains=me,b.value.sandbox_network_allowedDomains=me||null,me&&(y.sandbox_network_allowedDomains="autofilled");const Ee=(oe.allowUnixSockets||[]).join(", ");l.sandbox.network.allowUnixSockets=Ee,b.value.sandbox_network_allowUnixSockets=Ee||null,Ee&&(y.sandbox_network_allowUnixSockets="autofilled");const Ae=Z.ignoreViolations||{},Ms=(Ae.file||[]).join(", ");l.sandbox.ignoreViolations.file=Ms,b.value.sandbox_ignoreViolations_file=Ms||null,Ms&&(y.sandbox_ignoreViolations_file="autofilled");const Os=(Ae.network||[]).join(", ");l.sandbox.ignoreViolations.network=Os,b.value.sandbox_ignoreViolations_network=Os||null,Os&&(y.sandbox_ignoreViolations_network="autofilled")}function q(){const Z=(d.value?s.projects.get(d.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:Z,currentPath:l.working_directory||"",onSelect:oe=>{l.working_directory=oe}})}function P(){m.value==="create-session"&&(_.value={mode:"create-session",projectId:d.value,formData:{...l},selectedTemplateId:w.value}),m.value="template-list",we()}function U(){m.value="create-template",we(),p.value="general"}function X(R){m.value="edit-template",v.value=R,we(),nt(R),p.value="general"}async function Q(R){if(confirm(`Delete template "${R.name}"?

This action cannot be undone.`))try{await ge.delete(`/api/templates/${R.template_id}`),await ve()}catch(Z){console.error("Failed to delete template:",Z),D.value=Z.response?.data?.detail||"Failed to delete template"}}function ae(){let R=!0;return S.name="",l.name.trim()||(S.name="Name is required",R=!1),A.value&&l.name.includes(" ")&&(S.name="Session name must be a single word (no spaces)",R=!1),R}async function $e(){if(!ae()){S.name&&(p.value="general");return}T.value=!0,D.value="";try{switch(m.value){case"create-session":await st(),u&&u.hide();break;case"edit-session":await J(),u&&u.hide();break;case"create-template":await re();break;case"edit-template":await _e();break}}catch(R){console.error("Submit failed:",R),D.value=R.response?.data?.detail||R.message||"Operation failed. Please try again."}finally{T.value=!1}}async function st(){if(!d.value)throw new Error("Project ID is missing");const R=l.allowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),Z=l.disallowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),oe=l.capabilities.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),ke={name:l.name.trim(),model:l.model||null,role:l.default_role.trim()||null,initialization_context:l.initialization_context.trim()||null,override_system_prompt:l.override_system_prompt,capabilities:oe.length>0?oe:null,permission_mode:l.permission_mode,allowed_tools:R.length>0?R:null,disallowed_tools:Z.length>0?Z:null,working_directory:l.working_directory.trim()||null,sandbox_enabled:l.sandbox_enabled,sandbox_config:l.sandbox_enabled?ee():null,setting_sources:l.setting_sources},me=await ge.post(`/api/legions/${d.value}/minions`,ke);if(me.success&&me.minion_id)await s.fetchProjects(),await o.fetchSessions(),l.startImmediately&&await o.startSession(me.minion_id),e.push(`/session/${me.minion_id}`);else throw new Error("Failed to create session")}async function J(){if(!$.value)throw new Error("Session data is missing");const R=$.value.session_id,Z=$.value.state==="active"||$.value.state==="starting",oe=l.allowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),ke=l.disallowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),me=l.capabilities.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),Ee={name:l.name.trim(),model:l.model,role:l.default_role.trim()||null,system_prompt:l.initialization_context.trim()||null,override_system_prompt:l.override_system_prompt,allowed_tools:oe.length>0?oe:null,disallowed_tools:ke.length>0?ke:null,capabilities:me.length>0?me:null,sandbox_enabled:l.sandbox_enabled,sandbox_config:l.sandbox_enabled?ee():null,setting_sources:l.setting_sources};await o.patchSession(R,Ee),Z&&l.permission_mode!==$.value.current_permission_mode&&await o.setPermissionMode(R,l.permission_mode)}async function re(){const R=l.allowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),Z=l.disallowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),oe=l.capabilities.split(",").map(me=>me.trim()).filter(me=>me.length>0),ke={name:l.name.trim(),description:l.description.trim()||null,permission_mode:l.permission_mode,allowed_tools:R.length>0?R:null,disallowed_tools:Z.length>0?Z:null,default_role:l.default_role.trim()||null,default_system_prompt:l.initialization_context.trim()||null,model:l.model||null,capabilities:oe.length>0?oe:null,override_system_prompt:l.override_system_prompt,sandbox_enabled:l.sandbox_enabled,sandbox_config:l.sandbox_enabled?ee():null};await ge.post("/api/templates",ke),await ve(),m.value="template-list",we()}async function _e(){if(!v.value)throw new Error("Template data is missing");const R=l.allowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),Z=l.disallowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),oe=l.capabilities.split(",").map(me=>me.trim()).filter(me=>me.length>0),ke={name:l.name.trim(),description:l.description.trim()||null,permission_mode:l.permission_mode,allowed_tools:R.length>0?R:null,disallowed_tools:Z.length>0?Z:null,default_role:l.default_role.trim()||null,default_system_prompt:l.initialization_context.trim()||null,model:l.model||null,capabilities:oe.length>0?oe:null,override_system_prompt:l.override_system_prompt,sandbox_enabled:l.sandbox_enabled,sandbox_config:l.sandbox_enabled?ee():null};await ge.put(`/api/templates/${v.value.template_id}`,ke),await ve(),m.value="template-list",v.value=null,we()}function we(){l.name="",l.model="sonnet",l.permission_mode="default",l.working_directory="",l.description="",l.default_role="",l.startImmediately=!0,l.allowed_tools="",l.disallowed_tools="",l.capabilities="",l.setting_sources=["user","project","local"],l.system_prompt="",l.override_system_prompt=!1,l.initialization_context="",l.sandbox_enabled=!1,l.sandbox.autoAllowBashIfSandboxed=!0,l.sandbox.allowUnsandboxedCommands=!1,l.sandbox.excludedCommands="",l.sandbox.enableWeakerNestedSandbox=!1,l.sandbox.network.allowedDomains="",l.sandbox.network.allowLocalBinding=!1,l.sandbox.network.allowUnixSockets="",l.sandbox.network.allowAllUnixSockets=!1,l.sandbox.ignoreViolations.file="",l.sandbox.ignoreViolations.network="",S.name="",y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",y.disallowed_tools="normal",y.model="normal",y.capabilities="normal",y.sandbox_excludedCommands="normal",y.sandbox_network_allowedDomains="normal",y.sandbox_network_allowUnixSockets="normal",y.sandbox_ignoreViolations_file="normal",y.sandbox_ignoreViolations_network="normal",b.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},w.value=null,D.value="",p.value="general"}function Ce(R){l.name=R.name||"",l.model=R.model||"sonnet",l.permission_mode=R.current_permission_mode||"default",l.working_directory=R.working_directory||"",l.default_role=R.role||"",l.initialization_context=R.system_prompt||"",l.override_system_prompt=R.override_system_prompt||!1,l.system_prompt="",l.allowed_tools=R.allowed_tools?.join(", ")||"",l.disallowed_tools=R.disallowed_tools?.join(", ")||"",l.capabilities=R.capabilities?.join(", ")||"",l.sandbox_enabled=R.sandbox_enabled||!1,l.setting_sources=R.setting_sources||["user","project","local"];const Z=R.sandbox_config||{};l.sandbox.autoAllowBashIfSandboxed=Z.autoAllowBashIfSandboxed??!0,l.sandbox.allowUnsandboxedCommands=Z.allowUnsandboxedCommands??!1,l.sandbox.excludedCommands=(Z.excludedCommands||[]).join(", "),l.sandbox.enableWeakerNestedSandbox=Z.enableWeakerNestedSandbox??!1;const oe=Z.network||{};l.sandbox.network.allowedDomains=(oe.allowedDomains||[]).join(", "),l.sandbox.network.allowLocalBinding=oe.allowLocalBinding??!1,l.sandbox.network.allowUnixSockets=(oe.allowUnixSockets||[]).join(", "),l.sandbox.network.allowAllUnixSockets=oe.allowAllUnixSockets??!1;const ke=Z.ignoreViolations||{};l.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),l.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function nt(R){l.name=R.name||"",l.description=R.description||"",l.permission_mode=R.permission_mode||"default",l.default_role=R.default_role||"",l.initialization_context=R.default_system_prompt||"",l.allowed_tools=R.allowed_tools?.join(", ")||"",l.disallowed_tools=R.disallowed_tools?.join(", ")||"",l.model=R.model||"sonnet",l.capabilities=R.capabilities?.join(", ")||"",l.override_system_prompt=R.override_system_prompt||!1,l.sandbox_enabled=R.sandbox_enabled||!1;const Z=R.sandbox_config||{};l.sandbox.autoAllowBashIfSandboxed=Z.autoAllowBashIfSandboxed??!0,l.sandbox.allowUnsandboxedCommands=Z.allowUnsandboxedCommands??!1,l.sandbox.excludedCommands=(Z.excludedCommands||[]).join(", "),l.sandbox.enableWeakerNestedSandbox=Z.enableWeakerNestedSandbox??!1;const oe=Z.network||{};l.sandbox.network.allowedDomains=(oe.allowedDomains||[]).join(", "),l.sandbox.network.allowLocalBinding=oe.allowLocalBinding??!1,l.sandbox.network.allowUnixSockets=(oe.allowUnixSockets||[]).join(", "),l.sandbox.network.allowAllUnixSockets=oe.allowAllUnixSockets??!1;const ke=Z.ignoreViolations||{};l.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),l.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function Ye(){dt(()=>{const R=document.getElementById("config-name");R&&(R.focus(),N.value&&R.select())})}function gt(){we(),m.value="create-session",d.value=null,$.value=null,v.value=null,a.hideModal()}return fe(()=>a.currentModal,async(R,Z)=>{if(!(!R||!u)){if(R.name==="configuration"){const oe=R.data||{};m.value=oe.mode||"create-session",d.value=oe.project?.project_id||oe.projectId||null,$.value=oe.session||null,v.value=oe.template||null,we(),m.value==="create-session"&&await ve(),m.value==="edit-session"&&$.value?Ce($.value):m.value==="edit-template"&&v.value&&nt(v.value),u.show()}else if(R.name==="create-minion"||R.name==="create-session"){const oe=R.data||{};m.value="create-session",d.value=oe.project?.project_id||null,$.value=null,v.value=null,we(),await ve(),u.show()}else if(R.name==="edit-session"){const oe=R.data||{};m.value="edit-session",$.value=oe.session||null,d.value=$.value?.project_id||null,v.value=null,we(),$.value&&Ce($.value),u.show()}else R.name==="template-management"&&(m.value="template-list",we(),await ve(),u.show());Z?.name==="configuration"&&Z.data?.mode?.includes("template")&&R?.name==="configuration"&&m.value==="create-session"&&await ve()}}),fe(()=>l.default_role,R=>{b.value.default_role!==null&&(y.default_role=R===b.value.default_role?"autofilled":"modified")}),fe(()=>l.initialization_context,R=>{b.value.initialization_context!==null&&(y.initialization_context=R===b.value.initialization_context?"autofilled":"modified")}),fe(()=>l.permission_mode,R=>{b.value.permission_mode!==null&&(y.permission_mode=R===b.value.permission_mode?"autofilled":"modified")}),fe(()=>l.allowed_tools,R=>{b.value.allowed_tools!==null&&(y.allowed_tools=R===b.value.allowed_tools?"autofilled":"modified")}),fe(()=>l.disallowed_tools,R=>{b.value.disallowed_tools!==null&&(y.disallowed_tools=R===b.value.disallowed_tools?"autofilled":"modified")}),fe(()=>l.model,R=>{b.value.model!==null&&(y.model=R===b.value.model?"autofilled":"modified")}),fe(()=>l.capabilities,R=>{b.value.capabilities!==null&&(y.capabilities=R===b.value.capabilities?"autofilled":"modified")}),fe(()=>l.sandbox.excludedCommands,R=>{b.value.sandbox_excludedCommands!==null&&(y.sandbox_excludedCommands=R===b.value.sandbox_excludedCommands?"autofilled":"modified")}),fe(()=>l.sandbox.network.allowedDomains,R=>{b.value.sandbox_network_allowedDomains!==null&&(y.sandbox_network_allowedDomains=R===b.value.sandbox_network_allowedDomains?"autofilled":"modified")}),fe(()=>l.sandbox.network.allowUnixSockets,R=>{b.value.sandbox_network_allowUnixSockets!==null&&(y.sandbox_network_allowUnixSockets=R===b.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),fe(()=>l.sandbox.ignoreViolations.file,R=>{b.value.sandbox_ignoreViolations_file!==null&&(y.sandbox_ignoreViolations_file=R===b.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),fe(()=>l.sandbox.ignoreViolations.network,R=>{b.value.sandbox_ignoreViolations_network!==null&&(y.sandbox_ignoreViolations_network=R===b.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),Me(()=>{c.value&&Ie(()=>import("./modal-D6mKceGM.js").then(R=>R.m),__vite__mapDeps([0,1])).then(R=>{const Z=R.default;u=new Z(c.value),c.value.addEventListener("shown.bs.modal",Ye),c.value.addEventListener("hidden.bs.modal",gt)})}),De(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",Ye),c.value.removeEventListener("hidden.bs.modal",gt)),u&&u.dispose()}),(R,Z)=>(i(),r(se,null,[t("div",{ref_key:"modalElement",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",xE,[t("div",CE,[t("div",EE,[t("h5",TE,[m.value==="create-template"||m.value==="edit-template"?(i(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:P,title:"Back to template list"}," â† ")):E("",!0),ce(" "+k(C.value),1)]),Z[4]||(Z[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",AE,[m.value==="template-list"?(i(),r("div",DE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[Z[5]||(Z[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:U,class:"btn btn-primary btn-sm"}," + Create New ")]),g.value.length===0?(i(),r("div",ME," No templates found. Create your first template! ")):E("",!0),(i(!0),r(se,null,le(g.value,oe=>(i(),r("div",{key:oe.template_id,class:"card mb-2"},[t("div",OE,[t("div",LE,[t("div",NE,[t("h6",IE,k(oe.name),1),oe.description?(i(),r("p",PE,k(oe.description),1)):E("",!0),t("div",jE,[t("span",RE,k(oe.permission_mode),1),t("span",BE,k(oe.allowed_tools?.length||0)+" tools",1)])]),t("div",FE,[t("button",{onClick:ke=>X(oe),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,VE),t("button",{onClick:ke=>Q(oe),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,WE)])])])]))),128))])):(i(),r("div",UE,[t("ul",HE,[t("li",qE,[t("button",{class:H(["nav-link",{active:p.value==="general","has-error":x.value.general}]),type:"button",onClick:Z[0]||(Z[0]=oe=>p.value="general")},[Z[6]||(Z[6]=ce(" General ",-1)),x.value.general?(i(),r("span",zE)):E("",!0)],2)]),t("li",KE,[t("button",{class:H(["nav-link",{active:p.value==="permissions","has-error":x.value.permissions}]),type:"button",onClick:Z[1]||(Z[1]=oe=>p.value="permissions")},[Z[7]||(Z[7]=ce(" Permissions ",-1)),x.value.permissions?(i(),r("span",GE)):E("",!0)],2)]),t("li",YE,[t("button",{class:H(["nav-link",{active:p.value==="advanced","has-error":x.value.advanced}]),type:"button",onClick:Z[2]||(Z[2]=oe=>p.value="advanced")},[Z[8]||(Z[8]=ce(" Advanced ",-1)),x.value.advanced?(i(),r("span",JE)):E("",!0)],2)]),t("li",QE,[t("button",{class:H(["nav-link",{active:p.value==="sandbox"}]),type:"button",onClick:Z[3]||(Z[3]=oe=>p.value="sandbox")}," Sandbox ",2)])]),t("div",XE,[Se(be(Nw,{mode:m.value,"form-data":l,errors:S,templates:g.value,"selected-template-id":w.value,session:$.value,"field-states":y,"onUpdate:formData":ue,"onUpdate:selectedTemplateId":ie,onOpenFolderBrowser:q,onOpenTemplateManager:P},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ot,p.value==="general"]]),Se(be(yk,{mode:m.value,"form-data":l,errors:S,session:$.value,"field-states":y,"onUpdate:formData":ue,onPreviewPermissions:z},null,8,["mode","form-data","errors","session","field-states"]),[[ot,p.value==="permissions"]]),Se(be(Bk,{mode:m.value,"form-data":l,errors:S,session:$.value,"field-states":y,"onUpdate:formData":ue},null,8,["mode","form-data","errors","session","field-states"]),[[ot,p.value==="advanced"]]),Se(be(u$,{mode:m.value,"form-data":l,errors:S,session:$.value,"field-states":y,"onUpdate:formData":ue},null,8,["mode","form-data","errors","session","field-states"]),[[ot,p.value==="sandbox"]])])])),D.value?(i(),r("div",ZE,k(D.value),1)):E("",!0)]),I.value?(i(),r("div",{key:0,class:H(["warning-banner","warning-banner-"+G.value])},[G.value==="reset"?(i(),r("small",eT,[...Z[9]||(Z[9]=[ce(" Changes require a ",-1),t("strong",null,"reset",-1),ce(" to take effect. This starts a new conversation. ",-1)])])):(i(),r("small",tT,[...Z[10]||(Z[10]=[ce(" Changes require a ",-1),t("strong",null,"restart",-1),ce(" to take effect. ",-1)])]))],2)):E("",!0),t("div",sT,[t("button",nT,k(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(i(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:T.value||!W.value,onClick:$e},[T.value?(i(),r("span",aT)):E("",!0),ce(" "+k(M.value),1)],8,oT)):E("",!0)])])])],512),be(SE,{ref_key:"permissionPreviewModal",ref:f,"working-directory":L.value,"setting-sources":l.setting_sources,"session-allowed-tools":K.value,"session-disallowed-tools":j.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},lT=te(iT,[["__scopeId","data-v-da2afdcd"]]),rT={class:"modal-dialog modal-dialog-centered"},cT={class:"modal-content"},uT={class:"modal-header"},dT={class:"modal-title",id:"manageSessionModalLabel"},fT={class:"modal-body"},mT={key:0,class:"text-center py-4"},pT={class:"text-muted"},vT={key:1},hT={key:2},_T={class:"text-muted"},gT={key:0,class:"text-center py-2"},bT={key:1,class:"alert alert-warning mt-3"},yT={class:"mb-0 mt-2"},wT={key:0,class:"text-muted"},kT={key:3},$T={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},ST={class:"d-grid gap-2"},xT=["disabled"],CT=["disabled"],ET=["disabled"],TT=["disabled"],AT={class:"modal-footer"},DT={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},MT={__name:"SessionManageModal",setup(n){const e=ts(),s=pe(),o=xe(),a=rt();Pe();const c=O(null),u=O(!1),f=O(""),m=O(""),p=O(null),d=O(null);let $=null;const v=O([]),g=O(!1),w=h(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function _(){p.value="reset"}async function b(){if(p.value="delete",v.value=[],!!c.value){g.value=!0;try{const C=await ge.get(`/api/sessions/${c.value.session_id}/descendants`);v.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),v.value=[]}finally{g.value=!1}}}function y(){p.value=null}async function l(){p.value==="reset"?await T():p.value==="delete"&&await D()}async function S(){if(c.value){u.value=!0,f.value="Restarting session...";try{const C=c.value.session_id,M=s.currentSessionId===C,W=await ge.post(`/api/sessions/${C}/restart`);if(W.success)console.log("Session restarted successfully"),M&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),$&&$.hide();else{const B=W.error||W.detail||"Failed to restart session";console.error("Failed to restart session:",B),m.value=`Failed to restart session: ${B}`}}catch(C){console.error("Error restarting session:",C);const M=C.data?.detail||C.message||"Unknown error";m.value=`Error restarting session: ${M}`}finally{u.value=!1}}}async function x(){if(c.value)try{$&&$.hide(),console.log("Ending session",c.value.session_id);const C=c.value.session_id;await ge.post(`/api/sessions/${C}/terminate`),s.currentSessionId===C&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),s.currentSessionId===c.value?.session_id&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function T(){if(c.value){u.value=!0,f.value="Resetting session...";try{const C=c.value.session_id,M=s.currentSessionId===C,W=await ge.post(`/api/sessions/${C}/reset`);if(W.success)console.log("Session reset successfully"),M&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),$&&$.hide();else{const B=W.error||W.detail||"Failed to reset session";console.error("Failed to reset session:",B),m.value=`Failed to reset session: ${B}`,p.value=null}}catch(C){console.error("Error resetting session:",C);const M=C.data?.detail||C.message||"Unknown error";m.value=`Error resetting session: ${M}`,p.value=null}finally{u.value=!1}}}async function D(){if(c.value){u.value=!0,f.value="Deleting session...";try{const C=c.value.session_id;await s.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),$&&$.hide()}catch(C){console.error("Error deleting session:",C);const M=C.data?.detail||C.message||"Unknown error";m.value=`Error deleting session: ${M}`,p.value=null}finally{u.value=!1}}}function A(){p.value=null,u.value=!1,f.value="",m.value="",v.value=[],g.value=!1}function N(){A(),c.value=null,o.hideModal()}return fe(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&$){const M=C.data||{};c.value=M.session,A(),$.show()}}),Me(()=>{d.value&&Ie(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(M=>M.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{$=new C(d.value),d.value.addEventListener("hidden.bs.modal",N)})}),De(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",N),$&&$.dispose()}),(C,M)=>(i(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",rT,[t("div",cT,[t("div",uT,[t("h5",dT,k(p.value?w.value:"Manage Session"),1),M[1]||(M[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",fT,[u.value?(i(),r("div",mT,[M[2]||(M[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",pT,k(f.value),1)])):p.value==="reset"?(i(),r("div",vT,[...M[3]||(M[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(i(),r("div",hT,[M[9]||(M[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",_T,[M[4]||(M[4]=ce("This will permanently delete session ",-1)),t("strong",null,k(c.value?.name),1),M[5]||(M[5]=ce(".",-1))]),M[10]||(M[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),g.value?(i(),r("div",gT,[...M[6]||(M[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):v.value.length>0?(i(),r("div",bT,[M[7]||(M[7]=t("strong",null,"Cascading Deletion:",-1)),M[8]||(M[8]=ce(" This session has ",-1)),t("strong",null,k(v.value.length),1),ce(" child session"+k(v.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",yT,[(i(!0),r(se,null,le(v.value,W=>(i(),r("li",{key:W.session_id,class:"small"},[t("strong",null,k(W.name||W.session_id),1),W.role?(i(),r("span",wT," ("+k(W.role)+")",1)):E("",!0)]))),128))])])):E("",!0)])):(i(),r("div",kT,[m.value?(i(),r("div",$T,[M[11]||(M[11]=t("strong",null,"Error:",-1)),ce(" "+k(m.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:M[0]||(M[0]=W=>m.value="")})])):E("",!0),M[18]||(M[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",ST,[t("button",{class:"btn btn-outline-primary text-start",onClick:S,disabled:u.value},[...M[12]||(M[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,xT),t("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:u.value},[...M[13]||(M[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,CT),M[16]||(M[16]=t("hr",{class:"my-2"},null,-1)),M[17]||(M[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:_,disabled:u.value},[...M[14]||(M[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,ET),t("button",{class:"btn btn-outline-danger text-start",onClick:b,disabled:u.value},[...M[15]||(M[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,TT)]),M[19]||(M[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ce(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",AT,[p.value&&!u.value?(i(),r(se,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancel"),t("button",{type:"button",class:H(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:l},k(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):u.value?E("",!0):(i(),r("button",DT,"Cancel"))])])])],512))}},OT=te(MT,[["__scopeId","data-v-6b832853"]]),LT={class:"modal-dialog modal-dialog-centered modal-lg"},NT={class:"modal-content"},IT={class:"modal-body"},PT={key:0,class:"text-center text-muted py-4"},jT={key:1},RT={class:"mb-3"},BT={class:"font-monospace small"},FT={class:"mb-3"},VT=["value"],WT={class:"mb-3"},UT={class:"mb-3"},HT={class:"mb-3"},qT={key:0},zT={class:"d-flex flex-wrap gap-1"},KT={key:1,class:"text-muted small"},GT={key:0,class:"mb-3"},YT={class:"d-flex flex-wrap gap-1"},JT={key:1,class:"mb-3"},QT={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},XT={class:"mb-3"},ZT={class:"text-muted"},e2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},t2={__name:"SessionInfoModal",setup(n){const e=pe(),s=Pe(),o=xe(),a=O(null),c=O(!1),u=O(null);let f=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},p=h(()=>{if(!a.value)return null;const _=e.initData.get(a.value);return _||(s.messagesBySession.get(a.value)||[]).find(l=>l.type==="system"&&(l.subtype==="init"||l.metadata?.subtype==="init")&&l.metadata?.init_data)?.metadata?.init_data||null});function d(_){return _?m[_]||_:"Default (Sonnet 4.5)"}function $(_){return typeof _=="string"?_:typeof _=="object"&&_.type==="preset"?`Preset: ${_.preset}`:JSON.stringify(_,null,2)}function v(_){_.target.select()}function g(){a.value=null,c.value=!1}function w(){g(),o.hideModal()}return fe(()=>o.currentModal,_=>{if(_?.name==="session-info"&&f){const b=_.data||{};a.value=b.sessionId,c.value=!1,f.show()}}),Me(()=>{u.value&&Ie(async()=>{const{default:_}=await import("./modal-D6mKceGM.js").then(b=>b.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{f=new _(u.value),u.value.addEventListener("hidden.bs.modal",w)})}),De(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",w),f&&f.dispose()}),(_,b)=>(i(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",LT,[t("div",NT,[b[9]||(b[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",IT,[p.value?(i(),r("div",jT,[t("div",RT,[b[1]||(b[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",BT,k(a.value),1)]),t("div",FT,[b[2]||(b[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:v},null,8,VT)]),t("div",WT,[b[3]||(b[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,k(d(p.value.model)),1)]),t("div",UT,[b[4]||(b[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,k(p.value.permissionMode||"default"),1)]),t("div",HT,[b[5]||(b[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(i(),r("div",qT,[t("div",zT,[(i(!0),r(se,null,le(p.value.allowed_tools||p.value.tools,y=>(i(),r("span",{key:y,class:"badge bg-secondary"},k(y),1))),128))])])):(i(),r("div",KT,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(i(),r("div",GT,[b[6]||(b[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",YT,[(i(!0),r(se,null,le(p.value.commands,y=>(i(),r("span",{key:y,class:"badge bg-info"},k(y),1))),128))])])):E("",!0),p.value.systemPrompt?(i(),r("div",JT,[b[7]||(b[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",QT,k($(p.value.systemPrompt)),1)])):E("",!0),t("div",XT,[t("h6",ZT,[b[8]||(b[8]=ce(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:b[0]||(b[0]=y=>c.value=!c.value)},k(c.value?"Hide":"Show"),1)]),c.value?(i(),r("pre",e2,k(JSON.stringify(p.value,null,2)),1)):E("",!0)])])):(i(),r("div",PT," No session configuration data available "))]),b[10]||(b[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},s2=te(t2,[["__scopeId","data-v-b28b39b3"]]),n2={class:"modal-dialog modal-dialog-centered modal-lg"},o2={class:"modal-content"},a2={class:"modal-body"},i2={key:0,class:"text-center text-muted py-4"},l2={key:1},r2={class:"mb-3"},c2={class:"mb-3"},u2={class:"font-monospace small"},d2={class:"mb-3"},f2={class:"mb-3"},m2={class:"mb-3"},p2={key:0},v2={class:"d-flex flex-wrap gap-1"},h2={key:1,class:"text-muted small"},_2={class:"mb-3"},g2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},b2={key:1,class:"text-muted small"},y2={class:"mb-3"},w2={key:0,class:"badge bg-info"},k2={key:1,class:"badge bg-secondary"},$2={class:"mb-3"},S2={key:0,class:"font-monospace small"},x2={key:1,class:"text-muted small"},C2={key:0,class:"mb-3"},E2={key:0},T2={class:"list-unstyled mb-0"},A2={key:1,class:"text-muted small"},D2={class:"mb-3"},M2={class:"small"},O2={class:"mb-3"},L2={class:"small"},N2={__name:"MinionViewModal",setup(n){const e=xe(),s=O(null),o=O(null);let a=null;function c(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function u(p){if(!p)return"N/A";try{const d=new Date(p);return isNaN(d.getTime())?"Invalid date":d.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(d){return console.error("Error formatting timestamp:",d),"Invalid date"}}function f(){s.value=null}function m(){f(),e.hideModal()}return fe(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&a){const d=p.data||{};s.value=d.session,a.show()}}),Me(()=>{o.value&&Ie(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{a=new p(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),De(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),a&&a.dispose()}),(p,d)=>(i(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",n2,[t("div",o2,[d[11]||(d[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",a2,[s.value?(i(),r("div",l2,[t("div",r2,[d[0]||(d[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,k(s.value.name||"Unnamed Minion"),1)]),t("div",c2,[d[1]||(d[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",u2,k(s.value.session_id),1)]),t("div",d2,[d[2]||(d[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,k(s.value.role||"Not specified"),1)]),t("div",f2,[d[3]||(d[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:H(["badge",c(s.value.state)])},k(s.value.state),3)])]),t("div",m2,[d[4]||(d[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),r("div",p2,[t("div",v2,[(i(!0),r(se,null,le(s.value.capabilities,$=>(i(),r("span",{key:$,class:"badge bg-secondary"},k($),1))),128))])])):(i(),r("div",h2,"None"))]),t("div",_2,[d[5]||(d[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),r("div",g2,k(s.value.initialization_context),1)):(i(),r("div",b2,"Not specified"))]),t("div",y2,[d[6]||(d[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),r("span",w2,"Yes")):(i(),r("span",k2,"No"))])]),t("div",$2,[d[7]||(d[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),r("div",S2,k(s.value.parent_overseer_id),1)):(i(),r("div",x2," Root overseer (user-created) "))]),s.value.is_overseer?(i(),r("div",C2,[d[8]||(d[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),r("div",E2,[t("ul",T2,[(i(!0),r(se,null,le(s.value.child_minion_ids,$=>(i(),r("li",{key:$,class:"font-monospace small"},k($),1))),128))])])):(i(),r("div",A2,"No children"))])):E("",!0),t("div",D2,[d[9]||(d[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",M2,k(u(s.value.created_at)),1)]),t("div",O2,[d[10]||(d[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",L2,k(u(s.value.updated_at)),1)])])):(i(),r("div",i2," No minion data available "))]),d[12]||(d[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},I2=te(N2,[["__scopeId","data-v-d996dc6f"]]),P2={class:"modal-dialog modal-dialog-centered"},j2={class:"modal-content"},R2={class:"modal-header"},B2={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},F2={class:"modal-body"},V2={key:0},W2={key:0,class:"text-center py-3"},U2={key:1,class:"card bg-light mb-3"},H2={class:"card-body py-2 px-3"},q2={class:"small"},z2={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},K2={key:0,class:"text-warning mt-1"},G2={key:2,class:"alert alert-warning py-2 small"},Y2={key:1,class:"text-center py-3"},J2={key:0,class:"mb-3"},Q2={key:1,class:"mb-3"},X2={key:2,class:"mb-3"},Z2={class:"text-muted small mt-1"},eA={key:3,class:"mb-3"},tA={class:"mt-2 text-danger"},sA={class:"modal-footer"},nA=["disabled"],oA={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},aA={__name:"RestartModal",setup(n){const e=xe(),s=O(null);let o=null;const a=O("confirm"),c=O(!1),u=O(null),f=O(null),m=O(""),p=O(60);let d=null,$=null;async function v(){c.value=!0,f.value=null;try{u.value=await Xa()}catch(l){f.value=l.message||"Unknown error"}finally{c.value=!1}}async function g(){a.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Za(),e.restartStatus="restarting",w()}catch(l){e.restartStatus="error",m.value=l.message||"Restart failed",e.restartInProgress=!1}}function w(){e.restartStatus="reconnecting",p.value=60;const l=Date.now();$=setInterval(()=>{const S=Math.floor((Date.now()-l)/1e3);p.value=Math.max(0,60-S)},1e3),setTimeout(()=>{d=setInterval(async()=>{try{(await fetch("/health")).ok&&(_(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-l>6e4&&(_(),e.restartStatus="error",m.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function _(){d&&(clearInterval(d),d=null),$&&(clearInterval($),$=null)}function b(){a.value="confirm",u.value=null,f.value=null,m.value="",p.value=60,_()}function y(){e.restartInProgress||(b(),e.restartStatus="idle"),e.hideModal()}return fe(()=>e.currentModal,l=>{l?.name==="restart-server"&&o&&(b(),o.show(),v())}),Me(()=>{s.value&&Ie(async()=>{const{default:l}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:l}},__vite__mapDeps([0,1])).then(({default:l})=>{o=new l(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",y)})}),De(()=>{_(),s.value&&s.value.removeEventListener("hidden.bs.modal",y),o&&o.dispose()}),(l,S)=>(i(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",P2,[t("div",j2,[t("div",R2,[S[0]||(S[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),a.value==="confirm"?(i(),r("button",B2)):E("",!0)]),t("div",F2,[a.value==="confirm"?(i(),r("div",V2,[S[5]||(S[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),c.value?(i(),r("div",W2,[...S[1]||(S[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):u.value?(i(),r("div",U2,[t("div",H2,[t("div",q2,[t("div",null,[S[2]||(S[2]=t("strong",null,"Branch:",-1)),ce(" "+k(u.value.branch),1)]),t("div",null,[S[3]||(S[3]=t("strong",null,"Last commit:",-1)),ce(" "+k(u.value.last_commit_message),1)]),t("div",z2,k(u.value.last_commit_hash?.substring(0,12)),1),u.value.has_uncommitted_changes?(i(),r("div",K2,[...S[4]||(S[4]=[t("strong",null,"Warning:",-1),ce(" Uncommitted changes detected. git pull may fail. ",-1)])])):E("",!0)])])])):f.value?(i(),r("div",G2," Could not fetch git status: "+k(f.value),1)):E("",!0)])):a.value==="progress"?(i(),r("div",Y2,[ne(e).restartStatus==="pulling"?(i(),r("div",J2,[...S[6]||(S[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):ne(e).restartStatus==="restarting"?(i(),r("div",Q2,[...S[7]||(S[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):ne(e).restartStatus==="reconnecting"?(i(),r("div",X2,[S[8]||(S[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),S[9]||(S[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",Z2,k(p.value)+"s remaining",1)])):ne(e).restartStatus==="error"?(i(),r("div",eA,[S[10]||(S[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",tA,k(m.value),1)])):E("",!0)])):E("",!0)]),t("div",sA,[a.value==="confirm"?(i(),r(se,{key:0},[S[11]||(S[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:g,disabled:c.value}," Pull & Restart ",8,nA)],64)):ne(e).restartStatus==="error"?(i(),r("button",oA,"Close")):E("",!0)])])])],512))}},iA={class:"app-shell"},lA={class:"main-layout"},rA={class:"center-panel"},cA={__name:"App",setup(n){const e=xe(),s=rt(),o=pe(),a=qe(),c=Zt(),u=Qe(),f=ts(),m=O(null);function p(g){m.value=g}Tn("addAttachmentFromResource",p),Tn("pendingResourceAttachment",m);const d=h(()=>e.rightPanelVisible),$=h(()=>e.windowWidth<768);fe(()=>c.currentHasTasks,(g,w)=>{g&&!w&&e.setRightPanelVisible(!0)}),fe(()=>u.currentHasResources,(g,w)=>{g&&!w&&e.setRightPanelVisible(!0)}),Me(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const g=window.location.hash;if(g.startsWith("#/session/")){const w=g.replace("#/session/","");o.sessions.has(w)&&await o.selectSession(w)}else if(g.startsWith("#/timeline/")){const w=g.replace("#/timeline/","");f.push(`/timeline/${w}`)}window.addEventListener("popstate",v),window.addEventListener("resize",e.handleResize)}),De(()=>{window.removeEventListener("popstate",v),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function v(){const g=window.location.hash;if(g.startsWith("#/session/")){const w=g.replace("#/session/","");o.sessions.has(w)&&o.selectSession(w)}}return(g,w)=>{const _=cn("router-view");return i(),r("div",iA,[be(o_),be(m_),be(M_),t("div",{id:"right-panel-backdrop",class:H({show:d.value&&$.value}),onClick:w[0]||(w[0]=b=>ne(e).setRightPanelVisible(!1))},null,2),t("div",lA,[t("main",rA,[be(_)]),Se(be(qy,{class:H({"panel-overlay":$.value,"panel-visible":d.value})},null,8,["class"]),[[ot,d.value||$.value]])]),be(r1),be(S1),be(z1),be(lT),be(OT),be(s2),be(I2),be(aA)])}}},Cn=Ua(cA);Cn.use(Ha());Cn.use(Zh);Cn.mount("#app");
