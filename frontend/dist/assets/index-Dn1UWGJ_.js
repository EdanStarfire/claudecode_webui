const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c,a as s,o as a,d as nt,r as R,b as h,t as y,n as se,u as ye,e as Ke,f as re,w as ve,g as bs,F as le,h as ue,i as x,j as we,v as Fe,k as $e,l as po,m as he,p as ze,q as _e,s as kt,x as ke,y as Si,z as fo,A as Te,B as _n,C as vo,D as Ft,E as Ei,G as Ci,H as ho,T as Ti,I as xi,J as Ai,K as Mi,L as ys,M as ws,N as gn,O as Oi,P as Di}from"./vue-vendor-P3Jw5Y9s.js";import{m as dt,p as cs}from"./markdown-vendor-BRsjnVvP.js";import{c as Li}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const Ni={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ii={__name:"NoSessionSelected",setup(n){return(e,t)=>(a(),c("div",Ni,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},ji="modulepreload",Pi=function(n){return"/"+n},bn={},Me=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let p=function(f){return Promise.all(f.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),m=l?.nonce||l?.getAttribute("nonce");i=p(t.map(f=>{if(f=Pi(f),f in bn)return;bn[f]=!0;const u=f.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${w}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":ji,u||(g.as="script"),g.crossOrigin="",g.href=f,m&&g.setAttribute("nonce",m),document.head.appendChild(g),u)return new Promise((k,$)=>{g.addEventListener("load",k),g.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${f}`)))})}))}function r(l){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=l,window.dispatchEvent(m),!m.defaultPrevented)throw l}return i.then(l=>{for(const m of l||[])m.status==="rejected"&&r(m.reason);return e().catch(r)})};class $s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function St(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new $s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof $s?t:(console.error("API request failed:",t),new $s(`Network error: ${t.message}`,0,null))}}async function _o(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[m,p]of Object.entries(e.params))p!=null&&o.append(m,p);const i=o.toString();i&&(t=`${n}?${i}`);const{params:r,...l}=e;return St(t,{...l,method:"GET"})}return St(t,{...e,method:"GET"})}async function Ri(n,e,t={}){return St(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Wi(n,e,t={}){return St(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Bi(n,e={}){return St(n,{...e,method:"DELETE"})}async function Fi(n,e,t={}){return St(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const pe={get:_o,post:Ri,put:Wi,delete:Bi,patch:Fi},me=nt("session",()=>{const n=R(new Map),e=R(null),t=R(new Map),o=R(new Map),i=R(new Set),r=R(!1);let l=null;const m=h(()=>n.value.get(e.value)),p=h(()=>Array.from(n.value.values()).sort((A,V)=>A.order-V.order)),f=A=>h(()=>p.value.filter(V=>V.project_id===A)),u=h({get:()=>t.value.get(e.value)||"",set:A=>{e.value&&t.value.set(e.value,A)}});async function w(){try{const A=await pe.get("/api/sessions");return n.value.clear(),A.sessions.forEach(V=>{n.value.set(V.session_id,V)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function g(A,V){try{const S=(await pe.post("/api/sessions",{project_id:A,...V})).session_id,z=(await pe.get(`/api/sessions/${S}`)).session;return n.value.set(S,z),n.value=new Map(n.value),console.log(`Created session ${S}`),z}catch(C){throw console.error("Failed to create session:",C),C}}async function k(A){if(e.value===A&&!r.value)return;l&&(console.log(`Aborting pending selection to switch to ${A}`),l.abort(),l=null);const V=new AbortController;l=V,r.value=!0;try{if(e.value=A,V.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let C=n.value.get(A);if(!C)try{const j=await pe.get(`/api/sessions/${A}`);if(V.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}C=j.session,n.value.set(A,C),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(j){console.error(`Failed to fetch session ${A}:`,j);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await _(A),V.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${C.state} state)`);const j=6e4,H=200,G=5e3;let te=0,O=0;for(;te<j;){if(V.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const M=n.value.get(A);if(M&&M.state==="active"){console.log(`Session ${A} is now active after ${te}ms`);break}if(te-O>=G){const D=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${D}, ${te/1e3}s elapsed)`),O=te}await new Promise(D=>setTimeout(D,H)),te+=H}const L=n.value.get(A);L&&L.state!=="active"&&console.warn(`Session ${A} did not become active within ${j/1e3}s (state: ${L.state}), continuing anyway`)}catch(j){console.error(`Failed to auto-start session ${A}:`,j)}if(V.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>ia),void 0)).useMessageStore().loadMessages(A),V.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>Ta),void 0)).useResourceStore().loadResources(A),V.signal.aborted){console.log(`Selection of ${A} aborted after resource load`);return}await(await Me(()=>Promise.resolve().then(()=>xa),void 0)).useWebSocketStore().connectSession(A),V.signal.aborted||console.log(`Selected session ${A}`)}finally{l===V&&(l=null),r.value=!1}}function $(A,V){const C=n.value.get(A);C?Object.assign(C,V):(n.value.set(A,V),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function b(A){i.value.add(A);try{const C=(await pe.delete(`/api/sessions/${A}`)).deleted_session_ids||[A];for(const S of C)n.value.delete(S),t.value.delete(S),o.value.delete(S);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(V){throw console.error("Failed to delete session:",V),V}finally{i.value.delete(A)}}async function d(A,V){try{await pe.patch(`/api/sessions/${A}`,V),$(A,V),console.log(`Updated session ${A}:`,V)}catch(C){throw console.error("Failed to update session:",C),C}}async function v(A,V){try{await pe.post(`/api/sessions/${A}/permission-mode`,{mode:V}),$(A,{current_permission_mode:V});const C=o.value.get(A);C&&(C.permissionMode=V,o.value.set(A,C)),console.log(`Set permission mode for session ${A} to ${V}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function _(A){try{await pe.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(V){throw console.error("Failed to start session:",V),V}}async function T(A){try{await pe.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(V){throw console.error("Failed to pause session:",V),V}}async function E(A){try{await pe.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(V){throw console.error("Failed to terminate session:",V),V}}function B(A){return n.value.get(A)}function P(A,V){o.value.set(A,V),V.permissionMode&&$(A,{current_permission_mode:V.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:m,orderedSessions:p,sessionsInProject:f,currentInput:u,fetchSessions:w,createSession:g,selectSession:k,updateSession:$,deleteSession:b,patchSession:d,setPermissionMode:v,startSession:_,pauseSession:T,terminateSession:E,getSession:B,storeInitData:P}}),yn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:me},Symbol.toStringTag,{value:"Module"})),be=nt("ui",()=>{const n=R(window.innerWidth<768),e=R(300),t=R(!0),o=R(300),i=R(window.innerWidth),r=h(()=>i.value<768),l=R(!0),m=R(!1),p=R(null),f=R(null),u=h(()=>p.value?{name:p.value,data:f.value}:null),w=R(!1),g=R("Loading...");function k(){n.value=!n.value}function $(W){n.value=W}function b(W){e.value=Math.max(200,Math.min(W,window.innerWidth*.3))}function d(){t.value=!t.value}function v(W){t.value=W}function _(W){o.value=Math.max(200,Math.min(W,window.innerWidth*.3))}function T(W){l.value=W}function E(){const W=localStorage.getItem("webui-background-color");m.value=W==="red"}function B(){m.value=!m.value,localStorage.setItem("webui-background-color",m.value?"red":"gray")}function P(W,z=null){p.value=null,f.value=null,setTimeout(()=>{p.value=W,f.value=z},0)}function A(){p.value=null,f.value=null}function V(W="Loading..."){w.value=!0,g.value=W}function C(){w.value=!1}function S(){const W=i.value;i.value=window.innerWidth,i.value<768&&W>=768?n.value=!0:i.value>=768&&W<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:r,autoScrollEnabled:l,isRedBackground:m,activeModal:p,modalData:f,currentModal:u,isLoading:w,loadingMessage:g,toggleSidebar:k,setSidebarCollapsed:$,setSidebarWidth:b,toggleRightSidebar:d,setRightSidebarCollapsed:v,setRightSidebarWidth:_,setAutoScroll:T,initBackgroundColor:E,toggleBackgroundColor:B,showModal:P,hideModal:A,showLoading:V,hideLoading:C,handleResize:S}}),Re=nt("project",()=>{const n=R(new Map),e=R(null),t=h(()=>n.value.get(e.value)),o=h(()=>Array.from(n.value.values()).sort((d,v)=>d.order-v.order));async function i(){try{const d=await pe.get("/api/projects");return n.value.clear(),d.projects.forEach(v=>{n.value.set(v.project_id,v)}),console.log(`Loaded ${n.value.size} projects`),d.projects}catch(d){throw console.error("Failed to fetch projects:",d),d}}async function r(d,v){try{const T=(await pe.post("/api/projects",{name:d,working_directory:v})).project;return n.value.set(T.project_id,T),n.value=new Map(n.value),console.log(`Created project ${T.project_id}`),T}catch(_){throw console.error("Failed to create project:",_),_}}async function l(d,v){try{await pe.put(`/api/projects/${d}`,v),m(d,v),console.log(`Updated project ${d}`,v)}catch(_){throw console.error("Failed to update project:",_),_}}function m(d,v){const _=n.value.get(d);_&&(Object.assign(_,v),n.value=new Map(n.value))}async function p(d){try{await pe.delete(`/api/projects/${d}`),n.value.delete(d),n.value=new Map(n.value),e.value===d&&(e.value=null),console.log(`Deleted project ${d}`)}catch(v){throw console.error("Failed to delete project:",v),v}}async function f(d){try{const v=await pe.put(`/api/projects/${d}/toggle-expansion`),_=n.value.get(d);return _&&(_.is_expanded=v.is_expanded,n.value=new Map(n.value)),v.is_expanded}catch(v){throw console.error("Failed to toggle expansion:",v),v}}async function u(d){try{await pe.put("/api/projects/reorder",{project_ids:d}),d.forEach((v,_)=>{const T=n.value.get(v);T&&(T.order=_)}),n.value=new Map(n.value),console.log("Reordered projects",d)}catch(v){throw console.error("Failed to reorder projects:",v),v}}async function w(d,v){try{await pe.put(`/api/projects/${d}/sessions/reorder`,{session_ids:v});const _=n.value.get(d);_&&(_.session_ids=v,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${d}`,v)}catch(_){throw console.error("Failed to reorder sessions:",_),_}}function g(d){return n.value.get(d)}function k(d){e.value=d}function $(){e.value=null}function b(d){if(!d)return"";const v=d.split(/[/\\]/).filter(_=>_);return v.length===0?"/":v.length===1?`/${v[0]}`:v.length===2?`/${v.join("/")}`:`.../${v.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:r,updateProject:l,updateProjectLocal:m,deleteProject:p,toggleExpansion:f,reorderProjects:u,reorderSessionsInProject:w,getProject:g,selectProject:k,clearProjectSelection:$,formatPath:b}}),ie=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Hi={class:"project-name"},Vi=["title"],Ui={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=me(),o=Re(),i=be(),r=h(()=>t.sessions.get(e.sessionId)),l=h(()=>r.value?.name||e.sessionId),m=h(()=>{for(const f of o.projects.values())if(f.session_ids?.includes(e.sessionId))return f;return null}),p=h(()=>m.value?.name||"Unknown Project");return(f,u)=>(a(),c("div",{class:se(["session-header border-bottom p-3",{"theme-red-panel":ye(i).isRedBackground}])},[s("div",Hi,y(p.value),1),s("div",{class:"session-name",title:n.sessionId},y(l.value),9,Vi)],2))}},qi=ie(Ui,[["__scopeId","data-v-ba771dd8"]]),zi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ki=["title"],Gi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Yi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=me(),o=h(()=>t.sessions.get(e.sessionId)),i=h(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=h(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),l=h(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),m=h(()=>{if(!o.value)return"No session selected";const p=i.value,f=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${u}${w}: ${f}`});return(p,f)=>(a(),c("div",zi,[o.value?(a(),c("div",{key:0,class:se(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:Ke({width:"100%",backgroundColor:r.value}),title:m.value},null,14,Ki)):(a(),c("div",Gi))]))}},Ji=ie(Yi,[["__scopeId","data-v-63d222fe"]]),Qi={class:"d-flex justify-content-between align-items-center gap-2"},Xi={class:"d-flex gap-2"},Zi=["disabled"],ea={class:"mode-label"},ta=["disabled"],sa=["disabled"],na={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=me(),o=be(),i=h(()=>t.sessions.get(e.sessionId)),r=h(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},m=h(()=>l[r.value]||"ðŸ”’"),p=h(()=>r.value),f=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(r.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(v){console.error("Failed to cycle permission mode:",v)}return}const b=(f.indexOf(r.value)+1)%f.length,d=f[b];try{await t.setPermissionMode(e.sessionId,d)}catch(v){console.error("Failed to cycle permission mode:",v)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},k=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return($,b)=>(a(),c("div",{class:se(["session-status-bar border-top p-2",ye(o).isRedBackground?"theme-red-panel":"bg-light"])},[s("div",Qi,[s("div",Xi,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[re(y(m.value)+" ",1),s("span",ea,y(p.value),1)],8,Zi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!i.value},[...b[0]||(b[0]=[re(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,ta),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...b[1]||(b[1]=[re(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,sa)]),s("div",null,[s("button",{class:se(["btn btn-sm",ye(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:k}," â¬‡ï¸ "+y(ye(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},oa=ie(na,[["__scopeId","data-v-ed9a4d3c"]]),Rt=nt("task",()=>{const n=R(new Map),e=R(new Set);function t(_){const T=n.value.get(_);return T?Array.from(T.values()).sort((E,B)=>{const P=parseInt(E.id.replace(/\D/g,""))||0,A=parseInt(B.id.replace(/\D/g,""))||0;return P-A}):[]}function o(_){return t(_).find(E=>E.status==="in_progress")||null}function i(_){const T=t(_);return{total:T.length,completed:T.filter(E=>E.status==="completed").length,inProgress:T.filter(E=>E.status==="in_progress").length,pending:T.filter(E=>E.status==="pending").length}}function r(_){return e.value.has(_)}const l=h(()=>{const _=me();return t(_.currentSessionId)}),m=h(()=>{const _=me();return o(_.currentSessionId)}),p=h(()=>{const _=me();return i(_.currentSessionId)}),f=h(()=>{const _=me();return r(_.currentSessionId)});function u(_,T){n.value.has(_)||n.value.set(_,new Map),n.value.get(_).set(T.id,{id:T.id,subject:T.subject||"",description:T.description||"",status:T.status||"pending",activeForm:T.activeForm||null,owner:T.owner||null,blocks:T.blocks||[],blockedBy:T.blockedBy||[],metadata:T.metadata||{}}),e.value.add(_),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${T.id} for session ${_}`)}function w(_,T,E){const B=n.value.get(_);if(!B){console.warn(`No tasks found for session ${_}`);return}const P=B.get(T);if(!P){u(_,{id:T,...E});return}E.subject!==void 0&&(P.subject=E.subject),E.description!==void 0&&(P.description=E.description),E.status!==void 0&&(P.status=E.status),E.activeForm!==void 0&&(P.activeForm=E.activeForm),E.owner!==void 0&&(P.owner=E.owner),E.metadata!==void 0&&(P.metadata={...P.metadata,...E.metadata}),E.addBlocks&&(P.blocks=[...new Set([...P.blocks,...E.addBlocks])]),E.addBlockedBy&&(P.blockedBy=[...new Set([...P.blockedBy,...E.addBlockedBy])]),E.status==="deleted"&&(B.delete(T),B.size===0&&(e.value.delete(_),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${T} for session ${_}`,E)}function g(_,T){return n.value.get(_)?.get(T)||null}function k(_){n.value.delete(_),e.value.delete(_),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${_}`)}function $(_,T){n.value.has(_)&&n.value.get(_).clear(),e.value.delete(_);const E=new Map;for(const B of T){if(B.metadata?.tool_uses)for(const P of B.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(P.name)&&E.set(P.id,{name:P.name,input:P.input});if(B.metadata?.tool_results)for(const P of B.metadata.tool_results){const A=E.get(P.tool_use_id);A&&(b(_,A.name,A.input,{error:P.is_error,content:P.content}),E.delete(P.tool_use_id))}}console.log(`Reconstructed ${n.value.get(_)?.size||0} tasks for session ${_}`)}function b(_,T,E,B){if(B?.error){console.log(`Skipping task update - tool ${T} returned error`);return}const P=d(B);if(P)switch(T){case"TaskCreate":{const A=v(P)||E?.id;A&&u(_,{id:A,subject:E?.subject||"",description:E?.description||"",status:"pending",activeForm:E?.activeForm||null,owner:E?.owner||null,blocks:[],blockedBy:[],metadata:E?.metadata||{}});break}case"TaskUpdate":{const A=E?.taskId;A&&w(_,A,{status:E?.status,subject:E?.subject,description:E?.description,activeForm:E?.activeForm,owner:E?.owner,metadata:E?.metadata,addBlocks:E?.addBlocks,addBlockedBy:E?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{E?.taskId;break}}}function d(_){return _?typeof _=="string"?_:_.content?typeof _.content=="string"?_.content:JSON.stringify(_.content):_.message?_.message:JSON.stringify(_):null}function v(_){if(!_)return null;const T=_.match(/[Tt]ask\s*#(\d+)/i);if(T)return T[1];const E=_.match(/#(\d+)/);return E?E[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:l,currentActiveTask:m,currentTaskStats:p,currentHasTasks:f,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:r,getTask:g,createTask:u,updateTask:w,clearTasks:k,reconstructFromMessages:$,handleTaskToolResult:b}}),Oe=nt("message",()=>{const n=R(new Map),e=R(new Map),t=R(new Map),o=R(new Map),i=R(new Map),r=R(new Map),l=R(new Map),m=R(new Map),p=h(()=>{const O=me();return n.value.get(O.currentSessionId)||[]}),f=h(()=>{const O=me();return e.value.get(O.currentSessionId)||[]});async function u(O,L=null,M=0){try{const D=L||1e4,Y=await pe.get(`/api/sessions/${O}/messages?limit=${D}&offset=${M}`),ee=Y.messages||[],X=Y.total_count||ee.length,Z=Y.has_more||!1;if(console.log(`Loaded ${ee.length} of ${X} messages for session ${O}`),n.value.set(O,ee),ee.length>0){const N=ee[ee.length-1];N.timestamp&&(l.value.set(O,N.timestamp),console.log(`Tracked last received timestamp for session ${O}: ${N.timestamp}`))}const ne=new Set;ee.forEach(N=>{N.type==="assistant"&&N.metadata?.tool_uses&&N.metadata.tool_uses.forEach(U=>{ne.add(U.id)}),N.type==="user"&&N.metadata?.tool_results&&N.metadata.tool_results.forEach(U=>{ne.delete(U.tool_use_id);const Q=r.value.get(O);Q&&Q.delete(U.tool_use_id)}),N.type==="system"&&N.metadata?.subtype==="client_launched"&&(ne.forEach(U=>{C(O,U,"Session was restarted")}),ne.clear()),N.type==="system"&&N.metadata?.subtype==="interrupt"&&(ne.forEach(U=>{C(O,U,"Session was interrupted")}),ne.clear()),N.metadata?.has_tool_uses&&N.metadata.tool_uses&&N.metadata.tool_uses.forEach(U=>{b(O,U,N.timestamp)}),N.metadata?.has_tool_results&&N.metadata.tool_results&&N.metadata.tool_results.forEach(U=>{T(O,U)}),(N.type==="permission_request"||N.metadata?.has_permission_requests)&&d(O,N),N.type==="permission_response"&&v(O,{request_id:N.metadata?.request_id,decision:N.metadata?.decision,updated_input:N.metadata?.updated_input,reasoning:N.metadata?.reasoning,applied_updates:N.metadata?.applied_updates}),N.type==="system"&&(N.subtype==="init"||N.metadata?.subtype==="init")&&N.metadata?.init_data&&me().storeInitData(O,N.metadata.init_data)});const I=me().sessions.get(O);I&&!["active","paused","starting"].includes(I.state)&&(ne.forEach(N=>{C(O,N,"Session was terminated")}),ne.clear()),i.value.set(O,ne),n.value=new Map(n.value);try{Rt().reconstructFromMessages(O,ee)}catch(N){console.warn("Failed to reconstruct task state:",N)}return Z&&console.warn(`Warning: Only loaded ${ee.length} of ${X} messages. Some messages may be missing.`),{messages:ee,totalCount:X,hasMore:Z}}catch(D){throw console.error("Failed to load messages:",D),D}}function w(O,L){const M=i.value.get(O)||new Set;L.type==="assistant"&&L.metadata?.tool_uses&&L.metadata.tool_uses.forEach(D=>{M.add(D.id)}),L.type==="user"&&L.metadata?.tool_results&&L.metadata.tool_results.forEach(D=>{M.delete(D.tool_use_id);const Y=r.value.get(O);Y&&Y.delete(D.tool_use_id)}),L.type==="system"&&L.metadata?.subtype==="client_launched"&&(M.forEach(D=>{C(O,D,"Session was restarted")}),M.clear()),L.type==="system"&&L.metadata?.subtype==="interrupt"&&(M.forEach(D=>{C(O,D,"Session was interrupted")}),M.clear()),i.value.set(O,M)}function g(O,L){n.value.has(O)||n.value.set(O,[]);const M=n.value.get(O);if(L.id){const D=M.findIndex(Y=>Y.id===L.id);if(D!==-1){console.log(`Skipping duplicate message ${L.id} (already exists at index ${D})`);return}}M.push(L),L.timestamp&&l.value.set(O,L.timestamp),P(O,L),w(O,L),n.value=new Map(n.value)}function k(O,L){e.value.has(O)||e.value.set(O,[]),e.value.get(O).push(L),e.value=new Map(e.value)}function $(O,L,M){const D=e.value.get(O);if(D){const Y=D.find(ee=>ee.id===L);Y&&(Object.assign(Y,M),e.value=new Map(e.value))}}function b(O,L,M=null){const D=B(L.name,L.input);t.value.set(D,L.id);const Y={id:L.id,name:L.name,input:L.input,signature:D,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:M||new Date().toISOString(),isExpanded:!0};return k(O,Y),console.log(`Created tool call ${Y.id} for ${Y.name}`),Y}function d(O,L){console.log("handlePermissionRequest received:",L);const M=L.metadata?.tool_name||L.tool_name,D=L.metadata?.input_params||L.input_params,Y=L.metadata?.request_id||L.request_id,ee=L.metadata?.suggestions||L.suggestions||[];console.log("Extracted data:",{toolName:M,inputParams:D,requestId:Y,suggestions:ee});const X=B(M,D),Z=t.value.get(X);Z?(o.value.set(Y,Z),$(O,Z,{status:"permission_required",permissionRequestId:Y,suggestions:ee}),console.log(`Permission required for tool ${Z}`,{suggestions:ee})):console.warn("No tool use ID found for permission request signature:",X,{toolName:M,inputParams:D,availableSignatures:Array.from(t.value.keys())})}function v(O,L){const M=o.value.get(L.request_id);if(M){const D={permissionDecision:L.decision,appliedUpdates:L.applied_updates||[]};L.decision==="allow"?(D.status="executing",D.backendStatus="running"):(D.status="completed",D.backendStatus="denied",D.result={error:!0,message:L.reasoning||"Permission denied"},D.isExpanded=!1),L.updated_input&&(D.input=L.updated_input),$(O,M,D),console.log(`Permission ${L.decision} for tool ${M}`)}}function _(O,L){console.log("handleToolCall received:",L);const M=L.tool_use_id;if(!M){console.warn("Received tool_call without tool_use_id:",L);return}e.value.has(O)||e.value.set(O,[]);const D=e.value.get(O),Y=D.findIndex(Z=>Z.id===M),X={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[L.status]||L.status;if(Y!==-1){const Z=D[Y];Z.status=X,Z.backendStatus=L.status,L.permission&&(Z.suggestions=L.permission.suggestions||[],Z.permissionRequestId=L.request_id),L.permission_granted!==null&&L.permission_granted!==void 0&&(Z.permissionDecision=L.permission_granted?"allow":"deny"),L.result!==void 0&&(Z.result={error:L.status==="failed",content:L.result}),L.error&&(Z.result={error:!0,content:L.error}),L.status==="denied"&&(Z.result={error:!0,message:"Permission denied"},Z.isExpanded=!1),L.status==="interrupted"&&(C(O,M,"Session was interrupted"),Z.isExpanded=!1),(L.status==="completed"||L.status==="failed")&&(Z.isExpanded=!1),L.display&&(Z.backendState=L.display),console.log(`Updated tool call ${M} to status: ${X} (backend: ${L.status})`)}else{const Z=B(L.name,L.input);t.value.set(Z,M);const ne={id:M,name:L.name,input:L.input,signature:Z,status:X,backendStatus:L.status,permissionRequestId:L.request_id,permissionDecision:L.permission_granted!==void 0?L.permission_granted?"allow":"deny":null,suggestions:L.permission?.suggestions||[],result:L.result?{error:L.status==="failed",content:L.result}:null,explanation:null,timestamp:L.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(L.status),backendState:L.display};L.error&&(ne.result={error:!0,content:L.error}),D.push(ne),console.log(`Created new tool call ${M} for ${L.name} with status: ${X}`)}if(e.value=new Map(e.value),["completed","failed"].includes(L.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(L.name))try{Rt().handleTaskToolResult(O,L.name,L.input,{error:L.status==="failed",content:L.result})}catch(Z){console.warn("Failed to update task store:",Z)}}function T(O,L){const M=L.tool_use_id;$(O,M,{status:L.is_error?"error":"completed",result:{error:L.is_error,content:L.content},isExpanded:!1}),console.log(`Tool ${M} ${L.is_error?"failed":"completed"}`);const D=e.value.get(O);if(D){const Y=D.find(ee=>ee.id===M);if(Y&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(Y.name))try{Rt().handleTaskToolResult(O,Y.name,Y.input,{error:L.is_error,content:L.content})}catch(ee){console.warn("Failed to update task store:",ee)}}}function E(O,L){const M=e.value.get(O);if(M){const D=M.find(Y=>Y.id===L);D&&(D.isExpanded=!D.isExpanded,e.value=new Map(e.value))}}function B(O,L){if(!O)return"unknown:{}";if(!L||typeof L!="object")return`${O}:{}`;const M=JSON.stringify(L,Object.keys(L).sort());return`${O}:${M}`}function P(O,L){const M=L.metadata?.display||L.display;if(!M)return;m.value.has(O)||m.value.set(O,new Map);const D=m.value.get(O);if(M.tool_states)for(const[Y,ee]of Object.entries(M.tool_states)){D.set(Y,ee);const X=e.value.get(O);if(X){const Z=X.find(ne=>ne.id===Y);if(Z){const ne={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Z.status=ne[ee.state]||ee.state,Z.backendState=ee}}}if(M.orphaned_tools&&M.orphaned_tools.length>0){const Y=r.value.get(O)||new Map;for(const ee of M.orphaned_tools)Y.has(ee)||Y.set(ee,{reason:"denied",message:"Session was interrupted"});r.value.set(O,Y)}if(M.linked_permissions)for(const[Y,ee]of Object.entries(M.linked_permissions))o.value.set(Y,ee);M.tool_states&&Object.keys(M.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${O}:`,{toolStates:Object.keys(M.tool_states||{}).length,orphanedTools:(M.orphaned_tools||[]).length,linkedPermissions:Object.keys(M.linked_permissions||{}).length})}function A(O,L){return m.value.get(O)?.get(L)}function V(O){const L=m.value.get(O);return L&&L.size>0}function C(O,L,M){const D=r.value.get(O)||new Map;D.set(L,{reason:"denied",message:M}),r.value.set(O,D);const Y=e.value.get(O);if(Y){const ee=Y.find(X=>X.id===L);ee&&ee.isExpanded&&(ee.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${L} as orphaned: ${M}`)}function S(O,L){const M=A(O,L);return M&&M.state==="orphaned"?!0:r.value.get(O)?.has(L)||!1}function W(O,L){const M=A(O,L);return M&&M.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:M}:r.value.get(O)?.get(L)}function z(O,L){const M=i.value.get(O);M&&M.size>0&&(M.forEach(D=>C(O,D,L)),M.clear())}function j(O){n.value.delete(O),e.value.delete(O),n.value=new Map(n.value),e.value=new Map(e.value)}function H(O){return l.value.get(O)}async function G(O){const L=l.value.get(O);if(!L)return console.log(`No sync needed for session ${O} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${O} since ${L}`);const M=await pe.get(`/api/sessions/${O}/messages?limit=1000&offset=0`),D=M.messages||[],Y=M.has_more||!1,ee=U=>U?typeof U=="number"?U*1e3:new Date(U).getTime():0,X=ee(L),Z=D.filter(U=>U.timestamp?ee(U.timestamp)>X:!1);if(Z.length===0)return console.log(`No missed messages for session ${O}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Z.length} missed messages for session ${O}`);const ne=n.value.get(O)||[],K=new Set(ne.map(U=>U.id).filter(Boolean)),I=Z.filter(U=>!U.id||!K.has(U.id));if(console.log(`After deduplication: ${I.length} unique new messages`),I.length>0){const U=I.sort((ge,q)=>{const ae=ee(ge.timestamp),de=ee(q.timestamp);return ae-de}),Q=n.value.get(O)||[],F=Q.length>0?ee(Q[Q.length-1].timestamp):0,oe=ee(U[0].timestamp),fe=ee(U[U.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Q.length,lastExisting:F,lastExistingDate:Q.length>0?Q[Q.length-1].timestamp:"none",firstNew:oe,firstNewDate:U[0].timestamp,lastNew:fe,lastNewDate:U[U.length-1].timestamp,shouldAppend:oe>F}),oe>F){const ge=[...Q,...U];n.value.set(O,ge),console.log(`âœ… Appended ${U.length} new messages (no full sort needed)`)}else{const ge=[...Q,...U].sort((q,ae)=>{const de=ee(q.timestamp),Ae=ee(ae.timestamp);return de-Ae});n.value.set(O,ge),console.log(`âš ï¸ Merged and sorted ${U.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${ne.length} messages unchanged`);I.forEach(U=>{w(O,U),U.metadata?.has_tool_uses&&U.metadata.tool_uses&&U.metadata.tool_uses.forEach(Q=>{b(O,Q,U.timestamp)}),U.metadata?.has_tool_results&&U.metadata.tool_results&&U.metadata.tool_results.forEach(Q=>{T(O,Q)}),(U.type==="permission_request"||U.metadata?.has_permission_requests)&&d(O,U),U.type==="permission_response"&&v(O,{request_id:U.metadata?.request_id,decision:U.metadata?.decision,updated_input:U.metadata?.updated_input,reasoning:U.metadata?.reasoning,applied_updates:U.metadata?.applied_updates}),U.type==="system"&&(U.subtype==="init"||U.metadata?.subtype==="init")&&U.metadata?.init_data&&me().storeInitData(O,U.metadata.init_data)});const N=n.value.get(O);if(N&&N.length>0){const U=N[N.length-1];U.timestamp&&l.value.set(O,U.timestamp)}return n.value=new Map(n.value),{syncedCount:I.length,hasMore:Y}}catch(M){return console.error(`Failed to sync messages for session ${O}:`,M),{syncedCount:0,hasMore:!1,error:M.message}}}const te=me();return ve(()=>Array.from(te.sessions.values()).map(L=>({id:L.session_id,state:L.state})),(O,L)=>{L&&O.forEach((M,D)=>{const Y=L[D];if(!Y||Y.id!==M.id)return;const ee=["active","paused","starting"].includes(Y.state),X=!["active","paused","starting"].includes(M.state);ee&&X&&z(M.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:bs(i),orphanedToolUses:bs(r),currentMessages:p,currentToolCalls:f,loadMessages:u,addMessage:g,addToolCall:k,updateToolCall:$,handleToolCall:_,handleToolUse:b,handlePermissionRequest:d,handlePermissionResponse:v,handleToolResult:T,toggleToolExpansion:E,clearMessages:j,markToolUseOrphaned:C,isToolUseOrphaned:S,getOrphanedInfo:W,clearOrphanedToolUses:z,getLastReceivedTimestamp:H,syncMessages:G,getBackendToolState:A,hasBackendDisplayMetadata:V,backendToolStates:bs(m)}}),ia=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Oe},Symbol.toStringTag,{value:"Module"}));function aa(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ht(n){return aa(n).toLocaleTimeString()}const ra={class:"message-row message-row-user"},la=["title"],ca={class:"message-content-column"},ua=["innerHTML"],da={key:0,class:"tool-results mt-2"},ma={class:"tool-results-header text-muted small mb-2"},pa={class:"d-flex align-items-start gap-2"},fa={class:"flex-grow-1"},va={class:"text-muted"},ha={key:0,class:"text-danger small"},_a={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=h(()=>Ht(e.message.timestamp)),o=h(()=>`user
${t.value}`),i=h(()=>{const p=e.message.content||"";let f=dt.parse(p);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),cs.sanitize(f)}),r=h(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=h(()=>e.message.metadata?.tool_results||[]);function m(p,f){return p?p.length<=f?p:p.substring(0,f)+"...":""}return(p,f)=>(a(),c("div",ra,[s("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,la),s("div",ca,[s("div",{class:"message-text",innerHTML:i.value},null,8,ua),r.value?(a(),c("div",da,[s("div",ma," ðŸ”§ Tool Results ("+y(l.value.length)+") ",1),(a(!0),c(le,null,ue(l.value,(u,w)=>(a(),c("div",{key:w,class:se(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",pa,[s("span",null,y(u.is_error?"âŒ":"âœ…"),1),s("div",fa,[s("small",va,"Tool: "+y(u.tool_use_id),1),u.is_error?(a(),c("div",ha,y(m(u.content,200)),1)):x("",!0)])])],2))),128))])):x("",!0)])]))}},ga=ie(_a,[["__scopeId","data-v-7665755b"]]),ba={class:"thinking-block"},ya=["aria-label"],wa={class:"text-muted ms-auto"},$a={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ka=["innerHTML"],Sa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=R(!1),o=h(()=>e.thinking?.length||0),i=h(()=>{const l=e.thinking||"",m=dt.parse(l);return cs.sanitize(m)});function r(){t.value=!t.value}return(l,m)=>(a(),c("div",ba,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[s("span",{"aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,ya),m[0]||(m[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",wa,y(o.value)+" characters",1)]),t.value?(a(),c("div",$a,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ka)])):x("",!0)]))}},Ea=ie(Sa,[["__scopeId","data-v-fda2352c"]]),wn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),ks={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Ze=nt("resource",()=>{const n=R(new Map),e=R(!1),t=R(0),o=R(null),i=R(!1),r=R(new Map);function l(F){if(!F)return!1;if(F.is_image===!0||(F.mime_type||"").toLowerCase().startsWith("image/"))return!0;const fe=(F.format||"").toLowerCase();if(fe.startsWith("image/")||wn.has("."+fe))return!0;const ge=F.original_filename||F.original_name||"";if(ge){const q="."+ge.split(".").pop().toLowerCase();return wn.has(q)}return!1}function m(F){if(!F||l(F))return!1;const oe=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),fe=F.original_filename||F.original_name||"";if(fe){const q="."+fe.split(".").pop().toLowerCase();if(oe.has(q))return!0}const ge=(F.mime_type||F.format||"").toLowerCase();return!!(ge.startsWith("text/")||ge==="application/json"||ge==="application/xml")}function p(F){if(l(F))return"ðŸ–¼ï¸";if(F.original_filename){const oe="."+F.original_filename.split(".").pop().toLowerCase();return ks[oe]||ks.default}return ks.default}function f(F){return F.original_filename?"."+F.original_filename.split(".").pop().toLowerCase():""}function u(F){const oe=n.value.get(F);return oe||[]}function w(F){return n.value.get(F)?.length||0}function g(F){return w(F)>0}function k(F){return u(F).filter(l)}function $(F){return k(F).length}function b(F){return $(F)>0}const d=h(()=>{const F=me();return u(F.currentSessionId)}),v=h(()=>{const F=me();return w(F.currentSessionId)}),_=h(()=>v.value>0),T=h(()=>d.value.filter(l)),E=h(()=>T.value.length),B=h(()=>E.value>0),P=h(()=>!e.value||!o.value?null:u(o.value)[t.value]||null),A=P,V=h(()=>o.value?w(o.value):0),C=V;async function S(F){if(F){i.value=!0;try{const fe=(await _o(`/api/sessions/${F}/resources`)).resources||[];fe.sort((ge,q)=>(ge.timestamp||0)-(q.timestamp||0)),n.value.set(F,fe),n.value=new Map(n.value),console.log(`Loaded ${fe.length} resources for session ${F}`)}catch(oe){console.error(`Failed to load resources for session ${F}:`,oe),n.value.set(F,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const W=S;function z(F,oe){if(!F||!oe)return;let fe=n.value.get(F);fe||(fe=[],n.value.set(F,fe));const ge=fe.findIndex(q=>q.resource_id===oe.resource_id);ge>=0?fe[ge]=oe:fe.push(oe),fe.sort((q,ae)=>(q.timestamp||0)-(ae.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${oe.resource_id} to session ${F}`)}const j=z;function H(F,oe){return`/api/sessions/${F}/resources/${oe}`}const G=H;function te(F,oe){return`/api/sessions/${F}/resources/${oe}/download`}function O(F,oe=0){o.value=F,t.value=Math.max(0,Math.min(oe,w(F)-1)),e.value=!0}function L(){e.value=!1}function M(){if(!o.value)return;const F=w(o.value);F!==0&&(t.value=(t.value+1)%F)}const D=M;function Y(){if(!o.value)return;const F=w(o.value);F!==0&&(t.value=(t.value-1+F)%F)}const ee=Y;function X(F){if(!o.value)return;const oe=w(o.value);oe!==0&&(t.value=Math.max(0,Math.min(F,oe-1)))}const Z=X;function ne(F){n.value.delete(F),n.value=new Map(n.value),o.value===F&&L(),console.log(`Cleared resources for session ${F}`)}const K=ne;async function I(F,oe){if(!F||!oe)return null;const fe=r.value.get(oe);if(fe&&!fe.error)return fe.content;r.value.set(oe,{content:null,loading:!0,error:null}),r.value=new Map(r.value);try{const ge=H(F,oe),q=await fetch(ge);if(!q.ok)throw new Error(`HTTP ${q.status}`);const ae=await q.text();return r.value.set(oe,{content:ae,loading:!1,error:null}),r.value=new Map(r.value),ae}catch(ge){return console.error(`Failed to fetch text content for resource ${oe}:`,ge),r.value.set(oe,{content:null,loading:!1,error:ge.message}),r.value=new Map(r.value),null}}function N(F){return r.value.get(F)||null}function U(F){if(F){const oe=n.value.get(F);oe&&(oe.forEach(fe=>r.value.delete(fe.resource_id)),r.value=new Map(r.value))}else r.value=new Map}function Q(F,oe){const fe=n.value.get(F);return fe&&fe.find(ge=>ge.resource_id===oe)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:t,fullViewSessionId:o,loading:i,textContentCache:r,currentResources:d,currentResourceCount:v,currentHasResources:_,currentFullViewResource:P,fullViewTotalResources:V,currentImages:T,currentImageCount:E,currentHasImages:B,currentFullViewImage:A,fullViewTotalImages:C,imagesBySession:n,resourcesForSession:u,resourceCount:w,hasResources:g,getResourceUrl:H,getDownloadUrl:te,isImageResource:l,isTextResource:m,getResourceIcon:p,getResourceExtension:f,getResourceById:Q,getTextContent:N,imagesForSession:k,imageCount:$,hasImages:b,getImageUrl:G,loadResources:S,addResource:z,openFullView:O,closeFullView:L,nextResource:M,prevResource:Y,goToResource:X,clearResources:ne,fetchTextContent:I,clearTextCache:U,loadImages:W,addImage:j,nextImage:D,prevImage:ee,goToImage:Z,clearImages:K}}),Ca=Ze,Ta=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ca,useResourceStore:Ze},Symbol.toStringTag,{value:"Module"})),ot=nt("websocket",()=>{const n=R(null),e=R(!1),t=R(0),o=10,i=R(null),r=R(!1),l=R(0),m=5,p=R(null);let f=null;const u=R(0),w=R(null),g=R(new Map),k=R(null),$=R(!1),b=R(0),d=5,v=R(null),_=1e4,T=1e3,E=R(Date.now()),B=R(Date.now()),P=R(Date.now());let A=null,V=null,C=null;const S=h(()=>e.value&&(r.value||!p.value)?"connected":e.value?"partial":"disconnected");function W(I){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${I}`}function z(I){const N={ui:{timer:()=>A,setTimer:U=>{A=U},lastPing:E,connected:e,name:"UI"},session:{timer:()=>V,setTimer:U=>{V=U},lastPing:B,connected:r,name:"Session"},legion:{timer:()=>C,setTimer:U=>{C=U},lastPing:P,connected:$,name:"Legion"}}[I];N.timer()&&clearInterval(N.timer()),N.setTimer(setInterval(()=>{if(!N.connected.value)return;const U=Date.now()-N.lastPing.value;if(U>_){console.warn(`âš ï¸ ${N.name} WebSocket heartbeat timeout (${U}ms since last ping) - forcing close to trigger reconnection`),N.connected.value=!1;const F={ui:n,session:i,legion:k}[I];F.value&&F.value.readyState===WebSocket.OPEN&&F.value.close()}},T)),console.log(`âœ… Started heartbeat monitor for ${N.name} WebSocket`)}function j(I){const N={ui:{get:()=>A,set:U=>{A=U}},session:{get:()=>V,set:U=>{V=U}},legion:{get:()=>C,set:U=>{C=U}}}[I];N.get()&&(clearInterval(N.get()),N.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${I} WebSocket`))}function H(){if(n.value)return;const I=W("/ws/ui");console.log(`Connecting to UI WebSocket: ${I}`),n.value=new WebSocket(I),n.value.onopen=()=>{e.value=!0,t.value=0,E.value=Date.now(),z("ui"),console.log("UI WebSocket connected")},n.value.onmessage=N=>{const U=JSON.parse(N.data);ee(U)},n.value.onclose=()=>{if(j("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const N=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${N}ms (attempt ${t.value})`),setTimeout(H,N)}},n.value.onerror=N=>{console.error("UI WebSocket error:",N)}}function G(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function te(I){u.value++;const N=u.value;if(console.log(`[Gen ${N}] Starting connection to session ${I}`),f&&(clearTimeout(f),f=null),await O(),u.value!==N){console.log(`[Gen ${N}] Connection cancelled (current generation: ${u.value})`);return}p.value=I,w.value=N;const U=W(`/ws/session/${I}`);console.log(`[Gen ${N}] Connecting to Session WebSocket: ${U}`),i.value=new WebSocket(U),i.value.onopen=async()=>{if(w.value!==N){console.log(`[Gen ${N}] Ignoring onopen (stale connection, current: ${w.value})`),i.value.close();return}r.value=!0,l.value=0,B.value=Date.now(),z("session"),console.log(`[Gen ${N}] Session WebSocket connected for ${I}`);const Q=g.value.get(I);if(g.value.set(I,!0),Q){console.log(`[Gen ${N}] Reconnection detected, syncing missed messages...`);try{const oe=await Oe().syncMessages(I);oe.syncedCount>0?console.log(`[Gen ${N}] âœ… Synced ${oe.syncedCount} missed messages`):oe.error?console.warn(`[Gen ${N}] âš ï¸ Message sync failed: ${oe.error}`):console.log(`[Gen ${N}] No missed messages to sync`),oe.hasMore&&console.warn(`[Gen ${N}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(F){console.error(`[Gen ${N}] Error during message sync:`,F)}}else console.log(`[Gen ${N}] Initial connection, no sync needed`)},i.value.onmessage=Q=>{if(w.value!==N){console.log(`[Gen ${N}] Ignoring message (stale connection, current: ${w.value})`);return}const F=JSON.parse(Q.data);X(F,I)},i.value.onclose=()=>{j("session"),r.value=!1,i.value=null,console.log(`[Gen ${N}] Session WebSocket closed for ${I}`);const Q=me();if(Q.currentSessionId===I&&w.value===N&&l.value<m){l.value++;const F=Math.min(2e3*l.value,3e4);console.log(`[Gen ${N}] Reconnecting Session WebSocket in ${F}ms (attempt ${l.value})`),f=setTimeout(()=>{w.value===N&&Q.currentSessionId===I?(f=null,te(I)):console.log(`[Gen ${N}] Skipping reconnect (generation or session changed)`)},F)}},i.value.onerror=Q=>{console.error(`[Gen ${N}] Session WebSocket error:`,Q)}}function O(){return new Promise(I=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const N=p.value,U=()=>{i.value=null,r.value=!1,p.value=null,w.value=null,l.value=0,N&&g.value.delete(N),I()};if(i.value.readyState===WebSocket.CLOSED)U();else{const Q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),U()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Q),U()},{once:!0}),i.value.close()}}else p.value=null,w.value=null,I()})}function L(I){i.value&&r.value?(i.value.send(JSON.stringify({type:"send_message",content:I})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function M(I,N,U=!1,Q=null){if(i.value&&r.value){const F={type:"permission_response",request_id:I,decision:N,apply_suggestions:U,timestamp:new Date().toISOString()};Q&&(F.clarification_message=Q),i.value.send(JSON.stringify(F)),console.log(`Sent permission ${N} for request ${I}`,{applySuggestions:U,clarification:Q})}}function D(I,N,U){if(i.value&&r.value){const Q={type:"permission_response",request_id:I,decision:N,updated_input:U,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(Q)),console.log(`Sent permission ${N} with updated_input for request ${I}`,U)}}function Y(){i.value&&r.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ee(I){const N=me(),U=Re();switch(I.type){case"sessions_list":I.sessions&&Array.isArray(I.sessions)&&I.sessions.forEach(Q=>{N.updateSession(Q.session_id,Q)});break;case"state_change":I.data&&I.data.session_id&&I.data.session&&N.updateSession(I.data.session_id,I.data.session);break;case"project_updated":if(I.data&&I.data.project){const Q=I.data.project;U.updateProjectLocal(Q.project_id,Q),N.fetchSessions()}break;case"project_deleted":I.data&&I.data.project_id&&U.projects.delete(I.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":E.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",I.type)}}function X(I,N){const U=me();if(U.currentSessionId!==N){console.warn(`Ignoring message for session ${N} (current: ${U.currentSessionId})`);return}const Q=Oe();switch(I.type){case"message":const F=I.data;if(!F||!F.type){console.warn("Received message event with invalid data:",I);break}if(F.type==="tool_call"){Q.handleToolCall(N,F);break}if(F.type==="permission_request"){Q.handlePermissionRequest(N,F);break}if(F.type==="permission_response"){Q.handlePermissionResponse(N,F);break}F.metadata?.has_tool_uses&&F.metadata.tool_uses.forEach(oe=>{Q.handleToolUse(N,oe,F.timestamp)}),F.metadata?.has_tool_results&&F.metadata.tool_results.forEach(oe=>{Q.handleToolResult(N,oe)}),F.type==="system"&&(F.subtype==="init"||F.metadata?.subtype==="init")&&F.metadata?.init_data&&U.storeInitData(N,F.metadata.init_data),Q.addMessage(N,F);break;case"permission_request":Q.handlePermissionRequest(N,I);break;case"permission_response":Q.handlePermissionResponse(N,I);break;case"tool_result":Q.handleToolResult(N,I);break;case"state_change":U.updateSession(N,I.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${N}`);break;case"ping":B.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":I.resource&&(Ze().addResource(N,I.resource),console.log(`Resource registered for session ${N}:`,I.resource.resource_id));break;case"image_registered":I.image&&(Ze().addResource(N,{...I.image,resource_id:I.image.image_id}),console.log(`Image registered (legacy) for session ${N}:`,I.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",I.type)}}function Z(I){ne(),v.value=I;const N=W(`/ws/legion/${I}`);console.log(`Connecting to Legion WebSocket: ${N}`),k.value=new WebSocket(N),k.value.onopen=()=>{$.value=!0,b.value=0,P.value=Date.now(),z("legion"),console.log(`Legion WebSocket connected for ${I}`)},k.value.onmessage=U=>{const Q=JSON.parse(U.data);K(Q,I)},k.value.onclose=()=>{if(j("legion"),$.value=!1,k.value=null,console.log(`Legion WebSocket closed for ${I}`),v.value===I&&b.value<d){b.value++;const U=Math.min(2e3*b.value,3e4);setTimeout(()=>Z(I),U)}},k.value.onerror=U=>{console.error("Legion WebSocket error:",U)}}function ne(){k.value&&(k.value.close(),k.value=null,$.value=!1,v.value=null)}function K(I,N){Me(async()=>{const{useLegionStore:U}=await Promise.resolve().then(()=>Wb);return{useLegionStore:U}},void 0).then(({useLegionStore:U})=>{const Q=U();switch(I.type){case"comm":I.comm&&(Q.addComm(N,I.comm),console.log("Legion WebSocket: Received new comm",I.comm));break;case"minion_created":I.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",I.data),Me(async()=>{const{useSessionStore:F}=await Promise.resolve().then(()=>yn);return{useSessionStore:F}},void 0).then(({useSessionStore:F})=>{F().loadSessions()}));break;case"minion_updated":I.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",I.data),Me(async()=>{const{useSessionStore:F}=await Promise.resolve().then(()=>yn);return{useSessionStore:F}},void 0).then(({useSessionStore:F})=>{F().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${N}`);break;case"ping":P.value=Date.now(),k.value?.readyState===WebSocket.OPEN&&k.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",I.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:r,sessionRetryCount:l,legionConnected:$,legionRetryCount:b,overallStatus:S,connectUI:H,disconnectUI:G,connectSession:te,disconnectSession:O,sendMessage:L,sendPermissionResponse:M,sendPermissionResponseWithInput:D,interruptSession:Y,connectLegion:Z,disconnectLegion:ne}}),xa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ot},Symbol.toStringTag,{value:"Module"})),Aa={class:"base-tool-handler"},Ma={class:"tool-section"},Oa={class:"tool-parameters"},Da={class:"tool-code"},La={key:0,class:"tool-section"},Na={class:"tool-section-label"},Ia={class:"tool-code"},ja={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=h(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,m)=>(a(),c("div",Aa,[s("div",Ma,[m[0]||(m[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",Oa,[s("pre",Da,y(t.value),1)])]),o.value?(a(),c("div",La,[s("div",Na,y(i.value?"Error:":"Result:"),1),s("div",{class:se(["tool-result",{"tool-result-error":i.value}])},[s("pre",Ia,y(r.value),1)],2)])):x("",!0)]))}},Pa=ie(ja,[["__scopeId","data-v-1e69f57d"]]),Ra={class:"read-tool-handler"},Wa={class:"tool-section"},Ba={class:"read-file-info"},Fa={class:"file-icon"},Ha={class:"file-path"},Va={key:0,class:"read-range"},Ua={key:0,class:"tool-section"},qa={key:0,class:"tool-result tool-result-error"},za={class:"tool-code"},Ka={key:1,class:"image-preview"},Ga={class:"content-header"},Ya={class:"image-badge"},Ja={class:"image-container"},Qa=["src","alt"],Xa={key:2,class:"file-content-preview"},Za={class:"content-header"},er={class:"line-count-badge"},tr={key:0,class:"preview-note"},sr={class:"tool-code content-display"},nr={key:0,class:"more-indicator"},Ss=100,or={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>{const v=t.value;return v.split("/").pop()||v}),i=h(()=>{const v=e.toolCall.input?.offset,_=e.toolCall.input?.limit;return v!==void 0||_!==void 0}),r=h(()=>{const v=e.toolCall.input?.offset;return v!==void 0?v+1:1}),l=h(()=>{const v=e.toolCall.input?.offset||0,_=e.toolCall.input?.limit;return _!==void 0?v+_:"âˆž"}),m=h(()=>{const v=t.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(v)}),p=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>{if(!p.value||f.value)return null;const _=e.toolCall.result?.content;if(Array.isArray(_)){for(const T of _)if(T?.type==="image"&&T?.source?.type==="base64"&&T?.source?.data)return T.source.data}return null}),w=h(()=>{if(!u.value)return"";const v=t.value.toLowerCase();return v.endsWith(".png")?"image/png":v.endsWith(".jpg")||v.endsWith(".jpeg")?"image/jpeg":v.endsWith(".gif")?"image/gif":v.endsWith(".webp")?"image/webp":v.endsWith(".svg")?"image/svg+xml":v.endsWith(".bmp")?"image/bmp":v.endsWith(".ico")?"image/x-icon":"image/png"}),g=h(()=>{if(!p.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),k=h(()=>f.value||!g.value||u.value?[]:g.value.split(`
`)),$=h(()=>k.value.length),b=h(()=>$.value>Ss),d=h(()=>f.value||u.value?"":k.value.slice(0,Ss).join(`
`));return(v,_)=>(a(),c("div",Ra,[s("div",Wa,[s("div",Ba,[s("span",Fa,y(m.value?"ðŸ–¼ï¸":"ðŸ“„"),1),_[0]||(_[0]=s("strong",null,"Reading:",-1)),s("code",Ha,y(t.value),1),i.value?(a(),c("span",Va,"Lines "+y(r.value)+"-"+y(l.value),1)):x("",!0)])]),p.value?(a(),c("div",Ua,[f.value?(a(),c("div",qa,[s("pre",za,y(g.value),1)])):u.value?(a(),c("div",Ka,[s("div",Ga,[_[1]||(_[1]=s("span",{class:"content-label"},"Image Preview:",-1)),s("span",Ya,y(w.value),1)]),s("div",Ja,[s("img",{src:`data:${w.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,Qa)])])):(a(),c("div",Xa,[s("div",Za,[_[2]||(_[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",er,y($.value)+" lines",1),b.value?(a(),c("span",tr,"(showing first "+y(Ss)+")")):x("",!0)]),s("pre",sr,y(d.value),1),b.value?(a(),c("div",nr,"...")):x("",!0)]))])):x("",!0)]))}},ir=ie(or,[["__scopeId","data-v-29b774b1"]]),ar={class:"write-tool-handler"},rr={class:"tool-section"},lr={class:"write-file-info mb-2"},cr={class:"file-path"},ur={class:"write-content-preview"},dr={class:"content-header"},mr={class:"line-count-badge"},pr={key:0,class:"preview-note"},fr={class:"tool-code content-display"},vr={key:0,class:"more-indicator"},hr={key:0,class:"tool-section"},_r={key:0,class:"tool-result tool-result-error"},gr={class:"tool-code"},br={key:1,class:"tool-result tool-result-success"},yr={class:"success-message"},Es=100,wr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.content||""),i=h(()=>o.value.split(`
`)),r=h(()=>i.value.length),l=h(()=>r.value>Es),m=h(()=>i.value.slice(0,Es).join(`
`)),p=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>{if(!p.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,g)=>(a(),c("div",ar,[s("div",rr,[s("div",lr,[g[0]||(g[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=s("strong",null,"Writing:",-1)),s("code",cr,y(t.value),1)]),s("div",ur,[s("div",dr,[g[2]||(g[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",mr,y(r.value)+" lines",1),l.value?(a(),c("span",pr,"(showing first "+y(Es)+")")):x("",!0)]),s("pre",fr,y(m.value),1),l.value?(a(),c("div",vr,"...")):x("",!0)])]),p.value?(a(),c("div",hr,[f.value?(a(),c("div",_r,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",gr,y(u.value),1)])):(a(),c("div",br,[s("div",yr,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+y(r.value)+" lines written)",1)])]))])):x("",!0)]))}},$r=ie(wr,[["__scopeId","data-v-ddc24a0f"]]),kr={class:"bash-tool-handler"},Sr={class:"tool-section"},Er={class:"bash-header"},Cr={class:"bash-header-content"},Tr={key:0,class:"bash-description"},xr={key:1,class:"bash-flags"},Ar={class:"bash-command-section"},Mr={class:"bash-command-content"},Or={key:0,class:"tool-section"},Dr={key:0,class:"bash-output"},Lr={key:1,class:"bash-output-empty"},Nr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.command||""),o=h(()=>e.toolCall.input?.description||""),i=h(()=>e.toolCall.input?.timeout),r=h(()=>e.toolCall.input?.run_in_background||!1),l=h(()=>i.value||r.value),m=h(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),r.value&&g.push("background"),g.join(", ")}),p=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=h(()=>f.value?"tool-result-error":"tool-result-success"),w=h(()=>{if(!p.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),c("div",kr,[s("div",Sr,[s("div",Er,[k[1]||(k[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",Cr,[o.value?(a(),c("div",Tr,[k[0]||(k[0]=s("strong",null,"Description:",-1)),re(" "+y(o.value),1)])):x("",!0),l.value?(a(),c("div",xr,y(m.value),1)):x("",!0)])]),s("div",Ar,[k[2]||(k[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",Mr,y(t.value),1)])]),p.value?(a(),c("div",Or,[s("div",{class:se(["tool-result",u.value])},[k[3]||(k[3]=s("strong",null,"Output:",-1)),w.value?(a(),c("pre",Dr,y(w.value),1)):(a(),c("div",Lr,"No output"))],2)])):x("",!0)]))}},Ir=ie(Nr,[["__scopeId","data-v-ab50fe73"]]),jr={class:"todo-tool-handler"},Pr={class:"tool-section"},Rr={class:"todo-header"},Wr={class:"todo-summary"},Br={key:0,class:"todo-count todo-count-completed"},Fr={key:1,class:"todo-count todo-count-in-progress"},Hr={key:2,class:"todo-count todo-count-pending"},Vr={class:"todo-checklist"},Ur={class:"todo-checkbox"},qr={class:"todo-content"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Yr={key:1,class:"tool-result tool-result-success"},Jr={class:"success-message"},Qr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.todos||[]),o=h(()=>t.value.filter(u=>u.status==="completed").length),i=h(()=>t.value.filter(u=>u.status==="in_progress").length),r=h(()=>t.value.filter(u=>u.status==="pending").length);function l(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const m=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=h(()=>{if(!m.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,w)=>(a(),c("div",jr,[s("div",Pr,[s("div",Rr,[w[0]||(w[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=s("strong",null,"Task List:",-1)),s("div",Wr,[o.value>0?(a(),c("span",Br,y(o.value)+" completed ",1)):x("",!0),i.value>0?(a(),c("span",Fr,y(i.value)+" in progress ",1)):x("",!0),r.value>0?(a(),c("span",Hr,y(r.value)+" pending ",1)):x("",!0)])]),s("div",Vr,[(a(!0),c(le,null,ue(t.value,(g,k)=>(a(),c("div",{key:k,class:se(["todo-item",`todo-${g.status}`])},[s("span",Ur,y(l(g.status)),1),s("span",qr,y(g.content),1)],2))),128))])]),m.value?(a(),c("div",zr,[p.value?(a(),c("div",Kr,[w[2]||(w[2]=s("strong",null,"Error:",-1)),s("pre",Gr,y(f.value),1)])):(a(),c("div",Yr,[s("div",Jr,[w[3]||(w[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+y(t.value.length)+" tasks)",1)])]))])):x("",!0)]))}},Xr=ie(Qr,[["__scopeId","data-v-bbe55ee7"]]),Zr={class:"edit-tool-handler"},el={class:"tool-section"},tl={class:"edit-file-info"},sl={class:"file-path"},nl={key:0,class:"replace-all-badge"},ol={class:"edit-diff-container"},il={class:"diff-header"},al={class:"diff-stats"},rl={class:"stat-removed"},ll={class:"stat-added"},cl={class:"unified-diff"},ul={class:"diff-scroll-container"},dl={class:"diff-marker"},ml={class:"diff-content"},pl={key:0,class:"tool-section"},fl={key:0,class:"tool-result tool-result-error"},vl={class:"tool-code"},hl={key:1,class:"tool-result tool-result-success"},_l={class:"success-message"},gl={key:0,class:"success-detail"},bl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.file_path||"Unknown"),o=h(()=>e.toolCall.input?.old_string||""),i=h(()=>e.toolCall.input?.new_string||""),r=h(()=>e.toolCall.input?.replace_all||!1),l=h(()=>{const k=Li(t.value,o.value,i.value,"","",{context:3}).split(`
`),$=[];for(let b=4;b<k.length;b++){const d=k[b];d&&(d.startsWith("-")?$.push({type:"removed",content:d.substring(1)}):d.startsWith("+")?$.push({type:"added",content:d.substring(1)}):d.startsWith(" ")?$.push({type:"context",content:d.substring(1)}):d.startsWith("@@")&&$.push({type:"hunk",content:d}))}return $}),m=h(()=>l.value.filter(g=>g.type==="removed").length),p=h(()=>l.value.filter(g=>g.type==="added").length),f=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),c("div",Zr,[s("div",el,[s("div",tl,[k[0]||(k[0]=s("span",{class:"file-icon"},"âœï¸",-1)),k[1]||(k[1]=s("strong",null,"Editing:",-1)),s("code",sl,y(t.value),1),r.value?(a(),c("span",nl,"Replace All")):x("",!0)]),s("div",ol,[s("div",il,[k[2]||(k[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",al,[s("span",rl,"-"+y(m.value),1),s("span",ll,"+"+y(p.value),1)])]),s("div",cl,[s("div",ul,[(a(!0),c(le,null,ue(l.value,($,b)=>(a(),c("div",{key:b,class:se(["diff-line",{"diff-line-removed":$.type==="removed","diff-line-added":$.type==="added","diff-line-context":$.type==="context","diff-line-hunk":$.type==="hunk"}])},[s("span",dl,y($.type==="removed"?"-":$.type==="added"?"+":$.type==="hunk"?"@":" "),1),s("span",ml,y($.content),1)],2))),128))])])])]),f.value?(a(),c("div",pl,[u.value?(a(),c("div",fl,[k[3]||(k[3]=s("strong",null,"Error:",-1)),s("pre",vl,y(w.value),1)])):(a(),c("div",hl,[s("div",_l,[k[4]||(k[4]=s("span",{class:"success-icon"},"âœ…",-1)),k[5]||(k[5]=s("strong",null,"File edited successfully",-1)),r.value?(a(),c("span",gl,"(all occurrences replaced)")):x("",!0)])]))])):x("",!0)]))}},yl=ie(bl,[["__scopeId","data-v-dd74055e"]]),wl={class:"search-tool-handler"},$l={class:"tool-section"},kl={class:"search-info"},Sl={class:"search-icon"},El={class:"search-pattern"},Cl={key:0,class:"search-path"},Tl={key:1,class:"search-filters"},xl={key:0,class:"filter-badge"},Al={key:1,class:"filter-badge"},Ml={key:2,class:"filter-badge"},Ol={key:0,class:"tool-section"},Dl={key:0,class:"tool-result tool-result-error"},Ll={class:"tool-code"},Nl={key:1,class:"search-results"},Il={class:"results-header"},jl={class:"results-label"},Pl={class:"results-count-badge"},Rl={class:"results-content"},Wl={class:"tool-code"},Bl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="Grep"),o=h(()=>e.toolCall.input?.pattern||"Unknown"),i=h(()=>e.toolCall.input?.path||null),r=h(()=>e.toolCall.input?.type||null),l=h(()=>e.toolCall.input?.glob||null),m=h(()=>e.toolCall.input?.["-i"]||!1),p=h(()=>r.value||l.value||m.value),f=h(()=>t.value?"ðŸ”":"ðŸ“"),u=h(()=>t.value?"Searching content":"Finding files"),w=h(()=>t.value?"Matches":"Files found"),g=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!g.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),b=h(()=>!g.value||k.value||!$.value?0:$.value.split(`
`).filter(v=>v.trim()).length);return(d,v)=>(a(),c("div",wl,[s("div",$l,[s("div",kl,[s("span",Sl,y(f.value),1),s("strong",null,y(u.value)+":",1),s("code",El,y(o.value),1),i.value?(a(),c("span",Cl,"in "+y(i.value),1)):x("",!0),p.value?(a(),c("span",Tl,[r.value?(a(),c("span",xl,"type: "+y(r.value),1)):x("",!0),l.value?(a(),c("span",Al,"glob: "+y(l.value),1)):x("",!0),m.value?(a(),c("span",Ml,"case-insensitive")):x("",!0)])):x("",!0)])]),g.value?(a(),c("div",Ol,[k.value?(a(),c("div",Dl,[v[0]||(v[0]=s("strong",null,"Error:",-1)),s("pre",Ll,y($.value),1)])):(a(),c("div",Nl,[s("div",Il,[s("span",jl,y(w.value)+":",1),s("span",Pl,y(b.value)+" "+y(b.value===1?"match":"matches"),1)]),s("div",Rl,[s("pre",Wl,y($.value),1)])]))])):x("",!0)]))}},$n=ie(Bl,[["__scopeId","data-v-0d272c39"]]),Fl={class:"web-tool-handler"},Hl={class:"tool-section"},Vl={class:"web-info"},Ul={class:"web-icon"},ql=["href"],zl={key:1,class:"web-query"},Kl={key:0,class:"web-prompt-container"},Gl={class:"prompt-content"},Yl={key:1,class:"web-domains"},Jl={class:"domains-label"},Ql={key:0,class:"tool-section"},Xl={key:0,class:"tool-result tool-result-error"},Zl={class:"tool-code"},ec={key:1,class:"web-results"},tc={class:"results-header"},sc={class:"results-label"},nc={class:"results-content"},oc={class:"tool-code"},ic={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="WebFetch"),o=h(()=>e.toolCall.input?.url||null),i=h(()=>e.toolCall.input?.query||null),r=h(()=>e.toolCall.input?.prompt||null),l=h(()=>e.toolCall.input?.allowed_domains||[]),m=h(()=>e.toolCall.input?.blocked_domains||[]),p=h(()=>l.value.length>0?l.value:m.value.length>0?m.value:[]),f=h(()=>l.value.length>0?"Allowed domains":m.value.length>0?"Blocked domains":"Domains"),u=h(()=>t.value?"ðŸŒ":"ðŸ”Ž"),w=h(()=>t.value?"Fetching URL":"Searching web"),g=h(()=>t.value?"Fetched content":"Search results"),k=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=h(()=>{if(!k.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,v)=>(a(),c("div",Fl,[s("div",Hl,[s("div",Vl,[s("span",Ul,y(u.value),1),s("strong",null,y(w.value)+":",1),o.value?(a(),c("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,ql)):i.value?(a(),c("code",zl,y(i.value),1)):x("",!0)]),r.value?(a(),c("div",Kl,[v[0]||(v[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Gl,y(r.value),1)])):x("",!0),p.value.length>0?(a(),c("div",Yl,[s("span",Jl,y(f.value)+":",1),(a(!0),c(le,null,ue(p.value,_=>(a(),c("span",{key:_,class:"domain-badge"},y(_),1))),128))])):x("",!0)]),k.value?(a(),c("div",Ql,[$.value?(a(),c("div",Xl,[v[1]||(v[1]=s("strong",null,"Error:",-1)),s("pre",Zl,y(b.value),1)])):(a(),c("div",ec,[s("div",tc,[s("span",sc,y(g.value)+":",1)]),s("div",nc,[s("pre",oc,y(b.value),1)])]))])):x("",!0)]))}},kn=ie(ic,[["__scopeId","data-v-62b55b55"]]),ac={class:"task-tool-handler"},rc={class:"tool-section"},lc={class:"task-header"},cc={key:0,class:"agent-type-badge"},uc={key:0,class:"task-description"},dc={class:"description-content"},mc={key:1,class:"task-prompt-container"},pc={class:"prompt-header"},fc={class:"prompt-length"},vc={class:"prompt-code"},hc={key:0,class:"tool-section"},_c={key:0,class:"tool-result tool-result-error"},gc={class:"tool-code"},bc={key:1,class:"agent-output"},yc={class:"output-header"},wc={key:0,class:"output-count-badge"},$c={class:"output-content"},kc={class:"tool-code"},Sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.description||null),o=h(()=>e.toolCall.input?.prompt||null),i=h(()=>e.toolCall.input?.subagent_type||null),r=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=h(()=>{if(!r.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),p=h(()=>m.value?m.value.split(`
`).length:0);return(f,u)=>(a(),c("div",ac,[s("div",rc,[s("div",lc,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=s("strong",null,"Agent Task:",-1)),i.value?(a(),c("span",cc,y(i.value),1)):x("",!0)]),t.value?(a(),c("div",uc,[u[2]||(u[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",dc,y(t.value),1)])):x("",!0),o.value?(a(),c("div",mc,[s("div",pc,[u[3]||(u[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",fc,y(o.value.length)+" characters",1)]),s("pre",vc,y(o.value),1)])):x("",!0)]),r.value?(a(),c("div",hc,[l.value?(a(),c("div",_c,[u[4]||(u[4]=s("strong",null,"Error:",-1)),s("pre",gc,y(m.value),1)])):(a(),c("div",bc,[s("div",yc,[u[5]||(u[5]=s("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(a(),c("span",wc,y(p.value)+" lines",1)):x("",!0)]),s("div",$c,[s("pre",kc,y(m.value),1)])]))])):x("",!0)]))}},Ec=ie(Sc,[["__scopeId","data-v-c520c244"]]),Cc={class:"task-create-tool-handler"},Tc={class:"tool-section"},xc={class:"task-details p-2"},Ac={key:0,class:"task-field mb-2"},Mc={class:"field-value subject-value"},Oc={key:1,class:"task-field mb-2"},Dc={class:"field-value description-value"},Lc={key:2,class:"task-field"},Nc={class:"field-value active-form-value"},Ic={key:0,class:"tool-section mt-2"},jc={key:0,class:"tool-result tool-result-error"},Pc={class:"tool-code"},Rc={key:1,class:"tool-result tool-result-success"},Wc={class:"result-text"},Bc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.subject||null),o=h(()=>e.toolCall.input?.description||null),i=h(()=>e.toolCall.input?.activeForm||null),r=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=h(()=>{if(!r.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,f)=>(a(),c("div",Cc,[s("div",Tc,[f[3]||(f[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",xc,[t.value?(a(),c("div",Ac,[f[0]||(f[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Mc,y(t.value),1)])):x("",!0),o.value?(a(),c("div",Oc,[f[1]||(f[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",Dc,y(o.value),1)])):x("",!0),i.value?(a(),c("div",Lc,[f[2]||(f[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Nc,y(i.value),1)])):x("",!0)])]),r.value?(a(),c("div",Ic,[l.value?(a(),c("div",jc,[f[4]||(f[4]=s("strong",null,"Error:",-1)),s("pre",Pc,y(m.value),1)])):(a(),c("div",Rc,[f[5]||(f[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Wc,y(m.value),1)]))])):x("",!0)]))}},Fc=ie(Bc,[["__scopeId","data-v-474dd444"]]),Hc={class:"task-update-tool-handler"},Vc={class:"tool-section"},Uc={class:"task-header"},qc={key:0,class:"task-id-badge"},zc={class:"task-details p-2"},Kc={key:0,class:"task-field mb-2"},Gc={key:1,class:"task-field mb-2"},Yc={class:"field-value"},Jc={key:2,class:"task-field mb-2"},Qc={class:"field-value description-value"},Xc={key:3,class:"task-field mb-2"},Zc={class:"field-value active-form-value"},eu={key:4,class:"task-field mb-2"},tu={class:"field-value"},su={key:5,class:"task-field mb-2"},nu={class:"field-value"},ou={key:6,class:"task-field"},iu={class:"field-value"},au={key:0,class:"tool-section mt-2"},ru={key:0,class:"tool-result tool-result-error"},lu={class:"tool-code"},cu={key:1,class:"tool-result tool-result-success"},uu={class:"result-text"},du={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.taskId||null),o=h(()=>e.toolCall.input?.status||null),i=h(()=>e.toolCall.input?.subject||null),r=h(()=>e.toolCall.input?.description||null),l=h(()=>e.toolCall.input?.activeForm||null),m=h(()=>e.toolCall.input?.owner||null),p=h(()=>e.toolCall.input?.addBlockedBy||[]),f=h(()=>e.toolCall.input?.addBlocks||[]),u=h(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=h(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=h(()=>{if(!g.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,d)=>(a(),c("div",Hc,[s("div",Vc,[s("div",Uc,[d[0]||(d[0]=s("span",{class:"task-icon"},"âœï¸",-1)),d[1]||(d[1]=s("strong",null,"Update Task",-1)),t.value?(a(),c("span",qc,"#"+y(t.value),1)):x("",!0)]),s("div",zc,[o.value?(a(),c("div",Kc,[d[2]||(d[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:se(["field-value status-value",w.value])},y(u.value)+" "+y(o.value),3)])):x("",!0),i.value?(a(),c("div",Gc,[d[3]||(d[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Yc,y(i.value),1)])):x("",!0),r.value?(a(),c("div",Jc,[d[4]||(d[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",Qc,y(r.value),1)])):x("",!0),l.value?(a(),c("div",Xc,[d[5]||(d[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Zc,y(l.value),1)])):x("",!0),m.value?(a(),c("div",eu,[d[6]||(d[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",tu,y(m.value),1)])):x("",!0),p.value?.length?(a(),c("div",su,[d[7]||(d[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",nu,[(a(!0),c(le,null,ue(p.value,v=>(a(),c("span",{key:v,class:"badge bg-warning text-dark me-1"},"#"+y(v),1))),128))])])):x("",!0),f.value?.length?(a(),c("div",ou,[d[8]||(d[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",iu,[(a(!0),c(le,null,ue(f.value,v=>(a(),c("span",{key:v,class:"badge bg-info text-dark me-1"},"#"+y(v),1))),128))])])):x("",!0)])]),g.value?(a(),c("div",au,[k.value?(a(),c("div",ru,[d[9]||(d[9]=s("strong",null,"Error:",-1)),s("pre",lu,y($.value),1)])):(a(),c("div",cu,[d[10]||(d[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",uu,y($.value),1)]))])):x("",!0)]))}},mu=ie(du,[["__scopeId","data-v-35582330"]]),pu={class:"task-list-tool-handler"},fu={key:0,class:"tool-section"},vu={key:0,class:"tool-result tool-result-error"},hu={class:"tool-code"},_u={key:1,class:"task-list-result"},gu={key:0,class:"parsed-tasks"},bu={class:"status-icon"},yu={class:"task-id text-muted"},wu={class:"task-subject flex-grow-1"},$u={key:0,class:"task-owner badge bg-secondary"},ku={key:1,class:"raw-result p-2"},Su={class:"tool-code"},Eu={key:1,class:"tool-section"},Cu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=h(()=>{if(!t.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),r=h(()=>{if(!i.value)return[];const m=[],f=i.value.split(`
`);for(const u of f){const w=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const g=w[2].toLowerCase();m.push({id:w[1],status:g,subject:w[3].trim(),owner:null,statusIcon:l(g)})}}return m});function l(m){switch(m){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(m,p)=>(a(),c("div",pu,[p[2]||(p[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(a(),c("div",fu,[o.value?(a(),c("div",vu,[p[0]||(p[0]=s("strong",null,"Error:",-1)),s("pre",hu,y(i.value),1)])):(a(),c("div",_u,[r.value.length>0?(a(),c("div",gu,[(a(!0),c(le,null,ue(r.value,(f,u)=>(a(),c("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",bu,y(f.statusIcon),1),s("span",yu,"#"+y(f.id),1),s("span",wu,y(f.subject),1),f.owner?(a(),c("span",$u,y(f.owner),1)):x("",!0)]))),128))])):(a(),c("div",ku,[s("pre",Su,y(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),c("div",Eu,[...p[1]||(p[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):x("",!0)]))}},Tu=ie(Cu,[["__scopeId","data-v-4e79ba4b"]]),xu={class:"task-get-tool-handler"},Au={class:"tool-section"},Mu={class:"task-header"},Ou={key:0,class:"task-id-badge"},Du={key:0,class:"tool-section"},Lu={key:0,class:"tool-result tool-result-error"},Nu={class:"tool-code"},Iu={key:1,class:"task-details-result p-2"},ju={key:0,class:"parsed-task"},Pu={class:"task-field mb-2"},Ru={class:"field-value subject-value"},Wu={key:0,class:"task-field mb-2"},Bu={key:1,class:"task-field mb-2"},Fu={class:"field-value description-value"},Hu={key:2,class:"task-field mb-2"},Vu={class:"field-value"},Uu={key:3,class:"task-field mb-2"},qu={class:"field-value"},zu={key:4,class:"task-field"},Ku={class:"field-value"},Gu={key:1,class:"raw-result"},Yu={class:"tool-code"},Ju={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.taskId||null),o=h(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=h(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),l=h(()=>{if(!r.value)return null;const f=r.value;try{const g=JSON.parse(f);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const u=f.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of u){const k=g.match(/^Subject:\s*(.+)$/i);k&&(w.subject=k[1].trim());const $=g.match(/^Status:\s*(.+)$/i);$&&(w.status=$[1].trim());const b=g.match(/^Description:\s*(.+)$/i);b&&(w.description=b[1].trim());const d=g.match(/^Owner:\s*(.+)$/i);d&&(w.owner=d[1].trim())}return w.subject?w:null}),m=h(()=>{if(!l.value)return"";switch(l.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),p=h(()=>{if(!l.value)return"";switch(l.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,u)=>(a(),c("div",xu,[s("div",Au,[s("div",Mu,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=s("strong",null,"Get Task",-1)),t.value?(a(),c("span",Ou,"#"+y(t.value),1)):x("",!0)])]),o.value?(a(),c("div",Du,[i.value?(a(),c("div",Lu,[u[2]||(u[2]=s("strong",null,"Error:",-1)),s("pre",Nu,y(r.value),1)])):(a(),c("div",Iu,[l.value?(a(),c("div",ju,[s("div",Pu,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Ru,y(l.value.subject),1)]),l.value.status?(a(),c("div",Wu,[u[4]||(u[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:se(["field-value",p.value])},y(m.value)+" "+y(l.value.status),3)])):x("",!0),l.value.description?(a(),c("div",Bu,[u[5]||(u[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",Fu,y(l.value.description),1)])):x("",!0),l.value.owner?(a(),c("div",Hu,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",Vu,y(l.value.owner),1)])):x("",!0),l.value.blockedBy?.length?(a(),c("div",Uu,[u[7]||(u[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",qu,[(a(!0),c(le,null,ue(l.value.blockedBy,w=>(a(),c("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):x("",!0),l.value.blocks?.length?(a(),c("div",zu,[u[8]||(u[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Ku,[(a(!0),c(le,null,ue(l.value.blocks,w=>(a(),c("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):x("",!0)])):(a(),c("div",Gu,[s("pre",Yu,y(r.value),1)]))]))])):x("",!0)]))}},Qu=ie(Ju,[["__scopeId","data-v-a80d14da"]]),Xu={class:"notebook-edit-tool-handler"},Zu={class:"tool-section"},ed={class:"notebook-info"},td={class:"file-path"},sd={class:"cell-info mt-2"},nd={class:"info-row"},od={class:"info-row"},id={key:0,class:"info-row"},ad={class:"badge bg-info"},rd={key:0,class:"source-preview mt-3"},ld={class:"preview-header"},cd={class:"preview-stats"},ud={class:"source-code"},dd={key:0,class:"tool-section"},md={key:0},pd={key:1,class:"text-danger"},fd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.notebook_path||"Unknown"),o=h(()=>e.toolCall.input?.cell_id),i=h(()=>e.toolCall.input?.cell_type||"code"),r=h(()=>e.toolCall.input?.edit_mode||"replace"),l=h(()=>e.toolCall.input?.new_source||""),m=h(()=>l.value.split(`
`).length),p=h(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=r.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,g)=>(a(),c("div",Xu,[s("div",Zu,[s("div",ed,[g[0]||(g[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=s("strong",null,"Notebook:",-1)),s("code",td,y(t.value),1)]),s("div",sd,[s("div",nd,[g[2]||(g[2]=s("strong",null,"Cell ID:",-1)),s("code",null,y(o.value||"N/A"),1)]),s("div",od,[g[3]||(g[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:se(["badge",p.value])},y(i.value),3)]),r.value?(a(),c("div",id,[g[4]||(g[4]=s("strong",null,"Edit Mode:",-1)),s("span",ad,y(r.value),1)])):x("",!0)]),l.value?(a(),c("div",rd,[s("div",ld,[g[5]||(g[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",cd,y(m.value)+" lines",1)]),s("pre",ud,[s("code",null,y(l.value),1)])])):x("",!0)]),n.toolCall.result?(a(),c("div",dd,[g[6]||(g[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:se(["tool-result",f.value])},[n.toolCall.result.success!==!1?(a(),c("div",md," âœ… "+y(u.value),1)):(a(),c("div",pd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):x("",!0)]))}},vd=ie(fd,[["__scopeId","data-v-c81a9bcf"]]),hd={class:"shell-tool-handler"},_d={class:"tool-section"},gd={class:"shell-info"},bd={class:"shell-icon"},yd={key:0,class:"shell-id"},wd={key:0,class:"filter-info mt-2"},$d={class:"filter-pattern"},kd={key:0,class:"tool-section"},Sd={class:"result-header mb-2"},Ed={key:0,class:"mb-2"},Cd={class:"shell-output"},Td={key:1,class:"mb-2"},xd={class:"shell-output shell-output-error"},Ad={key:0},Md={key:1,class:"text-danger"},Od={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=h(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=h(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=h(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=h(()=>e.toolCall.input?.filter);function m(k,$){if(!k)return null;const b=new RegExp(`<${$}>([\\s\\S]*?)<\\/${$}>`,"i"),d=k.match(b);return d?d[1].trim():null}const p=h(()=>{const k=e.toolCall.result;if(!k)return null;let $=k;if(k.content&&($=k.content),typeof $=="string")return{status:m($,"status"),stdout:m($,"stdout"),stderr:m($,"stderr"),exit_code:m($,"exit_code")};if(Array.isArray($)){const b=$.find(d=>d.type==="text")?.text||"";return{status:m(b,"status"),stdout:m(b,"stdout"),stderr:m(b,"stderr"),exit_code:m(b,"exit_code")}}return{status:k.status||$.status,stdout:k.stdout||k.output||$.stdout||$.output,stderr:k.stderr||$.stderr,exit_code:k.exit_code||$.exit_code}}),f=h(()=>p.value?.status),u=h(()=>{const k=f.value;return k==="running"?"bg-success":k==="completed"?"bg-secondary":k==="killed"||k==="terminated"?"bg-danger":"bg-info"}),w=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=h(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const k=p.value;if(k?.status==="running"&&!k.stdout&&!k.stderr)return"No new output since last check";if(k?.status==="failed")return`Shell failed (exit code ${k.exit_code||"unknown"})`}return"Operation completed"});return(k,$)=>(a(),c("div",hd,[s("div",_d,[s("div",gd,[s("span",bd,y(t.value),1),s("strong",null,y(o.value)+":",1),r.value?(a(),c("code",yd,"Shell "+y(r.value),1)):x("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(a(),c("div",wd,[$[0]||($[0]=s("strong",null,"Filter:",-1)),s("code",$d,y(l.value),1)])):x("",!0)]),n.toolCall.result?(a(),c("div",kd,[s("div",Sd,[s("strong",null,y(i.value)+":",1),f.value?(a(),c("span",{key:0,class:se(["badge",u.value])},y(f.value),3)):x("",!0)]),p.value?.stdout?(a(),c("div",Ed,[$[1]||($[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Cd,[s("pre",null,[s("code",null,y(p.value.stdout),1)])])])):x("",!0),p.value?.stderr?(a(),c("div",Td,[$[2]||($[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",xd,[s("pre",null,[s("code",null,y(p.value.stderr),1)])])])):x("",!0),!p.value?.stdout&&!p.value?.stderr?(a(),c("div",{key:2,class:se(["tool-result",w.value])},[n.toolCall.result.success!==!1?(a(),c("div",Ad," âœ… "+y(g.value),1)):(a(),c("div",Md," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):x("",!0)])):x("",!0)]))}},Sn=ie(Od,[["__scopeId","data-v-86def281"]]),Dd={class:"skill-tool-handler"},Ld={key:0,class:"tool-section"},Nd={class:"d-flex align-items-center gap-2"},Id={class:"text-muted small"},jd={key:0,class:"skill-content-body"},Pd={class:"skill-content-text"},Rd={key:1,class:"tool-section mt-3"},Wd={class:"tool-result tool-result-error"},Bd={class:"tool-code"},Fd={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=me(),i=R(!1);function r(){i.value=!i.value}const l=h(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(v=>v.type==="user"&&v.metadata?.has_tool_results&&v.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let b=null,d=null;for(let v=$+1;v<Math.min($+3,k.length);v++){const _=k[v];if(_.type!=="user")continue;const T=_.content||"";T.includes("<command-message>")&&T.includes("skill is running")?b=_:T.startsWith("Base directory for this skill:")&&(d=_)}return{running:b,content:d}}),m=h(()=>{const g=l.value.content;if(!g)return"";const k=g.content||"",$=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return k.replace($,"").trim()}),p=h(()=>m.value.length>0),f=h(()=>m.value?m.value.split(`
`).length:0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),c("div",Dd,[p.value?(a(),c("div",Ld,[s("div",{class:"skill-content-header",onClick:r},[s("div",Nd,[s("i",{class:se(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),k[0]||(k[0]=s("strong",null,"Skill Content",-1)),s("span",Id,"("+y(f.value)+" lines)",1)])]),i.value?(a(),c("div",jd,[s("pre",Pd,y(m.value),1)])):x("",!0)])):x("",!0),u.value?(a(),c("div",Rd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Wd,[s("pre",Bd,y(w.value),1)])])):x("",!0)]))}},Hd=ie(Fd,[["__scopeId","data-v-0a48ca0f"]]),Vd={class:"slashcommand-tool-handler"},Ud={key:0,class:"tool-section"},qd={class:"d-flex align-items-center gap-2"},zd=["aria-label"],Kd={class:"text-muted small"},Gd={key:0,class:"command-content-body"},Yd={class:"command-content-text"},Jd={key:1,class:"tool-section mt-3"},Qd={class:"tool-result tool-result-error"},Xd={class:"tool-code"},Zd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=me(),i=R(!1);function r(){i.value=!i.value}const l=h(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(v=>v.type==="user"&&v.metadata?.has_tool_results&&v.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let b=null,d=null;for(let v=$+1;v<Math.min($+3,k.length);v++){const _=k[v];if(_.type!=="user")continue;const T=_.content||"";T.includes("<command-message>")&&T.includes("<command-name>")&&T.includes("<command-args>")?b=_:T.includes("ARGUMENTS:")&&(d=_)}return{running:b,content:d}}),m=h(()=>{const g=l.value.content;if(!g)return"";const k=g.content||"",$=/\nARGUMENTS:.*$/s;return k.replace($,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=h(()=>m.value.length>0),f=h(()=>m.value?m.value.split(`
`).length:0),u=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=h(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),c("div",Vd,[p.value?(a(),c("div",Ud,[s("div",{class:"command-content-header",onClick:r},[s("div",qd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},y(i.value?"â–¾":"â–¸"),9,zd),k[0]||(k[0]=s("strong",null,"Command Content",-1)),s("span",Kd,"("+y(f.value)+" lines)",1)])]),i.value?(a(),c("div",Gd,[s("pre",Yd,y(m.value),1)])):x("",!0)])):x("",!0),u.value?(a(),c("div",Jd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Qd,[s("pre",Xd,y(w.value),1)])])):x("",!0)]))}},em=ie(Zd,[["__scopeId","data-v-15991acf"]]),tm={class:"exit-plan-mode-tool-handler"},sm={class:"tool-section"},nm={key:0,class:"plan-content mt-2"},om={class:"plan-text"},im={key:0,class:"tool-section"},am={key:0},rm={key:1,class:"text-danger"},lm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>e.toolCall.input?.plan),o=h(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,r)=>(a(),c("div",tm,[s("div",sm,[r[1]||(r[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(a(),c("div",nm,[r[0]||(r[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",om,y(t.value),1)])):x("",!0)]),n.toolCall.result?(a(),c("div",im,[r[2]||(r[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:se(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),c("div",am," âœ… Permission mode reverted to default ")):(a(),c("div",rm," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):x("",!0)]))}},cm=ie(lm,[["__scopeId","data-v-e2e3c781"]]),um={class:"ask-user-question-handler"},dm={key:0,class:"answers-summary"},mm={class:"answer-question text-muted small"},pm={class:"answer-value fw-medium"},fm={key:1,class:"text-muted small"},vm={key:0,class:"questions-container"},hm={class:"question-header d-flex align-items-center gap-2 mb-2"},_m={key:0,class:"badge bg-secondary"},gm={class:"question-text fw-medium"},bm={class:"options-list"},ym=["id","checked","disabled","onChange"],wm=["id","name","checked","disabled","onChange"],$m=["for"],km={class:"option-label"},Sm={key:0,class:"option-description text-muted d-block small"},Em={class:"option-item form-check other-option"},Cm=["id","checked","disabled","onChange"],Tm=["id","name","checked","disabled","onChange"],xm=["for"],Am={key:2,class:"other-input mt-2"},Mm=["onUpdate:modelValue","disabled","onInput"],Om={key:1,class:"alert alert-info mb-0"},Dm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=h(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),l=h(()=>{if(!r.value)return{};const E=o.toolCall.result;if(E?.content){if(typeof E.content=="object"&&E.content.answers)return E.content.answers;if(typeof E.content=="string")try{const P=JSON.parse(E.content);if(P.answers)return P.answers}catch{}}const B=o.toolCall.input||{};return B.answers?B.answers:{}}),m=h(()=>Object.keys(l.value).length>0),p=h(()=>(o.toolCall.input||{}).questions||[]),f=R({}),u=R({});ve(p,E=>{E.forEach((B,P)=>{P in f.value||(f.value[P]=B.multiSelect?[]:null),P in u.value||(u.value[P]="")})},{immediate:!0});function w(E,B){const P=f.value[E];return Array.isArray(P)?P.includes(B):P===B}function g(E){const B=f.value[E];return Array.isArray(B)?B.includes("__OTHER__"):B==="__OTHER__"}function k(E,B){f.value[E]=B,_()}function $(E){f.value[E]="__OTHER__",_()}function b(E,B){const P=f.value[E];if(!Array.isArray(P))f.value[E]=[B];else{const A=P.indexOf(B);A===-1?P.push(B):P.splice(A,1)}_()}function d(E){const B=f.value[E];if(!Array.isArray(B))f.value[E]=["__OTHER__"];else{const P=B.indexOf("__OTHER__");P===-1?B.push("__OTHER__"):B.splice(P,1)}_()}function v(E){_()}function _(){const E={};p.value.forEach((B,P)=>{const A=f.value[P],V=B.question;if(B.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(S=>S==="__OTHER__"?u.value[P]||"":S).filter(S=>S);E[V]=C.join(", ")}}else A==="__OTHER__"?E[V]=u.value[P]||"":A&&(E[V]=A)}),i("answer",E)}const T=h(()=>p.value.every((E,B)=>{const P=f.value[B];if(E.multiSelect){if(!Array.isArray(P)||P.length===0||P.includes("__OTHER__")&&!u.value[B])return!1}else if(!P||P==="__OTHER__"&&!u.value[B])return!1;return!0}));return e({allQuestionsAnswered:T,getAnswers:()=>{const E={};return p.value.forEach((B,P)=>{const A=f.value[P],V=B.question;if(B.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(S=>S==="__OTHER__"?u.value[P]||"":S).filter(S=>S);E[V]=C.join(", ")}}else A==="__OTHER__"?E[V]=u.value[P]||"":A&&(E[V]=A)}),E}}),(E,B)=>(a(),c("div",um,[r.value?(a(),c(le,{key:0},[m.value?(a(),c("div",dm,[(a(!0),c(le,null,ue(l.value,(P,A)=>(a(),c("div",{key:A,class:"answer-item mb-2"},[s("div",mm,y(A),1),s("div",pm,y(P),1)]))),128))])):(a(),c("div",fm," No answers recorded. "))],64)):(a(),c(le,{key:1},[p.value.length>0?(a(),c("div",vm,[(a(!0),c(le,null,ue(p.value,(P,A)=>(a(),c("div",{key:A,class:"question-block mb-3"},[s("div",hm,[P.header?(a(),c("span",_m,y(P.header),1)):x("",!0),s("span",gm,y(P.question),1)]),s("div",bm,[(a(!0),c(le,null,ue(P.options,(V,C)=>(a(),c("div",{key:C,class:se(["option-item form-check",{selected:w(A,V.label)}])},[P.multiSelect?(a(),c("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-opt${C}`,checked:w(A,V.label),disabled:n.disabled,onChange:S=>b(A,V.label)},null,40,ym)):(a(),c("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-opt${C}`,name:`question-${A}`,checked:w(A,V.label),disabled:n.disabled,onChange:S=>k(A,V.label)},null,40,wm)),s("label",{class:"form-check-label",for:`q${A}-opt${C}`},[s("span",km,y(V.label),1),V.description?(a(),c("span",Sm,y(V.description),1)):x("",!0)],8,$m)],2))),128)),s("div",Em,[P.multiSelect?(a(),c("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-other`,checked:g(A),disabled:n.disabled,onChange:V=>d(A)},null,40,Cm)):(a(),c("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-other`,name:`question-${A}`,checked:g(A),disabled:n.disabled,onChange:V=>$(A)},null,40,Tm)),s("label",{class:"form-check-label",for:`q${A}-other`},[...B[0]||(B[0]=[s("span",{class:"option-label"},"Other",-1)])],8,xm),g(A)?(a(),c("div",Am,[we(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":V=>u.value[A]=V,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:V=>v()},null,40,Mm),[[Fe,u.value[A]]])])):x("",!0)])])]))),128))])):(a(),c("div",Om," No questions to display. "))],64))]))}},En=ie(Dm,[["__scopeId","data-v-ebcee33f"]]),Lm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Nm={class:"tool-status-icon"},Im=["title"],jm={class:"d-flex align-items-center gap-2"},Pm={class:"text-muted"},Rm=["aria-label"],Wm={key:0,class:"card-body"},Bm={key:0,class:"alert alert-warning mb-3"},Fm={class:"d-flex align-items-center"},Hm={class:"mb-0 small"},Vm={key:2,class:"permission-prompt mt-3"},Um={class:"question-buttons d-flex gap-2 mt-3"},qm=["disabled"],zm=["disabled"],Km={class:"alert alert-warning mb-3"},Gm={class:"mb-0"},Ym={class:"tool-name"},Jm={key:0,class:"suggestions-section mb-3"},Qm={class:"alert alert-info mb-0"},Xm={class:"suggestion-details p-2 bg-white rounded"},Zm={class:"permission-buttons d-flex gap-2 mb-3"},ep=["disabled"],tp=["disabled"],sp=["disabled"],np={class:"guidance-section mt-3"},op=["disabled"],ip=["disabled"],ap={key:3,class:"mt-3"},rp={class:"alert alert-warning mb-0"},lp={class:"d-flex align-items-center"},cp={class:"mb-0 small"},up={key:4,class:"tool-section"},dp={class:"alert alert-danger mb-0"},mp={key:0},pp={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=me(),i=ot(),r=R(!1),l=R(null),m=R(""),p=R(null),f=R({}),u=h(()=>e.toolCall.name==="AskUserQuestion"),w=h(()=>!u.value||!p.value?!1:p.value.allQuestionsAnswered);function g(M){f.value=M}async function k(){if(!r.value&&p.value){r.value=!0,l.value="submit-answers";try{const M=o.currentSessionId,D=p.value.getAnswers(),Y={questions:e.toolCall.input?.questions||[],answers:D};M&&(t.updateToolCall(M,e.toolCall.id,{input:Y}),t.handlePermissionResponse(M,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",Y)}catch(M){console.error("Failed to submit question answers:",M)}finally{r.value=!1,l.value=null}}}const $=h(()=>e.toolCall.backendStatus==="interrupted"?!0:t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),b=h(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),d=h(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),v=h(()=>{if(e.toolCall.backendStatus){const M=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[M]||M}if(d.value){const M=d.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[M]||M}return e.toolCall.status}),_={Read:ir,Write:$r,Bash:Ir,TodoWrite:Xr,Edit:yl,Grep:$n,Glob:$n,WebFetch:kn,WebSearch:kn,Task:Ec,TaskCreate:Fc,TaskUpdate:mu,TaskList:Tu,TaskGet:Qu,NotebookEdit:vd,BashOutput:Sn,KillShell:Sn,SlashCommand:em,Skill:Hd,ExitPlanMode:cm,AskUserQuestion:En},T=h(()=>{const M=e.toolCall.name;return _[M]?_[M]:Pa}),E=h(()=>{const M=[];if($.value)return M.push("border-warning"),M.join(" ");switch(v.value){case"pending":M.push("border-secondary");break;case"permission_required":M.push("border-warning");break;case"executing":M.push("border-primary");break;case"completed":A.value||e.toolCall.permissionDecision==="deny"?M.push("border-danger"):M.push("border-success");break;case"error":M.push("border-danger");break}return M.join(" ")}),B=h(()=>{if($.value)return"â¹ï¸";switch(v.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":A.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),P=h(()=>Ht(e.toolCall.timestamp)),A=h(()=>e.toolCall.result?.error||e.toolCall.status==="error"),V=h(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function C(M){if(!M)return"";const D=M.replace(/\\/g,"/").split("/");return D[D.length-1]}function S(M){if(!M)return"";const D=M.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return D?D[1]:M}function W(M,D=200){return M?M.length<=D?M:M.substring(0,D)+"...":""}function z(M){if(!M)return null;if(M.content){const D=M.content.match(/exit code (\d+)/i);if(D)return parseInt(D[1])}return M.error?1:0}function j(M,D){const Y=M?M.split(`
`).length:0;return{added:D?D.split(`
`).length:0,removed:Y}}const H=h(()=>{const M=e.toolCall.name,D=e.toolCall.input||{},Y=e.toolCall.result,ee=v.value;switch(M){case"Bash":case"Shell":case"Command":{const X=S(D.command),Z=W(X,200);if(ee==="completed"&&Y){const ne=z(Y);return`Bash: ${Z} (exit ${ne})`}return`Bash: ${Z}`}case"SlashCommand":{const X=W(D.command,200);return ee==="completed"&&Y?`SlashCommand: ${X}`:`SlashCommand: ${X}`}case"Edit":{const X=C(D.file_path);if(ee==="completed"&&Y&&!Y.error){const{added:Z,removed:ne}=j(D.old_string,D.new_string);return Z===ne?`Edit: ${X} (${Z} lines changed)`:`Edit: ${X} (${Z} lines added, ${ne} removed)`}return`Edit: ${X}`}case"Read":{const X=C(D.file_path);if(D.offset!==void 0||D.limit!==void 0){const ne=(D.offset||0)+1,K=D.limit?(D.offset||0)+D.limit:"âˆž";return`Read: ${X} (lines ${ne}-${K})`}return`Read: ${X} (full file)`}case"Write":{const X=C(D.file_path);if(ee==="completed"&&Y&&!Y.error&&D.content){const Z=D.content.split(`
`).length;return`Write: ${X} (${Z} lines written)`}return`Write: ${X}`}case"Skill":{const X=D.skill||"Unknown";return ee==="completed"&&Y?Y.error?`Skill: ${X} (error)`:`Skill: ${X} (completed)`:`Skill: ${X}`}case"Task":{const X=D.subagent_type||"general",Z=D.description||"Task";return ee==="completed"&&Y?Y.error?`Task: (${X}) ${Z} (error)`:`Task: (${X}) ${Z} (completed)`:`Task: (${X}) ${Z}`}case"TodoWrite":{if(D.todos&&Array.isArray(D.todos)){const X=D.todos.filter(K=>K.status==="completed").length,Z=D.todos.length,ne=D.todos.find(K=>K.status==="in_progress");return ne?`Todo: Working on "${ne.content}"`:`Todo: ${X}/${Z} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const X=D.pattern||"",Z=M==="Grep"?"Grep":"Glob";if(ee==="completed"&&Y&&!Y.error){let ne=0;return Y.content&&(ne=Y.content.split(`
`).filter(I=>I.trim()).length),`${Z}: "${X}" (${ne} results)`}return`${Z}: "${X}"`}case"WebFetch":case"WebSearch":{const X=D.url||D.query||"";if(M==="WebSearch"){const ne=D.query||"",K=ne.length>50?ne.substring(0,50)+"...":ne;return ee==="completed"&&Y?Y.error?`Web: ${K} (error)`:`Web: ${K} (success)`:`Web: ${K}`}let Z="";try{X&&(Z=new URL(X.startsWith("http")?X:`https://${X}`).hostname)}catch{Z=X.length>50?X.substring(0,50)+"...":X}return ee==="completed"&&Y?Y.error?`Web: ${Z} (error)`:`Web: ${Z} (success)`:`Web: ${Z||X}`}case"NotebookEdit":{const X=C(D.notebook_path),Z=D.cell_number!==void 0?D.cell_number:"?",ne=D.edit_mode||"replace";return`NotebookEdit: ${X} cell #${Z} (${ne})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${D.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${D.shell_id||"unknown"}`;case"AskUserQuestion":{const Z=(D.questions||[]).length;return ee==="completed"&&Y&&!Y.error?`AskUserQuestion: ${Z} question(s) answered`:ee==="permission_required"?`AskUserQuestion: ${Z} question(s) awaiting response`:`AskUserQuestion: ${Z} question(s)`}case"TaskCreate":{const X=D.subject||"",Z=X.length>40?X.substring(0,40)+"...":X;return ee==="completed"&&Y&&!Y.error?`TaskCreate: "${Z}" (created)`:`TaskCreate: "${Z}"`}case"TaskUpdate":{const X=D.taskId||"?",Z=D.status||"";return Z?`TaskUpdate: #${X} -> ${Z}`:`TaskUpdate: #${X}`}case"TaskList":return ee==="completed"&&Y&&!Y.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const X=D.taskId||"?";return ee==="completed"&&Y&&!Y.error?`TaskGet: #${X} (retrieved)`:`TaskGet: #${X}`}default:return`${M}: executed`}}),G=h(()=>{const M=e.toolCall.name,D=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(M)?D.command||M:["Edit","Read","Write","NotebookEdit"].includes(M)&&(D.file_path||D.notebook_path)||M});function te(){const M=o.currentSessionId;M&&t.toggleToolExpansion(M,e.toolCall.id)}function O(M){return M.type==="setMode"?`Set permission mode to "${M.mode}"`:M.type==="allow"?`Allow tool: ${M.tool}`:JSON.stringify(M)}async function L(M,D,Y=null){if(!r.value){r.value=!0,M==="allow"?l.value=D?"approve-apply":"approve":Y?l.value="deny-guidance":l.value="deny";try{const ee=o.currentSessionId;if(ee){const X=D&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(ee,{request_id:e.toolCall.permissionRequestId,decision:M,reasoning:M==="allow"?"User allowed permission":"User denied permission",applied_updates:X})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,M,D,Y)}catch(ee){console.error("Failed to send permission response:",ee)}finally{r.value=!1,l.value=null}}}return(M,D)=>(a(),c("div",{class:se(["tool-call-card card",E.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:te},[s("div",Lm,[s("span",Nm,y(B.value),1),s("span",{class:"tool-name",title:G.value},y(H.value),9,Im)]),s("div",jm,[s("small",Pm,y(P.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Rm)])]),n.toolCall.isExpanded?(a(),c("div",Wm,[$.value?(a(),c("div",Bm,[s("div",Fm,[D[7]||(D[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[D[6]||(D[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Hm,y(b.value?.message||"Session was terminated"),1)])])])):x("",!0),u.value&&v.value==="permission_required"?x("",!0):(a(),$e(po(T.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),v.value==="permission_required"&&!$.value?(a(),c("div",Vm,[u.value?(a(),c(le,{key:0},[D[8]||(D[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),he(En,{ref_key:"questionHandlerRef",ref:p,toolCall:n.toolCall,disabled:r.value,onAnswer:g},null,8,["toolCall","disabled"]),s("div",Um,[s("button",{class:"btn btn-primary",onClick:k,disabled:r.value||!w.value},y(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,qm),s("button",{class:"btn btn-outline-secondary",onClick:D[0]||(D[0]=Y=>L("deny",!1)),disabled:r.value}," Skip Question ",8,zm)])],64)):(a(),c(le,{key:1},[s("div",Km,[D[11]||(D[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Gm,[D[9]||(D[9]=re("Claude wants to use the ",-1)),s("code",Ym,y(n.toolCall.name),1),D[10]||(D[10]=re(" tool.",-1))])]),V.value?(a(),c("div",Jm,[s("div",Qm,[D[12]||(D[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),D[13]||(D[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Xm,[(a(!0),c(le,null,ue(n.toolCall.suggestions,(Y,ee)=>(a(),c("div",{key:ee,class:"suggestion-item"},[s("code",null,y(O(Y)),1)]))),128))]),D[14]||(D[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):x("",!0),s("div",Zm,[V.value?(a(),c("button",{key:0,class:"btn btn-success",onClick:D[1]||(D[1]=Y=>L("allow",!0)),disabled:r.value},y(r.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,ep)):x("",!0),s("button",{class:se(["btn",V.value?"btn-outline-success":"btn-success"]),onClick:D[2]||(D[2]=Y=>L("allow",!1)),disabled:r.value},y(r.value&&l.value==="approve"?"â³ Submitting...":V.value?"âœ… Approve Only":"âœ… Approve"),11,tp),s("button",{class:"btn btn-danger",onClick:D[3]||(D[3]=Y=>L("deny",!1)),disabled:r.value}," ðŸš« "+y(r.value&&l.value==="deny"?"Submitting...":"Deny"),9,sp)]),s("div",np,[D[15]||(D[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),D[16]||(D[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),we(s("textarea",{"onUpdate:modelValue":D[4]||(D[4]=Y=>m.value=Y),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:r.value},null,8,op),[[Fe,m.value]]),m.value.trim()?(a(),c("button",{key:0,class:"btn btn-warning btn-sm",onClick:D[5]||(D[5]=Y=>L("deny",!1,m.value)),disabled:r.value},y(r.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,ip)):x("",!0)])],64))])):x("",!0),v.value==="permission_required"&&$.value?(a(),c("div",ap,[s("div",rp,[s("div",lp,[D[18]||(D[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[D[17]||(D[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",cp,y(b.value?.message||"Session was terminated before permission could be granted"),1)])])])])):x("",!0),n.toolCall.permissionDecision==="deny"?(a(),c("div",up,[s("div",dp,[D[19]||(D[19]=re(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),c("span",mp," - "+y(n.toolCall.result.message),1)):x("",!0)])])):x("",!0)])):x("",!0)],2))}},fp=ie(pp,[["__scopeId","data-v-65145b27"]]);function Cn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function vp(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Tn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function hp(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=vp(t.command),i=Tn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Tn(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=Cn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",r=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Cn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const _p={key:0,class:"tool-timeline-bar"},gp={class:"timeline-container"},bp=["title","onClick","onKeydown"],yp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=Oe(),r=me(),l=h(()=>t.tools.map((k,$)=>({tool:k,originalIndex:$})).sort((k,$)=>{if(k.tool.timestamp&&$.tool.timestamp){const b=new Date(k.tool.timestamp).getTime(),d=new Date($.tool.timestamp).getTime();if(b!==d)return b-d}return k.originalIndex-$.originalIndex}).map(({tool:k})=>k));function m(k){const $=r.currentSessionId;if(!$)return k.status;const b=i.getBackendToolState($,k.id);return b?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[b.state]||b.state:i.isToolUseOrphaned($,k.id)?"orphaned":k.status}function p(k){return k.result?.error||k.status==="error"||k.permissionDecision==="deny"}function f(k){return m(k)==="executing"}function u(k){switch(m(k)){case"completed":return p(k)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w(k){const $=hp(k),b=m(k),d={completed:p(k)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[b]||b;return`${$} [${d}]`}function g(k,$){o("segment-click",{tool:k,index:$})}return(k,$)=>l.value.length>0?(a(),c("div",_p,[s("div",gp,[(a(!0),c(le,null,ue(l.value,(b,d)=>(a(),c("div",{key:b.id,class:se(["timeline-segment",u(b)]),style:{flex:1},title:w(b),onClick:v=>g(b,d),role:"button",tabindex:"0",onKeydown:[ze(v=>g(b,d),["enter"]),ze(_e(v=>g(b,d),["prevent"]),["space"])]},[s("span",{class:se(["segment-inner",{"executing-pulse":f(b)}])},null,2)],42,bp))),128))])])):x("",!0)}},wp=ie(yp,[["__scopeId","data-v-4a85fba6"]]),$p={class:"tool-footer-container"},kp={class:"tool-cards-list"},Sp={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Oe(),o=me(),i=h(()=>e.tools.map((l,m)=>({tool:l,originalIndex:m})).sort((l,m)=>{if(l.tool.timestamp&&m.tool.timestamp){const p=new Date(l.tool.timestamp).getTime(),f=new Date(m.tool.timestamp).getTime();if(p!==f)return p-f}return l.originalIndex-m.originalIndex}).map(({tool:l})=>l));async function r({tool:l}){const m=o.currentSessionId;if(!m)return;t.toggleToolExpansion(m,l.id),await kt();const p=document.querySelector(`[data-tool-id="${l.id}"]`);p&&p.scrollIntoView({behavior:"smooth",block:"nearest"})}return(l,m)=>(a(),c("div",$p,[he(wp,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),s("div",kp,[(a(!0),c(le,null,ue(i.value,p=>(a(),$e(fp,{key:p.id,toolCall:p,"data-tool-id":p.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Ep=ie(Sp,[["__scopeId","data-v-527d59ae"]]),Cp={class:"message-row message-row-assistant"},Tp=["title"],xp={class:"message-content-column"},Ap={key:0,class:"thinking-block mb-2"},Mp=["innerHTML"],Op={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Oe(),o=me();dt.setOptions({breaks:!0,gfm:!0});const i=h(()=>Ht(e.message.timestamp)),r=h(()=>e.message.metadata?.model||null),l=h(()=>{const $=i.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${$}`}),m=h(()=>{const $=e.message.content||"";return $.trim().length>0&&$!=="Assistant response"}),p=h(()=>{const $=e.message.content||"";let b=dt.parse($);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),cs.sanitize(b)}),f=h(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=h(()=>e.message.metadata?.thinking_content||""),w=h(()=>{const $=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return $||b}),g=h(()=>{const $=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],d=[...$],v=new Set($.map(_=>_.id));for(const _ of b)v.has(_.id)||d.push(_);return d}),k=h(()=>{const $=o.currentSessionId;if(!$)return[];const b=t.toolCallsBySession.get($)||[];return g.value.map(d=>{const v=b.find(_=>_.id===d.id);return v||{id:d.id,name:d.name,input:d.input,status:"pending",result:null,timestamp:d.timestamp||e.message.timestamp,isExpanded:!0}})});return($,b)=>(a(),c("div",Cp,[s("div",{class:"message-speaker",title:l.value},[...b[0]||(b[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Tp),s("div",xp,[f.value?(a(),c("div",Ap,[he(Ea,{thinking:u.value},null,8,["thinking"])])):x("",!0),m.value?(a(),c("div",{key:1,class:"message-text",innerHTML:p.value},null,8,Mp)):x("",!0),w.value?(a(),$e(Ep,{key:2,tools:k.value},null,8,["tools"])):x("",!0)])]))}},Dp=ie(Op,[["__scopeId","data-v-2e32f6ef"]]),Lp={key:0,class:"message-row message-row-compaction"},Np=["title"],Ip={class:"message-content-column"},jp={class:"compaction-status-content"},Pp={class:"text-muted ms-auto"},Rp={key:1,class:"message-row message-row-system"},Wp=["title"],Bp={class:"message-content-column"},Fp={class:"system-text"},Hp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=h(()=>Ht(e.message.timestamp)),o=h(()=>`system
${t.value}`),i=h(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,l)=>i.value?(a(),c("div",Lp,[s("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Np),s("div",Ip,[s("div",jp,[l[1]||(l[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Pp,y(t.value),1)])])])):(a(),c("div",Rp,[s("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Wp),s("div",Bp,[s("span",Fp,y(n.message.content),1)])]))}},xn=ie(Hp,[["__scopeId","data-v-a078178f"]]),Vp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=h(()=>{switch(e.message.type){case"user":return ga;case"assistant":return Dp;case"system":return xn;default:return xn}});return(o,i)=>(a(),$e(po(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Up=ie(Vp,[["__scopeId","data-v-11dff525"]]);var Ee="top",De="bottom",Le="right",Ce="left",us="auto",Dt=[Ee,De,Le,Ce],mt="start",Et="end",go="clippingParents",Ys="viewport",bt="popper",bo="reference",Hs=Dt.reduce(function(n,e){return n.concat([e+"-"+mt,e+"-"+Et])},[]),Js=[].concat(Dt,[us]).reduce(function(n,e){return n.concat([e,e+"-"+mt,e+"-"+Et])},[]),yo="beforeRead",wo="read",$o="afterRead",ko="beforeMain",So="main",Eo="afterMain",Co="beforeWrite",To="write",xo="afterWrite",Ao=[yo,wo,$o,ko,So,Eo,Co,To,xo];function qe(n){return n?(n.nodeName||"").toLowerCase():null}function Ne(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function pt(n){var e=Ne(n).Element;return n instanceof e||n instanceof Element}function Ie(n){var e=Ne(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Qs(n){if(typeof ShadowRoot>"u")return!1;var e=Ne(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function qp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];!Ie(r)||!qe(r)||(Object.assign(r.style,o),Object.keys(i).forEach(function(l){var m=i[l];m===!1?r.removeAttribute(l):r.setAttribute(l,m===!0?"":m)}))})}function zp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],r=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),m=l.reduce(function(p,f){return p[f]="",p},{});!Ie(i)||!qe(i)||(Object.assign(i.style,m),Object.keys(r).forEach(function(p){i.removeAttribute(p)}))})}}const Mo={name:"applyStyles",enabled:!0,phase:"write",fn:qp,effect:zp,requires:["computeStyles"]};function Ve(n){return n.split("-")[0]}var ut=Math.max,is=Math.min,Ct=Math.round;function Vs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Oo(){return!/^((?!chrome|android).)*safari/i.test(Vs())}function Tt(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,r=1;e&&Ie(n)&&(i=n.offsetWidth>0&&Ct(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&Ct(o.height)/n.offsetHeight||1);var l=pt(n)?Ne(n):window,m=l.visualViewport,p=!Oo()&&t,f=(o.left+(p&&m?m.offsetLeft:0))/i,u=(o.top+(p&&m?m.offsetTop:0))/r,w=o.width/i,g=o.height/r;return{width:w,height:g,top:u,right:f+w,bottom:u+g,left:f,x:f,y:u}}function Xs(n){var e=Tt(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function Do(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Qs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Je(n){return Ne(n).getComputedStyle(n)}function Kp(n){return["table","td","th"].indexOf(qe(n))>=0}function it(n){return((pt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ds(n){return qe(n)==="html"?n:n.assignedSlot||n.parentNode||(Qs(n)?n.host:null)||it(n)}function An(n){return!Ie(n)||Je(n).position==="fixed"?null:n.offsetParent}function Gp(n){var e=/firefox/i.test(Vs()),t=/Trident/i.test(Vs());if(t&&Ie(n)){var o=Je(n);if(o.position==="fixed")return null}var i=ds(n);for(Qs(i)&&(i=i.host);Ie(i)&&["html","body"].indexOf(qe(i))<0;){var r=Je(i);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return i;i=i.parentNode}return null}function Vt(n){for(var e=Ne(n),t=An(n);t&&Kp(t)&&Je(t).position==="static";)t=An(t);return t&&(qe(t)==="html"||qe(t)==="body"&&Je(t).position==="static")?e:t||Gp(n)||e}function Zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wt(n,e,t){return ut(n,is(e,t))}function Yp(n,e,t){var o=Wt(n,e,t);return o>t?t:o}function Lo(){return{top:0,right:0,bottom:0,left:0}}function No(n){return Object.assign({},Lo(),n)}function Io(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Jp=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,No(typeof e!="number"?e:Io(e,Dt))};function Qp(n){var e,t=n.state,o=n.name,i=n.options,r=t.elements.arrow,l=t.modifiersData.popperOffsets,m=Ve(t.placement),p=Zs(m),f=[Ce,Le].indexOf(m)>=0,u=f?"height":"width";if(!(!r||!l)){var w=Jp(i.padding,t),g=Xs(r),k=p==="y"?Ee:Ce,$=p==="y"?De:Le,b=t.rects.reference[u]+t.rects.reference[p]-l[p]-t.rects.popper[u],d=l[p]-t.rects.reference[p],v=Vt(r),_=v?p==="y"?v.clientHeight||0:v.clientWidth||0:0,T=b/2-d/2,E=w[k],B=_-g[u]-w[$],P=_/2-g[u]/2+T,A=Wt(E,P,B),V=p;t.modifiersData[o]=(e={},e[V]=A,e.centerOffset=A-P,e)}}function Xp(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Do(e.elements.popper,i)&&(e.elements.arrow=i))}const jo={name:"arrow",enabled:!0,phase:"main",fn:Qp,effect:Xp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function xt(n){return n.split("-")[1]}var Zp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ef(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Ct(t*i)/i||0,y:Ct(o*i)/i||0}}function Mn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,r=n.variation,l=n.offsets,m=n.position,p=n.gpuAcceleration,f=n.adaptive,u=n.roundOffsets,w=n.isFixed,g=l.x,k=g===void 0?0:g,$=l.y,b=$===void 0?0:$,d=typeof u=="function"?u({x:k,y:b}):{x:k,y:b};k=d.x,b=d.y;var v=l.hasOwnProperty("x"),_=l.hasOwnProperty("y"),T=Ce,E=Ee,B=window;if(f){var P=Vt(t),A="clientHeight",V="clientWidth";if(P===Ne(t)&&(P=it(t),Je(P).position!=="static"&&m==="absolute"&&(A="scrollHeight",V="scrollWidth")),P=P,i===Ee||(i===Ce||i===Le)&&r===Et){E=De;var C=w&&P===B&&B.visualViewport?B.visualViewport.height:P[A];b-=C-o.height,b*=p?1:-1}if(i===Ce||(i===Ee||i===De)&&r===Et){T=Le;var S=w&&P===B&&B.visualViewport?B.visualViewport.width:P[V];k-=S-o.width,k*=p?1:-1}}var W=Object.assign({position:m},f&&Zp),z=u===!0?ef({x:k,y:b},Ne(t)):{x:k,y:b};if(k=z.x,b=z.y,p){var j;return Object.assign({},W,(j={},j[E]=_?"0":"",j[T]=v?"0":"",j.transform=(B.devicePixelRatio||1)<=1?"translate("+k+"px, "+b+"px)":"translate3d("+k+"px, "+b+"px, 0)",j))}return Object.assign({},W,(e={},e[E]=_?b+"px":"",e[T]=v?k+"px":"",e.transform="",e))}function tf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,r=t.adaptive,l=r===void 0?!0:r,m=t.roundOffsets,p=m===void 0?!0:m,f={placement:Ve(e.placement),variation:xt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Mn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Mn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Po={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:tf,data:{}};var Yt={passive:!0};function sf(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,r=i===void 0?!0:i,l=o.resize,m=l===void 0?!0:l,p=Ne(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&f.forEach(function(u){u.addEventListener("scroll",t.update,Yt)}),m&&p.addEventListener("resize",t.update,Yt),function(){r&&f.forEach(function(u){u.removeEventListener("scroll",t.update,Yt)}),m&&p.removeEventListener("resize",t.update,Yt)}}const Ro={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sf,data:{}};var nf={left:"right",right:"left",bottom:"top",top:"bottom"};function ss(n){return n.replace(/left|right|bottom|top/g,function(e){return nf[e]})}var of={start:"end",end:"start"};function On(n){return n.replace(/start|end/g,function(e){return of[e]})}function en(n){var e=Ne(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function tn(n){return Tt(it(n)).left+en(n).scrollLeft}function af(n,e){var t=Ne(n),o=it(n),i=t.visualViewport,r=o.clientWidth,l=o.clientHeight,m=0,p=0;if(i){r=i.width,l=i.height;var f=Oo();(f||!f&&e==="fixed")&&(m=i.offsetLeft,p=i.offsetTop)}return{width:r,height:l,x:m+tn(n),y:p}}function rf(n){var e,t=it(n),o=en(n),i=(e=n.ownerDocument)==null?void 0:e.body,r=ut(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=ut(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),m=-o.scrollLeft+tn(n),p=-o.scrollTop;return Je(i||t).direction==="rtl"&&(m+=ut(t.clientWidth,i?i.clientWidth:0)-r),{width:r,height:l,x:m,y:p}}function sn(n){var e=Je(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Wo(n){return["html","body","#document"].indexOf(qe(n))>=0?n.ownerDocument.body:Ie(n)&&sn(n)?n:Wo(ds(n))}function Bt(n,e){var t;e===void 0&&(e=[]);var o=Wo(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),r=Ne(o),l=i?[r].concat(r.visualViewport||[],sn(o)?o:[]):o,m=e.concat(l);return i?m:m.concat(Bt(ds(l)))}function Us(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function lf(n,e){var t=Tt(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Dn(n,e,t){return e===Ys?Us(af(n,t)):pt(e)?lf(e,t):Us(rf(it(n)))}function cf(n){var e=Bt(ds(n)),t=["absolute","fixed"].indexOf(Je(n).position)>=0,o=t&&Ie(n)?Vt(n):n;return pt(o)?e.filter(function(i){return pt(i)&&Do(i,o)&&qe(i)!=="body"}):[]}function uf(n,e,t,o){var i=e==="clippingParents"?cf(n):[].concat(e),r=[].concat(i,[t]),l=r[0],m=r.reduce(function(p,f){var u=Dn(n,f,o);return p.top=ut(u.top,p.top),p.right=is(u.right,p.right),p.bottom=is(u.bottom,p.bottom),p.left=ut(u.left,p.left),p},Dn(n,l,o));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m}function Bo(n){var e=n.reference,t=n.element,o=n.placement,i=o?Ve(o):null,r=o?xt(o):null,l=e.x+e.width/2-t.width/2,m=e.y+e.height/2-t.height/2,p;switch(i){case Ee:p={x:l,y:e.y-t.height};break;case De:p={x:l,y:e.y+e.height};break;case Le:p={x:e.x+e.width,y:m};break;case Ce:p={x:e.x-t.width,y:m};break;default:p={x:e.x,y:e.y}}var f=i?Zs(i):null;if(f!=null){var u=f==="y"?"height":"width";switch(r){case mt:p[f]=p[f]-(e[u]/2-t[u]/2);break;case Et:p[f]=p[f]+(e[u]/2-t[u]/2);break}}return p}function At(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,r=t.strategy,l=r===void 0?n.strategy:r,m=t.boundary,p=m===void 0?go:m,f=t.rootBoundary,u=f===void 0?Ys:f,w=t.elementContext,g=w===void 0?bt:w,k=t.altBoundary,$=k===void 0?!1:k,b=t.padding,d=b===void 0?0:b,v=No(typeof d!="number"?d:Io(d,Dt)),_=g===bt?bo:bt,T=n.rects.popper,E=n.elements[$?_:g],B=uf(pt(E)?E:E.contextElement||it(n.elements.popper),p,u,l),P=Tt(n.elements.reference),A=Bo({reference:P,element:T,placement:i}),V=Us(Object.assign({},T,A)),C=g===bt?V:P,S={top:B.top-C.top+v.top,bottom:C.bottom-B.bottom+v.bottom,left:B.left-C.left+v.left,right:C.right-B.right+v.right},W=n.modifiersData.offset;if(g===bt&&W){var z=W[i];Object.keys(S).forEach(function(j){var H=[Le,De].indexOf(j)>=0?1:-1,G=[Ee,De].indexOf(j)>=0?"y":"x";S[j]+=z[G]*H})}return S}function df(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,r=t.rootBoundary,l=t.padding,m=t.flipVariations,p=t.allowedAutoPlacements,f=p===void 0?Js:p,u=xt(o),w=u?m?Hs:Hs.filter(function($){return xt($)===u}):Dt,g=w.filter(function($){return f.indexOf($)>=0});g.length===0&&(g=w);var k=g.reduce(function($,b){return $[b]=At(n,{placement:b,boundary:i,rootBoundary:r,padding:l})[Ve(b)],$},{});return Object.keys(k).sort(function($,b){return k[$]-k[b]})}function mf(n){if(Ve(n)===us)return[];var e=ss(n);return[On(n),e,On(e)]}function pf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,r=i===void 0?!0:i,l=t.altAxis,m=l===void 0?!0:l,p=t.fallbackPlacements,f=t.padding,u=t.boundary,w=t.rootBoundary,g=t.altBoundary,k=t.flipVariations,$=k===void 0?!0:k,b=t.allowedAutoPlacements,d=e.options.placement,v=Ve(d),_=v===d,T=p||(_||!$?[ss(d)]:mf(d)),E=[d].concat(T).reduce(function(Z,ne){return Z.concat(Ve(ne)===us?df(e,{placement:ne,boundary:u,rootBoundary:w,padding:f,flipVariations:$,allowedAutoPlacements:b}):ne)},[]),B=e.rects.reference,P=e.rects.popper,A=new Map,V=!0,C=E[0],S=0;S<E.length;S++){var W=E[S],z=Ve(W),j=xt(W)===mt,H=[Ee,De].indexOf(z)>=0,G=H?"width":"height",te=At(e,{placement:W,boundary:u,rootBoundary:w,altBoundary:g,padding:f}),O=H?j?Le:Ce:j?De:Ee;B[G]>P[G]&&(O=ss(O));var L=ss(O),M=[];if(r&&M.push(te[z]<=0),m&&M.push(te[O]<=0,te[L]<=0),M.every(function(Z){return Z})){C=W,V=!1;break}A.set(W,M)}if(V)for(var D=$?3:1,Y=function(ne){var K=E.find(function(I){var N=A.get(I);if(N)return N.slice(0,ne).every(function(U){return U})});if(K)return C=K,"break"},ee=D;ee>0;ee--){var X=Y(ee);if(X==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const Fo={name:"flip",enabled:!0,phase:"main",fn:pf,requiresIfExists:["offset"],data:{_skip:!1}};function Ln(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Nn(n){return[Ee,Le,De,Ce].some(function(e){return n[e]>=0})}function ff(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,r=e.modifiersData.preventOverflow,l=At(e,{elementContext:"reference"}),m=At(e,{altBoundary:!0}),p=Ln(l,o),f=Ln(m,i,r),u=Nn(p),w=Nn(f);e.modifiersData[t]={referenceClippingOffsets:p,popperEscapeOffsets:f,isReferenceHidden:u,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":w})}const Ho={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ff};function vf(n,e,t){var o=Ve(n),i=[Ce,Ee].indexOf(o)>=0?-1:1,r=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,l=r[0],m=r[1];return l=l||0,m=(m||0)*i,[Ce,Le].indexOf(o)>=0?{x:m,y:l}:{x:l,y:m}}function hf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,r=i===void 0?[0,0]:i,l=Js.reduce(function(u,w){return u[w]=vf(w,e.rects,r),u},{}),m=l[e.placement],p=m.x,f=m.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=l}const Vo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:hf};function _f(n){var e=n.state,t=n.name;e.modifiersData[t]=Bo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Uo={name:"popperOffsets",enabled:!0,phase:"read",fn:_f,data:{}};function gf(n){return n==="x"?"y":"x"}function bf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,r=i===void 0?!0:i,l=t.altAxis,m=l===void 0?!1:l,p=t.boundary,f=t.rootBoundary,u=t.altBoundary,w=t.padding,g=t.tether,k=g===void 0?!0:g,$=t.tetherOffset,b=$===void 0?0:$,d=At(e,{boundary:p,rootBoundary:f,padding:w,altBoundary:u}),v=Ve(e.placement),_=xt(e.placement),T=!_,E=Zs(v),B=gf(E),P=e.modifiersData.popperOffsets,A=e.rects.reference,V=e.rects.popper,C=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,S=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),W=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,z={x:0,y:0};if(P){if(r){var j,H=E==="y"?Ee:Ce,G=E==="y"?De:Le,te=E==="y"?"height":"width",O=P[E],L=O+d[H],M=O-d[G],D=k?-V[te]/2:0,Y=_===mt?A[te]:V[te],ee=_===mt?-V[te]:-A[te],X=e.elements.arrow,Z=k&&X?Xs(X):{width:0,height:0},ne=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Lo(),K=ne[H],I=ne[G],N=Wt(0,A[te],Z[te]),U=T?A[te]/2-D-N-K-S.mainAxis:Y-N-K-S.mainAxis,Q=T?-A[te]/2+D+N+I+S.mainAxis:ee+N+I+S.mainAxis,F=e.elements.arrow&&Vt(e.elements.arrow),oe=F?E==="y"?F.clientTop||0:F.clientLeft||0:0,fe=(j=W?.[E])!=null?j:0,ge=O+U-fe-oe,q=O+Q-fe,ae=Wt(k?is(L,ge):L,O,k?ut(M,q):M);P[E]=ae,z[E]=ae-O}if(m){var de,Ae=E==="x"?Ee:Ce,Be=E==="x"?De:Le,Se=P[B],Gt=B==="y"?"height":"width",dn=Se+d[Ae],mn=Se-d[Be],gs=[Ee,Ce].indexOf(v)!==-1,pn=(de=W?.[B])!=null?de:0,fn=gs?dn:Se-A[Gt]-V[Gt]-pn+S.altAxis,vn=gs?Se+A[Gt]+V[Gt]-pn-S.altAxis:mn,hn=k&&gs?Yp(fn,Se,vn):Wt(k?fn:dn,Se,k?vn:mn);P[B]=hn,z[B]=hn-Se}e.modifiersData[o]=z}}const qo={name:"preventOverflow",enabled:!0,phase:"main",fn:bf,requiresIfExists:["offset"]};function yf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function wf(n){return n===Ne(n)||!Ie(n)?en(n):yf(n)}function $f(n){var e=n.getBoundingClientRect(),t=Ct(e.width)/n.offsetWidth||1,o=Ct(e.height)/n.offsetHeight||1;return t!==1||o!==1}function kf(n,e,t){t===void 0&&(t=!1);var o=Ie(e),i=Ie(e)&&$f(e),r=it(e),l=Tt(n,i,t),m={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!t)&&((qe(e)!=="body"||sn(r))&&(m=wf(e)),Ie(e)?(p=Tt(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):r&&(p.x=tn(r))),{x:l.left+m.scrollLeft-p.x,y:l.top+m.scrollTop-p.y,width:l.width,height:l.height}}function Sf(n){var e=new Map,t=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function i(r){t.add(r.name);var l=[].concat(r.requires||[],r.requiresIfExists||[]);l.forEach(function(m){if(!t.has(m)){var p=e.get(m);p&&i(p)}}),o.push(r)}return n.forEach(function(r){t.has(r.name)||i(r)}),o}function Ef(n){var e=Sf(n);return Ao.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Cf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Tf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var In={placement:"bottom",modifiers:[],strategy:"absolute"};function jn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function zo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,r=i===void 0?In:i;return function(m,p,f){f===void 0&&(f=r);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},In,r),modifiersData:{},elements:{reference:m,popper:p},attributes:{},styles:{}},w=[],g=!1,k={state:u,setOptions:function(v){var _=typeof v=="function"?v(u.options):v;b(),u.options=Object.assign({},r,u.options,_),u.scrollParents={reference:pt(m)?Bt(m):m.contextElement?Bt(m.contextElement):[],popper:Bt(p)};var T=Ef(Tf([].concat(o,u.options.modifiers)));return u.orderedModifiers=T.filter(function(E){return E.enabled}),$(),k.update()},forceUpdate:function(){if(!g){var v=u.elements,_=v.reference,T=v.popper;if(jn(_,T)){u.rects={reference:kf(_,Vt(T),u.options.strategy==="fixed"),popper:Xs(T)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(S){return u.modifiersData[S.name]=Object.assign({},S.data)});for(var E=0;E<u.orderedModifiers.length;E++){if(u.reset===!0){u.reset=!1,E=-1;continue}var B=u.orderedModifiers[E],P=B.fn,A=B.options,V=A===void 0?{}:A,C=B.name;typeof P=="function"&&(u=P({state:u,options:V,name:C,instance:k})||u)}}}},update:Cf(function(){return new Promise(function(d){k.forceUpdate(),d(u)})}),destroy:function(){b(),g=!0}};if(!jn(m,p))return k;k.setOptions(f).then(function(d){!g&&f.onFirstUpdate&&f.onFirstUpdate(d)});function $(){u.orderedModifiers.forEach(function(d){var v=d.name,_=d.options,T=_===void 0?{}:_,E=d.effect;if(typeof E=="function"){var B=E({state:u,name:v,instance:k,options:T}),P=function(){};w.push(B||P)}})}function b(){w.forEach(function(d){return d()}),w=[]}return k}}var xf=[Ro,Uo,Po,Mo,Vo,Fo,qo,jo,Ho],nn=zo({defaultModifiers:xf});const Ko=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Eo,afterRead:$o,afterWrite:xo,applyStyles:Mo,arrow:jo,auto:us,basePlacements:Dt,beforeMain:ko,beforeRead:yo,beforeWrite:Co,bottom:De,clippingParents:go,computeStyles:Po,createPopper:nn,detectOverflow:At,end:Et,eventListeners:Ro,flip:Fo,hide:Ho,left:Ce,main:So,modifierPhases:Ao,offset:Vo,placements:Js,popper:bt,popperGenerator:zo,popperOffsets:Uo,preventOverflow:qo,read:wo,reference:bo,right:Le,start:mt,top:Ee,variationPlacements:Hs,viewport:Ys,write:To},Symbol.toStringTag,{value:"Module"}));const Xe=new Map,Cs={set(n,e,t){Xe.has(n)||Xe.set(n,new Map);const o=Xe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Xe.has(n)&&Xe.get(n).get(e)||null},remove(n,e){if(!Xe.has(n))return;const t=Xe.get(n);t.delete(e),t.size===0&&Xe.delete(n)}},Af=1e6,Mf=1e3,qs="transitionend",Go=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Of=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Df=n=>{do n+=Math.floor(Math.random()*Af);while(document.getElementById(n));return n},Lf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Mf)},Yo=n=>{n.dispatchEvent(new Event(qs))},Ge=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),et=n=>Ge(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Go(n)):null,Lt=n=>{if(!Ge(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},tt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Jo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Jo(n.parentNode):null},as=()=>{},Ut=n=>{n.offsetHeight},Qo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ts=[],Nf=n=>{document.readyState==="loading"?(Ts.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ts)e()}),Ts.push(n)):n()},je=()=>document.documentElement.dir==="rtl",We=n=>{Nf(()=>{const e=Qo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},xe=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Xo=(n,e,t=!0)=>{if(!t){xe(n);return}const i=Lf(e)+5;let r=!1;const l=({target:m})=>{m===e&&(r=!0,e.removeEventListener(qs,l),xe(n))};e.addEventListener(qs,l),setTimeout(()=>{r||Yo(e)},i)},on=(n,e,t,o)=>{const i=n.length;let r=n.indexOf(e);return r===-1?!t&&o?n[i-1]:n[0]:(r+=t?1:-1,o&&(r=(r+i)%i),n[Math.max(0,Math.min(r,i-1))])},If=/[^.]*(?=\..*)\.|.*/,jf=/\..*/,Pf=/::\d+$/,xs={};let Pn=1;const Zo={mouseenter:"mouseover",mouseleave:"mouseout"},Rf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ei(n,e){return e&&`${e}::${Pn++}`||n.uidEvent||Pn++}function ti(n){const e=ei(n);return n.uidEvent=e,xs[e]=xs[e]||{},xs[e]}function Wf(n,e){return function t(o){return an(o,{delegateTarget:n}),t.oneOff&&J.off(n,o.type,e),e.apply(n,[o])}}function Bf(n,e,t){return function o(i){const r=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const m of r)if(m===l)return an(i,{delegateTarget:l}),o.oneOff&&J.off(n,i.type,e,t),t.apply(l,[i])}}function si(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function ni(n,e,t){const o=typeof e=="string",i=o?t:e||t;let r=oi(n);return Rf.has(r)||(r=n),[o,i,r]}function Rn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[r,l,m]=ni(e,t,o);e in Zo&&(l=($=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return $.call(this,b)})(l));const p=ti(n),f=p[m]||(p[m]={}),u=si(f,l,r?t:null);if(u){u.oneOff=u.oneOff&&i;return}const w=ei(l,e.replace(If,"")),g=r?Bf(n,t,l):Wf(n,l);g.delegationSelector=r?t:null,g.callable=l,g.oneOff=i,g.uidEvent=w,f[w]=g,n.addEventListener(m,g,r)}function zs(n,e,t,o,i){const r=si(e[t],o,i);r&&(n.removeEventListener(t,r,!!i),delete e[t][r.uidEvent])}function Ff(n,e,t,o){const i=e[t]||{};for(const[r,l]of Object.entries(i))r.includes(o)&&zs(n,e,t,l.callable,l.delegationSelector)}function oi(n){return n=n.replace(jf,""),Zo[n]||n}const J={on(n,e,t,o){Rn(n,e,t,o,!1)},one(n,e,t,o){Rn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,r,l]=ni(e,t,o),m=l!==e,p=ti(n),f=p[l]||{},u=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(f).length)return;zs(n,p,l,r,i?t:null);return}if(u)for(const w of Object.keys(p))Ff(n,p,w,e.slice(1));for(const[w,g]of Object.entries(f)){const k=w.replace(Pf,"");(!m||e.includes(k))&&zs(n,p,l,g.callable,g.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Qo(),i=oi(e),r=e!==i;let l=null,m=!0,p=!0,f=!1;r&&o&&(l=o.Event(e,t),o(n).trigger(l),m=!l.isPropagationStopped(),p=!l.isImmediatePropagationStopped(),f=l.isDefaultPrevented());const u=an(new Event(e,{bubbles:m,cancelable:!0}),t);return f&&u.preventDefault(),p&&n.dispatchEvent(u),u.defaultPrevented&&l&&l.preventDefault(),u}};function an(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function Wn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function As(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ye={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${As(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${As(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Wn(n.dataset[o])}return e},getDataAttribute(n,e){return Wn(n.getAttribute(`data-bs-${As(e)}`))}};class qt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Ge(t)?Ye.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ge(t)?Ye.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const r=e[o],l=Ge(r)?"element":Of(r);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const Hf="5.3.8";class He extends qt{constructor(e,t){super(),e=et(e),e&&(this._element=e,this._config=this._getConfig(t),Cs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Cs.remove(this._element,this.constructor.DATA_KEY),J.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Xo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Cs.get(et(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Hf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ms=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Go(t)).join(","):null},ce={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!tt(t)&&Lt(t))},getSelectorFromElement(n){const e=Ms(n);return e&&ce.findOne(e)?e:null},getElementFromSelector(n){const e=Ms(n);return e?ce.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ms(n);return e?ce.find(e):[]}},ms=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;J.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),tt(this))return;const r=ce.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},Vf="alert",Uf="bs.alert",ii=`.${Uf}`,qf=`close${ii}`,zf=`closed${ii}`,Kf="fade",Gf="show";class ps extends He{static get NAME(){return Vf}close(){if(J.trigger(this._element,qf).defaultPrevented)return;this._element.classList.remove(Gf);const t=this._element.classList.contains(Kf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),J.trigger(this._element,zf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(ps,"close");We(ps);const Yf="button",Jf="bs.button",Qf=`.${Jf}`,Xf=".data-api",Zf="active",Bn='[data-bs-toggle="button"]',ev=`click${Qf}${Xf}`;class fs extends He{static get NAME(){return Yf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Zf))}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}J.on(document,ev,Bn,n=>{n.preventDefault();const e=n.target.closest(Bn);fs.getOrCreateInstance(e).toggle()});We(fs);const tv="swipe",Nt=".bs.swipe",sv=`touchstart${Nt}`,nv=`touchmove${Nt}`,ov=`touchend${Nt}`,iv=`pointerdown${Nt}`,av=`pointerup${Nt}`,rv="touch",lv="pen",cv="pointer-event",uv=40,dv={endCallback:null,leftCallback:null,rightCallback:null},mv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class rs extends qt{constructor(e,t){super(),this._element=e,!(!e||!rs.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return dv}static get DefaultType(){return mv}static get NAME(){return tv}dispose(){J.off(this._element,Nt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),xe(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=uv)return;const t=e/this._deltaX;this._deltaX=0,t&&xe(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(J.on(this._element,iv,e=>this._start(e)),J.on(this._element,av,e=>this._end(e)),this._element.classList.add(cv)):(J.on(this._element,sv,e=>this._start(e)),J.on(this._element,nv,e=>this._move(e)),J.on(this._element,ov,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===lv||e.pointerType===rv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const pv="carousel",fv="bs.carousel",at=`.${fv}`,ai=".data-api",vv="ArrowLeft",hv="ArrowRight",_v=500,jt="next",_t="prev",yt="left",ns="right",gv=`slide${at}`,Os=`slid${at}`,bv=`keydown${at}`,yv=`mouseenter${at}`,wv=`mouseleave${at}`,$v=`dragstart${at}`,kv=`load${at}${ai}`,Sv=`click${at}${ai}`,ri="carousel",Jt="active",Ev="slide",Cv="carousel-item-end",Tv="carousel-item-start",xv="carousel-item-next",Av="carousel-item-prev",li=".active",ci=".carousel-item",Mv=li+ci,Ov=".carousel-item img",Dv=".carousel-indicators",Lv="[data-bs-slide], [data-bs-slide-to]",Nv='[data-bs-ride="carousel"]',Iv={[vv]:ns,[hv]:yt},jv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Pv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class zt extends He{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ce.findOne(Dv,this._element),this._addEventListeners(),this._config.ride===ri&&this.cycle()}static get Default(){return jv}static get DefaultType(){return Pv}static get NAME(){return pv}next(){this._slide(jt)}nextWhenVisible(){!document.hidden&&Lt(this._element)&&this.next()}prev(){this._slide(_t)}pause(){this._isSliding&&Yo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){J.one(this._element,Os,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){J.one(this._element,Os,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?jt:_t;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&J.on(this._element,bv,e=>this._keydown(e)),this._config.pause==="hover"&&(J.on(this._element,yv,()=>this.pause()),J.on(this._element,wv,()=>this._maybeEnableCycle())),this._config.touch&&rs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ce.find(Ov,this._element))J.on(o,$v,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(yt)),rightCallback:()=>this._slide(this._directionToOrder(ns)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),_v+this._config.interval))}};this._swipeHelper=new rs(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Iv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=ce.findOne(li,this._indicatorsElement);t.classList.remove(Jt),t.removeAttribute("aria-current");const o=ce.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Jt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===jt,r=t||on(this._getItems(),o,i,this._config.wrap);if(r===o)return;const l=this._getItemIndex(r),m=k=>J.trigger(this._element,k,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(m(gv).defaultPrevented||!o||!r)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=r;const u=i?Tv:Cv,w=i?xv:Av;r.classList.add(w),Ut(r),o.classList.add(u),r.classList.add(u);const g=()=>{r.classList.remove(u,w),r.classList.add(Jt),o.classList.remove(Jt,w,u),this._isSliding=!1,m(Os)};this._queueCallback(g,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(Ev)}_getActive(){return ce.findOne(Mv,this._element)}_getItems(){return ce.find(ci,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return je()?e===yt?_t:jt:e===yt?jt:_t}_orderToDirection(e){return je()?e===_t?yt:ns:e===_t?ns:yt}static jQueryInterface(e){return this.each(function(){const t=zt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}J.on(document,Sv,Lv,function(n){const e=ce.getElementFromSelector(this);if(!e||!e.classList.contains(ri))return;n.preventDefault();const t=zt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Ye.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});J.on(window,kv,()=>{const n=ce.find(Nv);for(const e of n)zt.getOrCreateInstance(e)});We(zt);const Rv="collapse",Wv="bs.collapse",Kt=`.${Wv}`,Bv=".data-api",Fv=`show${Kt}`,Hv=`shown${Kt}`,Vv=`hide${Kt}`,Uv=`hidden${Kt}`,qv=`click${Kt}${Bv}`,Ds="show",$t="collapse",Qt="collapsing",zv="collapsed",Kv=`:scope .${$t} .${$t}`,Gv="collapse-horizontal",Yv="width",Jv="height",Qv=".collapse.show, .collapse.collapsing",Ks='[data-bs-toggle="collapse"]',Xv={parent:null,toggle:!0},Zv={parent:"(null|element)",toggle:"boolean"};class Mt extends He{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=ce.find(Ks);for(const i of o){const r=ce.getSelectorFromElement(i),l=ce.find(r).filter(m=>m===this._element);r!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Xv}static get DefaultType(){return Zv}static get NAME(){return Rv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Qv).filter(m=>m!==this._element).map(m=>Mt.getOrCreateInstance(m,{toggle:!1}))),e.length&&e[0]._isTransitioning||J.trigger(this._element,Fv).defaultPrevented)return;for(const m of e)m.hide();const o=this._getDimension();this._element.classList.remove($t),this._element.classList.add(Qt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t,Ds),this._element.style[o]="",J.trigger(this._element,Hv)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||J.trigger(this._element,Vv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ut(this._element),this._element.classList.add(Qt),this._element.classList.remove($t,Ds);for(const i of this._triggerArray){const r=ce.getElementFromSelector(i);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t),J.trigger(this._element,Uv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ds)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=et(e.parent),e}_getDimension(){return this._element.classList.contains(Gv)?Yv:Jv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ks);for(const t of e){const o=ce.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=ce.find(Kv,this._config.parent);return ce.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(zv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Mt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}J.on(document,qv,Ks,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ce.getMultipleElementsFromSelector(this))Mt.getOrCreateInstance(e,{toggle:!1}).toggle()});We(Mt);const Fn="dropdown",eh="bs.dropdown",vt=`.${eh}`,rn=".data-api",th="Escape",Hn="Tab",sh="ArrowUp",Vn="ArrowDown",nh=2,oh=`hide${vt}`,ih=`hidden${vt}`,ah=`show${vt}`,rh=`shown${vt}`,ui=`click${vt}${rn}`,di=`keydown${vt}${rn}`,lh=`keyup${vt}${rn}`,wt="show",ch="dropup",uh="dropend",dh="dropstart",mh="dropup-center",ph="dropdown-center",lt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',fh=`${lt}.${wt}`,os=".dropdown-menu",vh=".navbar",hh=".navbar-nav",_h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",gh=je()?"top-end":"top-start",bh=je()?"top-start":"top-end",yh=je()?"bottom-end":"bottom-start",wh=je()?"bottom-start":"bottom-end",$h=je()?"left-start":"right-start",kh=je()?"right-start":"left-start",Sh="top",Eh="bottom",Ch={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Th={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ue extends He{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=ce.next(this._element,os)[0]||ce.prev(this._element,os)[0]||ce.findOne(os,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ch}static get DefaultType(){return Th}static get NAME(){return Fn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(tt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!J.trigger(this._element,ah,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(hh))for(const o of[].concat(...document.body.children))J.on(o,"mouseover",as);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(wt),this._element.classList.add(wt),J.trigger(this._element,rh,e)}}hide(){if(tt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!J.trigger(this._element,oh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))J.off(o,"mouseover",as);this._popper&&this._popper.destroy(),this._menu.classList.remove(wt),this._element.classList.remove(wt),this._element.setAttribute("aria-expanded","false"),Ye.removeDataAttribute(this._menu,"popper"),J.trigger(this._element,ih,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ge(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Fn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ko>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ge(this._config.reference)?e=et(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=nn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(wt)}_getPlacement(){const e=this._parent;if(e.classList.contains(uh))return $h;if(e.classList.contains(dh))return kh;if(e.classList.contains(mh))return Sh;if(e.classList.contains(ph))return Eh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ch)?t?bh:gh:t?wh:yh}_detectNavbar(){return this._element.closest(vh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ye.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...xe(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=ce.find(_h,this._menu).filter(i=>Lt(i));o.length&&on(o,t,e===Vn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ue.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===nh||e.type==="keyup"&&e.key!==Hn)return;const t=ce.find(fh);for(const o of t){const i=Ue.getInstance(o);if(!i||i._config.autoClose===!1)continue;const r=e.composedPath(),l=r.includes(i._menu);if(r.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Hn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const m={relatedTarget:i._element};e.type==="click"&&(m.clickEvent=e),i._completeHide(m)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===th,i=[sh,Vn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const r=this.matches(lt)?this:ce.prev(this,lt)[0]||ce.next(this,lt)[0]||ce.findOne(lt,e.delegateTarget.parentNode),l=Ue.getOrCreateInstance(r);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),r.focus())}}J.on(document,di,lt,Ue.dataApiKeydownHandler);J.on(document,di,os,Ue.dataApiKeydownHandler);J.on(document,ui,Ue.clearMenus);J.on(document,lh,Ue.clearMenus);J.on(document,ui,lt,function(n){n.preventDefault(),Ue.getOrCreateInstance(this).toggle()});We(Ue);const mi="backdrop",xh="fade",Un="show",qn=`mousedown.bs.${mi}`,Ah={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Mh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class pi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ah}static get DefaultType(){return Mh}static get NAME(){return mi}show(e){if(!this._config.isVisible){xe(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Ut(t),t.classList.add(Un),this._emulateAnimation(()=>{xe(e)})}hide(e){if(!this._config.isVisible){xe(e);return}this._getElement().classList.remove(Un),this._emulateAnimation(()=>{this.dispose(),xe(e)})}dispose(){this._isAppended&&(J.off(this._element,qn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(xh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=et(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),J.on(e,qn,()=>{xe(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Xo(e,this._getElement(),this._config.isAnimated)}}const Oh="focustrap",Dh="bs.focustrap",ls=`.${Dh}`,Lh=`focusin${ls}`,Nh=`keydown.tab${ls}`,Ih="Tab",jh="forward",zn="backward",Ph={autofocus:!0,trapElement:null},Rh={autofocus:"boolean",trapElement:"element"};class fi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ph}static get DefaultType(){return Rh}static get NAME(){return Oh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),J.off(document,ls),J.on(document,Lh,e=>this._handleFocusin(e)),J.on(document,Nh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,J.off(document,ls))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=ce.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===zn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Ih&&(this._lastTabNavDirection=e.shiftKey?zn:jh)}}const Kn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Gn=".sticky-top",Xt="padding-right",Yn="margin-right";class Gs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Xt,t=>t+e),this._setElementAttributes(Kn,Xt,t=>t+e),this._setElementAttributes(Gn,Yn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Xt),this._resetElementAttributes(Kn,Xt),this._resetElementAttributes(Gn,Yn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),r=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,t);const m=window.getComputedStyle(l).getPropertyValue(t);l.style.setProperty(t,`${o(Number.parseFloat(m))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Ye.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const r=Ye.getDataAttribute(i,t);if(r===null){i.style.removeProperty(t);return}Ye.removeDataAttribute(i,t),i.style.setProperty(t,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Ge(e)){t(e);return}for(const o of ce.find(e,this._element))t(o)}}const Wh="modal",Bh="bs.modal",Pe=`.${Bh}`,Fh=".data-api",Hh="Escape",Vh=`hide${Pe}`,Uh=`hidePrevented${Pe}`,vi=`hidden${Pe}`,hi=`show${Pe}`,qh=`shown${Pe}`,zh=`resize${Pe}`,Kh=`click.dismiss${Pe}`,Gh=`mousedown.dismiss${Pe}`,Yh=`keydown.dismiss${Pe}`,Jh=`click${Pe}${Fh}`,Jn="modal-open",Qh="fade",Qn="show",Ls="modal-static",Xh=".modal.show",Zh=".modal-dialog",e_=".modal-body",t_='[data-bs-toggle="modal"]',s_={backdrop:!0,focus:!0,keyboard:!0},n_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ft extends He{constructor(e,t){super(e,t),this._dialog=ce.findOne(Zh,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Gs,this._addEventListeners()}static get Default(){return s_}static get DefaultType(){return n_}static get NAME(){return Wh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||J.trigger(this._element,hi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Jn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||J.trigger(this._element,Vh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Qn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){J.off(window,Pe),J.off(this._dialog,Pe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new pi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=ce.findOne(e_,this._dialog);t&&(t.scrollTop=0),Ut(this._element),this._element.classList.add(Qn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,J.trigger(this._element,qh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){J.on(this._element,Yh,e=>{if(e.key===Hh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),J.on(window,zh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),J.on(this._element,Gh,e=>{J.one(this._element,Kh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Jn),this._resetAdjustments(),this._scrollBar.reset(),J.trigger(this._element,vi)})}_isAnimated(){return this._element.classList.contains(Qh)}_triggerBackdropTransition(){if(J.trigger(this._element,Uh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ls)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ls),this._queueCallback(()=>{this._element.classList.remove(Ls),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=je()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=je()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=ft.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}J.on(document,Jh,t_,function(n){const e=ce.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),J.one(e,hi,i=>{i.defaultPrevented||J.one(e,vi,()=>{Lt(this)&&this.focus()})});const t=ce.findOne(Xh);t&&ft.getInstance(t).hide(),ft.getOrCreateInstance(e).toggle(this)});ms(ft);We(ft);const o_="offcanvas",i_="bs.offcanvas",Qe=`.${i_}`,_i=".data-api",a_=`load${Qe}${_i}`,r_="Escape",Xn="show",Zn="showing",eo="hiding",l_="offcanvas-backdrop",gi=".offcanvas.show",c_=`show${Qe}`,u_=`shown${Qe}`,d_=`hide${Qe}`,to=`hidePrevented${Qe}`,bi=`hidden${Qe}`,m_=`resize${Qe}`,p_=`click${Qe}${_i}`,f_=`keydown.dismiss${Qe}`,v_='[data-bs-toggle="offcanvas"]',h_={backdrop:!0,keyboard:!0,scroll:!1},__={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class st extends He{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return h_}static get DefaultType(){return __}static get NAME(){return o_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||J.trigger(this._element,c_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Gs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Xn),this._element.classList.remove(Zn),J.trigger(this._element,u_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||J.trigger(this._element,d_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(eo),this._backdrop.hide();const t=()=>{this._element.classList.remove(Xn,eo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Gs().reset(),J.trigger(this._element,bi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){J.trigger(this._element,to);return}this.hide()},t=!!this._config.backdrop;return new pi({className:l_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_addEventListeners(){J.on(this._element,f_,e=>{if(e.key===r_){if(this._config.keyboard){this.hide();return}J.trigger(this._element,to)}})}static jQueryInterface(e){return this.each(function(){const t=st.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}J.on(document,p_,v_,function(n){const e=ce.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),tt(this))return;J.one(e,bi,()=>{Lt(this)&&this.focus()});const t=ce.findOne(gi);t&&t!==e&&st.getInstance(t).hide(),st.getOrCreateInstance(e).toggle(this)});J.on(window,a_,()=>{for(const n of ce.find(gi))st.getOrCreateInstance(n).show()});J.on(window,m_,()=>{for(const n of ce.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&st.getOrCreateInstance(n).hide()});ms(st);We(st);const g_=/^aria-[\w-]*$/i,yi={"*":["class","dir","id","lang","role",g_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},b_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),y_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,w_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?b_.has(t)?!!y_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function $_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const l of r){const m=l.nodeName.toLowerCase();if(!Object.keys(e).includes(m)){l.remove();continue}const p=[].concat(...l.attributes),f=[].concat(e["*"]||[],e[m]||[]);for(const u of p)w_(u,f)||l.removeAttribute(u.nodeName)}return i.body.innerHTML}const k_="TemplateFactory",S_={allowList:yi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},E_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},C_={entry:"(string|element|function|null)",selector:"(string|element)"};class T_ extends qt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return S_}static get DefaultType(){return E_}static get NAME(){return k_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,r]of Object.entries(this._config.content))this._setContent(e,r,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},C_)}_setContent(e,t,o){const i=ce.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Ge(t)){this._putElementInTemplate(et(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?$_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return xe(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const x_="tooltip",A_=new Set(["sanitize","allowList","sanitizeFn"]),Ns="fade",M_="modal",Zt="show",O_=".tooltip-inner",so=`.${M_}`,no="hide.bs.modal",Pt="hover",Is="focus",js="click",D_="manual",L_="hide",N_="hidden",I_="show",j_="shown",P_="inserted",R_="click",W_="focusin",B_="focusout",F_="mouseenter",H_="mouseleave",V_={AUTO:"auto",TOP:"top",RIGHT:je()?"left":"right",BOTTOM:"bottom",LEFT:je()?"right":"left"},U_={allowList:yi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},q_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class It extends He{constructor(e,t){if(typeof Ko>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return U_}static get DefaultType(){return q_}static get NAME(){return x_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),J.off(this._element.closest(so),no,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=J.trigger(this._element,this.constructor.eventName(I_)),o=(Jo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(i),J.trigger(this._element,this.constructor.eventName(P_))),this._popper=this._createPopper(i),i.classList.add(Zt),"ontouchstart"in document.documentElement)for(const m of[].concat(...document.body.children))J.on(m,"mouseover",as);const l=()=>{J.trigger(this._element,this.constructor.eventName(j_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||J.trigger(this._element,this.constructor.eventName(L_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Zt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))J.off(i,"mouseover",as);this._activeTrigger[js]=!1,this._activeTrigger[Is]=!1,this._activeTrigger[Pt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),J.trigger(this._element,this.constructor.eventName(N_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ns,Zt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Df(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ns),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new T_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[O_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ns)}_isShown(){return this.tip&&this.tip.classList.contains(Zt)}_createPopper(e){const t=xe(this._config.placement,[this,e,this._element]),o=V_[t.toUpperCase()];return nn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return xe(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...xe(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")J.on(this._element,this.constructor.eventName(R_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[js]=!(i._isShown()&&i._activeTrigger[js]),i.toggle()});else if(t!==D_){const o=t===Pt?this.constructor.eventName(F_):this.constructor.eventName(W_),i=t===Pt?this.constructor.eventName(H_):this.constructor.eventName(B_);J.on(this._element,o,this._config.selector,r=>{const l=this._initializeOnDelegatedTarget(r);l._activeTrigger[r.type==="focusin"?Is:Pt]=!0,l._enter()}),J.on(this._element,i,this._config.selector,r=>{const l=this._initializeOnDelegatedTarget(r);l._activeTrigger[r.type==="focusout"?Is:Pt]=l._element.contains(r.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},J.on(this._element.closest(so),no,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Ye.getDataAttributes(this._element);for(const o of Object.keys(t))A_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:et(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=It.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}We(It);const z_="popover",K_=".popover-header",G_=".popover-body",Y_={...It.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},J_={...It.DefaultType,content:"(null|string|element|function)"};class ln extends It{static get Default(){return Y_}static get DefaultType(){return J_}static get NAME(){return z_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[K_]:this._getTitle(),[G_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=ln.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}We(ln);const Q_="scrollspy",X_="bs.scrollspy",cn=`.${X_}`,Z_=".data-api",eg=`activate${cn}`,oo=`click${cn}`,tg=`load${cn}${Z_}`,sg="dropdown-item",gt="active",ng='[data-bs-spy="scroll"]',Ps="[href]",og=".nav, .list-group",io=".nav-link",ig=".nav-item",ag=".list-group-item",rg=`${io}, ${ig} > ${io}, ${ag}`,lg=".dropdown",cg=".dropdown-toggle",ug={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},dg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class vs extends He{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ug}static get DefaultType(){return dg}static get NAME(){return Q_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=et(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(J.off(this._config.target,oo),J.on(this._config.target,oo,Ps,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(t(l))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(l));continue}const m=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&m){if(o(l),!i)return;continue}!r&&!m&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ce.find(Ps,this._config.target);for(const t of e){if(!t.hash||tt(t))continue;const o=ce.findOne(decodeURI(t.hash),this._element);Lt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(gt),this._activateParents(e),J.trigger(this._element,eg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(sg)){ce.findOne(cg,e.closest(lg)).classList.add(gt);return}for(const t of ce.parents(e,og))for(const o of ce.prev(t,rg))o.classList.add(gt)}_clearActiveClass(e){e.classList.remove(gt);const t=ce.find(`${Ps}.${gt}`,e);for(const o of t)o.classList.remove(gt)}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}J.on(window,tg,()=>{for(const n of ce.find(ng))vs.getOrCreateInstance(n)});We(vs);const mg="tab",pg="bs.tab",ht=`.${pg}`,fg=`hide${ht}`,vg=`hidden${ht}`,hg=`show${ht}`,_g=`shown${ht}`,gg=`click${ht}`,bg=`keydown${ht}`,yg=`load${ht}`,wg="ArrowLeft",ao="ArrowRight",$g="ArrowUp",ro="ArrowDown",Rs="Home",lo="End",ct="active",co="fade",Ws="show",kg="dropdown",wi=".dropdown-toggle",Sg=".dropdown-menu",Bs=`:not(${wi})`,Eg='.list-group, .nav, [role="tablist"]',Cg=".nav-item, .list-group-item",Tg=`.nav-link${Bs}, .list-group-item${Bs}, [role="tab"]${Bs}`,$i='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Fs=`${Tg}, ${$i}`,xg=`.${ct}[data-bs-toggle="tab"], .${ct}[data-bs-toggle="pill"], .${ct}[data-bs-toggle="list"]`;class Ot extends He{constructor(e){super(e),this._parent=this._element.closest(Eg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),J.on(this._element,bg,t=>this._keydown(t)))}static get NAME(){return mg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?J.trigger(t,fg,{relatedTarget:e}):null;J.trigger(e,hg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(ct),this._activate(ce.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ws);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),J.trigger(e,_g,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_deactivate(e,t){if(!e)return;e.classList.remove(ct),e.blur(),this._deactivate(ce.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ws);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),J.trigger(e,vg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_keydown(e){if(![wg,ao,$g,ro,Rs,lo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!tt(i));let o;if([Rs,lo].includes(e.key))o=t[e.key===Rs?0:t.length-1];else{const i=[ao,ro].includes(e.key);o=on(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Ot.getOrCreateInstance(o).show())}_getChildren(){return ce.find(Fs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=ce.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(kg))return;const i=(r,l)=>{const m=ce.findOne(r,o);m&&m.classList.toggle(l,t)};i(wi,ct),i(Sg,Ws),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(ct)}_getInnerElement(e){return e.matches(Fs)?e:ce.findOne(Fs,e)}_getOuterElement(e){return e.closest(Cg)||e}static jQueryInterface(e){return this.each(function(){const t=Ot.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}J.on(document,gg,$i,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!tt(this)&&Ot.getOrCreateInstance(this).show()});J.on(window,yg,()=>{for(const n of ce.find(xg))Ot.getOrCreateInstance(n)});We(Ot);const Ag="toast",Mg="bs.toast",rt=`.${Mg}`,Og=`mouseover${rt}`,Dg=`mouseout${rt}`,Lg=`focusin${rt}`,Ng=`focusout${rt}`,Ig=`hide${rt}`,jg=`hidden${rt}`,Pg=`show${rt}`,Rg=`shown${rt}`,Wg="fade",uo="hide",es="show",ts="showing",Bg={animation:"boolean",autohide:"boolean",delay:"number"},Fg={animation:!0,autohide:!0,delay:5e3};class hs extends He{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Fg}static get DefaultType(){return Bg}static get NAME(){return Ag}show(){if(J.trigger(this._element,Pg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Wg);const t=()=>{this._element.classList.remove(ts),J.trigger(this._element,Rg),this._maybeScheduleHide()};this._element.classList.remove(uo),Ut(this._element),this._element.classList.add(es,ts),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||J.trigger(this._element,Ig).defaultPrevented)return;const t=()=>{this._element.classList.add(uo),this._element.classList.remove(ts,es),J.trigger(this._element,jg)};this._element.classList.add(ts),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(es),super.dispose()}isShown(){return this._element.classList.contains(es)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){J.on(this._element,Og,e=>this._onInteraction(e,!0)),J.on(this._element,Dg,e=>this._onInteraction(e,!1)),J.on(this._element,Lg,e=>this._onInteraction(e,!0)),J.on(this._element,Ng,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=hs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(hs);We(hs);const Hg={class:"message-content-column"},Vg=["id"],Ug={class:"accordion-item"},qg=["id"],zg=["aria-controls"],Kg={class:"d-flex align-items-center w-100"},Gg={class:"badge bg-warning text-dark ms-auto me-2"},Yg={class:"text-muted"},Jg=["id","aria-labelledby"],Qg={class:"accordion-body bg-light"},Xg={class:"alert alert-warning mb-3",role:"alert"},Zg={class:"compaction-metadata"},eb={class:"metadata-row"},tb={class:"metadata-row"},sb={key:0,class:"metadata-row"},nb={class:"continuation-content"},ob={class:"continuation-text border rounded p-3 bg-white"},ib={class:"mb-0"},ab={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=h(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=h(()=>`heading-${t.value}`),i=h(()=>`collapse-${t.value}`),r=R(null);let l=null;ke(()=>{r.value&&(l=new Mt(r.value,{toggle:!1}))}),Si(()=>{l&&l.dispose()});function m(){l&&l.toggle()}const p=h(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=h(()=>p.value?e.messages[3]:e.messages[2]),u=h(()=>f.value?.metadata?.init_data?.compact_metadata||{}),w=h(()=>u.value.pre_tokens||0),g=h(()=>p.value?e.messages[4]:e.messages[3]),k=h(()=>g.value?.content||""),$=h(()=>{const d=e.messages[0]?.timestamp;return d?Ht(d):""});function b(d){return d?`${d.toLocaleString()} tokens`:"0 tokens"}return(d,v)=>(a(),c("div",{class:"message-row message-row-compaction",key:t.value},[v[7]||(v[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Hg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Ug,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:m},[s("div",Kg,[v[0]||(v[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),v[1]||(v[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",Gg,y(b(w.value)),1),s("small",Yg,y($.value),1)])],8,zg)],8,qg),s("div",{ref_key:"collapseElement",ref:r,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Qg,[s("div",Xg,[v[5]||(v[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),re(" Compaction Details ")],-1)),s("div",Zg,[s("div",eb,[v[2]||(v[2]=s("strong",null,"Trigger:",-1)),s("span",null,y(u.value.trigger||"auto"),1)]),s("div",tb,[v[3]||(v[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,y(b(w.value)),1)]),u.value.post_tokens?(a(),c("div",sb,[v[4]||(v[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,y(b(u.value.post_tokens)),1)])):x("",!0)])]),s("div",nb,[v[6]||(v[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),re(" Continuation Message ")],-1)),s("div",ob,[s("pre",ib,y(k.value),1)])])])],8,Jg)])],8,Vg)])]))}},rb=ie(ab,[["__scopeId","data-v-e0b95ba8"]]),lb={key:0,class:"text-muted text-center py-5"},cb={__name:"MessageList",setup(n){const e=Oe(),t=be(),o=R(null),i=h(()=>{const u=e.currentMessages,w=[];let g=0;for(;g<u.length;){const k=u[g];if(l(k,u,g)){const $=u[g+2],d=$?.type==="system"&&$?.metadata?.subtype==="init"?5:4,v=u.slice(g,g+d);w.push({type:"compaction",messages:v}),g+=d;continue}p(k)&&w.push({type:"message",message:k,attachedTools:[]}),g++}return r(w)});function r(u){const w=new Map,g=new Set;for(let $=0;$<u.length;$++){const b=u[$];if(b.type==="compaction")continue;const d=b.message,v=d.content&&d.content.trim().length>0&&d.content!=="Assistant response",_=d.type==="assistant"&&d.metadata?.has_tool_uses&&d.metadata?.tool_uses?.length>0;if(d.type==="assistant"&&_&&!v){let T=-1,E=!1;for(let B=$-1;B>=0;B--){const P=u[B];if(!g.has(B)){if(P.type==="message"&&P.message.type!=="assistant"){E=!0;break}if(P.type==="message"&&P.message.type==="assistant"){const A=P.message;if(A.content&&A.content.trim().length>0&&A.content!=="Assistant response"){T=B;break}else{T=B;break}}}}E&&T===-1||(E&&T>=0?(w.has(T)||w.set(T,[]),w.get(T).push(...d.metadata.tool_uses),g.add($)):!E&&T>=0&&(w.has(T)||w.set(T,[]),w.get(T).push(...d.metadata.tool_uses),g.add($)))}}const k=[];for(let $=0;$<u.length;$++){if(g.has($))continue;const b=u[$];w.has($)&&(b.attachedTools=[...b.attachedTools||[],...w.get($)]),k.push(b)}return k}function l(u,w,g){if(g+3>=w.length)return!1;const k=w[g],$=w[g+1];let b=w[g+2],d=w[g+3],v=w[g+4];const _=k.type==="system"&&k.metadata?.subtype==="status"&&k.metadata?.init_data?.status==="compacting",T=$.type==="system"&&$.metadata?.subtype==="status"&&($.metadata?.init_data?.status===null||$.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(g+4>=w.length)return!1;const B=!0,P=d?.type==="system"&&d?.metadata?.subtype==="compact_boundary",A=v?.type==="user"&&v?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",T),console.log("  Msg3 (init):",B),console.log("  Msg4 (boundary):",P),console.log("  Msg5 (continuation):",A)),_&&T&&B&&P&&A}else{const B=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",P=d?.type==="user"&&d?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",T),console.log("  Msg3 (boundary):",B),console.log("  Msg4 (continuation):",P)),_&&T&&B&&P}}async function m(){t.autoScrollEnabled&&(await kt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ve(()=>i.value.length,m),ve(()=>e.currentToolCalls.length,m),ve(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),m),ke(()=>{setTimeout(()=>{m()},100)});function p(u){const w=u.subtype||u.metadata?.subtype;if(u.type==="system"&&w==="init"||u.type==="system"&&w==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const g=u.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const g=u.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function f(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,w)=>(a(),c("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),c("div",lb," No messages yet. Start a conversation! ")):x("",!0),(a(!0),c(le,null,ue(i.value,(g,k)=>(a(),c(le,{key:`item-${k}`},[g.type==="message"?(a(),$e(Up,{key:0,message:f(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(a(),$e(rb,{key:1,messages:g.messages},null,8,["messages"])):x("",!0)],64))),128))],512))}},ub=ie(cb,[["__scopeId","data-v-bb936559"]]),db={key:0,class:"attachment-list"},mb={key:0,class:"attachment-preview"},pb=["src","alt"],fb={key:1,class:"attachment-icon"},vb={class:"file-type-icon"},hb={class:"attachment-info"},_b=["title"],gb={class:"attachment-size"},bb=["onClick"],yb={key:2,class:"upload-progress"},wb=["title"],$b={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const t=e;function o(p){if(p.type&&p.type.startsWith("image/"))return!0;const f=p.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function i(p){const f=p.name?.split(".").pop()?.toLowerCase()||"",u=p.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function r(p){return p?p<1024?p+" B":p<1024*1024?(p/1024).toFixed(1)+" KB":(p/(1024*1024)).toFixed(1)+" MB":""}function l(p,f=20){if(!p||p.length<=f)return p;const u=p.split(".").pop(),w=p.substring(0,p.length-u.length-1);return w.length<=f-u.length-4?p:w.substring(0,f-u.length-4)+"..."+u}function m(p){t("remove",p)}return(p,f)=>n.attachments.length>0?(a(),c("div",db,[(a(!0),c(le,null,ue(n.attachments,(u,w)=>(a(),c("div",{key:u.id||w,class:"attachment-item"},[o(u)?(a(),c("div",mb,[s("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,pb)])):(a(),c("div",fb,[s("span",vb,y(i(u)),1)])),s("div",hb,[s("span",{class:"attachment-name",title:u.name},y(l(u.name)),9,_b),s("span",gb,y(r(u.size)),1)]),s("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>m(w)}," âœ• ",8,bb),u.uploading?(a(),c("div",yb,[s("div",{class:"progress-bar",style:Ke({width:(u.progress||0)+"%"})},null,4)])):x("",!0),u.error?(a(),c("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+y(u.error),9,wb)):x("",!0)]))),128))])):x("",!0)}},kb=ie($b,[["__scopeId","data-v-0fcc4974"]]),Sb=["id","aria-selected","onMousedown","onMouseenter"],Eb={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,t=R(null);return ve(()=>e.selectedIndex,o=>{if(!t.value)return;const i=t.value.children[o];i&&i.scrollIntoView({block:"nearest"})}),(o,i)=>n.commands.length>0?(a(),c("ul",{key:0,ref_key:"listRef",ref:t,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(a(!0),c(le,null,ue(n.commands,(r,l)=>(a(),c("li",{id:`slash-cmd-${l}`,key:r,role:"option",class:se(["slash-command-item",{active:l===n.selectedIndex}]),"aria-selected":l===n.selectedIndex,onMousedown:_e(m=>o.$emit("select",r),["prevent"]),onMouseenter:m=>o.$emit("highlight",l)}," /"+y(r),43,Sb))),128))],512)):x("",!0)}},Cb=ie(Eb,[["__scopeId","data-v-97c65547"]]),Tb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},xb=["disabled"],Ab=["placeholder","disabled","aria-expanded","aria-activedescendant"],Mb=["disabled"],Ob=["disabled"],mo=5*1024*1024,Db={__name:"InputArea",setup(n){const e=me(),t=ot(),o=Ze(),i=be(),r=fo("pendingResourceAttachment",R(null)),l=R(null),m=R(null),p=R(window.innerWidth),f=R([]),u=R(!1),w=R(!1),g=R(!1),k=R(""),$=R(0),b=h({get:()=>e.currentInput,set:K=>{e.currentInput=K}}),d=h(()=>e.currentSession?.is_processing||!1),v=h(()=>t.sessionConnected),_=h(()=>e.currentSession?.state==="starting"),T=h(()=>e.currentSessionId),E=h(()=>!!b.value.trim()||f.value.filter(K=>!K.error).length>0),B=h(()=>p.value<768),P=h(()=>_.value?"Session is starting...":v.value?"Type your message to Claude Code...":"Waiting for connection..."),A=h(()=>{const K=T.value;return K?e.initData.get(K)?.slash_commands||[]:[]}),V=h(()=>{const K=k.value.toLowerCase();return A.value.filter(I=>I.toLowerCase().includes(K)).sort((I,N)=>I.localeCompare(N))});function C(){p.value=window.innerWidth}ke(()=>{window.addEventListener("resize",C)}),Te(()=>{window.removeEventListener("resize",C)}),ve(r,K=>{K&&(Z(K),r.value=null)});function S(K){if(g.value&&V.value.length>0){const I=V.value.length;if(K.key==="ArrowDown"){K.preventDefault(),$.value=($.value+1)%I;return}if(K.key==="ArrowUp"){K.preventDefault(),$.value=($.value-1+I)%I;return}if(K.key==="Enter"){K.preventDefault(),z(V.value[$.value]);return}if(K.key==="Tab"){K.preventDefault(),z(V.value[$.value]);return}}if(K.key==="Escape"&&g.value){K.preventDefault(),g.value=!1;return}if(K.key==="Enter"&&!K.shiftKey){if(B.value)return;K.preventDefault(),ee()}}function W(){const K=l.value;if(!K)return;K.style.height="auto";const I=Math.min(K.scrollHeight,parseInt(getComputedStyle(K).maxHeight));K.style.height=I+"px"}ve(b,K=>{K.startsWith("/")&&A.value.length>0?(k.value=K.slice(1),$.value=0,g.value=V.value.length>0):g.value=!1});function z(K){b.value=`/${K} `,g.value=!1,l.value?.focus(),W()}function j(){m.value?.click()}function H(K){const I=Array.from(K.target.files||[]);O(I),K.target.value=""}function G(K){u.value=!1;const I=Array.from(K.dataTransfer?.files||[]);O(I)}function te(K){const I=K.clipboardData?.items;if(!I)return;const N=[];for(const U of I)if(U.type.startsWith("image/")){const Q=U.getAsFile();if(Q){const F=U.type.split("/")[1]||"png",oe=`clipboard-${Date.now()}.${F}`,fe=new File([Q],oe,{type:Q.type});N.push(fe)}}N.length>0&&(K.preventDefault(),O(N))}function O(K){for(const I of K){if(I.size>mo){f.value.push({id:M(),name:I.name,size:I.size,type:I.type,file:I,error:`File too large (max ${mo/(1024*1024)}MB)`});continue}let N=null;I.type.startsWith("image/")&&(N=URL.createObjectURL(I)),f.value.push({id:M(),name:I.name,size:I.size,type:I.type,file:I,preview:N,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function L(K){const I=f.value[K];I.preview&&URL.revokeObjectURL(I.preview),f.value.splice(K,1)}function M(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function D(K){const I=T.value;if(!I)return null;K.uploading=!0,K.progress=0,K.error=null;try{const N=new FormData;N.append("file",K.file);const U=await fetch(`/api/sessions/${I}/files`,{method:"POST",body:N});if(!U.ok){const F=await U.json().catch(()=>({}));throw new Error(F.detail||`Upload failed: ${U.status}`)}const Q=await U.json();return K.uploaded=!0,K.uploadedInfo=Q.file,K.progress=100,Q.file}catch(N){return K.error=N.message,null}finally{K.uploading=!1}}async function Y(){const K=f.value.filter(I=>!I.uploaded&&!I.error);if(K.length===0)return!0;w.value=!0;try{return(await Promise.all(K.map(D))).every(N=>N!==null)}finally{w.value=!1}}async function ee(){const K=b.value.trim(),I=f.value.filter(Q=>!Q.error).length>0;if(!K&&!I||I&&!await Y())return;let N=b.value;const U=f.value.filter(Q=>Q.uploaded&&Q.uploadedInfo).map(Q=>Q.uploadedInfo);if(U.length>0){const Q=U.map(F=>{const oe=(F.size_bytes/1024).toFixed(1);return`- ${F.original_name} (${oe} KB): ${F.stored_path}`}).join(`
`);N.trim()?N=`${N}

---
Attached files (use Read tool to access):
${Q}`:N=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${Q}`}t.sendMessage(N),b.value="",X(),l.value&&(l.value.style.height="auto")}function X(){for(const K of f.value)K.preview&&URL.revokeObjectURL(K.preview);f.value=[]}function Z(K){if(!K||!K.resource_id){console.warn("Invalid resource for attachment:",K);return}const I=T.value;if(!I){console.warn("No current session for resource attachment");return}if(f.value.findIndex(F=>F.resourceId===K.resource_id)>=0){console.log("Resource already attached:",K.resource_id);return}const U=o.isImageResource(K);let Q=null;U&&(Q=o.getResourceUrl(I,K.resource_id)),f.value.push({id:M(),resourceId:K.resource_id,name:K.original_filename||K.title||"Resource",size:K.size_bytes||0,type:K.format||"application/octet-stream",file:null,preview:Q,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:K.resource_id,original_name:K.original_filename||K.title,stored_path:K.file_path||`/api/sessions/${I}/resources/${K.resource_id}`,size_bytes:K.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",K.resource_id)}function ne(){t.interruptSession()}return(K,I)=>(a(),c("div",{class:se(["border-top",ye(i).isRedBackground?"theme-red-panel":"bg-light"])},[v.value?x("",!0):(a(),c("div",Tb,[...I[6]||(I[6]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),he(kb,{attachments:f.value,onRemove:L},null,8,["attachments"]),u.value?(a(),c("div",{key:1,class:"drop-zone-overlay",onDragover:I[0]||(I[0]=_e(()=>{},["prevent"])),onDragleave:I[1]||(I[1]=N=>u.value=!1),onDrop:_e(G,["prevent"])},[...I[7]||(I[7]=[s("div",{class:"drop-zone-content"},[s("span",{class:"drop-icon"},"ðŸ“Ž"),s("span",null,"Drop files here")],-1)])],32)):x("",!0),s("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:I[4]||(I[4]=_e(N=>u.value=!0,["prevent"])),onDragenter:I[5]||(I[5]=_e(N=>u.value=!0,["prevent"]))},[g.value?(a(),$e(Cb,{key:0,commands:V.value,"selected-index":$.value,onSelect:z,onHighlight:I[2]||(I[2]=N=>$.value=N)},null,8,["commands","selected-index"])):x("",!0),s("input",{ref_key:"fileInput",ref:m,type:"file",multiple:"",class:"d-none",onChange:H},null,544),s("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:_.value||!v.value,onClick:j}," ðŸ“Ž ",8,xb),we(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:l,"onUpdate:modelValue":I[3]||(I[3]=N=>b.value=N),class:"form-control",placeholder:P.value,disabled:_.value||!v.value,rows:"1","aria-expanded":g.value||void 0,"aria-activedescendant":g.value?`slash-cmd-${$.value}`:void 0,onInput:W,onKeydown:S,onPaste:te},null,40,Ab),[[Fe,b.value]]),d.value&&!E.value?(a(),c("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:ne}," Stop ")):d.value&&E.value?(a(),c("button",{key:2,class:"btn btn-info",disabled:!v.value||_.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:ee},y(w.value?"Uploading...":"Queue"),9,Mb)):(a(),c("button",{key:3,class:"btn btn-primary",disabled:!E.value||!v.value||_.value||w.value,onClick:ee},y(w.value?"Uploading...":"Send"),9,Ob))],32)],2))}},Lb=ie(Db,[["__scopeId","data-v-5b1f250e"]]),Nb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Ib={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},jb={class:"text-secondary"},Pb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Rb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=me(),o=be(),i=h(()=>t.currentSession),r=h(()=>o.isLoading),l=h(()=>o.loadingMessage);return ke(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ve(()=>e.sessionId,async(m,p)=>{if(m!==p&&m!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(m)}finally{o.hideLoading()}}}),Te(()=>{}),(m,p)=>(a(),c("div",Nb,[r.value?(a(),c("div",Ib,[p[0]||(p[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",jb,y(l.value),1)])):x("",!0),i.value?(a(),$e(qi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):x("",!0),s("div",Pb,[he(ub)]),he(Lb),i.value?(a(),$e(Ji,{key:2,"session-id":e.sessionId},null,8,["session-id"])):x("",!0),i.value?(a(),$e(oa,{key:3,"session-id":e.sessionId},null,8,["session-id"])):x("",!0)]))}},_s=nt("legion",()=>{const n=R(new Map),e=R(new Map),t=R(null),o=h(()=>n.value.get(t.value)||[]),i=h(()=>e.value.get(t.value)||[]);function r($){t.value=$}async function l($,b=100,d=0){try{const v=await pe.get(`/api/legions/${$}/timeline?limit=${b}&offset=${d}`),_=v.comms||[],T=v.total_count||_.length,E=v.has_more||!1;return _.sort((B,P)=>new Date(B.timestamp)-new Date(P.timestamp)),console.log(`Loaded ${_.length} of ${T} comms for legion ${$}`),n.value.set($,_),n.value=new Map(n.value),{comms:_,totalCount:T,hasMore:E}}catch(v){throw console.error("Failed to load timeline:",v),v}}function m($,b){n.value.has($)||n.value.set($,[]);const d=n.value.get($);if(d.some(_=>_.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}d.push(b),n.value=new Map(n.value)}async function p($,b){try{const v=(await pe.post(`/api/legions/${$}/comms`,b)).comm;return console.log(`Sent comm ${v.comm_id} to legion ${$}`),v}catch(d){throw console.error("Failed to send comm:",d),d}}async function f($){return console.log(`Minions for legion ${$} are already available in session store`),[]}async function u($,b){try{const v=(await pe.post(`/api/legions/${$}/minions`,b)).minion;return await f($),console.log(`Created minion ${v.minion_id} in legion ${$}`),v}catch(d){throw console.error("Failed to create minion:",d),d}}async function w($){try{const b=await pe.post(`/api/legions/${$}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${$}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function g($){try{const b=await pe.post(`/api/legions/${$}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${$}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function k($){n.value.delete($),e.value.delete($),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:r,loadTimeline:l,addComm:m,sendComm:p,loadMinions:f,createMinion:u,haltAll:w,resumeAll:g,clearLegionData:k}}),Wb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:_s},Symbol.toStringTag,{value:"Module"})),Bb={class:"timeline-header border-bottom p-3"},Fb={class:"project-name"},Hb=["title"],Vb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Re(),o=h(()=>t.projects.get(e.legionId)),i=h(()=>o.value?.name||"Legion");return(r,l)=>(a(),c("div",Bb,[s("div",null,[s("div",Fb,y(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Hb)])]))}},Ub=ie(Vb,[["__scopeId","data-v-44f386f5"]]),qb={class:"timeline-status-bar border-top p-2 bg-light"},zb={class:"d-flex justify-content-end"},Kb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=be();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),c("div",qb,[s("div",zb,[s("button",{class:se(["btn btn-sm",ye(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+y(ye(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Gb=ie(Kb,[["__scopeId","data-v-891c73db"]]),Yb={class:"comm-composer border-top p-3"},Jb={key:0,class:"d-flex gap-2 mb-2"},Qb={class:"flex-grow-1"},Xb=["disabled"],Zb={label:"Minions"},ey=["value"],ty={style:{"min-width":"150px"}},sy=["disabled"],ny={class:"d-flex gap-2 align-items-end position-relative"},oy={class:"flex-grow-1 position-relative"},iy=["disabled"],ay=["onClick","onMouseenter"],ry=["disabled"],ly={key:0},cy={key:1},uy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=_s(),o=me(),i=Re(),r=R(""),l=R("task"),m=R(""),p=R(!1),f=R(window.innerWidth),u=R(!1),w=R([]),g=R(0),k=R(-1),$=R(null),b=R(null),d=h(()=>f.value<768),v=h(()=>{const z=i.projects.get(e.legionId);return!z||!z.session_ids?[]:z.session_ids.map(j=>o.sessions.get(j)).filter(j=>j)}),_=h(()=>r.value&&m.value.trim().length>0);function T(z){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[z.state]||"â—‹"}function E(z){return z.role?`${z.name} (${z.role})`:z.name}function B(){const z=$.value;if(!z)return;z.style.height="auto";const j=Math.min(z.scrollHeight,parseInt(getComputedStyle(z).maxHeight));z.style.height=j+"px"}function P(){const z=$.value;if(!z)return;B();const j=m.value,H=z.selectionStart,G=j.substring(0,H),te=G.lastIndexOf("#");if(te===-1){u.value=!1;return}const O=G.substring(te+1).toLowerCase();if(O.includes(" ")){u.value=!1;return}const L=v.value.filter(M=>M.name.toLowerCase().includes(O)).map(M=>({type:"minion",name:M.name,role:M.role,id:M.session_id,state:M.state}));if(L.length===0){u.value=!1;return}w.value=L,g.value=0,k.value=te,u.value=!0}function A(){if(!b.value)return;const z=b.value,j=z.children[g.value];if(!j)return;const H=j.offsetTop,G=j.offsetHeight,te=z.scrollTop,O=z.clientHeight;H<te?z.scrollTop=H:H+G>te+O&&(z.scrollTop=H+G-O)}function V(z){if(!u.value){if(z.key==="Enter"&&!z.shiftKey){if(d.value)return;_.value&&(z.preventDefault(),S())}return}if(z.key==="ArrowDown")z.preventDefault(),g.value=(g.value+1)%w.value.length,A();else if(z.key==="ArrowUp")z.preventDefault(),g.value=g.value===0?w.value.length-1:g.value-1,A();else if(z.key==="Enter"){z.preventDefault();const j=w.value[g.value];j&&C(j)}else z.key==="Escape"&&(u.value=!1)}function C(z){const j=$.value;if(!j)return;const H=m.value,G=j.selectionStart,te=H.substring(0,k.value)+"#"+z.name+" "+H.substring(G);m.value=te;const O=k.value+z.name.length+2;setTimeout(()=>{j.setSelectionRange(O,O),j.focus()},0),u.value=!1}async function S(){if(!(!_.value||p.value)){p.value=!0;try{const[z,j]=r.value.split(":"),H={comm_type:l.value,content:m.value.trim()};z==="minion"&&(H.to_minion_id=j),await t.sendComm(e.legionId,H),m.value="",B()}catch(z){console.error("Failed to send comm:",z),alert(`Failed to send comm: ${z.message}`)}finally{p.value=!1}}}function W(){f.value=window.innerWidth}return ke(()=>{window.addEventListener("resize",W)}),Te(()=>{window.removeEventListener("resize",W)}),ve(u,z=>{if(z){const j=H=>{H.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",j))};setTimeout(()=>document.addEventListener("click",j),0)}}),(z,j)=>(a(),c("div",Yb,[n.hideRecipientSelector?x("",!0):(a(),c("div",Jb,[s("div",Qb,[we(s("select",{"onUpdate:modelValue":j[0]||(j[0]=H=>r.value=H),class:"form-select form-select-sm",disabled:p.value},[j[3]||(j[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Zb,[(a(!0),c(le,null,ue(v.value,H=>(a(),c("option",{key:H.session_id,value:`minion:${H.session_id}`},y(T(H))+" "+y(E(H)),9,ey))),128))])],8,Xb),[[_n,r.value]])]),s("div",ty,[we(s("select",{"onUpdate:modelValue":j[1]||(j[1]=H=>l.value=H),class:"form-select form-select-sm",disabled:p.value},[...j[4]||(j[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,sy),[[_n,l.value]])])])),s("div",ny,[s("div",oy,[we(s("textarea",{ref_key:"contentTextarea",ref:$,"onUpdate:modelValue":j[2]||(j[2]=H=>m.value=H),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:P,onKeydown:V},null,40,iy),[[Fe,m.value]]),u.value?(a(),c("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),c(le,null,ue(w.value,(H,G)=>(a(),c("div",{key:H.id,class:se(["autocomplete-item px-2 py-1",{"bg-light":G===g.value}]),onClick:te=>C(H),onMouseenter:te=>g.value=G},y(H.type==="minion"?T(H):"#ï¸âƒ£")+" "+y(H.name)+y(H.role?` (${H.role})`:""),43,ay))),128))],512)):x("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!_.value||p.value,onClick:S},[p.value?(a(),c("span",ly,[...j[5]||(j[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),re(" Sending... ",-1)])])):(a(),c("span",cy,"Send"))],8,ry)])])]))}},dy=ie(uy,[["__scopeId","data-v-e52b8e8f"]]),my={class:"message-content-column-full"},py=["aria-expanded"],fy={class:"comm-sender-recipient"},vy={class:"comm-badge-summary"},hy=["title"],_y={class:"comm-summary-text text-muted ms-2"},gy=["aria-label"],by={key:0,class:"comm-content-body"},yy=["innerHTML"],wy="ffffffff-ffff-ffff-ffff-ffffffffffff",$y={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=R(!1);function o(){t.value=!t.value}const i=h(()=>e.comm.from_minion_id===wy),r=h(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),l=h(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),m=h(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),p=h(()=>{const f=e.comm.content||"";let u=dt.parse(f);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),cs.sanitize(u)});return(f,u)=>(a(),c("div",{class:se(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",my,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",fy,[s("strong",{class:se({"system-sender":i.value})},y(n.senderName),3),n.recipientName?(a(),c(le,{key:0},[u[0]||(u[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,y(n.recipientName),1)],64)):x("",!0)]),s("div",vy,[s("span",{class:se(["badge",l.value]),title:r.value},y(n.comm.comm_type),11,hy),s("span",_y,y(m.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,gy)],8,py),t.value?(a(),c("div",by,[s("div",{class:"message-text",innerHTML:p.value},null,8,yy)])):x("",!0)])],2))}},ky=ie($y,[["__scopeId","data-v-28513f64"]]),Sy={class:"timeline-view d-flex flex-column h-100"},Ey={key:0,class:"text-center text-muted"},Cy={key:1,class:"text-center text-danger"},Ty={key:2,class:"text-center text-muted"},xy={key:3,class:"comm-list"},Ay={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=_s();Re();const o=me(),i=ot(),r=be(),l=R(!0),m=R(null),p=R(null),f=h(()=>t.currentComms);function u(d){return d.from_user?"You":d.from_minion_id?d.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(d.from_minion_id)?.name||"Unknown":"Unknown"}function w(d){return d.to_user?"You":d.to_minion_id?o.sessions.get(d.to_minion_id)?.name||"Unknown":"All"}async function g(){r.autoScrollEnabled&&(await kt(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function k(){l.value=!0,m.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await kt(),await g(),setTimeout(()=>{g()},100)}catch(d){console.error("Failed to load timeline:",d),d.response?m.value=`${d.message} (${d.response.status})`:m.value=d.message||"Unknown error"}finally{l.value=!1}}function $(){i.connectLegion(e.legionId)}function b(){i.disconnectLegion()}return ve(()=>f.value.length,()=>{g()}),ke(()=>{o.currentSessionId=null,k(),$(),setTimeout(()=>{g()},100)}),Te(()=>{b()}),(d,v)=>(a(),c("div",Sy,[he(Ub,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[l.value?(a(),c("div",Ey,[...v[0]||(v[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),re(" Loading timeline... ",-1)])])):m.value?(a(),c("div",Cy," Failed to load timeline: "+y(m.value),1)):f.value.length===0?(a(),c("div",Ty," No messages yet. Minions will appear here once they start communicating. ")):(a(),c("div",xy,[(a(!0),c(le,null,ue(f.value,_=>(a(),$e(ky,{key:_.comm_id,comm:_,"sender-name":u(_),"recipient-name":w(_)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),he(dy,{"legion-id":n.legionId},null,8,["legion-id"]),he(Gb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},My=ie(Ay,[["__scopeId","data-v-b6752179"]]),Oy={class:"minion-info flex-grow-1"},Dy={class:"minion-name"},Ly={key:0,class:"me-1"},Ny={key:1,class:"badge bg-secondary ms-2"},Iy={key:0,class:"latest-activity text-muted"},jy={key:0,class:"activity-prefix"},Py=["title"],Ry={key:1,class:"activity-time ms-1"},Wy={key:1,class:"latest-activity text-muted"},By={class:"activity-prefix"},Fy=["title"],Hy={key:2,class:"latest-activity text-muted fst-italic small"},Vy={class:"node-row"},Uy={class:"node-left"},qy={key:0,class:"me-2"},zy={key:1,class:"badge bg-secondary ms-2"},Ky={class:"node-right"},Gy={key:0,class:"latest-message-preview"},Yy={key:0,class:"message-prefix"},Jy=["title"],Qy={key:1,class:"message-time ms-1"},Xy={key:1,class:"last-comm-preview"},Zy={class:"comm-direction"},e1=["title"],t1={key:2,class:"text-muted fst-italic small"},s1={class:"node-actions"},n1={key:2,class:"minion-children"},o1={key:1,class:"text-danger small ms-4"},i1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=me(),r=Oe(),l=be(),m=h(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),p=h(()=>{if(!t.minionData||!t.minionData.id)return null;const C=r.messagesBySession.get(t.minionData.id);if(!C||C.length===0)return null;for(let S=C.length-1;S>=0;S--){const W=C[S],z=W.subtype||W.metadata?.subtype;if(W.type!=="result"&&!(W.type==="system"&&z==="init")&&!(W.type==="system"&&z==="task_notification")&&!(W.type==="permission_request"||W.type==="permission_response")){if(W.type==="user"&&W.metadata?.has_tool_results){const j=W.content||"";if(j.match(/^Tool results?: \d+ results?$/i)||j.trim()==="")continue}if(W.type==="user"){const j=W.content||"";if(j.includes("<command-message>")&&j.includes("skill is running")||j.startsWith("Base directory for this skill:"))continue}if(W.type==="user"){const j=W.content||"";if(j.includes("<command-message>")&&j.includes("<command-name>")&&j.includes("<command-args>")||j.includes("ARGUMENTS:")&&(j.includes("<command-name>")||j.match(/\nARGUMENTS:/)))continue}if(!(W.type==="system"&&W.content==="System message")&&!(W.type==="assistant"&&W.content==="Assistant response")&&(W.type==="user"||W.type==="assistant"||W.type==="system"))return{content:W.content,type:W.type,timestamp:W.timestamp}}}return null}),f=h(()=>{if(!t.minionData)return null;const C={...t.minionData};return m.value&&(C.state=m.value.state,C.is_processing=m.value.is_processing,m.value.name&&(C.name=m.value.name),m.value.latest_message&&(C.latest_message=m.value.latest_message,C.latest_message_type=m.value.latest_message_type,C.latest_message_time=m.value.latest_message_time)),p.value&&(C.latest_message=p.value.content,C.latest_message_type=p.value.type,C.latest_message_time=p.value.timestamp),C}),u=h(()=>t.level*24),w=h(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),g=h(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),k=h(()=>t.minionData&&t.minionData.is_overseer&&g.value),$=h(()=>{const C=f.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),b=h(()=>{const C=$.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),d=h(()=>{const C=$.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),v=h(()=>{const C=f.value;if(!C||!C.latest_message_type)return"";const S=C.latest_message_type;return S==="user"?"User -->:":S==="system"?"System:":""}),_=h(()=>{const C=f.value;if(!C||!C.latest_message)return"";const S=C.latest_message,W=150;return S.length>W?S.slice(0,W)+"...":S}),T=h(()=>{const C=f.value;if(!C||!C.latest_message_time)return"";try{const S=Date.now();let W;if(typeof C.latest_message_time=="number"?W=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:W=new Date(C.latest_message_time).getTime(),isNaN(W)||W<9466848e5||W>S+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",W),"";const z=S-W;if(z<0)return"just now";const j=Math.floor(z/6e4),H=Math.floor(j/60),G=Math.floor(H/24);return G>0?`${G}d ago`:H>0?`${H}h ago`:j>0?`${j}m ago`:"just now"}catch(S){return console.error("Error calculating relative time:",S,C.latest_message_time),""}});function E(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function B(C){const S=C.summary||C.content||"";return S.length>150?S.substring(0,150)+"...":S}function P(){o("minion-click",t.minionData.id)}function A(){const C=i.sessions.get(t.minionData.id);C&&l.showModal("edit-session",{session:C})}function V(){const C=i.sessions.get(t.minionData.id);C&&l.showModal("manage-session",{session:C})}return(C,S)=>{const W=vo("MinionTreeNode",!0);return n.minionData?(a(),c("div",{key:0,class:"minion-tree-node",style:Ke({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),c("div",{key:0,class:se(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:P},[s("div",{class:se(["status-dot me-2",b.value]),style:Ke(d.value)},null,6),s("div",Oy,[s("div",Dy,[k.value?(a(),c("span",Ly,"ðŸ‘‘")):x("",!0),s("strong",null,y(f.value?.name||n.minionData.name),1),k.value?(a(),c("span",Ny,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):x("",!0)]),f.value?.latest_message?(a(),c("div",Iy,[v.value?(a(),c("span",jy,y(v.value),1)):x("",!0),s("span",{class:"activity-content",title:f.value.latest_message},y(_.value),9,Py),T.value?(a(),c("span",Ry,"("+y(T.value)+")",1)):x("",!0)])):n.minionData?.last_comm?(a(),c("div",Wy,[s("span",By,[S[1]||(S[1]=re("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),S[2]||(S[2]=re(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(B(n.minionData.last_comm)),9,Fy)])):(a(),c("div",Hy," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(A,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(V,["stop"])}," âš™ï¸ ")],2)):(a(),c("div",{key:1,class:se(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:P},[s("div",Vy,[s("div",Uy,[s("div",{class:se(["status-dot me-2",b.value]),style:Ke(d.value)},null,6),k.value?(a(),c("span",qy,"ðŸ‘‘")):x("",!0),s("strong",null,y(f.value?.name||n.minionData.name),1),k.value?(a(),c("span",zy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):x("",!0)]),s("div",Ky,[f.value?.latest_message?(a(),c("div",Gy,[v.value?(a(),c("span",Yy,y(v.value),1)):x("",!0),s("span",{class:"message-content",title:f.value.latest_message},y(_.value),9,Jy),T.value?(a(),c("span",Qy,"("+y(T.value)+")",1)):x("",!0)])):n.minionData?.last_comm?(a(),c("div",Xy,[s("span",Zy,[S[3]||(S[3]=re("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),S[4]||(S[4]=re(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(B(n.minionData.last_comm)),9,e1)])):(a(),c("div",t1," No activity yet "))]),s("div",s1,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(A,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(V,["stop"])}," âš™ï¸ ")])])],2)),g.value?(a(),c("div",n1,[(a(!0),c(le,null,ue(n.minionData.children,z=>(a(),$e(W,{key:z.id,"minion-data":z,level:n.level+1,layout:n.layout,onMinionClick:S[0]||(S[0]=j=>C.$emit("minion-click",j))},null,8,["minion-data","level","layout"]))),128))])):x("",!0)],4)):(a(),c("div",o1," âš  Minion data is missing "))}}},ki=ie(i1,[["__scopeId","data-v-64b23e0e"]]),a1={class:"project-overview d-flex flex-column h-100"},r1={class:"project-overview-header border-bottom p-3"},l1={class:"d-flex align-items-center justify-content-between"},c1={class:"mb-1"},u1={key:0,class:"me-2"},d1={class:"text-muted font-monospace"},m1={class:"d-flex gap-2"},p1=["title"],f1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},v1={key:0,class:"text-center py-5"},h1={key:1,class:"alert alert-danger"},_1={key:2,class:"text-center py-5"},g1={key:3},b1={class:"row g-3 mb-4"},y1={class:"col-md-4"},w1={class:"card h-100"},$1={class:"card-body"},k1={class:"card-title mb-0"},S1={class:"text-muted"},E1={class:"col-md-4"},C1={class:"card h-100"},T1={class:"card-body"},x1={class:"card-title mb-0"},A1={class:"text-muted"},M1={key:0,class:"card mb-4"},O1={class:"card mb-4"},D1={class:"card-header d-flex align-items-center justify-content-between"},L1={class:"mb-0"},N1={class:"badge bg-secondary"},I1={class:"card-body"},j1={key:0,class:"text-center py-4"},P1={key:1,class:"text-center text-muted py-4"},R1={key:2,class:"hierarchy-tree"},W1={class:"user-root-node mb-3 border rounded bg-white"},B1={class:"node-row"},F1={class:"node-left"},H1={class:"badge bg-primary ms-2"},V1={class:"node-right"},U1={key:0,class:"last-comm-preview"},q1={class:"comm-direction"},z1=["title"],K1={key:1,class:"text-muted fst-italic"},G1={class:"root-minions ms-4"},Y1={class:"card"},J1={class:"card-body"},Q1={class:"row mb-0"},X1={class:"col-sm-8 font-monospace text-break"},Z1={class:"col-sm-8 font-monospace text-break"},ew={class:"col-sm-8"},tw={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},sw={class:"text-muted"},nw={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Ft(),o=Re(),i=me(),r=be(),l=_s(),m=ot(),p=R(!1),f=R(null),u=R(null),w=R(!1);let g=null;const k=h(()=>o.getProject(e.projectId)),$=h(()=>k.value?.session_ids?k.value.session_ids.map(H=>i.getSession(H)).filter(H=>H!=null):[]),b=h(()=>$.value.length>0),d=h(()=>$.value.length),v=h(()=>$.value.filter(H=>H.state==="ACTIVE").length),_=h(()=>{const H=$.value.some(O=>O.state==="ACTIVE"),G=$.value.some(O=>O.is_processing);return $.value.some(O=>O.state==="ERROR")?"Error":G?"Working":H?"Active":d.value>0?"Idle":"Empty"}),T=h(()=>{switch(_.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),E=h(()=>{switch(_.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function B(){w.value=!0;try{const H=await pe.get(`/api/legions/${e.projectId}/hierarchy`);u.value=H}catch(H){console.error("Failed to load minion hierarchy:",H),u.value=null}finally{w.value=!1}}function P(H,G){if(H&&H.id===G)return H;if(H&&H.children)for(const te of H.children){const O=P(te,G);if(O)return O}return null}function A(H){return H.to_user?"User":H.to_minion_name?H.to_minion_name:"unknown"}function V(H){const G=H.summary||H.content||"";return G.length>150?G.substring(0,150)+"...":G}function C(H){if(u.value){if(H.from_minion_id){const G=P(u.value,H.from_minion_id);G&&G.type==="minion"&&(G.last_comm=H)}H.from_user&&u.value.type==="user"&&(u.value.last_comm=H)}}function S(H){t.push(`/session/${H}`)}function W(){t.push(`/timeline/${e.projectId}`)}function z(){r.showModal("edit-project",{project:k.value})}function j(){r.showModal("create-minion",{project:k.value})}return ke(()=>{o.selectProject(e.projectId),i.currentSessionId=null,B(),l.setCurrentLegion(e.projectId),m.connectLegion(e.projectId),g=ve(()=>i.sessions,H=>{if(u.value){for(const[G,te]of H)if(te.project_id===e.projectId){const O=P(u.value,G);O&&O.type==="minion"&&(O.state!==te.state&&(O.state=te.state),O.is_processing!==te.is_processing&&(O.is_processing=te.is_processing),O.latest_message!==te.latest_message&&(O.latest_message=te.latest_message,O.latest_message_type=te.latest_message_type,O.latest_message_time=te.latest_message_time))}}},{deep:!0}),ve(()=>l.commsByLegion.get(e.projectId),H=>{if(H&&H.length>0){const G=H[H.length-1];C(G)}},{deep:!0}),ve(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(H,G)=>{H!==G&&B()})}),ve(()=>e.projectId,H=>{o.selectProject(H),i.currentSessionId=null,B(),l.setCurrentLegion(H),m.connectLegion(H)}),Te(()=>{g&&g()}),(H,G)=>(a(),c("div",a1,[s("div",r1,[s("div",l1,[s("div",null,[s("h4",c1,[b.value?(a(),c("span",u1,"ðŸ›")):x("",!0),re(" "+y(k.value?.name||"Project Overview"),1)]),s("small",d1,y(k.value?.working_directory),1)]),s("div",m1,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:z}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:j}," âž• "+y(b.value?"Add Minion":"Add Session"),9,p1)])])]),s("div",f1,[p.value?(a(),c("div",v1,[...G[0]||(G[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(a(),c("div",h1,y(f.value),1)):k.value?(a(),c("div",g1,[s("div",b1,[s("div",y1,[s("div",w1,[s("div",$1,[G[2]||(G[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",k1,y(d.value),1),s("small",S1,y(v.value)+" active",1)])])]),s("div",E1,[s("div",C1,[s("div",T1,[G[3]||(G[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",x1,[s("span",{class:se(T.value)},y(_.value),3)]),s("small",A1,y(E.value),1)])])])]),b.value?(a(),c("div",M1,[G[4]||(G[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:W}," ðŸ“Š View Timeline ")])])])):x("",!0),s("div",O1,[s("div",D1,[s("h5",L1,"ðŸŒ³ "+y(b.value?"Minion Hierarchy":"Sessions"),1),s("span",N1,y($.value.length),1)]),s("div",I1,[w.value?(a(),c("div",j1,[...G[5]||(G[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),c("div",P1,' No sessions yet. Click "Add Session" to create one. ')):(a(),c("div",R1,[s("div",W1,[s("div",B1,[s("div",F1,[G[6]||(G[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,y(u.value.name),1),s("span",H1,y(u.value.children.length)+" "+y(u.value.children.length===1?"minion":"minions"),1)]),s("div",V1,[u.value.last_comm?(a(),c("div",U1,[s("span",q1,[G[7]||(G[7]=re(" â†’ ",-1)),s("strong",null,y(A(u.value.last_comm)),1),G[8]||(G[8]=re(": ",-1))]),s("span",{class:"comm-content",title:u.value.last_comm.content||""},y(V(u.value.last_comm)),9,z1)])):(a(),c("div",K1," No communications yet "))])])]),s("div",G1,[(a(!0),c(le,null,ue(u.value.children,te=>(a(),$e(ki,{key:te.id,"minion-data":te,level:1,layout:"two-column",onMinionClick:S},null,8,["minion-data"]))),128))])]))])]),s("div",Y1,[G[12]||(G[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",J1,[s("dl",Q1,[G[9]||(G[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",X1,y(k.value.working_directory),1),G[10]||(G[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",Z1,y(k.value.project_id),1),G[11]||(G[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",ew,y(b.value?"Yes (has minions)":"No"),1)])])])])):(a(),c("div",_1,[...G[1]||(G[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",tw,[G[13]||(G[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",sw,y(d.value)+" session"+y(d.value!==1?"s":""),1)])]))}},ow=ie(nw,[["__scopeId","data-v-168bf04c"]]),iw=[{path:"/",name:"home",component:Ii},{path:"/project/:projectId",name:"project",component:ow,props:!0},{path:"/session/:sessionId",name:"session",component:Rb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:My,props:!0}],aw=Ei({history:Ci(),routes:iw}),rw={class:"connection-indicators"},lw=["title"],cw=["title"],uw=["title"],dw={__name:"ConnectionIndicator",setup(n){const e=ot();function t(i){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:m}=r[i];return m>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const r={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},m={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:p,retryCount:f}=m[i];let u="Disconnected";return p?u="Connected":f>0&&(u=`Reconnecting (attempt ${f})`),`${r[i]}
${l[i]}
Status: ${u}`}return(i,r)=>(a(),c("div",rw,[s("div",{class:se(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,lw),s("div",{class:se(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,cw),s("div",{class:se(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,uw)]))}},mw=ie(dw,[["__scopeId","data-v-d35b07c8"]]),pw={class:"d-flex align-items-center gap-2"},fw={__name:"AppHeader",setup(n){const e=be();function t(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(i,r)=>(a(),c("header",{class:se(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",ye(e).isRedBackground?"theme-red-header":"bg-white"])},[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...r[1]||(r[1]=[s("span",null,"â˜°",-1)])]),r[2]||(r[2]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",pw,[s("button",{class:se(["btn btn-sm",ye(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:r[0]||(r[0]=l=>ye(e).toggleBackgroundColor())},[s("span",{class:"color-swatch",style:Ke({backgroundColor:ye(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),he(mw),s("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...r[3]||(r[3]=[s("span",null,"â–¤",-1)])])])],2))}},vw=ie(fw,[["__scopeId","data-v-1c36e730"]]),hw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},_w={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},gw=["title"],bw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=h(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(m){return m.state==="paused"&&m.is_processing?"pending-prompt":m.is_processing?"processing":m.state}function i(m){const p=o(m);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function r(m){const p=o(m);return p==="starting"||p==="processing"||p==="pending-prompt"}function l(m){const p=o(m),f=p.charAt(0).toUpperCase()+p.slice(1),u=m.name||"Unnamed Session",w=m.role?` (${m.role})`:"";return`${u}${w}: ${f}`}return(m,p)=>(a(),c("div",hw,[!n.sessions||n.sessions.length===0?(a(),c("div",_w)):(a(!0),c(le,{key:1},ue(n.sessions,f=>(a(),c("div",{key:f.session_id,class:se(["progress-bar",{"progress-bar-striped progress-bar-animated":r(f)}]),style:Ke({width:t.value,backgroundColor:i(f),cursor:"help"}),title:l(f)},null,14,gw))),128))]))}},yw=ie(bw,[["__scopeId","data-v-391d77c1"]]),ww=["data-project-id"],$w=["id"],kw=["aria-expanded","aria-controls","aria-label","onKeydown"],Sw=["aria-label","onKeydown"],Ew={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Cw={class:"fw-semibold",style:{"flex-shrink":"0"}},Tw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},xw={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Aw=["title"],Mw=["title"],Ow=["id","aria-labelledby"],Dw={class:"accordion-body p-0"},Lw={class:"list-group list-group-flush"},Nw={class:"minion-hierarchy-container"},Iw={key:0,class:"text-center py-2"},jw={key:2,class:"text-muted text-center py-2 small"},Pw={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ft(),o=Re(),i=me(),r=be(),l=R(e.project.is_expanded||!1),m=R(null),p=R(!1);let f=null;const u=h(()=>o.formatPath(e.project.working_directory)),w=h(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(j=>i.getSession(j)).filter(j=>j!=null)),g=h(()=>w.value.length>0),k=h(()=>{const j=t.currentRoute.value;return j.name==="timeline"&&j.params.legionId===e.project.project_id}),$=h(()=>{const j=t.currentRoute.value;return j.name==="project"&&j.params.projectId===e.project.project_id});function b(j){const H=window.bootstrap;if(!H)return;const G=document.getElementById(`collapse-${e.project.project_id}`);if(!G)return;H.Collapse.getOrCreateInstance(G).toggle(),l.value=!l.value}function d(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function v(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function _(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const j=i.currentSessionId;j&&i.getSession(j)&&e.project.session_ids?.includes(j)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function T(){r.showModal("edit-project",{project:e.project})}function E(){r.showModal("create-minion",{project:e.project})}function B(){t.push(`/timeline/${e.project.project_id}`)}async function P(){p.value=!0;try{const j=await pe.get(`/api/legions/${e.project.project_id}/hierarchy`);m.value=j}catch(j){console.error("Failed to load minion hierarchy:",j),m.value=null}finally{p.value=!1}}function A(j){t.push(`/session/${j}`)}function V(j,H){if(j&&j.id===H)return j;if(j&&j.children)for(const G of j.children){const te=V(G,H);if(te)return te}return null}ve(l,j=>{j&&P()}),ke(()=>{f=ve(()=>i.sessions,j=>{if(!(!m.value||!l.value)){for(const[H,G]of j)if(G.project_id===e.project.project_id){const te=V(m.value,H);te&&te.type==="minion"&&(te.state!==G.state&&(te.state=G.state),te.is_processing!==G.is_processing&&(te.is_processing=G.is_processing),te.latest_message!==G.latest_message&&(te.latest_message=G.latest_message,te.latest_message_type=G.latest_message_type,te.latest_message_time=G.latest_message_time))}}},{deep:!0}),ve(()=>i.sessions.size,(j,H)=>{if(l.value&&(j>H&&Array.from(i.sessions.values()).some(O=>O.project_id===e.project.project_id&&(!m.value||!V(m.value,O.session_id)))&&(console.log("New minion detected, reloading hierarchy"),P()),j<H&&m.value)){const G=i.sessions,te=O=>O.type==="minion"&&!G.has(O.id)?!0:O.children?O.children.some(L=>te(L)):!1;te(m.value)&&(console.log("Minion deletion detected, reloading hierarchy"),P())}}),l.value&&P()}),Te(()=>{f&&f()});function C(j){j.dataTransfer.effectAllowed="move",j.dataTransfer.setData("application/project-id",e.project.project_id),j.dataTransfer.setData("text/plain",e.project.project_id),j.target.classList.add("dragging")}function S(j){j.target.classList.remove("dragging")}function W(j){j.preventDefault(),j.dataTransfer.dropEffect="move";const H=j.currentTarget.getBoundingClientRect(),G=H.top+H.height/2;j.clientY<G?(j.currentTarget.classList.add("drop-above"),j.currentTarget.classList.remove("drop-below")):(j.currentTarget.classList.add("drop-below"),j.currentTarget.classList.remove("drop-above"))}function z(j){j.preventDefault(),j.currentTarget.classList.remove("drop-above","drop-below");const H=j.dataTransfer.getData("application/project-id")||j.dataTransfer.getData("text/plain");if(!H||H===e.project.project_id)return;const G=j.currentTarget.getBoundingClientRect(),te=G.top+G.height/2,O=j.clientY<te,L=o.orderedProjects,M=L.findIndex(ne=>ne.project_id===e.project.project_id),D=L.findIndex(ne=>ne.project_id===H);if(M===-1||D===-1)return;const Y=[...L],[ee]=Y.splice(D,1);let X=O?M:M+1;D<M&&X--,Y.splice(X,0,ee);const Z=Y.map(ne=>ne.project_id);o.reorderProjects(Z)}return(j,H)=>(a(),c("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:C,onDragend:S,onDragover:W,onDrop:z},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:se(["accordion-button bg-white p-2 project-header-split",{collapsed:!l.value,"project-selected":$.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":l.value?"Collapse session list":"Expand session list",onClick:_e(b,["stop"]),onKeydown:[ze(_e(b,["prevent"]),["enter"]),ze(_e(b,["prevent"]),["space"])]},[(a(),c("svg",{class:se(["chevron-icon",{expanded:l.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...H[0]||(H[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,kw),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:d,onKeydown:[ze(_e(d,["prevent"]),["enter"]),ze(_e(d,["prevent"]),["space"])]},[s("div",Ew,[s("div",Cw,[g.value?(a(),c("span",Tw,"ðŸ›")):x("",!0),re(" "+y(n.project.name),1)]),s("div",xw,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:_e(T,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:_e(E,["stop"])}," âž• ",8,Aw)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(u.value),9,Mw)],40,Sw)],2)],8,$w),he(yw,{project:n.project,sessions:w.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:se(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:v,onHidden:_},[s("div",Dw,[s("div",Lw,[g.value?(a(),c("div",{key:0,class:se(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:k.value}]),style:{cursor:"pointer"},onClick:B},[...H[1]||(H[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):x("",!0),s("div",Nw,[p.value?(a(),c("div",Iw,[...H[2]||(H[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):m.value&&m.value.children&&m.value.children.length>0?(a(!0),c(le,{key:1},ue(m.value.children,G=>(a(),$e(ki,{key:G.id,"minion-data":G,level:0,layout:"sidebar",onMinionClick:A},null,8,["minion-data"]))),128)):(a(),c("div",jw," No sessions "))])])])],42,Ow)],40,ww))}},Rw=ie(Pw,[["__scopeId","data-v-a15b34e8"]]),Ww={class:"project-list"},Bw={key:0,class:"text-muted text-center py-3"},Fw={__name:"ProjectList",setup(n){const e=Re(),t=h(()=>e.orderedProjects);return(o,i)=>(a(),c("div",Ww,[t.value.length===0?(a(),c("div",Bw,' No projects yet. Click "New" to create one. ')):x("",!0),(a(!0),c(le,null,ue(t.value,r=>(a(),$e(Rw,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},Hw={class:"flex-grow-1 overflow-auto p-3"},Vw={id:"sessions-container"},Uw={__name:"Sidebar",setup(n){const e=be(),t=h(()=>e.sidebarCollapsed),o=h(()=>e.isMobile),i=h(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function r(){e.showModal("create-project")}const l=R(!1);function m(u){l.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",f)}function p(u){l.value&&e.setSidebarWidth(u.clientX)}function f(){l.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f)}return(u,w)=>(a(),c("aside",{id:"sidebar",class:se(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value,"theme-red-panel":ye(e).isRedBackground,"bg-light":!ye(e).isRedBackground}]),style:Ke(i.value)},[s("div",Hw,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),s("div",Vw,[he(Fw)])]),s("div",{class:"sidebar-resize-handle",onMousedown:m},null,32)],6))}},qw=ie(Uw,[["__scopeId","data-v-d26424cf"]]),zw={class:"task-row d-flex align-items-center gap-2"},Kw={key:0,class:"status-icon"},Gw={key:1,class:"status-icon"},Yw=["title"],Jw={key:0,class:"task-details"},Qw={key:0,class:"task-description mb-2"},Xw={class:"description-content"},Zw={key:1,class:"task-owner mb-2"},e$={class:"ms-1"},t$={key:2,class:"task-blocked-by mb-2"},s$={key:3,class:"task-blocks"},n$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=h(()=>e.task.status==="in_progress"),o=h(()=>e.task.status==="completed"?"âœ…":"â³"),i=h(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=h(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(l,m)=>(a(),c("div",{class:se(["task-item",r.value]),onClick:m[0]||(m[0]=p=>l.$emit("toggle"))},[s("div",zw,[t.value?(a(),c("span",Kw,[...m[1]||(m[1]=[s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),c("span",Gw,y(o.value),1)),s("span",{class:"task-text flex-grow-1",title:n.task.subject},y(i.value),9,Yw),(a(),c("svg",{class:se(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...m[2]||(m[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),c("div",Jw,[n.task.description?(a(),c("div",Qw,[m[3]||(m[3]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",Xw,y(n.task.description),1)])):x("",!0),n.task.owner?(a(),c("div",Zw,[m[4]||(m[4]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",e$,y(n.task.owner),1)])):x("",!0),n.task.blockedBy?.length>0?(a(),c("div",t$,[m[5]||(m[5]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),c(le,null,ue(n.task.blockedBy,p=>(a(),c("span",{key:p,class:"badge bg-warning text-dark me-1"}," #"+y(p),1))),128))])):x("",!0),n.task.blocks?.length>0?(a(),c("div",s$,[m[6]||(m[6]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),c(le,null,ue(n.task.blocks,p=>(a(),c("span",{key:p,class:"badge bg-info text-dark me-1"}," #"+y(p),1))),128))])):x("",!0)])):x("",!0)],2))}},o$=ie(n$,[["__scopeId","data-v-0f96ae87"]]),i$={class:"task-list-panel"},a$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},r$={class:"d-flex align-items-center gap-2"},l$={key:0,class:"badge bg-secondary"},c$=["title"],u$={key:0,class:"task-list p-2"},d$={key:0,class:"text-muted text-center py-4"},m$={__name:"TaskListPanel",setup(n){const e=Rt();be();const t=R(new Set),o=R(!1),i=h(()=>e.currentTasks),r=h(()=>e.currentTaskStats);function l(){o.value=!o.value}function m(p){t.value.has(p)?t.value.delete(p):t.value.add(p),t.value=new Set(t.value)}return(p,f)=>(a(),c("div",i$,[s("div",a$,[s("div",r$,[f[0]||(f[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),f[1]||(f[1]=s("h6",{class:"mb-0"},"Tasks",-1)),r.value.total>0?(a(),c("span",l$,y(r.value.completed)+"/"+y(r.value.total),1)):x("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:l,title:o.value?"Expand":"Collapse"},[(a(),c("svg",{class:se(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,c$)]),o.value?x("",!0):(a(),c("div",u$,[i.value.length===0?(a(),c("div",d$,[...f[3]||(f[3]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):x("",!0),he(Ti,{name:"task-list",tag:"div"},{default:ho(()=>[(a(!0),c(le,null,ue(i.value,u=>(a(),$e(o$,{key:u.id,task:u,isExpanded:t.value.has(u.id),onToggle:w=>m(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},p$=ie(m$,[["__scopeId","data-v-c03a807a"]]),f$={class:"resource-gallery-panel"},v$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},h$={class:"d-flex align-items-center gap-2"},_$={key:0,class:"badge bg-secondary"},g$=["title"],b$={key:0,class:"resource-grid-container p-2"},y$={key:0,class:"text-muted text-center py-4"},w$={key:1,class:"resource-grid"},$$=["onClick","title"],k$=["src","alt"],S$=["title","onClick"],E$={class:"file-icon"},C$={class:"file-ext"},T$={class:"resource-info"},x$=["title"],A$={class:"resource-actions"},M$=["onClick"],O$=["href","download"],D$={__name:"ResourceGallery",setup(n){const e=Ze(),t=me(),o=fo("addAttachmentFromResource",null),i=R(!1),r=h(()=>e.currentResources),l=h(()=>e.currentResourceCount);function m(){i.value=!i.value}function p(v){return e.isImageResource(v)}function f(v){return e.getResourceIcon(v)}function u(v){const _=e.getResourceExtension(v);return _?_.toUpperCase().slice(1):""}function w(v){return e.getResourceUrl(t.currentSessionId,v)}function g(v){return e.getDownloadUrl(t.currentSessionId,v)}function k(v){e.openFullView(t.currentSessionId,v)}function $(v,_=18){return v?v.length<=_?v:v.substring(0,_-3)+"...":""}function b(v){v.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function d(v){o?o(v):console.warn("addAttachmentFromResource not provided")}return(v,_)=>(a(),c("div",f$,[s("div",v$,[s("div",h$,[_[1]||(_[1]=s("span",{class:"panel-icon"},"ðŸ“",-1)),_[2]||(_[2]=s("h6",{class:"mb-0"},"Resources",-1)),l.value>0?(a(),c("span",_$,y(l.value),1)):x("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:m,title:i.value?"Expand":"Collapse"},[(a(),c("svg",{class:se(["chevron-icon",{expanded:!i.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[..._[3]||(_[3]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,g$)]),i.value?x("",!0):(a(),c("div",b$,[r.value.length===0?(a(),c("div",y$,[..._[4]||(_[4]=[s("span",{class:"empty-icon"},"ðŸ“‚",-1),s("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),c("div",w$,[(a(!0),c(le,null,ue(r.value,(T,E)=>(a(),c("div",{key:T.resource_id,class:se(["resource-item",{"is-image":p(T)}])},[p(T)?(a(),c("div",{key:0,class:"resource-thumbnail",onClick:B=>k(E),title:T.title||"Click to view"},[s("img",{src:w(T.resource_id),alt:T.title||"Image",loading:"lazy",onError:b},null,40,k$)],8,$$)):(a(),c("div",{key:1,class:"resource-placeholder",title:T.title||T.original_filename||"Click to view",onClick:B=>k(E)},[s("span",E$,y(f(T)),1),s("span",C$,y(u(T)),1)],8,S$)),s("div",T$,[s("div",{class:"resource-title",title:T.title||T.original_filename},y($(T.title||T.original_filename)),9,x$),s("div",A$,[s("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:_e(B=>d(T),["stop"]),title:"Add to message attachments"},[..._[5]||(_[5]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,M$),s("a",{href:g(T.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:T.original_filename||T.title||"download",title:"Download",onClick:_[0]||(_[0]=_e(()=>{},["stop"]))},[..._[6]||(_[6]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),s("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,O$)])])],2))),128))]))]))]))}},L$=ie(D$,[["__scopeId","data-v-5f68c476"]]),N$=["src","alt"],I$={key:1,class:"resource-info"},j$={key:0,class:"resource-title"},P$={key:1,class:"resource-description"},R$={class:"resource-meta"},W$={class:"meta-item"},B$={class:"meta-item"},F$={class:"meta-item"},H$={class:"text-header"},V$={class:"text-header-info"},U$={class:"text-filename"},q$={class:"resource-meta"},z$={key:0,class:"meta-item"},K$={key:1,class:"meta-item"},G$=["title","disabled"],Y$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},J$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Q$={class:"copy-label"},X$={class:"text-body"},Z$={key:0,class:"text-loading"},ek={key:1,class:"text-error"},tk={key:2,class:"text-content"},sk={key:3,class:"text-unavailable"},nk={key:4,class:"position-indicator"},ok={key:5,class:"thumbnail-strip"},ik=["onClick"],ak=["src","alt"],rk={key:1,class:"strip-text-icon"},lk={__name:"ResourceFullView",setup(n){const e=Ze(),t=R(null),o=R(!1);let i=null;const r=h(()=>e.fullViewOpen),l=h(()=>e.currentFullViewResource),m=h(()=>e.currentResourceIndex),p=h(()=>e.fullViewTotalResources),f=h(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),u=h(()=>e.isImageResource(l.value)),w=h(()=>l.value?e.getTextContent(l.value.resource_id):null),g=h(()=>w.value?.content||null),k=h(()=>w.value?.loading||!1),$=h(()=>w.value?.error||null);ve(r,S=>{S?(kt(()=>{t.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),ve([m,r],()=>{if(r.value&&l.value&&!u.value){const S=l.value.resource_id,W=e.getTextContent(S);(!W||W.error)&&e.fetchTextContent(e.fullViewSessionId,S)}},{immediate:!0}),Te(()=>{document.body.style.overflow="",i&&clearTimeout(i)});function b(S){return e.getResourceUrl(e.fullViewSessionId,S)}function d(){e.closeFullView()}function v(){e.nextResource()}function _(){e.prevResource()}function T(S){e.goToResource(S)}function E(S){S.target===S.currentTarget&&d()}function B(S){switch(S.key){case"Escape":d();break;case"ArrowLeft":_();break;case"ArrowRight":v();break;case"Home":T(0);break;case"End":T(p.value-1);break}}async function P(){if(g.value)try{await navigator.clipboard.writeText(g.value),o.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function A(S){return S?S<1024?`${S} B`:S<1024*1024?`${(S/1024).toFixed(1)} KB`:`${(S/(1024*1024)).toFixed(2)} MB`:""}function V(S){return S?new Date(S*1e3).toLocaleString():""}function C(S){S.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(S,W)=>(a(),$e(Ai,{to:"body"},[he(xi,{name:"modal"},{default:ho(()=>[r.value?(a(),c("div",{key:0,class:"resource-full-view-overlay",onClick:E,onKeydown:B,tabindex:"0",ref_key:"overlayRef",ref:t},[s("button",{class:"close-btn",onClick:_e(d,["stop"]),title:"Close (Escape)"},[...W[2]||(W[2]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(a(),c("button",{key:0,class:"nav-btn nav-prev",onClick:_e(_,["stop"]),title:"Previous (Left Arrow)"},[...W[3]||(W[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"15 18 9 12 15 6"})],-1)])])):x("",!0),u.value?(a(),c("div",{key:1,class:"image-container",onClick:W[0]||(W[0]=_e(()=>{},["stop"]))},[l.value?(a(),c("img",{key:0,src:b(l.value.resource_id||l.value.image_id),alt:l.value.title||"Image",class:"full-image",onError:C},null,40,N$)):x("",!0),l.value?(a(),c("div",I$,[l.value.title?(a(),c("h5",j$,y(l.value.title),1)):x("",!0),l.value.description?(a(),c("p",P$,y(l.value.description),1)):x("",!0),s("div",R$,[s("span",W$,y(A(l.value.size_bytes)),1),s("span",B$,y(l.value.format?.toUpperCase()),1),s("span",F$,y(V(l.value.timestamp)),1)])])):x("",!0)])):(a(),c("div",{key:2,class:"text-container",onClick:W[1]||(W[1]=_e(()=>{},["stop"]))},[s("div",H$,[s("div",V$,[s("h5",U$,y(l.value?.title||l.value?.original_filename||"Text Resource"),1),s("div",q$,[l.value?.size_bytes?(a(),c("span",z$,y(A(l.value.size_bytes)),1)):x("",!0),l.value?.format?(a(),c("span",K$,y(l.value.format.toUpperCase()),1)):x("",!0)])]),s("button",{class:"copy-btn",onClick:_e(P,["stop"]),title:o.value?"Copied!":"Copy to clipboard",disabled:!g.value},[o.value?(a(),c("svg",Y$,[...W[4]||(W[4]=[s("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),c("svg",J$,[...W[5]||(W[5]=[s("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),s("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),s("span",Q$,y(o.value?"Copied!":"Copy"),1)],8,G$)]),s("div",X$,[k.value?(a(),c("div",Z$,[...W[6]||(W[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),s("span",null,"Loading content...",-1)])])):$.value?(a(),c("div",ek," Failed to load content: "+y($.value),1)):g.value?(a(),c("pre",tk,y(g.value),1)):(a(),c("div",sk," Preview not available for this file type. "))])])),p.value>1?(a(),c("button",{key:3,class:"nav-btn nav-next",onClick:_e(v,["stop"]),title:"Next (Right Arrow)"},[...W[7]||(W[7]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"9 18 15 12 9 6"})],-1)])])):x("",!0),p.value>1?(a(),c("div",nk,y(m.value+1)+" / "+y(p.value),1)):x("",!0),p.value>1?(a(),c("div",ok,[(a(!0),c(le,null,ue(f.value,(z,j)=>(a(),c("div",{key:z.resource_id||z.image_id,class:se(["strip-thumbnail",{active:j===m.value,"is-text":!ye(e).isImageResource(z)}]),onClick:_e(H=>T(j),["stop"])},[ye(e).isImageResource(z)?(a(),c("img",{key:0,src:b(z.resource_id||z.image_id),alt:z.title||"Thumbnail",loading:"lazy"},null,8,ak)):(a(),c("span",rk,y(ye(e).getResourceIcon(z)),1))],10,ik))),128))])):x("",!0)],544)):x("",!0)]),_:1})]))}},ck=ie(lk,[["__scopeId","data-v-7b13db33"]]),uk={class:"panels-container"},dk={__name:"RightSidebar",setup(n){const e=be(),t=h(()=>e.rightSidebarCollapsed),o=h(()=>e.isMobile),i=h(()=>{if(o.value)return{};const f=`${e.rightSidebarWidth}px`;return{width:f,minWidth:"200px",maxWidth:"30vw","--sidebar-width":f}}),r=R(!1);function l(f){f.preventDefault(),r.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",p)}function m(f){if(r.value){const u=window.innerWidth-f.clientX;e.setRightSidebarWidth(u)}}function p(){r.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",p)}return(f,u)=>(a(),c("aside",{id:"right-sidebar",class:se(["border-start d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,resizing:r.value,"theme-red-panel":ye(e).isRedBackground,"bg-light":!ye(e).isRedBackground}]),style:Ke(i.value)},[s("div",uk,[he(p$),he(L$)]),s("div",{class:"sidebar-resize-handle",onMousedown:l},null,32),he(ck)],6))}},mk=ie(dk,[["__scopeId","data-v-6b00f313"]]),pk={class:"modal-dialog modal-lg"},fk={class:"modal-content"},vk={class:"modal-body"},hk={class:"mb-3"},_k={class:"input-group"},gk=["disabled"],bk={key:0,class:"text-center py-4"},yk={key:1,class:"alert alert-danger",role:"alert"},wk={key:2,class:"folder-list"},$k=["onClick","onDblclick"],kk={class:"d-flex align-items-center flex-grow-1"},Sk=["onClick"],Ek={key:1,class:"text-center text-muted py-3"},Ck={class:"modal-footer"},Tk=["disabled"],xk={__name:"FolderBrowserModal",setup(n){const e=be(),t=R(""),o=R(""),i=R([]),r=R(!1),l=R(""),m=R(null);let p=null,f=null;const u=h(()=>{if(!t.value)return null;const T=t.value.split(/[\\/]/).filter(Boolean);return T.length<=1?null:(T.pop(),T.length>0?"/"+T.join("/"):"/")});function w(T){if(!T)return"";const E=T.split(/[\\/]/).filter(Boolean);return E.length<=2?T:".../"+E.slice(-2).join("/")}async function g(){r.value=!0,l.value="",i.value=[],o.value="";try{const T=t.value?{path:t.value}:{},E=await pe.get("/api/filesystem/browse",{params:T});E.current_path&&(t.value=E.current_path),i.value=E.directories||[]}catch(T){console.error("Failed to load directory:",T),l.value=T.message||"Failed to load directory"}finally{r.value=!1}}function k(T){o.value=T.path}function $(T){t.value=T.path,o.value="",g()}function b(){u.value&&(t.value=u.value,o.value="",g())}function d(){const T=o.value||t.value;T&&f&&f(T),p&&p.hide()}function v(){g()}function _(){i.value=[],o.value="",l.value="",f=null,e.hideModal()}return ve(()=>e.currentModal,T=>{if(T?.name==="folder-browser"&&p){const E=T.data||{};t.value=E.defaultPath||E.currentPath||"",f=E.onSelect||null,p.show()}}),ke(()=>{m.value&&Me(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{p=new T(m.value),m.value.addEventListener("shown.bs.modal",v),m.value.addEventListener("hidden.bs.modal",_)})}),Te(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",v),m.value.removeEventListener("hidden.bs.modal",_)),p&&p.dispose()}),(T,E)=>(a(),c("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[s("div",pk,[s("div",fk,[E[6]||(E[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",vk,[s("div",hk,[E[1]||(E[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",_k,[we(s("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=B=>t.value=B),onKeyup:ze(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Fe,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:g,disabled:r.value}," ðŸ”„ Refresh ",8,gk)])]),r.value?(a(),c("div",bk,[...E[2]||(E[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(a(),c("div",yk,y(l.value),1)):(a(),c("div",wk,[u.value?(a(),c("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...E[3]||(E[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):x("",!0),(a(!0),c(le,null,ue(i.value,B=>(a(),c("div",{key:B.path,class:se(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:B.path===o.value}]),onClick:P=>k(B),onDblclick:P=>$(B),role:"button"},[s("div",kk,[E[4]||(E[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,y(B.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:_e(P=>$(B),["stop"])}," Open ",8,Sk)],42,$k))),128)),i.value.length===0?(a(),c("div",Ek," No subdirectories found ")):x("",!0)]))]),s("div",Ck,[E[5]||(E[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:d,disabled:!o.value},' Select "'+y(w(o.value||t.value))+'" ',9,Tk)])])])],512))}},Ak=ie(xk,[["__scopeId","data-v-0d61ed46"]]),Mk={class:"modal-dialog"},Ok={class:"modal-content"},Dk={class:"modal-body"},Lk={class:"mb-3"},Nk={key:0,class:"invalid-feedback"},Ik={class:"mb-3"},jk={class:"input-group"},Pk={key:0,class:"invalid-feedback"},Rk={class:"mb-3 form-check"},Wk={key:0,class:"mb-3 ms-4"},Bk={key:1,class:"alert alert-danger",role:"alert"},Fk={class:"modal-footer"},Hk=["disabled"],Vk={key:0,class:"spinner-border spinner-border-sm me-2"},Uk={__name:"ProjectCreateModal",setup(n){const e=Re(),t=me(),o=be(),i=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=R({name:"",workingDirectory:""}),l=R(!1),m=R(""),p=R(null);let f=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:d=>{i.value.workingDirectory=d,r.value.workingDirectory=""}})}function w(){r.value={};let d=!0;return i.value.name.trim()||(r.value.name="Project name is required",d=!1),i.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",d=!1),d}async function g(){if(w()){l.value=!0,m.value="";try{const d=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(d.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),k()}catch(d){console.error("Failed to create project:",d),m.value=d.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function k(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},m.value=""}function $(){const d=document.getElementById("projectName");d&&d.focus()}function b(){k(),o.hideModal()}return ve(()=>o.currentModal,d=>{d?.name==="create-project"&&f&&f.show()}),ke(()=>{p.value&&Me(async()=>{const{default:d}=await import("./modal-D6mKceGM.js").then(v=>v.m);return{default:d}},__vite__mapDeps([0,1])).then(({default:d})=>{f=new d(p.value),p.value.addEventListener("shown.bs.modal",$),p.value.addEventListener("hidden.bs.modal",b)})}),Te(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",$),p.value.removeEventListener("hidden.bs.modal",b)),f&&f.dispose()}),(d,v)=>(a(),c("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",Mk,[s("div",Ok,[v[11]||(v[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Dk,[s("form",{onSubmit:_e(g,["prevent"])},[s("div",Lk,[v[4]||(v[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),we(s("input",{type:"text",class:se(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":v[0]||(v[0]=_=>i.value.name=_),placeholder:"My Project",required:""},null,2),[[Fe,i.value.name]]),r.value.name?(a(),c("div",Nk,y(r.value.name),1)):x("",!0)]),s("div",Ik,[v[5]||(v[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",jk,[we(s("input",{type:"text",class:se(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":v[1]||(v[1]=_=>i.value.workingDirectory=_),placeholder:"/path/to/project",required:""},null,2),[[Fe,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),r.value.workingDirectory?(a(),c("div",Pk,y(r.value.workingDirectory),1)):x("",!0)]),v[6]||(v[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",Rk,[we(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":v[2]||(v[2]=_=>i.value.createSession=_)},null,512),[[Mi,i.value.createSession]]),v[7]||(v[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),v[8]||(v[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),c("div",Wk,[v[9]||(v[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),we(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":v[3]||(v[3]=_=>i.value.sessionName=_),placeholder:"main"},null,512),[[Fe,i.value.sessionName]])])):x("",!0),m.value?(a(),c("div",Bk,y(m.value),1)):x("",!0)],32)]),s("div",Fk,[v[10]||(v[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:l.value},[l.value?(a(),c("span",Vk)):x("",!0),re(" "+y(l.value?"Creating...":"Create Project"),1)],8,Hk)])])])],512))}},qk=ie(Uk,[["__scopeId","data-v-ea55fdae"]]),zk={class:"modal-dialog"},Kk={class:"modal-content"},Gk={class:"modal-body"},Yk={class:"mb-3"},Jk={key:0,class:"invalid-feedback"},Qk={class:"mb-3"},Xk=["value"],Zk={key:0,class:"alert alert-danger",role:"alert"},eS={class:"danger-zone"},tS={class:"text-muted small"},sS=["disabled"],nS={key:0,class:"alert alert-warning mt-3",role:"alert"},oS={class:"mb-2"},iS={class:"d-flex gap-2"},aS=["disabled"],rS={key:0,class:"spinner-border spinner-border-sm me-2"},lS=["disabled"],cS={class:"modal-footer"},uS=["disabled"],dS={key:0,class:"spinner-border spinner-border-sm me-2"},mS={__name:"ProjectEditModal",setup(n){const e=Re(),t=be(),o=R(null),i=R({name:""}),r=R({name:""}),l=R(!1),m=R(!1),p=R(""),f=R(!1),u=R(null);let w=null;const g=h(()=>o.value?.session_ids?.length||0);function k(){r.value={};let T=!0;return i.value.name.trim()||(r.value.name="Project name is required",T=!1),T}async function $(){if(!(!k()||!o.value)){l.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),w&&w.hide()}catch(T){console.error("Failed to update project:",T),p.value=T.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function b(){if(o.value){m.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(T){console.error("Failed to delete project:",T),p.value=T.message||"Failed to delete project. Please try again."}finally{m.value=!1}}}function d(){i.value={name:""},r.value={},p.value="",f.value=!1}function v(){const T=document.getElementById("editProjectName");T&&(T.focus(),T.select())}function _(){d(),o.value=null,t.hideModal()}return ve(()=>t.currentModal,T=>{if(T?.name==="edit-project"&&w){const E=T.data||{};o.value=E.project,o.value&&(i.value.name=o.value.name),w.show()}}),ke(()=>{u.value&&Me(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{w=new T(u.value),u.value.addEventListener("shown.bs.modal",v),u.value.addEventListener("hidden.bs.modal",_)})}),Te(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",v),u.value.removeEventListener("hidden.bs.modal",_)),w&&w.dispose()}),(T,E)=>(a(),c("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",zk,[s("div",Kk,[E[10]||(E[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Gk,[s("form",{onSubmit:_e($,["prevent"])},[s("div",Yk,[E[3]||(E[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),we(s("input",{type:"text",class:se(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":E[0]||(E[0]=B=>i.value.name=B),placeholder:"My Project",required:""},null,2),[[Fe,i.value.name]]),r.value.name?(a(),c("div",Jk,y(r.value.name),1)):x("",!0)]),s("div",Qk,[E[4]||(E[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Xk),E[5]||(E[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(a(),c("div",Zk,y(p.value),1)):x("",!0)],32),E[8]||(E[8]=s("hr",null,null,-1)),s("div",eS,[E[6]||(E[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",tS," Deleting this project will also delete all "+y(g.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:E[1]||(E[1]=B=>f.value=!0),disabled:m.value}," ðŸ—‘ï¸ Delete Project ",8,sS)]),f.value?(a(),c("div",nS,[E[7]||(E[7]=s("strong",null,"Are you sure?",-1)),s("p",oS,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(g.value)+" session(s). ",1),s("div",iS,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:m.value},[m.value?(a(),c("span",rS)):x("",!0),re(" "+y(m.value?"Deleting...":"Yes, Delete Permanently"),1)],8,aS),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:E[2]||(E[2]=B=>f.value=!1),disabled:m.value}," Cancel ",8,lS)])])):x("",!0)]),s("div",cS,[E[9]||(E[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:$,disabled:l.value},[l.value?(a(),c("span",dS)):x("",!0),re(" "+y(l.value?"Saving...":"Save Changes"),1)],8,uS)])])])],512))}},pS=ie(mS,[["__scopeId","data-v-52679516"]]),fS={class:"general-tab"},vS={key:0,class:"mb-3"},hS={for:"template-select",class:"form-label"},_S=["value"],gS=["value"],bS={key:0,class:"form-text"},yS={class:"mb-3"},wS={for:"config-name",class:"form-label"},$S=["value","placeholder","pattern","title"],kS={key:0,class:"invalid-feedback"},SS={key:1,class:"form-text"},ES={key:1,class:"mb-3"},CS=["value"],TS={class:"mb-3"},xS=["value"],AS={class:"form-text"},MS={key:0,class:"text-warning"},OS={key:1},DS={class:"mb-3"},LS={for:"config-permission-mode",class:"form-label"},NS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},IS={key:1,class:"field-indicator modified",title:"Modified from template"},jS=["value","disabled"],PS={key:0,value:"bypassPermissions"},RS={class:"form-text"},WS={key:0,class:"text-warning"},BS={key:1},FS={class:"mb-3"},HS={for:"config-role",class:"form-label"},VS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},US={key:1,class:"field-indicator modified",title:"Modified from template"},qS=["value","placeholder"],zS={class:"form-text"},KS={key:2,class:"mb-3"},GS={class:"input-group"},YS=["value","placeholder","disabled","readonly"],JS={class:"form-text"},QS={key:3,class:"mb-3"},XS={class:"form-control-plaintext"},ZS={key:4,class:"mb-3 form-check"},eE=["checked"],tE={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=h(()=>e.mode==="create-session"||e.mode==="edit-session"),o=h(()=>e.mode==="create-template"||e.mode==="edit-template"),i=h(()=>e.mode==="create-session"),r=h(()=>e.mode==="edit-session"),l=h(()=>e.session?.state==="active"||e.session?.state==="starting"),m=h(()=>{if(!e.session)return!1;const b=e.session.model||"sonnet";return e.formData.model!==b}),p=h(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=h(()=>e.selectedTemplateId?e.templates.find(b=>b.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},w=h(()=>u[e.formData.model]||null),g=h(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),k=h(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function $(b){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[b]||"bg-secondary"}return(b,d)=>(a(),c("div",fS,[i.value?(a(),c("div",vS,[s("label",hS,[d[10]||(d[10]=re(" Template ",-1)),s("button",{type:"button",onClick:d[0]||(d[0]=v=>b.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:d[1]||(d[1]=v=>b.$emit("update:selected-template-id",v.target.value||null)),class:"form-select"},[d[11]||(d[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),c(le,null,ue(n.templates,v=>(a(),c("option",{key:v.template_id,value:v.template_id},y(v.name),9,gS))),128))],40,_S),f.value?(a(),c("div",bS,y(f.value.description),1)):x("",!0)])):x("",!0),s("div",yS,[s("label",wS,[re(y(o.value?"Template Name":"Session Name")+" ",1),d[12]||(d[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:se(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:d[2]||(d[2]=v=>b.$emit("update:form-data","name",v.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,$S),n.errors.name?(a(),c("div",kS,y(n.errors.name),1)):x("",!0),t.value?(a(),c("div",SS,"Must be a single word (no spaces) for #nametag matching")):x("",!0)]),o.value?(a(),c("div",ES,[d[13]||(d[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:d[3]||(d[3]=v=>b.$emit("update:form-data","description",v.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,CS)])):x("",!0),s("div",TS,[d[16]||(d[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:d[4]||(d[4]=v=>b.$emit("update:form-data","model",v.target.value))},[...d[14]||(d[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,xS),s("div",AS,[r.value&&l.value&&m.value?(a(),c("span",MS,[...d[15]||(d[15]=[re(" Model change requires a ",-1),s("strong",null,"reset",-1),re(" (not restart) to take effect. ",-1)])])):w.value?(a(),c("span",OS,y(w.value.description),1)):x("",!0)])]),s("div",DS,[s("label",LS,[d[17]||(d[17]=re(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),c("span",NS," < ")):x("",!0),n.fieldStates.permission_mode==="modified"?(a(),c("span",IS," * ")):x("",!0)]),s("select",{id:"config-permission-mode",class:se(["form-select",k.value]),value:n.formData.permission_mode,onChange:d[5]||(d[5]=v=>b.$emit("update:form-data","permission_mode",v.target.value)),disabled:r.value&&!l.value},[d[18]||(d[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),d[19]||(d[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),d[20]||(d[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||p.value?(a(),c("option",PS," Bypass Permissions (No prompts - use with caution) ")):x("",!0)],42,jS),s("div",RS,[r.value&&!l.value?(a(),c("span",WS," Session must be active to change permission mode. Start the session first. ")):(a(),c("span",BS,"Controls which tool actions require permission prompts"))])]),s("div",FS,[s("label",HS,[re(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),c("span",VS," < ")):x("",!0),n.fieldStates.default_role==="modified"?(a(),c("span",US," * ")):x("",!0)]),s("input",{id:"config-role",type:"text",class:se(["form-control",g.value]),value:n.formData.default_role,onInput:d[6]||(d[6]=v=>b.$emit("update:form-data","default_role",v.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,qS),s("div",zS,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(a(),c("div",KS,[d[21]||(d[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",GS,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:d[7]||(d[7]=v=>b.$emit("update:form-data","working_directory",v.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,YS),r.value?x("",!0):(a(),c("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:d[8]||(d[8]=v=>b.$emit("open-folder-browser"))}," Browse "))]),s("div",JS,y(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):x("",!0),r.value&&n.session?(a(),c("div",QS,[d[22]||(d[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",XS,[s("span",{class:se(["badge",$(n.session.state)])},y(n.session.state),3)])])):x("",!0),i.value?(a(),c("div",ZS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:d[9]||(d[9]=v=>b.$emit("update:form-data","startImmediately",v.target.checked))},null,40,eE),d[23]||(d[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):x("",!0)]))}},sE=ie(tE,[["__scopeId","data-v-b9edc342"]]),nE={class:"permissions-tab"},oE={class:"mb-3"},iE={for:"config-allowed-tools",class:"form-label"},aE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},rE={key:1,class:"field-indicator modified",title:"Modified from template"},lE={key:0,class:"tools-list mb-2"},cE=["onClick"],uE={class:"input-group input-group-sm"},dE=["onKeydown"],mE=["disabled"],pE={class:"mt-2"},fE=["onClick"],vE={class:"form-text"},hE={key:0,class:"text-warning"},_E={key:1},gE={class:"mb-3"},bE={class:"capabilities-editor"},yE={key:0,class:"capabilities-list mb-2"},wE=["onClick"],$E={class:"input-group input-group-sm"},kE=["onKeydown"],SE=["disabled"],EE={key:0,class:"mb-3"},CE={class:"settings-sources-editor"},TE={class:"form-check"},xE=["checked"],AE={class:"form-check"},ME=["checked"],OE={class:"form-check"},DE=["checked"],LE={class:"form-text"},NE={key:0,class:"text-warning"},IE={key:1},jE={key:1,class:"mb-3"},PE={class:"mb-3"},RE={key:0,class:"mt-2"},WE=["value"],BE=["value"],FE={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=R(""),r=R(""),l=R(!1),m=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=h(()=>t.mode==="create-template"||t.mode==="edit-template"),f=h(()=>t.mode==="create-session"||t.mode==="edit-session"),u=h(()=>t.mode==="edit-session"),w=h(()=>t.session?.state==="active"||t.session?.state==="starting"),g=h(()=>{if(!t.session)return!1;const C=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==C}),k=h(()=>t.formData.setting_sources||["user","project","local"]),$=h(()=>{if(!t.session)return!1;const C=t.session.setting_sources||["user","project","local"],S=t.formData.setting_sources||["user","project","local"];return JSON.stringify(C.sort())!==JSON.stringify(S.sort())}),b=h(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(C=>C.trim()).filter(C=>C.length>0)),d=h(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(C=>C.trim()).filter(C=>C.length>0)),v=h(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),_=h(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function T(){const C=i.value.trim();if(C){if(!b.value.includes(C)){const S=[...b.value,C];o("update:form-data","allowed_tools",S.join(", "))}i.value=""}}function E(C){const S=[...b.value];S.splice(C,1),o("update:form-data","allowed_tools",S.join(", "))}function B(C){if(b.value.includes(C)){const S=b.value.indexOf(C);E(S)}else{const S=[...b.value,C];o("update:form-data","allowed_tools",S.join(", "))}}function P(){const C=r.value.trim().toLowerCase();if(C){if(!d.value.includes(C)){const S=[...d.value,C];o("update:form-data","capabilities",S.join(", "))}r.value=""}}function A(C){const S=[...d.value];S.splice(C,1),o("update:form-data","capabilities",S.join(", "))}function V(C){const S=[...k.value],W=S.indexOf(C);W>=0?S.splice(W,1):S.push(C),o("update:form-data","setting_sources",S)}return(C,S)=>(a(),c("div",nE,[s("div",oE,[s("label",iE,[S[9]||(S[9]=re(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),c("span",aE," < ")):x("",!0),n.fieldStates.allowed_tools==="modified"?(a(),c("span",rE," * ")):x("",!0)]),s("div",{class:se(["allowed-tools-editor",_.value])},[b.value.length>0?(a(),c("div",lE,[(a(!0),c(le,null,ue(b.value,(W,z)=>(a(),c("span",{key:z,class:"badge bg-primary me-1 mb-1 tool-badge"},[re(y(W)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:j=>E(z),"aria-label":"Remove tool"},null,8,cE)]))),128))])):x("",!0),s("div",uE,[we(s("input",{type:"text",class:"form-control","onUpdate:modelValue":S[0]||(S[0]=W=>i.value=W),onKeydown:ze(_e(T,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,dE),[[Fe,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:T,disabled:!i.value.trim()}," Add ",8,mE)]),s("div",pE,[S[10]||(S[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),c(le,null,ue(m,W=>s("button",{key:W,type:"button",class:se(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":b.value.includes(W)}]),onClick:z=>B(W)},y(W),11,fE)),64))])],2),s("div",vE,[u.value&&w.value&&g.value?(a(),c("span",hE,[...S[11]||(S[11]=[re(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),re(" (not restart) to take effect. ",-1)])])):(a(),c("span",_E,y(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",gE,[S[12]||(S[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",bE,[d.value.length>0?(a(),c("div",yE,[(a(!0),c(le,null,ue(d.value,(W,z)=>(a(),c("span",{key:z,class:"badge bg-info me-1 mb-1 capability-badge"},[re(y(W)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:j=>A(z),"aria-label":"Remove capability"},null,8,wE)]))),128))])):x("",!0),s("div",$E,[we(s("input",{type:"text",class:"form-control","onUpdate:modelValue":S[1]||(S[1]=W=>r.value=W),onKeydown:ze(_e(P,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,kE),[[Fe,r.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:P,disabled:!r.value.trim()}," Add ",8,SE)])]),S[13]||(S[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(a(),c("div",EE,[S[18]||(S[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",CE,[s("div",TE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:k.value.includes("user"),onChange:S[2]||(S[2]=W=>V("user"))},null,40,xE),S[14]||(S[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[re(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",AE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:k.value.includes("project"),onChange:S[3]||(S[3]=W=>V("project"))},null,40,ME),S[15]||(S[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[re(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",OE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:k.value.includes("local"),onChange:S[4]||(S[4]=W=>V("local"))},null,40,DE),S[16]||(S[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[re(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",LE,[u.value&&w.value&&$.value?(a(),c("span",NE,[...S[17]||(S[17]=[re(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),re(" to take effect. ",-1)])])):(a(),c("span",IE," Select which settings files to load permissions from "))])])):x("",!0),f.value?(a(),c("div",jE,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:S[5]||(S[5]=W=>C.$emit("preview-permissions"))}," Preview Effective Permissions ")])):x("",!0),s("div",PE,[s("a",{class:"text-muted small",role:"button",onClick:S[6]||(S[6]=W=>l.value=!l.value)},y(l.value?"Hide":"Show")+" raw input ",1),l.value?(a(),c("div",RE,[S[19]||(S[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:se(["form-control form-control-sm",v.value]),value:n.formData.allowed_tools,onInput:S[7]||(S[7]=W=>C.$emit("update:form-data","allowed_tools",W.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,WE),S[20]||(S[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:S[8]||(S[8]=W=>C.$emit("update:form-data","capabilities",W.target.value)),placeholder:"python, testing, debugging"},null,40,BE)])):x("",!0)])]))}},HE=ie(FE,[["__scopeId","data-v-e58aa2be"]]),VE={class:"advanced-tab"},UE={key:0,class:"alert alert-warning mb-3",role:"alert"},qE={class:"mb-3"},zE={for:"config-system-prompt",class:"form-label"},KE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},GE={key:1,class:"field-indicator modified",title:"Modified from template"},YE=["value","rows","placeholder"],JE={class:"form-text"},QE={class:"mb-3 form-check"},XE=["checked"],ZE={key:0,class:"form-text text-warning"},eC={key:1,class:"mb-3 form-check"},tC=["checked"],sC={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=h(()=>t.mode==="create-session"||t.mode==="edit-session"),r=h(()=>t.mode==="create-template"||t.mode==="edit-template"),l=h(()=>t.mode==="edit-session"),m=h(()=>t.session?.state==="active"||t.session?.state==="starting"),p=h(()=>{if(!t.session)return!1;const $=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),b=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),d=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return $||b||d}),f=h(()=>r.value?t.formData.system_prompt:t.formData.initialization_context),u=h(()=>r.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),w=h(()=>t.formData.override_system_prompt?r.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":r.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),g=h(()=>{const $={};return t.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$});function k($){const b=$.target.value,d=r.value?"system_prompt":"initialization_context";o("update:form-data",d,b)}return($,b)=>(a(),c("div",VE,[l.value&&m.value&&p.value?(a(),c("div",UE,[...b[2]||(b[2]=[s("small",null,[re("Changes to these settings require a "),s("strong",null,"reset"),re(" (not restart) to take effect.")],-1)])])):x("",!0),s("div",qE,[s("label",zE,[re(y(r.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),c("span",KE," < ")):x("",!0),n.fieldStates.initialization_context==="modified"?(a(),c("span",GE," * ")):x("",!0)]),s("textarea",{id:"config-system-prompt",class:se(["form-control",g.value]),value:f.value,onInput:k,rows:r.value?4:5,placeholder:u.value},null,42,YE),s("div",JE,y(w.value),1)]),s("div",QE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:b[0]||(b[0]=d=>$.$emit("update:form-data","override_system_prompt",d.target.checked))},null,40,XE),b[3]||(b[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),c("div",ZE,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(r.value?"":" or legion guide")+").",1)])):x("",!0)]),i.value?(a(),c("div",eC,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:b[1]||(b[1]=d=>$.$emit("update:form-data","sandbox_enabled",d.target.checked))},null,40,tC),b[4]||(b[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:se(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):x("",!0)]))}},nC=ie(sC,[["__scopeId","data-v-08b1f06d"]]),oC={class:"modal-dialog modal-lg"},iC={class:"modal-content"},aC={class:"modal-body"},rC={key:0,class:"text-center py-4"},lC={key:1,class:"alert alert-danger"},cC={key:2},uC={class:"mb-3"},dC={class:"small text-muted mb-2"},mC={key:0},pC={key:0,class:"alert alert-info"},fC={key:1},vC={class:"table table-sm table-striped"},hC={key:2,class:"mt-3"},_C={class:"modal-footer"},gC=["disabled"],bC={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=R(null);let l=null;const m=R(!1),p=R(""),f=R([]);ve(r,b=>{b&&(l=new ft(b),b.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){l&&(l.show(),g())}function w(){l&&l.hide()}async function g(){m.value=!0,p.value="",f.value=[];try{const b=await pe.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),p.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{m.value=!1}}function k(){g()}function $(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:w}),(b,d)=>(a(),c("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",oC,[s("div",iC,[d[7]||(d[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",aC,[m.value?(a(),c("div",rC,[...d[0]||(d[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(a(),c("div",lC,y(p.value),1)):(a(),c("div",cC,[s("div",uC,[d[2]||(d[2]=s("h6",null,"Settings Sources",-1)),s("div",dC,[d[1]||(d[1]=re(" Loading permissions from: ",-1)),(a(!0),c(le,null,ue(n.settingSources,(v,_)=>(a(),c("span",{key:v},[s("code",null,y(v),1),_<n.settingSources.length-1?(a(),c("span",mC,", ")):x("",!0)]))),128))])]),f.value.length===0?(a(),c("div",pC," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),c("div",fC,[s("h6",null,"Pre-approved Permissions ("+y(f.value.length)+")",1),s("table",vC,[d[3]||(d[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(a(!0),c(le,null,ue(f.value,v=>(a(),c("tr",{key:v.permission},[s("td",null,[s("code",null,y(v.permission),1)]),s("td",null,[(a(!0),c(le,null,ue(v.sources,(_,T)=>(a(),c("span",{key:_,class:se(["badge me-1",$(_)])},y(_),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),c("div",hC,[d[4]||(d[4]=s("h6",null,"Session Allowed Tools",-1)),d[5]||(d[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(a(!0),c(le,null,ue(n.sessionAllowedTools,v=>(a(),c("span",{key:v,class:"badge bg-success me-1 mb-1"},y(v),1))),128))])])):x("",!0)]))]),s("div",_C,[d[6]||(d[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:k,disabled:m.value}," Refresh ",8,gC)])])])],512))}},yC=ie(bC,[["__scopeId","data-v-988ff7c4"]]),wC={class:"modal-dialog modal-lg modal-dialog-centered"},$C={class:"modal-content"},kC={class:"modal-header"},SC={id:"configurationModalLabel",class:"modal-title"},EC={class:"modal-body"},CC={key:0,class:"template-list-view"},TC={key:0,class:"alert alert-info"},xC={class:"card-body"},AC={class:"d-flex justify-content-between align-items-start"},MC={class:"flex-grow-1"},OC={class:"card-title mb-1"},DC={key:0,class:"card-text text-muted small mb-2"},LC={class:"template-meta"},NC={class:"badge bg-secondary me-2"},IC={class:"text-muted small"},jC={class:"btn-group btn-group-sm ms-3"},PC=["onClick"],RC=["onClick"],WC={key:1},BC={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},FC={class:"nav-item",role:"presentation"},HC={key:0,class:"error-indicator",title:"This tab has validation errors"},VC={class:"nav-item",role:"presentation"},UC={key:0,class:"error-indicator",title:"This tab has validation errors"},qC={class:"nav-item",role:"presentation"},zC={key:0,class:"error-indicator",title:"This tab has validation errors"},KC={class:"tab-content"},GC={key:2,class:"alert alert-danger mt-3"},YC={class:"modal-footer"},JC={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},QC=["disabled"],XC={key:0,class:"spinner-border spinner-border-sm me-2"},ZC={__name:"ConfigurationModal",setup(n){const e=Ft(),t=Re(),o=me(),i=be(),r=R(null);let l=null;const m=R(null),p=R("create-session"),f=R("general"),u=R(null),w=R(null),g=R(null),k=R([]),$=R(null),b=R(null),d=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),v=ws({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),_=ws({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),T=ws({name:""}),E=h(()=>({general:!!T.name,permissions:!1,advanced:!1})),B=R(!1),P=R(""),A=h(()=>p.value==="create-session"||p.value==="edit-session"),V=h(()=>p.value==="edit-session"||p.value==="edit-template"),C=h(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),S=h(()=>B.value?V.value?"Saving...":"Creating...":V.value?"Save Changes":A.value?"Create Session":"Save Template"),W=h(()=>!(!_.name.trim()||A.value&&_.name.includes(" "))),z=h(()=>w.value?.working_directory?w.value.working_directory:_.working_directory?_.working_directory:t.projects.get(u.value)?.working_directory||""),j=h(()=>!_.allowed_tools||!_.allowed_tools.trim()?[]:_.allowed_tools.split(",").map(q=>q.trim()).filter(q=>q.length>0));function H(){m.value&&m.value.show()}function G(q,ae){_[q]=ae,q==="name"&&(T.name="")}function te(q){$.value=q,L()}async function O(){try{const q=await pe.get("/api/templates");k.value=q||[]}catch(q){console.error("Failed to load templates:",q),k.value=[]}}function L(){if(!$.value){_.default_role="",_.initialization_context="",_.permission_mode="default",_.allowed_tools="",v.default_role="normal",v.initialization_context="normal",v.permission_mode="normal",v.allowed_tools="normal",d.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const q=k.value.find(ae=>ae.template_id===$.value);if(q)if(v.default_role="normal",v.initialization_context="normal",v.permission_mode="normal",v.allowed_tools="normal",q.default_role?(_.default_role=q.default_role,d.value.default_role=q.default_role,v.default_role="autofilled"):(_.default_role="",d.value.default_role=null),q.default_system_prompt?(_.initialization_context=q.default_system_prompt,d.value.initialization_context=q.default_system_prompt,v.initialization_context="autofilled"):(_.initialization_context="",d.value.initialization_context=null),q.permission_mode?(_.permission_mode=q.permission_mode,d.value.permission_mode=q.permission_mode,v.permission_mode="autofilled"):(_.permission_mode="default",d.value.permission_mode=null),q.allowed_tools&&q.allowed_tools.length>0){const ae=q.allowed_tools.join(", ");_.allowed_tools=ae,d.value.allowed_tools=ae,v.allowed_tools="autofilled"}else _.allowed_tools="",d.value.allowed_tools=null}function M(){const ae=(u.value?t.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:ae,currentPath:_.working_directory||"",onSelect:de=>{_.working_directory=de}})}function D(){p.value==="create-session"&&(b.value={mode:"create-session",projectId:u.value,formData:{..._},selectedTemplateId:$.value}),p.value="template-list",Q()}function Y(){p.value="create-template",Q(),f.value="general"}function ee(q){p.value="edit-template",g.value=q,Q(),oe(q),f.value="general"}async function X(q){if(confirm(`Delete template "${q.name}"?

This action cannot be undone.`))try{await pe.delete(`/api/templates/${q.template_id}`),await O()}catch(ae){console.error("Failed to delete template:",ae),P.value=ae.response?.data?.detail||"Failed to delete template"}}function Z(){let q=!0;return T.name="",_.name.trim()||(T.name="Name is required",q=!1),A.value&&_.name.includes(" ")&&(T.name="Session name must be a single word (no spaces)",q=!1),q}async function ne(){if(!Z()){T.name&&(f.value="general");return}B.value=!0,P.value="";try{switch(p.value){case"create-session":await K(),l&&l.hide();break;case"edit-session":await I(),l&&l.hide();break;case"create-template":await N();break;case"edit-template":await U();break}}catch(q){console.error("Submit failed:",q),P.value=q.response?.data?.detail||q.message||"Operation failed. Please try again."}finally{B.value=!1}}async function K(){if(!u.value)throw new Error("Project ID is missing");const q=_.allowed_tools.split(",").map(Be=>Be.trim()).filter(Be=>Be.length>0),ae=_.capabilities.split(",").map(Be=>Be.trim()).filter(Be=>Be.length>0),de={name:_.name.trim(),model:_.model||null,role:_.default_role.trim()||null,initialization_context:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,capabilities:ae.length>0?ae:null,permission_mode:_.permission_mode,allowed_tools:q.length>0?q:null,working_directory:_.working_directory.trim()||null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources},Ae=await pe.post(`/api/legions/${u.value}/minions`,de);if(Ae.success&&Ae.minion_id)await t.fetchProjects(),await o.fetchSessions(),_.startImmediately&&await o.startSession(Ae.minion_id),e.push(`/session/${Ae.minion_id}`);else throw new Error("Failed to create session")}async function I(){if(!w.value)throw new Error("Session data is missing");const q=w.value.session_id,ae=w.value.state==="active"||w.value.state==="starting",de=_.allowed_tools.split(",").map(Se=>Se.trim()).filter(Se=>Se.length>0),Ae=_.capabilities.split(",").map(Se=>Se.trim()).filter(Se=>Se.length>0),Be={name:_.name.trim(),model:_.model,role:_.default_role.trim()||null,system_prompt:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,allowed_tools:de.length>0?de:null,capabilities:Ae.length>0?Ae:null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources};await o.patchSession(q,Be),ae&&_.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(q,_.permission_mode)}async function N(){const q=_.allowed_tools.split(",").map(de=>de.trim()).filter(de=>de.length>0),ae={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:q.length>0?q:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await pe.post("/api/templates",ae),await O(),p.value="template-list",Q()}async function U(){if(!g.value)throw new Error("Template data is missing");const q=_.allowed_tools.split(",").map(de=>de.trim()).filter(de=>de.length>0),ae={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:q.length>0?q:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await pe.put(`/api/templates/${g.value.template_id}`,ae),await O(),p.value="template-list",g.value=null,Q()}function Q(){_.name="",_.model="sonnet",_.permission_mode="default",_.working_directory="",_.description="",_.default_role="",_.startImmediately=!0,_.allowed_tools="",_.capabilities="",_.setting_sources=["user","project","local"],_.system_prompt="",_.override_system_prompt=!1,_.initialization_context="",_.sandbox_enabled=!1,T.name="",v.default_role="normal",v.initialization_context="normal",v.permission_mode="normal",v.allowed_tools="normal",d.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},$.value=null,P.value="",f.value="general"}function F(q){_.name=q.name||"",_.model=q.model||"sonnet",_.permission_mode=q.current_permission_mode||"default",_.working_directory=q.working_directory||"",_.default_role=q.role||"",_.initialization_context=q.system_prompt||"",_.override_system_prompt=q.override_system_prompt||!1,_.system_prompt="",_.allowed_tools=q.allowed_tools?.join(", ")||"",_.capabilities=q.capabilities?.join(", ")||"",_.sandbox_enabled=q.sandbox_enabled||!1,_.setting_sources=q.setting_sources||["user","project","local"]}function oe(q){_.name=q.name||"",_.description=q.description||"",_.permission_mode=q.permission_mode||"default",_.default_role=q.default_role||"",_.initialization_context=q.default_system_prompt||"",_.allowed_tools=q.allowed_tools?.join(", ")||""}function fe(){kt(()=>{const q=document.getElementById("config-name");q&&(q.focus(),V.value&&q.select())})}function ge(){Q(),p.value="create-session",u.value=null,w.value=null,g.value=null,i.hideModal()}return ve(()=>i.currentModal,async(q,ae)=>{if(!(!q||!l)){if(q.name==="configuration"){const de=q.data||{};p.value=de.mode||"create-session",u.value=de.project?.project_id||de.projectId||null,w.value=de.session||null,g.value=de.template||null,Q(),p.value==="create-session"&&await O(),p.value==="edit-session"&&w.value?F(w.value):p.value==="edit-template"&&g.value&&oe(g.value),l.show()}else if(q.name==="create-minion"||q.name==="create-session"){const de=q.data||{};p.value="create-session",u.value=de.project?.project_id||null,w.value=null,g.value=null,Q(),await O(),l.show()}else if(q.name==="edit-session"){const de=q.data||{};p.value="edit-session",w.value=de.session||null,u.value=w.value?.project_id||null,g.value=null,Q(),w.value&&F(w.value),l.show()}else q.name==="template-management"&&(p.value="template-list",Q(),await O(),l.show());ae?.name==="configuration"&&ae.data?.mode?.includes("template")&&q?.name==="configuration"&&p.value==="create-session"&&await O()}}),ve(()=>_.default_role,q=>{d.value.default_role!==null&&(v.default_role=q===d.value.default_role?"autofilled":"modified")}),ve(()=>_.initialization_context,q=>{d.value.initialization_context!==null&&(v.initialization_context=q===d.value.initialization_context?"autofilled":"modified")}),ve(()=>_.permission_mode,q=>{d.value.permission_mode!==null&&(v.permission_mode=q===d.value.permission_mode?"autofilled":"modified")}),ve(()=>_.allowed_tools,q=>{d.value.allowed_tools!==null&&(v.allowed_tools=q===d.value.allowed_tools?"autofilled":"modified")}),ke(()=>{r.value&&Me(()=>import("./modal-D6mKceGM.js").then(q=>q.m),__vite__mapDeps([0,1])).then(q=>{const ae=q.default;l=new ae(r.value),r.value.addEventListener("shown.bs.modal",fe),r.value.addEventListener("hidden.bs.modal",ge)})}),Te(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",fe),r.value.removeEventListener("hidden.bs.modal",ge)),l&&l.dispose()}),(q,ae)=>(a(),c(le,null,[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",wC,[s("div",$C,[s("div",kC,[s("h5",SC,[p.value==="create-template"||p.value==="edit-template"?(a(),c("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:D,title:"Back to template list"}," â† ")):x("",!0),re(" "+y(C.value),1)]),ae[3]||(ae[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",EC,[p.value==="template-list"?(a(),c("div",CC,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[ae[4]||(ae[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:Y,class:"btn btn-primary btn-sm"}," + Create New ")]),k.value.length===0?(a(),c("div",TC," No templates found. Create your first template! ")):x("",!0),(a(!0),c(le,null,ue(k.value,de=>(a(),c("div",{key:de.template_id,class:"card mb-2"},[s("div",xC,[s("div",AC,[s("div",MC,[s("h6",OC,y(de.name),1),de.description?(a(),c("p",DC,y(de.description),1)):x("",!0),s("div",LC,[s("span",NC,y(de.permission_mode),1),s("span",IC,y(de.allowed_tools?.length||0)+" tools",1)])]),s("div",jC,[s("button",{onClick:Ae=>ee(de),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,PC),s("button",{onClick:Ae=>X(de),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,RC)])])])]))),128))])):(a(),c("div",WC,[s("ul",BC,[s("li",FC,[s("button",{class:se(["nav-link",{active:f.value==="general","has-error":E.value.general}]),type:"button",onClick:ae[0]||(ae[0]=de=>f.value="general")},[ae[5]||(ae[5]=re(" General ",-1)),E.value.general?(a(),c("span",HC)):x("",!0)],2)]),s("li",VC,[s("button",{class:se(["nav-link",{active:f.value==="permissions","has-error":E.value.permissions}]),type:"button",onClick:ae[1]||(ae[1]=de=>f.value="permissions")},[ae[6]||(ae[6]=re(" Permissions ",-1)),E.value.permissions?(a(),c("span",UC)):x("",!0)],2)]),s("li",qC,[s("button",{class:se(["nav-link",{active:f.value==="advanced","has-error":E.value.advanced}]),type:"button",onClick:ae[2]||(ae[2]=de=>f.value="advanced")},[ae[7]||(ae[7]=re(" Advanced ",-1)),E.value.advanced?(a(),c("span",zC)):x("",!0)],2)])]),s("div",KC,[we(he(sE,{mode:p.value,"form-data":_,errors:T,templates:k.value,"selected-template-id":$.value,session:w.value,"field-states":v,"onUpdate:formData":G,"onUpdate:selectedTemplateId":te,onOpenFolderBrowser:M,onOpenTemplateManager:D},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ys,f.value==="general"]]),we(he(HE,{mode:p.value,"form-data":_,errors:T,session:w.value,"field-states":v,"onUpdate:formData":G,onPreviewPermissions:H},null,8,["mode","form-data","errors","session","field-states"]),[[ys,f.value==="permissions"]]),we(he(nC,{mode:p.value,"form-data":_,errors:T,session:w.value,"field-states":v,"onUpdate:formData":G},null,8,["mode","form-data","errors","session","field-states"]),[[ys,f.value==="advanced"]])])])),P.value?(a(),c("div",GC,y(P.value),1)):x("",!0)]),s("div",YC,[s("button",JC,y(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(a(),c("button",{key:0,type:"button",class:"btn btn-primary",disabled:B.value||!W.value,onClick:ne},[B.value?(a(),c("span",XC)):x("",!0),re(" "+y(S.value),1)],8,QC)):x("",!0)])])])],512),he(yC,{ref_key:"permissionPreviewModal",ref:m,"working-directory":z.value,"setting-sources":_.setting_sources,"session-allowed-tools":j.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},e0=ie(ZC,[["__scopeId","data-v-098a9c63"]]),t0={class:"modal-dialog modal-dialog-centered"},s0={class:"modal-content"},n0={class:"modal-header"},o0={class:"modal-title",id:"manageSessionModalLabel"},i0={class:"modal-body"},a0={key:0,class:"text-center py-4"},r0={class:"text-muted"},l0={key:1},c0={key:2},u0={class:"text-muted"},d0={key:0,class:"text-center py-2"},m0={key:1,class:"alert alert-warning mt-3"},p0={class:"mb-0 mt-2"},f0={key:0,class:"text-muted"},v0={key:3},h0={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},_0={class:"d-grid gap-2"},g0=["disabled"],b0=["disabled"],y0=["disabled"],w0=["disabled"],$0={class:"modal-footer"},k0={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},S0={__name:"SessionManageModal",setup(n){const e=Ft(),t=me(),o=be(),i=ot();Oe();const r=R(null),l=R(!1),m=R(""),p=R(""),f=R(null),u=R(null);let w=null;const g=R([]),k=R(!1),$=h(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function b(){f.value="reset"}async function d(){if(f.value="delete",g.value=[],!!r.value){k.value=!0;try{const C=await pe.get(`/api/sessions/${r.value.session_id}/descendants`);g.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),g.value=[]}finally{k.value=!1}}}function v(){f.value=null}async function _(){f.value==="reset"?await B():f.value==="delete"&&await P()}async function T(){if(r.value){l.value=!0,m.value="Restarting session...";try{const C=r.value.session_id,S=t.currentSessionId===C,W=await pe.post(`/api/sessions/${C}/restart`);if(W.success)console.log("Session restarted successfully"),S&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(C)),w&&w.hide();else{const z=W.error||W.detail||"Failed to restart session";console.error("Failed to restart session:",z),p.value=`Failed to restart session: ${z}`}}catch(C){console.error("Error restarting session:",C);const S=C.data?.detail||C.message||"Unknown error";p.value=`Error restarting session: ${S}`}finally{l.value=!1}}}async function E(){if(r.value)try{w&&w.hide(),console.log("Ending session",r.value.session_id);const C=r.value.session_id;await pe.post(`/api/sessions/${C}/terminate`),t.currentSessionId===C&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),t.currentSessionId===r.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function B(){if(r.value){l.value=!0,m.value="Resetting session...";try{const C=r.value.session_id,S=t.currentSessionId===C,W=await pe.post(`/api/sessions/${C}/reset`);if(W.success)console.log("Session reset successfully"),S&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(C)),w&&w.hide();else{const z=W.error||W.detail||"Failed to reset session";console.error("Failed to reset session:",z),p.value=`Failed to reset session: ${z}`,f.value=null}}catch(C){console.error("Error resetting session:",C);const S=C.data?.detail||C.message||"Unknown error";p.value=`Error resetting session: ${S}`,f.value=null}finally{l.value=!1}}}async function P(){if(r.value){l.value=!0,m.value="Deleting session...";try{const C=r.value.session_id;await t.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),w&&w.hide()}catch(C){console.error("Error deleting session:",C);const S=C.data?.detail||C.message||"Unknown error";p.value=`Error deleting session: ${S}`,f.value=null}finally{l.value=!1}}}function A(){f.value=null,l.value=!1,m.value="",p.value="",g.value=[],k.value=!1}function V(){A(),r.value=null,o.hideModal()}return ve(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&w){const S=C.data||{};r.value=S.session,A(),w.show()}}),ke(()=>{u.value&&Me(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{w=new C(u.value),u.value.addEventListener("hidden.bs.modal",V)})}),Te(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",V),w&&w.dispose()}),(C,S)=>(a(),c("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",t0,[s("div",s0,[s("div",n0,[s("h5",o0,y(f.value?$.value:"Manage Session"),1),S[1]||(S[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",i0,[l.value?(a(),c("div",a0,[S[2]||(S[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",r0,y(m.value),1)])):f.value==="reset"?(a(),c("div",l0,[...S[3]||(S[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(a(),c("div",c0,[S[9]||(S[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",u0,[S[4]||(S[4]=re("This will permanently delete session ",-1)),s("strong",null,y(r.value?.name),1),S[5]||(S[5]=re(".",-1))]),S[10]||(S[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),k.value?(a(),c("div",d0,[...S[6]||(S[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(a(),c("div",m0,[S[7]||(S[7]=s("strong",null,"Cascading Deletion:",-1)),S[8]||(S[8]=re(" This session has ",-1)),s("strong",null,y(g.value.length),1),re(" child session"+y(g.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",p0,[(a(!0),c(le,null,ue(g.value,W=>(a(),c("li",{key:W.session_id,class:"small"},[s("strong",null,y(W.name||W.session_id),1),W.role?(a(),c("span",f0," ("+y(W.role)+")",1)):x("",!0)]))),128))])])):x("",!0)])):(a(),c("div",v0,[p.value?(a(),c("div",h0,[S[11]||(S[11]=s("strong",null,"Error:",-1)),re(" "+y(p.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:S[0]||(S[0]=W=>p.value="")})])):x("",!0),S[18]||(S[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",_0,[s("button",{class:"btn btn-outline-primary text-start",onClick:T,disabled:l.value},[...S[12]||(S[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,g0),s("button",{class:"btn btn-outline-secondary text-start",onClick:E,disabled:l.value},[...S[13]||(S[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,b0),S[16]||(S[16]=s("hr",{class:"my-2"},null,-1)),S[17]||(S[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:l.value},[...S[14]||(S[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,y0),s("button",{class:"btn btn-outline-danger text-start",onClick:d,disabled:l.value},[...S[15]||(S[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,w0)]),S[19]||(S[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),re(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",$0,[f.value&&!l.value?(a(),c(le,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:v},"Cancel"),s("button",{type:"button",class:se(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:_},y(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?x("",!0):(a(),c("button",k0,"Cancel"))])])])],512))}},E0=ie(S0,[["__scopeId","data-v-6b832853"]]),C0={class:"modal-dialog modal-dialog-centered modal-lg"},T0={class:"modal-content"},x0={class:"modal-body"},A0={key:0,class:"text-center text-muted py-4"},M0={key:1},O0={class:"mb-3"},D0={class:"font-monospace small"},L0={class:"mb-3"},N0=["value"],I0={class:"mb-3"},j0={class:"mb-3"},P0={class:"mb-3"},R0={key:0},W0={class:"d-flex flex-wrap gap-1"},B0={key:1,class:"text-muted small"},F0={key:0,class:"mb-3"},H0={class:"d-flex flex-wrap gap-1"},V0={key:1,class:"mb-3"},U0={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},q0={class:"mb-3"},z0={class:"text-muted"},K0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},G0={__name:"SessionInfoModal",setup(n){const e=me(),t=Oe(),o=be(),i=R(null),r=R(!1),l=R(null);let m=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=h(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(t.messagesBySession.get(i.value)||[]).find(_=>_.type==="system"&&(_.subtype==="init"||_.metadata?.subtype==="init")&&_.metadata?.init_data)?.metadata?.init_data||null});function u(b){return b?p[b]||b:"Default (Sonnet 4.5)"}function w(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function g(b){b.target.select()}function k(){i.value=null,r.value=!1}function $(){k(),o.hideModal()}return ve(()=>o.currentModal,b=>{if(b?.name==="session-info"&&m){const d=b.data||{};i.value=d.sessionId,r.value=!1,m.show()}}),ke(()=>{l.value&&Me(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{m=new b(l.value),l.value.addEventListener("hidden.bs.modal",$)})}),Te(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",$),m&&m.dispose()}),(b,d)=>(a(),c("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",C0,[s("div",T0,[d[9]||(d[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",x0,[f.value?(a(),c("div",M0,[s("div",O0,[d[1]||(d[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",D0,y(i.value),1)]),s("div",L0,[d[2]||(d[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:g},null,8,N0)]),s("div",I0,[d[3]||(d[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,y(u(f.value.model)),1)]),s("div",j0,[d[4]||(d[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,y(f.value.permissionMode||"default"),1)]),s("div",P0,[d[5]||(d[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(a(),c("div",R0,[s("div",W0,[(a(!0),c(le,null,ue(f.value.allowed_tools||f.value.tools,v=>(a(),c("span",{key:v,class:"badge bg-secondary"},y(v),1))),128))])])):(a(),c("div",B0,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(a(),c("div",F0,[d[6]||(d[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",H0,[(a(!0),c(le,null,ue(f.value.commands,v=>(a(),c("span",{key:v,class:"badge bg-info"},y(v),1))),128))])])):x("",!0),f.value.systemPrompt?(a(),c("div",V0,[d[7]||(d[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",U0,y(w(f.value.systemPrompt)),1)])):x("",!0),s("div",q0,[s("h6",z0,[d[8]||(d[8]=re(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:d[0]||(d[0]=v=>r.value=!r.value)},y(r.value?"Hide":"Show"),1)]),r.value?(a(),c("pre",K0,y(JSON.stringify(f.value,null,2)),1)):x("",!0)])])):(a(),c("div",A0," No session configuration data available "))]),d[10]||(d[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},Y0=ie(G0,[["__scopeId","data-v-b28b39b3"]]),J0={class:"modal-dialog modal-dialog-centered modal-lg"},Q0={class:"modal-content"},X0={class:"modal-body"},Z0={key:0,class:"text-center text-muted py-4"},eT={key:1},tT={class:"mb-3"},sT={class:"mb-3"},nT={class:"font-monospace small"},oT={class:"mb-3"},iT={class:"mb-3"},aT={class:"mb-3"},rT={key:0},lT={class:"d-flex flex-wrap gap-1"},cT={key:1,class:"text-muted small"},uT={class:"mb-3"},dT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},mT={key:1,class:"text-muted small"},pT={class:"mb-3"},fT={key:0,class:"badge bg-info"},vT={key:1,class:"badge bg-secondary"},hT={class:"mb-3"},_T={key:0,class:"font-monospace small"},gT={key:1,class:"text-muted small"},bT={key:0,class:"mb-3"},yT={key:0},wT={class:"list-unstyled mb-0"},$T={key:1,class:"text-muted small"},kT={class:"mb-3"},ST={class:"small"},ET={class:"mb-3"},CT={class:"small"},TT={__name:"MinionViewModal",setup(n){const e=be(),t=R(null),o=R(null);let i=null;function r(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function l(f){if(!f)return"N/A";try{const u=new Date(f);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function m(){t.value=null}function p(){m(),e.hideModal()}return ve(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const u=f.data||{};t.value=u.session,i.show()}}),ke(()=>{o.value&&Me(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),Te(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(f,u)=>(a(),c("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",J0,[s("div",Q0,[u[11]||(u[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",X0,[t.value?(a(),c("div",eT,[s("div",tT,[u[0]||(u[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,y(t.value.name||"Unnamed Minion"),1)]),s("div",sT,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",nT,y(t.value.session_id),1)]),s("div",oT,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,y(t.value.role||"Not specified"),1)]),s("div",iT,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:se(["badge",r(t.value.state)])},y(t.value.state),3)])]),s("div",aT,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(a(),c("div",rT,[s("div",lT,[(a(!0),c(le,null,ue(t.value.capabilities,w=>(a(),c("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(a(),c("div",cT,"None"))]),s("div",uT,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(a(),c("div",dT,y(t.value.initialization_context),1)):(a(),c("div",mT,"Not specified"))]),s("div",pT,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(a(),c("span",fT,"Yes")):(a(),c("span",vT,"No"))])]),s("div",hT,[u[7]||(u[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(a(),c("div",_T,y(t.value.parent_overseer_id),1)):(a(),c("div",gT," Root overseer (user-created) "))]),t.value.is_overseer?(a(),c("div",bT,[u[8]||(u[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(a(),c("div",yT,[s("ul",wT,[(a(!0),c(le,null,ue(t.value.child_minion_ids,w=>(a(),c("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(a(),c("div",$T,"No children"))])):x("",!0),s("div",kT,[u[9]||(u[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",ST,y(l(t.value.created_at)),1)]),s("div",ET,[u[10]||(u[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",CT,y(l(t.value.updated_at)),1)])])):(a(),c("div",Z0," No minion data available "))]),u[12]||(u[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},xT=ie(TT,[["__scopeId","data-v-d996dc6f"]]),AT={class:"container-fluid vh-100 d-flex flex-column p-0"},MT={class:"d-flex flex-grow-1 overflow-hidden position-relative"},OT={class:"flex-grow-1 d-flex flex-column overflow-hidden"},DT={__name:"App",setup(n){const e=be(),t=ot(),o=me(),i=Re(),r=Rt(),l=Ze(),m=Ft(),p=R(null);function f(d){p.value=d}gn("addAttachmentFromResource",f),gn("pendingResourceAttachment",p);const u=h(()=>e.sidebarCollapsed),w=h(()=>e.rightSidebarCollapsed),g=h(()=>e.isMobile);ve(()=>r.currentHasTasks,(d,v)=>{d&&!v&&e.setRightSidebarCollapsed(!1)}),ve(()=>l.currentHasResources,(d,v)=>{d&&!v&&e.setRightSidebarCollapsed(!1)}),ke(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const d=window.location.hash;if(d.startsWith("#/session/")){const v=d.replace("#/session/","");o.sessions.has(v)&&await o.selectSession(v)}else if(d.startsWith("#/timeline/")){const v=d.replace("#/timeline/","");m.push(`/timeline/${v}`)}window.addEventListener("popstate",k),window.addEventListener("resize",e.handleResize)}),Te(()=>{window.removeEventListener("popstate",k),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function k(){const d=window.location.hash;if(d.startsWith("#/session/")){const v=d.replace("#/session/","");o.sessions.has(v)&&o.selectSession(v)}}function $(){e.toggleSidebar()}function b(){e.toggleRightSidebar()}return(d,v)=>{const _=vo("router-view");return a(),c("div",AT,[he(vw),s("div",{id:"sidebar-backdrop",class:se({show:!u.value&&g.value}),onClick:$},null,2),s("div",{id:"right-sidebar-backdrop",class:se({show:!w.value&&g.value}),onClick:b},null,2),s("div",MT,[he(qw),s("main",OT,[he(_)]),he(mk)]),he(Ak),he(qk),he(pS),he(e0),he(E0),he(Y0),he(xT)])}}},un=Oi(DT);un.use(Di());un.use(aw);un.mount("#app");
