const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as t,o as u,d as $t,r as A,b as g,t as w,n as He,e as G,f as X,u as Xt,w as ce,g as vn,h as L,F as ae,i as de,j as _e,k as oo,l as oe,v as pe,m as re,p as me,q as ss,s as Ns,x as ve,y as Oe,z as io,A as vi,B as hi,C as Ge,D as Ee,T as ao,E as Ls,G as Ot,H as _i,I as gi}from"./vue-vendor-BJFg3Ugm.js";import{m as nt,p as ns}from"./markdown-vendor-CQ3OZdP9.js";import{c as bi}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();const yi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},$i={__name:"NoSessionSelected",setup(n){return(e,s)=>(u(),m("div",yi,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},wi="modulepreload",Ei=function(n){return"/"+n},hn={},be=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let d=function(p){return Promise.all(p.map(c=>Promise.resolve(c).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),r=l?.nonce||l?.getAttribute("nonce");i=d(s.map(p=>{if(p=Ei(p),p in hn)return;hn[p]=!0;const c=p.endsWith(".css"),_=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${_}`))return;const b=document.createElement("link");if(b.rel=c?"stylesheet":wi,c||(b.as="script"),b.crossOrigin="",b.href=p,r&&b.setAttribute("nonce",r),document.head.appendChild(b),c)return new Promise((f,$)=>{b.addEventListener("load",f),b.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return i.then(l=>{for(const r of l||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})};class ps extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Nt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new ps(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof ps?s:(console.error("API request failed:",s),new ps(`Network error: ${s.message}`,0,null))}}async function Ci(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[r,d]of Object.entries(e.params))d!=null&&o.append(r,d);const i=o.toString();i&&(s=`${n}?${i}`);const{params:a,...l}=e;return Nt(s,{...l,method:"GET"})}return Nt(s,{...e,method:"GET"})}async function Si(n,e,s={}){return Nt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function ki(n,e,s={}){return Nt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Ti(n,e={}){return Nt(n,{...e,method:"DELETE"})}const se={get:Ci,post:Si,put:ki,delete:Ti},ie=$t("session",()=>{const n=A(new Map),e=A(null),s=A(new Map),o=A(new Map),i=A(new Set),a=A(!1);let l=null;const r=g(()=>n.value.get(e.value)),d=g(()=>Array.from(n.value.values()).sort((x,O)=>x.order-O.order)),p=x=>g(()=>d.value.filter(O=>O.project_id===x)),c=g({get:()=>s.value.get(e.value)||"",set:x=>{e.value&&s.value.set(e.value,x)}});async function _(){try{const x=await se.get("/api/sessions");return n.value.clear(),x.sessions.forEach(O=>{n.value.set(O.session_id,O)}),console.log(`Loaded ${n.value.size} sessions`),x.sessions}catch(x){throw console.error("Failed to fetch sessions:",x),x}}async function b(x,O){try{const R=(await se.post("/api/sessions",{project_id:x,...O})).session_id,S=(await se.get(`/api/sessions/${R}`)).session;return n.value.set(R,S),n.value=new Map(n.value),console.log(`Created session ${R}`),S}catch(q){throw console.error("Failed to create session:",q),q}}async function f(x){if(e.value===x&&!a.value)return;l&&(console.log(`Aborting pending selection to switch to ${x}`),l.abort(),l=null);const O=new AbortController;l=O,a.value=!0;try{if(e.value=x,O.signal.aborted){console.log(`Selection of ${x} aborted early`);return}let q=n.value.get(x);if(!q)try{const S=await se.get(`/api/sessions/${x}`);if(O.signal.aborted){console.log(`Selection of ${x} aborted after fetch`);return}q=S.session,n.value.set(x,q),n.value=new Map(n.value),console.log(`Fetched session ${x} for deeplink`)}catch(S){console.error(`Failed to fetch session ${x}:`,S);return}if(q&&(q.state==="created"||q.state==="terminated"))try{if(await C(x),O.signal.aborted){console.log(`Selection of ${x} aborted after start`);return}console.log(`Auto-started session ${x} (was in ${q.state} state)`);const S=6e4,E=200,M=5e3;let N=0,V=0;for(;N<S;){if(O.signal.aborted){console.log(`Selection of ${x} aborted during state wait`);return}const ee=n.value.get(x);if(ee&&ee.state==="active"){console.log(`Session ${x} is now active after ${N}ms`);break}if(N-V>=M){const le=n.value.get(x)?.state||"unknown";console.log(`Waiting for session ${x} to become active (current: ${le}, ${N/1e3}s elapsed)`),V=N}await new Promise(le=>setTimeout(le,E)),N+=E}const U=n.value.get(x);U&&U.state!=="active"&&console.warn(`Session ${x} did not become active within ${S/1e3}s (state: ${U.state}), continuing anyway`)}catch(S){console.error(`Failed to auto-start session ${x}:`,S)}if(O.signal.aborted){console.log(`Selection of ${x} aborted before message load`);return}if(await(await be(()=>Promise.resolve().then(()=>Ki),void 0)).useMessageStore().loadMessages(x),O.signal.aborted){console.log(`Selection of ${x} aborted after message load`);return}await(await be(()=>Promise.resolve().then(()=>fa),void 0)).useWebSocketStore().connectSession(x),O.signal.aborted||console.log(`Selected session ${x}`)}finally{l===O&&(l=null),a.value=!1}}function $(x,O){const q=n.value.get(x);q?Object.assign(q,O):(n.value.set(x,O),console.log(`Added new session ${x} via WebSocket update`)),n.value=new Map(n.value)}async function y(x){i.value.add(x);try{await se.delete(`/api/sessions/${x}`),n.value.delete(x),s.value.delete(x),o.value.delete(x),n.value=new Map(n.value),e.value===x&&(e.value=null),console.log(`Deleted session ${x}`)}catch(O){throw console.error("Failed to delete session:",O),O}finally{i.value.delete(x)}}async function h(x,O){try{await se.put(`/api/sessions/${x}/name`,{name:O}),$(x,{name:O}),console.log(`Updated session ${x} name to "${O}"`)}catch(q){throw console.error("Failed to update session name:",q),q}}async function v(x,O){try{await se.post(`/api/sessions/${x}/permission-mode`,{mode:O}),$(x,{current_permission_mode:O});const q=o.value.get(x);q&&(q.permissionMode=O,o.value.set(x,q)),console.log(`Set permission mode for session ${x} to ${O}`)}catch(q){throw console.error("Failed to set permission mode:",q),q}}async function C(x){try{await se.post(`/api/sessions/${x}/start`),console.log(`Started session ${x}`)}catch(O){throw console.error("Failed to start session:",O),O}}async function k(x){try{await se.post(`/api/sessions/${x}/pause`),console.log(`Paused session ${x}`)}catch(O){throw console.error("Failed to pause session:",O),O}}async function T(x){try{await se.post(`/api/sessions/${x}/terminate`),console.log(`Terminated session ${x}`)}catch(O){throw console.error("Failed to terminate session:",O),O}}function D(x){return n.value.get(x)}function I(x,O){o.value.set(x,O),O.permissionMode&&$(x,{current_permission_mode:O.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:r,orderedSessions:d,sessionsInProject:p,currentInput:c,fetchSessions:_,createSession:b,selectSession:f,updateSession:$,deleteSession:y,updateSessionName:h,setPermissionMode:v,startSession:C,pauseSession:k,terminateSession:T,getSession:D,storeInitData:I}}),_n=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ie},Symbol.toStringTag,{value:"Module"})),fe=$t("ui",()=>{const n=A(window.innerWidth<768),e=A(300),s=A(window.innerWidth),o=g(()=>s.value<768),i=A(!0),a=A(null),l=A(null),r=g(()=>a.value?{name:a.value,data:l.value}:null),d=A(!1),p=A("Loading...");function c(){n.value=!n.value}function _(k){n.value=k}function b(k){e.value=Math.max(200,Math.min(k,window.innerWidth*.3))}function f(k){i.value=k}function $(k,T=null){a.value=null,l.value=null,setTimeout(()=>{a.value=k,l.value=T},0)}function y(){a.value=null,l.value=null}function h(k="Loading..."){d.value=!0,p.value=k}function v(){d.value=!1}function C(){const k=s.value;s.value=window.innerWidth,s.value<768&&k>=768?n.value=!0:s.value>=768&&k<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:l,currentModal:r,isLoading:d,loadingMessage:p,toggleSidebar:c,setSidebarCollapsed:_,setSidebarWidth:b,setAutoScroll:f,showModal:$,hideModal:y,showLoading:h,hideLoading:v,handleResize:C}}),ge=$t("project",()=>{const n=A(new Map),e=A(null),s=g(()=>n.value.get(e.value)),o=g(()=>Array.from(n.value.values()).sort((y,h)=>y.order-h.order)),i=y=>n.value.get(y)?.is_multi_agent||!1;async function a(){try{const y=await se.get("/api/projects");return n.value.clear(),y.projects.forEach(h=>{n.value.set(h.project_id,h)}),console.log(`Loaded ${n.value.size} projects`),y.projects}catch(y){throw console.error("Failed to fetch projects:",y),y}}async function l(y,h,v=!1){try{const k=(await se.post("/api/projects",{name:y,working_directory:h,is_multi_agent:v})).project;return n.value.set(k.project_id,k),n.value=new Map(n.value),console.log(`Created project ${k.project_id}`),k}catch(C){throw console.error("Failed to create project:",C),C}}async function r(y,h){try{await se.put(`/api/projects/${y}`,h),d(y,h),console.log(`Updated project ${y}`,h)}catch(v){throw console.error("Failed to update project:",v),v}}function d(y,h){const v=n.value.get(y);v&&(Object.assign(v,h),n.value=new Map(n.value))}async function p(y){try{await se.delete(`/api/projects/${y}`),n.value.delete(y),n.value=new Map(n.value),e.value===y&&(e.value=null),console.log(`Deleted project ${y}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function c(y){try{const h=await se.put(`/api/projects/${y}/toggle-expansion`),v=n.value.get(y);return v&&(v.is_expanded=h.is_expanded,n.value=new Map(n.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function _(y){try{await se.put("/api/projects/reorder",{project_ids:y}),y.forEach((h,v)=>{const C=n.value.get(h);C&&(C.order=v)}),n.value=new Map(n.value),console.log("Reordered projects",y)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function b(y,h){try{await se.put(`/api/projects/${y}/sessions/reorder`,{session_ids:h});const v=n.value.get(y);v&&(v.session_ids=h,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${y}`,h)}catch(v){throw console.error("Failed to reorder sessions:",v),v}}function f(y){return n.value.get(y)}function $(y){if(!y)return"";const h=y.split(/[/\\]/).filter(v=>v);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:l,updateProject:r,updateProjectLocal:d,deleteProject:p,toggleExpansion:c,reorderProjects:_,reorderSessionsInProject:b,getProject:f,formatPath:$}}),K=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},xi={class:"session-header border-bottom p-3"},Mi={class:"project-name"},Ai=["title"],Oi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ie(),o=ge(),i=g(()=>s.sessions.get(e.sessionId)),a=g(()=>i.value?.name||e.sessionId),l=g(()=>{for(const d of o.projects.values())if(d.session_ids?.includes(e.sessionId))return d;return null}),r=g(()=>l.value?.name||"Unknown Project");return(d,p)=>(u(),m("div",xi,[t("div",null,[t("div",Mi,w(r.value),1),t("div",{class:"session-name",title:n.sessionId},w(a.value),9,Ai)])]))}},Ni=K(Oi,[["__scopeId","data-v-89e9c269"]]),Li={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Di=["title"],Ii={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Pi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ie(),o=g(()=>s.sessions.get(e.sessionId)),i=g(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=g(()=>{const d=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[d]||"#d3d3d3"}),l=g(()=>{const d=i.value;return d==="starting"||d==="processing"||d==="pending-prompt"}),r=g(()=>{if(!o.value)return"No session selected";const d=i.value,p=d.charAt(0).toUpperCase()+d.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",_=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${_}: ${p}`});return(d,p)=>(u(),m("div",Li,[o.value?(u(),m("div",{key:0,class:G(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:He({width:"100%",backgroundColor:a.value}),title:r.value},null,14,Di)):(u(),m("div",Ii))]))}},ji=K(Pi,[["__scopeId","data-v-e8795bb7"]]),Ri={class:"session-status-bar border-top p-2 bg-light"},Vi={class:"d-flex justify-content-between align-items-center gap-2"},Hi={class:"d-flex gap-2"},Wi=["disabled"],Fi={class:"mode-label"},Ui=["disabled"],Bi=["disabled"],qi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ie(),o=fe(),i=g(()=>s.sessions.get(e.sessionId)),a=g(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},r=g(()=>l[a.value]||"ðŸ”’"),d=g(()=>a.value),p=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(v){console.error("Failed to cycle permission mode:",v)}return}const y=(p.indexOf(a.value)+1)%p.length,h=p[y];try{await s.setPermissionMode(e.sessionId,h)}catch(v){console.error("Failed to cycle permission mode:",v)}},_=()=>{o.showModal("session-info",{sessionId:e.sessionId})},b=()=>{o.showModal("manage-session",{session:i.value})},f=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return($,y)=>(u(),m("div",Ri,[t("div",Vi,[t("div",Hi,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[X(w(r.value)+" ",1),t("span",Fi,w(d.value),1)],8,Wi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!i.value},[...y[0]||(y[0]=[X(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,Ui),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:b,disabled:!i.value},[...y[1]||(y[1]=[X(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,Bi)]),t("div",null,[t("button",{class:G(["btn btn-sm",Xt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:f}," â¬‡ï¸ "+w(Xt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},zi=K(qi,[["__scopeId","data-v-fdcd3535"]]),Ie=$t("message",()=>{const n=A(new Map),e=A(new Map),s=A(new Map),o=A(new Map),i=A(new Map),a=A(new Map),l=A(new Map),r=g(()=>{const S=ie();return n.value.get(S.currentSessionId)||[]}),d=g(()=>{const S=ie();return e.value.get(S.currentSessionId)||[]});async function p(S,E=null,M=0){try{const N=E||1e4,V=await se.get(`/api/sessions/${S}/messages?limit=${N}&offset=${M}`),U=V.messages||[],ee=V.total_count||U.length,le=V.has_more||!1;if(console.log(`Loaded ${U.length} of ${ee} messages for session ${S}`),n.value.set(S,U),U.length>0){const te=U[U.length-1];te.timestamp&&(l.value.set(S,te.timestamp),console.log(`Tracked last received timestamp for session ${S}: ${te.timestamp}`))}const B=new Set;U.forEach(te=>{te.type==="assistant"&&te.metadata?.tool_uses&&te.metadata.tool_uses.forEach(z=>{B.add(z.id)}),te.type==="user"&&te.metadata?.tool_results&&te.metadata.tool_results.forEach(z=>{B.delete(z.tool_use_id);const ue=a.value.get(S);ue&&ue.delete(z.tool_use_id)}),te.type==="system"&&te.metadata?.subtype==="client_launched"&&(B.forEach(z=>{T(S,z,"Session was restarted")}),B.clear()),te.type==="system"&&te.metadata?.subtype==="interrupt"&&(B.forEach(z=>{T(S,z,"Session was interrupted")}),B.clear()),te.metadata?.has_tool_uses&&te.metadata.tool_uses&&te.metadata.tool_uses.forEach(z=>{$(S,z)}),te.metadata?.has_tool_results&&te.metadata.tool_results&&te.metadata.tool_results.forEach(z=>{v(S,z)}),(te.type==="permission_request"||te.metadata?.has_permission_requests)&&y(S,te),te.type==="system"&&(te.subtype==="init"||te.metadata?.subtype==="init")&&te.metadata?.init_data&&ie().storeInitData(S,te.metadata.init_data)});const ne=ie().sessions.get(S);return ne&&!["active","paused","starting"].includes(ne.state)&&(B.forEach(te=>{T(S,te,"Session was terminated")}),B.clear()),i.value.set(S,B),n.value=new Map(n.value),le&&console.warn(`Warning: Only loaded ${U.length} of ${ee} messages. Some messages may be missing.`),{messages:U,totalCount:ee,hasMore:le}}catch(N){throw console.error("Failed to load messages:",N),N}}function c(S,E){const M=i.value.get(S)||new Set;E.type==="assistant"&&E.metadata?.tool_uses&&E.metadata.tool_uses.forEach(N=>{M.add(N.id)}),E.type==="user"&&E.metadata?.tool_results&&E.metadata.tool_results.forEach(N=>{M.delete(N.tool_use_id);const V=a.value.get(S);V&&V.delete(N.tool_use_id)}),E.type==="system"&&E.metadata?.subtype==="client_launched"&&(M.forEach(N=>{T(S,N,"Session was restarted")}),M.clear()),E.type==="system"&&E.metadata?.subtype==="interrupt"&&(M.forEach(N=>{T(S,N,"Session was interrupted")}),M.clear()),i.value.set(S,M)}function _(S,E){n.value.has(S)||n.value.set(S,[]);const M=n.value.get(S);if(E.id){const N=M.findIndex(V=>V.id===E.id);if(N!==-1){console.log(`Skipping duplicate message ${E.id} (already exists at index ${N})`);return}}M.push(E),E.timestamp&&l.value.set(S,E.timestamp),c(S,E),n.value=new Map(n.value)}function b(S,E){e.value.has(S)||e.value.set(S,[]),e.value.get(S).push(E),e.value=new Map(e.value)}function f(S,E,M){const N=e.value.get(S);if(N){const V=N.find(U=>U.id===E);V&&(Object.assign(V,M),e.value=new Map(e.value))}}function $(S,E){const M=k(E.name,E.input);s.value.set(M,E.id);const N={id:E.id,name:E.name,input:E.input,signature:M,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return b(S,N),console.log(`Created tool call ${N.id} for ${N.name}`),N}function y(S,E){console.log("handlePermissionRequest received:",E);const M=E.metadata?.tool_name||E.tool_name,N=E.metadata?.input_params||E.input_params,V=E.metadata?.request_id||E.request_id,U=E.metadata?.suggestions||E.suggestions||[];console.log("Extracted data:",{toolName:M,inputParams:N,requestId:V,suggestions:U});const ee=k(M,N),le=s.value.get(ee);le?(o.value.set(V,le),f(S,le,{status:"permission_required",permissionRequestId:V,suggestions:U}),console.log(`Permission required for tool ${le}`,{suggestions:U})):console.warn("No tool use ID found for permission request signature:",ee,{toolName:M,inputParams:N,availableSignatures:Array.from(s.value.keys())})}function h(S,E){const M=o.value.get(E.request_id);if(M){const N={permissionDecision:E.decision,appliedUpdates:E.applied_updates||[]};E.decision==="allow"?N.status="executing":(N.status="completed",N.result={error:!0,message:E.reasoning||"Permission denied"},N.isExpanded=!1),f(S,M,N),console.log(`Permission ${E.decision} for tool ${M}`)}}function v(S,E){const M=E.tool_use_id;f(S,M,{status:E.is_error?"error":"completed",result:{error:E.is_error,content:E.content},isExpanded:!1}),console.log(`Tool ${M} ${E.is_error?"failed":"completed"}`)}function C(S,E){const M=e.value.get(S);if(M){const N=M.find(V=>V.id===E);N&&(N.isExpanded=!N.isExpanded,e.value=new Map(e.value))}}function k(S,E){if(!S)return"unknown:{}";if(!E||typeof E!="object")return`${S}:{}`;const M=JSON.stringify(E,Object.keys(E).sort());return`${S}:${M}`}function T(S,E,M){const N=a.value.get(S)||new Map;N.set(E,{reason:"denied",message:M}),a.value.set(S,N);const V=e.value.get(S);if(V){const U=V.find(ee=>ee.id===E);U&&U.isExpanded&&(U.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${E} as orphaned: ${M}`)}function D(S,E){return a.value.get(S)?.has(E)||!1}function I(S,E){return a.value.get(S)?.get(E)}function x(S,E){const M=i.value.get(S);M&&M.size>0&&(M.forEach(N=>T(S,N,E)),M.clear())}function O(S){n.value.delete(S),e.value.delete(S),n.value=new Map(n.value),e.value=new Map(e.value)}function q(S){return l.value.get(S)}async function R(S){const E=l.value.get(S);if(!E)return console.log(`No sync needed for session ${S} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${S} since ${E}`);const M=await se.get(`/api/sessions/${S}/messages?limit=1000&offset=0`),N=M.messages||[],V=M.has_more||!1,U=z=>z?typeof z=="number"?z*1e3:new Date(z).getTime():0,ee=U(E),le=N.filter(z=>z.timestamp?U(z.timestamp)>ee:!1);if(le.length===0)return console.log(`No missed messages for session ${S}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${le.length} missed messages for session ${S}`);const B=n.value.get(S)||[],W=new Set(B.map(z=>z.id).filter(Boolean)),ne=le.filter(z=>!z.id||!W.has(z.id));if(console.log(`After deduplication: ${ne.length} unique new messages`),ne.length>0){const z=ne.sort((Q,Z)=>{const he=U(Q.timestamp),kt=U(Z.timestamp);return he-kt}),ue=n.value.get(S)||[],H=ue.length>0?U(ue[ue.length-1].timestamp):0,F=U(z[0].timestamp),Y=U(z[z.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ue.length,lastExisting:H,lastExistingDate:ue.length>0?ue[ue.length-1].timestamp:"none",firstNew:F,firstNewDate:z[0].timestamp,lastNew:Y,lastNewDate:z[z.length-1].timestamp,shouldAppend:F>H}),F>H){const Q=[...ue,...z];n.value.set(S,Q),console.log(`âœ… Appended ${z.length} new messages (no full sort needed)`)}else{const Q=[...ue,...z].sort((Z,he)=>{const kt=U(Z.timestamp),Vt=U(he.timestamp);return kt-Vt});n.value.set(S,Q),console.log(`âš ï¸ Merged and sorted ${z.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${B.length} messages unchanged`);ne.forEach(z=>{c(S,z),z.metadata?.has_tool_uses&&z.metadata.tool_uses&&z.metadata.tool_uses.forEach(ue=>{$(S,ue)}),z.metadata?.has_tool_results&&z.metadata.tool_results&&z.metadata.tool_results.forEach(ue=>{v(S,ue)}),(z.type==="permission_request"||z.metadata?.has_permission_requests)&&y(S,z),z.type==="system"&&(z.subtype==="init"||z.metadata?.subtype==="init")&&z.metadata?.init_data&&ie().storeInitData(S,z.metadata.init_data)});const te=n.value.get(S);if(te&&te.length>0){const z=te[te.length-1];z.timestamp&&l.value.set(S,z.timestamp)}return n.value=new Map(n.value),{syncedCount:ne.length,hasMore:V}}catch(M){return console.error(`Failed to sync messages for session ${S}:`,M),{syncedCount:0,hasMore:!1,error:M.message}}}const P=ie();return ce(()=>Array.from(P.sessions.values()).map(E=>({id:E.session_id,state:E.state})),(S,E)=>{E&&S.forEach((M,N)=>{const V=E[N];if(!V||V.id!==M.id)return;const U=["active","paused","starting"].includes(V.state),ee=!["active","paused","starting"].includes(M.state);U&&ee&&x(M.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:vn(i),orphanedToolUses:vn(a),currentMessages:r,currentToolCalls:d,loadMessages:p,addMessage:_,addToolCall:b,updateToolCall:f,handleToolUse:$,handlePermissionRequest:y,handlePermissionResponse:h,handleToolResult:v,toggleToolExpansion:C,clearMessages:O,markToolUseOrphaned:T,isToolUseOrphaned:D,getOrphanedInfo:I,clearOrphanedToolUses:x,getLastReceivedTimestamp:q,syncMessages:R}}),Ki=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ie},Symbol.toStringTag,{value:"Module"}));function Gi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Lt(n){return Gi(n).toLocaleTimeString()}const Yi={class:"message-row message-row-user"},Ji=["title"],Xi={class:"message-content-column"},Qi=["innerHTML"],Zi={key:0,class:"tool-results mt-2"},ea={class:"tool-results-header text-muted small mb-2"},ta={class:"d-flex align-items-start gap-2"},sa={class:"flex-grow-1"},na={class:"text-muted"},oa={key:0,class:"text-danger small"},ia={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;nt.setOptions({breaks:!0,gfm:!0});const s=g(()=>Lt(e.message.timestamp)),o=g(()=>`user
${s.value}`),i=g(()=>{const d=e.message.content||"";let p=nt.parse(d);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),ns.sanitize(p)}),a=g(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=g(()=>e.message.metadata?.tool_results||[]);function r(d,p){return d?d.length<=p?d:d.substring(0,p)+"...":""}return(d,p)=>(u(),m("div",Yi,[t("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,Ji),t("div",Xi,[t("div",{class:"message-text",innerHTML:i.value},null,8,Qi),a.value?(u(),m("div",Zi,[t("div",ea," ðŸ”§ Tool Results ("+w(l.value.length)+") ",1),(u(!0),m(ae,null,de(l.value,(c,_)=>(u(),m("div",{key:_,class:G(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",ta,[t("span",null,w(c.is_error?"âŒ":"âœ…"),1),t("div",sa,[t("small",na,"Tool: "+w(c.tool_use_id),1),c.is_error?(u(),m("div",oa,w(r(c.content,200)),1)):L("",!0)])])],2))),128))])):L("",!0)])]))}},aa=K(ia,[["__scopeId","data-v-7665755b"]]),la={class:"thinking-block"},ra=["aria-label"],ca={class:"text-muted ms-auto"},da={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ua=["innerHTML"],ma={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=A(!1),o=g(()=>e.thinking?.length||0),i=g(()=>{const l=e.thinking||"",r=nt.parse(l);return ns.sanitize(r)});function a(){s.value=!s.value}return(l,r)=>(u(),m("div",la,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[t("span",{"aria-label":s.value?"Collapse":"Expand"},w(s.value?"â–¾":"â–¸"),9,ra),r[0]||(r[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",ca,w(o.value)+" characters",1)]),s.value?(u(),m("div",da,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,ua)])):L("",!0)]))}},pa=K(ma,[["__scopeId","data-v-fda2352c"]]),je=$t("websocket",()=>{const n=A(null),e=A(!1),s=A(0),o=10,i=A(null),a=A(!1),l=A(0),r=5,d=A(null);let p=null;const c=A(0),_=A(null),b=A(new Map),f=A(null),$=A(!1),y=A(0),h=5,v=A(null),C=1e4,k=1e3,T=A(Date.now()),D=A(Date.now()),I=A(Date.now());let x=null,O=null,q=null;const R=g(()=>e.value&&(a.value||!d.value)?"connected":e.value?"partial":"disconnected");function P(H){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${H}`}function S(H){const F={ui:{timer:()=>x,setTimer:Y=>{x=Y},lastPing:T,connected:e,name:"UI"},session:{timer:()=>O,setTimer:Y=>{O=Y},lastPing:D,connected:a,name:"Session"},legion:{timer:()=>q,setTimer:Y=>{q=Y},lastPing:I,connected:$,name:"Legion"}}[H];F.timer()&&clearInterval(F.timer()),F.setTimer(setInterval(()=>{if(!F.connected.value)return;const Y=Date.now()-F.lastPing.value;if(Y>C){console.warn(`âš ï¸ ${F.name} WebSocket heartbeat timeout (${Y}ms since last ping) - forcing close to trigger reconnection`),F.connected.value=!1;const Z={ui:n,session:i,legion:f}[H];Z.value&&Z.value.readyState===WebSocket.OPEN&&Z.value.close()}},k)),console.log(`âœ… Started heartbeat monitor for ${F.name} WebSocket`)}function E(H){const F={ui:{get:()=>x,set:Y=>{x=Y}},session:{get:()=>O,set:Y=>{O=Y}},legion:{get:()=>q,set:Y=>{q=Y}}}[H];F.get()&&(clearInterval(F.get()),F.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${H} WebSocket`))}function M(){if(n.value)return;const H=P("/ws/ui");console.log(`Connecting to UI WebSocket: ${H}`),n.value=new WebSocket(H),n.value.onopen=()=>{e.value=!0,s.value=0,T.value=Date.now(),S("ui"),console.log("UI WebSocket connected")},n.value.onmessage=F=>{const Y=JSON.parse(F.data);W(Y)},n.value.onclose=()=>{if(E("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const F=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${F}ms (attempt ${s.value})`),setTimeout(M,F)}},n.value.onerror=F=>{console.error("UI WebSocket error:",F)}}function N(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function V(H){c.value++;const F=c.value;if(console.log(`[Gen ${F}] Starting connection to session ${H}`),p&&(clearTimeout(p),p=null),await U(),c.value!==F){console.log(`[Gen ${F}] Connection cancelled (current generation: ${c.value})`);return}d.value=H,_.value=F;const Y=P(`/ws/session/${H}`);console.log(`[Gen ${F}] Connecting to Session WebSocket: ${Y}`),i.value=new WebSocket(Y),i.value.onopen=async()=>{if(_.value!==F){console.log(`[Gen ${F}] Ignoring onopen (stale connection, current: ${_.value})`),i.value.close();return}a.value=!0,l.value=0,D.value=Date.now(),S("session"),console.log(`[Gen ${F}] Session WebSocket connected for ${H}`);const Q=b.value.get(H);if(b.value.set(H,!0),Q){console.log(`[Gen ${F}] Reconnection detected, syncing missed messages...`);try{const he=await Ie().syncMessages(H);he.syncedCount>0?console.log(`[Gen ${F}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${F}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${F}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${F}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(Z){console.error(`[Gen ${F}] Error during message sync:`,Z)}}else console.log(`[Gen ${F}] Initial connection, no sync needed`)},i.value.onmessage=Q=>{if(_.value!==F){console.log(`[Gen ${F}] Ignoring message (stale connection, current: ${_.value})`);return}const Z=JSON.parse(Q.data);ne(Z,H)},i.value.onclose=()=>{E("session"),a.value=!1,i.value=null,console.log(`[Gen ${F}] Session WebSocket closed for ${H}`);const Q=ie();if(Q.currentSessionId===H&&_.value===F&&l.value<r){l.value++;const Z=Math.min(2e3*l.value,3e4);console.log(`[Gen ${F}] Reconnecting Session WebSocket in ${Z}ms (attempt ${l.value})`),p=setTimeout(()=>{_.value===F&&Q.currentSessionId===H?(p=null,V(H)):console.log(`[Gen ${F}] Skipping reconnect (generation or session changed)`)},Z)}},i.value.onerror=Q=>{console.error(`[Gen ${F}] Session WebSocket error:`,Q)}}function U(){return new Promise(H=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),i.value){const F=d.value,Y=()=>{i.value=null,a.value=!1,d.value=null,_.value=null,l.value=0,F&&b.value.delete(F),H()};if(i.value.readyState===WebSocket.CLOSED)Y();else{const Q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),Y()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Q),Y()},{once:!0}),i.value.close()}}else d.value=null,_.value=null,H()})}function ee(H){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:H})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function le(H,F,Y=!1,Q=null){if(i.value&&a.value){const Z={type:"permission_response",request_id:H,decision:F,apply_suggestions:Y,timestamp:new Date().toISOString()};Q&&(Z.clarification_message=Q),i.value.send(JSON.stringify(Z)),console.log(`Sent permission ${F} for request ${H}`,{applySuggestions:Y,clarification:Q})}}function B(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function W(H){const F=ie(),Y=ge();switch(H.type){case"sessions_list":H.sessions&&Array.isArray(H.sessions)&&H.sessions.forEach(Q=>{F.updateSession(Q.session_id,Q)});break;case"state_change":H.data&&H.data.session_id&&H.data.session&&F.updateSession(H.data.session_id,H.data.session);break;case"project_updated":if(H.data&&H.data.project){const Q=H.data.project;Y.updateProjectLocal(Q.project_id,Q)}break;case"project_deleted":H.data&&H.data.project_id&&Y.projects.delete(H.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":T.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",H.type)}}function ne(H,F){const Y=ie();if(Y.currentSessionId!==F){console.warn(`Ignoring message for session ${F} (current: ${Y.currentSessionId})`);return}const Q=Ie();switch(H.type){case"message":const Z=H.data;if(!Z||!Z.type){console.warn("Received message event with invalid data:",H);break}if(Z.type==="permission_request"){Q.handlePermissionRequest(F,Z);break}if(Z.type==="permission_response"){Q.handlePermissionResponse(F,Z);break}Z.metadata?.has_tool_uses&&Z.metadata.tool_uses.forEach(he=>{Q.handleToolUse(F,he)}),Z.metadata?.has_tool_results&&Z.metadata.tool_results.forEach(he=>{Q.handleToolResult(F,he)}),Z.type==="system"&&(Z.subtype==="init"||Z.metadata?.subtype==="init")&&Z.metadata?.init_data&&Y.storeInitData(F,Z.metadata.init_data),Q.addMessage(F,Z);break;case"permission_request":Q.handlePermissionRequest(F,H);break;case"permission_response":Q.handlePermissionResponse(F,H);break;case"tool_result":Q.handleToolResult(F,H);break;case"state_change":Y.updateSession(F,H.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${F}`);break;case"ping":D.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function te(H){z(),v.value=H;const F=P(`/ws/legion/${H}`);console.log(`Connecting to Legion WebSocket: ${F}`),f.value=new WebSocket(F),f.value.onopen=()=>{$.value=!0,y.value=0,I.value=Date.now(),S("legion"),console.log(`Legion WebSocket connected for ${H}`)},f.value.onmessage=Y=>{const Q=JSON.parse(Y.data);ue(Q,H)},f.value.onclose=()=>{if(E("legion"),$.value=!1,f.value=null,console.log(`Legion WebSocket closed for ${H}`),v.value===H&&y.value<h){y.value++;const Y=Math.min(2e3*y.value,3e4);setTimeout(()=>te(H),Y)}},f.value.onerror=Y=>{console.error("Legion WebSocket error:",Y)}}function z(){f.value&&(f.value.close(),f.value=null,$.value=!1,v.value=null)}function ue(H,F){be(async()=>{const{useLegionStore:Y}=await Promise.resolve().then(()=>Xh);return{useLegionStore:Y}},void 0).then(({useLegionStore:Y})=>{const Q=Y();switch(H.type){case"comm":H.comm&&(Q.addComm(F,H.comm),console.log("Legion WebSocket: Received new comm",H.comm));break;case"minion_created":H.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",H.data),be(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>_n);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"minion_updated":H.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",H.data),be(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>_n);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"channel_created":H.channel&&(console.log("Legion WebSocket: Channel created, updating list",H.channel),Q.addChannel(F,H.channel));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${F}`);break;case"ping":I.value=Date.now(),f.value?.readyState===WebSocket.OPEN&&f.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",H.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:a,sessionRetryCount:l,legionConnected:$,legionRetryCount:y,overallStatus:R,connectUI:M,disconnectUI:N,connectSession:V,disconnectSession:U,sendMessage:ee,sendPermissionResponse:le,interruptSession:B,connectLegion:te,disconnectLegion:z}}),fa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:je},Symbol.toStringTag,{value:"Module"})),va={class:"base-tool-handler"},ha={class:"tool-section"},_a={class:"tool-parameters"},ga={class:"tool-code"},ba={key:0,class:"tool-section"},ya={class:"tool-section-label"},$a={class:"tool-code"},wa={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=g(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,r)=>(u(),m("div",va,[t("div",ha,[r[0]||(r[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",_a,[t("pre",ga,w(s.value),1)])]),o.value?(u(),m("div",ba,[t("div",ya,w(i.value?"Error:":"Result:"),1),t("div",{class:G(["tool-result",{"tool-result-error":i.value}])},[t("pre",$a,w(a.value),1)],2)])):L("",!0)]))}},Ea=K(wa,[["__scopeId","data-v-1e69f57d"]]),Ca={class:"read-tool-handler"},Sa={class:"tool-section"},ka={class:"read-file-info"},Ta={class:"file-path"},xa={key:0,class:"read-range"},Ma={key:0,class:"tool-section"},Aa={key:0,class:"tool-result tool-result-error"},Oa={class:"tool-code"},Na={key:1,class:"file-content-preview"},La={class:"content-header"},Da={class:"line-count-badge"},Ia={key:0,class:"preview-note"},Pa={class:"tool-code content-display"},ja={key:0,class:"more-indicator"},fs=100,Ra={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>{const f=e.toolCall.input?.offset,$=e.toolCall.input?.limit;return f!==void 0||$!==void 0}),i=g(()=>{const f=e.toolCall.input?.offset;return f!==void 0?f+1:1}),a=g(()=>{const f=e.toolCall.input?.offset||0,$=e.toolCall.input?.limit;return $!==void 0?f+$:"âˆž"}),l=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=g(()=>{if(!l.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),p=g(()=>r.value||!d.value?[]:d.value.split(`
`)),c=g(()=>p.value.length),_=g(()=>c.value>fs),b=g(()=>r.value?"":p.value.slice(0,fs).join(`
`));return(f,$)=>(u(),m("div",Ca,[t("div",Sa,[t("div",ka,[$[0]||($[0]=t("span",{class:"file-icon"},"ðŸ“„",-1)),$[1]||($[1]=t("strong",null,"Reading:",-1)),t("code",Ta,w(s.value),1),o.value?(u(),m("span",xa,"Lines "+w(i.value)+"-"+w(a.value),1)):L("",!0)])]),l.value?(u(),m("div",Ma,[r.value?(u(),m("div",Aa,[t("pre",Oa,w(d.value),1)])):(u(),m("div",Na,[t("div",La,[$[2]||($[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Da,w(c.value)+" lines",1),_.value?(u(),m("span",Ia,"(showing first "+w(fs)+")")):L("",!0)]),t("pre",Pa,w(b.value),1),_.value?(u(),m("div",ja,"...")):L("",!0)]))])):L("",!0)]))}},Va=K(Ra,[["__scopeId","data-v-1f2b0569"]]),Ha={class:"write-tool-handler"},Wa={class:"tool-section"},Fa={class:"write-file-info mb-2"},Ua={class:"file-path"},Ba={class:"write-content-preview"},qa={class:"content-header"},za={class:"line-count-badge"},Ka={key:0,class:"preview-note"},Ga={class:"tool-code content-display"},Ya={key:0,class:"more-indicator"},Ja={key:0,class:"tool-section"},Xa={key:0,class:"tool-result tool-result-error"},Qa={class:"tool-code"},Za={key:1,class:"tool-result tool-result-success"},el={class:"success-message"},vs=100,tl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.content||""),i=g(()=>o.value.split(`
`)),a=g(()=>i.value.length),l=g(()=>a.value>vs),r=g(()=>i.value.slice(0,vs).join(`
`)),d=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>{if(!d.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,b)=>(u(),m("div",Ha,[t("div",Wa,[t("div",Fa,[b[0]||(b[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),b[1]||(b[1]=t("strong",null,"Writing:",-1)),t("code",Ua,w(s.value),1)]),t("div",Ba,[t("div",qa,[b[2]||(b[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",za,w(a.value)+" lines",1),l.value?(u(),m("span",Ka,"(showing first "+w(vs)+")")):L("",!0)]),t("pre",Ga,w(r.value),1),l.value?(u(),m("div",Ya,"...")):L("",!0)])]),d.value?(u(),m("div",Ja,[p.value?(u(),m("div",Xa,[b[3]||(b[3]=t("strong",null,"Error:",-1)),t("pre",Qa,w(c.value),1)])):(u(),m("div",Za,[t("div",el,[b[4]||(b[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+w(a.value)+" lines written)",1)])]))])):L("",!0)]))}},sl=K(tl,[["__scopeId","data-v-ddc24a0f"]]),nl={class:"bash-tool-handler"},ol={class:"tool-section"},il={class:"bash-header"},al={class:"bash-header-content"},ll={key:0,class:"bash-description"},rl={key:1,class:"bash-flags"},cl={class:"bash-command-section"},dl={class:"bash-command-content"},ul={key:0,class:"tool-section"},ml={key:0,class:"bash-output"},pl={key:1,class:"bash-output-empty"},fl={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.command||""),o=g(()=>e.toolCall.input?.description||""),i=g(()=>e.toolCall.input?.timeout),a=g(()=>e.toolCall.input?.run_in_background||!1),l=g(()=>i.value||a.value),r=g(()=>{const b=[];return i.value&&b.push(`timeout: ${i.value}ms`),a.value&&b.push("background"),b.join(", ")}),d=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>p.value?"tool-result-error":"tool-result-success"),_=g(()=>{if(!d.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,f)=>(u(),m("div",nl,[t("div",ol,[t("div",il,[f[1]||(f[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",al,[o.value?(u(),m("div",ll,[f[0]||(f[0]=t("strong",null,"Description:",-1)),X(" "+w(o.value),1)])):L("",!0),l.value?(u(),m("div",rl,w(r.value),1)):L("",!0)])]),t("div",cl,[f[2]||(f[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",dl,w(s.value),1)])]),d.value?(u(),m("div",ul,[t("div",{class:G(["tool-result",c.value])},[f[3]||(f[3]=t("strong",null,"Output:",-1)),_.value?(u(),m("pre",ml,w(_.value),1)):(u(),m("div",pl,"No output"))],2)])):L("",!0)]))}},vl=K(fl,[["__scopeId","data-v-ab50fe73"]]),hl={class:"todo-tool-handler"},_l={class:"tool-section"},gl={class:"todo-header"},bl={class:"todo-summary"},yl={key:0,class:"todo-count todo-count-completed"},$l={key:1,class:"todo-count todo-count-in-progress"},wl={key:2,class:"todo-count todo-count-pending"},El={class:"todo-checklist"},Cl={class:"todo-checkbox"},Sl={class:"todo-content"},kl={key:0,class:"tool-section"},Tl={key:0,class:"tool-result tool-result-error"},xl={class:"tool-code"},Ml={key:1,class:"tool-result tool-result-success"},Al={class:"success-message"},Ol={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.todos||[]),o=g(()=>s.value.filter(c=>c.status==="completed").length),i=g(()=>s.value.filter(c=>c.status==="in_progress").length),a=g(()=>s.value.filter(c=>c.status==="pending").length);function l(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const r=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=g(()=>{if(!r.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,_)=>(u(),m("div",hl,[t("div",_l,[t("div",gl,[_[0]||(_[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),_[1]||(_[1]=t("strong",null,"Task List:",-1)),t("div",bl,[o.value>0?(u(),m("span",yl,w(o.value)+" completed ",1)):L("",!0),i.value>0?(u(),m("span",$l,w(i.value)+" in progress ",1)):L("",!0),a.value>0?(u(),m("span",wl,w(a.value)+" pending ",1)):L("",!0)])]),t("div",El,[(u(!0),m(ae,null,de(s.value,(b,f)=>(u(),m("div",{key:f,class:G(["todo-item",`todo-${b.status}`])},[t("span",Cl,w(l(b.status)),1),t("span",Sl,w(b.content),1)],2))),128))])]),r.value?(u(),m("div",kl,[d.value?(u(),m("div",Tl,[_[2]||(_[2]=t("strong",null,"Error:",-1)),t("pre",xl,w(p.value),1)])):(u(),m("div",Ml,[t("div",Al,[_[3]||(_[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+w(s.value.length)+" tasks)",1)])]))])):L("",!0)]))}},Nl=K(Ol,[["__scopeId","data-v-bbe55ee7"]]),Ll={class:"edit-tool-handler"},Dl={class:"tool-section"},Il={class:"edit-file-info"},Pl={class:"file-path"},jl={key:0,class:"replace-all-badge"},Rl={class:"edit-diff-container"},Vl={class:"diff-header"},Hl={class:"diff-stats"},Wl={class:"stat-removed"},Fl={class:"stat-added"},Ul={class:"unified-diff"},Bl={class:"diff-scroll-container"},ql={class:"diff-marker"},zl={class:"diff-content"},Kl={key:0,class:"tool-section"},Gl={key:0,class:"tool-result tool-result-error"},Yl={class:"tool-code"},Jl={key:1,class:"tool-result tool-result-success"},Xl={class:"success-message"},Ql={key:0,class:"success-detail"},Zl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.old_string||""),i=g(()=>e.toolCall.input?.new_string||""),a=g(()=>e.toolCall.input?.replace_all||!1),l=g(()=>{const f=bi(s.value,o.value,i.value,"","",{context:3}).split(`
`),$=[];for(let y=4;y<f.length;y++){const h=f[y];h&&(h.startsWith("-")?$.push({type:"removed",content:h.substring(1)}):h.startsWith("+")?$.push({type:"added",content:h.substring(1)}):h.startsWith(" ")?$.push({type:"context",content:h.substring(1)}):h.startsWith("@@")&&$.push({type:"hunk",content:h}))}return $}),r=g(()=>l.value.filter(b=>b.type==="removed").length),d=g(()=>l.value.filter(b=>b.type==="added").length),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=g(()=>{if(!p.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,f)=>(u(),m("div",Ll,[t("div",Dl,[t("div",Il,[f[0]||(f[0]=t("span",{class:"file-icon"},"âœï¸",-1)),f[1]||(f[1]=t("strong",null,"Editing:",-1)),t("code",Pl,w(s.value),1),a.value?(u(),m("span",jl,"Replace All")):L("",!0)]),t("div",Rl,[t("div",Vl,[f[2]||(f[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Hl,[t("span",Wl,"-"+w(r.value),1),t("span",Fl,"+"+w(d.value),1)])]),t("div",Ul,[t("div",Bl,[(u(!0),m(ae,null,de(l.value,($,y)=>(u(),m("div",{key:y,class:G(["diff-line",{"diff-line-removed":$.type==="removed","diff-line-added":$.type==="added","diff-line-context":$.type==="context","diff-line-hunk":$.type==="hunk"}])},[t("span",ql,w($.type==="removed"?"-":$.type==="added"?"+":$.type==="hunk"?"@":" "),1),t("span",zl,w($.content),1)],2))),128))])])])]),p.value?(u(),m("div",Kl,[c.value?(u(),m("div",Gl,[f[3]||(f[3]=t("strong",null,"Error:",-1)),t("pre",Yl,w(_.value),1)])):(u(),m("div",Jl,[t("div",Xl,[f[4]||(f[4]=t("span",{class:"success-icon"},"âœ…",-1)),f[5]||(f[5]=t("strong",null,"File edited successfully",-1)),a.value?(u(),m("span",Ql,"(all occurrences replaced)")):L("",!0)])]))])):L("",!0)]))}},er=K(Zl,[["__scopeId","data-v-dd74055e"]]),tr={class:"search-tool-handler"},sr={class:"tool-section"},nr={class:"search-info"},or={class:"search-icon"},ir={class:"search-pattern"},ar={key:0,class:"search-path"},lr={key:1,class:"search-filters"},rr={key:0,class:"filter-badge"},cr={key:1,class:"filter-badge"},dr={key:2,class:"filter-badge"},ur={key:0,class:"tool-section"},mr={key:0,class:"tool-result tool-result-error"},pr={class:"tool-code"},fr={key:1,class:"search-results"},vr={class:"results-header"},hr={class:"results-label"},_r={class:"results-count-badge"},gr={class:"results-content"},br={class:"tool-code"},yr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="Grep");g(()=>e.toolCall.name==="Glob");const o=g(()=>e.toolCall.input?.pattern||"Unknown"),i=g(()=>e.toolCall.input?.path||null),a=g(()=>e.toolCall.input?.type||null),l=g(()=>e.toolCall.input?.glob||null),r=g(()=>e.toolCall.input?.["-i"]||!1),d=g(()=>a.value||l.value||r.value),p=g(()=>s.value?"ðŸ”":"ðŸ“"),c=g(()=>s.value?"Searching content":"Finding files"),_=g(()=>s.value?"Matches":"Files found"),b=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=g(()=>{if(!b.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),y=g(()=>!b.value||f.value||!$.value?0:$.value.split(`
`).filter(v=>v.trim()).length);return(h,v)=>(u(),m("div",tr,[t("div",sr,[t("div",nr,[t("span",or,w(p.value),1),t("strong",null,w(c.value)+":",1),t("code",ir,w(o.value),1),i.value?(u(),m("span",ar,"in "+w(i.value),1)):L("",!0),d.value?(u(),m("span",lr,[a.value?(u(),m("span",rr,"type: "+w(a.value),1)):L("",!0),l.value?(u(),m("span",cr,"glob: "+w(l.value),1)):L("",!0),r.value?(u(),m("span",dr,"case-insensitive")):L("",!0)])):L("",!0)])]),b.value?(u(),m("div",ur,[f.value?(u(),m("div",mr,[v[0]||(v[0]=t("strong",null,"Error:",-1)),t("pre",pr,w($.value),1)])):(u(),m("div",fr,[t("div",vr,[t("span",hr,w(_.value)+":",1),t("span",_r,w(y.value)+" "+w(y.value===1?"match":"matches"),1)]),t("div",gr,[t("pre",br,w($.value),1)])]))])):L("",!0)]))}},gn=K(yr,[["__scopeId","data-v-0d272c39"]]),$r={class:"web-tool-handler"},wr={class:"tool-section"},Er={class:"web-info"},Cr={class:"web-icon"},Sr=["href"],kr={key:1,class:"web-query"},Tr={key:0,class:"web-prompt-container"},xr={class:"prompt-content"},Mr={key:1,class:"web-domains"},Ar={class:"domains-label"},Or={key:0,class:"tool-section"},Nr={key:0,class:"tool-result tool-result-error"},Lr={class:"tool-code"},Dr={key:1,class:"web-results"},Ir={class:"results-header"},Pr={class:"results-label"},jr={class:"results-content"},Rr={class:"tool-code"},Vr={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="WebFetch");g(()=>e.toolCall.name==="WebSearch");const o=g(()=>e.toolCall.input?.url||null),i=g(()=>e.toolCall.input?.query||null),a=g(()=>e.toolCall.input?.prompt||null),l=g(()=>e.toolCall.input?.allowed_domains||[]),r=g(()=>e.toolCall.input?.blocked_domains||[]),d=g(()=>l.value.length>0?l.value:r.value.length>0?r.value:[]),p=g(()=>l.value.length>0?"Allowed domains":r.value.length>0?"Blocked domains":"Domains"),c=g(()=>s.value?"ðŸŒ":"ðŸ”Ž"),_=g(()=>s.value?"Fetching URL":"Searching web"),b=g(()=>s.value?"Fetched content":"Search results"),f=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!f.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,v)=>(u(),m("div",$r,[t("div",wr,[t("div",Er,[t("span",Cr,w(c.value),1),t("strong",null,w(_.value)+":",1),o.value?(u(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},w(o.value),9,Sr)):i.value?(u(),m("code",kr,w(i.value),1)):L("",!0)]),a.value?(u(),m("div",Tr,[v[0]||(v[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",xr,w(a.value),1)])):L("",!0),d.value.length>0?(u(),m("div",Mr,[t("span",Ar,w(p.value)+":",1),(u(!0),m(ae,null,de(d.value,C=>(u(),m("span",{key:C,class:"domain-badge"},w(C),1))),128))])):L("",!0)]),f.value?(u(),m("div",Or,[$.value?(u(),m("div",Nr,[v[1]||(v[1]=t("strong",null,"Error:",-1)),t("pre",Lr,w(y.value),1)])):(u(),m("div",Dr,[t("div",Ir,[t("span",Pr,w(b.value)+":",1)]),t("div",jr,[t("pre",Rr,w(y.value),1)])]))])):L("",!0)]))}},bn=K(Vr,[["__scopeId","data-v-62b55b55"]]),Hr={class:"task-tool-handler"},Wr={class:"tool-section"},Fr={class:"task-header"},Ur={key:0,class:"agent-type-badge"},Br={key:0,class:"task-description"},qr={class:"description-content"},zr={key:1,class:"task-prompt-container"},Kr={class:"prompt-header"},Gr={class:"prompt-length"},Yr={class:"prompt-code"},Jr={key:0,class:"tool-section"},Xr={key:0,class:"tool-result tool-result-error"},Qr={class:"tool-code"},Zr={key:1,class:"agent-output"},ec={class:"output-header"},tc={key:0,class:"output-count-badge"},sc={class:"output-content"},nc={class:"tool-code"},oc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.description||null),o=g(()=>e.toolCall.input?.prompt||null),i=g(()=>e.toolCall.input?.subagent_type||null),a=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=g(()=>{if(!a.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),d=g(()=>r.value?r.value.split(`
`).length:0);return(p,c)=>(u(),m("div",Hr,[t("div",Wr,[t("div",Fr,[c[0]||(c[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=t("strong",null,"Agent Task:",-1)),i.value?(u(),m("span",Ur,w(i.value),1)):L("",!0)]),s.value?(u(),m("div",Br,[c[2]||(c[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",qr,w(s.value),1)])):L("",!0),o.value?(u(),m("div",zr,[t("div",Kr,[c[3]||(c[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Gr,w(o.value.length)+" characters",1)]),t("pre",Yr,w(o.value),1)])):L("",!0)]),a.value?(u(),m("div",Jr,[l.value?(u(),m("div",Xr,[c[4]||(c[4]=t("strong",null,"Error:",-1)),t("pre",Qr,w(r.value),1)])):(u(),m("div",Zr,[t("div",ec,[c[5]||(c[5]=t("span",{class:"output-label"},"Agent Output:",-1)),d.value>0?(u(),m("span",tc,w(d.value)+" lines",1)):L("",!0)]),t("div",sc,[t("pre",nc,w(r.value),1)])]))])):L("",!0)]))}},ic=K(oc,[["__scopeId","data-v-c520c244"]]),ac={class:"notebook-edit-tool-handler"},lc={class:"tool-section"},rc={class:"notebook-info"},cc={class:"file-path"},dc={class:"cell-info mt-2"},uc={class:"info-row"},mc={class:"info-row"},pc={key:0,class:"info-row"},fc={class:"badge bg-info"},vc={key:0,class:"source-preview mt-3"},hc={class:"preview-header"},_c={class:"preview-stats"},gc={class:"source-code"},bc={key:0,class:"tool-section"},yc={key:0},$c={key:1,class:"text-danger"},wc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.notebook_path||"Unknown"),o=g(()=>e.toolCall.input?.cell_id),i=g(()=>e.toolCall.input?.cell_type||"code"),a=g(()=>e.toolCall.input?.edit_mode||"replace"),l=g(()=>e.toolCall.input?.new_source||""),r=g(()=>l.value.split(`
`).length),d=g(()=>i.value==="code"?"bg-primary":"bg-secondary"),p=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const _=a.value;return _==="insert"?"Cell inserted successfully":_==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(_,b)=>(u(),m("div",ac,[t("div",lc,[t("div",rc,[b[0]||(b[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),b[1]||(b[1]=t("strong",null,"Notebook:",-1)),t("code",cc,w(s.value),1)]),t("div",dc,[t("div",uc,[b[2]||(b[2]=t("strong",null,"Cell ID:",-1)),t("code",null,w(o.value||"N/A"),1)]),t("div",mc,[b[3]||(b[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:G(["badge",d.value])},w(i.value),3)]),a.value?(u(),m("div",pc,[b[4]||(b[4]=t("strong",null,"Edit Mode:",-1)),t("span",fc,w(a.value),1)])):L("",!0)]),l.value?(u(),m("div",vc,[t("div",hc,[b[5]||(b[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",_c,w(r.value)+" lines",1)]),t("pre",gc,[t("code",null,w(l.value),1)])])):L("",!0)]),n.toolCall.result?(u(),m("div",bc,[b[6]||(b[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:G(["tool-result",p.value])},[n.toolCall.result.success!==!1?(u(),m("div",yc," âœ… "+w(c.value),1)):(u(),m("div",$c," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)])):L("",!0)]))}},Ec=K(wc,[["__scopeId","data-v-c81a9bcf"]]),Cc={class:"shell-tool-handler"},Sc={class:"tool-section"},kc={class:"shell-info"},Tc={class:"shell-icon"},xc={key:0,class:"shell-id"},Mc={key:0,class:"filter-info mt-2"},Ac={class:"filter-pattern"},Oc={key:0,class:"tool-section"},Nc={class:"result-header mb-2"},Lc={key:0,class:"mb-2"},Dc={class:"shell-output"},Ic={key:1,class:"mb-2"},Pc={class:"shell-output shell-output-error"},jc={key:0},Rc={key:1,class:"text-danger"},Vc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=g(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=g(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=g(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=g(()=>e.toolCall.input?.filter);function r(f,$){if(!f)return null;const y=new RegExp(`<${$}>([\\s\\S]*?)<\\/${$}>`,"i"),h=f.match(y);return h?h[1].trim():null}const d=g(()=>{const f=e.toolCall.result;if(!f)return null;let $=f;if(f.content&&($=f.content),typeof $=="string")return{status:r($,"status"),stdout:r($,"stdout"),stderr:r($,"stderr"),exit_code:r($,"exit_code")};if(Array.isArray($)){const y=$.find(h=>h.type==="text")?.text||"";return{status:r(y,"status"),stdout:r(y,"stdout"),stderr:r(y,"stderr"),exit_code:r(y,"exit_code")}}return{status:f.status||$.status,stdout:f.stdout||f.output||$.stdout||$.output,stderr:f.stderr||$.stderr,exit_code:f.exit_code||$.exit_code}});g(()=>{if(e.toolCall.name==="BashOutput"){const f=d.value;if(!f)return null;const $=[];return f.stdout&&$.push(f.stdout),f.stderr&&$.push(`[stderr]
${f.stderr}`),$.length>0?$.join(`

`):null}return null});const p=g(()=>d.value?.status),c=g(()=>{const f=p.value;return f==="running"?"bg-success":f==="completed"?"bg-secondary":f==="killed"||f==="terminated"?"bg-danger":"bg-info"}),_=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),b=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const f=d.value;if(f?.status==="running"&&!f.stdout&&!f.stderr)return"No new output since last check";if(f?.status==="failed")return`Shell failed (exit code ${f.exit_code||"unknown"})`}return"Operation completed"});return(f,$)=>(u(),m("div",Cc,[t("div",Sc,[t("div",kc,[t("span",Tc,w(s.value),1),t("strong",null,w(o.value)+":",1),a.value?(u(),m("code",xc,"Shell "+w(a.value),1)):L("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(u(),m("div",Mc,[$[0]||($[0]=t("strong",null,"Filter:",-1)),t("code",Ac,w(l.value),1)])):L("",!0)]),n.toolCall.result?(u(),m("div",Oc,[t("div",Nc,[t("strong",null,w(i.value)+":",1),p.value?(u(),m("span",{key:0,class:G(["badge",c.value])},w(p.value),3)):L("",!0)]),d.value?.stdout?(u(),m("div",Lc,[$[1]||($[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Dc,[t("pre",null,[t("code",null,w(d.value.stdout),1)])])])):L("",!0),d.value?.stderr?(u(),m("div",Ic,[$[2]||($[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Pc,[t("pre",null,[t("code",null,w(d.value.stderr),1)])])])):L("",!0),!d.value?.stdout&&!d.value?.stderr?(u(),m("div",{key:2,class:G(["tool-result",_.value])},[n.toolCall.result.success!==!1?(u(),m("div",jc," âœ… "+w(b.value),1)):(u(),m("div",Rc," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)):L("",!0)])):L("",!0)]))}},yn=K(Vc,[["__scopeId","data-v-86def281"]]),Hc={class:"skill-tool-handler"},Wc={key:0,class:"tool-section"},Fc={class:"d-flex align-items-center gap-2"},Uc={class:"text-muted small"},Bc={key:0,class:"skill-content-body"},qc={class:"skill-content-text"},zc={key:1,class:"tool-section mt-3"},Kc={class:"tool-result tool-result-error"},Gc={class:"tool-code"},Yc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ie(),i=A(!1);function a(){i.value=!i.value}g(()=>e.toolCall.input?.command||"Unknown Skill"),g(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),g(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const l=g(()=>{const b=o.currentSessionId;if(!b)return{running:null,content:null};const f=s.messagesBySession.get(b)||[],$=f.findIndex(v=>v.type==="user"&&v.metadata?.has_tool_results&&v.metadata?.tool_results?.some(C=>C.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let y=null,h=null;for(let v=$+1;v<Math.min($+3,f.length);v++){const C=f[v];if(C.type!=="user")continue;const k=C.content||"";k.includes("<command-message>")&&k.includes("skill is running")?y=C:k.startsWith("Base directory for this skill:")&&(h=C)}return{running:y,content:h}});g(()=>{const b=l.value.content;if(!b)return null;const $=(b.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return $&&$[1]?$[1].trim():null});const r=g(()=>{const b=l.value.content;if(!b)return"";const f=b.content||"",$=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return f.replace($,"").trim()}),d=g(()=>r.value.length>0),p=g(()=>r.value?r.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=g(()=>{if(!c.value)return"";const b=e.toolCall.result;return b?.message?b.message:b?.error?b.error:"An error occurred"});return(b,f)=>(u(),m("div",Hc,[d.value?(u(),m("div",Wc,[t("div",{class:"skill-content-header",onClick:a},[t("div",Fc,[t("i",{class:G(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),f[0]||(f[0]=t("strong",null,"Skill Content",-1)),t("span",Uc,"("+w(p.value)+" lines)",1)])]),i.value?(u(),m("div",Bc,[t("pre",qc,w(r.value),1)])):L("",!0)])):L("",!0),c.value?(u(),m("div",zc,[f[1]||(f[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Kc,[t("pre",Gc,w(_.value),1)])])):L("",!0)]))}},Jc=K(Yc,[["__scopeId","data-v-0a48ca0f"]]),Xc={class:"slashcommand-tool-handler"},Qc={key:0,class:"tool-section"},Zc={class:"d-flex align-items-center gap-2"},ed=["aria-label"],td={class:"text-muted small"},sd={key:0,class:"command-content-body"},nd={class:"command-content-text"},od={key:1,class:"tool-section mt-3"},id={class:"tool-result tool-result-error"},ad={class:"tool-code"},ld={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ie(),i=A(!1);function a(){i.value=!i.value}g(()=>e.toolCall.input?.command||"Unknown Command"),g(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),g(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const l=g(()=>{const b=o.currentSessionId;if(!b)return{running:null,content:null};const f=s.messagesBySession.get(b)||[],$=f.findIndex(v=>v.type==="user"&&v.metadata?.has_tool_results&&v.metadata?.tool_results?.some(C=>C.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let y=null,h=null;for(let v=$+1;v<Math.min($+3,f.length);v++){const C=f[v];if(C.type!=="user")continue;const k=C.content||"";k.includes("<command-message>")&&k.includes("<command-name>")&&k.includes("<command-args>")?y=C:k.includes("ARGUMENTS:")&&(h=C)}return{running:y,content:h}});g(()=>{const b=l.value.running;if(!b)return null;const $=(b.content||"").match(/<command-args>(.+?)<\/command-args>/s);return $&&$[1]?$[1].trim():null});const r=g(()=>{const b=l.value.content;if(!b)return"";const f=b.content||"",$=/\nARGUMENTS:.*$/s;return f.replace($,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),d=g(()=>r.value.length>0),p=g(()=>r.value?r.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=g(()=>{if(!c.value)return"";const b=e.toolCall.result;return b?.message?b.message:b?.error?b.error:"An error occurred"});return(b,f)=>(u(),m("div",Xc,[d.value?(u(),m("div",Qc,[t("div",{class:"command-content-header",onClick:a},[t("div",Zc,[t("span",{"aria-label":i.value?"Collapse":"Expand"},w(i.value?"â–¾":"â–¸"),9,ed),f[0]||(f[0]=t("strong",null,"Command Content",-1)),t("span",td,"("+w(p.value)+" lines)",1)])]),i.value?(u(),m("div",sd,[t("pre",nd,w(r.value),1)])):L("",!0)])):L("",!0),c.value?(u(),m("div",od,[f[1]||(f[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",id,[t("pre",ad,w(_.value),1)])])):L("",!0)]))}},rd=K(ld,[["__scopeId","data-v-15991acf"]]),cd={class:"exit-plan-mode-tool-handler"},dd={class:"tool-section"},ud={key:0,class:"plan-content mt-2"},md={class:"plan-text"},pd={key:0,class:"tool-section"},fd={key:0},vd={key:1,class:"text-danger"},hd={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.plan),o=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),m("div",cd,[t("div",dd,[a[1]||(a[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(u(),m("div",ud,[a[0]||(a[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",md,w(s.value),1)])):L("",!0)]),n.toolCall.result?(u(),m("div",pd,[a[2]||(a[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:G(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),m("div",fd," âœ… Permission mode reverted to default ")):(u(),m("div",vd," â— "+w(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):L("",!0)]))}},_d=K(hd,[["__scopeId","data-v-e2e3c781"]]),gd={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},bd={class:"tool-status-icon"},yd=["title"],$d={class:"d-flex align-items-center gap-2"},wd={class:"text-muted"},Ed=["aria-label"],Cd={key:0,class:"card-body"},Sd={key:0,class:"alert alert-warning mb-3"},kd={class:"d-flex align-items-center"},Td={class:"mb-0 small"},xd={key:1,class:"permission-prompt mt-3"},Md={class:"alert alert-warning mb-3"},Ad={class:"mb-0"},Od={class:"tool-name"},Nd={key:0,class:"suggestions-section mb-3"},Ld={class:"alert alert-info mb-0"},Dd={class:"suggestion-details p-2 bg-white rounded"},Id={class:"permission-buttons d-flex gap-2 mb-3"},Pd=["disabled"],jd=["disabled"],Rd=["disabled"],Vd={class:"guidance-section mt-3"},Hd=["disabled"],Wd=["disabled"],Fd={key:2,class:"mt-3"},Ud={class:"alert alert-warning mb-0"},Bd={class:"d-flex align-items-center"},qd={class:"mb-0 small"},zd={key:3,class:"tool-section"},Kd={class:"alert alert-danger mb-0"},Gd={key:0},Yd={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ie(),i=je(),a=A(!1),l=A(null),r=A(""),d=g(()=>s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),p=g(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c={Read:Va,Write:sl,Bash:vl,TodoWrite:Nl,Edit:er,Grep:gn,Glob:gn,WebFetch:bn,WebSearch:bn,Task:ic,NotebookEdit:Ec,BashOutput:yn,KillShell:yn,SlashCommand:rd,Skill:Jc,ExitPlanMode:_d},_=g(()=>{const R=e.toolCall.name;return c[R]?c[R]:Ea}),b=g(()=>{const R=[];switch(e.toolCall.status){case"pending":R.push("border-secondary");break;case"permission_required":R.push("border-warning");break;case"executing":R.push("border-primary");break;case"completed":y.value||e.toolCall.permissionDecision==="deny"?R.push("border-danger"):R.push("border-success");break;case"error":R.push("border-danger");break}return R.join(" ")}),f=g(()=>{switch(e.toolCall.status){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":y.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),$=g(()=>Lt(e.toolCall.timestamp)),y=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=g(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function v(R){if(!R)return"";const P=R.replace(/\\/g,"/").split("/");return P[P.length-1]}function C(R,P=200){return R?R.length<=P?R:R.substring(0,P)+"...":""}function k(R){if(!R)return null;if(R.content){const P=R.content.match(/exit code (\d+)/i);if(P)return parseInt(P[1])}return R.error?1:0}function T(R,P){const S=R?R.split(`
`).length:0;return{added:P?P.split(`
`).length:0,removed:S}}const D=g(()=>{const R=e.toolCall.name,P=e.toolCall.input||{},S=e.toolCall.result,E=e.toolCall.status;switch(R){case"Bash":case"Shell":case"Command":{const M=C(P.command,200);if(E==="completed"&&S){const N=k(S);return`Bash: ${M} (exit ${N})`}return`Bash: ${M}`}case"SlashCommand":{const M=C(P.command,200);return E==="completed"&&S?`SlashCommand: ${M}`:`SlashCommand: ${M}`}case"Edit":{const M=v(P.file_path);if(E==="completed"&&S&&!S.error){const{added:N,removed:V}=T(P.old_string,P.new_string);return N===V?`Edit: ${M} (${N} lines changed)`:`Edit: ${M} (${N} lines added, ${V} removed)`}return`Edit: ${M}`}case"Read":{const M=v(P.file_path);if(P.offset!==void 0||P.limit!==void 0){const V=(P.offset||0)+1,U=P.limit?(P.offset||0)+P.limit:"âˆž";return`Read: ${M} (lines ${V}-${U})`}return`Read: ${M} (full file)`}case"Write":{const M=v(P.file_path);if(E==="completed"&&S&&!S.error&&P.content){const N=P.content.split(`
`).length;return`Write: ${M} (${N} lines written)`}return`Write: ${M}`}case"Skill":{const M=P.command||"Unknown";return E==="completed"&&S?S.error?`Skill: ${M} (error)`:`Skill: ${M} (completed)`:`Skill: ${M}`}case"Task":{const M=P.subagent_type||"general",N=P.description||"Task";return E==="completed"&&S?S.error?`Task: (${M}) ${N} (error)`:`Task: (${M}) ${N} (completed)`:`Task: (${M}) ${N}`}case"TodoWrite":{if(P.todos&&Array.isArray(P.todos)){const M=P.todos.filter(U=>U.status==="completed").length,N=P.todos.length,V=P.todos.find(U=>U.status==="in_progress");return V?`Todo: Working on "${V.content}"`:`Todo: ${M}/${N} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const M=P.pattern||"",N=R==="Grep"?"Grep":"Glob";if(E==="completed"&&S&&!S.error){let V=0;return S.content&&(V=S.content.split(`
`).filter(ee=>ee.trim()).length),`${N}: "${M}" (${V} results)`}return`${N}: "${M}"`}case"WebFetch":case"WebSearch":{const M=P.url||P.query||"";if(R==="WebSearch"){const V=P.query||"",U=V.length>50?V.substring(0,50)+"...":V;return E==="completed"&&S?S.error?`Web: ${U} (error)`:`Web: ${U} (success)`:`Web: ${U}`}let N="";try{M&&(N=new URL(M.startsWith("http")?M:`https://${M}`).hostname)}catch{N=M.length>50?M.substring(0,50)+"...":M}return E==="completed"&&S?S.error?`Web: ${N} (error)`:`Web: ${N} (success)`:`Web: ${N||M}`}case"NotebookEdit":{const M=v(P.notebook_path),N=P.cell_number!==void 0?P.cell_number:"?",V=P.edit_mode||"replace";return`NotebookEdit: ${M} cell #${N} (${V})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${P.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${P.shell_id||"unknown"}`;default:return`${R}: executed`}}),I=g(()=>{const R=e.toolCall.name,P=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(R)?P.command||R:["Edit","Read","Write","NotebookEdit"].includes(R)&&(P.file_path||P.notebook_path)||R});function x(){const R=o.currentSessionId;R&&s.toggleToolExpansion(R,e.toolCall.id)}function O(R){return R.type==="setMode"?`Set permission mode to "${R.mode}"`:R.type==="allow"?`Allow tool: ${R.tool}`:JSON.stringify(R)}async function q(R,P,S=null){if(!a.value){a.value=!0,R==="allow"?l.value=P?"approve-apply":"approve":S?l.value="deny-guidance":l.value="deny";try{const E=o.currentSessionId;if(E){const M=P&&e.toolCall.suggestions?e.toolCall.suggestions:[];s.handlePermissionResponse(E,{request_id:e.toolCall.permissionRequestId,decision:R,reasoning:R==="allow"?"User allowed permission":"User denied permission",applied_updates:M})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,R,P,S)}catch(E){console.error("Failed to send permission response:",E)}finally{a.value=!1,l.value=null}}}return(R,P)=>(u(),m("div",{class:G(["tool-call-card card",b.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:x},[t("div",gd,[t("span",bd,w(f.value),1),t("strong",{class:"tool-name",title:I.value},w(D.value),9,yd)]),t("div",$d,[t("small",wd,w($.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},w(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Ed)])]),n.toolCall.isExpanded?(u(),m("div",Cd,[d.value?(u(),m("div",Sd,[t("div",kd,[P[6]||(P[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[P[5]||(P[5]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",Td,w(p.value?.message||"Session was terminated"),1)])])])):L("",!0),(u(),_e(oo(_.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!d.value?(u(),m("div",xd,[t("div",Md,[P[9]||(P[9]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",Ad,[P[7]||(P[7]=X("Claude wants to use the ",-1)),t("code",Od,w(n.toolCall.name),1),P[8]||(P[8]=X(" tool.",-1))])]),h.value?(u(),m("div",Nd,[t("div",Ld,[P[10]||(P[10]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),P[11]||(P[11]=t("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),t("div",Dd,[(u(!0),m(ae,null,de(n.toolCall.suggestions,(S,E)=>(u(),m("div",{key:E,class:"suggestion-item"},[t("code",null,w(O(S)),1)]))),128))]),P[12]||(P[12]=t("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):L("",!0),t("div",Id,[h.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:P[0]||(P[0]=S=>q("allow",!0)),disabled:a.value},w(a.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Pd)):L("",!0),t("button",{class:G(["btn",h.value?"btn-outline-success":"btn-success"]),onClick:P[1]||(P[1]=S=>q("allow",!1)),disabled:a.value},w(a.value&&l.value==="approve"?"â³ Submitting...":h.value?"âœ… Approve Only":"âœ… Approve"),11,jd),t("button",{class:"btn btn-danger",onClick:P[2]||(P[2]=S=>q("deny",!1)),disabled:a.value}," ðŸš« "+w(a.value&&l.value==="deny"?"Submitting...":"Deny"),9,Rd)]),t("div",Vd,[P[13]||(P[13]=t("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),P[14]||(P[14]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),oe(t("textarea",{"onUpdate:modelValue":P[3]||(P[3]=S=>r.value=S),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Hd),[[pe,r.value]]),r.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:P[4]||(P[4]=S=>q("deny",!1,r.value)),disabled:a.value},w(a.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Wd)):L("",!0)])])):L("",!0),n.toolCall.status==="permission_required"&&d.value?(u(),m("div",Fd,[t("div",Ud,[t("div",Bd,[P[16]||(P[16]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[P[15]||(P[15]=t("strong",null,"Permission Request Cancelled",-1)),t("p",qd,w(p.value?.message||"Session was terminated before permission could be granted"),1)])])])])):L("",!0),n.toolCall.permissionDecision==="deny"?(u(),m("div",zd,[t("div",Kd,[P[17]||(P[17]=X(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(u(),m("span",Gd," - "+w(n.toolCall.result.message),1)):L("",!0)])])):L("",!0)])):L("",!0)],2))}},Jd=K(Yd,[["__scopeId","data-v-7a2b68db"]]),Xd={class:"message-row message-row-assistant"},Qd=["title"],Zd={class:"message-content-column"},eu={key:0,class:"thinking-block mb-2"},tu=["innerHTML"],su={key:2,class:"tool-calls"},nu={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ie();nt.setOptions({breaks:!0,gfm:!0});const i=g(()=>Lt(e.message.timestamp)),a=g(()=>e.message.metadata?.model||null),l=g(()=>{const $=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${$}`}),r=g(()=>{const $=e.message.content||"";return $.trim().length>0&&$!=="Assistant response"}),d=g(()=>{const $=e.message.content||"";let y=nt.parse($);return y=y.replace(/\n</g,"<"),y=y.replace(/\n+$/,""),ns.sanitize(y)}),p=g(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=g(()=>e.message.metadata?.thinking_content||""),_=g(()=>e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0),b=g(()=>e.message.metadata?.tool_uses||[]),f=g(()=>{const $=o.currentSessionId;if(!$)return[];const y=s.toolCallsBySession.get($)||[];return b.value.map(h=>{const v=y.find(C=>C.id===h.id);return v||{id:h.id,name:h.name,input:h.input,status:"pending",result:null,timestamp:h.timestamp||e.message.timestamp,isExpanded:!0}})});return($,y)=>(u(),m("div",Xd,[t("div",{class:"message-speaker",title:l.value},[...y[0]||(y[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Qd),t("div",Zd,[p.value?(u(),m("div",eu,[re(pa,{thinking:c.value},null,8,["thinking"])])):L("",!0),r.value?(u(),m("div",{key:1,class:"message-text",innerHTML:d.value},null,8,tu)):L("",!0),_.value?(u(),m("div",su,[(u(!0),m(ae,null,de(f.value,h=>(u(),_e(Jd,{key:h.id,toolCall:h},null,8,["toolCall"]))),128))])):L("",!0)])]))}},ou=K(nu,[["__scopeId","data-v-726a72a7"]]),iu={key:0,class:"message-row message-row-compaction"},au=["title"],lu={class:"message-content-column"},ru={class:"compaction-status-content"},cu={class:"text-muted ms-auto"},du={key:1,class:"message-row message-row-system"},uu=["title"],mu={class:"message-content-column"},pu={class:"system-text"},fu={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>Lt(e.message.timestamp)),o=g(()=>`system
${s.value}`),i=g(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,l)=>i.value?(u(),m("div",iu,[t("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,au),t("div",lu,[t("div",ru,[l[1]||(l[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",cu,w(s.value),1)])])])):(u(),m("div",du,[t("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,uu),t("div",mu,[t("span",pu,w(n.message.content),1)])]))}},$n=K(fu,[["__scopeId","data-v-a078178f"]]),vu={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>{switch(e.message.type){case"user":return aa;case"assistant":return ou;case"system":return $n;default:return $n}});return(o,i)=>(u(),_e(oo(s.value),{message:n.message},null,8,["message"]))}},hu=K(vu,[["__scopeId","data-v-f283c218"]]);var ye="top",Ce="bottom",Se="right",$e="left",os="auto",wt=[ye,Ce,Se,$e],ot="start",ft="end",lo="clippingParents",Ws="viewport",dt="popper",ro="reference",Ds=wt.reduce(function(n,e){return n.concat([e+"-"+ot,e+"-"+ft])},[]),Fs=[].concat(wt,[os]).reduce(function(n,e){return n.concat([e,e+"-"+ot,e+"-"+ft])},[]),co="beforeRead",uo="read",mo="afterRead",po="beforeMain",fo="main",vo="afterMain",ho="beforeWrite",_o="write",go="afterWrite",bo=[co,uo,mo,po,fo,vo,ho,_o,go];function Pe(n){return n?(n.nodeName||"").toLowerCase():null}function ke(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function it(n){var e=ke(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=ke(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Us(n){if(typeof ShadowRoot>"u")return!1;var e=ke(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function _u(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},a=e.elements[s];!Te(a)||!Pe(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(l){var r=i[l];r===!1?a.removeAttribute(l):a.setAttribute(l,r===!0?"":r)}))})}function gu(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),r=l.reduce(function(d,p){return d[p]="",d},{});!Te(i)||!Pe(i)||(Object.assign(i.style,r),Object.keys(a).forEach(function(d){i.removeAttribute(d)}))})}}const Bs={name:"applyStyles",enabled:!0,phase:"write",fn:_u,effect:gu,requires:["computeStyles"]};function Le(n){return n.split("-")[0]}var st=Math.max,Qt=Math.min,vt=Math.round;function Is(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function yo(){return!/^((?!chrome|android).)*safari/i.test(Is())}function ht(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&vt(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&vt(o.height)/n.offsetHeight||1);var l=it(n)?ke(n):window,r=l.visualViewport,d=!yo()&&s,p=(o.left+(d&&r?r.offsetLeft:0))/i,c=(o.top+(d&&r?r.offsetTop:0))/a,_=o.width/i,b=o.height/a;return{width:_,height:b,top:c,right:p+_,bottom:c+b,left:p,x:p,y:c}}function qs(n){var e=ht(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function $o(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Us(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function We(n){return ke(n).getComputedStyle(n)}function bu(n){return["table","td","th"].indexOf(Pe(n))>=0}function Ye(n){return((it(n)?n.ownerDocument:n.document)||window.document).documentElement}function is(n){return Pe(n)==="html"?n:n.assignedSlot||n.parentNode||(Us(n)?n.host:null)||Ye(n)}function wn(n){return!Te(n)||We(n).position==="fixed"?null:n.offsetParent}function yu(n){var e=/firefox/i.test(Is()),s=/Trident/i.test(Is());if(s&&Te(n)){var o=We(n);if(o.position==="fixed")return null}var i=is(n);for(Us(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Pe(i))<0;){var a=We(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Dt(n){for(var e=ke(n),s=wn(n);s&&bu(s)&&We(s).position==="static";)s=wn(s);return s&&(Pe(s)==="html"||Pe(s)==="body"&&We(s).position==="static")?e:s||yu(n)||e}function zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Mt(n,e,s){return st(n,Qt(e,s))}function $u(n,e,s){var o=Mt(n,e,s);return o>s?s:o}function wo(){return{top:0,right:0,bottom:0,left:0}}function Eo(n){return Object.assign({},wo(),n)}function Co(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var wu=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Eo(typeof e!="number"?e:Co(e,wt))};function Eu(n){var e,s=n.state,o=n.name,i=n.options,a=s.elements.arrow,l=s.modifiersData.popperOffsets,r=Le(s.placement),d=zs(r),p=[$e,Se].indexOf(r)>=0,c=p?"height":"width";if(!(!a||!l)){var _=wu(i.padding,s),b=qs(a),f=d==="y"?ye:$e,$=d==="y"?Ce:Se,y=s.rects.reference[c]+s.rects.reference[d]-l[d]-s.rects.popper[c],h=l[d]-s.rects.reference[d],v=Dt(a),C=v?d==="y"?v.clientHeight||0:v.clientWidth||0:0,k=y/2-h/2,T=_[f],D=C-b[c]-_[$],I=C/2-b[c]/2+k,x=Mt(T,I,D),O=d;s.modifiersData[o]=(e={},e[O]=x,e.centerOffset=x-I,e)}}function Cu(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||$o(e.elements.popper,i)&&(e.elements.arrow=i))}const So={name:"arrow",enabled:!0,phase:"main",fn:Eu,effect:Cu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function _t(n){return n.split("-")[1]}var Su={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ku(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:vt(s*i)/i||0,y:vt(o*i)/i||0}}function En(n){var e,s=n.popper,o=n.popperRect,i=n.placement,a=n.variation,l=n.offsets,r=n.position,d=n.gpuAcceleration,p=n.adaptive,c=n.roundOffsets,_=n.isFixed,b=l.x,f=b===void 0?0:b,$=l.y,y=$===void 0?0:$,h=typeof c=="function"?c({x:f,y}):{x:f,y};f=h.x,y=h.y;var v=l.hasOwnProperty("x"),C=l.hasOwnProperty("y"),k=$e,T=ye,D=window;if(p){var I=Dt(s),x="clientHeight",O="clientWidth";if(I===ke(s)&&(I=Ye(s),We(I).position!=="static"&&r==="absolute"&&(x="scrollHeight",O="scrollWidth")),I=I,i===ye||(i===$e||i===Se)&&a===ft){T=Ce;var q=_&&I===D&&D.visualViewport?D.visualViewport.height:I[x];y-=q-o.height,y*=d?1:-1}if(i===$e||(i===ye||i===Ce)&&a===ft){k=Se;var R=_&&I===D&&D.visualViewport?D.visualViewport.width:I[O];f-=R-o.width,f*=d?1:-1}}var P=Object.assign({position:r},p&&Su),S=c===!0?ku({x:f,y},ke(s)):{x:f,y};if(f=S.x,y=S.y,d){var E;return Object.assign({},P,(E={},E[T]=C?"0":"",E[k]=v?"0":"",E.transform=(D.devicePixelRatio||1)<=1?"translate("+f+"px, "+y+"px)":"translate3d("+f+"px, "+y+"px, 0)",E))}return Object.assign({},P,(e={},e[T]=C?y+"px":"",e[k]=v?f+"px":"",e.transform="",e))}function Tu(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,a=s.adaptive,l=a===void 0?!0:a,r=s.roundOffsets,d=r===void 0?!0:r,p={placement:Le(e.placement),variation:_t(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,En(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,En(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ks={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Tu,data:{}};var Wt={passive:!0};function xu(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,l=o.resize,r=l===void 0?!0:l,d=ke(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&p.forEach(function(c){c.addEventListener("scroll",s.update,Wt)}),r&&d.addEventListener("resize",s.update,Wt),function(){a&&p.forEach(function(c){c.removeEventListener("scroll",s.update,Wt)}),r&&d.removeEventListener("resize",s.update,Wt)}}const Gs={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:xu,data:{}};var Mu={left:"right",right:"left",bottom:"top",top:"bottom"};function Gt(n){return n.replace(/left|right|bottom|top/g,function(e){return Mu[e]})}var Au={start:"end",end:"start"};function Cn(n){return n.replace(/start|end/g,function(e){return Au[e]})}function Ys(n){var e=ke(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function Js(n){return ht(Ye(n)).left+Ys(n).scrollLeft}function Ou(n,e){var s=ke(n),o=Ye(n),i=s.visualViewport,a=o.clientWidth,l=o.clientHeight,r=0,d=0;if(i){a=i.width,l=i.height;var p=yo();(p||!p&&e==="fixed")&&(r=i.offsetLeft,d=i.offsetTop)}return{width:a,height:l,x:r+Js(n),y:d}}function Nu(n){var e,s=Ye(n),o=Ys(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=st(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=st(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),r=-o.scrollLeft+Js(n),d=-o.scrollTop;return We(i||s).direction==="rtl"&&(r+=st(s.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:r,y:d}}function Xs(n){var e=We(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function ko(n){return["html","body","#document"].indexOf(Pe(n))>=0?n.ownerDocument.body:Te(n)&&Xs(n)?n:ko(is(n))}function At(n,e){var s;e===void 0&&(e=[]);var o=ko(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),a=ke(o),l=i?[a].concat(a.visualViewport||[],Xs(o)?o:[]):o,r=e.concat(l);return i?r:r.concat(At(is(l)))}function Ps(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Lu(n,e){var s=ht(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Sn(n,e,s){return e===Ws?Ps(Ou(n,s)):it(e)?Lu(e,s):Ps(Nu(Ye(n)))}function Du(n){var e=At(is(n)),s=["absolute","fixed"].indexOf(We(n).position)>=0,o=s&&Te(n)?Dt(n):n;return it(o)?e.filter(function(i){return it(i)&&$o(i,o)&&Pe(i)!=="body"}):[]}function Iu(n,e,s,o){var i=e==="clippingParents"?Du(n):[].concat(e),a=[].concat(i,[s]),l=a[0],r=a.reduce(function(d,p){var c=Sn(n,p,o);return d.top=st(c.top,d.top),d.right=Qt(c.right,d.right),d.bottom=Qt(c.bottom,d.bottom),d.left=st(c.left,d.left),d},Sn(n,l,o));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function To(n){var e=n.reference,s=n.element,o=n.placement,i=o?Le(o):null,a=o?_t(o):null,l=e.x+e.width/2-s.width/2,r=e.y+e.height/2-s.height/2,d;switch(i){case ye:d={x:l,y:e.y-s.height};break;case Ce:d={x:l,y:e.y+e.height};break;case Se:d={x:e.x+e.width,y:r};break;case $e:d={x:e.x-s.width,y:r};break;default:d={x:e.x,y:e.y}}var p=i?zs(i):null;if(p!=null){var c=p==="y"?"height":"width";switch(a){case ot:d[p]=d[p]-(e[c]/2-s[c]/2);break;case ft:d[p]=d[p]+(e[c]/2-s[c]/2);break}}return d}function gt(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,a=s.strategy,l=a===void 0?n.strategy:a,r=s.boundary,d=r===void 0?lo:r,p=s.rootBoundary,c=p===void 0?Ws:p,_=s.elementContext,b=_===void 0?dt:_,f=s.altBoundary,$=f===void 0?!1:f,y=s.padding,h=y===void 0?0:y,v=Eo(typeof h!="number"?h:Co(h,wt)),C=b===dt?ro:dt,k=n.rects.popper,T=n.elements[$?C:b],D=Iu(it(T)?T:T.contextElement||Ye(n.elements.popper),d,c,l),I=ht(n.elements.reference),x=To({reference:I,element:k,placement:i}),O=Ps(Object.assign({},k,x)),q=b===dt?O:I,R={top:D.top-q.top+v.top,bottom:q.bottom-D.bottom+v.bottom,left:D.left-q.left+v.left,right:q.right-D.right+v.right},P=n.modifiersData.offset;if(b===dt&&P){var S=P[i];Object.keys(R).forEach(function(E){var M=[Se,Ce].indexOf(E)>=0?1:-1,N=[ye,Ce].indexOf(E)>=0?"y":"x";R[E]+=S[N]*M})}return R}function Pu(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,a=s.rootBoundary,l=s.padding,r=s.flipVariations,d=s.allowedAutoPlacements,p=d===void 0?Fs:d,c=_t(o),_=c?r?Ds:Ds.filter(function($){return _t($)===c}):wt,b=_.filter(function($){return p.indexOf($)>=0});b.length===0&&(b=_);var f=b.reduce(function($,y){return $[y]=gt(n,{placement:y,boundary:i,rootBoundary:a,padding:l})[Le(y)],$},{});return Object.keys(f).sort(function($,y){return f[$]-f[y]})}function ju(n){if(Le(n)===os)return[];var e=Gt(n);return[Cn(n),e,Cn(e)]}function Ru(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!0:l,d=s.fallbackPlacements,p=s.padding,c=s.boundary,_=s.rootBoundary,b=s.altBoundary,f=s.flipVariations,$=f===void 0?!0:f,y=s.allowedAutoPlacements,h=e.options.placement,v=Le(h),C=v===h,k=d||(C||!$?[Gt(h)]:ju(h)),T=[h].concat(k).reduce(function(z,ue){return z.concat(Le(ue)===os?Pu(e,{placement:ue,boundary:c,rootBoundary:_,padding:p,flipVariations:$,allowedAutoPlacements:y}):ue)},[]),D=e.rects.reference,I=e.rects.popper,x=new Map,O=!0,q=T[0],R=0;R<T.length;R++){var P=T[R],S=Le(P),E=_t(P)===ot,M=[ye,Ce].indexOf(S)>=0,N=M?"width":"height",V=gt(e,{placement:P,boundary:c,rootBoundary:_,altBoundary:b,padding:p}),U=M?E?Se:$e:E?Ce:ye;D[N]>I[N]&&(U=Gt(U));var ee=Gt(U),le=[];if(a&&le.push(V[S]<=0),r&&le.push(V[U]<=0,V[ee]<=0),le.every(function(z){return z})){q=P,O=!1;break}x.set(P,le)}if(O)for(var B=$?3:1,W=function(ue){var H=T.find(function(F){var Y=x.get(F);if(Y)return Y.slice(0,ue).every(function(Q){return Q})});if(H)return q=H,"break"},ne=B;ne>0;ne--){var te=W(ne);if(te==="break")break}e.placement!==q&&(e.modifiersData[o]._skip=!0,e.placement=q,e.reset=!0)}}const xo={name:"flip",enabled:!0,phase:"main",fn:Ru,requiresIfExists:["offset"],data:{_skip:!1}};function kn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Tn(n){return[ye,Se,Ce,$e].some(function(e){return n[e]>=0})}function Vu(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=gt(e,{elementContext:"reference"}),r=gt(e,{altBoundary:!0}),d=kn(l,o),p=kn(r,i,a),c=Tn(d),_=Tn(p);e.modifiersData[s]={referenceClippingOffsets:d,popperEscapeOffsets:p,isReferenceHidden:c,hasPopperEscaped:_},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":_})}const Mo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Vu};function Hu(n,e,s){var o=Le(n),i=[$e,ye].indexOf(o)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,l=a[0],r=a[1];return l=l||0,r=(r||0)*i,[$e,Se].indexOf(o)>=0?{x:r,y:l}:{x:l,y:r}}function Wu(n){var e=n.state,s=n.options,o=n.name,i=s.offset,a=i===void 0?[0,0]:i,l=Fs.reduce(function(c,_){return c[_]=Hu(_,e.rects,a),c},{}),r=l[e.placement],d=r.x,p=r.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=l}const Ao={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Wu};function Fu(n){var e=n.state,s=n.name;e.modifiersData[s]=To({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Qs={name:"popperOffsets",enabled:!0,phase:"read",fn:Fu,data:{}};function Uu(n){return n==="x"?"y":"x"}function Bu(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!1:l,d=s.boundary,p=s.rootBoundary,c=s.altBoundary,_=s.padding,b=s.tether,f=b===void 0?!0:b,$=s.tetherOffset,y=$===void 0?0:$,h=gt(e,{boundary:d,rootBoundary:p,padding:_,altBoundary:c}),v=Le(e.placement),C=_t(e.placement),k=!C,T=zs(v),D=Uu(T),I=e.modifiersData.popperOffsets,x=e.rects.reference,O=e.rects.popper,q=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,R=typeof q=="number"?{mainAxis:q,altAxis:q}:Object.assign({mainAxis:0,altAxis:0},q),P=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,S={x:0,y:0};if(I){if(a){var E,M=T==="y"?ye:$e,N=T==="y"?Ce:Se,V=T==="y"?"height":"width",U=I[T],ee=U+h[M],le=U-h[N],B=f?-O[V]/2:0,W=C===ot?x[V]:O[V],ne=C===ot?-O[V]:-x[V],te=e.elements.arrow,z=f&&te?qs(te):{width:0,height:0},ue=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:wo(),H=ue[M],F=ue[N],Y=Mt(0,x[V],z[V]),Q=k?x[V]/2-B-Y-H-R.mainAxis:W-Y-H-R.mainAxis,Z=k?-x[V]/2+B+Y+F+R.mainAxis:ne+Y+F+R.mainAxis,he=e.elements.arrow&&Dt(e.elements.arrow),kt=he?T==="y"?he.clientTop||0:he.clientLeft||0:0,Vt=(E=P?.[T])!=null?E:0,ui=U+Q-Vt-kt,mi=U+Z-Vt,ln=Mt(f?Qt(ee,ui):ee,U,f?st(le,mi):le);I[T]=ln,S[T]=ln-U}if(r){var rn,pi=T==="x"?ye:$e,fi=T==="x"?Ce:Se,Ze=I[D],Ht=D==="y"?"height":"width",cn=Ze+h[pi],dn=Ze-h[fi],ms=[ye,$e].indexOf(v)!==-1,un=(rn=P?.[D])!=null?rn:0,mn=ms?cn:Ze-x[Ht]-O[Ht]-un+R.altAxis,pn=ms?Ze+x[Ht]+O[Ht]-un-R.altAxis:dn,fn=f&&ms?$u(mn,Ze,pn):Mt(f?mn:cn,Ze,f?pn:dn);I[D]=fn,S[D]=fn-Ze}e.modifiersData[o]=S}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:Bu,requiresIfExists:["offset"]};function qu(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function zu(n){return n===ke(n)||!Te(n)?Ys(n):qu(n)}function Ku(n){var e=n.getBoundingClientRect(),s=vt(e.width)/n.offsetWidth||1,o=vt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Gu(n,e,s){s===void 0&&(s=!1);var o=Te(e),i=Te(e)&&Ku(e),a=Ye(e),l=ht(n,i,s),r={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(o||!o&&!s)&&((Pe(e)!=="body"||Xs(a))&&(r=zu(e)),Te(e)?(d=ht(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):a&&(d.x=Js(a))),{x:l.left+r.scrollLeft-d.x,y:l.top+r.scrollTop-d.y,width:l.width,height:l.height}}function Yu(n){var e=new Map,s=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){s.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(r){if(!s.has(r)){var d=e.get(r);d&&i(d)}}),o.push(a)}return n.forEach(function(a){s.has(a.name)||i(a)}),o}function Ju(n){var e=Yu(n);return bo.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function Xu(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Qu(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var xn={placement:"bottom",modifiers:[],strategy:"absolute"};function Mn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function as(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,a=i===void 0?xn:i;return function(r,d,p){p===void 0&&(p=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},xn,a),modifiersData:{},elements:{reference:r,popper:d},attributes:{},styles:{}},_=[],b=!1,f={state:c,setOptions:function(v){var C=typeof v=="function"?v(c.options):v;y(),c.options=Object.assign({},a,c.options,C),c.scrollParents={reference:it(r)?At(r):r.contextElement?At(r.contextElement):[],popper:At(d)};var k=Ju(Qu([].concat(o,c.options.modifiers)));return c.orderedModifiers=k.filter(function(T){return T.enabled}),$(),f.update()},forceUpdate:function(){if(!b){var v=c.elements,C=v.reference,k=v.popper;if(Mn(C,k)){c.rects={reference:Gu(C,Dt(k),c.options.strategy==="fixed"),popper:qs(k)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(R){return c.modifiersData[R.name]=Object.assign({},R.data)});for(var T=0;T<c.orderedModifiers.length;T++){if(c.reset===!0){c.reset=!1,T=-1;continue}var D=c.orderedModifiers[T],I=D.fn,x=D.options,O=x===void 0?{}:x,q=D.name;typeof I=="function"&&(c=I({state:c,options:O,name:q,instance:f})||c)}}}},update:Xu(function(){return new Promise(function(h){f.forceUpdate(),h(c)})}),destroy:function(){y(),b=!0}};if(!Mn(r,d))return f;f.setOptions(p).then(function(h){!b&&p.onFirstUpdate&&p.onFirstUpdate(h)});function $(){c.orderedModifiers.forEach(function(h){var v=h.name,C=h.options,k=C===void 0?{}:C,T=h.effect;if(typeof T=="function"){var D=T({state:c,name:v,instance:f,options:k}),I=function(){};_.push(D||I)}})}function y(){_.forEach(function(h){return h()}),_=[]}return f}}var Zu=as(),em=[Gs,Qs,Ks,Bs],tm=as({defaultModifiers:em}),sm=[Gs,Qs,Ks,Bs,Ao,xo,Oo,So,Mo],Zs=as({defaultModifiers:sm});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:vo,afterRead:mo,afterWrite:go,applyStyles:Bs,arrow:So,auto:os,basePlacements:wt,beforeMain:po,beforeRead:co,beforeWrite:ho,bottom:Ce,clippingParents:lo,computeStyles:Ks,createPopper:Zs,createPopperBase:Zu,createPopperLite:tm,detectOverflow:gt,end:ft,eventListeners:Gs,flip:xo,hide:Mo,left:$e,main:fo,modifierPhases:bo,offset:Ao,placements:Fs,popper:dt,popperGenerator:as,popperOffsets:Qs,preventOverflow:Oo,read:uo,reference:ro,right:Se,start:ot,top:ye,variationPlacements:Ds,viewport:Ws,write:_o},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Be=new Map,hs={set(n,e,s){Be.has(n)||Be.set(n,new Map);const o=Be.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return Be.has(n)&&Be.get(n).get(e)||null},remove(n,e){if(!Be.has(n))return;const s=Be.get(n);s.delete(e),s.size===0&&Be.delete(n)}},nm=1e6,om=1e3,js="transitionend",Lo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),im=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),am=n=>{do n+=Math.floor(Math.random()*nm);while(document.getElementById(n));return n},lm=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*om)},Do=n=>{n.dispatchEvent(new Event(js))},Re=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),qe=n=>Re(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Lo(n)):null,Et=n=>{if(!Re(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},ze=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Io=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Io(n.parentNode):null},Zt=()=>{},It=n=>{n.offsetHeight},Po=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_s=[],rm=n=>{document.readyState==="loading"?(_s.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of _s)e()}),_s.push(n)):n()},xe=()=>document.documentElement.dir==="rtl",Ae=n=>{rm(()=>{const e=Po();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},we=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,jo=(n,e,s=!0)=>{if(!s){we(n);return}const i=lm(e)+5;let a=!1;const l=({target:r})=>{r===e&&(a=!0,e.removeEventListener(js,l),we(n))};e.addEventListener(js,l),setTimeout(()=>{a||Do(e)},i)},en=(n,e,s,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!s&&o?n[i-1]:n[0]:(a+=s?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},cm=/[^.]*(?=\..*)\.|.*/,dm=/\..*/,um=/::\d+$/,gs={};let An=1;const Ro={mouseenter:"mouseover",mouseleave:"mouseout"},mm=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vo(n,e){return e&&`${e}::${An++}`||n.uidEvent||An++}function Ho(n){const e=Vo(n);return n.uidEvent=e,gs[e]=gs[e]||{},gs[e]}function pm(n,e){return function s(o){return tn(o,{delegateTarget:n}),s.oneOff&&j.off(n,o.type,e),e.apply(n,[o])}}function fm(n,e,s){return function o(i){const a=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const r of a)if(r===l)return tn(i,{delegateTarget:l}),o.oneOff&&j.off(n,i.type,e,s),s.apply(l,[i])}}function Wo(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Fo(n,e,s){const o=typeof e=="string",i=o?s:e||s;let a=Uo(n);return mm.has(a)||(a=n),[o,i,a]}function On(n,e,s,o,i){if(typeof e!="string"||!n)return;let[a,l,r]=Fo(e,s,o);e in Ro&&(l=($=>function(y){if(!y.relatedTarget||y.relatedTarget!==y.delegateTarget&&!y.delegateTarget.contains(y.relatedTarget))return $.call(this,y)})(l));const d=Ho(n),p=d[r]||(d[r]={}),c=Wo(p,l,a?s:null);if(c){c.oneOff=c.oneOff&&i;return}const _=Vo(l,e.replace(cm,"")),b=a?fm(n,s,l):pm(n,l);b.delegationSelector=a?s:null,b.callable=l,b.oneOff=i,b.uidEvent=_,p[_]=b,n.addEventListener(r,b,a)}function Rs(n,e,s,o,i){const a=Wo(e[s],o,i);a&&(n.removeEventListener(s,a,!!i),delete e[s][a.uidEvent])}function vm(n,e,s,o){const i=e[s]||{};for(const[a,l]of Object.entries(i))a.includes(o)&&Rs(n,e,s,l.callable,l.delegationSelector)}function Uo(n){return n=n.replace(dm,""),Ro[n]||n}const j={on(n,e,s,o){On(n,e,s,o,!1)},one(n,e,s,o){On(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,a,l]=Fo(e,s,o),r=l!==e,d=Ho(n),p=d[l]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(p).length)return;Rs(n,d,l,a,i?s:null);return}if(c)for(const _ of Object.keys(d))vm(n,d,_,e.slice(1));for(const[_,b]of Object.entries(p)){const f=_.replace(um,"");(!r||e.includes(f))&&Rs(n,d,l,b.callable,b.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=Po(),i=Uo(e),a=e!==i;let l=null,r=!0,d=!0,p=!1;a&&o&&(l=o.Event(e,s),o(n).trigger(l),r=!l.isPropagationStopped(),d=!l.isImmediatePropagationStopped(),p=l.isDefaultPrevented());const c=tn(new Event(e,{bubbles:r,cancelable:!0}),s);return p&&c.preventDefault(),d&&n.dispatchEvent(c),c.defaultPrevented&&l&&l.preventDefault(),c}};function tn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Nn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function bs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ve={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${bs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${bs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Nn(n.dataset[o])}return e},getDataAttribute(n,e){return Nn(n.getAttribute(`data-bs-${bs(e)}`))}};class Pt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Re(s)?Ve.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Re(s)?Ve.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const a=e[o],l=Re(a)?"element":im(a);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const hm="5.3.8";class Ne extends Pt{constructor(e,s){super(),e=qe(e),e&&(this._element=e,this._config=this._getConfig(s),hs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){hs.remove(this._element,this.constructor.DATA_KEY),j.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){jo(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return hs.get(qe(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return hm}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const ys=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>Lo(s)).join(","):null},J={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!ze(s)&&Et(s))},getSelectorFromElement(n){const e=ys(n);return e&&J.findOne(e)?e:null},getElementFromSelector(n){const e=ys(n);return e?J.findOne(e):null},getMultipleElementsFromSelector(n){const e=ys(n);return e?J.find(e):[]}},ls=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;j.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),ze(this))return;const a=J.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},_m="alert",gm="bs.alert",Bo=`.${gm}`,bm=`close${Bo}`,ym=`closed${Bo}`,$m="fade",wm="show";class rs extends Ne{static get NAME(){return _m}close(){if(j.trigger(this._element,bm).defaultPrevented)return;this._element.classList.remove(wm);const s=this._element.classList.contains($m);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),j.trigger(this._element,ym),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=rs.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ls(rs,"close");Ae(rs);const Em="button",Cm="bs.button",Sm=`.${Cm}`,km=".data-api",Tm="active",Ln='[data-bs-toggle="button"]',xm=`click${Sm}${km}`;class cs extends Ne{static get NAME(){return Em}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Tm))}static jQueryInterface(e){return this.each(function(){const s=cs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}j.on(document,xm,Ln,n=>{n.preventDefault();const e=n.target.closest(Ln);cs.getOrCreateInstance(e).toggle()});Ae(cs);const Mm="swipe",Ct=".bs.swipe",Am=`touchstart${Ct}`,Om=`touchmove${Ct}`,Nm=`touchend${Ct}`,Lm=`pointerdown${Ct}`,Dm=`pointerup${Ct}`,Im="touch",Pm="pen",jm="pointer-event",Rm=40,Vm={endCallback:null,leftCallback:null,rightCallback:null},Hm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class es extends Pt{constructor(e,s){super(),this._element=e,!(!e||!es.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Vm}static get DefaultType(){return Hm}static get NAME(){return Mm}dispose(){j.off(this._element,Ct)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),we(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Rm)return;const s=e/this._deltaX;this._deltaX=0,s&&we(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(j.on(this._element,Lm,e=>this._start(e)),j.on(this._element,Dm,e=>this._end(e)),this._element.classList.add(jm)):(j.on(this._element,Am,e=>this._start(e)),j.on(this._element,Om,e=>this._move(e)),j.on(this._element,Nm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Pm||e.pointerType===Im)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Wm="carousel",Fm="bs.carousel",Je=`.${Fm}`,qo=".data-api",Um="ArrowLeft",Bm="ArrowRight",qm=500,Tt="next",rt="prev",ut="left",Yt="right",zm=`slide${Je}`,$s=`slid${Je}`,Km=`keydown${Je}`,Gm=`mouseenter${Je}`,Ym=`mouseleave${Je}`,Jm=`dragstart${Je}`,Xm=`load${Je}${qo}`,Qm=`click${Je}${qo}`,zo="carousel",Ft="active",Zm="slide",ep="carousel-item-end",tp="carousel-item-start",sp="carousel-item-next",np="carousel-item-prev",Ko=".active",Go=".carousel-item",op=Ko+Go,ip=".carousel-item img",ap=".carousel-indicators",lp="[data-bs-slide], [data-bs-slide-to]",rp='[data-bs-ride="carousel"]',cp={[Um]:Yt,[Bm]:ut},dp={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},up={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class jt extends Ne{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=J.findOne(ap,this._element),this._addEventListeners(),this._config.ride===zo&&this.cycle()}static get Default(){return dp}static get DefaultType(){return up}static get NAME(){return Wm}next(){this._slide(Tt)}nextWhenVisible(){!document.hidden&&Et(this._element)&&this.next()}prev(){this._slide(rt)}pause(){this._isSliding&&Do(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){j.one(this._element,$s,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){j.one(this._element,$s,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Tt:rt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&j.on(this._element,Km,e=>this._keydown(e)),this._config.pause==="hover"&&(j.on(this._element,Gm,()=>this.pause()),j.on(this._element,Ym,()=>this._maybeEnableCycle())),this._config.touch&&es.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of J.find(ip,this._element))j.on(o,Jm,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(ut)),rightCallback:()=>this._slide(this._directionToOrder(Yt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),qm+this._config.interval))}};this._swipeHelper=new es(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=cp[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=J.findOne(Ko,this._indicatorsElement);s.classList.remove(Ft),s.removeAttribute("aria-current");const o=J.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Ft),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===Tt,a=s||en(this._getItems(),o,i,this._config.wrap);if(a===o)return;const l=this._getItemIndex(a),r=f=>j.trigger(this._element,f,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(r(zm).defaultPrevented||!o||!a)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=a;const c=i?tp:ep,_=i?sp:np;a.classList.add(_),It(a),o.classList.add(c),a.classList.add(c);const b=()=>{a.classList.remove(c,_),a.classList.add(Ft),o.classList.remove(Ft,_,c),this._isSliding=!1,r($s)};this._queueCallback(b,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(Zm)}_getActive(){return J.findOne(op,this._element)}_getItems(){return J.find(Go,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return xe()?e===ut?rt:Tt:e===ut?Tt:rt}_orderToDirection(e){return xe()?e===rt?ut:Yt:e===rt?Yt:ut}static jQueryInterface(e){return this.each(function(){const s=jt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}j.on(document,Qm,lp,function(n){const e=J.getElementFromSelector(this);if(!e||!e.classList.contains(zo))return;n.preventDefault();const s=jt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Ve.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});j.on(window,Xm,()=>{const n=J.find(rp);for(const e of n)jt.getOrCreateInstance(e)});Ae(jt);const mp="collapse",pp="bs.collapse",Rt=`.${pp}`,fp=".data-api",vp=`show${Rt}`,hp=`shown${Rt}`,_p=`hide${Rt}`,gp=`hidden${Rt}`,bp=`click${Rt}${fp}`,ws="show",pt="collapse",Ut="collapsing",yp="collapsed",$p=`:scope .${pt} .${pt}`,wp="collapse-horizontal",Ep="width",Cp="height",Sp=".collapse.show, .collapse.collapsing",Vs='[data-bs-toggle="collapse"]',kp={parent:null,toggle:!0},Tp={parent:"(null|element)",toggle:"boolean"};class bt extends Ne{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=J.find(Vs);for(const i of o){const a=J.getSelectorFromElement(i),l=J.find(a).filter(r=>r===this._element);a!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return kp}static get DefaultType(){return Tp}static get NAME(){return mp}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Sp).filter(r=>r!==this._element).map(r=>bt.getOrCreateInstance(r,{toggle:!1}))),e.length&&e[0]._isTransitioning||j.trigger(this._element,vp).defaultPrevented)return;for(const r of e)r.hide();const o=this._getDimension();this._element.classList.remove(pt),this._element.classList.add(Ut),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Ut),this._element.classList.add(pt,ws),this._element.style[o]="",j.trigger(this._element,hp)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||j.trigger(this._element,_p).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,It(this._element),this._element.classList.add(Ut),this._element.classList.remove(pt,ws);for(const i of this._triggerArray){const a=J.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Ut),this._element.classList.add(pt),j.trigger(this._element,gp)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ws)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=qe(e.parent),e}_getDimension(){return this._element.classList.contains(wp)?Ep:Cp}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Vs);for(const s of e){const o=J.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=J.find($p,this._config.parent);return J.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(yp,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=bt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}j.on(document,bp,Vs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of J.getMultipleElementsFromSelector(this))bt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ae(bt);const Dn="dropdown",xp="bs.dropdown",at=`.${xp}`,sn=".data-api",Mp="Escape",In="Tab",Ap="ArrowUp",Pn="ArrowDown",Op=2,Np=`hide${at}`,Lp=`hidden${at}`,Dp=`show${at}`,Ip=`shown${at}`,Yo=`click${at}${sn}`,Jo=`keydown${at}${sn}`,Pp=`keyup${at}${sn}`,mt="show",jp="dropup",Rp="dropend",Vp="dropstart",Hp="dropup-center",Wp="dropdown-center",et='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Fp=`${et}.${mt}`,Jt=".dropdown-menu",Up=".navbar",Bp=".navbar-nav",qp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",zp=xe()?"top-end":"top-start",Kp=xe()?"top-start":"top-end",Gp=xe()?"bottom-end":"bottom-start",Yp=xe()?"bottom-start":"bottom-end",Jp=xe()?"left-start":"right-start",Xp=xe()?"right-start":"left-start",Qp="top",Zp="bottom",ef={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},tf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class De extends Ne{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=J.next(this._element,Jt)[0]||J.prev(this._element,Jt)[0]||J.findOne(Jt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return ef}static get DefaultType(){return tf}static get NAME(){return Dn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ze(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!j.trigger(this._element,Dp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Bp))for(const o of[].concat(...document.body.children))j.on(o,"mouseover",Zt);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(mt),this._element.classList.add(mt),j.trigger(this._element,Ip,e)}}hide(){if(ze(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!j.trigger(this._element,Np,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))j.off(o,"mouseover",Zt);this._popper&&this._popper.destroy(),this._menu.classList.remove(mt),this._element.classList.remove(mt),this._element.setAttribute("aria-expanded","false"),Ve.removeDataAttribute(this._menu,"popper"),j.trigger(this._element,Lp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Re(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Dn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Re(this._config.reference)?e=qe(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Zs(e,this._menu,s)}_isShown(){return this._menu.classList.contains(mt)}_getPlacement(){const e=this._parent;if(e.classList.contains(Rp))return Jp;if(e.classList.contains(Vp))return Xp;if(e.classList.contains(Hp))return Qp;if(e.classList.contains(Wp))return Zp;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(jp)?s?Kp:zp:s?Yp:Gp}_detectNavbar(){return this._element.closest(Up)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ve.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...we(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=J.find(qp,this._menu).filter(i=>Et(i));o.length&&en(o,s,e===Pn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=De.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===Op||e.type==="keyup"&&e.key!==In)return;const s=J.find(Fp);for(const o of s){const i=De.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),l=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===In||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const r={relatedTarget:i._element};e.type==="click"&&(r.clickEvent=e),i._completeHide(r)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Mp,i=[Ap,Pn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const a=this.matches(et)?this:J.prev(this,et)[0]||J.next(this,et)[0]||J.findOne(et,e.delegateTarget.parentNode),l=De.getOrCreateInstance(a);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),a.focus())}}j.on(document,Jo,et,De.dataApiKeydownHandler);j.on(document,Jo,Jt,De.dataApiKeydownHandler);j.on(document,Yo,De.clearMenus);j.on(document,Pp,De.clearMenus);j.on(document,Yo,et,function(n){n.preventDefault(),De.getOrCreateInstance(this).toggle()});Ae(De);const Xo="backdrop",sf="fade",jn="show",Rn=`mousedown.bs.${Xo}`,nf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},of={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Qo extends Pt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return nf}static get DefaultType(){return of}static get NAME(){return Xo}show(e){if(!this._config.isVisible){we(e);return}this._append();const s=this._getElement();this._config.isAnimated&&It(s),s.classList.add(jn),this._emulateAnimation(()=>{we(e)})}hide(e){if(!this._config.isVisible){we(e);return}this._getElement().classList.remove(jn),this._emulateAnimation(()=>{this.dispose(),we(e)})}dispose(){this._isAppended&&(j.off(this._element,Rn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(sf),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=qe(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),j.on(e,Rn,()=>{we(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){jo(e,this._getElement(),this._config.isAnimated)}}const af="focustrap",lf="bs.focustrap",ts=`.${lf}`,rf=`focusin${ts}`,cf=`keydown.tab${ts}`,df="Tab",uf="forward",Vn="backward",mf={autofocus:!0,trapElement:null},pf={autofocus:"boolean",trapElement:"element"};class Zo extends Pt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return mf}static get DefaultType(){return pf}static get NAME(){return af}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),j.off(document,ts),j.on(document,rf,e=>this._handleFocusin(e)),j.on(document,cf,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,j.off(document,ts))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=J.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Vn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===df&&(this._lastTabNavDirection=e.shiftKey?Vn:uf)}}const Hn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Wn=".sticky-top",Bt="padding-right",Fn="margin-right";class Hs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Bt,s=>s+e),this._setElementAttributes(Hn,Bt,s=>s+e),this._setElementAttributes(Wn,Fn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Bt),this._resetElementAttributes(Hn,Bt),this._resetElementAttributes(Wn,Fn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),a=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,s);const r=window.getComputedStyle(l).getPropertyValue(s);l.style.setProperty(s,`${o(Number.parseFloat(r))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Ve.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const a=Ve.getDataAttribute(i,s);if(a===null){i.style.removeProperty(s);return}Ve.removeDataAttribute(i,s),i.style.setProperty(s,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Re(e)){s(e);return}for(const o of J.find(e,this._element))s(o)}}const ff="modal",vf="bs.modal",Me=`.${vf}`,hf=".data-api",_f="Escape",gf=`hide${Me}`,bf=`hidePrevented${Me}`,ei=`hidden${Me}`,ti=`show${Me}`,yf=`shown${Me}`,$f=`resize${Me}`,wf=`click.dismiss${Me}`,Ef=`mousedown.dismiss${Me}`,Cf=`keydown.dismiss${Me}`,Sf=`click${Me}${hf}`,Un="modal-open",kf="fade",Bn="show",Es="modal-static",Tf=".modal.show",xf=".modal-dialog",Mf=".modal-body",Af='[data-bs-toggle="modal"]',Of={backdrop:!0,focus:!0,keyboard:!0},Nf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Fe extends Ne{constructor(e,s){super(e,s),this._dialog=J.findOne(xf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Hs,this._addEventListeners()}static get Default(){return Of}static get DefaultType(){return Nf}static get NAME(){return ff}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||j.trigger(this._element,ti,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Un),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||j.trigger(this._element,gf).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Bn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){j.off(window,Me),j.off(this._dialog,Me),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Qo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=J.findOne(Mf,this._dialog);s&&(s.scrollTop=0),It(this._element),this._element.classList.add(Bn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,j.trigger(this._element,yf,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){j.on(this._element,Cf,e=>{if(e.key===_f){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),j.on(window,$f,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),j.on(this._element,Ef,e=>{j.one(this._element,wf,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Un),this._resetAdjustments(),this._scrollBar.reset(),j.trigger(this._element,ei)})}_isAnimated(){return this._element.classList.contains(kf)}_triggerBackdropTransition(){if(j.trigger(this._element,bf).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Es)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Es),this._queueCallback(()=>{this._element.classList.remove(Es),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=xe()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=xe()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=Fe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}j.on(document,Sf,Af,function(n){const e=J.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),j.one(e,ti,i=>{i.defaultPrevented||j.one(e,ei,()=>{Et(this)&&this.focus()})});const s=J.findOne(Tf);s&&Fe.getInstance(s).hide(),Fe.getOrCreateInstance(e).toggle(this)});ls(Fe);Ae(Fe);const Lf="offcanvas",Df="bs.offcanvas",Ue=`.${Df}`,si=".data-api",If=`load${Ue}${si}`,Pf="Escape",qn="show",zn="showing",Kn="hiding",jf="offcanvas-backdrop",ni=".offcanvas.show",Rf=`show${Ue}`,Vf=`shown${Ue}`,Hf=`hide${Ue}`,Gn=`hidePrevented${Ue}`,oi=`hidden${Ue}`,Wf=`resize${Ue}`,Ff=`click${Ue}${si}`,Uf=`keydown.dismiss${Ue}`,Bf='[data-bs-toggle="offcanvas"]',qf={backdrop:!0,keyboard:!0,scroll:!1},zf={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ke extends Ne{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return qf}static get DefaultType(){return zf}static get NAME(){return Lf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||j.trigger(this._element,Rf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Hs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(qn),this._element.classList.remove(zn),j.trigger(this._element,Vf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||j.trigger(this._element,Hf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Kn),this._backdrop.hide();const s=()=>{this._element.classList.remove(qn,Kn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Hs().reset(),j.trigger(this._element,oi)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){j.trigger(this._element,Gn);return}this.hide()},s=!!this._config.backdrop;return new Qo({className:jf,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_addEventListeners(){j.on(this._element,Uf,e=>{if(e.key===Pf){if(this._config.keyboard){this.hide();return}j.trigger(this._element,Gn)}})}static jQueryInterface(e){return this.each(function(){const s=Ke.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}j.on(document,Ff,Bf,function(n){const e=J.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ze(this))return;j.one(e,oi,()=>{Et(this)&&this.focus()});const s=J.findOne(ni);s&&s!==e&&Ke.getInstance(s).hide(),Ke.getOrCreateInstance(e).toggle(this)});j.on(window,If,()=>{for(const n of J.find(ni))Ke.getOrCreateInstance(n).show()});j.on(window,Wf,()=>{for(const n of J.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ke.getOrCreateInstance(n).hide()});ls(Ke);Ae(Ke);const Kf=/^aria-[\w-]*$/i,ii={"*":["class","dir","id","lang","role",Kf],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Gf=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Yf=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Jf=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Gf.has(s)?!!Yf.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Xf(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const l of a){const r=l.nodeName.toLowerCase();if(!Object.keys(e).includes(r)){l.remove();continue}const d=[].concat(...l.attributes),p=[].concat(e["*"]||[],e[r]||[]);for(const c of d)Jf(c,p)||l.removeAttribute(c.nodeName)}return i.body.innerHTML}const Qf="TemplateFactory",Zf={allowList:ii,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},ev={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},tv={entry:"(string|element|function|null)",selector:"(string|element)"};class sv extends Pt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Zf}static get DefaultType(){return ev}static get NAME(){return Qf}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},tv)}_setContent(e,s,o){const i=J.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(Re(s)){this._putElementInTemplate(qe(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Xf(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return we(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const nv="tooltip",ov=new Set(["sanitize","allowList","sanitizeFn"]),Cs="fade",iv="modal",qt="show",av=".tooltip-inner",Yn=`.${iv}`,Jn="hide.bs.modal",xt="hover",Ss="focus",ks="click",lv="manual",rv="hide",cv="hidden",dv="show",uv="shown",mv="inserted",pv="click",fv="focusin",vv="focusout",hv="mouseenter",_v="mouseleave",gv={AUTO:"auto",TOP:"top",RIGHT:xe()?"left":"right",BOTTOM:"bottom",LEFT:xe()?"right":"left"},bv={allowList:ii,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},yv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class St extends Ne{constructor(e,s){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return bv}static get DefaultType(){return yv}static get NAME(){return nv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),j.off(this._element.closest(Yn),Jn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=j.trigger(this._element,this.constructor.eventName(dv)),o=(Io(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),j.trigger(this._element,this.constructor.eventName(mv))),this._popper=this._createPopper(i),i.classList.add(qt),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))j.on(r,"mouseover",Zt);const l=()=>{j.trigger(this._element,this.constructor.eventName(uv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||j.trigger(this._element,this.constructor.eventName(rv)).defaultPrevented)return;if(this._getTipElement().classList.remove(qt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))j.off(i,"mouseover",Zt);this._activeTrigger[ks]=!1,this._activeTrigger[Ss]=!1,this._activeTrigger[xt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),j.trigger(this._element,this.constructor.eventName(cv)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Cs,qt),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=am(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Cs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new sv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[av]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Cs)}_isShown(){return this.tip&&this.tip.classList.contains(qt)}_createPopper(e){const s=we(this._config.placement,[this,e,this._element]),o=gv[s.toUpperCase()];return Zs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return we(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...we(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")j.on(this._element,this.constructor.eventName(pv),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[ks]=!(i._isShown()&&i._activeTrigger[ks]),i.toggle()});else if(s!==lv){const o=s===xt?this.constructor.eventName(hv):this.constructor.eventName(fv),i=s===xt?this.constructor.eventName(_v):this.constructor.eventName(vv);j.on(this._element,o,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusin"?Ss:xt]=!0,l._enter()}),j.on(this._element,i,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusout"?Ss:xt]=l._element.contains(a.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},j.on(this._element.closest(Yn),Jn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Ve.getDataAttributes(this._element);for(const o of Object.keys(s))ov.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:qe(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ae(St);const $v="popover",wv=".popover-header",Ev=".popover-body",Cv={...St.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Sv={...St.DefaultType,content:"(null|string|element|function)"};class nn extends St{static get Default(){return Cv}static get DefaultType(){return Sv}static get NAME(){return $v}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[wv]:this._getTitle(),[Ev]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=nn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ae(nn);const kv="scrollspy",Tv="bs.scrollspy",on=`.${Tv}`,xv=".data-api",Mv=`activate${on}`,Xn=`click${on}`,Av=`load${on}${xv}`,Ov="dropdown-item",ct="active",Nv='[data-bs-spy="scroll"]',Ts="[href]",Lv=".nav, .list-group",Qn=".nav-link",Dv=".nav-item",Iv=".list-group-item",Pv=`${Qn}, ${Dv} > ${Qn}, ${Iv}`,jv=".dropdown",Rv=".dropdown-toggle",Vv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Hv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ds extends Ne{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Vv}static get DefaultType(){return Hv}static get NAME(){return kv}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=qe(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(j.off(this._config.target,Xn),j.on(this._config.target,Xn,Ts,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(s(l))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(l));continue}const r=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&r){if(o(l),!i)return;continue}!a&&!r&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=J.find(Ts,this._config.target);for(const s of e){if(!s.hash||ze(s))continue;const o=J.findOne(decodeURI(s.hash),this._element);Et(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ct),this._activateParents(e),j.trigger(this._element,Mv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Ov)){J.findOne(Rv,e.closest(jv)).classList.add(ct);return}for(const s of J.parents(e,Lv))for(const o of J.prev(s,Pv))o.classList.add(ct)}_clearActiveClass(e){e.classList.remove(ct);const s=J.find(`${Ts}.${ct}`,e);for(const o of s)o.classList.remove(ct)}static jQueryInterface(e){return this.each(function(){const s=ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}j.on(window,Av,()=>{for(const n of J.find(Nv))ds.getOrCreateInstance(n)});Ae(ds);const Wv="tab",Fv="bs.tab",lt=`.${Fv}`,Uv=`hide${lt}`,Bv=`hidden${lt}`,qv=`show${lt}`,zv=`shown${lt}`,Kv=`click${lt}`,Gv=`keydown${lt}`,Yv=`load${lt}`,Jv="ArrowLeft",Zn="ArrowRight",Xv="ArrowUp",eo="ArrowDown",xs="Home",to="End",tt="active",so="fade",Ms="show",Qv="dropdown",ai=".dropdown-toggle",Zv=".dropdown-menu",As=`:not(${ai})`,eh='.list-group, .nav, [role="tablist"]',th=".nav-item, .list-group-item",sh=`.nav-link${As}, .list-group-item${As}, [role="tab"]${As}`,li='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Os=`${sh}, ${li}`,nh=`.${tt}[data-bs-toggle="tab"], .${tt}[data-bs-toggle="pill"], .${tt}[data-bs-toggle="list"]`;class yt extends Ne{constructor(e){super(e),this._parent=this._element.closest(eh),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),j.on(this._element,Gv,s=>this._keydown(s)))}static get NAME(){return Wv}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?j.trigger(s,Uv,{relatedTarget:e}):null;j.trigger(e,qv,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(tt),this._activate(J.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ms);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),j.trigger(e,zv,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(so))}_deactivate(e,s){if(!e)return;e.classList.remove(tt),e.blur(),this._deactivate(J.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ms);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),j.trigger(e,Bv,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(so))}_keydown(e){if(![Jv,Zn,Xv,eo,xs,to].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!ze(i));let o;if([xs,to].includes(e.key))o=s[e.key===xs?0:s.length-1];else{const i=[Zn,eo].includes(e.key);o=en(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),yt.getOrCreateInstance(o).show())}_getChildren(){return J.find(Os,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=J.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(Qv))return;const i=(a,l)=>{const r=J.findOne(a,o);r&&r.classList.toggle(l,s)};i(ai,tt),i(Zv,Ms),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(tt)}_getInnerElement(e){return e.matches(Os)?e:J.findOne(Os,e)}_getOuterElement(e){return e.closest(th)||e}static jQueryInterface(e){return this.each(function(){const s=yt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}j.on(document,Kv,li,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ze(this)&&yt.getOrCreateInstance(this).show()});j.on(window,Yv,()=>{for(const n of J.find(nh))yt.getOrCreateInstance(n)});Ae(yt);const oh="toast",ih="bs.toast",Xe=`.${ih}`,ah=`mouseover${Xe}`,lh=`mouseout${Xe}`,rh=`focusin${Xe}`,ch=`focusout${Xe}`,dh=`hide${Xe}`,uh=`hidden${Xe}`,mh=`show${Xe}`,ph=`shown${Xe}`,fh="fade",no="hide",zt="show",Kt="showing",vh={animation:"boolean",autohide:"boolean",delay:"number"},hh={animation:!0,autohide:!0,delay:5e3};class us extends Ne{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return hh}static get DefaultType(){return vh}static get NAME(){return oh}show(){if(j.trigger(this._element,mh).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(fh);const s=()=>{this._element.classList.remove(Kt),j.trigger(this._element,ph),this._maybeScheduleHide()};this._element.classList.remove(no),It(this._element),this._element.classList.add(zt,Kt),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||j.trigger(this._element,dh).defaultPrevented)return;const s=()=>{this._element.classList.add(no),this._element.classList.remove(Kt,zt),j.trigger(this._element,uh)};this._element.classList.add(Kt),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(zt),super.dispose()}isShown(){return this._element.classList.contains(zt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){j.on(this._element,ah,e=>this._onInteraction(e,!0)),j.on(this._element,lh,e=>this._onInteraction(e,!1)),j.on(this._element,rh,e=>this._onInteraction(e,!0)),j.on(this._element,ch,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=us.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ls(us);Ae(us);const _h={class:"message-content-column"},gh=["id"],bh={class:"accordion-item"},yh=["id"],$h=["aria-controls"],wh={class:"d-flex align-items-center w-100"},Eh={class:"badge bg-warning text-dark ms-auto me-2"},Ch={class:"text-muted"},Sh=["id","aria-labelledby"],kh={class:"accordion-body bg-light"},Th={class:"alert alert-warning mb-3",role:"alert"},xh={class:"compaction-metadata"},Mh={class:"metadata-row"},Ah={class:"metadata-row"},Oh={key:0,class:"metadata-row"},Nh={class:"continuation-content"},Lh={class:"continuation-text border rounded p-3 bg-white"},Dh={class:"mb-0"},Ih={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=g(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=g(()=>`heading-${s.value}`),i=g(()=>`collapse-${s.value}`),a=A(null);let l=null;me(()=>{a.value&&(l=new bt(a.value,{toggle:!1}))}),ss(()=>{l&&l.dispose()});function r(){l&&l.toggle()}const d=g(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),p=g(()=>d.value?e.messages[3]:e.messages[2]),c=g(()=>p.value?.metadata?.init_data?.compact_metadata||{}),_=g(()=>c.value.pre_tokens||0),b=g(()=>d.value?e.messages[4]:e.messages[3]),f=g(()=>b.value?.content||""),$=g(()=>{const h=e.messages[0]?.timestamp;return h?Lt(h):""});function y(h){return h?`${h.toLocaleString()} tokens`:"0 tokens"}return(h,v)=>(u(),m("div",{class:"message-row message-row-compaction",key:s.value},[v[7]||(v[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",_h,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",bh,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:r},[t("div",wh,[v[0]||(v[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),v[1]||(v[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",Eh,w(y(_.value)),1),t("small",Ch,w($.value),1)])],8,$h)],8,yh),t("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",kh,[t("div",Th,[v[5]||(v[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),X(" Compaction Details ")],-1)),t("div",xh,[t("div",Mh,[v[2]||(v[2]=t("strong",null,"Trigger:",-1)),t("span",null,w(c.value.trigger||"auto"),1)]),t("div",Ah,[v[3]||(v[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,w(y(_.value)),1)]),c.value.post_tokens?(u(),m("div",Oh,[v[4]||(v[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,w(y(c.value.post_tokens)),1)])):L("",!0)])]),t("div",Nh,[v[6]||(v[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),X(" Continuation Message ")],-1)),t("div",Lh,[t("pre",Dh,w(f.value),1)])])])],8,Sh)])],8,gh)])]))}},Ph=K(Ih,[["__scopeId","data-v-e0b95ba8"]]),jh={key:0,class:"text-muted text-center py-5"},Rh={__name:"MessageList",setup(n){const e=Ie(),s=fe(),o=A(null),i=g(()=>{const p=e.currentMessages,c=[];let _=0;for(;_<p.length;){const b=p[_];if(a(b,p,_)){const f=p[_+2],y=f?.type==="system"&&f?.metadata?.subtype==="init"?5:4,h=p.slice(_,_+y);c.push({type:"compaction",messages:h}),_+=y;continue}r(b)&&c.push({type:"message",message:b}),_++}return c});function a(p,c,_){if(_+3>=c.length)return!1;const b=c[_],f=c[_+1];let $=c[_+2],y=c[_+3],h=c[_+4];const v=b.type==="system"&&b.metadata?.subtype==="status"&&b.metadata?.init_data?.status==="compacting",C=f.type==="system"&&f.metadata?.subtype==="status"&&(f.metadata?.init_data?.status===null||f.metadata?.init_data?.status===void 0);if($?.type==="system"&&$?.metadata?.subtype==="init"){if(_+4>=c.length)return!1;const T=!0,D=y?.type==="system"&&y?.metadata?.subtype==="compact_boundary",I=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return b.type==="system"&&b.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",_),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",C),console.log("  Msg3 (init):",T),console.log("  Msg4 (boundary):",D),console.log("  Msg5 (continuation):",I)),v&&C&&T&&D&&I}else{const T=$?.type==="system"&&$?.metadata?.subtype==="compact_boundary",D=y?.type==="user"&&y?.content?.startsWith("This session is being continued from a previous conversation");return b.type==="system"&&b.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",_),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",C),console.log("  Msg3 (boundary):",T),console.log("  Msg4 (continuation):",D)),v&&C&&T&&D}}g(()=>e.currentToolCalls);async function l(){s.autoScrollEnabled&&(await Ns(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ce(()=>i.value.length,l),ce(()=>e.currentToolCalls.length,l),ce(()=>e.currentToolCalls.map(p=>`${p.id}-${p.status}`).join(","),l),me(()=>{setTimeout(()=>{l()},100)});function r(p){const c=p.subtype||p.metadata?.subtype;if(p.type==="system"&&c==="init"||p.type==="result"||p.type==="permission_request"||p.type==="permission_response")return!1;if(p.type==="user"&&p.metadata?.has_tool_results){const _=p.content||"";if(_.match(/^Tool results?: \d+ results?$/i)||_.trim()==="")return!1}if(p.type==="user"){const _=p.content||"";if(_.includes("<command-message>")&&_.includes("skill is running")||_.startsWith("Base directory for this skill:"))return!1}if(p.type==="user"){const _=p.content||"";if(_.includes("<command-message>")&&_.includes("<command-name>")&&_.includes("<command-args>")||_.includes("ARGUMENTS:")&&(_.includes("<command-name>")||_.match(/\nARGUMENTS:/)))return!1}return!0}function d(p){return{type:p.type||"unknown",content:p.content||"",timestamp:p.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...p.metadata}}}return(p,c)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),m("div",jh," No messages yet. Start a conversation! ")):L("",!0),(u(!0),m(ae,null,de(i.value,(_,b)=>(u(),m(ae,{key:`item-${b}`},[_.type==="message"?(u(),_e(hu,{key:0,message:d(_.message)},null,8,["message"])):_.type==="compaction"?(u(),_e(Ph,{key:1,messages:_.messages},null,8,["messages"])):L("",!0)],64))),128))],512))}},Vh=K(Rh,[["__scopeId","data-v-b8954c4c"]]),Hh={class:"border-top bg-light"},Wh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Fh={class:"d-flex gap-2 align-items-end px-2 py-1"},Uh=["placeholder","disabled"],Bh=["disabled"],qh={__name:"InputArea",setup(n){const e=ie(),s=je(),o=A(null),i=A(window.innerWidth),a=g({get:()=>e.currentInput,set:h=>{e.currentInput=h}}),l=g(()=>e.currentSession?.is_processing||!1),r=g(()=>s.sessionConnected),d=g(()=>e.currentSession?.state==="starting"),p=g(()=>i.value<768),c=g(()=>d.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function _(){i.value=window.innerWidth}me(()=>{window.addEventListener("resize",_)}),ve(()=>{window.removeEventListener("resize",_)});function b(h){if(h.key==="Enter"&&!h.shiftKey){if(p.value)return;h.preventDefault(),$()}}function f(){const h=o.value;if(!h)return;h.style.height="auto";const v=Math.min(h.scrollHeight,parseInt(getComputedStyle(h).maxHeight));h.style.height=v+"px"}function $(){a.value.trim()&&(s.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function y(){s.interruptSession()}return(h,v)=>(u(),m("div",Hh,[r.value?L("",!0):(u(),m("div",Wh,[...v[1]||(v[1]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),t("div",Fh,[oe(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":v[0]||(v[0]=C=>a.value=C),class:"form-control",placeholder:c.value,disabled:d.value||!r.value,rows:"1",onInput:f,onKeydown:b},null,40,Uh),[[pe,a.value]]),l.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:y}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!r.value||d.value,onClick:$}," Send ",8,Bh))])]))}},zh=K(qh,[["__scopeId","data-v-ef1e5094"]]),Kh={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Gh={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Yh={class:"text-secondary"},Jh={class:"d-flex flex-column flex-grow-1 overflow-hidden"},ri={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ie(),o=fe(),i=g(()=>s.currentSession),a=g(()=>o.isLoading),l=g(()=>o.loadingMessage);return me(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ce(()=>e.sessionId,async(r,d)=>{if(r!==d&&r!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(r)}finally{o.hideLoading()}}}),ve(()=>{}),(r,d)=>(u(),m("div",Kh,[a.value?(u(),m("div",Gh,[d[0]||(d[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Yh,w(l.value),1)])):L("",!0),i.value?(u(),_e(Ni,{key:1,"session-id":e.sessionId},null,8,["session-id"])):L("",!0),t("div",Jh,[re(Vh)]),re(zh),i.value?(u(),_e(ji,{key:2,"session-id":e.sessionId},null,8,["session-id"])):L("",!0),i.value?(u(),_e(zi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):L("",!0)]))}},Qe=$t("legion",()=>{const n=A(new Map),e=A(new Map),s=A(new Map),o=A(new Map),i=A(new Map),a=A(new Map),l=A(null),r=g(()=>n.value.get(l.value)||[]),d=g(()=>e.value.get(l.value)||[]),p=g(()=>s.value.get(l.value)||[]),c=g(()=>o.value.get(l.value)||[]);function _(S){l.value=S}async function b(S,E=100,M=0){try{const N=await se.get(`/api/legions/${S}/timeline?limit=${E}&offset=${M}`),V=N.comms||[],U=N.total_count||V.length,ee=N.has_more||!1;return V.sort((le,B)=>new Date(le.timestamp)-new Date(B.timestamp)),console.log(`Loaded ${V.length} of ${U} comms for legion ${S}`),n.value.set(S,V),n.value=new Map(n.value),{comms:V,totalCount:U,hasMore:ee}}catch(N){throw console.error("Failed to load timeline:",N),N}}function f(S,E){n.value.has(S)||n.value.set(S,[]);const M=n.value.get(S);if(M.some(V=>V.comm_id===E.comm_id)){console.log(`Duplicate comm ${E.comm_id} prevented in timeline`);return}M.push(E),n.value=new Map(n.value),E.to_channel_id&&$(E.to_channel_id,E)}function $(S,E){a.value.has(S)||a.value.set(S,[]);const M=a.value.get(S);if(M.some(V=>V.comm_id===E.comm_id)){console.log(`Duplicate comm ${E.comm_id} prevented in channel ${S}`);return}M.push(E),a.value=new Map(a.value)}async function y(S,E){try{const N=(await se.post(`/api/legions/${S}/comms`,E)).comm;return console.log(`Sent comm ${N.comm_id} to legion ${S}`),N}catch(M){throw console.error("Failed to send comm:",M),M}}async function h(S){return console.log(`Minions for legion ${S} are already available in session store`),[]}async function v(S,E){try{const N=(await se.post(`/api/legions/${S}/minions`,E)).minion;return await h(S),console.log(`Created minion ${N.minion_id} in legion ${S}`),N}catch(M){throw console.error("Failed to create minion:",M),M}}async function C(S){try{const M=(await se.get(`/api/legions/${S}/hordes`)).hordes||[];return console.log(`Loaded ${M.length} hordes for legion ${S}`),s.value.set(S,M),s.value=new Map(s.value),M}catch(E){throw console.error("Failed to load hordes:",E),E}}async function k(S){try{const M=(await se.get(`/api/legions/${S}/channels`)).channels||[];return console.log(`Loaded ${M.length} channels for legion ${S}`),o.value.set(S,M),o.value=new Map(o.value),M}catch(E){throw console.error("Failed to load channels:",E),E}}function T(S,E){o.value.has(S)||o.value.set(S,[]);const M=o.value.get(S);if(M.some(V=>V.channel_id===E.channel_id)){console.log(`Duplicate channel ${E.channel_id} prevented`);return}M.push(E),o.value=new Map(o.value),console.log(`Added channel ${E.name} to legion ${S}`)}async function D(S){try{const E=await se.get(`/api/channels/${S}`),M=E.channel||E;return console.log(`Loaded details for channel ${S}`),i.value.set(S,M),i.value=new Map(i.value),M}catch(E){throw console.error("Failed to load channel details:",E),E}}async function I(S,E=1e3){try{const N=(await se.get(`/api/channels/${S}/comms?limit=${E}`)).comms||[];return console.log(`Loaded ${N.length} comms for channel ${S}`),N.sort((V,U)=>new Date(V.timestamp)-new Date(U.timestamp)),a.value.set(S,N),a.value=new Map(a.value),N}catch(M){throw console.error("Failed to load channel comms:",M),M}}async function x(S,E){try{await se.post(`/api/channels/${S}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:E}),console.log(`Added minion ${E} to channel ${S}`),await D(S)}catch(M){throw console.error("Failed to add member to channel:",M),M}}async function O(S,E){try{await se.post(`/api/channels/${S}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:E}),console.log(`Removed minion ${E} from channel ${S}`),await D(S)}catch(M){throw console.error("Failed to remove member from channel:",M),M}}async function q(S){try{const E=await se.post(`/api/legions/${S}/halt-all`);return console.log(`Halted ${E.halted_count} of ${E.total_minions} minions in legion ${S}`),E.failed_minions&&E.failed_minions.length>0&&console.warn("Failed to halt some minions:",E.failed_minions),E}catch(E){throw console.error("Failed to halt all minions:",E),E}}async function R(S){try{const E=await se.post(`/api/legions/${S}/resume-all`);return console.log(`Resumed ${E.resumed_count} of ${E.total_minions} minions in legion ${S}`),E.failed_minions&&E.failed_minions.length>0&&console.warn("Failed to resume some minions:",E.failed_minions),E}catch(E){throw console.error("Failed to resume all minions:",E),E}}function P(S){n.value.delete(S),e.value.delete(S),s.value.delete(S),o.value.delete(S),n.value=new Map(n.value),e.value=new Map(e.value),s.value=new Map(s.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:s,channelsByLegion:o,channelDetailsByChannel:i,channelCommsByChannel:a,currentLegionId:l,currentComms:r,currentMinions:d,currentHordes:p,currentChannels:c,setCurrentLegion:_,loadTimeline:b,addComm:f,addChannelComm:$,sendComm:y,loadMinions:h,createMinion:v,loadHordes:C,loadChannels:k,addChannel:T,loadChannelDetails:D,loadChannelComms:I,addMemberToChannel:x,removeMemberFromChannel:O,haltAll:q,resumeAll:R,clearLegionData:P}}),Xh=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Qe},Symbol.toStringTag,{value:"Module"})),Qh={class:"timeline-header border-bottom p-3"},Zh={class:"project-name"},e_=["title"],t_={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=g(()=>s.projects.get(e.legionId)),i=g(()=>o.value?.name||"Legion");return(a,l)=>(u(),m("div",Qh,[t("div",null,[t("div",Zh,w(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,e_)])]))}},s_=K(t_,[["__scopeId","data-v-44f386f5"]]),n_={class:"timeline-status-bar border-top p-2 bg-light"},o_={class:"d-flex justify-content-end"},i_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=fe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),m("div",n_,[t("div",o_,[t("button",{class:G(["btn btn-sm",Xt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+w(Xt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},a_=K(i_,[["__scopeId","data-v-891c73db"]]),l_={class:"comm-composer border-top p-3"},r_={key:0,class:"d-flex gap-2 mb-2"},c_={class:"flex-grow-1"},d_=["disabled"],u_={label:"Minions"},m_=["value"],p_={key:0,label:"Channels"},f_=["value"],v_={style:{"min-width":"150px"}},h_=["disabled"],__={class:"d-flex gap-2 align-items-end position-relative"},g_={class:"flex-grow-1 position-relative"},b_=["disabled"],y_=["onClick","onMouseenter"],$_=["disabled"],w_={key:0},E_={key:1},C_={__name:"CommComposer",props:{legionId:{type:String,required:!0},defaultChannelId:{type:String,default:""},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Qe(),o=ie(),i=ge(),a=A(""),l=A("task"),r=A(""),d=A(!1),p=A(window.innerWidth),c=A(!1),_=A([]),b=A(0),f=A(-1),$=A(null),y=A(null),h=g(()=>p.value<768),v=g(()=>{const E=i.projects.get(e.legionId);return!E||!E.session_ids?[]:E.session_ids.map(M=>o.sessions.get(M)).filter(M=>M&&M.is_minion)}),C=g(()=>s.currentChannels||[]),k=g(()=>a.value&&r.value.trim().length>0);function T(E){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[E.state]||"â—‹"}function D(E){return E.is_minion&&E.role?`${E.name} (${E.role})`:E.name}function I(){const E=$.value;if(!E)return;E.style.height="auto";const M=Math.min(E.scrollHeight,parseInt(getComputedStyle(E).maxHeight));E.style.height=M+"px"}function x(){const E=$.value;if(!E)return;I();const M=r.value,N=E.selectionStart,V=M.substring(0,N),U=V.lastIndexOf("#");if(U===-1){c.value=!1;return}const ee=V.substring(U+1).toLowerCase();if(ee.includes(" ")){c.value=!1;return}const le=v.value.filter(B=>B.name.toLowerCase().includes(ee)).map(B=>({type:"minion",name:B.name,role:B.role,id:B.session_id,state:B.state}));if(le.length===0){c.value=!1;return}_.value=le,b.value=0,f.value=U,c.value=!0}function O(){if(!y.value)return;const E=y.value,M=E.children[b.value];if(!M)return;const N=M.offsetTop,V=M.offsetHeight,U=E.scrollTop,ee=E.clientHeight;N<U?E.scrollTop=N:N+V>U+ee&&(E.scrollTop=N+V-ee)}function q(E){if(!c.value){if(E.key==="Enter"&&!E.shiftKey){if(h.value)return;k.value&&(E.preventDefault(),P())}return}if(E.key==="ArrowDown")E.preventDefault(),b.value=(b.value+1)%_.value.length,O();else if(E.key==="ArrowUp")E.preventDefault(),b.value=b.value===0?_.value.length-1:b.value-1,O();else if(E.key==="Enter"){E.preventDefault();const M=_.value[b.value];M&&R(M)}else E.key==="Escape"&&(c.value=!1)}function R(E){const M=$.value;if(!M)return;const N=r.value,V=M.selectionStart,U=N.substring(0,f.value)+"#"+E.name+" "+N.substring(V);r.value=U;const ee=f.value+E.name.length+2;setTimeout(()=>{M.setSelectionRange(ee,ee),M.focus()},0),c.value=!1}async function P(){if(!(!k.value||d.value)){d.value=!0;try{const[E,M]=a.value.split(":"),N={comm_type:l.value,content:r.value.trim()};E==="minion"?N.to_minion_id=M:E==="channel"&&(N.to_channel_id=M),await s.sendComm(e.legionId,N),r.value="",I()}catch(E){console.error("Failed to send comm:",E),alert(`Failed to send comm: ${E.message}`)}finally{d.value=!1}}}function S(){p.value=window.innerWidth}return me(()=>{window.addEventListener("resize",S)}),ve(()=>{window.removeEventListener("resize",S)}),ce(()=>e.defaultChannelId,E=>{E&&(a.value=`channel:${E}`)},{immediate:!0}),ce(c,E=>{if(E){const M=N=>{N.target.closest(".comm-composer")||(c.value=!1,document.removeEventListener("click",M))};setTimeout(()=>document.addEventListener("click",M),0)}}),(E,M)=>(u(),m("div",l_,[n.hideRecipientSelector?L("",!0):(u(),m("div",r_,[t("div",c_,[oe(t("select",{"onUpdate:modelValue":M[0]||(M[0]=N=>a.value=N),class:"form-select form-select-sm",disabled:d.value},[M[3]||(M[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",u_,[(u(!0),m(ae,null,de(v.value,N=>(u(),m("option",{key:N.session_id,value:`minion:${N.session_id}`},w(T(N))+" "+w(D(N)),9,m_))),128))]),C.value.length>0?(u(),m("optgroup",p_,[(u(!0),m(ae,null,de(C.value,N=>(u(),m("option",{key:N.channel_id,value:`channel:${N.channel_id}`}," #ï¸âƒ£ "+w(N.name),9,f_))),128))])):L("",!0)],8,d_),[[Oe,a.value]])]),t("div",v_,[oe(t("select",{"onUpdate:modelValue":M[1]||(M[1]=N=>l.value=N),class:"form-select form-select-sm",disabled:d.value},[...M[4]||(M[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,h_),[[Oe,l.value]])])])),t("div",__,[t("div",g_,[oe(t("textarea",{ref_key:"contentTextarea",ref:$,"onUpdate:modelValue":M[2]||(M[2]=N=>r.value=N),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:d.value,onInput:x,onKeydown:q},null,40,b_),[[pe,r.value]]),c.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:y,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(ae,null,de(_.value,(N,V)=>(u(),m("div",{key:N.id,class:G(["autocomplete-item px-2 py-1",{"bg-light":V===b.value}]),onClick:U=>R(N),onMouseenter:U=>b.value=V},w(N.type==="minion"?T(N):"#ï¸âƒ£")+" "+w(N.name)+w(N.role?` (${N.role})`:""),43,y_))),128))],512)):L("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!k.value||d.value,onClick:P},[d.value?(u(),m("span",w_,[...M[5]||(M[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),X(" Sending... ",-1)])])):(u(),m("span",E_,"Send"))],8,$_)])])]))}},ci=K(C_,[["__scopeId","data-v-fb6899a3"]]),S_={class:"message-content-column-full"},k_=["aria-expanded"],T_={class:"comm-sender-recipient"},x_={class:"comm-badge-summary"},M_=["title"],A_={class:"comm-summary-text text-muted ms-2"},O_=["aria-label"],N_={key:0,class:"comm-content-body"},L_=["innerHTML"],D_="ffffffff-ffff-ffff-ffff-ffffffffffff",I_={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;nt.setOptions({breaks:!0,gfm:!0});const s=A(!1);function o(){s.value=!s.value}const i=g(()=>e.comm.from_minion_id===D_);g(()=>new Date(e.comm.timestamp*1e3).toLocaleTimeString());const a=g(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),l=g(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),r=g(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),d=g(()=>{const p=e.comm.content||"";let c=nt.parse(p);return c=c.replace(/\n</g,"<"),c=c.replace(/\n+$/,""),ns.sanitize(c)});return(p,c)=>(u(),m("div",{class:G(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",S_,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",T_,[t("strong",{class:G({"system-sender":i.value})},w(n.senderName),3),n.recipientName?(u(),m(ae,{key:0},[c[0]||(c[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",{class:G({"recipient-channel":n.comm.to_channel_id})},w(n.recipientName),3)],64)):L("",!0)]),t("div",x_,[t("span",{class:G(["badge",l.value]),title:a.value},w(n.comm.comm_type),11,M_),t("span",A_,w(r.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},w(s.value?"â–¾":"â–¸"),9,O_)],8,k_),s.value?(u(),m("div",N_,[t("div",{class:"message-text",innerHTML:d.value},null,8,L_)])):L("",!0)])],2))}},di=K(I_,[["__scopeId","data-v-f0417455"]]),P_={class:"timeline-view d-flex flex-column h-100"},j_={key:0,class:"text-center text-muted"},R_={key:1,class:"text-center text-danger"},V_={key:2,class:"text-center text-muted"},H_={key:3,class:"comm-list"},W_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Qe(),o=ge(),i=ie(),a=je(),l=fe(),r=A(!0),d=A(null),p=A(null),c=g(()=>o.projects.get(e.legionId));g(()=>c.value?.name||"Legion");const _=g(()=>s.currentComms);g(()=>s.currentMinions);function b(C){return C.from_user?"You":C.from_minion_id?C.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":i.sessions.get(C.from_minion_id)?.name||"Unknown":"Unknown"}function f(C){if(C.to_user)return"You";if(C.to_minion_id)return i.sessions.get(C.to_minion_id)?.name||"Unknown";if(C.to_channel_id){if(C.to_channel_name)return`#${C.to_channel_name}`;const k=s.channelsByLegion.get(e.legionId)?.find(T=>T.channel_id===C.to_channel_id);return k?.name?`#${k.name}`:C.to_channel_id}return"All"}async function $(){l.autoScrollEnabled&&(await Ns(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function y(){r.value=!0,d.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Ns(),await $(),setTimeout(()=>{$()},100)}catch(C){console.error("Failed to load timeline:",C),C.response?d.value=`${C.message} (${C.response.status})`:d.value=C.message||"Unknown error"}finally{r.value=!1}}function h(){a.connectLegion(e.legionId)}function v(){a.disconnectLegion()}return ce(()=>_.value.length,()=>{$()}),me(()=>{y(),h(),setTimeout(()=>{$()},100)}),ve(()=>{v()}),(C,k)=>(u(),m("div",P_,[re(s_,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[r.value?(u(),m("div",j_,[...k[0]||(k[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),X(" Loading timeline... ",-1)])])):d.value?(u(),m("div",R_," Failed to load timeline: "+w(d.value),1)):_.value.length===0?(u(),m("div",V_," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",H_,[(u(!0),m(ae,null,de(_.value,T=>(u(),_e(di,{key:T.comm_id,comm:T,"sender-name":b(T),"recipient-name":f(T)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),re(ci,{"legion-id":n.legionId},null,8,["legion-id"]),re(a_,{"legion-id":n.legionId},null,8,["legion-id"])]))}},F_=K(W_,[["__scopeId","data-v-3308d82d"]]),U_={class:"spy-view d-flex flex-column overflow-hidden"},B_={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){const e=n,s=je();return me(()=>{s.connectLegion(e.legionId)}),ss(()=>{s.disconnectLegion()}),(o,i)=>(u(),m("div",U_,[re(ri,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},q_=K(B_,[["__scopeId","data-v-21206f91"]]),z_={class:"horde-header border-bottom p-3"},K_={class:"d-flex justify-content-between align-items-center"},G_={class:"project-name"},Y_={class:"fleet-controls d-flex gap-2"},J_=["disabled"],X_={key:0,class:"spinner-border spinner-border-sm me-1"},Q_=["disabled"],Z_={key:0,class:"spinner-border spinner-border-sm me-1"},eg={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=ie(),i=fe(),a=g(()=>s.projects.get(e.legionId)),l=g(()=>a.value?.name||"Legion"),r=g(()=>Array.from(o.sessions.values()).filter($=>$.is_minion&&$.project_id===e.legionId)),d=g(()=>r.value.filter(f=>f.state==="active")),p=g(()=>r.value.length===0||d.value.length===0),c=g(()=>r.value.length===0);function _(){i.showModal("fleet-control",{legionId:e.legionId,operation:"halt",activeMinionsCount:d.value.length,totalMinionsCount:r.value.length})}function b(){i.showModal("fleet-control",{legionId:e.legionId,operation:"resume",activeMinionsCount:d.value.length,totalMinionsCount:r.value.length})}return(f,$)=>(u(),m("div",z_,[t("div",K_,[t("div",null,[t("div",G_,w(l.value),1),$[0]||($[0]=t("div",{class:"view-name"},"Minion Hierarchy",-1))]),t("div",Y_,[t("button",{class:"btn btn-sm btn-outline-warning",disabled:p.value||f.isOperating,onClick:_,title:"Emergency halt all active minions"},[f.isOperating&&f.lastOperation==="halt"?(u(),m("span",X_)):L("",!0),$[1]||($[1]=X(" Halt All ",-1))],8,J_),t("button",{class:"btn btn-sm btn-outline-success",disabled:c.value||f.isOperating,onClick:b,title:"Resume all minions"},[f.isOperating&&f.lastOperation==="resume"?(u(),m("span",Z_)):L("",!0),$[2]||($[2]=X(" Resume All ",-1))],8,Q_)])])]))}},tg=K(eg,[["__scopeId","data-v-11702b07"]]),sg={class:"horde-status-bar border-top p-2 bg-light"},ng={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,s)=>(u(),m("div",sg,[...s[0]||(s[0]=[t("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},og=K(ng,[["__scopeId","data-v-f0e64ab0"]]),ig={class:"minion-card border-start border-2 mb-2"},ag={class:"node-row"},lg={class:"node-left"},rg={key:0,class:"me-2"},cg={key:1,class:"badge bg-secondary ms-2"},dg={class:"node-right"},ug={key:0,class:"last-comm-preview"},mg={class:"comm-direction"},pg=["title"],fg={key:1,class:"text-muted fst-italic small"},vg={key:0,class:"minion-children"},hg={key:1,class:"text-danger small ms-4"},_g={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,s=g(()=>e.level*24),o=g(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=g(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=g(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),l=g(()=>{const c=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[c]||"status-dot-grey"}),r=g(()=>{const c=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}});function d(c){return c.to_user?"User":c.to_minion_name?c.to_minion_name:c.to_channel_name?`#${c.to_channel_name}`:"unknown"}function p(c){const _=c.summary||c.content||"";return _.length>150?_.substring(0,150)+"...":_}return(c,_)=>{const b=io("MinionTreeNode",!0);return n.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:He({marginLeft:`${s.value}px`})},[t("div",ig,[t("div",ag,[t("div",lg,[t("div",{class:G(["status-dot me-2",l.value]),style:He(r.value)},null,6),i.value?(u(),m("span",rg,"ðŸ‘‘")):L("",!0),t("strong",null,w(n.minionData.name),1),i.value?(u(),m("span",cg,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):L("",!0)]),t("div",dg,[n.minionData.last_comm?(u(),m("div",ug,[t("span",mg,[_[0]||(_[0]=X(" â†’ ",-1)),t("strong",null,w(d(n.minionData.last_comm)),1),_[1]||(_[1]=X(": ",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},w(p(n.minionData.last_comm)),9,pg)])):(u(),m("div",fg," No communications yet "))])])]),o.value?(u(),m("div",vg,[(u(!0),m(ae,null,de(n.minionData.children,f=>(u(),_e(b,{key:f.id,"minion-data":f,level:n.level+1},null,8,["minion-data","level"]))),128))])):L("",!0)],4)):(u(),m("div",hg," âš  Minion data is missing "))}}},gg=K(_g,[["__scopeId","data-v-1cd9863f"]]),bg={class:"modal-dialog modal-dialog-centered"},yg={class:"modal-content"},$g={class:"modal-header"},wg={class:"modal-title",id:"fleetControlModalLabel"},Eg={class:"modal-body"},Cg={key:0,class:"text-center py-4"},Sg={class:"text-muted"},kg={key:1},Tg={class:"text-muted"},xg={key:2},Mg={class:"text-muted"},Ag={key:3},Og={class:"text-muted"},Ng={class:"modal-footer"},Lg={key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},Dg={__name:"FleetControlModal",setup(n){const e=fe(),s=Qe(),o=A(!1),i=A(""),a=A(null),l=A(null),r=A(null);let d=null;const p=A(null),c=A(0),_=A(0),b=g(()=>l.value?l.value.type==="success"?"Success":"Error":a.value==="halt"?"Emergency Halt All Minions":a.value==="resume"?"Resume All Minions":"Fleet Control");me(()=>{r.value&&(d=new Fe(r.value),r.value.addEventListener("hidden.bs.modal",()=>{a.value=null,l.value=null,o.value=!1}))}),ve(()=>{d&&d.dispose()}),ce(()=>e.currentModal,v=>{if(!v||v.name!=="fleet-control")return;const C=v.data;C&&(p.value=C.legionId,c.value=C.activeMinionsCount||0,_.value=C.totalMinionsCount||0,a.value=C.operation,l.value=null,d&&d.show())});function f(){a.value=null,d&&d.hide()}async function $(){a.value==="halt"?await y():a.value==="resume"&&await h()}async function y(){o.value=!0,i.value="Halting all minions...";try{const v=await s.haltAll(p.value),C=v.failed_minions&&v.failed_minions.length>0?` Failed to halt ${v.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Halt Complete",message:`Halted ${v.halted_count} of ${v.total_minions} minion(s).${C}`}}catch(v){console.error("Failed to halt all minions:",v),l.value={type:"error",title:"Halt Failed",message:`Failed to halt minions: ${v.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}async function h(){o.value=!0,i.value="Resuming all minions...";try{const v=await s.resumeAll(p.value),C=v.failed_minions&&v.failed_minions.length>0?` Failed to resume ${v.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Resume Complete",message:`Resumed ${v.resumed_count} of ${v.total_minions} minion(s).${C}`}}catch(v){console.error("Failed to resume all minions:",v),l.value={type:"error",title:"Resume Failed",message:`Failed to resume minions: ${v.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}return(v,C)=>(u(),m("div",{class:"modal fade",id:"fleetControlModal",tabindex:"-1","aria-labelledby":"fleetControlModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",bg,[t("div",yg,[t("div",$g,[t("h5",wg,w(b.value),1),C[0]||(C[0]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",Eg,[o.value?(u(),m("div",Cg,[C[1]||(C[1]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Processing...")],-1)),t("p",Sg,w(i.value),1)])):l.value?(u(),m("div",kg,[t("div",{class:G(["alert mb-3",l.value.type==="success"?"alert-success":"alert-danger"])},[t("strong",null,w(l.value.title),1)],2),t("p",Tg,w(l.value.message),1)])):a.value==="halt"?(u(),m("div",xg,[C[4]||(C[4]=t("div",{class:"alert alert-warning mb-3"},[t("strong",null,"âš ï¸ Emergency Halt")],-1)),t("p",Mg,[C[2]||(C[2]=X(" Are you sure you want to halt all ",-1)),t("strong",null,w(c.value),1),C[3]||(C[3]=X(" active minion(s) in this legion? ",-1))]),C[5]||(C[5]=t("p",{class:"text-muted"}," This will interrupt their current processing. Minions will remain in ACTIVE state but will stop processing. ",-1))])):a.value==="resume"?(u(),m("div",Ag,[C[8]||(C[8]=t("div",{class:"alert alert-info mb-3"},[t("strong",null,"Resume All Minions")],-1)),t("p",Og,[C[6]||(C[6]=X(' This will send "continue" to all ',-1)),t("strong",null,w(_.value),1),C[7]||(C[7]=X(" minion(s) in this legion. ",-1))]),C[9]||(C[9]=t("p",{class:"text-muted"}," Minions will resume processing from where they were interrupted. ",-1))])):L("",!0)]),t("div",Ng,[l.value?(u(),m("button",Lg,"OK")):a.value&&!o.value?(u(),m(ae,{key:1},[t("button",{type:"button",class:"btn btn-secondary",onClick:f},"Cancel"),t("button",{type:"button",class:G(["btn",a.value==="halt"?"btn-warning":"btn-success"]),onClick:$},w(a.value==="halt"?"Halt All":"Resume All"),3)],64)):L("",!0)])])])],512))}},Ig=K(Dg,[["__scopeId","data-v-53a63f8d"]]),Pg={class:"horde-view d-flex flex-column h-100"},jg={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},Rg={key:0,class:"text-center py-5"},Vg={key:1,class:"alert alert-danger"},Hg={class:"mb-0"},Wg={key:2,class:"horde-tree"},Fg={class:"user-root-node mb-3 border rounded bg-white"},Ug={class:"node-row"},Bg={class:"node-left"},qg={key:0,class:"badge bg-primary ms-2"},zg={class:"node-right"},Kg={key:0,class:"last-comm-preview"},Gg={class:"comm-direction"},Yg=["title"],Jg={key:1,class:"text-muted fst-italic"},Xg={key:0,class:"alert alert-info ms-4"},Qg={key:1,class:"root-minions ms-4"},Zg={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=ie(),i=je(),a=Qe(),l=A(null),r=A(!1),d=A(null);g(()=>s.projects.get(e.legionId));const p=g(()=>l.value&&l.value.children&&l.value.children.length>0);async function c(){r.value=!0,d.value=null;try{const y=await se.get(`/api/legions/${e.legionId}/hordes`);l.value=y,console.log("Loaded hierarchy:",y)}catch(y){console.error("Failed to load hierarchy:",y),d.value=y.message||"Unknown error"}finally{r.value=!1}}me(()=>{c()}),ce(()=>e.legionId,()=>{c()});function _(y){return y.to_user?"User":y.to_minion_name?y.to_minion_name:y.to_channel_name?`#${y.to_channel_name}`:"unknown"}function b(y){const h=y.summary||y.content||"";return h.length>150?h.substring(0,150)+"...":h}function f(y,h){if(y.id===h)return y;if(y.children)for(const v of y.children){const C=f(v,h);if(C)return C}return null}function $(y){if(l.value){if(y.from_minion_id){const h=f(l.value,y.from_minion_id);h&&h.type==="minion"&&(h.last_comm=y,console.log(`Updated minion ${h.name} last_comm`))}y.from_user&&l.value.type==="user"&&(l.value.last_comm=y,console.log("Updated user last_comm"))}}return me(()=>{c(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),ce(()=>o.sessions,y=>{if(l.value){for(const[h,v]of y)if(v.is_minion&&v.project_id===e.legionId){const C=f(l.value,h);C&&C.type==="minion"&&(C.state!==v.state&&(C.state=v.state,console.log(`Updated minion ${C.name} state to ${v.state}`)),C.is_processing!==v.is_processing&&(C.is_processing=v.is_processing,console.log(`Updated minion ${C.name} is_processing to ${v.is_processing}`)))}}},{deep:!0}),ce(()=>a.commsByLegion.get(e.legionId),y=>{if(y&&y.length>0){const h=y[y.length-1];$(h)}},{deep:!0}),ce(()=>o.sessions.size,(y,h)=>{y>h&&Array.from(o.sessions.values()).some(k=>k.is_minion&&k.project_id===e.legionId&&!f(l.value,k.session_id))&&(console.log("New minion detected, reloading hierarchy"),c())})}),ve(()=>{console.log("HordeView unmounted")}),(y,h)=>(u(),m("div",Pg,[re(tg,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",jg,[r.value?(u(),m("div",Rg,[...h[0]||(h[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):d.value?(u(),m("div",Vg,[h[1]||(h[1]=t("strong",null,"Failed to load hierarchy",-1)),t("p",Hg,w(d.value),1)])):l.value?(u(),m("div",Wg,[t("div",Fg,[t("div",Ug,[t("div",Bg,[h[2]||(h[2]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,w(l.value.name),1),p.value?(u(),m("span",qg,w(l.value.children.length)+" "+w(l.value.children.length===1?"minion":"minions"),1)):L("",!0)]),t("div",zg,[l.value.last_comm?(u(),m("div",Kg,[t("span",Gg,[h[3]||(h[3]=X(" â†’ ",-1)),t("strong",null,w(_(l.value.last_comm)),1),h[4]||(h[4]=X(": ",-1))]),t("span",{class:"comm-content",title:l.value.last_comm.content||""},w(b(l.value.last_comm)),9,Yg)])):(u(),m("div",Jg," No communications yet "))])])]),p.value?(u(),m("div",Qg,[(u(!0),m(ae,null,de(l.value.children,v=>(u(),_e(gg,{key:v.id,"minion-data":v,level:1},null,8,["minion-data"]))),128))])):(u(),m("div",Xg,[...h[5]||(h[5]=[t("p",{class:"mb-2"},"No minions yet",-1),t("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):L("",!0)]),re(og,{"legion-id":n.legionId},null,8,["legion-id"]),re(Ig)]))}},eb=K(Zg,[["__scopeId","data-v-268a223f"]]),tb={class:"channel-status-bar d-flex gap-2"},sb={class:"button-label"},nb={__name:"ChannelStatusBar",props:{channel:{type:Object,required:!0},members:{type:Array,default:()=>[]},legionId:{type:String,required:!0}},setup(n){const e=n,s=fe(),o=g(()=>e.members?.length||0);function i(){s.showModal("channel-info",{channel:e.channel})}function a(){s.showModal("channel-members",{channel:e.channel,members:e.members,legionId:e.legionId,channelId:e.channel.channel_id})}return(l,r)=>(u(),m("div",tb,[t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:i,title:"View channel information"},[...r[0]||(r[0]=[t("span",{class:"button-icon"},"ðŸ“‹",-1),t("span",{class:"button-label"},"Info",-1)])]),t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:a,title:"View channel members"},[r[1]||(r[1]=t("span",{class:"button-icon"},"ðŸ‘¥",-1)),t("span",sb,"Members ("+w(o.value)+")",1)])]))}},ob=K(nb,[["__scopeId","data-v-f497955c"]]),ib={class:"modal-dialog modal-dialog-centered"},ab={class:"modal-content"},lb={class:"modal-body"},rb={key:0},cb={class:"info-section"},db={class:"info-value"},ub={class:"info-section"},mb={class:"info-value"},pb={key:0,class:"info-section"},fb={class:"info-value"},vb={class:"info-section"},hb={class:"info-value"},_b={class:"info-section"},gb={class:"info-value"},bb={class:"info-section"},yb={class:"info-value"},$b={style:{"font-size":"0.85rem"}},wb={key:1,class:"text-muted text-center py-3"},Eb={__name:"ChannelInfoModal",setup(n){const e=fe(),s=A(null);let o=null;const i=A(null);ce(()=>e.currentModal,l=>{l?.name==="channel-info"&&o&&(i.value=l.data?.channel||null,o.show())});function a(l){if(!l)return"Unknown";try{return new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return l}}return me(()=>{if(s.value){const l=window.bootstrap;l&&l.Modal&&(o=new l.Modal(s.value),s.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),i.value=null}))}}),ss(()=>{o&&o.dispose()}),(l,r)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",id:"channelInfoModal",tabindex:"-1","aria-labelledby":"channelInfoModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",ib,[t("div",ab,[r[6]||(r[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelInfoModalLabel"},"Channel Information"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",lb,[i.value?(u(),m("div",rb,[t("div",cb,[r[0]||(r[0]=t("label",null,"Channel Name",-1)),t("div",db,w(i.value.name),1)]),t("div",ub,[r[1]||(r[1]=t("label",null,"Purpose",-1)),t("div",mb,w(i.value.purpose||"No purpose specified"),1)]),i.value.description&&i.value.description!==i.value.purpose?(u(),m("div",pb,[r[2]||(r[2]=t("label",null,"Description",-1)),t("div",fb,w(i.value.description),1)])):L("",!0),t("div",vb,[r[3]||(r[3]=t("label",null,"Created",-1)),t("div",hb,w(a(i.value.created_at)),1)]),t("div",_b,[r[4]||(r[4]=t("label",null,"Members",-1)),t("div",gb,w(i.value.member_minion_ids?.length||0)+" member(s)",1)]),t("div",bb,[r[5]||(r[5]=t("label",null,"Channel ID",-1)),t("div",yb,[t("code",$b,w(i.value.channel_id),1)])])])):(u(),m("div",wb," No channel data available "))]),r[7]||(r[7]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},Cb=K(Eb,[["__scopeId","data-v-3d7eceff"]]),Sb={class:"modal-dialog modal-dialog-centered"},kb={class:"modal-content"},Tb={class:"modal-body"},xb={class:"mb-3"},Mb=["disabled"],Ab={key:0,class:"text-muted ms-2"},Ob={key:1,class:"mt-2"},Nb=["disabled"],Lb=["value"],Db={key:0,class:"text-muted small mt-1"},Ib={key:0,class:"member-count"},Pb={key:1,class:"member-list"},jb={class:"member-info"},Rb={class:"member-name"},Vb={key:0,class:"member-role"},Hb={class:"member-state"},Wb={class:"status-text"},Fb=["onClick","disabled"],Ub={key:2,class:"empty-state text-center py-4"},Bb={__name:"ChannelMembersModal",setup(n){const e=fe(),s=Qe(),o=ie(),i=ge(),a=A(null);let l=null;const r=A(null),d=A([]),p=A(null),c=A(null),_=A(""),b=A(!1),f=A(!1),$=A(!1),y=g(()=>{if(!p.value)return[];const D=i.projects.get(p.value);if(!D||!D.session_ids)return[];const I=D.session_ids.map(O=>o.sessions.get(O)).filter(Boolean),x=new Set(d.value.map(O=>O.session_id));return I.filter(O=>!x.has(O.session_id))});ce(()=>e.currentModal,D=>{D?.name==="channel-members"&&l&&(r.value=D.data?.channel||null,d.value=D.data?.members||[],p.value=D.data?.legionId||null,c.value=D.data?.channelId||null,b.value=!1,_.value="",l.show())});function h(D){return D==="processing"||D==="starting"?"status-blinking":""}function v(D){return{backgroundColor:{created:"#6c757d",starting:"#28a745",active:"#28a745",processing:"#da70d6",paused:"#ffc107",error:"#dc3545",terminated:"#6c757d"}[D]||"#6c757d"}}function C(D){return D?D.charAt(0).toUpperCase()+D.slice(1).replace(/_/g," "):"Unknown"}async function k(){if(!(!_.value||!c.value)){f.value=!0;try{await s.addMemberToChannel(c.value,_.value);const D=await s.loadChannelDetails(c.value);D?.member_minion_ids&&(d.value=D.member_minion_ids.map(I=>o.sessions.get(I)).filter(Boolean)),_.value="",b.value=!1}catch(D){console.error("Failed to add member:",D),alert(`Failed to add member: ${D.message}`)}finally{f.value=!1}}}async function T(D){if(!D||!c.value)return;const I=d.value.find(x=>x.session_id===D);if(confirm(`Remove ${I?.name||"this member"} from the channel?`)){$.value=!0;try{await s.removeMemberFromChannel(c.value,D);const x=await s.loadChannelDetails(c.value);x?.member_minion_ids&&(d.value=x.member_minion_ids.map(O=>o.sessions.get(O)).filter(Boolean))}catch(x){console.error("Failed to remove member:",x),alert(`Failed to remove member: ${x.message}`)}finally{$.value=!1}}}return me(()=>{if(a.value){const D=window.bootstrap;D&&D.Modal&&(l=new D.Modal(a.value),a.value.addEventListener("hidden.bs.modal",()=>{e.hideModal(),r.value=null,d.value=[]}))}}),ss(()=>{l&&l.dispose()}),(D,I)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",id:"channelMembersModal",tabindex:"-1","aria-labelledby":"channelMembersModalLabel","aria-hidden":"true","data-bs-backdrop":"true","data-bs-keyboard":"true"},[t("div",Sb,[t("div",kb,[I[5]||(I[5]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"channelMembersModalLabel"},"Channel Members"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Tb,[t("div",xb,[t("button",{class:"btn btn-sm btn-primary",onClick:I[0]||(I[0]=x=>b.value=!b.value),disabled:f.value||y.value.length===0}," âž• Add Member ",8,Mb),y.value.length===0?(u(),m("small",Ab," (All minions are already members) ")):L("",!0),b.value&&y.value.length>0?(u(),m("div",Ob,[oe(t("select",{"onUpdate:modelValue":I[1]||(I[1]=x=>_.value=x),class:"form-select form-select-sm",onChange:k,disabled:f.value},[I[2]||(I[2]=t("option",{value:""},"-- Select minion to add --",-1)),(u(!0),m(ae,null,de(y.value,x=>(u(),m("option",{key:x.session_id,value:x.session_id},w(x.name)+" "+w(x.role?`(${x.role})`:"(No role)"),9,Lb))),128))],40,Nb),[[Oe,_.value]]),f.value?(u(),m("div",Db,[...I[3]||(I[3]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),X(" Adding member... ",-1)])])):L("",!0)])):L("",!0)]),d.value&&d.value.length>0?(u(),m("p",Ib,w(d.value.length)+" "+w(d.value.length===1?"member":"members"),1)):L("",!0),d.value&&d.value.length>0?(u(),m("div",Pb,[(u(!0),m(ae,null,de(d.value,x=>(u(),m("div",{key:x.session_id,class:"member-item"},[t("div",jb,[t("div",Rb,w(x.name),1),x.role?(u(),m("div",Vb,w(x.role),1)):L("",!0),t("div",Hb,[t("span",{class:G(["status-dot",h(x.state)]),style:He(v(x.state))},null,6),t("span",Wb,w(C(x.state)),1)])]),t("button",{class:"btn btn-sm btn-outline-danger",onClick:O=>T(x.session_id),disabled:$.value,title:"Remove from channel"}," ðŸ—‘ï¸ ",8,Fb)]))),128))])):(u(),m("div",Ub,[...I[4]||(I[4]=[t("p",{class:"text-muted mb-0"},"No members in this channel yet.",-1)])]))]),I[6]||(I[6]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])],512))}},qb=K(Bb,[["__scopeId","data-v-28fb4eaa"]]),zb={class:"channel-view d-flex flex-column h-100"},Kb={class:"channel-header border-bottom p-3"},Gb={class:"d-flex align-items-center justify-content-between"},Yb={class:"mb-0"},Jb={class:"text-muted"},Xb={class:"badge bg-secondary"},Qb={class:"channel-content flex-grow-1 overflow-auto"},Zb={key:0,class:"text-center text-muted py-4"},ey={key:1,class:"text-center text-danger py-4"},ty={key:2,class:"text-center text-muted py-4"},sy={key:3,class:"pb-5"},ny={class:"comms-section"},oy={class:"text-muted border-bottom pb-2 px-3"},iy={key:0,class:"text-center text-muted py-4"},ay={key:1,class:"text-center text-muted py-3"},ly={key:2,class:"comm-list"},ry={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,s=Qe(),o=ge(),i=ie(),a=je(),l=A(!0),r=A(null),d=A(!1),p=g(()=>o.projects.get(e.legionId)),c=g(()=>s.channelDetailsByChannel.get(e.channelId)),_=g(()=>s.channelCommsByChannel.get(e.channelId)||[]),b=g(()=>c.value?.member_minion_ids?.length||0),f=g(()=>_.value.length),$=g(()=>c.value?.member_minion_ids?c.value.member_minion_ids.map(k=>i.sessions.get(k)).filter(Boolean):[]);function y(k){return k.from_user?"You":k.from_minion_name?k.from_minion_name:k.from_minion_id&&i.sessions.get(k.from_minion_id)?.name||"Unknown"}function h(k){return""}function v(){a.connectLegion(e.legionId)}function C(){a.disconnectLegion()}return me(async()=>{l.value=!0;try{s.setCurrentLegion(e.legionId),await s.loadChannels(e.legionId),await s.loadChannelDetails(e.channelId),d.value=!0,await s.loadChannelComms(e.channelId,1e3),d.value=!1}catch(k){console.error("Failed to load channel:",k),r.value=k.message||"Unknown error"}finally{l.value=!1}v()}),ce(()=>e.channelId,async k=>{if(k){l.value=!0,r.value=null;try{s.setCurrentLegion(e.legionId),await s.loadChannels(e.legionId),await s.loadChannelDetails(k),d.value=!0,await s.loadChannelComms(k,1e3),d.value=!1}catch(T){console.error("Failed to load channel:",T),r.value=T.message||"Unknown error"}finally{l.value=!1}}}),ve(()=>{C()}),(k,T)=>(u(),m("div",zb,[t("div",Kb,[t("div",Gb,[t("div",null,[t("h5",Yb," ðŸ’¬ "+w(c.value?.name||"Channel"),1),t("small",Jb,w(p.value?.name||"Legion"),1)]),t("span",Xb,w(b.value)+" members",1)])]),t("div",Qb,[l.value?(u(),m("div",Zb,[...T[0]||(T[0]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading channel...",-1)])])):r.value?(u(),m("div",ey," Failed to load channel: "+w(r.value),1)):c.value?(u(),m("div",sy,[t("div",ny,[t("h6",oy,"Communications ("+w(f.value)+")",1),d.value?(u(),m("div",iy,[...T[1]||(T[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("div",{class:"mt-2"},"Loading comms...",-1)])])):_.value.length===0?(u(),m("div",ay," No communications in this channel yet ")):(u(),m("div",ly,[(u(!0),m(ae,null,de(_.value,D=>(u(),_e(di,{key:D.comm_id,comm:D,"sender-name":y(D),"recipient-name":h()},null,8,["comm","sender-name","recipient-name"]))),128))]))])])):(u(),m("div",ty," Channel not found "))]),c.value?(u(),_e(ci,{key:0,"legion-id":n.legionId,"default-channel-id":n.channelId,"hide-recipient-selector":!0},null,8,["legion-id","default-channel-id"])):L("",!0),c.value?(u(),_e(ob,{key:1,channel:c.value,members:$.value,"legion-id":n.legionId},null,8,["channel","members","legion-id"])):L("",!0),re(Cb),re(qb)]))}},cy=K(ry,[["__scopeId","data-v-3a1df0e4"]]),dy=[{path:"/",name:"home",component:$i},{path:"/session/:sessionId",name:"session",component:ri,props:!0},{path:"/timeline/:legionId",name:"timeline",component:F_,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:q_,props:!0},{path:"/horde/:legionId",name:"horde",component:eb,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:cy,props:!0}],uy=vi({history:hi(),routes:dy}),my={class:"connection-indicators"},py=["title"],fy=["title"],vy=["title"],hy={__name:"ConnectionIndicator",setup(n){const e=je();function s(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:r}=a[i];return r>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:d,retryCount:p}=r[i];let c="Disconnected";return d?c="Connected":p>0&&(c=`Reconnecting (attempt ${p})`),`${a[i]}
${l[i]}
Status: ${c}`}return(i,a)=>(u(),m("div",my,[t("div",{class:G(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,py),t("div",{class:G(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,fy),t("div",{class:G(["indicator",s("legion")]),title:o("legion")}," ðŸ‘¥ ",10,vy)]))}},_y=K(hy,[["__scopeId","data-v-d35b07c8"]]),gy={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},by={class:"d-flex align-items-center gap-2"},yy={__name:"AppHeader",setup(n){const e=fe();function s(){e.toggleSidebar()}return(o,i)=>(u(),m("header",gy,[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...i[0]||(i[0]=[t("span",null,"â˜°",-1)])]),i[1]||(i[1]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",by,[re(_y)])]))}},$y={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},wy={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Ey=["title"],Cy={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(r){return r.state==="paused"&&r.is_processing?"pending-prompt":r.is_processing?"processing":r.state}function i(r){const d=o(r);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[d]||"#d3d3d3"}function a(r){const d=o(r);return d==="starting"||d==="processing"||d==="pending-prompt"}function l(r){const d=o(r),p=d.charAt(0).toUpperCase()+d.slice(1),c=r.name||"Unnamed Session",_=r.is_minion&&r.role?` (${r.role})`:"";return`${c}${_}: ${p}`}return(r,d)=>(u(),m("div",$y,[!n.sessions||n.sessions.length===0?(u(),m("div",wy)):(u(!0),m(ae,{key:1},de(n.sessions,p=>(u(),m("div",{key:p.session_id,class:G(["progress-bar",{"progress-bar-striped progress-bar-animated":a(p)}]),style:He({width:s.value,backgroundColor:i(p),cursor:"help"}),title:l(p)},null,14,Ey))),128))]))}},Sy=K(Cy,[["__scopeId","data-v-a79cfeec"]]),ky={class:"flex-grow-1"},Ty={key:0,class:"text-muted small ms-1"},xy={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,s=Ge(),o=ie(),i=ge(),a=fe(),l=g(()=>o.currentSessionId===e.session.session_id),r=g(()=>o.deletingSessions.has(e.session.session_id)),d=g(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),p=g(()=>{const v=d.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[v]||"status-dot-grey"}),c=g(()=>{const v=d.value,C={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},k={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:C[v]||"#d3d3d3",borderColor:k[v]||"#6c757d"}});function _(){o.selectSession(e.session.session_id),s.push(`/session/${e.session.session_id}`)}function b(){a.showModal("edit-session",{session:e.session})}function f(v){v.dataTransfer.effectAllowed="move",v.dataTransfer.setData("application/session-id",e.session.session_id),v.dataTransfer.setData("application/project-id",e.projectId),v.dataTransfer.setData("text/plain",e.session.session_id),v.target.classList.add("dragging")}function $(v){v.target.classList.remove("dragging")}function y(v){v.preventDefault(),v.dataTransfer.dropEffect="move";const C=v.currentTarget.getBoundingClientRect(),k=C.top+C.height/2;v.clientY<k?(v.currentTarget.classList.add("drop-above"),v.currentTarget.classList.remove("drop-below")):(v.currentTarget.classList.add("drop-below"),v.currentTarget.classList.remove("drop-above"))}function h(v){v.preventDefault(),v.currentTarget.classList.remove("drop-above","drop-below");const C=v.dataTransfer.getData("application/session-id")||v.dataTransfer.getData("text/plain"),k=v.dataTransfer.getData("application/project-id");if(!C||C===e.session.session_id||k!==e.projectId)return;const T=v.currentTarget.getBoundingClientRect(),D=T.top+T.height/2,I=v.clientY<D,x=i.getProject(e.projectId);if(!x||!x.session_ids)return;const O=[...x.session_ids],q=O.indexOf(e.session.session_id),R=O.indexOf(C);if(q===-1||R===-1)return;const P=[...O],[S]=P.splice(R,1);let E=I?q:q+1;R<q&&E--,P.splice(E,0,S),i.reorderSessionsInProject(e.projectId,P)}return(v,C)=>(u(),m("div",{class:G(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:l.value,"session-deleting":r.value}]),style:{cursor:"pointer"},draggable:"true",onClick:_,onDragstart:f,onDragend:$,onDragover:y,onDrop:h},[t("div",{class:G(["status-dot me-2",p.value]),style:He(c.value)},null,6),t("div",ky,[t("span",null,w(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(u(),m("span",Ty,"("+w(n.session.role)+")",1)):L("",!0)]),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:Ee(b,["stop"])}," âœï¸ ")],34))}},My=K(xy,[["__scopeId","data-v-07ecbf94"]]),Ay={class:"d-flex align-items-center gap-2"},Oy=["value"],Ny={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ge(),o=ie(),i=fe(),a=A("");ce(()=>s.currentRoute.value,y=>{!a.value&&y.name==="spy"&&y.params.minionId&&y.params.legionId===e.project.project_id&&(a.value=y.params.minionId)},{immediate:!0});const l=g(()=>a.value?e.sessions.find(y=>y.session_id===a.value):null),r=g(()=>{const y=s.currentRoute.value;return y.name==="spy"&&y.params.legionId===e.project.project_id}),d=g(()=>{if(!l.value)return"";if(l.value.state==="paused"&&l.value.is_processing)return"status-blinking";const y=l.value.is_processing?"processing":l.value.state;return y==="starting"||y==="processing"?"status-blinking":""}),p=g(()=>{if(!l.value)return{};if(l.value.state==="paused"&&l.value.is_processing)return{backgroundColor:"#ffc107"};const y=l.value.is_processing?"processing":l.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[y]||"#d3d3d3"}});function c(y){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[y.state]||"â—‹"}function _(y){return y.is_minion&&y.role?`${y.name} (${y.role})`:y.name}function b(){a.value&&s.push(`/spy/${e.project.project_id}/${a.value}`)}function f(){a.value?s.push(`/spy/${e.project.project_id}/${a.value}`):s.push("/")}function $(){l.value&&i.showModal("minion-view",{session:l.value})}return ce(()=>o.currentSessionId,y=>{if(y)e.sessions.some(h=>h.session_id===y)&&(a.value=y);else{a.value="";const h=s.currentRoute.value;h.name==="spy"&&h.params.legionId===e.project.project_id&&s.push("/")}}),(y,h)=>(u(),m("div",{class:G(["list-group-item list-group-item-action p-2",{active:r.value}])},[t("div",{class:"d-flex align-items-center justify-content-between mb-2",style:He({cursor:a.value?"pointer":"default"}),onClick:b},[h[1]||(h[1]=t("div",{class:"d-flex align-items-center"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ”"),t("span",{class:"fw-semibold"},"Spy"),t("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),t("div",Ay,[l.value?(u(),m("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:Ee($,["stop"]),title:"View minion details"}," ðŸ‘ï¸ ")):L("",!0),l.value?(u(),m("span",{key:1,class:G(["minion-state-indicator",d.value]),style:He(p.value)}," ðŸ‘¤ ",6)):L("",!0)])],4),oe(t("select",{"onUpdate:modelValue":h[0]||(h[0]=v=>a.value=v),class:"form-select form-select-sm",onChange:f},[h[2]||(h[2]=t("option",{value:""},"-- Select Minion --",-1)),(u(!0),m(ae,null,de(n.sessions,v=>(u(),m("option",{key:v.session_id,value:v.session_id},w(c(v))+" "+w(_(v)),9,Oy))),128))],544),[[Oe,a.value]])],2))}},Ly=K(Ny,[["__scopeId","data-v-579589fb"]]),Dy={class:"modal-dialog modal-dialog-centered"},Iy={class:"modal-content"},Py={class:"modal-body"},jy={key:0,class:"alert alert-danger"},Ry={class:"mb-3"},Vy={class:"mb-3"},Hy={class:"form-text"},Wy={class:"mb-3"},Fy={class:"mb-3"},Uy=["value"],By={class:"modal-footer"},qy=["disabled"],zy={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:s}){const o=n,i=s,a=ie(),l=A(null),r=A(null),d=A(""),p=A(!1),c=A({name:"",purpose:"",description:"",member_minion_ids:[]}),_=g(()=>{const h=[];for(const[v,C]of a.sessions.entries())C.is_minion&&C.project_id===o.legionId&&h.push(C);return h}),b=g(()=>c.value.name.trim()!==""&&c.value.purpose.trim()!==""),f=async()=>{if(!b.value){d.value="Name and purpose are required";return}p.value=!0,d.value="";try{const h=await se.post(`/api/legions/${o.legionId}/channels`,{name:c.value.name.trim(),purpose:c.value.purpose.trim(),description:c.value.description.trim()||"",member_minion_ids:c.value.member_minion_ids});i("created",h.channel),r.value?.hide(),c.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(h){console.error("Failed to create channel:",h),d.value=h.response?.data?.detail||"Failed to create channel"}finally{p.value=!1}},$=()=>{r.value?.show()},y=()=>{r.value?.hide()};return me(()=>{l.value&&(r.value=new Fe(l.value))}),ve(()=>{r.value?.dispose()}),e({show:$,hide:y}),(h,v)=>(u(),_e(ao,{to:"body"},[t("div",{ref_key:"modalElement",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[t("div",Dy,[t("div",Iy,[v[11]||(v[11]=t("div",{class:"modal-header"},[t("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Py,[d.value?(u(),m("div",jy,w(d.value),1)):L("",!0),t("form",{onSubmit:Ee(f,["prevent"])},[t("div",Ry,[v[4]||(v[4]=t("label",{for:"channel-name",class:"form-label"},[X(" Channel Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"channel-name","onUpdate:modelValue":v[0]||(v[0]=C=>c.value.name=C),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[pe,c.value.name]]),v[5]||(v[5]=t("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),t("div",Vy,[v[6]||(v[6]=t("label",{for:"channel-purpose",class:"form-label"},[X(" Purpose "),t("span",{class:"text-danger"},"*")],-1)),oe(t("textarea",{id:"channel-purpose","onUpdate:modelValue":v[1]||(v[1]=C=>c.value.purpose=C),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[pe,c.value.purpose]]),t("div",Hy,w(c.value.purpose.length)+" / 500 characters",1)]),t("div",Wy,[v[7]||(v[7]=t("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),oe(t("textarea",{id:"channel-description","onUpdate:modelValue":v[2]||(v[2]=C=>c.value.description=C),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[pe,c.value.description]])]),t("div",Fy,[v[8]||(v[8]=t("label",{class:"form-label"},"Initial Members (Optional)",-1)),oe(t("select",{"onUpdate:modelValue":v[3]||(v[3]=C=>c.value.member_minion_ids=C),multiple:"",class:"form-select",size:"5"},[(u(!0),m(ae,null,de(_.value,C=>(u(),m("option",{key:C.session_id,value:C.session_id},w(C.name)+w(C.role?` (${C.role})`:""),9,Uy))),128))],512),[[Oe,c.value.member_minion_ids]]),v[9]||(v[9]=t("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),t("div",By,[v[10]||(v[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:f,disabled:p.value||!b.value},w(p.value?"Creating...":"Create Channel"),9,qy)])])])],512)]))}},Ky=K(zy,[["__scopeId","data-v-573f4c01"]]),Gy={class:"modal-dialog modal-dialog-centered"},Yy={class:"modal-content"},Jy={class:"modal-body"},Xy={key:0,class:"alert alert-danger"},Qy={class:"text-muted"},Zy={class:"modal-footer"},e1=["disabled"],t1={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:s}){const o=n,i=s,a=A(null),l=A(null),r=A(""),d=A(!1),p=g(()=>o.channel?.member_minion_ids?.length||0),c=async()=>{if(!o.channel){r.value="No channel selected";return}d.value=!0,r.value="";try{await se.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),i("deleted",o.channel.channel_id),l.value?.hide()}catch(f){console.error("Failed to delete channel:",f),r.value=f.data?.detail||f.message||"Failed to delete channel"}finally{d.value=!1}},_=()=>{r.value="",l.value?.show()},b=()=>{l.value?.hide()};return me(()=>{a.value&&(l.value=new Fe(a.value))}),ve(()=>{l.value?.dispose()}),e({show:_,hide:b}),(f,$)=>(u(),_e(ao,{to:"body"},[t("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[t("div",Gy,[t("div",Yy,[$[4]||($[4]=t("div",{class:"modal-header"},[t("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Jy,[r.value?(u(),m("div",Xy,w(r.value),1)):L("",!0),$[2]||($[2]=t("div",{class:"alert alert-warning"},[t("strong",null,"âš ï¸ Warning:"),X(" This action cannot be undone. ")],-1)),t("p",null,[$[0]||($[0]=X("Are you sure you want to delete ",-1)),t("strong",null,w(n.channel?.name),1),$[1]||($[1]=X("?",-1))]),t("p",Qy," This channel has "+w(p.value)+" "+w(p.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),t("div",Zy,[$[3]||($[3]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-danger",onClick:c,disabled:d.value},w(d.value?"Deleting...":"Delete Channel"),9,e1)])])])],512)]))}},s1=["id"],n1={class:"accordion-item"},o1={class:"accordion-header"},i1=["aria-expanded","aria-controls"],a1={class:"text-muted ms-2"},l1=["id","data-bs-parent"],r1={class:"accordion-body p-0"},c1={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},d1={key:1,class:"list-group list-group-flush"},u1={class:"d-flex align-items-center justify-content-between"},m1=["onClick"],p1={class:"channel-name"},f1={class:"d-flex align-items-center gap-2"},v1={class:"badge bg-secondary member-count"},h1=["onClick"],_1={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ge(),o=Qe(),i=A(null),a=A(null),l=A(null),r=A(!0),d=g(()=>`channelsAccordion-${e.project.project_id}`),p=g(()=>`channelsCollapsePanel-${e.project.project_id}`),c=g(()=>o.channelsByLegion.get(e.project.project_id)||[]),_=g(()=>c.value.length);function b(){const T=window.bootstrap;if(!T)return;const D=document.getElementById(p.value);if(!D)return;T.Collapse.getOrCreateInstance(D).toggle()}function f(){r.value=!0}function $(){r.value=!1}function y(T){s.push(`/channel/${e.project.project_id}/${T}`)}function h(){i.value?.show()}function v(T){l.value=T,a.value?.show()}function C(T){console.log("Channel created, waiting for WebSocket update:",T)}function k(T){const I=(o.channelsByLegion.get(e.project.project_id)||[]).filter(x=>x.channel_id!==T);o.channelsByLegion.set(e.project.project_id,I),s.currentRoute.value.path.includes(T)&&s.push(`/timeline/${e.project.project_id}`)}return me(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(T){console.error("Failed to load channels:",T)}}),(T,D)=>(u(),m(ae,null,[t("div",{class:"accordion mt-2",id:d.value},[t("div",n1,[t("h2",o1,[t("button",{class:G(["accordion-button",{collapsed:!r.value}]),type:"button","aria-expanded":r.value,"aria-controls":p.value,onClick:b},[D[0]||(D[0]=t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),D[1]||(D[1]=t("span",{class:"fw-semibold"},"Channels",-1)),t("small",a1,"("+w(_.value)+")",1)],10,i1)]),t("div",{id:p.value,class:G(["accordion-collapse","collapse",{show:r.value}]),"data-bs-parent":`#${d.value}`,onShown:f,onHidden:$},[t("div",r1,[t("div",{class:"p-2 border-bottom"},[t("button",{class:"btn btn-sm btn-primary w-100",onClick:h}," + New Channel ")]),c.value.length===0?(u(),m("div",c1,' No channels yet. Click "New Channel" to create one. ')):(u(),m("div",d1,[(u(!0),m(ae,null,de(c.value,I=>(u(),m("div",{key:I.channel_id,class:"list-group-item list-group-item-action channel-item"},[t("div",u1,[t("div",{class:"d-flex align-items-center flex-grow-1",onClick:x=>y(I.channel_id)},[D[2]||(D[2]=t("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"ðŸ’¬",-1)),t("span",p1,w(I.name),1)],8,m1),t("div",f1,[t("span",v1,w(I.member_minion_ids?.length||0),1),t("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:Ee(x=>v(I),["stop"]),title:"Delete channel",style:{"font-size":"1.1rem","line-height":"1"}}," ðŸ—‘ï¸ ",8,h1)])])]))),128))]))])],42,l1)])],8,s1),re(Ky,{ref_key:"createModal",ref:i,"legion-id":n.project.project_id,onCreated:C},null,8,["legion-id"]),re(t1,{ref_key:"deleteModal",ref:a,"legion-id":n.project.project_id,channel:l.value,onDeleted:k},null,8,["legion-id","channel"])],64))}},g1=K(_1,[["__scopeId","data-v-0fd4b910"]]),b1=["data-project-id"],y1=["id"],$1=["aria-expanded","aria-controls","onKeydown"],w1={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},E1={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},C1={class:"fw-semibold",style:{"flex-shrink":"0"}},S1={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},k1={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},T1=["title"],x1=["title"],M1=["id","aria-labelledby"],A1={class:"accordion-body p-0"},O1={class:"list-group list-group-flush"},N1={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ge(),o=ge(),i=ie(),a=fe(),l=A(e.project.is_expanded||!1),r=g(()=>o.formatPath(e.project.working_directory)),d=g(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(I=>i.getSession(I)).filter(I=>I!=null)),p=g(()=>{const I=s.currentRoute.value;return I.name==="timeline"&&I.params.legionId===e.project.project_id}),c=g(()=>{const I=s.currentRoute.value;return I.name==="horde"&&I.params.legionId===e.project.project_id});function _(I){const x=window.bootstrap;if(!x)return;const O=document.getElementById(`collapse-${e.project.project_id}`);if(!O)return;x.Collapse.getOrCreateInstance(O).toggle()}function b(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function f(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const I=i.currentSessionId;I&&i.getSession(I)&&e.project.session_ids?.includes(I)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function $(){a.showModal("edit-project",{project:e.project})}function y(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function h(){s.push(`/timeline/${e.project.project_id}`)}function v(){s.push(`/horde/${e.project.project_id}`)}function C(I){I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("application/project-id",e.project.project_id),I.dataTransfer.setData("text/plain",e.project.project_id),I.target.classList.add("dragging")}function k(I){I.target.classList.remove("dragging")}function T(I){I.preventDefault(),I.dataTransfer.dropEffect="move";const x=I.currentTarget.getBoundingClientRect(),O=x.top+x.height/2;I.clientY<O?(I.currentTarget.classList.add("drop-above"),I.currentTarget.classList.remove("drop-below")):(I.currentTarget.classList.add("drop-below"),I.currentTarget.classList.remove("drop-above"))}function D(I){I.preventDefault(),I.currentTarget.classList.remove("drop-above","drop-below");const x=I.dataTransfer.getData("application/project-id")||I.dataTransfer.getData("text/plain");if(!x||x===e.project.project_id)return;const O=I.currentTarget.getBoundingClientRect(),q=O.top+O.height/2,R=I.clientY<q,P=o.orderedProjects,S=P.findIndex(ee=>ee.project_id===e.project.project_id),E=P.findIndex(ee=>ee.project_id===x);if(S===-1||E===-1)return;const M=[...P],[N]=M.splice(E,1);let V=R?S:S+1;E<S&&V--,M.splice(V,0,N);const U=M.map(ee=>ee.project_id);o.reorderProjects(U)}return(I,x)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:C,onDragend:k,onDragover:T,onDrop:D},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:G(["accordion-button bg-white p-2",{collapsed:!l.value}]),role:"button",tabindex:"0","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:_,onKeydown:[Ls(Ee(_,["prevent"]),["enter"]),Ls(Ee(_,["prevent"]),["space"])]},[t("div",w1,[t("div",E1,[t("div",C1,[n.project.is_multi_agent?(u(),m("span",S1,"ðŸ›")):L("",!0),X(" "+w(n.project.name),1)]),t("div",k1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:Ee($,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:Ee(y,["stop"])}," âž• ",8,T1)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},w(r.value),9,x1)])],42,$1)],8,y1),re(Sy,{project:n.project,sessions:d.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:G(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:b,onHidden:f},[t("div",A1,[t("div",O1,[n.project.is_multi_agent?(u(),m("div",{key:0,class:G(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:p.value}]),style:{cursor:"pointer"},onClick:h},[...x[0]||(x[0]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):L("",!0),n.project.is_multi_agent?(u(),m(ae,{key:1},[t("div",{class:G(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:c.value}]),style:{cursor:"pointer"},onClick:v},[...x[1]||(x[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),t("span",{class:"fw-semibold"},"Horde"),t("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),re(Ly,{project:n.project,sessions:d.value},null,8,["project","sessions"]),re(g1,{project:n.project},null,8,["project"])],64)):(u(!0),m(ae,{key:2},de(d.value,O=>(u(),_e(My,{key:O.session_id,session:O,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,M1)],40,b1))}},L1=K(N1,[["__scopeId","data-v-04f4e534"]]),D1={class:"project-list"},I1={key:0,class:"text-muted text-center py-3"},P1={__name:"ProjectList",setup(n){const e=ge(),s=g(()=>e.orderedProjects);return(o,i)=>(u(),m("div",D1,[s.value.length===0?(u(),m("div",I1,' No projects yet. Click "New" to create one. ')):L("",!0),(u(!0),m(ae,null,de(s.value,a=>(u(),_e(L1,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},j1={class:"flex-grow-1 overflow-auto p-3"},R1={id:"sessions-container"},V1={__name:"Sidebar",setup(n){const e=fe(),s=g(()=>e.sidebarCollapsed),o=g(()=>e.isMobile),i=g(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const l=A(!1);function r(c){l.value=!0,document.addEventListener("mousemove",d),document.addEventListener("mouseup",p)}function d(c){l.value&&e.setSidebarWidth(c.clientX)}function p(){l.value=!1,document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",p)}return(c,_)=>(u(),m("aside",{id:"sidebar",class:G(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value}]),style:He(i.value)},[t("div",j1,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[_[0]||(_[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),t("div",R1,[re(P1)])]),t("div",{class:"sidebar-resize-handle",onMousedown:r},null,32)],6))}},H1=K(V1,[["__scopeId","data-v-d792f0f0"]]),W1={class:"modal-dialog modal-lg"},F1={class:"modal-content"},U1={class:"modal-body"},B1={class:"mb-3"},q1={class:"input-group"},z1=["disabled"],K1={key:0,class:"text-center py-4"},G1={key:1,class:"alert alert-danger",role:"alert"},Y1={key:2,class:"folder-list"},J1=["onClick","onDblclick"],X1={class:"d-flex align-items-center flex-grow-1"},Q1=["onClick"],Z1={key:1,class:"text-center text-muted py-3"},e$={class:"modal-footer"},t$=["disabled"],s$={__name:"FolderBrowserModal",setup(n){const e=fe(),s=A(""),o=A(""),i=A([]),a=A(!1),l=A(""),r=A(null);let d=null,p=null;const c=g(()=>{if(!s.value)return null;const k=s.value.split(/[\\/]/).filter(Boolean);return k.length<=1?null:(k.pop(),k.length>0?k.join("/"):"/")});function _(k){if(!k)return"";const T=k.split(/[\\/]/).filter(Boolean);return T.length<=2?k:".../"+T.slice(-2).join("/")}async function b(){a.value=!0,l.value="",i.value=[],o.value="";try{const k=s.value?{path:s.value}:{},T=await se.get("/api/filesystem/browse",{params:k});T.current_path&&(s.value=T.current_path),i.value=T.directories||[]}catch(k){console.error("Failed to load directory:",k),l.value=k.message||"Failed to load directory"}finally{a.value=!1}}function f(k){o.value=k.path}function $(k){s.value=k.path,o.value="",b()}function y(){c.value&&(s.value=c.value,o.value="",b())}function h(){const k=o.value||s.value;k&&p&&p(k),d&&d.hide()}function v(){b()}function C(){i.value=[],o.value="",l.value="",p=null,e.hideModal()}return ce(()=>e.currentModal,k=>{if(k?.name==="folder-browser"&&d){const T=k.data||{};s.value=T.defaultPath||T.currentPath||"",p=T.onSelect||null,d.show()}}),me(()=>{r.value&&be(async()=>{const{default:k}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{d=new k(r.value),r.value.addEventListener("shown.bs.modal",v),r.value.addEventListener("hidden.bs.modal",C)})}),ve(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",v),r.value.removeEventListener("hidden.bs.modal",C)),d&&d.dispose()}),(k,T)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",W1,[t("div",F1,[T[6]||(T[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",U1,[t("div",B1,[T[1]||(T[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",q1,[oe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=D=>s.value=D),onKeyup:Ls(b,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[pe,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:b,disabled:a.value}," ðŸ”„ Refresh ",8,z1)])]),a.value?(u(),m("div",K1,[...T[2]||(T[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(u(),m("div",G1,w(l.value),1)):(u(),m("div",Y1,[c.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:y,role:"button"},[...T[3]||(T[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):L("",!0),(u(!0),m(ae,null,de(i.value,D=>(u(),m("div",{key:D.path,class:G(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:D.path===o.value}]),onClick:I=>f(D),onDblclick:I=>$(D),role:"button"},[t("div",X1,[T[4]||(T[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,w(D.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:Ee(I=>$(D),["stop"])}," Open ",8,Q1)],42,J1))),128)),i.value.length===0?(u(),m("div",Z1," No subdirectories found ")):L("",!0)]))]),t("div",e$,[T[5]||(T[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:!o.value},' Select "'+w(_(o.value||s.value))+'" ',9,t$)])])])],512))}},n$=K(s$,[["__scopeId","data-v-cf79108f"]]),o$={class:"modal-dialog"},i$={class:"modal-content"},a$={class:"modal-body"},l$={class:"mb-3"},r$={key:0,class:"invalid-feedback"},c$={class:"mb-3"},d$={class:"input-group"},u$={key:0,class:"invalid-feedback"},m$={class:"mb-3 form-check"},p$={class:"mb-3 form-check"},f$={class:"form-check-label",for:"createSession"},v$={key:0,class:"mb-3 ms-4"},h$={for:"sessionName",class:"form-label"},_$={key:1,class:"alert alert-danger",role:"alert"},g$={class:"modal-footer"},b$=["disabled"],y$={key:0,class:"spinner-border spinner-border-sm me-2"},$$={__name:"ProjectCreateModal",setup(n){const e=ge(),s=ie(),o=fe(),i=A({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=A({name:"",workingDirectory:""}),l=A(!1),r=A(""),d=A(null);let p=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:h=>{i.value.workingDirectory=h,a.value.workingDirectory=""}})}function _(){a.value={};let h=!0;return i.value.name.trim()||(a.value.name="Project name is required",h=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",h=!1),h}async function b(){if(_()){l.value=!0,r.value="";try{const h=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await s.createSession(h.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),p&&p.hide(),f()}catch(h){console.error("Failed to create project:",h),r.value=h.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function f(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},r.value=""}function $(){const h=document.getElementById("projectName");h&&h.focus()}function y(){f(),o.hideModal()}return ce(()=>o.currentModal,h=>{h?.name==="create-project"&&p&&p.show()}),me(()=>{d.value&&be(async()=>{const{default:h}=await import("./modal-B4rHLo2F.js").then(v=>v.m);return{default:h}},__vite__mapDeps([0,1])).then(({default:h})=>{p=new h(d.value),d.value.addEventListener("shown.bs.modal",$),d.value.addEventListener("hidden.bs.modal",y)})}),ve(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",$),d.value.removeEventListener("hidden.bs.modal",y)),p&&p.dispose()}),(h,v)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",o$,[t("div",i$,[v[11]||(v[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",a$,[t("form",{onSubmit:Ee(b,["prevent"])},[t("div",l$,[v[5]||(v[5]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),oe(t("input",{type:"text",class:G(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":v[0]||(v[0]=C=>i.value.name=C),placeholder:"My Project",required:""},null,2),[[pe,i.value.name]]),a.value.name?(u(),m("div",r$,w(a.value.name),1)):L("",!0)]),t("div",c$,[v[6]||(v[6]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",d$,[oe(t("input",{type:"text",class:G(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":v[1]||(v[1]=C=>i.value.workingDirectory=C),placeholder:"/path/to/project",required:""},null,2),[[pe,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(u(),m("div",u$,w(a.value.workingDirectory),1)):L("",!0)]),v[7]||(v[7]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",m$,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":v[2]||(v[2]=C=>i.value.isMultiAgent=C)},null,512),[[Ot,i.value.isMultiAgent]]),v[8]||(v[8]=t("label",{class:"form-check-label",for:"isMultiAgent"}," ðŸ› Multi-Agent Project (Legion) ",-1)),v[9]||(v[9]=t("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),t("div",p$,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":v[3]||(v[3]=C=>i.value.createSession=C)},null,512),[[Ot,i.value.createSession]]),t("label",f$," Create initial "+w(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(u(),m("div",v$,[t("label",h$," Initial "+w(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),oe(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":v[4]||(v[4]=C=>i.value.sessionName=C),placeholder:"main"},null,512),[[pe,i.value.sessionName]])])):L("",!0),r.value?(u(),m("div",_$,w(r.value),1)):L("",!0)],32)]),t("div",g$,[v[10]||(v[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:l.value},[l.value?(u(),m("span",y$)):L("",!0),X(" "+w(l.value?"Creating...":"Create Project"),1)],8,b$)])])])],512))}},w$=K($$,[["__scopeId","data-v-adf50394"]]),E$={class:"modal-dialog"},C$={class:"modal-content"},S$={class:"modal-body"},k$={class:"mb-3"},T$={key:0,class:"invalid-feedback"},x$={class:"mb-3"},M$=["value"],A$={key:0,class:"alert alert-danger",role:"alert"},O$={class:"danger-zone"},N$={class:"text-muted small"},L$=["disabled"],D$={key:0,class:"alert alert-warning mt-3",role:"alert"},I$={class:"mb-2"},P$={class:"d-flex gap-2"},j$=["disabled"],R$={key:0,class:"spinner-border spinner-border-sm me-2"},V$=["disabled"],H$={class:"modal-footer"},W$=["disabled"],F$={key:0,class:"spinner-border spinner-border-sm me-2"},U$={__name:"ProjectEditModal",setup(n){const e=ge(),s=fe(),o=A(null),i=A({name:""}),a=A({name:""}),l=A(!1),r=A(!1),d=A(""),p=A(!1),c=A(null);let _=null;const b=g(()=>o.value?.session_ids?.length||0);function f(){a.value={};let k=!0;return i.value.name.trim()||(a.value.name="Project name is required",k=!1),k}async function $(){if(!(!f()||!o.value)){l.value=!0,d.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),_&&_.hide()}catch(k){console.error("Failed to update project:",k),d.value=k.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function y(){if(o.value){r.value=!0,d.value="";try{await e.deleteProject(o.value.project_id),_&&_.hide()}catch(k){console.error("Failed to delete project:",k),d.value=k.message||"Failed to delete project. Please try again."}finally{r.value=!1}}}function h(){i.value={name:""},a.value={},d.value="",p.value=!1}function v(){const k=document.getElementById("editProjectName");k&&(k.focus(),k.select())}function C(){h(),o.value=null,s.hideModal()}return ce(()=>s.currentModal,k=>{if(k?.name==="edit-project"&&_){const T=k.data||{};o.value=T.project,o.value&&(i.value.name=o.value.name),_.show()}}),me(()=>{c.value&&be(async()=>{const{default:k}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{_=new k(c.value),c.value.addEventListener("shown.bs.modal",v),c.value.addEventListener("hidden.bs.modal",C)})}),ve(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",v),c.value.removeEventListener("hidden.bs.modal",C)),_&&_.dispose()}),(k,T)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",E$,[t("div",C$,[T[10]||(T[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",S$,[t("form",{onSubmit:Ee($,["prevent"])},[t("div",k$,[T[3]||(T[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),oe(t("input",{type:"text",class:G(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":T[0]||(T[0]=D=>i.value.name=D),placeholder:"My Project",required:""},null,2),[[pe,i.value.name]]),a.value.name?(u(),m("div",T$,w(a.value.name),1)):L("",!0)]),t("div",x$,[T[4]||(T[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,M$),T[5]||(T[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),d.value?(u(),m("div",A$,w(d.value),1)):L("",!0)],32),T[8]||(T[8]=t("hr",null,null,-1)),t("div",O$,[T[6]||(T[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",N$," Deleting this project will also delete all "+w(b.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:T[1]||(T[1]=D=>p.value=!0),disabled:r.value}," ðŸ—‘ï¸ Delete Project ",8,L$)]),p.value?(u(),m("div",D$,[T[7]||(T[7]=t("strong",null,"Are you sure?",-1)),t("p",I$,' This will permanently delete the project "'+w(o.value?.name)+'" and all '+w(b.value)+" session(s). ",1),t("div",P$,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:y,disabled:r.value},[r.value?(u(),m("span",R$)):L("",!0),X(" "+w(r.value?"Deleting...":"Yes, Delete Permanently"),1)],8,j$),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:T[2]||(T[2]=D=>p.value=!1),disabled:r.value}," Cancel ",8,V$)])])):L("",!0)]),t("div",H$,[T[9]||(T[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:$,disabled:l.value},[l.value?(u(),m("span",F$)):L("",!0),X(" "+w(l.value?"Saving...":"Save Changes"),1)],8,W$)])])])],512))}},B$=K(U$,[["__scopeId","data-v-52679516"]]),q$={class:"modal-dialog modal-lg"},z$={class:"modal-content"},K$={class:"modal-header"},G$={class:"modal-title",id:"createSessionModalLabel"},Y$={key:0,class:"text-muted small"},J$={class:"modal-body"},X$={class:"mb-3"},Q$={key:0,class:"invalid-feedback"},Z$={class:"mb-3"},ew={class:"mb-3"},tw={class:"mb-3"},sw={class:"form-text d-flex justify-content-between"},nw={key:0,class:"invalid-feedback"},ow={class:"mb-3 form-check"},iw={key:0,class:"form-text text-warning"},aw={class:"mb-3"},lw={class:"mb-3 form-check"},rw={key:0,class:"alert alert-danger",role:"alert"},cw={class:"modal-footer"},dw=["disabled"],uw={key:0,class:"spinner-border spinner-border-sm me-2"},mw={__name:"SessionCreateModal",setup(n){const e=Ge();ge();const s=ie(),o=fe(),i=A(null),a=A({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0}),l=A({name:""}),r=A(!1),d=A(""),p=A(null);let c=null;const _=g(()=>a.value.system_prompt.length),b=g(()=>_.value>6e3),f=g(()=>_.value>5500&&_.value<=6e3);function $(){l.value={};let k=!0;return a.value.name.trim()||(l.value.name="Session name is required",k=!1),b.value&&(k=!1),k}async function y(){if(!(!$()||!i.value)){r.value=!0,d.value="";try{const k=a.value.allowed_tools.split(",").map(I=>I.trim()).filter(I=>I.length>0),T={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,allowed_tools:k},D=await s.createSession(i.value.project_id,T);a.value.startImmediately&&await s.startSession(D.session_id),e.push(`/session/${D.session_id}`),c&&c.hide(),h()}catch(k){console.error("Failed to create session:",k),d.value=k.message||"Failed to create session. Please try again."}finally{r.value=!1}}}function h(){a.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0},l.value={},d.value=""}function v(){const k=document.getElementById("sessionName");k&&k.focus()}function C(){h(),i.value=null,o.hideModal()}return ce(()=>o.currentModal,k=>{if(k?.name==="create-session"&&c){const T=k.data||{};i.value=T.project,c.show()}}),me(()=>{p.value&&be(async()=>{const{default:k}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{c=new k(p.value),p.value.addEventListener("shown.bs.modal",v),p.value.addEventListener("hidden.bs.modal",C)})}),ve(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",v),p.value.removeEventListener("hidden.bs.modal",C)),c&&c.dispose()}),(k,T)=>(u(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",q$,[t("div",z$,[t("div",K$,[t("h5",G$,[T[7]||(T[7]=X(" Create New Session ",-1)),i.value?(u(),m("span",Y$,"in "+w(i.value.name),1)):L("",!0)]),T[8]||(T[8]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",J$,[t("form",{onSubmit:Ee(y,["prevent"])},[t("div",X$,[T[9]||(T[9]=t("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),oe(t("input",{type:"text",class:G(["form-control",{"is-invalid":l.value.name}]),id:"sessionName","onUpdate:modelValue":T[0]||(T[0]=D=>a.value.name=D),placeholder:"main",required:""},null,2),[[pe,a.value.name]]),l.value.name?(u(),m("div",Q$,w(l.value.name),1)):L("",!0)]),t("div",Z$,[T[11]||(T[11]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":T[1]||(T[1]=D=>a.value.permission_mode=D)},[...T[10]||(T[10]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Oe,a.value.permission_mode]]),T[12]||(T[12]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",ew,[T[14]||(T[14]=t("label",{for:"model",class:"form-label"},"Model",-1)),oe(t("select",{class:"form-select",id:"model","onUpdate:modelValue":T[2]||(T[2]=D=>a.value.model=D)},[...T[13]||(T[13]=[t("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),t("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),t("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[Oe,a.value.model]])]),t("div",tw,[T[15]||(T[15]=t("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),oe(t("textarea",{class:G(["form-control",{"is-invalid":b.value}]),id:"systemPrompt","onUpdate:modelValue":T[3]||(T[3]=D=>a.value.system_prompt=D),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[pe,a.value.system_prompt]]),t("div",sw,[t("span",null,w(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),t("span",{class:G({"text-danger":b.value,"text-warning":f.value})},w(_.value)+" / 6000 chars ",3)]),b.value?(u(),m("div",nw," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):L("",!0)]),t("div",ow,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":T[4]||(T[4]=D=>a.value.override_system_prompt=D)},null,512),[[Ot,a.value.override_system_prompt]]),T[17]||(T[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),m("div",iw,[...T[16]||(T[16]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):L("",!0)]),t("div",aw,[T[18]||(T[18]=t("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),oe(t("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":T[5]||(T[5]=D=>a.value.allowed_tools=D),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[pe,a.value.allowed_tools]]),T[19]||(T[19]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",lw,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":T[6]||(T[6]=D=>a.value.startImmediately=D)},null,512),[[Ot,a.value.startImmediately]]),T[20]||(T[20]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),d.value?(u(),m("div",rw,w(d.value),1)):L("",!0)],32)]),t("div",cw,[T[21]||(T[21]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:r.value},[r.value?(u(),m("span",uw)):L("",!0),X(" "+w(r.value?"Creating...":"Create Session"),1)],8,dw)])])])],512))}},pw=K(mw,[["__scopeId","data-v-d74a6221"]]),fw={class:"modal-dialog"},vw={class:"modal-content"},hw={class:"modal-body"},_w={class:"mb-3"},gw={key:0,class:"invalid-feedback"},bw={class:"mb-3"},yw=["value"],$w={class:"mb-3"},ww={class:"form-control-plaintext"},Ew={class:"mb-3"},Cw=["disabled"],Sw={key:0,value:"bypassPermissions"},kw={class:"form-text"},Tw={key:0,class:"text-warning"},xw={key:1},Mw={key:0,class:"mb-3"},Aw={class:"card"},Ow={class:"card-body"},Nw={key:0,class:"mb-2"},Lw={key:1,class:"mb-2"},Dw={key:2,class:"mt-2"},Iw={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},Pw={key:1,class:"alert alert-danger",role:"alert"},jw={class:"modal-footer"},Rw=["disabled"],Vw={key:0,class:"spinner-border spinner-border-sm me-2"},Hw={__name:"SessionEditModal",setup(n){const e=ie(),s=fe(),o=A(null),i=A({name:"",permission_mode:"default"}),a=A({name:""}),l=A(!1),r=A(""),d=A(null);let p=null;const c=g(()=>o.value?.state==="active"||o.value?.state==="starting"),_=g(()=>o.value?.initial_permission_mode==="bypassPermissions");function b(C){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[C]||"bg-secondary"}function f(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Session name is required",C=!1),C}async function $(){if(!(!f()||!o.value)){l.value=!0,r.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),p&&p.hide()}catch(C){console.error("Failed to update session:",C),r.value=C.message||"Failed to update session. Please try again."}finally{l.value=!1}}}function y(){i.value={name:"",permission_mode:"default"},a.value={},r.value=""}function h(){const C=document.getElementById("editSessionName");C&&(C.focus(),C.select())}function v(){y(),o.value=null,s.hideModal()}return ce(()=>s.currentModal,C=>{if(C?.name==="edit-session"&&p){const k=C.data||{};o.value=k.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),p.show()}}),me(()=>{d.value&&be(async()=>{const{default:C}=await import("./modal-B4rHLo2F.js").then(k=>k.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{p=new C(d.value),d.value.addEventListener("shown.bs.modal",h),d.value.addEventListener("hidden.bs.modal",v)})}),ve(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",h),d.value.removeEventListener("hidden.bs.modal",v)),p&&p.dispose()}),(C,k)=>(u(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",fw,[t("div",vw,[k[15]||(k[15]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",hw,[t("form",{onSubmit:Ee($,["prevent"])},[t("div",_w,[k[2]||(k[2]=t("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),oe(t("input",{type:"text",class:G(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":k[0]||(k[0]=T=>i.value.name=T),placeholder:"Session Name",required:""},null,2),[[pe,i.value.name]]),a.value.name?(u(),m("div",gw,w(a.value.name),1)):L("",!0)]),t("div",bw,[k[3]||(k[3]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,yw),k[4]||(k[4]=t("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),t("div",$w,[k[5]||(k[5]=t("label",{class:"form-label"},"Current State",-1)),t("div",ww,[t("span",{class:G(["badge",b(o.value?.state)])},w(o.value?.state),3)])]),t("div",Ew,[k[9]||(k[9]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":k[1]||(k[1]=T=>i.value.permission_mode=T),disabled:!c.value},[k[6]||(k[6]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),k[7]||(k[7]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),k[8]||(k[8]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),_.value?(u(),m("option",Sw,"âš ï¸ Bypass Permissions (No prompts)")):L("",!0)],8,Cw),[[Oe,i.value.permission_mode]]),t("div",kw,[c.value?(u(),m("span",xw," Controls which tool actions require permission prompts ")):(u(),m("span",Tw," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),m("div",Mw,[k[13]||(k[13]=t("label",{class:"form-label"},"System Prompt Configuration",-1)),t("div",Aw,[t("div",Ow,[o.value?.override_system_prompt?(u(),m("div",Nw,[...k[10]||(k[10]=[t("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),t("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),m("div",Lw,[...k[11]||(k[11]=[t("span",{class:"badge bg-info"},"Append Mode",-1),t("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),m("div",Dw,[k[12]||(k[12]=t("strong",{class:"small"},"Custom Instructions:",-1)),t("div",Iw,w(o.value.system_prompt),1)])):L("",!0)])])])):L("",!0),r.value?(u(),m("div",Pw,w(r.value),1)):L("",!0)],32)]),t("div",jw,[k[14]||(k[14]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:$,disabled:l.value},[l.value?(u(),m("span",Vw)):L("",!0),X(" "+w(l.value?"Saving...":"Save Changes"),1)],8,Rw)])])])],512))}},Ww=K(Hw,[["__scopeId","data-v-c99ca17f"]]),Fw={class:"modal-dialog modal-dialog-centered"},Uw={class:"modal-content"},Bw={class:"modal-header"},qw={class:"modal-title",id:"manageSessionModalLabel"},zw={class:"modal-body"},Kw={key:0,class:"text-center py-4"},Gw={class:"text-muted"},Yw={key:1},Jw={key:2},Xw={class:"text-muted"},Qw={key:3},Zw={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},eE={class:"d-grid gap-2"},tE=["disabled"],sE=["disabled"],nE=["disabled"],oE=["disabled"],iE={class:"modal-footer"},aE={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},lE={__name:"SessionManageModal",setup(n){const e=Ge(),s=ie(),o=fe(),i=je();Ie();const a=A(null),l=A(!1),r=A(""),d=A(""),p=A(null),c=A(null);let _=null;const b=g(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function f(){p.value="reset"}function $(){p.value="delete"}function y(){p.value=null}async function h(){p.value==="reset"?await k():p.value==="delete"&&await T()}async function v(){if(a.value){l.value=!0,r.value="Restarting session...";try{const x=a.value.session_id,O=await se.post(`/api/sessions/${x}/restart`);if(O.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(x),_&&_.hide();else{const q=O.error||O.detail||"Failed to restart session";console.error("Failed to restart session:",q),d.value=`Failed to restart session: ${q}`}}catch(x){console.error("Error restarting session:",x);const O=x.data?.detail||x.message||"Unknown error";d.value=`Error restarting session: ${O}`}finally{l.value=!1}}}async function C(){if(a.value)try{_&&_.hide(),console.log("Ending session",a.value.session_id);const x=a.value.session_id;await se.post(`/api/sessions/${x}/terminate`),await i.disconnectSession(),s.currentSessionId===x&&(s.currentSessionId=null),e.push("/")}catch(x){console.error("Error ending session:",x),await i.disconnectSession(),s.currentSessionId===a.value?.session_id&&(s.currentSessionId=null),e.push("/")}}async function k(){if(a.value){l.value=!0,r.value="Resetting session...";try{const x=a.value.session_id,O=await se.post(`/api/sessions/${x}/reset`);if(O.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(x),_&&_.hide();else{const q=O.error||O.detail||"Failed to reset session";console.error("Failed to reset session:",q),d.value=`Failed to reset session: ${q}`,p.value=null}}catch(x){console.error("Error resetting session:",x);const O=x.data?.detail||x.message||"Unknown error";d.value=`Error resetting session: ${O}`,p.value=null}finally{l.value=!1}}}async function T(){if(a.value){l.value=!0,r.value="Deleting session...";try{const x=a.value.session_id;await s.deleteSession(x),e.currentRoute.value.params.sessionId===x&&e.push("/"),_&&_.hide()}catch(x){console.error("Error deleting session:",x);const O=x.data?.detail||x.message||"Unknown error";d.value=`Error deleting session: ${O}`,p.value=null}finally{l.value=!1}}}function D(){p.value=null,l.value=!1,r.value="",d.value=""}function I(){D(),a.value=null,o.hideModal()}return ce(()=>o.currentModal,x=>{if(x?.name==="manage-session"&&_){const O=x.data||{};a.value=O.session,D(),_.show()}}),me(()=>{c.value&&be(async()=>{const{default:x}=await import("./modal-B4rHLo2F.js").then(O=>O.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{_=new x(c.value),c.value.addEventListener("hidden.bs.modal",I)})}),ve(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",I),_&&_.dispose()}),(x,O)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",Fw,[t("div",Uw,[t("div",Bw,[t("h5",qw,w(p.value?b.value:"Manage Session"),1),O[1]||(O[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",zw,[l.value?(u(),m("div",Kw,[O[2]||(O[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Gw,w(r.value),1)])):p.value==="reset"?(u(),m("div",Yw,[...O[3]||(O[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(u(),m("div",Jw,[O[6]||(O[6]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",Xw,[O[4]||(O[4]=X("This will permanently delete session ",-1)),t("strong",null,w(a.value?.name),1),O[5]||(O[5]=X(".",-1))]),O[7]||(O[7]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(u(),m("div",Qw,[d.value?(u(),m("div",Zw,[O[8]||(O[8]=t("strong",null,"Error:",-1)),X(" "+w(d.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:O[0]||(O[0]=q=>d.value="")})])):L("",!0),O[15]||(O[15]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",eE,[t("button",{class:"btn btn-outline-primary text-start",onClick:v,disabled:l.value},[...O[9]||(O[9]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,tE),t("button",{class:"btn btn-outline-secondary text-start",onClick:C,disabled:l.value},[...O[10]||(O[10]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,sE),O[13]||(O[13]=t("hr",{class:"my-2"},null,-1)),O[14]||(O[14]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:f,disabled:l.value},[...O[11]||(O[11]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,nE),t("button",{class:"btn btn-outline-danger text-start",onClick:$,disabled:l.value},[...O[12]||(O[12]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,oE)]),O[16]||(O[16]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),X(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",iE,[p.value&&!l.value?(u(),m(ae,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancel"),t("button",{type:"button",class:G(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:h},w(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?L("",!0):(u(),m("button",aE,"Cancel"))])])])],512))}},rE=K(lE,[["__scopeId","data-v-9122e4df"]]),cE={class:"modal-dialog modal-dialog-centered modal-lg"},dE={class:"modal-content"},uE={class:"modal-body"},mE={key:0,class:"text-center text-muted py-4"},pE={key:1},fE={class:"mb-3"},vE={class:"font-monospace small"},hE={class:"mb-3"},_E=["value"],gE={class:"mb-3"},bE={class:"mb-3"},yE={class:"mb-3"},$E={key:0},wE={class:"d-flex flex-wrap gap-1"},EE={key:1,class:"text-muted small"},CE={key:0,class:"mb-3"},SE={class:"d-flex flex-wrap gap-1"},kE={key:1,class:"mb-3"},TE={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},xE={class:"mb-3"},ME={class:"text-muted"},AE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},OE={__name:"SessionInfoModal",setup(n){const e=ie(),s=Ie(),o=fe(),i=A(null),a=A(!1),l=A(null);let r=null;const d=g(()=>{if(!i.value)return null;const f=e.initData.get(i.value);return f||(s.messagesBySession.get(i.value)||[]).find(h=>h.type==="system"&&(h.subtype==="init"||h.metadata?.subtype==="init")&&h.metadata?.init_data)?.metadata?.init_data||null});function p(f){return typeof f=="string"?f:typeof f=="object"&&f.type==="preset"?`Preset: ${f.preset}`:JSON.stringify(f,null,2)}function c(f){f.target.select()}function _(){i.value=null,a.value=!1}function b(){_(),o.hideModal()}return ce(()=>o.currentModal,f=>{if(f?.name==="session-info"&&r){const $=f.data||{};i.value=$.sessionId,a.value=!1,r.show()}}),me(()=>{l.value&&be(async()=>{const{default:f}=await import("./modal-B4rHLo2F.js").then($=>$.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{r=new f(l.value),l.value.addEventListener("hidden.bs.modal",b)})}),ve(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",b),r&&r.dispose()}),(f,$)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[t("div",cE,[t("div",dE,[$[9]||($[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",uE,[d.value?(u(),m("div",pE,[t("div",fE,[$[1]||($[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",vE,w(i.value),1)]),t("div",hE,[$[2]||($[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:d.value.cwd||"Not specified",readonly:"",onClick:c},null,8,_E)]),t("div",gE,[$[3]||($[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,w(d.value.model||"Default"),1)]),t("div",bE,[$[4]||($[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,w(d.value.permissionMode||"default"),1)]),t("div",yE,[$[5]||($[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(d.value.allowed_tools||d.value.tools)&&(d.value.allowed_tools||d.value.tools).length>0?(u(),m("div",$E,[t("div",wE,[(u(!0),m(ae,null,de(d.value.allowed_tools||d.value.tools,y=>(u(),m("span",{key:y,class:"badge bg-secondary"},w(y),1))),128))])])):(u(),m("div",EE,"No pre-authorized tools (will prompt for permissions)"))]),d.value.commands&&d.value.commands.length>0?(u(),m("div",CE,[$[6]||($[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",SE,[(u(!0),m(ae,null,de(d.value.commands,y=>(u(),m("span",{key:y,class:"badge bg-info"},w(y),1))),128))])])):L("",!0),d.value.systemPrompt?(u(),m("div",kE,[$[7]||($[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",TE,w(p(d.value.systemPrompt)),1)])):L("",!0),t("div",xE,[t("h6",ME,[$[8]||($[8]=X(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:$[0]||($[0]=y=>a.value=!a.value)},w(a.value?"Hide":"Show"),1)]),a.value?(u(),m("pre",AE,w(JSON.stringify(d.value,null,2)),1)):L("",!0)])])):(u(),m("div",mE," No session configuration data available "))]),$[10]||($[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},NE=K(OE,[["__scopeId","data-v-7b529fc9"]]),LE={class:"modal-dialog modal-dialog-centered"},DE={class:"modal-content"},IE={class:"modal-body"},PE={class:"mb-3"},jE=["value"],RE={key:0,class:"form-text"},VE={class:"mb-3"},HE={class:"mb-3"},WE={for:"minion-role",class:"form-label"},FE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},UE={key:1,class:"field-indicator modified",title:"Modified from template"},BE=["placeholder","title"],qE={class:"mb-3"},zE={for:"minion-context",class:"form-label"},KE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},GE={key:1,class:"field-indicator modified",title:"Modified from template"},YE=["title"],JE={class:"form-text d-flex justify-content-between"},XE={key:0,class:"invalid-feedback"},QE={class:"mb-3 form-check"},ZE={key:0,class:"form-text text-warning"},eC={class:"mb-3"},tC={class:"mb-3"},sC={class:"input-group"},nC={class:"mb-3"},oC={for:"permission-mode",class:"form-label"},iC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},aC={key:1,class:"field-indicator modified",title:"Modified from template"},lC=["title"],rC={class:"mb-3"},cC={for:"allowed-tools",class:"form-label"},dC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},uC={key:1,class:"field-indicator modified",title:"Modified from template"},mC=["title"],pC={key:0,class:"alert alert-danger"},fC={class:"modal-footer"},vC=["disabled"],hC={key:0,class:"spinner-border spinner-border-sm me-2"},_C={__name:"CreateMinionModal",setup(n){const e=Ge(),s=ge(),o=ie(),i=fe(),a=A(null);let l=null;const r=A(null),d=A([]),p=A(null),c=A(new Set),_=A({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),b=A({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),f=A({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:""}),$=A(""),y=A(""),h=A(!1),v=g(()=>$.value.trim()?$.value.split(",").map(B=>B.trim()).filter(B=>B.length>0):[]),C=g(()=>f.value.allowed_tools.trim()?f.value.allowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0):null),k=g(()=>f.value.initialization_context.length),T=g(()=>k.value>2e3),D=g(()=>k.value>1800&&k.value<=2e3),I=g(()=>p.value?d.value.find(B=>B.template_id===p.value):null),x=g(()=>I.value?.default_role||"e.g., Code Expert, Testing Specialist"),O=g(()=>({"field-autofilled":b.value.role==="autofilled","field-modified":b.value.role==="modified"})),q=g(()=>({"field-autofilled":b.value.initialization_context==="autofilled","field-modified":b.value.initialization_context==="modified"})),R=g(()=>({"field-autofilled":b.value.permission_mode==="autofilled","field-modified":b.value.permission_mode==="modified"})),P=g(()=>({"field-autofilled":b.value.allowed_tools==="autofilled","field-modified":b.value.allowed_tools==="modified"})),S=B=>{const W=b.value[B];return W==="autofilled"?`Auto-filled from template: ${I.value?.name}`:W==="modified"?"Modified from template value":""};async function E(){try{console.log("[CreateMinionModal] Loading templates...");const B=await se.get("/api/templates");console.log("[CreateMinionModal] Templates data:",B),d.value=B||[],console.log("[CreateMinionModal] Templates set to:",d.value)}catch(B){console.error("[CreateMinionModal] Failed to load templates:",B),d.value=[]}}function M(){if(c.value.clear(),!I.value){f.value.role="",f.value.initialization_context="",f.value.permission_mode="default",f.value.allowed_tools="",b.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},_.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const B=I.value;if(b.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},B.default_role?(f.value.role=B.default_role,c.value.add("role"),_.value.role=B.default_role,b.value.role="autofilled"):(f.value.role="",_.value.role=null,b.value.role="normal"),B.default_system_prompt?(f.value.initialization_context=B.default_system_prompt,c.value.add("initialization_context"),_.value.initialization_context=B.default_system_prompt,b.value.initialization_context="autofilled"):(f.value.initialization_context="",_.value.initialization_context=null,b.value.initialization_context="normal"),B.permission_mode?(f.value.permission_mode=B.permission_mode,c.value.add("permission_mode"),_.value.permission_mode=B.permission_mode,b.value.permission_mode="autofilled"):(f.value.permission_mode="default",_.value.permission_mode=null,b.value.permission_mode="normal"),B.allowed_tools&&B.allowed_tools.length>0){const W=B.allowed_tools.join(", ");f.value.allowed_tools=W,c.value.add("allowed_tools"),_.value.allowed_tools=W,b.value.allowed_tools="autofilled"}else f.value.allowed_tools="",_.value.allowed_tools=null,b.value.allowed_tools="normal"}function N(){i.showModal("template-management",{})}function V(){const W=(r.value?s.projects.get(r.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:W,currentPath:f.value.working_directory||"",onSelect:ne=>{f.value.working_directory=ne}})}function U(){f.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:""},$.value="",p.value=null,c.value.clear(),b.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},_.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},y.value="",h.value=!1}function ee(){U(),i.hideModal()}async function le(){if(!f.value.name.trim()){y.value="Minion name is required";return}if(f.value.name.includes(" ")){y.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(T.value){y.value="Initialization context exceeds 2000 character limit";return}if(!r.value){y.value="Legion ID is missing";return}h.value=!0,y.value="";try{const B={name:f.value.name.trim(),role:f.value.role.trim(),initialization_context:f.value.initialization_context.trim(),override_system_prompt:f.value.override_system_prompt,capabilities:v.value,permission_mode:f.value.permission_mode,allowed_tools:C.value,working_directory:f.value.working_directory.trim()||null},W=await se.post(`/api/legions/${r.value}/minions`,B);W.success&&W.minion_id?(await s.fetchProjects(),await o.fetchSessions(),l&&l.hide(),e.push(`/spy/${r.value}/${W.minion_id}`)):y.value="Failed to create minion"}catch(B){console.error("Failed to create minion:",B),y.value=B.response?.data?.detail||"Failed to create minion"}finally{h.value=!1}}return ce(()=>i.currentModal,(B,W)=>{if(B?.name==="create-minion"&&l){const ne=B.data||{};r.value=ne.project?.project_id||null,U(),E(),l.show()}else W?.name==="template-management"&&l&&a.value?.classList.contains("show")&&E()}),ce(()=>f.value.role,B=>{_.value.role!==null&&(B===_.value.role?b.value.role="autofilled":b.value.role="modified")}),ce(()=>f.value.initialization_context,B=>{_.value.initialization_context!==null&&(B===_.value.initialization_context?b.value.initialization_context="autofilled":b.value.initialization_context="modified")}),ce(()=>f.value.permission_mode,B=>{_.value.permission_mode!==null&&(B===_.value.permission_mode?b.value.permission_mode="autofilled":b.value.permission_mode="modified")}),ce(()=>f.value.allowed_tools,B=>{_.value.allowed_tools!==null&&(B===_.value.allowed_tools?b.value.allowed_tools="autofilled":b.value.allowed_tools="modified")}),me(()=>{a.value&&be(()=>import("./modal-B4rHLo2F.js").then(B=>B.m),__vite__mapDeps([0,1])).then(B=>{const W=B.default;l=new W(a.value),a.value.addEventListener("hidden.bs.modal",ee)}),E()}),ve(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",ee),l&&l.dispose()}),(B,W)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[t("div",LE,[t("div",DE,[W[28]||(W[28]=t("div",{class:"modal-header"},[t("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",IE,[t("form",{onSubmit:Ee(le,["prevent"])},[t("div",PE,[t("label",{for:"template-select",class:"form-label"},[W[9]||(W[9]=X(" Template ",-1)),t("button",{type:"button",onClick:N,class:"btn btn-link btn-sm p-0 ms-2"}," âš™ï¸ Manage Templates ")]),oe(t("select",{id:"template-select","onUpdate:modelValue":W[0]||(W[0]=ne=>p.value=ne),onChange:M,class:"form-select"},[W[10]||(W[10]=t("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(ae,null,de(d.value,ne=>(u(),m("option",{key:ne.template_id,value:ne.template_id},w(ne.name),9,jE))),128))],544),[[Oe,p.value]]),I.value?(u(),m("div",RE,w(I.value.description),1)):L("",!0)]),t("div",VE,[W[11]||(W[11]=t("label",{for:"minion-name",class:"form-label"},[X(" Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"minion-name","onUpdate:modelValue":W[1]||(W[1]=ne=>f.value.name=ne),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[pe,f.value.name]]),W[12]||(W[12]=t("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),t("div",HE,[t("label",WE,[W[13]||(W[13]=X(" Role ",-1)),b.value.role==="autofilled"?(u(),m("span",FE," âš¡ ")):L("",!0),b.value.role==="modified"?(u(),m("span",UE," âœï¸ ")):L("",!0)]),oe(t("input",{id:"minion-role","onUpdate:modelValue":W[2]||(W[2]=ne=>f.value.role=ne),type:"text",class:G(["form-control",O.value]),placeholder:x.value,title:S("role")},null,10,BE),[[pe,f.value.role]]),W[14]||(W[14]=t("div",{class:"form-text"}," Optional role description for the minion ",-1))]),t("div",qE,[t("label",zE,[W[15]||(W[15]=X(" Initialization Context ",-1)),b.value.initialization_context==="autofilled"?(u(),m("span",KE," âš¡ ")):L("",!0),b.value.initialization_context==="modified"?(u(),m("span",GE," âœï¸ ")):L("",!0)]),oe(t("textarea",{id:"minion-context","onUpdate:modelValue":W[3]||(W[3]=ne=>f.value.initialization_context=ne),class:G(["form-control",[q.value,{"is-invalid":T.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:S("initialization_context")},null,10,YE),[[pe,f.value.initialization_context]]),t("div",JE,[t("span",null,w(f.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),t("span",{class:G({"text-danger":T.value,"text-warning":D.value})},w(k.value)+" / 2000 chars ",3)]),T.value?(u(),m("div",XE," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):L("",!0)]),t("div",QE,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":W[4]||(W[4]=ne=>f.value.override_system_prompt=ne)},null,512),[[Ot,f.value.override_system_prompt]]),W[17]||(W[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),f.value.override_system_prompt?(u(),m("div",ZE,[...W[16]||(W[16]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):L("",!0)]),t("div",eC,[W[18]||(W[18]=t("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),oe(t("input",{id:"minion-capabilities","onUpdate:modelValue":W[5]||(W[5]=ne=>$.value=ne),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[pe,$.value]]),W[19]||(W[19]=t("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),t("div",tC,[W[20]||(W[20]=t("label",{for:"working-directory",class:"form-label"}," Working Directory (Optional) ",-1)),t("div",sC,[oe(t("input",{id:"working-directory","onUpdate:modelValue":W[6]||(W[6]=ne=>f.value.working_directory=ne),type:"text",class:"form-control",placeholder:"Leave empty to inherit from legion"},null,512),[[pe,f.value.working_directory]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:V}," ðŸ“ Browse ")]),W[21]||(W[21]=t("div",{class:"form-text"}," Custom working directory for git worktrees or multi-repo workflows. Relative paths will be converted to absolute. ",-1))]),t("div",nC,[t("label",oC,[W[22]||(W[22]=X(" Permission Mode ",-1)),b.value.permission_mode==="autofilled"?(u(),m("span",iC," âš¡ ")):L("",!0),b.value.permission_mode==="modified"?(u(),m("span",aC," âœï¸ ")):L("",!0)]),oe(t("select",{class:G(["form-select",R.value]),id:"permission-mode","onUpdate:modelValue":W[7]||(W[7]=ne=>f.value.permission_mode=ne),title:S("permission_mode")},[...W[23]||(W[23]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,lC),[[Oe,f.value.permission_mode]]),W[24]||(W[24]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",rC,[t("label",cC,[W[25]||(W[25]=X(" Allowed Tools (Optional) ",-1)),b.value.allowed_tools==="autofilled"?(u(),m("span",dC," âš¡ ")):L("",!0),b.value.allowed_tools==="modified"?(u(),m("span",uC," âœï¸ ")):L("",!0)]),oe(t("input",{type:"text",class:G(["form-control",P.value]),id:"allowed-tools","onUpdate:modelValue":W[8]||(W[8]=ne=>f.value.allowed_tools=ne),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:S("allowed_tools")},null,10,mC),[[pe,f.value.allowed_tools]]),W[26]||(W[26]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),y.value?(u(),m("div",pC,w(y.value),1)):L("",!0)],32)]),t("div",fC,[W[27]||(W[27]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",disabled:!f.value.name.trim()||h.value,onClick:le},[h.value?(u(),m("span",hC)):L("",!0),X(" "+w(h.value?"Creating...":"Create Minion"),1)],8,vC)])])])],512))}},gC=K(_C,[["__scopeId","data-v-df1241b1"]]),bC={class:"modal-dialog modal-dialog-centered modal-lg"},yC={class:"modal-content"},$C={class:"modal-body"},wC={key:0,class:"text-center text-muted py-4"},EC={key:1},CC={class:"mb-3"},SC={class:"mb-3"},kC={class:"font-monospace small"},TC={class:"mb-3"},xC={class:"mb-3"},MC={class:"mb-3"},AC={key:0},OC={class:"d-flex flex-wrap gap-1"},NC={key:1,class:"text-muted small"},LC={class:"mb-3"},DC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},IC={key:1,class:"text-muted small"},PC={class:"mb-3"},jC={key:0,class:"badge bg-info"},RC={key:1,class:"badge bg-secondary"},VC={class:"mb-3"},HC={key:0,class:"font-monospace small"},WC={key:1,class:"text-muted small"},FC={key:0,class:"mb-3"},UC={key:0},BC={class:"list-unstyled mb-0"},qC={key:1,class:"text-muted small"},zC={class:"mb-3"},KC={key:0,class:"font-monospace small"},GC={key:1,class:"text-muted small"},YC={class:"mb-3"},JC={key:0},XC={class:"d-flex flex-wrap gap-1"},QC={key:1,class:"text-muted small"},ZC={class:"mb-3"},eS={class:"small"},tS={class:"mb-3"},sS={class:"small"},nS={__name:"MinionViewModal",setup(n){const e=fe(),s=A(null),o=A(null);let i=null;function a(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function l(p){if(!p)return"N/A";try{const c=new Date(p);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function r(){s.value=null}function d(){r(),e.hideModal()}return ce(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&i){const c=p.data||{};s.value=c.session,i.show()}}),me(()=>{o.value&&be(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(c=>c.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{i=new p(o.value),o.value.addEventListener("hidden.bs.modal",d)})}),ve(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",d),i&&i.dispose()}),(p,c)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",bC,[t("div",yC,[c[13]||(c[13]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",$C,[s.value?(u(),m("div",EC,[t("div",CC,[c[0]||(c[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,w(s.value.name||"Unnamed Minion"),1)]),t("div",SC,[c[1]||(c[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",kC,w(s.value.session_id),1)]),t("div",TC,[c[2]||(c[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,w(s.value.role||"Not specified"),1)]),t("div",xC,[c[3]||(c[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:G(["badge",a(s.value.state)])},w(s.value.state),3)])]),t("div",MC,[c[4]||(c[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(u(),m("div",AC,[t("div",OC,[(u(!0),m(ae,null,de(s.value.capabilities,_=>(u(),m("span",{key:_,class:"badge bg-secondary"},w(_),1))),128))])])):(u(),m("div",NC,"None"))]),t("div",LC,[c[5]||(c[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(u(),m("div",DC,w(s.value.initialization_context),1)):(u(),m("div",IC,"Not specified"))]),t("div",PC,[c[6]||(c[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(u(),m("span",jC,"Yes")):(u(),m("span",RC,"No"))])]),t("div",VC,[c[7]||(c[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(u(),m("div",HC,w(s.value.parent_overseer_id),1)):(u(),m("div",WC,w(s.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),s.value.is_overseer?(u(),m("div",FC,[c[8]||(c[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(u(),m("div",UC,[t("ul",BC,[(u(!0),m(ae,null,de(s.value.child_minion_ids,_=>(u(),m("li",{key:_,class:"font-monospace small"},w(_),1))),128))])])):(u(),m("div",qC,"No children"))])):L("",!0),t("div",zC,[c[9]||(c[9]=t("h6",{class:"text-muted"},"Horde Membership",-1)),s.value.horde_id?(u(),m("div",KC,w(s.value.horde_id),1)):(u(),m("div",GC,"Not in a horde"))]),t("div",YC,[c[10]||(c[10]=t("h6",{class:"text-muted"},"Channel Memberships",-1)),s.value.channel_ids&&s.value.channel_ids.length>0?(u(),m("div",JC,[t("div",XC,[(u(!0),m(ae,null,de(s.value.channel_ids,_=>(u(),m("span",{key:_,class:"badge bg-info"},w(_),1))),128))])])):(u(),m("div",QC,"No channels"))]),t("div",ZC,[c[11]||(c[11]=t("h6",{class:"text-muted"},"Created",-1)),t("div",eS,w(l(s.value.created_at)),1)]),t("div",tS,[c[12]||(c[12]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",sS,w(l(s.value.updated_at)),1)])])):(u(),m("div",wC," No minion data available "))]),c[14]||(c[14]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},oS=K(nS,[["__scopeId","data-v-c44eaee2"]]),iS={class:"modal-dialog modal-lg"},aS={class:"modal-content"},lS={class:"modal-body"},rS={key:0,class:"template-list"},cS={key:0,class:"alert alert-info"},dS={class:"card-body"},uS={class:"d-flex justify-content-between align-items-start"},mS={class:"flex-grow-1"},pS={class:"card-title mb-1"},fS={class:"card-text text-muted small mb-2"},vS={class:"template-meta"},hS={class:"badge bg-secondary me-2"},_S={class:"text-muted small"},gS={class:"btn-group btn-group-sm ms-3"},bS=["onClick"],yS=["onClick"],$S={key:1,class:"template-form"},wS={class:"mb-3"},ES={class:"mb-3"},CS={class:"mb-3"},SS={class:"mb-3"},kS={class:"mb-3"},TS={class:"mb-3"},xS={class:"mb-3"},MS={key:0,class:"alert alert-danger"},AS={class:"d-flex gap-2"},OS=["disabled"],NS={key:0,class:"spinner-border spinner-border-sm me-2"},LS={__name:"TemplateManagementModal",setup(n){const e=fe(),s=A(null);let o=null;const i=A([]),a=A(null),l=A(""),r=A(""),d=A(!1);async function p(){try{const h=await se.get("/api/templates");i.value=h||[]}catch(h){console.error("Failed to load templates:",h),i.value=[]}}function c(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},l.value="",r.value=""}function _(h){a.value={...h},l.value=h.allowed_tools?.join(", ")||"",r.value=""}async function b(){if(!a.value.name.trim()){r.value="Template name is required";return}d.value=!0,r.value="";try{const h=l.value.split(",").map(k=>k.trim()).filter(k=>k.length>0),v={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:h.length>0?h:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await se.post("/api/templates",v):await se.put(`/api/templates/${a.value.template_id}`,v),await p(),a.value=null,l.value=""}catch(h){console.error("Failed to save template:",h),r.value=h.response?.data?.detail||"Failed to save template"}finally{d.value=!1}}async function f(h){if(confirm(`Delete template "${h.name}"?

This action cannot be undone.`))try{await se.delete(`/api/templates/${h.template_id}`),await p()}catch(v){console.error("Failed to delete template:",v),alert(`Failed to delete template: ${v.response?.data?.detail||v.message}`)}}function $(){a.value=null,l.value="",r.value=""}function y(){a.value=null,l.value="",r.value="",e.hideModal()}return ce(()=>e.currentModal,h=>{h?.name==="template-management"&&o&&(p(),o.show())}),me(()=>{s.value&&be(()=>import("./modal-B4rHLo2F.js").then(h=>h.m),__vite__mapDeps([0,1])).then(h=>{const v=h.default;o=new v(s.value),s.value.addEventListener("hidden.bs.modal",y)})}),ve(()=>{s.value&&s.value.removeEventListener("hidden.bs.modal",y),o&&o.dispose()}),(h,v)=>(u(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[t("div",iS,[t("div",aS,[v[15]||(v[15]=t("div",{class:"modal-header"},[t("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",lS,[a.value?L("",!0):(u(),m("div",rS,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[v[6]||(v[6]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:c,class:"btn btn-primary btn-sm"}," âž• Create New ")]),i.value.length===0?(u(),m("div",cS," No templates found. Create your first template! ")):L("",!0),(u(!0),m(ae,null,de(i.value,C=>(u(),m("div",{key:C.template_id,class:"card mb-2"},[t("div",dS,[t("div",uS,[t("div",mS,[t("h6",pS,w(C.name),1),t("p",fS,w(C.description),1),t("div",vS,[t("span",hS,w(C.permission_mode),1),t("span",_S,w(C.allowed_tools?.length||0)+" tools",1)])]),t("div",gS,[t("button",{onClick:k=>_(C),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,bS),t("button",{onClick:k=>f(C),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,yS)])])])]))),128))])),a.value?(u(),m("div",$S,[t("h6",wS,w(a.value.template_id?"Edit Template":"Create Template"),1),t("div",ES,[v[7]||(v[7]=t("label",{for:"template-name",class:"form-label"},[X(" Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"template-name","onUpdate:modelValue":v[0]||(v[0]=C=>a.value.name=C),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[pe,a.value.name]])]),t("div",CS,[v[8]||(v[8]=t("label",{for:"template-description",class:"form-label"},"Description",-1)),oe(t("textarea",{id:"template-description","onUpdate:modelValue":v[1]||(v[1]=C=>a.value.description=C),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[pe,a.value.description]])]),t("div",SS,[v[10]||(v[10]=t("label",{for:"template-permission-mode",class:"form-label"},[X(" Permission Mode "),t("span",{class:"text-danger"},"*")],-1)),oe(t("select",{id:"template-permission-mode","onUpdate:modelValue":v[2]||(v[2]=C=>a.value.permission_mode=C),class:"form-select",required:""},[...v[9]||(v[9]=[t("option",{value:"default"},"Default",-1),t("option",{value:"acceptEdits"},"Accept Edits",-1),t("option",{value:"plan"},"Plan Mode",-1),t("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Oe,a.value.permission_mode]])]),t("div",kS,[v[11]||(v[11]=t("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),oe(t("input",{id:"template-tools","onUpdate:modelValue":v[3]||(v[3]=C=>l.value=C),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[pe,l.value]]),v[12]||(v[12]=t("div",{class:"form-text"},"Comma-separated list of tools",-1))]),t("div",TS,[v[13]||(v[13]=t("label",{for:"template-role",class:"form-label"},"Default Role",-1)),oe(t("input",{id:"template-role","onUpdate:modelValue":v[4]||(v[4]=C=>a.value.default_role=C),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[pe,a.value.default_role]])]),t("div",xS,[v[14]||(v[14]=t("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),oe(t("textarea",{id:"template-prompt","onUpdate:modelValue":v[5]||(v[5]=C=>a.value.default_system_prompt=C),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[pe,a.value.default_system_prompt]])]),r.value?(u(),m("div",MS,w(r.value),1)):L("",!0),t("div",AS,[t("button",{onClick:b,class:"btn btn-primary",disabled:d.value},[d.value?(u(),m("span",NS)):L("",!0),X(" "+w(d.value?"Saving...":"Save Template"),1)],8,OS),t("button",{onClick:$,class:"btn btn-secondary"},"Cancel")])])):L("",!0)])])])],512))}},DS=K(LS,[["__scopeId","data-v-81126ff4"]]),IS={class:"container-fluid vh-100 d-flex flex-column p-0"},PS={class:"d-flex flex-grow-1 overflow-hidden position-relative"},jS={class:"flex-grow-1 d-flex flex-column overflow-hidden"},RS={__name:"App",setup(n){const e=fe(),s=je(),o=ie(),i=ge(),a=Ge(),l=g(()=>e.sidebarCollapsed),r=g(()=>e.isMobile);me(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const _=c.replace("#/session/","");o.sessions.has(_)&&await o.selectSession(_)}else if(c.startsWith("#/timeline/")){const _=c.replace("#/timeline/","");a.push(`/timeline/${_}`)}window.addEventListener("popstate",d),window.addEventListener("resize",e.handleResize)}),ve(()=>{window.removeEventListener("popstate",d),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function d(){const c=window.location.hash;if(c.startsWith("#/session/")){const _=c.replace("#/session/","");o.sessions.has(_)&&o.selectSession(_)}}function p(){e.toggleSidebar()}return(c,_)=>{const b=io("router-view");return u(),m("div",IS,[re(yy),t("div",{id:"sidebar-backdrop",class:G({show:!l.value&&r.value}),onClick:p},null,2),t("div",PS,[re(H1),t("main",jS,[re(b)])]),re(n$),re(w$),re(B$),re(pw),re(Ww),re(rE),re(NE),re(gC),re(oS),re(DS)])}}},an=_i(RS);an.use(gi());an.use(uy);an.mount("#app");
