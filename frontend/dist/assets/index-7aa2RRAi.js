const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c,a as s,o as a,d as nt,r as R,b as v,t as b,n as te,u as ye,e as Ke,f as ae,w as ve,g as bs,F as le,h as ce,i as A,j as we,v as Fe,k as $e,l as po,m as fe,p as ze,q as he,s as kt,x as ke,y as Si,z as fo,A as Te,B as _n,C as vo,D as Ft,E as Ei,G as Ci,H as ho,T as Ti,I as xi,J as Ai,K as Mi,L as ys,M as ws,N as gn,O as Oi,P as Di}from"./vue-vendor-P3Jw5Y9s.js";import{m as dt,p as cs}from"./markdown-vendor-BRsjnVvP.js";import{c as Li}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const Ni={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},ji={__name:"NoSessionSelected",setup(n){return(e,t)=>(a(),c("div",Ni,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Ii="modulepreload",Pi=function(n){return"/"+n},bn={},Me=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let m=function(f){return Promise.all(f.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),p=l?.nonce||l?.getAttribute("nonce");i=m(t.map(f=>{if(f=Pi(f),f in bn)return;bn[f]=!0;const u=f.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${w}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":Ii,u||(g.as="script"),g.crossOrigin="",g.href=f,p&&g.setAttribute("nonce",p),document.head.appendChild(g),u)return new Promise((k,$)=>{g.addEventListener("load",k),g.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${f}`)))})}))}function r(l){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=l,window.dispatchEvent(p),!p.defaultPrevented)throw l}return i.then(l=>{for(const p of l||[])p.status==="rejected"&&r(p.reason);return e().catch(r)})};class $s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function St(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new $s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof $s?t:(console.error("API request failed:",t),new $s(`Network error: ${t.message}`,0,null))}}async function _o(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[p,m]of Object.entries(e.params))m!=null&&o.append(p,m);const i=o.toString();i&&(t=`${n}?${i}`);const{params:r,...l}=e;return St(t,{...l,method:"GET"})}return St(t,{...e,method:"GET"})}async function Ri(n,e,t={}){return St(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Bi(n,e,t={}){return St(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Wi(n,e={}){return St(n,{...e,method:"DELETE"})}async function Fi(n,e,t={}){return St(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const me={get:_o,post:Ri,put:Bi,delete:Wi,patch:Fi},de=nt("session",()=>{const n=R(new Map),e=R(null),t=R(new Map),o=R(new Map),i=R(new Set),r=R(!1);let l=null;const p=v(()=>n.value.get(e.value)),m=v(()=>Array.from(n.value.values()).sort((M,V)=>M.order-V.order)),f=M=>v(()=>m.value.filter(V=>V.project_id===M)),u=v({get:()=>t.value.get(e.value)||"",set:M=>{e.value&&t.value.set(e.value,M)}});async function w(){try{const M=await me.get("/api/sessions");return n.value.clear(),M.sessions.forEach(V=>{n.value.set(V.session_id,V)}),console.log(`Loaded ${n.value.size} sessions`),M.sessions}catch(M){throw console.error("Failed to fetch sessions:",M),M}}async function g(M,V){try{const E=(await me.post("/api/sessions",{project_id:M,...V})).session_id,z=(await me.get(`/api/sessions/${E}`)).session;return n.value.set(E,z),n.value=new Map(n.value),console.log(`Created session ${E}`),z}catch(T){throw console.error("Failed to create session:",T),T}}async function k(M){if(e.value===M&&!r.value)return;l&&(console.log(`Aborting pending selection to switch to ${M}`),l.abort(),l=null);const V=new AbortController;l=V,r.value=!0;try{if(e.value=M,V.signal.aborted){console.log(`Selection of ${M} aborted early`);return}let T=n.value.get(M);if(!T)try{const N=await me.get(`/api/sessions/${M}`);if(V.signal.aborted){console.log(`Selection of ${M} aborted after fetch`);return}T=N.session,n.value.set(M,T),n.value=new Map(n.value),console.log(`Fetched session ${M} for deeplink`)}catch(N){console.error(`Failed to fetch session ${M}:`,N);return}if(T&&(T.state==="created"||T.state==="terminated"))try{if(await _(M),V.signal.aborted){console.log(`Selection of ${M} aborted after start`);return}console.log(`Auto-started session ${M} (was in ${T.state} state)`);const N=6e4,W=200,K=5e3;let Z=0,D=0;for(;Z<N;){if(V.signal.aborted){console.log(`Selection of ${M} aborted during state wait`);return}const O=n.value.get(M);if(O&&O.state==="active"){console.log(`Session ${M} is now active after ${Z}ms`);break}if(Z-D>=K){const S=n.value.get(M)?.state||"unknown";console.log(`Waiting for session ${M} to become active (current: ${S}, ${Z/1e3}s elapsed)`),D=Z}await new Promise(S=>setTimeout(S,W)),Z+=W}const L=n.value.get(M);L&&L.state!=="active"&&console.warn(`Session ${M} did not become active within ${N/1e3}s (state: ${L.state}), continuing anyway`)}catch(N){console.error(`Failed to auto-start session ${M}:`,N)}if(V.signal.aborted){console.log(`Selection of ${M} aborted before message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>ia),void 0)).useMessageStore().loadMessages(M),V.signal.aborted){console.log(`Selection of ${M} aborted after message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>Ta),void 0)).useResourceStore().loadResources(M),V.signal.aborted){console.log(`Selection of ${M} aborted after resource load`);return}await(await Me(()=>Promise.resolve().then(()=>xa),void 0)).useWebSocketStore().connectSession(M),V.signal.aborted||console.log(`Selected session ${M}`)}finally{l===V&&(l=null),r.value=!1}}function $(M,V){const T=n.value.get(M);T?Object.assign(T,V):(n.value.set(M,V),console.log(`Added new session ${M} via WebSocket update`)),n.value=new Map(n.value)}async function y(M){i.value.add(M);try{const T=(await me.delete(`/api/sessions/${M}`)).deleted_session_ids||[M];for(const E of T)n.value.delete(E),t.value.delete(E),o.value.delete(E);return n.value=new Map(n.value),T.includes(e.value)&&(e.value=null),console.log(`Deleted ${T.length} session(s): ${T.join(", ")}`),T}catch(V){throw console.error("Failed to delete session:",V),V}finally{i.value.delete(M)}}async function d(M,V){try{await me.patch(`/api/sessions/${M}`,V),$(M,V),console.log(`Updated session ${M}:`,V)}catch(T){throw console.error("Failed to update session:",T),T}}async function h(M,V){try{await me.post(`/api/sessions/${M}/permission-mode`,{mode:V}),$(M,{current_permission_mode:V});const T=o.value.get(M);T&&(T.permissionMode=V,o.value.set(M,T)),console.log(`Set permission mode for session ${M} to ${V}`)}catch(T){throw console.error("Failed to set permission mode:",T),T}}async function _(M){try{await me.post(`/api/sessions/${M}/start`),console.log(`Started session ${M}`)}catch(V){throw console.error("Failed to start session:",V),V}}async function x(M){try{await me.post(`/api/sessions/${M}/pause`),console.log(`Paused session ${M}`)}catch(V){throw console.error("Failed to pause session:",V),V}}async function C(M){try{await me.post(`/api/sessions/${M}/terminate`),console.log(`Terminated session ${M}`)}catch(V){throw console.error("Failed to terminate session:",V),V}}function B(M){return n.value.get(M)}function j(M,V){o.value.set(M,V),V.permissionMode&&$(M,{current_permission_mode:V.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:p,orderedSessions:m,sessionsInProject:f,currentInput:u,fetchSessions:w,createSession:g,selectSession:k,updateSession:$,deleteSession:y,patchSession:d,setPermissionMode:h,startSession:_,pauseSession:x,terminateSession:C,getSession:B,storeInitData:j}}),yn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:de},Symbol.toStringTag,{value:"Module"})),be=nt("ui",()=>{const n=R(window.innerWidth<768),e=R(300),t=R(!0),o=R(300),i=R(window.innerWidth),r=v(()=>i.value<768),l=R(!0),p=R(!1),m=R(null),f=R(null),u=v(()=>m.value?{name:m.value,data:f.value}:null),w=R(!1),g=R("Loading...");function k(){n.value=!n.value}function $(P){n.value=P}function y(P){e.value=Math.max(200,Math.min(P,window.innerWidth*.3))}function d(){t.value=!t.value}function h(P){t.value=P}function _(P){o.value=Math.max(200,Math.min(P,window.innerWidth*.3))}function x(P){l.value=P}function C(){const P=localStorage.getItem("webui-background-color");p.value=P==="red"}function B(){p.value=!p.value,localStorage.setItem("webui-background-color",p.value?"red":"gray")}function j(P,z=null){m.value=null,f.value=null,setTimeout(()=>{m.value=P,f.value=z},0)}function M(){m.value=null,f.value=null}function V(P="Loading..."){w.value=!0,g.value=P}function T(){w.value=!1}function E(){const P=i.value;i.value=window.innerWidth,i.value<768&&P>=768?n.value=!0:i.value>=768&&P<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:r,autoScrollEnabled:l,isRedBackground:p,activeModal:m,modalData:f,currentModal:u,isLoading:w,loadingMessage:g,toggleSidebar:k,setSidebarCollapsed:$,setSidebarWidth:y,toggleRightSidebar:d,setRightSidebarCollapsed:h,setRightSidebarWidth:_,setAutoScroll:x,initBackgroundColor:C,toggleBackgroundColor:B,showModal:j,hideModal:M,showLoading:V,hideLoading:T,handleResize:E}}),Re=nt("project",()=>{const n=R(new Map),e=R(null),t=v(()=>n.value.get(e.value)),o=v(()=>Array.from(n.value.values()).sort((d,h)=>d.order-h.order));async function i(){try{const d=await me.get("/api/projects");return n.value.clear(),d.projects.forEach(h=>{n.value.set(h.project_id,h)}),console.log(`Loaded ${n.value.size} projects`),d.projects}catch(d){throw console.error("Failed to fetch projects:",d),d}}async function r(d,h){try{const x=(await me.post("/api/projects",{name:d,working_directory:h})).project;return n.value.set(x.project_id,x),n.value=new Map(n.value),console.log(`Created project ${x.project_id}`),x}catch(_){throw console.error("Failed to create project:",_),_}}async function l(d,h){try{await me.put(`/api/projects/${d}`,h),p(d,h),console.log(`Updated project ${d}`,h)}catch(_){throw console.error("Failed to update project:",_),_}}function p(d,h){const _=n.value.get(d);_&&(Object.assign(_,h),n.value=new Map(n.value))}async function m(d){try{await me.delete(`/api/projects/${d}`),n.value.delete(d),n.value=new Map(n.value),e.value===d&&(e.value=null),console.log(`Deleted project ${d}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function f(d){try{const h=await me.put(`/api/projects/${d}/toggle-expansion`),_=n.value.get(d);return _&&(_.is_expanded=h.is_expanded,n.value=new Map(n.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function u(d){try{await me.put("/api/projects/reorder",{project_ids:d}),d.forEach((h,_)=>{const x=n.value.get(h);x&&(x.order=_)}),n.value=new Map(n.value),console.log("Reordered projects",d)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function w(d,h){try{await me.put(`/api/projects/${d}/sessions/reorder`,{session_ids:h});const _=n.value.get(d);_&&(_.session_ids=h,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${d}`,h)}catch(_){throw console.error("Failed to reorder sessions:",_),_}}function g(d){return n.value.get(d)}function k(d){e.value=d}function $(){e.value=null}function y(d){if(!d)return"";const h=d.split(/[/\\]/).filter(_=>_);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:r,updateProject:l,updateProjectLocal:p,deleteProject:m,toggleExpansion:f,reorderProjects:u,reorderSessionsInProject:w,getProject:g,selectProject:k,clearProjectSelection:$,formatPath:y}}),ne=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Hi={class:"project-name"},Vi=["title"],Ui={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=Re(),i=be(),r=v(()=>t.sessions.get(e.sessionId)),l=v(()=>r.value?.name||e.sessionId),p=v(()=>{for(const f of o.projects.values())if(f.session_ids?.includes(e.sessionId))return f;return null}),m=v(()=>p.value?.name||"Unknown Project");return(f,u)=>(a(),c("div",{class:te(["session-header border-bottom p-3",{"theme-red-panel":ye(i).isRedBackground}])},[s("div",Hi,b(m.value),1),s("div",{class:"session-name",title:n.sessionId},b(l.value),9,Vi)],2))}},qi=ne(Ui,[["__scopeId","data-v-ba771dd8"]]),zi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ki=["title"],Gi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Yi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=v(()=>t.sessions.get(e.sessionId)),i=v(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=v(()=>{const m=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),l=v(()=>{const m=i.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),p=v(()=>{if(!o.value)return"No session selected";const m=i.value,f=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${u}${w}: ${f}`});return(m,f)=>(a(),c("div",zi,[o.value?(a(),c("div",{key:0,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:Ke({width:"100%",backgroundColor:r.value}),title:p.value},null,14,Ki)):(a(),c("div",Gi))]))}},Ji=ne(Yi,[["__scopeId","data-v-63d222fe"]]),Qi={class:"d-flex justify-content-between align-items-center gap-2"},Xi={class:"d-flex gap-2"},Zi=["disabled"],ea={class:"mode-label"},ta=["disabled"],sa=["disabled"],na={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=be(),i=v(()=>t.sessions.get(e.sessionId)),r=v(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},p=v(()=>l[r.value]||"ðŸ”’"),m=v(()=>r.value),f=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(r.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const y=(f.indexOf(r.value)+1)%f.length,d=f[y];try{await t.setPermissionMode(e.sessionId,d)}catch(h){console.error("Failed to cycle permission mode:",h)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},k=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return($,y)=>(a(),c("div",{class:te(["session-status-bar border-top p-2",ye(o).isRedBackground?"theme-red-panel":"bg-light"])},[s("div",Qi,[s("div",Xi,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[ae(b(p.value)+" ",1),s("span",ea,b(m.value),1)],8,Zi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!i.value},[...y[0]||(y[0]=[ae(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,ta),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...y[1]||(y[1]=[ae(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,sa)]),s("div",null,[s("button",{class:te(["btn btn-sm",ye(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:k}," â¬‡ï¸ "+b(ye(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},oa=ne(na,[["__scopeId","data-v-ed9a4d3c"]]),Rt=nt("task",()=>{const n=R(new Map),e=R(new Set);function t(_){const x=n.value.get(_);return x?Array.from(x.values()).sort((C,B)=>{const j=parseInt(C.id.replace(/\D/g,""))||0,M=parseInt(B.id.replace(/\D/g,""))||0;return j-M}):[]}function o(_){return t(_).find(C=>C.status==="in_progress")||null}function i(_){const x=t(_);return{total:x.length,completed:x.filter(C=>C.status==="completed").length,inProgress:x.filter(C=>C.status==="in_progress").length,pending:x.filter(C=>C.status==="pending").length}}function r(_){return e.value.has(_)}const l=v(()=>{const _=de();return t(_.currentSessionId)}),p=v(()=>{const _=de();return o(_.currentSessionId)}),m=v(()=>{const _=de();return i(_.currentSessionId)}),f=v(()=>{const _=de();return r(_.currentSessionId)});function u(_,x){n.value.has(_)||n.value.set(_,new Map),n.value.get(_).set(x.id,{id:x.id,subject:x.subject||"",description:x.description||"",status:x.status||"pending",activeForm:x.activeForm||null,owner:x.owner||null,blocks:x.blocks||[],blockedBy:x.blockedBy||[],metadata:x.metadata||{}}),e.value.add(_),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${x.id} for session ${_}`)}function w(_,x,C){const B=n.value.get(_);if(!B){console.warn(`No tasks found for session ${_}`);return}const j=B.get(x);if(!j){u(_,{id:x,...C});return}C.subject!==void 0&&(j.subject=C.subject),C.description!==void 0&&(j.description=C.description),C.status!==void 0&&(j.status=C.status),C.activeForm!==void 0&&(j.activeForm=C.activeForm),C.owner!==void 0&&(j.owner=C.owner),C.metadata!==void 0&&(j.metadata={...j.metadata,...C.metadata}),C.addBlocks&&(j.blocks=[...new Set([...j.blocks,...C.addBlocks])]),C.addBlockedBy&&(j.blockedBy=[...new Set([...j.blockedBy,...C.addBlockedBy])]),C.status==="deleted"&&(B.delete(x),B.size===0&&(e.value.delete(_),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${x} for session ${_}`,C)}function g(_,x){return n.value.get(_)?.get(x)||null}function k(_){n.value.delete(_),e.value.delete(_),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${_}`)}function $(_,x){n.value.has(_)&&n.value.get(_).clear(),e.value.delete(_);const C=new Map;for(const B of x){if(B.metadata?.tool_uses)for(const j of B.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(j.name)&&C.set(j.id,{name:j.name,input:j.input});if(B.metadata?.tool_results)for(const j of B.metadata.tool_results){const M=C.get(j.tool_use_id);M&&(y(_,M.name,M.input,{error:j.is_error,content:j.content}),C.delete(j.tool_use_id))}}console.log(`Reconstructed ${n.value.get(_)?.size||0} tasks for session ${_}`)}function y(_,x,C,B){if(B?.error){console.log(`Skipping task update - tool ${x} returned error`);return}const j=d(B);if(j)switch(x){case"TaskCreate":{const M=h(j)||C?.id;M&&u(_,{id:M,subject:C?.subject||"",description:C?.description||"",status:"pending",activeForm:C?.activeForm||null,owner:C?.owner||null,blocks:[],blockedBy:[],metadata:C?.metadata||{}});break}case"TaskUpdate":{const M=C?.taskId;M&&w(_,M,{status:C?.status,subject:C?.subject,description:C?.description,activeForm:C?.activeForm,owner:C?.owner,metadata:C?.metadata,addBlocks:C?.addBlocks,addBlockedBy:C?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{C?.taskId;break}}}function d(_){return _?typeof _=="string"?_:_.content?typeof _.content=="string"?_.content:JSON.stringify(_.content):_.message?_.message:JSON.stringify(_):null}function h(_){if(!_)return null;const x=_.match(/[Tt]ask\s*#(\d+)/i);if(x)return x[1];const C=_.match(/#(\d+)/);return C?C[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:l,currentActiveTask:p,currentTaskStats:m,currentHasTasks:f,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:r,getTask:g,createTask:u,updateTask:w,clearTasks:k,reconstructFromMessages:$,handleTaskToolResult:y}}),Oe=nt("message",()=>{const n=R(new Map),e=R(new Map),t=R(new Map),o=R(new Map),i=R(new Map),r=R(new Map),l=R(new Map),p=R(new Map),m=v(()=>{const D=de();return n.value.get(D.currentSessionId)||[]}),f=v(()=>{const D=de();return e.value.get(D.currentSessionId)||[]});async function u(D,L=null,O=0){try{const S=L||1e4,I=await me.get(`/api/sessions/${D}/messages?limit=${S}&offset=${O}`),G=I.messages||[],Q=I.total_count||G.length,Y=I.has_more||!1;if(console.log(`Loaded ${G.length} of ${Q} messages for session ${D}`),n.value.set(D,G),G.length>0){const F=G[G.length-1];F.timestamp&&(l.value.set(D,F.timestamp),console.log(`Tracked last received timestamp for session ${D}: ${F.timestamp}`))}const ee=new Set;G.forEach(F=>{F.type==="assistant"&&F.metadata?.tool_uses&&F.metadata.tool_uses.forEach(q=>{ee.add(q.id)}),F.type==="user"&&F.metadata?.tool_results&&F.metadata.tool_results.forEach(q=>{ee.delete(q.tool_use_id);const se=r.value.get(D);se&&se.delete(q.tool_use_id)}),F.type==="system"&&F.metadata?.subtype==="client_launched"&&(ee.forEach(q=>{T(D,q,"Session was restarted")}),ee.clear()),F.type==="system"&&F.metadata?.subtype==="interrupt"&&(ee.forEach(q=>{T(D,q,"Session was interrupted")}),ee.clear()),F.metadata?.has_tool_uses&&F.metadata.tool_uses&&F.metadata.tool_uses.forEach(q=>{y(D,q,F.timestamp)}),F.metadata?.has_tool_results&&F.metadata.tool_results&&F.metadata.tool_results.forEach(q=>{x(D,q)}),(F.type==="permission_request"||F.metadata?.has_permission_requests)&&d(D,F),F.type==="permission_response"&&h(D,{request_id:F.metadata?.request_id,decision:F.metadata?.decision,updated_input:F.metadata?.updated_input,reasoning:F.metadata?.reasoning,applied_updates:F.metadata?.applied_updates}),F.type==="system"&&(F.subtype==="init"||F.metadata?.subtype==="init")&&F.metadata?.init_data&&de().storeInitData(D,F.metadata.init_data)});const J=de().sessions.get(D);J&&!["active","paused","starting"].includes(J.state)&&(ee.forEach(F=>{T(D,F,"Session was terminated")}),ee.clear()),i.value.set(D,ee),n.value=new Map(n.value);try{Rt().reconstructFromMessages(D,G)}catch(F){console.warn("Failed to reconstruct task state:",F)}return Y&&console.warn(`Warning: Only loaded ${G.length} of ${Q} messages. Some messages may be missing.`),{messages:G,totalCount:Q,hasMore:Y}}catch(S){throw console.error("Failed to load messages:",S),S}}function w(D,L){const O=i.value.get(D)||new Set;L.type==="assistant"&&L.metadata?.tool_uses&&L.metadata.tool_uses.forEach(S=>{O.add(S.id)}),L.type==="user"&&L.metadata?.tool_results&&L.metadata.tool_results.forEach(S=>{O.delete(S.tool_use_id);const I=r.value.get(D);I&&I.delete(S.tool_use_id)}),L.type==="system"&&L.metadata?.subtype==="client_launched"&&(O.forEach(S=>{T(D,S,"Session was restarted")}),O.clear()),L.type==="system"&&L.metadata?.subtype==="interrupt"&&(O.forEach(S=>{T(D,S,"Session was interrupted")}),O.clear()),i.value.set(D,O)}function g(D,L){n.value.has(D)||n.value.set(D,[]);const O=n.value.get(D);if(L.id){const S=O.findIndex(I=>I.id===L.id);if(S!==-1){console.log(`Skipping duplicate message ${L.id} (already exists at index ${S})`);return}}O.push(L),L.timestamp&&l.value.set(D,L.timestamp),j(D,L),w(D,L),n.value=new Map(n.value)}function k(D,L){e.value.has(D)||e.value.set(D,[]),e.value.get(D).push(L),e.value=new Map(e.value)}function $(D,L,O){const S=e.value.get(D);if(S){const I=S.find(G=>G.id===L);I&&(Object.assign(I,O),e.value=new Map(e.value))}}function y(D,L,O=null){const S=B(L.name,L.input);t.value.set(S,L.id);const I={id:L.id,name:L.name,input:L.input,signature:S,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:O||new Date().toISOString(),isExpanded:!0};return k(D,I),console.log(`Created tool call ${I.id} for ${I.name}`),I}function d(D,L){console.log("handlePermissionRequest received:",L);const O=L.metadata?.tool_name||L.tool_name,S=L.metadata?.input_params||L.input_params,I=L.metadata?.request_id||L.request_id,G=L.metadata?.suggestions||L.suggestions||[];console.log("Extracted data:",{toolName:O,inputParams:S,requestId:I,suggestions:G});const Q=B(O,S),Y=t.value.get(Q);Y?(o.value.set(I,Y),$(D,Y,{status:"permission_required",permissionRequestId:I,suggestions:G}),console.log(`Permission required for tool ${Y}`,{suggestions:G})):console.warn("No tool use ID found for permission request signature:",Q,{toolName:O,inputParams:S,availableSignatures:Array.from(t.value.keys())})}function h(D,L){const O=o.value.get(L.request_id);if(O){const S={permissionDecision:L.decision,appliedUpdates:L.applied_updates||[]};L.decision==="allow"?(S.status="executing",S.backendStatus="running"):(S.status="completed",S.backendStatus="denied",S.result={error:!0,message:L.reasoning||"Permission denied"},S.isExpanded=!1),L.updated_input&&(S.input=L.updated_input),$(D,O,S),console.log(`Permission ${L.decision} for tool ${O}`)}}function _(D,L){console.log("handleToolCall received:",L);const O=L.tool_use_id;if(!O){console.warn("Received tool_call without tool_use_id:",L);return}e.value.has(D)||e.value.set(D,[]);const S=e.value.get(D),I=S.findIndex(Y=>Y.id===O),Q={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[L.status]||L.status;if(I!==-1){const Y=S[I];Y.status=Q,Y.backendStatus=L.status,L.permission&&(Y.suggestions=L.permission.suggestions||[],Y.permissionRequestId=L.request_id),L.permission_granted!==null&&L.permission_granted!==void 0&&(Y.permissionDecision=L.permission_granted?"allow":"deny"),L.result!==void 0&&(Y.result={error:L.status==="failed",content:L.result}),L.error&&(Y.result={error:!0,content:L.error}),L.status==="denied"&&(Y.result={error:!0,message:"Permission denied"},Y.isExpanded=!1),L.status==="interrupted"&&(T(D,O,"Session was interrupted"),Y.isExpanded=!1),(L.status==="completed"||L.status==="failed")&&(Y.isExpanded=!1),L.display&&(Y.backendState=L.display),console.log(`Updated tool call ${O} to status: ${Q} (backend: ${L.status})`)}else{const Y=B(L.name,L.input);t.value.set(Y,O);const ee={id:O,name:L.name,input:L.input,signature:Y,status:Q,backendStatus:L.status,permissionRequestId:L.request_id,permissionDecision:L.permission_granted!==void 0?L.permission_granted?"allow":"deny":null,suggestions:L.permission?.suggestions||[],result:L.result?{error:L.status==="failed",content:L.result}:null,explanation:null,timestamp:L.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(L.status),backendState:L.display};L.error&&(ee.result={error:!0,content:L.error}),S.push(ee),console.log(`Created new tool call ${O} for ${L.name} with status: ${Q}`)}if(e.value=new Map(e.value),["completed","failed"].includes(L.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(L.name))try{Rt().handleTaskToolResult(D,L.name,L.input,{error:L.status==="failed",content:L.result})}catch(Y){console.warn("Failed to update task store:",Y)}}function x(D,L){const O=L.tool_use_id;$(D,O,{status:L.is_error?"error":"completed",result:{error:L.is_error,content:L.content},isExpanded:!1}),console.log(`Tool ${O} ${L.is_error?"failed":"completed"}`);const S=e.value.get(D);if(S){const I=S.find(G=>G.id===O);if(I&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name))try{Rt().handleTaskToolResult(D,I.name,I.input,{error:L.is_error,content:L.content})}catch(G){console.warn("Failed to update task store:",G)}}}function C(D,L){const O=e.value.get(D);if(O){const S=O.find(I=>I.id===L);S&&(S.isExpanded=!S.isExpanded,e.value=new Map(e.value))}}function B(D,L){if(!D)return"unknown:{}";if(!L||typeof L!="object")return`${D}:{}`;const O=JSON.stringify(L,Object.keys(L).sort());return`${D}:${O}`}function j(D,L){const O=L.metadata?.display||L.display;if(!O)return;p.value.has(D)||p.value.set(D,new Map);const S=p.value.get(D);if(O.tool_states)for(const[I,G]of Object.entries(O.tool_states)){S.set(I,G);const Q=e.value.get(D);if(Q){const Y=Q.find(ee=>ee.id===I);if(Y){const ee={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Y.status=ee[G.state]||G.state,Y.backendState=G}}}if(O.orphaned_tools&&O.orphaned_tools.length>0){const I=r.value.get(D)||new Map;for(const G of O.orphaned_tools)I.has(G)||I.set(G,{reason:"denied",message:"Session was interrupted"});r.value.set(D,I)}if(O.linked_permissions)for(const[I,G]of Object.entries(O.linked_permissions))o.value.set(I,G);O.tool_states&&Object.keys(O.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${D}:`,{toolStates:Object.keys(O.tool_states||{}).length,orphanedTools:(O.orphaned_tools||[]).length,linkedPermissions:Object.keys(O.linked_permissions||{}).length})}function M(D,L){return p.value.get(D)?.get(L)}function V(D){const L=p.value.get(D);return L&&L.size>0}function T(D,L,O){const S=r.value.get(D)||new Map;S.set(L,{reason:"denied",message:O}),r.value.set(D,S);const I=e.value.get(D);if(I){const G=I.find(Q=>Q.id===L);G&&G.isExpanded&&(G.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${L} as orphaned: ${O}`)}function E(D,L){const O=M(D,L);return O&&O.state==="orphaned"?!0:r.value.get(D)?.has(L)||!1}function P(D,L){const O=M(D,L);return O&&O.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:O}:r.value.get(D)?.get(L)}function z(D,L){const O=i.value.get(D);O&&O.size>0&&(O.forEach(S=>T(D,S,L)),O.clear())}function N(D){n.value.delete(D),e.value.delete(D),n.value=new Map(n.value),e.value=new Map(e.value)}function W(D){return l.value.get(D)}async function K(D){const L=l.value.get(D);if(!L)return console.log(`No sync needed for session ${D} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${D} since ${L}`);const O=await me.get(`/api/sessions/${D}/messages?limit=1000&offset=0`),S=O.messages||[],I=O.has_more||!1,G=q=>q?typeof q=="number"?q*1e3:new Date(q).getTime():0,Q=G(L),Y=S.filter(q=>q.timestamp?G(q.timestamp)>Q:!1);if(Y.length===0)return console.log(`No missed messages for session ${D}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Y.length} missed messages for session ${D}`);const ee=n.value.get(D)||[],_e=new Set(ee.map(q=>q.id).filter(Boolean)),J=Y.filter(q=>!q.id||!_e.has(q.id));if(console.log(`After deduplication: ${J.length} unique new messages`),J.length>0){const q=J.sort((ge,U)=>{const ie=G(ge.timestamp),ue=G(U.timestamp);return ie-ue}),se=n.value.get(D)||[],H=se.length>0?G(se[se.length-1].timestamp):0,oe=G(q[0].timestamp),pe=G(q[q.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:se.length,lastExisting:H,lastExistingDate:se.length>0?se[se.length-1].timestamp:"none",firstNew:oe,firstNewDate:q[0].timestamp,lastNew:pe,lastNewDate:q[q.length-1].timestamp,shouldAppend:oe>H}),oe>H){const ge=[...se,...q];n.value.set(D,ge),console.log(`âœ… Appended ${q.length} new messages (no full sort needed)`)}else{const ge=[...se,...q].sort((U,ie)=>{const ue=G(U.timestamp),Ae=G(ie.timestamp);return ue-Ae});n.value.set(D,ge),console.log(`âš ï¸ Merged and sorted ${q.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${ee.length} messages unchanged`);J.forEach(q=>{w(D,q),q.metadata?.has_tool_uses&&q.metadata.tool_uses&&q.metadata.tool_uses.forEach(se=>{y(D,se,q.timestamp)}),q.metadata?.has_tool_results&&q.metadata.tool_results&&q.metadata.tool_results.forEach(se=>{x(D,se)}),(q.type==="permission_request"||q.metadata?.has_permission_requests)&&d(D,q),q.type==="permission_response"&&h(D,{request_id:q.metadata?.request_id,decision:q.metadata?.decision,updated_input:q.metadata?.updated_input,reasoning:q.metadata?.reasoning,applied_updates:q.metadata?.applied_updates}),q.type==="system"&&(q.subtype==="init"||q.metadata?.subtype==="init")&&q.metadata?.init_data&&de().storeInitData(D,q.metadata.init_data)});const F=n.value.get(D);if(F&&F.length>0){const q=F[F.length-1];q.timestamp&&l.value.set(D,q.timestamp)}return n.value=new Map(n.value),{syncedCount:J.length,hasMore:I}}catch(O){return console.error(`Failed to sync messages for session ${D}:`,O),{syncedCount:0,hasMore:!1,error:O.message}}}const Z=de();return ve(()=>Array.from(Z.sessions.values()).map(L=>({id:L.session_id,state:L.state})),(D,L)=>{L&&D.forEach((O,S)=>{const I=L[S];if(!I||I.id!==O.id)return;const G=["active","paused","starting"].includes(I.state),Q=!["active","paused","starting"].includes(O.state);G&&Q&&z(O.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:bs(i),orphanedToolUses:bs(r),currentMessages:m,currentToolCalls:f,loadMessages:u,addMessage:g,addToolCall:k,updateToolCall:$,handleToolCall:_,handleToolUse:y,handlePermissionRequest:d,handlePermissionResponse:h,handleToolResult:x,toggleToolExpansion:C,clearMessages:N,markToolUseOrphaned:T,isToolUseOrphaned:E,getOrphanedInfo:P,clearOrphanedToolUses:z,getLastReceivedTimestamp:W,syncMessages:K,getBackendToolState:M,hasBackendDisplayMetadata:V,backendToolStates:bs(p)}}),ia=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Oe},Symbol.toStringTag,{value:"Module"}));function aa(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ht(n){return aa(n).toLocaleTimeString()}const ra={class:"message-row message-row-user"},la=["title"],ca={class:"message-content-column"},ua=["innerHTML"],da={key:0,class:"tool-results mt-2"},ma={class:"tool-results-header text-muted small mb-2"},pa={class:"d-flex align-items-start gap-2"},fa={class:"flex-grow-1"},va={class:"text-muted"},ha={key:0,class:"text-danger small"},_a={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=v(()=>Ht(e.message.timestamp)),o=v(()=>`user
${t.value}`),i=v(()=>{const m=e.message.content||"";let f=dt.parse(m);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),cs.sanitize(f)}),r=v(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=v(()=>e.message.metadata?.tool_results||[]);function p(m,f){return m?m.length<=f?m:m.substring(0,f)+"...":""}return(m,f)=>(a(),c("div",ra,[s("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,la),s("div",ca,[s("div",{class:"message-text",innerHTML:i.value},null,8,ua),r.value?(a(),c("div",da,[s("div",ma," ðŸ”§ Tool Results ("+b(l.value.length)+") ",1),(a(!0),c(le,null,ce(l.value,(u,w)=>(a(),c("div",{key:w,class:te(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",pa,[s("span",null,b(u.is_error?"âŒ":"âœ…"),1),s("div",fa,[s("small",va,"Tool: "+b(u.tool_use_id),1),u.is_error?(a(),c("div",ha,b(p(u.content,200)),1)):A("",!0)])])],2))),128))])):A("",!0)])]))}},ga=ne(_a,[["__scopeId","data-v-7665755b"]]),ba={class:"thinking-block"},ya=["aria-label"],wa={class:"text-muted ms-auto"},$a={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ka=["innerHTML"],Sa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=R(!1),o=v(()=>e.thinking?.length||0),i=v(()=>{const l=e.thinking||"",p=dt.parse(l);return cs.sanitize(p)});function r(){t.value=!t.value}return(l,p)=>(a(),c("div",ba,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[s("span",{"aria-label":t.value?"Collapse":"Expand"},b(t.value?"â–¾":"â–¸"),9,ya),p[0]||(p[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",wa,b(o.value)+" characters",1)]),t.value?(a(),c("div",$a,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ka)])):A("",!0)]))}},Ea=ne(Sa,[["__scopeId","data-v-fda2352c"]]),wn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),ks={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Ze=nt("resource",()=>{const n=R(new Map),e=R(!1),t=R(0),o=R(null),i=R(!1),r=R(new Map);function l(H){if(!H)return!1;if(H.is_image===!0||(H.mime_type||"").toLowerCase().startsWith("image/"))return!0;const pe=(H.format||"").toLowerCase();if(pe.startsWith("image/")||wn.has("."+pe))return!0;const ge=H.original_filename||H.original_name||"";if(ge){const U="."+ge.split(".").pop().toLowerCase();return wn.has(U)}return!1}function p(H){if(!H||l(H))return!1;const oe=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),pe=H.original_filename||H.original_name||"";if(pe){const U="."+pe.split(".").pop().toLowerCase();if(oe.has(U))return!0}const ge=(H.mime_type||H.format||"").toLowerCase();return!!(ge.startsWith("text/")||ge==="application/json"||ge==="application/xml")}function m(H){if(l(H))return"ðŸ–¼ï¸";if(H.original_filename){const oe="."+H.original_filename.split(".").pop().toLowerCase();return ks[oe]||ks.default}return ks.default}function f(H){return H.original_filename?"."+H.original_filename.split(".").pop().toLowerCase():""}function u(H){const oe=n.value.get(H);return oe||[]}function w(H){return n.value.get(H)?.length||0}function g(H){return w(H)>0}function k(H){return u(H).filter(l)}function $(H){return k(H).length}function y(H){return $(H)>0}const d=v(()=>{const H=de();return u(H.currentSessionId)}),h=v(()=>{const H=de();return w(H.currentSessionId)}),_=v(()=>h.value>0),x=v(()=>d.value.filter(l)),C=v(()=>x.value.length),B=v(()=>C.value>0),j=v(()=>!e.value||!o.value?null:u(o.value)[t.value]||null),M=j,V=v(()=>o.value?w(o.value):0),T=V;async function E(H){if(H){i.value=!0;try{const pe=(await _o(`/api/sessions/${H}/resources`)).resources||[];pe.sort((ge,U)=>(ge.timestamp||0)-(U.timestamp||0)),n.value.set(H,pe),n.value=new Map(n.value),console.log(`Loaded ${pe.length} resources for session ${H}`)}catch(oe){console.error(`Failed to load resources for session ${H}:`,oe),n.value.set(H,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const P=E;function z(H,oe){if(!H||!oe)return;let pe=n.value.get(H);pe||(pe=[],n.value.set(H,pe));const ge=pe.findIndex(U=>U.resource_id===oe.resource_id);ge>=0?pe[ge]=oe:pe.push(oe),pe.sort((U,ie)=>(U.timestamp||0)-(ie.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${oe.resource_id} to session ${H}`)}const N=z;function W(H,oe){return`/api/sessions/${H}/resources/${oe}`}const K=W;function Z(H,oe){return`/api/sessions/${H}/resources/${oe}/download`}function D(H,oe=0){o.value=H,t.value=Math.max(0,Math.min(oe,w(H)-1)),e.value=!0}function L(){e.value=!1}function O(){if(!o.value)return;const H=w(o.value);H!==0&&(t.value=(t.value+1)%H)}const S=O;function I(){if(!o.value)return;const H=w(o.value);H!==0&&(t.value=(t.value-1+H)%H)}const G=I;function Q(H){if(!o.value)return;const oe=w(o.value);oe!==0&&(t.value=Math.max(0,Math.min(H,oe-1)))}const Y=Q;function ee(H){n.value.delete(H),n.value=new Map(n.value),o.value===H&&L(),console.log(`Cleared resources for session ${H}`)}const _e=ee;async function J(H,oe){if(!H||!oe)return null;const pe=r.value.get(oe);if(pe&&!pe.error)return pe.content;r.value.set(oe,{content:null,loading:!0,error:null}),r.value=new Map(r.value);try{const ge=W(H,oe),U=await fetch(ge);if(!U.ok)throw new Error(`HTTP ${U.status}`);const ie=await U.text();return r.value.set(oe,{content:ie,loading:!1,error:null}),r.value=new Map(r.value),ie}catch(ge){return console.error(`Failed to fetch text content for resource ${oe}:`,ge),r.value.set(oe,{content:null,loading:!1,error:ge.message}),r.value=new Map(r.value),null}}function F(H){return r.value.get(H)||null}function q(H){if(H){const oe=n.value.get(H);oe&&(oe.forEach(pe=>r.value.delete(pe.resource_id)),r.value=new Map(r.value))}else r.value=new Map}function se(H,oe){const pe=n.value.get(H);return pe&&pe.find(ge=>ge.resource_id===oe)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:t,fullViewSessionId:o,loading:i,textContentCache:r,currentResources:d,currentResourceCount:h,currentHasResources:_,currentFullViewResource:j,fullViewTotalResources:V,currentImages:x,currentImageCount:C,currentHasImages:B,currentFullViewImage:M,fullViewTotalImages:T,imagesBySession:n,resourcesForSession:u,resourceCount:w,hasResources:g,getResourceUrl:W,getDownloadUrl:Z,isImageResource:l,isTextResource:p,getResourceIcon:m,getResourceExtension:f,getResourceById:se,getTextContent:F,imagesForSession:k,imageCount:$,hasImages:y,getImageUrl:K,loadResources:E,addResource:z,openFullView:D,closeFullView:L,nextResource:O,prevResource:I,goToResource:Q,clearResources:ee,fetchTextContent:J,clearTextCache:q,loadImages:P,addImage:N,nextImage:S,prevImage:G,goToImage:Y,clearImages:_e}}),Ca=Ze,Ta=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ca,useResourceStore:Ze},Symbol.toStringTag,{value:"Module"})),ot=nt("websocket",()=>{const n=R(null),e=R(!1),t=R(0),o=10,i=R(null),r=R(!1),l=R(0),p=5,m=R(null);let f=null;const u=R(0),w=R(null),g=R(new Map),k=R(null),$=R(!1),y=R(0),d=5,h=R(null),_=1e4,x=1e3,C=R(Date.now()),B=R(Date.now()),j=R(Date.now());let M=null,V=null,T=null;const E=v(()=>e.value&&(r.value||!m.value)?"connected":e.value?"partial":"disconnected");function P(J){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${J}`}function z(J){const F={ui:{timer:()=>M,setTimer:q=>{M=q},lastPing:C,connected:e,name:"UI"},session:{timer:()=>V,setTimer:q=>{V=q},lastPing:B,connected:r,name:"Session"},legion:{timer:()=>T,setTimer:q=>{T=q},lastPing:j,connected:$,name:"Legion"}}[J];F.timer()&&clearInterval(F.timer()),F.setTimer(setInterval(()=>{if(!F.connected.value)return;const q=Date.now()-F.lastPing.value;if(q>_){console.warn(`âš ï¸ ${F.name} WebSocket heartbeat timeout (${q}ms since last ping) - forcing close to trigger reconnection`),F.connected.value=!1;const H={ui:n,session:i,legion:k}[J];H.value&&H.value.readyState===WebSocket.OPEN&&H.value.close()}},x)),console.log(`âœ… Started heartbeat monitor for ${F.name} WebSocket`)}function N(J){const F={ui:{get:()=>M,set:q=>{M=q}},session:{get:()=>V,set:q=>{V=q}},legion:{get:()=>T,set:q=>{T=q}}}[J];F.get()&&(clearInterval(F.get()),F.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${J} WebSocket`))}function W(){if(n.value)return;const J=P("/ws/ui");console.log(`Connecting to UI WebSocket: ${J}`),n.value=new WebSocket(J),n.value.onopen=()=>{e.value=!0,t.value=0,C.value=Date.now(),z("ui"),console.log("UI WebSocket connected")},n.value.onmessage=F=>{const q=JSON.parse(F.data);G(q)},n.value.onclose=()=>{if(N("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const F=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${F}ms (attempt ${t.value})`),setTimeout(W,F)}},n.value.onerror=F=>{console.error("UI WebSocket error:",F)}}function K(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Z(J){u.value++;const F=u.value;if(console.log(`[Gen ${F}] Starting connection to session ${J}`),f&&(clearTimeout(f),f=null),await D(),u.value!==F){console.log(`[Gen ${F}] Connection cancelled (current generation: ${u.value})`);return}m.value=J,w.value=F;const q=P(`/ws/session/${J}`);console.log(`[Gen ${F}] Connecting to Session WebSocket: ${q}`),i.value=new WebSocket(q),i.value.onopen=async()=>{if(w.value!==F){console.log(`[Gen ${F}] Ignoring onopen (stale connection, current: ${w.value})`),i.value.close();return}r.value=!0,l.value=0,B.value=Date.now(),z("session"),console.log(`[Gen ${F}] Session WebSocket connected for ${J}`);const se=g.value.get(J);if(g.value.set(J,!0),se){console.log(`[Gen ${F}] Reconnection detected, syncing missed messages...`);try{const oe=await Oe().syncMessages(J);oe.syncedCount>0?console.log(`[Gen ${F}] âœ… Synced ${oe.syncedCount} missed messages`):oe.error?console.warn(`[Gen ${F}] âš ï¸ Message sync failed: ${oe.error}`):console.log(`[Gen ${F}] No missed messages to sync`),oe.hasMore&&console.warn(`[Gen ${F}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(H){console.error(`[Gen ${F}] Error during message sync:`,H)}}else console.log(`[Gen ${F}] Initial connection, no sync needed`)},i.value.onmessage=se=>{if(w.value!==F){console.log(`[Gen ${F}] Ignoring message (stale connection, current: ${w.value})`);return}const H=JSON.parse(se.data);Q(H,J)},i.value.onclose=()=>{N("session"),r.value=!1,i.value=null,console.log(`[Gen ${F}] Session WebSocket closed for ${J}`);const se=de();if(se.currentSessionId===J&&w.value===F&&l.value<p){l.value++;const H=Math.min(2e3*l.value,3e4);console.log(`[Gen ${F}] Reconnecting Session WebSocket in ${H}ms (attempt ${l.value})`),f=setTimeout(()=>{w.value===F&&se.currentSessionId===J?(f=null,Z(J)):console.log(`[Gen ${F}] Skipping reconnect (generation or session changed)`)},H)}},i.value.onerror=se=>{console.error(`[Gen ${F}] Session WebSocket error:`,se)}}function D(){return new Promise(J=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const F=m.value,q=()=>{i.value=null,r.value=!1,m.value=null,w.value=null,l.value=0,F&&g.value.delete(F),J()};if(i.value.readyState===WebSocket.CLOSED)q();else{const se=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),q()},2e3);i.value.addEventListener("close",()=>{clearTimeout(se),q()},{once:!0}),i.value.close()}}else m.value=null,w.value=null,J()})}function L(J){i.value&&r.value?(i.value.send(JSON.stringify({type:"send_message",content:J})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function O(J,F,q=!1,se=null){if(i.value&&r.value){const H={type:"permission_response",request_id:J,decision:F,apply_suggestions:q,timestamp:new Date().toISOString()};se&&(H.clarification_message=se),i.value.send(JSON.stringify(H)),console.log(`Sent permission ${F} for request ${J}`,{applySuggestions:q,clarification:se})}}function S(J,F,q){if(i.value&&r.value){const se={type:"permission_response",request_id:J,decision:F,updated_input:q,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(se)),console.log(`Sent permission ${F} with updated_input for request ${J}`,q)}}function I(){i.value&&r.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function G(J){const F=de(),q=Re();switch(J.type){case"sessions_list":J.sessions&&Array.isArray(J.sessions)&&J.sessions.forEach(se=>{F.updateSession(se.session_id,se)});break;case"state_change":J.data&&J.data.session_id&&J.data.session&&F.updateSession(J.data.session_id,J.data.session);break;case"project_updated":if(J.data&&J.data.project){const se=J.data.project;q.updateProjectLocal(se.project_id,se),F.fetchSessions()}break;case"project_deleted":J.data&&J.data.project_id&&q.projects.delete(J.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":C.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",J.type)}}function Q(J,F){const q=de();if(q.currentSessionId!==F){console.warn(`Ignoring message for session ${F} (current: ${q.currentSessionId})`);return}const se=Oe();switch(J.type){case"message":const H=J.data;if(!H||!H.type){console.warn("Received message event with invalid data:",J);break}if(H.type==="tool_call"){se.handleToolCall(F,H);break}if(H.type==="permission_request"){se.handlePermissionRequest(F,H);break}if(H.type==="permission_response"){se.handlePermissionResponse(F,H);break}H.metadata?.has_tool_uses&&H.metadata.tool_uses.forEach(oe=>{se.handleToolUse(F,oe,H.timestamp)}),H.metadata?.has_tool_results&&H.metadata.tool_results.forEach(oe=>{se.handleToolResult(F,oe)}),H.type==="system"&&(H.subtype==="init"||H.metadata?.subtype==="init")&&H.metadata?.init_data&&q.storeInitData(F,H.metadata.init_data),se.addMessage(F,H);break;case"permission_request":se.handlePermissionRequest(F,J);break;case"permission_response":se.handlePermissionResponse(F,J);break;case"tool_result":se.handleToolResult(F,J);break;case"state_change":q.updateSession(F,J.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${F}`);break;case"ping":B.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":J.resource&&(Ze().addResource(F,J.resource),console.log(`Resource registered for session ${F}:`,J.resource.resource_id));break;case"image_registered":J.image&&(Ze().addResource(F,{...J.image,resource_id:J.image.image_id}),console.log(`Image registered (legacy) for session ${F}:`,J.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",J.type)}}function Y(J){ee(),h.value=J;const F=P(`/ws/legion/${J}`);console.log(`Connecting to Legion WebSocket: ${F}`),k.value=new WebSocket(F),k.value.onopen=()=>{$.value=!0,y.value=0,j.value=Date.now(),z("legion"),console.log(`Legion WebSocket connected for ${J}`)},k.value.onmessage=q=>{const se=JSON.parse(q.data);_e(se,J)},k.value.onclose=()=>{if(N("legion"),$.value=!1,k.value=null,console.log(`Legion WebSocket closed for ${J}`),h.value===J&&y.value<d){y.value++;const q=Math.min(2e3*y.value,3e4);setTimeout(()=>Y(J),q)}},k.value.onerror=q=>{console.error("Legion WebSocket error:",q)}}function ee(){k.value&&(k.value.close(),k.value=null,$.value=!1,h.value=null)}function _e(J,F){Me(async()=>{const{useLegionStore:q}=await Promise.resolve().then(()=>Ib);return{useLegionStore:q}},void 0).then(({useLegionStore:q})=>{const se=q();switch(J.type){case"comm":J.comm&&(se.addComm(F,J.comm),console.log("Legion WebSocket: Received new comm",J.comm));break;case"minion_created":J.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",J.data),Me(async()=>{const{useSessionStore:H}=await Promise.resolve().then(()=>yn);return{useSessionStore:H}},void 0).then(({useSessionStore:H})=>{H().loadSessions()}));break;case"minion_updated":J.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",J.data),Me(async()=>{const{useSessionStore:H}=await Promise.resolve().then(()=>yn);return{useSessionStore:H}},void 0).then(({useSessionStore:H})=>{H().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${F}`);break;case"ping":j.value=Date.now(),k.value?.readyState===WebSocket.OPEN&&k.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",J.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:r,sessionRetryCount:l,legionConnected:$,legionRetryCount:y,overallStatus:E,connectUI:W,disconnectUI:K,connectSession:Z,disconnectSession:D,sendMessage:L,sendPermissionResponse:O,sendPermissionResponseWithInput:S,interruptSession:I,connectLegion:Y,disconnectLegion:ee}}),xa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ot},Symbol.toStringTag,{value:"Module"})),Aa={class:"base-tool-handler"},Ma={class:"tool-section"},Oa={class:"tool-parameters"},Da={class:"tool-code"},La={key:0,class:"tool-section"},Na={class:"tool-section-label"},ja={class:"tool-code"},Ia={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=v(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,p)=>(a(),c("div",Aa,[s("div",Ma,[p[0]||(p[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",Oa,[s("pre",Da,b(t.value),1)])]),o.value?(a(),c("div",La,[s("div",Na,b(i.value?"Error:":"Result:"),1),s("div",{class:te(["tool-result",{"tool-result-error":i.value}])},[s("pre",ja,b(r.value),1)],2)])):A("",!0)]))}},Pa=ne(Ia,[["__scopeId","data-v-1e69f57d"]]),Ra={class:"read-tool-handler"},Ba={class:"tool-section"},Wa={class:"read-file-info"},Fa={class:"file-icon"},Ha={class:"file-path"},Va={key:0,class:"read-range"},Ua={key:0,class:"tool-section"},qa={key:0,class:"tool-result tool-result-error"},za={class:"tool-code"},Ka={key:1,class:"image-preview"},Ga={class:"content-header"},Ya={class:"image-badge"},Ja={class:"image-container"},Qa=["src","alt"],Xa={key:2,class:"file-content-preview"},Za={class:"content-header"},er={class:"line-count-badge"},tr={key:0,class:"preview-note"},sr={class:"tool-code content-display"},nr={key:0,class:"more-indicator"},Ss=100,or={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>{const h=t.value;return h.split("/").pop()||h}),i=v(()=>{const h=e.toolCall.input?.offset,_=e.toolCall.input?.limit;return h!==void 0||_!==void 0}),r=v(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),l=v(()=>{const h=e.toolCall.input?.offset||0,_=e.toolCall.input?.limit;return _!==void 0?h+_:"âˆž"}),p=v(()=>{const h=t.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(h)}),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>{if(!m.value||f.value)return null;const _=e.toolCall.result?.content;if(Array.isArray(_)){for(const x of _)if(x?.type==="image"&&x?.source?.type==="base64"&&x?.source?.data)return x.source.data}return null}),w=v(()=>{if(!u.value)return"";const h=t.value.toLowerCase();return h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".gif")?"image/gif":h.endsWith(".webp")?"image/webp":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".bmp")?"image/bmp":h.endsWith(".ico")?"image/x-icon":"image/png"}),g=v(()=>{if(!m.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),k=v(()=>f.value||!g.value||u.value?[]:g.value.split(`
`)),$=v(()=>k.value.length),y=v(()=>$.value>Ss),d=v(()=>f.value||u.value?"":k.value.slice(0,Ss).join(`
`));return(h,_)=>(a(),c("div",Ra,[s("div",Ba,[s("div",Wa,[s("span",Fa,b(p.value?"ðŸ–¼ï¸":"ðŸ“„"),1),_[0]||(_[0]=s("strong",null,"Reading:",-1)),s("code",Ha,b(t.value),1),i.value?(a(),c("span",Va,"Lines "+b(r.value)+"-"+b(l.value),1)):A("",!0)])]),m.value?(a(),c("div",Ua,[f.value?(a(),c("div",qa,[s("pre",za,b(g.value),1)])):u.value?(a(),c("div",Ka,[s("div",Ga,[_[1]||(_[1]=s("span",{class:"content-label"},"Image Preview:",-1)),s("span",Ya,b(w.value),1)]),s("div",Ja,[s("img",{src:`data:${w.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,Qa)])])):(a(),c("div",Xa,[s("div",Za,[_[2]||(_[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",er,b($.value)+" lines",1),y.value?(a(),c("span",tr,"(showing first "+b(Ss)+")")):A("",!0)]),s("pre",sr,b(d.value),1),y.value?(a(),c("div",nr,"...")):A("",!0)]))])):A("",!0)]))}},ir=ne(or,[["__scopeId","data-v-29b774b1"]]),ar={class:"write-tool-handler"},rr={class:"tool-section"},lr={class:"write-file-info mb-2"},cr={class:"file-path"},ur={class:"write-content-preview"},dr={class:"content-header"},mr={class:"line-count-badge"},pr={key:0,class:"preview-note"},fr={class:"tool-code content-display"},vr={key:0,class:"more-indicator"},hr={key:0,class:"tool-section"},_r={key:0,class:"tool-result tool-result-error"},gr={class:"tool-code"},br={key:1,class:"tool-result tool-result-success"},yr={class:"success-message"},Es=100,wr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.content||""),i=v(()=>o.value.split(`
`)),r=v(()=>i.value.length),l=v(()=>r.value>Es),p=v(()=>i.value.slice(0,Es).join(`
`)),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>{if(!m.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,g)=>(a(),c("div",ar,[s("div",rr,[s("div",lr,[g[0]||(g[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=s("strong",null,"Writing:",-1)),s("code",cr,b(t.value),1)]),s("div",ur,[s("div",dr,[g[2]||(g[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",mr,b(r.value)+" lines",1),l.value?(a(),c("span",pr,"(showing first "+b(Es)+")")):A("",!0)]),s("pre",fr,b(p.value),1),l.value?(a(),c("div",vr,"...")):A("",!0)])]),m.value?(a(),c("div",hr,[f.value?(a(),c("div",_r,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",gr,b(u.value),1)])):(a(),c("div",br,[s("div",yr,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+b(r.value)+" lines written)",1)])]))])):A("",!0)]))}},$r=ne(wr,[["__scopeId","data-v-ddc24a0f"]]),kr={class:"bash-tool-handler"},Sr={class:"tool-section"},Er={class:"bash-header"},Cr={class:"bash-header-content"},Tr={key:0,class:"bash-description"},xr={key:1,class:"bash-flags"},Ar={class:"bash-command-section"},Mr={class:"bash-command-content"},Or={key:0,class:"tool-section"},Dr={key:0,class:"bash-output"},Lr={key:1,class:"bash-output-empty"},Nr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.command||""),o=v(()=>e.toolCall.input?.description||""),i=v(()=>e.toolCall.input?.timeout),r=v(()=>e.toolCall.input?.run_in_background||!1),l=v(()=>i.value||r.value),p=v(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),r.value&&g.push("background"),g.join(", ")}),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>f.value?"tool-result-error":"tool-result-success"),w=v(()=>{if(!m.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),c("div",kr,[s("div",Sr,[s("div",Er,[k[1]||(k[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",Cr,[o.value?(a(),c("div",Tr,[k[0]||(k[0]=s("strong",null,"Description:",-1)),ae(" "+b(o.value),1)])):A("",!0),l.value?(a(),c("div",xr,b(p.value),1)):A("",!0)])]),s("div",Ar,[k[2]||(k[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",Mr,b(t.value),1)])]),m.value?(a(),c("div",Or,[s("div",{class:te(["tool-result",u.value])},[k[3]||(k[3]=s("strong",null,"Output:",-1)),w.value?(a(),c("pre",Dr,b(w.value),1)):(a(),c("div",Lr,"No output"))],2)])):A("",!0)]))}},jr=ne(Nr,[["__scopeId","data-v-ab50fe73"]]),Ir={class:"todo-tool-handler"},Pr={class:"tool-section"},Rr={class:"todo-header"},Br={class:"todo-summary"},Wr={key:0,class:"todo-count todo-count-completed"},Fr={key:1,class:"todo-count todo-count-in-progress"},Hr={key:2,class:"todo-count todo-count-pending"},Vr={class:"todo-checklist"},Ur={class:"todo-checkbox"},qr={class:"todo-content"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Yr={key:1,class:"tool-result tool-result-success"},Jr={class:"success-message"},Qr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.todos||[]),o=v(()=>t.value.filter(u=>u.status==="completed").length),i=v(()=>t.value.filter(u=>u.status==="in_progress").length),r=v(()=>t.value.filter(u=>u.status==="pending").length);function l(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const p=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=v(()=>{if(!p.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,w)=>(a(),c("div",Ir,[s("div",Pr,[s("div",Rr,[w[0]||(w[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=s("strong",null,"Task List:",-1)),s("div",Br,[o.value>0?(a(),c("span",Wr,b(o.value)+" completed ",1)):A("",!0),i.value>0?(a(),c("span",Fr,b(i.value)+" in progress ",1)):A("",!0),r.value>0?(a(),c("span",Hr,b(r.value)+" pending ",1)):A("",!0)])]),s("div",Vr,[(a(!0),c(le,null,ce(t.value,(g,k)=>(a(),c("div",{key:k,class:te(["todo-item",`todo-${g.status}`])},[s("span",Ur,b(l(g.status)),1),s("span",qr,b(g.content),1)],2))),128))])]),p.value?(a(),c("div",zr,[m.value?(a(),c("div",Kr,[w[2]||(w[2]=s("strong",null,"Error:",-1)),s("pre",Gr,b(f.value),1)])):(a(),c("div",Yr,[s("div",Jr,[w[3]||(w[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+b(t.value.length)+" tasks)",1)])]))])):A("",!0)]))}},Xr=ne(Qr,[["__scopeId","data-v-bbe55ee7"]]),Zr={class:"edit-tool-handler"},el={class:"tool-section"},tl={class:"edit-file-info"},sl={class:"file-path"},nl={key:0,class:"replace-all-badge"},ol={class:"edit-diff-container"},il={class:"diff-header"},al={class:"diff-stats"},rl={class:"stat-removed"},ll={class:"stat-added"},cl={class:"unified-diff"},ul={class:"diff-scroll-container"},dl={class:"diff-marker"},ml={class:"diff-content"},pl={key:0,class:"tool-section"},fl={key:0,class:"tool-result tool-result-error"},vl={class:"tool-code"},hl={key:1,class:"tool-result tool-result-success"},_l={class:"success-message"},gl={key:0,class:"success-detail"},bl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.old_string||""),i=v(()=>e.toolCall.input?.new_string||""),r=v(()=>e.toolCall.input?.replace_all||!1),l=v(()=>{const k=Li(t.value,o.value,i.value,"","",{context:3}).split(`
`),$=[];for(let y=4;y<k.length;y++){const d=k[y];d&&(d.startsWith("-")?$.push({type:"removed",content:d.substring(1)}):d.startsWith("+")?$.push({type:"added",content:d.substring(1)}):d.startsWith(" ")?$.push({type:"context",content:d.substring(1)}):d.startsWith("@@")&&$.push({type:"hunk",content:d}))}return $}),p=v(()=>l.value.filter(g=>g.type==="removed").length),m=v(()=>l.value.filter(g=>g.type==="added").length),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),c("div",Zr,[s("div",el,[s("div",tl,[k[0]||(k[0]=s("span",{class:"file-icon"},"âœï¸",-1)),k[1]||(k[1]=s("strong",null,"Editing:",-1)),s("code",sl,b(t.value),1),r.value?(a(),c("span",nl,"Replace All")):A("",!0)]),s("div",ol,[s("div",il,[k[2]||(k[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",al,[s("span",rl,"-"+b(p.value),1),s("span",ll,"+"+b(m.value),1)])]),s("div",cl,[s("div",ul,[(a(!0),c(le,null,ce(l.value,($,y)=>(a(),c("div",{key:y,class:te(["diff-line",{"diff-line-removed":$.type==="removed","diff-line-added":$.type==="added","diff-line-context":$.type==="context","diff-line-hunk":$.type==="hunk"}])},[s("span",dl,b($.type==="removed"?"-":$.type==="added"?"+":$.type==="hunk"?"@":" "),1),s("span",ml,b($.content),1)],2))),128))])])])]),f.value?(a(),c("div",pl,[u.value?(a(),c("div",fl,[k[3]||(k[3]=s("strong",null,"Error:",-1)),s("pre",vl,b(w.value),1)])):(a(),c("div",hl,[s("div",_l,[k[4]||(k[4]=s("span",{class:"success-icon"},"âœ…",-1)),k[5]||(k[5]=s("strong",null,"File edited successfully",-1)),r.value?(a(),c("span",gl,"(all occurrences replaced)")):A("",!0)])]))])):A("",!0)]))}},yl=ne(bl,[["__scopeId","data-v-dd74055e"]]),wl={class:"search-tool-handler"},$l={class:"tool-section"},kl={class:"search-info"},Sl={class:"search-icon"},El={class:"search-pattern"},Cl={key:0,class:"search-path"},Tl={key:1,class:"search-filters"},xl={key:0,class:"filter-badge"},Al={key:1,class:"filter-badge"},Ml={key:2,class:"filter-badge"},Ol={key:0,class:"tool-section"},Dl={key:0,class:"tool-result tool-result-error"},Ll={class:"tool-code"},Nl={key:1,class:"search-results"},jl={class:"results-header"},Il={class:"results-label"},Pl={class:"results-count-badge"},Rl={class:"results-content"},Bl={class:"tool-code"},Wl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="Grep"),o=v(()=>e.toolCall.input?.pattern||"Unknown"),i=v(()=>e.toolCall.input?.path||null),r=v(()=>e.toolCall.input?.type||null),l=v(()=>e.toolCall.input?.glob||null),p=v(()=>e.toolCall.input?.["-i"]||!1),m=v(()=>r.value||l.value||p.value),f=v(()=>t.value?"ðŸ”":"ðŸ“"),u=v(()=>t.value?"Searching content":"Finding files"),w=v(()=>t.value?"Matches":"Files found"),g=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!g.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),y=v(()=>!g.value||k.value||!$.value?0:$.value.split(`
`).filter(h=>h.trim()).length);return(d,h)=>(a(),c("div",wl,[s("div",$l,[s("div",kl,[s("span",Sl,b(f.value),1),s("strong",null,b(u.value)+":",1),s("code",El,b(o.value),1),i.value?(a(),c("span",Cl,"in "+b(i.value),1)):A("",!0),m.value?(a(),c("span",Tl,[r.value?(a(),c("span",xl,"type: "+b(r.value),1)):A("",!0),l.value?(a(),c("span",Al,"glob: "+b(l.value),1)):A("",!0),p.value?(a(),c("span",Ml,"case-insensitive")):A("",!0)])):A("",!0)])]),g.value?(a(),c("div",Ol,[k.value?(a(),c("div",Dl,[h[0]||(h[0]=s("strong",null,"Error:",-1)),s("pre",Ll,b($.value),1)])):(a(),c("div",Nl,[s("div",jl,[s("span",Il,b(w.value)+":",1),s("span",Pl,b(y.value)+" "+b(y.value===1?"match":"matches"),1)]),s("div",Rl,[s("pre",Bl,b($.value),1)])]))])):A("",!0)]))}},$n=ne(Wl,[["__scopeId","data-v-0d272c39"]]),Fl={class:"web-tool-handler"},Hl={class:"tool-section"},Vl={class:"web-info"},Ul={class:"web-icon"},ql=["href"],zl={key:1,class:"web-query"},Kl={key:0,class:"web-prompt-container"},Gl={class:"prompt-content"},Yl={key:1,class:"web-domains"},Jl={class:"domains-label"},Ql={key:0,class:"tool-section"},Xl={key:0,class:"tool-result tool-result-error"},Zl={class:"tool-code"},ec={key:1,class:"web-results"},tc={class:"results-header"},sc={class:"results-label"},nc={class:"results-content"},oc={class:"tool-code"},ic={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="WebFetch"),o=v(()=>e.toolCall.input?.url||null),i=v(()=>e.toolCall.input?.query||null),r=v(()=>e.toolCall.input?.prompt||null),l=v(()=>e.toolCall.input?.allowed_domains||[]),p=v(()=>e.toolCall.input?.blocked_domains||[]),m=v(()=>l.value.length>0?l.value:p.value.length>0?p.value:[]),f=v(()=>l.value.length>0?"Allowed domains":p.value.length>0?"Blocked domains":"Domains"),u=v(()=>t.value?"ðŸŒ":"ðŸ”Ž"),w=v(()=>t.value?"Fetching URL":"Searching web"),g=v(()=>t.value?"Fetched content":"Search results"),k=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=v(()=>{if(!k.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,h)=>(a(),c("div",Fl,[s("div",Hl,[s("div",Vl,[s("span",Ul,b(u.value),1),s("strong",null,b(w.value)+":",1),o.value?(a(),c("a",{key:0,href:o.value,target:"_blank",class:"web-url"},b(o.value),9,ql)):i.value?(a(),c("code",zl,b(i.value),1)):A("",!0)]),r.value?(a(),c("div",Kl,[h[0]||(h[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Gl,b(r.value),1)])):A("",!0),m.value.length>0?(a(),c("div",Yl,[s("span",Jl,b(f.value)+":",1),(a(!0),c(le,null,ce(m.value,_=>(a(),c("span",{key:_,class:"domain-badge"},b(_),1))),128))])):A("",!0)]),k.value?(a(),c("div",Ql,[$.value?(a(),c("div",Xl,[h[1]||(h[1]=s("strong",null,"Error:",-1)),s("pre",Zl,b(y.value),1)])):(a(),c("div",ec,[s("div",tc,[s("span",sc,b(g.value)+":",1)]),s("div",nc,[s("pre",oc,b(y.value),1)])]))])):A("",!0)]))}},kn=ne(ic,[["__scopeId","data-v-62b55b55"]]),ac={class:"task-tool-handler"},rc={class:"tool-section"},lc={class:"task-header"},cc={key:0,class:"agent-type-badge"},uc={key:0,class:"task-description"},dc={class:"description-content"},mc={key:1,class:"task-prompt-container"},pc={class:"prompt-header"},fc={class:"prompt-length"},vc={class:"prompt-code"},hc={key:0,class:"tool-section"},_c={key:0,class:"tool-result tool-result-error"},gc={class:"tool-code"},bc={key:1,class:"agent-output"},yc={class:"output-header"},wc={key:0,class:"output-count-badge"},$c={class:"output-content"},kc={class:"tool-code"},Sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.description||null),o=v(()=>e.toolCall.input?.prompt||null),i=v(()=>e.toolCall.input?.subagent_type||null),r=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=v(()=>{if(!r.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),m=v(()=>p.value?p.value.split(`
`).length:0);return(f,u)=>(a(),c("div",ac,[s("div",rc,[s("div",lc,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=s("strong",null,"Agent Task:",-1)),i.value?(a(),c("span",cc,b(i.value),1)):A("",!0)]),t.value?(a(),c("div",uc,[u[2]||(u[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",dc,b(t.value),1)])):A("",!0),o.value?(a(),c("div",mc,[s("div",pc,[u[3]||(u[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",fc,b(o.value.length)+" characters",1)]),s("pre",vc,b(o.value),1)])):A("",!0)]),r.value?(a(),c("div",hc,[l.value?(a(),c("div",_c,[u[4]||(u[4]=s("strong",null,"Error:",-1)),s("pre",gc,b(p.value),1)])):(a(),c("div",bc,[s("div",yc,[u[5]||(u[5]=s("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(a(),c("span",wc,b(m.value)+" lines",1)):A("",!0)]),s("div",$c,[s("pre",kc,b(p.value),1)])]))])):A("",!0)]))}},Ec=ne(Sc,[["__scopeId","data-v-c520c244"]]),Cc={class:"task-create-tool-handler"},Tc={class:"tool-section"},xc={class:"task-details p-2"},Ac={key:0,class:"task-field mb-2"},Mc={class:"field-value subject-value"},Oc={key:1,class:"task-field mb-2"},Dc={class:"field-value description-value"},Lc={key:2,class:"task-field"},Nc={class:"field-value active-form-value"},jc={key:0,class:"tool-section mt-2"},Ic={key:0,class:"tool-result tool-result-error"},Pc={class:"tool-code"},Rc={key:1,class:"tool-result tool-result-success"},Bc={class:"result-text"},Wc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.subject||null),o=v(()=>e.toolCall.input?.description||null),i=v(()=>e.toolCall.input?.activeForm||null),r=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=v(()=>{if(!r.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,f)=>(a(),c("div",Cc,[s("div",Tc,[f[3]||(f[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",xc,[t.value?(a(),c("div",Ac,[f[0]||(f[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Mc,b(t.value),1)])):A("",!0),o.value?(a(),c("div",Oc,[f[1]||(f[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",Dc,b(o.value),1)])):A("",!0),i.value?(a(),c("div",Lc,[f[2]||(f[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Nc,b(i.value),1)])):A("",!0)])]),r.value?(a(),c("div",jc,[l.value?(a(),c("div",Ic,[f[4]||(f[4]=s("strong",null,"Error:",-1)),s("pre",Pc,b(p.value),1)])):(a(),c("div",Rc,[f[5]||(f[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Bc,b(p.value),1)]))])):A("",!0)]))}},Fc=ne(Wc,[["__scopeId","data-v-474dd444"]]),Hc={class:"task-update-tool-handler"},Vc={class:"tool-section"},Uc={class:"task-header"},qc={key:0,class:"task-id-badge"},zc={class:"task-details p-2"},Kc={key:0,class:"task-field mb-2"},Gc={key:1,class:"task-field mb-2"},Yc={class:"field-value"},Jc={key:2,class:"task-field mb-2"},Qc={class:"field-value description-value"},Xc={key:3,class:"task-field mb-2"},Zc={class:"field-value active-form-value"},eu={key:4,class:"task-field mb-2"},tu={class:"field-value"},su={key:5,class:"task-field mb-2"},nu={class:"field-value"},ou={key:6,class:"task-field"},iu={class:"field-value"},au={key:0,class:"tool-section mt-2"},ru={key:0,class:"tool-result tool-result-error"},lu={class:"tool-code"},cu={key:1,class:"tool-result tool-result-success"},uu={class:"result-text"},du={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.input?.status||null),i=v(()=>e.toolCall.input?.subject||null),r=v(()=>e.toolCall.input?.description||null),l=v(()=>e.toolCall.input?.activeForm||null),p=v(()=>e.toolCall.input?.owner||null),m=v(()=>e.toolCall.input?.addBlockedBy||[]),f=v(()=>e.toolCall.input?.addBlocks||[]),u=v(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=v(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!g.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,d)=>(a(),c("div",Hc,[s("div",Vc,[s("div",Uc,[d[0]||(d[0]=s("span",{class:"task-icon"},"âœï¸",-1)),d[1]||(d[1]=s("strong",null,"Update Task",-1)),t.value?(a(),c("span",qc,"#"+b(t.value),1)):A("",!0)]),s("div",zc,[o.value?(a(),c("div",Kc,[d[2]||(d[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:te(["field-value status-value",w.value])},b(u.value)+" "+b(o.value),3)])):A("",!0),i.value?(a(),c("div",Gc,[d[3]||(d[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Yc,b(i.value),1)])):A("",!0),r.value?(a(),c("div",Jc,[d[4]||(d[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",Qc,b(r.value),1)])):A("",!0),l.value?(a(),c("div",Xc,[d[5]||(d[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Zc,b(l.value),1)])):A("",!0),p.value?(a(),c("div",eu,[d[6]||(d[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",tu,b(p.value),1)])):A("",!0),m.value?.length?(a(),c("div",su,[d[7]||(d[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",nu,[(a(!0),c(le,null,ce(m.value,h=>(a(),c("span",{key:h,class:"badge bg-warning text-dark me-1"},"#"+b(h),1))),128))])])):A("",!0),f.value?.length?(a(),c("div",ou,[d[8]||(d[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",iu,[(a(!0),c(le,null,ce(f.value,h=>(a(),c("span",{key:h,class:"badge bg-info text-dark me-1"},"#"+b(h),1))),128))])])):A("",!0)])]),g.value?(a(),c("div",au,[k.value?(a(),c("div",ru,[d[9]||(d[9]=s("strong",null,"Error:",-1)),s("pre",lu,b($.value),1)])):(a(),c("div",cu,[d[10]||(d[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",uu,b($.value),1)]))])):A("",!0)]))}},mu=ne(du,[["__scopeId","data-v-35582330"]]),pu={class:"task-list-tool-handler"},fu={key:0,class:"tool-section"},vu={key:0,class:"tool-result tool-result-error"},hu={class:"tool-code"},_u={key:1,class:"task-list-result"},gu={key:0,class:"parsed-tasks"},bu={class:"status-icon"},yu={class:"task-id text-muted"},wu={class:"task-subject flex-grow-1"},$u={key:0,class:"task-owner badge bg-secondary"},ku={key:1,class:"raw-result p-2"},Su={class:"tool-code"},Eu={key:1,class:"tool-section"},Cu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=v(()=>{if(!t.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),r=v(()=>{if(!i.value)return[];const p=[],f=i.value.split(`
`);for(const u of f){const w=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const g=w[2].toLowerCase();p.push({id:w[1],status:g,subject:w[3].trim(),owner:null,statusIcon:l(g)})}}return p});function l(p){switch(p){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(p,m)=>(a(),c("div",pu,[m[2]||(m[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(a(),c("div",fu,[o.value?(a(),c("div",vu,[m[0]||(m[0]=s("strong",null,"Error:",-1)),s("pre",hu,b(i.value),1)])):(a(),c("div",_u,[r.value.length>0?(a(),c("div",gu,[(a(!0),c(le,null,ce(r.value,(f,u)=>(a(),c("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",bu,b(f.statusIcon),1),s("span",yu,"#"+b(f.id),1),s("span",wu,b(f.subject),1),f.owner?(a(),c("span",$u,b(f.owner),1)):A("",!0)]))),128))])):(a(),c("div",ku,[s("pre",Su,b(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),c("div",Eu,[...m[1]||(m[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):A("",!0)]))}},Tu=ne(Cu,[["__scopeId","data-v-4e79ba4b"]]),xu={class:"task-get-tool-handler"},Au={class:"tool-section"},Mu={class:"task-header"},Ou={key:0,class:"task-id-badge"},Du={key:0,class:"tool-section"},Lu={key:0,class:"tool-result tool-result-error"},Nu={class:"tool-code"},ju={key:1,class:"task-details-result p-2"},Iu={key:0,class:"parsed-task"},Pu={class:"task-field mb-2"},Ru={class:"field-value subject-value"},Bu={key:0,class:"task-field mb-2"},Wu={key:1,class:"task-field mb-2"},Fu={class:"field-value description-value"},Hu={key:2,class:"task-field mb-2"},Vu={class:"field-value"},Uu={key:3,class:"task-field mb-2"},qu={class:"field-value"},zu={key:4,class:"task-field"},Ku={class:"field-value"},Gu={key:1,class:"raw-result"},Yu={class:"tool-code"},Ju={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=v(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),l=v(()=>{if(!r.value)return null;const f=r.value;try{const g=JSON.parse(f);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const u=f.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of u){const k=g.match(/^Subject:\s*(.+)$/i);k&&(w.subject=k[1].trim());const $=g.match(/^Status:\s*(.+)$/i);$&&(w.status=$[1].trim());const y=g.match(/^Description:\s*(.+)$/i);y&&(w.description=y[1].trim());const d=g.match(/^Owner:\s*(.+)$/i);d&&(w.owner=d[1].trim())}return w.subject?w:null}),p=v(()=>{if(!l.value)return"";switch(l.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=v(()=>{if(!l.value)return"";switch(l.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,u)=>(a(),c("div",xu,[s("div",Au,[s("div",Mu,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=s("strong",null,"Get Task",-1)),t.value?(a(),c("span",Ou,"#"+b(t.value),1)):A("",!0)])]),o.value?(a(),c("div",Du,[i.value?(a(),c("div",Lu,[u[2]||(u[2]=s("strong",null,"Error:",-1)),s("pre",Nu,b(r.value),1)])):(a(),c("div",ju,[l.value?(a(),c("div",Iu,[s("div",Pu,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Ru,b(l.value.subject),1)]),l.value.status?(a(),c("div",Bu,[u[4]||(u[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:te(["field-value",m.value])},b(p.value)+" "+b(l.value.status),3)])):A("",!0),l.value.description?(a(),c("div",Wu,[u[5]||(u[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",Fu,b(l.value.description),1)])):A("",!0),l.value.owner?(a(),c("div",Hu,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",Vu,b(l.value.owner),1)])):A("",!0),l.value.blockedBy?.length?(a(),c("div",Uu,[u[7]||(u[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",qu,[(a(!0),c(le,null,ce(l.value.blockedBy,w=>(a(),c("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+b(w),1))),128))])])):A("",!0),l.value.blocks?.length?(a(),c("div",zu,[u[8]||(u[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Ku,[(a(!0),c(le,null,ce(l.value.blocks,w=>(a(),c("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+b(w),1))),128))])])):A("",!0)])):(a(),c("div",Gu,[s("pre",Yu,b(r.value),1)]))]))])):A("",!0)]))}},Qu=ne(Ju,[["__scopeId","data-v-a80d14da"]]),Xu={class:"notebook-edit-tool-handler"},Zu={class:"tool-section"},ed={class:"notebook-info"},td={class:"file-path"},sd={class:"cell-info mt-2"},nd={class:"info-row"},od={class:"info-row"},id={key:0,class:"info-row"},ad={class:"badge bg-info"},rd={key:0,class:"source-preview mt-3"},ld={class:"preview-header"},cd={class:"preview-stats"},ud={class:"source-code"},dd={key:0,class:"tool-section"},md={key:0},pd={key:1,class:"text-danger"},fd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.notebook_path||"Unknown"),o=v(()=>e.toolCall.input?.cell_id),i=v(()=>e.toolCall.input?.cell_type||"code"),r=v(()=>e.toolCall.input?.edit_mode||"replace"),l=v(()=>e.toolCall.input?.new_source||""),p=v(()=>l.value.split(`
`).length),m=v(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=r.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,g)=>(a(),c("div",Xu,[s("div",Zu,[s("div",ed,[g[0]||(g[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=s("strong",null,"Notebook:",-1)),s("code",td,b(t.value),1)]),s("div",sd,[s("div",nd,[g[2]||(g[2]=s("strong",null,"Cell ID:",-1)),s("code",null,b(o.value||"N/A"),1)]),s("div",od,[g[3]||(g[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:te(["badge",m.value])},b(i.value),3)]),r.value?(a(),c("div",id,[g[4]||(g[4]=s("strong",null,"Edit Mode:",-1)),s("span",ad,b(r.value),1)])):A("",!0)]),l.value?(a(),c("div",rd,[s("div",ld,[g[5]||(g[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",cd,b(p.value)+" lines",1)]),s("pre",ud,[s("code",null,b(l.value),1)])])):A("",!0)]),n.toolCall.result?(a(),c("div",dd,[g[6]||(g[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:te(["tool-result",f.value])},[n.toolCall.result.success!==!1?(a(),c("div",md," âœ… "+b(u.value),1)):(a(),c("div",pd," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)])):A("",!0)]))}},vd=ne(fd,[["__scopeId","data-v-c81a9bcf"]]),hd={class:"shell-tool-handler"},_d={class:"tool-section"},gd={class:"shell-info"},bd={class:"shell-icon"},yd={key:0,class:"shell-id"},wd={key:0,class:"filter-info mt-2"},$d={class:"filter-pattern"},kd={key:0,class:"tool-section"},Sd={class:"result-header mb-2"},Ed={key:0,class:"mb-2"},Cd={class:"shell-output"},Td={key:1,class:"mb-2"},xd={class:"shell-output shell-output-error"},Ad={key:0},Md={key:1,class:"text-danger"},Od={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=v(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=v(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=v(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=v(()=>e.toolCall.input?.filter);function p(k,$){if(!k)return null;const y=new RegExp(`<${$}>([\\s\\S]*?)<\\/${$}>`,"i"),d=k.match(y);return d?d[1].trim():null}const m=v(()=>{const k=e.toolCall.result;if(!k)return null;let $=k;if(k.content&&($=k.content),typeof $=="string")return{status:p($,"status"),stdout:p($,"stdout"),stderr:p($,"stderr"),exit_code:p($,"exit_code")};if(Array.isArray($)){const y=$.find(d=>d.type==="text")?.text||"";return{status:p(y,"status"),stdout:p(y,"stdout"),stderr:p(y,"stderr"),exit_code:p(y,"exit_code")}}return{status:k.status||$.status,stdout:k.stdout||k.output||$.stdout||$.output,stderr:k.stderr||$.stderr,exit_code:k.exit_code||$.exit_code}}),f=v(()=>m.value?.status),u=v(()=>{const k=f.value;return k==="running"?"bg-success":k==="completed"?"bg-secondary":k==="killed"||k==="terminated"?"bg-danger":"bg-info"}),w=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const k=m.value;if(k?.status==="running"&&!k.stdout&&!k.stderr)return"No new output since last check";if(k?.status==="failed")return`Shell failed (exit code ${k.exit_code||"unknown"})`}return"Operation completed"});return(k,$)=>(a(),c("div",hd,[s("div",_d,[s("div",gd,[s("span",bd,b(t.value),1),s("strong",null,b(o.value)+":",1),r.value?(a(),c("code",yd,"Shell "+b(r.value),1)):A("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(a(),c("div",wd,[$[0]||($[0]=s("strong",null,"Filter:",-1)),s("code",$d,b(l.value),1)])):A("",!0)]),n.toolCall.result?(a(),c("div",kd,[s("div",Sd,[s("strong",null,b(i.value)+":",1),f.value?(a(),c("span",{key:0,class:te(["badge",u.value])},b(f.value),3)):A("",!0)]),m.value?.stdout?(a(),c("div",Ed,[$[1]||($[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Cd,[s("pre",null,[s("code",null,b(m.value.stdout),1)])])])):A("",!0),m.value?.stderr?(a(),c("div",Td,[$[2]||($[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",xd,[s("pre",null,[s("code",null,b(m.value.stderr),1)])])])):A("",!0),!m.value?.stdout&&!m.value?.stderr?(a(),c("div",{key:2,class:te(["tool-result",w.value])},[n.toolCall.result.success!==!1?(a(),c("div",Ad," âœ… "+b(g.value),1)):(a(),c("div",Md," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)):A("",!0)])):A("",!0)]))}},Sn=ne(Od,[["__scopeId","data-v-86def281"]]),Dd={class:"skill-tool-handler"},Ld={key:0,class:"tool-section"},Nd={class:"d-flex align-items-center gap-2"},jd={class:"text-muted small"},Id={key:0,class:"skill-content-body"},Pd={class:"skill-content-text"},Rd={key:1,class:"tool-section mt-3"},Bd={class:"tool-result tool-result-error"},Wd={class:"tool-code"},Fd={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=de(),i=R(!1);function r(){i.value=!i.value}const l=v(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let y=null,d=null;for(let h=$+1;h<Math.min($+3,k.length);h++){const _=k[h];if(_.type!=="user")continue;const x=_.content||"";x.includes("<command-message>")&&x.includes("skill is running")?y=_:x.startsWith("Base directory for this skill:")&&(d=_)}return{running:y,content:d}}),p=v(()=>{const g=l.value.content;if(!g)return"";const k=g.content||"",$=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return k.replace($,"").trim()}),m=v(()=>p.value.length>0),f=v(()=>p.value?p.value.split(`
`).length:0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),c("div",Dd,[m.value?(a(),c("div",Ld,[s("div",{class:"skill-content-header",onClick:r},[s("div",Nd,[s("i",{class:te(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),k[0]||(k[0]=s("strong",null,"Skill Content",-1)),s("span",jd,"("+b(f.value)+" lines)",1)])]),i.value?(a(),c("div",Id,[s("pre",Pd,b(p.value),1)])):A("",!0)])):A("",!0),u.value?(a(),c("div",Rd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Bd,[s("pre",Wd,b(w.value),1)])])):A("",!0)]))}},Hd=ne(Fd,[["__scopeId","data-v-0a48ca0f"]]),Vd={class:"slashcommand-tool-handler"},Ud={key:0,class:"tool-section"},qd={class:"d-flex align-items-center gap-2"},zd=["aria-label"],Kd={class:"text-muted small"},Gd={key:0,class:"command-content-body"},Yd={class:"command-content-text"},Jd={key:1,class:"tool-section mt-3"},Qd={class:"tool-result tool-result-error"},Xd={class:"tool-code"},Zd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=de(),i=R(!1);function r(){i.value=!i.value}const l=v(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let y=null,d=null;for(let h=$+1;h<Math.min($+3,k.length);h++){const _=k[h];if(_.type!=="user")continue;const x=_.content||"";x.includes("<command-message>")&&x.includes("<command-name>")&&x.includes("<command-args>")?y=_:x.includes("ARGUMENTS:")&&(d=_)}return{running:y,content:d}}),p=v(()=>{const g=l.value.content;if(!g)return"";const k=g.content||"",$=/\nARGUMENTS:.*$/s;return k.replace($,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=v(()=>p.value.length>0),f=v(()=>p.value?p.value.split(`
`).length:0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),c("div",Vd,[m.value?(a(),c("div",Ud,[s("div",{class:"command-content-header",onClick:r},[s("div",qd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},b(i.value?"â–¾":"â–¸"),9,zd),k[0]||(k[0]=s("strong",null,"Command Content",-1)),s("span",Kd,"("+b(f.value)+" lines)",1)])]),i.value?(a(),c("div",Gd,[s("pre",Yd,b(p.value),1)])):A("",!0)])):A("",!0),u.value?(a(),c("div",Jd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Qd,[s("pre",Xd,b(w.value),1)])])):A("",!0)]))}},em=ne(Zd,[["__scopeId","data-v-15991acf"]]),tm={class:"exit-plan-mode-tool-handler"},sm={class:"tool-section"},nm={key:0,class:"plan-content mt-2"},om={class:"plan-text"},im={key:0,class:"tool-section"},am={key:0},rm={key:1,class:"text-danger"},lm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.plan),o=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,r)=>(a(),c("div",tm,[s("div",sm,[r[1]||(r[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(a(),c("div",nm,[r[0]||(r[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",om,b(t.value),1)])):A("",!0)]),n.toolCall.result?(a(),c("div",im,[r[2]||(r[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:te(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),c("div",am," âœ… Permission mode reverted to default ")):(a(),c("div",rm," â— "+b(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):A("",!0)]))}},cm=ne(lm,[["__scopeId","data-v-e2e3c781"]]),um={class:"ask-user-question-handler"},dm={key:0,class:"answers-summary"},mm={class:"answer-question text-muted small"},pm={class:"answer-value fw-medium"},fm={key:1,class:"text-muted small"},vm={key:0,class:"questions-container"},hm={class:"question-header d-flex align-items-center gap-2 mb-2"},_m={key:0,class:"badge bg-secondary"},gm={class:"question-text fw-medium"},bm={class:"options-list"},ym=["id","checked","disabled","onChange"],wm=["id","name","checked","disabled","onChange"],$m=["for"],km={class:"option-label"},Sm={key:0,class:"option-description text-muted d-block small"},Em={class:"option-item form-check other-option"},Cm=["id","checked","disabled","onChange"],Tm=["id","name","checked","disabled","onChange"],xm=["for"],Am={key:2,class:"other-input mt-2"},Mm=["onUpdate:modelValue","disabled","onInput"],Om={key:1,class:"alert alert-info mb-0"},Dm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=v(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),l=v(()=>{if(!r.value)return{};const C=o.toolCall.result;if(C?.content){if(typeof C.content=="object"&&C.content.answers)return C.content.answers;if(typeof C.content=="string")try{const j=JSON.parse(C.content);if(j.answers)return j.answers}catch{}}const B=o.toolCall.input||{};return B.answers?B.answers:{}}),p=v(()=>Object.keys(l.value).length>0),m=v(()=>(o.toolCall.input||{}).questions||[]),f=R({}),u=R({});ve(m,C=>{C.forEach((B,j)=>{j in f.value||(f.value[j]=B.multiSelect?[]:null),j in u.value||(u.value[j]="")})},{immediate:!0});function w(C,B){const j=f.value[C];return Array.isArray(j)?j.includes(B):j===B}function g(C){const B=f.value[C];return Array.isArray(B)?B.includes("__OTHER__"):B==="__OTHER__"}function k(C,B){f.value[C]=B,_()}function $(C){f.value[C]="__OTHER__",_()}function y(C,B){const j=f.value[C];if(!Array.isArray(j))f.value[C]=[B];else{const M=j.indexOf(B);M===-1?j.push(B):j.splice(M,1)}_()}function d(C){const B=f.value[C];if(!Array.isArray(B))f.value[C]=["__OTHER__"];else{const j=B.indexOf("__OTHER__");j===-1?B.push("__OTHER__"):B.splice(j,1)}_()}function h(C){_()}function _(){const C={};m.value.forEach((B,j)=>{const M=f.value[j],V=B.question;if(B.multiSelect){if(Array.isArray(M)&&M.length>0){const T=M.map(E=>E==="__OTHER__"?u.value[j]||"":E).filter(E=>E);C[V]=T.join(", ")}}else M==="__OTHER__"?C[V]=u.value[j]||"":M&&(C[V]=M)}),i("answer",C)}const x=v(()=>m.value.every((C,B)=>{const j=f.value[B];if(C.multiSelect){if(!Array.isArray(j)||j.length===0||j.includes("__OTHER__")&&!u.value[B])return!1}else if(!j||j==="__OTHER__"&&!u.value[B])return!1;return!0}));return e({allQuestionsAnswered:x,getAnswers:()=>{const C={};return m.value.forEach((B,j)=>{const M=f.value[j],V=B.question;if(B.multiSelect){if(Array.isArray(M)&&M.length>0){const T=M.map(E=>E==="__OTHER__"?u.value[j]||"":E).filter(E=>E);C[V]=T.join(", ")}}else M==="__OTHER__"?C[V]=u.value[j]||"":M&&(C[V]=M)}),C}}),(C,B)=>(a(),c("div",um,[r.value?(a(),c(le,{key:0},[p.value?(a(),c("div",dm,[(a(!0),c(le,null,ce(l.value,(j,M)=>(a(),c("div",{key:M,class:"answer-item mb-2"},[s("div",mm,b(M),1),s("div",pm,b(j),1)]))),128))])):(a(),c("div",fm," No answers recorded. "))],64)):(a(),c(le,{key:1},[m.value.length>0?(a(),c("div",vm,[(a(!0),c(le,null,ce(m.value,(j,M)=>(a(),c("div",{key:M,class:"question-block mb-3"},[s("div",hm,[j.header?(a(),c("span",_m,b(j.header),1)):A("",!0),s("span",gm,b(j.question),1)]),s("div",bm,[(a(!0),c(le,null,ce(j.options,(V,T)=>(a(),c("div",{key:T,class:te(["option-item form-check",{selected:w(M,V.label)}])},[j.multiSelect?(a(),c("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-opt${T}`,checked:w(M,V.label),disabled:n.disabled,onChange:E=>y(M,V.label)},null,40,ym)):(a(),c("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-opt${T}`,name:`question-${M}`,checked:w(M,V.label),disabled:n.disabled,onChange:E=>k(M,V.label)},null,40,wm)),s("label",{class:"form-check-label",for:`q${M}-opt${T}`},[s("span",km,b(V.label),1),V.description?(a(),c("span",Sm,b(V.description),1)):A("",!0)],8,$m)],2))),128)),s("div",Em,[j.multiSelect?(a(),c("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-other`,checked:g(M),disabled:n.disabled,onChange:V=>d(M)},null,40,Cm)):(a(),c("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-other`,name:`question-${M}`,checked:g(M),disabled:n.disabled,onChange:V=>$(M)},null,40,Tm)),s("label",{class:"form-check-label",for:`q${M}-other`},[...B[0]||(B[0]=[s("span",{class:"option-label"},"Other",-1)])],8,xm),g(M)?(a(),c("div",Am,[we(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":V=>u.value[M]=V,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:V=>h()},null,40,Mm),[[Fe,u.value[M]]])])):A("",!0)])])]))),128))])):(a(),c("div",Om," No questions to display. "))],64))]))}},En=ne(Dm,[["__scopeId","data-v-ebcee33f"]]),Lm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Nm={class:"tool-status-icon"},jm=["title"],Im={class:"d-flex align-items-center gap-2"},Pm={class:"text-muted"},Rm=["aria-label"],Bm={key:0,class:"card-body"},Wm={key:0,class:"alert alert-warning mb-3"},Fm={class:"d-flex align-items-center"},Hm={class:"mb-0 small"},Vm={key:2,class:"permission-prompt mt-3"},Um={class:"question-buttons d-flex gap-2 mt-3"},qm=["disabled"],zm=["disabled"],Km={class:"alert alert-warning mb-3"},Gm={class:"mb-0"},Ym={class:"tool-name"},Jm={key:0,class:"suggestions-section mb-3"},Qm={class:"alert alert-info mb-0"},Xm={class:"suggestion-details p-2 bg-white rounded"},Zm={class:"permission-buttons d-flex gap-2 mb-3"},ep=["disabled"],tp=["disabled"],sp=["disabled"],np={class:"guidance-section mt-3"},op=["disabled"],ip=["disabled"],ap={key:3,class:"mt-3"},rp={class:"alert alert-warning mb-0"},lp={class:"d-flex align-items-center"},cp={class:"mb-0 small"},up={key:4,class:"tool-section"},dp={class:"alert alert-danger mb-0"},mp={key:0},pp={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Oe(),o=de(),i=ot(),r=R(!1),l=R(null),p=R(""),m=R(null),f=R({}),u=v(()=>e.toolCall.name==="AskUserQuestion"),w=v(()=>!u.value||!m.value?!1:m.value.allQuestionsAnswered);function g(O){f.value=O}async function k(){if(!r.value&&m.value){r.value=!0,l.value="submit-answers";try{const O=o.currentSessionId,S=m.value.getAnswers(),I={questions:e.toolCall.input?.questions||[],answers:S};O&&(t.updateToolCall(O,e.toolCall.id,{input:I}),t.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",I)}catch(O){console.error("Failed to submit question answers:",O)}finally{r.value=!1,l.value=null}}}const $=v(()=>e.toolCall.backendStatus==="interrupted"?!0:t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),y=v(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),d=v(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),h=v(()=>{if(e.toolCall.backendStatus){const O=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[O]||O}if(d.value){const O=d.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[O]||O}return e.toolCall.status}),_={Read:ir,Write:$r,Bash:jr,TodoWrite:Xr,Edit:yl,Grep:$n,Glob:$n,WebFetch:kn,WebSearch:kn,Task:Ec,TaskCreate:Fc,TaskUpdate:mu,TaskList:Tu,TaskGet:Qu,NotebookEdit:vd,BashOutput:Sn,KillShell:Sn,SlashCommand:em,Skill:Hd,ExitPlanMode:cm,AskUserQuestion:En},x=v(()=>{const O=e.toolCall.name;return _[O]?_[O]:Pa}),C=v(()=>{const O=[];if($.value)return O.push("border-warning"),O.join(" ");switch(h.value){case"pending":O.push("border-secondary");break;case"permission_required":O.push("border-warning");break;case"executing":O.push("border-primary");break;case"completed":M.value||e.toolCall.permissionDecision==="deny"?O.push("border-danger"):O.push("border-success");break;case"error":O.push("border-danger");break}return O.join(" ")}),B=v(()=>{if($.value)return"â¹ï¸";switch(h.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":M.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),j=v(()=>Ht(e.toolCall.timestamp)),M=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),V=v(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function T(O){if(!O)return"";const S=O.replace(/\\/g,"/").split("/");return S[S.length-1]}function E(O){if(!O)return"";const S=O.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return S?S[1]:O}function P(O,S=200){return O?O.length<=S?O:O.substring(0,S)+"...":""}function z(O){if(!O)return null;if(O.content){const S=O.content.match(/exit code (\d+)/i);if(S)return parseInt(S[1])}return O.error?1:0}function N(O,S){const I=O?O.split(`
`).length:0;return{added:S?S.split(`
`).length:0,removed:I}}const W=v(()=>{const O=e.toolCall.name,S=e.toolCall.input||{},I=e.toolCall.result,G=h.value;switch(O){case"Bash":case"Shell":case"Command":{const Q=E(S.command),Y=P(Q,200);if(G==="completed"&&I){const ee=z(I);return`Bash: ${Y} (exit ${ee})`}return`Bash: ${Y}`}case"SlashCommand":{const Q=P(S.command,200);return G==="completed"&&I?`SlashCommand: ${Q}`:`SlashCommand: ${Q}`}case"Edit":{const Q=T(S.file_path);if(G==="completed"&&I&&!I.error){const{added:Y,removed:ee}=N(S.old_string,S.new_string);return Y===ee?`Edit: ${Q} (${Y} lines changed)`:`Edit: ${Q} (${Y} lines added, ${ee} removed)`}return`Edit: ${Q}`}case"Read":{const Q=T(S.file_path);if(S.offset!==void 0||S.limit!==void 0){const ee=(S.offset||0)+1,_e=S.limit?(S.offset||0)+S.limit:"âˆž";return`Read: ${Q} (lines ${ee}-${_e})`}return`Read: ${Q} (full file)`}case"Write":{const Q=T(S.file_path);if(G==="completed"&&I&&!I.error&&S.content){const Y=S.content.split(`
`).length;return`Write: ${Q} (${Y} lines written)`}return`Write: ${Q}`}case"Skill":{const Q=S.skill||"Unknown";return G==="completed"&&I?I.error?`Skill: ${Q} (error)`:`Skill: ${Q} (completed)`:`Skill: ${Q}`}case"Task":{const Q=S.subagent_type||"general",Y=S.description||"Task";return G==="completed"&&I?I.error?`Task: (${Q}) ${Y} (error)`:`Task: (${Q}) ${Y} (completed)`:`Task: (${Q}) ${Y}`}case"TodoWrite":{if(S.todos&&Array.isArray(S.todos)){const Q=S.todos.filter(_e=>_e.status==="completed").length,Y=S.todos.length,ee=S.todos.find(_e=>_e.status==="in_progress");return ee?`Todo: Working on "${ee.content}"`:`Todo: ${Q}/${Y} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const Q=S.pattern||"",Y=O==="Grep"?"Grep":"Glob";if(G==="completed"&&I&&!I.error){let ee=0;return I.content&&(ee=I.content.split(`
`).filter(J=>J.trim()).length),`${Y}: "${Q}" (${ee} results)`}return`${Y}: "${Q}"`}case"WebFetch":case"WebSearch":{const Q=S.url||S.query||"";if(O==="WebSearch"){const ee=S.query||"",_e=ee.length>50?ee.substring(0,50)+"...":ee;return G==="completed"&&I?I.error?`Web: ${_e} (error)`:`Web: ${_e} (success)`:`Web: ${_e}`}let Y="";try{Q&&(Y=new URL(Q.startsWith("http")?Q:`https://${Q}`).hostname)}catch{Y=Q.length>50?Q.substring(0,50)+"...":Q}return G==="completed"&&I?I.error?`Web: ${Y} (error)`:`Web: ${Y} (success)`:`Web: ${Y||Q}`}case"NotebookEdit":{const Q=T(S.notebook_path),Y=S.cell_number!==void 0?S.cell_number:"?",ee=S.edit_mode||"replace";return`NotebookEdit: ${Q} cell #${Y} (${ee})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${S.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${S.shell_id||"unknown"}`;case"AskUserQuestion":{const Y=(S.questions||[]).length;return G==="completed"&&I&&!I.error?`AskUserQuestion: ${Y} question(s) answered`:G==="permission_required"?`AskUserQuestion: ${Y} question(s) awaiting response`:`AskUserQuestion: ${Y} question(s)`}case"TaskCreate":{const Q=S.subject||"",Y=Q.length>40?Q.substring(0,40)+"...":Q;return G==="completed"&&I&&!I.error?`TaskCreate: "${Y}" (created)`:`TaskCreate: "${Y}"`}case"TaskUpdate":{const Q=S.taskId||"?",Y=S.status||"";return Y?`TaskUpdate: #${Q} -> ${Y}`:`TaskUpdate: #${Q}`}case"TaskList":return G==="completed"&&I&&!I.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const Q=S.taskId||"?";return G==="completed"&&I&&!I.error?`TaskGet: #${Q} (retrieved)`:`TaskGet: #${Q}`}default:return`${O}: executed`}}),K=v(()=>{const O=e.toolCall.name,S=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(O)?S.command||O:["Edit","Read","Write","NotebookEdit"].includes(O)&&(S.file_path||S.notebook_path)||O});function Z(){const O=o.currentSessionId;O&&t.toggleToolExpansion(O,e.toolCall.id)}function D(O){return O.type==="setMode"?`Set permission mode to "${O.mode}"`:O.type==="allow"?`Allow tool: ${O.tool}`:JSON.stringify(O)}async function L(O,S,I=null){if(!r.value){r.value=!0,O==="allow"?l.value=S?"approve-apply":"approve":I?l.value="deny-guidance":l.value="deny";try{const G=o.currentSessionId;if(G){const Q=S&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(G,{request_id:e.toolCall.permissionRequestId,decision:O,reasoning:O==="allow"?"User allowed permission":"User denied permission",applied_updates:Q})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,O,S,I)}catch(G){console.error("Failed to send permission response:",G)}finally{r.value=!1,l.value=null}}}return(O,S)=>(a(),c("div",{class:te(["tool-call-card card",C.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:Z},[s("div",Lm,[s("span",Nm,b(B.value),1),s("span",{class:"tool-name",title:K.value},b(W.value),9,jm)]),s("div",Im,[s("small",Pm,b(j.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},b(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Rm)])]),n.toolCall.isExpanded?(a(),c("div",Bm,[$.value?(a(),c("div",Wm,[s("div",Fm,[S[7]||(S[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[S[6]||(S[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Hm,b(y.value?.message||"Session was terminated"),1)])])])):A("",!0),u.value&&h.value==="permission_required"?A("",!0):(a(),$e(po(x.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),h.value==="permission_required"&&!$.value?(a(),c("div",Vm,[u.value?(a(),c(le,{key:0},[S[8]||(S[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),fe(En,{ref_key:"questionHandlerRef",ref:m,toolCall:n.toolCall,disabled:r.value,onAnswer:g},null,8,["toolCall","disabled"]),s("div",Um,[s("button",{class:"btn btn-primary",onClick:k,disabled:r.value||!w.value},b(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,qm),s("button",{class:"btn btn-outline-secondary",onClick:S[0]||(S[0]=I=>L("deny",!1)),disabled:r.value}," Skip Question ",8,zm)])],64)):(a(),c(le,{key:1},[s("div",Km,[S[11]||(S[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Gm,[S[9]||(S[9]=ae("Claude wants to use the ",-1)),s("code",Ym,b(n.toolCall.name),1),S[10]||(S[10]=ae(" tool.",-1))])]),V.value?(a(),c("div",Jm,[s("div",Qm,[S[12]||(S[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),S[13]||(S[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Xm,[(a(!0),c(le,null,ce(n.toolCall.suggestions,(I,G)=>(a(),c("div",{key:G,class:"suggestion-item"},[s("code",null,b(D(I)),1)]))),128))]),S[14]||(S[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):A("",!0),s("div",Zm,[V.value?(a(),c("button",{key:0,class:"btn btn-success",onClick:S[1]||(S[1]=I=>L("allow",!0)),disabled:r.value},b(r.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,ep)):A("",!0),s("button",{class:te(["btn",V.value?"btn-outline-success":"btn-success"]),onClick:S[2]||(S[2]=I=>L("allow",!1)),disabled:r.value},b(r.value&&l.value==="approve"?"â³ Submitting...":V.value?"âœ… Approve Only":"âœ… Approve"),11,tp),s("button",{class:"btn btn-danger",onClick:S[3]||(S[3]=I=>L("deny",!1)),disabled:r.value}," ðŸš« "+b(r.value&&l.value==="deny"?"Submitting...":"Deny"),9,sp)]),s("div",np,[S[15]||(S[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),S[16]||(S[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),we(s("textarea",{"onUpdate:modelValue":S[4]||(S[4]=I=>p.value=I),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:r.value},null,8,op),[[Fe,p.value]]),p.value.trim()?(a(),c("button",{key:0,class:"btn btn-warning btn-sm",onClick:S[5]||(S[5]=I=>L("deny",!1,p.value)),disabled:r.value},b(r.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,ip)):A("",!0)])],64))])):A("",!0),h.value==="permission_required"&&$.value?(a(),c("div",ap,[s("div",rp,[s("div",lp,[S[18]||(S[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[S[17]||(S[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",cp,b(y.value?.message||"Session was terminated before permission could be granted"),1)])])])])):A("",!0),n.toolCall.permissionDecision==="deny"?(a(),c("div",up,[s("div",dp,[S[19]||(S[19]=ae(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),c("span",mp," - "+b(n.toolCall.result.message),1)):A("",!0)])])):A("",!0)])):A("",!0)],2))}},fp=ne(pp,[["__scopeId","data-v-65145b27"]]);function Cn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function vp(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Tn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function hp(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=vp(t.command),i=Tn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Tn(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=Cn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",r=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Cn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const _p={key:0,class:"tool-timeline-bar"},gp={class:"timeline-container"},bp=["title","onClick","onKeydown"],yp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=Oe(),r=de(),l=v(()=>t.tools.map((k,$)=>({tool:k,originalIndex:$})).sort((k,$)=>{if(k.tool.timestamp&&$.tool.timestamp){const y=new Date(k.tool.timestamp).getTime(),d=new Date($.tool.timestamp).getTime();if(y!==d)return y-d}return k.originalIndex-$.originalIndex}).map(({tool:k})=>k));function p(k){const $=r.currentSessionId;if(!$)return k.status;const y=i.getBackendToolState($,k.id);return y?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[y.state]||y.state:i.isToolUseOrphaned($,k.id)?"orphaned":k.status}function m(k){return k.result?.error||k.status==="error"||k.permissionDecision==="deny"}function f(k){return p(k)==="executing"}function u(k){switch(p(k)){case"completed":return m(k)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w(k){const $=hp(k),y=p(k),d={completed:m(k)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[y]||y;return`${$} [${d}]`}function g(k,$){o("segment-click",{tool:k,index:$})}return(k,$)=>l.value.length>0?(a(),c("div",_p,[s("div",gp,[(a(!0),c(le,null,ce(l.value,(y,d)=>(a(),c("div",{key:y.id,class:te(["timeline-segment",u(y)]),style:{flex:1},title:w(y),onClick:h=>g(y,d),role:"button",tabindex:"0",onKeydown:[ze(h=>g(y,d),["enter"]),ze(he(h=>g(y,d),["prevent"]),["space"])]},[s("span",{class:te(["segment-inner",{"executing-pulse":f(y)}])},null,2)],42,bp))),128))])])):A("",!0)}},wp=ne(yp,[["__scopeId","data-v-4a85fba6"]]),$p={class:"tool-footer-container"},kp={class:"tool-cards-list"},Sp={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Oe(),o=de(),i=v(()=>e.tools.map((l,p)=>({tool:l,originalIndex:p})).sort((l,p)=>{if(l.tool.timestamp&&p.tool.timestamp){const m=new Date(l.tool.timestamp).getTime(),f=new Date(p.tool.timestamp).getTime();if(m!==f)return m-f}return l.originalIndex-p.originalIndex}).map(({tool:l})=>l));async function r({tool:l}){const p=o.currentSessionId;if(!p)return;t.toggleToolExpansion(p,l.id),await kt();const m=document.querySelector(`[data-tool-id="${l.id}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"nearest"})}return(l,p)=>(a(),c("div",$p,[fe(wp,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),s("div",kp,[(a(!0),c(le,null,ce(i.value,m=>(a(),$e(fp,{key:m.id,toolCall:m,"data-tool-id":m.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Ep=ne(Sp,[["__scopeId","data-v-527d59ae"]]),Cp={class:"message-row message-row-assistant"},Tp=["title"],xp={class:"message-content-column"},Ap={key:0,class:"thinking-block mb-2"},Mp=["innerHTML"],Op={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Oe(),o=de();dt.setOptions({breaks:!0,gfm:!0});const i=v(()=>Ht(e.message.timestamp)),r=v(()=>e.message.metadata?.model||null),l=v(()=>{const $=i.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${$}`}),p=v(()=>{const $=e.message.content||"";return $.trim().length>0&&$!=="Assistant response"}),m=v(()=>{const $=e.message.content||"";let y=dt.parse($);return y=y.replace(/\n</g,"<"),y=y.replace(/\n+$/,""),cs.sanitize(y)}),f=v(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=v(()=>e.message.metadata?.thinking_content||""),w=v(()=>{const $=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,y=e.attachedTools&&e.attachedTools.length>0;return $||y}),g=v(()=>{const $=e.message.metadata?.tool_uses||[],y=e.attachedTools||[],d=[...$],h=new Set($.map(_=>_.id));for(const _ of y)h.has(_.id)||d.push(_);return d}),k=v(()=>{const $=o.currentSessionId;if(!$)return[];const y=t.toolCallsBySession.get($)||[];return g.value.map(d=>{const h=y.find(_=>_.id===d.id);return h||{id:d.id,name:d.name,input:d.input,status:"pending",result:null,timestamp:d.timestamp||e.message.timestamp,isExpanded:!0}})});return($,y)=>(a(),c("div",Cp,[s("div",{class:"message-speaker",title:l.value},[...y[0]||(y[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Tp),s("div",xp,[f.value?(a(),c("div",Ap,[fe(Ea,{thinking:u.value},null,8,["thinking"])])):A("",!0),p.value?(a(),c("div",{key:1,class:"message-text",innerHTML:m.value},null,8,Mp)):A("",!0),w.value?(a(),$e(Ep,{key:2,tools:k.value},null,8,["tools"])):A("",!0)])]))}},Dp=ne(Op,[["__scopeId","data-v-2e32f6ef"]]),Lp={key:0,class:"message-row message-row-compaction"},Np=["title"],jp={class:"message-content-column"},Ip={class:"compaction-status-content"},Pp={class:"text-muted ms-auto"},Rp={key:1,class:"message-row message-row-system"},Bp=["title"],Wp={class:"message-content-column"},Fp={class:"system-text"},Hp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>Ht(e.message.timestamp)),o=v(()=>`system
${t.value}`),i=v(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,l)=>i.value?(a(),c("div",Lp,[s("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Np),s("div",jp,[s("div",Ip,[l[1]||(l[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Pp,b(t.value),1)])])])):(a(),c("div",Rp,[s("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Bp),s("div",Wp,[s("span",Fp,b(n.message.content),1)])]))}},xn=ne(Hp,[["__scopeId","data-v-a078178f"]]),Vp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>{switch(e.message.type){case"user":return ga;case"assistant":return Dp;case"system":return xn;default:return xn}});return(o,i)=>(a(),$e(po(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Up=ne(Vp,[["__scopeId","data-v-11dff525"]]);var Ee="top",De="bottom",Le="right",Ce="left",us="auto",Dt=[Ee,De,Le,Ce],mt="start",Et="end",go="clippingParents",Ys="viewport",bt="popper",bo="reference",Hs=Dt.reduce(function(n,e){return n.concat([e+"-"+mt,e+"-"+Et])},[]),Js=[].concat(Dt,[us]).reduce(function(n,e){return n.concat([e,e+"-"+mt,e+"-"+Et])},[]),yo="beforeRead",wo="read",$o="afterRead",ko="beforeMain",So="main",Eo="afterMain",Co="beforeWrite",To="write",xo="afterWrite",Ao=[yo,wo,$o,ko,So,Eo,Co,To,xo];function qe(n){return n?(n.nodeName||"").toLowerCase():null}function Ne(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function pt(n){var e=Ne(n).Element;return n instanceof e||n instanceof Element}function je(n){var e=Ne(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Qs(n){if(typeof ShadowRoot>"u")return!1;var e=Ne(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function qp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];!je(r)||!qe(r)||(Object.assign(r.style,o),Object.keys(i).forEach(function(l){var p=i[l];p===!1?r.removeAttribute(l):r.setAttribute(l,p===!0?"":p)}))})}function zp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],r=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),p=l.reduce(function(m,f){return m[f]="",m},{});!je(i)||!qe(i)||(Object.assign(i.style,p),Object.keys(r).forEach(function(m){i.removeAttribute(m)}))})}}const Mo={name:"applyStyles",enabled:!0,phase:"write",fn:qp,effect:zp,requires:["computeStyles"]};function Ve(n){return n.split("-")[0]}var ut=Math.max,is=Math.min,Ct=Math.round;function Vs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Oo(){return!/^((?!chrome|android).)*safari/i.test(Vs())}function Tt(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,r=1;e&&je(n)&&(i=n.offsetWidth>0&&Ct(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&Ct(o.height)/n.offsetHeight||1);var l=pt(n)?Ne(n):window,p=l.visualViewport,m=!Oo()&&t,f=(o.left+(m&&p?p.offsetLeft:0))/i,u=(o.top+(m&&p?p.offsetTop:0))/r,w=o.width/i,g=o.height/r;return{width:w,height:g,top:u,right:f+w,bottom:u+g,left:f,x:f,y:u}}function Xs(n){var e=Tt(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function Do(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Qs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Je(n){return Ne(n).getComputedStyle(n)}function Kp(n){return["table","td","th"].indexOf(qe(n))>=0}function it(n){return((pt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ds(n){return qe(n)==="html"?n:n.assignedSlot||n.parentNode||(Qs(n)?n.host:null)||it(n)}function An(n){return!je(n)||Je(n).position==="fixed"?null:n.offsetParent}function Gp(n){var e=/firefox/i.test(Vs()),t=/Trident/i.test(Vs());if(t&&je(n)){var o=Je(n);if(o.position==="fixed")return null}var i=ds(n);for(Qs(i)&&(i=i.host);je(i)&&["html","body"].indexOf(qe(i))<0;){var r=Je(i);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return i;i=i.parentNode}return null}function Vt(n){for(var e=Ne(n),t=An(n);t&&Kp(t)&&Je(t).position==="static";)t=An(t);return t&&(qe(t)==="html"||qe(t)==="body"&&Je(t).position==="static")?e:t||Gp(n)||e}function Zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Bt(n,e,t){return ut(n,is(e,t))}function Yp(n,e,t){var o=Bt(n,e,t);return o>t?t:o}function Lo(){return{top:0,right:0,bottom:0,left:0}}function No(n){return Object.assign({},Lo(),n)}function jo(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Jp=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,No(typeof e!="number"?e:jo(e,Dt))};function Qp(n){var e,t=n.state,o=n.name,i=n.options,r=t.elements.arrow,l=t.modifiersData.popperOffsets,p=Ve(t.placement),m=Zs(p),f=[Ce,Le].indexOf(p)>=0,u=f?"height":"width";if(!(!r||!l)){var w=Jp(i.padding,t),g=Xs(r),k=m==="y"?Ee:Ce,$=m==="y"?De:Le,y=t.rects.reference[u]+t.rects.reference[m]-l[m]-t.rects.popper[u],d=l[m]-t.rects.reference[m],h=Vt(r),_=h?m==="y"?h.clientHeight||0:h.clientWidth||0:0,x=y/2-d/2,C=w[k],B=_-g[u]-w[$],j=_/2-g[u]/2+x,M=Bt(C,j,B),V=m;t.modifiersData[o]=(e={},e[V]=M,e.centerOffset=M-j,e)}}function Xp(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Do(e.elements.popper,i)&&(e.elements.arrow=i))}const Io={name:"arrow",enabled:!0,phase:"main",fn:Qp,effect:Xp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function xt(n){return n.split("-")[1]}var Zp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ef(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Ct(t*i)/i||0,y:Ct(o*i)/i||0}}function Mn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,r=n.variation,l=n.offsets,p=n.position,m=n.gpuAcceleration,f=n.adaptive,u=n.roundOffsets,w=n.isFixed,g=l.x,k=g===void 0?0:g,$=l.y,y=$===void 0?0:$,d=typeof u=="function"?u({x:k,y}):{x:k,y};k=d.x,y=d.y;var h=l.hasOwnProperty("x"),_=l.hasOwnProperty("y"),x=Ce,C=Ee,B=window;if(f){var j=Vt(t),M="clientHeight",V="clientWidth";if(j===Ne(t)&&(j=it(t),Je(j).position!=="static"&&p==="absolute"&&(M="scrollHeight",V="scrollWidth")),j=j,i===Ee||(i===Ce||i===Le)&&r===Et){C=De;var T=w&&j===B&&B.visualViewport?B.visualViewport.height:j[M];y-=T-o.height,y*=m?1:-1}if(i===Ce||(i===Ee||i===De)&&r===Et){x=Le;var E=w&&j===B&&B.visualViewport?B.visualViewport.width:j[V];k-=E-o.width,k*=m?1:-1}}var P=Object.assign({position:p},f&&Zp),z=u===!0?ef({x:k,y},Ne(t)):{x:k,y};if(k=z.x,y=z.y,m){var N;return Object.assign({},P,(N={},N[C]=_?"0":"",N[x]=h?"0":"",N.transform=(B.devicePixelRatio||1)<=1?"translate("+k+"px, "+y+"px)":"translate3d("+k+"px, "+y+"px, 0)",N))}return Object.assign({},P,(e={},e[C]=_?y+"px":"",e[x]=h?k+"px":"",e.transform="",e))}function tf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,r=t.adaptive,l=r===void 0?!0:r,p=t.roundOffsets,m=p===void 0?!0:p,f={placement:Ve(e.placement),variation:xt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Mn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Mn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Po={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:tf,data:{}};var Yt={passive:!0};function sf(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,r=i===void 0?!0:i,l=o.resize,p=l===void 0?!0:l,m=Ne(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&f.forEach(function(u){u.addEventListener("scroll",t.update,Yt)}),p&&m.addEventListener("resize",t.update,Yt),function(){r&&f.forEach(function(u){u.removeEventListener("scroll",t.update,Yt)}),p&&m.removeEventListener("resize",t.update,Yt)}}const Ro={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sf,data:{}};var nf={left:"right",right:"left",bottom:"top",top:"bottom"};function ss(n){return n.replace(/left|right|bottom|top/g,function(e){return nf[e]})}var of={start:"end",end:"start"};function On(n){return n.replace(/start|end/g,function(e){return of[e]})}function en(n){var e=Ne(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function tn(n){return Tt(it(n)).left+en(n).scrollLeft}function af(n,e){var t=Ne(n),o=it(n),i=t.visualViewport,r=o.clientWidth,l=o.clientHeight,p=0,m=0;if(i){r=i.width,l=i.height;var f=Oo();(f||!f&&e==="fixed")&&(p=i.offsetLeft,m=i.offsetTop)}return{width:r,height:l,x:p+tn(n),y:m}}function rf(n){var e,t=it(n),o=en(n),i=(e=n.ownerDocument)==null?void 0:e.body,r=ut(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=ut(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),p=-o.scrollLeft+tn(n),m=-o.scrollTop;return Je(i||t).direction==="rtl"&&(p+=ut(t.clientWidth,i?i.clientWidth:0)-r),{width:r,height:l,x:p,y:m}}function sn(n){var e=Je(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Bo(n){return["html","body","#document"].indexOf(qe(n))>=0?n.ownerDocument.body:je(n)&&sn(n)?n:Bo(ds(n))}function Wt(n,e){var t;e===void 0&&(e=[]);var o=Bo(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),r=Ne(o),l=i?[r].concat(r.visualViewport||[],sn(o)?o:[]):o,p=e.concat(l);return i?p:p.concat(Wt(ds(l)))}function Us(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function lf(n,e){var t=Tt(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Dn(n,e,t){return e===Ys?Us(af(n,t)):pt(e)?lf(e,t):Us(rf(it(n)))}function cf(n){var e=Wt(ds(n)),t=["absolute","fixed"].indexOf(Je(n).position)>=0,o=t&&je(n)?Vt(n):n;return pt(o)?e.filter(function(i){return pt(i)&&Do(i,o)&&qe(i)!=="body"}):[]}function uf(n,e,t,o){var i=e==="clippingParents"?cf(n):[].concat(e),r=[].concat(i,[t]),l=r[0],p=r.reduce(function(m,f){var u=Dn(n,f,o);return m.top=ut(u.top,m.top),m.right=is(u.right,m.right),m.bottom=is(u.bottom,m.bottom),m.left=ut(u.left,m.left),m},Dn(n,l,o));return p.width=p.right-p.left,p.height=p.bottom-p.top,p.x=p.left,p.y=p.top,p}function Wo(n){var e=n.reference,t=n.element,o=n.placement,i=o?Ve(o):null,r=o?xt(o):null,l=e.x+e.width/2-t.width/2,p=e.y+e.height/2-t.height/2,m;switch(i){case Ee:m={x:l,y:e.y-t.height};break;case De:m={x:l,y:e.y+e.height};break;case Le:m={x:e.x+e.width,y:p};break;case Ce:m={x:e.x-t.width,y:p};break;default:m={x:e.x,y:e.y}}var f=i?Zs(i):null;if(f!=null){var u=f==="y"?"height":"width";switch(r){case mt:m[f]=m[f]-(e[u]/2-t[u]/2);break;case Et:m[f]=m[f]+(e[u]/2-t[u]/2);break}}return m}function At(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,r=t.strategy,l=r===void 0?n.strategy:r,p=t.boundary,m=p===void 0?go:p,f=t.rootBoundary,u=f===void 0?Ys:f,w=t.elementContext,g=w===void 0?bt:w,k=t.altBoundary,$=k===void 0?!1:k,y=t.padding,d=y===void 0?0:y,h=No(typeof d!="number"?d:jo(d,Dt)),_=g===bt?bo:bt,x=n.rects.popper,C=n.elements[$?_:g],B=uf(pt(C)?C:C.contextElement||it(n.elements.popper),m,u,l),j=Tt(n.elements.reference),M=Wo({reference:j,element:x,placement:i}),V=Us(Object.assign({},x,M)),T=g===bt?V:j,E={top:B.top-T.top+h.top,bottom:T.bottom-B.bottom+h.bottom,left:B.left-T.left+h.left,right:T.right-B.right+h.right},P=n.modifiersData.offset;if(g===bt&&P){var z=P[i];Object.keys(E).forEach(function(N){var W=[Le,De].indexOf(N)>=0?1:-1,K=[Ee,De].indexOf(N)>=0?"y":"x";E[N]+=z[K]*W})}return E}function df(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,r=t.rootBoundary,l=t.padding,p=t.flipVariations,m=t.allowedAutoPlacements,f=m===void 0?Js:m,u=xt(o),w=u?p?Hs:Hs.filter(function($){return xt($)===u}):Dt,g=w.filter(function($){return f.indexOf($)>=0});g.length===0&&(g=w);var k=g.reduce(function($,y){return $[y]=At(n,{placement:y,boundary:i,rootBoundary:r,padding:l})[Ve(y)],$},{});return Object.keys(k).sort(function($,y){return k[$]-k[y]})}function mf(n){if(Ve(n)===us)return[];var e=ss(n);return[On(n),e,On(e)]}function pf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,r=i===void 0?!0:i,l=t.altAxis,p=l===void 0?!0:l,m=t.fallbackPlacements,f=t.padding,u=t.boundary,w=t.rootBoundary,g=t.altBoundary,k=t.flipVariations,$=k===void 0?!0:k,y=t.allowedAutoPlacements,d=e.options.placement,h=Ve(d),_=h===d,x=m||(_||!$?[ss(d)]:mf(d)),C=[d].concat(x).reduce(function(Y,ee){return Y.concat(Ve(ee)===us?df(e,{placement:ee,boundary:u,rootBoundary:w,padding:f,flipVariations:$,allowedAutoPlacements:y}):ee)},[]),B=e.rects.reference,j=e.rects.popper,M=new Map,V=!0,T=C[0],E=0;E<C.length;E++){var P=C[E],z=Ve(P),N=xt(P)===mt,W=[Ee,De].indexOf(z)>=0,K=W?"width":"height",Z=At(e,{placement:P,boundary:u,rootBoundary:w,altBoundary:g,padding:f}),D=W?N?Le:Ce:N?De:Ee;B[K]>j[K]&&(D=ss(D));var L=ss(D),O=[];if(r&&O.push(Z[z]<=0),p&&O.push(Z[D]<=0,Z[L]<=0),O.every(function(Y){return Y})){T=P,V=!1;break}M.set(P,O)}if(V)for(var S=$?3:1,I=function(ee){var _e=C.find(function(J){var F=M.get(J);if(F)return F.slice(0,ee).every(function(q){return q})});if(_e)return T=_e,"break"},G=S;G>0;G--){var Q=I(G);if(Q==="break")break}e.placement!==T&&(e.modifiersData[o]._skip=!0,e.placement=T,e.reset=!0)}}const Fo={name:"flip",enabled:!0,phase:"main",fn:pf,requiresIfExists:["offset"],data:{_skip:!1}};function Ln(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Nn(n){return[Ee,Le,De,Ce].some(function(e){return n[e]>=0})}function ff(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,r=e.modifiersData.preventOverflow,l=At(e,{elementContext:"reference"}),p=At(e,{altBoundary:!0}),m=Ln(l,o),f=Ln(p,i,r),u=Nn(m),w=Nn(f);e.modifiersData[t]={referenceClippingOffsets:m,popperEscapeOffsets:f,isReferenceHidden:u,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":w})}const Ho={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ff};function vf(n,e,t){var o=Ve(n),i=[Ce,Ee].indexOf(o)>=0?-1:1,r=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,l=r[0],p=r[1];return l=l||0,p=(p||0)*i,[Ce,Le].indexOf(o)>=0?{x:p,y:l}:{x:l,y:p}}function hf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,r=i===void 0?[0,0]:i,l=Js.reduce(function(u,w){return u[w]=vf(w,e.rects,r),u},{}),p=l[e.placement],m=p.x,f=p.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=l}const Vo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:hf};function _f(n){var e=n.state,t=n.name;e.modifiersData[t]=Wo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Uo={name:"popperOffsets",enabled:!0,phase:"read",fn:_f,data:{}};function gf(n){return n==="x"?"y":"x"}function bf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,r=i===void 0?!0:i,l=t.altAxis,p=l===void 0?!1:l,m=t.boundary,f=t.rootBoundary,u=t.altBoundary,w=t.padding,g=t.tether,k=g===void 0?!0:g,$=t.tetherOffset,y=$===void 0?0:$,d=At(e,{boundary:m,rootBoundary:f,padding:w,altBoundary:u}),h=Ve(e.placement),_=xt(e.placement),x=!_,C=Zs(h),B=gf(C),j=e.modifiersData.popperOffsets,M=e.rects.reference,V=e.rects.popper,T=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,E=typeof T=="number"?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),P=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,z={x:0,y:0};if(j){if(r){var N,W=C==="y"?Ee:Ce,K=C==="y"?De:Le,Z=C==="y"?"height":"width",D=j[C],L=D+d[W],O=D-d[K],S=k?-V[Z]/2:0,I=_===mt?M[Z]:V[Z],G=_===mt?-V[Z]:-M[Z],Q=e.elements.arrow,Y=k&&Q?Xs(Q):{width:0,height:0},ee=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Lo(),_e=ee[W],J=ee[K],F=Bt(0,M[Z],Y[Z]),q=x?M[Z]/2-S-F-_e-E.mainAxis:I-F-_e-E.mainAxis,se=x?-M[Z]/2+S+F+J+E.mainAxis:G+F+J+E.mainAxis,H=e.elements.arrow&&Vt(e.elements.arrow),oe=H?C==="y"?H.clientTop||0:H.clientLeft||0:0,pe=(N=P?.[C])!=null?N:0,ge=D+q-pe-oe,U=D+se-pe,ie=Bt(k?is(L,ge):L,D,k?ut(O,U):O);j[C]=ie,z[C]=ie-D}if(p){var ue,Ae=C==="x"?Ee:Ce,We=C==="x"?De:Le,Se=j[B],Gt=B==="y"?"height":"width",dn=Se+d[Ae],mn=Se-d[We],gs=[Ee,Ce].indexOf(h)!==-1,pn=(ue=P?.[B])!=null?ue:0,fn=gs?dn:Se-M[Gt]-V[Gt]-pn+E.altAxis,vn=gs?Se+M[Gt]+V[Gt]-pn-E.altAxis:mn,hn=k&&gs?Yp(fn,Se,vn):Bt(k?fn:dn,Se,k?vn:mn);j[B]=hn,z[B]=hn-Se}e.modifiersData[o]=z}}const qo={name:"preventOverflow",enabled:!0,phase:"main",fn:bf,requiresIfExists:["offset"]};function yf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function wf(n){return n===Ne(n)||!je(n)?en(n):yf(n)}function $f(n){var e=n.getBoundingClientRect(),t=Ct(e.width)/n.offsetWidth||1,o=Ct(e.height)/n.offsetHeight||1;return t!==1||o!==1}function kf(n,e,t){t===void 0&&(t=!1);var o=je(e),i=je(e)&&$f(e),r=it(e),l=Tt(n,i,t),p={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!t)&&((qe(e)!=="body"||sn(r))&&(p=wf(e)),je(e)?(m=Tt(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):r&&(m.x=tn(r))),{x:l.left+p.scrollLeft-m.x,y:l.top+p.scrollTop-m.y,width:l.width,height:l.height}}function Sf(n){var e=new Map,t=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function i(r){t.add(r.name);var l=[].concat(r.requires||[],r.requiresIfExists||[]);l.forEach(function(p){if(!t.has(p)){var m=e.get(p);m&&i(m)}}),o.push(r)}return n.forEach(function(r){t.has(r.name)||i(r)}),o}function Ef(n){var e=Sf(n);return Ao.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Cf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Tf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var jn={placement:"bottom",modifiers:[],strategy:"absolute"};function In(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function zo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,r=i===void 0?jn:i;return function(p,m,f){f===void 0&&(f=r);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},jn,r),modifiersData:{},elements:{reference:p,popper:m},attributes:{},styles:{}},w=[],g=!1,k={state:u,setOptions:function(h){var _=typeof h=="function"?h(u.options):h;y(),u.options=Object.assign({},r,u.options,_),u.scrollParents={reference:pt(p)?Wt(p):p.contextElement?Wt(p.contextElement):[],popper:Wt(m)};var x=Ef(Tf([].concat(o,u.options.modifiers)));return u.orderedModifiers=x.filter(function(C){return C.enabled}),$(),k.update()},forceUpdate:function(){if(!g){var h=u.elements,_=h.reference,x=h.popper;if(In(_,x)){u.rects={reference:kf(_,Vt(x),u.options.strategy==="fixed"),popper:Xs(x)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(E){return u.modifiersData[E.name]=Object.assign({},E.data)});for(var C=0;C<u.orderedModifiers.length;C++){if(u.reset===!0){u.reset=!1,C=-1;continue}var B=u.orderedModifiers[C],j=B.fn,M=B.options,V=M===void 0?{}:M,T=B.name;typeof j=="function"&&(u=j({state:u,options:V,name:T,instance:k})||u)}}}},update:Cf(function(){return new Promise(function(d){k.forceUpdate(),d(u)})}),destroy:function(){y(),g=!0}};if(!In(p,m))return k;k.setOptions(f).then(function(d){!g&&f.onFirstUpdate&&f.onFirstUpdate(d)});function $(){u.orderedModifiers.forEach(function(d){var h=d.name,_=d.options,x=_===void 0?{}:_,C=d.effect;if(typeof C=="function"){var B=C({state:u,name:h,instance:k,options:x}),j=function(){};w.push(B||j)}})}function y(){w.forEach(function(d){return d()}),w=[]}return k}}var xf=[Ro,Uo,Po,Mo,Vo,Fo,qo,Io,Ho],nn=zo({defaultModifiers:xf});const Ko=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Eo,afterRead:$o,afterWrite:xo,applyStyles:Mo,arrow:Io,auto:us,basePlacements:Dt,beforeMain:ko,beforeRead:yo,beforeWrite:Co,bottom:De,clippingParents:go,computeStyles:Po,createPopper:nn,detectOverflow:At,end:Et,eventListeners:Ro,flip:Fo,hide:Ho,left:Ce,main:So,modifierPhases:Ao,offset:Vo,placements:Js,popper:bt,popperGenerator:zo,popperOffsets:Uo,preventOverflow:qo,read:wo,reference:bo,right:Le,start:mt,top:Ee,variationPlacements:Hs,viewport:Ys,write:To},Symbol.toStringTag,{value:"Module"}));const Xe=new Map,Cs={set(n,e,t){Xe.has(n)||Xe.set(n,new Map);const o=Xe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Xe.has(n)&&Xe.get(n).get(e)||null},remove(n,e){if(!Xe.has(n))return;const t=Xe.get(n);t.delete(e),t.size===0&&Xe.delete(n)}},Af=1e6,Mf=1e3,qs="transitionend",Go=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Of=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Df=n=>{do n+=Math.floor(Math.random()*Af);while(document.getElementById(n));return n},Lf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Mf)},Yo=n=>{n.dispatchEvent(new Event(qs))},Ge=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),et=n=>Ge(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Go(n)):null,Lt=n=>{if(!Ge(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},tt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Jo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Jo(n.parentNode):null},as=()=>{},Ut=n=>{n.offsetHeight},Qo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ts=[],Nf=n=>{document.readyState==="loading"?(Ts.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ts)e()}),Ts.push(n)):n()},Ie=()=>document.documentElement.dir==="rtl",Be=n=>{Nf(()=>{const e=Qo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},xe=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Xo=(n,e,t=!0)=>{if(!t){xe(n);return}const i=Lf(e)+5;let r=!1;const l=({target:p})=>{p===e&&(r=!0,e.removeEventListener(qs,l),xe(n))};e.addEventListener(qs,l),setTimeout(()=>{r||Yo(e)},i)},on=(n,e,t,o)=>{const i=n.length;let r=n.indexOf(e);return r===-1?!t&&o?n[i-1]:n[0]:(r+=t?1:-1,o&&(r=(r+i)%i),n[Math.max(0,Math.min(r,i-1))])},jf=/[^.]*(?=\..*)\.|.*/,If=/\..*/,Pf=/::\d+$/,xs={};let Pn=1;const Zo={mouseenter:"mouseover",mouseleave:"mouseout"},Rf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ei(n,e){return e&&`${e}::${Pn++}`||n.uidEvent||Pn++}function ti(n){const e=ei(n);return n.uidEvent=e,xs[e]=xs[e]||{},xs[e]}function Bf(n,e){return function t(o){return an(o,{delegateTarget:n}),t.oneOff&&X.off(n,o.type,e),e.apply(n,[o])}}function Wf(n,e,t){return function o(i){const r=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const p of r)if(p===l)return an(i,{delegateTarget:l}),o.oneOff&&X.off(n,i.type,e,t),t.apply(l,[i])}}function si(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function ni(n,e,t){const o=typeof e=="string",i=o?t:e||t;let r=oi(n);return Rf.has(r)||(r=n),[o,i,r]}function Rn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[r,l,p]=ni(e,t,o);e in Zo&&(l=($=>function(y){if(!y.relatedTarget||y.relatedTarget!==y.delegateTarget&&!y.delegateTarget.contains(y.relatedTarget))return $.call(this,y)})(l));const m=ti(n),f=m[p]||(m[p]={}),u=si(f,l,r?t:null);if(u){u.oneOff=u.oneOff&&i;return}const w=ei(l,e.replace(jf,"")),g=r?Wf(n,t,l):Bf(n,l);g.delegationSelector=r?t:null,g.callable=l,g.oneOff=i,g.uidEvent=w,f[w]=g,n.addEventListener(p,g,r)}function zs(n,e,t,o,i){const r=si(e[t],o,i);r&&(n.removeEventListener(t,r,!!i),delete e[t][r.uidEvent])}function Ff(n,e,t,o){const i=e[t]||{};for(const[r,l]of Object.entries(i))r.includes(o)&&zs(n,e,t,l.callable,l.delegationSelector)}function oi(n){return n=n.replace(If,""),Zo[n]||n}const X={on(n,e,t,o){Rn(n,e,t,o,!1)},one(n,e,t,o){Rn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,r,l]=ni(e,t,o),p=l!==e,m=ti(n),f=m[l]||{},u=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(f).length)return;zs(n,m,l,r,i?t:null);return}if(u)for(const w of Object.keys(m))Ff(n,m,w,e.slice(1));for(const[w,g]of Object.entries(f)){const k=w.replace(Pf,"");(!p||e.includes(k))&&zs(n,m,l,g.callable,g.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Qo(),i=oi(e),r=e!==i;let l=null,p=!0,m=!0,f=!1;r&&o&&(l=o.Event(e,t),o(n).trigger(l),p=!l.isPropagationStopped(),m=!l.isImmediatePropagationStopped(),f=l.isDefaultPrevented());const u=an(new Event(e,{bubbles:p,cancelable:!0}),t);return f&&u.preventDefault(),m&&n.dispatchEvent(u),u.defaultPrevented&&l&&l.preventDefault(),u}};function an(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function Bn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function As(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ye={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${As(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${As(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Bn(n.dataset[o])}return e},getDataAttribute(n,e){return Bn(n.getAttribute(`data-bs-${As(e)}`))}};class qt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Ge(t)?Ye.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ge(t)?Ye.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const r=e[o],l=Ge(r)?"element":Of(r);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const Hf="5.3.8";class He extends qt{constructor(e,t){super(),e=et(e),e&&(this._element=e,this._config=this._getConfig(t),Cs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Cs.remove(this._element,this.constructor.DATA_KEY),X.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Xo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Cs.get(et(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Hf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ms=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Go(t)).join(","):null},re={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!tt(t)&&Lt(t))},getSelectorFromElement(n){const e=Ms(n);return e&&re.findOne(e)?e:null},getElementFromSelector(n){const e=Ms(n);return e?re.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ms(n);return e?re.find(e):[]}},ms=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;X.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),tt(this))return;const r=re.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},Vf="alert",Uf="bs.alert",ii=`.${Uf}`,qf=`close${ii}`,zf=`closed${ii}`,Kf="fade",Gf="show";class ps extends He{static get NAME(){return Vf}close(){if(X.trigger(this._element,qf).defaultPrevented)return;this._element.classList.remove(Gf);const t=this._element.classList.contains(Kf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),X.trigger(this._element,zf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(ps,"close");Be(ps);const Yf="button",Jf="bs.button",Qf=`.${Jf}`,Xf=".data-api",Zf="active",Wn='[data-bs-toggle="button"]',ev=`click${Qf}${Xf}`;class fs extends He{static get NAME(){return Yf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Zf))}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}X.on(document,ev,Wn,n=>{n.preventDefault();const e=n.target.closest(Wn);fs.getOrCreateInstance(e).toggle()});Be(fs);const tv="swipe",Nt=".bs.swipe",sv=`touchstart${Nt}`,nv=`touchmove${Nt}`,ov=`touchend${Nt}`,iv=`pointerdown${Nt}`,av=`pointerup${Nt}`,rv="touch",lv="pen",cv="pointer-event",uv=40,dv={endCallback:null,leftCallback:null,rightCallback:null},mv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class rs extends qt{constructor(e,t){super(),this._element=e,!(!e||!rs.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return dv}static get DefaultType(){return mv}static get NAME(){return tv}dispose(){X.off(this._element,Nt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),xe(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=uv)return;const t=e/this._deltaX;this._deltaX=0,t&&xe(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(X.on(this._element,iv,e=>this._start(e)),X.on(this._element,av,e=>this._end(e)),this._element.classList.add(cv)):(X.on(this._element,sv,e=>this._start(e)),X.on(this._element,nv,e=>this._move(e)),X.on(this._element,ov,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===lv||e.pointerType===rv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const pv="carousel",fv="bs.carousel",at=`.${fv}`,ai=".data-api",vv="ArrowLeft",hv="ArrowRight",_v=500,It="next",_t="prev",yt="left",ns="right",gv=`slide${at}`,Os=`slid${at}`,bv=`keydown${at}`,yv=`mouseenter${at}`,wv=`mouseleave${at}`,$v=`dragstart${at}`,kv=`load${at}${ai}`,Sv=`click${at}${ai}`,ri="carousel",Jt="active",Ev="slide",Cv="carousel-item-end",Tv="carousel-item-start",xv="carousel-item-next",Av="carousel-item-prev",li=".active",ci=".carousel-item",Mv=li+ci,Ov=".carousel-item img",Dv=".carousel-indicators",Lv="[data-bs-slide], [data-bs-slide-to]",Nv='[data-bs-ride="carousel"]',jv={[vv]:ns,[hv]:yt},Iv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Pv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class zt extends He{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=re.findOne(Dv,this._element),this._addEventListeners(),this._config.ride===ri&&this.cycle()}static get Default(){return Iv}static get DefaultType(){return Pv}static get NAME(){return pv}next(){this._slide(It)}nextWhenVisible(){!document.hidden&&Lt(this._element)&&this.next()}prev(){this._slide(_t)}pause(){this._isSliding&&Yo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){X.one(this._element,Os,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){X.one(this._element,Os,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?It:_t;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&X.on(this._element,bv,e=>this._keydown(e)),this._config.pause==="hover"&&(X.on(this._element,yv,()=>this.pause()),X.on(this._element,wv,()=>this._maybeEnableCycle())),this._config.touch&&rs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of re.find(Ov,this._element))X.on(o,$v,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(yt)),rightCallback:()=>this._slide(this._directionToOrder(ns)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),_v+this._config.interval))}};this._swipeHelper=new rs(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=jv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=re.findOne(li,this._indicatorsElement);t.classList.remove(Jt),t.removeAttribute("aria-current");const o=re.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Jt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===It,r=t||on(this._getItems(),o,i,this._config.wrap);if(r===o)return;const l=this._getItemIndex(r),p=k=>X.trigger(this._element,k,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(p(gv).defaultPrevented||!o||!r)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=r;const u=i?Tv:Cv,w=i?xv:Av;r.classList.add(w),Ut(r),o.classList.add(u),r.classList.add(u);const g=()=>{r.classList.remove(u,w),r.classList.add(Jt),o.classList.remove(Jt,w,u),this._isSliding=!1,p(Os)};this._queueCallback(g,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(Ev)}_getActive(){return re.findOne(Mv,this._element)}_getItems(){return re.find(ci,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ie()?e===yt?_t:It:e===yt?It:_t}_orderToDirection(e){return Ie()?e===_t?yt:ns:e===_t?ns:yt}static jQueryInterface(e){return this.each(function(){const t=zt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}X.on(document,Sv,Lv,function(n){const e=re.getElementFromSelector(this);if(!e||!e.classList.contains(ri))return;n.preventDefault();const t=zt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Ye.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});X.on(window,kv,()=>{const n=re.find(Nv);for(const e of n)zt.getOrCreateInstance(e)});Be(zt);const Rv="collapse",Bv="bs.collapse",Kt=`.${Bv}`,Wv=".data-api",Fv=`show${Kt}`,Hv=`shown${Kt}`,Vv=`hide${Kt}`,Uv=`hidden${Kt}`,qv=`click${Kt}${Wv}`,Ds="show",$t="collapse",Qt="collapsing",zv="collapsed",Kv=`:scope .${$t} .${$t}`,Gv="collapse-horizontal",Yv="width",Jv="height",Qv=".collapse.show, .collapse.collapsing",Ks='[data-bs-toggle="collapse"]',Xv={parent:null,toggle:!0},Zv={parent:"(null|element)",toggle:"boolean"};class Mt extends He{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=re.find(Ks);for(const i of o){const r=re.getSelectorFromElement(i),l=re.find(r).filter(p=>p===this._element);r!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Xv}static get DefaultType(){return Zv}static get NAME(){return Rv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Qv).filter(p=>p!==this._element).map(p=>Mt.getOrCreateInstance(p,{toggle:!1}))),e.length&&e[0]._isTransitioning||X.trigger(this._element,Fv).defaultPrevented)return;for(const p of e)p.hide();const o=this._getDimension();this._element.classList.remove($t),this._element.classList.add(Qt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t,Ds),this._element.style[o]="",X.trigger(this._element,Hv)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||X.trigger(this._element,Vv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ut(this._element),this._element.classList.add(Qt),this._element.classList.remove($t,Ds);for(const i of this._triggerArray){const r=re.getElementFromSelector(i);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t),X.trigger(this._element,Uv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ds)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=et(e.parent),e}_getDimension(){return this._element.classList.contains(Gv)?Yv:Jv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ks);for(const t of e){const o=re.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=re.find(Kv,this._config.parent);return re.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(zv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Mt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}X.on(document,qv,Ks,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of re.getMultipleElementsFromSelector(this))Mt.getOrCreateInstance(e,{toggle:!1}).toggle()});Be(Mt);const Fn="dropdown",eh="bs.dropdown",vt=`.${eh}`,rn=".data-api",th="Escape",Hn="Tab",sh="ArrowUp",Vn="ArrowDown",nh=2,oh=`hide${vt}`,ih=`hidden${vt}`,ah=`show${vt}`,rh=`shown${vt}`,ui=`click${vt}${rn}`,di=`keydown${vt}${rn}`,lh=`keyup${vt}${rn}`,wt="show",ch="dropup",uh="dropend",dh="dropstart",mh="dropup-center",ph="dropdown-center",lt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',fh=`${lt}.${wt}`,os=".dropdown-menu",vh=".navbar",hh=".navbar-nav",_h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",gh=Ie()?"top-end":"top-start",bh=Ie()?"top-start":"top-end",yh=Ie()?"bottom-end":"bottom-start",wh=Ie()?"bottom-start":"bottom-end",$h=Ie()?"left-start":"right-start",kh=Ie()?"right-start":"left-start",Sh="top",Eh="bottom",Ch={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Th={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ue extends He{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=re.next(this._element,os)[0]||re.prev(this._element,os)[0]||re.findOne(os,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ch}static get DefaultType(){return Th}static get NAME(){return Fn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(tt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!X.trigger(this._element,ah,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(hh))for(const o of[].concat(...document.body.children))X.on(o,"mouseover",as);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(wt),this._element.classList.add(wt),X.trigger(this._element,rh,e)}}hide(){if(tt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!X.trigger(this._element,oh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))X.off(o,"mouseover",as);this._popper&&this._popper.destroy(),this._menu.classList.remove(wt),this._element.classList.remove(wt),this._element.setAttribute("aria-expanded","false"),Ye.removeDataAttribute(this._menu,"popper"),X.trigger(this._element,ih,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ge(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Fn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ko>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ge(this._config.reference)?e=et(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=nn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(wt)}_getPlacement(){const e=this._parent;if(e.classList.contains(uh))return $h;if(e.classList.contains(dh))return kh;if(e.classList.contains(mh))return Sh;if(e.classList.contains(ph))return Eh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ch)?t?bh:gh:t?wh:yh}_detectNavbar(){return this._element.closest(vh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ye.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...xe(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=re.find(_h,this._menu).filter(i=>Lt(i));o.length&&on(o,t,e===Vn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ue.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===nh||e.type==="keyup"&&e.key!==Hn)return;const t=re.find(fh);for(const o of t){const i=Ue.getInstance(o);if(!i||i._config.autoClose===!1)continue;const r=e.composedPath(),l=r.includes(i._menu);if(r.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Hn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const p={relatedTarget:i._element};e.type==="click"&&(p.clickEvent=e),i._completeHide(p)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===th,i=[sh,Vn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const r=this.matches(lt)?this:re.prev(this,lt)[0]||re.next(this,lt)[0]||re.findOne(lt,e.delegateTarget.parentNode),l=Ue.getOrCreateInstance(r);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),r.focus())}}X.on(document,di,lt,Ue.dataApiKeydownHandler);X.on(document,di,os,Ue.dataApiKeydownHandler);X.on(document,ui,Ue.clearMenus);X.on(document,lh,Ue.clearMenus);X.on(document,ui,lt,function(n){n.preventDefault(),Ue.getOrCreateInstance(this).toggle()});Be(Ue);const mi="backdrop",xh="fade",Un="show",qn=`mousedown.bs.${mi}`,Ah={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Mh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class pi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ah}static get DefaultType(){return Mh}static get NAME(){return mi}show(e){if(!this._config.isVisible){xe(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Ut(t),t.classList.add(Un),this._emulateAnimation(()=>{xe(e)})}hide(e){if(!this._config.isVisible){xe(e);return}this._getElement().classList.remove(Un),this._emulateAnimation(()=>{this.dispose(),xe(e)})}dispose(){this._isAppended&&(X.off(this._element,qn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(xh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=et(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),X.on(e,qn,()=>{xe(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Xo(e,this._getElement(),this._config.isAnimated)}}const Oh="focustrap",Dh="bs.focustrap",ls=`.${Dh}`,Lh=`focusin${ls}`,Nh=`keydown.tab${ls}`,jh="Tab",Ih="forward",zn="backward",Ph={autofocus:!0,trapElement:null},Rh={autofocus:"boolean",trapElement:"element"};class fi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ph}static get DefaultType(){return Rh}static get NAME(){return Oh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),X.off(document,ls),X.on(document,Lh,e=>this._handleFocusin(e)),X.on(document,Nh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,X.off(document,ls))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=re.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===zn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===jh&&(this._lastTabNavDirection=e.shiftKey?zn:Ih)}}const Kn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Gn=".sticky-top",Xt="padding-right",Yn="margin-right";class Gs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Xt,t=>t+e),this._setElementAttributes(Kn,Xt,t=>t+e),this._setElementAttributes(Gn,Yn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Xt),this._resetElementAttributes(Kn,Xt),this._resetElementAttributes(Gn,Yn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),r=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,t);const p=window.getComputedStyle(l).getPropertyValue(t);l.style.setProperty(t,`${o(Number.parseFloat(p))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Ye.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const r=Ye.getDataAttribute(i,t);if(r===null){i.style.removeProperty(t);return}Ye.removeDataAttribute(i,t),i.style.setProperty(t,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Ge(e)){t(e);return}for(const o of re.find(e,this._element))t(o)}}const Bh="modal",Wh="bs.modal",Pe=`.${Wh}`,Fh=".data-api",Hh="Escape",Vh=`hide${Pe}`,Uh=`hidePrevented${Pe}`,vi=`hidden${Pe}`,hi=`show${Pe}`,qh=`shown${Pe}`,zh=`resize${Pe}`,Kh=`click.dismiss${Pe}`,Gh=`mousedown.dismiss${Pe}`,Yh=`keydown.dismiss${Pe}`,Jh=`click${Pe}${Fh}`,Jn="modal-open",Qh="fade",Qn="show",Ls="modal-static",Xh=".modal.show",Zh=".modal-dialog",e_=".modal-body",t_='[data-bs-toggle="modal"]',s_={backdrop:!0,focus:!0,keyboard:!0},n_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ft extends He{constructor(e,t){super(e,t),this._dialog=re.findOne(Zh,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Gs,this._addEventListeners()}static get Default(){return s_}static get DefaultType(){return n_}static get NAME(){return Bh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||X.trigger(this._element,hi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Jn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||X.trigger(this._element,Vh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Qn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){X.off(window,Pe),X.off(this._dialog,Pe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new pi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=re.findOne(e_,this._dialog);t&&(t.scrollTop=0),Ut(this._element),this._element.classList.add(Qn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,X.trigger(this._element,qh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){X.on(this._element,Yh,e=>{if(e.key===Hh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),X.on(window,zh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),X.on(this._element,Gh,e=>{X.one(this._element,Kh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Jn),this._resetAdjustments(),this._scrollBar.reset(),X.trigger(this._element,vi)})}_isAnimated(){return this._element.classList.contains(Qh)}_triggerBackdropTransition(){if(X.trigger(this._element,Uh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ls)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ls),this._queueCallback(()=>{this._element.classList.remove(Ls),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Ie()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Ie()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=ft.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}X.on(document,Jh,t_,function(n){const e=re.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),X.one(e,hi,i=>{i.defaultPrevented||X.one(e,vi,()=>{Lt(this)&&this.focus()})});const t=re.findOne(Xh);t&&ft.getInstance(t).hide(),ft.getOrCreateInstance(e).toggle(this)});ms(ft);Be(ft);const o_="offcanvas",i_="bs.offcanvas",Qe=`.${i_}`,_i=".data-api",a_=`load${Qe}${_i}`,r_="Escape",Xn="show",Zn="showing",eo="hiding",l_="offcanvas-backdrop",gi=".offcanvas.show",c_=`show${Qe}`,u_=`shown${Qe}`,d_=`hide${Qe}`,to=`hidePrevented${Qe}`,bi=`hidden${Qe}`,m_=`resize${Qe}`,p_=`click${Qe}${_i}`,f_=`keydown.dismiss${Qe}`,v_='[data-bs-toggle="offcanvas"]',h_={backdrop:!0,keyboard:!0,scroll:!1},__={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class st extends He{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return h_}static get DefaultType(){return __}static get NAME(){return o_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||X.trigger(this._element,c_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Gs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Xn),this._element.classList.remove(Zn),X.trigger(this._element,u_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||X.trigger(this._element,d_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(eo),this._backdrop.hide();const t=()=>{this._element.classList.remove(Xn,eo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Gs().reset(),X.trigger(this._element,bi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){X.trigger(this._element,to);return}this.hide()},t=!!this._config.backdrop;return new pi({className:l_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_addEventListeners(){X.on(this._element,f_,e=>{if(e.key===r_){if(this._config.keyboard){this.hide();return}X.trigger(this._element,to)}})}static jQueryInterface(e){return this.each(function(){const t=st.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}X.on(document,p_,v_,function(n){const e=re.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),tt(this))return;X.one(e,bi,()=>{Lt(this)&&this.focus()});const t=re.findOne(gi);t&&t!==e&&st.getInstance(t).hide(),st.getOrCreateInstance(e).toggle(this)});X.on(window,a_,()=>{for(const n of re.find(gi))st.getOrCreateInstance(n).show()});X.on(window,m_,()=>{for(const n of re.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&st.getOrCreateInstance(n).hide()});ms(st);Be(st);const g_=/^aria-[\w-]*$/i,yi={"*":["class","dir","id","lang","role",g_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},b_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),y_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,w_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?b_.has(t)?!!y_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function $_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const l of r){const p=l.nodeName.toLowerCase();if(!Object.keys(e).includes(p)){l.remove();continue}const m=[].concat(...l.attributes),f=[].concat(e["*"]||[],e[p]||[]);for(const u of m)w_(u,f)||l.removeAttribute(u.nodeName)}return i.body.innerHTML}const k_="TemplateFactory",S_={allowList:yi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},E_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},C_={entry:"(string|element|function|null)",selector:"(string|element)"};class T_ extends qt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return S_}static get DefaultType(){return E_}static get NAME(){return k_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,r]of Object.entries(this._config.content))this._setContent(e,r,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},C_)}_setContent(e,t,o){const i=re.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Ge(t)){this._putElementInTemplate(et(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?$_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return xe(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const x_="tooltip",A_=new Set(["sanitize","allowList","sanitizeFn"]),Ns="fade",M_="modal",Zt="show",O_=".tooltip-inner",so=`.${M_}`,no="hide.bs.modal",Pt="hover",js="focus",Is="click",D_="manual",L_="hide",N_="hidden",j_="show",I_="shown",P_="inserted",R_="click",B_="focusin",W_="focusout",F_="mouseenter",H_="mouseleave",V_={AUTO:"auto",TOP:"top",RIGHT:Ie()?"left":"right",BOTTOM:"bottom",LEFT:Ie()?"right":"left"},U_={allowList:yi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},q_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class jt extends He{constructor(e,t){if(typeof Ko>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return U_}static get DefaultType(){return q_}static get NAME(){return x_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),X.off(this._element.closest(so),no,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=X.trigger(this._element,this.constructor.eventName(j_)),o=(Jo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(i),X.trigger(this._element,this.constructor.eventName(P_))),this._popper=this._createPopper(i),i.classList.add(Zt),"ontouchstart"in document.documentElement)for(const p of[].concat(...document.body.children))X.on(p,"mouseover",as);const l=()=>{X.trigger(this._element,this.constructor.eventName(I_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||X.trigger(this._element,this.constructor.eventName(L_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Zt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))X.off(i,"mouseover",as);this._activeTrigger[Is]=!1,this._activeTrigger[js]=!1,this._activeTrigger[Pt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),X.trigger(this._element,this.constructor.eventName(N_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ns,Zt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Df(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ns),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new T_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[O_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ns)}_isShown(){return this.tip&&this.tip.classList.contains(Zt)}_createPopper(e){const t=xe(this._config.placement,[this,e,this._element]),o=V_[t.toUpperCase()];return nn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return xe(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...xe(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")X.on(this._element,this.constructor.eventName(R_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Is]=!(i._isShown()&&i._activeTrigger[Is]),i.toggle()});else if(t!==D_){const o=t===Pt?this.constructor.eventName(F_):this.constructor.eventName(B_),i=t===Pt?this.constructor.eventName(H_):this.constructor.eventName(W_);X.on(this._element,o,this._config.selector,r=>{const l=this._initializeOnDelegatedTarget(r);l._activeTrigger[r.type==="focusin"?js:Pt]=!0,l._enter()}),X.on(this._element,i,this._config.selector,r=>{const l=this._initializeOnDelegatedTarget(r);l._activeTrigger[r.type==="focusout"?js:Pt]=l._element.contains(r.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},X.on(this._element.closest(so),no,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Ye.getDataAttributes(this._element);for(const o of Object.keys(t))A_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:et(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=jt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Be(jt);const z_="popover",K_=".popover-header",G_=".popover-body",Y_={...jt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},J_={...jt.DefaultType,content:"(null|string|element|function)"};class ln extends jt{static get Default(){return Y_}static get DefaultType(){return J_}static get NAME(){return z_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[K_]:this._getTitle(),[G_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=ln.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Be(ln);const Q_="scrollspy",X_="bs.scrollspy",cn=`.${X_}`,Z_=".data-api",eg=`activate${cn}`,oo=`click${cn}`,tg=`load${cn}${Z_}`,sg="dropdown-item",gt="active",ng='[data-bs-spy="scroll"]',Ps="[href]",og=".nav, .list-group",io=".nav-link",ig=".nav-item",ag=".list-group-item",rg=`${io}, ${ig} > ${io}, ${ag}`,lg=".dropdown",cg=".dropdown-toggle",ug={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},dg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class vs extends He{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ug}static get DefaultType(){return dg}static get NAME(){return Q_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=et(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(X.off(this._config.target,oo),X.on(this._config.target,oo,Ps,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(t(l))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(l));continue}const p=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&p){if(o(l),!i)return;continue}!r&&!p&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=re.find(Ps,this._config.target);for(const t of e){if(!t.hash||tt(t))continue;const o=re.findOne(decodeURI(t.hash),this._element);Lt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(gt),this._activateParents(e),X.trigger(this._element,eg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(sg)){re.findOne(cg,e.closest(lg)).classList.add(gt);return}for(const t of re.parents(e,og))for(const o of re.prev(t,rg))o.classList.add(gt)}_clearActiveClass(e){e.classList.remove(gt);const t=re.find(`${Ps}.${gt}`,e);for(const o of t)o.classList.remove(gt)}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}X.on(window,tg,()=>{for(const n of re.find(ng))vs.getOrCreateInstance(n)});Be(vs);const mg="tab",pg="bs.tab",ht=`.${pg}`,fg=`hide${ht}`,vg=`hidden${ht}`,hg=`show${ht}`,_g=`shown${ht}`,gg=`click${ht}`,bg=`keydown${ht}`,yg=`load${ht}`,wg="ArrowLeft",ao="ArrowRight",$g="ArrowUp",ro="ArrowDown",Rs="Home",lo="End",ct="active",co="fade",Bs="show",kg="dropdown",wi=".dropdown-toggle",Sg=".dropdown-menu",Ws=`:not(${wi})`,Eg='.list-group, .nav, [role="tablist"]',Cg=".nav-item, .list-group-item",Tg=`.nav-link${Ws}, .list-group-item${Ws}, [role="tab"]${Ws}`,$i='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Fs=`${Tg}, ${$i}`,xg=`.${ct}[data-bs-toggle="tab"], .${ct}[data-bs-toggle="pill"], .${ct}[data-bs-toggle="list"]`;class Ot extends He{constructor(e){super(e),this._parent=this._element.closest(Eg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),X.on(this._element,bg,t=>this._keydown(t)))}static get NAME(){return mg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?X.trigger(t,fg,{relatedTarget:e}):null;X.trigger(e,hg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(ct),this._activate(re.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Bs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),X.trigger(e,_g,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_deactivate(e,t){if(!e)return;e.classList.remove(ct),e.blur(),this._deactivate(re.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Bs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),X.trigger(e,vg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_keydown(e){if(![wg,ao,$g,ro,Rs,lo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!tt(i));let o;if([Rs,lo].includes(e.key))o=t[e.key===Rs?0:t.length-1];else{const i=[ao,ro].includes(e.key);o=on(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Ot.getOrCreateInstance(o).show())}_getChildren(){return re.find(Fs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=re.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(kg))return;const i=(r,l)=>{const p=re.findOne(r,o);p&&p.classList.toggle(l,t)};i(wi,ct),i(Sg,Bs),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(ct)}_getInnerElement(e){return e.matches(Fs)?e:re.findOne(Fs,e)}_getOuterElement(e){return e.closest(Cg)||e}static jQueryInterface(e){return this.each(function(){const t=Ot.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}X.on(document,gg,$i,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!tt(this)&&Ot.getOrCreateInstance(this).show()});X.on(window,yg,()=>{for(const n of re.find(xg))Ot.getOrCreateInstance(n)});Be(Ot);const Ag="toast",Mg="bs.toast",rt=`.${Mg}`,Og=`mouseover${rt}`,Dg=`mouseout${rt}`,Lg=`focusin${rt}`,Ng=`focusout${rt}`,jg=`hide${rt}`,Ig=`hidden${rt}`,Pg=`show${rt}`,Rg=`shown${rt}`,Bg="fade",uo="hide",es="show",ts="showing",Wg={animation:"boolean",autohide:"boolean",delay:"number"},Fg={animation:!0,autohide:!0,delay:5e3};class hs extends He{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Fg}static get DefaultType(){return Wg}static get NAME(){return Ag}show(){if(X.trigger(this._element,Pg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Bg);const t=()=>{this._element.classList.remove(ts),X.trigger(this._element,Rg),this._maybeScheduleHide()};this._element.classList.remove(uo),Ut(this._element),this._element.classList.add(es,ts),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||X.trigger(this._element,jg).defaultPrevented)return;const t=()=>{this._element.classList.add(uo),this._element.classList.remove(ts,es),X.trigger(this._element,Ig)};this._element.classList.add(ts),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(es),super.dispose()}isShown(){return this._element.classList.contains(es)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){X.on(this._element,Og,e=>this._onInteraction(e,!0)),X.on(this._element,Dg,e=>this._onInteraction(e,!1)),X.on(this._element,Lg,e=>this._onInteraction(e,!0)),X.on(this._element,Ng,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=hs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(hs);Be(hs);const Hg={class:"message-content-column"},Vg=["id"],Ug={class:"accordion-item"},qg=["id"],zg=["aria-controls"],Kg={class:"d-flex align-items-center w-100"},Gg={class:"badge bg-warning text-dark ms-auto me-2"},Yg={class:"text-muted"},Jg=["id","aria-labelledby"],Qg={class:"accordion-body bg-light"},Xg={class:"alert alert-warning mb-3",role:"alert"},Zg={class:"compaction-metadata"},eb={class:"metadata-row"},tb={class:"metadata-row"},sb={key:0,class:"metadata-row"},nb={class:"continuation-content"},ob={class:"continuation-text border rounded p-3 bg-white"},ib={class:"mb-0"},ab={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=v(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=v(()=>`heading-${t.value}`),i=v(()=>`collapse-${t.value}`),r=R(null);let l=null;ke(()=>{r.value&&(l=new Mt(r.value,{toggle:!1}))}),Si(()=>{l&&l.dispose()});function p(){l&&l.toggle()}const m=v(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=v(()=>m.value?e.messages[3]:e.messages[2]),u=v(()=>f.value?.metadata?.init_data?.compact_metadata||{}),w=v(()=>u.value.pre_tokens||0),g=v(()=>m.value?e.messages[4]:e.messages[3]),k=v(()=>g.value?.content||""),$=v(()=>{const d=e.messages[0]?.timestamp;return d?Ht(d):""});function y(d){return d?`${d.toLocaleString()} tokens`:"0 tokens"}return(d,h)=>(a(),c("div",{class:"message-row message-row-compaction",key:t.value},[h[7]||(h[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Hg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Ug,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:p},[s("div",Kg,[h[0]||(h[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",Gg,b(y(w.value)),1),s("small",Yg,b($.value),1)])],8,zg)],8,qg),s("div",{ref_key:"collapseElement",ref:r,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Qg,[s("div",Xg,[h[5]||(h[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ae(" Compaction Details ")],-1)),s("div",Zg,[s("div",eb,[h[2]||(h[2]=s("strong",null,"Trigger:",-1)),s("span",null,b(u.value.trigger||"auto"),1)]),s("div",tb,[h[3]||(h[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,b(y(w.value)),1)]),u.value.post_tokens?(a(),c("div",sb,[h[4]||(h[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,b(y(u.value.post_tokens)),1)])):A("",!0)])]),s("div",nb,[h[6]||(h[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ae(" Continuation Message ")],-1)),s("div",ob,[s("pre",ib,b(k.value),1)])])])],8,Jg)])],8,Vg)])]))}},rb=ne(ab,[["__scopeId","data-v-e0b95ba8"]]),lb={key:0,class:"text-muted text-center py-5"},cb={__name:"MessageList",setup(n){const e=Oe(),t=be(),o=R(null),i=v(()=>{const u=e.currentMessages,w=[];let g=0;for(;g<u.length;){const k=u[g];if(l(k,u,g)){const $=u[g+2],d=$?.type==="system"&&$?.metadata?.subtype==="init"?5:4,h=u.slice(g,g+d);w.push({type:"compaction",messages:h}),g+=d;continue}m(k)&&w.push({type:"message",message:k,attachedTools:[]}),g++}return r(w)});function r(u){const w=new Map,g=new Set;for(let $=0;$<u.length;$++){const y=u[$];if(y.type==="compaction")continue;const d=y.message,h=d.content&&d.content.trim().length>0&&d.content!=="Assistant response",_=d.type==="assistant"&&d.metadata?.has_tool_uses&&d.metadata?.tool_uses?.length>0;if(d.type==="assistant"&&_&&!h){let x=-1,C=!1;for(let B=$-1;B>=0;B--){const j=u[B];if(!g.has(B)){if(j.type==="message"&&j.message.type!=="assistant"){C=!0;break}if(j.type==="message"&&j.message.type==="assistant"){const M=j.message;if(M.content&&M.content.trim().length>0&&M.content!=="Assistant response"){x=B;break}else{x=B;break}}}}C&&x===-1||(C&&x>=0?(w.has(x)||w.set(x,[]),w.get(x).push(...d.metadata.tool_uses),g.add($)):!C&&x>=0&&(w.has(x)||w.set(x,[]),w.get(x).push(...d.metadata.tool_uses),g.add($)))}}const k=[];for(let $=0;$<u.length;$++){if(g.has($))continue;const y=u[$];w.has($)&&(y.attachedTools=[...y.attachedTools||[],...w.get($)]),k.push(y)}return k}function l(u,w,g){if(g+3>=w.length)return!1;const k=w[g],$=w[g+1];let y=w[g+2],d=w[g+3],h=w[g+4];const _=k.type==="system"&&k.metadata?.subtype==="status"&&k.metadata?.init_data?.status==="compacting",x=$.type==="system"&&$.metadata?.subtype==="status"&&($.metadata?.init_data?.status===null||$.metadata?.init_data?.status===void 0);if(y?.type==="system"&&y?.metadata?.subtype==="init"){if(g+4>=w.length)return!1;const B=!0,j=d?.type==="system"&&d?.metadata?.subtype==="compact_boundary",M=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",x),console.log("  Msg3 (init):",B),console.log("  Msg4 (boundary):",j),console.log("  Msg5 (continuation):",M)),_&&x&&B&&j&&M}else{const B=y?.type==="system"&&y?.metadata?.subtype==="compact_boundary",j=d?.type==="user"&&d?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",x),console.log("  Msg3 (boundary):",B),console.log("  Msg4 (continuation):",j)),_&&x&&B&&j}}async function p(){t.autoScrollEnabled&&(await kt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ve(()=>i.value.length,p),ve(()=>e.currentToolCalls.length,p),ve(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),p),ke(()=>{setTimeout(()=>{p()},100)});function m(u){const w=u.subtype||u.metadata?.subtype;if(u.type==="system"&&w==="init"||u.type==="system"&&w==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const g=u.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const g=u.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function f(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,w)=>(a(),c("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),c("div",lb," No messages yet. Start a conversation! ")):A("",!0),(a(!0),c(le,null,ce(i.value,(g,k)=>(a(),c(le,{key:`item-${k}`},[g.type==="message"?(a(),$e(Up,{key:0,message:f(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(a(),$e(rb,{key:1,messages:g.messages},null,8,["messages"])):A("",!0)],64))),128))],512))}},ub=ne(cb,[["__scopeId","data-v-bb936559"]]),db={key:0,class:"attachment-list"},mb={key:0,class:"attachment-preview"},pb=["src","alt"],fb={key:1,class:"attachment-icon"},vb={class:"file-type-icon"},hb={class:"attachment-info"},_b=["title"],gb={class:"attachment-size"},bb=["onClick"],yb={key:2,class:"upload-progress"},wb=["title"],$b={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const t=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const f=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function i(m){const f=m.name?.split(".").pop()?.toLowerCase()||"",u=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function r(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function l(m,f=20){if(!m||m.length<=f)return m;const u=m.split(".").pop(),w=m.substring(0,m.length-u.length-1);return w.length<=f-u.length-4?m:w.substring(0,f-u.length-4)+"..."+u}function p(m){t("remove",m)}return(m,f)=>n.attachments.length>0?(a(),c("div",db,[(a(!0),c(le,null,ce(n.attachments,(u,w)=>(a(),c("div",{key:u.id||w,class:"attachment-item"},[o(u)?(a(),c("div",mb,[s("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,pb)])):(a(),c("div",fb,[s("span",vb,b(i(u)),1)])),s("div",hb,[s("span",{class:"attachment-name",title:u.name},b(l(u.name)),9,_b),s("span",gb,b(r(u.size)),1)]),s("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>p(w)}," âœ• ",8,bb),u.uploading?(a(),c("div",yb,[s("div",{class:"progress-bar",style:Ke({width:(u.progress||0)+"%"})},null,4)])):A("",!0),u.error?(a(),c("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+b(u.error),9,wb)):A("",!0)]))),128))])):A("",!0)}},kb=ne($b,[["__scopeId","data-v-0fcc4974"]]),Sb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Eb=["disabled"],Cb=["placeholder","disabled"],Tb=["disabled"],xb=["disabled"],mo=5*1024*1024,Ab={__name:"InputArea",setup(n){const e=de(),t=ot(),o=Ze(),i=be(),r=fo("pendingResourceAttachment",R(null)),l=R(null),p=R(null),m=R(window.innerWidth),f=R([]),u=R(!1),w=R(!1),g=v({get:()=>e.currentInput,set:S=>{e.currentInput=S}}),k=v(()=>e.currentSession?.is_processing||!1),$=v(()=>t.sessionConnected),y=v(()=>e.currentSession?.state==="starting"),d=v(()=>e.currentSessionId),h=v(()=>!!g.value.trim()||f.value.filter(S=>!S.error).length>0),_=v(()=>m.value<768),x=v(()=>y.value?"Session is starting...":$.value?"Type your message to Claude Code...":"Waiting for connection...");function C(){m.value=window.innerWidth}ke(()=>{window.addEventListener("resize",C)}),Te(()=>{window.removeEventListener("resize",C)}),ve(r,S=>{S&&(L(S),r.value=null)});function B(S){if(S.key==="Enter"&&!S.shiftKey){if(_.value)return;S.preventDefault(),Z()}}function j(){const S=l.value;if(!S)return;S.style.height="auto";const I=Math.min(S.scrollHeight,parseInt(getComputedStyle(S).maxHeight));S.style.height=I+"px"}function M(){p.value?.click()}function V(S){const I=Array.from(S.target.files||[]);P(I),S.target.value=""}function T(S){u.value=!1;const I=Array.from(S.dataTransfer?.files||[]);P(I)}function E(S){const I=S.clipboardData?.items;if(!I)return;const G=[];for(const Q of I)if(Q.type.startsWith("image/")){const Y=Q.getAsFile();if(Y){const ee=Q.type.split("/")[1]||"png",_e=`clipboard-${Date.now()}.${ee}`,J=new File([Y],_e,{type:Y.type});G.push(J)}}G.length>0&&(S.preventDefault(),P(G))}function P(S){for(const I of S){if(I.size>mo){f.value.push({id:N(),name:I.name,size:I.size,type:I.type,file:I,error:`File too large (max ${mo/(1024*1024)}MB)`});continue}let G=null;I.type.startsWith("image/")&&(G=URL.createObjectURL(I)),f.value.push({id:N(),name:I.name,size:I.size,type:I.type,file:I,preview:G,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function z(S){const I=f.value[S];I.preview&&URL.revokeObjectURL(I.preview),f.value.splice(S,1)}function N(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function W(S){const I=d.value;if(!I)return null;S.uploading=!0,S.progress=0,S.error=null;try{const G=new FormData;G.append("file",S.file);const Q=await fetch(`/api/sessions/${I}/files`,{method:"POST",body:G});if(!Q.ok){const ee=await Q.json().catch(()=>({}));throw new Error(ee.detail||`Upload failed: ${Q.status}`)}const Y=await Q.json();return S.uploaded=!0,S.uploadedInfo=Y.file,S.progress=100,Y.file}catch(G){return S.error=G.message,null}finally{S.uploading=!1}}async function K(){const S=f.value.filter(I=>!I.uploaded&&!I.error);if(S.length===0)return!0;w.value=!0;try{return(await Promise.all(S.map(W))).every(G=>G!==null)}finally{w.value=!1}}async function Z(){const S=g.value.trim(),I=f.value.filter(Y=>!Y.error).length>0;if(!S&&!I||I&&!await K())return;let G=g.value;const Q=f.value.filter(Y=>Y.uploaded&&Y.uploadedInfo).map(Y=>Y.uploadedInfo);if(Q.length>0){const Y=Q.map(ee=>{const _e=(ee.size_bytes/1024).toFixed(1);return`- ${ee.original_name} (${_e} KB): ${ee.stored_path}`}).join(`
`);G.trim()?G=`${G}

---
Attached files (use Read tool to access):
${Y}`:G=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${Y}`}t.sendMessage(G),g.value="",D(),l.value&&(l.value.style.height="auto")}function D(){for(const S of f.value)S.preview&&URL.revokeObjectURL(S.preview);f.value=[]}function L(S){if(!S||!S.resource_id){console.warn("Invalid resource for attachment:",S);return}const I=d.value;if(!I){console.warn("No current session for resource attachment");return}if(f.value.findIndex(ee=>ee.resourceId===S.resource_id)>=0){console.log("Resource already attached:",S.resource_id);return}const Q=o.isImageResource(S);let Y=null;Q&&(Y=o.getResourceUrl(I,S.resource_id)),f.value.push({id:N(),resourceId:S.resource_id,name:S.original_filename||S.title||"Resource",size:S.size_bytes||0,type:S.format||"application/octet-stream",file:null,preview:Y,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:S.resource_id,original_name:S.original_filename||S.title,stored_path:S.file_path||`/api/sessions/${I}/resources/${S.resource_id}`,size_bytes:S.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",S.resource_id)}function O(){t.interruptSession()}return(S,I)=>(a(),c("div",{class:te(["border-top",ye(i).isRedBackground?"theme-red-panel":"bg-light"])},[$.value?A("",!0):(a(),c("div",Sb,[...I[5]||(I[5]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),fe(kb,{attachments:f.value,onRemove:z},null,8,["attachments"]),u.value?(a(),c("div",{key:1,class:"drop-zone-overlay",onDragover:I[0]||(I[0]=he(()=>{},["prevent"])),onDragleave:I[1]||(I[1]=G=>u.value=!1),onDrop:he(T,["prevent"])},[...I[6]||(I[6]=[s("div",{class:"drop-zone-content"},[s("span",{class:"drop-icon"},"ðŸ“Ž"),s("span",null,"Drop files here")],-1)])],32)):A("",!0),s("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:I[3]||(I[3]=he(G=>u.value=!0,["prevent"])),onDragenter:I[4]||(I[4]=he(G=>u.value=!0,["prevent"]))},[s("input",{ref_key:"fileInput",ref:p,type:"file",multiple:"",class:"d-none",onChange:V},null,544),s("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:y.value||!$.value,onClick:M}," ðŸ“Ž ",8,Eb),we(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:l,"onUpdate:modelValue":I[2]||(I[2]=G=>g.value=G),class:"form-control",placeholder:x.value,disabled:y.value||!$.value,rows:"1",onInput:j,onKeydown:B,onPaste:E},null,40,Cb),[[Fe,g.value]]),k.value&&!h.value?(a(),c("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:O}," Stop ")):k.value&&h.value?(a(),c("button",{key:1,class:"btn btn-info",disabled:!$.value||y.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:Z},b(w.value?"Uploading...":"Queue"),9,Tb)):(a(),c("button",{key:2,class:"btn btn-primary",disabled:!h.value||!$.value||y.value||w.value,onClick:Z},b(w.value?"Uploading...":"Send"),9,xb))],32)],2))}},Mb=ne(Ab,[["__scopeId","data-v-d366c5ec"]]),Ob={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Db={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Lb={class:"text-secondary"},Nb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},jb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=be(),i=v(()=>t.currentSession),r=v(()=>o.isLoading),l=v(()=>o.loadingMessage);return ke(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ve(()=>e.sessionId,async(p,m)=>{if(p!==m&&p!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(p)}finally{o.hideLoading()}}}),Te(()=>{}),(p,m)=>(a(),c("div",Ob,[r.value?(a(),c("div",Db,[m[0]||(m[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",Lb,b(l.value),1)])):A("",!0),i.value?(a(),$e(qi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),s("div",Nb,[fe(ub)]),fe(Mb),i.value?(a(),$e(Ji,{key:2,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),i.value?(a(),$e(oa,{key:3,"session-id":e.sessionId},null,8,["session-id"])):A("",!0)]))}},_s=nt("legion",()=>{const n=R(new Map),e=R(new Map),t=R(null),o=v(()=>n.value.get(t.value)||[]),i=v(()=>e.value.get(t.value)||[]);function r($){t.value=$}async function l($,y=100,d=0){try{const h=await me.get(`/api/legions/${$}/timeline?limit=${y}&offset=${d}`),_=h.comms||[],x=h.total_count||_.length,C=h.has_more||!1;return _.sort((B,j)=>new Date(B.timestamp)-new Date(j.timestamp)),console.log(`Loaded ${_.length} of ${x} comms for legion ${$}`),n.value.set($,_),n.value=new Map(n.value),{comms:_,totalCount:x,hasMore:C}}catch(h){throw console.error("Failed to load timeline:",h),h}}function p($,y){n.value.has($)||n.value.set($,[]);const d=n.value.get($);if(d.some(_=>_.comm_id===y.comm_id)){console.log(`Duplicate comm ${y.comm_id} prevented in timeline`);return}d.push(y),n.value=new Map(n.value)}async function m($,y){try{const h=(await me.post(`/api/legions/${$}/comms`,y)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${$}`),h}catch(d){throw console.error("Failed to send comm:",d),d}}async function f($){return console.log(`Minions for legion ${$} are already available in session store`),[]}async function u($,y){try{const h=(await me.post(`/api/legions/${$}/minions`,y)).minion;return await f($),console.log(`Created minion ${h.minion_id} in legion ${$}`),h}catch(d){throw console.error("Failed to create minion:",d),d}}async function w($){try{const y=await me.post(`/api/legions/${$}/halt-all`);return console.log(`Halted ${y.halted_count} of ${y.total_minions} minions in legion ${$}`),y.failed_minions&&y.failed_minions.length>0&&console.warn("Failed to halt some minions:",y.failed_minions),y}catch(y){throw console.error("Failed to halt all minions:",y),y}}async function g($){try{const y=await me.post(`/api/legions/${$}/resume-all`);return console.log(`Resumed ${y.resumed_count} of ${y.total_minions} minions in legion ${$}`),y.failed_minions&&y.failed_minions.length>0&&console.warn("Failed to resume some minions:",y.failed_minions),y}catch(y){throw console.error("Failed to resume all minions:",y),y}}function k($){n.value.delete($),e.value.delete($),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:r,loadTimeline:l,addComm:p,sendComm:m,loadMinions:f,createMinion:u,haltAll:w,resumeAll:g,clearLegionData:k}}),Ib=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:_s},Symbol.toStringTag,{value:"Module"})),Pb={class:"timeline-header border-bottom p-3"},Rb={class:"project-name"},Bb=["title"],Wb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Re(),o=v(()=>t.projects.get(e.legionId)),i=v(()=>o.value?.name||"Legion");return(r,l)=>(a(),c("div",Pb,[s("div",null,[s("div",Rb,b(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Bb)])]))}},Fb=ne(Wb,[["__scopeId","data-v-44f386f5"]]),Hb={class:"timeline-status-bar border-top p-2 bg-light"},Vb={class:"d-flex justify-content-end"},Ub={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=be();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),c("div",Hb,[s("div",Vb,[s("button",{class:te(["btn btn-sm",ye(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+b(ye(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},qb=ne(Ub,[["__scopeId","data-v-891c73db"]]),zb={class:"comm-composer border-top p-3"},Kb={key:0,class:"d-flex gap-2 mb-2"},Gb={class:"flex-grow-1"},Yb=["disabled"],Jb={label:"Minions"},Qb=["value"],Xb={style:{"min-width":"150px"}},Zb=["disabled"],ey={class:"d-flex gap-2 align-items-end position-relative"},ty={class:"flex-grow-1 position-relative"},sy=["disabled"],ny=["onClick","onMouseenter"],oy=["disabled"],iy={key:0},ay={key:1},ry={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=_s(),o=de(),i=Re(),r=R(""),l=R("task"),p=R(""),m=R(!1),f=R(window.innerWidth),u=R(!1),w=R([]),g=R(0),k=R(-1),$=R(null),y=R(null),d=v(()=>f.value<768),h=v(()=>{const z=i.projects.get(e.legionId);return!z||!z.session_ids?[]:z.session_ids.map(N=>o.sessions.get(N)).filter(N=>N)}),_=v(()=>r.value&&p.value.trim().length>0);function x(z){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[z.state]||"â—‹"}function C(z){return z.role?`${z.name} (${z.role})`:z.name}function B(){const z=$.value;if(!z)return;z.style.height="auto";const N=Math.min(z.scrollHeight,parseInt(getComputedStyle(z).maxHeight));z.style.height=N+"px"}function j(){const z=$.value;if(!z)return;B();const N=p.value,W=z.selectionStart,K=N.substring(0,W),Z=K.lastIndexOf("#");if(Z===-1){u.value=!1;return}const D=K.substring(Z+1).toLowerCase();if(D.includes(" ")){u.value=!1;return}const L=h.value.filter(O=>O.name.toLowerCase().includes(D)).map(O=>({type:"minion",name:O.name,role:O.role,id:O.session_id,state:O.state}));if(L.length===0){u.value=!1;return}w.value=L,g.value=0,k.value=Z,u.value=!0}function M(){if(!y.value)return;const z=y.value,N=z.children[g.value];if(!N)return;const W=N.offsetTop,K=N.offsetHeight,Z=z.scrollTop,D=z.clientHeight;W<Z?z.scrollTop=W:W+K>Z+D&&(z.scrollTop=W+K-D)}function V(z){if(!u.value){if(z.key==="Enter"&&!z.shiftKey){if(d.value)return;_.value&&(z.preventDefault(),E())}return}if(z.key==="ArrowDown")z.preventDefault(),g.value=(g.value+1)%w.value.length,M();else if(z.key==="ArrowUp")z.preventDefault(),g.value=g.value===0?w.value.length-1:g.value-1,M();else if(z.key==="Enter"){z.preventDefault();const N=w.value[g.value];N&&T(N)}else z.key==="Escape"&&(u.value=!1)}function T(z){const N=$.value;if(!N)return;const W=p.value,K=N.selectionStart,Z=W.substring(0,k.value)+"#"+z.name+" "+W.substring(K);p.value=Z;const D=k.value+z.name.length+2;setTimeout(()=>{N.setSelectionRange(D,D),N.focus()},0),u.value=!1}async function E(){if(!(!_.value||m.value)){m.value=!0;try{const[z,N]=r.value.split(":"),W={comm_type:l.value,content:p.value.trim()};z==="minion"&&(W.to_minion_id=N),await t.sendComm(e.legionId,W),p.value="",B()}catch(z){console.error("Failed to send comm:",z),alert(`Failed to send comm: ${z.message}`)}finally{m.value=!1}}}function P(){f.value=window.innerWidth}return ke(()=>{window.addEventListener("resize",P)}),Te(()=>{window.removeEventListener("resize",P)}),ve(u,z=>{if(z){const N=W=>{W.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",N))};setTimeout(()=>document.addEventListener("click",N),0)}}),(z,N)=>(a(),c("div",zb,[n.hideRecipientSelector?A("",!0):(a(),c("div",Kb,[s("div",Gb,[we(s("select",{"onUpdate:modelValue":N[0]||(N[0]=W=>r.value=W),class:"form-select form-select-sm",disabled:m.value},[N[3]||(N[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Jb,[(a(!0),c(le,null,ce(h.value,W=>(a(),c("option",{key:W.session_id,value:`minion:${W.session_id}`},b(x(W))+" "+b(C(W)),9,Qb))),128))])],8,Yb),[[_n,r.value]])]),s("div",Xb,[we(s("select",{"onUpdate:modelValue":N[1]||(N[1]=W=>l.value=W),class:"form-select form-select-sm",disabled:m.value},[...N[4]||(N[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Zb),[[_n,l.value]])])])),s("div",ey,[s("div",ty,[we(s("textarea",{ref_key:"contentTextarea",ref:$,"onUpdate:modelValue":N[2]||(N[2]=W=>p.value=W),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:j,onKeydown:V},null,40,sy),[[Fe,p.value]]),u.value?(a(),c("div",{key:0,ref_key:"autocompleteDropdown",ref:y,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),c(le,null,ce(w.value,(W,K)=>(a(),c("div",{key:W.id,class:te(["autocomplete-item px-2 py-1",{"bg-light":K===g.value}]),onClick:Z=>T(W),onMouseenter:Z=>g.value=K},b(W.type==="minion"?x(W):"#ï¸âƒ£")+" "+b(W.name)+b(W.role?` (${W.role})`:""),43,ny))),128))],512)):A("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!_.value||m.value,onClick:E},[m.value?(a(),c("span",iy,[...N[5]||(N[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ae(" Sending... ",-1)])])):(a(),c("span",ay,"Send"))],8,oy)])])]))}},ly=ne(ry,[["__scopeId","data-v-e52b8e8f"]]),cy={class:"message-content-column-full"},uy=["aria-expanded"],dy={class:"comm-sender-recipient"},my={class:"comm-badge-summary"},py=["title"],fy={class:"comm-summary-text text-muted ms-2"},vy=["aria-label"],hy={key:0,class:"comm-content-body"},_y=["innerHTML"],gy="ffffffff-ffff-ffff-ffff-ffffffffffff",by={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=R(!1);function o(){t.value=!t.value}const i=v(()=>e.comm.from_minion_id===gy),r=v(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),l=v(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),p=v(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),m=v(()=>{const f=e.comm.content||"";let u=dt.parse(f);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),cs.sanitize(u)});return(f,u)=>(a(),c("div",{class:te(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",cy,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",dy,[s("strong",{class:te({"system-sender":i.value})},b(n.senderName),3),n.recipientName?(a(),c(le,{key:0},[u[0]||(u[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,b(n.recipientName),1)],64)):A("",!0)]),s("div",my,[s("span",{class:te(["badge",l.value]),title:r.value},b(n.comm.comm_type),11,py),s("span",fy,b(p.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},b(t.value?"â–¾":"â–¸"),9,vy)],8,uy),t.value?(a(),c("div",hy,[s("div",{class:"message-text",innerHTML:m.value},null,8,_y)])):A("",!0)])],2))}},yy=ne(by,[["__scopeId","data-v-28513f64"]]),wy={class:"timeline-view d-flex flex-column h-100"},$y={key:0,class:"text-center text-muted"},ky={key:1,class:"text-center text-danger"},Sy={key:2,class:"text-center text-muted"},Ey={key:3,class:"comm-list"},Cy={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=_s();Re();const o=de(),i=ot(),r=be(),l=R(!0),p=R(null),m=R(null),f=v(()=>t.currentComms);function u(d){return d.from_user?"You":d.from_minion_id?d.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(d.from_minion_id)?.name||"Unknown":"Unknown"}function w(d){return d.to_user?"You":d.to_minion_id?o.sessions.get(d.to_minion_id)?.name||"Unknown":"All"}async function g(){r.autoScrollEnabled&&(await kt(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function k(){l.value=!0,p.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await kt(),await g(),setTimeout(()=>{g()},100)}catch(d){console.error("Failed to load timeline:",d),d.response?p.value=`${d.message} (${d.response.status})`:p.value=d.message||"Unknown error"}finally{l.value=!1}}function $(){i.connectLegion(e.legionId)}function y(){i.disconnectLegion()}return ve(()=>f.value.length,()=>{g()}),ke(()=>{o.currentSessionId=null,k(),$(),setTimeout(()=>{g()},100)}),Te(()=>{y()}),(d,h)=>(a(),c("div",wy,[fe(Fb,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[l.value?(a(),c("div",$y,[...h[0]||(h[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ae(" Loading timeline... ",-1)])])):p.value?(a(),c("div",ky," Failed to load timeline: "+b(p.value),1)):f.value.length===0?(a(),c("div",Sy," No messages yet. Minions will appear here once they start communicating. ")):(a(),c("div",Ey,[(a(!0),c(le,null,ce(f.value,_=>(a(),$e(yy,{key:_.comm_id,comm:_,"sender-name":u(_),"recipient-name":w(_)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),fe(ly,{"legion-id":n.legionId},null,8,["legion-id"]),fe(qb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Ty=ne(Cy,[["__scopeId","data-v-b6752179"]]),xy={class:"minion-info flex-grow-1"},Ay={class:"minion-name"},My={key:0,class:"me-1"},Oy={key:1,class:"badge bg-secondary ms-2"},Dy={key:0,class:"latest-activity text-muted"},Ly={key:0,class:"activity-prefix"},Ny=["title"],jy={key:1,class:"activity-time ms-1"},Iy={key:1,class:"latest-activity text-muted"},Py={class:"activity-prefix"},Ry=["title"],By={key:2,class:"latest-activity text-muted fst-italic small"},Wy={class:"node-row"},Fy={class:"node-left"},Hy={key:0,class:"me-2"},Vy={key:1,class:"badge bg-secondary ms-2"},Uy={class:"node-right"},qy={key:0,class:"latest-message-preview"},zy={key:0,class:"message-prefix"},Ky=["title"],Gy={key:1,class:"message-time ms-1"},Yy={key:1,class:"last-comm-preview"},Jy={class:"comm-direction"},Qy=["title"],Xy={key:2,class:"text-muted fst-italic small"},Zy={class:"node-actions"},e1={key:2,class:"minion-children"},t1={key:1,class:"text-danger small ms-4"},s1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=de(),r=Oe(),l=be(),p=v(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),m=v(()=>{if(!t.minionData||!t.minionData.id)return null;const T=r.messagesBySession.get(t.minionData.id);if(!T||T.length===0)return null;for(let E=T.length-1;E>=0;E--){const P=T[E],z=P.subtype||P.metadata?.subtype;if(P.type!=="result"&&!(P.type==="system"&&z==="init")&&!(P.type==="system"&&z==="task_notification")&&!(P.type==="permission_request"||P.type==="permission_response")){if(P.type==="user"&&P.metadata?.has_tool_results){const N=P.content||"";if(N.match(/^Tool results?: \d+ results?$/i)||N.trim()==="")continue}if(P.type==="user"){const N=P.content||"";if(N.includes("<command-message>")&&N.includes("skill is running")||N.startsWith("Base directory for this skill:"))continue}if(P.type==="user"){const N=P.content||"";if(N.includes("<command-message>")&&N.includes("<command-name>")&&N.includes("<command-args>")||N.includes("ARGUMENTS:")&&(N.includes("<command-name>")||N.match(/\nARGUMENTS:/)))continue}if(!(P.type==="system"&&P.content==="System message")&&!(P.type==="assistant"&&P.content==="Assistant response")&&(P.type==="user"||P.type==="assistant"||P.type==="system"))return{content:P.content,type:P.type,timestamp:P.timestamp}}}return null}),f=v(()=>{if(!t.minionData)return null;const T={...t.minionData};return p.value&&(T.state=p.value.state,T.is_processing=p.value.is_processing,p.value.name&&(T.name=p.value.name),p.value.latest_message&&(T.latest_message=p.value.latest_message,T.latest_message_type=p.value.latest_message_type,T.latest_message_time=p.value.latest_message_time)),m.value&&(T.latest_message=m.value.content,T.latest_message_type=m.value.type,T.latest_message_time=m.value.timestamp),T}),u=v(()=>t.level*24),w=v(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),g=v(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),k=v(()=>t.minionData&&t.minionData.is_overseer&&g.value),$=v(()=>{const T=f.value;return T?T.state==="paused"&&T.is_processing?"pending-prompt":T.is_processing?"processing":T.state||"created":"created"}),y=v(()=>{const T=$.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[T]||"status-dot-grey"}),d=v(()=>{const T=$.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[T]||"#d3d3d3"}}),h=v(()=>{const T=f.value;if(!T||!T.latest_message_type)return"";const E=T.latest_message_type;return E==="user"?"User -->:":E==="system"?"System:":""}),_=v(()=>{const T=f.value;if(!T||!T.latest_message)return"";const E=T.latest_message,P=150;return E.length>P?E.slice(0,P)+"...":E}),x=v(()=>{const T=f.value;if(!T||!T.latest_message_time)return"";try{const E=Date.now();let P;if(typeof T.latest_message_time=="number"?P=T.latest_message_time<3250368e4?T.latest_message_time*1e3:T.latest_message_time:P=new Date(T.latest_message_time).getTime(),isNaN(P)||P<9466848e5||P>E+6e4)return console.warn("Invalid timestamp for relative time calculation:",T.latest_message_time,"parsed to:",P),"";const z=E-P;if(z<0)return"just now";const N=Math.floor(z/6e4),W=Math.floor(N/60),K=Math.floor(W/24);return K>0?`${K}d ago`:W>0?`${W}h ago`:N>0?`${N}m ago`:"just now"}catch(E){return console.error("Error calculating relative time:",E,T.latest_message_time),""}});function C(T){return T.to_user?"User":T.to_minion_name?T.to_minion_name:"unknown"}function B(T){const E=T.summary||T.content||"";return E.length>150?E.substring(0,150)+"...":E}function j(){o("minion-click",t.minionData.id)}function M(){const T=i.sessions.get(t.minionData.id);T&&l.showModal("edit-session",{session:T})}function V(){const T=i.sessions.get(t.minionData.id);T&&l.showModal("manage-session",{session:T})}return(T,E)=>{const P=vo("MinionTreeNode",!0);return n.minionData?(a(),c("div",{key:0,class:"minion-tree-node",style:Ke({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),c("div",{key:0,class:te(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:j},[s("div",{class:te(["status-dot me-2",y.value]),style:Ke(d.value)},null,6),s("div",xy,[s("div",Ay,[k.value?(a(),c("span",My,"ðŸ‘‘")):A("",!0),s("strong",null,b(f.value?.name||n.minionData.name),1),k.value?(a(),c("span",Oy,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),f.value?.latest_message?(a(),c("div",Dy,[h.value?(a(),c("span",Ly,b(h.value),1)):A("",!0),s("span",{class:"activity-content",title:f.value.latest_message},b(_.value),9,Ny),x.value?(a(),c("span",jy,"("+b(x.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(a(),c("div",Iy,[s("span",Py,[E[1]||(E[1]=ae("â†’ ",-1)),s("strong",null,b(C(n.minionData.last_comm)),1),E[2]||(E[2]=ae(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},b(B(n.minionData.last_comm)),9,Ry)])):(a(),c("div",By," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:he(M,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:he(V,["stop"])}," âš™ï¸ ")],2)):(a(),c("div",{key:1,class:te(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:j},[s("div",Wy,[s("div",Fy,[s("div",{class:te(["status-dot me-2",y.value]),style:Ke(d.value)},null,6),k.value?(a(),c("span",Hy,"ðŸ‘‘")):A("",!0),s("strong",null,b(f.value?.name||n.minionData.name),1),k.value?(a(),c("span",Vy,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),s("div",Uy,[f.value?.latest_message?(a(),c("div",qy,[h.value?(a(),c("span",zy,b(h.value),1)):A("",!0),s("span",{class:"message-content",title:f.value.latest_message},b(_.value),9,Ky),x.value?(a(),c("span",Gy,"("+b(x.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(a(),c("div",Yy,[s("span",Jy,[E[3]||(E[3]=ae("â†’ ",-1)),s("strong",null,b(C(n.minionData.last_comm)),1),E[4]||(E[4]=ae(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},b(B(n.minionData.last_comm)),9,Qy)])):(a(),c("div",Xy," No activity yet "))]),s("div",Zy,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:he(M,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:he(V,["stop"])}," âš™ï¸ ")])])],2)),g.value?(a(),c("div",e1,[(a(!0),c(le,null,ce(n.minionData.children,z=>(a(),$e(P,{key:z.id,"minion-data":z,level:n.level+1,layout:n.layout,onMinionClick:E[0]||(E[0]=N=>T.$emit("minion-click",N))},null,8,["minion-data","level","layout"]))),128))])):A("",!0)],4)):(a(),c("div",t1," âš  Minion data is missing "))}}},ki=ne(s1,[["__scopeId","data-v-64b23e0e"]]),n1={class:"project-overview d-flex flex-column h-100"},o1={class:"project-overview-header border-bottom p-3"},i1={class:"d-flex align-items-center justify-content-between"},a1={class:"mb-1"},r1={key:0,class:"me-2"},l1={class:"text-muted font-monospace"},c1={class:"d-flex gap-2"},u1=["title"],d1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},m1={key:0,class:"text-center py-5"},p1={key:1,class:"alert alert-danger"},f1={key:2,class:"text-center py-5"},v1={key:3},h1={class:"row g-3 mb-4"},_1={class:"col-md-4"},g1={class:"card h-100"},b1={class:"card-body"},y1={class:"card-title mb-0"},w1={class:"text-muted"},$1={class:"col-md-4"},k1={class:"card h-100"},S1={class:"card-body"},E1={class:"card-title mb-0"},C1={class:"text-muted"},T1={key:0,class:"card mb-4"},x1={class:"card mb-4"},A1={class:"card-header d-flex align-items-center justify-content-between"},M1={class:"mb-0"},O1={class:"badge bg-secondary"},D1={class:"card-body"},L1={key:0,class:"text-center py-4"},N1={key:1,class:"text-center text-muted py-4"},j1={key:2,class:"hierarchy-tree"},I1={class:"user-root-node mb-3 border rounded bg-white"},P1={class:"node-row"},R1={class:"node-left"},B1={class:"badge bg-primary ms-2"},W1={class:"node-right"},F1={key:0,class:"last-comm-preview"},H1={class:"comm-direction"},V1=["title"],U1={key:1,class:"text-muted fst-italic"},q1={class:"root-minions ms-4"},z1={class:"card"},K1={class:"card-body"},G1={class:"row mb-0"},Y1={class:"col-sm-8 font-monospace text-break"},J1={class:"col-sm-8 font-monospace text-break"},Q1={class:"col-sm-8"},X1={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},Z1={class:"text-muted"},ew={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Ft(),o=Re(),i=de(),r=be(),l=_s(),p=ot(),m=R(!1),f=R(null),u=R(null),w=R(!1);let g=null;const k=v(()=>o.getProject(e.projectId)),$=v(()=>k.value?.session_ids?k.value.session_ids.map(W=>i.getSession(W)).filter(W=>W!=null):[]),y=v(()=>$.value.length>0),d=v(()=>$.value.length),h=v(()=>$.value.filter(W=>W.state==="ACTIVE").length),_=v(()=>{const W=$.value.some(D=>D.state==="ACTIVE"),K=$.value.some(D=>D.is_processing);return $.value.some(D=>D.state==="ERROR")?"Error":K?"Working":W?"Active":d.value>0?"Idle":"Empty"}),x=v(()=>{switch(_.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),C=v(()=>{switch(_.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function B(){w.value=!0;try{const W=await me.get(`/api/legions/${e.projectId}/hierarchy`);u.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),u.value=null}finally{w.value=!1}}function j(W,K){if(W&&W.id===K)return W;if(W&&W.children)for(const Z of W.children){const D=j(Z,K);if(D)return D}return null}function M(W){return W.to_user?"User":W.to_minion_name?W.to_minion_name:"unknown"}function V(W){const K=W.summary||W.content||"";return K.length>150?K.substring(0,150)+"...":K}function T(W){if(u.value){if(W.from_minion_id){const K=j(u.value,W.from_minion_id);K&&K.type==="minion"&&(K.last_comm=W)}W.from_user&&u.value.type==="user"&&(u.value.last_comm=W)}}function E(W){t.push(`/session/${W}`)}function P(){t.push(`/timeline/${e.projectId}`)}function z(){r.showModal("edit-project",{project:k.value})}function N(){r.showModal("create-minion",{project:k.value})}return ke(()=>{o.selectProject(e.projectId),i.currentSessionId=null,B(),l.setCurrentLegion(e.projectId),p.connectLegion(e.projectId),g=ve(()=>i.sessions,W=>{if(u.value){for(const[K,Z]of W)if(Z.project_id===e.projectId){const D=j(u.value,K);D&&D.type==="minion"&&(D.state!==Z.state&&(D.state=Z.state),D.is_processing!==Z.is_processing&&(D.is_processing=Z.is_processing),D.latest_message!==Z.latest_message&&(D.latest_message=Z.latest_message,D.latest_message_type=Z.latest_message_type,D.latest_message_time=Z.latest_message_time))}}},{deep:!0}),ve(()=>l.commsByLegion.get(e.projectId),W=>{if(W&&W.length>0){const K=W[W.length-1];T(K)}},{deep:!0}),ve(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(W,K)=>{W!==K&&B()})}),ve(()=>e.projectId,W=>{o.selectProject(W),i.currentSessionId=null,B(),l.setCurrentLegion(W),p.connectLegion(W)}),Te(()=>{g&&g()}),(W,K)=>(a(),c("div",n1,[s("div",o1,[s("div",i1,[s("div",null,[s("h4",a1,[y.value?(a(),c("span",r1,"ðŸ›")):A("",!0),ae(" "+b(k.value?.name||"Project Overview"),1)]),s("small",l1,b(k.value?.working_directory),1)]),s("div",c1,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:z}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:y.value?"Create minion":"Add session",onClick:N}," âž• "+b(y.value?"Add Minion":"Add Session"),9,u1)])])]),s("div",d1,[m.value?(a(),c("div",m1,[...K[0]||(K[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(a(),c("div",p1,b(f.value),1)):k.value?(a(),c("div",v1,[s("div",h1,[s("div",_1,[s("div",g1,[s("div",b1,[K[2]||(K[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",y1,b(d.value),1),s("small",w1,b(h.value)+" active",1)])])]),s("div",$1,[s("div",k1,[s("div",S1,[K[3]||(K[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",E1,[s("span",{class:te(x.value)},b(_.value),3)]),s("small",C1,b(C.value),1)])])])]),y.value?(a(),c("div",T1,[K[4]||(K[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:P}," ðŸ“Š View Timeline ")])])])):A("",!0),s("div",x1,[s("div",A1,[s("h5",M1,"ðŸŒ³ "+b(y.value?"Minion Hierarchy":"Sessions"),1),s("span",O1,b($.value.length),1)]),s("div",D1,[w.value?(a(),c("div",L1,[...K[5]||(K[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),c("div",N1,' No sessions yet. Click "Add Session" to create one. ')):(a(),c("div",j1,[s("div",I1,[s("div",P1,[s("div",R1,[K[6]||(K[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,b(u.value.name),1),s("span",B1,b(u.value.children.length)+" "+b(u.value.children.length===1?"minion":"minions"),1)]),s("div",W1,[u.value.last_comm?(a(),c("div",F1,[s("span",H1,[K[7]||(K[7]=ae(" â†’ ",-1)),s("strong",null,b(M(u.value.last_comm)),1),K[8]||(K[8]=ae(": ",-1))]),s("span",{class:"comm-content",title:u.value.last_comm.content||""},b(V(u.value.last_comm)),9,V1)])):(a(),c("div",U1," No communications yet "))])])]),s("div",q1,[(a(!0),c(le,null,ce(u.value.children,Z=>(a(),$e(ki,{key:Z.id,"minion-data":Z,level:1,layout:"two-column",onMinionClick:E},null,8,["minion-data"]))),128))])]))])]),s("div",z1,[K[12]||(K[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",K1,[s("dl",G1,[K[9]||(K[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",Y1,b(k.value.working_directory),1),K[10]||(K[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",J1,b(k.value.project_id),1),K[11]||(K[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",Q1,b(y.value?"Yes (has minions)":"No"),1)])])])])):(a(),c("div",f1,[...K[1]||(K[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",X1,[K[13]||(K[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",Z1,b(d.value)+" session"+b(d.value!==1?"s":""),1)])]))}},tw=ne(ew,[["__scopeId","data-v-168bf04c"]]),sw=[{path:"/",name:"home",component:ji},{path:"/project/:projectId",name:"project",component:tw,props:!0},{path:"/session/:sessionId",name:"session",component:jb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Ty,props:!0}],nw=Ei({history:Ci(),routes:sw}),ow={class:"connection-indicators"},iw=["title"],aw=["title"],rw=["title"],lw={__name:"ConnectionIndicator",setup(n){const e=ot();function t(i){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:p}=r[i];return p>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const r={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},p={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:m,retryCount:f}=p[i];let u="Disconnected";return m?u="Connected":f>0&&(u=`Reconnecting (attempt ${f})`),`${r[i]}
${l[i]}
Status: ${u}`}return(i,r)=>(a(),c("div",ow,[s("div",{class:te(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,iw),s("div",{class:te(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,aw),s("div",{class:te(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,rw)]))}},cw=ne(lw,[["__scopeId","data-v-d35b07c8"]]),uw={class:"d-flex align-items-center gap-2"},dw={__name:"AppHeader",setup(n){const e=be();function t(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(i,r)=>(a(),c("header",{class:te(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",ye(e).isRedBackground?"theme-red-header":"bg-white"])},[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...r[1]||(r[1]=[s("span",null,"â˜°",-1)])]),r[2]||(r[2]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",uw,[s("button",{class:te(["btn btn-sm",ye(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:r[0]||(r[0]=l=>ye(e).toggleBackgroundColor())},[s("span",{class:"color-swatch",style:Ke({backgroundColor:ye(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),fe(cw),s("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...r[3]||(r[3]=[s("span",null,"â–¤",-1)])])])],2))}},mw=ne(dw,[["__scopeId","data-v-1c36e730"]]),pw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},fw={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},vw=["title"],hw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(p){return p.state==="paused"&&p.is_processing?"pending-prompt":p.is_processing?"processing":p.state}function i(p){const m=o(p);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[m]||"#d3d3d3"}function r(p){const m=o(p);return m==="starting"||m==="processing"||m==="pending-prompt"}function l(p){const m=o(p),f=m.charAt(0).toUpperCase()+m.slice(1),u=p.name||"Unnamed Session",w=p.role?` (${p.role})`:"";return`${u}${w}: ${f}`}return(p,m)=>(a(),c("div",pw,[!n.sessions||n.sessions.length===0?(a(),c("div",fw)):(a(!0),c(le,{key:1},ce(n.sessions,f=>(a(),c("div",{key:f.session_id,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":r(f)}]),style:Ke({width:t.value,backgroundColor:i(f),cursor:"help"}),title:l(f)},null,14,vw))),128))]))}},_w=ne(hw,[["__scopeId","data-v-391d77c1"]]),gw=["data-project-id"],bw=["id"],yw=["aria-expanded","aria-controls","aria-label","onKeydown"],ww=["aria-label","onKeydown"],$w={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},kw={class:"fw-semibold",style:{"flex-shrink":"0"}},Sw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Ew={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Cw=["title"],Tw=["title"],xw=["id","aria-labelledby"],Aw={class:"accordion-body p-0"},Mw={class:"list-group list-group-flush"},Ow={class:"minion-hierarchy-container"},Dw={key:0,class:"text-center py-2"},Lw={key:2,class:"text-muted text-center py-2 small"},Nw={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ft(),o=Re(),i=de(),r=be(),l=R(e.project.is_expanded||!1),p=R(null),m=R(!1);let f=null;const u=v(()=>o.formatPath(e.project.working_directory)),w=v(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(N=>i.getSession(N)).filter(N=>N!=null)),g=v(()=>w.value.length>0),k=v(()=>{const N=t.currentRoute.value;return N.name==="timeline"&&N.params.legionId===e.project.project_id}),$=v(()=>{const N=t.currentRoute.value;return N.name==="project"&&N.params.projectId===e.project.project_id});function y(N){const W=window.bootstrap;if(!W)return;const K=document.getElementById(`collapse-${e.project.project_id}`);if(!K)return;W.Collapse.getOrCreateInstance(K).toggle(),l.value=!l.value}function d(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function h(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function _(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const N=i.currentSessionId;N&&i.getSession(N)&&e.project.session_ids?.includes(N)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function x(){r.showModal("edit-project",{project:e.project})}function C(){r.showModal("create-minion",{project:e.project})}function B(){t.push(`/timeline/${e.project.project_id}`)}async function j(){m.value=!0;try{const N=await me.get(`/api/legions/${e.project.project_id}/hierarchy`);p.value=N}catch(N){console.error("Failed to load minion hierarchy:",N),p.value=null}finally{m.value=!1}}function M(N){t.push(`/session/${N}`)}function V(N,W){if(N&&N.id===W)return N;if(N&&N.children)for(const K of N.children){const Z=V(K,W);if(Z)return Z}return null}ve(l,N=>{N&&j()}),ke(()=>{f=ve(()=>i.sessions,N=>{if(!(!p.value||!l.value)){for(const[W,K]of N)if(K.project_id===e.project.project_id){const Z=V(p.value,W);Z&&Z.type==="minion"&&(Z.state!==K.state&&(Z.state=K.state),Z.is_processing!==K.is_processing&&(Z.is_processing=K.is_processing),Z.latest_message!==K.latest_message&&(Z.latest_message=K.latest_message,Z.latest_message_type=K.latest_message_type,Z.latest_message_time=K.latest_message_time))}}},{deep:!0}),ve(()=>i.sessions.size,(N,W)=>{if(l.value&&(N>W&&Array.from(i.sessions.values()).some(D=>D.project_id===e.project.project_id&&(!p.value||!V(p.value,D.session_id)))&&(console.log("New minion detected, reloading hierarchy"),j()),N<W&&p.value)){const K=i.sessions,Z=D=>D.type==="minion"&&!K.has(D.id)?!0:D.children?D.children.some(L=>Z(L)):!1;Z(p.value)&&(console.log("Minion deletion detected, reloading hierarchy"),j())}}),l.value&&j()}),Te(()=>{f&&f()});function T(N){N.dataTransfer.effectAllowed="move",N.dataTransfer.setData("application/project-id",e.project.project_id),N.dataTransfer.setData("text/plain",e.project.project_id),N.target.classList.add("dragging")}function E(N){N.target.classList.remove("dragging")}function P(N){N.preventDefault(),N.dataTransfer.dropEffect="move";const W=N.currentTarget.getBoundingClientRect(),K=W.top+W.height/2;N.clientY<K?(N.currentTarget.classList.add("drop-above"),N.currentTarget.classList.remove("drop-below")):(N.currentTarget.classList.add("drop-below"),N.currentTarget.classList.remove("drop-above"))}function z(N){N.preventDefault(),N.currentTarget.classList.remove("drop-above","drop-below");const W=N.dataTransfer.getData("application/project-id")||N.dataTransfer.getData("text/plain");if(!W||W===e.project.project_id)return;const K=N.currentTarget.getBoundingClientRect(),Z=K.top+K.height/2,D=N.clientY<Z,L=o.orderedProjects,O=L.findIndex(ee=>ee.project_id===e.project.project_id),S=L.findIndex(ee=>ee.project_id===W);if(O===-1||S===-1)return;const I=[...L],[G]=I.splice(S,1);let Q=D?O:O+1;S<O&&Q--,I.splice(Q,0,G);const Y=I.map(ee=>ee.project_id);o.reorderProjects(Y)}return(N,W)=>(a(),c("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:T,onDragend:E,onDragover:P,onDrop:z},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:te(["accordion-button bg-white p-2 project-header-split",{collapsed:!l.value,"project-selected":$.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":l.value?"Collapse session list":"Expand session list",onClick:he(y,["stop"]),onKeydown:[ze(he(y,["prevent"]),["enter"]),ze(he(y,["prevent"]),["space"])]},[(a(),c("svg",{class:te(["chevron-icon",{expanded:l.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...W[0]||(W[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,yw),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:d,onKeydown:[ze(he(d,["prevent"]),["enter"]),ze(he(d,["prevent"]),["space"])]},[s("div",$w,[s("div",kw,[g.value?(a(),c("span",Sw,"ðŸ›")):A("",!0),ae(" "+b(n.project.name),1)]),s("div",Ew,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:he(x,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:he(C,["stop"])}," âž• ",8,Cw)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},b(u.value),9,Tw)],40,ww)],2)],8,bw),fe(_w,{project:n.project,sessions:w.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:te(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:_},[s("div",Aw,[s("div",Mw,[g.value?(a(),c("div",{key:0,class:te(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:k.value}]),style:{cursor:"pointer"},onClick:B},[...W[1]||(W[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):A("",!0),s("div",Ow,[m.value?(a(),c("div",Dw,[...W[2]||(W[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):p.value&&p.value.children&&p.value.children.length>0?(a(!0),c(le,{key:1},ce(p.value.children,K=>(a(),$e(ki,{key:K.id,"minion-data":K,level:0,layout:"sidebar",onMinionClick:M},null,8,["minion-data"]))),128)):(a(),c("div",Lw," No sessions "))])])])],42,xw)],40,gw))}},jw=ne(Nw,[["__scopeId","data-v-a15b34e8"]]),Iw={class:"project-list"},Pw={key:0,class:"text-muted text-center py-3"},Rw={__name:"ProjectList",setup(n){const e=Re(),t=v(()=>e.orderedProjects);return(o,i)=>(a(),c("div",Iw,[t.value.length===0?(a(),c("div",Pw,' No projects yet. Click "New" to create one. ')):A("",!0),(a(!0),c(le,null,ce(t.value,r=>(a(),$e(jw,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},Bw={class:"flex-grow-1 overflow-auto p-3"},Ww={id:"sessions-container"},Fw={__name:"Sidebar",setup(n){const e=be(),t=v(()=>e.sidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function r(){e.showModal("create-project")}const l=R(!1);function p(u){l.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)}function m(u){l.value&&e.setSidebarWidth(u.clientX)}function f(){l.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}return(u,w)=>(a(),c("aside",{id:"sidebar",class:te(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value,"theme-red-panel":ye(e).isRedBackground,"bg-light":!ye(e).isRedBackground}]),style:Ke(i.value)},[s("div",Bw,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),s("div",Ww,[fe(Rw)])]),s("div",{class:"sidebar-resize-handle",onMousedown:p},null,32)],6))}},Hw=ne(Fw,[["__scopeId","data-v-d26424cf"]]),Vw={class:"task-row d-flex align-items-center gap-2"},Uw={key:0,class:"status-icon"},qw={key:1,class:"status-icon"},zw=["title"],Kw={key:0,class:"task-details"},Gw={key:0,class:"task-description mb-2"},Yw={class:"description-content"},Jw={key:1,class:"task-owner mb-2"},Qw={class:"ms-1"},Xw={key:2,class:"task-blocked-by mb-2"},Zw={key:3,class:"task-blocks"},e$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=v(()=>e.task.status==="in_progress"),o=v(()=>e.task.status==="completed"?"âœ…":"â³"),i=v(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=v(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(l,p)=>(a(),c("div",{class:te(["task-item",r.value]),onClick:p[0]||(p[0]=m=>l.$emit("toggle"))},[s("div",Vw,[t.value?(a(),c("span",Uw,[...p[1]||(p[1]=[s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),c("span",qw,b(o.value),1)),s("span",{class:"task-text flex-grow-1",title:n.task.subject},b(i.value),9,zw),(a(),c("svg",{class:te(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...p[2]||(p[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),c("div",Kw,[n.task.description?(a(),c("div",Gw,[p[3]||(p[3]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",Yw,b(n.task.description),1)])):A("",!0),n.task.owner?(a(),c("div",Jw,[p[4]||(p[4]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",Qw,b(n.task.owner),1)])):A("",!0),n.task.blockedBy?.length>0?(a(),c("div",Xw,[p[5]||(p[5]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),c(le,null,ce(n.task.blockedBy,m=>(a(),c("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+b(m),1))),128))])):A("",!0),n.task.blocks?.length>0?(a(),c("div",Zw,[p[6]||(p[6]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),c(le,null,ce(n.task.blocks,m=>(a(),c("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+b(m),1))),128))])):A("",!0)])):A("",!0)],2))}},t$=ne(e$,[["__scopeId","data-v-0f96ae87"]]),s$={class:"task-list-panel"},n$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},o$={class:"d-flex align-items-center gap-2"},i$={key:0,class:"badge bg-secondary"},a$=["title"],r$={key:0,class:"task-list p-2"},l$={key:0,class:"text-muted text-center py-4"},c$={__name:"TaskListPanel",setup(n){const e=Rt();be();const t=R(new Set),o=R(!1),i=v(()=>e.currentTasks),r=v(()=>e.currentTaskStats);function l(){o.value=!o.value}function p(m){t.value.has(m)?t.value.delete(m):t.value.add(m),t.value=new Set(t.value)}return(m,f)=>(a(),c("div",s$,[s("div",n$,[s("div",o$,[f[0]||(f[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),f[1]||(f[1]=s("h6",{class:"mb-0"},"Tasks",-1)),r.value.total>0?(a(),c("span",i$,b(r.value.completed)+"/"+b(r.value.total),1)):A("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:l,title:o.value?"Expand":"Collapse"},[(a(),c("svg",{class:te(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,a$)]),o.value?A("",!0):(a(),c("div",r$,[i.value.length===0?(a(),c("div",l$,[...f[3]||(f[3]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):A("",!0),fe(Ti,{name:"task-list",tag:"div"},{default:ho(()=>[(a(!0),c(le,null,ce(i.value,u=>(a(),$e(t$,{key:u.id,task:u,isExpanded:t.value.has(u.id),onToggle:w=>p(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},u$=ne(c$,[["__scopeId","data-v-c03a807a"]]),d$={class:"resource-gallery-panel"},m$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},p$={class:"d-flex align-items-center gap-2"},f$={key:0,class:"badge bg-secondary"},v$=["title"],h$={key:0,class:"resource-grid-container p-2"},_$={key:0,class:"text-muted text-center py-4"},g$={key:1,class:"resource-grid"},b$=["onClick","title"],y$=["src","alt"],w$=["title","onClick"],$$={class:"file-icon"},k$={class:"file-ext"},S$={class:"resource-info"},E$=["title"],C$={class:"resource-actions"},T$=["onClick"],x$=["href","download"],A$={__name:"ResourceGallery",setup(n){const e=Ze(),t=de(),o=fo("addAttachmentFromResource",null),i=R(!1),r=v(()=>e.currentResources),l=v(()=>e.currentResourceCount);function p(){i.value=!i.value}function m(h){return e.isImageResource(h)}function f(h){return e.getResourceIcon(h)}function u(h){const _=e.getResourceExtension(h);return _?_.toUpperCase().slice(1):""}function w(h){return e.getResourceUrl(t.currentSessionId,h)}function g(h){return e.getDownloadUrl(t.currentSessionId,h)}function k(h){e.openFullView(t.currentSessionId,h)}function $(h,_=18){return h?h.length<=_?h:h.substring(0,_-3)+"...":""}function y(h){h.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function d(h){o?o(h):console.warn("addAttachmentFromResource not provided")}return(h,_)=>(a(),c("div",d$,[s("div",m$,[s("div",p$,[_[1]||(_[1]=s("span",{class:"panel-icon"},"ðŸ“",-1)),_[2]||(_[2]=s("h6",{class:"mb-0"},"Resources",-1)),l.value>0?(a(),c("span",f$,b(l.value),1)):A("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:p,title:i.value?"Expand":"Collapse"},[(a(),c("svg",{class:te(["chevron-icon",{expanded:!i.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[..._[3]||(_[3]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,v$)]),i.value?A("",!0):(a(),c("div",h$,[r.value.length===0?(a(),c("div",_$,[..._[4]||(_[4]=[s("span",{class:"empty-icon"},"ðŸ“‚",-1),s("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),c("div",g$,[(a(!0),c(le,null,ce(r.value,(x,C)=>(a(),c("div",{key:x.resource_id,class:te(["resource-item",{"is-image":m(x)}])},[m(x)?(a(),c("div",{key:0,class:"resource-thumbnail",onClick:B=>k(C),title:x.title||"Click to view"},[s("img",{src:w(x.resource_id),alt:x.title||"Image",loading:"lazy",onError:y},null,40,y$)],8,b$)):(a(),c("div",{key:1,class:"resource-placeholder",title:x.title||x.original_filename||"Click to view",onClick:B=>k(C)},[s("span",$$,b(f(x)),1),s("span",k$,b(u(x)),1)],8,w$)),s("div",S$,[s("div",{class:"resource-title",title:x.title||x.original_filename},b($(x.title||x.original_filename)),9,E$),s("div",C$,[s("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:he(B=>d(x),["stop"]),title:"Add to message attachments"},[..._[5]||(_[5]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,T$),s("a",{href:g(x.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:x.original_filename||x.title||"download",title:"Download",onClick:_[0]||(_[0]=he(()=>{},["stop"]))},[..._[6]||(_[6]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),s("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,x$)])])],2))),128))]))]))]))}},M$=ne(A$,[["__scopeId","data-v-5f68c476"]]),O$=["src","alt"],D$={key:1,class:"resource-info"},L$={key:0,class:"resource-title"},N$={key:1,class:"resource-description"},j$={class:"resource-meta"},I$={class:"meta-item"},P$={class:"meta-item"},R$={class:"meta-item"},B$={class:"text-header"},W$={class:"text-header-info"},F$={class:"text-filename"},H$={class:"resource-meta"},V$={key:0,class:"meta-item"},U$={key:1,class:"meta-item"},q$=["title","disabled"],z$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},K$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},G$={class:"copy-label"},Y$={class:"text-body"},J$={key:0,class:"text-loading"},Q$={key:1,class:"text-error"},X$={key:2,class:"text-content"},Z$={key:3,class:"text-unavailable"},ek={key:4,class:"position-indicator"},tk={key:5,class:"thumbnail-strip"},sk=["onClick"],nk=["src","alt"],ok={key:1,class:"strip-text-icon"},ik={__name:"ResourceFullView",setup(n){const e=Ze(),t=R(null),o=R(!1);let i=null;const r=v(()=>e.fullViewOpen),l=v(()=>e.currentFullViewResource),p=v(()=>e.currentResourceIndex),m=v(()=>e.fullViewTotalResources),f=v(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),u=v(()=>e.isImageResource(l.value)),w=v(()=>l.value?e.getTextContent(l.value.resource_id):null),g=v(()=>w.value?.content||null),k=v(()=>w.value?.loading||!1),$=v(()=>w.value?.error||null);ve(r,E=>{E?(kt(()=>{t.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),ve([p,r],()=>{if(r.value&&l.value&&!u.value){const E=l.value.resource_id,P=e.getTextContent(E);(!P||P.error)&&e.fetchTextContent(e.fullViewSessionId,E)}},{immediate:!0}),Te(()=>{document.body.style.overflow="",i&&clearTimeout(i)});function y(E){return e.getResourceUrl(e.fullViewSessionId,E)}function d(){e.closeFullView()}function h(){e.nextResource()}function _(){e.prevResource()}function x(E){e.goToResource(E)}function C(E){E.target===E.currentTarget&&d()}function B(E){switch(E.key){case"Escape":d();break;case"ArrowLeft":_();break;case"ArrowRight":h();break;case"Home":x(0);break;case"End":x(m.value-1);break}}async function j(){if(g.value)try{await navigator.clipboard.writeText(g.value),o.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function M(E){return E?E<1024?`${E} B`:E<1024*1024?`${(E/1024).toFixed(1)} KB`:`${(E/(1024*1024)).toFixed(2)} MB`:""}function V(E){return E?new Date(E*1e3).toLocaleString():""}function T(E){E.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(E,P)=>(a(),$e(Ai,{to:"body"},[fe(xi,{name:"modal"},{default:ho(()=>[r.value?(a(),c("div",{key:0,class:"resource-full-view-overlay",onClick:C,onKeydown:B,tabindex:"0",ref_key:"overlayRef",ref:t},[s("button",{class:"close-btn",onClick:he(d,["stop"]),title:"Close (Escape)"},[...P[2]||(P[2]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(a(),c("button",{key:0,class:"nav-btn nav-prev",onClick:he(_,["stop"]),title:"Previous (Left Arrow)"},[...P[3]||(P[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"15 18 9 12 15 6"})],-1)])])):A("",!0),u.value?(a(),c("div",{key:1,class:"image-container",onClick:P[0]||(P[0]=he(()=>{},["stop"]))},[l.value?(a(),c("img",{key:0,src:y(l.value.resource_id||l.value.image_id),alt:l.value.title||"Image",class:"full-image",onError:T},null,40,O$)):A("",!0),l.value?(a(),c("div",D$,[l.value.title?(a(),c("h5",L$,b(l.value.title),1)):A("",!0),l.value.description?(a(),c("p",N$,b(l.value.description),1)):A("",!0),s("div",j$,[s("span",I$,b(M(l.value.size_bytes)),1),s("span",P$,b(l.value.format?.toUpperCase()),1),s("span",R$,b(V(l.value.timestamp)),1)])])):A("",!0)])):(a(),c("div",{key:2,class:"text-container",onClick:P[1]||(P[1]=he(()=>{},["stop"]))},[s("div",B$,[s("div",W$,[s("h5",F$,b(l.value?.title||l.value?.original_filename||"Text Resource"),1),s("div",H$,[l.value?.size_bytes?(a(),c("span",V$,b(M(l.value.size_bytes)),1)):A("",!0),l.value?.format?(a(),c("span",U$,b(l.value.format.toUpperCase()),1)):A("",!0)])]),s("button",{class:"copy-btn",onClick:he(j,["stop"]),title:o.value?"Copied!":"Copy to clipboard",disabled:!g.value},[o.value?(a(),c("svg",z$,[...P[4]||(P[4]=[s("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),c("svg",K$,[...P[5]||(P[5]=[s("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),s("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),s("span",G$,b(o.value?"Copied!":"Copy"),1)],8,q$)]),s("div",Y$,[k.value?(a(),c("div",J$,[...P[6]||(P[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),s("span",null,"Loading content...",-1)])])):$.value?(a(),c("div",Q$," Failed to load content: "+b($.value),1)):g.value?(a(),c("pre",X$,b(g.value),1)):(a(),c("div",Z$," Preview not available for this file type. "))])])),m.value>1?(a(),c("button",{key:3,class:"nav-btn nav-next",onClick:he(h,["stop"]),title:"Next (Right Arrow)"},[...P[7]||(P[7]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"9 18 15 12 9 6"})],-1)])])):A("",!0),m.value>1?(a(),c("div",ek,b(p.value+1)+" / "+b(m.value),1)):A("",!0),m.value>1?(a(),c("div",tk,[(a(!0),c(le,null,ce(f.value,(z,N)=>(a(),c("div",{key:z.resource_id||z.image_id,class:te(["strip-thumbnail",{active:N===p.value,"is-text":!ye(e).isImageResource(z)}]),onClick:he(W=>x(N),["stop"])},[ye(e).isImageResource(z)?(a(),c("img",{key:0,src:y(z.resource_id||z.image_id),alt:z.title||"Thumbnail",loading:"lazy"},null,8,nk)):(a(),c("span",ok,b(ye(e).getResourceIcon(z)),1))],10,sk))),128))])):A("",!0)],544)):A("",!0)]),_:1})]))}},ak=ne(ik,[["__scopeId","data-v-7b13db33"]]),rk={class:"panels-container"},lk={__name:"RightSidebar",setup(n){const e=be(),t=v(()=>e.rightSidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const f=`${e.rightSidebarWidth}px`;return{width:f,minWidth:"200px",maxWidth:"30vw","--sidebar-width":f}}),r=R(!1);function l(f){f.preventDefault(),r.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",m)}function p(f){if(r.value){const u=window.innerWidth-f.clientX;e.setRightSidebarWidth(u)}}function m(){r.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",m)}return(f,u)=>(a(),c("aside",{id:"right-sidebar",class:te(["border-start d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,resizing:r.value,"theme-red-panel":ye(e).isRedBackground,"bg-light":!ye(e).isRedBackground}]),style:Ke(i.value)},[s("div",rk,[fe(u$),fe(M$)]),s("div",{class:"sidebar-resize-handle",onMousedown:l},null,32),fe(ak)],6))}},ck=ne(lk,[["__scopeId","data-v-6b00f313"]]),uk={class:"modal-dialog modal-lg"},dk={class:"modal-content"},mk={class:"modal-body"},pk={class:"mb-3"},fk={class:"input-group"},vk=["disabled"],hk={key:0,class:"text-center py-4"},_k={key:1,class:"alert alert-danger",role:"alert"},gk={key:2,class:"folder-list"},bk=["onClick","onDblclick"],yk={class:"d-flex align-items-center flex-grow-1"},wk=["onClick"],$k={key:1,class:"text-center text-muted py-3"},kk={class:"modal-footer"},Sk=["disabled"],Ek={__name:"FolderBrowserModal",setup(n){const e=be(),t=R(""),o=R(""),i=R([]),r=R(!1),l=R(""),p=R(null);let m=null,f=null;const u=v(()=>{if(!t.value)return null;const x=t.value.split(/[\\/]/).filter(Boolean);return x.length<=1?null:(x.pop(),x.length>0?"/"+x.join("/"):"/")});function w(x){if(!x)return"";const C=x.split(/[\\/]/).filter(Boolean);return C.length<=2?x:".../"+C.slice(-2).join("/")}async function g(){r.value=!0,l.value="",i.value=[],o.value="";try{const x=t.value?{path:t.value}:{},C=await me.get("/api/filesystem/browse",{params:x});C.current_path&&(t.value=C.current_path),i.value=C.directories||[]}catch(x){console.error("Failed to load directory:",x),l.value=x.message||"Failed to load directory"}finally{r.value=!1}}function k(x){o.value=x.path}function $(x){t.value=x.path,o.value="",g()}function y(){u.value&&(t.value=u.value,o.value="",g())}function d(){const x=o.value||t.value;x&&f&&f(x),m&&m.hide()}function h(){g()}function _(){i.value=[],o.value="",l.value="",f=null,e.hideModal()}return ve(()=>e.currentModal,x=>{if(x?.name==="folder-browser"&&m){const C=x.data||{};t.value=C.defaultPath||C.currentPath||"",f=C.onSelect||null,m.show()}}),ke(()=>{p.value&&Me(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{m=new x(p.value),p.value.addEventListener("shown.bs.modal",h),p.value.addEventListener("hidden.bs.modal",_)})}),Te(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",h),p.value.removeEventListener("hidden.bs.modal",_)),m&&m.dispose()}),(x,C)=>(a(),c("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",uk,[s("div",dk,[C[6]||(C[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",mk,[s("div",pk,[C[1]||(C[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",fk,[we(s("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=B=>t.value=B),onKeyup:ze(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Fe,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:g,disabled:r.value}," ðŸ”„ Refresh ",8,vk)])]),r.value?(a(),c("div",hk,[...C[2]||(C[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(a(),c("div",_k,b(l.value),1)):(a(),c("div",gk,[u.value?(a(),c("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:y,role:"button"},[...C[3]||(C[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):A("",!0),(a(!0),c(le,null,ce(i.value,B=>(a(),c("div",{key:B.path,class:te(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:B.path===o.value}]),onClick:j=>k(B),onDblclick:j=>$(B),role:"button"},[s("div",yk,[C[4]||(C[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,b(B.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:he(j=>$(B),["stop"])}," Open ",8,wk)],42,bk))),128)),i.value.length===0?(a(),c("div",$k," No subdirectories found ")):A("",!0)]))]),s("div",kk,[C[5]||(C[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:d,disabled:!o.value},' Select "'+b(w(o.value||t.value))+'" ',9,Sk)])])])],512))}},Ck=ne(Ek,[["__scopeId","data-v-0d61ed46"]]),Tk={class:"modal-dialog"},xk={class:"modal-content"},Ak={class:"modal-body"},Mk={class:"mb-3"},Ok={key:0,class:"invalid-feedback"},Dk={class:"mb-3"},Lk={class:"input-group"},Nk={key:0,class:"invalid-feedback"},jk={class:"mb-3 form-check"},Ik={key:0,class:"mb-3 ms-4"},Pk={key:1,class:"alert alert-danger",role:"alert"},Rk={class:"modal-footer"},Bk=["disabled"],Wk={key:0,class:"spinner-border spinner-border-sm me-2"},Fk={__name:"ProjectCreateModal",setup(n){const e=Re(),t=de(),o=be(),i=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=R({name:"",workingDirectory:""}),l=R(!1),p=R(""),m=R(null);let f=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:d=>{i.value.workingDirectory=d,r.value.workingDirectory=""}})}function w(){r.value={};let d=!0;return i.value.name.trim()||(r.value.name="Project name is required",d=!1),i.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",d=!1),d}async function g(){if(w()){l.value=!0,p.value="";try{const d=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(d.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),k()}catch(d){console.error("Failed to create project:",d),p.value=d.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function k(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},p.value=""}function $(){const d=document.getElementById("projectName");d&&d.focus()}function y(){k(),o.hideModal()}return ve(()=>o.currentModal,d=>{d?.name==="create-project"&&f&&f.show()}),ke(()=>{m.value&&Me(async()=>{const{default:d}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:d}},__vite__mapDeps([0,1])).then(({default:d})=>{f=new d(m.value),m.value.addEventListener("shown.bs.modal",$),m.value.addEventListener("hidden.bs.modal",y)})}),Te(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",$),m.value.removeEventListener("hidden.bs.modal",y)),f&&f.dispose()}),(d,h)=>(a(),c("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[s("div",Tk,[s("div",xk,[h[11]||(h[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Ak,[s("form",{onSubmit:he(g,["prevent"])},[s("div",Mk,[h[4]||(h[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),we(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=_=>i.value.name=_),placeholder:"My Project",required:""},null,2),[[Fe,i.value.name]]),r.value.name?(a(),c("div",Ok,b(r.value.name),1)):A("",!0)]),s("div",Dk,[h[5]||(h[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Lk,[we(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=_=>i.value.workingDirectory=_),placeholder:"/path/to/project",required:""},null,2),[[Fe,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),r.value.workingDirectory?(a(),c("div",Nk,b(r.value.workingDirectory),1)):A("",!0)]),h[6]||(h[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",jk,[we(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=_=>i.value.createSession=_)},null,512),[[Mi,i.value.createSession]]),h[7]||(h[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),c("div",Ik,[h[9]||(h[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),we(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=_=>i.value.sessionName=_),placeholder:"main"},null,512),[[Fe,i.value.sessionName]])])):A("",!0),p.value?(a(),c("div",Pk,b(p.value),1)):A("",!0)],32)]),s("div",Rk,[h[10]||(h[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:l.value},[l.value?(a(),c("span",Wk)):A("",!0),ae(" "+b(l.value?"Creating...":"Create Project"),1)],8,Bk)])])])],512))}},Hk=ne(Fk,[["__scopeId","data-v-ea55fdae"]]),Vk={class:"modal-dialog"},Uk={class:"modal-content"},qk={class:"modal-body"},zk={class:"mb-3"},Kk={key:0,class:"invalid-feedback"},Gk={class:"mb-3"},Yk=["value"],Jk={key:0,class:"alert alert-danger",role:"alert"},Qk={class:"danger-zone"},Xk={class:"text-muted small"},Zk=["disabled"],eS={key:0,class:"alert alert-warning mt-3",role:"alert"},tS={class:"mb-2"},sS={class:"d-flex gap-2"},nS=["disabled"],oS={key:0,class:"spinner-border spinner-border-sm me-2"},iS=["disabled"],aS={class:"modal-footer"},rS=["disabled"],lS={key:0,class:"spinner-border spinner-border-sm me-2"},cS={__name:"ProjectEditModal",setup(n){const e=Re(),t=be(),o=R(null),i=R({name:""}),r=R({name:""}),l=R(!1),p=R(!1),m=R(""),f=R(!1),u=R(null);let w=null;const g=v(()=>o.value?.session_ids?.length||0);function k(){r.value={};let x=!0;return i.value.name.trim()||(r.value.name="Project name is required",x=!1),x}async function $(){if(!(!k()||!o.value)){l.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),w&&w.hide()}catch(x){console.error("Failed to update project:",x),m.value=x.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function y(){if(o.value){p.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(x){console.error("Failed to delete project:",x),m.value=x.message||"Failed to delete project. Please try again."}finally{p.value=!1}}}function d(){i.value={name:""},r.value={},m.value="",f.value=!1}function h(){const x=document.getElementById("editProjectName");x&&(x.focus(),x.select())}function _(){d(),o.value=null,t.hideModal()}return ve(()=>t.currentModal,x=>{if(x?.name==="edit-project"&&w){const C=x.data||{};o.value=C.project,o.value&&(i.value.name=o.value.name),w.show()}}),ke(()=>{u.value&&Me(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{w=new x(u.value),u.value.addEventListener("shown.bs.modal",h),u.value.addEventListener("hidden.bs.modal",_)})}),Te(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",h),u.value.removeEventListener("hidden.bs.modal",_)),w&&w.dispose()}),(x,C)=>(a(),c("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",Vk,[s("div",Uk,[C[10]||(C[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",qk,[s("form",{onSubmit:he($,["prevent"])},[s("div",zk,[C[3]||(C[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),we(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":C[0]||(C[0]=B=>i.value.name=B),placeholder:"My Project",required:""},null,2),[[Fe,i.value.name]]),r.value.name?(a(),c("div",Kk,b(r.value.name),1)):A("",!0)]),s("div",Gk,[C[4]||(C[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Yk),C[5]||(C[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(a(),c("div",Jk,b(m.value),1)):A("",!0)],32),C[8]||(C[8]=s("hr",null,null,-1)),s("div",Qk,[C[6]||(C[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",Xk," Deleting this project will also delete all "+b(g.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:C[1]||(C[1]=B=>f.value=!0),disabled:p.value}," ðŸ—‘ï¸ Delete Project ",8,Zk)]),f.value?(a(),c("div",eS,[C[7]||(C[7]=s("strong",null,"Are you sure?",-1)),s("p",tS,' This will permanently delete the project "'+b(o.value?.name)+'" and all '+b(g.value)+" session(s). ",1),s("div",sS,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:y,disabled:p.value},[p.value?(a(),c("span",oS)):A("",!0),ae(" "+b(p.value?"Deleting...":"Yes, Delete Permanently"),1)],8,nS),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:C[2]||(C[2]=B=>f.value=!1),disabled:p.value}," Cancel ",8,iS)])])):A("",!0)]),s("div",aS,[C[9]||(C[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:$,disabled:l.value},[l.value?(a(),c("span",lS)):A("",!0),ae(" "+b(l.value?"Saving...":"Save Changes"),1)],8,rS)])])])],512))}},uS=ne(cS,[["__scopeId","data-v-52679516"]]),dS={class:"general-tab"},mS={key:0,class:"mb-3"},pS={for:"template-select",class:"form-label"},fS=["value"],vS=["value"],hS={key:0,class:"form-text"},_S={class:"mb-3"},gS={for:"config-name",class:"form-label"},bS=["value","placeholder","pattern","title"],yS={key:0,class:"invalid-feedback"},wS={key:1,class:"form-text"},$S={key:1,class:"mb-3"},kS=["value"],SS={class:"mb-3"},ES=["value"],CS={class:"form-text"},TS={key:0,class:"text-warning"},xS={key:1},AS={class:"mb-3"},MS={for:"config-permission-mode",class:"form-label"},OS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},DS={key:1,class:"field-indicator modified",title:"Modified from template"},LS=["value","disabled"],NS={key:0,value:"bypassPermissions"},jS={class:"form-text"},IS={key:0,class:"text-warning"},PS={key:1},RS={class:"mb-3"},BS={for:"config-role",class:"form-label"},WS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},FS={key:1,class:"field-indicator modified",title:"Modified from template"},HS=["value","placeholder"],VS={class:"form-text"},US={key:2,class:"mb-3"},qS={class:"input-group"},zS=["value","placeholder","disabled","readonly"],KS={class:"form-text"},GS={key:3,class:"mb-3"},YS={class:"form-control-plaintext"},JS={key:4,class:"mb-3 form-check"},QS=["checked"],XS={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=v(()=>e.mode==="create-session"||e.mode==="edit-session"),o=v(()=>e.mode==="create-template"||e.mode==="edit-template"),i=v(()=>e.mode==="create-session"),r=v(()=>e.mode==="edit-session"),l=v(()=>e.session?.state==="active"||e.session?.state==="starting"),p=v(()=>{if(!e.session)return!1;const y=e.session.model||"sonnet";return e.formData.model!==y}),m=v(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=v(()=>e.selectedTemplateId?e.templates.find(y=>y.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},w=v(()=>u[e.formData.model]||null),g=v(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),k=v(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function $(y){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[y]||"bg-secondary"}return(y,d)=>(a(),c("div",dS,[i.value?(a(),c("div",mS,[s("label",pS,[d[10]||(d[10]=ae(" Template ",-1)),s("button",{type:"button",onClick:d[0]||(d[0]=h=>y.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:d[1]||(d[1]=h=>y.$emit("update:selected-template-id",h.target.value||null)),class:"form-select"},[d[11]||(d[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),c(le,null,ce(n.templates,h=>(a(),c("option",{key:h.template_id,value:h.template_id},b(h.name),9,vS))),128))],40,fS),f.value?(a(),c("div",hS,b(f.value.description),1)):A("",!0)])):A("",!0),s("div",_S,[s("label",gS,[ae(b(o.value?"Template Name":"Session Name")+" ",1),d[12]||(d[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:te(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:d[2]||(d[2]=h=>y.$emit("update:form-data","name",h.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,bS),n.errors.name?(a(),c("div",yS,b(n.errors.name),1)):A("",!0),t.value?(a(),c("div",wS,"Must be a single word (no spaces) for #nametag matching")):A("",!0)]),o.value?(a(),c("div",$S,[d[13]||(d[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:d[3]||(d[3]=h=>y.$emit("update:form-data","description",h.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,kS)])):A("",!0),s("div",SS,[d[16]||(d[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:d[4]||(d[4]=h=>y.$emit("update:form-data","model",h.target.value))},[...d[14]||(d[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,ES),s("div",CS,[r.value&&l.value&&p.value?(a(),c("span",TS,[...d[15]||(d[15]=[ae(" Model change requires a ",-1),s("strong",null,"reset",-1),ae(" (not restart) to take effect. ",-1)])])):w.value?(a(),c("span",xS,b(w.value.description),1)):A("",!0)])]),s("div",AS,[s("label",MS,[d[17]||(d[17]=ae(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),c("span",OS," < ")):A("",!0),n.fieldStates.permission_mode==="modified"?(a(),c("span",DS," * ")):A("",!0)]),s("select",{id:"config-permission-mode",class:te(["form-select",k.value]),value:n.formData.permission_mode,onChange:d[5]||(d[5]=h=>y.$emit("update:form-data","permission_mode",h.target.value)),disabled:r.value&&!l.value},[d[18]||(d[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),d[19]||(d[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),d[20]||(d[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||m.value?(a(),c("option",NS," Bypass Permissions (No prompts - use with caution) ")):A("",!0)],42,LS),s("div",jS,[r.value&&!l.value?(a(),c("span",IS," Session must be active to change permission mode. Start the session first. ")):(a(),c("span",PS,"Controls which tool actions require permission prompts"))])]),s("div",RS,[s("label",BS,[ae(b(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),c("span",WS," < ")):A("",!0),n.fieldStates.default_role==="modified"?(a(),c("span",FS," * ")):A("",!0)]),s("input",{id:"config-role",type:"text",class:te(["form-control",g.value]),value:n.formData.default_role,onInput:d[6]||(d[6]=h=>y.$emit("update:form-data","default_role",h.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,HS),s("div",VS,b(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(a(),c("div",US,[d[21]||(d[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",qS,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:d[7]||(d[7]=h=>y.$emit("update:form-data","working_directory",h.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,zS),r.value?A("",!0):(a(),c("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:d[8]||(d[8]=h=>y.$emit("open-folder-browser"))}," Browse "))]),s("div",KS,b(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):A("",!0),r.value&&n.session?(a(),c("div",GS,[d[22]||(d[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",YS,[s("span",{class:te(["badge",$(n.session.state)])},b(n.session.state),3)])])):A("",!0),i.value?(a(),c("div",JS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:d[9]||(d[9]=h=>y.$emit("update:form-data","startImmediately",h.target.checked))},null,40,QS),d[23]||(d[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):A("",!0)]))}},ZS=ne(XS,[["__scopeId","data-v-b9edc342"]]),eE={class:"permissions-tab"},tE={class:"mb-3"},sE={for:"config-allowed-tools",class:"form-label"},nE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},oE={key:1,class:"field-indicator modified",title:"Modified from template"},iE={key:0,class:"tools-list mb-2"},aE=["onClick"],rE={class:"input-group input-group-sm"},lE=["onKeydown"],cE=["disabled"],uE={class:"mt-2"},dE=["onClick"],mE={class:"form-text"},pE={key:0,class:"text-warning"},fE={key:1},vE={class:"mb-3"},hE={class:"capabilities-editor"},_E={key:0,class:"capabilities-list mb-2"},gE=["onClick"],bE={class:"input-group input-group-sm"},yE=["onKeydown"],wE=["disabled"],$E={key:0,class:"mb-3"},kE={class:"settings-sources-editor"},SE={class:"form-check"},EE=["checked"],CE={class:"form-check"},TE=["checked"],xE={class:"form-check"},AE=["checked"],ME={class:"form-text"},OE={key:0,class:"text-warning"},DE={key:1},LE={key:1,class:"mb-3"},NE={class:"mb-3"},jE={key:0,class:"mt-2"},IE=["value"],PE=["value"],RE={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=R(""),r=R(""),l=R(!1),p=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=v(()=>t.mode==="create-template"||t.mode==="edit-template"),f=v(()=>t.mode==="create-session"||t.mode==="edit-session"),u=v(()=>t.mode==="edit-session"),w=v(()=>t.session?.state==="active"||t.session?.state==="starting"),g=v(()=>{if(!t.session)return!1;const T=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==T}),k=v(()=>t.formData.setting_sources||["user","project","local"]),$=v(()=>{if(!t.session)return!1;const T=t.session.setting_sources||["user","project","local"],E=t.formData.setting_sources||["user","project","local"];return JSON.stringify(T.sort())!==JSON.stringify(E.sort())}),y=v(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(T=>T.trim()).filter(T=>T.length>0)),d=v(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(T=>T.trim()).filter(T=>T.length>0)),h=v(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),_=v(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function x(){const T=i.value.trim();if(T){if(!y.value.includes(T)){const E=[...y.value,T];o("update:form-data","allowed_tools",E.join(", "))}i.value=""}}function C(T){const E=[...y.value];E.splice(T,1),o("update:form-data","allowed_tools",E.join(", "))}function B(T){if(y.value.includes(T)){const E=y.value.indexOf(T);C(E)}else{const E=[...y.value,T];o("update:form-data","allowed_tools",E.join(", "))}}function j(){const T=r.value.trim().toLowerCase();if(T){if(!d.value.includes(T)){const E=[...d.value,T];o("update:form-data","capabilities",E.join(", "))}r.value=""}}function M(T){const E=[...d.value];E.splice(T,1),o("update:form-data","capabilities",E.join(", "))}function V(T){const E=[...k.value],P=E.indexOf(T);P>=0?E.splice(P,1):E.push(T),o("update:form-data","setting_sources",E)}return(T,E)=>(a(),c("div",eE,[s("div",tE,[s("label",sE,[E[9]||(E[9]=ae(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),c("span",nE," < ")):A("",!0),n.fieldStates.allowed_tools==="modified"?(a(),c("span",oE," * ")):A("",!0)]),s("div",{class:te(["allowed-tools-editor",_.value])},[y.value.length>0?(a(),c("div",iE,[(a(!0),c(le,null,ce(y.value,(P,z)=>(a(),c("span",{key:z,class:"badge bg-primary me-1 mb-1 tool-badge"},[ae(b(P)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:N=>C(z),"aria-label":"Remove tool"},null,8,aE)]))),128))])):A("",!0),s("div",rE,[we(s("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=P=>i.value=P),onKeydown:ze(he(x,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,lE),[[Fe,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:x,disabled:!i.value.trim()}," Add ",8,cE)]),s("div",uE,[E[10]||(E[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),c(le,null,ce(p,P=>s("button",{key:P,type:"button",class:te(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":y.value.includes(P)}]),onClick:z=>B(P)},b(P),11,dE)),64))])],2),s("div",mE,[u.value&&w.value&&g.value?(a(),c("span",pE,[...E[11]||(E[11]=[ae(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),ae(" (not restart) to take effect. ",-1)])])):(a(),c("span",fE,b(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",vE,[E[12]||(E[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",hE,[d.value.length>0?(a(),c("div",_E,[(a(!0),c(le,null,ce(d.value,(P,z)=>(a(),c("span",{key:z,class:"badge bg-info me-1 mb-1 capability-badge"},[ae(b(P)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:N=>M(z),"aria-label":"Remove capability"},null,8,gE)]))),128))])):A("",!0),s("div",bE,[we(s("input",{type:"text",class:"form-control","onUpdate:modelValue":E[1]||(E[1]=P=>r.value=P),onKeydown:ze(he(j,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,yE),[[Fe,r.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:j,disabled:!r.value.trim()}," Add ",8,wE)])]),E[13]||(E[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(a(),c("div",$E,[E[18]||(E[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",kE,[s("div",SE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:k.value.includes("user"),onChange:E[2]||(E[2]=P=>V("user"))},null,40,EE),E[14]||(E[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[ae(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",CE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:k.value.includes("project"),onChange:E[3]||(E[3]=P=>V("project"))},null,40,TE),E[15]||(E[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[ae(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",xE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:k.value.includes("local"),onChange:E[4]||(E[4]=P=>V("local"))},null,40,AE),E[16]||(E[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[ae(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",ME,[u.value&&w.value&&$.value?(a(),c("span",OE,[...E[17]||(E[17]=[ae(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),ae(" to take effect. ",-1)])])):(a(),c("span",DE," Select which settings files to load permissions from "))])])):A("",!0),f.value?(a(),c("div",LE,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:E[5]||(E[5]=P=>T.$emit("preview-permissions"))}," Preview Effective Permissions ")])):A("",!0),s("div",NE,[s("a",{class:"text-muted small",role:"button",onClick:E[6]||(E[6]=P=>l.value=!l.value)},b(l.value?"Hide":"Show")+" raw input ",1),l.value?(a(),c("div",jE,[E[19]||(E[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:te(["form-control form-control-sm",h.value]),value:n.formData.allowed_tools,onInput:E[7]||(E[7]=P=>T.$emit("update:form-data","allowed_tools",P.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,IE),E[20]||(E[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:E[8]||(E[8]=P=>T.$emit("update:form-data","capabilities",P.target.value)),placeholder:"python, testing, debugging"},null,40,PE)])):A("",!0)])]))}},BE=ne(RE,[["__scopeId","data-v-e58aa2be"]]),WE={class:"advanced-tab"},FE={key:0,class:"alert alert-warning mb-3",role:"alert"},HE={class:"mb-3"},VE={for:"config-system-prompt",class:"form-label"},UE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},qE={key:1,class:"field-indicator modified",title:"Modified from template"},zE=["value","rows","placeholder"],KE={class:"form-text"},GE={class:"mb-3 form-check"},YE=["checked"],JE={key:0,class:"form-text text-warning"},QE={key:1,class:"mb-3 form-check"},XE=["checked"],ZE={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=v(()=>t.mode==="create-session"||t.mode==="edit-session"),r=v(()=>t.mode==="create-template"||t.mode==="edit-template"),l=v(()=>t.mode==="edit-session"),p=v(()=>t.session?.state==="active"||t.session?.state==="starting"),m=v(()=>{if(!t.session)return!1;const $=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),y=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),d=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return $||y||d}),f=v(()=>r.value?t.formData.system_prompt:t.formData.initialization_context),u=v(()=>r.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),w=v(()=>t.formData.override_system_prompt?r.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":r.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),g=v(()=>{const $={};return t.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$});function k($){const y=$.target.value,d=r.value?"system_prompt":"initialization_context";o("update:form-data",d,y)}return($,y)=>(a(),c("div",WE,[l.value&&p.value&&m.value?(a(),c("div",FE,[...y[2]||(y[2]=[s("small",null,[ae("Changes to these settings require a "),s("strong",null,"reset"),ae(" (not restart) to take effect.")],-1)])])):A("",!0),s("div",HE,[s("label",VE,[ae(b(r.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),c("span",UE," < ")):A("",!0),n.fieldStates.initialization_context==="modified"?(a(),c("span",qE," * ")):A("",!0)]),s("textarea",{id:"config-system-prompt",class:te(["form-control",g.value]),value:f.value,onInput:k,rows:r.value?4:5,placeholder:u.value},null,42,zE),s("div",KE,b(w.value),1)]),s("div",GE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:y[0]||(y[0]=d=>$.$emit("update:form-data","override_system_prompt",d.target.checked))},null,40,YE),y[3]||(y[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),c("div",JE,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+b(r.value?"":" or legion guide")+").",1)])):A("",!0)]),i.value?(a(),c("div",QE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:y[1]||(y[1]=d=>$.$emit("update:form-data","sandbox_enabled",d.target.checked))},null,40,XE),y[4]||(y[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:te(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,b(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):A("",!0)]))}},eC=ne(ZE,[["__scopeId","data-v-08b1f06d"]]),tC={class:"modal-dialog modal-lg"},sC={class:"modal-content"},nC={class:"modal-body"},oC={key:0,class:"text-center py-4"},iC={key:1,class:"alert alert-danger"},aC={key:2},rC={class:"mb-3"},lC={class:"small text-muted mb-2"},cC={key:0},uC={key:0,class:"alert alert-info"},dC={key:1},mC={class:"table table-sm table-striped"},pC={key:2,class:"mt-3"},fC={class:"modal-footer"},vC=["disabled"],hC={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=R(null);let l=null;const p=R(!1),m=R(""),f=R([]);ve(r,y=>{y&&(l=new ft(y),y.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){l&&(l.show(),g())}function w(){l&&l.hide()}async function g(){p.value=!0,m.value="",f.value=[];try{const y=await me.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=y.permissions||[]}catch(y){console.error("Failed to load permissions:",y),m.value=y.response?.data?.detail||y.message||"Failed to load permissions"}finally{p.value=!1}}function k(){g()}function $(y){switch(y){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:w}),(y,d)=>(a(),c("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",tC,[s("div",sC,[d[7]||(d[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",nC,[p.value?(a(),c("div",oC,[...d[0]||(d[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(a(),c("div",iC,b(m.value),1)):(a(),c("div",aC,[s("div",rC,[d[2]||(d[2]=s("h6",null,"Settings Sources",-1)),s("div",lC,[d[1]||(d[1]=ae(" Loading permissions from: ",-1)),(a(!0),c(le,null,ce(n.settingSources,(h,_)=>(a(),c("span",{key:h},[s("code",null,b(h),1),_<n.settingSources.length-1?(a(),c("span",cC,", ")):A("",!0)]))),128))])]),f.value.length===0?(a(),c("div",uC," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),c("div",dC,[s("h6",null,"Pre-approved Permissions ("+b(f.value.length)+")",1),s("table",mC,[d[3]||(d[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(a(!0),c(le,null,ce(f.value,h=>(a(),c("tr",{key:h.permission},[s("td",null,[s("code",null,b(h.permission),1)]),s("td",null,[(a(!0),c(le,null,ce(h.sources,(_,x)=>(a(),c("span",{key:_,class:te(["badge me-1",$(_)])},b(_),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),c("div",pC,[d[4]||(d[4]=s("h6",null,"Session Allowed Tools",-1)),d[5]||(d[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(a(!0),c(le,null,ce(n.sessionAllowedTools,h=>(a(),c("span",{key:h,class:"badge bg-success me-1 mb-1"},b(h),1))),128))])])):A("",!0)]))]),s("div",fC,[d[6]||(d[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:k,disabled:p.value}," Refresh ",8,vC)])])])],512))}},_C=ne(hC,[["__scopeId","data-v-988ff7c4"]]),gC={class:"modal-dialog modal-lg modal-dialog-centered"},bC={class:"modal-content"},yC={class:"modal-header"},wC={id:"configurationModalLabel",class:"modal-title"},$C={class:"modal-body"},kC={key:0,class:"template-list-view"},SC={key:0,class:"alert alert-info"},EC={class:"card-body"},CC={class:"d-flex justify-content-between align-items-start"},TC={class:"flex-grow-1"},xC={class:"card-title mb-1"},AC={key:0,class:"card-text text-muted small mb-2"},MC={class:"template-meta"},OC={class:"badge bg-secondary me-2"},DC={class:"text-muted small"},LC={class:"btn-group btn-group-sm ms-3"},NC=["onClick"],jC=["onClick"],IC={key:1},PC={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},RC={class:"nav-item",role:"presentation"},BC={key:0,class:"error-indicator",title:"This tab has validation errors"},WC={class:"nav-item",role:"presentation"},FC={key:0,class:"error-indicator",title:"This tab has validation errors"},HC={class:"nav-item",role:"presentation"},VC={key:0,class:"error-indicator",title:"This tab has validation errors"},UC={class:"tab-content"},qC={key:2,class:"alert alert-danger mt-3"},zC={class:"modal-footer"},KC={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},GC=["disabled"],YC={key:0,class:"spinner-border spinner-border-sm me-2"},JC={__name:"ConfigurationModal",setup(n){const e=Ft(),t=Re(),o=de(),i=be(),r=R(null);let l=null;const p=R(null),m=R("create-session"),f=R("general"),u=R(null),w=R(null),g=R(null),k=R([]),$=R(null),y=R(null),d=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=ws({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),_=ws({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),x=ws({name:""}),C=v(()=>({general:!!x.name,permissions:!1,advanced:!1})),B=R(!1),j=R(""),M=v(()=>m.value==="create-session"||m.value==="edit-session"),V=v(()=>m.value==="edit-session"||m.value==="edit-template"),T=v(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),E=v(()=>B.value?V.value?"Saving...":"Creating...":V.value?"Save Changes":M.value?"Create Session":"Save Template"),P=v(()=>!(!_.name.trim()||M.value&&_.name.includes(" "))),z=v(()=>w.value?.working_directory?w.value.working_directory:_.working_directory?_.working_directory:t.projects.get(u.value)?.working_directory||""),N=v(()=>!_.allowed_tools||!_.allowed_tools.trim()?[]:_.allowed_tools.split(",").map(U=>U.trim()).filter(U=>U.length>0));function W(){p.value&&p.value.show()}function K(U,ie){_[U]=ie,U==="name"&&(x.name="")}function Z(U){$.value=U,L()}async function D(){try{const U=await me.get("/api/templates");k.value=U||[]}catch(U){console.error("Failed to load templates:",U),k.value=[]}}function L(){if(!$.value){_.default_role="",_.initialization_context="",_.permission_mode="default",_.allowed_tools="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",d.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const U=k.value.find(ie=>ie.template_id===$.value);if(U)if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",U.default_role?(_.default_role=U.default_role,d.value.default_role=U.default_role,h.default_role="autofilled"):(_.default_role="",d.value.default_role=null),U.default_system_prompt?(_.initialization_context=U.default_system_prompt,d.value.initialization_context=U.default_system_prompt,h.initialization_context="autofilled"):(_.initialization_context="",d.value.initialization_context=null),U.permission_mode?(_.permission_mode=U.permission_mode,d.value.permission_mode=U.permission_mode,h.permission_mode="autofilled"):(_.permission_mode="default",d.value.permission_mode=null),U.allowed_tools&&U.allowed_tools.length>0){const ie=U.allowed_tools.join(", ");_.allowed_tools=ie,d.value.allowed_tools=ie,h.allowed_tools="autofilled"}else _.allowed_tools="",d.value.allowed_tools=null}function O(){const ie=(u.value?t.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:ie,currentPath:_.working_directory||"",onSelect:ue=>{_.working_directory=ue}})}function S(){m.value==="create-session"&&(y.value={mode:"create-session",projectId:u.value,formData:{..._},selectedTemplateId:$.value}),m.value="template-list",se()}function I(){m.value="create-template",se(),f.value="general"}function G(U){m.value="edit-template",g.value=U,se(),oe(U),f.value="general"}async function Q(U){if(confirm(`Delete template "${U.name}"?

This action cannot be undone.`))try{await me.delete(`/api/templates/${U.template_id}`),await D()}catch(ie){console.error("Failed to delete template:",ie),j.value=ie.response?.data?.detail||"Failed to delete template"}}function Y(){let U=!0;return x.name="",_.name.trim()||(x.name="Name is required",U=!1),M.value&&_.name.includes(" ")&&(x.name="Session name must be a single word (no spaces)",U=!1),U}async function ee(){if(!Y()){x.name&&(f.value="general");return}B.value=!0,j.value="";try{switch(m.value){case"create-session":await _e(),l&&l.hide();break;case"edit-session":await J(),l&&l.hide();break;case"create-template":await F();break;case"edit-template":await q();break}}catch(U){console.error("Submit failed:",U),j.value=U.response?.data?.detail||U.message||"Operation failed. Please try again."}finally{B.value=!1}}async function _e(){if(!u.value)throw new Error("Project ID is missing");const U=_.allowed_tools.split(",").map(We=>We.trim()).filter(We=>We.length>0),ie=_.capabilities.split(",").map(We=>We.trim()).filter(We=>We.length>0),ue={name:_.name.trim(),model:_.model||null,role:_.default_role.trim()||null,initialization_context:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,capabilities:ie.length>0?ie:null,permission_mode:_.permission_mode,allowed_tools:U.length>0?U:null,working_directory:_.working_directory.trim()||null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources},Ae=await me.post(`/api/legions/${u.value}/minions`,ue);if(Ae.success&&Ae.minion_id)await t.fetchProjects(),await o.fetchSessions(),_.startImmediately&&await o.startSession(Ae.minion_id),e.push(`/session/${Ae.minion_id}`);else throw new Error("Failed to create session")}async function J(){if(!w.value)throw new Error("Session data is missing");const U=w.value.session_id,ie=w.value.state==="active"||w.value.state==="starting",ue=_.allowed_tools.split(",").map(Se=>Se.trim()).filter(Se=>Se.length>0),Ae=_.capabilities.split(",").map(Se=>Se.trim()).filter(Se=>Se.length>0),We={name:_.name.trim(),model:_.model,role:_.default_role.trim()||null,system_prompt:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,allowed_tools:ue.length>0?ue:null,capabilities:Ae.length>0?Ae:null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources};await o.patchSession(U,We),ie&&_.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(U,_.permission_mode)}async function F(){const U=_.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),ie={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:U.length>0?U:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await me.post("/api/templates",ie),await D(),m.value="template-list",se()}async function q(){if(!g.value)throw new Error("Template data is missing");const U=_.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),ie={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:U.length>0?U:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await me.put(`/api/templates/${g.value.template_id}`,ie),await D(),m.value="template-list",g.value=null,se()}function se(){_.name="",_.model="sonnet",_.permission_mode="default",_.working_directory="",_.description="",_.default_role="",_.startImmediately=!0,_.allowed_tools="",_.capabilities="",_.setting_sources=["user","project","local"],_.system_prompt="",_.override_system_prompt=!1,_.initialization_context="",_.sandbox_enabled=!1,x.name="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",d.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},$.value=null,j.value="",f.value="general"}function H(U){_.name=U.name||"",_.model=U.model||"sonnet",_.permission_mode=U.current_permission_mode||"default",_.working_directory=U.working_directory||"",_.default_role=U.role||"",_.initialization_context=U.system_prompt||"",_.override_system_prompt=U.override_system_prompt||!1,_.system_prompt="",_.allowed_tools=U.allowed_tools?.join(", ")||"",_.capabilities=U.capabilities?.join(", ")||"",_.sandbox_enabled=U.sandbox_enabled||!1,_.setting_sources=U.setting_sources||["user","project","local"]}function oe(U){_.name=U.name||"",_.description=U.description||"",_.permission_mode=U.permission_mode||"default",_.default_role=U.default_role||"",_.initialization_context=U.default_system_prompt||"",_.allowed_tools=U.allowed_tools?.join(", ")||""}function pe(){kt(()=>{const U=document.getElementById("config-name");U&&(U.focus(),V.value&&U.select())})}function ge(){se(),m.value="create-session",u.value=null,w.value=null,g.value=null,i.hideModal()}return ve(()=>i.currentModal,async(U,ie)=>{if(!(!U||!l)){if(U.name==="configuration"){const ue=U.data||{};m.value=ue.mode||"create-session",u.value=ue.project?.project_id||ue.projectId||null,w.value=ue.session||null,g.value=ue.template||null,se(),m.value==="create-session"&&await D(),m.value==="edit-session"&&w.value?H(w.value):m.value==="edit-template"&&g.value&&oe(g.value),l.show()}else if(U.name==="create-minion"||U.name==="create-session"){const ue=U.data||{};m.value="create-session",u.value=ue.project?.project_id||null,w.value=null,g.value=null,se(),await D(),l.show()}else if(U.name==="edit-session"){const ue=U.data||{};m.value="edit-session",w.value=ue.session||null,u.value=w.value?.project_id||null,g.value=null,se(),w.value&&H(w.value),l.show()}else U.name==="template-management"&&(m.value="template-list",se(),await D(),l.show());ie?.name==="configuration"&&ie.data?.mode?.includes("template")&&U?.name==="configuration"&&m.value==="create-session"&&await D()}}),ve(()=>_.default_role,U=>{d.value.default_role!==null&&(h.default_role=U===d.value.default_role?"autofilled":"modified")}),ve(()=>_.initialization_context,U=>{d.value.initialization_context!==null&&(h.initialization_context=U===d.value.initialization_context?"autofilled":"modified")}),ve(()=>_.permission_mode,U=>{d.value.permission_mode!==null&&(h.permission_mode=U===d.value.permission_mode?"autofilled":"modified")}),ve(()=>_.allowed_tools,U=>{d.value.allowed_tools!==null&&(h.allowed_tools=U===d.value.allowed_tools?"autofilled":"modified")}),ke(()=>{r.value&&Me(()=>import("./modal-D6mKceGM.js").then(U=>U.m),__vite__mapDeps([0,1])).then(U=>{const ie=U.default;l=new ie(r.value),r.value.addEventListener("shown.bs.modal",pe),r.value.addEventListener("hidden.bs.modal",ge)})}),Te(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",pe),r.value.removeEventListener("hidden.bs.modal",ge)),l&&l.dispose()}),(U,ie)=>(a(),c(le,null,[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",gC,[s("div",bC,[s("div",yC,[s("h5",wC,[m.value==="create-template"||m.value==="edit-template"?(a(),c("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:S,title:"Back to template list"}," â† ")):A("",!0),ae(" "+b(T.value),1)]),ie[3]||(ie[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",$C,[m.value==="template-list"?(a(),c("div",kC,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[ie[4]||(ie[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:I,class:"btn btn-primary btn-sm"}," + Create New ")]),k.value.length===0?(a(),c("div",SC," No templates found. Create your first template! ")):A("",!0),(a(!0),c(le,null,ce(k.value,ue=>(a(),c("div",{key:ue.template_id,class:"card mb-2"},[s("div",EC,[s("div",CC,[s("div",TC,[s("h6",xC,b(ue.name),1),ue.description?(a(),c("p",AC,b(ue.description),1)):A("",!0),s("div",MC,[s("span",OC,b(ue.permission_mode),1),s("span",DC,b(ue.allowed_tools?.length||0)+" tools",1)])]),s("div",LC,[s("button",{onClick:Ae=>G(ue),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,NC),s("button",{onClick:Ae=>Q(ue),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,jC)])])])]))),128))])):(a(),c("div",IC,[s("ul",PC,[s("li",RC,[s("button",{class:te(["nav-link",{active:f.value==="general","has-error":C.value.general}]),type:"button",onClick:ie[0]||(ie[0]=ue=>f.value="general")},[ie[5]||(ie[5]=ae(" General ",-1)),C.value.general?(a(),c("span",BC)):A("",!0)],2)]),s("li",WC,[s("button",{class:te(["nav-link",{active:f.value==="permissions","has-error":C.value.permissions}]),type:"button",onClick:ie[1]||(ie[1]=ue=>f.value="permissions")},[ie[6]||(ie[6]=ae(" Permissions ",-1)),C.value.permissions?(a(),c("span",FC)):A("",!0)],2)]),s("li",HC,[s("button",{class:te(["nav-link",{active:f.value==="advanced","has-error":C.value.advanced}]),type:"button",onClick:ie[2]||(ie[2]=ue=>f.value="advanced")},[ie[7]||(ie[7]=ae(" Advanced ",-1)),C.value.advanced?(a(),c("span",VC)):A("",!0)],2)])]),s("div",UC,[we(fe(ZS,{mode:m.value,"form-data":_,errors:x,templates:k.value,"selected-template-id":$.value,session:w.value,"field-states":h,"onUpdate:formData":K,"onUpdate:selectedTemplateId":Z,onOpenFolderBrowser:O,onOpenTemplateManager:S},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ys,f.value==="general"]]),we(fe(BE,{mode:m.value,"form-data":_,errors:x,session:w.value,"field-states":h,"onUpdate:formData":K,onPreviewPermissions:W},null,8,["mode","form-data","errors","session","field-states"]),[[ys,f.value==="permissions"]]),we(fe(eC,{mode:m.value,"form-data":_,errors:x,session:w.value,"field-states":h,"onUpdate:formData":K},null,8,["mode","form-data","errors","session","field-states"]),[[ys,f.value==="advanced"]])])])),j.value?(a(),c("div",qC,b(j.value),1)):A("",!0)]),s("div",zC,[s("button",KC,b(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(a(),c("button",{key:0,type:"button",class:"btn btn-primary",disabled:B.value||!P.value,onClick:ee},[B.value?(a(),c("span",YC)):A("",!0),ae(" "+b(E.value),1)],8,GC)):A("",!0)])])])],512),fe(_C,{ref_key:"permissionPreviewModal",ref:p,"working-directory":z.value,"setting-sources":_.setting_sources,"session-allowed-tools":N.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},QC=ne(JC,[["__scopeId","data-v-098a9c63"]]),XC={class:"modal-dialog modal-dialog-centered"},ZC={class:"modal-content"},e0={class:"modal-header"},t0={class:"modal-title",id:"manageSessionModalLabel"},s0={class:"modal-body"},n0={key:0,class:"text-center py-4"},o0={class:"text-muted"},i0={key:1},a0={key:2},r0={class:"text-muted"},l0={key:0,class:"text-center py-2"},c0={key:1,class:"alert alert-warning mt-3"},u0={class:"mb-0 mt-2"},d0={key:0,class:"text-muted"},m0={key:3},p0={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},f0={class:"d-grid gap-2"},v0=["disabled"],h0=["disabled"],_0=["disabled"],g0=["disabled"],b0={class:"modal-footer"},y0={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},w0={__name:"SessionManageModal",setup(n){const e=Ft(),t=de(),o=be(),i=ot();Oe();const r=R(null),l=R(!1),p=R(""),m=R(""),f=R(null),u=R(null);let w=null;const g=R([]),k=R(!1),$=v(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function y(){f.value="reset"}async function d(){if(f.value="delete",g.value=[],!!r.value){k.value=!0;try{const T=await me.get(`/api/sessions/${r.value.session_id}/descendants`);g.value=T.descendants||[]}catch(T){console.error("Failed to fetch descendants:",T),g.value=[]}finally{k.value=!1}}}function h(){f.value=null}async function _(){f.value==="reset"?await B():f.value==="delete"&&await j()}async function x(){if(r.value){l.value=!0,p.value="Restarting session...";try{const T=r.value.session_id,E=t.currentSessionId===T,P=await me.post(`/api/sessions/${T}/restart`);if(P.success)console.log("Session restarted successfully"),E&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(T)),w&&w.hide();else{const z=P.error||P.detail||"Failed to restart session";console.error("Failed to restart session:",z),m.value=`Failed to restart session: ${z}`}}catch(T){console.error("Error restarting session:",T);const E=T.data?.detail||T.message||"Unknown error";m.value=`Error restarting session: ${E}`}finally{l.value=!1}}}async function C(){if(r.value)try{w&&w.hide(),console.log("Ending session",r.value.session_id);const T=r.value.session_id;await me.post(`/api/sessions/${T}/terminate`),t.currentSessionId===T&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(T){console.error("Error ending session:",T),t.currentSessionId===r.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function B(){if(r.value){l.value=!0,p.value="Resetting session...";try{const T=r.value.session_id,E=t.currentSessionId===T,P=await me.post(`/api/sessions/${T}/reset`);if(P.success)console.log("Session reset successfully"),E&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(T)),w&&w.hide();else{const z=P.error||P.detail||"Failed to reset session";console.error("Failed to reset session:",z),m.value=`Failed to reset session: ${z}`,f.value=null}}catch(T){console.error("Error resetting session:",T);const E=T.data?.detail||T.message||"Unknown error";m.value=`Error resetting session: ${E}`,f.value=null}finally{l.value=!1}}}async function j(){if(r.value){l.value=!0,p.value="Deleting session...";try{const T=r.value.session_id;await t.deleteSession(T),e.currentRoute.value.params.sessionId===T&&e.push("/"),w&&w.hide()}catch(T){console.error("Error deleting session:",T);const E=T.data?.detail||T.message||"Unknown error";m.value=`Error deleting session: ${E}`,f.value=null}finally{l.value=!1}}}function M(){f.value=null,l.value=!1,p.value="",m.value="",g.value=[],k.value=!1}function V(){M(),r.value=null,o.hideModal()}return ve(()=>o.currentModal,T=>{if(T?.name==="manage-session"&&w){const E=T.data||{};r.value=E.session,M(),w.show()}}),ke(()=>{u.value&&Me(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{w=new T(u.value),u.value.addEventListener("hidden.bs.modal",V)})}),Te(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",V),w&&w.dispose()}),(T,E)=>(a(),c("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",XC,[s("div",ZC,[s("div",e0,[s("h5",t0,b(f.value?$.value:"Manage Session"),1),E[1]||(E[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",s0,[l.value?(a(),c("div",n0,[E[2]||(E[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",o0,b(p.value),1)])):f.value==="reset"?(a(),c("div",i0,[...E[3]||(E[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(a(),c("div",a0,[E[9]||(E[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",r0,[E[4]||(E[4]=ae("This will permanently delete session ",-1)),s("strong",null,b(r.value?.name),1),E[5]||(E[5]=ae(".",-1))]),E[10]||(E[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),k.value?(a(),c("div",l0,[...E[6]||(E[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(a(),c("div",c0,[E[7]||(E[7]=s("strong",null,"Cascading Deletion:",-1)),E[8]||(E[8]=ae(" This session has ",-1)),s("strong",null,b(g.value.length),1),ae(" child session"+b(g.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",u0,[(a(!0),c(le,null,ce(g.value,P=>(a(),c("li",{key:P.session_id,class:"small"},[s("strong",null,b(P.name||P.session_id),1),P.role?(a(),c("span",d0," ("+b(P.role)+")",1)):A("",!0)]))),128))])])):A("",!0)])):(a(),c("div",m0,[m.value?(a(),c("div",p0,[E[11]||(E[11]=s("strong",null,"Error:",-1)),ae(" "+b(m.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:E[0]||(E[0]=P=>m.value="")})])):A("",!0),E[18]||(E[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",f0,[s("button",{class:"btn btn-outline-primary text-start",onClick:x,disabled:l.value},[...E[12]||(E[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,v0),s("button",{class:"btn btn-outline-secondary text-start",onClick:C,disabled:l.value},[...E[13]||(E[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,h0),E[16]||(E[16]=s("hr",{class:"my-2"},null,-1)),E[17]||(E[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:y,disabled:l.value},[...E[14]||(E[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,_0),s("button",{class:"btn btn-outline-danger text-start",onClick:d,disabled:l.value},[...E[15]||(E[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,g0)]),E[19]||(E[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ae(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",b0,[f.value&&!l.value?(a(),c(le,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),s("button",{type:"button",class:te(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:_},b(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?A("",!0):(a(),c("button",y0,"Cancel"))])])])],512))}},$0=ne(w0,[["__scopeId","data-v-6b832853"]]),k0={class:"modal-dialog modal-dialog-centered modal-lg"},S0={class:"modal-content"},E0={class:"modal-body"},C0={key:0,class:"text-center text-muted py-4"},T0={key:1},x0={class:"mb-3"},A0={class:"font-monospace small"},M0={class:"mb-3"},O0=["value"],D0={class:"mb-3"},L0={class:"mb-3"},N0={class:"mb-3"},j0={key:0},I0={class:"d-flex flex-wrap gap-1"},P0={key:1,class:"text-muted small"},R0={key:0,class:"mb-3"},B0={class:"d-flex flex-wrap gap-1"},W0={key:1,class:"mb-3"},F0={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},H0={class:"mb-3"},V0={class:"text-muted"},U0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},q0={__name:"SessionInfoModal",setup(n){const e=de(),t=Oe(),o=be(),i=R(null),r=R(!1),l=R(null);let p=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=v(()=>{if(!i.value)return null;const y=e.initData.get(i.value);return y||(t.messagesBySession.get(i.value)||[]).find(_=>_.type==="system"&&(_.subtype==="init"||_.metadata?.subtype==="init")&&_.metadata?.init_data)?.metadata?.init_data||null});function u(y){return y?m[y]||y:"Default (Sonnet 4.5)"}function w(y){return typeof y=="string"?y:typeof y=="object"&&y.type==="preset"?`Preset: ${y.preset}`:JSON.stringify(y,null,2)}function g(y){y.target.select()}function k(){i.value=null,r.value=!1}function $(){k(),o.hideModal()}return ve(()=>o.currentModal,y=>{if(y?.name==="session-info"&&p){const d=y.data||{};i.value=d.sessionId,r.value=!1,p.show()}}),ke(()=>{l.value&&Me(async()=>{const{default:y}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:y}},__vite__mapDeps([0,1])).then(({default:y})=>{p=new y(l.value),l.value.addEventListener("hidden.bs.modal",$)})}),Te(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",$),p&&p.dispose()}),(y,d)=>(a(),c("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",k0,[s("div",S0,[d[9]||(d[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",E0,[f.value?(a(),c("div",T0,[s("div",x0,[d[1]||(d[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",A0,b(i.value),1)]),s("div",M0,[d[2]||(d[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:g},null,8,O0)]),s("div",D0,[d[3]||(d[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,b(u(f.value.model)),1)]),s("div",L0,[d[4]||(d[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,b(f.value.permissionMode||"default"),1)]),s("div",N0,[d[5]||(d[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(a(),c("div",j0,[s("div",I0,[(a(!0),c(le,null,ce(f.value.allowed_tools||f.value.tools,h=>(a(),c("span",{key:h,class:"badge bg-secondary"},b(h),1))),128))])])):(a(),c("div",P0,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(a(),c("div",R0,[d[6]||(d[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",B0,[(a(!0),c(le,null,ce(f.value.commands,h=>(a(),c("span",{key:h,class:"badge bg-info"},b(h),1))),128))])])):A("",!0),f.value.systemPrompt?(a(),c("div",W0,[d[7]||(d[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",F0,b(w(f.value.systemPrompt)),1)])):A("",!0),s("div",H0,[s("h6",V0,[d[8]||(d[8]=ae(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:d[0]||(d[0]=h=>r.value=!r.value)},b(r.value?"Hide":"Show"),1)]),r.value?(a(),c("pre",U0,b(JSON.stringify(f.value,null,2)),1)):A("",!0)])])):(a(),c("div",C0," No session configuration data available "))]),d[10]||(d[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},z0=ne(q0,[["__scopeId","data-v-b28b39b3"]]),K0={class:"modal-dialog modal-dialog-centered modal-lg"},G0={class:"modal-content"},Y0={class:"modal-body"},J0={key:0,class:"text-center text-muted py-4"},Q0={key:1},X0={class:"mb-3"},Z0={class:"mb-3"},eT={class:"font-monospace small"},tT={class:"mb-3"},sT={class:"mb-3"},nT={class:"mb-3"},oT={key:0},iT={class:"d-flex flex-wrap gap-1"},aT={key:1,class:"text-muted small"},rT={class:"mb-3"},lT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},cT={key:1,class:"text-muted small"},uT={class:"mb-3"},dT={key:0,class:"badge bg-info"},mT={key:1,class:"badge bg-secondary"},pT={class:"mb-3"},fT={key:0,class:"font-monospace small"},vT={key:1,class:"text-muted small"},hT={key:0,class:"mb-3"},_T={key:0},gT={class:"list-unstyled mb-0"},bT={key:1,class:"text-muted small"},yT={class:"mb-3"},wT={class:"small"},$T={class:"mb-3"},kT={class:"small"},ST={__name:"MinionViewModal",setup(n){const e=be(),t=R(null),o=R(null);let i=null;function r(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function l(f){if(!f)return"N/A";try{const u=new Date(f);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function p(){t.value=null}function m(){p(),e.hideModal()}return ve(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const u=f.data||{};t.value=u.session,i.show()}}),ke(()=>{o.value&&Me(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),Te(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),i&&i.dispose()}),(f,u)=>(a(),c("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",K0,[s("div",G0,[u[11]||(u[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Y0,[t.value?(a(),c("div",Q0,[s("div",X0,[u[0]||(u[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,b(t.value.name||"Unnamed Minion"),1)]),s("div",Z0,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",eT,b(t.value.session_id),1)]),s("div",tT,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,b(t.value.role||"Not specified"),1)]),s("div",sT,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:te(["badge",r(t.value.state)])},b(t.value.state),3)])]),s("div",nT,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(a(),c("div",oT,[s("div",iT,[(a(!0),c(le,null,ce(t.value.capabilities,w=>(a(),c("span",{key:w,class:"badge bg-secondary"},b(w),1))),128))])])):(a(),c("div",aT,"None"))]),s("div",rT,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(a(),c("div",lT,b(t.value.initialization_context),1)):(a(),c("div",cT,"Not specified"))]),s("div",uT,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(a(),c("span",dT,"Yes")):(a(),c("span",mT,"No"))])]),s("div",pT,[u[7]||(u[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(a(),c("div",fT,b(t.value.parent_overseer_id),1)):(a(),c("div",vT," Root overseer (user-created) "))]),t.value.is_overseer?(a(),c("div",hT,[u[8]||(u[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(a(),c("div",_T,[s("ul",gT,[(a(!0),c(le,null,ce(t.value.child_minion_ids,w=>(a(),c("li",{key:w,class:"font-monospace small"},b(w),1))),128))])])):(a(),c("div",bT,"No children"))])):A("",!0),s("div",yT,[u[9]||(u[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",wT,b(l(t.value.created_at)),1)]),s("div",$T,[u[10]||(u[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",kT,b(l(t.value.updated_at)),1)])])):(a(),c("div",J0," No minion data available "))]),u[12]||(u[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},ET=ne(ST,[["__scopeId","data-v-d996dc6f"]]),CT={class:"container-fluid vh-100 d-flex flex-column p-0"},TT={class:"d-flex flex-grow-1 overflow-hidden position-relative"},xT={class:"flex-grow-1 d-flex flex-column overflow-hidden"},AT={__name:"App",setup(n){const e=be(),t=ot(),o=de(),i=Re(),r=Rt(),l=Ze(),p=Ft(),m=R(null);function f(d){m.value=d}gn("addAttachmentFromResource",f),gn("pendingResourceAttachment",m);const u=v(()=>e.sidebarCollapsed),w=v(()=>e.rightSidebarCollapsed),g=v(()=>e.isMobile);ve(()=>r.currentHasTasks,(d,h)=>{d&&!h&&e.setRightSidebarCollapsed(!1)}),ve(()=>l.currentHasResources,(d,h)=>{d&&!h&&e.setRightSidebarCollapsed(!1)}),ke(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const d=window.location.hash;if(d.startsWith("#/session/")){const h=d.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(d.startsWith("#/timeline/")){const h=d.replace("#/timeline/","");p.push(`/timeline/${h}`)}window.addEventListener("popstate",k),window.addEventListener("resize",e.handleResize)}),Te(()=>{window.removeEventListener("popstate",k),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function k(){const d=window.location.hash;if(d.startsWith("#/session/")){const h=d.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function $(){e.toggleSidebar()}function y(){e.toggleRightSidebar()}return(d,h)=>{const _=vo("router-view");return a(),c("div",CT,[fe(mw),s("div",{id:"sidebar-backdrop",class:te({show:!u.value&&g.value}),onClick:$},null,2),s("div",{id:"right-sidebar-backdrop",class:te({show:!w.value&&g.value}),onClick:y},null,2),s("div",TT,[fe(Hw),s("main",xT,[fe(_)]),fe(ck)]),fe(Ck),fe(Hk),fe(uS),fe(QC),fe($0),fe(z0),fe(ET)])}}},un=Oi(AT);un.use(Di());un.use(nw);un.mount("#app");
