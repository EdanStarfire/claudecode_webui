const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as a,a as e,o as l,d as _e,r as L,b as i,t as g,n as me,e as V,f as G,u as we,w as te,g as Pe,h as P,F as Z,i as ee,j as ce,k as Re,l as Y,v as ne,m as Q,p as re,q as Me,s as qe,x as ue,y as ie,z as fe,A as We,B as Fe,C as Be,D as pe,E as be,G as Ve,H as ze}from"./vue-vendor-BChC3Sgv.js";import{m as he,p as je}from"./markdown-vendor-CQ3OZdP9.js";import{c as Ge}from"./diff-vendor-DG4m3V_x.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const v of n.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&r(v)}).observe(document,{childList:!0,subtree:!0});function u(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=u(o);fetch(o.href,n)}})();const Je={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ke={__name:"NoSessionSelected",setup(s){return(t,u)=>(l(),a("div",Je,[...u[0]||(u[0]=[e("h2",{class:"text-muted"},"No Session Selected",-1),e("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Ye="modulepreload",Qe=function(s){return"/"+s},Le={},ae=function(t,u,r){let o=Promise.resolve();if(u&&u.length>0){let c=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),_=v?.nonce||v?.getAttribute("nonce");o=c(u.map(f=>{if(f=Qe(f),f in Le)return;Le[f]=!0;const h=f.endsWith(".css"),$=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${$}`))return;const y=document.createElement("link");if(y.rel=h?"stylesheet":Ye,h||(y.as="script"),y.crossOrigin="",y.href=f,_&&y.setAttribute("nonce",_),document.head.appendChild(y),h)return new Promise((b,M)=>{y.addEventListener("load",b),y.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${f}`)))})}))}function n(v){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=v,window.dispatchEvent(_),!_.defaultPrevented)throw v}return o.then(v=>{for(const _ of v||[])_.status==="rejected"&&n(_.reason);return t().catch(n)})};class ke extends Error{constructor(t,u,r){super(t),this.name="APIError",this.status=u,this.data=r}}async function ye(s,t={}){try{const u=await fetch(s,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!u.ok){let o;try{o=await u.json()}catch{o={detail:u.statusText}}throw new ke(o.detail||`HTTP ${u.status}: ${u.statusText}`,u.status,o)}const r=u.headers.get("content-type");return r&&r.includes("application/json")?await u.json():await u.text()}catch(u){throw u instanceof ke?u:(console.error("API request failed:",u),new ke(`Network error: ${u.message}`,0,null))}}async function Ze(s,t={}){let u=s;if(t.params){const r=new URLSearchParams;for(const[_,c]of Object.entries(t.params))c!=null&&r.append(_,c);const o=r.toString();o&&(u=`${s}?${o}`);const{params:n,...v}=t;return ye(u,{...v,method:"GET"})}return ye(u,{...t,method:"GET"})}async function Xe(s,t,u={}){return ye(s,{...u,method:"POST",body:JSON.stringify(t)})}async function et(s,t,u={}){return ye(s,{...u,method:"PUT",body:JSON.stringify(t)})}async function tt(s,t={}){return ye(s,{...t,method:"DELETE"})}const K={get:Ze,post:Xe,put:et,delete:tt},J=_e("session",()=>{const s=L(new Map),t=L(null),u=L(new Map),r=L(new Map),o=L(new Set),n=L(!1);let v=null;const _=i(()=>s.value.get(t.value)),c=i(()=>Array.from(s.value.values()).sort((k,E)=>k.order-E.order)),f=k=>i(()=>c.value.filter(E=>E.project_id===k)),h=i({get:()=>u.value.get(t.value)||"",set:k=>{t.value&&u.value.set(t.value,k)}});async function $(){try{const k=await K.get("/api/sessions");return s.value.clear(),k.sessions.forEach(E=>{s.value.set(E.session_id,E)}),console.log(`Loaded ${s.value.size} sessions`),k.sessions}catch(k){throw console.error("Failed to fetch sessions:",k),k}}async function y(k,E){try{const R=(await K.post("/api/sessions",{project_id:k,...E})).session_id,d=(await K.get(`/api/sessions/${R}`)).session;return s.value.set(R,d),s.value=new Map(s.value),console.log(`Created session ${R}`),d}catch(W){throw console.error("Failed to create session:",W),W}}async function b(k){if(t.value===k&&!n.value)return;v&&(console.log(`Aborting pending selection to switch to ${k}`),v.abort(),v=null);const E=new AbortController;v=E,n.value=!0;try{if(t.value=k,E.signal.aborted){console.log(`Selection of ${k} aborted early`);return}let W=s.value.get(k);if(!W)try{const d=await K.get(`/api/sessions/${k}`);if(E.signal.aborted){console.log(`Selection of ${k} aborted after fetch`);return}W=d.session,s.value.set(k,W),s.value=new Map(s.value),console.log(`Fetched session ${k} for deeplink`)}catch(d){console.error(`Failed to fetch session ${k}:`,d);return}if(W&&(W.state==="created"||W.state==="terminated"))try{if(await x(k),E.signal.aborted){console.log(`Selection of ${k} aborted after start`);return}console.log(`Auto-started session ${k} (was in ${W.state} state)`);const d=6e4,C=200,A=5e3;let D=0,j=0;for(;D<d;){if(E.signal.aborted){console.log(`Selection of ${k} aborted during state wait`);return}const U=s.value.get(k);if(U&&U.state==="active"){console.log(`Session ${k} is now active after ${D}ms`);break}if(D-j>=A){const H=s.value.get(k)?.state||"unknown";console.log(`Waiting for session ${k} to become active (current: ${H}, ${D/1e3}s elapsed)`),j=D}await new Promise(H=>setTimeout(H,C)),D+=C}const I=s.value.get(k);I&&I.state!=="active"&&console.warn(`Session ${k} did not become active within ${d/1e3}s (state: ${I.state}), continuing anyway`)}catch(d){console.error(`Failed to auto-start session ${k}:`,d)}if(E.signal.aborted){console.log(`Selection of ${k} aborted before message load`);return}if(await(await ae(()=>Promise.resolve().then(()=>$t),void 0)).useMessageStore().loadMessages(k),E.signal.aborted){console.log(`Selection of ${k} aborted after message load`);return}await(await ae(()=>Promise.resolve().then(()=>Ht),void 0)).useWebSocketStore().connectSession(k),E.signal.aborted||console.log(`Selected session ${k}`)}finally{v===E&&(v=null),n.value=!1}}function M(k,E){const W=s.value.get(k);W&&(Object.assign(W,E),s.value=new Map(s.value))}async function T(k){o.value.add(k);try{await K.delete(`/api/sessions/${k}`),s.value.delete(k),u.value.delete(k),r.value.delete(k),s.value=new Map(s.value),t.value===k&&(t.value=null),console.log(`Deleted session ${k}`)}catch(E){throw console.error("Failed to delete session:",E),E}finally{o.value.delete(k)}}async function S(k,E){try{await K.put(`/api/sessions/${k}/name`,{name:E}),M(k,{name:E}),console.log(`Updated session ${k} name to "${E}"`)}catch(W){throw console.error("Failed to update session name:",W),W}}async function w(k,E){try{await K.post(`/api/sessions/${k}/permission-mode`,{mode:E}),M(k,{current_permission_mode:E});const W=r.value.get(k);W&&(W.permissionMode=E,r.value.set(k,W)),console.log(`Set permission mode for session ${k} to ${E}`)}catch(W){throw console.error("Failed to set permission mode:",W),W}}async function x(k){try{await K.post(`/api/sessions/${k}/start`),console.log(`Started session ${k}`)}catch(E){throw console.error("Failed to start session:",E),E}}async function p(k){try{await K.post(`/api/sessions/${k}/pause`),console.log(`Paused session ${k}`)}catch(E){throw console.error("Failed to pause session:",E),E}}async function m(k){try{await K.post(`/api/sessions/${k}/terminate`),console.log(`Terminated session ${k}`)}catch(E){throw console.error("Failed to terminate session:",E),E}}function N(k){return s.value.get(k)}function z(k,E){r.value.set(k,E),E.permissionMode&&M(k,{current_permission_mode:E.permissionMode})}return{sessions:s,currentSessionId:t,inputCache:u,initData:r,deletingSessions:o,currentSession:_,orderedSessions:c,sessionsInProject:f,currentInput:h,fetchSessions:$,createSession:y,selectSession:b,updateSession:M,deleteSession:T,updateSessionName:S,setPermissionMode:w,startSession:x,pauseSession:p,terminateSession:m,getSession:N,storeInitData:z}}),Ie=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:J},Symbol.toStringTag,{value:"Module"})),se=_e("ui",()=>{const s=L(window.innerWidth<768),t=L(300),u=L(window.innerWidth),r=i(()=>u.value<768),o=L(!0),n=L(null),v=L(null),_=i(()=>n.value?{name:n.value,data:v.value}:null),c=L(!1),f=L("Loading...");function h(){s.value=!s.value}function $(p){s.value=p}function y(p){t.value=Math.max(200,Math.min(p,window.innerWidth*.3))}function b(p){o.value=p}function M(p,m=null){n.value=null,v.value=null,setTimeout(()=>{n.value=p,v.value=m},0)}function T(){n.value=null,v.value=null}function S(p="Loading..."){c.value=!0,f.value=p}function w(){c.value=!1}function x(){const p=u.value;u.value=window.innerWidth,u.value<768&&p>=768?s.value=!0:u.value>=768&&p<768&&(s.value=!1)}return{sidebarCollapsed:s,sidebarWidth:t,isMobile:r,autoScrollEnabled:o,activeModal:n,modalData:v,currentModal:_,isLoading:c,loadingMessage:f,toggleSidebar:h,setSidebarCollapsed:$,setSidebarWidth:y,setAutoScroll:b,showModal:M,hideModal:T,showLoading:S,hideLoading:w,handleResize:x}}),le=_e("project",()=>{const s=L(new Map),t=L(null),u=i(()=>s.value.get(t.value)),r=i(()=>Array.from(s.value.values()).sort((T,S)=>T.order-S.order)),o=T=>s.value.get(T)?.is_multi_agent||!1;async function n(){try{const T=await K.get("/api/projects");return s.value.clear(),T.projects.forEach(S=>{s.value.set(S.project_id,S)}),console.log(`Loaded ${s.value.size} projects`),T.projects}catch(T){throw console.error("Failed to fetch projects:",T),T}}async function v(T,S,w=!1){try{const p=(await K.post("/api/projects",{name:T,working_directory:S,is_multi_agent:w})).project;return s.value.set(p.project_id,p),s.value=new Map(s.value),console.log(`Created project ${p.project_id}`),p}catch(x){throw console.error("Failed to create project:",x),x}}async function _(T,S){try{await K.put(`/api/projects/${T}`,S),c(T,S),console.log(`Updated project ${T}`,S)}catch(w){throw console.error("Failed to update project:",w),w}}function c(T,S){const w=s.value.get(T);w&&(Object.assign(w,S),s.value=new Map(s.value))}async function f(T){try{await K.delete(`/api/projects/${T}`),s.value.delete(T),s.value=new Map(s.value),t.value===T&&(t.value=null),console.log(`Deleted project ${T}`)}catch(S){throw console.error("Failed to delete project:",S),S}}async function h(T){try{const S=await K.put(`/api/projects/${T}/toggle-expansion`),w=s.value.get(T);return w&&(w.is_expanded=S.is_expanded,s.value=new Map(s.value)),S.is_expanded}catch(S){throw console.error("Failed to toggle expansion:",S),S}}async function $(T){try{await K.put("/api/projects/reorder",{project_ids:T}),T.forEach((S,w)=>{const x=s.value.get(S);x&&(x.order=w)}),s.value=new Map(s.value),console.log("Reordered projects",T)}catch(S){throw console.error("Failed to reorder projects:",S),S}}async function y(T,S){try{await K.put(`/api/projects/${T}/sessions/reorder`,{session_ids:S});const w=s.value.get(T);w&&(w.session_ids=S,s.value=new Map(s.value)),console.log(`Reordered sessions in project ${T}`,S)}catch(w){throw console.error("Failed to reorder sessions:",w),w}}function b(T){return s.value.get(T)}function M(T){if(!T)return"";const S=T.split(/[/\\]/).filter(w=>w);return S.length===0?"/":S.length===1?`/${S[0]}`:S.length===2?`/${S.join("/")}`:`.../${S.slice(-2).join("/")}`}return{projects:s,currentProjectId:t,currentProject:u,orderedProjects:r,isMultiAgent:o,fetchProjects:n,createProject:v,updateProject:_,updateProjectLocal:c,deleteProject:f,toggleExpansion:h,reorderProjects:$,reorderSessionsInProject:y,getProject:b,formatPath:M}}),F=(s,t)=>{const u=s.__vccOpts||s;for(const[r,o]of t)u[r]=o;return u},st={class:"session-header border-bottom p-3"},ot={class:"project-name"},nt=["title"],lt={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(s){const t=s,u=J(),r=le(),o=i(()=>u.sessions.get(t.sessionId)),n=i(()=>o.value?.name||t.sessionId),v=i(()=>{for(const c of r.projects.values())if(c.session_ids?.includes(t.sessionId))return c;return null}),_=i(()=>v.value?.name||"Unknown Project");return(c,f)=>(l(),a("div",st,[e("div",null,[e("div",ot,g(_.value),1),e("div",{class:"session-name",title:s.sessionId},g(n.value),9,nt)])]))}},at=F(lt,[["__scopeId","data-v-89e9c269"]]),rt={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},it=["title"],ct={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},ut={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(s){const t=s,u=J(),r=i(()=>u.sessions.get(t.sessionId)),o=i(()=>r.value?r.value.state==="paused"&&r.value.is_processing?"pending-prompt":r.value.is_processing?"processing":r.value.state:"unknown"),n=i(()=>{const c=o.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[c]||"#d3d3d3"}),v=i(()=>{const c=o.value;return c==="starting"||c==="processing"||c==="pending-prompt"}),_=i(()=>{if(!r.value)return"No session selected";const c=o.value,f=c.charAt(0).toUpperCase()+c.slice(1).replace("-"," "),h=r.value.name||"Unnamed Session",$=r.value.is_minion&&r.value.role?` (${r.value.role})`:"";return`${h}${$}: ${f}`});return(c,f)=>(l(),a("div",rt,[r.value?(l(),a("div",{key:0,class:V(["progress-bar",{"progress-bar-striped progress-bar-animated":v.value}]),style:me({width:"100%",backgroundColor:n.value}),title:_.value},null,14,it)):(l(),a("div",ct))]))}},dt=F(ut,[["__scopeId","data-v-e8795bb7"]]),mt={class:"session-status-bar border-top p-2 bg-light"},pt={class:"d-flex justify-content-between align-items-center gap-2"},vt={class:"d-flex gap-2"},ft=["disabled"],gt={class:"mode-label"},_t=["disabled"],bt=["disabled"],ht={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(s){const t=s,u=J(),r=se(),o=i(()=>u.sessions.get(t.sessionId)),n=i(()=>o.value?.current_permission_mode||"default"),v={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},_=i(()=>v[n.value]||"ðŸ”’"),c=i(()=>n.value),f=["default","acceptEdits","plan"],h=async()=>{if(!o.value)return;if(n.value==="bypassPermissions"){try{await u.setPermissionMode(t.sessionId,"default")}catch(w){console.error("Failed to cycle permission mode:",w)}return}const T=(f.indexOf(n.value)+1)%f.length,S=f[T];try{await u.setPermissionMode(t.sessionId,S)}catch(w){console.error("Failed to cycle permission mode:",w)}},$=()=>{r.showModal("session-info",{sessionId:t.sessionId})},y=()=>{r.showModal("manage-session",{session:o.value})},b=()=>{r.setAutoScroll(!r.autoScrollEnabled)};return(M,T)=>(l(),a("div",mt,[e("div",pt,[e("div",vt,[e("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!o.value},[G(g(_.value)+" ",1),e("span",gt,g(c.value),1)],8,ft),e("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!o.value},[...T[0]||(T[0]=[G(" â„¹ï¸ ",-1),e("span",{class:"button-label"},"Info",-1)])],8,_t),e("button",{class:"btn btn-sm btn-outline-secondary",onClick:y,disabled:!o.value},[...T[1]||(T[1]=[G(" âš™ï¸ ",-1),e("span",{class:"button-label"},"Manage",-1)])],8,bt)]),e("div",null,[e("button",{class:V(["btn btn-sm",we(r).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:b}," â¬‡ï¸ "+g(we(r).autoScrollEnabled?"ON":"OFF"),3)])])]))}},yt=F(ht,[["__scopeId","data-v-fdcd3535"]]),de=_e("message",()=>{const s=L(new Map),t=L(new Map),u=L(new Map),r=L(new Map),o=L(new Map),n=L(new Map),v=L(new Map),_=i(()=>{const d=J();return s.value.get(d.currentSessionId)||[]}),c=i(()=>{const d=J();return t.value.get(d.currentSessionId)||[]});async function f(d,C=null,A=0){try{const D=C||1e4,j=await K.get(`/api/sessions/${d}/messages?limit=${D}&offset=${A}`),I=j.messages||[],U=j.total_count||I.length,H=j.has_more||!1;if(console.log(`Loaded ${I.length} of ${U} messages for session ${d}`),s.value.set(d,I),I.length>0){const q=I[I.length-1];q.timestamp&&(v.value.set(d,q.timestamp),console.log(`Tracked last received timestamp for session ${d}: ${q.timestamp}`))}const B=new Set;I.forEach(q=>{q.type==="assistant"&&q.metadata?.tool_uses&&q.metadata.tool_uses.forEach(X=>{B.add(X.id)}),q.type==="user"&&q.metadata?.tool_results&&q.metadata.tool_results.forEach(X=>{B.delete(X.tool_use_id);const $e=n.value.get(d);$e&&$e.delete(X.tool_use_id)}),q.type==="system"&&q.metadata?.subtype==="client_launched"&&(B.forEach(X=>{m(d,X,"Session was restarted")}),B.clear()),q.type==="system"&&q.metadata?.subtype==="interrupt"&&(B.forEach(X=>{m(d,X,"Session was interrupted")}),B.clear()),q.metadata?.has_tool_uses&&q.metadata.tool_uses&&q.metadata.tool_uses.forEach(X=>{M(d,X)}),q.metadata?.has_tool_results&&q.metadata.tool_results&&q.metadata.tool_results.forEach(X=>{w(d,X)}),(q.type==="permission_request"||q.metadata?.has_permission_requests)&&T(d,q),q.type==="system"&&(q.subtype==="init"||q.metadata?.subtype==="init")&&q.metadata?.init_data&&J().storeInitData(d,q.metadata.init_data)});const ve=J().sessions.get(d);return ve&&!["active","paused","starting"].includes(ve.state)&&(B.forEach(q=>{m(d,q,"Session was terminated")}),B.clear()),o.value.set(d,B),s.value=new Map(s.value),H&&console.warn(`Warning: Only loaded ${I.length} of ${U} messages. Some messages may be missing.`),{messages:I,totalCount:U,hasMore:H}}catch(D){throw console.error("Failed to load messages:",D),D}}function h(d,C){const A=o.value.get(d)||new Set;C.type==="assistant"&&C.metadata?.tool_uses&&C.metadata.tool_uses.forEach(D=>{A.add(D.id)}),C.type==="user"&&C.metadata?.tool_results&&C.metadata.tool_results.forEach(D=>{A.delete(D.tool_use_id);const j=n.value.get(d);j&&j.delete(D.tool_use_id)}),C.type==="system"&&C.metadata?.subtype==="client_launched"&&(A.forEach(D=>{m(d,D,"Session was restarted")}),A.clear()),C.type==="system"&&C.metadata?.subtype==="interrupt"&&(A.forEach(D=>{m(d,D,"Session was interrupted")}),A.clear()),o.value.set(d,A)}function $(d,C){s.value.has(d)||s.value.set(d,[]),s.value.get(d).push(C),C.timestamp&&v.value.set(d,C.timestamp),h(d,C),s.value=new Map(s.value)}function y(d,C){t.value.has(d)||t.value.set(d,[]),t.value.get(d).push(C),t.value=new Map(t.value)}function b(d,C,A){const D=t.value.get(d);if(D){const j=D.find(I=>I.id===C);j&&(Object.assign(j,A),t.value=new Map(t.value))}}function M(d,C){const A=p(C.name,C.input);u.value.set(A,C.id);const D={id:C.id,name:C.name,input:C.input,signature:A,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return y(d,D),console.log(`Created tool call ${D.id} for ${D.name}`),D}function T(d,C){console.log("handlePermissionRequest received:",C);const A=C.metadata?.tool_name||C.tool_name,D=C.metadata?.input_params||C.input_params,j=C.metadata?.request_id||C.request_id,I=C.metadata?.suggestions||C.suggestions||[];console.log("Extracted data:",{toolName:A,inputParams:D,requestId:j,suggestions:I});const U=p(A,D),H=u.value.get(U);H?(r.value.set(j,H),b(d,H,{status:"permission_required",permissionRequestId:j,suggestions:I}),console.log(`Permission required for tool ${H}`,{suggestions:I})):console.warn("No tool use ID found for permission request signature:",U,{toolName:A,inputParams:D,availableSignatures:Array.from(u.value.keys())})}function S(d,C){const A=r.value.get(C.request_id);if(A){const D={permissionDecision:C.decision,appliedUpdates:C.applied_updates||[]};C.decision==="allow"?D.status="executing":(D.status="completed",D.result={error:!0,message:C.reasoning||"Permission denied"},D.isExpanded=!1),b(d,A,D),console.log(`Permission ${C.decision} for tool ${A}`)}}function w(d,C){const A=C.tool_use_id;b(d,A,{status:C.is_error?"error":"completed",result:{error:C.is_error,content:C.content},isExpanded:!1}),console.log(`Tool ${A} ${C.is_error?"failed":"completed"}`)}function x(d,C){const A=t.value.get(d);if(A){const D=A.find(j=>j.id===C);D&&(D.isExpanded=!D.isExpanded,t.value=new Map(t.value))}}function p(d,C){if(!d)return"unknown:{}";if(!C||typeof C!="object")return`${d}:{}`;const A=JSON.stringify(C,Object.keys(C).sort());return`${d}:${A}`}function m(d,C,A){const D=n.value.get(d)||new Map;D.set(C,{reason:"denied",message:A}),n.value.set(d,D);const j=t.value.get(d);if(j){const I=j.find(U=>U.id===C);I&&I.isExpanded&&(I.isExpanded=!1,t.value=new Map(t.value))}console.log(`Marked tool use ${C} as orphaned: ${A}`)}function N(d,C){return n.value.get(d)?.has(C)||!1}function z(d,C){return n.value.get(d)?.get(C)}function k(d,C){const A=o.value.get(d);A&&A.size>0&&(A.forEach(D=>m(d,D,C)),A.clear())}function E(d){s.value.delete(d),t.value.delete(d),s.value=new Map(s.value),t.value=new Map(t.value)}function W(d){return v.value.get(d)}async function R(d){const C=v.value.get(d);if(!C)return console.log(`No sync needed for session ${d} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${d} since ${C}`);const A=await K.get(`/api/sessions/${d}/messages?limit=1000&offset=0`),D=A.messages||[],j=A.has_more||!1,I=new Date(C).getTime(),U=D.filter(q=>q.timestamp?new Date(q.timestamp).getTime()>I:!1);if(U.length===0)return console.log(`No missed messages for session ${d}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${U.length} missed messages for session ${d}`);const H=s.value.get(d)||[],B=new Set(H.map(q=>q.id).filter(Boolean)),oe=U.filter(q=>!q.id||!B.has(q.id));console.log(`After deduplication: ${oe.length} unique new messages`);const ve=[...H,...oe].sort((q,X)=>{const $e=new Date(q.timestamp||0).getTime(),He=new Date(X.timestamp||0).getTime();return $e-He});if(s.value.set(d,ve),oe.forEach(q=>{h(d,q),q.metadata?.has_tool_uses&&q.metadata.tool_uses&&q.metadata.tool_uses.forEach(X=>{M(d,X)}),q.metadata?.has_tool_results&&q.metadata.tool_results&&q.metadata.tool_results.forEach(X=>{w(d,X)}),(q.type==="permission_request"||q.metadata?.has_permission_requests)&&T(d,q),q.type==="system"&&(q.subtype==="init"||q.metadata?.subtype==="init")&&q.metadata?.init_data&&J().storeInitData(d,q.metadata.init_data)}),ve.length>0){const q=ve[ve.length-1];q.timestamp&&v.value.set(d,q.timestamp)}return s.value=new Map(s.value),{syncedCount:oe.length,hasMore:j}}catch(A){return console.error(`Failed to sync messages for session ${d}:`,A),{syncedCount:0,hasMore:!1,error:A.message}}}const O=J();return te(()=>Array.from(O.sessions.values()).map(C=>({id:C.session_id,state:C.state})),(d,C)=>{C&&d.forEach((A,D)=>{const j=C[D];if(!j||j.id!==A.id)return;const I=["active","paused","starting"].includes(j.state),U=!["active","paused","starting"].includes(A.state);I&&U&&k(A.id,"Session was terminated")})},{deep:!0}),{messagesBySession:s,toolCallsBySession:t,activeToolUses:Pe(o),orphanedToolUses:Pe(n),currentMessages:_,currentToolCalls:c,loadMessages:f,addMessage:$,addToolCall:y,updateToolCall:b,handleToolUse:M,handlePermissionRequest:T,handlePermissionResponse:S,handleToolResult:w,toggleToolExpansion:x,clearMessages:E,markToolUseOrphaned:m,isToolUseOrphaned:N,getOrphanedInfo:z,clearOrphanedToolUses:k,getLastReceivedTimestamp:W,syncMessages:R}}),$t=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:de},Symbol.toStringTag,{value:"Module"}));function wt(s){if(!s)return new Date;if(typeof s=="string"){const t=new Date(s);return isNaN(t.getTime())?new Date:t}return typeof s=="number"?s<1e10?new Date(s*1e3):new Date(s):new Date}function Se(s){return wt(s).toLocaleTimeString()}const St={class:"card user-message bg-light border-start border-primary border-3"},kt={class:"card-body"},Ct={class:"d-flex justify-content-between align-items-center mb-2"},xt={class:"text-muted"},Mt=["innerHTML"],jt={key:0,class:"tool-results mt-3"},Tt={class:"tool-results-header text-muted small mb-2"},Et={class:"d-flex align-items-start gap-2"},Pt={class:"flex-grow-1"},Lt={class:"text-muted"},It={key:0,class:"text-danger small"},Dt={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(s){const t=s;he.setOptions({breaks:!0,gfm:!0});const u=i(()=>Se(t.message.timestamp)),r=i(()=>{const _=t.message.content||"",c=he.parse(_);return je.sanitize(c)}),o=i(()=>t.message.metadata?.has_tool_results&&t.message.metadata?.tool_results?.length>0),n=i(()=>t.message.metadata?.tool_results||[]);function v(_,c){return _?_.length<=c?_:_.substring(0,c)+"...":""}return(_,c)=>(l(),a("div",St,[e("div",kt,[e("div",Ct,[c[0]||(c[0]=e("div",{class:"d-flex align-items-center gap-2"},[e("span",{class:"message-icon"},"ðŸ‘¤"),e("strong",{class:"message-role"},"User")],-1)),e("small",xt,g(u.value),1)]),e("div",{class:"message-content",innerHTML:r.value},null,8,Mt),o.value?(l(),a("div",jt,[e("div",Tt,[c[1]||(c[1]=e("i",{class:"bi bi-tools"},null,-1)),G(" Tool Results ("+g(n.value.length)+") ",1)]),(l(!0),a(Z,null,ee(n.value,(f,h)=>(l(),a("div",{key:h,class:V(["tool-result-summary p-2 mb-2 rounded",f.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[e("div",Et,[e("span",null,g(f.is_error?"âŒ":"âœ…"),1),e("div",Pt,[e("small",Lt,"Tool: "+g(f.tool_use_id),1),f.is_error?(l(),a("div",It,g(v(f.content,200)),1)):P("",!0)])])],2))),128))])):P("",!0)])]))}},Ot=F(Dt,[["__scopeId","data-v-532549d1"]]),Nt={class:"thinking-block"},At={class:"text-muted ms-auto"},Rt={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},qt=["innerHTML"],Wt={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(s){const t=s,u=L(!1),r=i(()=>t.thinking?.length||0),o=i(()=>{const v=t.thinking||"",_=he.parse(v);return je.sanitize(_)});function n(){u.value=!u.value}return(v,_)=>(l(),a("div",Nt,[e("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:n},[e("i",{class:V(["bi",u.value?"bi-chevron-down":"bi-chevron-right"])},null,2),_[0]||(_[0]=e("span",{class:"thinking-label"},[e("i",{class:"bi bi-lightbulb"}),G(" Thinking ")],-1)),e("small",At,g(r.value)+" characters",1)]),u.value?(l(),a("div",Rt,[e("div",{class:"thinking-text",innerHTML:o.value},null,8,qt)])):P("",!0)]))}},Ut=F(Wt,[["__scopeId","data-v-619a8344"]]),ge=_e("websocket",()=>{const s=L(null),t=L(!1),u=L(0),r=10,o=L(null),n=L(!1),v=L(0),_=5,c=L(null);let f=null;const h=L(0),$=L(null),y=L(new Map),b=L(null),M=L(!1),T=L(0),S=5,w=L(null),x=i(()=>t.value&&(n.value||!c.value)?"connected":t.value?"partial":"disconnected");function p(j){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${j}`}function m(){if(s.value)return;const j=p("/ws/ui");console.log(`Connecting to UI WebSocket: ${j}`),s.value=new WebSocket(j),s.value.onopen=()=>{t.value=!0,u.value=0,console.log("UI WebSocket connected")},s.value.onmessage=I=>{const U=JSON.parse(I.data);O(U)},s.value.onclose=()=>{if(t.value=!1,s.value=null,console.log("UI WebSocket closed"),u.value<r){u.value++;const I=Math.min(2e3*u.value,3e4);console.log(`Reconnecting UI WebSocket in ${I}ms (attempt ${u.value})`),setTimeout(m,I)}},s.value.onerror=I=>{console.error("UI WebSocket error:",I)}}function N(){s.value&&(s.value.close(),s.value=null,t.value=!1)}async function z(j){h.value++;const I=h.value;if(console.log(`[Gen ${I}] Starting connection to session ${j}`),f&&(clearTimeout(f),f=null),await k(),h.value!==I){console.log(`[Gen ${I}] Connection cancelled (current generation: ${h.value})`);return}c.value=j,$.value=I;const U=p(`/ws/session/${j}`);console.log(`[Gen ${I}] Connecting to Session WebSocket: ${U}`),o.value=new WebSocket(U),o.value.onopen=async()=>{if($.value!==I){console.log(`[Gen ${I}] Ignoring onopen (stale connection, current: ${$.value})`),o.value.close();return}n.value=!0,v.value=0,console.log(`[Gen ${I}] Session WebSocket connected for ${j}`);const H=y.value.get(j);if(y.value.set(j,!0),H){console.log(`[Gen ${I}] Reconnection detected, syncing missed messages...`);try{const oe=await de().syncMessages(j);oe.syncedCount>0?console.log(`[Gen ${I}] âœ… Synced ${oe.syncedCount} missed messages`):oe.error?console.warn(`[Gen ${I}] âš ï¸ Message sync failed: ${oe.error}`):console.log(`[Gen ${I}] No missed messages to sync`),oe.hasMore&&console.warn(`[Gen ${I}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(B){console.error(`[Gen ${I}] Error during message sync:`,B)}}else console.log(`[Gen ${I}] Initial connection, no sync needed`)},o.value.onmessage=H=>{if($.value!==I){console.log(`[Gen ${I}] Ignoring message (stale connection, current: ${$.value})`);return}const B=JSON.parse(H.data);d(B,j)},o.value.onclose=()=>{n.value=!1,o.value=null,console.log(`[Gen ${I}] Session WebSocket closed for ${j}`);const H=J();if(H.currentSessionId===j&&$.value===I&&v.value<_){v.value++;const B=Math.min(2e3*v.value,3e4);console.log(`[Gen ${I}] Reconnecting Session WebSocket in ${B}ms (attempt ${v.value})`),f=setTimeout(()=>{$.value===I&&H.currentSessionId===j?(f=null,z(j)):console.log(`[Gen ${I}] Skipping reconnect (generation or session changed)`)},B)}},o.value.onerror=H=>{console.error(`[Gen ${I}] Session WebSocket error:`,H)}}function k(){return new Promise(j=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),o.value){const I=()=>{o.value=null,n.value=!1,c.value=null,$.value=null,v.value=0,y.value.delete(sessionId),j()};if(o.value.readyState===WebSocket.CLOSED)I();else{const U=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),I()},2e3);o.value.addEventListener("close",()=>{clearTimeout(U),I()},{once:!0}),o.value.close()}}else c.value=null,$.value=null,j()})}function E(j){o.value&&n.value?(o.value.send(JSON.stringify({type:"send_message",content:j})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function W(j,I,U=!1,H=null){if(o.value&&n.value){const B={type:"permission_response",request_id:j,decision:I,apply_suggestions:U,timestamp:new Date().toISOString()};H&&(B.clarification_message=H),o.value.send(JSON.stringify(B)),console.log(`Sent permission ${I} for request ${j}`,{applySuggestions:U,clarification:H})}}function R(){o.value&&n.value&&(o.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function O(j){const I=J(),U=le();switch(j.type){case"sessions_list":j.sessions&&Array.isArray(j.sessions)&&j.sessions.forEach(H=>{I.updateSession(H.session_id,H)});break;case"state_change":j.data&&j.data.session_id&&j.data.session&&I.updateSession(j.data.session_id,j.data.session);break;case"project_updated":if(j.data&&j.data.project){const H=j.data.project;U.updateProjectLocal(H.project_id,H)}break;case"project_deleted":j.data&&j.data.project_id&&U.projects.delete(j.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":s.value?.readyState===WebSocket.OPEN&&s.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",j.type)}}function d(j,I){const U=J();if(U.currentSessionId!==I){console.warn(`Ignoring message for session ${I} (current: ${U.currentSessionId})`);return}const H=de();switch(j.type){case"message":const B=j.data;if(!B||!B.type){console.warn("Received message event with invalid data:",j);break}if(B.type==="permission_request"){H.handlePermissionRequest(I,B);break}if(B.type==="permission_response"){H.handlePermissionResponse(I,B);break}B.metadata?.has_tool_uses&&B.metadata.tool_uses.forEach(oe=>{H.handleToolUse(I,oe)}),B.metadata?.has_tool_results&&B.metadata.tool_results.forEach(oe=>{H.handleToolResult(I,oe)}),B.type==="system"&&(B.subtype==="init"||B.metadata?.subtype==="init")&&B.metadata?.init_data&&U.storeInitData(I,B.metadata.init_data),H.addMessage(I,B);break;case"permission_request":H.handlePermissionRequest(I,j);break;case"permission_response":H.handlePermissionResponse(I,j);break;case"tool_result":H.handleToolResult(I,j);break;case"state_change":U.updateSession(I,j.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${I}`);break;case"ping":o.value?.readyState===WebSocket.OPEN&&o.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function C(j){A(),w.value=j;const I=p(`/ws/legion/${j}`);console.log(`Connecting to Legion WebSocket: ${I}`),b.value=new WebSocket(I),b.value.onopen=()=>{M.value=!0,T.value=0,console.log(`Legion WebSocket connected for ${j}`)},b.value.onmessage=U=>{const H=JSON.parse(U.data);D(H,j)},b.value.onclose=()=>{if(M.value=!1,b.value=null,console.log(`Legion WebSocket closed for ${j}`),w.value===j&&T.value<S){T.value++;const U=Math.min(2e3*T.value,3e4);setTimeout(()=>C(j),U)}},b.value.onerror=U=>{console.error("Legion WebSocket error:",U)}}function A(){b.value&&(b.value.close(),b.value=null,M.value=!1,w.value=null)}function D(j,I){ae(async()=>{const{useLegionStore:U}=await Promise.resolve().then(()=>ir);return{useLegionStore:U}},void 0).then(({useLegionStore:U})=>{const H=U();switch(j.type){case"comm":j.comm&&(H.addComm(I,j.comm),console.log("Legion WebSocket: Received new comm",j.comm));break;case"minion_created":j.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",j.data),ae(async()=>{const{useSessionStore:B}=await Promise.resolve().then(()=>Ie);return{useSessionStore:B}},void 0).then(({useSessionStore:B})=>{B().loadSessions()}));break;case"minion_updated":j.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",j.data),ae(async()=>{const{useSessionStore:B}=await Promise.resolve().then(()=>Ie);return{useSessionStore:B}},void 0).then(({useSessionStore:B})=>{B().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${I}`);break;case"ping":b.value?.readyState===WebSocket.OPEN&&b.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",j.type)}})}return{uiConnected:t,sessionConnected:n,legionConnected:M,overallStatus:x,connectUI:m,disconnectUI:N,connectSession:z,disconnectSession:k,sendMessage:E,sendPermissionResponse:W,interruptSession:R,connectLegion:C,disconnectLegion:A}}),Ht=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ge},Symbol.toStringTag,{value:"Module"})),Ft={class:"base-tool-handler"},Bt={class:"tool-section mb-3"},Vt={class:"tool-parameters"},zt={class:"tool-code"},Gt={key:0,class:"tool-section"},Jt={class:"tool-section-label"},Kt={class:"tool-code"},Yt={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?JSON.stringify(t.toolCall.input,null,2):"{}"),r=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),o=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),n=i(()=>{if(!r.value)return"";const v=t.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,_)=>(l(),a("div",Ft,[e("div",Bt,[_[0]||(_[0]=e("div",{class:"tool-section-label"},"Parameters:",-1)),e("div",Vt,[e("pre",zt,g(u.value),1)])]),r.value?(l(),a("div",Gt,[e("div",Jt,g(o.value?"Error:":"Result:"),1),e("div",{class:V(["tool-result",{"tool-result-error":o.value}])},[e("pre",Kt,g(n.value),1)],2)])):P("",!0)]))}},Qt=F(Yt,[["__scopeId","data-v-06a1b6c0"]]),Zt={class:"read-tool-handler"},Xt={class:"tool-section mb-3"},es={class:"read-file-info"},ts={class:"file-path"},ss={key:0,class:"read-range"},os={key:0,class:"tool-section"},ns={key:0,class:"tool-result tool-result-error"},ls={class:"tool-code"},as={key:1,class:"file-content-preview"},rs={class:"content-header"},is={class:"line-count-badge"},cs={key:0,class:"preview-note"},us={class:"tool-code content-display"},ds={key:0,class:"more-indicator"},Ce=100,ms={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?.file_path||"Unknown"),r=i(()=>{const b=t.toolCall.input?.offset,M=t.toolCall.input?.limit;return b!==void 0||M!==void 0}),o=i(()=>{const b=t.toolCall.input?.offset;return b!==void 0?b+1:1}),n=i(()=>{const b=t.toolCall.input?.offset||0,M=t.toolCall.input?.limit;return M!==void 0?b+M:"âˆž"}),v=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),_=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),c=i(()=>{if(!v.value)return"";const b=t.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)}),f=i(()=>_.value||!c.value?[]:c.value.split(`
`)),h=i(()=>f.value.length),$=i(()=>h.value>Ce),y=i(()=>_.value?"":f.value.slice(0,Ce).join(`
`));return(b,M)=>(l(),a("div",Zt,[e("div",Xt,[e("div",es,[M[0]||(M[0]=e("span",{class:"file-icon"},"ðŸ“„",-1)),M[1]||(M[1]=e("strong",null,"Reading:",-1)),e("code",ts,g(u.value),1),r.value?(l(),a("span",ss,"Lines "+g(o.value)+"-"+g(n.value),1)):P("",!0)])]),v.value?(l(),a("div",os,[_.value?(l(),a("div",ns,[e("pre",ls,g(c.value),1)])):(l(),a("div",as,[e("div",rs,[M[2]||(M[2]=e("span",{class:"content-label"},"Content Preview:",-1)),e("span",is,g(h.value)+" lines",1),$.value?(l(),a("span",cs,"(showing first "+g(Ce)+")")):P("",!0)]),e("pre",us,g(y.value),1),$.value?(l(),a("div",ds,"...")):P("",!0)]))])):P("",!0)]))}},ps=F(ms,[["__scopeId","data-v-0382f812"]]),vs={class:"write-tool-handler"},fs={class:"tool-section mb-3"},gs={class:"write-file-info mb-2"},_s={class:"file-path"},bs={class:"write-content-preview"},hs={class:"content-header"},ys={class:"line-count-badge"},$s={key:0,class:"preview-note"},ws={class:"tool-code content-display"},Ss={key:0,class:"more-indicator"},ks={key:0,class:"tool-section"},Cs={key:0,class:"tool-result tool-result-error"},xs={class:"tool-code"},Ms={key:1,class:"tool-result tool-result-success"},js={class:"success-message"},xe=100,Ts={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?.file_path||"Unknown"),r=i(()=>t.toolCall.input?.content||""),o=i(()=>r.value.split(`
`)),n=i(()=>o.value.length),v=i(()=>n.value>xe),_=i(()=>o.value.slice(0,xe).join(`
`)),c=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),f=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),h=i(()=>{if(!c.value)return"";const $=t.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,y)=>(l(),a("div",vs,[e("div",fs,[e("div",gs,[y[0]||(y[0]=e("span",{class:"file-icon"},"ðŸ“",-1)),y[1]||(y[1]=e("strong",null,"Writing:",-1)),e("code",_s,g(u.value),1)]),e("div",bs,[e("div",hs,[y[2]||(y[2]=e("span",{class:"content-label"},"Content:",-1)),e("span",ys,g(n.value)+" lines",1),v.value?(l(),a("span",$s,"(showing first "+g(xe)+")")):P("",!0)]),e("pre",ws,g(_.value),1),v.value?(l(),a("div",Ss,"...")):P("",!0)])]),c.value?(l(),a("div",ks,[f.value?(l(),a("div",Cs,[y[3]||(y[3]=e("strong",null,"Error:",-1)),e("pre",xs,g(h.value),1)])):(l(),a("div",Ms,[e("div",js,[y[4]||(y[4]=e("span",{class:"success-icon"},"âœ…",-1)),e("strong",null,"File created successfully ("+g(n.value)+" lines written)",1)])]))])):P("",!0)]))}},Es=F(Ts,[["__scopeId","data-v-d09b89ef"]]),Ps={class:"bash-tool-handler"},Ls={class:"tool-section mb-3"},Is={class:"bash-header"},Ds={class:"bash-header-content"},Os={key:0,class:"bash-description"},Ns={key:1,class:"bash-flags"},As={class:"bash-command-section"},Rs={class:"bash-command-content"},qs={key:0,class:"tool-section"},Ws={key:0,class:"bash-output"},Us={key:1,class:"bash-output-empty"},Hs={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?.command||""),r=i(()=>t.toolCall.input?.description||""),o=i(()=>t.toolCall.input?.timeout),n=i(()=>t.toolCall.input?.run_in_background||!1),v=i(()=>o.value||n.value),_=i(()=>{const y=[];return o.value&&y.push(`timeout: ${o.value}ms`),n.value&&y.push("background"),y.join(", ")}),c=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),f=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),h=i(()=>f.value?"tool-result-error":"tool-result-success"),$=i(()=>{if(!c.value)return"";const y=t.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,b)=>(l(),a("div",Ps,[e("div",Ls,[e("div",Is,[b[1]||(b[1]=e("span",{class:"bash-icon"},"ðŸ’»",-1)),e("div",Ds,[r.value?(l(),a("div",Os,[b[0]||(b[0]=e("strong",null,"Description:",-1)),G(" "+g(r.value),1)])):P("",!0),v.value?(l(),a("div",Ns,g(_.value),1)):P("",!0)])]),e("div",As,[b[2]||(b[2]=e("div",{class:"bash-command-label"},[e("strong",null,"Command:")],-1)),e("div",Rs,g(u.value),1)])]),c.value?(l(),a("div",qs,[e("div",{class:V(["tool-result",h.value])},[b[3]||(b[3]=e("strong",null,"Output:",-1)),$.value?(l(),a("pre",Ws,g($.value),1)):(l(),a("div",Us,"No output"))],2)])):P("",!0)]))}},Fs=F(Hs,[["__scopeId","data-v-dc93bb16"]]),Bs={class:"todo-tool-handler"},Vs={class:"tool-section mb-3"},zs={class:"todo-header"},Gs={class:"todo-summary"},Js={key:0,class:"todo-count todo-count-completed"},Ks={key:1,class:"todo-count todo-count-in-progress"},Ys={key:2,class:"todo-count todo-count-pending"},Qs={class:"todo-checklist"},Zs={class:"todo-checkbox"},Xs={class:"todo-content"},eo={key:0,class:"tool-section"},to={key:0,class:"tool-result tool-result-error"},so={class:"tool-code"},oo={key:1,class:"tool-result tool-result-success"},no={class:"success-message"},lo={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?.todos||[]),r=i(()=>u.value.filter(h=>h.status==="completed").length),o=i(()=>u.value.filter(h=>h.status==="in_progress").length),n=i(()=>u.value.filter(h=>h.status==="pending").length);function v(h){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[h]||"â˜"}const _=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),c=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),f=i(()=>{if(!_.value)return"";const h=t.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,$)=>(l(),a("div",Bs,[e("div",Vs,[e("div",zs,[$[0]||($[0]=e("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=e("strong",null,"Task List:",-1)),e("div",Gs,[r.value>0?(l(),a("span",Js,g(r.value)+" completed ",1)):P("",!0),o.value>0?(l(),a("span",Ks,g(o.value)+" in progress ",1)):P("",!0),n.value>0?(l(),a("span",Ys,g(n.value)+" pending ",1)):P("",!0)])]),e("div",Qs,[(l(!0),a(Z,null,ee(u.value,(y,b)=>(l(),a("div",{key:b,class:V(["todo-item",`todo-${y.status}`])},[e("span",Zs,g(v(y.status)),1),e("span",Xs,g(y.content),1)],2))),128))])]),_.value?(l(),a("div",eo,[c.value?(l(),a("div",to,[$[2]||($[2]=e("strong",null,"Error:",-1)),e("pre",so,g(f.value),1)])):(l(),a("div",oo,[e("div",no,[$[3]||($[3]=e("span",{class:"success-icon"},"âœ…",-1)),e("strong",null,"Task list updated ("+g(u.value.length)+" tasks)",1)])]))])):P("",!0)]))}},ao=F(lo,[["__scopeId","data-v-0984bcf9"]]),ro={class:"edit-tool-handler"},io={class:"tool-section mb-3"},co={class:"edit-file-info"},uo={class:"file-path"},mo={key:0,class:"replace-all-badge"},po={class:"edit-diff-container"},vo={class:"diff-header"},fo={class:"diff-stats"},go={class:"stat-removed"},_o={class:"stat-added"},bo={class:"unified-diff"},ho={class:"diff-scroll-container"},yo={class:"diff-marker"},$o={class:"diff-content"},wo={key:0,class:"tool-section"},So={key:0,class:"tool-result tool-result-error"},ko={class:"tool-code"},Co={key:1,class:"tool-result tool-result-success"},xo={class:"success-message"},Mo={key:0,class:"success-detail"},jo={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?.file_path||"Unknown"),r=i(()=>t.toolCall.input?.old_string||""),o=i(()=>t.toolCall.input?.new_string||""),n=i(()=>t.toolCall.input?.replace_all||!1),v=i(()=>{const b=Ge(u.value,r.value,o.value,"","",{context:3}).split(`
`),M=[];for(let T=4;T<b.length;T++){const S=b[T];S&&(S.startsWith("-")?M.push({type:"removed",content:S.substring(1)}):S.startsWith("+")?M.push({type:"added",content:S.substring(1)}):S.startsWith(" ")?M.push({type:"context",content:S.substring(1)}):S.startsWith("@@")&&M.push({type:"hunk",content:S}))}return M}),_=i(()=>v.value.filter(y=>y.type==="removed").length),c=i(()=>v.value.filter(y=>y.type==="added").length),f=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),h=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),$=i(()=>{if(!f.value)return"";const y=t.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,b)=>(l(),a("div",ro,[e("div",io,[e("div",co,[b[0]||(b[0]=e("span",{class:"file-icon"},"âœï¸",-1)),b[1]||(b[1]=e("strong",null,"Editing:",-1)),e("code",uo,g(u.value),1),n.value?(l(),a("span",mo,"Replace All")):P("",!0)]),e("div",po,[e("div",vo,[b[2]||(b[2]=e("span",{class:"diff-label"},"Changes:",-1)),e("span",fo,[e("span",go,"-"+g(_.value),1),e("span",_o,"+"+g(c.value),1)])]),e("div",bo,[e("div",ho,[(l(!0),a(Z,null,ee(v.value,(M,T)=>(l(),a("div",{key:T,class:V(["diff-line",{"diff-line-removed":M.type==="removed","diff-line-added":M.type==="added","diff-line-context":M.type==="context","diff-line-hunk":M.type==="hunk"}])},[e("span",yo,g(M.type==="removed"?"-":M.type==="added"?"+":M.type==="hunk"?"@":" "),1),e("span",$o,g(M.content),1)],2))),128))])])])]),f.value?(l(),a("div",wo,[h.value?(l(),a("div",So,[b[3]||(b[3]=e("strong",null,"Error:",-1)),e("pre",ko,g($.value),1)])):(l(),a("div",Co,[e("div",xo,[b[4]||(b[4]=e("span",{class:"success-icon"},"âœ…",-1)),b[5]||(b[5]=e("strong",null,"File edited successfully",-1)),n.value?(l(),a("span",Mo,"(all occurrences replaced)")):P("",!0)])]))])):P("",!0)]))}},To=F(jo,[["__scopeId","data-v-b06adbf2"]]),Eo={class:"search-tool-handler"},Po={class:"tool-section mb-3"},Lo={class:"search-info"},Io={class:"search-icon"},Do={class:"search-pattern"},Oo={key:0,class:"search-path"},No={key:1,class:"search-filters"},Ao={key:0,class:"filter-badge"},Ro={key:1,class:"filter-badge"},qo={key:2,class:"filter-badge"},Wo={key:0,class:"tool-section"},Uo={key:0,class:"tool-result tool-result-error"},Ho={class:"tool-code"},Fo={key:1,class:"search-results"},Bo={class:"results-header"},Vo={class:"results-label"},zo={class:"results-count-badge"},Go={class:"results-content"},Jo={class:"tool-code"},Ko={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.name==="Grep");i(()=>t.toolCall.name==="Glob");const r=i(()=>t.toolCall.input?.pattern||"Unknown"),o=i(()=>t.toolCall.input?.path||null),n=i(()=>t.toolCall.input?.type||null),v=i(()=>t.toolCall.input?.glob||null),_=i(()=>t.toolCall.input?.["-i"]||!1),c=i(()=>n.value||v.value||_.value),f=i(()=>u.value?"ðŸ”":"ðŸ“"),h=i(()=>u.value?"Searching content":"Finding files"),$=i(()=>u.value?"Matches":"Files found"),y=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),b=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),M=i(()=>{if(!y.value)return"";const S=t.toolCall.result;return S.content!==void 0?typeof S.content=="string"?S.content:JSON.stringify(S.content,null,2):S.message?S.message:JSON.stringify(S,null,2)}),T=i(()=>!y.value||b.value||!M.value?0:M.value.split(`
`).filter(w=>w.trim()).length);return(S,w)=>(l(),a("div",Eo,[e("div",Po,[e("div",Lo,[e("span",Io,g(f.value),1),e("strong",null,g(h.value)+":",1),e("code",Do,g(r.value),1),o.value?(l(),a("span",Oo,"in "+g(o.value),1)):P("",!0),c.value?(l(),a("span",No,[n.value?(l(),a("span",Ao,"type: "+g(n.value),1)):P("",!0),v.value?(l(),a("span",Ro,"glob: "+g(v.value),1)):P("",!0),_.value?(l(),a("span",qo,"case-insensitive")):P("",!0)])):P("",!0)])]),y.value?(l(),a("div",Wo,[b.value?(l(),a("div",Uo,[w[0]||(w[0]=e("strong",null,"Error:",-1)),e("pre",Ho,g(M.value),1)])):(l(),a("div",Fo,[e("div",Bo,[e("span",Vo,g($.value)+":",1),e("span",zo,g(T.value)+" "+g(T.value===1?"match":"matches"),1)]),e("div",Go,[e("pre",Jo,g(M.value),1)])]))])):P("",!0)]))}},De=F(Ko,[["__scopeId","data-v-dc01ae0d"]]),Yo={class:"web-tool-handler"},Qo={class:"tool-section mb-3"},Zo={class:"web-info"},Xo={class:"web-icon"},en=["href"],tn={key:1,class:"web-query"},sn={key:0,class:"web-prompt-container"},on={class:"prompt-content"},nn={key:1,class:"web-domains"},ln={class:"domains-label"},an={key:0,class:"tool-section"},rn={key:0,class:"tool-result tool-result-error"},cn={class:"tool-code"},un={key:1,class:"web-results"},dn={class:"results-header"},mn={class:"results-label"},pn={class:"results-content"},vn={class:"tool-code"},fn={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.name==="WebFetch");i(()=>t.toolCall.name==="WebSearch");const r=i(()=>t.toolCall.input?.url||null),o=i(()=>t.toolCall.input?.query||null),n=i(()=>t.toolCall.input?.prompt||null),v=i(()=>t.toolCall.input?.allowed_domains||[]),_=i(()=>t.toolCall.input?.blocked_domains||[]),c=i(()=>v.value.length>0?v.value:_.value.length>0?_.value:[]),f=i(()=>v.value.length>0?"Allowed domains":_.value.length>0?"Blocked domains":"Domains"),h=i(()=>u.value?"ðŸŒ":"ðŸ”Ž"),$=i(()=>u.value?"Fetching URL":"Searching web"),y=i(()=>u.value?"Fetched content":"Search results"),b=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),M=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),T=i(()=>{if(!b.value)return"";const S=t.toolCall.result;return S.content!==void 0?typeof S.content=="string"?S.content:JSON.stringify(S.content,null,2):S.message?S.message:JSON.stringify(S,null,2)});return(S,w)=>(l(),a("div",Yo,[e("div",Qo,[e("div",Zo,[e("span",Xo,g(h.value),1),e("strong",null,g($.value)+":",1),r.value?(l(),a("a",{key:0,href:r.value,target:"_blank",class:"web-url"},g(r.value),9,en)):o.value?(l(),a("code",tn,g(o.value),1)):P("",!0)]),n.value?(l(),a("div",sn,[w[0]||(w[0]=e("div",{class:"prompt-label"},"Prompt:",-1)),e("div",on,g(n.value),1)])):P("",!0),c.value.length>0?(l(),a("div",nn,[e("span",ln,g(f.value)+":",1),(l(!0),a(Z,null,ee(c.value,x=>(l(),a("span",{key:x,class:"domain-badge"},g(x),1))),128))])):P("",!0)]),b.value?(l(),a("div",an,[M.value?(l(),a("div",rn,[w[1]||(w[1]=e("strong",null,"Error:",-1)),e("pre",cn,g(T.value),1)])):(l(),a("div",un,[e("div",dn,[e("span",mn,g(y.value)+":",1)]),e("div",pn,[e("pre",vn,g(T.value),1)])]))])):P("",!0)]))}},Oe=F(fn,[["__scopeId","data-v-49e16a90"]]),gn={class:"task-tool-handler"},_n={class:"tool-section mb-3"},bn={class:"task-header"},hn={key:0,class:"agent-type-badge"},yn={key:0,class:"task-description"},$n={class:"description-content"},wn={key:1,class:"task-prompt-container"},Sn={class:"prompt-header"},kn={class:"prompt-length"},Cn={class:"prompt-code"},xn={key:0,class:"tool-section"},Mn={key:0,class:"tool-result tool-result-error"},jn={class:"tool-code"},Tn={key:1,class:"agent-output"},En={class:"output-header"},Pn={key:0,class:"output-count-badge"},Ln={class:"output-content"},In={class:"tool-code"},Dn={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?.description||null),r=i(()=>t.toolCall.input?.prompt||null),o=i(()=>t.toolCall.input?.subagent_type||null),n=i(()=>t.toolCall.result!==null&&t.toolCall.result!==void 0),v=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),_=i(()=>{if(!n.value)return"";const f=t.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=i(()=>_.value?_.value.split(`
`).length:0);return(f,h)=>(l(),a("div",gn,[e("div",_n,[e("div",bn,[h[0]||(h[0]=e("span",{class:"task-icon"},"ðŸ¤–",-1)),h[1]||(h[1]=e("strong",null,"Agent Task:",-1)),o.value?(l(),a("span",hn,g(o.value),1)):P("",!0)]),u.value?(l(),a("div",yn,[h[2]||(h[2]=e("div",{class:"description-label"},"Description:",-1)),e("div",$n,g(u.value),1)])):P("",!0),r.value?(l(),a("div",wn,[e("div",Sn,[h[3]||(h[3]=e("span",{class:"prompt-label"},"Task Prompt:",-1)),e("span",kn,g(r.value.length)+" characters",1)]),e("pre",Cn,g(r.value),1)])):P("",!0)]),n.value?(l(),a("div",xn,[v.value?(l(),a("div",Mn,[h[4]||(h[4]=e("strong",null,"Error:",-1)),e("pre",jn,g(_.value),1)])):(l(),a("div",Tn,[e("div",En,[h[5]||(h[5]=e("span",{class:"output-label"},"Agent Output:",-1)),c.value>0?(l(),a("span",Pn,g(c.value)+" lines",1)):P("",!0)]),e("div",Ln,[e("pre",In,g(_.value),1)])]))])):P("",!0)]))}},On=F(Dn,[["__scopeId","data-v-513043f9"]]),Nn={class:"notebook-edit-tool-handler"},An={class:"tool-section mb-3"},Rn={class:"notebook-info"},qn={class:"file-path"},Wn={class:"cell-info mt-2"},Un={class:"info-row"},Hn={class:"info-row"},Fn={key:0,class:"info-row"},Bn={class:"badge bg-info"},Vn={key:0,class:"source-preview mt-3"},zn={class:"preview-header"},Gn={class:"preview-stats"},Jn={class:"source-code"},Kn={key:0,class:"tool-section"},Yn={key:0},Qn={key:1,class:"text-danger"},Zn={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?.notebook_path||"Unknown"),r=i(()=>t.toolCall.input?.cell_id),o=i(()=>t.toolCall.input?.cell_type||"code"),n=i(()=>t.toolCall.input?.edit_mode||"replace"),v=i(()=>t.toolCall.input?.new_source||""),_=i(()=>v.value.split(`
`).length),c=i(()=>o.value==="code"?"bg-primary":"bg-secondary"),f=i(()=>t.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=i(()=>{if(t.toolCall.result?.message)return t.toolCall.result.message;const $=n.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,y)=>(l(),a("div",Nn,[e("div",An,[e("div",Rn,[y[0]||(y[0]=e("span",{class:"notebook-icon"},"ðŸ““",-1)),y[1]||(y[1]=e("strong",null,"Notebook:",-1)),e("code",qn,g(u.value),1)]),e("div",Wn,[e("div",Un,[y[2]||(y[2]=e("strong",null,"Cell ID:",-1)),e("code",null,g(r.value||"N/A"),1)]),e("div",Hn,[y[3]||(y[3]=e("strong",null,"Cell Type:",-1)),e("span",{class:V(["badge",c.value])},g(o.value),3)]),n.value?(l(),a("div",Fn,[y[4]||(y[4]=e("strong",null,"Edit Mode:",-1)),e("span",Bn,g(n.value),1)])):P("",!0)]),v.value?(l(),a("div",Vn,[e("div",zn,[y[5]||(y[5]=e("span",{class:"preview-label"},"New Source:",-1)),e("span",Gn,g(_.value)+" lines",1)]),e("pre",Jn,[e("code",null,g(v.value),1)])])):P("",!0)]),s.toolCall.result?(l(),a("div",Kn,[y[8]||(y[8]=e("div",{class:"result-header mb-2"},[e("strong",null,"Result:")],-1)),e("div",{class:V(["tool-result",f.value])},[s.toolCall.result.success!==!1?(l(),a("div",Yn,[y[6]||(y[6]=e("i",{class:"bi bi-check-circle"},null,-1)),G(" "+g(h.value),1)])):(l(),a("div",Qn,[y[7]||(y[7]=e("i",{class:"bi bi-x-circle"},null,-1)),G(" "+g(s.toolCall.result.error||"Operation failed"),1)]))],2)])):P("",!0)]))}},Xn=F(Zn,[["__scopeId","data-v-3261abc1"]]),el={class:"shell-tool-handler"},tl={class:"tool-section mb-3"},sl={class:"shell-info"},ol={class:"shell-icon"},nl={key:0,class:"shell-id"},ll={key:0,class:"filter-info mt-2"},al={class:"filter-pattern"},rl={key:0,class:"tool-section"},il={class:"result-header mb-2"},cl={key:0,class:"shell-output"},ul={key:0},dl={key:1,class:"text-danger"},ml={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.name==="BashOutput"?"ðŸ“¤":t.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),r=i(()=>t.toolCall.name==="BashOutput"?"Reading Shell Output":t.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),o=i(()=>t.toolCall.name==="BashOutput"?"Output":t.toolCall.name==="KillShell"?"Status":"Result"),n=i(()=>t.toolCall.input?.bash_id||t.toolCall.input?.shell_id),v=i(()=>t.toolCall.input?.filter),_=i(()=>t.toolCall.name==="BashOutput"?t.toolCall.result?.output||t.toolCall.result?.stdout:null),c=i(()=>t.toolCall.result?.status),f=i(()=>{const y=c.value;return y==="running"?"bg-success":y==="completed"?"bg-secondary":y==="killed"||y==="terminated"?"bg-danger":"bg-info"}),h=i(()=>t.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),$=i(()=>t.toolCall.result?.message?t.toolCall.result.message:t.toolCall.name==="KillShell"?"Shell terminated successfully":"Operation completed");return(y,b)=>(l(),a("div",el,[e("div",tl,[e("div",sl,[e("span",ol,g(u.value),1),e("strong",null,g(r.value)+":",1),n.value?(l(),a("code",nl,"Shell "+g(n.value),1)):P("",!0)]),s.toolCall.name==="BashOutput"&&v.value?(l(),a("div",ll,[b[0]||(b[0]=e("strong",null,"Filter:",-1)),e("code",al,g(v.value),1)])):P("",!0)]),s.toolCall.result?(l(),a("div",rl,[e("div",il,[e("strong",null,g(o.value)+":",1),c.value?(l(),a("span",{key:0,class:V(["badge",f.value])},g(c.value),3)):P("",!0)]),_.value?(l(),a("div",cl,[e("pre",null,[e("code",null,g(_.value),1)])])):(l(),a("div",{key:1,class:V(["tool-result",h.value])},[s.toolCall.result.success!==!1?(l(),a("div",ul,[b[1]||(b[1]=e("i",{class:"bi bi-check-circle"},null,-1)),G(" "+g($.value),1)])):(l(),a("div",dl,[b[2]||(b[2]=e("i",{class:"bi bi-x-circle"},null,-1)),G(" "+g(s.toolCall.result.error||"Operation failed"),1)]))],2))])):P("",!0)]))}},Ne=F(ml,[["__scopeId","data-v-fc9da4c0"]]),pl={class:"command-tool-handler"},vl={class:"tool-section mb-3"},fl={class:"command-info"},gl={class:"command-icon"},_l={class:"command-code"},bl={key:0,class:"prompt-info mt-2"},hl={class:"prompt-content"},yl={key:0,class:"tool-section"},$l={key:0},wl={key:1,class:"text-danger"},Sl={__name:"CommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.name==="SlashCommand"?"/":t.toolCall.name==="Skill"?"âš¡":"ðŸ”§"),r=i(()=>t.toolCall.name==="SlashCommand"?"Slash Command":t.toolCall.name==="Skill"?"Skill":"Command"),o=i(()=>t.toolCall.input?.command||"Unknown"),n=i(()=>t.toolCall.result?.prompt||t.toolCall.result?.description),v=i(()=>t.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),_=i(()=>t.toolCall.result?.message?t.toolCall.result.message:t.toolCall.name==="SlashCommand"?"Slash command executed successfully":t.toolCall.name==="Skill"?"Skill executed successfully":"Command completed");return(c,f)=>(l(),a("div",pl,[e("div",vl,[e("div",fl,[e("span",gl,g(u.value),1),e("strong",null,g(r.value)+":",1),e("code",_l,g(o.value),1)]),n.value?(l(),a("div",bl,[f[0]||(f[0]=e("div",{class:"prompt-header"},[e("strong",null,"Expanded Prompt:")],-1)),e("div",hl,g(n.value),1)])):P("",!0)]),s.toolCall.result?(l(),a("div",yl,[f[3]||(f[3]=e("div",{class:"result-header mb-2"},[e("strong",null,"Result:")],-1)),e("div",{class:V(["tool-result",v.value])},[s.toolCall.result.success!==!1?(l(),a("div",$l,[f[1]||(f[1]=e("i",{class:"bi bi-check-circle"},null,-1)),G(" "+g(_.value),1)])):(l(),a("div",wl,[f[2]||(f[2]=e("i",{class:"bi bi-x-circle"},null,-1)),G(" "+g(s.toolCall.result.error||"Command execution failed"),1)]))],2)])):P("",!0)]))}},kl=F(Sl,[["__scopeId","data-v-57a8f93b"]]),Cl={class:"skill-tool-handler"},xl={class:"tool-section mb-3"},Ml={class:"skill-info"},jl={class:"skill-name"},Tl={key:0,class:"tool-section mb-3"},El={class:"base-directory-info"},Pl={class:"directory-path"},Ll={key:1,class:"tool-section"},Il={class:"d-flex align-items-center gap-2"},Dl={class:"text-muted small"},Ol={key:0,class:"skill-content-body"},Nl={class:"skill-content-text"},Al={key:2,class:"tool-section mt-3"},Rl={class:"tool-result tool-result-error"},ql={class:"tool-code"},Wl={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=de(),r=J(),o=L(!1);function n(){o.value=!o.value}const v=i(()=>t.toolCall.input?.command||"Unknown Skill"),_=i(()=>{switch(t.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return t.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),c=i(()=>{switch(t.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return t.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}}),f=i(()=>{const S=r.currentSessionId;if(!S)return{running:null,content:null};const w=u.messagesBySession.get(S)||[],x=w.findIndex(N=>N.type==="user"&&N.metadata?.has_tool_results&&N.metadata?.tool_results?.some(z=>z.tool_use_id===t.toolCall.id));if(x===-1)return{running:null,content:null};let p=null,m=null;for(let N=x+1;N<Math.min(x+3,w.length);N++){const z=w[N];if(z.type!=="user")continue;const k=z.content||"";k.includes("<command-message>")&&k.includes("skill is running")?p=z:k.startsWith("Base directory for this skill:")&&(m=z)}return{running:p,content:m}}),h=i(()=>{const S=f.value.content;if(!S)return null;const x=(S.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return x&&x[1]?x[1].trim():null}),$=i(()=>{const S=f.value.content;if(!S)return"";const w=S.content||"",x=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return w.replace(x,"").trim()}),y=i(()=>$.value.length>0),b=i(()=>$.value?$.value.split(`
`).length:0),M=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),T=i(()=>{if(!M.value)return"";const S=t.toolCall.result;return S?.message?S.message:S?.error?S.error:"An error occurred"});return(S,w)=>(l(),a("div",Cl,[e("div",xl,[e("div",Ml,[w[0]||(w[0]=e("span",{class:"skill-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=e("strong",null,"Skill:",-1)),e("code",jl,g(v.value),1),e("span",{class:V(["skill-status-badge",c.value])},g(_.value),3)])]),h.value?(l(),a("div",Tl,[e("div",El,[w[2]||(w[2]=e("span",{class:"directory-icon"},"ðŸ“",-1)),w[3]||(w[3]=e("strong",null,"Base directory:",-1)),e("code",Pl,g(h.value),1)])])):P("",!0),y.value?(l(),a("div",Ll,[e("div",{class:"skill-content-header",onClick:n},[e("div",Il,[e("i",{class:V(["bi",o.value?"bi-chevron-down":"bi-chevron-right"])},null,2),w[4]||(w[4]=e("strong",null,"Skill Content",-1)),e("span",Dl,"("+g(b.value)+" lines)",1)])]),o.value?(l(),a("div",Ol,[e("pre",Nl,g($.value),1)])):P("",!0)])):P("",!0),M.value?(l(),a("div",Al,[w[5]||(w[5]=e("div",{class:"tool-section-label text-danger"},[e("i",{class:"bi bi-x-circle"}),G(" Error: ")],-1)),e("div",Rl,[e("pre",ql,g(T.value),1)])])):P("",!0)]))}},Ul=F(Wl,[["__scopeId","data-v-a9fab5d1"]]),Hl={class:"exit-plan-mode-tool-handler"},Fl={class:"tool-section mb-3"},Bl={key:0,class:"plan-content mt-2"},Vl={class:"plan-text"},zl={key:0,class:"tool-section"},Gl={key:0},Jl={key:1,class:"text-danger"},Kl={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>t.toolCall.input?.plan),r=i(()=>t.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(o,n)=>(l(),a("div",Hl,[e("div",Fl,[n[1]||(n[1]=e("div",{class:"plan-info"},[e("span",{class:"plan-icon"},"ðŸ“‹"),e("strong",null,"Exiting Plan Mode")],-1)),u.value?(l(),a("div",Bl,[n[0]||(n[0]=e("div",{class:"plan-header"},[e("strong",null,"Proposed Plan:")],-1)),e("div",Vl,g(u.value),1)])):P("",!0)]),s.toolCall.result?(l(),a("div",zl,[n[4]||(n[4]=e("div",{class:"result-header mb-2"},[e("strong",null,"Result:")],-1)),e("div",{class:V(["tool-result",r.value])},[s.toolCall.result.success!==!1?(l(),a("div",Gl,[...n[2]||(n[2]=[e("i",{class:"bi bi-check-circle"},null,-1),G(" Permission mode reverted to default ",-1)])])):(l(),a("div",Jl,[n[3]||(n[3]=e("i",{class:"bi bi-x-circle"},null,-1)),G(" "+g(s.toolCall.result.error||"Failed to exit plan mode"),1)]))],2)])):P("",!0)]))}},Yl=F(Kl,[["__scopeId","data-v-f1d32203"]]),Ql={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Zl={class:"tool-status-icon"},Xl=["title"],ea={class:"text-muted small"},ta={class:"d-flex align-items-center gap-2"},sa={class:"text-muted"},oa={key:0,class:"card-body"},na={key:0,class:"alert alert-warning mb-3"},la={class:"d-flex align-items-center"},aa={class:"mb-0 small"},ra={key:1,class:"permission-prompt mt-3"},ia={class:"alert alert-warning mb-3"},ca={class:"mb-0"},ua={class:"tool-name"},da={key:0,class:"suggestions-section mb-3"},ma={class:"alert alert-info mb-0"},pa={class:"suggestion-details p-2 bg-white rounded"},va={class:"permission-buttons d-flex gap-2 mb-3"},fa=["disabled"],ga=["disabled"],_a=["disabled"],ba={class:"guidance-section mt-3"},ha=["disabled"],ya=["disabled"],$a={key:2,class:"mt-3"},wa={class:"alert alert-warning mb-0"},Sa={class:"d-flex align-items-center"},ka={class:"mb-0 small"},Ca={key:3,class:"tool-section mt-3"},xa={class:"alert alert-danger mb-0"},Ma={key:0},ja={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(s){const t=s,u=de(),r=J(),o=ge(),n=L(!1),v=L(null),_=L(""),c=i(()=>u.isToolUseOrphaned(r.currentSessionId,t.toolCall.id)),f=i(()=>u.getOrphanedInfo(r.currentSessionId,t.toolCall.id)),h={Read:ps,Write:Es,Bash:Fs,TodoWrite:ao,Edit:To,Grep:De,Glob:De,WebFetch:Oe,WebSearch:Oe,Task:On,NotebookEdit:Xn,BashOutput:Ne,KillShell:Ne,SlashCommand:kl,Skill:Ul,ExitPlanMode:Yl},$=i(()=>{const O=t.toolCall.name;return h[O]?h[O]:Qt}),y=i(()=>{const O=[];switch(t.toolCall.status){case"pending":O.push("border-secondary");break;case"permission_required":O.push("border-warning");break;case"executing":O.push("border-primary");break;case"completed":S.value||t.toolCall.permissionDecision==="deny"?O.push("border-danger"):O.push("border-success");break;case"error":O.push("border-danger");break}return O.join(" ")}),b=i(()=>{switch(t.toolCall.status){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return t.toolCall.permissionDecision==="deny"?"âŒ":S.value?"ðŸ’¥":"âœ…";case"error":return"ðŸ’¥";default:return"ðŸ”§"}}),M=i(()=>{switch(t.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Executing...";case"completed":return t.toolCall.permissionDecision==="deny"?"Denied":S.value?"Error":"Completed";case"error":return"Error";default:return"Unknown"}}),T=i(()=>Se(t.toolCall.timestamp)),S=i(()=>t.toolCall.result?.error||t.toolCall.status==="error"),w=i(()=>t.toolCall.suggestions&&t.toolCall.suggestions.length>0);function x(O){if(!O)return"";const d=O.replace(/\\/g,"/").split("/");return d[d.length-1]}function p(O,d=200){return O?O.length<=d?O:O.substring(0,d)+"...":""}function m(O){if(!O)return null;if(O.content){const d=O.content.match(/exit code (\d+)/i);if(d)return parseInt(d[1])}return O.error?1:0}function N(O,d){const C=O?O.split(`
`).length:0;return{added:d?d.split(`
`).length:0,removed:C}}const z=i(()=>{const O=t.toolCall.name,d=t.toolCall.input||{},C=t.toolCall.result,A=t.toolCall.status;switch(O){case"Bash":case"Shell":case"Command":case"SlashCommand":{const D=p(d.command,200);if(A==="completed"&&C){const j=m(C);return`Bash: ${D} (exit ${j})`}return`Bash: ${D}`}case"Edit":{const D=x(d.file_path);if(A==="completed"&&C&&!C.error){const{added:j,removed:I}=N(d.old_string,d.new_string);return j===I?`Edit: ${D} (${j} lines changed)`:`Edit: ${D} (${j} lines added, ${I} removed)`}return`Edit: ${D}`}case"Read":{const D=x(d.file_path);if(d.offset!==void 0||d.limit!==void 0){const I=(d.offset||0)+1,U=d.limit?(d.offset||0)+d.limit:"âˆž";return`Read: ${D} (lines ${I}-${U})`}return`Read: ${D} (full file)`}case"Write":{const D=x(d.file_path);if(A==="completed"&&C&&!C.error&&d.content){const j=d.content.split(`
`).length;return`Write: ${D} (${j} lines written)`}return`Write: ${D}`}case"Skill":{const D=d.command||"Unknown";return A==="completed"&&C?C.error?`Skill: ${D} (error)`:`Skill: ${D} (completed)`:`Skill: ${D}`}case"Task":{const D=d.subagent_type||"general",j=d.description||"Task";return A==="completed"&&C?C.error?`Task: (${D}) ${j} (error)`:`Task: (${D}) ${j} (completed)`:`Task: (${D}) ${j}`}case"TodoWrite":{if(d.todos&&Array.isArray(d.todos)){const D=d.todos.filter(U=>U.status==="completed").length,j=d.todos.length,I=d.todos.find(U=>U.status==="in_progress");return I?`Todo: Working on "${I.content}"`:`Todo: ${D}/${j} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const D=d.pattern||"",j=O==="Grep"?"Grep":"Glob";if(A==="completed"&&C&&!C.error){let I=0;return C.content&&(I=C.content.split(`
`).filter(H=>H.trim()).length),`${j}: "${D}" (${I} results)`}return`${j}: "${D}"`}case"WebFetch":case"WebSearch":{const D=d.url||d.query||"";let j="";try{D&&(j=new URL(D.startsWith("http")?D:`https://${D}`).hostname)}catch{j=D.length>50?D.substring(0,50)+"...":D}return A==="completed"&&C?C.error?`Web: ${j} (error)`:`Web: ${j} (success)`:`Web: ${j||D}`}case"NotebookEdit":{const D=x(d.notebook_path),j=d.cell_number!==void 0?d.cell_number:"?",I=d.edit_mode||"replace";return`NotebookEdit: ${D} cell #${j} (${I})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${d.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${d.shell_id||"unknown"}`;default:return`${O}: executed`}}),k=i(()=>{const O=t.toolCall.name,d=t.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(O)?d.command||O:["Edit","Read","Write","NotebookEdit"].includes(O)&&(d.file_path||d.notebook_path)||O});function E(){const O=r.currentSessionId;O&&u.toggleToolExpansion(O,t.toolCall.id)}function W(O){return O.type==="setMode"?`Set permission mode to "${O.mode}"`:O.type==="allow"?`Allow tool: ${O.tool}`:JSON.stringify(O)}async function R(O,d,C=null){if(!n.value){n.value=!0,O==="allow"?v.value=d?"approve-apply":"approve":C?v.value="deny-guidance":v.value="deny";try{const A=r.currentSessionId;if(A){const D=d&&t.toolCall.suggestions?t.toolCall.suggestions:[];u.handlePermissionResponse(A,{request_id:t.toolCall.permissionRequestId,decision:O,reasoning:O==="allow"?"User allowed permission":"User denied permission",applied_updates:D})}await o.sendPermissionResponse(t.toolCall.permissionRequestId,O,d,C)}catch(A){console.error("Failed to send permission response:",A)}finally{n.value=!1,v.value=null}}}return(O,d)=>(l(),a("div",{class:V(["tool-call-card card mb-3",y.value])},[e("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:E},[e("div",Ql,[e("span",Zl,g(b.value),1),e("strong",{class:"tool-name",title:k.value},g(z.value),9,Xl),e("span",ea,g(M.value),1)]),e("div",ta,[e("small",sa,g(T.value),1),e("i",{class:V(["bi",s.toolCall.isExpanded?"bi-chevron-up":"bi-chevron-down"])},null,2)])]),s.toolCall.isExpanded?(l(),a("div",oa,[c.value?(l(),a("div",na,[e("div",la,[d[6]||(d[6]=e("i",{class:"bi bi-x-circle me-2",style:{"font-size":"1.2rem"}},null,-1)),e("div",null,[d[5]||(d[5]=e("strong",null,"Tool Execution Cancelled",-1)),e("p",aa,g(f.value?.message||"Session was terminated"),1)])])])):P("",!0),(l(),ce(Re($.value),{toolCall:s.toolCall},null,8,["toolCall"])),s.toolCall.status==="permission_required"&&!c.value?(l(),a("div",ra,[e("div",ia,[d[9]||(d[9]=e("p",{class:"mb-2"},[e("strong",null,"ðŸ” Permission Required")],-1)),e("p",ca,[d[7]||(d[7]=G("Claude wants to use the ",-1)),e("code",ua,g(s.toolCall.name),1),d[8]||(d[8]=G(" tool.",-1))])]),w.value?(l(),a("div",da,[e("div",ma,[d[10]||(d[10]=e("h6",{class:"mb-2"},[e("i",{class:"bi bi-lightbulb me-2"}),G(" Suggested Permission Update ")],-1)),d[11]||(d[11]=e("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),e("div",pa,[(l(!0),a(Z,null,ee(s.toolCall.suggestions,(C,A)=>(l(),a("div",{key:A,class:"suggestion-item"},[e("code",null,g(W(C)),1)]))),128))]),d[12]||(d[12]=e("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):P("",!0),e("div",va,[w.value?(l(),a("button",{key:0,class:"btn btn-success",onClick:d[0]||(d[0]=C=>R("allow",!0)),disabled:n.value},[d[13]||(d[13]=e("i",{class:"bi bi-check-circle me-1"},null,-1)),G(" "+g(n.value&&v.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),1)],8,fa)):P("",!0),e("button",{class:V(["btn",w.value?"btn-outline-success":"btn-success"]),onClick:d[1]||(d[1]=C=>R("allow",!1)),disabled:n.value},[d[14]||(d[14]=e("i",{class:"bi bi-check-circle me-1"},null,-1)),G(" "+g(n.value&&v.value==="approve"?"â³ Submitting...":w.value?"âœ… Approve Only":"âœ… Approve"),1)],10,ga),e("button",{class:"btn btn-danger",onClick:d[2]||(d[2]=C=>R("deny",!1)),disabled:n.value},[d[15]||(d[15]=e("i",{class:"bi bi-x-circle me-1"},null,-1)),G(" "+g(n.value&&v.value==="deny"?"â³ Submitting...":"âŒ Deny"),1)],8,_a)]),e("div",ba,[d[17]||(d[17]=e("label",{class:"form-label fw-bold"},[e("i",{class:"bi bi-chat-left-text me-1"}),G(" Provide Guidance (Optional) ")],-1)),d[18]||(d[18]=e("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),Y(e("textarea",{"onUpdate:modelValue":d[3]||(d[3]=C=>_.value=C),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:n.value},null,8,ha),[[ne,_.value]]),_.value.trim()?(l(),a("button",{key:0,class:"btn btn-warning btn-sm",onClick:d[4]||(d[4]=C=>R("deny",!1,_.value)),disabled:n.value},[d[16]||(d[16]=e("i",{class:"bi bi-arrow-repeat me-1"},null,-1)),G(" "+g(n.value&&v.value==="deny-guidance"?"â³ Submitting...":"ðŸ’¡ Provide Guidance & Continue"),1)],8,ya)):P("",!0)])])):P("",!0),s.toolCall.status==="permission_required"&&c.value?(l(),a("div",$a,[e("div",wa,[e("div",Sa,[d[20]||(d[20]=e("i",{class:"bi bi-shield-x me-2",style:{"font-size":"1.2rem"}},null,-1)),e("div",null,[d[19]||(d[19]=e("strong",null,"Permission Request Cancelled",-1)),e("p",ka,g(f.value?.message||"Session was terminated before permission could be granted"),1)])])])])):P("",!0),s.toolCall.permissionDecision==="deny"?(l(),a("div",Ca,[e("div",xa,[d[21]||(d[21]=e("i",{class:"bi bi-x-circle"},null,-1)),d[22]||(d[22]=G(" Permission denied ",-1)),s.toolCall.result?.message?(l(),a("span",Ma," - "+g(s.toolCall.result.message),1)):P("",!0)])])):P("",!0)])):P("",!0)],2))}},Ta=F(ja,[["__scopeId","data-v-a860ce8e"]]),Ea={class:"card assistant-message bg-white border-start border-success border-3"},Pa={class:"card-body"},La={class:"d-flex justify-content-between align-items-center mb-2"},Ia={class:"d-flex align-items-center gap-2"},Da={key:0,class:"text-muted"},Oa={class:"text-muted"},Na={key:0,class:"thinking-block mb-3"},Aa=["innerHTML"],Ra={key:2,class:"tool-calls mt-3"},qa={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(s){const t=s,u=de(),r=J();he.setOptions({breaks:!0,gfm:!0});const o=i(()=>Se(t.message.timestamp)),n=i(()=>t.message.metadata?.model||null),v=i(()=>{const b=t.message.content||"";return b.trim().length>0&&b!=="Assistant response"}),_=i(()=>{const b=t.message.content||"",M=he.parse(b);return je.sanitize(M)}),c=i(()=>t.message.metadata?.has_thinking&&t.message.metadata?.thinking_content),f=i(()=>t.message.metadata?.thinking_content||""),h=i(()=>t.message.metadata?.has_tool_uses&&t.message.metadata?.tool_uses?.length>0),$=i(()=>t.message.metadata?.tool_uses||[]),y=i(()=>{const b=r.currentSessionId;if(!b)return[];const M=u.toolCallsBySession.get(b)||[];return $.value.map(T=>{const S=M.find(w=>w.id===T.id);return S||{id:T.id,name:T.name,input:T.input,status:"pending",result:null,timestamp:T.timestamp||t.message.timestamp,isExpanded:!0}})});return(b,M)=>(l(),a("div",Ea,[e("div",Pa,[e("div",La,[e("div",Ia,[M[0]||(M[0]=e("span",{class:"message-icon"},"ðŸ¤–",-1)),M[1]||(M[1]=e("strong",{class:"message-role"},"Assistant",-1)),n.value?(l(),a("small",Da,g(n.value),1)):P("",!0)]),e("small",Oa,g(o.value),1)]),c.value?(l(),a("div",Na,[Q(Ut,{thinking:f.value},null,8,["thinking"])])):P("",!0),v.value?(l(),a("div",{key:1,class:"message-content",innerHTML:_.value},null,8,Aa)):P("",!0),h.value?(l(),a("div",Ra,[(l(!0),a(Z,null,ee(y.value,T=>(l(),ce(Ta,{key:T.id,toolCall:T},null,8,["toolCall"]))),128))])):P("",!0)])]))}},Wa=F(qa,[["__scopeId","data-v-25a87a40"]]),Ua={class:"card system-message bg-info bg-opacity-10 border-info"},Ha={class:"card-body py-2 px-3"},Fa={class:"d-flex align-items-center gap-2"},Ba={class:"text-muted flex-grow-1"},Va={class:"text-muted"},za={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>Se(t.message.timestamp));return(r,o)=>(l(),a("div",Ua,[e("div",Ha,[e("div",Fa,[o[0]||(o[0]=e("i",{class:"bi bi-info-circle text-info"},null,-1)),e("small",Ba,g(s.message.content),1),e("small",Va,g(u.value),1)])])]))}},Ae=F(za,[["__scopeId","data-v-bba7a395"]]),Ga={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(s){const t=s,u=i(()=>{switch(t.message.type){case"user":return Ot;case"assistant":return Wa;case"system":return Ae;default:return Ae}});return(r,o)=>(l(),a("div",{class:V(["message-item mb-3",`message-${s.message.type}`])},[(l(),ce(Re(u.value),{message:s.message},null,8,["message"]))],2))}},Ja=F(Ga,[["__scopeId","data-v-fbd275ac"]]),Ka={key:0,class:"text-muted text-center py-5"},Ya={__name:"MessageList",setup(s){const t=de(),u=se(),r=L(null),o=i(()=>t.currentMessages.filter(c=>v(c)));i(()=>t.currentToolCalls);async function n(){u.autoScrollEnabled&&(await Me(),r.value&&(r.value.scrollTop=r.value.scrollHeight))}te(()=>t.currentMessages.length,n),te(()=>t.currentToolCalls.length,n),te(()=>t.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),n),re(()=>{setTimeout(()=>{n()},100)});function v(c){const f=c.subtype||c.metadata?.subtype;if(c.type==="system"&&f==="init"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const h=c.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(c.type==="user"){const h=c.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}return!0}function _(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,f)=>(l(),a("div",{class:"messages-area flex-grow-1 overflow-auto p-3",ref_key:"messagesArea",ref:r},[o.value.length===0?(l(),a("div",Ka," No messages yet. Start a conversation! ")):P("",!0),(l(!0),a(Z,null,ee(o.value,(h,$)=>(l(),ce(Ja,{key:`msg-${h.timestamp}-${$}`,message:_(h)},null,8,["message"]))),128))],512))}},Qa=F(Ya,[["__scopeId","data-v-29981b84"]]),Za={class:"border-top bg-light"},Xa={class:"d-flex gap-2 align-items-end px-2 py-1"},er=["placeholder","disabled","onKeydown"],tr=["disabled"],sr={__name:"InputArea",setup(s){const t=J(),u=ge(),r=L(null),o=i({get:()=>t.currentInput,set:y=>{t.currentInput=y}}),n=i(()=>t.currentSession?.is_processing||!1),v=i(()=>u.sessionConnected),_=i(()=>t.currentSession?.state==="starting"),c=i(()=>_.value?"Session is starting...":v.value?"Type your message to Claude Code...":"Waiting for connection...");function f(){const y=r.value;if(!y)return;y.style.height="auto";const b=Math.min(y.scrollHeight,parseInt(getComputedStyle(y).maxHeight));y.style.height=b+"px"}function h(){o.value.trim()&&(u.sendMessage(o.value),o.value="",r.value&&(r.value.style.height="auto"))}function $(){u.interruptSession()}return(y,b)=>(l(),a("div",Za,[e("div",Xa,[Y(e("textarea",{id:"message-input",ref_key:"messageTextarea",ref:r,"onUpdate:modelValue":b[0]||(b[0]=M=>o.value=M),class:"form-control",placeholder:c.value,disabled:_.value||!v.value,rows:"1",onInput:f,onKeydown:qe(ue(h,["exact","prevent"]),["enter"])},null,40,er),[[ne,o.value]]),n.value?(l(),a("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:$}," Stop ")):(l(),a("button",{key:1,class:"btn btn-primary",disabled:!o.value.trim()||!v.value||_.value,onClick:h}," Send ",8,tr))])]))}},or=F(sr,[["__scopeId","data-v-a72bf16a"]]),nr={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},lr={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},ar={class:"text-secondary"},rr={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Ue={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(s){const t=s,u=J(),r=se(),o=i(()=>u.currentSession),n=i(()=>r.isLoading),v=i(()=>r.loadingMessage);return re(async()=>{if(t.sessionId!==u.currentSessionId){r.showLoading("Loading session...");try{await u.selectSession(t.sessionId)}finally{r.hideLoading()}}}),te(()=>t.sessionId,async(_,c)=>{if(_!==c&&_!==u.currentSessionId){r.showLoading("Loading session...");try{await u.selectSession(_)}finally{r.hideLoading()}}}),ie(()=>{}),(_,c)=>(l(),a("div",nr,[n.value?(l(),a("div",lr,[c[0]||(c[0]=e("div",{class:"spinner-border text-primary mb-3",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)),e("p",ar,g(v.value),1)])):P("",!0),o.value?(l(),ce(at,{key:1,"session-id":t.sessionId},null,8,["session-id"])):P("",!0),e("div",rr,[Q(Qa)]),Q(or),o.value?(l(),ce(dt,{key:2,"session-id":t.sessionId},null,8,["session-id"])):P("",!0),o.value?(l(),ce(yt,{key:3,"session-id":t.sessionId},null,8,["session-id"])):P("",!0)]))}},Te=_e("legion",()=>{const s=L(new Map),t=L(new Map),u=L(new Map),r=L(new Map),o=L(null),n=i(()=>s.value.get(o.value)||[]),v=i(()=>t.value.get(o.value)||[]),_=i(()=>u.value.get(o.value)||[]),c=i(()=>r.value.get(o.value)||[]);function f(x){o.value=x}async function h(x,p=100,m=0){try{const N=await K.get(`/api/legions/${x}/timeline?limit=${p}&offset=${m}`),z=N.comms||[],k=N.total_count||z.length,E=N.has_more||!1;return z.sort((W,R)=>new Date(W.timestamp)-new Date(R.timestamp)),console.log(`Loaded ${z.length} of ${k} comms for legion ${x}`),s.value.set(x,z),s.value=new Map(s.value),{comms:z,totalCount:k,hasMore:E}}catch(N){throw console.error("Failed to load timeline:",N),N}}function $(x,p){s.value.has(x)||s.value.set(x,[]),s.value.get(x).push(p),s.value=new Map(s.value)}async function y(x,p){try{const N=(await K.post(`/api/legions/${x}/comms`,p)).comm;return console.log(`Sent comm ${N.comm_id} to legion ${x}`),N}catch(m){throw console.error("Failed to send comm:",m),m}}async function b(x){return console.log(`Minions for legion ${x} are already available in session store`),[]}async function M(x,p){try{const N=(await K.post(`/api/legions/${x}/minions`,p)).minion;return await b(x),console.log(`Created minion ${N.minion_id} in legion ${x}`),N}catch(m){throw console.error("Failed to create minion:",m),m}}async function T(x){try{const m=(await K.get(`/api/legions/${x}/hordes`)).hordes||[];return console.log(`Loaded ${m.length} hordes for legion ${x}`),u.value.set(x,m),u.value=new Map(u.value),m}catch(p){throw console.error("Failed to load hordes:",p),p}}async function S(x){try{const m=(await K.get(`/api/legions/${x}/channels`)).channels||[];return console.log(`Loaded ${m.length} channels for legion ${x}`),r.value.set(x,m),r.value=new Map(r.value),m}catch(p){throw console.error("Failed to load channels:",p),p}}function w(x){s.value.delete(x),t.value.delete(x),u.value.delete(x),r.value.delete(x),s.value=new Map(s.value),t.value=new Map(t.value),u.value=new Map(u.value),r.value=new Map(r.value)}return{commsByLegion:s,minionsByLegion:t,hordesByLegion:u,channelsByLegion:r,currentLegionId:o,currentComms:n,currentMinions:v,currentHordes:_,currentChannels:c,setCurrentLegion:f,loadTimeline:h,addComm:$,sendComm:y,loadMinions:b,createMinion:M,loadHordes:T,loadChannels:S,clearLegionData:w}}),ir=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Te},Symbol.toStringTag,{value:"Module"})),cr={class:"timeline-header border-bottom p-3"},ur={class:"project-name"},dr=["title"],mr={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(s){const t=s,u=le(),r=i(()=>u.projects.get(t.legionId)),o=i(()=>r.value?.name||"Legion");return(n,v)=>(l(),a("div",cr,[e("div",null,[e("div",ur,g(o.value),1),e("div",{class:"view-name",title:s.legionId},"Timeline",8,dr)])]))}},pr=F(mr,[["__scopeId","data-v-44f386f5"]]),vr={class:"timeline-status-bar border-top p-2 bg-light"},fr={class:"d-flex justify-content-end"},gr={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(s){const t=se();function u(){t.setAutoScroll(!t.autoScrollEnabled)}return(r,o)=>(l(),a("div",vr,[e("div",fr,[e("button",{class:V(["btn btn-sm",we(t).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:u}," â¬‡ï¸ "+g(we(t).autoScrollEnabled?"ON":"OFF"),3)])]))}},_r=F(gr,[["__scopeId","data-v-891c73db"]]),br={class:"comm-composer border-top p-3"},hr={class:"d-flex gap-2 mb-2"},yr={class:"flex-grow-1"},$r=["disabled"],wr={label:"Minions"},Sr=["value"],kr={key:0,label:"Channels"},Cr=["value"],xr={style:{"min-width":"150px"}},Mr=["disabled"],jr={class:"d-flex gap-2 align-items-end position-relative"},Tr={class:"flex-grow-1 position-relative"},Er=["disabled"],Pr=["onClick","onMouseenter"],Lr=["disabled"],Ir={key:0},Dr={key:1},Or={__name:"CommComposer",props:{legionId:{type:String,required:!0}},setup(s){const t=s,u=Te(),r=J(),o=le(),n=L(""),v=L("task"),_=L(""),c=L(!1),f=L(!1),h=L([]),$=L(0),y=L(-1),b=L(null),M=L(null),T=i(()=>{const R=o.projects.get(t.legionId);return!R||!R.session_ids?[]:R.session_ids.map(O=>r.sessions.get(O)).filter(O=>O&&O.is_minion)}),S=i(()=>u.currentChannels||[]),w=i(()=>n.value&&_.value.trim().length>0);function x(R){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[R.state]||"â—‹"}function p(R){return R.is_minion&&R.role?`${R.name} (${R.role})`:R.name}function m(){const R=b.value;if(!R)return;R.style.height="auto";const O=Math.min(R.scrollHeight,parseInt(getComputedStyle(R).maxHeight));R.style.height=O+"px"}function N(){const R=b.value;if(!R)return;m();const O=_.value,d=R.selectionStart,C=O.substring(0,d),A=C.lastIndexOf("#");if(A===-1){f.value=!1;return}const D=C.substring(A+1).toLowerCase();if(D.includes(" ")){f.value=!1;return}const j=T.value.filter(I=>I.name.toLowerCase().includes(D)).map(I=>({type:"minion",name:I.name,role:I.role,id:I.session_id,state:I.state}));if(j.length===0){f.value=!1;return}h.value=j,$.value=0,y.value=A,f.value=!0}function z(){if(!M.value)return;const R=M.value,O=R.children[$.value];if(!O)return;const d=O.offsetTop,C=O.offsetHeight,A=R.scrollTop,D=R.clientHeight;d<A?R.scrollTop=d:d+C>A+D&&(R.scrollTop=d+C-D)}function k(R){if(!f.value){R.key==="Enter"&&!R.shiftKey&&w.value&&(R.preventDefault(),W());return}if(R.key==="ArrowDown")R.preventDefault(),$.value=($.value+1)%h.value.length,z();else if(R.key==="ArrowUp")R.preventDefault(),$.value=$.value===0?h.value.length-1:$.value-1,z();else if(R.key==="Enter"){R.preventDefault();const O=h.value[$.value];O&&E(O)}else R.key==="Escape"&&(f.value=!1)}function E(R){const O=b.value;if(!O)return;const d=_.value,C=O.selectionStart,A=d.substring(0,y.value)+"#"+R.name+" "+d.substring(C);_.value=A;const D=y.value+R.name.length+2;setTimeout(()=>{O.setSelectionRange(D,D),O.focus()},0),f.value=!1}async function W(){if(!(!w.value||c.value)){c.value=!0;try{const[R,O]=n.value.split(":"),d={comm_type:v.value,content:_.value.trim()};R==="minion"?d.to_minion_id=O:R==="channel"&&(d.to_channel_id=O),await u.sendComm(t.legionId,d),_.value="",m()}catch(R){console.error("Failed to send comm:",R),alert(`Failed to send comm: ${R.message}`)}finally{c.value=!1}}}return te(f,R=>{if(R){const O=d=>{d.target.closest(".comm-composer")||(f.value=!1,document.removeEventListener("click",O))};setTimeout(()=>document.addEventListener("click",O),0)}}),(R,O)=>(l(),a("div",br,[e("div",hr,[e("div",yr,[Y(e("select",{"onUpdate:modelValue":O[0]||(O[0]=d=>n.value=d),class:"form-select form-select-sm",disabled:c.value},[O[3]||(O[3]=e("option",{value:""},"-- Select Recipient --",-1)),e("optgroup",wr,[(l(!0),a(Z,null,ee(T.value,d=>(l(),a("option",{key:d.session_id,value:`minion:${d.session_id}`},g(x(d))+" "+g(p(d)),9,Sr))),128))]),S.value.length>0?(l(),a("optgroup",kr,[(l(!0),a(Z,null,ee(S.value,d=>(l(),a("option",{key:d.channel_id,value:`channel:${d.channel_id}`}," #ï¸âƒ£ "+g(d.name),9,Cr))),128))])):P("",!0)],8,$r),[[fe,n.value]])]),e("div",xr,[Y(e("select",{"onUpdate:modelValue":O[1]||(O[1]=d=>v.value=d),class:"form-select form-select-sm",disabled:c.value},[...O[4]||(O[4]=[e("option",{value:"task"},"Task",-1),e("option",{value:"question"},"Question",-1),e("option",{value:"info"},"Info",-1),e("option",{value:"report"},"Report",-1)])],8,Mr),[[fe,v.value]])])]),e("div",jr,[e("div",Tr,[Y(e("textarea",{ref_key:"contentTextarea",ref:b,"onUpdate:modelValue":O[2]||(O[2]=d=>_.value=d),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:c.value,onInput:N,onKeydown:k},null,40,Er),[[ne,_.value]]),f.value?(l(),a("div",{key:0,ref_key:"autocompleteDropdown",ref:M,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(l(!0),a(Z,null,ee(h.value,(d,C)=>(l(),a("div",{key:d.id,class:V(["autocomplete-item px-2 py-1",{"bg-light":C===$.value}]),onClick:A=>E(d),onMouseenter:A=>$.value=C},g(d.type==="minion"?x(d):"#ï¸âƒ£")+" "+g(d.name)+g(d.role?` (${d.role})`:""),43,Pr))),128))],512)):P("",!0)]),e("div",null,[e("button",{class:"btn btn-primary btn-sm",disabled:!w.value||c.value,onClick:W},[c.value?(l(),a("span",Ir,[...O[5]||(O[5]=[e("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),G(" Sending... ",-1)])])):(l(),a("span",Dr,"Send"))],8,Lr)])])]))}},Nr=F(Or,[["__scopeId","data-v-ffa54193"]]),Ar={class:"timeline-view d-flex flex-column h-100"},Rr={key:0,class:"text-center text-muted"},qr={key:1,class:"text-center text-danger"},Wr={key:2,class:"text-center text-muted"},Ur={key:3,class:"comm-list"},Hr={class:"col-auto message-speaker text-end pe-3"},Fr={class:"text-muted"},Br={class:"col message-content-column"},Vr={class:"comm-card card"},zr={class:"card-body p-2"},Gr={class:"d-flex justify-content-between align-items-start mb-1"},Jr={class:"ms-2"},Kr={class:"comm-content"},Yr={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(s){const t=s,u=Te(),r=le(),o=J(),n=ge(),v=se(),_=L(!0),c=L(null),f=L(null),h=i(()=>r.projects.get(t.legionId));i(()=>h.value?.name||"Legion");const $=i(()=>u.currentComms);i(()=>u.currentMinions);function y(m){return m.from_user?"You":m.from_minion_id&&o.sessions.get(m.from_minion_id)?.name||"Unknown"}function b(m){return m.to_user?"You":m.to_minion_id?o.sessions.get(m.to_minion_id)?.name||"Unknown":m.to_channel_id?`#${m.to_channel_id}`:"All"}function M(m){return{task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success"}[m]||"bg-secondary"}function T(m){return new Date(m).toLocaleTimeString()}async function S(){v.autoScrollEnabled&&(await Me(),f.value&&(f.value.scrollTop=f.value.scrollHeight))}async function w(){_.value=!0,c.value=null;try{u.setCurrentLegion(t.legionId),await Promise.all([u.loadTimeline(t.legionId),u.loadMinions(t.legionId)]),await Me(),await S(),setTimeout(()=>{S()},100)}catch(m){console.error("Failed to load timeline:",m),m.response?c.value=`${m.message} (${m.response.status})`:c.value=m.message||"Unknown error"}finally{_.value=!1}}function x(){n.connectLegion(t.legionId)}function p(){n.disconnectLegion()}return te(()=>$.value.length,()=>{S()}),re(()=>{w(),x(),setTimeout(()=>{S()},100)}),ie(()=>{p()}),(m,N)=>(l(),a("div",Ar,[Q(pr,{"legion-id":s.legionId},null,8,["legion-id"]),e("div",{ref_key:"messagesArea",ref:f,class:"timeline-messages flex-grow-1 overflow-auto p-3"},[_.value?(l(),a("div",Rr,[...N[0]||(N[0]=[e("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),G(" Loading timeline... ",-1)])])):c.value?(l(),a("div",qr," Failed to load timeline: "+g(c.value),1)):$.value.length===0?(l(),a("div",Wr," No messages yet. Minions will appear here once they start communicating. ")):(l(),a("div",Ur,[(l(!0),a(Z,null,ee($.value,z=>(l(),a("div",{key:z.comm_id,class:"comm-item message-row row py-2 mb-2"},[e("div",Hr,[e("small",Fr,g(T(z.timestamp)),1)]),e("div",Br,[e("div",Vr,[e("div",zr,[e("div",Gr,[e("div",null,[e("span",{class:V(["badge",M(z.comm_type)])},g(z.comm_type),3),e("strong",Jr,g(y(z)),1),N[1]||(N[1]=e("span",{class:"text-muted mx-1"},"â†’",-1)),e("strong",null,g(b(z)),1)])]),e("div",Kr,g(z.content),1)])])])]))),128))]))],512),Q(Nr,{"legion-id":s.legionId},null,8,["legion-id"]),Q(_r,{"legion-id":s.legionId},null,8,["legion-id"])]))}},Qr=F(Yr,[["__scopeId","data-v-d4c7422e"]]),Zr={class:"spy-view d-flex flex-column overflow-hidden"},Xr={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(s){return(t,u)=>(l(),a("div",Zr,[Q(Ue,{"session-id":s.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},ei=F(Xr,[["__scopeId","data-v-43a24eaf"]]),ti={class:"horde-header border-bottom p-3"},si={class:"project-name"},oi=["title"],ni={__name:"HordeHeader",props:{legionId:{type:String,required:!0},overseerId:{type:String,required:!0}},setup(s){const t=s,u=le(),r=J(),o=i(()=>u.projects.get(t.legionId)),n=i(()=>o.value?.name||"Legion"),v=i(()=>r.sessions.get(t.overseerId)),_=i(()=>v.value?.name||"Overseer");return(c,f)=>(l(),a("div",ti,[e("div",null,[e("div",si,g(n.value),1),e("div",{class:"view-name",title:s.overseerId},g(_.value)+"'s Horde",9,oi)])]))}},li=F(ni,[["__scopeId","data-v-775da47d"]]),ai={class:"horde-status-bar border-top p-2 bg-light"},ri={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0},overseerId:{type:String,required:!0}},setup(s){return(t,u)=>(l(),a("div",ai,[...u[0]||(u[0]=[e("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},ii=F(ri,[["__scopeId","data-v-7f3c847f"]]),ci={class:"minion-card p-2 border-start border-2 mb-2"},ui={class:"d-flex align-items-center"},di={class:"me-2"},mi={key:0,class:"me-2"},pi={key:1,class:"text-muted ms-2"},vi={key:2,class:"badge bg-secondary ms-2"},fi={class:"text-muted small ms-4"},gi={key:0,class:"minion-children"},_i={key:1,class:"text-danger small ms-4"},bi={__name:"MinionTreeNode",props:{minionId:{type:String,required:!0},level:{type:Number,default:0}},setup(s){const t=s,u=J(),r=i(()=>u.sessions.get(t.minionId)),o=i(()=>t.level*24),n=i(()=>{const f=r.value&&r.value.child_minion_ids&&r.value.child_minion_ids.length>0;return r.value&&r.value.child_minion_ids&&r.value.child_minion_ids.length>0&&console.log(`Minion ${r.value.name} has ${r.value.child_minion_ids.length} children:`,r.value.child_minion_ids),f}),v=i(()=>r.value&&r.value.is_overseer&&n.value),_={created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "},c=i(()=>_[r.value?.state]||"â—‹");return(f,h)=>{const $=We("MinionTreeNode",!0);return r.value?(l(),a("div",{key:0,class:"minion-tree-node",style:me({marginLeft:`${o.value}px`})},[e("div",ci,[e("div",ui,[e("span",di,g(c.value),1),v.value?(l(),a("span",mi,"ðŸ‘‘")):P("",!0),e("strong",null,g(r.value.name),1),r.value.role?(l(),a("span",pi,g(r.value.role),1)):P("",!0),v.value?(l(),a("span",vi,g(r.value.child_minion_ids.length)+" "+g(r.value.child_minion_ids.length===1?"child":"children"),1)):P("",!0)]),e("div",fi," Level "+g(r.value.overseer_level||0)+" â€¢ "+g(r.value.state),1)]),n.value?(l(),a("div",gi,[(l(!0),a(Z,null,ee(r.value.child_minion_ids,y=>(l(),ce($,{key:y,"minion-id":y,level:s.level+1},null,8,["minion-id","level"]))),128))])):P("",!0)],4)):t.minionId?(l(),a("div",_i," âš  Minion data not found for ID: "+g(t.minionId),1)):P("",!0)}}},hi=F(bi,[["__scopeId","data-v-120682eb"]]),yi={class:"horde-view d-flex flex-column h-100"},$i={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},wi={key:0,class:"alert alert-danger"},Si={key:1,class:"horde-tree"},ki={__name:"HordeView",props:{legionId:{type:String,required:!0},overseerId:{type:String,required:!0}},setup(s){const t=s,u=J(),r=le(),o=i(()=>r.projects.get(t.legionId));i(()=>o.value?.name||"Legion");const n=i(()=>u.sessions.get(t.overseerId));return(v,_)=>(l(),a("div",yi,[Q(li,{"legion-id":s.legionId,"overseer-id":s.overseerId},null,8,["legion-id","overseer-id"]),e("div",$i,[n.value?(l(),a("div",Si,[Q(hi,{"minion-id":s.overseerId,level:0},null,8,["minion-id"])])):(l(),a("div",wi," Overseer not found "))]),Q(ii,{"legion-id":s.legionId,"overseer-id":s.overseerId},null,8,["legion-id","overseer-id"])]))}},Ci=F(ki,[["__scopeId","data-v-b928719b"]]),xi=[{path:"/",name:"home",component:Ke},{path:"/session/:sessionId",name:"session",component:Ue,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Qr,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:ei,props:!0},{path:"/horde/:legionId/:overseerId",name:"horde",component:Ci,props:!0}],Mi=Fe({history:Be(),routes:xi}),ji={__name:"ConnectionIndicator",setup(s){const t=ge(),u=i(()=>{switch(t.overallStatus){case"connected":return"bg-success";case"partial":return"bg-warning";default:return"bg-secondary"}}),r=i(()=>{switch(t.overallStatus){case"connected":return"Connected";case"partial":return"Partial Connection";default:return"Disconnected"}});return(o,n)=>(l(),a("span",{id:"connection-indicator",class:V(["badge",u.value])},g(r.value),3))}},Ti={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Ei={class:"d-flex align-items-center gap-2"},Pi={__name:"AppHeader",setup(s){const t=se();function u(){t.toggleSidebar()}return(r,o)=>(l(),a("header",Ti,[e("div",{class:"d-flex align-items-center gap-2"},[e("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:u},[...o[0]||(o[0]=[e("span",null,"â˜°",-1)])]),o[1]||(o[1]=e("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),e("div",Ei,[Q(ji)])]))}},Li={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Ii={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Di=["title"],Oi={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(s){const t=s,u=i(()=>!t.sessions||t.sessions.length===0?"100%":`${100/t.sessions.length}%`);function r(_){return _.state==="paused"&&_.is_processing?"pending-prompt":_.is_processing?"processing":_.state}function o(_){const c=r(_);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}function n(_){const c=r(_);return c==="starting"||c==="processing"||c==="pending-prompt"}function v(_){const c=r(_),f=c.charAt(0).toUpperCase()+c.slice(1),h=_.name||"Unnamed Session",$=_.is_minion&&_.role?` (${_.role})`:"";return`${h}${$}: ${f}`}return(_,c)=>(l(),a("div",Li,[!s.sessions||s.sessions.length===0?(l(),a("div",Ii)):(l(!0),a(Z,{key:1},ee(s.sessions,f=>(l(),a("div",{key:f.session_id,class:V(["progress-bar",{"progress-bar-striped progress-bar-animated":n(f)}]),style:me({width:u.value,backgroundColor:o(f),cursor:"help"}),title:v(f)},null,14,Di))),128))]))}},Ni=F(Oi,[["__scopeId","data-v-a79cfeec"]]),Ai={class:"flex-grow-1"},Ri={key:0,class:"text-muted small ms-1"},qi={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(s){const t=s,u=pe(),r=J(),o=le(),n=se(),v=i(()=>r.currentSessionId===t.session.session_id),_=i(()=>r.deletingSessions.has(t.session.session_id)),c=i(()=>t.session.state==="paused"&&t.session.is_processing?"pending-prompt":t.session.is_processing?"processing":t.session.state),f=i(()=>{const w=c.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[w]||"status-dot-grey"}),h=i(()=>{const w=c.value,x={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},p={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:x[w]||"#d3d3d3",borderColor:p[w]||"#6c757d"}});function $(){r.selectSession(t.session.session_id),u.push(`/session/${t.session.session_id}`)}function y(){n.showModal("edit-session",{session:t.session})}function b(w){w.dataTransfer.effectAllowed="move",w.dataTransfer.setData("application/session-id",t.session.session_id),w.dataTransfer.setData("application/project-id",t.projectId),w.dataTransfer.setData("text/plain",t.session.session_id),w.target.classList.add("dragging")}function M(w){w.target.classList.remove("dragging")}function T(w){w.preventDefault(),w.dataTransfer.dropEffect="move";const x=w.currentTarget.getBoundingClientRect(),p=x.top+x.height/2;w.clientY<p?(w.currentTarget.classList.add("drop-above"),w.currentTarget.classList.remove("drop-below")):(w.currentTarget.classList.add("drop-below"),w.currentTarget.classList.remove("drop-above"))}function S(w){w.preventDefault(),w.currentTarget.classList.remove("drop-above","drop-below");const x=w.dataTransfer.getData("application/session-id")||w.dataTransfer.getData("text/plain"),p=w.dataTransfer.getData("application/project-id");if(!x||x===t.session.session_id||p!==t.projectId)return;const m=w.currentTarget.getBoundingClientRect(),N=m.top+m.height/2,z=w.clientY<N,k=o.getProject(t.projectId);if(!k||!k.session_ids)return;const E=[...k.session_ids],W=E.indexOf(t.session.session_id),R=E.indexOf(x);if(W===-1||R===-1)return;const O=[...E],[d]=O.splice(R,1);let C=z?W:W+1;R<W&&C--,O.splice(C,0,d),o.reorderSessionsInProject(t.projectId,O)}return(w,x)=>(l(),a("div",{class:V(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:v.value,"session-deleting":_.value}]),style:{cursor:"pointer"},draggable:"true",onClick:$,onDragstart:b,onDragend:M,onDragover:T,onDrop:S},[e("div",{class:V(["status-dot me-2",f.value]),style:me(h.value)},null,6),e("div",Ai,[e("span",null,g(s.session.name||s.session.session_id),1),s.session.is_minion&&s.session.role?(l(),a("span",Ri,"("+g(s.session.role)+")",1)):P("",!0)]),e("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:ue(y,["stop"])}," âœï¸ ")],34))}},Wi=F(qi,[["__scopeId","data-v-07ecbf94"]]),Ui=["value"],Hi={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(s){const t=s,u=pe(),r=J(),o=L("");te(()=>u.currentRoute.value,b=>{!o.value&&b.name==="spy"&&b.params.minionId&&b.params.legionId===t.project.project_id&&(o.value=b.params.minionId)},{immediate:!0});const n=i(()=>o.value?t.sessions.find(b=>b.session_id===o.value):null),v=i(()=>{const b=u.currentRoute.value;return b.name==="spy"&&b.params.legionId===t.project.project_id}),_=i(()=>{if(!n.value)return"";if(n.value.state==="paused"&&n.value.is_processing)return"status-blinking";const b=n.value.is_processing?"processing":n.value.state;return b==="starting"||b==="processing"?"status-blinking":""}),c=i(()=>{if(!n.value)return{};if(n.value.state==="paused"&&n.value.is_processing)return{backgroundColor:"#ffc107"};const b=n.value.is_processing?"processing":n.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[b]||"#d3d3d3"}});function f(b){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[b.state]||"â—‹"}function h(b){return b.is_minion&&b.role?`${b.name} (${b.role})`:b.name}function $(){o.value&&u.push(`/spy/${t.project.project_id}/${o.value}`)}function y(){o.value?u.push(`/spy/${t.project.project_id}/${o.value}`):u.push("/")}return te(()=>r.currentSessionId,b=>{if(b)t.sessions.some(M=>M.session_id===b)&&(o.value=b);else{o.value="";const M=u.currentRoute.value;M.name==="spy"&&M.params.legionId===t.project.project_id&&u.push("/")}}),(b,M)=>(l(),a("div",{class:V(["list-group-item list-group-item-action p-2",{active:v.value}])},[e("div",{class:"d-flex align-items-center justify-content-between mb-2",style:me({cursor:o.value?"pointer":"default"}),onClick:$},[M[1]||(M[1]=e("div",{class:"d-flex align-items-center"},[e("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ”"),e("span",{class:"fw-semibold"},"Spy"),e("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),n.value?(l(),a("span",{key:0,class:V(["minion-state-indicator",_.value]),style:me(c.value)}," ðŸ‘¤ ",6)):P("",!0)],4),Y(e("select",{"onUpdate:modelValue":M[0]||(M[0]=T=>o.value=T),class:"form-select form-select-sm",onChange:y},[M[2]||(M[2]=e("option",{value:""},"-- Select Minion --",-1)),(l(!0),a(Z,null,ee(s.sessions,T=>(l(),a("option",{key:T.session_id,value:T.session_id},g(f(T))+" "+g(h(T)),9,Ui))),128))],544),[[fe,o.value]])],2))}},Fi=F(Hi,[["__scopeId","data-v-eda3ced5"]]),Bi=["value"],Vi={__name:"HordeSelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(s){const t=s,u=pe(),r=L("");te(()=>u.currentRoute.value,f=>{!r.value&&f.name==="horde"&&f.params.overseerId&&f.params.legionId===t.project.project_id&&(r.value=f.params.overseerId)},{immediate:!0});const o=i(()=>t.sessions.filter(f=>f.is_overseer===!0)),n=i(()=>{const f=u.currentRoute.value;return f.name==="horde"&&f.params.legionId===t.project.project_id});function v(f){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[f.state]||"â—‹"}function _(){r.value&&u.push(`/horde/${t.project.project_id}/${r.value}`)}function c(){r.value&&u.push(`/horde/${t.project.project_id}/${r.value}`)}return(f,h)=>(l(),a("div",{class:V(["list-group-item list-group-item-action p-2",{active:n.value}])},[e("div",{class:"d-flex align-items-center justify-content-between mb-2",style:me({cursor:r.value?"pointer":"default"}),onClick:_},[...h[1]||(h[1]=[e("div",{class:"d-flex align-items-center"},[e("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),e("span",{class:"fw-semibold"},"Horde"),e("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],4),Y(e("select",{"onUpdate:modelValue":h[0]||(h[0]=$=>r.value=$),class:"form-select form-select-sm",onChange:c},[h[2]||(h[2]=e("option",{value:""},"-- Select Overseer --",-1)),(l(!0),a(Z,null,ee(o.value,$=>(l(),a("option",{key:$.session_id,value:$.session_id},g(v($))+" "+g($.name),9,Bi))),128))],544),[[fe,r.value]])],2))}},zi=F(Vi,[["__scopeId","data-v-ca33279d"]]),Gi=["data-project-id"],Ji=["id"],Ki=["data-bs-target","aria-expanded","aria-controls"],Yi={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Qi={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Zi={class:"fw-semibold",style:{"flex-shrink":"0"}},Xi={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},ec={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},tc=["title"],sc=["title"],oc=["id","aria-labelledby"],nc={class:"accordion-body p-0"},lc={class:"list-group list-group-flush"},ac={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(s){const t=s,u=pe(),r=le(),o=J(),n=se(),v=L(t.project.is_expanded||!1),_=i(()=>r.formatPath(t.project.working_directory)),c=i(()=>!t.project?.session_ids||t.project.session_ids.length===0?[]:t.project.session_ids.map(p=>o.getSession(p)).filter(p=>p!=null)),f=i(()=>{const p=u.currentRoute.value;return p.name==="timeline"&&p.params.legionId===t.project.project_id});function h(){v.value||(r.toggleExpansion(t.project.project_id),v.value=!0)}function $(){if(v.value){r.toggleExpansion(t.project.project_id),v.value=!1;const p=o.currentSessionId;p&&o.getSession(p)&&t.project.session_ids?.includes(p)&&u.push("/"),r.currentProjectId===t.project.project_id&&u.push("/")}}function y(){n.showModal("edit-project",{project:t.project})}function b(){t.project.is_multi_agent?n.showModal("create-minion",{project:t.project}):n.showModal("create-session",{project:t.project})}function M(){u.push(`/timeline/${t.project.project_id}`)}function T(p){p.dataTransfer.effectAllowed="move",p.dataTransfer.setData("application/project-id",t.project.project_id),p.dataTransfer.setData("text/plain",t.project.project_id),p.target.classList.add("dragging")}function S(p){p.target.classList.remove("dragging")}function w(p){p.preventDefault(),p.dataTransfer.dropEffect="move";const m=p.currentTarget.getBoundingClientRect(),N=m.top+m.height/2;p.clientY<N?(p.currentTarget.classList.add("drop-above"),p.currentTarget.classList.remove("drop-below")):(p.currentTarget.classList.add("drop-below"),p.currentTarget.classList.remove("drop-above"))}function x(p){p.preventDefault(),p.currentTarget.classList.remove("drop-above","drop-below");const m=p.dataTransfer.getData("application/project-id")||p.dataTransfer.getData("text/plain");if(!m||m===t.project.project_id)return;const N=p.currentTarget.getBoundingClientRect(),z=N.top+N.height/2,k=p.clientY<z,E=r.orderedProjects,W=E.findIndex(D=>D.project_id===t.project.project_id),R=E.findIndex(D=>D.project_id===m);if(W===-1||R===-1)return;const O=[...E],[d]=O.splice(R,1);let C=k?W:W+1;R<W&&C--,O.splice(C,0,d);const A=O.map(D=>D.project_id);r.reorderProjects(A)}return(p,m)=>(l(),a("div",{class:"accordion-item border rounded mb-2","data-project-id":s.project.project_id,draggable:"true",onDragstart:T,onDragend:S,onDragover:w,onDrop:x},[e("h2",{class:"accordion-header",id:`heading-${s.project.project_id}`},[e("button",{class:V(["accordion-button bg-white p-2",{collapsed:!v.value}]),type:"button","data-bs-toggle":"collapse","data-bs-target":`#collapse-${s.project.project_id}`,"aria-expanded":v.value,"aria-controls":`collapse-${s.project.project_id}`},[e("div",Yi,[e("div",Qi,[e("div",Zi,[s.project.is_multi_agent?(l(),a("span",Xi,"ðŸ›")):P("",!0),G(" "+g(s.project.name),1)]),e("div",ec,[e("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ue(y,["stop","prevent"])}," âœï¸ "),e("button",{class:"btn btn-sm btn-outline-primary",title:s.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:ue(b,["stop","prevent"])}," âž• ",8,tc)])]),e("small",{class:"text-muted font-monospace",title:s.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},g(_.value),9,sc)])],10,Ki)],8,Ji),Q(Ni,{project:s.project,sessions:c.value},null,8,["project","sessions"]),e("div",{id:`collapse-${s.project.project_id}`,class:V(["accordion-collapse collapse",{show:v.value}]),"aria-labelledby":`heading-${s.project.project_id}`,onShown:h,onHidden:$},[e("div",nc,[e("div",lc,[s.project.is_multi_agent?(l(),a("div",{key:0,class:V(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:f.value}]),style:{cursor:"pointer"},onClick:M},[...m[0]||(m[0]=[e("div",{class:"flex-grow-1"},[e("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),e("span",{class:"fw-semibold"},"Timeline"),e("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):P("",!0),s.project.is_multi_agent?(l(),a(Z,{key:1},[Q(Fi,{project:s.project,sessions:c.value},null,8,["project","sessions"]),Q(zi,{project:s.project,sessions:c.value},null,8,["project","sessions"])],64)):(l(!0),a(Z,{key:2},ee(c.value,N=>(l(),ce(Wi,{key:N.session_id,session:N,"project-id":s.project.project_id},null,8,["session","project-id"]))),128))])])],42,oc)],40,Gi))}},rc=F(ac,[["__scopeId","data-v-4cc3dd53"]]),ic={class:"project-list"},cc={key:0,class:"text-muted text-center py-3"},uc={__name:"ProjectList",setup(s){const t=le(),u=i(()=>t.orderedProjects);return(r,o)=>(l(),a("div",ic,[u.value.length===0?(l(),a("div",cc,' No projects yet. Click "New" to create one. ')):P("",!0),(l(!0),a(Z,null,ee(u.value,n=>(l(),ce(rc,{key:n.project_id,project:n},null,8,["project"]))),128))]))}},dc={class:"flex-grow-1 overflow-auto p-3"},mc={id:"sessions-container"},pc={__name:"Sidebar",setup(s){const t=se(),u=i(()=>t.sidebarCollapsed),r=i(()=>t.isMobile),o=i(()=>{if(r.value)return{};const h=`${t.sidebarWidth}px`;return{width:h,minWidth:"200px",maxWidth:"30vw","--sidebar-width":h}});function n(){t.showModal("create-project")}const v=L(!1);function _(h){v.value=!0,document.addEventListener("mousemove",c),document.addEventListener("mouseup",f)}function c(h){v.value&&t.setSidebarWidth(h.clientX)}function f(){v.value=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",f)}return(h,$)=>(l(),a("aside",{id:"sidebar",class:V(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:u.value,"mobile-open":!u.value&&r.value,"desktop-collapsed":u.value&&!r.value}]),style:me(o.value)},[e("div",dc,[e("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=e("h6",{class:"text-muted mb-0"},"Projects",-1)),e("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:n}," ðŸ“ New ")]),e("div",mc,[Q(uc)])]),e("div",{class:"sidebar-resize-handle",onMousedown:_},null,32)],6))}},vc=F(pc,[["__scopeId","data-v-d792f0f0"]]),fc={class:"modal-dialog modal-lg"},gc={class:"modal-content"},_c={class:"modal-body"},bc={class:"mb-3"},hc={class:"input-group"},yc=["disabled"],$c={key:0,class:"text-center py-4"},wc={key:1,class:"alert alert-danger",role:"alert"},Sc={key:2,class:"folder-list"},kc=["onClick","onDblclick"],Cc={class:"d-flex align-items-center flex-grow-1"},xc=["onClick"],Mc={key:1,class:"text-center text-muted py-3"},jc={class:"modal-footer"},Tc=["disabled"],Ec={__name:"FolderBrowserModal",setup(s){const t=se(),u=L(""),r=L(""),o=L([]),n=L(!1),v=L(""),_=L(null);let c=null,f=null;const h=i(()=>{if(!u.value)return null;const p=u.value.split(/[\\/]/).filter(Boolean);return p.length<=1?null:(p.pop(),p.length>0?p.join("/"):"/")});function $(p){if(!p)return"";const m=p.split(/[\\/]/).filter(Boolean);return m.length<=2?p:".../"+m.slice(-2).join("/")}async function y(){n.value=!0,v.value="",o.value=[],r.value="";try{const p=u.value?{path:u.value}:{},m=await K.get("/api/filesystem/browse",{params:p});m.current_path&&(u.value=m.current_path),o.value=m.directories||[]}catch(p){console.error("Failed to load directory:",p),v.value=p.message||"Failed to load directory"}finally{n.value=!1}}function b(p){r.value=p.path}function M(p){u.value=p.path,r.value="",y()}function T(){h.value&&(u.value=h.value,r.value="",y())}function S(){const p=r.value||u.value;p&&f&&f(p),c&&c.hide()}function w(){y()}function x(){o.value=[],r.value="",v.value="",f=null,t.hideModal()}return te(()=>t.currentModal,p=>{if(p?.name==="folder-browser"&&c){const m=p.data||{};u.value=m.currentPath||"",f=m.onSelect||null,c.show()}}),re(()=>{_.value&&ae(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(m=>m.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{c=new p(_.value),_.value.addEventListener("shown.bs.modal",w),_.value.addEventListener("hidden.bs.modal",x)})}),ie(()=>{_.value&&(_.value.removeEventListener("shown.bs.modal",w),_.value.removeEventListener("hidden.bs.modal",x)),c&&c.dispose()}),(p,m)=>(l(),a("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:_},[e("div",fc,[e("div",gc,[m[7]||(m[7]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",_c,[e("div",bc,[m[2]||(m[2]=e("label",{class:"form-label"},"Current Path:",-1)),e("div",hc,[Y(e("input",{type:"text",class:"form-control","onUpdate:modelValue":m[0]||(m[0]=N=>u.value=N),onKeyup:qe(y,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[ne,u.value]]),e("button",{class:"btn btn-outline-secondary",onClick:y,disabled:n.value},[...m[1]||(m[1]=[e("i",{class:"bi bi-arrow-clockwise"},null,-1),G(" Refresh ",-1)])],8,yc)])]),n.value?(l(),a("div",$c,[...m[3]||(m[3]=[e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):v.value?(l(),a("div",wc,g(v.value),1)):(l(),a("div",Sc,[h.value?(l(),a("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:T,role:"button"},[...m[4]||(m[4]=[e("i",{class:"bi bi-arrow-up-circle me-2 text-secondary"},null,-1),e("span",{class:"text-secondary"},"..",-1)])])):P("",!0),(l(!0),a(Z,null,ee(o.value,N=>(l(),a("div",{key:N.path,class:V(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:N.path===r.value}]),onClick:z=>b(N),onDblclick:z=>M(N),role:"button"},[e("div",Cc,[m[5]||(m[5]=e("i",{class:"bi bi-folder-fill me-2 text-warning"},null,-1)),e("span",null,g(N.name),1)]),e("button",{class:"btn btn-sm btn-outline-primary",onClick:ue(z=>M(N),["stop"])}," Open ",8,xc)],42,kc))),128)),o.value.length===0?(l(),a("div",Mc," No subdirectories found ")):P("",!0)]))]),e("div",jc,[m[6]||(m[6]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:S,disabled:!r.value},' Select "'+g($(r.value||u.value))+'" ',9,Tc)])])])],512))}},Pc=F(Ec,[["__scopeId","data-v-667c51a9"]]),Lc={class:"modal-dialog"},Ic={class:"modal-content"},Dc={class:"modal-body"},Oc={class:"mb-3"},Nc={key:0,class:"invalid-feedback"},Ac={class:"mb-3"},Rc={class:"input-group"},qc={key:0,class:"invalid-feedback"},Wc={class:"mb-3 form-check"},Uc={class:"mb-3 form-check"},Hc={class:"form-check-label",for:"createSession"},Fc={key:0,class:"mb-3 ms-4"},Bc={for:"sessionName",class:"form-label"},Vc={key:1,class:"alert alert-danger",role:"alert"},zc={class:"modal-footer"},Gc=["disabled"],Jc={key:0,class:"spinner-border spinner-border-sm me-2"},Kc={__name:"ProjectCreateModal",setup(s){const t=le(),u=J(),r=se(),o=L({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),n=L({name:"",workingDirectory:""}),v=L(!1),_=L(""),c=L(null);let f=null;function h(){r.showModal("folder-browser",{currentPath:o.value.workingDirectory||"",onSelect:S=>{o.value.workingDirectory=S,n.value.workingDirectory=""}})}function $(){n.value={};let S=!0;return o.value.name.trim()||(n.value.name="Project name is required",S=!1),o.value.workingDirectory.trim()||(n.value.workingDirectory="Working directory is required",S=!1),S}async function y(){if($()){v.value=!0,_.value="";try{const S=await t.createProject(o.value.name,o.value.workingDirectory,o.value.isMultiAgent);o.value.createSession&&await u.createSession(S.project_id,{name:o.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),f&&f.hide(),b()}catch(S){console.error("Failed to create project:",S),_.value=S.message||"Failed to create project. Please try again."}finally{v.value=!1}}}function b(){o.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},n.value={},_.value=""}function M(){const S=document.getElementById("projectName");S&&S.focus()}function T(){b(),r.hideModal()}return te(()=>r.currentModal,S=>{S?.name==="create-project"&&f&&f.show()}),re(()=>{c.value&&ae(async()=>{const{default:S}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{f=new S(c.value),c.value.addEventListener("shown.bs.modal",M),c.value.addEventListener("hidden.bs.modal",T)})}),ie(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",M),c.value.removeEventListener("hidden.bs.modal",T)),f&&f.dispose()}),(S,w)=>(l(),a("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[e("div",Lc,[e("div",Ic,[w[11]||(w[11]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Dc,[e("form",{onSubmit:ue(y,["prevent"])},[e("div",Oc,[w[5]||(w[5]=e("label",{for:"projectName",class:"form-label"},"Project Name",-1)),Y(e("input",{type:"text",class:V(["form-control",{"is-invalid":n.value.name}]),id:"projectName","onUpdate:modelValue":w[0]||(w[0]=x=>o.value.name=x),placeholder:"My Project",required:""},null,2),[[ne,o.value.name]]),n.value.name?(l(),a("div",Nc,g(n.value.name),1)):P("",!0)]),e("div",Ac,[w[6]||(w[6]=e("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),e("div",Rc,[Y(e("input",{type:"text",class:V(["form-control",{"is-invalid":n.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":w[1]||(w[1]=x=>o.value.workingDirectory=x),placeholder:"/path/to/project",required:""},null,2),[[ne,o.value.workingDirectory]]),e("button",{class:"btn btn-outline-secondary",type:"button",onClick:h}," Browse... "),n.value.workingDirectory?(l(),a("div",qc,g(n.value.workingDirectory),1)):P("",!0)]),w[7]||(w[7]=e("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),e("div",Wc,[Y(e("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":w[2]||(w[2]=x=>o.value.isMultiAgent=x)},null,512),[[be,o.value.isMultiAgent]]),w[8]||(w[8]=e("label",{class:"form-check-label",for:"isMultiAgent"}," ðŸ› Multi-Agent Project (Legion) ",-1)),w[9]||(w[9]=e("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),e("div",Uc,[Y(e("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":w[3]||(w[3]=x=>o.value.createSession=x)},null,512),[[be,o.value.createSession]]),e("label",Hc," Create initial "+g(o.value.isMultiAgent?"minion":"session"),1)]),o.value.createSession?(l(),a("div",Fc,[e("label",Bc," Initial "+g(o.value.isMultiAgent?"Minion":"Session")+" Name ",1),Y(e("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":w[4]||(w[4]=x=>o.value.sessionName=x),placeholder:"main"},null,512),[[ne,o.value.sessionName]])])):P("",!0),_.value?(l(),a("div",Vc,g(_.value),1)):P("",!0)],32)]),e("div",zc,[w[10]||(w[10]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:v.value},[v.value?(l(),a("span",Jc)):P("",!0),G(" "+g(v.value?"Creating...":"Create Project"),1)],8,Gc)])])])],512))}},Yc=F(Kc,[["__scopeId","data-v-adf50394"]]),Qc={class:"modal-dialog"},Zc={class:"modal-content"},Xc={class:"modal-body"},eu={class:"mb-3"},tu={key:0,class:"invalid-feedback"},su={class:"mb-3"},ou=["value"],nu={key:0,class:"alert alert-danger",role:"alert"},lu={class:"danger-zone"},au={class:"text-muted small"},ru=["disabled"],iu={key:0,class:"alert alert-warning mt-3",role:"alert"},cu={class:"mb-2"},uu={class:"d-flex gap-2"},du=["disabled"],mu={key:0,class:"spinner-border spinner-border-sm me-2"},pu=["disabled"],vu={class:"modal-footer"},fu=["disabled"],gu={key:0,class:"spinner-border spinner-border-sm me-2"},_u={__name:"ProjectEditModal",setup(s){const t=le(),u=se(),r=L(null),o=L({name:""}),n=L({name:""}),v=L(!1),_=L(!1),c=L(""),f=L(!1),h=L(null);let $=null;const y=i(()=>r.value?.session_ids?.length||0);function b(){n.value={};let p=!0;return o.value.name.trim()||(n.value.name="Project name is required",p=!1),p}async function M(){if(!(!b()||!r.value)){v.value=!0,c.value="";try{await t.updateProject(r.value.project_id,{name:o.value.name}),$&&$.hide()}catch(p){console.error("Failed to update project:",p),c.value=p.message||"Failed to update project. Please try again."}finally{v.value=!1}}}async function T(){if(r.value){_.value=!0,c.value="";try{await t.deleteProject(r.value.project_id),$&&$.hide()}catch(p){console.error("Failed to delete project:",p),c.value=p.message||"Failed to delete project. Please try again."}finally{_.value=!1}}}function S(){o.value={name:""},n.value={},c.value="",f.value=!1}function w(){const p=document.getElementById("editProjectName");p&&(p.focus(),p.select())}function x(){S(),r.value=null,u.hideModal()}return te(()=>u.currentModal,p=>{if(p?.name==="edit-project"&&$){const m=p.data||{};r.value=m.project,r.value&&(o.value.name=r.value.name),$.show()}}),re(()=>{h.value&&ae(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(m=>m.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{$=new p(h.value),h.value.addEventListener("shown.bs.modal",w),h.value.addEventListener("hidden.bs.modal",x)})}),ie(()=>{h.value&&(h.value.removeEventListener("shown.bs.modal",w),h.value.removeEventListener("hidden.bs.modal",x)),$&&$.dispose()}),(p,m)=>(l(),a("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[e("div",Qc,[e("div",Zc,[m[11]||(m[11]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Xc,[e("form",{onSubmit:ue(M,["prevent"])},[e("div",eu,[m[3]||(m[3]=e("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),Y(e("input",{type:"text",class:V(["form-control",{"is-invalid":n.value.name}]),id:"editProjectName","onUpdate:modelValue":m[0]||(m[0]=N=>o.value.name=N),placeholder:"My Project",required:""},null,2),[[ne,o.value.name]]),n.value.name?(l(),a("div",tu,g(n.value.name),1)):P("",!0)]),e("div",su,[m[4]||(m[4]=e("label",{class:"form-label"},"Working Directory",-1)),e("input",{type:"text",class:"form-control",value:r.value?.working_directory,disabled:"",readonly:""},null,8,ou),m[5]||(m[5]=e("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),c.value?(l(),a("div",nu,g(c.value),1)):P("",!0)],32),m[9]||(m[9]=e("hr",null,null,-1)),e("div",lu,[m[7]||(m[7]=e("h6",{class:"text-danger"},"Danger Zone",-1)),e("p",au," Deleting this project will also delete all "+g(y.value)+" session(s) and their data. This action cannot be undone. ",1),e("button",{type:"button",class:"btn btn-outline-danger",onClick:m[1]||(m[1]=N=>f.value=!0),disabled:_.value},[...m[6]||(m[6]=[e("i",{class:"bi bi-trash"},null,-1),G(" Delete Project ",-1)])],8,ru)]),f.value?(l(),a("div",iu,[m[8]||(m[8]=e("strong",null,"Are you sure?",-1)),e("p",cu,' This will permanently delete the project "'+g(r.value?.name)+'" and all '+g(y.value)+" session(s). ",1),e("div",uu,[e("button",{type:"button",class:"btn btn-danger btn-sm",onClick:T,disabled:_.value},[_.value?(l(),a("span",mu)):P("",!0),G(" "+g(_.value?"Deleting...":"Yes, Delete Permanently"),1)],8,du),e("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:m[2]||(m[2]=N=>f.value=!1),disabled:_.value}," Cancel ",8,pu)])])):P("",!0)]),e("div",vu,[m[10]||(m[10]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:M,disabled:v.value},[v.value?(l(),a("span",gu)):P("",!0),G(" "+g(v.value?"Saving...":"Save Changes"),1)],8,fu)])])])],512))}},bu=F(_u,[["__scopeId","data-v-6f299f35"]]),hu={class:"modal-dialog modal-lg"},yu={class:"modal-content"},$u={class:"modal-header"},wu={class:"modal-title",id:"createSessionModalLabel"},Su={key:0,class:"text-muted small"},ku={class:"modal-body"},Cu={class:"mb-3"},xu={key:0,class:"invalid-feedback"},Mu={class:"mb-3"},ju={class:"mb-3"},Tu={class:"mb-3"},Eu={class:"form-text d-flex justify-content-between"},Pu={key:0,class:"invalid-feedback"},Lu={class:"mb-3 form-check"},Iu={key:0,class:"form-text text-warning"},Du={class:"mb-3"},Ou={class:"mb-3 form-check"},Nu={key:0,class:"alert alert-danger",role:"alert"},Au={class:"modal-footer"},Ru=["disabled"],qu={key:0,class:"spinner-border spinner-border-sm me-2"},Wu={__name:"SessionCreateModal",setup(s){const t=pe();le();const u=J(),r=se(),o=L(null),n=L({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0}),v=L({name:""}),_=L(!1),c=L(""),f=L(null);let h=null;const $=i(()=>n.value.system_prompt.length),y=i(()=>$.value>6e3),b=i(()=>$.value>5500&&$.value<=6e3);function M(){v.value={};let p=!0;return n.value.name.trim()||(v.value.name="Session name is required",p=!1),y.value&&(p=!1),p}async function T(){if(!(!M()||!o.value)){_.value=!0,c.value="";try{const p=n.value.tools.split(",").map(z=>z.trim()).filter(z=>z.length>0),m={name:n.value.name,permission_mode:n.value.permission_mode,model:n.value.model,system_prompt:n.value.system_prompt.trim()||null,override_system_prompt:n.value.override_system_prompt,tools:p},N=await u.createSession(o.value.project_id,m);n.value.startImmediately&&await u.startSession(N.session_id),t.push(`/session/${N.session_id}`),h&&h.hide(),S()}catch(p){console.error("Failed to create session:",p),c.value=p.message||"Failed to create session. Please try again."}finally{_.value=!1}}}function S(){n.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0},v.value={},c.value=""}function w(){const p=document.getElementById("sessionName");p&&p.focus()}function x(){S(),o.value=null,r.hideModal()}return te(()=>r.currentModal,p=>{if(p?.name==="create-session"&&h){const m=p.data||{};o.value=m.project,h.show()}}),re(()=>{f.value&&ae(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(m=>m.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{h=new p(f.value),f.value.addEventListener("shown.bs.modal",w),f.value.addEventListener("hidden.bs.modal",x)})}),ie(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",w),f.value.removeEventListener("hidden.bs.modal",x)),h&&h.dispose()}),(p,m)=>(l(),a("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[e("div",hu,[e("div",yu,[e("div",$u,[e("h5",wu,[m[7]||(m[7]=G(" Create New Session ",-1)),o.value?(l(),a("span",Su,"in "+g(o.value.name),1)):P("",!0)]),m[8]||(m[8]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",ku,[e("form",{onSubmit:ue(T,["prevent"])},[e("div",Cu,[m[9]||(m[9]=e("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),Y(e("input",{type:"text",class:V(["form-control",{"is-invalid":v.value.name}]),id:"sessionName","onUpdate:modelValue":m[0]||(m[0]=N=>n.value.name=N),placeholder:"main",required:""},null,2),[[ne,n.value.name]]),v.value.name?(l(),a("div",xu,g(v.value.name),1)):P("",!0)]),e("div",Mu,[m[11]||(m[11]=e("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),Y(e("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":m[1]||(m[1]=N=>n.value.permission_mode=N)},[...m[10]||(m[10]=[e("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),e("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),e("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),e("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[fe,n.value.permission_mode]]),m[12]||(m[12]=e("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),e("div",ju,[m[14]||(m[14]=e("label",{for:"model",class:"form-label"},"Model",-1)),Y(e("select",{class:"form-select",id:"model","onUpdate:modelValue":m[2]||(m[2]=N=>n.value.model=N)},[...m[13]||(m[13]=[e("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),e("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),e("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[fe,n.value.model]])]),e("div",Tu,[m[15]||(m[15]=e("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),Y(e("textarea",{class:V(["form-control",{"is-invalid":y.value}]),id:"systemPrompt","onUpdate:modelValue":m[3]||(m[3]=N=>n.value.system_prompt=N),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[ne,n.value.system_prompt]]),e("div",Eu,[e("span",null,g(n.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),e("span",{class:V({"text-danger":y.value,"text-warning":b.value})},g($.value)+" / 6000 chars ",3)]),y.value?(l(),a("div",Pu," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):P("",!0)]),e("div",Lu,[Y(e("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":m[4]||(m[4]=N=>n.value.override_system_prompt=N)},null,512),[[be,n.value.override_system_prompt]]),m[17]||(m[17]=e("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.value.override_system_prompt?(l(),a("div",Iu,[...m[16]||(m[16]=[e("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):P("",!0)]),e("div",Du,[m[18]||(m[18]=e("label",{for:"tools",class:"form-label"},"Allowed Tools (Optional)",-1)),Y(e("input",{type:"text",class:"form-control",id:"tools","onUpdate:modelValue":m[5]||(m[5]=N=>n.value.tools=N),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[ne,n.value.tools]]),m[19]||(m[19]=e("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),e("div",Ou,[Y(e("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":m[6]||(m[6]=N=>n.value.startImmediately=N)},null,512),[[be,n.value.startImmediately]]),m[20]||(m[20]=e("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),c.value?(l(),a("div",Nu,g(c.value),1)):P("",!0)],32)]),e("div",Au,[m[21]||(m[21]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:T,disabled:_.value},[_.value?(l(),a("span",qu)):P("",!0),G(" "+g(_.value?"Creating...":"Create Session"),1)],8,Ru)])])])],512))}},Uu=F(Wu,[["__scopeId","data-v-5aef47e0"]]),Hu={class:"modal-dialog"},Fu={class:"modal-content"},Bu={class:"modal-body"},Vu={class:"mb-3"},zu={key:0,class:"invalid-feedback"},Gu={class:"mb-3"},Ju=["value"],Ku={class:"mb-3"},Yu={class:"form-control-plaintext"},Qu={class:"mb-3"},Zu=["disabled"],Xu={key:0,value:"bypassPermissions"},ed={class:"form-text"},td={key:0,class:"text-warning"},sd={key:1},od={key:0,class:"mb-3"},nd={class:"card"},ld={class:"card-body"},ad={key:0,class:"mb-2"},rd={key:1,class:"mb-2"},id={key:2,class:"mt-2"},cd={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},ud={key:1,class:"alert alert-danger",role:"alert"},dd={class:"modal-footer"},md=["disabled"],pd={key:0,class:"spinner-border spinner-border-sm me-2"},vd={__name:"SessionEditModal",setup(s){const t=J(),u=se(),r=L(null),o=L({name:"",permission_mode:"default"}),n=L({name:""}),v=L(!1),_=L(""),c=L(null);let f=null;const h=i(()=>r.value?.state==="active"||r.value?.state==="starting"),$=i(()=>r.value?.initial_permission_mode==="bypassPermissions");function y(x){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[x]||"bg-secondary"}function b(){n.value={};let x=!0;return o.value.name.trim()||(n.value.name="Session name is required",x=!1),x}async function M(){if(!(!b()||!r.value)){v.value=!0,_.value="";try{await t.updateSessionName(r.value.session_id,o.value.name),o.value.permission_mode!==r.value.current_permission_mode&&await t.setPermissionMode(r.value.session_id,o.value.permission_mode),f&&f.hide()}catch(x){console.error("Failed to update session:",x),_.value=x.message||"Failed to update session. Please try again."}finally{v.value=!1}}}function T(){o.value={name:"",permission_mode:"default"},n.value={},_.value=""}function S(){const x=document.getElementById("editSessionName");x&&(x.focus(),x.select())}function w(){T(),r.value=null,u.hideModal()}return te(()=>u.currentModal,x=>{if(x?.name==="edit-session"&&f){const p=x.data||{};r.value=p.session,r.value&&(o.value.name=r.value.name,o.value.permission_mode=r.value.current_permission_mode||"default"),f.show()}}),re(()=>{c.value&&ae(async()=>{const{default:x}=await import("./modal-B4rHLo2F.js").then(p=>p.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{f=new x(c.value),c.value.addEventListener("shown.bs.modal",S),c.value.addEventListener("hidden.bs.modal",w)})}),ie(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",S),c.value.removeEventListener("hidden.bs.modal",w)),f&&f.dispose()}),(x,p)=>(l(),a("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[e("div",Hu,[e("div",Fu,[p[15]||(p[15]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",Bu,[e("form",{onSubmit:ue(M,["prevent"])},[e("div",Vu,[p[2]||(p[2]=e("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),Y(e("input",{type:"text",class:V(["form-control",{"is-invalid":n.value.name}]),id:"editSessionName","onUpdate:modelValue":p[0]||(p[0]=m=>o.value.name=m),placeholder:"Session Name",required:""},null,2),[[ne,o.value.name]]),n.value.name?(l(),a("div",zu,g(n.value.name),1)):P("",!0)]),e("div",Gu,[p[3]||(p[3]=e("label",{class:"form-label"},"Working Directory",-1)),e("input",{type:"text",class:"form-control",value:r.value?.working_directory,disabled:"",readonly:""},null,8,Ju),p[4]||(p[4]=e("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),e("div",Ku,[p[5]||(p[5]=e("label",{class:"form-label"},"Current State",-1)),e("div",Yu,[e("span",{class:V(["badge",y(r.value?.state)])},g(r.value?.state),3)])]),e("div",Qu,[p[9]||(p[9]=e("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),Y(e("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":p[1]||(p[1]=m=>o.value.permission_mode=m),disabled:!h.value},[p[6]||(p[6]=e("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),p[7]||(p[7]=e("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),p[8]||(p[8]=e("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),$.value?(l(),a("option",Xu,"âš ï¸ Bypass Permissions (No prompts)")):P("",!0)],8,Zu),[[fe,o.value.permission_mode]]),e("div",ed,[h.value?(l(),a("span",sd," Controls which tool actions require permission prompts ")):(l(),a("span",td," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),r.value?.system_prompt||r.value?.override_system_prompt?(l(),a("div",od,[p[13]||(p[13]=e("label",{class:"form-label"},"System Prompt Configuration",-1)),e("div",nd,[e("div",ld,[r.value?.override_system_prompt?(l(),a("div",ad,[...p[10]||(p[10]=[e("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),e("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(l(),a("div",rd,[...p[11]||(p[11]=[e("span",{class:"badge bg-info"},"Append Mode",-1),e("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),r.value?.system_prompt?(l(),a("div",id,[p[12]||(p[12]=e("strong",{class:"small"},"Custom Instructions:",-1)),e("div",cd,g(r.value.system_prompt),1)])):P("",!0)])])])):P("",!0),_.value?(l(),a("div",ud,g(_.value),1)):P("",!0)],32)]),e("div",dd,[p[14]||(p[14]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:M,disabled:v.value},[v.value?(l(),a("span",pd)):P("",!0),G(" "+g(v.value?"Saving...":"Save Changes"),1)],8,md)])])])],512))}},fd=F(vd,[["__scopeId","data-v-c99ca17f"]]),gd={class:"modal-dialog modal-dialog-centered"},_d={class:"modal-content"},bd={class:"modal-header"},hd={class:"modal-title",id:"manageSessionModalLabel"},yd={class:"modal-body"},$d={key:0,class:"text-center py-4"},wd={class:"text-muted"},Sd={key:1},kd={key:2},Cd={class:"text-muted"},xd={key:3},Md={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},jd={class:"d-grid gap-2"},Td=["disabled"],Ed=["disabled"],Pd=["disabled"],Ld=["disabled"],Id={class:"modal-footer"},Dd={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},Od={__name:"SessionManageModal",setup(s){const t=pe(),u=J(),r=se(),o=ge();de();const n=L(null),v=L(!1),_=L(""),c=L(""),f=L(null),h=L(null);let $=null;const y=i(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function b(){f.value="reset"}function M(){f.value="delete"}function T(){f.value=null}async function S(){f.value==="reset"?await p():f.value==="delete"&&await m()}async function w(){if(n.value){v.value=!0,_.value="Restarting session...";try{const k=n.value.session_id,E=await K.post(`/api/sessions/${k}/restart`);if(E.success)console.log("Session restarted successfully, reconnecting"),await o.disconnectSession(),u.currentSessionId=null,await u.selectSession(k),$&&$.hide();else{const W=E.error||E.detail||"Failed to restart session";console.error("Failed to restart session:",W),c.value=`Failed to restart session: ${W}`}}catch(k){console.error("Error restarting session:",k);const E=k.data?.detail||k.message||"Unknown error";c.value=`Error restarting session: ${E}`}finally{v.value=!1}}}async function x(){if(n.value)try{$&&$.hide(),console.log("Ending session",n.value.session_id);const k=n.value.session_id;await K.post(`/api/sessions/${k}/terminate`),await o.disconnectSession(),u.currentSessionId===k&&(u.currentSessionId=null),t.push("/")}catch(k){console.error("Error ending session:",k),await o.disconnectSession(),u.currentSessionId===n.value?.session_id&&(u.currentSessionId=null),t.push("/")}}async function p(){if(n.value){v.value=!0,_.value="Resetting session...";try{const k=n.value.session_id,E=await K.post(`/api/sessions/${k}/reset`);if(E.success)console.log("Session reset successfully, reconnecting"),await o.disconnectSession(),u.currentSessionId=null,await u.selectSession(k),$&&$.hide();else{const W=E.error||E.detail||"Failed to reset session";console.error("Failed to reset session:",W),c.value=`Failed to reset session: ${W}`,f.value=null}}catch(k){console.error("Error resetting session:",k);const E=k.data?.detail||k.message||"Unknown error";c.value=`Error resetting session: ${E}`,f.value=null}finally{v.value=!1}}}async function m(){if(n.value){v.value=!0,_.value="Deleting session...";try{const k=n.value.session_id;await u.deleteSession(k),t.currentRoute.value.params.sessionId===k&&t.push("/"),$&&$.hide()}catch(k){console.error("Error deleting session:",k);const E=k.data?.detail||k.message||"Unknown error";c.value=`Error deleting session: ${E}`,f.value=null}finally{v.value=!1}}}function N(){f.value=null,v.value=!1,_.value="",c.value=""}function z(){N(),n.value=null,r.hideModal()}return te(()=>r.currentModal,k=>{if(k?.name==="manage-session"&&$){const E=k.data||{};n.value=E.session,N(),$.show()}}),re(()=>{h.value&&ae(async()=>{const{default:k}=await import("./modal-B4rHLo2F.js").then(E=>E.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{$=new k(h.value),h.value.addEventListener("hidden.bs.modal",z)})}),ie(()=>{h.value&&h.value.removeEventListener("hidden.bs.modal",z),$&&$.dispose()}),(k,E)=>(l(),a("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[e("div",gd,[e("div",_d,[e("div",bd,[e("h5",hd,g(f.value?y.value:"Manage Session"),1),E[1]||(E[1]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",yd,[v.value?(l(),a("div",$d,[E[2]||(E[2]=e("div",{class:"spinner-border text-primary mb-3",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)),e("p",wd,g(_.value),1)])):f.value==="reset"?(l(),a("div",Sd,[...E[3]||(E[3]=[e("div",{class:"alert alert-danger mb-3"},[e("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),e("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),e("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(l(),a("div",kd,[E[6]||(E[6]=e("div",{class:"alert alert-danger mb-3"},[e("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),e("p",Cd,[E[4]||(E[4]=G("This will permanently delete session ",-1)),e("strong",null,g(n.value?.name),1),E[5]||(E[5]=G(".",-1))]),E[7]||(E[7]=e("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(l(),a("div",xd,[c.value?(l(),a("div",Md,[E[8]||(E[8]=e("strong",null,"Error:",-1)),G(" "+g(c.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:E[0]||(E[0]=W=>c.value="")})])):P("",!0),E[15]||(E[15]=e("p",{class:"text-muted"},"Choose how to manage this session:",-1)),e("div",jd,[e("button",{class:"btn btn-outline-primary text-start",onClick:w,disabled:v.value},[...E[9]||(E[9]=[e("strong",null,"ðŸ”„ Restart Agent",-1),e("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,Td),e("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:v.value},[...E[10]||(E[10]=[e("strong",null,"ðŸšª End Session",-1),e("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,Ed),E[13]||(E[13]=e("hr",{class:"my-2"},null,-1)),E[14]||(E[14]=e("div",{class:"danger-zone-header"},[e("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),e("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:v.value},[...E[11]||(E[11]=[e("strong",null,"ðŸ—‘ï¸ Reset Session",-1),e("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,Pd),e("button",{class:"btn btn-outline-danger text-start",onClick:M,disabled:v.value},[...E[12]||(E[12]=[e("strong",null,"âŒ Delete Session",-1),e("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,Ld)]),E[16]||(E[16]=e("div",{class:"alert alert-warning mt-3 mb-0"},[e("small",null,[e("strong",null,"Note:"),G(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),e("div",Id,[f.value&&!v.value?(l(),a(Z,{key:0},[e("button",{type:"button",class:"btn btn-secondary",onClick:T},"Cancel"),e("button",{type:"button",class:V(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:S},g(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):v.value?P("",!0):(l(),a("button",Dd,"Cancel"))])])])],512))}},Nd=F(Od,[["__scopeId","data-v-de7ff18c"]]),Ad={class:"modal-dialog modal-dialog-centered modal-lg"},Rd={class:"modal-content"},qd={class:"modal-body"},Wd={key:0,class:"text-center text-muted py-4"},Ud={key:1},Hd={class:"mb-3"},Fd={class:"font-monospace small"},Bd={class:"mb-3"},Vd={class:"font-monospace small"},zd={class:"mb-3"},Gd={class:"mb-3"},Jd={class:"mb-3"},Kd={key:0},Yd={class:"d-flex flex-wrap gap-1"},Qd={key:1,class:"text-muted small"},Zd={key:0,class:"mb-3"},Xd={class:"d-flex flex-wrap gap-1"},em={key:1,class:"mb-3"},tm={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},sm={class:"mb-3"},om={class:"text-muted"},nm={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},lm={__name:"SessionInfoModal",setup(s){const t=J(),u=de(),r=se(),o=L(null),n=L(!1),v=L(null);let _=null;const c=i(()=>{if(!o.value)return null;const y=t.initData.get(o.value);return y||(u.messagesBySession.get(o.value)||[]).find(T=>T.type==="system"&&(T.subtype==="init"||T.metadata?.subtype==="init")&&T.metadata?.init_data)?.metadata?.init_data||null});function f(y){return typeof y=="string"?y:typeof y=="object"&&y.type==="preset"?`Preset: ${y.preset}`:JSON.stringify(y,null,2)}function h(){o.value=null,n.value=!1}function $(){h(),r.hideModal()}return te(()=>r.currentModal,y=>{if(y?.name==="session-info"&&_){const b=y.data||{};o.value=b.sessionId,n.value=!1,_.show()}}),re(()=>{v.value&&ae(async()=>{const{default:y}=await import("./modal-B4rHLo2F.js").then(b=>b.m);return{default:y}},__vite__mapDeps([0,1])).then(({default:y})=>{_=new y(v.value),v.value.addEventListener("hidden.bs.modal",$)})}),ie(()=>{v.value&&v.value.removeEventListener("hidden.bs.modal",$),_&&_.dispose()}),(y,b)=>(l(),a("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:v},[e("div",Ad,[e("div",Rd,[b[9]||(b[9]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",qd,[c.value?(l(),a("div",Ud,[e("div",Hd,[b[1]||(b[1]=e("h6",{class:"text-muted"},"Session ID",-1)),e("div",Fd,g(o.value),1)]),e("div",Bd,[b[2]||(b[2]=e("h6",{class:"text-muted"},"Working Directory",-1)),e("div",Vd,g(c.value.cwd||"Not specified"),1)]),e("div",zd,[b[3]||(b[3]=e("h6",{class:"text-muted"},"Model",-1)),e("div",null,g(c.value.model||"Default"),1)]),e("div",Gd,[b[4]||(b[4]=e("h6",{class:"text-muted"},"Permission Mode",-1)),e("div",null,g(c.value.permissionMode||"default"),1)]),e("div",Jd,[b[5]||(b[5]=e("h6",{class:"text-muted"},"Available Tools",-1)),c.value.tools&&c.value.tools.length>0?(l(),a("div",Kd,[e("div",Yd,[(l(!0),a(Z,null,ee(c.value.tools,M=>(l(),a("span",{key:M,class:"badge bg-secondary"},g(M),1))),128))])])):(l(),a("div",Qd,"All tools available"))]),c.value.commands&&c.value.commands.length>0?(l(),a("div",Zd,[b[6]||(b[6]=e("h6",{class:"text-muted"},"Commands",-1)),e("div",Xd,[(l(!0),a(Z,null,ee(c.value.commands,M=>(l(),a("span",{key:M,class:"badge bg-info"},g(M),1))),128))])])):P("",!0),c.value.systemPrompt?(l(),a("div",em,[b[7]||(b[7]=e("h6",{class:"text-muted"},"System Prompt",-1)),e("pre",tm,g(f(c.value.systemPrompt)),1)])):P("",!0),e("div",sm,[e("h6",om,[b[8]||(b[8]=G(" Raw Configuration ",-1)),e("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:b[0]||(b[0]=M=>n.value=!n.value)},g(n.value?"Hide":"Show"),1)]),n.value?(l(),a("pre",nm,g(JSON.stringify(c.value,null,2)),1)):P("",!0)])])):(l(),a("div",Wd," No session configuration data available "))]),b[10]||(b[10]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},am=F(lm,[["__scopeId","data-v-809e2099"]]),rm={class:"modal-dialog modal-dialog-centered"},im={class:"modal-content"},cm={class:"modal-body"},um={class:"mb-3"},dm={class:"mb-3"},mm={class:"mb-3"},pm={class:"form-text d-flex justify-content-between"},vm={key:0,class:"invalid-feedback"},fm={class:"mb-3 form-check"},gm={key:0,class:"form-text text-warning"},_m={class:"mb-3"},bm={key:0,class:"alert alert-danger"},hm={class:"modal-footer"},ym=["disabled"],$m={key:0,class:"spinner-border spinner-border-sm me-2"},wm={__name:"CreateMinionModal",setup(s){const t=pe(),u=le(),r=J(),o=se(),n=L(null);let v=null;const _=L(null),c=L({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[]}),f=L(""),h=L(""),$=L(!1),y=i(()=>f.value.trim()?f.value.split(",").map(p=>p.trim()).filter(p=>p.length>0):[]),b=i(()=>c.value.initialization_context.length),M=i(()=>b.value>2e3),T=i(()=>b.value>1800&&b.value<=2e3);function S(){c.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[]},f.value="",h.value="",$.value=!1}function w(){S(),o.hideModal()}async function x(){if(!c.value.name.trim()){h.value="Minion name is required";return}if(c.value.name.includes(" ")){h.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(M.value){h.value="Initialization context exceeds 2000 character limit";return}if(!_.value){h.value="Legion ID is missing";return}$.value=!0,h.value="";try{const p={name:c.value.name.trim(),role:c.value.role.trim(),initialization_context:c.value.initialization_context.trim(),override_system_prompt:c.value.override_system_prompt,capabilities:y.value},m=await K.post(`/api/legions/${_.value}/minions`,p);m.success&&m.minion_id?(await u.fetchProjects(),await r.fetchSessions(),v&&v.hide(),t.push(`/spy/${_.value}/${m.minion_id}`)):h.value="Failed to create minion"}catch(p){console.error("Failed to create minion:",p),h.value=p.response?.data?.detail||"Failed to create minion"}finally{$.value=!1}}return te(()=>o.currentModal,p=>{if(p?.name==="create-minion"&&v){const m=p.data||{};_.value=m.project?.project_id||null,S(),v.show()}}),re(()=>{n.value&&ae(()=>import("./modal-B4rHLo2F.js").then(p=>p.m),__vite__mapDeps([0,1])).then(p=>{const m=p.default;v=new m(n.value),n.value.addEventListener("hidden.bs.modal",w)})}),ie(()=>{n.value&&n.value.removeEventListener("hidden.bs.modal",w),v&&v.dispose()}),(p,m)=>(l(),a("div",{ref_key:"modalElement",ref:n,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[e("div",rm,[e("div",im,[m[15]||(m[15]=e("div",{class:"modal-header"},[e("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",cm,[e("form",{onSubmit:ue(x,["prevent"])},[e("div",um,[m[5]||(m[5]=e("label",{for:"minion-name",class:"form-label"},[G(" Name "),e("span",{class:"text-danger"},"*")],-1)),Y(e("input",{id:"minion-name","onUpdate:modelValue":m[0]||(m[0]=N=>c.value.name=N),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[ne,c.value.name]]),m[6]||(m[6]=e("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),e("div",dm,[m[7]||(m[7]=e("label",{for:"minion-role",class:"form-label"},"Role",-1)),Y(e("input",{id:"minion-role","onUpdate:modelValue":m[1]||(m[1]=N=>c.value.role=N),type:"text",class:"form-control",placeholder:"e.g., Code Expert, Testing Specialist"},null,512),[[ne,c.value.role]]),m[8]||(m[8]=e("div",{class:"form-text"},"Optional role description for the minion",-1))]),e("div",mm,[m[9]||(m[9]=e("label",{for:"minion-context",class:"form-label"},"Initialization Context",-1)),Y(e("textarea",{id:"minion-context","onUpdate:modelValue":m[2]||(m[2]=N=>c.value.initialization_context=N),class:V(["form-control",{"is-invalid":M.value}]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion..."},null,2),[[ne,c.value.initialization_context]]),e("div",pm,[e("span",null,g(c.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),e("span",{class:V({"text-danger":M.value,"text-warning":T.value})},g(b.value)+" / 2000 chars ",3)]),M.value?(l(),a("div",vm," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):P("",!0)]),e("div",fm,[Y(e("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":m[3]||(m[3]=N=>c.value.override_system_prompt=N)},null,512),[[be,c.value.override_system_prompt]]),m[11]||(m[11]=e("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),c.value.override_system_prompt?(l(),a("div",gm,[...m[10]||(m[10]=[e("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):P("",!0)]),e("div",_m,[m[12]||(m[12]=e("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),Y(e("input",{id:"minion-capabilities","onUpdate:modelValue":m[4]||(m[4]=N=>f.value=N),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[ne,f.value]]),m[13]||(m[13]=e("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),h.value?(l(),a("div",bm,g(h.value),1)):P("",!0)],32)]),e("div",hm,[m[14]||(m[14]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),e("button",{type:"button",class:"btn btn-primary",disabled:!c.value.name.trim()||$.value,onClick:x},[$.value?(l(),a("span",$m)):P("",!0),G(" "+g($.value?"Creating...":"Create Minion"),1)],8,ym)])])])],512))}},Sm=F(wm,[["__scopeId","data-v-d7434e2a"]]),km={class:"container-fluid vh-100 d-flex flex-column p-0"},Cm={class:"d-flex flex-grow-1 overflow-hidden position-relative"},xm={class:"flex-grow-1 d-flex flex-column overflow-hidden"},Mm={__name:"App",setup(s){const t=se(),u=ge(),r=J(),o=le(),n=pe(),v=i(()=>t.sidebarCollapsed),_=i(()=>t.isMobile);re(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),u.connectUI(),await Promise.all([o.fetchProjects(),r.fetchSessions()]);const h=window.location.hash;if(h.startsWith("#/session/")){const $=h.replace("#/session/","");r.sessions.has($)&&await r.selectSession($)}else if(h.startsWith("#/timeline/")){const $=h.replace("#/timeline/","");n.push(`/timeline/${$}`)}window.addEventListener("popstate",c),window.addEventListener("resize",t.handleResize)}),ie(()=>{window.removeEventListener("popstate",c),window.removeEventListener("resize",t.handleResize),u.disconnectUI()});function c(){const h=window.location.hash;if(h.startsWith("#/session/")){const $=h.replace("#/session/","");r.sessions.has($)&&r.selectSession($)}}function f(){t.toggleSidebar()}return(h,$)=>{const y=We("router-view");return l(),a("div",km,[Q(Pi),e("div",{id:"sidebar-backdrop",class:V({show:!v.value&&_.value}),onClick:f},null,2),e("div",Cm,[Q(vc),e("main",xm,[Q(y)])]),Q(Pc),Q(Yc),Q(bu),Q(Uu),Q(fd),Q(Nd),Q(am),Q(Sm)])}}},Ee=Ve(Mm);Ee.use(ze());Ee.use(Mi);Ee.mount("#app");
