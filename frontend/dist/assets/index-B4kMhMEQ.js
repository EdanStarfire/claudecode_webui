const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as s,o as d,d as gt,r as D,b as f,t as $,n as je,e as K,f as G,u as Jt,w as le,g as fn,h as I,F as se,i as ae,j as we,k as no,l as te,v as me,m as ie,p as pe,q as Os,s as Xt,x as he,y as be,z as Fe,A as oo,B as mi,C as pi,D as Ke,T as io,E as At,G as fi,H as vi}from"./vue-vendor-Dbs_RS4O.js";import{m as Mt,p as Vs}from"./markdown-vendor-CQ3OZdP9.js";import{c as hi}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const _i={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},gi={__name:"NoSessionSelected",setup(n){return(e,t)=>(d(),m("div",_i,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},bi="modulepreload",yi=function(n){return"/"+n},vn={},$e=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let l=function(p){return Promise.all(p.map(c=>Promise.resolve(c).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),u=r?.nonce||r?.getAttribute("nonce");i=l(t.map(p=>{if(p=yi(p),p in vn)return;vn[p]=!0;const c=p.endsWith(".css"),_=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${_}`))return;const v=document.createElement("link");if(v.rel=c?"stylesheet":bi,c||(v.as="script"),v.crossOrigin="",v.href=p,u&&v.setAttribute("nonce",u),document.head.appendChild(v),c)return new Promise((h,x)=>{v.addEventListener("load",h),v.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(r){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=r,window.dispatchEvent(u),!u.defaultPrevented)throw r}return i.then(r=>{for(const u of r||[])u.status==="rejected"&&a(u.reason);return e().catch(a)})};class ms extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function Ot(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new ms(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof ms?t:(console.error("API request failed:",t),new ms(`Network error: ${t.message}`,0,null))}}async function $i(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[u,l]of Object.entries(e.params))l!=null&&o.append(u,l);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...r}=e;return Ot(t,{...r,method:"GET"})}return Ot(t,{...e,method:"GET"})}async function wi(n,e,t={}){return Ot(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Ei(n,e,t={}){return Ot(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ci(n,e={}){return Ot(n,{...e,method:"DELETE"})}const Z={get:$i,post:wi,put:Ei,delete:Ci},ee=gt("session",()=>{const n=D(new Map),e=D(null),t=D(new Map),o=D(new Map),i=D(new Set),a=D(!1);let r=null;const u=f(()=>n.value.get(e.value)),l=f(()=>Array.from(n.value.values()).sort((A,k)=>A.order-k.order)),p=A=>f(()=>l.value.filter(k=>k.project_id===A)),c=f({get:()=>t.value.get(e.value)||"",set:A=>{e.value&&t.value.set(e.value,A)}});async function _(){try{const A=await Z.get("/api/sessions");return n.value.clear(),A.sessions.forEach(k=>{n.value.set(k.session_id,k)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function v(A,k){try{const C=(await Z.post("/api/sessions",{project_id:A,...k})).session_id,T=(await Z.get(`/api/sessions/${C}`)).session;return n.value.set(C,T),n.value=new Map(n.value),console.log(`Created session ${C}`),T}catch(N){throw console.error("Failed to create session:",N),N}}async function h(A){if(e.value===A&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${A}`),r.abort(),r=null);const k=new AbortController;r=k,a.value=!0;try{if(e.value=A,k.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let N=n.value.get(A);if(!N)try{const T=await Z.get(`/api/sessions/${A}`);if(k.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}N=T.session,n.value.set(A,N),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(T){console.error(`Failed to fetch session ${A}:`,T);return}if(N&&(N.state==="created"||N.state==="terminated"))try{if(await M(A),k.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${N.state} state)`);const T=6e4,O=200,L=5e3;let R=0,F=0;for(;R<T;){if(k.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const ne=n.value.get(A);if(ne&&ne.state==="active"){console.log(`Session ${A} is now active after ${R}ms`);break}if(R-F>=L){const re=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${re}, ${R/1e3}s elapsed)`),F=R}await new Promise(re=>setTimeout(re,O)),R+=O}const U=n.value.get(A);U&&U.state!=="active"&&console.warn(`Session ${A} did not become active within ${T/1e3}s (state: ${U.state}), continuing anyway`)}catch(T){console.error(`Failed to auto-start session ${A}:`,T)}if(k.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await $e(()=>Promise.resolve().then(()=>Bi),void 0)).useMessageStore().loadMessages(A),k.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}await(await $e(()=>Promise.resolve().then(()=>ua),void 0)).useWebSocketStore().connectSession(A),k.signal.aborted||console.log(`Selected session ${A}`)}finally{r===k&&(r=null),a.value=!1}}function x(A,k){const N=n.value.get(A);N?Object.assign(N,k):(n.value.set(A,k),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function g(A){i.value.add(A);try{await Z.delete(`/api/sessions/${A}`),n.value.delete(A),t.value.delete(A),o.value.delete(A),n.value=new Map(n.value),e.value===A&&(e.value=null),console.log(`Deleted session ${A}`)}catch(k){throw console.error("Failed to delete session:",k),k}finally{i.value.delete(A)}}async function b(A,k){try{await Z.put(`/api/sessions/${A}/name`,{name:k}),x(A,{name:k}),console.log(`Updated session ${A} name to "${k}"`)}catch(N){throw console.error("Failed to update session name:",N),N}}async function y(A,k){try{await Z.post(`/api/sessions/${A}/permission-mode`,{mode:k}),x(A,{current_permission_mode:k});const N=o.value.get(A);N&&(N.permissionMode=k,o.value.set(A,N)),console.log(`Set permission mode for session ${A} to ${k}`)}catch(N){throw console.error("Failed to set permission mode:",N),N}}async function M(A){try{await Z.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(k){throw console.error("Failed to start session:",k),k}}async function S(A){try{await Z.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(k){throw console.error("Failed to pause session:",k),k}}async function w(A){try{await Z.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(k){throw console.error("Failed to terminate session:",k),k}}function P(A){return n.value.get(A)}function j(A,k){o.value.set(A,k),k.permissionMode&&x(A,{current_permission_mode:k.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:u,orderedSessions:l,sessionsInProject:p,currentInput:c,fetchSessions:_,createSession:v,selectSession:h,updateSession:x,deleteSession:g,updateSessionName:b,setPermissionMode:y,startSession:M,pauseSession:S,terminateSession:w,getSession:P,storeInitData:j}}),hn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ee},Symbol.toStringTag,{value:"Module"})),ce=gt("ui",()=>{const n=D(window.innerWidth<768),e=D(300),t=D(window.innerWidth),o=f(()=>t.value<768),i=D(!0),a=D(null),r=D(null),u=f(()=>a.value?{name:a.value,data:r.value}:null),l=D(!1),p=D("Loading...");function c(){n.value=!n.value}function _(S){n.value=S}function v(S){e.value=Math.max(200,Math.min(S,window.innerWidth*.3))}function h(S){i.value=S}function x(S,w=null){a.value=null,r.value=null,setTimeout(()=>{a.value=S,r.value=w},0)}function g(){a.value=null,r.value=null}function b(S="Loading..."){l.value=!0,p.value=S}function y(){l.value=!1}function M(){const S=t.value;t.value=window.innerWidth,t.value<768&&S>=768?n.value=!0:t.value>=768&&S<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:u,isLoading:l,loadingMessage:p,toggleSidebar:c,setSidebarCollapsed:_,setSidebarWidth:v,setAutoScroll:h,showModal:x,hideModal:g,showLoading:b,hideLoading:y,handleResize:M}}),ve=gt("project",()=>{const n=D(new Map),e=D(null),t=f(()=>n.value.get(e.value)),o=f(()=>Array.from(n.value.values()).sort((g,b)=>g.order-b.order)),i=g=>n.value.get(g)?.is_multi_agent||!1;async function a(){try{const g=await Z.get("/api/projects");return n.value.clear(),g.projects.forEach(b=>{n.value.set(b.project_id,b)}),console.log(`Loaded ${n.value.size} projects`),g.projects}catch(g){throw console.error("Failed to fetch projects:",g),g}}async function r(g,b,y=!1){try{const S=(await Z.post("/api/projects",{name:g,working_directory:b,is_multi_agent:y})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(M){throw console.error("Failed to create project:",M),M}}async function u(g,b){try{await Z.put(`/api/projects/${g}`,b),l(g,b),console.log(`Updated project ${g}`,b)}catch(y){throw console.error("Failed to update project:",y),y}}function l(g,b){const y=n.value.get(g);y&&(Object.assign(y,b),n.value=new Map(n.value))}async function p(g){try{await Z.delete(`/api/projects/${g}`),n.value.delete(g),n.value=new Map(n.value),e.value===g&&(e.value=null),console.log(`Deleted project ${g}`)}catch(b){throw console.error("Failed to delete project:",b),b}}async function c(g){try{const b=await Z.put(`/api/projects/${g}/toggle-expansion`),y=n.value.get(g);return y&&(y.is_expanded=b.is_expanded,n.value=new Map(n.value)),b.is_expanded}catch(b){throw console.error("Failed to toggle expansion:",b),b}}async function _(g){try{await Z.put("/api/projects/reorder",{project_ids:g}),g.forEach((b,y)=>{const M=n.value.get(b);M&&(M.order=y)}),n.value=new Map(n.value),console.log("Reordered projects",g)}catch(b){throw console.error("Failed to reorder projects:",b),b}}async function v(g,b){try{await Z.put(`/api/projects/${g}/sessions/reorder`,{session_ids:b});const y=n.value.get(g);y&&(y.session_ids=b,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${g}`,b)}catch(y){throw console.error("Failed to reorder sessions:",y),y}}function h(g){return n.value.get(g)}function x(g){if(!g)return"";const b=g.split(/[/\\]/).filter(y=>y);return b.length===0?"/":b.length===1?`/${b[0]}`:b.length===2?`/${b.join("/")}`:`.../${b.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:r,updateProject:u,updateProjectLocal:l,deleteProject:p,toggleExpansion:c,reorderProjects:_,reorderSessionsInProject:v,getProject:h,formatPath:x}}),Y=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Si={class:"session-header border-bottom p-3"},Ti={class:"project-name"},ki=["title"],xi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ee(),o=ve(),i=f(()=>t.sessions.get(e.sessionId)),a=f(()=>i.value?.name||e.sessionId),r=f(()=>{for(const l of o.projects.values())if(l.session_ids?.includes(e.sessionId))return l;return null}),u=f(()=>r.value?.name||"Unknown Project");return(l,p)=>(d(),m("div",Si,[s("div",null,[s("div",Ti,$(u.value),1),s("div",{class:"session-name",title:n.sessionId},$(a.value),9,ki)])]))}},Ai=Y(xi,[["__scopeId","data-v-89e9c269"]]),Mi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Oi=["title"],Ni={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Di={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ee(),o=f(()=>t.sessions.get(e.sessionId)),i=f(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=f(()=>{const l=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[l]||"#d3d3d3"}),r=f(()=>{const l=i.value;return l==="starting"||l==="processing"||l==="pending-prompt"}),u=f(()=>{if(!o.value)return"No session selected";const l=i.value,p=l.charAt(0).toUpperCase()+l.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",_=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${_}: ${p}`});return(l,p)=>(d(),m("div",Mi,[o.value?(d(),m("div",{key:0,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:je({width:"100%",backgroundColor:a.value}),title:u.value},null,14,Oi)):(d(),m("div",Ni))]))}},Li=Y(Di,[["__scopeId","data-v-e8795bb7"]]),Ii={class:"session-status-bar border-top p-2 bg-light"},Pi={class:"d-flex justify-content-between align-items-center gap-2"},ji={class:"d-flex gap-2"},Ri=["disabled"],Vi={class:"mode-label"},Hi=["disabled"],Wi=["disabled"],Fi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ee(),o=ce(),i=f(()=>t.sessions.get(e.sessionId)),a=f(()=>i.value?.current_permission_mode||"default"),r={default:"🔒",acceptEdits:"✏️",plan:"📋",bypassPermissions:"☢️"},u=f(()=>r[a.value]||"🔒"),l=f(()=>a.value),p=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(y){console.error("Failed to cycle permission mode:",y)}return}const g=(p.indexOf(a.value)+1)%p.length,b=p[g];try{await t.setPermissionMode(e.sessionId,b)}catch(y){console.error("Failed to cycle permission mode:",y)}},_=()=>{o.showModal("session-info",{sessionId:e.sessionId})},v=()=>{o.showModal("manage-session",{session:i.value})},h=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(x,g)=>(d(),m("div",Ii,[s("div",Pi,[s("div",ji,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[G($(u.value)+" ",1),s("span",Vi,$(l.value),1)],8,Ri),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!i.value},[...g[0]||(g[0]=[G(" ℹ️ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Hi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:v,disabled:!i.value},[...g[1]||(g[1]=[G(" ⚙️ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,Wi)]),s("div",null,[s("button",{class:K(["btn btn-sm",Jt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:h}," ⬇️ "+$(Jt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Ui=Y(Fi,[["__scopeId","data-v-fdcd3535"]]),De=gt("message",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(new Map),u=f(()=>{const T=ee();return n.value.get(T.currentSessionId)||[]}),l=f(()=>{const T=ee();return e.value.get(T.currentSessionId)||[]});async function p(T,O=null,L=0){try{const R=O||1e4,F=await Z.get(`/api/sessions/${T}/messages?limit=${R}&offset=${L}`),U=F.messages||[],ne=F.total_count||U.length,re=F.has_more||!1;if(console.log(`Loaded ${U.length} of ${ne} messages for session ${T}`),n.value.set(T,U),U.length>0){const Q=U[U.length-1];Q.timestamp&&(r.value.set(T,Q.timestamp),console.log(`Tracked last received timestamp for session ${T}: ${Q.timestamp}`))}const ue=new Set;U.forEach(Q=>{Q.type==="assistant"&&Q.metadata?.tool_uses&&Q.metadata.tool_uses.forEach(B=>{ue.add(B.id)}),Q.type==="user"&&Q.metadata?.tool_results&&Q.metadata.tool_results.forEach(B=>{ue.delete(B.tool_use_id);const oe=a.value.get(T);oe&&oe.delete(B.tool_use_id)}),Q.type==="system"&&Q.metadata?.subtype==="client_launched"&&(ue.forEach(B=>{w(T,B,"Session was restarted")}),ue.clear()),Q.type==="system"&&Q.metadata?.subtype==="interrupt"&&(ue.forEach(B=>{w(T,B,"Session was interrupted")}),ue.clear()),Q.metadata?.has_tool_uses&&Q.metadata.tool_uses&&Q.metadata.tool_uses.forEach(B=>{x(T,B)}),Q.metadata?.has_tool_results&&Q.metadata.tool_results&&Q.metadata.tool_results.forEach(B=>{y(T,B)}),(Q.type==="permission_request"||Q.metadata?.has_permission_requests)&&g(T,Q),Q.type==="system"&&(Q.subtype==="init"||Q.metadata?.subtype==="init")&&Q.metadata?.init_data&&ee().storeInitData(T,Q.metadata.init_data)});const fe=ee().sessions.get(T);return fe&&!["active","paused","starting"].includes(fe.state)&&(ue.forEach(Q=>{w(T,Q,"Session was terminated")}),ue.clear()),i.value.set(T,ue),n.value=new Map(n.value),re&&console.warn(`Warning: Only loaded ${U.length} of ${ne} messages. Some messages may be missing.`),{messages:U,totalCount:ne,hasMore:re}}catch(R){throw console.error("Failed to load messages:",R),R}}function c(T,O){const L=i.value.get(T)||new Set;O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(R=>{L.add(R.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(R=>{L.delete(R.tool_use_id);const F=a.value.get(T);F&&F.delete(R.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(L.forEach(R=>{w(T,R,"Session was restarted")}),L.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(L.forEach(R=>{w(T,R,"Session was interrupted")}),L.clear()),i.value.set(T,L)}function _(T,O){n.value.has(T)||n.value.set(T,[]);const L=n.value.get(T);if(O.id){const R=L.findIndex(F=>F.id===O.id);if(R!==-1){console.log(`Skipping duplicate message ${O.id} (already exists at index ${R})`);return}}L.push(O),O.timestamp&&r.value.set(T,O.timestamp),c(T,O),n.value=new Map(n.value)}function v(T,O){e.value.has(T)||e.value.set(T,[]),e.value.get(T).push(O),e.value=new Map(e.value)}function h(T,O,L){const R=e.value.get(T);if(R){const F=R.find(U=>U.id===O);F&&(Object.assign(F,L),e.value=new Map(e.value))}}function x(T,O){const L=S(O.name,O.input);t.value.set(L,O.id);const R={id:O.id,name:O.name,input:O.input,signature:L,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return v(T,R),console.log(`Created tool call ${R.id} for ${R.name}`),R}function g(T,O){console.log("handlePermissionRequest received:",O);const L=O.metadata?.tool_name||O.tool_name,R=O.metadata?.input_params||O.input_params,F=O.metadata?.request_id||O.request_id,U=O.metadata?.suggestions||O.suggestions||[];console.log("Extracted data:",{toolName:L,inputParams:R,requestId:F,suggestions:U});const ne=S(L,R),re=t.value.get(ne);re?(o.value.set(F,re),h(T,re,{status:"permission_required",permissionRequestId:F,suggestions:U}),console.log(`Permission required for tool ${re}`,{suggestions:U})):console.warn("No tool use ID found for permission request signature:",ne,{toolName:L,inputParams:R,availableSignatures:Array.from(t.value.keys())})}function b(T,O){const L=o.value.get(O.request_id);if(L){const R={permissionDecision:O.decision,appliedUpdates:O.applied_updates||[]};O.decision==="allow"?R.status="executing":(R.status="completed",R.result={error:!0,message:O.reasoning||"Permission denied"},R.isExpanded=!1),h(T,L,R),console.log(`Permission ${O.decision} for tool ${L}`)}}function y(T,O){const L=O.tool_use_id;h(T,L,{status:O.is_error?"error":"completed",result:{error:O.is_error,content:O.content},isExpanded:!1}),console.log(`Tool ${L} ${O.is_error?"failed":"completed"}`)}function M(T,O){const L=e.value.get(T);if(L){const R=L.find(F=>F.id===O);R&&(R.isExpanded=!R.isExpanded,e.value=new Map(e.value))}}function S(T,O){if(!T)return"unknown:{}";if(!O||typeof O!="object")return`${T}:{}`;const L=JSON.stringify(O,Object.keys(O).sort());return`${T}:${L}`}function w(T,O,L){const R=a.value.get(T)||new Map;R.set(O,{reason:"denied",message:L}),a.value.set(T,R);const F=e.value.get(T);if(F){const U=F.find(ne=>ne.id===O);U&&U.isExpanded&&(U.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${O} as orphaned: ${L}`)}function P(T,O){return a.value.get(T)?.has(O)||!1}function j(T,O){return a.value.get(T)?.get(O)}function A(T,O){const L=i.value.get(T);L&&L.size>0&&(L.forEach(R=>w(T,R,O)),L.clear())}function k(T){n.value.delete(T),e.value.delete(T),n.value=new Map(n.value),e.value=new Map(e.value)}function N(T){return r.value.get(T)}async function C(T){const O=r.value.get(T);if(!O)return console.log(`No sync needed for session ${T} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${T} since ${O}`);const L=await Z.get(`/api/sessions/${T}/messages?limit=1000&offset=0`),R=L.messages||[],F=L.has_more||!1,U=B=>B?typeof B=="number"?B*1e3:new Date(B).getTime():0,ne=U(O),re=R.filter(B=>B.timestamp?U(B.timestamp)>ne:!1);if(re.length===0)return console.log(`No missed messages for session ${T}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${re.length} missed messages for session ${T}`);const ue=n.value.get(T)||[],He=new Set(ue.map(B=>B.id).filter(Boolean)),fe=re.filter(B=>!B.id||!He.has(B.id));if(console.log(`After deduplication: ${fe.length} unique new messages`),fe.length>0){const B=fe.sort((X,J)=>{const de=U(X.timestamp),Ct=U(J.timestamp);return de-Ct}),oe=n.value.get(T)||[],H=oe.length>0?U(oe[oe.length-1].timestamp):0,W=U(B[0].timestamp),q=U(B[B.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:oe.length,lastExisting:H,lastExistingDate:oe.length>0?oe[oe.length-1].timestamp:"none",firstNew:W,firstNewDate:B[0].timestamp,lastNew:q,lastNewDate:B[B.length-1].timestamp,shouldAppend:W>H}),W>H){const X=[...oe,...B];n.value.set(T,X),console.log(`✅ Appended ${B.length} new messages (no full sort needed)`)}else{const X=[...oe,...B].sort((J,de)=>{const Ct=U(J.timestamp),Rt=U(de.timestamp);return Ct-Rt});n.value.set(T,X),console.log(`⚠️ Merged and sorted ${B.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${ue.length} messages unchanged`);fe.forEach(B=>{c(T,B),B.metadata?.has_tool_uses&&B.metadata.tool_uses&&B.metadata.tool_uses.forEach(oe=>{x(T,oe)}),B.metadata?.has_tool_results&&B.metadata.tool_results&&B.metadata.tool_results.forEach(oe=>{y(T,oe)}),(B.type==="permission_request"||B.metadata?.has_permission_requests)&&g(T,B),B.type==="system"&&(B.subtype==="init"||B.metadata?.subtype==="init")&&B.metadata?.init_data&&ee().storeInitData(T,B.metadata.init_data)});const Q=n.value.get(T);if(Q&&Q.length>0){const B=Q[Q.length-1];B.timestamp&&r.value.set(T,B.timestamp)}return n.value=new Map(n.value),{syncedCount:fe.length,hasMore:F}}catch(L){return console.error(`Failed to sync messages for session ${T}:`,L),{syncedCount:0,hasMore:!1,error:L.message}}}const E=ee();return le(()=>Array.from(E.sessions.values()).map(O=>({id:O.session_id,state:O.state})),(T,O)=>{O&&T.forEach((L,R)=>{const F=O[R];if(!F||F.id!==L.id)return;const U=["active","paused","starting"].includes(F.state),ne=!["active","paused","starting"].includes(L.state);U&&ne&&A(L.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:fn(i),orphanedToolUses:fn(a),currentMessages:u,currentToolCalls:l,loadMessages:p,addMessage:_,addToolCall:v,updateToolCall:h,handleToolUse:x,handlePermissionRequest:g,handlePermissionResponse:b,handleToolResult:y,toggleToolExpansion:M,clearMessages:k,markToolUseOrphaned:w,isToolUseOrphaned:P,getOrphanedInfo:j,clearOrphanedToolUses:A,getLastReceivedTimestamp:N,syncMessages:C}}),Bi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:De},Symbol.toStringTag,{value:"Module"}));function qi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function ss(n){return qi(n).toLocaleTimeString()}const zi={class:"message-row message-row-user"},Ki=["title"],Yi={class:"message-content-column"},Gi=["innerHTML"],Ji={key:0,class:"tool-results mt-2"},Xi={class:"tool-results-header text-muted small mb-2"},Qi={class:"d-flex align-items-start gap-2"},Zi={class:"flex-grow-1"},ea={class:"text-muted"},ta={key:0,class:"text-danger small"},sa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Mt.setOptions({breaks:!0,gfm:!0});const t=f(()=>ss(e.message.timestamp)),o=f(()=>`user
${t.value}`),i=f(()=>{const l=e.message.content||"";let p=Mt.parse(l);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Vs.sanitize(p)}),a=f(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=f(()=>e.message.metadata?.tool_results||[]);function u(l,p){return l?l.length<=p?l:l.substring(0,p)+"...":""}return(l,p)=>(d(),m("div",zi,[s("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,Ki),s("div",Yi,[s("div",{class:"message-text",innerHTML:i.value},null,8,Gi),a.value?(d(),m("div",Ji,[s("div",Xi,[p[1]||(p[1]=s("i",{class:"bi bi-tools"},null,-1)),G(" Tool Results ("+$(r.value.length)+") ",1)]),(d(!0),m(se,null,ae(r.value,(c,_)=>(d(),m("div",{key:_,class:K(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",Qi,[s("span",null,$(c.is_error?"❌":"✅"),1),s("div",Zi,[s("small",ea,"Tool: "+$(c.tool_use_id),1),c.is_error?(d(),m("div",ta,$(u(c.content,200)),1)):I("",!0)])])],2))),128))])):I("",!0)])]))}},na=Y(sa,[["__scopeId","data-v-09875214"]]),oa={class:"thinking-block"},ia={class:"text-muted ms-auto"},aa={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ra=["innerHTML"],la={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=D(!1),o=f(()=>e.thinking?.length||0),i=f(()=>{const r=e.thinking||"",u=Mt.parse(r);return Vs.sanitize(u)});function a(){t.value=!t.value}return(r,u)=>(d(),m("div",oa,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("i",{class:K(["bi",t.value?"bi-chevron-down":"bi-chevron-right"])},null,2),u[0]||(u[0]=s("span",{class:"thinking-label"},[s("i",{class:"bi bi-lightbulb"}),G(" Thinking ")],-1)),s("small",ia,$(o.value)+" characters",1)]),t.value?(d(),m("div",aa,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ra)])):I("",!0)]))}},ca=Y(la,[["__scopeId","data-v-619a8344"]]),Ye=gt("websocket",()=>{const n=D(null),e=D(!1),t=D(0),o=10,i=D(null),a=D(!1),r=D(0),u=5,l=D(null);let p=null;const c=D(0),_=D(null),v=D(new Map),h=D(null),x=D(!1),g=D(0),b=5,y=D(null),M=5e3,S=1e3,w=D(Date.now()),P=D(Date.now()),j=D(Date.now());let A=null,k=null,N=null;const C=f(()=>e.value&&(a.value||!l.value)?"connected":e.value?"partial":"disconnected");function E(H){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${H}`}function T(H){const W={ui:{timer:()=>A,setTimer:q=>{A=q},lastPing:w,connected:e,name:"UI"},session:{timer:()=>k,setTimer:q=>{k=q},lastPing:P,connected:a,name:"Session"},legion:{timer:()=>N,setTimer:q=>{N=q},lastPing:j,connected:x,name:"Legion"}}[H];W.timer()&&clearInterval(W.timer()),W.setTimer(setInterval(()=>{if(!W.connected.value)return;const q=Date.now()-W.lastPing.value;if(q>M){console.warn(`⚠️ ${W.name} WebSocket heartbeat timeout (${q}ms since last ping) - forcing close to trigger reconnection`),W.connected.value=!1;const J={ui:n,session:i,legion:h}[H];J.value&&J.value.readyState===WebSocket.OPEN&&J.value.close()}},S)),console.log(`✅ Started heartbeat monitor for ${W.name} WebSocket`)}function O(H){const W={ui:{get:()=>A,set:q=>{A=q}},session:{get:()=>k,set:q=>{k=q}},legion:{get:()=>N,set:q=>{N=q}}}[H];W.get()&&(clearInterval(W.get()),W.set(null),console.log(`🛑 Stopped heartbeat monitor for ${H} WebSocket`))}function L(){if(n.value)return;const H=E("/ws/ui");console.log(`Connecting to UI WebSocket: ${H}`),n.value=new WebSocket(H),n.value.onopen=()=>{e.value=!0,t.value=0,w.value=Date.now(),T("ui"),console.log("UI WebSocket connected")},n.value.onmessage=W=>{const q=JSON.parse(W.data);He(q)},n.value.onclose=()=>{if(O("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const W=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${W}ms (attempt ${t.value})`),setTimeout(L,W)}},n.value.onerror=W=>{console.error("UI WebSocket error:",W)}}function R(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function F(H){c.value++;const W=c.value;if(console.log(`[Gen ${W}] Starting connection to session ${H}`),p&&(clearTimeout(p),p=null),await U(),c.value!==W){console.log(`[Gen ${W}] Connection cancelled (current generation: ${c.value})`);return}l.value=H,_.value=W;const q=E(`/ws/session/${H}`);console.log(`[Gen ${W}] Connecting to Session WebSocket: ${q}`),i.value=new WebSocket(q),i.value.onopen=async()=>{if(_.value!==W){console.log(`[Gen ${W}] Ignoring onopen (stale connection, current: ${_.value})`),i.value.close();return}a.value=!0,r.value=0,P.value=Date.now(),T("session"),console.log(`[Gen ${W}] Session WebSocket connected for ${H}`);const X=v.value.get(H);if(v.value.set(H,!0),X){console.log(`[Gen ${W}] Reconnection detected, syncing missed messages...`);try{const de=await De().syncMessages(H);de.syncedCount>0?console.log(`[Gen ${W}] ✅ Synced ${de.syncedCount} missed messages`):de.error?console.warn(`[Gen ${W}] ⚠️ Message sync failed: ${de.error}`):console.log(`[Gen ${W}] No missed messages to sync`),de.hasMore&&console.warn(`[Gen ${W}] ⚠️ More than 1000 missed messages, showing recent 1000 only`)}catch(J){console.error(`[Gen ${W}] Error during message sync:`,J)}}else console.log(`[Gen ${W}] Initial connection, no sync needed`)},i.value.onmessage=X=>{if(_.value!==W){console.log(`[Gen ${W}] Ignoring message (stale connection, current: ${_.value})`);return}const J=JSON.parse(X.data);fe(J,H)},i.value.onclose=()=>{O("session"),a.value=!1,i.value=null,console.log(`[Gen ${W}] Session WebSocket closed for ${H}`);const X=ee();if(X.currentSessionId===H&&_.value===W&&r.value<u){r.value++;const J=Math.min(2e3*r.value,3e4);console.log(`[Gen ${W}] Reconnecting Session WebSocket in ${J}ms (attempt ${r.value})`),p=setTimeout(()=>{_.value===W&&X.currentSessionId===H?(p=null,F(H)):console.log(`[Gen ${W}] Skipping reconnect (generation or session changed)`)},J)}},i.value.onerror=X=>{console.error(`[Gen ${W}] Session WebSocket error:`,X)}}function U(){return new Promise(H=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),i.value){const W=l.value,q=()=>{i.value=null,a.value=!1,l.value=null,_.value=null,r.value=0,W&&v.value.delete(W),H()};if(i.value.readyState===WebSocket.CLOSED)q();else{const X=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),q()},2e3);i.value.addEventListener("close",()=>{clearTimeout(X),q()},{once:!0}),i.value.close()}}else l.value=null,_.value=null,H()})}function ne(H){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:H})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function re(H,W,q=!1,X=null){if(i.value&&a.value){const J={type:"permission_response",request_id:H,decision:W,apply_suggestions:q,timestamp:new Date().toISOString()};X&&(J.clarification_message=X),i.value.send(JSON.stringify(J)),console.log(`Sent permission ${W} for request ${H}`,{applySuggestions:q,clarification:X})}}function ue(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function He(H){const W=ee(),q=ve();switch(H.type){case"sessions_list":H.sessions&&Array.isArray(H.sessions)&&H.sessions.forEach(X=>{W.updateSession(X.session_id,X)});break;case"state_change":H.data&&H.data.session_id&&H.data.session&&W.updateSession(H.data.session_id,H.data.session);break;case"project_updated":if(H.data&&H.data.project){const X=H.data.project;q.updateProjectLocal(X.project_id,X)}break;case"project_deleted":H.data&&H.data.project_id&&q.projects.delete(H.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":w.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",H.type)}}function fe(H,W){const q=ee();if(q.currentSessionId!==W){console.warn(`Ignoring message for session ${W} (current: ${q.currentSessionId})`);return}const X=De();switch(H.type){case"message":const J=H.data;if(!J||!J.type){console.warn("Received message event with invalid data:",H);break}if(J.type==="permission_request"){X.handlePermissionRequest(W,J);break}if(J.type==="permission_response"){X.handlePermissionResponse(W,J);break}J.metadata?.has_tool_uses&&J.metadata.tool_uses.forEach(de=>{X.handleToolUse(W,de)}),J.metadata?.has_tool_results&&J.metadata.tool_results.forEach(de=>{X.handleToolResult(W,de)}),J.type==="system"&&(J.subtype==="init"||J.metadata?.subtype==="init")&&J.metadata?.init_data&&q.storeInitData(W,J.metadata.init_data),X.addMessage(W,J);break;case"permission_request":X.handlePermissionRequest(W,H);break;case"permission_response":X.handlePermissionResponse(W,H);break;case"tool_result":X.handleToolResult(W,H);break;case"state_change":q.updateSession(W,H.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${W}`);break;case"ping":P.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function Q(H){B(),y.value=H;const W=E(`/ws/legion/${H}`);console.log(`Connecting to Legion WebSocket: ${W}`),h.value=new WebSocket(W),h.value.onopen=()=>{x.value=!0,g.value=0,j.value=Date.now(),T("legion"),console.log(`Legion WebSocket connected for ${H}`)},h.value.onmessage=q=>{const X=JSON.parse(q.data);oe(X,H)},h.value.onclose=()=>{if(O("legion"),x.value=!1,h.value=null,console.log(`Legion WebSocket closed for ${H}`),y.value===H&&g.value<b){g.value++;const q=Math.min(2e3*g.value,3e4);setTimeout(()=>Q(H),q)}},h.value.onerror=q=>{console.error("Legion WebSocket error:",q)}}function B(){h.value&&(h.value.close(),h.value=null,x.value=!1,y.value=null)}function oe(H,W){$e(async()=>{const{useLegionStore:q}=await Promise.resolve().then(()=>_d);return{useLegionStore:q}},void 0).then(({useLegionStore:q})=>{const X=q();switch(H.type){case"comm":H.comm&&(X.addComm(W,H.comm),console.log("Legion WebSocket: Received new comm",H.comm));break;case"minion_created":H.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",H.data),$e(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>hn);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"minion_updated":H.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",H.data),$e(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>hn);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${W}`);break;case"ping":j.value=Date.now(),h.value?.readyState===WebSocket.OPEN&&h.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",H.type)}})}return{uiConnected:e,sessionConnected:a,legionConnected:x,overallStatus:C,connectUI:L,disconnectUI:R,connectSession:F,disconnectSession:U,sendMessage:ne,sendPermissionResponse:re,interruptSession:ue,connectLegion:Q,disconnectLegion:B}}),ua=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Ye},Symbol.toStringTag,{value:"Module"})),da={class:"base-tool-handler"},ma={class:"tool-section"},pa={class:"tool-parameters"},fa={class:"tool-code"},va={key:0,class:"tool-section"},ha={class:"tool-section-label"},_a={class:"tool-code"},ga={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=f(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,u)=>(d(),m("div",da,[s("div",ma,[u[0]||(u[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",pa,[s("pre",fa,$(t.value),1)])]),o.value?(d(),m("div",va,[s("div",ha,$(i.value?"Error:":"Result:"),1),s("div",{class:K(["tool-result",{"tool-result-error":i.value}])},[s("pre",_a,$(a.value),1)],2)])):I("",!0)]))}},ba=Y(ga,[["__scopeId","data-v-1e69f57d"]]),ya={class:"read-tool-handler"},$a={class:"tool-section"},wa={class:"read-file-info"},Ea={class:"file-path"},Ca={key:0,class:"read-range"},Sa={key:0,class:"tool-section"},Ta={key:0,class:"tool-result tool-result-error"},ka={class:"tool-code"},xa={key:1,class:"file-content-preview"},Aa={class:"content-header"},Ma={class:"line-count-badge"},Oa={key:0,class:"preview-note"},Na={class:"tool-code content-display"},Da={key:0,class:"more-indicator"},ps=100,La={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.file_path||"Unknown"),o=f(()=>{const h=e.toolCall.input?.offset,x=e.toolCall.input?.limit;return h!==void 0||x!==void 0}),i=f(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),a=f(()=>{const h=e.toolCall.input?.offset||0,x=e.toolCall.input?.limit;return x!==void 0?h+x:"∞"}),r=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=f(()=>{if(!r.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),p=f(()=>u.value||!l.value?[]:l.value.split(`
`)),c=f(()=>p.value.length),_=f(()=>c.value>ps),v=f(()=>u.value?"":p.value.slice(0,ps).join(`
`));return(h,x)=>(d(),m("div",ya,[s("div",$a,[s("div",wa,[x[0]||(x[0]=s("span",{class:"file-icon"},"📄",-1)),x[1]||(x[1]=s("strong",null,"Reading:",-1)),s("code",Ea,$(t.value),1),o.value?(d(),m("span",Ca,"Lines "+$(i.value)+"-"+$(a.value),1)):I("",!0)])]),r.value?(d(),m("div",Sa,[u.value?(d(),m("div",Ta,[s("pre",ka,$(l.value),1)])):(d(),m("div",xa,[s("div",Aa,[x[2]||(x[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Ma,$(c.value)+" lines",1),_.value?(d(),m("span",Oa,"(showing first "+$(ps)+")")):I("",!0)]),s("pre",Na,$(v.value),1),_.value?(d(),m("div",Da,"...")):I("",!0)]))])):I("",!0)]))}},Ia=Y(La,[["__scopeId","data-v-1f2b0569"]]),Pa={class:"write-tool-handler"},ja={class:"tool-section"},Ra={class:"write-file-info mb-2"},Va={class:"file-path"},Ha={class:"write-content-preview"},Wa={class:"content-header"},Fa={class:"line-count-badge"},Ua={key:0,class:"preview-note"},Ba={class:"tool-code content-display"},qa={key:0,class:"more-indicator"},za={key:0,class:"tool-section"},Ka={key:0,class:"tool-result tool-result-error"},Ya={class:"tool-code"},Ga={key:1,class:"tool-result tool-result-success"},Ja={class:"success-message"},fs=100,Xa={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.file_path||"Unknown"),o=f(()=>e.toolCall.input?.content||""),i=f(()=>o.value.split(`
`)),a=f(()=>i.value.length),r=f(()=>a.value>fs),u=f(()=>i.value.slice(0,fs).join(`
`)),l=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=f(()=>{if(!l.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,v)=>(d(),m("div",Pa,[s("div",ja,[s("div",Ra,[v[0]||(v[0]=s("span",{class:"file-icon"},"📝",-1)),v[1]||(v[1]=s("strong",null,"Writing:",-1)),s("code",Va,$(t.value),1)]),s("div",Ha,[s("div",Wa,[v[2]||(v[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",Fa,$(a.value)+" lines",1),r.value?(d(),m("span",Ua,"(showing first "+$(fs)+")")):I("",!0)]),s("pre",Ba,$(u.value),1),r.value?(d(),m("div",qa,"...")):I("",!0)])]),l.value?(d(),m("div",za,[p.value?(d(),m("div",Ka,[v[3]||(v[3]=s("strong",null,"Error:",-1)),s("pre",Ya,$(c.value),1)])):(d(),m("div",Ga,[s("div",Ja,[v[4]||(v[4]=s("span",{class:"success-icon"},"✅",-1)),s("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):I("",!0)]))}},Qa=Y(Xa,[["__scopeId","data-v-ddc24a0f"]]),Za={class:"bash-tool-handler"},er={class:"tool-section"},tr={class:"bash-header"},sr={class:"bash-header-content"},nr={key:0,class:"bash-description"},or={key:1,class:"bash-flags"},ir={class:"bash-command-section"},ar={class:"bash-command-content"},rr={key:0,class:"tool-section"},lr={key:0,class:"bash-output"},cr={key:1,class:"bash-output-empty"},ur={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.command||""),o=f(()=>e.toolCall.input?.description||""),i=f(()=>e.toolCall.input?.timeout),a=f(()=>e.toolCall.input?.run_in_background||!1),r=f(()=>i.value||a.value),u=f(()=>{const v=[];return i.value&&v.push(`timeout: ${i.value}ms`),a.value&&v.push("background"),v.join(", ")}),l=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=f(()=>p.value?"tool-result-error":"tool-result-success"),_=f(()=>{if(!l.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,h)=>(d(),m("div",Za,[s("div",er,[s("div",tr,[h[1]||(h[1]=s("span",{class:"bash-icon"},"💻",-1)),s("div",sr,[o.value?(d(),m("div",nr,[h[0]||(h[0]=s("strong",null,"Description:",-1)),G(" "+$(o.value),1)])):I("",!0),r.value?(d(),m("div",or,$(u.value),1)):I("",!0)])]),s("div",ir,[h[2]||(h[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",ar,$(t.value),1)])]),l.value?(d(),m("div",rr,[s("div",{class:K(["tool-result",c.value])},[h[3]||(h[3]=s("strong",null,"Output:",-1)),_.value?(d(),m("pre",lr,$(_.value),1)):(d(),m("div",cr,"No output"))],2)])):I("",!0)]))}},dr=Y(ur,[["__scopeId","data-v-ab50fe73"]]),mr={class:"todo-tool-handler"},pr={class:"tool-section"},fr={class:"todo-header"},vr={class:"todo-summary"},hr={key:0,class:"todo-count todo-count-completed"},_r={key:1,class:"todo-count todo-count-in-progress"},gr={key:2,class:"todo-count todo-count-pending"},br={class:"todo-checklist"},yr={class:"todo-checkbox"},$r={class:"todo-content"},wr={key:0,class:"tool-section"},Er={key:0,class:"tool-result tool-result-error"},Cr={class:"tool-code"},Sr={key:1,class:"tool-result tool-result-success"},Tr={class:"success-message"},kr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.todos||[]),o=f(()=>t.value.filter(c=>c.status==="completed").length),i=f(()=>t.value.filter(c=>c.status==="in_progress").length),a=f(()=>t.value.filter(c=>c.status==="pending").length);function r(c){return{pending:"☐",in_progress:"◐",completed:"☑"}[c]||"☐"}const u=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=f(()=>{if(!u.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,_)=>(d(),m("div",mr,[s("div",pr,[s("div",fr,[_[0]||(_[0]=s("span",{class:"todo-icon"},"📋",-1)),_[1]||(_[1]=s("strong",null,"Task List:",-1)),s("div",vr,[o.value>0?(d(),m("span",hr,$(o.value)+" completed ",1)):I("",!0),i.value>0?(d(),m("span",_r,$(i.value)+" in progress ",1)):I("",!0),a.value>0?(d(),m("span",gr,$(a.value)+" pending ",1)):I("",!0)])]),s("div",br,[(d(!0),m(se,null,ae(t.value,(v,h)=>(d(),m("div",{key:h,class:K(["todo-item",`todo-${v.status}`])},[s("span",yr,$(r(v.status)),1),s("span",$r,$(v.content),1)],2))),128))])]),u.value?(d(),m("div",wr,[l.value?(d(),m("div",Er,[_[2]||(_[2]=s("strong",null,"Error:",-1)),s("pre",Cr,$(p.value),1)])):(d(),m("div",Sr,[s("div",Tr,[_[3]||(_[3]=s("span",{class:"success-icon"},"✅",-1)),s("strong",null,"Task list updated ("+$(t.value.length)+" tasks)",1)])]))])):I("",!0)]))}},xr=Y(kr,[["__scopeId","data-v-bbe55ee7"]]),Ar={class:"edit-tool-handler"},Mr={class:"tool-section"},Or={class:"edit-file-info"},Nr={class:"file-path"},Dr={key:0,class:"replace-all-badge"},Lr={class:"edit-diff-container"},Ir={class:"diff-header"},Pr={class:"diff-stats"},jr={class:"stat-removed"},Rr={class:"stat-added"},Vr={class:"unified-diff"},Hr={class:"diff-scroll-container"},Wr={class:"diff-marker"},Fr={class:"diff-content"},Ur={key:0,class:"tool-section"},Br={key:0,class:"tool-result tool-result-error"},qr={class:"tool-code"},zr={key:1,class:"tool-result tool-result-success"},Kr={class:"success-message"},Yr={key:0,class:"success-detail"},Gr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.file_path||"Unknown"),o=f(()=>e.toolCall.input?.old_string||""),i=f(()=>e.toolCall.input?.new_string||""),a=f(()=>e.toolCall.input?.replace_all||!1),r=f(()=>{const h=hi(t.value,o.value,i.value,"","",{context:3}).split(`
`),x=[];for(let g=4;g<h.length;g++){const b=h[g];b&&(b.startsWith("-")?x.push({type:"removed",content:b.substring(1)}):b.startsWith("+")?x.push({type:"added",content:b.substring(1)}):b.startsWith(" ")?x.push({type:"context",content:b.substring(1)}):b.startsWith("@@")&&x.push({type:"hunk",content:b}))}return x}),u=f(()=>r.value.filter(v=>v.type==="removed").length),l=f(()=>r.value.filter(v=>v.type==="added").length),p=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=f(()=>{if(!p.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,h)=>(d(),m("div",Ar,[s("div",Mr,[s("div",Or,[h[0]||(h[0]=s("span",{class:"file-icon"},"✏️",-1)),h[1]||(h[1]=s("strong",null,"Editing:",-1)),s("code",Nr,$(t.value),1),a.value?(d(),m("span",Dr,"Replace All")):I("",!0)]),s("div",Lr,[s("div",Ir,[h[2]||(h[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Pr,[s("span",jr,"-"+$(u.value),1),s("span",Rr,"+"+$(l.value),1)])]),s("div",Vr,[s("div",Hr,[(d(!0),m(se,null,ae(r.value,(x,g)=>(d(),m("div",{key:g,class:K(["diff-line",{"diff-line-removed":x.type==="removed","diff-line-added":x.type==="added","diff-line-context":x.type==="context","diff-line-hunk":x.type==="hunk"}])},[s("span",Wr,$(x.type==="removed"?"-":x.type==="added"?"+":x.type==="hunk"?"@":" "),1),s("span",Fr,$(x.content),1)],2))),128))])])])]),p.value?(d(),m("div",Ur,[c.value?(d(),m("div",Br,[h[3]||(h[3]=s("strong",null,"Error:",-1)),s("pre",qr,$(_.value),1)])):(d(),m("div",zr,[s("div",Kr,[h[4]||(h[4]=s("span",{class:"success-icon"},"✅",-1)),h[5]||(h[5]=s("strong",null,"File edited successfully",-1)),a.value?(d(),m("span",Yr,"(all occurrences replaced)")):I("",!0)])]))])):I("",!0)]))}},Jr=Y(Gr,[["__scopeId","data-v-16b90adc"]]),Xr={class:"search-tool-handler"},Qr={class:"tool-section"},Zr={class:"search-info"},el={class:"search-icon"},tl={class:"search-pattern"},sl={key:0,class:"search-path"},nl={key:1,class:"search-filters"},ol={key:0,class:"filter-badge"},il={key:1,class:"filter-badge"},al={key:2,class:"filter-badge"},rl={key:0,class:"tool-section"},ll={key:0,class:"tool-result tool-result-error"},cl={class:"tool-code"},ul={key:1,class:"search-results"},dl={class:"results-header"},ml={class:"results-label"},pl={class:"results-count-badge"},fl={class:"results-content"},vl={class:"tool-code"},hl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.name==="Grep");f(()=>e.toolCall.name==="Glob");const o=f(()=>e.toolCall.input?.pattern||"Unknown"),i=f(()=>e.toolCall.input?.path||null),a=f(()=>e.toolCall.input?.type||null),r=f(()=>e.toolCall.input?.glob||null),u=f(()=>e.toolCall.input?.["-i"]||!1),l=f(()=>a.value||r.value||u.value),p=f(()=>t.value?"🔍":"📁"),c=f(()=>t.value?"Searching content":"Finding files"),_=f(()=>t.value?"Matches":"Files found"),v=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),h=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),x=f(()=>{if(!v.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)}),g=f(()=>!v.value||h.value||!x.value?0:x.value.split(`
`).filter(y=>y.trim()).length);return(b,y)=>(d(),m("div",Xr,[s("div",Qr,[s("div",Zr,[s("span",el,$(p.value),1),s("strong",null,$(c.value)+":",1),s("code",tl,$(o.value),1),i.value?(d(),m("span",sl,"in "+$(i.value),1)):I("",!0),l.value?(d(),m("span",nl,[a.value?(d(),m("span",ol,"type: "+$(a.value),1)):I("",!0),r.value?(d(),m("span",il,"glob: "+$(r.value),1)):I("",!0),u.value?(d(),m("span",al,"case-insensitive")):I("",!0)])):I("",!0)])]),v.value?(d(),m("div",rl,[h.value?(d(),m("div",ll,[y[0]||(y[0]=s("strong",null,"Error:",-1)),s("pre",cl,$(x.value),1)])):(d(),m("div",ul,[s("div",dl,[s("span",ml,$(_.value)+":",1),s("span",pl,$(g.value)+" "+$(g.value===1?"match":"matches"),1)]),s("div",fl,[s("pre",vl,$(x.value),1)])]))])):I("",!0)]))}},_n=Y(hl,[["__scopeId","data-v-0d272c39"]]),_l={class:"web-tool-handler"},gl={class:"tool-section"},bl={class:"web-info"},yl={class:"web-icon"},$l=["href"],wl={key:1,class:"web-query"},El={key:0,class:"web-prompt-container"},Cl={class:"prompt-content"},Sl={key:1,class:"web-domains"},Tl={class:"domains-label"},kl={key:0,class:"tool-section"},xl={key:0,class:"tool-result tool-result-error"},Al={class:"tool-code"},Ml={key:1,class:"web-results"},Ol={class:"results-header"},Nl={class:"results-label"},Dl={class:"results-content"},Ll={class:"tool-code"},Il={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.name==="WebFetch");f(()=>e.toolCall.name==="WebSearch");const o=f(()=>e.toolCall.input?.url||null),i=f(()=>e.toolCall.input?.query||null),a=f(()=>e.toolCall.input?.prompt||null),r=f(()=>e.toolCall.input?.allowed_domains||[]),u=f(()=>e.toolCall.input?.blocked_domains||[]),l=f(()=>r.value.length>0?r.value:u.value.length>0?u.value:[]),p=f(()=>r.value.length>0?"Allowed domains":u.value.length>0?"Blocked domains":"Domains"),c=f(()=>t.value?"🌐":"🔎"),_=f(()=>t.value?"Fetching URL":"Searching web"),v=f(()=>t.value?"Fetched content":"Search results"),h=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),x=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=f(()=>{if(!h.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,y)=>(d(),m("div",_l,[s("div",gl,[s("div",bl,[s("span",yl,$(c.value),1),s("strong",null,$(_.value)+":",1),o.value?(d(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},$(o.value),9,$l)):i.value?(d(),m("code",wl,$(i.value),1)):I("",!0)]),a.value?(d(),m("div",El,[y[0]||(y[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Cl,$(a.value),1)])):I("",!0),l.value.length>0?(d(),m("div",Sl,[s("span",Tl,$(p.value)+":",1),(d(!0),m(se,null,ae(l.value,M=>(d(),m("span",{key:M,class:"domain-badge"},$(M),1))),128))])):I("",!0)]),h.value?(d(),m("div",kl,[x.value?(d(),m("div",xl,[y[1]||(y[1]=s("strong",null,"Error:",-1)),s("pre",Al,$(g.value),1)])):(d(),m("div",Ml,[s("div",Ol,[s("span",Nl,$(v.value)+":",1)]),s("div",Dl,[s("pre",Ll,$(g.value),1)])]))])):I("",!0)]))}},gn=Y(Il,[["__scopeId","data-v-62b55b55"]]),Pl={class:"task-tool-handler"},jl={class:"tool-section"},Rl={class:"task-header"},Vl={key:0,class:"agent-type-badge"},Hl={key:0,class:"task-description"},Wl={class:"description-content"},Fl={key:1,class:"task-prompt-container"},Ul={class:"prompt-header"},Bl={class:"prompt-length"},ql={class:"prompt-code"},zl={key:0,class:"tool-section"},Kl={key:0,class:"tool-result tool-result-error"},Yl={class:"tool-code"},Gl={key:1,class:"agent-output"},Jl={class:"output-header"},Xl={key:0,class:"output-count-badge"},Ql={class:"output-content"},Zl={class:"tool-code"},ec={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.description||null),o=f(()=>e.toolCall.input?.prompt||null),i=f(()=>e.toolCall.input?.subagent_type||null),a=f(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=f(()=>{if(!a.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),l=f(()=>u.value?u.value.split(`
`).length:0);return(p,c)=>(d(),m("div",Pl,[s("div",jl,[s("div",Rl,[c[0]||(c[0]=s("span",{class:"task-icon"},"🤖",-1)),c[1]||(c[1]=s("strong",null,"Agent Task:",-1)),i.value?(d(),m("span",Vl,$(i.value),1)):I("",!0)]),t.value?(d(),m("div",Hl,[c[2]||(c[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",Wl,$(t.value),1)])):I("",!0),o.value?(d(),m("div",Fl,[s("div",Ul,[c[3]||(c[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",Bl,$(o.value.length)+" characters",1)]),s("pre",ql,$(o.value),1)])):I("",!0)]),a.value?(d(),m("div",zl,[r.value?(d(),m("div",Kl,[c[4]||(c[4]=s("strong",null,"Error:",-1)),s("pre",Yl,$(u.value),1)])):(d(),m("div",Gl,[s("div",Jl,[c[5]||(c[5]=s("span",{class:"output-label"},"Agent Output:",-1)),l.value>0?(d(),m("span",Xl,$(l.value)+" lines",1)):I("",!0)]),s("div",Ql,[s("pre",Zl,$(u.value),1)])]))])):I("",!0)]))}},tc=Y(ec,[["__scopeId","data-v-c520c244"]]),sc={class:"notebook-edit-tool-handler"},nc={class:"tool-section"},oc={class:"notebook-info"},ic={class:"file-path"},ac={class:"cell-info mt-2"},rc={class:"info-row"},lc={class:"info-row"},cc={key:0,class:"info-row"},uc={class:"badge bg-info"},dc={key:0,class:"source-preview mt-3"},mc={class:"preview-header"},pc={class:"preview-stats"},fc={class:"source-code"},vc={key:0,class:"tool-section"},hc={key:0},_c={key:1,class:"text-danger"},gc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.notebook_path||"Unknown"),o=f(()=>e.toolCall.input?.cell_id),i=f(()=>e.toolCall.input?.cell_type||"code"),a=f(()=>e.toolCall.input?.edit_mode||"replace"),r=f(()=>e.toolCall.input?.new_source||""),u=f(()=>r.value.split(`
`).length),l=f(()=>i.value==="code"?"bg-primary":"bg-secondary"),p=f(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=f(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const _=a.value;return _==="insert"?"Cell inserted successfully":_==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(_,v)=>(d(),m("div",sc,[s("div",nc,[s("div",oc,[v[0]||(v[0]=s("span",{class:"notebook-icon"},"📓",-1)),v[1]||(v[1]=s("strong",null,"Notebook:",-1)),s("code",ic,$(t.value),1)]),s("div",ac,[s("div",rc,[v[2]||(v[2]=s("strong",null,"Cell ID:",-1)),s("code",null,$(o.value||"N/A"),1)]),s("div",lc,[v[3]||(v[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:K(["badge",l.value])},$(i.value),3)]),a.value?(d(),m("div",cc,[v[4]||(v[4]=s("strong",null,"Edit Mode:",-1)),s("span",uc,$(a.value),1)])):I("",!0)]),r.value?(d(),m("div",dc,[s("div",mc,[v[5]||(v[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",pc,$(u.value)+" lines",1)]),s("pre",fc,[s("code",null,$(r.value),1)])])):I("",!0)]),n.toolCall.result?(d(),m("div",vc,[v[8]||(v[8]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:K(["tool-result",p.value])},[n.toolCall.result.success!==!1?(d(),m("div",hc,[v[6]||(v[6]=s("i",{class:"bi bi-check-circle"},null,-1)),G(" "+$(c.value),1)])):(d(),m("div",_c,[v[7]||(v[7]=s("i",{class:"bi bi-x-circle"},null,-1)),G(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)])):I("",!0)]))}},bc=Y(gc,[["__scopeId","data-v-bf9ef8f9"]]),yc={class:"shell-tool-handler"},$c={class:"tool-section"},wc={class:"shell-info"},Ec={class:"shell-icon"},Cc={key:0,class:"shell-id"},Sc={key:0,class:"filter-info mt-2"},Tc={class:"filter-pattern"},kc={key:0,class:"tool-section"},xc={class:"result-header mb-2"},Ac={key:0,class:"shell-output"},Mc={key:0},Oc={key:1,class:"text-danger"},Nc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.name==="BashOutput"?"📤":e.toolCall.name==="KillShell"?"🛑":"🐚"),o=f(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=f(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=f(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=f(()=>e.toolCall.input?.filter),u=f(()=>e.toolCall.name==="BashOutput"?e.toolCall.result?.output||e.toolCall.result?.stdout:null),l=f(()=>e.toolCall.result?.status),p=f(()=>{const v=l.value;return v==="running"?"bg-success":v==="completed"?"bg-secondary":v==="killed"||v==="terminated"?"bg-danger":"bg-info"}),c=f(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),_=f(()=>e.toolCall.result?.message?e.toolCall.result.message:e.toolCall.name==="KillShell"?"Shell terminated successfully":"Operation completed");return(v,h)=>(d(),m("div",yc,[s("div",$c,[s("div",wc,[s("span",Ec,$(t.value),1),s("strong",null,$(o.value)+":",1),a.value?(d(),m("code",Cc,"Shell "+$(a.value),1)):I("",!0)]),n.toolCall.name==="BashOutput"&&r.value?(d(),m("div",Sc,[h[0]||(h[0]=s("strong",null,"Filter:",-1)),s("code",Tc,$(r.value),1)])):I("",!0)]),n.toolCall.result?(d(),m("div",kc,[s("div",xc,[s("strong",null,$(i.value)+":",1),l.value?(d(),m("span",{key:0,class:K(["badge",p.value])},$(l.value),3)):I("",!0)]),u.value?(d(),m("div",Ac,[s("pre",null,[s("code",null,$(u.value),1)])])):(d(),m("div",{key:1,class:K(["tool-result",c.value])},[n.toolCall.result.success!==!1?(d(),m("div",Mc,[h[1]||(h[1]=s("i",{class:"bi bi-check-circle"},null,-1)),G(" "+$(_.value),1)])):(d(),m("div",Oc,[h[2]||(h[2]=s("i",{class:"bi bi-x-circle"},null,-1)),G(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2))])):I("",!0)]))}},bn=Y(Nc,[["__scopeId","data-v-1a461f4c"]]),Dc={class:"skill-tool-handler"},Lc={key:0,class:"tool-section"},Ic={class:"d-flex align-items-center gap-2"},Pc={class:"text-muted small"},jc={key:0,class:"skill-content-body"},Rc={class:"skill-content-text"},Vc={key:1,class:"tool-section mt-3"},Hc={class:"tool-result tool-result-error"},Wc={class:"tool-code"},Fc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=De(),o=ee(),i=D(!1);function a(){i.value=!i.value}f(()=>e.toolCall.input?.command||"Unknown Skill"),f(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),f(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=f(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const h=t.messagesBySession.get(v)||[],x=h.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(x===-1)return{running:null,content:null};let g=null,b=null;for(let y=x+1;y<Math.min(x+3,h.length);y++){const M=h[y];if(M.type!=="user")continue;const S=M.content||"";S.includes("<command-message>")&&S.includes("skill is running")?g=M:S.startsWith("Base directory for this skill:")&&(b=M)}return{running:g,content:b}});f(()=>{const v=r.value.content;if(!v)return null;const x=(v.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return x&&x[1]?x[1].trim():null});const u=f(()=>{const v=r.value.content;if(!v)return"";const h=v.content||"",x=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return h.replace(x,"").trim()}),l=f(()=>u.value.length>0),p=f(()=>u.value?u.value.split(`
`).length:0),c=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=f(()=>{if(!c.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,h)=>(d(),m("div",Dc,[l.value?(d(),m("div",Lc,[s("div",{class:"skill-content-header",onClick:a},[s("div",Ic,[s("i",{class:K(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),h[0]||(h[0]=s("strong",null,"Skill Content",-1)),s("span",Pc,"("+$(p.value)+" lines)",1)])]),i.value?(d(),m("div",jc,[s("pre",Rc,$(u.value),1)])):I("",!0)])):I("",!0),c.value?(d(),m("div",Vc,[h[1]||(h[1]=s("div",{class:"tool-section-label text-danger"},[s("i",{class:"bi bi-x-circle"}),G(" Error: ")],-1)),s("div",Hc,[s("pre",Wc,$(_.value),1)])])):I("",!0)]))}},Uc=Y(Fc,[["__scopeId","data-v-ba9a91da"]]),Bc={class:"slashcommand-tool-handler"},qc={key:0,class:"tool-section"},zc={class:"d-flex align-items-center gap-2"},Kc={class:"text-muted small"},Yc={key:0,class:"command-content-body"},Gc={class:"command-content-text"},Jc={key:1,class:"tool-section mt-3"},Xc={class:"tool-result tool-result-error"},Qc={class:"tool-code"},Zc={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=De(),o=ee(),i=D(!1);function a(){i.value=!i.value}f(()=>e.toolCall.input?.command||"Unknown Command"),f(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),f(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=f(()=>{const v=o.currentSessionId;if(!v)return{running:null,content:null};const h=t.messagesBySession.get(v)||[],x=h.findIndex(y=>y.type==="user"&&y.metadata?.has_tool_results&&y.metadata?.tool_results?.some(M=>M.tool_use_id===e.toolCall.id));if(x===-1)return{running:null,content:null};let g=null,b=null;for(let y=x+1;y<Math.min(x+3,h.length);y++){const M=h[y];if(M.type!=="user")continue;const S=M.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?g=M:S.includes("ARGUMENTS:")&&(b=M)}return{running:g,content:b}});f(()=>{const v=r.value.running;if(!v)return null;const x=(v.content||"").match(/<command-args>(.+?)<\/command-args>/s);return x&&x[1]?x[1].trim():null});const u=f(()=>{const v=r.value.content;if(!v)return"";const h=v.content||"",x=/\nARGUMENTS:.*$/s;return h.replace(x,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),l=f(()=>u.value.length>0),p=f(()=>u.value?u.value.split(`
`).length:0),c=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=f(()=>{if(!c.value)return"";const v=e.toolCall.result;return v?.message?v.message:v?.error?v.error:"An error occurred"});return(v,h)=>(d(),m("div",Bc,[l.value?(d(),m("div",qc,[s("div",{class:"command-content-header",onClick:a},[s("div",zc,[s("i",{class:K(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),h[0]||(h[0]=s("strong",null,"Command Content",-1)),s("span",Kc,"("+$(p.value)+" lines)",1)])]),i.value?(d(),m("div",Yc,[s("pre",Gc,$(u.value),1)])):I("",!0)])):I("",!0),c.value?(d(),m("div",Jc,[h[1]||(h[1]=s("div",{class:"tool-section-label text-danger"},[s("i",{class:"bi bi-x-circle"}),G(" Error: ")],-1)),s("div",Xc,[s("pre",Qc,$(_.value),1)])])):I("",!0)]))}},eu=Y(Zc,[["__scopeId","data-v-17d3444e"]]),tu={class:"exit-plan-mode-tool-handler"},su={class:"tool-section"},nu={key:0,class:"plan-content mt-2"},ou={class:"plan-text"},iu={key:0,class:"tool-section"},au={key:0},ru={key:1,class:"text-danger"},lu={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>e.toolCall.input?.plan),o=f(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(d(),m("div",tu,[s("div",su,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"📋"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(d(),m("div",nu,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",ou,$(t.value),1)])):I("",!0)]),n.toolCall.result?(d(),m("div",iu,[a[4]||(a[4]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:K(["tool-result",o.value])},[n.toolCall.result.success!==!1?(d(),m("div",au,[...a[2]||(a[2]=[s("i",{class:"bi bi-check-circle"},null,-1),G(" Permission mode reverted to default ",-1)])])):(d(),m("div",ru,[a[3]||(a[3]=s("i",{class:"bi bi-x-circle"},null,-1)),G(" "+$(n.toolCall.result.error||"Failed to exit plan mode"),1)]))],2)])):I("",!0)]))}},cu=Y(lu,[["__scopeId","data-v-bd35183e"]]),uu={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},du={class:"tool-status-icon"},mu=["title"],pu={class:"d-flex align-items-center gap-2"},fu={class:"text-muted"},vu={key:0,class:"card-body"},hu={key:0,class:"alert alert-warning mb-3"},_u={class:"d-flex align-items-center"},gu={class:"mb-0 small"},bu={key:1,class:"permission-prompt mt-3"},yu={class:"alert alert-warning mb-3"},$u={class:"mb-0"},wu={class:"tool-name"},Eu={key:0,class:"suggestions-section mb-3"},Cu={class:"alert alert-info mb-0"},Su={class:"suggestion-details p-2 bg-white rounded"},Tu={class:"permission-buttons d-flex gap-2 mb-3"},ku=["disabled"],xu=["disabled"],Au=["disabled"],Mu={class:"guidance-section mt-3"},Ou=["disabled"],Nu=["disabled"],Du={key:2,class:"mt-3"},Lu={class:"alert alert-warning mb-0"},Iu={class:"d-flex align-items-center"},Pu={class:"mb-0 small"},ju={key:3,class:"tool-section"},Ru={class:"alert alert-danger mb-0"},Vu={key:0},Hu={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=De(),o=ee(),i=Ye(),a=D(!1),r=D(null),u=D(""),l=f(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),p=f(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c={Read:Ia,Write:Qa,Bash:dr,TodoWrite:xr,Edit:Jr,Grep:_n,Glob:_n,WebFetch:gn,WebSearch:gn,Task:tc,NotebookEdit:bc,BashOutput:bn,KillShell:bn,SlashCommand:eu,Skill:Uc,ExitPlanMode:cu},_=f(()=>{const C=e.toolCall.name;return c[C]?c[C]:ba}),v=f(()=>{const C=[];switch(e.toolCall.status){case"pending":C.push("border-secondary");break;case"permission_required":C.push("border-warning");break;case"executing":C.push("border-primary");break;case"completed":g.value||e.toolCall.permissionDecision==="deny"?C.push("border-danger"):C.push("border-success");break;case"error":C.push("border-danger");break}return C.join(" ")}),h=f(()=>{switch(e.toolCall.status){case"pending":return"🔄";case"permission_required":return"❓";case"executing":return"⚡";case"completed":return e.toolCall.permissionDecision==="deny"?"❌":g.value?"💥":"✅";case"error":return"💥";default:return"🔧"}}),x=f(()=>ss(e.toolCall.timestamp)),g=f(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=f(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function y(C){if(!C)return"";const E=C.replace(/\\/g,"/").split("/");return E[E.length-1]}function M(C,E=200){return C?C.length<=E?C:C.substring(0,E)+"...":""}function S(C){if(!C)return null;if(C.content){const E=C.content.match(/exit code (\d+)/i);if(E)return parseInt(E[1])}return C.error?1:0}function w(C,E){const T=C?C.split(`
`).length:0;return{added:E?E.split(`
`).length:0,removed:T}}const P=f(()=>{const C=e.toolCall.name,E=e.toolCall.input||{},T=e.toolCall.result,O=e.toolCall.status;switch(C){case"Bash":case"Shell":case"Command":{const L=M(E.command,200);if(O==="completed"&&T){const R=S(T);return`Bash: ${L} (exit ${R})`}return`Bash: ${L}`}case"SlashCommand":{const L=M(E.command,200);return O==="completed"&&T?`SlashCommand: ${L}`:`SlashCommand: ${L}`}case"Edit":{const L=y(E.file_path);if(O==="completed"&&T&&!T.error){const{added:R,removed:F}=w(E.old_string,E.new_string);return R===F?`Edit: ${L} (${R} lines changed)`:`Edit: ${L} (${R} lines added, ${F} removed)`}return`Edit: ${L}`}case"Read":{const L=y(E.file_path);if(E.offset!==void 0||E.limit!==void 0){const F=(E.offset||0)+1,U=E.limit?(E.offset||0)+E.limit:"∞";return`Read: ${L} (lines ${F}-${U})`}return`Read: ${L} (full file)`}case"Write":{const L=y(E.file_path);if(O==="completed"&&T&&!T.error&&E.content){const R=E.content.split(`
`).length;return`Write: ${L} (${R} lines written)`}return`Write: ${L}`}case"Skill":{const L=E.command||"Unknown";return O==="completed"&&T?T.error?`Skill: ${L} (error)`:`Skill: ${L} (completed)`:`Skill: ${L}`}case"Task":{const L=E.subagent_type||"general",R=E.description||"Task";return O==="completed"&&T?T.error?`Task: (${L}) ${R} (error)`:`Task: (${L}) ${R} (completed)`:`Task: (${L}) ${R}`}case"TodoWrite":{if(E.todos&&Array.isArray(E.todos)){const L=E.todos.filter(U=>U.status==="completed").length,R=E.todos.length,F=E.todos.find(U=>U.status==="in_progress");return F?`Todo: Working on "${F.content}"`:`Todo: ${L}/${R} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const L=E.pattern||"",R=C==="Grep"?"Grep":"Glob";if(O==="completed"&&T&&!T.error){let F=0;return T.content&&(F=T.content.split(`
`).filter(ne=>ne.trim()).length),`${R}: "${L}" (${F} results)`}return`${R}: "${L}"`}case"WebFetch":case"WebSearch":{const L=E.url||E.query||"";let R="";try{L&&(R=new URL(L.startsWith("http")?L:`https://${L}`).hostname)}catch{R=L.length>50?L.substring(0,50)+"...":L}return O==="completed"&&T?T.error?`Web: ${R} (error)`:`Web: ${R} (success)`:`Web: ${R||L}`}case"NotebookEdit":{const L=y(E.notebook_path),R=E.cell_number!==void 0?E.cell_number:"?",F=E.edit_mode||"replace";return`NotebookEdit: ${L} cell #${R} (${F})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${E.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${E.shell_id||"unknown"}`;default:return`${C}: executed`}}),j=f(()=>{const C=e.toolCall.name,E=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(C)?E.command||C:["Edit","Read","Write","NotebookEdit"].includes(C)&&(E.file_path||E.notebook_path)||C});function A(){const C=o.currentSessionId;C&&t.toggleToolExpansion(C,e.toolCall.id)}function k(C){return C.type==="setMode"?`Set permission mode to "${C.mode}"`:C.type==="allow"?`Allow tool: ${C.tool}`:JSON.stringify(C)}async function N(C,E,T=null){if(!a.value){a.value=!0,C==="allow"?r.value=E?"approve-apply":"approve":T?r.value="deny-guidance":r.value="deny";try{const O=o.currentSessionId;if(O){const L=E&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:C,reasoning:C==="allow"?"User allowed permission":"User denied permission",applied_updates:L})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,C,E,T)}catch(O){console.error("Failed to send permission response:",O)}finally{a.value=!1,r.value=null}}}return(C,E)=>(d(),m("div",{class:K(["tool-call-card card",v.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:A},[s("div",uu,[s("span",du,$(h.value),1),s("strong",{class:"tool-name",title:j.value},$(P.value),9,mu)]),s("div",pu,[s("small",fu,$(x.value),1),s("i",{class:K(["bi",n.toolCall.isExpanded?"bi-chevron-up":"bi-chevron-down"])},null,2)])]),n.toolCall.isExpanded?(d(),m("div",vu,[l.value?(d(),m("div",hu,[s("div",_u,[E[6]||(E[6]=s("i",{class:"bi bi-x-circle me-2",style:{"font-size":"1.2rem"}},null,-1)),s("div",null,[E[5]||(E[5]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",gu,$(p.value?.message||"Session was terminated"),1)])])])):I("",!0),(d(),we(no(_.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!l.value?(d(),m("div",bu,[s("div",yu,[E[9]||(E[9]=s("p",{class:"mb-2"},[s("strong",null,"🔐 Permission Required")],-1)),s("p",$u,[E[7]||(E[7]=G("Claude wants to use the ",-1)),s("code",wu,$(n.toolCall.name),1),E[8]||(E[8]=G(" tool.",-1))])]),b.value?(d(),m("div",Eu,[s("div",Cu,[E[10]||(E[10]=s("h6",{class:"mb-2"},[s("i",{class:"bi bi-lightbulb me-2"}),G(" Suggested Permission Update ")],-1)),E[11]||(E[11]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Su,[(d(!0),m(se,null,ae(n.toolCall.suggestions,(T,O)=>(d(),m("div",{key:O,class:"suggestion-item"},[s("code",null,$(k(T)),1)]))),128))]),E[12]||(E[12]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):I("",!0),s("div",Tu,[b.value?(d(),m("button",{key:0,class:"btn btn-success",onClick:E[0]||(E[0]=T=>N("allow",!0)),disabled:a.value},[E[13]||(E[13]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),G(" "+$(a.value&&r.value==="approve-apply"?"⏳ Submitting...":"✅ Approve & Apply"),1)],8,ku)):I("",!0),s("button",{class:K(["btn",b.value?"btn-outline-success":"btn-success"]),onClick:E[1]||(E[1]=T=>N("allow",!1)),disabled:a.value},[E[14]||(E[14]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),G(" "+$(a.value&&r.value==="approve"?"⏳ Submitting...":b.value?"✅ Approve Only":"✅ Approve"),1)],10,xu),s("button",{class:"btn btn-danger",onClick:E[2]||(E[2]=T=>N("deny",!1)),disabled:a.value},[E[15]||(E[15]=s("i",{class:"bi bi-x-circle me-1"},null,-1)),G(" "+$(a.value&&r.value==="deny"?"⏳ Submitting...":"❌ Deny"),1)],8,Au)]),s("div",Mu,[E[17]||(E[17]=s("label",{class:"form-label fw-bold"},[s("i",{class:"bi bi-chat-left-text me-1"}),G(" Provide Guidance (Optional) ")],-1)),E[18]||(E[18]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),te(s("textarea",{"onUpdate:modelValue":E[3]||(E[3]=T=>u.value=T),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Ou),[[me,u.value]]),u.value.trim()?(d(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:E[4]||(E[4]=T=>N("deny",!1,u.value)),disabled:a.value},[E[16]||(E[16]=s("i",{class:"bi bi-arrow-repeat me-1"},null,-1)),G(" "+$(a.value&&r.value==="deny-guidance"?"⏳ Submitting...":"💡 Provide Guidance & Continue"),1)],8,Nu)):I("",!0)])])):I("",!0),n.toolCall.status==="permission_required"&&l.value?(d(),m("div",Du,[s("div",Lu,[s("div",Iu,[E[20]||(E[20]=s("i",{class:"bi bi-shield-x me-2",style:{"font-size":"1.2rem"}},null,-1)),s("div",null,[E[19]||(E[19]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Pu,$(p.value?.message||"Session was terminated before permission could be granted"),1)])])])])):I("",!0),n.toolCall.permissionDecision==="deny"?(d(),m("div",ju,[s("div",Ru,[E[21]||(E[21]=s("i",{class:"bi bi-x-circle"},null,-1)),E[22]||(E[22]=G(" Permission denied ",-1)),n.toolCall.result?.message?(d(),m("span",Vu," - "+$(n.toolCall.result.message),1)):I("",!0)])])):I("",!0)])):I("",!0)],2))}},Wu=Y(Hu,[["__scopeId","data-v-65c848bf"]]),Fu={class:"message-row message-row-assistant"},Uu=["title"],Bu={class:"message-content-column"},qu={key:0,class:"thinking-block mb-2"},zu=["innerHTML"],Ku={key:2,class:"tool-calls"},Yu={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=De(),o=ee();Mt.setOptions({breaks:!0,gfm:!0});const i=f(()=>ss(e.message.timestamp)),a=f(()=>e.message.metadata?.model||null),r=f(()=>{const x=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${x}`}),u=f(()=>{const x=e.message.content||"";return x.trim().length>0&&x!=="Assistant response"}),l=f(()=>{const x=e.message.content||"";let g=Mt.parse(x);return g=g.replace(/\n</g,"<"),g=g.replace(/\n+$/,""),Vs.sanitize(g)}),p=f(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=f(()=>e.message.metadata?.thinking_content||""),_=f(()=>e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0),v=f(()=>e.message.metadata?.tool_uses||[]),h=f(()=>{const x=o.currentSessionId;if(!x)return[];const g=t.toolCallsBySession.get(x)||[];return v.value.map(b=>{const y=g.find(M=>M.id===b.id);return y||{id:b.id,name:b.name,input:b.input,status:"pending",result:null,timestamp:b.timestamp||e.message.timestamp,isExpanded:!0}})});return(x,g)=>(d(),m("div",Fu,[s("div",{class:"message-speaker",title:r.value},[...g[0]||(g[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Uu),s("div",Bu,[p.value?(d(),m("div",qu,[ie(ca,{thinking:c.value},null,8,["thinking"])])):I("",!0),u.value?(d(),m("div",{key:1,class:"message-text",innerHTML:l.value},null,8,zu)):I("",!0),_.value?(d(),m("div",Ku,[(d(!0),m(se,null,ae(h.value,b=>(d(),we(Wu,{key:b.id,toolCall:b},null,8,["toolCall"]))),128))])):I("",!0)])]))}},Gu=Y(Yu,[["__scopeId","data-v-726a72a7"]]),Ju={class:"message-row message-row-system"},Xu=["title"],Qu={class:"message-content-column"},Zu={class:"system-text"},ed={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>ss(e.message.timestamp)),o=f(()=>`system
${t.value}`);return(i,a)=>(d(),m("div",Ju,[s("div",{class:"message-speaker",title:o.value},[...a[0]||(a[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Xu),s("div",Qu,[s("span",Zu,$(n.message.content),1)])]))}},yn=Y(ed,[["__scopeId","data-v-4999cd2b"]]),td={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=f(()=>{switch(e.message.type){case"user":return na;case"assistant":return Gu;case"system":return yn;default:return yn}});return(o,i)=>(d(),we(no(t.value),{message:n.message},null,8,["message"]))}},sd=Y(td,[["__scopeId","data-v-f283c218"]]),nd={key:0,class:"text-muted text-center py-5"},od={__name:"MessageList",setup(n){const e=De(),t=ce(),o=D(null),i=f(()=>e.currentMessages.filter(l=>r(l)));f(()=>e.currentToolCalls);async function a(){t.autoScrollEnabled&&(await Os(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}le(()=>e.currentMessages.length,a),le(()=>e.currentToolCalls.length,a),le(()=>e.currentToolCalls.map(l=>`${l.id}-${l.status}`).join(","),a),pe(()=>{setTimeout(()=>{a()},100)});function r(l){const p=l.subtype||l.metadata?.subtype;if(l.type==="system"&&p==="init"||l.type==="result"||l.type==="permission_request"||l.type==="permission_response")return!1;if(l.type==="user"&&l.metadata?.has_tool_results){const c=l.content||"";if(c.match(/^Tool results?: \d+ results?$/i)||c.trim()==="")return!1}if(l.type==="user"){const c=l.content||"";if(c.includes("<command-message>")&&c.includes("skill is running")||c.startsWith("Base directory for this skill:"))return!1}if(l.type==="user"){const c=l.content||"";if(c.includes("<command-message>")&&c.includes("<command-name>")&&c.includes("<command-args>")||c.includes("ARGUMENTS:")&&(c.includes("<command-name>")||c.match(/\nARGUMENTS:/)))return!1}return!0}function u(l){return{type:l.type||"unknown",content:l.content||"",timestamp:l.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...l.metadata}}}return(l,p)=>(d(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(d(),m("div",nd," No messages yet. Start a conversation! ")):I("",!0),(d(!0),m(se,null,ae(i.value,(c,_)=>(d(),we(sd,{key:`msg-${c.timestamp}-${_}`,message:u(c)},null,8,["message"]))),128))],512))}},id=Y(od,[["__scopeId","data-v-f94a8763"]]),ad={class:"border-top bg-light"},rd={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},ld={class:"d-flex gap-2 align-items-end px-2 py-1"},cd=["placeholder","disabled","onKeydown"],ud=["disabled"],dd={__name:"InputArea",setup(n){const e=ee(),t=Ye(),o=D(null),i=f({get:()=>e.currentInput,set:v=>{e.currentInput=v}}),a=f(()=>e.currentSession?.is_processing||!1),r=f(()=>t.sessionConnected),u=f(()=>e.currentSession?.state==="starting"),l=f(()=>u.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function p(){const v=o.value;if(!v)return;v.style.height="auto";const h=Math.min(v.scrollHeight,parseInt(getComputedStyle(v).maxHeight));v.style.height=h+"px"}function c(){i.value.trim()&&(t.sendMessage(i.value),i.value="",o.value&&(o.value.style.height="auto"))}function _(){t.interruptSession()}return(v,h)=>(d(),m("div",ad,[r.value?I("",!0):(d(),m("div",rd,[...h[1]||(h[1]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-exclamation-triangle-fill flex-shrink-0",viewBox:"0 0 16 16"},[s("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})],-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"—",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",ld,[te(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":h[0]||(h[0]=x=>i.value=x),class:"form-control",placeholder:l.value,disabled:u.value||!r.value,rows:"1",onInput:p,onKeydown:Xt(he(c,["exact","prevent"]),["enter"])},null,40,cd),[[me,i.value]]),a.value?(d(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:_}," Stop ")):(d(),m("button",{key:1,class:"btn btn-primary",disabled:!i.value.trim()||!r.value||u.value,onClick:c}," Send ",8,ud))])]))}},md=Y(dd,[["__scopeId","data-v-d2ca2648"]]),pd={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},fd={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},vd={class:"text-secondary"},hd={class:"d-flex flex-column flex-grow-1 overflow-hidden"},ao={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ee(),o=ce(),i=f(()=>t.currentSession),a=f(()=>o.isLoading),r=f(()=>o.loadingMessage);return pe(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),le(()=>e.sessionId,async(u,l)=>{if(u!==l&&u!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(u)}finally{o.hideLoading()}}}),be(()=>{}),(u,l)=>(d(),m("div",pd,[a.value?(d(),m("div",fd,[l[0]||(l[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",vd,$(r.value),1)])):I("",!0),i.value?(d(),we(Ai,{key:1,"session-id":e.sessionId},null,8,["session-id"])):I("",!0),s("div",hd,[ie(id)]),ie(md),i.value?(d(),we(Li,{key:2,"session-id":e.sessionId},null,8,["session-id"])):I("",!0),i.value?(d(),we(Ui,{key:3,"session-id":e.sessionId},null,8,["session-id"])):I("",!0)]))}},bt=gt("legion",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(null),u=f(()=>n.value.get(r.value)||[]),l=f(()=>e.value.get(r.value)||[]),p=f(()=>t.value.get(r.value)||[]),c=f(()=>o.value.get(r.value)||[]);function _(k){r.value=k}async function v(k,N=100,C=0){try{const E=await Z.get(`/api/legions/${k}/timeline?limit=${N}&offset=${C}`),T=E.comms||[],O=E.total_count||T.length,L=E.has_more||!1;return T.sort((R,F)=>new Date(R.timestamp)-new Date(F.timestamp)),console.log(`Loaded ${T.length} of ${O} comms for legion ${k}`),n.value.set(k,T),n.value=new Map(n.value),{comms:T,totalCount:O,hasMore:L}}catch(E){throw console.error("Failed to load timeline:",E),E}}function h(k,N){n.value.has(k)||n.value.set(k,[]),n.value.get(k).push(N),n.value=new Map(n.value)}async function x(k,N){try{const E=(await Z.post(`/api/legions/${k}/comms`,N)).comm;return console.log(`Sent comm ${E.comm_id} to legion ${k}`),E}catch(C){throw console.error("Failed to send comm:",C),C}}async function g(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function b(k,N){try{const E=(await Z.post(`/api/legions/${k}/minions`,N)).minion;return await g(k),console.log(`Created minion ${E.minion_id} in legion ${k}`),E}catch(C){throw console.error("Failed to create minion:",C),C}}async function y(k){try{const C=(await Z.get(`/api/legions/${k}/hordes`)).hordes||[];return console.log(`Loaded ${C.length} hordes for legion ${k}`),t.value.set(k,C),t.value=new Map(t.value),C}catch(N){throw console.error("Failed to load hordes:",N),N}}async function M(k){try{const C=(await Z.get(`/api/legions/${k}/channels`)).channels||[];return console.log(`Loaded ${C.length} channels for legion ${k}`),o.value.set(k,C),o.value=new Map(o.value),C}catch(N){throw console.error("Failed to load channels:",N),N}}async function S(k){try{const N=await Z.get(`/api/channels/${k}`),C=N.channel||N;return console.log(`Loaded details for channel ${k}`),i.value.set(k,C),i.value=new Map(i.value),C}catch(N){throw console.error("Failed to load channel details:",N),N}}async function w(k,N=1e3){try{const E=(await Z.get(`/api/channels/${k}/comms?limit=${N}`)).comms||[];return console.log(`Loaded ${E.length} comms for channel ${k}`),E.sort((T,O)=>new Date(T.timestamp)-new Date(O.timestamp)),a.value.set(k,E),a.value=new Map(a.value),E}catch(C){throw console.error("Failed to load channel comms:",C),C}}async function P(k,N){try{await Z.post(`/api/channels/${k}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:N}),console.log(`Added minion ${N} to channel ${k}`),await S(k)}catch(C){throw console.error("Failed to add member to channel:",C),C}}async function j(k,N){try{await Z.post(`/api/channels/${k}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:N}),console.log(`Removed minion ${N} from channel ${k}`),await S(k)}catch(C){throw console.error("Failed to remove member from channel:",C),C}}function A(k){n.value.delete(k),e.value.delete(k),t.value.delete(k),o.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value),t.value=new Map(t.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:t,channelsByLegion:o,channelDetailsByChannel:i,channelCommsByChannel:a,currentLegionId:r,currentComms:u,currentMinions:l,currentHordes:p,currentChannels:c,setCurrentLegion:_,loadTimeline:v,addComm:h,sendComm:x,loadMinions:g,createMinion:b,loadHordes:y,loadChannels:M,loadChannelDetails:S,loadChannelComms:w,addMemberToChannel:P,removeMemberFromChannel:j,clearLegionData:A}}),_d=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:bt},Symbol.toStringTag,{value:"Module"})),gd={class:"timeline-header border-bottom p-3"},bd={class:"project-name"},yd=["title"],$d={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=ve(),o=f(()=>t.projects.get(e.legionId)),i=f(()=>o.value?.name||"Legion");return(a,r)=>(d(),m("div",gd,[s("div",null,[s("div",bd,$(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,yd)])]))}},wd=Y($d,[["__scopeId","data-v-44f386f5"]]),Ed={class:"timeline-status-bar border-top p-2 bg-light"},Cd={class:"d-flex justify-content-end"},Sd={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ce();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(d(),m("div",Ed,[s("div",Cd,[s("button",{class:K(["btn btn-sm",Jt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," ⬇️ "+$(Jt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Td=Y(Sd,[["__scopeId","data-v-891c73db"]]),kd={class:"comm-composer border-top p-3"},xd={class:"d-flex gap-2 mb-2"},Ad={class:"flex-grow-1"},Md=["disabled"],Od={label:"Minions"},Nd=["value"],Dd={key:0,label:"Channels"},Ld=["value"],Id={style:{"min-width":"150px"}},Pd=["disabled"],jd={class:"d-flex gap-2 align-items-end position-relative"},Rd={class:"flex-grow-1 position-relative"},Vd=["disabled"],Hd=["onClick","onMouseenter"],Wd=["disabled"],Fd={key:0},Ud={key:1},Bd={__name:"CommComposer",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=ee(),i=ve(),a=D(""),r=D("task"),u=D(""),l=D(!1),p=D(!1),c=D([]),_=D(0),v=D(-1),h=D(null),x=D(null),g=f(()=>{const C=i.projects.get(e.legionId);return!C||!C.session_ids?[]:C.session_ids.map(E=>o.sessions.get(E)).filter(E=>E&&E.is_minion)}),b=f(()=>t.currentChannels||[]),y=f(()=>a.value&&u.value.trim().length>0);function M(C){return{created:"○",starting:"◐",active:"●",paused:"⏸",terminating:"◍",terminated:"✗",error:"⚠"}[C.state]||"○"}function S(C){return C.is_minion&&C.role?`${C.name} (${C.role})`:C.name}function w(){const C=h.value;if(!C)return;C.style.height="auto";const E=Math.min(C.scrollHeight,parseInt(getComputedStyle(C).maxHeight));C.style.height=E+"px"}function P(){const C=h.value;if(!C)return;w();const E=u.value,T=C.selectionStart,O=E.substring(0,T),L=O.lastIndexOf("#");if(L===-1){p.value=!1;return}const R=O.substring(L+1).toLowerCase();if(R.includes(" ")){p.value=!1;return}const F=g.value.filter(U=>U.name.toLowerCase().includes(R)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(F.length===0){p.value=!1;return}c.value=F,_.value=0,v.value=L,p.value=!0}function j(){if(!x.value)return;const C=x.value,E=C.children[_.value];if(!E)return;const T=E.offsetTop,O=E.offsetHeight,L=C.scrollTop,R=C.clientHeight;T<L?C.scrollTop=T:T+O>L+R&&(C.scrollTop=T+O-R)}function A(C){if(!p.value){C.key==="Enter"&&!C.shiftKey&&y.value&&(C.preventDefault(),N());return}if(C.key==="ArrowDown")C.preventDefault(),_.value=(_.value+1)%c.value.length,j();else if(C.key==="ArrowUp")C.preventDefault(),_.value=_.value===0?c.value.length-1:_.value-1,j();else if(C.key==="Enter"){C.preventDefault();const E=c.value[_.value];E&&k(E)}else C.key==="Escape"&&(p.value=!1)}function k(C){const E=h.value;if(!E)return;const T=u.value,O=E.selectionStart,L=T.substring(0,v.value)+"#"+C.name+" "+T.substring(O);u.value=L;const R=v.value+C.name.length+2;setTimeout(()=>{E.setSelectionRange(R,R),E.focus()},0),p.value=!1}async function N(){if(!(!y.value||l.value)){l.value=!0;try{const[C,E]=a.value.split(":"),T={comm_type:r.value,content:u.value.trim()};C==="minion"?T.to_minion_id=E:C==="channel"&&(T.to_channel_id=E),await t.sendComm(e.legionId,T),u.value="",w()}catch(C){console.error("Failed to send comm:",C),alert(`Failed to send comm: ${C.message}`)}finally{l.value=!1}}}return le(p,C=>{if(C){const E=T=>{T.target.closest(".comm-composer")||(p.value=!1,document.removeEventListener("click",E))};setTimeout(()=>document.addEventListener("click",E),0)}}),(C,E)=>(d(),m("div",kd,[s("div",xd,[s("div",Ad,[te(s("select",{"onUpdate:modelValue":E[0]||(E[0]=T=>a.value=T),class:"form-select form-select-sm",disabled:l.value},[E[3]||(E[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Od,[(d(!0),m(se,null,ae(g.value,T=>(d(),m("option",{key:T.session_id,value:`minion:${T.session_id}`},$(M(T))+" "+$(S(T)),9,Nd))),128))]),b.value.length>0?(d(),m("optgroup",Dd,[(d(!0),m(se,null,ae(b.value,T=>(d(),m("option",{key:T.channel_id,value:`channel:${T.channel_id}`}," #️⃣ "+$(T.name),9,Ld))),128))])):I("",!0)],8,Md),[[Fe,a.value]])]),s("div",Id,[te(s("select",{"onUpdate:modelValue":E[1]||(E[1]=T=>r.value=T),class:"form-select form-select-sm",disabled:l.value},[...E[4]||(E[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Pd),[[Fe,r.value]])])]),s("div",jd,[s("div",Rd,[te(s("textarea",{ref_key:"contentTextarea",ref:h,"onUpdate:modelValue":E[2]||(E[2]=T=>u.value=T),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:l.value,onInput:P,onKeydown:A},null,40,Vd),[[me,u.value]]),p.value?(d(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:x,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(d(!0),m(se,null,ae(c.value,(T,O)=>(d(),m("div",{key:T.id,class:K(["autocomplete-item px-2 py-1",{"bg-light":O===_.value}]),onClick:L=>k(T),onMouseenter:L=>_.value=O},$(T.type==="minion"?M(T):"#️⃣")+" "+$(T.name)+$(T.role?` (${T.role})`:""),43,Hd))),128))],512)):I("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!y.value||l.value,onClick:N},[l.value?(d(),m("span",Fd,[...E[5]||(E[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),G(" Sending... ",-1)])])):(d(),m("span",Ud,"Send"))],8,Wd)])])]))}},qd=Y(Bd,[["__scopeId","data-v-ffa54193"]]),zd={class:"timeline-view d-flex flex-column h-100"},Kd={key:0,class:"text-center text-muted"},Yd={key:1,class:"text-center text-danger"},Gd={key:2,class:"text-center text-muted"},Jd={key:3,class:"comm-list"},Xd={class:"col-auto message-speaker text-end pe-3"},Qd={class:"text-muted"},Zd={class:"col message-content-column"},em={class:"card-body p-2"},tm={class:"d-flex justify-content-between align-items-start mb-1"},sm={class:"comm-content"},nm="ffffffff-ffff-ffff-ffff-ffffffffffff",om={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=ve(),i=ee(),a=Ye(),r=ce(),u=D(!0),l=D(null),p=D(null),c=f(()=>o.projects.get(e.legionId));f(()=>c.value?.name||"Legion");const _=f(()=>t.currentComms);f(()=>t.currentMinions);function v(P){return P.from_minion_id===nm}function h(P){return P.from_user?"You":P.from_minion_id?v(P)?"SYSTEM":i.sessions.get(P.from_minion_id)?.name||"Unknown":"Unknown"}function x(P){return P.to_user?"You":P.to_minion_id?i.sessions.get(P.to_minion_id)?.name||"Unknown":P.to_channel_id?P.to_channel_name?`#${P.to_channel_name}`:P.to_channel_id:"All"}function g(P){return{task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success"}[P]||"bg-secondary"}function b(P){return new Date(P).toLocaleTimeString()}async function y(){r.autoScrollEnabled&&(await Os(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function M(){u.value=!0,l.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await Os(),await y(),setTimeout(()=>{y()},100)}catch(P){console.error("Failed to load timeline:",P),P.response?l.value=`${P.message} (${P.response.status})`:l.value=P.message||"Unknown error"}finally{u.value=!1}}function S(){a.connectLegion(e.legionId)}function w(){a.disconnectLegion()}return le(()=>_.value.length,()=>{y()}),pe(()=>{M(),S(),setTimeout(()=>{y()},100)}),be(()=>{w()}),(P,j)=>(d(),m("div",zd,[ie(wd,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto p-3"},[u.value?(d(),m("div",Kd,[...j[0]||(j[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),G(" Loading timeline... ",-1)])])):l.value?(d(),m("div",Yd," Failed to load timeline: "+$(l.value),1)):_.value.length===0?(d(),m("div",Gd," No messages yet. Minions will appear here once they start communicating. ")):(d(),m("div",Jd,[(d(!0),m(se,null,ae(_.value,A=>(d(),m("div",{key:A.comm_id,class:K(["comm-item message-row row py-2 mb-2",{"system-comm":v(A)}])},[s("div",Xd,[s("small",Qd,$(b(A.timestamp)),1)]),s("div",Zd,[s("div",{class:K(["comm-card card",{"system-card":v(A)}])},[s("div",em,[s("div",tm,[s("div",null,[s("span",{class:K(["badge",g(A.comm_type)])},$(A.comm_type),3),s("strong",{class:K(["ms-2",{"system-sender":v(A)}])},$(h(A)),3),j[1]||(j[1]=s("span",{class:"text-muted mx-1"},"→",-1)),s("strong",{class:K({"recipient-channel":A.to_channel_id})},$(x(A)),3)])]),s("div",sm,$(A.content),1)])],2)])],2))),128))]))],512),ie(qd,{"legion-id":n.legionId},null,8,["legion-id"]),ie(Td,{"legion-id":n.legionId},null,8,["legion-id"])]))}},im=Y(om,[["__scopeId","data-v-6d97bd0b"]]),am={class:"spy-view d-flex flex-column overflow-hidden"},rm={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){return(e,t)=>(d(),m("div",am,[ie(ao,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},lm=Y(rm,[["__scopeId","data-v-43a24eaf"]]),cm={class:"horde-header border-bottom p-3"},um={class:"project-name"},dm={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=ve(),o=f(()=>t.projects.get(e.legionId)),i=f(()=>o.value?.name||"Legion");return(a,r)=>(d(),m("div",cm,[s("div",null,[s("div",um,$(i.value),1),r[0]||(r[0]=s("div",{class:"view-name"},"Minion Hierarchy",-1))])]))}},mm=Y(dm,[["__scopeId","data-v-0c86e2b5"]]),pm={class:"horde-status-bar border-top p-2 bg-light"},fm={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,t)=>(d(),m("div",pm,[...t[0]||(t[0]=[s("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},vm=Y(fm,[["__scopeId","data-v-f0e64ab0"]]),hm={class:"minion-card border-start border-2 mb-2"},_m={class:"node-row"},gm={class:"node-left"},bm={key:0,class:"me-2"},ym={key:1,class:"badge bg-secondary ms-2"},$m={class:"node-right"},wm={key:0,class:"last-comm-preview"},Em={class:"comm-direction"},Cm=["title"],Sm={key:1,class:"text-muted fst-italic small"},Tm={key:0,class:"minion-children"},km={key:1,class:"text-danger small ms-4"},xm={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,t=f(()=>e.level*24),o=f(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=f(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=f(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),r=f(()=>{const c=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[c]||"status-dot-grey"}),u=f(()=>{const c=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}});function l(c){return c.to_user?"User":c.to_minion_name?c.to_minion_name:c.to_channel_name?`#${c.to_channel_name}`:"unknown"}function p(c){const _=c.summary||c.content||"";return _.length>150?_.substring(0,150)+"...":_}return(c,_)=>{const v=oo("MinionTreeNode",!0);return n.minionData?(d(),m("div",{key:0,class:"minion-tree-node",style:je({marginLeft:`${t.value}px`})},[s("div",hm,[s("div",_m,[s("div",gm,[s("div",{class:K(["status-dot me-2",r.value]),style:je(u.value)},null,6),i.value?(d(),m("span",bm,"👑")):I("",!0),s("strong",null,$(n.minionData.name),1),i.value?(d(),m("span",ym,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):I("",!0)]),s("div",$m,[n.minionData.last_comm?(d(),m("div",wm,[s("span",Em,[_[0]||(_[0]=G(" → ",-1)),s("strong",null,$(l(n.minionData.last_comm)),1),_[1]||(_[1]=G(": ",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},$(p(n.minionData.last_comm)),9,Cm)])):(d(),m("div",Sm," No communications yet "))])])]),o.value?(d(),m("div",Tm,[(d(!0),m(se,null,ae(n.minionData.children,h=>(d(),we(v,{key:h.id,"minion-data":h,level:n.level+1},null,8,["minion-data","level"]))),128))])):I("",!0)],4)):(d(),m("div",km," ⚠ Minion data is missing "))}}},Am=Y(xm,[["__scopeId","data-v-1cd9863f"]]),Mm={class:"horde-view d-flex flex-column h-100"},Om={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},Nm={key:0,class:"text-center py-5"},Dm={key:1,class:"alert alert-danger"},Lm={class:"mb-0"},Im={key:2,class:"horde-tree"},Pm={class:"user-root-node mb-3 border rounded bg-white"},jm={class:"node-row"},Rm={class:"node-left"},Vm={key:0,class:"badge bg-primary ms-2"},Hm={class:"node-right"},Wm={key:0,class:"last-comm-preview"},Fm={class:"comm-direction"},Um=["title"],Bm={key:1,class:"text-muted fst-italic"},qm={key:0,class:"alert alert-info ms-4"},zm={key:1,class:"root-minions ms-4"},Km={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=ve(),o=ee(),i=Ye(),a=bt(),r=D(null),u=D(!1),l=D(null);f(()=>t.projects.get(e.legionId));const p=f(()=>r.value&&r.value.children&&r.value.children.length>0);async function c(){u.value=!0,l.value=null;try{const g=await Z.get(`/api/legions/${e.legionId}/hordes`);r.value=g,console.log("Loaded hierarchy:",g)}catch(g){console.error("Failed to load hierarchy:",g),l.value=g.message||"Unknown error"}finally{u.value=!1}}pe(()=>{c()}),le(()=>e.legionId,()=>{c()});function _(g){return g.to_user?"User":g.to_minion_name?g.to_minion_name:g.to_channel_name?`#${g.to_channel_name}`:"unknown"}function v(g){const b=g.summary||g.content||"";return b.length>150?b.substring(0,150)+"...":b}function h(g,b){if(g.id===b)return g;if(g.children)for(const y of g.children){const M=h(y,b);if(M)return M}return null}function x(g){if(r.value){if(g.from_minion_id){const b=h(r.value,g.from_minion_id);b&&b.type==="minion"&&(b.last_comm=g,console.log(`Updated minion ${b.name} last_comm`))}g.from_user&&r.value.type==="user"&&(r.value.last_comm=g,console.log("Updated user last_comm"))}}return pe(()=>{c(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),le(()=>o.sessions,g=>{if(r.value){for(const[b,y]of g)if(y.is_minion&&y.project_id===e.legionId){const M=h(r.value,b);M&&M.type==="minion"&&(M.state!==y.state&&(M.state=y.state,console.log(`Updated minion ${M.name} state to ${y.state}`)),M.is_processing!==y.is_processing&&(M.is_processing=y.is_processing,console.log(`Updated minion ${M.name} is_processing to ${y.is_processing}`)))}}},{deep:!0}),le(()=>a.commsByLegion.get(e.legionId),g=>{if(g&&g.length>0){const b=g[g.length-1];x(b)}},{deep:!0}),le(()=>o.sessions.size,(g,b)=>{g>b&&Array.from(o.sessions.values()).some(S=>S.is_minion&&S.project_id===e.legionId&&!h(r.value,S.session_id))&&(console.log("New minion detected, reloading hierarchy"),c())})}),be(()=>{console.log("HordeView unmounted")}),(g,b)=>(d(),m("div",Mm,[ie(mm,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",Om,[u.value?(d(),m("div",Nm,[...b[0]||(b[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):l.value?(d(),m("div",Dm,[b[1]||(b[1]=s("strong",null,"Failed to load hierarchy",-1)),s("p",Lm,$(l.value),1)])):r.value?(d(),m("div",Im,[s("div",Pm,[s("div",jm,[s("div",Rm,[b[2]||(b[2]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"👤",-1)),s("strong",null,$(r.value.name),1),p.value?(d(),m("span",Vm,$(r.value.children.length)+" "+$(r.value.children.length===1?"minion":"minions"),1)):I("",!0)]),s("div",Hm,[r.value.last_comm?(d(),m("div",Wm,[s("span",Fm,[b[3]||(b[3]=G(" → ",-1)),s("strong",null,$(_(r.value.last_comm)),1),b[4]||(b[4]=G(": ",-1))]),s("span",{class:"comm-content",title:r.value.last_comm.content||""},$(v(r.value.last_comm)),9,Um)])):(d(),m("div",Bm," No communications yet "))])])]),p.value?(d(),m("div",zm,[(d(!0),m(se,null,ae(r.value.children,y=>(d(),we(Am,{key:y.id,"minion-data":y,level:1},null,8,["minion-data"]))),128))])):(d(),m("div",qm,[...b[5]||(b[5]=[s("p",{class:"mb-2"},"No minions yet",-1),s("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):I("",!0)]),ie(vm,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Ym=Y(Km,[["__scopeId","data-v-af6338a3"]]),Gm={class:"channel-view d-flex flex-column h-100"},Jm={class:"channel-header border-bottom p-3"},Xm={class:"d-flex align-items-center justify-content-between"},Qm={class:"mb-0"},Zm={class:"text-muted"},ep={class:"badge bg-secondary"},tp={class:"channel-content flex-grow-1 overflow-auto"},sp={key:0,class:"text-center text-muted py-4"},np={key:1,class:"text-center text-danger py-4"},op={key:2,class:"text-center text-muted py-4"},ip={key:3,class:"p-3"},ap={class:"overview-section mb-4"},rp={class:"row g-3"},lp={class:"col-md-6"},cp={class:"font-monospace small text-muted"},up={class:"col-md-6"},dp={class:"text-muted"},mp={class:"col-12"},pp={class:"text-muted"},fp={class:"col-12"},vp={class:"text-muted"},hp={class:"members-section mb-4"},_p={class:"text-muted border-bottom pb-2 d-flex align-items-center justify-content-between"},gp={key:0,class:"mb-3"},bp=["value"],yp={key:1,class:"text-center text-muted py-3"},$p={key:2,class:"list-group"},wp={class:"d-flex align-items-center gap-2"},Ep=["title"],Cp={class:"fw-semibold"},Sp={class:"text-muted"},Tp=["onClick"],kp={class:"comms-section"},xp={class:"text-muted border-bottom pb-2"},Ap={key:0,class:"text-center text-muted py-4"},Mp={key:1,class:"text-center text-muted py-3"},Op={key:2,class:"comm-list"},Np={class:"card-body p-2"},Dp={class:"d-flex justify-content-between align-items-start mb-1"},Lp={class:"ms-2"},Ip={class:"text-muted ms-2"},Pp={key:0,class:"text-muted small mb-1"},jp={class:"comm-content"},Rp={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=ve(),i=ee(),a=D(!0),r=D(null),u=D(!1),l=D(!1),p=D(""),c=f(()=>o.projects.get(e.legionId)),_=f(()=>t.channelDetailsByChannel.get(e.channelId)),v=f(()=>t.channelCommsByChannel.get(e.channelId)||[]),h=f(()=>_.value?.member_minion_ids?.length||0),x=f(()=>v.value.length),g=f(()=>_.value?.member_minion_ids?_.value.member_minion_ids.map(N=>i.sessions.get(N)).filter(Boolean):[]),b=f(()=>{if(!_.value)return[];const N=new Set(_.value.member_minion_ids||[]);return Array.from(i.sessions.values()).filter(E=>E.is_minion).filter(E=>!N.has(E.session_id))});function y(N){if(N.state==="paused"&&N.is_processing)return"status-blinking";const C=N.is_processing?"processing":N.state;return C==="starting"||C==="processing"?"status-blinking":""}function M(N){if(N.state==="paused"&&N.is_processing)return{backgroundColor:"#ffc107"};const C=N.is_processing?"processing":N.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[C]||"#d3d3d3"}}function S(N){return N.from_user?"You":N.from_minion_name?N.from_minion_name:N.from_minion_id&&i.sessions.get(N.from_minion_id)?.name||"Unknown"}function w(N){return{task:"bg-primary",question:"bg-info",report:"bg-success",info:"bg-secondary",halt:"bg-danger",pivot:"bg-warning"}[N?.toLowerCase()]||"bg-secondary"}function P(N){return N?new Date(N).toLocaleString():"N/A"}function j(N){return N?new Date(N).toLocaleString():"N/A"}async function A(){if(!(!p.value||!e.channelId))try{await t.addMemberToChannel(e.channelId,p.value),p.value="",l.value=!1}catch(N){console.error("Failed to add member:",N),alert("Failed to add member to channel")}}async function k(N){if(confirm("Remove this minion from the channel?"))try{await t.removeMemberFromChannel(e.channelId,N)}catch(E){console.error("Failed to remove member:",E),alert("Failed to remove member from channel")}}return pe(async()=>{a.value=!0;try{await t.loadChannelDetails(e.channelId),u.value=!0,await t.loadChannelComms(e.channelId,1e3),u.value=!1}catch(N){console.error("Failed to load channel:",N),r.value=N.message||"Unknown error"}finally{a.value=!1}}),le(()=>e.channelId,async N=>{if(N){a.value=!0,r.value=null;try{await t.loadChannelDetails(N),u.value=!0,await t.loadChannelComms(N,1e3),u.value=!1}catch(C){console.error("Failed to load channel:",C),r.value=C.message||"Unknown error"}finally{a.value=!1}}}),(N,C)=>(d(),m("div",Gm,[s("div",Jm,[s("div",Xm,[s("div",null,[s("h5",Qm," 💬 "+$(_.value?.name||"Channel"),1),s("small",Zm,$(c.value?.name||"Legion"),1)]),s("span",ep,$(h.value)+" members",1)])]),s("div",tp,[a.value?(d(),m("div",sp,[...C[2]||(C[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),s("div",{class:"mt-2"},"Loading channel...",-1)])])):r.value?(d(),m("div",np," Failed to load channel: "+$(r.value),1)):_.value?(d(),m("div",ip,[s("div",ap,[C[7]||(C[7]=s("h6",{class:"text-muted border-bottom pb-2"},"Overview",-1)),s("div",rp,[s("div",lp,[C[3]||(C[3]=s("strong",null,"Channel ID:",-1)),s("div",cp,$(_.value.channel_id),1)]),s("div",up,[C[4]||(C[4]=s("strong",null,"Created:",-1)),s("div",dp,$(P(_.value.created_at)),1)]),s("div",mp,[C[5]||(C[5]=s("strong",null,"Purpose:",-1)),s("div",pp,$(_.value.purpose||"No purpose specified"),1)]),s("div",fp,[C[6]||(C[6]=s("strong",null,"Description:",-1)),s("div",vp,$(_.value.description||"No description provided"),1)])])]),s("div",hp,[s("h6",_p,[s("span",null,"Members ("+$(h.value)+")",1),s("button",{class:"btn btn-sm btn-primary",onClick:C[0]||(C[0]=E=>l.value=!l.value)}," ➕ Add Member ")]),l.value?(d(),m("div",gp,[te(s("select",{"onUpdate:modelValue":C[1]||(C[1]=E=>p.value=E),class:"form-select form-select-sm",onChange:A},[C[8]||(C[8]=s("option",{value:""},"-- Select Minion to Add --",-1)),(d(!0),m(se,null,ae(b.value,E=>(d(),m("option",{key:E.session_id,value:E.session_id},$(E.name)+" ("+$(E.role||"No role")+") ",9,bp))),128))],544),[[Fe,p.value]])])):I("",!0),g.value.length===0?(d(),m("div",yp," No members in this channel yet ")):(d(),m("div",$p,[(d(!0),m(se,null,ae(g.value,E=>(d(),m("div",{key:E.session_id,class:"list-group-item d-flex align-items-center justify-content-between"},[s("div",wp,[s("span",{class:K(["status-dot",y(E)]),style:je(M(E)),title:E.state},null,14,Ep),s("div",null,[s("div",Cp,$(E.name),1),s("small",Sp,$(E.role||"No role"),1)])]),s("button",{class:"btn btn-sm btn-outline-danger",onClick:T=>k(E.session_id),title:"Remove member from channel"}," Remove ",8,Tp)]))),128))]))]),s("div",kp,[s("h6",xp,"Communications ("+$(x.value)+")",1),u.value?(d(),m("div",Ap,[...C[9]||(C[9]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),s("div",{class:"mt-2"},"Loading comms...",-1)])])):v.value.length===0?(d(),m("div",Mp," No communications in this channel yet ")):(d(),m("div",Op,[(d(!0),m(se,null,ae(v.value,E=>(d(),m("div",{key:E.comm_id,class:"comm-item card mb-2"},[s("div",Np,[s("div",Dp,[s("div",null,[s("span",{class:K(["badge",w(E.comm_type)])},$(E.comm_type),3),s("strong",Lp,$(S(E)),1),s("small",Ip,$(j(E.timestamp)),1)])]),E.summary?(d(),m("div",Pp,[C[10]||(C[10]=s("strong",null,"Summary:",-1)),G(" "+$(E.summary),1)])):I("",!0),s("div",jp,$(E.content),1)])]))),128))]))])])):(d(),m("div",op," Channel not found "))])]))}},Vp=Y(Rp,[["__scopeId","data-v-e09adf09"]]),Hp=[{path:"/",name:"home",component:gi},{path:"/session/:sessionId",name:"session",component:ao,props:!0},{path:"/timeline/:legionId",name:"timeline",component:im,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:lm,props:!0},{path:"/horde/:legionId",name:"horde",component:Ym,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:Vp,props:!0}],Wp=mi({history:pi(),routes:Hp}),Fp={__name:"ConnectionIndicator",setup(n){const e=Ye(),t=D(!1);le(()=>e.overallStatus,(a,r)=>{a!==r&&r!==void 0&&(console.log(`🔄 Connection status changed: ${r} → ${a}`),t.value=!0,setTimeout(()=>{t.value=!1},600))});const o=f(()=>{const a=[];switch(e.overallStatus){case"connected":a.push("bg-success");break;case"partial":a.push("bg-warning");break;default:a.push("bg-secondary")}return t.value&&a.push("status-flash"),a.join(" ")}),i=f(()=>{switch(e.overallStatus){case"connected":return"Connected";case"partial":return"Partial Connection";default:return"Disconnected"}});return(a,r)=>(d(),m("span",{id:"connection-indicator",class:K(["badge",o.value])},$(i.value),3))}},Up=Y(Fp,[["__scopeId","data-v-c966b4c3"]]),Bp={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},qp={class:"d-flex align-items-center gap-2"},zp={__name:"AppHeader",setup(n){const e=ce();function t(){e.toggleSidebar()}return(o,i)=>(d(),m("header",Bp,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"☰",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",qp,[ie(Up)])]))}},Kp={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Yp={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Gp=["title"],Jp={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=f(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(u){return u.state==="paused"&&u.is_processing?"pending-prompt":u.is_processing?"processing":u.state}function i(u){const l=o(u);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[l]||"#d3d3d3"}function a(u){const l=o(u);return l==="starting"||l==="processing"||l==="pending-prompt"}function r(u){const l=o(u),p=l.charAt(0).toUpperCase()+l.slice(1),c=u.name||"Unnamed Session",_=u.is_minion&&u.role?` (${u.role})`:"";return`${c}${_}: ${p}`}return(u,l)=>(d(),m("div",Kp,[!n.sessions||n.sessions.length===0?(d(),m("div",Yp)):(d(!0),m(se,{key:1},ae(n.sessions,p=>(d(),m("div",{key:p.session_id,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":a(p)}]),style:je({width:t.value,backgroundColor:i(p),cursor:"help"}),title:r(p)},null,14,Gp))),128))]))}},Xp=Y(Jp,[["__scopeId","data-v-a79cfeec"]]),Qp={class:"flex-grow-1"},Zp={key:0,class:"text-muted small ms-1"},ef={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,t=Ke(),o=ee(),i=ve(),a=ce(),r=f(()=>o.currentSessionId===e.session.session_id),u=f(()=>o.deletingSessions.has(e.session.session_id)),l=f(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),p=f(()=>{const y=l.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[y]||"status-dot-grey"}),c=f(()=>{const y=l.value,M={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},S={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:M[y]||"#d3d3d3",borderColor:S[y]||"#6c757d"}});function _(){o.selectSession(e.session.session_id),t.push(`/session/${e.session.session_id}`)}function v(){a.showModal("edit-session",{session:e.session})}function h(y){y.dataTransfer.effectAllowed="move",y.dataTransfer.setData("application/session-id",e.session.session_id),y.dataTransfer.setData("application/project-id",e.projectId),y.dataTransfer.setData("text/plain",e.session.session_id),y.target.classList.add("dragging")}function x(y){y.target.classList.remove("dragging")}function g(y){y.preventDefault(),y.dataTransfer.dropEffect="move";const M=y.currentTarget.getBoundingClientRect(),S=M.top+M.height/2;y.clientY<S?(y.currentTarget.classList.add("drop-above"),y.currentTarget.classList.remove("drop-below")):(y.currentTarget.classList.add("drop-below"),y.currentTarget.classList.remove("drop-above"))}function b(y){y.preventDefault(),y.currentTarget.classList.remove("drop-above","drop-below");const M=y.dataTransfer.getData("application/session-id")||y.dataTransfer.getData("text/plain"),S=y.dataTransfer.getData("application/project-id");if(!M||M===e.session.session_id||S!==e.projectId)return;const w=y.currentTarget.getBoundingClientRect(),P=w.top+w.height/2,j=y.clientY<P,A=i.getProject(e.projectId);if(!A||!A.session_ids)return;const k=[...A.session_ids],N=k.indexOf(e.session.session_id),C=k.indexOf(M);if(N===-1||C===-1)return;const E=[...k],[T]=E.splice(C,1);let O=j?N:N+1;C<N&&O--,E.splice(O,0,T),i.reorderSessionsInProject(e.projectId,E)}return(y,M)=>(d(),m("div",{class:K(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:r.value,"session-deleting":u.value}]),style:{cursor:"pointer"},draggable:"true",onClick:_,onDragstart:h,onDragend:x,onDragover:g,onDrop:b},[s("div",{class:K(["status-dot me-2",p.value]),style:je(c.value)},null,6),s("div",Qp,[s("span",null,$(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(d(),m("span",Zp,"("+$(n.session.role)+")",1)):I("",!0)]),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:he(v,["stop"])}," ✏️ ")],34))}},tf=Y(ef,[["__scopeId","data-v-07ecbf94"]]),sf={class:"d-flex align-items-center gap-2"},nf=["value"],of={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ke(),o=ee(),i=ce(),a=D("");le(()=>t.currentRoute.value,g=>{!a.value&&g.name==="spy"&&g.params.minionId&&g.params.legionId===e.project.project_id&&(a.value=g.params.minionId)},{immediate:!0});const r=f(()=>a.value?e.sessions.find(g=>g.session_id===a.value):null),u=f(()=>{const g=t.currentRoute.value;return g.name==="spy"&&g.params.legionId===e.project.project_id}),l=f(()=>{if(!r.value)return"";if(r.value.state==="paused"&&r.value.is_processing)return"status-blinking";const g=r.value.is_processing?"processing":r.value.state;return g==="starting"||g==="processing"?"status-blinking":""}),p=f(()=>{if(!r.value)return{};if(r.value.state==="paused"&&r.value.is_processing)return{backgroundColor:"#ffc107"};const g=r.value.is_processing?"processing":r.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[g]||"#d3d3d3"}});function c(g){return{created:"○",starting:"◐",active:"●",paused:"⏸",terminating:"◍",terminated:"✗",error:"⚠"}[g.state]||"○"}function _(g){return g.is_minion&&g.role?`${g.name} (${g.role})`:g.name}function v(){a.value&&t.push(`/spy/${e.project.project_id}/${a.value}`)}function h(){a.value?t.push(`/spy/${e.project.project_id}/${a.value}`):t.push("/")}function x(){r.value&&i.showModal("minion-view",{session:r.value})}return le(()=>o.currentSessionId,g=>{if(g)e.sessions.some(b=>b.session_id===g)&&(a.value=g);else{a.value="";const b=t.currentRoute.value;b.name==="spy"&&b.params.legionId===e.project.project_id&&t.push("/")}}),(g,b)=>(d(),m("div",{class:K(["list-group-item list-group-item-action p-2",{active:u.value}])},[s("div",{class:"d-flex align-items-center justify-content-between mb-2",style:je({cursor:a.value?"pointer":"default"}),onClick:v},[b[1]||(b[1]=s("div",{class:"d-flex align-items-center"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"🔍"),s("span",{class:"fw-semibold"},"Spy"),s("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),s("div",sf,[r.value?(d(),m("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:he(x,["stop"]),title:"View minion details"}," 👁️ ")):I("",!0),r.value?(d(),m("span",{key:1,class:K(["minion-state-indicator",l.value]),style:je(p.value)}," 👤 ",6)):I("",!0)])],4),te(s("select",{"onUpdate:modelValue":b[0]||(b[0]=y=>a.value=y),class:"form-select form-select-sm",onChange:h},[b[2]||(b[2]=s("option",{value:""},"-- Select Minion --",-1)),(d(!0),m(se,null,ae(n.sessions,y=>(d(),m("option",{key:y.session_id,value:y.session_id},$(c(y))+" "+$(_(y)),9,nf))),128))],544),[[Fe,a.value]])],2))}},af=Y(of,[["__scopeId","data-v-579589fb"]]);var _e="top",Ee="bottom",Ce="right",ge="left",ns="auto",yt=[_e,Ee,Ce,ge],st="start",mt="end",ro="clippingParents",Hs="viewport",lt="popper",lo="reference",Ns=yt.reduce(function(n,e){return n.concat([e+"-"+st,e+"-"+mt])},[]),Ws=[].concat(yt,[ns]).reduce(function(n,e){return n.concat([e,e+"-"+st,e+"-"+mt])},[]),co="beforeRead",uo="read",mo="afterRead",po="beforeMain",fo="main",vo="afterMain",ho="beforeWrite",_o="write",go="afterWrite",bo=[co,uo,mo,po,fo,vo,ho,_o,go];function Le(n){return n?(n.nodeName||"").toLowerCase():null}function Se(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nt(n){var e=Se(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=Se(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Fs(n){if(typeof ShadowRoot>"u")return!1;var e=Se(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function rf(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Te(a)||!Le(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var u=i[r];u===!1?a.removeAttribute(r):a.setAttribute(r,u===!0?"":u)}))})}function lf(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),u=r.reduce(function(l,p){return l[p]="",l},{});!Te(i)||!Le(i)||(Object.assign(i.style,u),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const Us={name:"applyStyles",enabled:!0,phase:"write",fn:rf,effect:lf,requires:["computeStyles"]};function Oe(n){return n.split("-")[0]}var tt=Math.max,Qt=Math.min,pt=Math.round;function Ds(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function yo(){return!/^((?!chrome|android).)*safari/i.test(Ds())}function ft(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&pt(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&pt(o.height)/n.offsetHeight||1);var r=nt(n)?Se(n):window,u=r.visualViewport,l=!yo()&&t,p=(o.left+(l&&u?u.offsetLeft:0))/i,c=(o.top+(l&&u?u.offsetTop:0))/a,_=o.width/i,v=o.height/a;return{width:_,height:v,top:c,right:p+_,bottom:c+v,left:p,x:p,y:c}}function Bs(n){var e=ft(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function $o(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Fs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Re(n){return Se(n).getComputedStyle(n)}function cf(n){return["table","td","th"].indexOf(Le(n))>=0}function Ge(n){return((nt(n)?n.ownerDocument:n.document)||window.document).documentElement}function os(n){return Le(n)==="html"?n:n.assignedSlot||n.parentNode||(Fs(n)?n.host:null)||Ge(n)}function $n(n){return!Te(n)||Re(n).position==="fixed"?null:n.offsetParent}function uf(n){var e=/firefox/i.test(Ds()),t=/Trident/i.test(Ds());if(t&&Te(n)){var o=Re(n);if(o.position==="fixed")return null}var i=os(n);for(Fs(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Le(i))<0;){var a=Re(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Dt(n){for(var e=Se(n),t=$n(n);t&&cf(t)&&Re(t).position==="static";)t=$n(t);return t&&(Le(t)==="html"||Le(t)==="body"&&Re(t).position==="static")?e:t||uf(n)||e}function qs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function kt(n,e,t){return tt(n,Qt(e,t))}function df(n,e,t){var o=kt(n,e,t);return o>t?t:o}function wo(){return{top:0,right:0,bottom:0,left:0}}function Eo(n){return Object.assign({},wo(),n)}function Co(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var mf=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Eo(typeof e!="number"?e:Co(e,yt))};function pf(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,r=t.modifiersData.popperOffsets,u=Oe(t.placement),l=qs(u),p=[ge,Ce].indexOf(u)>=0,c=p?"height":"width";if(!(!a||!r)){var _=mf(i.padding,t),v=Bs(a),h=l==="y"?_e:ge,x=l==="y"?Ee:Ce,g=t.rects.reference[c]+t.rects.reference[l]-r[l]-t.rects.popper[c],b=r[l]-t.rects.reference[l],y=Dt(a),M=y?l==="y"?y.clientHeight||0:y.clientWidth||0:0,S=g/2-b/2,w=_[h],P=M-v[c]-_[x],j=M/2-v[c]/2+S,A=kt(w,j,P),k=l;t.modifiersData[o]=(e={},e[k]=A,e.centerOffset=A-j,e)}}function ff(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||$o(e.elements.popper,i)&&(e.elements.arrow=i))}const So={name:"arrow",enabled:!0,phase:"main",fn:pf,effect:ff,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function vt(n){return n.split("-")[1]}var vf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function hf(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:pt(t*i)/i||0,y:pt(o*i)/i||0}}function wn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,r=n.offsets,u=n.position,l=n.gpuAcceleration,p=n.adaptive,c=n.roundOffsets,_=n.isFixed,v=r.x,h=v===void 0?0:v,x=r.y,g=x===void 0?0:x,b=typeof c=="function"?c({x:h,y:g}):{x:h,y:g};h=b.x,g=b.y;var y=r.hasOwnProperty("x"),M=r.hasOwnProperty("y"),S=ge,w=_e,P=window;if(p){var j=Dt(t),A="clientHeight",k="clientWidth";if(j===Se(t)&&(j=Ge(t),Re(j).position!=="static"&&u==="absolute"&&(A="scrollHeight",k="scrollWidth")),j=j,i===_e||(i===ge||i===Ce)&&a===mt){w=Ee;var N=_&&j===P&&P.visualViewport?P.visualViewport.height:j[A];g-=N-o.height,g*=l?1:-1}if(i===ge||(i===_e||i===Ee)&&a===mt){S=Ce;var C=_&&j===P&&P.visualViewport?P.visualViewport.width:j[k];h-=C-o.width,h*=l?1:-1}}var E=Object.assign({position:u},p&&vf),T=c===!0?hf({x:h,y:g},Se(t)):{x:h,y:g};if(h=T.x,g=T.y,l){var O;return Object.assign({},E,(O={},O[w]=M?"0":"",O[S]=y?"0":"",O.transform=(P.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",O))}return Object.assign({},E,(e={},e[w]=M?g+"px":"",e[S]=y?h+"px":"",e.transform="",e))}function _f(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,r=a===void 0?!0:a,u=t.roundOffsets,l=u===void 0?!0:u,p={placement:Oe(e.placement),variation:vt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,wn(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,wn(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const zs={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:_f,data:{}};var Ht={passive:!0};function gf(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,u=r===void 0?!0:r,l=Se(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&p.forEach(function(c){c.addEventListener("scroll",t.update,Ht)}),u&&l.addEventListener("resize",t.update,Ht),function(){a&&p.forEach(function(c){c.removeEventListener("scroll",t.update,Ht)}),u&&l.removeEventListener("resize",t.update,Ht)}}const Ks={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:gf,data:{}};var bf={left:"right",right:"left",bottom:"top",top:"bottom"};function Kt(n){return n.replace(/left|right|bottom|top/g,function(e){return bf[e]})}var yf={start:"end",end:"start"};function En(n){return n.replace(/start|end/g,function(e){return yf[e]})}function Ys(n){var e=Se(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Gs(n){return ft(Ge(n)).left+Ys(n).scrollLeft}function $f(n,e){var t=Se(n),o=Ge(n),i=t.visualViewport,a=o.clientWidth,r=o.clientHeight,u=0,l=0;if(i){a=i.width,r=i.height;var p=yo();(p||!p&&e==="fixed")&&(u=i.offsetLeft,l=i.offsetTop)}return{width:a,height:r,x:u+Gs(n),y:l}}function wf(n){var e,t=Ge(n),o=Ys(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=tt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=tt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),u=-o.scrollLeft+Gs(n),l=-o.scrollTop;return Re(i||t).direction==="rtl"&&(u+=tt(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:u,y:l}}function Js(n){var e=Re(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function To(n){return["html","body","#document"].indexOf(Le(n))>=0?n.ownerDocument.body:Te(n)&&Js(n)?n:To(os(n))}function xt(n,e){var t;e===void 0&&(e=[]);var o=To(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=Se(o),r=i?[a].concat(a.visualViewport||[],Js(o)?o:[]):o,u=e.concat(r);return i?u:u.concat(xt(os(r)))}function Ls(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Ef(n,e){var t=ft(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Cn(n,e,t){return e===Hs?Ls($f(n,t)):nt(e)?Ef(e,t):Ls(wf(Ge(n)))}function Cf(n){var e=xt(os(n)),t=["absolute","fixed"].indexOf(Re(n).position)>=0,o=t&&Te(n)?Dt(n):n;return nt(o)?e.filter(function(i){return nt(i)&&$o(i,o)&&Le(i)!=="body"}):[]}function Sf(n,e,t,o){var i=e==="clippingParents"?Cf(n):[].concat(e),a=[].concat(i,[t]),r=a[0],u=a.reduce(function(l,p){var c=Cn(n,p,o);return l.top=tt(c.top,l.top),l.right=Qt(c.right,l.right),l.bottom=Qt(c.bottom,l.bottom),l.left=tt(c.left,l.left),l},Cn(n,r,o));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function ko(n){var e=n.reference,t=n.element,o=n.placement,i=o?Oe(o):null,a=o?vt(o):null,r=e.x+e.width/2-t.width/2,u=e.y+e.height/2-t.height/2,l;switch(i){case _e:l={x:r,y:e.y-t.height};break;case Ee:l={x:r,y:e.y+e.height};break;case Ce:l={x:e.x+e.width,y:u};break;case ge:l={x:e.x-t.width,y:u};break;default:l={x:e.x,y:e.y}}var p=i?qs(i):null;if(p!=null){var c=p==="y"?"height":"width";switch(a){case st:l[p]=l[p]-(e[c]/2-t[c]/2);break;case mt:l[p]=l[p]+(e[c]/2-t[c]/2);break}}return l}function ht(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,r=a===void 0?n.strategy:a,u=t.boundary,l=u===void 0?ro:u,p=t.rootBoundary,c=p===void 0?Hs:p,_=t.elementContext,v=_===void 0?lt:_,h=t.altBoundary,x=h===void 0?!1:h,g=t.padding,b=g===void 0?0:g,y=Eo(typeof b!="number"?b:Co(b,yt)),M=v===lt?lo:lt,S=n.rects.popper,w=n.elements[x?M:v],P=Sf(nt(w)?w:w.contextElement||Ge(n.elements.popper),l,c,r),j=ft(n.elements.reference),A=ko({reference:j,element:S,placement:i}),k=Ls(Object.assign({},S,A)),N=v===lt?k:j,C={top:P.top-N.top+y.top,bottom:N.bottom-P.bottom+y.bottom,left:P.left-N.left+y.left,right:N.right-P.right+y.right},E=n.modifiersData.offset;if(v===lt&&E){var T=E[i];Object.keys(C).forEach(function(O){var L=[Ce,Ee].indexOf(O)>=0?1:-1,R=[_e,Ee].indexOf(O)>=0?"y":"x";C[O]+=T[R]*L})}return C}function Tf(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,r=t.padding,u=t.flipVariations,l=t.allowedAutoPlacements,p=l===void 0?Ws:l,c=vt(o),_=c?u?Ns:Ns.filter(function(x){return vt(x)===c}):yt,v=_.filter(function(x){return p.indexOf(x)>=0});v.length===0&&(v=_);var h=v.reduce(function(x,g){return x[g]=ht(n,{placement:g,boundary:i,rootBoundary:a,padding:r})[Oe(g)],x},{});return Object.keys(h).sort(function(x,g){return h[x]-h[g]})}function kf(n){if(Oe(n)===ns)return[];var e=Kt(n);return[En(n),e,En(e)]}function xf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,u=r===void 0?!0:r,l=t.fallbackPlacements,p=t.padding,c=t.boundary,_=t.rootBoundary,v=t.altBoundary,h=t.flipVariations,x=h===void 0?!0:h,g=t.allowedAutoPlacements,b=e.options.placement,y=Oe(b),M=y===b,S=l||(M||!x?[Kt(b)]:kf(b)),w=[b].concat(S).reduce(function(B,oe){return B.concat(Oe(oe)===ns?Tf(e,{placement:oe,boundary:c,rootBoundary:_,padding:p,flipVariations:x,allowedAutoPlacements:g}):oe)},[]),P=e.rects.reference,j=e.rects.popper,A=new Map,k=!0,N=w[0],C=0;C<w.length;C++){var E=w[C],T=Oe(E),O=vt(E)===st,L=[_e,Ee].indexOf(T)>=0,R=L?"width":"height",F=ht(e,{placement:E,boundary:c,rootBoundary:_,altBoundary:v,padding:p}),U=L?O?Ce:ge:O?Ee:_e;P[R]>j[R]&&(U=Kt(U));var ne=Kt(U),re=[];if(a&&re.push(F[T]<=0),u&&re.push(F[U]<=0,F[ne]<=0),re.every(function(B){return B})){N=E,k=!1;break}A.set(E,re)}if(k)for(var ue=x?3:1,He=function(oe){var H=w.find(function(W){var q=A.get(W);if(q)return q.slice(0,oe).every(function(X){return X})});if(H)return N=H,"break"},fe=ue;fe>0;fe--){var Q=He(fe);if(Q==="break")break}e.placement!==N&&(e.modifiersData[o]._skip=!0,e.placement=N,e.reset=!0)}}const xo={name:"flip",enabled:!0,phase:"main",fn:xf,requiresIfExists:["offset"],data:{_skip:!1}};function Sn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Tn(n){return[_e,Ce,Ee,ge].some(function(e){return n[e]>=0})}function Af(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=ht(e,{elementContext:"reference"}),u=ht(e,{altBoundary:!0}),l=Sn(r,o),p=Sn(u,i,a),c=Tn(l),_=Tn(p);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:p,isReferenceHidden:c,hasPopperEscaped:_},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":_})}const Ao={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Af};function Mf(n,e,t){var o=Oe(n),i=[ge,_e].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,r=a[0],u=a[1];return r=r||0,u=(u||0)*i,[ge,Ce].indexOf(o)>=0?{x:u,y:r}:{x:r,y:u}}function Of(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,r=Ws.reduce(function(c,_){return c[_]=Mf(_,e.rects,a),c},{}),u=r[e.placement],l=u.x,p=u.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=r}const Mo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Of};function Nf(n){var e=n.state,t=n.name;e.modifiersData[t]=ko({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Xs={name:"popperOffsets",enabled:!0,phase:"read",fn:Nf,data:{}};function Df(n){return n==="x"?"y":"x"}function Lf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,u=r===void 0?!1:r,l=t.boundary,p=t.rootBoundary,c=t.altBoundary,_=t.padding,v=t.tether,h=v===void 0?!0:v,x=t.tetherOffset,g=x===void 0?0:x,b=ht(e,{boundary:l,rootBoundary:p,padding:_,altBoundary:c}),y=Oe(e.placement),M=vt(e.placement),S=!M,w=qs(y),P=Df(w),j=e.modifiersData.popperOffsets,A=e.rects.reference,k=e.rects.popper,N=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,C=typeof N=="number"?{mainAxis:N,altAxis:N}:Object.assign({mainAxis:0,altAxis:0},N),E=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,T={x:0,y:0};if(j){if(a){var O,L=w==="y"?_e:ge,R=w==="y"?Ee:Ce,F=w==="y"?"height":"width",U=j[w],ne=U+b[L],re=U-b[R],ue=h?-k[F]/2:0,He=M===st?A[F]:k[F],fe=M===st?-k[F]:-A[F],Q=e.elements.arrow,B=h&&Q?Bs(Q):{width:0,height:0},oe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:wo(),H=oe[L],W=oe[R],q=kt(0,A[F],B[F]),X=S?A[F]/2-ue-q-H-C.mainAxis:He-q-H-C.mainAxis,J=S?-A[F]/2+ue+q+W+C.mainAxis:fe+q+W+C.mainAxis,de=e.elements.arrow&&Dt(e.elements.arrow),Ct=de?w==="y"?de.clientTop||0:de.clientLeft||0:0,Rt=(O=E?.[w])!=null?O:0,li=U+X-Rt-Ct,ci=U+J-Rt,an=kt(h?Qt(ne,li):ne,U,h?tt(re,ci):re);j[w]=an,T[w]=an-U}if(u){var rn,ui=w==="x"?_e:ge,di=w==="x"?Ee:Ce,Qe=j[P],Vt=P==="y"?"height":"width",ln=Qe+b[ui],cn=Qe-b[di],ds=[_e,ge].indexOf(y)!==-1,un=(rn=E?.[P])!=null?rn:0,dn=ds?ln:Qe-A[Vt]-k[Vt]-un+C.altAxis,mn=ds?Qe+A[Vt]+k[Vt]-un-C.altAxis:cn,pn=h&&ds?df(dn,Qe,mn):kt(h?dn:ln,Qe,h?mn:cn);j[P]=pn,T[P]=pn-Qe}e.modifiersData[o]=T}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:Lf,requiresIfExists:["offset"]};function If(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Pf(n){return n===Se(n)||!Te(n)?Ys(n):If(n)}function jf(n){var e=n.getBoundingClientRect(),t=pt(e.width)/n.offsetWidth||1,o=pt(e.height)/n.offsetHeight||1;return t!==1||o!==1}function Rf(n,e,t){t===void 0&&(t=!1);var o=Te(e),i=Te(e)&&jf(e),a=Ge(e),r=ft(n,i,t),u={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(o||!o&&!t)&&((Le(e)!=="body"||Js(a))&&(u=Pf(e)),Te(e)?(l=ft(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=Gs(a))),{x:r.left+u.scrollLeft-l.x,y:r.top+u.scrollTop-l.y,width:r.width,height:r.height}}function Vf(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(u){if(!t.has(u)){var l=e.get(u);l&&i(l)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function Hf(n){var e=Vf(n);return bo.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Wf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Ff(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var kn={placement:"bottom",modifiers:[],strategy:"absolute"};function xn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function is(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?kn:i;return function(u,l,p){p===void 0&&(p=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},kn,a),modifiersData:{},elements:{reference:u,popper:l},attributes:{},styles:{}},_=[],v=!1,h={state:c,setOptions:function(y){var M=typeof y=="function"?y(c.options):y;g(),c.options=Object.assign({},a,c.options,M),c.scrollParents={reference:nt(u)?xt(u):u.contextElement?xt(u.contextElement):[],popper:xt(l)};var S=Hf(Ff([].concat(o,c.options.modifiers)));return c.orderedModifiers=S.filter(function(w){return w.enabled}),x(),h.update()},forceUpdate:function(){if(!v){var y=c.elements,M=y.reference,S=y.popper;if(xn(M,S)){c.rects={reference:Rf(M,Dt(S),c.options.strategy==="fixed"),popper:Bs(S)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(C){return c.modifiersData[C.name]=Object.assign({},C.data)});for(var w=0;w<c.orderedModifiers.length;w++){if(c.reset===!0){c.reset=!1,w=-1;continue}var P=c.orderedModifiers[w],j=P.fn,A=P.options,k=A===void 0?{}:A,N=P.name;typeof j=="function"&&(c=j({state:c,options:k,name:N,instance:h})||c)}}}},update:Wf(function(){return new Promise(function(b){h.forceUpdate(),b(c)})}),destroy:function(){g(),v=!0}};if(!xn(u,l))return h;h.setOptions(p).then(function(b){!v&&p.onFirstUpdate&&p.onFirstUpdate(b)});function x(){c.orderedModifiers.forEach(function(b){var y=b.name,M=b.options,S=M===void 0?{}:M,w=b.effect;if(typeof w=="function"){var P=w({state:c,name:y,instance:h,options:S}),j=function(){};_.push(P||j)}})}function g(){_.forEach(function(b){return b()}),_=[]}return h}}var Uf=is(),Bf=[Ks,Xs,zs,Us],qf=is({defaultModifiers:Bf}),zf=[Ks,Xs,zs,Us,Mo,xo,Oo,So,Ao],Qs=is({defaultModifiers:zf});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:vo,afterRead:mo,afterWrite:go,applyStyles:Us,arrow:So,auto:ns,basePlacements:yt,beforeMain:po,beforeRead:co,beforeWrite:ho,bottom:Ee,clippingParents:ro,computeStyles:zs,createPopper:Qs,createPopperBase:Uf,createPopperLite:qf,detectOverflow:ht,end:mt,eventListeners:Ks,flip:xo,hide:Ao,left:ge,main:fo,modifierPhases:bo,offset:Mo,placements:Ws,popper:lt,popperGenerator:is,popperOffsets:Xs,preventOverflow:Oo,read:uo,reference:lo,right:Ce,start:st,top:_e,variationPlacements:Ns,viewport:Hs,write:_o},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const We=new Map,vs={set(n,e,t){We.has(n)||We.set(n,new Map);const o=We.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return We.has(n)&&We.get(n).get(e)||null},remove(n,e){if(!We.has(n))return;const t=We.get(n);t.delete(e),t.size===0&&We.delete(n)}},Kf=1e6,Yf=1e3,Is="transitionend",Do=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Gf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Jf=n=>{do n+=Math.floor(Math.random()*Kf);while(document.getElementById(n));return n},Xf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Yf)},Lo=n=>{n.dispatchEvent(new Event(Is))},Ie=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Ue=n=>Ie(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Do(n)):null,$t=n=>{if(!Ie(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Be=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Io=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Io(n.parentNode):null},Zt=()=>{},Lt=n=>{n.offsetHeight},Po=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,hs=[],Qf=n=>{document.readyState==="loading"?(hs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of hs)e()}),hs.push(n)):n()},ke=()=>document.documentElement.dir==="rtl",Ae=n=>{Qf(()=>{const e=Po();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},ye=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,jo=(n,e,t=!0)=>{if(!t){ye(n);return}const i=Xf(e)+5;let a=!1;const r=({target:u})=>{u===e&&(a=!0,e.removeEventListener(Is,r),ye(n))};e.addEventListener(Is,r),setTimeout(()=>{a||Lo(e)},i)},Zs=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},Zf=/[^.]*(?=\..*)\.|.*/,ev=/\..*/,tv=/::\d+$/,_s={};let An=1;const Ro={mouseenter:"mouseover",mouseleave:"mouseout"},sv=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vo(n,e){return e&&`${e}::${An++}`||n.uidEvent||An++}function Ho(n){const e=Vo(n);return n.uidEvent=e,_s[e]=_s[e]||{},_s[e]}function nv(n,e){return function t(o){return en(o,{delegateTarget:n}),t.oneOff&&V.off(n,o.type,e),e.apply(n,[o])}}function ov(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const u of a)if(u===r)return en(i,{delegateTarget:r}),o.oneOff&&V.off(n,i.type,e,t),t.apply(r,[i])}}function Wo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Fo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Uo(n);return sv.has(a)||(a=n),[o,i,a]}function Mn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,r,u]=Fo(e,t,o);e in Ro&&(r=(x=>function(g){if(!g.relatedTarget||g.relatedTarget!==g.delegateTarget&&!g.delegateTarget.contains(g.relatedTarget))return x.call(this,g)})(r));const l=Ho(n),p=l[u]||(l[u]={}),c=Wo(p,r,a?t:null);if(c){c.oneOff=c.oneOff&&i;return}const _=Vo(r,e.replace(Zf,"")),v=a?ov(n,t,r):nv(n,r);v.delegationSelector=a?t:null,v.callable=r,v.oneOff=i,v.uidEvent=_,p[_]=v,n.addEventListener(u,v,a)}function Ps(n,e,t,o,i){const a=Wo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function iv(n,e,t,o){const i=e[t]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&Ps(n,e,t,r.callable,r.delegationSelector)}function Uo(n){return n=n.replace(ev,""),Ro[n]||n}const V={on(n,e,t,o){Mn(n,e,t,o,!1)},one(n,e,t,o){Mn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,r]=Fo(e,t,o),u=r!==e,l=Ho(n),p=l[r]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(p).length)return;Ps(n,l,r,a,i?t:null);return}if(c)for(const _ of Object.keys(l))iv(n,l,_,e.slice(1));for(const[_,v]of Object.entries(p)){const h=_.replace(tv,"");(!u||e.includes(h))&&Ps(n,l,r,v.callable,v.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Po(),i=Uo(e),a=e!==i;let r=null,u=!0,l=!0,p=!1;a&&o&&(r=o.Event(e,t),o(n).trigger(r),u=!r.isPropagationStopped(),l=!r.isImmediatePropagationStopped(),p=r.isDefaultPrevented());const c=en(new Event(e,{bubbles:u,cancelable:!0}),t);return p&&c.preventDefault(),l&&n.dispatchEvent(c),c.defaultPrevented&&r&&r.preventDefault(),c}};function en(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function On(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function gs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Pe={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${gs(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${gs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=On(n.dataset[o])}return e},getDataAttribute(n,e){return On(n.getAttribute(`data-bs-${gs(e)}`))}};class It{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Ie(t)?Pe.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ie(t)?Pe.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],r=Ie(a)?"element":Gf(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const av="5.3.8";class Me extends It{constructor(e,t){super(),e=Ue(e),e&&(this._element=e,this._config=this._getConfig(t),vs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){vs.remove(this._element,this.constructor.DATA_KEY),V.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){jo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return vs.get(Ue(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return av}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const bs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Do(t)).join(","):null},z={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Be(t)&&$t(t))},getSelectorFromElement(n){const e=bs(n);return e&&z.findOne(e)?e:null},getElementFromSelector(n){const e=bs(n);return e?z.findOne(e):null},getMultipleElementsFromSelector(n){const e=bs(n);return e?z.find(e):[]}},as=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;V.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Be(this))return;const a=z.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},rv="alert",lv="bs.alert",Bo=`.${lv}`,cv=`close${Bo}`,uv=`closed${Bo}`,dv="fade",mv="show";class rs extends Me{static get NAME(){return rv}close(){if(V.trigger(this._element,cv).defaultPrevented)return;this._element.classList.remove(mv);const t=this._element.classList.contains(dv);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),V.trigger(this._element,uv),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=rs.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}as(rs,"close");Ae(rs);const pv="button",fv="bs.button",vv=`.${fv}`,hv=".data-api",_v="active",Nn='[data-bs-toggle="button"]',gv=`click${vv}${hv}`;class ls extends Me{static get NAME(){return pv}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(_v))}static jQueryInterface(e){return this.each(function(){const t=ls.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}V.on(document,gv,Nn,n=>{n.preventDefault();const e=n.target.closest(Nn);ls.getOrCreateInstance(e).toggle()});Ae(ls);const bv="swipe",wt=".bs.swipe",yv=`touchstart${wt}`,$v=`touchmove${wt}`,wv=`touchend${wt}`,Ev=`pointerdown${wt}`,Cv=`pointerup${wt}`,Sv="touch",Tv="pen",kv="pointer-event",xv=40,Av={endCallback:null,leftCallback:null,rightCallback:null},Mv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class es extends It{constructor(e,t){super(),this._element=e,!(!e||!es.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Av}static get DefaultType(){return Mv}static get NAME(){return bv}dispose(){V.off(this._element,wt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),ye(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=xv)return;const t=e/this._deltaX;this._deltaX=0,t&&ye(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(V.on(this._element,Ev,e=>this._start(e)),V.on(this._element,Cv,e=>this._end(e)),this._element.classList.add(kv)):(V.on(this._element,yv,e=>this._start(e)),V.on(this._element,$v,e=>this._move(e)),V.on(this._element,wv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Tv||e.pointerType===Sv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Ov="carousel",Nv="bs.carousel",Je=`.${Nv}`,qo=".data-api",Dv="ArrowLeft",Lv="ArrowRight",Iv=500,St="next",at="prev",ct="left",Yt="right",Pv=`slide${Je}`,ys=`slid${Je}`,jv=`keydown${Je}`,Rv=`mouseenter${Je}`,Vv=`mouseleave${Je}`,Hv=`dragstart${Je}`,Wv=`load${Je}${qo}`,Fv=`click${Je}${qo}`,zo="carousel",Wt="active",Uv="slide",Bv="carousel-item-end",qv="carousel-item-start",zv="carousel-item-next",Kv="carousel-item-prev",Ko=".active",Yo=".carousel-item",Yv=Ko+Yo,Gv=".carousel-item img",Jv=".carousel-indicators",Xv="[data-bs-slide], [data-bs-slide-to]",Qv='[data-bs-ride="carousel"]',Zv={[Dv]:Yt,[Lv]:ct},eh={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},th={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Pt extends Me{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=z.findOne(Jv,this._element),this._addEventListeners(),this._config.ride===zo&&this.cycle()}static get Default(){return eh}static get DefaultType(){return th}static get NAME(){return Ov}next(){this._slide(St)}nextWhenVisible(){!document.hidden&&$t(this._element)&&this.next()}prev(){this._slide(at)}pause(){this._isSliding&&Lo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){V.one(this._element,ys,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){V.one(this._element,ys,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?St:at;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&V.on(this._element,jv,e=>this._keydown(e)),this._config.pause==="hover"&&(V.on(this._element,Rv,()=>this.pause()),V.on(this._element,Vv,()=>this._maybeEnableCycle())),this._config.touch&&es.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of z.find(Gv,this._element))V.on(o,Hv,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(ct)),rightCallback:()=>this._slide(this._directionToOrder(Yt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Iv+this._config.interval))}};this._swipeHelper=new es(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Zv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=z.findOne(Ko,this._indicatorsElement);t.classList.remove(Wt),t.removeAttribute("aria-current");const o=z.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Wt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===St,a=t||Zs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),u=h=>V.trigger(this._element,h,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(u(Pv).defaultPrevented||!o||!a)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const c=i?qv:Bv,_=i?zv:Kv;a.classList.add(_),Lt(a),o.classList.add(c),a.classList.add(c);const v=()=>{a.classList.remove(c,_),a.classList.add(Wt),o.classList.remove(Wt,_,c),this._isSliding=!1,u(ys)};this._queueCallback(v,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(Uv)}_getActive(){return z.findOne(Yv,this._element)}_getItems(){return z.find(Yo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return ke()?e===ct?at:St:e===ct?St:at}_orderToDirection(e){return ke()?e===at?ct:Yt:e===at?Yt:ct}static jQueryInterface(e){return this.each(function(){const t=Pt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(document,Fv,Xv,function(n){const e=z.getElementFromSelector(this);if(!e||!e.classList.contains(zo))return;n.preventDefault();const t=Pt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Pe.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});V.on(window,Wv,()=>{const n=z.find(Qv);for(const e of n)Pt.getOrCreateInstance(e)});Ae(Pt);const sh="collapse",nh="bs.collapse",jt=`.${nh}`,oh=".data-api",ih=`show${jt}`,ah=`shown${jt}`,rh=`hide${jt}`,lh=`hidden${jt}`,ch=`click${jt}${oh}`,$s="show",dt="collapse",Ft="collapsing",uh="collapsed",dh=`:scope .${dt} .${dt}`,mh="collapse-horizontal",ph="width",fh="height",vh=".collapse.show, .collapse.collapsing",js='[data-bs-toggle="collapse"]',hh={parent:null,toggle:!0},_h={parent:"(null|element)",toggle:"boolean"};class Nt extends Me{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=z.find(js);for(const i of o){const a=z.getSelectorFromElement(i),r=z.find(a).filter(u=>u===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return hh}static get DefaultType(){return _h}static get NAME(){return sh}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(vh).filter(u=>u!==this._element).map(u=>Nt.getOrCreateInstance(u,{toggle:!1}))),e.length&&e[0]._isTransitioning||V.trigger(this._element,ih).defaultPrevented)return;for(const u of e)u.hide();const o=this._getDimension();this._element.classList.remove(dt),this._element.classList.add(Ft),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(dt,$s),this._element.style[o]="",V.trigger(this._element,ah)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||V.trigger(this._element,rh).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Lt(this._element),this._element.classList.add(Ft),this._element.classList.remove(dt,$s);for(const i of this._triggerArray){const a=z.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(dt),V.trigger(this._element,lh)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains($s)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ue(e.parent),e}_getDimension(){return this._element.classList.contains(mh)?ph:fh}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(js);for(const t of e){const o=z.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=z.find(dh,this._config.parent);return z.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(uh,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Nt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}V.on(document,ch,js,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of z.getMultipleElementsFromSelector(this))Nt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ae(Nt);const Dn="dropdown",gh="bs.dropdown",ot=`.${gh}`,tn=".data-api",bh="Escape",Ln="Tab",yh="ArrowUp",In="ArrowDown",$h=2,wh=`hide${ot}`,Eh=`hidden${ot}`,Ch=`show${ot}`,Sh=`shown${ot}`,Go=`click${ot}${tn}`,Jo=`keydown${ot}${tn}`,Th=`keyup${ot}${tn}`,ut="show",kh="dropup",xh="dropend",Ah="dropstart",Mh="dropup-center",Oh="dropdown-center",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Nh=`${Ze}.${ut}`,Gt=".dropdown-menu",Dh=".navbar",Lh=".navbar-nav",Ih=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Ph=ke()?"top-end":"top-start",jh=ke()?"top-start":"top-end",Rh=ke()?"bottom-end":"bottom-start",Vh=ke()?"bottom-start":"bottom-end",Hh=ke()?"left-start":"right-start",Wh=ke()?"right-start":"left-start",Fh="top",Uh="bottom",Bh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},qh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ne extends Me{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=z.next(this._element,Gt)[0]||z.prev(this._element,Gt)[0]||z.findOne(Gt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Bh}static get DefaultType(){return qh}static get NAME(){return Dn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Be(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!V.trigger(this._element,Ch,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Lh))for(const o of[].concat(...document.body.children))V.on(o,"mouseover",Zt);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ut),this._element.classList.add(ut),V.trigger(this._element,Sh,e)}}hide(){if(Be(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!V.trigger(this._element,wh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))V.off(o,"mouseover",Zt);this._popper&&this._popper.destroy(),this._menu.classList.remove(ut),this._element.classList.remove(ut),this._element.setAttribute("aria-expanded","false"),Pe.removeDataAttribute(this._menu,"popper"),V.trigger(this._element,Eh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ie(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Dn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ie(this._config.reference)?e=Ue(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Qs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(ut)}_getPlacement(){const e=this._parent;if(e.classList.contains(xh))return Hh;if(e.classList.contains(Ah))return Wh;if(e.classList.contains(Mh))return Fh;if(e.classList.contains(Oh))return Uh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(kh)?t?jh:Ph:t?Vh:Rh}_detectNavbar(){return this._element.closest(Dh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Pe.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...ye(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=z.find(Ih,this._menu).filter(i=>$t(i));o.length&&Zs(o,t,e===In,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ne.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===$h||e.type==="keyup"&&e.key!==Ln)return;const t=z.find(Nh);for(const o of t){const i=Ne.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Ln||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const u={relatedTarget:i._element};e.type==="click"&&(u.clickEvent=e),i._completeHide(u)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===bh,i=[yh,In].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(Ze)?this:z.prev(this,Ze)[0]||z.next(this,Ze)[0]||z.findOne(Ze,e.delegateTarget.parentNode),r=Ne.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}V.on(document,Jo,Ze,Ne.dataApiKeydownHandler);V.on(document,Jo,Gt,Ne.dataApiKeydownHandler);V.on(document,Go,Ne.clearMenus);V.on(document,Th,Ne.clearMenus);V.on(document,Go,Ze,function(n){n.preventDefault(),Ne.getOrCreateInstance(this).toggle()});Ae(Ne);const Xo="backdrop",zh="fade",Pn="show",jn=`mousedown.bs.${Xo}`,Kh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Yh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Qo extends It{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Kh}static get DefaultType(){return Yh}static get NAME(){return Xo}show(e){if(!this._config.isVisible){ye(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Lt(t),t.classList.add(Pn),this._emulateAnimation(()=>{ye(e)})}hide(e){if(!this._config.isVisible){ye(e);return}this._getElement().classList.remove(Pn),this._emulateAnimation(()=>{this.dispose(),ye(e)})}dispose(){this._isAppended&&(V.off(this._element,jn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(zh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ue(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),V.on(e,jn,()=>{ye(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){jo(e,this._getElement(),this._config.isAnimated)}}const Gh="focustrap",Jh="bs.focustrap",ts=`.${Jh}`,Xh=`focusin${ts}`,Qh=`keydown.tab${ts}`,Zh="Tab",e_="forward",Rn="backward",t_={autofocus:!0,trapElement:null},s_={autofocus:"boolean",trapElement:"element"};class Zo extends It{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return t_}static get DefaultType(){return s_}static get NAME(){return Gh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),V.off(document,ts),V.on(document,Xh,e=>this._handleFocusin(e)),V.on(document,Qh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,V.off(document,ts))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=z.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Rn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Zh&&(this._lastTabNavDirection=e.shiftKey?Rn:e_)}}const Vn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Hn=".sticky-top",Ut="padding-right",Wn="margin-right";class Rs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ut,t=>t+e),this._setElementAttributes(Vn,Ut,t=>t+e),this._setElementAttributes(Hn,Wn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ut),this._resetElementAttributes(Vn,Ut),this._resetElementAttributes(Hn,Wn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const u=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(u))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Pe.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=Pe.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}Pe.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Ie(e)){t(e);return}for(const o of z.find(e,this._element))t(o)}}const n_="modal",o_="bs.modal",xe=`.${o_}`,i_=".data-api",a_="Escape",r_=`hide${xe}`,l_=`hidePrevented${xe}`,ei=`hidden${xe}`,ti=`show${xe}`,c_=`shown${xe}`,u_=`resize${xe}`,d_=`click.dismiss${xe}`,m_=`mousedown.dismiss${xe}`,p_=`keydown.dismiss${xe}`,f_=`click${xe}${i_}`,Fn="modal-open",v_="fade",Un="show",ws="modal-static",h_=".modal.show",__=".modal-dialog",g_=".modal-body",b_='[data-bs-toggle="modal"]',y_={backdrop:!0,focus:!0,keyboard:!0},$_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class qe extends Me{constructor(e,t){super(e,t),this._dialog=z.findOne(__,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Rs,this._addEventListeners()}static get Default(){return y_}static get DefaultType(){return $_}static get NAME(){return n_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||V.trigger(this._element,ti,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Fn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||V.trigger(this._element,r_).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Un),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){V.off(window,xe),V.off(this._dialog,xe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Qo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=z.findOne(g_,this._dialog);t&&(t.scrollTop=0),Lt(this._element),this._element.classList.add(Un);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,V.trigger(this._element,c_,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){V.on(this._element,p_,e=>{if(e.key===a_){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),V.on(window,u_,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),V.on(this._element,m_,e=>{V.one(this._element,d_,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Fn),this._resetAdjustments(),this._scrollBar.reset(),V.trigger(this._element,ei)})}_isAnimated(){return this._element.classList.contains(v_)}_triggerBackdropTransition(){if(V.trigger(this._element,l_).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(ws)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(ws),this._queueCallback(()=>{this._element.classList.remove(ws),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=ke()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=ke()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}V.on(document,f_,b_,function(n){const e=z.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),V.one(e,ti,i=>{i.defaultPrevented||V.one(e,ei,()=>{$t(this)&&this.focus()})});const t=z.findOne(h_);t&&qe.getInstance(t).hide(),qe.getOrCreateInstance(e).toggle(this)});as(qe);Ae(qe);const w_="offcanvas",E_="bs.offcanvas",Ve=`.${E_}`,si=".data-api",C_=`load${Ve}${si}`,S_="Escape",Bn="show",qn="showing",zn="hiding",T_="offcanvas-backdrop",ni=".offcanvas.show",k_=`show${Ve}`,x_=`shown${Ve}`,A_=`hide${Ve}`,Kn=`hidePrevented${Ve}`,oi=`hidden${Ve}`,M_=`resize${Ve}`,O_=`click${Ve}${si}`,N_=`keydown.dismiss${Ve}`,D_='[data-bs-toggle="offcanvas"]',L_={backdrop:!0,keyboard:!0,scroll:!1},I_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ze extends Me{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return L_}static get DefaultType(){return I_}static get NAME(){return w_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||V.trigger(this._element,k_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Rs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(qn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Bn),this._element.classList.remove(qn),V.trigger(this._element,x_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||V.trigger(this._element,A_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(zn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Bn,zn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Rs().reset(),V.trigger(this._element,oi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){V.trigger(this._element,Kn);return}this.hide()},t=!!this._config.backdrop;return new Qo({className:T_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_addEventListeners(){V.on(this._element,N_,e=>{if(e.key===S_){if(this._config.keyboard){this.hide();return}V.trigger(this._element,Kn)}})}static jQueryInterface(e){return this.each(function(){const t=ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}V.on(document,O_,D_,function(n){const e=z.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Be(this))return;V.one(e,oi,()=>{$t(this)&&this.focus()});const t=z.findOne(ni);t&&t!==e&&ze.getInstance(t).hide(),ze.getOrCreateInstance(e).toggle(this)});V.on(window,C_,()=>{for(const n of z.find(ni))ze.getOrCreateInstance(n).show()});V.on(window,M_,()=>{for(const n of z.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&ze.getOrCreateInstance(n).hide()});as(ze);Ae(ze);const P_=/^aria-[\w-]*$/i,ii={"*":["class","dir","id","lang","role",P_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},j_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),R_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,V_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?j_.has(t)?!!R_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function H_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const u=r.nodeName.toLowerCase();if(!Object.keys(e).includes(u)){r.remove();continue}const l=[].concat(...r.attributes),p=[].concat(e["*"]||[],e[u]||[]);for(const c of l)V_(c,p)||r.removeAttribute(c.nodeName)}return i.body.innerHTML}const W_="TemplateFactory",F_={allowList:ii,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},U_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},B_={entry:"(string|element|function|null)",selector:"(string|element)"};class q_ extends It{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return F_}static get DefaultType(){return U_}static get NAME(){return W_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},B_)}_setContent(e,t,o){const i=z.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Ie(t)){this._putElementInTemplate(Ue(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?H_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return ye(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const z_="tooltip",K_=new Set(["sanitize","allowList","sanitizeFn"]),Es="fade",Y_="modal",Bt="show",G_=".tooltip-inner",Yn=`.${Y_}`,Gn="hide.bs.modal",Tt="hover",Cs="focus",Ss="click",J_="manual",X_="hide",Q_="hidden",Z_="show",eg="shown",tg="inserted",sg="click",ng="focusin",og="focusout",ig="mouseenter",ag="mouseleave",rg={AUTO:"auto",TOP:"top",RIGHT:ke()?"left":"right",BOTTOM:"bottom",LEFT:ke()?"right":"left"},lg={allowList:ii,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},cg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Et extends Me{constructor(e,t){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return lg}static get DefaultType(){return cg}static get NAME(){return z_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),V.off(this._element.closest(Yn),Gn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=V.trigger(this._element,this.constructor.eventName(Z_)),o=(Io(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),V.trigger(this._element,this.constructor.eventName(tg))),this._popper=this._createPopper(i),i.classList.add(Bt),"ontouchstart"in document.documentElement)for(const u of[].concat(...document.body.children))V.on(u,"mouseover",Zt);const r=()=>{V.trigger(this._element,this.constructor.eventName(eg)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||V.trigger(this._element,this.constructor.eventName(X_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Bt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))V.off(i,"mouseover",Zt);this._activeTrigger[Ss]=!1,this._activeTrigger[Cs]=!1,this._activeTrigger[Tt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),V.trigger(this._element,this.constructor.eventName(Q_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Es,Bt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Jf(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Es),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new q_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[G_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Es)}_isShown(){return this.tip&&this.tip.classList.contains(Bt)}_createPopper(e){const t=ye(this._config.placement,[this,e,this._element]),o=rg[t.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return ye(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...ye(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")V.on(this._element,this.constructor.eventName(sg),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ss]=!(i._isShown()&&i._activeTrigger[Ss]),i.toggle()});else if(t!==J_){const o=t===Tt?this.constructor.eventName(ig):this.constructor.eventName(ng),i=t===Tt?this.constructor.eventName(ag):this.constructor.eventName(og);V.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?Cs:Tt]=!0,r._enter()}),V.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?Cs:Tt]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},V.on(this._element.closest(Yn),Gn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Pe.getDataAttributes(this._element);for(const o of Object.keys(t))K_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ue(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Et.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ae(Et);const ug="popover",dg=".popover-header",mg=".popover-body",pg={...Et.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},fg={...Et.DefaultType,content:"(null|string|element|function)"};class sn extends Et{static get Default(){return pg}static get DefaultType(){return fg}static get NAME(){return ug}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[dg]:this._getTitle(),[mg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ae(sn);const vg="scrollspy",hg="bs.scrollspy",nn=`.${hg}`,_g=".data-api",gg=`activate${nn}`,Jn=`click${nn}`,bg=`load${nn}${_g}`,yg="dropdown-item",rt="active",$g='[data-bs-spy="scroll"]',Ts="[href]",wg=".nav, .list-group",Xn=".nav-link",Eg=".nav-item",Cg=".list-group-item",Sg=`${Xn}, ${Eg} > ${Xn}, ${Cg}`,Tg=".dropdown",kg=".dropdown-toggle",xg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Ag={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class cs extends Me{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return xg}static get DefaultType(){return Ag}static get NAME(){return vg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ue(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(V.off(this._config.target,Jn),V.on(this._config.target,Jn,Ts,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const u=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&u){if(o(r),!i)return;continue}!a&&!u&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=z.find(Ts,this._config.target);for(const t of e){if(!t.hash||Be(t))continue;const o=z.findOne(decodeURI(t.hash),this._element);$t(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(rt),this._activateParents(e),V.trigger(this._element,gg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(yg)){z.findOne(kg,e.closest(Tg)).classList.add(rt);return}for(const t of z.parents(e,wg))for(const o of z.prev(t,Sg))o.classList.add(rt)}_clearActiveClass(e){e.classList.remove(rt);const t=z.find(`${Ts}.${rt}`,e);for(const o of t)o.classList.remove(rt)}static jQueryInterface(e){return this.each(function(){const t=cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(window,bg,()=>{for(const n of z.find($g))cs.getOrCreateInstance(n)});Ae(cs);const Mg="tab",Og="bs.tab",it=`.${Og}`,Ng=`hide${it}`,Dg=`hidden${it}`,Lg=`show${it}`,Ig=`shown${it}`,Pg=`click${it}`,jg=`keydown${it}`,Rg=`load${it}`,Vg="ArrowLeft",Qn="ArrowRight",Hg="ArrowUp",Zn="ArrowDown",ks="Home",eo="End",et="active",to="fade",xs="show",Wg="dropdown",ai=".dropdown-toggle",Fg=".dropdown-menu",As=`:not(${ai})`,Ug='.list-group, .nav, [role="tablist"]',Bg=".nav-item, .list-group-item",qg=`.nav-link${As}, .list-group-item${As}, [role="tab"]${As}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ms=`${qg}, ${ri}`,zg=`.${et}[data-bs-toggle="tab"], .${et}[data-bs-toggle="pill"], .${et}[data-bs-toggle="list"]`;class _t extends Me{constructor(e){super(e),this._parent=this._element.closest(Ug),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),V.on(this._element,jg,t=>this._keydown(t)))}static get NAME(){return Mg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?V.trigger(t,Ng,{relatedTarget:e}):null;V.trigger(e,Lg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(et),this._activate(z.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(xs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),V.trigger(e,Ig,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(to))}_deactivate(e,t){if(!e)return;e.classList.remove(et),e.blur(),this._deactivate(z.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(xs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),V.trigger(e,Dg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(to))}_keydown(e){if(![Vg,Qn,Hg,Zn,ks,eo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Be(i));let o;if([ks,eo].includes(e.key))o=t[e.key===ks?0:t.length-1];else{const i=[Qn,Zn].includes(e.key);o=Zs(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),_t.getOrCreateInstance(o).show())}_getChildren(){return z.find(Ms,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=z.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(Wg))return;const i=(a,r)=>{const u=z.findOne(a,o);u&&u.classList.toggle(r,t)};i(ai,et),i(Fg,xs),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(et)}_getInnerElement(e){return e.matches(Ms)?e:z.findOne(Ms,e)}_getOuterElement(e){return e.closest(Bg)||e}static jQueryInterface(e){return this.each(function(){const t=_t.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(document,Pg,ri,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Be(this)&&_t.getOrCreateInstance(this).show()});V.on(window,Rg,()=>{for(const n of z.find(zg))_t.getOrCreateInstance(n)});Ae(_t);const Kg="toast",Yg="bs.toast",Xe=`.${Yg}`,Gg=`mouseover${Xe}`,Jg=`mouseout${Xe}`,Xg=`focusin${Xe}`,Qg=`focusout${Xe}`,Zg=`hide${Xe}`,eb=`hidden${Xe}`,tb=`show${Xe}`,sb=`shown${Xe}`,nb="fade",so="hide",qt="show",zt="showing",ob={animation:"boolean",autohide:"boolean",delay:"number"},ib={animation:!0,autohide:!0,delay:5e3};class us extends Me{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return ib}static get DefaultType(){return ob}static get NAME(){return Kg}show(){if(V.trigger(this._element,tb).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(nb);const t=()=>{this._element.classList.remove(zt),V.trigger(this._element,sb),this._maybeScheduleHide()};this._element.classList.remove(so),Lt(this._element),this._element.classList.add(qt,zt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||V.trigger(this._element,Zg).defaultPrevented)return;const t=()=>{this._element.classList.add(so),this._element.classList.remove(zt,qt),V.trigger(this._element,eb)};this._element.classList.add(zt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(qt),super.dispose()}isShown(){return this._element.classList.contains(qt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){V.on(this._element,Gg,e=>this._onInteraction(e,!0)),V.on(this._element,Jg,e=>this._onInteraction(e,!1)),V.on(this._element,Xg,e=>this._onInteraction(e,!0)),V.on(this._element,Qg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=us.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}as(us);Ae(us);const ab={class:"modal-dialog modal-dialog-centered"},rb={class:"modal-content"},lb={class:"modal-body"},cb={key:0,class:"alert alert-danger"},ub={class:"mb-3"},db={class:"mb-3"},mb={class:"form-text"},pb={class:"mb-3"},fb={class:"mb-3"},vb=["value"],hb={class:"modal-footer"},_b=["disabled"],gb={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=ee(),r=D(null),u=D(null),l=D(""),p=D(!1),c=D({name:"",purpose:"",description:"",member_minion_ids:[]}),_=f(()=>{const b=[];for(const[y,M]of a.sessions.entries())M.is_minion&&M.project_id===o.legionId&&b.push(M);return b}),v=f(()=>c.value.name.trim()!==""&&c.value.purpose.trim()!==""),h=async()=>{if(!v.value){l.value="Name and purpose are required";return}p.value=!0,l.value="";try{const b=await Z.post(`/api/legions/${o.legionId}/channels`,{name:c.value.name.trim(),purpose:c.value.purpose.trim(),description:c.value.description.trim()||"",member_minion_ids:c.value.member_minion_ids});i("created",b.channel),u.value?.hide(),c.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(b){console.error("Failed to create channel:",b),l.value=b.response?.data?.detail||"Failed to create channel"}finally{p.value=!1}},x=()=>{u.value?.show()},g=()=>{u.value?.hide()};return pe(()=>{r.value&&(u.value=new qe(r.value))}),be(()=>{u.value?.dispose()}),e({show:x,hide:g}),(b,y)=>(d(),we(io,{to:"body"},[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[s("div",ab,[s("div",rb,[y[11]||(y[11]=s("div",{class:"modal-header"},[s("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",lb,[l.value?(d(),m("div",cb,$(l.value),1)):I("",!0),s("form",{onSubmit:he(h,["prevent"])},[s("div",ub,[y[4]||(y[4]=s("label",{for:"channel-name",class:"form-label"},[G(" Channel Name "),s("span",{class:"text-danger"},"*")],-1)),te(s("input",{id:"channel-name","onUpdate:modelValue":y[0]||(y[0]=M=>c.value.name=M),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[me,c.value.name]]),y[5]||(y[5]=s("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),s("div",db,[y[6]||(y[6]=s("label",{for:"channel-purpose",class:"form-label"},[G(" Purpose "),s("span",{class:"text-danger"},"*")],-1)),te(s("textarea",{id:"channel-purpose","onUpdate:modelValue":y[1]||(y[1]=M=>c.value.purpose=M),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[me,c.value.purpose]]),s("div",mb,$(c.value.purpose.length)+" / 500 characters",1)]),s("div",pb,[y[7]||(y[7]=s("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),te(s("textarea",{id:"channel-description","onUpdate:modelValue":y[2]||(y[2]=M=>c.value.description=M),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[me,c.value.description]])]),s("div",fb,[y[8]||(y[8]=s("label",{class:"form-label"},"Initial Members (Optional)",-1)),te(s("select",{"onUpdate:modelValue":y[3]||(y[3]=M=>c.value.member_minion_ids=M),multiple:"",class:"form-select",size:"5"},[(d(!0),m(se,null,ae(_.value,M=>(d(),m("option",{key:M.session_id,value:M.session_id},$(M.name)+$(M.role?` (${M.role})`:""),9,vb))),128))],512),[[Fe,c.value.member_minion_ids]]),y[9]||(y[9]=s("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),s("div",hb,[y[10]||(y[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:p.value||!v.value},$(p.value?"Creating...":"Create Channel"),9,_b)])])])],512)]))}},bb=Y(gb,[["__scopeId","data-v-573f4c01"]]),yb={class:"modal-dialog modal-dialog-centered"},$b={class:"modal-content"},wb={class:"modal-body"},Eb={key:0,class:"alert alert-danger"},Cb={class:"text-muted"},Sb={class:"modal-footer"},Tb=["disabled"],kb={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=D(null),r=D(null),u=D(""),l=D(!1),p=f(()=>o.channel?.member_minion_ids?.length||0),c=async()=>{if(!o.channel){u.value="No channel selected";return}l.value=!0,u.value="";try{await Z.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),i("deleted",o.channel.channel_id),r.value?.hide()}catch(h){console.error("Failed to delete channel:",h),u.value=h.data?.detail||h.message||"Failed to delete channel"}finally{l.value=!1}},_=()=>{u.value="",r.value?.show()},v=()=>{r.value?.hide()};return pe(()=>{a.value&&(r.value=new qe(a.value))}),be(()=>{r.value?.dispose()}),e({show:_,hide:v}),(h,x)=>(d(),we(io,{to:"body"},[s("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[s("div",yb,[s("div",$b,[x[4]||(x[4]=s("div",{class:"modal-header"},[s("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",wb,[u.value?(d(),m("div",Eb,$(u.value),1)):I("",!0),x[2]||(x[2]=s("div",{class:"alert alert-warning"},[s("strong",null,"⚠️ Warning:"),G(" This action cannot be undone. ")],-1)),s("p",null,[x[0]||(x[0]=G("Are you sure you want to delete ",-1)),s("strong",null,$(n.channel?.name),1),x[1]||(x[1]=G("?",-1))]),s("p",Cb," This channel has "+$(p.value)+" "+$(p.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),s("div",Sb,[x[3]||(x[3]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-danger",onClick:c,disabled:l.value},$(l.value?"Deleting...":"Delete Channel"),9,Tb)])])])],512)]))}},xb={class:"accordion mt-2",id:"channelsAccordion"},Ab={class:"accordion-item"},Mb={class:"accordion-header"},Ob={class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#channelsCollapsePanel","aria-expanded":"false","aria-controls":"channelsCollapsePanel"},Nb={class:"text-muted ms-2"},Db={id:"channelsCollapsePanel",class:"accordion-collapse collapse","data-bs-parent":"#channelsAccordion"},Lb={class:"accordion-body p-0"},Ib={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},Pb={key:1,class:"list-group list-group-flush"},jb={class:"d-flex align-items-center justify-content-between"},Rb=["onClick"],Vb={class:"channel-name"},Hb={class:"d-flex align-items-center gap-2"},Wb={class:"badge bg-secondary member-count"},Fb=["onClick"],Ub={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ke(),o=bt(),i=D(null),a=D(null),r=D(null),u=f(()=>o.channelsByLegion.get(e.project.project_id)||[]),l=f(()=>u.value.length);function p(x){t.push(`/channel/${e.project.project_id}/${x}`)}function c(){i.value?.show()}function _(x){r.value=x,a.value?.show()}function v(x){o.loadChannels(e.project.project_id)}function h(x){const b=(o.channelsByLegion.get(e.project.project_id)||[]).filter(y=>y.channel_id!==x);o.channelsByLegion.set(e.project.project_id,b),t.currentRoute.value.path.includes(x)&&t.push(`/timeline/${e.project.project_id}`)}return pe(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(x){console.error("Failed to load channels:",x)}}),(x,g)=>(d(),m(se,null,[s("div",xb,[s("div",Ab,[s("h2",Mb,[s("button",Ob,[g[0]||(g[0]=s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"💬",-1)),g[1]||(g[1]=s("span",{class:"fw-semibold"},"Channels",-1)),s("small",Nb,"("+$(l.value)+")",1)])]),s("div",Db,[s("div",Lb,[s("div",{class:"p-2 border-bottom"},[s("button",{class:"btn btn-sm btn-primary w-100",onClick:c}," + New Channel ")]),u.value.length===0?(d(),m("div",Ib,' No channels yet. Click "New Channel" to create one. ')):(d(),m("div",Pb,[(d(!0),m(se,null,ae(u.value,b=>(d(),m("div",{key:b.channel_id,class:"list-group-item list-group-item-action channel-item"},[s("div",jb,[s("div",{class:"d-flex align-items-center flex-grow-1",onClick:y=>p(b.channel_id)},[g[2]||(g[2]=s("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"💬",-1)),s("span",Vb,$(b.name),1)],8,Rb),s("div",Hb,[s("span",Wb,$(b.member_minion_ids?.length||0),1),s("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:he(y=>_(b),["stop"]),title:"Delete channel",style:{"font-size":"1.1rem","line-height":"1"}}," 🗑️ ",8,Fb)])])]))),128))]))])])])]),ie(bb,{ref_key:"createModal",ref:i,"legion-id":n.project.project_id,onCreated:v},null,8,["legion-id"]),ie(kb,{ref_key:"deleteModal",ref:a,"legion-id":n.project.project_id,channel:r.value,onDeleted:h},null,8,["legion-id","channel"])],64))}},Bb=Y(Ub,[["__scopeId","data-v-3887d5f8"]]),qb=["data-project-id"],zb=["id"],Kb=["aria-expanded","aria-controls","onKeydown"],Yb={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Gb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Jb={class:"fw-semibold",style:{"flex-shrink":"0"}},Xb={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Qb={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Zb=["title"],ey=["title"],ty=["id","aria-labelledby"],sy={class:"accordion-body p-0"},ny={class:"list-group list-group-flush"},oy={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ke(),o=ve(),i=ee(),a=ce(),r=D(e.project.is_expanded||!1),u=f(()=>o.formatPath(e.project.working_directory)),l=f(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(j=>i.getSession(j)).filter(j=>j!=null)),p=f(()=>{const j=t.currentRoute.value;return j.name==="timeline"&&j.params.legionId===e.project.project_id}),c=f(()=>{const j=t.currentRoute.value;return j.name==="horde"&&j.params.legionId===e.project.project_id});function _(j){const A=window.bootstrap;if(!A)return;const k=document.getElementById(`collapse-${e.project.project_id}`);if(!k)return;A.Collapse.getOrCreateInstance(k).toggle()}function v(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function h(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const j=i.currentSessionId;j&&i.getSession(j)&&e.project.session_ids?.includes(j)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function x(){a.showModal("edit-project",{project:e.project})}function g(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function b(){t.push(`/timeline/${e.project.project_id}`)}function y(){t.push(`/horde/${e.project.project_id}`)}function M(j){j.dataTransfer.effectAllowed="move",j.dataTransfer.setData("application/project-id",e.project.project_id),j.dataTransfer.setData("text/plain",e.project.project_id),j.target.classList.add("dragging")}function S(j){j.target.classList.remove("dragging")}function w(j){j.preventDefault(),j.dataTransfer.dropEffect="move";const A=j.currentTarget.getBoundingClientRect(),k=A.top+A.height/2;j.clientY<k?(j.currentTarget.classList.add("drop-above"),j.currentTarget.classList.remove("drop-below")):(j.currentTarget.classList.add("drop-below"),j.currentTarget.classList.remove("drop-above"))}function P(j){j.preventDefault(),j.currentTarget.classList.remove("drop-above","drop-below");const A=j.dataTransfer.getData("application/project-id")||j.dataTransfer.getData("text/plain");if(!A||A===e.project.project_id)return;const k=j.currentTarget.getBoundingClientRect(),N=k.top+k.height/2,C=j.clientY<N,E=o.orderedProjects,T=E.findIndex(ne=>ne.project_id===e.project.project_id),O=E.findIndex(ne=>ne.project_id===A);if(T===-1||O===-1)return;const L=[...E],[R]=L.splice(O,1);let F=C?T:T+1;O<T&&F--,L.splice(F,0,R);const U=L.map(ne=>ne.project_id);o.reorderProjects(U)}return(j,A)=>(d(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:M,onDragend:S,onDragover:w,onDrop:P},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:K(["accordion-button bg-white p-2",{collapsed:!r.value}]),role:"button",tabindex:"0","aria-expanded":r.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:_,onKeydown:[Xt(he(_,["prevent"]),["enter"]),Xt(he(_,["prevent"]),["space"])]},[s("div",Yb,[s("div",Gb,[s("div",Jb,[n.project.is_multi_agent?(d(),m("span",Xb,"🏛")):I("",!0),G(" "+$(n.project.name),1)]),s("div",Qb,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:he(x,["stop"])}," ✏️ "),s("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:he(g,["stop"])}," ➕ ",8,Zb)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(u.value),9,ey)])],42,Kb)],8,zb),ie(Xp,{project:n.project,sessions:l.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:K(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:v,onHidden:h},[s("div",sy,[s("div",ny,[n.project.is_multi_agent?(d(),m("div",{key:0,class:K(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:p.value}]),style:{cursor:"pointer"},onClick:b},[...A[0]||(A[0]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"📊"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):I("",!0),n.project.is_multi_agent?(d(),m(se,{key:1},[s("div",{class:K(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:c.value}]),style:{cursor:"pointer"},onClick:y},[...A[1]||(A[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"🌳"),s("span",{class:"fw-semibold"},"Horde"),s("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),ie(af,{project:n.project,sessions:l.value},null,8,["project","sessions"]),ie(Bb,{project:n.project},null,8,["project"])],64)):(d(!0),m(se,{key:2},ae(l.value,k=>(d(),we(tf,{key:k.session_id,session:k,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,ty)],40,qb))}},iy=Y(oy,[["__scopeId","data-v-04f4e534"]]),ay={class:"project-list"},ry={key:0,class:"text-muted text-center py-3"},ly={__name:"ProjectList",setup(n){const e=ve(),t=f(()=>e.orderedProjects);return(o,i)=>(d(),m("div",ay,[t.value.length===0?(d(),m("div",ry,' No projects yet. Click "New" to create one. ')):I("",!0),(d(!0),m(se,null,ae(t.value,a=>(d(),we(iy,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},cy={class:"flex-grow-1 overflow-auto p-3"},uy={id:"sessions-container"},dy={__name:"Sidebar",setup(n){const e=ce(),t=f(()=>e.sidebarCollapsed),o=f(()=>e.isMobile),i=f(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const r=D(!1);function u(c){r.value=!0,document.addEventListener("mousemove",l),document.addEventListener("mouseup",p)}function l(c){r.value&&e.setSidebarWidth(c.clientX)}function p(){r.value=!1,document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",p)}return(c,_)=>(d(),m("aside",{id:"sidebar",class:K(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:je(i.value)},[s("div",cy,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[_[0]||(_[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," 📁 New ")]),s("div",uy,[ie(ly)])]),s("div",{class:"sidebar-resize-handle",onMousedown:u},null,32)],6))}},my=Y(dy,[["__scopeId","data-v-d792f0f0"]]),py={class:"modal-dialog modal-lg"},fy={class:"modal-content"},vy={class:"modal-body"},hy={class:"mb-3"},_y={class:"input-group"},gy=["disabled"],by={key:0,class:"text-center py-4"},yy={key:1,class:"alert alert-danger",role:"alert"},$y={key:2,class:"folder-list"},wy=["onClick","onDblclick"],Ey={class:"d-flex align-items-center flex-grow-1"},Cy=["onClick"],Sy={key:1,class:"text-center text-muted py-3"},Ty={class:"modal-footer"},ky=["disabled"],xy={__name:"FolderBrowserModal",setup(n){const e=ce(),t=D(""),o=D(""),i=D([]),a=D(!1),r=D(""),u=D(null);let l=null,p=null;const c=f(()=>{if(!t.value)return null;const S=t.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?S.join("/"):"/")});function _(S){if(!S)return"";const w=S.split(/[\\/]/).filter(Boolean);return w.length<=2?S:".../"+w.slice(-2).join("/")}async function v(){a.value=!0,r.value="",i.value=[],o.value="";try{const S=t.value?{path:t.value}:{},w=await Z.get("/api/filesystem/browse",{params:S});w.current_path&&(t.value=w.current_path),i.value=w.directories||[]}catch(S){console.error("Failed to load directory:",S),r.value=S.message||"Failed to load directory"}finally{a.value=!1}}function h(S){o.value=S.path}function x(S){t.value=S.path,o.value="",v()}function g(){c.value&&(t.value=c.value,o.value="",v())}function b(){const S=o.value||t.value;S&&p&&p(S),l&&l.hide()}function y(){v()}function M(){i.value=[],o.value="",r.value="",p=null,e.hideModal()}return le(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&l){const w=S.data||{};t.value=w.currentPath||"",p=w.onSelect||null,l.show()}}),pe(()=>{u.value&&$e(async()=>{const{default:S}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{l=new S(u.value),u.value.addEventListener("shown.bs.modal",y),u.value.addEventListener("hidden.bs.modal",M)})}),be(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",y),u.value.removeEventListener("hidden.bs.modal",M)),l&&l.dispose()}),(S,w)=>(d(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",py,[s("div",fy,[w[7]||(w[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",vy,[s("div",hy,[w[2]||(w[2]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",_y,[te(s("input",{type:"text",class:"form-control","onUpdate:modelValue":w[0]||(w[0]=P=>t.value=P),onKeyup:Xt(v,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[me,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:v,disabled:a.value},[...w[1]||(w[1]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1),G(" Refresh ",-1)])],8,gy)])]),a.value?(d(),m("div",by,[...w[3]||(w[3]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(d(),m("div",yy,$(r.value),1)):(d(),m("div",$y,[c.value?(d(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:g,role:"button"},[...w[4]||(w[4]=[s("i",{class:"bi bi-arrow-up-circle me-2 text-secondary"},null,-1),s("span",{class:"text-secondary"},"..",-1)])])):I("",!0),(d(!0),m(se,null,ae(i.value,P=>(d(),m("div",{key:P.path,class:K(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:P.path===o.value}]),onClick:j=>h(P),onDblclick:j=>x(P),role:"button"},[s("div",Ey,[w[5]||(w[5]=s("i",{class:"bi bi-folder-fill me-2 text-warning"},null,-1)),s("span",null,$(P.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:he(j=>x(P),["stop"])}," Open ",8,Cy)],42,wy))),128)),i.value.length===0?(d(),m("div",Sy," No subdirectories found ")):I("",!0)]))]),s("div",Ty,[w[6]||(w[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:!o.value},' Select "'+$(_(o.value||t.value))+'" ',9,ky)])])])],512))}},Ay=Y(xy,[["__scopeId","data-v-667c51a9"]]),My={class:"modal-dialog"},Oy={class:"modal-content"},Ny={class:"modal-body"},Dy={class:"mb-3"},Ly={key:0,class:"invalid-feedback"},Iy={class:"mb-3"},Py={class:"input-group"},jy={key:0,class:"invalid-feedback"},Ry={class:"mb-3 form-check"},Vy={class:"mb-3 form-check"},Hy={class:"form-check-label",for:"createSession"},Wy={key:0,class:"mb-3 ms-4"},Fy={for:"sessionName",class:"form-label"},Uy={key:1,class:"alert alert-danger",role:"alert"},By={class:"modal-footer"},qy=["disabled"],zy={key:0,class:"spinner-border spinner-border-sm me-2"},Ky={__name:"ProjectCreateModal",setup(n){const e=ve(),t=ee(),o=ce(),i=D({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=D({name:"",workingDirectory:""}),r=D(!1),u=D(""),l=D(null);let p=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:b=>{i.value.workingDirectory=b,a.value.workingDirectory=""}})}function _(){a.value={};let b=!0;return i.value.name.trim()||(a.value.name="Project name is required",b=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",b=!1),b}async function v(){if(_()){r.value=!0,u.value="";try{const b=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await t.createSession(b.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),p&&p.hide(),h()}catch(b){console.error("Failed to create project:",b),u.value=b.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function h(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},u.value=""}function x(){const b=document.getElementById("projectName");b&&b.focus()}function g(){h(),o.hideModal()}return le(()=>o.currentModal,b=>{b?.name==="create-project"&&p&&p.show()}),pe(()=>{l.value&&$e(async()=>{const{default:b}=await import("./modal-B4rHLo2F.js").then(y=>y.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{p=new b(l.value),l.value.addEventListener("shown.bs.modal",x),l.value.addEventListener("hidden.bs.modal",g)})}),be(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",x),l.value.removeEventListener("hidden.bs.modal",g)),p&&p.dispose()}),(b,y)=>(d(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",My,[s("div",Oy,[y[11]||(y[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Ny,[s("form",{onSubmit:he(v,["prevent"])},[s("div",Dy,[y[5]||(y[5]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),te(s("input",{type:"text",class:K(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":y[0]||(y[0]=M=>i.value.name=M),placeholder:"My Project",required:""},null,2),[[me,i.value.name]]),a.value.name?(d(),m("div",Ly,$(a.value.name),1)):I("",!0)]),s("div",Iy,[y[6]||(y[6]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Py,[te(s("input",{type:"text",class:K(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":y[1]||(y[1]=M=>i.value.workingDirectory=M),placeholder:"/path/to/project",required:""},null,2),[[me,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(d(),m("div",jy,$(a.value.workingDirectory),1)):I("",!0)]),y[7]||(y[7]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",Ry,[te(s("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":y[2]||(y[2]=M=>i.value.isMultiAgent=M)},null,512),[[At,i.value.isMultiAgent]]),y[8]||(y[8]=s("label",{class:"form-check-label",for:"isMultiAgent"}," 🏛 Multi-Agent Project (Legion) ",-1)),y[9]||(y[9]=s("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),s("div",Vy,[te(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":y[3]||(y[3]=M=>i.value.createSession=M)},null,512),[[At,i.value.createSession]]),s("label",Hy," Create initial "+$(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(d(),m("div",Wy,[s("label",Fy," Initial "+$(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),te(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":y[4]||(y[4]=M=>i.value.sessionName=M),placeholder:"main"},null,512),[[me,i.value.sessionName]])])):I("",!0),u.value?(d(),m("div",Uy,$(u.value),1)):I("",!0)],32)]),s("div",By,[y[10]||(y[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:r.value},[r.value?(d(),m("span",zy)):I("",!0),G(" "+$(r.value?"Creating...":"Create Project"),1)],8,qy)])])])],512))}},Yy=Y(Ky,[["__scopeId","data-v-adf50394"]]),Gy={class:"modal-dialog"},Jy={class:"modal-content"},Xy={class:"modal-body"},Qy={class:"mb-3"},Zy={key:0,class:"invalid-feedback"},e1={class:"mb-3"},t1=["value"],s1={key:0,class:"alert alert-danger",role:"alert"},n1={class:"danger-zone"},o1={class:"text-muted small"},i1=["disabled"],a1={key:0,class:"alert alert-warning mt-3",role:"alert"},r1={class:"mb-2"},l1={class:"d-flex gap-2"},c1=["disabled"],u1={key:0,class:"spinner-border spinner-border-sm me-2"},d1=["disabled"],m1={class:"modal-footer"},p1=["disabled"],f1={key:0,class:"spinner-border spinner-border-sm me-2"},v1={__name:"ProjectEditModal",setup(n){const e=ve(),t=ce(),o=D(null),i=D({name:""}),a=D({name:""}),r=D(!1),u=D(!1),l=D(""),p=D(!1),c=D(null);let _=null;const v=f(()=>o.value?.session_ids?.length||0);function h(){a.value={};let S=!0;return i.value.name.trim()||(a.value.name="Project name is required",S=!1),S}async function x(){if(!(!h()||!o.value)){r.value=!0,l.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),_&&_.hide()}catch(S){console.error("Failed to update project:",S),l.value=S.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function g(){if(o.value){u.value=!0,l.value="";try{await e.deleteProject(o.value.project_id),_&&_.hide()}catch(S){console.error("Failed to delete project:",S),l.value=S.message||"Failed to delete project. Please try again."}finally{u.value=!1}}}function b(){i.value={name:""},a.value={},l.value="",p.value=!1}function y(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function M(){b(),o.value=null,t.hideModal()}return le(()=>t.currentModal,S=>{if(S?.name==="edit-project"&&_){const w=S.data||{};o.value=w.project,o.value&&(i.value.name=o.value.name),_.show()}}),pe(()=>{c.value&&$e(async()=>{const{default:S}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{_=new S(c.value),c.value.addEventListener("shown.bs.modal",y),c.value.addEventListener("hidden.bs.modal",M)})}),be(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",y),c.value.removeEventListener("hidden.bs.modal",M)),_&&_.dispose()}),(S,w)=>(d(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",Gy,[s("div",Jy,[w[11]||(w[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Xy,[s("form",{onSubmit:he(x,["prevent"])},[s("div",Qy,[w[3]||(w[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),te(s("input",{type:"text",class:K(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":w[0]||(w[0]=P=>i.value.name=P),placeholder:"My Project",required:""},null,2),[[me,i.value.name]]),a.value.name?(d(),m("div",Zy,$(a.value.name),1)):I("",!0)]),s("div",e1,[w[4]||(w[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,t1),w[5]||(w[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),l.value?(d(),m("div",s1,$(l.value),1)):I("",!0)],32),w[9]||(w[9]=s("hr",null,null,-1)),s("div",n1,[w[7]||(w[7]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",o1," Deleting this project will also delete all "+$(v.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:w[1]||(w[1]=P=>p.value=!0),disabled:u.value},[...w[6]||(w[6]=[s("i",{class:"bi bi-trash"},null,-1),G(" Delete Project ",-1)])],8,i1)]),p.value?(d(),m("div",a1,[w[8]||(w[8]=s("strong",null,"Are you sure?",-1)),s("p",r1,' This will permanently delete the project "'+$(o.value?.name)+'" and all '+$(v.value)+" session(s). ",1),s("div",l1,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:g,disabled:u.value},[u.value?(d(),m("span",u1)):I("",!0),G(" "+$(u.value?"Deleting...":"Yes, Delete Permanently"),1)],8,c1),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:w[2]||(w[2]=P=>p.value=!1),disabled:u.value}," Cancel ",8,d1)])])):I("",!0)]),s("div",m1,[w[10]||(w[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:x,disabled:r.value},[r.value?(d(),m("span",f1)):I("",!0),G(" "+$(r.value?"Saving...":"Save Changes"),1)],8,p1)])])])],512))}},h1=Y(v1,[["__scopeId","data-v-6f299f35"]]),_1={class:"modal-dialog modal-lg"},g1={class:"modal-content"},b1={class:"modal-header"},y1={class:"modal-title",id:"createSessionModalLabel"},$1={key:0,class:"text-muted small"},w1={class:"modal-body"},E1={class:"mb-3"},C1={key:0,class:"invalid-feedback"},S1={class:"mb-3"},T1={class:"mb-3"},k1={class:"mb-3"},x1={class:"form-text d-flex justify-content-between"},A1={key:0,class:"invalid-feedback"},M1={class:"mb-3 form-check"},O1={key:0,class:"form-text text-warning"},N1={class:"mb-3"},D1={class:"mb-3 form-check"},L1={key:0,class:"alert alert-danger",role:"alert"},I1={class:"modal-footer"},P1=["disabled"],j1={key:0,class:"spinner-border spinner-border-sm me-2"},R1={__name:"SessionCreateModal",setup(n){const e=Ke();ve();const t=ee(),o=ce(),i=D(null),a=D({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0}),r=D({name:""}),u=D(!1),l=D(""),p=D(null);let c=null;const _=f(()=>a.value.system_prompt.length),v=f(()=>_.value>6e3),h=f(()=>_.value>5500&&_.value<=6e3);function x(){r.value={};let S=!0;return a.value.name.trim()||(r.value.name="Session name is required",S=!1),v.value&&(S=!1),S}async function g(){if(!(!x()||!i.value)){u.value=!0,l.value="";try{const S=a.value.tools.split(",").map(j=>j.trim()).filter(j=>j.length>0),w={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,tools:S},P=await t.createSession(i.value.project_id,w);a.value.startImmediately&&await t.startSession(P.session_id),e.push(`/session/${P.session_id}`),c&&c.hide(),b()}catch(S){console.error("Failed to create session:",S),l.value=S.message||"Failed to create session. Please try again."}finally{u.value=!1}}}function b(){a.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0},r.value={},l.value=""}function y(){const S=document.getElementById("sessionName");S&&S.focus()}function M(){b(),i.value=null,o.hideModal()}return le(()=>o.currentModal,S=>{if(S?.name==="create-session"&&c){const w=S.data||{};i.value=w.project,c.show()}}),pe(()=>{p.value&&$e(async()=>{const{default:S}=await import("./modal-B4rHLo2F.js").then(w=>w.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{c=new S(p.value),p.value.addEventListener("shown.bs.modal",y),p.value.addEventListener("hidden.bs.modal",M)})}),be(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",y),p.value.removeEventListener("hidden.bs.modal",M)),c&&c.dispose()}),(S,w)=>(d(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",_1,[s("div",g1,[s("div",b1,[s("h5",y1,[w[7]||(w[7]=G(" Create New Session ",-1)),i.value?(d(),m("span",$1,"in "+$(i.value.name),1)):I("",!0)]),w[8]||(w[8]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",w1,[s("form",{onSubmit:he(g,["prevent"])},[s("div",E1,[w[9]||(w[9]=s("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),te(s("input",{type:"text",class:K(["form-control",{"is-invalid":r.value.name}]),id:"sessionName","onUpdate:modelValue":w[0]||(w[0]=P=>a.value.name=P),placeholder:"main",required:""},null,2),[[me,a.value.name]]),r.value.name?(d(),m("div",C1,$(r.value.name),1)):I("",!0)]),s("div",S1,[w[11]||(w[11]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),te(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":w[1]||(w[1]=P=>a.value.permission_mode=P)},[...w[10]||(w[10]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"⚠️ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Fe,a.value.permission_mode]]),w[12]||(w[12]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",T1,[w[14]||(w[14]=s("label",{for:"model",class:"form-label"},"Model",-1)),te(s("select",{class:"form-select",id:"model","onUpdate:modelValue":w[2]||(w[2]=P=>a.value.model=P)},[...w[13]||(w[13]=[s("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),s("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),s("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[Fe,a.value.model]])]),s("div",k1,[w[15]||(w[15]=s("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),te(s("textarea",{class:K(["form-control",{"is-invalid":v.value}]),id:"systemPrompt","onUpdate:modelValue":w[3]||(w[3]=P=>a.value.system_prompt=P),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[me,a.value.system_prompt]]),s("div",x1,[s("span",null,$(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),s("span",{class:K({"text-danger":v.value,"text-warning":h.value})},$(_.value)+" / 6000 chars ",3)]),v.value?(d(),m("div",A1," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):I("",!0)]),s("div",M1,[te(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":w[4]||(w[4]=P=>a.value.override_system_prompt=P)},null,512),[[At,a.value.override_system_prompt]]),w[17]||(w[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(d(),m("div",O1,[...w[16]||(w[16]=[s("small",null,"⚠️ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):I("",!0)]),s("div",N1,[w[18]||(w[18]=s("label",{for:"tools",class:"form-label"},"Allowed Tools (Optional)",-1)),te(s("input",{type:"text",class:"form-control",id:"tools","onUpdate:modelValue":w[5]||(w[5]=P=>a.value.tools=P),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[me,a.value.tools]]),w[19]||(w[19]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",D1,[te(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":w[6]||(w[6]=P=>a.value.startImmediately=P)},null,512),[[At,a.value.startImmediately]]),w[20]||(w[20]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),l.value?(d(),m("div",L1,$(l.value),1)):I("",!0)],32)]),s("div",I1,[w[21]||(w[21]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:u.value},[u.value?(d(),m("span",j1)):I("",!0),G(" "+$(u.value?"Creating...":"Create Session"),1)],8,P1)])])])],512))}},V1=Y(R1,[["__scopeId","data-v-5aef47e0"]]),H1={class:"modal-dialog"},W1={class:"modal-content"},F1={class:"modal-body"},U1={class:"mb-3"},B1={key:0,class:"invalid-feedback"},q1={class:"mb-3"},z1=["value"],K1={class:"mb-3"},Y1={class:"form-control-plaintext"},G1={class:"mb-3"},J1=["disabled"],X1={key:0,value:"bypassPermissions"},Q1={class:"form-text"},Z1={key:0,class:"text-warning"},e$={key:1},t$={key:0,class:"mb-3"},s$={class:"card"},n$={class:"card-body"},o$={key:0,class:"mb-2"},i$={key:1,class:"mb-2"},a$={key:2,class:"mt-2"},r$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},l$={key:1,class:"alert alert-danger",role:"alert"},c$={class:"modal-footer"},u$=["disabled"],d$={key:0,class:"spinner-border spinner-border-sm me-2"},m$={__name:"SessionEditModal",setup(n){const e=ee(),t=ce(),o=D(null),i=D({name:"",permission_mode:"default"}),a=D({name:""}),r=D(!1),u=D(""),l=D(null);let p=null;const c=f(()=>o.value?.state==="active"||o.value?.state==="starting"),_=f(()=>o.value?.initial_permission_mode==="bypassPermissions");function v(M){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[M]||"bg-secondary"}function h(){a.value={};let M=!0;return i.value.name.trim()||(a.value.name="Session name is required",M=!1),M}async function x(){if(!(!h()||!o.value)){r.value=!0,u.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),p&&p.hide()}catch(M){console.error("Failed to update session:",M),u.value=M.message||"Failed to update session. Please try again."}finally{r.value=!1}}}function g(){i.value={name:"",permission_mode:"default"},a.value={},u.value=""}function b(){const M=document.getElementById("editSessionName");M&&(M.focus(),M.select())}function y(){g(),o.value=null,t.hideModal()}return le(()=>t.currentModal,M=>{if(M?.name==="edit-session"&&p){const S=M.data||{};o.value=S.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),p.show()}}),pe(()=>{l.value&&$e(async()=>{const{default:M}=await import("./modal-B4rHLo2F.js").then(S=>S.m);return{default:M}},__vite__mapDeps([0,1])).then(({default:M})=>{p=new M(l.value),l.value.addEventListener("shown.bs.modal",b),l.value.addEventListener("hidden.bs.modal",y)})}),be(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",b),l.value.removeEventListener("hidden.bs.modal",y)),p&&p.dispose()}),(M,S)=>(d(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",H1,[s("div",W1,[S[15]||(S[15]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",F1,[s("form",{onSubmit:he(x,["prevent"])},[s("div",U1,[S[2]||(S[2]=s("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),te(s("input",{type:"text",class:K(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":S[0]||(S[0]=w=>i.value.name=w),placeholder:"Session Name",required:""},null,2),[[me,i.value.name]]),a.value.name?(d(),m("div",B1,$(a.value.name),1)):I("",!0)]),s("div",q1,[S[3]||(S[3]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,z1),S[4]||(S[4]=s("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),s("div",K1,[S[5]||(S[5]=s("label",{class:"form-label"},"Current State",-1)),s("div",Y1,[s("span",{class:K(["badge",v(o.value?.state)])},$(o.value?.state),3)])]),s("div",G1,[S[9]||(S[9]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),te(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":S[1]||(S[1]=w=>i.value.permission_mode=w),disabled:!c.value},[S[6]||(S[6]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),S[7]||(S[7]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),S[8]||(S[8]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),_.value?(d(),m("option",X1,"⚠️ Bypass Permissions (No prompts)")):I("",!0)],8,J1),[[Fe,i.value.permission_mode]]),s("div",Q1,[c.value?(d(),m("span",e$," Controls which tool actions require permission prompts ")):(d(),m("span",Z1," ⚠️ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(d(),m("div",t$,[S[13]||(S[13]=s("label",{class:"form-label"},"System Prompt Configuration",-1)),s("div",s$,[s("div",n$,[o.value?.override_system_prompt?(d(),m("div",o$,[...S[10]||(S[10]=[s("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),s("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(d(),m("div",i$,[...S[11]||(S[11]=[s("span",{class:"badge bg-info"},"Append Mode",-1),s("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(d(),m("div",a$,[S[12]||(S[12]=s("strong",{class:"small"},"Custom Instructions:",-1)),s("div",r$,$(o.value.system_prompt),1)])):I("",!0)])])])):I("",!0),u.value?(d(),m("div",l$,$(u.value),1)):I("",!0)],32)]),s("div",c$,[S[14]||(S[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:x,disabled:r.value},[r.value?(d(),m("span",d$)):I("",!0),G(" "+$(r.value?"Saving...":"Save Changes"),1)],8,u$)])])])],512))}},p$=Y(m$,[["__scopeId","data-v-c99ca17f"]]),f$={class:"modal-dialog modal-dialog-centered"},v$={class:"modal-content"},h$={class:"modal-header"},_$={class:"modal-title",id:"manageSessionModalLabel"},g$={class:"modal-body"},b$={key:0,class:"text-center py-4"},y$={class:"text-muted"},$$={key:1},w$={key:2},E$={class:"text-muted"},C$={key:3},S$={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},T$={class:"d-grid gap-2"},k$=["disabled"],x$=["disabled"],A$=["disabled"],M$=["disabled"],O$={class:"modal-footer"},N$={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},D$={__name:"SessionManageModal",setup(n){const e=Ke(),t=ee(),o=ce(),i=Ye();De();const a=D(null),r=D(!1),u=D(""),l=D(""),p=D(null),c=D(null);let _=null;const v=f(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function h(){p.value="reset"}function x(){p.value="delete"}function g(){p.value=null}async function b(){p.value==="reset"?await S():p.value==="delete"&&await w()}async function y(){if(a.value){r.value=!0,u.value="Restarting session...";try{const A=a.value.session_id,k=await Z.post(`/api/sessions/${A}/restart`);if(k.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A),_&&_.hide();else{const N=k.error||k.detail||"Failed to restart session";console.error("Failed to restart session:",N),l.value=`Failed to restart session: ${N}`}}catch(A){console.error("Error restarting session:",A);const k=A.data?.detail||A.message||"Unknown error";l.value=`Error restarting session: ${k}`}finally{r.value=!1}}}async function M(){if(a.value)try{_&&_.hide(),console.log("Ending session",a.value.session_id);const A=a.value.session_id;await Z.post(`/api/sessions/${A}/terminate`),await i.disconnectSession(),t.currentSessionId===A&&(t.currentSessionId=null),e.push("/")}catch(A){console.error("Error ending session:",A),await i.disconnectSession(),t.currentSessionId===a.value?.session_id&&(t.currentSessionId=null),e.push("/")}}async function S(){if(a.value){r.value=!0,u.value="Resetting session...";try{const A=a.value.session_id,k=await Z.post(`/api/sessions/${A}/reset`);if(k.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(A),_&&_.hide();else{const N=k.error||k.detail||"Failed to reset session";console.error("Failed to reset session:",N),l.value=`Failed to reset session: ${N}`,p.value=null}}catch(A){console.error("Error resetting session:",A);const k=A.data?.detail||A.message||"Unknown error";l.value=`Error resetting session: ${k}`,p.value=null}finally{r.value=!1}}}async function w(){if(a.value){r.value=!0,u.value="Deleting session...";try{const A=a.value.session_id;await t.deleteSession(A),e.currentRoute.value.params.sessionId===A&&e.push("/"),_&&_.hide()}catch(A){console.error("Error deleting session:",A);const k=A.data?.detail||A.message||"Unknown error";l.value=`Error deleting session: ${k}`,p.value=null}finally{r.value=!1}}}function P(){p.value=null,r.value=!1,u.value="",l.value=""}function j(){P(),a.value=null,o.hideModal()}return le(()=>o.currentModal,A=>{if(A?.name==="manage-session"&&_){const k=A.data||{};a.value=k.session,P(),_.show()}}),pe(()=>{c.value&&$e(async()=>{const{default:A}=await import("./modal-B4rHLo2F.js").then(k=>k.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{_=new A(c.value),c.value.addEventListener("hidden.bs.modal",j)})}),be(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",j),_&&_.dispose()}),(A,k)=>(d(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",f$,[s("div",v$,[s("div",h$,[s("h5",_$,$(p.value?v.value:"Manage Session"),1),k[1]||(k[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",g$,[r.value?(d(),m("div",b$,[k[2]||(k[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",y$,$(u.value),1)])):p.value==="reset"?(d(),m("div",$$,[...k[3]||(k[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"⚠️ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(d(),m("div",w$,[k[6]||(k[6]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"⚠️ Warning: This action cannot be undone")],-1)),s("p",E$,[k[4]||(k[4]=G("This will permanently delete session ",-1)),s("strong",null,$(a.value?.name),1),k[5]||(k[5]=G(".",-1))]),k[7]||(k[7]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(d(),m("div",C$,[l.value?(d(),m("div",S$,[k[8]||(k[8]=s("strong",null,"Error:",-1)),G(" "+$(l.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:k[0]||(k[0]=N=>l.value="")})])):I("",!0),k[15]||(k[15]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",T$,[s("button",{class:"btn btn-outline-primary text-start",onClick:y,disabled:r.value},[...k[9]||(k[9]=[s("strong",null,"🔄 Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,k$),s("button",{class:"btn btn-outline-secondary text-start",onClick:M,disabled:r.value},[...k[10]||(k[10]=[s("strong",null,"🚪 End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,x$),k[13]||(k[13]=s("hr",{class:"my-2"},null,-1)),k[14]||(k[14]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"⚠️ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:h,disabled:r.value},[...k[11]||(k[11]=[s("strong",null,"🗑️ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,A$),s("button",{class:"btn btn-outline-danger text-start",onClick:x,disabled:r.value},[...k[12]||(k[12]=[s("strong",null,"❌ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,M$)]),k[16]||(k[16]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),G(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",O$,[p.value&&!r.value?(d(),m(se,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:g},"Cancel"),s("button",{type:"button",class:K(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:b},$(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?I("",!0):(d(),m("button",N$,"Cancel"))])])])],512))}},L$=Y(D$,[["__scopeId","data-v-de7ff18c"]]),I$={class:"modal-dialog modal-dialog-centered modal-lg"},P$={class:"modal-content"},j$={class:"modal-body"},R$={key:0,class:"text-center text-muted py-4"},V$={key:1},H$={class:"mb-3"},W$={class:"font-monospace small"},F$={class:"mb-3"},U$={class:"font-monospace small"},B$={class:"mb-3"},q$={class:"mb-3"},z$={class:"mb-3"},K$={key:0},Y$={class:"d-flex flex-wrap gap-1"},G$={key:1,class:"text-muted small"},J$={key:0,class:"mb-3"},X$={class:"d-flex flex-wrap gap-1"},Q$={key:1,class:"mb-3"},Z$={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},ew={class:"mb-3"},tw={class:"text-muted"},sw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},nw={__name:"SessionInfoModal",setup(n){const e=ee(),t=De(),o=ce(),i=D(null),a=D(!1),r=D(null);let u=null;const l=f(()=>{if(!i.value)return null;const v=e.initData.get(i.value);return v||(t.messagesBySession.get(i.value)||[]).find(g=>g.type==="system"&&(g.subtype==="init"||g.metadata?.subtype==="init")&&g.metadata?.init_data)?.metadata?.init_data||null});function p(v){return typeof v=="string"?v:typeof v=="object"&&v.type==="preset"?`Preset: ${v.preset}`:JSON.stringify(v,null,2)}function c(){i.value=null,a.value=!1}function _(){c(),o.hideModal()}return le(()=>o.currentModal,v=>{if(v?.name==="session-info"&&u){const h=v.data||{};i.value=h.sessionId,a.value=!1,u.show()}}),pe(()=>{r.value&&$e(async()=>{const{default:v}=await import("./modal-B4rHLo2F.js").then(h=>h.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{u=new v(r.value),r.value.addEventListener("hidden.bs.modal",_)})}),be(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",_),u&&u.dispose()}),(v,h)=>(d(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",I$,[s("div",P$,[h[9]||(h[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",j$,[l.value?(d(),m("div",V$,[s("div",H$,[h[1]||(h[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",W$,$(i.value),1)]),s("div",F$,[h[2]||(h[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("div",U$,$(l.value.cwd||"Not specified"),1)]),s("div",B$,[h[3]||(h[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,$(l.value.model||"Default"),1)]),s("div",q$,[h[4]||(h[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,$(l.value.permissionMode||"default"),1)]),s("div",z$,[h[5]||(h[5]=s("h6",{class:"text-muted"},"Available Tools",-1)),l.value.tools&&l.value.tools.length>0?(d(),m("div",K$,[s("div",Y$,[(d(!0),m(se,null,ae(l.value.tools,x=>(d(),m("span",{key:x,class:"badge bg-secondary"},$(x),1))),128))])])):(d(),m("div",G$,"All tools available"))]),l.value.commands&&l.value.commands.length>0?(d(),m("div",J$,[h[6]||(h[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",X$,[(d(!0),m(se,null,ae(l.value.commands,x=>(d(),m("span",{key:x,class:"badge bg-info"},$(x),1))),128))])])):I("",!0),l.value.systemPrompt?(d(),m("div",Q$,[h[7]||(h[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",Z$,$(p(l.value.systemPrompt)),1)])):I("",!0),s("div",ew,[s("h6",tw,[h[8]||(h[8]=G(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:h[0]||(h[0]=x=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(d(),m("pre",sw,$(JSON.stringify(l.value,null,2)),1)):I("",!0)])])):(d(),m("div",R$," No session configuration data available "))]),h[10]||(h[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},ow=Y(nw,[["__scopeId","data-v-809e2099"]]),iw={class:"modal-dialog modal-dialog-centered"},aw={class:"modal-content"},rw={class:"modal-body"},lw={class:"mb-3"},cw={class:"mb-3"},uw={class:"mb-3"},dw={class:"form-text d-flex justify-content-between"},mw={key:0,class:"invalid-feedback"},pw={class:"mb-3 form-check"},fw={key:0,class:"form-text text-warning"},vw={class:"mb-3"},hw={key:0,class:"alert alert-danger"},_w={class:"modal-footer"},gw=["disabled"],bw={key:0,class:"spinner-border spinner-border-sm me-2"},yw={__name:"CreateMinionModal",setup(n){const e=Ke(),t=ve(),o=ee(),i=ce(),a=D(null);let r=null;const u=D(null),l=D({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[]}),p=D(""),c=D(""),_=D(!1),v=f(()=>p.value.trim()?p.value.split(",").map(S=>S.trim()).filter(S=>S.length>0):[]),h=f(()=>l.value.initialization_context.length),x=f(()=>h.value>2e3),g=f(()=>h.value>1800&&h.value<=2e3);function b(){l.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[]},p.value="",c.value="",_.value=!1}function y(){b(),i.hideModal()}async function M(){if(!l.value.name.trim()){c.value="Minion name is required";return}if(l.value.name.includes(" ")){c.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(x.value){c.value="Initialization context exceeds 2000 character limit";return}if(!u.value){c.value="Legion ID is missing";return}_.value=!0,c.value="";try{const S={name:l.value.name.trim(),role:l.value.role.trim(),initialization_context:l.value.initialization_context.trim(),override_system_prompt:l.value.override_system_prompt,capabilities:v.value},w=await Z.post(`/api/legions/${u.value}/minions`,S);w.success&&w.minion_id?(await t.fetchProjects(),await o.fetchSessions(),r&&r.hide(),e.push(`/spy/${u.value}/${w.minion_id}`)):c.value="Failed to create minion"}catch(S){console.error("Failed to create minion:",S),c.value=S.response?.data?.detail||"Failed to create minion"}finally{_.value=!1}}return le(()=>i.currentModal,S=>{if(S?.name==="create-minion"&&r){const w=S.data||{};u.value=w.project?.project_id||null,b(),r.show()}}),pe(()=>{a.value&&$e(()=>import("./modal-B4rHLo2F.js").then(S=>S.m),__vite__mapDeps([0,1])).then(S=>{const w=S.default;r=new w(a.value),a.value.addEventListener("hidden.bs.modal",y)})}),be(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",y),r&&r.dispose()}),(S,w)=>(d(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[s("div",iw,[s("div",aw,[w[15]||(w[15]=s("div",{class:"modal-header"},[s("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",rw,[s("form",{onSubmit:he(M,["prevent"])},[s("div",lw,[w[5]||(w[5]=s("label",{for:"minion-name",class:"form-label"},[G(" Name "),s("span",{class:"text-danger"},"*")],-1)),te(s("input",{id:"minion-name","onUpdate:modelValue":w[0]||(w[0]=P=>l.value.name=P),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[me,l.value.name]]),w[6]||(w[6]=s("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),s("div",cw,[w[7]||(w[7]=s("label",{for:"minion-role",class:"form-label"},"Role",-1)),te(s("input",{id:"minion-role","onUpdate:modelValue":w[1]||(w[1]=P=>l.value.role=P),type:"text",class:"form-control",placeholder:"e.g., Code Expert, Testing Specialist"},null,512),[[me,l.value.role]]),w[8]||(w[8]=s("div",{class:"form-text"},"Optional role description for the minion",-1))]),s("div",uw,[w[9]||(w[9]=s("label",{for:"minion-context",class:"form-label"},"Initialization Context",-1)),te(s("textarea",{id:"minion-context","onUpdate:modelValue":w[2]||(w[2]=P=>l.value.initialization_context=P),class:K(["form-control",{"is-invalid":x.value}]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion..."},null,2),[[me,l.value.initialization_context]]),s("div",dw,[s("span",null,$(l.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),s("span",{class:K({"text-danger":x.value,"text-warning":g.value})},$(h.value)+" / 2000 chars ",3)]),x.value?(d(),m("div",mw," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):I("",!0)]),s("div",pw,[te(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":w[3]||(w[3]=P=>l.value.override_system_prompt=P)},null,512),[[At,l.value.override_system_prompt]]),w[11]||(w[11]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),l.value.override_system_prompt?(d(),m("div",fw,[...w[10]||(w[10]=[s("small",null,"⚠️ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):I("",!0)]),s("div",vw,[w[12]||(w[12]=s("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),te(s("input",{id:"minion-capabilities","onUpdate:modelValue":w[4]||(w[4]=P=>p.value=P),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[me,p.value]]),w[13]||(w[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),c.value?(d(),m("div",hw,$(c.value),1)):I("",!0)],32)]),s("div",_w,[w[14]||(w[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",disabled:!l.value.name.trim()||_.value,onClick:M},[_.value?(d(),m("span",bw)):I("",!0),G(" "+$(_.value?"Creating...":"Create Minion"),1)],8,gw)])])])],512))}},$w=Y(yw,[["__scopeId","data-v-d7434e2a"]]),ww={class:"modal-dialog modal-dialog-centered modal-lg"},Ew={class:"modal-content"},Cw={class:"modal-body"},Sw={key:0,class:"text-center text-muted py-4"},Tw={key:1},kw={class:"mb-3"},xw={class:"mb-3"},Aw={class:"font-monospace small"},Mw={class:"mb-3"},Ow={class:"mb-3"},Nw={class:"mb-3"},Dw={key:0},Lw={class:"d-flex flex-wrap gap-1"},Iw={key:1,class:"text-muted small"},Pw={class:"mb-3"},jw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},Rw={key:1,class:"text-muted small"},Vw={class:"mb-3"},Hw={key:0,class:"badge bg-info"},Ww={key:1,class:"badge bg-secondary"},Fw={class:"mb-3"},Uw={key:0,class:"font-monospace small"},Bw={key:1,class:"text-muted small"},qw={key:0,class:"mb-3"},zw={key:0},Kw={class:"list-unstyled mb-0"},Yw={key:1,class:"text-muted small"},Gw={class:"mb-3"},Jw={key:0,class:"font-monospace small"},Xw={key:1,class:"text-muted small"},Qw={class:"mb-3"},Zw={key:0},eE={class:"d-flex flex-wrap gap-1"},tE={key:1,class:"text-muted small"},sE={class:"mb-3"},nE={class:"small"},oE={class:"mb-3"},iE={class:"small"},aE={__name:"MinionViewModal",setup(n){const e=ce(),t=D(null),o=D(null);let i=null;function a(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function r(p){if(!p)return"N/A";try{const c=new Date(p);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function u(){t.value=null}function l(){u(),e.hideModal()}return le(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&i){const c=p.data||{};t.value=c.session,i.show()}}),pe(()=>{o.value&&$e(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(c=>c.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{i=new p(o.value),o.value.addEventListener("hidden.bs.modal",l)})}),be(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",l),i&&i.dispose()}),(p,c)=>(d(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",ww,[s("div",Ew,[c[13]||(c[13]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Cw,[t.value?(d(),m("div",Tw,[s("div",kw,[c[0]||(c[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,$(t.value.name||"Unnamed Minion"),1)]),s("div",xw,[c[1]||(c[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",Aw,$(t.value.session_id),1)]),s("div",Mw,[c[2]||(c[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,$(t.value.role||"Not specified"),1)]),s("div",Ow,[c[3]||(c[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:K(["badge",a(t.value.state)])},$(t.value.state),3)])]),s("div",Nw,[c[4]||(c[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(d(),m("div",Dw,[s("div",Lw,[(d(!0),m(se,null,ae(t.value.capabilities,_=>(d(),m("span",{key:_,class:"badge bg-secondary"},$(_),1))),128))])])):(d(),m("div",Iw,"None"))]),s("div",Pw,[c[5]||(c[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(d(),m("div",jw,$(t.value.initialization_context),1)):(d(),m("div",Rw,"Not specified"))]),s("div",Vw,[c[6]||(c[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(d(),m("span",Hw,"Yes")):(d(),m("span",Ww,"No"))])]),s("div",Fw,[c[7]||(c[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(d(),m("div",Uw,$(t.value.parent_overseer_id),1)):(d(),m("div",Bw,$(t.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),t.value.is_overseer?(d(),m("div",qw,[c[8]||(c[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(d(),m("div",zw,[s("ul",Kw,[(d(!0),m(se,null,ae(t.value.child_minion_ids,_=>(d(),m("li",{key:_,class:"font-monospace small"},$(_),1))),128))])])):(d(),m("div",Yw,"No children"))])):I("",!0),s("div",Gw,[c[9]||(c[9]=s("h6",{class:"text-muted"},"Horde Membership",-1)),t.value.horde_id?(d(),m("div",Jw,$(t.value.horde_id),1)):(d(),m("div",Xw,"Not in a horde"))]),s("div",Qw,[c[10]||(c[10]=s("h6",{class:"text-muted"},"Channel Memberships",-1)),t.value.channel_ids&&t.value.channel_ids.length>0?(d(),m("div",Zw,[s("div",eE,[(d(!0),m(se,null,ae(t.value.channel_ids,_=>(d(),m("span",{key:_,class:"badge bg-info"},$(_),1))),128))])])):(d(),m("div",tE,"No channels"))]),s("div",sE,[c[11]||(c[11]=s("h6",{class:"text-muted"},"Created",-1)),s("div",nE,$(r(t.value.created_at)),1)]),s("div",oE,[c[12]||(c[12]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",iE,$(r(t.value.updated_at)),1)])])):(d(),m("div",Sw," No minion data available "))]),c[14]||(c[14]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},rE=Y(aE,[["__scopeId","data-v-c44eaee2"]]),lE={class:"container-fluid vh-100 d-flex flex-column p-0"},cE={class:"d-flex flex-grow-1 overflow-hidden position-relative"},uE={class:"flex-grow-1 d-flex flex-column overflow-hidden"},dE={__name:"App",setup(n){const e=ce(),t=Ye(),o=ee(),i=ve(),a=Ke(),r=f(()=>e.sidebarCollapsed),u=f(()=>e.isMobile);pe(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const _=c.replace("#/session/","");o.sessions.has(_)&&await o.selectSession(_)}else if(c.startsWith("#/timeline/")){const _=c.replace("#/timeline/","");a.push(`/timeline/${_}`)}window.addEventListener("popstate",l),window.addEventListener("resize",e.handleResize)}),be(()=>{window.removeEventListener("popstate",l),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function l(){const c=window.location.hash;if(c.startsWith("#/session/")){const _=c.replace("#/session/","");o.sessions.has(_)&&o.selectSession(_)}}function p(){e.toggleSidebar()}return(c,_)=>{const v=oo("router-view");return d(),m("div",lE,[ie(zp),s("div",{id:"sidebar-backdrop",class:K({show:!r.value&&u.value}),onClick:p},null,2),s("div",cE,[ie(my),s("main",uE,[ie(v)])]),ie(Ay),ie(Yy),ie(h1),ie(V1),ie(p$),ie(L$),ie(ow),ie($w),ie(rE)])}}},on=fi(dE);on.use(vi());on.use(Wp);on.mount("#app");
