const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as l,d as st,r as M,b as k,n as Re,e as H,f as ce,t as S,u as ne,w as de,g as us,F as te,h as le,i as D,j as Ua,k as pe,l as $e,v as Me,m as Ce,p as Ao,q as ye,s as Do,x as rt,y as Oe,z as Oo,A as De,B as ws,C as mn,D as ns,E as Wa,G as Ha,H as pn,T as za,I as Mo,J as Lo,K as Zt,L as Je,M as Is,N as On,O as qa,P as Ka}from"./vue-vendor-C2iz6yvC.js";import{m as Ke,p as Vt}from"./markdown-vendor-BRsjnVvP.js";import{c as Xa,g as Ga}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function s(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(i){if(i.ep)return;i.ep=!0;const u=s(i);fetch(i.href,u)}})();const Ya={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ja={__name:"NoSessionSelected",setup(n){return(e,s)=>(l(),r("div",Ya,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Qa="modulepreload",Za=function(n){return"/"+n},Mn={},Le=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let p=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),h=f?.nonce||f?.getAttribute("nonce");i=p(s.map(m=>{if(m=Za(m),m in Mn)return;Mn[m]=!0;const v=m.endsWith(".css"),$=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${$}`))return;const c=document.createElement("link");if(c.rel=v?"stylesheet":Qa,v||(c.as="script"),c.crossOrigin="",c.href=m,h&&c.setAttribute("nonce",h),document.head.appendChild(c),v)return new Promise((d,y)=>{c.addEventListener("load",d),c.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${m}`)))})}))}function u(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return i.then(f=>{for(const h of f||[])h.status==="rejected"&&u(h.reason);return e().catch(u)})};class js extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Nt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new js(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof js?s:(console.error("API request failed:",s),new js(`Network error: ${s.message}`,0,null))}}async function es(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[h,p]of Object.entries(e.params))p!=null&&o.append(h,p);const i=o.toString();i&&(s=`${n}?${i}`);const{params:u,...f}=e;return Nt(s,{...f,method:"GET"})}return Nt(s,{...e,method:"GET"})}async function No(n,e,s={}){return Nt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function ei(n,e,s={}){return Nt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Io(n,e={}){return Nt(n,{...e,method:"DELETE"})}async function ti(n,e,s={}){return Nt(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function si(){return es("/api/system/git-status")}async function ni(){return No("/api/system/restart")}const be={get:es,post:No,put:ei,delete:Io,patch:ti},ve=st("session",()=>{const n=M(new Map),e=M(null),s=M(new Map),o=M(new Map),i=M(new Set),u=M(!1);let f=null;const h=k(()=>n.value.get(e.value)),p=k(()=>Array.from(n.value.values()).sort((A,L)=>A.order-L.order)),m=A=>k(()=>p.value.filter(L=>L.project_id===A)),v=k({get:()=>s.value.get(e.value)||"",set:A=>{e.value&&s.value.set(e.value,A)}});async function $(){try{const A=await be.get("/api/sessions");return n.value.clear(),A.sessions.forEach(L=>{n.value.set(L.session_id,L)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function c(A,L){try{const O=(await be.post("/api/sessions",{project_id:A,...L})).session_id,P=(await be.get(`/api/sessions/${O}`)).session;return n.value.set(O,P),n.value=new Map(n.value),console.log(`Created session ${O}`),P}catch(C){throw console.error("Failed to create session:",C),C}}async function d(A){if(e.value===A&&!u.value)return;f&&(console.log(`Aborting pending selection to switch to ${A}`),f.abort(),f=null);const L=new AbortController;f=L,u.value=!0;try{if(e.value=A,L.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let C=n.value.get(A);if(!C)try{const F=await be.get(`/api/sessions/${A}`);if(L.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}C=F.session,n.value.set(A,C),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(F){console.error(`Failed to fetch session ${A}:`,F);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await a(A),L.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${C.state} state)`);const F=6e4,U=200,X=5e3;let I=0,N=0;for(;I<F;){if(L.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const R=n.value.get(A);if(R&&R.state==="active"){console.log(`Session ${A} is now active after ${I}ms`);break}if(I-N>=X){const q=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${q}, ${I/1e3}s elapsed)`),N=I}await new Promise(q=>setTimeout(q,U)),I+=U}const K=n.value.get(A);K&&K.state!=="active"&&console.warn(`Session ${A} did not become active within ${F/1e3}s (state: ${K.state}), continuing anyway`)}catch(F){console.error(`Failed to auto-start session ${A}:`,F)}if(L.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await Le(()=>Promise.resolve().then(()=>gi),void 0)).useMessageStore().loadMessages(A),L.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}if(await(await Le(()=>Promise.resolve().then(()=>Xi),void 0)).useResourceStore().loadResources(A),L.signal.aborted){console.log(`Selection of ${A} aborted after resource load`);return}await(await Le(()=>Promise.resolve().then(()=>Gi),void 0)).useWebSocketStore().connectSession(A),L.signal.aborted||console.log(`Selected session ${A}`)}finally{f===L&&(f=null),u.value=!1}}function y(A,L){const C=n.value.get(A);C?Object.assign(C,L):(n.value.set(A,L),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function g(A){i.value.add(A);try{const C=(await be.delete(`/api/sessions/${A}`)).deleted_session_ids||[A];for(const O of C)n.value.delete(O),s.value.delete(O),o.value.delete(O);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(L){throw console.error("Failed to delete session:",L),L}finally{i.value.delete(A)}}async function _(A,L){try{await be.patch(`/api/sessions/${A}`,L),y(A,L),console.log(`Updated session ${A}:`,L)}catch(C){throw console.error("Failed to update session:",C),C}}async function b(A,L){try{await be.post(`/api/sessions/${A}/permission-mode`,{mode:L}),y(A,{current_permission_mode:L});const C=o.value.get(A);C&&(C.permissionMode=L,o.value.set(A,C)),console.log(`Set permission mode for session ${A} to ${L}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function a(A){try{await be.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(L){throw console.error("Failed to start session:",L),L}}async function w(A){try{await be.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(L){throw console.error("Failed to pause session:",L),L}}async function x(A){try{await be.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(L){throw console.error("Failed to terminate session:",L),L}}function E(A){return n.value.get(A)}function T(A,L){o.value.set(A,L),L.permissionMode&&y(A,{current_permission_mode:L.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:h,orderedSessions:p,sessionsInProject:m,currentInput:v,fetchSessions:$,createSession:c,selectSession:d,updateSession:y,deleteSession:g,patchSession:_,setPermissionMode:b,startSession:a,pauseSession:w,terminateSession:x,getSession:E,storeInitData:T}}),Ln=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ve},Symbol.toStringTag,{value:"Module"})),jo="webui-sidebar-";function Xt(n,e){try{const s=localStorage.getItem(jo+n);return s!==null?JSON.parse(s):e}catch{return e}}function Et(n,e){try{localStorage.setItem(jo+n,JSON.stringify(e))}catch{}}const xe=st("ui",()=>{const n=M(Xt("rightCollapsed",!0)),e=M(Xt("rightWidth",300)),s=M(Xt("activeTab","diff")),o=M(window.innerWidth>=768?Xt("rightVisible",!0):!1),i=M(null),u=M(new Set),f=M(window.innerWidth),h=k(()=>f.value<768),p=M(!0),m=M(!1),v=M(null),$=M(null),c=k(()=>v.value?{name:v.value,data:$.value}:null),d=M(!1),y=M("Loading..."),g=M(!1),_=M("idle");function b(){n.value=!n.value,Et("rightCollapsed",n.value)}function a(R){n.value=R,Et("rightCollapsed",R)}function w(R){e.value=Math.max(200,Math.min(R,window.innerWidth*.3)),Et("rightWidth",e.value)}function x(R){s.value=R,Et("activeTab",R)}function E(R){p.value=R}function T(){const R=localStorage.getItem("webui-background-color");m.value=R==="red"}function A(){m.value=!m.value,localStorage.setItem("webui-background-color",m.value?"red":"gray")}function L(R,q=null){v.value=null,$.value=null,setTimeout(()=>{v.value=R,$.value=q},0)}function C(){v.value=null,$.value=null}function O(R="Loading..."){d.value=!0,y.value=R}function V(){d.value=!1}function P(){L("restart-server")}function F(R){i.value=R}function U(R){u.value.has(R)?u.value.delete(R):u.value.add(R),u.value=new Set(u.value)}function X(){u.value.size>0&&(u.value=new Set)}function I(){o.value=!o.value,Et("rightVisible",o.value)}function N(R){o.value=R,Et("rightVisible",R)}function K(){const R=f.value;f.value=window.innerWidth,f.value>=768&&R<768?o.value=Xt("rightVisible",!0):f.value<768&&R>=768&&(o.value=!1)}return{rightSidebarCollapsed:n,rightSidebarWidth:e,rightSidebarActiveTab:s,rightPanelVisible:o,browsingProjectId:i,expandedStacks:u,windowWidth:f,isMobile:h,autoScrollEnabled:p,isRedBackground:m,activeModal:v,modalData:$,currentModal:c,isLoading:d,loadingMessage:y,restartInProgress:g,restartStatus:_,toggleRightSidebar:b,setRightSidebarCollapsed:a,setRightSidebarWidth:w,setRightSidebarTab:x,setBrowsingProject:F,toggleStack:U,collapseAllStacks:X,toggleRightPanel:I,setRightPanelVisible:N,setAutoScroll:E,initBackgroundColor:T,toggleBackgroundColor:A,showModal:L,hideModal:C,showLoading:O,hideLoading:V,showRestartModal:P,handleResize:K}}),se=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},oi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},ai=["title"],ii={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},li={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=k(()=>s.sessions.get(e.sessionId)),i=k(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),u=k(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),f=k(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),h=k(()=>{if(!o.value)return"No session selected";const p=i.value,m=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),v=o.value.name||"Unnamed Session",$=o.value.role?` (${o.value.role})`:"";return`${v}${$}: ${m}`});return(p,m)=>(l(),r("div",oi,[o.value?(l(),r("div",{key:0,class:H(["progress-bar",{"progress-bar-striped progress-bar-animated":f.value}]),style:Re({width:"100%",backgroundColor:u.value}),title:h.value},null,14,ai)):(l(),r("div",ii))]))}},ri=se(li,[["__scopeId","data-v-63d222fe"]]),ci={class:"d-flex justify-content-between align-items-center gap-2"},ui={class:"d-flex gap-2"},di=["disabled"],fi={class:"mode-label"},mi=["disabled"],pi=["disabled"],vi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=xe(),i=k(()=>s.sessions.get(e.sessionId)),u=k(()=>i.value?.current_permission_mode||"default"),f={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},h=k(()=>f[u.value]||"ðŸ”’"),p=k(()=>u.value),m=["default","acceptEdits","plan"],v=async()=>{if(!i.value)return;if(u.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(b){console.error("Failed to cycle permission mode:",b)}return}const g=(m.indexOf(u.value)+1)%m.length,_=m[g];try{await s.setPermissionMode(e.sessionId,_)}catch(b){console.error("Failed to cycle permission mode:",b)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},c=()=>{o.showModal("manage-session",{session:i.value})},d=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(y,g)=>(l(),r("div",{class:H(["session-status-bar border-top p-2",ne(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ci,[t("div",ui,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:v,disabled:!i.value},[ce(S(h.value)+" ",1),t("span",fi,S(p.value),1)],8,di),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...g[0]||(g[0]=[ce(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,mi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[...g[1]||(g[1]=[ce(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,pi)]),t("div",null,[t("button",{class:H(["btn btn-sm",ne(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:d}," â¬‡ï¸ "+S(ne(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},hi=se(vi,[["__scopeId","data-v-ed9a4d3c"]]),ts=st("task",()=>{const n=M(new Map),e=M(new Set);function s(a){const w=n.value.get(a);return w?Array.from(w.values()).filter(x=>x.status!=="deleted").sort((x,E)=>{const T=parseInt(x.id.replace(/\D/g,""))||0,A=parseInt(E.id.replace(/\D/g,""))||0;return T-A}):[]}function o(a){return s(a).find(x=>x.status==="in_progress")||null}function i(a){const w=s(a);return{total:w.length,completed:w.filter(x=>x.status==="completed").length,inProgress:w.filter(x=>x.status==="in_progress").length,pending:w.filter(x=>x.status==="pending").length}}function u(a){return e.value.has(a)}const f=k(()=>{const a=ve();return s(a.currentSessionId)}),h=k(()=>{const a=ve();return o(a.currentSessionId)}),p=k(()=>{const a=ve();return i(a.currentSessionId)}),m=k(()=>{const a=ve();return u(a.currentSessionId)});function v(a,w){n.value.has(a)||n.value.set(a,new Map),n.value.get(a).set(w.id,{id:w.id,subject:w.subject||"",description:w.description||"",status:w.status||"pending",activeForm:w.activeForm||null,owner:w.owner||null,blocks:w.blocks||[],blockedBy:w.blockedBy||[],metadata:w.metadata||{}}),e.value.add(a),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${w.id} for session ${a}`)}function $(a,w,x){const E=n.value.get(a);if(!E){console.warn(`No tasks found for session ${a}`);return}const T=E.get(w);if(!T){if(x.status==="deleted")return;v(a,{id:w,...x});return}x.subject!==void 0&&(T.subject=x.subject),x.description!==void 0&&(T.description=x.description),x.status!==void 0&&(T.status=x.status),x.activeForm!==void 0&&(T.activeForm=x.activeForm),x.owner!==void 0&&(T.owner=x.owner),x.metadata!==void 0&&(T.metadata={...T.metadata,...x.metadata}),x.addBlocks&&(T.blocks=[...new Set([...T.blocks,...x.addBlocks])]),x.addBlockedBy&&(T.blockedBy=[...new Set([...T.blockedBy,...x.addBlockedBy])]),x.status==="deleted"&&(E.delete(w),E.size===0&&(e.value.delete(a),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${w} for session ${a}`,x)}function c(a,w){return n.value.get(a)?.get(w)||null}function d(a){n.value.delete(a),e.value.delete(a),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${a}`)}function y(a,w){n.value.has(a)&&n.value.get(a).clear(),e.value.delete(a);const x=new Map;for(const E of w){if(E.metadata?.tool_uses)for(const T of E.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(T.name)&&x.set(T.id,{name:T.name,input:T.input});if(E.metadata?.tool_results)for(const T of E.metadata.tool_results){const A=x.get(T.tool_use_id);A&&(g(a,A.name,A.input,{error:T.is_error,content:T.content}),x.delete(T.tool_use_id))}}console.log(`Reconstructed ${n.value.get(a)?.size||0} tasks for session ${a}`)}function g(a,w,x,E){if(E?.error){console.log(`Skipping task update - tool ${w} returned error`);return}const T=_(E);if(T)switch(w){case"TaskCreate":{const A=b(T)||x?.id;A&&v(a,{id:A,subject:x?.subject||"",description:x?.description||"",status:"pending",activeForm:x?.activeForm||null,owner:x?.owner||null,blocks:[],blockedBy:[],metadata:x?.metadata||{}});break}case"TaskUpdate":{const A=x?.taskId;A&&$(a,A,{status:x?.status,subject:x?.subject,description:x?.description,activeForm:x?.activeForm,owner:x?.owner,metadata:x?.metadata,addBlocks:x?.addBlocks,addBlockedBy:x?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{x?.taskId;break}}}function _(a){return a?typeof a=="string"?a:a.content?typeof a.content=="string"?a.content:JSON.stringify(a.content):a.message?a.message:JSON.stringify(a):null}function b(a){if(!a)return null;const w=a.match(/[Tt]ask\s*#(\d+)/i);if(w)return w[1];const x=a.match(/#(\d+)/);return x?x[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:f,currentActiveTask:h,currentTaskStats:p,currentHasTasks:m,tasksForSession:s,activeTask:o,taskStats:i,hasTasks:u,getTask:c,createTask:v,updateTask:$,clearTasks:d,reconstructFromMessages:y,handleTaskToolResult:g}}),Pe=st("message",()=>{const n=M(new Map),e=M(new Map),s=M(new Map),o=M(new Map),i=M(new Map),u=M(new Map),f=M(new Map),h=M(new Map),p=M(new Map),m=k(()=>{const I=ve();return n.value.get(I.currentSessionId)||[]}),v=k(()=>{const I=ve();return e.value.get(I.currentSessionId)||[]});async function $(I,N=null,K=0){try{const R=N||1e4,q=await be.get(`/api/sessions/${I}/messages?limit=${R}&offset=${K}`),ee=q.messages||[],ue=q.total_count||ee.length,ie=q.has_more||!1;console.log(`Loaded ${ee.length} of ${ue} messages for session ${I}`);const he=[];if(ee.forEach(ge=>{if(ge.type==="tool_call"){a(I,ge);return}if(ge.type==="system"&&ge.metadata?.subtype==="client_launched"&&ge.timestamp){const z=typeof ge.timestamp=="number"?ge.timestamp:new Date(ge.timestamp).getTime()/1e3;h.value.set(I,z)}ge.type==="system"&&(ge.subtype==="init"||ge.metadata?.subtype==="init")&&ge.metadata?.init_data&&ve().storeInitData(I,ge.metadata.init_data),he.push(ge)}),n.value.set(I,he),he.length>0){const ge=he[he.length-1];ge.timestamp&&f.value.set(I,ge.timestamp)}n.value=new Map(n.value);try{ts().reconstructFromMessages(I,he)}catch(ge){console.warn("Failed to reconstruct task state:",ge)}return ie&&console.warn(`Warning: Only loaded ${he.length} of ${ue} messages. Some messages may be missing.`),{messages:he,totalCount:ue,hasMore:ie}}catch(R){throw console.error("Failed to load messages:",R),R}}function c(I,N){const K=i.value.get(I)||new Set;if(N.type==="assistant"&&N.metadata?.tool_uses&&N.metadata.tool_uses.forEach(R=>{K.add(R.id)}),N.type==="user"&&N.metadata?.tool_results&&N.metadata.tool_results.forEach(R=>{K.delete(R.tool_use_id);const q=u.value.get(I);q&&q.delete(R.tool_use_id)}),N.type==="system"&&N.metadata?.subtype==="client_launched"&&(K.forEach(R=>{L(I,R,"Session was restarted")}),K.clear(),N.timestamp)){const R=typeof N.timestamp=="number"?N.timestamp:new Date(N.timestamp).getTime()/1e3;h.value.set(I,R)}N.type==="system"&&N.metadata?.subtype==="interrupt"&&(K.forEach(R=>{L(I,R,"Session was interrupted")}),K.clear()),i.value.set(I,K)}function d(I,N){n.value.has(I)||n.value.set(I,[]);const K=n.value.get(I);if(N.id){const R=K.findIndex(q=>q.id===N.id);if(R!==-1){console.log(`Skipping duplicate message ${N.id} (already exists at index ${R})`);return}}K.push(N),N.timestamp&&f.value.set(I,N.timestamp),E(I,N),c(I,N),n.value=new Map(n.value)}function y(I,N){e.value.has(I)||e.value.set(I,[]),e.value.get(I).push(N),e.value=new Map(e.value)}function g(I,N,K){const R=e.value.get(I);if(R){const q=R.find(ee=>ee.id===N);q&&(Object.assign(q,K),e.value=new Map(e.value))}}function _(I,N){console.log("handlePermissionRequest received:",N);const K=N.metadata?.tool_name||N.tool_name,R=N.metadata?.input_params||N.input_params,q=N.metadata?.request_id||N.request_id,ee=N.metadata?.suggestions||N.suggestions||[];console.log("Extracted data:",{toolName:K,inputParams:R,requestId:q,suggestions:ee});const ue=x(K,R),ie=s.value.get(I)?.get(ue);ie?(o.value.set(q,ie),g(I,ie,{status:"permission_required",permissionRequestId:q,suggestions:ee}),console.log(`Permission required for tool ${ie}`,{suggestions:ee})):console.warn("No tool use ID found for permission request signature:",ue,{toolName:K,inputParams:R,availableSignatures:Array.from(s.value.keys())})}function b(I,N){const K=o.value.get(N.request_id);if(K){const R={permissionDecision:N.decision,appliedUpdates:N.applied_updates||[]};N.decision==="allow"?(R.status="executing",R.backendStatus="running"):(R.status="completed",R.backendStatus="denied",R.result={error:!0,message:N.reasoning||"Permission denied"},R.isExpanded=!1),N.updated_input&&(R.input=N.updated_input),g(I,K,R),console.log(`Permission ${N.decision} for tool ${K}`)}}function a(I,N){console.log("handleToolCall received:",N);const K=N.tool_use_id;if(!K){console.warn("Received tool_call without tool_use_id:",N);return}e.value.has(I)||e.value.set(I,[]);const R=e.value.get(I),q=R.findIndex(ie=>ie.id===K),ue={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[N.status]||N.status;if(q!==-1){const ie=R[q],he=["completed","error"],ge=["pending","executing","permission_required"];if(he.includes(ie.status)&&ge.includes(ue)){console.warn(`Ignoring status regression for tool ${K}: ${ie.status} â†’ ${ue}`);return}ie.status=ue,ie.backendStatus=N.status,N.permission&&(ie.suggestions=N.permission.suggestions||[],ie.permissionRequestId=N.request_id),N.permission_granted!==null&&N.permission_granted!==void 0&&(ie.permissionDecision=N.permission_granted?"allow":"deny"),N.result!==void 0&&(ie.result={error:N.status==="failed",content:N.result}),N.error&&(ie.result={error:!0,content:N.error}),N.status==="denied"&&(ie.result={error:!0,message:"Permission denied"},ie.isExpanded=!1),N.status==="interrupted"&&(L(I,K,"Session was interrupted"),ie.isExpanded=!1),(N.status==="completed"||N.status==="failed")&&(ie.isExpanded=!1),N.display&&(ie.backendState=N.display),console.log(`Updated tool call ${K} to status: ${ue} (backend: ${N.status})`)}else{const ie=x(N.name,N.input);s.value.has(I)||s.value.set(I,new Map),s.value.get(I).set(ie,K);const he={id:K,name:N.name,input:N.input,signature:ie,status:ue,backendStatus:N.status,permissionRequestId:N.request_id,permissionDecision:N.permission_granted!==void 0?N.permission_granted?"allow":"deny":null,suggestions:N.permission?.suggestions||[],result:N.result?{error:N.status==="failed",content:N.result}:null,explanation:null,timestamp:N.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(N.status),backendState:N.display};N.error&&(he.result={error:!0,content:N.error}),R.push(he),console.log(`Created new tool call ${K} for ${N.name} with status: ${ue}`)}if(e.value=new Map(e.value),["completed","failed"].includes(N.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(N.name))try{ts().handleTaskToolResult(I,N.name,N.input,{error:N.status==="failed",content:N.result})}catch(ie){console.warn("Failed to update task store:",ie)}}function w(I,N){const K=e.value.get(I);if(K){const R=K.find(q=>q.id===N);R&&(R.isExpanded=!R.isExpanded,e.value=new Map(e.value))}}function x(I,N){if(!I)return"unknown:{}";if(!N||typeof N!="object")return`${I}:{}`;const K=JSON.stringify(N,Object.keys(N).sort());return`${I}:${K}`}function E(I,N){const K=N.metadata?.display||N.display;if(!K)return;p.value.has(I)||p.value.set(I,new Map);const R=p.value.get(I);if(K.tool_states)for(const[q,ee]of Object.entries(K.tool_states)){R.set(q,ee);const ue=e.value.get(I);if(ue){const ie=ue.find(he=>he.id===q);if(ie){const he={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};ie.status=he[ee.state]||ee.state,ie.backendState=ee}}}if(K.orphaned_tools&&K.orphaned_tools.length>0){const q=u.value.get(I)||new Map;for(const ee of K.orphaned_tools)q.has(ee)||q.set(ee,{reason:"denied",message:"Session was interrupted"});u.value.set(I,q)}if(K.linked_permissions)for(const[q,ee]of Object.entries(K.linked_permissions))o.value.set(q,ee);K.tool_states&&Object.keys(K.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${I}:`,{toolStates:Object.keys(K.tool_states||{}).length,orphanedTools:(K.orphaned_tools||[]).length,linkedPermissions:Object.keys(K.linked_permissions||{}).length})}function T(I,N){return p.value.get(I)?.get(N)}function A(I){const N=p.value.get(I);return N&&N.size>0}function L(I,N,K){const R=u.value.get(I)||new Map;R.set(N,{reason:"denied",message:K}),u.value.set(I,R);const q=e.value.get(I);if(q){const ee=q.find(ue=>ue.id===N);ee&&ee.isExpanded&&(ee.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${N} as orphaned: ${K}`)}function C(I,N){const K=T(I,N);return K&&K.state==="orphaned"?!0:u.value.get(I)?.has(N)||!1}function O(I,N){const K=T(I,N);return K&&K.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:K}:u.value.get(I)?.get(N)}function V(I,N){const K=i.value.get(I);K&&K.size>0&&(K.forEach(R=>L(I,R,N)),K.clear())}function P(I){n.value.delete(I),e.value.delete(I),s.value.delete(I),n.value=new Map(n.value),e.value=new Map(e.value)}function F(I){return f.value.get(I)}async function U(I){const N=f.value.get(I);if(!N)return console.log(`No sync needed for session ${I} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${I} since ${N}`);const K=await be.get(`/api/sessions/${I}/messages?limit=1000&offset=0`),R=K.messages||[],q=K.has_more||!1,ee=J=>J?typeof J=="number"?J*1e3:new Date(J).getTime():0,ue=ee(N),ie=R.filter(J=>J.timestamp?ee(J.timestamp)>ue:!1);if(ie.length===0)return console.log(`No missed messages for session ${I}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ie.length} missed messages for session ${I}`);const he=n.value.get(I)||[],ge=new Set(he.map(J=>J.id).filter(Boolean)),z=ie.filter(J=>!J.id||!ge.has(J.id));console.log(`After deduplication: ${z.length} unique new messages`);const j=[],W=[];if(z.forEach(J=>{J.type==="tool_call"?j.push(J):W.push(J)}),j.forEach(J=>{a(I,J)}),W.length>0){const J=W.sort((Y,re)=>{const _e=ee(Y.timestamp),we=ee(re.timestamp);return _e-we}),oe=n.value.get(I)||[],Se=oe.length>0?ee(oe[oe.length-1].timestamp):0;if(ee(J[0].timestamp)>Se){const Y=[...oe,...J];n.value.set(I,Y)}else{const Y=[...oe,...J].sort((re,_e)=>{const we=ee(re.timestamp),Ee=ee(_e.timestamp);return we-Ee});n.value.set(I,Y)}}W.forEach(J=>{c(I,J),J.type==="system"&&(J.subtype==="init"||J.metadata?.subtype==="init")&&J.metadata?.init_data&&ve().storeInitData(I,J.metadata.init_data)});const Q=n.value.get(I);if(Q&&Q.length>0){const J=Q[Q.length-1];J.timestamp&&f.value.set(I,J.timestamp)}return n.value=new Map(n.value),{syncedCount:z.length,hasMore:q}}catch(K){return console.error(`Failed to sync messages for session ${I}:`,K),{syncedCount:0,hasMore:!1,error:K.message}}}const X=ve();return de(()=>Array.from(X.sessions.values()).map(N=>({id:N.session_id,state:N.state})),(I,N)=>{N&&I.forEach((K,R)=>{const q=N[R];if(!q||q.id!==K.id)return;const ee=["active","paused","starting"].includes(q.state),ue=!["active","paused","starting"].includes(K.state);ee&&ue&&V(K.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:us(i),orphanedToolUses:us(u),currentMessages:m,currentToolCalls:v,loadMessages:$,addMessage:d,addToolCall:y,updateToolCall:g,handleToolCall:a,handlePermissionRequest:_,handlePermissionResponse:b,toggleToolExpansion:w,clearMessages:P,markToolUseOrphaned:L,isToolUseOrphaned:C,getOrphanedInfo:O,clearOrphanedToolUses:V,getLastReceivedTimestamp:F,syncMessages:U,getBackendToolState:T,hasBackendDisplayMetadata:A,backendToolStates:us(p),launchTimestampBySession:us(h)}}),gi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Pe},Symbol.toStringTag,{value:"Module"}));function _i(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function os(n){return _i(n).toLocaleTimeString()}const bi={class:"msg-wrapper msg-user"},yi={class:"msg-meta"},wi={class:"msg-time"},ki={class:"msg-bubble msg-bubble-user"},$i=["innerHTML"],Si={key:0,class:"tool-results mt-2"},xi={class:"tool-results-header text-muted small mb-2"},Ci={class:"d-flex align-items-start gap-2"},Ei={class:"flex-grow-1"},Ti={class:"text-muted"},Ai={key:0,class:"text-danger small"},Di={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ke.setOptions({breaks:!0,gfm:!0});const s=k(()=>os(e.message.timestamp)),o=k(()=>{const h=e.message.content||"";let p=Ke.parse(h);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Vt.sanitize(p)}),i=k(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),u=k(()=>e.message.metadata?.tool_results||[]);function f(h,p){return h?h.length<=p?h:h.substring(0,p)+"...":""}return(h,p)=>(l(),r("div",bi,[t("div",yi,[p[0]||(p[0]=t("span",{class:"msg-role"},"user",-1)),t("span",wi,S(s.value),1)]),t("div",ki,[t("div",{class:"msg-text",innerHTML:o.value},null,8,$i),i.value?(l(),r("div",Si,[t("div",xi," Tool Results ("+S(u.value.length)+") ",1),(l(!0),r(te,null,le(u.value,(m,v)=>(l(),r("div",{key:v,class:H(["tool-result-summary",m.is_error?"result-error":"result-success"])},[t("div",Ci,[t("span",null,S(m.is_error?"âœ—":"âœ“"),1),t("div",Ei,[t("small",Ti,"Tool: "+S(m.tool_use_id),1),m.is_error?(l(),r("div",Ai,S(f(m.content,200)),1)):D("",!0)])])],2))),128))])):D("",!0)])]))}},Oi=se(Di,[["__scopeId","data-v-c5db10e0"]]),Mi={class:"thinking-block"},Li=["aria-label"],Ni={class:"text-muted ms-auto"},Ii={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ji=["innerHTML"],Pi={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=M(!1),o=k(()=>e.thinking?.length||0),i=k(()=>{const f=e.thinking||"",h=Ke.parse(f);return Vt.sanitize(h)});function u(){s.value=!s.value}return(f,h)=>(l(),r("div",Mi,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:u},[t("span",{"aria-label":s.value?"Collapse":"Expand"},S(s.value?"â–¾":"â–¸"),9,Li),h[0]||(h[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Ni,S(o.value)+" characters",1)]),s.value?(l(),r("div",Ii,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,ji)])):D("",!0)]))}},Ri=se(Pi,[["__scopeId","data-v-fda2352c"]]);function Nn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function Bi(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function In(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Fi(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=Bi(s.command),i=In(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${In(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=Nn(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",i=s.description||"Task",u=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${u}`}case"Grep":case"Glob":{const o=s.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=s.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=s.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Nn(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const Vi=["title"],Ui={class:"node-label"},Wi={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){Ua(d=>({b853f60e:p.value}));const s=n,o=Pe(),i=ve(),u=M(!1),f=k(()=>{const d=i.currentSessionId;return d?s.tool.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[s.tool.backendStatus]||s.tool.backendStatus:o.isToolUseOrphaned(d,s.tool.id)?"orphaned":s.tool.status:s.tool.status}),h=k(()=>s.tool.result?.error||s.tool.status==="error"||s.tool.permissionDecision==="deny"),p=k(()=>{switch(f.value){case"completed":return h.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}),m=k(()=>({"node-expanded":s.isExpanded,"node-running":f.value==="executing","node-permission":f.value==="permission_required"})),v=k(()=>({"dot-running":f.value==="executing","dot-permission":f.value==="permission_required","dot-error":f.value==="error"||f.value==="completed"&&h.value})),$=k(()=>{const d=Fi(s.tool),y={completed:h.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[f.value]||f.value;return`${d} [${y}]`}),c=k(()=>{const d=s.tool.name||"";if(d.startsWith("mcp__")){const y=d.lastIndexOf("__");if(y>4)return d.slice(y+2)}return d.replace(/Tool$/,"")});return e({statusColor:p,effectiveStatus:f}),(d,y)=>(l(),r("div",{class:H(["timeline-node",[m.value,{"node-compact":n.compact}]]),title:$.value,onClick:y[0]||(y[0]=pe(g=>d.$emit("click"),["stop"])),onMouseenter:y[1]||(y[1]=g=>u.value=!0),onMouseleave:y[2]||(y[2]=g=>u.value=!1)},[t("div",{class:H(["node-dot",v.value])},null,2),t("span",Ui,S(c.value),1)],42,Vi))}},Hi=se(Wi,[["__scopeId","data-v-9c8e95b1"]]),zi={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"},compact:{type:Boolean,default:!1}},setup(n){const e=n,s=k(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(o,i)=>(l(),r("div",{class:H(["timeline-segment",{"segment-compact":n.compact}]),style:Re(s.value)},null,6))}},qi=se(zi,[["__scopeId","data-v-40110c30"]]),ze=st("project",()=>{const n=M(new Map),e=M(null),s=k(()=>n.value.get(e.value)),o=k(()=>Array.from(n.value.values()).sort((b,a)=>b.order-a.order));async function i(){try{const b=await be.get("/api/projects");return n.value.clear(),b.projects.forEach(a=>{n.value.set(a.project_id,a)}),console.log(`Loaded ${n.value.size} projects`),b.projects}catch(b){throw console.error("Failed to fetch projects:",b),b}}async function u(b,a){try{const x=(await be.post("/api/projects",{name:b,working_directory:a})).project;return n.value.set(x.project_id,x),n.value=new Map(n.value),console.log(`Created project ${x.project_id}`),x}catch(w){throw console.error("Failed to create project:",w),w}}async function f(b,a){try{await be.put(`/api/projects/${b}`,a),h(b,a),console.log(`Updated project ${b}`,a)}catch(w){throw console.error("Failed to update project:",w),w}}function h(b,a){const w=n.value.get(b);w&&(Object.assign(w,a),n.value=new Map(n.value))}async function p(b){try{await be.delete(`/api/projects/${b}`),n.value.delete(b),n.value=new Map(n.value),e.value===b&&(e.value=null),console.log(`Deleted project ${b}`)}catch(a){throw console.error("Failed to delete project:",a),a}}async function m(b){try{const a=await be.put(`/api/projects/${b}/toggle-expansion`),w=n.value.get(b);return w&&(w.is_expanded=a.is_expanded,n.value=new Map(n.value)),a.is_expanded}catch(a){throw console.error("Failed to toggle expansion:",a),a}}async function v(b){try{await be.put("/api/projects/reorder",{project_ids:b}),b.forEach((a,w)=>{const x=n.value.get(a);x&&(x.order=w)}),n.value=new Map(n.value),console.log("Reordered projects",b)}catch(a){throw console.error("Failed to reorder projects:",a),a}}async function $(b,a){try{await be.put(`/api/projects/${b}/sessions/reorder`,{session_ids:a});const w=n.value.get(b);w&&(w.session_ids=a,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${b}`,a)}catch(w){throw console.error("Failed to reorder sessions:",w),w}}function c(b,a){const w=n.value.get(b);if(!w||!w.session_ids||w.session_ids.length===0)return[{status:"none",flex:1}];const x=new Set,E=new Map;for(const O of w.session_ids){const V=a.getSession(O);if(V&&(E.set(O,V),V.child_minion_ids))for(const P of V.child_minion_ids)x.add(P)}const T=Array.from(E.values()).filter(O=>!x.has(O.session_id)).sort((O,V)=>(O.order||0)-(V.order||0));if(T.length===0&&E.size===0)return[{status:"none",flex:1}];function A(O){return O.state==="active"&&O.is_processing?"active":O.state==="active"?"idle":O.state==="paused"?"waiting":O.state==="error"?"error":"none"}function L(O,V){if(V.push({status:A(O),flex:1}),O.child_minion_ids)for(const P of O.child_minion_ids){const F=E.get(P);F&&L(F,V)}}const C=[];for(const O of T)L(O,C);return C.length>0?C:[{status:"none",flex:1}]}function d(b){return n.value.get(b)}function y(b){e.value=b}function g(){e.value=null}function _(b){if(!b)return"";const a=b.split(/[/\\]/).filter(w=>w);return a.length===0?"/":a.length===1?`/${a[0]}`:a.length===2?`/${a.join("/")}`:`.../${a.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:i,createProject:u,updateProject:f,updateProjectLocal:h,deleteProject:p,toggleExpansion:m,reorderProjects:v,reorderSessionsInProject:$,getProject:d,getStatusBarSegments:c,selectProject:y,clearProjectSelection:g,formatPath:_}}),jn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Ps={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Qe=st("resource",()=>{const n=M(new Map),e=M(!1),s=M(0),o=M(null),i=M(!1),u=M(new Map);function f(Y){if(!Y)return!1;if(Y.is_image===!0||(Y.mime_type||"").toLowerCase().startsWith("image/"))return!0;const _e=(Y.format||"").toLowerCase();if(_e.startsWith("image/")||jn.has("."+_e))return!0;const we=Y.original_filename||Y.original_name||"";if(we){const Ee="."+we.split(".").pop().toLowerCase();return jn.has(Ee)}return!1}function h(Y){if(!Y||f(Y))return!1;const re=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),_e=Y.original_filename||Y.original_name||"";if(_e){const Ee="."+_e.split(".").pop().toLowerCase();if(re.has(Ee))return!0}const we=(Y.mime_type||Y.format||"").toLowerCase();return!!(we.startsWith("text/")||we==="application/json"||we==="application/xml")}function p(Y){if(f(Y))return"ðŸ–¼ï¸";if(Y.original_filename){const re="."+Y.original_filename.split(".").pop().toLowerCase();return Ps[re]||Ps.default}return Ps.default}function m(Y){return Y.original_filename?"."+Y.original_filename.split(".").pop().toLowerCase():""}function v(Y){const re=n.value.get(Y);return re||[]}function $(Y){return n.value.get(Y)?.length||0}function c(Y){return $(Y)>0}function d(Y){return v(Y).filter(f)}function y(Y){return d(Y).length}function g(Y){return y(Y)>0}const _=k(()=>{const Y=ve();return v(Y.currentSessionId)}),b=k(()=>{const Y=ve();return $(Y.currentSessionId)}),a=k(()=>b.value>0),w=k(()=>_.value.filter(f)),x=k(()=>w.value.length),E=k(()=>x.value>0),T=k(()=>!e.value||!o.value?null:v(o.value)[s.value]||null),A=T,L=k(()=>o.value?$(o.value):0),C=L;async function O(Y){if(Y){i.value=!0;try{const _e=(await es(`/api/sessions/${Y}/resources`)).resources||[];_e.sort((we,Ee)=>(we.timestamp||0)-(Ee.timestamp||0)),n.value.set(Y,_e),n.value=new Map(n.value),console.log(`Loaded ${_e.length} resources for session ${Y}`)}catch(re){console.error(`Failed to load resources for session ${Y}:`,re),n.value.set(Y,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const V=O;function P(Y,re){if(!Y||!re)return;let _e=n.value.get(Y);_e||(_e=[],n.value.set(Y,_e));const we=_e.findIndex(Ee=>Ee.resource_id===re.resource_id);we>=0?_e[we]=re:_e.push(re),_e.sort((Ee,at)=>(Ee.timestamp||0)-(at.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${re.resource_id} to session ${Y}`)}const F=P;function U(Y,re){return`/api/sessions/${Y}/resources/${re}`}const X=U;function I(Y,re){return`/api/sessions/${Y}/resources/${re}/download`}function N(Y,re=0){o.value=Y,s.value=Math.max(0,Math.min(re,$(Y)-1)),e.value=!0}function K(){e.value=!1}function R(){if(!o.value)return;const Y=$(o.value);Y!==0&&(s.value=(s.value+1)%Y)}const q=R;function ee(){if(!o.value)return;const Y=$(o.value);Y!==0&&(s.value=(s.value-1+Y)%Y)}const ue=ee;function ie(Y){if(!o.value)return;const re=$(o.value);re!==0&&(s.value=Math.max(0,Math.min(Y,re-1)))}const he=ie;function ge(Y){n.value.delete(Y),n.value=new Map(n.value),o.value===Y&&K(),console.log(`Cleared resources for session ${Y}`)}const z=ge;async function j(Y,re){if(!(!Y||!re))try{await Io(`/api/sessions/${Y}/resources/${re}`),Q(Y,re)}catch(_e){console.error(`Failed to remove resource ${re}:`,_e)}}function W(Y,re){Q(Y,re)}function Q(Y,re){const _e=n.value.get(Y);if(!_e)return;const we=_e.findIndex(Ee=>Ee.resource_id===re);we!==-1&&(_e.splice(we,1),n.value=new Map(n.value),e.value&&o.value===Y&&(_e.length===0?K():s.value>=_e.length&&(s.value=_e.length-1)),u.value.delete(re),u.value=new Map(u.value))}async function J(Y,re){if(!Y||!re)return null;const _e=u.value.get(re);if(_e&&!_e.error)return _e.content;u.value.set(re,{content:null,loading:!0,error:null}),u.value=new Map(u.value);try{const we=U(Y,re),Ee=await fetch(we);if(!Ee.ok)throw new Error(`HTTP ${Ee.status}`);const at=await Ee.text();return u.value.set(re,{content:at,loading:!1,error:null}),u.value=new Map(u.value),at}catch(we){return console.error(`Failed to fetch text content for resource ${re}:`,we),u.value.set(re,{content:null,loading:!1,error:we.message}),u.value=new Map(u.value),null}}function oe(Y){return u.value.get(Y)||null}function Se(Y){if(Y){const re=n.value.get(Y);re&&(re.forEach(_e=>u.value.delete(_e.resource_id)),u.value=new Map(u.value))}else u.value=new Map}function ot(Y,re){const _e=n.value.get(Y);return _e&&_e.find(we=>we.resource_id===re)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:i,textContentCache:u,currentResources:_,currentResourceCount:b,currentHasResources:a,currentFullViewResource:T,fullViewTotalResources:L,currentImages:w,currentImageCount:x,currentHasImages:E,currentFullViewImage:A,fullViewTotalImages:C,imagesBySession:n,resourcesForSession:v,resourceCount:$,hasResources:c,getResourceUrl:U,getDownloadUrl:I,isImageResource:f,isTextResource:h,getResourceIcon:p,getResourceExtension:m,getResourceById:ot,getTextContent:oe,imagesForSession:d,imageCount:y,hasImages:g,getImageUrl:X,loadResources:O,addResource:P,removeResource:j,handleResourceRemoved:W,openFullView:N,closeFullView:K,nextResource:R,prevResource:ee,goToResource:ie,clearResources:ge,fetchTextContent:J,clearTextCache:Se,loadImages:V,addImage:F,nextImage:q,prevImage:ue,goToImage:he,clearImages:z}}),Ki=Qe,Xi=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ki,useResourceStore:Qe},Symbol.toStringTag,{value:"Module"})),nt=st("websocket",()=>{const n=M(null),e=M(!1),s=M(0),o=10,i=M(null),u=M(!1),f=M(0),h=5,p=M(null);let m=null;const v=M(0),$=M(null),c=M(new Map),d=M(null),y=M(!1),g=M(0),_=5,b=M(null),a=1e4,w=1e3,x=M(Date.now()),E=M(Date.now()),T=M(Date.now());let A=null,L=null,C=null;const O=k(()=>e.value&&(u.value||!p.value)?"connected":e.value?"partial":"disconnected");function V(j){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${j}`}function P(j){const W={ui:{timer:()=>A,setTimer:Q=>{A=Q},lastPing:x,connected:e,name:"UI"},session:{timer:()=>L,setTimer:Q=>{L=Q},lastPing:E,connected:u,name:"Session"},legion:{timer:()=>C,setTimer:Q=>{C=Q},lastPing:T,connected:y,name:"Legion"}}[j];W.timer()&&clearInterval(W.timer()),W.setTimer(setInterval(()=>{if(!W.connected.value)return;const Q=Date.now()-W.lastPing.value;if(Q>a){console.warn(`âš ï¸ ${W.name} WebSocket heartbeat timeout (${Q}ms since last ping) - forcing close to trigger reconnection`),W.connected.value=!1;const oe={ui:n,session:i,legion:d}[j];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},w)),console.log(`âœ… Started heartbeat monitor for ${W.name} WebSocket`)}function F(j){const W={ui:{get:()=>A,set:Q=>{A=Q}},session:{get:()=>L,set:Q=>{L=Q}},legion:{get:()=>C,set:Q=>{C=Q}}}[j];W.get()&&(clearInterval(W.get()),W.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${j} WebSocket`))}function U(){if(n.value)return;const j=V("/ws/ui");console.log(`Connecting to UI WebSocket: ${j}`),n.value=new WebSocket(j),n.value.onopen=()=>{e.value=!0,s.value=0,x.value=Date.now(),P("ui"),console.log("UI WebSocket connected")},n.value.onmessage=W=>{const Q=JSON.parse(W.data);ue(Q)},n.value.onclose=()=>{if(F("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const W=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${W}ms (attempt ${s.value})`),setTimeout(U,W)}},n.value.onerror=W=>{console.error("UI WebSocket error:",W)}}function X(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function I(j){v.value++;const W=v.value;if(console.log(`[Gen ${W}] Starting connection to session ${j}`),m&&(clearTimeout(m),m=null),await N(),v.value!==W){console.log(`[Gen ${W}] Connection cancelled (current generation: ${v.value})`);return}p.value=j,$.value=W;const Q=V(`/ws/session/${j}`);console.log(`[Gen ${W}] Connecting to Session WebSocket: ${Q}`),i.value=new WebSocket(Q),i.value.onopen=async()=>{if($.value!==W){console.log(`[Gen ${W}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}u.value=!0,f.value=0,E.value=Date.now(),P("session"),console.log(`[Gen ${W}] Session WebSocket connected for ${j}`);const J=c.value.get(j);if(c.value.set(j,!0),J){console.log(`[Gen ${W}] Reconnection detected, syncing missed messages...`);try{const Se=await Pe().syncMessages(j);Se.syncedCount>0?console.log(`[Gen ${W}] âœ… Synced ${Se.syncedCount} missed messages`):Se.error?console.warn(`[Gen ${W}] âš ï¸ Message sync failed: ${Se.error}`):console.log(`[Gen ${W}] No missed messages to sync`),Se.hasMore&&console.warn(`[Gen ${W}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${W}] Error during message sync:`,oe)}}else console.log(`[Gen ${W}] Initial connection, no sync needed`)},i.value.onmessage=J=>{if($.value!==W){console.log(`[Gen ${W}] Ignoring message (stale connection, current: ${$.value})`);return}const oe=JSON.parse(J.data);ie(oe,j)},i.value.onclose=()=>{F("session"),u.value=!1,i.value=null,console.log(`[Gen ${W}] Session WebSocket closed for ${j}`);const J=ve();if(J.currentSessionId===j&&$.value===W&&f.value<h){f.value++;const oe=Math.min(2e3*f.value,3e4);console.log(`[Gen ${W}] Reconnecting Session WebSocket in ${oe}ms (attempt ${f.value})`),m=setTimeout(()=>{$.value===W&&J.currentSessionId===j?(m=null,I(j)):console.log(`[Gen ${W}] Skipping reconnect (generation or session changed)`)},oe)}},i.value.onerror=J=>{console.error(`[Gen ${W}] Session WebSocket error:`,J)}}function N(){return new Promise(j=>{if(m&&(clearTimeout(m),m=null,console.log("Cancelled pending session reconnect timer")),i.value){const W=p.value,Q=()=>{i.value=null,u.value=!1,p.value=null,$.value=null,f.value=0,W&&c.value.delete(W),j()};if(i.value.readyState===WebSocket.CLOSED)Q();else{const J=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),Q()},2e3);i.value.addEventListener("close",()=>{clearTimeout(J),Q()},{once:!0}),i.value.close()}}else p.value=null,$.value=null,j()})}function K(j){i.value&&u.value?(i.value.send(JSON.stringify({type:"send_message",content:j})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function R(j,W,Q=!1,J=null,oe=null){if(i.value&&u.value){const Se={type:"permission_response",request_id:j,decision:W,apply_suggestions:Q,timestamp:new Date().toISOString()};J&&(Se.clarification_message=J),oe&&(Se.selected_suggestions=oe),i.value.send(JSON.stringify(Se)),console.log(`Sent permission ${W} for request ${j}`,{applySuggestions:Q,clarification:J,selectedSuggestions:oe})}}function q(j,W,Q){if(i.value&&u.value){const J={type:"permission_response",request_id:j,decision:W,updated_input:Q,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(J)),console.log(`Sent permission ${W} with updated_input for request ${j}`,Q)}}function ee(){i.value&&u.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ue(j){const W=ve(),Q=ze();switch(j.type){case"sessions_list":j.sessions&&Array.isArray(j.sessions)&&j.sessions.forEach(J=>{W.updateSession(J.session_id,J)});break;case"state_change":j.data&&j.data.session_id&&j.data.session&&W.updateSession(j.data.session_id,j.data.session);break;case"project_updated":if(j.data&&j.data.project){const J=j.data.project;Q.updateProjectLocal(J.project_id,J),W.fetchSessions()}break;case"project_deleted":j.data&&j.data.project_id&&Q.projects.delete(j.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":x.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",j.type)}}function ie(j,W){const Q=ve();if(Q.currentSessionId!==W){console.warn(`Ignoring message for session ${W} (current: ${Q.currentSessionId})`);return}const J=Pe();switch(j.type){case"message":const oe=j.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",j);break}if(oe.type==="tool_call"){J.handleToolCall(W,oe);break}oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&Q.storeInitData(W,oe.metadata.init_data),J.addMessage(W,oe);break;case"state_change":Q.updateSession(W,j.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${W}`);break;case"ping":E.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":j.resource&&(Qe().addResource(W,j.resource),console.log(`Resource registered for session ${W}:`,j.resource.resource_id));break;case"resource_removed":j.resource_id&&(Qe().handleResourceRemoved(W,j.resource_id),console.log(`Resource removed for session ${W}:`,j.resource_id));break;case"image_registered":j.image&&(Qe().addResource(W,{...j.image,resource_id:j.image.image_id}),console.log(`Image registered (legacy) for session ${W}:`,j.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",j.type)}}function he(j){ge(),b.value=j;const W=V(`/ws/legion/${j}`);console.log(`Connecting to Legion WebSocket: ${W}`),d.value=new WebSocket(W),d.value.onopen=()=>{y.value=!0,g.value=0,T.value=Date.now(),P("legion"),console.log(`Legion WebSocket connected for ${j}`)},d.value.onmessage=Q=>{const J=JSON.parse(Q.data);z(J,j)},d.value.onclose=()=>{if(F("legion"),y.value=!1,d.value=null,console.log(`Legion WebSocket closed for ${j}`),b.value===j&&g.value<_){g.value++;const Q=Math.min(2e3*g.value,3e4);setTimeout(()=>he(j),Q)}},d.value.onerror=Q=>{console.error("Legion WebSocket error:",Q)}}function ge(){d.value&&(d.value.close(),d.value=null,y.value=!1,b.value=null)}function z(j,W){Le(async()=>{const{useLegionStore:Q}=await Promise.resolve().then(()=>Ip);return{useLegionStore:Q}},void 0).then(({useLegionStore:Q})=>{const J=Q();switch(j.type){case"comm":j.comm&&(J.addComm(W,j.comm),console.log("Legion WebSocket: Received new comm",j.comm));break;case"minion_created":j.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",j.data),Le(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>Ln);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":j.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",j.data),Le(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>Ln);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"schedule_updated":Le(async()=>{const{useScheduleStore:oe}=await Promise.resolve().then(()=>_g);return{useScheduleStore:oe}},void 0).then(({useScheduleStore:oe})=>{oe().handleScheduleEvent(W,j)});break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${W}`);break;case"ping":T.value=Date.now(),d.value?.readyState===WebSocket.OPEN&&d.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",j.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:u,sessionRetryCount:f,legionConnected:y,legionRetryCount:g,currentLegionId:b,overallStatus:O,connectUI:U,disconnectUI:X,connectSession:I,disconnectSession:N,sendMessage:K,sendPermissionResponse:R,sendPermissionResponseWithInput:q,interruptSession:ee,connectLegion:he,disconnectLegion:ge}}),Gi=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:nt},Symbol.toStringTag,{value:"Module"})),Yi={class:"base-tool-handler"},Ji={class:"tool-section"},Qi={class:"tool-parameters"},Zi={class:"tool-code"},el={key:0,class:"tool-section"},tl={class:"tool-section-label"},sl={class:"tool-code"},nl={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=k(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)});return(f,h)=>(l(),r("div",Yi,[t("div",Ji,[h[0]||(h[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Qi,[t("pre",Zi,S(s.value),1)])]),o.value?(l(),r("div",el,[t("div",tl,S(i.value?"Error:":"Result:"),1),t("div",{class:H(["tool-result",{"tool-result-error":i.value}])},[t("pre",sl,S(u.value),1)],2)])):D("",!0)]))}},ol=se(nl,[["__scopeId","data-v-1e69f57d"]]),al={class:"read-tool-handler"},il={class:"tool-section"},ll={class:"read-file-info"},rl={class:"file-icon"},cl={class:"file-path"},ul={key:0,class:"read-range"},dl={key:0,class:"tool-section"},fl={key:0,class:"tool-result tool-result-error"},ml={class:"tool-code"},pl={key:1,class:"image-preview"},vl={class:"content-header"},hl={class:"image-badge"},gl={class:"image-container"},_l=["src","alt"],bl={key:2,class:"file-content-preview"},yl={class:"content-header"},wl={class:"line-count-badge"},kl={key:0,class:"preview-note"},$l={class:"tool-code content-display"},Sl={key:0,class:"more-indicator"},Rs=100,xl={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.file_path||"Unknown"),o=k(()=>{const b=s.value;return b.split("/").pop()||b}),i=k(()=>{const b=e.toolCall.input?.offset,a=e.toolCall.input?.limit;return b!==void 0||a!==void 0}),u=k(()=>{const b=e.toolCall.input?.offset;return b!==void 0?b+1:1}),f=k(()=>{const b=e.toolCall.input?.offset||0,a=e.toolCall.input?.limit;return a!==void 0?b+a:"âˆž"}),h=k(()=>{const b=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(b)}),p=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=k(()=>{if(!p.value||m.value)return null;const a=e.toolCall.result?.content;if(Array.isArray(a)){for(const w of a)if(w?.type==="image"&&w?.source?.type==="base64"&&w?.source?.data)return w.source.data}return null}),$=k(()=>{if(!v.value)return"";const b=s.value.toLowerCase();return b.endsWith(".png")?"image/png":b.endsWith(".jpg")||b.endsWith(".jpeg")?"image/jpeg":b.endsWith(".gif")?"image/gif":b.endsWith(".webp")?"image/webp":b.endsWith(".svg")?"image/svg+xml":b.endsWith(".bmp")?"image/bmp":b.endsWith(".ico")?"image/x-icon":"image/png"}),c=k(()=>{if(!p.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)}),d=k(()=>m.value||!c.value||v.value?[]:c.value.split(`
`)),y=k(()=>d.value.length),g=k(()=>y.value>Rs),_=k(()=>m.value||v.value?"":d.value.slice(0,Rs).join(`
`));return(b,a)=>(l(),r("div",al,[t("div",il,[t("div",ll,[t("span",rl,S(h.value?"ðŸ–¼ï¸":"ðŸ“„"),1),a[0]||(a[0]=t("strong",null,"Reading:",-1)),t("code",cl,S(s.value),1),i.value?(l(),r("span",ul,"Lines "+S(u.value)+"-"+S(f.value),1)):D("",!0)])]),p.value?(l(),r("div",dl,[m.value?(l(),r("div",fl,[t("pre",ml,S(c.value),1)])):v.value?(l(),r("div",pl,[t("div",vl,[a[1]||(a[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",hl,S($.value),1)]),t("div",gl,[t("img",{src:`data:${$.value};base64,${v.value}`,alt:o.value,class:"preview-image"},null,8,_l)])])):(l(),r("div",bl,[t("div",yl,[a[2]||(a[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",wl,S(y.value)+" lines",1),g.value?(l(),r("span",kl,"(showing first "+S(Rs)+")")):D("",!0)]),t("pre",$l,S(_.value),1),g.value?(l(),r("div",Sl,"...")):D("",!0)]))])):D("",!0)]))}},Cl=se(xl,[["__scopeId","data-v-29b774b1"]]),El={class:"write-tool-handler"},Tl={class:"tool-section"},Al={class:"write-file-info mb-2"},Dl={class:"file-path"},Ol={class:"write-content-preview"},Ml={class:"content-header"},Ll={class:"line-count-badge"},Nl={key:0,class:"preview-note"},Il={class:"tool-code content-display"},jl={key:0,class:"more-indicator"},Pl={key:0,class:"tool-section"},Rl={key:0,class:"tool-result tool-result-error"},Bl={class:"tool-code"},Fl={key:1,class:"tool-result tool-result-success"},Vl={class:"success-message"},Bs=100,Ul={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.file_path||"Unknown"),o=k(()=>e.toolCall.input?.content||""),i=k(()=>o.value.split(`
`)),u=k(()=>i.value.length),f=k(()=>u.value>Bs),h=k(()=>i.value.slice(0,Bs).join(`
`)),p=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=k(()=>{if(!p.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,c)=>(l(),r("div",El,[t("div",Tl,[t("div",Al,[c[0]||(c[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),c[1]||(c[1]=t("strong",null,"Writing:",-1)),t("code",Dl,S(s.value),1)]),t("div",Ol,[t("div",Ml,[c[2]||(c[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Ll,S(u.value)+" lines",1),f.value?(l(),r("span",Nl,"(showing first "+S(Bs)+")")):D("",!0)]),t("pre",Il,S(h.value),1),f.value?(l(),r("div",jl,"...")):D("",!0)])]),p.value?(l(),r("div",Pl,[m.value?(l(),r("div",Rl,[c[3]||(c[3]=t("strong",null,"Error:",-1)),t("pre",Bl,S(v.value),1)])):(l(),r("div",Fl,[t("div",Vl,[c[4]||(c[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+S(u.value)+" lines written)",1)])]))])):D("",!0)]))}},Wl=se(Ul,[["__scopeId","data-v-ddc24a0f"]]),Hl={class:"bash-tool-handler"},zl={class:"tool-section"},ql={class:"bash-header"},Kl={class:"bash-header-content"},Xl={key:0,class:"bash-description"},Gl={key:1,class:"bash-flags"},Yl={class:"bash-command-section"},Jl={class:"bash-command-content"},Ql={key:0,class:"tool-section"},Zl={key:0,class:"bash-output"},er={key:1,class:"bash-output-empty"},tr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.command||""),o=k(()=>e.toolCall.input?.description||""),i=k(()=>e.toolCall.input?.timeout),u=k(()=>e.toolCall.input?.run_in_background||!1),f=k(()=>i.value||u.value),h=k(()=>{const c=[];return i.value&&c.push(`timeout: ${i.value}ms`),u.value&&c.push("background"),c.join(", ")}),p=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=k(()=>m.value?"tool-result-error":"tool-result-success"),$=k(()=>{if(!p.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,d)=>(l(),r("div",Hl,[t("div",zl,[t("div",ql,[d[1]||(d[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Kl,[o.value?(l(),r("div",Xl,[d[0]||(d[0]=t("strong",null,"Description:",-1)),ce(" "+S(o.value),1)])):D("",!0),f.value?(l(),r("div",Gl,S(h.value),1)):D("",!0)])]),t("div",Yl,[d[2]||(d[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Jl,S(s.value),1)])]),p.value?(l(),r("div",Ql,[t("div",{class:H(["tool-result",v.value])},[d[3]||(d[3]=t("strong",null,"Output:",-1)),$.value?(l(),r("pre",Zl,S($.value),1)):(l(),r("div",er,"No output"))],2)])):D("",!0)]))}},sr=se(tr,[["__scopeId","data-v-ab50fe73"]]),nr={class:"todo-tool-handler"},or={class:"tool-section"},ar={class:"todo-header"},ir={class:"todo-summary"},lr={key:0,class:"todo-count todo-count-completed"},rr={key:1,class:"todo-count todo-count-in-progress"},cr={key:2,class:"todo-count todo-count-pending"},ur={class:"todo-checklist"},dr={class:"todo-checkbox"},fr={class:"todo-content"},mr={key:0,class:"tool-section"},pr={key:0,class:"tool-result tool-result-error"},vr={class:"tool-code"},hr={key:1,class:"tool-result tool-result-success"},gr={class:"success-message"},_r={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.todos||[]),o=k(()=>s.value.filter(v=>v.status==="completed").length),i=k(()=>s.value.filter(v=>v.status==="in_progress").length),u=k(()=>s.value.filter(v=>v.status==="pending").length);function f(v){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[v]||"â˜"}const h=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=k(()=>{if(!h.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,$)=>(l(),r("div",nr,[t("div",or,[t("div",ar,[$[0]||($[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=t("strong",null,"Task List:",-1)),t("div",ir,[o.value>0?(l(),r("span",lr,S(o.value)+" completed ",1)):D("",!0),i.value>0?(l(),r("span",rr,S(i.value)+" in progress ",1)):D("",!0),u.value>0?(l(),r("span",cr,S(u.value)+" pending ",1)):D("",!0)])]),t("div",ur,[(l(!0),r(te,null,le(s.value,(c,d)=>(l(),r("div",{key:d,class:H(["todo-item",`todo-${c.status}`])},[t("span",dr,S(f(c.status)),1),t("span",fr,S(c.content),1)],2))),128))])]),h.value?(l(),r("div",mr,[p.value?(l(),r("div",pr,[$[2]||($[2]=t("strong",null,"Error:",-1)),t("pre",vr,S(m.value),1)])):(l(),r("div",hr,[t("div",gr,[$[3]||($[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+S(s.value.length)+" tasks)",1)])]))])):D("",!0)]))}},br=se(_r,[["__scopeId","data-v-bbe55ee7"]]),yr={class:"edit-tool-handler"},wr={class:"tool-section"},kr={class:"edit-file-info"},$r={class:"file-path"},Sr={key:0,class:"replace-all-badge"},xr={class:"edit-diff-container"},Cr={class:"diff-header"},Er={class:"diff-stats"},Tr={class:"stat-removed"},Ar={class:"stat-added"},Dr={class:"unified-diff"},Or={class:"diff-scroll-container"},Mr={class:"diff-marker"},Lr={class:"diff-content"},Nr={key:0,class:"tool-section"},Ir={key:0,class:"tool-result tool-result-error"},jr={class:"tool-code"},Pr={key:1,class:"tool-result tool-result-success"},Rr={class:"success-message"},Br={key:0,class:"success-detail"},Fr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.file_path||"Unknown"),o=k(()=>e.toolCall.input?.old_string||""),i=k(()=>e.toolCall.input?.new_string||""),u=k(()=>e.toolCall.input?.replace_all||!1),f=k(()=>{const d=Xa(s.value,o.value,i.value,"","",{context:3}).split(`
`),y=[];for(let g=4;g<d.length;g++){const _=d[g];_&&(_.startsWith("-")?y.push({type:"removed",content:_.substring(1)}):_.startsWith("+")?y.push({type:"added",content:_.substring(1)}):_.startsWith(" ")?y.push({type:"context",content:_.substring(1)}):_.startsWith("@@")&&y.push({type:"hunk",content:_}))}return y}),h=k(()=>f.value.filter(c=>c.type==="removed").length),p=k(()=>f.value.filter(c=>c.type==="added").length),m=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=k(()=>{if(!m.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,d)=>(l(),r("div",yr,[t("div",wr,[t("div",kr,[d[0]||(d[0]=t("span",{class:"file-icon"},"âœï¸",-1)),d[1]||(d[1]=t("strong",null,"Editing:",-1)),t("code",$r,S(s.value),1),u.value?(l(),r("span",Sr,"Replace All")):D("",!0)]),t("div",xr,[t("div",Cr,[d[2]||(d[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Er,[t("span",Tr,"-"+S(h.value),1),t("span",Ar,"+"+S(p.value),1)])]),t("div",Dr,[t("div",Or,[(l(!0),r(te,null,le(f.value,(y,g)=>(l(),r("div",{key:g,class:H(["diff-line",{"diff-line-removed":y.type==="removed","diff-line-added":y.type==="added","diff-line-context":y.type==="context","diff-line-hunk":y.type==="hunk"}])},[t("span",Mr,S(y.type==="removed"?"-":y.type==="added"?"+":y.type==="hunk"?"@":" "),1),t("span",Lr,S(y.content),1)],2))),128))])])])]),m.value?(l(),r("div",Nr,[v.value?(l(),r("div",Ir,[d[3]||(d[3]=t("strong",null,"Error:",-1)),t("pre",jr,S($.value),1)])):(l(),r("div",Pr,[t("div",Rr,[d[4]||(d[4]=t("span",{class:"success-icon"},"âœ…",-1)),d[5]||(d[5]=t("strong",null,"File edited successfully",-1)),u.value?(l(),r("span",Br,"(all occurrences replaced)")):D("",!0)])]))])):D("",!0)]))}},Vr=se(Fr,[["__scopeId","data-v-dd74055e"]]),Ur={class:"search-tool-handler"},Wr={class:"tool-section"},Hr={class:"search-info"},zr={class:"search-icon"},qr={class:"search-pattern"},Kr={key:0,class:"search-path"},Xr={key:1,class:"search-filters"},Gr={key:0,class:"filter-badge"},Yr={key:1,class:"filter-badge"},Jr={key:2,class:"filter-badge"},Qr={key:0,class:"tool-section"},Zr={key:0,class:"tool-result tool-result-error"},ec={class:"tool-code"},tc={key:1,class:"search-results"},sc={class:"results-header"},nc={class:"results-label"},oc={class:"results-count-badge"},ac={class:"results-content"},ic={class:"tool-code"},lc={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.name==="Grep"),o=k(()=>e.toolCall.input?.pattern||"Unknown"),i=k(()=>e.toolCall.input?.path||null),u=k(()=>e.toolCall.input?.type||null),f=k(()=>e.toolCall.input?.glob||null),h=k(()=>e.toolCall.input?.["-i"]||!1),p=k(()=>u.value||f.value||h.value),m=k(()=>s.value?"ðŸ”":"ðŸ“"),v=k(()=>s.value?"Searching content":"Finding files"),$=k(()=>s.value?"Matches":"Files found"),c=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=k(()=>{if(!c.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),g=k(()=>!c.value||d.value||!y.value?0:y.value.split(`
`).filter(b=>b.trim()).length);return(_,b)=>(l(),r("div",Ur,[t("div",Wr,[t("div",Hr,[t("span",zr,S(m.value),1),t("strong",null,S(v.value)+":",1),t("code",qr,S(o.value),1),i.value?(l(),r("span",Kr,"in "+S(i.value),1)):D("",!0),p.value?(l(),r("span",Xr,[u.value?(l(),r("span",Gr,"type: "+S(u.value),1)):D("",!0),f.value?(l(),r("span",Yr,"glob: "+S(f.value),1)):D("",!0),h.value?(l(),r("span",Jr,"case-insensitive")):D("",!0)])):D("",!0)])]),c.value?(l(),r("div",Qr,[d.value?(l(),r("div",Zr,[b[0]||(b[0]=t("strong",null,"Error:",-1)),t("pre",ec,S(y.value),1)])):(l(),r("div",tc,[t("div",sc,[t("span",nc,S($.value)+":",1),t("span",oc,S(g.value)+" "+S(g.value===1?"match":"matches"),1)]),t("div",ac,[t("pre",ic,S(y.value),1)])]))])):D("",!0)]))}},Pn=se(lc,[["__scopeId","data-v-0d272c39"]]),rc={class:"web-tool-handler"},cc={class:"tool-section"},uc={class:"web-info"},dc={class:"web-icon"},fc=["href"],mc={key:1,class:"web-query"},pc={key:0,class:"web-prompt-container"},vc={class:"prompt-content"},hc={key:1,class:"web-domains"},gc={class:"domains-label"},_c={key:0,class:"tool-section"},bc={key:0,class:"tool-result tool-result-error"},yc={class:"tool-code"},wc={key:1,class:"web-results"},kc={class:"results-header"},$c={class:"results-label"},Sc={class:"results-content"},xc={class:"tool-code"},Cc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.name==="WebFetch"),o=k(()=>e.toolCall.input?.url||null),i=k(()=>e.toolCall.input?.query||null),u=k(()=>e.toolCall.input?.prompt||null),f=k(()=>e.toolCall.input?.allowed_domains||[]),h=k(()=>e.toolCall.input?.blocked_domains||[]),p=k(()=>f.value.length>0?f.value:h.value.length>0?h.value:[]),m=k(()=>f.value.length>0?"Allowed domains":h.value.length>0?"Blocked domains":"Domains"),v=k(()=>s.value?"ðŸŒ":"ðŸ”Ž"),$=k(()=>s.value?"Fetching URL":"Searching web"),c=k(()=>s.value?"Fetched content":"Search results"),d=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),y=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=k(()=>{if(!d.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,b)=>(l(),r("div",rc,[t("div",cc,[t("div",uc,[t("span",dc,S(v.value),1),t("strong",null,S($.value)+":",1),o.value?(l(),r("a",{key:0,href:o.value,target:"_blank",class:"web-url"},S(o.value),9,fc)):i.value?(l(),r("code",mc,S(i.value),1)):D("",!0)]),u.value?(l(),r("div",pc,[b[0]||(b[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",vc,S(u.value),1)])):D("",!0),p.value.length>0?(l(),r("div",hc,[t("span",gc,S(m.value)+":",1),(l(!0),r(te,null,le(p.value,a=>(l(),r("span",{key:a,class:"domain-badge"},S(a),1))),128))])):D("",!0)]),d.value?(l(),r("div",_c,[y.value?(l(),r("div",bc,[b[1]||(b[1]=t("strong",null,"Error:",-1)),t("pre",yc,S(g.value),1)])):(l(),r("div",wc,[t("div",kc,[t("span",$c,S(c.value)+":",1)]),t("div",Sc,[t("pre",xc,S(g.value),1)])]))])):D("",!0)]))}},Rn=se(Cc,[["__scopeId","data-v-62b55b55"]]),Ec={class:"task-tool-handler"},Tc={class:"tool-section"},Ac={class:"task-header"},Dc={key:0,class:"agent-type-badge"},Oc={key:0,class:"task-description"},Mc={class:"description-content"},Lc={key:1,class:"task-prompt-container"},Nc={class:"prompt-header"},Ic={class:"prompt-length"},jc={class:"prompt-code"},Pc={key:0,class:"tool-section"},Rc={key:0,class:"tool-result tool-result-error"},Bc={class:"tool-code"},Fc={key:1,class:"agent-output"},Vc={class:"output-header"},Uc={key:0,class:"output-count-badge"},Wc={class:"output-content"},Hc={class:"tool-code"},zc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.description||null),o=k(()=>e.toolCall.input?.prompt||null),i=k(()=>e.toolCall.input?.subagent_type||null),u=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=k(()=>{if(!u.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),p=k(()=>h.value?h.value.split(`
`).length:0);return(m,v)=>(l(),r("div",Ec,[t("div",Tc,[t("div",Ac,[v[0]||(v[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),v[1]||(v[1]=t("strong",null,"Agent Task:",-1)),i.value?(l(),r("span",Dc,S(i.value),1)):D("",!0)]),s.value?(l(),r("div",Oc,[v[2]||(v[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Mc,S(s.value),1)])):D("",!0),o.value?(l(),r("div",Lc,[t("div",Nc,[v[3]||(v[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Ic,S(o.value.length)+" characters",1)]),t("pre",jc,S(o.value),1)])):D("",!0)]),u.value?(l(),r("div",Pc,[f.value?(l(),r("div",Rc,[v[4]||(v[4]=t("strong",null,"Error:",-1)),t("pre",Bc,S(h.value),1)])):(l(),r("div",Fc,[t("div",Vc,[v[5]||(v[5]=t("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(l(),r("span",Uc,S(p.value)+" lines",1)):D("",!0)]),t("div",Wc,[t("pre",Hc,S(h.value),1)])]))])):D("",!0)]))}},qc=se(zc,[["__scopeId","data-v-c520c244"]]),Kc={class:"task-create-tool-handler"},Xc={class:"tool-section"},Gc={class:"task-details p-2"},Yc={key:0,class:"task-field mb-2"},Jc={class:"field-value subject-value"},Qc={key:1,class:"task-field mb-2"},Zc={class:"field-value description-value"},eu={key:2,class:"task-field"},tu={class:"field-value active-form-value"},su={key:0,class:"tool-section mt-2"},nu={key:0,class:"tool-result tool-result-error"},ou={class:"tool-code"},au={key:1,class:"tool-result tool-result-success"},iu={class:"result-text"},lu={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.subject||null),o=k(()=>e.toolCall.input?.description||null),i=k(()=>e.toolCall.input?.activeForm||null),u=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=k(()=>{if(!u.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,m)=>(l(),r("div",Kc,[t("div",Xc,[m[3]||(m[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Gc,[s.value?(l(),r("div",Yc,[m[0]||(m[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Jc,S(s.value),1)])):D("",!0),o.value?(l(),r("div",Qc,[m[1]||(m[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Zc,S(o.value),1)])):D("",!0),i.value?(l(),r("div",eu,[m[2]||(m[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",tu,S(i.value),1)])):D("",!0)])]),u.value?(l(),r("div",su,[f.value?(l(),r("div",nu,[m[4]||(m[4]=t("strong",null,"Error:",-1)),t("pre",ou,S(h.value),1)])):(l(),r("div",au,[m[5]||(m[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",iu,S(h.value),1)]))])):D("",!0)]))}},ru=se(lu,[["__scopeId","data-v-474dd444"]]),cu={class:"task-update-tool-handler"},uu={class:"tool-section"},du={class:"task-header"},fu={key:0,class:"task-id-badge"},mu={class:"task-details p-2"},pu={key:0,class:"task-field mb-2"},vu={key:1,class:"task-field mb-2"},hu={class:"field-value"},gu={key:2,class:"task-field mb-2"},_u={class:"field-value description-value"},bu={key:3,class:"task-field mb-2"},yu={class:"field-value active-form-value"},wu={key:4,class:"task-field mb-2"},ku={class:"field-value"},$u={key:5,class:"task-field mb-2"},Su={class:"field-value"},xu={key:6,class:"task-field"},Cu={class:"field-value"},Eu={key:0,class:"tool-section mt-2"},Tu={key:0,class:"tool-result tool-result-error"},Au={class:"tool-code"},Du={key:1,class:"tool-result tool-result-success"},Ou={class:"result-text"},Mu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.taskId||null),o=k(()=>e.toolCall.input?.status||null),i=k(()=>e.toolCall.input?.subject||null),u=k(()=>e.toolCall.input?.description||null),f=k(()=>e.toolCall.input?.activeForm||null),h=k(()=>e.toolCall.input?.owner||null),p=k(()=>e.toolCall.input?.addBlockedBy||[]),m=k(()=>e.toolCall.input?.addBlocks||[]),v=k(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),$=k(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),c=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=k(()=>{if(!c.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,_)=>(l(),r("div",cu,[t("div",uu,[t("div",du,[_[0]||(_[0]=t("span",{class:"task-icon"},"âœï¸",-1)),_[1]||(_[1]=t("strong",null,"Update Task",-1)),s.value?(l(),r("span",fu,"#"+S(s.value),1)):D("",!0)]),t("div",mu,[o.value?(l(),r("div",pu,[_[2]||(_[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:H(["field-value status-value",$.value])},S(v.value)+" "+S(o.value),3)])):D("",!0),i.value?(l(),r("div",vu,[_[3]||(_[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",hu,S(i.value),1)])):D("",!0),u.value?(l(),r("div",gu,[_[4]||(_[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",_u,S(u.value),1)])):D("",!0),f.value?(l(),r("div",bu,[_[5]||(_[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",yu,S(f.value),1)])):D("",!0),h.value?(l(),r("div",wu,[_[6]||(_[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",ku,S(h.value),1)])):D("",!0),p.value?.length?(l(),r("div",$u,[_[7]||(_[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",Su,[(l(!0),r(te,null,le(p.value,b=>(l(),r("span",{key:b,class:"badge bg-warning text-dark me-1"},"#"+S(b),1))),128))])])):D("",!0),m.value?.length?(l(),r("div",xu,[_[8]||(_[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",Cu,[(l(!0),r(te,null,le(m.value,b=>(l(),r("span",{key:b,class:"badge bg-info text-dark me-1"},"#"+S(b),1))),128))])])):D("",!0)])]),c.value?(l(),r("div",Eu,[d.value?(l(),r("div",Tu,[_[9]||(_[9]=t("strong",null,"Error:",-1)),t("pre",Au,S(y.value),1)])):(l(),r("div",Du,[_[10]||(_[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Ou,S(y.value),1)]))])):D("",!0)]))}},Lu=se(Mu,[["__scopeId","data-v-35582330"]]),Nu={class:"task-list-tool-handler"},Iu={key:0,class:"tool-section"},ju={key:0,class:"tool-result tool-result-error"},Pu={class:"tool-code"},Ru={key:1,class:"task-list-result"},Bu={key:0,class:"parsed-tasks"},Fu={class:"status-icon"},Vu={class:"task-id text-muted"},Uu={class:"task-subject flex-grow-1"},Wu={key:0,class:"task-owner badge bg-secondary"},Hu={key:1,class:"raw-result p-2"},zu={class:"tool-code"},qu={key:1,class:"tool-section"},Ku={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=k(()=>{if(!s.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),u=k(()=>{if(!i.value)return[];const h=[],m=i.value.split(`
`);for(const v of m){const $=v.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if($){const c=$[2].toLowerCase();h.push({id:$[1],status:c,subject:$[3].trim(),owner:null,statusIcon:f(c)})}}return h});function f(h){switch(h){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(h,p)=>(l(),r("div",Nu,[p[2]||(p[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(l(),r("div",Iu,[o.value?(l(),r("div",ju,[p[0]||(p[0]=t("strong",null,"Error:",-1)),t("pre",Pu,S(i.value),1)])):(l(),r("div",Ru,[u.value.length>0?(l(),r("div",Bu,[(l(!0),r(te,null,le(u.value,(m,v)=>(l(),r("div",{key:v,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",Fu,S(m.statusIcon),1),t("span",Vu,"#"+S(m.id),1),t("span",Uu,S(m.subject),1),m.owner?(l(),r("span",Wu,S(m.owner),1)):D("",!0)]))),128))])):(l(),r("div",Hu,[t("pre",zu,S(i.value),1)]))]))])):n.toolCall.status==="completed"?(l(),r("div",qu,[...p[1]||(p[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):D("",!0)]))}},Xu=se(Ku,[["__scopeId","data-v-4e79ba4b"]]),Gu={class:"task-get-tool-handler"},Yu={class:"tool-section"},Ju={class:"task-header"},Qu={key:0,class:"task-id-badge"},Zu={key:0,class:"tool-section"},ed={key:0,class:"tool-result tool-result-error"},td={class:"tool-code"},sd={key:1,class:"task-details-result p-2"},nd={key:0,class:"parsed-task"},od={class:"task-field mb-2"},ad={class:"field-value subject-value"},id={key:0,class:"task-field mb-2"},ld={key:1,class:"task-field mb-2"},rd={class:"field-value description-value"},cd={key:2,class:"task-field mb-2"},ud={class:"field-value"},dd={key:3,class:"task-field mb-2"},fd={class:"field-value"},md={key:4,class:"task-field"},pd={class:"field-value"},vd={key:1,class:"raw-result"},hd={class:"tool-code"},gd={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.taskId||null),o=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=k(()=>{if(!o.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),f=k(()=>{if(!u.value)return null;const m=u.value;try{const c=JSON.parse(m);if(c&&typeof c=="object")return{subject:c.subject||c.title||"",status:c.status||"",description:c.description||"",owner:c.owner||"",blockedBy:c.blockedBy||[],blocks:c.blocks||[]}}catch{}const v=m.split(`
`),$={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const c of v){const d=c.match(/^Subject:\s*(.+)$/i);d&&($.subject=d[1].trim());const y=c.match(/^Status:\s*(.+)$/i);y&&($.status=y[1].trim());const g=c.match(/^Description:\s*(.+)$/i);g&&($.description=g[1].trim());const _=c.match(/^Owner:\s*(.+)$/i);_&&($.owner=_[1].trim())}return $.subject?$:null}),h=k(()=>{if(!f.value)return"";switch(f.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),p=k(()=>{if(!f.value)return"";switch(f.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(m,v)=>(l(),r("div",Gu,[t("div",Yu,[t("div",Ju,[v[0]||(v[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),v[1]||(v[1]=t("strong",null,"Get Task",-1)),s.value?(l(),r("span",Qu,"#"+S(s.value),1)):D("",!0)])]),o.value?(l(),r("div",Zu,[i.value?(l(),r("div",ed,[v[2]||(v[2]=t("strong",null,"Error:",-1)),t("pre",td,S(u.value),1)])):(l(),r("div",sd,[f.value?(l(),r("div",nd,[t("div",od,[v[3]||(v[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",ad,S(f.value.subject),1)]),f.value.status?(l(),r("div",id,[v[4]||(v[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:H(["field-value",p.value])},S(h.value)+" "+S(f.value.status),3)])):D("",!0),f.value.description?(l(),r("div",ld,[v[5]||(v[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",rd,S(f.value.description),1)])):D("",!0),f.value.owner?(l(),r("div",cd,[v[6]||(v[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",ud,S(f.value.owner),1)])):D("",!0),f.value.blockedBy?.length?(l(),r("div",dd,[v[7]||(v[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",fd,[(l(!0),r(te,null,le(f.value.blockedBy,$=>(l(),r("span",{key:$,class:"badge bg-warning text-dark me-1"},"#"+S($),1))),128))])])):D("",!0),f.value.blocks?.length?(l(),r("div",md,[v[8]||(v[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",pd,[(l(!0),r(te,null,le(f.value.blocks,$=>(l(),r("span",{key:$,class:"badge bg-info text-dark me-1"},"#"+S($),1))),128))])])):D("",!0)])):(l(),r("div",vd,[t("pre",hd,S(u.value),1)]))]))])):D("",!0)]))}},_d=se(gd,[["__scopeId","data-v-a80d14da"]]),bd={class:"notebook-edit-tool-handler"},yd={class:"tool-section"},wd={class:"notebook-info"},kd={class:"file-path"},$d={class:"cell-info mt-2"},Sd={class:"info-row"},xd={class:"info-row"},Cd={key:0,class:"info-row"},Ed={class:"badge bg-info"},Td={key:0,class:"source-preview mt-3"},Ad={class:"preview-header"},Dd={class:"preview-stats"},Od={class:"source-code"},Md={key:0,class:"tool-section"},Ld={key:0},Nd={key:1,class:"text-danger"},Id={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.notebook_path||"Unknown"),o=k(()=>e.toolCall.input?.cell_id),i=k(()=>e.toolCall.input?.cell_type||"code"),u=k(()=>e.toolCall.input?.edit_mode||"replace"),f=k(()=>e.toolCall.input?.new_source||""),h=k(()=>f.value.split(`
`).length),p=k(()=>i.value==="code"?"bg-primary":"bg-secondary"),m=k(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),v=k(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=u.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,c)=>(l(),r("div",bd,[t("div",yd,[t("div",wd,[c[0]||(c[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),c[1]||(c[1]=t("strong",null,"Notebook:",-1)),t("code",kd,S(s.value),1)]),t("div",$d,[t("div",Sd,[c[2]||(c[2]=t("strong",null,"Cell ID:",-1)),t("code",null,S(o.value||"N/A"),1)]),t("div",xd,[c[3]||(c[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:H(["badge",p.value])},S(i.value),3)]),u.value?(l(),r("div",Cd,[c[4]||(c[4]=t("strong",null,"Edit Mode:",-1)),t("span",Ed,S(u.value),1)])):D("",!0)]),f.value?(l(),r("div",Td,[t("div",Ad,[c[5]||(c[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",Dd,S(h.value)+" lines",1)]),t("pre",Od,[t("code",null,S(f.value),1)])])):D("",!0)]),n.toolCall.result?(l(),r("div",Md,[c[6]||(c[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:H(["tool-result",m.value])},[n.toolCall.result.success!==!1?(l(),r("div",Ld," âœ… "+S(v.value),1)):(l(),r("div",Nd," â— "+S(n.toolCall.result.error||"Operation failed"),1))],2)])):D("",!0)]))}},jd=se(Id,[["__scopeId","data-v-c81a9bcf"]]),Pd={class:"shell-tool-handler"},Rd={class:"tool-section"},Bd={class:"shell-info"},Fd={class:"shell-icon"},Vd={key:0,class:"shell-id"},Ud={key:0,class:"filter-info mt-2"},Wd={class:"filter-pattern"},Hd={key:0,class:"tool-section"},zd={class:"result-header mb-2"},qd={key:0,class:"mb-2"},Kd={class:"shell-output"},Xd={key:1,class:"mb-2"},Gd={class:"shell-output shell-output-error"},Yd={key:0},Jd={key:1,class:"text-danger"},Qd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=k(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=k(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),u=k(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),f=k(()=>e.toolCall.input?.filter);function h(d,y){if(!d)return null;const g=new RegExp(`<${y}>([\\s\\S]*?)<\\/${y}>`,"i"),_=d.match(g);return _?_[1].trim():null}const p=k(()=>{const d=e.toolCall.result;if(!d)return null;let y=d;if(d.content&&(y=d.content),typeof y=="string")return{status:h(y,"status"),stdout:h(y,"stdout"),stderr:h(y,"stderr"),exit_code:h(y,"exit_code")};if(Array.isArray(y)){const g=y.find(_=>_.type==="text")?.text||"";return{status:h(g,"status"),stdout:h(g,"stdout"),stderr:h(g,"stderr"),exit_code:h(g,"exit_code")}}return{status:d.status||y.status,stdout:d.stdout||d.output||y.stdout||y.output,stderr:d.stderr||y.stderr,exit_code:d.exit_code||y.exit_code}}),m=k(()=>p.value?.status),v=k(()=>{const d=m.value;return d==="running"?"bg-success":d==="completed"?"bg-secondary":d==="killed"||d==="terminated"?"bg-danger":"bg-info"}),$=k(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=k(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const d=p.value;if(d?.status==="running"&&!d.stdout&&!d.stderr)return"No new output since last check";if(d?.status==="failed")return`Shell failed (exit code ${d.exit_code||"unknown"})`}return"Operation completed"});return(d,y)=>(l(),r("div",Pd,[t("div",Rd,[t("div",Bd,[t("span",Fd,S(s.value),1),t("strong",null,S(o.value)+":",1),u.value?(l(),r("code",Vd,"Shell "+S(u.value),1)):D("",!0)]),n.toolCall.name==="BashOutput"&&f.value?(l(),r("div",Ud,[y[0]||(y[0]=t("strong",null,"Filter:",-1)),t("code",Wd,S(f.value),1)])):D("",!0)]),n.toolCall.result?(l(),r("div",Hd,[t("div",zd,[t("strong",null,S(i.value)+":",1),m.value?(l(),r("span",{key:0,class:H(["badge",v.value])},S(m.value),3)):D("",!0)]),p.value?.stdout?(l(),r("div",qd,[y[1]||(y[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Kd,[t("pre",null,[t("code",null,S(p.value.stdout),1)])])])):D("",!0),p.value?.stderr?(l(),r("div",Xd,[y[2]||(y[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Gd,[t("pre",null,[t("code",null,S(p.value.stderr),1)])])])):D("",!0),!p.value?.stdout&&!p.value?.stderr?(l(),r("div",{key:2,class:H(["tool-result",$.value])},[n.toolCall.result.success!==!1?(l(),r("div",Yd," âœ… "+S(c.value),1)):(l(),r("div",Jd," â— "+S(n.toolCall.result.error||"Operation failed"),1))],2)):D("",!0)])):D("",!0)]))}},Bn=se(Qd,[["__scopeId","data-v-86def281"]]),Zd={class:"skill-tool-handler"},ef={key:0,class:"tool-section"},tf={class:"d-flex align-items-center gap-2"},sf={class:"text-muted small"},nf={key:0,class:"skill-content-body"},of={class:"skill-content-text"},af={key:1,class:"tool-section mt-3"},lf={class:"tool-result tool-result-error"},rf={class:"tool-code"},cf={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=ve(),i=M(!1);function u(){i.value=!i.value}const f=k(()=>{const c=o.currentSessionId;if(!c)return{running:null,content:null};const d=s.messagesBySession.get(c)||[],y=d.findIndex(b=>b.type==="user"&&b.metadata?.has_tool_results&&b.metadata?.tool_results?.some(a=>a.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let g=null,_=null;for(let b=y+1;b<Math.min(y+3,d.length);b++){const a=d[b];if(a.type!=="user")continue;const w=a.content||"";w.includes("<command-message>")&&w.includes("skill is running")?g=a:w.startsWith("Base directory for this skill:")&&(_=a)}return{running:g,content:_}}),h=k(()=>{const c=f.value.content;if(!c)return"";const d=c.content||"",y=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return d.replace(y,"").trim()}),p=k(()=>h.value.length>0),m=k(()=>h.value?h.value.split(`
`).length:0),v=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=k(()=>{if(!v.value)return"";const c=e.toolCall.result;return c?.message?c.message:c?.error?c.error:"An error occurred"});return(c,d)=>(l(),r("div",Zd,[p.value?(l(),r("div",ef,[t("div",{class:"skill-content-header",onClick:u},[t("div",tf,[t("i",{class:H(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),d[0]||(d[0]=t("strong",null,"Skill Content",-1)),t("span",sf,"("+S(m.value)+" lines)",1)])]),i.value?(l(),r("div",nf,[t("pre",of,S(h.value),1)])):D("",!0)])):D("",!0),v.value?(l(),r("div",af,[d[1]||(d[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",lf,[t("pre",rf,S($.value),1)])])):D("",!0)]))}},uf=se(cf,[["__scopeId","data-v-0a48ca0f"]]),df={class:"slashcommand-tool-handler"},ff={key:0,class:"tool-section"},mf={class:"d-flex align-items-center gap-2"},pf=["aria-label"],vf={class:"text-muted small"},hf={key:0,class:"command-content-body"},gf={class:"command-content-text"},_f={key:1,class:"tool-section mt-3"},bf={class:"tool-result tool-result-error"},yf={class:"tool-code"},wf={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=ve(),i=M(!1);function u(){i.value=!i.value}const f=k(()=>{const c=o.currentSessionId;if(!c)return{running:null,content:null};const d=s.messagesBySession.get(c)||[],y=d.findIndex(b=>b.type==="user"&&b.metadata?.has_tool_results&&b.metadata?.tool_results?.some(a=>a.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let g=null,_=null;for(let b=y+1;b<Math.min(y+3,d.length);b++){const a=d[b];if(a.type!=="user")continue;const w=a.content||"";w.includes("<command-message>")&&w.includes("<command-name>")&&w.includes("<command-args>")?g=a:w.includes("ARGUMENTS:")&&(_=a)}return{running:g,content:_}}),h=k(()=>{const c=f.value.content;if(!c)return"";const d=c.content||"",y=/\nARGUMENTS:.*$/s;return d.replace(y,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=k(()=>h.value.length>0),m=k(()=>h.value?h.value.split(`
`).length:0),v=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=k(()=>{if(!v.value)return"";const c=e.toolCall.result;return c?.message?c.message:c?.error?c.error:"An error occurred"});return(c,d)=>(l(),r("div",df,[p.value?(l(),r("div",ff,[t("div",{class:"command-content-header",onClick:u},[t("div",mf,[t("span",{"aria-label":i.value?"Collapse":"Expand"},S(i.value?"â–¾":"â–¸"),9,pf),d[0]||(d[0]=t("strong",null,"Command Content",-1)),t("span",vf,"("+S(m.value)+" lines)",1)])]),i.value?(l(),r("div",hf,[t("pre",gf,S(h.value),1)])):D("",!0)])):D("",!0),v.value?(l(),r("div",_f,[d[1]||(d[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",bf,[t("pre",yf,S($.value),1)])])):D("",!0)]))}},kf=se(wf,[["__scopeId","data-v-15991acf"]]),$f={class:"exit-plan-mode-tool-handler"},Sf={class:"tool-section"},xf={key:0,class:"plan-content mt-2"},Cf={class:"plan-text"},Ef={key:0,class:"tool-section"},Tf={key:0},Af={key:1,class:"text-danger"},Df={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.plan),o=k(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,u)=>(l(),r("div",$f,[t("div",Sf,[u[1]||(u[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(l(),r("div",xf,[u[0]||(u[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",Cf,S(s.value),1)])):D("",!0)]),n.toolCall.result?(l(),r("div",Ef,[u[2]||(u[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:H(["tool-result",o.value])},[n.toolCall.result.success!==!1?(l(),r("div",Tf," âœ… Permission mode reverted to default ")):(l(),r("div",Af," â— "+S(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):D("",!0)]))}},Of=se(Df,[["__scopeId","data-v-e2e3c781"]]),Mf={class:"ask-user-question-handler"},Lf={key:0,class:"answers-summary"},Nf={class:"answer-question text-muted small"},If={class:"answer-value fw-medium"},jf={key:1,class:"text-muted small"},Pf={key:0,class:"questions-container"},Rf={class:"question-header d-flex align-items-center gap-2 mb-2"},Bf={key:0,class:"badge bg-secondary"},Ff={class:"question-text fw-medium"},Vf={class:"options-list"},Uf=["id","checked","disabled","onChange"],Wf=["id","name","checked","disabled","onChange"],Hf=["for"],zf={class:"option-label"},qf={key:0,class:"option-description text-muted d-block small"},Kf={class:"option-item form-check other-option"},Xf=["id","checked","disabled","onChange"],Gf=["id","name","checked","disabled","onChange"],Yf=["for"],Jf={key:2,class:"other-input mt-2"},Qf=["onUpdate:modelValue","disabled","onInput"],Zf={key:1,class:"alert alert-info mb-0"},em={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,i=s,u=k(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),f=k(()=>{if(!u.value)return{};const x=o.toolCall.result;if(x?.content){if(typeof x.content=="object"&&x.content.answers)return x.content.answers;if(typeof x.content=="string")try{const T=JSON.parse(x.content);if(T.answers)return T.answers}catch{}}const E=o.toolCall.input||{};return E.answers?E.answers:{}}),h=k(()=>Object.keys(f.value).length>0),p=k(()=>(o.toolCall.input||{}).questions||[]),m=M({}),v=M({});de(p,x=>{x.forEach((E,T)=>{T in m.value||(m.value[T]=E.multiSelect?[]:null),T in v.value||(v.value[T]="")})},{immediate:!0});function $(x,E){const T=m.value[x];return Array.isArray(T)?T.includes(E):T===E}function c(x){const E=m.value[x];return Array.isArray(E)?E.includes("__OTHER__"):E==="__OTHER__"}function d(x,E){m.value[x]=E,a()}function y(x){m.value[x]="__OTHER__",a()}function g(x,E){const T=m.value[x];if(!Array.isArray(T))m.value[x]=[E];else{const A=T.indexOf(E);A===-1?T.push(E):T.splice(A,1)}a()}function _(x){const E=m.value[x];if(!Array.isArray(E))m.value[x]=["__OTHER__"];else{const T=E.indexOf("__OTHER__");T===-1?E.push("__OTHER__"):E.splice(T,1)}a()}function b(x){a()}function a(){const x={};p.value.forEach((E,T)=>{const A=m.value[T],L=E.question;if(E.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(O=>O==="__OTHER__"?v.value[T]||"":O).filter(O=>O);x[L]=C.join(", ")}}else A==="__OTHER__"?x[L]=v.value[T]||"":A&&(x[L]=A)}),i("answer",x)}const w=k(()=>p.value.every((x,E)=>{const T=m.value[E];if(x.multiSelect){if(!Array.isArray(T)||T.length===0||T.includes("__OTHER__")&&!v.value[E])return!1}else if(!T||T==="__OTHER__"&&!v.value[E])return!1;return!0}));return e({allQuestionsAnswered:w,getAnswers:()=>{const x={};return p.value.forEach((E,T)=>{const A=m.value[T],L=E.question;if(E.multiSelect){if(Array.isArray(A)&&A.length>0){const C=A.map(O=>O==="__OTHER__"?v.value[T]||"":O).filter(O=>O);x[L]=C.join(", ")}}else A==="__OTHER__"?x[L]=v.value[T]||"":A&&(x[L]=A)}),x}}),(x,E)=>(l(),r("div",Mf,[u.value?(l(),r(te,{key:0},[h.value?(l(),r("div",Lf,[(l(!0),r(te,null,le(f.value,(T,A)=>(l(),r("div",{key:A,class:"answer-item mb-2"},[t("div",Nf,S(A),1),t("div",If,S(T),1)]))),128))])):(l(),r("div",jf," No answers recorded. "))],64)):(l(),r(te,{key:1},[p.value.length>0?(l(),r("div",Pf,[(l(!0),r(te,null,le(p.value,(T,A)=>(l(),r("div",{key:A,class:"question-block mb-3"},[t("div",Rf,[T.header?(l(),r("span",Bf,S(T.header),1)):D("",!0),t("span",Ff,S(T.question),1)]),t("div",Vf,[(l(!0),r(te,null,le(T.options,(L,C)=>(l(),r("div",{key:C,class:H(["option-item form-check",{selected:$(A,L.label)}])},[T.multiSelect?(l(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-opt${C}`,checked:$(A,L.label),disabled:n.disabled,onChange:O=>g(A,L.label)},null,40,Uf)):(l(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-opt${C}`,name:`question-${A}`,checked:$(A,L.label),disabled:n.disabled,onChange:O=>d(A,L.label)},null,40,Wf)),t("label",{class:"form-check-label",for:`q${A}-opt${C}`},[t("span",zf,S(L.label),1),L.description?(l(),r("span",qf,S(L.description),1)):D("",!0)],8,Hf)],2))),128)),t("div",Kf,[T.multiSelect?(l(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-other`,checked:c(A),disabled:n.disabled,onChange:L=>_(A)},null,40,Xf)):(l(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-other`,name:`question-${A}`,checked:c(A),disabled:n.disabled,onChange:L=>y(A)},null,40,Gf)),t("label",{class:"form-check-label",for:`q${A}-other`},[...E[0]||(E[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Yf),c(A)?(l(),r("div",Jf,[$e(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":L=>v.value[A]=L,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:L=>b()},null,40,Qf),[[Me,v.value[A]]])])):D("",!0)])])]))),128))])):(l(),r("div",Zf," No questions to display. "))],64))]))}},Fn=se(em,[["__scopeId","data-v-ebcee33f"]]),tm={class:"timeline-detail"},sm={key:0,class:"detail-banner detail-banner-warning"},nm={key:2,class:"permission-section"},om={class:"permission-buttons"},am=["disabled"],im=["disabled"],lm={class:"detail-banner detail-banner-warning"},rm={key:0,class:"suggestions-section"},cm=["id","onUpdate:modelValue","disabled"],um=["for"],dm={class:"permission-buttons"},fm=["disabled"],mm=["disabled"],pm=["disabled"],vm={class:"guidance-section"},hm=["disabled"],gm=["disabled"],_m={key:3,class:"detail-banner detail-banner-warning"},bm={key:4,class:"detail-banner detail-banner-error"},ym={key:0},wm={key:5,class:"detail-section"},km={key:0,class:"detail-pre"},$m={key:6,class:"detail-section"},Sm={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),o=ve(),i=nt(),u=M(!1),f=M(!1),h=M(!1),p=M(null),m=M(""),v=M(!1),$=M(null),c=M({}),d=M(null),y=M({});de(()=>e.toolCall.suggestions,R=>{if(R&&R.length>0){const q={};R.forEach((ee,ue)=>{q[ue]=!0}),c.value=q}},{immediate:!0});const g=k(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((R,q)=>c.value[q]):[]),_={Read:Cl,Write:Wl,Bash:sr,TodoWrite:br,Edit:Vr,Grep:Pn,Glob:Pn,WebFetch:Rn,WebSearch:Rn,Task:qc,TaskCreate:ru,TaskUpdate:Lu,TaskList:Xu,TaskGet:_d,NotebookEdit:jd,BashOutput:Bn,KillShell:Bn,SlashCommand:kf,Skill:uf,ExitPlanMode:Of,AskUserQuestion:Fn},b=k(()=>_[e.toolCall.name]||ol),a=k(()=>{if(e.toolCall.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[e.toolCall.backendStatus]||e.toolCall.backendStatus;const R=s.getBackendToolState(o.currentSessionId,e.toolCall.id);return R?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[R.state]||R.state:e.toolCall.status}),w=k(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),x=k(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),E=k(()=>a.value==="permission_required"),T=k(()=>e.toolCall.name==="AskUserQuestion"),A=k(()=>!T.value||!d.value?!1:d.value.allQuestionsAnswered),L=k(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0),C=k(()=>e.toolCall.input&&Object.keys(e.toolCall.input).length>0),O=k(()=>e.toolCall.result!=null),V=k(()=>{try{return JSON.stringify(e.toolCall.input,null,2)}catch{return String(e.toolCall.input)}}),P=k(()=>{const R=e.toolCall.result;if(!R)return"";if(typeof R=="string")return R;if(R.content)return typeof R.content=="string"?R.content:JSON.stringify(R.content,null,2);try{return JSON.stringify(R,null,2)}catch{return String(R)}});function F(R){y.value=R}async function U(){if(!(h.value||!d.value)){h.value=!0,p.value="submit-answers";try{const R=o.currentSessionId,q=d.value.getAnswers(),ee={questions:e.toolCall.input?.questions||[],answers:q};R&&(s.updateToolCall(R,e.toolCall.id,{input:ee}),s.handlePermissionResponse(R,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",ee)}catch(R){console.error("Failed to submit question answers:",R)}finally{h.value=!1,p.value=null}}}async function X(R,q,ee=null){if(h.value)return;h.value=!0;const ue=g.value,ie=q&&ue.length>0;R==="allow"?p.value=ie?"approve-apply":"approve":ee?p.value="deny-guidance":p.value="deny";try{const he=o.currentSessionId;if(he){const ge=ie?ue:[];s.handlePermissionResponse(he,{request_id:e.toolCall.permissionRequestId,decision:R,reasoning:R==="allow"?"User allowed permission":"User denied permission",applied_updates:ge})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,R,ie,ee,ie?ue:null)}catch(he){console.error("Failed to send permission response:",he)}finally{h.value=!1,p.value=null}}function I(R){return R.type==="setMode"?`Set mode: ${R.mode}`:R.type==="addRules"&&R.rules?.length?`Allow: ${R.rules.map(ee=>ee.ruleContent?`${ee.toolName}(${ee.ruleContent})`:ee.toolName).join(", ")}`:R.type==="addDirectories"&&R.directories?.length?`Add directories: ${R.directories.join(", ")}`:JSON.stringify(R)}function N(){v.value=!0,rt(()=>{$.value?.focus()})}function K(){const R=$.value;if(!R)return;R.style.height="auto";const q=parseFloat(getComputedStyle(R).lineHeight)*6+10;R.style.height=Math.min(R.scrollHeight,q)+"px"}return(R,q)=>(l(),r("div",tm,[w.value?(l(),r("div",sm,[q[9]||(q[9]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[q[8]||(q[8]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,S(x.value?.message||"Session was terminated"),1)])])):D("",!0),T.value&&a.value==="permission_required"?D("",!0):(l(),Ce(Ao(b.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),a.value==="permission_required"&&!w.value?(l(),r("div",nm,[T.value?(l(),r(te,{key:0},[q[10]||(q[10]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),ye(Fn,{ref_key:"questionHandlerRef",ref:d,toolCall:n.toolCall,disabled:h.value,onAnswer:F},null,8,["toolCall","disabled"]),t("div",om,[t("button",{class:"btn-timeline btn-primary",onClick:U,disabled:h.value||!A.value},S(h.value?"Submitting...":"Submit Answers"),9,am),t("button",{class:"btn-timeline btn-secondary",onClick:q[0]||(q[0]=ee=>X("deny",!1)),disabled:h.value}," Skip ",8,im)])],64)):(l(),r(te,{key:1},[t("div",lm,[q[12]||(q[12]=t("strong",null,"Permission Required",-1)),t("p",null,[q[11]||(q[11]=ce("Claude wants to use ",-1)),t("code",null,S(n.toolCall.name),1)])]),L.value?(l(),r("div",rm,[q[13]||(q[13]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(l(!0),r(te,null,le(n.toolCall.suggestions,(ee,ue)=>(l(),r("div",{key:ue,class:"suggestion-item"},[$e(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${ue}`,"onUpdate:modelValue":ie=>c.value[ue]=ie,disabled:h.value},null,8,cm),[[Do,c.value[ue]]]),t("label",{for:`sg-${n.toolCall.id}-${ue}`},[t("code",null,S(I(ee)),1)],8,um)]))),128))])):D("",!0),t("div",dm,[L.value?(l(),r("button",{key:0,class:"btn-timeline btn-approve",onClick:q[1]||(q[1]=ee=>X("allow",!0)),disabled:h.value},S(h.value&&p.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,fm)):D("",!0),t("button",{class:H(["btn-timeline",L.value?"btn-approve-outline":"btn-approve"]),onClick:q[2]||(q[2]=ee=>X("allow",!1)),disabled:h.value},S(L.value?"Approve Only":"Approve"),11,mm),t("button",{class:"btn-timeline btn-deny",onClick:q[3]||(q[3]=ee=>X("deny",!1)),disabled:h.value}," Deny ",8,pm)]),t("div",vm,[v.value?D("",!0):(l(),r("a",{key:0,href:"#",class:"guidance-link",onClick:pe(N,["prevent"])}," Add guidance... ")),v.value?(l(),r(te,{key:1},[$e(t("textarea",{ref_key:"guidanceTextarea",ref:$,"onUpdate:modelValue":q[4]||(q[4]=ee=>m.value=ee),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:h.value,onInput:K},null,40,hm),[[Me,m.value]]),m.value.trim()?(l(),r("button",{key:0,class:"btn-timeline btn-guidance",onClick:q[5]||(q[5]=ee=>X("deny",!1,m.value)),disabled:h.value}," Provide Guidance & Continue ",8,gm)):D("",!0)],64)):D("",!0)])],64))])):D("",!0),a.value==="permission_required"&&w.value?(l(),r("div",_m,[q[14]||(q[14]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,S(x.value?.message||"Session was terminated before permission could be granted"),1)])):D("",!0),n.toolCall.permissionDecision==="deny"?(l(),r("div",bm,[q[15]||(q[15]=ce(" Permission denied ",-1)),n.toolCall.result?.message?(l(),r("span",ym," - "+S(n.toolCall.result.message),1)):D("",!0)])):D("",!0),C.value&&!E.value?(l(),r("div",wm,[t("div",{class:"section-header",onClick:q[6]||(q[6]=ee=>u.value=!u.value)},[t("span",null,S(u.value?"â–¾":"â–¸")+" Parameters",1)]),u.value?(l(),r("pre",km,S(V.value),1)):D("",!0)])):D("",!0),O.value&&!E.value?(l(),r("div",$m,[t("div",{class:"section-header",onClick:q[7]||(q[7]=ee=>f.value=!f.value)},[t("span",null,S(f.value?"â–¾":"â–¸")+" Result",1)]),f.value?(l(),r("pre",{key:0,class:H(["detail-pre",{"result-error":n.toolCall.result?.error}])},S(P.value),3)):D("",!0)])):D("",!0)]))}},xm=se(Sm,[["__scopeId","data-v-1ed79806"]]),Cm={class:"timeline-row"},Em={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=Pe(),o=ve(),i=xe(),u=M(null),f=M({});function h(d,y){y&&(f.value[d]=y)}const p=k(()=>[...e.tools].map((d,y)=>({tool:d,originalIndex:y})).sort((d,y)=>{if(d.tool.timestamp&&y.tool.timestamp){const g=new Date(d.tool.timestamp).getTime(),_=new Date(y.tool.timestamp).getTime();if(g!==_)return g-_}return d.originalIndex-y.originalIndex}).map(({tool:d})=>d)),m=k(()=>u.value?p.value.find(d=>d.id===u.value):null);de(p,d=>{const y=d.find(g=>v(g)==="permission_required");if(y)u.value=y.id;else if(u.value){const g=d.find(_=>_.id===u.value);g&&v(g)!=="permission_required"&&(u.value=null)}},{deep:!0,immediate:!0});function v(d){const y=o.currentSessionId;return y?d.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[d.backendStatus]||d.backendStatus:s.isToolUseOrphaned(y,d.id)?"orphaned":d.status:d.status}function $(d){const y=v(d),g=d.result?.error||d.status==="error"||d.permissionDecision==="deny";switch(y){case"completed":return g?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function c(d){u.value===d?u.value=null:u.value=d}return(d,y)=>p.value.length>0?(l(),r("div",{key:0,class:H(["activity-timeline",{"timeline-mobile":ne(i).isMobile}])},[t("div",Cm,[(l(!0),r(te,null,le(p.value,(g,_)=>(l(),r(te,{key:g.id},[_>0?(l(),Ce(qi,{key:0,leftColor:$(p.value[_-1]),rightColor:$(g),compact:ne(i).isMobile},null,8,["leftColor","rightColor","compact"])):D("",!0),ye(Hi,{ref_for:!0,ref:b=>h(g.id,b),tool:g,isExpanded:u.value===g.id,compact:ne(i).isMobile,onClick:b=>c(g.id)},null,8,["tool","isExpanded","compact","onClick"])],64))),128))]),u.value&&m.value?(l(),Ce(xm,{key:0,toolCall:m.value},null,8,["toolCall"])):D("",!0)],2)):D("",!0)}},Tm=se(Em,[["__scopeId","data-v-5c2a6058"]]),Am={class:"msg-wrapper msg-assistant"},Dm={class:"msg-meta"},Om={class:"msg-time"},Mm={class:"msg-bubble msg-bubble-assistant"},Lm={key:0,class:"thinking-block mb-2"},Nm=["innerHTML"],Im={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Pe(),o=ve();Ke.setOptions({breaks:!0,gfm:!0});const i=k(()=>os(e.message.timestamp)),u=k(()=>{const c=e.message.content||"";return c.trim().length>0&&c!=="Assistant response"}),f=k(()=>{const c=e.message.content||"";let d=Ke.parse(c);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),Vt.sanitize(d)}),h=k(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),p=k(()=>e.message.metadata?.thinking_content||""),m=k(()=>{const c=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,d=e.attachedTools&&e.attachedTools.length>0;return c||d}),v=k(()=>{const c=e.message.metadata?.tool_uses||[],d=e.attachedTools||[],y=[...c],g=new Set(c.map(_=>_.id));for(const _ of d)g.has(_.id)||y.push(_);return y}),$=k(()=>{const c=o.currentSessionId;if(!c)return[];const d=s.toolCallsBySession.get(c)||[];return v.value.map(y=>{const g=d.find(_=>_.id===y.id);return g||{id:y.id,name:y.name,input:y.input,status:"pending",result:null,timestamp:y.timestamp||e.message.timestamp,isExpanded:!0}})});return(c,d)=>(l(),r("div",Am,[t("div",Dm,[d[0]||(d[0]=t("span",{class:"msg-role"},"assistant",-1)),t("span",Om,S(i.value),1)]),t("div",Mm,[h.value?(l(),r("div",Lm,[ye(Ri,{thinking:p.value},null,8,["thinking"])])):D("",!0),u.value?(l(),r("div",{key:1,class:"msg-text",innerHTML:f.value},null,8,Nm)):D("",!0),m.value?(l(),Ce(Tm,{key:2,tools:$.value,messageId:n.message.id},null,8,["tools","messageId"])):D("",!0)])]))}},jm=se(Im,[["__scopeId","data-v-2f57d076"]]),Pm={class:"msg-wrapper msg-system"},Rm={key:0,class:"pill-icon"},Bm={class:"pill-text"},Fm={class:"pill-time"},Vm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>os(e.message.timestamp)),o=k(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting"),i=k(()=>{if(o.value)return"Context compaction in progress...";const u=e.message.content||"";return u.length>80?u.substring(0,77)+"...":u});return(u,f)=>(l(),r("div",Pm,[t("div",{class:H(["msg-pill",{"pill-compaction":o.value}])},[o.value?(l(),r("span",Rm,"ðŸ—œï¸")):D("",!0),t("span",Bm,S(i.value),1),f[0]||(f[0]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Fm,S(s.value),1)],2)]))}},Vn=se(Vm,[["__scopeId","data-v-950fba0a"]]),Um={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=k(()=>{switch(e.message.type){case"user":return Oi;case"assistant":return jm;case"system":return Vn;default:return Vn}});return(o,i)=>(l(),Ce(Ao(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Wm=se(Um,[["__scopeId","data-v-11dff525"]]),Hm={class:"msg-wrapper msg-system"},zm={class:"pill-badge"},qm={class:"pill-time"},Km={key:0,class:"compaction-detail"},Xm={class:"detail-section"},Gm={class:"detail-value"},Ym={class:"detail-section"},Jm={class:"detail-value"},Qm={key:0,class:"detail-section"},Zm={class:"detail-value"},ep={class:"continuation-section"},tp={class:"continuation-text"},sp={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=M(!1);function o(){s.value=!s.value}const i=k(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),u=k(()=>i.value?e.messages[3]:e.messages[2]),f=k(()=>u.value?.metadata?.init_data?.compact_metadata||{}),h=k(()=>f.value.pre_tokens||0),p=k(()=>i.value?e.messages[4]:e.messages[3]),m=k(()=>p.value?.content||""),v=k(()=>{const c=e.messages[0]?.timestamp;return c?os(c):""});function $(c){return c?`${c.toLocaleString()} tokens`:"0 tokens"}return(c,d)=>(l(),r("div",Hm,[t("div",{class:"msg-pill pill-compaction",onClick:o,style:{cursor:"pointer"}},[d[0]||(d[0]=t("span",{class:"pill-icon"},"ðŸ—œï¸",-1)),d[1]||(d[1]=t("span",{class:"pill-text"},"Context Compaction Event",-1)),t("span",zm,S($(h.value)),1),d[2]||(d[2]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",qm,S(v.value),1),t("span",{class:H(["pill-chevron",{expanded:s.value}])},"â–¶",2)]),s.value?(l(),r("div",Km,[t("div",Xm,[d[3]||(d[3]=t("div",{class:"detail-label"},"Trigger",-1)),t("div",Gm,S(f.value.trigger||"auto"),1)]),t("div",Ym,[d[4]||(d[4]=t("div",{class:"detail-label"},"Pre-compaction",-1)),t("div",Jm,S($(h.value)),1)]),f.value.post_tokens?(l(),r("div",Qm,[d[5]||(d[5]=t("div",{class:"detail-label"},"Post-compaction",-1)),t("div",Zm,S($(f.value.post_tokens)),1)])):D("",!0),t("div",ep,[d[6]||(d[6]=t("div",{class:"detail-label"},"Continuation Message",-1)),t("pre",tp,S(m.value),1)])])):D("",!0)]))}},np=se(sp,[["__scopeId","data-v-6b5b6a98"]]),op={key:0,class:"text-muted text-center py-5"},ap={__name:"MessageList",setup(n){const e=Pe(),s=xe(),o=M(null),i=k(()=>{const v=e.currentMessages,$=[];let c=0;for(;c<v.length;){const d=v[c];if(f(d,v,c)){const y=v[c+2],_=y?.type==="system"&&y?.metadata?.subtype==="init"?5:4,b=v.slice(c,c+_);$.push({type:"compaction",messages:b}),c+=_;continue}p(d)&&$.push({type:"message",message:d,attachedTools:[]}),c++}return u($)});function u(v){const $=new Map,c=new Set;for(let y=0;y<v.length;y++){const g=v[y];if(g.type==="compaction")continue;const _=g.message,b=_.content&&_.content.trim().length>0&&_.content!=="Assistant response",a=_.type==="assistant"&&_.metadata?.has_tool_uses&&_.metadata?.tool_uses?.length>0;if(_.type==="assistant"&&a&&!b){let w=-1,x=!1;for(let E=y-1;E>=0;E--){const T=v[E];if(!c.has(E)){if(T.type==="message"&&T.message.type!=="assistant"){x=!0;break}if(T.type==="message"&&T.message.type==="assistant"){const A=T.message;if(A.content&&A.content.trim().length>0&&A.content!=="Assistant response"){w=E;break}else{w=E;break}}}}x&&w===-1||(x&&w>=0?($.has(w)||$.set(w,[]),$.get(w).push(..._.metadata.tool_uses),c.add(y)):!x&&w>=0&&($.has(w)||$.set(w,[]),$.get(w).push(..._.metadata.tool_uses),c.add(y)))}}const d=[];for(let y=0;y<v.length;y++){if(c.has(y))continue;const g=v[y];$.has(y)&&(g.attachedTools=[...g.attachedTools||[],...$.get(y)]),d.push(g)}return d}function f(v,$,c){if(c+3>=$.length)return!1;const d=$[c],y=$[c+1];let g=$[c+2],_=$[c+3],b=$[c+4];const a=d.type==="system"&&d.metadata?.subtype==="status"&&d.metadata?.init_data?.status==="compacting",w=y.type==="system"&&y.metadata?.subtype==="status"&&(y.metadata?.init_data?.status===null||y.metadata?.init_data?.status===void 0);if(g?.type==="system"&&g?.metadata?.subtype==="init"){if(c+4>=$.length)return!1;const E=!0,T=_?.type==="system"&&_?.metadata?.subtype==="compact_boundary",A=b?.type==="user"&&b?.content?.startsWith("This session is being continued from a previous conversation");return d.type==="system"&&d.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",c),console.log("  Msg1 (compacting):",a),console.log("  Msg2 (null status):",w),console.log("  Msg3 (init):",E),console.log("  Msg4 (boundary):",T),console.log("  Msg5 (continuation):",A)),a&&w&&E&&T&&A}else{const E=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",T=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return d.type==="system"&&d.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",c),console.log("  Msg1 (compacting):",a),console.log("  Msg2 (null status):",w),console.log("  Msg3 (boundary):",E),console.log("  Msg4 (continuation):",T)),a&&w&&E&&T}}async function h(){s.autoScrollEnabled&&(await rt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}de(()=>i.value.length,h),de(()=>e.currentToolCalls.length,h),de(()=>e.currentToolCalls.map(v=>`${v.id}-${v.status}`).join(","),h),Oe(()=>{setTimeout(()=>{h()},100)});function p(v){const $=v.subtype||v.metadata?.subtype;if(v.type==="system"&&$==="init"||v.type==="system"&&$==="task_notification"||v.type==="result"||v.type==="permission_request"||v.type==="permission_response")return!1;if(v.type==="user"&&v.metadata?.has_tool_results){const c=v.content||"";if(c.match(/^Tool results?: \d+ results?$/i)||c.trim()==="")return!1}if(v.type==="user"){const c=v.content||"";if(c.includes("<command-message>")&&c.includes("skill is running")||c.startsWith("Base directory for this skill:"))return!1}if(v.type==="user"){const c=v.content||"";if(c.includes("<command-message>")&&c.includes("<command-name>")&&c.includes("<command-args>")||c.includes("ARGUMENTS:")&&(c.includes("<command-name>")||c.match(/\nARGUMENTS:/)))return!1}if(v.type==="user"){const c=v.metadata||{};if(c.parent_tool_use_id&&!c.has_tool_results)return!1}return!0}function m(v){return{type:v.type||"unknown",content:v.content||"",timestamp:v.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...v.metadata}}}return(v,$)=>(l(),r("div",{class:H(["messages-area flex-grow-1 overflow-auto",{"theme-red":ne(s).isRedBackground}]),ref_key:"messagesArea",ref:o},[i.value.length===0?(l(),r("div",op," No messages yet. Start a conversation! ")):D("",!0),(l(!0),r(te,null,le(i.value,(c,d)=>(l(),r(te,{key:`item-${d}`},[c.type==="message"?(l(),Ce(Wm,{key:0,message:m(c.message),attachedTools:c.attachedTools||[]},null,8,["message","attachedTools"])):c.type==="compaction"?(l(),Ce(np,{key:1,messages:c.messages},null,8,["messages"])):D("",!0)],64))),128))],2))}},ip=se(ap,[["__scopeId","data-v-7aa43476"]]),lp={key:0,class:"attachment-list"},rp={key:0,class:"attachment-preview"},cp=["src","alt"],up={key:1,class:"attachment-icon"},dp={class:"file-type-icon"},fp={class:"attachment-info"},mp=["title"],pp={class:"attachment-size"},vp=["onClick"],hp={key:2,class:"upload-progress"},gp=["title"],_p={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(p){if(p.type&&p.type.startsWith("image/"))return!0;const m=p.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(m)}function i(p){const m=p.name?.split(".").pop()?.toLowerCase()||"",v=p.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(m)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(m)?"âš™ï¸":["log","txt"].includes(m)||v==="text/plain"?"ðŸ“‹":["md","rst"].includes(m)?"ðŸ“":"ðŸ“"}function u(p){return p?p<1024?p+" B":p<1024*1024?(p/1024).toFixed(1)+" KB":(p/(1024*1024)).toFixed(1)+" MB":""}function f(p,m=20){if(!p||p.length<=m)return p;const v=p.split(".").pop(),$=p.substring(0,p.length-v.length-1);return $.length<=m-v.length-4?p:$.substring(0,m-v.length-4)+"..."+v}function h(p){s("remove",p)}return(p,m)=>n.attachments.length>0?(l(),r("div",lp,[(l(!0),r(te,null,le(n.attachments,(v,$)=>(l(),r("div",{key:v.id||$,class:"attachment-item"},[o(v)?(l(),r("div",rp,[t("img",{src:v.preview||v.url,alt:v.name,class:"attachment-thumbnail"},null,8,cp)])):(l(),r("div",up,[t("span",dp,S(i(v)),1)])),t("div",fp,[t("span",{class:"attachment-name",title:v.name},S(f(v.name)),9,mp),t("span",pp,S(u(v.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:c=>h($)}," âœ• ",8,vp),v.uploading?(l(),r("div",hp,[t("div",{class:"progress-bar",style:Re({width:(v.progress||0)+"%"})},null,4)])):D("",!0),v.error?(l(),r("div",{key:3,class:"upload-error",title:v.error}," âš ï¸ "+S(v.error),9,gp)):D("",!0)]))),128))])):D("",!0)}},bp=se(_p,[["__scopeId","data-v-0fcc4974"]]),yp=["id","aria-selected","onMousedown","onMouseenter"],wp={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=M(null);return de(()=>e.selectedIndex,o=>{if(!s.value)return;const i=s.value.children[o];i&&i.scrollIntoView({block:"nearest"})}),(o,i)=>n.commands.length>0?(l(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(l(!0),r(te,null,le(n.commands,(u,f)=>(l(),r("li",{id:`slash-cmd-${f}`,key:u,role:"option",class:H(["slash-command-item",{active:f===n.selectedIndex}]),"aria-selected":f===n.selectedIndex,onMousedown:pe(h=>o.$emit("select",u),["prevent"]),onMouseenter:h=>o.$emit("highlight",f)}," /"+S(u),43,yp))),128))],512)):D("",!0)}},kp=se(wp,[["__scopeId","data-v-97c65547"]]),$p={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Sp=["disabled"],xp=["placeholder","disabled","aria-expanded","aria-activedescendant"],Cp=["disabled"],Ep=["disabled"],Un=5*1024*1024,Tp={__name:"InputArea",setup(n){const e=ve(),s=nt(),o=Qe(),i=xe(),u=Oo("pendingResourceAttachment",M(null)),f=M(null),h=M(null),p=M(window.innerWidth),m=M([]),v=M(!1),$=M(!1),c=M(!1),d=M(""),y=M(0),g=k({get:()=>e.currentInput,set:z=>{e.currentInput=z}}),_=k(()=>e.currentSession?.is_processing||!1),b=k(()=>s.sessionConnected),a=k(()=>e.currentSession?.state==="starting"),w=k(()=>e.currentSessionId),x=k(()=>!!g.value.trim()||m.value.filter(z=>!z.error).length>0),E=k(()=>p.value<768),T=k(()=>a.value?"Session is starting...":b.value?"Type your message to Claude Code...":"Waiting for connection..."),A=k(()=>{const z=w.value;return z?e.initData.get(z)?.slash_commands||[]:[]}),L=k(()=>{const z=d.value.toLowerCase();return A.value.filter(j=>j.toLowerCase().includes(z)).sort((j,W)=>j.localeCompare(W))});function C(){p.value=window.innerWidth}Oe(()=>{window.addEventListener("resize",C)}),De(()=>{window.removeEventListener("resize",C)}),de(u,z=>{z&&(he(z),u.value=null)});function O(z){if(c.value&&L.value.length>0){const j=L.value.length;if(z.key==="ArrowDown"){z.preventDefault(),y.value=(y.value+1)%j;return}if(z.key==="ArrowUp"){z.preventDefault(),y.value=(y.value-1+j)%j;return}if(z.key==="Enter"){z.preventDefault(),P(L.value[y.value]);return}if(z.key==="Tab"){z.preventDefault(),P(L.value[y.value]);return}}if(z.key==="Escape"&&c.value){z.preventDefault(),c.value=!1;return}if(z.key==="Enter"&&!z.shiftKey){if(E.value)return;z.preventDefault(),ue()}}function V(){const z=f.value;if(!z)return;z.style.height="auto";const j=Math.min(z.scrollHeight,parseInt(getComputedStyle(z).maxHeight));z.style.height=j+"px"}de(g,z=>{z.startsWith("/")&&A.value.length>0?(d.value=z.slice(1),y.value=0,c.value=L.value.length>0):c.value=!1});function P(z){g.value=`/${z} `,c.value=!1,f.value?.focus(),V()}function F(){h.value?.click()}function U(z){const j=Array.from(z.target.files||[]);N(j),z.target.value=""}function X(z){v.value=!1;const j=Array.from(z.dataTransfer?.files||[]);N(j)}function I(z){const j=z.clipboardData?.items;if(!j)return;const W=[];for(const Q of j)if(Q.type.startsWith("image/")){const J=Q.getAsFile();if(J){const oe=Q.type.split("/")[1]||"png",Se=`clipboard-${Date.now()}.${oe}`,ot=new File([J],Se,{type:J.type});W.push(ot)}}W.length>0&&(z.preventDefault(),N(W))}function N(z){for(const j of z){if(j.size>Un){m.value.push({id:R(),name:j.name,size:j.size,type:j.type,file:j,error:`File too large (max ${Un/(1024*1024)}MB)`});continue}let W=null;j.type.startsWith("image/")&&(W=URL.createObjectURL(j)),m.value.push({id:R(),name:j.name,size:j.size,type:j.type,file:j,preview:W,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function K(z){const j=m.value[z];j.preview&&URL.revokeObjectURL(j.preview),m.value.splice(z,1)}function R(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function q(z){const j=w.value;if(!j)return null;z.uploading=!0,z.progress=0,z.error=null;try{const W=new FormData;W.append("file",z.file);const Q=await fetch(`/api/sessions/${j}/files`,{method:"POST",body:W});if(!Q.ok){const oe=await Q.json().catch(()=>({}));throw new Error(oe.detail||`Upload failed: ${Q.status}`)}const J=await Q.json();return z.uploaded=!0,z.uploadedInfo=J.file,z.progress=100,J.file}catch(W){return z.error=W.message,null}finally{z.uploading=!1}}async function ee(){const z=m.value.filter(j=>!j.uploaded&&!j.error);if(z.length===0)return!0;$.value=!0;try{return(await Promise.all(z.map(q))).every(W=>W!==null)}finally{$.value=!1}}async function ue(){const z=g.value.trim(),j=m.value.filter(J=>!J.error).length>0;if(!z&&!j||j&&!await ee())return;let W=g.value;const Q=m.value.filter(J=>J.uploaded&&J.uploadedInfo).map(J=>J.uploadedInfo);if(Q.length>0){const J=Q.map(oe=>{const Se=(oe.size_bytes/1024).toFixed(1);return`- ${oe.original_name} (${Se} KB): ${oe.stored_path}`}).join(`
`);W.trim()?W=`${W}

---
Attached files (use Read tool to access):
${J}`:W=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${J}`}s.sendMessage(W),g.value="",ie(),f.value&&(f.value.style.height="auto")}function ie(){for(const z of m.value)z.preview&&URL.revokeObjectURL(z.preview);m.value=[]}function he(z){if(!z||!z.resource_id){console.warn("Invalid resource for attachment:",z);return}const j=w.value;if(!j){console.warn("No current session for resource attachment");return}if(m.value.findIndex(oe=>oe.resourceId===z.resource_id)>=0){console.log("Resource already attached:",z.resource_id);return}const Q=o.isImageResource(z);let J=null;Q&&(J=o.getResourceUrl(j,z.resource_id)),m.value.push({id:R(),resourceId:z.resource_id,name:z.original_filename||z.title||"Resource",size:z.size_bytes||0,type:z.format||"application/octet-stream",file:null,preview:J,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:z.resource_id,original_name:z.original_filename||z.title,stored_path:z.file_path||`/api/sessions/${j}/resources/${z.resource_id}`,size_bytes:z.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",z.resource_id)}function ge(){s.interruptSession()}return(z,j)=>(l(),r("div",{class:H(["border-top",ne(i).isRedBackground?"theme-red-panel":"bg-light"])},[b.value?D("",!0):(l(),r("div",$p,[...j[6]||(j[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),ye(bp,{attachments:m.value,onRemove:K},null,8,["attachments"]),v.value?(l(),r("div",{key:1,class:"drop-zone-overlay",onDragover:j[0]||(j[0]=pe(()=>{},["prevent"])),onDragleave:j[1]||(j[1]=W=>v.value=!1),onDrop:pe(X,["prevent"])},[...j[7]||(j[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):D("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:j[4]||(j[4]=pe(W=>v.value=!0,["prevent"])),onDragenter:j[5]||(j[5]=pe(W=>v.value=!0,["prevent"]))},[c.value?(l(),Ce(kp,{key:0,commands:L.value,"selected-index":y.value,onSelect:P,onHighlight:j[2]||(j[2]=W=>y.value=W)},null,8,["commands","selected-index"])):D("",!0),t("input",{ref_key:"fileInput",ref:h,type:"file",multiple:"",class:"d-none",onChange:U},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:a.value||!b.value,onClick:F}," ðŸ“Ž ",8,Sp),$e(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:f,"onUpdate:modelValue":j[3]||(j[3]=W=>g.value=W),class:"form-control",placeholder:T.value,disabled:a.value||!b.value,rows:"1","aria-expanded":c.value||void 0,"aria-activedescendant":c.value?`slash-cmd-${y.value}`:void 0,onInput:V,onKeydown:O,onPaste:I},null,40,xp),[[Me,g.value]]),_.value&&!x.value?(l(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:ge}," Stop ")):_.value&&x.value?(l(),r("button",{key:2,class:"btn btn-info",disabled:!b.value||a.value||$.value,title:"Send while processing (doesn't interrupt)",onClick:ue},S($.value?"Uploading...":"Queue"),9,Cp)):(l(),r("button",{key:3,class:"btn btn-primary",disabled:!x.value||!b.value||a.value||$.value,onClick:ue},S($.value?"Uploading...":"Send"),9,Ep))],32)],2))}},Ap=se(Tp,[["__scopeId","data-v-5b1f250e"]]),Dp={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Op={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Mp={class:"text-secondary"},Lp={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Np={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=xe(),i=k(()=>s.currentSession),u=k(()=>o.isLoading),f=k(()=>o.loadingMessage);return Oe(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),de(()=>e.sessionId,async(h,p)=>{if(h!==p&&h!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(h)}finally{o.hideLoading()}}}),De(()=>{}),(h,p)=>(l(),r("div",Dp,[u.value?(l(),r("div",Op,[p[0]||(p[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Mp,S(f.value),1)])):D("",!0),t("div",Lp,[ye(ip)]),ye(Ap),i.value?(l(),Ce(ri,{key:1,"session-id":e.sessionId},null,8,["session-id"])):D("",!0),i.value?(l(),Ce(hi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):D("",!0)]))}},Ut=st("legion",()=>{const n=M(new Map),e=M(new Map),s=M(null),o=k(()=>n.value.get(s.value)||[]),i=k(()=>e.value.get(s.value)||[]);function u(y){s.value=y}async function f(y,g=100,_=0){try{const b=await be.get(`/api/legions/${y}/timeline?limit=${g}&offset=${_}`),a=b.comms||[],w=b.total_count||a.length,x=b.has_more||!1;return a.sort((E,T)=>new Date(E.timestamp)-new Date(T.timestamp)),console.log(`Loaded ${a.length} of ${w} comms for legion ${y}`),n.value.set(y,a),n.value=new Map(n.value),{comms:a,totalCount:w,hasMore:x}}catch(b){throw console.error("Failed to load timeline:",b),b}}function h(y,g){n.value.has(y)||n.value.set(y,[]);const _=n.value.get(y);if(_.some(a=>a.comm_id===g.comm_id)){console.log(`Duplicate comm ${g.comm_id} prevented in timeline`);return}_.push(g),n.value=new Map(n.value)}async function p(y,g){try{const b=(await be.post(`/api/legions/${y}/comms`,g)).comm;return console.log(`Sent comm ${b.comm_id} to legion ${y}`),b}catch(_){throw console.error("Failed to send comm:",_),_}}async function m(y){return console.log(`Minions for legion ${y} are already available in session store`),[]}async function v(y,g){try{const b=(await be.post(`/api/legions/${y}/minions`,g)).minion;return await m(y),console.log(`Created minion ${b.minion_id} in legion ${y}`),b}catch(_){throw console.error("Failed to create minion:",_),_}}async function $(y){try{const g=await be.post(`/api/legions/${y}/halt-all`);return console.log(`Halted ${g.halted_count} of ${g.total_minions} minions in legion ${y}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to halt some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to halt all minions:",g),g}}async function c(y){try{const g=await be.post(`/api/legions/${y}/resume-all`);return console.log(`Resumed ${g.resumed_count} of ${g.total_minions} minions in legion ${y}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to resume some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to resume all minions:",g),g}}function d(y){n.value.delete(y),e.value.delete(y),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:i,setCurrentLegion:u,loadTimeline:f,addComm:h,sendComm:p,loadMinions:m,createMinion:v,haltAll:$,resumeAll:c,clearLegionData:d}}),Ip=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Ut},Symbol.toStringTag,{value:"Module"})),jp={class:"timeline-header border-bottom p-3"},Pp={class:"project-name"},Rp=["title"],Bp={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ze(),o=k(()=>s.projects.get(e.legionId)),i=k(()=>o.value?.name||"Legion");return(u,f)=>(l(),r("div",jp,[t("div",null,[t("div",Pp,S(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Rp)])]))}},Fp=se(Bp,[["__scopeId","data-v-44f386f5"]]),Vp={class:"timeline-status-bar border-top p-2 bg-light"},Up={class:"d-flex justify-content-end"},Wp={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=xe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(l(),r("div",Vp,[t("div",Up,[t("button",{class:H(["btn btn-sm",ne(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+S(ne(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Hp=se(Wp,[["__scopeId","data-v-891c73db"]]),zp={class:"comm-composer border-top p-3"},qp={key:0,class:"d-flex gap-2 mb-2"},Kp={class:"flex-grow-1"},Xp=["disabled"],Gp={label:"Minions"},Yp=["value"],Jp={style:{"min-width":"150px"}},Qp=["disabled"],Zp={class:"d-flex gap-2 align-items-end position-relative"},ev={class:"flex-grow-1 position-relative"},tv=["disabled"],sv=["onClick","onMouseenter"],nv=["disabled"],ov={key:0},av={key:1},iv={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Ut(),o=ve(),i=ze(),u=M(""),f=M("task"),h=M(""),p=M(!1),m=M(window.innerWidth),v=M(!1),$=M([]),c=M(0),d=M(-1),y=M(null),g=M(null),_=k(()=>m.value<768),b=k(()=>{const P=i.projects.get(e.legionId);return!P||!P.session_ids?[]:P.session_ids.map(F=>o.sessions.get(F)).filter(F=>F)}),a=k(()=>u.value&&h.value.trim().length>0);function w(P){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[P.state]||"â—‹"}function x(P){return P.role?`${P.name} (${P.role})`:P.name}function E(){const P=y.value;if(!P)return;P.style.height="auto";const F=Math.min(P.scrollHeight,parseInt(getComputedStyle(P).maxHeight));P.style.height=F+"px"}function T(){const P=y.value;if(!P)return;E();const F=h.value,U=P.selectionStart,X=F.substring(0,U),I=X.lastIndexOf("#");if(I===-1){v.value=!1;return}const N=X.substring(I+1).toLowerCase();if(N.includes(" ")){v.value=!1;return}const K=b.value.filter(R=>R.name.toLowerCase().includes(N)).map(R=>({type:"minion",name:R.name,role:R.role,id:R.session_id,state:R.state}));if(K.length===0){v.value=!1;return}$.value=K,c.value=0,d.value=I,v.value=!0}function A(){if(!g.value)return;const P=g.value,F=P.children[c.value];if(!F)return;const U=F.offsetTop,X=F.offsetHeight,I=P.scrollTop,N=P.clientHeight;U<I?P.scrollTop=U:U+X>I+N&&(P.scrollTop=U+X-N)}function L(P){if(!v.value){if(P.key==="Enter"&&!P.shiftKey){if(_.value)return;a.value&&(P.preventDefault(),O())}return}if(P.key==="ArrowDown")P.preventDefault(),c.value=(c.value+1)%$.value.length,A();else if(P.key==="ArrowUp")P.preventDefault(),c.value=c.value===0?$.value.length-1:c.value-1,A();else if(P.key==="Enter"){P.preventDefault();const F=$.value[c.value];F&&C(F)}else P.key==="Escape"&&(v.value=!1)}function C(P){const F=y.value;if(!F)return;const U=h.value,X=F.selectionStart,I=U.substring(0,d.value)+"#"+P.name+" "+U.substring(X);h.value=I;const N=d.value+P.name.length+2;setTimeout(()=>{F.setSelectionRange(N,N),F.focus()},0),v.value=!1}async function O(){if(!(!a.value||p.value)){p.value=!0;try{const[P,F]=u.value.split(":"),U={comm_type:f.value,content:h.value.trim()};P==="minion"&&(U.to_minion_id=F),await s.sendComm(e.legionId,U),h.value="",E()}catch(P){console.error("Failed to send comm:",P),alert(`Failed to send comm: ${P.message}`)}finally{p.value=!1}}}function V(){m.value=window.innerWidth}return Oe(()=>{window.addEventListener("resize",V)}),De(()=>{window.removeEventListener("resize",V)}),de(v,P=>{if(P){const F=U=>{U.target.closest(".comm-composer")||(v.value=!1,document.removeEventListener("click",F))};setTimeout(()=>document.addEventListener("click",F),0)}}),(P,F)=>(l(),r("div",zp,[n.hideRecipientSelector?D("",!0):(l(),r("div",qp,[t("div",Kp,[$e(t("select",{"onUpdate:modelValue":F[0]||(F[0]=U=>u.value=U),class:"form-select form-select-sm",disabled:p.value},[F[3]||(F[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",Gp,[(l(!0),r(te,null,le(b.value,U=>(l(),r("option",{key:U.session_id,value:`minion:${U.session_id}`},S(w(U))+" "+S(x(U)),9,Yp))),128))])],8,Xp),[[ws,u.value]])]),t("div",Jp,[$e(t("select",{"onUpdate:modelValue":F[1]||(F[1]=U=>f.value=U),class:"form-select form-select-sm",disabled:p.value},[...F[4]||(F[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,Qp),[[ws,f.value]])])])),t("div",Zp,[t("div",ev,[$e(t("textarea",{ref_key:"contentTextarea",ref:y,"onUpdate:modelValue":F[2]||(F[2]=U=>h.value=U),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:T,onKeydown:L},null,40,tv),[[Me,h.value]]),v.value?(l(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:g,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(l(!0),r(te,null,le($.value,(U,X)=>(l(),r("div",{key:U.id,class:H(["autocomplete-item px-2 py-1",{"bg-light":X===c.value}]),onClick:I=>C(U),onMouseenter:I=>c.value=X},S(U.type==="minion"?w(U):"#ï¸âƒ£")+" "+S(U.name)+S(U.role?` (${U.role})`:""),43,sv))),128))],512)):D("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!a.value||p.value,onClick:O},[p.value?(l(),r("span",ov,[...F[5]||(F[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ce(" Sending... ",-1)])])):(l(),r("span",av,"Send"))],8,nv)])])]))}},lv=se(iv,[["__scopeId","data-v-e52b8e8f"]]),rv={class:"message-content-column-full"},cv=["aria-expanded"],uv={class:"comm-sender-recipient"},dv={class:"comm-badge-summary"},fv=["title"],mv={class:"comm-summary-text text-muted ms-2"},pv=["aria-label"],vv={key:0,class:"comm-content-body"},hv=["innerHTML"],gv="ffffffff-ffff-ffff-ffff-ffffffffffff",_v={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ke.setOptions({breaks:!0,gfm:!0});const s=M(!1);function o(){s.value=!s.value}const i=k(()=>e.comm.from_minion_id===gv),u=k(()=>{const m=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${m.toLocaleString()}`}),f=k(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),h=k(()=>{if(e.comm.summary)return e.comm.summary;const m=e.comm.content||"";return m.length>100?m.substring(0,100)+"...":m}),p=k(()=>{const m=e.comm.content||"";let v=Ke.parse(m);return v=v.replace(/\n</g,"<"),v=v.replace(/\n+$/,""),Vt.sanitize(v)});return(m,v)=>(l(),r("div",{class:H(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",rv,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",uv,[t("strong",{class:H({"system-sender":i.value})},S(n.senderName),3),n.recipientName?(l(),r(te,{key:0},[v[0]||(v[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,S(n.recipientName),1)],64)):D("",!0)]),t("div",dv,[t("span",{class:H(["badge",f.value]),title:u.value},S(n.comm.comm_type),11,fv),t("span",mv,S(h.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},S(s.value?"â–¾":"â–¸"),9,pv)],8,cv),s.value?(l(),r("div",vv,[t("div",{class:"message-text",innerHTML:p.value},null,8,hv)])):D("",!0)])],2))}},bv=se(_v,[["__scopeId","data-v-28513f64"]]),yv={class:"timeline-view d-flex flex-column h-100"},wv={key:0,class:"text-center text-muted"},kv={key:1,class:"text-center text-danger"},$v={key:2,class:"text-center text-muted"},Sv={key:3,class:"comm-list"},xv={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Ut();ze();const o=ve(),i=nt(),u=xe(),f=M(!0),h=M(null),p=M(null),m=k(()=>s.currentComms);function v(_){return _.from_user?"You":_.from_minion_id?_.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(_.from_minion_id)?.name||"Unknown":"Unknown"}function $(_){return _.to_user?"You":_.to_minion_id?o.sessions.get(_.to_minion_id)?.name||"Unknown":"All"}async function c(){u.autoScrollEnabled&&(await rt(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function d(){f.value=!0,h.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await rt(),await c(),setTimeout(()=>{c()},100)}catch(_){console.error("Failed to load timeline:",_),_.response?h.value=`${_.message} (${_.response.status})`:h.value=_.message||"Unknown error"}finally{f.value=!1}}function y(){i.connectLegion(e.legionId)}function g(){i.disconnectLegion()}return de(()=>m.value.length,()=>{c()}),Oe(()=>{o.currentSessionId=null,d(),y(),setTimeout(()=>{c()},100)}),De(()=>{g()}),(_,b)=>(l(),r("div",yv,[ye(Fp,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[f.value?(l(),r("div",wv,[...b[0]||(b[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ce(" Loading timeline... ",-1)])])):h.value?(l(),r("div",kv," Failed to load timeline: "+S(h.value),1)):m.value.length===0?(l(),r("div",$v," No messages yet. Minions will appear here once they start communicating. ")):(l(),r("div",Sv,[(l(!0),r(te,null,le(m.value,a=>(l(),Ce(bv,{key:a.comm_id,comm:a,"sender-name":v(a),"recipient-name":$(a)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ye(lv,{"legion-id":n.legionId},null,8,["legion-id"]),ye(Hp,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Cv=se(xv,[["__scopeId","data-v-b6752179"]]),Ev={class:"minion-info flex-grow-1"},Tv={class:"minion-name"},Av={key:0,class:"me-1"},Dv={key:1,class:"badge bg-secondary ms-2"},Ov={key:0,class:"latest-activity text-muted"},Mv={key:0,class:"activity-prefix"},Lv=["title"],Nv={key:1,class:"activity-time ms-1"},Iv={key:1,class:"latest-activity text-muted"},jv={class:"activity-prefix"},Pv=["title"],Rv={key:2,class:"latest-activity text-muted fst-italic small"},Bv={class:"node-row"},Fv={class:"node-left"},Vv={key:0,class:"me-2"},Uv={key:1,class:"badge bg-secondary ms-2"},Wv={class:"node-right"},Hv={key:0,class:"latest-message-preview"},zv={key:0,class:"message-prefix"},qv=["title"],Kv={key:1,class:"message-time ms-1"},Xv={key:1,class:"last-comm-preview"},Gv={class:"comm-direction"},Yv=["title"],Jv={key:2,class:"text-muted fst-italic small"},Qv={class:"node-actions"},Zv={key:2,class:"minion-children"},eh={key:1,class:"text-danger small ms-4"},th={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,i=ve(),u=Pe(),f=xe(),h=k(()=>!s.minionData||!s.minionData.id?null:i.getSession(s.minionData.id)),p=k(()=>{if(!s.minionData||!s.minionData.id)return null;const C=u.messagesBySession.get(s.minionData.id);if(!C||C.length===0)return null;for(let O=C.length-1;O>=0;O--){const V=C[O],P=V.subtype||V.metadata?.subtype;if(V.type!=="result"&&!(V.type==="system"&&P==="init")&&!(V.type==="system"&&P==="task_notification")&&!(V.type==="permission_request"||V.type==="permission_response")){if(V.type==="user"&&V.metadata?.has_tool_results){const F=V.content||"";if(F.match(/^Tool results?: \d+ results?$/i)||F.trim()==="")continue}if(V.type==="user"){const F=V.content||"";if(F.includes("<command-message>")&&F.includes("skill is running")||F.startsWith("Base directory for this skill:"))continue}if(V.type==="user"){const F=V.content||"";if(F.includes("<command-message>")&&F.includes("<command-name>")&&F.includes("<command-args>")||F.includes("ARGUMENTS:")&&(F.includes("<command-name>")||F.match(/\nARGUMENTS:/)))continue}if(!(V.type==="system"&&V.content==="System message")&&!(V.type==="assistant"&&V.content==="Assistant response")&&(V.type==="user"||V.type==="assistant"||V.type==="system"))return{content:V.content,type:V.type,timestamp:V.timestamp}}}return null}),m=k(()=>{if(!s.minionData)return null;const C={...s.minionData};return h.value&&(C.state=h.value.state,C.is_processing=h.value.is_processing,h.value.name&&(C.name=h.value.name),h.value.latest_message&&(C.latest_message=h.value.latest_message,C.latest_message_type=h.value.latest_message_type,C.latest_message_time=h.value.latest_message_time)),p.value&&(C.latest_message=p.value.content,C.latest_message_type=p.value.type,C.latest_message_time=p.value.timestamp),C}),v=k(()=>s.level*24),$=k(()=>!s.minionData||!s.minionData.id?!1:i.currentSessionId===s.minionData.id),c=k(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),d=k(()=>s.minionData&&s.minionData.is_overseer&&c.value),y=k(()=>{const C=m.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),g=k(()=>{const C=y.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),_=k(()=>{const C=y.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),b=k(()=>{const C=m.value;if(!C||!C.latest_message_type)return"";const O=C.latest_message_type;return O==="user"?"User -->:":O==="system"?"System:":""}),a=k(()=>{const C=m.value;if(!C||!C.latest_message)return"";const O=C.latest_message,V=150;return O.length>V?O.slice(0,V)+"...":O}),w=k(()=>{const C=m.value;if(!C||!C.latest_message_time)return"";try{const O=Date.now();let V;if(typeof C.latest_message_time=="number"?V=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:V=new Date(C.latest_message_time).getTime(),isNaN(V)||V<9466848e5||V>O+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",V),"";const P=O-V;if(P<0)return"just now";const F=Math.floor(P/6e4),U=Math.floor(F/60),X=Math.floor(U/24);return X>0?`${X}d ago`:U>0?`${U}h ago`:F>0?`${F}m ago`:"just now"}catch(O){return console.error("Error calculating relative time:",O,C.latest_message_time),""}});function x(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function E(C){const O=C.summary||C.content||"";return O.length>150?O.substring(0,150)+"...":O}function T(){o("minion-click",s.minionData.id)}function A(){const C=i.sessions.get(s.minionData.id);C&&f.showModal("edit-session",{session:C})}function L(){const C=i.sessions.get(s.minionData.id);C&&f.showModal("manage-session",{session:C})}return(C,O)=>{const V=mn("MinionTreeNode",!0);return n.minionData?(l(),r("div",{key:0,class:"minion-tree-node",style:Re({marginLeft:`${v.value}px`})},[n.layout==="sidebar"?(l(),r("div",{key:0,class:H(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:T},[t("div",{class:H(["status-dot me-2",g.value]),style:Re(_.value)},null,6),t("div",Ev,[t("div",Tv,[d.value?(l(),r("span",Av,"ðŸ‘‘")):D("",!0),t("strong",null,S(m.value?.name||n.minionData.name),1),d.value?(l(),r("span",Dv,S(n.minionData.children.length)+" "+S(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),m.value?.latest_message?(l(),r("div",Ov,[b.value?(l(),r("span",Mv,S(b.value),1)):D("",!0),t("span",{class:"activity-content",title:m.value.latest_message},S(a.value),9,Lv),w.value?(l(),r("span",Nv,"("+S(w.value)+")",1)):D("",!0)])):n.minionData?.last_comm?(l(),r("div",Iv,[t("span",jv,[O[1]||(O[1]=ce("â†’ ",-1)),t("strong",null,S(x(n.minionData.last_comm)),1),O[2]||(O[2]=ce(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},S(E(n.minionData.last_comm)),9,Pv)])):(l(),r("div",Rv," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:pe(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:pe(L,["stop"])}," âš™ï¸ ")],2)):(l(),r("div",{key:1,class:H(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:T},[t("div",Bv,[t("div",Fv,[t("div",{class:H(["status-dot me-2",g.value]),style:Re(_.value)},null,6),d.value?(l(),r("span",Vv,"ðŸ‘‘")):D("",!0),t("strong",null,S(m.value?.name||n.minionData.name),1),d.value?(l(),r("span",Uv,S(n.minionData.children.length)+" "+S(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),t("div",Wv,[m.value?.latest_message?(l(),r("div",Hv,[b.value?(l(),r("span",zv,S(b.value),1)):D("",!0),t("span",{class:"message-content",title:m.value.latest_message},S(a.value),9,qv),w.value?(l(),r("span",Kv,"("+S(w.value)+")",1)):D("",!0)])):n.minionData?.last_comm?(l(),r("div",Xv,[t("span",Gv,[O[3]||(O[3]=ce("â†’ ",-1)),t("strong",null,S(x(n.minionData.last_comm)),1),O[4]||(O[4]=ce(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},S(E(n.minionData.last_comm)),9,Yv)])):(l(),r("div",Jv," No activity yet "))]),t("div",Qv,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:pe(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:pe(L,["stop"])}," âš™ï¸ ")])])],2)),c.value?(l(),r("div",Zv,[(l(!0),r(te,null,le(n.minionData.children,P=>(l(),Ce(V,{key:P.id,"minion-data":P,level:n.level+1,layout:n.layout,onMinionClick:O[0]||(O[0]=F=>C.$emit("minion-click",F))},null,8,["minion-data","level","layout"]))),128))])):D("",!0)],4)):(l(),r("div",eh," âš  Minion data is missing "))}}},sh=se(th,[["__scopeId","data-v-64b23e0e"]]),nh={class:"project-overview d-flex flex-column h-100"},oh={class:"project-overview-header border-bottom p-3"},ah={class:"d-flex align-items-center justify-content-between"},ih={class:"mb-1"},lh={key:0,class:"me-2"},rh={class:"text-muted font-monospace"},ch={class:"d-flex gap-2"},uh=["title"],dh={class:"project-overview-content flex-grow-1 overflow-auto p-3"},fh={key:0,class:"text-center py-5"},mh={key:1,class:"alert alert-danger"},ph={key:2,class:"text-center py-5"},vh={key:3},hh={class:"row g-3 mb-4"},gh={class:"col-md-4"},_h={class:"card h-100"},bh={class:"card-body"},yh={class:"card-title mb-0"},wh={class:"text-muted"},kh={class:"col-md-4"},$h={class:"card h-100"},Sh={class:"card-body"},xh={class:"card-title mb-0"},Ch={class:"text-muted"},Eh={key:0,class:"card mb-4"},Th={class:"card mb-4"},Ah={class:"card-header d-flex align-items-center justify-content-between"},Dh={class:"mb-0"},Oh={class:"badge bg-secondary"},Mh={class:"card-body"},Lh={key:0,class:"text-center py-4"},Nh={key:1,class:"text-center text-muted py-4"},Ih={key:2,class:"hierarchy-tree"},jh={class:"user-root-node mb-3 border rounded bg-white"},Ph={class:"node-row"},Rh={class:"node-left"},Bh={class:"badge bg-primary ms-2"},Fh={class:"node-right"},Vh={key:0,class:"last-comm-preview"},Uh={class:"comm-direction"},Wh=["title"],Hh={key:1,class:"text-muted fst-italic"},zh={class:"root-minions ms-4"},qh={class:"card"},Kh={class:"card-body"},Xh={class:"row mb-0"},Gh={class:"col-sm-8 font-monospace text-break"},Yh={class:"col-sm-8 font-monospace text-break"},Jh={class:"col-sm-8"},Qh={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},Zh={class:"text-muted"},eg={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=ns(),o=ze(),i=ve(),u=xe(),f=Ut(),h=nt(),p=M(!1),m=M(null),v=M(null),$=M(!1);let c=null;const d=k(()=>o.getProject(e.projectId)),y=k(()=>d.value?.session_ids?d.value.session_ids.map(U=>i.getSession(U)).filter(U=>U!=null):[]),g=k(()=>y.value.length>0),_=k(()=>y.value.length),b=k(()=>y.value.filter(U=>U.state==="ACTIVE").length),a=k(()=>{const U=y.value.some(N=>N.state==="ACTIVE"),X=y.value.some(N=>N.is_processing);return y.value.some(N=>N.state==="ERROR")?"Error":X?"Working":U?"Active":_.value>0?"Idle":"Empty"}),w=k(()=>{switch(a.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),x=k(()=>{switch(a.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function E(){$.value=!0;try{const U=await be.get(`/api/legions/${e.projectId}/hierarchy`);v.value=U}catch(U){console.error("Failed to load minion hierarchy:",U),v.value=null}finally{$.value=!1}}function T(U,X){if(U&&U.id===X)return U;if(U&&U.children)for(const I of U.children){const N=T(I,X);if(N)return N}return null}function A(U){return U.to_user?"User":U.to_minion_name?U.to_minion_name:"unknown"}function L(U){const X=U.summary||U.content||"";return X.length>150?X.substring(0,150)+"...":X}function C(U){if(v.value){if(U.from_minion_id){const X=T(v.value,U.from_minion_id);X&&X.type==="minion"&&(X.last_comm=U)}U.from_user&&v.value.type==="user"&&(v.value.last_comm=U)}}function O(U){s.push(`/session/${U}`)}function V(){s.push(`/timeline/${e.projectId}`)}function P(){u.showModal("edit-project",{project:d.value})}function F(){u.showModal("create-minion",{project:d.value})}return Oe(()=>{o.selectProject(e.projectId),i.currentSessionId=null,E(),f.setCurrentLegion(e.projectId),h.connectLegion(e.projectId),c=de(()=>i.sessions,U=>{if(v.value){for(const[X,I]of U)if(I.project_id===e.projectId){const N=T(v.value,X);N&&N.type==="minion"&&(N.state!==I.state&&(N.state=I.state),N.is_processing!==I.is_processing&&(N.is_processing=I.is_processing),N.latest_message!==I.latest_message&&(N.latest_message=I.latest_message,N.latest_message_type=I.latest_message_type,N.latest_message_time=I.latest_message_time))}}},{deep:!0}),de(()=>f.commsByLegion.get(e.projectId),U=>{if(U&&U.length>0){const X=U[U.length-1];C(X)}},{deep:!0}),de(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(U,X)=>{U!==X&&E()})}),de(()=>e.projectId,U=>{o.selectProject(U),i.currentSessionId=null,E(),f.setCurrentLegion(U),h.connectLegion(U)}),De(()=>{c&&c()}),(U,X)=>(l(),r("div",nh,[t("div",oh,[t("div",ah,[t("div",null,[t("h4",ih,[g.value?(l(),r("span",lh,"ðŸ›")):D("",!0),ce(" "+S(d.value?.name||"Project Overview"),1)]),t("small",rh,S(d.value?.working_directory),1)]),t("div",ch,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:P}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session",onClick:F}," âž• "+S(g.value?"Add Minion":"Add Session"),9,uh)])])]),t("div",dh,[p.value?(l(),r("div",fh,[...X[0]||(X[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):m.value?(l(),r("div",mh,S(m.value),1)):d.value?(l(),r("div",vh,[t("div",hh,[t("div",gh,[t("div",_h,[t("div",bh,[X[2]||(X[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",yh,S(_.value),1),t("small",wh,S(b.value)+" active",1)])])]),t("div",kh,[t("div",$h,[t("div",Sh,[X[3]||(X[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",xh,[t("span",{class:H(w.value)},S(a.value),3)]),t("small",Ch,S(x.value),1)])])])]),g.value?(l(),r("div",Eh,[X[4]||(X[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:V}," ðŸ“Š View Timeline ")])])])):D("",!0),t("div",Th,[t("div",Ah,[t("h5",Dh,"ðŸŒ³ "+S(g.value?"Minion Hierarchy":"Sessions"),1),t("span",Oh,S(y.value.length),1)]),t("div",Mh,[$.value?(l(),r("div",Lh,[...X[5]||(X[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!v.value||!v.value.children||v.value.children.length===0?(l(),r("div",Nh,' No sessions yet. Click "Add Session" to create one. ')):(l(),r("div",Ih,[t("div",jh,[t("div",Ph,[t("div",Rh,[X[6]||(X[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,S(v.value.name),1),t("span",Bh,S(v.value.children.length)+" "+S(v.value.children.length===1?"minion":"minions"),1)]),t("div",Fh,[v.value.last_comm?(l(),r("div",Vh,[t("span",Uh,[X[7]||(X[7]=ce(" â†’ ",-1)),t("strong",null,S(A(v.value.last_comm)),1),X[8]||(X[8]=ce(": ",-1))]),t("span",{class:"comm-content",title:v.value.last_comm.content||""},S(L(v.value.last_comm)),9,Wh)])):(l(),r("div",Hh," No communications yet "))])])]),t("div",zh,[(l(!0),r(te,null,le(v.value.children,I=>(l(),Ce(sh,{key:I.id,"minion-data":I,level:1,layout:"two-column",onMinionClick:O},null,8,["minion-data"]))),128))])]))])]),t("div",qh,[X[12]||(X[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",Kh,[t("dl",Xh,[X[9]||(X[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",Gh,S(d.value.working_directory),1),X[10]||(X[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",Yh,S(d.value.project_id),1),X[11]||(X[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",Jh,S(g.value?"Yes (has minions)":"No"),1)])])])])):(l(),r("div",ph,[...X[1]||(X[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",Qh,[X[13]||(X[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",Zh,S(_.value)+" session"+S(_.value!==1?"s":""),1)])]))}},tg=se(eg,[["__scopeId","data-v-168bf04c"]]),sg=[{path:"/",name:"home",component:Ja},{path:"/project/:projectId",name:"project",component:tg,props:!0},{path:"/session/:sessionId",name:"session",component:Np,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Cv,props:!0}],ng=Wa({history:Ha(),routes:sg}),og={class:"header-row1"},ag={class:"header-right"},ig=["title"],lg={__name:"HeaderRow1",setup(n){const e=xe(),s=nt(),o=k(()=>s.uiConnected);return(i,u)=>(l(),r("div",og,[u[6]||(u[6]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",ag,[t("div",{class:H(["header-indicator",o.value?"connected":"disconnected"])},[u[3]||(u[3]=t("span",{class:"indicator-dot"},null,-1)),ce(" "+S(o.value?"Connected":"Disconnected"),1)],2),t("button",{class:H(["header-btn theme-toggle-btn",{"theme-active":ne(e).isRedBackground}]),onClick:u[0]||(u[0]=f=>ne(e).toggleBackgroundColor()),title:ne(e).isRedBackground?"Disable sensitive environment mode":"Enable sensitive environment mode"},[...u[4]||(u[4]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})],-1)])],10,ig),t("button",{class:"header-btn",onClick:u[1]||(u[1]=f=>ne(e).showRestartModal()),title:"Restart server"}," â†» "),u[5]||(u[5]=t("button",{class:"header-btn",disabled:"",title:"Settings (coming soon)",style:{opacity:"0.4",cursor:"default"}}," âš™ ",-1)),t("button",{class:H(["header-btn panel-toggle-btn",{"panel-open":ne(e).rightPanelVisible}]),onClick:u[2]||(u[2]=f=>ne(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},rg=se(lg,[["__scopeId","data-v-2d22058c"]]),cg=["title"],ug={class:"pill-icon"},dg={class:"pill-name"},fg={key:0,class:"pill-count"},mg={class:"pill-status-bar"},pg={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=ze(),o=ve(),i=xe(),u=k(()=>e.project.session_ids?.length||0),f=k(()=>u.value>1?"ðŸ”·":u.value===1?"ðŸ’¬":"ðŸ“"),h=k(()=>s.getStatusBarSegments(e.project.project_id,o));function p(){i.setBrowsingProject(e.project.project_id)}function m(){i.showModal("edit-project",{project:e.project})}return(v,$)=>(l(),r("div",{class:H(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:p,onContextmenu:pe(m,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",ug,S(f.value),1),t("span",dg,S(n.project.name),1),u.value>0?(l(),r("span",fg,S(u.value),1)):D("",!0),t("div",mg,[(l(!0),r(te,null,le(h.value,(c,d)=>(l(),r("div",{key:d,class:H(["seg",c.status]),style:Re({flex:c.flex})},null,6))),128))])],42,cg))}},vg=se(pg,[["__scopeId","data-v-ecccd6e9"]]),hg={__name:"ProjectPillBar",setup(n){const e=ze(),s=ve(),o=xe(),i=k(()=>e.orderedProjects),u=k(()=>o.browsingProjectId),f=k(()=>{const p=s.currentSession;return p?p.project_id:null});de(f,p=>{p&&o.setBrowsingProject(p)}),de(i,p=>{!u.value&&p.length>0&&o.setBrowsingProject(p[0].project_id)},{immediate:!0});function h(){o.showModal("create-project")}return(p,m)=>(l(),r("div",{class:H(["project-pill-bar",{"theme-red":ne(o).isRedBackground}])},[(l(!0),r(te,null,le(i.value,v=>(l(),Ce(vg,{key:v.project_id,project:v,isActive:v.project_id===f.value,isBrowsing:v.project_id===u.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:h,title:"New project"}," + ")],2))}},gg=se(hg,[["__scopeId","data-v-fcc3f866"]]),Wt=st("schedule",()=>{const n=M(new Map),e=M(new Map),s=M(null),o=M([]);function i(a){return n.value.get(a)||[]}function u(a){return e.value.get(a)||0}async function f(a){try{const x=(await be.get(`/api/legions/${a}/schedules`)).schedules||[];return n.value.set(a,x),b(a),x}catch(w){return console.error("Failed to load schedules:",w),[]}}async function h(a,w){const E=(await be.post(`/api/legions/${a}/schedules`,w)).schedule;return g(a,E),E}async function p(a,w,x){const T=(await be.put(`/api/legions/${a}/schedules/${w}`,x)).schedule;return g(a,T),T}async function m(a,w){const x=await be.post(`/api/legions/${a}/schedules/${w}/pause`);return g(a,x.schedule),x.schedule}async function v(a,w){const x=await be.post(`/api/legions/${a}/schedules/${w}/resume`);return g(a,x.schedule),x.schedule}async function $(a,w){const x=await be.post(`/api/legions/${a}/schedules/${w}/cancel`);return g(a,x.schedule),x.schedule}async function c(a,w){await be.delete(`/api/legions/${a}/schedules/${w}`),_(a,w)}async function d(a,w,x=50,E=0){try{const T=await be.get(`/api/legions/${a}/schedules/${w}/history?limit=${x}&offset=${E}`);return o.value=T.executions||[],o.value}catch(T){return console.error("Failed to load schedule history:",T),o.value=[],[]}}function y(a,w){!w||!w.schedule||(w.deleted?_(a,w.schedule.schedule_id):g(a,w.schedule))}function g(a,w){const x=n.value.get(a)||[],E=x.findIndex(T=>T.schedule_id===w.schedule_id);E>=0?x[E]=w:x.push(w),n.value.set(a,[...x]),b(a)}function _(a,w){const E=(n.value.get(a)||[]).filter(T=>T.schedule_id!==w);n.value.set(a,E),b(a),s.value===w&&(s.value=null,o.value=[])}function b(a){const w=n.value.get(a)||[],x=new Map;for(const T of w)T.status==="active"&&x.set(T.minion_id,(x.get(T.minion_id)||0)+1);const E=new Set(w.map(T=>T.minion_id));for(const T of E)x.has(T)?e.value.set(T,x.get(T)):e.value.delete(T)}return{schedulesByLegion:n,scheduleCountByMinion:e,selectedScheduleId:s,executionHistory:o,getSchedules:i,getScheduleCount:u,loadSchedules:f,createSchedule:h,updateSchedule:p,pauseSchedule:m,resumeSchedule:v,cancelSchedule:$,deleteSchedule:c,loadHistory:d,handleScheduleEvent:y}}),_g=Object.freeze(Object.defineProperty({__proto__:null,useScheduleStore:Wt},Symbol.toStringTag,{value:"Module"})),bg=["title"],yg={class:"ac-info"},wg={class:"ac-name"},kg={class:"ac-status"},$g={key:1,class:"ac-schedule-badge",title:"Has active schedules"},Sg={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select"],setup(n,{emit:e}){const s=n,o=e;ve();const i=Wt(),u=k(()=>i.getScheduleCount(s.session.session_id)>0),f=k(()=>s.session.name||s.session.role||"Agent"),h=k(()=>{const c=s.session.state;return c==="error"?"error":c==="paused"?"waiting":c==="active"&&s.session.is_processing?"active":c==="active"?"idle":"none"}),p=k(()=>{const c=s.session.state;return c==="active"&&s.session.is_processing?"Processing...":c==="active"?"Idle":c==="paused"?"Awaiting input":c==="error"?"Error":c==="terminated"?"Stopped":c==="starting"?"Starting...":c==="created"?"Ready":c||"Unknown"}),m=k(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),v=k(()=>{const c=[f.value];return s.session.role&&c.push(`Role: ${s.session.role}`),c.push(`Status: ${p.value}`),s.session.model&&c.push(`Model: ${s.session.model}`),c.join(`
`)});function $(){o("select",s.session.session_id)}return(c,d)=>(l(),r("div",{class:H(["agent-chip",{active:n.isActive,child:n.variant==="child"}]),onClick:$,title:v.value},[t("div",{class:H(["ac-dot",h.value])},null,2),t("div",yg,[t("div",wg,S(f.value),1),t("div",kg,S(p.value),1)]),m.value?(l(),r("div",{key:0,class:H(["ac-alert",m.value])},S(m.value==="error"?"!":"?"),3)):D("",!0),u.value?(l(),r("div",$g,[...d[0]||(d[0]=[t("svg",{width:"10",height:"10",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm0 14.5A6.5 6.5 0 1 1 8 1.5a6.5 6.5 0 0 1 0 13zM8.5 4H7v5l4.25 2.55.75-1.23L8.5 8.25V4z"})],-1)])])):D("",!0)],10,bg))}},nn=se(Sg,[["__scopeId","data-v-42ca5858"]]),xg=["title"],Cg={class:"peek-letter"},Eg={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=ve(),o=k(()=>s.getSession(e.sessionId)),i=k(()=>(o.value?.name||o.value?.role||"?").charAt(0).toUpperCase()),u=k(()=>({right:`${-22-e.index*22}px`,zIndex:20-e.index})),f=k(()=>{if(!o.value)return"dot-none";const m=o.value.state;return m==="active"&&o.value.is_processing?"dot-active":m==="active"?"dot-idle":m==="paused"?"dot-waiting":m==="error"?"dot-error":"dot-none"}),h=k(()=>o.value?o.value.has_pending_permission||o.value.state==="error":!1),p=k(()=>o.value?o.value.state==="error"?"alert-error":"alert-permission":"");return(m,v)=>(l(),r("div",{class:"peek-card",style:Re(u.value),title:o.value?.name||"Child agent",onClick:v[0]||(v[0]=pe($=>m.$emit("click"),["stop"]))},[t("div",{class:H(["peek-dot",f.value])},null,2),t("span",Cg,S(i.value),1),h.value?(l(),r("div",{key:0,class:H(["peek-alert",p.value])},null,2)):D("",!0)],12,xg))}},Tg=se(Eg,[["__scopeId","data-v-7f1d4c1b"]]),Wn=44,Hn=12,Ag={__name:"ChipConnector",props:{depth:{type:Number,default:1},maxDepth:{type:Number,default:1}},setup(n){const e=n,s=Wn-Hn*2,o=k(()=>{const i=e.maxDepth;let u;if(i<=1)u=Wn/2;else{const f=(e.depth-1)/(i-1);u=Hn+f*s}return{alignSelf:"flex-start",marginTop:`${Math.round(u)}px`}});return(i,u)=>(l(),r("div",{class:"chip-connector",style:Re(o.value)},null,4))}},Dg=se(Ag,[["__scopeId","data-v-08d20738"]]),Og=["title"],Mg=Object.assign({name:"StackedChip"},{__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},depth:{type:Number,default:1},maxDepth:{type:Number,default:0}},emits:["select"],setup(n){const e=n,s=ve(),o=xe(),i=k(()=>s.currentSessionId),u=k(()=>e.session.child_minion_ids||[]);function f(b,a){if(!b?.child_minion_ids?.length)return a;let w=a;for(const x of b.child_minion_ids){const E=s.getSession(x);E&&(w=Math.max(w,f(E,a+1)))}return w}const h=k(()=>e.maxDepth>0?e.maxDepth:f(e.session,0)),p=k(()=>{if(!i.value)return!1;function b(a){if(!a)return!1;for(const w of a){if(w===i.value)return!0;const x=s.getSession(w);if(x?.child_minion_ids&&b(x.child_minion_ids))return!0}return!1}return b(u.value)}),m=k(()=>o.expandedStacks.has(e.session.session_id)||p.value),v=k(()=>u.value),$=k(()=>m.value||u.value.length===0?{}:{marginRight:`${u.value.length*22}px`});function c(b){return s.getSession(b)}function d(b){return s.getSession(b)?.child_minion_ids?.length>0}function y(b){const a=s.getSession(b);return a?.child_minion_ids?a.child_minion_ids.includes(i.value):!1}function g(){o.toggleStack(e.session.session_id)}function _(){m.value||o.toggleStack(e.session.session_id)}return(b,a)=>{const w=mn("StackedChip",!0);return l(),r("div",{class:"stacked-chip",style:Re($.value)},[t("div",{class:H(["parent-wrapper",{"has-children":u.value.length>0}])},[ye(nn,{session:n.session,isActive:n.isActive,onSelect:a[0]||(a[0]=x=>b.$emit("select",n.session.session_id)),onDblclick:g},null,8,["session","isActive"]),!m.value&&u.value.length>0?(l(!0),r(te,{key:0},le(v.value,(x,E)=>(l(),Ce(Tg,{key:x,sessionId:x,index:E,onClick:_},null,8,["sessionId","index"]))),128)):D("",!0),u.value.length>0?(l(),r("div",{key:1,class:"stack-count",onClick:pe(g,["stop"]),title:`${u.value.length} child agent${u.value.length!==1?"s":""}`},S(u.value.length),9,Og)):D("",!0)],2),m.value?(l(!0),r(te,{key:0},le(u.value,x=>(l(),r(te,{key:x},[ye(Dg,{depth:n.depth,maxDepth:h.value},null,8,["depth","maxDepth"]),c(x)&&d(x)?(l(),Ce(w,{key:0,session:c(x),isActive:x===i.value||y(x),depth:n.depth+1,maxDepth:h.value,onSelect:a[1]||(a[1]=E=>b.$emit("select",E))},null,8,["session","isActive","depth","maxDepth"])):c(x)?(l(),Ce(nn,{key:1,session:c(x),isActive:x===i.value,variant:"child",onSelect:E=>b.$emit("select",x)},null,8,["session","isActive","onSelect"])):D("",!0)],64))),128)):D("",!0)],4)}}}),Lg=se(Mg,[["__scopeId","data-v-720fecbd"]]),Ng={class:"strip-project-label"},Ig={key:0,class:"strip-empty"},jg={__name:"AgentStrip",setup(n){const e=ze(),s=ve(),o=xe(),i=ns(),u=M(null),f=k(()=>{const a=s.currentSession;return a?a.project_id:null});function h(a){const w=u.value&&u.value.contains(a.target),x=a.target.closest(".project-pill-bar");!w&&!x&&(o.collapseAllStacks(),f.value&&o.browsingProjectId!==f.value&&o.setBrowsingProject(f.value))}Oe(()=>{document.addEventListener("click",h,!0)}),De(()=>{document.removeEventListener("click",h,!0)});const p=k(()=>s.currentSessionId),m=k(()=>{const a=o.browsingProjectId;return a?e.getProject(a):null}),v=k(()=>{const a=m.value;return!a||!a.session_ids?[]:a.session_ids.map(w=>s.getSession(w)).filter(Boolean).sort((w,x)=>(w.order||0)-(x.order||0))}),$=k(()=>{const a=new Set;for(const w of v.value)if(w.child_minion_ids)for(const x of w.child_minion_ids)a.add(x);return a}),c=k(()=>v.value.filter(a=>!$.value.has(a.session_id)));function d(a){return a.child_minion_ids&&a.child_minion_ids.length>0}function y(a){return a.child_minion_ids?a.child_minion_ids.includes(p.value):!1}function g(a){const w=s.getSession(a);w&&o.setBrowsingProject(w.project_id),s.selectSession(a),i.push(`/session/${a}`)}function _(a){a.target.classList.contains("agent-strip")&&o.collapseAllStacks()}function b(){const a=m.value;a&&o.showModal("create-minion",{project:a})}return(a,w)=>m.value?(l(),r("div",{key:0,class:H(["agent-strip",{"theme-red":ne(o).isRedBackground}]),ref_key:"stripEl",ref:u,onClick:_},[t("span",Ng,S(m.value.name),1),(l(!0),r(te,null,le(c.value,x=>(l(),r(te,{key:x.session_id},[d(x)?(l(),Ce(Lg,{key:0,session:x,isActive:x.session_id===p.value||y(x),onSelect:g},null,8,["session","isActive"])):(l(),Ce(nn,{key:1,session:x,isActive:x.session_id===p.value,onSelect:g},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:pe(b,["stop"]),title:"Add agent"}," + "),c.value.length===0?(l(),r("span",Ig,"No agents yet")):D("",!0)],2)):(l(),r("div",{key:1,class:H(["agent-strip agent-strip-empty",{"theme-red":ne(o).isRedBackground}])},[...w[0]||(w[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])],2))}},Pg=se(jg,[["__scopeId","data-v-31dc5efd"]]),vn=st("diff",()=>{const n=M(new Map),e=M(!1),s=M(null),o=M("total"),i=M(!1),u=M(null),f=M(null),h=M(null),p=M(new Map),m=k(()=>{const C=ve();return C.currentSessionId&&n.value.get(C.currentSessionId)||null}),v=k(()=>!m.value||!m.value.files?[]:Object.entries(m.value.files).map(([C,O])=>({path:C,...O})).sort((C,O)=>C.path.localeCompare(O.path))),$=k(()=>v.value.length),c=k(()=>!m.value||!m.value.commits?0:m.value.commits.length),d=k(()=>m.value?.is_git_repo===!0),y=k(()=>{const C=h.value;if(C&&C!=="uncommitted"){const O=m.value;if(O?.commits){const V=O.commits.find(P=>P.hash===C);if(V?.files)return V.files.map(P=>({path:P})).sort((P,F)=>P.path.localeCompare(F.path))}return[]}return v.value}),g=k(()=>{if(!u.value||!f.value)return null;const C=h.value||"committed",O=`${u.value}:${C}:${f.value}`;return p.value.get(O)||null});async function _(C){if(C){e.value=!0,s.value=null;try{const O=await es(`/api/sessions/${C}/diff`);n.value.set(C,O),n.value=new Map(n.value)}catch(O){console.error(`Failed to load diff for session ${C}:`,O),s.value=O.message}finally{e.value=!1}}}async function b(C){for(const O of p.value.keys())O.startsWith(`${C}:`)&&p.value.delete(O);p.value=new Map(p.value),await _(C)}async function a(C,O,V=null){if(!C||!O)return;const F=`${C}:${V||"committed"}:${O}`,U=p.value.get(F);if(!(U&&!U.error&&U.content!==null)){p.value.set(F,{content:null,loading:!0,error:null}),p.value=new Map(p.value);try{const X={path:O};V&&(X.ref=V);const I=await es(`/api/sessions/${C}/diff/file`,{params:X});p.value.set(F,{content:I.diff,loading:!1,error:null})}catch(X){console.error(`Failed to load file diff for ${O}:`,X),p.value.set(F,{content:null,loading:!1,error:X.message})}p.value=new Map(p.value)}}function w(C,O,V=null){u.value=C,f.value=O,h.value=V,i.value=!0,a(C,O,V)}function x(){i.value=!1,h.value=null}function E(){if(!u.value)return;const C=y.value;if(C.length===0)return;const V=(C.findIndex(P=>P.path===f.value)+1)%C.length;f.value=C[V].path,a(u.value,f.value,h.value)}function T(){if(!u.value)return;const C=y.value;if(C.length===0)return;const V=(C.findIndex(P=>P.path===f.value)-1+C.length)%C.length;f.value=C[V].path,a(u.value,f.value,h.value)}function A(C){o.value=C}function L(C){n.value.delete(C),n.value=new Map(n.value);for(const O of p.value.keys())O.startsWith(`${C}:`)&&p.value.delete(O);p.value=new Map(p.value),u.value===C&&x()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:i,fullViewSessionId:u,currentFilePath:f,fullViewRef:h,fileDiffCache:p,currentDiff:m,currentFiles:v,fileCount:$,commitCount:c,isGitRepo:d,fullViewFiles:y,currentFullViewFileDiff:g,loadDiff:_,refreshDiff:b,loadFileDiff:a,openFullView:w,closeFullView:x,nextFile:E,prevFile:T,setMode:A,clearDiff:L}}),Rg={key:0,class:"agent-overview"},Bg={class:"overview-identity"},Fg={class:"overview-info"},Vg={class:"overview-name"},Ug={key:0,class:"overview-role"},Wg={class:"overview-stats"},Hg={class:"stat-item"},zg={class:"stat-value"},qg={class:"stat-item"},Kg={class:"stat-value"},Xg={class:"stat-item"},Gg={class:"stat-value"},Yg={class:"stat-item"},Jg={class:"stat-value"},Qg={key:1,class:"agent-overview agent-overview-empty"},Zg={__name:"AgentOverview",setup(n){const e=ve(),s=Pe(),o=xe(),i=M(Date.now());let u=null;Oe(()=>{u=setInterval(()=>{i.value=Date.now()},1e4)}),De(()=>{u&&clearInterval(u)});const f=k(()=>{const a=e.currentSessionId;return a?e.getSession(a):null}),h=k(()=>(f.value?.name||"A").charAt(0).toUpperCase()),p=k(()=>{const a=f.value?.name||"";let w=0;for(let E=0;E<a.length;E++)w=a.charCodeAt(E)+((w<<5)-w);return`hsl(${Math.abs(w%360)}, 60%, 55%)`}),m=k(()=>{if(!f.value)return"status-none";const a=f.value.state;return a==="active"&&f.value.is_processing?"status-active":a==="active"?"status-idle":a==="paused"?"status-waiting":a==="error"?"status-error":a==="terminated"?"status-terminated":"status-none"}),v=k(()=>{if(!f.value)return"None";const a=f.value.state;return a==="active"&&f.value.is_processing?"Processing":a==="active"?"Idle":a==="paused"?"Paused":a==="error"?"Error":a==="terminated"?"Terminated":a==="created"?"Created":a==="starting"?"Starting":a}),$=k(()=>{const a=e.currentSessionId;if(!a)return 0;const w=s.messagesBySession.get(a);return w?w.filter(x=>x.type==="user"||x.type==="assistant").length:0}),c=k(()=>{const a=e.currentSessionId;if(!a)return 0;const w=s.toolCallsBySession.get(a);return w?w.length:0}),d=k(()=>f.value&&f.value.child_minion_ids?.length||0),y=k(()=>{const a=e.currentSessionId;if(!a)return"--";const w=s.launchTimestampBySession.get(a);if(!w)return"--";const x=w*1e3;i.value;let E;const T=f.value?.state;T==="terminated"||T==="error"?E=f.value?.updated_at?new Date(f.value.updated_at).getTime():Date.now():E=Date.now();const A=E-x;if(A<0)return"--";if(A<6e4)return"< 1m";const L=Math.floor(A/6e4);if(L<60)return`${L}m`;const C=Math.floor(L/60);return C<24?`${C}h ${L%60}m`:`${Math.floor(C/24)}d ${C%24}h`});function g(){f.value&&o.showModal("edit-session",{session:f.value})}function _(){f.value&&o.showModal("manage-session",{session:f.value})}function b(){f.value&&o.showModal("session-info",{sessionId:f.value.session_id})}return(a,w)=>f.value?(l(),r("div",Rg,[t("div",Bg,[t("div",{class:"overview-avatar",style:Re({background:p.value})},S(h.value),5),t("div",Fg,[t("div",Vg,S(f.value.name||"Agent"),1),f.value.role?(l(),r("div",Ug,S(f.value.role),1)):D("",!0),t("span",{class:H(["overview-status-badge",m.value])},S(v.value),3)])]),t("div",Wg,[t("div",Hg,[t("span",zg,S($.value),1),w[0]||(w[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",qg,[t("span",Kg,S(c.value),1),w[1]||(w[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",Xg,[t("span",Gg,S(d.value),1),w[2]||(w[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",Yg,[t("span",Jg,S(y.value),1),w[3]||(w[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview",onClick:b,title:"View session details"}," Info "),t("button",{class:"btn-overview",onClick:g,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:_,title:"Manage session lifecycle"}," Manage ")])])):(l(),r("div",Qg,[...w[4]||(w[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},e_=se(Zg,[["__scopeId","data-v-4ef00321"]]),t_={class:"task-row d-flex align-items-center gap-2"},s_={key:0,class:"status-icon"},n_={key:1,class:"status-icon"},o_=["title"],a_={key:0,class:"task-details"},i_={key:0,class:"task-description mb-2"},l_={class:"description-content"},r_={key:1,class:"task-owner mb-2"},c_={class:"ms-1"},u_={key:2,class:"task-blocked-by mb-2"},d_={key:3,class:"task-blocks"},f_={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=k(()=>e.task.status==="in_progress"),o=k(()=>e.task.status==="completed"?"âœ…":"â³"),i=k(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),u=k(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(f,h)=>(l(),r("div",{class:H(["task-item",u.value]),onClick:h[0]||(h[0]=p=>f.$emit("toggle"))},[t("div",t_,[s.value?(l(),r("span",s_,[...h[1]||(h[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(l(),r("span",n_,S(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},S(i.value),9,o_),(l(),r("svg",{class:H(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...h[2]||(h[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(l(),r("div",a_,[n.task.description?(l(),r("div",i_,[h[3]||(h[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",l_,S(n.task.description),1)])):D("",!0),n.task.owner?(l(),r("div",r_,[h[4]||(h[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",c_,S(n.task.owner),1)])):D("",!0),n.task.blockedBy?.length>0?(l(),r("div",u_,[h[5]||(h[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(l(!0),r(te,null,le(n.task.blockedBy,p=>(l(),r("span",{key:p,class:"badge bg-warning text-dark me-1"}," #"+S(p),1))),128))])):D("",!0),n.task.blocks?.length>0?(l(),r("div",d_,[h[6]||(h[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(l(!0),r(te,null,le(n.task.blocks,p=>(l(),r("span",{key:p,class:"badge bg-info text-dark me-1"}," #"+S(p),1))),128))])):D("",!0)])):D("",!0)],2))}},m_=se(f_,[["__scopeId","data-v-0f96ae87"]]),p_={class:"task-list-panel"},v_={class:"task-list p-2"},h_={key:0,class:"empty-placeholder"},g_={__name:"TaskListPanel",setup(n){const e=ts(),s=M(new Set),o=k(()=>e.currentTasks);function i(u){s.value.has(u)?s.value.delete(u):s.value.add(u),s.value=new Set(s.value)}return(u,f)=>(l(),r("div",p_,[t("div",v_,[o.value.length===0?(l(),r("div",h_,[...f[0]||(f[0]=[t("span",null,"Tasks will appear here as the agent works",-1)])])):D("",!0),ye(za,{name:"task-list",tag:"div"},{default:pn(()=>[(l(!0),r(te,null,le(o.value,h=>(l(),Ce(m_,{key:h.id,task:h,isExpanded:s.value.has(h.id),onToggle:p=>i(h.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},__=se(g_,[["__scopeId","data-v-893d4ab0"]]),b_={class:"resource-gallery-panel"},y_={class:"resource-grid-container p-2"},w_={key:0,class:"empty-placeholder"},k_={key:1,class:"resource-grid"},$_=["onClick"],S_=["onClick","title"],x_=["src","alt"],C_=["title","onClick"],E_={class:"file-icon"},T_={class:"file-ext"},A_={class:"resource-info"},D_=["title"],O_={class:"resource-actions"},M_=["onClick"],L_=["href","download"],N_={__name:"ResourceGallery",setup(n){const e=Qe(),s=ve(),o=Oo("addAttachmentFromResource",null),i=k(()=>e.currentResources);function u(g){return e.isImageResource(g)}function f(g){return e.getResourceIcon(g)}function h(g){const _=e.getResourceExtension(g);return _?_.toUpperCase().slice(1):""}function p(g){return e.getResourceUrl(s.currentSessionId,g)}function m(g){return e.getDownloadUrl(s.currentSessionId,g)}function v(g){e.openFullView(s.currentSessionId,g)}function $(g,_=18){return g?g.length<=_?g:g.substring(0,_-3)+"...":""}function c(g){g.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function d(g){e.removeResource(s.currentSessionId,g)}function y(g){o?o(g):console.warn("addAttachmentFromResource not provided")}return(g,_)=>(l(),r("div",b_,[t("div",y_,[i.value.length===0?(l(),r("div",w_,[..._[1]||(_[1]=[t("span",null,"Resources shared by the agent will appear here",-1)])])):(l(),r("div",k_,[(l(!0),r(te,null,le(i.value,(b,a)=>(l(),r("div",{key:b.resource_id,class:H(["resource-item",{"is-image":u(b)}])},[t("button",{class:"remove-btn",onClick:pe(w=>d(b.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[..._[2]||(_[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,$_),u(b)?(l(),r("div",{key:0,class:"resource-thumbnail",onClick:w=>v(a),title:b.title||"Click to view"},[t("img",{src:p(b.resource_id),alt:b.title||"Image",loading:"lazy",onError:c},null,40,x_)],8,S_)):(l(),r("div",{key:1,class:"resource-placeholder",title:b.title||b.original_filename||"Click to view",onClick:w=>v(a)},[t("span",E_,S(f(b)),1),t("span",T_,S(h(b)),1)],8,C_)),t("div",A_,[t("div",{class:"resource-title",title:b.title||b.original_filename},S($(b.title||b.original_filename)),9,D_),t("div",O_,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:pe(w=>y(b),["stop"]),title:"Add to message attachments"},[..._[3]||(_[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,M_),t("a",{href:m(b.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:b.original_filename||b.title||"download",title:"Download",onClick:_[0]||(_[0]=pe(()=>{},["stop"]))},[..._[4]||(_[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,L_)])])],2))),128))]))])]))}},I_=se(N_,[["__scopeId","data-v-5b14b073"]]),j_=["src","alt"],P_={key:1,class:"resource-info"},R_={key:0,class:"resource-title"},B_={key:1,class:"resource-description"},F_={class:"resource-meta"},V_={class:"meta-item"},U_={class:"meta-item"},W_={class:"meta-item"},H_={class:"text-header"},z_={class:"text-header-info"},q_={class:"text-filename"},K_={class:"resource-meta"},X_={key:0,class:"meta-item"},G_={key:1,class:"meta-item"},Y_={key:0,class:"display-mode-toggle"},J_=["title","disabled"],Q_={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Z_={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},eb={class:"copy-label"},tb={class:"text-body"},sb={key:0,class:"text-loading"},nb={key:1,class:"text-error"},ob={key:2,class:"text-content"},ab=["innerHTML"],ib={key:4,class:"text-unavailable"},lb={key:4,class:"position-indicator"},rb={key:5,class:"thumbnail-strip"},cb=["onClick"],ub=["src","alt"],db={key:1,class:"strip-text-icon"},fb={__name:"ResourceFullView",setup(n){Ke.setOptions({breaks:!0,gfm:!0});const e=Qe(),s=M(null),o=M(!1),i=M("raw");let u=null;const f=k(()=>e.fullViewOpen),h=k(()=>e.currentFullViewResource),p=k(()=>e.currentResourceIndex),m=k(()=>e.fullViewTotalResources),v=k(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),$=k(()=>e.isImageResource(h.value)),c=k(()=>h.value?e.getTextContent(h.value.resource_id):null),d=k(()=>c.value?.content||null),y=k(()=>c.value?.loading||!1),g=k(()=>c.value?.error||null),_=k(()=>{if(!d.value)return"";let P=Ke.parse(d.value);return P=P.replace(/\n</g,"<"),P=P.replace(/\n+$/,""),Vt.sanitize(P)});de(f,P=>{P?(rt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),de(p,()=>{i.value="raw"}),de([p,f],()=>{if(f.value&&h.value&&!$.value){const P=h.value.resource_id,F=e.getTextContent(P);(!F||F.error)&&e.fetchTextContent(e.fullViewSessionId,P)}},{immediate:!0}),De(()=>{document.body.style.overflow="",u&&clearTimeout(u)});function b(P){return e.getResourceUrl(e.fullViewSessionId,P)}function a(){e.closeFullView()}function w(){e.nextResource()}function x(){e.prevResource()}function E(P){e.goToResource(P)}function T(P){P.target===P.currentTarget&&a()}function A(P){switch(P.key){case"Escape":a();break;case"ArrowLeft":x();break;case"ArrowRight":w();break;case"Home":E(0);break;case"End":E(m.value-1);break;case"m":!$.value&&d.value&&(i.value=i.value==="raw"?"markdown":"raw");break}}async function L(){if(d.value)try{await navigator.clipboard.writeText(d.value),o.value=!0,u&&clearTimeout(u),u=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function C(P){return P?P<1024?`${P} B`:P<1024*1024?`${(P/1024).toFixed(1)} KB`:`${(P/(1024*1024)).toFixed(2)} MB`:""}function O(P){return P?new Date(P*1e3).toLocaleString():""}function V(P){P.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(P,F)=>(l(),Ce(Lo,{to:"body"},[ye(Mo,{name:"modal"},{default:pn(()=>[f.value?(l(),r("div",{key:0,class:"resource-full-view-overlay",onClick:T,onKeydown:A,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:pe(a,["stop"]),title:"Close (Escape)"},[...F[4]||(F[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(l(),r("button",{key:0,class:"nav-btn nav-prev",onClick:pe(x,["stop"]),title:"Previous (Left Arrow)"},[...F[5]||(F[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):D("",!0),$.value?(l(),r("div",{key:1,class:"image-container",onClick:F[0]||(F[0]=pe(()=>{},["stop"]))},[h.value?(l(),r("img",{key:0,src:b(h.value.resource_id||h.value.image_id),alt:h.value.title||"Image",class:"full-image",onError:V},null,40,j_)):D("",!0),h.value?(l(),r("div",P_,[h.value.title?(l(),r("h5",R_,S(h.value.title),1)):D("",!0),h.value.description?(l(),r("p",B_,S(h.value.description),1)):D("",!0),t("div",F_,[t("span",V_,S(C(h.value.size_bytes)),1),t("span",U_,S(h.value.format?.toUpperCase()),1),t("span",W_,S(O(h.value.timestamp)),1)])])):D("",!0)])):(l(),r("div",{key:2,class:"text-container",onClick:F[3]||(F[3]=pe(()=>{},["stop"]))},[t("div",H_,[t("div",z_,[t("h5",q_,S(h.value?.title||h.value?.original_filename||"Text Resource"),1),t("div",K_,[h.value?.size_bytes?(l(),r("span",X_,S(C(h.value.size_bytes)),1)):D("",!0),h.value?.format?(l(),r("span",G_,S(h.value.format.toUpperCase()),1)):D("",!0)])]),d.value?(l(),r("div",Y_,[t("button",{class:H(["toggle-btn",{active:i.value==="raw"}]),onClick:F[1]||(F[1]=pe(U=>i.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:H(["toggle-btn",{active:i.value==="markdown"}]),onClick:F[2]||(F[2]=pe(U=>i.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):D("",!0),t("button",{class:"copy-btn",onClick:pe(L,["stop"]),title:o.value?"Copied!":i.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!d.value},[o.value?(l(),r("svg",Q_,[...F[6]||(F[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),r("svg",Z_,[...F[7]||(F[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",eb,S(o.value?"Copied!":i.value==="markdown"?"Copy raw":"Copy"),1)],8,J_)]),t("div",tb,[y.value?(l(),r("div",sb,[...F[8]||(F[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):g.value?(l(),r("div",nb," Failed to load content: "+S(g.value),1)):d.value&&i.value==="raw"?(l(),r("pre",ob,S(d.value),1)):d.value&&i.value==="markdown"?(l(),r("div",{key:3,class:"markdown-content",innerHTML:_.value},null,8,ab)):(l(),r("div",ib," Preview not available for this file type. "))])])),m.value>1?(l(),r("button",{key:3,class:"nav-btn nav-next",onClick:pe(w,["stop"]),title:"Next (Right Arrow)"},[...F[9]||(F[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):D("",!0),m.value>1?(l(),r("div",lb,S(p.value+1)+" / "+S(m.value),1)):D("",!0),m.value>1?(l(),r("div",rb,[(l(!0),r(te,null,le(v.value,(U,X)=>(l(),r("div",{key:U.resource_id||U.image_id,class:H(["strip-thumbnail",{active:X===p.value,"is-text":!ne(e).isImageResource(U)}]),onClick:pe(I=>E(X),["stop"])},[ne(e).isImageResource(U)?(l(),r("img",{key:0,src:b(U.resource_id||U.image_id),alt:U.title||"Thumbnail",loading:"lazy"},null,8,ub)):(l(),r("span",db,S(ne(e).getResourceIcon(U)),1))],10,cb))),128))])):D("",!0)],544)):D("",!0)]),_:1})]))}},mb=se(fb,[["__scopeId","data-v-169421b1"]]),pb={class:"diff-panel"},vb={class:"diff-body"},hb={key:0,class:"text-center py-4"},gb={key:1,class:"empty-placeholder"},_b={key:2,class:"empty-placeholder"},bb={key:3,class:"text-danger text-center py-4"},yb={class:"mb-0 small"},wb={key:4,class:"empty-placeholder"},kb=["disabled"],$b={key:5},Sb={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},xb=["disabled"],Cb={class:"stats-bar px-3 py-1 border-bottom small text-muted"},Eb={class:"text-success"},Tb={class:"text-danger"},Ab={class:"ms-2"},Db={key:0,class:"ms-2"},Ob={key:0,class:"file-list"},Mb=["onClick"],Lb=["title"],Nb={key:0,class:"file-stats small text-nowrap"},Ib={key:0,class:"text-success"},jb={key:1,class:"text-muted"},Pb={key:2,class:"text-danger"},Rb={key:1,class:"file-stats small text-muted"},Bb={key:1,class:"commit-list"},Fb=["onClick"],Vb={key:0,class:"wip-badge"},Ub={key:1,class:"commit-hash"},Wb=["title"],Hb={key:2,class:"commit-date small text-muted text-nowrap"},zb={key:0,class:"commit-files"},qb=["onClick"],Kb=["title"],Xb={key:6,class:"empty-placeholder"},Gb={__name:"DiffPanel",setup(n){const e=vn(),s=ve(),o=M(new Set);function i(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function u(v,$=null){s.currentSessionId&&e.openFullView(s.currentSessionId,v,$)}function f(v){o.value.has(v)?o.value.delete(v):o.value.add(v),o.value=new Set(o.value)}function h(v){switch(v){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function p(v){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[v]?.status||"modified"}function m(v){if(!v)return"";const $=new Date(v),d=new Date-$,y=Math.floor(d/6e4);if(y<1)return"just now";if(y<60)return`${y}m ago`;const g=Math.floor(y/60);return g<24?`${g}h ago`:`${Math.floor(g/24)}d ago`}return de(()=>s.currentSessionId,v=>{v&&!e.diffBySession.get(v)&&e.loadDiff(v)},{immediate:!0}),de(()=>e.currentDiff,v=>{if(v?.commits){const $=v.commits.find(c=>c.is_uncommitted);$&&(o.value.add($.hash),o.value=new Set(o.value))}},{immediate:!0}),(v,$)=>(l(),r("div",pb,[t("div",vb,[ne(e).loading&&!ne(e).currentDiff?(l(),r("div",hb,[...$[2]||($[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):ne(e).currentDiff&&!ne(e).isGitRepo?(l(),r("div",gb,[...$[3]||($[3]=[t("span",null,"Not a git repository",-1)])])):ne(e).currentDiff&&ne(e).currentDiff.error?(l(),r("div",_b,[t("span",null,S(ne(e).currentDiff.error),1)])):ne(e).error?(l(),r("div",bb,[t("p",yb,S(ne(e).error),1)])):ne(e).currentDiff&&ne(e).fileCount===0?(l(),r("div",wb,[$[6]||($[6]=t("span",null,"No changes since main",-1)),t("button",{class:"refresh-inline",onClick:i,disabled:ne(e).loading,title:"Refresh diff"},[(l(),r("svg",{class:H({spin:ne(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[4]||($[4]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2)),$[5]||($[5]=ce(" Refresh ",-1))],8,kb)])):ne(e).currentDiff&&ne(e).fileCount>0?(l(),r("div",$b,[t("div",Sb,[t("button",{class:H(["btn btn-sm",ne(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:$[0]||($[0]=c=>ne(e).setMode("total"))}," Total Changes ",2),t("button",{class:H(["btn btn-sm",ne(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:$[1]||($[1]=c=>ne(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:i,title:"Refresh diff",disabled:ne(e).loading},[(l(),r("svg",{class:H({spin:ne(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[7]||($[7]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,xb)]),t("div",Cb,[t("span",Eb,"+"+S(ne(e).currentDiff.total_insertions),1),$[8]||($[8]=t("span",{class:"mx-1"},"/",-1)),t("span",Tb,"-"+S(ne(e).currentDiff.total_deletions),1),t("span",Ab,S(ne(e).fileCount)+" file"+S(ne(e).fileCount!==1?"s":""),1),ne(e).commitCount>0?(l(),r("span",Db,S(ne(e).commitCount)+" commit"+S(ne(e).commitCount!==1?"s":""),1)):D("",!0)]),ne(e).currentMode==="total"?(l(),r("div",Ob,[(l(!0),r(te,null,le(ne(e).currentFiles,c=>(l(),r("div",{key:c.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:d=>u(c.path,null)},[t("span",{class:H(["status-icon","status-"+c.status])},S(h(c.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:c.path},S(c.path),9,Lb),c.is_binary?(l(),r("span",Rb,"binary")):(l(),r("span",Nb,[c.insertions>0?(l(),r("span",Ib,"+"+S(c.insertions),1)):D("",!0),c.insertions>0&&c.deletions>0?(l(),r("span",jb,"/")):D("",!0),c.deletions>0?(l(),r("span",Pb,"-"+S(c.deletions),1)):D("",!0)]))],8,Mb))),128))])):(l(),r("div",Bb,[(l(!0),r(te,null,le(ne(e).currentDiff.commits,c=>(l(),r("div",{key:c.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:d=>f(c.hash)},[(l(),r("svg",{class:H(["chevron-icon",{expanded:o.value.has(c.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...$[9]||($[9]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),c.is_uncommitted?(l(),r("span",Vb,"WIP")):(l(),r("code",Ub,S(c.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:c.message},S(c.message),9,Wb),c.is_uncommitted?D("",!0):(l(),r("span",Hb,S(m(c.date)),1))],8,Fb),o.value.has(c.hash)?(l(),r("div",zb,[(l(!0),r(te,null,le(c.files,d=>(l(),r("div",{key:d,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:y=>u(d,c.is_uncommitted?"uncommitted":c.hash)},[t("span",{class:H(["status-icon","status-"+p(d)])},S(h(p(d))),3),t("span",{class:"file-path text-truncate small",title:d},S(d),9,Kb)],8,qb))),128))])):D("",!0)]))),128))]))])):(l(),r("div",Xb,[...$[10]||($[10]=[t("span",null,"No diff data available",-1)])]))])]))}},Yb=se(Gb,[["__scopeId","data-v-164fd7bb"]]),Jb={class:"diff-header"},Qb={class:"diff-header-info"},Zb={class:"diff-filename"},ey={class:"diff-meta"},ty={key:0,class:"commit-ref-badge"},sy={class:"commit-ref-msg"},ny={key:2,class:"meta-item"},oy={class:"text-success"},ay={class:"text-danger"},iy=["title","disabled"],ly={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ry={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},cy={class:"copy-label"},uy={class:"diff-body"},dy={key:0,class:"diff-loading"},fy={key:1,class:"diff-error"},my={key:2,class:"diff-content"},py={class:"diff-table"},vy={class:"line-num line-num-old"},hy={class:"line-num line-num-new"},gy={class:"line-content"},_y={class:"line-prefix"},by={key:3,class:"diff-empty"},yy={key:2,class:"position-indicator"},wy={__name:"DiffFullView",setup(n){const e=vn(),s=M(null),o=M(!1);let i=null;const u=k(()=>e.fullViewOpen),f=k(()=>e.currentFullViewFileDiff),h=k(()=>f.value?.content||null),p=k(()=>e.fullViewFiles.length),m=k(()=>e.currentFilePath?e.fullViewFiles.findIndex(a=>a.path===e.currentFilePath):0),v=k(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),$=k(()=>{const a=e.fullViewRef;if(!a||a==="uncommitted")return null;const w=e.currentDiff;return w?.commits&&w.commits.find(x=>x.hash===a)||null}),c=k(()=>{if(!h.value)return[];const a=h.value.split(`
`),w=[];let x=0,E=0;for(const T of a){if(T.startsWith("diff --git")||T.startsWith("index ")||T.startsWith("---")||T.startsWith("+++")||T.startsWith("new file")||T.startsWith("deleted file")||T.startsWith("similarity")||T.startsWith("rename")||T.startsWith("Binary")){T.startsWith("Binary")&&w.push({type:"info",prefix:"",text:T,oldNum:null,newNum:null});continue}if(T.startsWith("@@")){const A=T.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);A&&(x=parseInt(A[1]),E=parseInt(A[2]),w.push({type:"hunk",prefix:"",text:T,oldNum:null,newNum:null}));continue}T.startsWith(" ")||T.length>0&&!T.startsWith("+")&&!T.startsWith("-")&&!T.startsWith("\\")?(w.push({type:"context",prefix:" ",text:T.substring(1),oldNum:x,newNum:E}),x++,E++):T.startsWith("+")?(w.push({type:"add",prefix:"+",text:T.substring(1),oldNum:null,newNum:E}),E++):T.startsWith("-")?(w.push({type:"remove",prefix:"-",text:T.substring(1),oldNum:x,newNum:null}),x++):T.startsWith("\\")&&w.push({type:"info",prefix:"",text:T,oldNum:null,newNum:null})}return w});function d(a){return`diff-line diff-line-${a.type}`}function y(){e.closeFullView()}function g(a){a.target===a.currentTarget&&y()}function _(a){switch(a.key){case"Escape":y();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function b(){if(h.value)try{await navigator.clipboard.writeText(h.value),o.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return de(u,a=>{a?(rt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),De(()=>{document.body.style.overflow="",i&&clearTimeout(i)}),(a,w)=>(l(),Ce(Lo,{to:"body"},[ye(Mo,{name:"modal"},{default:pn(()=>[u.value?(l(),r("div",{key:0,class:"diff-full-view-overlay",onClick:g,onKeydown:_,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:pe(y,["stop"]),title:"Close (Escape)"},[...w[3]||(w[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(l(),r("button",{key:0,class:"nav-btn nav-prev",onClick:w[0]||(w[0]=pe(x=>ne(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...w[4]||(w[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):D("",!0),t("div",{class:"diff-container",onClick:w[1]||(w[1]=pe(()=>{},["stop"]))},[t("div",Jb,[t("div",Qb,[t("h5",Zb,S(ne(e).currentFilePath),1),t("div",ey,[$.value?(l(),r("span",ty,[t("code",null,S($.value.short_hash),1),t("span",sy,S($.value.message),1)])):D("",!0),v.value?(l(),r("span",{key:1,class:H(["meta-badge","status-"+v.value.status])},S(v.value.status),3)):D("",!0),v.value&&!v.value.is_binary?(l(),r("span",ny,[t("span",oy,"+"+S(v.value.insertions),1),w[5]||(w[5]=ce(" / ",-1)),t("span",ay,"-"+S(v.value.deletions),1)])):D("",!0)])]),t("button",{class:"copy-btn",onClick:pe(b,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!h.value},[o.value?(l(),r("svg",ly,[...w[6]||(w[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),r("svg",ry,[...w[7]||(w[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",cy,S(o.value?"Copied!":"Copy"),1)],8,iy)]),t("div",uy,[f.value&&f.value.loading?(l(),r("div",dy,[...w[8]||(w[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):f.value&&f.value.error?(l(),r("div",fy," Failed to load diff: "+S(f.value.error),1)):h.value?(l(),r("div",my,[t("table",py,[t("tbody",null,[(l(!0),r(te,null,le(c.value,(x,E)=>(l(),r("tr",{key:E,class:H(d(x))},[t("td",vy,S(x.oldNum||""),1),t("td",hy,S(x.newNum||""),1),t("td",gy,[t("span",_y,S(x.prefix),1),t("span",null,S(x.text),1)])],2))),128))])])])):(l(),r("div",by," No diff available for this file. "))])]),p.value>1?(l(),r("button",{key:1,class:"nav-btn nav-next",onClick:w[2]||(w[2]=pe(x=>ne(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...w[9]||(w[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):D("",!0),p.value>1?(l(),r("div",yy,S(m.value+1)+" / "+S(p.value),1)):D("",!0)],544)):D("",!0)]),_:1})]))}},ky=se(wy,[["__scopeId","data-v-1c2aa9a4"]]),$y={class:"comms-panel"},Sy={key:0,class:"empty-placeholder"},xy=["onClick"],Cy={class:"comm-meta"},Ey={class:"comm-icon"},Ty={class:"comm-type"},Ay={class:"comm-direction"},Dy={class:"comm-time"},Oy={class:"comm-summary"},My=["innerHTML"],Ly="ffffffff-ffff-ffff-ffff-ffffffffffff",Ny="00000000-0000-0000-0000-000000000000",Iy={__name:"CommsPanel",setup(n){const e=ve(),s=Ut(),o=nt(),i=M(null),u=M(new Set);Ke.setOptions({breaks:!0,gfm:!0});const f=k(()=>e.currentSession?.project_id||null),h=k(()=>e.currentSessionId),p=k(()=>{if(!f.value)return[];const E=s.commsByLegion.get(f.value)||[],T=h.value;return T?E.filter(A=>A.from_minion_id===T||A.to_minion_id===T):[]}),m=[{bg:"#fef3c7",border:"#fde68a"},{bg:"#fce7f3",border:"#fbcfe8"},{bg:"#e0e7ff",border:"#c7d2fe"},{bg:"#d1fae5",border:"#a7f3d0"},{bg:"#ede9fe",border:"#ddd6fe"},{bg:"#fee2e2",border:"#fecaca"},{bg:"#cffafe",border:"#a5f3fc"},{bg:"#fef9c3",border:"#fef08a"}],v=new Map;function $(E){if(!E)return null;if(v.has(E))return v.get(E);let T=0;for(let C=0;C<E.length;C++)T=(T<<5)-T+E.charCodeAt(C)|0;const A=Math.abs(T)%m.length,L=m[A];return v.set(E,L),L}function c(E){const T=E.from_minion_id;if(T===Ly)return{background:"#f1f5f9",borderColor:"#e2e8f0",opacity:.8};if(E.from_user||T===Ny)return{background:"#eef2ff",borderColor:"#e0e7ff"};if(T===h.value)return{background:"#f8fafc",borderColor:"#e2e8f0"};const A=$(T);return A?{background:A.bg,borderColor:A.border}:{background:"#f8fafc",borderColor:"#e2e8f0"}}function d(E){return{task:"ðŸ“‹",question:"â“",report:"ðŸ“Š",info:"ðŸ’¡",system:"âš™ï¸",halt:"ðŸ›‘",pivot:"ðŸ›‘",spawn:"ðŸŒŸ",dispose:"ðŸ—‘ï¸",thought:"ðŸ’­"}[E]||"ðŸ’¬"}function y(E){return E?E.charAt(0).toUpperCase()+E.slice(1):""}function g(E){const T=E.from_minion_name||(E.from_user?"User":"System"),A=E.to_minion_name||(E.to_user?"User":"Unknown");return`${T} â†’ ${A}`}function _(E){return E.content&&E.content!==E.summary}function b(E,T){return E?E.length<=T?E:E.substring(0,T)+"...":""}function a(E){u.value.has(E)?u.value.delete(E):u.value.add(E),u.value=new Set(u.value)}function w(E){if(!E)return"";let T=Ke.parse(E);return T=T.replace(/\n</g,"<"),T=T.replace(/\n+$/,""),Vt.sanitize(T)}de(()=>p.value.length,async()=>{await rt(),i.value&&(i.value.scrollTop=i.value.scrollHeight)});function x(E){if(!E)return;s.setCurrentLegion(E),s.commsByLegion.get(E)||s.loadTimeline(E),(!o.legionConnected||o.currentLegionId!==E)&&o.connectLegion(E)}return de(f,E=>{E&&x(E)},{immediate:!0}),de(()=>o.legionConnected,E=>{E&&f.value&&s.loadTimeline(f.value)}),(E,T)=>(l(),r("div",$y,[p.value.length===0?(l(),r("div",Sy,[...T[0]||(T[0]=[t("span",null,"Communication between this session's minions will appear here",-1)])])):(l(),r("div",{key:1,class:"comms-list",ref_key:"commsList",ref:i},[(l(!0),r(te,null,le(p.value,A=>(l(),r("div",{key:A.comm_id,class:H(["comm-item",{expandable:_(A)}]),style:Re(c(A)),onClick:L=>_(A)&&a(A.comm_id)},[t("div",Cy,[t("span",Ey,S(d(A.comm_type)),1),t("span",Ty,S(y(A.comm_type)),1),t("span",Ay,S(g(A)),1),t("span",Dy,S(ne(os)(A.timestamp)),1),_(A)?(l(),r("svg",{key:0,class:H(["expand-chevron",{expanded:u.value.has(A.comm_id)}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[...T[1]||(T[1]=[t("path",{d:"M4.5 2.5L8 6L4.5 9.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)):D("",!0)]),t("div",Oy,S(A.summary||b(A.content,120)),1),u.value.has(A.comm_id)?(l(),r("div",{key:0,class:"comm-content",innerHTML:w(A.content)},null,8,My)):D("",!0)],14,xy))),128))],512))]))}},jy=se(Iy,[["__scopeId","data-v-fa8a184a"]]);var Fs={exports:{}},zn;function Py(){return zn||(zn=1,(function(n,e){(function(o,i){n.exports=i()})(globalThis,()=>(()=>{var s={949(f,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.CronParser=void 0;var m=p(515),v=(function(){function $(c,d,y){d===void 0&&(d=!0),y===void 0&&(y=!1),this.expression=c,this.dayOfWeekStartIndexZero=d,this.monthStartIndexZero=y}return $.prototype.parse=function(){var c,d,y=(c=this.expression)!==null&&c!==void 0?c:"";if(y==="@reboot")return d=["@reboot","","","","","",""],d;if(y.startsWith("@")){var g=this.parseSpecial(this.expression);d=this.extractParts(g)}else d=this.extractParts(this.expression);return this.normalize(d),this.validate(d),d},$.prototype.parseSpecial=function(c){var d={"@yearly":"0 0 1 1 *","@annually":"0 0 1 1 *","@monthly":"0 0 1 * *","@weekly":"0 0 * * 0","@daily":"0 0 * * *","@midnight":"0 0 * * *","@hourly":"0 * * * *","@reboot":"@reboot"},y=d[c];if(!y)throw new Error("Unknown special expression.");return y},$.prototype.extractParts=function(c){if(!this.expression)throw new Error("cron expression is empty");for(var d=c.trim().split(/[ ]+/),y=0;y<d.length;y++)if(d[y].includes(",")){var g=d[y].split(",").map(function(b){return b.trim()}).filter(function(b){return b!==""}).map(function(b){return isNaN(Number(b))?b:Number(b)}).filter(function(b){return b!==null&&b!==""});g.length===0&&g.push("*"),g.sort(function(b,a){return b!==null&&a!==null?b-a:0}),d[y]=g.map(function(b){return b!==null?b.toString():""}).join(",")}if(d.length<5)throw new Error("Expression has only ".concat(d.length," part").concat(d.length==1?"":"s",". At least 5 parts are required."));if(d.length==5)d.unshift(""),d.push("");else if(d.length==6){var _=/\d{4}$/.test(d[5])||d[4]=="?"||d[2]=="?";_?d.unshift(""):d.push("")}else if(d.length>7)throw new Error("Expression has ".concat(d.length," parts; too many!"));return d},$.prototype.normalize=function(c){var d=this;if(c[3]=c[3].replace("?","*"),c[5]=c[5].replace("?","*"),c[2]=c[2].replace("?","*"),c[0].indexOf("0/")==0&&(c[0]=c[0].replace("0/","*/")),c[1].indexOf("0/")==0&&(c[1]=c[1].replace("0/","*/")),c[2].indexOf("0/")==0&&(c[2]=c[2].replace("0/","*/")),c[3].indexOf("1/")==0&&(c[3]=c[3].replace("1/","*/")),c[4].indexOf("1/")==0&&(c[4]=c[4].replace("1/","*/")),c[6].indexOf("1/")==0&&(c[6]=c[6].replace("1/","*/")),c[5]=c[5].replace(/(^\d)|([^#/\s]\d)/g,function(E){var T=E.replace(/\D/,""),A=T;return d.dayOfWeekStartIndexZero?T=="7"&&(A="0"):A=(parseInt(T)-1).toString(),E.replace(T,A)}),c[5]=="L"&&(c[5]="6"),c[3]=="?"&&(c[3]="*"),c[3].indexOf("W")>-1&&(c[3].indexOf(",")>-1||c[3].indexOf("-")>-1))throw new Error("The 'W' character can be specified only when the day-of-month is a single day, not a range or list of days.");var y={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6};for(var g in y)c[5]=c[5].replace(new RegExp(g,"gi"),y[g].toString());c[4]=c[4].replace(/(^\d{1,2})|([^#/\s]\d{1,2})/g,function(E){var T=E.replace(/\D/,""),A=T;return d.monthStartIndexZero&&(A=(parseInt(T)+1).toString()),E.replace(T,A)});var _={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};for(var b in _)c[4]=c[4].replace(new RegExp(b,"gi"),_[b].toString());c[0]=="0"&&(c[0]=""),!/\*|\-|\,|\//.test(c[2])&&(/\*|\//.test(c[1])||/\*|\//.test(c[0]))&&(c[2]+="-".concat(c[2]));for(var a=0;a<c.length;a++)if(c[a].indexOf(",")!=-1&&(c[a]=c[a].split(",").filter(function(E){return E!==""}).join(",")||"*"),c[a]=="*/1"&&(c[a]="*"),c[a].indexOf("/")>-1&&!/^\*|\-|\,/.test(c[a])){var w=null;switch(a){case 4:w="12";break;case 5:w="6";break;case 6:w="9999";break;default:w=null;break}if(w!==null){var x=c[a].split("/");c[a]="".concat(x[0],"-").concat(w,"/").concat(x[1])}}},$.prototype.validate=function(c){var d="0-9,\\-*/";this.validateOnlyExpectedCharactersFound(c[0],d),this.validateOnlyExpectedCharactersFound(c[1],d),this.validateOnlyExpectedCharactersFound(c[2],d),this.validateOnlyExpectedCharactersFound(c[3],"0-9,\\-*/LW"),this.validateOnlyExpectedCharactersFound(c[4],d),this.validateOnlyExpectedCharactersFound(c[5],"0-9,\\-*/L#"),this.validateOnlyExpectedCharactersFound(c[6],d),this.validateAnyRanges(c)},$.prototype.validateAnyRanges=function(c){m.default.secondRange(c[0]),m.default.minuteRange(c[1]),m.default.hourRange(c[2]),m.default.dayOfMonthRange(c[3]),m.default.monthRange(c[4],this.monthStartIndexZero),m.default.dayOfWeekRange(c[5],this.dayOfWeekStartIndexZero)},$.prototype.validateOnlyExpectedCharactersFound=function(c,d){var y=c.match(new RegExp("[^".concat(d,"]+"),"gi"));if(y&&y.length)throw new Error("Expression contains invalid values: '".concat(y.toString(),"'"))},$})();h.CronParser=v},333(f,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.ExpressionDescriptor=void 0;var m=p(823),v=p(949),$=(function(){function c(d,y){if(this.expression=d,this.options=y,this.expressionParts=new Array(5),!this.options.locale&&c.defaultLocale&&(this.options.locale=c.defaultLocale),!c.locales[this.options.locale]){var g=Object.keys(c.locales)[0];console.warn("Locale '".concat(this.options.locale,"' could not be found; falling back to '").concat(g,"'.")),this.options.locale=g}this.i18n=c.locales[this.options.locale],y.use24HourTimeFormat===void 0&&(y.use24HourTimeFormat=this.i18n.use24HourTimeFormatByDefault())}return c.toString=function(d,y){var g=y===void 0?{}:y,_=g.throwExceptionOnParseError,b=_===void 0?!0:_,a=g.verbose,w=a===void 0?!1:a,x=g.dayOfWeekStartIndexZero,E=x===void 0?!0:x,T=g.monthStartIndexZero,A=T===void 0?!1:T,L=g.use24HourTimeFormat,C=g.locale,O=C===void 0?null:C,V=g.logicalAndDayFields,P=V===void 0?!1:V,F={throwExceptionOnParseError:b,verbose:w,dayOfWeekStartIndexZero:E,monthStartIndexZero:A,use24HourTimeFormat:L,locale:O,logicalAndDayFields:P};F.tzOffset&&console.warn("'tzOffset' option has been deprecated and is no longer supported.");var U=new c(d,F);return U.getFullDescription()},c.initialize=function(d,y){y===void 0&&(y="en"),c.specialCharacters=["/","-",",","*"],c.defaultLocale=y,d.load(c.locales)},c.prototype.getFullDescription=function(){var d,y,g="";try{var _=new v.CronParser(this.expression,this.options.dayOfWeekStartIndexZero,this.options.monthStartIndexZero);if(this.expressionParts=_.parse(),this.expressionParts[0]==="@reboot")return((y=(d=this.i18n).atReboot)===null||y===void 0?void 0:y.call(d))||"Run once, at startup";var b=this.getTimeOfDayDescription(),a=this.getDayOfMonthDescription(),w=this.getMonthDescription(),x=this.getDayOfWeekDescription(),E=this.getYearDescription();g+=b+a+x+w+E,g=this.transformVerbosity(g,!!this.options.verbose),g=g.charAt(0).toLocaleUpperCase()+g.substr(1)}catch(T){if(!this.options.throwExceptionOnParseError)g=this.i18n.anErrorOccuredWhenGeneratingTheExpressionD();else throw"".concat(T)}return g},c.prototype.getTimeOfDayDescription=function(){var d=this.expressionParts[0],y=this.expressionParts[1],g=this.expressionParts[2],_="";if(!m.StringUtilities.containsAny(y,c.specialCharacters)&&!m.StringUtilities.containsAny(g,c.specialCharacters)&&!m.StringUtilities.containsAny(d,c.specialCharacters))_+=this.i18n.atSpace()+this.formatTime(g,y,d);else if(!d&&y.indexOf("-")>-1&&!(y.indexOf(",")>-1)&&!(y.indexOf("/")>-1)&&!m.StringUtilities.containsAny(g,c.specialCharacters)){var b=y.split("-");_+=m.StringUtilities.format(this.i18n.everyMinuteBetweenX0AndX1(),this.formatTime(g,b[0],""),this.formatTime(g,b[1],""))}else if(!d&&g.indexOf(",")>-1&&g.indexOf("-")==-1&&g.indexOf("/")==-1&&!m.StringUtilities.containsAny(y,c.specialCharacters)){var a=g.split(",");_+=this.i18n.at();for(var w=0;w<a.length;w++)_+=" ",_+=this.formatTime(a[w],y,""),w<a.length-2&&(_+=","),w==a.length-2&&(_+=this.i18n.spaceAnd())}else{var x=this.getSecondsDescription(),E=this.getMinutesDescription(),T=this.getHoursDescription();if(_+=x,_&&E&&(_+=", "),_+=E,E===T)return _;_&&T&&(_+=", "),_+=T}return _},c.prototype.getSecondsDescription=function(){var d=this,y=this.getSegmentDescription(this.expressionParts[0],this.i18n.everySecond(),function(g){return g},function(g){return m.StringUtilities.format(d.i18n.everyX0Seconds(g),g)},function(g){return d.i18n.secondsX0ThroughX1PastTheMinute()},function(g){return g=="0"?"":parseInt(g)<20?d.i18n.atX0SecondsPastTheMinute(g):d.i18n.atX0SecondsPastTheMinuteGt20()||d.i18n.atX0SecondsPastTheMinute(g)});return y},c.prototype.getMinutesDescription=function(){var d=this,y=this.expressionParts[0],g=this.expressionParts[2],_=this.getSegmentDescription(this.expressionParts[1],this.i18n.everyMinute(),function(b){return b},function(b){return m.StringUtilities.format(d.i18n.everyX0Minutes(b),b)},function(b){return d.i18n.minutesX0ThroughX1PastTheHour()},function(b){var a,w;try{return b=="0"&&g.indexOf("/")==-1&&y==""?d.i18n.everyHour():b=="0"?((w=(a=d.i18n).onTheHour)===null||w===void 0?void 0:w.call(a))||d.i18n.atX0MinutesPastTheHour(b):parseInt(b)<20?d.i18n.atX0MinutesPastTheHour(b):d.i18n.atX0MinutesPastTheHourGt20()||d.i18n.atX0MinutesPastTheHour(b)}catch{return d.i18n.atX0MinutesPastTheHour(b)}});return _},c.prototype.getHoursDescription=function(){var d=this,y=this.expressionParts[2],g=0,_=[];y.split("/")[0].split(",").forEach(function(w){var x=w.split("-");x.length===2&&_.push({value:x[1],index:g+1}),g+=x.length});var b=0,a=this.getSegmentDescription(y,this.i18n.everyHour(),function(w){var x=_.find(function(T){return T.value===w&&T.index===b}),E=x&&d.expressionParts[1]!=="0";return b++,E?d.formatTime(w,"59",""):d.formatTime(w,"0","")},function(w){return m.StringUtilities.format(d.i18n.everyX0Hours(w),w)},function(w){return d.i18n.betweenX0AndX1()},function(w){return d.i18n.atX0()});return a},c.prototype.getDayOfWeekDescription=function(){var d=this,y=this.i18n.daysOfTheWeek(),g=null;return this.expressionParts[5]=="*"?g="":g=this.getSegmentDescription(this.expressionParts[5],this.i18n.commaEveryDay(),function(_,b){var a=_;_.indexOf("#")>-1?a=_.substring(0,_.indexOf("#")):_.indexOf("L")>-1&&(a=a.replace("L",""));var w=parseInt(a),x=d.i18n.daysOfTheWeekInCase?d.i18n.daysOfTheWeekInCase(b)[w]:y[w];if(_.indexOf("#")>-1){var E=null,T=_.substring(_.indexOf("#")+1),A=_.substring(0,_.indexOf("#"));switch(T){case"1":E=d.i18n.first(A);break;case"2":E=d.i18n.second(A);break;case"3":E=d.i18n.third(A);break;case"4":E=d.i18n.fourth(A);break;case"5":E=d.i18n.fifth(A);break}x=E+" "+x}return x},function(_){return parseInt(_)==1?"":m.StringUtilities.format(d.i18n.commaEveryX0DaysOfTheWeek(_),_)},function(_){var b=_.substring(0,_.indexOf("-")),a=d.expressionParts[3]!="*";return a?d.i18n.commaAndX0ThroughX1(b):d.i18n.commaX0ThroughX1(b)},function(_){var b=null;if(_.indexOf("#")>-1){var a=_.substring(_.indexOf("#")+1),w=_.substring(0,_.indexOf("#"));b=d.i18n.commaOnThe(a,w).trim()+d.i18n.spaceX0OfTheMonth()}else if(_.indexOf("L")>-1)b=d.i18n.commaOnTheLastX0OfTheMonth(_.replace("L",""));else{var x=d.expressionParts[3]!="*";x?d.options.logicalAndDayFields?b=d.i18n.commaOnlyOnX0(_):b=d.i18n.commaAndOnX0():b=d.i18n.commaOnlyOnX0(_)}return b}),g},c.prototype.getMonthDescription=function(){var d=this,y=this.i18n.monthsOfTheYear(),g=this.getSegmentDescription(this.expressionParts[4],"",function(_,b){return b&&d.i18n.monthsOfTheYearInCase?d.i18n.monthsOfTheYearInCase(b)[parseInt(_)-1]:y[parseInt(_)-1]},function(_){return parseInt(_)==1?"":m.StringUtilities.format(d.i18n.commaEveryX0Months(_),_)},function(_){return d.i18n.commaMonthX0ThroughMonthX1()||d.i18n.commaX0ThroughX1()},function(_){return d.i18n.commaOnlyInMonthX0?d.i18n.commaOnlyInMonthX0():d.i18n.commaOnlyInX0()});return g},c.prototype.getDayOfMonthDescription=function(){var d=this,y=null,g=this.expressionParts[3];switch(g){case"L":y=this.i18n.commaOnTheLastDayOfTheMonth();break;case"WL":case"LW":y=this.i18n.commaOnTheLastWeekdayOfTheMonth();break;default:var _=g.match(/(\d{1,2}W)|(W\d{1,2})/);if(_){var b=parseInt(_[0].replace("W","")),a=b==1?this.i18n.firstWeekday():m.StringUtilities.format(this.i18n.weekdayNearestDayX0(),b.toString());y=m.StringUtilities.format(this.i18n.commaOnTheX0OfTheMonth(),a);break}else{var w=g.match(/L-(\d{1,2})/);if(w){var x=w[1];y=m.StringUtilities.format(this.i18n.commaDaysBeforeTheLastDayOfTheMonth(x),x);break}else{if(g=="*"&&this.expressionParts[5]!="*")return"";y=this.getSegmentDescription(g,this.i18n.commaEveryDay(),function(E){return E=="L"?d.i18n.lastDay():d.i18n.dayX0?m.StringUtilities.format(d.i18n.dayX0(),E):E},function(E){return E=="1"?d.i18n.commaEveryDay():d.i18n.commaEveryX0Days(E)},function(E){return d.i18n.commaBetweenDayX0AndX1OfTheMonth(E)},function(E){return d.i18n.commaOnDayX0OfTheMonth(E)})}break}}return y},c.prototype.getYearDescription=function(){var d=this,y=this.getSegmentDescription(this.expressionParts[6],"",function(g){return/^\d+$/.test(g)?new Date(parseInt(g),1).getFullYear().toString():g},function(g){return m.StringUtilities.format(d.i18n.commaEveryX0Years(g),g)},function(g){return d.i18n.commaYearX0ThroughYearX1()||d.i18n.commaX0ThroughX1()},function(g){return d.i18n.commaOnlyInYearX0?d.i18n.commaOnlyInYearX0():d.i18n.commaOnlyInX0()});return y},c.prototype.getSegmentDescription=function(d,y,g,_,b,a){var w=null,x=d.indexOf("/")>-1,E=d.indexOf("-")>-1,T=d.indexOf(",")>-1;if(!d)w="";else if(d==="*")w=y;else if(!x&&!E&&!T)w=m.StringUtilities.format(a(d),g(d));else if(T){for(var A=d.split(","),L="",C=0;C<A.length;C++)if(C>0&&A.length>2&&(L+=",",C<A.length-1&&(L+=" ")),C>0&&A.length>1&&(C==A.length-1||A.length==2)&&(L+="".concat(this.i18n.spaceAnd()," ")),A[C].indexOf("/")>-1||A[C].indexOf("-")>-1){var O=A[C].indexOf("-")>-1&&A[C].indexOf("/")==-1,V=this.getSegmentDescription(A[C],y,g,_,O?this.i18n.commaX0ThroughX1:b,a);O&&(V=V.replace(", ","")),L+=V}else if(!x)L+=g(A[C]);else{var P=this.getSegmentDescription(A[C],y,g,_,b,a);P&&P.startsWith(", ")&&(P=P.substring(2)),L+=P}x?w=L:w=m.StringUtilities.format(a(d),L)}else if(x){var A=d.split("/");if(w=m.StringUtilities.format(_(A[1]),A[1]),A[0].indexOf("-")>-1){var F=this.generateRangeSegmentDescription(A[0],b,g);F.indexOf(", ")!=0&&(w+=", "),w+=F}else if(A[0].indexOf("*")==-1){var U=m.StringUtilities.format(a(A[0]),g(A[0]));U=U.replace(", ",""),w+=m.StringUtilities.format(this.i18n.commaStartingX0(),U)}}else E&&(w=this.generateRangeSegmentDescription(d,b,g));return w},c.prototype.generateRangeSegmentDescription=function(d,y,g){var _="",b=d.split("-"),a=g(b[0],1),w=g(b[1],2),x=y(d);return _+=m.StringUtilities.format(x,a,w),_},c.prototype.formatTime=function(d,y,g){var _=0,b=0,a=parseInt(d)+_,w=parseInt(y)+b;w>=60?(w-=60,a+=1):w<0&&(w+=60,a-=1),a>=24?a=a-24:a<0&&(a=24+a);var x="",E=!1;this.options.use24HourTimeFormat||(E=!!(this.i18n.setPeriodBeforeTime&&this.i18n.setPeriodBeforeTime()),x=E?"".concat(this.getPeriod(a)," "):" ".concat(this.getPeriod(a)),a>12&&(a-=12),a===0&&(a=12));var T="";return g&&(T=":".concat(("00"+g).substring(g.length))),"".concat(E?x:"").concat(("00"+a.toString()).substring(a.toString().length),":").concat(("00"+w.toString()).substring(w.toString().length)).concat(T).concat(E?"":x)},c.prototype.transformVerbosity=function(d,y){if(!y&&(d=d.replace(new RegExp(", ".concat(this.i18n.everyMinute()),"g"),""),d=d.replace(new RegExp(", ".concat(this.i18n.everyHour()),"g"),""),d=d.replace(new RegExp(this.i18n.commaEveryDay(),"g"),""),d=d.replace(/\, ?$/,""),this.i18n.conciseVerbosityReplacements))for(var g=0,_=Object.entries(this.i18n.conciseVerbosityReplacements());g<_.length;g++){var b=_[g],a=b[0],w=b[1];d=d.replace(new RegExp(a,"g"),w)}return d},c.prototype.getPeriod=function(d){return d>=12?this.i18n.pm&&this.i18n.pm()||"PM":this.i18n.am&&this.i18n.am()||"AM"},c.locales={},c})();h.ExpressionDescriptor=$},747(f,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.enLocaleLoader=void 0;var m=p(486),v=(function(){function $(){}return $.prototype.load=function(c){c.en=new m.en},$})();h.enLocaleLoader=v},486(f,h){Object.defineProperty(h,"__esModule",{value:!0}),h.en=void 0;var p=(function(){function m(){}return m.prototype.atX0SecondsPastTheMinuteGt20=function(){return null},m.prototype.atX0MinutesPastTheHourGt20=function(){return null},m.prototype.commaMonthX0ThroughMonthX1=function(){return null},m.prototype.commaYearX0ThroughYearX1=function(){return null},m.prototype.use24HourTimeFormatByDefault=function(){return!1},m.prototype.anErrorOccuredWhenGeneratingTheExpressionD=function(){return"An error occurred when generating the expression description. Check the cron expression syntax."},m.prototype.everyMinute=function(){return"every minute"},m.prototype.everyHour=function(){return"every hour"},m.prototype.atSpace=function(){return"At "},m.prototype.everyMinuteBetweenX0AndX1=function(){return"Every minute between %s and %s"},m.prototype.at=function(){return"At"},m.prototype.spaceAnd=function(){return" and"},m.prototype.everySecond=function(){return"every second"},m.prototype.everyX0Seconds=function(){return"every %s seconds"},m.prototype.secondsX0ThroughX1PastTheMinute=function(){return"seconds %s through %s past the minute"},m.prototype.atX0SecondsPastTheMinute=function(){return"at %s seconds past the minute"},m.prototype.everyX0Minutes=function(){return"every %s minutes"},m.prototype.minutesX0ThroughX1PastTheHour=function(){return"minutes %s through %s past the hour"},m.prototype.atX0MinutesPastTheHour=function(){return"at %s minutes past the hour"},m.prototype.everyX0Hours=function(){return"every %s hours"},m.prototype.betweenX0AndX1=function(){return"between %s and %s"},m.prototype.atX0=function(){return"at %s"},m.prototype.commaEveryDay=function(){return", every day"},m.prototype.commaEveryX0DaysOfTheWeek=function(){return", every %s days of the week"},m.prototype.commaX0ThroughX1=function(){return", %s through %s"},m.prototype.commaAndX0ThroughX1=function(){return", %s through %s"},m.prototype.first=function(){return"first"},m.prototype.second=function(){return"second"},m.prototype.third=function(){return"third"},m.prototype.fourth=function(){return"fourth"},m.prototype.fifth=function(){return"fifth"},m.prototype.commaOnThe=function(){return", on the "},m.prototype.spaceX0OfTheMonth=function(){return" %s of the month"},m.prototype.lastDay=function(){return"the last day"},m.prototype.commaOnTheLastX0OfTheMonth=function(){return", on the last %s of the month"},m.prototype.commaOnlyOnX0=function(){return", only on %s"},m.prototype.commaAndOnX0=function(){return", and on %s"},m.prototype.commaEveryX0Months=function(){return", every %s months"},m.prototype.commaOnlyInX0=function(){return", only in %s"},m.prototype.commaOnTheLastDayOfTheMonth=function(){return", on the last day of the month"},m.prototype.commaOnTheLastWeekdayOfTheMonth=function(){return", on the last weekday of the month"},m.prototype.commaDaysBeforeTheLastDayOfTheMonth=function(){return", %s days before the last day of the month"},m.prototype.firstWeekday=function(){return"first weekday"},m.prototype.weekdayNearestDayX0=function(){return"weekday nearest day %s"},m.prototype.commaOnTheX0OfTheMonth=function(){return", on the %s of the month"},m.prototype.commaEveryX0Days=function(){return", every %s days in a month"},m.prototype.commaBetweenDayX0AndX1OfTheMonth=function(){return", between day %s and %s of the month"},m.prototype.commaOnDayX0OfTheMonth=function(){return", on day %s of the month"},m.prototype.commaEveryHour=function(){return", every hour"},m.prototype.commaEveryX0Years=function(){return", every %s years"},m.prototype.commaStartingX0=function(){return", starting %s"},m.prototype.daysOfTheWeek=function(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},m.prototype.monthsOfTheYear=function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]},m.prototype.atReboot=function(){return"Run once, at startup"},m.prototype.onTheHour=function(){return"on the hour"},m})();h.en=p},515(f,h){Object.defineProperty(h,"__esModule",{value:!0});function p(v,$){if(!v)throw new Error($)}var m=(function(){function v(){}return v.secondRange=function($){for(var c=$.split(","),d=0;d<c.length;d++)if(!isNaN(parseInt(c[d],10))){var y=parseInt(c[d],10);p(y>=0&&y<=59,"seconds part must be >= 0 and <= 59")}},v.minuteRange=function($){for(var c=$.split(","),d=0;d<c.length;d++)if(!isNaN(parseInt(c[d],10))){var y=parseInt(c[d],10);p(y>=0&&y<=59,"minutes part must be >= 0 and <= 59")}},v.hourRange=function($){for(var c=$.split(","),d=0;d<c.length;d++)if(!isNaN(parseInt(c[d],10))){var y=parseInt(c[d],10);p(y>=0&&y<=23,"hours part must be >= 0 and <= 23")}},v.dayOfMonthRange=function($){for(var c=$.split(","),d=0;d<c.length;d++)if(!isNaN(parseInt(c[d],10))){var y=parseInt(c[d],10);p(y>=1&&y<=31,"DOM part must be >= 1 and <= 31")}},v.monthRange=function($,c){for(var d=$.split(","),y=0;y<d.length;y++)if(!isNaN(parseInt(d[y],10))){var g=parseInt(d[y],10);p(g>=1&&g<=12,c?"month part must be >= 0 and <= 11":"month part must be >= 1 and <= 12")}},v.dayOfWeekRange=function($,c){for(var d=$.split(","),y=0;y<d.length;y++)if(!isNaN(parseInt(d[y],10))){var g=parseInt(d[y],10);p(g>=0&&g<=6,c?"DOW part must be >= 0 and <= 6":"DOW part must be >= 1 and <= 7")}},v})();h.default=m},823(f,h){Object.defineProperty(h,"__esModule",{value:!0}),h.StringUtilities=void 0;var p=(function(){function m(){}return m.format=function(v){for(var $=[],c=1;c<arguments.length;c++)$[c-1]=arguments[c];return v.replace(/%s/g,function(d){return $.shift()})},m.containsAny=function(v,$){return $.some(function(c){return v.indexOf(c)>-1})},m})();h.StringUtilities=p}},o={};function i(f){var h=o[f];if(h!==void 0)return h.exports;var p=o[f]={exports:{}};return s[f](p,p.exports,i),p.exports}var u={};return(()=>{var f=u;Object.defineProperty(f,"__esModule",{value:!0}),f.toString=void 0;var h=i(333),p=i(747);h.ExpressionDescriptor.initialize(new p.enLocaleLoader),f.default=h.ExpressionDescriptor;var m=h.ExpressionDescriptor.toString;f.toString=m})(),u})())})(Fs)),Fs.exports}var Ry=Py();const on=Ga(Ry),By={class:"schedule-header"},Fy={class:"schedule-name"},Vy={class:"schedule-meta"},Uy=["title"],Wy={class:"schedule-timing"},Hy={key:0,class:"next-run"},zy={key:1,class:"last-run"},qy={class:"schedule-stats"},Ky={key:0,class:"failures"},Xy={class:"prompt-section"},Gy={class:"prompt-arrow"},Yy={key:0,class:"prompt-body"},Jy={class:"prompt-text"},Qy=["onKeydown"],Zy={class:"prompt-edit-controls"},e1=["disabled"],t1={class:"schedule-controls"},s1={key:0,class:"schedule-history"},n1={key:0,class:"history-empty"},o1={class:"history-time"},a1={class:"history-status"},i1={key:0,class:"history-error"},l1={__name:"ScheduleItem",props:{schedule:{type:Object,required:!0},legionId:{type:String,required:!0}},setup(n){const e=n,s=Wt(),o=M(!1),i=M([]),u=M(!1),f=M(!1),h=M(""),p=M(!1),m=M(null),v=k(()=>{try{return on.toString(e.schedule.cron_expression)}catch{return e.schedule.cron_expression}});function $(E){if(!E)return"";const T=Date.now()/1e3,A=E-T;if(Math.abs(A)<60)return"just now";const L=Math.abs(A),C=A>0?"in ":"",O=A<0?" ago":"";if(L<3600){const P=Math.round(L/60);return`${C}${P}m${O}`}if(L<86400){const P=Math.round(L/3600);return`${C}${P}h${O}`}const V=Math.round(L/86400);return`${C}${V}d${O}`}function c(E){return E?new Date(E*1e3).toLocaleString():""}async function d(){try{await s.pauseSchedule(e.legionId,e.schedule.schedule_id)}catch(E){console.error("Failed to pause schedule:",E)}}async function y(){try{await s.resumeSchedule(e.legionId,e.schedule.schedule_id)}catch(E){console.error("Failed to resume schedule:",E)}}async function g(){if(confirm(`Cancel schedule "${e.schedule.name}" permanently?`))try{await s.cancelSchedule(e.legionId,e.schedule.schedule_id)}catch(E){console.error("Failed to cancel schedule:",E)}}async function _(){if(confirm(`Delete schedule "${e.schedule.name}"?`))try{await s.deleteSchedule(e.legionId,e.schedule.schedule_id)}catch(E){console.error("Failed to delete schedule:",E)}}function b(){h.value=e.schedule.prompt,f.value=!0,rt(()=>{m.value&&m.value.focus()})}function a(){f.value=!1,h.value=""}async function w(){const E=h.value.trim();if(!E||E===e.schedule.prompt){a();return}p.value=!0;try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{prompt:E}),f.value=!1,h.value=""}catch(T){console.error("Failed to update prompt:",T)}finally{p.value=!1}}async function x(){o.value=!o.value,o.value&&i.value.length===0&&(i.value=await s.loadHistory(e.legionId,e.schedule.schedule_id))}return(E,T)=>(l(),r("div",{class:H(["schedule-item",n.schedule.status])},[t("div",By,[t("span",Fy,S(n.schedule.name),1),t("span",{class:H(["status-badge",n.schedule.status])},S(n.schedule.status),3)]),t("div",Vy,[t("span",{class:"cron-desc",title:n.schedule.cron_expression},S(v.value),9,Uy)]),t("div",Wy,[n.schedule.next_run?(l(),r("span",Hy," Next: "+S($(n.schedule.next_run)),1)):D("",!0),n.schedule.last_run?(l(),r("span",zy,[ce(" Last: "+S($(n.schedule.last_run))+" ",1),n.schedule.last_status?(l(),r("span",{key:0,class:H(["last-status",n.schedule.last_status])}," ("+S(n.schedule.last_status)+") ",3)):D("",!0)])):D("",!0)]),t("div",qy,[t("span",null,S(n.schedule.execution_count)+" runs",1),n.schedule.failure_count>0?(l(),r("span",Ky,S(n.schedule.failure_count)+" consecutive failures ",1)):D("",!0)]),t("div",Xy,[t("div",{class:"prompt-toggle",onClick:T[0]||(T[0]=pe(A=>u.value=!u.value,["stop"]))},[T[2]||(T[2]=t("span",{class:"prompt-label"},"Prompt",-1)),t("span",Gy,S(u.value?"â–¾":"â–¸"),1)]),u.value?(l(),r("div",Yy,[f.value?(l(),r(te,{key:1},[$e(t("textarea",{ref_key:"promptInput",ref:m,"onUpdate:modelValue":T[1]||(T[1]=A=>h.value=A),class:"prompt-editor",rows:"5",onKeydown:Zt(pe(a,["stop"]),["escape"])},null,40,Qy),[[Me,h.value]]),t("div",Zy,[t("button",{class:"ctrl-btn save",onClick:pe(w,["stop"]),disabled:p.value},S(p.value?"Saving...":"Save"),9,e1),t("button",{class:"ctrl-btn",onClick:pe(a,["stop"])},"Cancel")])],64)):(l(),r(te,{key:0},[t("pre",Jy,S(n.schedule.prompt),1),n.schedule.status!=="cancelled"?(l(),r("button",{key:0,class:"ctrl-btn edit-prompt",onClick:pe(b,["stop"])},"Edit")):D("",!0)],64))])):D("",!0)]),t("div",t1,[n.schedule.status==="active"?(l(),r("button",{key:0,class:"ctrl-btn pause",onClick:pe(d,["stop"]),title:"Pause"},"Pause")):D("",!0),n.schedule.status==="paused"?(l(),r("button",{key:1,class:"ctrl-btn resume",onClick:pe(y,["stop"]),title:"Resume"},"Resume")):D("",!0),n.schedule.status!=="cancelled"?(l(),r("button",{key:2,class:"ctrl-btn cancel",onClick:pe(g,["stop"]),title:"Cancel permanently"},"Cancel")):D("",!0),t("button",{class:"ctrl-btn delete",onClick:pe(_,["stop"]),title:"Delete"},"Delete")]),o.value?(l(),r("div",s1,[T[3]||(T[3]=t("div",{class:"history-header"},"Execution History",-1)),i.value.length===0?(l(),r("div",n1,"No executions yet")):D("",!0),(l(!0),r(te,null,le(i.value,A=>(l(),r("div",{key:A.execution_id,class:H(["history-item",A.status])},[t("span",o1,S(c(A.actual_time)),1),t("span",a1,S(A.status),1),A.error_message?(l(),r("span",i1,S(A.error_message),1)):D("",!0)],2))),128))])):D("",!0),t("button",{class:"toggle-history",onClick:pe(x,["stop"])},S(o.value?"Hide history":"Show history"),1)],2))}},r1=se(l1,[["__scopeId","data-v-98ac94da"]]),c1={class:"modal-content"},u1={class:"modal-header"},d1={class:"form-group"},f1=["value"],m1={class:"form-group"},p1={class:"form-group"},v1={class:"cron-presets"},h1={class:"form-group"},g1={key:0,class:"error-msg"},_1={class:"modal-actions"},b1=["disabled"],y1={__name:"ScheduleCreateModal",props:{legionId:{type:String,required:!0}},emits:["close","created"],setup(n,{emit:e}){const s=n,o=e,i=ve(),u=Wt(),f=M(!1),h=M(""),p=M({minion_id:"",name:"",cron_expression:"",prompt:""}),m=k(()=>i.sessionsInProject(s.legionId).value),v=k(()=>{if(!p.value.cron_expression)return"Enter a cron expression (min hour dom mon dow)";try{return on.toString(p.value.cron_expression)}catch{return"Invalid cron expression"}}),$=k(()=>{if(!p.value.cron_expression)return!1;try{return on.toString(p.value.cron_expression),!1}catch{return!0}});function c(y){p.value.cron_expression=y}async function d(){if(!(f.value||$.value)){h.value="",f.value=!0;try{const y=await u.createSchedule(s.legionId,{minion_id:p.value.minion_id,name:p.value.name,cron_expression:p.value.cron_expression,prompt:p.value.prompt});o("created",y)}catch(y){h.value=y.message||"Failed to create schedule"}finally{f.value=!1}}}return(y,g)=>(l(),r("div",{class:"modal-overlay",onClick:g[10]||(g[10]=pe(_=>y.$emit("close"),["self"]))},[t("div",c1,[t("div",u1,[g[11]||(g[11]=t("h3",null,"Create Schedule",-1)),t("button",{class:"close-btn",onClick:g[0]||(g[0]=_=>y.$emit("close"))},"Ã—")]),t("form",{onSubmit:pe(d,["prevent"])},[t("div",d1,[g[13]||(g[13]=t("label",null,"Agent",-1)),$e(t("select",{"onUpdate:modelValue":g[1]||(g[1]=_=>p.value.minion_id=_),required:""},[g[12]||(g[12]=t("option",{value:"",disabled:""},"Select an agent...",-1)),(l(!0),r(te,null,le(m.value,_=>(l(),r("option",{key:_.session_id,value:_.session_id},S(_.name||_.session_id.substring(0,8)),9,f1))),128))],512),[[ws,p.value.minion_id]])]),t("div",m1,[g[14]||(g[14]=t("label",null,"Schedule Name",-1)),$e(t("input",{"onUpdate:modelValue":g[2]||(g[2]=_=>p.value.name=_),type:"text",placeholder:"Daily status report",required:""},null,512),[[Me,p.value.name]])]),t("div",p1,[g[15]||(g[15]=t("label",null,"Cron Expression",-1)),$e(t("input",{"onUpdate:modelValue":g[3]||(g[3]=_=>p.value.cron_expression=_),type:"text",placeholder:"0 8 * * 1-5",required:""},null,512),[[Me,p.value.cron_expression]]),t("div",{class:H(["cron-preview",{error:$.value}])},S(v.value),3),t("div",v1,[t("button",{type:"button",onClick:g[4]||(g[4]=_=>c("0 * * * *"))},"Every hour"),t("button",{type:"button",onClick:g[5]||(g[5]=_=>c("0 8 * * 1-5"))},"Weekdays 8am"),t("button",{type:"button",onClick:g[6]||(g[6]=_=>c("0 9 * * *"))},"Daily 9am"),t("button",{type:"button",onClick:g[7]||(g[7]=_=>c("0 0 * * 0"))},"Weekly Sun")])]),t("div",h1,[g[16]||(g[16]=t("label",null,"Prompt",-1)),$e(t("textarea",{"onUpdate:modelValue":g[8]||(g[8]=_=>p.value.prompt=_),rows:"4",placeholder:"What should the agent do when this schedule fires?",required:""},null,512),[[Me,p.value.prompt]])]),h.value?(l(),r("div",g1,S(h.value),1)):D("",!0),t("div",_1,[t("button",{type:"button",class:"btn-secondary",onClick:g[9]||(g[9]=_=>y.$emit("close"))},"Cancel"),t("button",{type:"submit",class:"btn-primary",disabled:f.value||$.value},S(f.value?"Creating...":"Create Schedule"),9,b1)])],32)])]))}},w1=se(y1,[["__scopeId","data-v-2e62d999"]]),k1={class:"schedule-panel"},$1={class:"schedule-toolbar"},S1={key:0,class:"empty-placeholder"},x1={key:0},C1={key:1},E1={key:1,class:"schedule-list"},T1={__name:"SchedulePanel",setup(n){const e=ve(),s=Wt(),o=nt(),i=M(!1),u=M(""),f=k(()=>e.currentSession?.project_id||null),h=k(()=>{if(!f.value)return[];const p=s.getSchedules(f.value);return u.value?p.filter(m=>m.status===u.value):p});return de(f,p=>{p&&s.loadSchedules(p)},{immediate:!0}),de(()=>o.legionConnected,p=>{p&&f.value&&s.loadSchedules(f.value)}),(p,m)=>(l(),r("div",k1,[t("div",$1,[$e(t("select",{"onUpdate:modelValue":m[0]||(m[0]=v=>u.value=v),class:"filter-select"},[...m[4]||(m[4]=[t("option",{value:""},"All",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"paused"},"Paused",-1),t("option",{value:"cancelled"},"Cancelled",-1)])],512),[[ws,u.value]]),t("button",{class:"create-btn",onClick:m[1]||(m[1]=v=>i.value=!0),title:"Create Schedule"},"+ New")]),h.value.length===0?(l(),r("div",S1,[f.value?(l(),r("span",C1,"No schedules found. Create one to automate recurring tasks.")):(l(),r("span",x1,"Select a session to view schedules"))])):(l(),r("div",E1,[(l(!0),r(te,null,le(h.value,v=>(l(),Ce(r1,{key:v.schedule_id,schedule:v,"legion-id":f.value},null,8,["schedule","legion-id"]))),128))])),i.value?(l(),Ce(w1,{key:2,"legion-id":f.value,onClose:m[2]||(m[2]=v=>i.value=!1),onCreated:m[3]||(m[3]=v=>i.value=!1)},null,8,["legion-id"])):D("",!0)]))}},A1=se(T1,[["__scopeId","data-v-0afee8a8"]]),D1={class:"sidebar-tabs"},O1=["onClick"],M1={key:0,class:"tab-badge"},L1={class:"tab-content-container"},N1={__name:"RightSidebar",setup(n){const e=xe(),s=ts(),o=Qe(),i=vn(),u=Ut(),f=ve(),h=Wt(),p=k(()=>e.rightSidebarActiveTab),m=k(()=>s.currentTaskStats),v=k(()=>o.currentResourceCount),$=k(()=>i.fileCount),c=k(()=>{const E=f.currentSession?.project_id,T=f.currentSessionId;return!E||!T?0:(u.commsByLegion.get(E)||[]).filter(L=>L.from_minion_id===T||L.to_minion_id===T).length}),d=k(()=>{const E=f.currentSession?.project_id;return E?h.getSchedules(E).filter(A=>A.status==="active").length:0}),y=k(()=>[{id:"diff",label:"Diff",badge:$.value},{id:"tasks",label:"Tasks",badge:m.value.total>0?m.value.total:0},{id:"resources",label:"Resources",badge:v.value},{id:"comms",label:"Comms",badge:c.value},{id:"schedules",label:"Sched",badge:d.value}]),g=k(()=>e.windowWidth<768),_=k(()=>g.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),b=M(!1);function a(E){E.preventDefault(),b.value=!0,document.addEventListener("mousemove",w),document.addEventListener("mouseup",x)}function w(E){if(b.value){const T=window.innerWidth-E.clientX;e.setRightSidebarWidth(T)}}function x(){b.value=!1,document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",x)}return(E,T)=>(l(),r("aside",{id:"right-sidebar",class:H(["right-sidebar",{resizing:b.value,"theme-red-panel":ne(e).isRedBackground}]),style:Re(_.value)},[ye(e_),t("div",D1,[(l(!0),r(te,null,le(y.value,A=>(l(),r("button",{key:A.id,class:H(["sidebar-tab",{active:p.value===A.id}]),onClick:L=>ne(e).setRightSidebarTab(A.id)},[ce(S(A.label)+" ",1),A.badge>0?(l(),r("span",M1,S(A.badge),1)):D("",!0)],10,O1))),128))]),t("div",L1,[$e(ye(Yb,null,null,512),[[Je,p.value==="diff"]]),$e(ye(__,null,null,512),[[Je,p.value==="tasks"]]),$e(ye(I_,null,null,512),[[Je,p.value==="resources"]]),$e(ye(jy,null,null,512),[[Je,p.value==="comms"]]),$e(ye(A1,null,null,512),[[Je,p.value==="schedules"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:a},null,32),ye(mb),ye(ky)],6))}},I1=se(N1,[["__scopeId","data-v-d8a8d63a"]]),j1={class:"modal-dialog modal-lg"},P1={class:"modal-content"},R1={class:"modal-body"},B1={class:"mb-3"},F1={class:"input-group"},V1=["disabled"],U1={key:0,class:"text-center py-4"},W1={key:1,class:"alert alert-danger",role:"alert"},H1={key:2,class:"folder-list"},z1=["onClick","onDblclick"],q1={class:"d-flex align-items-center flex-grow-1"},K1=["onClick"],X1={key:1,class:"text-center text-muted py-3"},G1={class:"modal-footer"},Y1=["disabled"],J1={__name:"FolderBrowserModal",setup(n){const e=xe(),s=M(""),o=M(""),i=M([]),u=M(!1),f=M(""),h=M(null);let p=null,m=null;const v=k(()=>{if(!s.value)return null;const w=s.value.split(/[\\/]/).filter(Boolean);return w.length<=1?null:(w.pop(),w.length>0?"/"+w.join("/"):"/")});function $(w){if(!w)return"";const x=w.split(/[\\/]/).filter(Boolean);return x.length<=2?w:".../"+x.slice(-2).join("/")}async function c(){u.value=!0,f.value="",i.value=[],o.value="";try{const w=s.value?{path:s.value}:{},x=await be.get("/api/filesystem/browse",{params:w});x.current_path&&(s.value=x.current_path),i.value=x.directories||[]}catch(w){console.error("Failed to load directory:",w),f.value=w.message||"Failed to load directory"}finally{u.value=!1}}function d(w){o.value=w.path}function y(w){s.value=w.path,o.value="",c()}function g(){v.value&&(s.value=v.value,o.value="",c())}function _(){const w=o.value||s.value;w&&m&&m(w),p&&p.hide()}function b(){c()}function a(){i.value=[],o.value="",f.value="",m=null,e.hideModal()}return de(()=>e.currentModal,w=>{if(w?.name==="folder-browser"&&p){const x=w.data||{};s.value=x.defaultPath||x.currentPath||"",m=x.onSelect||null,p.show()}}),Oe(()=>{h.value&&Le(async()=>{const{default:w}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:w}},__vite__mapDeps([0,1])).then(({default:w})=>{p=new w(h.value),h.value.addEventListener("shown.bs.modal",b),h.value.addEventListener("hidden.bs.modal",a)})}),De(()=>{h.value&&(h.value.removeEventListener("shown.bs.modal",b),h.value.removeEventListener("hidden.bs.modal",a)),p&&p.dispose()}),(w,x)=>(l(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[t("div",j1,[t("div",P1,[x[6]||(x[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",R1,[t("div",B1,[x[1]||(x[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",F1,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=E=>s.value=E),onKeyup:Zt(c,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Me,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:c,disabled:u.value}," ðŸ”„ Refresh ",8,V1)])]),u.value?(l(),r("div",U1,[...x[2]||(x[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):f.value?(l(),r("div",W1,S(f.value),1)):(l(),r("div",H1,[v.value?(l(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:g,role:"button"},[...x[3]||(x[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):D("",!0),(l(!0),r(te,null,le(i.value,E=>(l(),r("div",{key:E.path,class:H(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:E.path===o.value}]),onClick:T=>d(E),onDblclick:T=>y(E),role:"button"},[t("div",q1,[x[4]||(x[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,S(E.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:pe(T=>y(E),["stop"])}," Open ",8,K1)],42,z1))),128)),i.value.length===0?(l(),r("div",X1," No subdirectories found ")):D("",!0)]))]),t("div",G1,[x[5]||(x[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:!o.value},' Select "'+S($(o.value||s.value))+'" ',9,Y1)])])])],512))}},Q1=se(J1,[["__scopeId","data-v-0d61ed46"]]),Z1={class:"modal-dialog"},ew={class:"modal-content"},tw={class:"modal-body"},sw={class:"mb-3"},nw={key:0,class:"invalid-feedback"},ow={class:"mb-3"},aw={class:"input-group"},iw={key:0,class:"invalid-feedback"},lw={class:"mb-3 form-check"},rw={key:0,class:"mb-3 ms-4"},cw={key:1,class:"alert alert-danger",role:"alert"},uw={class:"modal-footer"},dw=["disabled"],fw={key:0,class:"spinner-border spinner-border-sm me-2"},mw={__name:"ProjectCreateModal",setup(n){const e=ze(),s=ve(),o=xe(),i=M({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),u=M({name:"",workingDirectory:""}),f=M(!1),h=M(""),p=M(null);let m=null;function v(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:_=>{i.value.workingDirectory=_,u.value.workingDirectory=""}})}function $(){u.value={};let _=!0;return i.value.name.trim()||(u.value.name="Project name is required",_=!1),i.value.workingDirectory.trim()||(u.value.workingDirectory="Working directory is required",_=!1),_}async function c(){if($()){f.value=!0,h.value="";try{const _=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await s.createSession(_.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),m&&m.hide(),d()}catch(_){console.error("Failed to create project:",_),h.value=_.message||"Failed to create project. Please try again."}finally{f.value=!1}}}function d(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},u.value={},h.value=""}function y(){const _=document.getElementById("projectName");_&&_.focus()}function g(){d(),o.hideModal()}return de(()=>o.currentModal,_=>{_?.name==="create-project"&&m&&m.show()}),Oe(()=>{p.value&&Le(async()=>{const{default:_}=await import("./modal-D6mKceGM.js").then(b=>b.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{m=new _(p.value),p.value.addEventListener("shown.bs.modal",y),p.value.addEventListener("hidden.bs.modal",g)})}),De(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",y),p.value.removeEventListener("hidden.bs.modal",g)),m&&m.dispose()}),(_,b)=>(l(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",Z1,[t("div",ew,[b[11]||(b[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",tw,[t("form",{onSubmit:pe(c,["prevent"])},[t("div",sw,[b[4]||(b[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":u.value.name}]),id:"projectName","onUpdate:modelValue":b[0]||(b[0]=a=>i.value.name=a),placeholder:"My Project",required:""},null,2),[[Me,i.value.name]]),u.value.name?(l(),r("div",nw,S(u.value.name),1)):D("",!0)]),t("div",ow,[b[5]||(b[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",aw,[$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":u.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":b[1]||(b[1]=a=>i.value.workingDirectory=a),placeholder:"/path/to/project",required:""},null,2),[[Me,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:v}," Browse... "),u.value.workingDirectory?(l(),r("div",iw,S(u.value.workingDirectory),1)):D("",!0)]),b[6]||(b[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",lw,[$e(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":b[2]||(b[2]=a=>i.value.createSession=a)},null,512),[[Do,i.value.createSession]]),b[7]||(b[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),b[8]||(b[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(l(),r("div",rw,[b[9]||(b[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),$e(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":b[3]||(b[3]=a=>i.value.sessionName=a),placeholder:"main"},null,512),[[Me,i.value.sessionName]])])):D("",!0),h.value?(l(),r("div",cw,S(h.value),1)):D("",!0)],32)]),t("div",uw,[b[10]||(b[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:c,disabled:f.value},[f.value?(l(),r("span",fw)):D("",!0),ce(" "+S(f.value?"Creating...":"Create Project"),1)],8,dw)])])])],512))}},pw=se(mw,[["__scopeId","data-v-ea55fdae"]]),vw={class:"modal-dialog"},hw={class:"modal-content"},gw={class:"modal-body"},_w={class:"mb-3"},bw={key:0,class:"invalid-feedback"},yw={class:"mb-3"},ww=["value"],kw={key:0,class:"alert alert-danger",role:"alert"},$w={class:"danger-zone"},Sw={class:"text-muted small"},xw=["disabled"],Cw={key:0,class:"alert alert-warning mt-3",role:"alert"},Ew={class:"mb-2"},Tw={class:"d-flex gap-2"},Aw=["disabled"],Dw={key:0,class:"spinner-border spinner-border-sm me-2"},Ow=["disabled"],Mw={class:"modal-footer"},Lw=["disabled"],Nw={key:0,class:"spinner-border spinner-border-sm me-2"},Iw={__name:"ProjectEditModal",setup(n){const e=ze(),s=xe(),o=M(null),i=M({name:""}),u=M({name:""}),f=M(!1),h=M(!1),p=M(""),m=M(!1),v=M(null);let $=null;const c=k(()=>o.value?.session_ids?.length||0);function d(){u.value={};let w=!0;return i.value.name.trim()||(u.value.name="Project name is required",w=!1),w}async function y(){if(!(!d()||!o.value)){f.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(w){console.error("Failed to update project:",w),p.value=w.message||"Failed to update project. Please try again."}finally{f.value=!1}}}async function g(){if(o.value){h.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(w){console.error("Failed to delete project:",w),p.value=w.message||"Failed to delete project. Please try again."}finally{h.value=!1}}}function _(){i.value={name:""},u.value={},p.value="",m.value=!1}function b(){const w=document.getElementById("editProjectName");w&&(w.focus(),w.select())}function a(){_(),o.value=null,s.hideModal()}return de(()=>s.currentModal,w=>{if(w?.name==="edit-project"&&$){const x=w.data||{};o.value=x.project,o.value&&(i.value.name=o.value.name),$.show()}}),Oe(()=>{v.value&&Le(async()=>{const{default:w}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:w}},__vite__mapDeps([0,1])).then(({default:w})=>{$=new w(v.value),v.value.addEventListener("shown.bs.modal",b),v.value.addEventListener("hidden.bs.modal",a)})}),De(()=>{v.value&&(v.value.removeEventListener("shown.bs.modal",b),v.value.removeEventListener("hidden.bs.modal",a)),$&&$.dispose()}),(w,x)=>(l(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:v},[t("div",vw,[t("div",hw,[x[10]||(x[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",gw,[t("form",{onSubmit:pe(y,["prevent"])},[t("div",_w,[x[3]||(x[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":u.value.name}]),id:"editProjectName","onUpdate:modelValue":x[0]||(x[0]=E=>i.value.name=E),placeholder:"My Project",required:""},null,2),[[Me,i.value.name]]),u.value.name?(l(),r("div",bw,S(u.value.name),1)):D("",!0)]),t("div",yw,[x[4]||(x[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,ww),x[5]||(x[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(l(),r("div",kw,S(p.value),1)):D("",!0)],32),x[8]||(x[8]=t("hr",null,null,-1)),t("div",$w,[x[6]||(x[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",Sw," Deleting this project will also delete all "+S(c.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x[1]||(x[1]=E=>m.value=!0),disabled:h.value}," ðŸ—‘ï¸ Delete Project ",8,xw)]),m.value?(l(),r("div",Cw,[x[7]||(x[7]=t("strong",null,"Are you sure?",-1)),t("p",Ew,' This will permanently delete the project "'+S(o.value?.name)+'" and all '+S(c.value)+" session(s). ",1),t("div",Tw,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:g,disabled:h.value},[h.value?(l(),r("span",Dw)):D("",!0),ce(" "+S(h.value?"Deleting...":"Yes, Delete Permanently"),1)],8,Aw),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:x[2]||(x[2]=E=>m.value=!1),disabled:h.value}," Cancel ",8,Ow)])])):D("",!0)]),t("div",Mw,[x[9]||(x[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:f.value},[f.value?(l(),r("span",Nw)):D("",!0),ce(" "+S(f.value?"Saving...":"Save Changes"),1)],8,Lw)])])])],512))}},jw=se(Iw,[["__scopeId","data-v-52679516"]]),Pw={class:"general-tab"},Rw={key:0,class:"mb-3"},Bw={for:"template-select",class:"form-label"},Fw=["value"],Vw=["value"],Uw={key:0,class:"form-text"},Ww={class:"mb-3"},Hw={for:"config-name",class:"form-label"},zw=["value","placeholder","pattern","title"],qw={key:0,class:"invalid-feedback"},Kw={key:1,class:"form-text"},Xw={key:1,class:"mb-3"},Gw=["value"],Yw={class:"mb-3"},Jw=["value"],Qw={class:"form-text"},Zw={key:0},ek={class:"mb-3"},tk={for:"config-permission-mode",class:"form-label"},sk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},nk={key:1,class:"field-indicator modified",title:"Modified from template"},ok=["value","disabled"],ak={key:0,value:"bypassPermissions"},ik={class:"form-text"},lk={key:0,class:"text-warning"},rk={key:1},ck={class:"mb-3"},uk={for:"config-role",class:"form-label"},dk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},fk={key:1,class:"field-indicator modified",title:"Modified from template"},mk=["value","placeholder"],pk={class:"form-text"},vk={key:2,class:"mb-3"},hk={class:"input-group"},gk=["value","placeholder","disabled","readonly"],_k={class:"form-text"},bk={key:3,class:"mb-3"},yk={class:"form-control-plaintext"},wk={key:4,class:"mb-3 form-check"},kk=["checked"],$k={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=k(()=>e.mode==="create-session"||e.mode==="edit-session"),o=k(()=>e.mode==="create-template"||e.mode==="edit-template"),i=k(()=>e.mode==="create-session"),u=k(()=>e.mode==="edit-session"),f=k(()=>e.session?.state==="active"||e.session?.state==="starting"),h=k(()=>e.session?.initial_permission_mode==="bypassPermissions"),p=k(()=>e.selectedTemplateId?e.templates.find(y=>y.template_id===e.selectedTemplateId):null),m={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},v=k(()=>m[e.formData.model]||null),$=k(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),c=k(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function d(y){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[y]||"bg-secondary"}return(y,g)=>(l(),r("div",Pw,[i.value?(l(),r("div",Rw,[t("label",Bw,[g[10]||(g[10]=ce(" Template ",-1)),t("button",{type:"button",onClick:g[0]||(g[0]=_=>y.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:g[1]||(g[1]=_=>y.$emit("update:selected-template-id",_.target.value||null)),class:"form-select"},[g[11]||(g[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(l(!0),r(te,null,le(n.templates,_=>(l(),r("option",{key:_.template_id,value:_.template_id},S(_.name),9,Vw))),128))],40,Fw),p.value?(l(),r("div",Uw,S(p.value.description),1)):D("",!0)])):D("",!0),t("div",Ww,[t("label",Hw,[ce(S(o.value?"Template Name":"Session Name")+" ",1),g[12]||(g[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:H(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:g[2]||(g[2]=_=>y.$emit("update:form-data","name",_.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,zw),n.errors.name?(l(),r("div",qw,S(n.errors.name),1)):D("",!0),s.value?(l(),r("div",Kw,"Must be a single word (no spaces) for #nametag matching")):D("",!0)]),o.value?(l(),r("div",Xw,[g[13]||(g[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:g[3]||(g[3]=_=>y.$emit("update:form-data","description",_.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,Gw)])):D("",!0),t("div",Yw,[g[15]||(g[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:g[4]||(g[4]=_=>y.$emit("update:form-data","model",_.target.value))},[...g[14]||(g[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,Jw),t("div",Qw,[v.value?(l(),r("span",Zw,S(v.value.description),1)):D("",!0)])]),t("div",ek,[t("label",tk,[g[16]||(g[16]=ce(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(l(),r("span",sk," < ")):D("",!0),n.fieldStates.permission_mode==="modified"?(l(),r("span",nk," * ")):D("",!0)]),t("select",{id:"config-permission-mode",class:H(["form-select",c.value]),value:n.formData.permission_mode,onChange:g[5]||(g[5]=_=>y.$emit("update:form-data","permission_mode",_.target.value)),disabled:u.value&&!f.value},[g[17]||(g[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),g[18]||(g[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),g[19]||(g[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!u.value||h.value?(l(),r("option",ak," Bypass Permissions (No prompts - use with caution) ")):D("",!0)],42,ok),t("div",ik,[u.value&&!f.value?(l(),r("span",lk," Session must be active to change permission mode. Start the session first. ")):(l(),r("span",rk,"Controls which tool actions require permission prompts"))])]),t("div",ck,[t("label",uk,[ce(S(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(l(),r("span",dk," < ")):D("",!0),n.fieldStates.default_role==="modified"?(l(),r("span",fk," * ")):D("",!0)]),t("input",{id:"config-role",type:"text",class:H(["form-control",$.value]),value:n.formData.default_role,onInput:g[6]||(g[6]=_=>y.$emit("update:form-data","default_role",_.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,mk),t("div",pk,S(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(l(),r("div",vk,[g[20]||(g[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",hk,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:g[7]||(g[7]=_=>y.$emit("update:form-data","working_directory",_.target.value)),placeholder:u.value?"":"Leave empty to inherit from project",disabled:u.value,readonly:u.value},null,40,gk),u.value?D("",!0):(l(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:g[8]||(g[8]=_=>y.$emit("open-folder-browser"))}," Browse "))]),t("div",_k,S(u.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):D("",!0),u.value&&n.session?(l(),r("div",bk,[g[21]||(g[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",yk,[t("span",{class:H(["badge",d(n.session.state)])},S(n.session.state),3)])])):D("",!0),i.value?(l(),r("div",wk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:g[9]||(g[9]=_=>y.$emit("update:form-data","startImmediately",_.target.checked))},null,40,kk),g[22]||(g[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):D("",!0)]))}},Sk=se($k,[["__scopeId","data-v-9f0e3252"]]),xk={class:"permissions-tab"},Ck={class:"mb-3"},Ek={for:"config-allowed-tools",class:"form-label"},Tk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Ak={key:1,class:"field-indicator modified",title:"Modified from template"},Dk={key:0,class:"tools-list mb-2"},Ok=["onClick"],Mk={class:"input-group input-group-sm"},Lk=["onKeydown"],Nk=["disabled"],Ik={class:"mt-2"},jk=["onClick"],Pk={class:"form-text"},Rk={class:"mb-3"},Bk={for:"config-disallowed-tools",class:"form-label"},Fk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Vk={key:1,class:"field-indicator modified",title:"Modified from template"},Uk={key:0,class:"tools-list mb-2"},Wk=["onClick"],Hk={class:"input-group input-group-sm"},zk=["onKeydown"],qk=["disabled"],Kk={class:"mt-2"},Xk=["onClick"],Gk={class:"form-text"},Yk={key:0,class:"mb-3"},Jk={class:"settings-sources-editor"},Qk={class:"form-check"},Zk=["checked"],e$={class:"form-check"},t$=["checked"],s$={class:"form-check"},n$=["checked"],o$={key:1,class:"mb-3"},a$={class:"mb-3"},i$={key:0,class:"mt-2"},l$=["value"],r$=["value"],c$={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,i=M(""),u=M(""),f=M(!1),h=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=k(()=>s.mode==="create-template"||s.mode==="edit-template"),m=k(()=>s.mode==="create-session"||s.mode==="edit-session"),v=k(()=>s.formData.setting_sources||["user","project","local"]),$=k(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(L=>L.trim()).filter(L=>L.length>0)),c=k(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(L=>L.trim()).filter(L=>L.length>0)),d=k(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),y=k(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),g=k(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),_=k(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function b(){const L=i.value.trim();if(L){if(!$.value.includes(L)){const C=[...$.value,L];o("update:form-data","allowed_tools",C.join(", "))}i.value=""}}function a(L){const C=[...$.value];C.splice(L,1),o("update:form-data","allowed_tools",C.join(", "))}function w(L){if($.value.includes(L)){const C=$.value.indexOf(L);a(C)}else{const C=[...$.value,L];o("update:form-data","allowed_tools",C.join(", "))}}function x(){const L=u.value.trim();if(L){if(!c.value.includes(L)){const C=[...c.value,L];o("update:form-data","disallowed_tools",C.join(", "))}u.value=""}}function E(L){const C=[...c.value];C.splice(L,1),o("update:form-data","disallowed_tools",C.join(", "))}function T(L){if(c.value.includes(L)){const C=c.value.indexOf(L);E(C)}else{const C=[...c.value,L];o("update:form-data","disallowed_tools",C.join(", "))}}function A(L){const C=[...v.value],O=C.indexOf(L);O>=0?C.splice(O,1):C.push(L),o("update:form-data","setting_sources",C)}return(L,C)=>(l(),r("div",xk,[t("div",Ck,[t("label",Ek,[C[9]||(C[9]=ce(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(l(),r("span",Tk," < ")):D("",!0),n.fieldStates.allowed_tools==="modified"?(l(),r("span",Ak," * ")):D("",!0)]),t("div",{class:H(["allowed-tools-editor",y.value])},[$.value.length>0?(l(),r("div",Dk,[(l(!0),r(te,null,le($.value,(O,V)=>(l(),r("span",{key:V,class:"badge bg-primary me-1 mb-1 tool-badge"},[ce(S(O)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:P=>a(V),"aria-label":"Remove tool"},null,8,Ok)]))),128))])):D("",!0),t("div",Mk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=O=>i.value=O),onKeydown:Zt(pe(b,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,Lk),[[Me,i.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:b,disabled:!i.value.trim()}," Add ",8,Nk)]),t("div",Ik,[C[10]||(C[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(l(),r(te,null,le(h,O=>t("button",{key:O,type:"button",class:H(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":$.value.includes(O)}]),onClick:V=>w(O)},S(O),11,jk)),64))])],2),t("div",Pk,S(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",Rk,[t("label",Bk,[C[11]||(C[11]=ce(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(l(),r("span",Fk," < ")):D("",!0),n.fieldStates.disallowed_tools==="modified"?(l(),r("span",Vk," * ")):D("",!0)]),t("div",{class:H(["disallowed-tools-editor",_.value])},[c.value.length>0?(l(),r("div",Uk,[(l(!0),r(te,null,le(c.value,(O,V)=>(l(),r("span",{key:V,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[ce(S(O)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:P=>E(V),"aria-label":"Remove denied tool"},null,8,Wk)]))),128))])):D("",!0),t("div",Hk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[1]||(C[1]=O=>u.value=O),onKeydown:Zt(pe(x,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,zk),[[Me,u.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x,disabled:!u.value.trim()}," Deny ",8,qk)]),t("div",Kk,[C[12]||(C[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(l(),r(te,null,le(h,O=>t("button",{key:O,type:"button",class:H(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":c.value.includes(O)}]),onClick:V=>T(O)},S(O),11,Xk)),64))])],2),t("div",Gk,S(p.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),m.value?(l(),r("div",Yk,[C[16]||(C[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",Jk,[t("div",Qk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:v.value.includes("user"),onChange:C[2]||(C[2]=O=>A("user"))},null,40,Zk),C[13]||(C[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[ce(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",e$,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:v.value.includes("project"),onChange:C[3]||(C[3]=O=>A("project"))},null,40,t$),C[14]||(C[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[ce(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",s$,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:v.value.includes("local"),onChange:C[4]||(C[4]=O=>A("local"))},null,40,n$),C[15]||(C[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[ce(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),C[17]||(C[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):D("",!0),m.value?(l(),r("div",o$,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C[5]||(C[5]=O=>L.$emit("preview-permissions"))}," Preview Effective Permissions ")])):D("",!0),t("div",a$,[t("a",{class:"text-muted small",role:"button",onClick:C[6]||(C[6]=O=>f.value=!f.value)},S(f.value?"Hide":"Show")+" raw input ",1),f.value?(l(),r("div",i$,[C[18]||(C[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:H(["form-control form-control-sm",d.value]),value:n.formData.allowed_tools,onInput:C[7]||(C[7]=O=>L.$emit("update:form-data","allowed_tools",O.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,l$),C[19]||(C[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:H(["form-control form-control-sm",g.value]),value:n.formData.disallowed_tools,onInput:C[8]||(C[8]=O=>L.$emit("update:form-data","disallowed_tools",O.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,r$)])):D("",!0)])]))}},u$=se(c$,[["__scopeId","data-v-cbec74ed"]]),d$={class:"advanced-tab"},f$={class:"mb-3"},m$={for:"config-system-prompt",class:"form-label"},p$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},v$={key:1,class:"field-indicator modified",title:"Modified from template"},h$=["value","rows","placeholder"],g$={class:"form-text"},_$={class:"mb-3 form-check"},b$=["checked"],y$={key:0,class:"form-text text-warning"},w$={class:"mb-3"},k$={class:"capabilities-editor"},$$={key:0,class:"capabilities-list mb-2"},S$=["onClick"],x$={class:"input-group input-group-sm"},C$=["onKeydown"],E$=["disabled"],T$={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,i=k(()=>s.mode==="create-template"||s.mode==="edit-template"),u=k(()=>s.formData.initialization_context),f=k(()=>i.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),h=k(()=>s.formData.override_system_prompt?i.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":i.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),p=k(()=>{const y={};return s.fieldStates.initialization_context==="autofilled"&&(y["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(y["field-modified"]=!0),y}),m=M(""),v=k(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(y=>y.trim()).filter(y=>y.length>0));function $(y){const g=y.target.value;o("update:form-data","initialization_context",g)}function c(){const y=m.value.trim().toLowerCase();if(y){if(!v.value.includes(y)){const g=[...v.value,y];o("update:form-data","capabilities",g.join(", "))}m.value=""}}function d(y){const g=[...v.value];g.splice(y,1),o("update:form-data","capabilities",g.join(", "))}return(y,g)=>(l(),r("div",d$,[t("div",f$,[t("label",m$,[ce(S(i.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(l(),r("span",p$," < ")):D("",!0),n.fieldStates.initialization_context==="modified"?(l(),r("span",v$," * ")):D("",!0)]),t("textarea",{id:"config-system-prompt",class:H(["form-control",p.value]),value:u.value,onInput:$,rows:i.value?4:5,placeholder:f.value},null,42,h$),t("div",g$,S(h.value),1)]),t("div",_$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:g[0]||(g[0]=_=>y.$emit("update:form-data","override_system_prompt",_.target.checked))},null,40,b$),g[2]||(g[2]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(l(),r("div",y$,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+S(i.value?"":" or legion guide")+").",1)])):D("",!0)]),t("div",w$,[g[3]||(g[3]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",k$,[v.value.length>0?(l(),r("div",$$,[(l(!0),r(te,null,le(v.value,(_,b)=>(l(),r("span",{key:b,class:"badge bg-info me-1 mb-1 capability-badge"},[ce(S(_)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:a=>d(b),"aria-label":"Remove capability"},null,8,S$)]))),128))])):D("",!0),t("div",x$,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":g[1]||(g[1]=_=>m.value=_),onKeydown:Zt(pe(c,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,C$),[[Me,m.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:c,disabled:!m.value.trim()}," Add ",8,E$)])]),g[4]||(g[4]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},A$=se(T$,[["__scopeId","data-v-9ffdae4f"]]),D$={class:"sandbox-tab"},O$={class:"mb-3 form-check"},M$=["checked"],L$={class:"mb-2 form-check"},N$=["checked","disabled"],I$={class:"mb-2 form-check"},j$=["checked","disabled"],P$={class:"mb-2"},R$=["value","disabled"],B$={class:"mb-3 form-check"},F$=["checked","disabled"],V$={class:"mb-2"},U$=["value","disabled"],W$={class:"mb-2 form-check"},H$=["checked","disabled"],z$={class:"mb-2"},q$=["value","disabled"],K$={class:"mb-3 form-check"},X$=["checked","disabled"],G$={class:"mb-2"},Y$=["value","disabled"],J$={class:"mb-2"},Q$=["value","disabled"],Z$={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(f,h){s.formData.sandbox[f]=h}function i(f,h){s.formData.sandbox.network[f]=h}function u(f,h){s.formData.sandbox.ignoreViolations[f]=h}return(f,h)=>(l(),r("div",D$,[t("div",O$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:h[0]||(h[0]=p=>f.$emit("update:form-data","sandbox_enabled",p.target.checked))},null,40,M$),h[11]||(h[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:H(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,S(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",L$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:h[1]||(h[1]=p=>o("autoAllowBashIfSandboxed",p.target.checked))},null,40,N$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",I$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:h[2]||(h[2]=p=>o("allowUnsandboxedCommands",p.target.checked))},null,40,j$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",P$,[t("label",{for:"config-sandbox-excluded-cmds",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:h[3]||(h[3]=p=>o("excludedCommands",p.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,R$)]),t("div",B$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:h[4]||(h[4]=p=>o("enableWeakerNestedSandbox",p.target.checked))},null,40,F$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",V$,[t("label",{for:"config-sandbox-allowed-domains",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:h[5]||(h[5]=p=>i("allowedDomains",p.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,U$)]),t("div",W$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:h[6]||(h[6]=p=>i("allowLocalBinding",p.target.checked))},null,40,H$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",z$,[t("label",{for:"config-sandbox-unix-sockets",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:h[7]||(h[7]=p=>i("allowUnixSockets",p.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,q$)]),t("div",K$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:h[8]||(h[8]=p=>i("allowAllUnixSockets",p.target.checked))},null,40,X$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",G$,[t("label",{for:"config-sandbox-ignore-file",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:h[9]||(h[9]=p=>u("file",p.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,Y$)]),t("div",J$,[t("label",{for:"config-sandbox-ignore-network",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:h[10]||(h[10]=p=>u("network",p.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,Q$)])]))}},e0=se(Z$,[["__scopeId","data-v-be109d12"]]);var Ne="top",Be="bottom",Fe="right",Ie="left",Cs="auto",Ht=[Ne,Be,Fe,Ie],kt="start",It="end",Po="clippingParents",hn="viewport",Dt="popper",Ro="reference",an=Ht.reduce(function(n,e){return n.concat([e+"-"+kt,e+"-"+It])},[]),gn=[].concat(Ht,[Cs]).reduce(function(n,e){return n.concat([e,e+"-"+kt,e+"-"+It])},[]),Bo="beforeRead",Fo="read",Vo="afterRead",Uo="beforeMain",Wo="main",Ho="afterMain",zo="beforeWrite",qo="write",Ko="afterWrite",Xo=[Bo,Fo,Vo,Uo,Wo,Ho,zo,qo,Ko];function tt(n){return n?(n.nodeName||"").toLowerCase():null}function Ve(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function $t(n){var e=Ve(n).Element;return n instanceof e||n instanceof Element}function Ue(n){var e=Ve(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function _n(n){if(typeof ShadowRoot>"u")return!1;var e=Ve(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function t0(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},u=e.elements[s];!Ue(u)||!tt(u)||(Object.assign(u.style,o),Object.keys(i).forEach(function(f){var h=i[f];h===!1?u.removeAttribute(f):u.setAttribute(f,h===!0?"":h)}))})}function s0(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],u=e.attributes[o]||{},f=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),h=f.reduce(function(p,m){return p[m]="",p},{});!Ue(i)||!tt(i)||(Object.assign(i.style,h),Object.keys(u).forEach(function(p){i.removeAttribute(p)}))})}}const Go={name:"applyStyles",enabled:!0,phase:"write",fn:t0,effect:s0,requires:["computeStyles"]};function Ze(n){return n.split("-")[0]}var wt=Math.max,ks=Math.min,jt=Math.round;function ln(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Yo(){return!/^((?!chrome|android).)*safari/i.test(ln())}function Pt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,u=1;e&&Ue(n)&&(i=n.offsetWidth>0&&jt(o.width)/n.offsetWidth||1,u=n.offsetHeight>0&&jt(o.height)/n.offsetHeight||1);var f=$t(n)?Ve(n):window,h=f.visualViewport,p=!Yo()&&s,m=(o.left+(p&&h?h.offsetLeft:0))/i,v=(o.top+(p&&h?h.offsetTop:0))/u,$=o.width/i,c=o.height/u;return{width:$,height:c,top:v,right:m+$,bottom:v+c,left:m,x:m,y:v}}function bn(n){var e=Pt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Jo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&_n(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function ct(n){return Ve(n).getComputedStyle(n)}function n0(n){return["table","td","th"].indexOf(tt(n))>=0}function vt(n){return(($t(n)?n.ownerDocument:n.document)||window.document).documentElement}function Es(n){return tt(n)==="html"?n:n.assignedSlot||n.parentNode||(_n(n)?n.host:null)||vt(n)}function qn(n){return!Ue(n)||ct(n).position==="fixed"?null:n.offsetParent}function o0(n){var e=/firefox/i.test(ln()),s=/Trident/i.test(ln());if(s&&Ue(n)){var o=ct(n);if(o.position==="fixed")return null}var i=Es(n);for(_n(i)&&(i=i.host);Ue(i)&&["html","body"].indexOf(tt(i))<0;){var u=ct(i);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||e&&u.willChange==="filter"||e&&u.filter&&u.filter!=="none")return i;i=i.parentNode}return null}function as(n){for(var e=Ve(n),s=qn(n);s&&n0(s)&&ct(s).position==="static";)s=qn(s);return s&&(tt(s)==="html"||tt(s)==="body"&&ct(s).position==="static")?e:s||o0(n)||e}function yn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Jt(n,e,s){return wt(n,ks(e,s))}function a0(n,e,s){var o=Jt(n,e,s);return o>s?s:o}function Qo(){return{top:0,right:0,bottom:0,left:0}}function Zo(n){return Object.assign({},Qo(),n)}function ea(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var i0=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Zo(typeof e!="number"?e:ea(e,Ht))};function l0(n){var e,s=n.state,o=n.name,i=n.options,u=s.elements.arrow,f=s.modifiersData.popperOffsets,h=Ze(s.placement),p=yn(h),m=[Ie,Fe].indexOf(h)>=0,v=m?"height":"width";if(!(!u||!f)){var $=i0(i.padding,s),c=bn(u),d=p==="y"?Ne:Ie,y=p==="y"?Be:Fe,g=s.rects.reference[v]+s.rects.reference[p]-f[p]-s.rects.popper[v],_=f[p]-s.rects.reference[p],b=as(u),a=b?p==="y"?b.clientHeight||0:b.clientWidth||0:0,w=g/2-_/2,x=$[d],E=a-c[v]-$[y],T=a/2-c[v]/2+w,A=Jt(x,T,E),L=p;s.modifiersData[o]=(e={},e[L]=A,e.centerOffset=A-T,e)}}function r0(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Jo(e.elements.popper,i)&&(e.elements.arrow=i))}const ta={name:"arrow",enabled:!0,phase:"main",fn:l0,effect:r0,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Rt(n){return n.split("-")[1]}var c0={top:"auto",right:"auto",bottom:"auto",left:"auto"};function u0(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:jt(s*i)/i||0,y:jt(o*i)/i||0}}function Kn(n){var e,s=n.popper,o=n.popperRect,i=n.placement,u=n.variation,f=n.offsets,h=n.position,p=n.gpuAcceleration,m=n.adaptive,v=n.roundOffsets,$=n.isFixed,c=f.x,d=c===void 0?0:c,y=f.y,g=y===void 0?0:y,_=typeof v=="function"?v({x:d,y:g}):{x:d,y:g};d=_.x,g=_.y;var b=f.hasOwnProperty("x"),a=f.hasOwnProperty("y"),w=Ie,x=Ne,E=window;if(m){var T=as(s),A="clientHeight",L="clientWidth";if(T===Ve(s)&&(T=vt(s),ct(T).position!=="static"&&h==="absolute"&&(A="scrollHeight",L="scrollWidth")),T=T,i===Ne||(i===Ie||i===Fe)&&u===It){x=Be;var C=$&&T===E&&E.visualViewport?E.visualViewport.height:T[A];g-=C-o.height,g*=p?1:-1}if(i===Ie||(i===Ne||i===Be)&&u===It){w=Fe;var O=$&&T===E&&E.visualViewport?E.visualViewport.width:T[L];d-=O-o.width,d*=p?1:-1}}var V=Object.assign({position:h},m&&c0),P=v===!0?u0({x:d,y:g},Ve(s)):{x:d,y:g};if(d=P.x,g=P.y,p){var F;return Object.assign({},V,(F={},F[x]=a?"0":"",F[w]=b?"0":"",F.transform=(E.devicePixelRatio||1)<=1?"translate("+d+"px, "+g+"px)":"translate3d("+d+"px, "+g+"px, 0)",F))}return Object.assign({},V,(e={},e[x]=a?g+"px":"",e[w]=b?d+"px":"",e.transform="",e))}function d0(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,u=s.adaptive,f=u===void 0?!0:u,h=s.roundOffsets,p=h===void 0?!0:h,m={placement:Ze(e.placement),variation:Rt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Kn(Object.assign({},m,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:f,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Kn(Object.assign({},m,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const sa={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:d0,data:{}};var ds={passive:!0};function f0(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,u=i===void 0?!0:i,f=o.resize,h=f===void 0?!0:f,p=Ve(e.elements.popper),m=[].concat(e.scrollParents.reference,e.scrollParents.popper);return u&&m.forEach(function(v){v.addEventListener("scroll",s.update,ds)}),h&&p.addEventListener("resize",s.update,ds),function(){u&&m.forEach(function(v){v.removeEventListener("scroll",s.update,ds)}),h&&p.removeEventListener("resize",s.update,ds)}}const na={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:f0,data:{}};var m0={left:"right",right:"left",bottom:"top",top:"bottom"};function _s(n){return n.replace(/left|right|bottom|top/g,function(e){return m0[e]})}var p0={start:"end",end:"start"};function Xn(n){return n.replace(/start|end/g,function(e){return p0[e]})}function wn(n){var e=Ve(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function kn(n){return Pt(vt(n)).left+wn(n).scrollLeft}function v0(n,e){var s=Ve(n),o=vt(n),i=s.visualViewport,u=o.clientWidth,f=o.clientHeight,h=0,p=0;if(i){u=i.width,f=i.height;var m=Yo();(m||!m&&e==="fixed")&&(h=i.offsetLeft,p=i.offsetTop)}return{width:u,height:f,x:h+kn(n),y:p}}function h0(n){var e,s=vt(n),o=wn(n),i=(e=n.ownerDocument)==null?void 0:e.body,u=wt(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),f=wt(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),h=-o.scrollLeft+kn(n),p=-o.scrollTop;return ct(i||s).direction==="rtl"&&(h+=wt(s.clientWidth,i?i.clientWidth:0)-u),{width:u,height:f,x:h,y:p}}function $n(n){var e=ct(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function oa(n){return["html","body","#document"].indexOf(tt(n))>=0?n.ownerDocument.body:Ue(n)&&$n(n)?n:oa(Es(n))}function Qt(n,e){var s;e===void 0&&(e=[]);var o=oa(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),u=Ve(o),f=i?[u].concat(u.visualViewport||[],$n(o)?o:[]):o,h=e.concat(f);return i?h:h.concat(Qt(Es(f)))}function rn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function g0(n,e){var s=Pt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Gn(n,e,s){return e===hn?rn(v0(n,s)):$t(e)?g0(e,s):rn(h0(vt(n)))}function _0(n){var e=Qt(Es(n)),s=["absolute","fixed"].indexOf(ct(n).position)>=0,o=s&&Ue(n)?as(n):n;return $t(o)?e.filter(function(i){return $t(i)&&Jo(i,o)&&tt(i)!=="body"}):[]}function b0(n,e,s,o){var i=e==="clippingParents"?_0(n):[].concat(e),u=[].concat(i,[s]),f=u[0],h=u.reduce(function(p,m){var v=Gn(n,m,o);return p.top=wt(v.top,p.top),p.right=ks(v.right,p.right),p.bottom=ks(v.bottom,p.bottom),p.left=wt(v.left,p.left),p},Gn(n,f,o));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function aa(n){var e=n.reference,s=n.element,o=n.placement,i=o?Ze(o):null,u=o?Rt(o):null,f=e.x+e.width/2-s.width/2,h=e.y+e.height/2-s.height/2,p;switch(i){case Ne:p={x:f,y:e.y-s.height};break;case Be:p={x:f,y:e.y+e.height};break;case Fe:p={x:e.x+e.width,y:h};break;case Ie:p={x:e.x-s.width,y:h};break;default:p={x:e.x,y:e.y}}var m=i?yn(i):null;if(m!=null){var v=m==="y"?"height":"width";switch(u){case kt:p[m]=p[m]-(e[v]/2-s[v]/2);break;case It:p[m]=p[m]+(e[v]/2-s[v]/2);break}}return p}function Bt(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,u=s.strategy,f=u===void 0?n.strategy:u,h=s.boundary,p=h===void 0?Po:h,m=s.rootBoundary,v=m===void 0?hn:m,$=s.elementContext,c=$===void 0?Dt:$,d=s.altBoundary,y=d===void 0?!1:d,g=s.padding,_=g===void 0?0:g,b=Zo(typeof _!="number"?_:ea(_,Ht)),a=c===Dt?Ro:Dt,w=n.rects.popper,x=n.elements[y?a:c],E=b0($t(x)?x:x.contextElement||vt(n.elements.popper),p,v,f),T=Pt(n.elements.reference),A=aa({reference:T,element:w,placement:i}),L=rn(Object.assign({},w,A)),C=c===Dt?L:T,O={top:E.top-C.top+b.top,bottom:C.bottom-E.bottom+b.bottom,left:E.left-C.left+b.left,right:C.right-E.right+b.right},V=n.modifiersData.offset;if(c===Dt&&V){var P=V[i];Object.keys(O).forEach(function(F){var U=[Fe,Be].indexOf(F)>=0?1:-1,X=[Ne,Be].indexOf(F)>=0?"y":"x";O[F]+=P[X]*U})}return O}function y0(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,u=s.rootBoundary,f=s.padding,h=s.flipVariations,p=s.allowedAutoPlacements,m=p===void 0?gn:p,v=Rt(o),$=v?h?an:an.filter(function(y){return Rt(y)===v}):Ht,c=$.filter(function(y){return m.indexOf(y)>=0});c.length===0&&(c=$);var d=c.reduce(function(y,g){return y[g]=Bt(n,{placement:g,boundary:i,rootBoundary:u,padding:f})[Ze(g)],y},{});return Object.keys(d).sort(function(y,g){return d[y]-d[g]})}function w0(n){if(Ze(n)===Cs)return[];var e=_s(n);return[Xn(n),e,Xn(e)]}function k0(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,u=i===void 0?!0:i,f=s.altAxis,h=f===void 0?!0:f,p=s.fallbackPlacements,m=s.padding,v=s.boundary,$=s.rootBoundary,c=s.altBoundary,d=s.flipVariations,y=d===void 0?!0:d,g=s.allowedAutoPlacements,_=e.options.placement,b=Ze(_),a=b===_,w=p||(a||!y?[_s(_)]:w0(_)),x=[_].concat(w).reduce(function(he,ge){return he.concat(Ze(ge)===Cs?y0(e,{placement:ge,boundary:v,rootBoundary:$,padding:m,flipVariations:y,allowedAutoPlacements:g}):ge)},[]),E=e.rects.reference,T=e.rects.popper,A=new Map,L=!0,C=x[0],O=0;O<x.length;O++){var V=x[O],P=Ze(V),F=Rt(V)===kt,U=[Ne,Be].indexOf(P)>=0,X=U?"width":"height",I=Bt(e,{placement:V,boundary:v,rootBoundary:$,altBoundary:c,padding:m}),N=U?F?Fe:Ie:F?Be:Ne;E[X]>T[X]&&(N=_s(N));var K=_s(N),R=[];if(u&&R.push(I[P]<=0),h&&R.push(I[N]<=0,I[K]<=0),R.every(function(he){return he})){C=V,L=!1;break}A.set(V,R)}if(L)for(var q=y?3:1,ee=function(ge){var z=x.find(function(j){var W=A.get(j);if(W)return W.slice(0,ge).every(function(Q){return Q})});if(z)return C=z,"break"},ue=q;ue>0;ue--){var ie=ee(ue);if(ie==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const ia={name:"flip",enabled:!0,phase:"main",fn:k0,requiresIfExists:["offset"],data:{_skip:!1}};function Yn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Jn(n){return[Ne,Fe,Be,Ie].some(function(e){return n[e]>=0})}function $0(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,u=e.modifiersData.preventOverflow,f=Bt(e,{elementContext:"reference"}),h=Bt(e,{altBoundary:!0}),p=Yn(f,o),m=Yn(h,i,u),v=Jn(p),$=Jn(m);e.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:m,isReferenceHidden:v,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":v,"data-popper-escaped":$})}const la={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:$0};function S0(n,e,s){var o=Ze(n),i=[Ie,Ne].indexOf(o)>=0?-1:1,u=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,f=u[0],h=u[1];return f=f||0,h=(h||0)*i,[Ie,Fe].indexOf(o)>=0?{x:h,y:f}:{x:f,y:h}}function x0(n){var e=n.state,s=n.options,o=n.name,i=s.offset,u=i===void 0?[0,0]:i,f=gn.reduce(function(v,$){return v[$]=S0($,e.rects,u),v},{}),h=f[e.placement],p=h.x,m=h.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=m),e.modifiersData[o]=f}const ra={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:x0};function C0(n){var e=n.state,s=n.name;e.modifiersData[s]=aa({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const ca={name:"popperOffsets",enabled:!0,phase:"read",fn:C0,data:{}};function E0(n){return n==="x"?"y":"x"}function T0(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,u=i===void 0?!0:i,f=s.altAxis,h=f===void 0?!1:f,p=s.boundary,m=s.rootBoundary,v=s.altBoundary,$=s.padding,c=s.tether,d=c===void 0?!0:c,y=s.tetherOffset,g=y===void 0?0:y,_=Bt(e,{boundary:p,rootBoundary:m,padding:$,altBoundary:v}),b=Ze(e.placement),a=Rt(e.placement),w=!a,x=yn(b),E=E0(x),T=e.modifiersData.popperOffsets,A=e.rects.reference,L=e.rects.popper,C=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,O=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),V=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,P={x:0,y:0};if(T){if(u){var F,U=x==="y"?Ne:Ie,X=x==="y"?Be:Fe,I=x==="y"?"height":"width",N=T[x],K=N+_[U],R=N-_[X],q=d?-L[I]/2:0,ee=a===kt?A[I]:L[I],ue=a===kt?-L[I]:-A[I],ie=e.elements.arrow,he=d&&ie?bn(ie):{width:0,height:0},ge=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Qo(),z=ge[U],j=ge[X],W=Jt(0,A[I],he[I]),Q=w?A[I]/2-q-W-z-O.mainAxis:ee-W-z-O.mainAxis,J=w?-A[I]/2+q+W+j+O.mainAxis:ue+W+j+O.mainAxis,oe=e.elements.arrow&&as(e.elements.arrow),Se=oe?x==="y"?oe.clientTop||0:oe.clientLeft||0:0,ot=(F=V?.[x])!=null?F:0,Y=N+Q-ot-Se,re=N+J-ot,_e=Jt(d?ks(K,Y):K,N,d?wt(R,re):R);T[x]=_e,P[x]=_e-N}if(h){var we,Ee=x==="x"?Ne:Ie,at=x==="x"?Be:Fe,Ge=T[E],_t=E==="y"?"height":"width",B=Ge+_[Ee],Z=Ge-_[at],ae=[Ne,Ie].indexOf(b)!==-1,ke=(we=V?.[E])!=null?we:0,me=ae?B:Ge-A[_t]-L[_t]-ke+O.altAxis,Te=ae?Ge+A[_t]+L[_t]-ke-O.altAxis:Z,Ae=d&&ae?a0(me,Ge,Te):Jt(d?me:B,Ge,d?Te:Z);T[E]=Ae,P[E]=Ae-Ge}e.modifiersData[o]=P}}const ua={name:"preventOverflow",enabled:!0,phase:"main",fn:T0,requiresIfExists:["offset"]};function A0(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function D0(n){return n===Ve(n)||!Ue(n)?wn(n):A0(n)}function O0(n){var e=n.getBoundingClientRect(),s=jt(e.width)/n.offsetWidth||1,o=jt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function M0(n,e,s){s===void 0&&(s=!1);var o=Ue(e),i=Ue(e)&&O0(e),u=vt(e),f=Pt(n,i,s),h={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!s)&&((tt(e)!=="body"||$n(u))&&(h=D0(e)),Ue(e)?(p=Pt(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):u&&(p.x=kn(u))),{x:f.left+h.scrollLeft-p.x,y:f.top+h.scrollTop-p.y,width:f.width,height:f.height}}function L0(n){var e=new Map,s=new Set,o=[];n.forEach(function(u){e.set(u.name,u)});function i(u){s.add(u.name);var f=[].concat(u.requires||[],u.requiresIfExists||[]);f.forEach(function(h){if(!s.has(h)){var p=e.get(h);p&&i(p)}}),o.push(u)}return n.forEach(function(u){s.has(u.name)||i(u)}),o}function N0(n){var e=L0(n);return Xo.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function I0(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function j0(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Qn={placement:"bottom",modifiers:[],strategy:"absolute"};function Zn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function da(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,u=i===void 0?Qn:i;return function(h,p,m){m===void 0&&(m=u);var v={placement:"bottom",orderedModifiers:[],options:Object.assign({},Qn,u),modifiersData:{},elements:{reference:h,popper:p},attributes:{},styles:{}},$=[],c=!1,d={state:v,setOptions:function(b){var a=typeof b=="function"?b(v.options):b;g(),v.options=Object.assign({},u,v.options,a),v.scrollParents={reference:$t(h)?Qt(h):h.contextElement?Qt(h.contextElement):[],popper:Qt(p)};var w=N0(j0([].concat(o,v.options.modifiers)));return v.orderedModifiers=w.filter(function(x){return x.enabled}),y(),d.update()},forceUpdate:function(){if(!c){var b=v.elements,a=b.reference,w=b.popper;if(Zn(a,w)){v.rects={reference:M0(a,as(w),v.options.strategy==="fixed"),popper:bn(w)},v.reset=!1,v.placement=v.options.placement,v.orderedModifiers.forEach(function(O){return v.modifiersData[O.name]=Object.assign({},O.data)});for(var x=0;x<v.orderedModifiers.length;x++){if(v.reset===!0){v.reset=!1,x=-1;continue}var E=v.orderedModifiers[x],T=E.fn,A=E.options,L=A===void 0?{}:A,C=E.name;typeof T=="function"&&(v=T({state:v,options:L,name:C,instance:d})||v)}}}},update:I0(function(){return new Promise(function(_){d.forceUpdate(),_(v)})}),destroy:function(){g(),c=!0}};if(!Zn(h,p))return d;d.setOptions(m).then(function(_){!c&&m.onFirstUpdate&&m.onFirstUpdate(_)});function y(){v.orderedModifiers.forEach(function(_){var b=_.name,a=_.options,w=a===void 0?{}:a,x=_.effect;if(typeof x=="function"){var E=x({state:v,name:b,instance:d,options:w}),T=function(){};$.push(E||T)}})}function g(){$.forEach(function(_){return _()}),$=[]}return d}}var P0=[na,ca,sa,Go,ra,ia,ua,ta,la],Sn=da({defaultModifiers:P0});const fa=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Ho,afterRead:Vo,afterWrite:Ko,applyStyles:Go,arrow:ta,auto:Cs,basePlacements:Ht,beforeMain:Uo,beforeRead:Bo,beforeWrite:zo,bottom:Be,clippingParents:Po,computeStyles:sa,createPopper:Sn,detectOverflow:Bt,end:It,eventListeners:na,flip:ia,hide:la,left:Ie,main:Wo,modifierPhases:Xo,offset:ra,placements:gn,popper:Dt,popperGenerator:da,popperOffsets:ca,preventOverflow:ua,read:Fo,reference:Ro,right:Fe,start:kt,top:Ne,variationPlacements:an,viewport:hn,write:qo},Symbol.toStringTag,{value:"Module"}));const dt=new Map,Vs={set(n,e,s){dt.has(n)||dt.set(n,new Map);const o=dt.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return dt.has(n)&&dt.get(n).get(e)||null},remove(n,e){if(!dt.has(n))return;const s=dt.get(n);s.delete(e),s.size===0&&dt.delete(n)}},R0=1e6,B0=1e3,cn="transitionend",ma=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),F0=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),V0=n=>{do n+=Math.floor(Math.random()*R0);while(document.getElementById(n));return n},U0=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*B0)},pa=n=>{n.dispatchEvent(new Event(cn))},it=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ft=n=>it(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ma(n)):null,zt=n=>{if(!it(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},mt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",va=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?va(n.parentNode):null},$s=()=>{},is=n=>{n.offsetHeight},ha=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Us=[],W0=n=>{document.readyState==="loading"?(Us.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Us)e()}),Us.push(n)):n()},We=()=>document.documentElement.dir==="rtl",qe=n=>{W0(()=>{const e=ha();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},je=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,ga=(n,e,s=!0)=>{if(!s){je(n);return}const i=U0(e)+5;let u=!1;const f=({target:h})=>{h===e&&(u=!0,e.removeEventListener(cn,f),je(n))};e.addEventListener(cn,f),setTimeout(()=>{u||pa(e)},i)},xn=(n,e,s,o)=>{const i=n.length;let u=n.indexOf(e);return u===-1?!s&&o?n[i-1]:n[0]:(u+=s?1:-1,o&&(u=(u+i)%i),n[Math.max(0,Math.min(u,i-1))])},H0=/[^.]*(?=\..*)\.|.*/,z0=/\..*/,q0=/::\d+$/,Ws={};let eo=1;const _a={mouseenter:"mouseover",mouseleave:"mouseout"},K0=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ba(n,e){return e&&`${e}::${eo++}`||n.uidEvent||eo++}function ya(n){const e=ba(n);return n.uidEvent=e,Ws[e]=Ws[e]||{},Ws[e]}function X0(n,e){return function s(o){return Cn(o,{delegateTarget:n}),s.oneOff&&G.off(n,o.type,e),e.apply(n,[o])}}function G0(n,e,s){return function o(i){const u=n.querySelectorAll(e);for(let{target:f}=i;f&&f!==this;f=f.parentNode)for(const h of u)if(h===f)return Cn(i,{delegateTarget:f}),o.oneOff&&G.off(n,i.type,e,s),s.apply(f,[i])}}function wa(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ka(n,e,s){const o=typeof e=="string",i=o?s:e||s;let u=$a(n);return K0.has(u)||(u=n),[o,i,u]}function to(n,e,s,o,i){if(typeof e!="string"||!n)return;let[u,f,h]=ka(e,s,o);e in _a&&(f=(y=>function(g){if(!g.relatedTarget||g.relatedTarget!==g.delegateTarget&&!g.delegateTarget.contains(g.relatedTarget))return y.call(this,g)})(f));const p=ya(n),m=p[h]||(p[h]={}),v=wa(m,f,u?s:null);if(v){v.oneOff=v.oneOff&&i;return}const $=ba(f,e.replace(H0,"")),c=u?G0(n,s,f):X0(n,f);c.delegationSelector=u?s:null,c.callable=f,c.oneOff=i,c.uidEvent=$,m[$]=c,n.addEventListener(h,c,u)}function un(n,e,s,o,i){const u=wa(e[s],o,i);u&&(n.removeEventListener(s,u,!!i),delete e[s][u.uidEvent])}function Y0(n,e,s,o){const i=e[s]||{};for(const[u,f]of Object.entries(i))u.includes(o)&&un(n,e,s,f.callable,f.delegationSelector)}function $a(n){return n=n.replace(z0,""),_a[n]||n}const G={on(n,e,s,o){to(n,e,s,o,!1)},one(n,e,s,o){to(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,u,f]=ka(e,s,o),h=f!==e,p=ya(n),m=p[f]||{},v=e.startsWith(".");if(typeof u<"u"){if(!Object.keys(m).length)return;un(n,p,f,u,i?s:null);return}if(v)for(const $ of Object.keys(p))Y0(n,p,$,e.slice(1));for(const[$,c]of Object.entries(m)){const d=$.replace(q0,"");(!h||e.includes(d))&&un(n,p,f,c.callable,c.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=ha(),i=$a(e),u=e!==i;let f=null,h=!0,p=!0,m=!1;u&&o&&(f=o.Event(e,s),o(n).trigger(f),h=!f.isPropagationStopped(),p=!f.isImmediatePropagationStopped(),m=f.isDefaultPrevented());const v=Cn(new Event(e,{bubbles:h,cancelable:!0}),s);return m&&v.preventDefault(),p&&n.dispatchEvent(v),v.defaultPrevented&&f&&f.preventDefault(),v}};function Cn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function so(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Hs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const lt={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Hs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Hs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=so(n.dataset[o])}return e},getDataAttribute(n,e){return so(n.getAttribute(`data-bs-${Hs(e)}`))}};class ls{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=it(s)?lt.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...it(s)?lt.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const u=e[o],f=it(u)?"element":F0(u);if(!new RegExp(i).test(f))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${f}" but expected type "${i}".`)}}}const J0="5.3.8";class Xe extends ls{constructor(e,s){super(),e=ft(e),e&&(this._element=e,this._config=this._getConfig(s),Vs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Vs.remove(this._element,this.constructor.DATA_KEY),G.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){ga(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Vs.get(ft(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return J0}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const zs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ma(s)).join(","):null},fe={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!mt(s)&&zt(s))},getSelectorFromElement(n){const e=zs(n);return e&&fe.findOne(e)?e:null},getElementFromSelector(n){const e=zs(n);return e?fe.findOne(e):null},getMultipleElementsFromSelector(n){const e=zs(n);return e?fe.find(e):[]}},Ts=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;G.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),mt(this))return;const u=fe.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(u)[e]()})},Q0="alert",Z0="bs.alert",Sa=`.${Z0}`,eS=`close${Sa}`,tS=`closed${Sa}`,sS="fade",nS="show";class As extends Xe{static get NAME(){return Q0}close(){if(G.trigger(this._element,eS).defaultPrevented)return;this._element.classList.remove(nS);const s=this._element.classList.contains(sS);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),G.trigger(this._element,tS),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=As.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Ts(As,"close");qe(As);const oS="button",aS="bs.button",iS=`.${aS}`,lS=".data-api",rS="active",no='[data-bs-toggle="button"]',cS=`click${iS}${lS}`;class Ds extends Xe{static get NAME(){return oS}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(rS))}static jQueryInterface(e){return this.each(function(){const s=Ds.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}G.on(document,cS,no,n=>{n.preventDefault();const e=n.target.closest(no);Ds.getOrCreateInstance(e).toggle()});qe(Ds);const uS="swipe",qt=".bs.swipe",dS=`touchstart${qt}`,fS=`touchmove${qt}`,mS=`touchend${qt}`,pS=`pointerdown${qt}`,vS=`pointerup${qt}`,hS="touch",gS="pen",_S="pointer-event",bS=40,yS={endCallback:null,leftCallback:null,rightCallback:null},wS={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Ss extends ls{constructor(e,s){super(),this._element=e,!(!e||!Ss.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return yS}static get DefaultType(){return wS}static get NAME(){return uS}dispose(){G.off(this._element,qt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),je(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=bS)return;const s=e/this._deltaX;this._deltaX=0,s&&je(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(G.on(this._element,pS,e=>this._start(e)),G.on(this._element,vS,e=>this._end(e)),this._element.classList.add(_S)):(G.on(this._element,dS,e=>this._start(e)),G.on(this._element,fS,e=>this._move(e)),G.on(this._element,mS,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===gS||e.pointerType===hS)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const kS="carousel",$S="bs.carousel",ht=`.${$S}`,xa=".data-api",SS="ArrowLeft",xS="ArrowRight",CS=500,Gt="next",Tt="prev",Ot="left",bs="right",ES=`slide${ht}`,qs=`slid${ht}`,TS=`keydown${ht}`,AS=`mouseenter${ht}`,DS=`mouseleave${ht}`,OS=`dragstart${ht}`,MS=`load${ht}${xa}`,LS=`click${ht}${xa}`,Ca="carousel",fs="active",NS="slide",IS="carousel-item-end",jS="carousel-item-start",PS="carousel-item-next",RS="carousel-item-prev",Ea=".active",Ta=".carousel-item",BS=Ea+Ta,FS=".carousel-item img",VS=".carousel-indicators",US="[data-bs-slide], [data-bs-slide-to]",WS='[data-bs-ride="carousel"]',HS={[SS]:bs,[xS]:Ot},zS={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},qS={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class rs extends Xe{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=fe.findOne(VS,this._element),this._addEventListeners(),this._config.ride===Ca&&this.cycle()}static get Default(){return zS}static get DefaultType(){return qS}static get NAME(){return kS}next(){this._slide(Gt)}nextWhenVisible(){!document.hidden&&zt(this._element)&&this.next()}prev(){this._slide(Tt)}pause(){this._isSliding&&pa(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){G.one(this._element,qs,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){G.one(this._element,qs,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Gt:Tt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&G.on(this._element,TS,e=>this._keydown(e)),this._config.pause==="hover"&&(G.on(this._element,AS,()=>this.pause()),G.on(this._element,DS,()=>this._maybeEnableCycle())),this._config.touch&&Ss.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of fe.find(FS,this._element))G.on(o,OS,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Ot)),rightCallback:()=>this._slide(this._directionToOrder(bs)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),CS+this._config.interval))}};this._swipeHelper=new Ss(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=HS[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=fe.findOne(Ea,this._indicatorsElement);s.classList.remove(fs),s.removeAttribute("aria-current");const o=fe.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(fs),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===Gt,u=s||xn(this._getItems(),o,i,this._config.wrap);if(u===o)return;const f=this._getItemIndex(u),h=d=>G.trigger(this._element,d,{relatedTarget:u,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:f});if(h(ES).defaultPrevented||!o||!u)return;const m=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(f),this._activeElement=u;const v=i?jS:IS,$=i?PS:RS;u.classList.add($),is(u),o.classList.add(v),u.classList.add(v);const c=()=>{u.classList.remove(v,$),u.classList.add(fs),o.classList.remove(fs,$,v),this._isSliding=!1,h(qs)};this._queueCallback(c,o,this._isAnimated()),m&&this.cycle()}_isAnimated(){return this._element.classList.contains(NS)}_getActive(){return fe.findOne(BS,this._element)}_getItems(){return fe.find(Ta,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return We()?e===Ot?Tt:Gt:e===Ot?Gt:Tt}_orderToDirection(e){return We()?e===Tt?Ot:bs:e===Tt?bs:Ot}static jQueryInterface(e){return this.each(function(){const s=rs.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(document,LS,US,function(n){const e=fe.getElementFromSelector(this);if(!e||!e.classList.contains(Ca))return;n.preventDefault();const s=rs.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(lt.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});G.on(window,MS,()=>{const n=fe.find(WS);for(const e of n)rs.getOrCreateInstance(e)});qe(rs);const KS="collapse",XS="bs.collapse",cs=`.${XS}`,GS=".data-api",YS=`show${cs}`,JS=`shown${cs}`,QS=`hide${cs}`,ZS=`hidden${cs}`,ex=`click${cs}${GS}`,Ks="show",Lt="collapse",ms="collapsing",tx="collapsed",sx=`:scope .${Lt} .${Lt}`,nx="collapse-horizontal",ox="width",ax="height",ix=".collapse.show, .collapse.collapsing",dn='[data-bs-toggle="collapse"]',lx={parent:null,toggle:!0},rx={parent:"(null|element)",toggle:"boolean"};class ss extends Xe{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=fe.find(dn);for(const i of o){const u=fe.getSelectorFromElement(i),f=fe.find(u).filter(h=>h===this._element);u!==null&&f.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return lx}static get DefaultType(){return rx}static get NAME(){return KS}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(ix).filter(h=>h!==this._element).map(h=>ss.getOrCreateInstance(h,{toggle:!1}))),e.length&&e[0]._isTransitioning||G.trigger(this._element,YS).defaultPrevented)return;for(const h of e)h.hide();const o=this._getDimension();this._element.classList.remove(Lt),this._element.classList.add(ms),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(ms),this._element.classList.add(Lt,Ks),this._element.style[o]="",G.trigger(this._element,JS)},f=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[f]}px`}hide(){if(this._isTransitioning||!this._isShown()||G.trigger(this._element,QS).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,is(this._element),this._element.classList.add(ms),this._element.classList.remove(Lt,Ks);for(const i of this._triggerArray){const u=fe.getElementFromSelector(i);u&&!this._isShown(u)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(ms),this._element.classList.add(Lt),G.trigger(this._element,ZS)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ks)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ft(e.parent),e}_getDimension(){return this._element.classList.contains(nx)?ox:ax}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(dn);for(const s of e){const o=fe.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=fe.find(sx,this._config.parent);return fe.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(tx,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=ss.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}G.on(document,ex,dn,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of fe.getMultipleElementsFromSelector(this))ss.getOrCreateInstance(e,{toggle:!1}).toggle()});qe(ss);const oo="dropdown",cx="bs.dropdown",xt=`.${cx}`,En=".data-api",ux="Escape",ao="Tab",dx="ArrowUp",io="ArrowDown",fx=2,mx=`hide${xt}`,px=`hidden${xt}`,vx=`show${xt}`,hx=`shown${xt}`,Aa=`click${xt}${En}`,Da=`keydown${xt}${En}`,gx=`keyup${xt}${En}`,Mt="show",_x="dropup",bx="dropend",yx="dropstart",wx="dropup-center",kx="dropdown-center",bt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',$x=`${bt}.${Mt}`,ys=".dropdown-menu",Sx=".navbar",xx=".navbar-nav",Cx=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Ex=We()?"top-end":"top-start",Tx=We()?"top-start":"top-end",Ax=We()?"bottom-end":"bottom-start",Dx=We()?"bottom-start":"bottom-end",Ox=We()?"left-start":"right-start",Mx=We()?"right-start":"left-start",Lx="top",Nx="bottom",Ix={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},jx={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class et extends Xe{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=fe.next(this._element,ys)[0]||fe.prev(this._element,ys)[0]||fe.findOne(ys,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ix}static get DefaultType(){return jx}static get NAME(){return oo}toggle(){return this._isShown()?this.hide():this.show()}show(){if(mt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!G.trigger(this._element,vx,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(xx))for(const o of[].concat(...document.body.children))G.on(o,"mouseover",$s);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Mt),this._element.classList.add(Mt),G.trigger(this._element,hx,e)}}hide(){if(mt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!G.trigger(this._element,mx,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))G.off(o,"mouseover",$s);this._popper&&this._popper.destroy(),this._menu.classList.remove(Mt),this._element.classList.remove(Mt),this._element.setAttribute("aria-expanded","false"),lt.removeDataAttribute(this._menu,"popper"),G.trigger(this._element,px,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!it(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${oo.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof fa>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:it(this._config.reference)?e=ft(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Sn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Mt)}_getPlacement(){const e=this._parent;if(e.classList.contains(bx))return Ox;if(e.classList.contains(yx))return Mx;if(e.classList.contains(wx))return Lx;if(e.classList.contains(kx))return Nx;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(_x)?s?Tx:Ex:s?Dx:Ax}_detectNavbar(){return this._element.closest(Sx)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(lt.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...je(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=fe.find(Cx,this._menu).filter(i=>zt(i));o.length&&xn(o,s,e===io,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=et.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===fx||e.type==="keyup"&&e.key!==ao)return;const s=fe.find($x);for(const o of s){const i=et.getInstance(o);if(!i||i._config.autoClose===!1)continue;const u=e.composedPath(),f=u.includes(i._menu);if(u.includes(i._element)||i._config.autoClose==="inside"&&!f||i._config.autoClose==="outside"&&f||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===ao||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const h={relatedTarget:i._element};e.type==="click"&&(h.clickEvent=e),i._completeHide(h)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===ux,i=[dx,io].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const u=this.matches(bt)?this:fe.prev(this,bt)[0]||fe.next(this,bt)[0]||fe.findOne(bt,e.delegateTarget.parentNode),f=et.getOrCreateInstance(u);if(i){e.stopPropagation(),f.show(),f._selectMenuItem(e);return}f._isShown()&&(e.stopPropagation(),f.hide(),u.focus())}}G.on(document,Da,bt,et.dataApiKeydownHandler);G.on(document,Da,ys,et.dataApiKeydownHandler);G.on(document,Aa,et.clearMenus);G.on(document,gx,et.clearMenus);G.on(document,Aa,bt,function(n){n.preventDefault(),et.getOrCreateInstance(this).toggle()});qe(et);const Oa="backdrop",Px="fade",lo="show",ro=`mousedown.bs.${Oa}`,Rx={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Bx={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Ma extends ls{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Rx}static get DefaultType(){return Bx}static get NAME(){return Oa}show(e){if(!this._config.isVisible){je(e);return}this._append();const s=this._getElement();this._config.isAnimated&&is(s),s.classList.add(lo),this._emulateAnimation(()=>{je(e)})}hide(e){if(!this._config.isVisible){je(e);return}this._getElement().classList.remove(lo),this._emulateAnimation(()=>{this.dispose(),je(e)})}dispose(){this._isAppended&&(G.off(this._element,ro),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Px),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ft(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),G.on(e,ro,()=>{je(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){ga(e,this._getElement(),this._config.isAnimated)}}const Fx="focustrap",Vx="bs.focustrap",xs=`.${Vx}`,Ux=`focusin${xs}`,Wx=`keydown.tab${xs}`,Hx="Tab",zx="forward",co="backward",qx={autofocus:!0,trapElement:null},Kx={autofocus:"boolean",trapElement:"element"};class La extends ls{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return qx}static get DefaultType(){return Kx}static get NAME(){return Fx}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),G.off(document,xs),G.on(document,Ux,e=>this._handleFocusin(e)),G.on(document,Wx,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,G.off(document,xs))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=fe.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===co?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Hx&&(this._lastTabNavDirection=e.shiftKey?co:zx)}}const uo=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",fo=".sticky-top",ps="padding-right",mo="margin-right";class fn{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ps,s=>s+e),this._setElementAttributes(uo,ps,s=>s+e),this._setElementAttributes(fo,mo,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ps),this._resetElementAttributes(uo,ps),this._resetElementAttributes(fo,mo)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),u=f=>{if(f!==this._element&&window.innerWidth>f.clientWidth+i)return;this._saveInitialAttribute(f,s);const h=window.getComputedStyle(f).getPropertyValue(s);f.style.setProperty(s,`${o(Number.parseFloat(h))}px`)};this._applyManipulationCallback(e,u)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&lt.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const u=lt.getDataAttribute(i,s);if(u===null){i.style.removeProperty(s);return}lt.removeDataAttribute(i,s),i.style.setProperty(s,u)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(it(e)){s(e);return}for(const o of fe.find(e,this._element))s(o)}}const Xx="modal",Gx="bs.modal",He=`.${Gx}`,Yx=".data-api",Jx="Escape",Qx=`hide${He}`,Zx=`hidePrevented${He}`,Na=`hidden${He}`,Ia=`show${He}`,eC=`shown${He}`,tC=`resize${He}`,sC=`click.dismiss${He}`,nC=`mousedown.dismiss${He}`,oC=`keydown.dismiss${He}`,aC=`click${He}${Yx}`,po="modal-open",iC="fade",vo="show",Xs="modal-static",lC=".modal.show",rC=".modal-dialog",cC=".modal-body",uC='[data-bs-toggle="modal"]',dC={backdrop:!0,focus:!0,keyboard:!0},fC={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class St extends Xe{constructor(e,s){super(e,s),this._dialog=fe.findOne(rC,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new fn,this._addEventListeners()}static get Default(){return dC}static get DefaultType(){return fC}static get NAME(){return Xx}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||G.trigger(this._element,Ia,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(po),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||G.trigger(this._element,Qx).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(vo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){G.off(window,He),G.off(this._dialog,He),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ma({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new La({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=fe.findOne(cC,this._dialog);s&&(s.scrollTop=0),is(this._element),this._element.classList.add(vo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,G.trigger(this._element,eC,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){G.on(this._element,oC,e=>{if(e.key===Jx){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),G.on(window,tC,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),G.on(this._element,nC,e=>{G.one(this._element,sC,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(po),this._resetAdjustments(),this._scrollBar.reset(),G.trigger(this._element,Na)})}_isAnimated(){return this._element.classList.contains(iC)}_triggerBackdropTransition(){if(G.trigger(this._element,Zx).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Xs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Xs),this._queueCallback(()=>{this._element.classList.remove(Xs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=We()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=We()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}G.on(document,aC,uC,function(n){const e=fe.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),G.one(e,Ia,i=>{i.defaultPrevented||G.one(e,Na,()=>{zt(this)&&this.focus()})});const s=fe.findOne(lC);s&&St.getInstance(s).hide(),St.getOrCreateInstance(e).toggle(this)});Ts(St);qe(St);const mC="offcanvas",pC="bs.offcanvas",ut=`.${pC}`,ja=".data-api",vC=`load${ut}${ja}`,hC="Escape",ho="show",go="showing",_o="hiding",gC="offcanvas-backdrop",Pa=".offcanvas.show",_C=`show${ut}`,bC=`shown${ut}`,yC=`hide${ut}`,bo=`hidePrevented${ut}`,Ra=`hidden${ut}`,wC=`resize${ut}`,kC=`click${ut}${ja}`,$C=`keydown.dismiss${ut}`,SC='[data-bs-toggle="offcanvas"]',xC={backdrop:!0,keyboard:!0,scroll:!1},CC={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class pt extends Xe{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return xC}static get DefaultType(){return CC}static get NAME(){return mC}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||G.trigger(this._element,_C,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new fn().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(go);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(ho),this._element.classList.remove(go),G.trigger(this._element,bC,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||G.trigger(this._element,yC).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(_o),this._backdrop.hide();const s=()=>{this._element.classList.remove(ho,_o),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new fn().reset(),G.trigger(this._element,Ra)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){G.trigger(this._element,bo);return}this.hide()},s=!!this._config.backdrop;return new Ma({className:gC,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new La({trapElement:this._element})}_addEventListeners(){G.on(this._element,$C,e=>{if(e.key===hC){if(this._config.keyboard){this.hide();return}G.trigger(this._element,bo)}})}static jQueryInterface(e){return this.each(function(){const s=pt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}G.on(document,kC,SC,function(n){const e=fe.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),mt(this))return;G.one(e,Ra,()=>{zt(this)&&this.focus()});const s=fe.findOne(Pa);s&&s!==e&&pt.getInstance(s).hide(),pt.getOrCreateInstance(e).toggle(this)});G.on(window,vC,()=>{for(const n of fe.find(Pa))pt.getOrCreateInstance(n).show()});G.on(window,wC,()=>{for(const n of fe.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&pt.getOrCreateInstance(n).hide()});Ts(pt);qe(pt);const EC=/^aria-[\w-]*$/i,Ba={"*":["class","dir","id","lang","role",EC],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},TC=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),AC=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,DC=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?TC.has(s)?!!AC.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function OC(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),u=[].concat(...i.body.querySelectorAll("*"));for(const f of u){const h=f.nodeName.toLowerCase();if(!Object.keys(e).includes(h)){f.remove();continue}const p=[].concat(...f.attributes),m=[].concat(e["*"]||[],e[h]||[]);for(const v of p)DC(v,m)||f.removeAttribute(v.nodeName)}return i.body.innerHTML}const MC="TemplateFactory",LC={allowList:Ba,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},NC={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},IC={entry:"(string|element|function|null)",selector:"(string|element)"};class jC extends ls{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return LC}static get DefaultType(){return NC}static get NAME(){return MC}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,u]of Object.entries(this._config.content))this._setContent(e,u,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},IC)}_setContent(e,s,o){const i=fe.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(it(s)){this._putElementInTemplate(ft(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?OC(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return je(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const PC="tooltip",RC=new Set(["sanitize","allowList","sanitizeFn"]),Gs="fade",BC="modal",vs="show",FC=".tooltip-inner",yo=`.${BC}`,wo="hide.bs.modal",Yt="hover",Ys="focus",Js="click",VC="manual",UC="hide",WC="hidden",HC="show",zC="shown",qC="inserted",KC="click",XC="focusin",GC="focusout",YC="mouseenter",JC="mouseleave",QC={AUTO:"auto",TOP:"top",RIGHT:We()?"left":"right",BOTTOM:"bottom",LEFT:We()?"right":"left"},ZC={allowList:Ba,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},eE={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Kt extends Xe{constructor(e,s){if(typeof fa>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return ZC}static get DefaultType(){return eE}static get NAME(){return PC}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),G.off(this._element.closest(yo),wo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=G.trigger(this._element,this.constructor.eventName(HC)),o=(va(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:u}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(u.append(i),G.trigger(this._element,this.constructor.eventName(qC))),this._popper=this._createPopper(i),i.classList.add(vs),"ontouchstart"in document.documentElement)for(const h of[].concat(...document.body.children))G.on(h,"mouseover",$s);const f=()=>{G.trigger(this._element,this.constructor.eventName(zC)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(f,this.tip,this._isAnimated())}hide(){if(!this._isShown()||G.trigger(this._element,this.constructor.eventName(UC)).defaultPrevented)return;if(this._getTipElement().classList.remove(vs),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))G.off(i,"mouseover",$s);this._activeTrigger[Js]=!1,this._activeTrigger[Ys]=!1,this._activeTrigger[Yt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),G.trigger(this._element,this.constructor.eventName(WC)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Gs,vs),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=V0(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Gs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new jC({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[FC]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Gs)}_isShown(){return this.tip&&this.tip.classList.contains(vs)}_createPopper(e){const s=je(this._config.placement,[this,e,this._element]),o=QC[s.toUpperCase()];return Sn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return je(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...je(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")G.on(this._element,this.constructor.eventName(KC),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Js]=!(i._isShown()&&i._activeTrigger[Js]),i.toggle()});else if(s!==VC){const o=s===Yt?this.constructor.eventName(YC):this.constructor.eventName(XC),i=s===Yt?this.constructor.eventName(JC):this.constructor.eventName(GC);G.on(this._element,o,this._config.selector,u=>{const f=this._initializeOnDelegatedTarget(u);f._activeTrigger[u.type==="focusin"?Ys:Yt]=!0,f._enter()}),G.on(this._element,i,this._config.selector,u=>{const f=this._initializeOnDelegatedTarget(u);f._activeTrigger[u.type==="focusout"?Ys:Yt]=f._element.contains(u.relatedTarget),f._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},G.on(this._element.closest(yo),wo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=lt.getDataAttributes(this._element);for(const o of Object.keys(s))RC.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ft(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Kt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}qe(Kt);const tE="popover",sE=".popover-header",nE=".popover-body",oE={...Kt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},aE={...Kt.DefaultType,content:"(null|string|element|function)"};class Tn extends Kt{static get Default(){return oE}static get DefaultType(){return aE}static get NAME(){return tE}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[sE]:this._getTitle(),[nE]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=Tn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}qe(Tn);const iE="scrollspy",lE="bs.scrollspy",An=`.${lE}`,rE=".data-api",cE=`activate${An}`,ko=`click${An}`,uE=`load${An}${rE}`,dE="dropdown-item",At="active",fE='[data-bs-spy="scroll"]',Qs="[href]",mE=".nav, .list-group",$o=".nav-link",pE=".nav-item",vE=".list-group-item",hE=`${$o}, ${pE} > ${$o}, ${vE}`,gE=".dropdown",_E=".dropdown-toggle",bE={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},yE={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Os extends Xe{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return bE}static get DefaultType(){return yE}static get NAME(){return iE}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ft(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(G.off(this._config.target,ko),G.on(this._config.target,ko,Qs,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=f=>this._targetLinks.get(`#${f.target.id}`),o=f=>{this._previousScrollData.visibleEntryTop=f.target.offsetTop,this._process(s(f))},i=(this._rootElement||document.documentElement).scrollTop,u=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const f of e){if(!f.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(f));continue}const h=f.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(u&&h){if(o(f),!i)return;continue}!u&&!h&&o(f)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=fe.find(Qs,this._config.target);for(const s of e){if(!s.hash||mt(s))continue;const o=fe.findOne(decodeURI(s.hash),this._element);zt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(At),this._activateParents(e),G.trigger(this._element,cE,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(dE)){fe.findOne(_E,e.closest(gE)).classList.add(At);return}for(const s of fe.parents(e,mE))for(const o of fe.prev(s,hE))o.classList.add(At)}_clearActiveClass(e){e.classList.remove(At);const s=fe.find(`${Qs}.${At}`,e);for(const o of s)o.classList.remove(At)}static jQueryInterface(e){return this.each(function(){const s=Os.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(window,uE,()=>{for(const n of fe.find(fE))Os.getOrCreateInstance(n)});qe(Os);const wE="tab",kE="bs.tab",Ct=`.${kE}`,$E=`hide${Ct}`,SE=`hidden${Ct}`,xE=`show${Ct}`,CE=`shown${Ct}`,EE=`click${Ct}`,TE=`keydown${Ct}`,AE=`load${Ct}`,DE="ArrowLeft",So="ArrowRight",OE="ArrowUp",xo="ArrowDown",Zs="Home",Co="End",yt="active",Eo="fade",en="show",ME="dropdown",Fa=".dropdown-toggle",LE=".dropdown-menu",tn=`:not(${Fa})`,NE='.list-group, .nav, [role="tablist"]',IE=".nav-item, .list-group-item",jE=`.nav-link${tn}, .list-group-item${tn}, [role="tab"]${tn}`,Va='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',sn=`${jE}, ${Va}`,PE=`.${yt}[data-bs-toggle="tab"], .${yt}[data-bs-toggle="pill"], .${yt}[data-bs-toggle="list"]`;class Ft extends Xe{constructor(e){super(e),this._parent=this._element.closest(NE),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),G.on(this._element,TE,s=>this._keydown(s)))}static get NAME(){return wE}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?G.trigger(s,$E,{relatedTarget:e}):null;G.trigger(e,xE,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(yt),this._activate(fe.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(en);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),G.trigger(e,CE,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Eo))}_deactivate(e,s){if(!e)return;e.classList.remove(yt),e.blur(),this._deactivate(fe.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(en);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),G.trigger(e,SE,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Eo))}_keydown(e){if(![DE,So,OE,xo,Zs,Co].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!mt(i));let o;if([Zs,Co].includes(e.key))o=s[e.key===Zs?0:s.length-1];else{const i=[So,xo].includes(e.key);o=xn(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Ft.getOrCreateInstance(o).show())}_getChildren(){return fe.find(sn,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=fe.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(ME))return;const i=(u,f)=>{const h=fe.findOne(u,o);h&&h.classList.toggle(f,s)};i(Fa,yt),i(LE,en),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(yt)}_getInnerElement(e){return e.matches(sn)?e:fe.findOne(sn,e)}_getOuterElement(e){return e.closest(IE)||e}static jQueryInterface(e){return this.each(function(){const s=Ft.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}G.on(document,EE,Va,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!mt(this)&&Ft.getOrCreateInstance(this).show()});G.on(window,AE,()=>{for(const n of fe.find(PE))Ft.getOrCreateInstance(n)});qe(Ft);const RE="toast",BE="bs.toast",gt=`.${BE}`,FE=`mouseover${gt}`,VE=`mouseout${gt}`,UE=`focusin${gt}`,WE=`focusout${gt}`,HE=`hide${gt}`,zE=`hidden${gt}`,qE=`show${gt}`,KE=`shown${gt}`,XE="fade",To="hide",hs="show",gs="showing",GE={animation:"boolean",autohide:"boolean",delay:"number"},YE={animation:!0,autohide:!0,delay:5e3};class Ms extends Xe{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return YE}static get DefaultType(){return GE}static get NAME(){return RE}show(){if(G.trigger(this._element,qE).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(XE);const s=()=>{this._element.classList.remove(gs),G.trigger(this._element,KE),this._maybeScheduleHide()};this._element.classList.remove(To),is(this._element),this._element.classList.add(hs,gs),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||G.trigger(this._element,HE).defaultPrevented)return;const s=()=>{this._element.classList.add(To),this._element.classList.remove(gs,hs),G.trigger(this._element,zE)};this._element.classList.add(gs),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(hs),super.dispose()}isShown(){return this._element.classList.contains(hs)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){G.on(this._element,FE,e=>this._onInteraction(e,!0)),G.on(this._element,VE,e=>this._onInteraction(e,!1)),G.on(this._element,UE,e=>this._onInteraction(e,!0)),G.on(this._element,WE,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Ms.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Ts(Ms);qe(Ms);const JE={class:"modal-dialog modal-lg"},QE={class:"modal-content"},ZE={class:"modal-body"},eT={key:0,class:"text-center py-4"},tT={key:1,class:"alert alert-danger"},sT={key:2},nT={class:"mb-3"},oT={class:"small text-muted mb-2"},aT={key:0},iT={key:0,class:"alert alert-info"},lT={key:1},rT={class:"table table-sm table-striped"},cT={key:2,class:"mt-3"},uT={key:3,class:"mt-3"},dT={class:"modal-footer"},fT=["disabled"],mT={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,i=s,u=M(null);let f=null;const h=M(!1),p=M(""),m=M([]);de(u,g=>{g&&(f=new St(g),g.addEventListener("hidden.bs.modal",()=>{i("close")}))});function v(){f&&(f.show(),c())}function $(){f&&f.hide()}async function c(){h.value=!0,p.value="",m.value=[];try{const g=await be.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});m.value=g.permissions||[]}catch(g){console.error("Failed to load permissions:",g),p.value=g.response?.data?.detail||g.message||"Failed to load permissions"}finally{h.value=!1}}function d(){c()}function y(g){switch(g){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:v,hide:$}),(g,_)=>(l(),r("div",{ref_key:"modalRef",ref:u,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",JE,[t("div",QE,[_[9]||(_[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ZE,[h.value?(l(),r("div",eT,[..._[0]||(_[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(l(),r("div",tT,S(p.value),1)):(l(),r("div",sT,[t("div",nT,[_[2]||(_[2]=t("h6",null,"Settings Sources",-1)),t("div",oT,[_[1]||(_[1]=ce(" Loading permissions from: ",-1)),(l(!0),r(te,null,le(n.settingSources,(b,a)=>(l(),r("span",{key:b},[t("code",null,S(b),1),a<n.settingSources.length-1?(l(),r("span",aT,", ")):D("",!0)]))),128))])]),m.value.length===0?(l(),r("div",iT," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(l(),r("div",lT,[t("h6",null,"Pre-approved Permissions ("+S(m.value.length)+")",1),t("table",rT,[_[3]||(_[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(l(!0),r(te,null,le(m.value,b=>(l(),r("tr",{key:b.permission},[t("td",null,[t("code",null,S(b.permission),1)]),t("td",null,[(l(!0),r(te,null,le(b.sources,(a,w)=>(l(),r("span",{key:a,class:H(["badge me-1",y(a)])},S(a),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(l(),r("div",cT,[_[4]||(_[4]=t("h6",null,"Session Allowed Tools",-1)),_[5]||(_[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(l(!0),r(te,null,le(n.sessionAllowedTools,b=>(l(),r("span",{key:b,class:"badge bg-success me-1 mb-1"},S(b),1))),128))])])):D("",!0),n.sessionDisallowedTools.length>0?(l(),r("div",uT,[_[6]||(_[6]=t("h6",null,"Session Disallowed Tools",-1)),_[7]||(_[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(l(!0),r(te,null,le(n.sessionDisallowedTools,b=>(l(),r("span",{key:b,class:"badge bg-danger me-1 mb-1"},S(b),1))),128))])])):D("",!0)]))]),t("div",dT,[_[8]||(_[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:d,disabled:h.value}," Refresh ",8,fT)])])])],512))}},pT=se(mT,[["__scopeId","data-v-2078b366"]]),vT={class:"modal-dialog modal-lg modal-dialog-centered"},hT={class:"modal-content"},gT={class:"modal-header"},_T={id:"configurationModalLabel",class:"modal-title"},bT={class:"modal-body"},yT={key:0,class:"template-list-view"},wT={key:0,class:"alert alert-info"},kT={class:"card-body"},$T={class:"d-flex justify-content-between align-items-start"},ST={class:"flex-grow-1"},xT={class:"card-title mb-1"},CT={key:0,class:"card-text text-muted small mb-2"},ET={class:"template-meta"},TT={class:"badge bg-secondary me-2"},AT={class:"text-muted small"},DT={class:"btn-group btn-group-sm ms-3"},OT=["onClick"],MT=["onClick"],LT={key:1},NT={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},IT={class:"nav-item",role:"presentation"},jT={key:0,class:"error-indicator",title:"This tab has validation errors"},PT={class:"nav-item",role:"presentation"},RT={key:0,class:"error-indicator",title:"This tab has validation errors"},BT={class:"nav-item",role:"presentation"},FT={key:0,class:"error-indicator",title:"This tab has validation errors"},VT={class:"nav-item",role:"presentation"},UT={class:"tab-content"},WT={key:2,class:"alert alert-danger mt-3"},HT={key:0},zT={key:1},qT={class:"modal-footer"},KT={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},XT=["disabled"],GT={key:0,class:"spinner-border spinner-border-sm me-2"},YT={__name:"ConfigurationModal",setup(n){const e=ns(),s=ze(),o=ve(),i=xe(),u=M(null);let f=null;const h=M(null),p=M("create-session"),m=M("general"),v=M(null),$=M(null),c=M(null),d=M([]),y=M(null),g=M(null),_=M({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),b=Is({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),a=Is({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),w=Is({name:""}),x=k(()=>({general:!!w.name,permissions:!1,advanced:!1})),E=M(!1),T=M(""),A=k(()=>p.value==="create-session"||p.value==="edit-session"),L=k(()=>p.value==="edit-session"||p.value==="edit-template"),C=k(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),O=k(()=>E.value?L.value?"Saving...":"Creating...":L.value?"Save Changes":A.value?"Create Session":"Save Template"),V=k(()=>!(!a.name.trim()||A.value&&a.name.includes(" "))),P=k(()=>$.value?.state==="active"||$.value?.state==="starting"),F=k(()=>{if(!$.value)return!1;const B=(a.initialization_context||"")!==($.value.system_prompt||""),Z=(a.override_system_prompt||!1)!==($.value.override_system_prompt||!1),ae=(a.sandbox_enabled||!1)!==($.value.sandbox_enabled||!1);if(B||Z||ae)return!0;if(a.sandbox_enabled){const ke=$.value.sandbox_config||{},me=a.sandbox,Te=JSON.stringify({autoAllowBashIfSandboxed:ke.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:ke.allowUnsandboxedCommands??!1,excludedCommands:(ke.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:ke.enableWeakerNestedSandbox??!1,network:{allowedDomains:(ke.network?.allowedDomains||[]).join(", "),allowLocalBinding:ke.network?.allowLocalBinding??!1,allowUnixSockets:(ke.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:ke.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(ke.ignoreViolations?.file||[]).join(", "),network:(ke.ignoreViolations?.network||[]).join(", ")}}),Ae=JSON.stringify({autoAllowBashIfSandboxed:me.autoAllowBashIfSandboxed,allowUnsandboxedCommands:me.allowUnsandboxedCommands,excludedCommands:me.excludedCommands,enableWeakerNestedSandbox:me.enableWeakerNestedSandbox,network:{allowedDomains:me.network.allowedDomains,allowLocalBinding:me.network.allowLocalBinding,allowUnixSockets:me.network.allowUnixSockets,allowAllUnixSockets:me.network.allowAllUnixSockets},ignoreViolations:{file:me.ignoreViolations.file,network:me.ignoreViolations.network}});if(Te!==Ae)return!0}return!1}),U=k(()=>{if(!$.value)return!1;const B=(a.model||"sonnet")!==($.value.model||"sonnet"),Z=(a.allowed_tools||"")!==($.value.allowed_tools?.join(", ")||""),ae=$.value.setting_sources||["user","project","local"],ke=a.setting_sources||["user","project","local"],me=JSON.stringify([...ae].sort())!==JSON.stringify([...ke].sort());return B||Z||me}),X=k(()=>F.value?"reset":U.value?"restart":null),I=k(()=>p.value==="edit-session"&&P.value&&X.value!==null),N=k(()=>$.value?.working_directory?$.value.working_directory:a.working_directory?a.working_directory:s.projects.get(v.value)?.working_directory||""),K=k(()=>!a.allowed_tools||!a.allowed_tools.trim()?[]:a.allowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0)),R=k(()=>!a.disallowed_tools||!a.disallowed_tools.trim()?[]:a.disallowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0));function q(){h.value&&h.value.show()}function ee(){const B=Z=>Z.split(",").map(ae=>ae.trim()).filter(ae=>ae.length>0);return{autoAllowBashIfSandboxed:a.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:a.sandbox.allowUnsandboxedCommands,excludedCommands:B(a.sandbox.excludedCommands),enableWeakerNestedSandbox:a.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:B(a.sandbox.network.allowedDomains),allowLocalBinding:a.sandbox.network.allowLocalBinding,allowUnixSockets:B(a.sandbox.network.allowUnixSockets),allowAllUnixSockets:a.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:B(a.sandbox.ignoreViolations.file),network:B(a.sandbox.ignoreViolations.network)}}}function ue(B,Z){a[B]=Z,B==="name"&&(w.name="")}function ie(B){y.value=B,ge()}async function he(){try{const B=await be.get("/api/templates");d.value=B||[]}catch(B){console.error("Failed to load templates:",B),d.value=[]}}function ge(){if(!y.value){a.default_role="",a.initialization_context="",a.permission_mode="default",a.allowed_tools="",a.disallowed_tools="",a.model="sonnet",a.capabilities="",a.override_system_prompt=!1,a.sandbox_enabled=!1,a.sandbox.autoAllowBashIfSandboxed=!0,a.sandbox.allowUnsandboxedCommands=!1,a.sandbox.excludedCommands="",a.sandbox.enableWeakerNestedSandbox=!1,a.sandbox.network.allowedDomains="",a.sandbox.network.allowLocalBinding=!1,a.sandbox.network.allowUnixSockets="",a.sandbox.network.allowAllUnixSockets=!1,a.sandbox.ignoreViolations.file="",a.sandbox.ignoreViolations.network="",b.default_role="normal",b.initialization_context="normal",b.permission_mode="normal",b.allowed_tools="normal",b.disallowed_tools="normal",b.model="normal",b.capabilities="normal",b.sandbox_excludedCommands="normal",b.sandbox_network_allowedDomains="normal",b.sandbox_network_allowUnixSockets="normal",b.sandbox_ignoreViolations_file="normal",b.sandbox_ignoreViolations_network="normal",_.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const B=d.value.find(Ye=>Ye.template_id===y.value);if(!B)return;if(b.default_role="normal",b.initialization_context="normal",b.permission_mode="normal",b.allowed_tools="normal",b.disallowed_tools="normal",b.model="normal",b.capabilities="normal",b.sandbox_excludedCommands="normal",b.sandbox_network_allowedDomains="normal",b.sandbox_network_allowUnixSockets="normal",b.sandbox_ignoreViolations_file="normal",b.sandbox_ignoreViolations_network="normal",B.default_role?(a.default_role=B.default_role,_.value.default_role=B.default_role,b.default_role="autofilled"):(a.default_role="",_.value.default_role=null),B.default_system_prompt?(a.initialization_context=B.default_system_prompt,_.value.initialization_context=B.default_system_prompt,b.initialization_context="autofilled"):(a.initialization_context="",_.value.initialization_context=null),B.permission_mode?(a.permission_mode=B.permission_mode,_.value.permission_mode=B.permission_mode,b.permission_mode="autofilled"):(a.permission_mode="default",_.value.permission_mode=null),B.allowed_tools&&B.allowed_tools.length>0){const Ye=B.allowed_tools.join(", ");a.allowed_tools=Ye,_.value.allowed_tools=Ye,b.allowed_tools="autofilled"}else a.allowed_tools="",_.value.allowed_tools=null;if(B.disallowed_tools&&B.disallowed_tools.length>0){const Ye=B.disallowed_tools.join(", ");a.disallowed_tools=Ye,_.value.disallowed_tools=Ye,b.disallowed_tools="autofilled"}else a.disallowed_tools="",_.value.disallowed_tools=null;if(B.model?(a.model=B.model,_.value.model=B.model,b.model="autofilled"):(a.model="sonnet",_.value.model=null),B.capabilities&&B.capabilities.length>0){const Ye=B.capabilities.join(", ");a.capabilities=Ye,_.value.capabilities=Ye,b.capabilities="autofilled"}else a.capabilities="",_.value.capabilities=null;a.override_system_prompt=B.override_system_prompt||!1,a.sandbox_enabled=B.sandbox_enabled||!1;const Z=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=Z.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=Z.allowUnsandboxedCommands??!1,a.sandbox.enableWeakerNestedSandbox=Z.enableWeakerNestedSandbox??!1;const ae=Z.network||{};a.sandbox.network.allowLocalBinding=ae.allowLocalBinding??!1,a.sandbox.network.allowAllUnixSockets=ae.allowAllUnixSockets??!1;const ke=(Z.excludedCommands||[]).join(", ");a.sandbox.excludedCommands=ke,_.value.sandbox_excludedCommands=ke||null,ke&&(b.sandbox_excludedCommands="autofilled");const me=(ae.allowedDomains||[]).join(", ");a.sandbox.network.allowedDomains=me,_.value.sandbox_network_allowedDomains=me||null,me&&(b.sandbox_network_allowedDomains="autofilled");const Te=(ae.allowUnixSockets||[]).join(", ");a.sandbox.network.allowUnixSockets=Te,_.value.sandbox_network_allowUnixSockets=Te||null,Te&&(b.sandbox_network_allowUnixSockets="autofilled");const Ae=Z.ignoreViolations||{},Ls=(Ae.file||[]).join(", ");a.sandbox.ignoreViolations.file=Ls,_.value.sandbox_ignoreViolations_file=Ls||null,Ls&&(b.sandbox_ignoreViolations_file="autofilled");const Ns=(Ae.network||[]).join(", ");a.sandbox.ignoreViolations.network=Ns,_.value.sandbox_ignoreViolations_network=Ns||null,Ns&&(b.sandbox_ignoreViolations_network="autofilled")}function z(){const Z=(v.value?s.projects.get(v.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:Z,currentPath:a.working_directory||"",onSelect:ae=>{a.working_directory=ae}})}function j(){p.value==="create-session"&&(g.value={mode:"create-session",projectId:v.value,formData:{...a},selectedTemplateId:y.value}),p.value="template-list",we()}function W(){p.value="create-template",we(),m.value="general"}function Q(B){p.value="edit-template",c.value=B,we(),at(B),m.value="general"}async function J(B){if(confirm(`Delete template "${B.name}"?

This action cannot be undone.`))try{await be.delete(`/api/templates/${B.template_id}`),await he()}catch(Z){console.error("Failed to delete template:",Z),T.value=Z.response?.data?.detail||"Failed to delete template"}}function oe(){let B=!0;return w.name="",a.name.trim()||(w.name="Name is required",B=!1),A.value&&a.name.includes(" ")&&(w.name="Session name must be a single word (no spaces)",B=!1),B}async function Se(){if(!oe()){w.name&&(m.value="general");return}E.value=!0,T.value="";try{switch(p.value){case"create-session":await ot(),f&&f.hide();break;case"edit-session":await Y(),f&&f.hide();break;case"create-template":await re();break;case"edit-template":await _e();break}}catch(B){console.error("Submit failed:",B),T.value=B.response?.data?.detail||B.message||"Operation failed. Please try again."}finally{E.value=!1}}async function ot(){if(!v.value)throw new Error("Project ID is missing");const B=a.allowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),Z=a.disallowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ae=a.capabilities.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ke={name:a.name.trim(),model:a.model||null,role:a.default_role.trim()||null,initialization_context:a.initialization_context.trim()||null,override_system_prompt:a.override_system_prompt,capabilities:ae.length>0?ae:null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:Z.length>0?Z:null,working_directory:a.working_directory.trim()||null,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?ee():null,setting_sources:a.setting_sources},me=await be.post(`/api/legions/${v.value}/minions`,ke);if(me.success&&me.minion_id)await s.fetchProjects(),await o.fetchSessions(),a.startImmediately&&await o.startSession(me.minion_id),e.push(`/session/${me.minion_id}`);else throw new Error("Failed to create session")}async function Y(){if(!$.value)throw new Error("Session data is missing");const B=$.value.session_id,Z=$.value.state==="active"||$.value.state==="starting",ae=a.allowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),ke=a.disallowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),me=a.capabilities.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),Te={name:a.name.trim(),model:a.model,role:a.default_role.trim()||null,system_prompt:a.initialization_context.trim()||null,override_system_prompt:a.override_system_prompt,allowed_tools:ae.length>0?ae:null,disallowed_tools:ke.length>0?ke:null,capabilities:me.length>0?me:null,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?ee():null,setting_sources:a.setting_sources};await o.patchSession(B,Te),Z&&a.permission_mode!==$.value.current_permission_mode&&await o.setPermissionMode(B,a.permission_mode)}async function re(){const B=a.allowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),Z=a.disallowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),ae=a.capabilities.split(",").map(me=>me.trim()).filter(me=>me.length>0),ke={name:a.name.trim(),description:a.description.trim()||null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:Z.length>0?Z:null,default_role:a.default_role.trim()||null,default_system_prompt:a.initialization_context.trim()||null,model:a.model||null,capabilities:ae.length>0?ae:null,override_system_prompt:a.override_system_prompt,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?ee():null};await be.post("/api/templates",ke),await he(),p.value="template-list",we()}async function _e(){if(!c.value)throw new Error("Template data is missing");const B=a.allowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),Z=a.disallowed_tools.split(",").map(me=>me.trim()).filter(me=>me.length>0),ae=a.capabilities.split(",").map(me=>me.trim()).filter(me=>me.length>0),ke={name:a.name.trim(),description:a.description.trim()||null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:Z.length>0?Z:null,default_role:a.default_role.trim()||null,default_system_prompt:a.initialization_context.trim()||null,model:a.model||null,capabilities:ae.length>0?ae:null,override_system_prompt:a.override_system_prompt,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?ee():null};await be.put(`/api/templates/${c.value.template_id}`,ke),await he(),p.value="template-list",c.value=null,we()}function we(){a.name="",a.model="sonnet",a.permission_mode="default",a.working_directory="",a.description="",a.default_role="",a.startImmediately=!0,a.allowed_tools="",a.disallowed_tools="",a.capabilities="",a.setting_sources=["user","project","local"],a.system_prompt="",a.override_system_prompt=!1,a.initialization_context="",a.sandbox_enabled=!1,a.sandbox.autoAllowBashIfSandboxed=!0,a.sandbox.allowUnsandboxedCommands=!1,a.sandbox.excludedCommands="",a.sandbox.enableWeakerNestedSandbox=!1,a.sandbox.network.allowedDomains="",a.sandbox.network.allowLocalBinding=!1,a.sandbox.network.allowUnixSockets="",a.sandbox.network.allowAllUnixSockets=!1,a.sandbox.ignoreViolations.file="",a.sandbox.ignoreViolations.network="",w.name="",b.default_role="normal",b.initialization_context="normal",b.permission_mode="normal",b.allowed_tools="normal",b.disallowed_tools="normal",b.model="normal",b.capabilities="normal",b.sandbox_excludedCommands="normal",b.sandbox_network_allowedDomains="normal",b.sandbox_network_allowUnixSockets="normal",b.sandbox_ignoreViolations_file="normal",b.sandbox_ignoreViolations_network="normal",_.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},y.value=null,T.value="",m.value="general"}function Ee(B){a.name=B.name||"",a.model=B.model||"sonnet",a.permission_mode=B.current_permission_mode||"default",a.working_directory=B.working_directory||"",a.default_role=B.role||"",a.initialization_context=B.system_prompt||"",a.override_system_prompt=B.override_system_prompt||!1,a.system_prompt="",a.allowed_tools=B.allowed_tools?.join(", ")||"",a.disallowed_tools=B.disallowed_tools?.join(", ")||"",a.capabilities=B.capabilities?.join(", ")||"",a.sandbox_enabled=B.sandbox_enabled||!1,a.setting_sources=B.setting_sources||["user","project","local"];const Z=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=Z.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=Z.allowUnsandboxedCommands??!1,a.sandbox.excludedCommands=(Z.excludedCommands||[]).join(", "),a.sandbox.enableWeakerNestedSandbox=Z.enableWeakerNestedSandbox??!1;const ae=Z.network||{};a.sandbox.network.allowedDomains=(ae.allowedDomains||[]).join(", "),a.sandbox.network.allowLocalBinding=ae.allowLocalBinding??!1,a.sandbox.network.allowUnixSockets=(ae.allowUnixSockets||[]).join(", "),a.sandbox.network.allowAllUnixSockets=ae.allowAllUnixSockets??!1;const ke=Z.ignoreViolations||{};a.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),a.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function at(B){a.name=B.name||"",a.description=B.description||"",a.permission_mode=B.permission_mode||"default",a.default_role=B.default_role||"",a.initialization_context=B.default_system_prompt||"",a.allowed_tools=B.allowed_tools?.join(", ")||"",a.disallowed_tools=B.disallowed_tools?.join(", ")||"",a.model=B.model||"sonnet",a.capabilities=B.capabilities?.join(", ")||"",a.override_system_prompt=B.override_system_prompt||!1,a.sandbox_enabled=B.sandbox_enabled||!1;const Z=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=Z.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=Z.allowUnsandboxedCommands??!1,a.sandbox.excludedCommands=(Z.excludedCommands||[]).join(", "),a.sandbox.enableWeakerNestedSandbox=Z.enableWeakerNestedSandbox??!1;const ae=Z.network||{};a.sandbox.network.allowedDomains=(ae.allowedDomains||[]).join(", "),a.sandbox.network.allowLocalBinding=ae.allowLocalBinding??!1,a.sandbox.network.allowUnixSockets=(ae.allowUnixSockets||[]).join(", "),a.sandbox.network.allowAllUnixSockets=ae.allowAllUnixSockets??!1;const ke=Z.ignoreViolations||{};a.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),a.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function Ge(){rt(()=>{const B=document.getElementById("config-name");B&&(B.focus(),L.value&&B.select())})}function _t(){we(),p.value="create-session",v.value=null,$.value=null,c.value=null,i.hideModal()}return de(()=>i.currentModal,async(B,Z)=>{if(!(!B||!f)){if(B.name==="configuration"){const ae=B.data||{};p.value=ae.mode||"create-session",v.value=ae.project?.project_id||ae.projectId||null,$.value=ae.session||null,c.value=ae.template||null,we(),p.value==="create-session"&&await he(),p.value==="edit-session"&&$.value?Ee($.value):p.value==="edit-template"&&c.value&&at(c.value),f.show()}else if(B.name==="create-minion"||B.name==="create-session"){const ae=B.data||{};p.value="create-session",v.value=ae.project?.project_id||null,$.value=null,c.value=null,we(),await he(),f.show()}else if(B.name==="edit-session"){const ae=B.data||{};p.value="edit-session",$.value=ae.session||null,v.value=$.value?.project_id||null,c.value=null,we(),$.value&&Ee($.value),f.show()}else B.name==="template-management"&&(p.value="template-list",we(),await he(),f.show());Z?.name==="configuration"&&Z.data?.mode?.includes("template")&&B?.name==="configuration"&&p.value==="create-session"&&await he()}}),de(()=>a.default_role,B=>{_.value.default_role!==null&&(b.default_role=B===_.value.default_role?"autofilled":"modified")}),de(()=>a.initialization_context,B=>{_.value.initialization_context!==null&&(b.initialization_context=B===_.value.initialization_context?"autofilled":"modified")}),de(()=>a.permission_mode,B=>{_.value.permission_mode!==null&&(b.permission_mode=B===_.value.permission_mode?"autofilled":"modified")}),de(()=>a.allowed_tools,B=>{_.value.allowed_tools!==null&&(b.allowed_tools=B===_.value.allowed_tools?"autofilled":"modified")}),de(()=>a.disallowed_tools,B=>{_.value.disallowed_tools!==null&&(b.disallowed_tools=B===_.value.disallowed_tools?"autofilled":"modified")}),de(()=>a.model,B=>{_.value.model!==null&&(b.model=B===_.value.model?"autofilled":"modified")}),de(()=>a.capabilities,B=>{_.value.capabilities!==null&&(b.capabilities=B===_.value.capabilities?"autofilled":"modified")}),de(()=>a.sandbox.excludedCommands,B=>{_.value.sandbox_excludedCommands!==null&&(b.sandbox_excludedCommands=B===_.value.sandbox_excludedCommands?"autofilled":"modified")}),de(()=>a.sandbox.network.allowedDomains,B=>{_.value.sandbox_network_allowedDomains!==null&&(b.sandbox_network_allowedDomains=B===_.value.sandbox_network_allowedDomains?"autofilled":"modified")}),de(()=>a.sandbox.network.allowUnixSockets,B=>{_.value.sandbox_network_allowUnixSockets!==null&&(b.sandbox_network_allowUnixSockets=B===_.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),de(()=>a.sandbox.ignoreViolations.file,B=>{_.value.sandbox_ignoreViolations_file!==null&&(b.sandbox_ignoreViolations_file=B===_.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),de(()=>a.sandbox.ignoreViolations.network,B=>{_.value.sandbox_ignoreViolations_network!==null&&(b.sandbox_ignoreViolations_network=B===_.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),Oe(()=>{u.value&&Le(()=>import("./modal-D6mKceGM.js").then(B=>B.m),__vite__mapDeps([0,1])).then(B=>{const Z=B.default;f=new Z(u.value),u.value.addEventListener("shown.bs.modal",Ge),u.value.addEventListener("hidden.bs.modal",_t)})}),De(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",Ge),u.value.removeEventListener("hidden.bs.modal",_t)),f&&f.dispose()}),(B,Z)=>(l(),r(te,null,[t("div",{ref_key:"modalElement",ref:u,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",vT,[t("div",hT,[t("div",gT,[t("h5",_T,[p.value==="create-template"||p.value==="edit-template"?(l(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:j,title:"Back to template list"}," â† ")):D("",!0),ce(" "+S(C.value),1)]),Z[4]||(Z[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",bT,[p.value==="template-list"?(l(),r("div",yT,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[Z[5]||(Z[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:W,class:"btn btn-primary btn-sm"}," + Create New ")]),d.value.length===0?(l(),r("div",wT," No templates found. Create your first template! ")):D("",!0),(l(!0),r(te,null,le(d.value,ae=>(l(),r("div",{key:ae.template_id,class:"card mb-2"},[t("div",kT,[t("div",$T,[t("div",ST,[t("h6",xT,S(ae.name),1),ae.description?(l(),r("p",CT,S(ae.description),1)):D("",!0),t("div",ET,[t("span",TT,S(ae.permission_mode),1),t("span",AT,S(ae.allowed_tools?.length||0)+" tools",1)])]),t("div",DT,[t("button",{onClick:ke=>Q(ae),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,OT),t("button",{onClick:ke=>J(ae),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,MT)])])])]))),128))])):(l(),r("div",LT,[t("ul",NT,[t("li",IT,[t("button",{class:H(["nav-link",{active:m.value==="general","has-error":x.value.general}]),type:"button",onClick:Z[0]||(Z[0]=ae=>m.value="general")},[Z[6]||(Z[6]=ce(" General ",-1)),x.value.general?(l(),r("span",jT)):D("",!0)],2)]),t("li",PT,[t("button",{class:H(["nav-link",{active:m.value==="permissions","has-error":x.value.permissions}]),type:"button",onClick:Z[1]||(Z[1]=ae=>m.value="permissions")},[Z[7]||(Z[7]=ce(" Permissions ",-1)),x.value.permissions?(l(),r("span",RT)):D("",!0)],2)]),t("li",BT,[t("button",{class:H(["nav-link",{active:m.value==="advanced","has-error":x.value.advanced}]),type:"button",onClick:Z[2]||(Z[2]=ae=>m.value="advanced")},[Z[8]||(Z[8]=ce(" Advanced ",-1)),x.value.advanced?(l(),r("span",FT)):D("",!0)],2)]),t("li",VT,[t("button",{class:H(["nav-link",{active:m.value==="sandbox"}]),type:"button",onClick:Z[3]||(Z[3]=ae=>m.value="sandbox")}," Sandbox ",2)])]),t("div",UT,[$e(ye(Sk,{mode:p.value,"form-data":a,errors:w,templates:d.value,"selected-template-id":y.value,session:$.value,"field-states":b,"onUpdate:formData":ue,"onUpdate:selectedTemplateId":ie,onOpenFolderBrowser:z,onOpenTemplateManager:j},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[Je,m.value==="general"]]),$e(ye(u$,{mode:p.value,"form-data":a,errors:w,session:$.value,"field-states":b,"onUpdate:formData":ue,onPreviewPermissions:q},null,8,["mode","form-data","errors","session","field-states"]),[[Je,m.value==="permissions"]]),$e(ye(A$,{mode:p.value,"form-data":a,errors:w,session:$.value,"field-states":b,"onUpdate:formData":ue},null,8,["mode","form-data","errors","session","field-states"]),[[Je,m.value==="advanced"]]),$e(ye(e0,{mode:p.value,"form-data":a,errors:w,session:$.value,"field-states":b,"onUpdate:formData":ue},null,8,["mode","form-data","errors","session","field-states"]),[[Je,m.value==="sandbox"]])])])),T.value?(l(),r("div",WT,S(T.value),1)):D("",!0)]),I.value?(l(),r("div",{key:0,class:H(["warning-banner","warning-banner-"+X.value])},[X.value==="reset"?(l(),r("small",HT,[...Z[9]||(Z[9]=[ce(" Changes require a ",-1),t("strong",null,"reset",-1),ce(" to take effect. This starts a new conversation. ",-1)])])):(l(),r("small",zT,[...Z[10]||(Z[10]=[ce(" Changes require a ",-1),t("strong",null,"restart",-1),ce(" to take effect. ",-1)])]))],2)):D("",!0),t("div",qT,[t("button",KT,S(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(l(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:E.value||!V.value,onClick:Se},[E.value?(l(),r("span",GT)):D("",!0),ce(" "+S(O.value),1)],8,XT)):D("",!0)])])])],512),ye(pT,{ref_key:"permissionPreviewModal",ref:h,"working-directory":N.value,"setting-sources":a.setting_sources,"session-allowed-tools":K.value,"session-disallowed-tools":R.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},JT=se(YT,[["__scopeId","data-v-da2afdcd"]]),QT={class:"modal-dialog modal-dialog-centered"},ZT={class:"modal-content"},e2={class:"modal-header"},t2={class:"modal-title",id:"manageSessionModalLabel"},s2={class:"modal-body"},n2={key:0,class:"text-center py-4"},o2={class:"text-muted"},a2={key:1},i2={key:2},l2={class:"text-muted"},r2={key:0,class:"text-center py-2"},c2={key:1,class:"alert alert-warning mt-3"},u2={class:"mb-0 mt-2"},d2={key:0,class:"text-muted"},f2={key:3},m2={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},p2={class:"d-grid gap-2"},v2=["disabled"],h2=["disabled"],g2=["disabled"],_2=["disabled"],b2={class:"modal-footer"},y2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},w2={__name:"SessionManageModal",setup(n){const e=ns(),s=ve(),o=xe(),i=nt();Pe();const u=M(null),f=M(!1),h=M(""),p=M(""),m=M(null),v=M(null);let $=null;const c=M([]),d=M(!1),y=k(()=>m.value==="reset"?"Reset Session":m.value==="delete"?"Delete Session":"Manage Session");function g(){m.value="reset"}async function _(){if(m.value="delete",c.value=[],!!u.value){d.value=!0;try{const C=await be.get(`/api/sessions/${u.value.session_id}/descendants`);c.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),c.value=[]}finally{d.value=!1}}}function b(){m.value=null}async function a(){m.value==="reset"?await E():m.value==="delete"&&await T()}async function w(){if(u.value){f.value=!0,h.value="Restarting session...";try{const C=u.value.session_id,O=s.currentSessionId===C,V=await be.post(`/api/sessions/${C}/restart`);if(V.success)console.log("Session restarted successfully"),O&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),$&&$.hide();else{const P=V.error||V.detail||"Failed to restart session";console.error("Failed to restart session:",P),p.value=`Failed to restart session: ${P}`}}catch(C){console.error("Error restarting session:",C);const O=C.data?.detail||C.message||"Unknown error";p.value=`Error restarting session: ${O}`}finally{f.value=!1}}}async function x(){if(u.value)try{$&&$.hide(),console.log("Ending session",u.value.session_id);const C=u.value.session_id;await be.post(`/api/sessions/${C}/terminate`),s.currentSessionId===C&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),s.currentSessionId===u.value?.session_id&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function E(){if(u.value){f.value=!0,h.value="Resetting session...";try{const C=u.value.session_id,O=s.currentSessionId===C,V=await be.post(`/api/sessions/${C}/reset`);if(V.success)console.log("Session reset successfully"),O&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),$&&$.hide();else{const P=V.error||V.detail||"Failed to reset session";console.error("Failed to reset session:",P),p.value=`Failed to reset session: ${P}`,m.value=null}}catch(C){console.error("Error resetting session:",C);const O=C.data?.detail||C.message||"Unknown error";p.value=`Error resetting session: ${O}`,m.value=null}finally{f.value=!1}}}async function T(){if(u.value){f.value=!0,h.value="Deleting session...";try{const C=u.value.session_id;await s.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),$&&$.hide()}catch(C){console.error("Error deleting session:",C);const O=C.data?.detail||C.message||"Unknown error";p.value=`Error deleting session: ${O}`,m.value=null}finally{f.value=!1}}}function A(){m.value=null,f.value=!1,h.value="",p.value="",c.value=[],d.value=!1}function L(){A(),u.value=null,o.hideModal()}return de(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&$){const O=C.data||{};u.value=O.session,A(),$.show()}}),Oe(()=>{v.value&&Le(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(O=>O.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{$=new C(v.value),v.value.addEventListener("hidden.bs.modal",L)})}),De(()=>{v.value&&v.value.removeEventListener("hidden.bs.modal",L),$&&$.dispose()}),(C,O)=>(l(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:v},[t("div",QT,[t("div",ZT,[t("div",e2,[t("h5",t2,S(m.value?y.value:"Manage Session"),1),O[1]||(O[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",s2,[f.value?(l(),r("div",n2,[O[2]||(O[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",o2,S(h.value),1)])):m.value==="reset"?(l(),r("div",a2,[...O[3]||(O[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):m.value==="delete"?(l(),r("div",i2,[O[9]||(O[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",l2,[O[4]||(O[4]=ce("This will permanently delete session ",-1)),t("strong",null,S(u.value?.name),1),O[5]||(O[5]=ce(".",-1))]),O[10]||(O[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),d.value?(l(),r("div",r2,[...O[6]||(O[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):c.value.length>0?(l(),r("div",c2,[O[7]||(O[7]=t("strong",null,"Cascading Deletion:",-1)),O[8]||(O[8]=ce(" This session has ",-1)),t("strong",null,S(c.value.length),1),ce(" child session"+S(c.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",u2,[(l(!0),r(te,null,le(c.value,V=>(l(),r("li",{key:V.session_id,class:"small"},[t("strong",null,S(V.name||V.session_id),1),V.role?(l(),r("span",d2," ("+S(V.role)+")",1)):D("",!0)]))),128))])])):D("",!0)])):(l(),r("div",f2,[p.value?(l(),r("div",m2,[O[11]||(O[11]=t("strong",null,"Error:",-1)),ce(" "+S(p.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:O[0]||(O[0]=V=>p.value="")})])):D("",!0),O[18]||(O[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",p2,[t("button",{class:"btn btn-outline-primary text-start",onClick:w,disabled:f.value},[...O[12]||(O[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,v2),t("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:f.value},[...O[13]||(O[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,h2),O[16]||(O[16]=t("hr",{class:"my-2"},null,-1)),O[17]||(O[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:g,disabled:f.value},[...O[14]||(O[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,g2),t("button",{class:"btn btn-outline-danger text-start",onClick:_,disabled:f.value},[...O[15]||(O[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,_2)]),O[19]||(O[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ce(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",b2,[m.value&&!f.value?(l(),r(te,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:b},"Cancel"),t("button",{type:"button",class:H(["btn",m.value==="delete"?"btn-danger":"btn-warning"]),onClick:a},S(m.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):f.value?D("",!0):(l(),r("button",y2,"Cancel"))])])])],512))}},k2=se(w2,[["__scopeId","data-v-6b832853"]]),$2={class:"modal-dialog modal-dialog-centered modal-lg"},S2={class:"modal-content"},x2={class:"modal-body"},C2={key:0,class:"text-center text-muted py-4"},E2={key:1},T2={class:"mb-3"},A2={class:"font-monospace small"},D2={class:"mb-3"},O2=["value"],M2={class:"mb-3"},L2={class:"mb-3"},N2={class:"mb-3"},I2={key:0},j2={class:"d-flex flex-wrap gap-1"},P2={key:1,class:"text-muted small"},R2={key:0,class:"mb-3"},B2={class:"d-flex flex-wrap gap-1"},F2={key:1,class:"mb-3"},V2={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},U2={class:"mb-3"},W2={class:"text-muted"},H2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},z2={__name:"SessionInfoModal",setup(n){const e=ve(),s=Pe(),o=xe(),i=M(null),u=M(!1),f=M(null);let h=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},m=k(()=>{if(!i.value)return null;const g=e.initData.get(i.value);return g||(s.messagesBySession.get(i.value)||[]).find(a=>a.type==="system"&&(a.subtype==="init"||a.metadata?.subtype==="init")&&a.metadata?.init_data)?.metadata?.init_data||null});function v(g){return g?p[g]||g:"Default (Sonnet 4.5)"}function $(g){return typeof g=="string"?g:typeof g=="object"&&g.type==="preset"?`Preset: ${g.preset}`:JSON.stringify(g,null,2)}function c(g){g.target.select()}function d(){i.value=null,u.value=!1}function y(){d(),o.hideModal()}return de(()=>o.currentModal,g=>{if(g?.name==="session-info"&&h){const _=g.data||{};i.value=_.sessionId,u.value=!1,h.show()}}),Oe(()=>{f.value&&Le(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{h=new g(f.value),f.value.addEventListener("hidden.bs.modal",y)})}),De(()=>{f.value&&f.value.removeEventListener("hidden.bs.modal",y),h&&h.dispose()}),(g,_)=>(l(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[t("div",$2,[t("div",S2,[_[9]||(_[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",x2,[m.value?(l(),r("div",E2,[t("div",T2,[_[1]||(_[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",A2,S(i.value),1)]),t("div",D2,[_[2]||(_[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:m.value.cwd||"Not specified",readonly:"",onClick:c},null,8,O2)]),t("div",M2,[_[3]||(_[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,S(v(m.value.model)),1)]),t("div",L2,[_[4]||(_[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,S(m.value.permissionMode||"default"),1)]),t("div",N2,[_[5]||(_[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(m.value.allowed_tools||m.value.tools)&&(m.value.allowed_tools||m.value.tools).length>0?(l(),r("div",I2,[t("div",j2,[(l(!0),r(te,null,le(m.value.allowed_tools||m.value.tools,b=>(l(),r("span",{key:b,class:"badge bg-secondary"},S(b),1))),128))])])):(l(),r("div",P2,"No pre-authorized tools (will prompt for permissions)"))]),m.value.commands&&m.value.commands.length>0?(l(),r("div",R2,[_[6]||(_[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",B2,[(l(!0),r(te,null,le(m.value.commands,b=>(l(),r("span",{key:b,class:"badge bg-info"},S(b),1))),128))])])):D("",!0),m.value.systemPrompt?(l(),r("div",F2,[_[7]||(_[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",V2,S($(m.value.systemPrompt)),1)])):D("",!0),t("div",U2,[t("h6",W2,[_[8]||(_[8]=ce(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:_[0]||(_[0]=b=>u.value=!u.value)},S(u.value?"Hide":"Show"),1)]),u.value?(l(),r("pre",H2,S(JSON.stringify(m.value,null,2)),1)):D("",!0)])])):(l(),r("div",C2," No session configuration data available "))]),_[10]||(_[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},q2=se(z2,[["__scopeId","data-v-b28b39b3"]]),K2={class:"modal-dialog modal-dialog-centered modal-lg"},X2={class:"modal-content"},G2={class:"modal-body"},Y2={key:0,class:"text-center text-muted py-4"},J2={key:1},Q2={class:"mb-3"},Z2={class:"mb-3"},eA={class:"font-monospace small"},tA={class:"mb-3"},sA={class:"mb-3"},nA={class:"mb-3"},oA={key:0},aA={class:"d-flex flex-wrap gap-1"},iA={key:1,class:"text-muted small"},lA={class:"mb-3"},rA={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},cA={key:1,class:"text-muted small"},uA={class:"mb-3"},dA={key:0,class:"badge bg-info"},fA={key:1,class:"badge bg-secondary"},mA={class:"mb-3"},pA={key:0,class:"font-monospace small"},vA={key:1,class:"text-muted small"},hA={key:0,class:"mb-3"},gA={key:0},_A={class:"list-unstyled mb-0"},bA={key:1,class:"text-muted small"},yA={class:"mb-3"},wA={class:"small"},kA={class:"mb-3"},$A={class:"small"},SA={__name:"MinionViewModal",setup(n){const e=xe(),s=M(null),o=M(null);let i=null;function u(m){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[m]||"bg-secondary"}function f(m){if(!m)return"N/A";try{const v=new Date(m);return isNaN(v.getTime())?"Invalid date":v.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(v){return console.error("Error formatting timestamp:",v),"Invalid date"}}function h(){s.value=null}function p(){h(),e.hideModal()}return de(()=>e.currentModal,m=>{if(m?.name==="minion-view"&&i){const v=m.data||{};s.value=v.session,i.show()}}),Oe(()=>{o.value&&Le(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(v=>v.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{i=new m(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),De(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(m,v)=>(l(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",K2,[t("div",X2,[v[11]||(v[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",G2,[s.value?(l(),r("div",J2,[t("div",Q2,[v[0]||(v[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,S(s.value.name||"Unnamed Minion"),1)]),t("div",Z2,[v[1]||(v[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",eA,S(s.value.session_id),1)]),t("div",tA,[v[2]||(v[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,S(s.value.role||"Not specified"),1)]),t("div",sA,[v[3]||(v[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:H(["badge",u(s.value.state)])},S(s.value.state),3)])]),t("div",nA,[v[4]||(v[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(l(),r("div",oA,[t("div",aA,[(l(!0),r(te,null,le(s.value.capabilities,$=>(l(),r("span",{key:$,class:"badge bg-secondary"},S($),1))),128))])])):(l(),r("div",iA,"None"))]),t("div",lA,[v[5]||(v[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(l(),r("div",rA,S(s.value.initialization_context),1)):(l(),r("div",cA,"Not specified"))]),t("div",uA,[v[6]||(v[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(l(),r("span",dA,"Yes")):(l(),r("span",fA,"No"))])]),t("div",mA,[v[7]||(v[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(l(),r("div",pA,S(s.value.parent_overseer_id),1)):(l(),r("div",vA," Root overseer (user-created) "))]),s.value.is_overseer?(l(),r("div",hA,[v[8]||(v[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(l(),r("div",gA,[t("ul",_A,[(l(!0),r(te,null,le(s.value.child_minion_ids,$=>(l(),r("li",{key:$,class:"font-monospace small"},S($),1))),128))])])):(l(),r("div",bA,"No children"))])):D("",!0),t("div",yA,[v[9]||(v[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",wA,S(f(s.value.created_at)),1)]),t("div",kA,[v[10]||(v[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",$A,S(f(s.value.updated_at)),1)])])):(l(),r("div",Y2," No minion data available "))]),v[12]||(v[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},xA=se(SA,[["__scopeId","data-v-d996dc6f"]]),CA={class:"modal-dialog modal-dialog-centered"},EA={class:"modal-content"},TA={class:"modal-header"},AA={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},DA={class:"modal-body"},OA={key:0},MA={key:0,class:"text-center py-3"},LA={key:1,class:"card bg-light mb-3"},NA={class:"card-body py-2 px-3"},IA={class:"small"},jA={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},PA={key:0,class:"text-warning mt-1"},RA={key:2,class:"alert alert-warning py-2 small"},BA={key:1,class:"text-center py-3"},FA={key:0,class:"mb-3"},VA={key:1,class:"mb-3"},UA={key:2,class:"mb-3"},WA={class:"text-muted small mt-1"},HA={key:3,class:"mb-3"},zA={class:"mt-2 text-danger"},qA={class:"modal-footer"},KA=["disabled"],XA={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},GA={__name:"RestartModal",setup(n){const e=xe(),s=M(null);let o=null;const i=M("confirm"),u=M(!1),f=M(null),h=M(null),p=M(""),m=M(60);let v=null,$=null;async function c(){u.value=!0,h.value=null;try{f.value=await si()}catch(a){h.value=a.message||"Unknown error"}finally{u.value=!1}}async function d(){i.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await ni(),e.restartStatus="restarting",y()}catch(a){e.restartStatus="error",p.value=a.message||"Restart failed",e.restartInProgress=!1}}function y(){e.restartStatus="reconnecting",m.value=60;const a=Date.now();$=setInterval(()=>{const w=Math.floor((Date.now()-a)/1e3);m.value=Math.max(0,60-w)},1e3),setTimeout(()=>{v=setInterval(async()=>{try{(await fetch("/health")).ok&&(g(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-a>6e4&&(g(),e.restartStatus="error",p.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function g(){v&&(clearInterval(v),v=null),$&&(clearInterval($),$=null)}function _(){i.value="confirm",f.value=null,h.value=null,p.value="",m.value=60,g()}function b(){e.restartInProgress||(_(),e.restartStatus="idle"),e.hideModal()}return de(()=>e.currentModal,a=>{a?.name==="restart-server"&&o&&(_(),o.show(),c())}),Oe(()=>{s.value&&Le(async()=>{const{default:a}=await import("./modal-D6mKceGM.js").then(w=>w.m);return{default:a}},__vite__mapDeps([0,1])).then(({default:a})=>{o=new a(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",b)})}),De(()=>{g(),s.value&&s.value.removeEventListener("hidden.bs.modal",b),o&&o.dispose()}),(a,w)=>(l(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",CA,[t("div",EA,[t("div",TA,[w[0]||(w[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),i.value==="confirm"?(l(),r("button",AA)):D("",!0)]),t("div",DA,[i.value==="confirm"?(l(),r("div",OA,[w[5]||(w[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),u.value?(l(),r("div",MA,[...w[1]||(w[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):f.value?(l(),r("div",LA,[t("div",NA,[t("div",IA,[t("div",null,[w[2]||(w[2]=t("strong",null,"Branch:",-1)),ce(" "+S(f.value.branch),1)]),t("div",null,[w[3]||(w[3]=t("strong",null,"Last commit:",-1)),ce(" "+S(f.value.last_commit_message),1)]),t("div",jA,S(f.value.last_commit_hash?.substring(0,12)),1),f.value.has_uncommitted_changes?(l(),r("div",PA,[...w[4]||(w[4]=[t("strong",null,"Warning:",-1),ce(" Uncommitted changes detected. git pull may fail. ",-1)])])):D("",!0)])])])):h.value?(l(),r("div",RA," Could not fetch git status: "+S(h.value),1)):D("",!0)])):i.value==="progress"?(l(),r("div",BA,[ne(e).restartStatus==="pulling"?(l(),r("div",FA,[...w[6]||(w[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):ne(e).restartStatus==="restarting"?(l(),r("div",VA,[...w[7]||(w[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):ne(e).restartStatus==="reconnecting"?(l(),r("div",UA,[w[8]||(w[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),w[9]||(w[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",WA,S(m.value)+"s remaining",1)])):ne(e).restartStatus==="error"?(l(),r("div",HA,[w[10]||(w[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",zA,S(p.value),1)])):D("",!0)])):D("",!0)]),t("div",qA,[i.value==="confirm"?(l(),r(te,{key:0},[w[11]||(w[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:d,disabled:u.value}," Pull & Restart ",8,KA)],64)):ne(e).restartStatus==="error"?(l(),r("button",XA,"Close")):D("",!0)])])])],512))}},YA={class:"app-shell"},JA={class:"main-layout"},QA={class:"center-panel"},ZA={__name:"App",setup(n){const e=xe(),s=nt(),o=ve(),i=ze(),u=ts(),f=Qe(),h=ns(),p=M(null);function m(d){p.value=d}On("addAttachmentFromResource",m),On("pendingResourceAttachment",p);const v=k(()=>e.rightPanelVisible),$=k(()=>e.windowWidth<768);de(()=>u.currentHasTasks,(d,y)=>{d&&!y&&e.setRightPanelVisible(!0)}),de(()=>f.currentHasResources,(d,y)=>{d&&!y&&e.setRightPanelVisible(!0)}),Oe(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const d=window.location.hash;if(d.startsWith("#/session/")){const y=d.replace("#/session/","");o.sessions.has(y)&&await o.selectSession(y)}else if(d.startsWith("#/timeline/")){const y=d.replace("#/timeline/","");h.push(`/timeline/${y}`)}window.addEventListener("popstate",c),window.addEventListener("resize",e.handleResize)}),De(()=>{window.removeEventListener("popstate",c),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function c(){const d=window.location.hash;if(d.startsWith("#/session/")){const y=d.replace("#/session/","");o.sessions.has(y)&&o.selectSession(y)}}return(d,y)=>{const g=mn("router-view");return l(),r("div",YA,[ye(rg),ye(gg),ye(Pg),t("div",{id:"right-panel-backdrop",class:H({show:v.value&&$.value}),onClick:y[0]||(y[0]=_=>ne(e).setRightPanelVisible(!1))},null,2),t("div",JA,[t("main",QA,[ye(g)]),$e(ye(I1,{class:H({"panel-overlay":$.value,"panel-visible":v.value})},null,8,["class"]),[[Je,v.value||$.value]])]),ye(Q1),ye(pw),ye(jw),ye(JT),ye(k2),ye(q2),ye(xA),ye(GA)])}}},Dn=qa(ZA);Dn.use(Ka());Dn.use(ng);Dn.mount("#app");
